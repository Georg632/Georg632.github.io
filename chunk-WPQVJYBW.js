import{$ as tt,B as rn,C as an,D as ln,H as Ze,J as cn,K as dn,L as $,P as un,T as mn,U as pn,V as gn,W as Y,Y as Le,Z as Je,_ as et,a as Q,aa as it,b as ae,ba as nt,ca as ot,da as st,ea as rt,f as en,fa as le,g as tn,ga as at,ha as Fe,ia as hn,ka as fn,la as _n,o as nn,pa as bn,s as on,v as sn,w as Xe}from"./chunk-AO6ZUN4W.js";import{A as $i,b as Ri,c as ji,e as zi,g as It,h as Gi,k as Z,l as Ye,r as kt,s as Ui,u as Wi,w as qi,x as Ki,y as Qi}from"./chunk-OAW7YPBW.js";import{a as Yi,b as Be,d as Ae,e as Xi,f as Zi,g as Pe,h as Ji,m as be}from"./chunk-45OYFO4Z.js";import{$ as yt,$a as qe,A as U,Ab as se,Ac as $e,Bb as a,Ca as k,Cb as H,Da as O,Db as Pi,E as pe,Ea as V,Eb as Ke,F as ye,G as W,Ga as Ci,Gb as q,H as ze,Ha as Ie,Hb as s,Ia as ke,Ib as _e,J as Ge,Ja as T,Jb as Qe,K as ue,Ka as l,Kb as me,La as d,M as X,Ma as S,Mb as Dt,O as r,Ob as L,Pb as xt,Qa as yi,R as v,Ra as R,S as C,Sa as z,Ta as g,Ua as f,V as ge,Va as F,Vb as Li,Wa as P,Wb as Te,Xa as Mi,Xb as Fi,Z as b,Za as Di,_ as Ct,_a as xi,aa as Mt,ab as he,ba as fi,bb as te,ca as Ue,cb as Ii,d as J,da as N,db as ki,ea as _i,eb as fe,fb as _,ga as bi,gb as y,h as ce,hb as E,i as G,ib as A,ka as c,kb as ie,kc as we,la as vi,lb as ne,lc as Ei,m as di,mb as oe,n as ui,na as xe,nb as Ti,ob as wi,pa as We,pb as Si,pc as Se,qb as Hi,qc as He,r as mi,ra as I,rb as B,s as je,sc as u,ta as h,tb as Bi,tc as K,ua as Me,uc as Ni,v as de,va as w,vc as re,w as vt,wa as ee,wb as M,wc as Oi,x as pi,xa as Ne,xb as D,xc as Vi,y as gi,ya as Oe,yb as Ai,z as hi}from"./chunk-3PG4Z6X5.js";import{a as j,b as De,c as li,d as ci}from"./chunk-M4OEJGNZ.js";var vn=(()=>{class i{static _uniqueId=0;id=s(`brn-toggle-${++i._uniqueId}`);value=s();disabled=s(!1,{transform:L});state=me("off");type=s("button");ariaLabel=s(null,{alias:"aria-label"});_isOn=a(()=>this.state()==="on");toggle(){this.disabled()||this.state.set(this._isOn()?"off":"on")}static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["button","brnToggle",""]],hostVars:7,hostBindings:function(t,n){t&1&&g("click",function(){return n.toggle()}),t&2&&(z("id",n.id())("type",n.type()),k("disabled",n.disabled()?!0:null)("data-disabled",n.disabled()?!0:null)("data-state",n.state())("aria-pressed",n._isOn())("aria-label",n.ariaLabel()||null))},inputs:{id:[1,"id"],value:[1,"value"],disabled:[1,"disabled"],state:[1,"state"],type:[1,"type"],ariaLabel:[1,"aria-label","ariaLabel"]},outputs:{state:"stateChange"}})}return i})();var Yn=K('hover:bg-muted hover:text-muted-foreground focus-visible:border-ring data-[state=on]:bg-accent data-[state=on]:text-accent-foreground focus-visible:ring-ring/50 inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium whitespace-nowrap transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&_ng-icon]:pointer-events-none [&_ng-icon]:shrink-0 [&_ng-icon:not([class*="text-"])]:text-base',{variants:{variant:{default:"bg-transparent",outline:"border-input hover:bg-accent hover:text-accent-foreground border bg-transparent shadow-xs"},size:{default:"h-9 min-w-9 px-2",sm:"h-8 min-w-8 px-1.5",lg:"h-10 min-w-10 px-2.5"}},defaultVariants:{variant:"default",size:"default"}}),Tt=(()=>{class i{variant=s("default");size=s("default");userClass=s("",{alias:"class"});_computedClass=a(()=>u(Yn({variant:this.variant(),size:this.size()}),this.userClass()));static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["button","hlmToggle",""]],hostAttrs:["data-slot","toggle"],hostVars:2,hostBindings:function(t,n){t&2&&_(n._computedClass())},inputs:{variant:[1,"variant"],size:[1,"size"],userClass:[1,"class","userClass"]},features:[w([{directive:vn,inputs:["id","id","value","value","disabled","disabled","state","state","aria-label","aria-label","type","type"],outputs:["stateChange","stateChange"]}])]})}return i})();var Cn=(()=>{class i{variant=s("default");size=s("default");disabled=s(!1);state=me("off");isAnimating=b(!1);animationDirection=b("");constructor(){H(()=>{let e=this.state();this.animationDirection()===""&&e==="off"||(e==="on"?this.animationDirection.set("fill"):this.animationDirection.set("empty"),this.isAnimating.set(!0),setTimeout(()=>{this.isAnimating.set(!1)},800))})}animationClass=a(()=>{if(!this.isAnimating())return"";let e=this.animationDirection();return e==="fill"?"animate-bounce-shake":e==="empty"?"animate-empty":""});buttonClass=a(()=>{let e=this.state(),t=this.animationClass(),n="";return e==="on"?n="bg-green-100 hover:bg-green-200 dark:bg-green-900/30 dark:hover:bg-green-900/50 border-green-300 dark:border-green-700":n="bg-muted/50 hover:bg-muted dark:bg-muted/20 dark:hover:bg-muted/40 border-muted-foreground/20",`${t} ${n}`});iconClass=a(()=>{let e=this.state(),t=this.isAnimating();if(e==="on"){let n="text-green-600 dark:text-green-400";return t&&this.animationDirection()==="fill"?`${n} animate-fill`:n}return"text-muted-foreground/60"});static \u0275fac=function(t){return new(t||i)};static \u0275cmp=I({type:i,selectors:[["gh-shopping-basket-toggle"]],inputs:{variant:[1,"variant"],size:[1,"size"],disabled:[1,"disabled"],state:[1,"state"]},outputs:{state:"stateChange"},features:[B([Q({lucideShoppingBasket:an})])],decls:2,vars:9,consts:[["hlmToggle","",1,"relative","overflow-hidden","transition-all","duration-300",3,"stateChange","variant","size","disabled","state"],["hlm","",1,"transition-all","duration-500",3,"name"]],template:function(t,n){t&1&&(l(0,"button",0),oe("stateChange",function(p){return ne(n.state,p)||(n.state=p),p}),S(1,"ng-icon",1),d()),t&2&&(_(n.buttonClass()),T("variant",n.variant())("size",n.size())("disabled",n.disabled()),ie("state",n.state),c(),_(n.iconClass()),T("name","lucideShoppingBasket"))},dependencies:[Tt,$,ae],styles:["@keyframes _ngcontent-%COMP%_bounce-shake{0%,to{transform:translateY(0) rotate(0) scale(1)}10%{transform:translateY(-8px) rotate(-5deg) scale(1.1)}20%{transform:translateY(-8px) rotate(5deg) scale(1.1)}30%{transform:translateY(-8px) rotate(-5deg) scale(1.1)}40%{transform:translateY(0) rotate(0) scale(1)}50%{transform:scale(.95)}60%{transform:scale(1.05)}70%{transform:scale(.98)}80%{transform:scale(1.02)}90%{transform:scale(1)}}@keyframes _ngcontent-%COMP%_fill-basket{0%{opacity:1}50%{opacity:.6;filter:brightness(1.5)}to{opacity:1}}@keyframes _ngcontent-%COMP%_empty-basket{0%{transform:scale(1);opacity:1}30%{transform:scale(.8) rotate(-10deg);opacity:.7}60%{transform:scale(1.1) rotate(10deg);opacity:.8}to{transform:scale(1) rotate(0);opacity:1}}.animate-bounce-shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_bounce-shake .8s ease-in-out}.animate-fill[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fill-basket .5s ease-in-out}.animate-empty[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_empty-basket .6s ease-in-out}[_nghost-%COMP%]{display:inline-block}"],changeDetection:0})}return i})();var St=(()=>{class i{_listeners=[];notify(e,t){for(let n of this._listeners)n(e,t)}listen(e){return this._listeners.push(e),()=>{this._listeners=this._listeners.filter(t=>e!==t)}}ngOnDestroy(){this._listeners=[]}static \u0275fac=function(t){return new(t||i)};static \u0275prov=ue({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var ct=(()=>{class i{static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["","cdkMenuGroup",""]],hostAttrs:["role","group",1,"cdk-menu-group"],exportAs:["cdkMenuGroup"],features:[B([{provide:St,useClass:St}])]})}return i})(),Pt=new X("cdk-menu"),ve=(function(i){return i[i.nextItem=0]="nextItem",i[i.previousItem=1]="previousItem",i[i.currentItem=2]="currentItem",i})(ve||{}),Ce=new X("cdk-menu-stack"),eo={provide:Ce,deps:[[new yt,new Mt,new Ct(Ce)]],useFactory:i=>i||new Dn},to=i=>({provide:Ce,deps:[[new yt,new Mt,new Ct(Ce)]],useFactory:m=>m||Dn.inline(i)}),Dn=(()=>{class i{id=r(kt).getId("cdk-menu-stack-");_elements=[];_close=new J;_empty=new J;_hasFocus=new J;closed=this._close;hasFocus=this._hasFocus.pipe(pe(!1),vt(0),hi());emptied=this._empty;_inlineMenuOrientation=null;static inline(e){let t=new i;return t._inlineMenuOrientation=e,t}push(e){this._elements.push(e)}close(e,t){let{focusNextOnEmpty:n,focusParentTrigger:o}=j({},t);if(this._elements.indexOf(e)>=0){let p;do p=this._elements.pop(),this._close.next({item:p,focusParentTrigger:o});while(p!==e);this.isEmpty()&&this._empty.next(n)}}closeSubMenuOf(e){let t=!1;if(this._elements.indexOf(e)>=0)for(t=this.peek()!==e;this.peek()!==e;)this._close.next({item:this._elements.pop()});return t}closeAll(e){let{focusNextOnEmpty:t,focusParentTrigger:n}=j({},e);if(!this.isEmpty()){for(;!this.isEmpty();){let o=this._elements.pop();o&&this._close.next({item:o,focusParentTrigger:n})}this._empty.next(t)}}isEmpty(){return!this._elements.length}length(){return this._elements.length}peek(){return this._elements[this._elements.length-1]}hasInlineMenu(){return this._inlineMenuOrientation!=null}inlineMenuOrientation(){return this._inlineMenuOrientation}setHasFocus(e){this._hasFocus.next(e)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=ue({token:i,factory:i.\u0275fac})}return i})(),Lt=new X("cdk-menu-trigger"),io=new X("cdk-menu-scroll-strategy",{providedIn:"root",factory:()=>{let i=r(ge);return()=>Ui(i)}}),no=(()=>{class i{static _openMenuTrigger;update(e){i._openMenuTrigger!==e&&(i._openMenuTrigger?.close(),i._openMenuTrigger=e)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=ue({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),oo=(()=>{class i{injector=r(ge);viewContainerRef=r(We);menuStack=r(Ce);menuScrollStrategy=r(io);menuPosition;opened=new Ne;closed=new Ne;menuTemplateRef;menuData;overlayRef=null;destroyed=new J;stopOutsideClicksListener=je(this.closed,this.destroyed);childMenu;_menuPortal;_childMenuInjector;ngOnDestroy(){this._destroyOverlay(),this.destroyed.next(),this.destroyed.complete()}isOpen(){return!!this.overlayRef?.hasAttached()}registerChildMenu(e){this.childMenu=e}getMenuContentPortal(){let e=this.menuTemplateRef!==this._menuPortal?.templateRef;return this.menuTemplateRef&&(!this._menuPortal||e)&&(this._menuPortal=new Ri(this.menuTemplateRef,this.viewContainerRef,this.menuData,this._getChildMenuInjector())),this._menuPortal}isElementInsideMenuStack(e){for(let t=e;t;t=t?.parentElement??null)if(t.getAttribute("data-cdk-menu-stack-id")===this.menuStack.id)return!0;return!1}_destroyOverlay(){this.overlayRef&&(this.overlayRef.dispose(),this.overlayRef=null)}_getChildMenuInjector(){return this._childMenuInjector=this._childMenuInjector||ge.create({providers:[{provide:Lt,useValue:this},{provide:Ce,useValue:this.menuStack}],parent:this.injector}),this._childMenuInjector}static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,hostVars:2,hostBindings:function(t,n){t&2&&k("aria-controls",n.childMenu==null?null:n.childMenu.id)("data-cdk-menu-stack-id",n.menuStack.id)}})}return i})();var Ft=new X("cdk-menu-aim");function xn(i,m){if(!m.isTrusted)return!1;let e=i.nativeElement,t=m.keyCode;return e.nodeName==="BUTTON"&&!e.disabled?t===13||t===32:e.nodeName==="A"?t===13:!1}var Ve=(()=>{class i extends oo{_elementRef=r(N);_ngZone=r(Oe);_changeDetectorRef=r(Dt);_inputModalityDetector=r(It);_directionality=r(Ye,{optional:!0});_renderer=r(xe);_injector=r(ge);_cleanupMouseenter;_menuTracker=r(no);_parentMenu=r(Pt,{optional:!0});_menuAim=r(Ft,{optional:!0});constructor(){super(),this._setRole(),this._registerCloseHandler(),this._subscribeToMenuStackClosed(),this._subscribeToMouseEnter(),this._subscribeToMenuStackHasFocus(),this._setType()}toggle(){this.isOpen()?this.close():this.open()}open(){this._parentMenu||this._menuTracker.update(this),!this.isOpen()&&this.menuTemplateRef!=null&&(this.opened.next(),this.overlayRef=this.overlayRef||$i(this._injector,this._getOverlayConfig()),this.overlayRef.attach(this.getMenuContentPortal()),this._changeDetectorRef.markForCheck(),this._subscribeToOutsideClicks())}close(){this.isOpen()&&(this.closed.next(),this.overlayRef.detach(),this._changeDetectorRef.markForCheck()),this._closeSiblingTriggers()}getMenu(){return this.childMenu}ngOnChanges(e){e.menuPosition&&this.overlayRef&&this.overlayRef.updatePositionStrategy(this._getOverlayPositionStrategy())}ngOnDestroy(){this._cleanupMouseenter(),super.ngOnDestroy()}_toggleOnKeydown(e){let t=this._parentMenu?.orientation==="vertical";switch(e.keyCode){case 32:case 13:!Z(e)&&!xn(this._elementRef,e)&&(this.toggle(),this.childMenu?.focusFirstItem("keyboard"));break;case 39:Z(e)||this._parentMenu&&t&&this._directionality?.value!=="rtl"&&(e.preventDefault(),this.open(),this.childMenu?.focusFirstItem("keyboard"));break;case 37:Z(e)||this._parentMenu&&t&&this._directionality?.value==="rtl"&&(e.preventDefault(),this.open(),this.childMenu?.focusFirstItem("keyboard"));break;case 40:case 38:Z(e)||t||(e.preventDefault(),this.open(),e.keyCode===40?this.childMenu?.focusFirstItem("keyboard"):this.childMenu?.focusLastItem("keyboard"));break}}_handleClick(){this.toggle(),this.childMenu?.focusFirstItem("mouse")}_setHasFocus(e){this._parentMenu||this.menuStack.setHasFocus(e)}_subscribeToMouseEnter(){this._cleanupMouseenter=this._ngZone.runOutsideAngular(()=>this._renderer.listen(this._elementRef.nativeElement,"mouseenter",()=>{if(this._inputModalityDetector.mostRecentModality!=="touch"&&!this.menuStack.isEmpty()&&!this.isOpen()){let e=()=>this._ngZone.run(()=>{this._closeSiblingTriggers(),this.open()});this._menuAim?this._menuAim.toggle(e):e()}}))}_closeSiblingTriggers(){this._parentMenu?!this.menuStack.closeSubMenuOf(this._parentMenu)&&this.menuStack.peek()!==this._parentMenu&&this.menuStack.closeAll():this.menuStack.closeAll()}_getOverlayConfig(){return new Wi({positionStrategy:this._getOverlayPositionStrategy(),scrollStrategy:this.menuScrollStrategy(),direction:this._directionality||void 0})}_getOverlayPositionStrategy(){return qi(this._injector,this._elementRef).withLockedPosition().withFlexibleDimensions(!1).withPositions(this._getOverlayPositions())}_getOverlayPositions(){return this.menuPosition??(!this._parentMenu||this._parentMenu.orientation==="horizontal"?Ki:Qi)}_registerCloseHandler(){this._parentMenu||this.menuStack.closed.pipe(W(this.destroyed)).subscribe(({item:e})=>{e===this.childMenu&&this.close()})}_subscribeToOutsideClicks(){this.overlayRef&&this.overlayRef.outsidePointerEvents().pipe(W(this.stopOutsideClicksListener)).subscribe(e=>{let t=ji(e),n=this._elementRef.nativeElement;t!==n&&!n.contains(t)&&(this.isElementInsideMenuStack(t)?this._closeSiblingTriggers():this.menuStack.closeAll())})}_subscribeToMenuStackHasFocus(){this._parentMenu||this.menuStack.hasFocus.pipe(W(this.destroyed)).subscribe(e=>{e||this.menuStack.closeAll()})}_subscribeToMenuStackClosed(){this._parentMenu||this.menuStack.closed.subscribe(({focusParentTrigger:e})=>{e&&!this.menuStack.length()&&this._elementRef.nativeElement.focus()})}_setRole(){this._parentMenu||this._elementRef.nativeElement.setAttribute("role","button")}_setType(){let e=this._elementRef.nativeElement;e.nodeName==="BUTTON"&&!e.getAttribute("type")&&e.setAttribute("type","button")}static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["","cdkMenuTriggerFor",""]],hostAttrs:[1,"cdk-menu-trigger"],hostVars:2,hostBindings:function(t,n){t&1&&g("focusin",function(){return n._setHasFocus(!0)})("focusout",function(){return n._setHasFocus(!1)})("keydown",function(p){return n._toggleOnKeydown(p)})("click",function(){return n._handleClick()}),t&2&&k("aria-haspopup",n.menuTemplateRef?"menu":null)("aria-expanded",n.menuTemplateRef==null?null:n.isOpen())},inputs:{menuTemplateRef:[0,"cdkMenuTriggerFor","menuTemplateRef"],menuPosition:[0,"cdkMenuPosition","menuPosition"],menuData:[0,"cdkMenuTriggerData","menuData"]},outputs:{opened:"cdkMenuOpened",closed:"cdkMenuClosed"},exportAs:["cdkMenuTriggerFor"],features:[B([{provide:Lt,useExisting:i},eo]),Me,fi]})}return i})(),Re=(()=>{class i{_dir=r(Ye,{optional:!0});_elementRef=r(N);_ngZone=r(Oe);_inputModalityDetector=r(It);_renderer=r(xe);_cleanupMouseEnter;_menuAim=r(Ft,{optional:!0});_menuStack=r(Ce);_parentMenu=r(Pt,{optional:!0});_menuTrigger=r(Ve,{optional:!0,self:!0});disabled=!1;typeaheadLabel;triggered=new Ne;get hasMenu(){return this._menuTrigger?.menuTemplateRef!=null}_tabindex=-1;closeOnSpacebarTrigger=!0;destroyed=new J;constructor(){this._setupMouseEnter(),this._setType(),this._isStandaloneItem()&&(this._tabindex=0)}ngOnDestroy(){this._cleanupMouseEnter?.(),this.destroyed.next(),this.destroyed.complete()}focus(){this._elementRef.nativeElement.focus()}trigger(e){let{keepOpen:t}=j({},e);!this.disabled&&!this.hasMenu&&(this.triggered.next(),t||this._menuStack.closeAll({focusParentTrigger:!0}))}isMenuOpen(){return!!this._menuTrigger?.isOpen()}getMenu(){return this._menuTrigger?.getMenu()}getMenuTrigger(){return this._menuTrigger}getLabel(){return this.typeaheadLabel||this._elementRef.nativeElement.textContent?.trim()||""}_resetTabIndex(){this._isStandaloneItem()||(this._tabindex=-1)}_setTabIndex(e){this.disabled||(!e||!this._menuStack.isEmpty())&&(this._tabindex=0)}_handleClick(e){this.disabled?(e.preventDefault(),e.stopPropagation()):this.trigger()}_onKeydown(e){switch(e.keyCode){case 32:case 13:if(!Z(e)&&!xn(this._elementRef,e)){let t=this._elementRef.nativeElement.nodeName;t!=="A"&&t!=="BUTTON"&&e.preventDefault(),this.trigger({keepOpen:e.keyCode===32&&!this.closeOnSpacebarTrigger})}break;case 39:Z(e)||this._parentMenu&&this._isParentVertical()&&(this._dir?.value!=="rtl"?this._forwardArrowPressed(e):this._backArrowPressed(e));break;case 37:Z(e)||this._parentMenu&&this._isParentVertical()&&(this._dir?.value!=="rtl"?this._backArrowPressed(e):this._forwardArrowPressed(e));break}}_isStandaloneItem(){return!this._parentMenu}_backArrowPressed(e){let t=this._parentMenu;(this._menuStack.hasInlineMenu()||this._menuStack.length()>1)&&(e.preventDefault(),this._menuStack.close(t,{focusNextOnEmpty:this._menuStack.inlineMenuOrientation()==="horizontal"?ve.previousItem:ve.currentItem,focusParentTrigger:!0}))}_forwardArrowPressed(e){!this.hasMenu&&this._menuStack.inlineMenuOrientation()==="horizontal"&&(e.preventDefault(),this._menuStack.closeAll({focusNextOnEmpty:ve.nextItem,focusParentTrigger:!0}))}_setupMouseEnter(){if(!this._isStandaloneItem()){let e=()=>this._ngZone.run(()=>this._menuStack.closeSubMenuOf(this._parentMenu));this._cleanupMouseEnter=this._ngZone.runOutsideAngular(()=>this._renderer.listen(this._elementRef.nativeElement,"mouseenter",()=>{this._inputModalityDetector.mostRecentModality!=="touch"&&!this._menuStack.isEmpty()&&!this.hasMenu&&(this._menuAim?this._menuAim.toggle(e):e())}))}}_isParentVertical(){return this._parentMenu?.orientation==="vertical"}_setType(){let e=this._elementRef.nativeElement;e.nodeName==="BUTTON"&&!e.getAttribute("type")&&e.setAttribute("type","button")}static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["","cdkMenuItem",""]],hostAttrs:["role","menuitem",1,"cdk-menu-item"],hostVars:4,hostBindings:function(t,n){t&1&&g("blur",function(){return n._resetTabIndex()})("focus",function(){return n._setTabIndex()})("click",function(p){return n._handleClick(p)})("keydown",function(p){return n._onKeydown(p)}),t&2&&(z("tabIndex",n._tabindex),k("aria-disabled",n.disabled||null),fe("cdk-menu-item-disabled",n.disabled))},inputs:{disabled:[2,"cdkMenuItemDisabled","disabled",L],typeaheadLabel:[0,"cdkMenuitemTypeaheadLabel","typeaheadLabel"]},outputs:{triggered:"cdkMenuItemTriggered"},exportAs:["cdkMenuItem"]})}return i})(),At=class{_renderer;_items;_eventCleanups;_itemsSubscription;entered=new J;exited=new J;activeElement;previousElement;constructor(m,e){this._renderer=m,this._items=e,this._bindEvents(),this.entered.subscribe(t=>this.activeElement=t),this.exited.subscribe(()=>{this.previousElement=this.activeElement,this.activeElement=void 0})}destroy(){this._cleanupEvents(),this._itemsSubscription?.unsubscribe()}_bindEvents(){this._itemsSubscription=this._items.changes.pipe(pe(this._items)).subscribe(()=>{this._cleanupEvents(),this._eventCleanups=[],this._items.forEach(m=>{let e=m._elementRef.nativeElement;this._eventCleanups.push(this._renderer.listen(e,"mouseenter",()=>{this.entered.next(m)}),this._renderer.listen(e,"mouseout",()=>{this.exited.next(m)}))})})}_cleanupEvents(){this._eventCleanups?.forEach(m=>m()),this._eventCleanups=void 0}},so=(()=>{class i extends ct{_focusMonitor=r(Gi);ngZone=r(Oe);_renderer=r(xe);nativeElement=r(N).nativeElement;menuStack=r(Ce);menuAim=r(Ft,{optional:!0,self:!0});dir=r(Ye,{optional:!0});_allItems;id=r(kt).getId("cdk-menu-");items=new _i;orientation="vertical";isInline=!1;keyManager;destroyed=new J;triggerItem;pointerTracker;_menuStackHasFocus=b(!1);_tabIndexSignal=a(()=>{let e=this._menuStackHasFocus()?-1:0;return this.isInline?e:null});ngAfterContentInit(){this.isInline||this.menuStack.push(this),this._setItems(),this._setKeyManager(),this._handleFocus(),this._subscribeToMenuStackHasFocus(),this._subscribeToMenuOpen(),this._subscribeToMenuStackClosed(),this._setUpPointerTracker()}ngOnDestroy(){this._focusMonitor.stopMonitoring(this.nativeElement),this.keyManager?.destroy(),this.destroyed.next(),this.destroyed.complete(),this.pointerTracker?.destroy()}focusFirstItem(e="program"){this.keyManager.setFocusOrigin(e),this.keyManager.setFirstItemActive()}focusLastItem(e="program"){this.keyManager.setFocusOrigin(e),this.keyManager.setLastItemActive()}setActiveMenuItem(e){this.keyManager?.setActiveItem(e)}_getTabIndex(){return this._tabIndexSignal()}closeOpenMenu(e,t){let{focusParentTrigger:n}=j({},t),o=this.keyManager,p=this.triggerItem;e===p?.getMenuTrigger()?.getMenu()&&(p?.getMenuTrigger()?.close(),n&&(p?o.setActiveItem(p):o.setFirstItemActive()))}_setItems(){this._allItems.changes.pipe(pe(this._allItems),W(this.destroyed)).subscribe(e=>{this.items.reset(e.filter(t=>t._parentMenu===this)),this.items.notifyOnChanges()})}_setKeyManager(){this.keyManager=new et(this.items).withWrap().withTypeAhead().withHomeAndEnd().skipPredicate(()=>!1),this.orientation==="horizontal"?this.keyManager.withHorizontalOrientation(this.dir?.value||"ltr"):this.keyManager.withVerticalOrientation()}_subscribeToMenuOpen(){let e=je(this.items.changes,this.destroyed);this.items.changes.pipe(pe(this.items),di(t=>t.filter(n=>n.hasMenu).map(n=>n.getMenuTrigger().opened.pipe(gi(n),W(e)))),ui(),ye(t=>(this.triggerItem=t,t.getMenuTrigger().closed)),W(this.destroyed)).subscribe(()=>this.triggerItem=void 0)}_subscribeToMenuStackClosed(){this.menuStack.closed.pipe(W(this.destroyed)).subscribe(({item:e,focusParentTrigger:t})=>this.closeOpenMenu(e,{focusParentTrigger:t}))}_subscribeToMenuStackHasFocus(){this.isInline&&this.menuStack.hasFocus.pipe(W(this.destroyed)).subscribe(e=>{this._menuStackHasFocus.set(e)})}_setUpPointerTracker(){this.menuAim&&(this.ngZone.runOutsideAngular(()=>{this.pointerTracker=new At(this._renderer,this.items)}),this.menuAim.initialize(this,this.pointerTracker))}_handleFocus(){this._focusMonitor.monitor(this.nativeElement,!1).pipe(W(this.destroyed)).subscribe(e=>{e!==null&&e!=="mouse"&&this.focusFirstItem(e)})}static \u0275fac=(()=>{let e;return function(n){return(e||(e=Ue(i)))(n||i)}})();static \u0275dir=h({type:i,contentQueries:function(t,n,o){if(t&1&&Mi(o,Re,5),t&2){let p;Di(p=xi())&&(n._allItems=p)}},hostAttrs:["role","menu"],hostVars:4,hostBindings:function(t,n){t&1&&g("focusin",function(){return n.menuStack.setHasFocus(!0)})("focusout",function(){return n.menuStack.setHasFocus(!1)}),t&2&&(z("tabIndex",n._getTabIndex())("id",n.id),k("aria-orientation",n.orientation)("data-cdk-menu-stack-id",n.menuStack.id))},inputs:{id:"id"},features:[Me]})}return i})(),dt=(()=>{class i extends so{_parentTrigger=r(Lt,{optional:!0});closed=new Ne;orientation="vertical";isInline=!this._parentTrigger;constructor(){super(),this.destroyed.subscribe(this.closed),this._parentTrigger?.registerChildMenu(this)}ngAfterContentInit(){super.ngAfterContentInit(),this._subscribeToMenuStackEmptied()}ngOnDestroy(){super.ngOnDestroy(),this.closed.complete()}_handleKeyEvent(e){let t=this.keyManager;switch(e.keyCode){case 37:case 39:Z(e)||(e.preventDefault(),t.setFocusOrigin("keyboard"),t.onKeydown(e));break;case 27:Z(e)||(e.preventDefault(),this.menuStack.close(this,{focusNextOnEmpty:ve.currentItem,focusParentTrigger:!0}));break;case 9:Z(e,"altKey","metaKey","ctrlKey")||this.menuStack.closeAll({focusParentTrigger:!0});break;default:t.onKeydown(e)}}_toggleMenuFocus(e){let t=this.keyManager;switch(e){case ve.nextItem:t.setFocusOrigin("keyboard"),t.setNextItemActive();break;case ve.previousItem:t.setFocusOrigin("keyboard"),t.setPreviousItemActive();break;case ve.currentItem:t.activeItem&&(t.setFocusOrigin("keyboard"),t.setActiveItem(t.activeItem));break}}_subscribeToMenuStackEmptied(){this.menuStack.emptied.pipe(W(this.destroyed)).subscribe(e=>this._toggleMenuFocus(e))}static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["","cdkMenu",""]],hostAttrs:["role","menu",1,"cdk-menu"],hostVars:2,hostBindings:function(t,n){t&1&&g("keydown",function(p){return n._handleKeyEvent(p)}),t&2&&fe("cdk-menu-inline",n.isInline)},outputs:{closed:"closed"},exportAs:["cdkMenu"],features:[B([{provide:ct,useExisting:i},{provide:Pt,useExisting:i},to("vertical")]),Me]})}return i})();var uo=(i,m)=>{let e=i==="start"?"top":i==="end"?"bottom":"center",t=(n,o,p,Ee)=>[{originX:n,originY:o,overlayX:p,overlayY:Ee},{originX:p,originY:Ee,overlayX:n,overlayY:o}];switch(m){case"top":return t(i,"top",i,"bottom");case"bottom":return t(i,"bottom",i,"top");case"left":return t("start",e,"end",e);case"right":return t("end",e,"start",e)}};var In=(()=>{class i{_host=r(dt);_state=b("open");_side=b("top");constructor(){this.setSideWithDarkMagic(),this._host.closed.pipe(we()).subscribe(()=>this._state.set("closed"))}setSideWithDarkMagic(){let e=this._host.menuStack.peek()===void 0;setTimeout(()=>{let t=this._host._parentTrigger._spartanLastPosition;if(!t){this._side.set(e?"top":"left");return}let n=e?t.originY:t.originX==="end"?"right":"left";this._side.set(n)})}static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["","brnMenu",""],["","brnSubMenu",""]],hostVars:2,hostBindings:function(t,n){t&2&&k("data-state",n._state())("data-side",n._side())},features:[w([dt])]})}return i})();var kn=(()=>{class i{static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["","brnMenuGroup",""]],features:[w([ct])]})}return i})(),Tn=(()=>{class i{_cdkMenuItem=r(Re);disabled=s(this._cdkMenuItem.disabled,{transform:L});triggered=Ei(this._cdkMenuItem.triggered);constructor(){H(()=>this._cdkMenuItem.disabled=this.disabled())}static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["","brnMenuItem",""]],hostVars:2,hostBindings:function(t,n){t&2&&(z("disabled",n.disabled()),k("data-disabled",n.disabled()?"":null))},inputs:{disabled:[1,"disabled"]},outputs:{triggered:"triggered"},features:[w([Re])]})}return i})();var wn=(()=>{class i{_cdkTrigger=r(Ve,{host:!0});align=s("center");side=s("bottom");constructor(){this._cdkTrigger.opened.pipe(we()).subscribe(()=>setTimeout(()=>this._cdkTrigger._spartanLastPosition=this._cdkTrigger.overlayRef._positionStrategy._lastPosition)),H(()=>{let e=this.align(),t=this.side();this._cdkTrigger.menuPosition=uo(e,t)})}static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["","brnMenuTriggerFor",""]],inputs:{align:[1,"align"],side:[1,"side"]},features:[w([{directive:Ve,inputs:["cdkMenuTriggerFor","brnMenuTriggerFor","cdkMenuTriggerData","brnMenuTriggerData"],outputs:["cdkMenuOpened","brnMenuOpened","cdkMenuClosed","brnMenuClosed"]}])]})}return i})();var mo=["*"],po=K("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] origin-top overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",{variants:{variant:{default:"my-0.5",menubar:"my-2"}},defaultVariants:{variant:"default"}}),Nt=(()=>{class i{userClass=s("",{alias:"class"});_computedClass=a(()=>u(po({variant:this.variant()}),this.userClass()));variant=s("default");static \u0275fac=function(t){return new(t||i)};static \u0275cmp=I({type:i,selectors:[["hlm-menu"]],hostVars:2,hostBindings:function(t,n){t&2&&_(n._computedClass())},inputs:{userClass:[1,"class","userClass"],variant:[1,"variant"]},features:[w([In])],ngContentSelectors:mo,decls:1,vars:0,template:function(t,n){t&1&&(F(),P(0))},encapsulation:2,changeDetection:0})}return i})();var go=["*"],Ot=(()=>{class i{static \u0275fac=function(t){return new(t||i)};static \u0275cmp=I({type:i,selectors:[["hlm-menu-group"]],hostAttrs:[1,"block"],features:[w([kn])],ngContentSelectors:go,decls:1,vars:0,template:function(t,n){t&1&&(F(),P(0))},encapsulation:2,changeDetection:0})}return i})();var Vt=(()=>{class i{variant=s("default");inset=s(!1,{transform:L});userClass=s("",{alias:"class"});_computedClass=a(()=>u("hover:bg-accent focus-visible:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[ng-icon]:!text-destructive [&_ng-icon]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_ng-icon]:pointer-events-none [&_ng-icon]:shrink-0",this.userClass()));static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["","hlmMenuItem",""]],hostVars:4,hostBindings:function(t,n){t&2&&(k("data-variant",n.variant())("data-inset",n.inset()?"":null),_(n._computedClass()))},inputs:{variant:[1,"variant"],inset:[1,"inset"],userClass:[1,"class","userClass"]},features:[w([{directive:Tn,inputs:["disabled","disabled"],outputs:["triggered","triggered"]}])]})}return i})();var ho=["*"],Rt=(()=>{class i{inset=s(!1,{transform:L});userClass=s("",{alias:"class"});_computedClass=a(()=>u("block px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",this.userClass()));static \u0275fac=function(t){return new(t||i)};static \u0275cmp=I({type:i,selectors:[["hlm-menu-label"]],hostVars:3,hostBindings:function(t,n){t&2&&(k("data-inset",n.inset()?"":null),_(n._computedClass()))},inputs:{inset:[1,"inset"],userClass:[1,"class","userClass"]},ngContentSelectors:ho,decls:1,vars:0,template:function(t,n){t&1&&(F(),P(0))},encapsulation:2,changeDetection:0})}return i})();var jt=(()=>{class i{userClass=s("",{alias:"class"});_computedClass=a(()=>u("bg-border -mx-1 my-1 block h-px",this.userClass()));static \u0275fac=function(t){return new(t||i)};static \u0275cmp=I({type:i,selectors:[["hlm-menu-separator"]],hostVars:2,hostBindings:function(t,n){t&2&&_(n._computedClass())},inputs:{userClass:[1,"class","userClass"]},decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0})}return i})();var Co=["passwordDialog"];function yo(i,m){if(i&1){let e=R();l(0,"hlm-menu",6)(1,"hlm-menu-label",10),y(2),d(),S(3,"hlm-menu-separator"),l(4,"hlm-menu-group")(5,"button",11),g("click",function(){v(e);let n=f();return C(n.handleChangePassword())}),S(6,"ng-icon",12),l(7,"span"),y(8),M(9,"transloco"),d()(),l(10,"button",11),g("click",function(){v(e);let n=f();return C(n.handleLogout())}),S(11,"ng-icon",13),l(12,"span"),y(13),M(14,"transloco"),d()()()()}if(i&2){let e=f();c(2),A(" ",e.userEmail()," "),c(6),E(D(9,3,"shoppingList.avatar.changePassword")),c(5),E(D(14,5,"shoppingList.avatar.logout"))}}function Mo(i,m){i&1&&(l(0,"p",20),y(1),M(2,"transloco"),d()),i&2&&(c(),A(" ",D(2,1,"shoppingList.avatar.passwordMinLength")," "))}function Do(i,m){i&1&&(l(0,"p",20),y(1),M(2,"transloco"),d()),i&2&&(c(),A(" ",D(2,1,"shoppingList.avatar.passwordsMismatch")," "))}function xo(i,m){if(i&1&&(l(0,"div",23)(1,"p",20),y(2),d()()),i&2){let e=f(2);c(2),E(e.passwordError())}}function Io(i,m){i&1&&(l(0,"div",24)(1,"p",27),y(2),M(3,"transloco"),d()()),i&2&&(c(2),A(" ",D(3,1,"shoppingList.avatar.passwordChangeSuccess")," "))}function ko(i,m){i&1&&(S(0,"hlm-spinner",28),l(1,"span"),y(2),M(3,"transloco"),d()),i&2&&(c(2),E(D(3,1,"shoppingList.avatar.updating")))}function To(i,m){i&1&&(l(0,"span"),y(1),M(2,"transloco"),d()),i&2&&(c(),E(D(2,1,"shoppingList.avatar.updatePassword")))}function wo(i,m){if(i&1){let e=R();l(0,"hlm-dialog-content")(1,"hlm-dialog-header")(2,"h3",14),y(3),M(4,"transloco"),d(),l(5,"p",15),y(6),M(7,"transloco"),d()(),l(8,"div",16)(9,"div",17)(10,"label",18),y(11),M(12,"transloco"),d(),l(13,"input",19),M(14,"transloco"),oe("ngModelChange",function(n){v(e);let o=f();return ne(o.newPassword,n)||(o.newPassword=n),C(n)}),g("keydown.enter",function(){v(e);let n=f();return C(n.submitPasswordChange())}),d(),O(15,Mo,3,3,"p",20),d(),l(16,"div",17)(17,"label",21),y(18),M(19,"transloco"),d(),l(20,"input",22),M(21,"transloco"),oe("ngModelChange",function(n){v(e);let o=f();return ne(o.confirmPassword,n)||(o.confirmPassword=n),C(n)}),g("keydown.enter",function(){v(e);let n=f();return C(n.submitPasswordChange())}),d(),O(22,Do,3,3,"p",20),d(),O(23,xo,3,1,"div",23),O(24,Io,4,3,"div",24),l(25,"hlm-dialog-footer")(26,"button",25),g("click",function(){v(e);let n=f();return C(n.closePasswordDialog())}),y(27),M(28,"transloco"),d(),l(29,"button",26),g("click",function(){v(e);let n=f();return C(n.submitPasswordChange())}),O(30,ko,4,3)(31,To,3,3,"span"),d()()()()}if(i&2){let e=f();c(3),E(D(4,18,"shoppingList.avatar.changePassword")),c(3),A(" ",D(7,20,"shoppingList.avatar.passwordDialogDescription")," "),c(5),A(" ",D(12,22,"shoppingList.avatar.newPassword")," "),c(2),ie("ngModel",e.newPassword),T("placeholder",D(14,24,"shoppingList.avatar.newPasswordPlaceholder"))("disabled",e.isChangingPassword()),c(2),V(e.newPassword()&&!e.isPasswordValid()?15:-1),c(3),A(" ",D(19,26,"shoppingList.avatar.confirmPassword")," "),c(2),ie("ngModel",e.confirmPassword),T("placeholder",D(21,28,"shoppingList.avatar.confirmPasswordPlaceholder"))("disabled",e.isChangingPassword()),c(2),V(e.confirmPassword()&&!e.passwordsMatch()?22:-1),c(),V(e.passwordError()?23:-1),c(),V(e.passwordSuccess()?24:-1),c(2),T("disabled",e.isChangingPassword()),c(),A(" ",D(28,30,"common.cancel")," "),c(2),T("disabled",e.isChangingPassword()||!e.isPasswordValid()||!e.passwordsMatch()||!e.newPassword()||!e.confirmPassword()),c(),V(e.isChangingPassword()?30:31)}}var Bn=(()=>{class i{authService=r(Vi);passwordDialog=_e.required("passwordDialog");user=this.authService.user;userEmail=a(()=>this.user()?.email??"");userInitials=a(()=>{let e=this.userEmail();if(!e)return"?";let t=e.indexOf("@");return t===-1?e.substring(0,1).toUpperCase():e.substring(0,t)});newPassword=b("");confirmPassword=b("");isChangingPassword=b(!1);passwordError=b("");passwordSuccess=b(!1);passwordsMatch=a(()=>{let e=this.newPassword(),t=this.confirmPassword();return!e||!t?!0:e===t});isPasswordValid=a(()=>this.newPassword().length>=6);handleLogout(){this.authService.logout()}handleChangePassword(){this.resetPasswordForm(),this.passwordDialog().open()}closePasswordDialog(){this.passwordDialog().close(),this.resetPasswordForm()}resetPasswordForm(){this.newPassword.set(""),this.confirmPassword.set(""),this.passwordError.set(""),this.passwordSuccess.set(!1)}async submitPasswordChange(){if(!this.isPasswordValid()){this.passwordError.set("Password must be at least 6 characters");return}if(!this.passwordsMatch()){this.passwordError.set("Passwords do not match");return}this.isChangingPassword.set(!0),this.passwordError.set("");try{await this.authService.updatePassword(this.newPassword()),this.passwordSuccess.set(!0),setTimeout(()=>{this.closePasswordDialog()},1500)}catch(e){this.passwordError.set(e?.message||"Failed to update password")}finally{this.isChangingPassword.set(!1)}}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=I({type:i,selectors:[["gh-user-avatar"]],viewQuery:function(t,n){t&1&&he(n.passwordDialog,Co,5),t&2&&te()},features:[B([Q({lucideUser:cn,lucideLogOut:on,lucideKeyRound:nn})])],decls:11,vars:2,consts:[["menu",""],["passwordDialog",""],[1,"group","flex","items-center","gap-2","px-3","py-1.5","rounded-full","border","border-border","bg-background","hover:bg-accent","transition-all","duration-200","hover:shadow-md",3,"brnMenuTriggerFor"],[1,"relative","flex","items-center","justify-center","w-8","h-8","rounded-full","bg-gradient-to-br","from-primary/20","to-primary/5","border","border-primary/20"],["hlm","","name","lucideUser","size","sm",1,"text-primary"],[1,"text-sm","font-medium","text-foreground","group-hover:text-primary","transition-colors"],[1,"w-56"],["closeDelay","100",3,"closed"],["hlm",""],[4,"brnDialogContent"],[1,"text-xs","text-muted-foreground","font-normal","truncate","px-2"],["hlmMenuItem","",3,"click"],["hlmMenuItemIcon","","name","lucideKeyRound","size","sm"],["hlmMenuItemIcon","","name","lucideLogOut","size","sm"],["hlmDialogTitle",""],["hlmDialogDescription",""],[1,"space-y-4"],[1,"space-y-2"],["hlmLabel","","for","newPassword"],["hlmInput","","type","password","id","newPassword",3,"ngModelChange","keydown.enter","ngModel","placeholder","disabled"],[1,"text-sm","text-destructive"],["hlmLabel","","for","confirmPassword"],["hlmInput","","type","password","id","confirmPassword",3,"ngModelChange","keydown.enter","ngModel","placeholder","disabled"],[1,"p-3","rounded-md","bg-destructive/10","border","border-destructive/20"],[1,"p-3","rounded-md","bg-green-500/10","border","border-green-500/20"],["hlmBtn","","type","button","variant","outline",3,"click","disabled"],["hlmBtn","","type","button",3,"click","disabled"],[1,"text-sm","text-green-600","dark:text-green-400"],["size","small"]],template:function(t,n){if(t&1){let o=R();l(0,"button",2)(1,"div",3),S(2,"ng-icon",4),d(),l(3,"span",5),y(4),d()(),ee(5,yo,15,7,"ng-template",6,0,Ai),l(7,"brn-dialog",7,1),g("closed",function(){return v(o),C(n.closePasswordDialog())}),S(9,"brn-dialog-overlay",8),ee(10,wo,32,32,"hlm-dialog-content",9),d()}if(t&2){let o=Ii(6);T("brnMenuTriggerFor",o),c(4),A(" ",n.userInitials()," ")}},dependencies:[He,be,Be,Ae,Pe,Vt,Ot,Rt,jt,Nt,$,ae,re,le,at,it,nt,ot,st,tt,rt,Fe,wn,Y,Je,Le,Se],encapsulation:2,changeDetection:0})}return i})();var ut=(()=>{class i{supabase=r($e);currentListId=b(null);loadingCount=b(0);loading=a(()=>this.loadingCount()>0);items=Ke({params:()=>({listId:this.currentListId()}),loader:async({params:e})=>{if(!e.listId)return[];let{data:t,error:n}=await this.supabase.supabase.from("shopping_list_item").select("*").eq("list_id",e.listId).order("created_at",{ascending:!1});if(n)throw n;return t??[]}});count=a(()=>this.items.value()?.length??0);setCurrentList(e){this.currentListId.set(e)}addItem(e,t){let n=this.currentListId();return n?(this.loadingCount.update(o=>o+1),ce(this.supabase.supabase.from("shopping_list_item").insert({product_name:e,additional_info:t,list_id:n,active:!0,active_changed:new Date().toISOString()}).select().single()).pipe(de(o=>G({error:o})),U(()=>this.loadingCount.update(o=>o-1)),ze(o=>{if(o?.error)throw o.error;this.items.reload()}),ye(o=>{if(o?.error)throw o.error;return G(o.data)}))):G({error:new Error("No list selected")})}updateItem(e,t){return this.loadingCount.update(n=>n+1),ce(this.supabase.supabase.from("shopping_list_item").update(t).eq("id",e).select().single()).pipe(de(n=>G({error:n})),U(()=>this.loadingCount.update(n=>n-1)),ze(n=>{if(n?.error)throw n.error;this.items.reload()}),ye(n=>{if(n?.error)throw n.error;return G(n.data)}))}deleteItem(e){return this.loadingCount.update(t=>t+1),ce(this.supabase.supabase.from("shopping_list_item").delete().eq("id",e)).pipe(de(t=>G({error:t})),U(()=>this.loadingCount.update(t=>t-1)),ze(t=>{if(t?.error)throw t.error;this.items.reload()}),ye(t=>{if(t?.error)throw t.error;return G(void 0)}))}toggleItem(e,t){return this.updateItem(e,{active:t,active_changed:new Date().toISOString()})}static \u0275fac=function(t){return new(t||i)};static \u0275prov=ue({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var So=["*"],Ho={hasBackdrop:!1,scrollStrategy:"reposition"},mt=(()=>{class i extends Y{align=s("center");sideOffset=s(0,{transform:xt});offsetX=s(0,{transform:xt});_positionStrategy;constructor(){super(),this.setAriaDescribedBy(""),this.setAriaLabelledBy(""),H(()=>{let e=this.align();se(()=>{this.mutableAttachPositions.set([{originX:e,originY:"bottom",overlayX:e,overlayY:"top"},{originX:e,originY:"top",overlayX:e,overlayY:"bottom"}])}),se(()=>{this.applySideOffset(this.sideOffset())})}),H(()=>{let e=this.sideOffset();se(()=>{this.applySideOffset(e)})}),H(()=>{let e=this.offsetX();se(()=>{this.applyOffsetX(e)})}),H(()=>{let e=this.mutableAttachTo(),t=this.mutableAttachPositions();!e||!t||t.length===0||se(()=>{this._positionStrategy?this._positionStrategy.setOrigin(e):this._positionStrategy=this.positionBuilder.flexibleConnectedTo(e).withPush(!1),this._positionStrategy.withPositions(t),this.mutablePositionStrategy.set(this._positionStrategy)})})}applySideOffset(e){this.mutableAttachPositions.update(t=>t.map(n=>De(j({},n),{offsetY:n.originY==="top"?-e:e})))}applyOffsetX(e){this.mutableAttachPositions.update(t=>t.map(n=>De(j({},n),{offsetX:e})))}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=I({type:i,selectors:[["brn-popover"]],inputs:{align:[1,"align"],sideOffset:[1,"sideOffset"],offsetX:[1,"offsetX"]},exportAs:["brnPopover"],features:[B([{provide:Y,useExisting:Ge(()=>i)},gn(Ho)]),Me],ngContentSelectors:So,decls:1,vars:0,template:function(t,n){t&1&&(F(),P(0))},encapsulation:2,changeDetection:0})}return i})();var An=(()=>{class i extends Le{static \u0275fac=(()=>{let e;return function(n){return(e||(e=Ue(i)))(n||i)}})();static \u0275dir=h({type:i,selectors:[["","brnPopoverContent",""]],features:[B([pn(()=>i)]),Me]})}return i})();var Wt=new X("BrnAutocompleteItemToken");function Ao(i){return{provide:Wt,useExisting:i}}var Pn=new X("BrnAutocompleteToken");function Po(i){return{provide:Pn,useExisting:i}}function qt(){return r(Pn)}var pt=(()=>{class i{static _id=0;_injector=r(ge);id=s(`brn-autocomplete-${++i._id}`);valueChange=q();selectionCleared=q();_brnPopover=r(mt,{optional:!0});_focus=b("first");items=Qe(Wt,{descendants:!0});keyManager=new hn(this.items,this._injector);isExpanded=a(()=>this._brnPopover?.stateComputed()==="open");constructor(){this.keyManager.withVerticalOrientation().withHomeAndEnd().withWrap().skipPredicate(e=>e.disabled),H(()=>{let e=this.items(),t=this._focus();se(()=>{if(!e.length)return;let n=this.keyManager.activeItem;(!n||!e.includes(n))&&(t==="first"?this.keyManager.setFirstItemActive():this.keyManager.setLastItemActive())})}),this.keyManager.change.pipe(we()).subscribe(()=>{let e=this.keyManager.activeItem?.value();e&&this.valueChange.emit(e)})}selectActiveItem(){this._brnPopover?.stateComputed()==="open"&&this.keyManager.activeItem?.selected.emit()}open(e="first"){this._brnPopover?.open(),this._focus.set(e)}close(){this._brnPopover?.close()}toggle(){this.isExpanded()?this.close():this.open()}static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["","brnAutocomplete",""]],contentQueries:function(t,n,o){t&1&&qe(o,n.items,Wt,5),t&2&&te()},hostVars:1,hostBindings:function(t,n){t&1&&g("keydown.enter",function(){return n.selectActiveItem()}),t&2&&z("id",n.id())},inputs:{id:[1,"id"]},outputs:{valueChange:"valueChange",selectionCleared:"selectionCleared"},features:[B([Po(i)])]})}return i})(),Ln=(()=>{class i{_templateRef=r(vi);_viewContainerRef=r(We);_autocomplete=qt();_visible=a(()=>this._autocomplete.items().length>0);constructor(){H(()=>{this._visible()?this._viewContainerRef.clear():this._viewContainerRef.createEmbeddedView(this._templateRef)})}static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["","brnAutocompleteEmpty",""]]})}return i})(),Fn=(()=>{class i{static _id=0;id=s(`brn-autocomplete-group-${++i._id}`);static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["","brnAutocompleteGroup",""]],hostAttrs:["role","group"],hostVars:1,hostBindings:function(t,n){t&2&&z("id",n.id())},inputs:{id:[1,"id"]}})}return i})(),En=(()=>{class i{static _id=0;_platform=r(bi);_elementRef=r(N);_autocomplete=qt();id=s(`brn-autocomplete-item-${++i._id}`);value=s.required();_disabled=s(!1,{alias:"disabled",transform:L});get disabled(){return this._disabled()}_active=b(!1);selected=q();getLabel(){return this._elementRef.nativeElement.textContent?.trim()??""}setActiveStyles(){this._active.set(!0),Fi(this._platform)&&this._elementRef.nativeElement.scrollIntoView({block:"nearest"})}setInactiveStyles(){this._active.set(!1)}onClick(){this._autocomplete.keyManager.setActiveItem(this),this.selected.emit()}activate(){this._disabled()||this._autocomplete.keyManager.setActiveItem(this)}static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["button","brnAutocompleteItem",""]],hostAttrs:["type","button","role","option","tabIndex","-1"],hostVars:6,hostBindings:function(t,n){t&1&&g("click",function(){return n.onClick()})("mouseenter",function(){return n.activate()}),t&2&&(z("id",n.id()),k("disabled",n._disabled()?!0:null)("data-disabled",n._disabled()?"":null)("data-value",n.value())("aria-selected",n._active())("data-selected",n._active()?"":null))},inputs:{id:[1,"id"],value:[1,"value"],_disabled:[1,"disabled","_disabled"]},outputs:{selected:"selected"},features:[B([Ao(i)])]})}return i})(),Nn=(()=>{class i{static _id=0;id=s(`brn-autocomplete-list-${++i._id}`);static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["","brnAutocompleteList",""]],hostAttrs:["role","listbox"],hostVars:1,hostBindings:function(t,n){t&2&&z("id",n.id())},inputs:{id:[1,"id"]}})}return i})(),On=(()=>{class i{_autocomplete=qt();_isExpanded=this._autocomplete.isExpanded;_activeDescendant=b(void 0);constructor(){this._autocomplete.keyManager.change.pipe(pe(this._autocomplete.keyManager.activeItemIndex),we()).subscribe(()=>{this._activeDescendant.set(this._autocomplete.keyManager.activeItem?.id())})}onKeyDown(e){e.key==="Enter"&&e.preventDefault(),this._isExpanded()||(e.key==="ArrowDown"&&this._autocomplete.open("first"),e.key==="ArrowUp"&&this._autocomplete.open("last"),e.key==="Escape"&&this._autocomplete.selectionCleared.emit()),this._autocomplete.keyManager.onKeydown(e)}static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["input","brnAutocompleteSearchInput",""]],hostAttrs:["role","combobox","aria-autocomplete","list"],hostVars:2,hostBindings:function(t,n){t&1&&g("keydown",function(p){return n.onKeyDown(p)}),t&2&&k("aria-activedescendant",n._activeDescendant())("aria-expanded",n._isExpanded())}})}return i})();var Kt=(()=>{class i{_stateProvider=mn({host:!0});state=this._stateProvider.state??b("closed");_renderer=r(xe);_element=r(N);constructor(){H(()=>{this._renderer.setAttribute(this._element.nativeElement,"data-state",this.state())})}userClass=s("",{alias:"class"});_computedClass=a(()=>u("border-border bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative w-72 rounded-md border p-4 shadow-md outline-none",this.userClass()));static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["","hlmPopoverContent",""],["","brnPopoverContent","","hlm",""]],hostVars:2,hostBindings:function(t,n){t&2&&_(n._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return i})();var Qt=(()=>{class i{userClass=s("",{alias:"class"});_computedClass=a(()=>u("py-6 text-center text-sm",this.userClass()));static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["","hlmAutocompleteEmpty",""]],hostVars:2,hostBindings:function(t,n){t&2&&_(n._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return i})();var Fo=["*"],$t=(()=>{class i{userClass=s("",{alias:"class"});_computedClass=a(()=>u("text-foreground block overflow-hidden p-1",this.userClass()));static \u0275fac=function(t){return new(t||i)};static \u0275cmp=I({type:i,selectors:[["hlm-autocomplete-group"]],hostVars:2,hostBindings:function(t,n){t&2&&_(n._computedClass())},inputs:{userClass:[1,"class","userClass"]},features:[w([{directive:Fn,inputs:["id","id"]}])],ngContentSelectors:Fo,decls:1,vars:0,template:function(t,n){t&1&&(F(),P(0))},encapsulation:2,changeDetection:0})}return i})();var Eo=["hlm-autocomplete-item",""],No=["*"],Yt=(()=>{class i{userClass=s("",{alias:"class"});_computedClass=a(()=>u("data-[selected]:bg-accent data-[selected=true]:text-accent-foreground [&>ng-icon]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-start text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[hidden]:hidden [&>ng-icon]:pointer-events-none [&>ng-icon]:shrink-0 [&>ng-icon]:text-base",this.userClass()));static \u0275fac=function(t){return new(t||i)};static \u0275cmp=I({type:i,selectors:[["button","hlm-autocomplete-item",""]],hostVars:2,hostBindings:function(t,n){t&2&&_(n._computedClass())},inputs:{userClass:[1,"class","userClass"]},features:[w([{directive:En,inputs:["value","value","disabled","disabled","id","id"],outputs:["selected","selected"]}])],attrs:Eo,ngContentSelectors:No,decls:1,vars:0,template:function(t,n){t&1&&(F(),P(0))},encapsulation:2,changeDetection:0})}return i})();var Oo=["*"],Xt=(()=>{class i{userClass=s("",{alias:"class"});_computedClass=a(()=>u("block max-h-60 overflow-x-hidden overflow-y-auto",this.userClass()));static \u0275fac=function(t){return new(t||i)};static \u0275cmp=I({type:i,selectors:[["hlm-autocomplete-list"]],hostVars:2,hostBindings:function(t,n){t&2&&_(n._computedClass())},inputs:{userClass:[1,"class","userClass"]},features:[w([{directive:Nn,inputs:["id","id"]}])],ngContentSelectors:Oo,decls:1,vars:0,template:function(t,n){t&1&&(F(),P(0))},encapsulation:2,changeDetection:0})}return i})();var Zt=(()=>{class i{userClass=s("",{alias:"class"});_computedClass=a(()=>u("group/input-group border-input dark:bg-input/30 relative flex w-full items-center rounded-md border shadow-xs transition-[color,box-shadow] outline-none","h-9 min-w-0 has-[>textarea]:h-auto","has-[>[data-align=inline-start]]:[&>input]:pl-2","has-[>[data-align=inline-end]]:[&>input]:pr-2","has-[>[data-align=block-start]]:h-auto has-[>[data-align=block-start]]:flex-col has-[>[data-align=block-start]]:[&>input]:pb-3","has-[>[data-align=block-end]]:h-auto has-[>[data-align=block-end]]:flex-col has-[>[data-align=block-end]]:[&>input]:pt-3","has-[[data-slot=input-group-control]:focus-visible]:border-ring has-[[data-slot=input-group-control]:focus-visible]:ring-ring/50 has-[[data-slot=input-group-control]:focus-visible]:ring-[3px]","has-[>.ng-invalid.ng-touched]:ring-destructive/20 has-[>.ng-invalid.ng-touched]:border-destructive dark:has-[>.ng-invalid.ng-touched]:ring-destructive/40",this.userClass()));static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["","hlmInputGroup",""],["hlm-input-group"]],hostAttrs:["data-slot","input-group","role","group"],hostVars:2,hostBindings:function(t,n){t&2&&_(n._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return i})();var Vo=K("text-muted-foreground flex h-auto cursor-text items-center justify-center gap-2 py-1.5 text-sm font-medium select-none group-data-[disabled=true]/input-group:opacity-50 [&>kbd]:rounded-[calc(var(--radius)-5px)] [&>ng-icon:not([class*='text-'])]:text-base",{variants:{align:{"inline-start":"order-first pl-3 has-[>button]:ml-[-0.45rem] has-[>kbd]:ml-[-0.35rem]","inline-end":"order-last pr-3 has-[>button]:mr-[-0.45rem] has-[>kbd]:mr-[-0.35rem]","block-start":"order-first w-full justify-start px-3 pt-3 group-has-[>input]/input-group:pt-2.5 [.border-b]:pb-3","block-end":"order-last w-full justify-start px-3 pb-3 group-has-[>input]/input-group:pb-2.5 [.border-t]:pt-3"}},defaultVariants:{align:"inline-start"}}),Jt=(()=>{class i{align=s("inline-start");userClass=s("",{alias:"class"});_computedClass=a(()=>u(Vo({align:this.align()}),this.userClass()));static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["hlm-input-group-addon"],["","hlmInputGroupAddon",""]],hostAttrs:["role","group","data-slot","input-group-addon"],hostVars:3,hostBindings:function(t,n){t&2&&(k("data-align",n.align()),_(n._computedClass()))},inputs:{align:[1,"align"],userClass:[1,"class","userClass"]}})}return i})();var Ro=K("flex items-center gap-2 text-sm shadow-none",{variants:{size:{xs:"h-6 gap-1 rounded-[calc(var(--radius)-5px)] px-2 has-[>ng-icon]:px-2 [&>ng-icon:not([class*='text-'])]:text-sm",sm:"h-8 gap-1.5 rounded-md px-2.5 has-[>ng-icon]:px-2.5","icon-xs":"size-6 rounded-[calc(var(--radius)-5px)] p-0 has-[>ng-icon]:p-0","icon-sm":"size-8 p-0 has-[>ng-icon]:p-0"}},defaultVariants:{size:"xs"}}),ei=(()=>{class i{_hlmButton=r(re);size=s("xs");userClass=s("",{alias:"class"});_computedClass=a(()=>u(Ro({size:this.size()}),this.userClass()));constructor(){H(()=>{this._hlmButton.setClass(this._computedClass())})}static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["button","hlmInputGroupButton",""]],hostVars:1,hostBindings:function(t,n){t&2&&k("data-size",n.size())},inputs:{size:[1,"size"],userClass:[1,"class","userClass"]},features:[B([Ni({variant:"ghost"})]),w([{directive:re,inputs:["variant","variant"]}])]})}return i})();var ti=(()=>{class i{_hlmInput=r(le);userClass=s("",{alias:"class"});_computedClass=a(()=>u("flex-1 rounded-none border-0 bg-transparent shadow-none focus-visible:ring-0 dark:bg-transparent",this.userClass()));constructor(){H(()=>{this._hlmInput.setClass(this._computedClass())})}static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["input","hlmInputGroupInput",""]],hostAttrs:["data-slot","input-group-control"],hostVars:2,hostBindings:function(t,n){t&2&&_(n._computedClass())},inputs:{userClass:[1,"class","userClass"]},features:[w([le])]})}return i})();var Dd=K("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 dark:bg-input/30 flex [field-sizing:content] min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",{variants:{error:{auto:"[&.ng-invalid.ng-touched]:border-destructive [&.ng-invalid.ng-touched]:ring-destructive/20 dark:[&.ng-invalid.ng-touched]:ring-destructive/40",true:"border-destructive focus-visible:border-destructive focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40"}},defaultVariants:{error:"auto"}});var ii=(()=>{class i{_host=r(N,{host:!0});_brnDialog=r(Y,{optional:!0});disabledTrigger=s(!1,{transform:L});constructor(){this._brnDialog&&this._brnDialog.mutableAttachTo.set(this._host.nativeElement)}open(){this.disabledTrigger()||this._brnDialog?.open()}static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["","hlmAutocompleteTrigger",""]],hostBindings:function(t,n){t&1&&g("click",function(){return n.open()})},inputs:{disabledTrigger:[1,"disabledTrigger"]}})}return i})();function Rn(){return{transformValueToSearch:i=>typeof i=="string"?i:String(i),transformOptionToString:i=>typeof i=="string"?i:String(i),transformOptionToValue:void 0,requireSelection:!1,showClearBtn:!1,debounceTime:150}}var jn=new X("HlmAutocompleteConfig");function zn(i){return{provide:jn,useValue:j(j({},Rn()),i)}}function Gn(){return r(jn,{optional:!0})??Rn()}var Go=["input"],Uo=[[["","loading",""]],[["","empty",""]]],Wo=["[loading]","[empty]"],qo=i=>({$implicit:i});function Ko(i,m){if(i&1){let e=R();l(0,"button",13),g("click",function(){v(e);let n=f();return C(n._selectionCleared())}),S(1,"ng-icon",14),d()}if(i&2){let e=f();T("disabled",e._disabled())}}function Qo(i,m){i&1&&yi(0)}function $o(i,m){if(i&1&&ee(0,Qo,1,0,"ng-container",19),i&2){let e=f().$implicit;T("ngTemplateOutlet",m)("ngTemplateOutletContext",Bi(2,qo,e))}}function Yo(i,m){if(i&1&&y(0),i&2){let e=f().$implicit,t=f(2);A(" ",t.transformOptionToString()(e)," ")}}function Xo(i,m){if(i&1){let e=R();l(0,"button",18),g("selected",function(){let n=v(e).$implicit,o=f(2);return C(o._optionSelected(n))}),O(1,$o,1,4,"ng-container")(2,Yo,1,1),d()}if(i&2){let e,t=m.$implicit,n=f(2),o=Si(0);_(n._computedAutocompleteItemClass()),T("value",o?o(t):t),c(),V((e=n.optionTemplate())?1:2,e)}}function Zo(i,m){if(i&1&&y(0),i&2){let e=f(4);E(e.loadingText())}}function Jo(i,m){i&1&&P(0,0,null,Zo,1,1)}function es(i,m){if(i&1&&y(0),i&2){let e=f(4);E(e.emptyText())}}function ts(i,m){i&1&&P(0,1,null,es,1,1)}function is(i,m){if(i&1&&(l(0,"div",20),O(1,Jo,2,0)(2,ts,2,0),d()),i&2){let e=f(2);_(e._computedAutocompleteEmptyClass()),c(),V(e.loading()?1:2)}}function ns(i,m){if(i&1&&(l(0,"div",15)(1,"hlm-autocomplete-list")(2,"hlm-autocomplete-group"),Ie(3,Xo,3,4,"button",16,Ci),d()(),ee(5,is,3,3,"div",17),d()),i&2){let e=f();ki("width",e._elementRef.nativeElement.offsetWidth,"px"),c(),_(e._computedAutocompleteListClass()),fe("hidden",e.filteredOptions().length===0),c(2),ke(e.filteredOptions())}}var os={provide:Yi,useExisting:Ge(()=>ht),multi:!0},ht=(()=>{class i{static _id=0;_config=Gn();_brnAutocomplete=_e.required(pt);_inputRef=_e.required("input",{read:N});_elementRef=r(N);userClass=s("",{alias:"class"});_computedClass=a(()=>u("block w-full",this.userClass()));autocompleteSearchClass=s("");_computedAutocompleteSearchClass=a(()=>u("",this.autocompleteSearchClass()));autocompleteInputClass=s("");_computedAutocompleteInputClass=a(()=>u("",this.autocompleteInputClass()));autocompleteListClass=s("");_computedAutocompleteListClass=a(()=>u("",this.autocompleteListClass()));autocompleteItemClass=s("");_computedAutocompleteItemClass=a(()=>u("",this.autocompleteItemClass()));autocompleteEmptyClass=s("");_computedAutocompleteEmptyClass=a(()=>u("",this.autocompleteEmptyClass()));filteredOptions=s([]);value=me();debounceTime=s(this._config.debounceTime);search=me("");_search=un(this.search,this.debounceTime());transformValueToSearch=s(this._config.transformValueToSearch);requireSelection=s(this._config.requireSelection,{transform:L});transformOptionToString=s(this._config.transformOptionToString);transformOptionToValue=s(this._config.transformOptionToValue);displayWith=s(void 0);_displaySearchValue=a(()=>{let e=this.displayWith();return e||this.transformValueToSearch()});optionTemplate=s();loading=s(!1,{transform:L});showClearBtn=s(this._config.showClearBtn,{transform:L});searchPlaceholderText=s("Select an option");loadingText=s("Loading options...");emptyText=s("No options found");ariaLabelToggleButton=s("Toggle options");inputId=s(`hlm-autocomplete-input-${++i._id}`);disabled=s(!1,{transform:L});_disabled=Pi(()=>this.disabled());valueChange=q();searchChange=q();_onChange;_onTouched;constructor(){H(()=>{let e=this._search();this.searchChange.emit(e)})}_searchChanged(e){let t=e.target.value;this.search.set(t??""),!this._brnAutocomplete().isExpanded()&&t.length>0&&this._brnAutocomplete().open()}_toggleOptions(){(this._search()||this.filteredOptions().length>0)&&this._brnAutocomplete().toggle(),this._inputRef().nativeElement.focus()}_selectionCleared(){this.value.set(void 0),this._onChange?.(null),this.valueChange.emit(null),this.search.set("")}_optionSelected(e){let t=this.transformOptionToValue(),n=t?t(e):e;this.value.set(n),this._onChange?.(n),this.valueChange.emit(n);let o=this._displaySearchValue()(n);this.search.set(o??""),this._brnAutocomplete().close()}writeValue(e){this.value.set(e||void 0);let t=e?this._displaySearchValue()(e):"";this.search.set(t)}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this._disabled.set(e)}_closed(){if(this.requireSelection()){let e=this.value(),t=e?this._displaySearchValue()(e):"";this.search.set(t??"")}}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=I({type:i,selectors:[["hlm-autocomplete"]],viewQuery:function(t,n){t&1&&(he(n._brnAutocomplete,pt,5),he(n._inputRef,Go,5,N)),t&2&&te(2)},hostVars:2,hostBindings:function(t,n){t&2&&_(n._computedClass())},inputs:{userClass:[1,"class","userClass"],autocompleteSearchClass:[1,"autocompleteSearchClass"],autocompleteInputClass:[1,"autocompleteInputClass"],autocompleteListClass:[1,"autocompleteListClass"],autocompleteItemClass:[1,"autocompleteItemClass"],autocompleteEmptyClass:[1,"autocompleteEmptyClass"],filteredOptions:[1,"filteredOptions"],value:[1,"value"],debounceTime:[1,"debounceTime"],search:[1,"search"],transformValueToSearch:[1,"transformValueToSearch"],requireSelection:[1,"requireSelection"],transformOptionToString:[1,"transformOptionToString"],transformOptionToValue:[1,"transformOptionToValue"],displayWith:[1,"displayWith"],optionTemplate:[1,"optionTemplate"],loading:[1,"loading"],showClearBtn:[1,"showClearBtn"],searchPlaceholderText:[1,"searchPlaceholderText"],loadingText:[1,"loadingText"],emptyText:[1,"emptyText"],ariaLabelToggleButton:[1,"ariaLabelToggleButton"],inputId:[1,"inputId"],disabled:[1,"disabled"]},outputs:{value:"valueChange",search:"searchChange",valueChange:"valueChange",searchChange:"searchChange"},features:[B([os,Q({lucideSearch:rn,lucideChevronDown:en,lucideCircleX:tn})])],ngContentSelectors:Wo,decls:14,vars:14,consts:[["popover",""],["input",""],["align","start","autoFocus","first-heading","sideOffset","5","closeDelay","100",3,"closed","closeOnOutsidePointerEvents"],["brnAutocomplete","",3,"selectionCleared"],["hlmInputGroup","","hlmAutocompleteTrigger","",3,"disabledTrigger"],["brnAutocompleteSearchInput","","hlmInputGroupInput","","type","text","autocomplete","off",3,"input","id","placeholder","disabled","value"],["hlmInputGroupAddon",""],["name","lucideSearch"],["hlmInputGroupAddon","","align","inline-end"],["hlmInputGroupButton","","type","button","tabindex","-1","aria-label","clear","size","icon-xs",3,"disabled"],["hlmInputGroupButton","","type","button","tabindex","-1","size","icon-xs",3,"click","disabled"],["name","lucideChevronDown"],["hlmPopoverContent","","class","p-0",3,"width",4,"brnPopoverContent"],["hlmInputGroupButton","","type","button","tabindex","-1","aria-label","clear","size","icon-xs",3,"click","disabled"],["name","lucideCircleX"],["hlmPopoverContent","",1,"p-0"],["hlm-autocomplete-item","",3,"class","value"],["hlmAutocompleteEmpty","",3,"class",4,"brnAutocompleteEmpty"],["hlm-autocomplete-item","",3,"selected","value"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["hlmAutocompleteEmpty",""]],template:function(t,n){if(t&1){let o=R();F(Uo),Ti(0),l(1,"brn-popover",2,0),g("closed",function(){return v(o),C(n._closed())}),l(3,"div",3),g("selectionCleared",function(){return v(o),C(n._selectionCleared())}),l(4,"div",4)(5,"input",5,1),g("input",function(Ee){return v(o),C(n._searchChanged(Ee))}),d(),l(7,"div",6),S(8,"ng-icon",7),d(),l(9,"div",8),O(10,Ko,2,1,"button",9),l(11,"button",10),g("click",function(){return v(o),C(n._toggleOptions())}),S(12,"ng-icon",11),d()()(),ee(13,ns,6,6,"div",12),d()()}t&2&&(wi(n.transformOptionToValue()),c(),T("closeOnOutsidePointerEvents",!0),c(3),_(n._computedAutocompleteSearchClass()),T("disabledTrigger",!n._search()||n._disabled()),c(),_(n._computedAutocompleteInputClass()),T("id",n.inputId())("placeholder",n.searchPlaceholderText())("disabled",n._disabled())("value",n.search()),c(5),V(n.showClearBtn()&&n.value()!==void 0?10:-1),c(),T("disabled",n._disabled()),k("aria-label",n.ariaLabelToggleButton()))},dependencies:[Li,pt,Ln,Qt,$t,Yt,Xt,ii,mt,An,Kt,ae,Zt,Jt,ei,ti,On],encapsulation:2,changeDetection:0})}return i})();function rs(i,m){if(i&1){let e=R();l(0,"input",7),g("ngModelChange",function(n){v(e);let o=f();return C(o.editingName.set(n))})("blur",function(){v(e);let n=f();return C(n.saveInline())})("keydown.enter",function(n){v(e);let o=f();return n.preventDefault(),C(o.saveInline())})("keydown.escape",function(){v(e);let n=f();return C(n.cancelEdit())}),d()}if(i&2){let e=f();T("id",Hi("edit-",e.item().id))("ngModel",e.editingName())}}function as(i,m){if(i&1){let e=R();l(0,"div",5)(1,"h3",8),g("click",function(){v(e);let n=f();return C(n.startEdit())}),y(2),d()()}if(i&2){let e=f();c(2),A(" ",e.item().product_name," ")}}var Un=(()=>{class i{service=r(ut);item=s.required();itemUpdated=q();itemDeleted=q();busyCount=b(0);busy=a(()=>this.busyCount()>0);editingName=b(null);isEditing=a(()=>this.editingName()!==null);toggleItem(){let e=this.item();this.busyCount.update(t=>t+1),this.service.toggleItem(e.id,!e.active).pipe(U(()=>this.busyCount.update(t=>t-1))).subscribe({next:()=>this.itemUpdated.emit(),error:t=>console.error("Toggle error:",t)})}onBasketToggle(e){let t=this.item(),n=e==="on";t.active!==n&&(this.busyCount.update(o=>o+1),this.service.toggleItem(t.id,n).pipe(U(()=>this.busyCount.update(o=>o-1))).subscribe({next:()=>this.itemUpdated.emit(),error:o=>console.error("Toggle error:",o)}))}deleteItem(){if(!confirm("Are you sure you want to delete this item?"))return;let e=this.item();this.busyCount.update(t=>t+1),this.service.deleteItem(e.id).pipe(U(()=>this.busyCount.update(t=>t-1))).subscribe({next:()=>this.itemDeleted.emit(),error:t=>console.error("Delete error:",t)})}startEdit(){this.editingName.set(this.item().product_name??""),setTimeout(()=>{let e=document.getElementById("edit-"+this.item().id);e?.focus(),e?.select()},0)}saveInline(){let e=(this.editingName()||"").trim(),t=this.item();if(e===(t.product_name??"").trim()){this.cancelEdit();return}this.busyCount.update(n=>n+1),this.service.updateItem(t.id,{product_name:e}).pipe(U(()=>{this.busyCount.update(n=>n-1),this.cancelEdit()})).subscribe({next:()=>this.itemUpdated.emit(),error:n=>console.error("Update error:",n)})}cancelEdit(){this.editingName.set(null)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=I({type:i,selectors:[["lib-shopping-list-item-card"]],inputs:{item:[1,"item"]},outputs:{itemUpdated:"itemUpdated",itemDeleted:"itemDeleted"},features:[B([Q({lucideTrash:Ze})])],decls:7,vars:4,consts:[["hlmCard","",1,"group","p-2","sm:p-3","relative"],["hlmCardContent",""],[1,"flex","items-center","gap-3","w-full"],[1,"flex-1","min-w-0"],["hlmInput","",1,"w-full",3,"id","ngModel"],[1,"h-8","flex","items-center"],["size","sm","variant","outline",1,"ml-auto",3,"stateChange","state"],["hlmInput","",1,"w-full",3,"ngModelChange","blur","keydown.enter","keydown.escape","id","ngModel"],["hlmCardTitle","",1,"truncate","cursor-pointer","hover:text-primary",3,"click"]],template:function(t,n){t&1&&(l(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),O(4,rs,1,3,"input",4)(5,as,3,1,"div",5),d(),l(6,"gh-shopping-basket-toggle",6),g("stateChange",function(p){return n.onBasketToggle(p)}),d()()()()),t&2&&(fe("opacity-60",!n.item().active),c(4),V(n.isEditing()?4:5),c(2),T("state",n.item().active?"on":"off"))},dependencies:[Te,be,Be,Ae,Pe,fn,bn,_n,le,Cn],encapsulation:2,changeDetection:0})}return i})();var _t=(()=>{class i{orientation=s("horizontal");$orientation=this.orientation;direction=s("ltr");$direction=this.direction;activeTab=me(void 0,{alias:"brnTabs"});$activeTab=this.activeTab.asReadonly();activationMode=s("automatic");$activationMode=this.activationMode;tabActivated=q();_tabs=b({});$tabs=this._tabs.asReadonly();registerTrigger(e,t){this.updateEntry(e,{trigger:t})}registerContent(e,t){this.updateEntry(e,{content:t})}unregisterTrigger(e){this.updateEntry(e,{trigger:void 0}),this.activeTab()===e&&this.activeTab.set(void 0)}unregisterContent(e){this.updateEntry(e,{content:void 0})}updateEntry(e,t){this._tabs.update(n=>{let o=n[e]??{},p=j(j({},o),t);if(!p.trigger&&!p.content){let ai=n,{[e]:xs}=ai;return ci(ai,[li(e)])}return De(j({},n),{[e]:p})})}emitTabActivated(e){this.tabActivated.emit(e)}setActiveTab(e){this.activeTab.set(e)}static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["","brnTabs",""]],hostVars:2,hostBindings:function(t,n){t&2&&k("data-orientation",n.orientation())("dir",n.direction())},inputs:{orientation:[1,"orientation"],direction:[1,"direction"],activeTab:[1,"brnTabs","activeTab"],activationMode:[1,"activationMode"]},outputs:{activeTab:"brnTabsChange",tabActivated:"tabActivated"},exportAs:["brnTabs"]})}return i})();var ft=(()=>{class i{elementRef=r(N);_root=r(_t);_orientation=this._root.$orientation;triggerFor=s.required({alias:"brnTabsTrigger"});selected=a(()=>this._root.$activeTab()===this.triggerFor());_contentId=a(()=>`brn-tabs-content-${this.triggerFor()}`);_labelId=a(()=>`brn-tabs-label-${this.triggerFor()}`);_disabled=s(!1,{alias:"disabled",transform:L});get disabled(){return this._disabled()}constructor(){H(()=>{let e=this.triggerFor();se(()=>this._root.registerTrigger(e,this))})}focus(){this.elementRef.nativeElement.focus(),this._root.$activationMode()==="automatic"&&this.activate()}activate(){this.triggerFor()&&(this._root.setActiveTab(this.triggerFor()),this._root.emitTabActivated(this.triggerFor()))}get key(){return this.triggerFor()}ngOnDestroy(){this._root.unregisterTrigger(this.triggerFor())}static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["button","brnTabsTrigger",""]],hostAttrs:["type","button","role","tab"],hostVars:9,hostBindings:function(t,n){t&1&&g("click",function(){return n.activate()}),t&2&&(z("id",n._labelId())("tabIndex",n._disabled()?-1:n.selected()?0:-1),k("aria-selected",n.selected())("aria-controls",n._contentId())("aria-disabled",n._disabled())("data-state",n.selected()?"active":"inactive")("data-orientation",n._orientation())("data-disabled",n._disabled()?"":void 0)("disabled",n._disabled()?"":void 0))},inputs:{triggerFor:[1,"brnTabsTrigger","triggerFor"],_disabled:[1,"disabled","_disabled"]},exportAs:["brnTabsTrigger"]})}return i})(),Wn=(()=>{class i{_root=r(_t);_orientation=this._root.$orientation;_direction=this._root.$direction;_activeTab=this._root.$activeTab;_tabs=this._root.$tabs;_elementRef=r(N);_keyDownListener=mi(this._elementRef.nativeElement,"keydown");_keyManager;triggers=Qe(ft,{descendants:!0});ngAfterContentInit(){this._keyManager=new et(this.triggers()).withHorizontalOrientation(this._direction()).withHomeAndEnd().withPageUpDown().withWrap(),this._keyDownListener.pipe(pi(1)).subscribe(()=>{let e=this._activeTab(),t=this._tabs(),n=0;if(e){let o=t[e];o&&(n=this.triggers().indexOf(o.trigger))}this._keyManager?.setActiveItem(n)}),this._keyDownListener.subscribe(e=>{"key"in e&&(this._orientation()==="horizontal"&&(e.key==="ArrowUp"||e.key==="ArrowDown")||this._orientation()==="vertical"&&(e.key==="ArrowLeft"||e.key==="ArrowRight"))||this._keyManager?.onKeydown(e)})}static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["","brnTabsList",""]],contentQueries:function(t,n,o){t&1&&qe(o,n.triggers,ft,5),t&2&&te()},hostAttrs:["role","tablist"],hostVars:2,hostBindings:function(t,n){t&2&&k("aria-orientation",n._orientation())("data-orientation",n._orientation())},exportAs:["brnTabsList"]})}return i})();var hm=zi({passive:!0});var ls=["*"],oi=(()=>{class i{tab=s.required();userClass=s("",{alias:"class"});_computedClass=a(()=>u("flex flex-col gap-2",this.userClass()));static \u0275fac=function(t){return new(t||i)};static \u0275cmp=I({type:i,selectors:[["hlm-tabs"]],hostVars:2,hostBindings:function(t,n){t&2&&_(n._computedClass())},inputs:{tab:[1,"tab"],userClass:[1,"class","userClass"]},features:[w([{directive:_t,inputs:["orientation","orientation","direction","direction","activationMode","activationMode","brnTabs","tab"],outputs:["tabActivated","tabActivated"]}])],ngContentSelectors:ls,decls:1,vars:0,template:function(t,n){t&1&&(F(),P(0))},encapsulation:2,changeDetection:0})}return i})();var cs=["*"],qn=K("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",{variants:{orientation:{horizontal:"h-10 space-x-1",vertical:"mt-2 h-fit flex-col space-y-1"}},defaultVariants:{orientation:"horizontal"}}),si=(()=>{class i{orientation=s("horizontal");userClass=s("",{alias:"class"});_computedClass=a(()=>u(qn({orientation:this.orientation()}),this.userClass()));static \u0275fac=function(t){return new(t||i)};static \u0275cmp=I({type:i,selectors:[["hlm-tabs-list"]],hostVars:2,hostBindings:function(t,n){t&2&&_(n._computedClass())},inputs:{orientation:[1,"orientation"],userClass:[1,"class","userClass"]},features:[w([Wn])],ngContentSelectors:cs,decls:1,vars:0,template:function(t,n){t&1&&(F(),P(0))},encapsulation:2,changeDetection:0})}return i})();var ri=(()=>{class i{triggerFor=s.required({alias:"hlmTabsTrigger"});userClass=s("",{alias:"class"});_computedClass=a(()=>u("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_ng-icon]:pointer-events-none [&_ng-icon]:shrink-0 [&_ng-icon]:text-base",this.userClass()));static \u0275fac=function(t){return new(t||i)};static \u0275dir=h({type:i,selectors:[["","hlmTabsTrigger",""]],hostVars:2,hostBindings:function(t,n){t&2&&_(n._computedClass())},inputs:{triggerFor:[1,"hlmTabsTrigger","triggerFor"],userClass:[1,"class","userClass"]},features:[w([{directive:ft,inputs:["brnTabsTrigger","hlmTabsTrigger","disabled","disabled"]}])]})}return i})();var bt=(()=>{class i{supabase=r($e);userId=b(null);loadingCount=b(0);loading=a(()=>this.loadingCount()>0);lists=Ke({params:()=>({userId:this.userId()}),loader:async({params:e})=>{if(!e.userId)return[];let{data:t,error:n}=await this.supabase.supabase.from("shopping_list").select("*").eq("creator_id",e.userId).order("created_at",{ascending:!0});if(n)throw n;return t??[]}});selectedListId=b(null);selectedList=a(()=>{let e=this.selectedListId();return(this.lists.value()??[]).find(n=>n.id===e)??null});constructor(){this.supabase.supabase.auth.getSession().then(({data:e})=>{let t=e?.session?.user??null;t&&this.userId.set(t.id)}).catch(()=>{}),this.supabase.supabase.auth.onAuthStateChange((e,t)=>{let n=t?.user?.id??null;this.userId.set(n),n||this.selectedListId.set(null)}),H(()=>{let e=this.lists.value();!this.selectedListId()&&e&&e.length>0&&this.selectedListId.set(e[0].id)})}createList(e){this.loadingCount.update(t=>t+1),ce(this.supabase.supabase.auth.getUser()).pipe(de(t=>G({error:t})),U(()=>this.loadingCount.update(t=>t-1))).subscribe(t=>{if(t?.error)throw t.error;let n=t?.data?.user?.id;if(!n)throw new Error("Not authenticated");this.loadingCount.update(o=>o+1),ce(this.supabase.supabase.from("shopping_list").insert({name:e,creator_id:n}).select().single()).pipe(de(o=>G({error:o})),U(()=>this.loadingCount.update(o=>o-1))).subscribe(o=>{if(o?.error)throw o.error;this.lists.reload(),o?.data&&this.selectedListId.set(o.data.id)})})}updateList(e,t){this.loadingCount.update(n=>n+1),ce(this.supabase.supabase.from("shopping_list").update({name:t}).eq("id",e).select().single()).pipe(de(n=>G({error:n})),U(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error)throw n.error;this.lists.reload()})}deleteList(e){this.loadingCount.update(t=>t+1),ce(this.supabase.supabase.from("shopping_list").delete().eq("id",e)).pipe(de(t=>G({error:t})),U(()=>this.loadingCount.update(t=>t-1))).subscribe(t=>{if(t?.error)throw t.error;this.selectedListId()===e&&this.selectedListId.set(null),this.lists.reload()})}static \u0275fac=function(t){return new(t||i)};static \u0275prov=ue({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var us=["editDialog"],ms=(i,m)=>m.id;function ps(i,m){i&1&&S(0,"hlm-spinner",3)}function gs(i,m){if(i&1){let e=R();l(0,"div",6)(1,"button",12),g("click",function(){let n=v(e).$implicit,o=f();return C(o.onTabChange(n.id))}),y(2),l(3,"button",13),M(4,"transloco"),g("click",function(n){let o=v(e).$implicit,p=f();return C(p.openEditDialog(n,o))}),S(5,"ng-icon",14),d(),l(6,"button",13),M(7,"transloco"),g("click",function(n){let o=v(e).$implicit,p=f();return C(p.deleteList(n,o.id))}),S(8,"ng-icon",15),d()()()}if(i&2){let e=m.$implicit;c(),T("hlmTabsTrigger",e.id),c(),A(" ",e.name," "),c(),k("aria-label",D(4,4,"common.edit")),c(3),k("aria-label",D(7,6,"common.delete"))}}function hs(i,m){i&1&&(S(0,"hlm-spinner",3),y(1),M(2,"transloco")),i&2&&(c(),A(" ",D(2,1,"common.creating")," "))}function fs(i,m){i&1&&(y(0),M(1,"transloco")),i&2&&A(" ",D(1,1,"common.create")," ")}function _s(i,m){if(i&1){let e=R();l(0,"hlm-dialog-content",16)(1,"hlm-dialog-header")(2,"h3",17),y(3),M(4,"transloco"),d(),l(5,"p",18),y(6),M(7,"transloco"),d()(),l(8,"div",19)(9,"div",20)(10,"label",21),y(11),M(12,"transloco"),d(),l(13,"input",22),M(14,"transloco"),oe("ngModelChange",function(n){v(e);let o=f();return ne(o.newListName,n)||(o.newListName=n),C(n)}),g("keydown.enter",function(){v(e);let n=f();return C(n.createList())}),d()()(),l(15,"hlm-dialog-footer")(16,"button",23),g("click",function(){v(e);let n=f();return C(n.closeDialog())}),y(17),M(18,"transloco"),d(),l(19,"button",24),g("click",function(){v(e);let n=f();return C(n.createList())}),O(20,hs,3,3)(21,fs,2,3),d()()()}if(i&2){let e=f();c(3),E(D(4,8,"shoppingList.createList")),c(3),E(D(7,10,"shoppingList.createListDescription")),c(5),E(D(12,12,"shoppingList.listName")),c(2),ie("ngModel",e.newListName),T("placeholder",D(14,14,"shoppingList.listNamePlaceholder")),c(4),A(" ",D(18,16,"common.cancel")," "),c(2),T("disabled",!e.newListName().trim()||e.creatingList()),c(),V(e.creatingList()?20:21)}}function bs(i,m){i&1&&(S(0,"hlm-spinner",3),y(1),M(2,"transloco")),i&2&&(c(),A(" ",D(2,1,"common.updating")," "))}function vs(i,m){i&1&&(y(0),M(1,"transloco")),i&2&&A(" ",D(1,1,"common.save")," ")}function Cs(i,m){if(i&1){let e=R();l(0,"hlm-dialog-content",16)(1,"hlm-dialog-header")(2,"h3",17),y(3),M(4,"transloco"),d(),l(5,"p",18),y(6),M(7,"transloco"),d()(),l(8,"div",19)(9,"div",20)(10,"label",25),y(11),M(12,"transloco"),d(),l(13,"input",26),M(14,"transloco"),oe("ngModelChange",function(n){v(e);let o=f();return ne(o.editListName,n)||(o.editListName=n),C(n)}),g("keydown.enter",function(){v(e);let n=f();return C(n.updateList())}),d()()(),l(15,"hlm-dialog-footer")(16,"button",23),g("click",function(){v(e);let n=f();return C(n.closeEditDialog())}),y(17),M(18,"transloco"),d(),l(19,"button",24),g("click",function(){v(e);let n=f();return C(n.updateList())}),O(20,bs,3,3)(21,vs,2,3),d()()()}if(i&2){let e=f();c(3),E(D(4,8,"shoppingList.editList")),c(3),E(D(7,10,"shoppingList.editListDescription")),c(5),E(D(12,12,"shoppingList.listName")),c(2),ie("ngModel",e.editListName),T("placeholder",D(14,14,"shoppingList.listNamePlaceholder")),c(4),A(" ",D(18,16,"common.cancel")," "),c(2),T("disabled",!e.editListName().trim()||e.updatingList()),c(),V(e.updatingList()?20:21)}}var Kn=(()=>{class i{listManager=r(bt);lists=a(()=>this.listManager.lists.value()??[]);selectedListId=this.listManager.selectedListId;loading=a(()=>this.listManager.lists.isLoading()||this.listManager.loading());createDialog=_e.required(Y);editDialog=_e.required("editDialog");newListName=b("");creatingList=b(!1);editingList=b(null);editListName=b("");updatingList=b(!1);onTabChange(e){this.listManager.selectedListId.set(e)}openCreateDialog(){this.newListName.set(""),this.createDialog().open()}closeDialog(){this.createDialog().close(),this.newListName.set("")}createList(){let e=this.newListName().trim();if(e){this.creatingList.set(!0);try{this.listManager.createList(e),this.closeDialog()}finally{this.creatingList.set(!1)}}}openEditDialog(e,t){e.stopPropagation(),this.editingList.set(t),this.editListName.set(t.name),this.editDialog().open()}closeEditDialog(){this.editDialog().close(),this.editingList.set(null),this.editListName.set("")}updateList(){let e=this.editingList(),t=this.editListName().trim();if(!(!e||!t)){this.updatingList.set(!0);try{this.listManager.updateList(e.id,t),this.closeEditDialog()}finally{this.updatingList.set(!1)}}}deleteList(e,t){e.stopPropagation(),confirm("Are you sure you want to delete this list?")&&this.listManager.deleteList(t)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=I({type:i,selectors:[["lib-shopping-list-tabs"]],viewQuery:function(t,n){t&1&&(he(n.createDialog,Y,5),he(n.editDialog,us,5)),t&2&&te(2)},features:[B([Q({lucidePlus:Xe,lucideX:dn,lucidePencil:sn,lucideTrash:Ze})])],decls:17,vars:5,consts:[["createDialog",""],["editDialog",""],[1,"flex","items-center","gap-2","min-w-0"],["size","small"],[1,"flex-1","min-w-0","overflow-hidden",3,"tab"],[1,"w-full","border-b","overflow-x-auto","overflow-y-hidden","scrollbar-hide"],[1,"flex","items-center","gap-1","flex-shrink-0","group"],["hlmBtn","","size","icon","variant","ghost",1,"flex-shrink-0",3,"click"],["hlm","","name","lucidePlus","size","sm"],["closeDelay","100",3,"closed"],["hlm",""],["class","sm:max-w-[425px]",4,"brnDialogContent"],[1,"whitespace-nowrap",3,"click","hlmTabsTrigger"],["hlmBtn","","size","icon-xs","variant","ghost",3,"click"],["hlm","","size","xs","name","lucidePencil"],["hlm","","size","xs","name","lucideTrash"],[1,"sm:max-w-[425px]"],["hlmDialogTitle",""],["hlmDialogDescription",""],[1,"grid","gap-4","py-4"],[1,"grid","gap-2"],["hlmLabel","","for","listName"],["hlmInput","","id","listName",3,"ngModelChange","keydown.enter","ngModel","placeholder"],["hlmBtn","","variant","outline",3,"click"],["hlmBtn","",3,"click","disabled"],["hlmLabel","","for","editListName"],["hlmInput","","id","editListName",3,"ngModelChange","keydown.enter","ngModel","placeholder"]],template:function(t,n){if(t&1){let o=R();l(0,"div",2),O(1,ps,1,0,"hlm-spinner",3),l(2,"hlm-tabs",4)(3,"hlm-tabs-list",5),Ie(4,gs,9,8,"div",6,ms),d()(),l(6,"button",7),M(7,"transloco"),g("click",function(){return v(o),C(n.openCreateDialog())}),S(8,"ng-icon",8),d()(),l(9,"brn-dialog",9,0),g("closed",function(){return v(o),C(n.closeDialog())}),S(11,"brn-dialog-overlay",10),ee(12,_s,22,18,"hlm-dialog-content",11),d(),l(13,"brn-dialog",9,1),g("closed",function(){return v(o),C(n.closeEditDialog())}),S(15,"brn-dialog-overlay",10),ee(16,Cs,22,18,"hlm-dialog-content",11),d()}t&2&&(c(),V(n.loading()?1:-1),c(),T("tab",n.selectedListId()??""),c(2),ke(n.lists()),c(2),k("aria-label",D(7,3,"shoppingList.createList")))},dependencies:[Te,be,Be,Ae,Pe,oi,si,ri,re,$,ae,Y,Je,Le,it,nt,ot,st,tt,rt,le,at,Fe,He,Se],encapsulation:2,changeDetection:0})}return i})();var ys=(i,m)=>m.id;function Ms(i,m){i&1&&(l(0,"div",11),S(1,"hlm-spinner",18),d())}function Ds(i,m){if(i&1&&S(0,"lib-shopping-list-item-card",17),i&2){let e=m.$implicit;T("item",e)}}var Qn=(()=>{class i{service=r(ut);listManager=r(bt);newItemName=b("");items=a(()=>this.service.items.value()??[]);loading=a(()=>this.service.items.isLoading()||this.service.loading());sortedItems=a(()=>(this.items()??[]).slice().sort((t,n)=>{if(t.active===n.active){let o=t.active_changed?new Date(t.active_changed).getTime():0;return(n.active_changed?new Date(n.active_changed).getTime():0)-o}return t.active?-1:1}));filteredOptions=a(()=>(this.items()??[]).filter(t=>!t.active&&t.product_name.toLowerCase().includes(this.newItemName().toLowerCase())));constructor(){H(()=>{let e=this.listManager.selectedListId();this.service.setCurrentList(e)})}handleSearch(e){let t=this.items().find(n=>n.product_name===e);!t||t.active||(this.service.toggleItem(t.id,!0).subscribe(),this.clearAutocomplete())}clearAutocomplete(){this.newItemName.set("")}focusAddInput(){try{document.getElementById("add-input")?.focus()}catch{}}addItem(){let e=this.newItemName();e&&this.service.addItem(e,void 0).subscribe({next:()=>{this.clearAutocomplete()},error:t=>{console.error("Add item error:",t)}})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=I({type:i,selectors:[["lib-sl-dashboard"]],features:[B([Q({lucideShoppingCart:ln,lucidePlus:Xe}),zn({transformOptionToString:e=>e.product_name,transformOptionToValue:e=>e.product_name})])],decls:25,vars:10,consts:[[1,"h-dvh","flex","flex-col","gap-4"],["hlmCard","",1,"w-full","rounded-none","flex-initial"],[1,"mx-auto","px-4","py-3","flex","items-center","justify-between"],[1,"flex","items-center","gap-3"],[1,"p-2","bg-primary/10","rounded-lg"],["hlm","","name","lucideShoppingCart","size","sm",1,"text-primary"],[1,"text-lg","font-semibold"],[1,"flex","items-center","gap-2"],[1,"px-4"],[1,"flex-1","flex","flex-col","gap-4","overflow-hidden","py-4"],[1,"flex","sm:flex-row","gap-2","items-stretch","sm:items-center","relative","px-4",3,"ngSubmit"],[1,"absolute","inset-0","bg-background/50","flex","justify-center","items-center","z-10","rounded-lg"],[3,"searchChange","valueChange","keydown.enter","searchPlaceholderText","filteredOptions","search","autocompleteEmptyClass"],["hlmBtn","","size","icon","variant","default","type","submit"],["hlm","","name","lucidePlus","size","sm"],[1,"flex-1","overflow-auto"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-3","xl:grid-cols-4","gap-4","px-4"],[3,"item"],["size","large"]],template:function(t,n){t&1&&(l(0,"div",0)(1,"header",1)(2,"div",2)(3,"div",3)(4,"div",4),S(5,"ng-icon",5),d(),l(6,"h1",6),y(7),M(8,"transloco"),d()(),l(9,"div",7),S(10,"gh-language-switcher")(11,"gh-user-avatar"),d()()(),l(12,"div",8),S(13,"lib-shopping-list-tabs"),d(),l(14,"main",9)(15,"form",10),g("ngSubmit",function(){return n.addItem()}),O(16,Ms,2,0,"div",11),l(17,"hlm-autocomplete",12),M(18,"transloco"),oe("searchChange",function(p){return ne(n.newItemName,p)||(n.newItemName=p),p}),g("valueChange",function(p){return n.handleSearch(p)})("keydown.enter",function(){return n.addItem()}),d(),l(19,"button",13),S(20,"ng-icon",14),d()(),l(21,"section",15)(22,"div",16),Ie(23,Ds,1,1,"lib-shopping-list-item-card",17,ys),d()()()()),t&2&&(c(7),E(D(8,6,"shoppingList.title")),c(9),V(n.loading()?16:-1),c(),T("searchPlaceholderText",D(18,8,"shoppingList.searchPlaceholder"))("filteredOptions",n.filteredOptions()),ie("search",n.newItemName),T("autocompleteEmptyClass","hidden"),c(6),ke(n.sortedItems()))},dependencies:[Te,be,Ji,Xi,Zi,re,$,ae,Fe,ht,Un,Kn,He,Oi,Bn,Se],encapsulation:2,changeDetection:0})}return i})();var ng=[{path:"dashboard",component:Qn},{path:"**",redirectTo:"dashboard"}];export{Cn as ShoppingBasketToggleComponent,ut as ShoppingListService,Bn as UserAvatarComponent,ng as shoppingListRoutes};
