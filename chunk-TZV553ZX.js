import{a as sE,b as sl,c as Wo,d as Uo,e as jo,f as qo,g as $o,h as Ko,i as Yo,m as lE}from"./chunk-7CJZKSND.js";import{a as cE,b as dE,c as uE,d as hE,e as pE,f as fE,g as gE}from"./chunk-YD6VBJWR.js";import{$a as ge,$b as yx,$c as zv,$d as Kn,A as Hn,Aa as Zc,Ac as Nx,B as Kc,Ba as up,Bb as fp,Bc as Bx,C as tn,Ca as Ov,D as cx,Da as ed,E as Z,Ea as Lv,Ec as rl,F as ie,Fa as Wn,Fc as Go,G as ne,Ga as Xt,Gc as Hx,H as dx,Hc as zx,I as Mv,Ia as Un,Ib as wx,Ic as Vx,Id as iE,J as Bo,Ja as se,Jb as Cn,Jd as nE,K as ux,Ka as Ze,Kb as wn,Kc as Gx,Kd as wi,L as ve,La as Ke,Lc as Wx,M as lp,Ma as td,Mb as bx,N as Ns,Na as Ho,O as Ai,Oa as Xr,P as hx,Pa as zo,Pb as _t,Pc as Ux,Qb as gp,R as M,Rb as lr,Rc as jx,Sb as Vo,Sc as dr,T as Iv,Ta as Jr,Tc as qx,Td as bn,U as Av,Ua as Xe,Ub as cr,V as Yc,Va as hp,Vb as Ja,Vc as Hs,Vd as yn,W as Ka,Wa as id,Wb as Qa,Wc as $x,X as Ie,Xa as Nv,Xc as vp,Xd as ur,Y as Xc,Ya as gx,Yb as qn,Yc as sd,Yd as rE,Z as Yt,Za as mx,Zb as mp,Zc as Kx,_ as zn,_a as fe,_b as Za,_c as Yx,_d as oE,a as $a,aa as ar,ac as el,ad as $n,b as jc,ba as W,bc as tl,bd as ad,c as bt,ca as Wi,cb as Bs,cc as Sx,cd as Xx,ce as ol,d as ox,da as px,db as Fe,dc as il,dd as Jx,e as rp,eb as pt,ec as nl,ed as Qx,f as sx,fa as Ya,fc as vi,g as $e,ga as ze,gb as jn,gc as Ci,gd as Zx,h as Ye,ha as Ve,hb as ue,hc as xx,i as Kr,ia as cp,ib as Re,ic as Ex,j as ax,ja as fx,jb as Bv,jc as Px,je as Cp,k as Ii,ka as Vn,kc as Rx,ke as wp,l as op,la as Gn,lb as Hv,le as aE,m as Yr,ma as de,mb as nd,mc as _x,md as eE,me as ld,na as D,nc as kx,nd as tE,o as rt,oa as F,ob as rd,p as sp,pa as ee,pb as O,pc as Fx,q as Dv,qa as Xa,qb as od,r as Qe,ra as Jc,rb as pp,rc as Tx,sa as dp,sc as Dx,t as qc,tc as Mx,u as en,ua as je,ub as vn,v as gn,vb as vx,w as $c,wa as te,wc as Ix,x as mn,xc as Ax,y as lx,ya as X,yc as Ox,z as ap,za as Qc,zb as Cx,zc as Lx}from"./chunk-3JJMCTRH.js";import{a as w,b as k,d as Vt,e as ce,g as nt}from"./chunk-X37JSKTG.js";var cd=ce((Fge,mE)=>{"use strict";mE.exports=function(e){if(typeof e!="number"||Number.isNaN(e))throw new TypeError(`Expected a number, got ${typeof e}`);let i=e<0,n=Math.abs(e);if(i&&(n=-n),n===0)return"0 B";let r=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],o=Math.min(Math.floor(Math.log(n)/Math.log(1024)),r.length-1),s=Number(n/1024**o),a=r[o];return`${s>=10||s%1===0?Math.round(s):s.toFixed(1)} ${a}`}});var ZE=ce((u0e,QE)=>{"use strict";function JE(t,e){this.text=t=t||"",this.hasWild=~t.indexOf("*"),this.separator=e,this.parts=t.split(e)}JE.prototype.match=function(t){var e=!0,i=this.parts,n,r=i.length,o;if(typeof t=="string"||t instanceof String)if(!this.hasWild&&this.text!=t)e=!1;else{for(o=(t||"").split(this.separator),n=0;e&&n<r;n++)i[n]!=="*"&&(n<o.length?e=i[n]===o[n]:e=!1);e=e&&o}else if(typeof t.splice=="function")for(e=[],n=t.length;n--;)this.match(t[n])&&(e[e.length]=t[n]);else if(typeof t=="object"){e={};for(var s in t)this.match(s)&&(e[s]=t[s])}return e};QE.exports=function(t,e,i){var n=new JE(t,i||/[\/\.]/);return typeof e<"u"?n.match(e):n}});var tP=ce((h0e,eP)=>{"use strict";var kL=ZE(),FL=/[\/\+\.]/;eP.exports=function(t,e){function i(n){var r=kL(n,t,FL);return r&&r.length>=2}return e?i(e.split(";")[0]):i}});var Mp=ce((S0e,sP)=>{"use strict";function ML(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}sP.exports=ML});var lP=ce((x0e,aP)=>{"use strict";var IL=typeof global=="object"&&global&&global.Object===Object&&global;aP.exports=IL});var fC=ce((E0e,cP)=>{"use strict";var AL=lP(),OL=typeof self=="object"&&self&&self.Object===Object&&self,LL=AL||OL||Function("return this")();cP.exports=LL});var uP=ce((P0e,dP)=>{"use strict";var NL=fC(),BL=function(){return NL.Date.now()};dP.exports=BL});var pP=ce((R0e,hP)=>{"use strict";var HL=/\s/;function zL(t){for(var e=t.length;e--&&HL.test(t.charAt(e)););return e}hP.exports=zL});var gP=ce((_0e,fP)=>{"use strict";var VL=pP(),GL=/^\s+/;function WL(t){return t&&t.slice(0,VL(t)+1).replace(GL,"")}fP.exports=WL});var gC=ce((k0e,mP)=>{"use strict";var UL=fC(),jL=UL.Symbol;mP.exports=jL});var bP=ce((F0e,wP)=>{"use strict";var vP=gC(),CP=Object.prototype,qL=CP.hasOwnProperty,$L=CP.toString,_d=vP?vP.toStringTag:void 0;function KL(t){var e=qL.call(t,_d),i=t[_d];try{t[_d]=void 0;var n=!0}catch{}var r=$L.call(t);return n&&(e?t[_d]=i:delete t[_d]),r}wP.exports=KL});var SP=ce((T0e,yP)=>{"use strict";var YL=Object.prototype,XL=YL.toString;function JL(t){return XL.call(t)}yP.exports=JL});var RP=ce((D0e,PP)=>{"use strict";var xP=gC(),QL=bP(),ZL=SP(),e9="[object Null]",t9="[object Undefined]",EP=xP?xP.toStringTag:void 0;function i9(t){return t==null?t===void 0?t9:e9:EP&&EP in Object(t)?QL(t):ZL(t)}PP.exports=i9});var kP=ce((M0e,_P)=>{"use strict";function n9(t){return t!=null&&typeof t=="object"}_P.exports=n9});var TP=ce((I0e,FP)=>{"use strict";var r9=RP(),o9=kP(),s9="[object Symbol]";function a9(t){return typeof t=="symbol"||o9(t)&&r9(t)==s9}FP.exports=a9});var AP=ce((A0e,IP)=>{"use strict";var l9=gP(),DP=Mp(),c9=TP(),MP=NaN,d9=/^[-+]0x[0-9a-f]+$/i,u9=/^0b[01]+$/i,h9=/^0o[0-7]+$/i,p9=parseInt;function f9(t){if(typeof t=="number")return t;if(c9(t))return MP;if(DP(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=DP(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=l9(t);var i=u9.test(t);return i||h9.test(t)?p9(t.slice(2),i?2:8):d9.test(t)?MP:+t}IP.exports=f9});var vC=ce((O0e,LP)=>{"use strict";var g9=Mp(),mC=uP(),OP=AP(),m9="Expected a function",v9=Math.max,C9=Math.min;function w9(t,e,i){var n,r,o,s,a,l,c=0,d=!1,u=!1,h=!0;if(typeof t!="function")throw new TypeError(m9);e=OP(e)||0,g9(i)&&(d=!!i.leading,u="maxWait"in i,o=u?v9(OP(i.maxWait)||0,e):o,h="trailing"in i?!!i.trailing:h);function p(E){var P=n,L=r;return n=r=void 0,c=E,s=t.apply(L,P),s}function f(E){return c=E,a=setTimeout(v,e),d?p(E):s}function g(E){var P=E-l,L=E-c,B=e-P;return u?C9(B,o-L):B}function m(E){var P=E-l,L=E-c;return l===void 0||P>=e||P<0||u&&L>=o}function v(){var E=mC();if(m(E))return C(E);a=setTimeout(v,g(E))}function C(E){return a=void 0,h&&n?p(E):(n=r=void 0,s)}function b(){a!==void 0&&clearTimeout(a),c=0,n=l=r=a=void 0}function S(){return a===void 0?s:C(mC())}function x(){var E=mC(),P=m(E);if(n=arguments,r=this,l=E,P){if(a===void 0)return f(l);if(u)return clearTimeout(a),a=setTimeout(v,e),p(l)}return a===void 0&&(a=setTimeout(v,e)),s}return x.cancel=b,x.flush=S,x}LP.exports=w9});var BP=ce((L0e,NP)=>{"use strict";var b9=vC(),y9=Mp(),S9="Expected a function";function x9(t,e,i){var n=!0,r=!0;if(typeof t!="function")throw new TypeError(S9);return y9(i)&&(n="leading"in i?!!i.leading:n,r="trailing"in i?!!i.trailing:r),b9(t,e,{leading:n,maxWait:e,trailing:r})}NP.exports=x9});var zP=ce((N0e,HP)=>{"use strict";HP.exports=function(){var e={},i=e._fns={};e.emit=function(s,a,l,c,d,u,h){var p=n(s);p.length&&r(s,p,[a,l,c,d,u,h])},e.on=function(s,a){i[s]||(i[s]=[]),i[s].push(a)},e.once=function(s,a){function l(){a.apply(this,arguments),e.off(s,l)}this.on(s,l)},e.off=function(s,a){var l=[];if(s&&a){var c=this._fns[s],d=0,u=c?c.length:0;for(d;d<u;d++)c[d]!==a&&l.push(c[d])}l.length?this._fns[s]=l:delete this._fns[s]};function n(o){var s=i[o]?i[o]:[],a=o.indexOf(":"),l=a===-1?[o]:[o.substring(0,a),o.substring(a+1)],c=Object.keys(i),d=0,u=c.length;for(d;d<u;d++){var h=c[d];if(h==="*"&&(s=s.concat(i[h])),l.length===2&&l[0]===h){s=s.concat(i[h]);break}}return s}function r(o,s,a){var l=0,c=s.length;for(l;l<c&&s[l];l++)s[l].event=o,s[l].apply(s[l],a)}return e}});var jP=ce((yC,SC)=>{"use strict";(function(t,e){typeof yC=="object"&&typeof SC<"u"?SC.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis<"u"?globalThis:t||self,t.Compressor=e())})(yC,function(){"use strict";function t(N,I){var V=Object.keys(N);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(N);I&&($=$.filter(function(me){return Object.getOwnPropertyDescriptor(N,me).enumerable})),V.push.apply(V,$)}return V}function e(N){for(var I=1;I<arguments.length;I++){var V=arguments[I]!=null?arguments[I]:{};I%2?t(Object(V),!0).forEach(function($){o(N,$,V[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(N,Object.getOwnPropertyDescriptors(V)):t(Object(V)).forEach(function($){Object.defineProperty(N,$,Object.getOwnPropertyDescriptor(V,$))})}return N}function i(N,I){if(!(N instanceof I))throw new TypeError("Cannot call a class as a function")}function n(N,I){for(var V=0;V<I.length;V++){var $=I[V];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(N,l($.key),$)}}function r(N,I,V){return I&&n(N.prototype,I),V&&n(N,V),Object.defineProperty(N,"prototype",{writable:!1}),N}function o(N,I,V){return I=l(I),I in N?Object.defineProperty(N,I,{value:V,enumerable:!0,configurable:!0,writable:!0}):N[I]=V,N}function s(){return s=Object.assign?Object.assign.bind():function(N){for(var I=1;I<arguments.length;I++){var V=arguments[I];for(var $ in V)Object.prototype.hasOwnProperty.call(V,$)&&(N[$]=V[$])}return N},s.apply(this,arguments)}function a(N,I){if(typeof N!="object"||N===null)return N;var V=N[Symbol.toPrimitive];if(V!==void 0){var $=V.call(N,I||"default");if(typeof $!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(I==="string"?String:Number)(N)}function l(N){var I=a(N,"string");return typeof I=="symbol"?I:String(I)}var c={exports:{}};(function(N){typeof window>"u"||(function(I){var V=I.HTMLCanvasElement&&I.HTMLCanvasElement.prototype,$=I.Blob&&(function(){try{return!!new Blob}catch{return!1}})(),me=$&&I.Uint8Array&&(function(){try{return new Blob([new Uint8Array(100)]).size===100}catch{return!1}})(),Ce=I.BlobBuilder||I.WebKitBlobBuilder||I.MozBlobBuilder||I.MSBlobBuilder,ht=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,it=($||Ce)&&I.atob&&I.ArrayBuffer&&I.Uint8Array&&function(Be){var He,Rt,Mt,Qi,Kt,Me,Zi,si,Ua;if(He=Be.match(ht),!He)throw new Error("invalid data URI");for(Rt=He[2]?He[1]:"text/plain"+(He[3]||";charset=US-ASCII"),Mt=!!He[4],Qi=Be.slice(He[0].length),Mt?Kt=atob(Qi):Kt=decodeURIComponent(Qi),Me=new ArrayBuffer(Kt.length),Zi=new Uint8Array(Me),si=0;si<Kt.length;si+=1)Zi[si]=Kt.charCodeAt(si);return $?new Blob([me?Zi:Me],{type:Rt}):(Ua=new Ce,Ua.append(Me),Ua.getBlob(Rt))};I.HTMLCanvasElement&&!V.toBlob&&(V.mozGetAsFile?V.toBlob=function(Be,He,Rt){var Mt=this;setTimeout(function(){Rt&&V.toDataURL&&it?Be(it(Mt.toDataURL(He,Rt))):Be(Mt.mozGetAsFile("blob",He))})}:V.toDataURL&&it&&(V.msToBlob?V.toBlob=function(Be,He,Rt){var Mt=this;setTimeout(function(){(He&&He!=="image/png"||Rt)&&V.toDataURL&&it?Be(it(Mt.toDataURL(He,Rt))):Be(Mt.msToBlob(He))})}:V.toBlob=function(Be,He,Rt){var Mt=this;setTimeout(function(){Be(it(Mt.toDataURL(He,Rt)))})})),N.exports?N.exports=it:I.dataURLtoBlob=it})(window)})(c);var d=c.exports,u=function(I){return typeof Blob>"u"?!1:I instanceof Blob||Object.prototype.toString.call(I)==="[object Blob]"},h={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},p=typeof window<"u"&&typeof window.document<"u",f=p?window:{},g=function(I){return I>0&&I<1/0},m=Array.prototype.slice;function v(N){return Array.from?Array.from(N):m.call(N)}var C=/^image\/.+$/;function b(N){return C.test(N)}function S(N){var I=b(N)?N.substr(6):"";return I==="jpeg"&&(I="jpg"),".".concat(I)}var x=String.fromCharCode;function E(N,I,V){var $="",me;for(V+=I,me=I;me<V;me+=1)$+=x(N.getUint8(me));return $}var P=f.btoa;function L(N,I){for(var V=[],$=8192,me=new Uint8Array(N);me.length>0;)V.push(x.apply(null,v(me.subarray(0,$)))),me=me.subarray($);return"data:".concat(I,";base64,").concat(P(V.join("")))}function B(N){var I=new DataView(N),V;try{var $,me,Ce;if(I.getUint8(0)===255&&I.getUint8(1)===216)for(var ht=I.byteLength,it=2;it+1<ht;){if(I.getUint8(it)===255&&I.getUint8(it+1)===225){me=it;break}it+=1}if(me){var Be=me+4,He=me+10;if(E(I,Be,4)==="Exif"){var Rt=I.getUint16(He);if($=Rt===18761,($||Rt===19789)&&I.getUint16(He+2,$)===42){var Mt=I.getUint32(He+4,$);Mt>=8&&(Ce=He+Mt)}}}if(Ce){var Qi=I.getUint16(Ce,$),Kt,Me;for(Me=0;Me<Qi;Me+=1)if(Kt=Ce+Me*12+2,I.getUint16(Kt,$)===274){Kt+=8,V=I.getUint16(Kt,$),I.setUint16(Kt,1,$);break}}}catch{V=1}return V}function j(N){var I=0,V=1,$=1;switch(N){case 2:V=-1;break;case 3:I=-180;break;case 4:$=-1;break;case 5:I=90,$=-1;break;case 6:I=90;break;case 7:I=90,V=-1;break;case 8:I=-90;break}return{rotate:I,scaleX:V,scaleY:$}}var q=/\.\d*(?:0|9){12}\d*$/;function Y(N){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return q.test(N)?Math.round(N*I)/I:N}function he(N){var I=N.aspectRatio,V=N.height,$=N.width,me=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none",Ce=g($),ht=g(V);if(Ce&&ht){var it=V*I;(me==="contain"||me==="none")&&it>$||me==="cover"&&it<$?V=$/I:$=V*I}else Ce?V=$/I:ht&&($=V*I);return{width:$,height:V}}function Se(N){for(var I=v(new Uint8Array(N)),V=I.length,$=[],me=0;me+3<V;){var Ce=I[me],ht=I[me+1];if(Ce===255&&ht===218)break;if(Ce===255&&ht===216)me+=2;else{var it=I[me+2]*256+I[me+3],Be=me+it+2,He=I.slice(me,Be);$.push(He),me=Be}}return $.reduce(function(Rt,Mt){return Mt[0]===255&&Mt[1]===225?Rt.concat(Mt):Rt},[])}function be(N,I){var V=v(new Uint8Array(N));if(V[2]!==255||V[3]!==224)return N;var $=V[4]*256+V[5],me=[255,216].concat(I,V.slice(4+$));return new Uint8Array(me)}var T=f.ArrayBuffer,R=f.FileReader,_=f.URL||f.webkitURL,z=/\.\w+$/,G=f.Compressor,U=(function(){function N(I,V){i(this,N),this.file=I,this.exif=[],this.image=new Image,this.options=e(e({},h),V),this.aborted=!1,this.result=null,this.init()}return r(N,[{key:"init",value:function(){var V=this,$=this.file,me=this.options;if(!u($)){this.fail(new Error("The first argument must be a File or Blob object."));return}var Ce=$.type;if(!b(Ce)){this.fail(new Error("The first argument must be an image File or Blob object."));return}if(!_||!R){this.fail(new Error("The current browser does not support image compression."));return}T||(me.checkOrientation=!1,me.retainExif=!1);var ht=Ce==="image/jpeg",it=ht&&me.checkOrientation,Be=ht&&me.retainExif;if(_&&!it&&!Be)this.load({url:_.createObjectURL($)});else{var He=new R;this.reader=He,He.onload=function(Rt){var Mt=Rt.target,Qi=Mt.result,Kt={},Me=1;it&&(Me=B(Qi),Me>1&&s(Kt,j(Me))),Be&&(V.exif=Se(Qi)),it||Be?!_||Me>1?Kt.url=L(Qi,Ce):Kt.url=_.createObjectURL($):Kt.url=Qi,V.load(Kt)},He.onabort=function(){V.fail(new Error("Aborted to read the image with FileReader."))},He.onerror=function(){V.fail(new Error("Failed to read the image with FileReader."))},He.onloadend=function(){V.reader=null},it||Be?He.readAsArrayBuffer($):He.readAsDataURL($)}}},{key:"load",value:function(V){var $=this,me=this.file,Ce=this.image;Ce.onload=function(){$.draw(e(e({},V),{},{naturalWidth:Ce.naturalWidth,naturalHeight:Ce.naturalHeight}))},Ce.onabort=function(){$.fail(new Error("Aborted to load the image."))},Ce.onerror=function(){$.fail(new Error("Failed to load the image."))},f.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(f.navigator.userAgent)&&(Ce.crossOrigin="anonymous"),Ce.alt=me.name,Ce.src=V.url}},{key:"draw",value:function(V){var $=this,me=V.naturalWidth,Ce=V.naturalHeight,ht=V.rotate,it=ht===void 0?0:ht,Be=V.scaleX,He=Be===void 0?1:Be,Rt=V.scaleY,Mt=Rt===void 0?1:Rt,Qi=this.file,Kt=this.image,Me=this.options,Zi=document.createElement("canvas"),si=Zi.getContext("2d"),Ua=Math.abs(it)%180===90,Rv=(Me.resize==="contain"||Me.resize==="cover")&&g(Me.width)&&g(Me.height),Hc=Math.max(Me.maxWidth,0)||1/0,zc=Math.max(Me.maxHeight,0)||1/0,Vc=Math.max(Me.minWidth,0)||0,Gc=Math.max(Me.minHeight,0)||0,ja=me/Ce,gi=Me.width,mi=Me.height;if(Ua){var V3=[zc,Hc];Hc=V3[0],zc=V3[1];var G3=[Gc,Vc];Vc=G3[0],Gc=G3[1];var W3=[mi,gi];gi=W3[0],mi=W3[1]}Rv&&(ja=gi/mi);var U3=he({aspectRatio:ja,width:Hc,height:zc},"contain");Hc=U3.width,zc=U3.height;var j3=he({aspectRatio:ja,width:Vc,height:Gc},"cover");if(Vc=j3.width,Gc=j3.height,Rv){var q3=he({aspectRatio:ja,width:gi,height:mi},Me.resize);gi=q3.width,mi=q3.height}else{var $3=he({aspectRatio:ja,width:gi,height:mi}),K3=$3.width;gi=K3===void 0?me:K3;var Y3=$3.height;mi=Y3===void 0?Ce:Y3}gi=Math.floor(Y(Math.min(Math.max(gi,Vc),Hc))),mi=Math.floor(Y(Math.min(Math.max(mi,Gc),zc)));var ZO=-gi/2,eL=-mi/2,tL=gi,iL=mi,_v=[];if(Rv){var X3=0,J3=0,kv=me,Fv=Ce,Q3=he({aspectRatio:ja,width:me,height:Ce},{contain:"cover",cover:"contain"}[Me.resize]);kv=Q3.width,Fv=Q3.height,X3=(me-kv)/2,J3=(Ce-Fv)/2,_v.push(X3,J3,kv,Fv)}if(_v.push(ZO,eL,tL,iL),Ua){var Z3=[mi,gi];gi=Z3[0],mi=Z3[1]}Zi.width=gi,Zi.height=mi,b(Me.mimeType)||(Me.mimeType=Qi.type);var ex="transparent";Qi.size>Me.convertSize&&Me.convertTypes.indexOf(Me.mimeType)>=0&&(Me.mimeType="image/jpeg");var tx=Me.mimeType==="image/jpeg";if(tx&&(ex="#fff"),si.fillStyle=ex,si.fillRect(0,0,gi,mi),Me.beforeDraw&&Me.beforeDraw.call(this,si,Zi),!this.aborted&&(si.save(),si.translate(gi/2,mi/2),si.rotate(it*Math.PI/180),si.scale(He,Mt),si.drawImage.apply(si,[Kt].concat(_v)),si.restore(),Me.drew&&Me.drew.call(this,si,Zi),!this.aborted)){var ix=function(Wc){if(!$.aborted){var nx=function(Uc){return $.done({naturalWidth:me,naturalHeight:Ce,result:Uc})};if(Wc&&tx&&Me.retainExif&&$.exif&&$.exif.length>0){var rx=function(Uc){return nx(d(L(be(Uc,$.exif),Me.mimeType)))};if(Wc.arrayBuffer)Wc.arrayBuffer().then(rx).catch(function(){$.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))});else{var qa=new R;$.reader=qa,qa.onload=function(Tv){var Uc=Tv.target;rx(Uc.result)},qa.onabort=function(){$.fail(new Error("Aborted to read the compressed image with FileReader."))},qa.onerror=function(){$.fail(new Error("Failed to read the compressed image with FileReader."))},qa.onloadend=function(){$.reader=null},qa.readAsArrayBuffer(Wc)}}else nx(Wc)}};Zi.toBlob?Zi.toBlob(ix,Me.mimeType,Me.quality):ix(d(Zi.toDataURL(Me.mimeType,Me.quality)))}}},{key:"done",value:function(V){var $=V.naturalWidth,me=V.naturalHeight,Ce=V.result,ht=this.file,it=this.image,Be=this.options;if(_&&it.src.indexOf("blob:")===0&&_.revokeObjectURL(it.src),Ce)if(Be.strict&&!Be.retainExif&&Ce.size>ht.size&&Be.mimeType===ht.type&&!(Be.width>$||Be.height>me||Be.minWidth>$||Be.minHeight>me||Be.maxWidth<$||Be.maxHeight<me))Ce=ht;else{var He=new Date;Ce.lastModified=He.getTime(),Ce.lastModifiedDate=He,Ce.name=ht.name,Ce.name&&Ce.type!==ht.type&&(Ce.name=Ce.name.replace(z,S(Ce.type)))}else Ce=ht;this.result=Ce,Be.success&&Be.success.call(this,Ce)}},{key:"fail",value:function(V){var $=this.options;if($.error)$.error.call(this,V);else throw V}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=G,N}},{key:"setDefaults",value:function(V){s(h,V)}}]),N})();return U})});var ji=ce((fve,Lp)=>{"use strict";(function(){"use strict";var t={}.hasOwnProperty;function e(){for(var r="",o=0;o<arguments.length;o++){var s=arguments[o];s&&(r=n(r,i(s)))}return r}function i(r){if(typeof r=="string"||typeof r=="number")return r;if(typeof r!="object")return"";if(Array.isArray(r))return e.apply(null,r);if(r.toString!==Object.prototype.toString&&!r.toString.toString().includes("[native code]"))return r.toString();var o="";for(var s in r)t.call(r,s)&&r[s]&&(o=n(o,s));return o}function n(r,o){return o?r?r+" "+o:r+o:r}typeof Lp<"u"&&Lp.exports?(e.default=e,Lp.exports=e):typeof define=="function"&&typeof define.amd=="object"&&define.amd?define("classnames",[],function(){return e}):window.classNames=e})()});var sR=ce((Qve,FC)=>{"use strict";var U9=Object.prototype.hasOwnProperty,Oi="~";function kd(){}Object.create&&(kd.prototype=Object.create(null),new kd().__proto__||(Oi=!1));function j9(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function oR(t,e,i,n,r){if(typeof i!="function")throw new TypeError("The listener must be a function");var o=new j9(i,n||t,r),s=Oi?Oi+e:e;return t._events[s]?t._events[s].fn?t._events[s]=[t._events[s],o]:t._events[s].push(o):(t._events[s]=o,t._eventsCount++),t}function Bp(t,e){--t._eventsCount===0?t._events=new kd:delete t._events[e]}function yi(){this._events=new kd,this._eventsCount=0}yi.prototype.eventNames=function(){var e=[],i,n;if(this._eventsCount===0)return e;for(n in i=this._events)U9.call(i,n)&&e.push(Oi?n.slice(1):n);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(i)):e};yi.prototype.listeners=function(e){var i=Oi?Oi+e:e,n=this._events[i];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,o=n.length,s=new Array(o);r<o;r++)s[r]=n[r].fn;return s};yi.prototype.listenerCount=function(e){var i=Oi?Oi+e:e,n=this._events[i];return n?n.fn?1:n.length:0};yi.prototype.emit=function(e,i,n,r,o,s){var a=Oi?Oi+e:e;if(!this._events[a])return!1;var l=this._events[a],c=arguments.length,d,u;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,i),!0;case 3:return l.fn.call(l.context,i,n),!0;case 4:return l.fn.call(l.context,i,n,r),!0;case 5:return l.fn.call(l.context,i,n,r,o),!0;case 6:return l.fn.call(l.context,i,n,r,o,s),!0}for(u=1,d=new Array(c-1);u<c;u++)d[u-1]=arguments[u];l.fn.apply(l.context,d)}else{var h=l.length,p;for(u=0;u<h;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),c){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,i);break;case 3:l[u].fn.call(l[u].context,i,n);break;case 4:l[u].fn.call(l[u].context,i,n,r);break;default:if(!d)for(p=1,d=new Array(c-1);p<c;p++)d[p-1]=arguments[p];l[u].fn.apply(l[u].context,d)}}return!0};yi.prototype.on=function(e,i,n){return oR(this,e,i,n,!1)};yi.prototype.once=function(e,i,n){return oR(this,e,i,n,!0)};yi.prototype.removeListener=function(e,i,n,r){var o=Oi?Oi+e:e;if(!this._events[o])return this;if(!i)return Bp(this,o),this;var s=this._events[o];if(s.fn)s.fn===i&&(!r||s.once)&&(!n||s.context===n)&&Bp(this,o);else{for(var a=0,l=[],c=s.length;a<c;a++)(s[a].fn!==i||r&&!s[a].once||n&&s[a].context!==n)&&l.push(s[a]);l.length?this._events[o]=l.length===1?l[0]:l:Bp(this,o)}return this};yi.prototype.removeAllListeners=function(e){var i;return e?(i=Oi?Oi+e:e,this._events[i]&&Bp(this,i)):(this._events=new kd,this._eventsCount=0),this};yi.prototype.off=yi.prototype.removeListener;yi.prototype.addListener=yi.prototype.on;yi.prefixed=Oi;yi.EventEmitter=yi;typeof FC<"u"&&(FC.exports=yi)});var j_=ce((Ybe,U_)=>{"use strict";U_.exports=function(e,i){if(i=i.split(":")[0],e=+e,!e)return!1;switch(i){case"http":case"ws":return e!==80;case"https":case"wss":return e!==443;case"ftp":return e!==21;case"gopher":return e!==70;case"file":return!1}return e!==0}});var K_=ce(Pw=>{"use strict";var DB=Object.prototype.hasOwnProperty,MB;function q_(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch{return null}}function $_(t){try{return encodeURIComponent(t)}catch{return null}}function IB(t){for(var e=/([^=?#&]+)=?([^&]*)/g,i={},n;n=e.exec(t);){var r=q_(n[1]),o=q_(n[2]);r===null||o===null||r in i||(i[r]=o)}return i}function AB(t,e){e=e||"";var i=[],n,r;typeof e!="string"&&(e="?");for(r in t)if(DB.call(t,r)){if(n=t[r],!n&&(n===null||n===MB||isNaN(n))&&(n=""),r=$_(r),n=$_(n),r===null||n===null)continue;i.push(r+"="+n)}return i.length?e+i.join("&"):""}Pw.stringify=AB;Pw.parse=IB});var ik=ce((Jbe,tk)=>{"use strict";var X_=j_(),af=K_(),OB=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,J_=/[\n\r\t]/g,LB=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,Q_=/:\d+$/,NB=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,BB=/^[a-zA-Z]:/;function _w(t){return(t||"").toString().replace(OB,"")}var Rw=[["#","hash"],["?","query"],function(e,i){return mr(i.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],Y_={hash:1,query:1};function Z_(t){var e;typeof window<"u"?e=window:typeof global<"u"?e=global:typeof self<"u"?e=self:e={};var i=e.location||{};t=t||i;var n={},r=typeof t,o;if(t.protocol==="blob:")n=new vr(unescape(t.pathname),{});else if(r==="string"){n=new vr(t,{});for(o in Y_)delete n[o]}else if(r==="object"){for(o in t)o in Y_||(n[o]=t[o]);n.slashes===void 0&&(n.slashes=LB.test(t.href))}return n}function mr(t){return t==="file:"||t==="ftp:"||t==="http:"||t==="https:"||t==="ws:"||t==="wss:"}function ek(t,e){t=_w(t),t=t.replace(J_,""),e=e||{};var i=NB.exec(t),n=i[1]?i[1].toLowerCase():"",r=!!i[2],o=!!i[3],s=0,a;return r?o?(a=i[2]+i[3]+i[4],s=i[2].length+i[3].length):(a=i[2]+i[4],s=i[2].length):o?(a=i[3]+i[4],s=i[3].length):a=i[4],n==="file:"?s>=2&&(a=a.slice(2)):mr(n)?a=i[4]:n?r&&(a=a.slice(2)):s>=2&&mr(e.protocol)&&(a=i[4]),{protocol:n,slashes:r||mr(n),slashesCount:s,rest:a}}function HB(t,e){if(t==="")return e;for(var i=(e||"/").split("/").slice(0,-1).concat(t.split("/")),n=i.length,r=i[n-1],o=!1,s=0;n--;)i[n]==="."?i.splice(n,1):i[n]===".."?(i.splice(n,1),s++):s&&(n===0&&(o=!0),i.splice(n,1),s--);return o&&i.unshift(""),(r==="."||r==="..")&&i.push(""),i.join("/")}function vr(t,e,i){if(t=_w(t),t=t.replace(J_,""),!(this instanceof vr))return new vr(t,e,i);var n,r,o,s,a,l,c=Rw.slice(),d=typeof e,u=this,h=0;for(d!=="object"&&d!=="string"&&(i=e,e=null),i&&typeof i!="function"&&(i=af.parse),e=Z_(e),r=ek(t||"",e),n=!r.protocol&&!r.slashes,u.slashes=r.slashes||n&&e.slashes,u.protocol=r.protocol||e.protocol||"",t=r.rest,(r.protocol==="file:"&&(r.slashesCount!==2||BB.test(t))||!r.slashes&&(r.protocol||r.slashesCount<2||!mr(u.protocol)))&&(c[3]=[/(.*)/,"pathname"]);h<c.length;h++){if(s=c[h],typeof s=="function"){t=s(t,u);continue}o=s[0],l=s[1],o!==o?u[l]=t:typeof o=="string"?(a=o==="@"?t.lastIndexOf(o):t.indexOf(o),~a&&(typeof s[2]=="number"?(u[l]=t.slice(0,a),t=t.slice(a+s[2])):(u[l]=t.slice(a),t=t.slice(0,a)))):(a=o.exec(t))&&(u[l]=a[1],t=t.slice(0,a.index)),u[l]=u[l]||n&&s[3]&&e[l]||"",s[4]&&(u[l]=u[l].toLowerCase())}i&&(u.query=i(u.query)),n&&e.slashes&&u.pathname.charAt(0)!=="/"&&(u.pathname!==""||e.pathname!=="")&&(u.pathname=HB(u.pathname,e.pathname)),u.pathname.charAt(0)!=="/"&&mr(u.protocol)&&(u.pathname="/"+u.pathname),X_(u.port,u.protocol)||(u.host=u.hostname,u.port=""),u.username=u.password="",u.auth&&(a=u.auth.indexOf(":"),~a?(u.username=u.auth.slice(0,a),u.username=encodeURIComponent(decodeURIComponent(u.username)),u.password=u.auth.slice(a+1),u.password=encodeURIComponent(decodeURIComponent(u.password))):u.username=encodeURIComponent(decodeURIComponent(u.auth)),u.auth=u.password?u.username+":"+u.password:u.username),u.origin=u.protocol!=="file:"&&mr(u.protocol)&&u.host?u.protocol+"//"+u.host:"null",u.href=u.toString()}function zB(t,e,i){var n=this;switch(t){case"query":typeof e=="string"&&e.length&&(e=(i||af.parse)(e)),n[t]=e;break;case"port":n[t]=e,X_(e,n.protocol)?e&&(n.host=n.hostname+":"+e):(n.host=n.hostname,n[t]="");break;case"hostname":n[t]=e,n.port&&(e+=":"+n.port),n.host=e;break;case"host":n[t]=e,Q_.test(e)?(e=e.split(":"),n.port=e.pop(),n.hostname=e.join(":")):(n.hostname=e,n.port="");break;case"protocol":n.protocol=e.toLowerCase(),n.slashes=!i;break;case"pathname":case"hash":if(e){var r=t==="pathname"?"/":"#";n[t]=e.charAt(0)!==r?r+e:e}else n[t]=e;break;case"username":case"password":n[t]=encodeURIComponent(e);break;case"auth":var o=e.indexOf(":");~o?(n.username=e.slice(0,o),n.username=encodeURIComponent(decodeURIComponent(n.username)),n.password=e.slice(o+1),n.password=encodeURIComponent(decodeURIComponent(n.password))):n.username=encodeURIComponent(decodeURIComponent(e))}for(var s=0;s<Rw.length;s++){var a=Rw[s];a[4]&&(n[a[1]]=n[a[1]].toLowerCase())}return n.auth=n.password?n.username+":"+n.password:n.username,n.origin=n.protocol!=="file:"&&mr(n.protocol)&&n.host?n.protocol+"//"+n.host:"null",n.href=n.toString(),n}function VB(t){(!t||typeof t!="function")&&(t=af.stringify);var e,i=this,n=i.host,r=i.protocol;r&&r.charAt(r.length-1)!==":"&&(r+=":");var o=r+(i.protocol&&i.slashes||mr(i.protocol)?"//":"");return i.username?(o+=i.username,i.password&&(o+=":"+i.password),o+="@"):i.password?(o+=":"+i.password,o+="@"):i.protocol!=="file:"&&mr(i.protocol)&&!n&&i.pathname!=="/"&&(o+="@"),(n[n.length-1]===":"||Q_.test(i.hostname)&&!i.port)&&(n+=":"),o+=n+i.pathname,e=typeof i.query=="object"?t(i.query):i.query,e&&(o+=e.charAt(0)!=="?"?"?"+e:e),i.hash&&(o+=i.hash),o}vr.prototype={set:zB,toString:VB};vr.extractProtocol=ek;vr.location=Z_;vr.trimLeft=_w;vr.qs=af;tk.exports=vr});var Le=ce(oi=>{"use strict";Object.defineProperty(oi,"__esModule",{value:!0});oi._registerNode=oi.Konva=oi.glob=void 0;var Dle=Math.PI/180;function Mle(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}oi.glob=typeof global<"u"?global:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{};oi.Konva={_global:oi.glob,version:"9.3.22",isBrowser:Mle(),isUnminified:/param/.test((function(t){}).toString()),dblClickWindow:400,getAngle(t){return oi.Konva.angleDeg?t*Dle:t},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return oi.Konva.DD.isDragging},isTransforming(){var t;return(t=oi.Konva.Transformer)===null||t===void 0?void 0:t.isTransforming()},isDragReady(){return!!oi.Konva.DD.node},releaseCanvasOnDestroy:!0,document:oi.glob.document,_injectGlobal(t){oi.glob.Konva=t}};var Ile=t=>{oi.Konva[t.prototype.getClassName()]=t};oi._registerNode=Ile;oi.Konva._injectGlobal(oi.Konva)});var Pt=ce(mt=>{"use strict";Object.defineProperty(mt,"__esModule",{value:!0});mt.Util=mt.Transform=void 0;var v2=Le(),b2=class t{constructor(e=[1,0,0,1,0,0]){this.dirty=!1,this.m=e&&e.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new t(this.m)}copyInto(e){e.m[0]=this.m[0],e.m[1]=this.m[1],e.m[2]=this.m[2],e.m[3]=this.m[3],e.m[4]=this.m[4],e.m[5]=this.m[5]}point(e){let i=this.m;return{x:i[0]*e.x+i[2]*e.y+i[4],y:i[1]*e.x+i[3]*e.y+i[5]}}translate(e,i){return this.m[4]+=this.m[0]*e+this.m[2]*i,this.m[5]+=this.m[1]*e+this.m[3]*i,this}scale(e,i){return this.m[0]*=e,this.m[1]*=e,this.m[2]*=i,this.m[3]*=i,this}rotate(e){let i=Math.cos(e),n=Math.sin(e),r=this.m[0]*i+this.m[2]*n,o=this.m[1]*i+this.m[3]*n,s=this.m[0]*-n+this.m[2]*i,a=this.m[1]*-n+this.m[3]*i;return this.m[0]=r,this.m[1]=o,this.m[2]=s,this.m[3]=a,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(e,i){let n=this.m[0]+this.m[2]*i,r=this.m[1]+this.m[3]*i,o=this.m[2]+this.m[0]*e,s=this.m[3]+this.m[1]*e;return this.m[0]=n,this.m[1]=r,this.m[2]=o,this.m[3]=s,this}multiply(e){let i=this.m[0]*e.m[0]+this.m[2]*e.m[1],n=this.m[1]*e.m[0]+this.m[3]*e.m[1],r=this.m[0]*e.m[2]+this.m[2]*e.m[3],o=this.m[1]*e.m[2]+this.m[3]*e.m[3],s=this.m[0]*e.m[4]+this.m[2]*e.m[5]+this.m[4],a=this.m[1]*e.m[4]+this.m[3]*e.m[5]+this.m[5];return this.m[0]=i,this.m[1]=n,this.m[2]=r,this.m[3]=o,this.m[4]=s,this.m[5]=a,this}invert(){let e=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),i=this.m[3]*e,n=-this.m[1]*e,r=-this.m[2]*e,o=this.m[0]*e,s=e*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),a=e*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=i,this.m[1]=n,this.m[2]=r,this.m[3]=o,this.m[4]=s,this.m[5]=a,this}getMatrix(){return this.m}decompose(){let e=this.m[0],i=this.m[1],n=this.m[2],r=this.m[3],o=this.m[4],s=this.m[5],a=e*r-i*n,l={x:o,y:s,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(e!=0||i!=0){let c=Math.sqrt(e*e+i*i);l.rotation=i>0?Math.acos(e/c):-Math.acos(e/c),l.scaleX=c,l.scaleY=a/c,l.skewX=(e*n+i*r)/a,l.skewY=0}else if(n!=0||r!=0){let c=Math.sqrt(n*n+r*r);l.rotation=Math.PI/2-(r>0?Math.acos(-n/c):-Math.acos(n/c)),l.scaleX=a/c,l.scaleY=c,l.skewX=0,l.skewY=(e*n+i*r)/a}return l.rotation=mt.Util._getRotation(l.rotation),l}};mt.Transform=b2;var Ale="[object Array]",Ole="[object Number]",Lle="[object String]",Nle="[object Boolean]",Ble=Math.PI/180,Hle=180/Math.PI,C2="#",zle="",Vle="0",Gle="Konva warning: ",FI="Konva error: ",Wle="rgb(",w2={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},Ule=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,Qm=[],jle=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(t){setTimeout(t,60)};mt.Util={_isElement(t){return!!(t&&t.nodeType==1)},_isFunction(t){return!!(t&&t.constructor&&t.call&&t.apply)},_isPlainObject(t){return!!t&&t.constructor===Object},_isArray(t){return Object.prototype.toString.call(t)===Ale},_isNumber(t){return Object.prototype.toString.call(t)===Ole&&!isNaN(t)&&isFinite(t)},_isString(t){return Object.prototype.toString.call(t)===Lle},_isBoolean(t){return Object.prototype.toString.call(t)===Nle},isObject(t){return t instanceof Object},isValidSelector(t){if(typeof t!="string")return!1;let e=t[0];return e==="#"||e==="."||e===e.toUpperCase()},_sign(t){return t===0||t>0?1:-1},requestAnimFrame(t){Qm.push(t),Qm.length===1&&jle(function(){let e=Qm;Qm=[],e.forEach(function(i){i()})})},createCanvasElement(){let t=document.createElement("canvas");try{t.style=t.style||{}}catch{}return t},createImageElement(){return document.createElement("img")},_isInDocument(t){for(;t=t.parentNode;)if(t==document)return!0;return!1},_urlToImage(t,e){let i=mt.Util.createImageElement();i.onload=function(){e(i)},i.src=t},_rgbToHex(t,e,i){return((1<<24)+(t<<16)+(e<<8)+i).toString(16).slice(1)},_hexToRgb(t){t=t.replace(C2,zle);let e=parseInt(t,16);return{r:e>>16&255,g:e>>8&255,b:e&255}},getRandomColor(){let t=(Math.random()*16777215<<0).toString(16);for(;t.length<6;)t=Vle+t;return C2+t},getRGB(t){let e;return t in w2?(e=w2[t],{r:e[0],g:e[1],b:e[2]}):t[0]===C2?this._hexToRgb(t.substring(1)):t.substr(0,4)===Wle?(e=Ule.exec(t.replace(/ /g,"")),{r:parseInt(e[1],10),g:parseInt(e[2],10),b:parseInt(e[3],10)}):{r:0,g:0,b:0}},colorToRGBA(t){return t=t||"black",mt.Util._namedColorToRBA(t)||mt.Util._hex3ColorToRGBA(t)||mt.Util._hex4ColorToRGBA(t)||mt.Util._hex6ColorToRGBA(t)||mt.Util._hex8ColorToRGBA(t)||mt.Util._rgbColorToRGBA(t)||mt.Util._rgbaColorToRGBA(t)||mt.Util._hslColorToRGBA(t)},_namedColorToRBA(t){let e=w2[t.toLowerCase()];return e?{r:e[0],g:e[1],b:e[2],a:1}:null},_rgbColorToRGBA(t){if(t.indexOf("rgb(")===0){t=t.match(/rgb\(([^)]+)\)/)[1];let e=t.split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:1}}},_rgbaColorToRGBA(t){if(t.indexOf("rgba(")===0){t=t.match(/rgba\(([^)]+)\)/)[1];let e=t.split(/ *, */).map((i,n)=>i.slice(-1)==="%"?n===3?parseInt(i)/100:parseInt(i)/100*255:Number(i));return{r:e[0],g:e[1],b:e[2],a:e[3]}}},_hex8ColorToRGBA(t){if(t[0]==="#"&&t.length===9)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:parseInt(t.slice(7,9),16)/255}},_hex6ColorToRGBA(t){if(t[0]==="#"&&t.length===7)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:1}},_hex4ColorToRGBA(t){if(t[0]==="#"&&t.length===5)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:parseInt(t[4]+t[4],16)/255}},_hex3ColorToRGBA(t){if(t[0]==="#"&&t.length===4)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:1}},_hslColorToRGBA(t){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(t)){let[e,...i]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(t),n=Number(i[0])/360,r=Number(i[1])/100,o=Number(i[2])/100,s,a,l;if(r===0)return l=o*255,{r:Math.round(l),g:Math.round(l),b:Math.round(l),a:1};o<.5?s=o*(1+r):s=o+r-o*r;let c=2*o-s,d=[0,0,0];for(let u=0;u<3;u++)a=n+1/3*-(u-1),a<0&&a++,a>1&&a--,6*a<1?l=c+(s-c)*6*a:2*a<1?l=s:3*a<2?l=c+(s-c)*(2/3-a)*6:l=c,d[u]=l*255;return{r:Math.round(d[0]),g:Math.round(d[1]),b:Math.round(d[2]),a:1}}},haveIntersection(t,e){return!(e.x>t.x+t.width||e.x+e.width<t.x||e.y>t.y+t.height||e.y+e.height<t.y)},cloneObject(t){let e={};for(let i in t)this._isPlainObject(t[i])?e[i]=this.cloneObject(t[i]):this._isArray(t[i])?e[i]=this.cloneArray(t[i]):e[i]=t[i];return e},cloneArray(t){return t.slice(0)},degToRad(t){return t*Ble},radToDeg(t){return t*Hle},_degToRad(t){return mt.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),mt.Util.degToRad(t)},_radToDeg(t){return mt.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),mt.Util.radToDeg(t)},_getRotation(t){return v2.Konva.angleDeg?mt.Util.radToDeg(t):t},_capitalize(t){return t.charAt(0).toUpperCase()+t.slice(1)},throw(t){throw new Error(FI+t)},error(t){console.error(FI+t)},warn(t){v2.Konva.showWarnings&&console.warn(Gle+t)},each(t,e){for(let i in t)e(i,t[i])},_inRange(t,e,i){return e<=t&&t<i},_getProjectionToSegment(t,e,i,n,r,o){let s,a,l,c=(t-i)*(t-i)+(e-n)*(e-n);if(c==0)s=t,a=e,l=(r-i)*(r-i)+(o-n)*(o-n);else{let d=((r-t)*(i-t)+(o-e)*(n-e))/c;d<0?(s=t,a=e,l=(t-r)*(t-r)+(e-o)*(e-o)):d>1?(s=i,a=n,l=(i-r)*(i-r)+(n-o)*(n-o)):(s=t+d*(i-t),a=e+d*(n-e),l=(s-r)*(s-r)+(a-o)*(a-o))}return[s,a,l]},_getProjectionToLine(t,e,i){let n=mt.Util.cloneObject(t),r=Number.MAX_VALUE;return e.forEach(function(o,s){if(!i&&s===e.length-1)return;let a=e[(s+1)%e.length],l=mt.Util._getProjectionToSegment(o.x,o.y,a.x,a.y,t.x,t.y),c=l[0],d=l[1],u=l[2];u<r&&(n.x=c,n.y=d,r=u)}),n},_prepareArrayForTween(t,e,i){let n=[],r=[];if(t.length>e.length){let s=e;e=t,t=s}for(let s=0;s<t.length;s+=2)n.push({x:t[s],y:t[s+1]});for(let s=0;s<e.length;s+=2)r.push({x:e[s],y:e[s+1]});let o=[];return r.forEach(function(s){let a=mt.Util._getProjectionToLine(s,n,i);o.push(a.x),o.push(a.y)}),o},_prepareToStringify(t){let e;t.visitedByCircularReferenceRemoval=!0;for(let i in t)if(t.hasOwnProperty(i)&&t[i]&&typeof t[i]=="object"){if(e=Object.getOwnPropertyDescriptor(t,i),t[i].visitedByCircularReferenceRemoval||mt.Util._isElement(t[i]))if(e.configurable)delete t[i];else return null;else if(mt.Util._prepareToStringify(t[i])===null)if(e.configurable)delete t[i];else return null}return delete t.visitedByCircularReferenceRemoval,t},_assign(t,e){for(let i in e)t[i]=e[i];return t},_getFirstPointerId(t){return t.touches?t.changedTouches[0].identifier:t.pointerId||999},releaseCanvas(...t){v2.Konva.releaseCanvasOnDestroy&&t.forEach(e=>{e.width=0,e.height=0})},drawRoundedRectPath(t,e,i,n){let r=0,o=0,s=0,a=0;typeof n=="number"?r=o=s=a=Math.min(n,e/2,i/2):(r=Math.min(n[0]||0,e/2,i/2),o=Math.min(n[1]||0,e/2,i/2),a=Math.min(n[2]||0,e/2,i/2),s=Math.min(n[3]||0,e/2,i/2)),t.moveTo(r,0),t.lineTo(e-o,0),t.arc(e-o,o,o,Math.PI*3/2,0,!1),t.lineTo(e,i-a),t.arc(e-a,i-a,a,0,Math.PI/2,!1),t.lineTo(s,i),t.arc(s,i-s,s,Math.PI/2,Math.PI,!1),t.lineTo(0,r),t.arc(r,r,r,Math.PI,Math.PI*3/2,!1)}}});var x2=ce(_s=>{"use strict";Object.defineProperty(_s,"__esModule",{value:!0});_s.HitContext=_s.SceneContext=_s.Context=void 0;var MI=Pt(),qle=Le();function $le(t){let e=[],i=t.length,n=MI.Util;for(let r=0;r<i;r++){let o=t[r];n._isNumber(o)?o=Math.round(o*1e3)/1e3:n._isString(o)||(o=o+""),e.push(o)}return e}var TI=",",Kle="(",Yle=")",Xle="([",Jle="])",Qle=";",Zle="()",ece="=",DI=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],tce=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],ice=100,Sc=class{constructor(e){this.canvas=e,qle.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,i){let n=this.traceArr,r=n.length,o="",s,a,l,c;for(s=0;s<r;s++)a=n[s],l=a.method,l?(c=a.args,o+=l,e?o+=Zle:MI.Util._isArray(c[0])?o+=Xle+c.join(TI)+Jle:(i&&(c=c.map(d=>typeof d=="number"?Math.floor(d):d)),o+=Kle+c.join(TI)+Yle)):(o+=a.property,e||(o+=ece+a.val)),o+=Qle;return o}clearTrace(){this.traceArr=[]}_trace(e){let i=this.traceArr,n;i.push(e),n=i.length,n>=ice&&i.shift()}reset(){let e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){let i=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,i.getWidth()/i.pixelRatio,i.getHeight()/i.pixelRatio)}_applyLineCap(e){let i=e.attrs.lineCap;i&&this.setAttr("lineCap",i)}_applyOpacity(e){let i=e.getAbsoluteOpacity();i!==1&&this.setAttr("globalAlpha",i)}_applyLineJoin(e){let i=e.attrs.lineJoin;i&&this.setAttr("lineJoin",i)}setAttr(e,i){this._context[e]=i}arc(e,i,n,r,o,s){this._context.arc(e,i,n,r,o,s)}arcTo(e,i,n,r,o){this._context.arcTo(e,i,n,r,o)}beginPath(){this._context.beginPath()}bezierCurveTo(e,i,n,r,o,s){this._context.bezierCurveTo(e,i,n,r,o,s)}clearRect(e,i,n,r){this._context.clearRect(e,i,n,r)}clip(...e){this._context.clip.apply(this._context,e)}closePath(){this._context.closePath()}createImageData(e,i){let n=arguments;if(n.length===2)return this._context.createImageData(e,i);if(n.length===1)return this._context.createImageData(e)}createLinearGradient(e,i,n,r){return this._context.createLinearGradient(e,i,n,r)}createPattern(e,i){return this._context.createPattern(e,i)}createRadialGradient(e,i,n,r,o,s){return this._context.createRadialGradient(e,i,n,r,o,s)}drawImage(e,i,n,r,o,s,a,l,c){let d=arguments,u=this._context;d.length===3?u.drawImage(e,i,n):d.length===5?u.drawImage(e,i,n,r,o):d.length===9&&u.drawImage(e,i,n,r,o,s,a,l,c)}ellipse(e,i,n,r,o,s,a,l){this._context.ellipse(e,i,n,r,o,s,a,l)}isPointInPath(e,i,n,r){return n?this._context.isPointInPath(n,e,i,r):this._context.isPointInPath(e,i,r)}fill(...e){this._context.fill.apply(this._context,e)}fillRect(e,i,n,r){this._context.fillRect(e,i,n,r)}strokeRect(e,i,n,r){this._context.strokeRect(e,i,n,r)}fillText(e,i,n,r){r?this._context.fillText(e,i,n,r):this._context.fillText(e,i,n)}measureText(e){return this._context.measureText(e)}getImageData(e,i,n,r){return this._context.getImageData(e,i,n,r)}lineTo(e,i){this._context.lineTo(e,i)}moveTo(e,i){this._context.moveTo(e,i)}rect(e,i,n,r){this._context.rect(e,i,n,r)}roundRect(e,i,n,r,o){this._context.roundRect(e,i,n,r,o)}putImageData(e,i,n){this._context.putImageData(e,i,n)}quadraticCurveTo(e,i,n,r){this._context.quadraticCurveTo(e,i,n,r)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,i){this._context.scale(e,i)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,i,n,r,o,s){this._context.setTransform(e,i,n,r,o,s)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,i,n,r){this._context.strokeText(e,i,n,r)}transform(e,i,n,r,o,s){this._context.transform(e,i,n,r,o,s)}translate(e,i){this._context.translate(e,i)}_enableTrace(){let e=this,i=DI.length,n=this.setAttr,r,o,s=function(a){let l=e[a],c;e[a]=function(){return o=$le(Array.prototype.slice.call(arguments,0)),c=l.apply(e,arguments),e._trace({method:a,args:o}),c}};for(r=0;r<i;r++)s(DI[r]);e.setAttr=function(){n.apply(e,arguments);let a=arguments[0],l=arguments[1];(a==="shadowOffsetX"||a==="shadowOffsetY"||a==="shadowBlur")&&(l=l/this.canvas.getPixelRatio()),e._trace({property:a,val:l})}}_applyGlobalCompositeOperation(e){let i=e.attrs.globalCompositeOperation;!i||i==="source-over"||this.setAttr("globalCompositeOperation",i)}};_s.Context=Sc;tce.forEach(function(t){Object.defineProperty(Sc.prototype,t,{get(){return this._context[t]},set(e){this._context[t]=e}})});var y2=class extends Sc{constructor(e,{willReadFrequently:i=!1}={}){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:i})}_fillColor(e){let i=e.fill();this.setAttr("fillStyle",i),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){let i=e._getLinearGradient();i&&(this.setAttr("fillStyle",i),e._fillFunc(this))}_fillRadialGradient(e){let i=e._getRadialGradient();i&&(this.setAttr("fillStyle",i),e._fillFunc(this))}_fill(e){let i=e.fill(),n=e.getFillPriority();if(i&&n==="color"){this._fillColor(e);return}let r=e.getFillPatternImage();if(r&&n==="pattern"){this._fillPattern(e);return}let o=e.getFillLinearGradientColorStops();if(o&&n==="linear-gradient"){this._fillLinearGradient(e);return}let s=e.getFillRadialGradientColorStops();if(s&&n==="radial-gradient"){this._fillRadialGradient(e);return}i?this._fillColor(e):r?this._fillPattern(e):o?this._fillLinearGradient(e):s&&this._fillRadialGradient(e)}_strokeLinearGradient(e){let i=e.getStrokeLinearGradientStartPoint(),n=e.getStrokeLinearGradientEndPoint(),r=e.getStrokeLinearGradientColorStops(),o=this.createLinearGradient(i.x,i.y,n.x,n.y);if(r){for(let s=0;s<r.length;s+=2)o.addColorStop(r[s],r[s+1]);this.setAttr("strokeStyle",o)}}_stroke(e){let i=e.dash(),n=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!n){this.save();let o=this.getCanvas().getPixelRatio();this.setTransform(o,0,0,o,0,0)}this._applyLineCap(e),i&&e.dashEnabled()&&(this.setLineDash(i),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),e.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),n||this.restore()}}_applyShadow(e){var i,n,r;let o=(i=e.getShadowRGBA())!==null&&i!==void 0?i:"black",s=(n=e.getShadowBlur())!==null&&n!==void 0?n:5,a=(r=e.getShadowOffset())!==null&&r!==void 0?r:{x:0,y:0},l=e.getAbsoluteScale(),c=this.canvas.getPixelRatio(),d=l.x*c,u=l.y*c;this.setAttr("shadowColor",o),this.setAttr("shadowBlur",s*Math.min(Math.abs(d),Math.abs(u))),this.setAttr("shadowOffsetX",a.x*d),this.setAttr("shadowOffsetY",a.y*u)}};_s.SceneContext=y2;var S2=class extends Sc{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){let i=e.getStrokeScaleEnabled();if(!i){this.save();let o=this.getCanvas().getPixelRatio();this.setTransform(o,0,0,o,0,0)}this._applyLineCap(e);let n=e.hitStrokeWidth(),r=n==="auto"?e.strokeWidth():n;this.setAttr("lineWidth",r),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),i||this.restore()}}};_s.HitContext=S2});var Ph=ce(ks=>{"use strict";Object.defineProperty(ks,"__esModule",{value:!0});ks.HitCanvas=ks.SceneCanvas=ks.Canvas=void 0;var e0=Pt(),II=x2(),AI=Le(),Zm;function nce(){if(Zm)return Zm;let t=e0.Util.createCanvasElement(),e=t.getContext("2d");return Zm=(function(){let i=AI.Konva._global.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return i/n})(),e0.Util.releaseCanvas(t),Zm}var Eh=class{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;let n=(e||{}).pixelRatio||AI.Konva.pixelRatio||nce();this.pixelRatio=n,this._canvas=e0.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){let i=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/i,this.getHeight()/i)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";let i=this.pixelRatio;this.getContext()._context.scale(i,i)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";let i=this.pixelRatio;this.getContext()._context.scale(i,i)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,i){this.setWidth(e||0),this.setHeight(i||0)}toDataURL(e,i){try{return this._canvas.toDataURL(e,i)}catch{try{return this._canvas.toDataURL()}catch(r){return e0.Util.error("Unable to get data URL. "+r.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};ks.Canvas=Eh;var E2=class extends Eh{constructor(e={width:0,height:0,willReadFrequently:!1}){super(e),this.context=new II.SceneContext(this,{willReadFrequently:e.willReadFrequently}),this.setSize(e.width,e.height)}};ks.SceneCanvas=E2;var P2=class extends Eh{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new II.HitContext(this),this.setSize(e.width,e.height)}};ks.HitCanvas=P2});var t0=ce(Zt=>{"use strict";Object.defineProperty(Zt,"__esModule",{value:!0});Zt.DD=void 0;var Rh=Le(),rce=Pt();Zt.DD={get isDragging(){let t=!1;return Zt.DD._dragElements.forEach(e=>{e.dragStatus==="dragging"&&(t=!0)}),t},justDragged:!1,get node(){let t;return Zt.DD._dragElements.forEach(e=>{t=e.node}),t},_dragElements:new Map,_drag(t){let e=[];Zt.DD._dragElements.forEach((i,n)=>{let{node:r}=i,o=r.getStage();o.setPointersPositions(t),i.pointerId===void 0&&(i.pointerId=rce.Util._getFirstPointerId(t));let s=o._changedPointerPositions.find(a=>a.id===i.pointerId);if(s){if(i.dragStatus!=="dragging"){let a=r.dragDistance();if(Math.max(Math.abs(s.x-i.startPointerPos.x),Math.abs(s.y-i.startPointerPos.y))<a||(r.startDrag({evt:t}),!r.isDragging()))return}r._setDragPosition(t,i),e.push(r)}}),e.forEach(i=>{i.fire("dragmove",{type:"dragmove",target:i,evt:t},!0)})},_endDragBefore(t){let e=[];Zt.DD._dragElements.forEach(i=>{let{node:n}=i,r=n.getStage();if(t&&r.setPointersPositions(t),!r._changedPointerPositions.find(a=>a.id===i.pointerId))return;(i.dragStatus==="dragging"||i.dragStatus==="stopped")&&(Zt.DD.justDragged=!0,Rh.Konva._mouseListenClick=!1,Rh.Konva._touchListenClick=!1,Rh.Konva._pointerListenClick=!1,i.dragStatus="stopped");let s=i.node.getLayer()||i.node instanceof Rh.Konva.Stage&&i.node;s&&e.indexOf(s)===-1&&e.push(s)}),e.forEach(i=>{i.draw()})},_endDragAfter(t){Zt.DD._dragElements.forEach((e,i)=>{e.dragStatus==="stopped"&&e.node.fire("dragend",{type:"dragend",target:e.node,evt:t},!0),e.dragStatus!=="dragging"&&Zt.DD._dragElements.delete(i)})}};Rh.Konva.isBrowser&&(window.addEventListener("mouseup",Zt.DD._endDragBefore,!0),window.addEventListener("touchend",Zt.DD._endDragBefore,!0),window.addEventListener("touchcancel",Zt.DD._endDragBefore,!0),window.addEventListener("mousemove",Zt.DD._drag),window.addEventListener("touchmove",Zt.DD._drag),window.addEventListener("mouseup",Zt.DD._endDragAfter,!1),window.addEventListener("touchend",Zt.DD._endDragAfter,!1),window.addEventListener("touchcancel",Zt.DD._endDragAfter,!1))});var We=ce(pn=>{"use strict";Object.defineProperty(pn,"__esModule",{value:!0});pn.RGBComponent=oce;pn.alphaComponent=sce;pn.getNumberValidator=ace;pn.getNumberOrArrayOfNumbersValidator=lce;pn.getNumberOrAutoValidator=cce;pn.getStringValidator=dce;pn.getStringOrGradientValidator=uce;pn.getFunctionValidator=hce;pn.getNumberArrayValidator=pce;pn.getBooleanValidator=fce;pn.getComponentValidator=gce;var Ro=Le(),Tt=Pt();function _o(t){return Tt.Util._isString(t)?'"'+t+'"':Object.prototype.toString.call(t)==="[object Number]"||Tt.Util._isBoolean(t)?t:Object.prototype.toString.call(t)}function oce(t){return t>255?255:t<0?0:Math.round(t)}function sce(t){return t>1?1:t<1e-4?1e-4:t}function ace(){if(Ro.Konva.isUnminified)return function(t,e){return Tt.Util._isNumber(t)||Tt.Util.warn(_o(t)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),t}}function lce(t){if(Ro.Konva.isUnminified)return function(e,i){let n=Tt.Util._isNumber(e),r=Tt.Util._isArray(e)&&e.length==t;return!n&&!r&&Tt.Util.warn(_o(e)+' is a not valid value for "'+i+'" attribute. The value should be a number or Array<number>('+t+")"),e}}function cce(){if(Ro.Konva.isUnminified)return function(t,e){return Tt.Util._isNumber(t)||t==="auto"||Tt.Util.warn(_o(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),t}}function dce(){if(Ro.Konva.isUnminified)return function(t,e){return Tt.Util._isString(t)||Tt.Util.warn(_o(t)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),t}}function uce(){if(Ro.Konva.isUnminified)return function(t,e){let i=Tt.Util._isString(t),n=Object.prototype.toString.call(t)==="[object CanvasGradient]"||t&&t.addColorStop;return i||n||Tt.Util.warn(_o(t)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),t}}function hce(){if(Ro.Konva.isUnminified)return function(t,e){return Tt.Util._isFunction(t)||Tt.Util.warn(_o(t)+' is a not valid value for "'+e+'" attribute. The value should be a function.'),t}}function pce(){if(Ro.Konva.isUnminified)return function(t,e){let i=Int8Array?Object.getPrototypeOf(Int8Array):null;return i&&t instanceof i||(Tt.Util._isArray(t)?t.forEach(function(n){Tt.Util._isNumber(n)||Tt.Util.warn('"'+e+'" attribute has non numeric element '+n+". Make sure that all elements are numbers.")}):Tt.Util.warn(_o(t)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),t}}function fce(){if(Ro.Konva.isUnminified)return function(t,e){return t===!0||t===!1||Tt.Util.warn(_o(t)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),t}}function gce(t){if(Ro.Konva.isUnminified)return function(e,i){return e==null||Tt.Util.isObject(e)||Tt.Util.warn(_o(e)+' is a not valid value for "'+i+'" attribute. The value should be an object with properties '+t),e}}});var Ne=ce(ir=>{"use strict";Object.defineProperty(ir,"__esModule",{value:!0});ir.Factory=void 0;var fn=Pt(),mce=We(),_h="get",kh="set";ir.Factory={addGetterSetter(t,e,i,n,r){ir.Factory.addGetter(t,e,i),ir.Factory.addSetter(t,e,n,r),ir.Factory.addOverloadedGetterSetter(t,e)},addGetter(t,e,i){let n=_h+fn.Util._capitalize(e);t.prototype[n]=t.prototype[n]||function(){let r=this.attrs[e];return r===void 0?i:r}},addSetter(t,e,i,n){let r=kh+fn.Util._capitalize(e);t.prototype[r]||ir.Factory.overWriteSetter(t,e,i,n)},overWriteSetter(t,e,i,n){let r=kh+fn.Util._capitalize(e);t.prototype[r]=function(o){return i&&o!==void 0&&o!==null&&(o=i.call(this,o,e)),this._setAttr(e,o),n&&n.call(this),this}},addComponentsGetterSetter(t,e,i,n,r){let o=i.length,s=fn.Util._capitalize,a=_h+s(e),l=kh+s(e);t.prototype[a]=function(){let d={};for(let u=0;u<o;u++){let h=i[u];d[h]=this.getAttr(e+s(h))}return d};let c=(0,mce.getComponentValidator)(i);t.prototype[l]=function(d){let u=this.attrs[e];n&&(d=n.call(this,d,e)),c&&c.call(this,d,e);for(let h in d)d.hasOwnProperty(h)&&this._setAttr(e+s(h),d[h]);return d||i.forEach(h=>{this._setAttr(e+s(h),void 0)}),this._fireChangeEvent(e,u,d),r&&r.call(this),this},ir.Factory.addOverloadedGetterSetter(t,e)},addOverloadedGetterSetter(t,e){let i=fn.Util._capitalize(e),n=kh+i,r=_h+i;t.prototype[e]=function(){return arguments.length?(this[n](arguments[0]),this):this[r]()}},addDeprecatedGetterSetter(t,e,i,n){fn.Util.error("Adding deprecated "+e);let r=_h+fn.Util._capitalize(e),o=e+" property is deprecated and will be removed soon. Look at Konva change log for more information.";t.prototype[r]=function(){fn.Util.error(o);let s=this.attrs[e];return s===void 0?i:s},ir.Factory.addSetter(t,e,n,function(){fn.Util.error(o)}),ir.Factory.addOverloadedGetterSetter(t,e)},backCompat(t,e){fn.Util.each(e,function(i,n){let r=t.prototype[n],o=_h+fn.Util._capitalize(i),s=kh+fn.Util._capitalize(i);function a(){r.apply(this,arguments),fn.Util.error('"'+i+'" method is deprecated and will be removed soon. Use ""'+n+'" instead.')}t.prototype[i]=a,t.prototype[o]=a,t.prototype[s]=a})},afterSetFilter(){this._filterUpToDate=!1}}});var Dt=ce(o0=>{"use strict";Object.defineProperty(o0,"__esModule",{value:!0});o0.Node=void 0;var xc=Ph(),On=t0(),Fh=Ne(),Fs=Le(),qe=Pt(),Bt=We(),n0="absoluteOpacity",i0="allEventListeners",ko="absoluteTransform",OI="absoluteScale",Ba="canvas",vce="Change",Cce="children",wce="konva",R2="listening",bce="mouseenter",yce="mouseleave",Sce="pointerenter",xce="pointerleave",Ece="touchenter",Pce="touchleave",LI="set",NI="Shape",r0=" ",BI="stage",Ts="transform",Rce="Stage",_2="visible",_ce=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(r0),kce=1,De=class t{constructor(e){this._id=kce++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===Ts||e===ko)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,i){let n=this._cache.get(e);return(n===void 0||(e===Ts||e===ko)&&n.dirty===!0)&&(n=i.call(this),this._cache.set(e,n)),n}_calculate(e,i,n){if(!this._attachedDepsListeners.get(e)){let r=i.map(o=>o+"Change.konva").join(r0);this.on(r,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,n)}_getCanvasCache(){return this._cache.get(Ba)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===ko&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(Ba)){let{scene:e,filter:i,hit:n,buffer:r}=this._cache.get(Ba);qe.Util.releaseCanvas(e,i,n,r),this._cache.delete(Ba)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){let i=e||{},n={};(i.x===void 0||i.y===void 0||i.width===void 0||i.height===void 0)&&(n=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let r=Math.ceil(i.width||n.width),o=Math.ceil(i.height||n.height),s=i.pixelRatio,a=i.x===void 0?Math.floor(n.x):i.x,l=i.y===void 0?Math.floor(n.y):i.y,c=i.offset||0,d=i.drawBorder||!1,u=i.hitCanvasPixelRatio||1;if(!r||!o){qe.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}let h=Math.abs(Math.round(n.x)-a)>.5?1:0,p=Math.abs(Math.round(n.y)-l)>.5?1:0;r+=c*2+h,o+=c*2+p,a-=c,l-=c;let f=new xc.SceneCanvas({pixelRatio:s,width:r,height:o}),g=new xc.SceneCanvas({pixelRatio:s,width:0,height:0,willReadFrequently:!0}),m=new xc.HitCanvas({pixelRatio:u,width:r,height:o}),v=f.getContext(),C=m.getContext(),b=new xc.SceneCanvas({width:f.width/f.pixelRatio+Math.abs(a),height:f.height/f.pixelRatio+Math.abs(l),pixelRatio:f.pixelRatio}),S=b.getContext();return m.isCache=!0,f.isCache=!0,this._cache.delete(Ba),this._filterUpToDate=!1,i.imageSmoothingEnabled===!1&&(f.getContext()._context.imageSmoothingEnabled=!1,g.getContext()._context.imageSmoothingEnabled=!1),v.save(),C.save(),S.save(),v.translate(-a,-l),C.translate(-a,-l),S.translate(-a,-l),b.x=a,b.y=l,this._isUnderCache=!0,this._clearSelfAndDescendantCache(n0),this._clearSelfAndDescendantCache(OI),this.drawScene(f,this,b),this.drawHit(m,this),this._isUnderCache=!1,v.restore(),C.restore(),d&&(v.save(),v.beginPath(),v.rect(0,0,r,o),v.closePath(),v.setAttr("strokeStyle","red"),v.setAttr("lineWidth",5),v.stroke(),v.restore()),this._cache.set(Ba,{scene:f,filter:g,hit:m,buffer:b,x:a,y:l}),this._requestDraw(),this}isCached(){return this._cache.has(Ba)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,i){let n=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],r=1/0,o=1/0,s=-1/0,a=-1/0,l=this.getAbsoluteTransform(i);return n.forEach(function(c){let d=l.point(c);r===void 0&&(r=s=d.x,o=a=d.y),r=Math.min(r,d.x),o=Math.min(o,d.y),s=Math.max(s,d.x),a=Math.max(a,d.y)}),{x:r,y:o,width:s-r,height:a-o}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);let i=this._getCanvasCache();e.translate(i.x,i.y);let n=this._getCachedSceneCanvas(),r=n.pixelRatio;e.drawImage(n._canvas,0,0,n.width/r,n.height/r),e.restore()}_drawCachedHitCanvas(e){let i=this._getCanvasCache(),n=i.hit;e.save(),e.translate(i.x,i.y),e.drawImage(n._canvas,0,0,n.width/n.pixelRatio,n.height/n.pixelRatio),e.restore()}_getCachedSceneCanvas(){let e=this.filters(),i=this._getCanvasCache(),n=i.scene,r=i.filter,o=r.getContext(),s,a,l,c;if(e){if(!this._filterUpToDate){let d=n.pixelRatio;r.setSize(n.width/n.pixelRatio,n.height/n.pixelRatio);try{for(s=e.length,o.clear(),o.drawImage(n._canvas,0,0,n.getWidth()/d,n.getHeight()/d),a=o.getImageData(0,0,r.getWidth(),r.getHeight()),l=0;l<s;l++){if(c=e[l],typeof c!="function"){qe.Util.error("Filter should be type of function, but got "+typeof c+" instead. Please check correct filters");continue}c.call(this,a),o.putImageData(a,0,0)}}catch(u){qe.Util.error("Unable to apply filter. "+u.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return r}return n}on(e,i){if(this._cache&&this._cache.delete(i0),arguments.length===3)return this._delegate.apply(this,arguments);let n=e.split(r0);for(let r=0;r<n.length;r++){let s=n[r].split("."),a=s[0],l=s[1]||"";this.eventListeners[a]||(this.eventListeners[a]=[]),this.eventListeners[a].push({name:l,handler:i})}return this}off(e,i){let n=(e||"").split(r0),r=n.length,o,s,a,l,c,d;if(this._cache&&this._cache.delete(i0),!e)for(s in this.eventListeners)this._off(s);for(o=0;o<r;o++)if(a=n[o],l=a.split("."),c=l[0],d=l[1],c)this.eventListeners[c]&&this._off(c,d,i);else for(s in this.eventListeners)this._off(s,d,i);return this}dispatchEvent(e){let i={target:this,type:e.type,evt:e};return this.fire(e.type,i),this}addEventListener(e,i){return this.on(e,function(n){i.call(this,n.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,i,n){let r=this;this.on(e,function(o){let s=o.target.findAncestors(i,!0,r);for(let a=0;a<s.length;a++)o=qe.Util.cloneObject(o),o.currentTarget=s[a],n.call(s[a],o)})}remove(){return this.isDragging()&&this.stopDrag(),On.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(ko),this._clearSelfAndDescendantCache(n0),this._clearSelfAndDescendantCache(OI),this._clearSelfAndDescendantCache(BI),this._clearSelfAndDescendantCache(_2),this._clearSelfAndDescendantCache(R2)}_remove(){this._clearCaches();let e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){let i="get"+qe.Util._capitalize(e);return qe.Util._isFunction(this[i])?this[i]():this.attrs[e]}getAncestors(){let e=this.getParent(),i=[];for(;e;)i.push(e),e=e.getParent();return i}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{let i,n;if(!e)return this;for(i in e)i!==Cce&&(n=LI+qe.Util._capitalize(i),qe.Util._isFunction(this[n])?this[n](e[i]):this._setAttr(i,e[i]))}),this}isListening(){return this._getCache(R2,this._isListening)}_isListening(e){if(!this.listening())return!1;let n=this.getParent();return n&&n!==e&&this!==e?n._isListening(e):!0}isVisible(){return this._getCache(_2,this._isVisible)}_isVisible(e){if(!this.visible())return!1;let n=this.getParent();return n&&n!==e&&this!==e?n._isVisible(e):!0}shouldDrawHit(e,i=!1){if(e)return this._isVisible(e)&&this._isListening(e);let n=this.getLayer(),r=!1;On.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(s.node.nodeType==="Stage"||s.node.getLayer()===n)&&(r=!0)});let o=!i&&!Fs.Konva.hitOnDragEnabled&&(r||Fs.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!o}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let e=this.getDepth(),i=this,n=0,r,o,s,a;function l(d){for(r=[],o=d.length,s=0;s<o;s++)a=d[s],n++,a.nodeType!==NI&&(r=r.concat(a.getChildren().slice())),a._id===i._id&&(s=o);r.length>0&&r[0].getDepth()<=e&&l(r)}let c=this.getStage();return i.nodeType!==Rce&&c&&l(c.getChildren()),n}getDepth(){let e=0,i=this.parent;for(;i;)e++,i=i.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(Ts),this._clearSelfAndDescendantCache(ko)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){let e=this.getStage();if(!e)return null;let i=e.getPointerPosition();if(!i)return null;let n=this.getAbsoluteTransform().copy();return n.invert(),n.point(i)}getAbsolutePosition(e){let i=!1,n=this.parent;for(;n;){if(n.isCached()){i=!0;break}n=n.parent}i&&!e&&(e=!0);let r=this.getAbsoluteTransform(e).getMatrix(),o=new qe.Transform,s=this.offset();return o.m=r.slice(),o.translate(s.x,s.y),o.getTranslation()}setAbsolutePosition(e){let s=this._clearTransform(),{x:i,y:n}=s,r=Vt(s,["x","y"]);this.attrs.x=i,this.attrs.y=n,this._clearCache(Ts);let o=this._getAbsoluteTransform().copy();return o.invert(),o.translate(e.x,e.y),e={x:this.attrs.x+o.getTranslation().x,y:this.attrs.y+o.getTranslation().y},this._setTransform(r),this.setPosition({x:e.x,y:e.y}),this._clearCache(Ts),this._clearSelfAndDescendantCache(ko),this}_setTransform(e){let i;for(i in e)this.attrs[i]=e[i]}_clearTransform(){let e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){let i=e.x,n=e.y,r=this.x(),o=this.y();return i!==void 0&&(r+=i),n!==void 0&&(o+=n),this.setPosition({x:r,y:o}),this}_eachAncestorReverse(e,i){let n=[],r=this.getParent(),o,s;if(!(i&&i._id===this._id)){for(n.unshift(this);r&&(!i||r._id!==i._id);)n.unshift(r),r=r.parent;for(o=n.length,s=0;s<o;s++)e(n[s])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return qe.Util.warn("Node has no parent. moveToTop function is ignored."),!1;let e=this.index,i=this.parent.getChildren().length;return e<i-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return qe.Util.warn("Node has no parent. moveUp function is ignored."),!1;let e=this.index,i=this.parent.getChildren().length;return e<i-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return qe.Util.warn("Node has no parent. moveDown function is ignored."),!1;let e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return qe.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;let e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return qe.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&qe.Util.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");let i=this.index;return this.parent.children.splice(i,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(n0,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let e=this.opacity(),i=this.getParent();return i&&!i._isUnderCache&&(e*=i.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){let e=this.getAttrs(),i,n,r,o,s,a={attrs:{},className:this.getClassName()};for(i in e)n=e[i],s=qe.Util.isObject(n)&&!qe.Util._isPlainObject(n)&&!qe.Util._isArray(n),!s&&(r=typeof this[i]=="function"&&this[i],delete e[i],o=r?r.call(this):null,e[i]=n,o!==n&&(a.attrs[i]=n));return qe.Util._prepareToStringify(a)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,i,n){let r=[];i&&this._isMatch(e)&&r.push(this);let o=this.parent;for(;o;){if(o===n)return r;o._isMatch(e)&&r.push(o),o=o.parent}return r}isAncestorOf(e){return!1}findAncestor(e,i,n){return this.findAncestors(e,i,n)[0]}_isMatch(e){if(!e)return!1;if(typeof e=="function")return e(this);let i=e.replace(/ /g,"").split(","),n=i.length,r,o;for(r=0;r<n;r++)if(o=i[r],qe.Util.isValidSelector(o)||(qe.Util.warn('Selector "'+o+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),qe.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),qe.Util.warn("Konva is awesome, right?")),o.charAt(0)==="#"){if(this.id()===o.slice(1))return!0}else if(o.charAt(0)==="."){if(this.hasName(o.slice(1)))return!0}else if(this.className===o||this.nodeType===o)return!0;return!1}getLayer(){let e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(BI,this._getStage)}_getStage(){let e=this.getParent();return e?e.getStage():null}fire(e,i={},n){return i.target=i.target||this,n?this._fireAndBubble(e,i):this._fire(e,i),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(ko,this._getAbsoluteTransform)}_getAbsoluteTransform(e){let i;if(e)return i=new qe.Transform,this._eachAncestorReverse(function(n){let r=n.transformsEnabled();r==="all"?i.multiply(n.getTransform()):r==="position"&&i.translate(n.x()-n.offsetX(),n.y()-n.offsetY())},e),i;{i=this._cache.get(ko)||new qe.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(i):i.reset();let n=this.transformsEnabled();if(n==="all")i.multiply(this.getTransform());else if(n==="position"){let r=this.attrs.x||0,o=this.attrs.y||0,s=this.attrs.offsetX||0,a=this.attrs.offsetY||0;i.translate(r-s,o-a)}return i.dirty=!1,i}}getAbsoluteScale(e){let i=this;for(;i;)i._isUnderCache&&(e=i),i=i.getParent();let r=this.getAbsoluteTransform(e).decompose();return{x:r.scaleX,y:r.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(Ts,this._getTransform)}_getTransform(){var e,i;let n=this._cache.get(Ts)||new qe.Transform;n.reset();let r=this.x(),o=this.y(),s=Fs.Konva.getAngle(this.rotation()),a=(e=this.attrs.scaleX)!==null&&e!==void 0?e:1,l=(i=this.attrs.scaleY)!==null&&i!==void 0?i:1,c=this.attrs.skewX||0,d=this.attrs.skewY||0,u=this.attrs.offsetX||0,h=this.attrs.offsetY||0;return(r!==0||o!==0)&&n.translate(r,o),s!==0&&n.rotate(s),(c!==0||d!==0)&&n.skew(c,d),(a!==1||l!==1)&&n.scale(a,l),(u!==0||h!==0)&&n.translate(-1*u,-1*h),n.dirty=!1,n}clone(e){let i=qe.Util.cloneObject(this.attrs),n,r,o,s,a;for(n in e)i[n]=e[n];let l=new this.constructor(i);for(n in this.eventListeners)for(r=this.eventListeners[n],o=r.length,s=0;s<o;s++)a=r[s],a.name.indexOf(wce)<0&&(l.eventListeners[n]||(l.eventListeners[n]=[]),l.eventListeners[n].push(a));return l}_toKonvaCanvas(e){e=e||{};let i=this.getClientRect(),n=this.getStage(),r=e.x!==void 0?e.x:Math.floor(i.x),o=e.y!==void 0?e.y:Math.floor(i.y),s=e.pixelRatio||1,a=new xc.SceneCanvas({width:e.width||Math.ceil(i.width)||(n?n.width():0),height:e.height||Math.ceil(i.height)||(n?n.height():0),pixelRatio:s}),l=a.getContext(),c=new xc.SceneCanvas({width:a.width/a.pixelRatio+Math.abs(r),height:a.height/a.pixelRatio+Math.abs(o),pixelRatio:a.pixelRatio});return e.imageSmoothingEnabled===!1&&(l._context.imageSmoothingEnabled=!1),l.save(),(r||o)&&l.translate(-1*r,-1*o),this.drawScene(a,void 0,c),l.restore(),a}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e=e||{};let i=e.mimeType||null,n=e.quality||null,r=this._toKonvaCanvas(e).toDataURL(i,n);return e.callback&&e.callback(r),r}toImage(e){return new Promise((i,n)=>{try{let r=e?.callback;r&&delete e.callback,qe.Util._urlToImage(this.toDataURL(e),function(o){i(o),r?.(o)})}catch(r){n(r)}})}toBlob(e){return new Promise((i,n)=>{try{let r=e?.callback;r&&delete e.callback,this.toCanvas(e).toBlob(o=>{i(o),r?.(o)},e?.mimeType,e?.quality)}catch(r){n(r)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Fs.Konva.dragDistance}_off(e,i,n){let r=this.eventListeners[e],o,s,a;for(o=0;o<r.length;o++)if(s=r[o].name,a=r[o].handler,(s!=="konva"||i==="konva")&&(!i||s===i)&&(!n||n===a)){if(r.splice(o,1),r.length===0){delete this.eventListeners[e];break}o--}}_fireChangeEvent(e,i,n){this._fire(e+vce,{oldVal:i,newVal:n})}addName(e){if(!this.hasName(e)){let i=this.name(),n=i?i+" "+e:e;this.name(n)}return this}hasName(e){if(!e)return!1;let i=this.name();return i?(i||"").split(/\s/g).indexOf(e)!==-1:!1}removeName(e){let i=(this.name()||"").split(/\s/g),n=i.indexOf(e);return n!==-1&&(i.splice(n,1),this.name(i.join(" "))),this}setAttr(e,i){let n=this[LI+qe.Util._capitalize(e)];return qe.Util._isFunction(n)?n.call(this,i):this._setAttr(e,i),this}_requestDraw(){if(Fs.Konva.autoDrawEnabled){let e=this.getLayer()||this.getStage();e?.batchDraw()}}_setAttr(e,i){let n=this.attrs[e];n===i&&!qe.Util.isObject(i)||(i==null?delete this.attrs[e]:this.attrs[e]=i,this._shouldFireChangeEvents&&this._fireChangeEvent(e,n,i),this._requestDraw())}_setComponentAttr(e,i,n){let r;n!==void 0&&(r=this.attrs[e],r||(this.attrs[e]=this.getAttr(e)),this.attrs[e][i]=n,this._fireChangeEvent(e,r,n))}_fireAndBubble(e,i,n){i&&this.nodeType===NI&&(i.target=this);let r=[bce,yce,Sce,xce,Ece,Pce];if(!(r.indexOf(e)!==-1&&(n&&(this===n||this.isAncestorOf&&this.isAncestorOf(n))||this.nodeType==="Stage"&&!n))){this._fire(e,i);let s=r.indexOf(e)!==-1&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(i&&!i.cancelBubble||!i)&&this.parent&&this.parent.isListening()&&!s&&(n&&n.parent?this._fireAndBubble.call(this.parent,e,i,n):this._fireAndBubble.call(this.parent,e,i))}}_getProtoListeners(e){var i,n,r;let o=(i=this._cache.get(i0))!==null&&i!==void 0?i:{},s=o?.[e];if(s===void 0){s=[];let a=Object.getPrototypeOf(this);for(;a;){let l=(r=(n=a.eventListeners)===null||n===void 0?void 0:n[e])!==null&&r!==void 0?r:[];s.push(...l),a=Object.getPrototypeOf(a)}o[e]=s,this._cache.set(i0,o)}return s}_fire(e,i){i=i||{},i.currentTarget=this,i.type=e;let n=this._getProtoListeners(e);if(n)for(let o=0;o<n.length;o++)n[o].handler.call(this,i);let r=this.eventListeners[e];if(r)for(let o=0;o<r.length;o++)r[o].handler.call(this,i)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){let i=e?e.pointerId:void 0,n=this.getStage(),r=this.getAbsolutePosition();if(!n)return;let o=n._getPointerById(i)||n._changedPointerPositions[0]||r;On.DD._dragElements.set(this._id,{node:this,startPointerPos:o,offset:{x:o.x-r.x,y:o.y-r.y},dragStatus:"ready",pointerId:i})}startDrag(e,i=!0){On.DD._dragElements.has(this._id)||this._createDragElement(e);let n=On.DD._dragElements.get(this._id);n.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},i)}_setDragPosition(e,i){let n=this.getStage()._getPointerById(i.pointerId);if(!n)return;let r={x:n.x-i.offset.x,y:n.y-i.offset.y},o=this.dragBoundFunc();if(o!==void 0){let s=o.call(this,r,e);s?r=s:qe.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==r.x||this._lastPos.y!==r.y)&&(this.setAbsolutePosition(r),this._requestDraw()),this._lastPos=r}stopDrag(e){let i=On.DD._dragElements.get(this._id);i&&(i.dragStatus="stopped"),On.DD._endDragBefore(e),On.DD._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){let e=On.DD._dragElements.get(this._id);return e?e.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){if(!(!(e.evt.button!==void 0)||Fs.Konva.dragButtons.indexOf(e.evt.button)>=0)||this.isDragging())return;let r=!1;On.DD._dragElements.forEach(o=>{this.isAncestorOf(o.node)&&(r=!0)}),r||this._createDragElement(e)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;let i=On.DD._dragElements.get(this._id),n=i&&i.dragStatus==="dragging",r=i&&i.dragStatus==="ready";n?this.stopDrag():r&&On.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){let i=this.getStage();if(!i)return!1;let n={x:-e.x,y:-e.y,width:i.width()+2*e.x,height:i.height()+2*e.y};return qe.Util.haveIntersection(n,this.getClientRect())}static create(e,i){return qe.Util._isString(e)&&(e=JSON.parse(e)),this._createNode(e,i)}static _createNode(e,i){let n=t.prototype.getClassName.call(e),r=e.children,o,s,a;i&&(e.attrs.container=i),Fs.Konva[n]||(qe.Util.warn('Can not find a node with class name "'+n+'". Fallback to "Shape".'),n="Shape");let l=Fs.Konva[n];if(o=new l(e.attrs),r)for(s=r.length,a=0;a<s;a++)o.add(t._createNode(r[a]));return o}};o0.Node=De;De.prototype.nodeType="Node";De.prototype._attrsAffectingSize=[];De.prototype.eventListeners={};De.prototype.on.call(De.prototype,_ce,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(Ts),this._clearSelfAndDescendantCache(ko)});De.prototype.on.call(De.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(_2)});De.prototype.on.call(De.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(R2)});De.prototype.on.call(De.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(n0)});var ft=Fh.Factory.addGetterSetter;ft(De,"zIndex");ft(De,"absolutePosition");ft(De,"position");ft(De,"x",0,(0,Bt.getNumberValidator)());ft(De,"y",0,(0,Bt.getNumberValidator)());ft(De,"globalCompositeOperation","source-over",(0,Bt.getStringValidator)());ft(De,"opacity",1,(0,Bt.getNumberValidator)());ft(De,"name","",(0,Bt.getStringValidator)());ft(De,"id","",(0,Bt.getStringValidator)());ft(De,"rotation",0,(0,Bt.getNumberValidator)());Fh.Factory.addComponentsGetterSetter(De,"scale",["x","y"]);ft(De,"scaleX",1,(0,Bt.getNumberValidator)());ft(De,"scaleY",1,(0,Bt.getNumberValidator)());Fh.Factory.addComponentsGetterSetter(De,"skew",["x","y"]);ft(De,"skewX",0,(0,Bt.getNumberValidator)());ft(De,"skewY",0,(0,Bt.getNumberValidator)());Fh.Factory.addComponentsGetterSetter(De,"offset",["x","y"]);ft(De,"offsetX",0,(0,Bt.getNumberValidator)());ft(De,"offsetY",0,(0,Bt.getNumberValidator)());ft(De,"dragDistance",void 0,(0,Bt.getNumberValidator)());ft(De,"width",0,(0,Bt.getNumberValidator)());ft(De,"height",0,(0,Bt.getNumberValidator)());ft(De,"listening",!0,(0,Bt.getBooleanValidator)());ft(De,"preventDefault",!0,(0,Bt.getBooleanValidator)());ft(De,"filters",void 0,function(t){return this._filterUpToDate=!1,t});ft(De,"visible",!0,(0,Bt.getBooleanValidator)());ft(De,"transformsEnabled","all",(0,Bt.getStringValidator)());ft(De,"size");ft(De,"dragBoundFunc");ft(De,"draggable",!1,(0,Bt.getBooleanValidator)());Fh.Factory.backCompat(De,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"})});var Th=ce(a0=>{"use strict";Object.defineProperty(a0,"__esModule",{value:!0});a0.Container=void 0;var Ec=Ne(),k2=Dt(),s0=We(),Fo=class extends k2.Node{constructor(){super(...arguments),this.children=[]}getChildren(e){let i=this.children||[];return e?i.filter(e):i}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(e.length===0)return this;if(e.length>1){for(let n=0;n<e.length;n++)this.add(e[n]);return this}let i=e[0];return i.getParent()?(i.moveTo(this),this):(this._validateAdd(i),i.index=this.getChildren().length,i.parent=this,i._clearCaches(),this.getChildren().push(i),this._fire("add",{child:i}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){let i=this._generalFind(e,!0);return i.length>0?i[0]:void 0}_generalFind(e,i){let n=[];return this._descendants(r=>{let o=r._isMatch(e);return o&&n.push(r),!!(o&&i)}),n}_descendants(e){let i=!1,n=this.getChildren();for(let r of n){if(i=e(r),i)return!0;if(r.hasChildren()&&(i=r._descendants(e),i))return!0}return!1}toObject(){let e=k2.Node.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(i=>{e.children.push(i.toObject())}),e}isAncestorOf(e){let i=e.getParent();for(;i;){if(i._id===this._id)return!0;i=i.getParent()}return!1}clone(e){let i=k2.Node.prototype.clone.call(this,e);return this.getChildren().forEach(function(n){i.add(n.clone())}),i}getAllIntersections(e){let i=[];return this.find("Shape").forEach(n=>{n.isVisible()&&n.intersects(e)&&i.push(n)}),i}_clearSelfAndDescendantCache(e){var i;super._clearSelfAndDescendantCache(e),!this.isCached()&&((i=this.children)===null||i===void 0||i.forEach(function(n){n._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)===null||e===void 0||e.forEach(function(i,n){i.index=n}),this._requestDraw()}drawScene(e,i,n){let r=this.getLayer(),o=e||r&&r.getCanvas(),s=o&&o.getContext(),a=this._getCanvasCache(),l=a&&a.scene,c=o&&o.isCache;if(!this.isVisible()&&!c)return this;if(l){s.save();let d=this.getAbsoluteTransform(i).getMatrix();s.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this._drawCachedSceneCanvas(s),s.restore()}else this._drawChildren("drawScene",o,i,n);return this}drawHit(e,i){if(!this.shouldDrawHit(i))return this;let n=this.getLayer(),r=e||n&&n.hitCanvas,o=r&&r.getContext(),s=this._getCanvasCache();if(s&&s.hit){o.save();let l=this.getAbsoluteTransform(i).getMatrix();o.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this._drawCachedHitCanvas(o),o.restore()}else this._drawChildren("drawHit",r,i);return this}_drawChildren(e,i,n,r){var o;let s=i&&i.getContext(),a=this.clipWidth(),l=this.clipHeight(),c=this.clipFunc(),d=typeof a=="number"&&typeof l=="number"||c,u=n===this;if(d){s.save();let p=this.getAbsoluteTransform(n),f=p.getMatrix();s.transform(f[0],f[1],f[2],f[3],f[4],f[5]),s.beginPath();let g;if(c)g=c.call(this,s,this);else{let m=this.clipX(),v=this.clipY();s.rect(m||0,v||0,a,l)}s.clip.apply(s,g),f=p.copy().invert().getMatrix(),s.transform(f[0],f[1],f[2],f[3],f[4],f[5])}let h=!u&&this.globalCompositeOperation()!=="source-over"&&e==="drawScene";h&&(s.save(),s._applyGlobalCompositeOperation(this)),(o=this.children)===null||o===void 0||o.forEach(function(p){p[e](i,n,r)}),h&&s.restore(),d&&s.restore()}getClientRect(e={}){var i;let n=e.skipTransform,r=e.relativeTo,o,s,a,l,c={x:1/0,y:1/0,width:0,height:0},d=this;(i=this.children)===null||i===void 0||i.forEach(function(p){if(!p.visible())return;let f=p.getClientRect({relativeTo:d,skipShadow:e.skipShadow,skipStroke:e.skipStroke});f.width===0&&f.height===0||(o===void 0?(o=f.x,s=f.y,a=f.x+f.width,l=f.y+f.height):(o=Math.min(o,f.x),s=Math.min(s,f.y),a=Math.max(a,f.x+f.width),l=Math.max(l,f.y+f.height)))});let u=this.find("Shape"),h=!1;for(let p=0;p<u.length;p++)if(u[p]._isVisible(this)){h=!0;break}return h&&o!==void 0?c={x:o,y:s,width:a-o,height:l-s}:c={x:0,y:0,width:0,height:0},n?c:this._transformedRect(c,r)}};a0.Container=Fo;Ec.Factory.addComponentsGetterSetter(Fo,"clip",["x","y","width","height"]);Ec.Factory.addGetterSetter(Fo,"clipX",void 0,(0,s0.getNumberValidator)());Ec.Factory.addGetterSetter(Fo,"clipY",void 0,(0,s0.getNumberValidator)());Ec.Factory.addGetterSetter(Fo,"clipWidth",void 0,(0,s0.getNumberValidator)());Ec.Factory.addGetterSetter(Fo,"clipHeight",void 0,(0,s0.getNumberValidator)());Ec.Factory.addGetterSetter(Fo,"clipFunc")});var T2=ce(Ha=>{"use strict";Object.defineProperty(Ha,"__esModule",{value:!0});Ha.getCapturedShape=Tce;Ha.createEvent=F2;Ha.hasPointerCapture=Dce;Ha.setPointerCapture=Mce;Ha.releaseCapture=zI;var Fce=Le(),Dh=new Map,HI=Fce.Konva._global.PointerEvent!==void 0;function Tce(t){return Dh.get(t)}function F2(t){return{evt:t,pointerId:t.pointerId}}function Dce(t,e){return Dh.get(t)===e}function Mce(t,e){zI(t),e.getStage()&&(Dh.set(t,e),HI&&e._fire("gotpointercapture",F2(new PointerEvent("gotpointercapture"))))}function zI(t,e){let i=Dh.get(t);if(!i)return;let n=i.getStage();n&&n.content,Dh.delete(t),HI&&i._fire("lostpointercapture",F2(new PointerEvent("lostpointercapture")))}});var L2=ce(Vr=>{"use strict";Object.defineProperty(Vr,"__esModule",{value:!0});Vr.Stage=Vr.stages=void 0;var zr=Pt(),Ice=Ne(),VI=Th(),Ht=Le(),D2=Ph(),M2=t0(),Ace=Le(),To=T2(),Oce="Stage",Lce="string",GI="px",Nce="mouseout",UI="mouseleave",jI="mouseover",qI="mouseenter",$I="mousemove",KI="mousedown",YI="mouseup",Mh="pointermove",Ih="pointerdown",Rc="pointerup",Ah="pointercancel",Bce="lostpointercapture",l0="pointerout",Oh="pointerleave",c0="pointerover",d0="pointerenter",A2="contextmenu",XI="touchstart",JI="touchend",QI="touchmove",ZI="touchcancel",O2="wheel",Hce=5,zce=[[qI,"_pointerenter"],[KI,"_pointerdown"],[$I,"_pointermove"],[YI,"_pointerup"],[UI,"_pointerleave"],[XI,"_pointerdown"],[QI,"_pointermove"],[JI,"_pointerup"],[ZI,"_pointercancel"],[jI,"_pointerover"],[O2,"_wheel"],[A2,"_contextmenu"],[Ih,"_pointerdown"],[Mh,"_pointermove"],[Rc,"_pointerup"],[Ah,"_pointercancel"],[Oh,"_pointerleave"],[Bce,"_lostpointercapture"]],I2={mouse:{[l0]:Nce,[Oh]:UI,[c0]:jI,[d0]:qI,[Mh]:$I,[Ih]:KI,[Rc]:YI,[Ah]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[l0]:"touchout",[Oh]:"touchleave",[c0]:"touchover",[d0]:"touchenter",[Mh]:QI,[Ih]:XI,[Rc]:JI,[Ah]:ZI,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[l0]:l0,[Oh]:Oh,[c0]:c0,[d0]:d0,[Mh]:Mh,[Ih]:Ih,[Rc]:Rc,[Ah]:Ah,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},Lh=t=>t.indexOf("pointer")>=0?"pointer":t.indexOf("touch")>=0?"touch":"mouse",Pc=t=>{let e=Lh(t);if(e==="pointer")return Ht.Konva.pointerEventsEnabled&&I2.pointer;if(e==="touch")return I2.touch;if(e==="mouse")return I2.mouse};function WI(t={}){return(t.clipFunc||t.clipWidth||t.clipHeight)&&zr.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),t}var Vce="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";Vr.stages=[];var _c=class extends VI.Container{constructor(e){super(WI(e)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),Vr.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{WI(this.attrs)}),this._checkVisibility()}_validateAdd(e){let i=e.getType()==="Layer",n=e.getType()==="FastLayer";i||n||zr.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;let e=this.visible()?"":"none";this.content.style.display=e}setContainer(e){if(typeof e===Lce){let i;if(e.charAt(0)==="."){let n=e.slice(1);e=document.getElementsByClassName(n)[0]}else e.charAt(0)!=="#"?i=e:i=e.slice(1),e=document.getElementById(i);if(!e)throw"Can not find container in document with id "+i}return this._setAttr("container",e),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),e.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){let e=this.children,i=e.length;for(let n=0;n<i;n++)e[n].clear();return this}clone(e){return e||(e={}),e.container=typeof document<"u"&&document.createElement("div"),VI.Container.prototype.clone.call(this,e)}destroy(){super.destroy();let e=this.content;e&&zr.Util._isInDocument(e)&&this.container().removeChild(e);let i=Vr.stages.indexOf(this);return i>-1&&Vr.stages.splice(i,1),zr.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){let e=this._pointerPositions[0]||this._changedPointerPositions[0];return e?{x:e.x,y:e.y}:(zr.Util.warn(Vce),null)}_getPointerById(e){return this._pointerPositions.find(i=>i.id===e)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(e){e=e||{},e.x=e.x||0,e.y=e.y||0,e.width=e.width||this.width(),e.height=e.height||this.height();let i=new D2.SceneCanvas({width:e.width,height:e.height,pixelRatio:e.pixelRatio||1}),n=i.getContext()._context,r=this.children;return(e.x||e.y)&&n.translate(-1*e.x,-1*e.y),r.forEach(function(o){if(!o.isVisible())return;let s=o._toKonvaCanvas(e);n.drawImage(s._canvas,e.x,e.y,s.getWidth()/s.getPixelRatio(),s.getHeight()/s.getPixelRatio())}),i}getIntersection(e){if(!e)return null;let i=this.children,n=i.length,r=n-1;for(let o=r;o>=0;o--){let s=i[o].getIntersection(e);if(s)return s}return null}_resizeDOM(){let e=this.width(),i=this.height();this.content&&(this.content.style.width=e+GI,this.content.style.height=i+GI),this.bufferCanvas.setSize(e,i),this.bufferHitCanvas.setSize(e,i),this.children.forEach(n=>{n.setSize({width:e,height:i}),n.draw()})}add(e,...i){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.add(arguments[r]);return this}super.add(e);let n=this.children.length;return n>Hce&&zr.Util.warn("The stage has "+n+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),e.setSize({width:this.width(),height:this.height()}),e.draw(),Ht.Konva.isBrowser&&this.content.appendChild(e.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(e){return To.hasPointerCapture(e,this)}setPointerCapture(e){To.setPointerCapture(e,this)}releaseCapture(e){To.releaseCapture(e,this)}getLayers(){return this.children}_bindContentEvents(){Ht.Konva.isBrowser&&zce.forEach(([e,i])=>{this.content.addEventListener(e,n=>{this[i](n)},{passive:!1})})}_pointerenter(e){this.setPointersPositions(e);let i=Pc(e.type);i&&this._fire(i.pointerenter,{evt:e,target:this,currentTarget:this})}_pointerover(e){this.setPointersPositions(e);let i=Pc(e.type);i&&this._fire(i.pointerover,{evt:e,target:this,currentTarget:this})}_getTargetShape(e){let i=this[e+"targetShape"];return i&&!i.getStage()&&(i=null),i}_pointerleave(e){let i=Pc(e.type),n=Lh(e.type);if(!i)return;this.setPointersPositions(e);let r=this._getTargetShape(n),o=!(Ht.Konva.isDragging()||Ht.Konva.isTransforming())||Ht.Konva.hitOnDragEnabled;r&&o?(r._fireAndBubble(i.pointerout,{evt:e}),r._fireAndBubble(i.pointerleave,{evt:e}),this._fire(i.pointerleave,{evt:e,target:this,currentTarget:this}),this[n+"targetShape"]=null):o&&(this._fire(i.pointerleave,{evt:e,target:this,currentTarget:this}),this._fire(i.pointerout,{evt:e,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(e){let i=Pc(e.type),n=Lh(e.type);if(!i)return;this.setPointersPositions(e);let r=!1;this._changedPointerPositions.forEach(o=>{let s=this.getIntersection(o);if(M2.DD.justDragged=!1,Ht.Konva["_"+n+"ListenClick"]=!0,!s||!s.isListening()){this[n+"ClickStartShape"]=void 0;return}Ht.Konva.capturePointerEventsEnabled&&s.setPointerCapture(o.id),this[n+"ClickStartShape"]=s,s._fireAndBubble(i.pointerdown,{evt:e,pointerId:o.id}),r=!0;let a=e.type.indexOf("touch")>=0;s.preventDefault()&&e.cancelable&&a&&e.preventDefault()}),r||this._fire(i.pointerdown,{evt:e,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(e){let i=Pc(e.type),n=Lh(e.type);if(!i||(Ht.Konva.isDragging()&&M2.DD.node.preventDefault()&&e.cancelable&&e.preventDefault(),this.setPointersPositions(e),!(!(Ht.Konva.isDragging()||Ht.Konva.isTransforming())||Ht.Konva.hitOnDragEnabled)))return;let o={},s=!1,a=this._getTargetShape(n);this._changedPointerPositions.forEach(l=>{let c=To.getCapturedShape(l.id)||this.getIntersection(l),d=l.id,u={evt:e,pointerId:d},h=a!==c;if(h&&a&&(a._fireAndBubble(i.pointerout,w({},u),c),a._fireAndBubble(i.pointerleave,w({},u),c)),c){if(o[c._id])return;o[c._id]=!0}c&&c.isListening()?(s=!0,h&&(c._fireAndBubble(i.pointerover,w({},u),a),c._fireAndBubble(i.pointerenter,w({},u),a),this[n+"targetShape"]=c),c._fireAndBubble(i.pointermove,w({},u))):a&&(this._fire(i.pointerover,{evt:e,target:this,currentTarget:this,pointerId:d}),this[n+"targetShape"]=null)}),s||this._fire(i.pointermove,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(e){let i=Pc(e.type),n=Lh(e.type);if(!i)return;this.setPointersPositions(e);let r=this[n+"ClickStartShape"],o=this[n+"ClickEndShape"],s={},a=!1;this._changedPointerPositions.forEach(l=>{let c=To.getCapturedShape(l.id)||this.getIntersection(l);if(c){if(c.releaseCapture(l.id),s[c._id])return;s[c._id]=!0}let d=l.id,u={evt:e,pointerId:d},h=!1;Ht.Konva["_"+n+"InDblClickWindow"]?(h=!0,clearTimeout(this[n+"DblTimeout"])):M2.DD.justDragged||(Ht.Konva["_"+n+"InDblClickWindow"]=!0,clearTimeout(this[n+"DblTimeout"])),this[n+"DblTimeout"]=setTimeout(function(){Ht.Konva["_"+n+"InDblClickWindow"]=!1},Ht.Konva.dblClickWindow),c&&c.isListening()?(a=!0,this[n+"ClickEndShape"]=c,c._fireAndBubble(i.pointerup,w({},u)),Ht.Konva["_"+n+"ListenClick"]&&r&&r===c&&(c._fireAndBubble(i.pointerclick,w({},u)),h&&o&&o===c&&c._fireAndBubble(i.pointerdblclick,w({},u)))):(this[n+"ClickEndShape"]=null,Ht.Konva["_"+n+"ListenClick"]&&this._fire(i.pointerclick,{evt:e,target:this,currentTarget:this,pointerId:d}),h&&this._fire(i.pointerdblclick,{evt:e,target:this,currentTarget:this,pointerId:d}))}),a||this._fire(i.pointerup,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),Ht.Konva["_"+n+"ListenClick"]=!1,e.cancelable&&n!=="touch"&&n!=="pointer"&&e.preventDefault()}_contextmenu(e){this.setPointersPositions(e);let i=this.getIntersection(this.getPointerPosition());i&&i.isListening()?i._fireAndBubble(A2,{evt:e}):this._fire(A2,{evt:e,target:this,currentTarget:this})}_wheel(e){this.setPointersPositions(e);let i=this.getIntersection(this.getPointerPosition());i&&i.isListening()?i._fireAndBubble(O2,{evt:e}):this._fire(O2,{evt:e,target:this,currentTarget:this})}_pointercancel(e){this.setPointersPositions(e);let i=To.getCapturedShape(e.pointerId)||this.getIntersection(this.getPointerPosition());i&&i._fireAndBubble(Rc,To.createEvent(e)),To.releaseCapture(e.pointerId)}_lostpointercapture(e){To.releaseCapture(e.pointerId)}setPointersPositions(e){let i=this._getContentPosition(),n=null,r=null;e=e||window.event,e.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(e.touches,o=>{this._pointerPositions.push({id:o.identifier,x:(o.clientX-i.left)/i.scaleX,y:(o.clientY-i.top)/i.scaleY})}),Array.prototype.forEach.call(e.changedTouches||e.touches,o=>{this._changedPointerPositions.push({id:o.identifier,x:(o.clientX-i.left)/i.scaleX,y:(o.clientY-i.top)/i.scaleY})})):(n=(e.clientX-i.left)/i.scaleX,r=(e.clientY-i.top)/i.scaleY,this.pointerPos={x:n,y:r},this._pointerPositions=[{x:n,y:r,id:zr.Util._getFirstPointerId(e)}],this._changedPointerPositions=[{x:n,y:r,id:zr.Util._getFirstPointerId(e)}])}_setPointerPosition(e){zr.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(e)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};let e=this.content.getBoundingClientRect();return{top:e.top,left:e.left,scaleX:e.width/this.content.clientWidth||1,scaleY:e.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new D2.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new D2.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!Ht.Konva.isBrowser)return;let e=this.container();if(!e)throw"Stage has no container. A container is required.";e.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),e.appendChild(this.content),this._resizeDOM()}cache(){return zr.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(e){e.batchDraw()}),this}};Vr.Stage=_c;_c.prototype.nodeType=Oce;(0,Ace._registerNode)(_c);Ice.Factory.addGetterSetter(_c,"container");Ht.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{Vr.stages.forEach(t=>{t.batchDraw()})})});var $t=ce(Do=>{"use strict";Object.defineProperty(Do,"__esModule",{value:!0});Do.Shape=Do.shapes=void 0;var Gce=Le(),Gr=Pt(),we=Ne(),eA=Dt(),qt=We(),Wce=Le(),N2=T2(),tA="hasShadow",iA="shadowRGBA",nA="patternImage",rA="linearGradient",oA="radialGradient",u0;function B2(){return u0||(u0=Gr.Util.createCanvasElement().getContext("2d"),u0)}Do.shapes={};function Uce(t){let e=this.attrs.fillRule;e?t.fill(e):t.fill()}function jce(t){t.stroke()}function qce(t){let e=this.attrs.fillRule;e?t.fill(e):t.fill()}function $ce(t){t.stroke()}function Kce(){this._clearCache(tA)}function Yce(){this._clearCache(iA)}function Xce(){this._clearCache(nA)}function Jce(){this._clearCache(rA)}function Qce(){this._clearCache(oA)}var le=class extends eA.Node{constructor(e){super(e);let i;for(;i=Gr.Util.getRandomColor(),!(i&&!(i in Do.shapes)););this.colorKey=i,Do.shapes[i]=this}getContext(){return Gr.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return Gr.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(tA,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(nA,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){let i=B2().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(i&&i.setTransform){let n=new Gr.Transform;n.translate(this.fillPatternX(),this.fillPatternY()),n.rotate(Gce.Konva.getAngle(this.fillPatternRotation())),n.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),n.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());let r=n.getMatrix(),o=typeof DOMMatrix>"u"?{a:r[0],b:r[1],c:r[2],d:r[3],e:r[4],f:r[5]}:new DOMMatrix(r);i.setTransform(o)}return i}}_getLinearGradient(){return this._getCache(rA,this.__getLinearGradient)}__getLinearGradient(){let e=this.fillLinearGradientColorStops();if(e){let i=B2(),n=this.fillLinearGradientStartPoint(),r=this.fillLinearGradientEndPoint(),o=i.createLinearGradient(n.x,n.y,r.x,r.y);for(let s=0;s<e.length;s+=2)o.addColorStop(e[s],e[s+1]);return o}}_getRadialGradient(){return this._getCache(oA,this.__getRadialGradient)}__getRadialGradient(){let e=this.fillRadialGradientColorStops();if(e){let i=B2(),n=this.fillRadialGradientStartPoint(),r=this.fillRadialGradientEndPoint(),o=i.createRadialGradient(n.x,n.y,this.fillRadialGradientStartRadius(),r.x,r.y,this.fillRadialGradientEndRadius());for(let s=0;s<e.length;s+=2)o.addColorStop(e[s],e[s+1]);return o}}getShadowRGBA(){return this._getCache(iA,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;let e=Gr.Util.colorToRGBA(this.shadowColor());if(e)return"rgba("+e.r+","+e.g+","+e.b+","+e.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){let e=this.hitStrokeWidth();return e==="auto"?this.hasStroke():this.strokeEnabled()&&!!e}intersects(e){let i=this.getStage();if(!i)return!1;let n=i.bufferHitCanvas;return n.getContext().clear(),this.drawHit(n,void 0,!0),n.context.getImageData(Math.round(e.x),Math.round(e.y),1,1).data[3]>0}destroy(){return eA.Node.prototype.destroy.call(this),delete Do.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(e){var i;if(!((i=this.attrs.perfectDrawEnabled)!==null&&i!==void 0?i:!0))return!1;let r=e||this.hasFill(),o=this.hasStroke(),s=this.getAbsoluteOpacity()!==1;if(r&&o&&s)return!0;let a=this.hasShadow(),l=this.shadowForStrokeEnabled();return!!(r&&o&&a&&l)}setStrokeHitEnabled(e){Gr.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),e?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){let e=this.size();return{x:this._centroid?-e.width/2:0,y:this._centroid?-e.height/2:0,width:e.width,height:e.height}}getClientRect(e={}){let i=!1,n=this.getParent();for(;n;){if(n.isCached()){i=!0;break}n=n.getParent()}let r=e.skipTransform,o=e.relativeTo||i&&this.getStage()||void 0,s=this.getSelfRect(),l=!e.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,c=s.width+l,d=s.height+l,u=!e.skipShadow&&this.hasShadow(),h=u?this.shadowOffsetX():0,p=u?this.shadowOffsetY():0,f=c+Math.abs(h),g=d+Math.abs(p),m=u&&this.shadowBlur()||0,v=f+m*2,C=g+m*2,b={width:v,height:C,x:-(l/2+m)+Math.min(h,0)+s.x,y:-(l/2+m)+Math.min(p,0)+s.y};return r?b:this._transformedRect(b,o)}drawScene(e,i,n){let r=this.getLayer(),o=e||r.getCanvas(),s=o.getContext(),a=this._getCanvasCache(),l=this.getSceneFunc(),c=this.hasShadow(),d,u=!1,h=i===this;if(!this.isVisible()&&!h)return this;if(a){s.save();let p=this.getAbsoluteTransform(i).getMatrix();return s.transform(p[0],p[1],p[2],p[3],p[4],p[5]),this._drawCachedSceneCanvas(s),s.restore(),this}if(!l)return this;if(s.save(),this._useBufferCanvas()&&!u){d=this.getStage();let p=n||d.bufferCanvas,f=p.getContext();f.clear(),f.save(),f._applyLineJoin(this);let g=this.getAbsoluteTransform(i).getMatrix();f.transform(g[0],g[1],g[2],g[3],g[4],g[5]),l.call(this,f,this),f.restore();let m=p.pixelRatio;c&&s._applyShadow(this),s._applyOpacity(this),s._applyGlobalCompositeOperation(this),s.drawImage(p._canvas,p.x||0,p.y||0,p.width/m,p.height/m)}else{if(s._applyLineJoin(this),!h){let p=this.getAbsoluteTransform(i).getMatrix();s.transform(p[0],p[1],p[2],p[3],p[4],p[5]),s._applyOpacity(this),s._applyGlobalCompositeOperation(this)}c&&s._applyShadow(this),l.call(this,s,this)}return s.restore(),this}drawHit(e,i,n=!1){if(!this.shouldDrawHit(i,n))return this;let r=this.getLayer(),o=e||r.hitCanvas,s=o&&o.getContext(),a=this.hitFunc()||this.sceneFunc(),l=this._getCanvasCache(),c=l&&l.hit;if(this.colorKey||Gr.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),c){s.save();let u=this.getAbsoluteTransform(i).getMatrix();return s.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedHitCanvas(s),s.restore(),this}if(!a)return this;if(s.save(),s._applyLineJoin(this),!(this===i)){let u=this.getAbsoluteTransform(i).getMatrix();s.transform(u[0],u[1],u[2],u[3],u[4],u[5])}return a.call(this,s,this),s.restore(),this}drawHitFromCache(e=0){let i=this._getCanvasCache(),n=this._getCachedSceneCanvas(),r=i.hit,o=r.getContext(),s=r.getWidth(),a=r.getHeight();o.clear(),o.drawImage(n._canvas,0,0,s,a);try{let l=o.getImageData(0,0,s,a),c=l.data,d=c.length,u=Gr.Util._hexToRgb(this.colorKey);for(let h=0;h<d;h+=4)c[h+3]>e?(c[h]=u.r,c[h+1]=u.g,c[h+2]=u.b,c[h+3]=255):c[h+3]=0;o.putImageData(l,0,0)}catch(l){Gr.Util.error("Unable to draw hit graph from cached scene canvas. "+l.message)}return this}hasPointerCapture(e){return N2.hasPointerCapture(e,this)}setPointerCapture(e){N2.setPointerCapture(e,this)}releaseCapture(e){N2.releaseCapture(e,this)}};Do.Shape=le;le.prototype._fillFunc=Uce;le.prototype._strokeFunc=jce;le.prototype._fillFuncHit=qce;le.prototype._strokeFuncHit=$ce;le.prototype._centroid=!1;le.prototype.nodeType="Shape";(0,Wce._registerNode)(le);le.prototype.eventListeners={};le.prototype.on.call(le.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",Kce);le.prototype.on.call(le.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",Yce);le.prototype.on.call(le.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",Xce);le.prototype.on.call(le.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",Jce);le.prototype.on.call(le.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",Qce);we.Factory.addGetterSetter(le,"stroke",void 0,(0,qt.getStringOrGradientValidator)());we.Factory.addGetterSetter(le,"strokeWidth",2,(0,qt.getNumberValidator)());we.Factory.addGetterSetter(le,"fillAfterStrokeEnabled",!1);we.Factory.addGetterSetter(le,"hitStrokeWidth","auto",(0,qt.getNumberOrAutoValidator)());we.Factory.addGetterSetter(le,"strokeHitEnabled",!0,(0,qt.getBooleanValidator)());we.Factory.addGetterSetter(le,"perfectDrawEnabled",!0,(0,qt.getBooleanValidator)());we.Factory.addGetterSetter(le,"shadowForStrokeEnabled",!0,(0,qt.getBooleanValidator)());we.Factory.addGetterSetter(le,"lineJoin");we.Factory.addGetterSetter(le,"lineCap");we.Factory.addGetterSetter(le,"sceneFunc");we.Factory.addGetterSetter(le,"hitFunc");we.Factory.addGetterSetter(le,"dash");we.Factory.addGetterSetter(le,"dashOffset",0,(0,qt.getNumberValidator)());we.Factory.addGetterSetter(le,"shadowColor",void 0,(0,qt.getStringValidator)());we.Factory.addGetterSetter(le,"shadowBlur",0,(0,qt.getNumberValidator)());we.Factory.addGetterSetter(le,"shadowOpacity",1,(0,qt.getNumberValidator)());we.Factory.addComponentsGetterSetter(le,"shadowOffset",["x","y"]);we.Factory.addGetterSetter(le,"shadowOffsetX",0,(0,qt.getNumberValidator)());we.Factory.addGetterSetter(le,"shadowOffsetY",0,(0,qt.getNumberValidator)());we.Factory.addGetterSetter(le,"fillPatternImage");we.Factory.addGetterSetter(le,"fill",void 0,(0,qt.getStringOrGradientValidator)());we.Factory.addGetterSetter(le,"fillPatternX",0,(0,qt.getNumberValidator)());we.Factory.addGetterSetter(le,"fillPatternY",0,(0,qt.getNumberValidator)());we.Factory.addGetterSetter(le,"fillLinearGradientColorStops");we.Factory.addGetterSetter(le,"strokeLinearGradientColorStops");we.Factory.addGetterSetter(le,"fillRadialGradientStartRadius",0);we.Factory.addGetterSetter(le,"fillRadialGradientEndRadius",0);we.Factory.addGetterSetter(le,"fillRadialGradientColorStops");we.Factory.addGetterSetter(le,"fillPatternRepeat","repeat");we.Factory.addGetterSetter(le,"fillEnabled",!0);we.Factory.addGetterSetter(le,"strokeEnabled",!0);we.Factory.addGetterSetter(le,"shadowEnabled",!0);we.Factory.addGetterSetter(le,"dashEnabled",!0);we.Factory.addGetterSetter(le,"strokeScaleEnabled",!0);we.Factory.addGetterSetter(le,"fillPriority","color");we.Factory.addComponentsGetterSetter(le,"fillPatternOffset",["x","y"]);we.Factory.addGetterSetter(le,"fillPatternOffsetX",0,(0,qt.getNumberValidator)());we.Factory.addGetterSetter(le,"fillPatternOffsetY",0,(0,qt.getNumberValidator)());we.Factory.addComponentsGetterSetter(le,"fillPatternScale",["x","y"]);we.Factory.addGetterSetter(le,"fillPatternScaleX",1,(0,qt.getNumberValidator)());we.Factory.addGetterSetter(le,"fillPatternScaleY",1,(0,qt.getNumberValidator)());we.Factory.addComponentsGetterSetter(le,"fillLinearGradientStartPoint",["x","y"]);we.Factory.addComponentsGetterSetter(le,"strokeLinearGradientStartPoint",["x","y"]);we.Factory.addGetterSetter(le,"fillLinearGradientStartPointX",0);we.Factory.addGetterSetter(le,"strokeLinearGradientStartPointX",0);we.Factory.addGetterSetter(le,"fillLinearGradientStartPointY",0);we.Factory.addGetterSetter(le,"strokeLinearGradientStartPointY",0);we.Factory.addComponentsGetterSetter(le,"fillLinearGradientEndPoint",["x","y"]);we.Factory.addComponentsGetterSetter(le,"strokeLinearGradientEndPoint",["x","y"]);we.Factory.addGetterSetter(le,"fillLinearGradientEndPointX",0);we.Factory.addGetterSetter(le,"strokeLinearGradientEndPointX",0);we.Factory.addGetterSetter(le,"fillLinearGradientEndPointY",0);we.Factory.addGetterSetter(le,"strokeLinearGradientEndPointY",0);we.Factory.addComponentsGetterSetter(le,"fillRadialGradientStartPoint",["x","y"]);we.Factory.addGetterSetter(le,"fillRadialGradientStartPointX",0);we.Factory.addGetterSetter(le,"fillRadialGradientStartPointY",0);we.Factory.addComponentsGetterSetter(le,"fillRadialGradientEndPoint",["x","y"]);we.Factory.addGetterSetter(le,"fillRadialGradientEndPointX",0);we.Factory.addGetterSetter(le,"fillRadialGradientEndPointY",0);we.Factory.addGetterSetter(le,"fillPatternRotation",0);we.Factory.addGetterSetter(le,"fillRule",void 0,(0,qt.getStringValidator)());we.Factory.backCompat(le,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})});var p0=ce(h0=>{"use strict";Object.defineProperty(h0,"__esModule",{value:!0});h0.Layer=void 0;var Mo=Pt(),H2=Th(),kc=Dt(),z2=Ne(),sA=Ph(),Zce=We(),ede=$t(),tde=Le(),ide="#",nde="beforeDraw",rde="draw",aA=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],ode=aA.length,Ds=class extends H2.Container{constructor(e){super(e),this.canvas=new sA.SceneCanvas,this.hitCanvas=new sA.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);let i=this.getStage();return i&&i.content&&(i.content.removeChild(this.getNativeCanvasElement()),e<i.children.length-1?i.content.insertBefore(this.getNativeCanvasElement(),i.children[e+1].getCanvas()._canvas):i.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){kc.Node.prototype.moveToTop.call(this);let e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!kc.Node.prototype.moveUp.call(this))return!1;let i=this.getStage();return!i||!i.content?!1:(i.content.removeChild(this.getNativeCanvasElement()),this.index<i.children.length-1?i.content.insertBefore(this.getNativeCanvasElement(),i.children[this.index+1].getCanvas()._canvas):i.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(kc.Node.prototype.moveDown.call(this)){let e=this.getStage();if(e){let i=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),i[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(kc.Node.prototype.moveToBottom.call(this)){let e=this.getStage();if(e){let i=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),i[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){let e=this.getNativeCanvasElement();return kc.Node.prototype.remove.call(this),e&&e.parentNode&&Mo.Util._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:i}){return this.canvas.setSize(e,i),this.hitCanvas.setSize(e,i),this._setSmoothEnabled(),this}_validateAdd(e){let i=e.getType();i!=="Group"&&i!=="Shape"&&Mo.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return e=e||{},e.width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=e.x!==void 0?e.x:this.x(),e.y=e.y!==void 0?e.y:this.y(),kc.Node.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){Mo.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){Mo.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,Mo.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;let i=1,n=!1;for(;;){for(let r=0;r<ode;r++){let o=aA[r],s=this._getIntersection({x:e.x+o.x*i,y:e.y+o.y*i}),a=s.shape;if(a)return a;if(n=!!s.antialiased,!s.antialiased)break}if(n)i+=1;else return null}}_getIntersection(e){let i=this.hitCanvas.pixelRatio,n=this.hitCanvas.context.getImageData(Math.round(e.x*i),Math.round(e.y*i),1,1).data,r=n[3];if(r===255){let o=Mo.Util._rgbToHex(n[0],n[1],n[2]),s=ede.shapes[ide+o];return s?{shape:s}:{antialiased:!0}}else if(r>0)return{antialiased:!0};return{}}drawScene(e,i,n){let r=this.getLayer(),o=e||r&&r.getCanvas();return this._fire(nde,{node:this}),this.clearBeforeDraw()&&o.getContext().clear(),H2.Container.prototype.drawScene.call(this,o,i,n),this._fire(rde,{node:this}),this}drawHit(e,i){let n=this.getLayer(),r=e||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),H2.Container.prototype.drawHit.call(this,r,i),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){Mo.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return Mo.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;let e=this.parent;!!this.hitCanvas._canvas.parentNode?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}destroy(){return Mo.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};h0.Layer=Ds;Ds.prototype.nodeType="Layer";(0,tde._registerNode)(Ds);z2.Factory.addGetterSetter(Ds,"imageSmoothingEnabled",!0);z2.Factory.addGetterSetter(Ds,"clearBeforeDraw",!0);z2.Factory.addGetterSetter(Ds,"hitGraphEnabled",!0,(0,Zce.getBooleanValidator)())});var lA=ce(f0=>{"use strict";Object.defineProperty(f0,"__esModule",{value:!0});f0.FastLayer=void 0;var sde=Pt(),ade=p0(),lde=Le(),Nh=class extends ade.Layer{constructor(e){super(e),this.listening(!1),sde.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};f0.FastLayer=Nh;Nh.prototype.nodeType="FastLayer";(0,lde._registerNode)(Nh)});var Hh=ce(g0=>{"use strict";Object.defineProperty(g0,"__esModule",{value:!0});g0.Group=void 0;var cde=Pt(),dde=Th(),ude=Le(),Bh=class extends dde.Container{_validateAdd(e){let i=e.getType();i!=="Group"&&i!=="Shape"&&cde.Util.throw("You may only add groups and shapes to groups.")}};g0.Group=Bh;Bh.prototype.nodeType="Group";(0,ude._registerNode)(Bh)});var v0=ce(m0=>{"use strict";Object.defineProperty(m0,"__esModule",{value:!0});m0.Animation=void 0;var V2=Le(),cA=Pt(),G2=(function(){return V2.glob.performance&&V2.glob.performance.now?function(){return V2.glob.performance.now()}:function(){return new Date().getTime()}})(),Fc=class t{constructor(e,i){this.id=t.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:G2(),frameRate:0},this.func=e,this.setLayers(i)}setLayers(e){let i=[];return e&&(i=Array.isArray(e)?e:[e]),this.layers=i,this}getLayers(){return this.layers}addLayer(e){let i=this.layers,n=i.length;for(let r=0;r<n;r++)if(i[r]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){let i=t.animations,n=i.length;for(let r=0;r<n;r++)if(i[r].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=G2(),t._addAnimation(this),this}stop(){return t._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){let i=e.id,n=this.animations,r=n.length;for(let o=0;o<r;o++)if(n[o].id===i){this.animations.splice(o,1);break}}static _runFrames(){let e={},i=this.animations;for(let n=0;n<i.length;n++){let r=i[n],o=r.layers,s=r.func;r._updateFrameObject(G2());let a=o.length,l;if(s?l=s.call(r,r.frame)!==!1:l=!0,!!l)for(let c=0;c<a;c++){let d=o[c];d._id!==void 0&&(e[d._id]=d)}}for(let n in e)e.hasOwnProperty(n)&&e[n].batchDraw()}static _animationLoop(){let e=t;e.animations.length?(e._runFrames(),cA.Util.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,cA.Util.requestAnimFrame(this._animationLoop))}};m0.Animation=Fc;Fc.animations=[];Fc.animIdCounter=0;Fc.animRunning=!1});var pA=ce(Wr=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});Wr.Easings=Wr.Tween=void 0;var Io=Pt(),hde=v0(),pde=Dt(),fde=Le(),gde={node:1,duration:1,easing:1,onFinish:1,yoyo:1},mde=1,dA=2,uA=3,hA=["fill","stroke","shadowColor"],vde=0,W2=class{constructor(e,i,n,r,o,s,a){this.prop=e,this.propFunc=i,this.begin=r,this._pos=r,this.duration=s,this._change=0,this.prevPos=0,this.yoyo=a,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=n,this._change=o-this.begin,this.pause()}fire(e){let i=this[e];i&&i()}setTime(e){e>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():e<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=e,this.update())}getTime(){return this._time}setPosition(e){this.prevPos=this._pos,this.propFunc(e),this._pos=e}getPosition(e){return e===void 0&&(e=this._time),this.func(e,this.begin,this._change,this.duration)}play(){this.state=dA,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=uA,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(e){this.pause(),this._time=e,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){let e=this.getTimer()-this._startTime;this.state===dA?this.setTime(e):this.state===uA&&this.setTime(this.duration-e)}pause(){this.state=mde,this.fire("onPause")}getTimer(){return new Date().getTime()}},Tc=class t{constructor(e){let i=this,n=e.node,r=n._id,o=e.easing||Wr.Easings.Linear,s=!!e.yoyo,a,l;typeof e.duration>"u"?a=.3:e.duration===0?a=.001:a=e.duration,this.node=n,this._id=vde++;let c=n.getLayer()||(n instanceof fde.Konva.Stage?n.getLayers():null);c||Io.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new hde.Animation(function(){i.tween.onEnterFrame()},c),this.tween=new W2(l,function(d){i._tweenFunc(d)},o,0,1,a*1e3,s),this._addListeners(),t.attrs[r]||(t.attrs[r]={}),t.attrs[r][this._id]||(t.attrs[r][this._id]={}),t.tweens[r]||(t.tweens[r]={});for(l in e)gde[l]===void 0&&this._addAttr(l,e[l]);this.reset(),this.onFinish=e.onFinish,this.onReset=e.onReset,this.onUpdate=e.onUpdate}_addAttr(e,i){let n=this.node,r=n._id,o,s,a,l,c,d=t.tweens[r][e];d&&delete t.attrs[r][d][e];let u=n.getAttr(e);if(Io.Util._isArray(i))if(o=[],s=Math.max(i.length,u.length),e==="points"&&i.length!==u.length&&(i.length>u.length?(l=u,u=Io.Util._prepareArrayForTween(u,i,n.closed())):(a=i,i=Io.Util._prepareArrayForTween(i,u,n.closed()))),e.indexOf("fill")===0)for(let h=0;h<s;h++)if(h%2===0)o.push(i[h]-u[h]);else{let p=Io.Util.colorToRGBA(u[h]);c=Io.Util.colorToRGBA(i[h]),u[h]=p,o.push({r:c.r-p.r,g:c.g-p.g,b:c.b-p.b,a:c.a-p.a})}else for(let h=0;h<s;h++)o.push(i[h]-u[h]);else hA.indexOf(e)!==-1?(u=Io.Util.colorToRGBA(u),c=Io.Util.colorToRGBA(i),o={r:c.r-u.r,g:c.g-u.g,b:c.b-u.b,a:c.a-u.a}):o=i-u;t.attrs[r][this._id][e]={start:u,diff:o,end:i,trueEnd:a,trueStart:l},t.tweens[r][e]=this._id}_tweenFunc(e){let i=this.node,n=t.attrs[i._id][this._id],r,o,s,a,l,c,d,u;for(r in n){if(o=n[r],s=o.start,a=o.diff,u=o.end,Io.Util._isArray(s))if(l=[],d=Math.max(s.length,u.length),r.indexOf("fill")===0)for(c=0;c<d;c++)c%2===0?l.push((s[c]||0)+a[c]*e):l.push("rgba("+Math.round(s[c].r+a[c].r*e)+","+Math.round(s[c].g+a[c].g*e)+","+Math.round(s[c].b+a[c].b*e)+","+(s[c].a+a[c].a*e)+")");else for(c=0;c<d;c++)l.push((s[c]||0)+a[c]*e);else hA.indexOf(r)!==-1?l="rgba("+Math.round(s.r+a.r*e)+","+Math.round(s.g+a.g*e)+","+Math.round(s.b+a.b*e)+","+(s.a+a.a*e)+")":l=s+a*e;i.setAttr(r,l)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{let e=this.node,i=t.attrs[e._id][this._id];i.points&&i.points.trueEnd&&e.setAttr("points",i.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{let e=this.node,i=t.attrs[e._id][this._id];i.points&&i.points.trueStart&&e.points(i.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(e){return this.tween.seek(e*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){let e=this.node._id,i=this._id,n=t.tweens[e];this.pause(),this.anim&&this.anim.stop();for(let r in n)delete t.tweens[e][r];delete t.attrs[e][i],t.tweens[e]&&(Object.keys(t.tweens[e]).length===0&&delete t.tweens[e],Object.keys(t.attrs[e]).length===0&&delete t.attrs[e])}};Wr.Tween=Tc;Tc.attrs={};Tc.tweens={};pde.Node.prototype.to=function(t){let e=t.onFinish;t.node=this,t.onFinish=function(){this.destroy(),e&&e()},new Tc(t).play()};Wr.Easings={BackEaseIn(t,e,i,n){return i*(t/=n)*t*((1.70158+1)*t-1.70158)+e},BackEaseOut(t,e,i,n){return i*((t=t/n-1)*t*((1.70158+1)*t+1.70158)+1)+e},BackEaseInOut(t,e,i,n){let r=1.70158;return(t/=n/2)<1?i/2*(t*t*(((r*=1.525)+1)*t-r))+e:i/2*((t-=2)*t*(((r*=1.525)+1)*t+r)+2)+e},ElasticEaseIn(t,e,i,n,r,o){let s=0;return t===0?e:(t/=n)===1?e+i:(o||(o=n*.3),!r||r<Math.abs(i)?(r=i,s=o/4):s=o/(2*Math.PI)*Math.asin(i/r),-(r*Math.pow(2,10*(t-=1))*Math.sin((t*n-s)*(2*Math.PI)/o))+e)},ElasticEaseOut(t,e,i,n,r,o){let s=0;return t===0?e:(t/=n)===1?e+i:(o||(o=n*.3),!r||r<Math.abs(i)?(r=i,s=o/4):s=o/(2*Math.PI)*Math.asin(i/r),r*Math.pow(2,-10*t)*Math.sin((t*n-s)*(2*Math.PI)/o)+i+e)},ElasticEaseInOut(t,e,i,n,r,o){let s=0;return t===0?e:(t/=n/2)===2?e+i:(o||(o=n*(.3*1.5)),!r||r<Math.abs(i)?(r=i,s=o/4):s=o/(2*Math.PI)*Math.asin(i/r),t<1?-.5*(r*Math.pow(2,10*(t-=1))*Math.sin((t*n-s)*(2*Math.PI)/o))+e:r*Math.pow(2,-10*(t-=1))*Math.sin((t*n-s)*(2*Math.PI)/o)*.5+i+e)},BounceEaseOut(t,e,i,n){return(t/=n)<1/2.75?i*(7.5625*t*t)+e:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e},BounceEaseIn(t,e,i,n){return i-Wr.Easings.BounceEaseOut(n-t,0,i,n)+e},BounceEaseInOut(t,e,i,n){return t<n/2?Wr.Easings.BounceEaseIn(t*2,0,i,n)*.5+e:Wr.Easings.BounceEaseOut(t*2-n,0,i,n)*.5+i*.5+e},EaseIn(t,e,i,n){return i*(t/=n)*t+e},EaseOut(t,e,i,n){return-i*(t/=n)*(t-2)+e},EaseInOut(t,e,i,n){return(t/=n/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},StrongEaseIn(t,e,i,n){return i*(t/=n)*t*t*t*t+e},StrongEaseOut(t,e,i,n){return i*((t=t/n-1)*t*t*t*t+1)+e},StrongEaseInOut(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e},Linear(t,e,i,n){return i*t/n+e}}});var vA=ce(Dc=>{"use strict";Object.defineProperty(Dc,"__esModule",{value:!0});Dc.Konva=void 0;var Cde=Le(),U2=Pt(),wde=Dt(),bde=Th(),fA=L2(),yde=p0(),Sde=lA(),xde=Hh(),Ede=t0(),gA=$t(),Pde=v0(),mA=pA(),Rde=x2(),_de=Ph();Dc.Konva=U2.Util._assign(Cde.Konva,{Util:U2.Util,Transform:U2.Transform,Node:wde.Node,Container:bde.Container,Stage:fA.Stage,stages:fA.stages,Layer:yde.Layer,FastLayer:Sde.FastLayer,Group:xde.Group,DD:Ede.DD,Shape:gA.Shape,shapes:gA.shapes,Animation:Pde.Animation,Tween:mA.Tween,Easings:mA.Easings,Context:Rde.Context,Canvas:_de.Canvas});Dc.default=Dc.Konva});var wA=ce(b0=>{"use strict";Object.defineProperty(b0,"__esModule",{value:!0});b0.Arc=void 0;var C0=Ne(),kde=$t(),CA=Le(),w0=We(),Fde=Le(),nr=class extends kde.Shape{_sceneFunc(e){let i=CA.Konva.getAngle(this.angle()),n=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,i,n),e.arc(0,0,this.innerRadius(),i,0,!n),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){let e=this.innerRadius(),i=this.outerRadius(),n=this.clockwise(),r=CA.Konva.getAngle(n?360-this.angle():this.angle()),o=Math.cos(Math.min(r,Math.PI)),s=1,a=Math.sin(Math.min(Math.max(Math.PI,r),3*Math.PI/2)),l=Math.sin(Math.min(r,Math.PI/2)),c=o*(o>0?e:i),d=s*(s>0?i:e),u=a*(a>0?e:i),h=l*(l>0?i:e);return{x:c,y:n?-1*h:u,width:d-c,height:h-u}}};b0.Arc=nr;nr.prototype._centroid=!0;nr.prototype.className="Arc";nr.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];(0,Fde._registerNode)(nr);C0.Factory.addGetterSetter(nr,"innerRadius",0,(0,w0.getNumberValidator)());C0.Factory.addGetterSetter(nr,"outerRadius",0,(0,w0.getNumberValidator)());C0.Factory.addGetterSetter(nr,"angle",0,(0,w0.getNumberValidator)());C0.Factory.addGetterSetter(nr,"clockwise",!1,(0,w0.getBooleanValidator)())});var q2=ce(S0=>{"use strict";Object.defineProperty(S0,"__esModule",{value:!0});S0.Line=void 0;var y0=Ne(),Tde=Le(),Dde=$t(),yA=We();function j2(t,e,i,n,r,o,s){let a=Math.sqrt(Math.pow(i-t,2)+Math.pow(n-e,2)),l=Math.sqrt(Math.pow(r-i,2)+Math.pow(o-n,2)),c=s*a/(a+l),d=s*l/(a+l),u=i-c*(r-t),h=n-c*(o-e),p=i+d*(r-t),f=n+d*(o-e);return[u,h,p,f]}function bA(t,e){let i=t.length,n=[];for(let r=2;r<i-2;r+=2){let o=j2(t[r-2],t[r-1],t[r],t[r+1],t[r+2],t[r+3],e);isNaN(o[0])||(n.push(o[0]),n.push(o[1]),n.push(t[r]),n.push(t[r+1]),n.push(o[2]),n.push(o[3]))}return n}var Ur=class extends Dde.Shape{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){let i=this.points(),n=i.length,r=this.tension(),o=this.closed(),s=this.bezier();if(!n)return;let a=0;if(e.beginPath(),e.moveTo(i[0],i[1]),r!==0&&n>4){let l=this.getTensionPoints(),c=l.length;for(a=o?0:4,o||e.quadraticCurveTo(l[0],l[1],l[2],l[3]);a<c-2;)e.bezierCurveTo(l[a++],l[a++],l[a++],l[a++],l[a++],l[a++]);o||e.quadraticCurveTo(l[c-2],l[c-1],i[n-2],i[n-1])}else if(s)for(a=2;a<n;)e.bezierCurveTo(i[a++],i[a++],i[a++],i[a++],i[a++],i[a++]);else for(a=2;a<n;a+=2)e.lineTo(i[a],i[a+1]);o?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():bA(this.points(),this.tension())}_getTensionPointsClosed(){let e=this.points(),i=e.length,n=this.tension(),r=j2(e[i-2],e[i-1],e[0],e[1],e[2],e[3],n),o=j2(e[i-4],e[i-3],e[i-2],e[i-1],e[0],e[1],n),s=bA(e,n);return[r[2],r[3]].concat(s).concat([o[0],o[1],e[i-2],e[i-1],o[2],o[3],r[0],r[1],e[0],e[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};this.tension()!==0?e=[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:e=this.points();let i=e[0],n=e[0],r=e[1],o=e[1],s,a;for(let l=0;l<e.length/2;l++)s=e[l*2],a=e[l*2+1],i=Math.min(i,s),n=Math.max(n,s),r=Math.min(r,a),o=Math.max(o,a);return{x:i,y:r,width:n-i,height:o-r}}};S0.Line=Ur;Ur.prototype.className="Line";Ur.prototype._attrsAffectingSize=["points","bezier","tension"];(0,Tde._registerNode)(Ur);y0.Factory.addGetterSetter(Ur,"closed",!1);y0.Factory.addGetterSetter(Ur,"bezier",!1);y0.Factory.addGetterSetter(Ur,"tension",0,(0,yA.getNumberValidator)());y0.Factory.addGetterSetter(Ur,"points",[],(0,yA.getNumberArrayValidator)())});var SA=ce(fi=>{"use strict";Object.defineProperty(fi,"__esModule",{value:!0});fi.t2length=fi.getQuadraticArcLength=fi.getCubicArcLength=fi.binomialCoefficients=fi.cValues=fi.tValues=void 0;fi.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]];fi.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]];fi.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];var Mde=(t,e,i)=>{let n,r,s=i/2;n=0;for(let a=0;a<20;a++)r=s*fi.tValues[20][a]+s,n+=fi.cValues[20][a]*Ade(t,e,r);return s*n};fi.getCubicArcLength=Mde;var Ide=(t,e,i)=>{i===void 0&&(i=1);let n=t[0]-2*t[1]+t[2],r=e[0]-2*e[1]+e[2],o=2*t[1]-2*t[0],s=2*e[1]-2*e[0],a=4*(n*n+r*r),l=4*(n*o+r*s),c=o*o+s*s;if(a===0)return i*Math.sqrt(Math.pow(t[2]-t[0],2)+Math.pow(e[2]-e[0],2));let d=l/(2*a),u=c/a,h=i+d,p=u-d*d,f=h*h+p>0?Math.sqrt(h*h+p):0,g=d*d+p>0?Math.sqrt(d*d+p):0,m=d+Math.sqrt(d*d+p)!==0?p*Math.log(Math.abs((h+f)/(d+g))):0;return Math.sqrt(a)/2*(h*f-d*g+m)};fi.getQuadraticArcLength=Ide;function Ade(t,e,i){let n=$2(1,i,t),r=$2(1,i,e),o=n*n+r*r;return Math.sqrt(o)}var $2=(t,e,i)=>{let n=i.length-1,r,o;if(n===0)return 0;if(t===0){o=0;for(let s=0;s<=n;s++)o+=fi.binomialCoefficients[n][s]*Math.pow(1-e,n-s)*Math.pow(e,s)*i[s];return o}else{r=new Array(n);for(let s=0;s<n;s++)r[s]=n*(i[s+1]-i[s]);return $2(t-1,e,r)}},Ode=(t,e,i)=>{let n=1,r=t/e,o=(t-i(r))/e,s=0;for(;n>.001;){let a=i(r+o),l=Math.abs(t-a)/e;if(l<n)n=l,r+=o;else{let c=i(r-o),d=Math.abs(t-c)/e;d<n?(n=d,r-=o):o/=2}if(s++,s>500)break}return r};fi.t2length=Ode});var E0=ce(x0=>{"use strict";Object.defineProperty(x0,"__esModule",{value:!0});x0.Path=void 0;var Lde=Ne(),Nde=Le(),Bde=$t(),Mc=SA(),za=class t extends Bde.Shape{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=t.parsePathData(this.data()),this.pathLength=t.getPathLength(this.dataArray)}_sceneFunc(e){let i=this.dataArray;e.beginPath();let n=!1;for(let r=0;r<i.length;r++){let o=i[r].command,s=i[r].points;switch(o){case"L":e.lineTo(s[0],s[1]);break;case"M":e.moveTo(s[0],s[1]);break;case"C":e.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case"Q":e.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case"A":let a=s[0],l=s[1],c=s[2],d=s[3],u=s[4],h=s[5],p=s[6],f=s[7],g=c>d?c:d,m=c>d?1:c/d,v=c>d?d/c:1;e.translate(a,l),e.rotate(p),e.scale(m,v),e.arc(0,0,g,u,u+h,1-f),e.scale(1/m,1/v),e.rotate(-p),e.translate(-a,-l);break;case"z":n=!0,e.closePath();break}}!n&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){let e=[];this.dataArray.forEach(function(l){if(l.command==="A"){let c=l.points[4],d=l.points[5],u=l.points[4]+d,h=Math.PI/180;if(Math.abs(c-u)<h&&(h=Math.abs(c-u)),d<0)for(let p=c-h;p>u;p-=h){let f=t.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],p,0);e.push(f.x,f.y)}else for(let p=c+h;p<u;p+=h){let f=t.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],p,0);e.push(f.x,f.y)}}else if(l.command==="C")for(let c=0;c<=1;c+=.01){let d=t.getPointOnCubicBezier(c,l.start.x,l.start.y,l.points[0],l.points[1],l.points[2],l.points[3],l.points[4],l.points[5]);e.push(d.x,d.y)}else e=e.concat(l.points)});let i=e[0],n=e[0],r=e[1],o=e[1],s,a;for(let l=0;l<e.length/2;l++)s=e[l*2],a=e[l*2+1],isNaN(s)||(i=Math.min(i,s),n=Math.max(n,s)),isNaN(a)||(r=Math.min(r,a),o=Math.max(o,a));return{x:i,y:r,width:n-i,height:o-r}}getLength(){return this.pathLength}getPointAtLength(e){return t.getPointAtLengthOfDataArray(e,this.dataArray)}static getLineLength(e,i,n,r){return Math.sqrt((n-e)*(n-e)+(r-i)*(r-i))}static getPathLength(e){let i=0;for(let n=0;n<e.length;++n)i+=e[n].pathLength;return i}static getPointAtLengthOfDataArray(e,i){let n,r=0,o=i.length;if(!o)return null;for(;r<o&&e>i[r].pathLength;)e-=i[r].pathLength,++r;if(r===o)return n=i[r-1].points.slice(-2),{x:n[0],y:n[1]};if(e<.01)return i[r].command==="M"?(n=i[r].points.slice(0,2),{x:n[0],y:n[1]}):{x:i[r].start.x,y:i[r].start.y};let s=i[r],a=s.points;switch(s.command){case"L":return t.getPointOnLine(e,s.start.x,s.start.y,a[0],a[1]);case"C":return t.getPointOnCubicBezier((0,Mc.t2length)(e,t.getPathLength(i),g=>(0,Mc.getCubicArcLength)([s.start.x,a[0],a[2],a[4]],[s.start.y,a[1],a[3],a[5]],g)),s.start.x,s.start.y,a[0],a[1],a[2],a[3],a[4],a[5]);case"Q":return t.getPointOnQuadraticBezier((0,Mc.t2length)(e,t.getPathLength(i),g=>(0,Mc.getQuadraticArcLength)([s.start.x,a[0],a[2]],[s.start.y,a[1],a[3]],g)),s.start.x,s.start.y,a[0],a[1],a[2],a[3]);case"A":let l=a[0],c=a[1],d=a[2],u=a[3],h=a[5],p=a[6],f=a[4];return f+=h*e/s.pathLength,t.getPointOnEllipticalArc(l,c,d,u,f,p)}return null}static getPointOnLine(e,i,n,r,o,s,a){s=s??i,a=a??n;let l=this.getLineLength(i,n,r,o);if(l<1e-10)return{x:i,y:n};if(r===i)return{x:s,y:a+(o>n?e:-e)};let c=(o-n)/(r-i),d=Math.sqrt(e*e/(1+c*c))*(r<i?-1:1),u=c*d;if(Math.abs(a-n-c*(s-i))<1e-10)return{x:s+d,y:a+u};let h=((s-i)*(r-i)+(a-n)*(o-n))/(l*l),p=i+h*(r-i),f=n+h*(o-n),g=this.getLineLength(s,a,p,f),m=Math.sqrt(e*e-g*g),v=Math.sqrt(m*m/(1+c*c))*(r<i?-1:1),C=c*v;return{x:p+v,y:f+C}}static getPointOnCubicBezier(e,i,n,r,o,s,a,l,c){function d(m){return m*m*m}function u(m){return 3*m*m*(1-m)}function h(m){return 3*m*(1-m)*(1-m)}function p(m){return(1-m)*(1-m)*(1-m)}let f=l*d(e)+s*u(e)+r*h(e)+i*p(e),g=c*d(e)+a*u(e)+o*h(e)+n*p(e);return{x:f,y:g}}static getPointOnQuadraticBezier(e,i,n,r,o,s,a){function l(p){return p*p}function c(p){return 2*p*(1-p)}function d(p){return(1-p)*(1-p)}let u=s*l(e)+r*c(e)+i*d(e),h=a*l(e)+o*c(e)+n*d(e);return{x:u,y:h}}static getPointOnEllipticalArc(e,i,n,r,o,s){let a=Math.cos(s),l=Math.sin(s),c={x:n*Math.cos(o),y:r*Math.sin(o)};return{x:e+(c.x*a-c.y*l),y:i+(c.x*l+c.y*a)}}static parsePathData(e){if(!e)return[];let i=e,n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];i=i.replace(new RegExp(" ","g"),",");for(let u=0;u<n.length;u++)i=i.replace(new RegExp(n[u],"g"),"|"+n[u]);let r=i.split("|"),o=[],s=[],a=0,l=0,c=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,d;for(let u=1;u<r.length;u++){let h=r[u],p=h.charAt(0);for(h=h.slice(1),s.length=0;d=c.exec(h);)s.push(d[0]);let f=[];for(let g=0,m=s.length;g<m;g++){if(s[g]==="00"){f.push(0,0);continue}let v=parseFloat(s[g]);isNaN(v)?f.push(0):f.push(v)}for(;f.length>0&&!isNaN(f[0]);){let g="",m=[],v=a,C=l,b,S,x,E,P,L,B,j,q,Y;switch(p){case"l":a+=f.shift(),l+=f.shift(),g="L",m.push(a,l);break;case"L":a=f.shift(),l=f.shift(),m.push(a,l);break;case"m":let he=f.shift(),Se=f.shift();if(a+=he,l+=Se,g="M",o.length>2&&o[o.length-1].command==="z"){for(let be=o.length-2;be>=0;be--)if(o[be].command==="M"){a=o[be].points[0]+he,l=o[be].points[1]+Se;break}}m.push(a,l),p="l";break;case"M":a=f.shift(),l=f.shift(),g="M",m.push(a,l),p="L";break;case"h":a+=f.shift(),g="L",m.push(a,l);break;case"H":a=f.shift(),g="L",m.push(a,l);break;case"v":l+=f.shift(),g="L",m.push(a,l);break;case"V":l=f.shift(),g="L",m.push(a,l);break;case"C":m.push(f.shift(),f.shift(),f.shift(),f.shift()),a=f.shift(),l=f.shift(),m.push(a,l);break;case"c":m.push(a+f.shift(),l+f.shift(),a+f.shift(),l+f.shift()),a+=f.shift(),l+=f.shift(),g="C",m.push(a,l);break;case"S":S=a,x=l,b=o[o.length-1],b.command==="C"&&(S=a+(a-b.points[2]),x=l+(l-b.points[3])),m.push(S,x,f.shift(),f.shift()),a=f.shift(),l=f.shift(),g="C",m.push(a,l);break;case"s":S=a,x=l,b=o[o.length-1],b.command==="C"&&(S=a+(a-b.points[2]),x=l+(l-b.points[3])),m.push(S,x,a+f.shift(),l+f.shift()),a+=f.shift(),l+=f.shift(),g="C",m.push(a,l);break;case"Q":m.push(f.shift(),f.shift()),a=f.shift(),l=f.shift(),m.push(a,l);break;case"q":m.push(a+f.shift(),l+f.shift()),a+=f.shift(),l+=f.shift(),g="Q",m.push(a,l);break;case"T":S=a,x=l,b=o[o.length-1],b.command==="Q"&&(S=a+(a-b.points[0]),x=l+(l-b.points[1])),a=f.shift(),l=f.shift(),g="Q",m.push(S,x,a,l);break;case"t":S=a,x=l,b=o[o.length-1],b.command==="Q"&&(S=a+(a-b.points[0]),x=l+(l-b.points[1])),a+=f.shift(),l+=f.shift(),g="Q",m.push(S,x,a,l);break;case"A":E=f.shift(),P=f.shift(),L=f.shift(),B=f.shift(),j=f.shift(),q=a,Y=l,a=f.shift(),l=f.shift(),g="A",m=this.convertEndpointToCenterParameterization(q,Y,a,l,B,j,E,P,L);break;case"a":E=f.shift(),P=f.shift(),L=f.shift(),B=f.shift(),j=f.shift(),q=a,Y=l,a+=f.shift(),l+=f.shift(),g="A",m=this.convertEndpointToCenterParameterization(q,Y,a,l,B,j,E,P,L);break}o.push({command:g||p,points:m,start:{x:v,y:C},pathLength:this.calcLength(v,C,g||p,m)})}(p==="z"||p==="Z")&&o.push({command:"z",points:[],start:void 0,pathLength:0})}return o}static calcLength(e,i,n,r){let o,s,a,l,c=t;switch(n){case"L":return c.getLineLength(e,i,r[0],r[1]);case"C":return(0,Mc.getCubicArcLength)([e,r[0],r[2],r[4]],[i,r[1],r[3],r[5]],1);case"Q":return(0,Mc.getQuadraticArcLength)([e,r[0],r[2]],[i,r[1],r[3]],1);case"A":o=0;let d=r[4],u=r[5],h=r[4]+u,p=Math.PI/180;if(Math.abs(d-h)<p&&(p=Math.abs(d-h)),s=c.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],d,0),u<0)for(l=d-p;l>h;l-=p)a=c.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],l,0),o+=c.getLineLength(s.x,s.y,a.x,a.y),s=a;else for(l=d+p;l<h;l+=p)a=c.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],l,0),o+=c.getLineLength(s.x,s.y,a.x,a.y),s=a;return a=c.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],h,0),o+=c.getLineLength(s.x,s.y,a.x,a.y),o}return 0}static convertEndpointToCenterParameterization(e,i,n,r,o,s,a,l,c){let d=c*(Math.PI/180),u=Math.cos(d)*(e-n)/2+Math.sin(d)*(i-r)/2,h=-1*Math.sin(d)*(e-n)/2+Math.cos(d)*(i-r)/2,p=u*u/(a*a)+h*h/(l*l);p>1&&(a*=Math.sqrt(p),l*=Math.sqrt(p));let f=Math.sqrt((a*a*(l*l)-a*a*(h*h)-l*l*(u*u))/(a*a*(h*h)+l*l*(u*u)));o===s&&(f*=-1),isNaN(f)&&(f=0);let g=f*a*h/l,m=f*-l*u/a,v=(e+n)/2+Math.cos(d)*g-Math.sin(d)*m,C=(i+r)/2+Math.sin(d)*g+Math.cos(d)*m,b=function(j){return Math.sqrt(j[0]*j[0]+j[1]*j[1])},S=function(j,q){return(j[0]*q[0]+j[1]*q[1])/(b(j)*b(q))},x=function(j,q){return(j[0]*q[1]<j[1]*q[0]?-1:1)*Math.acos(S(j,q))},E=x([1,0],[(u-g)/a,(h-m)/l]),P=[(u-g)/a,(h-m)/l],L=[(-1*u-g)/a,(-1*h-m)/l],B=x(P,L);return S(P,L)<=-1&&(B=Math.PI),S(P,L)>=1&&(B=0),s===0&&B>0&&(B=B-2*Math.PI),s===1&&B<0&&(B=B+2*Math.PI),[v,C,a,l,E,B,d,s]}};x0.Path=za;za.prototype.className="Path";za.prototype._attrsAffectingSize=["data"];(0,Nde._registerNode)(za);Lde.Factory.addGetterSetter(za,"data")});var PA=ce(R0=>{"use strict";Object.defineProperty(R0,"__esModule",{value:!0});R0.Arrow=void 0;var P0=Ne(),Hde=q2(),EA=We(),zde=Le(),xA=E0(),Ao=class extends Hde.Line{_sceneFunc(e){super._sceneFunc(e);let i=Math.PI*2,n=this.points(),r=n,o=this.tension()!==0&&n.length>4;o&&(r=this.getTensionPoints());let s=this.pointerLength(),a=n.length,l,c;if(o){let h=[r[r.length-4],r[r.length-3],r[r.length-2],r[r.length-1],n[a-2],n[a-1]],p=xA.Path.calcLength(r[r.length-4],r[r.length-3],"C",h),f=xA.Path.getPointOnQuadraticBezier(Math.min(1,1-s/p),h[0],h[1],h[2],h[3],h[4],h[5]);l=n[a-2]-f.x,c=n[a-1]-f.y}else l=n[a-2]-n[a-4],c=n[a-1]-n[a-3];let d=(Math.atan2(c,l)+i)%i,u=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(n[a-2],n[a-1]),e.rotate(d),e.moveTo(0,0),e.lineTo(-s,u/2),e.lineTo(-s,-u/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(n[0],n[1]),o?(l=(r[0]+r[2])/2-n[0],c=(r[1]+r[3])/2-n[1]):(l=n[2]-n[0],c=n[3]-n[1]),e.rotate((Math.atan2(-c,-l)+i)%i),e.moveTo(0,0),e.lineTo(-s,u/2),e.lineTo(-s,-u/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){let i=this.dashEnabled();i&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),i&&(this.attrs.dashEnabled=!0)}getSelfRect(){let e=super.getSelfRect(),i=this.pointerWidth()/2;return{x:e.x,y:e.y-i,width:e.width,height:e.height+i*2}}};R0.Arrow=Ao;Ao.prototype.className="Arrow";(0,zde._registerNode)(Ao);P0.Factory.addGetterSetter(Ao,"pointerLength",10,(0,EA.getNumberValidator)());P0.Factory.addGetterSetter(Ao,"pointerWidth",10,(0,EA.getNumberValidator)());P0.Factory.addGetterSetter(Ao,"pointerAtBeginning",!1);P0.Factory.addGetterSetter(Ao,"pointerAtEnding",!0)});var RA=ce(_0=>{"use strict";Object.defineProperty(_0,"__esModule",{value:!0});_0.Circle=void 0;var Vde=Ne(),Gde=$t(),Wde=We(),Ude=Le(),Ms=class extends Gde.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}};_0.Circle=Ms;Ms.prototype._centroid=!0;Ms.prototype.className="Circle";Ms.prototype._attrsAffectingSize=["radius"];(0,Ude._registerNode)(Ms);Vde.Factory.addGetterSetter(Ms,"radius",0,(0,Wde.getNumberValidator)())});var kA=ce(k0=>{"use strict";Object.defineProperty(k0,"__esModule",{value:!0});k0.Ellipse=void 0;var K2=Ne(),jde=$t(),_A=We(),qde=Le(),jr=class extends jde.Shape{_sceneFunc(e){let i=this.radiusX(),n=this.radiusY();e.beginPath(),e.save(),i!==n&&e.scale(1,n/i),e.arc(0,0,i,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}};k0.Ellipse=jr;jr.prototype.className="Ellipse";jr.prototype._centroid=!0;jr.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,qde._registerNode)(jr);K2.Factory.addComponentsGetterSetter(jr,"radius",["x","y"]);K2.Factory.addGetterSetter(jr,"radiusX",0,(0,_A.getNumberValidator)());K2.Factory.addGetterSetter(jr,"radiusY",0,(0,_A.getNumberValidator)())});var FA=ce(F0=>{"use strict";Object.defineProperty(F0,"__esModule",{value:!0});F0.Image=void 0;var Y2=Pt(),Va=Ne(),$de=$t(),Kde=Le(),zh=We(),Ln=class t extends $de.Shape{constructor(e){super(e),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",i=>{this._removeImageLoad(i.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){let e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener("load",this._loadListener)}_removeImageLoad(e){e&&e.removeEventListener&&e.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){let e=!!this.cornerRadius(),i=this.hasShadow();return e&&i?!0:super._useBufferCanvas(!0)}_sceneFunc(e){let i=this.getWidth(),n=this.getHeight(),r=this.cornerRadius(),o=this.attrs.image,s;if(o){let a=this.attrs.cropWidth,l=this.attrs.cropHeight;a&&l?s=[o,this.cropX(),this.cropY(),a,l,0,0,i,n]:s=[o,0,0,i,n]}(this.hasFill()||this.hasStroke()||r)&&(e.beginPath(),r?Y2.Util.drawRoundedRectPath(e,i,n,r):e.rect(0,0,i,n),e.closePath(),e.fillStrokeShape(this)),o&&(r&&e.clip(),e.drawImage.apply(e,s))}_hitFunc(e){let i=this.width(),n=this.height(),r=this.cornerRadius();e.beginPath(),r?Y2.Util.drawRoundedRectPath(e,i,n,r):e.rect(0,0,i,n),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,i;return(e=this.attrs.width)!==null&&e!==void 0?e:(i=this.image())===null||i===void 0?void 0:i.width}getHeight(){var e,i;return(e=this.attrs.height)!==null&&e!==void 0?e:(i=this.image())===null||i===void 0?void 0:i.height}static fromURL(e,i,n=null){let r=Y2.Util.createImageElement();r.onload=function(){let o=new t({image:r});i(o)},r.onerror=n,r.crossOrigin="Anonymous",r.src=e}};F0.Image=Ln;Ln.prototype.className="Image";(0,Kde._registerNode)(Ln);Va.Factory.addGetterSetter(Ln,"cornerRadius",0,(0,zh.getNumberOrArrayOfNumbersValidator)(4));Va.Factory.addGetterSetter(Ln,"image");Va.Factory.addComponentsGetterSetter(Ln,"crop",["x","y","width","height"]);Va.Factory.addGetterSetter(Ln,"cropX",0,(0,zh.getNumberValidator)());Va.Factory.addGetterSetter(Ln,"cropY",0,(0,zh.getNumberValidator)());Va.Factory.addGetterSetter(Ln,"cropWidth",0,(0,zh.getNumberValidator)());Va.Factory.addGetterSetter(Ln,"cropHeight",0,(0,zh.getNumberValidator)())});var MA=ce(Ic=>{"use strict";Object.defineProperty(Ic,"__esModule",{value:!0});Ic.Tag=Ic.Label=void 0;var T0=Ne(),Yde=$t(),Xde=Hh(),e3=We(),TA=Le(),DA=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],Jde="Change.konva",Qde="none",X2="up",J2="right",Q2="down",Z2="left",Zde=DA.length,Vh=class extends Xde.Group{constructor(e){super(e),this.on("add.konva",function(i){this._addListeners(i.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){let i=this,n,r=function(){i._sync()};for(n=0;n<Zde;n++)e.on(DA[n]+Jde,r)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let e=this.getText(),i=this.getTag(),n,r,o,s,a,l,c;if(e&&i){switch(n=e.width(),r=e.height(),o=i.pointerDirection(),s=i.pointerWidth(),c=i.pointerHeight(),a=0,l=0,o){case X2:a=n/2,l=-1*c;break;case J2:a=n+s,l=r/2;break;case Q2:a=n/2,l=r+c;break;case Z2:a=-1*s,l=r/2;break}i.setAttrs({x:-1*a,y:-1*l,width:n,height:r}),e.setAttrs({x:-1*a,y:-1*l})}}};Ic.Label=Vh;Vh.prototype.className="Label";(0,TA._registerNode)(Vh);var Oo=class extends Yde.Shape{_sceneFunc(e){let i=this.width(),n=this.height(),r=this.pointerDirection(),o=this.pointerWidth(),s=this.pointerHeight(),a=this.cornerRadius(),l=0,c=0,d=0,u=0;typeof a=="number"?l=c=d=u=Math.min(a,i/2,n/2):(l=Math.min(a[0]||0,i/2,n/2),c=Math.min(a[1]||0,i/2,n/2),u=Math.min(a[2]||0,i/2,n/2),d=Math.min(a[3]||0,i/2,n/2)),e.beginPath(),e.moveTo(l,0),r===X2&&(e.lineTo((i-o)/2,0),e.lineTo(i/2,-1*s),e.lineTo((i+o)/2,0)),e.lineTo(i-c,0),e.arc(i-c,c,c,Math.PI*3/2,0,!1),r===J2&&(e.lineTo(i,(n-s)/2),e.lineTo(i+o,n/2),e.lineTo(i,(n+s)/2)),e.lineTo(i,n-u),e.arc(i-u,n-u,u,0,Math.PI/2,!1),r===Q2&&(e.lineTo((i+o)/2,n),e.lineTo(i/2,n+s),e.lineTo((i-o)/2,n)),e.lineTo(d,n),e.arc(d,n-d,d,Math.PI/2,Math.PI,!1),r===Z2&&(e.lineTo(0,(n+s)/2),e.lineTo(-1*o,n/2),e.lineTo(0,(n-s)/2)),e.lineTo(0,l),e.arc(l,l,l,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){let e=0,i=0,n=this.pointerWidth(),r=this.pointerHeight(),o=this.pointerDirection(),s=this.width(),a=this.height();return o===X2?(i-=r,a+=r):o===Q2?a+=r:o===Z2?(e-=n*1.5,s+=n):o===J2&&(s+=n*1.5),{x:e,y:i,width:s,height:a}}};Ic.Tag=Oo;Oo.prototype.className="Tag";(0,TA._registerNode)(Oo);T0.Factory.addGetterSetter(Oo,"pointerDirection",Qde);T0.Factory.addGetterSetter(Oo,"pointerWidth",0,(0,e3.getNumberValidator)());T0.Factory.addGetterSetter(Oo,"pointerHeight",0,(0,e3.getNumberValidator)());T0.Factory.addGetterSetter(Oo,"cornerRadius",0,(0,e3.getNumberOrArrayOfNumbersValidator)(4))});var t3=ce(D0=>{"use strict";Object.defineProperty(D0,"__esModule",{value:!0});D0.Rect=void 0;var eue=Ne(),tue=$t(),iue=Le(),nue=Pt(),rue=We(),Ac=class extends tue.Shape{_sceneFunc(e){let i=this.cornerRadius(),n=this.width(),r=this.height();e.beginPath(),i?nue.Util.drawRoundedRectPath(e,n,r,i):e.rect(0,0,n,r),e.closePath(),e.fillStrokeShape(this)}};D0.Rect=Ac;Ac.prototype.className="Rect";(0,iue._registerNode)(Ac);eue.Factory.addGetterSetter(Ac,"cornerRadius",0,(0,rue.getNumberOrArrayOfNumbersValidator)(4))});var OA=ce(M0=>{"use strict";Object.defineProperty(M0,"__esModule",{value:!0});M0.RegularPolygon=void 0;var IA=Ne(),oue=$t(),AA=We(),sue=Le(),Lo=class extends oue.Shape{_sceneFunc(e){let i=this._getPoints();e.beginPath(),e.moveTo(i[0].x,i[0].y);for(let n=1;n<i.length;n++)e.lineTo(i[n].x,i[n].y);e.closePath(),e.fillStrokeShape(this)}_getPoints(){let e=this.attrs.sides,i=this.attrs.radius||0,n=[];for(let r=0;r<e;r++)n.push({x:i*Math.sin(r*2*Math.PI/e),y:-1*i*Math.cos(r*2*Math.PI/e)});return n}getSelfRect(){let e=this._getPoints(),i=e[0].x,n=e[0].y,r=e[0].x,o=e[0].y;return e.forEach(s=>{i=Math.min(i,s.x),n=Math.max(n,s.x),r=Math.min(r,s.y),o=Math.max(o,s.y)}),{x:i,y:r,width:n-i,height:o-r}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}};M0.RegularPolygon=Lo;Lo.prototype.className="RegularPolygon";Lo.prototype._centroid=!0;Lo.prototype._attrsAffectingSize=["radius"];(0,sue._registerNode)(Lo);IA.Factory.addGetterSetter(Lo,"radius",0,(0,AA.getNumberValidator)());IA.Factory.addGetterSetter(Lo,"sides",0,(0,AA.getNumberValidator)())});var HA=ce(I0=>{"use strict";Object.defineProperty(I0,"__esModule",{value:!0});I0.Ring=void 0;var NA=Ne(),aue=$t(),BA=We(),lue=Le(),LA=Math.PI*2,No=class extends aue.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,LA,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),LA,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}};I0.Ring=No;No.prototype.className="Ring";No.prototype._centroid=!0;No.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,lue._registerNode)(No);NA.Factory.addGetterSetter(No,"innerRadius",0,(0,BA.getNumberValidator)());NA.Factory.addGetterSetter(No,"outerRadius",0,(0,BA.getNumberValidator)())});var i3=ce(A0=>{"use strict";Object.defineProperty(A0,"__esModule",{value:!0});A0.Sprite=void 0;var Ga=Ne(),cue=$t(),due=v0(),zA=We(),uue=Le(),Nn=class extends cue.Shape{constructor(e){super(e),this._updated=!0,this.anim=new due.Animation(()=>{let i=this._updated;return this._updated=!1,i}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){let i=this.animation(),n=this.frameIndex(),r=n*4,o=this.animations()[i],s=this.frameOffsets(),a=o[r+0],l=o[r+1],c=o[r+2],d=o[r+3],u=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,c,d),e.closePath(),e.fillStrokeShape(this)),u)if(s){let h=s[i],p=n*2;e.drawImage(u,a,l,c,d,h[p+0],h[p+1],c,d)}else e.drawImage(u,a,l,c,d,0,0,c,d)}_hitFunc(e){let i=this.animation(),n=this.frameIndex(),r=n*4,o=this.animations()[i],s=this.frameOffsets(),a=o[r+2],l=o[r+3];if(e.beginPath(),s){let c=s[i],d=n*2;e.rect(c[d+0],c[d+1],a,l)}else e.rect(0,0,a,l);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){let e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;let e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){let e=this.frameIndex(),i=this.animation(),n=this.animations(),r=n[i],o=r.length/4;e<o-1?this.frameIndex(e+1):this.frameIndex(0)}};A0.Sprite=Nn;Nn.prototype.className="Sprite";(0,uue._registerNode)(Nn);Ga.Factory.addGetterSetter(Nn,"animation");Ga.Factory.addGetterSetter(Nn,"animations");Ga.Factory.addGetterSetter(Nn,"frameOffsets");Ga.Factory.addGetterSetter(Nn,"image");Ga.Factory.addGetterSetter(Nn,"frameIndex",0,(0,zA.getNumberValidator)());Ga.Factory.addGetterSetter(Nn,"frameRate",17,(0,zA.getNumberValidator)());Ga.Factory.backCompat(Nn,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"})});var VA=ce(O0=>{"use strict";Object.defineProperty(O0,"__esModule",{value:!0});O0.Star=void 0;var n3=Ne(),hue=$t(),r3=We(),pue=Le(),qr=class extends hue.Shape{_sceneFunc(e){let i=this.innerRadius(),n=this.outerRadius(),r=this.numPoints();e.beginPath(),e.moveTo(0,0-n);for(let o=1;o<r*2;o++){let s=o%2===0?n:i,a=s*Math.sin(o*Math.PI/r),l=-1*s*Math.cos(o*Math.PI/r);e.lineTo(a,l)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}};O0.Star=qr;qr.prototype.className="Star";qr.prototype._centroid=!0;qr.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,pue._registerNode)(qr);n3.Factory.addGetterSetter(qr,"numPoints",5,(0,r3.getNumberValidator)());n3.Factory.addGetterSetter(qr,"innerRadius",0,(0,r3.getNumberValidator)());n3.Factory.addGetterSetter(qr,"outerRadius",0,(0,r3.getNumberValidator)())});var c3=ce(Wh=>{"use strict";Object.defineProperty(Wh,"__esModule",{value:!0});Wh.Text=void 0;Wh.stringToArray=Wa;var l3=Pt(),Mi=Ne(),fue=$t(),o3=Le(),Is=We(),gue=Le();function Wa(t){return[...t].reduce((e,i,n,r)=>{if(new RegExp("\\p{Emoji}","u").test(i)){let o=r[n+1];o&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(o)?(e.push(i+o),r[n+1]=""):e.push(i)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(i+(r[n+1]||""))?e.push(i+r[n+1]):n>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(i)?e[e.length-1]+=i:i&&e.push(i);return e},[])}var Oc="auto",mue="center",qA="inherit",Gh="justify",vue="Change.konva",Cue="2d",GA="-",$A="left",wue="text",bue="Text",yue="top",Sue="bottom",WA="middle",KA="normal",xue="px ",L0=" ",Eue="right",UA="rtl",Pue="word",Rue="char",jA="none",s3="\u2026",YA=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],_ue=YA.length;function kue(t){return t.split(",").map(e=>{e=e.trim();let i=e.indexOf(" ")>=0,n=e.indexOf('"')>=0||e.indexOf("'")>=0;return i&&!n&&(e=`"${e}"`),e}).join(", ")}var N0;function a3(){return N0||(N0=l3.Util.createCanvasElement().getContext(Cue),N0)}function Fue(t){t.fillText(this._partialText,this._partialTextX,this._partialTextY)}function Tue(t){t.setAttr("miterLimit",2),t.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function Due(t){return t=t||{},!t.fillLinearGradientColorStops&&!t.fillRadialGradientColorStops&&!t.fillPatternImage&&(t.fill=t.fill||"black"),t}var xt=class extends fue.Shape{constructor(e){super(Due(e)),this._partialTextX=0,this._partialTextY=0;for(let i=0;i<_ue;i++)this.on(YA[i]+vue,this._setTextData);this._setTextData()}_sceneFunc(e){let i=this.textArr,n=i.length;if(!this.text())return;let r=this.padding(),o=this.fontSize(),s=this.lineHeight()*o,a=this.verticalAlign(),l=this.direction(),c=0,d=this.align(),u=this.getWidth(),h=this.letterSpacing(),p=this.fill(),f=this.textDecoration(),g=f.indexOf("underline")!==-1,m=f.indexOf("line-through")!==-1,v;l=l===qA?e.direction:l;let C=s/2,b=WA;if(o3.Konva._fixTextRendering){let S=this.measureSize("M");b="alphabetic",C=(S.fontBoundingBoxAscent-S.fontBoundingBoxDescent)/2+s/2}for(l===UA&&e.setAttr("direction",l),e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",b),e.setAttr("textAlign",$A),a===WA?c=(this.getHeight()-n*s-r*2)/2:a===Sue&&(c=this.getHeight()-n*s-r*2),e.translate(r,c+r),v=0;v<n;v++){let S=0,x=0,E=i[v],P=E.text,L=E.width,B=E.lastInParagraph;if(e.save(),d===Eue?S+=u-L-r*2:d===mue&&(S+=(u-L-r*2)/2),g){e.save(),e.beginPath();let j=o3.Konva._fixTextRendering?Math.round(o/4):Math.round(o/2),q=S,Y=C+x+j;e.moveTo(q,Y);let he=d===Gh&&!B?u-r*2:L;e.lineTo(q+Math.round(he),Y),e.lineWidth=o/15;let Se=this._getLinearGradient();e.strokeStyle=Se||p,e.stroke(),e.restore()}if(m){e.save(),e.beginPath();let j=o3.Konva._fixTextRendering?-Math.round(o/4):0;e.moveTo(S,C+x+j);let q=d===Gh&&!B?u-r*2:L;e.lineTo(S+Math.round(q),C+x+j),e.lineWidth=o/15;let Y=this._getLinearGradient();e.strokeStyle=Y||p,e.stroke(),e.restore()}if(l!==UA&&(h!==0||d===Gh)){let j=P.split(" ").length-1,q=Wa(P);for(let Y=0;Y<q.length;Y++){let he=q[Y];he===" "&&!B&&d===Gh&&(S+=(u-r*2-L)/j),this._partialTextX=S,this._partialTextY=C+x,this._partialText=he,e.fillStrokeShape(this),S+=this.measureSize(he).width+h}}else h!==0&&e.setAttr("letterSpacing",`${h}px`),this._partialTextX=S,this._partialTextY=C+x,this._partialText=P,e.fillStrokeShape(this);e.restore(),n>1&&(C+=s)}}_hitFunc(e){let i=this.getWidth(),n=this.getHeight();e.beginPath(),e.rect(0,0,i,n),e.closePath(),e.fillStrokeShape(this)}setText(e){let i=l3.Util._isString(e)?e:e==null?"":e+"";return this._setAttr(wue,i),this}getWidth(){return this.attrs.width===Oc||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===Oc||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return l3.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var i,n,r,o,s,a,l,c,d,u,h;let p=a3(),f=this.fontSize(),g;p.save(),p.font=this._getContextFont(),g=p.measureText(e),p.restore();let m=f/100;return{actualBoundingBoxAscent:(i=g.actualBoundingBoxAscent)!==null&&i!==void 0?i:71.58203125*m,actualBoundingBoxDescent:(n=g.actualBoundingBoxDescent)!==null&&n!==void 0?n:0,actualBoundingBoxLeft:(r=g.actualBoundingBoxLeft)!==null&&r!==void 0?r:-7.421875*m,actualBoundingBoxRight:(o=g.actualBoundingBoxRight)!==null&&o!==void 0?o:75.732421875*m,alphabeticBaseline:(s=g.alphabeticBaseline)!==null&&s!==void 0?s:0,emHeightAscent:(a=g.emHeightAscent)!==null&&a!==void 0?a:100*m,emHeightDescent:(l=g.emHeightDescent)!==null&&l!==void 0?l:-20*m,fontBoundingBoxAscent:(c=g.fontBoundingBoxAscent)!==null&&c!==void 0?c:91*m,fontBoundingBoxDescent:(d=g.fontBoundingBoxDescent)!==null&&d!==void 0?d:21*m,hangingBaseline:(u=g.hangingBaseline)!==null&&u!==void 0?u:72.80000305175781*m,ideographicBaseline:(h=g.ideographicBaseline)!==null&&h!==void 0?h:-21*m,width:g.width,height:f}}_getContextFont(){return this.fontStyle()+L0+this.fontVariant()+L0+(this.fontSize()+xue)+kue(this.fontFamily())}_addTextLine(e){this.align()===Gh&&(e=e.trim());let n=this._getTextWidth(e);return this.textArr.push({text:e,width:n,lastInParagraph:!1})}_getTextWidth(e){let i=this.letterSpacing(),n=e.length;return a3().measureText(e).width+i*n}_setTextData(){let e=this.text().split(`
`),i=+this.fontSize(),n=0,r=this.lineHeight()*i,o=this.attrs.width,s=this.attrs.height,a=o!==Oc&&o!==void 0,l=s!==Oc&&s!==void 0,c=this.padding(),d=o-c*2,u=s-c*2,h=0,p=this.wrap(),f=p!==jA,g=p!==Rue&&f,m=this.ellipsis();this.textArr=[],a3().font=this._getContextFont();let v=m?this._getTextWidth(s3):0;for(let C=0,b=e.length;C<b;++C){let S=e[C],x=this._getTextWidth(S);if(a&&x>d)for(;S.length>0;){let E=0,P=Wa(S).length,L="",B=0;for(;E<P;){let j=E+P>>>1,q=Wa(S),Y=q.slice(0,j+1).join(""),he=this._getTextWidth(Y);(m&&l&&h+r>u?he+v:he)<=d?(E=j+1,L=Y,B=he):P=j}if(L){if(g){let Y=Wa(S),he=Wa(L),Se=Y[he.length],be=Se===L0||Se===GA,T;if(be&&B<=d)T=he.length;else{let R=he.lastIndexOf(L0),_=he.lastIndexOf(GA);T=Math.max(R,_)+1}T>0&&(E=T,L=Y.slice(0,E).join(""),B=this._getTextWidth(L))}if(L=L.trimRight(),this._addTextLine(L),n=Math.max(n,B),h+=r,this._shouldHandleEllipsis(h)){this._tryToAddEllipsisToLastLine();break}if(S=Wa(S).slice(E).join("").trimLeft(),S.length>0&&(x=this._getTextWidth(S),x<=d)){this._addTextLine(S),h+=r,n=Math.max(n,x);break}}else break}else this._addTextLine(S),h+=r,n=Math.max(n,x),this._shouldHandleEllipsis(h)&&C<b-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),l&&h+r>u)break}this.textHeight=i,this.textWidth=n}_shouldHandleEllipsis(e){let i=+this.fontSize(),n=this.lineHeight()*i,r=this.attrs.height,o=r!==Oc&&r!==void 0,s=this.padding(),a=r-s*2;return!(this.wrap()!==jA)||o&&e+n>a}_tryToAddEllipsisToLastLine(){let e=this.attrs.width,i=e!==Oc&&e!==void 0,n=this.padding(),r=e-n*2,o=this.ellipsis(),s=this.textArr[this.textArr.length-1];!s||!o||(i&&(this._getTextWidth(s.text+s3)<r||(s.text=s.text.slice(0,s.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(s.text+s3))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){let e=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,i=this.hasShadow();return e&&i?!0:super._useBufferCanvas()}};Wh.Text=xt;xt.prototype._fillFunc=Fue;xt.prototype._strokeFunc=Tue;xt.prototype.className=bue;xt.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,gue._registerNode)(xt);Mi.Factory.overWriteSetter(xt,"width",(0,Is.getNumberOrAutoValidator)());Mi.Factory.overWriteSetter(xt,"height",(0,Is.getNumberOrAutoValidator)());Mi.Factory.addGetterSetter(xt,"direction",qA);Mi.Factory.addGetterSetter(xt,"fontFamily","Arial");Mi.Factory.addGetterSetter(xt,"fontSize",12,(0,Is.getNumberValidator)());Mi.Factory.addGetterSetter(xt,"fontStyle",KA);Mi.Factory.addGetterSetter(xt,"fontVariant",KA);Mi.Factory.addGetterSetter(xt,"padding",0,(0,Is.getNumberValidator)());Mi.Factory.addGetterSetter(xt,"align",$A);Mi.Factory.addGetterSetter(xt,"verticalAlign",yue);Mi.Factory.addGetterSetter(xt,"lineHeight",1,(0,Is.getNumberValidator)());Mi.Factory.addGetterSetter(xt,"wrap",Pue);Mi.Factory.addGetterSetter(xt,"ellipsis",!1,(0,Is.getBooleanValidator)());Mi.Factory.addGetterSetter(xt,"letterSpacing",0,(0,Is.getNumberValidator)());Mi.Factory.addGetterSetter(xt,"text","",(0,Is.getStringValidator)());Mi.Factory.addGetterSetter(xt,"textDecoration","")});var e7=ce(B0=>{"use strict";Object.defineProperty(B0,"__esModule",{value:!0});B0.TextPath=void 0;var d3=Pt(),rr=Ne(),Mue=$t(),Uh=E0(),u3=c3(),XA=We(),Iue=Le(),Aue="",JA="normal";function QA(t){t.fillText(this.partialText,0,0)}function ZA(t){t.strokeText(this.partialText,0,0)}var zt=class extends Mue.Shape{constructor(e){super(e),this.dummyCanvas=d3.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return Uh.Path.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;let i=this.pathLength;return e-1>i?null:Uh.Path.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=Uh.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();let i=this.textDecoration(),n=this.fill(),r=this.fontSize(),o=this.glyphInfo;i==="underline"&&e.beginPath();for(let s=0;s<o.length;s++){e.save();let a=o[s].p0;e.translate(a.x,a.y),e.rotate(o[s].rotation),this.partialText=o[s].text,e.fillStrokeShape(this),i==="underline"&&(s===0&&e.moveTo(0,r/2+1),e.lineTo(r,r/2+1)),e.restore()}i==="underline"&&(e.strokeStyle=n,e.lineWidth=r/20,e.stroke()),e.restore()}_hitFunc(e){e.beginPath();let i=this.glyphInfo;if(i.length>=1){let n=i[0].p0;e.moveTo(n.x,n.y)}for(let n=0;n<i.length;n++){let r=i[n].p1;e.lineTo(r.x,r.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return d3.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return u3.Text.prototype.setText.call(this,e)}_getContextFont(){return u3.Text.prototype._getContextFont.call(this)}_getTextSize(e){let n=this.dummyCanvas.getContext("2d");n.save(),n.font=this._getContextFont();let r=n.measureText(e);return n.restore(),{width:r.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){let{width:e,height:i}=this._getTextSize(this.attrs.text);if(this.textWidth=e,this.textHeight=i,this.glyphInfo=[],!this.attrs.data)return null;let n=this.letterSpacing(),r=this.align(),o=this.kerningFunc(),s=Math.max(this.textWidth+((this.attrs.text||"").length-1)*n,0),a=0;r==="center"&&(a=Math.max(0,this.pathLength/2-s/2)),r==="right"&&(a=Math.max(0,this.pathLength-s));let l=(0,u3.stringToArray)(this.text()),c=a;for(let d=0;d<l.length;d++){let u=this._getPointAtLength(c);if(!u)return;let h=this._getTextSize(l[d]).width+n;if(l[d]===" "&&r==="justify"){let C=this.text().split(" ").length-1;h+=(this.pathLength-s)/C}let p=this._getPointAtLength(c+h);if(!p)return;let f=Uh.Path.getLineLength(u.x,u.y,p.x,p.y),g=0;if(o)try{g=o(l[d-1],l[d])*this.fontSize()}catch{g=0}u.x+=g,p.x+=g,this.textWidth+=g;let m=Uh.Path.getPointOnLine(g+f/2,u.x,u.y,p.x,p.y),v=Math.atan2(p.y-u.y,p.x-u.x);this.glyphInfo.push({transposeX:m.x,transposeY:m.y,text:l[d],rotation:v,p0:u,p1:p}),c+=h}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};let e=[];this.glyphInfo.forEach(function(c){e.push(c.p0.x),e.push(c.p0.y),e.push(c.p1.x),e.push(c.p1.y)});let i=e[0]||0,n=e[0]||0,r=e[1]||0,o=e[1]||0,s,a;for(let c=0;c<e.length/2;c++)s=e[c*2],a=e[c*2+1],i=Math.min(i,s),n=Math.max(n,s),r=Math.min(r,a),o=Math.max(o,a);let l=this.fontSize();return{x:i-l/2,y:r-l/2,width:n-i+l,height:o-r+l}}destroy(){return d3.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};B0.TextPath=zt;zt.prototype._fillFunc=QA;zt.prototype._strokeFunc=ZA;zt.prototype._fillFuncHit=QA;zt.prototype._strokeFuncHit=ZA;zt.prototype.className="TextPath";zt.prototype._attrsAffectingSize=["text","fontSize","data"];(0,Iue._registerNode)(zt);rr.Factory.addGetterSetter(zt,"data");rr.Factory.addGetterSetter(zt,"fontFamily","Arial");rr.Factory.addGetterSetter(zt,"fontSize",12,(0,XA.getNumberValidator)());rr.Factory.addGetterSetter(zt,"fontStyle",JA);rr.Factory.addGetterSetter(zt,"align","left");rr.Factory.addGetterSetter(zt,"letterSpacing",0,(0,XA.getNumberValidator)());rr.Factory.addGetterSetter(zt,"textBaseline","middle");rr.Factory.addGetterSetter(zt,"fontVariant",JA);rr.Factory.addGetterSetter(zt,"text",Aue);rr.Factory.addGetterSetter(zt,"textDecoration","");rr.Factory.addGetterSetter(zt,"kerningFunc",void 0)});var a7=ce(z0=>{"use strict";Object.defineProperty(z0,"__esModule",{value:!0});z0.Transformer=void 0;var ut=Pt(),tt=Ne(),t7=Dt(),Oue=$t(),Lue=t3(),i7=Hh(),or=Le(),As=We(),Nue=Le(),o7="tr-konva",Bue=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(t=>t+`.${o7}`).join(" "),n7="nodesRect",Hue=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],zue={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},Vue="ontouchstart"in or.Konva._global;function Gue(t,e,i){if(t==="rotater")return i;e+=ut.Util.degToRad(zue[t]||0);let n=(ut.Util.radToDeg(e)%360+360)%360;return ut.Util._inRange(n,315+22.5,360)||ut.Util._inRange(n,0,22.5)?"ns-resize":ut.Util._inRange(n,45-22.5,45+22.5)?"nesw-resize":ut.Util._inRange(n,90-22.5,90+22.5)?"ew-resize":ut.Util._inRange(n,135-22.5,135+22.5)?"nwse-resize":ut.Util._inRange(n,180-22.5,180+22.5)?"ns-resize":ut.Util._inRange(n,225-22.5,225+22.5)?"nesw-resize":ut.Util._inRange(n,270-22.5,270+22.5)?"ew-resize":ut.Util._inRange(n,315-22.5,315+22.5)?"nwse-resize":(ut.Util.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}var H0=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],r7=1e8;function Wue(t){return{x:t.x+t.width/2*Math.cos(t.rotation)+t.height/2*Math.sin(-t.rotation),y:t.y+t.height/2*Math.cos(t.rotation)+t.width/2*Math.sin(t.rotation)}}function s7(t,e,i){let n=i.x+(t.x-i.x)*Math.cos(e)-(t.y-i.y)*Math.sin(e),r=i.y+(t.x-i.x)*Math.sin(e)+(t.y-i.y)*Math.cos(e);return k(w({},t),{rotation:t.rotation+e,x:n,y:r})}function Uue(t,e){let i=Wue(t);return s7(t,e,i)}function jue(t,e,i){let n=e;for(let r=0;r<t.length;r++){let o=or.Konva.getAngle(t[r]),s=Math.abs(o-e)%(Math.PI*2);Math.min(s,Math.PI*2-s)<i&&(n=o)}return n}var h3=0,Ue=class extends i7.Group{constructor(e){super(e),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(Bue,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return ut.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return o7+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach();let i=e.filter(r=>r.isAncestorOf(this)?(ut.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=e=i,e.length===1&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(r=>{let o=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(r._attrsAffectingSize.length){let s=r._attrsAffectingSize.map(a=>a+"Change."+this._getEventNamespace()).join(" ");r.on(s,o)}r.on(Hue.map(s=>s+`.${this._getEventNamespace()}`).join(" "),o),r.on(`absoluteTransformChange.${this._getEventNamespace()}`,o),this._proxyDrag(r)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(e){let i;e.on(`dragstart.${this._getEventNamespace()}`,n=>{i=e.getAbsolutePosition(),!this.isDragging()&&e!==this.findOne(".back")&&this.startDrag(n,!1)}),e.on(`dragmove.${this._getEventNamespace()}`,n=>{if(!i)return;let r=e.getAbsolutePosition(),o=r.x-i.x,s=r.y-i.y;this.nodes().forEach(a=>{if(a===e||a.isDragging())return;let l=a.getAbsolutePosition();a.setAbsolutePosition({x:l.x+o,y:l.y+s}),a.startDrag(n)}),i=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(e=>{e.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(n7),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(n7,this.__getNodeRect)}__getNodeShape(e,i=this.rotation(),n){let r=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),o=e.getAbsoluteScale(n),s=e.getAbsolutePosition(n),a=r.x*o.x-e.offsetX()*o.x,l=r.y*o.y-e.offsetY()*o.y,c=(or.Konva.getAngle(e.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),d={x:s.x+a*Math.cos(c)+l*Math.sin(-c),y:s.y+l*Math.cos(c)+a*Math.sin(c),width:r.width*o.x,height:r.height*o.y,rotation:c};return s7(d,-or.Konva.getAngle(i),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-r7,y:-r7,width:0,height:0,rotation:0};let i=[];this.nodes().map(c=>{let d=c.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),u=[{x:d.x,y:d.y},{x:d.x+d.width,y:d.y},{x:d.x+d.width,y:d.y+d.height},{x:d.x,y:d.y+d.height}],h=c.getAbsoluteTransform();u.forEach(function(p){let f=h.point(p);i.push(f)})});let n=new ut.Transform;n.rotate(-or.Konva.getAngle(this.rotation()));let r=1/0,o=1/0,s=-1/0,a=-1/0;i.forEach(function(c){let d=n.point(c);r===void 0&&(r=s=d.x,o=a=d.y),r=Math.min(r,d.x),o=Math.min(o,d.y),s=Math.max(s,d.x),a=Math.max(a,d.y)}),n.invert();let l=n.point({x:r,y:o});return{x:l.x,y:l.y,width:s-r,height:a-o,rotation:or.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),H0.forEach(e=>{this._createAnchor(e)}),this._createAnchor("rotater")}_createAnchor(e){let i=new Lue.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:Vue?10:"auto"}),n=this;i.on("mousedown touchstart",function(r){n._handleMouseDown(r)}),i.on("dragstart",r=>{i.stopDrag(),r.cancelBubble=!0}),i.on("dragend",r=>{r.cancelBubble=!0}),i.on("mouseenter",()=>{let r=or.Konva.getAngle(this.rotation()),o=this.rotateAnchorCursor(),s=Gue(e,r,o);i.getStage().content&&(i.getStage().content.style.cursor=s),this._cursorChange=!0}),i.on("mouseout",()=>{i.getStage().content&&(i.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(i)}_createBack(){let e=new Oue.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(i,n){let r=n.getParent(),o=r.padding();i.beginPath(),i.rect(-o,-o,n.width()+o*2,n.height()+o*2),i.moveTo(n.width()/2,-o),r.rotateEnabled()&&r.rotateLineVisible()&&i.lineTo(n.width()/2,-r.rotateAnchorOffset()*ut.Util._sign(n.height())-o),i.fillStrokeShape(n)},hitFunc:(i,n)=>{if(!this.shouldOverdrawWholeArea())return;let r=this.padding();i.beginPath(),i.rect(-r,-r,n.width()+r*2,n.height()+r*2),i.fillStrokeShape(n)}});this.add(e),this._proxyDrag(e),e.on("dragstart",i=>{i.cancelBubble=!0}),e.on("dragmove",i=>{i.cancelBubble=!0}),e.on("dragend",i=>{i.cancelBubble=!0}),this.on("dragmove",i=>{this.update()})}_handleMouseDown(e){if(this._transforming)return;this._movingAnchorName=e.target.name().split(" ")[0];let i=this._getNodeRect(),n=i.width,r=i.height,o=Math.sqrt(Math.pow(n,2)+Math.pow(r,2));this.sin=Math.abs(r/o),this.cos=Math.abs(n/o),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;let s=e.target.getAbsolutePosition(),a=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:a.x-s.x,y:a.y-s.y},h3++,this._fire("transformstart",{evt:e.evt,target:this.getNode()}),this._nodes.forEach(l=>{l._fire("transformstart",{evt:e.evt,target:l})})}_handleMouseMove(e){let i,n,r,o=this.findOne("."+this._movingAnchorName),s=o.getStage();s.setPointersPositions(e);let a=s.getPointerPosition(),l={x:a.x-this._anchorDragOffset.x,y:a.y-this._anchorDragOffset.y},c=o.getAbsolutePosition();this.anchorDragBoundFunc()&&(l=this.anchorDragBoundFunc()(c,l,e)),o.setAbsolutePosition(l);let d=o.getAbsolutePosition();if(c.x===d.x&&c.y===d.y)return;if(this._movingAnchorName==="rotater"){let C=this._getNodeRect();i=o.x()-C.width/2,n=-o.y()+C.height/2;let b=Math.atan2(-n,i)+Math.PI/2;C.height<0&&(b-=Math.PI);let x=or.Konva.getAngle(this.rotation())+b,E=or.Konva.getAngle(this.rotationSnapTolerance()),L=jue(this.rotationSnaps(),x,E)-C.rotation,B=Uue(C,L);this._fitNodesInto(B,e);return}let u=this.shiftBehavior(),h;u==="inverted"?h=this.keepRatio()&&!e.shiftKey:u==="none"?h=this.keepRatio():h=this.keepRatio()||e.shiftKey;let p=this.centeredScaling()||e.altKey;if(this._movingAnchorName==="top-left"){if(h){let C=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};r=Math.sqrt(Math.pow(C.x-o.x(),2)+Math.pow(C.y-o.y(),2));let b=this.findOne(".top-left").x()>C.x?-1:1,S=this.findOne(".top-left").y()>C.y?-1:1;i=r*this.cos*b,n=r*this.sin*S,this.findOne(".top-left").x(C.x-i),this.findOne(".top-left").y(C.y-n)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(o.y());else if(this._movingAnchorName==="top-right"){if(h){let C=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};r=Math.sqrt(Math.pow(o.x()-C.x,2)+Math.pow(C.y-o.y(),2));let b=this.findOne(".top-right").x()<C.x?-1:1,S=this.findOne(".top-right").y()>C.y?-1:1;i=r*this.cos*b,n=r*this.sin*S,this.findOne(".top-right").x(C.x+i),this.findOne(".top-right").y(C.y-n)}var f=o.position();this.findOne(".top-left").y(f.y),this.findOne(".bottom-right").x(f.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(o.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(o.x());else if(this._movingAnchorName==="bottom-left"){if(h){let C=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};r=Math.sqrt(Math.pow(C.x-o.x(),2)+Math.pow(o.y()-C.y,2));let b=C.x<o.x()?-1:1,S=o.y()<C.y?-1:1;i=r*this.cos*b,n=r*this.sin*S,o.x(C.x-i),o.y(C.y+n)}f=o.position(),this.findOne(".top-left").x(f.x),this.findOne(".bottom-right").y(f.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(o.y());else if(this._movingAnchorName==="bottom-right"){if(h){let C=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};r=Math.sqrt(Math.pow(o.x()-C.x,2)+Math.pow(o.y()-C.y,2));let b=this.findOne(".bottom-right").x()<C.x?-1:1,S=this.findOne(".bottom-right").y()<C.y?-1:1;i=r*this.cos*b,n=r*this.sin*S,this.findOne(".bottom-right").x(C.x+i),this.findOne(".bottom-right").y(C.y+n)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(p=this.centeredScaling()||e.altKey,p){let C=this.findOne(".top-left"),b=this.findOne(".bottom-right"),S=C.x(),x=C.y(),E=this.getWidth()-b.x(),P=this.getHeight()-b.y();b.move({x:-S,y:-x}),C.move({x:E,y:P})}let g=this.findOne(".top-left").getAbsolutePosition();i=g.x,n=g.y;let m=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),v=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:i,y:n,width:m,height:v,rotation:or.Konva.getAngle(this.rotation())},e)}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){var i;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));let n=this.getNode();h3--,this._fire("transformend",{evt:e,target:n}),(i=this.getLayer())===null||i===void 0||i.batchDraw(),n&&this._nodes.forEach(r=>{var o;r._fire("transformend",{evt:e,target:r}),(o=r.getLayer())===null||o===void 0||o.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(e,i){let n=this._getNodeRect(),r=1;if(ut.Util._inRange(e.width,-this.padding()*2-r,r)){this.update();return}if(ut.Util._inRange(e.height,-this.padding()*2-r,r)){this.update();return}let o=new ut.Transform;if(o.rotate(or.Konva.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){let h=o.point({x:-this.padding()*2,y:0});e.x+=h.x,e.y+=h.y,e.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){let h=o.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,e.width+=this.padding()*2}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){let h=o.point({x:0,y:-this.padding()*2});e.x+=h.x,e.y+=h.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,e.height+=this.padding()*2}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){let h=o.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,e.height+=this.padding()*2}if(this.boundBoxFunc()){let h=this.boundBoxFunc()(n,e);h?e=h:ut.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}let s=1e7,a=new ut.Transform;a.translate(n.x,n.y),a.rotate(n.rotation),a.scale(n.width/s,n.height/s);let l=new ut.Transform,c=e.width/s,d=e.height/s;this.flipEnabled()===!1?(l.translate(e.x,e.y),l.rotate(e.rotation),l.translate(e.width<0?e.width:0,e.height<0?e.height:0),l.scale(Math.abs(c),Math.abs(d))):(l.translate(e.x,e.y),l.rotate(e.rotation),l.scale(c,d));let u=l.multiply(a.invert());this._nodes.forEach(h=>{var p;let f=h.getParent().getAbsoluteTransform(),g=h.getTransform().copy();g.translate(h.offsetX(),h.offsetY());let m=new ut.Transform;m.multiply(f.copy().invert()).multiply(u).multiply(f).multiply(g);let v=m.decompose();h.setAttrs(v),(p=h.getLayer())===null||p===void 0||p.batchDraw()}),this.rotation(ut.Util._getRotation(e.rotation)),this._nodes.forEach(h=>{this._fire("transform",{evt:i,target:h}),h._fire("transform",{evt:i,target:h})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,i){this.findOne(e).setAttrs(i)}update(){var e;let i=this._getNodeRect();this.rotation(ut.Util._getRotation(i.rotation));let n=i.width,r=i.height,o=this.enabledAnchors(),s=this.resizeEnabled(),a=this.padding(),l=this.anchorSize(),c=this.find("._anchor");c.forEach(u=>{u.setAttrs({width:l,height:l,offsetX:l/2,offsetY:l/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:l/2+a,offsetY:l/2+a,visible:s&&o.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:n/2,y:0,offsetY:l/2+a,visible:s&&o.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:n,y:0,offsetX:l/2-a,offsetY:l/2+a,visible:s&&o.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:r/2,offsetX:l/2+a,visible:s&&o.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:n,y:r/2,offsetX:l/2-a,visible:s&&o.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:r,offsetX:l/2+a,offsetY:l/2-a,visible:s&&o.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:n/2,y:r,offsetY:l/2-a,visible:s&&o.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:n,y:r,offsetX:l/2-a,offsetY:l/2-a,visible:s&&o.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:n/2,y:-this.rotateAnchorOffset()*ut.Util._sign(r)-a,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:n,height:r,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});let d=this.anchorStyleFunc();d&&c.forEach(u=>{d(u)}),(e=this.getLayer())===null||e===void 0||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();let e=this.findOne("."+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),i7.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return t7.Node.prototype.toObject.call(this)}clone(e){return t7.Node.prototype.clone.call(this,e)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};z0.Transformer=Ue;Ue.isTransforming=()=>h3>0;function que(t){return t instanceof Array||ut.Util.warn("enabledAnchors value should be an array"),t instanceof Array&&t.forEach(function(e){H0.indexOf(e)===-1&&ut.Util.warn("Unknown anchor name: "+e+". Available names are: "+H0.join(", "))}),t||[]}Ue.prototype.className="Transformer";(0,Nue._registerNode)(Ue);tt.Factory.addGetterSetter(Ue,"enabledAnchors",H0,que);tt.Factory.addGetterSetter(Ue,"flipEnabled",!0,(0,As.getBooleanValidator)());tt.Factory.addGetterSetter(Ue,"resizeEnabled",!0);tt.Factory.addGetterSetter(Ue,"anchorSize",10,(0,As.getNumberValidator)());tt.Factory.addGetterSetter(Ue,"rotateEnabled",!0);tt.Factory.addGetterSetter(Ue,"rotateLineVisible",!0);tt.Factory.addGetterSetter(Ue,"rotationSnaps",[]);tt.Factory.addGetterSetter(Ue,"rotateAnchorOffset",50,(0,As.getNumberValidator)());tt.Factory.addGetterSetter(Ue,"rotateAnchorCursor","crosshair");tt.Factory.addGetterSetter(Ue,"rotationSnapTolerance",5,(0,As.getNumberValidator)());tt.Factory.addGetterSetter(Ue,"borderEnabled",!0);tt.Factory.addGetterSetter(Ue,"anchorStroke","rgb(0, 161, 255)");tt.Factory.addGetterSetter(Ue,"anchorStrokeWidth",1,(0,As.getNumberValidator)());tt.Factory.addGetterSetter(Ue,"anchorFill","white");tt.Factory.addGetterSetter(Ue,"anchorCornerRadius",0,(0,As.getNumberValidator)());tt.Factory.addGetterSetter(Ue,"borderStroke","rgb(0, 161, 255)");tt.Factory.addGetterSetter(Ue,"borderStrokeWidth",1,(0,As.getNumberValidator)());tt.Factory.addGetterSetter(Ue,"borderDash");tt.Factory.addGetterSetter(Ue,"keepRatio",!0);tt.Factory.addGetterSetter(Ue,"shiftBehavior","default");tt.Factory.addGetterSetter(Ue,"centeredScaling",!1);tt.Factory.addGetterSetter(Ue,"ignoreStroke",!1);tt.Factory.addGetterSetter(Ue,"padding",0,(0,As.getNumberValidator)());tt.Factory.addGetterSetter(Ue,"nodes");tt.Factory.addGetterSetter(Ue,"node");tt.Factory.addGetterSetter(Ue,"boundBoxFunc");tt.Factory.addGetterSetter(Ue,"anchorDragBoundFunc");tt.Factory.addGetterSetter(Ue,"anchorStyleFunc");tt.Factory.addGetterSetter(Ue,"shouldOverdrawWholeArea",!1);tt.Factory.addGetterSetter(Ue,"useSingleNodeRotation",!0);tt.Factory.backCompat(Ue,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"})});var c7=ce(G0=>{"use strict";Object.defineProperty(G0,"__esModule",{value:!0});G0.Wedge=void 0;var V0=Ne(),$ue=$t(),Kue=Le(),l7=We(),Yue=Le(),sr=class extends $ue.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,Kue.Konva.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}};G0.Wedge=sr;sr.prototype.className="Wedge";sr.prototype._centroid=!0;sr.prototype._attrsAffectingSize=["radius"];(0,Yue._registerNode)(sr);V0.Factory.addGetterSetter(sr,"radius",0,(0,l7.getNumberValidator)());V0.Factory.addGetterSetter(sr,"angle",0,(0,l7.getNumberValidator)());V0.Factory.addGetterSetter(sr,"clockwise",!1);V0.Factory.backCompat(sr,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"})});var h7=ce(W0=>{"use strict";Object.defineProperty(W0,"__esModule",{value:!0});W0.Blur=void 0;var d7=Ne(),Xue=Dt(),Jue=We();function u7(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var Que=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],Zue=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function ehe(t,e){let i=t.data,n=t.width,r=t.height,o,s,a,l,c,d,u,h,p,f,g,m,v,C,b,S,x,E,P,L,B=e+e+1,j=n-1,q=r-1,Y=e+1,he=Y*(Y+1)/2,Se=new u7,be=Que[e],T=Zue[e],R=null,_=Se,z=null,G=null;for(let U=1;U<B;U++)_=_.next=new u7,U===Y&&(R=_);_.next=Se,a=s=0;for(let U=0;U<r;U++){m=v=C=b=l=c=d=u=0,h=Y*(S=i[s]),p=Y*(x=i[s+1]),f=Y*(E=i[s+2]),g=Y*(P=i[s+3]),l+=he*S,c+=he*x,d+=he*E,u+=he*P,_=Se;for(let N=0;N<Y;N++)_.r=S,_.g=x,_.b=E,_.a=P,_=_.next;for(let N=1;N<Y;N++)o=s+((j<N?j:N)<<2),l+=(_.r=S=i[o])*(L=Y-N),c+=(_.g=x=i[o+1])*L,d+=(_.b=E=i[o+2])*L,u+=(_.a=P=i[o+3])*L,m+=S,v+=x,C+=E,b+=P,_=_.next;z=Se,G=R;for(let N=0;N<n;N++)i[s+3]=P=u*be>>T,P!==0?(P=255/P,i[s]=(l*be>>T)*P,i[s+1]=(c*be>>T)*P,i[s+2]=(d*be>>T)*P):i[s]=i[s+1]=i[s+2]=0,l-=h,c-=p,d-=f,u-=g,h-=z.r,p-=z.g,f-=z.b,g-=z.a,o=a+((o=N+e+1)<j?o:j)<<2,m+=z.r=i[o],v+=z.g=i[o+1],C+=z.b=i[o+2],b+=z.a=i[o+3],l+=m,c+=v,d+=C,u+=b,z=z.next,h+=S=G.r,p+=x=G.g,f+=E=G.b,g+=P=G.a,m-=S,v-=x,C-=E,b-=P,G=G.next,s+=4;a+=n}for(let U=0;U<n;U++){v=C=b=m=c=d=u=l=0,s=U<<2,h=Y*(S=i[s]),p=Y*(x=i[s+1]),f=Y*(E=i[s+2]),g=Y*(P=i[s+3]),l+=he*S,c+=he*x,d+=he*E,u+=he*P,_=Se;for(let I=0;I<Y;I++)_.r=S,_.g=x,_.b=E,_.a=P,_=_.next;let N=n;for(let I=1;I<=e;I++)s=N+U<<2,l+=(_.r=S=i[s])*(L=Y-I),c+=(_.g=x=i[s+1])*L,d+=(_.b=E=i[s+2])*L,u+=(_.a=P=i[s+3])*L,m+=S,v+=x,C+=E,b+=P,_=_.next,I<q&&(N+=n);s=U,z=Se,G=R;for(let I=0;I<r;I++)o=s<<2,i[o+3]=P=u*be>>T,P>0?(P=255/P,i[o]=(l*be>>T)*P,i[o+1]=(c*be>>T)*P,i[o+2]=(d*be>>T)*P):i[o]=i[o+1]=i[o+2]=0,l-=h,c-=p,d-=f,u-=g,h-=z.r,p-=z.g,f-=z.b,g-=z.a,o=U+((o=I+Y)<q?o:q)*n<<2,l+=m+=z.r=i[o],c+=v+=z.g=i[o+1],d+=C+=z.b=i[o+2],u+=b+=z.a=i[o+3],z=z.next,h+=S=G.r,p+=x=G.g,f+=E=G.b,g+=P=G.a,m-=S,v-=x,C-=E,b-=P,G=G.next,s+=n}}var the=function(e){let i=Math.round(this.blurRadius());i>0&&ehe(e,i)};W0.Blur=the;d7.Factory.addGetterSetter(Xue.Node,"blurRadius",0,(0,Jue.getNumberValidator)(),d7.Factory.afterSetFilter)});var f7=ce(U0=>{"use strict";Object.defineProperty(U0,"__esModule",{value:!0});U0.Brighten=void 0;var p7=Ne(),ihe=Dt(),nhe=We(),rhe=function(t){let e=this.brightness()*255,i=t.data,n=i.length;for(let r=0;r<n;r+=4)i[r]+=e,i[r+1]+=e,i[r+2]+=e};U0.Brighten=rhe;p7.Factory.addGetterSetter(ihe.Node,"brightness",0,(0,nhe.getNumberValidator)(),p7.Factory.afterSetFilter)});var m7=ce(j0=>{"use strict";Object.defineProperty(j0,"__esModule",{value:!0});j0.Contrast=void 0;var g7=Ne(),ohe=Dt(),she=We(),ahe=function(t){let e=Math.pow((this.contrast()+100)/100,2),i=t.data,n=i.length,r=150,o=150,s=150;for(let a=0;a<n;a+=4)r=i[a],o=i[a+1],s=i[a+2],r/=255,r-=.5,r*=e,r+=.5,r*=255,o/=255,o-=.5,o*=e,o+=.5,o*=255,s/=255,s-=.5,s*=e,s+=.5,s*=255,r=r<0?0:r>255?255:r,o=o<0?0:o>255?255:o,s=s<0?0:s>255?255:s,i[a]=r,i[a+1]=o,i[a+2]=s};j0.Contrast=ahe;g7.Factory.addGetterSetter(ohe.Node,"contrast",0,(0,she.getNumberValidator)(),g7.Factory.afterSetFilter)});var C7=ce($0=>{"use strict";Object.defineProperty($0,"__esModule",{value:!0});$0.Emboss=void 0;var Os=Ne(),q0=Dt(),lhe=Pt(),v7=We(),che=function(t){let e=this.embossStrength()*10,i=this.embossWhiteLevel()*255,n=this.embossDirection(),r=this.embossBlend(),o=t.data,s=t.width,a=t.height,l=s*4,c=0,d=0,u=a;switch(n){case"top-left":c=-1,d=-1;break;case"top":c=-1,d=0;break;case"top-right":c=-1,d=1;break;case"right":c=0,d=1;break;case"bottom-right":c=1,d=1;break;case"bottom":c=1,d=0;break;case"bottom-left":c=1,d=-1;break;case"left":c=0,d=-1;break;default:lhe.Util.error("Unknown emboss direction: "+n)}do{let h=(u-1)*l,p=c;u+p<1&&(p=0),u+p>a&&(p=0);let f=(u-1+p)*s*4,g=s;do{let m=h+(g-1)*4,v=d;g+v<1&&(v=0),g+v>s&&(v=0);let C=f+(g-1+v)*4,b=o[m]-o[C],S=o[m+1]-o[C+1],x=o[m+2]-o[C+2],E=b,P=E>0?E:-E,L=S>0?S:-S,B=x>0?x:-x;if(L>P&&(E=S),B>P&&(E=x),E*=e,r){let j=o[m]+E,q=o[m+1]+E,Y=o[m+2]+E;o[m]=j>255?255:j<0?0:j,o[m+1]=q>255?255:q<0?0:q,o[m+2]=Y>255?255:Y<0?0:Y}else{let j=i-E;j<0?j=0:j>255&&(j=255),o[m]=o[m+1]=o[m+2]=j}}while(--g)}while(--u)};$0.Emboss=che;Os.Factory.addGetterSetter(q0.Node,"embossStrength",.5,(0,v7.getNumberValidator)(),Os.Factory.afterSetFilter);Os.Factory.addGetterSetter(q0.Node,"embossWhiteLevel",.5,(0,v7.getNumberValidator)(),Os.Factory.afterSetFilter);Os.Factory.addGetterSetter(q0.Node,"embossDirection","top-left",void 0,Os.Factory.afterSetFilter);Os.Factory.addGetterSetter(q0.Node,"embossBlend",!1,void 0,Os.Factory.afterSetFilter)});var b7=ce(K0=>{"use strict";Object.defineProperty(K0,"__esModule",{value:!0});K0.Enhance=void 0;var w7=Ne(),dhe=Dt(),uhe=We();function p3(t,e,i,n,r){let o=i-e,s=r-n;if(o===0)return n+s/2;if(s===0)return n;let a=(t-e)/o;return a=s*a+n,a}var hhe=function(t){let e=t.data,i=e.length,n=e[0],r=n,o,s=e[1],a=s,l,c=e[2],d=c,u,h=this.enhance();if(h===0)return;for(let b=0;b<i;b+=4)o=e[b+0],o<n?n=o:o>r&&(r=o),l=e[b+1],l<s?s=l:l>a&&(a=l),u=e[b+2],u<c?c=u:u>d&&(d=u);r===n&&(r=255,n=0),a===s&&(a=255,s=0),d===c&&(d=255,c=0);let p,f,g,m,v,C;if(h>0)p=r+h*(255-r),f=n-h*(n-0),g=a+h*(255-a),m=s-h*(s-0),v=d+h*(255-d),C=c-h*(c-0);else{let b=(r+n)*.5;p=r+h*(r-b),f=n+h*(n-b);let S=(a+s)*.5;g=a+h*(a-S),m=s+h*(s-S);let x=(d+c)*.5;v=d+h*(d-x),C=c+h*(c-x)}for(let b=0;b<i;b+=4)e[b+0]=p3(e[b+0],n,r,f,p),e[b+1]=p3(e[b+1],s,a,m,g),e[b+2]=p3(e[b+2],c,d,C,v)};K0.Enhance=hhe;w7.Factory.addGetterSetter(dhe.Node,"enhance",0,(0,uhe.getNumberValidator)(),w7.Factory.afterSetFilter)});var y7=ce(Y0=>{"use strict";Object.defineProperty(Y0,"__esModule",{value:!0});Y0.Grayscale=void 0;var phe=function(t){let e=t.data,i=e.length;for(let n=0;n<i;n+=4){let r=.34*e[n]+.5*e[n+1]+.16*e[n+2];e[n]=r,e[n+1]=r,e[n+2]=r}};Y0.Grayscale=phe});var S7=ce(X0=>{"use strict";Object.defineProperty(X0,"__esModule",{value:!0});X0.HSL=void 0;var Lc=Ne(),f3=Dt(),g3=We();Lc.Factory.addGetterSetter(f3.Node,"hue",0,(0,g3.getNumberValidator)(),Lc.Factory.afterSetFilter);Lc.Factory.addGetterSetter(f3.Node,"saturation",0,(0,g3.getNumberValidator)(),Lc.Factory.afterSetFilter);Lc.Factory.addGetterSetter(f3.Node,"luminance",0,(0,g3.getNumberValidator)(),Lc.Factory.afterSetFilter);var fhe=function(t){let e=t.data,i=e.length,n=1,r=Math.pow(2,this.saturation()),o=Math.abs(this.hue()+360)%360,s=this.luminance()*127,a=n*r*Math.cos(o*Math.PI/180),l=n*r*Math.sin(o*Math.PI/180),c=.299*n+.701*a+.167*l,d=.587*n-.587*a+.33*l,u=.114*n-.114*a-.497*l,h=.299*n-.299*a-.328*l,p=.587*n+.413*a+.035*l,f=.114*n-.114*a+.293*l,g=.299*n-.3*a+1.25*l,m=.587*n-.586*a-1.05*l,v=.114*n+.886*a-.2*l,C,b,S,x;for(let E=0;E<i;E+=4)C=e[E+0],b=e[E+1],S=e[E+2],x=e[E+3],e[E+0]=c*C+d*b+u*S+s,e[E+1]=h*C+p*b+f*S+s,e[E+2]=g*C+m*b+v*S+s,e[E+3]=x};X0.HSL=fhe});var x7=ce(J0=>{"use strict";Object.defineProperty(J0,"__esModule",{value:!0});J0.HSV=void 0;var Nc=Ne(),m3=Dt(),v3=We(),ghe=function(t){let e=t.data,i=e.length,n=Math.pow(2,this.value()),r=Math.pow(2,this.saturation()),o=Math.abs(this.hue()+360)%360,s=n*r*Math.cos(o*Math.PI/180),a=n*r*Math.sin(o*Math.PI/180),l=.299*n+.701*s+.167*a,c=.587*n-.587*s+.33*a,d=.114*n-.114*s-.497*a,u=.299*n-.299*s-.328*a,h=.587*n+.413*s+.035*a,p=.114*n-.114*s+.293*a,f=.299*n-.3*s+1.25*a,g=.587*n-.586*s-1.05*a,m=.114*n+.886*s-.2*a;for(let v=0;v<i;v+=4){let C=e[v+0],b=e[v+1],S=e[v+2],x=e[v+3];e[v+0]=l*C+c*b+d*S,e[v+1]=u*C+h*b+p*S,e[v+2]=f*C+g*b+m*S,e[v+3]=x}};J0.HSV=ghe;Nc.Factory.addGetterSetter(m3.Node,"hue",0,(0,v3.getNumberValidator)(),Nc.Factory.afterSetFilter);Nc.Factory.addGetterSetter(m3.Node,"saturation",0,(0,v3.getNumberValidator)(),Nc.Factory.afterSetFilter);Nc.Factory.addGetterSetter(m3.Node,"value",0,(0,v3.getNumberValidator)(),Nc.Factory.afterSetFilter)});var E7=ce(Q0=>{"use strict";Object.defineProperty(Q0,"__esModule",{value:!0});Q0.Invert=void 0;var mhe=function(t){let e=t.data,i=e.length;for(let n=0;n<i;n+=4)e[n]=255-e[n],e[n+1]=255-e[n+1],e[n+2]=255-e[n+2]};Q0.Invert=mhe});var k7=ce(ev=>{"use strict";Object.defineProperty(ev,"__esModule",{value:!0});ev.Kaleidoscope=void 0;var Z0=Ne(),R7=Dt(),P7=Pt(),_7=We(),vhe=function(t,e,i){let n=t.data,r=e.data,o=t.width,s=t.height,a=i.polarCenterX||o/2,l=i.polarCenterY||s/2,c=Math.sqrt(a*a+l*l),d=o-a,u=s-l,h=Math.sqrt(d*d+u*u);c=h>c?h:c;let p=s,f=o,g=360/f*Math.PI/180;for(let m=0;m<f;m+=1){let v=Math.sin(m*g),C=Math.cos(m*g);for(let b=0;b<p;b+=1){d=Math.floor(a+c*b/p*C),u=Math.floor(l+c*b/p*v);let S=(u*o+d)*4,x=n[S+0],E=n[S+1],P=n[S+2],L=n[S+3];S=(m+b*o)*4,r[S+0]=x,r[S+1]=E,r[S+2]=P,r[S+3]=L}}},Che=function(t,e,i){let n=t.data,r=e.data,o=t.width,s=t.height,a=i.polarCenterX||o/2,l=i.polarCenterY||s/2,c=Math.sqrt(a*a+l*l),d=o-a,u=s-l,h=Math.sqrt(d*d+u*u);c=h>c?h:c;let p=s,f=o,g=i.polarRotation||0,m,v;for(d=0;d<o;d+=1)for(u=0;u<s;u+=1){let C=d-a,b=u-l,S=Math.sqrt(C*C+b*b)*p/c,x=(Math.atan2(b,C)*180/Math.PI+360+g)%360;x=x*f/360,m=Math.floor(x),v=Math.floor(S);let E=(v*o+m)*4,P=n[E+0],L=n[E+1],B=n[E+2],j=n[E+3];E=(u*o+d)*4,r[E+0]=P,r[E+1]=L,r[E+2]=B,r[E+3]=j}},whe=function(t){let e=t.width,i=t.height,n,r,o,s,a,l,c,d,u,h,p=Math.round(this.kaleidoscopePower()),f=Math.round(this.kaleidoscopeAngle()),g=Math.floor(e*(f%360)/360);if(p<1)return;let m=P7.Util.createCanvasElement();m.width=e,m.height=i;let v=m.getContext("2d").getImageData(0,0,e,i);P7.Util.releaseCanvas(m),vhe(t,v,{polarCenterX:e/2,polarCenterY:i/2});let C=e/Math.pow(2,p);for(;C<=8;)C=C*2,p-=1;C=Math.ceil(C);let b=C,S=0,x=b,E=1;for(g+C>e&&(S=b,x=0,E=-1),r=0;r<i;r+=1)for(n=S;n!==x;n+=E)o=Math.round(n+g)%e,u=(e*r+o)*4,a=v.data[u+0],l=v.data[u+1],c=v.data[u+2],d=v.data[u+3],h=(e*r+n)*4,v.data[h+0]=a,v.data[h+1]=l,v.data[h+2]=c,v.data[h+3]=d;for(r=0;r<i;r+=1)for(b=Math.floor(C),s=0;s<p;s+=1){for(n=0;n<b+1;n+=1)u=(e*r+n)*4,a=v.data[u+0],l=v.data[u+1],c=v.data[u+2],d=v.data[u+3],h=(e*r+b*2-n-1)*4,v.data[h+0]=a,v.data[h+1]=l,v.data[h+2]=c,v.data[h+3]=d;b*=2}Che(v,t,{polarRotation:0})};ev.Kaleidoscope=whe;Z0.Factory.addGetterSetter(R7.Node,"kaleidoscopePower",2,(0,_7.getNumberValidator)(),Z0.Factory.afterSetFilter);Z0.Factory.addGetterSetter(R7.Node,"kaleidoscopeAngle",0,(0,_7.getNumberValidator)(),Z0.Factory.afterSetFilter)});var T7=ce(iv=>{"use strict";Object.defineProperty(iv,"__esModule",{value:!0});iv.Mask=void 0;var F7=Ne(),bhe=Dt(),yhe=We();function tv(t,e,i){let n=(i*t.width+e)*4,r=[];return r.push(t.data[n++],t.data[n++],t.data[n++],t.data[n++]),r}function jh(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}function She(t){let e=[0,0,0];for(let i=0;i<t.length;i++)e[0]+=t[i][0],e[1]+=t[i][1],e[2]+=t[i][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}function xhe(t,e){let i=tv(t,0,0),n=tv(t,t.width-1,0),r=tv(t,0,t.height-1),o=tv(t,t.width-1,t.height-1),s=e||10;if(jh(i,n)<s&&jh(n,o)<s&&jh(o,r)<s&&jh(r,i)<s){let a=She([n,i,o,r]),l=[];for(let c=0;c<t.width*t.height;c++){let d=jh(a,[t.data[c*4],t.data[c*4+1],t.data[c*4+2]]);l[c]=d<s?0:255}return l}}function Ehe(t,e){for(let i=0;i<t.width*t.height;i++)t.data[4*i+3]=e[i]}function Phe(t,e,i){let n=[1,1,1,1,0,1,1,1,1],r=Math.round(Math.sqrt(n.length)),o=Math.floor(r/2),s=[];for(let a=0;a<i;a++)for(let l=0;l<e;l++){let c=a*e+l,d=0;for(let u=0;u<r;u++)for(let h=0;h<r;h++){let p=a+u-o,f=l+h-o;if(p>=0&&p<i&&f>=0&&f<e){let g=p*e+f,m=n[u*r+h];d+=t[g]*m}}s[c]=d===2040?255:0}return s}function Rhe(t,e,i){let n=[1,1,1,1,1,1,1,1,1],r=Math.round(Math.sqrt(n.length)),o=Math.floor(r/2),s=[];for(let a=0;a<i;a++)for(let l=0;l<e;l++){let c=a*e+l,d=0;for(let u=0;u<r;u++)for(let h=0;h<r;h++){let p=a+u-o,f=l+h-o;if(p>=0&&p<i&&f>=0&&f<e){let g=p*e+f,m=n[u*r+h];d+=t[g]*m}}s[c]=d>=1020?255:0}return s}function _he(t,e,i){let n=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],r=Math.round(Math.sqrt(n.length)),o=Math.floor(r/2),s=[];for(let a=0;a<i;a++)for(let l=0;l<e;l++){let c=a*e+l,d=0;for(let u=0;u<r;u++)for(let h=0;h<r;h++){let p=a+u-o,f=l+h-o;if(p>=0&&p<i&&f>=0&&f<e){let g=p*e+f,m=n[u*r+h];d+=t[g]*m}}s[c]=d}return s}var khe=function(t){let e=this.threshold(),i=xhe(t,e);return i&&(i=Phe(i,t.width,t.height),i=Rhe(i,t.width,t.height),i=_he(i,t.width,t.height),Ehe(t,i)),t};iv.Mask=khe;F7.Factory.addGetterSetter(bhe.Node,"threshold",0,(0,yhe.getNumberValidator)(),F7.Factory.afterSetFilter)});var M7=ce(nv=>{"use strict";Object.defineProperty(nv,"__esModule",{value:!0});nv.Noise=void 0;var D7=Ne(),Fhe=Dt(),The=We(),Dhe=function(t){let e=this.noise()*255,i=t.data,n=i.length,r=e/2;for(let o=0;o<n;o+=4)i[o+0]+=r-2*r*Math.random(),i[o+1]+=r-2*r*Math.random(),i[o+2]+=r-2*r*Math.random()};nv.Noise=Dhe;D7.Factory.addGetterSetter(Fhe.Node,"noise",.2,(0,The.getNumberValidator)(),D7.Factory.afterSetFilter)});var A7=ce(rv=>{"use strict";Object.defineProperty(rv,"__esModule",{value:!0});rv.Pixelate=void 0;var I7=Ne(),Mhe=Pt(),Ihe=Dt(),Ahe=We(),Ohe=function(t){let e=Math.ceil(this.pixelSize()),i=t.width,n=t.height,r=Math.ceil(i/e),o=Math.ceil(n/e),s=t.data;if(e<=0){Mhe.Util.error("pixelSize value can not be <= 0");return}for(let a=0;a<r;a+=1)for(let l=0;l<o;l+=1){let c=0,d=0,u=0,h=0,p=a*e,f=p+e,g=l*e,m=g+e,v=0;for(let C=p;C<f;C+=1)if(!(C>=i))for(let b=g;b<m;b+=1){if(b>=n)continue;let S=(i*b+C)*4;c+=s[S+0],d+=s[S+1],u+=s[S+2],h+=s[S+3],v+=1}c=c/v,d=d/v,u=u/v,h=h/v;for(let C=p;C<f;C+=1)if(!(C>=i))for(let b=g;b<m;b+=1){if(b>=n)continue;let S=(i*b+C)*4;s[S+0]=c,s[S+1]=d,s[S+2]=u,s[S+3]=h}}};rv.Pixelate=Ohe;I7.Factory.addGetterSetter(Ihe.Node,"pixelSize",8,(0,Ahe.getNumberValidator)(),I7.Factory.afterSetFilter)});var L7=ce(ov=>{"use strict";Object.defineProperty(ov,"__esModule",{value:!0});ov.Posterize=void 0;var O7=Ne(),Lhe=Dt(),Nhe=We(),Bhe=function(t){let e=Math.round(this.levels()*254)+1,i=t.data,n=i.length,r=255/e;for(let o=0;o<n;o+=1)i[o]=Math.floor(i[o]/r)*r};ov.Posterize=Bhe;O7.Factory.addGetterSetter(Lhe.Node,"levels",.5,(0,Nhe.getNumberValidator)(),O7.Factory.afterSetFilter)});var N7=ce(av=>{"use strict";Object.defineProperty(av,"__esModule",{value:!0});av.RGB=void 0;var sv=Ne(),C3=Dt(),Hhe=We(),zhe=function(t){let e=t.data,i=e.length,n=this.red(),r=this.green(),o=this.blue();for(let s=0;s<i;s+=4){let a=(.34*e[s]+.5*e[s+1]+.16*e[s+2])/255;e[s]=a*n,e[s+1]=a*r,e[s+2]=a*o,e[s+3]=e[s+3]}};av.RGB=zhe;sv.Factory.addGetterSetter(C3.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});sv.Factory.addGetterSetter(C3.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});sv.Factory.addGetterSetter(C3.Node,"blue",0,Hhe.RGBComponent,sv.Factory.afterSetFilter)});var B7=ce(cv=>{"use strict";Object.defineProperty(cv,"__esModule",{value:!0});cv.RGBA=void 0;var qh=Ne(),lv=Dt(),Vhe=We(),Ghe=function(t){let e=t.data,i=e.length,n=this.red(),r=this.green(),o=this.blue(),s=this.alpha();for(let a=0;a<i;a+=4){let l=1-s;e[a]=n*s+e[a]*l,e[a+1]=r*s+e[a+1]*l,e[a+2]=o*s+e[a+2]*l}};cv.RGBA=Ghe;qh.Factory.addGetterSetter(lv.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});qh.Factory.addGetterSetter(lv.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});qh.Factory.addGetterSetter(lv.Node,"blue",0,Vhe.RGBComponent,qh.Factory.afterSetFilter);qh.Factory.addGetterSetter(lv.Node,"alpha",1,function(t){return this._filterUpToDate=!1,t>1?1:t<0?0:t})});var H7=ce(dv=>{"use strict";Object.defineProperty(dv,"__esModule",{value:!0});dv.Sepia=void 0;var Whe=function(t){let e=t.data,i=e.length;for(let n=0;n<i;n+=4){let r=e[n+0],o=e[n+1],s=e[n+2];e[n+0]=Math.min(255,r*.393+o*.769+s*.189),e[n+1]=Math.min(255,r*.349+o*.686+s*.168),e[n+2]=Math.min(255,r*.272+o*.534+s*.131)}};dv.Sepia=Whe});var z7=ce(uv=>{"use strict";Object.defineProperty(uv,"__esModule",{value:!0});uv.Solarize=void 0;var Uhe=function(t){let e=t.data,i=t.width,n=t.height,r=i*4,o=n;do{let s=(o-1)*r,a=i;do{let l=s+(a-1)*4,c=e[l],d=e[l+1],u=e[l+2];c>127&&(c=255-c),d>127&&(d=255-d),u>127&&(u=255-u),e[l]=c,e[l+1]=d,e[l+2]=u}while(--a)}while(--o)};uv.Solarize=Uhe});var G7=ce(hv=>{"use strict";Object.defineProperty(hv,"__esModule",{value:!0});hv.Threshold=void 0;var V7=Ne(),jhe=Dt(),qhe=We(),$he=function(t){let e=this.threshold()*255,i=t.data,n=i.length;for(let r=0;r<n;r+=1)i[r]=i[r]<e?0:255};hv.Threshold=$he;V7.Factory.addGetterSetter(jhe.Node,"threshold",.5,(0,qhe.getNumberValidator)(),V7.Factory.afterSetFilter)});var j7=ce(pv=>{"use strict";Object.defineProperty(pv,"__esModule",{value:!0});pv.Konva=void 0;var W7=vA(),Khe=wA(),Yhe=PA(),Xhe=RA(),Jhe=kA(),Qhe=FA(),U7=MA(),Zhe=q2(),epe=E0(),tpe=t3(),ipe=OA(),npe=HA(),rpe=i3(),ope=VA(),spe=c3(),ape=e7(),lpe=a7(),cpe=c7(),dpe=h7(),upe=f7(),hpe=m7(),ppe=C7(),fpe=b7(),gpe=y7(),mpe=S7(),vpe=x7(),Cpe=E7(),wpe=k7(),bpe=T7(),ype=M7(),Spe=A7(),xpe=L7(),Epe=N7(),Ppe=B7(),Rpe=H7(),_pe=z7(),kpe=G7();pv.Konva=W7.Konva.Util._assign(W7.Konva,{Arc:Khe.Arc,Arrow:Yhe.Arrow,Circle:Xhe.Circle,Ellipse:Jhe.Ellipse,Image:Qhe.Image,Label:U7.Label,Tag:U7.Tag,Line:Zhe.Line,Path:epe.Path,Rect:tpe.Rect,RegularPolygon:ipe.RegularPolygon,Ring:npe.Ring,Sprite:rpe.Sprite,Star:ope.Star,Text:spe.Text,TextPath:ape.TextPath,Transformer:lpe.Transformer,Wedge:cpe.Wedge,Filters:{Blur:dpe.Blur,Brighten:upe.Brighten,Contrast:hpe.Contrast,Emboss:ppe.Emboss,Enhance:fpe.Enhance,Grayscale:gpe.Grayscale,HSL:mpe.HSL,HSV:vpe.HSV,Invert:Cpe.Invert,Kaleidoscope:wpe.Kaleidoscope,Mask:bpe.Mask,Noise:ype.Noise,Pixelate:Spe.Pixelate,Posterize:xpe.Posterize,RGB:Epe.RGB,RGBA:Ppe.RGBA,Sepia:Rpe.Sepia,Solarize:_pe.Solarize,Threshold:kpe.Threshold}})});var K7=ce((q7,$7)=>{"use strict";Object.defineProperty(q7,"__esModule",{value:!0});var Fpe=j7();$7.exports=Fpe.Konva});var xC=nt(cd(),1);function al(t,e){return Object.hasOwn(t,e)}var nL=/^data:([^/]+\/[^,;]+(?:[^,]*?))(;base64)?,([\s\S]*)$/;function rL(t,e,i){let n=nL.exec(t),r=e.mimeType??n?.[1]??"plain/text",o;if(n?.[2]!=null){let s=atob(decodeURIComponent(n[3])),a=new Uint8Array(s.length);for(let l=0;l<s.length;l++)a[l]=s.charCodeAt(l);o=[a]}else n?.[3]!=null&&(o=[decodeURIComponent(n[3])]);return i?new File(o,e.name||"",{type:r}):new Blob(o,{type:r})}var Vv=rL;function dd(t,e,i,n){return i===0||t===e?t:n===0?e:t+(e-t)*2**(-n/i)}var ud=['a[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','area[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])',"input:not([disabled]):not([inert]):not([aria-hidden])","select:not([disabled]):not([inert]):not([aria-hidden])","textarea:not([disabled]):not([inert]):not([aria-hidden])","button:not([disabled]):not([inert]):not([aria-hidden])",'iframe:not([tabindex^="-"]):not([inert]):not([aria-hidden])','object:not([tabindex^="-"]):not([inert]):not([aria-hidden])','embed:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[contenteditable]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[tabindex]:not([tabindex^="-"]):not([inert]):not([aria-hidden])'];var Gv=class extends Error{cause;isNetworkError;request;constructor(e,i=null){super("This looks like a network error, the endpoint might be blocked by an internet provider or a firewall."),this.cause=e,this.isNetworkError=!0,this.request=i}},Wv=Gv;function Uv(t){let e=i=>"error"in i&&!!i.error;return t.filter(i=>!e(i))}function jv(t){return t.filter(e=>!e.progress?.uploadStarted||!e.isRestored)}function hd(t){return typeof t!="object"||t===null||!("nodeType"in t)?!1:t.nodeType===Node.ELEMENT_NODE}function oL(t){if(typeof t=="string"){let e=document.querySelectorAll(t);return e.length===0?null:Array.from(e)}return typeof t=="object"&&hd(t)?[t]:null}var bp=oL;function sL(t,e=document){return typeof t=="string"?e.querySelector(t):hd(t)?t:null}var qv=sL;function Yn(t){let e=t.lastIndexOf(".");return e===-1||e===t.length-1?{name:t,extension:void 0}:{name:t.slice(0,e),extension:t.slice(e+1)}}var $v={__proto__:null,md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",webp:"image/webp",gif:"image/gif",heic:"image/heic",heif:"image/heif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",dicom:"application/dicom",doc:"application/msword",msg:"application/vnd.ms-outlook",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel",txt:"text/plain",text:"text/plain",conf:"text/plain",log:"text/plain",pdf:"application/pdf",zip:"application/zip","7z":"application/x-7z-compressed",rar:"application/x-rar-compressed",tar:"application/x-tar",gz:"application/gzip",dmg:"application/x-apple-diskimage"};function ll(t){if(t.type)return t.type;let e=t.name?Yn(t.name).extension?.toLowerCase():null;return e&&e in $v?$v[e]:"application/octet-stream"}function aL(t){return t.charCodeAt(0).toString(32)}function vE(t){let e="";return t.replace(/[^A-Z0-9]/gi,i=>(e+=`-${aL(i)}`,"/"))+e}function Kv(t,e){let i=e||"uppy";return typeof t.name=="string"&&(i+=`-${vE(t.name.toLowerCase())}`),t.type!==void 0&&(i+=`-${t.type}`),t.meta&&typeof t.meta.relativePath=="string"&&(i+=`-${vE(t.meta.relativePath.toLowerCase())}`),t.data.size!==void 0&&(i+=`-${t.data.size}`),t.data.lastModified!==void 0&&(i+=`-${t.data.lastModified}`),i}function lL(t){return!t.isRemote||!t.remote?!1:new Set(["box","dropbox","drive","facebook","unsplash"]).has(t.remote.provider)}function pd(t,e){if(lL(t))return t.id;let i=ll(t);return Kv(k(w({},t),{type:i}),e)}function yp(t,e){return t===!0?Object.keys(e):Array.isArray(t)?t:[]}var Qr=Array.from;function Yv(t){let e=Qr(t.files);return Promise.resolve(e)}function Sp(t,e,i,{onSuccess:n}){t.readEntries(r=>{let o=[...e,...r];r.length?queueMicrotask(()=>{Sp(t,o,i,{onSuccess:n})}):n(o)},r=>{i(r),n(e)})}function CE(t,e){return t==null?t:{kind:t.isFile?"file":t.isDirectory?"directory":void 0,name:t.name,getFile(){return new Promise((i,n)=>t.file(i,n))},async*values(){let i=t.createReader();yield*await new Promise(r=>{Sp(i,[],e,{onSuccess:o=>r(o.map(s=>CE(s,e)))})})},isSameEntry:void 0}}async function*wE(t,e,i=void 0){let n=()=>`${e}/${t.name}`;if(t.kind==="file"){let r=await t.getFile();r!=null?(r.relativePath=e?n():null,yield r):i!=null&&(yield i)}else if(t.kind==="directory")for await(let r of t.values())yield*wE(r,e?n():t.name);else i!=null&&(yield i)}async function*Xv(t,e){let i=await Promise.all(Array.from(t.items,async n=>{let r;return r??=CE(typeof n.getAsEntry=="function"?n.getAsEntry():n.webkitGetAsEntry(),e),{fileSystemHandle:r,lastResortFile:n.getAsFile()}}));for(let{lastResortFile:n,fileSystemHandle:r}of i)if(r!=null)try{yield*wE(r,"",n)}catch(o){n!=null?yield n:e(o)}else n!=null&&(yield n)}async function xp(t,e){let i=e?.logDropError??Function.prototype;try{let n=[];for await(let r of Xv(t,i))n.push(r);return n}catch{return Yv(t)}}function cL(t){for(;t&&!t.dir;)t=t.parentNode;return t?.dir}var Jv=cL;function Qv(t){return t<10?`0${t}`:t.toString()}function zs(){let t=new Date,e=Qv(t.getHours()),i=Qv(t.getMinutes()),n=Qv(t.getSeconds());return`${e}:${i}:${n}`}function Ep(){if(typeof window>"u")return!1;let t=document.body;return!(t==null||window==null||!("draggable"in t)||!("ondragstart"in t)||!("ondrop"in t)||!("FormData"in window)||!("FileReader"in window))}function dL(t){return t?t.readyState!==0&&t.readyState!==4||t.status===0:!1}var Zv=dL;function fd(t){return t.startsWith("blob:")}function gd(t){return t?/^[^/]+\/(jpe?g|gif|png|svg|svg\+xml|bmp|webp|avif)$/.test(t):!1}function eC(t){let e=Math.floor(t/3600)%24,i=Math.floor(t/60)%60,n=Math.floor(t%60);return{hours:e,minutes:i,seconds:n}}function Pp(t){let e=eC(t),i=e.hours===0?"":`${e.hours}h`,n=e.minutes===0?"":`${e.hours===0?e.minutes:` ${e.minutes.toString(10).padStart(2,"0")}`}m`,r=e.hours!==0?"":`${e.minutes===0?e.seconds:` ${e.seconds.toString(10).padStart(2,"0")}`}s`;return`${i}${n}${r}`}function uL(t){return new Error("Cancelled",{cause:t})}function bE(t){if(t!=null){let e=()=>this.abort(t.reason);t.addEventListener("abort",e,{once:!0});let i=()=>{t.removeEventListener("abort",e)};this.then?.(i,i)}return this}var Vs=class{#e=0;#t=[];#i=!1;#n;#r=1;#c;#s;limit;constructor(e){typeof e!="number"||e===0?this.limit=1/0:this.limit=e}#a(e){this.#e+=1;let i=!1,n;try{n=e()}catch(r){throw this.#e-=1,r}return{abort:r=>{i||(i=!0,this.#e-=1,n?.(r),this.#o())},done:()=>{i||(i=!0,this.#e-=1,this.#o())}}}#o(){queueMicrotask(()=>this.#p())}#p(){if(this.#i||this.#e>=this.limit||this.#t.length===0)return;let e=this.#t.shift();if(e==null)throw new Error("Invariant violation: next is null");let i=this.#a(e.fn);e.abort=i.abort,e.done=i.done}#l(e,i){let n={fn:e,priority:i?.priority||0,abort:()=>{this.#u(n)},done:()=>{throw new Error("Cannot mark a queued request as done: this indicates a bug")}},r=this.#t.findIndex(o=>n.priority>o.priority);return r===-1?this.#t.push(n):this.#t.splice(r,0,n),n}#u(e){let i=this.#t.indexOf(e);i!==-1&&this.#t.splice(i,1)}run(e,i){return!this.#i&&this.#e<this.limit?this.#a(e):this.#l(e,i)}wrapSyncFunction(e,i){return(...n)=>{let r=this.run(()=>(e(...n),queueMicrotask(()=>r.done()),()=>{}),i);return{abortOn:bE,abort(){r.abort()}}}}wrapPromiseFunction(e,i){return(...n)=>{let r,o=new Promise((s,a)=>{r=this.run(()=>{let l,c;try{c=Promise.resolve(e(...n))}catch(d){c=Promise.reject(d)}return c.then(d=>{l?a(l):(r.done(),s(d))},d=>{l?a(l):(r.done(),a(d))}),d=>{l=uL(d)}},i)});return o.abort=s=>{r.abort(s)},o.abortOn=bE,o}}resume(){this.#i=!1,clearTimeout(this.#n);for(let e=0;e<this.limit;e++)this.#o()}#d=()=>this.resume();pause(e=null){this.#i=!0,clearTimeout(this.#n),e!=null&&(this.#n=setTimeout(this.#d,e))}rateLimit(e){clearTimeout(this.#s),this.pause(e),this.limit>1&&Number.isFinite(this.limit)&&(this.#c=this.limit-1,this.limit=this.#r,this.#s=setTimeout(this.#h,e))}#h=()=>{if(this.#i){this.#s=setTimeout(this.#h,0);return}this.#r=this.limit,this.limit=Math.ceil((this.#c+this.#r)/2);for(let e=this.#r;e<=this.limit;e++)this.#o();this.#c-this.#r>3?this.#s=setTimeout(this.#h,2e3):this.#r=Math.floor(this.#r/2)};get isPaused(){return this.#i}},hL=Symbol("__queue");function Rp(t){return k(w({},t),{type:t.mimeType,extension:t.name?Yn(t.name).extension:null})}function pL(t,e,i){let n=[];return t.forEach(r=>typeof r!="string"?n.push(r):e[Symbol.split](r).forEach((o,s,a)=>{o!==""&&n.push(o),s<a.length-1&&n.push(i)})),n}function yE(t,e){let i=/\$/g,n="$$$$",r=[t];if(e==null)return r;for(let o of Object.keys(e))if(o!=="_"){let s=e[o];typeof s=="string"&&(s=i[Symbol.replace](s,n)),r=pL(r,new RegExp(`%\\{${o}\\}`,"g"),s)}return r}var fL=t=>{throw new Error(`missing string: ${t}`)},Gs=class{locale;constructor(e,{onMissingKey:i=fL}={}){this.locale={strings:{},pluralize(n){return n===1?0:1}},Array.isArray(e)?e.forEach(this.#t,this):this.#t(e),this.#e=i}#e;#t(e){if(!e?.strings)return;let i=this.locale;Object.assign(this.locale,{strings:w(w({},i.strings),e.strings),pluralize:e.pluralize||i.pluralize})}translate(e,i){return this.translateArray(e,i).join("")}translateArray(e,i){let n=this.locale.strings[e];if(n==null&&(this.#e(e),n=e),typeof n=="object"){if(i&&typeof i.smart_count<"u"){let o=this.locale.pluralize(i.smart_count);return yE(n[o],i)}throw new Error("Attempted to use a string with plural forms, but no value was given for %{smart_count}")}if(typeof n!="string")throw new Error("string was not a string");return yE(n,i)}};function md(t,e){if(e===0)return"";if(t.length<=e)return t;if(e<=4)return`${t.slice(0,e-1)}\u2026`;let i=e-3,n=Math.ceil(i/2),r=Math.floor(i/2);return t.slice(0,n)+"..."+t.slice(-r)}var wd,lt,RE,gL,Ws,SE,_E,kE,FE,rC,tC,iC,mL,Cd={},TE=[],vL=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,bd=Array.isArray;function hr(t,e){for(var i in e)t[i]=e[i];return t}function oC(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function yd(t,e,i){var n,r,o,s={};for(o in e)o=="key"?n=e[o]:o=="ref"?r=e[o]:s[o]=e[o];if(arguments.length>2&&(s.children=arguments.length>3?wd.call(arguments,2):i),typeof t=="function"&&t.defaultProps!=null)for(o in t.defaultProps)s[o]===void 0&&(s[o]=t.defaultProps[o]);return vd(t,s,n,r,null)}function vd(t,e,i,n,r){var o={type:t,props:e,key:i,ref:n,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:r??++RE,__i:-1,__u:0};return r==null&&lt.vnode!=null&&lt.vnode(o),o}function DE(){return{current:null}}function ei(t){return t.children}function bi(t,e){this.props=t,this.context=e}function cl(t,e){if(e==null)return t.__?cl(t.__,t.__i+1):null;for(var i;e<t.__k.length;e++)if((i=t.__k[e])!=null&&i.__e!=null)return i.__e;return typeof t.type=="function"?cl(t):null}function ME(t){var e,i;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((i=t.__k[e])!=null&&i.__e!=null){t.__e=t.__c.base=i.__e;break}return ME(t)}}function xE(t){(!t.__d&&(t.__d=!0)&&Ws.push(t)&&!kp.__r++||SE!=lt.debounceRendering)&&((SE=lt.debounceRendering)||_E)(kp)}function kp(){for(var t,e,i,n,r,o,s,a=1;Ws.length;)Ws.length>a&&Ws.sort(kE),t=Ws.shift(),a=Ws.length,t.__d&&(i=void 0,n=void 0,r=(n=(e=t).__v).__e,o=[],s=[],e.__P&&((i=hr({},n)).__v=n.__v+1,lt.vnode&&lt.vnode(i),sC(e.__P,i,n,e.__n,e.__P.namespaceURI,32&n.__u?[r]:null,o,r??cl(n),!!(32&n.__u),s),i.__v=n.__v,i.__.__k[i.__i]=i,OE(o,i,s),n.__e=n.__=null,i.__e!=r&&ME(i)));kp.__r=0}function IE(t,e,i,n,r,o,s,a,l,c,d){var u,h,p,f,g,m,v,C=n&&n.__k||TE,b=e.length;for(l=CL(i,e,C,l,b),u=0;u<b;u++)(p=i.__k[u])!=null&&(h=p.__i==-1?Cd:C[p.__i]||Cd,p.__i=u,m=sC(t,p,h,r,o,s,a,l,c,d),f=p.__e,p.ref&&h.ref!=p.ref&&(h.ref&&aC(h.ref,null,p),d.push(p.ref,p.__c||f,p)),g==null&&f!=null&&(g=f),(v=!!(4&p.__u))||h.__k===p.__k?l=AE(p,l,t,v):typeof p.type=="function"&&m!==void 0?l=m:f&&(l=f.nextSibling),p.__u&=-7);return i.__e=g,l}function CL(t,e,i,n,r){var o,s,a,l,c,d=i.length,u=d,h=0;for(t.__k=new Array(r),o=0;o<r;o++)(s=e[o])!=null&&typeof s!="boolean"&&typeof s!="function"?(l=o+h,(s=t.__k[o]=typeof s=="string"||typeof s=="number"||typeof s=="bigint"||s.constructor==String?vd(null,s,null,null,null):bd(s)?vd(ei,{children:s},null,null,null):s.constructor==null&&s.__b>0?vd(s.type,s.props,s.key,s.ref?s.ref:null,s.__v):s).__=t,s.__b=t.__b+1,a=null,(c=s.__i=wL(s,i,l,u))!=-1&&(u--,(a=i[c])&&(a.__u|=2)),a==null||a.__v==null?(c==-1&&(r>d?h--:r<d&&h++),typeof s.type!="function"&&(s.__u|=4)):c!=l&&(c==l-1?h--:c==l+1?h++:(c>l?h--:h++,s.__u|=4))):t.__k[o]=null;if(u)for(o=0;o<d;o++)(a=i[o])!=null&&(2&a.__u)==0&&(a.__e==n&&(n=cl(a)),NE(a,a));return n}function AE(t,e,i,n){var r,o;if(typeof t.type=="function"){for(r=t.__k,o=0;r&&o<r.length;o++)r[o]&&(r[o].__=t,e=AE(r[o],e,i,n));return e}t.__e!=e&&(n&&(e&&t.type&&!e.parentNode&&(e=cl(t)),i.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function pr(t,e){return e=e||[],t==null||typeof t=="boolean"||(bd(t)?t.some(function(i){pr(i,e)}):e.push(t)),e}function wL(t,e,i,n){var r,o,s,a=t.key,l=t.type,c=e[i],d=c!=null&&(2&c.__u)==0;if(c===null&&t.key==null||d&&a==c.key&&l==c.type)return i;if(n>(d?1:0)){for(r=i-1,o=i+1;r>=0||o<e.length;)if((c=e[s=r>=0?r--:o++])!=null&&(2&c.__u)==0&&a==c.key&&l==c.type)return s}return-1}function EE(t,e,i){e[0]=="-"?t.setProperty(e,i??""):t[e]=i==null?"":typeof i!="number"||vL.test(e)?i:i+"px"}function _p(t,e,i,n,r){var o,s;e:if(e=="style")if(typeof i=="string")t.style.cssText=i;else{if(typeof n=="string"&&(t.style.cssText=n=""),n)for(e in n)i&&e in i||EE(t.style,e,"");if(i)for(e in i)n&&i[e]==n[e]||EE(t.style,e,i[e])}else if(e[0]=="o"&&e[1]=="n")o=e!=(e=e.replace(FE,"$1")),s=e.toLowerCase(),e=s in t||e=="onFocusOut"||e=="onFocusIn"?s.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+o]=i,i?n?i.u=n.u:(i.u=rC,t.addEventListener(e,o?iC:tC,o)):t.removeEventListener(e,o?iC:tC,o);else{if(r=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=i??"";break e}catch{}typeof i=="function"||(i==null||i===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&i==1?"":i))}}function PE(t){return function(e){if(this.l){var i=this.l[e.type+t];if(e.t==null)e.t=rC++;else if(e.t<i.u)return;return i(lt.event?lt.event(e):e)}}}function sC(t,e,i,n,r,o,s,a,l,c){var d,u,h,p,f,g,m,v,C,b,S,x,E,P,L,B,j,q=e.type;if(e.constructor!=null)return null;128&i.__u&&(l=!!(32&i.__u),o=[a=e.__e=i.__e]),(d=lt.__b)&&d(e);e:if(typeof q=="function")try{if(v=e.props,C="prototype"in q&&q.prototype.render,b=(d=q.contextType)&&n[d.__c],S=d?b?b.props.value:d.__:n,i.__c?m=(u=e.__c=i.__c).__=u.__E:(C?e.__c=u=new q(v,S):(e.__c=u=new bi(v,S),u.constructor=q,u.render=yL),b&&b.sub(u),u.props=v,u.state||(u.state={}),u.context=S,u.__n=n,h=u.__d=!0,u.__h=[],u._sb=[]),C&&u.__s==null&&(u.__s=u.state),C&&q.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=hr({},u.__s)),hr(u.__s,q.getDerivedStateFromProps(v,u.__s))),p=u.props,f=u.state,u.__v=e,h)C&&q.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),C&&u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(C&&q.getDerivedStateFromProps==null&&v!==p&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(v,S),!u.__e&&u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(v,u.__s,S)===!1||e.__v==i.__v){for(e.__v!=i.__v&&(u.props=v,u.state=u.__s,u.__d=!1),e.__e=i.__e,e.__k=i.__k,e.__k.some(function(Y){Y&&(Y.__=e)}),x=0;x<u._sb.length;x++)u.__h.push(u._sb[x]);u._sb=[],u.__h.length&&s.push(u);break e}u.componentWillUpdate!=null&&u.componentWillUpdate(v,u.__s,S),C&&u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(p,f,g)})}if(u.context=S,u.props=v,u.__P=t,u.__e=!1,E=lt.__r,P=0,C){for(u.state=u.__s,u.__d=!1,E&&E(e),d=u.render(u.props,u.state,u.context),L=0;L<u._sb.length;L++)u.__h.push(u._sb[L]);u._sb=[]}else do u.__d=!1,E&&E(e),d=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++P<25);u.state=u.__s,u.getChildContext!=null&&(n=hr(hr({},n),u.getChildContext())),C&&!h&&u.getSnapshotBeforeUpdate!=null&&(g=u.getSnapshotBeforeUpdate(p,f)),B=d,d!=null&&d.type===ei&&d.key==null&&(B=LE(d.props.children)),a=IE(t,bd(B)?B:[B],e,i,n,r,o,s,a,l,c),u.base=e.__e,e.__u&=-161,u.__h.length&&s.push(u),m&&(u.__E=u.__=null)}catch(Y){if(e.__v=null,l||o!=null)if(Y.then){for(e.__u|=l?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;o[o.indexOf(a)]=null,e.__e=a}else{for(j=o.length;j--;)oC(o[j]);nC(e)}else e.__e=i.__e,e.__k=i.__k,Y.then||nC(e);lt.__e(Y,e,i)}else o==null&&e.__v==i.__v?(e.__k=i.__k,e.__e=i.__e):a=e.__e=bL(i.__e,e,i,n,r,o,s,l,c);return(d=lt.diffed)&&d(e),128&e.__u?void 0:a}function nC(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(nC)}function OE(t,e,i){for(var n=0;n<i.length;n++)aC(i[n],i[++n],i[++n]);lt.__c&&lt.__c(e,t),t.some(function(r){try{t=r.__h,r.__h=[],t.some(function(o){o.call(r)})}catch(o){lt.__e(o,r.__v)}})}function LE(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:bd(t)?t.map(LE):hr({},t)}function bL(t,e,i,n,r,o,s,a,l){var c,d,u,h,p,f,g,m=i.props,v=e.props,C=e.type;if(C=="svg"?r="http://www.w3.org/2000/svg":C=="math"?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),o!=null){for(c=0;c<o.length;c++)if((p=o[c])&&"setAttribute"in p==!!C&&(C?p.localName==C:p.nodeType==3)){t=p,o[c]=null;break}}if(t==null){if(C==null)return document.createTextNode(v);t=document.createElementNS(r,C,v.is&&v),a&&(lt.__m&&lt.__m(e,o),a=!1),o=null}if(C==null)m===v||a&&t.data==v||(t.data=v);else{if(o=o&&wd.call(t.childNodes),m=i.props||Cd,!a&&o!=null)for(m={},c=0;c<t.attributes.length;c++)m[(p=t.attributes[c]).name]=p.value;for(c in m)if(p=m[c],c!="children"){if(c=="dangerouslySetInnerHTML")u=p;else if(!(c in v)){if(c=="value"&&"defaultValue"in v||c=="checked"&&"defaultChecked"in v)continue;_p(t,c,null,p,r)}}for(c in v)p=v[c],c=="children"?h=p:c=="dangerouslySetInnerHTML"?d=p:c=="value"?f=p:c=="checked"?g=p:a&&typeof p!="function"||m[c]===p||_p(t,c,p,m[c],r);if(d)a||u&&(d.__html==u.__html||d.__html==t.innerHTML)||(t.innerHTML=d.__html),e.__k=[];else if(u&&(t.innerHTML=""),IE(e.type=="template"?t.content:t,bd(h)?h:[h],e,i,n,C=="foreignObject"?"http://www.w3.org/1999/xhtml":r,o,s,o?o[0]:i.__k&&cl(i,0),a,l),o!=null)for(c=o.length;c--;)oC(o[c]);a||(c="value",C=="progress"&&f==null?t.removeAttribute("value"):f!=null&&(f!==t[c]||C=="progress"&&!f||C=="option"&&f!=m[c])&&_p(t,c,f,m[c],r),c="checked",g!=null&&g!=t[c]&&_p(t,c,g,m[c],r))}return t}function aC(t,e,i){try{if(typeof t=="function"){var n=typeof t.__u=="function";n&&t.__u(),n&&e==null||(t.__u=t(e))}else t.current=e}catch(r){lt.__e(r,i)}}function NE(t,e,i){var n,r;if(lt.unmount&&lt.unmount(t),(n=t.ref)&&(n.current&&n.current!=t.__e||aC(n,null,e)),(n=t.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(o){lt.__e(o,e)}n.base=n.__P=null}if(n=t.__k)for(r=0;r<n.length;r++)n[r]&&NE(n[r],e,i||typeof t.type!="function");i||oC(t.__e),t.__c=t.__=t.__e=void 0}function yL(t,e,i){return this.constructor(t,i)}function lC(t,e,i){var n,r,o,s;e==document&&(e=document.documentElement),lt.__&&lt.__(t,e),r=(n=typeof i=="function")?null:i&&i.__k||e.__k,o=[],s=[],sC(e,t=(!n&&i||e).__k=yd(ei,null,[t]),r||Cd,Cd,e.namespaceURI,!n&&i?[i]:r?null:e.firstChild?wd.call(e.childNodes):null,o,!n&&i?i:r?r.__e:e.firstChild,n,s),OE(o,t,s)}function Fp(t,e,i){var n,r,o,s,a=hr({},t.props);for(o in t.type&&t.type.defaultProps&&(s=t.type.defaultProps),e)o=="key"?n=e[o]:o=="ref"?r=e[o]:a[o]=e[o]===void 0&&s!=null?s[o]:e[o];return arguments.length>2&&(a.children=arguments.length>3?wd.call(arguments,2):i),vd(t.type,a,n||t.key,r||t.ref,null)}wd=TE.slice,lt={__e:function(t,e,i,n){for(var r,o,s;e=e.__;)if((r=e.__c)&&!r.__)try{if((o=r.constructor)&&o.getDerivedStateFromError!=null&&(r.setState(o.getDerivedStateFromError(t)),s=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(t,n||{}),s=r.__d),s)return r.__E=r}catch(a){t=a}throw t}},RE=0,gL=function(t){return t!=null&&t.constructor==null},bi.prototype.setState=function(t,e){var i;i=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=hr({},this.state),typeof t=="function"&&(t=t(hr({},i),this.props)),t&&hr(i,t),t!=null&&this.__v&&(e&&this._sb.push(e),xE(this))},bi.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),xE(this))},bi.prototype.render=ei,Ws=[],_E=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,kE=function(t,e){return t.__v.__b-e.__v.__b},kp.__r=0,FE=/(PointerCapture)$|Capture$/i,rC=0,tC=PE(!1),iC=PE(!0),mL=0;var SL=0,xme=Array.isArray;function y(t,e,i,n,r,o){e||(e={});var s,a,l=e;if("ref"in l)for(a in l={},e)a=="ref"?s=e[a]:l[a]=e[a];var c={type:t,props:l,key:i,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--SL,__i:-1,__u:0,__source:r,__self:o};if(typeof t=="function"&&(s=t.defaultProps))for(a in s)l[a]===void 0&&(l[a]=s[a]);return lt.vnode&&lt.vnode(c),c}var Sd,It,cC,BE,xd=0,qE=[],Gt=lt,HE=Gt.__b,zE=Gt.__r,VE=Gt.diffed,GE=Gt.__c,WE=Gt.unmount,UE=Gt.__;function uC(t,e){Gt.__h&&Gt.__h(It,t,xd||e),xd=0;var i=It.__H||(It.__H={__:[],__h:[]});return t>=i.__.length&&i.__.push({}),i.__[t]}function nn(t){return xd=1,xL(KE,t)}function xL(t,e,i){var n=uC(Sd++,2);if(n.t=t,!n.__c&&(n.__=[i?i(e):KE(void 0,e),function(a){var l=n.__N?n.__N[0]:n.__[0],c=n.t(l,a);l!==c&&(n.__N=[c,n.__[1]],n.__c.setState({}))}],n.__c=It,!It.__f)){var r=function(a,l,c){if(!n.__c.__H)return!0;var d=n.__c.__H.__.filter(function(h){return!!h.__c});if(d.every(function(h){return!h.__N}))return!o||o.call(this,a,l,c);var u=n.__c.props!==a;return d.forEach(function(h){if(h.__N){var p=h.__[0];h.__=h.__N,h.__N=void 0,p!==h.__[0]&&(u=!0)}}),o&&o.call(this,a,l,c)||u};It.__f=!0;var o=It.shouldComponentUpdate,s=It.componentWillUpdate;It.componentWillUpdate=function(a,l,c){if(this.__e){var d=o;o=void 0,r(a,l,c),o=d}s&&s.call(this,a,l,c)},It.shouldComponentUpdate=r}return n.__N||n.__}function Xn(t,e){var i=uC(Sd++,3);!Gt.__s&&$E(i.__H,e)&&(i.__=t,i.u=e,It.__H.__h.push(i))}function Xo(t){return xd=5,Us(function(){return{current:t}},[])}function Us(t,e){var i=uC(Sd++,7);return $E(i.__H,e)&&(i.__=t(),i.__H=e,i.__h=t),i.__}function Jn(t,e){return xd=8,Us(function(){return t},e)}function EL(){for(var t;t=qE.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(Tp),t.__H.__h.forEach(dC),t.__H.__h=[]}catch(e){t.__H.__h=[],Gt.__e(e,t.__v)}}Gt.__b=function(t){It=null,HE&&HE(t)},Gt.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),UE&&UE(t,e)},Gt.__r=function(t){zE&&zE(t),Sd=0;var e=(It=t.__c).__H;e&&(cC===It?(e.__h=[],It.__h=[],e.__.forEach(function(i){i.__N&&(i.__=i.__N),i.u=i.__N=void 0})):(e.__h.forEach(Tp),e.__h.forEach(dC),e.__h=[],Sd=0)),cC=It},Gt.diffed=function(t){VE&&VE(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(qE.push(e)!==1&&BE===Gt.requestAnimationFrame||((BE=Gt.requestAnimationFrame)||PL)(EL)),e.__H.__.forEach(function(i){i.u&&(i.__H=i.u),i.u=void 0})),cC=It=null},Gt.__c=function(t,e){e.some(function(i){try{i.__h.forEach(Tp),i.__h=i.__h.filter(function(n){return!n.__||dC(n)})}catch(n){e.some(function(r){r.__h&&(r.__h=[])}),e=[],Gt.__e(n,i.__v)}}),GE&&GE(t,e)},Gt.unmount=function(t){WE&&WE(t);var e,i=t.__c;i&&i.__H&&(i.__H.__.forEach(function(n){try{Tp(n)}catch(r){e=r}}),i.__H=void 0,e&&Gt.__e(e,i.__v))};var jE=typeof requestAnimationFrame=="function";function PL(t){var e,i=function(){clearTimeout(n),jE&&cancelAnimationFrame(e),setTimeout(t)},n=setTimeout(i,35);jE&&(e=requestAnimationFrame(i))}function Tp(t){var e=It,i=t.__c;typeof i=="function"&&(t.__c=void 0,i()),It=e}function dC(t){var e=It;t.__c=t.__(),It=e}function $E(t,e){return!t||t.length!==e.length||e.some(function(i,n){return i!==t[n]})}function KE(t,e){return typeof e=="function"?e(t):e}var RL={position:"relative",width:"100%",minHeight:"100%"},_L={position:"absolute",top:0,left:0,width:"100%",overflow:"visible"};function dl(s){var a=s,{data:t,rowHeight:e,renderRow:i,overscanCount:n=10,padding:r=4}=a,o=Vt(a,["data","rowHeight","renderRow","overscanCount","padding"]);let l=Xo(null),[c,d]=nn(0),[u,h]=nn(0);Xn(()=>{function S(){l.current!=null&&u!==l.current.offsetHeight&&h(l.current.offsetHeight)}return S(),window.addEventListener("resize",S),()=>{window.removeEventListener("resize",S)}},[u]);let p=Jn(()=>{l.current&&d(l.current.scrollTop)},[]),f=Math.floor(c/e),g=Math.floor(u/e);n&&(f=Math.max(0,f-f%n),g+=n);let m=f+g+r,v=t.slice(f,m),C=k(w({},RL),{height:t.length*e}),b=k(w({},_L),{top:f*e});return y("div",k(w({onScroll:p,ref:l},o),{children:y("div",{role:"presentation",style:C,children:y("div",{role:"presentation",style:b,children:v.map(i)})})}))}var Zr=class{uppy;opts;id;defaultLocale;i18n;i18nArray;type;VERSION;constructor(e,i){this.uppy=e,this.opts=i??{}}getPluginState(){let{plugins:e}=this.uppy.getState();return e?.[this.id]||{}}setPluginState(e){let{plugins:i}=this.uppy.getState();this.uppy.setState({plugins:k(w({},i),{[this.id]:w(w({},i[this.id]),e)})})}setOptions(e){this.opts=w(w({},this.opts),e),this.setPluginState(void 0),this.i18nInit()}i18nInit(){let e=new Gs([this.defaultLocale,this.uppy.locale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.setPluginState(void 0)}addTarget(e){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")}install(){}uninstall(){}update(e){}afterUpdate(){}};var Ed=class{#e;#t=[];constructor(e){this.#e=e}on(e,i){return this.#t.push([e,i]),this.#e.on(e,i)}remove(){for(let[e,i]of this.#t.splice(0))this.#e.off(e,i)}onFilePause(e,i){this.on("upload-pause",(n,r)=>{e===n?.id&&i(r)})}onFileRemove(e,i){this.on("file-removed",n=>{e===n.id&&i(n.id)})}onPause(e,i){this.on("upload-pause",(n,r)=>{e===n?.id&&i(r)})}onRetry(e,i){this.on("upload-retry",n=>{e===n?.id&&i()})}onRetryAll(e,i){this.on("retry-all",()=>{this.#e.getFile(e)&&i()})}onPauseAll(e,i){this.on("pause-all",()=>{this.#e.getFile(e)&&i()})}onCancelAll(e,i){this.on("cancel-all",(...n)=>{this.#e.getFile(e)&&i(...n)})}onResumeAll(e,i){this.on("resume-all",()=>{this.#e.getFile(e)&&i()})}};var YE={debug:()=>{},warn:()=>{},error:(...t)=>console.error(`[Uppy] [${zs()}]`,...t)},XE={debug:(...t)=>console.debug(`[Uppy] [${zs()}]`,...t),warn:(...t)=>console.warn(`[Uppy] [${zs()}]`,...t),error:(...t)=>console.error(`[Uppy] [${zs()}]`,...t)};var Pd=nt(cd(),1),iP=nt(tP(),1),nP={maxFileSize:null,minFileSize:null,maxTotalFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null,requiredMetaFields:[]},Ui=class extends Error{isUserFacing;file;constructor(e,i){super(e),this.isUserFacing=i?.isUserFacing??!0,i?.file&&(this.file=i.file)}isRestriction=!0},Dp=class{getI18n;getOpts;constructor(e,i){this.getI18n=i,this.getOpts=()=>{let n=e();if(n.restrictions?.allowedFileTypes!=null&&!Array.isArray(n.restrictions.allowedFileTypes))throw new TypeError("`restrictions.allowedFileTypes` must be an array");return n}}validateAggregateRestrictions(e,i){let{maxTotalFileSize:n,maxNumberOfFiles:r}=this.getOpts().restrictions;if(r&&e.filter(s=>!s.isGhost).length+i.length>r)throw new Ui(`${this.getI18n()("youCanOnlyUploadX",{smart_count:r})}`);if(n){let o=[...e,...i].reduce((s,a)=>s+(a.size??0),0);if(o>n)throw new Ui(this.getI18n()("aggregateExceedsSize",{sizeAllowed:(0,Pd.default)(n),size:(0,Pd.default)(o)}))}}validateSingleFile(e){let{maxFileSize:i,minFileSize:n,allowedFileTypes:r}=this.getOpts().restrictions;if(r&&!r.some(s=>s.includes("/")?e.type?(0,iP.default)(e.type.replace(/;.*?$/,""),s):!1:s[0]==="."&&e.extension?e.extension.toLowerCase()===s.slice(1).toLowerCase():!1)){let s=r.join(", ");throw new Ui(this.getI18n()("youCanOnlyUploadFileTypes",{types:s}),{file:e})}if(i&&e.size!=null&&e.size>i)throw new Ui(this.getI18n()("exceedsSize",{size:(0,Pd.default)(i),file:e.name??this.getI18n()("unnamed")}),{file:e});if(n&&e.size!=null&&e.size<n)throw new Ui(this.getI18n()("inferiorSize",{size:(0,Pd.default)(n)}),{file:e})}validate(e,i){i.forEach(n=>{this.validateSingleFile(n)}),this.validateAggregateRestrictions(e,i)}validateMinNumberOfFiles(e){let{minNumberOfFiles:i}=this.getOpts().restrictions;if(i&&Object.keys(e).length<i)throw new Ui(this.getI18n()("youHaveToAtLeastSelectX",{smart_count:i}))}getMissingRequiredMetaFields(e){let i=new Ui(this.getI18n()("missingRequiredMetaFieldOnFile",{fileName:e.name??this.getI18n()("unnamed")})),{requiredMetaFields:n}=this.getOpts().restrictions,r=[];for(let o of n)(!Object.hasOwn(e.meta,o)||e.meta[o]==="")&&r.push(o);return{missingFields:r,error:i}}};function TL(t){let e=null,i;return(...n)=>(i=n,e||(e=Promise.resolve().then(()=>(e=null,t(...i)))),e)}var hC=class t extends Zr{#e;isTargetDOMEl;el;parent;title;getTargetPlugin(e){let i;if(typeof e?.addTarget=="function")i=e,i instanceof t||console.warn(new Error("The provided plugin is not an instance of UIPlugin. This is an indication of a bug with the way Uppy is bundled.",{cause:{targetPlugin:i,UIPlugin:t}}));else if(typeof e=="function"){let n=e;this.uppy.iteratePlugins(r=>{r instanceof n&&(i=r)})}return i}mount(e,i){let n=i.id,r=qv(e);if(r){this.isTargetDOMEl=!0;let a=document.createElement("div");return a.classList.add("uppy-Root"),this.#e=TL(l=>{this.uppy.getPlugin(this.id)&&(lC(this.render(l,a),a),this.afterUpdate())}),this.uppy.log(`Installing ${n} to a DOM element '${e}'`),this.opts.replaceTargetContent&&(r.innerHTML=""),lC(this.render(this.uppy.getState(),a),a),this.el=a,r.appendChild(a),a.dir=this.opts.direction||Jv(a)||"ltr",this.onMount(),this.el}let o=this.getTargetPlugin(e);if(o)return this.uppy.log(`Installing ${n} to ${o.id}`),this.parent=o,this.el=o.addTarget(i),this.onMount(),this.el;this.uppy.log(`Not installing ${n}`);let s=`Invalid target option given to ${n}.`;throw typeof e=="function"?s+=" The given target is not a Plugin class. Please check that you're not specifying a React Component instead of a plugin. If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.":s+="If you meant to target an HTML element, please make sure that the element exists. Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. (see https://github.com/transloadit/uppy/issues/1042)\n\nIf you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.",new Error(s)}render(e,i){throw new Error("Extend the render method to add your plugin to a DOM element")}update(e){this.el!=null&&this.#e?.(e)}unmount(){this.isTargetDOMEl&&this.el?.remove(),this.onUnmount()}onMount(){}onUnmount(){}},Rd=hC;var rP={name:"@uppy/store-default",description:"The default simple object-based store for Uppy.",version:"5.0.0",license:"MIT",main:"lib/index.js",type:"module",sideEffects:!1,scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","uppy","uppy-store"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},devDependencies:{jsdom:"^26.1.0",typescript:"^5.8.3",vitest:"^3.2.4"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},exports:{".":"./lib/index.js","./package.json":"./package.json"},files:["src","lib","dist","CHANGELOG.md"]};var pC=class{static VERSION=rP.version;state={};#e=new Set;getState(){return this.state}setState(e){let i=w({},this.state),n=w(w({},this.state),e);this.state=n,this.#t(i,n,e)}subscribe(e){return this.#e.add(e),()=>{this.#e.delete(e)}}#t(...e){this.#e.forEach(i=>{i(...e)})}},oP=pC;var WP=nt(BP(),1),UP=nt(zP(),1);var E9="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";var Jo=(t=21)=>{let e="",i=t|0;for(;i--;)e+=E9[Math.random()*64|0];return e};var VP={name:"@uppy/core",description:"Core module for the extensible JavaScript file upload widget with support for drag&drop, resumable uploads, previews, restrictions, file processing/encoding, remote providers like Instagram, Dropbox, Google Drive, S3 and more :dog:",version:"5.0.2",license:"MIT",style:"dist/style.min.css",type:"module",sideEffects:["*.css"],scripts:{build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","uppy","uppy-plugin"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],exports:{".":"./lib/index.js","./css/style.min.css":"./dist/style.min.css","./css/style.css":"./dist/style.css","./css/style.scss":"./src/style.scss","./package.json":"./package.json"},dependencies:{"@transloadit/prettier-bytes":"^0.3.4","@uppy/store-default":"^5.0.0","@uppy/utils":"^7.0.2",lodash:"^4.17.21","mime-match":"^1.0.2","namespace-emitter":"^2.0.1",nanoid:"^5.0.9",preact:"^10.5.13"},devDependencies:{"@types/deep-freeze":"^0",cssnano:"^7.0.7","deep-freeze":"^0.0.1",jsdom:"^26.1.0",postcss:"^8.5.6","postcss-cli":"^11.0.1",sass:"^1.89.2",typescript:"^5.8.3",vitest:"^3.2.4"}};function CC(t,e){return e.name?e.name:t.split("/")[0]==="image"?`${t.split("/")[0]}.${t.split("/")[1]}`:"noname"}var GP={strings:{addBulkFilesFailed:{0:"Failed to add %{smart_count} file due to an internal error",1:"Failed to add %{smart_count} files due to internal errors"},youCanOnlyUploadX:{0:"You can only upload %{smart_count} file",1:"You can only upload %{smart_count} files"},youHaveToAtLeastSelectX:{0:"You have to select at least %{smart_count} file",1:"You have to select at least %{smart_count} files"},aggregateExceedsSize:"You selected %{size} of files, but maximum allowed size is %{sizeAllowed}",exceedsSize:"%{file} exceeds maximum allowed size of %{size}",missingRequiredMetaField:"Missing required meta fields",missingRequiredMetaFieldOnFile:"Missing required meta fields in %{fileName}",inferiorSize:"This file is smaller than the allowed size of %{size}",youCanOnlyUploadFileTypes:"You can only upload: %{types}",noMoreFilesAllowed:"Cannot add more files",noDuplicates:"Cannot add the duplicate file '%{fileName}', it already exists",companionError:"Connection with Companion failed",authAborted:"Authentication aborted",companionUnauthorizeHint:"To unauthorize to your %{provider} account, please go to %{url}",failedToUpload:"Failed to upload %{file}",noInternetConnection:"No Internet connection",connectedToInternet:"Connected to the Internet",noFilesFound:"You have no files or folders here",noSearchResults:"Unfortunately, there are no results for this search",selectX:{0:"Select %{smart_count}",1:"Select %{smart_count}"},allFilesFromFolderNamed:"All files from folder %{name}",openFolderNamed:"Open folder %{name}",cancel:"Cancel",logOut:"Log out",logIn:"Log in",pickFiles:"Pick files",pickPhotos:"Pick photos",filter:"Filter",resetFilter:"Reset filter",loading:"Loading...",loadedXFiles:"Loaded %{numFiles} files",authenticateWithTitle:"Please authenticate with %{pluginName} to select files",authenticateWith:"Connect to %{pluginName}",signInWithGoogle:"Sign in with Google",searchImages:"Search for images",enterTextToSearch:"Enter text to search for images",search:"Search",resetSearch:"Reset search",emptyFolderAdded:"No files were added from empty folder",addedNumFiles:"Added %{numFiles} file(s)",folderAlreadyAdded:'The folder "%{folder}" was already added',folderAdded:{0:"Added %{smart_count} file from %{folder}",1:"Added %{smart_count} files from %{folder}"},additionalRestrictionsFailed:"%{count} additional restrictions were not fulfilled",unnamed:"Unnamed",pleaseWait:"Please wait"}};function wC(t){if(t==null&&typeof navigator<"u"&&(t=navigator.userAgent),!t)return!0;let e=/Edge\/(\d+\.\d+)/.exec(t);if(!e)return!0;let n=e[1].split(".",2),r=parseInt(n[0],10),o=parseInt(n[1],10);return r<15||r===15&&o<15063||r>18||r===18&&o>=18218}var Ip={totalProgress:0,allowNewUpload:!0,error:null,recoveredState:null},bC=class t{static VERSION=VP.version;#e=Object.create(null);#t;#i;#n=(0,UP.default)();#r=new Set;#c=new Set;#s=new Set;defaultLocale;locale;opts;store;i18n;i18nArray;scheduledAutoProceed=null;wasOffline=!1;constructor(e){this.defaultLocale=GP;let i={id:"uppy",autoProceed:!1,allowMultipleUploadBatches:!0,debug:!1,restrictions:nP,meta:{},onBeforeFileAdded:(r,o)=>!Object.hasOwn(o,r.id),onBeforeUpload:r=>r,store:new oP,logger:YE,infoTimeout:5e3},n=w(w({},i),e);this.opts=k(w({},n),{restrictions:w(w({},i.restrictions),e?.restrictions)}),e?.logger&&e.debug?this.log("You are using a custom `logger`, but also set `debug: true`, which uses built-in logger to output logs to console. Ignoring `debug: true` and using your custom `logger`.","warning"):e?.debug&&(this.opts.logger=XE),this.log(`Using Core v${t.VERSION}`),this.i18nInit(),this.store=this.opts.store,this.setState(k(w({},Ip),{plugins:{},files:{},currentUploads:{},capabilities:{uploadProgress:wC(),individualCancellation:!0,resumableUploads:!1},meta:w({},this.opts.meta),info:[]})),this.#t=new Dp(()=>this.opts,()=>this.i18n),this.#i=this.store.subscribe((r,o,s)=>{this.emit("state-update",r,o,s),this.updateAll(o)}),this.opts.debug&&typeof window<"u"&&(window[this.opts.id]=this),this.#C()}emit(e,...i){this.#n.emit(e,...i)}on(e,i){return this.#n.on(e,i),this}once(e,i){return this.#n.once(e,i),this}off(e,i){return this.#n.off(e,i),this}updateAll(e){this.iteratePlugins(i=>{i.update(e)})}setState(e){this.store.setState(e)}getState(){return this.store.getState()}patchFilesState(e){let i=this.getState().files;this.setState({files:w(w({},i),Object.fromEntries(Object.entries(e).map(([n,r])=>[n,w(w({},i[n]),r)])))})}setFileState(e,i){if(!this.getState().files[e])throw new Error(`Can\u2019t set state for ${e} (the file could have been removed)`);this.patchFilesState({[e]:i})}i18nInit(){let e=n=>this.log(`Missing i18n string: ${n}`,"error"),i=new Gs([this.defaultLocale,this.opts.locale],{onMissingKey:e});this.i18n=i.translate.bind(i),this.i18nArray=i.translateArray.bind(i),this.locale=i.locale}setOptions(e){this.opts=k(w(w({},this.opts),e),{restrictions:w(w({},this.opts.restrictions),e?.restrictions)}),e.meta&&this.setMeta(e.meta),this.i18nInit(),e.locale&&this.iteratePlugins(i=>{i.setOptions(e)}),this.setState(void 0)}resetProgress(){let e={percentage:0,bytesUploaded:!1,uploadComplete:!1,uploadStarted:null},i=w({},this.getState().files),n=Object.create(null);Object.keys(i).forEach(r=>{n[r]=k(w({},i[r]),{progress:w(w({},i[r].progress),e),tus:void 0,transloadit:void 0})}),this.setState(w({files:n},Ip))}clear(){let{capabilities:e,currentUploads:i}=this.getState();if(Object.keys(i).length>0&&!e.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");this.setState(k(w({},Ip),{files:{}}))}addPreProcessor(e){this.#r.add(e)}removePreProcessor(e){return this.#r.delete(e)}addPostProcessor(e){this.#s.add(e)}removePostProcessor(e){return this.#s.delete(e)}addUploader(e){this.#c.add(e)}removeUploader(e){return this.#c.delete(e)}setMeta(e){let i=w(w({},this.getState().meta),e),n=w({},this.getState().files);Object.keys(n).forEach(r=>{n[r]=k(w({},n[r]),{meta:w(w({},n[r].meta),e)})}),this.log("Adding metadata:"),this.log(e),this.setState({meta:i,files:n})}setFileMeta(e,i){let n=w({},this.getState().files);if(!n[e]){this.log(`Was trying to set metadata for a file that has been removed: ${e}`);return}let r=w(w({},n[e].meta),i);n[e]=k(w({},n[e]),{meta:r}),this.setState({files:n})}getFile(e){return this.getState().files[e]}getFiles(){let{files:e}=this.getState();return Object.values(e)}getFilesByIds(e){return e.map(i=>this.getFile(i))}getObjectOfFilesPerState(){let{files:e,totalProgress:i,error:n}=this.getState(),r=Object.values(e),o=[],s=[],a=[],l=[],c=[],d=[],u=[],h=[],p=[];for(let f of r){let{progress:g}=f;!g.uploadComplete&&g.uploadStarted&&(o.push(f),f.isPaused||h.push(f)),g.uploadStarted||s.push(f),(g.uploadStarted||g.preprocess||g.postprocess)&&a.push(f),g.uploadStarted&&l.push(f),f.isPaused&&c.push(f),g.uploadComplete&&d.push(f),f.error&&u.push(f),(g.preprocess||g.postprocess)&&p.push(f)}return{newFiles:s,startedFiles:a,uploadStartedFiles:l,pausedFiles:c,completeFiles:d,erroredFiles:u,inProgressFiles:o,inProgressNotPausedFiles:h,processingFiles:p,isUploadStarted:l.length>0,isAllComplete:i===100&&d.length===r.length&&p.length===0,isAllErrored:!!n&&u.length===r.length,isAllPaused:o.length!==0&&c.length===o.length,isUploadInProgress:o.length>0,isSomeGhost:r.some(f=>f.isGhost)}}#a(e){for(let s of e)s.isRestriction?this.emit("restriction-failed",s.file,s):this.emit("error",s,s.file),this.log(s,"warning");let i=e.filter(s=>s.isUserFacing),n=4,r=i.slice(0,n),o=i.slice(n);r.forEach(({message:s,details:a=""})=>{this.info({message:s,details:a},"error",this.opts.infoTimeout)}),o.length>0&&this.info({message:this.i18n("additionalRestrictionsFailed",{count:o.length})})}validateRestrictions(e,i=this.getFiles()){try{this.#t.validate(i,[e])}catch(n){return n}return null}validateSingleFile(e){try{this.#t.validateSingleFile(e)}catch(i){return i.message}return null}validateAggregateRestrictions(e){let i=this.getFiles();try{this.#t.validateAggregateRestrictions(i,e)}catch(n){return n.message}return null}#o(e){let{missingFields:i,error:n}=this.#t.getMissingRequiredMetaFields(e);return i.length>0?(this.setFileState(e.id,{missingRequiredMetaFields:i,error:n.message}),this.log(n.message),this.emit("restriction-failed",e,n),!1):(i.length===0&&e.missingRequiredMetaFields&&this.setFileState(e.id,{missingRequiredMetaFields:[]}),!0)}#p(e){let i=!0;for(let n of Object.values(e))this.#o(n)||(i=!1);return i}#l(e){let{allowNewUpload:i}=this.getState();if(i===!1){let n=new Ui(this.i18n("noMoreFilesAllowed"),{file:e});throw this.#a([n]),n}}checkIfFileAlreadyExists(e){let{files:i}=this.getState();return!!(i[e]&&!i[e].isGhost)}#u(e){let i=e instanceof File?{name:e.name,type:e.type,size:e.size,data:e}:e,n=ll(i),r=CC(n,i),o=Yn(r).extension,s=pd(i,this.getID()),a=i.meta||{};a.name=r,a.type=n;let l=Number.isFinite(i.data.size)?i.data.size:null;return{source:i.source||"",id:s,name:r,extension:o||"",meta:w(w({},this.getState().meta),a),type:n,data:i.data,progress:{percentage:0,bytesUploaded:!1,bytesTotal:l,uploadComplete:!1,uploadStarted:null},size:l,isGhost:!1,isRemote:i.isRemote||!1,remote:i.remote,preview:i.preview}}#d(){this.opts.autoProceed&&!this.scheduledAutoProceed&&(this.scheduledAutoProceed=setTimeout(()=>{this.scheduledAutoProceed=null,this.upload().catch(e=>{e.isRestriction||this.log(e.stack||e.message||e)})},4))}#h(e){let{files:i}=this.getState(),n=w({},i),r=[],o=[];for(let s of e)try{let a=this.#u(s),l=i[a.id]?.isGhost;if(l){let d=i[a.id];a=k(w({},d),{isGhost:!1,data:s.data}),this.log(`Replaced the blob in the restored ghost file: ${a.name}, ${a.id}`)}let c=this.opts.onBeforeFileAdded(a,n);if(i=this.getState().files,n=w(w({},i),n),!c&&this.checkIfFileAlreadyExists(a.id))throw new Ui(this.i18n("noDuplicates",{fileName:a.name??this.i18n("unnamed")}),{file:s});if(c===!1&&!l)throw new Ui("Cannot add the file because onBeforeFileAdded returned false.",{isUserFacing:!1,file:s});typeof c=="object"&&c!==null&&(a=c),this.#t.validateSingleFile(a),n[a.id]=a,r.push(a)}catch(a){o.push(a)}try{this.#t.validateAggregateRestrictions(Object.values(i),r)}catch(s){return o.push(s),{nextFilesState:i,validFilesToAdd:[],errors:o}}return{nextFilesState:n,validFilesToAdd:r,errors:o}}addFile(e){this.#l(e);let{nextFilesState:i,validFilesToAdd:n,errors:r}=this.#h([e]),o=r.filter(a=>a.isRestriction);if(this.#a(o),r.length>0)throw r[0];this.setState({files:i});let[s]=n;return this.emit("file-added",s),this.emit("files-added",n),this.log(`Added file: ${s.name}, ${s.id}, mime type: ${s.type}`),this.#d(),s.id}addFiles(e){this.#l();let{nextFilesState:i,validFilesToAdd:n,errors:r}=this.#h(e),o=r.filter(a=>a.isRestriction);this.#a(o);let s=r.filter(a=>!a.isRestriction);if(s.length>0){let a=`Multiple errors occurred while adding files:
`;if(s.forEach(l=>{a+=`
 * ${l.message}`}),this.info({message:this.i18n("addBulkFilesFailed",{smart_count:s.length}),details:a},"error",this.opts.infoTimeout),typeof AggregateError=="function")throw new AggregateError(s,a);{let l=new Error(a);throw l.errors=s,l}}this.setState({files:i}),n.forEach(a=>{this.emit("file-added",a)}),this.emit("files-added",n),n.length>5?this.log(`Added batch of ${n.length} files`):Object.values(n).forEach(a=>{this.log(`Added file: ${a.name}
 id: ${a.id}
 type: ${a.type}`)}),n.length>0&&this.#d()}removeFiles(e){let{files:i,currentUploads:n}=this.getState(),r=w({},i),o=w({},n),s=Object.create(null);e.forEach(d=>{i[d]&&(s[d]=i[d],delete r[d])});function a(d){return s[d]===void 0}Object.keys(o).forEach(d=>{let u=n[d].fileIDs.filter(a);if(u.length===0){delete o[d];return}let{capabilities:h}=this.getState();if(u.length!==n[d].fileIDs.length&&!h.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");o[d]=k(w({},n[d]),{fileIDs:u})});let l={currentUploads:o,files:r};Object.keys(r).length===0&&(l.allowNewUpload=!0,l.error=null,l.recoveredState=null),this.setState(l),this.#v();let c=Object.keys(s);c.forEach(d=>{this.emit("file-removed",s[d])}),c.length>5?this.log(`Removed ${c.length} files`):this.log(`Removed files: ${c.join(", ")}`)}removeFile(e){this.removeFiles([e])}pauseResume(e){if(!this.getState().capabilities.resumableUploads||this.getFile(e).progress.uploadComplete)return;let i=this.getFile(e),r=!(i.isPaused||!1);return this.setFileState(e,{isPaused:r}),this.emit("upload-pause",i,r),r}pauseAll(){let e=w({},this.getState().files);Object.keys(e).filter(n=>!e[n].progress.uploadComplete&&e[n].progress.uploadStarted).forEach(n=>{let r=k(w({},e[n]),{isPaused:!0});e[n]=r}),this.setState({files:e}),this.emit("pause-all")}resumeAll(){let e=w({},this.getState().files);Object.keys(e).filter(n=>!e[n].progress.uploadComplete&&e[n].progress.uploadStarted).forEach(n=>{let r=k(w({},e[n]),{isPaused:!1,error:null});e[n]=r}),this.setState({files:e}),this.emit("resume-all")}#b(){let{files:e}=this.getState();return Object.keys(e).filter(i=>{let n=e[i];return n.error&&(!n.missingRequiredMetaFields||n.missingRequiredMetaFields.length===0)})}async#y(){let e=this.#b(),i=w({},this.getState().files);if(e.forEach(r=>{i[r]=k(w({},i[r]),{isPaused:!1,error:null})}),this.setState({files:i,error:null}),this.emit("retry-all",this.getFilesByIds(e)),e.length===0)return{successful:[],failed:[]};let n=this.#g(e,{forceAllowNewUpload:!0});return this.#x(n)}async retryAll(){let e=await this.#y();return this.emit("complete",e),e}cancelAll(){this.emit("cancel-all");let{files:e}=this.getState(),i=Object.keys(e);i.length&&this.removeFiles(i),this.setState(Ip)}retryUpload(e){this.setFileState(e,{error:null,isPaused:!1}),this.emit("upload-retry",this.getFile(e));let i=this.#g([e],{forceAllowNewUpload:!0});return this.#x(i)}logout(){this.iteratePlugins(e=>{e.provider?.logout?.()})}#E=(e,i)=>{let n=e?this.getFile(e.id):void 0;if(e==null||!n){this.log(`Not setting progress for a file that has been removed: ${e?.id}`);return}if(n.progress.percentage===100){this.log(`Not setting progress for a file that has been already uploaded: ${e.id}`);return}let r={bytesTotal:i.bytesTotal,percentage:i.bytesTotal!=null&&Number.isFinite(i.bytesTotal)&&i.bytesTotal>0?Math.round(i.bytesUploaded/i.bytesTotal*100):void 0};n.progress.uploadStarted!=null?this.setFileState(e.id,{progress:k(w(w({},n.progress),r),{bytesUploaded:i.bytesUploaded})}):this.setFileState(e.id,{progress:w(w({},n.progress),r)}),this.#v()};#S(){let e=this.#P(),i=null;e!=null&&(i=Math.round(e*100),i>100?i=100:i<0&&(i=0)),this.emit("progress",i??0),this.setState({totalProgress:i??0})}#v=(0,WP.default)(()=>this.#S(),500,{leading:!0,trailing:!0});[Symbol.for("uppy test: updateTotalProgress")](){return this.#S()}#P(){let i=this.getFiles().filter(l=>l.progress.uploadStarted||l.progress.preprocess||l.progress.postprocess);if(i.length===0)return 0;if(i.every(l=>l.progress.uploadComplete))return 1;let n=l=>l.progress.bytesTotal!=null&&l.progress.bytesTotal!==0,r=i.filter(n),o=i.filter(l=>!n(l));if(r.every(l=>l.progress.uploadComplete)&&o.length>0&&!o.every(l=>l.progress.uploadComplete))return null;let s=r.reduce((l,c)=>l+(c.progress.bytesTotal??0),0),a=r.reduce((l,c)=>l+(c.progress.bytesUploaded||0),0);return s===0?0:a/s}#C(){let e=(r,o,s)=>{let a=r.message||"Unknown error";r.details&&(a+=` ${r.details}`),this.setState({error:a}),o!=null&&o.id in this.getState().files&&this.setFileState(o.id,{error:a,response:s})};this.on("error",e),this.on("upload-error",(r,o,s)=>{if(e(o,r,s),typeof o=="object"&&o.message){this.log(o.message,"error");let a=new Error(this.i18n("failedToUpload",{file:r?.name??""}));a.isUserFacing=!0,a.details=o.message,o.details&&(a.details+=` ${o.details}`),this.#a([a])}else this.#a([o])});let i=null;this.on("upload-stalled",(r,o)=>{let{message:s}=r,a=o.map(l=>l.meta.name).join(", ");i||(this.info({message:s,details:a},"warning",this.opts.infoTimeout),i=setTimeout(()=>{i=null},this.opts.infoTimeout)),this.log(`${s} ${a}`.trim(),"warning")}),this.on("upload",()=>{this.setState({error:null})});let n=r=>{let o=r.filter(a=>{let l=a!=null&&this.getFile(a.id);return l||this.log(`Not setting progress for a file that has been removed: ${a?.id}`),l}),s=Object.fromEntries(o.map(a=>[a.id,{progress:{uploadStarted:Date.now(),uploadComplete:!1,bytesUploaded:0,bytesTotal:a.size}}]));this.patchFilesState(s)};this.on("upload-start",n),this.on("upload-progress",this.#E),this.on("upload-success",(r,o)=>{if(r==null||!this.getFile(r.id)){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}let s=this.getFile(r.id).progress;this.setFileState(r.id,{progress:k(w({},s),{postprocess:this.#s.size>0?{mode:"indeterminate"}:void 0,uploadComplete:!0,percentage:100,bytesUploaded:s.bytesTotal}),response:o,uploadURL:o.uploadURL,isPaused:!1}),r.size==null&&this.setFileState(r.id,{size:o.bytesUploaded||s.bytesTotal}),this.#v()}),this.on("preprocess-progress",(r,o)=>{if(r==null||!this.getFile(r.id)){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}this.setFileState(r.id,{progress:k(w({},this.getFile(r.id).progress),{preprocess:o})})}),this.on("preprocess-complete",r=>{if(r==null||!this.getFile(r.id)){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}let o=w({},this.getState().files);o[r.id]=k(w({},o[r.id]),{progress:w({},o[r.id].progress)}),delete o[r.id].progress.preprocess,this.setState({files:o})}),this.on("postprocess-progress",(r,o)=>{if(r==null||!this.getFile(r.id)){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}this.setFileState(r.id,{progress:k(w({},this.getState().files[r.id].progress),{postprocess:o})})}),this.on("postprocess-complete",r=>{if(r==null||!this.getFile(r.id)){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}let o=w({},this.getState().files);o[r.id]=k(w({},o[r.id]),{progress:w({},o[r.id].progress)}),delete o[r.id].progress.postprocess,this.setState({files:o})}),this.on("restored",()=>{this.#v()}),this.on("dashboard:file-edit-complete",r=>{r&&this.#o(r)}),typeof window<"u"&&window.addEventListener&&(window.addEventListener("online",this.#f),window.addEventListener("offline",this.#f),setTimeout(this.#f,3e3))}updateOnlineStatus(){window.navigator.onLine??!0?(this.emit("is-online"),this.wasOffline&&(this.emit("back-online"),this.info(this.i18n("connectedToInternet"),"success",3e3),this.wasOffline=!1)):(this.emit("is-offline"),this.info(this.i18n("noInternetConnection"),"error",0),this.wasOffline=!0)}#f=this.updateOnlineStatus.bind(this);getID(){return this.opts.id}use(e,...i){if(typeof e!="function"){let s=`Expected a plugin class, but got ${e===null?"null":typeof e}. Please verify that the plugin was imported and spelled correctly.`;throw new TypeError(s)}let n=new e(this,...i),r=n.id;if(!r)throw new Error("Your plugin must have an id");if(!n.type)throw new Error("Your plugin must have a type");let o=this.getPlugin(r);if(o){let s=`Already found a plugin named '${o.id}'. Tried to use: '${r}'.
Uppy plugins must have unique \`id\` options.`;throw new Error(s)}return e.VERSION&&this.log(`Using ${r} v${e.VERSION}`),n.type in this.#e?this.#e[n.type].push(n):this.#e[n.type]=[n],n.install(),this.emit("plugin-added",n),this}getPlugin(e){for(let i of Object.values(this.#e)){let n=i.find(r=>r.id===e);if(n!=null)return n}}[Symbol.for("uppy test: getPlugins")](e){return this.#e[e]}iteratePlugins(e){Object.values(this.#e).flat(1).forEach(e)}removePlugin(e){this.log(`Removing plugin ${e.id}`),this.emit("plugin-remove",e),e.uninstall&&e.uninstall();let i=this.#e[e.type],n=i.findIndex(s=>s.id===e.id);n!==-1&&i.splice(n,1);let r=this.getState(),o={plugins:k(w({},r.plugins),{[e.id]:void 0})};this.setState(o)}destroy(){this.log(`Closing Uppy instance ${this.opts.id}: removing all files and uninstalling plugins`),this.cancelAll(),this.#i(),this.iteratePlugins(e=>{this.removePlugin(e)}),typeof window<"u"&&window.removeEventListener&&(window.removeEventListener("online",this.#f),window.removeEventListener("offline",this.#f))}hideInfo(){let{info:e}=this.getState();this.setState({info:e.slice(1)}),this.emit("info-hidden")}info(e,i="info",n=3e3){let r=typeof e=="object";this.setState({info:[...this.getState().info,{type:i,message:r?e.message:e,details:r?e.details:null}]}),setTimeout(()=>this.hideInfo(),n),this.emit("info-visible")}log(e,i){let{logger:n}=this.opts;switch(i){case"error":n.error(e);break;case"warning":n.warn(e);break;default:n.debug(e);break}}#w=new Map;registerRequestClient(e,i){this.#w.set(e,i)}getRequestClientForFile(e){if(!e.remote)throw new Error(`Tried to get RequestClient for a non-remote file ${e.id}`);let i=this.#w.get(e.remote.requestClientId);if(i==null)throw new Error(`requestClientId "${e.remote.requestClientId}" not registered for file "${e.id}"`);return i}async restore(e){if(this.log(`Core: attempting to restore upload "${e}"`),!this.getState().currentUploads[e])throw this.#m(e),new Error("Nonexistent upload");let i=await this.#x(e);return this.emit("complete",i),i}#g(e,i={}){let{forceAllowNewUpload:n=!1}=i,{allowNewUpload:r,currentUploads:o}=this.getState();if(!r&&!n)throw new Error("Cannot create a new upload: already uploading.");let s=Jo();return this.emit("upload",s,this.getFilesByIds(e)),this.setState({allowNewUpload:this.opts.allowMultipleUploadBatches!==!1&&this.opts.allowMultipleUploads!==!1,currentUploads:k(w({},o),{[s]:{fileIDs:e,step:0,result:{}}})}),s}[Symbol.for("uppy test: createUpload")](...e){return this.#g(...e)}#R(e){let{currentUploads:i}=this.getState();return i[e]}addResultData(e,i){if(!this.#R(e)){this.log(`Not setting result for an upload that has been removed: ${e}`);return}let{currentUploads:n}=this.getState(),r=k(w({},n[e]),{result:w(w({},n[e].result),i)});this.setState({currentUploads:k(w({},n),{[e]:r})})}#m(e){let i=w({},this.getState().currentUploads);delete i[e],this.setState({currentUploads:i})}async#x(e){let i=()=>{let{currentUploads:s}=this.getState();return s[e]},n=i(),r=[...this.#r,...this.#c,...this.#s];try{for(let s=n.step||0;s<r.length&&n;s++){let a=r[s];this.setState({currentUploads:k(w({},this.getState().currentUploads),{[e]:k(w({},n),{step:s})})});let{fileIDs:l}=n;await a(l,e),n=i()}}catch(s){throw this.#m(e),s}if(n){n.fileIDs.forEach(c=>{let d=this.getFile(c);d?.progress.postprocess&&this.emit("postprocess-complete",d)});let s=n.fileIDs.map(c=>this.getFile(c)),a=s.filter(c=>!c.error),l=s.filter(c=>c.error);this.addResultData(e,{successful:a,failed:l,uploadID:e}),n=i()}let o;return n&&(o=n.result,this.#m(e)),o==null&&(this.log(`Not setting result for an upload that has been removed: ${e}`),o={successful:[],failed:[],uploadID:e}),o}async upload(){this.#e.uploader?.length||this.log("No uploader type plugins are used","warning");let{files:e}=this.getState();if(this.#b().length>0){let r=await this.#y();if(!(this.getFiles().filter(s=>s.progress.uploadStarted==null).length>0))return this.emit("complete",r),r;({files:e}=this.getState())}let n=this.opts.onBeforeUpload(e);return n===!1?Promise.reject(new Error("Not starting the upload because onBeforeUpload returned false")):(n&&typeof n=="object"&&(e=n,this.setState({files:e})),Promise.resolve().then(()=>this.#t.validateMinNumberOfFiles(e)).catch(r=>{throw this.#a([r]),r}).then(()=>{if(!this.#p(e))throw new Ui(this.i18n("missingRequiredMetaField"))}).catch(r=>{throw r}).then(async()=>{let{currentUploads:r}=this.getState(),o=Object.values(r).flatMap(c=>c.fileIDs),s=[];Object.keys(e).forEach(c=>{let d=this.getFile(c);!d.progress.uploadStarted&&o.indexOf(c)===-1&&s.push(d.id)});let a=this.#g(s),l=await this.#x(a);return this.emit("complete",l),l}).catch(r=>{throw this.emit("error",r),this.log(r,"error"),r}))}},Ap=bC;var $P=nt(jP(),1);var qP={strings:{compressingImages:"Compressing images...",compressedX:"Saved %{size} by compressing images"}};var R9={quality:.6,limit:10},Op=class extends Zr{#e;constructor(e,i){super(e,w(w({},R9),i)),this.id=this.opts.id||"Compressor",this.type="modifier",this.defaultLocale=qP,this.#e=new Vs(this.opts.limit),this.i18nInit(),this.prepareUpload=this.prepareUpload.bind(this),this.compress=this.compress.bind(this)}compress(e){return new Promise((i,n)=>{new $P.default(e,k(w({},this.opts),{success:i,error:n}))})}async prepareUpload(e){let i=0,n=[],r=this.#e.wrapPromiseFunction(async s=>{try{let a=await this.compress(s.data),l=s.data.size-a.size;this.uppy.log(`[Image Compressor] Image ${s.id} compressed by ${(0,xC.default)(l)}`),i+=l;let{name:c,type:d,size:u}=a,h=Yn(c),f=`${Yn(s.meta.name).name}.${h.extension}`;this.uppy.setFileState(s.id,k(w(w(w(w({},c&&{name:c}),h.extension&&{extension:h.extension}),d&&{type:d}),u&&{size:u}),{data:a,meta:k(w({},s.meta),{type:d,name:f})})),n.push(s)}catch(a){this.uppy.log(`[Image Compressor] Failed to compress ${s.id}:`,"warning"),this.uppy.log(a,"warning")}}),o=e.map(s=>{let a=this.uppy.getFile(s);return this.uppy.emit("preprocess-progress",a,{mode:"indeterminate",message:this.i18n("compressingImages")}),a.isRemote||(a.data.type||(a.data=a.data.slice(0,a.data.size,a.type)),!a.type?.startsWith("image/"))?Promise.resolve():r(a)});await Promise.all(o),this.uppy.emit("compressor:complete",n),i>1024&&this.uppy.info(this.i18n("compressedX",{size:(0,xC.default)(i)}),"info");for(let s of e){let a=this.uppy.getFile(s);this.uppy.emit("preprocess-complete",a)}}install(){this.uppy.addPreProcessor(this.prepareUpload)}uninstall(){this.uppy.removePreProcessor(this.prepareUpload)}};function _9(){return y("svg",{width:"26",height:"26",viewBox:"0 0 26 26",xmlns:"http://www.w3.org/2000/svg",children:y("g",{fill:"none","fill-rule":"evenodd",children:[y("circle",{fill:"#FFF",cx:"13",cy:"13",r:"13"}),y("path",{d:"M21.64 13.205c0-.639-.057-1.252-.164-1.841H13v3.481h4.844a4.14 4.14 0 01-1.796 2.716v2.259h2.908c1.702-1.567 2.684-3.875 2.684-6.615z",fill:"#4285F4","fill-rule":"nonzero"}),y("path",{d:"M13 22c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H4.957v2.332A8.997 8.997 0 0013 22z",fill:"#34A853","fill-rule":"nonzero"}),y("path",{d:"M7.964 14.71A5.41 5.41 0 017.682 13c0-.593.102-1.17.282-1.71V8.958H4.957A8.996 8.996 0 004 13c0 1.452.348 2.827.957 4.042l3.007-2.332z",fill:"#FBBC05","fill-rule":"nonzero"}),y("path",{d:"M13 7.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C17.463 4.891 15.426 4 13 4a8.997 8.997 0 00-8.043 4.958l3.007 2.332C8.672 9.163 10.656 7.58 13 7.58z",fill:"#EA4335","fill-rule":"nonzero"}),y("path",{d:"M4 4h18v18H4z"})]})})}function k9({pluginName:t,i18n:e,onAuth:i}){let n=t==="Google Drive",r=Jn(o=>{o.preventDefault(),i()},[i]);return y("form",{onSubmit:r,children:n?y("button",{type:"submit",className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Provider-authBtn uppy-Provider-btn-google","data-uppy-super-focusable":!0,children:[y(_9,{}),e("signInWithGoogle")]}):y("button",{type:"submit",className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Provider-authBtn","data-uppy-super-focusable":!0,children:e("authenticateWith",{pluginName:t})})})}var F9=({pluginName:t,i18n:e,onAuth:i})=>y(k9,{pluginName:t,i18n:e,onAuth:i});function EC({loading:t,pluginName:e,pluginIcon:i,i18n:n,handleAuth:r,renderForm:o=F9}){return y("div",{className:"uppy-Provider-auth",children:[y("div",{className:"uppy-Provider-authIcon",children:i()}),y("div",{className:"uppy-Provider-authTitle",children:n("authenticateWithTitle",{pluginName:e})}),o({pluginName:e,i18n:n,loading:t,onAuth:r})]})}var vR=nt(ji(),1);var KP={name:"@uppy/provider-views",description:"View library for Uppy remote provider plugins.",version:"5.0.2",license:"MIT",style:"dist/style.min.css",type:"module",sideEffects:["*.css"],scripts:{build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","uppy"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],exports:{".":"./lib/index.js","./css/style.min.css":"./dist/style.min.css","./css/style.css":"./dist/style.css","./css/style.scss":"./src/style.scss","./package.json":"./package.json"},dependencies:{"@uppy/utils":"^7.0.2",classnames:"^2.2.6",nanoid:"^5.0.9","p-queue":"^8.0.0",preact:"^10.5.13"},devDependencies:{"@types/gapi":"^0.0.47","@types/google.accounts":"^0.0.14","@types/google.picker":"^0.0.42",cssnano:"^7.0.7",jsdom:"^26.1.0",postcss:"^8.5.6","postcss-cli":"^11.0.1",sass:"^1.89.2",typescript:"^5.8.3",vitest:"^3.2.4"},peerDependencies:{"@uppy/core":"^5.0.2"}};var YP=nt(ji(),1);function D9(){return y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:11,height:14.5,viewBox:"0 0 44 58",children:y("path",{d:"M27.437.517a1 1 0 0 0-.094.03H4.25C2.037.548.217 2.368.217 4.58v48.405c0 2.212 1.82 4.03 4.03 4.03H39.03c2.21 0 4.03-1.818 4.03-4.03V15.61a1 1 0 0 0-.03-.28 1 1 0 0 0 0-.093 1 1 0 0 0-.03-.032 1 1 0 0 0 0-.03 1 1 0 0 0-.032-.063 1 1 0 0 0-.03-.063 1 1 0 0 0-.032 0 1 1 0 0 0-.03-.063 1 1 0 0 0-.032-.03 1 1 0 0 0-.03-.063 1 1 0 0 0-.063-.062l-14.593-14a1 1 0 0 0-.062-.062A1 1 0 0 0 28 .708a1 1 0 0 0-.374-.157 1 1 0 0 0-.156 0 1 1 0 0 0-.03-.03l-.003-.003zM4.25 2.547h22.218v9.97c0 2.21 1.82 4.03 4.03 4.03h10.564v36.438a2.02 2.02 0 0 1-2.032 2.032H4.25c-1.13 0-2.032-.9-2.032-2.032V4.58c0-1.13.902-2.032 2.03-2.032zm24.218 1.345l10.375 9.937.75.718H30.5c-1.13 0-2.032-.9-2.032-2.03V3.89z"})})}function M9(){return y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",style:{minWidth:16,marginRight:3},viewBox:"0 0 276.157 276.157",children:y("path",{d:"M273.08 101.378c-3.3-4.65-8.86-7.32-15.254-7.32h-24.34V67.59c0-10.2-8.3-18.5-18.5-18.5h-85.322c-3.63 0-9.295-2.875-11.436-5.805l-6.386-8.735c-4.982-6.814-15.104-11.954-23.546-11.954H58.73c-9.292 0-18.638 6.608-21.737 15.372l-2.033 5.752c-.958 2.71-4.72 5.37-7.596 5.37H18.5C8.3 49.09 0 57.39 0 67.59v167.07c0 .886.16 1.73.443 2.52.152 3.306 1.18 6.424 3.053 9.064 3.3 4.652 8.86 7.32 15.255 7.32h188.487c11.395 0 23.27-8.425 27.035-19.18l40.677-116.188c2.11-6.035 1.43-12.164-1.87-16.816zM18.5 64.088h8.864c9.295 0 18.64-6.607 21.738-15.37l2.032-5.75c.96-2.712 4.722-5.373 7.597-5.373h29.565c3.63 0 9.295 2.876 11.437 5.806l6.386 8.735c4.982 6.815 15.104 11.954 23.546 11.954h85.322c1.898 0 3.5 1.602 3.5 3.5v26.47H69.34c-11.395 0-23.27 8.423-27.035 19.178L15 191.23V67.59c0-1.898 1.603-3.5 3.5-3.5zm242.29 49.15l-40.676 116.188c-1.674 4.78-7.812 9.135-12.877 9.135H18.75c-1.447 0-2.576-.372-3.02-.997-.442-.625-.422-1.814.057-3.18l40.677-116.19c1.674-4.78 7.812-9.134 12.877-9.134h188.487c1.448 0 2.577.372 3.02.997.443.625.423 1.814-.056 3.18z"})})}function I9(){return y("svg",{"aria-hidden":"true",focusable:"false",style:{width:16,marginRight:4},viewBox:"0 0 58 58",children:[y("path",{d:"M36.537 28.156l-11-7a1.005 1.005 0 0 0-1.02-.033C24.2 21.3 24 21.635 24 22v14a1 1 0 0 0 1.537.844l11-7a1.002 1.002 0 0 0 0-1.688zM26 34.18V23.82L34.137 29 26 34.18z"}),y("path",{d:"M57 6H1a1 1 0 0 0-1 1v44a1 1 0 0 0 1 1h56a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1zM10 28H2v-9h8v9zm-8 2h8v9H2v-9zm10 10V8h34v42H12V40zm44-12h-8v-9h8v9zm-8 2h8v9h-8v-9zm8-22v9h-8V8h8zM2 8h8v9H2V8zm0 42v-9h8v9H2zm54 0h-8v-9h8v9z"})]})}function ul({itemIconString:t,alt:e=void 0}){if(t===null)return null;switch(t){case"file":return y(D9,{});case"folder":return y(M9,{});case"video":return y(I9,{});default:return y("img",{src:t,alt:e,referrerPolicy:"no-referrer",loading:"lazy",width:16,height:16})}}function A9({file:t,toggleCheckbox:e,className:i,isDisabled:n,restrictionError:r,showTitles:o,children:s=null,i18n:a}){return y("li",{className:i,title:n&&r?r:void 0,children:[y("input",{type:"checkbox",className:"uppy-u-reset uppy-ProviderBrowserItem-checkbox uppy-ProviderBrowserItem-checkbox--grid",onChange:e,name:"listitem",id:t.id,checked:t.status==="checked",disabled:n,"data-uppy-super-focusable":!0}),y("label",{htmlFor:t.id,"aria-label":t.data.name??a("unnamed"),className:"uppy-u-reset uppy-ProviderBrowserItem-inner",children:[y(ul,{itemIconString:t.data.thumbnail||t.data.icon}),o&&(t.data.name??a("unnamed")),s]})]})}var PC=A9;function RC({file:t,openFolder:e,className:i,isDisabled:n,restrictionError:r,toggleCheckbox:o,showTitles:s,i18n:a}){return y("li",{className:i,title:t.status!=="checked"&&r?r:void 0,children:[y("input",{type:"checkbox",className:"uppy-u-reset uppy-ProviderBrowserItem-checkbox",onChange:o,name:"listitem",id:t.id,checked:t.status==="checked","aria-label":t.data.isFolder?a("allFilesFromFolderNamed",{name:t.data.name??a("unnamed")}):null,disabled:n,"data-uppy-super-focusable":!0}),t.data.isFolder?y("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-ProviderBrowserItem-inner",onClick:()=>e(t.id),"aria-label":a("openFolderNamed",{name:t.data.name??a("unnamed")}),children:[y("div",{className:"uppy-ProviderBrowserItem-iconWrap",children:y(ul,{itemIconString:t.data.icon})}),s&&t.data.name?y("span",{children:t.data.name}):a("unnamed")]}):y("label",{htmlFor:t.id,className:"uppy-u-reset uppy-ProviderBrowserItem-inner",children:[y("div",{className:"uppy-ProviderBrowserItem-iconWrap",children:y(ul,{itemIconString:t.data.icon})}),s&&(t.data.name??a("unnamed"))]})]})}function _C(t){let{viewType:e,toggleCheckbox:i,showTitles:n,i18n:r,openFolder:o,file:s,utmSource:a}=t,l=s.type==="folder"?null:s.restrictionError,c=!!l&&s.status!=="checked",d={file:s,openFolder:o,toggleCheckbox:i,utmSource:a,i18n:r,viewType:e,showTitles:n,className:(0,YP.default)("uppy-ProviderBrowserItem",{"uppy-ProviderBrowserItem--disabled":c},{"uppy-ProviderBrowserItem--noPreview":s.data.icon==="video"},{"uppy-ProviderBrowserItem--is-checked":s.status==="checked"},{"uppy-ProviderBrowserItem--is-partial":s.status==="partial"}),isDisabled:c,restrictionError:l};switch(e){case"grid":return y(PC,w({},d));case"list":return y(RC,w({},d));case"unsplash":return y(PC,k(w({},d),{children:y("a",{href:`${s.data.author.url}?utm_source=${a}&utm_medium=referral`,target:"_blank",rel:"noopener noreferrer",className:"uppy-ProviderBrowserItem-author",tabIndex:-1,children:s.data.author.name})}));default:throw new Error(`There is no such type ${e}`)}}function O9(t){let{displayedPartialTree:e,viewType:i,toggleCheckbox:n,handleScroll:r,showTitles:o,i18n:s,isLoading:a,openFolder:l,noResultsLabel:c,virtualList:d,utmSource:u}=t,[h,p]=nn(!1);if(Xn(()=>{let g=v=>{v.key==="Shift"&&p(!1)},m=v=>{v.key==="Shift"&&p(!0)};return document.addEventListener("keyup",g),document.addEventListener("keydown",m),()=>{document.removeEventListener("keyup",g),document.removeEventListener("keydown",m)}},[]),a)return y("div",{className:"uppy-Provider-loading",children:typeof a=="string"?a:s("loading")});if(e.length===0)return y("div",{className:"uppy-Provider-empty",children:c});let f=g=>y(_C,{viewType:i,toggleCheckbox:m=>{m.stopPropagation(),m.preventDefault(),document.getSelection()?.removeAllRanges(),n(g,h)},showTitles:o,i18n:s,openFolder:l,file:g,utmSource:u},g.id);return d?y("div",{className:"uppy-ProviderBrowser-body",children:y(dl,{className:"uppy-ProviderBrowser-list",data:e,renderRow:f,rowHeight:35.5})}):y("div",{className:"uppy-ProviderBrowser-body",children:y("ul",{className:"uppy-ProviderBrowser-list",onScroll:r,tabIndex:-1,children:e.map(f)})})}var XP=O9;var JP=nt(ji(),1);var L9=t=>t.filter(i=>i.type==="file"&&i.status==="checked"?!0:i.type==="folder"&&i.status==="checked"?!t.some(r=>r.type!=="root"&&r.parentId===i.id):!1).length,Np=L9;function kC({cancelSelection:t,donePicking:e,i18n:i,partialTree:n,validateAggregateRestrictions:r}){let o=Us(()=>r(n),[n,r]),s=Us(()=>Np(n),[n]);return s===0?null:y("div",{className:"uppy-ProviderBrowser-footer",children:[y("div",{className:"uppy-ProviderBrowser-footer-buttons",children:[y("button",{className:(0,JP.default)("uppy-u-reset uppy-c-btn uppy-c-btn-primary",{"uppy-c-btn--disabled":o}),disabled:!!o,onClick:e,type:"button",children:i("selectX",{smart_count:s})}),y("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-link",onClick:t,type:"button",children:i("cancel")})]}),o&&y("div",{className:"uppy-ProviderBrowser-footer-error",children:o})]})}function N9({searchString:t,setSearchString:e,submitSearchString:i,wrapperClassName:n,inputClassName:r,inputLabel:o,clearSearchLabel:s="",showButton:a=!1,buttonLabel:l="",buttonCSSClassName:c=""}){let d=p=>{e(p.target.value)},u=Jn(p=>{p.preventDefault(),i()},[i]),[h]=nn(()=>{let p=document.createElement("form");return p.setAttribute("tabindex","-1"),p.id=Jo(),p});return Xn(()=>(document.body.appendChild(h),h.addEventListener("submit",u),()=>{h.removeEventListener("submit",u),document.body.removeChild(h)}),[h,u]),y("section",{className:n,children:[y("input",{className:`uppy-u-reset ${r}`,type:"search","aria-label":o,placeholder:o,value:t,onInput:d,form:h.id,"data-uppy-super-focusable":!0}),!a&&y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-ProviderBrowser-searchFilterIcon",width:"12",height:"12",viewBox:"0 0 12 12",children:y("path",{d:"M8.638 7.99l3.172 3.172a.492.492 0 1 1-.697.697L7.91 8.656a4.977 4.977 0 0 1-2.983.983C2.206 9.639 0 7.481 0 4.819 0 2.158 2.206 0 4.927 0c2.721 0 4.927 2.158 4.927 4.82a4.74 4.74 0 0 1-1.216 3.17zm-3.71.685c2.176 0 3.94-1.726 3.94-3.856 0-2.129-1.764-3.855-3.94-3.855C2.75.964.984 2.69.984 4.819c0 2.13 1.765 3.856 3.942 3.856z"})}),!a&&t&&y("button",{className:"uppy-u-reset uppy-ProviderBrowser-searchFilterReset",type:"button","aria-label":s,title:s,onClick:()=>e(""),children:y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",viewBox:"0 0 19 19",children:y("path",{d:"M17.318 17.232L9.94 9.854 9.586 9.5l-.354.354-7.378 7.378h.707l-.62-.62v.706L9.318 9.94l.354-.354-.354-.354L1.94 1.854v.707l.62-.62h-.706l7.378 7.378.354.354.354-.354 7.378-7.378h-.707l.622.62v-.706L9.854 9.232l-.354.354.354.354 7.378 7.378.708-.707-7.38-7.378v.708l7.38-7.38.353-.353-.353-.353-.622-.622-.353-.353-.354.352-7.378 7.38h.708L2.56 1.23 2.208.88l-.353.353-.622.62-.353.355.352.353 7.38 7.38v-.708l-7.38 7.38-.353.353.352.353.622.622.353.353.354-.353 7.38-7.38h-.708l7.38 7.38z"})})}),a&&y("button",{className:`uppy-u-reset uppy-c-btn uppy-c-btn-primary ${c}`,type:"submit",form:h.id,children:l})]})}var QP=N9;var B9=(t,e,i)=>({id:t.id,source:e.id,name:t.name||t.id,type:t.mimeType,isRemote:!0,data:t,preview:t.thumbnail||void 0,meta:{authorName:t.author?.name,authorUrl:t.author?.url,relativePath:t.relDirPath||null,absolutePath:t.absDirPath},body:{fileId:t.id},remote:{companionUrl:e.opts.companionUrl,url:`${i.fileUrl(t.requestPath)}`,body:{fileId:t.id},providerName:i.name,provider:i.provider,requestClientId:i.provider}}),ZP=B9;var H9=(t,e,i)=>{let n=t.map(s=>ZP(s,e,i)),r=[],o=[];n.forEach(s=>{e.uppy.checkIfFileAlreadyExists(pd(s,e.uppy.getID()))?o.push(s):r.push(s)}),r.length>0&&e.uppy.info(e.uppy.i18n("addedNumFiles",{numFiles:r.length})),o.length>0&&e.uppy.info(`Not adding ${o.length} files because they already exist`),e.uppy.addFiles(r)},eR=H9;var z9=(t,e,i,n)=>{let r=e.findIndex(o=>o.id===n);if(r!==-1&&i){let o=e.findIndex(a=>a.id===t);return e.slice(Math.min(r,o),Math.max(r,o)+1).map(a=>a.id)}return[t]},tR=z9;var V9=t=>e=>{if(!e.isAuthError){if(e.name==="AbortError"){t.log("Aborting request","warning");return}t.log(e,"error"),e.name==="UserFacingApiError"&&t.info({message:t.i18n("companionError"),details:t.i18n(e.message)},"warning",5e3)}},hl=V9;var G9=(t,e)=>{let i=t.find(r=>r.id===e),n=[];for(;n=[i,...n],i.type!=="root";){let r=i.parentId;i=t.find(o=>o.id===r)}return n},iR=G9;var nR=(t,e,i)=>{let n=e===null?"null":e;if(i[n])return i[n];let r=t.find(s=>s.id===e);if(r.type==="root")return[];let o=[...nR(t,r.parentId,i),r];return i[n]=o,o},W9=t=>{let e=Object.create(null);return t.filter(r=>r.type==="file"&&r.status==="checked").map(r=>{let o=nR(t,r.id,e),s=o.findIndex(d=>d.type==="folder"&&d.status==="checked"),a=o.slice(s),l=`/${o.map(d=>d.data.name).join("/")}`,c=a.length===1?void 0:a.map(d=>d.data.name).join("/");return k(w({},r.data),{absDirPath:l,relDirPath:c})})},rR=W9;var TC=nt(sR(),1);var Fd=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},DC=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}},aR=t=>globalThis.DOMException===void 0?new DC(t):new DOMException(t),lR=t=>{let e=t.reason===void 0?aR("This operation was aborted."):t.reason;return e instanceof Error?e:aR(e)};function MC(t,e){let{milliseconds:i,fallback:n,message:r,customTimers:o={setTimeout,clearTimeout}}=e,s,a,c=new Promise((d,u)=>{if(typeof i!="number"||Math.sign(i)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${i}\``);if(e.signal){let{signal:p}=e;p.aborted&&u(lR(p)),a=()=>{u(lR(p))},p.addEventListener("abort",a,{once:!0})}if(i===Number.POSITIVE_INFINITY){t.then(d,u);return}let h=new Fd;s=o.setTimeout.call(void 0,()=>{if(n){try{d(n())}catch(p){u(p)}return}typeof t.cancel=="function"&&t.cancel(),r===!1?d():r instanceof Error?u(r):(h.message=r??`Promise timed out after ${i} milliseconds`,u(h))},i),(async()=>{try{d(await t)}catch(p){u(p)}})()}).finally(()=>{c.clear(),a&&e.signal&&e.signal.removeEventListener("abort",a)});return c.clear=()=>{o.clearTimeout.call(void 0,s),s=void 0},c}function IC(t,e,i){let n=0,r=t.length;for(;r>0;){let o=Math.trunc(r/2),s=n+o;i(t[s],e)<=0?(n=++s,r-=o+1):r=o}return n}var Hp=class{#e=[];enqueue(e,i){i=w({priority:0},i);let n={priority:i.priority,id:i.id,run:e};if(this.size===0||this.#e[this.size-1].priority>=i.priority){this.#e.push(n);return}let r=IC(this.#e,n,(o,s)=>s.priority-o.priority);this.#e.splice(r,0,n)}setPriority(e,i){let n=this.#e.findIndex(o=>o.id===e);if(n===-1)throw new ReferenceError(`No promise function with the id "${e}" exists in the queue.`);let[r]=this.#e.splice(n,1);this.enqueue(r.run,{priority:i,id:e})}dequeue(){return this.#e.shift()?.run}filter(e){return this.#e.filter(i=>i.priority===e.priority).map(i=>i.run)}get size(){return this.#e.length}};var zp=class extends TC.default{#e;#t;#i=0;#n;#r;#c=0;#s;#a;#o;#p;#l=0;#u;#d;#h;#b=1n;timeout;constructor(e){if(super(),e=w({carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Hp},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${e.intervalCap?.toString()??""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${e.interval?.toString()??""}\` (${typeof e.interval})`);this.#e=e.carryoverConcurrencyCount,this.#t=e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,this.#n=e.intervalCap,this.#r=e.interval,this.#o=new e.queueClass,this.#p=e.queueClass,this.concurrency=e.concurrency,this.timeout=e.timeout,this.#h=e.throwOnTimeout===!0,this.#d=e.autoStart===!1}get#y(){return this.#t||this.#i<this.#n}get#E(){return this.#l<this.#u}#S(){this.#l--,this.#C(),this.emit("next")}#v(){this.#w(),this.#f(),this.#a=void 0}get#P(){let e=Date.now();if(this.#s===void 0){let i=this.#c-e;if(i<0)this.#i=this.#e?this.#l:0;else return this.#a===void 0&&(this.#a=setTimeout(()=>{this.#v()},i)),!0}return!1}#C(){if(this.#o.size===0)return this.#s&&clearInterval(this.#s),this.#s=void 0,this.emit("empty"),this.#l===0&&this.emit("idle"),!1;if(!this.#d){let e=!this.#P;if(this.#y&&this.#E){let i=this.#o.dequeue();return i?(this.emit("active"),i(),e&&this.#f(),!0):!1}}return!1}#f(){this.#t||this.#s!==void 0||(this.#s=setInterval(()=>{this.#w()},this.#r),this.#c=Date.now()+this.#r)}#w(){this.#i===0&&this.#l===0&&this.#s&&(clearInterval(this.#s),this.#s=void 0),this.#i=this.#e?this.#l:0,this.#g()}#g(){for(;this.#C(););}get concurrency(){return this.#u}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this.#u=e,this.#g()}async#R(e){return new Promise((i,n)=>{e.addEventListener("abort",()=>{n(e.reason)},{once:!0})})}setPriority(e,i){this.#o.setPriority(e,i)}async add(e,i={}){return i.id??=(this.#b++).toString(),i=w({timeout:this.timeout,throwOnTimeout:this.#h},i),new Promise((n,r)=>{this.#o.enqueue(async()=>{this.#l++;try{i.signal?.throwIfAborted(),this.#i++;let o=e({signal:i.signal});i.timeout&&(o=MC(Promise.resolve(o),{milliseconds:i.timeout})),i.signal&&(o=Promise.race([o,this.#R(i.signal)]));let s=await o;n(s),this.emit("completed",s)}catch(o){if(o instanceof Fd&&!i.throwOnTimeout){n();return}r(o),this.emit("error",o)}finally{this.#S()}},i),this.emit("add"),this.#C()})}async addAll(e,i){return Promise.all(e.map(async n=>this.add(n,i)))}start(){return this.#d?(this.#d=!1,this.#g(),this):this}pause(){this.#d=!0}clear(){this.#o=new this.#p}async onEmpty(){this.#o.size!==0&&await this.#m("empty")}async onSizeLessThan(e){this.#o.size<e||await this.#m("next",()=>this.#o.size<e)}async onIdle(){this.#l===0&&this.#o.size===0||await this.#m("idle")}async#m(e,i){return new Promise(n=>{let r=()=>{i&&!i()||(this.off(e,r),n())};this.on(e,r)})}get size(){return this.#o.size}sizeBy(e){return this.#o.filter(e).length}get pending(){return this.#l}get isPaused(){return this.#d}};var q9=t=>t.map(e=>w({},e)),Vp=q9;var cR=async(t,e,i,n,r)=>{let o=[],s=i.cached?i.nextPagePath:i.id;for(;s;){let u=await n(s);o=o.concat(u.items),s=u.nextPagePath}let a=o.filter(u=>u.isFolder===!0),l=o.filter(u=>u.isFolder===!1),c=a.map(u=>({type:"folder",id:u.requestPath,cached:!1,nextPagePath:null,status:"checked",parentId:i.id,data:u})),d=l.map(u=>{let h=r(u);return{type:"file",id:u.requestPath,restrictionError:h,status:h?"unchecked":"checked",parentId:i.id,data:u}});i.cached=!0,i.nextPagePath=null,e.push(...d,...c),c.forEach(async u=>{t.add(()=>cR(t,e,u,n,r))})},$9=async(t,e,i,n)=>{let r=new zp({concurrency:6}),o=Vp(t);return o.filter(a=>a.type==="folder"&&a.status==="checked"&&(a.cached===!1||a.nextPagePath)).forEach(a=>{r.add(()=>cR(r,o,a,e,i))}),r.on("completed",()=>{let a=o.filter(l=>l.type==="file"&&l.status==="checked").length;n(a)}),await r.onIdle(),o},dR=$9;var K9=(t,e,i,n,r)=>{let o=e.filter(p=>p.isFolder===!0),s=e.filter(p=>p.isFolder===!1),a=i.type==="folder"&&i.status==="checked",l=o.map(p=>({type:"folder",id:p.requestPath,cached:!1,nextPagePath:null,status:a?"checked":"unchecked",parentId:i.id,data:p})),c=s.map(p=>{let f=r(p);return{type:"file",id:p.requestPath,restrictionError:f,status:a&&!f?"checked":"unchecked",parentId:i.id,data:p}}),d=k(w({},i),{cached:!0,nextPagePath:n});return[...t.map(p=>p.id===d.id?d:p),...l,...c]},uR=K9;var Y9=(t,e,i,n,r)=>{let o=t.find(f=>f.id===e),s=i.filter(f=>f.isFolder===!0),a=i.filter(f=>f.isFolder===!1),l=k(w({},o),{nextPagePath:n}),c=t.map(f=>f.id===l.id?l:f),d=l.type==="folder"&&l.status==="checked",u=s.map(f=>({type:"folder",id:f.requestPath,cached:!1,nextPagePath:null,status:d?"checked":"unchecked",parentId:l.id,data:f})),h=a.map(f=>{let g=r(f);return{type:"file",id:f.requestPath,restrictionError:g,status:d&&!g?"checked":"unchecked",parentId:l.id,data:f}});return[...c,...u,...h]},hR=Y9;var AC=(t,e,i)=>{t.filter(r=>r.type!=="root"&&r.parentId===e).forEach(r=>{r.status=i&&!(r.type==="file"&&r.restrictionError)?"checked":"unchecked",AC(t,r.id,i)})},OC=(t,e)=>{let i=t.find(s=>s.id===e);if(i.type==="root")return;let n=t.filter(s=>s.type!=="root"&&s.parentId===i.id&&!(s.type==="file"&&s.restrictionError)),r=n.every(s=>s.status==="checked"),o=n.every(s=>s.status==="unchecked");r?i.status="checked":o?i.status="unchecked":i.status="partial",OC(t,i.parentId)},X9=(t,e)=>{let i=Vp(t);if(e.length>=2){let n=i.filter(r=>r.type!=="root"&&e.includes(r.id));n.forEach(r=>{r.type==="file"?r.status=r.restrictionError?"unchecked":"checked":r.status="checked"}),n.forEach(r=>{AC(i,r.id,!0)}),OC(i,n[0].parentId)}else{let n=i.find(r=>r.id===e[0]);n.status=n.status==="checked"?"unchecked":"checked",AC(i,n.id,n.status==="checked"),OC(i,n.parentId)}return i},pR=X9;var Td={afterOpenFolder:uR,afterScrollFolder:hR,afterToggleCheckbox:pR,afterFill:dR};var J9=t=>{let{scrollHeight:e,scrollTop:i,offsetHeight:n}=t.target;return e-(i+n)<50},fR=J9;var gR=nt(ji(),1);function LC(t){let{openFolder:e,title:i,breadcrumbsIcon:n,breadcrumbs:r,i18n:o}=t;return y("div",{className:"uppy-Provider-breadcrumbs",children:[y("div",{className:"uppy-Provider-breadcrumbsIcon",children:n}),r.map((s,a)=>y(ei,{children:[y("button",{type:"button",className:"uppy-u-reset uppy-c-btn",onClick:()=>e(s.id),children:s.type==="root"?i:s.data.name??o("unnamed")},s.id),r.length===a+1?"":" / "]}))]})}function NC({i18n:t,logout:e,username:i}){return y(ei,{children:[i&&y("span",{className:"uppy-ProviderBrowser-user",children:i},"username"),y("button",{type:"button",onClick:e,className:"uppy-u-reset uppy-c-btn uppy-ProviderBrowser-userLogout",children:t("logOut")},"logout")]})}function BC(t){return y("div",{className:"uppy-ProviderBrowser-header",children:y("div",{className:(0,gR.default)("uppy-ProviderBrowser-headerBar",!t.showBreadcrumbs&&"uppy-ProviderBrowser-headerBar--simple"),children:[t.showBreadcrumbs&&y(LC,{openFolder:t.openFolder,breadcrumbs:t.breadcrumbs,breadcrumbsIcon:t.pluginIcon?.(),title:t.title,i18n:t.i18n}),y(NC,{logout:t.logout,username:t.username,i18n:t.i18n})]})})}function Dd(){return y("svg",{"aria-hidden":"true",focusable:"false",width:"30",height:"30",viewBox:"0 0 30 30",children:y("path",{d:"M15 30c8.284 0 15-6.716 15-15 0-8.284-6.716-15-15-15C6.716 0 0 6.716 0 15c0 8.284 6.716 15 15 15zm4.258-12.676v6.846h-8.426v-6.846H5.204l9.82-12.364 9.82 12.364H19.26z"})})}var mR=t=>({authenticated:void 0,partialTree:[{type:"root",id:t,cached:!1,nextPagePath:null}],currentFolderId:t,searchString:"",didFirstRender:!1,username:null,loading:!1}),Gp=class{static VERSION=KP.version;plugin;provider;opts;isHandlingScroll=!1;lastCheckbox=null;constructor(e,i){this.plugin=e,this.provider=i.provider;let n={viewType:"list",showTitles:!0,showFilter:!0,showBreadcrumbs:!0,loadAllFiles:!1,virtualList:!1};this.opts=w(w({},n),i),this.openFolder=this.openFolder.bind(this),this.logout=this.logout.bind(this),this.handleAuth=this.handleAuth.bind(this),this.handleScroll=this.handleScroll.bind(this),this.resetPluginState=this.resetPluginState.bind(this),this.donePicking=this.donePicking.bind(this),this.render=this.render.bind(this),this.cancelSelection=this.cancelSelection.bind(this),this.toggleCheckbox=this.toggleCheckbox.bind(this),this.resetPluginState(),this.plugin.uppy.on("dashboard:close-panel",this.resetPluginState),this.plugin.uppy.registerRequestClient(this.provider.provider,this.provider)}resetPluginState(){this.plugin.setPluginState(mR(this.plugin.rootFolderId))}tearDown(){}setLoading(e){this.plugin.setPluginState({loading:e})}cancelSelection(){let{partialTree:e}=this.plugin.getPluginState(),i=e.map(n=>n.type==="root"?n:k(w({},n),{status:"unchecked"}));this.plugin.setPluginState({partialTree:i})}#e;async#t(e){this.#e?.abort();let i=new AbortController;this.#e=i;let n=()=>{i.abort()};try{this.plugin.uppy.on("dashboard:close-panel",n),this.plugin.uppy.on("cancel-all",n),await e(i.signal)}finally{this.plugin.uppy.off("dashboard:close-panel",n),this.plugin.uppy.off("cancel-all",n),this.#e=void 0}}async openFolder(e){this.lastCheckbox=null;let{partialTree:i}=this.plugin.getPluginState(),n=i.find(r=>r.id===e);if(n.cached){this.plugin.setPluginState({currentFolderId:e,searchString:""});return}this.setLoading(!0),await this.#t(async r=>{let o=e,s=[];do{let{username:l,nextPagePath:c,items:d}=await this.provider.list(o,{signal:r});this.plugin.setPluginState({username:l}),o=c,s=s.concat(d),this.setLoading(this.plugin.uppy.i18n("loadedXFiles",{numFiles:s.length}))}while(this.opts.loadAllFiles&&o);let a=Td.afterOpenFolder(i,s,n,o,this.validateSingleFile);this.plugin.setPluginState({partialTree:a,currentFolderId:e,searchString:""})}).catch(hl(this.plugin.uppy)),this.setLoading(!1)}async logout(){await this.#t(async e=>{let i=await this.provider.logout({signal:e});if(i.ok){if(!i.revoked){let n=this.plugin.uppy.i18n("companionUnauthorizeHint",{provider:this.plugin.title,url:i.manual_revoke_url});this.plugin.uppy.info(n,"info",7e3)}this.plugin.setPluginState(k(w({},mR(this.plugin.rootFolderId)),{authenticated:!1}))}}).catch(hl(this.plugin.uppy))}async handleAuth(e){await this.#t(async i=>{this.setLoading(!0),await this.provider.login({authFormData:e,signal:i}),this.plugin.setPluginState({authenticated:!0}),await Promise.all([this.provider.fetchPreAuthToken(),this.openFolder(this.plugin.rootFolderId)])}).catch(hl(this.plugin.uppy)),this.setLoading(!1)}async handleScroll(e){let{partialTree:i,currentFolderId:n}=this.plugin.getPluginState(),r=i.find(o=>o.id===n);fR(e)&&!this.isHandlingScroll&&r.nextPagePath&&(this.isHandlingScroll=!0,await this.#t(async o=>{let{nextPagePath:s,items:a}=await this.provider.list(r.nextPagePath,{signal:o}),l=Td.afterScrollFolder(i,n,a,s,this.validateSingleFile);this.plugin.setPluginState({partialTree:l})}).catch(hl(this.plugin.uppy)),this.isHandlingScroll=!1)}validateSingleFile=e=>{let i=Rp(e);return this.plugin.uppy.validateSingleFile(i)};async donePicking(){let{partialTree:e}=this.plugin.getPluginState();this.setLoading(!0),await this.#t(async i=>{let n=await Td.afterFill(e,s=>this.provider.list(s,{signal:i}),this.validateSingleFile,s=>{this.setLoading(this.plugin.uppy.i18n("addedNumFiles",{numFiles:s}))});if(this.validateAggregateRestrictions(n)){this.plugin.setPluginState({partialTree:n});return}let o=rR(n);eR(o,this.plugin,this.provider),this.resetPluginState()}).catch(hl(this.plugin.uppy)),this.setLoading(!1)}toggleCheckbox(e,i){let{partialTree:n}=this.plugin.getPluginState(),r=tR(e.id,this.getDisplayedPartialTree(),i,this.lastCheckbox),o=Td.afterToggleCheckbox(n,r);this.plugin.setPluginState({partialTree:o}),this.lastCheckbox=e.id}getDisplayedPartialTree=()=>{let{partialTree:e,currentFolderId:i,searchString:n}=this.plugin.getPluginState(),r=e.filter(s=>s.type!=="root"&&s.parentId===i);return n===""?r:r.filter(s=>(s.data.name??this.plugin.uppy.i18n("unnamed")).toLowerCase().indexOf(n.toLowerCase())!==-1)};getBreadcrumbs=()=>{let{partialTree:e,currentFolderId:i}=this.plugin.getPluginState();return iR(e,i)};getSelectedAmount=()=>{let{partialTree:e}=this.plugin.getPluginState();return Np(e)};validateAggregateRestrictions=e=>{let n=e.filter(r=>r.type==="file"&&r.status==="checked").map(r=>r.data);return this.plugin.uppy.validateAggregateRestrictions(n)};render(e,i={}){let{didFirstRender:n}=this.plugin.getPluginState(),{i18n:r}=this.plugin.uppy;n||(this.plugin.setPluginState({didFirstRender:!0}),this.provider.fetchPreAuthToken(),this.openFolder(this.plugin.rootFolderId));let o=w(w({},this.opts),i),{authenticated:s,loading:a}=this.plugin.getPluginState(),l=this.plugin.icon||Dd;if(s===!1)return y(EC,{pluginName:this.plugin.title,pluginIcon:l,handleAuth:this.handleAuth,i18n:this.plugin.uppy.i18n,renderForm:o.renderAuthForm,loading:a});let{partialTree:c,username:d,searchString:u}=this.plugin.getPluginState(),h=this.getBreadcrumbs();return y("div",{className:(0,vR.default)("uppy-ProviderBrowser",`uppy-ProviderBrowser-viewType--${o.viewType}`),children:[y(BC,{showBreadcrumbs:o.showBreadcrumbs,openFolder:this.openFolder,breadcrumbs:h,pluginIcon:l,title:this.plugin.title,logout:this.logout,username:d,i18n:r}),o.showFilter&&y(QP,{searchString:u,setSearchString:p=>{this.plugin.setPluginState({searchString:p})},submitSearchString:()=>{},inputLabel:r("filter"),clearSearchLabel:r("resetFilter"),wrapperClassName:"uppy-ProviderBrowser-searchFilter",inputClassName:"uppy-ProviderBrowser-searchFilterInput"}),y(XP,{toggleCheckbox:this.toggleCheckbox,displayedPartialTree:this.getDisplayedPartialTree(),openFolder:this.openFolder,virtualList:o.virtualList,noResultsLabel:r("noFilesFound"),handleScroll:this.handleScroll,viewType:o.viewType,showTitles:o.showTitles,i18n:this.plugin.uppy.i18n,isLoading:a,utmSource:"Companion"}),y(kC,{partialTree:c,donePicking:this.donePicking,cancelSelection:this.cancelSelection,i18n:r,validateAggregateRestrictions:this.validateAggregateRestrictions})]})}};function ot(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var RR=typeof self<"u"?self:global,Od=typeof navigator<"u",Q9=Od&&typeof HTMLImageElement>"u",CR=!(typeof global>"u"||typeof process>"u"||!process.versions||!process.versions.node),_R=RR.Buffer,kR=!!_R,Z9=t=>t!==void 0;function FR(t){return t===void 0||(t instanceof Map?t.size===0:Object.values(t).filter(Z9).length===0)}function ti(t){let e=new Error(t);throw delete e.stack,e}function wR(t){let e=(function(i){let n=0;return i.ifd0.enabled&&(n+=1024),i.exif.enabled&&(n+=2048),i.makerNote&&(n+=2048),i.userComment&&(n+=1024),i.gps.enabled&&(n+=512),i.interop.enabled&&(n+=100),i.ifd1.enabled&&(n+=1024),n+2048})(t);return t.jfif.enabled&&(e+=50),t.xmp.enabled&&(e+=2e4),t.iptc.enabled&&(e+=14e3),t.icc.enabled&&(e+=6e3),e}var HC=t=>String.fromCharCode.apply(null,t),bR=typeof TextDecoder<"u"?new TextDecoder("utf-8"):void 0,qs=class t{static from(e,i){return e instanceof this&&e.le===i?e:new t(e,void 0,void 0,i)}constructor(e,i=0,n,r){if(typeof r=="boolean"&&(this.le=r),Array.isArray(e)&&(e=new Uint8Array(e)),e===0)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){n===void 0&&(n=e.byteLength-i);let o=new DataView(e,i,n);this._swapDataView(o)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof t){n===void 0&&(n=e.byteLength-i),(i+=e.byteOffset)+n>e.byteOffset+e.byteLength&&ti("Creating view outside of available memory in ArrayBuffer");let o=new DataView(e.buffer,i,n);this._swapDataView(o)}else if(typeof e=="number"){let o=new DataView(new ArrayBuffer(e));this._swapDataView(o)}else ti("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,i,n=t){return e instanceof DataView||e instanceof t?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||ti("BufferView.set(): Invalid data argument."),this.toUint8().set(e,i),new n(this,i,e.byteLength)}subarray(e,i){return i=i||this._lengthToEnd(e),new t(this,e,i)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,i){return new Uint8Array(this.buffer,this.byteOffset+e,i)}getString(e=0,i=this.byteLength){return r=this.getUint8Array(e,i),bR?bR.decode(r):kR?Buffer.from(r).toString("utf8"):decodeURIComponent(escape(HC(r)));var r}getLatin1String(e=0,i=this.byteLength){let n=this.getUint8Array(e,i);return HC(n)}getUnicodeString(e=0,i=this.byteLength){let n=[];for(let r=0;r<i&&e+r<this.byteLength;r+=2)n.push(this.getUint16(e+r));return HC(n)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,i=this.le){return this.dataView.getInt16(e,i)}getInt32(e,i=this.le){return this.dataView.getInt32(e,i)}getUint16(e,i=this.le){return this.dataView.getUint16(e,i)}getUint32(e,i=this.le){return this.dataView.getUint32(e,i)}getFloat32(e,i=this.le){return this.dataView.getFloat32(e,i)}getFloat64(e,i=this.le){return this.dataView.getFloat64(e,i)}getFloat(e,i=this.le){return this.dataView.getFloat32(e,i)}getDouble(e,i=this.le){return this.dataView.getFloat64(e,i)}getUintBytes(e,i,n){switch(i){case 1:return this.getUint8(e,n);case 2:return this.getUint16(e,n);case 4:return this.getUint32(e,n);case 8:return this.getUint64&&this.getUint64(e,n)}}getUint(e,i,n){switch(i){case 8:return this.getUint8(e,n);case 16:return this.getUint16(e,n);case 32:return this.getUint32(e,n);case 64:return this.getUint64&&this.getUint64(e,n)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}};function VC(t,e){ti(`${t} '${e}' was not loaded, try using full build of exifr.`)}var Ld=class extends Map{constructor(e){super(),this.kind=e}get(e,i){return this.has(e)||VC(this.kind,e),i&&(e in i||(function(n,r){ti(`Unknown ${n} '${r}'.`)})(this.kind,e),i[e].enabled||VC(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}},$p=new Ld("file parser"),rn=new Ld("segment parser"),Hd=new Ld("file reader"),eN=RR.fetch;function yR(t,e){return(i=t).startsWith("data:")||i.length>1e4?WC(t,e,"base64"):CR&&t.includes("://")?GC(t,e,"url",Wp):CR?WC(t,e,"fs"):Od?GC(t,e,"url",Wp):void ti("Invalid input argument");var i}async function GC(t,e,i,n){return Hd.has(i)?WC(t,e,i):n?(async function(r,o){let s=await o(r);return new qs(s)})(t,n):void ti(`Parser ${i} is not loaded`)}async function WC(t,e,i){let n=new(Hd.get(i))(t,e);return await n.read(),n}var Wp=t=>eN(t).then(e=>e.arrayBuffer()),Nd=t=>new Promise((e,i)=>{let n=new FileReader;n.onloadend=()=>e(n.result||new ArrayBuffer),n.onerror=i,n.readAsArrayBuffer(t)}),UC=class extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}};function TR(t,e,i){let n=new UC;for(let[r,o]of i)n.set(r,o);if(Array.isArray(e))for(let r of e)t.set(r,n);else t.set(e,n);return n}function DR(t,e,i){let n,r=t.get(e);for(n of i)r.set(n[0],n[1])}var zd=new Map,YC=new Map,XC=new Map,pl=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],Kp=["jfif","xmp","icc","iptc","ihdr"],Bd=["tiff",...Kp],Wt=["ifd0","ifd1","exif","gps","interop"],fl=[...Bd,...Wt],gl=["makerNote","userComment"],Yp=["translateKeys","translateValues","reviveValues","multiSegment"],ml=[...Yp,"sanitize","mergeOutput","silentErrors"],Up=class{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}},js=class extends Up{get needed(){return this.enabled||this.deps.size>0}constructor(e,i,n,r){if(super(),ot(this,"enabled",!1),ot(this,"skip",new Set),ot(this,"pick",new Set),ot(this,"deps",new Set),ot(this,"translateKeys",!1),ot(this,"translateValues",!1),ot(this,"reviveValues",!1),this.key=e,this.enabled=i,this.parse=this.enabled,this.applyInheritables(r),this.canBeFiltered=Wt.includes(e),this.canBeFiltered&&(this.dict=zd.get(e)),n!==void 0)if(Array.isArray(n))this.parse=this.enabled=!0,this.canBeFiltered&&n.length>0&&this.translateTagSet(n,this.pick);else if(typeof n=="object"){if(this.enabled=!0,this.parse=n.parse!==!1,this.canBeFiltered){let{pick:o,skip:s}=n;o&&o.length>0&&this.translateTagSet(o,this.pick),s&&s.length>0&&this.translateTagSet(s,this.skip)}this.applyInheritables(n)}else n===!0||n===!1?this.parse=this.enabled=n:ti(`Invalid options argument: ${n}`)}applyInheritables(e){let i,n;for(i of Yp)n=e[i],n!==void 0&&(this[i]=n)}translateTagSet(e,i){if(this.dict){let n,r,{tagKeys:o,tagValues:s}=this.dict;for(n of e)typeof n=="string"?(r=s.indexOf(n),r===-1&&(r=o.indexOf(Number(n))),r!==-1&&i.add(Number(o[r]))):i.add(n)}else for(let n of e)i.add(n)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,jp(this.pick,this.deps)):this.enabled&&this.pick.size>0&&jp(this.pick,this.deps)}},Li={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},SR=new Map,$s=class extends Up{static useCached(e){let i=SR.get(e);return i!==void 0||(i=new this(e),SR.set(e,i)),i}constructor(e){super(),e===!0?this.setupFromTrue():e===void 0?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):typeof e=="object"?this.setupFromObject(e):ti(`Invalid options argument ${e}`),this.firstChunkSize===void 0&&(this.firstChunkSize=Od?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of pl)this[e]=Li[e];for(e of ml)this[e]=Li[e];for(e of gl)this[e]=Li[e];for(e of fl)this[e]=new js(e,Li[e],void 0,this)}setupFromTrue(){let e;for(e of pl)this[e]=Li[e];for(e of ml)this[e]=Li[e];for(e of gl)this[e]=!0;for(e of fl)this[e]=new js(e,!0,void 0,this)}setupFromArray(e){let i;for(i of pl)this[i]=Li[i];for(i of ml)this[i]=Li[i];for(i of gl)this[i]=Li[i];for(i of fl)this[i]=new js(i,!1,void 0,this);this.setupGlobalFilters(e,void 0,Wt)}setupFromObject(e){let i;for(i of(Wt.ifd0=Wt.ifd0||Wt.image,Wt.ifd1=Wt.ifd1||Wt.thumbnail,Object.assign(this,e),pl))this[i]=zC(e[i],Li[i]);for(i of ml)this[i]=zC(e[i],Li[i]);for(i of gl)this[i]=zC(e[i],Li[i]);for(i of Bd)this[i]=new js(i,Li[i],e[i],this);for(i of Wt)this[i]=new js(i,Li[i],e[i],this.tiff);this.setupGlobalFilters(e.pick,e.skip,Wt,fl),e.tiff===!0?this.batchEnableWithBool(Wt,!0):e.tiff===!1?this.batchEnableWithUserValue(Wt,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,Wt):typeof e.tiff=="object"&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,Wt)}batchEnableWithBool(e,i){for(let n of e)this[n].enabled=i}batchEnableWithUserValue(e,i){for(let n of e){let r=i[n];this[n].enabled=r!==!1&&r!==void 0}}setupGlobalFilters(e,i,n,r=n){if(e&&e.length){for(let s of r)this[s].enabled=!1;let o=xR(e,n);for(let[s,a]of o)jp(this[s].pick,a),this[s].enabled=!0}else if(i&&i.length){let o=xR(i,n);for(let[s,a]of o)jp(this[s].skip,a)}}filterNestedSegmentTags(){let{ifd0:e,exif:i,xmp:n,iptc:r,icc:o}=this;this.makerNote?i.deps.add(37500):i.skip.add(37500),this.userComment?i.deps.add(37510):i.skip.add(37510),n.enabled||e.skip.add(700),r.enabled||e.skip.add(33723),o.enabled||e.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:e,exif:i,gps:n,interop:r}=this;r.needed&&(i.deps.add(40965),e.deps.add(40965)),i.needed&&e.deps.add(34665),n.needed&&e.deps.add(34853),this.tiff.enabled=Wt.some(o=>this[o].enabled===!0)||this.makerNote||this.userComment;for(let o of Wt)this[o].finalizeFilters()}get onlyTiff(){return!Kp.map(e=>this[e].enabled).some(e=>e===!0)&&this.tiff.enabled}checkLoadedPlugins(){for(let e of Bd)this[e].enabled&&!rn.has(e)&&VC("segment parser",e)}};function xR(t,e){let i,n,r,o,s=[];for(r of e){for(o of(i=zd.get(r),n=[],i))(t.includes(o[0])||t.includes(o[1]))&&n.push(o[0]);n.length&&s.push([r,n])}return s}function zC(t,e){return t!==void 0?t:e!==void 0?e:void 0}function jp(t,e){for(let i of e)t.add(i)}ot($s,"default",Li);var vl=class{constructor(e){ot(this,"parsers",{}),ot(this,"output",{}),ot(this,"errors",[]),ot(this,"pushToErrors",i=>this.errors.push(i)),this.options=$s.useCached(e)}async read(e){this.file=await(function(i,n){return typeof i=="string"?yR(i,n):Od&&!Q9&&i instanceof HTMLImageElement?yR(i.src,n):i instanceof Uint8Array||i instanceof ArrayBuffer||i instanceof DataView?new qs(i):Od&&i instanceof Blob?GC(i,n,"blob",Nd):void ti("Invalid input argument")})(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,i=e.getUint16(0);for(let[n,r]of $p)if(r.canHandle(e,i))return this.fileParser=new r(this.options,this.file,this.parsers),e[n]=!0;this.file.close&&this.file.close(),ti("Unknown file format")}async parse(){let{output:e,errors:i}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),i.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&i.length>0&&(e.errors=i),FR(n=e)?void 0:n;var n}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let i=Object.values(this.parsers).map(async n=>{let r=await n.parse();n.assignToOutput(e,r)});this.options.silentErrors&&(i=i.map(n=>n.catch(this.pushToErrors))),await Promise.all(i)}async extractThumbnail(){this.setup();let{options:e,file:i}=this,n=rn.get("tiff",e);var r;if(i.tiff?r={start:0,type:"tiff"}:i.jpeg&&(r=await this.fileParser.getOrFindSegment("tiff")),r===void 0)return;let o=await this.fileParser.ensureSegmentChunk(r),s=this.parsers.tiff=new n(o,e,i),a=await s.extractThumbnail();return i.close&&i.close(),a}};async function MR(t,e){let i=new vl(e);return await i.read(t),i.parse()}var tN=Object.freeze({__proto__:null,parse:MR,Exifr:vl,fileParsers:$p,segmentParsers:rn,fileReaders:Hd,tagKeys:zd,tagValues:YC,tagRevivers:XC,createDictionary:TR,extendDictionary:DR,fetchUrlAsArrayBuffer:Wp,readBlobAsArrayBuffer:Nd,chunkedProps:pl,otherSegments:Kp,segments:Bd,tiffBlocks:Wt,segmentsAndBlocks:fl,tiffExtractables:gl,inheritables:Yp,allFormatters:ml,Options:$s}),Qo=class{static findPosition(e,i){let n=e.getUint16(i+2)+2,r=typeof this.headerLength=="function"?this.headerLength(e,i,n):this.headerLength,o=i+r,s=n-r;return{offset:i,length:n,headerLength:r,start:o,size:s,end:o+s}}static parse(e,i={}){return new this(e,new $s({[this.type]:i}),e).parse()}normalizeInput(e){return e instanceof qs?e:new qs(e)}constructor(e,i={},n){ot(this,"errors",[]),ot(this,"raw",new Map),ot(this,"handleError",r=>{if(!this.options.silentErrors)throw r;this.errors.push(r.message)}),this.chunk=this.normalizeInput(e),this.file=n,this.type=this.constructor.type,this.globalOptions=this.options=i,this.localOptions=i[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,i){let n=XC.get(i),r=YC.get(i),o=zd.get(i),s=this.options[i],a=s.reviveValues&&!!n,l=s.translateValues&&!!r,c=s.translateKeys&&!!o,d={};for(let[u,h]of e)a&&n.has(u)?h=n.get(u)(h):l&&r.has(u)&&(h=this.translateValue(h,r.get(u))),c&&o.has(u)&&(u=o.get(u)||u),d[u]=h;return d}translateValue(e,i){return i[e]||i.DEFAULT||e}assignToOutput(e,i){this.assignObjectToOutput(e,this.constructor.type,i)}assignObjectToOutput(e,i,n){if(this.globalOptions.mergeOutput)return Object.assign(e,n);e[i]?Object.assign(e[i],n):e[i]=n}};ot(Qo,"headerLength",4),ot(Qo,"type",void 0),ot(Qo,"multiSegment",!1),ot(Qo,"canHandle",()=>!1);function iN(t){return t===192||t===194||t===196||t===219||t===221||t===218||t===254}function nN(t){return t>=224&&t<=239}function rN(t,e,i){for(let[n,r]of rn)if(r.canHandle(t,e,i))return n}var qp=class extends class{constructor(e,i,n){ot(this,"errors",[]),ot(this,"ensureSegmentChunk",async r=>{let o=r.start,s=r.size||65536;if(this.file.chunked)if(this.file.available(o,s))r.chunk=this.file.subarray(o,s);else try{r.chunk=await this.file.readChunk(o,s)}catch(a){ti(`Couldn't read segment: ${JSON.stringify(r)}. ${a.message}`)}else this.file.byteLength>o+s?r.chunk=this.file.subarray(o,s):r.size===void 0?r.chunk=this.file.subarray(o):ti("Segment unreachable: "+JSON.stringify(r));return r.chunk}),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=i,this.parsers=n}injectSegment(e,i){this.options[e].enabled&&this.createParser(e,i)}createParser(e,i){let n=new(rn.get(e))(i,this.options,this.file);return this.parsers[e]=n}createParsers(e){for(let i of e){let{type:n,chunk:r}=i,o=this.options[n];if(o&&o.enabled){let s=this.parsers[n];s&&s.append||s||this.createParser(n,r)}}}async readSegments(e){let i=e.map(this.ensureSegmentChunk);await Promise.all(i)}}{constructor(...e){super(...e),ot(this,"appSegments",[]),ot(this,"jpegSegments",[]),ot(this,"unknownSegments",[])}static canHandle(e,i){return i===65496}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){e===!0?(this.findAll=!0,this.wanted=new Set(rn.keyList())):(e=e===void 0?rn.keyList().filter(i=>this.options[i].enabled):e.filter(i=>this.options[i].enabled&&rn.has(i)),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,i){this.setupSegmentFinderArgs(i);let{file:n,findAll:r,wanted:o,remaining:s}=this;if(!r&&this.file.chunked&&(r=Array.from(o).some(a=>{let l=rn.get(a),c=this.options[a];return l.multiSegment&&c.multiSegment}),r&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,n.byteLength),!this.options.onlyTiff&&n.chunked){let a=!1;for(;s.size>0&&!a&&(n.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:l}=n,c=this.appSegments.some(d=>!this.file.available(d.offset||d.start,d.length||d.size));if(a=e>l&&!c?!await n.readNextChunk(e):!await n.readNextChunk(l),(e=this.findAppSegmentsInRange(e,n.byteLength))===void 0)return}}}findAppSegmentsInRange(e,i){i-=2;let n,r,o,s,a,l,{file:c,findAll:d,wanted:u,remaining:h,options:p}=this;for(;e<i;e++)if(c.getUint8(e)===255){if(n=c.getUint8(e+1),nN(n)){if(r=c.getUint16(e+2),o=rN(c,e,r),o&&u.has(o)&&(s=rn.get(o),a=s.findPosition(c,e),l=p[o],a.type=o,this.appSegments.push(a),!d&&(s.multiSegment&&l.multiSegment?(this.unfinishedMultiSegment=a.chunkNumber<a.chunkCount,this.unfinishedMultiSegment||h.delete(o)):h.delete(o),h.size===0)))break;p.recordUnknownSegments&&(a=Qo.findPosition(c,e),a.marker=n,this.unknownSegments.push(a)),e+=r+1}else if(iN(n)){if(r=c.getUint16(e+2),n===218&&p.stopAfterSos!==!1)return;p.recordJpegSegments&&this.jpegSegments.push({offset:e,length:r,marker:n}),e+=r+1}}return e}mergeMultiSegments(){if(!this.appSegments.some(i=>i.multiSegment))return;let e=(function(i,n){let r,o,s,a=new Map;for(let l=0;l<i.length;l++)r=i[l],o=r[n],a.has(o)?s=a.get(o):a.set(o,s=[]),s.push(r);return Array.from(a)})(this.appSegments,"type");this.mergedAppSegments=e.map(([i,n])=>{let r=rn.get(i,this.options);return r.handleMultiSegments?{type:i,chunk:r.handleMultiSegments(n)}:n[0]})}getSegment(e){return this.appSegments.find(i=>i.type===e)}async getOrFindSegment(e){let i=this.getSegment(e);return i===void 0&&(await this.findAppSegments(0,[e]),i=this.getSegment(e)),i}};ot(qp,"type","jpeg"),$p.set("jpeg",qp);var oN=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4],jC=class extends Qo{parseHeader(){var e=this.chunk.getUint16();e===18761?this.le=!0:e===19789&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,i,n=new Map){let{pick:r,skip:o}=this.options[i];r=new Set(r);let s=r.size>0,a=o.size===0,l=this.chunk.getUint16(e);e+=2;for(let c=0;c<l;c++){let d=this.chunk.getUint16(e);if(s){if(r.has(d)&&(n.set(d,this.parseTag(e,d,i)),r.delete(d),r.size===0))break}else!a&&o.has(d)||n.set(d,this.parseTag(e,d,i));e+=12}return n}parseTag(e,i,n){let{chunk:r}=this,o=r.getUint16(e+2),s=r.getUint32(e+4),a=oN[o];if(a*s<=4?e+=8:e=r.getUint32(e+8),(o<1||o>13)&&ti(`Invalid TIFF value type. block: ${n.toUpperCase()}, tag: ${i.toString(16)}, type: ${o}, offset ${e}`),e>r.byteLength&&ti(`Invalid TIFF value offset. block: ${n.toUpperCase()}, tag: ${i.toString(16)}, type: ${o}, offset ${e} is outside of chunk size ${r.byteLength}`),o===1)return r.getUint8Array(e,s);if(o===2)return(l=(function(c){for(;c.endsWith("\0");)c=c.slice(0,-1);return c})(l=r.getString(e,s)).trim())===""?void 0:l;var l;if(o===7)return r.getUint8Array(e,s);if(s===1)return this.parseTagValue(o,e);{let c=new((function(u){switch(u){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}})(o))(s),d=a;for(let u=0;u<s;u++)c[u]=this.parseTagValue(o,e),e+=d;return c}}parseTagValue(e,i){let{chunk:n}=this;switch(e){case 1:return n.getUint8(i);case 3:return n.getUint16(i);case 4:return n.getUint32(i);case 5:return n.getUint32(i)/n.getUint32(i+4);case 6:return n.getInt8(i);case 8:return n.getInt16(i);case 9:return n.getInt32(i);case 10:return n.getInt32(i)/n.getInt32(i+4);case 11:return n.getFloat(i);case 12:return n.getDouble(i);case 13:return n.getUint32(i);default:ti(`Invalid tiff type ${e}`)}}},Ad=class extends jC{static canHandle(e,i){return e.getUint8(i+1)===225&&e.getUint32(i+4)===1165519206&&e.getUint16(i+8)===0}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let i=this[e]();return i.catch!==void 0&&(i=i.catch(this.handleError)),i}findIfd0Offset(){this.ifd0Offset===void 0&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(this.ifd1Offset===void 0){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),i=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(i)}}parseBlock(e,i){let n=new Map;return this[i]=n,this.parseTags(e,i,n),n}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&ti("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&ti(`IFD0 offset points to outside of file.
this.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,wR(this.options));let i=this.parseBlock(this.ifd0Offset,"ifd0");return i.size!==0?(this.exifOffset=i.get(34665),this.interopOffset=i.get(40965),this.gpsOffset=i.get(34853),this.xmp=i.get(700),this.iptc=i.get(33723),this.icc=i.get(34675),this.options.sanitize&&(i.delete(34665),i.delete(40965),i.delete(34853),i.delete(700),i.delete(33723),i.delete(34675)),i):void 0}async parseExifBlock(){if(this.exif||(this.ifd0||await this.parseIfd0Block(),this.exifOffset===void 0))return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,wR(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get(40965)),this.makerNote=e.get(37500),this.userComment=e.get(37510),this.options.sanitize&&(e.delete(40965),e.delete(37500),e.delete(37510)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,i){let n=e.get(i);n&&n.length===1&&e.set(i,n[0])}async parseGpsBlock(){if(this.gps||(this.ifd0||await this.parseIfd0Block(),this.gpsOffset===void 0))return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",ER(...e.get(2),e.get(1))),e.set("longitude",ER(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),this.interopOffset!==void 0||this.exif||await this.parseExifBlock(),this.interopOffset!==void 0))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),this.ifd1===void 0)return;let e=this.ifd1.get(513),i=this.ifd1.get(514);return this.chunk.getUint8Array(e,i)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,i,n,r={};for(i of Wt)if(e=this[i],!FR(e))if(n=this.canTranslate?this.translateBlock(e,i):Object.fromEntries(e),this.options.mergeOutput){if(i==="ifd1")continue;Object.assign(r,n)}else r[i]=n;return this.makerNote&&(r.makerNote=this.makerNote),this.userComment&&(r.userComment=this.userComment),r}assignToOutput(e,i){if(this.globalOptions.mergeOutput)Object.assign(e,i);else for(let[n,r]of Object.entries(i))this.assignObjectToOutput(e,n,r)}};function ER(t,e,i,n){var r=t+e/60+i/3600;return n!=="S"&&n!=="W"||(r*=-1),r}ot(Ad,"type","tiff"),ot(Ad,"headerLength",10),rn.set("tiff",Ad);var owe=Object.freeze({__proto__:null,default:tN,Exifr:vl,fileParsers:$p,segmentParsers:rn,fileReaders:Hd,tagKeys:zd,tagValues:YC,tagRevivers:XC,createDictionary:TR,extendDictionary:DR,fetchUrlAsArrayBuffer:Wp,readBlobAsArrayBuffer:Nd,chunkedProps:pl,otherSegments:Kp,segments:Bd,tiffBlocks:Wt,segmentsAndBlocks:fl,tiffExtractables:gl,inheritables:Yp,allFormatters:ml,Options:$s,parse:MR}),JC={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},swe=Object.assign({},JC,{firstChunkSize:4e4,gps:[1,2,3,4]});var awe=Object.assign({},JC,{tiff:!1,ifd1:!0,mergeOutput:!1});var sN=Object.assign({},JC,{firstChunkSize:4e4,ifd0:[274]});async function aN(t){let e=new vl(sN);await e.read(t);let i=await e.parse();if(i&&i.ifd0)return i.ifd0[274]}var lN=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}}),Md=!0,Id=!0;if(typeof navigator=="object"){let t=navigator.userAgent;if(t.includes("iPad")||t.includes("iPhone")){let e=t.match(/OS (\d+)_(\d+)/);if(e){let[,i,n]=e;Md=Number(i)+.1*Number(n)<13.4,Id=!1}}else if(t.includes("OS X 10")){let[,e]=t.match(/OS X 10[_.](\d+)/);Md=Id=Number(e)<15}if(t.includes("Chrome/")){let[,e]=t.match(/Chrome\/(\d+)/);Md=Id=Number(e)<81}else if(t.includes("Firefox/")){let[,e]=t.match(/Firefox\/(\d+)/);Md=Id=Number(e)<77}}async function IR(t){let e=await aN(t);return Object.assign({canvas:Md,css:Id},lN[e])}var qC=class extends qs{constructor(...e){super(...e),ot(this,"ranges",new $C),this.byteLength!==0&&this.ranges.add(0,this.byteLength)}_tryExtend(e,i,n){if(e===0&&this.byteLength===0&&n){let r=new DataView(n.buffer||n,n.byteOffset,n.byteLength);this._swapDataView(r)}else{let r=e+i;if(r>this.byteLength){let{dataView:o}=this._extend(r);this._swapDataView(o)}}}_extend(e){let i;i=kR?_R.allocUnsafe(e):new Uint8Array(e);let n=new DataView(i.buffer,i.byteOffset,i.byteLength);return i.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:i,dataView:n}}subarray(e,i,n=!1){return i=i||this._lengthToEnd(e),n&&this._tryExtend(e,i),this.ranges.add(e,i),super.subarray(e,i)}set(e,i,n=!1){n&&this._tryExtend(i,e.byteLength,e);let r=super.set(e,i);return this.ranges.add(i,r.byteLength),r}async ensureChunk(e,i){this.chunked&&(this.ranges.available(e,i)||await this.readChunk(e,i))}available(e,i){return this.ranges.available(e,i)}},$C=class{constructor(){ot(this,"list",[])}get length(){return this.list.length}add(e,i,n=0){let r=e+i,o=this.list.filter(s=>PR(e,s.offset,r)||PR(e,s.end,r));if(o.length>0){e=Math.min(e,...o.map(a=>a.offset)),r=Math.max(r,...o.map(a=>a.end)),i=r-e;let s=o.shift();s.offset=e,s.length=i,s.end=r,this.list=this.list.filter(a=>!o.includes(a))}else this.list.push({offset:e,length:i,end:r})}available(e,i){let n=e+i;return this.list.some(r=>r.offset<=e&&n<=r.end)}};function PR(t,e,i){return t<=e&&e<=i}var KC=class extends qC{constructor(e,i){super(0),ot(this,"chunksRead",0),this.input=e,this.options=i}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let i=this.options.chunkSize,n=await this.readChunk(e,i);return!!n&&n.byteLength===i}async readChunk(e,i){if(this.chunksRead++,(i=this.safeWrapAddress(e,i))!==0)return this._readChunk(e,i)}safeWrapAddress(e,i){return this.size!==void 0&&e+i>this.size?Math.max(0,this.size-e):i}get nextChunkOffset(){if(this.ranges.list.length!==0)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return this.size!==void 0&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}};Hd.set("blob",class extends KC{async readWhole(){this.chunked=!1;let t=await Nd(this.input);this._swapArrayBuffer(t)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(t,e){let i=e?t+e:void 0,n=this.input.slice(t,i),r=await Nd(n);return this.set(r,t,!0)}});var AR={name:"@uppy/thumbnail-generator",description:"Uppy plugin that generates small previews of images to show on your upload UI.",version:"5.0.1",license:"MIT",type:"module",sideEffects:!1,scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","uppy","uppy-plugin","thumbnail","preview","resize"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],exports:{".":"./lib/index.js","./package.json":"./package.json"},dependencies:{"@uppy/utils":"^7.0.2",exifr:"^7.0.0"},devDependencies:{jsdom:"^26.1.0","namespace-emitter":"2.0.1",typescript:"^5.8.3",vitest:"^3.2.4"},peerDependencies:{"@uppy/core":"^5.0.2"}};var OR={strings:{generatingThumbnails:"Generating thumbnails..."}};function dN(t,e,i){try{t.getContext("2d").getImageData(0,0,1,1)}catch(n){if(n.code===18)return Promise.reject(new Error("cannot read image, probably an svg with external resources"))}return t.toBlob?new Promise(n=>{t.toBlob(n,e,i)}).then(n=>{if(n===null)throw new Error("cannot read image, probably an svg with external resources");return n}):Promise.resolve().then(()=>Vv(t.toDataURL(e,i),{})).then(n=>{if(n===null)throw new Error("could not extract blob, probably an old browser");return n})}function uN(t,e){let i=t.width,n=t.height;(e.deg===90||e.deg===270)&&(i=t.height,n=t.width);let r=document.createElement("canvas");r.width=i,r.height=n;let o=r.getContext("2d");return o.translate(i/2,n/2),e.canvas&&(o.rotate(e.rad),o.scale(e.scaleX,e.scaleY)),o.drawImage(t,-t.width/2,-t.height/2,t.width,t.height),r}function hN(t){let e=t.width/t.height,i=5e6,n=4096,r=Math.floor(Math.sqrt(i*e)),o=Math.floor(i/Math.sqrt(i*e));if(r>n&&(r=n,o=Math.round(r/e)),o>n&&(o=n,r=Math.round(e*o)),t.width>r){let s=document.createElement("canvas");return s.width=r,s.height=o,s.getContext("2d").drawImage(t,0,0,r,o),s}return t}var pN={thumbnailWidth:null,thumbnailHeight:null,thumbnailType:"image/jpeg",waitForThumbnailsBeforeUpload:!1,lazy:!1},Xp=class extends Rd{static VERSION=AR.version;queue;queueProcessing;defaultThumbnailDimension;thumbnailType;constructor(e,i){if(super(e,w(w({},pN),i)),this.type="modifier",this.id=this.opts.id||"ThumbnailGenerator",this.title="Thumbnail Generator",this.queue=[],this.queueProcessing=!1,this.defaultThumbnailDimension=200,this.thumbnailType=this.opts.thumbnailType,this.defaultLocale=OR,this.i18nInit(),this.opts.lazy&&this.opts.waitForThumbnailsBeforeUpload)throw new Error("ThumbnailGenerator: The `lazy` and `waitForThumbnailsBeforeUpload` options are mutually exclusive. Please ensure at most one of them is set to `true`.")}createThumbnail(e,i,n){let r=URL.createObjectURL(e.data),o=new Promise((a,l)=>{let c=new Image;c.src=r,c.addEventListener("load",()=>{URL.revokeObjectURL(r),a(c)}),c.addEventListener("error",d=>{URL.revokeObjectURL(r),l(d.error||new Error("Could not create thumbnail"))})}),s=IR(e.data).catch(()=>1);return Promise.all([o,s]).then(([a,l])=>{let c=this.getProportionalDimensions(a,i,n,l.deg),d=uN(a,l),u=this.resizeImage(d,c.width,c.height);return dN(u,this.thumbnailType,80)}).then(a=>URL.createObjectURL(a))}getProportionalDimensions(e,i,n,r){let o=e.width/e.height;if((r===90||r===270)&&(o=e.height/e.width),i!=null){let s=i;return e.width<i&&(s=e.width),{width:s,height:Math.round(s/o)}}if(n!=null){let s=n;return e.height<n&&(s=e.height),{width:Math.round(s*o),height:s}}return{width:this.defaultThumbnailDimension,height:Math.round(this.defaultThumbnailDimension/o)}}resizeImage(e,i,n){let r=hN(e),o=Math.ceil(Math.log2(r.width/i));o<1&&(o=1);let s=i*2**(o-1),a=n*2**(o-1),l=2;for(;o--;){let c=document.createElement("canvas");c.width=s,c.height=a,c.getContext("2d").drawImage(r,0,0,s,a),r=c,s=Math.round(s/l),a=Math.round(a/l)}return r}setPreviewURL(e,i){this.uppy.setFileState(e,{preview:i})}addToQueue(e){this.queue.push(e),this.queueProcessing===!1&&this.processQueue()}processQueue(){if(this.queueProcessing=!0,this.queue.length>0){let e=this.uppy.getFile(this.queue.shift());return e?this.requestThumbnail(e).catch(()=>{}).then(()=>this.processQueue()):(this.uppy.log("[ThumbnailGenerator] file was removed before a thumbnail could be generated, but not removed from the queue. This is probably a bug","error"),Promise.resolve())}return this.queueProcessing=!1,this.uppy.log("[ThumbnailGenerator] Emptied thumbnail queue"),this.uppy.emit("thumbnail:all-generated"),Promise.resolve()}requestThumbnail(e){return gd(e.type)&&!e.isRemote?this.createThumbnail(e,this.opts.thumbnailWidth,this.opts.thumbnailHeight).then(i=>{this.setPreviewURL(e.id,i),this.uppy.log(`[ThumbnailGenerator] Generated thumbnail for ${e.id}`),this.uppy.emit("thumbnail:generated",this.uppy.getFile(e.id),i)}).catch(i=>{this.uppy.log(`[ThumbnailGenerator] Failed thumbnail for ${e.id}:`,"warning"),this.uppy.log(i,"warning"),this.uppy.emit("thumbnail:error",this.uppy.getFile(e.id),i)}):Promise.resolve()}onFileAdded=e=>{!e.preview&&e.data&&gd(e.type)&&!e.isRemote&&this.addToQueue(e.id)};onCancelRequest=e=>{let i=this.queue.indexOf(e.id);i!==-1&&this.queue.splice(i,1)};onFileRemoved=e=>{let i=this.queue.indexOf(e.id);i!==-1&&this.queue.splice(i,1),e.preview&&fd(e.preview)&&URL.revokeObjectURL(e.preview)};onRestored=()=>{this.uppy.getFiles().filter(i=>i.isRestored).forEach(i=>{(!i.preview||fd(i.preview))&&this.addToQueue(i.id)})};onAllFilesRemoved=()=>{this.queue=[]};waitUntilAllProcessed=e=>{e.forEach(n=>{let r=this.uppy.getFile(n);this.uppy.emit("preprocess-progress",r,{mode:"indeterminate",message:this.i18n("generatingThumbnails")})});let i=()=>{e.forEach(n=>{let r=this.uppy.getFile(n);this.uppy.emit("preprocess-complete",r)})};return new Promise(n=>{this.queueProcessing?this.uppy.once("thumbnail:all-generated",()=>{i(),n()}):(i(),n())})};install(){this.uppy.on("file-removed",this.onFileRemoved),this.uppy.on("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("thumbnail:cancel",this.onCancelRequest)):(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("file-added",this.onFileAdded),this.uppy.on("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.addPreProcessor(this.waitUntilAllProcessed)}uninstall(){this.uppy.off("file-removed",this.onFileRemoved),this.uppy.off("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("thumbnail:cancel",this.onCancelRequest)):(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("file-added",this.onFileAdded),this.uppy.off("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.removePreProcessor(this.waitUntilAllProcessed)}};var LR={name:"@uppy/dashboard",description:"Universal UI plugin for Uppy.",version:"5.0.2",license:"MIT",style:"dist/style.min.css",type:"module",sideEffects:["*.css"],scripts:{build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build",test:"vitest run --silent='passed-only'","test:e2e":"vitest watch --project browser --browser.headless false"},keywords:["file uploader","uppy","uppy-plugin","dashboard","ui"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],exports:{".":"./lib/index.js","./css/style.css":"./dist/style.css","./css/style.min.css":"./dist/style.min.css","./css/style.scss":"./src/style.scss","./package.json":"./package.json"},dependencies:{"@transloadit/prettier-bytes":"^0.3.4","@uppy/provider-views":"^5.0.2","@uppy/thumbnail-generator":"^5.0.1","@uppy/utils":"^7.0.2",classnames:"^2.2.6",lodash:"^4.17.21",nanoid:"^5.0.9",preact:"^10.5.13","shallow-equal":"^3.0.0"},devDependencies:{"@uppy/core":"^5.0.2","@uppy/google-drive":"^5.0.1","@uppy/url":"^5.0.1","@uppy/webcam":"^5.0.1","@vitest/browser":"^3.2.4",cssnano:"^7.0.7",jsdom:"^26.1.0",playwright:"1.54.1",postcss:"^8.5.6","postcss-cli":"^11.0.1","resize-observer-polyfill":"^1.5.0",sass:"^1.89.2",typescript:"^5.8.3",vitest:"^3.2.4"},peerDependencies:{"@uppy/core":"^5.0.2"}};var g_=nt(ji(),1);var QC=class extends bi{fileInput=null;folderInput=null;mobilePhotoFileInput=null;mobileVideoFileInput=null;triggerFileInputClick=()=>{this.fileInput?.click()};triggerFolderInputClick=()=>{this.folderInput?.click()};triggerVideoCameraInputClick=()=>{this.mobileVideoFileInput?.click()};triggerPhotoCameraInputClick=()=>{this.mobilePhotoFileInput?.click()};onFileInputChange=e=>{this.props.handleInputChange(e),e.currentTarget.value=""};renderHiddenInput=(e,i)=>y("input",{className:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabIndex:-1,webkitdirectory:e,type:"file",name:"files[]",multiple:this.props.maxNumberOfFiles!==1,onChange:this.onFileInputChange,accept:this.props.allowedFileTypes?.join(", "),ref:i});renderHiddenCameraInput=(e,i,n)=>{let o={photo:"image/*",video:"video/*"}[e];return y("input",{className:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabIndex:-1,type:"file",name:`camera-${e}`,onChange:this.onFileInputChange,capture:i===""?"environment":i,accept:o,ref:n})};renderMyDeviceAcquirer=()=>y("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MyDevice",children:y("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerFileInputClick,children:[y("div",{className:"uppy-DashboardTab-inner",children:y("svg",{className:"uppy-DashboardTab-iconMyDevice","aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:y("path",{d:"M8.45 22.087l-1.305-6.674h17.678l-1.572 6.674H8.45zm4.975-12.412l1.083 1.765a.823.823 0 00.715.386h7.951V13.5H8.587V9.675h4.838zM26.043 13.5h-1.195v-2.598c0-.463-.336-.75-.798-.75h-8.356l-1.082-1.766A.823.823 0 0013.897 8H7.728c-.462 0-.815.256-.815.718V13.5h-.956a.97.97 0 00-.746.37.972.972 0 00-.19.81l1.724 8.565c.095.44.484.755.933.755H24c.44 0 .824-.3.929-.727l2.043-8.568a.972.972 0 00-.176-.825.967.967 0 00-.753-.38z",fill:"currentcolor","fill-rule":"evenodd"})})}),y("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("myDevice")})]})});renderPhotoCamera=()=>y("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MobilePhotoCamera",children:y("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerPhotoCameraInputClick,children:[y("div",{className:"uppy-DashboardTab-inner",children:y("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:y("path",{d:"M23.5 9.5c1.417 0 2.5 1.083 2.5 2.5v9.167c0 1.416-1.083 2.5-2.5 2.5h-15c-1.417 0-2.5-1.084-2.5-2.5V12c0-1.417 1.083-2.5 2.5-2.5h2.917l1.416-2.167C13 7.167 13.25 7 13.5 7h5c.25 0 .5.167.667.333L20.583 9.5H23.5zM16 11.417a4.706 4.706 0 00-4.75 4.75 4.704 4.704 0 004.75 4.75 4.703 4.703 0 004.75-4.75c0-2.663-2.09-4.75-4.75-4.75zm0 7.825c-1.744 0-3.076-1.332-3.076-3.074 0-1.745 1.333-3.077 3.076-3.077 1.744 0 3.074 1.333 3.074 3.076s-1.33 3.075-3.074 3.075z",fill:"#02B383","fill-rule":"nonzero"})})}),y("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("takePictureBtn")})]})});renderVideoCamera=()=>y("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MobileVideoCamera",children:y("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerVideoCameraInputClick,children:[y("div",{className:"uppy-DashboardTab-inner",children:y("svg",{"aria-hidden":"true",width:"32",height:"32",viewBox:"0 0 32 32",children:y("path",{fill:"#FF675E",fillRule:"nonzero",d:"m21.254 14.277 2.941-2.588c.797-.313 1.243.818 1.09 1.554-.01 2.094.02 4.189-.017 6.282-.126.915-1.145 1.08-1.58.34l-2.434-2.142c-.192.287-.504 1.305-.738.468-.104-1.293-.028-2.596-.05-3.894.047-.312.381.823.426 1.069.063-.384.206-.744.362-1.09zm-12.939-3.73c3.858.013 7.717-.025 11.574.02.912.129 1.492 1.237 1.351 2.217-.019 2.412.04 4.83-.03 7.239-.17 1.025-1.166 1.59-2.029 1.429-3.705-.012-7.41.025-11.114-.019-.913-.129-1.492-1.237-1.352-2.217.018-2.404-.036-4.813.029-7.214.136-.82.83-1.473 1.571-1.454z "})})}),y("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("recordVideoBtn")})]})});renderBrowseButton=(e,i)=>{let n=this.props.acquirers.length;return y("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-Dashboard-browse",onClick:i,"data-uppy-super-focusable":n===0,children:e})};renderDropPasteBrowseTagline=e=>{let i=this.renderBrowseButton(this.props.i18n("browseFiles"),this.triggerFileInputClick),n=this.renderBrowseButton(this.props.i18n("browseFolders"),this.triggerFolderInputClick),r=this.props.fileManagerSelectionType,o=r.charAt(0).toUpperCase()+r.slice(1);return y("div",{class:"uppy-Dashboard-AddFiles-title",children:this.props.disableLocalFiles?this.props.i18n("importFiles"):e>0?this.props.i18nArray(`dropPasteImport${o}`,{browseFiles:i,browseFolders:n,browse:i}):this.props.i18nArray(`dropPaste${o}`,{browseFiles:i,browseFolders:n,browse:i})})};[Symbol.for("uppy test: disable unused locale key warning")](){this.props.i18nArray("dropPasteBoth"),this.props.i18nArray("dropPasteFiles"),this.props.i18nArray("dropPasteFolders"),this.props.i18nArray("dropPasteImportBoth"),this.props.i18nArray("dropPasteImportFiles"),this.props.i18nArray("dropPasteImportFolders")}renderAcquirer=e=>y("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":e.id,children:y("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-cy":e.id,"aria-controls":`uppy-DashboardContent-panel--${e.id}`,"aria-selected":this.props.activePickerPanel?.id===e.id,"data-uppy-super-focusable":!0,onClick:()=>this.props.showPanel(e.id),children:[y("div",{className:"uppy-DashboardTab-inner",children:e.icon()}),y("div",{className:"uppy-DashboardTab-name",children:e.name})]})});renderAcquirers=e=>{let i=[...e],n=i.splice(e.length-2,e.length);return y(ei,{children:[i.map(r=>this.renderAcquirer(r)),y("span",{role:"presentation",style:{"white-space":"nowrap"},children:n.map(r=>this.renderAcquirer(r))})]})};renderSourcesList=(e,i)=>{let{showNativePhotoCameraButton:n,showNativeVideoCameraButton:r}=this.props,o=[],s="myDevice";i||o.push({key:s,elements:this.renderMyDeviceAcquirer()}),n&&o.push({key:"nativePhotoCameraButton",elements:this.renderPhotoCamera()}),r&&o.push({key:"nativePhotoCameraButton",elements:this.renderVideoCamera()}),o.push(...e.map(d=>({key:d.id,elements:this.renderAcquirer(d)}))),o.length===1&&o[0].key===s&&(o=[]);let l=[...o],c=l.splice(o.length-2,o.length);return y(ei,{children:[this.renderDropPasteBrowseTagline(o.length),y("div",{className:"uppy-Dashboard-AddFiles-list",role:"tablist",children:[l.map(({key:d,elements:u})=>y(ei,{children:u},d)),y("span",{role:"presentation",style:{"white-space":"nowrap"},children:c.map(({key:d,elements:u})=>y(ei,{children:u},d))})]})]})};renderPoweredByUppy(){let{i18nArray:e}=this.props,i=y("span",{children:[y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-Dashboard-poweredByIcon",width:"11",height:"11",viewBox:"0 0 11 11",children:y("path",{d:"M7.365 10.5l-.01-4.045h2.612L5.5.806l-4.467 5.65h2.604l.01 4.044h3.718z",fillRule:"evenodd"})}),y("span",{className:"uppy-Dashboard-poweredByUppy",children:"Uppy"})]}),n=e("poweredBy",{uppy:i});return y("a",{tabIndex:-1,href:"https://uppy.io",rel:"noreferrer noopener",target:"_blank",className:"uppy-Dashboard-poweredBy",children:n})}render(){let{showNativePhotoCameraButton:e,showNativeVideoCameraButton:i,nativeCameraFacingMode:n}=this.props;return y("div",{className:"uppy-Dashboard-AddFiles",children:[this.renderHiddenInput(!1,r=>{this.fileInput=r}),this.renderHiddenInput(!0,r=>{this.folderInput=r}),e&&this.renderHiddenCameraInput("photo",n,r=>{this.mobilePhotoFileInput=r}),i&&this.renderHiddenCameraInput("video",n,r=>{this.mobileVideoFileInput=r}),this.renderSourcesList(this.props.acquirers,this.props.disableLocalFiles),y("div",{className:"uppy-Dashboard-AddFiles-info",children:[this.props.note&&y("div",{className:"uppy-Dashboard-note",children:this.props.note}),this.props.proudlyDisplayPoweredByUppy&&this.renderPoweredByUppy()]})]})}},Jp=QC;var NR=nt(ji(),1);var gN=t=>y("div",{className:(0,NR.default)("uppy-Dashboard-AddFilesPanel",t.className),"data-uppy-panelType":"AddFiles","aria-hidden":!t.showAddFilesPanel,children:[y("div",{className:"uppy-DashboardContent-bar",children:[y("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:t.i18n("addingMoreFiles")}),y("button",{className:"uppy-DashboardContent-back",type:"button",onClick:()=>t.toggleAddFilesPanel(!1),children:t.i18n("back")})]}),y(Jp,w({},t))]}),BR=gN;var HR=nt(ji(),1);function mN(t){let e=t.files[t.fileCardFor],i=()=>{t.uppy.emit("file-editor:cancel",e),t.closeFileEditor()};return y("div",{className:(0,HR.default)("uppy-DashboardContent-panel",t.className),role:"tabpanel","data-uppy-panelType":"FileEditor",id:"uppy-DashboardContent-panel--editor",children:[y("div",{className:"uppy-DashboardContent-bar",children:[y("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:t.i18nArray("editing",{file:y("span",{className:"uppy-DashboardContent-titleFile",children:e.meta?e.meta.name:e.name})})}),y("button",{className:"uppy-DashboardContent-back",type:"button",onClick:i,children:t.i18n("cancel")}),y("button",{className:"uppy-DashboardContent-save",type:"button",onClick:t.saveFileEditor,children:t.i18n("save")})]}),y("div",{className:"uppy-DashboardContent-panelBody",children:t.editors.map(n=>t.uppy.getPlugin(n.id).render(t.state))})]})}var zR=mN;var VR=nt(ji(),1);function vN(){return y("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25",children:y("g",{fill:"#686DE0",fillRule:"evenodd",children:[y("path",{d:"M5 7v10h15V7H5zm0-1h15a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1z",fillRule:"nonzero"}),y("path",{d:"M6.35 17.172l4.994-5.026a.5.5 0 0 1 .707 0l2.16 2.16 3.505-3.505a.5.5 0 0 1 .707 0l2.336 2.31-.707.72-1.983-1.97-3.505 3.505a.5.5 0 0 1-.707 0l-2.16-2.159-3.938 3.939-1.409.026z",fillRule:"nonzero"}),y("circle",{cx:"7.5",cy:"9.5",r:"1.5"})]})})}function CN(){return y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:y("path",{d:"M9.5 18.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V7.25a.5.5 0 0 1 .379-.485l9-2.25A.5.5 0 0 1 18.5 5v11.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V8.67l-8 2v7.97zm8-11v-2l-8 2v2l8-2zM7 19.64c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1zm9-2c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1z",fill:"#049BCF",fillRule:"nonzero"})})}function wN(){return y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:y("path",{d:"M16 11.834l4.486-2.691A1 1 0 0 1 22 10v6a1 1 0 0 1-1.514.857L16 14.167V17a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v2.834zM15 9H5v8h10V9zm1 4l5 3v-6l-5 3z",fill:"#19AF67",fillRule:"nonzero"})})}function bN(){return y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:y("path",{d:"M9.766 8.295c-.691-1.843-.539-3.401.747-3.726 1.643-.414 2.505.938 2.39 3.299-.039.79-.194 1.662-.537 3.148.324.49.66.967 1.055 1.51.17.231.382.488.629.757 1.866-.128 3.653.114 4.918.655 1.487.635 2.192 1.685 1.614 2.84-.566 1.133-1.839 1.084-3.416.249-1.141-.604-2.457-1.634-3.51-2.707a13.467 13.467 0 0 0-2.238.426c-1.392 4.051-4.534 6.453-5.707 4.572-.986-1.58 1.38-4.206 4.914-5.375.097-.322.185-.656.264-1.001.08-.353.306-1.31.407-1.737-.678-1.059-1.2-2.031-1.53-2.91zm2.098 4.87c-.033.144-.068.287-.104.427l.033-.01-.012.038a14.065 14.065 0 0 1 1.02-.197l-.032-.033.052-.004a7.902 7.902 0 0 1-.208-.271c-.197-.27-.38-.526-.555-.775l-.006.028-.002-.003c-.076.323-.148.632-.186.8zm5.77 2.978c1.143.605 1.832.632 2.054.187.26-.519-.087-1.034-1.113-1.473-.911-.39-2.175-.608-3.55-.608.845.766 1.787 1.459 2.609 1.894zM6.559 18.789c.14.223.693.16 1.425-.413.827-.648 1.61-1.747 2.208-3.206-2.563 1.064-4.102 2.867-3.633 3.62zm5.345-10.97c.088-1.793-.351-2.48-1.146-2.28-.473.119-.564 1.05-.056 2.405.213.566.52 1.188.908 1.859.18-.858.268-1.453.294-1.984z",fill:"#E2514A",fillRule:"nonzero"})})}function yN(){return y("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25",children:y("path",{d:"M10.45 2.05h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V2.55a.5.5 0 0 1 .5-.5zm2.05 1.024h1.05a.5.5 0 0 1 .5.5V3.6a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5v-.001zM10.45 0h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V.5a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 3.074h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 1.024h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm-2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-1.656 3.074l-.82 5.946c.52.302 1.174.458 1.976.458.803 0 1.455-.156 1.975-.458l-.82-5.946h-2.311zm0-1.025h2.312c.512 0 .946.378 1.015.885l.82 5.946c.056.412-.142.817-.501 1.026-.686.398-1.515.597-2.49.597-.974 0-1.804-.199-2.49-.597a1.025 1.025 0 0 1-.5-1.026l.819-5.946c.07-.507.503-.885 1.015-.885zm.545 6.6a.5.5 0 0 1-.397-.561l.143-.999a.5.5 0 0 1 .495-.429h.74a.5.5 0 0 1 .495.43l.143.998a.5.5 0 0 1-.397.561c-.404.08-.819.08-1.222 0z",fill:"#00C469",fillRule:"nonzero"})})}function SN(){return y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:y("g",{fill:"#A7AFB7",fillRule:"nonzero",children:[y("path",{d:"M5.5 22a.5.5 0 0 1-.5-.5v-18a.5.5 0 0 1 .5-.5h10.719a.5.5 0 0 1 .367.16l3.281 3.556a.5.5 0 0 1 .133.339V21.5a.5.5 0 0 1-.5.5h-14zm.5-1h13V7.25L16 4H6v17z"}),y("path",{d:"M15 4v3a1 1 0 0 0 1 1h3V7h-3V4h-1z"})]})})}function xN(){return y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:y("path",{d:"M4.5 7h13a.5.5 0 1 1 0 1h-13a.5.5 0 0 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h10a.5.5 0 1 1 0 1h-10a.5.5 0 1 1 0-1z",fill:"#5A5E69",fillRule:"nonzero"})})}function Ks(t){let e={color:"#838999",icon:SN()};if(!t)return e;let i=t.split("/")[0],n=t.split("/")[1];return i==="text"?{color:"#5a5e69",icon:xN()}:i==="image"?{color:"#686de0",icon:vN()}:i==="audio"?{color:"#068dbb",icon:CN()}:i==="video"?{color:"#19af67",icon:wN()}:i==="application"&&n==="pdf"?{color:"#e25149",icon:bN()}:i==="application"&&["zip","x-7z-compressed","x-zip-compressed","x-rar-compressed","x-tar","x-gzip","x-apple-diskimage"].indexOf(n)!==-1?{color:"#00C469",icon:yN()}:e}function EN(t){let{tagName:e}=t.target;if(e==="INPUT"||e==="TEXTAREA"){t.stopPropagation();return}t.preventDefault(),t.stopPropagation()}var fr=EN;function Vd(t){let{file:e}=t;if(e.preview)return y("img",{draggable:!1,className:"uppy-Dashboard-Item-previewImg",alt:e.name,src:e.preview});let{color:i,icon:n}=Ks(e.type);return y("div",{className:"uppy-Dashboard-Item-previewIconWrap",children:[y("span",{className:"uppy-Dashboard-Item-previewIcon",style:{color:i},children:n}),y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-Dashboard-Item-previewIconBg",width:"58",height:"76",viewBox:"0 0 58 76",children:y("rect",{fill:"#FFF",width:"58",height:"76",rx:"3",fillRule:"evenodd"})})]})}function ZC(t){let{computedMetaFields:e,requiredMetaFields:i,updateMeta:n,form:r,formState:o}=t,s={text:"uppy-u-reset uppy-c-textInput uppy-Dashboard-FileCard-input"};return e.map(a=>{let l=`uppy-Dashboard-FileCard-input-${a.id}`,c=i.includes(a.id);return y("fieldset",{className:"uppy-Dashboard-FileCard-fieldset",children:[y("label",{className:"uppy-Dashboard-FileCard-label",htmlFor:l,children:a.name}),a.render!==void 0?a.render({value:o[a.id],onChange:d=>n(d,a.id),fieldCSSClasses:s,required:c,form:r.id},yd):y("input",{className:s.text,id:l,form:r.id,type:a.type||"text",required:c,value:o[a.id],placeholder:a.placeholder,onInput:d=>n(d.target.value,a.id),"data-uppy-super-focusable":!0})]},a.id)})}function ew(t){let{files:e,fileCardFor:i,toggleFileCard:n,saveFileCard:r,metaFields:o,requiredMetaFields:s,openFileEditor:a,i18n:l,i18nArray:c,className:d,canEditFile:u}=t,h=()=>typeof o=="function"?o(e[i]):o,p=e[i],f=h()??[],g=u(p),m={};f.forEach(P=>{m[P.id]=p.meta[P.id]??""});let[v,C]=nn(m),b=Jn(P=>{P.preventDefault(),r(v,i)},[r,v,i]),S=(P,L)=>{C(k(w({},v),{[L]:P}))},x=()=>{n(!1)},[E]=nn(()=>{let P=document.createElement("form");return P.setAttribute("tabindex","-1"),P.id=Jo(),P});return Xn(()=>(document.body.appendChild(E),E.addEventListener("submit",b),()=>{E.removeEventListener("submit",b),E.parentNode&&document.body.removeChild(E)}),[E,b]),y("div",{className:(0,VR.default)("uppy-Dashboard-FileCard",d),"data-uppy-panelType":"FileCard",onDragOver:fr,onDragLeave:fr,onDrop:fr,onPaste:fr,children:[y("div",{className:"uppy-DashboardContent-bar",children:[y("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:c("editing",{file:y("span",{className:"uppy-DashboardContent-titleFile",children:p.meta?p.meta.name:p.name})})}),y("button",{className:"uppy-DashboardContent-back",type:"button",form:E.id,title:l("finishEditingFile"),onClick:x,children:l("cancel")})]}),y("div",{className:"uppy-Dashboard-FileCard-inner",children:[y("div",{className:"uppy-Dashboard-FileCard-preview",style:{backgroundColor:Ks(p.type).color},children:[y(Vd,{file:p}),g&&y("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-Dashboard-FileCard-edit",onClick:P=>{b(P),a(p)},children:l("editImage")})]}),y("div",{className:"uppy-Dashboard-FileCard-info",children:y(ZC,{computedMetaFields:f,requiredMetaFields:s,updateMeta:S,form:E,formState:v})}),y("div",{className:"uppy-Dashboard-FileCard-actions",children:[y("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Dashboard-FileCard-actionsBtn",type:"submit",form:E.id,children:l("saveChanges")}),y("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-link uppy-Dashboard-FileCard-actionsBtn",type:"button",onClick:x,form:E.id,children:l("cancel")})]})]})]})}var jR=nt(ji(),1);function GR(t,e){if(t===e)return!0;if(!t||!e)return!1;let i=Object.keys(t),n=Object.keys(e),r=i.length;if(n.length!==r)return!1;for(let o=0;o<r;o++){let s=i[o];if(t[s]!==e[s]||!Object.prototype.hasOwnProperty.call(e,s))return!1}return!0}function tw(t,e="Copy the URL below"){return new Promise(i=>{let n=document.createElement("textarea");n.setAttribute("style",{position:"fixed",top:0,left:0,width:"2em",height:"2em",padding:0,border:"none",outline:"none",boxShadow:"none",background:"transparent"}),n.value=t,document.body.appendChild(n),n.select();let r=()=>{document.body.removeChild(n),window.prompt(e,t),i()};try{return document.execCommand("copy")?(document.body.removeChild(n),i()):r()}catch{return document.body.removeChild(n),r()}})}function PN({file:t,uploadInProgressOrComplete:e,metaFields:i,canEditFile:n,i18n:r,onClick:o}){return!e&&i&&i.length>0||!e&&n(t)?y("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-action uppy-Dashboard-Item-action--edit",type:"button","aria-label":r("editFileWithFilename",{file:t.meta.name}),title:r("editFileWithFilename",{file:t.meta.name}),onClick:()=>o(),children:y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 14",children:y("g",{fillRule:"evenodd",children:[y("path",{d:"M1.5 10.793h2.793A1 1 0 0 0 5 10.5L11.5 4a1 1 0 0 0 0-1.414L9.707.793a1 1 0 0 0-1.414 0l-6.5 6.5A1 1 0 0 0 1.5 8v2.793zm1-1V8L9 1.5l1.793 1.793-6.5 6.5H2.5z",fillRule:"nonzero"}),y("rect",{x:"1",y:"12.293",width:"11",height:"1",rx:".5"}),y("path",{fillRule:"nonzero",d:"M6.793 2.5L9.5 5.207l.707-.707L7.5 1.793z"})]})})}):null}function RN({i18n:t,onClick:e,file:i}){return y("button",{className:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--remove",type:"button","aria-label":t("removeFile",{file:i.meta.name}),title:t("removeFile",{file:i.meta.name}),onClick:()=>e(),children:y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"18",height:"18",viewBox:"0 0 18 18",children:[y("path",{d:"M9 0C4.034 0 0 4.034 0 9s4.034 9 9 9 9-4.034 9-9-4.034-9-9-9z"}),y("path",{fill:"#FFF",d:"M13 12.222l-.778.778L9 9.778 5.778 13 5 12.222 8.222 9 5 5.778 5.778 5 9 8.222 12.222 5l.778.778L9.778 9z"})]})})}function _N({file:t,uppy:e,i18n:i}){let n=r=>{tw(t.uploadURL,i("copyLinkToClipboardFallback")).then(()=>{e.log("Link copied to clipboard."),e.info(i("copyLinkToClipboardSuccess"),"info",3e3)}).catch(e.log).then(()=>r.target.focus({preventScroll:!0}))};return y("button",{className:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--copyLink",type:"button","aria-label":i("copyLink"),title:i("copyLink"),onClick:r=>n(r),children:y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 12",children:y("path",{d:"M7.94 7.703a2.613 2.613 0 0 1-.626 2.681l-.852.851a2.597 2.597 0 0 1-1.849.766A2.616 2.616 0 0 1 2.764 7.54l.852-.852a2.596 2.596 0 0 1 2.69-.625L5.267 7.099a1.44 1.44 0 0 0-.833.407l-.852.851a1.458 1.458 0 0 0 1.03 2.486c.39 0 .755-.152 1.03-.426l.852-.852c.231-.231.363-.522.406-.824l1.04-1.038zm4.295-5.937A2.596 2.596 0 0 0 10.387 1c-.698 0-1.355.272-1.849.766l-.852.851a2.614 2.614 0 0 0-.624 2.688l1.036-1.036c.041-.304.173-.6.407-.833l.852-.852c.275-.275.64-.426 1.03-.426a1.458 1.458 0 0 1 1.03 2.486l-.852.851a1.442 1.442 0 0 1-.824.406l-1.04 1.04a2.596 2.596 0 0 0 2.683-.628l.851-.85a2.616 2.616 0 0 0 0-3.697zm-6.88 6.883a.577.577 0 0 0 .82 0l3.474-3.474a.579.579 0 1 0-.819-.82L5.355 7.83a.579.579 0 0 0 0 .819z"})})})}function iw(t){let{uppy:e,file:i,uploadInProgressOrComplete:n,canEditFile:r,metaFields:o,showLinkToFileUploadResult:s,showRemoveButton:a,i18n:l,toggleFileCard:c,openFileEditor:d}=t;return y("div",{className:"uppy-Dashboard-Item-actionWrapper",children:[y(PN,{i18n:l,file:i,uploadInProgressOrComplete:n,canEditFile:r,metaFields:o,onClick:()=>{o&&o.length>0?c(!0,i.id):d(i)}}),s&&i.uploadURL?y(_N,{file:i,uppy:e,i18n:l}):null,a?y(RN,{i18n:l,file:i,onClick:()=>e.removeFile(i.id)}):null]})}var WR=nt(cd(),1);var kN=(t,e)=>(typeof e=="function"?e():e).filter(r=>r.id===t)[0].name;function Gd(t){let{file:e,toggleFileCard:i,i18n:n,metaFields:r}=t,{missingRequiredMetaFields:o}=e;if(!o?.length)return null;let s=o.map(a=>kN(a,r)).join(", ");return y("div",{className:"uppy-Dashboard-Item-errorMessage",children:[n("missingRequiredMetaFields",{smart_count:o.length,fields:s})," ",y("button",{type:"button",class:"uppy-u-reset uppy-Dashboard-Item-errorMessageBtn",onClick:()=>i(!0,e.id),children:n("editFile")})]})}var FN=t=>{let{author:e,name:i}=t.file.meta;function n(){return t.isSingleFile&&t.containerHeight>=350?90:t.containerWidth<=352?35:t.containerWidth<=576?60:e?20:30}return y("div",{className:"uppy-Dashboard-Item-name",title:i,children:md(i,n())})},TN=t=>{let{author:e}=t.file.meta,i=t.file.remote?.providerName,n="\xB7";return e?y("div",{className:"uppy-Dashboard-Item-author",children:[y("a",{href:`${e.url}?utm_source=Companion&utm_medium=referral`,target:"_blank",rel:"noopener noreferrer",children:md(e.name,13)}),i?y(ei,{children:[` ${n} `,i,` ${n} `]}):null]}):null},DN=t=>t.file.size&&y("div",{className:"uppy-Dashboard-Item-statusSize",children:(0,WR.default)(t.file.size)}),MN=t=>t.file.isGhost&&y("span",{children:[" \u2022 ",y("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-reSelect",type:"button",onClick:()=>t.toggleAddFilesPanel(!0),children:t.i18n("reSelect")})]}),IN=({file:t,onClick:e})=>t.error?y("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-errorDetails","aria-label":t.error,"data-microtip-position":"bottom","data-microtip-size":"medium",onClick:e,type:"button",children:"?"}):null;function nw(t){let{file:e,i18n:i,toggleFileCard:n,metaFields:r,toggleAddFilesPanel:o,isSingleFile:s,containerHeight:a,containerWidth:l}=t;return y("div",{className:"uppy-Dashboard-Item-fileInfo","data-uppy-file-source":e.source,children:[y("div",{className:"uppy-Dashboard-Item-fileName",children:[FN({file:e,isSingleFile:s,containerHeight:a,containerWidth:l}),y(IN,{file:e,onClick:()=>alert(e.error)})]}),y("div",{className:"uppy-Dashboard-Item-status",children:[TN({file:e}),DN({file:e}),MN({file:e,toggleAddFilesPanel:o,i18n:i})]}),y(Gd,{file:e,i18n:i,toggleFileCard:n,metaFields:r})]})}function rw(t){let{file:e,i18n:i,toggleFileCard:n,metaFields:r,showLinkToFileUploadResult:o}=t,a=e.preview?"rgba(255, 255, 255, 0.5)":Ks(e.type).color;return y("div",{className:"uppy-Dashboard-Item-previewInnerWrap",style:{backgroundColor:a},children:[o&&e.uploadURL&&y("a",{className:"uppy-Dashboard-Item-previewLink",href:e.uploadURL,rel:"noreferrer noopener",target:"_blank","aria-label":e.meta.name,children:y("span",{hidden:!0,children:e.meta.name})}),y(Vd,{file:e}),y(Gd,{file:e,i18n:i,toggleFileCard:n,metaFields:r})]})}function AN(t){if(!t.isUploaded){if(t.error&&!t.hideRetryButton){t.uppy.retryUpload(t.file.id);return}t.resumableUploads&&!t.hidePauseResumeButton?t.uppy.pauseResume(t.file.id):t.individualCancellation&&!t.hideCancelButton&&t.uppy.removeFile(t.file.id)}}function UR(t){return t.isUploaded?t.i18n("uploadComplete"):t.error?t.i18n("retryUpload"):t.resumableUploads?t.file.isPaused?t.i18n("resumeUpload"):t.i18n("pauseUpload"):t.individualCancellation?t.i18n("cancelUpload"):""}function ow(t){return y("div",{className:"uppy-Dashboard-Item-progress",children:y("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-progressIndicator",type:"button","aria-label":UR(t),title:UR(t),onClick:()=>AN(t),children:t.children})})}function Qp({children:t}){return y("svg",{"aria-hidden":"true",focusable:"false",width:"70",height:"70",viewBox:"0 0 36 36",className:"uppy-c-icon uppy-Dashboard-Item-progressIcon--circle",children:t})}function sw({progress:t}){let e=2*Math.PI*15;return y("g",{children:[y("circle",{className:"uppy-Dashboard-Item-progressIcon--bg",r:"15",cx:"18",cy:"18","stroke-width":"2",fill:"none"}),y("circle",{className:"uppy-Dashboard-Item-progressIcon--progress",r:"15",cx:"18",cy:"18",transform:"rotate(-90, 18, 18)",fill:"none","stroke-width":"2","stroke-dasharray":e,"stroke-dashoffset":e-e/100*t})]})}function aw(t){return!t.file.progress.uploadStarted||t.file.progress.percentage===void 0?null:t.isUploaded?y("div",{className:"uppy-Dashboard-Item-progress",children:y("div",{className:"uppy-Dashboard-Item-progressIndicator",children:y(Qp,{children:[y("circle",{r:"15",cx:"18",cy:"18",fill:"#1bb240"}),y("polygon",{className:"uppy-Dashboard-Item-progressIcon--check",transform:"translate(2, 3)",points:"14 22.5 7 15.2457065 8.99985857 13.1732815 14 18.3547104 22.9729883 9 25 11.1005634"})]})})}):t.recoveredState?null:t.error&&!t.hideRetryButton?y(ow,k(w({},t),{children:y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-Dashboard-Item-progressIcon--retry",width:"28",height:"31",viewBox:"0 0 16 19",children:[y("path",{d:"M16 11a8 8 0 1 1-8-8v2a6 6 0 1 0 6 6h2z"}),y("path",{d:"M7.9 3H10v2H7.9z"}),y("path",{d:"M8.536.5l3.535 3.536-1.414 1.414L7.12 1.914z"}),y("path",{d:"M10.657 2.621l1.414 1.415L8.536 7.57 7.12 6.157z"})]})})):t.resumableUploads&&!t.hidePauseResumeButton?y(ow,k(w({},t),{children:y(Qp,{children:[y(sw,{progress:t.file.progress.percentage}),t.file.isPaused?y("polygon",{className:"uppy-Dashboard-Item-progressIcon--play",transform:"translate(3, 3)",points:"12 20 12 10 20 15"}):y("g",{className:"uppy-Dashboard-Item-progressIcon--pause",transform:"translate(14.5, 13)",children:[y("rect",{x:"0",y:"0",width:"2",height:"10",rx:"0"}),y("rect",{x:"5",y:"0",width:"2",height:"10",rx:"0"})]})]})})):!t.resumableUploads&&t.individualCancellation&&!t.hideCancelButton?y(ow,k(w({},t),{children:y(Qp,{children:[y(sw,{progress:t.file.progress.percentage}),y("polygon",{className:"cancel",transform:"translate(2, 2)",points:"19.8856516 11.0625 16 14.9481516 12.1019737 11.0625 11.0625 12.1143484 14.9481516 16 11.0625 19.8980263 12.1019737 20.9375 16 17.0518484 19.8856516 20.9375 20.9375 19.8980263 17.0518484 16 20.9375 12"})]})})):y("div",{className:"uppy-Dashboard-Item-progress",children:y("div",{className:"uppy-Dashboard-Item-progressIndicator",children:y(Qp,{children:y(sw,{progress:t.file.progress.percentage})})})})}var Zp=class extends bi{componentDidMount(){let{file:e}=this.props;e.preview||this.props.handleRequestThumbnail(e)}shouldComponentUpdate(e){return!GR(this.props,e)}componentDidUpdate(){let{file:e}=this.props;e.preview||this.props.handleRequestThumbnail(e)}componentWillUnmount(){let{file:e}=this.props;e.preview||this.props.handleCancelThumbnail(e)}render(){let{file:e}=this.props,i=e.progress.preprocess||e.progress.postprocess,n=!!e.progress.uploadComplete&&!i&&!e.error,r=!!e.progress.uploadStarted||!!i,o=e.progress.uploadStarted&&!e.progress.uploadComplete||i,s=e.error||!1,{isGhost:a}=e,l=(this.props.individualCancellation||!o)&&!n;n&&this.props.showRemoveButtonAfterComplete&&(l=!0);let c=(0,jR.default)({"uppy-Dashboard-Item":!0,"is-inprogress":o&&!this.props.recoveredState,"is-processing":i,"is-complete":n,"is-error":!!s,"is-resumable":this.props.resumableUploads,"is-noIndividualCancellation":!this.props.individualCancellation,"is-ghost":a});return y("div",{className:c,id:`uppy_${e.id}`,role:this.props.role,children:[y("div",{className:"uppy-Dashboard-Item-preview",children:[y(rw,{file:e,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,i18n:this.props.i18n,toggleFileCard:this.props.toggleFileCard,metaFields:this.props.metaFields}),y(aw,{uppy:this.props.uppy,file:e,error:s,isUploaded:n,hideRetryButton:this.props.hideRetryButton,hideCancelButton:this.props.hideCancelButton,hidePauseResumeButton:this.props.hidePauseResumeButton,recoveredState:this.props.recoveredState,resumableUploads:this.props.resumableUploads,individualCancellation:this.props.individualCancellation,i18n:this.props.i18n})]}),y("div",{className:"uppy-Dashboard-Item-fileInfoAndButtons",children:[y(nw,{file:e,containerWidth:this.props.containerWidth,containerHeight:this.props.containerHeight,i18n:this.props.i18n,toggleAddFilesPanel:this.props.toggleAddFilesPanel,toggleFileCard:this.props.toggleFileCard,metaFields:this.props.metaFields,isSingleFile:this.props.isSingleFile}),y(iw,{file:e,metaFields:this.props.metaFields,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,showRemoveButton:l,canEditFile:this.props.canEditFile,uploadInProgressOrComplete:r,toggleFileCard:this.props.toggleFileCard,openFileEditor:this.props.openFileEditor,uppy:this.props.uppy,i18n:this.props.i18n})]})]})}};function ON(t,e){let i=[],n=[];return t.forEach(r=>{n.length<e?n.push(r):(i.push(n),n=[r])}),n.length&&i.push(n),i}function lw({id:t,i18n:e,uppy:i,files:n,resumableUploads:r,hideRetryButton:o,hidePauseResumeButton:s,hideCancelButton:a,showLinkToFileUploadResult:l,showRemoveButtonAfterComplete:c,metaFields:d,isSingleFile:u,toggleFileCard:h,handleRequestThumbnail:p,handleCancelThumbnail:f,recoveredState:g,individualCancellation:m,itemsPerRow:v,openFileEditor:C,canEditFile:b,toggleAddFilesPanel:S,containerWidth:x,containerHeight:E}){let P=v===1?71:200,L=Us(()=>{let j=(Y,he)=>Number(n[he].isGhost)-Number(n[Y].isGhost),q=Object.keys(n);return g&&q.sort(j),ON(q,v)},[n,v,g]),B=j=>y("div",{class:"uppy-Dashboard-filesInner",role:"presentation",children:j.map(q=>y(Zp,{uppy:i,id:t,i18n:e,resumableUploads:r,individualCancellation:m,hideRetryButton:o,hidePauseResumeButton:s,hideCancelButton:a,showLinkToFileUploadResult:l,showRemoveButtonAfterComplete:c,metaFields:d,recoveredState:g,isSingleFile:u,containerWidth:x,containerHeight:E,toggleFileCard:h,handleRequestThumbnail:p,handleCancelThumbnail:f,role:"listitem",openFileEditor:C,canEditFile:b,toggleAddFilesPanel:S,file:n[q]},q))},j[0]);return u?y("div",{class:"uppy-Dashboard-files",children:B(L[0])}):y(dl,{class:"uppy-Dashboard-files",role:"list",data:L,renderRow:B,rowHeight:P})}var qR=300,ef=class extends bi{ref=DE();componentWillEnter(e){this.ref.current.style.opacity="1",this.ref.current.style.transform="none",setTimeout(e,qR)}componentWillLeave(e){this.ref.current.style.opacity="0",this.ref.current.style.transform="translateY(350%)",setTimeout(e,qR)}render(){let{children:e}=this.props;return y("div",{className:"uppy-Informer-animated",ref:this.ref,children:e})}};function LN(t,e){return Object.assign(t,e)}function NN(t,e){return t?.key??e}function BN(t,e){let i=t._ptgLinkedRefs||(t._ptgLinkedRefs={});return i[e]||(i[e]=n=>{t.refs[e]=n})}function Wd(t){let e={};for(let i=0;i<t.length;i++)if(t[i]!=null){let n=NN(t[i],i.toString(36));e[n]=t[i]}return e}function HN(t,e){t=t||{},e=e||{};let i=s=>Object.hasOwn(e,s)?e[s]:t[s],n={},r=[];for(let s in t)Object.hasOwn(e,s)?r.length&&(n[s]=r,r=[]):r.push(s);let o={};for(let s in e){if(Object.hasOwn(n,s))for(let a=0;a<n[s].length;a++){let l=n[s][a];o[n[s][a]]=i(l)}o[s]=i(s)}for(let s=0;s<r.length;s++)o[r[s]]=i(r[s]);return o}var zN=t=>t,VN=(()=>{class t extends bi{constructor(i,n){super(i,n),this.refs={},this.state={children:Wd(pr(pr(this.props.children))||[])},this.performAppear=this.performAppear.bind(this),this.performEnter=this.performEnter.bind(this),this.performLeave=this.performLeave.bind(this)}componentWillMount(){this.currentlyTransitioningKeys={},this.keysToAbortLeave=[],this.keysToEnter=[],this.keysToLeave=[]}componentDidMount(){let i=this.state.children;for(let n in i)i[n]&&this.performAppear(n)}componentWillReceiveProps(i){let n=Wd(pr(i.children)||[]),r=this.state.children;this.setState(s=>({children:HN(s.children,n)}));let o;for(o in n)if(Object.hasOwn(n,o)){let s=r&&Object.hasOwn(r,o);n[o]&&s&&this.currentlyTransitioningKeys[o]?(this.keysToEnter.push(o),this.keysToAbortLeave.push(o)):n[o]&&!s&&!this.currentlyTransitioningKeys[o]&&this.keysToEnter.push(o)}for(o in r)if(Object.hasOwn(r,o)){let s=n&&Object.hasOwn(n,o);r[o]&&!s&&!this.currentlyTransitioningKeys[o]&&this.keysToLeave.push(o)}}componentDidUpdate(){let{keysToEnter:i}=this;this.keysToEnter=[],i.forEach(this.performEnter);let{keysToLeave:n}=this;this.keysToLeave=[],n.forEach(this.performLeave)}_finishAbort(i){let n=this.keysToAbortLeave.indexOf(i);n!==-1&&this.keysToAbortLeave.splice(n,1)}performAppear(i){this.currentlyTransitioningKeys[i]=!0;let n=this.refs[i];n?.componentWillAppear?n.componentWillAppear(this._handleDoneAppearing.bind(this,i)):this._handleDoneAppearing(i)}_handleDoneAppearing(i){let n=this.refs[i];n?.componentDidAppear&&n.componentDidAppear(),delete this.currentlyTransitioningKeys[i],this._finishAbort(i);let r=Wd(pr(this.props.children)||[]);(!r||!Object.hasOwn(r,i))&&this.performLeave(i)}performEnter(i){this.currentlyTransitioningKeys[i]=!0;let n=this.refs[i];n?.componentWillEnter?n.componentWillEnter(this._handleDoneEntering.bind(this,i)):this._handleDoneEntering(i)}_handleDoneEntering(i){let n=this.refs[i];n?.componentDidEnter&&n.componentDidEnter(),delete this.currentlyTransitioningKeys[i],this._finishAbort(i);let r=Wd(pr(this.props.children)||[]);(!r||!Object.hasOwn(r,i))&&this.performLeave(i)}performLeave(i){if(this.keysToAbortLeave.indexOf(i)!==-1)return;this.currentlyTransitioningKeys[i]=!0;let r=this.refs[i];r?.componentWillLeave?r.componentWillLeave(this._handleDoneLeaving.bind(this,i)):this._handleDoneLeaving(i)}_handleDoneLeaving(i){if(this.keysToAbortLeave.indexOf(i)!==-1)return;let r=this.refs[i];r?.componentDidLeave&&r.componentDidLeave(),delete this.currentlyTransitioningKeys[i];let o=Wd(pr(this.props.children)||[]);if(o&&Object.hasOwn(o,i))this.performEnter(i);else{let s=LN({},this.state.children);delete s[i],this.setState({children:s})}}render(p,{children:h}){var f=p,{childFactory:i,transitionLeave:n,transitionName:r,transitionAppear:o,transitionEnter:s,transitionLeaveTimeout:a,transitionEnterTimeout:l,transitionAppearTimeout:c,component:d}=f,u=Vt(f,["childFactory","transitionLeave","transitionName","transitionAppear","transitionEnter","transitionLeaveTimeout","transitionEnterTimeout","transitionAppearTimeout","component"]);let g=Object.entries(h).map(([m,v])=>{if(!v)return;let C=BN(this,m);return Fp(i(v),{ref:C,key:m})}).filter(Boolean);return yd(d,u,g)}}return t.defaultProps={component:"span",childFactory:zN},t})(),$R=VN;var Ud=class extends bi{render(){let{info:e}=this.props.uppy.getState();return y("div",{className:"uppy uppy-Informer",children:y($R,{children:e.map(i=>y(ef,{children:y("p",{role:"alert",children:[i.message," ",i.details&&y("span",{"aria-label":i.details,"data-microtip-position":"top-left","data-microtip-size":"medium",role:"tooltip",onClick:()=>alert(`${i.message} 

 ${i.details}`),children:"?"})]})},i.message))})})}};var KR=nt(ji(),1);function GN({activePickerPanel:t,className:e,hideAllPanels:i,i18n:n,state:r,uppy:o}){let s=Xo(null);return y("div",{className:(0,KR.default)("uppy-DashboardContent-panel",e),role:"tabpanel","data-uppy-panelType":"PickerPanel",id:`uppy-DashboardContent-panel--${t.id}`,onDragOver:fr,onDragLeave:fr,onDrop:fr,onPaste:fr,children:[y("div",{className:"uppy-DashboardContent-bar",children:[y("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:n("importFrom",{name:t.name})}),y("button",{className:"uppy-DashboardContent-back",type:"button",onClick:i,children:n("cancel")})]}),y("div",{ref:s,className:"uppy-DashboardContent-panelBody",children:o.getPlugin(t.id).render(r,s.current)})]})}var YR=GN;var gr={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete",STATE_PAUSED:"paused"};function WN(t,e,i,n={}){if(t)return gr.STATE_ERROR;if(e)return gr.STATE_COMPLETE;if(i)return gr.STATE_PAUSED;let r=gr.STATE_WAITING,o=Object.keys(n);for(let s=0;s<o.length;s++){let{progress:a}=n[o[s]];if(a.uploadStarted&&!a.uploadComplete)return gr.STATE_UPLOADING;a.preprocess&&r!==gr.STATE_UPLOADING&&(r=gr.STATE_PREPROCESSING),a.postprocess&&r!==gr.STATE_UPLOADING&&r!==gr.STATE_PREPROCESSING&&(r=gr.STATE_POSTPROCESSING)}return r}function UN({files:t,i18n:e,isAllComplete:i,isAllErrored:n,isAllPaused:r,inProgressNotPausedFiles:o,newFiles:s,processingFiles:a}){switch(WN(n,i,r,t)){case"uploading":return e("uploadingXFiles",{smart_count:o.length});case"preprocessing":case"postprocessing":return e("processingXFiles",{smart_count:a.length});case"paused":return e("uploadPaused");case"waiting":return e("xFilesSelected",{smart_count:s.length});case"complete":return e("uploadComplete");case"error":return e("error");default:}}function jN(t){let{i18n:e,isAllComplete:i,hideCancelButton:n,maxNumberOfFiles:r,toggleAddFilesPanel:o,uppy:s}=t,{allowNewUpload:a}=t;return a&&r&&(a=t.totalFileCount<t.maxNumberOfFiles),y("div",{className:"uppy-DashboardContent-bar",children:[!i&&!n?y("button",{className:"uppy-DashboardContent-back",type:"button",onClick:()=>s.cancelAll(),children:e("cancel")}):y("div",{}),y("div",{className:"uppy-DashboardContent-title",children:y(UN,w({},t))}),a?y("button",{className:"uppy-DashboardContent-addMore",type:"button","aria-label":e("addMoreFiles"),title:e("addMoreFiles"),onClick:()=>o(!0),children:[y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"15",height:"15",viewBox:"0 0 15 15",children:y("path",{d:"M8 6.5h6a.5.5 0 0 1 .5.5v.5a.5.5 0 0 1-.5.5H8v6a.5.5 0 0 1-.5.5H7a.5.5 0 0 1-.5-.5V8h-6a.5.5 0 0 1-.5-.5V7a.5.5 0 0 1 .5-.5h6v-6A.5.5 0 0 1 7 0h.5a.5.5 0 0 1 .5.5v6z"})}),y("span",{className:"uppy-DashboardContent-addMoreCaption",children:e("addMore")})]}):y("div",{})]})}var XR=jN;var QR=nt(ji(),1);var Cl="uppy-transition-slideDownUp",JR=250;function qN({children:t}){let[e,i]=nn(null),[n,r]=nn(""),o=Xo(),s=Xo(),a=Xo(),l=Jn(()=>{r(`${Cl}-enter`),cancelAnimationFrame(a.current),clearTimeout(s.current),s.current=void 0,a.current=requestAnimationFrame(()=>{r(`${Cl}-enter ${Cl}-enter-active`),o.current=setTimeout(()=>{r("")},JR)})},[]),c=Jn(()=>{r(`${Cl}-leave`),cancelAnimationFrame(a.current),clearTimeout(o.current),o.current=void 0,a.current=requestAnimationFrame(()=>{r(`${Cl}-leave ${Cl}-leave-active`),s.current=setTimeout(()=>{i(null),r("")},JR)})},[]);return Xn(()=>{let d=pr(t)[0];e!==d&&(d&&!e?l():e&&!d&&!s.current&&c(),i(d))},[t,e,l,c]),Xn(()=>()=>{clearTimeout(o.current),clearTimeout(s.current),cancelAnimationFrame(a.current)},[]),e?Fp(e,{className:(0,QR.default)(n,e.props.className)}):null}var jd=qN;var on={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete"};var pw=nt(ji(),1);var cw=nt(cd(),1);var dw=nt(ji(),1);var $N="\xB7",ZR=()=>` ${$N} `;function e_(t){let{newFiles:e,isUploadStarted:i,recoveredState:n,i18n:r,uploadState:o,isSomeGhost:s,startUpload:a}=t,l=(0,dw.default)("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--upload",{"uppy-c-btn-primary":o===on.STATE_WAITING},{"uppy-StatusBar-actionBtn--disabled":s}),c=e&&i&&!n?r("uploadXNewFiles",{smart_count:e}):r("uploadXFiles",{smart_count:e});return y("button",{type:"button",className:l,"aria-label":r("uploadXFiles",{smart_count:e}),onClick:a,disabled:s,"data-uppy-super-focusable":!0,children:c})}function t_(t){let{i18n:e,uppy:i}=t;return y("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--retry","aria-label":e("retryUpload"),onClick:()=>i.retryAll().catch(()=>{}),"data-uppy-super-focusable":!0,"data-cy":"retry",children:[y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"8",height:"10",viewBox:"0 0 8 10",children:y("path",{d:"M4 2.408a2.75 2.75 0 1 0 2.75 2.75.626.626 0 0 1 1.25.018v.023a4 4 0 1 1-4-4.041V.25a.25.25 0 0 1 .389-.208l2.299 1.533a.25.25 0 0 1 0 .416l-2.3 1.533A.25.25 0 0 1 4 3.316v-.908z"})}),e("retry")]})}function i_(t){let{i18n:e,uppy:i}=t;return y("button",{type:"button",className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",title:e("cancel"),"aria-label":e("cancel"),onClick:()=>i.cancelAll(),"data-cy":"cancel","data-uppy-super-focusable":!0,children:y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16",children:y("g",{fill:"none",fillRule:"evenodd",children:[y("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),y("path",{fill:"#FFF",d:"M9.283 8l2.567 2.567-1.283 1.283L8 9.283 5.433 11.85 4.15 10.567 6.717 8 4.15 5.433 5.433 4.15 8 6.717l2.567-2.567 1.283 1.283z"})]})})})}function n_(t){let{isAllPaused:e,i18n:i,isAllComplete:n,resumableUploads:r,uppy:o}=t,s=i(e?"resume":"pause");function a(){if(!n){if(!r){o.cancelAll();return}if(e){o.resumeAll();return}o.pauseAll()}}return y("button",{title:s,"aria-label":s,className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",type:"button",onClick:a,"data-cy":"togglePauseResume","data-uppy-super-focusable":!0,children:y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16",children:y("g",{fill:"none",fillRule:"evenodd",children:[y("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),y("path",{fill:"#FFF",d:e?"M6 4.25L11.5 8 6 11.75z":"M5 4.5h2v7H5v-7zm4 0h2v7H9v-7z"})]})})})}function r_(t){let{i18n:e,doneButtonHandler:i}=t;return y("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--done",onClick:i,"data-uppy-super-focusable":!0,children:e("done")})}function o_(){return y("svg",{className:"uppy-StatusBar-spinner","aria-hidden":"true",focusable:"false",width:"14",height:"14",children:y("path",{d:"M13.983 6.547c-.12-2.509-1.64-4.893-3.939-5.936-2.48-1.127-5.488-.656-7.556 1.094C.524 3.367-.398 6.048.162 8.562c.556 2.495 2.46 4.52 4.94 5.183 2.932.784 5.61-.602 7.256-3.015-1.493 1.993-3.745 3.309-6.298 2.868-2.514-.434-4.578-2.349-5.153-4.84a6.226 6.226 0 0 1 2.98-6.778C6.34.586 9.74 1.1 11.373 3.493c.407.596.693 1.282.842 1.988.127.598.073 1.197.161 1.794.078.525.543 1.257 1.15.864.525-.341.49-1.05.456-1.592-.007-.15.02.3 0 0",fillRule:"evenodd"})})}function s_(t){let{progress:e}=t,{value:i,mode:n,message:r}=e;return y("div",{className:"uppy-StatusBar-content",children:[y(o_,{}),n==="determinate"?`${Math.round(i*100)}% \xB7 `:"",r]})}function KN(t){let{numUploads:e,complete:i,totalUploadedSize:n,totalSize:r,totalETA:o,i18n:s}=t,a=e>1,l=(0,cw.default)(n);return y("div",{className:"uppy-StatusBar-statusSecondary",children:[a&&s("filesUploadedOfTotal",{complete:i,smart_count:e}),y("span",{className:"uppy-StatusBar-additionalInfo",children:[a&&ZR(),r!=null?s("dataUploadedOfTotal",{complete:l,total:(0,cw.default)(r)}):s("dataUploadedOfUnknown",{complete:l}),ZR(),o!=null&&s("xTimeLeft",{time:Pp(o)})]})]})}function a_(t){let{i18n:e,complete:i,numUploads:n}=t;return y("div",{className:"uppy-StatusBar-statusSecondary",children:e("filesUploadedOfTotal",{complete:i,smart_count:n})})}function YN(t){let{i18n:e,newFiles:i,startUpload:n}=t,r=(0,dw.default)("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--uploadNewlyAdded");return y("div",{className:"uppy-StatusBar-statusSecondary",children:[y("div",{className:"uppy-StatusBar-statusSecondaryHint",children:e("xMoreFilesAdded",{smart_count:i})}),y("button",{type:"button",className:r,"aria-label":e("uploadXFiles",{smart_count:i}),onClick:n,children:e("upload")})]})}function l_(t){let{i18n:e,supportsUploadProgress:i,totalProgress:n,hideProgressDetails:r,isUploadStarted:o,isAllComplete:s,isAllPaused:a,newFiles:l,numUploads:c,complete:d,totalUploadedSize:u,totalSize:h,totalETA:p,startUpload:f}=t,g=l&&o;if(!o||s)return null;let m=e(a?"paused":"uploading");function v(){return!a&&!g&&!r?i?y(KN,{numUploads:c,complete:d,totalUploadedSize:u,totalSize:h,totalETA:p,i18n:e}):y(a_,{i18n:e,complete:d,numUploads:c}):null}return y("div",{className:"uppy-StatusBar-content",title:m,children:[a?null:y(o_,{}),y("div",{className:"uppy-StatusBar-status",children:[y("div",{className:"uppy-StatusBar-statusPrimary",children:i&&n!==0?`${m}: ${n}%`:m}),v(),g?y(YN,{i18n:e,newFiles:l,startUpload:f}):null]})]})}function c_(t){let{i18n:e}=t;return y("div",{className:"uppy-StatusBar-content",role:"status",title:e("complete"),children:y("div",{className:"uppy-StatusBar-status",children:y("div",{className:"uppy-StatusBar-statusPrimary",children:[y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"15",height:"11",viewBox:"0 0 15 11",children:y("path",{d:"M.414 5.843L1.627 4.63l3.472 3.472L13.202 0l1.212 1.213L5.1 10.528z"})}),e("complete")]})})})}function d_(t){let{error:e,i18n:i,complete:n,numUploads:r}=t;function o(){let s=`${i("uploadFailed")} 

 ${e}`;alert(s)}return y("div",{className:"uppy-StatusBar-content",title:i("uploadFailed"),children:[y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"11",height:"11",viewBox:"0 0 11 11",children:y("path",{d:"M4.278 5.5L0 1.222 1.222 0 5.5 4.278 9.778 0 11 1.222 6.722 5.5 11 9.778 9.778 11 5.5 6.722 1.222 11 0 9.778z"})}),y("div",{className:"uppy-StatusBar-status",children:[y("div",{className:"uppy-StatusBar-statusPrimary",children:[i("uploadFailed"),y("button",{className:"uppy-u-reset uppy-StatusBar-details","aria-label":i("showErrorDetails"),"data-microtip-position":"top-right","data-microtip-size":"medium",onClick:o,type:"button",children:"?"})]}),y(a_,{i18n:i,complete:n,numUploads:r})]})]})}function qd(t){let e=[],i="indeterminate",n;for(let{progress:o}of Object.values(t)){let{preprocess:s,postprocess:a}=o;n==null&&(s||a)&&({mode:i,message:n}=s||a),s?.mode==="determinate"&&e.push(s.value),a?.mode==="determinate"&&e.push(a.value)}let r=e.reduce((o,s)=>o+s/e.length,0);return{mode:i,message:n,value:r}}var{STATE_ERROR:u_,STATE_WAITING:XN,STATE_PREPROCESSING:uw,STATE_UPLOADING:tf,STATE_POSTPROCESSING:hw,STATE_COMPLETE:nf}=on;function fw({newFiles:t,allowNewUpload:e,isUploadInProgress:i,isAllPaused:n,resumableUploads:r,error:o,hideUploadButton:s=void 0,hidePauseResumeButton:a=!1,hideCancelButton:l=!1,hideRetryButton:c=!1,recoveredState:d,uploadState:u,totalProgress:h,files:p,supportsUploadProgress:f,hideAfterFinish:g=!1,isSomeGhost:m,doneButtonHandler:v=void 0,isUploadStarted:C,i18n:b,startUpload:S,uppy:x,isAllComplete:E,hideProgressDetails:P=void 0,numUploads:L,complete:B,totalSize:j,totalETA:q,totalUploadedSize:Y}){function he(){switch(u){case hw:case uw:{let ht=qd(p);return ht.mode==="determinate"?ht.value*100:h}case u_:return null;case tf:return f?h:null;default:return h}}function Se(){switch(u){case hw:case uw:{let{mode:ht}=qd(p);return ht==="indeterminate"}case tf:return!f;default:return!1}}let be=he(),T=be??100,R=!o&&t&&(!i&&!n||d)&&e&&!s,_=!l&&u!==XN&&u!==nf,z=r&&!a&&u===tf,G=o&&!E&&!c,U=v&&u===nf,N=(0,pw.default)("uppy-StatusBar-progress",{"is-indeterminate":Se()}),I=(0,pw.default)("uppy-StatusBar",`is-${u}`,{"has-ghosts":m}),V=(()=>{switch(u){case uw:case hw:return y(s_,{progress:qd(p)});case nf:return y(c_,{i18n:b});case u_:return y(d_,{error:o,i18n:b,numUploads:L,complete:B});case tf:return y(l_,{i18n:b,supportsUploadProgress:f,totalProgress:h,hideProgressDetails:P,isUploadStarted:C,isAllComplete:E,isAllPaused:n,newFiles:t,numUploads:L,complete:B,totalUploadedSize:Y,totalSize:j,totalETA:q,startUpload:S});default:return null}})();return!(R||G||z||_||U)&&!V||u===nf&&g?null:y("div",{className:I,children:[y("div",{className:N,style:{width:`${T}%`},role:"progressbar","aria-label":`${T}%`,"aria-valuetext":`${T}%`,"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":be}),V,y("div",{className:"uppy-StatusBar-actions",children:[R?y(e_,{newFiles:t,isUploadStarted:C,recoveredState:d,i18n:b,isSomeGhost:m,startUpload:S,uploadState:u}):null,G?y(t_,{i18n:b,uppy:x}):null,z?y(n_,{isAllPaused:n,i18n:b,isAllComplete:E,resumableUploads:r,uppy:x}):null,_?y(i_,{i18n:b,uppy:x}):null,U?y(r_,{i18n:b,doneButtonHandler:v}):null]})]})}var JN=2e3,QN=2e3;function ZN(t,e,i,n){if(t)return on.STATE_ERROR;if(e)return on.STATE_COMPLETE;if(i)return on.STATE_WAITING;let r=on.STATE_WAITING,o=Object.keys(n);for(let s=0;s<o.length;s++){let{progress:a}=n[o[s]];if(a.uploadStarted&&!a.uploadComplete)return on.STATE_UPLOADING;a.preprocess&&(r=on.STATE_PREPROCESSING),a.postprocess&&r!==on.STATE_PREPROCESSING&&(r=on.STATE_POSTPROCESSING)}return r}var rf=class extends bi{#e;#t;#i;#n;componentDidMount(){this.#e=performance.now(),this.#t=this.props.uppy.getFiles().reduce((e,i)=>e+(i.progress.bytesUploaded||0),0),this.props.uppy.on("upload",this.#r)}componentWillUnmount(){this.props.uppy.off("upload",this.#r)}#r=()=>{let{recoveredState:e}=this.props.uppy.getState();if(this.#i=null,this.#n=null,e){this.#t=Object.values(e.files).reduce((i,{progress:n})=>i+(n.bytesUploaded||0),0),this.props.uppy.emit("restore-confirmed");return}this.#e=performance.now(),this.#t=0};#c(e){if(e.total==null||e.total===0)return null;let i=e.total-e.uploaded;if(i<=0)return null;this.#e??=performance.now();let n=performance.now()-this.#e;if(n===0)return Math.round((this.#n??0)/100)/10;if(this.#t==null)return this.#t=e.uploaded,null;let r=e.uploaded-this.#t;if(this.#t=e.uploaded,r<=0)return Math.round((this.#n??0)/100)/10;let o=r/n;if(!Number.isFinite(o)||o<=0)return null;let s=this.#i==null?o:dd(o,this.#i,JN,n);if(!Number.isFinite(s)||s<=0)return null;this.#i=s;let a=i/s;if(!Number.isFinite(a)||a<0)return null;let l=Math.max((this.#n??0)-n,0),c=this.#n==null?a:dd(a,l,QN,n);return!Number.isFinite(c)||c<0?null:(this.#n=c,this.#e=performance.now(),Math.round(c/100)/10)}startUpload=()=>this.props.uppy.upload().catch(()=>{});render(){let{capabilities:e,files:i,allowNewUpload:n,totalProgress:r,error:o,recoveredState:s}=this.props.uppy.getState(),{newFiles:a,startedFiles:l,completeFiles:c,isUploadStarted:d,isAllComplete:u,isAllPaused:h,isUploadInProgress:p,isSomeGhost:f}=this.props.uppy.getObjectOfFilesPerState(),g=s?Object.values(i):a,m=!!e.resumableUploads,v=e.uploadProgress!==!1,C=null,b=0;l.every(x=>x.progress.bytesTotal!=null&&x.progress.bytesTotal!==0)?(C=0,l.forEach(x=>{C+=x.progress.bytesTotal||0,b+=x.progress.bytesUploaded||0})):l.forEach(x=>{b+=x.progress.bytesUploaded||0});let S=this.#c({uploaded:b,total:C});return y(fw,{error:o,uploadState:ZN(o,u,s,i||{}),allowNewUpload:n,totalProgress:r,totalSize:C,totalUploadedSize:b,isAllComplete:u,isAllPaused:h,isUploadStarted:d,isUploadInProgress:p,isSomeGhost:f,recoveredState:s,complete:c.length,newFiles:g.length,numUploads:l.length,totalETA:S,files:i,i18n:this.props.i18n,uppy:this.props.uppy,startUpload:this.startUpload,doneButtonHandler:this.props.doneButtonHandler,resumableUploads:m,supportsUploadProgress:v,hideProgressDetails:this.props.hideProgressDetails,hideUploadButton:this.props.hideUploadButton,hideRetryButton:this.props.hideRetryButton,hidePauseResumeButton:this.props.hidePauseResumeButton,hideCancelButton:this.props.hideCancelButton,hideAfterFinish:this.props.hideAfterFinish})}};var h_=900,p_=700,gw=576,f_=330;function mw(t){let e=t.totalFileCount===0,i=t.totalFileCount===1,n=t.containerWidth>gw,r=t.containerHeight>f_,o=(0,g_.default)({"uppy-Dashboard":!0,"uppy-Dashboard--isDisabled":t.disabled,"uppy-Dashboard--animateOpenClose":t.animateOpenClose,"uppy-Dashboard--isClosing":t.isClosing,"uppy-Dashboard--isDraggingOver":t.isDraggingOver,"uppy-Dashboard--modal":!t.inline,"uppy-size--md":t.containerWidth>gw,"uppy-size--lg":t.containerWidth>p_,"uppy-size--xl":t.containerWidth>h_,"uppy-size--height-md":t.containerHeight>f_,"uppy-Dashboard--isAddFilesPanelVisible":t.showAddFilesPanel,"uppy-Dashboard--isInnerWrapVisible":t.areInsidesReadyToBeVisible,"uppy-Dashboard--singleFile":t.singleFileFullScreen&&i&&r}),s=1;t.containerWidth>h_?s=5:t.containerWidth>p_?s=4:t.containerWidth>gw&&(s=3);let a=t.showSelectedFiles&&!e,l=t.recoveredState?Object.keys(t.recoveredState.files).length:null,c=t.files?Object.keys(t.files).filter(h=>t.files[h].isGhost).length:0,d=()=>c>0?t.i18n("recoveredXFiles",{smart_count:c}):t.i18n("recoveredAllFiles");return y("div",{className:o,"data-uppy-theme":t.theme,"data-uppy-num-acquirers":t.acquirers.length,"data-uppy-drag-drop-supported":!t.disableLocalFiles&&Ep(),"aria-hidden":t.inline?"false":t.isHidden,"aria-disabled":t.disabled,"aria-label":t.inline?t.i18n("dashboardTitle"):t.i18n("dashboardWindowTitle"),onPaste:t.handlePaste,onDragOver:t.handleDragOver,onDragLeave:t.handleDragLeave,onDrop:t.handleDrop,children:[y("div",{"aria-hidden":"true",className:"uppy-Dashboard-overlay",tabIndex:-1,onClick:t.handleClickOutside}),y("div",{className:"uppy-Dashboard-inner",role:t.inline?void 0:"dialog",style:{width:t.inline&&t.width?t.width:"",height:t.inline&&t.height?t.height:""},children:[t.inline?null:y("button",{className:"uppy-u-reset uppy-Dashboard-close",type:"button","aria-label":t.i18n("closeModal"),title:t.i18n("closeModal"),onClick:t.closeModal,children:y("span",{"aria-hidden":"true",children:"\xD7"})}),y("div",{className:"uppy-Dashboard-innerWrap",children:[y("div",{className:"uppy-Dashboard-dropFilesHereHint",children:t.i18n("dropHint")}),a&&y(XR,w({},t)),l&&y("div",{className:"uppy-Dashboard-serviceMsg",children:[y("svg",{className:"uppy-Dashboard-serviceMsg-icon","aria-hidden":"true",focusable:"false",width:"21",height:"16",viewBox:"0 0 24 19",children:y("g",{transform:"translate(0 -1)",fill:"none",fillRule:"evenodd",children:[y("path",{d:"M12.857 1.43l10.234 17.056A1 1 0 0122.234 20H1.766a1 1 0 01-.857-1.514L11.143 1.429a1 1 0 011.714 0z",fill:"#FFD300"}),y("path",{fill:"#000",d:"M11 6h2l-.3 8h-1.4z"}),y("circle",{fill:"#000",cx:"12",cy:"17",r:"1"})]})}),y("strong",{className:"uppy-Dashboard-serviceMsg-title",children:t.i18n("sessionRestored")}),y("div",{className:"uppy-Dashboard-serviceMsg-text",children:d()})]}),a?y(lw,{id:t.id,i18n:t.i18n,uppy:t.uppy,files:t.files,resumableUploads:t.resumableUploads,hideRetryButton:t.hideRetryButton,hidePauseResumeButton:t.hidePauseResumeButton,hideCancelButton:t.hideCancelButton,showLinkToFileUploadResult:t.showLinkToFileUploadResult,showRemoveButtonAfterComplete:t.showRemoveButtonAfterComplete,metaFields:t.metaFields,toggleFileCard:t.toggleFileCard,handleRequestThumbnail:t.handleRequestThumbnail,handleCancelThumbnail:t.handleCancelThumbnail,recoveredState:t.recoveredState,individualCancellation:t.individualCancellation,openFileEditor:t.openFileEditor,canEditFile:t.canEditFile,toggleAddFilesPanel:t.toggleAddFilesPanel,isSingleFile:i,itemsPerRow:s,containerWidth:t.containerWidth,containerHeight:t.containerHeight}):y(Jp,{i18n:t.i18n,i18nArray:t.i18nArray,acquirers:t.acquirers,handleInputChange:t.handleInputChange,maxNumberOfFiles:t.maxNumberOfFiles,allowedFileTypes:t.allowedFileTypes,showNativePhotoCameraButton:t.showNativePhotoCameraButton,showNativeVideoCameraButton:t.showNativeVideoCameraButton,nativeCameraFacingMode:t.nativeCameraFacingMode,showPanel:t.showPanel,activePickerPanel:t.activePickerPanel,disableLocalFiles:t.disableLocalFiles,fileManagerSelectionType:t.fileManagerSelectionType,note:t.note,proudlyDisplayPoweredByUppy:t.proudlyDisplayPoweredByUppy}),y(jd,{children:t.showAddFilesPanel?y(BR,k(w({},t),{isSizeMD:n}),"AddFiles"):null}),y(jd,{children:t.fileCardFor?y(ew,w({},t),"FileCard"):null}),y(jd,{children:t.activePickerPanel?y(YR,w({},t),"Picker"):null}),y(jd,{children:t.showFileEditor?y(zR,w({},t),"Editor"):null}),y("div",{className:"uppy-Dashboard-progressindicators",children:[!t.disableInformer&&y(Ud,{uppy:t.uppy}),!t.disableStatusBar&&y(rf,{uppy:t.uppy,i18n:t.i18n,hideProgressDetails:t.hideProgressDetails,hideUploadButton:t.hideUploadButton,hideRetryButton:t.hideRetryButton,hidePauseResumeButton:t.hidePauseResumeButton,hideCancelButton:t.hideCancelButton,hideAfterFinish:t.hideProgressAfterFinish,doneButtonHandler:t.doneButtonHandler}),!t.disableInformer&&y(Ud,{uppy:t.uppy}),t.progressindicators.map(h=>t.uppy.getPlugin(h.id).render(t.state))]})]})]})]})}var m_={strings:{closeModal:"Close Modal",addMoreFiles:"Add more files",addingMoreFiles:"Adding more files",importFrom:"Import from %{name}",dashboardWindowTitle:"Uppy Dashboard Window (Press escape to close)",dashboardTitle:"Uppy Dashboard",copyLinkToClipboardSuccess:"Link copied to clipboard.",copyLinkToClipboardFallback:"Copy the URL below",copyLink:"Copy link",back:"Back",removeFile:"Remove file",editFile:"Edit file",editImage:"Edit image",editing:"Editing %{file}",error:"Error",finishEditingFile:"Finish editing file",saveChanges:"Save changes",myDevice:"My Device",dropHint:"Drop your files here",uploadComplete:"Upload complete",uploadPaused:"Upload paused",resumeUpload:"Resume upload",pauseUpload:"Pause upload",retryUpload:"Retry upload",cancelUpload:"Cancel upload",xFilesSelected:{0:"%{smart_count} file selected",1:"%{smart_count} files selected"},uploadingXFiles:{0:"Uploading %{smart_count} file",1:"Uploading %{smart_count} files"},processingXFiles:{0:"Processing %{smart_count} file",1:"Processing %{smart_count} files"},poweredBy:"Powered by %{uppy}",addMore:"Add more",editFileWithFilename:"Edit file %{file}",save:"Save",cancel:"Cancel",dropPasteFiles:"Drop files here or %{browseFiles}",dropPasteFolders:"Drop files here or %{browseFolders}",dropPasteBoth:"Drop files here, %{browseFiles} or %{browseFolders}",dropPasteImportFiles:"Drop files here, %{browseFiles} or import from:",dropPasteImportFolders:"Drop files here, %{browseFolders} or import from:",dropPasteImportBoth:"Drop files here, %{browseFiles}, %{browseFolders} or import from:",importFiles:"Import files from:",browseFiles:"browse files",browseFolders:"browse folders",recoveredXFiles:{0:"We could not fully recover 1 file. Please re-select it and resume the upload.",1:"We could not fully recover %{smart_count} files. Please re-select them and resume the upload."},recoveredAllFiles:"We restored all files. You can now resume the upload.",sessionRestored:"Session restored",reSelect:"Re-select",missingRequiredMetaFields:{0:"Missing required meta field: %{fields}.",1:"Missing required meta fields: %{fields}."},takePictureBtn:"Take Picture",recordVideoBtn:"Record Video",uploading:"Uploading",complete:"Complete",uploadFailed:"Upload failed",paused:"Paused",retry:"Retry",pause:"Pause",resume:"Resume",done:"Done",filesUploadedOfTotal:{0:"%{complete} of %{smart_count} file uploaded",1:"%{complete} of %{smart_count} files uploaded"},dataUploadedOfTotal:"%{complete} of %{total}",dataUploadedOfUnknown:"%{complete} of unknown",xTimeLeft:"%{time} left",uploadXFiles:{0:"Upload %{smart_count} file",1:"Upload %{smart_count} files"},uploadXNewFiles:{0:"Upload +%{smart_count} file",1:"Upload +%{smart_count} files"},upload:"Upload",xMoreFilesAdded:{0:"%{smart_count} more file added",1:"%{smart_count} more files added"},showErrorDetails:"Show error details"}};var v_=nt(vC(),1);function $d(t,e){if(e){let i=t.querySelector(`[data-uppy-paneltype="${e}"]`);if(i)return i}return t}function vw(){let t=!1;return(0,v_.default)((i,n)=>{let r=$d(i,n),o=r.contains(document.activeElement);if(o&&t)return;let s=r.querySelector("[data-uppy-super-focusable]");o&&!s||(s?(s.focus({preventScroll:!0}),t=!0):(r.querySelector(ud)?.focus({preventScroll:!0}),t=!1))},260)}function C_(t,e){let i=e[0];i&&(i.focus(),t.preventDefault())}function eB(t,e){let i=e[e.length-1];i&&(i.focus(),t.preventDefault())}function tB(t){return t.contains(document.activeElement)}function Cw(t,e,i){let n=$d(i,e),r=Qr(n.querySelectorAll(ud)),o=r.indexOf(document.activeElement);tB(n)?t.shiftKey&&o===0?eB(t,r):!t.shiftKey&&o===r.length-1&&C_(t,r):C_(t,r)}function w_(t,e,i){e===null||Cw(t,e,i)}var b_=9,nB=27;function y_(){let t={};return t.promise=new Promise((e,i)=>{t.resolve=e,t.reject=i}),t}var rB={target:"body",metaFields:[],thumbnailWidth:280,thumbnailType:"image/jpeg",waitForThumbnailsBeforeUpload:!1,defaultPickerIcon:Dd,showLinkToFileUploadResult:!1,hideProgressDetails:!1,hideUploadButton:!1,hideCancelButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideProgressAfterFinish:!1,note:null,singleFileFullScreen:!0,disableStatusBar:!1,disableInformer:!1,disableThumbnailGenerator:!1,fileManagerSelectionType:"files",proudlyDisplayPoweredByUppy:!0,showSelectedFiles:!0,showRemoveButtonAfterComplete:!1,showNativePhotoCameraButton:!1,showNativeVideoCameraButton:!1,theme:"light",autoOpen:null,disabled:!1,disableLocalFiles:!1,nativeCameraFacingMode:"",onDragLeave:()=>{},onDragOver:()=>{},onDrop:()=>{},plugins:[],doneButtonHandler:void 0,onRequestCloseModal:null,inline:!1,animateOpenClose:!0,browserBackButtonClose:!1,closeAfterFinish:!1,closeModalOnClickOutside:!1,disablePageScrollWhenModalOpen:!0,trigger:null,width:750,height:550},Kd=class extends Rd{static VERSION=LR.version;#e;modalName=`uppy-Dashboard-${Jo()}`;superFocus=vw();ifFocusedOnUppyRecently=!1;dashboardIsDisabled;savedScrollPosition;savedActiveElement;resizeObserver;darkModeMediaQuery;makeDashboardInsidesVisibleAnywayTimeout;constructor(e,i){let n=i?.autoOpen??null;super(e,k(w(w({},rB),i),{autoOpen:n})),this.id=this.opts.id||"Dashboard",this.title="Dashboard",this.type="orchestrator",this.defaultLocale=m_,this.opts.doneButtonHandler===void 0&&(this.opts.doneButtonHandler=()=>{this.uppy.clear(),this.requestCloseModal()}),this.opts.onRequestCloseModal??=()=>this.closeModal(),this.i18nInit()}removeTarget=e=>{let n=this.getPluginState().targets.filter(r=>r.id!==e.id);this.setPluginState({targets:n})};addTarget=e=>{let i=e.id||e.constructor.name,n=e.title||i,r=e.type;if(r!=="acquirer"&&r!=="progressindicator"&&r!=="editor")return this.uppy.log("Dashboard: can only be targeted by plugins of types: acquirer, progressindicator, editor","error"),null;let o={id:i,name:n,type:r},a=this.getPluginState().targets.slice();return a.push(o),this.setPluginState({targets:a}),this.el};hideAllPanels=()=>{let e=this.getPluginState(),i={activePickerPanel:void 0,showAddFilesPanel:!1,activeOverlayType:null,fileCardFor:null,showFileEditor:!1};e.activePickerPanel===i.activePickerPanel&&e.showAddFilesPanel===i.showAddFilesPanel&&e.showFileEditor===i.showFileEditor&&e.activeOverlayType===i.activeOverlayType||(this.setPluginState(i),this.uppy.emit("dashboard:close-panel",e.activePickerPanel?.id))};showPanel=e=>{let{targets:i}=this.getPluginState(),n=i.find(r=>r.type==="acquirer"&&r.id===e);this.setPluginState({activePickerPanel:n,activeOverlayType:"PickerPanel"}),this.uppy.emit("dashboard:show-panel",e)};canEditFile=e=>{let{targets:i}=this.getPluginState();return this.#a(i).some(r=>this.uppy.getPlugin(r.id).canEditFile(e))};openFileEditor=e=>{let{targets:i}=this.getPluginState(),n=this.#a(i);this.setPluginState({showFileEditor:!0,fileCardFor:e.id||null,activeOverlayType:"FileEditor"}),n.forEach(r=>{this.uppy.getPlugin(r.id).selectFile(e)})};closeFileEditor=()=>{let{metaFields:e}=this.getPluginState();e&&e.length>0?this.setPluginState({showFileEditor:!1,activeOverlayType:"FileCard"}):this.setPluginState({showFileEditor:!1,fileCardFor:null,activeOverlayType:"AddFiles"})};saveFileEditor=()=>{let{targets:e}=this.getPluginState();this.#a(e).forEach(n=>{this.uppy.getPlugin(n.id).save()}),this.closeFileEditor()};openModal=()=>{let{promise:e,resolve:i}=y_();if(this.savedScrollPosition=window.pageYOffset,this.savedActiveElement=document.activeElement,this.opts.disablePageScrollWhenModalOpen&&document.body.classList.add("uppy-Dashboard-isFixed"),this.opts.animateOpenClose&&this.getPluginState().isClosing){let n=()=>{this.setPluginState({isHidden:!1}),this.el.removeEventListener("animationend",n,!1),i()};this.el.addEventListener("animationend",n,!1)}else this.setPluginState({isHidden:!1}),i();return this.opts.browserBackButtonClose&&this.updateBrowserHistory(),document.addEventListener("keydown",this.handleKeyDownInModal),this.uppy.emit("dashboard:modal-open"),e};closeModal=e=>{let i=e?.manualClose??!0,{isHidden:n,isClosing:r}=this.getPluginState();if(n||r)return;let{promise:o,resolve:s}=y_();if(this.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove("uppy-Dashboard-isFixed"),this.opts.animateOpenClose){this.setPluginState({isClosing:!0});let a=()=>{this.setPluginState({isHidden:!0,isClosing:!1}),this.superFocus.cancel(),this.savedActiveElement.focus(),this.el.removeEventListener("animationend",a,!1),s()};this.el.addEventListener("animationend",a,!1)}else this.setPluginState({isHidden:!0}),this.superFocus.cancel(),this.savedActiveElement.focus(),s();return document.removeEventListener("keydown",this.handleKeyDownInModal),i&&this.opts.browserBackButtonClose&&history.state?.[this.modalName]&&history.back(),this.uppy.emit("dashboard:modal-closed"),o};isModalOpen=()=>!this.getPluginState().isHidden||!1;requestCloseModal=()=>this.opts.onRequestCloseModal?this.opts.onRequestCloseModal():this.closeModal();setDarkModeCapability=e=>{let{capabilities:i}=this.uppy.getState();this.uppy.setState({capabilities:k(w({},i),{darkMode:e})})};handleSystemDarkModeChange=e=>{let i=e.matches;this.uppy.log(`[Dashboard] Dark mode is ${i?"on":"off"}`),this.setDarkModeCapability(i)};toggleFileCard=(e,i)=>{let n=this.uppy.getFile(i);e?this.uppy.emit("dashboard:file-edit-start",n):this.uppy.emit("dashboard:file-edit-complete",n),this.setPluginState({fileCardFor:e?i:null,activeOverlayType:e?"FileCard":null})};toggleAddFilesPanel=e=>{this.setPluginState({showAddFilesPanel:e,activeOverlayType:e?"AddFiles":null})};addFiles=e=>{let i=e.map(n=>({source:this.id,name:n.name,type:n.type,data:n,meta:{relativePath:n.relativePath||n.webkitRelativePath||null}}));try{this.uppy.addFiles(i)}catch(n){this.uppy.log(n)}};startListeningToResize=()=>{this.resizeObserver=new ResizeObserver(e=>{let i=e[0],{width:n,height:r}=i.contentRect;this.setPluginState({containerWidth:n,containerHeight:r,areInsidesReadyToBeVisible:!0})}),this.resizeObserver.observe(this.el.querySelector(".uppy-Dashboard-inner")),this.makeDashboardInsidesVisibleAnywayTimeout=setTimeout(()=>{let e=this.getPluginState(),i=!this.opts.inline&&e.isHidden;!e.areInsidesReadyToBeVisible&&!i&&(this.uppy.log("[Dashboard] resize event didn\u2019t fire on time: defaulted to mobile layout","warning"),this.setPluginState({areInsidesReadyToBeVisible:!0}))},1e3)};stopListeningToResize=()=>{this.resizeObserver.disconnect(),clearTimeout(this.makeDashboardInsidesVisibleAnywayTimeout)};recordIfFocusedOnUppyRecently=e=>{this.el.contains(e.target)?this.ifFocusedOnUppyRecently=!0:(this.ifFocusedOnUppyRecently=!1,this.superFocus.cancel())};disableInteractiveElements=e=>{let i=["a[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])",'[role="button"]:not([disabled])'],n=this.#e??Qr(this.el.querySelectorAll(i)).filter(r=>!r.classList.contains("uppy-Dashboard-close"));for(let r of n)r.tagName==="A"?r.setAttribute("aria-disabled",e):r.disabled=e;e?this.#e=n:this.#e=null,this.dashboardIsDisabled=e};updateBrowserHistory=()=>{history.state?.[this.modalName]||history.pushState(k(w({},history.state),{[this.modalName]:!0}),""),window.addEventListener("popstate",this.handlePopState,!1)};handlePopState=e=>{this.isModalOpen()&&(!e.state||!e.state[this.modalName])&&this.closeModal({manualClose:!1}),!this.isModalOpen()&&e.state?.[this.modalName]&&history.back()};handleKeyDownInModal=e=>{e.keyCode===nB&&this.requestCloseModal(),e.keyCode===b_&&Cw(e,this.getPluginState().activeOverlayType,this.el)};handleClickOutside=()=>{this.opts.closeModalOnClickOutside&&this.requestCloseModal()};handlePaste=e=>{this.uppy.iteratePlugins(n=>{n.type==="acquirer"&&n.handleRootPaste?.(e)});let i=Qr(e.clipboardData.files);i.length>0&&(this.uppy.log("[Dashboard] Files pasted"),this.addFiles(i))};handleInputChange=e=>{e.preventDefault();let i=Qr(e.currentTarget.files||[]);i.length>0&&(this.uppy.log("[Dashboard] Files selected through input"),this.addFiles(i))};handleDragOver=e=>{e.preventDefault(),e.stopPropagation();let i=()=>{let s=!0;return this.uppy.iteratePlugins(a=>{a.canHandleRootDrop?.(e)&&(s=!0)}),s},n=()=>{let{types:s}=e.dataTransfer;return s.some(a=>a==="Files")},r=i(),o=n();if(!r&&!o||this.opts.disabled||this.opts.disableLocalFiles&&(o||!r)||!this.uppy.getState().allowNewUpload){e.dataTransfer.dropEffect="none";return}e.dataTransfer.dropEffect="copy",this.setPluginState({isDraggingOver:!0}),this.opts.onDragOver(e)};handleDragLeave=e=>{e.preventDefault(),e.stopPropagation(),this.setPluginState({isDraggingOver:!1}),this.opts.onDragLeave(e)};handleDrop=async e=>{e.preventDefault(),e.stopPropagation(),this.setPluginState({isDraggingOver:!1}),this.uppy.iteratePlugins(o=>{o.type==="acquirer"&&o.handleRootDrop?.(e)});let i=!1,n=o=>{this.uppy.log(o,"error"),i||(this.uppy.info(o.message,"error"),i=!0)};this.uppy.log("[Dashboard] Processing dropped files");let r=await xp(e.dataTransfer,{logDropError:n});r.length>0&&(this.uppy.log("[Dashboard] Files dropped"),this.addFiles(r)),this.opts.onDrop(e)};handleRequestThumbnail=e=>{this.opts.waitForThumbnailsBeforeUpload||this.uppy.emit("thumbnail:request",e)};handleCancelThumbnail=e=>{this.opts.waitForThumbnailsBeforeUpload||this.uppy.emit("thumbnail:cancel",e)};handleKeyDownInInline=e=>{e.keyCode===b_&&w_(e,this.getPluginState().activeOverlayType,this.el)};handlePasteOnBody=e=>{this.el.contains(document.activeElement)&&this.handlePaste(e)};handleComplete=({failed:e})=>{this.opts.closeAfterFinish&&!e?.length&&this.requestCloseModal()};handleCancelRestore=()=>{this.uppy.emit("restore-canceled")};#t=()=>{if(this.opts.disableThumbnailGenerator)return;let e=600,i=this.uppy.getFiles();if(i.length===1){let n=this.uppy.getPlugin(`${this.id}:ThumbnailGenerator`);n?.setOptions({thumbnailWidth:e});let r=k(w({},i[0]),{preview:void 0});n?.requestThumbnail(r).then(()=>{n?.setOptions({thumbnailWidth:this.opts.thumbnailWidth})})}};#i=e=>{let i=e[0],{metaFields:n}=this.getPluginState(),r=n&&n.length>0,o=this.canEditFile(i);r&&this.opts.autoOpen==="metaEditor"?this.toggleFileCard(!0,i.id):o&&this.opts.autoOpen==="imageEditor"&&this.openFileEditor(i)};initEvents=()=>{if(this.opts.trigger&&!this.opts.inline){let e=bp(this.opts.trigger);e?e.forEach(i=>i.addEventListener("click",this.openModal)):this.uppy.log("Dashboard modal trigger not found. Make sure `trigger` is set in Dashboard options, unless you are planning to call `dashboard.openModal()` method yourself","warning")}this.startListeningToResize(),document.addEventListener("paste",this.handlePasteOnBody),this.uppy.on("plugin-added",this.#l),this.uppy.on("plugin-remove",this.removeTarget),this.uppy.on("file-added",this.hideAllPanels),this.uppy.on("dashboard:modal-closed",this.hideAllPanels),this.uppy.on("complete",this.handleComplete),this.uppy.on("files-added",this.#t),this.uppy.on("file-removed",this.#t),document.addEventListener("focus",this.recordIfFocusedOnUppyRecently,!0),document.addEventListener("click",this.recordIfFocusedOnUppyRecently,!0),this.opts.inline&&this.el.addEventListener("keydown",this.handleKeyDownInInline),this.opts.autoOpen&&this.uppy.on("files-added",this.#i)};removeEvents=()=>{let e=bp(this.opts.trigger);!this.opts.inline&&e&&e.forEach(i=>i.removeEventListener("click",this.openModal)),this.stopListeningToResize(),document.removeEventListener("paste",this.handlePasteOnBody),window.removeEventListener("popstate",this.handlePopState,!1),this.uppy.off("plugin-added",this.#l),this.uppy.off("plugin-remove",this.removeTarget),this.uppy.off("file-added",this.hideAllPanels),this.uppy.off("dashboard:modal-closed",this.hideAllPanels),this.uppy.off("complete",this.handleComplete),this.uppy.off("files-added",this.#t),this.uppy.off("file-removed",this.#t),document.removeEventListener("focus",this.recordIfFocusedOnUppyRecently),document.removeEventListener("click",this.recordIfFocusedOnUppyRecently),this.opts.inline&&this.el.removeEventListener("keydown",this.handleKeyDownInInline),this.opts.autoOpen&&this.uppy.off("files-added",this.#i)};superFocusOnEachUpdate=()=>{let e=this.el.contains(document.activeElement),i=document.activeElement===document.body||document.activeElement===null,n=this.uppy.getState().info.length===0,r=!this.opts.inline;n&&(r||e||i&&this.ifFocusedOnUppyRecently)?this.superFocus(this.el,this.getPluginState().activeOverlayType):this.superFocus.cancel()};afterUpdate=()=>{if(this.opts.disabled&&!this.dashboardIsDisabled){this.disableInteractiveElements(!0);return}!this.opts.disabled&&this.dashboardIsDisabled&&this.disableInteractiveElements(!1),this.superFocusOnEachUpdate()};saveFileCard=(e,i)=>{this.uppy.setFileMeta(i,e),this.toggleFileCard(!1,i)};#n=e=>{let i=this.uppy.getPlugin(e.id);return k(w({},e),{icon:i.icon||this.opts.defaultPickerIcon,render:i.render})};#r=e=>{let i=this.uppy.getPlugin(e.id);return typeof i.isSupported!="function"?!0:i.isSupported()};#c=e=>e.filter(i=>i.type==="acquirer"&&this.#r(i)).map(this.#n);#s=e=>e.filter(i=>i.type==="progressindicator").map(this.#n);#a=e=>e.filter(i=>i.type==="editor").map(this.#n);render=e=>{let i=this.getPluginState(),{files:n,capabilities:r,allowNewUpload:o}=e,{newFiles:s,uploadStartedFiles:a,completeFiles:l,erroredFiles:c,inProgressFiles:d,inProgressNotPausedFiles:u,processingFiles:h,isUploadStarted:p,isAllComplete:f,isAllPaused:g}=this.uppy.getObjectOfFilesPerState(),m=this.#c(i.targets),v=this.#s(i.targets),C=this.#a(i.targets),b;return this.opts.theme==="auto"?b=r.darkMode?"dark":"light":b=this.opts.theme,["files","folders","both"].indexOf(this.opts.fileManagerSelectionType)<0&&(this.opts.fileManagerSelectionType="files",console.warn(`Unsupported option for "fileManagerSelectionType". Using default of "${this.opts.fileManagerSelectionType}".`)),mw({state:e,isHidden:i.isHidden,files:n,newFiles:s,uploadStartedFiles:a,completeFiles:l,erroredFiles:c,inProgressFiles:d,inProgressNotPausedFiles:u,processingFiles:h,isUploadStarted:p,isAllComplete:f,isAllPaused:g,totalFileCount:Object.keys(n).length,totalProgress:e.totalProgress,allowNewUpload:o,acquirers:m,theme:b,disabled:this.opts.disabled,disableLocalFiles:this.opts.disableLocalFiles,direction:this.opts.direction,activePickerPanel:i.activePickerPanel,showFileEditor:i.showFileEditor,saveFileEditor:this.saveFileEditor,closeFileEditor:this.closeFileEditor,disableInteractiveElements:this.disableInteractiveElements,animateOpenClose:this.opts.animateOpenClose,isClosing:i.isClosing,progressindicators:v,editors:C,autoProceed:this.uppy.opts.autoProceed,id:this.id,closeModal:this.requestCloseModal,handleClickOutside:this.handleClickOutside,handleInputChange:this.handleInputChange,handlePaste:this.handlePaste,inline:this.opts.inline,showPanel:this.showPanel,hideAllPanels:this.hideAllPanels,i18n:this.i18n,i18nArray:this.i18nArray,uppy:this.uppy,note:this.opts.note,recoveredState:e.recoveredState,metaFields:i.metaFields,resumableUploads:r.resumableUploads||!1,individualCancellation:r.individualCancellation,isMobileDevice:r.isMobileDevice,fileCardFor:i.fileCardFor,toggleFileCard:this.toggleFileCard,toggleAddFilesPanel:this.toggleAddFilesPanel,showAddFilesPanel:i.showAddFilesPanel,saveFileCard:this.saveFileCard,openFileEditor:this.openFileEditor,canEditFile:this.canEditFile,width:this.opts.width,height:this.opts.height,showLinkToFileUploadResult:this.opts.showLinkToFileUploadResult,fileManagerSelectionType:this.opts.fileManagerSelectionType,proudlyDisplayPoweredByUppy:this.opts.proudlyDisplayPoweredByUppy,showRemoveButtonAfterComplete:this.opts.showRemoveButtonAfterComplete,containerWidth:i.containerWidth,containerHeight:i.containerHeight,areInsidesReadyToBeVisible:i.areInsidesReadyToBeVisible,parentElement:this.el,allowedFileTypes:this.uppy.opts.restrictions.allowedFileTypes,maxNumberOfFiles:this.uppy.opts.restrictions.maxNumberOfFiles,requiredMetaFields:this.uppy.opts.restrictions.requiredMetaFields,showSelectedFiles:this.opts.showSelectedFiles,showNativePhotoCameraButton:this.opts.showNativePhotoCameraButton,showNativeVideoCameraButton:this.opts.showNativeVideoCameraButton,nativeCameraFacingMode:this.opts.nativeCameraFacingMode,singleFileFullScreen:this.opts.singleFileFullScreen,handleCancelRestore:this.handleCancelRestore,handleRequestThumbnail:this.handleRequestThumbnail,handleCancelThumbnail:this.handleCancelThumbnail,isDraggingOver:i.isDraggingOver,handleDragOver:this.handleDragOver,handleDragLeave:this.handleDragLeave,handleDrop:this.handleDrop,disableInformer:this.opts.disableInformer,disableStatusBar:this.opts.disableStatusBar,hideProgressDetails:this.opts.hideProgressDetails,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,hideCancelButton:this.opts.hideCancelButton,hideProgressAfterFinish:this.opts.hideProgressAfterFinish,doneButtonHandler:this.opts.doneButtonHandler})};#o=()=>{let{plugins:e}=this.opts;e.forEach(i=>{let n=this.uppy.getPlugin(i);n?n.mount(this,n):this.uppy.log(`[Uppy] Dashboard could not find plugin '${i}', make sure to uppy.use() the plugins you are specifying`,"warning")})};#p=()=>{this.uppy.iteratePlugins(this.#l)};#l=e=>{let i=["acquirer","editor"];e&&!e.opts?.target&&i.includes(e.type)&&(this.getPluginState().targets.some(r=>e.id===r.id)||e.mount(this,e))};#u(){let{thumbnailWidth:e,thumbnailHeight:i,thumbnailType:n,waitForThumbnailsBeforeUpload:r}=this.opts;return{thumbnailWidth:e,thumbnailHeight:i,thumbnailType:n,waitForThumbnailsBeforeUpload:r,lazy:!r}}setOptions(e){super.setOptions(e),this.uppy.getPlugin(this.#d())?.setOptions(this.#u())}#d(){return`${this.id}:ThumbnailGenerator`}install=()=>{this.setPluginState({isHidden:!0,fileCardFor:null,activeOverlayType:null,showAddFilesPanel:!1,activePickerPanel:void 0,showFileEditor:!1,metaFields:this.opts.metaFields,targets:[],areInsidesReadyToBeVisible:!1,isDraggingOver:!1});let{inline:e,closeAfterFinish:i}=this.opts;if(e&&i)throw new Error("[Dashboard] `closeAfterFinish: true` cannot be used on an inline Dashboard, because an inline Dashboard cannot be closed at all. Either set `inline: false`, or disable the `closeAfterFinish` option.");let{allowMultipleUploads:n,allowMultipleUploadBatches:r}=this.uppy.opts;(n||r)&&i&&this.uppy.log("[Dashboard] When using `closeAfterFinish`, we recommended setting the `allowMultipleUploadBatches` option to `false` in the Uppy constructor. See https://uppy.io/docs/uppy/#allowMultipleUploads-true","warning");let{target:o}=this.opts;o&&this.mount(o,this),this.opts.disableThumbnailGenerator||this.uppy.use(Xp,w({id:this.#d()},this.#u())),this.darkModeMediaQuery=typeof window<"u"&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)"):null;let s=this.darkModeMediaQuery?this.darkModeMediaQuery.matches:!1;this.uppy.log(`[Dashboard] Dark mode is ${s?"on":"off"}`),this.setDarkModeCapability(s),this.opts.theme==="auto"&&this.darkModeMediaQuery?.addListener(this.handleSystemDarkModeChange),this.#o(),this.#p(),this.initEvents()};uninstall=()=>{if(!this.opts.disableThumbnailGenerator){let i=this.uppy.getPlugin(`${this.id}:ThumbnailGenerator`);i&&this.uppy.removePlugin(i)}let{plugins:e}=this.opts;e.forEach(i=>{let n=this.uppy.getPlugin(i);n&&n.unmount()}),this.opts.theme==="auto"&&this.darkModeMediaQuery?.removeListener(this.handleSystemDarkModeChange),this.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove("uppy-Dashboard-isFixed"),this.unmount(),this.removeEvents()}};function wl(t){"@babel/helpers - typeof";return wl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wl(t)}function S_(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,sB(n.key),n)}}function oB(t,e,i){return e&&S_(t.prototype,e),i&&S_(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function sB(t){var e=aB(t,"string");return wl(e)=="symbol"?e:e+""}function aB(t,e){if(wl(t)!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var n=i.call(t,e||"default");if(wl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lB(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cB(t,e,i){return e=Xd(e),dB(t,bw()?Reflect.construct(e,i||[],Xd(t).constructor):e.apply(t,i))}function dB(t,e){if(e&&(wl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uB(t)}function uB(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function hB(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Yd(t,e)}function ww(t){var e=typeof Map=="function"?new Map:void 0;return ww=function(n){if(n===null||!fB(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(n))return e.get(n);e.set(n,r)}function r(){return pB(n,arguments,Xd(this).constructor)}return r.prototype=Object.create(n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Yd(r,n)},ww(t)}function pB(t,e,i){if(bw())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var r=new(t.bind.apply(t,n));return i&&Yd(r,i.prototype),r}function bw(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bw=function(){return!!t})()}function fB(t){try{return Function.toString.call(t).indexOf("[native code]")!==-1}catch{return typeof t=="function"}}function Yd(t,e){return Yd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Yd(t,e)}function Xd(t){return Xd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},Xd(t)}var gB=(function(t){function e(i){var n,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(lB(this,e),n=cB(this,e,[i]),n.originalRequest=o,n.originalResponse=s,n.causingError=r,r!=null&&(i+=", caused by ".concat(r.toString())),o!=null){var a=o.getHeader("X-Request-ID")||"n/a",l=o.getMethod(),c=o.getURL(),d=s?s.getStatus():"n/a",u=s?s.getBody()||"":"n/a";i+=", originated from request (method: ".concat(l,", url: ").concat(c,", response code: ").concat(d,", response text: ").concat(u,", request id: ").concat(a,")")}return n.message=i,n}return hB(e,t),oB(e)})(ww(Error)),bl=gB;var mB=!1;function Zo(t){mB&&console.log(t)}function Jd(t){"@babel/helpers - typeof";return Jd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jd(t)}function vB(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x_(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wB(n.key),n)}}function CB(t,e,i){return e&&x_(t.prototype,e),i&&x_(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function wB(t){var e=bB(t,"string");return Jd(e)=="symbol"?e:e+""}function bB(t,e){if(Jd(t)!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var n=i.call(t,e||"default");if(Jd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var E_=(function(){function t(){vB(this,t)}return CB(t,[{key:"listAllUploads",value:function(){return Promise.resolve([])}},{key:"findUploadsByFingerprint",value:function(i){return Promise.resolve([])}},{key:"removeUpload",value:function(i){return Promise.resolve()}},{key:"addUpload",value:function(i,n){return Promise.resolve(null)}}])})();var T_="3.7.8",yB=T_,Sl=typeof Buffer=="function",P_=typeof TextDecoder=="function"?new TextDecoder:void 0,R_=typeof TextEncoder=="function"?new TextEncoder:void 0,SB="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Qd=Array.prototype.slice.call(SB),of=(t=>{let e={};return t.forEach((i,n)=>e[i]=n),e})(Qd),xB=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,ai=String.fromCharCode.bind(String),__=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):t=>new Uint8Array(Array.prototype.slice.call(t,0)),D_=t=>t.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),M_=t=>t.replace(/[^A-Za-z0-9\+\/]/g,""),I_=t=>{let e,i,n,r,o="",s=t.length%3;for(let a=0;a<t.length;){if((i=t.charCodeAt(a++))>255||(n=t.charCodeAt(a++))>255||(r=t.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=i<<16|n<<8|r,o+=Qd[e>>18&63]+Qd[e>>12&63]+Qd[e>>6&63]+Qd[e&63]}return s?o.slice(0,s-3)+"===".substring(s):o},xw=typeof btoa=="function"?t=>btoa(t):Sl?t=>Buffer.from(t,"binary").toString("base64"):I_,yw=Sl?t=>Buffer.from(t).toString("base64"):t=>{let i=[];for(let n=0,r=t.length;n<r;n+=4096)i.push(ai.apply(null,t.subarray(n,n+4096)));return xw(i.join(""))},sf=(t,e=!1)=>e?D_(yw(t)):yw(t),EB=t=>{if(t.length<2){var e=t.charCodeAt(0);return e<128?t:e<2048?ai(192|e>>>6)+ai(128|e&63):ai(224|e>>>12&15)+ai(128|e>>>6&63)+ai(128|e&63)}else{var e=65536+(t.charCodeAt(0)-55296)*1024+(t.charCodeAt(1)-56320);return ai(240|e>>>18&7)+ai(128|e>>>12&63)+ai(128|e>>>6&63)+ai(128|e&63)}},PB=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,A_=t=>t.replace(PB,EB),k_=Sl?t=>Buffer.from(t,"utf8").toString("base64"):R_?t=>yw(R_.encode(t)):t=>xw(A_(t)),yl=(t,e=!1)=>e?D_(k_(t)):k_(t),F_=t=>yl(t,!0),RB=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,_B=t=>{switch(t.length){case 4:var e=(7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3),i=e-65536;return ai((i>>>10)+55296)+ai((i&1023)+56320);case 3:return ai((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return ai((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},O_=t=>t.replace(RB,_B),L_=t=>{if(t=t.replace(/\s+/g,""),!xB.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(t.length&3));let e,i,n,r=[];for(let o=0;o<t.length;)e=of[t.charAt(o++)]<<18|of[t.charAt(o++)]<<12|(i=of[t.charAt(o++)])<<6|(n=of[t.charAt(o++)]),i===64?r.push(ai(e>>16&255)):n===64?r.push(ai(e>>16&255,e>>8&255)):r.push(ai(e>>16&255,e>>8&255,e&255));return r.join("")},Ew=typeof atob=="function"?t=>atob(M_(t)):Sl?t=>Buffer.from(t,"base64").toString("binary"):L_,N_=Sl?t=>__(Buffer.from(t,"base64")):t=>__(Ew(t).split("").map(e=>e.charCodeAt(0))),B_=t=>N_(H_(t)),kB=Sl?t=>Buffer.from(t,"base64").toString("utf8"):P_?t=>P_.decode(N_(t)):t=>O_(Ew(t)),H_=t=>M_(t.replace(/[-_]/g,e=>e=="-"?"+":"/")),Sw=t=>kB(H_(t)),FB=t=>{if(typeof t!="string")return!1;let e=t.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(e)||!/[^\s0-9a-zA-Z\-_]/.test(e)},z_=t=>({value:t,enumerable:!1,writable:!0,configurable:!0}),V_=function(){let t=(e,i)=>Object.defineProperty(String.prototype,e,z_(i));t("fromBase64",function(){return Sw(this)}),t("toBase64",function(e){return yl(this,e)}),t("toBase64URI",function(){return yl(this,!0)}),t("toBase64URL",function(){return yl(this,!0)}),t("toUint8Array",function(){return B_(this)})},G_=function(){let t=(e,i)=>Object.defineProperty(Uint8Array.prototype,e,z_(i));t("toBase64",function(e){return sf(this,e)}),t("toBase64URI",function(){return sf(this,!0)}),t("toBase64URL",function(){return sf(this,!0)})},TB=()=>{V_(),G_()},W_={version:T_,VERSION:yB,atob:Ew,atobPolyfill:L_,btoa:xw,btoaPolyfill:I_,fromBase64:Sw,toBase64:yl,encode:yl,encodeURI:F_,encodeURL:F_,utob:A_,btou:O_,decode:Sw,isValid:FB,fromUint8Array:sf,toUint8Array:B_,extendString:V_,extendUint8Array:G_,extendBuiltins:TB};var gk=nt(ik());function kw(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=Math.random()*16|0,i=t==="x"?e:e&3|8;return i.toString(16)})}function Fw(){"use strict";Fw=function(){return e};var t,e={},i=Object.prototype,n=i.hasOwnProperty,r=Object.defineProperty||function(T,R,_){T[R]=_.value},o=typeof Symbol=="function"?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(T,R,_){return Object.defineProperty(T,R,{value:_,enumerable:!0,configurable:!0,writable:!0}),T[R]}try{c({},"")}catch{c=function(_,z,G){return _[z]=G}}function d(T,R,_,z){var G=R&&R.prototype instanceof v?R:v,U=Object.create(G.prototype),N=new Se(z||[]);return r(U,"_invoke",{value:j(T,_,N)}),U}function u(T,R,_){try{return{type:"normal",arg:T.call(R,_)}}catch(z){return{type:"throw",arg:z}}}e.wrap=d;var h="suspendedStart",p="suspendedYield",f="executing",g="completed",m={};function v(){}function C(){}function b(){}var S={};c(S,s,function(){return this});var x=Object.getPrototypeOf,E=x&&x(x(be([])));E&&E!==i&&n.call(E,s)&&(S=E);var P=b.prototype=v.prototype=Object.create(S);function L(T){["next","throw","return"].forEach(function(R){c(T,R,function(_){return this._invoke(R,_)})})}function B(T,R){function _(G,U,N,I){var V=u(T[G],T,U);if(V.type!=="throw"){var $=V.arg,me=$.value;return me&&Ys(me)=="object"&&n.call(me,"__await")?R.resolve(me.__await).then(function(Ce){_("next",Ce,N,I)},function(Ce){_("throw",Ce,N,I)}):R.resolve(me).then(function(Ce){$.value=Ce,N($)},function(Ce){return _("throw",Ce,N,I)})}I(V.arg)}var z;r(this,"_invoke",{value:function(U,N){function I(){return new R(function(V,$){_(U,N,V,$)})}return z=z?z.then(I,I):I()}})}function j(T,R,_){var z=h;return function(G,U){if(z===f)throw Error("Generator is already running");if(z===g){if(G==="throw")throw U;return{value:t,done:!0}}for(_.method=G,_.arg=U;;){var N=_.delegate;if(N){var I=q(N,_);if(I){if(I===m)continue;return I}}if(_.method==="next")_.sent=_._sent=_.arg;else if(_.method==="throw"){if(z===h)throw z=g,_.arg;_.dispatchException(_.arg)}else _.method==="return"&&_.abrupt("return",_.arg);z=f;var V=u(T,R,_);if(V.type==="normal"){if(z=_.done?g:p,V.arg===m)continue;return{value:V.arg,done:_.done}}V.type==="throw"&&(z=g,_.method="throw",_.arg=V.arg)}}}function q(T,R){var _=R.method,z=T.iterator[_];if(z===t)return R.delegate=null,_==="throw"&&T.iterator.return&&(R.method="return",R.arg=t,q(T,R),R.method==="throw")||_!=="return"&&(R.method="throw",R.arg=new TypeError("The iterator does not provide a '"+_+"' method")),m;var G=u(z,T.iterator,R.arg);if(G.type==="throw")return R.method="throw",R.arg=G.arg,R.delegate=null,m;var U=G.arg;return U?U.done?(R[T.resultName]=U.value,R.next=T.nextLoc,R.method!=="return"&&(R.method="next",R.arg=t),R.delegate=null,m):U:(R.method="throw",R.arg=new TypeError("iterator result is not an object"),R.delegate=null,m)}function Y(T){var R={tryLoc:T[0]};1 in T&&(R.catchLoc=T[1]),2 in T&&(R.finallyLoc=T[2],R.afterLoc=T[3]),this.tryEntries.push(R)}function he(T){var R=T.completion||{};R.type="normal",delete R.arg,T.completion=R}function Se(T){this.tryEntries=[{tryLoc:"root"}],T.forEach(Y,this),this.reset(!0)}function be(T){if(T||T===""){var R=T[s];if(R)return R.call(T);if(typeof T.next=="function")return T;if(!isNaN(T.length)){var _=-1,z=function G(){for(;++_<T.length;)if(n.call(T,_))return G.value=T[_],G.done=!1,G;return G.value=t,G.done=!0,G};return z.next=z}}throw new TypeError(Ys(T)+" is not iterable")}return C.prototype=b,r(P,"constructor",{value:b,configurable:!0}),r(b,"constructor",{value:C,configurable:!0}),C.displayName=c(b,l,"GeneratorFunction"),e.isGeneratorFunction=function(T){var R=typeof T=="function"&&T.constructor;return!!R&&(R===C||(R.displayName||R.name)==="GeneratorFunction")},e.mark=function(T){return Object.setPrototypeOf?Object.setPrototypeOf(T,b):(T.__proto__=b,c(T,l,"GeneratorFunction")),T.prototype=Object.create(P),T},e.awrap=function(T){return{__await:T}},L(B.prototype),c(B.prototype,a,function(){return this}),e.AsyncIterator=B,e.async=function(T,R,_,z,G){G===void 0&&(G=Promise);var U=new B(d(T,R,_,z),G);return e.isGeneratorFunction(R)?U:U.next().then(function(N){return N.done?N.value:U.next()})},L(P),c(P,l,"Generator"),c(P,s,function(){return this}),c(P,"toString",function(){return"[object Generator]"}),e.keys=function(T){var R=Object(T),_=[];for(var z in R)_.push(z);return _.reverse(),function G(){for(;_.length;){var U=_.pop();if(U in R)return G.value=U,G.done=!1,G}return G.done=!0,G}},e.values=be,Se.prototype={constructor:Se,reset:function(R){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(he),!R)for(var _ in this)_.charAt(0)==="t"&&n.call(this,_)&&!isNaN(+_.slice(1))&&(this[_]=t)},stop:function(){this.done=!0;var R=this.tryEntries[0].completion;if(R.type==="throw")throw R.arg;return this.rval},dispatchException:function(R){if(this.done)throw R;var _=this;function z($,me){return N.type="throw",N.arg=R,_.next=$,me&&(_.method="next",_.arg=t),!!me}for(var G=this.tryEntries.length-1;G>=0;--G){var U=this.tryEntries[G],N=U.completion;if(U.tryLoc==="root")return z("end");if(U.tryLoc<=this.prev){var I=n.call(U,"catchLoc"),V=n.call(U,"finallyLoc");if(I&&V){if(this.prev<U.catchLoc)return z(U.catchLoc,!0);if(this.prev<U.finallyLoc)return z(U.finallyLoc)}else if(I){if(this.prev<U.catchLoc)return z(U.catchLoc,!0)}else{if(!V)throw Error("try statement without catch or finally");if(this.prev<U.finallyLoc)return z(U.finallyLoc)}}}},abrupt:function(R,_){for(var z=this.tryEntries.length-1;z>=0;--z){var G=this.tryEntries[z];if(G.tryLoc<=this.prev&&n.call(G,"finallyLoc")&&this.prev<G.finallyLoc){var U=G;break}}U&&(R==="break"||R==="continue")&&U.tryLoc<=_&&_<=U.finallyLoc&&(U=null);var N=U?U.completion:{};return N.type=R,N.arg=_,U?(this.method="next",this.next=U.finallyLoc,m):this.complete(N)},complete:function(R,_){if(R.type==="throw")throw R.arg;return R.type==="break"||R.type==="continue"?this.next=R.arg:R.type==="return"?(this.rval=this.arg=R.arg,this.method="return",this.next="end"):R.type==="normal"&&_&&(this.next=_),m},finish:function(R){for(var _=this.tryEntries.length-1;_>=0;--_){var z=this.tryEntries[_];if(z.finallyLoc===R)return this.complete(z.completion,z.afterLoc),he(z),m}},catch:function(R){for(var _=this.tryEntries.length-1;_>=0;--_){var z=this.tryEntries[_];if(z.tryLoc===R){var G=z.completion;if(G.type==="throw"){var U=G.arg;he(z)}return U}}throw Error("illegal catch attempt")},delegateYield:function(R,_,z){return this.delegate={iterator:be(R),resultName:_,nextLoc:z},this.method==="next"&&(this.arg=t),m}},e}function nk(t,e,i,n,r,o,s){try{var a=t[o](s),l=a.value}catch(c){i(c);return}a.done?e(l):Promise.resolve(l).then(n,r)}function GB(t){return function(){var e=this,i=arguments;return new Promise(function(n,r){var o=t.apply(e,i);function s(l){nk(o,n,r,s,a,"next",l)}function a(l){nk(o,n,r,s,a,"throw",l)}s(void 0)})}}function hk(t,e){return jB(t)||UB(t,e)||pk(t,e)||WB()}function WB(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UB(t,e){var i=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(i!=null){var n,r,o,s,a=[],l=!0,c=!1;try{if(o=(i=i.call(t)).next,e===0){if(Object(i)!==i)return;l=!1}else for(;!(l=(n=o.call(i)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(d){c=!0,r=d}finally{try{if(!l&&i.return!=null&&(s=i.return(),Object(s)!==s))return}finally{if(c)throw r}}return a}}function jB(t){if(Array.isArray(t))return t}function Ys(t){"@babel/helpers - typeof";return Ys=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ys(t)}function qB(t,e){var i=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=pk(t))||e&&t&&typeof t.length=="number"){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(c){throw c},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,s=!1,a;return{s:function(){i=i.call(t)},n:function(){var c=i.next();return o=c.done,c},e:function(c){s=!0,a=c},f:function(){try{!o&&i.return!=null&&i.return()}finally{if(s)throw a}}}}function pk(t,e){if(t){if(typeof t=="string")return rk(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);if(i==="Object"&&t.constructor&&(i=t.constructor.name),i==="Map"||i==="Set")return Array.from(t);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return rk(t,e)}}function rk(t,e){(e==null||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function ok(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),i.push.apply(i,n)}return i}function xl(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?ok(Object(i),!0).forEach(function(n){$B(t,n,i[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ok(Object(i)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))})}return t}function $B(t,e,i){return e=fk(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function KB(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sk(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,fk(n.key),n)}}function YB(t,e,i){return e&&sk(t.prototype,e),i&&sk(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function fk(t){var e=XB(t,"string");return Ys(e)=="symbol"?e:e+""}function XB(t,e){if(Ys(t)!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var n=i.call(t,e||"default");if(Ys(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var lf="tus-v1",cf="ietf-draft-03",Zd="ietf-draft-05",JB={endpoint:null,uploadUrl:null,metadata:{},metadataForPartialUploads:{},fingerprint:null,uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,onUploadUrlAvailable:null,overridePatchMethod:!1,headers:{},addRequestId:!1,onBeforeRequest:null,onAfterResponse:null,onShouldRetry:vk,chunkSize:Number.POSITIVE_INFINITY,retryDelays:[0,1e3,3e3,5e3],parallelUploads:1,parallelUploadBoundaries:null,storeFingerprintForResuming:!0,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1,urlStorage:null,fileReader:null,httpStack:null,protocol:lf},mk=(function(){function t(e,i){KB(this,t),"resume"in i&&console.log("tus: The `resume` option has been removed in tus-js-client v2. Please use the URL storage API instead."),this.options=i,this.options.chunkSize=Number(this.options.chunkSize),this._urlStorage=this.options.urlStorage,this.file=e,this.url=null,this._req=null,this._fingerprint=null,this._urlStorageKey=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0,this._parallelUploads=null,this._parallelUploadUrls=null}return YB(t,[{key:"findPreviousUploads",value:function(){var i=this;return this.options.fingerprint(this.file,this.options).then(function(n){return i._urlStorage.findUploadsByFingerprint(n)})}},{key:"resumeFromPreviousUpload",value:function(i){this.url=i.uploadUrl||null,this._parallelUploadUrls=i.parallelUploadUrls||null,this._urlStorageKey=i.urlStorageKey}},{key:"start",value:function(){var i=this,n=this.file;if(!n){this._emitError(new Error("tus: no file or stream to upload provided"));return}if(![lf,cf,Zd].includes(this.options.protocol)){this._emitError(new Error("tus: unsupported protocol ".concat(this.options.protocol)));return}if(!this.options.endpoint&&!this.options.uploadUrl&&!this.url){this._emitError(new Error("tus: neither an endpoint or an upload URL is provided"));return}var r=this.options.retryDelays;if(r!=null&&Object.prototype.toString.call(r)!=="[object Array]"){this._emitError(new Error("tus: the `retryDelays` option must either be an array or null"));return}if(this.options.parallelUploads>1)for(var o=0,s=["uploadUrl","uploadSize","uploadLengthDeferred"];o<s.length;o++){var a=s[o];if(this.options[a]){this._emitError(new Error("tus: cannot use the ".concat(a," option when parallelUploads is enabled")));return}}if(this.options.parallelUploadBoundaries){if(this.options.parallelUploads<=1){this._emitError(new Error("tus: cannot use the `parallelUploadBoundaries` option when `parallelUploads` is disabled"));return}if(this.options.parallelUploads!==this.options.parallelUploadBoundaries.length){this._emitError(new Error("tus: the `parallelUploadBoundaries` must have the same length as the value of `parallelUploads`"));return}}this.options.fingerprint(n,this.options).then(function(l){return l==null?Zo("No fingerprint was calculated meaning that the upload cannot be stored in the URL storage."):Zo("Calculated fingerprint: ".concat(l)),i._fingerprint=l,i._source?i._source:i.options.fileReader.openFile(n,i.options.chunkSize)}).then(function(l){if(i._source=l,i.options.uploadLengthDeferred)i._size=null;else if(i.options.uploadSize!=null){if(i._size=Number(i.options.uploadSize),Number.isNaN(i._size)){i._emitError(new Error("tus: cannot convert `uploadSize` option into a number"));return}}else if(i._size=i._source.size,i._size==null){i._emitError(new Error("tus: cannot automatically derive upload's size from input. Specify it manually using the `uploadSize` option or use the `uploadLengthDeferred` option"));return}i.options.parallelUploads>1||i._parallelUploadUrls!=null?i._startParallelUpload():i._startSingleUpload()}).catch(function(l){i._emitError(l)})}},{key:"_startParallelUpload",value:function(){var i,n=this,r=this._size,o=0;this._parallelUploads=[];var s=this._parallelUploadUrls!=null?this._parallelUploadUrls.length:this.options.parallelUploads,a=(i=this.options.parallelUploadBoundaries)!==null&&i!==void 0?i:ZB(this._source.size,s);this._parallelUploadUrls&&a.forEach(function(d,u){d.uploadUrl=n._parallelUploadUrls[u]||null}),this._parallelUploadUrls=new Array(a.length);var l=a.map(function(d,u){var h=0;return n._source.slice(d.start,d.end).then(function(p){var f=p.value;return new Promise(function(g,m){var v=xl(xl({},n.options),{},{uploadUrl:d.uploadUrl||null,storeFingerprintForResuming:!1,removeFingerprintOnSuccess:!1,parallelUploads:1,parallelUploadBoundaries:null,metadata:n.options.metadataForPartialUploads,headers:xl(xl({},n.options.headers),{},{"Upload-Concat":"partial"}),onSuccess:g,onError:m,onProgress:function(S){o=o-h+S,h=S,n._emitProgress(o,r)},onUploadUrlAvailable:function(){n._parallelUploadUrls[u]=C.url,n._parallelUploadUrls.filter(function(S){return!!S}).length===a.length&&n._saveUploadInUrlStorage()}}),C=new t(f,v);C.start(),n._parallelUploads.push(C)})})}),c;Promise.all(l).then(function(){c=n._openRequest("POST",n.options.endpoint),c.setHeader("Upload-Concat","final;".concat(n._parallelUploadUrls.join(" ")));var d=ak(n.options.metadata);return d!==""&&c.setHeader("Upload-Metadata",d),n._sendRequest(c,null)}).then(function(d){if(!El(d.getStatus(),200)){n._emitHttpError(c,d,"tus: unexpected response while creating upload");return}var u=d.getHeader("Location");if(u==null){n._emitHttpError(c,d,"tus: invalid or missing Location header");return}n.url=uk(n.options.endpoint,u),Zo("Created upload at ".concat(n.url)),n._emitSuccess(d)}).catch(function(d){n._emitError(d)})}},{key:"_startSingleUpload",value:function(){if(this._aborted=!1,this.url!=null){Zo("Resuming upload from previous URL: ".concat(this.url)),this._resumeUpload();return}if(this.options.uploadUrl!=null){Zo("Resuming upload from provided URL: ".concat(this.options.uploadUrl)),this.url=this.options.uploadUrl,this._resumeUpload();return}Zo("Creating a new upload"),this._createUpload()}},{key:"abort",value:function(i){var n=this;if(this._parallelUploads!=null){var r=qB(this._parallelUploads),o;try{for(r.s();!(o=r.n()).done;){var s=o.value;s.abort(i)}}catch(a){r.e(a)}finally{r.f()}}return this._req!==null&&this._req.abort(),this._aborted=!0,this._retryTimeout!=null&&(clearTimeout(this._retryTimeout),this._retryTimeout=null),!i||this.url==null?Promise.resolve():t.terminate(this.url,this.options).then(function(){return n._removeFromUrlStorage()})}},{key:"_emitHttpError",value:function(i,n,r,o){this._emitError(new bl(r,o,i,n))}},{key:"_emitError",value:function(i){var n=this;if(!this._aborted){if(this.options.retryDelays!=null){var r=this._offset!=null&&this._offset>this._offsetBeforeRetry;if(r&&(this._retryAttempt=0),dk(i,this._retryAttempt,this.options)){var o=this.options.retryDelays[this._retryAttempt++];this._offsetBeforeRetry=this._offset,this._retryTimeout=setTimeout(function(){n.start()},o);return}}if(typeof this.options.onError=="function")this.options.onError(i);else throw i}}},{key:"_emitSuccess",value:function(i){this.options.removeFingerprintOnSuccess&&this._removeFromUrlStorage(),typeof this.options.onSuccess=="function"&&this.options.onSuccess({lastResponse:i})}},{key:"_emitProgress",value:function(i,n){typeof this.options.onProgress=="function"&&this.options.onProgress(i,n)}},{key:"_emitChunkComplete",value:function(i,n,r){typeof this.options.onChunkComplete=="function"&&this.options.onChunkComplete(i,n,r)}},{key:"_createUpload",value:function(){var i=this;if(!this.options.endpoint){this._emitError(new Error("tus: unable to create upload because no endpoint is provided"));return}var n=this._openRequest("POST",this.options.endpoint);this.options.uploadLengthDeferred?n.setHeader("Upload-Defer-Length","1"):n.setHeader("Upload-Length","".concat(this._size));var r=ak(this.options.metadata);r!==""&&n.setHeader("Upload-Metadata",r);var o;this.options.uploadDataDuringCreation&&!this.options.uploadLengthDeferred?(this._offset=0,o=this._addChunkToRequest(n)):((this.options.protocol===cf||this.options.protocol===Zd)&&n.setHeader("Upload-Complete","?0"),o=this._sendRequest(n,null)),o.then(function(s){if(!El(s.getStatus(),200)){i._emitHttpError(n,s,"tus: unexpected response while creating upload");return}var a=s.getHeader("Location");if(a==null){i._emitHttpError(n,s,"tus: invalid or missing Location header");return}if(i.url=uk(i.options.endpoint,a),Zo("Created upload at ".concat(i.url)),typeof i.options.onUploadUrlAvailable=="function"&&i.options.onUploadUrlAvailable(),i._size===0){i._emitSuccess(s),i._source.close();return}i._saveUploadInUrlStorage().then(function(){i.options.uploadDataDuringCreation?i._handleUploadResponse(n,s):(i._offset=0,i._performUpload())})}).catch(function(s){i._emitHttpError(n,null,"tus: failed to create upload",s)})}},{key:"_resumeUpload",value:function(){var i=this,n=this._openRequest("HEAD",this.url),r=this._sendRequest(n,null);r.then(function(o){var s=o.getStatus();if(!El(s,200)){if(s===423){i._emitHttpError(n,o,"tus: upload is currently locked; retry later");return}if(El(s,400)&&i._removeFromUrlStorage(),!i.options.endpoint){i._emitHttpError(n,o,"tus: unable to resume upload (new upload cannot be created without an endpoint)");return}i.url=null,i._createUpload();return}var a=Number.parseInt(o.getHeader("Upload-Offset"),10);if(Number.isNaN(a)){i._emitHttpError(n,o,"tus: invalid or missing offset value");return}var l=Number.parseInt(o.getHeader("Upload-Length"),10);if(Number.isNaN(l)&&!i.options.uploadLengthDeferred&&i.options.protocol===lf){i._emitHttpError(n,o,"tus: invalid or missing length value");return}typeof i.options.onUploadUrlAvailable=="function"&&i.options.onUploadUrlAvailable(),i._saveUploadInUrlStorage().then(function(){if(a===l){i._emitProgress(l,l),i._emitSuccess(o);return}i._offset=a,i._performUpload()})}).catch(function(o){i._emitHttpError(n,null,"tus: failed to resume upload",o)})}},{key:"_performUpload",value:function(){var i=this;if(!this._aborted){var n;this.options.overridePatchMethod?(n=this._openRequest("POST",this.url),n.setHeader("X-HTTP-Method-Override","PATCH")):n=this._openRequest("PATCH",this.url),n.setHeader("Upload-Offset","".concat(this._offset));var r=this._addChunkToRequest(n);r.then(function(o){if(!El(o.getStatus(),200)){i._emitHttpError(n,o,"tus: unexpected response while uploading chunk");return}i._handleUploadResponse(n,o)}).catch(function(o){i._aborted||i._emitHttpError(n,null,"tus: failed to upload chunk at offset ".concat(i._offset),o)})}}},{key:"_addChunkToRequest",value:function(i){var n=this,r=this._offset,o=this._offset+this.options.chunkSize;return i.setProgressHandler(function(s){n._emitProgress(r+s,n._size)}),this.options.protocol===lf?i.setHeader("Content-Type","application/offset+octet-stream"):this.options.protocol===Zd&&i.setHeader("Content-Type","application/partial-upload"),(o===Number.POSITIVE_INFINITY||o>this._size)&&!this.options.uploadLengthDeferred&&(o=this._size),this._source.slice(r,o).then(function(s){var a=s.value,l=s.done,c=a!=null&&a.size?a.size:0;n.options.uploadLengthDeferred&&l&&(n._size=n._offset+c,i.setHeader("Upload-Length","".concat(n._size)));var d=n._offset+c;return!n.options.uploadLengthDeferred&&l&&d!==n._size?Promise.reject(new Error("upload was configured with a size of ".concat(n._size," bytes, but the source is done after ").concat(d," bytes"))):a===null?n._sendRequest(i):((n.options.protocol===cf||n.options.protocol===Zd)&&i.setHeader("Upload-Complete",l?"?1":"?0"),n._emitProgress(n._offset,n._size),n._sendRequest(i,a))})}},{key:"_handleUploadResponse",value:function(i,n){var r=Number.parseInt(n.getHeader("Upload-Offset"),10);if(Number.isNaN(r)){this._emitHttpError(i,n,"tus: invalid or missing offset value");return}if(this._emitProgress(r,this._size),this._emitChunkComplete(r-this._offset,r,this._size),this._offset=r,r===this._size){this._emitSuccess(n),this._source.close();return}this._performUpload()}},{key:"_openRequest",value:function(i,n){var r=lk(i,n,this.options);return this._req=r,r}},{key:"_removeFromUrlStorage",value:function(){var i=this;this._urlStorageKey&&(this._urlStorage.removeUpload(this._urlStorageKey).catch(function(n){i._emitError(n)}),this._urlStorageKey=null)}},{key:"_saveUploadInUrlStorage",value:function(){var i=this;if(!this.options.storeFingerprintForResuming||!this._fingerprint||this._urlStorageKey!==null)return Promise.resolve();var n={size:this._size,metadata:this.options.metadata,creationTime:new Date().toString()};return this._parallelUploads?n.parallelUploadUrls=this._parallelUploadUrls:n.uploadUrl=this.url,this._urlStorage.addUpload(this._fingerprint,n).then(function(r){i._urlStorageKey=r})}},{key:"_sendRequest",value:function(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return ck(i,n,this.options)}}],[{key:"terminate",value:function(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=lk("DELETE",i,n);return ck(r,null,n).then(function(o){if(o.getStatus()!==204)throw new bl("tus: unexpected response while terminating upload",null,r,o)}).catch(function(o){if(o instanceof bl||(o=new bl("tus: failed to terminate upload",o,r,null)),!dk(o,0,n))throw o;var s=n.retryDelays[0],a=n.retryDelays.slice(1),l=xl(xl({},n),{},{retryDelays:a});return new Promise(function(c){return setTimeout(c,s)}).then(function(){return t.terminate(i,l)})})}}])})();function ak(t){return Object.entries(t).map(function(e){var i=hk(e,2),n=i[0],r=i[1];return"".concat(n," ").concat(W_.encode(String(r)))}).join(",")}function El(t,e){return t>=e&&t<e+100}function lk(t,e,i){var n=i.httpStack.createRequest(t,e);i.protocol===cf?n.setHeader("Upload-Draft-Interop-Version","5"):i.protocol===Zd?n.setHeader("Upload-Draft-Interop-Version","6"):n.setHeader("Tus-Resumable","1.0.0");for(var r=i.headers||{},o=0,s=Object.entries(r);o<s.length;o++){var a=hk(s[o],2),l=a[0],c=a[1];n.setHeader(l,c)}if(i.addRequestId){var d=kw();n.setHeader("X-Request-ID",d)}return n}function ck(t,e,i){return Tw.apply(this,arguments)}function Tw(){return Tw=GB(Fw().mark(function t(e,i,n){var r;return Fw().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(typeof n.onBeforeRequest!="function"){s.next=3;break}return s.next=3,n.onBeforeRequest(e);case 3:return s.next=5,e.send(i);case 5:if(r=s.sent,typeof n.onAfterResponse!="function"){s.next=9;break}return s.next=9,n.onAfterResponse(e,r);case 9:return s.abrupt("return",r);case 10:case"end":return s.stop()}},t)})),Tw.apply(this,arguments)}function QB(){var t=!0;return typeof navigator<"u"&&navigator.onLine===!1&&(t=!1),t}function dk(t,e,i){return i.retryDelays==null||e>=i.retryDelays.length||t.originalRequest==null?!1:i&&typeof i.onShouldRetry=="function"?i.onShouldRetry(t,e,i):vk(t)}function vk(t){var e=t.originalResponse?t.originalResponse.getStatus():0;return(!El(e,400)||e===409||e===423)&&QB()}function uk(t,e){return new gk.default(e,t).toString()}function ZB(t,e){for(var i=Math.floor(t/e),n=[],r=0;r<e;r++)n.push({start:i*r,end:i*(r+1)});return n[e-1].end=t,n}mk.defaultOptions=JB;var df=mk;var eH=function(){return typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative"},uf=eH;function Dw(t){return new Promise(function(e,i){var n=new XMLHttpRequest;n.responseType="blob",n.onload=function(){var r=n.response;e(r)},n.onerror=function(r){i(r)},n.open("GET",t),n.send()})}var tH=function(){return typeof window<"u"&&(typeof window.PhoneGap<"u"||typeof window.Cordova<"u"||typeof window.cordova<"u")},Ck=tH;function Mw(t){return new Promise(function(e,i){var n=new FileReader;n.onload=function(){var r=new Uint8Array(n.result);e({value:r})},n.onerror=function(r){i(r)},n.readAsArrayBuffer(t)})}function eu(t){"@babel/helpers - typeof";return eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eu(t)}function iH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wk(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rH(n.key),n)}}function nH(t,e,i){return e&&wk(t.prototype,e),i&&wk(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function rH(t){var e=oH(t,"string");return eu(e)=="symbol"?e:e+""}function oH(t,e){if(eu(t)!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var n=i.call(t,e||"default");if(eu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Iw=(function(){function t(e){iH(this,t),this._file=e,this.size=e.size}return nH(t,[{key:"slice",value:function(i,n){if(Ck())return Mw(this._file.slice(i,n));var r=this._file.slice(i,n),o=n>=this.size;return Promise.resolve({value:r,done:o})}},{key:"close",value:function(){}}])})();function tu(t){"@babel/helpers - typeof";return tu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tu(t)}function sH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bk(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,lH(n.key),n)}}function aH(t,e,i){return e&&bk(t.prototype,e),i&&bk(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function lH(t){var e=cH(t,"string");return tu(e)=="symbol"?e:e+""}function cH(t,e){if(tu(t)!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var n=i.call(t,e||"default");if(tu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yk(t){return t===void 0?0:t.size!==void 0?t.size:t.length}function dH(t,e){if(t.concat)return t.concat(e);if(t instanceof Blob)return new Blob([t,e],{type:t.type});if(t.set){var i=new t.constructor(t.length+e.length);return i.set(t),i.set(e,t.length),i}throw new Error("Unknown data type")}var Sk=(function(){function t(e){sH(this,t),this._buffer=void 0,this._bufferOffset=0,this._reader=e,this._done=!1}return aH(t,[{key:"slice",value:function(i,n){return i<this._bufferOffset?Promise.reject(new Error("Requested data is before the reader's current offset")):this._readUntilEnoughDataOrDone(i,n)}},{key:"_readUntilEnoughDataOrDone",value:function(i,n){var r=this,o=n<=this._bufferOffset+yk(this._buffer);if(this._done||o){var s=this._getDataFromBuffer(i,n),a=s==null?this._done:!1;return Promise.resolve({value:s,done:a})}return this._reader.read().then(function(l){var c=l.value,d=l.done;return d?r._done=!0:r._buffer===void 0?r._buffer=c:r._buffer=dH(r._buffer,c),r._readUntilEnoughDataOrDone(i,n)})}},{key:"_getDataFromBuffer",value:function(i,n){i>this._bufferOffset&&(this._buffer=this._buffer.slice(i-this._bufferOffset),this._bufferOffset=i);var r=yk(this._buffer)===0;return this._done&&r?null:this._buffer.slice(0,n-i)}},{key:"close",value:function(){this._reader.cancel&&this._reader.cancel()}}])})();function Xs(t){"@babel/helpers - typeof";return Xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xs(t)}function Aw(){"use strict";Aw=function(){return e};var t,e={},i=Object.prototype,n=i.hasOwnProperty,r=Object.defineProperty||function(T,R,_){T[R]=_.value},o=typeof Symbol=="function"?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(T,R,_){return Object.defineProperty(T,R,{value:_,enumerable:!0,configurable:!0,writable:!0}),T[R]}try{c({},"")}catch{c=function(_,z,G){return _[z]=G}}function d(T,R,_,z){var G=R&&R.prototype instanceof v?R:v,U=Object.create(G.prototype),N=new Se(z||[]);return r(U,"_invoke",{value:j(T,_,N)}),U}function u(T,R,_){try{return{type:"normal",arg:T.call(R,_)}}catch(z){return{type:"throw",arg:z}}}e.wrap=d;var h="suspendedStart",p="suspendedYield",f="executing",g="completed",m={};function v(){}function C(){}function b(){}var S={};c(S,s,function(){return this});var x=Object.getPrototypeOf,E=x&&x(x(be([])));E&&E!==i&&n.call(E,s)&&(S=E);var P=b.prototype=v.prototype=Object.create(S);function L(T){["next","throw","return"].forEach(function(R){c(T,R,function(_){return this._invoke(R,_)})})}function B(T,R){function _(G,U,N,I){var V=u(T[G],T,U);if(V.type!=="throw"){var $=V.arg,me=$.value;return me&&Xs(me)=="object"&&n.call(me,"__await")?R.resolve(me.__await).then(function(Ce){_("next",Ce,N,I)},function(Ce){_("throw",Ce,N,I)}):R.resolve(me).then(function(Ce){$.value=Ce,N($)},function(Ce){return _("throw",Ce,N,I)})}I(V.arg)}var z;r(this,"_invoke",{value:function(U,N){function I(){return new R(function(V,$){_(U,N,V,$)})}return z=z?z.then(I,I):I()}})}function j(T,R,_){var z=h;return function(G,U){if(z===f)throw Error("Generator is already running");if(z===g){if(G==="throw")throw U;return{value:t,done:!0}}for(_.method=G,_.arg=U;;){var N=_.delegate;if(N){var I=q(N,_);if(I){if(I===m)continue;return I}}if(_.method==="next")_.sent=_._sent=_.arg;else if(_.method==="throw"){if(z===h)throw z=g,_.arg;_.dispatchException(_.arg)}else _.method==="return"&&_.abrupt("return",_.arg);z=f;var V=u(T,R,_);if(V.type==="normal"){if(z=_.done?g:p,V.arg===m)continue;return{value:V.arg,done:_.done}}V.type==="throw"&&(z=g,_.method="throw",_.arg=V.arg)}}}function q(T,R){var _=R.method,z=T.iterator[_];if(z===t)return R.delegate=null,_==="throw"&&T.iterator.return&&(R.method="return",R.arg=t,q(T,R),R.method==="throw")||_!=="return"&&(R.method="throw",R.arg=new TypeError("The iterator does not provide a '"+_+"' method")),m;var G=u(z,T.iterator,R.arg);if(G.type==="throw")return R.method="throw",R.arg=G.arg,R.delegate=null,m;var U=G.arg;return U?U.done?(R[T.resultName]=U.value,R.next=T.nextLoc,R.method!=="return"&&(R.method="next",R.arg=t),R.delegate=null,m):U:(R.method="throw",R.arg=new TypeError("iterator result is not an object"),R.delegate=null,m)}function Y(T){var R={tryLoc:T[0]};1 in T&&(R.catchLoc=T[1]),2 in T&&(R.finallyLoc=T[2],R.afterLoc=T[3]),this.tryEntries.push(R)}function he(T){var R=T.completion||{};R.type="normal",delete R.arg,T.completion=R}function Se(T){this.tryEntries=[{tryLoc:"root"}],T.forEach(Y,this),this.reset(!0)}function be(T){if(T||T===""){var R=T[s];if(R)return R.call(T);if(typeof T.next=="function")return T;if(!isNaN(T.length)){var _=-1,z=function G(){for(;++_<T.length;)if(n.call(T,_))return G.value=T[_],G.done=!1,G;return G.value=t,G.done=!0,G};return z.next=z}}throw new TypeError(Xs(T)+" is not iterable")}return C.prototype=b,r(P,"constructor",{value:b,configurable:!0}),r(b,"constructor",{value:C,configurable:!0}),C.displayName=c(b,l,"GeneratorFunction"),e.isGeneratorFunction=function(T){var R=typeof T=="function"&&T.constructor;return!!R&&(R===C||(R.displayName||R.name)==="GeneratorFunction")},e.mark=function(T){return Object.setPrototypeOf?Object.setPrototypeOf(T,b):(T.__proto__=b,c(T,l,"GeneratorFunction")),T.prototype=Object.create(P),T},e.awrap=function(T){return{__await:T}},L(B.prototype),c(B.prototype,a,function(){return this}),e.AsyncIterator=B,e.async=function(T,R,_,z,G){G===void 0&&(G=Promise);var U=new B(d(T,R,_,z),G);return e.isGeneratorFunction(R)?U:U.next().then(function(N){return N.done?N.value:U.next()})},L(P),c(P,l,"Generator"),c(P,s,function(){return this}),c(P,"toString",function(){return"[object Generator]"}),e.keys=function(T){var R=Object(T),_=[];for(var z in R)_.push(z);return _.reverse(),function G(){for(;_.length;){var U=_.pop();if(U in R)return G.value=U,G.done=!1,G}return G.done=!0,G}},e.values=be,Se.prototype={constructor:Se,reset:function(R){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(he),!R)for(var _ in this)_.charAt(0)==="t"&&n.call(this,_)&&!isNaN(+_.slice(1))&&(this[_]=t)},stop:function(){this.done=!0;var R=this.tryEntries[0].completion;if(R.type==="throw")throw R.arg;return this.rval},dispatchException:function(R){if(this.done)throw R;var _=this;function z($,me){return N.type="throw",N.arg=R,_.next=$,me&&(_.method="next",_.arg=t),!!me}for(var G=this.tryEntries.length-1;G>=0;--G){var U=this.tryEntries[G],N=U.completion;if(U.tryLoc==="root")return z("end");if(U.tryLoc<=this.prev){var I=n.call(U,"catchLoc"),V=n.call(U,"finallyLoc");if(I&&V){if(this.prev<U.catchLoc)return z(U.catchLoc,!0);if(this.prev<U.finallyLoc)return z(U.finallyLoc)}else if(I){if(this.prev<U.catchLoc)return z(U.catchLoc,!0)}else{if(!V)throw Error("try statement without catch or finally");if(this.prev<U.finallyLoc)return z(U.finallyLoc)}}}},abrupt:function(R,_){for(var z=this.tryEntries.length-1;z>=0;--z){var G=this.tryEntries[z];if(G.tryLoc<=this.prev&&n.call(G,"finallyLoc")&&this.prev<G.finallyLoc){var U=G;break}}U&&(R==="break"||R==="continue")&&U.tryLoc<=_&&_<=U.finallyLoc&&(U=null);var N=U?U.completion:{};return N.type=R,N.arg=_,U?(this.method="next",this.next=U.finallyLoc,m):this.complete(N)},complete:function(R,_){if(R.type==="throw")throw R.arg;return R.type==="break"||R.type==="continue"?this.next=R.arg:R.type==="return"?(this.rval=this.arg=R.arg,this.method="return",this.next="end"):R.type==="normal"&&_&&(this.next=_),m},finish:function(R){for(var _=this.tryEntries.length-1;_>=0;--_){var z=this.tryEntries[_];if(z.finallyLoc===R)return this.complete(z.completion,z.afterLoc),he(z),m}},catch:function(R){for(var _=this.tryEntries.length-1;_>=0;--_){var z=this.tryEntries[_];if(z.tryLoc===R){var G=z.completion;if(G.type==="throw"){var U=G.arg;he(z)}return U}}throw Error("illegal catch attempt")},delegateYield:function(R,_,z){return this.delegate={iterator:be(R),resultName:_,nextLoc:z},this.method==="next"&&(this.arg=t),m}},e}function xk(t,e,i,n,r,o,s){try{var a=t[o](s),l=a.value}catch(c){i(c);return}a.done?e(l):Promise.resolve(l).then(n,r)}function uH(t){return function(){var e=this,i=arguments;return new Promise(function(n,r){var o=t.apply(e,i);function s(l){xk(o,n,r,s,a,"next",l)}function a(l){xk(o,n,r,s,a,"throw",l)}s(void 0)})}}function hH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ek(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,fH(n.key),n)}}function pH(t,e,i){return e&&Ek(t.prototype,e),i&&Ek(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function fH(t){var e=gH(t,"string");return Xs(e)=="symbol"?e:e+""}function gH(t,e){if(Xs(t)!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var n=i.call(t,e||"default");if(Xs(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Pk=(function(){function t(){hH(this,t)}return pH(t,[{key:"openFile",value:(function(){var e=uH(Aw().mark(function n(r,o){var s;return Aw().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!(uf()&&r&&typeof r.uri<"u")){l.next=11;break}return l.prev=1,l.next=4,Dw(r.uri);case 4:return s=l.sent,l.abrupt("return",new Iw(s));case 8:throw l.prev=8,l.t0=l.catch(1),new Error("tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. ".concat(l.t0));case 11:if(!(typeof r.slice=="function"&&typeof r.size<"u")){l.next=13;break}return l.abrupt("return",Promise.resolve(new Iw(r)));case 13:if(typeof r.read!="function"){l.next=18;break}if(o=Number(o),Number.isFinite(o)){l.next=17;break}return l.abrupt("return",Promise.reject(new Error("cannot create source for stream without a finite value for the `chunkSize` option")));case 17:return l.abrupt("return",Promise.resolve(new Sk(r,o)));case 18:return l.abrupt("return",Promise.reject(new Error("source object may only be an instance of File, Blob, or Reader in this environment")));case 19:case"end":return l.stop()}},n,null,[[1,8]])}));function i(n,r){return e.apply(this,arguments)}return i})()}])})();function Ow(t,e){return uf()?Promise.resolve(mH(t,e)):Promise.resolve(["tus-br",t.name,t.type,t.size,t.lastModified,e.endpoint].join("-"))}function mH(t,e){var i=t.exif?vH(JSON.stringify(t.exif)):"noexif";return["tus-rn",t.name||"noname",t.size||"nosize",i,e.endpoint].join("/")}function vH(t){var e=0;if(t.length===0)return e;for(var i=0;i<t.length;i++){var n=t.charCodeAt(i);e=(e<<5)-e+n,e&=e}return e}function iu(t){"@babel/helpers - typeof";return iu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iu(t)}function Lw(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Rk(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,CH(n.key),n)}}function Nw(t,e,i){return e&&Rk(t.prototype,e),i&&Rk(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function CH(t){var e=wH(t,"string");return iu(e)=="symbol"?e:e+""}function wH(t,e){if(iu(t)!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var n=i.call(t,e||"default");if(iu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var _k=(function(){function t(){Lw(this,t)}return Nw(t,[{key:"createRequest",value:function(i,n){return new bH(i,n)}},{key:"getName",value:function(){return"XHRHttpStack"}}])})();var bH=(function(){function t(e,i){Lw(this,t),this._xhr=new XMLHttpRequest,this._xhr.open(e,i,!0),this._method=e,this._url=i,this._headers={}}return Nw(t,[{key:"getMethod",value:function(){return this._method}},{key:"getURL",value:function(){return this._url}},{key:"setHeader",value:function(i,n){this._xhr.setRequestHeader(i,n),this._headers[i]=n}},{key:"getHeader",value:function(i){return this._headers[i]}},{key:"setProgressHandler",value:function(i){"upload"in this._xhr&&(this._xhr.upload.onprogress=function(n){n.lengthComputable&&i(n.loaded)})}},{key:"send",value:function(){var i=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return new Promise(function(r,o){i._xhr.onload=function(){r(new yH(i._xhr))},i._xhr.onerror=function(s){o(s)},i._xhr.send(n)})}},{key:"abort",value:function(){return this._xhr.abort(),Promise.resolve()}},{key:"getUnderlyingObject",value:function(){return this._xhr}}])})(),yH=(function(){function t(e){Lw(this,t),this._xhr=e}return Nw(t,[{key:"getStatus",value:function(){return this._xhr.status}},{key:"getHeader",value:function(i){return this._xhr.getResponseHeader(i)}},{key:"getBody",value:function(){return this._xhr.responseText}},{key:"getUnderlyingObject",value:function(){return this._xhr}}])})();function nu(t){"@babel/helpers - typeof";return nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nu(t)}function SH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kk(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,EH(n.key),n)}}function xH(t,e,i){return e&&kk(t.prototype,e),i&&kk(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function EH(t){var e=PH(t,"string");return nu(e)=="symbol"?e:e+""}function PH(t,e){if(nu(t)!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var n=i.call(t,e||"default");if(nu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Hw=!1;try{Hw="localStorage"in window,hf="tusSupport",Bw=localStorage.getItem(hf),localStorage.setItem(hf,Bw),Bw===null&&localStorage.removeItem(hf)}catch(t){if(t.code===t.SECURITY_ERR||t.code===t.QUOTA_EXCEEDED_ERR)Hw=!1;else throw t}var hf,Bw,Fk=Hw,Tk=(function(){function t(){SH(this,t)}return xH(t,[{key:"findAllUploads",value:function(){var i=this._findEntries("tus::");return Promise.resolve(i)}},{key:"findUploadsByFingerprint",value:function(i){var n=this._findEntries("tus::".concat(i,"::"));return Promise.resolve(n)}},{key:"removeUpload",value:function(i){return localStorage.removeItem(i),Promise.resolve()}},{key:"addUpload",value:function(i,n){var r=Math.round(Math.random()*1e12),o="tus::".concat(i,"::").concat(r);return localStorage.setItem(o,JSON.stringify(n)),Promise.resolve(o)}},{key:"_findEntries",value:function(i){for(var n=[],r=0;r<localStorage.length;r++){var o=localStorage.key(r);if(o.indexOf(i)===0)try{var s=JSON.parse(localStorage.getItem(o));s.urlStorageKey=o,n.push(s)}catch{}}return n}}])})();function Rl(t){"@babel/helpers - typeof";return Rl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rl(t)}function RH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Dk(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ak(n.key),n)}}function _H(t,e,i){return e&&Dk(t.prototype,e),i&&Dk(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function kH(t,e,i){return e=pf(e),FH(t,Ik()?Reflect.construct(e,i||[],pf(t).constructor):e.apply(t,i))}function FH(t,e){if(e&&(Rl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return TH(t)}function TH(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ik(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ik=function(){return!!t})()}function pf(t){return pf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},pf(t)}function DH(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zw(t,e)}function zw(t,e){return zw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},zw(t,e)}function Mk(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),i.push.apply(i,n)}return i}function Pl(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?Mk(Object(i),!0).forEach(function(n){MH(t,n,i[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Mk(Object(i)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))})}return t}function MH(t,e,i){return e=Ak(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Ak(t){var e=IH(t,"string");return Rl(e)=="symbol"?e:e+""}function IH(t,e){if(Rl(t)!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var n=i.call(t,e||"default");if(Rl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ff=Pl(Pl({},df.defaultOptions),{},{httpStack:new _k,fileReader:new Pk,urlStorage:Fk?new Tk:new E_,fingerprint:Ow}),Ok=(function(t){function e(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return RH(this,e),n=Pl(Pl({},ff),n),kH(this,e,[i,n])}return DH(e,t),_H(e,null,[{key:"terminate",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return r=Pl(Pl({},ff),r),df.terminate(n,r)}}])})(df),Tye=typeof XMLHttpRequest=="function"&&typeof Blob=="function"&&typeof Blob.prototype.slice=="function";var Nk={name:"@uppy/tus",description:"Resumable uploads for Uppy using Tus.io",version:"5.0.1",license:"MIT",type:"module",sideEffects:!1,scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","uppy","uppy-plugin","upload","resumable","tus"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],exports:{".":"./lib/index.js","./package.json":"./package.json"},dependencies:{"@uppy/companion-client":"^5.0.1","@uppy/utils":"^7.0.2","tus-js-client":"^4.2.3"},devDependencies:{"@uppy/core":"^5.0.2",jsdom:"^26.1.0",typescript:"^5.8.3",vitest:"^3.2.4"},peerDependencies:{"@uppy/core":"^5.0.2"}};function OH(){return typeof window<"u"&&(typeof window.PhoneGap<"u"||typeof window.Cordova<"u"||typeof window.cordova<"u")}function LH(){return typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative"}function Vw(t){return(e,i)=>{if(OH()||LH())return ff.fingerprint(e,i);let n=["tus",t.id,i.endpoint].join("-");return Promise.resolve(n)}}var Bk={endpoint:"",uploadUrl:null,metadata:{},uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,overridePatchMethod:!1,headers:{},addRequestId:!1,chunkSize:1/0,retryDelays:[100,1e3,3e3,5e3],parallelUploads:1,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1},NH={limit:20,retryDelays:Bk.retryDelays,withCredentials:!1,allowedMetaFields:!0},gf=class extends Zr{static VERSION=Nk.version;#e;requests;uploaders;uploaderEvents;constructor(e,i){if(super(e,w(w({},NH),i)),this.type="uploader",this.id=this.opts.id||"Tus",i?.allowedMetaFields===void 0&&"metaFields"in this.opts)throw new Error("The `metaFields` option has been renamed to `allowedMetaFields`.");if("autoRetry"in i)throw new Error("The `autoRetry` option was deprecated and has been removed.");this.requests=this.opts.rateLimitedQueue??new Vs(this.opts.limit),this.#e=this.opts.retryDelays?.values(),this.uploaders=Object.create(null),this.uploaderEvents=Object.create(null)}resetUploaderReferences(e,i){let n=this.uploaders[e];n&&(n.abort(),i?.abort&&n.abort(!0),this.uploaders[e]=null),this.uploaderEvents[e]&&(this.uploaderEvents[e].remove(),this.uploaderEvents[e]=null)}#t(e){return this.resetUploaderReferences(e.id),new Promise((i,n)=>{let r,o,s,a=w(w({},this.opts),e.tus||{});typeof a.headers=="function"&&(a.headers=a.headers(e));let v=a,{onShouldRetry:l,onBeforeRequest:c}=v,d=Vt(v,["onShouldRetry","onBeforeRequest"]),u=w(w({},Bk),d);u.fingerprint=Vw(e),u.onBeforeRequest=async C=>{let b=C.getUnderlyingObject();b.withCredentials=!!a.withCredentials;let S;if(typeof c=="function"&&(S=c(C,e)),al(r,"shouldBeRequeued")){if(!r.shouldBeRequeued)return Promise.reject();let x,E=new Promise(P=>{x=P});r=this.requests.run(()=>(e.isPaused&&r.abort(),x(),()=>{})),await Promise.all([E,S]);return}return S},u.onError=C=>{this.uppy.log(C);let b=C.originalRequest!=null?C.originalRequest.getUnderlyingObject():null;Zv(b)&&(C=new Wv(C,b)),this.resetUploaderReferences(e.id),r?.abort(),typeof a.onError=="function"&&a.onError(C),n(C)},u.onProgress=(C,b)=>{this.onReceiveUploadUrl(e,s.url),typeof a.onProgress=="function"&&a.onProgress(C,b);let S=this.uppy.getFile(e.id);this.uppy.emit("upload-progress",S,{uploadStarted:S.progress.uploadStarted??0,bytesUploaded:C,bytesTotal:b})},u.onSuccess=C=>{let b={uploadURL:s.url??void 0,status:200,body:{xhr:C.lastResponse.getUnderlyingObject()}};if(this.uppy.emit("upload-success",this.uppy.getFile(e.id),b),this.resetUploaderReferences(e.id),r.done(),s.url){let{name:S}=s.file;this.uppy.log(`Download ${S} from ${s.url}`)}typeof a.onSuccess=="function"&&a.onSuccess(C),i(s)};let h=C=>{let b=C?.originalResponse?.getStatus();if(b===429){if(!this.requests.isPaused){let S=this.#e?.next();if(S==null||S.done)return!1;this.requests.rateLimit(S.value)}}else{if(b!=null&&b>=400&&b<500&&b!==409&&b!==423)return!1;typeof navigator<"u"&&navigator.onLine===!1&&(this.requests.isPaused||(this.requests.pause(),window.addEventListener("online",()=>{this.requests.resume()},{once:!0})))}return r.abort(),r={shouldBeRequeued:!0,abort(){this.shouldBeRequeued=!1},done(){throw new Error("Cannot mark a queued request as done: this indicates a bug")},fn(){throw new Error("Cannot run a queued request: this indicates a bug")}},!0};l!=null?u.onShouldRetry=(C,b)=>l(C,b,a,h):u.onShouldRetry=h;let p=(C,b,S)=>{al(C,b)&&!al(C,S)&&(C[S]=C[b])},f={};yp(a.allowedMetaFields,e.meta).forEach(C=>{f[C]=String(e.meta[C])}),p(f,"type","filetype"),p(f,"name","filename"),u.metadata=f,s=new Ok(e.data,u),this.uploaders[e.id]=s;let m=new Ed(this.uppy);this.uploaderEvents[e.id]=m,o=()=>(e.isPaused||s.start(),()=>{}),s.findPreviousUploads().then(C=>{let b=C[0];b&&(this.uppy.log(`[Tus] Resuming upload of ${e.id} started at ${b.creationTime}`),s.resumeFromPreviousUpload(b)),r=this.requests.run(o)}),m.onFileRemove(e.id,C=>{r.abort(),this.resetUploaderReferences(e.id,{abort:!!s.url}),i(`upload ${C} was removed`)}),m.onPause(e.id,C=>{r.abort(),C?s.abort():r=this.requests.run(o)}),m.onPauseAll(e.id,()=>{r.abort(),s.abort()}),m.onCancelAll(e.id,()=>{r.abort(),this.resetUploaderReferences(e.id,{abort:!!s.url}),i(`upload ${e.id} was canceled`)}),m.onResumeAll(e.id,()=>{r.abort(),e.error&&s.abort(),r=this.requests.run(o)})}).catch(i=>{throw this.uppy.emit("upload-error",e,i),i})}onReceiveUploadUrl(e,i){let n=this.uppy.getFile(e.id);n&&(!n.tus||n.tus.uploadUrl!==i)&&(this.uppy.log("[Tus] Storing upload url"),this.uppy.setFileState(n.id,{tus:k(w({},n.tus),{uploadUrl:i})}))}#i(e){let i=w({},this.opts);return e.tus&&Object.assign(i,e.tus),typeof i.headers=="function"&&(i.headers=i.headers(e)),k(w({},e.remote?.body),{endpoint:i.endpoint,uploadUrl:i.uploadUrl,protocol:"tus",size:e.data.size,headers:i.headers,metadata:e.meta})}async#n(e){let i=Uv(e),n=jv(i);this.uppy.emit("upload-start",n),await Promise.allSettled(i.map(r=>{if(r.isRemote){let o=()=>this.requests,s=new AbortController,a=c=>{c.id===r.id&&s.abort()};this.uppy.on("file-removed",a);let l=this.uppy.getRequestClientForFile(r).uploadRemoteFile(r,this.#i(r),{signal:s.signal,getQueue:o});return this.requests.wrapSyncFunction(()=>{this.uppy.off("file-removed",a)},{priority:-1})(),l}return this.#t(r)}))}#r=async e=>{if(e.length===0){this.uppy.log("[Tus] No files to upload");return}this.opts.limit===0&&this.uppy.log("[Tus] When uploading multiple files at once, consider setting the `limit` option (to `10` for example), to limit the number of concurrent uploads, which helps prevent memory and network issues: https://uppy.io/docs/tus/#limit-0","warning"),this.uppy.log("[Tus] Uploading...");let i=this.uppy.getFilesByIds(e);await this.#n(i)};install(){this.uppy.setState({capabilities:k(w({},this.uppy.getState().capabilities),{resumableUploads:!0})}),this.uppy.addUploader(this.#r)}uninstall(){this.uppy.setState({capabilities:k(w({},this.uppy.getState().capabilities),{resumableUploads:!1})}),this.uppy.removeUploader(this.#r)}};var Kye=(()=>{class t{uploadEndpoint=Re("");maxFileSize=Re(10*1024*1024);allowedFileTypes=Re(["image/*","application/pdf",".doc",".docx"]);maxNumberOfFiles=Re(10);note=Re("");uploadComplete=ue();uploadError=ue();filesAdded=ue();uppy=null;ngOnInit(){this.initializeUppy()}ngOnDestroy(){this.uppy?.destroy()}initializeUppy(){this.uppy=new Ap({id:"file-uploader",autoProceed:!1,allowMultipleUploadBatches:!0,restrictions:{maxFileSize:this.maxFileSize(),maxNumberOfFiles:this.maxNumberOfFiles(),allowedFileTypes:this.allowedFileTypes()}}).use(Kd,{inline:!0,target:"#uppy-dashboard",height:400,width:"100%",theme:"auto",proudlyDisplayPoweredByUppy:!1,hideProgressDetails:!1,hideUploadButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideCancelButton:!1,showRemoveButtonAfterComplete:!0,note:this.note()||"Images up to 10MB, PDFs and documents allowed"}).use(Op,{quality:.8,limit:10}),this.uploadEndpoint()&&this.uppy.use(gf,{endpoint:this.uploadEndpoint(),retryDelays:[0,1e3,3e3,5e3],chunkSize:5*1024*1024}),this.uppy.on("file-added",()=>{this.filesAdded.emit(this.uppy?.getFiles().length??0)}),this.uppy.on("complete",i=>{let n=[];i.successful&&(n=i.successful.map(r=>({id:r.id,name:r.name,size:r.size,type:r.type??"unknown",url:r.response?.uploadURL}))),this.uploadComplete.emit(n)}),this.uppy.on("error",i=>{this.uploadError.emit(i)}),this.uppy.on("upload-error",(i,n)=>{console.error("Upload error for file:",i?.name,n),this.uploadError.emit(n)})}clearFiles(){this.uppy?.cancelAll()}getFiles(){return this.uppy?.getFiles()??[]}upload(){this.uppy?.upload()}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=Ie({type:t,selectors:[["gh-file-upload"]],inputs:{uploadEndpoint:[1,"uploadEndpoint"],maxFileSize:[1,"maxFileSize"],allowedFileTypes:[1,"allowedFileTypes"],maxNumberOfFiles:[1,"maxNumberOfFiles"],note:[1,"note"]},outputs:{uploadComplete:"uploadComplete",uploadError:"uploadError",filesAdded:"filesAdded"},decls:1,vars:0,consts:[["id","uppy-dashboard"]],template:function(n,r){n&1&&dp(0,"div",0)},styles:["[_nghost-%COMP%]{display:block;width:100%}#uppy-dashboard[_ngcontent-%COMP%]{border-radius:.5rem;overflow:hidden}[_nghost-%COMP%]     .uppy-Dashboard-inner{background-color:hsl(var(--background));border:1px solid hsl(var(--border));border-radius:.5rem}[_nghost-%COMP%]     .uppy-Dashboard-AddFiles{border-color:hsl(var(--border))}[_nghost-%COMP%]     .uppy-Dashboard-AddFiles-title{color:hsl(var(--foreground))}[_nghost-%COMP%]     .uppy-Dashboard-note{color:hsl(var(--muted-foreground))}[_nghost-%COMP%]     .uppy-DashboardContent-bar{background-color:hsl(var(--muted));border-bottom:1px solid hsl(var(--border))}[_nghost-%COMP%]     .uppy-DashboardContent-title{color:hsl(var(--foreground))}[_nghost-%COMP%]     .uppy-DashboardItem{border-bottom:1px solid hsl(var(--border))}[_nghost-%COMP%]     .uppy-DashboardItem-name{color:hsl(var(--foreground))}[_nghost-%COMP%]     .uppy-DashboardItem-status{color:hsl(var(--muted-foreground))}[_nghost-%COMP%]     .uppy-StatusBar{background-color:hsl(var(--muted));border-top:1px solid hsl(var(--border))}[_nghost-%COMP%]     .uppy-StatusBar-actionBtn--upload{background-color:hsl(var(--primary));color:hsl(var(--primary-foreground))}[_nghost-%COMP%]     .uppy-StatusBar-actionBtn--upload:hover{background-color:hsl(var(--primary) / .9)}[_nghost-%COMP%]     .uppy-StatusBar-progress{background-color:hsl(var(--primary))}@media (prefers-color-scheme: dark){[_nghost-%COMP%]     .uppy-Dashboard-AddFiles{background-color:hsl(var(--background))}[_nghost-%COMP%]     .uppy-Dashboard-dropFilesHereHint{color:hsl(var(--muted-foreground))}}"],changeDetection:0})}return t})();function Si(t){this.content=t}Si.prototype={constructor:Si,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,i){var n=i&&i!=t?this.remove(i):this,r=n.find(t),o=n.content.slice();return r==-1?o.push(i||t,e):(o[r+1]=e,i&&(o[r]=i)),new Si(o)},remove:function(t){var e=this.find(t);if(e==-1)return this;var i=this.content.slice();return i.splice(e,2),new Si(i)},addToStart:function(t,e){return new Si([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var i=this.remove(t).content.slice();return i.push(t,e),new Si(i)},addBefore:function(t,e,i){var n=this.remove(e),r=n.content.slice(),o=n.find(t);return r.splice(o==-1?r.length:o,0,e,i),new Si(r)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=Si.from(t),t.size?new Si(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=Si.from(t),t.size?new Si(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=Si.from(t);for(var i=0;i<t.content.length;i+=2)e=e.remove(t.content[i]);return e},toObject:function(){var t={};return this.forEach(function(e,i){t[e]=i}),t},get size(){return this.content.length>>1}};Si.from=function(t){if(t instanceof Si)return t;var e=[];if(t)for(var i in t)e.push(i,t[i]);return new Si(e)};var Gw=Si;function Kk(t,e,i){for(let n=0;;n++){if(n==t.childCount||n==e.childCount)return t.childCount==e.childCount?null:i;let r=t.child(n),o=e.child(n);if(r==o){i+=r.nodeSize;continue}if(!r.sameMarkup(o))return i;if(r.isText&&r.text!=o.text){for(let s=0;r.text[s]==o.text[s];s++)i++;return i}if(r.content.size||o.content.size){let s=Kk(r.content,o.content,i+1);if(s!=null)return s}i+=r.nodeSize}}function Yk(t,e,i,n){for(let r=t.childCount,o=e.childCount;;){if(r==0||o==0)return r==o?null:{a:i,b:n};let s=t.child(--r),a=e.child(--o),l=s.nodeSize;if(s==a){i-=l,n-=l;continue}if(!s.sameMarkup(a))return{a:i,b:n};if(s.isText&&s.text!=a.text){let c=0,d=Math.min(s.text.length,a.text.length);for(;c<d&&s.text[s.text.length-c-1]==a.text[a.text.length-c-1];)c++,i--,n--;return{a:i,b:n}}if(s.content.size||a.content.size){let c=Yk(s.content,a.content,i-1,n-1);if(c)return c}i-=l,n-=l}}var J=class t{constructor(e,i){if(this.content=e,this.size=i||0,i==null)for(let n=0;n<e.length;n++)this.size+=e[n].nodeSize}nodesBetween(e,i,n,r=0,o){for(let s=0,a=0;a<i;s++){let l=this.content[s],c=a+l.nodeSize;if(c>e&&n(l,r+a,o||null,s)!==!1&&l.content.size){let d=a+1;l.nodesBetween(Math.max(0,e-d),Math.min(l.content.size,i-d),n,r+d)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,i,n,r){let o="",s=!0;return this.nodesBetween(e,i,(a,l)=>{let c=a.isText?a.text.slice(Math.max(e,l)-l,i-l):a.isLeaf?r?typeof r=="function"?r(a):r:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&n&&(s?s=!1:o+=n),o+=c},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let i=this.lastChild,n=e.firstChild,r=this.content.slice(),o=0;for(i.isText&&i.sameMarkup(n)&&(r[r.length-1]=i.withText(i.text+n.text),o=1);o<e.content.length;o++)r.push(e.content[o]);return new t(r,this.size+e.size)}cut(e,i=this.size){if(e==0&&i==this.size)return this;let n=[],r=0;if(i>e)for(let o=0,s=0;s<i;o++){let a=this.content[o],l=s+a.nodeSize;l>e&&((s<e||l>i)&&(a.isText?a=a.cut(Math.max(0,e-s),Math.min(a.text.length,i-s)):a=a.cut(Math.max(0,e-s-1),Math.min(a.content.size,i-s-1))),n.push(a),r+=a.nodeSize),s=l}return new t(n,r)}cutByIndex(e,i){return e==i?t.empty:e==0&&i==this.content.length?this:new t(this.content.slice(e,i))}replaceChild(e,i){let n=this.content[e];if(n==i)return this;let r=this.content.slice(),o=this.size+i.nodeSize-n.nodeSize;return r[e]=i,new t(r,o)}addToStart(e){return new t([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new t(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let i=0;i<this.content.length;i++)if(!this.content[i].eq(e.content[i]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let i=this.content[e];if(!i)throw new RangeError("Index "+e+" out of range for "+this);return i}maybeChild(e){return this.content[e]||null}forEach(e){for(let i=0,n=0;i<this.content.length;i++){let r=this.content[i];e(r,n,i),n+=r.nodeSize}}findDiffStart(e,i=0){return Kk(this,e,i)}findDiffEnd(e,i=this.size,n=e.size){return Yk(this,e,i,n)}findIndex(e){if(e==0)return mf(0,e);if(e==this.size)return mf(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let i=0,n=0;;i++){let r=this.child(i),o=n+r.nodeSize;if(o>=e)return o==e?mf(i+1,o):mf(i,n);n=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,i){if(!i)return t.empty;if(!Array.isArray(i))throw new RangeError("Invalid input for Fragment.fromJSON");return new t(i.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return t.empty;let i,n=0;for(let r=0;r<e.length;r++){let o=e[r];n+=o.nodeSize,r&&o.isText&&e[r-1].sameMarkup(o)?(i||(i=e.slice(0,r)),i[i.length-1]=o.withText(i[i.length-1].text+o.text)):i&&i.push(o)}return new t(i||e,n)}static from(e){if(!e)return t.empty;if(e instanceof t)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new t([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}};J.empty=new J([],0);var Ww={index:0,offset:0};function mf(t,e){return Ww.index=t,Ww.offset=e,Ww}function Cf(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let i=Array.isArray(t);if(Array.isArray(e)!=i)return!1;if(i){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!Cf(t[n],e[n]))return!1}else{for(let n in t)if(!(n in e)||!Cf(t[n],e[n]))return!1;for(let n in e)if(!(n in t))return!1}return!0}var ct=(()=>{class t{constructor(i,n){this.type=i,this.attrs=n}addToSet(i){let n,r=!1;for(let o=0;o<i.length;o++){let s=i[o];if(this.eq(s))return i;if(this.type.excludes(s.type))n||(n=i.slice(0,o));else{if(s.type.excludes(this.type))return i;!r&&s.type.rank>this.type.rank&&(n||(n=i.slice(0,o)),n.push(this),r=!0),n&&n.push(s)}}return n||(n=i.slice()),r||n.push(this),n}removeFromSet(i){for(let n=0;n<i.length;n++)if(this.eq(i[n]))return i.slice(0,n).concat(i.slice(n+1));return i}isInSet(i){for(let n=0;n<i.length;n++)if(this.eq(i[n]))return!0;return!1}eq(i){return this==i||this.type==i.type&&Cf(this.attrs,i.attrs)}toJSON(){let i={type:this.type.name};for(let n in this.attrs){i.attrs=this.attrs;break}return i}static fromJSON(i,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=i.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);let o=r.create(n.attrs);return r.checkAttrs(o.attrs),o}static sameSet(i,n){if(i==n)return!0;if(i.length!=n.length)return!1;for(let r=0;r<i.length;r++)if(!i[r].eq(n[r]))return!1;return!0}static setFrom(i){if(!i||Array.isArray(i)&&i.length==0)return t.none;if(i instanceof t)return[i];let n=i.slice();return n.sort((r,o)=>r.type.rank-o.type.rank),n}}return t.none=[],t})(),Zs=class extends Error{},pe=class t{constructor(e,i,n){this.content=e,this.openStart=i,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,i){let n=Jk(this.content,e+this.openStart,i);return n&&new t(n,this.openStart,this.openEnd)}removeBetween(e,i){return new t(Xk(this.content,e+this.openStart,i+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,i){if(!i)return t.empty;let n=i.openStart||0,r=i.openEnd||0;if(typeof n!="number"||typeof r!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new t(J.fromJSON(e,i.content),n,r)}static maxOpen(e,i=!0){let n=0,r=0;for(let o=e.firstChild;o&&!o.isLeaf&&(i||!o.type.spec.isolating);o=o.firstChild)n++;for(let o=e.lastChild;o&&!o.isLeaf&&(i||!o.type.spec.isolating);o=o.lastChild)r++;return new t(e,n,r)}};pe.empty=new pe(J.empty,0,0);function Xk(t,e,i){let{index:n,offset:r}=t.findIndex(e),o=t.maybeChild(n),{index:s,offset:a}=t.findIndex(i);if(r==e||o.isText){if(a!=i&&!t.child(s).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(i))}if(n!=s)throw new RangeError("Removing non-flat range");return t.replaceChild(n,o.copy(Xk(o.content,e-r-1,i-r-1)))}function Jk(t,e,i,n){let{index:r,offset:o}=t.findIndex(e),s=t.maybeChild(r);if(o==e||s.isText)return n&&!n.canReplace(r,r,i)?null:t.cut(0,e).append(i).append(t.cut(e));let a=Jk(s.content,e-o-1,i,s);return a&&t.replaceChild(r,s.copy(a))}function BH(t,e,i){if(i.openStart>t.depth)throw new Zs("Inserted content deeper than insertion position");if(t.depth-i.openStart!=e.depth-i.openEnd)throw new Zs("Inconsistent open depths");return Qk(t,e,i,0)}function Qk(t,e,i,n){let r=t.index(n),o=t.node(n);if(r==e.index(n)&&n<t.depth-i.openStart){let s=Qk(t,e,i,n+1);return o.copy(o.content.replaceChild(r,s))}else if(i.content.size)if(!i.openStart&&!i.openEnd&&t.depth==n&&e.depth==n){let s=t.parent,a=s.content;return Qs(s,a.cut(0,t.parentOffset).append(i.content).append(a.cut(e.parentOffset)))}else{let{start:s,end:a}=HH(i,t);return Qs(o,eF(t,s,a,e,n))}else return Qs(o,wf(t,e,n))}function Zk(t,e){if(!e.type.compatibleContent(t.type))throw new Zs("Cannot join "+e.type.name+" onto "+t.type.name)}function jw(t,e,i){let n=t.node(i);return Zk(n,e.node(i)),n}function Js(t,e){let i=e.length-1;i>=0&&t.isText&&t.sameMarkup(e[i])?e[i]=t.withText(e[i].text+t.text):e.push(t)}function ru(t,e,i,n){let r=(e||t).node(i),o=0,s=e?e.index(i):r.childCount;t&&(o=t.index(i),t.depth>i?o++:t.textOffset&&(Js(t.nodeAfter,n),o++));for(let a=o;a<s;a++)Js(r.child(a),n);e&&e.depth==i&&e.textOffset&&Js(e.nodeBefore,n)}function Qs(t,e){return t.type.checkContent(e),t.copy(e)}function eF(t,e,i,n,r){let o=t.depth>r&&jw(t,e,r+1),s=n.depth>r&&jw(i,n,r+1),a=[];return ru(null,t,r,a),o&&s&&e.index(r)==i.index(r)?(Zk(o,s),Js(Qs(o,eF(t,e,i,n,r+1)),a)):(o&&Js(Qs(o,wf(t,e,r+1)),a),ru(e,i,r,a),s&&Js(Qs(s,wf(i,n,r+1)),a)),ru(n,null,r,a),new J(a)}function wf(t,e,i){let n=[];if(ru(null,t,i,n),t.depth>i){let r=jw(t,e,i+1);Js(Qs(r,wf(t,e,i+1)),n)}return ru(e,null,i,n),new J(n)}function HH(t,e){let i=e.depth-t.openStart,r=e.node(i).copy(t.content);for(let o=i-1;o>=0;o--)r=e.node(o).copy(J.from(r));return{start:r.resolveNoCache(t.openStart+i),end:r.resolveNoCache(r.content.size-t.openEnd-i)}}var bf=class t{constructor(e,i,n){this.pos=e,this.path=i,this.parentOffset=n,this.depth=i.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,i=this.index(this.depth);if(i==e.childCount)return null;let n=this.pos-this.path[this.path.length-1],r=e.child(i);return n?e.child(i).cut(n):r}get nodeBefore(){let e=this.index(this.depth),i=this.pos-this.path[this.path.length-1];return i?this.parent.child(e).cut(0,i):e==0?null:this.parent.child(e-1)}posAtIndex(e,i){i=this.resolveDepth(i);let n=this.path[i*3],r=i==0?0:this.path[i*3-1]+1;for(let o=0;o<e;o++)r+=n.child(o).nodeSize;return r}marks(){let e=this.parent,i=this.index();if(e.content.size==0)return ct.none;if(this.textOffset)return e.child(i).marks;let n=e.maybeChild(i-1),r=e.maybeChild(i);if(!n){let a=n;n=r,r=a}let o=n.marks;for(var s=0;s<o.length;s++)o[s].type.spec.inclusive===!1&&(!r||!o[s].isInSet(r.marks))&&(o=o[s--].removeFromSet(o));return o}marksAcross(e){let i=this.parent.maybeChild(this.index());if(!i||!i.isInline)return null;let n=i.marks,r=e.parent.maybeChild(e.index());for(var o=0;o<n.length;o++)n[o].type.spec.inclusive===!1&&(!r||!n[o].isInSet(r.marks))&&(n=n[o--].removeFromSet(n));return n}sharedDepth(e){for(let i=this.depth;i>0;i--)if(this.start(i)<=e&&this.end(i)>=e)return i;return 0}blockRange(e=this,i){if(e.pos<this.pos)return e.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!i||i(this.node(n))))return new ea(this,e,n);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let i=1;i<=this.depth;i++)e+=(e?"/":"")+this.node(i).type.name+"_"+this.index(i-1);return e+":"+this.parentOffset}static resolve(e,i){if(!(i>=0&&i<=e.content.size))throw new RangeError("Position "+i+" out of range");let n=[],r=0,o=i;for(let s=e;;){let{index:a,offset:l}=s.content.findIndex(o),c=o-l;if(n.push(s,a,r+l),!c||(s=s.child(a),s.isText))break;o=c-1,r+=l+1}return new t(i,n,o)}static resolveCached(e,i){let n=Hk.get(e);if(n)for(let o=0;o<n.elts.length;o++){let s=n.elts[o];if(s.pos==i)return s}else Hk.set(e,n=new qw);let r=n.elts[n.i]=t.resolve(e,i);return n.i=(n.i+1)%zH,r}},qw=class{constructor(){this.elts=[],this.i=0}},zH=12,Hk=new WeakMap,ea=class{constructor(e,i,n){this.$from=e,this.$to=i,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}},VH=Object.create(null),qi=class t{constructor(e,i,n,r=ct.none){this.type=e,this.attrs=i,this.marks=r,this.content=n||J.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,i,n,r=0){this.content.nodesBetween(e,i,n,r,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,i,n,r){return this.content.textBetween(e,i,n,r)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,i,n){return this.type==e&&Cf(this.attrs,i||e.defaultAttrs||VH)&&ct.sameSet(this.marks,n||ct.none)}copy(e=null){return e==this.content?this:new t(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new t(this.type,this.attrs,this.content,e)}cut(e,i=this.content.size){return e==0&&i==this.content.size?this:this.copy(this.content.cut(e,i))}slice(e,i=this.content.size,n=!1){if(e==i)return pe.empty;let r=this.resolve(e),o=this.resolve(i),s=n?0:r.sharedDepth(i),a=r.start(s),c=r.node(s).content.cut(r.pos-a,o.pos-a);return new pe(c,r.depth-s,o.depth-s)}replace(e,i,n){return BH(this.resolve(e),this.resolve(i),n)}nodeAt(e){for(let i=this;;){let{index:n,offset:r}=i.content.findIndex(e);if(i=i.maybeChild(n),!i)return null;if(r==e||i.isText)return i;e-=r+1}}childAfter(e){let{index:i,offset:n}=this.content.findIndex(e);return{node:this.content.maybeChild(i),index:i,offset:n}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:i,offset:n}=this.content.findIndex(e);if(n<e)return{node:this.content.child(i),index:i,offset:n};let r=this.content.child(i-1);return{node:r,index:i-1,offset:n-r.nodeSize}}resolve(e){return bf.resolveCached(this,e)}resolveNoCache(e){return bf.resolve(this,e)}rangeHasMark(e,i,n){let r=!1;return i>e&&this.nodesBetween(e,i,o=>(n.isInSet(o.marks)&&(r=!0),!r)),r}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),tF(this.marks,e)}contentMatchAt(e){let i=this.type.contentMatch.matchFragment(this.content,0,e);if(!i)throw new Error("Called contentMatchAt on a node with invalid content");return i}canReplace(e,i,n=J.empty,r=0,o=n.childCount){let s=this.contentMatchAt(e).matchFragment(n,r,o),a=s&&s.matchFragment(this.content,i);if(!a||!a.validEnd)return!1;for(let l=r;l<o;l++)if(!this.type.allowsMarks(n.child(l).marks))return!1;return!0}canReplaceWith(e,i,n,r){if(r&&!this.type.allowsMarks(r))return!1;let o=this.contentMatchAt(e).matchType(n),s=o&&o.matchFragment(this.content,i);return s?s.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=ct.none;for(let i=0;i<this.marks.length;i++){let n=this.marks[i];n.type.checkAttrs(n.attrs),e=n.addToSet(e)}if(!ct.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(i=>i.type.name)}`);this.content.forEach(i=>i.check())}toJSON(){let e={type:this.type.name};for(let i in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(i=>i.toJSON())),e}static fromJSON(e,i){if(!i)throw new RangeError("Invalid input for Node.fromJSON");let n;if(i.marks){if(!Array.isArray(i.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=i.marks.map(e.markFromJSON)}if(i.type=="text"){if(typeof i.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(i.text,n)}let r=J.fromJSON(e,i.content),o=e.nodeType(i.type).create(i.attrs,r,n);return o.type.checkAttrs(o.attrs),o}};qi.prototype.text=void 0;var $w=class t extends qi{constructor(e,i,n,r){if(super(e,i,null,r),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):tF(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,i){return this.text.slice(e,i)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new t(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new t(this.type,this.attrs,e,this.marks)}cut(e=0,i=this.text.length){return e==0&&i==this.text.length?this:this.withText(this.text.slice(e,i))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}};function tF(t,e){for(let i=t.length-1;i>=0;i--)e=t[i].type.name+"("+e+")";return e}var ta=class t{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,i){let n=new Kw(e,i);if(n.next==null)return t.empty;let r=iF(n);n.next&&n.err("Unexpected trailing text");let o=KH($H(r));return YH(o,n),o}matchType(e){for(let i=0;i<this.next.length;i++)if(this.next[i].type==e)return this.next[i].next;return null}matchFragment(e,i=0,n=e.childCount){let r=this;for(let o=i;r&&o<n;o++)r=r.matchType(e.child(o).type);return r}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:i}=this.next[e];if(!(i.isText||i.hasRequiredAttrs()))return i}return null}compatible(e){for(let i=0;i<this.next.length;i++)for(let n=0;n<e.next.length;n++)if(this.next[i].type==e.next[n].type)return!0;return!1}fillBefore(e,i=!1,n=0){let r=[this];function o(s,a){let l=s.matchFragment(e,n);if(l&&(!i||l.validEnd))return J.from(a.map(c=>c.createAndFill()));for(let c=0;c<s.next.length;c++){let{type:d,next:u}=s.next[c];if(!(d.isText||d.hasRequiredAttrs())&&r.indexOf(u)==-1){r.push(u);let h=o(u,a.concat(d));if(h)return h}}return null}return o(this,[])}findWrapping(e){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==e)return this.wrapCache[n+1];let i=this.computeWrapping(e);return this.wrapCache.push(e,i),i}computeWrapping(e){let i=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let r=n.shift(),o=r.match;if(o.matchType(e)){let s=[];for(let a=r;a.type;a=a.via)s.push(a.type);return s.reverse()}for(let s=0;s<o.next.length;s++){let{type:a,next:l}=o.next[s];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in i)&&(!r.type||l.validEnd)&&(n.push({match:a.contentMatch,type:a,via:r}),i[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function i(n){e.push(n);for(let r=0;r<n.next.length;r++)e.indexOf(n.next[r].next)==-1&&i(n.next[r].next)}return i(this),e.map((n,r)=>{let o=r+(n.validEnd?"*":" ")+" ";for(let s=0;s<n.next.length;s++)o+=(s?", ":"")+n.next[s].type.name+"->"+e.indexOf(n.next[s].next);return o}).join(`
`)}};ta.empty=new ta(!0);var Kw=class{constructor(e,i){this.string=e,this.nodeTypes=i,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}};function iF(t){let e=[];do e.push(GH(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function GH(t){let e=[];do e.push(WH(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function WH(t){let e=qH(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=UH(t,e);else break;return e}function zk(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function UH(t,e){let i=zk(t),n=i;return t.eat(",")&&(t.next!="}"?n=zk(t):n=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:i,max:n,expr:e}}function jH(t,e){let i=t.nodeTypes,n=i[e];if(n)return[n];let r=[];for(let o in i){let s=i[o];s.isInGroup(e)&&r.push(s)}return r.length==0&&t.err("No node type or group '"+e+"' found"),r}function qH(t){if(t.eat("(")){let e=iF(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=jH(t,t.next).map(i=>(t.inline==null?t.inline=i.isInline:t.inline!=i.isInline&&t.err("Mixing inline and block content"),{type:"name",value:i}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function $H(t){let e=[[]];return r(o(t,0),i()),e;function i(){return e.push([])-1}function n(s,a,l){let c={term:l,to:a};return e[s].push(c),c}function r(s,a){s.forEach(l=>l.to=a)}function o(s,a){if(s.type=="choice")return s.exprs.reduce((l,c)=>l.concat(o(c,a)),[]);if(s.type=="seq")for(let l=0;;l++){let c=o(s.exprs[l],a);if(l==s.exprs.length-1)return c;r(c,a=i())}else if(s.type=="star"){let l=i();return n(a,l),r(o(s.expr,l),l),[n(l)]}else if(s.type=="plus"){let l=i();return r(o(s.expr,a),l),r(o(s.expr,l),l),[n(l)]}else{if(s.type=="opt")return[n(a)].concat(o(s.expr,a));if(s.type=="range"){let l=a;for(let c=0;c<s.min;c++){let d=i();r(o(s.expr,l),d),l=d}if(s.max==-1)r(o(s.expr,l),l);else for(let c=s.min;c<s.max;c++){let d=i();n(l,d),r(o(s.expr,l),d),l=d}return[n(l)]}else{if(s.type=="name")return[n(a,void 0,s.value)];throw new Error("Unknown expr type")}}}}function nF(t,e){return e-t}function Vk(t,e){let i=[];return n(e),i.sort(nF);function n(r){let o=t[r];if(o.length==1&&!o[0].term)return n(o[0].to);i.push(r);for(let s=0;s<o.length;s++){let{term:a,to:l}=o[s];!a&&i.indexOf(l)==-1&&n(l)}}}function KH(t){let e=Object.create(null);return i(Vk(t,0));function i(n){let r=[];n.forEach(s=>{t[s].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let d=0;d<r.length;d++)r[d][0]==a&&(c=r[d][1]);Vk(t,l).forEach(d=>{c||r.push([a,c=[]]),c.indexOf(d)==-1&&c.push(d)})})});let o=e[n.join(",")]=new ta(n.indexOf(t.length-1)>-1);for(let s=0;s<r.length;s++){let a=r[s][1].sort(nF);o.next.push({type:r[s][0],next:e[a.join(",")]||i(a)})}return o}}function YH(t,e){for(let i=0,n=[t];i<n.length;i++){let r=n[i],o=!r.validEnd,s=[];for(let a=0;a<r.next.length;a++){let{type:l,next:c}=r.next[a];s.push(l.name),o&&!(l.isText||l.hasRequiredAttrs())&&(o=!1),n.indexOf(c)==-1&&n.push(c)}o&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function rF(t){let e=Object.create(null);for(let i in t){let n=t[i];if(!n.hasDefault)return null;e[i]=n.default}return e}function oF(t,e){let i=Object.create(null);for(let n in t){let r=e&&e[n];if(r===void 0){let o=t[n];if(o.hasDefault)r=o.default;else throw new RangeError("No value supplied for attribute "+n)}i[n]=r}return i}function sF(t,e,i,n){for(let r in e)if(!(r in t))throw new RangeError(`Unsupported attribute ${r} for ${i} of type ${r}`);for(let r in t){let o=t[r];o.validate&&o.validate(e[r])}}function aF(t,e){let i=Object.create(null);if(e)for(let n in e)i[n]=new Yw(t,n,e[n]);return i}var yf=class t{constructor(e,i,n){this.name=e,this.schema=i,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=aF(e,n.attrs),this.defaultAttrs=rF(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==ta.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:oF(this.attrs,e)}create(e=null,i,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new qi(this,this.computeAttrs(e),J.from(i),ct.setFrom(n))}createChecked(e=null,i,n){return i=J.from(i),this.checkContent(i),new qi(this,this.computeAttrs(e),i,ct.setFrom(n))}createAndFill(e=null,i,n){if(e=this.computeAttrs(e),i=J.from(i),i.size){let s=this.contentMatch.fillBefore(i);if(!s)return null;i=s.append(i)}let r=this.contentMatch.matchFragment(i),o=r&&r.fillBefore(J.empty,!0);return o?new qi(this,e,i.append(o),ct.setFrom(n)):null}validContent(e){let i=this.contentMatch.matchFragment(e);if(!i||!i.validEnd)return!1;for(let n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){sF(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let i=0;i<e.length;i++)if(!this.allowsMarkType(e[i].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let i;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?i&&i.push(e[n]):i||(i=e.slice(0,n));return i?i.length?i:ct.none:e}static compile(e,i){let n=Object.create(null);e.forEach((o,s)=>n[o]=new t(o,i,s));let r=i.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}};function XH(t,e,i){let n=i.split("|");return r=>{let o=r===null?"null":typeof r;if(n.indexOf(o)<0)throw new RangeError(`Expected value of type ${n} for attribute ${e} on type ${t}, got ${o}`)}}var Yw=class{constructor(e,i,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate=typeof n.validate=="string"?XH(e,i,n.validate):n.validate}get isRequired(){return!this.hasDefault}},su=class t{constructor(e,i,n,r){this.name=e,this.rank=i,this.schema=n,this.spec=r,this.attrs=aF(e,r.attrs),this.excluded=null;let o=rF(this.attrs);this.instance=o?new ct(this,o):null}create(e=null){return!e&&this.instance?this.instance:new ct(this,oF(this.attrs,e))}static compile(e,i){let n=Object.create(null),r=0;return e.forEach((o,s)=>n[o]=new t(o,r++,i,s)),n}removeFromSet(e){for(var i=0;i<e.length;i++)e[i].type==this&&(e=e.slice(0,i).concat(e.slice(i+1)),i--);return e}isInSet(e){for(let i=0;i<e.length;i++)if(e[i].type==this)return e[i]}checkAttrs(e){sF(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}},kl=class{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let i=this.spec={};for(let r in e)i[r]=e[r];i.nodes=Gw.from(e.nodes),i.marks=Gw.from(e.marks||{}),this.nodes=yf.compile(this.spec.nodes,this),this.marks=su.compile(this.spec.marks,this);let n=Object.create(null);for(let r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");let o=this.nodes[r],s=o.spec.content||"",a=o.spec.marks;if(o.contentMatch=n[s]||(n[s]=ta.parse(s,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!o.isInline||!o.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=o}o.markSet=a=="_"?null:a?Gk(this,a.split(" ")):a==""||!o.inlineContent?[]:null}for(let r in this.marks){let o=this.marks[r],s=o.spec.excludes;o.excluded=s==null?[o]:s==""?[]:Gk(this,s.split(" "))}this.nodeFromJSON=r=>qi.fromJSON(this,r),this.markFromJSON=r=>ct.fromJSON(this,r),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,i=null,n,r){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof yf){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(i,n,r)}text(e,i){let n=this.nodes.text;return new $w(n,n.defaultAttrs,e,ct.setFrom(i))}mark(e,i){return typeof e=="string"&&(e=this.marks[e]),e.create(i)}nodeType(e){let i=this.nodes[e];if(!i)throw new RangeError("Unknown node type: "+e);return i}};function Gk(t,e){let i=[];for(let n=0;n<e.length;n++){let r=e[n],o=t.marks[r],s=o;if(o)i.push(o);else for(let a in t.marks){let l=t.marks[a];(r=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(r)>-1)&&i.push(s=l)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[n]+"'")}return i}function JH(t){return t.tag!=null}function QH(t){return t.style!=null}var Cr=class t{constructor(e,i){this.schema=e,this.rules=i,this.tags=[],this.styles=[];let n=this.matchedStyles=[];i.forEach(r=>{if(JH(r))this.tags.push(r);else if(QH(r)){let o=/[^=]*/.exec(r.style)[0];n.indexOf(o)<0&&n.push(o),this.styles.push(r)}}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let o=e.nodes[r.node];return o.contentMatch.matchType(o)})}parse(e,i={}){let n=new Sf(this,i,!1);return n.addAll(e,ct.none,i.from,i.to),n.finish()}parseSlice(e,i={}){let n=new Sf(this,i,!0);return n.addAll(e,ct.none,i.from,i.to),pe.maxOpen(n.finish())}matchTag(e,i,n){for(let r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){let o=this.tags[r];if(tz(e,o.tag)&&(o.namespace===void 0||e.namespaceURI==o.namespace)&&(!o.context||i.matchesContext(o.context))){if(o.getAttrs){let s=o.getAttrs(e);if(s===!1)continue;o.attrs=s||void 0}return o}}}matchStyle(e,i,n,r){for(let o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){let s=this.styles[o],a=s.style;if(!(a.indexOf(e)!=0||s.context&&!n.matchesContext(s.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=i))){if(s.getAttrs){let l=s.getAttrs(i);if(l===!1)continue;s.attrs=l||void 0}return s}}}static schemaRules(e){let i=[];function n(r){let o=r.priority==null?50:r.priority,s=0;for(;s<i.length;s++){let a=i[s];if((a.priority==null?50:a.priority)<o)break}i.splice(s,0,r)}for(let r in e.marks){let o=e.marks[r].spec.parseDOM;o&&o.forEach(s=>{n(s=Uk(s)),s.mark||s.ignore||s.clearMark||(s.mark=r)})}for(let r in e.nodes){let o=e.nodes[r].spec.parseDOM;o&&o.forEach(s=>{n(s=Uk(s)),s.node||s.ignore||s.mark||(s.node=r)})}return i}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new t(e,t.schemaRules(e)))}},lF={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},ZH={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},cF={ol:!0,ul:!0},au=1,Xw=2,ou=4;function Wk(t,e,i){return e!=null?(e?au:0)|(e==="full"?Xw:0):t&&t.whitespace=="pre"?au|Xw:i&~ou}var _l=class{constructor(e,i,n,r,o,s){this.type=e,this.attrs=i,this.marks=n,this.solid=r,this.options=s,this.content=[],this.activeMarks=ct.none,this.match=o||(s&ou?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let i=this.type.contentMatch.fillBefore(J.from(e));if(i)this.match=this.type.contentMatch.matchFragment(i);else{let n=this.type.contentMatch,r;return(r=n.findWrapping(e.type))?(this.match=n,r):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&au)){let n=this.content[this.content.length-1],r;if(n&&n.isText&&(r=/[ \t\r\n\u000c]+$/.exec(n.text))){let o=n;n.text.length==r[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-r[0].length))}}let i=J.from(this.content);return!e&&this.match&&(i=i.append(this.match.fillBefore(J.empty,!0))),this.type?this.type.create(this.attrs,i,this.marks):i}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!lF.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}},Sf=class{constructor(e,i,n){this.parser=e,this.options=i,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let r=i.topNode,o,s=Wk(null,i.preserveWhitespace,0)|(n?ou:0);r?o=new _l(r.type,r.attrs,ct.none,!0,i.topMatch||r.type.contentMatch,s):n?o=new _l(null,null,ct.none,!0,null,s):o=new _l(e.schema.topNodeType,null,ct.none,!0,null,s),this.nodes=[o],this.find=i.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,i){e.nodeType==3?this.addTextNode(e,i):e.nodeType==1&&this.addElement(e,i)}addTextNode(e,i){let n=e.nodeValue,r=this.top,o=r.options&Xw?"full":this.localPreserveWS||(r.options&au)>0,{schema:s}=this.parser;if(o==="full"||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(o)if(o==="full")n=n.replace(/\r\n?/g,`
`);else if(s.linebreakReplacement&&/[\r\n]/.test(n)&&this.top.findWrapping(s.linebreakReplacement.create())){let a=n.split(/\r?\n|\r/);for(let l=0;l<a.length;l++)l&&this.insertNode(s.linebreakReplacement.create(),i,!0),a[l]&&this.insertNode(s.text(a[l]),i,!/\S/.test(a[l]));n=""}else n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let a=r.content[r.content.length-1],l=e.previousSibling;(!a||l&&l.nodeName=="BR"||a.isText&&/[ \t\r\n\u000c]$/.test(a.text))&&(n=n.slice(1))}n&&this.insertNode(s.text(n),i,!/\S/.test(n)),this.findInText(e)}else this.findInside(e)}addElement(e,i,n){let r=this.localPreserveWS,o=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let s=e.nodeName.toLowerCase(),a;cF.hasOwnProperty(s)&&this.parser.normalizeLists&&ez(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(a=this.parser.matchTag(e,this,n));e:if(l?l.ignore:ZH.hasOwnProperty(s))this.findInside(e),this.ignoreFallback(e,i);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let c,d=this.needsBlock;if(lF.hasOwnProperty(s))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),c=!0,o.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,i);break e}let u=l&&l.skip?i:this.readStyles(e,i);u&&this.addAll(e,u),c&&this.sync(o),this.needsBlock=d}else{let c=this.readStyles(e,i);c&&this.addElementByRule(e,l,c,l.consuming===!1?a:void 0)}this.localPreserveWS=r}leafFallback(e,i){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),i)}ignoreFallback(e,i){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),i,!0)}readStyles(e,i){let n=e.style;if(n&&n.length)for(let r=0;r<this.parser.matchedStyles.length;r++){let o=this.parser.matchedStyles[r],s=n.getPropertyValue(o);if(s)for(let a=void 0;;){let l=this.parser.matchStyle(o,s,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?i=i.filter(c=>!l.clearMark(c)):i=i.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return i}addElementByRule(e,i,n,r){let o,s;if(i.node)if(s=this.parser.schema.nodes[i.node],s.isLeaf)this.insertNode(s.create(i.attrs),n,e.nodeName=="BR")||this.leafFallback(e,n);else{let l=this.enter(s,i.attrs||null,n,i.preserveWhitespace);l&&(o=!0,n=l)}else{let l=this.parser.schema.marks[i.mark];n=n.concat(l.create(i.attrs))}let a=this.top;if(s&&s.isLeaf)this.findInside(e);else if(r)this.addElement(e,n,r);else if(i.getContent)this.findInside(e),i.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,n,!1));else{let l=e;typeof i.contentElement=="string"?l=e.querySelector(i.contentElement):typeof i.contentElement=="function"?l=i.contentElement(e):i.contentElement&&(l=i.contentElement),this.findAround(e,l,!0),this.addAll(l,n),this.findAround(e,l,!1)}o&&this.sync(a)&&this.open--}addAll(e,i,n,r){let o=n||0;for(let s=n?e.childNodes[n]:e.firstChild,a=r==null?null:e.childNodes[r];s!=a;s=s.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(s,i);this.findAtPoint(e,o)}findPlace(e,i,n){let r,o;for(let s=this.open,a=0;s>=0;s--){let l=this.nodes[s],c=l.findWrapping(e);if(c&&(!r||r.length>c.length+a)&&(r=c,o=l,!c.length))break;if(l.solid){if(n)break;a+=2}}if(!r)return null;this.sync(o);for(let s=0;s<r.length;s++)i=this.enterInner(r[s],null,i,!1);return i}insertNode(e,i,n){if(e.isInline&&this.needsBlock&&!this.top.type){let o=this.textblockFromContext();o&&(i=this.enterInner(o,null,i))}let r=this.findPlace(e,i,n);if(r){this.closeExtra();let o=this.top;o.match&&(o.match=o.match.matchType(e.type));let s=ct.none;for(let a of r.concat(e.marks))(o.type?o.type.allowsMarkType(a.type):jk(a.type,e.type))&&(s=a.addToSet(s));return o.content.push(e.mark(s)),!0}return!1}enter(e,i,n,r){let o=this.findPlace(e.create(i),n,!1);return o&&(o=this.enterInner(e,i,n,!0,r)),o}enterInner(e,i,n,r=!1,o){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(e);let a=Wk(e,o,s.options);s.options&ou&&s.content.length==0&&(a|=ou);let l=ct.none;return n=n.filter(c=>(s.type?s.type.allowsMarkType(c.type):jk(c.type,e))?(l=c.addToSet(l),!1):!0),this.nodes.push(new _l(e,i,l,r,null,a)),this.open++,n}closeExtra(e=!1){let i=this.nodes.length-1;if(i>this.open){for(;i>this.open;i--)this.nodes[i-1].content.push(this.nodes[i].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let i=this.open;i>=0;i--){if(this.nodes[i]==e)return this.open=i,!0;this.localPreserveWS&&(this.nodes[i].options|=au)}return!1}get currentPos(){this.closeExtra();let e=0;for(let i=this.open;i>=0;i--){let n=this.nodes[i].content;for(let r=n.length-1;r>=0;r--)e+=n[r].nodeSize;i&&e++}return e}findAtPoint(e,i){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==i&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&(this.find[i].pos=this.currentPos)}findAround(e,i,n){if(e!=i&&this.find)for(let r=0;r<this.find.length;r++)this.find[r].pos==null&&e.nodeType==1&&e.contains(this.find[r].node)&&i.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}findInText(e){if(this.find)for(let i=0;i<this.find.length;i++)this.find[i].node==e&&(this.find[i].pos=this.currentPos-(e.nodeValue.length-this.find[i].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let i=e.split("/"),n=this.options.context,r=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),o=-(n?n.depth+1:0)+(r?0:1),s=(a,l)=>{for(;a>=0;a--){let c=i[a];if(c==""){if(a==i.length-1||a==0)continue;for(;l>=o;l--)if(s(a-1,l))return!0;return!1}else{let d=l>0||l==0&&r?this.nodes[l].type:n&&l>=o?n.node(l-o).type:null;if(!d||d.name!=c&&!d.isInGroup(c))return!1;l--}}return!0};return s(i.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let i=e.depth;i>=0;i--){let n=e.node(i).contentMatchAt(e.indexAfter(i)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let i in this.parser.schema.nodes){let n=this.parser.schema.nodes[i];if(n.isTextblock&&n.defaultAttrs)return n}}};function ez(t){for(let e=t.firstChild,i=null;e;e=e.nextSibling){let n=e.nodeType==1?e.nodeName.toLowerCase():null;n&&cF.hasOwnProperty(n)&&i?(i.appendChild(e),e=i):n=="li"?i=e:n&&(i=null)}}function tz(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function Uk(t){let e={};for(let i in t)e[i]=t[i];return e}function jk(t,e){let i=e.schema.nodes;for(let n in i){let r=i[n];if(!r.allowsMarkType(t))continue;let o=[],s=a=>{o.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:d}=a.edge(l);if(c==e||o.indexOf(d)<0&&s(d))return!0}};if(s(r.contentMatch))return!0}}var eo=class t{constructor(e,i){this.nodes=e,this.marks=i}serializeFragment(e,i={},n){n||(n=Uw(i).createDocumentFragment());let r=n,o=[];return e.forEach(s=>{if(o.length||s.marks.length){let a=0,l=0;for(;a<o.length&&l<s.marks.length;){let c=s.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(o[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<o.length;)r=o.pop()[1];for(;l<s.marks.length;){let c=s.marks[l++],d=this.serializeMark(c,s.isInline,i);d&&(o.push([c,r]),r.appendChild(d.dom),r=d.contentDOM||d.dom)}}r.appendChild(this.serializeNodeInner(s,i))}),n}serializeNodeInner(e,i){let{dom:n,contentDOM:r}=vf(Uw(i),this.nodes[e.type.name](e),null,e.attrs);if(r){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,i,r)}return n}serializeNode(e,i={}){let n=this.serializeNodeInner(e,i);for(let r=e.marks.length-1;r>=0;r--){let o=this.serializeMark(e.marks[r],e.isInline,i);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n}serializeMark(e,i,n={}){let r=this.marks[e.type.name];return r&&vf(Uw(n),r(e,i),null,e.attrs)}static renderSpec(e,i,n=null,r){return vf(e,i,n,r)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new t(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let i=qk(e.nodes);return i.text||(i.text=n=>n.text),i}static marksFromSchema(e){return qk(e.marks)}};function qk(t){let e={};for(let i in t){let n=t[i].spec.toDOM;n&&(e[i]=n)}return e}function Uw(t){return t.document||window.document}var $k=new WeakMap;function iz(t){let e=$k.get(t);return e===void 0&&$k.set(t,e=nz(t)),e}function nz(t){let e=null;function i(n){if(n&&typeof n=="object")if(Array.isArray(n))if(typeof n[0]=="string")e||(e=[]),e.push(n);else for(let r=0;r<n.length;r++)i(n[r]);else for(let r in n)i(n[r])}return i(t),e}function vf(t,e,i,n){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let r=e[0],o;if(typeof r!="string")throw new RangeError("Invalid array passed to renderSpec");if(n&&(o=iz(n))&&o.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=r.indexOf(" ");s>0&&(i=r.slice(0,s),r=r.slice(s+1));let a,l=i?t.createElementNS(i,r):t.createElement(r),c=e[1],d=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){d=2;for(let u in c)if(c[u]!=null){let h=u.indexOf(" ");h>0?l.setAttributeNS(u.slice(0,h),u.slice(h+1),c[u]):u=="style"&&l.style?l.style.cssText=c[u]:l.setAttribute(u,c[u])}}for(let u=d;u<e.length;u++){let h=e[u];if(h===0){if(u<e.length-1||u>d)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:p,contentDOM:f}=vf(t,h,i,n);if(l.appendChild(p),f){if(a)throw new RangeError("Multiple content holes");a=f}}}return{dom:l,contentDOM:a}}var hF=65535,pF=Math.pow(2,16);function rz(t,e){return t+e*pF}function dF(t){return t&hF}function oz(t){return(t-(t&hF))/pF}var fF=1,gF=2,xf=4,mF=8,du=class{constructor(e,i,n){this.pos=e,this.delInfo=i,this.recover=n}get deleted(){return(this.delInfo&mF)>0}get deletedBefore(){return(this.delInfo&(fF|xf))>0}get deletedAfter(){return(this.delInfo&(gF|xf))>0}get deletedAcross(){return(this.delInfo&xf)>0}},to=class t{constructor(e,i=!1){if(this.ranges=e,this.inverted=i,!e.length&&t.empty)return t.empty}recover(e){let i=0,n=dF(e);if(!this.inverted)for(let r=0;r<n;r++)i+=this.ranges[r*3+2]-this.ranges[r*3+1];return this.ranges[n*3]+i+oz(e)}mapResult(e,i=1){return this._map(e,i,!1)}map(e,i=1){return this._map(e,i,!0)}_map(e,i,n){let r=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+o],d=this.ranges[a+s],u=l+c;if(e<=u){let h=c?e==l?-1:e==u?1:i:i,p=l+r+(h<0?0:d);if(n)return p;let f=e==(i<0?l:u)?null:rz(a/3,e-l),g=e==l?gF:e==u?fF:xf;return(i<0?e!=l:e!=u)&&(g|=mF),new du(p,g,f)}r+=d-c}return n?e+r:new du(e+r,0,null)}touches(e,i){let n=0,r=dF(i),o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?n:0);if(l>e)break;let c=this.ranges[a+o],d=l+c;if(e<=d&&a==r*3)return!0;n+=this.ranges[a+s]-c}return!1}forEach(e){let i=this.inverted?2:1,n=this.inverted?1:2;for(let r=0,o=0;r<this.ranges.length;r+=3){let s=this.ranges[r],a=s-(this.inverted?o:0),l=s+(this.inverted?0:o),c=this.ranges[r+i],d=this.ranges[r+n];e(a,a+c,l,l+d),o+=d-c}}invert(){return new t(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?t.empty:new t(e<0?[0,-e,0]:[0,0,e])}};to.empty=new to([]);var uu=class t{constructor(e,i,n=0,r=e?e.length:0){this.mirror=i,this.from=n,this.to=r,this._maps=e||[],this.ownData=!(e||i)}get maps(){return this._maps}slice(e=0,i=this.maps.length){return new t(this._maps,this.mirror,e,i)}appendMap(e,i){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),i!=null&&this.setMirror(this._maps.length-1,i)}appendMapping(e){for(let i=0,n=this._maps.length;i<e._maps.length;i++){let r=e.getMirror(i);this.appendMap(e._maps[i],r!=null&&r<i?n+r:void 0)}}getMirror(e){if(this.mirror){for(let i=0;i<this.mirror.length;i++)if(this.mirror[i]==e)return this.mirror[i+(i%2?-1:1)]}}setMirror(e,i){this.mirror||(this.mirror=[]),this.mirror.push(e,i)}appendMappingInverted(e){for(let i=e.maps.length-1,n=this._maps.length+e._maps.length;i>=0;i--){let r=e.getMirror(i);this.appendMap(e._maps[i].invert(),r!=null&&r>i?n-r-1:void 0)}}invert(){let e=new t;return e.appendMappingInverted(this),e}map(e,i=1){if(this.mirror)return this._map(e,i,!0);for(let n=this.from;n<this.to;n++)e=this._maps[n].map(e,i);return e}mapResult(e,i=1){return this._map(e,i,!1)}_map(e,i,n){let r=0;for(let o=this.from;o<this.to;o++){let s=this._maps[o],a=s.mapResult(e,i);if(a.recover!=null){let l=this.getMirror(o);if(l!=null&&l>o&&l<this.to){o=l,e=this._maps[l].recover(a.recover);continue}}r|=a.delInfo,e=a.pos}return n?e:new du(e,r,null)}},Jw=Object.create(null),ii=class{getMap(){return to.empty}merge(e){return null}static fromJSON(e,i){if(!i||!i.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=Jw[i.stepType];if(!n)throw new RangeError(`No step type ${i.stepType} defined`);return n.fromJSON(e,i)}static jsonID(e,i){if(e in Jw)throw new RangeError("Duplicate use of step JSON ID "+e);return Jw[e]=i,i.prototype.jsonID=e,i}},li=class t{constructor(e,i){this.doc=e,this.failed=i}static ok(e){return new t(e,null)}static fail(e){return new t(null,e)}static fromReplace(e,i,n,r){try{return t.ok(e.replace(i,n,r))}catch(o){if(o instanceof Zs)return t.fail(o.message);throw o}}};function i1(t,e,i){let n=[];for(let r=0;r<t.childCount;r++){let o=t.child(r);o.content.size&&(o=o.copy(i1(o.content,e,o))),o.isInline&&(o=e(o,i,r)),n.push(o)}return J.fromArray(n)}var hu=class t extends ii{constructor(e,i,n){super(),this.from=e,this.to=i,this.mark=n}apply(e){let i=e.slice(this.from,this.to),n=e.resolve(this.from),r=n.node(n.sharedDepth(this.to)),o=new pe(i1(i.content,(s,a)=>!s.isAtom||!a.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),r),i.openStart,i.openEnd);return li.fromReplace(e,this.from,this.to,o)}invert(){return new io(this.from,this.to,this.mark)}map(e){let i=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return i.deleted&&n.deleted||i.pos>=n.pos?null:new t(i.pos,n.pos,this.mark)}merge(e){return e instanceof t&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new t(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,i){if(typeof i.from!="number"||typeof i.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new t(i.from,i.to,e.markFromJSON(i.mark))}};ii.jsonID("addMark",hu);var io=class t extends ii{constructor(e,i,n){super(),this.from=e,this.to=i,this.mark=n}apply(e){let i=e.slice(this.from,this.to),n=new pe(i1(i.content,r=>r.mark(this.mark.removeFromSet(r.marks)),e),i.openStart,i.openEnd);return li.fromReplace(e,this.from,this.to,n)}invert(){return new hu(this.from,this.to,this.mark)}map(e){let i=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return i.deleted&&n.deleted||i.pos>=n.pos?null:new t(i.pos,n.pos,this.mark)}merge(e){return e instanceof t&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new t(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,i){if(typeof i.from!="number"||typeof i.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new t(i.from,i.to,e.markFromJSON(i.mark))}};ii.jsonID("removeMark",io);var pu=class t extends ii{constructor(e,i){super(),this.pos=e,this.mark=i}apply(e){let i=e.nodeAt(this.pos);if(!i)return li.fail("No node at mark step's position");let n=i.type.create(i.attrs,null,this.mark.addToSet(i.marks));return li.fromReplace(e,this.pos,this.pos+1,new pe(J.from(n),0,i.isLeaf?0:1))}invert(e){let i=e.nodeAt(this.pos);if(i){let n=this.mark.addToSet(i.marks);if(n.length==i.marks.length){for(let r=0;r<i.marks.length;r++)if(!i.marks[r].isInSet(n))return new t(this.pos,i.marks[r]);return new t(this.pos,this.mark)}}return new Fl(this.pos,this.mark)}map(e){let i=e.mapResult(this.pos,1);return i.deletedAfter?null:new t(i.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,i){if(typeof i.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new t(i.pos,e.markFromJSON(i.mark))}};ii.jsonID("addNodeMark",pu);var Fl=class t extends ii{constructor(e,i){super(),this.pos=e,this.mark=i}apply(e){let i=e.nodeAt(this.pos);if(!i)return li.fail("No node at mark step's position");let n=i.type.create(i.attrs,null,this.mark.removeFromSet(i.marks));return li.fromReplace(e,this.pos,this.pos+1,new pe(J.from(n),0,i.isLeaf?0:1))}invert(e){let i=e.nodeAt(this.pos);return!i||!this.mark.isInSet(i.marks)?this:new pu(this.pos,this.mark)}map(e){let i=e.mapResult(this.pos,1);return i.deletedAfter?null:new t(i.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,i){if(typeof i.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new t(i.pos,e.markFromJSON(i.mark))}};ii.jsonID("removeNodeMark",Fl);var xi=class t extends ii{constructor(e,i,n,r=!1){super(),this.from=e,this.to=i,this.slice=n,this.structure=r}apply(e){return this.structure&&e1(e,this.from,this.to)?li.fail("Structure replace would overwrite content"):li.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new to([this.from,this.to-this.from,this.slice.size])}invert(e){return new t(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let i=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return i.deletedAcross&&n.deletedAcross?null:new t(i.pos,Math.max(i.pos,n.pos),this.slice,this.structure)}merge(e){if(!(e instanceof t)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let i=this.slice.size+e.slice.size==0?pe.empty:new pe(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new t(this.from,this.to+(e.to-e.from),i,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let i=this.slice.size+e.slice.size==0?pe.empty:new pe(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new t(e.from,this.to,i,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,i){if(typeof i.from!="number"||typeof i.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new t(i.from,i.to,pe.fromJSON(e,i.slice),!!i.structure)}};ii.jsonID("replace",xi);var Ut=class t extends ii{constructor(e,i,n,r,o,s,a=!1){super(),this.from=e,this.to=i,this.gapFrom=n,this.gapTo=r,this.slice=o,this.insert=s,this.structure=a}apply(e){if(this.structure&&(e1(e,this.from,this.gapFrom)||e1(e,this.gapTo,this.to)))return li.fail("Structure gap-replace would overwrite content");let i=e.slice(this.gapFrom,this.gapTo);if(i.openStart||i.openEnd)return li.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,i.content);return n?li.fromReplace(e,this.from,this.to,n):li.fail("Content does not fit in gap")}getMap(){return new to([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let i=this.gapTo-this.gapFrom;return new t(this.from,this.from+this.slice.size+i,this.from+this.insert,this.from+this.insert+i,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let i=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),r=this.from==this.gapFrom?i.pos:e.map(this.gapFrom,-1),o=this.to==this.gapTo?n.pos:e.map(this.gapTo,1);return i.deletedAcross&&n.deletedAcross||r<i.pos||o>n.pos?null:new t(i.pos,n.pos,r,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,i){if(typeof i.from!="number"||typeof i.to!="number"||typeof i.gapFrom!="number"||typeof i.gapTo!="number"||typeof i.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new t(i.from,i.to,i.gapFrom,i.gapTo,pe.fromJSON(e,i.slice),i.insert,!!i.structure)}};ii.jsonID("replaceAround",Ut);function e1(t,e,i){let n=t.resolve(e),r=i-e,o=n.depth;for(;r>0&&o>0&&n.indexAfter(o)==n.node(o).childCount;)o--,r--;if(r>0){let s=n.node(o).maybeChild(n.indexAfter(o));for(;r>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,r--}}return!1}function sz(t,e,i,n){let r=[],o=[],s,a;t.doc.nodesBetween(e,i,(l,c,d)=>{if(!l.isInline)return;let u=l.marks;if(!n.isInSet(u)&&d.type.allowsMarkType(n.type)){let h=Math.max(c,e),p=Math.min(c+l.nodeSize,i),f=n.addToSet(u);for(let g=0;g<u.length;g++)u[g].isInSet(f)||(s&&s.to==h&&s.mark.eq(u[g])?s.to=p:r.push(s=new io(h,p,u[g])));a&&a.to==h?a.to=p:o.push(a=new hu(h,p,n))}}),r.forEach(l=>t.step(l)),o.forEach(l=>t.step(l))}function az(t,e,i,n){let r=[],o=0;t.doc.nodesBetween(e,i,(s,a)=>{if(!s.isInline)return;o++;let l=null;if(n instanceof su){let c=s.marks,d;for(;d=n.isInSet(c);)(l||(l=[])).push(d),c=d.removeFromSet(c)}else n?n.isInSet(s.marks)&&(l=[n]):l=s.marks;if(l&&l.length){let c=Math.min(a+s.nodeSize,i);for(let d=0;d<l.length;d++){let u=l[d],h;for(let p=0;p<r.length;p++){let f=r[p];f.step==o-1&&u.eq(r[p].style)&&(h=f)}h?(h.to=c,h.step=o):r.push({style:u,from:Math.max(a,e),to:c,step:o})}}}),r.forEach(s=>t.step(new io(s.from,s.to,s.style)))}function n1(t,e,i,n=i.contentMatch,r=!0){let o=t.doc.nodeAt(e),s=[],a=e+1;for(let l=0;l<o.childCount;l++){let c=o.child(l),d=a+c.nodeSize,u=n.matchType(c.type);if(!u)s.push(new xi(a,d,pe.empty));else{n=u;for(let h=0;h<c.marks.length;h++)i.allowsMarkType(c.marks[h].type)||t.step(new io(a,d,c.marks[h]));if(r&&c.isText&&i.whitespace!="pre"){let h,p=/\r?\n|\r/g,f;for(;h=p.exec(c.text);)f||(f=new pe(J.from(i.schema.text(" ",i.allowedMarks(c.marks))),0,0)),s.push(new xi(a+h.index,a+h.index+h[0].length,f))}}a=d}if(!n.validEnd){let l=n.fillBefore(J.empty,!0);t.replace(a,a,new pe(l,0,0))}for(let l=s.length-1;l>=0;l--)t.step(s[l])}function lz(t,e,i){return(e==0||t.canReplace(e,t.childCount))&&(i==t.childCount||t.canReplace(0,i))}function no(t){let i=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let n=t.depth,r=0,o=0;;--n){let s=t.$from.node(n),a=t.$from.index(n)+r,l=t.$to.indexAfter(n)-o;if(n<t.depth&&s.canReplace(a,l,i))return n;if(n==0||s.type.spec.isolating||!lz(s,a,l))break;a&&(r=1),l<s.childCount&&(o=1)}return null}function cz(t,e,i){let{$from:n,$to:r,depth:o}=e,s=n.before(o+1),a=r.after(o+1),l=s,c=a,d=J.empty,u=0;for(let f=o,g=!1;f>i;f--)g||n.index(f)>0?(g=!0,d=J.from(n.node(f).copy(d)),u++):l--;let h=J.empty,p=0;for(let f=o,g=!1;f>i;f--)g||r.after(f+1)<r.end(f)?(g=!0,h=J.from(r.node(f).copy(h)),p++):c++;t.step(new Ut(l,c,s,a,new pe(d.append(h),u,p),d.size-u,!0))}function Ml(t,e,i=null,n=t){let r=dz(t,e),o=r&&uz(n,e);return o?r.map(uF).concat({type:e,attrs:i}).concat(o.map(uF)):null}function uF(t){return{type:t,attrs:null}}function dz(t,e){let{parent:i,startIndex:n,endIndex:r}=t,o=i.contentMatchAt(n).findWrapping(e);if(!o)return null;let s=o.length?o[0]:e;return i.canReplaceWith(n,r,s)?o:null}function uz(t,e){let{parent:i,startIndex:n,endIndex:r}=t,o=i.child(n),s=e.contentMatch.findWrapping(o.type);if(!s)return null;let l=(s.length?s[s.length-1]:e).contentMatch;for(let c=n;l&&c<r;c++)l=l.matchType(i.child(c).type);return!l||!l.validEnd?null:s}function hz(t,e,i){let n=J.empty;for(let s=i.length-1;s>=0;s--){if(n.size){let a=i[s].type.contentMatch.matchFragment(n);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=J.from(i[s].type.create(i[s].attrs,n))}let r=e.start,o=e.end;t.step(new Ut(r,o,r,o,new pe(n,0,0),i.length,!0))}function pz(t,e,i,n,r){if(!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=t.steps.length;t.doc.nodesBetween(e,i,(s,a)=>{let l=typeof r=="function"?r(s):r;if(s.isTextblock&&!s.hasMarkup(n,l)&&fz(t.doc,t.mapping.slice(o).map(a),n)){let c=null;if(n.schema.linebreakReplacement){let p=n.whitespace=="pre",f=!!n.contentMatch.matchType(n.schema.linebreakReplacement);p&&!f?c=!1:!p&&f&&(c=!0)}c===!1&&CF(t,s,a,o),n1(t,t.mapping.slice(o).map(a,1),n,void 0,c===null);let d=t.mapping.slice(o),u=d.map(a,1),h=d.map(a+s.nodeSize,1);return t.step(new Ut(u,h,u+1,h-1,new pe(J.from(n.create(l,null,s.marks)),0,0),1,!0)),c===!0&&vF(t,s,a,o),!1}})}function vF(t,e,i,n){e.forEach((r,o)=>{if(r.isText){let s,a=/\r?\n|\r/g;for(;s=a.exec(r.text);){let l=t.mapping.slice(n).map(i+1+o+s.index);t.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function CF(t,e,i,n){e.forEach((r,o)=>{if(r.type==r.type.schema.linebreakReplacement){let s=t.mapping.slice(n).map(i+1+o);t.replaceWith(s,s+1,e.type.schema.text(`
`))}})}function fz(t,e,i){let n=t.resolve(e),r=n.index();return n.parent.canReplaceWith(r,r+1,i)}function gz(t,e,i,n,r){let o=t.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");i||(i=o.type);let s=i.create(n,null,r||o.marks);if(o.isLeaf)return t.replaceWith(e,e+o.nodeSize,s);if(!i.validContent(o.content))throw new RangeError("Invalid content for node type "+i.name);t.step(new Ut(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new pe(J.from(s),0,0),1,!0))}function sn(t,e,i=1,n){let r=t.resolve(e),o=r.depth-i,s=n&&n[n.length-1]||r.parent;if(o<0||r.parent.type.spec.isolating||!r.parent.canReplace(r.index(),r.parent.childCount)||!s.type.validContent(r.parent.content.cutByIndex(r.index(),r.parent.childCount)))return!1;for(let c=r.depth-1,d=i-2;c>o;c--,d--){let u=r.node(c),h=r.index(c);if(u.type.spec.isolating)return!1;let p=u.content.cutByIndex(h,u.childCount),f=n&&n[d+1];f&&(p=p.replaceChild(0,f.type.create(f.attrs)));let g=n&&n[d]||u;if(!u.canReplace(h+1,u.childCount)||!g.type.validContent(p))return!1}let a=r.indexAfter(o),l=n&&n[0];return r.node(o).canReplaceWith(a,a,l?l.type:r.node(o+1).type)}function mz(t,e,i=1,n){let r=t.doc.resolve(e),o=J.empty,s=J.empty;for(let a=r.depth,l=r.depth-i,c=i-1;a>l;a--,c--){o=J.from(r.node(a).copy(o));let d=n&&n[c];s=J.from(d?d.type.create(d.attrs,s):r.node(a).copy(s))}t.step(new xi(e,e,new pe(o.append(s),i,i),!0))}function Sn(t,e){let i=t.resolve(e),n=i.index();return wF(i.nodeBefore,i.nodeAfter)&&i.parent.canReplace(n,n+1)}function vz(t,e){e.content.size||t.type.compatibleContent(e.type);let i=t.contentMatchAt(t.childCount),{linebreakReplacement:n}=t.type.schema;for(let r=0;r<e.childCount;r++){let o=e.child(r),s=o.type==n?t.type.schema.nodes.text:o.type;if(i=i.matchType(s),!i||!t.type.allowsMarks(o.marks))return!1}return i.validEnd}function wF(t,e){return!!(t&&e&&!t.isLeaf&&vz(t,e))}function ia(t,e,i=-1){let n=t.resolve(e);for(let r=n.depth;;r--){let o,s,a=n.index(r);if(r==n.depth?(o=n.nodeBefore,s=n.nodeAfter):i>0?(o=n.node(r+1),a++,s=n.node(r).maybeChild(a)):(o=n.node(r).maybeChild(a-1),s=n.node(r+1)),o&&!o.isTextblock&&wF(o,s)&&n.node(r).canReplace(a,a+1))return e;if(r==0)break;e=i<0?n.before(r):n.after(r)}}function Cz(t,e,i){let n=null,{linebreakReplacement:r}=t.doc.type.schema,o=t.doc.resolve(e-i),s=o.node().type;if(r&&s.inlineContent){let d=s.whitespace=="pre",u=!!s.contentMatch.matchType(r);d&&!u?n=!1:!d&&u&&(n=!0)}let a=t.steps.length;if(n===!1){let d=t.doc.resolve(e+i);CF(t,d.node(),d.before(),a)}s.inlineContent&&n1(t,e+i-1,s,o.node().contentMatchAt(o.index()),n==null);let l=t.mapping.slice(a),c=l.map(e-i);if(t.step(new xi(c,l.map(e+i,-1),pe.empty,!0)),n===!0){let d=t.doc.resolve(c);vF(t,d.node(),d.before(),t.steps.length)}return t}function wz(t,e,i){let n=t.resolve(e);if(n.parent.canReplaceWith(n.index(),n.index(),i))return e;if(n.parentOffset==0)for(let r=n.depth-1;r>=0;r--){let o=n.index(r);if(n.node(r).canReplaceWith(o,o,i))return n.before(r+1);if(o>0)return null}if(n.parentOffset==n.parent.content.size)for(let r=n.depth-1;r>=0;r--){let o=n.indexAfter(r);if(n.node(r).canReplaceWith(o,o,i))return n.after(r+1);if(o<n.node(r).childCount)return null}return null}function Rf(t,e,i){let n=t.resolve(e);if(!i.content.size)return e;let r=i.content;for(let o=0;o<i.openStart;o++)r=r.firstChild.content;for(let o=1;o<=(i.openStart==0&&i.size?2:1);o++)for(let s=n.depth;s>=0;s--){let a=s==n.depth?0:n.pos<=(n.start(s+1)+n.end(s+1))/2?-1:1,l=n.index(s)+(a>0?1:0),c=n.node(s),d=!1;if(o==1)d=c.canReplace(l,l,r);else{let u=c.contentMatchAt(l).findWrapping(r.firstChild.type);d=u&&c.canReplaceWith(l,l,u[0])}if(d)return a==0?n.pos:a<0?n.before(s+1):n.after(s+1)}return null}function fu(t,e,i=e,n=pe.empty){if(e==i&&!n.size)return null;let r=t.resolve(e),o=t.resolve(i);return bF(r,o,n)?new xi(e,i,n):new t1(r,o,n).fit()}function bF(t,e,i){return!i.openStart&&!i.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),i.content)}var t1=class{constructor(e,i,n){this.$from=e,this.$to=i,this.unplaced=n,this.frontier=[],this.placed=J.empty;for(let r=0;r<=e.depth;r++){let o=e.node(r);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(r))})}for(let r=e.depth;r>0;r--)this.placed=J.from(e.node(r).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),i=this.placed.size-this.depth-this.$from.depth,n=this.$from,r=this.close(e<0?this.$to:n.doc.resolve(e));if(!r)return null;let o=this.placed,s=n.depth,a=r.depth;for(;s&&a&&o.childCount==1;)o=o.firstChild.content,s--,a--;let l=new pe(o,s,a);return e>-1?new Ut(n.pos,e,this.$to.pos,this.$to.end(),l,i):l.size||n.pos!=this.$to.pos?new xi(n.pos,r.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let i=this.unplaced.content,n=0,r=this.unplaced.openEnd;n<e;n++){let o=i.firstChild;if(i.childCount>1&&(r=0),o.type.spec.isolating&&r<=n){e=n;break}i=o.content}for(let i=1;i<=2;i++)for(let n=i==1?e:this.unplaced.openStart;n>=0;n--){let r,o=null;n?(o=Qw(this.unplaced.content,n-1).firstChild,r=o.content):r=this.unplaced.content;let s=r.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],d,u=null;if(i==1&&(s?c.matchType(s.type)||(u=c.fillBefore(J.from(s),!1)):o&&l.compatibleContent(o.type)))return{sliceDepth:n,frontierDepth:a,parent:o,inject:u};if(i==2&&s&&(d=c.findWrapping(s.type)))return{sliceDepth:n,frontierDepth:a,parent:o,wrap:d};if(o&&c.matchType(o.type))break}}}openMore(){let{content:e,openStart:i,openEnd:n}=this.unplaced,r=Qw(e,i);return!r.childCount||r.firstChild.isLeaf?!1:(this.unplaced=new pe(e,i+1,Math.max(n,r.size+i>=e.size-n?i+1:0)),!0)}dropNode(){let{content:e,openStart:i,openEnd:n}=this.unplaced,r=Qw(e,i);if(r.childCount<=1&&i>0){let o=e.size-i<=i+r.size;this.unplaced=new pe(lu(e,i-1,1),i-1,o?i-1:n)}else this.unplaced=new pe(lu(e,i,1),i,n)}placeNodes({sliceDepth:e,frontierDepth:i,parent:n,inject:r,wrap:o}){for(;this.depth>i;)this.closeFrontierNode();if(o)for(let g=0;g<o.length;g++)this.openFrontierNode(o[g]);let s=this.unplaced,a=n?n.content:s.content,l=s.openStart-e,c=0,d=[],{match:u,type:h}=this.frontier[i];if(r){for(let g=0;g<r.childCount;g++)d.push(r.child(g));u=u.matchFragment(r)}let p=a.size+e-(s.content.size-s.openEnd);for(;c<a.childCount;){let g=a.child(c),m=u.matchType(g.type);if(!m)break;c++,(c>1||l==0||g.content.size)&&(u=m,d.push(yF(g.mark(h.allowedMarks(g.marks)),c==1?l:0,c==a.childCount?p:-1)))}let f=c==a.childCount;f||(p=-1),this.placed=cu(this.placed,i,J.from(d)),this.frontier[i].match=u,f&&p<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let g=0,m=a;g<p;g++){let v=m.lastChild;this.frontier.push({type:v.type,match:v.contentMatchAt(v.childCount)}),m=v.content}this.unplaced=f?e==0?pe.empty:new pe(lu(s.content,e-1,1),e-1,p<0?s.openEnd:e-1):new pe(lu(s.content,e,c),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],i;if(!e.type.isTextblock||!Zw(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(i=this.findCloseLevel(this.$to))&&i.depth==this.depth)return-1;let{depth:n}=this.$to,r=this.$to.after(n);for(;n>1&&r==this.$to.end(--n);)++r;return r}findCloseLevel(e){e:for(let i=Math.min(this.depth,e.depth);i>=0;i--){let{match:n,type:r}=this.frontier[i],o=i<e.depth&&e.end(i+1)==e.pos+(e.depth-(i+1)),s=Zw(e,i,r,n,o);if(s){for(let a=i-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],d=Zw(e,a,c,l,!0);if(!d||d.childCount)continue e}return{depth:i,fit:s,move:o?e.doc.resolve(e.after(i+1)):e}}}}close(e){let i=this.findCloseLevel(e);if(!i)return null;for(;this.depth>i.depth;)this.closeFrontierNode();i.fit.childCount&&(this.placed=cu(this.placed,i.depth,i.fit)),e=i.move;for(let n=i.depth+1;n<=e.depth;n++){let r=e.node(n),o=r.type.contentMatch.fillBefore(r.content,!0,e.index(n));this.openFrontierNode(r.type,r.attrs,o)}return e}openFrontierNode(e,i=null,n){let r=this.frontier[this.depth];r.match=r.match.matchType(e),this.placed=cu(this.placed,this.depth,J.from(e.create(i,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let i=this.frontier.pop().match.fillBefore(J.empty,!0);i.childCount&&(this.placed=cu(this.placed,this.frontier.length,i))}};function lu(t,e,i){return e==0?t.cutByIndex(i,t.childCount):t.replaceChild(0,t.firstChild.copy(lu(t.firstChild.content,e-1,i)))}function cu(t,e,i){return e==0?t.append(i):t.replaceChild(t.childCount-1,t.lastChild.copy(cu(t.lastChild.content,e-1,i)))}function Qw(t,e){for(let i=0;i<e;i++)t=t.firstChild.content;return t}function yF(t,e,i){if(e<=0)return t;let n=t.content;return e>1&&(n=n.replaceChild(0,yF(n.firstChild,e-1,n.childCount==1?i-1:0))),e>0&&(n=t.type.contentMatch.fillBefore(n).append(n),i<=0&&(n=n.append(t.type.contentMatch.matchFragment(n).fillBefore(J.empty,!0)))),t.copy(n)}function Zw(t,e,i,n,r){let o=t.node(e),s=r?t.indexAfter(e):t.index(e);if(s==o.childCount&&!i.compatibleContent(o.type))return null;let a=n.fillBefore(o.content,!0,s);return a&&!bz(i,o.content,s)?a:null}function bz(t,e,i){for(let n=i;n<e.childCount;n++)if(!t.allowsMarks(e.child(n).marks))return!0;return!1}function yz(t){return t.spec.defining||t.spec.definingForContent}function Sz(t,e,i,n){if(!n.size)return t.deleteRange(e,i);let r=t.doc.resolve(e),o=t.doc.resolve(i);if(bF(r,o,n))return t.step(new xi(e,i,n));let s=xF(r,o);s[s.length-1]==0&&s.pop();let a=-(r.depth+1);s.unshift(a);for(let h=r.depth,p=r.pos-1;h>0;h--,p--){let f=r.node(h).type.spec;if(f.defining||f.definingAsContext||f.isolating)break;s.indexOf(h)>-1?a=h:r.before(h)==p&&s.splice(1,0,-h)}let l=s.indexOf(a),c=[],d=n.openStart;for(let h=n.content,p=0;;p++){let f=h.firstChild;if(c.push(f),p==n.openStart)break;h=f.content}for(let h=d-1;h>=0;h--){let p=c[h],f=yz(p.type);if(f&&!p.sameMarkup(r.node(Math.abs(a)-1)))d=h;else if(f||!p.type.isTextblock)break}for(let h=n.openStart;h>=0;h--){let p=(h+d+1)%(n.openStart+1),f=c[p];if(f)for(let g=0;g<s.length;g++){let m=s[(g+l)%s.length],v=!0;m<0&&(v=!1,m=-m);let C=r.node(m-1),b=r.index(m-1);if(C.canReplaceWith(b,b,f.type,f.marks))return t.replace(r.before(m),v?o.after(m):i,new pe(SF(n.content,0,n.openStart,p),p,n.openEnd))}}let u=t.steps.length;for(let h=s.length-1;h>=0&&(t.replace(e,i,n),!(t.steps.length>u));h--){let p=s[h];p<0||(e=r.before(p),i=o.after(p))}}function SF(t,e,i,n,r){if(e<i){let o=t.firstChild;t=t.replaceChild(0,o.copy(SF(o.content,e+1,i,n,o)))}if(e>n){let o=r.contentMatchAt(0),s=o.fillBefore(t).append(t);t=s.append(o.matchFragment(s).fillBefore(J.empty,!0))}return t}function xz(t,e,i,n){if(!n.isInline&&e==i&&t.doc.resolve(e).parent.content.size){let r=wz(t.doc,e,n.type);r!=null&&(e=i=r)}t.replaceRange(e,i,new pe(J.from(n),0,0))}function Ez(t,e,i){let n=t.doc.resolve(e),r=t.doc.resolve(i),o=xF(n,r);for(let s=0;s<o.length;s++){let a=o[s],l=s==o.length-1;if(l&&a==0||n.node(a).type.contentMatch.validEnd)return t.delete(n.start(a),r.end(a));if(a>0&&(l||n.node(a-1).canReplace(n.index(a-1),r.indexAfter(a-1))))return t.delete(n.before(a),r.after(a))}for(let s=1;s<=n.depth&&s<=r.depth;s++)if(e-n.start(s)==n.depth-s&&i>n.end(s)&&r.end(s)-i!=r.depth-s&&n.start(s-1)==r.start(s-1)&&n.node(s-1).canReplace(n.index(s-1),r.index(s-1)))return t.delete(n.before(s),i);t.delete(e,i)}function xF(t,e){let i=[],n=Math.min(t.depth,e.depth);for(let r=n;r>=0;r--){let o=t.start(r);if(o<t.pos-(t.depth-r)||e.end(r)>e.pos+(e.depth-r)||t.node(r).type.spec.isolating||e.node(r).type.spec.isolating)break;(o==e.start(r)||r==t.depth&&r==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&r&&e.start(r-1)==o-1)&&i.push(r)}return i}var Ef=class t extends ii{constructor(e,i,n){super(),this.pos=e,this.attr=i,this.value=n}apply(e){let i=e.nodeAt(this.pos);if(!i)return li.fail("No node at attribute step's position");let n=Object.create(null);for(let o in i.attrs)n[o]=i.attrs[o];n[this.attr]=this.value;let r=i.type.create(n,null,i.marks);return li.fromReplace(e,this.pos,this.pos+1,new pe(J.from(r),0,i.isLeaf?0:1))}getMap(){return to.empty}invert(e){return new t(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let i=e.mapResult(this.pos,1);return i.deletedAfter?null:new t(i.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,i){if(typeof i.pos!="number"||typeof i.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new t(i.pos,i.attr,i.value)}};ii.jsonID("attr",Ef);var Pf=class t extends ii{constructor(e,i){super(),this.attr=e,this.value=i}apply(e){let i=Object.create(null);for(let r in e.attrs)i[r]=e.attrs[r];i[this.attr]=this.value;let n=e.type.create(i,e.content,e.marks);return li.ok(n)}getMap(){return to.empty}invert(e){return new t(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,i){if(typeof i.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new t(i.attr,i.value)}};ii.jsonID("docAttr",Pf);var Tl=class extends Error{};Tl=function t(e){let i=Error.call(this,e);return i.__proto__=t.prototype,i};Tl.prototype=Object.create(Error.prototype);Tl.prototype.constructor=Tl;Tl.prototype.name="TransformError";var Dl=class{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new uu}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let i=this.maybeStep(e);if(i.failed)throw new Tl(i.failed);return this}maybeStep(e){let i=e.apply(this.doc);return i.failed||this.addStep(e,i.doc),i}get docChanged(){return this.steps.length>0}addStep(e,i){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=i}replace(e,i=e,n=pe.empty){let r=fu(this.doc,e,i,n);return r&&this.step(r),this}replaceWith(e,i,n){return this.replace(e,i,new pe(J.from(n),0,0))}delete(e,i){return this.replace(e,i,pe.empty)}insert(e,i){return this.replaceWith(e,e,i)}replaceRange(e,i,n){return Sz(this,e,i,n),this}replaceRangeWith(e,i,n){return xz(this,e,i,n),this}deleteRange(e,i){return Ez(this,e,i),this}lift(e,i){return cz(this,e,i),this}join(e,i=1){return Cz(this,e,i),this}wrap(e,i){return hz(this,e,i),this}setBlockType(e,i=e,n,r=null){return pz(this,e,i,n,r),this}setNodeMarkup(e,i,n=null,r){return gz(this,e,i,n,r),this}setNodeAttribute(e,i,n){return this.step(new Ef(e,i,n)),this}setDocAttribute(e,i){return this.step(new Pf(e,i)),this}addNodeMark(e,i){return this.step(new pu(e,i)),this}removeNodeMark(e,i){let n=this.doc.nodeAt(e);if(!n)throw new RangeError("No node at position "+e);if(i instanceof ct)i.isInSet(n.marks)&&this.step(new Fl(e,i));else{let r=n.marks,o,s=[];for(;o=i.isInSet(r);)s.push(new Fl(e,o)),r=o.removeFromSet(r);for(let a=s.length-1;a>=0;a--)this.step(s[a])}return this}split(e,i=1,n){return mz(this,e,i,n),this}addMark(e,i,n){return sz(this,e,i,n),this}removeMark(e,i,n){return az(this,e,i,n),this}clearIncompatible(e,i,n){return n1(this,e,i,n),this}};var r1=Object.create(null),ke=class{constructor(e,i,n){this.$anchor=e,this.$head=i,this.ranges=n||[new kf(e.min(i),e.max(i))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let i=0;i<e.length;i++)if(e[i].$from.pos!=e[i].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,i=pe.empty){let n=i.content.lastChild,r=null;for(let a=0;a<i.openEnd;a++)r=n,n=n.lastChild;let o=e.steps.length,s=this.ranges;for(let a=0;a<s.length;a++){let{$from:l,$to:c}=s[a],d=e.mapping.slice(o);e.replaceRange(d.map(l.pos),d.map(c.pos),a?pe.empty:i),a==0&&RF(e,o,(n?n.isInline:r&&r.isTextblock)?-1:1)}}replaceWith(e,i){let n=e.steps.length,r=this.ranges;for(let o=0;o<r.length;o++){let{$from:s,$to:a}=r[o],l=e.mapping.slice(n),c=l.map(s.pos),d=l.map(a.pos);o?e.deleteRange(c,d):(e.replaceRangeWith(c,d,i),RF(e,n,i.isInline?-1:1))}}static findFrom(e,i,n=!1){let r=e.parent.inlineContent?new Pe(e):Il(e.node(0),e.parent,e.pos,e.index(),i,n);if(r)return r;for(let o=e.depth-1;o>=0;o--){let s=i<0?Il(e.node(0),e.node(o),e.before(o+1),e.index(o),i,n):Il(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,i,n);if(s)return s}return null}static near(e,i=1){return this.findFrom(e,i)||this.findFrom(e,-i)||new Ni(e.node(0))}static atStart(e){return Il(e,e,0,0,1)||new Ni(e)}static atEnd(e){return Il(e,e,e.content.size,e.childCount,-1)||new Ni(e)}static fromJSON(e,i){if(!i||!i.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=r1[i.type];if(!n)throw new RangeError(`No selection type ${i.type} defined`);return n.fromJSON(e,i)}static jsonID(e,i){if(e in r1)throw new RangeError("Duplicate use of selection JSON ID "+e);return r1[e]=i,i.prototype.jsonID=e,i}getBookmark(){return Pe.between(this.$anchor,this.$head).getBookmark()}};ke.prototype.visible=!0;var kf=class{constructor(e,i){this.$from=e,this.$to=i}},EF=!1;function PF(t){!EF&&!t.parent.inlineContent&&(EF=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}var Pe=class t extends ke{constructor(e,i=e){PF(e),PF(i),super(e,i)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,i){let n=e.resolve(i.map(this.head));if(!n.parent.inlineContent)return ke.near(n);let r=e.resolve(i.map(this.anchor));return new t(r.parent.inlineContent?r:n,n)}replace(e,i=pe.empty){if(super.replace(e,i),i==pe.empty){let n=this.$from.marksAcross(this.$to);n&&e.ensureMarks(n)}}eq(e){return e instanceof t&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Ff(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,i){if(typeof i.anchor!="number"||typeof i.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new t(e.resolve(i.anchor),e.resolve(i.head))}static create(e,i,n=i){let r=e.resolve(i);return new this(r,n==i?r:e.resolve(n))}static between(e,i,n){let r=e.pos-i.pos;if((!n||r)&&(n=r>=0?1:-1),!i.parent.inlineContent){let o=ke.findFrom(i,n,!0)||ke.findFrom(i,-n,!0);if(o)i=o.$head;else return ke.near(i,n)}return e.parent.inlineContent||(r==0?e=i:(e=(ke.findFrom(e,-n,!0)||ke.findFrom(e,n,!0)).$anchor,e.pos<i.pos!=r<0&&(e=i))),new t(e,i)}};ke.jsonID("text",Pe);var Ff=class t{constructor(e,i){this.anchor=e,this.head=i}map(e){return new t(e.map(this.anchor),e.map(this.head))}resolve(e){return Pe.between(e.resolve(this.anchor),e.resolve(this.head))}},ye=class t extends ke{constructor(e){let i=e.nodeAfter,n=e.node(0).resolve(e.pos+i.nodeSize);super(e,n),this.node=i}map(e,i){let{deleted:n,pos:r}=i.mapResult(this.anchor),o=e.resolve(r);return n?ke.near(o):new t(o)}content(){return new pe(J.from(this.node),0,0)}eq(e){return e instanceof t&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new s1(this.anchor)}static fromJSON(e,i){if(typeof i.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new t(e.resolve(i.anchor))}static create(e,i){return new t(e.resolve(i))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}};ye.prototype.visible=!1;ke.jsonID("node",ye);var s1=class t{constructor(e){this.anchor=e}map(e){let{deleted:i,pos:n}=e.mapResult(this.anchor);return i?new Ff(n,n):new t(n)}resolve(e){let i=e.resolve(this.anchor),n=i.nodeAfter;return n&&ye.isSelectable(n)?new ye(i):ke.near(i)}},Ni=class t extends ke{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,i=pe.empty){if(i==pe.empty){e.delete(0,e.doc.content.size);let n=ke.atStart(e.doc);n.eq(e.selection)||e.setSelection(n)}else super.replace(e,i)}toJSON(){return{type:"all"}}static fromJSON(e){return new t(e)}map(e){return new t(e)}eq(e){return e instanceof t}getBookmark(){return Pz}};ke.jsonID("all",Ni);var Pz={map(){return this},resolve(t){return new Ni(t)}};function Il(t,e,i,n,r,o=!1){if(e.inlineContent)return Pe.create(t,i);for(let s=n-(r>0?0:1);r>0?s<e.childCount:s>=0;s+=r){let a=e.child(s);if(a.isAtom){if(!o&&ye.isSelectable(a))return ye.create(t,i-(r<0?a.nodeSize:0))}else{let l=Il(t,a,i+r,r<0?a.childCount:0,r,o);if(l)return l}i+=a.nodeSize*r}return null}function RF(t,e,i){let n=t.steps.length-1;if(n<e)return;let r=t.steps[n];if(!(r instanceof xi||r instanceof Ut))return;let o=t.mapping.maps[n],s;o.forEach((a,l,c,d)=>{s==null&&(s=d)}),t.setSelection(ke.near(t.doc.resolve(s),i))}var _F=1,_f=2,kF=4,a1=class extends Dl{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|_F)&~_f,this.storedMarks=null,this}get selectionSet(){return(this.updated&_F)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=_f,this}ensureMarks(e){return ct.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&_f)>0}addStep(e,i){super.addStep(e,i),this.updated=this.updated&~_f,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,i=!0){let n=this.selection;return i&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||ct.none))),n.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,i,n){let r=this.doc.type.schema;if(i==null)return e?this.replaceSelectionWith(r.text(e),!0):this.deleteSelection();{if(n==null&&(n=i),!e)return this.deleteRange(i,n);let o=this.storedMarks;if(!o){let s=this.doc.resolve(i);o=n==i?s.marks():s.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(i,n,r.text(e,o)),!this.selection.empty&&this.selection.to==i+e.length&&this.setSelection(ke.near(this.selection.$to)),this}}setMeta(e,i){return this.meta[typeof e=="string"?e:e.key]=i,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=kF,this}get scrolledIntoView(){return(this.updated&kF)>0}};function FF(t,e){return!e||!t?t:t.bind(e)}var na=class{constructor(e,i,n){this.name=e,this.init=FF(i.init,n),this.apply=FF(i.apply,n)}},Rz=[new na("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new na("selection",{init(t,e){return t.selection||ke.atStart(e.doc)},apply(t){return t.selection}}),new na("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,i,n){return n.selection.$cursor?t.storedMarks:null}}),new na("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})],gu=class{constructor(e,i){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=Rz.slice(),i&&i.forEach(n=>{if(this.pluginsByKey[n.key])throw new RangeError("Adding different instances of a keyed plugin ("+n.key+")");this.plugins.push(n),this.pluginsByKey[n.key]=n,n.spec.state&&this.fields.push(new na(n.key,n.spec.state,n))})}},Tf=class t{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,i=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=i){let r=this.config.plugins[n];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let i=[e],n=this.applyInner(e),r=null;for(;;){let o=!1;for(let s=0;s<this.config.plugins.length;s++){let a=this.config.plugins[s];if(a.spec.appendTransaction){let l=r?r[s].n:0,c=r?r[s].state:this,d=l<i.length&&a.spec.appendTransaction.call(a,l?i.slice(l):i,c,n);if(d&&n.filterTransaction(d,s)){if(d.setMeta("appendedTransaction",e),!r){r=[];for(let u=0;u<this.config.plugins.length;u++)r.push(u<s?{state:n,n:i.length}:{state:this,n:0})}i.push(d),n=n.applyInner(d),o=!0}r&&(r[s]={state:n,n:i.length})}}if(!o)return{state:n,transactions:i}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let i=new t(this.config),n=this.config.fields;for(let r=0;r<n.length;r++){let o=n[r];i[o.name]=o.apply(e,this[o.name],this,i)}return i}get tr(){return new a1(this)}static create(e){let i=new gu(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new t(i);for(let r=0;r<i.fields.length;r++)n[i.fields[r].name]=i.fields[r].init(e,n);return n}reconfigure(e){let i=new gu(this.schema,e.plugins),n=i.fields,r=new t(i);for(let o=0;o<n.length;o++){let s=n[o].name;r[s]=this.hasOwnProperty(s)?this[s]:n[o].init(e,r)}return r}toJSON(e){let i={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(i.storedMarks=this.storedMarks.map(n=>n.toJSON())),e&&typeof e=="object")for(let n in e){if(n=="doc"||n=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let r=e[n],o=r.spec.state;o&&o.toJSON&&(i[n]=o.toJSON.call(r,this[r.key]))}return i}static fromJSON(e,i,n){if(!i)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let r=new gu(e.schema,e.plugins),o=new t(r);return r.fields.forEach(s=>{if(s.name=="doc")o.doc=qi.fromJSON(e.schema,i.doc);else if(s.name=="selection")o.selection=ke.fromJSON(o.doc,i.selection);else if(s.name=="storedMarks")i.storedMarks&&(o.storedMarks=i.storedMarks.map(e.schema.markFromJSON));else{if(n)for(let a in n){let l=n[a],c=l.spec.state;if(l.key==s.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(i,a)){o[s.name]=c.fromJSON.call(l,e,i[a],o);return}}o[s.name]=s.init(e,o)}}),o}};function TF(t,e,i){for(let n in t){let r=t[n];r instanceof Function?r=r.bind(e):n=="handleDOMEvents"&&(r=TF(r,e,{})),i[n]=r}return i}var Te=class{constructor(e){this.spec=e,this.props={},e.props&&TF(e.props,this,this.props),this.key=e.key?e.key.key:DF("plugin")}getState(e){return e[this.key]}},o1=Object.create(null);function DF(t){return t in o1?t+"$"+ ++o1[t]:(o1[t]=0,t+"$")}var Oe=class{constructor(e="key"){this.key=DF(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}};var Df=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function IF(t,e){let{$cursor:i}=t.selection;return!i||(e?!e.endOfTextblock("backward",t):i.parentOffset>0)?null:i}var c1=(t,e,i)=>{let n=IF(t,i);if(!n)return!1;let r=u1(n);if(!r){let s=n.blockRange(),a=s&&no(s);return a==null?!1:(e&&e(t.tr.lift(s,a).scrollIntoView()),!0)}let o=r.nodeBefore;if(GF(t,r,e,-1))return!0;if(n.parent.content.size==0&&(Al(o,"end")||ye.isSelectable(o)))for(let s=n.depth;;s--){let a=fu(t.doc,n.before(s),n.after(s),pe.empty);if(a&&a.slice.size<a.to-a.from){if(e){let l=t.tr.step(a);l.setSelection(Al(o,"end")?ke.findFrom(l.doc.resolve(l.mapping.map(r.pos,-1)),-1):ye.create(l.doc,r.pos-o.nodeSize)),e(l.scrollIntoView())}return!0}if(s==1||n.node(s-1).childCount>1)break}return o.isAtom&&r.depth==n.depth-1?(e&&e(t.tr.delete(r.pos-o.nodeSize,r.pos).scrollIntoView()),!0):!1},AF=(t,e,i)=>{let n=IF(t,i);if(!n)return!1;let r=u1(n);return r?LF(t,r,e):!1},OF=(t,e,i)=>{let n=NF(t,i);if(!n)return!1;let r=f1(n);return r?LF(t,r,e):!1};function LF(t,e,i){let n=e.nodeBefore,r=n,o=e.pos-1;for(;!r.isTextblock;o--){if(r.type.spec.isolating)return!1;let d=r.lastChild;if(!d)return!1;r=d}let s=e.nodeAfter,a=s,l=e.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let d=a.firstChild;if(!d)return!1;a=d}let c=fu(t.doc,o,l,pe.empty);if(!c||c.from!=o||c instanceof xi&&c.slice.size>=l-o)return!1;if(i){let d=t.tr.step(c);d.setSelection(Pe.create(d.doc,o)),i(d.scrollIntoView())}return!0}function Al(t,e,i=!1){for(let n=t;n;n=e=="start"?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(i&&n.childCount!=1)return!1}return!1}var d1=(t,e,i)=>{let{$head:n,empty:r}=t.selection,o=n;if(!r)return!1;if(n.parent.isTextblock){if(i?!i.endOfTextblock("backward",t):n.parentOffset>0)return!1;o=u1(n)}let s=o&&o.nodeBefore;return!s||!ye.isSelectable(s)?!1:(e&&e(t.tr.setSelection(ye.create(t.doc,o.pos-s.nodeSize)).scrollIntoView()),!0)};function u1(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function NF(t,e){let{$cursor:i}=t.selection;return!i||(e?!e.endOfTextblock("forward",t):i.parentOffset<i.parent.content.size)?null:i}var h1=(t,e,i)=>{let n=NF(t,i);if(!n)return!1;let r=f1(n);if(!r)return!1;let o=r.nodeAfter;if(GF(t,r,e,1))return!0;if(n.parent.content.size==0&&(Al(o,"start")||ye.isSelectable(o))){let s=fu(t.doc,n.before(),n.after(),pe.empty);if(s&&s.slice.size<s.to-s.from){if(e){let a=t.tr.step(s);a.setSelection(Al(o,"start")?ke.findFrom(a.doc.resolve(a.mapping.map(r.pos)),1):ye.create(a.doc,a.mapping.map(r.pos))),e(a.scrollIntoView())}return!0}}return o.isAtom&&r.depth==n.depth-1?(e&&e(t.tr.delete(r.pos,r.pos+o.nodeSize).scrollIntoView()),!0):!1},p1=(t,e,i)=>{let{$head:n,empty:r}=t.selection,o=n;if(!r)return!1;if(n.parent.isTextblock){if(i?!i.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)return!1;o=f1(n)}let s=o&&o.nodeAfter;return!s||!ye.isSelectable(s)?!1:(e&&e(t.tr.setSelection(ye.create(t.doc,o.pos)).scrollIntoView()),!0)};function f1(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let i=t.node(e);if(t.index(e)+1<i.childCount)return t.doc.resolve(t.after(e+1));if(i.type.spec.isolating)break}return null}var BF=(t,e)=>{let i=t.selection,n=i instanceof ye,r;if(n){if(i.node.isTextblock||!Sn(t.doc,i.from))return!1;r=i.from}else if(r=ia(t.doc,i.from,-1),r==null)return!1;if(e){let o=t.tr.join(r);n&&o.setSelection(ye.create(o.doc,r-t.doc.resolve(r).nodeBefore.nodeSize)),e(o.scrollIntoView())}return!0},HF=(t,e)=>{let i=t.selection,n;if(i instanceof ye){if(i.node.isTextblock||!Sn(t.doc,i.to))return!1;n=i.to}else if(n=ia(t.doc,i.to,1),n==null)return!1;return e&&e(t.tr.join(n).scrollIntoView()),!0},zF=(t,e)=>{let{$from:i,$to:n}=t.selection,r=i.blockRange(n),o=r&&no(r);return o==null?!1:(e&&e(t.tr.lift(r,o).scrollIntoView()),!0)},g1=(t,e)=>{let{$head:i,$anchor:n}=t.selection;return!i.parent.type.spec.code||!i.sameParent(n)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function m1(t){for(let e=0;e<t.edgeCount;e++){let{type:i}=t.edge(e);if(i.isTextblock&&!i.hasRequiredAttrs())return i}return null}var v1=(t,e)=>{let{$head:i,$anchor:n}=t.selection;if(!i.parent.type.spec.code||!i.sameParent(n))return!1;let r=i.node(-1),o=i.indexAfter(-1),s=m1(r.contentMatchAt(o));if(!s||!r.canReplaceWith(o,o,s))return!1;if(e){let a=i.after(),l=t.tr.replaceWith(a,a,s.createAndFill());l.setSelection(ke.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},C1=(t,e)=>{let i=t.selection,{$from:n,$to:r}=i;if(i instanceof Ni||n.parent.inlineContent||r.parent.inlineContent)return!1;let o=m1(r.parent.contentMatchAt(r.indexAfter()));if(!o||!o.isTextblock)return!1;if(e){let s=(!n.parentOffset&&r.index()<r.parent.childCount?n:r).pos,a=t.tr.insert(s,o.createAndFill());a.setSelection(Pe.create(a.doc,s+1)),e(a.scrollIntoView())}return!0},w1=(t,e)=>{let{$cursor:i}=t.selection;if(!i||i.parent.content.size)return!1;if(i.depth>1&&i.after()!=i.end(-1)){let o=i.before();if(sn(t.doc,o))return e&&e(t.tr.split(o).scrollIntoView()),!0}let n=i.blockRange(),r=n&&no(n);return r==null?!1:(e&&e(t.tr.lift(n,r).scrollIntoView()),!0)};function _z(t){return(e,i)=>{let{$from:n,$to:r}=e.selection;if(e.selection instanceof ye&&e.selection.node.isBlock)return!n.parentOffset||!sn(e.doc,n.pos)?!1:(i&&i(e.tr.split(n.pos).scrollIntoView()),!0);if(!n.depth)return!1;let o=[],s,a,l=!1,c=!1;for(let p=n.depth;;p--)if(n.node(p).isBlock){l=n.end(p)==n.pos+(n.depth-p),c=n.start(p)==n.pos-(n.depth-p),a=m1(n.node(p-1).contentMatchAt(n.indexAfter(p-1)));let g=t&&t(r.parent,l,n);o.unshift(g||(l&&a?{type:a}:null)),s=p;break}else{if(p==1)return!1;o.unshift(null)}let d=e.tr;(e.selection instanceof Pe||e.selection instanceof Ni)&&d.deleteSelection();let u=d.mapping.map(n.pos),h=sn(d.doc,u,o.length,o);if(h||(o[0]=a?{type:a}:null,h=sn(d.doc,u,o.length,o)),!h)return!1;if(d.split(u,o.length,o),!l&&c&&n.node(s).type!=a){let p=d.mapping.map(n.before(s)),f=d.doc.resolve(p);a&&n.node(s-1).canReplaceWith(f.index(),f.index()+1,a)&&d.setNodeMarkup(d.mapping.map(n.before(s)),a)}return i&&i(d.scrollIntoView()),!0}}var kz=_z();var VF=(t,e)=>{let{$from:i,to:n}=t.selection,r,o=i.sharedDepth(n);return o==0?!1:(r=i.before(o),e&&e(t.tr.setSelection(ye.create(t.doc,r))),!0)},Fz=(t,e)=>(e&&e(t.tr.setSelection(new Ni(t.doc))),!0);function Tz(t,e,i){let n=e.nodeBefore,r=e.nodeAfter,o=e.index();return!n||!r||!n.type.compatibleContent(r.type)?!1:!n.content.size&&e.parent.canReplace(o-1,o)?(i&&i(t.tr.delete(e.pos-n.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(o,o+1)||!(r.isTextblock||Sn(t.doc,e.pos))?!1:(i&&i(t.tr.join(e.pos).scrollIntoView()),!0)}function GF(t,e,i,n){let r=e.nodeBefore,o=e.nodeAfter,s,a,l=r.type.spec.isolating||o.type.spec.isolating;if(!l&&Tz(t,e,i))return!0;let c=!l&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(s=(a=r.contentMatchAt(r.childCount)).findWrapping(o.type))&&a.matchType(s[0]||o.type).validEnd){if(i){let p=e.pos+o.nodeSize,f=J.empty;for(let v=s.length-1;v>=0;v--)f=J.from(s[v].create(null,f));f=J.from(r.copy(f));let g=t.tr.step(new Ut(e.pos-1,p,e.pos,p,new pe(f,1,0),s.length,!0)),m=g.doc.resolve(p+2*s.length);m.nodeAfter&&m.nodeAfter.type==r.type&&Sn(g.doc,m.pos)&&g.join(m.pos),i(g.scrollIntoView())}return!0}let d=o.type.spec.isolating||n>0&&l?null:ke.findFrom(e,1),u=d&&d.$from.blockRange(d.$to),h=u&&no(u);if(h!=null&&h>=e.depth)return i&&i(t.tr.lift(u,h).scrollIntoView()),!0;if(c&&Al(o,"start",!0)&&Al(r,"end")){let p=r,f=[];for(;f.push(p),!p.isTextblock;)p=p.lastChild;let g=o,m=1;for(;!g.isTextblock;g=g.firstChild)m++;if(p.canReplace(p.childCount,p.childCount,g.content)){if(i){let v=J.empty;for(let b=f.length-1;b>=0;b--)v=J.from(f[b].copy(v));let C=t.tr.step(new Ut(e.pos-f.length,e.pos+o.nodeSize,e.pos+m,e.pos+o.nodeSize-m,new pe(v,f.length,0),0,!0));i(C.scrollIntoView())}return!0}}return!1}function WF(t){return function(e,i){let n=e.selection,r=t<0?n.$from:n.$to,o=r.depth;for(;r.node(o).isInline;){if(!o)return!1;o--}return r.node(o).isTextblock?(i&&i(e.tr.setSelection(Pe.create(e.doc,t<0?r.start(o):r.end(o)))),!0):!1}}var b1=WF(-1),y1=WF(1);function UF(t,e=null){return function(i,n){let{$from:r,$to:o}=i.selection,s=r.blockRange(o),a=s&&Ml(s,t,e);return a?(n&&n(i.tr.wrap(s,a).scrollIntoView()),!0):!1}}function S1(t,e=null){return function(i,n){let r=!1;for(let o=0;o<i.selection.ranges.length&&!r;o++){let{$from:{pos:s},$to:{pos:a}}=i.selection.ranges[o];i.doc.nodesBetween(s,a,(l,c)=>{if(r)return!1;if(!(!l.isTextblock||l.hasMarkup(t,e)))if(l.type==t)r=!0;else{let d=i.doc.resolve(c),u=d.index();r=d.parent.canReplaceWith(u,u+1,t)}})}if(!r)return!1;if(n){let o=i.tr;for(let s=0;s<i.selection.ranges.length;s++){let{$from:{pos:a},$to:{pos:l}}=i.selection.ranges[s];o.setBlockType(a,l,t,e)}n(o.scrollIntoView())}return!0}}function x1(...t){return function(e,i,n){for(let r=0;r<t.length;r++)if(t[r](e,i,n))return!0;return!1}}var l1=x1(Df,c1,d1),MF=x1(Df,h1,p1),es={Enter:x1(g1,C1,w1,kz),"Mod-Enter":v1,Backspace:l1,"Mod-Backspace":l1,"Shift-Backspace":l1,Delete:MF,"Mod-Delete":MF,"Mod-a":Fz},Dz={"Ctrl-h":es.Backspace,"Alt-Backspace":es["Mod-Backspace"],"Ctrl-d":es.Delete,"Ctrl-Alt-Backspace":es["Mod-Delete"],"Alt-Delete":es["Mod-Delete"],"Alt-d":es["Mod-Delete"],"Ctrl-a":b1,"Ctrl-e":y1};for(let t in es)Dz[t]=es[t];var dSe=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform?os.platform()=="darwin":!1;function jF(t,e=null){return function(i,n){let{$from:r,$to:o}=i.selection,s=r.blockRange(o);if(!s)return!1;let a=n?i.tr:null;return Mz(a,s,t,e)?(n&&n(a.scrollIntoView()),!0):!1}}function Mz(t,e,i,n=null){let r=!1,o=e,s=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(i)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=s.resolve(e.start-2);o=new ea(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new ea(e.$from,s.resolve(e.$to.end(e.depth)),e.depth)),r=!0}let a=Ml(o,i,n,e);return a?(t&&Iz(t,e,a,r,i),!0):!1}function Iz(t,e,i,n,r){let o=J.empty;for(let d=i.length-1;d>=0;d--)o=J.from(i[d].type.create(i[d].attrs,o));t.step(new Ut(e.start-(n?2:0),e.end,e.start,e.end,new pe(o,0,0),i.length,!0));let s=0;for(let d=0;d<i.length;d++)i[d].type==r&&(s=d+1);let a=i.length-s,l=e.start+i.length-(n?2:0),c=e.parent;for(let d=e.startIndex,u=e.endIndex,h=!0;d<u;d++,h=!1)!h&&sn(t.doc,l,a)&&(t.split(l,a),l+=2*a),l+=c.child(d).nodeSize;return t}function qF(t){return function(e,i){let{$from:n,$to:r}=e.selection,o=n.blockRange(r,s=>s.childCount>0&&s.firstChild.type==t);return o?i?n.node(o.depth-1).type==t?Az(e,i,t,o):Oz(e,i,o):!0:!1}}function Az(t,e,i,n){let r=t.tr,o=n.end,s=n.$to.end(n.depth);o<s&&(r.step(new Ut(o-1,s,o,s,new pe(J.from(i.create(null,n.parent.copy())),1,0),1,!0)),n=new ea(r.doc.resolve(n.$from.pos),r.doc.resolve(s),n.depth));let a=no(n);if(a==null)return!1;r.lift(n,a);let l=r.doc.resolve(r.mapping.map(o,-1)-1);return Sn(r.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&r.join(l.pos),e(r.scrollIntoView()),!0}function Oz(t,e,i){let n=t.tr,r=i.parent;for(let p=i.end,f=i.endIndex-1,g=i.startIndex;f>g;f--)p-=r.child(f).nodeSize,n.delete(p-1,p+1);let o=n.doc.resolve(i.start),s=o.nodeAfter;if(n.mapping.map(i.end)!=i.start+o.nodeAfter.nodeSize)return!1;let a=i.startIndex==0,l=i.endIndex==r.childCount,c=o.node(-1),d=o.index(-1);if(!c.canReplace(d+(a?0:1),d+1,s.content.append(l?J.empty:J.from(r))))return!1;let u=o.pos,h=u+s.nodeSize;return n.step(new Ut(u-(a?1:0),h+(l?1:0),u+1,h-1,new pe((a?J.empty:J.from(r.copy(J.empty))).append(l?J.empty:J.from(r.copy(J.empty))),a?0:1,l?0:1),a?0:1)),e(n.scrollIntoView()),!0}function $F(t){return function(e,i){let{$from:n,$to:r}=e.selection,o=n.blockRange(r,c=>c.childCount>0&&c.firstChild.type==t);if(!o)return!1;let s=o.startIndex;if(s==0)return!1;let a=o.parent,l=a.child(s-1);if(l.type!=t)return!1;if(i){let c=l.lastChild&&l.lastChild.type==a.type,d=J.from(c?t.create():null),u=new pe(J.from(t.create(null,J.from(a.type.create(null,d)))),c?3:1,0),h=o.start,p=o.end;i(e.tr.step(new Ut(h-(c?3:1),p,h,p,u,1,!0)).scrollIntoView())}return!0}}var ci=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},Hl=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e},F1=null,oo=function(t,e,i){let n=F1||(F1=document.createRange());return n.setEnd(t,i??t.nodeValue.length),n.setStart(t,e||0),n},Lz=function(){F1=null},da=function(t,e,i,n){return i&&(KF(t,e,i,n,-1)||KF(t,e,i,n,1))},Nz=/^(img|br|input|textarea|hr)$/i;function KF(t,e,i,n,r){for(var o;;){if(t==i&&e==n)return!0;if(e==(r<0?0:En(t))){let s=t.parentNode;if(!s||s.nodeType!=1||xu(t)||Nz.test(t.nodeName)||t.contentEditable=="false")return!1;e=ci(t)+(r<0?0:1),t=s}else if(t.nodeType==1){let s=t.childNodes[e+(r<0?-1:0)];if(s.nodeType==1&&s.contentEditable=="false")if(!((o=s.pmViewDesc)===null||o===void 0)&&o.ignoreForSelection)e+=r;else return!1;else t=s,e=r<0?En(t):0}else return!1}}function En(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Bz(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=En(t)}else if(t.parentNode&&!xu(t))e=ci(t),t=t.parentNode;else return null}}function Hz(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!xu(t))e=ci(t)+1,t=t.parentNode;else return null}}function zz(t,e,i){for(let n=e==0,r=e==En(t);n||r;){if(t==i)return!0;let o=ci(t);if(t=t.parentNode,!t)return!1;n=n&&o==0,r=r&&o==En(t)}}function xu(t){let e;for(let i=t;i&&!(e=i.pmViewDesc);i=i.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}var Gf=function(t){return t.focusNode&&da(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function ra(t,e){let i=document.createEvent("Event");return i.initEvent("keydown",!0,!0),i.keyCode=t,i.key=i.code=e,i}function Vz(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function Gz(t,e,i){if(t.caretPositionFromPoint)try{let n=t.caretPositionFromPoint(e,i);if(n)return{node:n.offsetNode,offset:Math.min(En(n.offsetNode),n.offset)}}catch{}if(t.caretRangeFromPoint){let n=t.caretRangeFromPoint(e,i);if(n)return{node:n.startContainer,offset:Math.min(En(n.startContainer),n.startOffset)}}}var wr=typeof navigator<"u"?navigator:null,YF=typeof document<"u"?document:null,as=wr&&wr.userAgent||"",T1=/Edge\/(\d+)/.exec(as),_6=/MSIE \d/.exec(as),D1=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(as),$i=!!(_6||D1||T1),rs=_6?document.documentMode:D1?+D1[1]:T1?+T1[1]:0,Pn=!$i&&/gecko\/(\d+)/i.test(as);Pn&&+(/Firefox\/(\d+)/.exec(as)||[0,0])[1];var M1=!$i&&/Chrome\/(\d+)/.exec(as),Pi=!!M1,k6=M1?+M1[1]:0,Bi=!$i&&!!wr&&/Apple Computer/.test(wr.vendor),zl=Bi&&(/Mobile\/\w+/.test(as)||!!wr&&wr.maxTouchPoints>2),xn=zl||(wr?/Mac/.test(wr.platform):!1),Wz=wr?/Win/.test(wr.platform):!1,so=/Android \d/.test(as),Eu=!!YF&&"webkitFontSmoothing"in YF.documentElement.style,Uz=Eu?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function jz(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function ro(t,e){return typeof t=="number"?t:t[e]}function qz(t){let e=t.getBoundingClientRect(),i=e.width/t.offsetWidth||1,n=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*i,top:e.top,bottom:e.top+t.clientHeight*n}}function XF(t,e,i){let n=t.someProp("scrollThreshold")||0,r=t.someProp("scrollMargin")||5,o=t.dom.ownerDocument;for(let s=i||t.dom;s;){if(s.nodeType!=1){s=Hl(s);continue}let a=s,l=a==o.body,c=l?jz(o):qz(a),d=0,u=0;if(e.top<c.top+ro(n,"top")?u=-(c.top-e.top+ro(r,"top")):e.bottom>c.bottom-ro(n,"bottom")&&(u=e.bottom-e.top>c.bottom-c.top?e.top+ro(r,"top")-c.top:e.bottom-c.bottom+ro(r,"bottom")),e.left<c.left+ro(n,"left")?d=-(c.left-e.left+ro(r,"left")):e.right>c.right-ro(n,"right")&&(d=e.right-c.right+ro(r,"right")),d||u)if(l)o.defaultView.scrollBy(d,u);else{let p=a.scrollLeft,f=a.scrollTop;u&&(a.scrollTop+=u),d&&(a.scrollLeft+=d);let g=a.scrollLeft-p,m=a.scrollTop-f;e={left:e.left-g,top:e.top-m,right:e.right-g,bottom:e.bottom-m}}let h=l?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(h))break;s=h=="absolute"?s.offsetParent:Hl(s)}}function $z(t){let e=t.dom.getBoundingClientRect(),i=Math.max(0,e.top),n,r;for(let o=(e.left+e.right)/2,s=i+1;s<Math.min(innerHeight,e.bottom);s+=5){let a=t.root.elementFromPoint(o,s);if(!a||a==t.dom||!t.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=i-20){n=a,r=l.top;break}}return{refDOM:n,refTop:r,stack:F6(t.dom)}}function F6(t){let e=[],i=t.ownerDocument;for(let n=t;n&&(e.push({dom:n,top:n.scrollTop,left:n.scrollLeft}),t!=i);n=Hl(n));return e}function Kz({refDOM:t,refTop:e,stack:i}){let n=t?t.getBoundingClientRect().top:0;T6(i,n==0?0:n-e)}function T6(t,e){for(let i=0;i<t.length;i++){let{dom:n,top:r,left:o}=t[i];n.scrollTop!=r+e&&(n.scrollTop=r+e),n.scrollLeft!=o&&(n.scrollLeft=o)}}var Ol=null;function Yz(t){if(t.setActive)return t.setActive();if(Ol)return t.focus(Ol);let e=F6(t);t.focus(Ol==null?{get preventScroll(){return Ol={preventScroll:!0},!0}}:void 0),Ol||(Ol=!1,T6(e,0))}function D6(t,e){let i,n=2e8,r,o=0,s=e.top,a=e.top,l,c;for(let d=t.firstChild,u=0;d;d=d.nextSibling,u++){let h;if(d.nodeType==1)h=d.getClientRects();else if(d.nodeType==3)h=oo(d).getClientRects();else continue;for(let p=0;p<h.length;p++){let f=h[p];if(f.top<=s&&f.bottom>=a){s=Math.max(f.bottom,s),a=Math.min(f.top,a);let g=f.left>e.left?f.left-e.left:f.right<e.left?e.left-f.right:0;if(g<n){i=d,n=g,r=g&&i.nodeType==3?{left:f.right<e.left?f.right:f.left,top:e.top}:e,d.nodeType==1&&g&&(o=u+(e.left>=(f.left+f.right)/2?1:0));continue}}else f.top>e.top&&!l&&f.left<=e.left&&f.right>=e.left&&(l=d,c={left:Math.max(f.left,Math.min(f.right,e.left)),top:f.top});!i&&(e.left>=f.right&&e.top>=f.top||e.left>=f.left&&e.top>=f.bottom)&&(o=u+1)}}return!i&&l&&(i=l,r=c,n=0),i&&i.nodeType==3?Xz(i,r):!i||n&&i.nodeType==1?{node:t,offset:o}:D6(i,r)}function Xz(t,e){let i=t.nodeValue.length,n=document.createRange();for(let r=0;r<i;r++){n.setEnd(t,r+1),n.setStart(t,r);let o=ts(n,1);if(o.top!=o.bottom&&$1(e,o))return{node:t,offset:r+(e.left>=(o.left+o.right)/2?1:0)}}return{node:t,offset:0}}function $1(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function Jz(t,e){let i=t.parentNode;return i&&/^li$/i.test(i.nodeName)&&e.left<t.getBoundingClientRect().left?i:t}function Qz(t,e,i){let{node:n,offset:r}=D6(e,i),o=-1;if(n.nodeType==1&&!n.firstChild){let s=n.getBoundingClientRect();o=s.left!=s.right&&i.left>(s.left+s.right)/2?1:-1}return t.docView.posFromDOM(n,r,o)}function Zz(t,e,i,n){let r=-1;for(let o=e,s=!1;o!=t.dom;){let a=t.docView.nearestDesc(o,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(a.dom.nodeName)&&(!s&&l.left>n.left||l.top>n.top?r=a.posBefore:(!s&&l.right<n.left||l.bottom<n.top)&&(r=a.posAfter),s=!0),!a.contentDOM&&r<0&&!a.node.isText))return(a.node.isBlock?n.top<(l.top+l.bottom)/2:n.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;o=a.dom.parentNode}return r>-1?r:t.docView.posFromDOM(e,i,-1)}function M6(t,e,i){let n=t.childNodes.length;if(n&&i.top<i.bottom)for(let r=Math.max(0,Math.min(n-1,Math.floor(n*(e.top-i.top)/(i.bottom-i.top))-2)),o=r;;){let s=t.childNodes[o];if(s.nodeType==1){let a=s.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if($1(e,c))return M6(s,e,c)}}if((o=(o+1)%n)==r)break}return t}function eV(t,e){let i=t.dom.ownerDocument,n,r=0,o=Gz(i,e.left,e.top);o&&({node:n,offset:r}=o);let s=(t.root.elementFromPoint?t.root:i).elementFromPoint(e.left,e.top),a;if(!s||!t.dom.contains(s.nodeType!=1?s.parentNode:s)){let c=t.dom.getBoundingClientRect();if(!$1(e,c)||(s=M6(t.dom,e,c),!s))return null}if(Bi)for(let c=s;n&&c;c=Hl(c))c.draggable&&(n=void 0);if(s=Jz(s,e),n){if(Pn&&n.nodeType==1&&(r=Math.min(r,n.childNodes.length),r<n.childNodes.length)){let d=n.childNodes[r],u;d.nodeName=="IMG"&&(u=d.getBoundingClientRect()).right<=e.left&&u.bottom>e.top&&r++}let c;Eu&&r&&n.nodeType==1&&(c=n.childNodes[r-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&r--,n==t.dom&&r==n.childNodes.length-1&&n.lastChild.nodeType==1&&e.top>n.lastChild.getBoundingClientRect().bottom?a=t.state.doc.content.size:(r==0||n.nodeType!=1||n.childNodes[r-1].nodeName!="BR")&&(a=Zz(t,n,r,e))}a==null&&(a=Qz(t,s,e));let l=t.docView.nearestDesc(s,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function JF(t){return t.top<t.bottom||t.left<t.right}function ts(t,e){let i=t.getClientRects();if(i.length){let n=i[e<0?0:i.length-1];if(JF(n))return n}return Array.prototype.find.call(i,JF)||t.getBoundingClientRect()}var tV=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function I6(t,e,i){let{node:n,offset:r,atom:o}=t.docView.domFromPos(e,i<0?-1:1),s=Eu||Pn;if(n.nodeType==3)if(s&&(tV.test(n.nodeValue)||(i<0?!r:r==n.nodeValue.length))){let l=ts(oo(n,r,r),i);if(Pn&&r&&/\s/.test(n.nodeValue[r-1])&&r<n.nodeValue.length){let c=ts(oo(n,r-1,r-1),-1);if(c.top==l.top){let d=ts(oo(n,r,r+1),-1);if(d.top!=l.top)return mu(d,d.left<c.left)}}return l}else{let l=r,c=r,d=i<0?1:-1;return i<0&&!r?(c++,d=-1):i>=0&&r==n.nodeValue.length?(l--,d=1):i<0?l--:c++,mu(ts(oo(n,l,c),d),d<0)}if(!t.state.doc.resolve(e-(o||0)).parent.inlineContent){if(o==null&&r&&(i<0||r==En(n))){let l=n.childNodes[r-1];if(l.nodeType==1)return E1(l.getBoundingClientRect(),!1)}if(o==null&&r<En(n)){let l=n.childNodes[r];if(l.nodeType==1)return E1(l.getBoundingClientRect(),!0)}return E1(n.getBoundingClientRect(),i>=0)}if(o==null&&r&&(i<0||r==En(n))){let l=n.childNodes[r-1],c=l.nodeType==3?oo(l,En(l)-(s?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return mu(ts(c,1),!1)}if(o==null&&r<En(n)){let l=n.childNodes[r];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?oo(l,0,s?0:1):l.nodeType==1?l:null:null;if(c)return mu(ts(c,-1),!0)}return mu(ts(n.nodeType==3?oo(n):n,-i),i>=0)}function mu(t,e){if(t.width==0)return t;let i=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:i,right:i}}function E1(t,e){if(t.height==0)return t;let i=e?t.top:t.bottom;return{top:i,bottom:i,left:t.left,right:t.right}}function A6(t,e,i){let n=t.state,r=t.root.activeElement;n!=e&&t.updateState(e),r!=t.dom&&t.focus();try{return i()}finally{n!=e&&t.updateState(n),r!=t.dom&&r&&r.focus()}}function iV(t,e,i){let n=e.selection,r=i=="up"?n.$from:n.$to;return A6(t,e,()=>{let{node:o}=t.docView.domFromPos(r.pos,i=="up"?-1:1);for(;;){let a=t.docView.nearestDesc(o,!0);if(!a)break;if(a.node.isBlock){o=a.contentDOM||a.dom;break}o=a.dom.parentNode}let s=I6(t,r.pos,1);for(let a=o.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=oo(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let d=l[c];if(d.bottom>d.top+1&&(i=="up"?s.top-d.top>(d.bottom-s.top)*2:d.bottom-s.bottom>(s.bottom-d.top)*2))return!1}}return!0})}var nV=/[\u0590-\u08ac]/;function rV(t,e,i){let{$head:n}=e.selection;if(!n.parent.isTextblock)return!1;let r=n.parentOffset,o=!r,s=r==n.parent.content.size,a=t.domSelection();return a?!nV.test(n.parent.textContent)||!a.modify?i=="left"||i=="backward"?o:s:A6(t,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:d,anchorOffset:u}=t.domSelectionRange(),h=a.caretBidiLevel;a.modify("move",i,"character");let p=n.depth?t.docView.domAfterPos(n.before()):t.dom,{focusNode:f,focusOffset:g}=t.domSelectionRange(),m=f&&!p.contains(f.nodeType==1?f:f.parentNode)||l==f&&c==g;try{a.collapse(d,u),l&&(l!=d||c!=u)&&a.extend&&a.extend(l,c)}catch{}return h!=null&&(a.caretBidiLevel=h),m}):n.pos==n.start()||n.pos==n.end()}var QF=null,ZF=null,e6=!1;function oV(t,e,i){return QF==e&&ZF==i?e6:(QF=e,ZF=i,e6=i=="up"||i=="down"?iV(t,e,i):rV(t,e,i))}var Rn=0,t6=1,oa=2,br=3,ua=class{constructor(e,i,n,r){this.parent=e,this.children=i,this.dom=n,this.contentDOM=r,this.dirty=Rn,n.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,i,n){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let i=0;i<this.children.length;i++)e+=this.children[i].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let i=0,n=this.posAtStart;;i++){let r=this.children[i];if(r==e)return n;n+=r.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,i,n){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(n<0){let o,s;if(e==this.contentDOM)o=e.childNodes[i-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(s)+s.size:this.posAtStart}else{let o,s;if(e==this.contentDOM)o=e.childNodes[i];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.nextSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(s):this.posAtEnd}let r;if(e==this.dom&&this.contentDOM)r=i>ci(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))r=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(i==0)for(let o=e;;o=o.parentNode){if(o==this.dom){r=!1;break}if(o.previousSibling)break}if(r==null&&i==e.childNodes.length)for(let o=e;;o=o.parentNode){if(o==this.dom){r=!0;break}if(o.nextSibling)break}}return r??n>0?this.posAtEnd:this.posAtStart}nearestDesc(e,i=!1){for(let n=!0,r=e;r;r=r.parentNode){let o=this.getDesc(r),s;if(o&&(!i||o.node))if(n&&(s=o.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))n=!1;else return o}}getDesc(e){let i=e.pmViewDesc;for(let n=i;n;n=n.parent)if(n==this)return i}posFromDOM(e,i,n){for(let r=e;r;r=r.parentNode){let o=this.getDesc(r);if(o)return o.localPosFromDOM(e,i,n)}return-1}descAt(e){for(let i=0,n=0;i<this.children.length;i++){let r=this.children[i],o=n+r.size;if(n==e&&o!=n){for(;!r.border&&r.children.length;)for(let s=0;s<r.children.length;s++){let a=r.children[s];if(a.size){r=a;break}}return r}if(e<o)return r.descAt(e-n-r.border);n=o}}domFromPos(e,i){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let n=0,r=0;for(let o=0;n<this.children.length;n++){let s=this.children[n],a=o+s.size;if(a>e||s instanceof Af){r=e-o;break}o=a}if(r)return this.children[n].domFromPos(r-this.children[n].border,i);for(let o;n&&!(o=this.children[n-1]).size&&o instanceof Mf&&o.side>=0;n--);if(i<=0){let o,s=!0;for(;o=n?this.children[n-1]:null,!(!o||o.dom.parentNode==this.contentDOM);n--,s=!1);return o&&i&&s&&!o.border&&!o.domAtom?o.domFromPos(o.size,i):{node:this.contentDOM,offset:o?ci(o.dom)+1:0}}else{let o,s=!0;for(;o=n<this.children.length?this.children[n]:null,!(!o||o.dom.parentNode==this.contentDOM);n++,s=!1);return o&&s&&!o.border&&!o.domAtom?o.domFromPos(0,i):{node:this.contentDOM,offset:o?ci(o.dom):this.contentDOM.childNodes.length}}}parseRange(e,i,n=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:i,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let r=-1,o=-1;for(let s=n,a=0;;a++){let l=this.children[a],c=s+l.size;if(r==-1&&e<=c){let d=s+l.border;if(e>=d&&i<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,i,d);e=s;for(let u=a;u>0;u--){let h=this.children[u-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){r=ci(h.dom)+1;break}e-=h.size}r==-1&&(r=0)}if(r>-1&&(c>i||a==this.children.length-1)){i=c;for(let d=a+1;d<this.children.length;d++){let u=this.children[d];if(u.size&&u.dom.parentNode==this.contentDOM&&!u.emptyChildAt(-1)){o=ci(u.dom);break}i+=u.size}o==-1&&(o=this.contentDOM.childNodes.length);break}s=c}return{node:this.contentDOM,from:e,to:i,fromOffset:r,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let i=this.children[e<0?0:this.children.length-1];return i.size==0||i.emptyChildAt(e)}domAfterPos(e){let{node:i,offset:n}=this.domFromPos(e,0);if(i.nodeType!=1||n==i.childNodes.length)throw new RangeError("No node after pos "+e);return i.childNodes[n]}setSelection(e,i,n,r=!1){let o=Math.min(e,i),s=Math.max(e,i);for(let p=0,f=0;p<this.children.length;p++){let g=this.children[p],m=f+g.size;if(o>f&&s<m)return g.setSelection(e-f-g.border,i-f-g.border,n,r);f=m}let a=this.domFromPos(e,e?-1:1),l=i==e?a:this.domFromPos(i,i?-1:1),c=n.root.getSelection(),d=n.domSelectionRange(),u=!1;if((Pn||Bi)&&e==i){let{node:p,offset:f}=a;if(p.nodeType==3){if(u=!!(f&&p.nodeValue[f-1]==`
`),u&&f==p.nodeValue.length)for(let g=p,m;g;g=g.parentNode){if(m=g.nextSibling){m.nodeName=="BR"&&(a=l={node:m.parentNode,offset:ci(m)+1});break}let v=g.pmViewDesc;if(v&&v.node&&v.node.isBlock)break}}else{let g=p.childNodes[f-1];u=g&&(g.nodeName=="BR"||g.contentEditable=="false")}}if(Pn&&d.focusNode&&d.focusNode!=l.node&&d.focusNode.nodeType==1){let p=d.focusNode.childNodes[d.focusOffset];p&&p.contentEditable=="false"&&(r=!0)}if(!(r||u&&Bi)&&da(a.node,a.offset,d.anchorNode,d.anchorOffset)&&da(l.node,l.offset,d.focusNode,d.focusOffset))return;let h=!1;if((c.extend||e==i)&&!(u&&Pn)){c.collapse(a.node,a.offset);try{e!=i&&c.extend(l.node,l.offset),h=!0}catch{}}if(!h){if(e>i){let f=a;a=l,l=f}let p=document.createRange();p.setEnd(l.node,l.offset),p.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(p)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,i){for(let n=0,r=0;r<this.children.length;r++){let o=this.children[r],s=n+o.size;if(n==s?e<=s&&i>=n:e<s&&i>n){let a=n+o.border,l=s-o.border;if(e>=a&&i<=l){this.dirty=e==n||i==s?oa:t6,e==a&&i==l&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=br:o.markDirty(e-a,i-a);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?oa:br}n=s}this.dirty=oa}markParentsDirty(){let e=1;for(let i=this.parent;i;i=i.parent,e++){let n=e==1?oa:t6;i.dirty<n&&(i.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}},Mf=class extends ua{constructor(e,i,n,r){let o,s=i.type.toDOM;if(typeof s=="function"&&(s=s(n,()=>{if(!o)return r;if(o.parent)return o.parent.posBeforeChild(o)})),!i.type.spec.raw){if(s.nodeType!=1){let a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=i,this.widget=i,o=this}matchesWidget(e){return this.dirty==Rn&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let i=this.widget.spec.stopEvent;return i?i(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}},I1=class extends ua{constructor(e,i,n,r){super(e,[],i,null),this.textDOM=n,this.text=r}get size(){return this.text.length}localPosFromDOM(e,i){return e!=this.textDOM?this.posAtStart+(i?this.size:0):this.posAtStart+i}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}},Vl=class t extends ua{constructor(e,i,n,r,o){super(e,[],n,r),this.mark=i,this.spec=o}static create(e,i,n,r){let o=r.nodeViews[i.type.name],s=o&&o(i,r,n);return(!s||!s.dom)&&(s=eo.renderSpec(document,i.type.spec.toDOM(i,n),null,i.attrs)),new t(e,i,s.dom,s.contentDOM||s.dom,s)}parseRule(){return this.dirty&br||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=br&&this.mark.eq(e)}markDirty(e,i){if(super.markDirty(e,i),this.dirty!=Rn){let n=this.parent;for(;!n.node;)n=n.parent;n.dirty<this.dirty&&(n.dirty=this.dirty),this.dirty=Rn}}slice(e,i,n){let r=t.create(this.parent,this.mark,!0,n),o=this.children,s=this.size;i<s&&(o=N1(o,i,s,n)),e>0&&(o=N1(o,0,e,n));for(let a=0;a<o.length;a++)o[a].parent=r;return r.children=o,r}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}},ss=class t extends ua{constructor(e,i,n,r,o,s,a,l,c){super(e,[],o,s),this.node=i,this.outerDeco=n,this.innerDeco=r,this.nodeDOM=a}static create(e,i,n,r,o,s){let a=o.nodeViews[i.type.name],l,c=a&&a(i,o,()=>{if(!l)return s;if(l.parent)return l.parent.posBeforeChild(l)},n,r),d=c&&c.dom,u=c&&c.contentDOM;if(i.isText){if(!d)d=document.createTextNode(i.text);else if(d.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else d||({dom:d,contentDOM:u}=eo.renderSpec(document,i.type.spec.toDOM(i),null,i.attrs));!u&&!i.isText&&d.nodeName!="BR"&&(d.hasAttribute("contenteditable")||(d.contentEditable="false"),i.type.spec.draggable&&(d.draggable=!0));let h=d;return d=N6(d,n,i),c?l=new A1(e,i,n,r,d,u||null,h,c,o,s+1):i.isText?new If(e,i,n,r,d,h,o):new t(e,i,n,r,d,u||null,h,o,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let i=this.children.length-1;i>=0;i--){let n=this.children[i];if(this.dom.contains(n.dom.parentNode)){e.contentElement=n.dom.parentNode;break}}e.contentElement||(e.getContent=()=>J.empty)}return e}matchesNode(e,i,n){return this.dirty==Rn&&e.eq(this.node)&&Of(i,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,i){let n=this.node.inlineContent,r=i,o=e.composing?this.localCompositionInfo(e,i):null,s=o&&o.pos>-1?o:null,a=o&&o.pos<0,l=new L1(this,s&&s.node,e);cV(this.node,this.innerDeco,(c,d,u)=>{c.spec.marks?l.syncToMarks(c.spec.marks,n,e):c.type.side>=0&&!u&&l.syncToMarks(d==this.node.childCount?ct.none:this.node.child(d).marks,n,e),l.placeWidget(c,e,r)},(c,d,u,h)=>{l.syncToMarks(c.marks,n,e);let p;l.findNodeMatch(c,d,u,h)||a&&e.state.selection.from>r&&e.state.selection.to<r+c.nodeSize&&(p=l.findIndexWithChild(o.node))>-1&&l.updateNodeAt(c,d,u,p,e)||l.updateNextNode(c,d,u,e,h,r)||l.addNode(c,d,u,e,r),r+=c.nodeSize}),l.syncToMarks([],n,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==oa)&&(s&&this.protectLocalComposition(e,s),O6(this.contentDOM,this.children,e),zl&&dV(this.dom))}localCompositionInfo(e,i){let{from:n,to:r}=e.state.selection;if(!(e.state.selection instanceof Pe)||n<i||r>i+this.node.content.size)return null;let o=e.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let s=o.nodeValue,a=uV(this.node.content,s,n-i,r-i);return a<0?null:{node:o,pos:a,text:s}}else return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:i,pos:n,text:r}){if(this.getDesc(i))return;let o=i;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let s=new I1(this,o,i,r);e.input.compositionNodes.push(s),this.children=N1(this.children,n,n+r.length,e,s)}update(e,i,n,r){return this.dirty==br||!e.sameMarkup(this.node)?!1:(this.updateInner(e,i,n,r),!0)}updateInner(e,i,n,r){this.updateOuterDeco(i),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=Rn}updateOuterDeco(e){if(Of(e,this.outerDeco))return;let i=this.nodeDOM.nodeType!=1,n=this.dom;this.dom=L6(this.dom,this.nodeDOM,O1(this.outerDeco,this.node,i),O1(e,this.node,i)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}};function i6(t,e,i,n,r){N6(n,e,t);let o=new ss(void 0,t,e,i,n,n,n,r,0);return o.contentDOM&&o.updateChildren(r,0),o}var If=class t extends ss{constructor(e,i,n,r,o,s,a){super(e,i,n,r,o,null,s,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,i,n,r){return this.dirty==br||this.dirty!=Rn&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(i),(this.dirty!=Rn||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=e,this.dirty=Rn,!0)}inParent(){let e=this.parent.contentDOM;for(let i=this.nodeDOM;i;i=i.parentNode)if(i==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,i,n){return e==this.nodeDOM?this.posAtStart+Math.min(i,this.node.text.length):super.localPosFromDOM(e,i,n)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,i,n){let r=this.node.cut(e,i),o=document.createTextNode(r.text);return new t(this.parent,r,this.outerDeco,this.innerDeco,o,o,n)}markDirty(e,i){super.markDirty(e,i),this.dom!=this.nodeDOM&&(e==0||i==this.nodeDOM.nodeValue.length)&&(this.dirty=br)}get domAtom(){return!1}isText(e){return this.node.text==e}},Af=class extends ua{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==Rn&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}},A1=class extends ss{constructor(e,i,n,r,o,s,a,l,c,d){super(e,i,n,r,o,s,a,c,d),this.spec=l}update(e,i,n,r){if(this.dirty==br)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let o=this.spec.update(e,i,n);return o&&this.updateInner(e,i,n,r),o}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,i,n,r)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,i,n,r){this.spec.setSelection?this.spec.setSelection(e,i,n.root):super.setSelection(e,i,n,r)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}};function O6(t,e,i){let n=t.firstChild,r=!1;for(let o=0;o<e.length;o++){let s=e[o],a=s.dom;if(a.parentNode==t){for(;a!=n;)n=n6(n),r=!0;n=n.nextSibling}else r=!0,t.insertBefore(a,n);if(s instanceof Vl){let l=n?n.previousSibling:t.lastChild;O6(s.contentDOM,s.children,i),n=l?l.nextSibling:t.firstChild}}for(;n;)n=n6(n),r=!0;r&&i.trackWrites==t&&(i.trackWrites=null)}var vu=function(t){t&&(this.nodeName=t)};vu.prototype=Object.create(null);var sa=[new vu];function O1(t,e,i){if(t.length==0)return sa;let n=i?sa[0]:new vu,r=[n];for(let o=0;o<t.length;o++){let s=t[o].type.attrs;if(s){s.nodeName&&r.push(n=new vu(s.nodeName));for(let a in s){let l=s[a];l!=null&&(i&&r.length==1&&r.push(n=new vu(e.isInline?"span":"div")),a=="class"?n.class=(n.class?n.class+" ":"")+l:a=="style"?n.style=(n.style?n.style+";":"")+l:a!="nodeName"&&(n[a]=l))}}}return r}function L6(t,e,i,n){if(i==sa&&n==sa)return e;let r=e;for(let o=0;o<n.length;o++){let s=n[o],a=i[o];if(o){let l;a&&a.nodeName==s.nodeName&&r!=t&&(l=r.parentNode)&&l.nodeName.toLowerCase()==s.nodeName||(l=document.createElement(s.nodeName),l.pmIsDeco=!0,l.appendChild(r),a=sa[0]),r=l}sV(r,a||sa[0],s)}return r}function sV(t,e,i){for(let n in e)n!="class"&&n!="style"&&n!="nodeName"&&!(n in i)&&t.removeAttribute(n);for(let n in i)n!="class"&&n!="style"&&n!="nodeName"&&i[n]!=e[n]&&t.setAttribute(n,i[n]);if(e.class!=i.class){let n=e.class?e.class.split(" ").filter(Boolean):[],r=i.class?i.class.split(" ").filter(Boolean):[];for(let o=0;o<n.length;o++)r.indexOf(n[o])==-1&&t.classList.remove(n[o]);for(let o=0;o<r.length;o++)n.indexOf(r[o])==-1&&t.classList.add(r[o]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=i.style){if(e.style){let n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,r;for(;r=n.exec(e.style);)t.style.removeProperty(r[1])}i.style&&(t.style.cssText+=i.style)}}function N6(t,e,i){return L6(t,t,sa,O1(e,i,t.nodeType!=1))}function Of(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(!t[i].type.eq(e[i].type))return!1;return!0}function n6(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}var L1=class{constructor(e,i,n){this.lock=i,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=aV(e.node.content,e)}destroyBetween(e,i){if(e!=i){for(let n=e;n<i;n++)this.top.children[n].destroy();this.top.children.splice(e,i-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,i,n){let r=0,o=this.stack.length>>1,s=Math.min(o,e.length);for(;r<s&&(r==o-1?this.top:this.stack[r+1<<1]).matchesMark(e[r])&&e[r].type.spec.spanning!==!1;)r++;for(;r<o;)this.destroyRest(),this.top.dirty=Rn,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(e[o])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=Vl.create(this.top,e[o],i,n);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,o++}}findNodeMatch(e,i,n,r){let o=-1,s;if(r>=this.preMatch.index&&(s=this.preMatch.matches[r-this.preMatch.index]).parent==this.top&&s.matchesNode(e,i,n))o=this.top.children.indexOf(s,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,i,n)&&!this.preMatch.matched.has(c)){o=a;break}}return o<0?!1:(this.destroyBetween(this.index,o),this.index++,!0)}updateNodeAt(e,i,n,r,o){let s=this.top.children[r];return s.dirty==br&&s.dom==s.contentDOM&&(s.dirty=oa),s.update(e,i,n,o)?(this.destroyBetween(this.index,r),this.index++,!0):!1}findIndexWithChild(e){for(;;){let i=e.parentNode;if(!i)return-1;if(i==this.top.contentDOM){let n=e.pmViewDesc;if(n){for(let r=this.index;r<this.top.children.length;r++)if(this.top.children[r]==n)return r}return-1}e=i}}updateNextNode(e,i,n,r,o,s){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof ss){let c=this.preMatch.matched.get(l);if(c!=null&&c!=o)return!1;let d=l.dom,u,h=this.isLocked(d)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=br&&Of(i,l.outerDeco));if(!h&&l.update(e,i,n,r))return this.destroyBetween(this.index,a),l.dom!=d&&(this.changed=!0),this.index++,!0;if(!h&&(u=this.recreateWrapper(l,e,i,n,r,s)))return this.destroyBetween(this.index,a),this.top.children[this.index]=u,u.contentDOM&&(u.dirty=oa,u.updateChildren(r,s+1),u.dirty=Rn),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,i,n,r,o,s){if(e.dirty||i.isAtom||!e.children.length||!e.node.content.eq(i.content)||!Of(n,e.outerDeco)||!r.eq(e.innerDeco))return null;let a=ss.create(this.top,i,n,r,o,s);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,i,n,r,o){let s=ss.create(this.top,e,i,n,r,o);s.contentDOM&&s.updateChildren(r,o+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,i,n){let r=this.index<this.top.children.length?this.top.children[this.index]:null;if(r&&r.matchesWidget(e)&&(e==r.widget||!r.widget.type.toDOM.parentNode))this.index++;else{let o=new Mf(this.top,e,i,n);this.top.children.splice(this.index++,0,o),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],i=this.top;for(;e instanceof Vl;)i=e,e=i.children[i.children.length-1];(!e||!(e instanceof If)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Bi||Pi)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",i),this.addHackNode("BR",this.top))}addHackNode(e,i){if(i==this.top&&this.index<i.children.length&&i.children[this.index].matchesHack(e))this.index++;else{let n=document.createElement(e);e=="IMG"&&(n.className="ProseMirror-separator",n.alt=""),e=="BR"&&(n.className="ProseMirror-trailingBreak");let r=new Af(this.top,[],n,null);i!=this.top?i.children.push(r):i.children.splice(this.index++,0,r),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}};function aV(t,e){let i=e,n=i.children.length,r=t.childCount,o=new Map,s=[];e:for(;r>0;){let a;for(;;)if(n){let c=i.children[n-1];if(c instanceof Vl)i=c,n=c.children.length;else{a=c,n--;break}}else{if(i==e)break e;n=i.parent.children.indexOf(i),i=i.parent}let l=a.node;if(l){if(l!=t.child(r-1))break;--r,o.set(a,r),s.push(a)}}return{index:r,matched:o,matches:s.reverse()}}function lV(t,e){return t.type.side-e.type.side}function cV(t,e,i,n){let r=e.locals(t),o=0;if(r.length==0){for(let c=0;c<t.childCount;c++){let d=t.child(c);n(d,r,e.forChild(o,d),c),o+=d.nodeSize}return}let s=0,a=[],l=null;for(let c=0;;){let d,u;for(;s<r.length&&r[s].to==o;){let m=r[s++];m.widget&&(d?(u||(u=[d])).push(m):d=m)}if(d)if(u){u.sort(lV);for(let m=0;m<u.length;m++)i(u[m],c,!!l)}else i(d,c,!!l);let h,p;if(l)p=-1,h=l,l=null;else if(c<t.childCount)p=c,h=t.child(c++);else break;for(let m=0;m<a.length;m++)a[m].to<=o&&a.splice(m--,1);for(;s<r.length&&r[s].from<=o&&r[s].to>o;)a.push(r[s++]);let f=o+h.nodeSize;if(h.isText){let m=f;s<r.length&&r[s].from<m&&(m=r[s].from);for(let v=0;v<a.length;v++)a[v].to<m&&(m=a[v].to);m<f&&(l=h.cut(m-o),h=h.cut(0,m-o),f=m,p=-1)}else for(;s<r.length&&r[s].to<f;)s++;let g=h.isInline&&!h.isLeaf?a.filter(m=>!m.inline):a.slice();n(h,g,e.forChild(o,h),p),o=f}}function dV(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function uV(t,e,i,n){for(let r=0,o=0;r<t.childCount&&o<=n;){let s=t.child(r++),a=o;if(o+=s.nodeSize,!s.isText)continue;let l=s.text;for(;r<t.childCount;){let c=t.child(r++);if(o+=c.nodeSize,!c.isText)break;l+=c.text}if(o>=i){if(o>=n&&l.slice(n-e.length-a,n-a)==e)return n-e.length;let c=a<n?l.lastIndexOf(e,n-a-1):-1;if(c>=0&&c+e.length+a>=i)return a+c;if(i==n&&l.length>=n+e.length-a&&l.slice(n-a,n-a+e.length)==e)return n}}return-1}function N1(t,e,i,n,r){let o=[];for(let s=0,a=0;s<t.length;s++){let l=t[s],c=a,d=a+=l.size;c>=i||d<=e?o.push(l):(c<e&&o.push(l.slice(0,e-c,n)),r&&(o.push(r),r=void 0),d>i&&o.push(l.slice(i-c,l.size,n)))}return o}function K1(t,e=null){let i=t.domSelectionRange(),n=t.state.doc;if(!i.focusNode)return null;let r=t.docView.nearestDesc(i.focusNode),o=r&&r.size==0,s=t.docView.posFromDOM(i.focusNode,i.focusOffset,1);if(s<0)return null;let a=n.resolve(s),l,c;if(Gf(i)){for(l=s;r&&!r.node;)r=r.parent;let u=r.node;if(r&&u.isAtom&&ye.isSelectable(u)&&r.parent&&!(u.isInline&&zz(i.focusNode,i.focusOffset,r.dom))){let h=r.posBefore;c=new ye(s==h?a:n.resolve(h))}}else{if(i instanceof t.dom.ownerDocument.defaultView.Selection&&i.rangeCount>1){let u=s,h=s;for(let p=0;p<i.rangeCount;p++){let f=i.getRangeAt(p);u=Math.min(u,t.docView.posFromDOM(f.startContainer,f.startOffset,1)),h=Math.max(h,t.docView.posFromDOM(f.endContainer,f.endOffset,-1))}if(u<0)return null;[l,s]=h==t.state.selection.anchor?[h,u]:[u,h],a=n.resolve(s)}else l=t.docView.posFromDOM(i.anchorNode,i.anchorOffset,1);if(l<0)return null}let d=n.resolve(l);if(!c){let u=e=="pointer"||t.state.selection.head<a.pos&&!o?1:-1;c=Y1(t,d,a,u)}return c}function B6(t){return t.editable?t.hasFocus():z6(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function ao(t,e=!1){let i=t.state.selection;if(H6(t,i),!!B6(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&Pi){let n=t.domSelectionRange(),r=t.domObserver.currentSelection;if(n.anchorNode&&r.anchorNode&&da(n.anchorNode,n.anchorOffset,r.anchorNode,r.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)pV(t);else{let{anchor:n,head:r}=i,o,s;r6&&!(i instanceof Pe)&&(i.$from.parent.inlineContent||(o=o6(t,i.from)),!i.empty&&!i.$from.parent.inlineContent&&(s=o6(t,i.to))),t.docView.setSelection(n,r,t,e),r6&&(o&&s6(o),s&&s6(s)),i.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&hV(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}var r6=Bi||Pi&&k6<63;function o6(t,e){let{node:i,offset:n}=t.docView.domFromPos(e,0),r=n<i.childNodes.length?i.childNodes[n]:null,o=n?i.childNodes[n-1]:null;if(Bi&&r&&r.contentEditable=="false")return P1(r);if((!r||r.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(r)return P1(r);if(o)return P1(o)}}function P1(t){return t.contentEditable="true",Bi&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function s6(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function hV(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let i=t.domSelectionRange(),n=i.anchorNode,r=i.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(i.anchorNode!=n||i.anchorOffset!=r)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!B6(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function pV(t){let e=t.domSelection();if(!e)return;let i=t.cursorWrapper.dom,n=i.nodeName=="IMG";n?e.collapse(i.parentNode,ci(i)+1):e.collapse(i,0),!n&&!t.state.selection.visible&&$i&&rs<=11&&(i.disabled=!0,i.disabled=!1)}function H6(t,e){if(e instanceof ye){let i=t.docView.descAt(e.from);i!=t.lastSelectedViewDesc&&(a6(t),i&&i.selectNode(),t.lastSelectedViewDesc=i)}else a6(t)}function a6(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function Y1(t,e,i,n){return t.someProp("createSelectionBetween",r=>r(t,e,i))||Pe.between(e,i,n)}function l6(t){return t.editable&&!t.hasFocus()?!1:z6(t)}function z6(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function fV(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),i=t.domSelectionRange();return da(e.node,e.offset,i.anchorNode,i.anchorOffset)}function B1(t,e){let{$anchor:i,$head:n}=t.selection,r=e>0?i.max(n):i.min(n),o=r.parent.inlineContent?r.depth?t.doc.resolve(e>0?r.after():r.before()):null:r;return o&&ke.findFrom(o,e)}function is(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function c6(t,e,i){let n=t.state.selection;if(n instanceof Pe)if(i.indexOf("s")>-1){let{$head:r}=n,o=r.textOffset?null:e<0?r.nodeBefore:r.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let s=t.state.doc.resolve(r.pos+o.nodeSize*(e<0?-1:1));return is(t,new Pe(n.$anchor,s))}else if(n.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let r=B1(t.state,e);return r&&r instanceof ye?is(t,r):!1}else if(!(xn&&i.indexOf("m")>-1)){let r=n.$head,o=r.textOffset?null:e<0?r.nodeBefore:r.nodeAfter,s;if(!o||o.isText)return!1;let a=e<0?r.pos-o.nodeSize:r.pos;return o.isAtom||(s=t.docView.descAt(a))&&!s.contentDOM?ye.isSelectable(o)?is(t,new ye(e<0?t.state.doc.resolve(r.pos-o.nodeSize):r)):Eu?is(t,new Pe(t.state.doc.resolve(e<0?a:a+o.nodeSize))):!1:!1}}else return!1;else{if(n instanceof ye&&n.node.isInline)return is(t,new Pe(e>0?n.$to:n.$from));{let r=B1(t.state,e);return r?is(t,r):!1}}}function Lf(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Cu(t,e){let i=t.pmViewDesc;return i&&i.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function Ll(t,e){return e<0?gV(t):mV(t)}function gV(t){let e=t.domSelectionRange(),i=e.focusNode,n=e.focusOffset;if(!i)return;let r,o,s=!1;for(Pn&&i.nodeType==1&&n<Lf(i)&&Cu(i.childNodes[n],-1)&&(s=!0);;)if(n>0){if(i.nodeType!=1)break;{let a=i.childNodes[n-1];if(Cu(a,-1))r=i,o=--n;else if(a.nodeType==3)i=a,n=i.nodeValue.length;else break}}else{if(V6(i))break;{let a=i.previousSibling;for(;a&&Cu(a,-1);)r=i.parentNode,o=ci(a),a=a.previousSibling;if(a)i=a,n=Lf(i);else{if(i=i.parentNode,i==t.dom)break;n=0}}}s?H1(t,i,n):r&&H1(t,r,o)}function mV(t){let e=t.domSelectionRange(),i=e.focusNode,n=e.focusOffset;if(!i)return;let r=Lf(i),o,s;for(;;)if(n<r){if(i.nodeType!=1)break;let a=i.childNodes[n];if(Cu(a,1))o=i,s=++n;else break}else{if(V6(i))break;{let a=i.nextSibling;for(;a&&Cu(a,1);)o=a.parentNode,s=ci(a)+1,a=a.nextSibling;if(a)i=a,n=0,r=Lf(i);else{if(i=i.parentNode,i==t.dom)break;n=r=0}}}o&&H1(t,o,s)}function V6(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function vV(t,e){for(;t&&e==t.childNodes.length&&!xu(t);)e=ci(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let i=t.childNodes[e];if(i.nodeType==3)return i;if(i.nodeType==1&&i.contentEditable=="false")break;t=i,e=0}}function CV(t,e){for(;t&&!e&&!xu(t);)e=ci(t),t=t.parentNode;for(;t&&e;){let i=t.childNodes[e-1];if(i.nodeType==3)return i;if(i.nodeType==1&&i.contentEditable=="false")break;t=i,e=t.childNodes.length}}function H1(t,e,i){if(e.nodeType!=3){let o,s;(s=vV(e,i))?(e=s,i=0):(o=CV(e,i))&&(e=o,i=o.nodeValue.length)}let n=t.domSelection();if(!n)return;if(Gf(n)){let o=document.createRange();o.setEnd(e,i),o.setStart(e,i),n.removeAllRanges(),n.addRange(o)}else n.extend&&n.extend(e,i);t.domObserver.setCurSelection();let{state:r}=t;setTimeout(()=>{t.state==r&&ao(t)},50)}function d6(t,e){let i=t.state.doc.resolve(e);if(!(Pi||Wz)&&i.parent.inlineContent){let r=t.coordsAtPos(e);if(e>i.start()){let o=t.coordsAtPos(e-1),s=(o.top+o.bottom)/2;if(s>r.top&&s<r.bottom&&Math.abs(o.left-r.left)>1)return o.left<r.left?"ltr":"rtl"}if(e<i.end()){let o=t.coordsAtPos(e+1),s=(o.top+o.bottom)/2;if(s>r.top&&s<r.bottom&&Math.abs(o.left-r.left)>1)return o.left>r.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function u6(t,e,i){let n=t.state.selection;if(n instanceof Pe&&!n.empty||i.indexOf("s")>-1||xn&&i.indexOf("m")>-1)return!1;let{$from:r,$to:o}=n;if(!r.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let s=B1(t.state,e);if(s&&s instanceof ye)return is(t,s)}if(!r.parent.inlineContent){let s=e<0?r:o,a=n instanceof Ni?ke.near(s,e):ke.findFrom(s,e);return a?is(t,a):!1}return!1}function h6(t,e){if(!(t.state.selection instanceof Pe))return!0;let{$head:i,$anchor:n,empty:r}=t.state.selection;if(!i.sameParent(n))return!0;if(!r)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let o=!i.textOffset&&(e<0?i.nodeBefore:i.nodeAfter);if(o&&!o.isText){let s=t.state.tr;return e<0?s.delete(i.pos-o.nodeSize,i.pos):s.delete(i.pos,i.pos+o.nodeSize),t.dispatch(s),!0}return!1}function p6(t,e,i){t.domObserver.stop(),e.contentEditable=i,t.domObserver.start()}function wV(t){if(!Bi||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:i}=t.domSelectionRange();if(e&&e.nodeType==1&&i==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let n=e.firstChild;p6(t,n,"true"),setTimeout(()=>p6(t,n,"false"),20)}return!1}function bV(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function yV(t,e){let i=e.keyCode,n=bV(e);if(i==8||xn&&i==72&&n=="c")return h6(t,-1)||Ll(t,-1);if(i==46&&!e.shiftKey||xn&&i==68&&n=="c")return h6(t,1)||Ll(t,1);if(i==13||i==27)return!0;if(i==37||xn&&i==66&&n=="c"){let r=i==37?d6(t,t.state.selection.from)=="ltr"?-1:1:-1;return c6(t,r,n)||Ll(t,r)}else if(i==39||xn&&i==70&&n=="c"){let r=i==39?d6(t,t.state.selection.from)=="ltr"?1:-1:1;return c6(t,r,n)||Ll(t,r)}else{if(i==38||xn&&i==80&&n=="c")return u6(t,-1,n)||Ll(t,-1);if(i==40||xn&&i==78&&n=="c")return wV(t)||u6(t,1,n)||Ll(t,1);if(n==(xn?"m":"c")&&(i==66||i==73||i==89||i==90))return!0}return!1}function X1(t,e){t.someProp("transformCopied",p=>{e=p(e,t)});let i=[],{content:n,openStart:r,openEnd:o}=e;for(;r>1&&o>1&&n.childCount==1&&n.firstChild.childCount==1;){r--,o--;let p=n.firstChild;i.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),n=p.content}let s=t.someProp("clipboardSerializer")||eo.fromSchema(t.state.schema),a=$6(),l=a.createElement("div");l.appendChild(s.serializeFragment(n,{document:a}));let c=l.firstChild,d,u=0;for(;c&&c.nodeType==1&&(d=q6[c.nodeName.toLowerCase()]);){for(let p=d.length-1;p>=0;p--){let f=a.createElement(d[p]);for(;l.firstChild;)f.appendChild(l.firstChild);l.appendChild(f),u++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${r} ${o}${u?` -${u}`:""} ${JSON.stringify(i)}`);let h=t.someProp("clipboardTextSerializer",p=>p(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:h,slice:e}}function G6(t,e,i,n,r){let o=r.parent.type.spec.code,s,a;if(!i&&!e)return null;let l=!!e&&(n||o||!i);if(l){if(t.someProp("transformPastedText",h=>{e=h(e,o||n,t)}),o)return a=new pe(J.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",h=>{a=h(a,t,!0)}),a;let u=t.someProp("clipboardTextParser",h=>h(e,r,n,t));if(u)a=u;else{let h=r.marks(),{schema:p}=t.state,f=eo.fromSchema(p);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(g=>{let m=s.appendChild(document.createElement("p"));g&&m.appendChild(f.serializeNode(p.text(g,h)))})}}else t.someProp("transformPastedHTML",u=>{i=u(i,t)}),s=PV(i),Eu&&RV(s);let c=s&&s.querySelector("[data-pm-slice]"),d=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(d&&d[3])for(let u=+d[3];u>0;u--){let h=s.firstChild;for(;h&&h.nodeType!=1;)h=h.nextSibling;if(!h)break;s=h}if(a||(a=(t.someProp("clipboardParser")||t.someProp("domParser")||Cr.fromSchema(t.state.schema)).parseSlice(s,{preserveWhitespace:!!(l||d),context:r,ruleFromNode(h){return h.nodeName=="BR"&&!h.nextSibling&&h.parentNode&&!SV.test(h.parentNode.nodeName)?{ignore:!0}:null}})),d)a=_V(f6(a,+d[1],+d[2]),d[4]);else if(a=pe.maxOpen(xV(a.content,r),!0),a.openStart||a.openEnd){let u=0,h=0;for(let p=a.content.firstChild;u<a.openStart&&!p.type.spec.isolating;u++,p=p.firstChild);for(let p=a.content.lastChild;h<a.openEnd&&!p.type.spec.isolating;h++,p=p.lastChild);a=f6(a,u,h)}return t.someProp("transformPasted",u=>{a=u(a,t,l)}),a}var SV=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function xV(t,e){if(t.childCount<2)return t;for(let i=e.depth;i>=0;i--){let r=e.node(i).contentMatchAt(e.index(i)),o,s=[];if(t.forEach(a=>{if(!s)return;let l=r.findWrapping(a.type),c;if(!l)return s=null;if(c=s.length&&o.length&&U6(l,o,a,s[s.length-1],0))s[s.length-1]=c;else{s.length&&(s[s.length-1]=j6(s[s.length-1],o.length));let d=W6(a,l);s.push(d),r=r.matchType(d.type),o=l}}),s)return J.from(s)}return t}function W6(t,e,i=0){for(let n=e.length-1;n>=i;n--)t=e[n].create(null,J.from(t));return t}function U6(t,e,i,n,r){if(r<t.length&&r<e.length&&t[r]==e[r]){let o=U6(t,e,i,n.lastChild,r+1);if(o)return n.copy(n.content.replaceChild(n.childCount-1,o));if(n.contentMatchAt(n.childCount).matchType(r==t.length-1?i.type:t[r+1]))return n.copy(n.content.append(J.from(W6(i,t,r+1))))}}function j6(t,e){if(e==0)return t;let i=t.content.replaceChild(t.childCount-1,j6(t.lastChild,e-1)),n=t.contentMatchAt(t.childCount).fillBefore(J.empty,!0);return t.copy(i.append(n))}function z1(t,e,i,n,r,o){let s=e<0?t.firstChild:t.lastChild,a=s.content;return t.childCount>1&&(o=0),r<n-1&&(a=z1(a,e,i,n,r+1,o)),r>=i&&(a=e<0?s.contentMatchAt(0).fillBefore(a,o<=r).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(J.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,s.copy(a))}function f6(t,e,i){return e<t.openStart&&(t=new pe(z1(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),i<t.openEnd&&(t=new pe(z1(t.content,1,i,t.openEnd,0,0),t.openStart,i)),t}var q6={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},g6=null;function $6(){return g6||(g6=document.implementation.createHTMLDocument("title"))}var R1=null;function EV(t){let e=window.trustedTypes;return e?(R1||(R1=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:i=>i})),R1.createHTML(t)):t}function PV(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let i=$6().createElement("div"),n=/<([a-z][^>\s]+)/i.exec(t),r;if((r=n&&q6[n[1].toLowerCase()])&&(t=r.map(o=>"<"+o+">").join("")+t+r.map(o=>"</"+o+">").reverse().join("")),i.innerHTML=EV(t),r)for(let o=0;o<r.length;o++)i=i.querySelector(r[o])||i;return i}function RV(t){let e=t.querySelectorAll(Pi?"span:not([class]):not([style])":"span.Apple-converted-space");for(let i=0;i<e.length;i++){let n=e[i];n.childNodes.length==1&&n.textContent=="\xA0"&&n.parentNode&&n.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),n)}}function _V(t,e){if(!t.size)return t;let i=t.content.firstChild.type.schema,n;try{n=JSON.parse(e)}catch{return t}let{content:r,openStart:o,openEnd:s}=t;for(let a=n.length-2;a>=0;a-=2){let l=i.nodes[n[a]];if(!l||l.hasRequiredAttrs())break;r=J.from(l.create(n[a+1],r)),o++,s++}return new pe(r,o,s)}var Hi={},zi={},kV={touchstart:!0,touchmove:!0},V1=class{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}};function FV(t){for(let e in Hi){let i=Hi[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=n=>{DV(t,n)&&!J1(t,n)&&(t.editable||!(n.type in zi))&&i(t,n)},kV[e]?{passive:!0}:void 0)}Bi&&t.dom.addEventListener("input",()=>null),G1(t)}function ns(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function TV(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function G1(t){t.someProp("handleDOMEvents",e=>{for(let i in e)t.input.eventHandlers[i]||t.dom.addEventListener(i,t.input.eventHandlers[i]=n=>J1(t,n))})}function J1(t,e){return t.someProp("handleDOMEvents",i=>{let n=i[e.type];return n?n(t,e)||e.defaultPrevented:!1})}function DV(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let i=e.target;i!=t.dom;i=i.parentNode)if(!i||i.nodeType==11||i.pmViewDesc&&i.pmViewDesc.stopEvent(e))return!1;return!0}function MV(t,e){!J1(t,e)&&Hi[e.type]&&(t.editable||!(e.type in zi))&&Hi[e.type](t,e)}zi.keydown=(t,e)=>{let i=e;if(t.input.shiftKey=i.keyCode==16||i.shiftKey,!Y6(t,i)&&(t.input.lastKeyCode=i.keyCode,t.input.lastKeyCodeTime=Date.now(),!(so&&Pi&&i.keyCode==13)))if(i.keyCode!=229&&t.domObserver.forceFlush(),zl&&i.keyCode==13&&!i.ctrlKey&&!i.altKey&&!i.metaKey){let n=Date.now();t.input.lastIOSEnter=n,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==n&&(t.someProp("handleKeyDown",r=>r(t,ra(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",n=>n(t,i))||yV(t,i)?i.preventDefault():ns(t,"key")};zi.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};zi.keypress=(t,e)=>{let i=e;if(Y6(t,i)||!i.charCode||i.ctrlKey&&!i.altKey||xn&&i.metaKey)return;if(t.someProp("handleKeyPress",r=>r(t,i))){i.preventDefault();return}let n=t.state.selection;if(!(n instanceof Pe)||!n.$from.sameParent(n.$to)){let r=String.fromCharCode(i.charCode),o=()=>t.state.tr.insertText(r).scrollIntoView();!/[\r\n]/.test(r)&&!t.someProp("handleTextInput",s=>s(t,n.$from.pos,n.$to.pos,r,o))&&t.dispatch(o()),i.preventDefault()}};function Wf(t){return{left:t.clientX,top:t.clientY}}function IV(t,e){let i=e.x-t.clientX,n=e.y-t.clientY;return i*i+n*n<100}function Q1(t,e,i,n,r){if(n==-1)return!1;let o=t.state.doc.resolve(n);for(let s=o.depth+1;s>0;s--)if(t.someProp(e,a=>s>o.depth?a(t,i,o.nodeAfter,o.before(s),r,!0):a(t,i,o.node(s),o.before(s),r,!1)))return!0;return!1}function Bl(t,e,i){if(t.focused||t.focus(),t.state.selection.eq(e))return;let n=t.state.tr.setSelection(e);i=="pointer"&&n.setMeta("pointer",!0),t.dispatch(n)}function AV(t,e){if(e==-1)return!1;let i=t.state.doc.resolve(e),n=i.nodeAfter;return n&&n.isAtom&&ye.isSelectable(n)?(Bl(t,new ye(i),"pointer"),!0):!1}function OV(t,e){if(e==-1)return!1;let i=t.state.selection,n,r;i instanceof ye&&(n=i.node);let o=t.state.doc.resolve(e);for(let s=o.depth+1;s>0;s--){let a=s>o.depth?o.nodeAfter:o.node(s);if(ye.isSelectable(a)){n&&i.$from.depth>0&&s>=i.$from.depth&&o.before(i.$from.depth+1)==i.$from.pos?r=o.before(i.$from.depth):r=o.before(s);break}}return r!=null?(Bl(t,ye.create(t.state.doc,r),"pointer"),!0):!1}function LV(t,e,i,n,r){return Q1(t,"handleClickOn",e,i,n)||t.someProp("handleClick",o=>o(t,e,n))||(r?OV(t,i):AV(t,i))}function NV(t,e,i,n){return Q1(t,"handleDoubleClickOn",e,i,n)||t.someProp("handleDoubleClick",r=>r(t,e,n))}function BV(t,e,i,n){return Q1(t,"handleTripleClickOn",e,i,n)||t.someProp("handleTripleClick",r=>r(t,e,n))||HV(t,i,n)}function HV(t,e,i){if(i.button!=0)return!1;let n=t.state.doc;if(e==-1)return n.inlineContent?(Bl(t,Pe.create(n,0,n.content.size),"pointer"),!0):!1;let r=n.resolve(e);for(let o=r.depth+1;o>0;o--){let s=o>r.depth?r.nodeAfter:r.node(o),a=r.before(o);if(s.inlineContent)Bl(t,Pe.create(n,a+1,a+1+s.content.size),"pointer");else if(ye.isSelectable(s))Bl(t,ye.create(n,a),"pointer");else continue;return!0}}function Z1(t){return Nf(t)}var K6=xn?"metaKey":"ctrlKey";Hi.mousedown=(t,e)=>{let i=e;t.input.shiftKey=i.shiftKey;let n=Z1(t),r=Date.now(),o="singleClick";r-t.input.lastClick.time<500&&IV(i,t.input.lastClick)&&!i[K6]&&t.input.lastClick.button==i.button&&(t.input.lastClick.type=="singleClick"?o="doubleClick":t.input.lastClick.type=="doubleClick"&&(o="tripleClick")),t.input.lastClick={time:r,x:i.clientX,y:i.clientY,type:o,button:i.button};let s=t.posAtCoords(Wf(i));s&&(o=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new W1(t,s,i,!!n)):(o=="doubleClick"?NV:BV)(t,s.pos,s.inside,i)?i.preventDefault():ns(t,"pointer"))};var W1=class{constructor(e,i,n,r){this.view=e,this.pos=i,this.event=n,this.flushed=r,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[K6],this.allowDefault=n.shiftKey;let o,s;if(i.inside>-1)o=e.state.doc.nodeAt(i.inside),s=i.inside;else{let d=e.state.doc.resolve(i.pos);o=d.parent,s=d.depth?d.before():0}let a=r?null:n.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l&&l.nodeDOM.nodeType==1?l.nodeDOM:null;let{selection:c}=e.state;(n.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||c instanceof ye&&c.from<=s&&c.to>s)&&(this.mightDrag={node:o,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Pn&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),ns(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>ao(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let i=this.pos;this.view.state.doc!=this.startDoc&&(i=this.view.posAtCoords(Wf(e))),this.updateAllowDefault(e),this.allowDefault||!i?ns(this.view,"pointer"):LV(this.view,i.pos,i.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Bi&&this.mightDrag&&!this.mightDrag.node.isAtom||Pi&&!this.view.state.selection.visible&&Math.min(Math.abs(i.pos-this.view.state.selection.from),Math.abs(i.pos-this.view.state.selection.to))<=2)?(Bl(this.view,ke.near(this.view.state.doc.resolve(i.pos)),"pointer"),e.preventDefault()):ns(this.view,"pointer")}move(e){this.updateAllowDefault(e),ns(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}};Hi.touchstart=t=>{t.input.lastTouch=Date.now(),Z1(t),ns(t,"pointer")};Hi.touchmove=t=>{t.input.lastTouch=Date.now(),ns(t,"pointer")};Hi.contextmenu=t=>Z1(t);function Y6(t,e){return t.composing?!0:Bi&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}var zV=so?5e3:-1;zi.compositionstart=zi.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,i=e.selection.$to;if(e.selection instanceof Pe&&(e.storedMarks||!i.textOffset&&i.parentOffset&&i.nodeBefore.marks.some(n=>n.type.spec.inclusive===!1)))t.markCursor=t.state.storedMarks||i.marks(),Nf(t,!0),t.markCursor=null;else if(Nf(t,!e.selection.empty),Pn&&e.selection.empty&&i.parentOffset&&!i.textOffset&&i.nodeBefore.marks.length){let n=t.domSelectionRange();for(let r=n.focusNode,o=n.focusOffset;r&&r.nodeType==1&&o!=0;){let s=o<0?r.lastChild:r.childNodes[o-1];if(!s)break;if(s.nodeType==3){let a=t.domSelection();a&&a.collapse(s,s.nodeValue.length);break}else r=s,o=-1}}t.input.composing=!0}X6(t,zV)};zi.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,X6(t,20))};function X6(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>Nf(t),e))}function J6(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=GV());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function VV(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let i=Bz(e.focusNode,e.focusOffset),n=Hz(e.focusNode,e.focusOffset);if(i&&n&&i!=n){let r=n.pmViewDesc,o=t.domObserver.lastChangedTextNode;if(i==o||n==o)return o;if(!r||!r.isText(n.nodeValue))return n;if(t.input.compositionNode==n){let s=i.pmViewDesc;if(!(!s||!s.isText(i.nodeValue)))return n}}return i||n}function GV(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function Nf(t,e=!1){if(!(so&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),J6(t),e||t.docView&&t.docView.dirty){let i=K1(t),n=t.state.selection;return i&&!i.eq(n)?t.dispatch(t.state.tr.setSelection(i)):(t.markCursor||e)&&!n.$from.node(n.$from.sharedDepth(n.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function WV(t,e){if(!t.dom.parentNode)return;let i=t.dom.parentNode.appendChild(document.createElement("div"));i.appendChild(e),i.style.cssText="position: fixed; left: -10000px; top: 10px";let n=getSelection(),r=document.createRange();r.selectNodeContents(e),t.dom.blur(),n.removeAllRanges(),n.addRange(r),setTimeout(()=>{i.parentNode&&i.parentNode.removeChild(i),t.focus()},50)}var wu=$i&&rs<15||zl&&Uz<604;Hi.copy=zi.cut=(t,e)=>{let i=e,n=t.state.selection,r=i.type=="cut";if(n.empty)return;let o=wu?null:i.clipboardData,s=n.content(),{dom:a,text:l}=X1(t,s);o?(i.preventDefault(),o.clearData(),o.setData("text/html",a.innerHTML),o.setData("text/plain",l)):WV(t,a),r&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function UV(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function jV(t,e){if(!t.dom.parentNode)return;let i=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,n=t.dom.parentNode.appendChild(document.createElement(i?"textarea":"div"));i||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus();let r=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),n.parentNode&&n.parentNode.removeChild(n),i?bu(t,n.value,null,r,e):bu(t,n.textContent,n.innerHTML,r,e)},50)}function bu(t,e,i,n,r){let o=G6(t,e,i,n,t.state.selection.$from);if(t.someProp("handlePaste",l=>l(t,r,o||pe.empty)))return!0;if(!o)return!1;let s=UV(o),a=s?t.state.tr.replaceSelectionWith(s,n):t.state.tr.replaceSelection(o);return t.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Q6(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let i=t.getData("text/uri-list");return i?i.replace(/\r?\n/g," "):""}zi.paste=(t,e)=>{let i=e;if(t.composing&&!so)return;let n=wu?null:i.clipboardData,r=t.input.shiftKey&&t.input.lastKeyCode!=45;n&&bu(t,Q6(n),n.getData("text/html"),r,i)?i.preventDefault():jV(t,i)};var Bf=class{constructor(e,i,n){this.slice=e,this.move=i,this.node=n}},qV=xn?"altKey":"ctrlKey";function Z6(t,e){let i=t.someProp("dragCopies",n=>!n(e));return i??!e[qV]}Hi.dragstart=(t,e)=>{let i=e,n=t.input.mouseDown;if(n&&n.done(),!i.dataTransfer)return;let r=t.state.selection,o=r.empty?null:t.posAtCoords(Wf(i)),s;if(!(o&&o.pos>=r.from&&o.pos<=(r instanceof ye?r.to-1:r.to))){if(n&&n.mightDrag)s=ye.create(t.state.doc,n.mightDrag.pos);else if(i.target&&i.target.nodeType==1){let u=t.docView.nearestDesc(i.target,!0);u&&u.node.type.spec.draggable&&u!=t.docView&&(s=ye.create(t.state.doc,u.posBefore))}}let a=(s||t.state.selection).content(),{dom:l,text:c,slice:d}=X1(t,a);(!i.dataTransfer.files.length||!Pi||k6>120)&&i.dataTransfer.clearData(),i.dataTransfer.setData(wu?"Text":"text/html",l.innerHTML),i.dataTransfer.effectAllowed="copyMove",wu||i.dataTransfer.setData("text/plain",c),t.dragging=new Bf(d,Z6(t,i),s)};Hi.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};zi.dragover=zi.dragenter=(t,e)=>e.preventDefault();zi.drop=(t,e)=>{let i=e,n=t.dragging;if(t.dragging=null,!i.dataTransfer)return;let r=t.posAtCoords(Wf(i));if(!r)return;let o=t.state.doc.resolve(r.pos),s=n&&n.slice;s?t.someProp("transformPasted",f=>{s=f(s,t,!1)}):s=G6(t,Q6(i.dataTransfer),wu?null:i.dataTransfer.getData("text/html"),!1,o);let a=!!(n&&Z6(t,i));if(t.someProp("handleDrop",f=>f(t,i,s||pe.empty,a))){i.preventDefault();return}if(!s)return;i.preventDefault();let l=s?Rf(t.state.doc,o.pos,s):o.pos;l==null&&(l=o.pos);let c=t.state.tr;if(a){let{node:f}=n;f?f.replace(c):c.deleteSelection()}let d=c.mapping.map(l),u=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,h=c.doc;if(u?c.replaceRangeWith(d,d,s.content.firstChild):c.replaceRange(d,d,s),c.doc.eq(h))return;let p=c.doc.resolve(d);if(u&&ye.isSelectable(s.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(s.content.firstChild))c.setSelection(new ye(p));else{let f=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((g,m,v,C)=>f=C),c.setSelection(Y1(t,p,c.doc.resolve(f)))}t.focus(),t.dispatch(c.setMeta("uiEvent","drop"))};Hi.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&ao(t)},20))};Hi.blur=(t,e)=>{let i=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),i.relatedTarget&&t.dom.contains(i.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};Hi.beforeinput=(t,e)=>{if(Pi&&so&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:n}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=n||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",o=>o(t,ra(8,"Backspace")))))return;let{$cursor:r}=t.state.selection;r&&r.pos>0&&t.dispatch(t.state.tr.delete(r.pos-1,r.pos).scrollIntoView())},50)}};for(let t in zi)Hi[t]=zi[t];function yu(t,e){if(t==e)return!0;for(let i in t)if(t[i]!==e[i])return!1;for(let i in e)if(!(i in t))return!1;return!0}var Hf=class t{constructor(e,i){this.toDOM=e,this.spec=i||la,this.side=this.spec.side||0}map(e,i,n,r){let{pos:o,deleted:s}=e.mapResult(i.from+r,this.side<0?-1:1);return s?null:new Ri(o-n,o-n,this)}valid(){return!0}eq(e){return this==e||e instanceof t&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&yu(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}},aa=class t{constructor(e,i){this.attrs=e,this.spec=i||la}map(e,i,n,r){let o=e.map(i.from+r,this.spec.inclusiveStart?-1:1)-n,s=e.map(i.to+r,this.spec.inclusiveEnd?1:-1)-n;return o>=s?null:new Ri(o,s,this)}valid(e,i){return i.from<i.to}eq(e){return this==e||e instanceof t&&yu(this.attrs,e.attrs)&&yu(this.spec,e.spec)}static is(e){return e.type instanceof t}destroy(){}},U1=class t{constructor(e,i){this.attrs=e,this.spec=i||la}map(e,i,n,r){let o=e.mapResult(i.from+r,1);if(o.deleted)return null;let s=e.mapResult(i.to+r,-1);return s.deleted||s.pos<=o.pos?null:new Ri(o.pos-n,s.pos-n,this)}valid(e,i){let{index:n,offset:r}=e.content.findIndex(i.from),o;return r==i.from&&!(o=e.child(n)).isText&&r+o.nodeSize==i.to}eq(e){return this==e||e instanceof t&&yu(this.attrs,e.attrs)&&yu(this.spec,e.spec)}destroy(){}},Ri=class t{constructor(e,i,n){this.from=e,this.to=i,this.type=n}copy(e,i){return new t(e,i,this.type)}eq(e,i=0){return this.type.eq(e.type)&&this.from+i==e.from&&this.to+i==e.to}map(e,i,n){return this.type.map(e,this,i,n)}static widget(e,i,n){return new t(e,e,new Hf(i,n))}static inline(e,i,n,r){return new t(e,i,new aa(n,r))}static node(e,i,n,r){return new t(e,i,new U1(n,r))}get spec(){return this.type.spec}get inline(){return this.type instanceof aa}get widget(){return this.type instanceof Hf}},Nl=[],la={},At=class t{constructor(e,i){this.local=e.length?e:Nl,this.children=i.length?i:Nl}static create(e,i){return i.length?Vf(i,e,0,la):Ei}find(e,i,n){let r=[];return this.findInner(e??0,i??1e9,r,0,n),r}findInner(e,i,n,r,o){for(let s=0;s<this.local.length;s++){let a=this.local[s];a.from<=i&&a.to>=e&&(!o||o(a.spec))&&n.push(a.copy(a.from+r,a.to+r))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<i&&this.children[s+1]>e){let a=this.children[s]+1;this.children[s+2].findInner(e-a,i-a,n,r+a,o)}}map(e,i,n){return this==Ei||e.maps.length==0?this:this.mapInner(e,i,0,0,n||la)}mapInner(e,i,n,r,o){let s;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,n,r);l&&l.type.valid(i,l)?(s||(s=[])).push(l):o.onRemove&&o.onRemove(this.local[a].spec)}return this.children.length?$V(this.children,s||[],e,i,n,r,o):s?new t(s.sort(ca),Nl):Ei}add(e,i){return i.length?this==Ei?t.create(e,i):this.addInner(e,i,0):this}addInner(e,i,n){let r,o=0;e.forEach((a,l)=>{let c=l+n,d;if(d=t4(i,a,c)){for(r||(r=this.children.slice());o<r.length&&r[o]<l;)o+=3;r[o]==l?r[o+2]=r[o+2].addInner(a,d,c+1):r.splice(o,0,l,l+a.nodeSize,Vf(d,a,c+1,la)),o+=3}});let s=e4(o?i4(i):i,-n);for(let a=0;a<s.length;a++)s[a].type.valid(e,s[a])||s.splice(a--,1);return new t(s.length?this.local.concat(s).sort(ca):this.local,r||this.children)}remove(e){return e.length==0||this==Ei?this:this.removeInner(e,0)}removeInner(e,i){let n=this.children,r=this.local;for(let o=0;o<n.length;o+=3){let s,a=n[o]+i,l=n[o+1]+i;for(let d=0,u;d<e.length;d++)(u=e[d])&&u.from>a&&u.to<l&&(e[d]=null,(s||(s=[])).push(u));if(!s)continue;n==this.children&&(n=this.children.slice());let c=n[o+2].removeInner(s,a+1);c!=Ei?n[o+2]=c:(n.splice(o,3),o-=3)}if(r.length){for(let o=0,s;o<e.length;o++)if(s=e[o])for(let a=0;a<r.length;a++)r[a].eq(s,i)&&(r==this.local&&(r=this.local.slice()),r.splice(a--,1))}return n==this.children&&r==this.local?this:r.length||n.length?new t(r,n):Ei}forChild(e,i){if(this==Ei)return this;if(i.isLeaf)return t.empty;let n,r;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(n=this.children[a+2]);break}let o=e+1,s=o+i.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<s&&l.to>o&&l.type instanceof aa){let c=Math.max(o,l.from)-o,d=Math.min(s,l.to)-o;c<d&&(r||(r=[])).push(l.copy(c,d))}}if(r){let a=new t(r.sort(ca),Nl);return n?new zf([a,n]):a}return n||Ei}eq(e){if(this==e)return!0;if(!(e instanceof t)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let i=0;i<this.local.length;i++)if(!this.local[i].eq(e.local[i]))return!1;for(let i=0;i<this.children.length;i+=3)if(this.children[i]!=e.children[i]||this.children[i+1]!=e.children[i+1]||!this.children[i+2].eq(e.children[i+2]))return!1;return!0}locals(e){return eb(this.localsInner(e))}localsInner(e){if(this==Ei)return Nl;if(e.inlineContent||!this.local.some(aa.is))return this.local;let i=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof aa||i.push(this.local[n]);return i}forEachSet(e){e(this)}};At.empty=new At([],[]);At.removeOverlap=eb;var Ei=At.empty,zf=class t{constructor(e){this.members=e}map(e,i){let n=this.members.map(r=>r.map(e,i,la));return t.from(n)}forChild(e,i){if(i.isLeaf)return At.empty;let n=[];for(let r=0;r<this.members.length;r++){let o=this.members[r].forChild(e,i);o!=Ei&&(o instanceof t?n=n.concat(o.members):n.push(o))}return t.from(n)}eq(e){if(!(e instanceof t)||e.members.length!=this.members.length)return!1;for(let i=0;i<this.members.length;i++)if(!this.members[i].eq(e.members[i]))return!1;return!0}locals(e){let i,n=!0;for(let r=0;r<this.members.length;r++){let o=this.members[r].localsInner(e);if(o.length)if(!i)i=o;else{n&&(i=i.slice(),n=!1);for(let s=0;s<o.length;s++)i.push(o[s])}}return i?eb(n?i:i.sort(ca)):Nl}static from(e){switch(e.length){case 0:return Ei;case 1:return e[0];default:return new t(e.every(i=>i instanceof At)?e:e.reduce((i,n)=>i.concat(n instanceof At?n:n.members),[]))}}forEachSet(e){for(let i=0;i<this.members.length;i++)this.members[i].forEachSet(e)}};function $V(t,e,i,n,r,o,s){let a=t.slice();for(let c=0,d=o;c<i.maps.length;c++){let u=0;i.maps[c].forEach((h,p,f,g)=>{let m=g-f-(p-h);for(let v=0;v<a.length;v+=3){let C=a[v+1];if(C<0||h>C+d-u)continue;let b=a[v]+d-u;p>=b?a[v+1]=h<=b?-2:-1:h>=d&&m&&(a[v]+=m,a[v+1]+=m)}u+=m}),d=i.maps[c].map(d,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let d=i.map(t[c]+o),u=d-r;if(u<0||u>=n.content.size){l=!0;continue}let h=i.map(t[c+1]+o,-1),p=h-r,{index:f,offset:g}=n.content.findIndex(u),m=n.maybeChild(f);if(m&&g==u&&g+m.nodeSize==p){let v=a[c+2].mapInner(i,m,d+1,t[c]+o+1,s);v!=Ei?(a[c]=u,a[c+1]=p,a[c+2]=v):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=KV(a,t,e,i,r,o,s),d=Vf(c,n,0,s);e=d.local;for(let u=0;u<a.length;u+=3)a[u+1]<0&&(a.splice(u,3),u-=3);for(let u=0,h=0;u<d.children.length;u+=3){let p=d.children[u];for(;h<a.length&&a[h]<p;)h+=3;a.splice(h,0,d.children[u],d.children[u+1],d.children[u+2])}}return new At(e.sort(ca),a)}function e4(t,e){if(!e||!t.length)return t;let i=[];for(let n=0;n<t.length;n++){let r=t[n];i.push(new Ri(r.from+e,r.to+e,r.type))}return i}function KV(t,e,i,n,r,o,s){function a(l,c){for(let d=0;d<l.local.length;d++){let u=l.local[d].map(n,r,c);u?i.push(u):s.onRemove&&s.onRemove(l.local[d].spec)}for(let d=0;d<l.children.length;d+=3)a(l.children[d+2],l.children[d]+c+1)}for(let l=0;l<t.length;l+=3)t[l+1]==-1&&a(t[l+2],e[l]+o+1);return i}function t4(t,e,i){if(e.isLeaf)return null;let n=i+e.nodeSize,r=null;for(let o=0,s;o<t.length;o++)(s=t[o])&&s.from>i&&s.to<n&&((r||(r=[])).push(s),t[o]=null);return r}function i4(t){let e=[];for(let i=0;i<t.length;i++)t[i]!=null&&e.push(t[i]);return e}function Vf(t,e,i,n){let r=[],o=!1;e.forEach((a,l)=>{let c=t4(t,a,l+i);if(c){o=!0;let d=Vf(c,a,i+l+1,n);d!=Ei&&r.push(l,l+a.nodeSize,d)}});let s=e4(o?i4(t):t,-i).sort(ca);for(let a=0;a<s.length;a++)s[a].type.valid(e,s[a])||(n.onRemove&&n.onRemove(s[a].spec),s.splice(a--,1));return s.length||r.length?new At(s,r):Ei}function ca(t,e){return t.from-e.from||t.to-e.to}function eb(t){let e=t;for(let i=0;i<e.length-1;i++){let n=e[i];if(n.from!=n.to)for(let r=i+1;r<e.length;r++){let o=e[r];if(o.from==n.from){o.to!=n.to&&(e==t&&(e=t.slice()),e[r]=o.copy(o.from,n.to),m6(e,r+1,o.copy(n.to,o.to)));continue}else{o.from<n.to&&(e==t&&(e=t.slice()),e[i]=n.copy(n.from,o.from),m6(e,r,n.copy(o.from,n.to)));break}}}return e}function m6(t,e,i){for(;e<t.length&&ca(i,t[e])>0;)e++;t.splice(e,0,i)}function _1(t){let e=[];return t.someProp("decorations",i=>{let n=i(t.state);n&&n!=Ei&&e.push(n)}),t.cursorWrapper&&e.push(At.create(t.state.doc,[t.cursorWrapper.deco])),zf.from(e)}var YV={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},XV=$i&&rs<=11,j1=class{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}},q1=class{constructor(e,i){this.view=e,this.handleDOMChange=i,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new j1,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(n=>{for(let r=0;r<n.length;r++)this.queue.push(n[r]);$i&&rs<=11&&n.some(r=>r.type=="childList"&&r.removedNodes.length||r.type=="characterData"&&r.oldValue.length>r.target.nodeValue.length)?this.flushSoon():this.flush()}),XV&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,YV)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let i=0;i<e.length;i++)this.queue.push(e[i]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(l6(this.view)){if(this.suppressingSelectionUpdates)return ao(this.view);if($i&&rs<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&da(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let i=new Set,n;for(let o=e.focusNode;o;o=Hl(o))i.add(o);for(let o=e.anchorNode;o;o=Hl(o))if(i.has(o)){n=o;break}let r=n&&this.view.docView.nearestDesc(n);if(r&&r.ignoreMutation({type:"selection",target:n.nodeType==3?n.parentNode:n}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let i=this.pendingRecords();i.length&&(this.queue=[]);let n=e.domSelectionRange(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&l6(e)&&!this.ignoreSelectionChange(n),o=-1,s=-1,a=!1,l=[];if(e.editable)for(let d=0;d<i.length;d++){let u=this.registerMutation(i[d],l);u&&(o=o<0?u.from:Math.min(u.from,o),s=s<0?u.to:Math.max(u.to,s),u.typeOver&&(a=!0))}if(Pn&&l.length){let d=l.filter(u=>u.nodeName=="BR");if(d.length==2){let[u,h]=d;u.parentNode&&u.parentNode.parentNode==h.parentNode?h.remove():u.remove()}else{let{focusNode:u}=this.currentSelection;for(let h of d){let p=h.parentNode;p&&p.nodeName=="LI"&&(!u||ZV(e,u)!=p)&&h.remove()}}}let c=null;o<0&&r&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Gf(n)&&(c=K1(e))&&c.eq(ke.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,ao(e),this.currentSelection.set(n),e.scrollToSelection()):(o>-1||r)&&(o>-1&&(e.docView.markDirty(o,s),JV(e)),this.handleDOMChange(o,s,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(n)||ao(e),this.currentSelection.set(n))}registerMutation(e,i){if(i.indexOf(e.target)>-1)return null;let n=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(n==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!n||n.ignoreMutation(e))return null;if(e.type=="childList"){for(let d=0;d<e.addedNodes.length;d++){let u=e.addedNodes[d];i.push(u),u.nodeType==3&&(this.lastChangedTextNode=u)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};let r=e.previousSibling,o=e.nextSibling;if($i&&rs<=11&&e.addedNodes.length)for(let d=0;d<e.addedNodes.length;d++){let{previousSibling:u,nextSibling:h}=e.addedNodes[d];(!u||Array.prototype.indexOf.call(e.addedNodes,u)<0)&&(r=u),(!h||Array.prototype.indexOf.call(e.addedNodes,h)<0)&&(o=h)}let s=r&&r.parentNode==e.target?ci(r)+1:0,a=n.localPosFromDOM(e.target,s,-1),l=o&&o.parentNode==e.target?ci(o):e.target.childNodes.length,c=n.localPosFromDOM(e.target,l,1);return{from:a,to:c}}else return e.type=="attributes"?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=e.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}},v6=new WeakMap,C6=!1;function JV(t){if(!v6.has(t)&&(v6.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=Pn,C6)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),C6=!0}}function w6(t,e){let i=e.startContainer,n=e.startOffset,r=e.endContainer,o=e.endOffset,s=t.domAtPos(t.state.selection.anchor);return da(s.node,s.offset,r,o)&&([i,n,r,o]=[r,o,i,n]),{anchorNode:i,anchorOffset:n,focusNode:r,focusOffset:o}}function QV(t,e){if(e.getComposedRanges){let r=e.getComposedRanges(t.root)[0];if(r)return w6(t,r)}let i;function n(r){r.preventDefault(),r.stopImmediatePropagation(),i=r.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",n,!0),i?w6(t,i):null}function ZV(t,e){for(let i=e.parentNode;i&&i!=t.dom;i=i.parentNode){let n=t.docView.nearestDesc(i,!0);if(n&&n.node.isBlock)return i}return null}function eG(t,e,i){let{node:n,fromOffset:r,toOffset:o,from:s,to:a}=t.docView.parseRange(e,i),l=t.domSelectionRange(),c,d=l.anchorNode;if(d&&t.dom.contains(d.nodeType==1?d:d.parentNode)&&(c=[{node:d,offset:l.anchorOffset}],Gf(l)||c.push({node:l.focusNode,offset:l.focusOffset})),Pi&&t.input.lastKeyCode===8)for(let m=o;m>r;m--){let v=n.childNodes[m-1],C=v.pmViewDesc;if(v.nodeName=="BR"&&!C){o=m;break}if(!C||C.size)break}let u=t.state.doc,h=t.someProp("domParser")||Cr.fromSchema(t.state.schema),p=u.resolve(s),f=null,g=h.parse(n,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:r,to:o,preserveWhitespace:p.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:tG,context:p});if(c&&c[0].pos!=null){let m=c[0].pos,v=c[1]&&c[1].pos;v==null&&(v=m),f={anchor:m+s,head:v+s}}return{doc:g,sel:f,from:s,to:a}}function tG(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(Bi&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let i=document.createElement("div");return i.appendChild(document.createElement("li")),{skip:i}}else if(t.parentNode.lastChild==t||Bi&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}var iG=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function nG(t,e,i,n,r){let o=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let P=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,L=K1(t,P);if(L&&!t.state.selection.eq(L)){if(Pi&&so&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",j=>j(t,ra(13,"Enter"))))return;let B=t.state.tr.setSelection(L);P=="pointer"?B.setMeta("pointer",!0):P=="key"&&B.scrollIntoView(),o&&B.setMeta("composition",o),t.dispatch(B)}return}let s=t.state.doc.resolve(e),a=s.sharedDepth(i);e=s.before(a+1),i=t.state.doc.resolve(i).after(a+1);let l=t.state.selection,c=eG(t,e,i),d=t.state.doc,u=d.slice(c.from,c.to),h,p;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(h=t.state.selection.to,p="end"):(h=t.state.selection.from,p="start"),t.input.lastKeyCode=null;let f=sG(u.content,c.doc.content,c.from,h,p);if(f&&t.input.domChangeCount++,(zl&&t.input.lastIOSEnter>Date.now()-225||so)&&r.some(P=>P.nodeType==1&&!iG.test(P.nodeName))&&(!f||f.endA>=f.endB)&&t.someProp("handleKeyDown",P=>P(t,ra(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!f)if(n&&l instanceof Pe&&!l.empty&&l.$head.sameParent(l.$anchor)&&!t.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))f={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let P=b6(t,t.state.doc,c.sel);if(P&&!P.eq(t.state.selection)){let L=t.state.tr.setSelection(P);o&&L.setMeta("composition",o),t.dispatch(L)}}return}t.state.selection.from<t.state.selection.to&&f.start==f.endB&&t.state.selection instanceof Pe&&(f.start>t.state.selection.from&&f.start<=t.state.selection.from+2&&t.state.selection.from>=c.from?f.start=t.state.selection.from:f.endA<t.state.selection.to&&f.endA>=t.state.selection.to-2&&t.state.selection.to<=c.to&&(f.endB+=t.state.selection.to-f.endA,f.endA=t.state.selection.to)),$i&&rs<=11&&f.endB==f.start+1&&f.endA==f.start&&f.start>c.from&&c.doc.textBetween(f.start-c.from-1,f.start-c.from+1)==" \xA0"&&(f.start--,f.endA--,f.endB--);let g=c.doc.resolveNoCache(f.start-c.from),m=c.doc.resolveNoCache(f.endB-c.from),v=d.resolve(f.start),C=g.sameParent(m)&&g.parent.inlineContent&&v.end()>=f.endA;if((zl&&t.input.lastIOSEnter>Date.now()-225&&(!C||r.some(P=>P.nodeName=="DIV"||P.nodeName=="P"))||!C&&g.pos<c.doc.content.size&&(!g.sameParent(m)||!g.parent.inlineContent)&&g.pos<m.pos&&!/\S/.test(c.doc.textBetween(g.pos,m.pos,"","")))&&t.someProp("handleKeyDown",P=>P(t,ra(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>f.start&&oG(d,f.start,f.endA,g,m)&&t.someProp("handleKeyDown",P=>P(t,ra(8,"Backspace")))){so&&Pi&&t.domObserver.suppressSelectionUpdates();return}Pi&&f.endB==f.start&&(t.input.lastChromeDelete=Date.now()),so&&!C&&g.start()!=m.start()&&m.parentOffset==0&&g.depth==m.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==f.endA&&(f.endB-=2,m=c.doc.resolveNoCache(f.endB-c.from),setTimeout(()=>{t.someProp("handleKeyDown",function(P){return P(t,ra(13,"Enter"))})},20));let b=f.start,S=f.endA,x=P=>{let L=P||t.state.tr.replace(b,S,c.doc.slice(f.start-c.from,f.endB-c.from));if(c.sel){let B=b6(t,L.doc,c.sel);B&&!(Pi&&t.composing&&B.empty&&(f.start!=f.endB||t.input.lastChromeDelete<Date.now()-100)&&(B.head==b||B.head==L.mapping.map(S)-1)||$i&&B.empty&&B.head==b)&&L.setSelection(B)}return o&&L.setMeta("composition",o),L.scrollIntoView()},E;if(C)if(g.pos==m.pos){$i&&rs<=11&&g.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>ao(t),20));let P=x(t.state.tr.delete(b,S)),L=d.resolve(f.start).marksAcross(d.resolve(f.endA));L&&P.ensureMarks(L),t.dispatch(P)}else if(f.endA==f.endB&&(E=rG(g.parent.content.cut(g.parentOffset,m.parentOffset),v.parent.content.cut(v.parentOffset,f.endA-v.start())))){let P=x(t.state.tr);E.type=="add"?P.addMark(b,S,E.mark):P.removeMark(b,S,E.mark),t.dispatch(P)}else if(g.parent.child(g.index()).isText&&g.index()==m.index()-(m.textOffset?0:1)){let P=g.parent.textBetween(g.parentOffset,m.parentOffset),L=()=>x(t.state.tr.insertText(P,b,S));t.someProp("handleTextInput",B=>B(t,b,S,P,L))||t.dispatch(L())}else t.dispatch(x());else t.dispatch(x())}function b6(t,e,i){return Math.max(i.anchor,i.head)>e.content.size?null:Y1(t,e.resolve(i.anchor),e.resolve(i.head))}function rG(t,e){let i=t.firstChild.marks,n=e.firstChild.marks,r=i,o=n,s,a,l;for(let d=0;d<n.length;d++)r=n[d].removeFromSet(r);for(let d=0;d<i.length;d++)o=i[d].removeFromSet(o);if(r.length==1&&o.length==0)a=r[0],s="add",l=d=>d.mark(a.addToSet(d.marks));else if(r.length==0&&o.length==1)a=o[0],s="remove",l=d=>d.mark(a.removeFromSet(d.marks));else return null;let c=[];for(let d=0;d<e.childCount;d++)c.push(l(e.child(d)));if(J.from(c).eq(t))return{mark:a,type:s}}function oG(t,e,i,n,r){if(i-e<=r.pos-n.pos||k1(n,!0,!1)<r.pos)return!1;let o=t.resolve(e);if(!n.parent.isTextblock){let a=o.nodeAfter;return a!=null&&i==e+a.nodeSize}if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let s=t.resolve(k1(o,!0,!0));return!s.parent.isTextblock||s.pos>i||k1(s,!0,!1)<i?!1:n.parent.content.cut(n.parentOffset).eq(s.parent.content)}function k1(t,e,i){let n=t.depth,r=e?t.end():t.pos;for(;n>0&&(e||t.indexAfter(n)==t.node(n).childCount);)n--,r++,e=!1;if(i){let o=t.node(n).maybeChild(t.indexAfter(n));for(;o&&!o.isLeaf;)o=o.firstChild,r++}return r}function sG(t,e,i,n,r){let o=t.findDiffStart(e,i);if(o==null)return null;let{a:s,b:a}=t.findDiffEnd(e,i+t.size,i+e.size);if(r=="end"){let l=Math.max(0,o-Math.min(s,a));n-=s+l-o}if(s<o&&t.size<e.size){let l=n<=o&&n>=s?o-n:0;o-=l,o&&o<e.size&&y6(e.textBetween(o-1,o+1))&&(o+=l?1:-1),a=o+(a-s),s=o}else if(a<o){let l=n<=o&&n>=a?o-n:0;o-=l,o&&o<t.size&&y6(t.textBetween(o-1,o+1))&&(o+=l?1:-1),s=o+(s-a),a=o}return{start:o,endA:s,endB:a}}function y6(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),i=t.charCodeAt(1);return e>=56320&&e<=57343&&i>=55296&&i<=56319}var Su=class{constructor(e,i){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new V1,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=i,this.state=i.state,this.directPlugins=i.plugins||[],this.directPlugins.forEach(R6),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=E6(this),x6(this),this.nodeViews=P6(this),this.docView=i6(this.state.doc,S6(this),_1(this),this.dom,this),this.domObserver=new q1(this,(n,r,o,s)=>nG(this,n,r,o,s)),this.domObserver.start(),FV(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let i in e)this._props[i]=e[i];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&G1(this);let i=this._props;this._props=e,e.plugins&&(e.plugins.forEach(R6),this.directPlugins=e.plugins),this.updateStateInner(e.state,i)}setProps(e){let i={};for(let n in this._props)i[n]=this._props[n];i.state=this.state;for(let n in e)i[n]=e[n];this.update(i)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,i){var n;let r=this.state,o=!1,s=!1;e.storedMarks&&this.composing&&(J6(this),s=!0),this.state=e;let a=r.plugins!=e.plugins||this._props.plugins!=i.plugins;if(a||this._props.plugins!=i.plugins||this._props.nodeViews!=i.nodeViews){let p=P6(this);lG(p,this.nodeViews)&&(this.nodeViews=p,o=!0)}(a||i.handleDOMEvents!=this._props.handleDOMEvents)&&G1(this),this.editable=E6(this),x6(this);let l=_1(this),c=S6(this),d=r.plugins!=e.plugins&&!r.doc.eq(e.doc)?"reset":e.scrollToSelection>r.scrollToSelection?"to selection":"preserve",u=o||!this.docView.matchesNode(e.doc,c,l);(u||!e.selection.eq(r.selection))&&(s=!0);let h=d=="preserve"&&s&&this.dom.style.overflowAnchor==null&&$z(this);if(s){this.domObserver.stop();let p=u&&($i||Pi)&&!this.composing&&!r.selection.empty&&!e.selection.empty&&aG(r.selection,e.selection);if(u){let f=Pi?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=VV(this)),(o||!this.docView.update(e.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=i6(e.doc,c,l,this.dom,this)),f&&!this.trackWrites&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&fV(this))?ao(this,p):(H6(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(r),!((n=this.dragging)===null||n===void 0)&&n.node&&!r.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,r),d=="reset"?this.dom.scrollTop=0:d=="to selection"?this.scrollToSelection():h&&Kz(h)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",i=>i(this)))if(this.state.selection instanceof ye){let i=this.docView.domAfterPos(this.state.selection.from);i.nodeType==1&&XF(this,i.getBoundingClientRect(),e)}else XF(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let i=0;i<this.directPlugins.length;i++){let n=this.directPlugins[i];n.spec.view&&this.pluginViews.push(n.spec.view(this))}for(let i=0;i<this.state.plugins.length;i++){let n=this.state.plugins[i];n.spec.view&&this.pluginViews.push(n.spec.view(this))}}else for(let i=0;i<this.pluginViews.length;i++){let n=this.pluginViews[i];n.update&&n.update(this,e)}}updateDraggedNode(e,i){let n=e.node,r=-1;if(this.state.doc.nodeAt(n.from)==n.node)r=n.from;else{let o=n.from+(this.state.doc.content.size-i.doc.content.size);(o>0&&this.state.doc.nodeAt(o))==n.node&&(r=o)}this.dragging=new Bf(e.slice,e.move,r<0?void 0:ye.create(this.state.doc,r))}someProp(e,i){let n=this._props&&this._props[e],r;if(n!=null&&(r=i?i(n):n))return r;for(let s=0;s<this.directPlugins.length;s++){let a=this.directPlugins[s].props[e];if(a!=null&&(r=i?i(a):a))return r}let o=this.state.plugins;if(o)for(let s=0;s<o.length;s++){let a=o[s].props[e];if(a!=null&&(r=i?i(a):a))return r}}hasFocus(){if($i){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&Yz(this.dom),ao(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let i=this.dom.parentNode;i;i=i.parentNode)if(i.nodeType==9||i.nodeType==11&&i.host)return i.getSelection||(Object.getPrototypeOf(i).getSelection=()=>i.ownerDocument.getSelection()),this._root=i}return e||document}updateRoot(){this._root=null}posAtCoords(e){return eV(this,e)}coordsAtPos(e,i=1){return I6(this,e,i)}domAtPos(e,i=0){return this.docView.domFromPos(e,i)}nodeDOM(e){let i=this.docView.descAt(e);return i?i.nodeDOM:null}posAtDOM(e,i,n=-1){let r=this.docView.posFromDOM(e,i,n);if(r==null)throw new RangeError("DOM position not inside the editor");return r}endOfTextblock(e,i){return oV(this,i||this.state,e)}pasteHTML(e,i){return bu(this,"",e,!1,i||new ClipboardEvent("paste"))}pasteText(e,i){return bu(this,e,null,!0,i||new ClipboardEvent("paste"))}serializeForClipboard(e){return X1(this,e)}destroy(){this.docView&&(TV(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],_1(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,Lz())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return MV(this,e)}domSelectionRange(){let e=this.domSelection();return e?Bi&&this.root.nodeType===11&&Vz(this.dom.ownerDocument)==this.dom&&QV(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}};Su.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function S6(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",i=>{if(typeof i=="function"&&(i=i(t.state)),i)for(let n in i)n=="class"?e.class+=" "+i[n]:n=="style"?e.style=(e.style?e.style+";":"")+i[n]:!e[n]&&n!="contenteditable"&&n!="nodeName"&&(e[n]=String(i[n]))}),e.translate||(e.translate="no"),[Ri.node(0,t.state.doc.content.size,e)]}function x6(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:Ri.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function E6(t){return!t.someProp("editable",e=>e(t.state)===!1)}function aG(t,e){let i=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(i)!=e.$anchor.start(i)}function P6(t){let e=Object.create(null);function i(n){for(let r in n)Object.prototype.hasOwnProperty.call(e,r)||(e[r]=n[r])}return t.someProp("nodeViews",i),t.someProp("markViews",i),e}function lG(t,e){let i=0,n=0;for(let r in t){if(t[r]!=e[r])return!0;i++}for(let r in e)n++;return i!=n}function R6(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var lo={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},jf={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},cG=typeof navigator<"u"&&/Mac/.test(navigator.platform),dG=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(jt=0;jt<10;jt++)lo[48+jt]=lo[96+jt]=String(jt);var jt;for(jt=1;jt<=24;jt++)lo[jt+111]="F"+jt;var jt;for(jt=65;jt<=90;jt++)lo[jt]=String.fromCharCode(jt+32),jf[jt]=String.fromCharCode(jt);var jt;for(Uf in lo)jf.hasOwnProperty(Uf)||(jf[Uf]=lo[Uf]);var Uf;function n4(t){var e=cG&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||dG&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",i=!e&&t.key||(t.shiftKey?jf:lo)[t.keyCode]||t.key||"Unidentified";return i=="Esc"&&(i="Escape"),i=="Del"&&(i="Delete"),i=="Left"&&(i="ArrowLeft"),i=="Up"&&(i="ArrowUp"),i=="Right"&&(i="ArrowRight"),i=="Down"&&(i="ArrowDown"),i}var uG=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),hG=typeof navigator<"u"&&/Win/.test(navigator.platform);function pG(t){let e=t.split(/-(?!$)/),i=e[e.length-1];i=="Space"&&(i=" ");let n,r,o,s;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))r=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))uG?s=!0:r=!0;else throw new Error("Unrecognized modifier name: "+l)}return n&&(i="Alt-"+i),r&&(i="Ctrl-"+i),s&&(i="Meta-"+i),o&&(i="Shift-"+i),i}function fG(t){let e=Object.create(null);for(let i in t)e[pG(i)]=t[i];return e}function tb(t,e,i=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),i&&e.shiftKey&&(t="Shift-"+t),t}function r4(t){return new Te({props:{handleKeyDown:ib(t)}})}function ib(t){let e=fG(t);return function(i,n){let r=n4(n),o,s=e[tb(r,n)];if(s&&s(i.state,i.dispatch,i))return!0;if(r.length==1&&r!=" "){if(n.shiftKey){let a=e[tb(r,n,!1)];if(a&&a(i.state,i.dispatch,i))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(hG&&n.ctrlKey&&n.altKey)&&(o=lo[n.keyCode])&&o!=r){let a=e[tb(o,n)];if(a&&a(i.state,i.dispatch,i))return!0}}return!1}}var gG=Object.defineProperty,cb=(t,e)=>{for(var i in e)gG(t,i,{get:e[i],enumerable:!0})};function Zf(t){let{state:e,transaction:i}=t,{selection:n}=i,{doc:r}=i,{storedMarks:o}=i;return k(w({},e),{apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return n},get doc(){return r},get tr(){return n=i.selection,r=i.doc,o=i.storedMarks,i}})}var eg=class{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){let{rawCommands:t,editor:e,state:i}=this,{view:n}=e,{tr:r}=i,o=this.buildProps(r);return Object.fromEntries(Object.entries(t).map(([s,a])=>[s,(...c)=>{let d=a(...c)(o);return!r.getMeta("preventDispatch")&&!this.hasCustomState&&n.dispatch(r),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){let{rawCommands:i,editor:n,state:r}=this,{view:o}=n,s=[],a=!!t,l=t||r.tr,c=()=>(!a&&e&&!l.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(l),s.every(u=>u===!0)),d=k(w({},Object.fromEntries(Object.entries(i).map(([u,h])=>[u,(...f)=>{let g=this.buildProps(l,e),m=h(...f)(g);return s.push(m),d}]))),{run:c});return d}createCan(t){let{rawCommands:e,state:i}=this,n=!1,r=t||i.tr,o=this.buildProps(r,n),s=Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...c)=>l(...c)(k(w({},o),{dispatch:void 0}))]));return k(w({},s),{chain:()=>this.createChain(r,n)})}buildProps(t,e=!0){let{rawCommands:i,editor:n,state:r}=this,{view:o}=n,s={tr:t,editor:n,view:o,state:Zf({state:r,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t,e),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(i).map(([a,l])=>[a,(...c)=>l(...c)(s)]))}};return s}},f4={};cb(f4,{blur:()=>mG,clearContent:()=>vG,clearNodes:()=>CG,command:()=>wG,createParagraphNear:()=>bG,cut:()=>yG,deleteCurrentNode:()=>SG,deleteNode:()=>xG,deleteRange:()=>EG,deleteSelection:()=>PG,enter:()=>RG,exitCode:()=>_G,extendMarkRange:()=>kG,first:()=>FG,focus:()=>DG,forEach:()=>MG,insertContent:()=>IG,insertContentAt:()=>LG,joinBackward:()=>HG,joinDown:()=>BG,joinForward:()=>zG,joinItemBackward:()=>VG,joinItemForward:()=>GG,joinTextblockBackward:()=>WG,joinTextblockForward:()=>UG,joinUp:()=>NG,keyboardShortcut:()=>qG,lift:()=>$G,liftEmptyBlock:()=>KG,liftListItem:()=>YG,newlineInCode:()=>XG,resetAttributes:()=>JG,scrollIntoView:()=>QG,selectAll:()=>ZG,selectNodeBackward:()=>eW,selectNodeForward:()=>tW,selectParentNode:()=>iW,selectTextblockEnd:()=>nW,selectTextblockStart:()=>rW,setContent:()=>oW,setMark:()=>wW,setMeta:()=>bW,setNode:()=>yW,setNodeSelection:()=>SW,setTextDirection:()=>xW,setTextSelection:()=>EW,sinkListItem:()=>PW,splitBlock:()=>RW,splitListItem:()=>_W,toggleList:()=>kW,toggleMark:()=>FW,toggleNode:()=>TW,toggleWrap:()=>DW,undoInputRule:()=>MW,unsetAllMarks:()=>IW,unsetMark:()=>AW,unsetTextDirection:()=>OW,updateAttributes:()=>LW,wrapIn:()=>NW,wrapInList:()=>BW});var mG=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var i;t.isDestroyed||(e.dom.blur(),(i=window?.getSelection())==null||i.removeAllRanges())}),!0),vG=(t=!0)=>({commands:e})=>e.setContent("",{emitUpdate:t}),CG=()=>({state:t,tr:e,dispatch:i})=>{let{selection:n}=e,{ranges:r}=n;return i&&r.forEach(({$from:o,$to:s})=>{t.doc.nodesBetween(o.pos,s.pos,(a,l)=>{if(a.type.isText)return;let{doc:c,mapping:d}=e,u=c.resolve(d.map(l)),h=c.resolve(d.map(l+a.nodeSize)),p=u.blockRange(h);if(!p)return;let f=no(p);if(a.type.isTextblock){let{defaultType:g}=u.parent.contentMatchAt(u.index());e.setNodeMarkup(p.start,g)}(f||f===0)&&e.lift(p,f)})}),!0},wG=t=>e=>t(e),bG=()=>({state:t,dispatch:e})=>C1(t,e),yG=(t,e)=>({editor:i,tr:n})=>{let{state:r}=i,o=r.doc.slice(t.from,t.to);n.deleteRange(t.from,t.to);let s=n.mapping.map(e);return n.insert(s,o.content),n.setSelection(new Pe(n.doc.resolve(Math.max(s-1,0)))),!0},SG=()=>({tr:t,dispatch:e})=>{let{selection:i}=t,n=i.$anchor.node();if(n.content.size>0)return!1;let r=t.selection.$anchor;for(let o=r.depth;o>0;o-=1)if(r.node(o).type===n.type){if(e){let a=r.before(o),l=r.after(o);t.delete(a,l).scrollIntoView()}return!0}return!1};function kt(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}var xG=t=>({tr:e,state:i,dispatch:n})=>{let r=kt(t,i.schema),o=e.selection.$anchor;for(let s=o.depth;s>0;s-=1)if(o.node(s).type===r){if(n){let l=o.before(s),c=o.after(s);e.delete(l,c).scrollIntoView()}return!0}return!1},EG=t=>({tr:e,dispatch:i})=>{let{from:n,to:r}=t;return i&&e.delete(n,r),!0},PG=()=>({state:t,dispatch:e})=>Df(t,e),RG=()=>({commands:t})=>t.keyboardShortcut("Enter"),_G=()=>({state:t,dispatch:e})=>v1(t,e);function db(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function Jf(t,e,i={strict:!0}){let n=Object.keys(e);return n.length?n.every(r=>i.strict?e[r]===t[r]:db(e[r])?e[r].test(t[r]):e[r]===t[r]):!0}function g4(t,e,i={}){return t.find(n=>n.type===e&&Jf(Object.fromEntries(Object.keys(i).map(r=>[r,n.attrs[r]])),i))}function o4(t,e,i={}){return!!g4(t,e,i)}function ub(t,e,i){var n;if(!t||!e)return;let r=t.parent.childAfter(t.parentOffset);if((!r.node||!r.node.marks.some(d=>d.type===e))&&(r=t.parent.childBefore(t.parentOffset)),!r.node||!r.node.marks.some(d=>d.type===e)||(i=i||((n=r.node.marks[0])==null?void 0:n.attrs),!g4([...r.node.marks],e,i)))return;let s=r.index,a=t.start()+r.offset,l=s+1,c=a+r.node.nodeSize;for(;s>0&&o4([...t.parent.child(s-1).marks],e,i);)s-=1,a-=t.parent.child(s).nodeSize;for(;l<t.parent.childCount&&o4([...t.parent.child(l).marks],e,i);)c+=t.parent.child(l).nodeSize,l+=1;return{from:a,to:c}}function co(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}var kG=(t,e={})=>({tr:i,state:n,dispatch:r})=>{let o=co(t,n.schema),{doc:s,selection:a}=i,{$from:l,from:c,to:d}=a;if(r){let u=ub(l,o,e);if(u&&u.from<=c&&u.to>=d){let h=Pe.create(s,u.from,u.to);i.setSelection(h)}}return!0},FG=t=>e=>{let i=typeof t=="function"?t(e):t;for(let n=0;n<i.length;n+=1)if(i[n](e))return!0;return!1};function m4(t){return t instanceof Pe}function ha(t=0,e=0,i=0){return Math.min(Math.max(t,e),i)}function v4(t,e=null){if(!e)return null;let i=ke.atStart(t),n=ke.atEnd(t);if(e==="start"||e===!0)return i;if(e==="end")return n;let r=i.from,o=n.to;return e==="all"?Pe.create(t,ha(0,r,o),ha(t.content.size,r,o)):Pe.create(t,ha(e,r,o),ha(e,r,o))}function TG(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function hb(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var DG=(t=null,e={})=>({editor:i,view:n,tr:r,dispatch:o})=>{e=w({scrollIntoView:!0},e);let s=()=>{(hb()||TG())&&n.dom.focus(),requestAnimationFrame(()=>{i.isDestroyed||(n.focus(),e?.scrollIntoView&&i.commands.scrollIntoView())})};if(n.hasFocus()&&t===null||t===!1)return!0;if(o&&t===null&&!m4(i.state.selection))return s(),!0;let a=v4(r.doc,t)||i.state.selection,l=i.state.selection.eq(a);return o&&(l||r.setSelection(a),l&&r.storedMarks&&r.setStoredMarks(r.storedMarks),s()),!0},MG=(t,e)=>i=>t.every((n,r)=>e(n,k(w({},i),{index:r}))),IG=(t,e)=>({tr:i,commands:n})=>n.insertContentAt({from:i.selection.from,to:i.selection.to},t,e),C4=t=>{let e=t.childNodes;for(let i=e.length-1;i>=0;i-=1){let n=e[i];n.nodeType===3&&n.nodeValue&&/^(\n\s\s|\n)$/.test(n.nodeValue)?t.removeChild(n):n.nodeType===1&&C4(n)}return t};function qf(t){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");let e=`<body>${t}</body>`,i=new window.DOMParser().parseFromString(e,"text/html").body;return C4(i)}function Pu(t,e,i){if(t instanceof qi||t instanceof J)return t;i=w({slice:!0,parseOptions:{}},i);let n=typeof t=="object"&&t!==null,r=typeof t=="string";if(n)try{if(Array.isArray(t)&&t.length>0)return J.fromArray(t.map(a=>e.nodeFromJSON(a)));let s=e.nodeFromJSON(t);return i.errorOnInvalidContent&&s.check(),s}catch(o){if(i.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",o),Pu("",e,i)}if(r){if(i.errorOnInvalidContent){let s=!1,a="",l=new kl({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(s=!0,a=typeof c=="string"?c:c.outerHTML,null)}]}})});if(i.slice?Cr.fromSchema(l).parseSlice(qf(t),i.parseOptions):Cr.fromSchema(l).parse(qf(t),i.parseOptions),i.errorOnInvalidContent&&s)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}let o=Cr.fromSchema(e);return i.slice?o.parseSlice(qf(t),i.parseOptions).content:o.parse(qf(t),i.parseOptions)}return Pu("",e,i)}function AG(t,e,i){let n=t.steps.length-1;if(n<e)return;let r=t.steps[n];if(!(r instanceof xi||r instanceof Ut))return;let o=t.mapping.maps[n],s=0;o.forEach((a,l,c,d)=>{s===0&&(s=d)}),t.setSelection(ke.near(t.doc.resolve(s),i))}var OG=t=>!("type"in t),LG=(t,e,i)=>({tr:n,dispatch:r,editor:o})=>{var s;if(r){i=w({parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1},i);let a,l=m=>{o.emit("contentError",{editor:o,error:m,disableCollaboration:()=>{"collaboration"in o.storage&&typeof o.storage.collaboration=="object"&&o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}})},c=w({preserveWhitespace:"full"},i.parseOptions);if(!i.errorOnInvalidContent&&!o.options.enableContentCheck&&o.options.emitContentError)try{Pu(e,o.schema,{parseOptions:c,errorOnInvalidContent:!0})}catch(m){l(m)}try{a=Pu(e,o.schema,{parseOptions:c,errorOnInvalidContent:(s=i.errorOnInvalidContent)!=null?s:o.options.enableContentCheck})}catch(m){return l(m),!1}let{from:d,to:u}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},h=!0,p=!0;if((OG(a)?a:[a]).forEach(m=>{m.check(),h=h?m.isText&&m.marks.length===0:!1,p=p?m.isBlock:!1}),d===u&&p){let{parent:m}=n.doc.resolve(d);m.isTextblock&&!m.type.spec.code&&!m.childCount&&(d-=1,u+=1)}let g;if(h){if(Array.isArray(e))g=e.map(m=>m.text||"").join("");else if(e instanceof J){let m="";e.forEach(v=>{v.text&&(m+=v.text)}),g=m}else typeof e=="object"&&e&&e.text?g=e.text:g=e;n.insertText(g,d,u)}else{g=a;let m=n.doc.resolve(d),v=m.node(),C=m.parentOffset===0,b=v.isText||v.isTextblock,S=v.content.size>0;C&&b&&S&&(d=Math.max(0,d-1)),n.replaceWith(d,u,g)}i.updateSelection&&AG(n,n.steps.length-1,-1),i.applyInputRules&&n.setMeta("applyInputRules",{from:d,text:g}),i.applyPasteRules&&n.setMeta("applyPasteRules",{from:d,text:g})}return!0},NG=()=>({state:t,dispatch:e})=>BF(t,e),BG=()=>({state:t,dispatch:e})=>HF(t,e),HG=()=>({state:t,dispatch:e})=>c1(t,e),zG=()=>({state:t,dispatch:e})=>h1(t,e),VG=()=>({state:t,dispatch:e,tr:i})=>{try{let n=ia(t.doc,t.selection.$from.pos,-1);return n==null?!1:(i.join(n,2),e&&e(i),!0)}catch{return!1}},GG=()=>({state:t,dispatch:e,tr:i})=>{try{let n=ia(t.doc,t.selection.$from.pos,1);return n==null?!1:(i.join(n,2),e&&e(i),!0)}catch{return!1}},WG=()=>({state:t,dispatch:e})=>AF(t,e),UG=()=>({state:t,dispatch:e})=>OF(t,e);function w4(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function jG(t){let e=t.split(/-(?!$)/),i=e[e.length-1];i==="Space"&&(i=" ");let n,r,o,s;for(let a=0;a<e.length-1;a+=1){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))r=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))hb()||w4()?s=!0:r=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return n&&(i=`Alt-${i}`),r&&(i=`Ctrl-${i}`),s&&(i=`Meta-${i}`),o&&(i=`Shift-${i}`),i}var qG=t=>({editor:e,view:i,tr:n,dispatch:r})=>{let o=jG(t).split(/-(?!$)/),s=o.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{i.someProp("handleKeyDown",c=>c(i,a))});return l?.steps.forEach(c=>{let d=c.map(n.mapping);d&&r&&n.maybeStep(d)}),!0};function yr(t,e,i={}){let{from:n,to:r,empty:o}=t.selection,s=e?kt(e,t.schema):null,a=[];t.doc.nodesBetween(n,r,(u,h)=>{if(u.isText)return;let p=Math.max(n,h),f=Math.min(r,h+u.nodeSize);a.push({node:u,from:p,to:f})});let l=r-n,c=a.filter(u=>s?s.name===u.node.type.name:!0).filter(u=>Jf(u.node.attrs,i,{strict:!1}));return o?!!c.length:c.reduce((u,h)=>u+h.to-h.from,0)>=l}var $G=(t,e={})=>({state:i,dispatch:n})=>{let r=kt(t,i.schema);return yr(i,r,e)?zF(i,n):!1},KG=()=>({state:t,dispatch:e})=>w1(t,e),YG=t=>({state:e,dispatch:i})=>{let n=kt(t,e.schema);return qF(n)(e,i)},XG=()=>({state:t,dispatch:e})=>g1(t,e);function tg(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function s4(t,e){let i=typeof e=="string"?[e]:e;return Object.keys(t).reduce((n,r)=>(i.includes(r)||(n[r]=t[r]),n),{})}var JG=(t,e)=>({tr:i,state:n,dispatch:r})=>{let o=null,s=null,a=tg(typeof t=="string"?t:t.name,n.schema);if(!a)return!1;a==="node"&&(o=kt(t,n.schema)),a==="mark"&&(s=co(t,n.schema));let l=!1;return i.selection.ranges.forEach(c=>{n.doc.nodesBetween(c.$from.pos,c.$to.pos,(d,u)=>{o&&o===d.type&&(l=!0,r&&i.setNodeMarkup(u,void 0,s4(d.attrs,e))),s&&d.marks.length&&d.marks.forEach(h=>{s===h.type&&(l=!0,r&&i.addMark(u,u+d.nodeSize,s.create(s4(h.attrs,e))))})})}),l},QG=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),ZG=()=>({tr:t,dispatch:e})=>{if(e){let i=new Ni(t.doc);t.setSelection(i)}return!0},eW=()=>({state:t,dispatch:e})=>d1(t,e),tW=()=>({state:t,dispatch:e})=>p1(t,e),iW=()=>({state:t,dispatch:e})=>VF(t,e),nW=()=>({state:t,dispatch:e})=>y1(t,e),rW=()=>({state:t,dispatch:e})=>b1(t,e);function sb(t,e,i={},n={}){return Pu(t,e,{slice:!1,parseOptions:i,errorOnInvalidContent:n.errorOnInvalidContent})}var oW=(t,{errorOnInvalidContent:e,emitUpdate:i=!0,parseOptions:n={}}={})=>({editor:r,tr:o,dispatch:s,commands:a})=>{let{doc:l}=o;if(n.preserveWhitespace!=="full"){let c=sb(t,r.schema,n,{errorOnInvalidContent:e??r.options.enableContentCheck});return s&&o.replaceWith(0,l.content.size,c).setMeta("preventUpdate",!i),!0}return s&&o.setMeta("preventUpdate",!i),a.insertContentAt({from:0,to:l.content.size},t,{parseOptions:n,errorOnInvalidContent:e??r.options.enableContentCheck})};function b4(t,e){let i=co(e,t.schema),{from:n,to:r,empty:o}=t.selection,s=[];o?(t.storedMarks&&s.push(...t.storedMarks),s.push(...t.selection.$head.marks())):t.doc.nodesBetween(n,r,l=>{s.push(...l.marks)});let a=s.find(l=>l.type.name===i.name);return a?w({},a.attrs):{}}function pb(t,e){let i=new Dl(t);return e.forEach(n=>{n.steps.forEach(r=>{i.step(r)})}),i}function sW(t){for(let e=0;e<t.edgeCount;e+=1){let{type:i}=t.edge(e);if(i.isTextblock&&!i.hasRequiredAttrs())return i}return null}function y4(t,e,i){let n=[];return t.nodesBetween(e.from,e.to,(r,o)=>{i(r)&&n.push({node:r,pos:o})}),n}function aW(t,e){for(let i=t.depth;i>0;i-=1){let n=t.node(i);if(e(n))return{pos:i>0?t.before(i):0,start:t.start(i),depth:i,node:n}}}function ig(t){return e=>aW(e.$from,t)}function xe(t,e,i){return t.config[e]===void 0&&t.parent?xe(t.parent,e,i):typeof t.config[e]=="function"?t.config[e].bind(k(w({},i),{parent:t.parent?xe(t.parent,e,i):null})):t.config[e]}function fb(t){return t.map(e=>{let i={name:e.name,options:e.options,storage:e.storage},n=xe(e,"addExtensions",i);return n?[e,...fb(n())]:e}).flat(10)}function gb(t,e){let i=eo.fromSchema(e).serializeFragment(t),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(i),r.innerHTML}function S4(t){return typeof t=="function"}function st(t,e=void 0,...i){return S4(t)?e?t.bind(e)(...i):t(...i):t}function lW(t={}){return Object.keys(t).length===0&&t.constructor===Object}function Wl(t){let e=t.filter(r=>r.type==="extension"),i=t.filter(r=>r.type==="node"),n=t.filter(r=>r.type==="mark");return{baseExtensions:e,nodeExtensions:i,markExtensions:n}}function x4(t){let e=[],{nodeExtensions:i,markExtensions:n}=Wl(t),r=[...i,...n],o={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(s=>{let a={name:s.name,options:s.options,storage:s.storage,extensions:r},l=xe(s,"addGlobalAttributes",a);if(!l)return;l().forEach(d=>{d.types.forEach(u=>{Object.entries(d.attributes).forEach(([h,p])=>{e.push({type:u,name:h,attribute:w(w({},o),p)})})})})}),r.forEach(s=>{let a={name:s.name,options:s.options,storage:s.storage},l=xe(s,"addAttributes",a);if(!l)return;let c=l();Object.entries(c).forEach(([d,u])=>{let h=w(w({},o),u);typeof h?.default=="function"&&(h.default=h.default()),h?.isRequired&&h?.default===void 0&&delete h.default,e.push({type:s.name,name:d,attribute:h})})}),e}function Ge(...t){return t.filter(e=>!!e).reduce((e,i)=>{let n=w({},e);return Object.entries(i).forEach(([r,o])=>{if(!n[r]){n[r]=o;return}if(r==="class"){let a=o?String(o).split(" "):[],l=n[r]?n[r].split(" "):[],c=a.filter(d=>!l.includes(d));n[r]=[...l,...c].join(" ")}else if(r==="style"){let a=o?o.split(";").map(d=>d.trim()).filter(Boolean):[],l=n[r]?n[r].split(";").map(d=>d.trim()).filter(Boolean):[],c=new Map;l.forEach(d=>{let[u,h]=d.split(":").map(p=>p.trim());c.set(u,h)}),a.forEach(d=>{let[u,h]=d.split(":").map(p=>p.trim());c.set(u,h)}),n[r]=Array.from(c.entries()).map(([d,u])=>`${d}: ${u}`).join("; ")}else n[r]=o}),n},{})}function Qf(t,e){return e.filter(i=>i.type===t.type.name).filter(i=>i.attribute.rendered).map(i=>i.attribute.renderHTML?i.attribute.renderHTML(t.attrs)||{}:{[i.name]:t.attrs[i.name]}).reduce((i,n)=>Ge(i,n),{})}function cW(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function a4(t,e){return"style"in t?t:k(w({},t),{getAttrs:i=>{let n=t.getAttrs?t.getAttrs(i):t.attrs;if(n===!1)return!1;let r=e.reduce((o,s)=>{let a=s.attribute.parseHTML?s.attribute.parseHTML(i):cW(i.getAttribute(s.name));return a==null?o:k(w({},o),{[s.name]:a})},{});return w(w({},n),r)}})}function l4(t){return Object.fromEntries(Object.entries(t).filter(([e,i])=>e==="attrs"&&lW(i)?!1:i!=null))}function c4(t){var e,i;let n={};return!((e=t?.attribute)!=null&&e.isRequired)&&"default"in(t?.attribute||{})&&(n.default=t.attribute.default),((i=t?.attribute)==null?void 0:i.validate)!==void 0&&(n.validate=t.attribute.validate),[t.name,n]}function dW(t,e){var i;let n=x4(t),{nodeExtensions:r,markExtensions:o}=Wl(t),s=(i=r.find(c=>xe(c,"topNode")))==null?void 0:i.name,a=Object.fromEntries(r.map(c=>{let d=n.filter(v=>v.type===c.name),u={name:c.name,options:c.options,storage:c.storage,editor:e},h=t.reduce((v,C)=>{let b=xe(C,"extendNodeSchema",u);return w(w({},v),b?b(c):{})},{}),p=l4(k(w({},h),{content:st(xe(c,"content",u)),marks:st(xe(c,"marks",u)),group:st(xe(c,"group",u)),inline:st(xe(c,"inline",u)),atom:st(xe(c,"atom",u)),selectable:st(xe(c,"selectable",u)),draggable:st(xe(c,"draggable",u)),code:st(xe(c,"code",u)),whitespace:st(xe(c,"whitespace",u)),linebreakReplacement:st(xe(c,"linebreakReplacement",u)),defining:st(xe(c,"defining",u)),isolating:st(xe(c,"isolating",u)),attrs:Object.fromEntries(d.map(c4))})),f=st(xe(c,"parseHTML",u));f&&(p.parseDOM=f.map(v=>a4(v,d)));let g=xe(c,"renderHTML",u);g&&(p.toDOM=v=>g({node:v,HTMLAttributes:Qf(v,d)}));let m=xe(c,"renderText",u);return m&&(p.toText=m),[c.name,p]})),l=Object.fromEntries(o.map(c=>{let d=n.filter(m=>m.type===c.name),u={name:c.name,options:c.options,storage:c.storage,editor:e},h=t.reduce((m,v)=>{let C=xe(v,"extendMarkSchema",u);return w(w({},m),C?C(c):{})},{}),p=l4(k(w({},h),{inclusive:st(xe(c,"inclusive",u)),excludes:st(xe(c,"excludes",u)),group:st(xe(c,"group",u)),spanning:st(xe(c,"spanning",u)),code:st(xe(c,"code",u)),attrs:Object.fromEntries(d.map(c4))})),f=st(xe(c,"parseHTML",u));f&&(p.parseDOM=f.map(m=>a4(m,d)));let g=xe(c,"renderHTML",u);return g&&(p.toDOM=m=>g({mark:m,HTMLAttributes:Qf(m,d)})),[c.name,p]}));return new kl({topNode:s,nodes:a,marks:l})}function uW(t){let e=t.filter((i,n)=>t.indexOf(i)!==n);return Array.from(new Set(e))}function ab(t){return t.sort((i,n)=>{let r=xe(i,"priority")||100,o=xe(n,"priority")||100;return r>o?-1:r<o?1:0})}function d4(t){let e=ab(fb(t)),i=uW(e.map(n=>n.name));return i.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${i.map(n=>`'${n}'`).join(", ")}]. This can lead to issues.`),e}function E4(t,e,i){let{from:n,to:r}=e,{blockSeparator:o=`

`,textSerializers:s={}}=i||{},a="";return t.nodesBetween(n,r,(l,c,d,u)=>{var h;l.isBlock&&c>n&&(a+=o);let p=s?.[l.type.name];if(p)return d&&(a+=p({node:l,pos:c,parent:d,index:u,range:e})),!1;l.isText&&(a+=(h=l?.text)==null?void 0:h.slice(Math.max(n,c)-c,r-c))}),a}function hW(t,e){let i={from:0,to:t.content.size};return E4(t,i,e)}function P4(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,i])=>[e,i.spec.toText]))}function pW(t,e){let i=kt(e,t.schema),{from:n,to:r}=t.selection,o=[];t.doc.nodesBetween(n,r,a=>{o.push(a)});let s=o.reverse().find(a=>a.type.name===i.name);return s?w({},s.attrs):{}}function mb(t,e){let i=tg(typeof e=="string"?e:e.name,t.schema);return i==="node"?pW(t,e):i==="mark"?b4(t,e):{}}function fW(t,e=JSON.stringify){let i={};return t.filter(n=>{let r=e(n);return Object.prototype.hasOwnProperty.call(i,r)?!1:i[r]=!0})}function gW(t){let e=fW(t);return e.length===1?e:e.filter((i,n)=>!e.filter((o,s)=>s!==n).some(o=>i.oldRange.from>=o.oldRange.from&&i.oldRange.to<=o.oldRange.to&&i.newRange.from>=o.newRange.from&&i.newRange.to<=o.newRange.to))}function vb(t){let{mapping:e,steps:i}=t,n=[];return e.maps.forEach((r,o)=>{let s=[];if(r.ranges.length)r.forEach((a,l)=>{s.push({from:a,to:l})});else{let{from:a,to:l}=i[o];if(a===void 0||l===void 0)return;s.push({from:a,to:l})}s.forEach(({from:a,to:l})=>{let c=e.slice(o).map(a,-1),d=e.slice(o).map(l),u=e.invert().map(c,-1),h=e.invert().map(d);n.push({oldRange:{from:u,to:h},newRange:{from:c,to:d}})})}),gW(n)}function ng(t,e,i){let n=[];return t===e?i.resolve(t).marks().forEach(r=>{let o=i.resolve(t),s=ub(o,r.type);s&&n.push(w({mark:r},s))}):i.nodesBetween(t,e,(r,o)=>{!r||r?.nodeSize===void 0||n.push(...r.marks.map(s=>({from:o,to:o+r.nodeSize,mark:s})))}),n}var R4=(t,e,i,n=20)=>{let r=t.doc.resolve(i),o=n,s=null;for(;o>0&&s===null;){let a=r.node(o);a?.type.name===e?s=a:o-=1}return[s,o]};function nb(t,e){return e.nodes[t]||e.marks[t]||null}function Xf(t,e,i){return Object.fromEntries(Object.entries(i).filter(([n])=>{let r=t.find(o=>o.type===e&&o.name===n);return r?r.attribute.keepOnSplit:!1}))}var mW=(t,e=500)=>{let i="",n=t.parentOffset;return t.parent.nodesBetween(Math.max(0,n-e),n,(r,o,s,a)=>{var l,c;let d=((c=(l=r.type.spec).toText)==null?void 0:c.call(l,{node:r,pos:o,parent:s,index:a}))||r.textContent||"%leaf%";i+=r.isAtom&&!r.isText?d:d.slice(0,Math.max(0,n-o))}),i};function lb(t,e,i={}){let{empty:n,ranges:r}=t.selection,o=e?co(e,t.schema):null;if(n)return!!(t.storedMarks||t.selection.$from.marks()).filter(u=>o?o.name===u.type.name:!0).find(u=>Jf(u.attrs,i,{strict:!1}));let s=0,a=[];if(r.forEach(({$from:u,$to:h})=>{let p=u.pos,f=h.pos;t.doc.nodesBetween(p,f,(g,m)=>{if(!g.isText&&!g.marks.length)return;let v=Math.max(p,m),C=Math.min(f,m+g.nodeSize),b=C-v;s+=b,a.push(...g.marks.map(S=>({mark:S,from:v,to:C})))})}),s===0)return!1;let l=a.filter(u=>o?o.name===u.mark.type.name:!0).filter(u=>Jf(u.mark.attrs,i,{strict:!1})).reduce((u,h)=>u+h.to-h.from,0),c=a.filter(u=>o?u.mark.type!==o&&u.mark.type.excludes(o):!0).reduce((u,h)=>u+h.to-h.from,0);return(l>0?l+c:l)>=s}function vW(t,e,i={}){if(!e)return yr(t,null,i)||lb(t,null,i);let n=tg(e,t.schema);return n==="node"?yr(t,e,i):n==="mark"?lb(t,e,i):!1}var _4=(t,e)=>{let{$from:i,$to:n,$anchor:r}=t.selection;if(e){let o=ig(a=>a.type.name===e)(t.selection);if(!o)return!1;let s=t.doc.resolve(o.pos+1);return r.pos+1===s.end()}return!(n.parentOffset<n.parent.nodeSize-2||i.pos!==n.pos)},k4=t=>{let{$from:e,$to:i}=t.selection;return!(e.parentOffset>0||e.pos!==i.pos)};function u4(t,e){return Array.isArray(e)?e.some(i=>(typeof i=="string"?i:i.name)===t.name):e}function h4(t,e){let{nodeExtensions:i}=Wl(e),n=i.find(s=>s.name===t);if(!n)return!1;let r={name:n.name,options:n.options,storage:n.storage},o=st(xe(n,"group",r));return typeof o!="string"?!1:o.split(" ").includes("list")}function Ru(t,{checkChildren:e=!0,ignoreWhitespace:i=!1}={}){var n;if(i){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((n=t.text)!=null?n:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let r=!0;return t.content.forEach(o=>{r!==!1&&(Ru(o,{ignoreWhitespace:i,checkChildren:e})||(r=!1))}),r}return!1}function rg(t){return t instanceof ye}function CW(t,e,i){var n;let{selection:r}=e,o=null;if(m4(r)&&(o=r.$cursor),o){let a=(n=t.storedMarks)!=null?n:o.marks();return o.parent.type.allowsMarkType(i)&&(!!i.isInSet(a)||!a.some(c=>c.type.excludes(i)))}let{ranges:s}=r;return s.some(({$from:a,$to:l})=>{let c=a.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(i):!1;return t.doc.nodesBetween(a.pos,l.pos,(d,u,h)=>{if(c)return!1;if(d.isInline){let p=!h||h.type.allowsMarkType(i),f=!!i.isInSet(d.marks)||!d.marks.some(g=>g.type.excludes(i));c=p&&f}return!c}),c})}var wW=(t,e={})=>({tr:i,state:n,dispatch:r})=>{let{selection:o}=i,{empty:s,ranges:a}=o,l=co(t,n.schema);if(r)if(s){let c=b4(n,l);i.addStoredMark(l.create(w(w({},c),e)))}else a.forEach(c=>{let d=c.$from.pos,u=c.$to.pos;n.doc.nodesBetween(d,u,(h,p)=>{let f=Math.max(p,d),g=Math.min(p+h.nodeSize,u);h.marks.find(v=>v.type===l)?h.marks.forEach(v=>{l===v.type&&i.addMark(f,g,l.create(w(w({},v.attrs),e)))}):i.addMark(f,g,l.create(e))})});return CW(n,i,l)},bW=(t,e)=>({tr:i})=>(i.setMeta(t,e),!0),yW=(t,e={})=>({state:i,dispatch:n,chain:r})=>{let o=kt(t,i.schema),s;return i.selection.$anchor.sameParent(i.selection.$head)&&(s=i.selection.$anchor.parent.attrs),o.isTextblock?r().command(({commands:a})=>S1(o,w(w({},s),e))(i)?!0:a.clearNodes()).command(({state:a})=>S1(o,w(w({},s),e))(a,n)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},SW=t=>({tr:e,dispatch:i})=>{if(i){let{doc:n}=e,r=ha(t,0,n.content.size),o=ye.create(n,r);e.setSelection(o)}return!0},xW=(t,e)=>({tr:i,state:n,dispatch:r})=>{let{selection:o}=n,s,a;return typeof e=="number"?(s=e,a=e):e&&"from"in e&&"to"in e?(s=e.from,a=e.to):(s=o.from,a=o.to),r&&i.doc.nodesBetween(s,a,(l,c)=>{l.isText||i.setNodeMarkup(c,void 0,k(w({},l.attrs),{dir:t}))}),!0},EW=t=>({tr:e,dispatch:i})=>{if(i){let{doc:n}=e,{from:r,to:o}=typeof t=="number"?{from:t,to:t}:t,s=Pe.atStart(n).from,a=Pe.atEnd(n).to,l=ha(r,s,a),c=ha(o,s,a),d=Pe.create(n,l,c);e.setSelection(d)}return!0},PW=t=>({state:e,dispatch:i})=>{let n=kt(t,e.schema);return $F(n)(e,i)};function p4(t,e){let i=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(i){let n=i.filter(r=>e?.includes(r.type.name));t.tr.ensureMarks(n)}}var RW=({keepMarks:t=!0}={})=>({tr:e,state:i,dispatch:n,editor:r})=>{let{selection:o,doc:s}=e,{$from:a,$to:l}=o,c=r.extensionManager.attributes,d=Xf(c,a.node().type.name,a.node().attrs);if(o instanceof ye&&o.node.isBlock)return!a.parentOffset||!sn(s,a.pos)?!1:(n&&(t&&p4(i,r.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;let u=l.parentOffset===l.parent.content.size,h=a.depth===0?void 0:sW(a.node(-1).contentMatchAt(a.indexAfter(-1))),p=u&&h?[{type:h,attrs:d}]:void 0,f=sn(e.doc,e.mapping.map(a.pos),1,p);if(!p&&!f&&sn(e.doc,e.mapping.map(a.pos),1,h?[{type:h}]:void 0)&&(f=!0,p=h?[{type:h,attrs:d}]:void 0),n){if(f&&(o instanceof Pe&&e.deleteSelection(),e.split(e.mapping.map(a.pos),1,p),h&&!u&&!a.parentOffset&&a.parent.type!==h)){let g=e.mapping.map(a.before()),m=e.doc.resolve(g);a.node(-1).canReplaceWith(m.index(),m.index()+1,h)&&e.setNodeMarkup(e.mapping.map(a.before()),h)}t&&p4(i,r.extensionManager.splittableMarks),e.scrollIntoView()}return f},_W=(t,e={})=>({tr:i,state:n,dispatch:r,editor:o})=>{var s;let a=kt(t,n.schema),{$from:l,$to:c}=n.selection,d=n.selection.node;if(d&&d.isBlock||l.depth<2||!l.sameParent(c))return!1;let u=l.node(-1);if(u.type!==a)return!1;let h=o.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(r){let v=J.empty,C=l.index(-1)?1:l.index(-2)?2:3;for(let L=l.depth-C;L>=l.depth-3;L-=1)v=J.from(l.node(L).copy(v));let b=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,S=w(w({},Xf(h,l.node().type.name,l.node().attrs)),e),x=((s=a.contentMatch.defaultType)==null?void 0:s.createAndFill(S))||void 0;v=v.append(J.from(a.createAndFill(null,x)||void 0));let E=l.before(l.depth-(C-1));i.replace(E,l.after(-b),new pe(v,4-C,0));let P=-1;i.doc.nodesBetween(E,i.doc.content.size,(L,B)=>{if(P>-1)return!1;L.isTextblock&&L.content.size===0&&(P=B+1)}),P>-1&&i.setSelection(Pe.near(i.doc.resolve(P))),i.scrollIntoView()}return!0}let p=c.pos===l.end()?u.contentMatchAt(0).defaultType:null,f=w(w({},Xf(h,u.type.name,u.attrs)),e),g=w(w({},Xf(h,l.node().type.name,l.node().attrs)),e);i.delete(l.pos,c.pos);let m=p?[{type:a,attrs:f},{type:p,attrs:g}]:[{type:a,attrs:f}];if(!sn(i.doc,l.pos,2))return!1;if(r){let{selection:v,storedMarks:C}=n,{splittableMarks:b}=o.extensionManager,S=C||v.$to.parentOffset&&v.$from.marks();if(i.split(l.pos,2,m).scrollIntoView(),!S||!r)return!0;let x=S.filter(E=>b.includes(E.type.name));i.ensureMarks(x)}return!0},rb=(t,e)=>{let i=ig(s=>s.type===e)(t.selection);if(!i)return!0;let n=t.doc.resolve(Math.max(0,i.pos-1)).before(i.depth);if(n===void 0)return!0;let r=t.doc.nodeAt(n);return i.node.type===r?.type&&Sn(t.doc,i.pos)&&t.join(i.pos),!0},ob=(t,e)=>{let i=ig(s=>s.type===e)(t.selection);if(!i)return!0;let n=t.doc.resolve(i.start).after(i.depth);if(n===void 0)return!0;let r=t.doc.nodeAt(n);return i.node.type===r?.type&&Sn(t.doc,n)&&t.join(n),!0},kW=(t,e,i,n={})=>({editor:r,tr:o,state:s,dispatch:a,chain:l,commands:c,can:d})=>{let{extensions:u,splittableMarks:h}=r.extensionManager,p=kt(t,s.schema),f=kt(e,s.schema),{selection:g,storedMarks:m}=s,{$from:v,$to:C}=g,b=v.blockRange(C),S=m||g.$to.parentOffset&&g.$from.marks();if(!b)return!1;let x=ig(E=>h4(E.type.name,u))(g);if(b.depth>=1&&x&&b.depth-x.depth<=1){if(x.node.type===p)return c.liftListItem(f);if(h4(x.node.type.name,u)&&p.validContent(x.node.content)&&a)return l().command(()=>(o.setNodeMarkup(x.pos,p),!0)).command(()=>rb(o,p)).command(()=>ob(o,p)).run()}return!i||!S||!a?l().command(()=>d().wrapInList(p,n)?!0:c.clearNodes()).wrapInList(p,n).command(()=>rb(o,p)).command(()=>ob(o,p)).run():l().command(()=>{let E=d().wrapInList(p,n),P=S.filter(L=>h.includes(L.type.name));return o.ensureMarks(P),E?!0:c.clearNodes()}).wrapInList(p,n).command(()=>rb(o,p)).command(()=>ob(o,p)).run()},FW=(t,e={},i={})=>({state:n,commands:r})=>{let{extendEmptyMarkRange:o=!1}=i,s=co(t,n.schema);return lb(n,s,e)?r.unsetMark(s,{extendEmptyMarkRange:o}):r.setMark(s,e)},TW=(t,e,i={})=>({state:n,commands:r})=>{let o=kt(t,n.schema),s=kt(e,n.schema),a=yr(n,o,i),l;return n.selection.$anchor.sameParent(n.selection.$head)&&(l=n.selection.$anchor.parent.attrs),a?r.setNode(s,l):r.setNode(o,w(w({},l),i))},DW=(t,e={})=>({state:i,commands:n})=>{let r=kt(t,i.schema);return yr(i,r,e)?n.lift(r):n.wrapIn(r,e)},MW=()=>({state:t,dispatch:e})=>{let i=t.plugins;for(let n=0;n<i.length;n+=1){let r=i[n],o;if(r.spec.isInputRules&&(o=r.getState(t))){if(e){let s=t.tr,a=o.transform;for(let l=a.steps.length-1;l>=0;l-=1)s.step(a.steps[l].invert(a.docs[l]));if(o.text){let l=s.doc.resolve(o.from).marks();s.replaceWith(o.from,o.to,t.schema.text(o.text,l))}else s.delete(o.from,o.to)}return!0}}return!1},IW=()=>({tr:t,dispatch:e})=>{let{selection:i}=t,{empty:n,ranges:r}=i;return n||e&&r.forEach(o=>{t.removeMark(o.$from.pos,o.$to.pos)}),!0},AW=(t,e={})=>({tr:i,state:n,dispatch:r})=>{var o;let{extendEmptyMarkRange:s=!1}=e,{selection:a}=i,l=co(t,n.schema),{$from:c,empty:d,ranges:u}=a;if(!r)return!0;if(d&&s){let{from:h,to:p}=a,f=(o=c.marks().find(m=>m.type===l))==null?void 0:o.attrs,g=ub(c,l,f);g&&(h=g.from,p=g.to),i.removeMark(h,p,l)}else u.forEach(h=>{i.removeMark(h.$from.pos,h.$to.pos,l)});return i.removeStoredMark(l),!0},OW=t=>({tr:e,state:i,dispatch:n})=>{let{selection:r}=i,o,s;return typeof t=="number"?(o=t,s=t):t&&"from"in t&&"to"in t?(o=t.from,s=t.to):(o=r.from,s=r.to),n&&e.doc.nodesBetween(o,s,(a,l)=>{if(a.isText)return;let c=w({},a.attrs);delete c.dir,e.setNodeMarkup(l,void 0,c)}),!0},LW=(t,e={})=>({tr:i,state:n,dispatch:r})=>{let o=null,s=null,a=tg(typeof t=="string"?t:t.name,n.schema);if(!a)return!1;a==="node"&&(o=kt(t,n.schema)),a==="mark"&&(s=co(t,n.schema));let l=!1;return i.selection.ranges.forEach(c=>{let d=c.$from.pos,u=c.$to.pos,h,p,f,g;i.selection.empty?n.doc.nodesBetween(d,u,(m,v)=>{o&&o===m.type&&(l=!0,f=Math.max(v,d),g=Math.min(v+m.nodeSize,u),h=v,p=m)}):n.doc.nodesBetween(d,u,(m,v)=>{v<d&&o&&o===m.type&&(l=!0,f=Math.max(v,d),g=Math.min(v+m.nodeSize,u),h=v,p=m),v>=d&&v<=u&&(o&&o===m.type&&(l=!0,r&&i.setNodeMarkup(v,void 0,w(w({},m.attrs),e))),s&&m.marks.length&&m.marks.forEach(C=>{if(s===C.type&&(l=!0,r)){let b=Math.max(v,d),S=Math.min(v+m.nodeSize,u);i.addMark(b,S,s.create(w(w({},C.attrs),e)))}}))}),p&&(h!==void 0&&r&&i.setNodeMarkup(h,void 0,w(w({},p.attrs),e)),s&&p.marks.length&&p.marks.forEach(m=>{s===m.type&&r&&i.addMark(f,g,s.create(w(w({},m.attrs),e)))}))}),l},NW=(t,e={})=>({state:i,dispatch:n})=>{let r=kt(t,i.schema);return UF(r,e)(i,n)},BW=(t,e={})=>({state:i,dispatch:n})=>{let r=kt(t,i.schema);return jF(r,e)(i,n)},HW=class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){let i=this.callbacks[t];return i&&i.forEach(n=>n.apply(this,e)),this}off(t,e){let i=this.callbacks[t];return i&&(e?this.callbacks[t]=i.filter(n=>n!==e):delete this.callbacks[t]),this}once(t,e){let i=(...n)=>{this.off(t,i),e.apply(this,n)};return this.on(t,i)}removeAllListeners(){this.callbacks={}}},og=class{constructor(t){var e;this.find=t.find,this.handler=t.handler,this.undoable=(e=t.undoable)!=null?e:!0}},zW=(t,e)=>{if(db(e))return e.exec(t);let i=e(t);if(!i)return null;let n=[i.text];return n.index=i.index,n.input=t,n.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),n.push(i.replaceWith)),n};function $f(t){var e;let{editor:i,from:n,to:r,text:o,rules:s,plugin:a}=t,{view:l}=i;if(l.composing)return!1;let c=l.state.doc.resolve(n);if(c.parent.type.spec.code||(e=c.nodeBefore||c.nodeAfter)!=null&&e.marks.find(h=>h.type.spec.code))return!1;let d=!1,u=mW(c)+o;return s.forEach(h=>{if(d)return;let p=zW(u,h.find);if(!p)return;let f=l.state.tr,g=Zf({state:l.state,transaction:f}),m={from:n-(p[0].length-o.length),to:r},{commands:v,chain:C,can:b}=new eg({editor:i,state:g});h.handler({state:g,range:m,match:p,commands:v,chain:C,can:b})===null||!f.steps.length||(h.undoable&&f.setMeta(a,{transform:f,from:n,to:r,text:o}),l.dispatch(f),d=!0)}),d}function VW(t){let{editor:e,rules:i}=t,n=new Te({state:{init(){return null},apply(r,o,s){let a=r.getMeta(n);if(a)return a;let l=r.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:d}=l;typeof d=="string"?d=d:d=gb(J.from(d),s.schema);let{from:u}=l,h=u+d.length;$f({editor:e,from:u,to:h,text:d,rules:i,plugin:n})}),r.selectionSet||r.docChanged?null:o}},props:{handleTextInput(r,o,s,a){return $f({editor:e,from:o,to:s,text:a,rules:i,plugin:n})},handleDOMEvents:{compositionend:r=>(setTimeout(()=>{let{$cursor:o}=r.state.selection;o&&$f({editor:e,from:o.pos,to:o.pos,text:"",rules:i,plugin:n})}),!1)},handleKeyDown(r,o){if(o.key!=="Enter")return!1;let{$cursor:s}=r.state.selection;return s?$f({editor:e,from:s.pos,to:s.pos,text:`
`,rules:i,plugin:n}):!1}},isInputRules:!0});return n}function GW(t){return Object.prototype.toString.call(t).slice(8,-1)}function Kf(t){return GW(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function F4(t,e){let i=w({},t);return Kf(t)&&Kf(e)&&Object.keys(e).forEach(n=>{Kf(e[n])&&Kf(t[n])?i[n]=F4(t[n],e[n]):i[n]=e[n]}),i}var Cb=class{constructor(t={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config=w(w({},this.config),t),this.name=this.config.name}get options(){return w({},st(xe(this,"addOptions",{name:this.name}))||{})}get storage(){return w({},st(xe(this,"addStorage",{name:this.name,options:this.options}))||{})}configure(t={}){let e=this.extend(k(w({},this.config),{addOptions:()=>F4(this.options,t)}));return e.name=this.name,e.parent=this.parent,e}extend(t={}){let e=new this.constructor(w(w({},this.config),t));return e.parent=this,this.child=e,e.name="name"in t?t.name:e.parent.name,e}},an=class T4 extends Cb{constructor(){super(...arguments),this.type="mark"}static create(e={}){let i=typeof e=="function"?e():e;return new T4(i)}static handleExit({editor:e,mark:i}){let{tr:n}=e.state,r=e.state.selection.$from;if(r.pos===r.end()){let s=r.marks();if(!!!s.find(c=>c?.type.name===i.name))return!1;let l=s.find(c=>c?.type.name===i.name);return l&&n.removeStoredMark(l),n.insertText(" ",r.pos),e.view.dispatch(n),!0}return!1}configure(e){return super.configure(e)}extend(e){let i=typeof e=="function"?e():e;return super.extend(i)}};function WW(t){return typeof t=="number"}var UW=class{constructor(t){this.find=t.find,this.handler=t.handler}},jW=(t,e,i)=>{if(db(e))return[...t.matchAll(e)];let n=e(t,i);return n?n.map(r=>{let o=[r.text];return o.index=r.index,o.input=t,o.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(r.replaceWith)),o}):[]};function qW(t){let{editor:e,state:i,from:n,to:r,rule:o,pasteEvent:s,dropEvent:a}=t,{commands:l,chain:c,can:d}=new eg({editor:e,state:i}),u=[];return i.doc.nodesBetween(n,r,(p,f)=>{var g,m,v,C,b;if((m=(g=p.type)==null?void 0:g.spec)!=null&&m.code||!(p.isText||p.isTextblock||p.isInline))return;let S=(b=(C=(v=p.content)==null?void 0:v.size)!=null?C:p.nodeSize)!=null?b:0,x=Math.max(n,f),E=Math.min(r,f+S);if(x>=E)return;let P=p.isText?p.text||"":p.textBetween(x-f,E-f,void 0,"\uFFFC");jW(P,o.find,s).forEach(B=>{if(B.index===void 0)return;let j=x+B.index+1,q=j+B[0].length,Y={from:i.tr.mapping.map(j),to:i.tr.mapping.map(q)},he=o.handler({state:i,range:Y,match:B,commands:l,chain:c,can:d,pasteEvent:s,dropEvent:a});u.push(he)})}),u.every(p=>p!==null)}var Yf=null,$W=t=>{var e;let i=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=i.clipboardData)==null||e.setData("text/html",t),i};function KW(t){let{editor:e,rules:i}=t,n=null,r=!1,o=!1,s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}let l=({state:d,from:u,to:h,rule:p,pasteEvt:f})=>{let g=d.tr,m=Zf({state:d,transaction:g});if(!(!qW({editor:e,state:m,from:Math.max(u-1,0),to:h.b-1,rule:p,pasteEvent:f,dropEvent:a})||!g.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,g}};return i.map(d=>new Te({view(u){let h=f=>{var g;n=(g=u.dom.parentElement)!=null&&g.contains(f.target)?u.dom.parentElement:null,n&&(Yf=e)},p=()=>{Yf&&(Yf=null)};return window.addEventListener("dragstart",h),window.addEventListener("dragend",p),{destroy(){window.removeEventListener("dragstart",h),window.removeEventListener("dragend",p)}}},props:{handleDOMEvents:{drop:(u,h)=>{if(o=n===u.dom.parentElement,a=h,!o){let p=Yf;p?.isEditable&&setTimeout(()=>{let f=p.state.selection;f&&p.commands.deleteRange({from:f.from,to:f.to})},10)}return!1},paste:(u,h)=>{var p;let f=(p=h.clipboardData)==null?void 0:p.getData("text/html");return s=h,r=!!f?.includes("data-pm-slice"),!1}}},appendTransaction:(u,h,p)=>{let f=u[0],g=f.getMeta("uiEvent")==="paste"&&!r,m=f.getMeta("uiEvent")==="drop"&&!o,v=f.getMeta("applyPasteRules"),C=!!v;if(!g&&!m&&!C)return;if(C){let{text:x}=v;typeof x=="string"?x=x:x=gb(J.from(x),p.schema);let{from:E}=v,P=E+x.length,L=$W(x);return l({rule:d,state:p,from:E,to:{b:P},pasteEvt:L})}let b=h.doc.content.findDiffStart(p.doc.content),S=h.doc.content.findDiffEnd(p.doc.content);if(!(!WW(b)||!S||b===S.b))return l({rule:d,state:p,from:b,to:S,pasteEvt:s})}}))}var YW=(()=>{let t=class{constructor(e,i){this.splittableMarks=[],this.editor=i,this.baseExtensions=e,this.extensions=d4(e),this.schema=dW(this.extensions,i),this.setupExtensions()}get commands(){return this.extensions.reduce((e,i)=>{let n={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:this.editor,type:nb(i.name,this.schema)},r=xe(i,"addCommands",n);return r?w(w({},e),r()):e},{})}get plugins(){let{editor:e}=this;return ab([...this.extensions].reverse()).flatMap(r=>{let o={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:e,type:nb(r.name,this.schema)},s=[],a=xe(r,"addKeyboardShortcuts",o),l={};if(r.type==="mark"&&xe(r,"exitable",o)&&(l.ArrowRight=()=>an.handleExit({editor:e,mark:r})),a){let p=Object.fromEntries(Object.entries(a()).map(([f,g])=>[f,()=>g({editor:e})]));l=w(w({},l),p)}let c=r4(l);s.push(c);let d=xe(r,"addInputRules",o);if(u4(r,e.options.enableInputRules)&&d){let p=d();if(p&&p.length){let f=VW({editor:e,rules:p}),g=Array.isArray(f)?f:[f];s.push(...g)}}let u=xe(r,"addPasteRules",o);if(u4(r,e.options.enablePasteRules)&&u){let p=u();if(p&&p.length){let f=KW({editor:e,rules:p});s.push(...f)}}let h=xe(r,"addProseMirrorPlugins",o);if(h){let p=h();s.push(...p)}return s})}get attributes(){return x4(this.extensions)}get nodeViews(){let{editor:e}=this,{nodeExtensions:i}=Wl(this.extensions);return Object.fromEntries(i.filter(n=>!!xe(n,"addNodeView")).map(n=>{let r=this.attributes.filter(c=>c.type===n.name),o={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:e,type:kt(n.name,this.schema)},s=xe(n,"addNodeView",o);if(!s)return[];let a=s();if(!a)return[];let l=(c,d,u,h,p)=>{let f=Qf(c,r);return a({node:c,view:d,getPos:u,decorations:h,innerDecorations:p,editor:e,extension:n,HTMLAttributes:f})};return[n.name,l]}))}get markViews(){let{editor:e}=this,{markExtensions:i}=Wl(this.extensions);return Object.fromEntries(i.filter(n=>!!xe(n,"addMarkView")).map(n=>{let r=this.attributes.filter(l=>l.type===n.name),o={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:e,type:co(n.name,this.schema)},s=xe(n,"addMarkView",o);if(!s)return[];let a=(l,c,d)=>{let u=Qf(l,r);return s()({mark:l,view:c,inline:d,editor:e,extension:n,HTMLAttributes:u,updateAttributes:h=>{sU(l,e,h)}})};return[n.name,a]}))}setupExtensions(){let e=this.extensions;this.editor.extensionStorage=Object.fromEntries(e.map(i=>[i.name,i.storage])),e.forEach(i=>{var n;let r={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:this.editor,type:nb(i.name,this.schema)};i.type==="mark"&&((n=st(xe(i,"keepOnSplit",r)))==null||n)&&this.splittableMarks.push(i.name);let o=xe(i,"onBeforeCreate",r),s=xe(i,"onCreate",r),a=xe(i,"onUpdate",r),l=xe(i,"onSelectionUpdate",r),c=xe(i,"onTransaction",r),d=xe(i,"onFocus",r),u=xe(i,"onBlur",r),h=xe(i,"onDestroy",r);o&&this.editor.on("beforeCreate",o),s&&this.editor.on("create",s),a&&this.editor.on("update",a),l&&this.editor.on("selectionUpdate",l),c&&this.editor.on("transaction",c),d&&this.editor.on("focus",d),u&&this.editor.on("blur",u),h&&this.editor.on("destroy",h)})}};return t.resolve=d4,t.sort=ab,t.flatten=fb,t})(),XW={};cb(XW,{ClipboardTextSerializer:()=>M4,Commands:()=>I4,Delete:()=>A4,Drop:()=>O4,Editable:()=>L4,FocusEvents:()=>B4,Keymap:()=>H4,Paste:()=>z4,Tabindex:()=>V4,TextDirection:()=>G4,focusEventsPluginKey:()=>N4});var Je=class D4 extends Cb{constructor(){super(...arguments),this.type="extension"}static create(e={}){let i=typeof e=="function"?e():e;return new D4(i)}configure(e){return super.configure(e)}extend(e){let i=typeof e=="function"?e():e;return super.extend(i)}},M4=Je.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Te({key:new Oe("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{let{editor:t}=this,{state:e,schema:i}=t,{doc:n,selection:r}=e,{ranges:o}=r,s=Math.min(...o.map(d=>d.$from.pos)),a=Math.max(...o.map(d=>d.$to.pos)),l=P4(i);return E4(n,{from:s,to:a},k(w({},this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{}),{textSerializers:l}))}}})]}}),I4=Je.create({name:"commands",addCommands(){return w({},f4)}}),A4=Je.create({name:"delete",onUpdate({transaction:t,appendedTransactions:e}){var i,n,r;let o=()=>{var s,a,l,c;if((c=(l=(a=(s=this.editor.options.coreExtensionOptions)==null?void 0:s.delete)==null?void 0:a.filterTransaction)==null?void 0:l.call(a,t))!=null?c:t.getMeta("y-sync$"))return;let d=pb(t.before,[t,...e]);vb(d).forEach(p=>{d.mapping.mapResult(p.oldRange.from).deletedAfter&&d.mapping.mapResult(p.oldRange.to).deletedBefore&&d.before.nodesBetween(p.oldRange.from,p.oldRange.to,(f,g)=>{let m=g+f.nodeSize-2,v=p.oldRange.from<=g&&m<=p.oldRange.to;this.editor.emit("delete",{type:"node",node:f,from:g,to:m,newFrom:d.mapping.map(g),newTo:d.mapping.map(m),deletedRange:p.oldRange,newRange:p.newRange,partial:!v,editor:this.editor,transaction:t,combinedTransform:d})})});let h=d.mapping;d.steps.forEach((p,f)=>{var g,m;if(p instanceof io){let v=h.slice(f).map(p.from,-1),C=h.slice(f).map(p.to),b=h.invert().map(v,-1),S=h.invert().map(C),x=(g=d.doc.nodeAt(v-1))==null?void 0:g.marks.some(P=>P.eq(p.mark)),E=(m=d.doc.nodeAt(C))==null?void 0:m.marks.some(P=>P.eq(p.mark));this.editor.emit("delete",{type:"mark",mark:p.mark,from:p.from,to:p.to,deletedRange:{from:b,to:S},newRange:{from:v,to:C},partial:!!(E||x),editor:this.editor,transaction:t,combinedTransform:d})}})};(r=(n=(i=this.editor.options.coreExtensionOptions)==null?void 0:i.delete)==null?void 0:n.async)==null||r?setTimeout(o,0):o()}}),O4=Je.create({name:"drop",addProseMirrorPlugins(){return[new Te({key:new Oe("tiptapDrop"),props:{handleDrop:(t,e,i,n)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:i,moved:n})}}})]}}),L4=Je.create({name:"editable",addProseMirrorPlugins(){return[new Te({key:new Oe("editable"),props:{editable:()=>this.editor.options.editable}})]}}),N4=new Oe("focusEvents"),B4=Je.create({name:"focusEvents",addProseMirrorPlugins(){let{editor:t}=this;return[new Te({key:N4,props:{handleDOMEvents:{focus:(e,i)=>{t.isFocused=!0;let n=t.state.tr.setMeta("focus",{event:i}).setMeta("addToHistory",!1);return e.dispatch(n),!1},blur:(e,i)=>{t.isFocused=!1;let n=t.state.tr.setMeta("blur",{event:i}).setMeta("addToHistory",!1);return e.dispatch(n),!1}}}})]}}),H4=Je.create({name:"keymap",addKeyboardShortcuts(){let t=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:a})=>{let{selection:l,doc:c}=a,{empty:d,$anchor:u}=l,{pos:h,parent:p}=u,f=u.parent.isTextblock&&h>0?a.doc.resolve(h-1):u,g=f.parent.type.spec.isolating,m=u.pos-u.parentOffset,v=g&&f.parent.childCount===1?m===u.pos:ke.atStart(c).from===h;return!d||!p.type.isTextblock||p.textContent.length||!v||v&&u.parent.type.name==="paragraph"?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},r=w({},n),o=k(w({},n),{"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()});return hb()||w4()?o:r},addProseMirrorPlugins(){return[new Te({key:new Oe("clearDocument"),appendTransaction:(t,e,i)=>{if(t.some(g=>g.getMeta("composition")))return;let n=t.some(g=>g.docChanged)&&!e.doc.eq(i.doc),r=t.some(g=>g.getMeta("preventClearDocument"));if(!n||r)return;let{empty:o,from:s,to:a}=e.selection,l=ke.atStart(e.doc).from,c=ke.atEnd(e.doc).to;if(o||!(s===l&&a===c)||!Ru(i.doc))return;let h=i.tr,p=Zf({state:i,transaction:h}),{commands:f}=new eg({editor:this.editor,state:p});if(f.clearNodes(),!!h.steps.length)return h}})]}}),z4=Je.create({name:"paste",addProseMirrorPlugins(){return[new Te({key:new Oe("tiptapPaste"),props:{handlePaste:(t,e,i)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:i})}}})]}}),V4=Je.create({name:"tabindex",addProseMirrorPlugins(){return[new Te({key:new Oe("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),G4=Je.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];let{nodeExtensions:t}=Wl(this.extensions);return[{types:t.filter(e=>e.name!=="text").map(e=>e.name),attributes:{dir:{default:this.options.direction,parseHTML:e=>{let i=e.getAttribute("dir");return i&&(i==="ltr"||i==="rtl"||i==="auto")?i:this.options.direction},renderHTML:e=>e.dir?{dir:e.dir}:{}}}}]},addProseMirrorPlugins(){return[new Te({key:new Oe("textDirection"),props:{attributes:()=>{let t=this.options.direction;return t?{dir:t}:{}}}})]}}),JW=class Gl{constructor(e,i,n=!1,r=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=e,this.editor=i,this.currentNode=r}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!=null?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let i=this.from,n=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can\u2019t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}i=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:i,to:n},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;let e=this.resolvedPos.start(this.resolvedPos.depth-1),i=this.resolvedPos.doc.resolve(e);return new Gl(i,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Gl(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Gl(e,this.editor)}get children(){let e=[];return this.node.content.forEach((i,n)=>{let r=i.isBlock&&!i.isTextblock,o=i.isAtom&&!i.isText,s=this.pos+n+(o?0:1);if(s<0||s>this.resolvedPos.doc.nodeSize-2)return;let a=this.resolvedPos.doc.resolve(s);if(!r&&a.depth<=this.depth)return;let l=new Gl(a,this.editor,r,r?i:null);r&&(l.actualDepth=this.depth+1),e.push(new Gl(a,this.editor,r,r?i:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){let e=this.children;return e[e.length-1]||null}closest(e,i={}){let n=null,r=this.parent;for(;r&&!n;){if(r.node.type.name===e)if(Object.keys(i).length>0){let o=r.node.attrs,s=Object.keys(i);for(let a=0;a<s.length;a+=1){let l=s[a];if(o[l]!==i[l])break}}else n=r;r=r.parent}return n}querySelector(e,i={}){return this.querySelectorAll(e,i,!0)[0]||null}querySelectorAll(e,i={},n=!1){let r=[];if(!this.children||this.children.length===0)return r;let o=Object.keys(i);return this.children.forEach(s=>{n&&r.length>0||(s.node.type.name===e&&o.every(l=>i[l]===s.node.attrs[l])&&r.push(s),!(n&&r.length>0)&&(r=r.concat(s.querySelectorAll(e,i,n))))}),r}setAttribute(e){let{tr:i}=this.editor.state;i.setNodeMarkup(this.from,void 0,w(w({},this.node.attrs),e)),this.editor.view.dispatch(i)}},QW=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function ZW(t,e,i){let n=document.querySelector(`style[data-tiptap-style${i?`-${i}`:""}]`);if(n!==null)return n;let r=document.createElement("style");return e&&r.setAttribute("nonce",e),r.setAttribute(`data-tiptap-style${i?`-${i}`:""}`,""),r.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(r),r}var W4=class extends HW{constructor(t={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:r,moved:o})=>this.options.onDrop(n,r,o)),this.on("paste",({event:n,slice:r})=>this.options.onPaste(n,r)),this.on("delete",this.options.onDelete);let e=this.createDoc(),i=v4(e,this.options.autofocus);this.editorState=Tf.create({doc:e,schema:this.schema,selection:i||void 0}),this.options.element&&this.mount(this.options.element)}mount(t){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(t),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){let t=this.editorView.dom;t?.editor&&delete t.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(t){console.warn("Failed to remove CSS element:",t)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=ZW(QW,this.options.injectNonce))}setOptions(t={}){this.options=w(w({},this.options),t),!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,e=!0){this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:t=>{this.editorState=t},dispatch:t=>{this.dispatchTransaction(t)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(t,e)=>{if(this.editorView)return this.editorView[e];if(e==="state")return this.editorState;if(e in t)return Reflect.get(t,e);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${e}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(t,e){let i=S4(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],n=this.state.reconfigure({plugins:i});return this.view.updateState(n),n}unregisterPlugin(t){if(this.isDestroyed)return;let e=this.state.plugins,i=e;if([].concat(t).forEach(r=>{let o=typeof r=="string"?`${r}$`:r.key;i=i.filter(s=>!s.key.startsWith(o))}),e.length===i.length)return;let n=this.state.reconfigure({plugins:i});return this.view.updateState(n),n}createExtensionManager(){var t,e;let n=[...this.options.enableCoreExtensions?[L4,M4.configure({blockSeparator:(e=(t=this.options.coreExtensionOptions)==null?void 0:t.clipboardTextSerializer)==null?void 0:e.blockSeparator}),I4,B4,H4,V4,O4,z4,A4,G4.configure({direction:this.options.textDirection})].filter(r=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[r.name]!==!1:!0):[],...this.options.extensions].filter(r=>["extension","node","mark"].includes(r?.type));this.extensionManager=new YW(n,this)}createCommandManager(){this.commandManager=new eg({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let t;try{t=sb(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(i=>i.name!=="collaboration"),this.createExtensionManager()}}),t=sb(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return t}createView(t){var e;this.editorView=new Su(t,k(w({},this.options.editorProps),{attributes:w({role:"textbox"},(e=this.options.editorProps)==null?void 0:e.attributes),dispatchTransaction:this.dispatchTransaction.bind(this),state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews}));let i=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(i),this.prependClass(),this.injectCSS();let n=this.view.dom;n.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;let e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(c=>{var d;return(d=this.capturedTransaction)==null?void 0:d.step(c)});return}let{state:e,transactions:i}=this.state.applyTransaction(t),n=!this.state.selection.eq(e.selection),r=i.includes(t),o=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:t,nextState:e}),!r)return;this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t,appendedTransactions:i.slice(1)}),n&&this.emit("selectionUpdate",{editor:this,transaction:t});let s=i.findLast(c=>c.getMeta("focus")||c.getMeta("blur")),a=s?.getMeta("focus"),l=s?.getMeta("blur");a&&this.emit("focus",{editor:this,event:a.event,transaction:s}),l&&this.emit("blur",{editor:this,event:l.event,transaction:s}),!(t.getMeta("preventUpdate")||!i.some(c=>c.docChanged)||o.doc.eq(e.doc))&&this.emit("update",{editor:this,transaction:t,appendedTransactions:i.slice(1)})}getAttributes(t){return mb(this.state,t)}isActive(t,e){let i=typeof t=="string"?t:null,n=typeof t=="string"?e:t;return vW(this.state,i,n)}getJSON(){return this.state.doc.toJSON()}getHTML(){return gb(this.state.doc.content,this.schema)}getText(t){let{blockSeparator:e=`

`,textSerializers:i={}}=t||{};return hW(this.state.doc,{blockSeparator:e,textSerializers:w(w({},P4(this.schema)),i)})}get isEmpty(){return Ru(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var t,e;return(e=(t=this.editorView)==null?void 0:t.isDestroyed)!=null?e:!0}$node(t,e){var i;return((i=this.$doc)==null?void 0:i.querySelector(t,e))||null}$nodes(t,e){var i;return((i=this.$doc)==null?void 0:i.querySelectorAll(t,e))||null}$pos(t){let e=this.state.doc.resolve(t);return new JW(e,this)}get $doc(){return this.$pos(0)}};function Sr(t){return new og({find:t.find,handler:({state:e,range:i,match:n})=>{let r=st(t.getAttributes,void 0,n);if(r===!1||r===null)return null;let{tr:o}=e,s=n[n.length-1],a=n[0];if(s){let l=a.search(/\S/),c=i.from+a.indexOf(s),d=c+s.length;if(ng(i.from,i.to,e.doc).filter(p=>p.mark.type.excluded.find(g=>g===t.type&&g!==p.mark.type)).filter(p=>p.to>c).length)return null;d<i.to&&o.delete(d,i.to),c>i.from&&o.delete(i.from+l,c);let h=i.from+l+s.length;o.addMark(i.from+l,h,t.type.create(r||{})),o.removeStoredMark(t.type)}},undoable:t.undoable})}function U4(t){return new og({find:t.find,handler:({state:e,range:i,match:n})=>{let r=st(t.getAttributes,void 0,n)||{},{tr:o}=e,s=i.from,a=i.to,l=t.type.create(r);if(n[1]){let c=n[0].lastIndexOf(n[1]),d=s+c;d>a?d=a:a=d+n[1].length;let u=n[0][n[0].length-1];o.insertText(u,s+n[0].length-1),o.replaceWith(d,a,l)}else if(n[0]){let c=t.type.isInline?s:s-1;o.insert(c,t.type.create(r)).delete(o.mapping.map(s),o.mapping.map(a))}o.scrollIntoView()},undoable:t.undoable})}function _u(t){return new og({find:t.find,handler:({state:e,range:i,match:n})=>{let r=e.doc.resolve(i.from),o=st(t.getAttributes,void 0,n)||{};if(!r.node(-1).canReplaceWith(r.index(-1),r.indexAfter(-1),t.type))return null;e.tr.delete(i.from,i.to).setBlockType(i.from,i.from,t.type,o)},undoable:t.undoable})}function xr(t){return new og({find:t.find,handler:({state:e,range:i,match:n,chain:r})=>{let o=st(t.getAttributes,void 0,n)||{},s=e.tr.delete(i.from,i.to),l=s.doc.resolve(i.from).blockRange(),c=l&&Ml(l,t.type,o);if(!c)return null;if(s.wrap(l,c),t.keepMarks&&t.editor){let{selection:u,storedMarks:h}=e,{splittableMarks:p}=t.editor.extensionManager,f=h||u.$to.parentOffset&&u.$from.marks();if(f){let g=f.filter(m=>p.includes(m.type.name));s.ensureMarks(g)}}if(t.keepAttributes){let u=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";r().updateAttributes(u,o).run()}let d=s.doc.resolve(i.from-1).nodeBefore;d&&d.type===t.type&&Sn(s.doc,i.from-1)&&(!t.joinPredicate||t.joinPredicate(n,d))&&s.join(i.from-1)},undoable:t.undoable})}function j4(t,e){let{selection:i}=t,{$from:n}=i;if(i instanceof ye){let o=n.index();return n.parent.canReplaceWith(o,o+1,e)}let r=n.depth;for(;r>=0;){let o=n.index(r);if(n.node(r).contentMatchAt(o).matchType(e))return!0;r-=1}return!1}var eU={};cb(eU,{createAtomBlockMarkdownSpec:()=>tU,createBlockMarkdownSpec:()=>iU,createInlineMarkdownSpec:()=>oU,parseAttributes:()=>wb,parseIndentedBlocks:()=>sg,renderNestedMarkdownContent:()=>ku,serializeAttributes:()=>bb});function wb(t){if(!t?.trim())return{};let e={},i=[],n=t.replace(/["']([^"']*)["']/g,c=>(i.push(c),`__QUOTED_${i.length-1}__`)),r=n.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(r){let c=r.map(d=>d.trim().slice(1));e.class=c.join(" ")}let o=n.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);o&&(e.id=o[1]);let s=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(n.matchAll(s)).forEach(([,c,d])=>{var u;let h=parseInt(((u=d.match(/__QUOTED_(\d+)__/))==null?void 0:u[1])||"0",10),p=i[h];p&&(e[c]=p.slice(1,-1))});let l=n.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return l&&l.split(/\s+/).filter(Boolean).forEach(d=>{d.match(/^[a-zA-Z][\w-]*$/)&&(e[d]=!0)}),e}function bb(t){if(!t||Object.keys(t).length===0)return"";let e=[];return t.class&&String(t.class).split(/\s+/).filter(Boolean).forEach(n=>e.push(`.${n}`)),t.id&&e.push(`#${t.id}`),Object.entries(t).forEach(([i,n])=>{i==="class"||i==="id"||(n===!0?e.push(i):n!==!1&&n!=null&&e.push(`${i}="${String(n)}"`))}),e.join(" ")}function tU(t){let{nodeName:e,name:i,parseAttributes:n=wb,serializeAttributes:r=bb,defaultAttributes:o={},requiredAttributes:s=[],allowedAttributes:a}=t,l=i||e,c=d=>{if(!a)return d;let u={};return a.forEach(h=>{h in d&&(u[h]=d[h])}),u};return{parseMarkdown:(d,u)=>{let h=w(w({},o),d.attributes);return u.createNode(e,h,[])},markdownTokenizer:{name:e,level:"block",start(d){var u;let h=new RegExp(`^:::${l}(?:\\s|$)`,"m"),p=(u=d.match(h))==null?void 0:u.index;return p!==void 0?p:-1},tokenize(d,u,h){let p=new RegExp(`^:::${l}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),f=d.match(p);if(!f)return;let g=f[1]||"",m=n(g);if(!s.find(C=>!(C in m)))return{type:e,raw:f[0],attributes:m}}},renderMarkdown:d=>{let u=c(d.attrs||{}),h=r(u),p=h?` {${h}}`:"";return`:::${l}${p} :::`}}}function iU(t){let{nodeName:e,name:i,getContent:n,parseAttributes:r=wb,serializeAttributes:o=bb,defaultAttributes:s={},content:a="block",allowedAttributes:l}=t,c=i||e,d=u=>{if(!l)return u;let h={};return l.forEach(p=>{p in u&&(h[p]=u[p])}),h};return{parseMarkdown:(u,h)=>{let p;if(n){let g=n(u);p=typeof g=="string"?[{type:"text",text:g}]:g}else a==="block"?p=h.parseChildren(u.tokens||[]):p=h.parseInline(u.tokens||[]);let f=w(w({},s),u.attributes);return h.createNode(e,f,p)},markdownTokenizer:{name:e,level:"block",start(u){var h;let p=new RegExp(`^:::${c}`,"m"),f=(h=u.match(p))==null?void 0:h.index;return f!==void 0?f:-1},tokenize(u,h,p){var f;let g=new RegExp(`^:::${c}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),m=u.match(g);if(!m)return;let[v,C=""]=m,b=r(C),S=1,x=v.length,E="",P=/^:::([\w-]*)(\s.*)?/gm,L=u.slice(x);for(P.lastIndex=0;;){let B=P.exec(L);if(B===null)break;let j=B.index,q=B[1];if(!((f=B[2])!=null&&f.endsWith(":::"))){if(q)S+=1;else if(S-=1,S===0){let Y=L.slice(0,j);E=Y.trim();let he=u.slice(0,x+j+B[0].length),Se=[];if(E)if(a==="block")for(Se=p.blockTokens(Y),Se.forEach(be=>{be.text&&(!be.tokens||be.tokens.length===0)&&(be.tokens=p.inlineTokens(be.text))});Se.length>0;){let be=Se[Se.length-1];if(be.type==="paragraph"&&(!be.text||be.text.trim()===""))Se.pop();else break}else Se=p.inlineTokens(E);return{type:e,raw:he,attributes:b,content:E,tokens:Se}}}}}},renderMarkdown:(u,h)=>{let p=d(u.attrs||{}),f=o(p),g=f?` {${f}}`:"",m=h.renderChildren(u.content||[],`

`);return`:::${c}${g}

${m}

:::`}}}function nU(t){if(!t.trim())return{};let e={},i=/(\w+)=(?:"([^"]*)"|'([^']*)')/g,n=i.exec(t);for(;n!==null;){let[,r,o,s]=n;e[r]=o||s,n=i.exec(t)}return e}function rU(t){return Object.entries(t).filter(([,e])=>e!=null).map(([e,i])=>`${e}="${i}"`).join(" ")}function oU(t){let{nodeName:e,name:i,getContent:n,parseAttributes:r=nU,serializeAttributes:o=rU,defaultAttributes:s={},selfClosing:a=!1,allowedAttributes:l}=t,c=i||e,d=h=>{if(!l)return h;let p={};return l.forEach(f=>{f in h&&(p[f]=h[f])}),p},u=c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(h,p)=>{let f=w(w({},s),h.attributes);if(a)return p.createNode(e,f);let g=n?n(h):h.content||"";return g?p.createNode(e,f,[p.createTextNode(g)]):p.createNode(e,f,[])},markdownTokenizer:{name:e,level:"inline",start(h){let p=a?new RegExp(`\\[${u}\\s*[^\\]]*\\]`):new RegExp(`\\[${u}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${u}\\]`),f=h.match(p),g=f?.index;return g!==void 0?g:-1},tokenize(h,p,f){let g=a?new RegExp(`^\\[${u}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${u}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${u}\\]`),m=h.match(g);if(!m)return;let v="",C="";if(a){let[,S]=m;C=S}else{let[,S,x]=m;C=S,v=x||""}let b=r(C.trim());return{type:e,raw:m[0],content:v.trim(),attributes:b}}},renderMarkdown:h=>{let p="";n?p=n(h):h.content&&h.content.length>0&&(p=h.content.filter(v=>v.type==="text").map(v=>v.text).join(""));let f=d(h.attrs||{}),g=o(f),m=g?` ${g}`:"";return a?`[${c}${m}]`:`[${c}${m}]${p}[/${c}]`}}}function sg(t,e,i){var n,r,o,s;let a=t.split(`
`),l=[],c="",d=0,u=e.baseIndentSize||2;for(;d<a.length;){let h=a[d],p=h.match(e.itemPattern);if(!p){if(l.length>0)break;if(h.trim()===""){d+=1,c=`${c}${h}
`;continue}else return}let f=e.extractItemData(p),{indentLevel:g,mainContent:m}=f;c=`${c}${h}
`;let v=[m];for(d+=1;d<a.length;){let x=a[d];if(x.trim()===""){let P=a.slice(d+1).findIndex(j=>j.trim()!=="");if(P===-1)break;if((((r=(n=a[d+1+P].match(/^(\s*)/))==null?void 0:n[1])==null?void 0:r.length)||0)>g){v.push(x),c=`${c}${x}
`,d+=1;continue}else break}if((((s=(o=x.match(/^(\s*)/))==null?void 0:o[1])==null?void 0:s.length)||0)>g)v.push(x),c=`${c}${x}
`,d+=1;else break}let C,b=v.slice(1);if(b.length>0){let x=b.map(E=>E.slice(g+u)).join(`
`);x.trim()&&(e.customNestedParser?C=e.customNestedParser(x):C=i.blockTokens(x))}let S=e.createToken(f,C);l.push(S)}if(l.length!==0)return{items:l,raw:c}}function ku(t,e,i,n){if(!t||!Array.isArray(t.content))return"";let r=typeof i=="function"?i(n):i,[o,...s]=t.content,a=e.renderChildren([o]),l=[`${r}${a}`];return s&&s.length>0&&s.forEach(c=>{let d=e.renderChildren([c]);if(d){let u=d.split(`
`).map(h=>h?e.indent(h):"").join(`
`);l.push(u)}}),l.join(`
`)}function sU(t,e,i={}){let{state:n}=e,{doc:r,tr:o}=n,s=t;r.descendants((a,l)=>{let c=o.mapping.map(l),d=o.mapping.map(l)+a.nodeSize,u=null;if(a.marks.forEach(p=>{if(p!==s)return!1;u=p}),!u)return;let h=!1;if(Object.keys(i).forEach(p=>{i[p]!==u.attrs[p]&&(h=!0)}),h){let p=t.type.create(w(w({},t.attrs),i));o.removeMark(c,d,t.type),o.addMark(c,d,p)}}),o.docChanged&&e.view.dispatch(o)}var gt=class q4 extends Cb{constructor(){super(...arguments),this.type="node"}static create(e={}){let i=typeof e=="function"?e():e;return new q4(i)}configure(e){return super.configure(e)}extend(e){let i=typeof e=="function"?e():e;return super.extend(i)}};function _n(t){return new UW({find:t.find,handler:({state:e,range:i,match:n,pasteEvent:r})=>{let o=st(t.getAttributes,void 0,n,r);if(o===!1||o===null)return null;let{tr:s}=e,a=n[n.length-1],l=n[0],c=i.to;if(a){let d=l.search(/\S/),u=i.from+l.indexOf(a),h=u+a.length;if(ng(i.from,i.to,e.doc).filter(f=>f.mark.type.excluded.find(m=>m===t.type&&m!==f.mark.type)).filter(f=>f.to>u).length)return null;h<i.to&&s.delete(h,i.to),u>i.from&&s.delete(i.from+d,u),c=i.from+d+a.length,s.addMark(i.from+d,c,t.type.create(o||{})),s.removeStoredMark(t.type)}}})}var aU="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5m\xF6gensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",lU="\u03B5\u03BB1\u03C52\u0431\u04331\u0435\u043B3\u0434\u0435\u0442\u04384\u0435\u044E2\u043A\u0430\u0442\u043E\u043B\u0438\u043A6\u043E\u043C3\u043C\u043A\u04342\u043E\u043D1\u0441\u043A\u0432\u04306\u043E\u043D\u043B\u0430\u0439\u043D5\u0440\u04333\u0440\u0443\u04412\u04442\u0441\u0430\u0439\u04423\u0440\u04313\u0443\u043A\u04403\u049B\u0430\u04373\u0570\u0561\u05753\u05D9\u05E9\u05E8\u05D0\u05DC5\u05E7\u05D5\u05DD3\u0627\u0628\u0648\u0638\u0628\u064A5\u0631\u0627\u0645\u0643\u06485\u0644\u0627\u0631\u062F\u06464\u0628\u062D\u0631\u064A\u06465\u062C\u0632\u0627\u0626\u06315\u0633\u0639\u0648\u062F\u064A\u06296\u0639\u0644\u064A\u0627\u06465\u0645\u063A\u0631\u06285\u0645\u0627\u0631\u0627\u062A5\u06CC\u0631\u0627\u06465\u0628\u0627\u0631\u062A2\u0632\u0627\u06314\u064A\u062A\u06433\u06BE\u0627\u0631\u062A5\u062A\u0648\u0646\u06334\u0633\u0648\u062F\u0627\u06463\u0631\u064A\u06295\u0634\u0628\u0643\u06294\u0639\u0631\u0627\u06422\u06282\u0645\u0627\u06464\u0641\u0644\u0633\u0637\u064A\u06466\u0642\u0637\u06313\u0643\u0627\u062B\u0648\u0644\u064A\u06436\u0648\u06453\u0645\u0635\u06312\u0644\u064A\u0633\u064A\u06275\u0648\u0631\u064A\u062A\u0627\u0646\u064A\u06277\u0642\u06394\u0647\u0645\u0631\u0627\u06475\u067E\u0627\u06A9\u0633\u062A\u0627\u06467\u0680\u0627\u0631\u062A4\u0915\u0949\u092E3\u0928\u0947\u091F3\u092D\u093E\u0930\u09240\u092E\u094D3\u094B\u09245\u0938\u0902\u0917\u0920\u09285\u09AC\u09BE\u0982\u09B2\u09BE5\u09AD\u09BE\u09B0\u09A42\u09F0\u09A44\u0A2D\u0A3E\u0A30\u0A244\u0AAD\u0ABE\u0AB0\u0AA44\u0B2D\u0B3E\u0B30\u0B244\u0B87\u0BA8\u0BCD\u0BA4\u0BBF\u0BAF\u0BBE6\u0BB2\u0B99\u0BCD\u0B95\u0BC86\u0B9A\u0BBF\u0B99\u0BCD\u0B95\u0BAA\u0BCD\u0BAA\u0BC2\u0BB0\u0BCD11\u0C2D\u0C3E\u0C30\u0C24\u0C4D5\u0CAD\u0CBE\u0CB0\u0CA44\u0D2D\u0D3E\u0D30\u0D24\u0D025\u0DBD\u0D82\u0D9A\u0DCF4\u0E04\u0E2D\u0E213\u0E44\u0E17\u0E223\u0EA5\u0EB2\u0EA73\u10D2\u10D42\u307F\u3093\u306A3\u30A2\u30DE\u30BE\u30F34\u30AF\u30E9\u30A6\u30C94\u30B0\u30FC\u30B0\u30EB4\u30B3\u30E02\u30B9\u30C8\u30A23\u30BB\u30FC\u30EB3\u30D5\u30A1\u30C3\u30B7\u30E7\u30F36\u30DD\u30A4\u30F3\u30C84\u4E16\u754C2\u4E2D\u4FE11\u56FD1\u570B1\u6587\u7F513\u4E9A\u9A6C\u900A3\u4F01\u4E1A2\u4F5B\u5C712\u4FE1\u606F2\u5065\u5EB72\u516B\u53662\u516C\u53F81\u76CA2\u53F0\u6E7E1\u70632\u5546\u57CE1\u5E971\u68072\u5609\u91CC0\u5927\u9152\u5E975\u5728\u7EBF2\u5927\u62FF2\u5929\u4E3B\u65593\u5A31\u4E502\u5BB6\u96FB2\u5E7F\u4E1C2\u5FAE\u535A2\u6148\u55842\u6211\u7231\u4F603\u624B\u673A2\u62DB\u80582\u653F\u52A11\u5E9C2\u65B0\u52A0\u57612\u95FB2\u65F6\u5C1A2\u66F8\u7C4D2\u673A\u67842\u6DE1\u9A6C\u95213\u6E38\u620F2\u6FB3\u95802\u70B9\u770B2\u79FB\u52A82\u7EC4\u7EC7\u673A\u67844\u7F51\u57401\u5E971\u7AD91\u7EDC2\u8054\u901A2\u8C37\u6B4C2\u8D2D\u72692\u901A\u8CA92\u96C6\u56E22\u96FB\u8A0A\u76C8\u79D14\u98DE\u5229\u6D663\u98DF\u54C12\u9910\u53852\u9999\u683C\u91CC\u62C93\u6E2F2\uB2F7\uB1371\uCEF42\uC0BC\uC1312\uD55C\uAD6D2",_b="numeric",kb="ascii",Fb="alpha",Du="asciinumeric",Tu="alphanumeric",Tb="domain",Z4="emoji",cU="scheme",dU="slashscheme",yb="whitespace";function uU(t,e){return t in e||(e[t]=[]),e[t]}function pa(t,e,i){e[_b]&&(e[Du]=!0,e[Tu]=!0),e[kb]&&(e[Du]=!0,e[Fb]=!0),e[Du]&&(e[Tu]=!0),e[Fb]&&(e[Tu]=!0),e[Tu]&&(e[Tb]=!0),e[Z4]&&(e[Tb]=!0);for(let n in e){let r=uU(n,i);r.indexOf(t)<0&&r.push(t)}}function hU(t,e){let i={};for(let n in e)e[n].indexOf(t)>=0&&(i[n]=!0);return i}function Ki(t=null){this.j={},this.jr=[],this.jd=null,this.t=t}Ki.groups={};Ki.prototype={accepts(){return!!this.t},go(t){let e=this,i=e.j[t];if(i)return i;for(let n=0;n<e.jr.length;n++){let r=e.jr[n][0],o=e.jr[n][1];if(o&&r.test(t))return o}return e.jd},has(t,e=!1){return e?t in this.j:!!this.go(t)},ta(t,e,i,n){for(let r=0;r<t.length;r++)this.tt(t[r],e,i,n)},tr(t,e,i,n){n=n||Ki.groups;let r;return e&&e.j?r=e:(r=new Ki(e),i&&n&&pa(e,i,n)),this.jr.push([t,r]),r},ts(t,e,i,n){let r=this,o=t.length;if(!o)return r;for(let s=0;s<o-1;s++)r=r.tt(t[s]);return r.tt(t[o-1],e,i,n)},tt(t,e,i,n){n=n||Ki.groups;let r=this;if(e&&e.j)return r.j[t]=e,e;let o=e,s,a=r.go(t);if(a?(s=new Ki,Object.assign(s.j,a.j),s.jr.push.apply(s.jr,a.jr),s.jd=a.jd,s.t=a.t):s=new Ki,o){if(n)if(s.t&&typeof s.t=="string"){let l=Object.assign(hU(s.t,n),i);pa(o,l,n)}else i&&pa(o,i,n);s.t=o}return r.j[t]=s,s}};var Ae=(t,e,i,n,r)=>t.ta(e,i,n,r),Ft=(t,e,i,n,r)=>t.tr(e,i,n,r),$4=(t,e,i,n,r)=>t.ts(e,i,n,r),Q=(t,e,i,n,r)=>t.tt(e,i,n,r),po="WORD",Db="UWORD",e5="ASCIINUMERICAL",t5="ALPHANUMERICAL",Nu="LOCALHOST",Mb="TLD",Ib="UTLD",dg="SCHEME",Ul="SLASH_SCHEME",Ob="NUM",Ab="WS",Lb="NL",Mu="OPENBRACE",Iu="CLOSEBRACE",ug="OPENBRACKET",hg="CLOSEBRACKET",pg="OPENPAREN",fg="CLOSEPAREN",gg="OPENANGLEBRACKET",mg="CLOSEANGLEBRACKET",vg="FULLWIDTHLEFTPAREN",Cg="FULLWIDTHRIGHTPAREN",wg="LEFTCORNERBRACKET",bg="RIGHTCORNERBRACKET",yg="LEFTWHITECORNERBRACKET",Sg="RIGHTWHITECORNERBRACKET",xg="FULLWIDTHLESSTHAN",Eg="FULLWIDTHGREATERTHAN",Pg="AMPERSAND",Rg="APOSTROPHE",_g="ASTERISK",cs="AT",kg="BACKSLASH",Fg="BACKTICK",Tg="CARET",ds="COLON",Nb="COMMA",Dg="DOLLAR",Er="DOT",Mg="EQUALS",Bb="EXCLAMATION",Fn="HYPHEN",Au="PERCENT",Ig="PIPE",Ag="PLUS",Og="POUND",Ou="QUERY",Hb="QUOTE",i5="FULLWIDTHMIDDLEDOT",zb="SEMI",Pr="SLASH",Lu="TILDE",Lg="UNDERSCORE",n5="EMOJI",Ng="SYM",r5=Object.freeze({__proto__:null,ALPHANUMERICAL:t5,AMPERSAND:Pg,APOSTROPHE:Rg,ASCIINUMERICAL:e5,ASTERISK:_g,AT:cs,BACKSLASH:kg,BACKTICK:Fg,CARET:Tg,CLOSEANGLEBRACKET:mg,CLOSEBRACE:Iu,CLOSEBRACKET:hg,CLOSEPAREN:fg,COLON:ds,COMMA:Nb,DOLLAR:Dg,DOT:Er,EMOJI:n5,EQUALS:Mg,EXCLAMATION:Bb,FULLWIDTHGREATERTHAN:Eg,FULLWIDTHLEFTPAREN:vg,FULLWIDTHLESSTHAN:xg,FULLWIDTHMIDDLEDOT:i5,FULLWIDTHRIGHTPAREN:Cg,HYPHEN:Fn,LEFTCORNERBRACKET:wg,LEFTWHITECORNERBRACKET:yg,LOCALHOST:Nu,NL:Lb,NUM:Ob,OPENANGLEBRACKET:gg,OPENBRACE:Mu,OPENBRACKET:ug,OPENPAREN:pg,PERCENT:Au,PIPE:Ig,PLUS:Ag,POUND:Og,QUERY:Ou,QUOTE:Hb,RIGHTCORNERBRACKET:bg,RIGHTWHITECORNERBRACKET:Sg,SCHEME:dg,SEMI:zb,SLASH:Pr,SLASH_SCHEME:Ul,SYM:Ng,TILDE:Lu,TLD:Mb,UNDERSCORE:Lg,UTLD:Ib,UWORD:Db,WORD:po,WS:Ab}),uo=/[a-z]/,Fu=new RegExp("\\p{L}","u"),Sb=new RegExp("\\p{Emoji}","u");var ho=/\d/,xb=/\s/;var K4="\r",Eb=`
`,pU="\uFE0F",fU="\u200D",Pb="\uFFFC",ag=null,lg=null;function gU(t=[]){let e={};Ki.groups=e;let i=new Ki;ag==null&&(ag=Y4(aU)),lg==null&&(lg=Y4(lU)),Q(i,"'",Rg),Q(i,"{",Mu),Q(i,"}",Iu),Q(i,"[",ug),Q(i,"]",hg),Q(i,"(",pg),Q(i,")",fg),Q(i,"<",gg),Q(i,">",mg),Q(i,"\uFF08",vg),Q(i,"\uFF09",Cg),Q(i,"\u300C",wg),Q(i,"\u300D",bg),Q(i,"\u300E",yg),Q(i,"\u300F",Sg),Q(i,"\uFF1C",xg),Q(i,"\uFF1E",Eg),Q(i,"&",Pg),Q(i,"*",_g),Q(i,"@",cs),Q(i,"`",Fg),Q(i,"^",Tg),Q(i,":",ds),Q(i,",",Nb),Q(i,"$",Dg),Q(i,".",Er),Q(i,"=",Mg),Q(i,"!",Bb),Q(i,"-",Fn),Q(i,"%",Au),Q(i,"|",Ig),Q(i,"+",Ag),Q(i,"#",Og),Q(i,"?",Ou),Q(i,'"',Hb),Q(i,"/",Pr),Q(i,";",zb),Q(i,"~",Lu),Q(i,"_",Lg),Q(i,"\\",kg),Q(i,"\u30FB",i5);let n=Ft(i,ho,Ob,{[_b]:!0});Ft(n,ho,n);let r=Ft(n,uo,e5,{[Du]:!0}),o=Ft(n,Fu,t5,{[Tu]:!0}),s=Ft(i,uo,po,{[kb]:!0});Ft(s,ho,r),Ft(s,uo,s),Ft(r,ho,r),Ft(r,uo,r);let a=Ft(i,Fu,Db,{[Fb]:!0});Ft(a,uo),Ft(a,ho,o),Ft(a,Fu,a),Ft(o,ho,o),Ft(o,uo),Ft(o,Fu,o);let l=Q(i,Eb,Lb,{[yb]:!0}),c=Q(i,K4,Ab,{[yb]:!0}),d=Ft(i,xb,Ab,{[yb]:!0});Q(i,Pb,d),Q(c,Eb,l),Q(c,Pb,d),Ft(c,xb,d),Q(d,K4),Q(d,Eb),Ft(d,xb,d),Q(d,Pb,d);let u=Ft(i,Sb,n5,{[Z4]:!0});Q(u,"#"),Ft(u,Sb,u),Q(u,pU,u);let h=Q(u,fU);Q(h,"#"),Ft(h,Sb,u);let p=[[uo,s],[ho,r]],f=[[uo,null],[Fu,a],[ho,o]];for(let g=0;g<ag.length;g++)ls(i,ag[g],Mb,po,p);for(let g=0;g<lg.length;g++)ls(i,lg[g],Ib,Db,f);pa(Mb,{tld:!0,ascii:!0},e),pa(Ib,{utld:!0,alpha:!0},e),ls(i,"file",dg,po,p),ls(i,"mailto",dg,po,p),ls(i,"http",Ul,po,p),ls(i,"https",Ul,po,p),ls(i,"ftp",Ul,po,p),ls(i,"ftps",Ul,po,p),pa(dg,{scheme:!0,ascii:!0},e),pa(Ul,{slashscheme:!0,ascii:!0},e),t=t.sort((g,m)=>g[0]>m[0]?1:-1);for(let g=0;g<t.length;g++){let m=t[g][0],C=t[g][1]?{[cU]:!0}:{[dU]:!0};m.indexOf("-")>=0?C[Tb]=!0:uo.test(m)?ho.test(m)?C[Du]=!0:C[kb]=!0:C[_b]=!0,$4(i,m,m,C)}return $4(i,"localhost",Nu,{ascii:!0}),i.jd=new Ki(Ng),{start:i,tokens:Object.assign({groups:e},r5)}}function o5(t,e){let i=mU(e.replace(/[A-Z]/g,a=>a.toLowerCase())),n=i.length,r=[],o=0,s=0;for(;s<n;){let a=t,l=null,c=0,d=null,u=-1,h=-1;for(;s<n&&(l=a.go(i[s]));)a=l,a.accepts()?(u=0,h=0,d=a):u>=0&&(u+=i[s].length,h++),c+=i[s].length,o+=i[s].length,s++;o-=u,s-=h,c-=u,r.push({t:d.t,v:e.slice(o-c,o),s:o-c,e:o})}return r}function mU(t){let e=[],i=t.length,n=0;for(;n<i;){let r=t.charCodeAt(n),o,s=r<55296||r>56319||n+1===i||(o=t.charCodeAt(n+1))<56320||o>57343?t[n]:t.slice(n,n+2);e.push(s),n+=s.length}return e}function ls(t,e,i,n,r){let o,s=e.length;for(let a=0;a<s-1;a++){let l=e[a];t.j[l]?o=t.j[l]:(o=new Ki(n),o.jr=r.slice(),t.j[l]=o),t=o}return o=new Ki(i),o.jr=r.slice(),t.j[e[s-1]]=o,o}function Y4(t){let e=[],i=[],n=0,r="0123456789";for(;n<t.length;){let o=0;for(;r.indexOf(t[n+o])>=0;)o++;if(o>0){e.push(i.join(""));for(let s=parseInt(t.substring(n,n+o),10);s>0;s--)i.pop();n+=o}else i.push(t[n]),n++}return e}var Bu={defaultProtocol:"http",events:null,format:X4,formatHref:X4,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function Vb(t,e=null){let i=Object.assign({},Bu);t&&(i=Object.assign(i,t instanceof Vb?t.o:t));let n=i.ignoreTags,r=[];for(let o=0;o<n.length;o++)r.push(n[o].toUpperCase());this.o=i,e&&(this.defaultRender=e),this.ignoreTags=r}Vb.prototype={o:Bu,ignoreTags:[],defaultRender(t){return t},check(t){return this.get("validate",t.toString(),t)},get(t,e,i){let n=e!=null,r=this.o[t];return r&&(typeof r=="object"?(r=i.t in r?r[i.t]:Bu[t],typeof r=="function"&&n&&(r=r(e,i))):typeof r=="function"&&n&&(r=r(e,i.t,i)),r)},getObj(t,e,i){let n=this.o[t];return typeof n=="function"&&e!=null&&(n=n(e,i.t,i)),n},render(t){let e=t.render(this);return(this.get("render",null,t)||this.defaultRender)(e,t.t,t)}};function X4(t){return t}function s5(t,e){this.t="token",this.v=t,this.tk=e}s5.prototype={isLink:!1,toString(){return this.v},toHref(t){return this.toString()},toFormattedString(t){let e=this.toString(),i=t.get("truncate",e,this),n=t.get("format",e,this);return i&&n.length>i?n.substring(0,i)+"\u2026":n},toFormattedHref(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(t=Bu.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate(t){return t.get("validate",this.toString(),this)},render(t){let e=this,i=this.toHref(t.get("defaultProtocol")),n=t.get("formatHref",i,this),r=t.get("tagName",i,e),o=this.toFormattedString(t),s={},a=t.get("className",i,e),l=t.get("target",i,e),c=t.get("rel",i,e),d=t.getObj("attributes",i,e),u=t.getObj("events",i,e);return s.href=n,a&&(s.class=a),l&&(s.target=l),c&&(s.rel=c),d&&Object.assign(s,d),{tagName:r,attributes:s,content:o,eventListeners:u}}};function Bg(t,e){class i extends s5{constructor(r,o){super(r,o),this.t=t}}for(let n in e)i.prototype[n]=e[n];return i.t=t,i}var J4=Bg("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),Q4=Bg("text"),vU=Bg("nl"),cg=Bg("url",{isLink:!0,toHref(t=Bu.defaultProtocol){return this.hasProtocol()?this.v:`${t}://${this.v}`},hasProtocol(){let t=this.tk;return t.length>=2&&t[0].t!==Nu&&t[1].t===ds}});var kn=t=>new Ki(t);function CU({groups:t}){let e=t.domain.concat([Pg,_g,cs,kg,Fg,Tg,Dg,Mg,Fn,Ob,Au,Ig,Ag,Og,Pr,Ng,Lu,Lg]),i=[Rg,ds,Nb,Er,Bb,Au,Ou,Hb,zb,gg,mg,Mu,Iu,hg,ug,pg,fg,vg,Cg,wg,bg,yg,Sg,xg,Eg],n=[Pg,Rg,_g,kg,Fg,Tg,Dg,Mg,Fn,Mu,Iu,Au,Ig,Ag,Og,Ou,Pr,Ng,Lu,Lg],r=kn(),o=Q(r,Lu);Ae(o,n,o),Ae(o,t.domain,o);let s=kn(),a=kn(),l=kn();Ae(r,t.domain,s),Ae(r,t.scheme,a),Ae(r,t.slashscheme,l),Ae(s,n,o),Ae(s,t.domain,s);let c=Q(s,cs);Q(o,cs,c),Q(a,cs,c),Q(l,cs,c);let d=Q(o,Er);Ae(d,n,o),Ae(d,t.domain,o);let u=kn();Ae(c,t.domain,u),Ae(u,t.domain,u);let h=Q(u,Er);Ae(h,t.domain,u);let p=kn(J4);Ae(h,t.tld,p),Ae(h,t.utld,p),Q(c,Nu,p);let f=Q(u,Fn);Q(f,Fn,f),Ae(f,t.domain,u),Ae(p,t.domain,u),Q(p,Er,h),Q(p,Fn,f);let g=Q(p,ds);Ae(g,t.numeric,J4);let m=Q(s,Fn),v=Q(s,Er);Q(m,Fn,m),Ae(m,t.domain,s),Ae(v,n,o),Ae(v,t.domain,s);let C=kn(cg);Ae(v,t.tld,C),Ae(v,t.utld,C),Ae(C,t.domain,s),Ae(C,n,o),Q(C,Er,v),Q(C,Fn,m),Q(C,cs,c);let b=Q(C,ds),S=kn(cg);Ae(b,t.numeric,S);let x=kn(cg),E=kn();Ae(x,e,x),Ae(x,i,E),Ae(E,e,x),Ae(E,i,E),Q(C,Pr,x),Q(S,Pr,x);let P=Q(a,ds),L=Q(l,ds),B=Q(L,Pr),j=Q(B,Pr);Ae(a,t.domain,s),Q(a,Er,v),Q(a,Fn,m),Ae(l,t.domain,s),Q(l,Er,v),Q(l,Fn,m),Ae(P,t.domain,x),Q(P,Pr,x),Q(P,Ou,x),Ae(j,t.domain,x),Ae(j,e,x),Q(j,Pr,x);let q=[[Mu,Iu],[ug,hg],[pg,fg],[gg,mg],[vg,Cg],[wg,bg],[yg,Sg],[xg,Eg]];for(let Y=0;Y<q.length;Y++){let[he,Se]=q[Y],be=Q(x,he);Q(E,he,be),Q(be,Se,x);let T=kn(cg);Ae(be,e,T);let R=kn();Ae(be,i),Ae(T,e,T),Ae(T,i,R),Ae(R,e,T),Ae(R,i,R),Q(T,Se,x),Q(R,Se,x)}return Q(r,Nu,C),Q(r,Lb,vU),{start:r,tokens:r5}}function wU(t,e,i){let n=i.length,r=0,o=[],s=[];for(;r<n;){let a=t,l=null,c=null,d=0,u=null,h=-1;for(;r<n&&!(l=a.go(i[r].t));)s.push(i[r++]);for(;r<n&&(c=l||a.go(i[r].t));)l=null,a=c,a.accepts()?(h=0,u=a):h>=0&&h++,r++,d++;if(h<0)r-=d,r<n&&(s.push(i[r]),r++);else{s.length>0&&(o.push(Rb(Q4,e,s)),s=[]),r-=h,d-=h;let p=u.t,f=i.slice(r-d,r);o.push(Rb(p,e,f))}}return s.length>0&&o.push(Rb(Q4,e,s)),o}function Rb(t,e,i){let n=i[0].s,r=i[i.length-1].e,o=e.slice(n,r);return new t(o,i)}var bU=typeof console<"u"&&console&&console.warn||(()=>{}),yU="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",vt={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function a5(){return Ki.groups={},vt.scanner=null,vt.parser=null,vt.tokenQueue=[],vt.pluginQueue=[],vt.customSchemes=[],vt.initialized=!1,vt}function Gb(t,e=!1){if(vt.initialized&&bU(`linkifyjs: already initialized - will not register custom scheme "${t}" ${yU}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(t))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);vt.customSchemes.push([t,e])}function SU(){vt.scanner=gU(vt.customSchemes);for(let t=0;t<vt.tokenQueue.length;t++)vt.tokenQueue[t][1]({scanner:vt.scanner});vt.parser=CU(vt.scanner.tokens);for(let t=0;t<vt.pluginQueue.length;t++)vt.pluginQueue[t][1]({scanner:vt.scanner,parser:vt.parser});return vt.initialized=!0,vt}function Hg(t){return vt.initialized||SU(),wU(vt.parser.start,t,o5(vt.scanner.start,t))}Hg.scan=o5;function zg(t,e=null,i=null){if(e&&typeof e=="object"){if(i)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);i=e,e=null}let n=new Vb(i),r=Hg(t),o=[];for(let s=0;s<r.length;s++){let a=r[s];a.isLink&&(!e||a.t===e)&&n.check(a)&&o.push(a.toFormattedObject(n))}return o}var Wb="[\0- \xA0\u1680\u180E\u2000-\u2029\u205F\u3000]",xU=new RegExp(Wb),EU=new RegExp(`${Wb}$`),PU=new RegExp(Wb,"g");function RU(t){return t.length===1?t[0].isLink:t.length===3&&t[1].isLink?["()","[]"].includes(t[0].value+t[2].value):!1}function _U(t){return new Te({key:new Oe("autolink"),appendTransaction:(e,i,n)=>{let r=e.some(c=>c.docChanged)&&!i.doc.eq(n.doc),o=e.some(c=>c.getMeta("preventAutolink"));if(!r||o)return;let{tr:s}=n,a=pb(i.doc,[...e]);if(vb(a).forEach(({newRange:c})=>{let d=y4(n.doc,c,p=>p.isTextblock),u,h;if(d.length>1)u=d[0],h=n.doc.textBetween(u.pos,u.pos+u.node.nodeSize,void 0," ");else if(d.length){let p=n.doc.textBetween(c.from,c.to," "," ");if(!EU.test(p))return;u=d[0],h=n.doc.textBetween(u.pos,c.to,void 0," ")}if(u&&h){let p=h.split(xU).filter(Boolean);if(p.length<=0)return!1;let f=p[p.length-1],g=u.pos+h.lastIndexOf(f);if(!f)return!1;let m=Hg(f).map(v=>v.toObject(t.defaultProtocol));if(!RU(m))return!1;m.filter(v=>v.isLink).map(v=>k(w({},v),{from:g+v.start+1,to:g+v.end+1})).filter(v=>n.schema.marks.code?!n.doc.rangeHasMark(v.from,v.to,n.schema.marks.code):!0).filter(v=>t.validate(v.value)).filter(v=>t.shouldAutoLink(v.value)).forEach(v=>{ng(v.from,v.to,n.doc).some(C=>C.mark.type===t.type)||s.addMark(v.from,v.to,t.type.create({href:v.href}))})}}),!!s.steps.length)return s}})}function kU(t){return new Te({key:new Oe("handleClickLink"),props:{handleClick:(e,i,n)=>{var r,o;if(n.button!==0||!e.editable)return!1;let s=null;if(n.target instanceof HTMLAnchorElement)s=n.target;else{let d=n.target,u=[];for(;d.nodeName!=="DIV";)u.push(d),d=d.parentNode;s=u.find(h=>h.nodeName==="A")}if(!s)return!1;let a=mb(e.state,t.type.name),l=(r=s?.href)!=null?r:a.href,c=(o=s?.target)!=null?o:a.target;return t.enableClickSelection&&t.editor.commands.extendMarkRange(t.type.name),s&&l?(window.open(l,c),!0):!1}}})}function FU(t){return new Te({key:new Oe("handlePasteLink"),props:{handlePaste:(e,i,n)=>{let{shouldAutoLink:r}=t,{state:o}=e,{selection:s}=o,{empty:a}=s;if(a)return!1;let l="";n.content.forEach(d=>{l+=d.textContent});let c=zg(l,{defaultProtocol:t.defaultProtocol}).find(d=>d.isLink&&d.value===l);return!l||!c||r!==void 0&&!r(c.href)?!1:t.editor.commands.setMark(t.type,{href:c.href})}}})}function fa(t,e){let i=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(n=>{let r=typeof n=="string"?n:n.scheme;r&&i.push(r)}),!t||t.replace(PU,"").match(new RegExp(`^(?:(?:${i.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var Ub=an.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(t=>{if(typeof t=="string"){Gb(t);return}Gb(t.scheme,t.optionalSlashes)})},onDestroy(){a5()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(t,e)=>!!fa(t,e.protocols),validate:t=>!!t,shouldAutoLink:t=>!!t}},addAttributes(){return{href:{default:null,parseHTML(t){return t.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:t=>{let e=t.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:i=>!!fa(i,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:t}){return this.options.isAllowedUri(t.href,{defaultValidate:e=>!!fa(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",Ge(this.options.HTMLAttributes,t),0]:["a",Ge(this.options.HTMLAttributes,k(w({},t),{href:""})),0]},markdownTokenName:"link",parseMarkdown:(t,e)=>e.applyMark("link",e.parseInline(t.tokens||[]),{href:t.href,title:t.title||null}),renderMarkdown:(t,e)=>{var i;let n=((i=t.attrs)==null?void 0:i.href)||"";return`[${e.renderChildren(t)}](${n})`},addCommands(){return{setLink:t=>({chain:e})=>{let{href:i}=t;return this.options.isAllowedUri(i,{defaultValidate:n=>!!fa(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,t).setMeta("preventAutolink",!0).run():!1},toggleLink:t=>({chain:e})=>{let{href:i}=t||{};return i&&!this.options.isAllowedUri(i,{defaultValidate:n=>!!fa(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[_n({find:t=>{let e=[];if(t){let{protocols:i,defaultProtocol:n}=this.options,r=zg(t).filter(o=>o.isLink&&this.options.isAllowedUri(o.value,{defaultValidate:s=>!!fa(s,i),protocols:i,defaultProtocol:n}));r.length&&r.forEach(o=>{this.options.shouldAutoLink(o.value)&&e.push({text:o.value,data:{href:o.href},index:o.start})})}return e},type:this.type,getAttributes:t=>{var e;return{href:(e=t.data)==null?void 0:e.href}}})]},addProseMirrorPlugins(){let t=[],{protocols:e,defaultProtocol:i}=this.options;return this.options.autolink&&t.push(_U({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:n=>this.options.isAllowedUri(n,{defaultValidate:r=>!!fa(r,e),protocols:e,defaultProtocol:i}),shouldAutoLink:this.options.shouldAutoLink})),this.options.openOnClick===!0&&t.push(kU({type:this.type,editor:this.editor,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&t.push(FU({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),t}}),l5=Ub;var jl=(t,e)=>{if(t==="slot")return 0;if(t instanceof Function)return t(e);let r=e??{},{children:i}=r,n=Vt(r,["children"]);if(t==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[t,n,i]};var TU=/^\s*>\s$/,c5=gt.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return jl("blockquote",k(w({},Ge(this.options.HTMLAttributes,t)),{children:jl("slot",{})}))},parseMarkdown:(t,e)=>e.createNode("blockquote",void 0,e.parseChildren(t.tokens||[])),renderMarkdown:(t,e)=>{if(!t.content)return"";let i=">",n=[];return t.content.forEach(r=>{let a=e.renderChildren([r]).split(`
`).map(l=>l.trim()===""?i:`${i} ${l}`);n.push(a.join(`
`))}),n.join(`
${i}
`)},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[xr({find:TU,type:this.type})]}});var DU=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,MU=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,IU=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,AU=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,d5=an.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return jl("strong",k(w({},Ge(this.options.HTMLAttributes,t)),{children:jl("slot",{})}))},markdownTokenName:"strong",parseMarkdown:(t,e)=>e.applyMark("bold",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`**${e.renderChildren(t)}**`,addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Sr({find:DU,type:this.type}),Sr({find:IU,type:this.type})]},addPasteRules(){return[_n({find:MU,type:this.type}),_n({find:AU,type:this.type})]}});var OU=/(^|[^`])`([^`]+)`(?!`)$/,LU=/(^|[^`])`([^`]+)`(?!`)/g,u5=an.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",Ge(this.options.HTMLAttributes,t),0]},markdownTokenName:"codespan",parseMarkdown:(t,e)=>e.applyMark("code",[{type:"text",text:t.text||""}]),renderMarkdown:(t,e)=>t.content?`\`${e.renderChildren(t.content)}\``:"",addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Sr({find:OU,type:this.type})]},addPasteRules(){return[_n({find:LU,type:this.type})]}});var jb=4,NU=/^```([a-z]+)?[\s\n]$/,BU=/^~~~([a-z]+)?[\s\n]$/,h5=gt.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:jb,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;let{languageClassPrefix:i}=this.options;if(!i)return null;let o=[...((e=t.firstElementChild)==null?void 0:e.classList)||[]].filter(s=>s.startsWith(i)).map(s=>s.replace(i,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",Ge(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(t,e)=>{var i;return((i=t.raw)==null?void 0:i.startsWith("```"))===!1&&t.codeBlockStyle!=="indented"?[]:e.createNode("codeBlock",{language:t.lang||null},t.text?[e.createTextNode(t.text)]:[])},renderMarkdown:(t,e)=>{var i;let n="",r=((i=t.attrs)==null?void 0:i.language)||"";return t.content?n=[`\`\`\`${r}`,e.renderChildren(t.content),"```"].join(`
`):n=`\`\`\`${r}

\`\`\``,n},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{let{empty:t,$anchor:e}=this.editor.state.selection,i=e.pos===1;return!t||e.parent.type.name!==this.name?!1:i||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;let i=(e=this.options.tabSize)!=null?e:jb,{state:n}=t,{selection:r}=n,{$from:o,empty:s}=r;if(o.parent.type!==this.type)return!1;let a=" ".repeat(i);return s?t.commands.insertContent(a):t.commands.command(({tr:l})=>{let{from:c,to:d}=r,p=n.doc.textBetween(c,d,`
`,`
`).split(`
`).map(f=>a+f).join(`
`);return l.replaceWith(c,d,n.schema.text(p)),!0})},"Shift-Tab":({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;let i=(e=this.options.tabSize)!=null?e:jb,{state:n}=t,{selection:r}=n,{$from:o,empty:s}=r;return o.parent.type!==this.type?!1:s?t.commands.command(({tr:a})=>{var l;let{pos:c}=o,d=o.start(),u=o.end(),p=n.doc.textBetween(d,u,`
`,`
`).split(`
`),f=0,g=0,m=c-d;for(let E=0;E<p.length;E+=1){if(g+p[E].length>=m){f=E;break}g+=p[E].length+1}let C=((l=p[f].match(/^ */))==null?void 0:l[0])||"",b=Math.min(C.length,i);if(b===0)return!0;let S=d;for(let E=0;E<f;E+=1)S+=p[E].length+1;return a.delete(S,S+b),c-S<=b&&a.setSelection(Pe.create(a.doc,S)),!0}):t.commands.command(({tr:a})=>{let{from:l,to:c}=r,h=n.doc.textBetween(l,c,`
`,`
`).split(`
`).map(p=>{var f;let g=((f=p.match(/^ */))==null?void 0:f[0])||"",m=Math.min(g.length,i);return p.slice(m)}).join(`
`);return a.replaceWith(l,c,n.schema.text(h)),!0})},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;let{state:e}=t,{selection:i}=e,{$from:n,empty:r}=i;if(!r||n.parent.type!==this.type)return!1;let o=n.parentOffset===n.parent.nodeSize-2,s=n.parent.textContent.endsWith(`

`);return!o||!s?!1:t.chain().command(({tr:a})=>(a.delete(n.pos-2,n.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;let{state:e}=t,{selection:i,doc:n}=e,{$from:r,empty:o}=i;if(!o||r.parent.type!==this.type||!(r.parentOffset===r.parent.nodeSize-2))return!1;let a=r.after();return a===void 0?!1:n.nodeAt(a)?t.commands.command(({tr:c})=>(c.setSelection(ke.near(n.resolve(a))),!0)):t.commands.exitCode()}}},addInputRules(){return[_u({find:NU,type:this.type,getAttributes:t=>({language:t[1]})}),_u({find:BU,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new Te({key:new Oe("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;let i=e.clipboardData.getData("text/plain"),n=e.clipboardData.getData("vscode-editor-data"),r=n?JSON.parse(n):void 0,o=r?.mode;if(!i||!o)return!1;let{tr:s,schema:a}=t.state,l=a.text(i.replace(/\r\n?/g,`
`));return s.replaceSelectionWith(this.type.create({language:o},l)),s.selection.$from.parent.type!==this.type&&s.setSelection(Pe.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),t.dispatch(s),!0}}})]}});var p5=gt.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`

`):""});var f5=gt.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",Ge(this.options.HTMLAttributes,t)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:i,editor:n})=>t.first([()=>t.exitCode(),()=>t.command(()=>{let{selection:r,storedMarks:o}=i;if(r.$from.parent.type.spec.isolating)return!1;let{keepMarks:s}=this.options,{splittableMarks:a}=n.extensionManager,l=o||r.$to.parentOffset&&r.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:d})=>{if(d&&l&&s){let u=l.filter(h=>a.includes(h.type.name));c.ensureMarks(u)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}});var g5=gt.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,Ge(this.options.HTMLAttributes,e),0]},parseMarkdown:(t,e)=>e.createNode("heading",{level:t.depth||1},e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>{var i;let n=(i=t.attrs)!=null&&i.level?parseInt(t.attrs.level,10):1,r="#".repeat(n);return t.content?`${r} ${e.renderChildren(t.content)}`:""},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>k(w({},t),{[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>_u({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}});var m5=gt.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",Ge(this.options.HTMLAttributes,t)]},markdownTokenName:"hr",parseMarkdown:(t,e)=>e.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!j4(e,e.schema.nodes[this.name]))return!1;let{selection:i}=e,{$to:n}=i,r=t();return rg(i)?r.insertContentAt(n.pos,{type:this.name}):r.insertContent({type:this.name}),r.command(({state:o,tr:s,dispatch:a})=>{if(a){let{$to:l}=s.selection,c=l.end();if(l.nodeAfter)l.nodeAfter.isTextblock?s.setSelection(Pe.create(s.doc,l.pos+1)):l.nodeAfter.isBlock?s.setSelection(ye.create(s.doc,l.pos)):s.setSelection(Pe.create(s.doc,l.pos));else{let d=o.schema.nodes[this.options.nextNodeType]||l.parent.type.contentMatch.defaultType,u=d?.create();u&&(s.insert(c,u),s.setSelection(Pe.create(s.doc,c+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[U4({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}});var HU=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,zU=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,VU=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,GU=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,v5=an.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",Ge(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(t,e)=>e.applyMark("italic",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`*${e.renderChildren(t)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Sr({find:HU,type:this.type}),Sr({find:VU,type:this.type})]},addPasteRules(){return[_n({find:zU,type:this.type}),_n({find:GU,type:this.type})]}});var WU=Object.defineProperty,UU=(t,e)=>{for(var i in e)WU(t,i,{get:e[i],enumerable:!0})},jU="listItem",C5="textStyle",w5=/^\s*([-+*])\s$/,Kb=gt.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",Ge(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>t.type!=="list"||t.ordered?[]:{type:"bulletList",content:t.items?e.parseChildren(t.items):[]},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(jU,this.editor.getAttributes(C5)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=xr({find:w5,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=xr({find:w5,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(C5),editor:this.editor})),[t]}}),Yb=gt.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",Ge(this.options.HTMLAttributes,t),0]},markdownTokenName:"list_item",parseMarkdown:(t,e)=>{if(t.type!=="list_item")return[];let i=[];if(t.tokens&&t.tokens.length>0)if(t.tokens.some(r=>r.type==="paragraph"))i=e.parseChildren(t.tokens);else{let r=t.tokens[0];if(r&&r.type==="text"&&r.tokens&&r.tokens.length>0){if(i=[{type:"paragraph",content:e.parseInline(r.tokens)}],t.tokens.length>1){let s=t.tokens.slice(1),a=e.parseChildren(s);i.push(...a)}}else i=e.parseChildren(t.tokens)}return i.length===0&&(i=[{type:"paragraph",content:[]}]),{type:"listItem",content:i}},renderMarkdown:(t,e,i)=>ku(t,e,n=>n.parentType==="bulletList"?"- ":n.parentType==="orderedList"?`${n.index+1}. `:"- ",i),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),qU={};UU(qU,{findListItemPos:()=>Hu,getNextListDepth:()=>Xb,handleBackspace:()=>qb,handleDelete:()=>$b,hasListBefore:()=>x5,hasListItemAfter:()=>$U,hasListItemBefore:()=>E5,listItemHasSubList:()=>P5,nextListIsDeeper:()=>R5,nextListIsHigher:()=>_5});var Hu=(t,e)=>{let{$from:i}=e.selection,n=kt(t,e.schema),r=null,o=i.depth,s=i.pos,a=null;for(;o>0&&a===null;)r=i.node(o),r.type===n?a=o:(o-=1,s-=1);return a===null?null:{$pos:e.doc.resolve(s),depth:a}},Xb=(t,e)=>{let i=Hu(t,e);if(!i)return!1;let[,n]=R4(e,t,i.$pos.pos+4);return n},x5=(t,e,i)=>{let{$anchor:n}=t.selection,r=Math.max(0,n.pos-2),o=t.doc.resolve(r).node();return!(!o||!i.includes(o.type.name))},E5=(t,e)=>{var i;let{$anchor:n}=e.selection,r=e.doc.resolve(n.pos-2);return!(r.index()===0||((i=r.nodeBefore)==null?void 0:i.type.name)!==t)},P5=(t,e,i)=>{if(!i)return!1;let n=kt(t,e.schema),r=!1;return i.descendants(o=>{o.type===n&&(r=!0)}),r},qb=(t,e,i)=>{if(t.commands.undoInputRule())return!0;if(t.state.selection.from!==t.state.selection.to)return!1;if(!yr(t.state,e)&&x5(t.state,e,i)){let{$anchor:a}=t.state.selection,l=t.state.doc.resolve(a.before()-1),c=[];l.node().descendants((h,p)=>{h.type.name===e&&c.push({node:h,pos:p})});let d=c.at(-1);if(!d)return!1;let u=t.state.doc.resolve(l.start()+d.pos+1);return t.chain().cut({from:a.start()-1,to:a.end()+1},u.end()).joinForward().run()}if(!yr(t.state,e)||!k4(t.state))return!1;let n=Hu(e,t.state);if(!n)return!1;let o=t.state.doc.resolve(n.$pos.pos-2).node(n.depth),s=P5(e,t.state,o);return E5(e,t.state)&&!s?t.commands.joinItemBackward():t.chain().liftListItem(e).run()},R5=(t,e)=>{let i=Xb(t,e),n=Hu(t,e);return!n||!i?!1:i>n.depth},_5=(t,e)=>{let i=Xb(t,e),n=Hu(t,e);return!n||!i?!1:i<n.depth},$b=(t,e)=>{if(!yr(t.state,e)||!_4(t.state,e))return!1;let{selection:i}=t.state,{$from:n,$to:r}=i;return!i.empty&&n.sameParent(r)?!1:R5(e,t.state)?t.chain().focus(t.state.selection.from+4).lift(e).joinBackward().run():_5(e,t.state)?t.chain().joinForward().joinBackward().run():t.commands.joinItemForward()},$U=(t,e)=>{var i;let{$anchor:n}=e.selection,r=e.doc.resolve(n.pos-n.parentOffset-2);return!(r.index()===r.parent.childCount-1||((i=r.nodeAfter)==null?void 0:i.type.name)!==t)},Jb=Je.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:i})=>{t.state.schema.nodes[i]!==void 0&&$b(t,i)&&(e=!0)}),e},"Mod-Delete":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:i})=>{t.state.schema.nodes[i]!==void 0&&$b(t,i)&&(e=!0)}),e},Backspace:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:i,wrapperNames:n})=>{t.state.schema.nodes[i]!==void 0&&qb(t,i,n)&&(e=!0)}),e},"Mod-Backspace":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:i,wrapperNames:n})=>{t.state.schema.nodes[i]!==void 0&&qb(t,i,n)&&(e=!0)}),e}}}}),b5=/^(\s*)(\d+)\.\s+(.*)$/,KU=/^\s/;function YU(t){let e=[],i=0,n=0;for(;i<t.length;){let r=t[i],o=r.match(b5);if(!o)break;let[,s,a,l]=o,c=s.length,d=l,u=i+1,h=[r];for(;u<t.length;){let p=t[u];if(p.match(b5))break;if(p.trim()==="")h.push(p),d+=`
`,u+=1;else if(p.match(KU))h.push(p),d+=`
${p.slice(c+2)}`,u+=1;else break}e.push({indent:c,number:parseInt(a,10),content:d.trim(),raw:h.join(`
`)}),n=u,i=u}return[e,n]}function k5(t,e,i){var n;let r=[],o=0;for(;o<t.length;){let s=t[o];if(s.indent===e){let a=s.content.split(`
`),l=((n=a[0])==null?void 0:n.trim())||"",c=[];l&&c.push({type:"paragraph",raw:l,tokens:i.inlineTokens(l)});let d=a.slice(1).join(`
`).trim();if(d){let p=i.blockTokens(d);c.push(...p)}let u=o+1,h=[];for(;u<t.length&&t[u].indent>e;)h.push(t[u]),u+=1;if(h.length>0){let p=Math.min(...h.map(g=>g.indent)),f=k5(h,p,i);c.push({type:"list",ordered:!0,start:h[0].number,items:f,raw:h.map(g=>g.raw).join(`
`)})}r.push({type:"list_item",raw:s.raw,tokens:c}),o=u}else o+=1}return r}function XU(t,e){return t.map(i=>{if(i.type!=="list_item")return e.parseChildren([i])[0];let n=[];return i.tokens&&i.tokens.length>0&&i.tokens.forEach(r=>{if(r.type==="paragraph"||r.type==="list"||r.type==="blockquote"||r.type==="code")n.push(...e.parseChildren([r]));else if(r.type==="text"&&r.tokens){let o=e.parseChildren([r]);n.push({type:"paragraph",content:o})}else{let o=e.parseChildren([r]);o.length>0&&n.push(...o)}}),{type:"listItem",content:n}})}var JU="listItem",y5="textStyle",S5=/^(\d+)\.\s$/,Qb=gt.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){let n=t,{start:e}=n,i=Vt(n,["start"]);return e===1?["ol",Ge(this.options.HTMLAttributes,i),0]:["ol",Ge(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>{if(t.type!=="list"||!t.ordered)return[];let i=t.start||1,n=t.items?XU(t.items,e):[];return i!==1?{type:"orderedList",attrs:{start:i},content:n}:{type:"orderedList",content:n}},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:t=>{let e=t.match(/^(\s*)(\d+)\.\s+/),i=e?.index;return i!==void 0?i:-1},tokenize:(t,e,i)=>{var n;let r=t.split(`
`),[o,s]=YU(r);if(o.length===0)return;let a=k5(o,0,i);return a.length===0?void 0:{type:"list",ordered:!0,start:((n=o[0])==null?void 0:n.number)||1,items:a,raw:r.slice(0,s).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(JU,this.editor.getAttributes(y5)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=xr({find:S5,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,i)=>i.childCount+i.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=xr({find:S5,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>w({start:+e[1]},this.editor.getAttributes(y5)),joinPredicate:(e,i)=>i.childCount+i.attrs.start===+e[1],editor:this.editor})),[t]}}),QU=/^\s*(\[([( |x])?\])\s$/,ZU=gt.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:t=>{let e=t.getAttribute("data-checked");return e===""||e==="true"},renderHTML:t=>({"data-checked":t.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:t,HTMLAttributes:e}){return["li",Ge(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:t.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(t,e)=>{let i=[];if(t.tokens&&t.tokens.length>0?i.push(e.createNode("paragraph",{},e.parseInline(t.tokens))):t.text?i.push(e.createNode("paragraph",{},[e.createNode("text",{text:t.text})])):i.push(e.createNode("paragraph",{},[])),t.nestedTokens&&t.nestedTokens.length>0){let n=e.parseChildren(t.nestedTokens);i.push(...n)}return e.createNode("taskItem",{checked:t.checked||!1},i)},renderMarkdown:(t,e)=>{var i;let r=`- [${(i=t.attrs)!=null&&i.checked?"x":" "}] `;return ku(t,e,r)},addKeyboardShortcuts(){let t={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?k(w({},t),{Tab:()=>this.editor.commands.sinkListItem(this.name)}):t},addNodeView(){return({node:t,HTMLAttributes:e,getPos:i,editor:n})=>{let r=document.createElement("li"),o=document.createElement("label"),s=document.createElement("span"),a=document.createElement("input"),l=document.createElement("div"),c=d=>{var u,h;a.ariaLabel=((h=(u=this.options.a11y)==null?void 0:u.checkboxLabel)==null?void 0:h.call(u,d,a.checked))||`Task item checkbox for ${d.textContent||"empty task item"}`};return c(t),o.contentEditable="false",a.type="checkbox",a.addEventListener("mousedown",d=>d.preventDefault()),a.addEventListener("change",d=>{if(!n.isEditable&&!this.options.onReadOnlyChecked){a.checked=!a.checked;return}let{checked:u}=d.target;n.isEditable&&typeof i=="function"&&n.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:h})=>{let p=i();if(typeof p!="number")return!1;let f=h.doc.nodeAt(p);return h.setNodeMarkup(p,void 0,k(w({},f?.attrs),{checked:u})),!0}).run(),!n.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(t,u)||(a.checked=!a.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([d,u])=>{r.setAttribute(d,u)}),r.dataset.checked=t.attrs.checked,a.checked=t.attrs.checked,o.append(a,s),r.append(o,l),Object.entries(e).forEach(([d,u])=>{r.setAttribute(d,u)}),{dom:r,contentDOM:l,update:d=>d.type!==this.type?!1:(r.dataset.checked=d.attrs.checked,a.checked=d.attrs.checked,c(d),!0)}}},addInputRules(){return[xr({find:QU,type:this.type,getAttributes:t=>({checked:t[t.length-1]==="x"})})]}}),ej=gt.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:t}){return["ul",Ge(this.options.HTMLAttributes,t,{"data-type":this.name}),0]},parseMarkdown:(t,e)=>e.createNode("taskList",{},e.parseChildren(t.items||[])),renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(t){var e;let i=(e=t.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:e.index;return i!==void 0?i:-1},tokenize(t,e,i){let n=o=>{let s=sg(o,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:a=>({indentLevel:a[1].length,mainContent:a[4],checked:a[3].toLowerCase()==="x"}),createToken:(a,l)=>({type:"taskItem",raw:"",mainContent:a.mainContent,indentLevel:a.indentLevel,checked:a.checked,text:a.mainContent,tokens:i.inlineTokens(a.mainContent),nestedTokens:l}),customNestedParser:n},i);return s?[{type:"taskList",raw:s.raw,items:s.items}]:i.blockTokens(o)},r=sg(t,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:o=>({indentLevel:o[1].length,mainContent:o[4],checked:o[3].toLowerCase()==="x"}),createToken:(o,s)=>({type:"taskItem",raw:"",mainContent:o.mainContent,indentLevel:o.indentLevel,checked:o.checked,text:o.mainContent,tokens:i.inlineTokens(o.mainContent),nestedTokens:s}),customNestedParser:n},i);if(r)return{type:"taskList",raw:r.raw,items:r.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}}),Q3e=Je.create({name:"listKit",addExtensions(){let t=[];return this.options.bulletList!==!1&&t.push(Kb.configure(this.options.bulletList)),this.options.listItem!==!1&&t.push(Yb.configure(this.options.listItem)),this.options.listKeymap!==!1&&t.push(Jb.configure(this.options.listKeymap)),this.options.orderedList!==!1&&t.push(Qb.configure(this.options.orderedList)),this.options.taskItem!==!1&&t.push(ZU.configure(this.options.taskItem)),this.options.taskList!==!1&&t.push(ej.configure(this.options.taskList)),t}});var F5=gt.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",Ge(this.options.HTMLAttributes,t),0]},parseMarkdown:(t,e)=>{let i=t.tokens||[];return i.length===1&&i[0].type==="image"?e.parseChildren([i[0]]):e.createNode("paragraph",void 0,e.parseInline(i))},renderMarkdown:(t,e)=>!t||!Array.isArray(t.content)?"":e.renderChildren(t.content),addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}});var tj=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,ij=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,T5=an.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",Ge(this.options.HTMLAttributes,t),0]},markdownTokenName:"del",parseMarkdown:(t,e)=>e.applyMark("strike",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`~~${e.renderChildren(t)}~~`,addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Sr({find:tj,type:this.type})]},addPasteRules(){return[_n({find:ij,type:this.type})]}});var D5=gt.create({name:"text",group:"inline",parseMarkdown:t=>({type:"text",text:t.text||""}),renderMarkdown:t=>t.text||""});var M5=an.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",Ge(this.options.HTMLAttributes,t),0]},parseMarkdown(t,e){return e.applyMark(this.name||"underline",e.parseInline(t.tokens||[]))},renderMarkdown(t,e){return`++${e.renderChildren(t)}++`},markdownTokenizer:{name:"underline",level:"inline",start(t){return t.indexOf("++")},tokenize(t,e,i){let r=/^(\+\+)([\s\S]+?)(\+\+)/.exec(t);if(!r)return;let o=r[2].trim();return{type:"underline",raw:r[0],text:o,tokens:i.inlineTokens(o)}}},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});function I5(t={}){return new Te({view(e){return new Zb(e,t)}})}var Zb=class{constructor(e,i){var n;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(n=i.width)!==null&&n!==void 0?n:1,this.color=i.color===!1?void 0:i.color||"black",this.class=i.class,this.handlers=["dragover","dragend","drop","dragleave"].map(r=>{let o=s=>{this[r](s)};return e.dom.addEventListener(r,o),{name:r,handler:o}})}destroy(){this.handlers.forEach(({name:e,handler:i})=>this.editorView.dom.removeEventListener(e,i))}update(e,i){this.cursorPos!=null&&i.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),i=!e.parent.inlineContent,n,r=this.editorView.dom,o=r.getBoundingClientRect(),s=o.width/r.offsetWidth,a=o.height/r.offsetHeight;if(i){let u=e.nodeBefore,h=e.nodeAfter;if(u||h){let p=this.editorView.nodeDOM(this.cursorPos-(u?u.nodeSize:0));if(p){let f=p.getBoundingClientRect(),g=u?f.bottom:f.top;u&&h&&(g=(g+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let m=this.width/2*a;n={left:f.left,right:f.right,top:g-m,bottom:g+m}}}}if(!n){let u=this.editorView.coordsAtPos(this.cursorPos),h=this.width/2*s;n={left:u.left-h,right:u.left+h,top:u.top,bottom:u.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",i),this.element.classList.toggle("prosemirror-dropcursor-inline",!i);let c,d;if(!l||l==document.body&&getComputedStyle(l).position=="static")c=-pageXOffset,d=-pageYOffset;else{let u=l.getBoundingClientRect(),h=u.width/l.offsetWidth,p=u.height/l.offsetHeight;c=u.left-l.scrollLeft*h,d=u.top-l.scrollTop*p}this.element.style.left=(n.left-c)/s+"px",this.element.style.top=(n.top-d)/a+"px",this.element.style.width=(n.right-n.left)/s+"px",this.element.style.height=(n.bottom-n.top)/a+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let i=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),n=i&&i.inside>=0&&this.editorView.state.doc.nodeAt(i.inside),r=n&&n.type.spec.disableDropCursor,o=typeof r=="function"?r(this.editorView,i,e):r;if(i&&!o){let s=i.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=Rf(this.editorView.state.doc,s,this.editorView.dragging.slice);a!=null&&(s=a)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}};var _i=class t extends ke{constructor(e){super(e,e)}map(e,i){let n=e.resolve(i.map(this.head));return t.valid(n)?new t(n):ke.near(n)}content(){return pe.empty}eq(e){return e instanceof t&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,i){if(typeof i.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new t(e.resolve(i.pos))}getBookmark(){return new ey(this.anchor)}static valid(e){let i=e.parent;if(i.isTextblock||!nj(e)||!rj(e))return!1;let n=i.type.spec.allowGapCursor;if(n!=null)return n;let r=i.contentMatchAt(e.index()).defaultType;return r&&r.isTextblock}static findGapCursorFrom(e,i,n=!1){e:for(;;){if(!n&&t.valid(e))return e;let r=e.pos,o=null;for(let s=e.depth;;s--){let a=e.node(s);if(i>0?e.indexAfter(s)<a.childCount:e.index(s)>0){o=a.child(i>0?e.indexAfter(s):e.index(s)-1);break}else if(s==0)return null;r+=i;let l=e.doc.resolve(r);if(t.valid(l))return l}for(;;){let s=i>0?o.firstChild:o.lastChild;if(!s){if(o.isAtom&&!o.isText&&!ye.isSelectable(o)){e=e.doc.resolve(r+o.nodeSize*i),n=!1;continue e}break}o=s,r+=i;let a=e.doc.resolve(r);if(t.valid(a))return a}return null}}};_i.prototype.visible=!1;_i.findFrom=_i.findGapCursorFrom;ke.jsonID("gapcursor",_i);var ey=class t{constructor(e){this.pos=e}map(e){return new t(e.map(this.pos))}resolve(e){let i=e.resolve(this.pos);return _i.valid(i)?new _i(i):ke.near(i)}};function A5(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}function nj(t){for(let e=t.depth;e>=0;e--){let i=t.index(e),n=t.node(e);if(i==0){if(n.type.spec.isolating)return!0;continue}for(let r=n.child(i-1);;r=r.lastChild){if(r.childCount==0&&!r.inlineContent||A5(r.type))return!0;if(r.inlineContent)return!1}}return!0}function rj(t){for(let e=t.depth;e>=0;e--){let i=t.indexAfter(e),n=t.node(e);if(i==n.childCount){if(n.type.spec.isolating)return!0;continue}for(let r=n.child(i);;r=r.firstChild){if(r.childCount==0&&!r.inlineContent||A5(r.type))return!0;if(r.inlineContent)return!1}}return!0}function O5(){return new Te({props:{decorations:lj,createSelectionBetween(t,e,i){return e.pos==i.pos&&_i.valid(i)?new _i(i):null},handleClick:sj,handleKeyDown:oj,handleDOMEvents:{beforeinput:aj}}})}var oj=ib({ArrowLeft:Vg("horiz",-1),ArrowRight:Vg("horiz",1),ArrowUp:Vg("vert",-1),ArrowDown:Vg("vert",1)});function Vg(t,e){let i=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(n,r,o){let s=n.selection,a=e>0?s.$to:s.$from,l=s.empty;if(s instanceof Pe){if(!o.endOfTextblock(i)||a.depth==0)return!1;l=!1,a=n.doc.resolve(e>0?a.after():a.before())}let c=_i.findGapCursorFrom(a,e,l);return c?(r&&r(n.tr.setSelection(new _i(c))),!0):!1}}function sj(t,e,i){if(!t||!t.editable)return!1;let n=t.state.doc.resolve(e);if(!_i.valid(n))return!1;let r=t.posAtCoords({left:i.clientX,top:i.clientY});return r&&r.inside>-1&&ye.isSelectable(t.state.doc.nodeAt(r.inside))?!1:(t.dispatch(t.state.tr.setSelection(new _i(n))),!0)}function aj(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof _i))return!1;let{$from:i}=t.state.selection,n=i.parent.contentMatchAt(i.index()).findWrapping(t.state.schema.nodes.text);if(!n)return!1;let r=J.empty;for(let s=n.length-1;s>=0;s--)r=J.from(n[s].createAndFill(null,r));let o=t.state.tr.replace(i.pos,i.pos,new pe(r,0,0));return o.setSelection(Pe.near(o.doc.resolve(i.pos+1))),t.dispatch(o),!1}function lj(t){if(!(t.selection instanceof _i))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",At.create(t.doc,[Ri.widget(t.selection.head,e,{key:"gapcursor"})])}var Gg=200,di=function(){};di.prototype.append=function(e){return e.length?(e=di.from(e),!this.length&&e||e.length<Gg&&this.leafAppend(e)||this.length<Gg&&e.leafPrepend(this)||this.appendInner(e)):this};di.prototype.prepend=function(e){return e.length?di.from(e).append(this):this};di.prototype.appendInner=function(e){return new cj(this,e)};di.prototype.slice=function(e,i){return e===void 0&&(e=0),i===void 0&&(i=this.length),e>=i?di.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,i))};di.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};di.prototype.forEach=function(e,i,n){i===void 0&&(i=0),n===void 0&&(n=this.length),i<=n?this.forEachInner(e,i,n,0):this.forEachInvertedInner(e,i,n,0)};di.prototype.map=function(e,i,n){i===void 0&&(i=0),n===void 0&&(n=this.length);var r=[];return this.forEach(function(o,s){return r.push(e(o,s))},i,n),r};di.from=function(e){return e instanceof di?e:e&&e.length?new L5(e):di.empty};var L5=(function(t){function e(n){t.call(this),this.values=n}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(r,o){return r==0&&o==this.length?this:new e(this.values.slice(r,o))},e.prototype.getInner=function(r){return this.values[r]},e.prototype.forEachInner=function(r,o,s,a){for(var l=o;l<s;l++)if(r(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(r,o,s,a){for(var l=o-1;l>=s;l--)if(r(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(r){if(this.length+r.length<=Gg)return new e(this.values.concat(r.flatten()))},e.prototype.leafPrepend=function(r){if(this.length+r.length<=Gg)return new e(r.flatten().concat(this.values))},i.length.get=function(){return this.values.length},i.depth.get=function(){return 0},Object.defineProperties(e.prototype,i),e})(di);di.empty=new L5([]);var cj=(function(t){function e(i,n){t.call(this),this.left=i,this.right=n,this.length=i.length+n.length,this.depth=Math.max(i.depth,n.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(n){return n<this.left.length?this.left.get(n):this.right.get(n-this.left.length)},e.prototype.forEachInner=function(n,r,o,s){var a=this.left.length;if(r<a&&this.left.forEachInner(n,r,Math.min(o,a),s)===!1||o>a&&this.right.forEachInner(n,Math.max(r-a,0),Math.min(this.length,o)-a,s+a)===!1)return!1},e.prototype.forEachInvertedInner=function(n,r,o,s){var a=this.left.length;if(r>a&&this.right.forEachInvertedInner(n,r-a,Math.max(o,a)-a,s+a)===!1||o<a&&this.left.forEachInvertedInner(n,Math.min(r,a),o,s)===!1)return!1},e.prototype.sliceInner=function(n,r){if(n==0&&r==this.length)return this;var o=this.left.length;return r<=o?this.left.slice(n,r):n>=o?this.right.slice(n-o,r-o):this.left.slice(n,o).append(this.right.slice(0,r-o))},e.prototype.leafAppend=function(n){var r=this.right.leafAppend(n);if(r)return new e(this.left,r)},e.prototype.leafPrepend=function(n){var r=this.left.leafPrepend(n);if(r)return new e(r,this.right)},e.prototype.appendInner=function(n){return this.left.depth>=Math.max(this.right.depth,n.depth)+1?new e(this.left,new e(this.right,n)):new e(this,n)},e})(di),ty=di;var dj=500,ma=class t{constructor(e,i){this.items=e,this.eventCount=i}popEvent(e,i){if(this.eventCount==0)return null;let n=this.items.length;for(;;n--)if(this.items.get(n-1).selection){--n;break}let r,o;i&&(r=this.remapping(n,this.items.length),o=r.maps.length);let s=e.tr,a,l,c=[],d=[];return this.items.forEach((u,h)=>{if(!u.step){r||(r=this.remapping(n,h+1),o=r.maps.length),o--,d.push(u);return}if(r){d.push(new Rr(u.map));let p=u.step.map(r.slice(o)),f;p&&s.maybeStep(p).doc&&(f=s.mapping.maps[s.mapping.maps.length-1],c.push(new Rr(f,void 0,void 0,c.length+d.length))),o--,f&&r.appendMap(f,o)}else s.maybeStep(u.step);if(u.selection)return a=r?u.selection.map(r.slice(o)):u.selection,l=new t(this.items.slice(0,n).append(d.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:s,selection:a}}addTransform(e,i,n,r){let o=[],s=this.eventCount,a=this.items,l=!r&&a.length?a.get(a.length-1):null;for(let d=0;d<e.steps.length;d++){let u=e.steps[d].invert(e.docs[d]),h=new Rr(e.mapping.maps[d],u,i),p;(p=l&&l.merge(h))&&(h=p,d?o.pop():a=a.slice(0,a.length-1)),o.push(h),i&&(s++,i=void 0),r||(l=h)}let c=s-n.depth;return c>hj&&(a=uj(a,c),s-=c),new t(a.append(o),s)}remapping(e,i){let n=new uu;return this.items.forEach((r,o)=>{let s=r.mirrorOffset!=null&&o-r.mirrorOffset>=e?n.maps.length-r.mirrorOffset:void 0;n.appendMap(r.map,s)},e,i),n}addMaps(e){return this.eventCount==0?this:new t(this.items.append(e.map(i=>new Rr(i))),this.eventCount)}rebased(e,i){if(!this.eventCount)return this;let n=[],r=Math.max(0,this.items.length-i),o=e.mapping,s=e.steps.length,a=this.eventCount;this.items.forEach(h=>{h.selection&&a--},r);let l=i;this.items.forEach(h=>{let p=o.getMirror(--l);if(p==null)return;s=Math.min(s,p);let f=o.maps[p];if(h.step){let g=e.steps[p].invert(e.docs[p]),m=h.selection&&h.selection.map(o.slice(l+1,p));m&&a++,n.push(new Rr(f,g,m))}else n.push(new Rr(f))},r);let c=[];for(let h=i;h<s;h++)c.push(new Rr(o.maps[h]));let d=this.items.slice(0,r).append(c).append(n),u=new t(d,a);return u.emptyItemCount()>dj&&(u=u.compress(this.items.length-n.length)),u}emptyItemCount(){let e=0;return this.items.forEach(i=>{i.step||e++}),e}compress(e=this.items.length){let i=this.remapping(0,e),n=i.maps.length,r=[],o=0;return this.items.forEach((s,a)=>{if(a>=e)r.push(s),s.selection&&o++;else if(s.step){let l=s.step.map(i.slice(n)),c=l&&l.getMap();if(n--,c&&i.appendMap(c,n),l){let d=s.selection&&s.selection.map(i.slice(n));d&&o++;let u=new Rr(c.invert(),l,d),h,p=r.length-1;(h=r.length&&r[p].merge(u))?r[p]=h:r.push(u)}}else s.map&&n--},this.items.length,0),new t(ty.from(r.reverse()),o)}};ma.empty=new ma(ty.empty,0);function uj(t,e){let i;return t.forEach((n,r)=>{if(n.selection&&e--==0)return i=r,!1}),t.slice(i)}var Rr=class t{constructor(e,i,n,r){this.map=e,this.step=i,this.selection=n,this.mirrorOffset=r}merge(e){if(this.step&&e.step&&!e.selection){let i=e.step.merge(this.step);if(i)return new t(i.getMap().invert(),i,this.selection)}}},_r=class{constructor(e,i,n,r,o){this.done=e,this.undone=i,this.prevRanges=n,this.prevTime=r,this.prevComposition=o}},hj=20;function pj(t,e,i,n){let r=i.getMeta(ga),o;if(r)return r.historyState;i.getMeta(mj)&&(t=new _r(t.done,t.undone,null,0,-1));let s=i.getMeta("appendedTransaction");if(i.steps.length==0)return t;if(s&&s.getMeta(ga))return s.getMeta(ga).redo?new _r(t.done.addTransform(i,void 0,n,Wg(e)),t.undone,N5(i.mapping.maps),t.prevTime,t.prevComposition):new _r(t.done,t.undone.addTransform(i,void 0,n,Wg(e)),null,t.prevTime,t.prevComposition);if(i.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let a=i.getMeta("composition"),l=t.prevTime==0||!s&&t.prevComposition!=a&&(t.prevTime<(i.time||0)-n.newGroupDelay||!fj(i,t.prevRanges)),c=s?iy(t.prevRanges,i.mapping):N5(i.mapping.maps);return new _r(t.done.addTransform(i,l?e.selection.getBookmark():void 0,n,Wg(e)),ma.empty,c,i.time,a??t.prevComposition)}else return(o=i.getMeta("rebased"))?new _r(t.done.rebased(i,o),t.undone.rebased(i,o),iy(t.prevRanges,i.mapping),t.prevTime,t.prevComposition):new _r(t.done.addMaps(i.mapping.maps),t.undone.addMaps(i.mapping.maps),iy(t.prevRanges,i.mapping),t.prevTime,t.prevComposition)}function fj(t,e){if(!e)return!1;if(!t.docChanged)return!0;let i=!1;return t.mapping.maps[0].forEach((n,r)=>{for(let o=0;o<e.length;o+=2)n<=e[o+1]&&r>=e[o]&&(i=!0)}),i}function N5(t){let e=[];for(let i=t.length-1;i>=0&&e.length==0;i--)t[i].forEach((n,r,o,s)=>e.push(o,s));return e}function iy(t,e){if(!t)return null;let i=[];for(let n=0;n<t.length;n+=2){let r=e.map(t[n],1),o=e.map(t[n+1],-1);r<=o&&i.push(r,o)}return i}function gj(t,e,i){let n=Wg(e),r=ga.get(e).spec.config,o=(i?t.undone:t.done).popEvent(e,n);if(!o)return null;let s=o.selection.resolve(o.transform.doc),a=(i?t.done:t.undone).addTransform(o.transform,e.selection.getBookmark(),r,n),l=new _r(i?a:o.remaining,i?o.remaining:a,null,0,-1);return o.transform.setSelection(s).setMeta(ga,{redo:i,historyState:l})}var ny=!1,B5=null;function Wg(t){let e=t.plugins;if(B5!=e){ny=!1,B5=e;for(let i=0;i<e.length;i++)if(e[i].spec.historyPreserveItems){ny=!0;break}}return ny}var ga=new Oe("history"),mj=new Oe("closeHistory");function H5(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new Te({key:ga,state:{init(){return new _r(ma.empty,ma.empty,null,0,-1)},apply(e,i,n){return pj(i,n,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,i){let n=i.inputType,r=n=="historyUndo"?ry:n=="historyRedo"?oy:null;return!r||!e.editable?!1:(i.preventDefault(),r(e.state,e.dispatch))}}}})}function Ug(t,e){return(i,n)=>{let r=ga.getState(i);if(!r||(t?r.undone:r.done).eventCount==0)return!1;if(n){let o=gj(r,i,t);o&&n(e?o.scrollIntoView():o)}return!0}}var ry=Ug(!1,!0),oy=Ug(!0,!0),Pxe=Ug(!1,!1),Rxe=Ug(!0,!1);var Mxe=Je.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:t=>t.length,wordCounter:t=>t.split(" ").filter(e=>e!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=t=>{let e=t?.node||this.editor.state.doc;if((t?.mode||this.options.mode)==="textSize"){let n=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(n)}return e.nodeSize},this.storage.words=t=>{let e=t?.node||this.editor.state.doc,i=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(i)}},addProseMirrorPlugins(){let t=!1;return[new Te({key:new Oe("characterCount"),appendTransaction:(e,i,n)=>{if(t)return;let r=this.options.limit;if(r==null||r===0){t=!0;return}let o=this.storage.characters({node:n.doc});if(o>r){let s=o-r,a=0,l=s;console.warn(`[CharacterCount] Initial content exceeded limit of ${r} characters. Content was automatically trimmed.`);let c=n.tr.deleteRange(a,l);return t=!0,c}t=!0},filterTransaction:(e,i)=>{let n=this.options.limit;if(!e.docChanged||n===0||n===null||n===void 0)return!0;let r=this.storage.characters({node:i.doc}),o=this.storage.characters({node:e.doc});if(o<=n||r>n&&o>n&&o<=r)return!0;if(r>n&&o>n&&o>r||!e.getMeta("paste"))return!1;let a=e.selection.$head.pos,l=o-n,c=a-l,d=a;return e.deleteRange(c,d),!(this.storage.characters({node:e.doc})>n)}})]}}),V5=Je.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[I5(this.options)]}}),Bxe=Je.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new Te({key:new Oe("focus"),props:{decorations:({doc:t,selection:e})=>{let{isEditable:i,isFocused:n}=this.editor,{anchor:r}=e,o=[];if(!i||!n)return At.create(t,[]);let s=0;this.options.mode==="deepest"&&t.descendants((l,c)=>{if(l.isText)return;if(!(r>=c&&r<=c+l.nodeSize-1))return!1;s+=1});let a=0;return t.descendants((l,c)=>{if(l.isText||!(r>=c&&r<=c+l.nodeSize-1))return!1;if(a+=1,this.options.mode==="deepest"&&s-a>0||this.options.mode==="shallowest"&&a>1)return this.options.mode==="deepest";o.push(Ri.node(c,c+l.nodeSize,{class:this.options.className}))}),At.create(t,o)}}})]}}),G5=Je.create({name:"gapCursor",addProseMirrorPlugins(){return[O5()]},extendNodeSchema(t){var e;let i={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=st(xe(t,"allowGapCursor",i)))!=null?e:null}}}),Uxe=Je.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something \u2026",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new Te({key:new Oe("placeholder"),props:{decorations:({doc:t,selection:e})=>{let i=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:n}=e,r=[];if(!i)return null;let o=this.editor.isEmpty;return t.descendants((s,a)=>{let l=n>=a&&n<=a+s.nodeSize,c=!s.isLeaf&&Ru(s);if((l||!this.options.showOnlyCurrent)&&c){let d=[this.options.emptyNodeClass];o&&d.push(this.options.emptyEditorClass);let u=Ri.node(a,a+s.nodeSize,{class:d.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:s,pos:a,hasAnchor:l}):this.options.placeholder});r.push(u)}return this.options.includeChildren}),At.create(t,r)}}})]}}),Kxe=Je.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){let{editor:t,options:e}=this;return[new Te({key:new Oe("selection"),props:{decorations(i){return i.selection.empty||t.isFocused||!t.isEditable||rg(i.selection)||t.view.dragging?null:At.create(i.doc,[Ri.inline(i.selection.from,i.selection.to,{class:e.className})])}}})]}});function z5({types:t,node:e}){return e&&Array.isArray(t)&&t.includes(e.type)||e?.type===t}var W5=Je.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var t;let e=new Oe(this.name),i=((t=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:t.name)||this.options.node||"paragraph",n=Object.entries(this.editor.schema.nodes).map(([,r])=>r).filter(r=>(this.options.notAfter||[]).concat(i).includes(r.name));return[new Te({key:e,appendTransaction:(r,o,s)=>{let{doc:a,tr:l,schema:c}=s,d=e.getState(s),u=a.content.size,h=c.nodes[i];if(d)return l.insert(u,h.create())},state:{init:(r,o)=>{let s=o.tr.doc.lastChild;return!z5({node:s,types:n})},apply:(r,o)=>{if(!r.docChanged||r.getMeta("__uniqueIDTransaction"))return o;let s=r.doc.lastChild;return!z5({node:s,types:n})}}})]}}),U5=Je.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>ry(t,e),redo:()=>({state:t,dispatch:e})=>oy(t,e)}},addProseMirrorPlugins(){return[H5(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-\u044F":()=>this.editor.commands.undo(),"Shift-Mod-\u044F":()=>this.editor.commands.redo()}}});var vj=Je.create({name:"starterKit",addExtensions(){var t,e,i,n;let r=[];return this.options.bold!==!1&&r.push(d5.configure(this.options.bold)),this.options.blockquote!==!1&&r.push(c5.configure(this.options.blockquote)),this.options.bulletList!==!1&&r.push(Kb.configure(this.options.bulletList)),this.options.code!==!1&&r.push(u5.configure(this.options.code)),this.options.codeBlock!==!1&&r.push(h5.configure(this.options.codeBlock)),this.options.document!==!1&&r.push(p5.configure(this.options.document)),this.options.dropcursor!==!1&&r.push(V5.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&r.push(G5.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&r.push(f5.configure(this.options.hardBreak)),this.options.heading!==!1&&r.push(g5.configure(this.options.heading)),this.options.undoRedo!==!1&&r.push(U5.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&r.push(m5.configure(this.options.horizontalRule)),this.options.italic!==!1&&r.push(v5.configure(this.options.italic)),this.options.listItem!==!1&&r.push(Yb.configure(this.options.listItem)),this.options.listKeymap!==!1&&r.push(Jb.configure((t=this.options)==null?void 0:t.listKeymap)),this.options.link!==!1&&r.push(Ub.configure((e=this.options)==null?void 0:e.link)),this.options.orderedList!==!1&&r.push(Qb.configure(this.options.orderedList)),this.options.paragraph!==!1&&r.push(F5.configure(this.options.paragraph)),this.options.strike!==!1&&r.push(T5.configure(this.options.strike)),this.options.text!==!1&&r.push(D5.configure(this.options.text)),this.options.underline!==!1&&r.push(M5.configure((i=this.options)==null?void 0:i.underline)),this.options.trailingNode!==!1&&r.push(W5.configure((n=this.options)==null?void 0:n.trailingNode)),r}}),j5=vj;var q5=(()=>{class t{elRef=Z(Ai);renderer=Z(Av);changeDetectorRef=Z(rd);editor=Re.required();outputFormat=Re("html");onChange=()=>{};onTouched=()=>{};writeValue(i){this.editor().chain().setContent(i,{emitUpdate:!1}).run()}registerOnChange(i){this.onChange=i}registerOnTouched(i){this.onTouched=i}setDisabledState(i){this.editor().setEditable(!i),this.renderer.setProperty(this.elRef.nativeElement,"disabled",i)}handleChange=({editor:i,transaction:n})=>{if(n.docChanged){if(this.changeDetectorRef.markForCheck(),this.outputFormat()==="html"){this.onChange(i.getHTML());return}this.onChange(i.getJSON())}};ngOnInit(){let i=this.editor(),{innerHTML:n}=this.elRef.nativeElement;this.elRef.nativeElement.innerHTML="",this.elRef.nativeElement.append(...Array.from(i.options.element?.childNodes||[])),i.setOptions({element:this.elRef.nativeElement}),n&&i.chain().setContent(n,{emitUpdate:!1}).run(),i.on("blur",()=>{this.onTouched()}),i.on("update",this.handleChange),i.on("selectionUpdate",()=>this.changeDetectorRef.markForCheck())}ngAfterViewInit(){this.changeDetectorRef.detectChanges()}static \u0275fac=function(n){return new(n||t)};static \u0275dir=Yt({type:t,selectors:[["tiptap","editor",""],["","tiptap","","editor",""],["tiptap-editor","editor",""],["","tiptapEditor","","editor",""]],inputs:{editor:[1,"editor"],outputFormat:[1,"outputFormat"]},features:[Xe([{provide:gp,useExisting:ap(()=>t),multi:!0}])]})}return t})();var $5=(()=>{class t{destroyRef=Z(ux);suppressEmit=!1;initialContent=Re("");minHeight=Re("300px");contentChange=ue();editor=new W4({extensions:[j5.configure({heading:{levels:[1,2,3]}}),l5.configure({openOnClick:!1,HTMLAttributes:{class:"text-blue-600 underline hover:text-blue-800"}})],editorProps:{attributes:{class:"prose prose-sm sm:prose lg:prose-lg xl:prose-xl focus:outline-none max-w-none p-4"}},content:this.initialContent()||"",onUpdate:({editor:i})=>{this.suppressEmit||this.contentChange.emit(i.getHTML())}});constructor(){pt(()=>{let i=this.initialContent()||"",n=this.editor.getHTML();i!==n&&(this.suppressEmit=!0,this.editor.commands.setContent(i,{emitUpdate:!1}),this.suppressEmit=!1)}),this.destroyRef.onDestroy(()=>{this.editor?.destroy()})}isBold(){return this.editor?.isActive("bold")??!1}isItalic(){return this.editor?.isActive("italic")??!1}isStrike(){return this.editor?.isActive("strike")??!1}isCode(){return this.editor?.isActive("code")??!1}isH1(){return this.editor?.isActive("heading",{level:1})??!1}isH2(){return this.editor?.isActive("heading",{level:2})??!1}isBulletList(){return this.editor?.isActive("bulletList")??!1}isOrderedList(){return this.editor?.isActive("orderedList")??!1}isBlockquote(){return this.editor?.isActive("blockquote")??!1}toggleBold(){this.editor?.chain().focus().toggleBold().run()}toggleItalic(){this.editor?.chain().focus().toggleItalic().run()}toggleStrike(){this.editor?.chain().focus().toggleStrike().run()}toggleCode(){this.editor?.chain().focus().toggleCode().run()}toggleH1(){this.editor?.chain().focus().toggleHeading({level:1}).run()}toggleH2(){this.editor?.chain().focus().toggleHeading({level:2}).run()}toggleBulletList(){this.editor?.chain().focus().toggleBulletList().run()}toggleOrderedList(){this.editor?.chain().focus().toggleOrderedList().run()}toggleBlockquote(){this.editor?.chain().focus().toggleBlockquote().run()}setLink(){let i=window.prompt("Enter URL:");i&&this.editor?.chain().focus().setLink({href:i}).run()}undo(){this.editor?.chain().focus().undo().run()}redo(){this.editor?.chain().focus().redo().run()}getHTML(){return this.editor?.getHTML()}getJSON(){return this.editor?.getJSON()}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=Ie({type:t,selectors:[["gh-tiptap-editor"]],inputs:{initialContent:[1,"initialContent"],minHeight:[1,"minHeight"]},outputs:{contentChange:"contentChange"},features:[Xe([vi({lucideBold:Rx,lucideItalic:Ix,lucideStrikethrough:jx,lucideCode:Fx,lucideHeading1:Dx,lucideHeading2:Mx,lucideList:Lx,lucideListOrdered:Ox,lucideQuote:zx,lucideUndo:qx,lucideRedo:Vx,lucideLink:Ax})])],decls:31,vars:21,consts:[[1,"border","rounded-t-md","p-2","bg-muted/30","flex","flex-wrap","gap-1","items-center"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Bold (Ctrl+B)",3,"click"],["hlm","","name","lucideBold","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Italic (Ctrl+I)",3,"click"],["hlm","","name","lucideItalic","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Strikethrough",3,"click"],["hlm","","name","lucideStrikethrough","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Code",3,"click"],["hlm","","name","lucideCode","size","sm"],["hlmSeparator","","orientation","vertical",1,"h-6","mx-1"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Heading 1",3,"click"],["hlm","","name","lucideHeading1","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Heading 2",3,"click"],["hlm","","name","lucideHeading2","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Bullet List",3,"click"],["hlm","","name","lucideList","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Numbered List",3,"click"],["hlm","","name","lucideListOrdered","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Blockquote",3,"click"],["hlm","","name","lucideQuote","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Add Link",3,"click"],["hlm","","name","lucideLink","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Undo (Ctrl+Z)",3,"click"],["hlm","","name","lucideUndo","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Redo (Ctrl+Shift+Z)",3,"click"],["hlm","","name","lucideRedo","size","sm"],[1,"border","border-t-0","rounded-b-md","bg-background"],[1,"block",3,"editor"]],template:function(n,r){n&1&&(D(0,"div",0)(1,"button",1),te("click",function(){return r.toggleBold()}),ee(2,"ng-icon",2),F(),D(3,"button",3),te("click",function(){return r.toggleItalic()}),ee(4,"ng-icon",4),F(),D(5,"button",5),te("click",function(){return r.toggleStrike()}),ee(6,"ng-icon",6),F(),D(7,"button",7),te("click",function(){return r.toggleCode()}),ee(8,"ng-icon",8),F(),ee(9,"div",9),D(10,"button",10),te("click",function(){return r.toggleH1()}),ee(11,"ng-icon",11),F(),D(12,"button",12),te("click",function(){return r.toggleH2()}),ee(13,"ng-icon",13),F(),ee(14,"div",9),D(15,"button",14),te("click",function(){return r.toggleBulletList()}),ee(16,"ng-icon",15),F(),D(17,"button",16),te("click",function(){return r.toggleOrderedList()}),ee(18,"ng-icon",17),F(),ee(19,"div",9),D(20,"button",18),te("click",function(){return r.toggleBlockquote()}),ee(21,"ng-icon",19),F(),D(22,"button",20),te("click",function(){return r.setLink()}),ee(23,"ng-icon",21),F(),ee(24,"div",9),D(25,"button",22),te("click",function(){return r.undo()}),ee(26,"ng-icon",23),F(),D(27,"button",24),te("click",function(){return r.redo()}),ee(28,"ng-icon",25),F()(),D(29,"div",26),ee(30,"tiptap-editor",27),F()),n&2&&(M(),Xt("bg-accent",r.isBold()),M(2),Xt("bg-accent",r.isItalic()),M(2),Xt("bg-accent",r.isStrike()),M(2),Xt("bg-accent",r.isCode()),M(3),Xt("bg-accent",r.isH1()),M(2),Xt("bg-accent",r.isH2()),M(3),Xt("bg-accent",r.isBulletList()),M(2),Xt("bg-accent",r.isOrderedList()),M(3),Xt("bg-accent",r.isBlockquote()),M(10),Wn("min-height",r.minHeight()),de("editor",r.editor))},dependencies:[_t,wi,Ci,Cp,q5],encapsulation:2,changeDetection:0})}return t})();var ka=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setFrameworkOverrides(t){this.frameworkOverrides=t}getListeners(t,e,i){let n=e?this.allAsyncListeners:this.allSyncListeners,r=n.get(t);return!r&&i&&(r=new Set,n.set(t,r)),r}noRegisteredListenersExist(){return this.allSyncListeners.size===0&&this.allAsyncListeners.size===0&&this.globalSyncListeners.size===0&&this.globalAsyncListeners.size===0}addEventListener(t,e,i=!1){this.getListeners(t,i,!0).add(e)}removeEventListener(t,e,i=!1){let n=this.getListeners(t,i,!1);n&&(n.delete(e),n.size===0&&(i?this.allAsyncListeners:this.allSyncListeners).delete(t))}addGlobalListener(t,e=!1){this.getGlobalListeners(e).add(t)}removeGlobalListener(t,e=!1){this.getGlobalListeners(e).delete(t)}dispatchEvent(t){this.dispatchToListeners(t,!0),this.dispatchToListeners(t,!1),this.firedEvents[t.type]=!0}dispatchEventOnce(t){this.firedEvents[t.type]||this.dispatchEvent(t)}dispatchToListeners(t,e){let i=t.type;if(e&&"event"in t){let a=t.event;a instanceof Event&&(t.eventPath=a.composedPath())}let{frameworkOverrides:n}=this,r=a=>{let l=n?()=>n.wrapIncoming(a):a;e?this.dispatchAsync(l):l()},o=this.getListeners(i,e,!1);if((o?.size??0)>0){let a=new Set(o);for(let l of a)o?.has(l)&&r(()=>l(t))}let s=this.getGlobalListeners(e);if(s.size>0){let a=new Set(s);for(let l of a)r(()=>l(i,t))}}getGlobalListeners(t){return t?this.globalAsyncListeners:this.globalSyncListeners}dispatchAsync(t){if(this.asyncFunctionsQueue.push(t),!this.scheduled){let e=()=>{window.setTimeout(this.flushAsyncQueue.bind(this),0)};this.frameworkOverrides?this.frameworkOverrides.wrapIncoming(e):e(),this.scheduled=!0}}flushAsyncQueue(){this.scheduled=!1;let t=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[];for(let e of t)e()}};function Co(t){return t==null||t===""?null:t}function ae(t){return t!=null&&t!==""}function wt(t){return!ae(t)}function Vy(t){return t!=null&&typeof t.toString=="function"?t.toString():null}function rh(t,e){let i=t?JSON.stringify(t):null,n=e?JSON.stringify(e):null;return i===n}function yj(t,e,i=!1){let n=t==null,r=e==null;if(t?.toNumber&&(t=t.toNumber()),e?.toNumber&&(e=e.toNumber()),n&&r)return 0;if(n)return-1;if(r)return 1;function o(s,a){return s>a?1:s<a?-1:0}if(typeof t!="string"||!i)return o(t,e);try{return t.localeCompare(e)}catch{return o(t,e)}}var Sj=/[&<>"']/g,xj={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Cc(t){return t?.toString().toString()??null}function Ku(t){return Cc(t)?.replace(Sj,e=>xj[e])??null}function Tr(t){return t.eRootDiv.getRootNode()}function St(t){return Tr(t).activeElement}function ri(t){let{gos:e,eRootDiv:i}=t,n=null,r=e.get("getDocument");return r&&ae(r)?n=r():i&&(n=i.ownerDocument),n&&ae(n)?n:document}function gD(t){let e=St(t);return e===null||e===ri(t).body}function mD(t){return ri(t).defaultView||window}function SS(t){let e=null,i=null;try{e=ri(t).fullscreenElement}catch{}finally{e||(e=Tr(t));let n=e.querySelector("body");n?i=n:e instanceof ShadowRoot?i=e:e instanceof Document?i=e?.documentElement:i=e}return i}function Ej(t){return SS(t)?.clientWidth??(window.innerWidth||-1)}function Pj(t){return SS(t)?.clientHeight??(window.innerHeight||-1)}function tr(t,e,i){i==null||typeof i=="string"&&i==""?vD(t,e):An(t,e,i)}function An(t,e,i){t.setAttribute(CD(e),i.toString())}function vD(t,e){t.removeAttribute(CD(e))}function CD(t){return`aria-${t}`}function vs(t,e){e?t.setAttribute("role",e):t.removeAttribute("role")}function Rj(t){let e;return t==="asc"?e="ascending":t==="desc"?e="descending":t==="mixed"?e="other":e="none",e}function _j(t){return t.getAttribute("aria-label")}function hc(t,e){tr(t,"label",e)}function oh(t,e){tr(t,"labelledby",e)}function wD(t,e){tr(t,"live",e)}function kj(t,e){tr(t,"atomic",e)}function Fj(t,e){tr(t,"relevant",e)}function Tj(t,e){tr(t,"invalid",e)}function Dj(t,e){tr(t,"disabled",e)}function bD(t,e){tr(t,"hidden",e)}function Gy(t,e){An(t,"expanded",e)}function Mj(t,e){An(t,"setsize",e)}function Ij(t,e){An(t,"posinset",e)}function Aj(t,e){An(t,"multiselectable",e)}function Oj(t,e){An(t,"rowcount",e)}function fm(t,e){An(t,"rowindex",e)}function Lj(t,e){An(t,"rowspan",e)}function Nj(t,e){An(t,"colcount",e)}function yD(t,e){An(t,"colindex",e)}function Bj(t,e){An(t,"colspan",e)}function Hj(t,e){An(t,"sort",e)}function zj(t){vD(t,"sort")}function SD(t,e){tr(t,"selected",e)}function Vj(t,e){tr(t,"controls",e)}function Gj(t,e){Vj(t,e.id),oh(e,t.id)}function K5(t,e){tr(t,"owns",e)}function Nm(t,e){return e===void 0?t("ariaIndeterminate","indeterminate"):e===!0?t("ariaChecked","checked"):t("ariaUnchecked","unchecked")}var Wj="[tabindex], input, select, button, textarea, [href]",xD="[disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function Yu(t){return!t||!t.matches("input, select, button, textarea")||!t.matches(xD)?!1:Nr(t)}function Ct(t,e,i={}){let{skipAriaHidden:n}=i;t.classList.toggle("ag-hidden",!e),n||bD(t,!e)}function Uj(t,e,i={}){let{skipAriaHidden:n}=i;t.classList.toggle("ag-invisible",!e),n||bD(t,!e)}function sh(t,e){let i="disabled",n=e?o=>o.setAttribute(i,""):o=>o.removeAttribute(i);n(t);let r=t.querySelectorAll("input")??[];for(let o of r)n(o)}function Sa(t,e,i){let n=0;for(;t;){if(t.classList.contains(e))return!0;if(t=t.parentElement,typeof i=="number"){if(++n>i)break}else if(t===i)break}return!1}function Ia(t){let{height:e,width:i,borderTopWidth:n,borderRightWidth:r,borderBottomWidth:o,borderLeftWidth:s,paddingTop:a,paddingRight:l,paddingBottom:c,paddingLeft:d,marginTop:u,marginRight:h,marginBottom:p,marginLeft:f,boxSizing:g}=window.getComputedStyle(t),m=Number.parseFloat;return{height:m(e||"0"),width:m(i||"0"),borderTopWidth:m(n||"0"),borderRightWidth:m(r||"0"),borderBottomWidth:m(o||"0"),borderLeftWidth:m(s||"0"),paddingTop:m(a||"0"),paddingRight:m(l||"0"),paddingBottom:m(c||"0"),paddingLeft:m(d||"0"),marginTop:m(u||"0"),marginRight:m(h||"0"),marginBottom:m(p||"0"),marginLeft:m(f||"0"),boxSizing:g}}function xS(t){let e=Ia(t);return e.boxSizing==="border-box"?e.height-e.paddingTop-e.paddingBottom-e.borderTopWidth-e.borderBottomWidth:e.height}function ah(t){let e=Ia(t);return e.boxSizing==="border-box"?e.width-e.paddingLeft-e.paddingRight-e.borderLeftWidth-e.borderRightWidth:e.width}function ED(t){let{height:e,marginBottom:i,marginTop:n}=Ia(t);return Math.floor(e+i+n)}function gm(t){let{width:e,marginLeft:i,marginRight:n}=Ia(t);return Math.floor(e+i+n)}function PD(t){let e=t.getBoundingClientRect(),{borderTopWidth:i,borderLeftWidth:n,borderRightWidth:r,borderBottomWidth:o}=Ia(t);return{top:e.top+(i||0),left:e.left+(n||0),right:e.right+(r||0),bottom:e.bottom+(o||0)}}function mm(t,e){let i=t.scrollLeft;return e&&(i=Math.abs(i)),i}function vm(t,e,i){i&&(e*=-1),t.scrollLeft=e}function hi(t){for(;t?.firstChild;)t.firstChild.remove()}function Xi(t){t?.parentNode&&t.remove()}function RD(t){return!!t.offsetParent}function Nr(t){return t.checkVisibility?t.checkVisibility({checkVisibilityCSS:!0}):!(!RD(t)||window.getComputedStyle(t).visibility!=="visible")}function ES(t){let e=document.createElement("div");return e.innerHTML=(t||"").trim(),e.firstChild}function _D(t,e,i){i&&i.nextSibling===e||(t.firstChild?i?i.nextSibling?t.insertBefore(e,i.nextSibling):t.appendChild(e):t.firstChild&&t.firstChild!==e&&t.insertAdjacentElement("afterbegin",e):t.appendChild(e))}function kD(t,e){for(let i=0;i<e.length;i++){let n=e[i],r=t.children[i];r!==n&&t.insertBefore(n,r)}}function jj(t){return t.replace(/[A-Z]/g,e=>`-${e.toLocaleLowerCase()}`)}function vh(t,e){if(e)for(let i of Object.keys(e)){let n=e[i];if(!i?.length||n==null)continue;let r=jj(i),o=n.toString(),s=o.replace(/\s*!important/g,""),a=s.length!=o.length?"important":void 0;t.style.setProperty(r,s,a)}}function im(t){return()=>{let e=t();return e?PS(e)||FD(e):!0}}function PS(t){return t.clientWidth<t.scrollWidth}function FD(t){return t.clientHeight<t.scrollHeight}function Cm(t,e){e==="flex"?(t.style.removeProperty("width"),t.style.removeProperty("minWidth"),t.style.removeProperty("maxWidth"),t.style.flex="1 1 auto"):Ar(t,e)}function Ar(t,e){e=RS(e),t.style.width=e,t.style.maxWidth=e,t.style.minWidth=e}function Xu(t,e){e=RS(e),t.style.height=e,t.style.maxHeight=e,t.style.minHeight=e}function RS(t){return typeof t=="number"?`${t}px`:t}function _S(t){return t instanceof Node||t instanceof HTMLElement}function cn(t,e,i){i==null||i===""?t.removeAttribute(e):t.setAttribute(e,i.toString())}function Ss(t,e,i){let r=mD(t).ResizeObserver,o=r?new r(i):null;return o?.observe(e),()=>o?.disconnect()}function Eo(t,e){let i=mD(t);i.requestAnimationFrame?i.requestAnimationFrame(e):i.webkitRequestAnimationFrame?i.webkitRequestAnimationFrame(e):i.setTimeout(e,0)}var TD="data-ref",sy;function Y5(){return sy??(sy=document.createTextNode(" ")),sy.cloneNode()}function Ch(t){let{attrs:e,children:i,cls:n,ref:r,role:o,tag:s}=t,a=document.createElement(s);if(n&&(a.className=n),r&&a.setAttribute(TD,r),o&&a.setAttribute("role",o),e)for(let l of Object.keys(e))a.setAttribute(l,e[l]);if(i)if(typeof i=="string")a.textContent=i;else{let l=!0;for(let c of i)c&&(typeof c=="string"?(a.appendChild(document.createTextNode(c)),l=!1):typeof c=="function"?a.appendChild(c()):(l&&(a.appendChild(Y5()),l=!1),a.append(Ch(c)),a.appendChild(Y5())))}return a}var qj=["touchstart","touchend","touchmove","touchcancel","scroll"],$j=["wheel"],ay={},DD=(()=>{let t={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return i=>{if(typeof ay[i]=="boolean")return ay[i];let n=document.createElement(t[i]||"div");return i="on"+i,ay[i]=i in n}})();function Kj(t,e){return!e||!t?!1:Xj(e).indexOf(t)>=0}function Yj(t){let e=[],i=t.target;for(;i;)e.push(i),i=i.parentElement;return e}function Xj(t){let e=t;return e.path?e.path:e.composedPath?e.composedPath():Yj(e)}function Jj(t,e,i){let n=Qj(e),r;n!=null&&(r={passive:n}),t.addEventListener(e,i,r)}var Qj=t=>{let e=qj.includes(t),i=$j.includes(t);if(e)return!0;if(i)return!1};function MD(t,e,i){if(i===0)return!1;let n=Math.abs(t.clientX-e.clientX),r=Math.abs(t.clientY-e.clientY);return Math.max(n,r)<=i}var Ju=(t,e)=>{let i=t.identifier;for(let n=0,r=e.length;n<r;++n){let o=e[n];if(o.identifier===i)return o}return null};function lh(t,e){return t.gos.isElementInThisInstance(e.target)}function Zj(t,e,i){let r=t.getBoundingClientRect().height,o=Ej(i)-2,s=Pj(i)-2;if(!t.offsetParent)return;let l=PD(t.offsetParent),{clientY:c,clientX:d}=e,u=c-l.top-r/2,h=d-l.left-10,p=ri(i),f=p.defaultView||window,g=f.pageYOffset||p.documentElement.scrollTop,m=f.pageXOffset||p.documentElement.scrollLeft;o>0&&h+t.clientWidth>o+m&&(h=o+m-t.clientWidth),h<0&&(h=0),s>0&&u+t.clientHeight>s+g&&(u=s+g-t.clientHeight),u<0&&(u=0),t.style.left=`${h}px`,t.style.top=`${u}px`}var nm=(t,...e)=>{for(let i of e){let[n,r,o,s]=i;n.addEventListener(r,o,s),t.push(i)}},kS=t=>{if(t){for(let[e,i,n,r]of t)e.removeEventListener(i,n,r);t.length=0}},fs=t=>{t.cancelable&&t.preventDefault()};function eq(t,e){return e}function ID(t){return t?.getLocaleTextFunc()??eq}function tq(t,e,i,n){let r=e[i];return t.getLocaleTextFunc()(i,typeof r=="function"?r(n):r,n)}function iq(t){return(e,i,n)=>t({key:e,defaultValue:i,variableValues:n})}function nq(t){return(e,i,n)=>{let r=t?.[e];if(r&&n?.length){let o=0;for(;!(o>=n.length||r.indexOf("${variable}")===-1);)r=r.replace("${variable}",n[o++])}return r??i}}var Br=class{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.propertyListenerId=0,this.lastChangeSetIdLookup={},this.isAlive=()=>!this.destroyed}preWireBeans(t){this.beans=t,this.stubContext=t.context,this.eventSvc=t.eventSvc,this.gos=t.gos}destroy(){let{destroyFunctions:t}=this;for(let e=0;e<t.length;e++)t[e]();t.length=0,this.destroyed=!0,this.dispatchLocalEvent({type:"destroyed"})}addEventListener(t,e,i){this.localEventService||(this.localEventService=new ka),this.localEventService.addEventListener(t,e,i)}removeEventListener(t,e,i){this.localEventService?.removeEventListener(t,e,i)}dispatchLocalEvent(t){this.localEventService?.dispatchEvent(t)}addManagedElementListeners(t,e){return this._setupListeners(t,e)}addManagedEventListeners(t){return this._setupListeners(this.eventSvc,t)}addManagedListeners(t,e){return this._setupListeners(t,e)}_setupListeners(t,e){let i=[];for(let n of Object.keys(e)){let r=e[n];r&&i.push(this._setupListener(t,n,r))}return i}_setupListener(t,e,i){if(this.destroyed)return()=>null;let n;if(rq(t))t.__addEventListener(e,i),n=()=>(t.__removeEventListener(e,i),null);else{let r=oq(t);t instanceof HTMLElement?Jj(t,e,i):r?t.addListener(e,i):t.addEventListener(e,i),n=r?()=>(t.removeListener(e,i),null):()=>(t.removeEventListener(e,i),null)}return this.destroyFunctions.push(n),()=>(n(),this.destroyFunctions=this.destroyFunctions.filter(r=>r!==n),null)}setupPropertyListener(t,e){let{gos:i}=this;i.addPropertyEventListener(t,e);let n=()=>(i.removePropertyEventListener(t,e),null);return this.destroyFunctions.push(n),()=>(n(),this.destroyFunctions=this.destroyFunctions.filter(r=>r!==n),null)}addManagedPropertyListener(t,e){return this.destroyed?()=>null:this.setupPropertyListener(t,e)}addManagedPropertyListeners(t,e){if(this.destroyed)return;let i=t.join("-")+this.propertyListenerId++,n=r=>{if(r.changeSet){if(r.changeSet&&r.changeSet.id===this.lastChangeSetIdLookup[i])return;this.lastChangeSetIdLookup[i]=r.changeSet.id}let o={type:"propertyChanged",changeSet:r.changeSet,source:r.source};e(o)};for(let r of t)this.setupPropertyListener(r,n)}getLocaleTextFunc(){return ID(this.beans.localeSvc)}addDestroyFunc(t){this.isAlive()?this.destroyFunctions.push(t):t()}createOptionalManagedBean(t,e){return t?this.createManagedBean(t,e):void 0}createManagedBean(t,e){let i=this.createBean(t,e);return this.addDestroyFunc(this.destroyBean.bind(this,t,e)),i}createBean(t,e,i){return(e||this.stubContext).createBean(t,i)}destroyBean(t,e){return(e||this.stubContext).destroyBean(t)}destroyBeans(t,e){return(e||this.stubContext).destroyBeans(t)}};function rq(t){return t.__addEventListener!==void 0}function oq(t){return t.eventServiceType==="global"}var H=class extends Br{},X5={};function FS(t,e){X5[e]||(t(),X5[e]=!0)}var sq={pending:!1,funcs:[]},aq={pending:!1,funcs:[]};function Wy(t,e="setTimeout",i){let n=e==="raf"?aq:sq;if(n.funcs.push(t),n.pending)return;n.pending=!0;let r=()=>{let o=n.funcs.slice();n.funcs.length=0,n.pending=!1;for(let s of o)s()};e==="raf"?Eo(i,r):window.setTimeout(r,0)}function ui(t,e,i){let n;return function(...r){let o=this;window.clearTimeout(n),n=window.setTimeout(function(){t.isAlive()&&e.apply(o,r)},i)}}function J5(t,e){let i=0;return function(...n){let r=this,o=Date.now();o-i<e||(i=o,t.apply(r,n))}}function lq(t,e,i,n=100){let r=Date.now(),o=null,s=!1,a=()=>{o!=null&&(window.clearInterval(o),o=null)};t.addDestroyFunc(a);let l=()=>{let c=Date.now()-r>n;(e()||c)&&(i(),s=!0,a())};l(),s||(o=window.setInterval(l,10))}var AD=new Set(["__proto__","constructor","prototype"]);function cq(t,e){if(t!=null){if(Array.isArray(t)){for(let i=0;i<t.length;i++)e(i.toString(),t[i]);return}for(let i of Object.keys(t).filter(n=>!AD.has(n)))e(i,t[i])}}function Vi(t,e,i=!0,n=!1){ae(e)&&cq(e,(r,o)=>{let s=t[r];s!==o&&(n&&s==null&&o!=null&&typeof o=="object"&&o.constructor===Object&&(s={},t[r]=s),Q5(o)&&Q5(s)&&!Array.isArray(s)?Vi(s,o,i,n):(i||o!==void 0)&&(t[r]=o))})}function Q5(t){return typeof t=="object"&&t!==null}var dq=(()=>{let t=class go{static applyGlobalGridOptions(i){if(!go.gridOptions)return w({},i);let n={};return Vi(n,go.gridOptions,!0,!0),go.mergeStrategy==="deep"?Vi(n,i,!0,!0):n=w(w({},n),i),go.gridOptions.context&&(n.context=go.gridOptions.context),i.context&&(go.mergeStrategy==="deep"&&n.context&&Vi(i.context,n.context,!0,!0),n.context=i.context),n}static applyGlobalGridOption(i,n){if(go.mergeStrategy==="deep"){let r=uq(i);if(r&&typeof r=="object"&&typeof n=="object")return go.applyGlobalGridOptions({[i]:n})[i]}return n}};return t.gridOptions=void 0,t.mergeStrategy="shallow",t})(),TS=dq;function uq(t){return TS.gridOptions?.[t]}var hq={suppressContextMenu:!1,preventDefaultOnContextMenu:!1,allowContextMenuWithControlKey:!1,suppressMenuHide:!0,enableBrowserTooltips:!1,tooltipTrigger:"hover",tooltipShowDelay:2e3,tooltipHideDelay:1e4,tooltipMouseTrack:!1,tooltipShowMode:"standard",tooltipInteraction:!1,copyHeadersToClipboard:!1,copyGroupHeadersToClipboard:!1,clipboardDelimiter:"	",suppressCopyRowsToClipboard:!1,suppressCopySingleCellRanges:!1,suppressLastEmptyLineOnPaste:!1,suppressClipboardPaste:!1,suppressClipboardApi:!1,suppressCutToClipboard:!1,maintainColumnOrder:!1,enableStrictPivotColumnOrder:!1,suppressFieldDotNotation:!1,allowDragFromColumnsToolPanel:!1,suppressMovableColumns:!1,suppressColumnMoveAnimation:!1,suppressMoveWhenColumnDragging:!1,suppressDragLeaveHidesColumns:!1,suppressRowGroupHidesColumns:!1,suppressAutoSize:!1,autoSizePadding:20,skipHeaderOnAutoSize:!1,singleClickEdit:!1,suppressClickEdit:!1,readOnlyEdit:!1,stopEditingWhenCellsLoseFocus:!1,enterNavigatesVertically:!1,enterNavigatesVerticallyAfterEdit:!1,enableCellEditingOnBackspace:!1,undoRedoCellEditing:!1,undoRedoCellEditingLimit:10,suppressCsvExport:!1,suppressExcelExport:!1,cacheQuickFilter:!1,includeHiddenColumnsInQuickFilter:!1,excludeChildrenWhenTreeDataFiltering:!1,enableAdvancedFilter:!1,includeHiddenColumnsInAdvancedFilter:!1,enableCharts:!1,masterDetail:!1,keepDetailRows:!1,keepDetailRowsCount:10,detailRowAutoHeight:!1,tabIndex:0,rowBuffer:10,valueCache:!1,valueCacheNeverExpires:!1,enableCellExpressions:!1,suppressTouch:!1,suppressFocusAfterRefresh:!1,suppressBrowserResizeObserver:!1,suppressPropertyNamesCheck:!1,suppressChangeDetection:!1,debug:!1,suppressLoadingOverlay:!1,suppressNoRowsOverlay:!1,pagination:!1,paginationPageSize:100,paginationPageSizeSelector:!0,paginationAutoPageSize:!1,paginateChildRows:!1,suppressPaginationPanel:!1,pivotMode:!1,pivotPanelShow:"never",pivotDefaultExpanded:0,pivotSuppressAutoColumn:!1,suppressExpandablePivotGroups:!1,functionsReadOnly:!1,suppressAggFuncInHeader:!1,alwaysAggregateAtRootLevel:!1,aggregateOnlyChangedColumns:!1,suppressAggFilteredOnly:!1,removePivotHeaderRowWhenSingleValueColumn:!1,animateRows:!0,cellFlashDuration:500,cellFadeDuration:1e3,allowShowChangeAfterFilter:!1,domLayout:"normal",ensureDomOrder:!1,enableRtl:!1,suppressColumnVirtualisation:!1,suppressMaxRenderedRowRestriction:!1,suppressRowVirtualisation:!1,rowDragManaged:!1,rowDragInsertDelay:500,suppressRowDrag:!1,suppressMoveWhenRowDragging:!1,rowDragEntireRow:!1,rowDragMultiRow:!1,embedFullWidthRows:!1,groupDisplayType:"singleColumn",groupDefaultExpanded:0,groupMaintainOrder:!1,groupSelectsChildren:!1,groupSuppressBlankHeader:!1,groupSelectsFiltered:!1,showOpenedGroup:!1,groupRemoveSingleChildren:!1,groupRemoveLowestSingleChildren:!1,groupHideOpenParents:!1,groupAllowUnbalanced:!1,rowGroupPanelShow:"never",suppressMakeColumnVisibleAfterUnGroup:!1,treeData:!1,rowGroupPanelSuppressSort:!1,suppressGroupRowsSticky:!1,rowModelType:"clientSide",asyncTransactionWaitMillis:50,suppressModelUpdateAfterUpdateTransaction:!1,cacheOverflowSize:1,infiniteInitialRowCount:1,serverSideInitialRowCount:1,cacheBlockSize:100,maxBlocksInCache:-1,maxConcurrentDatasourceRequests:2,blockLoadDebounceMillis:0,purgeClosedRowNodes:!1,serverSideSortAllLevels:!1,serverSideOnlyRefreshFilteredGroups:!1,serverSidePivotResultFieldSeparator:"_",viewportRowModelPageSize:5,viewportRowModelBufferSize:5,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,debounceVerticalScrollbar:!1,suppressHorizontalScroll:!1,suppressScrollOnNewData:!1,suppressScrollWhenPopupsAreOpen:!1,suppressAnimationFrame:!1,suppressMiddleClickScrolls:!1,suppressPreventDefaultOnMouseWheel:!1,rowMultiSelectWithClick:!1,suppressRowDeselection:!1,suppressRowClickSelection:!1,suppressCellFocus:!1,suppressHeaderFocus:!1,suppressMultiRangeSelection:!1,enableCellTextSelection:!1,enableRangeSelection:!1,enableRangeHandle:!1,enableFillHandle:!1,fillHandleDirection:"xy",suppressClearOnFillReduction:!1,accentedSort:!1,unSortIcon:!1,suppressMultiSort:!1,alwaysMultiSort:!1,suppressMaintainUnsortedOrder:!1,suppressRowHoverHighlight:!1,suppressRowTransform:!1,columnHoverHighlight:!1,deltaSort:!1,enableGroupEdit:!1,groupLockGroupColumns:0,serverSideEnableClientSideSort:!1,suppressServerSideFullWidthLoadingRow:!1,pivotMaxGeneratedColumns:-1,columnMenu:"new",reactiveCustomComponents:!0,suppressSetFilterByDefault:!1,rowNumbers:!1,enableFilterHandlers:!1},OD="https://www.ag-grid.com";function Cs(t,e,...i){t.get("debug")&&console.log("AG Grid: "+e,...i)}function Qu(t,...e){FS(()=>console.warn("AG Grid: "+t,...e),t+e?.join(""))}function tc(t,...e){FS(()=>console.error("AG Grid: "+t,...e),t+e?.join(""))}var LD=new Set,wm={},ic={},rm,ND=!1,BD=!1,pq=!1;function fq(t){let[e,i]=t.version.split(".")||[],[n,r]=rm.split(".")||[];return e===n&&i===r}function gq(t){rm||(rm=t.version);let e=n=>`You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. ${n} Please update all modules to the same version.`;t.version?fq(t)||tc(e(`'${t.moduleName}' is version ${t.version} but the other modules are version ${rm}.`)):tc(e(`'${t.moduleName}' is incompatible.`));let i=t.validate?.();i&&!i.isValid&&tc(`${i.message}`)}function ch(t,e,i=!1){i||(ND=!0),gq(t);let n=t.rowModels??["all"];LD.add(t);let r;e!==void 0?(BD=!0,ic[e]===void 0&&(ic[e]={}),r=ic[e]):r=wm;for(let o of n)r[o]===void 0&&(r[o]={}),r[o][t.moduleName]=t;if(t.dependsOn)for(let o of t.dependsOn)ch(o,e,i)}function mq(t){delete ic[t]}function Uy(t,e,i){let n=r=>!!wm[r]?.[t]||!!ic[e]?.[r]?.[t];return n(i)||n("all")}function DS(){return BD}function vq(t,e){let i=ic[t]??{};return[...Object.values(wm.all??{}),...Object.values(i.all??{}),...Object.values(wm[e]??{}),...Object.values(i[e]??{})]}function Cq(){return new Set(LD)}function wq(){return ND}function HD(){return pq}var Bm=class{static register(t){ch(t,void 0)}static registerModules(t){for(let e of t)ch(e,void 0)}},oe="34.3.1",Z5=2e3,eT=100,zD="_version_",VD=null,nc=`${OD}/javascript-data-grid`;function bq(t){VD=t}function yq(t){nc=t}function GD(t,e,i){return VD?.(t,e)??[Pq(t,e,i)]}function MS(t,e,i,n,r){t(`${n?"warning":"error"} #${e}`,...GD(e,i,r))}function Sq(t){if(!t)return String(t);let e={};for(let i of Object.keys(t))typeof t[i]!="object"&&typeof t[i]!="function"&&(e[i]=t[i]);return JSON.stringify(e)}function xq(t){let e=t;return t instanceof Error?e=t.toString():typeof t=="object"&&(e=Sq(t)),e}function bm(t){return t===void 0?"undefined":t===null?"null":t}function jy(t,e){return`${t}?${e.toString()}`}function Eq(t,e,i){let n=Array.from(e.entries()).sort((o,s)=>s[1].length-o[1].length),r=jy(t,e);for(let[o,s]of n){if(o===zD)continue;let a=r.length-i;if(a<=0)break;let l="...",c=a+l.length,d=s.length-c>eT?s.slice(0,s.length-c)+l:s.slice(0,eT)+l;e.set(o,d),r=jy(t,e)}return r}function WD(t,e){let i=new URLSearchParams;if(i.append(zD,oe),e)for(let o of Object.keys(e))i.append(o,xq(e[o]));let n=`${nc}/errors/${t}`,r=jy(n,i);return r.length<=Z5?r:Eq(n,i,Z5)}var Pq=(t,e,i)=>{let n=WD(t,e),r=`${i?i+` 
`:""}Visit ${n}`;return HD()?r:`${r}${i?"":` 
  Alternatively register the ValidationModule to see the full message in the console.`}`};function K(...t){MS(Qu,t[0],t[1],!0)}function at(...t){MS(tc,t[0],t[1],!1)}function qu(t,e,i){MS(tc,t,e,!1,i)}function Rq(t,e){let i=e[0];return`error #${i} `+GD(i,e[1],t).join(" ")}function Or(...t){return Rq(void 0,t)}function UD(t,e){return t.get("rowModelType")===e}function Lt(t,e){return UD(t,"clientSide")}function wc(t,e){return UD(t,"serverSide")}function pi(t,e){return t.get("domLayout")===e}function xa(t){return Sm(t)!==void 0}function jD(t){return typeof t.get("getRowHeight")=="function"}function _q(t,e){return e?!t.get("enableStrictPivotColumnOrder"):t.get("maintainColumnOrder")}function ws(t,e,i=!1,n){let{gos:r,environment:o}=t;if(n==null&&(n=o.getDefaultRowHeight()),jD(r)){if(i)return{height:n,estimated:!0};let l={node:e,data:e.data},c=r.getCallback("getRowHeight")(l);if(qy(c))return c===0&&K(23),{height:Math.max(1,c),estimated:!1}}if(e.detail&&r.get("masterDetail"))return kq(r);let s=r.get("rowHeight");return{height:s&&qy(s)?s:n,estimated:!1}}function kq(t){if(t.get("detailRowAutoHeight"))return{height:1,estimated:!1};let e=t.get("detailRowHeight");return qy(e)?{height:e,estimated:!1}:{height:300,estimated:!1}}function Ea(t){let{environment:e,gos:i}=t,n=i.get("rowHeight");if(!n||wt(n))return e.getDefaultRowHeight();let r=e.refreshRowHeightVariable();return r!==-1?r:(K(24),e.getDefaultRowHeight())}function qy(t){return!isNaN(t)&&typeof t=="number"&&isFinite(t)}function qD(t,e,i){let n=e[t.getDomDataKey()];return n?n[i]:void 0}function Fa(t,e,i,n){let r=t.getDomDataKey(),o=e[r];wt(o)&&(o={},e[r]=o),o[i]=n}function rc(t){return t.get("ensureDomOrder")?!1:t.get("animateRows")}function $D(t){return!(t.get("paginateChildRows")||t.get("groupHideOpenParents")||pi(t,"print"))}function Dr(t){return!t.get("autoGroupColumnDef")?.comparator&&!t.get("treeData")}function $y(t){let e=t.get("groupAggFiltering");if(typeof e=="function")return t.getCallback("groupAggFiltering");if(e===!0)return()=>!0}function KD(t){return t.get("grandTotalRow")}function YD(t,e){return e?!1:t.get("groupDisplayType")==="groupRows"}function XD(t,e,i){return!!e.group&&!e.footer&&YD(t,i)}function pc(t){let e=t.getCallback("getRowId");return e===void 0?e:i=>{let n=e(i);return typeof n!="string"&&(FS(()=>K(25,{id:n}),"getRowIdString"),n=String(n)),n}}function Fq(t,e){let i=t.get("groupHideParentOfSingleChild");return!!(i===!0||i==="leafGroupsOnly"&&e.leafGroup||t.get("groupRemoveSingleChildren")||t.get("groupRemoveLowestSingleChildren")&&e.leafGroup)}function Tq(t){let e=t.get("maxConcurrentDatasourceRequests");return e>0?e:void 0}function oc(t){return t?.checkboxes??!0}function om(t){return t?.mode==="multiRow"&&(t.headerCheckbox??!0)}function ym(t){if(typeof t=="object")return t.checkboxLocation??"selectionColumn"}function ly(t){return t?.hideDisabledCheckboxes??!1}function Dq(t){return typeof t.get("rowSelection")!="string"}function So(t){let e=t.get("cellSelection");return e!==void 0?!!e:t.get("enableRangeSelection")}function JD(t){let e=t.get("rowSelection")??"single";if(typeof e=="string"){let i=t.get("suppressRowClickSelection"),n=t.get("suppressRowDeselection");return i&&n?!1:i?"enableDeselection":n?"enableSelection":!0}return e.mode==="singleRow"||e.mode==="multiRow"?e.enableClickSelection??!1:!1}function Mq(t){let e=JD(t);return e===!0||e==="enableSelection"}function Iq(t){let e=JD(t);return e===!0||e==="enableDeselection"}function Ky(t){let e=t.get("rowSelection");return typeof e=="string"?t.get("isRowSelectable"):e?.isRowSelectable}function Sm(t){let e="beanName"in t&&t.beanName==="gos"?t.get("rowSelection"):t.rowSelection;if(typeof e=="string")switch(e){case"multiple":return"multiRow";case"single":return"singleRow";default:return}switch(e?.mode){case"multiRow":case"singleRow":return e.mode;default:return}}function dh(t){return Sm(t)==="multiRow"}function Aq(t){let e=t.get("rowSelection");return typeof e=="string"?t.get("rowMultiSelectWithClick"):e?.enableSelectionWithoutKeys??!1}function xm(t){let e=t.get("rowSelection");if(typeof e=="string"){let i=t.get("groupSelectsChildren"),n=t.get("groupSelectsFiltered");return i&&n?"filteredDescendants":i?"descendants":"self"}return e?.mode==="multiRow"?e.groupSelects:void 0}function QD(t,e=!0){let i=t.get("rowSelection");return typeof i!="object"?e?"all":void 0:i.mode==="multiRow"?i.selectAll:"all"}function Oq(t){let e=t.get("rowSelection");return typeof e=="string"?!1:e?.mode==="multiRow"?e.ctrlASelectsRows??!1:!1}function uh(t){let e=xm(t);return e==="descendants"||e==="filteredDescendants"}function tT(t){let e=t.get("rowSelection");return typeof e=="object"&&e.masterSelects||"self"}function Lq(t){return t.isModuleRegistered("SetFilter")&&!t.get("suppressSetFilterByDefault")}function dn(t){return t.get("columnMenu")==="legacy"}function Nq(t){return!dn(t)}function Bq(t){return!t||t.length<2?t:"on"+t[0].toUpperCase()+t.substring(1)}function ZD(t,e,i){typeof t!="object"&&(t={});let n=w({},t);for(let r of i){let o=e[r];typeof o<"u"&&(n[r]=o)}return n}function eM(t,e){if(!t)return;let i={},n=!1;for(let s of Object.keys(t))i[s]=t[s],n=!0;if(!n)return;let r={type:"gridOptionsChanged",options:i};e.dispatchEvent(r);let o=w({type:"componentStateChanged"},i);e.dispatchEvent(o)}function Ee(t,e){return t.addCommon(e)}function iT({gos:t},e){return e.button===2||e.ctrlKey&&t.get("allowContextMenuWithControlKey")}var Hq={resizable:!0,sortable:!0},zq=0;function tM(){return zq++}function bs(t){return t instanceof Aa}var Aa=class extends H{constructor(t,e,i,n){super(),this.colDef=t,this.userProvidedColDef=e,this.colId=i,this.primary=n,this.isColumn=!0,this.instanceId=tM(),this.autoHeaderHeight=null,this.moving=!1,this.resizing=!1,this.menuVisible=!1,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.colEventSvc=new ka,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.flex=null,this.colIdSanitised=Ku(i)}destroy(){super.destroy(),this.beans.rowSpanSvc?.deregister(this)}getInstanceId(){return this.instanceId}setState(){let{colDef:t,beans:{sortSvc:e,pinnedCols:i,colFlex:n}}=this;e?.initCol(this);let r=t.hide;r!==void 0?this.visible=!r:this.visible=!t.initialHide,i?.initCol(this),n?.initCol(this)}setColDef(t,e,i){let n=t.spanRows!==this.colDef.spanRows;this.colDef=t,this.userProvidedColDef=e,this.initMinAndMaxWidths(),this.initDotNotation(),this.initTooltip(),n&&(this.beans.rowSpanSvc?.deregister(this),this.initRowSpan()),this.dispatchColEvent("colDefChanged",i)}getUserProvidedColDef(){return this.userProvidedColDef}getParent(){return this.parent}getOriginalParent(){return this.originalParent}postConstruct(){this.setState(),this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip(),this.initRowSpan(),this.addPivotListener()}initDotNotation(){let{gos:t,colDef:{field:e,tooltipField:i}}=this,n=t.get("suppressFieldDotNotation");this.fieldContainsDots=ae(e)&&e.includes(".")&&!n,this.tooltipFieldContainsDots=ae(i)&&i.includes(".")&&!n}initMinAndMaxWidths(){let t=this.colDef;this.minWidth=t.minWidth??this.beans.environment.getDefaultColumnMinWidth(),this.maxWidth=t.maxWidth??Number.MAX_SAFE_INTEGER}initTooltip(){this.beans.tooltipSvc?.initCol(this)}initRowSpan(){this.colDef.spanRows&&this.beans.rowSpanSvc?.register(this)}addPivotListener(){let t=this.beans.pivotColDefSvc,e=this.colDef.pivotValueColumn;!t||!e||this.addManagedListeners(e,{colDefChanged:i=>{let n=t.recreateColDef(this.colDef);this.setColDef(n,n,i.source)}})}resetActualWidth(t){let e=this.calculateColInitialWidth(this.colDef);this.setActualWidth(e,t,!0)}calculateColInitialWidth(t){let e,i=t.width,n=t.initialWidth;return i!=null?e=i:n!=null?e=n:e=200,Math.max(Math.min(e,this.maxWidth),this.minWidth)}isEmptyGroup(){return!1}isRowGroupDisplayed(t){return this.beans.showRowGroupCols?.isRowGroupDisplayed(this,t)??!1}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}getHighlighted(){return this.highlighted}__addEventListener(t,e){this.colEventSvc.addEventListener(t,e)}__removeEventListener(t,e){this.colEventSvc.removeEventListener(t,e)}addEventListener(t,e){this.frameworkEventListenerService=this.beans.frameworkOverrides.createLocalEventListenerWrapper?.(this.frameworkEventListenerService,this.colEventSvc);let i=this.frameworkEventListenerService?.wrap(t,e)??e;this.colEventSvc.addEventListener(t,i)}removeEventListener(t,e){let i=this.frameworkEventListenerService?.unwrap(t,e)??e;this.colEventSvc.removeEventListener(t,i)}createColumnFunctionCallbackParams(t){return Ee(this.gos,{node:t,data:t.data,column:this,colDef:this.colDef})}isSuppressNavigable(t){return this.beans.cellNavigation?.isSuppressNavigable(this,t)??!1}isCellEditable(t){return this.beans.editSvc?.isCellEditable({rowNode:t,column:this})??!1}isSuppressFillHandle(){return!!this.colDef.suppressFillHandle}isAutoHeight(){return!!this.colDef.autoHeight}isAutoHeaderHeight(){return!!this.colDef.autoHeaderHeight}isRowDrag(t){return this.isColumnFunc(t,this.colDef.rowDrag)}isDndSource(t){return this.isColumnFunc(t,this.colDef.dndSource)}isCellCheckboxSelection(t){return this.beans.selectionSvc?.isCellCheckboxSelection(this,t)??!1}isSuppressPaste(t){return this.isColumnFunc(t,this.colDef?.suppressPaste??null)}isResizable(){return!!this.getColDefValue("resizable")}getColDefValue(t){return this.colDef[t]??Hq[t]}isColumnFunc(t,e){if(typeof e=="boolean")return e;if(typeof e=="function"){let i=this.createColumnFunctionCallbackParams(t);return e(i)}return!1}createColumnEvent(t,e){return Ee(this.gos,{type:t,column:this,columns:[this],source:e})}isMoving(){return this.moving}getSort(){return this.sort}isSortable(){return!!this.getColDefValue("sortable")}isSortAscending(){return this.sort==="asc"}isSortDescending(){return this.sort==="desc"}isSortNone(){return wt(this.sort)}isSorting(){return ae(this.sort)}getSortIndex(){return this.sortIndex}isMenuVisible(){return this.menuVisible}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(t,e){this.oldLeft=this.left,this.left!==t&&(this.left=t,this.dispatchColEvent("leftChanged",e))}isFilterActive(){return this.filterActive}isHovered(){return K(261),!!this.beans.colHover?.isHovered(this)}setFirstRightPinned(t,e){this.firstRightPinned!==t&&(this.firstRightPinned=t,this.dispatchColEvent("firstRightPinnedChanged",e))}setLastLeftPinned(t,e){this.lastLeftPinned!==t&&(this.lastLeftPinned=t,this.dispatchColEvent("lastLeftPinnedChanged",e))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return this.pinned==="left"||this.pinned==="right"}isPinnedLeft(){return this.pinned==="left"}isPinnedRight(){return this.pinned==="right"}getPinned(){return this.pinned}setVisible(t,e){let i=t===!0;this.visible!==i&&(this.visible=i,this.dispatchColEvent("visibleChanged",e)),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){return!this.getColDef().suppressSpanHeaderHeight}getFirstRealParent(){let t=this.getOriginalParent();for(;t?.isPadding();)t=t.getOriginalParent();return t}getColumnGroupPaddingInfo(){let t=this.getParent();if(!t?.isPadding())return{numberOfParents:0,isSpanningTotal:!1};let e=t.getPaddingLevel()+1,i=!0;for(;t;){if(!t.isPadding()){i=!1;break}t=t.getParent()}return{numberOfParents:e,isSpanningTotal:i}}getColDef(){return this.colDef}getDefinition(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(t){let e=t!==this.autoHeaderHeight;return this.autoHeaderHeight=t,e}createBaseColDefParams(t){return Ee(this.gos,{node:t,data:t.data,colDef:this.colDef,column:this})}getColSpan(t){if(wt(this.colDef.colSpan))return 1;let e=this.createBaseColDefParams(t),i=this.colDef.colSpan(e);return Math.max(i,1)}getRowSpan(t){if(wt(this.colDef.rowSpan))return 1;let e=this.createBaseColDefParams(t),i=this.colDef.rowSpan(e);return Math.max(i,1)}setActualWidth(t,e,i=!1){t=Math.max(t,this.minWidth),t=Math.min(t,this.maxWidth),this.actualWidth!==t&&(this.actualWidth=t,this.flex!=null&&e!=="flex"&&e!=="gridInitializing"&&(this.flex=null),i||this.fireColumnWidthChangedEvent(e)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(t){this.dispatchColEvent("widthChanged",t)}isGreaterThanMax(t){return t>this.maxWidth}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex}isRowGroupActive(){return this.rowGroupActive}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}isValueActive(){return this.aggregationActive}isAllowPivot(){return this.colDef.enablePivot===!0}isAllowValue(){return this.colDef.enableValue===!0}isAllowRowGroup(){return this.colDef.enableRowGroup===!0}dispatchColEvent(t,e,i){let n=this.createColumnEvent(t,e);i&&Vi(n,i),this.colEventSvc.dispatchEvent(n)}dispatchStateUpdatedEvent(t){this.colEventSvc.dispatchEvent({type:"columnStateUpdated",key:t})}};function Fi(t){return t instanceof sm}var sm=class extends H{constructor(t,e,i,n){super(),this.colGroupDef=t,this.groupId=e,this.padding=i,this.level=n,this.isColumn=!1,this.expandable=!1,this.instanceId=tM(),this.expandableListenerRemoveCallback=null,this.expanded=!!t?.openByDefault}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0),super.destroy()}reset(t,e){this.colGroupDef=t,this.level=e,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return this.children?this.children.some(t=>t.isVisible()):!1}isPadding(){return this.padding}setExpanded(t){this.expanded=t===void 0?!1:t,this.dispatchLocalEvent({type:"expandedChanged"})}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(t){this.children=t}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){let t=[];return this.addLeafColumns(t),t}forEachLeafColumn(t){if(this.children)for(let e of this.children)bs(e)?t(e):Fi(e)&&e.forEachLeafColumn(t)}addLeafColumns(t){if(this.children)for(let e of this.children)bs(e)?t.push(e):Fi(e)&&e.addLeafColumns(t)}getColumnGroupShow(){let t=this.colGroupDef;if(t)return t.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();let t=this.onColumnVisibilityChanged.bind(this);for(let e of this.getLeafColumns())e.__addEventListener("visibleChanged",t);this.expandableListenerRemoveCallback=()=>{for(let e of this.getLeafColumns())e.__removeEventListener("visibleChanged",t);this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let t=!1,e=!1,i=!1,n=this.findChildrenRemovingPadding();for(let o=0,s=n.length;o<s;o++){let a=n[o];if(!a.isVisible())continue;let l=a.getColumnGroupShow();l==="open"?(t=!0,i=!0):l==="closed"?(e=!0,i=!0):(t=!0,e=!0)}let r=t&&e&&i;this.expandable!==r&&(this.expandable=r,this.dispatchLocalEvent({type:"expandableChanged"}))}findChildrenRemovingPadding(){let t=[],e=i=>{for(let n of i)Fi(n)&&n.isPadding()?e(n.children):t.push(n)};return e(this.children),t}onColumnVisibilityChanged(){this.setExpandable()}},Vq={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}};function nT(t,e,i){let n={},r=t.gos;return Object.assign(n,r.get("defaultColGroupDef")),Object.assign(n,e),r.validateColDef(n,i),n}var Gq=class{constructor(){this.existingKeys={}}addExistingKeys(t){for(let e=0;e<t.length;e++)this.existingKeys[t[e]]=!0}getUniqueKey(t,e){t=Vy(t);let i=0;for(;;){let n=t??e;if(n?i!==0&&(n+="_"+i):n=i,!this.existingKeys[n]){let r=String(n);return t&&i>0&&K(273,{providedId:t,usedId:r}),this.existingKeys[r]=!0,r}i++}}},zEe=Object.freeze([]);function dt(t){if(t?.length)return t[t.length-1]}function xs(t,e,i){if(t===e)return!0;if(!t||!e)return t==null&&e==null;let n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r]&&!i?.(t[r],e[r]))return!1;return!0}function zu(t,e){if(t)for(let i of t)e(i)}function er(t,e){let i=t.indexOf(e);i>=0&&t.splice(i,1)}function rT(t,e,i){for(let n=0;n<e.length;n++)er(t,e[n]);for(let n=e.length-1;n>=0;n--)t.splice(i,0,e[n])}var Hm="ag-Grid-AutoColumn",iM="ag-Grid-SelectionColumn",nM="ag-Grid-RowNumbersColumn";function rM(t){let e=[],i=n=>{for(let r=0;r<n.length;r++){let o=n[r];bs(o)?e.push(o):Fi(o)&&i(o.getChildren())}};return i(t),e}function mo(t){return t.reduce((e,i)=>e+i.getActualWidth(),0)}function Em(t,e,i){let n={};if(!e)return;bo(null,e,o=>{n[o.getInstanceId()]=o}),i&&bo(null,i,o=>{n[o.getInstanceId()]=null});let r=Object.values(n).filter(o=>o!=null);t.context.destroyBeans(r)}function IS(t){return t.getId().startsWith(Hm)}function Po(t){return(typeof t=="string"?t:"getColId"in t?t.getColId():t.colId)?.startsWith(iM)??!1}function wo(t){return(typeof t=="string"?t:"getColId"in t?t.getColId():t.colId)?.startsWith(nM)??!1}function Wq(t){return Po(t)||wo(t)}function Pm(t){let e=[];return t instanceof Array?e=t:typeof t=="string"&&(e=t.split(",")),e}function Uq(t,e){return xs(t,e,(i,n)=>i.getColId()===n.getColId())}function jq(t){t.map={};for(let e of t.list)t.map[e.getId()]=e}function sc(t){return t==="optionsUpdated"?"gridOptionsChanged":t}function Zu(t,e){let i=t===e,n=t.getColDef()===e,r=t.getColId()==e;return i||n||r}var qq=(t,e)=>(i,n)=>{let r={value1:void 0,value2:void 0},o=!1;return t&&(t[i]!==void 0&&(r.value1=t[i],o=!0),ae(n)&&t[n]!==void 0&&(r.value2=t[n],o=!0)),!o&&e&&(e[i]!==void 0&&(r.value1=e[i]),ae(n)&&e[n]!==void 0&&(r.value2=e[n])),r},$q=(t,e)=>{Fi(t)&&t.setupExpandable(),t.originalParent=e};function Kq(t,e=null,i,n,r){let o=new Gq,{existingCols:s,existingGroups:a,existingColKeys:l}=Yq(n);o.addExistingKeys(l);let c=oM(t,e,0,i,s,o,a,r),{colGroupSvc:d}=t,u=d?.findMaxDepth(c,0)??0,h=d?d.balanceColumnTree(c,0,u,o):c;return bo(null,h,$q),{columnTree:h,treeDepth:u}}function Yq(t){let e=[],i=[],n=[];return t&&bo(null,t,r=>{if(Fi(r)){let o=r;i.push(o)}else{let o=r;n.push(o.getId()),e.push(o)}}),{existingCols:e,existingGroups:i,existingColKeys:n}}function oM(t,e,i,n,r,o,s,a){if(!e)return[];let{colGroupSvc:l}=t,c=new Array(e.length);for(let d=0;d<c.length;d++){let u=e[d];l&&t$(u)?c[d]=l.createProvidedColumnGroup(n,u,i,r,o,s,a):c[d]=Xq(t,n,u,r,o,a)}return c}function Xq(t,e,i,n,r,o){let s=Qq(i,n);s&&n?.splice(s.idx,1);let a=s?.column;if(a){let l=Yy(t,i,a.getColId());a.setColDef(l,i,o),Jq(t,a,l,o)}else{let l=r.getUniqueKey(i.colId,i.field),c=Yy(t,i,l);a=new Aa(c,i,l,e),t.context.createBean(a)}return t.dataTypeSvc?.addColumnListeners(a),a}function sM(t,e,i,n,r,o,s,a){let{sortSvc:l,pinnedCols:c,colFlex:d}=t;i!==void 0&&e.setVisible(!i,a),l&&(l.updateColSort(e,n,a),r!==void 0&&l.setColSortIndex(e,r)),o!==void 0&&c?.setColPinned(e,o),s!==void 0&&d?.setColFlex(e,s)}function Jq(t,e,i,n){sM(t,e,i.hide,i.sort,i.sortIndex,i.pinned,i.flex,n);let r=e.getFlex();if(!(r!=null&&r>0))if(i.width!=null)e.setActualWidth(i.width,n);else{let o=e.getActualWidth();e.setActualWidth(o,n)}}function Qq(t,e){if(e)for(let i=0;i<e.length;i++){let n=e[i].getUserProvidedColDef();if(!n)continue;if(t.colId!=null){if(e[i].getId()===t.colId)return{idx:i,column:e[i]};continue}if(t.field!=null){if(n.field===t.field)return{idx:i,column:e[i]};continue}if(n===t)return{idx:i,column:e[i]}}}function Yy(t,e,i,n){let{gos:r,dataTypeSvc:o}=t,s={},a=r.get("defaultColDef");Vi(s,a,!1,!0);let l=Zq(t,s,e,i);l&&e$(t,l,s);let c=s.cellDataType;Vi(s,e,!1,!0),c!==void 0&&(s.cellDataType=c);let d=r.get("autoGroupColumnDef"),u=Dr(r);return e.rowGroup&&d&&u&&Vi(s,{sort:d.sort,initialSort:d.initialSort},!1,!0),o&&(o.postProcess(s),o.validateColDef(s)),r.validateColDef(s,i,n),s}function Zq(t,e,i,n){let r=t.dataTypeSvc?.updateColDefAndGetColumnType(e,i,n),o=i.type??r??e.type;return e.type=o,o?Pm(o):void 0}function e$(t,e,i){if(!e.length)return;let n=Object.assign({},Vq),r=t.gos.get("columnTypes")||{};for(let o of Object.keys(r)){let s=r[o];o in n?K(34,{key:o}):(s.type&&K(35),n[o]=s)}for(let o of e){let s=n[o.trim()];s?Vi(i,s,!1,!0):K(36,{t:o})}}function t$(t){return t.children!==void 0}function bo(t,e,i){if(e)for(let n=0;n<e.length;n++){let r=e[n];Fi(r)&&bo(r,r.getChildren(),i),i(r,t)}}function aM(t,e){let i=[],n=[],r=[];return t.forEach(s=>{let a=s.getColDef().lockPosition;a==="right"?r.push(s):a==="left"||a===!0?i.push(s):n.push(s)}),e.get("enableRtl")?[...r,...n,...i]:[...i,...n,...r]}function lM(t,e){let i=!0;return bo(null,e,n=>{if(!Fi(n))return;let r=n;if(!r.getColGroupDef()?.marryChildren)return;let a=[];for(let h of r.getLeafColumns()){let p=t.indexOf(h);a.push(p)}let l=Math.max.apply(Math,a),c=Math.min.apply(Math,a),d=l-c,u=r.getLeafColumns().length-1;d>u&&(i=!1)}),i}function cM(t,e){if(!t||t.length==0)return;let i=e(t[0]);for(let n=1;n<t.length;n++)if(i!==e(t[n]))return;return i}function dM(t,e,i){if(!e.length)return;let n=e.length===1?e[0]:null,r=cM(e,o=>o.getPinned());t.dispatchEvent({type:"columnPinned",pinned:r??null,columns:e,column:n,source:i})}function i$(t,e,i){if(!e.length)return;let n=e.length===1?e[0]:null,r=cM(e,o=>o.isVisible());t.dispatchEvent({type:"columnVisible",visible:r,columns:e,column:n,source:i})}function n$(t,e,i,n){t.dispatchEvent({type:e,columns:i,column:i&&i.length==1?i[0]:null,source:n})}function fc(t,e,i,n,r=null){e?.length&&t.dispatchEvent({type:"columnResized",columns:e,column:e.length===1?e[0]:null,flexColumns:r,finished:i,source:n})}function Zn(t,e,i){let{colModel:n,rowGroupColsSvc:r,pivotColsSvc:o,autoColSvc:s,selectionColSvc:a,colAnimation:l,visibleCols:c,pivotResultCols:d,environment:u,valueColsSvc:h,eventSvc:p,gos:f}=t,g=n.getColDefCols()??[],m=a?.getColumns();if(!g.length&&!m?.length)return!1;if(e?.state&&!e.state.forEach)return K(32),!1;let v=(x,E,P,L,B)=>{if(!x)return;let j=qq(E,e.defaultState),q=j("flex").value1;if(sM(t,x,j("hide").value1,j("sort").value1,j("sortIndex").value1,j("pinned").value1,q,i),q==null){let Y=j("width").value1;if(Y!=null){let he=x.getColDef().minWidth??u.getDefaultColumnMinWidth();he!=null&&Y>=he&&x.setActualWidth(Y,i)}}B||!x.isPrimary()||(h?.syncColumnWithState(x,i,j),r?.syncColumnWithState(x,i,j,P),o?.syncColumnWithState(x,i,j,L))},C=(x,E,P)=>{let L=uM(t,i),B=E.slice(),j={},q={},Y=[],he=[],Se=[],be=0,T=r?.columns.slice()??[],R=o?.columns.slice()??[];for(let G of x){let U=G.colId;if(U.startsWith(Hm)){Y.push(G),Se.push(G);continue}if(Po(U)){he.push(G),Se.push(G);continue}let I=P(U);I?(v(I,G,j,q,!1),er(B,I)):(Se.push(G),be+=1)}let _=G=>v(G,null,j,q,!1);B.forEach(_),r?.sortColumns(oT.bind(r,j,T)),o?.sortColumns(oT.bind(o,q,R)),n.refreshCols(!1,i);let z=(G,U,N=[])=>{for(let I of U){let V=G(I.colId);er(N,V),v(V,I,null,null,!0)}N.forEach(_)};return z(G=>s?.getColumn(G)??null,Y,s?.getColumns()?.slice()),z(G=>a?.getColumn(G)??null,he,a?.getColumns()?.slice()),o$(e,n,f),c.refresh(i),p.dispatchEvent({type:"columnEverythingChanged",source:i}),L(),{unmatchedAndAutoStates:Se,unmatchedCount:be}};l?.start();let{unmatchedAndAutoStates:b,unmatchedCount:S}=C(e.state||[],g,x=>n.getColDefCol(x));if(b.length>0||ae(e.defaultState)){let x=d?.getPivotResultCols()?.list??[];S=C(b,x,E=>d?.getPivotResultCol(E)??null).unmatchedCount}return l?.finish(),S===0}function r$(t,e){let{colModel:i,autoColSvc:n,selectionColSvc:r,eventSvc:o,gos:s}=t,a=i.getColDefCols();if(!a?.length)return;let l=i.getColDefColTree(),c=rM(l),d=[],u=1e3,h=1e3,p=C=>{let b=hM(C);wt(b.rowGroupIndex)&&b.rowGroup&&(b.rowGroupIndex=u++),wt(b.pivotIndex)&&b.pivot&&(b.pivotIndex=h++),d.push(b)};n?.getColumns()?.forEach(p),r?.getColumns()?.forEach(p),c?.forEach(p),Zn(t,{state:d},e);let f=n?.getColumns()??[],v=[...r?.getColumns()??[],...f,...a].map(C=>({colId:C.colId}));Zn(t,{state:v,applyOrder:!0},e),o.dispatchEvent(Ee(s,{type:"columnsReset",source:e}))}function uM(t,e){let{rowGroupColsSvc:i,pivotColsSvc:n,valueColsSvc:r,colModel:o,sortSvc:s,eventSvc:a}=t,l={rowGroupColumns:i?.columns.slice()??[],pivotColumns:n?.columns.slice()??[],valueColumns:r?.columns.slice()??[]},c=Rm(t),d={};for(let u of c)d[u.colId]=u;return()=>{let u=(E,P,L,B)=>{let j=P.map(B),q=L.map(B);if(xs(j,q))return;let he=new Set(P);for(let be of L)he.delete(be)||he.add(be);let Se=[...he];a.dispatchEvent({type:E,columns:Se,column:Se.length===1?Se[0]:null,source:e})},h=E=>{let P=[];return o.forAllCols(L=>{let B=d[L.getColId()];B&&E(B,L)&&P.push(L)}),P},p=E=>E.getColId();u("columnRowGroupChanged",l.rowGroupColumns,i?.columns??[],p),u("columnPivotChanged",l.pivotColumns,n?.columns??[],p);let g=h((E,P)=>{let L=E.aggFunc!=null,B=L!=P.isValueActive(),j=L&&E.aggFunc!=P.getAggFunc();return B||j});g.length>0&&n$(a,"columnValueChanged",g,e),fc(a,h((E,P)=>E.width!=P.getActualWidth()),!0,e),dM(a,h((E,P)=>E.pinned!=P.getPinned()),e),i$(a,h((E,P)=>E.hide==P.isVisible()),e);let S=h((E,P)=>E.sort!=P.getSort()||E.sortIndex!=P.getSortIndex());S.length>0&&s?.dispatchSortChangedEvents(e,S);let x=Rm(t);a$(c,x,e,o,a)}}function Rm(t){let{colModel:e,rowGroupColsSvc:i,pivotColsSvc:n}=t,r=e.getColDefCols();if(wt(r)||!e.isAlive())return[];let o=i?.columns,s=n?.columns,a=[],l=d=>{let u=d.isRowGroupActive()&&o?o.indexOf(d):null,h=d.isPivotActive()&&s?s.indexOf(d):null,p=d.isValueActive()?d.getAggFunc():null,f=d.getSort()!=null?d.getSort():null,g=d.getSortIndex()!=null?d.getSortIndex():null;a.push({colId:d.getColId(),width:d.getActualWidth(),hide:!d.isVisible(),pinned:d.getPinned(),sort:f,sortIndex:g,aggFunc:p,rowGroup:d.isRowGroupActive(),rowGroupIndex:u,pivot:d.isPivotActive(),pivotIndex:h,flex:d.getFlex()??null})};e.forAllCols(d=>l(d));let c=new Map(e.getCols().map((d,u)=>[d.getColId(),u]));return a.sort((d,u)=>{let h=c.has(d.colId)?c.get(d.colId):-1,p=c.has(u.colId)?c.get(u.colId):-1;return h-p}),a}function hM(t){let e=(f,g)=>f??g??null,i=t.getColDef(),n=e(i.sort,i.initialSort),r=e(i.sortIndex,i.initialSortIndex),o=e(i.hide,i.initialHide),s=e(i.pinned,i.initialPinned),a=e(i.width,i.initialWidth),l=e(i.flex,i.initialFlex),c=e(i.rowGroupIndex,i.initialRowGroupIndex),d=e(i.rowGroup,i.initialRowGroup);c==null&&!d&&(c=null,d=null);let u=e(i.pivotIndex,i.initialPivotIndex),h=e(i.pivot,i.initialPivot);u==null&&!h&&(u=null,h=null);let p=e(i.aggFunc,i.initialAggFunc);return{colId:t.getColId(),sort:n,sortIndex:r,hide:o,pinned:s,width:a,flex:l,rowGroup:d,rowGroupIndex:c,pivot:h,pivotIndex:u,aggFunc:p}}function o$(t,e,i){if(!t.applyOrder||!t.state)return;let n=[];for(let r of t.state)r.colId!=null&&n.push(r.colId);s$(e.cols,n,e,i)}function s$(t,e,i,n){if(t==null)return;let r=[],o={};for(let a of e){if(o[a])continue;let l=t.map[a];l&&(r.push(l),o[a]=!0)}let s=0;for(let a of t.list){let l=a.getColId();if(o[l]!=null)continue;l.startsWith(Hm)?r.splice(s++,0,a):r.push(a)}if(r=aM(r,n),!lM(r,i.getColTree())){K(39);return}t.list=r}function a$(t,e,i,n,r){let o={};for(let d of e)o[d.colId]=d;let s={};for(let d of t)o[d.colId]&&(s[d.colId]=!0);let a=t.filter(d=>s[d.colId]),l=e.filter(d=>s[d.colId]),c=[];l.forEach((d,u)=>{let h=a?.[u];if(h&&h.colId!==d.colId){let p=n.getCol(h.colId);p&&c.push(p)}}),c.length&&r.dispatchEvent({type:"columnMoved",columns:c,column:c.length===1?c[0]:null,finished:!0,source:i})}var oT=(t,e,i,n)=>{let r=t[i.getId()],o=t[n.getId()],s=r!=null,a=o!=null;if(s&&a)return r-o;if(s)return-1;if(a)return 1;let l=e.indexOf(i),c=e.indexOf(n),d=l>=0,u=c>=0;return d&&u?l-c:d?-1:1},l$=class extends H{constructor(){super(...arguments),this.beanName="colModel",this.pivotMode=!1,this.ready=!1,this.changeEventsDispatching=!1}postConstruct(){this.pivotMode=this.gos.get("pivotMode"),this.addManagedPropertyListeners(["groupDisplayType","treeData","treeDataDisplayType","groupHideOpenParents","rowNumbers","hidePaddedHeaderRows"],t=>this.refreshAll(sc(t.source))),this.addManagedPropertyListeners(["defaultColDef","defaultColGroupDef","columnTypes","suppressFieldDotNotation"],this.recreateColumnDefs.bind(this)),this.addManagedPropertyListener("pivotMode",t=>this.setPivotMode(this.gos.get("pivotMode"),sc(t.source)))}createColsFromColDefs(t){let{beans:e}=this,{valueCache:i,colAutosize:n,rowGroupColsSvc:r,pivotColsSvc:o,valueColsSvc:s,visibleCols:a,eventSvc:l,groupHierarchyColSvc:c}=e,d=this.colDefs?uM(e,t):void 0;i?.expire();let u=this.colDefCols?.list,h=this.colDefCols?.tree,p=Kq(e,this.colDefs,!0,h,t);Em(e,this.colDefCols?.tree,p.columnTree);let f=p.columnTree,g=p.treeDepth,m=rM(f),v={};for(let C of m)v[C.getId()]=C;this.colDefCols={tree:f,treeDepth:g,list:m,map:v},this.createColumnsForService([c],this.colDefCols,t),r?.extractCols(t,u),o?.extractCols(t,u),s?.extractCols(t,u),this.ready=!0,this.refreshCols(!0,t),a.refresh(t),l.dispatchEvent({type:"columnEverythingChanged",source:t}),d&&(this.changeEventsDispatching=!0,d(),this.changeEventsDispatching=!1),l.dispatchEvent({type:"newColumnsLoaded",source:t}),t==="gridInitializing"&&n?.applyAutosizeStrategy()}refreshCols(t,e){if(!this.colDefCols)return;let i=this.cols?.tree;this.saveColOrder();let{autoColSvc:n,selectionColSvc:r,rowNumbersSvc:o,quickFilter:s,pivotResultCols:a,showRowGroupCols:l,rowAutoHeight:c,visibleCols:d,colViewport:u,eventSvc:h}=this.beans,p=this.selectCols(a,this.colDefCols);this.createColumnsForService([n,r,o],p,e);let f=_q(this.gos,this.showingPivotResult);(!t||f)&&this.restoreColOrder(p),this.positionLockedCols(p),l?.refresh(),s?.refreshCols(),this.setColSpanActive(),c?.setAutoHeightActive(p),d.clear(),u.clear(),!xs(i,this.cols.tree)&&h.dispatchEvent({type:"gridColumnsChanged"})}createColumnsForService(t,e,i){for(let n of t)n&&(n.createColumns(e,r=>{this.lastOrder=r(this.lastOrder),this.lastPivotOrder=r(this.lastPivotOrder)},i),n.addColumns(e))}selectCols(t,e){let i=t?.getPivotResultCols()??null;this.showingPivotResult=i!=null;let{map:n,list:r,tree:o,treeDepth:s}=i??e;return this.cols={list:r.slice(),map:w({},n),tree:o.slice(),treeDepth:s},i&&(i.list.some(l=>this.cols?.map[l.getColId()]!==void 0)||(this.lastPivotOrder=null)),this.cols}getColsToShow(){if(!this.cols)return[];let{valueColsSvc:t,selectionColSvc:e,gos:i}=this.beans,n=this.isPivotMode()&&!this.showingPivotResult,r=e?.isSelectionColumnEnabled(),o=i.get("rowNumbers"),s=t?.columns;return this.cols.list.filter(l=>{let c=IS(l);if(n){let d=s?.includes(l);return c||d||r&&Po(l)||o&&wo(l)}else return c||l.isVisible()})}refreshAll(t){this.ready&&(this.refreshCols(!1,t),this.beans.visibleCols.refresh(t))}setColsVisible(t,e=!1,i){Zn(this.beans,{state:t.map(n=>({colId:typeof n=="string"?n:n.getColId(),hide:!e}))},i)}restoreColOrder(t){let e=this.showingPivotResult?this.lastPivotOrder:this.lastOrder;if(!e)return;let i=e.filter(u=>t.map[u.getId()]!=null);if(i.length===0)return;if(i.length===t.list.length){t.list=i;return}let n=u=>{let h=u.getOriginalParent();return h?h.getChildren().length>1?!0:n(h):!1};if(!i.some(u=>n(u))){let u=new Set(i);for(let h of t.list)u.has(h)||i.push(h);t.list=i;return}let r=new Map;for(let u=0;u<i.length;u++){let h=i[u];r.set(h,u)}let o=t.list.filter(u=>!r.has(u));if(o.length===0){t.list=i;return}let s=(u,h)=>{let p=h?h.getOriginalParent():u.getOriginalParent();if(!p)return null;let f=null,g=null;for(let m of p.getChildren())if(!(m===h||m===u)){if(m instanceof Aa){let v=r.get(m);if(v==null)continue;(f==null||f<v)&&(f=v,g=m);continue}m.forEachLeafColumn(v=>{let C=r.get(v);C!=null&&(f==null||f<C)&&(f=C,g=v)})}return g??s(u,p)},a=[],l=new Map;for(let u of o){let h=s(u,null);if(h==null){a.push(u);continue}let p=l.get(h);p===void 0?l.set(h,u):Array.isArray(p)?p.push(u):l.set(h,[p,u])}let c=new Array(t.list.length),d=c.length-1;for(let u=a.length-1;u>=0;u--)c[d--]=a[u];for(let u=i.length-1;u>=0;u--){let h=i[u],p=l.get(h);if(p)if(Array.isArray(p))for(let f=p.length-1;f>=0;f--){let g=p[f];c[d--]=g}else c[d--]=p;c[d--]=h}t.list=c}positionLockedCols(t){t.list=aM(t.list,this.gos)}saveColOrder(){this.showingPivotResult?this.lastPivotOrder=this.cols?.list??null:this.lastOrder=this.cols?.list??null}getColumnDefs(t){return this.colDefCols&&this.beans.colDefFactory?.getColumnDefs(this.colDefCols.list,this.showingPivotResult,this.lastOrder,this.cols?.list??[],t)}setColSpanActive(){this.colSpanActive=!!this.cols?.list.some(t=>t.getColDef().colSpan!=null)}isPivotMode(){return this.pivotMode}setPivotMode(t,e){if(t===this.pivotMode||(this.pivotMode=t,!this.ready))return;this.refreshCols(!1,e);let{visibleCols:i,eventSvc:n}=this.beans;i.refresh(e),n.dispatchEvent({type:"columnPivotModeChanged"})}isPivotActive(){let t=this.beans.pivotColsSvc?.columns;return this.pivotMode&&!!t?.length}recreateColumnDefs(t){if(!this.cols)return;this.beans.autoColSvc?.updateColumns(t);let e=sc(t.source);this.createColsFromColDefs(e)}setColumnDefs(t,e){this.colDefs=t,this.createColsFromColDefs(e)}destroy(){Em(this.beans,this.colDefCols?.tree),super.destroy()}getColTree(){return this.cols?.tree??[]}getColDefColTree(){return this.colDefCols?.tree??[]}getColDefCols(){return this.colDefCols?.list??null}getCols(){return this.cols?.list??[]}forAllCols(t){let{pivotResultCols:e,autoColSvc:i,selectionColSvc:n,groupHierarchyColSvc:r}=this.beans;zu(this.colDefCols?.list,t),zu(i?.columns?.list,t),zu(n?.columns?.list,t),zu(r?.columns?.list,t),zu(e?.getPivotResultCols()?.list,t)}getColsForKeys(t){return t?t.map(e=>this.getCol(e)).filter(e=>e!=null):[]}getColDefCol(t){return this.colDefCols?.list?this.getColFromCollection(t,this.colDefCols):null}getCol(t){return t==null?null:this.getColFromCollection(t,this.cols)}getColById(t){return this.cols?.map[t]??null}getColFromCollection(t,e){if(e==null)return null;let{map:i,list:n}=e;if(typeof t=="string"&&i[t])return i[t];for(let a=0;a<n.length;a++)if(Zu(n[a],t))return n[a];let{autoColSvc:r,selectionColSvc:o,groupHierarchyColSvc:s}=this.beans;return r?.getColumn(t)??o?.getColumn(t)??s?.getColumn(t)??null}};var pM=class{constructor(){this.existingIds={}}getInstanceIdForKey(t){let e=this.existingIds[t],i;return typeof e!="number"?i=0:i=e+1,this.existingIds[t]=i,i}};function wh(t,e,i){return i&&t.addDestroyFunc(()=>e.destroyBean(i)),i??t}var re=null;function sT(t){return typeof t?.getGui=="function"}var fM=class{constructor(t){this.cssClassStates={},this.getGui=t}toggleCss(t,e){if(!t)return;if(t.indexOf(" ")>=0){let n=(t||"").split(" ");if(n.length>1){for(let r of n)this.toggleCss(r,e);return}}this.cssClassStates[t]!==e&&t.length&&(this.getGui()?.classList.toggle(t,e),this.cssClassStates[t]=e)}},c$=0,bh=class extends Br{constructor(t,e){super(),this.suppressDataRefValidation=!1,this.displayed=!0,this.visible=!0,this.compId=c$++,this.cssManager=new fM(()=>this.eGui),this.componentSelectors=new Map((e??[]).map(i=>[i.selector,i])),t&&this.setTemplate(t)}preConstruct(){this.wireTemplate(this.getGui());let t="component-"+Object.getPrototypeOf(this)?.constructor?.name;for(let e of this.css??[])this.beans.environment.addGlobalCSS(e,t)}wireTemplate(t,e){t&&this.gos&&(this.applyElementsToComponent(t),this.createChildComponentsFromTags(t,e))}getCompId(){return this.compId}getDataRefAttribute(t){return t.getAttribute?t.getAttribute(TD):null}applyElementsToComponent(t,e,i,n=null){if(e===void 0&&(e=this.getDataRefAttribute(t)),e){let r=this[e];if(r===re)this[e]=n??t;else{let o=i?.[e];if(!this.suppressDataRefValidation&&!o)throw new Error(`data-ref: ${e} on ${this.constructor.name} with ${r}`)}}}createChildComponentsFromTags(t,e){let i=[];for(let n of t.childNodes??[])i.push(n);for(let n of i){if(!(n instanceof HTMLElement))continue;let r=this.createComponentFromElement(n,o=>{let s=o.getGui();if(s)for(let a of n.attributes??[])s.setAttribute(a.name,a.value)},e);if(r){if(r.addItems&&n.children.length){this.createChildComponentsFromTags(n,e);let o=Array.prototype.slice.call(n.children);r.addItems(o)}this.swapComponentForNode(r,t,n)}else n.childNodes&&this.createChildComponentsFromTags(n,e)}}createComponentFromElement(t,e,i){let n=t.nodeName,r=this.getDataRefAttribute(t),o=n.indexOf("AG-")===0,s=o?this.componentSelectors.get(n):null,a=null;if(s){let l=i&&r?i[r]:void 0;a=new s.component(l),a.setParentComponent(this),this.createBean(a,null,e)}else if(o)throw new Error(`selector: ${n}`);return this.applyElementsToComponent(t,r,i,a),a}swapComponentForNode(t,e,i){let n=t.getGui();e.replaceChild(n,i),e.insertBefore(document.createComment(i.nodeName),n),this.addDestroyFunc(this.destroyBean.bind(this,t))}activateTabIndex(t){let e=this.gos.get("tabIndex");t||(t=[]),t.length||t.push(this.getGui());for(let i of t)i.setAttribute("tabindex",e.toString())}setTemplate(t,e,i){let n;typeof t=="string"||t==null?n=ES(t):n=Ch(t),this.setTemplateFromElement(n,e,i)}setTemplateFromElement(t,e,i,n=!1){if(this.eGui=t,this.suppressDataRefValidation=n,e)for(let r=0;r<e.length;r++){let o=e[r];this.componentSelectors.set(o.selector,o)}this.wireTemplate(t,i)}getGui(){return this.eGui}getFocusableElement(){return this.eGui}getAriaElement(){return this.getFocusableElement()}setParentComponent(t){this.parentComponent=t}getParentComponent(){return this.parentComponent}setGui(t){this.eGui=t}queryForHtmlElement(t){return this.eGui.querySelector(t)}getContainerAndElement(t,e){let i=e;return t==null?null:(i||(i=this.eGui),_S(t)?{element:t,parent:i}:{element:t.getGui(),parent:i})}prependChild(t,e){let{element:i,parent:n}=this.getContainerAndElement(t,e)||{};!i||!n||n.insertAdjacentElement("afterbegin",i)}appendChild(t,e){let{element:i,parent:n}=this.getContainerAndElement(t,e)||{};!i||!n||n.appendChild(i)}isDisplayed(){return this.displayed}setVisible(t,e={}){if(t!==this.visible){this.visible=t;let{skipAriaHidden:i}=e;Uj(this.eGui,t,{skipAriaHidden:i})}}setDisplayed(t,e={}){if(t!==this.displayed){this.displayed=t;let{skipAriaHidden:i}=e;Ct(this.eGui,t,{skipAriaHidden:i});let n={type:"displayChanged",visible:this.displayed};this.dispatchLocalEvent(n)}}destroy(){this.parentComponent&&(this.parentComponent=void 0),super.destroy()}addGuiEventListener(t,e,i){this.eGui.addEventListener(t,e,i),this.addDestroyFunc(()=>this.eGui.removeEventListener(t,e))}addCss(t){this.cssManager.toggleCss(t,!0)}removeCss(t){this.cssManager.toggleCss(t,!1)}toggleCss(t,e){this.cssManager.toggleCss(t,e)}registerCSS(t){this.css||(this.css=[]),this.css.push(t)}},et=class extends bh{};function gM(t){return typeof t=="object"&&!!t.component}function d$(t,e){return new Et(i=>{i(window.setInterval(t,e))})}var Et=class $u{constructor(e){this.status=0,this.resolution=null,this.waiters=[],e(i=>this.onDone(i),i=>this.onReject(i))}static all(e){return e.length?new $u(i=>{let n=e.length,r=new Array(n);e.forEach((o,s)=>{o.then(a=>{r[s]=a,n--,n===0&&i(r)})})}):$u.resolve()}static resolve(e=null){return new $u(i=>i(e))}then(e){return new $u(i=>{this.status===1?i(e(this.resolution)):this.waiters.push(n=>i(e(n)))})}onDone(e){this.status=1,this.resolution=e;for(let i of this.waiters)i(e)}onReject(e){}};function u$(t){return t?t.prototype&&"getGui"in t.prototype:!1}function mM(t,e,i,n){let{name:r}=i,o,s,a,l,c,d;if(e){let u=e,h=u[r+"Selector"],p=h?h(n):null,f=g=>{typeof g=="string"?o=g:g!=null&&g!==!0&&(t.isFrameworkComponent(g)?a=g:s=g)};p?(f(p.component),l=p.params,c=p.popup,d=p.popupPosition):f(u[r])}return{compName:o,jsComp:s,fwComp:a,paramsFromSelector:l,popupFromSelector:c,popupPositionFromSelector:d}}var h$=class extends H{constructor(){super(...arguments),this.beanName="userCompFactory"}wireBeans(t){this.agCompUtils=t.agCompUtils,this.registry=t.registry,this.frameworkCompWrapper=t.frameworkCompWrapper,this.gridOptions=t.gridOptions}getCompDetailsFromGridOptions(t,e,i,n=!1){return this.getCompDetails(this.gridOptions,t,e,i,n)}getCompDetails(t,e,i,n,r=!1){let{name:o,cellRenderer:s}=e,{compName:a,jsComp:l,fwComp:c,paramsFromSelector:d,popupFromSelector:u,popupPositionFromSelector:h}=mM(this.beans.frameworkOverrides,t,e,n),p,f,g=b=>{let S=this.registry.getUserComponent(o,b);S&&(l=S.componentFromFramework?void 0:S.component,c=S.componentFromFramework?S.component:void 0,p=S.params,f=S.processParams)};if(a!=null&&g(a),l==null&&c==null&&i!=null&&g(i),l&&s&&!u$(l)&&(l=this.agCompUtils?.adaptFunction(e,l)),!l&&!c){let{validation:b}=this.beans;r&&(a!==i||!i)?a?b?.isProvidedUserComp(a)||at(50,{compName:a}):i?b||at(260,k(w({},this.gos.getModuleErrorParams()),{propName:o,compName:i})):at(216,{name:o}):i&&!b&&at(146,{comp:i});return}let m=this.mergeParams(t,e,n,d,p,f),v=l==null,C=l??c;return{componentFromFramework:v,componentClass:C,params:m,type:e,popupFromSelector:u,popupPositionFromSelector:h,newAgStackInstance:()=>this.newAgStackInstance(C,v,m,e)}}newAgStackInstance(t,e,i,n){let r=!e,o;r?o=new t:o=this.frameworkCompWrapper.wrap(t,n.mandatoryMethods,n.optionalMethods,n),this.createBean(o);let s=o.init?.(i);return s==null?Et.resolve(o):s.then(()=>o)}mergeParams(t,e,i,n=null,r,o){let s=w(w({},i),r),l=t?.[e.name+"Params"];if(typeof l=="function"){let c=l(i);Vi(s,c)}else typeof l=="object"&&Vi(s,l);return Vi(s,n),o?o(s):s}},p$={name:"dateComponent",mandatoryMethods:["getDate","setDate"],optionalMethods:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled","refresh"]},f$={name:"dragAndDropImageComponent",mandatoryMethods:["setIcon","setLabel"]},g$={name:"headerComponent",optionalMethods:["refresh"]},m$={name:"innerHeaderComponent"},v$={name:"innerHeaderGroupComponent"},C$={name:"headerGroupComponent"};var w$={name:"cellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0};var b$={name:"loadingCellRenderer",cellRenderer:!0},y$={name:"cellEditor",mandatoryMethods:["getValue"],optionalMethods:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached","refresh"]},S$={name:"loadingOverlayComponent",optionalMethods:["refresh"]},x$={name:"noRowsOverlayComponent",optionalMethods:["refresh"]},E$={name:"tooltipComponent"},AS={name:"filter",mandatoryMethods:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethods:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged","refresh"]},P$={name:"floatingFilterComponent",mandatoryMethods:["onParentModelChanged"],optionalMethods:["afterGuiAttached","refresh"]},R$={name:"fullWidthCellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0},_$={name:"loadingCellRenderer",cellRenderer:!0},k$={name:"groupRowRenderer",optionalMethods:["afterGuiAttached"],cellRenderer:!0},F$={name:"detailCellRenderer",optionalMethods:["refresh"],cellRenderer:!0};function T$(t,e){return t.getCompDetailsFromGridOptions(f$,"agDragAndDropImage",e,!0)}function D$(t,e,i){return t.getCompDetails(e,g$,"agColumnHeader",i)}function M$(t,e,i){return t.getCompDetails(e,m$,void 0,i)}function I$(t,e){let i=e.columnGroup.getColGroupDef();return t.getCompDetails(i,C$,"agColumnGroupHeader",e)}function A$(t,e,i){return t.getCompDetails(e,v$,void 0,i)}function O$(t,e){return t.getCompDetailsFromGridOptions(R$,void 0,e,!0)}function L$(t,e){return t.getCompDetailsFromGridOptions(_$,"agLoadingCellRenderer",e,!0)}function N$(t,e){return t.getCompDetailsFromGridOptions(k$,"agGroupRowRenderer",e,!0)}function B$(t,e){return t.getCompDetailsFromGridOptions(F$,"agDetailCellRenderer",e,!0)}function aT(t,e,i){return t.getCompDetails(e,w$,void 0,i)}function lT(t,e,i){return t.getCompDetails(e,b$,"agSkeletonCellRenderer",i,!0)}function vM(t,e,i){return t.getCompDetails(e,y$,"agCellEditor",i,!0)}function H$(t,e,i,n){let r=e.filter;return gM(r)&&(e={filter:r.component,filterParams:e.filterParams}),t.getCompDetails(e,AS,n,i,!0)}function z$(t,e,i){return t.getCompDetails(e,p$,"agDateInput",i,!0)}function V$(t,e){return t.getCompDetailsFromGridOptions(S$,"agLoadingOverlay",e,!0)}function G$(t,e){return t.getCompDetailsFromGridOptions(x$,"agNoRowsOverlay",e,!0)}function W$(t,e){return t.getCompDetails(e.colDef,E$,"agTooltipComponent",e,!0)}function U$(t,e,i,n){return t.getCompDetails(e,P$,n,i)}function CM(t,e){return mM(t,e,AS)}function cy(t,e,i){return t.mergeParams(e,AS,i)}function hh(t){let e=t;return e?.getFrameworkComponentInstance!=null?e.getFrameworkComponentInstance():t}function j$(t){return typeof t=="object"&&!!t.getComp}var A={BACKSPACE:"Backspace",TAB:"Tab",ENTER:"Enter",ESCAPE:"Escape",SPACE:" ",LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown",DELETE:"Delete",F2:"F2",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",PAGE_HOME:"Home",PAGE_END:"End",A:"KeyA",C:"KeyC",D:"KeyD",V:"KeyV",X:"KeyX",Y:"KeyY",Z:"KeyZ"},OS=class extends bh{isPopup(){return!0}setParentComponent(t){t.addCss("ag-has-popup"),super.setParentComponent(t)}destroy(){let t=this.parentComponent;t?.isAlive()&&t.getGui().classList.remove("ag-has-popup"),super.destroy()}},dy,uy,hy,py,Xy,Jy,fy;function Es(){return dy===void 0&&(dy=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),dy}function wM(){return uy===void 0&&(uy=/(firefox)/i.test(navigator.userAgent)),uy}function bM(){return hy===void 0&&(hy=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),hy}function Pa(){return py===void 0&&(py=/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1),py}function Qy(t){if(!t)return null;let e=t.tabIndex,i=t.getAttribute("tabIndex");return e===-1&&(i===null||i===""&&!wM())?null:e.toString()}function q$(){if(fy!==void 0)return fy;if(!document.body)return-1;let t=1e6,e=wM()?6e6:1e9,i=document.createElement("div");for(document.body.appendChild(i);;){let n=t*2;if(i.style.height=n+"px",n>e||i.clientHeight!==n)break;t=n}return i.remove(),fy=t,t}function $$(){return Jy==null&&yM(),Jy}function yM(){let t=document.body,e=document.createElement("div");e.style.width=e.style.height="100px",e.style.opacity="0",e.style.overflow="scroll",e.style.msOverflowStyle="scrollbar",e.style.position="absolute",t.appendChild(e);let i=e.offsetWidth-e.clientWidth;i===0&&e.clientWidth===0&&(i=null),e.parentNode&&e.remove(),i!=null&&(Jy=i,Xy=i===0)}function SM(){return Xy==null&&yM(),Xy}var LS="T",K$=new RegExp(`[${LS} ]`),Y$=new RegExp(`^\\d{4}-\\d{2}-\\d{2}(${LS}\\d{2}:\\d{2}:\\d{2}\\D?)?`);function Mr(t,e){return t.toString().padStart(e,"0")}function un(t,e=!0,i=LS){if(!t)return null;let n=[t.getFullYear(),t.getMonth()+1,t.getDate()].map(r=>Mr(r,2)).join("-");return e&&(n+=i+[t.getHours(),t.getMinutes(),t.getSeconds()].map(r=>Mr(r,2)).join(":")),n}function jg(t,e=!0){return t?e?[String(t.getFullYear()),String(t.getMonth()+1),Mr(t.getDate(),2),Mr(t.getHours(),2),`:${Mr(t.getMinutes(),2)}`,`:${Mr(t.getSeconds(),2)}`]:[t.getFullYear(),t.getMonth()+1,Mr(t.getDate(),2)].map(String):null}var gy=t=>{if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"},cT=["January","February","March","April","May","June","July","August","September","October","November","December"],my=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function Zy(t,e){if(e==null)return un(t,!1);let i=Mr(t.getFullYear(),4),n={YYYY:()=>i.slice(i.length-4,i.length),YY:()=>i.slice(i.length-2,i.length),Y:()=>`${t.getFullYear()}`,MMMM:()=>cT[t.getMonth()],MMM:()=>cT[t.getMonth()].slice(0,3),MM:()=>Mr(t.getMonth()+1,2),Mo:()=>`${t.getMonth()+1}${gy(t.getMonth()+1)}`,M:()=>`${t.getMonth()+1}`,Do:()=>`${t.getDate()}${gy(t.getDate())}`,DD:()=>Mr(t.getDate(),2),D:()=>`${t.getDate()}`,dddd:()=>my[t.getDay()],ddd:()=>my[t.getDay()].slice(0,3),dd:()=>my[t.getDay()].slice(0,2),do:()=>`${t.getDay()}${gy(t.getDay())}`,d:()=>`${t.getDay()}`},r=new RegExp(Object.keys(n).join("|"),"g");return e.replace(r,o=>o in n?n[o]():o)}function am(t,e=!1){return!!Ji(t,e)}function X$(t){return am(t,!0)}function Ji(t,e=!1,i){if(!t||!i&&!Y$.test(t))return null;let[n,r]=t.split(K$);if(!n)return null;let o=n.split("-").map(p=>Number.parseInt(p,10));if(o.filter(p=>!isNaN(p)).length!==3)return null;let[s,a,l]=o,c=new Date(s,a-1,l);if(c.getFullYear()!==s||c.getMonth()!==a-1||c.getDate()!==l||!r&&e)return null;if(!r||r==="00:00:00")return c;let[d,u,h]=r.split(":").map(p=>Number.parseInt(p,10));if(d>=0&&d<24)c.setHours(d);else if(e)return null;if(u>=0&&u<60)c.setMinutes(u);else if(e)return null;if(h>=0&&h<60)c.setSeconds(h);else if(e)return null;return c}function eS(t){let{inputValue:e,allSuggestions:i,hideIrrelevant:n,filterByPercentageOfBestMatch:r}=t,o=(i??[]).map((l,c)=>({value:l,relevance:J$(e,l),idx:c}));if(o.sort((l,c)=>l.relevance-c.relevance),n&&(o=o.filter(l=>l.relevance<Math.max(l.value.length,e.length))),o.length>0&&r&&r>0){let c=o[0].relevance*r;o=o.filter(d=>c-d.relevance<0)}let s=[],a=[];for(let l of o)s.push(l.value),a.push(l.idx);return{values:s,indices:a}}function J$(t,e){t.length<e.length&&([t,e]=[e,t]);let i=[],n=[],r=t.length,o=e.length;for(let a=0;a<=o;a++)i[a]=a;let s=0;for(let a=1;a<=r;a++){n[0]=a;for(let l=1;l<=o;l++){let c=t[a-1],d=e[l-1];if(c.toLocaleLowerCase()===d.toLocaleLowerCase())++s,c===d&&++s,a>1&&l>1&&t[a-2].toLocaleLowerCase()===e[l-2].toLocaleLowerCase()&&(++s,t[a-2]===e[l-2]&&++s),a<r/2-10&&++s,n[l]=i[l-1];else{let u=n[l-1],h=i[l],p=i[l-1];n[l]=1+Math.min(u,h,p)}}[i,n]=[n,i]}return i[o]/(s+1)}function xM(t){return t.altKey||t.ctrlKey||t.metaKey?!1:t.key?.length===1}var tS=!1,_m=0;function Q$(t){_m>0||(t.addEventListener("keydown",km),t.addEventListener("mousedown",km))}function Z$(t){_m>0||(t.removeEventListener("keydown",km),t.removeEventListener("mousedown",km))}function km(t){let e=tS,i=t.type==="keydown";i&&(t.ctrlKey||t.metaKey||t.altKey)||e!==i&&(tS=i)}function eK(t){let e=ri(t);return Q$(e),_m++,()=>{_m--,Z$(e)}}function tK(){return tS}function ac(t,e,i=!1){let n=Wj,r=xD;e&&(r+=", "+e),i&&(r+=', [tabindex="-1"]');let o=Array.prototype.slice.apply(t.querySelectorAll(n)).filter(l=>Nr(l)),s=Array.prototype.slice.apply(t.querySelectorAll(r));return s.length?((l,c)=>l.filter(d=>c.indexOf(d)===-1))(o,s):o}function Ta(t,e=!1,i=!1,n=!1){let r=ac(t,n?".ag-tab-guard":null,i),o=e?dt(r):r[0];return o?(o.focus({preventScroll:!0}),!0):!1}function Oa(t,e,i,n){let r=ac(e,i?':not([tabindex="-1"])':null),o=St(t),s;i?s=r.findIndex(l=>l.contains(o)):s=r.indexOf(o);let a=s+(n?-1:1);return a<0||a>=r.length?null:r[a]}function EM(t,e=5){let i=0;for(;t&&Qy(t)===null&&++i<=e;)t=t.parentElement;return Qy(t)===null?null:t}var iK=".ag-label{white-space:nowrap}:where(.ag-ltr) .ag-label{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-label-align-right) .ag-label{order:1}:where(.ag-ltr) :where(.ag-label-align-right) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-rtl) :where(.ag-label-align-right) .ag-label{margin-right:var(--ag-spacing)}.ag-label-align-right>*{flex:none}.ag-label-align-top{align-items:flex-start;flex-direction:column;>*{align-self:stretch}}.ag-label-ellipsis{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:where(.ag-label-align-top) .ag-label{margin-bottom:calc(var(--ag-spacing)*.5)}",nK=class extends bh{constructor(t,e,i){super(e,i),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=t||{},this.registerCSS(iK)}postConstruct(){this.addCss("ag-labeled"),this.eLabel.classList.add("ag-label");let{labelSeparator:t,label:e,labelWidth:i,labelAlignment:n,disabled:r}=this.config;r!=null&&this.setDisabled(r),t!=null&&this.setLabelSeparator(t),e!=null&&this.setLabel(e),i!=null&&this.setLabelWidth(i),this.setLabelAlignment(n||this.labelAlignment),this.refreshLabel()}refreshLabel(){let{label:t,eLabel:e}=this;hi(e),typeof t=="string"?e.innerText=t+this.labelSeparator:t&&e.appendChild(t),t===""?(Ct(e,!1),vs(e,"presentation")):(Ct(e,!0),vs(e,null))}setLabelSeparator(t){return this.labelSeparator===t?this:(this.labelSeparator=t,this.label!=null&&this.refreshLabel(),this)}getLabelId(){let t=this.eLabel;return t.id=t.id||`ag-${this.getCompId()}-label`,t.id}getLabel(){return this.label}setLabel(t){return this.label===t?this:(this.label=t,this.refreshLabel(),this)}setLabelAlignment(t){let i=this.getGui().classList;return i.toggle("ag-label-align-left",t==="left"),i.toggle("ag-label-align-right",t==="right"),i.toggle("ag-label-align-top",t==="top"),this}setLabelEllipsis(t){return this.eLabel.classList.toggle("ag-label-ellipsis",t),this}setLabelWidth(t){return this.label==null?this:(Cm(this.eLabel,t),this)}setDisabled(t){t=!!t;let e=this.getGui();return sh(e,t),e.classList.toggle("ag-disabled",t),this.disabled=t,this}isDisabled(){return!!this.disabled}},PM=class extends nK{constructor(t,e,i,n){super(t,e,i),this.className=n}postConstruct(){super.postConstruct();let{width:t,value:e,onValueChange:i}=this.config;t!=null&&this.setWidth(t),e!=null&&this.setValue(e),i!=null&&this.onValueChange(i),this.className&&this.addCss(this.className),this.refreshAriaLabelledBy()}setLabel(t){return super.setLabel(t),this.refreshAriaLabelledBy(),this}refreshAriaLabelledBy(){let t=this.getAriaElement(),e=this.getLabelId(),i=this.getLabel();i==null||i==""||_j(t)!==null?oh(t,""):oh(t,e??"")}setAriaLabel(t){return hc(this.getAriaElement(),t),this.refreshAriaLabelledBy(),this}onValueChange(t){return this.addManagedListeners(this,{fieldValueChanged:()=>t(this.getValue())}),this}getWidth(){return this.getGui().clientWidth}setWidth(t){return Ar(this.getGui(),t),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(t,e){return this.value===t?this:(this.previousValue=this.value,this.value=t,e||this.dispatchLocalEvent({type:"fieldValueChanged"}),this)}};function rK(t){return{tag:"div",role:"presentation",children:[{tag:"div",ref:"eLabel",cls:"ag-input-field-label"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-input-wrapper",role:"presentation",children:[{tag:t,ref:"eInput",cls:"ag-input-field-input"}]}]}}var ba=class extends PM{constructor(t,e,i="text",n="input"){super(t,t?.template??rK(n),[],e),this.inputType=i,this.displayFieldTag=n,this.eLabel=re,this.eWrapper=re,this.eInput=re}postConstruct(){super.postConstruct(),this.setInputType(this.inputType);let{eLabel:t,eWrapper:e,eInput:i,className:n}=this;t.classList.add(`${n}-label`),e.classList.add(`${n}-input-wrapper`),i.classList.add(`${n}-input`),this.addCss("ag-input-field"),i.id=i.id||`ag-${this.getCompId()}-input`;let{inputName:r,inputWidth:o}=this.config;r!=null&&this.setInputName(r),o!=null&&this.setInputWidth(o),this.addInputListeners(),this.activateTabIndex([i])}addInputListeners(){this.addManagedElementListeners(this.eInput,{input:t=>this.setValue(t.target.value)})}setInputType(t){this.displayFieldTag==="input"&&(this.inputType=t,cn(this.eInput,"type",t))}getInputElement(){return this.eInput}setInputWidth(t){return Cm(this.eWrapper,t),this}setInputName(t){return this.getInputElement().setAttribute("name",t),this}getFocusableElement(){return this.eInput}setMaxLength(t){let e=this.eInput;return e.maxLength=t,this}setInputPlaceholder(t){return cn(this.eInput,"placeholder",t),this}setInputAriaLabel(t){return hc(this.eInput,t),this.refreshAriaLabelledBy(),this}setDisabled(t){return sh(this.eInput,t),super.setDisabled(t)}setAutoComplete(t){if(t===!0)cn(this.eInput,"autocomplete",null);else{let e=typeof t=="string"?t:"off";cn(this.eInput,"autocomplete",e)}return this}},NS=class extends ba{constructor(t,e="ag-checkbox",i="checkbox"){super(t,e,i),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}postConstruct(){super.postConstruct();let{readOnly:t,passive:e}=this.config;typeof t=="boolean"&&this.setReadOnly(t),typeof e=="boolean"&&this.setPassive(e)}addInputListeners(){this.addManagedElementListeners(this.eInput,{click:this.onCheckboxClick.bind(this)}),this.addManagedElementListeners(this.eLabel,{click:this.toggle.bind(this)})}getNextValue(){return this.selected===void 0?!0:!this.selected}setPassive(t){this.passive=t}isReadOnly(){return this.readOnly}setReadOnly(t){this.eWrapper.classList.toggle("ag-disabled",t),this.eInput.disabled=t,this.readOnly=t}setDisabled(t){return this.eWrapper.classList.toggle("ag-disabled",t),super.setDisabled(t)}toggle(){if(this.eInput.disabled)return;let t=this.isSelected(),e=this.getNextValue();this.passive?this.dispatchChange(e,t):this.setValue(e)}getValue(){return this.isSelected()}setValue(t,e){return this.refreshSelectedClass(t),this.setSelected(t,e),this}setName(t){let e=this.getInputElement();return e.name=t,this}isSelected(){return this.selected}setSelected(t,e){if(this.isSelected()===t)return;this.previousValue=this.isSelected(),t=this.selected=typeof t=="boolean"?t:void 0;let i=this.eInput;i.checked=t,i.indeterminate=t===void 0,e||this.dispatchChange(this.selected,this.previousValue)}dispatchChange(t,e,i){this.dispatchLocalEvent({type:"fieldValueChanged",selected:t,previousValue:e,event:i});let n=this.getInputElement();this.eventSvc.dispatchEvent({type:"checkboxChanged",id:n.id,name:n.name,selected:t,previousValue:e})}onCheckboxClick(t){if(this.passive||this.eInput.disabled)return;let e=this.isSelected(),i=this.selected=t.target.checked;this.refreshSelectedClass(i),this.dispatchChange(i,e,t)}refreshSelectedClass(t){let e=this.eWrapper.classList;e.toggle("ag-checked",t===!0),e.toggle("ag-indeterminate",t==null)}},BS={selector:"AG-CHECKBOX",component:NS},oK=class extends NS{constructor(t){super(t,"ag-radio-button","radio")}isSelected(){return this.eInput.checked}toggle(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}addInputListeners(){super.addInputListeners(),this.addManagedEventListeners({checkboxChanged:this.onChange.bind(this)})}onChange(t){let e=this.eInput;t.selected&&t.name&&e.name&&e.name===t.name&&t.id&&e.id!==t.id&&this.setValue(!1,!0)}};var La=class extends ba{constructor(t,e="ag-text-field",i="text"){super(t,e,i)}postConstruct(){super.postConstruct(),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}setValue(t,e){let i=this.eInput;return i.value!==t&&(i.value=ae(t)?t:""),super.setValue(t,e)}setStartValue(t){this.setValue(t,!0)}preventDisallowedCharacters(){let t=new RegExp(`[${this.config.allowedCharPattern}]`),e=i=>{xM(i)&&i.key&&!t.test(i.key)&&i.preventDefault()};this.addManagedListeners(this.eInput,{keydown:e,paste:i=>{i.clipboardData?.getData("text")?.split("").some(r=>!t.test(r))&&i.preventDefault()}})}},zm={selector:"AG-INPUT-TEXT-FIELD",component:La},sK=class extends ba{constructor(t){super(t,"ag-text-area",null,"textarea")}setValue(t,e){let i=super.setValue(t,e);return this.eInput.value=t,i}setCols(t){return this.eInput.cols=t,this}setRows(t){return this.eInput.rows=t,this}},aK={selector:"AG-INPUT-TEXT-AREA",component:sK},HS=class extends La{constructor(t){super(t,"ag-number-field","number")}postConstruct(){super.postConstruct();let t=this.eInput;this.addManagedListeners(t,{blur:()=>{let o=Number.parseFloat(t.value),s=isNaN(o)?"":this.normalizeValue(o.toString());this.value!==s&&this.setValue(s)},wheel:this.onWheel.bind(this)}),t.step="any";let{precision:e,min:i,max:n,step:r}=this.config;typeof e=="number"&&this.setPrecision(e),typeof i=="number"&&this.setMin(i),typeof n=="number"&&this.setMax(n),typeof r=="number"&&this.setStep(r)}onWheel(t){St(this.beans)===this.eInput&&t.preventDefault()}normalizeValue(t){return t===""?"":(this.precision!=null&&(t=this.adjustPrecision(t)),t)}adjustPrecision(t,e){let i=this.precision;if(i==null)return t;if(e){let r=Number.parseFloat(t).toFixed(i);return Number.parseFloat(r).toString()}let n=String(t).split(".");if(n.length>1){if(n[1].length<=i)return t;if(i>0)return`${n[0]}.${n[1].slice(0,i)}`}return n[0]}setMin(t){return this.min===t?this:(this.min=t,cn(this.eInput,"min",t),this)}setMax(t){return this.max===t?this:(this.max=t,cn(this.eInput,"max",t),this)}setPrecision(t){return this.precision=t,this}setStep(t){return this.step===t?this:(this.step=t,cn(this.eInput,"step",t),this)}setValue(t,e){return this.setValueOrInputValue(i=>super.setValue(i,e),()=>this,t)}setStartValue(t){return this.setValueOrInputValue(e=>super.setValue(e,!0),e=>{this.eInput.value=e},t)}setValueOrInputValue(t,e,i){if(ae(i)){let n=this.isScientificNotation(i);if(n&&this.eInput.validity.valid)return t(i);if(!n){i=this.adjustPrecision(i);let r=this.normalizeValue(i);n=i!=r}if(n)return e(i)}return t(i)}getValue(){let t=this.eInput;if(!t.validity.valid)return;let e=t.value;return this.isScientificNotation(e)?this.adjustPrecision(e,!0):super.getValue()}isScientificNotation(t){return typeof t=="string"&&t.includes("e")}},lK={selector:"AG-INPUT-NUMBER-FIELD",component:HS},cK=class extends La{constructor(t){super(t,"ag-date-field","date")}postConstruct(){super.postConstruct();let t=Es();this.addManagedListeners(this.eInput,{wheel:this.onWheel.bind(this),mousedown:()=>{this.isDisabled()||t||this.eInput.focus()}}),this.eInput.step="any"}onWheel(t){St(this.beans)===this.eInput&&t.preventDefault()}setMin(t){let e=t instanceof Date?un(t??null,!!this.includeTime)??void 0:t;return this.min===e?this:(this.min=e,cn(this.eInput,"min",e),this)}setMax(t){let e=t instanceof Date?un(t??null,!!this.includeTime)??void 0:t;return this.max===e?this:(this.max=e,cn(this.eInput,"max",e),this)}setStep(t){return this.step===t?this:(this.step=t,cn(this.eInput,"step",t),this)}setIncludeTime(t){return this.includeTime===t?this:(this.includeTime=t,super.setInputType(t?"datetime-local":"date"),t&&this.setStep(1),this)}getDate(){if(this.eInput.validity.valid)return Ji(this.getValue())??void 0}setDate(t,e){this.setValue(un(t??null,this.includeTime),e)}},RM={selector:"AG-INPUT-DATE-FIELD",component:cK},dK=".ag-list-item{align-items:center;display:flex;height:var(--ag-list-item-height);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;&.ag-active-item{background-color:var(--ag-row-hover-color)}}",uK="ag-active-item",hK=(t,e)=>({tag:"div",cls:`ag-list-item ag-${t}-list-item`,attrs:{role:"option"},children:[{tag:"span",ref:"eText",children:e}]}),pK=class extends bh{constructor(t,e,i){super(hK(t,e)),this.label=e,this.value=i,this.eText=re}postConstruct(){this.createTooltip(),this.addEventListeners()}setHighlighted(t){let e=this.getGui();e.classList.toggle(uK,t),SD(e,t),this.dispatchLocalEvent({type:"itemHighlighted",highlighted:t})}getHeight(){return this.getGui().clientHeight}setIndex(t,e){let i=this.getGui();Ij(i,t),Mj(i,e)}createTooltip(){let t={getTooltipValue:()=>this.label,getGui:()=>this.getGui(),getLocation:()=>"UNKNOWN",shouldDisplayTooltip:()=>PS(this.eText)},e=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("highlightTooltipFeature",!1,t,this));e&&(this.tooltipFeature=e)}addEventListeners(){let t=this.getParentComponent();t&&(this.addGuiEventListener("mouseover",()=>{t.highlightItem(this)}),this.addGuiEventListener("mousedown",e=>{e.preventDefault(),e.stopPropagation(),t.setValue(this.value)}))}},fK=class extends bh{constructor(t="default"){super({tag:"div",cls:`ag-list ag-${t}-list`}),this.cssIdentifier=t,this.options=[],this.listItems=[],this.highlightedItem=null,this.registerCSS(dK)}postConstruct(){let t=this.getGui();this.addManagedElementListeners(t,{mouseleave:()=>this.clearHighlighted()})}handleKeyDown(t){let e=t.key;switch(e){case A.ENTER:if(!this.highlightedItem)this.setValue(this.getValue());else{let i=this.listItems.indexOf(this.highlightedItem);this.setValueByIndex(i)}break;case A.DOWN:case A.UP:t.preventDefault(),this.navigate(e);break;case A.PAGE_DOWN:case A.PAGE_UP:case A.PAGE_HOME:case A.PAGE_END:t.preventDefault(),this.navigateToPage(e);break}}addOptions(t){for(let e of t)this.addOption(e);return this}addOption(t){let{value:e,text:i}=t,n=i??e;return this.options.push({value:e,text:n}),this.renderOption(e,n),this.updateIndices(),this}clearOptions(){this.options=[],this.reset(!0);for(let t of this.listItems)t.destroy();hi(this.getGui()),this.listItems=[],this.refreshAriaRole()}setValue(t,e){if(this.value===t)return this.fireItemSelected(),this;if(t==null)return this.reset(e),this;let i=this.options.findIndex(n=>n.value===t);if(i!==-1){let n=this.options[i];this.value=n.value,this.displayValue=n.text,this.highlightItem(this.listItems[i]),e||this.fireChangeEvent()}return this}setValueByIndex(t){return this.setValue(this.options[t].value)}getValue(){return this.value}getDisplayValue(){return this.displayValue}refreshHighlighted(){this.clearHighlighted();let t=this.options.findIndex(e=>e.value===this.value);t!==-1&&this.highlightItem(this.listItems[t])}highlightItem(t){let e=t.getGui();if(!Nr(e))return;this.clearHighlighted(),t.setHighlighted(!0),this.highlightedItem=t;let i=this.getGui(),{scrollTop:n,clientHeight:r}=i,{offsetTop:o,offsetHeight:s}=e;(o+s>n+r||o<n)&&e.scrollIntoView({block:"nearest"})}hideItemTooltip(){this.highlightedItem?.tooltipFeature?.attemptToHideTooltip()}destroy(){this.hideItemTooltip(),super.destroy()}reset(t){this.value=null,this.displayValue=null,this.clearHighlighted(),t||this.fireChangeEvent()}clearHighlighted(){this.highlightedItem?.setHighlighted(!1),this.highlightedItem=null}renderOption(t,e){let i=new pK(this.cssIdentifier,e,t);i.setParentComponent(this);let n=this.createManagedBean(i);this.listItems.push(n),this.getGui().appendChild(n.getGui())}navigate(t){let e=t===A.DOWN,i,{listItems:n,highlightedItem:r}=this;if(!r)i=e?n[0]:dt(n);else{let s=n.indexOf(r)+(e?1:-1);s=Math.min(Math.max(s,0),n.length-1),i=n[s]}this.highlightItem(i)}navigateToPage(t){let{listItems:e,highlightedItem:i}=this;if(!i||e.length===0)return;let n=e.indexOf(i),r=this.options.length-1,o=e[0].getHeight(),s=Math.floor(this.getGui().clientHeight/o),a=-1;t===A.PAGE_HOME?a=0:t===A.PAGE_END?a=r:t===A.PAGE_DOWN?a=Math.min(n+s,r):t===A.PAGE_UP&&(a=Math.max(n-s,0)),a!==-1&&this.highlightItem(e[a])}refreshAriaRole(){vs(this.getGui(),this.options.length===0?"presentation":"listbox")}updateIndices(){this.refreshAriaRole();let t=this.listItems,e=t.length;t.forEach((i,n)=>{i.setIndex(n+1,e)})}fireChangeEvent(){this.dispatchLocalEvent({type:"fieldValueChanged"}),this.fireItemSelected()}fireItemSelected(){this.dispatchLocalEvent({type:"selectedItem"})}},gK=".ag-picker-field-display{flex:1 1 auto}.ag-picker-field{align-items:center;display:flex}.ag-picker-field-icon{border:0;cursor:pointer;display:flex;margin:0;padding:0}.ag-picker-field-wrapper{background-color:var(--ag-picker-button-background-color);border:var(--ag-picker-button-border);border-radius:5px;min-height:max(var(--ag-list-item-height),calc(var(--ag-spacing)*4));overflow:hidden;&:where(.ag-picker-has-focus),&:where(:focus-within){background-color:var(--ag-picker-button-focus-background-color);border:var(--ag-picker-button-focus-border);box-shadow:var(--ag-focus-shadow);&:where(.invalid){box-shadow:var(--ag-focus-error-shadow)}}&:where(.invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&:disabled{opacity:.5}}",mK={tag:"div",cls:"ag-picker-field",role:"presentation",children:[{tag:"div",ref:"eLabel"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-picker-field-wrapper ag-picker-collapsed",children:[{tag:"div",ref:"eDisplayField",cls:"ag-picker-field-display"},{tag:"div",ref:"eIcon",cls:"ag-picker-field-icon",attrs:{"aria-hidden":"true"}}]}]},vK=class extends PM{constructor(t){if(super(t,t?.template||mK,t?.agComponents||[],t?.className),this.isPickerDisplayed=!1,this.skipClick=!1,this.pickerGap=4,this.hideCurrentPicker=null,this.eLabel=re,this.eWrapper=re,this.eDisplayField=re,this.eIcon=re,this.registerCSS(gK),this.ariaRole=t?.ariaRole,this.onPickerFocusIn=this.onPickerFocusIn.bind(this),this.onPickerFocusOut=this.onPickerFocusOut.bind(this),!t)return;let{pickerGap:e,maxPickerHeight:i,variableWidth:n,minPickerWidth:r,maxPickerWidth:o}=t;e!=null&&(this.pickerGap=e),this.variableWidth=!!n,i!=null&&this.setPickerMaxHeight(i),r!=null&&this.setPickerMinWidth(r),o!=null&&this.setPickerMaxWidth(o)}postConstruct(){super.postConstruct(),this.setupAria();let t=`ag-${this.getCompId()}-display`;this.eDisplayField.setAttribute("id",t);let e=this.getAriaElement();this.addManagedElementListeners(e,{keydown:this.onKeyDown.bind(this)}),this.addManagedElementListeners(this.eLabel,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)}),this.addManagedElementListeners(this.eWrapper,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)});let{pickerIcon:i,inputWidth:n}=this.config;if(i){let r=this.beans.iconSvc.createIconNoSpan(i);r&&this.eIcon.appendChild(r)}n!=null&&this.setInputWidth(n)}setupAria(){let t=this.getAriaElement();t.setAttribute("tabindex",this.gos.get("tabIndex").toString()),Gy(t,!1),this.ariaRole&&vs(t,this.ariaRole)}onLabelOrWrapperMouseDown(t){if(t){let e=this.getFocusableElement();if(e!==this.eWrapper&&t?.target===e)return;t.preventDefault(),this.getFocusableElement().focus()}if(this.skipClick){this.skipClick=!1;return}this.isDisabled()||(this.isPickerDisplayed?this.hidePicker():this.showPicker())}onKeyDown(t){switch(t.key){case A.UP:case A.DOWN:case A.ENTER:case A.SPACE:t.preventDefault(),this.onLabelOrWrapperMouseDown();break;case A.ESCAPE:this.isPickerDisplayed&&(t.preventDefault(),t.stopPropagation(),this.hideCurrentPicker&&this.hideCurrentPicker());break}}showPicker(){this.isPickerDisplayed=!0,this.pickerComponent||(this.pickerComponent=this.createPickerComponent());let t=this.pickerComponent.getGui();t.addEventListener("focusin",this.onPickerFocusIn),t.addEventListener("focusout",this.onPickerFocusOut),this.hideCurrentPicker=this.renderAndPositionPicker(),this.toggleExpandedStyles(!0)}renderAndPositionPicker(){let t=this.pickerComponent.getGui();this.gos.get("suppressScrollWhenPopupsAreOpen")||([this.destroyMouseWheelFunc]=this.addManagedEventListeners({bodyScroll:()=>{this.hidePicker()}}));let e=this.getLocaleTextFunc(),{config:{pickerAriaLabelKey:i,pickerAriaLabelValue:n,modalPicker:r=!0},maxPickerHeight:o,minPickerWidth:s,maxPickerWidth:a,variableWidth:l,beans:c,eWrapper:d}=this,u={modal:r,eChild:t,closeOnEsc:!0,closedCallback:()=>{let g=gD(c);this.beforeHidePicker(),g&&this.isAlive()&&this.getFocusableElement().focus()},ariaLabel:e(i,n),anchorToElement:d};t.style.position="absolute";let h=c.popupSvc,p=h.addPopup(u);l?(s&&(t.style.minWidth=s),t.style.width=RS(gm(d)),a&&(t.style.maxWidth=a)):Cm(t,a??gm(d));let f=o??`${xS(h.getPopupParent())}px`;return t.style.setProperty("max-height",f),this.alignPickerToComponent(),p.hideFunc}alignPickerToComponent(){if(!this.pickerComponent)return;let{pickerGap:t,config:{pickerType:e},beans:{popupSvc:i,gos:n},eWrapper:r,pickerComponent:o}=this,s=n.get("enableRtl")?"right":"left";i.positionPopupByComponent({type:e,eventSource:r,ePopup:o.getGui(),position:"under",alignSide:s,keepWithinBounds:!0,nudgeY:t})}beforeHidePicker(){this.destroyMouseWheelFunc&&(this.destroyMouseWheelFunc(),this.destroyMouseWheelFunc=void 0),this.toggleExpandedStyles(!1);let t=this.pickerComponent.getGui();t.removeEventListener("focusin",this.onPickerFocusIn),t.removeEventListener("focusout",this.onPickerFocusOut),this.isPickerDisplayed=!1,this.pickerComponent=void 0,this.hideCurrentPicker=null}toggleExpandedStyles(t){if(!this.isAlive())return;let e=this.getAriaElement();Gy(e,t);let i=this.eWrapper.classList;i.toggle("ag-picker-expanded",t),i.toggle("ag-picker-collapsed",!t)}onPickerFocusIn(){this.togglePickerHasFocus(!0)}onPickerFocusOut(t){this.pickerComponent?.getGui().contains(t.relatedTarget)||this.togglePickerHasFocus(!1)}togglePickerHasFocus(t){this.pickerComponent&&this.eWrapper.classList.toggle("ag-picker-has-focus",t)}hidePicker(){this.hideCurrentPicker&&(this.hideCurrentPicker(),this.dispatchLocalEvent({type:"pickerHidden"}))}setInputWidth(t){return Cm(this.eWrapper,t),this}getFocusableElement(){return this.eWrapper}setPickerGap(t){return this.pickerGap=t,this}setPickerMinWidth(t){return typeof t=="number"&&(t=`${t}px`),this.minPickerWidth=t??void 0,this}setPickerMaxWidth(t){return typeof t=="number"&&(t=`${t}px`),this.maxPickerWidth=t??void 0,this}setPickerMaxHeight(t){return typeof t=="number"&&(t=`${t}px`),this.maxPickerHeight=t??void 0,this}destroy(){this.hidePicker(),super.destroy()}},CK=".ag-select{align-items:center;display:flex;&.ag-disabled{opacity:.5}}:where(.ag-select){.ag-picker-field-wrapper{cursor:default}&.ag-disabled .ag-picker-field-wrapper:focus{box-shadow:none}&:not(.ag-cell-editor,.ag-label-align-top){min-height:var(--ag-list-item-height)}.ag-picker-field-display{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ag-picker-field-icon{align-items:center;display:flex}}:where(.ag-ltr) :where(.ag-select){.ag-picker-field-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding)/2);padding-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-select){.ag-picker-field-wrapper{padding-left:var(--ag-spacing);padding-right:calc(var(--ag-cell-horizontal-padding)/2)}}.ag-select-list{background-color:var(--ag-picker-list-background-color);border:var(--ag-picker-list-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);overflow:hidden auto}.ag-select-list-item{cursor:default;-webkit-user-select:none;-moz-user-select:none;user-select:none;:where(span){overflow:hidden;text-overflow:ellipsis;white-space:nowrap}}:where(.ag-ltr) .ag-select-list-item{padding-left:calc(var(--ag-cell-horizontal-padding)/2)}:where(.ag-rtl) .ag-select-list-item{padding-right:calc(var(--ag-cell-horizontal-padding)/2)}",zS=class extends vK{constructor(t){super(w({pickerAriaLabelKey:"ariaLabelSelectField",pickerAriaLabelValue:"Select Field",pickerType:"ag-list",className:"ag-select",pickerIcon:"selectOpen",ariaRole:"combobox"},t)),this.registerCSS(CK)}postConstruct(){this.tooltipFeature=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{shouldDisplayTooltip:im(()=>this.eDisplayField),getGui:()=>this.getGui()})),super.postConstruct(),this.createListComponent(),this.eWrapper.tabIndex=this.gos.get("tabIndex");let{options:t,value:e,placeholder:i}=this.config;t!=null&&this.addOptions(t),e!=null&&this.setValue(e,!0),i&&e==null&&(this.eDisplayField.textContent=i),this.addManagedElementListeners(this.eWrapper,{focusout:this.onWrapperFocusOut.bind(this)})}onWrapperFocusOut(t){this.eWrapper.contains(t.relatedTarget)||this.hidePicker()}createListComponent(){let t=this.createBean(new fK("select"));this.listComponent=t,t.setParentComponent(this);let e=t.getAriaElement(),i=`ag-select-list-${t.getCompId()}`;e.setAttribute("id",i),Gj(this.getAriaElement(),e),t.addManagedElementListeners(t.getGui(),{mousedown:n=>{n?.preventDefault()}}),t.addManagedListeners(t,{selectedItem:()=>{this.hidePicker(),this.dispatchLocalEvent({type:"selectedItem"})},fieldValueChanged:()=>{this.listComponent&&(this.setValue(this.listComponent.getValue(),!1,!0),this.hidePicker())}})}createPickerComponent(){return this.listComponent}beforeHidePicker(){this.listComponent?.hideItemTooltip(),super.beforeHidePicker()}onKeyDown(t){let{key:e}=t;switch(e===A.TAB&&this.hidePicker(),e){case A.ENTER:case A.UP:case A.DOWN:case A.PAGE_UP:case A.PAGE_DOWN:case A.PAGE_HOME:case A.PAGE_END:t.preventDefault(),this.isPickerDisplayed?this.listComponent?.handleKeyDown(t):super.onKeyDown(t);break;case A.ESCAPE:super.onKeyDown(t);break;case A.SPACE:this.isPickerDisplayed?t.preventDefault():super.onKeyDown(t);break}}showPicker(){let t=this.listComponent;t&&(super.showPicker(),t.refreshHighlighted())}addOptions(t){for(let e of t)this.addOption(e);return this}addOption(t){return this.listComponent.addOption(t),this}clearOptions(){return this.listComponent?.clearOptions(),this.setValue(void 0,!0),this}setValue(t,e,i){let{listComponent:n,config:{placeholder:r},eDisplayField:o,tooltipFeature:s}=this;if(this.value===t||!n)return this;if(i||n.setValue(t,!0),n.getValue()===this.getValue())return this;let l=n.getDisplayValue();return l==null&&r&&(l=r),o.textContent=l,s?.setTooltipAndRefresh(l??null),super.setValue(t,e)}destroy(){this.listComponent=this.destroyBean(this.listComponent),super.destroy()}},wK={selector:"AG-SELECT",component:zS};var bK=':where(.ag-root-wrapper,.ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart),:where(.ag-root-wrapper,.ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]){box-sizing:border-box;&:after,&:before{box-sizing:border-box}&:where(div,span,label):focus-visible{box-shadow:inset var(--ag-focus-shadow);outline:none;&:where(.invalid){box-shadow:inset var(--ag-focus-error-shadow)}}&:where(button){color:inherit}}:where(.ag-root-wrapper,ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]) ::-ms-clear{display:none}.ag-hidden{display:none!important}.ag-invisible{visibility:hidden!important}.ag-popup-child{top:0;z-index:5;&:where(:not(.ag-tooltip-custom)){box-shadow:var(--ag-popup-shadow)}}.ag-input-wrapper,.ag-picker-field-wrapper{align-items:center;display:flex;flex:1 1 auto;line-height:normal;position:relative}.ag-input-field{align-items:center;display:flex;flex-direction:row}.ag-input-field-input:where(:not([type=checkbox],[type=radio])){flex:1 1 auto;min-width:0;width:100%}.ag-chart,.ag-dnd-ghost,.ag-external,.ag-popup,.ag-root-wrapper{cursor:default;line-height:normal;white-space:normal;-webkit-font-smoothing:antialiased;background-color:var(--ag-background-color);color:var(--ag-text-color);color-scheme:var(--ag-browser-color-scheme);font-family:var(--ag-font-family);font-size:var(--ag-font-size);--ag-indentation-level:0}:where(.ag-icon):before{align-items:center;background-color:currentcolor;color:inherit;content:"";display:flex;font-family:inherit;font-size:var(--ag-icon-size);font-style:normal;font-variant:normal;height:var(--ag-icon-size);justify-content:center;line-height:var(--ag-icon-size);-webkit-mask-size:contain;mask-size:contain;text-transform:none;width:var(--ag-icon-size)}.ag-icon{background-position:50%;background-repeat:no-repeat;background-size:contain;color:var(--ag-icon-color);display:block;height:var(--ag-icon-size);position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:var(--ag-icon-size)}.ag-disabled,[disabled]{.ag-icon{opacity:.5}&.ag-icon-grip{opacity:.35}}.ag-resizer{pointer-events:none;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none;z-index:1}:where(.ag-resizer){&.ag-resizer-topLeft{cursor:nwse-resize;height:5px;left:0;top:0;width:5px}&.ag-resizer-top{cursor:ns-resize;height:5px;left:5px;right:5px;top:0}&.ag-resizer-topRight{cursor:nesw-resize;height:5px;right:0;top:0;width:5px}&.ag-resizer-right{bottom:5px;cursor:ew-resize;right:0;top:5px;width:5px}&.ag-resizer-bottomRight{bottom:0;cursor:nwse-resize;height:5px;right:0;width:5px}&.ag-resizer-bottom{bottom:0;cursor:ns-resize;height:5px;left:5px;right:5px}&.ag-resizer-bottomLeft{bottom:0;cursor:nesw-resize;height:5px;left:0;width:5px}&.ag-resizer-left{bottom:5px;cursor:ew-resize;left:0;top:5px;width:5px}}',VS=typeof window!="object"||!window?.document?.fonts?.forEach,iS=!1,gc=(t,e,i,n,r,o)=>{if(VS||iS)return;n&&(t=`@layer ${CSS.escape(n)} { ${t} }`);let s=lc.map.get(e);if(s||(s=[],lc.map.set(e,s)),s.some(d=>d.css===t))return;let a=document.createElement("style");o&&a.setAttribute("nonce",o),a.dataset.agGlobalCss=i,a.textContent=t;let l={css:t,el:a,priority:r},c;for(let d of s){if(d.priority>r)break;c=d}if(c){c.el.insertAdjacentElement("afterend",a);let d=s.indexOf(c);s.splice(d+1,0,l)}else e.insertBefore(a,e.querySelector(":not(title, meta)")),s.push(l)},_M=(t,e,i,n)=>{gc(bK,t,"shared",e,0,i),n?.forEach((r,o)=>r.forEach(s=>gc(s,t,o,e,0,i)))},yK=t=>{lc.grids.add(t)},SK=t=>{if(lc.grids.delete(t),lc.grids.size===0){lc.map=new WeakMap;for(let e of document.head.querySelectorAll("style[data-ag-global-css]"))e.remove()}},dT,lc=(dT=typeof window=="object"?window:{}).agStyleInjectionState??(dT.agStyleInjectionState={map:new WeakMap,grids:new Set}),hn=t=>new kM(t),gs="$default",xK=0,kM=class{constructor({feature:t,params:e,modeParams:i={},css:n,cssImports:r}){this.feature=t,this.css=n,this.cssImports=r,this.modeParams=w({[gs]:w(w({},i[gs]??{}),e??{})},i)}use(t,e,i){let n=this._inject;if(n==null){let{css:r}=this;if(r){let o=`ag-theme-${this.feature??"part"}-${++xK}`;typeof r=="function"&&(r=r()),r=`:where(.${o}) {
${r}
}
`;for(let s of this.cssImports??[])r=`@import url(${JSON.stringify(s)});
${r}`;n={css:r,class:o}}else n=!1;this._inject=n}return n&&t&&gc(n.css,t,n.class,e,1,i),n?n.class:!1}},EK=t=>t.replace(/[A-Z]/g,e=>`-${e}`).toLowerCase(),FM=t=>`--ag-${EK(t)}`,Lr=t=>`var(${FM(t)})`,PK=(t,e,i)=>Math.max(e,Math.min(i,t)),RK=t=>{let e=new Map;return i=>{let n=i;return e.has(n)||e.set(n,t(i)),e.get(n)}},ln=t=>({ref:"accentColor",mix:t}),Tn=t=>({ref:"foregroundColor",mix:t}),Ti=t=>({ref:"foregroundColor",mix:t,onto:"backgroundColor"}),_K=t=>({ref:"foregroundColor",mix:t,onto:"headerBackgroundColor"}),Di={ref:"backgroundColor"},Jl={ref:"foregroundColor"},Qt={ref:"accentColor"},Fm={backgroundColor:"#fff",foregroundColor:"#181d1f",borderColor:Tn(.15),chromeBackgroundColor:Ti(.02),browserColorScheme:"light"},kK=k(w({},Fm),{textColor:Jl,accentColor:"#2196f3",invalidColor:"#e02525",fontFamily:["-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu","Cantarell","Helvetica Neue","sans-serif"],subtleTextColor:{ref:"textColor",mix:.5},borderWidth:1,borderRadius:4,spacing:8,fontSize:14,focusShadow:{spread:3,color:ln(.5)},focusErrorShadow:{spread:3,color:{ref:"invalidColor",onto:"backgroundColor",mix:.5}},popupShadow:"0 0 16px #00000026",cardShadow:"0 1px 4px 1px #00000018",dropdownShadow:{ref:"cardShadow"},listItemHeight:{calc:"max(iconSize, dataFontSize) + widgetVerticalSpacing"},dragAndDropImageBackgroundColor:Di,dragAndDropImageBorder:!0,dragAndDropImageNotAllowedBorder:{color:{ref:"invalidColor",onto:"dragAndDropImageBackgroundColor",mix:.5}},dragAndDropImageShadow:{ref:"popupShadow"},iconSize:16,iconColor:"inherit",toggleButtonWidth:28,toggleButtonHeight:18,toggleButtonOnBackgroundColor:Qt,toggleButtonOffBackgroundColor:Ti(.3),toggleButtonSwitchBackgroundColor:Di,toggleButtonSwitchInset:2,tooltipBackgroundColor:{ref:"chromeBackgroundColor"},tooltipErrorBackgroundColor:{ref:"invalidColor",onto:"backgroundColor",mix:.1},tooltipTextColor:{ref:"textColor"},tooltipErrorTextColor:{ref:"invalidColor"},tooltipBorder:!0,tooltipErrorBorder:{color:{ref:"invalidColor",onto:"backgroundColor",mix:.25}}}),FK=["colorScheme","color","length","scale","borderStyle","border","shadow","image","fontFamily","fontWeight","duration"],TK=RK(t=>(t=t.toLowerCase(),FK.find(e=>t.endsWith(e.toLowerCase()))??"length")),Vm=t=>typeof t=="object"&&t?.ref?Lr(t.ref):typeof t=="string"?t:typeof t=="number"?String(t):!1,GS=t=>{if(typeof t=="string")return t;if(t&&"ref"in t){let e=Lr(t.ref);return t.mix==null?e:`color-mix(in srgb, ${t.onto?Lr(t.onto):"transparent"}, ${e} ${PK(t.mix*100,0,100)}%)`}return!1},DK=Vm,Ql=t=>typeof t=="string"?t:typeof t=="number"?`${t}px`:t&&"calc"in t?`calc(${t.calc.replace(/ ?[*/+] ?/g," $& ").replace(/-?\b[a-z][a-z0-9]*\b(?![-(])/gi,i=>i[0]==="-"?i:" "+Lr(i)+" ")})`:t&&"ref"in t?Lr(t.ref):!1,MK=Vm,nS=(t,e)=>typeof t=="string"?t:t===!0?nS({},e):t===!1?e==="columnBorder"?nS({color:"transparent"},e):"none":t&&"ref"in t?Lr(t.ref):TM(t.style??"solid")+" "+Ql(t.width??{ref:"borderWidth"})+" "+GS(t.color??{ref:"borderColor"}),IK=t=>typeof t=="string"?t:t===!1?"none":t&&"ref"in t?Lr(t.ref):[Ql(t.offsetX??0),Ql(t.offsetY??0),Ql(t.radius??0),Ql(t.spread??0),GS(t.color??{ref:"foregroundColor"})].join(" "),TM=Vm,DM=t=>typeof t=="string"?t.includes(",")?t:uT(t):t&&"googleFont"in t?DM(t.googleFont):t&&"ref"in t?Lr(t.ref):Array.isArray(t)?t.map(e=>(typeof e=="object"&&"googleFont"in e&&(e=e.googleFont),uT(e))).join(", "):!1,uT=t=>/^[\w-]+$|\w\(/.test(t)?t:JSON.stringify(t),AK=Vm,MM=t=>typeof t=="string"?t:t&&"url"in t?`url(${JSON.stringify(t.url)})`:t&&"svg"in t?MM({url:`data:image/svg+xml,${encodeURIComponent(t.svg)}`}):t&&"ref"in t?Lr(t.ref):!1,OK=(t,e,i)=>typeof t=="string"?t:typeof t=="number"?(t>=10&&i.warn(104,{value:t,param:e}),`${t}s`):t&&"ref"in t?Lr(t.ref):!1,LK={color:GS,colorScheme:DK,length:Ql,scale:MK,border:nS,borderStyle:TM,shadow:IK,image:MM,fontFamily:DM,fontWeight:AK,duration:OK},NK=(t,e,i)=>{let n=TK(t);return LK[n](e,t,i)};var BK=t=>new IM(t),IM=class AM{constructor(e,i=[]){this.themeLogger=e,this.parts=i}withPart(e){return typeof e=="function"&&(e=e()),e instanceof kM?new AM(this.themeLogger,[...this.parts,e]):(this.themeLogger.preInitErr(259,"Invalid part",{part:e}),this)}withoutPart(e){return this.withPart(hn({feature:e}))}withParams(e,i=gs){return this.withPart(hn({modeParams:{[i]:e}}))}_startUse({styleContainer:e,cssLayer:i,nonce:n,loadThemeGoogleFonts:r,moduleCss:o}){if(VS||iS)return;zK(),_M(e,i,n,o);let s=HK(this);if(s.length>0)for(let a of s)r&&VK(a,n);for(let a of this.parts)a.use(e,i,n)}_getCssClass(){return iS?"ag-theme-quartz":this._cssClassCache??(this._cssClassCache=hT(this.parts).map(e=>e.use(void 0,void 0,void 0)).filter(Boolean).join(" "))}_getModeParams(){let e=this._paramsCache;if(!e){let i={[gs]:w({},kK)};for(let n of hT(this.parts))for(let r of Object.keys(n.modeParams)){let o=n.modeParams[r];if(o){let s=i[r]??(i[r]={}),a=new Set;for(let l of Object.keys(o)){let c=o[l];c!==void 0&&(s[l]=c,a.add(l))}if(r===gs)for(let l of Object.keys(i)){let c=i[l];if(l!==gs)for(let d of a)delete c[d]}}}this._paramsCache=e=i}return e}_getPerInstanceCss(e){let i="##SELECTOR##",n=this._paramsCssCache;if(!n){let r="",o="",s=this._getModeParams();for(let l of Object.keys(s)){let c=s[l];if(l!==gs){let u=`:where([data-ag-theme-mode="${typeof CSS=="object"?CSS.escape(l):l}"]) & {
`;r+=u,o+=u}for(let d of Object.keys(c).sort()){let u=c[d],h=NK(d,u,this.themeLogger);if(h===!1)this.themeLogger.error(107,{key:d,value:u});else{let p=FM(d),f=p.replace("--ag-","--ag-inherited-");r+=`	${p}: var(${f}, ${h});
`,o+=`	${f}: var(${p});
`}}l!==gs&&(r+=`}
`,o+=`}
`)}let a=`${i} {
${r}}
`;a+=`:has(> ${i}):not(${i}) {
${o}}
`,this._paramsCssCache=n=a}return n.replaceAll(i,`:where(.${e})`)}},hT=t=>{let e=new Map;for(let n of t)e.set(n.feature,n);let i=[];for(let n of t)(!n.feature||e.get(n.feature)===n)&&i.push(n);return i},HK=t=>{let e=new Set,i=o=>{if(Array.isArray(o))o.forEach(i);else{let s=o?.googleFont;typeof s=="string"&&e.add(s)}};return Object.values(t._getModeParams()).flatMap(o=>Object.values(o)).forEach(i),Array.from(e).sort()},pT=!1,zK=()=>{if(!pT){pT=!0;for(let t of Array.from(document.head.querySelectorAll('style[data-ag-scope="legacy"]')))t.remove()}},VK=async(t,e)=>{let i=`@import url('https://${GK}/css2?family=${encodeURIComponent(t)}:wght@100;200;300;400;500;600;700;800;900&display=swap');
`;gc(i,document.head,`googleFont:${t}`,void 0,0,e)},GK="fonts.googleapis.com",WK=1,UK=class{constructor(t){this.beans={},this.createdBeans=[],this.destroyed=!1,this.instanceId=WK++,t?.beanClasses&&(this.beanDestroyComparator=t.beanDestroyComparator,this.init(t))}init(t){this.id=t.id,this.beans.context=this,this.destroyCallback=t.destroyCallback;for(let e of Object.keys(t.providedBeanInstances))this.beans[e]=t.providedBeanInstances[e];for(let e of t.beanClasses){let i=new e;i.beanName?this.beans[i.beanName]=i:console.error(`Bean ${e.name} is missing beanName`),this.createdBeans.push(i)}for(let e of t.derivedBeans??[]){let{beanName:i,bean:n}=e(this);this.beans[i]=n,this.createdBeans.push(n)}t.beanInitComparator&&this.createdBeans.sort(t.beanInitComparator),this.initBeans(this.createdBeans)}getBeanInstances(){return Object.values(this.beans)}createBean(t,e){return this.initBeans([t],e),t}initBeans(t,e){let i=this.beans;for(let n of t)n.preWireBeans?.(i),n.wireBeans?.(i);for(let n of t)n.preConstruct?.();e&&t.forEach(e);for(let n of t)n.postConstruct?.()}getBeans(){return this.beans}getBean(t){return this.beans[t]}getId(){return this.id}destroy(){if(this.destroyed)return;this.destroyed=!0;let t=this.getBeanInstances();this.beanDestroyComparator&&t.sort(this.beanDestroyComparator),this.destroyBeans(t),this.beans={},this.createdBeans=[],this.destroyCallback?.()}destroyBean(t){t?.destroy?.()}destroyBeans(t){if(t)for(let e=0;e<t.length;e++)this.destroyBean(t[e]);return[]}isDestroyed(){return this.destroyed}},jK=0,qK=class extends Br{constructor(){super(...arguments),this.beanName="environment",this.paramsClass=`ag-theme-params-${++jK}`,this.globalCSS=[]}wireBeans(t){this.eRootDiv=t.eRootDiv}postConstruct(){let{gos:t,eRootDiv:e}=this;t.setInstanceDomData(e),this.eStyleContainer=t.get("themeStyleContainer")??(e.getRootNode()===document?document.head:e),this.cssLayer=t.get("themeCssLayer"),this.styleNonce=t.get("styleNonce"),this.addManagedPropertyListener("theme",()=>this.handleThemeChange()),this.handleThemeChange(),this.initVariables(),this.addDestroyFunc(()=>SK(this)),this.mutationObserver=new MutationObserver(()=>{this.fireStylesChangedEvent("themeChanged")}),this.addDestroyFunc(()=>this.mutationObserver.disconnect())}applyThemeClasses(t,e=[]){let{theme:i}=this,n;i?n=`${this.paramsClass} ${i._getCssClass()}`:n=this.applyLegacyThemeClasses();for(let r of Array.from(t.classList))r.startsWith("ag-theme-")&&t.classList.remove(r);if(n){let r=t.className;t.className=`${r}${r?" ":""}${n}${e?.length?" "+e.join(" "):""}`}}applyLegacyThemeClasses(){let t="";this.mutationObserver.disconnect();let e=this.eRootDiv;for(;e;){let i=!1;for(let n of Array.from(e.classList))n.startsWith("ag-theme-")&&(i=!0,t=t?`${t} ${n}`:n);i&&this.mutationObserver.observe(e,{attributes:!0,attributeFilter:["class"]}),e=e.parentElement}return t}addGlobalCSS(t,e){this.theme?gc(t,this.eStyleContainer,e,this.cssLayer,0,this.styleNonce):this.globalCSS.push([t,e])}handleThemeChange(){let{gos:t,theme:e}=this,i=t.get("theme"),n;if(i==="legacy")n=void 0;else{let r=i??this.getDefaultTheme();r instanceof IM?n=r:this.themeError(r)}n!==e&&this.handleNewTheme(n),this.postProcessThemeChange(n,i)}handleNewTheme(t){let{gos:e,eRootDiv:i,globalCSS:n}=this,r=this.getAdditionalCss();if(t){yK(this),_M(this.eStyleContainer,this.cssLayer,this.styleNonce,r);for(let[s,a]of n)gc(s,this.eStyleContainer,a,this.cssLayer,0,this.styleNonce);n.length=0}this.theme=t,t?._startUse({loadThemeGoogleFonts:e.get("loadThemeGoogleFonts"),styleContainer:this.eStyleContainer,cssLayer:this.cssLayer,nonce:this.styleNonce,moduleCss:r});let o=this.eParamsStyle;if(!o){o=this.eParamsStyle=Ch({tag:"style"});let s=e.get("styleNonce");s&&o.setAttribute("nonce",s),i.appendChild(o)}VS||(o.textContent=t?._getPerInstanceCss(this.paramsClass)||""),this.applyThemeClasses(i),this.fireStylesChangedEvent("themeChanged")}},$K=class extends Br{constructor(){super(...arguments),this.beanName="registry"}registerDynamicBeans(t){if(t){this.dynamicBeans??(this.dynamicBeans={});for(let e of Object.keys(t))this.dynamicBeans[e]=t[e]}}createDynamicBean(t,e,...i){if(!this.dynamicBeans)throw new Error(this.getDynamicError(t,!0));let n=this.dynamicBeans[t];if(n==null){if(e)throw new Error(this.getDynamicError(t,!1));return}return new n(...i)}},KK=class extends Br{constructor(){super(...arguments),this.beanName="eventSvc",this.eventServiceType="global",this.globalSvc=new ka}addListener(t,e,i){this.globalSvc.addEventListener(t,e,i)}removeListener(t,e,i){this.globalSvc.removeEventListener(t,e,i)}addGlobalListener(t,e=!1){this.globalSvc.addGlobalListener(t,e)}removeGlobalListener(t,e=!1){this.globalSvc.removeGlobalListener(t,e)}dispatchEvent(t){this.globalSvc.dispatchEvent(this.gos.addCommon(t))}dispatchEventOnce(t){this.globalSvc.dispatchEventOnce(this.gos.addCommon(t))}},OM=class extends Br{constructor(t,e){super(),this.ctrl=t,e&&(this.beans=e)}postConstruct(){this.refreshTooltip()}setBrowserTooltip(t,e){let i="title",n=this.ctrl.getGui();n&&(t!=null&&(t!=""||e)?n.setAttribute(i,t):n.removeAttribute(i))}updateTooltipText(){let{getTooltipValue:t}=this.ctrl;t&&(this.tooltip=t())}createTooltipFeatureIfNeeded(){if(this.tooltipManager==null){let t=this.beans.registry.createDynamicBean("tooltipStateManager",!0,this.ctrl,()=>this.tooltip);t&&(this.tooltipManager=this.createBean(t,this.beans.context))}}attemptToShowTooltip(){this.tooltipManager?.prepareToShowTooltip()}attemptToHideTooltip(){this.tooltipManager?.hideTooltip()}setTooltipAndRefresh(t){this.tooltip=t,this.refreshTooltip()}refreshTooltip(t){this.browserTooltips=this.beans.gos.get("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?(this.setBrowserTooltip(this.tooltip),this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context)):(this.setBrowserTooltip(t?"":null,t),this.createTooltipFeatureIfNeeded())}destroy(){this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context),super.destroy()}},YK=1e3,XK=1e3,fT=100,gT,qg=!1,JK=class extends Br{constructor(t,e){super(),this.tooltipCtrl=t,this.getTooltipValue=e,this.interactionEnabled=!1,this.isInteractingWithTooltip=!1,this.state=0,this.tooltipInstanceCount=0,this.tooltipMouseTrack=!1}wireBeans(t){this.popupSvc=t.popupSvc}postConstruct(){this.gos.get("tooltipInteraction")&&(this.interactionEnabled=!0),this.tooltipTrigger=this.getTooltipTrigger(),this.tooltipMouseTrack=this.gos.get("tooltipMouseTrack");let t=this.tooltipCtrl.getGui();this.tooltipTrigger===0&&this.addManagedListeners(t,{mouseenter:this.onMouseEnter.bind(this),mouseleave:this.onMouseLeave.bind(this)}),this.tooltipTrigger===1&&this.addManagedListeners(t,{focusin:this.onFocusIn.bind(this),focusout:this.onFocusOut.bind(this)}),this.addManagedListeners(t,{mousemove:this.onMouseMove.bind(this)}),this.interactionEnabled||this.addManagedListeners(t,{mousedown:this.onMouseDown.bind(this),keydown:this.onKeyDown.bind(this)})}getGridOptionsTooltipDelay(t){let e=this.gos.get(t);return Math.max(200,e)}getTooltipDelay(t){return t==="show"?this.tooltipCtrl.getTooltipShowDelayOverride?.()??this.getGridOptionsTooltipDelay("tooltipShowDelay"):this.tooltipCtrl.getTooltipHideDelayOverride?.()??this.getGridOptionsTooltipDelay("tooltipHideDelay")}destroy(){this.setToDoNothing(),super.destroy()}getTooltipTrigger(){let t=this.gos.get("tooltipTrigger");return!t||t==="hover"?0:1}onMouseEnter(t){this.interactionEnabled&&this.interactiveTooltipTimeoutId&&(this.unlockService(),this.startHideTimeout()),!Pa()&&(qg?this.showTooltipTimeoutId=window.setTimeout(()=>{this.prepareToShowTooltip(t)},fT):this.prepareToShowTooltip(t))}onMouseMove(t){this.lastMouseEvent&&(this.lastMouseEvent=t),this.tooltipMouseTrack&&this.state===2&&this.tooltipComp&&this.positionTooltip()}onMouseDown(){this.setToDoNothing()}onMouseLeave(){this.interactionEnabled?this.lockService():this.setToDoNothing()}onFocusIn(){this.prepareToShowTooltip()}onFocusOut(t){let e=t.relatedTarget,i=this.tooltipCtrl.getGui(),n=this.tooltipComp?.getGui();this.isInteractingWithTooltip||i.contains(e)||this.interactionEnabled&&n?.contains(e)||this.setToDoNothing()}onKeyDown(){this.isInteractingWithTooltip&&(this.isInteractingWithTooltip=!1),this.setToDoNothing()}prepareToShowTooltip(t){if(this.state!=0||qg)return;let e=0;t&&(e=this.isLastTooltipHiddenRecently()?200:this.getTooltipDelay("show")),this.lastMouseEvent=t||null,this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),e),this.state=1}isLastTooltipHiddenRecently(){return Date.now()-gT<YK}setToDoNothing(t){!t&&this.state===2&&this.hideTooltip(),this.onBodyScrollEventCallback&&(this.onBodyScrollEventCallback(),this.onBodyScrollEventCallback=void 0),this.clearEventHandlers(),this.onDocumentKeyDownCallback&&(this.onDocumentKeyDownCallback(),this.onDocumentKeyDownCallback=void 0),this.clearTimeouts(),this.state=0,this.lastMouseEvent=null}showTooltip(){let t=this.getTooltipValue(),e=this.tooltipCtrl;if(!ae(t)||e.shouldDisplayTooltip&&!e.shouldDisplayTooltip()){this.setToDoNothing();return}let i=this.gos.addCommon(w({location:e.getLocation?.()??"UNKNOWN",value:t,hideTooltipCallback:()=>this.hideTooltip(!0)},e.getAdditionalParams?.()));this.state=2,this.tooltipInstanceCount++;let n=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.createTooltipComp(i,n)}hideTooltip(t){!t&&this.isInteractingWithTooltip||(this.tooltipComp&&(this.destroyTooltipComp(),gT=Date.now()),this.eventSvc.dispatchEvent({type:"tooltipHide",parentGui:this.tooltipCtrl.getGui()}),t&&(this.isInteractingWithTooltip=!1),this.setToDoNothing(!0))}newTooltipComponentCallback(t,e){if(this.state!==2||this.tooltipInstanceCount!==t){this.destroyBean(e);return}let n=e.getGui();this.tooltipComp=e,n.classList.contains("ag-tooltip")||n.classList.add("ag-tooltip-custom"),this.tooltipTrigger===0&&n.classList.add("ag-tooltip-animate"),this.interactionEnabled&&n.classList.add("ag-tooltip-interactive");let r=this.getLocaleTextFunc(),o=this.popupSvc?.addPopup({eChild:n,ariaLabel:r("ariaLabelTooltip","Tooltip")});if(o&&(this.tooltipPopupDestroyFunc=o.hideFunc),this.positionTooltip(),this.tooltipTrigger===1){let s=()=>this.setToDoNothing();[this.onBodyScrollEventCallback]=this.addManagedEventListeners({bodyScroll:s}),this.setEventHandlers(s)}this.interactionEnabled&&([this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener]=this.addManagedElementListeners(n,{mouseenter:this.onTooltipMouseEnter.bind(this),mouseleave:this.onTooltipMouseLeave.bind(this)}),[this.onDocumentKeyDownCallback]=this.addManagedElementListeners(ri(this.beans),{keydown:s=>{n.contains(s?.target)||this.onKeyDown()}}),this.tooltipTrigger===1&&([this.tooltipFocusInListener,this.tooltipFocusOutListener]=this.addManagedElementListeners(n,{focusin:this.onTooltipFocusIn.bind(this),focusout:this.onTooltipFocusOut.bind(this)}))),this.eventSvc.dispatchEvent({type:"tooltipShow",tooltipGui:n,parentGui:this.tooltipCtrl.getGui()}),this.startHideTimeout()}onTooltipMouseEnter(){this.isInteractingWithTooltip=!0,this.unlockService()}onTooltipMouseLeave(){this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,this.lockService())}onTooltipFocusIn(){this.isInteractingWithTooltip=!0}isTooltipFocused(){let t=this.tooltipComp?.getGui(),e=St(this.beans);return!!t&&t.contains(e)}onTooltipFocusOut(t){let e=this.tooltipCtrl.getGui();this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,e.contains(t.relatedTarget)?this.startHideTimeout():this.hideTooltip())}positionTooltip(){let t={type:"tooltip",ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack};this.lastMouseEvent?this.popupSvc?.positionPopupUnderMouseEvent(k(w({},t),{mouseEvent:this.lastMouseEvent})):this.popupSvc?.positionPopupByComponent(k(w({},t),{eventSource:this.tooltipCtrl.getGui(),position:"under",keepWithinBounds:!0,nudgeY:5}))}destroyTooltipComp(){this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");let t=this.tooltipPopupDestroyFunc,e=this.tooltipComp,i=this.tooltipTrigger===0?XK:0;window.setTimeout(()=>{t(),this.destroyBean(e)},i),this.clearTooltipListeners(),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0}clearTooltipListeners(){for(let t of[this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener,this.tooltipFocusInListener,this.tooltipFocusOutListener])t&&t();this.tooltipMouseEnterListener=this.tooltipMouseLeaveListener=this.tooltipFocusInListener=this.tooltipFocusOutListener=null}lockService(){qg=!0,this.interactiveTooltipTimeoutId=window.setTimeout(()=>{this.unlockService(),this.setToDoNothing()},fT)}unlockService(){qg=!1,this.clearInteractiveTimeout()}startHideTimeout(){this.clearHideTimeout(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.getTooltipDelay("hide"))}clearShowTimeout(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0)}clearHideTimeout(){this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)}clearInteractiveTimeout(){this.interactiveTooltipTimeoutId&&(window.clearTimeout(this.interactiveTooltipTimeoutId),this.interactiveTooltipTimeoutId=void 0)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout(),this.clearInteractiveTimeout()}},QK=class extends OM{constructor(t,e,i){super(t,i),this.highlightTracker=e,this.onHighlight=this.onHighlight.bind(this)}postConstruct(){super.postConstruct(),this.wireHighlightListeners()}wireHighlightListeners(){this.addManagedPropertyListener("tooltipTrigger",({currentValue:t})=>{this.setTooltipMode(t)}),this.setTooltipMode(this.gos.get("tooltipTrigger")),this.highlightTracker.addEventListener("itemHighlighted",this.onHighlight)}onHighlight(t){this.tooltipMode===1&&(t.highlighted?this.attemptToShowTooltip():this.attemptToHideTooltip())}setTooltipMode(t="focus"){this.tooltipMode=t==="focus"?1:0}destroy(){this.highlightTracker.removeEventListener("itemHighlighted",this.onHighlight),super.destroy()}},$g=0,ZK=200,eY=class extends Br{constructor(){super(...arguments),this.beanName="popupSvc",this.popupList=[]}getPopupParent(){let t=this.gos.get("popupParent");return t||this.getDefaultPopupParent()}positionPopupUnderMouseEvent(t){let{ePopup:e,nudgeX:i,nudgeY:n,skipObserver:r}=t;this.positionPopup({ePopup:e,nudgeX:i,nudgeY:n,keepWithinBounds:!0,skipObserver:r,updatePosition:()=>this.calculatePointerAlign(t.mouseEvent),postProcessCallback:()=>this.callPostProcessPopup(t,t.type,t.ePopup,null,t.mouseEvent)})}calculatePointerAlign(t){let e=this.getParentRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}positionPopupByComponent(t){let{ePopup:e,nudgeX:i,nudgeY:n,keepWithinBounds:r,eventSource:o,alignSide:s="left",position:a="over",type:l}=t,c=o.getBoundingClientRect(),d=this.getParentRect();this.setAlignedTo(o,e);let u=()=>{let h=c.left-d.left;s==="right"&&(h-=e.offsetWidth-c.width);let p;return a==="over"?(p=c.top-d.top,this.setAlignedStyles(e,"over")):(this.setAlignedStyles(e,"under"),this.shouldRenderUnderOrAbove(e,c,d,t.nudgeY||0)==="under"?p=c.top-d.top+c.height:p=c.top-e.offsetHeight-(n||0)*2-d.top),{x:h,y:p}};this.positionPopup({ePopup:e,nudgeX:i,nudgeY:n,keepWithinBounds:r,updatePosition:u,postProcessCallback:()=>this.callPostProcessPopup(t,l,e,o,null)})}shouldRenderUnderOrAbove(t,e,i,n){let r=i.bottom-e.bottom,o=e.top-i.top,s=t.offsetHeight+n;return r>s?"under":o>s||o>r?"above":"under"}setAlignedStyles(t,e){let i=this.getPopupIndex(t);if(i===-1)return;let n=this.popupList[i],{alignedToElement:r}=n;if(!r)return;let o=["right","left","over","above","under"];for(let s of o)r.classList.remove(`ag-has-popup-positioned-${s}`),t.classList.remove(`ag-popup-positioned-${s}`);e&&(r.classList.add(`ag-has-popup-positioned-${e}`),t.classList.add(`ag-popup-positioned-${e}`))}setAlignedTo(t,e){let i=this.getPopupIndex(e);if(i!==-1){let n=this.popupList[i];n.alignedToElement=t}}positionPopup(t){let{ePopup:e,keepWithinBounds:i,nudgeX:n,nudgeY:r,skipObserver:o,updatePosition:s}=t,a={width:0,height:0},l=(c=!1)=>{let{x:d,y:u}=s();c&&e.clientWidth===a.width&&e.clientHeight===a.height||(a.width=e.clientWidth,a.height=e.clientHeight,n&&(d+=n),r&&(u+=r),i&&(d=this.keepXYWithinBounds(e,d,1),u=this.keepXYWithinBounds(e,u,0)),e.style.left=`${d}px`,e.style.top=`${u}px`,t.postProcessCallback&&t.postProcessCallback())};if(l(),!o){let c=Ss(this.beans,e,()=>l(!0));setTimeout(()=>c(),ZK)}}getParentRect(){let t=ri(this.beans),e=this.getPopupParent();return e===t.body?e=t.documentElement:getComputedStyle(e).position==="static"&&(e=e.offsetParent),PD(e)}keepXYWithinBounds(t,e,i){let n=i===0,r=n?"clientHeight":"clientWidth",o=n?"top":"left",s=n?"height":"width",a=n?"scrollTop":"scrollLeft",l=ri(this.beans),c=l.documentElement,d=this.getPopupParent(),u=t.getBoundingClientRect(),h=d.getBoundingClientRect(),p=l.documentElement.getBoundingClientRect(),f=d===l.body,g=Math.ceil(u[s]),v=f?(n?ED:gm)(c)+c[a]:d[r];f&&(v-=Math.abs(p[o]-h[o]));let C=v-g;return Math.min(Math.max(e,0),Math.max(C,0))}addPopup(t){let{eChild:e,ariaLabel:i,ariaOwns:n,alwaysOnTop:r,positionCallback:o,anchorToElement:s}=t,a=this.getPopupIndex(e);if(a!==-1)return{hideFunc:this.popupList[a].hideFunc};this.initialisePopupPosition(e);let l=this.createPopupWrapper(e,!!r,i,n),c=this.addEventListenersToPopup(k(w({},t),{wrapperEl:l}));return o&&o(),this.addPopupToPopupList(e,l,c,s),{hideFunc:c}}initialisePopupPosition(t){let i=this.getPopupParent().getBoundingClientRect();ae(t.style.top)||(t.style.top=`${i.top*-1}px`),ae(t.style.left)||(t.style.left=`${i.left*-1}px`)}createPopupWrapper(t,e,i,n){let r=this.getPopupParent(),{environment:o,gos:s}=this.beans,a=Ch({tag:"div"});return o.applyThemeClasses(a),a.classList.add("ag-popup"),t.classList.add(s.get("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),t.hasAttribute("role")||vs(t,"dialog"),i?hc(t,i):n&&(t.id||(t.id=`popup-component-${$g}`),K5(n,t.id)),a.appendChild(t),r.appendChild(a),e?this.setAlwaysOnTop(t,!0):this.bringPopupToFront(t),a}addEventListenersToPopup(t){let e=this.beans,i=ri(e),{wrapperEl:n,eChild:r,closedCallback:o,afterGuiAttached:s,closeOnEsc:a,modal:l,ariaOwns:c}=t,d=!1,u=g=>{if(!n.contains(St(e)))return;g.key===A.ESCAPE&&!this.isStopPropagation(g)&&f({keyboardEvent:g})},h=g=>f({mouseEvent:g}),p=g=>f({touchEvent:g}),f=(g={})=>{let{mouseEvent:m,touchEvent:v,keyboardEvent:C,forceHide:b}=g;!b&&(this.isEventFromCurrentPopup({mouseEvent:m,touchEvent:v},r)||d)||(d=!0,n.remove(),i.removeEventListener("keydown",u),i.removeEventListener("mousedown",h),i.removeEventListener("touchstart",p),i.removeEventListener("contextmenu",h),this.eventSvc.removeListener("dragStarted",h),o&&o(m||v||C),this.removePopupFromPopupList(r,c))};return s&&s({hidePopup:f}),window.setTimeout(()=>{a&&i.addEventListener("keydown",u),l&&(i.addEventListener("mousedown",h),this.eventSvc.addListener("dragStarted",h),i.addEventListener("touchstart",p),i.addEventListener("contextmenu",h))},0),f}addPopupToPopupList(t,e,i,n){this.popupList.push({element:t,wrapper:e,hideFunc:i,instanceId:$g,isAnchored:!!n}),n&&this.setPopupPositionRelatedToElement(t,n),$g=$g+1}getPopupIndex(t){return this.popupList.findIndex(e=>e.element===t)}setPopupPositionRelatedToElement(t,e){let i=this.getPopupIndex(t);if(i===-1)return;let n=this.popupList[i];if(n.stopAnchoringPromise&&n.stopAnchoringPromise.then(o=>o&&o()),n.stopAnchoringPromise=void 0,n.isAnchored=!1,!e)return;let r=this.keepPopupPositionedRelativeTo({element:e,ePopup:t,hidePopup:n.hideFunc});return n.stopAnchoringPromise=r,n.isAnchored=!0,r}removePopupFromPopupList(t,e){this.setAlignedStyles(t,null),this.setPopupPositionRelatedToElement(t,null),e&&K5(e,null),this.popupList=this.popupList.filter(i=>i.element!==t)}keepPopupPositionedRelativeTo(t){let e=this.getPopupParent(),i=e.getBoundingClientRect(),{element:n,ePopup:r}=t,o=n.getBoundingClientRect(),s=u=>Number.parseInt(u.substring(0,u.length-1),10),a=(u,h)=>{let p=i[u]-o[u],f=s(r.style[u]);return{initialDiff:p,lastDiff:p,initial:f,last:f,direction:h}},l=a("top",0),c=a("left",1),d=this.beans.frameworkOverrides;return new Et(u=>{d.wrapIncoming(()=>{d$(()=>{let h=e.getBoundingClientRect(),p=n.getBoundingClientRect();if(p.top==0&&p.left==0&&p.height==0&&p.width==0){t.hidePopup();return}let g=(m,v)=>{let C=s(r.style[v]);m.last!==C&&(m.initial=C,m.last=C);let b=h[v]-p[v];if(b!=m.lastDiff){let S=this.keepXYWithinBounds(r,m.initial+m.initialDiff-b,m.direction);r.style[v]=`${S}px`,m.last=S}m.lastDiff=b};g(l,"top"),g(c,"left")},200).then(h=>{u(()=>{h!=null&&window.clearInterval(h)})})},"popupPositioning")})}isEventFromCurrentPopup(t,e){let{mouseEvent:i,touchEvent:n}=t,r=i||n;if(!r)return!1;let o=this.getPopupIndex(e);if(o===-1)return!1;for(let s=o;s<this.popupList.length;s++){let a=this.popupList[s];if(Kj(a.element,r))return!0}return this.isElementWithinCustomPopup(r.target)}isElementWithinCustomPopup(t){let e=ri(this.beans);for(;t&&t!==e.body;){if(t.classList.contains("ag-custom-component-popup")||t.parentElement===null)return!0;t=t.parentElement}return!1}getWrapper(t){for(;!t.classList.contains("ag-popup")&&t.parentElement;)t=t.parentElement;return t.classList.contains("ag-popup")?t:null}setAlwaysOnTop(t,e){let i=this.getWrapper(t);i&&(i.classList.toggle("ag-always-on-top",!!e),e&&this.bringPopupToFront(i))}bringPopupToFront(t){let e=this.getPopupParent(),i=Array.prototype.slice.call(e.querySelectorAll(".ag-popup")),n=i.length,r=this.getWrapper(t);if(!r||n<=1||!e.contains(t))return;let o=[],s=[];for(let h of i)h!==r&&(h.classList.contains("ag-always-on-top")?s.push(h):o.push(h));let a=[],l=s.length,u=r.classList.contains("ag-always-on-top")||!l?[...o,...s,r]:[...o,r,...s];for(let h=0;h<=n;h++){let p=u[h];if(i[h]===u[h]||p===r)continue;let f=p.querySelectorAll("div");for(let g of f)g.scrollTop!==0&&a.push([g,g.scrollTop]);h===0?e.insertAdjacentElement("afterbegin",p):u[h-1].insertAdjacentElement("afterend",p)}for(;a.length;){let h=a.pop();h[0].scrollTop=h[1]}}},tY=class extends OS{constructor(){super({tag:"div",cls:"ag-tooltip"})}init(t){let{value:e}=t,i=this.getGui();i.textContent=Cc(e);let n=t.location.replace(/([a-z])([A-Z0-9])/g,"$1-$2").toLowerCase();i.classList.add(`ag-${n}-tooltip`)}},LM=(t,e)=>{if(e!=null&&t?.setPointerCapture)try{return t.setPointerCapture(e),t.hasPointerCapture(e)}catch{}return!1},iY=(t,e)=>{if(typeof PointerEvent>"u"||!(e instanceof PointerEvent))return null;let i=e.pointerId;if(!LM(t,i))return null;let n={eElement:t,pointerId:i,onLost(r){rY(n,r)}};return t.addEventListener("lostpointercapture",n.onLost),n},nY=t=>{if(!t)return;NM(t);let{eElement:e,pointerId:i}=t;if(e){try{e.releasePointerCapture(i)}catch{}t.eElement=null}},NM=t=>{let{eElement:e,onLost:i}=t;e&&i&&(e.removeEventListener("lostpointercapture",i),t.onLost=null)},rY=(t,e)=>{NM(t);let{eElement:i,pointerId:n}=t;i&&e.pointerId===n&&LM(i,n)},ql,Zl,fo=t=>{if(!Zl)Zl=new WeakSet;else if(Zl.has(t))return!1;return Zl.add(t),!0},oY=class extends Br{constructor(){super(...arguments),this.beanName="dragSvc",this.dragging=!1,this.drag=null,this.dragSources=[]}get startTarget(){return this.drag?.start.target??null}isPointer(){return!!ql?.has(Tr(this.beans))}hasPointerCapture(){let t=this.drag?.pointerCapture;return!!(t&&this.beans.eRootDiv.hasPointerCapture?.(t.pointerId))}destroy(){this.drag&&this.cancelDrag();let t=this.dragSources;for(let e of t)mT(e);t.length=0,super.destroy()}removeDragSource(t){let e=this.dragSources;for(let i=0,n=e.length;i<n;++i){let r=e[i];if(r.params===t){e.splice(i,1),mT(r);break}}}addDragSource(t){if(!this.isAlive())return;let{eElement:e,includeTouch:i}=t,n=[],r;if(i){let c=e.style;c&&(r=c.touchAction,c.touchAction="none")}let o={handlers:n,params:t,oldTouchAction:r};this.dragSources.push(o),nm(n,[e,"pointerdown",c=>this.onPointerDown(t,c),{passive:!1}],[e,"mousedown",c=>this.onMouseDown(t,c)]);let l=this.gos.get("suppressTouch");i&&!l&&nm(n,[e,"touchstart",d=>this.onTouchStart(t,d),{passive:!1}])}cancelDrag(t){let e=this.drag;t??(t=e?.eElement),t&&this.eventSvc.dispatchEvent({type:"dragCancelled",target:t}),e?.params.onDragCancel?.(),this.destroyDrag()}shouldPreventMouseEvent(t){let e=t.type;return(e==="mousemove"||e==="pointermove")&&t.cancelable&&lh(this.beans,t)&&!Yu(Cy(t))}initDrag(t,...e){this.drag=t;let i=this.beans,n=a=>this.onScroll(a),r=a=>this.onKeyDown(a),o=Tr(i),s=ri(i);nm(t.handlers,[o,"contextmenu",fs],[o,"keydown",r],[s,"scroll",n,{capture:!0}],[s.defaultView||window,"scroll",n],...e)}destroyDrag(){this.dragging=!1;let t=this.drag;if(t){let e=t.rootEl;ql?.get(e)===t&&ql?.delete(e),this.drag=null,nY(t.pointerCapture),kS(t.handlers)}}onPointerDown(t,e){if(this.isPointer())return;let i=this.beans;if(Zl?.has(e))return;let n=e.pointerType;if(n==="touch"&&(i.gos.get("suppressTouch")||!t.includeTouch||(t.stopPropagationForTouch&&e.stopPropagation(),Yu(Cy(e))))||!e.isPrimary||n==="mouse"&&e.button!==0)return;this.destroyDrag();let r=Tr(i),o=t.eElement,s=e.pointerId,a=new vy(r,t,e,s);ql??(ql=new WeakMap),ql.set(r,a);let l=u=>{u.pointerId===s&&this.onMouseOrPointerMove(u)},c=u=>{u.pointerId===s&&this.onMouseOrPointerUp(u)},d=u=>{u.pointerId===s&&fo(u)&&this.cancelDrag()};this.initDrag(a,[r,"pointerup",c],[r,"pointercancel",d],[r,"pointermove",l,{passive:!1}],[r,"touchmove",fs,{passive:!1}],[o,"mousemove",fs,{passive:!1}]),t.dragStartPixels===0?this.onMouseOrPointerMove(e):fo(e)}onTouchStart(t,e){if(this.gos.get("suppressTouch")||!t.includeTouch||!fo(e)||Yu(Cy(e)))return;if(t.stopPropagationForTouch&&e.stopPropagation(),this.isPointer()){fs(e);return}this.destroyDrag();let n=this.beans,r=Tr(n),o=new vy(r,t,e.touches[0]),s=c=>this.onTouchMove(c),a=c=>this.onTouchUp(c),l=e.target??t.eElement;this.initDrag(o,[Tr(n),"touchmove",fs,{passive:!1}],[l,"touchmove",s,{passive:!0}],[l,"touchend",a,{passive:!0}],[l,"touchcancel",a,{passive:!0}]),t.dragStartPixels===0&&this.onMove(o.start)}onMouseDown(t,e){if(e.button!==0||Zl?.has(e)||this.isPointer())return;let i=this.beans;this.destroyDrag();let n=new vy(Tr(i),t,e),r=a=>this.onMouseOrPointerMove(a),o=a=>this.onMouseOrPointerUp(a),s=Tr(i);this.initDrag(n,[s,"mousemove",r],[s,"mouseup",o]),t.dragStartPixels===0?this.onMouseOrPointerMove(e):fo(e)}onScroll(t){if(!fo(t))return;let e=this.drag,i=e?.lastDrag;i&&this.dragging&&e.params?.onDragging(i)}onMouseOrPointerMove(t){fo(t)&&(Es()&&ri(this.beans).getSelection()?.removeAllRanges(),this.shouldPreventMouseEvent(t)&&fs(t),this.onMove(t))}onTouchMove(t){let e=this.drag;if(!e||!fo(t))return;let i=Ju(e.start,t.touches);i&&(t.preventDefault(),this.onMove(i))}onMove(t){let e=this.drag;if(!e)return;e.lastDrag=t;let i=e.params;if(!this.dragging){let n=e.start,o=i.dragStartPixels??4;if(MD(t,n,o)||(this.dragging=!0,i.capturePointer&&(e.pointerCapture=iY(this.beans.eRootDiv,t)),this.eventSvc.dispatchEvent({type:"dragStarted",target:i.eElement}),i.onDragStart(n),this.drag!==e)||(i.onDragging(n),this.drag!==e))return}i.onDragging(t)}onTouchUp(t){let e=this.drag;e&&fo(t)&&this.onUp(Ju(e.start,t.changedTouches))}onMouseOrPointerUp(t){fo(t)&&this.onUp(t)}onUp(t){let e=this.drag;e&&(t||(t=e.lastDrag),t&&this.dragging&&(this.dragging=!1,e.params.onDragStop(t),this.eventSvc.dispatchEvent({type:"dragStopped",target:e.params.eElement})),this.destroyDrag())}onKeyDown(t){t.key===A.ESCAPE&&this.cancelDrag()}},mT=t=>{kS(t.handlers);let e=t.oldTouchAction;if(e!=null){let i=t.params.eElement.style;i&&(i.touchAction=e)}},vy=class{constructor(t,e,i,n=null){this.rootEl=t,this.params=e,this.start=i,this.pointerId=n,this.handlers=[],this.lastDrag=null,this.pointerCapture=null,this.eElement=e.eElement}},Cy=t=>{let e=t.target;return e instanceof Element?e:null},sY=class extends Br{constructor(){super(...arguments),this.beanName="dragAndDrop",this.dragSourceAndParamsList=[],this.dragItem=null,this.dragInitialSourcePointerOffsetX=0,this.dragInitialSourcePointerOffsetY=0,this.lastMouseEvent=null,this.lastDraggingEvent=null,this.dragSource=null,this.dragImageParent=null,this.dragImageCompPromise=null,this.dragImageComp=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0,this.dropTargets=[],this.lastDropTarget=null}addDragSource(t,e=!1){let i={capturePointer:!0,dragSource:t,eElement:t.eElement,dragStartPixels:t.dragStartPixels,onDragStart:n=>this.onDragStart(t,n),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),onDragCancel:this.onDragCancel.bind(this),includeTouch:e};this.dragSourceAndParamsList.push(i),this.beans.dragSvc.addDragSource(i)}setDragImageCompIcon(t,e=!1){let i=this.dragImageComp;i&&(e||this.dragImageLastIcon!==t)&&(this.dragImageLastIcon=t,i.setIcon(t,e))}removeDragSource(t){let{dragSourceAndParamsList:e,beans:i}=this,n=e.find(r=>r.dragSource===t);n&&(i.dragSvc?.removeDragSource(n),er(e,n))}destroy(){let{dragSourceAndParamsList:t,dropTargets:e,beans:i}=this,n=i.dragSvc;for(let r of t)n?.removeDragSource(r);t.length=0,e.length=0,this.clearDragAndDropProperties(),super.destroy()}nudge(){let t=this.lastMouseEvent;t&&this.onDragging(t,!0)}onDragStart(t,e){this.lastMouseEvent=e,this.dragSource=t,this.dragItem=t.getDragItem();let i=t.eElement.getBoundingClientRect();this.dragInitialSourcePointerOffsetX=e.clientX-i.left,this.dragInitialSourcePointerOffsetY=e.clientY-i.top,t.onDragStarted?.(),this.createAndUpdateDragImageComp(t)}onDragStop(t){let{dragSource:e,lastDropTarget:i}=this;if(e?.onDragStopped?.(),i){let n=this.dropTargetEvent(i,t,!1);i.onDragStop?.(n)}this.clearDragAndDropProperties()}onDragCancel(){let{dragSource:t,lastDropTarget:e,lastMouseEvent:i}=this;if(t?.onDragCancelled?.(),e&&i){let n=this.dropTargetEvent(e,i,!1);e.onDragCancel?.(n)}this.clearDragAndDropProperties()}onDragging(t,e=!1){this.positionDragImageComp(t);let i=this.findCurrentDropTarget(t),{lastDropTarget:n,dragSource:r,dragItem:o}=this,s=!1;if(i!==n){if(s=!0,n){let a=this.dropTargetEvent(n,t,e);n.onDragLeave?.(a)}if(n!==null&&!i?this.handleExit(r,o):n===null&&i&&this.handleEnter(r,o),i){let a=this.dropTargetEvent(i,t,e);i.onDragEnter?.(a)}this.lastDropTarget=i}else if(i){let a=this.dropTargetEvent(i,t,e);i.onDragging?.(a),a?.changed&&(s=!0)}this.lastMouseEvent=t,s&&this.updateDragImageComp()}clearDragAndDropProperties(){this.removeDragImageComp(this.dragImageComp),this.dragImageCompPromise=null,this.dragImageParent=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0,this.lastMouseEvent=null,this.lastDraggingEvent=null,this.lastDropTarget=null,this.dragItem=null,this.dragInitialSourcePointerOffsetX=0,this.dragInitialSourcePointerOffsetY=0,this.dragSource=null}getAllContainersFromDropTarget(t){let e=t.getSecondaryContainers?t.getSecondaryContainers():null,i=[[t.getContainer()]];return e?i.concat(e):i}isMouseOnDropTarget(t,e){let i=this.getAllContainersFromDropTarget(e),n=!1,r=(a,l)=>{for(let c of l){let{width:d,height:u,left:h,right:p,top:f,bottom:g}=c.getBoundingClientRect();if(d===0||u===0)return!1;let m=a.clientX>=h&&a.clientX<p,v=a.clientY>=f&&a.clientY<g;if(!m||!v)return!1}return!0};for(let a of i)if(r(t,a)){n=!0;break}let{eElement:o,type:s}=this.dragSource;return e.targetContainsSource&&!e.getContainer().contains(o)?!1:n&&e.isInterestedIn(s,o)}findCurrentDropTarget(t){let e=this.dropTargets.filter(o=>this.isMouseOnDropTarget(t,o)),i=e.length;if(i===0)return null;if(i===1)return e[0];let r=Tr(this.beans).elementsFromPoint(t.clientX,t.clientY);for(let o of r)for(let s of e)if(this.getAllContainersFromDropTarget(s).flatMap(l=>l).indexOf(o)!==-1)return s;return null}addDropTarget(t){this.dropTargets.push(t)}removeDropTarget(t){this.dropTargets=this.dropTargets.filter(e=>e.getContainer()!==t.getContainer())}hasExternalDropZones(){return this.dropTargets.some(t=>t.external)}findExternalZone(t){return this.dropTargets.find(e=>e.external&&e.getContainer()===t)||null}dropTargetEvent(t,e,i){let{dragSource:n,dragItem:r,lastDraggingEvent:o,lastMouseEvent:s,dragInitialSourcePointerOffsetX:a,dragInitialSourcePointerOffsetY:l}=this,c=t.getContainer(),d=c.getBoundingClientRect(),{clientX:u,clientY:h}=e,p=u-(s?.clientX||0),f=h-(s?.clientY||0),g=this.createEvent({event:e,x:u-d.left,y:h-d.top,vDirection:f>0?"down":f<0?"up":null,hDirection:p<0?"left":p>0?"right":null,initialSourcePointerOffsetX:a,initialSourcePointerOffsetY:l,dragSource:n,fromNudge:i,dragItem:r,dropZoneTarget:c,dropTarget:o?.dropTarget??null,changed:!!o?.changed});return this.lastDraggingEvent=g,g}positionDragImageComp(t){let e=this.dragImageComp?.getGui();e&&Zj(e,t,this.beans)}removeDragImageComp(t){this.dragImageComp===t&&(this.dragImageComp=null),t&&(t.getGui()?.remove(),this.destroyBean(t))}createAndUpdateDragImageComp(t){let e=this.createDragImageComp(t)??null;this.dragImageCompPromise=e,e?.then(i=>{if(e!==this.dragImageCompPromise||!this.lastMouseEvent||!this.isAlive()){this.destroyBean(i);return}this.dragImageCompPromise=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0;let n=this.dragImageComp;n!==i&&(this.dragImageComp=i,this.removeDragImageComp(n)),i&&(this.appendDragImageComp(i),this.updateDragImageComp())})}appendDragImageComp(t){let e=t.getGui(),i=e.style;i.position="absolute",i.zIndex="9999",this.beans.dragSvc?.hasPointerCapture()&&(i.pointerEvents="none"),this.gos.setInstanceDomData(e),this.beans.environment.applyThemeClasses(e),i.top="20px",i.left="20px";let n=SS(this.beans);this.dragImageParent=n,n?n.appendChild(e):this.warnNoBody()}updateDragImageComp(){let{dragImageComp:t,dragSource:e,lastDropTarget:i,lastDraggingEvent:n,dragImageLastLabel:r}=this;if(!t)return;this.setDragImageCompIcon(i?.getIconName?.(n)??null);let o=e?.dragItemName;typeof o=="function"&&(o=o(n)),o||(o=""),r!==o&&(this.dragImageLastLabel=o,t.setLabel(o))}};var aY=class extends sY{createEvent(t){return Ee(this.gos,t)}createDragImageComp(t){let{gos:e,beans:i}=this;return T$(i.userCompFactory,Ee(e,{dragSource:t}))?.newAgStackInstance()}handleEnter(t,e){t?.onGridEnter?.(e)}handleExit(t,e){t?.onGridExit?.(e)}warnNoBody(){K(54)}isDropZoneWithinThisGrid(t){return this.beans.ctrlsSvc.getGridBodyCtrl().eGridBody.contains(t.dropZoneTarget)}registerGridDropTarget(t,e){let i={getContainer:t,isInterestedIn:n=>n===1||n===0,getIconName:()=>"notAllowed"};this.addDropTarget(i),e.addDestroyFunc(()=>this.removeDropTarget(i))}};function BM(t,e){return t+"_"+e}function Ot(t){return t instanceof ph}var ph=class extends H{constructor(t,e,i,n){super(),this.providedColumnGroup=t,this.groupId=e,this.partId=i,this.pinned=n,this.isColumn=!1,this.displayedChildren=[],this.autoHeaderHeight=null,this.parent=null,this.colIdSanitised=Ku(this.getUniqueId())}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}getUniqueId(){return BM(this.groupId,this.partId)}isEmptyGroup(){return this.displayedChildren.length===0}isMoving(){let t=this.getProvidedColumnGroup().getLeafColumns();return!t||t.length===0?!1:t.every(e=>e.isMoving())}checkLeft(){for(let t of this.displayedChildren)Ot(t)&&t.checkLeft();if(this.displayedChildren.length>0)if(this.gos.get("enableRtl")){let e=dt(this.displayedChildren).getLeft();this.setLeft(e)}else{let t=this.displayedChildren[0].getLeft();this.setLeft(t)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(t){this.oldLeft=this.left,this.left!==t&&(this.left=t,this.dispatchLocalEvent({type:"leftChanged"}))}getPinned(){return this.pinned}getGroupId(){return this.groupId}getPartId(){return this.partId}getActualWidth(){let t=0;for(let e of this.displayedChildren??[])t+=e.getActualWidth();return t}isResizable(){if(!this.displayedChildren)return!1;let t=!1;for(let e of this.displayedChildren)e.isResizable()&&(t=!0);return t}getMinWidth(){let t=0;for(let e of this.displayedChildren)t+=e.getMinWidth();return t}addChild(t){this.children||(this.children=[]),this.children.push(t)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){let t=[];return this.addLeafColumns(t),t}getDisplayedLeafColumns(){let t=[];return this.addDisplayedLeafColumns(t),t}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(t){this.providedColumnGroup.setExpanded(t)}isAutoHeaderHeight(){return!!this.getColGroupDef()?.autoHeaderHeight}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(t){let e=t!==this.autoHeaderHeight;return this.autoHeaderHeight=t,e}addDisplayedLeafColumns(t){for(let e of this.displayedChildren??[])bs(e)?t.push(e):Ot(e)&&e.addDisplayedLeafColumns(t)}addLeafColumns(t){for(let e of this.children??[])bs(e)?t.push(e):Ot(e)&&e.addLeafColumns(t)}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){let t=this.getParent();return!this.isPadding()||!t?.isPadding()?0:1+t.getPaddingLevel()}calculateDisplayedColumns(){this.displayedChildren=[];let t=this;for(;t?.isPadding();)t=t.getParent();if(!(t?t.getProvidedColumnGroup().isExpandable():!1)){this.displayedChildren=this.children,this.dispatchLocalEvent({type:"displayedChildrenChanged"});return}for(let i of this.children??[]){if(Ot(i)&&!i.displayedChildren?.length)continue;switch(i.getColumnGroupShow()){case"open":t.getProvidedColumnGroup().isExpanded()&&this.displayedChildren.push(i);break;case"closed":t.getProvidedColumnGroup().isExpanded()||this.displayedChildren.push(i);break;default:this.displayedChildren.push(i);break}}this.dispatchLocalEvent({type:"displayedChildrenChanged"})}},rS="row-group-",WS="t-",US="b-",lY=0,ys=class{constructor(t){this.master=!1,this.detail=void 0,this.rowIndex=null,this.key=null,this.sourceRowIndex=-1,this._leafs=void 0,this.childrenMapped=null,this.treeParent=null,this.treeNodeFlags=0,this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=lY++,this.alreadyRendered=!1,this.hovered=!1,this.__selected=!1,this.beans=t}get allLeafChildren(){let t=this._leafs;return t===void 0?this.beans.groupStage?.loadLeafs?.(this)??null:t}set allLeafChildren(t){this._leafs=t}setData(t){this.setDataCommon(t,!1)}updateData(t){this.setDataCommon(t,!0)}setDataCommon(t,e){let{valueCache:i,eventSvc:n}=this.beans,r=this.data;this.data=t,i?.onDataChanged(),this.updateDataOnDetailNode(),this.resetQuickFilterAggregateText();let o=this.createDataChangedEvent(t,r,e);if(this.__localEventService?.dispatchEvent(o),this.sibling){this.sibling.data=t;let a=this.sibling.createDataChangedEvent(t,r,e);this.sibling.__localEventService?.dispatchEvent(a)}n.dispatchEvent({type:"rowNodeDataChanged",node:this});let s=this.pinnedSibling;s&&(s.data=t,s.__localEventService?.dispatchEvent(s.createDataChangedEvent(t,r,e)),n.dispatchEvent({type:"rowNodeDataChanged",node:s}))}updateDataOnDetailNode(){let t=this.detailNode;t&&(t.data=this.data)}createDataChangedEvent(t,e,i){return{type:"dataChanged",node:this,oldData:e,newData:t,update:i}}getRowIndexString(){return this.rowIndex==null?(at(13),null):this.rowPinned==="top"?WS+this.rowIndex:this.rowPinned==="bottom"?US+this.rowIndex:this.rowIndex.toString()}setDataAndId(t,e){let{selectionSvc:i}=this.beans,n=i?.createDaemonNode?.(this),r=this.data;this.data=t,this.updateDataOnDetailNode(),this.setId(e),i&&(i.updateRowSelectable(this),i.syncInRowNode(this,n));let o=this.createDataChangedEvent(t,r,!1);this.__localEventService?.dispatchEvent(o)}setId(t){let e=pc(this.beans.gos);if(e)if(this.data){let i=this.parent?.getRoute()??[];this.id=e({data:this.data,parentKeys:i.length>0?i:void 0,level:this.level,rowPinned:this.rowPinned}),this.id.startsWith(rS)&&at(14,{groupPrefix:rS})}else this.id=void 0;else this.id=t}setRowTop(t){if(this.oldRowTop=this.rowTop,this.rowTop===t)return;this.rowTop=t,this.dispatchRowEvent("topChanged");let e=t!==null;this.displayed!==e&&(this.displayed=e,this.dispatchRowEvent("displayedChanged"))}clearRowTopAndRowIndex(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}setHovered(t){this.hovered=t}isHovered(){return this.hovered}setRowHeight(t,e=!1){this.rowHeight=t,this.rowHeightEstimated=e,this.dispatchRowEvent("heightChanged")}setExpanded(t,e,i){this.beans.expansionSvc?.setExpanded(this,t,e,i)}setDataValue(t,e,i){let{colModel:n,valueSvc:r,gos:o,editSvc:s}=this.beans,a=typeof t!="string"?t:n.getCol(t)??n.getColDefCol(t);if(!a)return!1;let l=r.getValueForDisplay(a,this,void 0,void 0,"api").value;if(o.get("readOnlyEdit")){let{beans:{eventSvc:d},data:u,rowIndex:h,rowPinned:p}=this;return d.dispatchEvent({type:"cellEditRequest",event:null,rowIndex:h,rowPinned:p,column:a,colDef:a.colDef,data:u,node:this,oldValue:l,newValue:e,value:e,source:i}),!1}if(s&&!s.committing){let d=s.setDataValue({rowNode:this,column:a},e,i);if(d!=null)return d}let c=r.setValue(this,a,e,i);return this.dispatchCellChangedEvent(a,e,l),c&&this.pinnedSibling?.dispatchCellChangedEvent(a,e,l),c}updateHasChildren(){let t=this.group&&!this.footer||!!this.childrenAfterGroup?.length,{rowChildrenSvc:e}=this.beans;e&&(t=e.getHasChildrenValue(this)),t!==this.__hasChildren&&(this.__hasChildren=!!t,this.dispatchRowEvent("hasChildrenChanged"))}hasChildren(){return this.__hasChildren==null&&this.updateHasChildren(),this.__hasChildren}dispatchCellChangedEvent(t,e,i){let n={type:"cellChanged",node:this,column:t,newValue:e,oldValue:i};this.__localEventService?.dispatchEvent(n)}resetQuickFilterAggregateText(){this.quickFilterAggregateText=null}isExpandable(){return this.beans.expansionSvc?.isExpandable(this)??!1}isSelected(){if(this.footer)return this.sibling.isSelected();let t=this.rowPinned&&this.pinnedSibling;return t?t.isSelected():this.__selected}depthFirstSearch(t){let e=this.childrenAfterGroup;if(e)for(let i=0,n=e.length;i<n;++i)e[i].depthFirstSearch(t);t(this)}dispatchRowEvent(t){this.__localEventService?.dispatchEvent({type:t,node:this})}setSelected(t,e=!1,i="api"){this.beans.selectionSvc?.setNodesSelected({nodes:[this],newValue:t,clearSelection:e,source:i})}isRowPinned(){return!!this.rowPinned}__addEventListener(t,e){(this.__localEventService??(this.__localEventService=new ka)).addEventListener(t,e)}__removeEventListener(t,e){this.removeLocalListener(t,e)}addEventListener(t,e){this.beans.validation?.checkRowEvents(t);let i=this.__localEventService??(this.__localEventService=new ka);this.frameworkEventListenerService=this.beans.frameworkOverrides.createLocalEventListenerWrapper?.(this.frameworkEventListenerService,i);let n=this.frameworkEventListenerService?.wrap(t,e)??e;i.addEventListener(t,n)}removeEventListener(t,e){let i=this.frameworkEventListenerService?.unwrap(t,e)??e;this.removeLocalListener(t,i)}removeLocalListener(t,e){let i=this.__localEventService;i&&(i.removeEventListener(t,e),i.noRegisteredListenersExist()&&(this.__localEventService=null))}isFullWidthCell(){if(K(61),this.detail)return!0;let t=this.beans.gos.getCallback("isFullWidthRow");return t?t({rowNode:this}):!1}getRoute(){if(this.level===-1)return[];if(this.key==null)return;let t=[],e=this;for(;e?.key!=null;)t.push(e.key),e=e.parent;return t.reverse()}setRowIndex(t){this.rowIndex!==t&&(this.rowIndex=t,this.dispatchRowEvent("rowIndexChanged"))}setAllChildrenCount(t){this.allChildrenCount!==t&&(this.allChildrenCount=t,this.dispatchRowEvent("allChildrenCountChanged"))}setUiLevel(t){this.uiLevel!==t&&(this.uiLevel=t,this.dispatchRowEvent("uiLevelChanged"))}getFirstChild(){let t=this.childStore;return t?t.getFirstNode():this.childrenAfterSort?.[0]??null}};function cY(t,e,i){return Ee(e,{type:i,node:t,data:t.data,rowIndex:t.rowIndex,rowPinned:t.rowPinned})}var dY=new Set(["__autoHeights","__checkAutoHeightsDebounced","__localEventService","__objectId","_leafs","childStore","oldRowTop","sticky","treeNodeFlags","treeParent"]),uY=(t,e)=>{let i=new ys(e);for(let n of Object.keys(t))dY.has(n)||(i[n]=t[n]);return i.oldRowTop=null,i},HM=t=>{for(;t?.length;){let e=t[0];if(e.data)return e;t=e.childrenAfterGroup}},zM={agSetColumnFilter:"agSetColumnFilterHandler",agMultiColumnFilter:"agMultiColumnFilterHandler",agGroupColumnFilter:"agGroupColumnFilterHandler",agNumberColumnFilter:"agNumberColumnFilterHandler",agDateColumnFilter:"agDateColumnFilterHandler",agTextColumnFilter:"agTextColumnFilterHandler"},hY=new Set(Object.values(zM));function us(t,e){let i=t.filterUi;if(!i)return null;if(i.created)return i.promise;if(e)return null;let n=i.create(i.refreshed),r=i;return r.created=!0,r.promise=n,n}function pY(t,e,i,n,r,o,s){return e.refresh?.(k(w({},i),{model:n,source:o,additionalEventAttributes:s})),t().then(a=>{if(a){let{filter:l,filterParams:c}=a;VM(l,c,n,r,o,s)}})}function VM(t,e,i,n,r,o){t?.refresh?.(k(w({},e),{model:i,state:n,source:r,additionalEventAttributes:o}))}function GM(t,e,i){let n=t();n?.created&&n.promise.then(r=>{let o=e();VM(r,n.filterParams,o,i()??{model:o},"ui")})}function vT(t,e,i,n,r,o,s){let a,l=!1,c;switch(t){case"apply":{let d=n();c=d?.model??null,s&&(c=s(c)),a={state:d?.state,model:c},l=!0;break}case"clear":{a={model:null};break}case"reset":{a={model:null},l=!0,c=null;break}case"cancel":{a={model:i()};break}}r(a),l?o(c):GM(e,i,n)}function ni(t,e){return t[e]??null}function Nt(t){return Ch(t)}function fY(t){return{tag:"div",cls:t}}var gY=class extends et{constructor(t){let{className:e="ag-filter-apply-panel"}=t??{};super(fY(e)),this.listeners=[],this.validationMessage=null,this.className=e}updateButtons(t,e){let i=this.buttons;if(this.buttons=t,i===t)return;let n=this.getGui();hi(n);let r;this.destroyListeners();let o=document.createDocumentFragment(),s=this.className,a=({type:c,label:d})=>{let u=v=>{this.dispatchLocalEvent({type:c,event:v})};["apply","clear","reset","cancel"].includes(c)||K(75);let h=c==="apply",f=Nt({tag:"button",attrs:{type:h&&e?"submit":"button"},ref:`${c}FilterButton`,cls:`ag-button ag-standard-button ${s}-button${h?" "+s+"-apply-button":""}`,children:d});this.activateTabIndex([f]),h&&(r=f);let g=v=>{v.key===A.ENTER&&(v.preventDefault(),u(v))},m=this.listeners;f.addEventListener("click",u),m.push(()=>f.removeEventListener("click",u)),f.addEventListener("keydown",g),m.push(()=>f.removeEventListener("keydown",g)),o.append(f)};for(let c of t)a(c);this.eApply=r;let l=this.validationTooltipFeature;r&&!l?this.validationTooltipFeature=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.eApply,getLocation:()=>"advancedFilter",getTooltipShowDelayOverride:()=>1e3})):!r&&l&&(this.validationTooltipFeature=this.destroyBean(l)),n.append(o)}getApplyButton(){return this.eApply}updateValidity(t,e=null){let i=this.eApply;i&&(sh(i,t===!1),this.validationMessage=e??null,this.validationTooltipFeature?.setTooltipAndRefresh(this.validationMessage))}destroyListeners(){for(let t of this.listeners)t();this.listeners=[]}destroy(){this.destroyListeners(),super.destroy()}};var mY={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose one",equals:"Equals",notEqual:"Does not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"Between",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equal to",greaterThanOrEqual:"Greater than or equal to",contains:"Contains",notContains:"Does not contain",startsWith:"Begins with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",before:"Before",after:"After",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd",filterSummaryInactive:"is (All)",filterSummaryContains:"contains",filterSummaryNotContains:"does not contain",filterSummaryTextEquals:"equals",filterSummaryTextNotEqual:"does not equal",filterSummaryStartsWith:"begins with",filterSummaryEndsWith:"ends with",filterSummaryBlank:"is blank",filterSummaryNotBlank:"is not blank",filterSummaryEquals:"=",filterSummaryNotEqual:"!=",filterSummaryGreaterThan:">",filterSummaryGreaterThanOrEqual:">=",filterSummaryLessThan:"<",filterSummaryLessThanOrEqual:"<=",filterSummaryInRange:"between",filterSummaryInRangeValues:t=>`(${t[0]}, ${t[1]})`,filterSummaryTextQuote:t=>`"${t[0]}"`};function ms(t,e,i){return tq(t,mY,e,i)}function jS(t,e){let{debounceMs:i}=t;return Gm(t)?(i!=null&&K(71),0):i??e}function Gm(t){return(t.buttons?.indexOf("apply")??-1)>=0}var vY=class extends et{constructor(t,e,i,n,r,o){super(),this.column=t,this.wrapper=e,this.eventParent=i,this.updateModel=n,this.isGlobalButtons=r,this.enableGlobalButtonCheck=o,this.hidePopup=null,this.applyActive=!1}postConstruct(){let{comp:t,params:e}=this.wrapper,i=e,n=i.useForm,r=n?"form":"div";this.setTemplate({tag:r,cls:"ag-filter-wrapper"}),n&&this.addManagedElementListeners(this.getGui(),{submit:o=>{o?.preventDefault()},keydown:this.handleKeyDown.bind(this)}),this.appendChild(t.getGui()),this.params=i,this.resetButtonsPanel(i),this.addManagedListeners(this.eventParent,w({filterParamsChanged:({column:o,params:s})=>{o===this.column&&this.resetButtonsPanel(s,this.params)},filterStateChanged:({column:o,state:s})=>{o===this.column&&this.eButtons?.updateValidity(s.valid!==!1)},filterAction:({column:o,action:s,event:a})=>{o===this.column&&this.afterAction(s,a)}},this.enableGlobalButtonCheck?{filterGlobalButtons:({isGlobal:o})=>{if(o!==this.isGlobalButtons){this.isGlobalButtons=o;let s=this.params;this.resetButtonsPanel(s,s,!0)}}}:void 0))}afterGuiAttached(t){t&&(this.hidePopup=t.hidePopup)}resetButtonsPanel(t,e,i){let{buttons:n,readOnly:r}=e??{},{buttons:o,readOnly:s,useForm:a}=t;if(!i&&r===s&&rh(n,o))return;let l=o&&o.length>0&&!t.readOnly&&!this.isGlobalButtons,c=this.eButtons;if(l){let d=o.map(u=>{let h=`${u}Filter`;return{type:u,label:ms(this,h)}});if(this.applyActive=Gm(this.params),!c){c=this.createBean(new gY),this.appendChild(c.getGui());let u=this.column,h=p=>({event:f})=>{this.updateModel(u,p,{fromButtons:!0}),this.afterAction(p,f)};c?.addManagedListeners(c,{apply:h("apply"),clear:h("clear"),reset:h("reset"),cancel:h("cancel")}),this.eButtons=c}c.updateButtons(d,a)}else this.applyActive=!1,c&&(Xi(c.getGui()),this.eButtons=this.destroyBean(c))}close(t){let e=this.hidePopup;if(!e)return;let i=t,n=i?.key,r;(n===A.ENTER||n===A.SPACE)&&(r={keyboardEvent:i}),e(r),this.hidePopup=null}afterAction(t,e){let{params:i,applyActive:n}=this,r=i?.closeOnApply;switch(t){case"apply":{e?.preventDefault(),r&&n&&this.close(e);break}case"reset":{r&&n&&this.close();break}case"cancel":{r&&this.close(e);break}}}handleKeyDown(t){!t.defaultPrevented&&t.key===A.ENTER&&this.applyActive&&(this.updateModel(this.column,"apply",{fromButtons:!0}),this.afterAction("apply",t))}destroy(){this.hidePopup=null,this.eButtons=this.destroyBean(this.eButtons)}},CY={tag:"div",cls:"ag-filter"},wY=class extends et{constructor(t,e,i){super(CY),this.column=t,this.source=e,this.enableGlobalButtonCheck=i,this.wrapper=null}postConstruct(){this.beans.colFilter?.activeFilterComps.add(this),this.createFilter(!0),this.addManagedEventListeners({filterDestroyed:this.onFilterDestroyed.bind(this)})}hasFilter(){return this.wrapper!=null}getFilter(){return this.wrapper?.then(t=>t.comp)??null}afterInit(){return this.wrapper?.then(()=>{})??Et.resolve()}afterGuiAttached(t){this.afterGuiAttachedParams=t,this.wrapper?.then(e=>{this.comp?.afterGuiAttached(t),e?.comp?.afterGuiAttached?.(t)})}afterGuiDetached(){this.wrapper?.then(t=>{t?.comp?.afterGuiDetached?.()})}createFilter(t){let{column:e,source:i,beans:{colFilter:n}}=this,r=n.getFilterUiForDisplay(e)??null;this.wrapper=r,r?.then(o=>{if(!o)return;let{isHandler:s,comp:a}=o,l;if(s){let c=!!this.enableGlobalButtonCheck,d=this.createBean(new vY(e,o,n,n.updateModel.bind(n),c&&n.isGlobalButtons,c));this.comp=d,l=d.getGui()}else l=a.getGui(),ae(l)||K(69,{guiFromFilter:l});this.appendChild(l),t?this.eventSvc.dispatchEvent({type:"filterOpened",column:e,source:i,eGui:this.getGui()}):a.afterGuiAttached?.(this.afterGuiAttachedParams)})}onFilterDestroyed(t){let{source:e,column:i}=t;(e==="api"||e==="paramsUpdated")&&i.getId()===this.column.getId()&&this.beans.colModel.getColDefCol(this.column)&&(hi(this.getGui()),this.comp=this.destroyBean(this.comp),this.createFilter())}destroy(){this.beans.colFilter?.activeFilterComps.delete(this),this.eventSvc.dispatchEvent({type:"filterClosed",column:this.column}),this.wrapper=null,this.comp=this.destroyBean(this.comp),this.afterGuiAttachedParams=void 0,super.destroy()}},CT={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},wT=["january","february","march","april","may","june","july","august","september","october","november","december"];function bY(t,e){return t==null?-1:e==null?1:Number.parseFloat(t)-Number.parseFloat(e)}function bT(t){return t instanceof Date&&!isNaN(t.getTime())}var oS={number:()=>{},boolean:()=>({maxNumConditions:1,debounceMs:0,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:(t,e)=>e,numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:(t,e)=>e===!1,numberOfInputs:0}]}),date:()=>({isValidDate:bT}),dateString:({dataTypeDefinition:t})=>({comparator:(e,i)=>{let n=t.dateParser(i);return i==null||n<e?-1:n>e?1:0},isValidDate:e=>typeof e=="string"&&bT(t.dateParser(e))}),dateTime:t=>oS.date(t),dateTimeString:t=>oS.dateString(t),object:()=>{},text:()=>{}},sS={number:()=>({comparator:bY}),boolean:({t})=>({valueFormatter:e=>ae(e.value)?t(String(e.value),e.value?"True":"False"):t("blanks","(Blanks)")}),date:({formatValue:t,t:e})=>({valueFormatter:i=>{let n=t(i);return ae(n)?n:e("blanks","(Blanks)")},treeList:!0,treeListFormatter:(i,n)=>{if(i==="NaN")return e("invalidDate","Invalid Date");if(n===1&&i!=null){let r=wT[Number(i)-1];return e(r,CT[r])}return i??e("blanks","(Blanks)")},treeListPathGetter:i=>jg(i,!1)}),dateString:({formatValue:t,dataTypeDefinition:e,t:i})=>({valueFormatter:n=>{let r=t(n);return ae(r)?r:i("blanks","(Blanks)")},treeList:!0,treeListPathGetter:n=>jg(e.dateParser(n??void 0),!1),treeListFormatter:(n,r)=>{if(r===1&&n!=null){let o=wT[Number(n)-1];return i(o,CT[o])}return n??i("blanks","(Blanks)")}}),dateTime:t=>{let e=sS.date(t);return e.treeListPathGetter=jg,e},dateTimeString(t){let e=t.dataTypeDefinition.dateParser,i=sS.dateString(t);return i.treeListPathGetter=n=>jg(e(n??void 0)),i},object:({formatValue:t,t:e})=>({valueFormatter:i=>{let n=t(i);return ae(n)?n:e("blanks","(Blanks)")}}),text:()=>{}};function yY(t,e,i,n,r,o,s){let a=e,l=i,c=t==="agSetColumnFilter";!l&&n.baseDataType==="object"&&!c&&(l=({column:p,node:f})=>r({column:p,node:f,value:o.valueSvc.getValue(p,f)}));let u=(c?sS:oS)[n.baseDataType],h=u({dataTypeDefinition:n,formatValue:r,t:s});return a=typeof e=="object"?w(w({},h),e):h,{filterParams:a,filterValueGetter:l}}var SY={boolean:"agTextColumnFilter",date:"agDateColumnFilter",dateString:"agDateColumnFilter",dateTime:"agDateColumnFilter",dateTimeString:"agDateColumnFilter",number:"agNumberColumnFilter",object:"agTextColumnFilter",text:"agTextColumnFilter"},xY={boolean:"agTextColumnFloatingFilter",date:"agDateColumnFloatingFilter",dateString:"agDateColumnFloatingFilter",dateTime:"agDateColumnFloatingFilter",dateTimeString:"agDateColumnFloatingFilter",number:"agNumberColumnFloatingFilter",object:"agTextColumnFloatingFilter",text:"agTextColumnFloatingFilter"};function EY(t,e=!1){return(e?xY:SY)[t??"text"]}var WM="ag-resizer-wrapper",hs=(t,e)=>({tag:"div",ref:`${t}Resizer`,cls:`ag-resizer ag-resizer-${e}`}),PY={tag:"div",cls:WM,children:[hs("eTopLeft","topLeft"),hs("eTop","top"),hs("eTopRight","topRight"),hs("eRight","right"),hs("eBottomRight","bottomRight"),hs("eBottom","bottom"),hs("eBottomLeft","bottomLeft"),hs("eLeft","left")]},RY=class extends H{constructor(t,e){super(),this.element=t,this.dragStartPosition={x:0,y:0},this.position={x:0,y:0},this.lastSize={width:-1,height:-1},this.positioned=!1,this.resizersAdded=!1,this.resizeListeners=[],this.boundaryEl=null,this.isResizing=!1,this.isMoving=!1,this.resizable={},this.movable=!1,this.currentResizer=null,this.config=Object.assign({},{popup:!1},e)}wireBeans(t){this.popupSvc=t.popupSvc,this.dragSvc=t.dragSvc}center(t){let{clientHeight:e,clientWidth:i}=this.offsetParent,n=i/2-this.getWidth()/2,r=e/2-this.getHeight()/2;this.offsetElement(n,r,t)}initialisePosition(t){if(this.positioned)return;let{centered:e,forcePopupParentAsOffsetParent:i,minWidth:n,width:r,minHeight:o,height:s,x:a,y:l}=this.config;this.offsetParent||this.setOffsetParent();let c=0,d=0,u=Nr(this.element);if(u){let h=this.findBoundaryElement(),p=window.getComputedStyle(h);if(p.minWidth!=null){let f=h.offsetWidth-this.element.offsetWidth;d=Number.parseInt(p.minWidth,10)-f}if(p.minHeight!=null){let f=h.offsetHeight-this.element.offsetHeight;c=Number.parseInt(p.minHeight,10)-f}}if(this.minHeight=o||c,this.minWidth=n||d,r&&this.setWidth(r),s&&this.setHeight(s),(!r||!s)&&this.refreshSize(),e)this.center(t);else if(a||l)this.offsetElement(a,l,t);else if(u&&i){let h=this.boundaryEl,p=!0;if(h||(h=this.findBoundaryElement(),p=!1),h){let f=Number.parseFloat(h.style.top),g=Number.parseFloat(h.style.left);p?this.offsetElement(isNaN(g)?0:g,isNaN(f)?0:f,t):this.setPosition(g,f)}}this.positioned=!!this.offsetParent}isPositioned(){return this.positioned}getPosition(){return this.position}setMovable(t,e){if(!this.config.popup||t===this.movable)return;this.movable=t;let i=this.moveElementDragListener||{eElement:e,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};t?(this.dragSvc?.addDragSource(i),this.moveElementDragListener=i):(this.dragSvc?.removeDragSource(i),this.moveElementDragListener=void 0)}setResizable(t){if(this.clearResizeListeners(),t?this.addResizers():this.removeResizers(),typeof t=="boolean"){if(t===!1)return;t={topLeft:t,top:t,topRight:t,right:t,bottomRight:t,bottom:t,bottomLeft:t,left:t}}Object.keys(t).forEach(e=>{let n=!!t[e],r=this.getResizerElement(e),o={dragStartPixels:0,eElement:r,onDragStart:s=>this.onResizeStart(s,e),onDragging:this.onResize.bind(this),onDragStop:s=>this.onResizeEnd(s,e)};(n||!this.isAlive()&&!n)&&(n?(this.dragSvc?.addDragSource(o),this.resizeListeners.push(o),r.style.pointerEvents="all"):r.style.pointerEvents="none",this.resizable[e]=n)})}removeSizeFromEl(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}restoreLastSize(){this.element.style.flex="0 0 auto";let{height:t,width:e}=this.lastSize;e!==-1&&(this.element.style.width=`${e}px`),t!==-1&&(this.element.style.height=`${t}px`)}getHeight(){return this.element.offsetHeight}setHeight(t){let{popup:e}=this.config,i=this.element,n=!1;if(typeof t=="string"&&t.includes("%"))Xu(i,t),t=ED(i),n=!0;else if(t=Math.max(this.minHeight,t),this.positioned){let r=this.getAvailableHeight();r&&t>r&&(t=r)}this.getHeight()!==t&&(n?(i.style.maxHeight="unset",i.style.minHeight="unset"):e?Xu(i,t):(i.style.height=`${t}px`,i.style.flex="0 0 auto",this.lastSize.height=typeof t=="number"?t:Number.parseFloat(t)))}getAvailableHeight(){let{popup:t,forcePopupParentAsOffsetParent:e}=this.config;this.positioned||this.initialisePosition();let{clientHeight:i}=this.offsetParent;if(!i)return null;let n=this.element.getBoundingClientRect(),r=this.offsetParent.getBoundingClientRect(),o=t?this.position.y:n.top,s=t?0:r.top,a=0;if(e){let c=this.element.parentElement;if(c){let{bottom:d}=c.getBoundingClientRect();a=d-n.bottom}}return i+s-o-a}getWidth(){return this.element.offsetWidth}setWidth(t){let e=this.element,{popup:i}=this.config,n=!1;if(typeof t=="string"&&t.includes("%"))Ar(e,t),t=gm(e),n=!0;else if(this.positioned){t=Math.max(this.minWidth,t);let{clientWidth:r}=this.offsetParent,o=i?this.position.x:this.element.getBoundingClientRect().left;r&&t+o>r&&(t=r-o)}this.getWidth()!==t&&(n?(e.style.maxWidth="unset",e.style.minWidth="unset"):this.config.popup?Ar(e,t):(e.style.width=`${t}px`,e.style.flex=" unset",this.lastSize.width=typeof t=="number"?t:Number.parseFloat(t)))}offsetElement(t=0,e=0,i){let{forcePopupParentAsOffsetParent:n}=this.config,r=n?this.boundaryEl:this.element;r&&(this.popupSvc?.positionPopup({ePopup:r,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:()=>({x:t,y:e}),postProcessCallback:i}),this.setPosition(Number.parseFloat(r.style.left),Number.parseFloat(r.style.top)))}constrainSizeToAvailableHeight(t){if(!this.config.forcePopupParentAsOffsetParent)return;let e=()=>{let i=this.getAvailableHeight();this.element.style.setProperty("max-height",`${i}px`)};t&&this.popupSvc?(this.resizeObserverSubscriber?.(),this.resizeObserverSubscriber=Ss(this.beans,this.popupSvc?.getPopupParent(),e)):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}setPosition(t,e){this.position.x=t,this.position.y=e}updateDragStartPosition(t,e){this.dragStartPosition={x:t,y:e}}calculateMouseMovement(t){let{e,isLeft:i,isTop:n,anywhereWithin:r,topBuffer:o}=t,s=e.clientX-this.dragStartPosition.x,a=e.clientY-this.dragStartPosition.y,l=this.shouldSkipX(e,!!i,!!r,s)?0:s,c=this.shouldSkipY(e,!!n,o,a)?0:a;return{movementX:l,movementY:c}}shouldSkipX(t,e,i,n){let r=this.element.getBoundingClientRect(),o=this.offsetParent.getBoundingClientRect(),s=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.x:r.left,l=a<=0&&o.left>=t.clientX||o.right<=t.clientX&&o.right<=s.right;return l?!0:(e?l=n<0&&t.clientX>a+o.left||n>0&&t.clientX<a+o.left:i?l=n<0&&t.clientX>s.right||n>0&&t.clientX<a+o.left:l=n<0&&t.clientX>s.right||n>0&&t.clientX<s.right,l)}shouldSkipY(t,e,i=0,n){let r=this.element.getBoundingClientRect(),o=this.offsetParent.getBoundingClientRect(),s=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.y:r.top,l=a<=0&&o.top>=t.clientY||o.bottom<=t.clientY&&o.bottom<=s.bottom;return l?!0:(e?l=n<0&&t.clientY>a+o.top+i||n>0&&t.clientY<a+o.top:l=n<0&&t.clientY>s.bottom||n>0&&t.clientY<s.bottom,l)}createResizeMap(){let t=e=>({element:this.element.querySelector(`[data-ref=${e}Resizer]`)});this.resizerMap={topLeft:t("eTopLeft"),top:t("eTop"),topRight:t("eTopRight"),right:t("eRight"),bottomRight:t("eBottomRight"),bottom:t("eBottom"),bottomLeft:t("eBottomLeft"),left:t("eLeft")}}addResizers(){if(this.resizersAdded)return;let t=this.element;t&&(t.appendChild(Nt(PY)),this.createResizeMap(),this.resizersAdded=!0)}removeResizers(){this.resizerMap=void 0,this.element.querySelector(`.${WM}`)?.remove(),this.resizersAdded=!1}getResizerElement(t){return this.resizerMap[t].element}onResizeStart(t,e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!e.match(/top/i),isRight:!!e.match(/right/i),isBottom:!!e.match(/bottom/i),isLeft:!!e.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[e].element.classList.add("ag-active");let{popup:i,forcePopupParentAsOffsetParent:n}=this.config;!i&&!n&&this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(t.clientX,t.clientY)}getSiblings(){let e=this.element.parentElement;return e?Array.prototype.slice.call(e.children).filter(i=>!i.classList.contains("ag-hidden")):null}getMinSizeOfSiblings(){let t=this.getSiblings()||[],e=0,i=0;for(let n=0;n<t.length;n++){let r=t[n],o=!!r.style.flex&&r.style.flex!=="0 0 auto";if(r===this.element)continue;let s=this.minHeight||0,a=this.minWidth||0;if(o){let l=window.getComputedStyle(r);l.minHeight&&(s=Number.parseInt(l.minHeight,10)),l.minWidth&&(a=Number.parseInt(l.minWidth,10))}else s=r.offsetHeight,a=r.offsetWidth;e+=s,i+=a}return{height:e,width:i}}applySizeToSiblings(t){let e=null,i=this.getSiblings();if(i){for(let n=0;n<i.length;n++){let r=i[n];r!==e&&(t?r.style.height=`${r.offsetHeight}px`:r.style.width=`${r.offsetWidth}px`,r.style.flex="0 0 auto",r===this.element&&(e=i[n+1]))}e&&(e.style.removeProperty("height"),e.style.removeProperty("min-height"),e.style.removeProperty("max-height"),e.style.flex="1 1 auto")}}isResizable(){return Object.values(this.resizable).some(t=>t)}onResize(t){if(!this.isResizing||!this.currentResizer)return;let{popup:e,forcePopupParentAsOffsetParent:i}=this.config,{isTop:n,isRight:r,isBottom:o,isLeft:s}=this.currentResizer,a=r||s,l=o||n,{movementX:c,movementY:d}=this.calculateMouseMovement({e:t,isLeft:s,isTop:n}),u=this.position.x,h=this.position.y,p=0,f=0;if(a&&c){let g=s?-1:1,m=this.getWidth(),v=m+c*g,C=!1;s&&(p=m-v,(u+p<=0||v<=this.minWidth)&&(C=!0,p=0)),C||this.setWidth(v)}if(l&&d){let g=n?-1:1,m=this.getHeight(),v=m+d*g,C=!1;n?(f=m-v,(h+f<=0||v<=this.minHeight)&&(C=!0,f=0)):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&m<v&&this.getMinSizeOfSiblings().height+v>this.element.parentElement.offsetHeight&&(C=!0),C||this.setHeight(v)}this.updateDragStartPosition(t.clientX,t.clientY),((e||i)&&p||f)&&this.offsetElement(u+p,h+f)}onResizeEnd(t,e){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null,this.element.classList.remove("ag-resizing"),this.resizerMap[e].element.classList.remove("ag-active"),this.dispatchLocalEvent({type:"resize"})}refreshSize(){let t=this.element;this.config.popup&&(this.config.width||this.setWidth(t.offsetWidth),this.config.height||this.setHeight(t.offsetHeight))}onMoveStart(t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(t.clientX,t.clientY)}onMove(t){if(!this.isMoving)return;let{x:e,y:i}=this.position,n;this.config.calculateTopBuffer&&(n=this.config.calculateTopBuffer());let{movementX:r,movementY:o}=this.calculateMouseMovement({e:t,isTop:!0,anywhereWithin:!0,topBuffer:n});this.offsetElement(e+r,i+o),this.updateDragStartPosition(t.clientX,t.clientY)}onMoveEnd(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}setOffsetParent(){this.config.forcePopupParentAsOffsetParent&&this.popupSvc?this.offsetParent=this.popupSvc.getPopupParent():this.offsetParent=this.element.offsetParent}findBoundaryElement(){let t=this.element;for(;t;){if(window.getComputedStyle(t).position!=="static")return t;t=t.parentElement}return this.element}clearResizeListeners(){for(;this.resizeListeners.length;){let t=this.resizeListeners.pop();this.dragSvc?.removeDragSource(t)}}destroy(){super.destroy(),this.moveElementDragListener&&this.dragSvc?.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}},UM="__ag_Grid_Stop_Propagation";function Da(t){t[UM]=!0}function yo(t){return t[UM]===!0}var _Y="ag-focus-managed",bc=class extends H{constructor(t,e={}){super(),this.eFocusable=t,this.callbacks=e,this.callbacks=w({shouldStopEventPropagation:()=>!1,onTabKeyDown:i=>{if(i.defaultPrevented)return;let n=Oa(this.beans,this.eFocusable,!1,i.shiftKey);n&&(n.focus(),i.preventDefault())}},e)}postConstruct(){let{eFocusable:t,callbacks:{onFocusIn:e,onFocusOut:i}}=this;t.classList.add(_Y),this.addKeyDownListeners(t),e&&this.addManagedElementListeners(t,{focusin:e}),i&&this.addManagedElementListeners(t,{focusout:i})}addKeyDownListeners(t){this.addManagedElementListeners(t,{keydown:e=>{if(e.defaultPrevented||yo(e))return;let{callbacks:i}=this;if(i.shouldStopEventPropagation(e)){Da(e);return}e.key===A.TAB?i.onTabKeyDown(e):i.handleKeyDown&&i.handleKeyDown(e)}})}},kY=class extends et{constructor(t,e){super(),this.filterNameKey=t,this.cssIdentifier=e,this.applyActive=!1,this.debouncePending=!1,this.defaultDebounceMs=0}postConstruct(){let t={tag:"div",cls:`ag-filter-body-wrapper ag-${this.cssIdentifier}-body-wrapper`,children:[this.createBodyTemplate()]};this.setTemplate(t,this.getAgComponents()),this.createManagedBean(new bc(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=this.createBean(new RY(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}))}handleKeyDown(t){}init(t){let e=t;this.setParams(e),this.setModelIntoUi(e.state.model,!0).then(()=>this.updateUiVisibility())}refresh(t){let e=t,i=this.params;this.params=e,e.source==="colDef"&&this.updateParams(e,i);let r=e.state,o=this.state;return this.state=r,(r.model!==o.model||r.state!==o.state)&&this.setModelIntoUi(r.model),!0}setParams(t){this.params=t,this.state=t.state,this.commonUpdateParams(t)}updateParams(t,e){this.commonUpdateParams(t,e)}commonUpdateParams(t,e){this.applyActive=Gm(t),this.setupApplyDebounced()}doesFilterPass(t){K(283);let{getHandler:e,model:i,column:n}=this.params;return e().doesFilterPass(k(w({},t),{model:i,handlerParams:this.beans.colFilter.getHandlerParams(n)}))}getFilterTitle(){return this.translate(this.filterNameKey)}isFilterActive(){return K(284),this.params.model!=null}setupApplyDebounced(){let t=jS(this.params,this.defaultDebounceMs),e=ui(this,this.checkApplyDebounce.bind(this),t);this.applyDebounced=()=>{this.debouncePending=!0,e()}}checkApplyDebounce(){this.debouncePending&&(this.debouncePending=!1,this.doApplyModel())}getModel(){return K(285),this.params.model}setModel(t){K(286);let{beans:e,params:i}=this;return e.colFilter.setModelForColumnLegacy(i.column,t)}applyModel(t="api"){return this.doApplyModel()}canApply(t){return!0}doApplyModel(t){let{params:e,state:i}=this,n=!this.areModelsEqual(e.model,i.model);return n&&e.onAction("apply",t),n}onNewRowsLoaded(){}onUiChanged(t,e=!1){this.updateUiVisibility();let i=this.getModelFromUi(),n={model:i,state:this.getState(),valid:this.canApply(i)};this.state=n;let r=this.params;r.onStateChange(n),r.onUiChange(this.getUiChangeEventParams()),this.gos.get("enableFilterHandlers")||this.eventSvc.dispatchEvent({type:"filterModified",column:r.column,filterInstance:this}),t??(t=this.applyActive?void 0:"debounce"),t==="immediately"?this.doApplyModel({afterFloatingFilter:e,afterDataChange:!1}):t==="debounce"&&this.applyDebounced()}getState(){}getUiChangeEventParams(){}afterGuiAttached(t){this.lastContainerType=t?.container,this.refreshFilterResizer(t?.container)}refreshFilterResizer(t){let{positionableFeature:e,gos:i}=this;if(!e)return;let n=t==="floatingFilter"||t==="columnFilter";n?(e.restoreLastSize(),e.setResizable(i.get("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(e.removeSizeFromEl(),e.setResizable(!1)),e.constrainSizeToAvailableHeight(n)}afterGuiDetached(){this.checkApplyDebounce(),this.positionableFeature?.constrainSizeToAvailableHeight(!1)}destroy(){this.positionableFeature=this.destroyBean(this.positionableFeature),super.destroy()}translate(t){return ms(this,t)}getPositionableElement(){return this.getGui()}areModelsEqual(t,e){return t===e||t==null&&e==null?!0:t==null||e==null?!1:this.areNonNullModelsEqual(t,e)}};function jM(t){return!!t.operator}function FY(t,e,i){if(e==null)return null;let n=null,{compName:r,jsComp:o,fwComp:s}=CM(t,e);return r?n={agSetColumnFilter:"agSetColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"}[r]:o==null&&s==null&&e.filter===!0&&(n=i()),n}var Qn={AUTO_HEIGHT:"ag-layout-auto-height",NORMAL:"ag-layout-normal",PRINT:"ag-layout-print"},qS=class extends H{constructor(t){super(),this.view=t}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){let t=this.gos.get("domLayout"),e={autoHeight:t==="autoHeight",normal:t==="normal",print:t==="print"},i=e.autoHeight?Qn.AUTO_HEIGHT:e.print?Qn.PRINT:Qn.NORMAL;this.view.updateLayoutClasses(i,e)}},ps="Viewport",yT="fakeVScrollComp",wy=["fakeHScrollComp","centerHeader","topCenter","bottomCenter","stickyTopCenter","stickyBottomCenter"],ST=100,by=150,TY=class extends H{constructor(t){super(),this.clearRetryListenerFncs=[],this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.lastOffsetHeight=-1,this.lastScrollTop=-1,this.lastIsHorizontalScrollShowing=!1,this.scrollTimer=0,this.isScrollActive=!1,this.isVerticalPositionInvalidated=!0,this.isHorizontalPositionInvalidated=!0,this.eBodyViewport=t,this.resetLastHScrollDebounced=ui(this,()=>this.lastScrollSource[1]=null,by),this.resetLastVScrollDebounced=ui(this,()=>this.lastScrollSource[0]=null,by)}wireBeans(t){this.ctrlsSvc=t.ctrlsSvc,this.animationFrameSvc=t.animationFrameSvc,this.visibleCols=t.visibleCols}destroy(){super.destroy(),this.clearRetryListenerFncs=[],window.clearTimeout(this.scrollTimer)}postConstruct(){this.enableRtl=this.gos.get("enableRtl");let t=this.invalidateVerticalScroll.bind(this),e=this.invalidateHorizontalScroll.bind(this);this.addManagedEventListeners({displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this),bodyHeightChanged:t,scrollGapChanged:e}),this.addManagedElementListeners(this.eBodyViewport,{scroll:t}),this.ctrlsSvc.whenReady(this,i=>{this.centerRowsCtrl=i.center,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()})}invalidateHorizontalScroll(){this.isHorizontalPositionInvalidated=!0}invalidateVerticalScroll(){this.isVerticalPositionInvalidated=!0}addScrollListener(){this.addHorizontalScrollListeners(),this.addVerticalScrollListeners()}addHorizontalScrollListeners(){this.addManagedElementListeners(this.centerRowsCtrl.eViewport,{scroll:this.onHScroll.bind(this,ps)});for(let t of wy){let e=this.ctrlsSvc.get(t);this.registerScrollPartner(e,this.onHScroll.bind(this,t))}}addVerticalScrollListeners(){let t=this.ctrlsSvc.get("fakeVScrollComp"),e=this.gos.get("debounceVerticalScrollbar"),i=e?ui(this,this.onVScroll.bind(this,ps),ST):this.onVScroll.bind(this,ps),n=e?ui(this,this.onVScroll.bind(this,yT),ST):this.onVScroll.bind(this,yT);this.addManagedElementListeners(this.eBodyViewport,{scroll:i}),this.registerScrollPartner(t,n)}registerScrollPartner(t,e){t.onScrollCallback(e)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(t){this.centerRowsCtrl!=null&&(t===void 0&&(t=this.centerRowsCtrl.getCenterViewportScrollLeft()),this.setScrollLeftForAllContainersExceptCurrent(Math.abs(t)))}setScrollLeftForAllContainersExceptCurrent(t){for(let e of[...wy,ps]){if(this.lastScrollSource[1]===e)continue;let i=this.getViewportForSource(e);vm(i,t,this.enableRtl)}}getViewportForSource(t){return t===ps?this.centerRowsCtrl.eViewport:this.ctrlsSvc.get(t).eViewport}isControllingScroll(t,e){return this.lastScrollSource[e]==null?(e===0?this.lastScrollSource[0]=t:this.lastScrollSource[1]=t,!0):this.lastScrollSource[e]===t}onHScroll(t){if(!this.isControllingScroll(t,1))return;let e=this.centerRowsCtrl.eViewport,{scrollLeft:i}=e;if(this.shouldBlockScrollUpdate(1,i,!0))return;let n=mm(this.getViewportForSource(t),this.enableRtl);this.doHorizontalScroll(n),this.resetLastHScrollDebounced()}onVScroll(t){if(!this.isControllingScroll(t,0))return;let e;if(t===ps?e=this.eBodyViewport.scrollTop:e=this.ctrlsSvc.get("fakeVScrollComp").getScrollPosition(),this.shouldBlockScrollUpdate(0,e,!0))return;let{animationFrameSvc:i}=this;i?.setScrollTop(e),this.nextScrollTop=e,t===ps?this.ctrlsSvc.get("fakeVScrollComp").setScrollPosition(e):this.eBodyViewport.scrollTop=e,i?.active?i.schedule():this.scrollGridIfNeeded(!0),this.resetLastVScrollDebounced()}doHorizontalScroll(t){let e=this.ctrlsSvc.get("fakeHScrollComp").getScrollPosition();this.scrollLeft===t&&t===e||(this.scrollLeft=t,this.fireScrollEvent(1),this.horizontallyScrollHeaderCenterAndFloatingCenter(t),this.centerRowsCtrl.onHorizontalViewportChanged(!0))}isScrolling(){return this.isScrollActive}fireScrollEvent(t){let e={type:"bodyScroll",direction:t===1?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.isScrollActive=!0,this.eventSvc.dispatchEvent(e),window.clearTimeout(this.scrollTimer),this.scrollTimer=window.setTimeout(()=>{this.scrollTimer=0,this.isScrollActive=!1,this.eventSvc.dispatchEvent(k(w({},e),{type:"bodyScrollEnd"}))},by)}shouldBlockScrollUpdate(t,e,i=!1){return i&&!Pa()?!1:t===0?this.shouldBlockVerticalScroll(e):this.shouldBlockHorizontalScroll(e)}shouldBlockVerticalScroll(t){let e=xS(this.eBodyViewport),{scrollHeight:i}=this.eBodyViewport;return t<0||t+e>i}shouldBlockHorizontalScroll(t){let e=this.centerRowsCtrl.getCenterWidth(),{scrollWidth:i}=this.centerRowsCtrl.eViewport;if(this.enableRtl){if(t>0)return!0}else if(t<0)return!0;return Math.abs(t)+e>i}redrawRowsAfterScroll(){this.fireScrollEvent(0)}checkScrollLeft(){let t=this.scrollLeft,e=!1;for(let i of wy)if(this.getViewportForSource(i).scrollLeft!==t){e=!0;break}e&&this.onHScroll(ps)}scrollGridIfNeeded(t=!1){let e=this.scrollTop!=this.nextScrollTop;return e&&(this.scrollTop=this.nextScrollTop,t&&this.invalidateVerticalScroll(),this.redrawRowsAfterScroll()),e}setHorizontalScrollPosition(t,e=!1){let n=this.centerRowsCtrl.eViewport.scrollWidth-this.centerRowsCtrl.getCenterWidth();!e&&this.shouldBlockScrollUpdate(1,t)&&(this.enableRtl?t=t>0?0:n:t=Math.min(Math.max(t,0),n)),vm(this.centerRowsCtrl.eViewport,Math.abs(t),this.enableRtl),this.doHorizontalScroll(t)}setVerticalScrollPosition(t){this.invalidateVerticalScroll(),this.eBodyViewport.scrollTop=t}getVScrollPosition(){if(!this.isVerticalPositionInvalidated){let{lastOffsetHeight:i,lastScrollTop:n}=this;return{top:n,bottom:n+i}}this.isVerticalPositionInvalidated=!1;let{scrollTop:t,offsetHeight:e}=this.eBodyViewport;return this.lastScrollTop=t,this.lastOffsetHeight=e,{top:t,bottom:t+e}}getApproximateVScollPosition(){return this.lastScrollTop>=0&&this.lastOffsetHeight>=0?{top:this.scrollTop,bottom:this.scrollTop+this.lastOffsetHeight}:this.getVScrollPosition()}getHScrollPosition(){return this.centerRowsCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.isHorizontalPositionInvalidated&&(this.lastIsHorizontalScrollShowing=this.centerRowsCtrl.isHorizontalScrollShowing(),this.isHorizontalPositionInvalidated=!1),this.lastIsHorizontalScrollShowing}scrollHorizontally(t){let e=this.centerRowsCtrl.eViewport.scrollLeft;return this.setHorizontalScrollPosition(e+t),this.centerRowsCtrl.eViewport.scrollLeft-e}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(t,e=null){let{rowModel:i}=this.beans,n=i.getRowCount(),r=-1;for(let o=0;o<n;o++){let s=i.getRow(o);if(typeof t=="function"){if(s&&t(s)){r=o;break}}else if(t===s||t===s.data){r=o;break}}r>=0&&this.ensureIndexVisible(r,e)}ensureIndexVisible(t,e,i=0){if(pi(this.gos,"print"))return;let{rowModel:n}=this.beans,r=n.getRowCount();if(typeof t!="number"||t<0||t>=r){K(88,{index:t});return}this.clearRetryListeners();let{frameworkOverrides:o,pageBounds:s,rowContainerHeight:a,rowRenderer:l}=this.beans;o.wrapIncoming(()=>{let c=this.ctrlsSvc.getGridBodyCtrl(),d=n.getRow(t),u,h,p=0;this.invalidateVerticalScroll();do{let{stickyTopHeight:f,stickyBottomHeight:g}=c,m=d.rowTop,v=d.rowHeight,C=s.getPixelOffset(),b=d.rowTop-C,S=b+d.rowHeight,x=this.getVScrollPosition(),E=a.divStretchOffset,P=x.top+E,L=x.bottom+E,B=L-P,j=a.getScrollPositionForPixel(b),q=a.getScrollPositionForPixel(S-B),Y=Math.min((j+q)/2,b),he=P+f>b,Se=L-g<S,be=null;e==="top"?be=j-f:e==="bottom"?be=q+g:e==="middle"?be=Y:he?be=j-f:Se&&(q-j>B?be=j-f:be=q+g),be!==null&&(this.setVerticalScrollPosition(be),l.redraw({afterScroll:!0})),u=m!==d.rowTop||v!==d.rowHeight,h=f!==c.stickyTopHeight||g!==c.stickyBottomHeight,p++}while((u||h)&&p<10);if(this.animationFrameSvc?.flushAllFrames(),i<10&&(d?.stub||!this.beans.rowAutoHeight?.areRowsMeasured())){let f=this.getVScrollPosition().top;this.clearRetryListenerFncs=this.addManagedEventListeners({bodyScroll:()=>{let g=this.getVScrollPosition().top;f!==g&&this.clearRetryListeners()},modelUpdated:()=>{this.clearRetryListeners(),!(t>=n.getRowCount())&&this.ensureIndexVisible(t,e,i+1)}})}})}clearRetryListeners(){for(let t of this.clearRetryListenerFncs)t();this.clearRetryListenerFncs=[]}ensureColumnVisible(t,e="auto"){let{colModel:i,frameworkOverrides:n}=this.beans,r=i.getCol(t);if(!r||r.isPinned()||!this.visibleCols.isColDisplayed(r))return;let o=this.getPositionedHorizontalScroll(r,e);n.wrapIncoming(()=>{o!==null&&this.centerRowsCtrl.setCenterViewportScrollLeft(o),this.centerRowsCtrl.onHorizontalViewportChanged(),this.animationFrameSvc?.flushAllFrames()})}getPositionedHorizontalScroll(t,e){let{columnBeforeStart:i,columnAfterEnd:n}=this.isColumnOutsideViewport(t),r=this.centerRowsCtrl.getCenterWidth()<t.getActualWidth(),o=this.centerRowsCtrl.getCenterWidth(),s=this.enableRtl,a=(s?i:n)||r,l=s?n:i;e!=="auto"&&(a=e==="start",l=e==="end");let c=e==="middle";if(a||l||c){let{colLeft:d,colMiddle:u,colRight:h}=this.getColumnBounds(t);return c?u-o/2:a?s?h:d:s?d-o:h-o}return null}isColumnOutsideViewport(t){let{start:e,end:i}=this.getViewportBounds(),{colLeft:n,colRight:r}=this.getColumnBounds(t),o=this.enableRtl,s=o?e>r:i<r,a=o?i<n:e>n;return{columnBeforeStart:s,columnAfterEnd:a}}getColumnBounds(t){let e=this.enableRtl,i=this.visibleCols.bodyWidth,n=t.getActualWidth(),r=t.getLeft(),o=e?-1:1,s=e?i-r:r,a=s+n*o,l=s+n/2*o;return{colLeft:s,colMiddle:l,colRight:a}}getViewportBounds(){let t=this.centerRowsCtrl.getCenterWidth(),e=this.centerRowsCtrl.getCenterViewportScrollLeft(),i=e,n=t+e;return{start:i,end:n,width:t}}},$S=class extends H{constructor(t,e=!1){super(),this.callback=t,this.addSpacer=e}postConstruct(){let t=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",t),this.addManagedEventListeners({columnContainerWidthChanged:t,displayedColumnsChanged:t,leftPinnedWidthChanged:t}),this.addSpacer&&this.addManagedEventListeners({rightPinnedWidthChanged:t,scrollVisibilityChanged:t,scrollbarWidthChanged:t}),this.setWidth()}setWidth(){let t=pi(this.gos,"print"),{visibleCols:e,scrollVisibleSvc:i}=this.beans,n=e.bodyWidth,r=e.getColsLeftWidth(),o=e.getDisplayedColumnsRightWidth(),s;t?s=n+r+o:(s=n,this.addSpacer&&(this.gos.get("enableRtl")?r:o)===0&&i.verticalScrollShowing&&(s+=i.getScrollbarWidth())),this.callback(s)}},DY=class extends H{constructor(t){super(),this.centerContainerCtrl=t}wireBeans(t){this.scrollVisibleSvc=t.scrollVisibleSvc}postConstruct(){this.beans.ctrlsSvc.whenReady(this,t=>{this.gridBodyCtrl=t.gridBodyCtrl,this.listenForResize()}),this.addManagedEventListeners({scrollbarWidthChanged:this.onScrollbarWidthChanged.bind(this)}),this.addManagedPropertyListeners(["alwaysShowHorizontalScroll","alwaysShowVerticalScroll"],()=>{this.checkViewportAndScrolls()})}listenForResize(){let{beans:t,centerContainerCtrl:e,gridBodyCtrl:i}=this,n=()=>{Eo(t,()=>{this.onCenterViewportResized()})};e.registerViewportResizeListener(n),i.registerBodyViewportResizeListener(n)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.scrollVisibleSvc.updateScrollGap(),this.centerContainerCtrl.isViewportInTheDOMTree()){let{pinnedCols:t,colFlex:e}=this.beans;t?.keepPinnedColumnsNarrowerThanViewport(),this.checkViewportAndScrolls();let i=this.centerContainerCtrl.getCenterWidth();i!==this.centerWidth&&(this.centerWidth=i,e?.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.scrollFeature.checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){let t=this.gridBodyCtrl.eBodyViewport,e=xS(t);this.bodyHeight!==e&&(this.bodyHeight=e,this.eventSvc.dispatchEvent({type:"bodyHeightChanged"}))}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){if(!this.isAlive())return;let t={horizontalScrollShowing:this.centerContainerCtrl.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleSvc.setScrollsVisible(t)}onHorizontalViewportChanged(){let t=this.centerContainerCtrl.getCenterWidth(),e=this.centerContainerCtrl.getViewportScrollLeft();this.beans.colViewport.setScrollPosition(t,e)}};function lm(t,e,i,n){let r=e.getColDef().cellRendererParams?.suppressMouseEventHandling;return qM(t,e,i,n,r)}function MY(t,e,i,n){let r=e?.suppressMouseEventHandling;return qM(t,void 0,i,n,r)}function qM(t,e,i,n,r){return r?r(Ee(t,{column:e,node:i,event:n})):!1}function $M(t,e,i){let n=e;for(;n;){let r=qD(t,n,i);if(r)return r;n=n.parentElement}return null}var Tm="cellCtrl";function KS(t,e){return $M(t,e,Tm)}var Dm="renderedRow";function IY(t,e){return $M(t,e,Dm)}function aS(t,e,i,n,r){let o=n?n.getColDef().suppressKeyboardEvent:void 0;if(!o)return!1;let s=Ee(t,{event:e,editing:r,column:n,node:i,data:i.data,colDef:n.getColDef()});return!!(o&&o(s))}function AY(t){let{pinnedRowModel:e,rowModel:i}=t,[n,r]=[e?.isEmpty("top")??!0,e?.isEmpty("bottom")??!0],o=n?null:"top",s,a;r?(s=null,a=i.getRowCount()-1):(s="bottom",a=e?.getPinnedBottomRowCount()??-1);let{visibleCols:l,rangeSvc:c}=t,d=l.allCols;!c||!d?.length||c.setCellRange({rowStartIndex:0,rowStartPinned:o,rowEndIndex:a,rowEndPinned:s})}var OY=65,LY=67,NY=86,BY=68,HY=90,zY=89;function VY(t){let{keyCode:e}=t,i;switch(e){case OY:i=A.A;break;case LY:i=A.C;break;case NY:i=A.V;break;case BY:i=A.D;break;case HY:i=A.Z;break;case zY:i=A.Y;break;default:i=t.code}return i}var GY=class extends H{constructor(t){super(),this.element=t}postConstruct(){this.addKeyboardListeners(),this.addMouseListeners(),this.beans.touchSvc?.mockRowContextMenu(this),this.editSvc=this.beans.editSvc}addKeyboardListeners(){let t="keydown",e=this.processKeyboardEvent.bind(this,t);this.addManagedElementListeners(this.element,{[t]:e})}addMouseListeners(){let e=["dblclick","contextmenu","mouseover","mouseout","click",DD("touchstart")?"touchstart":"mousedown"];for(let i of e){let n=this.processMouseEvent.bind(this,i);this.addManagedElementListeners(this.element,{[i]:n})}}processMouseEvent(t,e){if(!lh(this.beans,e)||yo(e))return;let{cellCtrl:i,rowCtrl:n}=this.getControlsForEventTarget(e.target);t==="contextmenu"?(i?.column&&i.dispatchCellContextMenuEvent(e),this.beans.contextMenuSvc?.handleContextMenuMouseEvent(e,void 0,n,i)):(i&&i.onMouseEvent(t,e),n&&n.onMouseEvent(t,e))}getControlsForEventTarget(t){let{gos:e}=this;return{cellCtrl:KS(e,t),rowCtrl:IY(e,t)}}processKeyboardEvent(t,e){let{cellCtrl:i,rowCtrl:n}=this.getControlsForEventTarget(e.target);e.defaultPrevented||(i?this.processCellKeyboardEvent(i,t,e):n?.isFullWidth()&&this.processFullWidthRowKeyboardEvent(n,t,e))}processCellKeyboardEvent(t,e,i){let n=this.editSvc?.isEditing(t,{withOpenEditor:!0})??!1;!aS(this.gos,i,t.rowNode,t.column,n)&&e==="keydown"&&(!n&&this.beans.navigation?.handlePageScrollingKey(i)||t.onKeyDown(i),this.doGridOperations(i,n),xM(i)&&t.processCharacter(i)),e==="keydown"&&this.eventSvc.dispatchEvent(t.createEvent(i,"cellKeyDown"))}processFullWidthRowKeyboardEvent(t,e,i){let{rowNode:n}=t,{focusSvc:r,navigation:o}=this.beans,a=r.getFocusedCell()?.column;if(!aS(this.gos,i,n,a,!1)){let c=i.key;if(e==="keydown")switch(c){case A.PAGE_HOME:case A.PAGE_END:case A.PAGE_UP:case A.PAGE_DOWN:o?.handlePageScrollingKey(i,!0);break;case A.LEFT:case A.RIGHT:if(!this.gos.get("embedFullWidthRows"))break;case A.UP:case A.DOWN:t.onKeyboardNavigate(i);break;case A.TAB:t.onTabKeyDown(i);break;default:}}e==="keydown"&&this.eventSvc.dispatchEvent(t.createRowEvent("cellKeyDown",i))}doGridOperations(t,e){if(!t.ctrlKey&&!t.metaKey||e||!lh(this.beans,t))return;let i=VY(t),{clipboardSvc:n,undoRedo:r}=this.beans;if(i===A.A)return this.onCtrlAndA(t);if(i===A.C)return this.onCtrlAndC(n,t);if(i===A.D)return this.onCtrlAndD(n,t);if(i===A.V)return this.onCtrlAndV(n,t);if(i===A.X)return this.onCtrlAndX(n,t);if(i===A.Y)return this.onCtrlAndY(r);if(i===A.Z)return this.onCtrlAndZ(r,t)}onCtrlAndA(t){let{beans:{rowModel:e,rangeSvc:i,selectionSvc:n},gos:r}=this;i&&So(r)&&!Oq(r)&&e.isRowsToRender()?AY(this.beans):n&&n.selectAllRowNodes({source:"keyboardSelectAll",selectAll:QD(r)}),t.preventDefault()}onCtrlAndC(t,e){if(!t||this.gos.get("enableCellTextSelection"))return;let{cellCtrl:i}=this.getControlsForEventTarget(e.target);this.editSvc?.isEditing(i,{withOpenEditor:!0})||(e.preventDefault(),t.copyToClipboard())}onCtrlAndX(t,e){if(!t||this.gos.get("enableCellTextSelection")||this.gos.get("suppressCutToClipboard"))return;let{cellCtrl:i}=this.getControlsForEventTarget(e.target);this.editSvc?.isEditing(i,{withOpenEditor:!0})||(e.preventDefault(),t.cutToClipboard(void 0,"ui"))}onCtrlAndV(t,e){let{cellCtrl:i}=this.getControlsForEventTarget(e.target);this.editSvc?.isEditing(i,{withOpenEditor:!0})||t&&!this.gos.get("suppressClipboardPaste")&&t.pasteFromClipboard()}onCtrlAndD(t,e){t&&!this.gos.get("suppressClipboardPaste")&&t.copyRangeDown(),e.preventDefault()}onCtrlAndZ(t,e){!this.gos.get("undoRedoCellEditing")||!t||(e.preventDefault(),e.shiftKey?t.redo("ui"):t.undo("ui"))}onCtrlAndY(t){t?.redo("ui")}},KM=class extends H{constructor(t,e){super(),this.eContainer=t,this.eViewport=e}postConstruct(){this.addManagedEventListeners({rowContainerHeightChanged:this.onHeightChanged.bind(this,this.beans.rowContainerHeight)})}onHeightChanged(t){let e=t.uiContainerHeight,i=e!=null?`${e}px`:"";this.eContainer.style.height=i,this.eViewport&&(this.eViewport.style.height=i)}},Kg=t=>t.topRowCtrls,Yg=t=>t.getStickyTopRowCtrls(),Xg=t=>t.getStickyBottomRowCtrls(),Jg=t=>t.bottomRowCtrls,Qg=t=>t.allRowCtrls,yy=t=>t.getCtrls("top"),Sy=t=>t.getCtrls("center"),xy=t=>t.getCtrls("bottom"),WY={center:{type:"center",name:"center-cols",getRowCtrls:Qg,getSpannedRowCtrls:Sy},left:{type:"left",name:"pinned-left-cols",pinnedType:"left",getRowCtrls:Qg,getSpannedRowCtrls:Sy},right:{type:"right",name:"pinned-right-cols",pinnedType:"right",getRowCtrls:Qg,getSpannedRowCtrls:Sy},fullWidth:{type:"fullWidth",name:"full-width",fullWidth:!0,getRowCtrls:Qg},topCenter:{type:"center",name:"floating-top",getRowCtrls:Kg,getSpannedRowCtrls:yy},topLeft:{type:"left",name:"pinned-left-floating",container:"ag-pinned-left-floating-top",pinnedType:"left",getRowCtrls:Kg,getSpannedRowCtrls:yy},topRight:{type:"right",name:"pinned-right-floating",container:"ag-pinned-right-floating-top",pinnedType:"right",getRowCtrls:Kg,getSpannedRowCtrls:yy},topFullWidth:{type:"fullWidth",name:"floating-top-full-width",fullWidth:!0,getRowCtrls:Kg},stickyTopCenter:{type:"center",name:"sticky-top",getRowCtrls:Yg},stickyTopLeft:{type:"left",name:"pinned-left-sticky-top",container:"ag-pinned-left-sticky-top",pinnedType:"left",getRowCtrls:Yg},stickyTopRight:{type:"right",name:"pinned-right-sticky-top",container:"ag-pinned-right-sticky-top",pinnedType:"right",getRowCtrls:Yg},stickyTopFullWidth:{type:"fullWidth",name:"sticky-top-full-width",fullWidth:!0,getRowCtrls:Yg},stickyBottomCenter:{type:"center",name:"sticky-bottom",getRowCtrls:Xg},stickyBottomLeft:{type:"left",name:"pinned-left-sticky-bottom",container:"ag-pinned-left-sticky-bottom",pinnedType:"left",getRowCtrls:Xg},stickyBottomRight:{type:"right",name:"pinned-right-sticky-bottom",container:"ag-pinned-right-sticky-bottom",pinnedType:"right",getRowCtrls:Xg},stickyBottomFullWidth:{type:"fullWidth",name:"sticky-bottom-full-width",fullWidth:!0,getRowCtrls:Xg},bottomCenter:{type:"center",name:"floating-bottom",getRowCtrls:Jg,getSpannedRowCtrls:xy},bottomLeft:{type:"left",name:"pinned-left-floating-bottom",container:"ag-pinned-left-floating-bottom",pinnedType:"left",getRowCtrls:Jg,getSpannedRowCtrls:xy},bottomRight:{type:"right",name:"pinned-right-floating-bottom",container:"ag-pinned-right-floating-bottom",pinnedType:"right",getRowCtrls:Jg,getSpannedRowCtrls:xy},bottomFullWidth:{type:"fullWidth",name:"floating-bottom-full-width",fullWidth:!0,getRowCtrls:Jg}};function YM(t){return`ag-${yh(t).name}-viewport`}function cm(t){let e=yh(t);return e.container??`ag-${e.name}-container`}function UY(t){return`ag-${yh(t).name}-spanned-cells-container`}function yh(t){return WY[t]}var jY=["topCenter","topLeft","topRight"],qY=["bottomCenter","bottomLeft","bottomRight"],$Y=["center","left","right"],KY=["center","left","right","fullWidth"],YY=["stickyTopCenter","stickyBottomCenter","center","topCenter","bottomCenter"],XY=["left","bottomLeft","topLeft","stickyTopLeft","stickyBottomLeft"],JY=["right","bottomRight","topRight","stickyTopRight","stickyBottomRight"],XM=["stickyTopCenter","stickyTopLeft","stickyTopRight"],JM=["stickyBottomCenter","stickyBottomLeft","stickyBottomRight"],QY=[...XM,"stickyTopFullWidth",...JM,"stickyBottomFullWidth"],ZY=[...jY,...qY,...$Y,...XM,...JM],eX=class extends H{constructor(t){super(),this.name=t,this.visible=!0,this.EMPTY_CTRLS=[],this.options=yh(t)}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.forContainers(["center"],()=>{this.viewportSizeFeature=this.createManagedBean(new DY(this)),this.addManagedEventListeners({stickyTopOffsetChanged:this.onStickyTopOffsetChanged.bind(this)})})}onStickyTopOffsetChanged(t){this.comp.setOffsetTop(`${t.offset}px`)}registerWithCtrlsService(){this.options.fullWidth||this.beans.ctrlsSvc.register(this.name,this)}forContainers(t,e){t.indexOf(this.name)>=0&&e()}setComp(t,e,i,n){this.comp=t,this.eContainer=e,this.eSpannedContainer=i,this.eViewport=n,this.createManagedBean(new GY(this.eViewport??this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder();let{pinnedCols:r,rangeSvc:o}=this.beans,s=()=>this.onPinnedWidthChanged();this.forContainers(XY,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(r?.createPinnedWidthFeature(!0,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({leftPinnedWidthChanged:s})}),this.forContainers(JY,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(r?.createPinnedWidthFeature(!1,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({rightPinnedWidthChanged:s})}),this.forContainers(KY,()=>this.createManagedBean(new KM(this.eContainer,this.name==="center"?n:void 0))),o&&this.forContainers(ZY,()=>this.createManagedBean(o.createDragListenerFeature(this.eContainer))),this.forContainers(YY,()=>this.createManagedBean(new $S(a=>this.comp.setContainerWidth(`${a}px`)))),this.visible=this.isContainerVisible(),this.addListeners(),this.registerWithCtrlsService()}onScrollCallback(t){this.addManagedElementListeners(this.eViewport,{scroll:t})}addListeners(){let{spannedRowRenderer:t,gos:e}=this.beans,i=this.onDisplayedColumnsChanged.bind(this);this.addManagedEventListeners({displayedColumnsChanged:i,displayedColumnsWidthChanged:i,displayedRowsChanged:n=>this.onDisplayedRowsChanged(n.afterScroll)}),i(),this.onDisplayedRowsChanged(),t&&this.options.getSpannedRowCtrls&&e.get("enableCellSpan")&&this.addManagedListeners(t,{spannedRowsUpdated:()=>{let n=this.options.getSpannedRowCtrls(t);n&&this.comp.setSpannedRowCtrls(n,!1)}})}listenOnDomOrder(){if(QY.indexOf(this.name)>=0){this.comp.setDomOrder(!0);return}let e=()=>{let i=this.gos.get("ensureDomOrder"),n=pi(this.gos,"print");this.comp.setDomOrder(i||n)};this.addManagedPropertyListener("domLayout",e),e()}onDisplayedColumnsChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}addPreventScrollWhileDragging(){let{dragSvc:t}=this.beans;if(!t)return;let e=i=>{t.dragging&&i.cancelable&&i.preventDefault()};this.eContainer.addEventListener("touchmove",e,{passive:!1}),this.addDestroyFunc(()=>this.eContainer.removeEventListener("touchmove",e))}onHorizontalViewportChanged(t=!1){let e=this.getCenterWidth(),i=this.getCenterViewportScrollLeft();this.beans.colViewport.setScrollPosition(e,i,t)}hasHorizontalScrollGap(){return this.eContainer.clientWidth-this.eViewport.clientWidth<0}hasVerticalScrollGap(){return this.eContainer.clientHeight-this.eViewport.clientHeight<0}getCenterWidth(){return ah(this.eViewport)}getCenterViewportScrollLeft(){return mm(this.eViewport,this.enableRtl)}registerViewportResizeListener(t){let e=Ss(this.beans,this.eViewport,t);this.addDestroyFunc(()=>e())}isViewportInTheDOMTree(){return RD(this.eViewport)}getViewportScrollLeft(){return mm(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gos.get("alwaysShowHorizontalScroll")||PS(this.eViewport)}setHorizontalScroll(t){this.comp.setHorizontalScroll(t)}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(t){vm(this.eViewport,t,this.enableRtl)}isContainerVisible(){return!(this.options.pinnedType!=null)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){let t=this.isContainerVisible();this.visible!=t&&(this.visible=t,this.onDisplayedRowsChanged())}onDisplayedRowsChanged(t=!1){let e=this.options.getRowCtrls(this.beans.rowRenderer);if(!this.visible||e.length===0){this.comp.setRowCtrls({rowCtrls:this.EMPTY_CTRLS});return}let i=pi(this.gos,"print"),r=this.gos.get("embedFullWidthRows")||i,o=e.filter(s=>{let a=s.isFullWidth();return this.options.fullWidth?!r&&a:r||!a});this.comp.setRowCtrls({rowCtrls:o,useFlushSync:t})}},QM="ag-force-vertical-scroll",tX="ag-selectable",iX="ag-column-moving",nX=class extends H{constructor(){super(...arguments),this.stickyTopHeight=0,this.stickyBottomHeight=0}wireBeans(t){this.ctrlsSvc=t.ctrlsSvc,this.colModel=t.colModel,this.scrollVisibleSvc=t.scrollVisibleSvc,this.pinnedRowModel=t.pinnedRowModel,this.filterManager=t.filterManager,this.rowGroupColsSvc=t.rowGroupColsSvc}setComp(t,e,i,n,r,o,s){this.comp=t,this.eGridBody=e,this.eBodyViewport=i,this.eTop=n,this.eBottom=r,this.eStickyTop=o,this.eStickyBottom=s,this.eCenterColsViewport=i.querySelector(`.${YM("center")}`),this.eFullWidthContainer=i.querySelector(`.${cm("fullWidth")}`),this.eStickyTopFullWidthContainer=o.querySelector(`.${cm("stickyTopFullWidth")}`),this.eStickyBottomFullWidthContainer=s.querySelector(`.${cm("stickyBottomFullWidth")}`),this.setCellTextSelection(this.gos.get("enableCellTextSelection")),this.addManagedPropertyListener("enableCellTextSelection",a=>this.setCellTextSelection(a.currentValue)),this.createManagedBean(new qS(this.comp)),this.scrollFeature=this.createManagedBean(new TY(i)),this.beans.rowDragSvc?.setupRowDrag(i,this),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([n,i,r,o,s]),this.setGridRootRole(),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.updateScrollingClasses(),this.filterManager?.setupAdvFilterHeaderComp(n),this.ctrlsSvc.register("gridBodyCtrl",this)}addEventListeners(){let t=this.setFloatingHeights.bind(this),e=this.setGridRootRole.bind(this),i=this.toggleRowResizeStyles.bind(this);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this),scrollGapChanged:this.updateScrollingClasses.bind(this),pinnedRowDataChanged:t,pinnedHeightChanged:t,pinnedRowsChanged:t,headerHeightChanged:this.setStickyTopOffsetTop.bind(this),columnRowGroupChanged:e,columnPivotChanged:e,rowResizeStarted:i,rowResizeEnded:i}),this.addManagedPropertyListener("treeData",e)}toggleRowResizeStyles(t){let e=t.type==="rowResizeStarted";this.eBodyViewport.classList.toggle("ag-prevent-animation",e)}onGridColumnsChanged(){let t=this.beans.colModel.getCols();this.comp.setColumnCount(t.length)}onScrollVisibilityChanged(){let{scrollVisibleSvc:t}=this,e=t.verticalScrollShowing;this.setVerticalScrollPaddingVisible(e),this.setStickyWidth(e),this.setStickyBottomOffsetBottom();let i=e&&t.getScrollbarWidth()||0,n=SM()?16:0,r=`calc(100% + ${i+n}px)`;Eo(this.beans,()=>this.comp.setBodyViewportWidth(r)),this.updateScrollingClasses()}setGridRootRole(){let{rowGroupColsSvc:t,colModel:e}=this,i=this.gos.get("treeData");if(!i){let n=e.isPivotMode();i=(t?t.columns.length:0)>=(n?2:1)}this.comp.setGridRootRole(i?"treegrid":"grid")}addFocusListeners(t){for(let e of t)this.addManagedElementListeners(e,{focusin:i=>{let{target:n}=i,r=Sa(n,"ag-root",e);e.classList.toggle("ag-has-focus",!r)},focusout:i=>{let{target:n,relatedTarget:r}=i,o=e.contains(r),s=Sa(r,"ag-root",e);Sa(n,"ag-root",e)||(!o||s)&&e.classList.remove("ag-has-focus")}})}setColumnMovingCss(t){this.comp.setColumnMovingCss(iX,t)}setCellTextSelection(t=!1){this.comp.setCellSelectableCss(tX,t)}updateScrollingClasses(){let{eGridBody:{classList:t},scrollVisibleSvc:e}=this;t.toggle("ag-body-vertical-content-no-gap",!e.verticalScrollGap),t.toggle("ag-body-horizontal-content-no-gap",!e.horizontalScrollGap)}disableBrowserDragging(){this.addManagedElementListeners(this.eGridBody,{dragstart:t=>{if(t.target instanceof HTMLImageElement)return t.preventDefault(),!1}})}addStopEditingWhenGridLosesFocus(){this.beans.editSvc?.addStopEditingWhenGridLosesFocus([this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop,this.eStickyBottom])}updateRowCount(){let t=(this.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0)+(this.filterManager?.getHeaderRowCount()??0),{rowModel:e}=this.beans,i=e.isLastRowIndexKnown()?e.getRowCount():-1,n=i===-1?-1:t+i;this.comp.setRowCount(n)}registerBodyViewportResizeListener(t){this.comp.registerBodyViewportResizeListener(t)}setVerticalScrollPaddingVisible(t){let e=t?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(e)}isVerticalScrollShowing(){let t=this.gos.get("alwaysShowVerticalScroll"),e=t?QM:null,i=pi(this.gos,"normal");return this.comp.setAlwaysVerticalScrollClass(e,t),t||i&&FD(this.eBodyViewport)}setupRowAnimationCssClass(){let{rowContainerHeight:t,environment:e}=this.beans,i=e.sizesMeasured,n=()=>{let r=i&&rc(this.gos)&&!t.stretching,o=r?"ag-row-animation":"ag-row-no-animation";this.comp.setRowAnimationCssOnBodyViewport(o,r)};n(),this.addManagedEventListeners({heightScaleChanged:n}),this.addManagedPropertyListener("animateRows",n),this.addManagedEventListeners({gridStylesChanged:()=>{!i&&e.sizesMeasured&&(i=!0,n())}})}addBodyViewportListener(){let{eBodyViewport:t,eStickyTop:e,eStickyBottom:i,eTop:n,eBottom:r,beans:{popupSvc:o,touchSvc:s}}=this,a=this.onBodyViewportContextMenu.bind(this);this.addManagedElementListeners(t,{contextmenu:a}),s?.mockBodyContextMenu(this,a),this.addManagedElementListeners(t,{wheel:this.onBodyViewportWheel.bind(this,o)});let l=this.onStickyWheel.bind(this);for(let d of[e,i,n,r])this.addManagedElementListeners(d,{wheel:l});let c=this.onHorizontalWheel.bind(this);for(let d of["left","right","topLeft","topRight","bottomLeft","bottomRight"])this.addManagedElementListeners(this.ctrlsSvc.get(d).eContainer,{wheel:c});this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){this.addManagedElementListeners(this.eFullWidthContainer,{wheel:t=>this.onFullWidthContainerWheel(t)})}onFullWidthContainerWheel(t){let{deltaX:e,deltaY:i,shiftKey:n}=t;(n||Math.abs(e)>Math.abs(i))&&lh(this.beans,t)&&this.scrollGridBodyToMatchEvent(t)}onStickyWheel(t){let{deltaY:e}=t;this.scrollVertically(e)>0&&t.preventDefault()}onHorizontalWheel(t){let{deltaX:e,deltaY:i,shiftKey:n}=t;(n||Math.abs(e)>Math.abs(i))&&this.scrollGridBodyToMatchEvent(t)}scrollGridBodyToMatchEvent(t){let{deltaX:e,deltaY:i}=t;t.preventDefault(),this.eCenterColsViewport.scrollBy({left:e||i})}onBodyViewportContextMenu(t,e,i){if(!t&&!i)return;this.gos.get("preventDefaultOnContextMenu")&&(t||i).preventDefault();let{target:n}=t||e;(n===this.eBodyViewport||n===this.ctrlsSvc.get("center").eViewport)&&this.beans.contextMenuSvc?.showContextMenu({mouseEvent:t,touchEvent:i,value:null,anchorToElement:this.eGridBody,source:"ui"})}onBodyViewportWheel(t,e){this.gos.get("suppressScrollWhenPopupsAreOpen")&&t?.hasAnchoredPopup()&&e.preventDefault()}scrollVertically(t){let e=this.eBodyViewport.scrollTop;return this.scrollFeature.setVerticalScrollPosition(e+t),this.eBodyViewport.scrollTop-e}setFloatingHeights(){let{pinnedRowModel:t,beans:{environment:e}}=this,i=t?.getPinnedTopTotalHeight(),n=t?.getPinnedBottomTotalHeight(),r=e.getPinnedRowBorderWidth(),o=e.getRowBorderWidth(),s=r-o,a=i?s+i:0,l=n?s+n:0;this.comp.setTopHeight(a),this.comp.setBottomHeight(l),this.comp.setTopInvisible(a<=0),this.comp.setBottomInvisible(l<=0),this.setStickyTopOffsetTop(),this.setStickyBottomOffsetBottom()}setStickyTopHeight(t=0){this.comp.setStickyTopHeight(`${t}px`),this.stickyTopHeight=t}setStickyBottomHeight(t=0){this.comp.setStickyBottomHeight(`${t}px`),this.stickyBottomHeight=t}setStickyWidth(t){if(!t)this.comp.setStickyTopWidth("100%"),this.comp.setStickyBottomWidth("100%");else{let e=this.scrollVisibleSvc.getScrollbarWidth();this.comp.setStickyTopWidth(`calc(100% - ${e}px)`),this.comp.setStickyBottomWidth(`calc(100% - ${e}px)`)}}setStickyTopOffsetTop(){let e=this.ctrlsSvc.get("gridHeaderCtrl").headerHeight+(this.filterManager?.getHeaderHeight()??0),i=this.pinnedRowModel?.getPinnedTopTotalHeight()??0,n=0;e>0&&(n+=e),i>0&&(n+=i),n>0&&(n+=1),this.comp.setStickyTopTop(`${n}px`)}setStickyBottomOffsetBottom(){let{pinnedRowModel:t,scrollVisibleSvc:e,comp:i}=this,n=t?.getPinnedBottomTotalHeight()??0,o=e.horizontalScrollShowing&&e.getScrollbarWidth()||0,s=n+o;i.setStickyBottomBottom(`${s}px`)}};function rX(t,e){return KS(t,e.target)?.getFocusedCellPosition()??null}function xT(t,e){let i=pi(t.gos,"normal"),n=e,r,o;n.clientX!=null||n.clientY!=null?(r=n.clientX,o=n.clientY):(r=n.x,o=n.y);let{pageFirstPixel:s}=t.pageBounds.getCurrentPagePixelRange();if(o+=s,i){let a=t.ctrlsSvc.getScrollFeature(),l=a.getVScrollPosition(),c=a.getHScrollPosition();r+=c.left,o+=l.top}return{x:r,y:o}}var ZM=class extends et{constructor(t,e){super(),this.direction=e,this.eViewport=re,this.eContainer=re,this.hideTimeout=0,this.setTemplate(t)}postConstruct(){this.addManagedEventListeners({scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this)}),this.onScrollVisibilityChanged(),this.toggleCss("ag-apple-scrollbar",bM()||Pa())}destroy(){super.destroy(),window.clearTimeout(this.hideTimeout)}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.invisibleScrollbar=SM(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){let t=this.getGui(),e=()=>this.toggleCss("ag-scrollbar-active",!0),i=()=>this.toggleCss("ag-scrollbar-active",!1);this.addManagedListeners(t,{mouseenter:e,mousedown:e,touchstart:e,mouseleave:i,touchend:i})}onScrollVisibilityChanged(){this.invisibleScrollbar===void 0&&this.initialiseInvisibleScrollbar(),Eo(this.beans,()=>this.setScrollVisible())}hideAndShowInvisibleScrollAsNeeded(){this.addManagedEventListeners({bodyScroll:t=>{t.direction===this.direction&&(this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=0),this.toggleCss("ag-scrollbar-scrolling",!0))},bodyScrollEnd:()=>{this.hideTimeout=window.setTimeout(()=>{this.toggleCss("ag-scrollbar-scrolling",!1),this.hideTimeout=0},400)}})}attemptSettingScrollPosition(t){let e=this.eViewport;lq(this,()=>Nr(e),()=>this.setScrollPosition(t),100)}onScrollCallback(t){this.addManagedElementListeners(this.eViewport,{scroll:t})}},oX={tag:"div",cls:"ag-body-horizontal-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eLeftSpacer",cls:"ag-horizontal-left-spacer"},{tag:"div",ref:"eViewport",cls:"ag-body-horizontal-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-horizontal-scroll-container"}]},{tag:"div",ref:"eRightSpacer",cls:"ag-horizontal-right-spacer"}]},sX=class extends ZM{constructor(){super(oX,"horizontal"),this.eLeftSpacer=re,this.eRightSpacer=re,this.setScrollVisibleDebounce=0}wireBeans(t){this.visibleCols=t.visibleCols,this.scrollVisibleSvc=t.scrollVisibleSvc}postConstruct(){super.postConstruct();let t=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:t,displayedColumnsWidthChanged:t,pinnedRowDataChanged:this.refreshCompBottom.bind(this)}),this.addManagedPropertyListener("domLayout",t),this.beans.ctrlsSvc.register("fakeHScrollComp",this),this.createManagedBean(new $S(e=>this.eContainer.style.width=`${e}px`)),this.addManagedPropertyListeners(["suppressHorizontalScroll"],this.onScrollVisibilityChanged.bind(this))}destroy(){window.clearTimeout(this.setScrollVisibleDebounce),super.destroy()}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.enableRtl=this.gos.get("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}refreshCompBottom(){if(!this.invisibleScrollbar)return;let t=this.beans.pinnedRowModel?.getPinnedBottomTotalHeight()??0;this.getGui().style.bottom=`${t}px`}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){let t=this.scrollVisibleSvc.verticalScrollShowing,e=this.visibleCols.getDisplayedColumnsRightWidth(),i=!this.enableRtl&&t,n=this.scrollVisibleSvc.getScrollbarWidth();i&&(e+=n),Ar(this.eRightSpacer,e),this.eRightSpacer.classList.toggle("ag-scroller-corner",e<=n);let r=this.visibleCols.getColsLeftWidth();this.enableRtl&&t&&(r+=n),Ar(this.eLeftSpacer,r),this.eLeftSpacer.classList.toggle("ag-scroller-corner",r<=n)}setScrollVisible(){let t=this.scrollVisibleSvc.horizontalScrollShowing,e=this.invisibleScrollbar,i=this.gos.get("suppressHorizontalScroll"),n=t&&this.scrollVisibleSvc.getScrollbarWidth()||0,o=i?0:n===0&&e?16:n,s=()=>{this.setScrollVisibleDebounce=0,this.toggleCss("ag-scrollbar-invisible",e),Xu(this.getGui(),o),Xu(this.eViewport,o),Xu(this.eContainer,o),o||this.eContainer.style.setProperty("min-height","1px"),this.setVisible(t,{skipAriaHidden:!0})};window.clearTimeout(this.setScrollVisibleDebounce),t?this.setScrollVisibleDebounce=window.setTimeout(s,100):s()}getScrollPosition(){return mm(this.eViewport,this.enableRtl)}setScrollPosition(t){Nr(this.eViewport)||this.attemptSettingScrollPosition(t),vm(this.eViewport,t,this.enableRtl)}},aX={selector:"AG-FAKE-HORIZONTAL-SCROLL",component:sX},lX={tag:"div",cls:"ag-body-vertical-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eViewport",cls:"ag-body-vertical-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-vertical-scroll-container"}]}]},cX=class extends ZM{constructor(){super(lX,"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new KM(this.eContainer));let{ctrlsSvc:t}=this.beans;t.register("fakeVScrollComp",this),this.addManagedEventListeners({rowContainerHeightChanged:this.onRowContainerHeightChanged.bind(this,t)})}setScrollVisible(){let{scrollVisibleSvc:t}=this.beans,e=t.verticalScrollShowing,i=this.invisibleScrollbar,n=e&&t.getScrollbarWidth()||0,r=n===0&&i?16:n;this.toggleCss("ag-scrollbar-invisible",i),Ar(this.getGui(),r),Ar(this.eViewport,r),Ar(this.eContainer,r),this.setDisplayed(e,{skipAriaHidden:!0})}onRowContainerHeightChanged(t){let i=t.getGridBodyCtrl().eBodyViewport,n=this.getScrollPosition(),r=i.scrollTop;n!=r&&this.setScrollPosition(r,!0)}getScrollPosition(){return this.eViewport.scrollTop}setScrollPosition(t,e){!e&&!Nr(this.eViewport)&&this.attemptSettingScrollPosition(t),this.eViewport.scrollTop=t}},dX={selector:"AG-FAKE-VERTICAL-SCROLL",component:cX},uX="ag-column-first",hX="ag-column-last";function e8(t,e,i,n){return wt(t)?[]:fX(t.headerClass,t,e,i,n)}function t8(t,e,i){t.toggleCss(uX,i.isColAtEdge(e,"first")),t.toggleCss(hX,i.isColAtEdge(e,"last"))}function pX(t,e,i,n){return Ee(e,{colDef:t,column:i,columnGroup:n})}function fX(t,e,i,n,r){if(wt(t))return[];let o;if(typeof t=="function"){let s=pX(e,i,n,r);o=t(s)}else o=t;return typeof o=="string"?[o]:Array.isArray(o)?[...o]:[]}function gX(t,e,i){e.addManagedElementListeners(i,{keydown:n=>{if(!n.defaultPrevented&&n.key===A.TAB){let r=n.shiftKey;Oa(t,i,!1,r)||mc(t,r)&&n.preventDefault()}}})}function mX(t,e){return t.ctrlsSvc.get("gridCtrl").focusInnerElement(e)}function Ra(t){return t.gos.get("suppressHeaderFocus")||!!t.overlays?.isExclusive()}function Wm(t){return t.gos.get("suppressCellFocus")||!!t.overlays?.isExclusive()}function mc(t,e,i=!1){let n=t.ctrlsSvc.get("gridCtrl");return!i&&n.focusNextInnerContainer(e)?!0:((i||!e&&!n.isDetailGrid())&&n.forceFocusOutOfContainer(e),!1)}function Ir(t){return t.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0}function YS(t){let e=[],i=t.ctrlsSvc.getHeaderRowContainerCtrls();for(let n of i){if(!n)continue;let r=n.getGroupRowCount()||0;for(let o=0;o<r;o++){let s=n.getGroupRowCtrlAtIndex(o),a=e[o];if(s){let l=vX(t,s);(a==null||l>a)&&(e[o]=l)}}}return e}function vX(t,e){let n=t.colModel.isPivotMode()?wX(t):n8(t),r=e.getHeaderCellCtrls();for(let o of r){let{column:s}=o,a=s.getAutoHeaderHeight();a!=null&&a>n&&s.isAutoHeaderHeight()&&(n=a)}return n}function XS(t){let i=t.colModel.isPivotMode()?CX(t):Sh(t);return t.colModel.forAllCols(n=>{let r=n.getAutoHeaderHeight();r!=null&&r>i&&n.isAutoHeaderHeight()&&(i=r)}),i}function Sh(t){return t.gos.get("headerHeight")??t.environment.getDefaultHeaderHeight()}function i8(t){return t.gos.get("floatingFiltersHeight")??Sh(t)}function n8(t){return t.gos.get("groupHeaderHeight")??Sh(t)}function CX(t){return t.gos.get("pivotHeaderHeight")??Sh(t)}function wX(t){return t.gos.get("pivotGroupHeaderHeight")??n8(t)}function bX(t,e){return t.headerRowIndex===e.headerRowIndex&&t.column===e.column}var yX=class extends H{setComp(t,e,i){this.comp=t,this.eGui=e;let{beans:n}=this,{headerNavigation:r,touchSvc:o,ctrlsSvc:s}=n;r&&this.createManagedBean(new bc(i,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedEventListeners({columnPivotModeChanged:this.onPivotModeChanged.bind(this,n),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this,n)}),this.onPivotModeChanged(n),this.setupHeaderHeight();let a=this.onHeaderContextMenu.bind(this);this.addManagedElementListeners(this.eGui,{contextmenu:a}),o?.mockHeaderContextMenu(this,a),s.register("gridHeaderCtrl",this)}setupHeaderHeight(){let t=this.setHeaderHeight.bind(this);t(),this.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],t),this.addManagedEventListeners({headerRowsChanged:t,columnHeaderHeightChanged:t,columnGroupHeaderHeightChanged:()=>Eo(this.beans,()=>t()),gridStylesChanged:t,advancedFilterEnabledChanged:t})}setHeaderHeight(){let{beans:t}=this,e=0,i=YS(t).reduce((o,s)=>o+s,0),n=XS(t);if(t.filterManager?.hasFloatingFilters()&&(e+=i8(t)),e+=i,e+=n,this.headerHeight===e)return;this.headerHeight=e;let r=`${e+1}px`;this.comp.setHeightAndMinHeight(r),this.eventSvc.dispatchEvent({type:"headerHeightChanged"})}onPivotModeChanged(t){let e=t.colModel.isPivotMode();this.comp.toggleCss("ag-pivot-on",e),this.comp.toggleCss("ag-pivot-off",!e)}onDisplayedColumnsChanged(t){let i=t.visibleCols.allCols.some(n=>n.isSpanHeaderHeight());this.comp.toggleCss("ag-header-allow-overflow",i)}onTabKeyDown(t){let e=this.gos.get("enableRtl"),i=t.shiftKey,n=i!==e?"LEFT":"RIGHT",{beans:r}=this,{headerNavigation:o,focusSvc:s}=r;(o.navigateHorizontally(n,!0,t)||!i&&s.focusOverlay(!1)||mc(r,i,!0))&&t.preventDefault()}handleKeyDown(t){let e=null,{headerNavigation:i}=this.beans;switch(t.key){case A.LEFT:e="LEFT";case A.RIGHT:{ae(e)||(e="RIGHT"),i.navigateHorizontally(e,!1,t)&&t.preventDefault();break}case A.UP:e="UP";case A.DOWN:{ae(e)||(e="DOWN"),i.navigateVertically(e,t)&&t.preventDefault();break}default:return}}onFocusOut(t){let{relatedTarget:e}=t,{eGui:i,beans:n}=this;!e&&i.contains(St(n))||i.contains(e)||(n.focusSvc.focusedHeader=null)}onHeaderContextMenu(t,e,i){let{menuSvc:n,ctrlsSvc:r}=this.beans;if(!t&&!i||!n?.isHeaderContextMenuEnabled())return;let{target:o}=t??e;(o===this.eGui||o===r.getHeaderRowContainerCtrl()?.eViewport)&&n.showHeaderContextMenu(void 0,t,i)}},JS=class extends et{constructor(t,e){super(t),this.ctrl=e}getCtrl(){return this.ctrl}},SX={tag:"div",cls:"ag-header-cell",role:"columnheader",children:[{tag:"div",ref:"eResize",cls:"ag-header-cell-resize",role:"presentation"},{tag:"div",ref:"eHeaderCompWrapper",cls:"ag-header-cell-comp-wrapper",role:"presentation"}]},xX=class extends JS{constructor(t){super(SX,t),this.eResize=re,this.eHeaderCompWrapper=re,this.headerCompVersion=0}postConstruct(){let t=this.getGui(),e=()=>{let n=this.ctrl.getSelectAllGui();n&&(this.eResize.insertAdjacentElement("afterend",n),this.addDestroyFunc(()=>n.remove()))},i={setWidth:n=>t.style.width=n,toggleCss:(n,r)=>this.toggleCss(n,r),setUserStyles:n=>vh(t,n),setAriaSort:n=>n?Hj(t,n):zj(t),setUserCompDetails:n=>this.setUserCompDetails(n),getUserCompInstance:()=>this.headerComp,refreshSelectAllGui:e,removeSelectAllGui:()=>this.ctrl.getSelectAllGui()?.remove()};this.ctrl.setComp(i,this.getGui(),this.eResize,this.eHeaderCompWrapper,void 0),e()}destroy(){this.destroyHeaderComp(),super.destroy()}destroyHeaderComp(){this.headerComp&&(this.headerCompGui?.remove(),this.headerComp=this.destroyBean(this.headerComp),this.headerCompGui=void 0)}setUserCompDetails(t){this.headerCompVersion++;let e=this.headerCompVersion;t.newAgStackInstance().then(i=>this.afterCompCreated(e,i))}afterCompCreated(t,e){if(t!=this.headerCompVersion||!this.isAlive()){this.destroyBean(e);return}this.destroyHeaderComp(),this.headerComp=e,this.headerCompGui=e.getGui(),this.eHeaderCompWrapper.appendChild(this.headerCompGui),this.ctrl.setDragSource(this.getGui())}},EX={tag:"div",cls:"ag-header-group-cell",role:"columnheader",children:[{tag:"div",ref:"eHeaderCompWrapper",cls:"ag-header-cell-comp-wrapper",role:"presentation"},{tag:"div",ref:"eResize",cls:"ag-header-cell-resize",role:"presentation"}]},PX=class extends JS{constructor(t){super(EX,t),this.eResize=re,this.eHeaderCompWrapper=re}postConstruct(){let t=this.getGui(),e=(n,r)=>r!=null?t.setAttribute(n,r):t.removeAttribute(n),i={toggleCss:(n,r)=>this.toggleCss(n,r),setUserStyles:n=>vh(t,n),setHeaderWrapperHidden:n=>{n?this.eHeaderCompWrapper.style.setProperty("display","none"):this.eHeaderCompWrapper.style.removeProperty("display")},setHeaderWrapperMaxHeight:n=>{n!=null?this.eHeaderCompWrapper.style.setProperty("max-height",`${n}px`):this.eHeaderCompWrapper.style.removeProperty("max-height"),this.eHeaderCompWrapper.classList.toggle("ag-header-cell-comp-wrapper-limited-height",n!=null)},setResizableDisplayed:n=>Ct(this.eResize,n),setWidth:n=>t.style.width=n,setAriaExpanded:n=>e("aria-expanded",n),setUserCompDetails:n=>this.setUserCompDetails(n),getUserCompInstance:()=>this.headerGroupComp};this.ctrl.setComp(i,t,this.eResize,this.eHeaderCompWrapper,void 0)}setUserCompDetails(t){t.newAgStackInstance().then(e=>this.afterHeaderCompCreated(e))}afterHeaderCompCreated(t){let e=()=>this.destroyBean(t);if(!this.isAlive()){e();return}let i=this.getGui(),n=t.getGui();this.eHeaderCompWrapper.appendChild(n),this.addDestroyFunc(e),this.headerGroupComp=t,this.ctrl.setDragSource(i)}},RX={tag:"div",cls:"ag-header-cell ag-floating-filter",role:"gridcell",children:[{tag:"div",ref:"eFloatingFilterBody",role:"presentation"},{tag:"div",ref:"eButtonWrapper",cls:"ag-floating-filter-button ag-hidden",role:"presentation",children:[{tag:"button",ref:"eButtonShowMainFilter",cls:"ag-button ag-floating-filter-button-button",attrs:{type:"button",tabindex:"-1"}}]}]},_X=class extends JS{constructor(t){super(RX,t),this.eFloatingFilterBody=re,this.eButtonWrapper=re,this.eButtonShowMainFilter=re}postConstruct(){let t=this.getGui(),e={toggleCss:(i,n)=>this.toggleCss(i,n),setUserStyles:i=>vh(t,i),addOrRemoveBodyCssClass:(i,n)=>this.eFloatingFilterBody.classList.toggle(i,n),setButtonWrapperDisplayed:i=>Ct(this.eButtonWrapper,i),setCompDetails:i=>this.setCompDetails(i),getFloatingFilterComp:()=>this.compPromise,setWidth:i=>t.style.width=i,setMenuIcon:i=>this.eButtonShowMainFilter.appendChild(i)};this.ctrl.setComp(e,t,this.eButtonShowMainFilter,this.eFloatingFilterBody,void 0)}setCompDetails(t){if(!t){this.destroyFloatingFilterComp(),this.compPromise=null;return}this.compPromise=t.newAgStackInstance(),this.compPromise.then(e=>this.afterCompCreated(e))}destroy(){this.destroyFloatingFilterComp(),super.destroy()}destroyFloatingFilterComp(){this.floatingFilterComp&&(this.floatingFilterComp.getGui().remove(),this.floatingFilterComp=this.destroyBean(this.floatingFilterComp))}afterCompCreated(t){if(t){if(!this.isAlive()){this.destroyBean(t);return}this.destroyFloatingFilterComp(),this.floatingFilterComp=t,this.eFloatingFilterBody.appendChild(t.getGui()),t.afterGuiAttached&&t.afterGuiAttached()}}},kX=class extends et{constructor(t){super({tag:"div",cls:t.headerRowClass,role:"row"}),this.ctrl=t,this.headerComps={}}postConstruct(){this.getGui().setAttribute("tabindex",String(this.gos.get("tabIndex"))),fm(this.getGui(),this.ctrl.getAriaRowIndex());let e={setHeight:i=>this.getGui().style.height=i,setTop:i=>this.getGui().style.top=i,setHeaderCtrls:(i,n)=>this.setHeaderCtrls(i,n),setWidth:i=>this.getGui().style.width=i,setRowIndex:i=>fm(this.getGui(),i)};this.ctrl.setComp(e,void 0)}destroy(){this.setHeaderCtrls([],!1),super.destroy()}setHeaderCtrls(t,e){if(!this.isAlive())return;let i=this.headerComps;this.headerComps={};for(let n of t){let r=n.instanceId,o=i[r];delete i[r],o==null&&(o=this.createHeaderComp(n),this.getGui().appendChild(o.getGui())),this.headerComps[r]=o}if(Object.values(i).forEach(n=>{n.getGui().remove(),this.destroyBean(n)}),e){let n=Object.values(this.headerComps);n.sort((o,s)=>{let a=o.getCtrl().column.getLeft(),l=s.getCtrl().column.getLeft();return a-l});let r=n.map(o=>o.getGui());kD(this.getGui(),r)}}createHeaderComp(t){let e;switch(this.ctrl.type){case"group":e=new PX(t);break;case"filter":e=new _X(t);break;default:e=new xX(t);break}return this.createBean(e),e.setParentComponent(this),e}},QS=class extends H{constructor(t,e,i,n){super(),this.columnOrGroup=t,this.eCell=e,this.colsSpanning=n,this.columnOrGroup=t,this.ariaEl=e.querySelector("[role=columnheader]")||e,this.beans=i}setColsSpanning(t){this.colsSpanning=t,this.onLeftChanged()}getColumnOrGroup(){let{beans:t,colsSpanning:e}=this;return t.gos.get("enableRtl")&&e?dt(e):this.columnOrGroup}postConstruct(){let t=this.onLeftChanged.bind(this);this.addManagedListeners(this.columnOrGroup,{leftChanged:t}),this.setLeftFirstTime(),this.addManagedEventListeners({displayedColumnsWidthChanged:t}),this.addManagedPropertyListener("domLayout",t)}setLeftFirstTime(){let{gos:t,colAnimation:e}=this.beans,i=t.get("suppressColumnMoveAnimation"),n=ae(this.columnOrGroup.getOldLeft());e?.isActive()&&n&&!i?this.animateInLeft():this.onLeftChanged()}animateInLeft(){let t=this.getColumnOrGroup(),e=this.modifyLeftForPrintLayout(t,t.getOldLeft()),i=this.modifyLeftForPrintLayout(t,t.getLeft());this.setLeft(e),this.actualLeft=i,this.beans.colAnimation.executeNextVMTurn(()=>{this.actualLeft===i&&this.setLeft(i)})}onLeftChanged(){let t=this.getColumnOrGroup(),e=t.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(t,e),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(t,e){let{gos:i,visibleCols:n}=this.beans;if(!pi(i,"print")||t.getPinned()==="left")return e;let o=n.getColsLeftWidth();if(t.getPinned()==="right"){let s=n.bodyWidth;return o+s+e}return o+e}setLeft(t){if(ae(t)&&(this.eCell.style.left=`${t}px`),Ot(this.columnOrGroup)){let e=this.columnOrGroup.getLeafColumns();if(!e.length)return;e.length>1&&Bj(this.ariaEl,e.length)}}},FX=0,r8="headerCtrl",ZS=class extends H{constructor(t,e){super(),this.column=t,this.rowCtrl=e,this.resizeToggleTimeout=0,this.resizeMultiplier=1,this.resizeFeature=null,this.lastFocusEvent=null,this.dragSource=null,this.reAttemptToFocus=!1,this.instanceId=t.getUniqueId()+"-"+FX++}postConstruct(){let t=this.refreshTabIndex.bind(this);this.addManagedPropertyListeners(["suppressHeaderFocus"],t),this.addManagedEventListeners({overlayExclusiveChanged:t})}setComp(t,e,i,n,r){e.setAttribute("col-id",this.column.colIdSanitised),this.wireComp(t,e,i,n,r),this.reAttemptToFocus&&(this.reAttemptToFocus=!1,this.focus(this.lastFocusEvent??void 0))}shouldStopEventPropagation(t){let{headerRowIndex:e,column:i}=this.beans.focusSvc.focusedHeader,n=i.getDefinition(),r=n?.suppressHeaderKeyboardEvent;if(!ae(r))return!1;let o=Ee(this.gos,{colDef:n,column:i,headerRowIndex:e,event:t});return!!r(o)}getWrapperHasFocus(){return St(this.beans)===this.eGui}setGui(t,e){this.eGui=t,this.addDomData(e),e.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this)}),e.addManagedElementListeners(this.eGui,{focus:this.onGuiFocus.bind(this)}),this.onDisplayedColumnsChanged(),this.refreshTabIndex()}refreshHeaderStyles(){let t=this.column.getDefinition();if(!t)return;let{headerStyle:e}=t,i;if(typeof e=="function"){let n=this.getHeaderClassParams();i=e(n)}else i=e;i&&this.comp.setUserStyles(i)}onGuiFocus(){this.eventSvc.dispatchEvent({type:"headerFocused",column:this.column})}setupAutoHeight(t){let{wrapperElement:e,checkMeasuringCallback:i,compBean:n}=t,{beans:r}=this,o=u=>{if(!this.isAlive()||!n.isAlive())return;let{paddingTop:h,paddingBottom:p,borderBottomWidth:f,borderTopWidth:g}=Ia(this.eGui),m=h+p+f+g,C=e.offsetHeight+m;if(u<5){let S=!ri(r)?.contains(e),x=C==0;if(S||x){Wy(()=>o(u+1),"raf",r);return}}this.setColHeaderHeight(this.column,C)},s=!1,a,l=()=>{let u=this.column.isAutoHeaderHeight();u&&!s&&c(),!u&&s&&d()},c=()=>{s=!0,this.comp.toggleCss("ag-header-cell-auto-height",!0),o(0),a=Ss(this.beans,e,()=>o(0))},d=()=>{s=!1,a&&a(),this.comp.toggleCss("ag-header-cell-auto-height",!1),a=void 0};l(),n.addDestroyFunc(()=>d()),n.addManagedListeners(this.column,{widthChanged:()=>s&&o(0)}),n.addManagedEventListeners({sortChanged:()=>{s&&window.setTimeout(()=>o(0))}}),i&&i(l)}onDisplayedColumnsChanged(){let{comp:t,column:e,beans:i,eGui:n}=this;!t||!e||!n||(t8(t,e,i.visibleCols),yD(n,i.visibleCols.getAriaColIndex(e)))}addResizeAndMoveKeyboardListeners(t){t.addManagedListeners(this.eGui,{keydown:this.onGuiKeyDown.bind(this),keyup:this.onGuiKeyUp.bind(this)})}refreshTabIndex(){let t=Ra(this.beans);this.eGui&&cn(this.eGui,"tabindex",t?null:"-1")}onGuiKeyDown(t){let e=St(this.beans),i=t.key===A.LEFT||t.key===A.RIGHT;if(this.isResizing&&(t.preventDefault(),t.stopImmediatePropagation()),e!==this.eGui||!t.shiftKey&&!t.altKey||((this.isResizing||i)&&(t.preventDefault(),t.stopImmediatePropagation()),!i))return;let r=t.key===A.LEFT!==this.gos.get("enableRtl")?"left":"right";if(t.altKey){this.isResizing=!0,this.resizeMultiplier+=1;let o=this.getViewportAdjustedResizeDiff(t);this.resizeHeader(o,t.shiftKey),this.resizeFeature?.toggleColumnResizing(!0)}else this.moveHeader(r)}moveHeader(t){this.beans.colMoves?.moveHeader(t,this.eGui,this.column,this.rowCtrl.pinned,this)}getViewportAdjustedResizeDiff(t){let e=this.getResizeDiff(t),{pinnedCols:i}=this.beans;return i?i.getHeaderResizeDiff(e,this.column):e}getResizeDiff(t){let{gos:e,column:i}=this,n=t.key===A.LEFT!==e.get("enableRtl"),r=i.getPinned(),o=e.get("enableRtl");return r&&o!==(r==="right")&&(n=!n),(n?-1:1)*this.resizeMultiplier}onGuiKeyUp(){this.isResizing&&(this.resizeToggleTimeout&&(window.clearTimeout(this.resizeToggleTimeout),this.resizeToggleTimeout=0),this.isResizing=!1,this.resizeMultiplier=1,this.resizeToggleTimeout=window.setTimeout(()=>{this.resizeFeature?.toggleColumnResizing(!1)},150))}handleKeyDown(t){let e=this.getWrapperHasFocus();switch(t.key){case A.PAGE_DOWN:case A.PAGE_UP:case A.PAGE_HOME:case A.PAGE_END:e&&t.preventDefault()}}addDomData(t){let e=r8,{eGui:i,gos:n}=this;Fa(n,i,e,this),t.addDestroyFunc(()=>Fa(n,i,e,null))}focus(t){if(!this.isAlive())return!1;let{eGui:e}=this;return e?(e.focus(),this.lastFocusEvent=t||null):this.reAttemptToFocus=!0,!0}focusThis(){this.beans.focusSvc.focusedHeader={headerRowIndex:this.rowCtrl.rowIndex,column:this.column}}removeDragSource(){this.dragSource&&(this.beans.dragAndDrop?.removeDragSource(this.dragSource),this.dragSource=null)}handleContextMenuMouseEvent(t,e,i){let n=t??e,{menuSvc:r,gos:o}=this.beans;o.get("preventDefaultOnContextMenu")&&n.preventDefault(),r?.isHeaderContextMenuEnabled(i)&&r.showHeaderContextMenu(i,t,e),this.dispatchColumnMouseEvent("columnHeaderContextMenu",i)}dispatchColumnMouseEvent(t,e){this.eventSvc.dispatchEvent({type:t,column:e})}setColHeaderHeight(t,e){if(!t.setAutoHeaderHeight(e))return;let{eventSvc:i}=this;t.isColumn?i.dispatchEvent({type:"columnHeaderHeightChanged",column:t,columns:[t],source:"autosizeColumnHeaderHeight"}):i.dispatchEvent({type:"columnGroupHeaderHeightChanged",columnGroup:t,source:"autosizeColumnGroupHeaderHeight"})}clearComponent(){this.removeDragSource(),this.resizeFeature=null,this.comp=null,this.eGui=null}destroy(){super.destroy(),this.column=null,this.lastFocusEvent=null,this.rowCtrl=null}},TX=class extends ZS{constructor(){super(...arguments),this.refreshFunctions={},this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map}wireComp(t,e,i,n,r){this.comp=t;let{rowCtrl:o,column:s,beans:a}=this,{colResize:l,context:c,colHover:d,rangeSvc:u}=a,h=wh(this,c,r);this.setGui(e,h),this.updateState(),this.setupWidth(h),this.setupMovingCss(h),this.setupMenuClass(h),this.setupSortableClass(h),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight({wrapperElement:n,checkMeasuringCallback:f=>this.setRefreshFunction("measuring",f),compBean:h}),this.addColumnHoverListener(h),this.setupFilterClass(h),this.setupStylesFromColDef(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(h),this.setupSelectAll(h),this.setupUserComp(),this.refreshAria(),l?this.resizeFeature=h.createManagedBean(l.createResizeFeature(o.pinned,s,i,t,this)):Ct(i,!1),d?.createHoverFeature(h,[s],e),u?.createRangeHighlightFeature(h,s,t),h.createManagedBean(new QS(s,e,a)),h.createManagedBean(new bc(e,{shouldStopEventPropagation:f=>this.shouldStopEventPropagation(f),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addResizeAndMoveKeyboardListeners(h),h.addManagedPropertyListeners(["suppressMovableColumns","suppressMenuHide","suppressAggFuncInHeader","enableAdvancedFilter"],()=>this.refresh()),h.addManagedListeners(s,{colDefChanged:()=>this.refresh()}),h.addManagedListeners(s,{headerHighlightChanged:this.onHeaderHighlightChanged.bind(this)});let p=()=>this.checkDisplayName();h.addManagedEventListeners({columnValueChanged:p,columnRowGroupChanged:p,columnPivotChanged:p,headerHeightChanged:this.onHeaderHeightChanged.bind(this)}),h.addDestroyFunc(()=>{this.refreshFunctions={},this.selectAllFeature=null,this.dragSourceElement=void 0,this.userCompDetails=null,this.userHeaderClasses.clear(),this.ariaDescriptionProperties.clear(),this.clearComponent()})}resizeHeader(t,e){this.beans.colResize?.resizeHeader(this.column,t,e)}getHeaderClassParams(){let{column:t,beans:e}=this,i=t.colDef;return Ee(e.gos,{colDef:i,column:t,floatingFilter:!1})}setupUserComp(){let t=this.lookupUserCompDetails();t&&this.setCompDetails(t)}setCompDetails(t){this.userCompDetails=t,this.comp.setUserCompDetails(t)}lookupUserCompDetails(){let t=this.createParams(),e=this.column.getColDef();return D$(this.beans.userCompFactory,e,t)}createParams(){let{menuSvc:t,sortSvc:e,colFilter:i,gos:n}=this.beans;return Ee(n,{column:this.column,displayName:this.displayName,enableSorting:this.column.isSortable(),enableMenu:this.menuEnabled,enableFilterButton:this.openFilterEnabled&&!!t?.isHeaderFilterButtonEnabled(this.column),enableFilterIcon:!!i&&(!this.openFilterEnabled||dn(this.gos)),showColumnMenu:(o,s)=>{t?.showColumnMenu({column:this.column,buttonElement:o,positionBy:"button",onClosedCallback:s})},showColumnMenuAfterMouseClick:(o,s)=>{t?.showColumnMenu({column:this.column,mouseEvent:o,positionBy:"mouse",onClosedCallback:s})},showFilter:o=>{t?.showFilterMenu({column:this.column,buttonElement:o,containerType:"columnFilter",positionBy:"button"})},progressSort:o=>{e?.progressSort(this.column,!!o,"uiColumnSorted")},setSort:(o,s)=>{e?.setSortForColumn(this.column,o,!!s,"uiColumnSorted")},eGridHeader:this.eGui,setTooltip:(o,s)=>{n.assertModuleRegistered("Tooltip",3),this.setupTooltip(o,s)}})}setupSelectAll(t){let{selectionSvc:e}=this.beans;e&&(this.selectAllFeature=t.createOptionalManagedBean(e.createSelectAllFeature(this.column)),this.selectAllFeature?.setComp(this),t.addManagedPropertyListener("rowSelection",()=>{let i=e.createSelectAllFeature(this.column);i&&!this.selectAllFeature?(this.selectAllFeature=t.createManagedBean(i),this.selectAllFeature?.setComp(this),this.comp.refreshSelectAllGui()):this.selectAllFeature&&!i&&(this.comp.removeSelectAllGui(),this.selectAllFeature=this.destroyBean(this.selectAllFeature))}))}getSelectAllGui(){return this.selectAllFeature?.getCheckboxGui()}handleKeyDown(t){super.handleKeyDown(t),t.key===A.SPACE&&this.selectAllFeature?.onSpaceKeyDown(t),t.key===A.ENTER&&this.onEnterKeyDown(t),t.key===A.DOWN&&t.altKey&&this.showMenuOnKeyPress(t,!1)}onEnterKeyDown(t){t.ctrlKey||t.metaKey?this.showMenuOnKeyPress(t,!0):this.sortable&&this.beans.sortSvc?.progressSort(this.column,t.shiftKey,"uiColumnSorted")}showMenuOnKeyPress(t,e){let i=this.comp.getUserCompInstance();ET(i)&&i.onMenuKeyboardShortcut(e)&&t.preventDefault()}onFocusIn(t){this.eGui.contains(t.relatedTarget)||(this.focusThis(),this.announceAriaDescription()),tK()&&this.setActiveHeader(!0)}onFocusOut(t){this.eGui.contains(t.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(t,e){this.tooltipFeature=this.beans.tooltipSvc?.setupHeaderTooltip(this.tooltipFeature,this,t,e)}setupStylesFromColDef(){this.setRefreshFunction("headerStyles",this.refreshHeaderStyles.bind(this)),this.refreshHeaderStyles()}setupClassesFromColDef(){let t=()=>{let e=this.column.getColDef(),i=e8(e,this.gos,this.column,null),n=this.userHeaderClasses;this.userHeaderClasses=new Set(i);for(let r of i)n.has(r)?n.delete(r):this.comp.toggleCss(r,!0);for(let r of n)this.comp.toggleCss(r,!1)};this.setRefreshFunction("headerClasses",t),t()}setDragSource(t){this.dragSourceElement=t,this.removeDragSource(),!(!t||!this.draggable)&&(this.dragSource=this.beans.colMoves?.setDragSourceForHeader(t,this.column,this.displayName)??null)}updateState(){let{menuSvc:t}=this.beans;this.menuEnabled=!!t?.isColumnMenuInHeaderEnabled(this.column),this.openFilterEnabled=!!t?.isFilterMenuInHeaderEnabled(this.column),this.sortable=this.column.isSortable(),this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}setRefreshFunction(t,e){this.refreshFunctions[t]=e}refresh(){this.updateState(),this.refreshHeaderComp(),this.refreshAria();for(let t of Object.values(this.refreshFunctions))t()}refreshHeaderComp(){let t=this.lookupUserCompDetails();if(!t)return;(this.comp.getUserCompInstance()!=null&&this.userCompDetails.componentClass==t.componentClass?this.attemptHeaderCompRefresh(t.params):!1)?this.setDragSource(this.dragSourceElement):this.setCompDetails(t)}attemptHeaderCompRefresh(t){let e=this.comp.getUserCompInstance();return!e||!e.refresh?!1:e.refresh(t)}calculateDisplayName(){return this.beans.colNames.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(){this.displayName!==this.calculateDisplayName()&&this.refresh()}workOutDraggable(){let t=this.column.getColDef();return!!(!this.gos.get("suppressMovableColumns")&&!t.suppressMovable&&!t.lockPosition)||!!t.enableRowGroup||!!t.enablePivot}setupWidth(t){let e=()=>{let i=this.column.getActualWidth();this.comp.setWidth(`${i}px`)};t.addManagedListeners(this.column,{widthChanged:e}),e()}setupMovingCss(t){let e=()=>{this.comp.toggleCss("ag-header-cell-moving",this.column.isMoving())};t.addManagedListeners(this.column,{movingChanged:e}),e()}setupMenuClass(t){let e=()=>{this.comp?.toggleCss("ag-column-menu-visible",this.column.isMenuVisible())};t.addManagedListeners(this.column,{menuVisibleChanged:e}),e()}setupSortableClass(t){let e=()=>{this.comp.toggleCss("ag-header-cell-sortable",!!this.sortable)};e(),this.setRefreshFunction("updateSortable",e),t.addManagedEventListeners({sortChanged:this.refreshAriaSort.bind(this)})}setupFilterClass(t){let e=()=>{let i=this.column.isFilterActive();this.comp.toggleCss("ag-header-cell-filtered",i),this.refreshAria()};t.addManagedListeners(this.column,{filterActiveChanged:e}),e()}setupWrapTextClass(){let t=()=>{let e=!!this.column.getColDef().wrapHeaderText;this.comp.toggleCss("ag-header-cell-wrap-text",e)};t(),this.setRefreshFunction("wrapText",t)}onHeaderHighlightChanged(){let t=this.column.getHighlighted(),e=t===0,i=t===1;this.comp.toggleCss("ag-header-highlight-before",e),this.comp.toggleCss("ag-header-highlight-after",i)}onDisplayedColumnsChanged(){super.onDisplayedColumnsChanged(),this.isAlive()&&this.onHeaderHeightChanged()}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){let{eGui:t,column:e,comp:i,beans:n}=this,r=YS(this.beans),o=r.reduce((h,p)=>h+p,0)===0;if(i.toggleCss("ag-header-parent-hidden",o),!e.isSpanHeaderHeight()){t.style.removeProperty("top"),t.style.removeProperty("height"),i.toggleCss("ag-header-span-height",!1),i.toggleCss("ag-header-span-total",!1);return}let{numberOfParents:s,isSpanningTotal:a}=this.column.getColumnGroupPaddingInfo();i.toggleCss("ag-header-span-height",s>0);let l=XS(n);if(s===0){i.toggleCss("ag-header-span-total",!1),t.style.setProperty("top","0px"),t.style.setProperty("height",`${l}px`);return}i.toggleCss("ag-header-span-total",a);let c=(this.column.getFirstRealParent()?.getLevel()??-1)+1,d=r.length-c,u=0;for(let h=0;h<d;h++)u+=r[r.length-1-h];t.style.setProperty("top",`${-u}px`),t.style.setProperty("height",`${l+u}px`)}refreshAriaSort(){if(this.sortable){let t=this.getLocaleTextFunc(),e=this.beans.sortSvc?.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(Rj(e)),this.setAriaDescriptionProperty("sort",t("ariaSortableColumn","Press ENTER to sort"))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)}refreshAriaMenu(){if(this.menuEnabled){let t=this.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",t("ariaMenuColumn","Press ALT DOWN to open column menu"))}else this.setAriaDescriptionProperty("menu",null)}refreshAriaFilterButton(){if(this.openFilterEnabled&&!dn(this.gos)){let t=this.getLocaleTextFunc();this.setAriaDescriptionProperty("filterButton",t("ariaFilterColumn","Press CTRL ENTER to open filter"))}else this.setAriaDescriptionProperty("filterButton",null)}refreshAriaFiltered(){let t=this.getLocaleTextFunc();this.column.isFilterActive()?this.setAriaDescriptionProperty("filter",t("ariaColumnFiltered","Column Filtered")):this.setAriaDescriptionProperty("filter",null)}setAriaDescriptionProperty(t,e){e!=null?this.ariaDescriptionProperties.set(t,e):this.ariaDescriptionProperties.delete(t)}announceAriaDescription(){if(!this.eGui.contains(St(this.beans)))return;let t=Array.from(this.ariaDescriptionProperties.keys()).sort((e,i)=>e==="filter"?-1:i.charCodeAt(0)-e.charCodeAt(0)).map(e=>this.ariaDescriptionProperties.get(e)).join(". ");this.beans.ariaAnnounce?.announceValue(t,"columnHeader")}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaFilterButton(),this.refreshAriaFiltered()}addColumnHoverListener(t){this.beans.colHover?.addHeaderColumnHoverListener(t,this.comp,this.column)}addActiveHeaderMouseListeners(t){let e=r=>this.handleMouseOverChange(r.type==="mouseenter"),i=()=>{this.setActiveHeader(!0),this.dispatchColumnMouseEvent("columnHeaderClicked",this.column)},n=r=>this.handleContextMenuMouseEvent(r,void 0,this.column);t.addManagedListeners(this.eGui,{mouseenter:e,mouseleave:e,click:i,contextmenu:n})}handleMouseOverChange(t){this.setActiveHeader(t),this.eventSvc.dispatchEvent({type:t?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column})}setActiveHeader(t){this.comp.toggleCss("ag-header-active",t)}getAnchorElementForMenu(t){let e=this.comp.getUserCompInstance();return ET(e)?e.getAnchorElementForMenu(t):this.eGui}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function ET(t){return typeof t?.getAnchorElementForMenu=="function"&&typeof t.onMenuKeyboardShortcut=="function"}var DX=0,Ey=class extends H{constructor(t,e,i){super(),this.rowIndex=t,this.pinned=e,this.type=i,this.instanceId=DX++,this.comp=null,this.allCtrls=[];let n="ag-header-row-column";i==="group"?n="ag-header-row-group":i==="filter"&&(n="ag-header-row-filter"),this.headerRowClass=`ag-header-row ${n}`}setRowIndex(t){this.rowIndex=t,this.comp?.setRowIndex(this.getAriaRowIndex()),this.onRowHeightChanged()}postConstruct(){this.isPrintLayout=pi(this.gos,"print"),this.isEnsureDomOrder=this.gos.get("ensureDomOrder")}areCellsRendered(){return this.comp?this.allCtrls.every(t=>t.eGui!=null):!1}setComp(t,e,i=!0){this.comp=t,e=wh(this,this.beans.context,e),i&&(this.setRowIndex(this.rowIndex),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners(e)}getAriaRowIndex(){return this.rowIndex+1}addEventListeners(t){let e=this.onRowHeightChanged.bind(this),i=this.onDisplayedColumnsChanged.bind(this);t.addManagedEventListeners({columnResized:this.setWidth.bind(this),displayedColumnsChanged:i,virtualColumnsChanged:n=>this.onVirtualColumnsChanged(n.afterScroll),columnGroupHeaderHeightChanged:e,columnHeaderHeightChanged:e,gridStylesChanged:e,advancedFilterEnabledChanged:e}),t.addManagedPropertyListener("domLayout",i),t.addManagedPropertyListener("ensureDomOrder",n=>this.isEnsureDomOrder=n.currentValue),t.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],e)}onDisplayedColumnsChanged(){this.isPrintLayout=pi(this.gos,"print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}setWidth(){if(!this.comp)return;let t=this.getWidthForRow();this.comp.setWidth(`${t}px`)}getWidthForRow(){let{visibleCols:t}=this.beans;return this.isPrintLayout?this.pinned!=null?0:t.getContainerWidth("right")+t.getContainerWidth("left")+t.getContainerWidth(null):t.getContainerWidth(this.pinned)}onRowHeightChanged(){if(!this.comp)return;let{topOffset:t,rowHeight:e}=this.getTopAndHeight();this.comp.setTop(t+"px"),this.comp.setHeight(e+"px")}getTopAndHeight(){let t=0,e=YS(this.beans);for(let r=0;r<e.length;r++){if(r===this.rowIndex&&this.type==="group")return{topOffset:t,rowHeight:e[r]};t+=e[r]}let i=XS(this.beans);if(this.type==="column")return{topOffset:t,rowHeight:i};t+=i;let n=i8(this.beans);return{topOffset:t,rowHeight:n}}onVirtualColumnsChanged(t=!1){if(!this.comp)return;let e=this.getUpdatedHeaderCtrls(),i=this.isEnsureDomOrder||this.isPrintLayout;this.comp.setHeaderCtrls(e,i,t)}getUpdatedHeaderCtrls(){let t=this.ctrlsById;this.ctrlsById=new Map;let e=this.getColumnsInViewport();for(let n of e)this.recycleAndCreateHeaderCtrls(n,this.ctrlsById,t);let i=n=>{let{focusSvc:r,visibleCols:o}=this.beans;return r.isHeaderWrapperFocused(n)?o.isVisible(n.column):!1};if(t)for(let[n,r]of t)i(r)?this.ctrlsById.set(n,r):this.destroyBean(r);return this.allCtrls=Array.from(this.ctrlsById.values()),this.allCtrls}getHeaderCellCtrls(){return this.allCtrls}recycleAndCreateHeaderCtrls(t,e,i){if(t.isEmptyGroup())return;let n=t.getUniqueId(),r;if(i&&(r=i.get(n),i.delete(n)),r&&r.column!=t&&(this.destroyBean(r),r=void 0),r==null)switch(this.type){case"filter":{r=this.createBean(this.beans.registry.createDynamicBean("headerFilterCellCtrl",!0,t,this));break}case"group":r=this.createBean(this.beans.registry.createDynamicBean("headerGroupCellCtrl",!0,t,this));break;default:r=this.createBean(new TX(t,this));break}e.set(n,r)}getColumnsInViewport(){if(!this.isPrintLayout)return this.getComponentsToRender();if(this.pinned)return[];let t=[];for(let e of["left",null,"right"])t.push(...this.getComponentsToRender(e));return t}getComponentsToRender(t=this.pinned){return this.type==="group"?this.beans.colViewport.getHeadersToRender(t,this.rowIndex):this.beans.colViewport.getColumnHeadersToRender(t)}focusHeader(t,e){let i=this.allCtrls.find(r=>r.column==t);return i?i.focus(e):!1}destroy(){this.allCtrls=this.destroyBeans(this.allCtrls),this.ctrlsById=void 0,this.comp=null,super.destroy()}},MX=class extends H{constructor(t){super(),this.pinned=t,this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[]}setComp(t,e){this.comp=t,this.eViewport=e;let{pinnedCols:i,ctrlsSvc:n,colModel:r,colMoves:o}=this.beans;this.setupCenterWidth(),i?.setupHeaderPinnedWidth(this),this.setupDragAndDrop(o,this.eViewport);let s=this.refresh.bind(this,!0);this.addManagedEventListeners({displayedColumnsChanged:s,advancedFilterEnabledChanged:s});let a=`${typeof this.pinned=="string"?this.pinned:"center"}Header`;n.register(a,this),r.ready&&this.refresh()}getAllCtrls(){let t=[...this.groupsRowCtrls];return this.columnsRowCtrl&&t.push(this.columnsRowCtrl),this.filtersRowCtrl&&t.push(this.filtersRowCtrl),t}refresh(t=!1){let{focusSvc:e,filterManager:i,visibleCols:n}=this.beans,r=0,o=e.getFocusHeaderToUseAfterRefresh(),s=()=>{let u=n.headerGroupRowCount;r=u,t||(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls));let h=this.groupsRowCtrls.length;if(h!==u){if(h>u){for(let p=u;p<h;p++)this.destroyBean(this.groupsRowCtrls[p]);this.groupsRowCtrls.length=u;return}for(let p=h;p<u;p++){let f=this.createBean(new Ey(p,this.pinned,"group"));this.groupsRowCtrls.push(f)}}},a=()=>{let u=r++;if(this.hidden){this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl);return}this.columnsRowCtrl==null||!t?(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl),this.columnsRowCtrl=this.createBean(new Ey(u,this.pinned,"column"))):this.columnsRowCtrl.rowIndex!==u&&this.columnsRowCtrl.setRowIndex(u)},l=()=>{this.includeFloatingFilter=!!i?.hasFloatingFilters()&&!this.hidden;let u=()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)};if(!this.includeFloatingFilter){u();return}t||u();let h=r++;this.filtersRowCtrl?this.filtersRowCtrl.rowIndex!==h&&this.filtersRowCtrl.setRowIndex(h):this.filtersRowCtrl=this.createBean(new Ey(h,this.pinned,"filter"))},c=this.getAllCtrls();s(),a(),l();let d=this.getAllCtrls();this.comp.setCtrls(d),this.restoreFocusOnHeader(e,o),c.length!==d.length&&this.beans.eventSvc.dispatchEvent({type:"headerRowsChanged"})}getHeaderCtrlForColumn(t){let e=i=>i?.getHeaderCellCtrls().find(n=>n.column===t);if(bs(t))return e(this.columnsRowCtrl);if(this.groupsRowCtrls.length!==0)for(let i=0;i<this.groupsRowCtrls.length;i++){let n=e(this.groupsRowCtrls[i]);if(n)return n}}getHtmlElementForColumnHeader(t){return this.getHeaderCtrlForColumn(t)?.eGui??null}getRowType(t){return this.getAllCtrls()[t]?.type}focusHeader(t,e,i){let r=this.getAllCtrls()[t];return r?r.focusHeader(e,i):!1}getGroupRowCount(){return this.groupsRowCtrls.length}getGroupRowCtrlAtIndex(t){return this.groupsRowCtrls[t]}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}setHorizontalScroll(t){this.comp.setViewportScrollLeft(t)}onScrollCallback(t){this.addManagedElementListeners(this.eViewport,{scroll:t})}destroy(){this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl),this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl),this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls),super.destroy()}setupDragAndDrop(t,e){let i=t?.createBodyDropTarget(this.pinned,e);i&&this.createManagedBean(i)}restoreFocusOnHeader(t,e){if(!e)return;let{column:i}=e;i.getPinned()==this.pinned&&t.focusHeaderPosition({headerPosition:e,scroll:!1})}setupCenterWidth(){this.pinned==null&&this.createManagedBean(new $S(t=>this.comp.setCenterWidth(`${t}px`),!0))}},IX=class extends H{constructor(){super(...arguments),this.beanName="menuSvc"}postConstruct(){let{enterpriseMenuFactory:t,filterMenuFactory:e}=this.beans;this.activeMenuFactory=t??e}showColumnMenu(t){this.showColumnMenuCommon(this.activeMenuFactory,t,"columnMenu")}showFilterMenu(t){this.showColumnMenuCommon(RT(this.beans),t,t.containerType,!0)}showHeaderContextMenu(t,e,i){this.activeMenuFactory?.showMenuAfterContextMenuEvent(t,e,i)}hidePopupMenu(){this.beans.contextMenuSvc?.hideActiveMenu(),this.activeMenuFactory?.hideActiveMenu()}hideFilterMenu(){RT(this.beans)?.hideActiveMenu()}isColumnMenuInHeaderEnabled(t){let{suppressHeaderMenuButton:e}=t.getColDef();return!e&&!!this.activeMenuFactory?.isMenuEnabled(t)&&(dn(this.gos)||!!this.beans.enterpriseMenuFactory)}isFilterMenuInHeaderEnabled(t){return!t.getColDef().suppressHeaderFilterButton&&!!this.beans.filterManager?.isFilterAllowed(t)}isHeaderContextMenuEnabled(t){return!(t&&bs(t)?t.getColDef():t?.getColGroupDef())?.suppressHeaderContextMenu&&this.gos.get("columnMenu")==="new"}isHeaderMenuButtonAlwaysShowEnabled(){return this.isSuppressMenuHide()}isHeaderMenuButtonEnabled(){let t=!this.isSuppressMenuHide();return!(Pa()&&t)}isHeaderFilterButtonEnabled(t){return this.isFilterMenuInHeaderEnabled(t)&&!dn(this.gos)&&!this.isFloatingFilterButtonDisplayed(t)}isFilterMenuItemEnabled(t){return!!this.beans.filterManager?.isFilterAllowed(t)&&!dn(this.gos)&&!this.isFilterMenuInHeaderEnabled(t)&&!this.isFloatingFilterButtonDisplayed(t)}isFloatingFilterButtonEnabled(t){return!t.getColDef().suppressFloatingFilterButton}isFloatingFilterButtonDisplayed(t){return!!t.getColDef().floatingFilter&&this.isFloatingFilterButtonEnabled(t)}isSuppressMenuHide(){let t=this.gos,e=t.get("suppressMenuHide");return dn(t)?t.exists("suppressMenuHide")?e:!1:e}showColumnMenuCommon(t,e,i,n){let{positionBy:r,onClosedCallback:o}=e,s=e.column;if(r==="button"){let{buttonElement:a}=e;t?.showMenuAfterButtonClick(s,a,i,o,n)}else if(r==="mouse"){let{mouseEvent:a}=e;t?.showMenuAfterMouseEvent(s,a,i,o,n)}else if(s){let a=this.beans,l=a.ctrlsSvc;l.getScrollFeature().ensureColumnVisible(s,"auto"),Eo(a,()=>{let c=l.getHeaderRowContainerCtrl(s.getPinned())?.getHeaderCtrlForColumn(s);c&&t?.showMenuAfterButtonClick(s,c.getAnchorElementForMenu(n),i,o,n)})}}};function PT(t,e,i){t.menuVisible!==e&&(t.menuVisible=e,t.dispatchColEvent("menuVisibleChanged",i))}function RT(t){let{enterpriseMenuFactory:e,filterMenuFactory:i,gos:n}=t;return e&&dn(n)?e:i}var Um=class extends OS{constructor(){super(...arguments),this.errorMessages=null}init(t){this.params=t,this.initialiseEditor(t),this.eEditor.onValueChange(()=>t.validate())}destroy(){this.errorMessages=null}},o8=class extends et{constructor(){super()}},AX={tag:"span",cls:"ag-overlay-loading-center"},OX=class extends o8{init(){let t=Co(this.gos.get("overlayLoadingTemplate")?.trim());if(this.setTemplate(t??AX),!t){let i=this.getLocaleTextFunc()("loadingOoo","Loading...");this.getGui().textContent=i,this.beans.ariaAnnounce.announceValue(i,"overlay")}}},LX={tag:"span",cls:"ag-overlay-no-rows-center"},NX=class extends o8{init(){let t=Co(this.gos.get("overlayNoRowsTemplate")?.trim());if(this.setTemplate(t??LX),!t){let i=this.getLocaleTextFunc()("noRowsToShow","No Rows To Show");this.getGui().textContent=i,this.beans.ariaAnnounce.announceValue(i,"overlay")}}};function BX(t,e,i){let n=Mn(t,e,i);if(n){let{className:o}=n;if(typeof o=="string"&&o.includes("ag-icon")||typeof o=="object"&&o["ag-icon"])return n}let r=Nt({tag:"span"});return r.appendChild(n),r}function Mn(t,e,i){let n=null;t==="smallDown"?K(262):t==="smallLeft"?K(263):t==="smallRight"&&K(264);let r=i?.getColDef().icons;if(r&&(n=r[t]),e.gos&&!n){let o=e.gos.get("icons");o&&(n=o[t])}if(n){let o;if(typeof n=="function")o=n();else if(typeof n=="string")o=n;else{K(38,{iconName:t});return}if(typeof o=="string")return ES(o);if(_S(o))return o;K(133,{iconName:t});return}else{let o=e.registry.getIcon(t);return o||e.validation?.validateIcon(t),Nt({tag:"span",cls:`ag-icon ag-icon-${o??t}`,role:"presentation",attrs:{unselectable:"on"}})}}var HX=".ag-dnd-ghost{align-items:center;background-color:var(--ag-drag-and-drop-image-background-color);border:var(--ag-drag-and-drop-image-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-drag-and-drop-image-shadow);color:var(--ag-text-color);cursor:move;display:flex;font-weight:500;gap:var(--ag-cell-widget-spacing);height:var(--ag-header-height);overflow:hidden;padding-left:var(--ag-cell-horizontal-padding);padding-right:var(--ag-cell-horizontal-padding);text-overflow:ellipsis;transform:translateY(calc(var(--ag-spacing)*2));white-space:nowrap}.ag-dnd-ghost-not-allowed{border:var(--ag-drag-and-drop-image-not-allowed-border)}",zX={tag:"div",children:[{tag:"div",ref:"eGhost",cls:"ag-dnd-ghost ag-unselectable",children:[{tag:"span",ref:"eIcon",cls:"ag-dnd-ghost-icon ag-shake-left-to-right"},{tag:"div",ref:"eLabel",cls:"ag-dnd-ghost-label"}]}]},VX=class extends et{constructor(){super(),this.dragSource=null,this.eIcon=re,this.eLabel=re,this.eGhost=re,this.registerCSS(HX)}postConstruct(){let t=e=>BX(e,this.beans,null);this.dropIconMap={pinned:t("columnMovePin"),hide:t("columnMoveHide"),move:t("columnMoveMove"),left:t("columnMoveLeft"),right:t("columnMoveRight"),group:t("columnMoveGroup"),aggregate:t("columnMoveValue"),pivot:t("columnMovePivot"),notAllowed:t("dropNotAllowed")}}init(t){this.dragSource=t.dragSource,this.setTemplate(zX),this.beans.environment.applyThemeClasses(this.eGhost)}destroy(){this.dragSource=null,super.destroy()}setIcon(t,e){let{eGhost:i,eIcon:n,dragSource:r,dropIconMap:o,gos:s}=this;hi(n);let a=null;t||(t=r?.getDefaultIconName?r.getDefaultIconName():"notAllowed"),a=o[t],i.classList.toggle("ag-dnd-ghost-not-allowed",t==="notAllowed"),n.classList.toggle("ag-shake-left-to-right",e),!(a===o.hide&&s.get("suppressDragLeaveHidesColumns"))&&a&&n.appendChild(a)}setLabel(t){this.eLabel.textContent=t}},GX=".ag-checkbox-cell{height:100%}",WX={tag:"div",cls:"ag-cell-wrapper ag-checkbox-cell",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},UX=class extends et{constructor(){super(WX,[BS]),this.eCheckbox=re,this.registerCSS(GX)}init(t){this.refresh(t);let{eCheckbox:e,beans:i}=this,n=e.getInputElement();n.setAttribute("tabindex","-1"),wD(n,"polite"),this.addManagedListeners(n,{click:r=>{if(Da(r),e.isDisabled())return;let o=e.getValue();this.onCheckboxChanged(o)},dblclick:r=>{Da(r)}}),this.addManagedElementListeners(t.eGridCell,{keydown:r=>{if(r.key===A.SPACE&&!e.isDisabled()){t.eGridCell===St(i)&&e.toggle();let o=e.getValue();this.onCheckboxChanged(o),r.preventDefault()}}})}refresh(t){return this.params=t,this.updateCheckbox(t),!0}updateCheckbox(t){let e,i=!0,{value:n,column:r,node:o}=t;if(o.group&&r)if(typeof n=="boolean")e=n;else{let u=r.getColId();u.startsWith(Hm)?e=n==null||n===""?void 0:n==="true":o.aggData&&o.aggData[u]!==void 0||o.sourceRowIndex>=0?e=n??void 0:i=!1}else e=n??void 0;let{eCheckbox:s}=this;if(!i){s.setDisplayed(!1);return}s.setValue(e);let a=t.disabled??!r?.isCellEditable(o);s.setDisabled(a);let l=this.getLocaleTextFunc(),c=Nm(l,e),d=a?c:`${l("ariaToggleCellValue","Press SPACE to toggle cell value")} (${c})`;s.setInputAriaLabel(d)}onCheckboxChanged(t){let{params:e}=this,{column:i,node:n,value:r}=e;this.beans?.editSvc?.setEditingCells([{column:i,colId:i.getColId(),rowIndex:n.rowIndex,rowPinned:n.rowPinned,state:"changed",oldValue:r,newValue:r}],{update:!0,forceRefreshOfEditCellsOnly:!0});let o=n.setDataValue(i,t,"renderer");this.beans.editSvc?.stopEditing({rowNode:n,column:i},{source:this.beans.editSvc?.isBatchEditing()?"ui":"api"}),o||this.updateCheckbox(e)}},_T=class{constructor(t,e){this.beans=t,this.floating=e,this.all=new Set,this.visible=new Set,this.order=[],this.queued=new Set}size(){return this.visible.size}add(t){let{all:e,visible:i,order:n}=this;e.has(t)||(e.add(t),i.add(t),n.push(t),this.sort())}delete(t){this.all.delete(t),this.visible.delete(t),this.queued.delete(t.id),er(this.order,t)}has(t){return this.visible.has(t)}forEach(t){this.order.forEach(t)}getByIndex(t){return this.order[t]}getById(t){for(let e of this.visible)if(e.id==t)return e}clear(){let{all:t,visible:e,order:i,queued:n}=this;t.clear(),n.clear(),e.clear(),i.length=0}sort(){let{sortSvc:t,rowNodeSorter:e,gos:i}=this.beans,n=t?.getSortOptions()??[],r=$X(this.order);if(this.order.sort((s,a)=>(s.pinnedSibling?.rowIndex??0)-(a.pinnedSibling?.rowIndex??0)),this.order=e?.doFullSort(this.order,n)??this.order,!r)return;let o=KD(i);o==="bottom"||o==="pinnedBottom"?this.order.push(r):this.order.unshift(r)}hide(t){let{all:e,visible:i}=this;e.forEach(n=>t(n)?i.delete(n):i.add(n)),this.order=Array.from(i),this.sort()}queue(t){this.queued.add(t)}unqueue(t){this.queued.delete(t)}forEachQueued(t){this.queued.forEach(t)}};function s8(t){if(t.level===-1)return!0;let e=t.parent;return e?.childrenAfterSort?.some(i=>i==t)?s8(e):!1}function Py(t,e){let{gos:i,rowModel:n,filterManager:r}=t;return wc(i,n)?!n.getRowNode(e.id):r?.isAnyFilterPresent()?!s8(e):i.get("pivotMode")?!e.group:!1}function jX(t){return!!t.footer&&t.level===-1}function qX(t){return!!t.pinnedSibling&&jX(t.pinnedSibling)}function $X(t){let e=t.findIndex(qX);if(e>-1)return t.splice(e,1)?.[0]}var kT=class extends H{postConstruct(){let{gos:t,beans:e}=this;this.top=new _T(e,"top"),this.bottom=new _T(e,"bottom");let i=r=>Py(e,r.pinnedSibling),n=()=>{let r=t.get("isRowPinned");r&&t.get("enableRowPinning")&&e.rowModel.forEachNode(o=>this.pinRow(o,r(o)),!0),this.refreshRowPositions(),this.dispatchRowPinnedEvents()};this.addManagedEventListeners({gridStylesChanged:this.onGridStylesChanges.bind(this),modelUpdated:({keepRenderedRows:r})=>{this.tryToEmptyQueues(),this.pinGrandTotalRow(),this.forContainers(s=>s.hide(i));let o=this.refreshRowPositions();(!r||o)&&this.dispatchRowPinnedEvents()},columnRowGroupChanged:()=>{this.forContainers(YX),this.refreshRowPositions()},rowNodeDataChanged:({node:r})=>{(t.get("isRowPinnable")?.(r)??!0)||this.pinRow(r,null)},firstDataRendered:n}),this.addManagedPropertyListener("pivotMode",()=>{this.forContainers(r=>r.hide(i)),this.dispatchRowPinnedEvents()}),this.addManagedPropertyListener("grandTotalRow",({currentValue:r})=>{this._grandTotalPinned=r==="pinnedBottom"?"bottom":r==="pinnedTop"?"top":null}),this.addManagedPropertyListener("isRowPinned",n)}destroy(){this.reset(!1),super.destroy()}reset(t=!0){this.forContainers(e=>{let i=[];e.forEach(n=>i.push(n)),i.forEach(n=>this.pinRow(n,null)),e.clear()}),t&&this.dispatchRowPinnedEvents()}pinRow(t,e,i){if(t.footer&&t.level>-1)return;if(t.footer&&t.level===-1){this._grandTotalPinned=e,JX(this.beans);return}let n=t.rowPinned??t.pinnedSibling?.rowPinned;if(n!=null&&e!=null&&e!=n){let s=t.rowPinned?t:t.pinnedSibling,a=t.rowPinned?t.pinnedSibling:t;this.pinRow(s,null,i),this.pinRow(a,e,i);return}let o=i&&XX(this.beans,t,i);if(o){o.forEach(s=>this.pinRow(s,e));return}if(e==null){let s=t.rowPinned?t:t.pinnedSibling,a=this.findPinnedRowNode(s);if(!a)return;a.delete(s);let l=s.pinnedSibling;Ry(s),this.refreshRowPositions(e),this.dispatchRowPinnedEvents(l)}else{let s=FT(this.beans,t,e),a=this.getContainer(e);a.add(s),Py(this.beans,t)&&a.hide(l=>Py(this.beans,l.pinnedSibling)),this.refreshRowPositions(e),this.dispatchRowPinnedEvents(t)}}isManual(){return!0}isEmpty(t){return this.getContainer(t).size()===0}isRowsToRender(t){return!this.isEmpty(t)}ensureRowHeightsValid(){let t=!1,e=0,i=n=>{if(n.rowHeightEstimated){let r=ws(this.beans,n);n.setRowTop(e),n.setRowHeight(r.height),e+=r.height,t=!0}};return this.bottom.forEach(i),e=0,this.top.forEach(i),this.eventSvc.dispatchEvent({type:"pinnedHeightChanged"}),t}getPinnedTopTotalHeight(){return TT(this.top)}getPinnedBottomTotalHeight(){return TT(this.bottom)}getPinnedTopRowCount(){return this.top.size()}getPinnedBottomRowCount(){return this.bottom.size()}getPinnedTopRow(t){return this.top.getByIndex(t)}getPinnedBottomRow(t){return this.bottom.getByIndex(t)}getPinnedRowById(t,e){return this.getContainer(e).getById(t)}forEachPinnedRow(t,e){this.getContainer(t).forEach(e)}getPinnedState(){let t=e=>{let i=[];return this.forEachPinnedRow(e,n=>i.push(n.pinnedSibling.id)),i};return{top:t("top"),bottom:t("bottom")}}setPinnedState(t){this.forContainers((e,i)=>{for(let n of t[i]){let r=this.beans.rowModel.getRowNode(n);r?this.pinRow(r,i):e.queue(n)}})}getGrandTotalPinned(){return this._grandTotalPinned}setGrandTotalPinned(t){this._grandTotalPinned=t}tryToEmptyQueues(){this.forContainers((t,e)=>{let i=new Set;t.forEachQueued(n=>{let r=this.beans.rowModel.getRowNode(n);r&&i.add(r)});for(let n of i)t.unqueue(n.id),this.pinRow(n,e)})}pinGrandTotalRow(){let{gos:t,beans:e,_grandTotalPinned:i}=this,n=e.rowModel;if(!Lt(t,n))return;let r=n.rootNode?.sibling;if(!r)return;let o=r.pinnedSibling,s=o&&this.findPinnedRowNode(o);if(i){if(s&&s.floating!==i&&(s.delete(o),Ry(o)),!s||s.floating!==i){let a=FT(e,r,i);this.getContainer(i).add(a)}}else{if(!s)return;s.delete(o),Ry(o)}}onGridStylesChanges(t){t.rowHeightChanged&&this.forContainers(e=>e.forEach(i=>i.setRowHeight(i.rowHeight,!0)))}getContainer(t){return t==="top"?this.top:this.bottom}findPinnedRowNode(t){if(this.top.has(t))return this.top;if(this.bottom.has(t))return this.bottom}refreshRowPositions(t){let e=n=>KX(this.beans,n);if(t)return e(this.getContainer(t));let i=!1;return this.forContainers(n=>{let r=e(n);i||(i=r)}),i}forContainers(t){t(this.top,"top"),t(this.bottom,"bottom")}dispatchRowPinnedEvents(t){this.eventSvc.dispatchEvent({type:"pinnedRowsChanged"}),t?.dispatchRowEvent("rowPinned")}};function KX(t,e){let i=0,n=!1;return e.forEach((r,o)=>{if(n||(n=r.rowTop!==i),r.setRowTop(i),r.rowHeightEstimated||r.rowHeight==null){let s=ws(t,r).height;n||(n=r.rowHeight!==s),r.setRowHeight(s)}r.setRowIndex(o),i+=r.rowHeight}),n}function FT(t,e,i){if(e.pinnedSibling)return e.pinnedSibling;let n=uY(e,t);n.setRowTop(null),n.setRowIndex(null),n.rowPinned=i;let r=i==="top"?WS:US;return n.id=`${r}${i}-${e.id}`,n.pinnedSibling=e,e.pinnedSibling=n,n}function Ry(t){if(!t.pinnedSibling)return;t.rowPinned=null,t.setRowTop(null),t.setRowIndex(null);let e=t.pinnedSibling;t.pinnedSibling=void 0,e&&(e.pinnedSibling=void 0,e.rowPinned=null)}function YX(t){let e=new Set;t.forEach(i=>{i.group&&e.add(i)}),e.forEach(i=>t.delete(i))}function XX(t,e,i){let{rowSpanSvc:n}=t,r=(i&&n?.isCellSpanning(i,e))??!1;if(i&&r)return n?.getCellSpan(i,e)?.spannedNodes}function TT(t){let e=t.size();if(e===0)return 0;let i=t.getByIndex(e-1);return i===void 0?0:i.rowTop+i.rowHeight}function JX({gos:t,rowModel:e}){Lt(t,e)&&e.refreshModel({step:"map"})}var DT=class extends H{constructor(){super(...arguments),this.nextId=0,this.pinnedTopRows={cache:{},order:[]},this.pinnedBottomRows={cache:{},order:[]}}postConstruct(){let t=this.gos;this.setPinnedRowData(t.get("pinnedTopRowData"),"top"),this.setPinnedRowData(t.get("pinnedBottomRowData"),"bottom"),this.addManagedPropertyListener("pinnedTopRowData",e=>this.setPinnedRowData(e.currentValue,"top")),this.addManagedPropertyListener("pinnedBottomRowData",e=>this.setPinnedRowData(e.currentValue,"bottom")),this.addManagedEventListeners({gridStylesChanged:this.onGridStylesChanges.bind(this)})}reset(){}isEmpty(t){return this.getCache(t).order.length===0}isRowsToRender(t){return!this.isEmpty(t)}isManual(){return!1}pinRow(t,e){}onGridStylesChanges(t){if(t.rowHeightChanged){let e=i=>{i.setRowHeight(i.rowHeight,!0)};Vu(this.pinnedBottomRows,e),Vu(this.pinnedTopRows,e)}}ensureRowHeightsValid(){let t=!1,e=0,i=n=>{if(n.rowHeightEstimated){let r=ws(this.beans,n);n.setRowTop(e),n.setRowHeight(r.height),e+=r.height,t=!0}};return Vu(this.pinnedBottomRows,i),e=0,Vu(this.pinnedTopRows,i),this.eventSvc.dispatchEvent({type:"pinnedHeightChanged"}),t}setPinnedRowData(t,e){this.updateNodesFromRowData(t,e),this.eventSvc.dispatchEvent({type:"pinnedRowDataChanged"})}updateNodesFromRowData(t,e){let i=this.getCache(e);if(t===void 0){i.order.length=0,i.cache={};return}let n=pc(this.gos),r=e==="top"?WS:US,o=new Set(i.order),s=[],a=new Set,l=0,c=-1;for(let d of t){let u=n?.({data:d,level:0,rowPinned:e})??r+this.nextId++;if(a.has(u)){K(96,{id:u,data:d});continue}c++,a.add(u),s.push(u);let h=eh(i,u);if(h!==void 0)h.data!==d&&h.updateData(d),l+=this.setRowTopAndRowIndex(h,l,c),o.delete(u);else{let p=new ys(this.beans);p.id=u,p.data=d,p.rowPinned=e,l+=this.setRowTopAndRowIndex(p,l,c),i.cache[u]=p,i.order.push(u)}}for(let d of o)eh(i,d)?.clearRowTopAndRowIndex(),delete i.cache[d];i.order=s}setRowTopAndRowIndex(t,e,i){return t.setRowTop(e),t.setRowHeight(ws(this.beans,t).height),t.setRowIndex(i),t.rowHeight}getPinnedTopTotalHeight(){return MT(this.pinnedTopRows)}getPinnedBottomTotalHeight(){return MT(this.pinnedBottomRows)}getPinnedTopRowCount(){return cS(this.pinnedTopRows)}getPinnedBottomRowCount(){return cS(this.pinnedBottomRows)}getPinnedTopRow(t){return lS(this.pinnedTopRows,t)}getPinnedBottomRow(t){return lS(this.pinnedBottomRows,t)}getPinnedRowById(t,e){return eh(this.getCache(e),t)}forEachPinnedRow(t,e){return Vu(this.getCache(t),e)}getCache(t){return t==="top"?this.pinnedTopRows:this.pinnedBottomRows}getPinnedState(){return{top:[],bottom:[]}}setPinnedState(){}getGrandTotalPinned(){}setGrandTotalPinned(){}};function MT(t){let e=cS(t);if(e===0)return 0;let i=lS(t,e-1);return i===void 0?0:i.rowTop+i.rowHeight}function eh(t,e){return t.cache[e]}function lS(t,e){return eh(t,t.order[e])}function Vu(t,e){t.order.forEach((i,n)=>{let r=eh(t,i);r&&e(r,n)})}function cS(t){return t.order.length}var QX=class extends H{constructor(){super(...arguments),this.beanName="pinnedRowModel"}postConstruct(){let{gos:t}=this,e=()=>{let i=t.get("enableRowPinning"),n=KD(t),o=!!i||(n==="pinnedBottom"||n==="pinnedTop"),s=o?this.inner instanceof DT:this.inner instanceof kT;this.inner&&s&&this.destroyBean(this.inner),(s||!this.inner)&&(this.inner=this.createManagedBean(o?new kT:new DT))};this.addManagedPropertyListeners(["enableRowPinning","grandTotalRow"],e),e()}reset(){return this.inner.reset()}isEmpty(t){return this.inner.isEmpty(t)}isManual(){return this.inner.isManual()}isRowsToRender(t){return this.inner.isRowsToRender(t)}pinRow(t,e,i){return this.inner.pinRow(t,e,i)}ensureRowHeightsValid(){return this.inner.ensureRowHeightsValid()}getPinnedRowById(t,e){return this.inner.getPinnedRowById(t,e)}getPinnedTopTotalHeight(){return this.inner.getPinnedTopTotalHeight()}getPinnedBottomTotalHeight(){return this.inner.getPinnedBottomTotalHeight()}getPinnedTopRowCount(){return this.inner.getPinnedTopRowCount()}getPinnedBottomRowCount(){return this.inner.getPinnedBottomRowCount()}getPinnedTopRow(t){return this.inner.getPinnedTopRow(t)}getPinnedBottomRow(t){return this.inner.getPinnedBottomRow(t)}forEachPinnedRow(t,e){return this.inner.forEachPinnedRow(t,e)}getPinnedState(){return this.inner.getPinnedState()}setPinnedState(t){return this.inner.setPinnedState(t)}setGrandTotalPinned(t){return this.inner.setGrandTotalPinned(t)}getGrandTotalPinned(){return this.inner.getGrandTotalPinned()}};function xh(t){return!!(t.rowPinned&&t.pinnedSibling)}function Dn(t,e,i,n){let r=e==="top";if(!i)return Dn(t,e,r?t.getPinnedTopRow(0):t.getPinnedBottomRow(0),n);if(!n){let l=r?t.getPinnedTopRowCount():t.getPinnedBottomRowCount();return Dn(t,e,i,r?t.getPinnedTopRow(l-1):t.getPinnedBottomRow(l-1))}let o=!1,s=!1,a=[];return t.forEachPinnedRow(e,l=>{if(l===i&&!o){o=!0,a.push(l);return}if(o&&l===n){s=!0,a.push(l);return}o&&!s&&a.push(l)}),a}var ZX={tag:"div",cls:"ag-selection-checkbox",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},eJ=class extends et{constructor(){super(ZX,[BS]),this.eCheckbox=re}postConstruct(){this.eCheckbox.setPassive(!0)}onDataChanged(){this.onSelectionChanged()}onSelectableChanged(){this.showOrHideSelect()}onSelectionChanged(){let t=this.getLocaleTextFunc(),{rowNode:e,eCheckbox:i}=this,n=e.isSelected(),r=Nm(t,n),[o,s]=e.selectable?["ariaRowToggleSelection","Press Space to toggle row selection"]:["ariaRowSelectionDisabled","Row Selection is disabled for this row"],a=t(o,s);i.setValue(n,!0),i.setInputAriaLabel(`${a} (${r})`)}init(t){if(this.rowNode=t.rowNode,this.column=t.column,this.overrides=t.overrides,this.onSelectionChanged(),this.addManagedListeners(this.eCheckbox.getInputElement(),{dblclick:Da,click:n=>{Da(n),this.beans.selectionSvc?.handleSelectionEvent(n,this.rowNode,"checkboxSelected")}}),this.addManagedListeners(this.rowNode,{rowSelected:this.onSelectionChanged.bind(this),dataChanged:this.onDataChanged.bind(this),selectableChanged:this.onSelectableChanged.bind(this)}),this.addManagedPropertyListener("rowSelection",({currentValue:n,previousValue:r})=>{let o=typeof n=="object"?ly(n):void 0,s=typeof r=="object"?ly(r):void 0;o!==s&&this.onSelectableChanged()}),Ky(this.gos)||typeof this.getIsVisible()=="function"){let n=this.showOrHideSelect.bind(this);this.addManagedEventListeners({displayedColumnsChanged:n}),this.addManagedListeners(this.rowNode,{dataChanged:n,cellChanged:n}),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")}showOrHideSelect(){let{column:t,rowNode:e,overrides:i,gos:n}=this,r=e.selectable,o=this.getIsVisible(),s;if(typeof o=="function"){let u=i?.callbackParams;if(!t)s=o(k(w({},u),{node:e,data:e.data}));else{let h=t.createColumnFunctionCallbackParams(e);s=o(w(w({},u),h))}}else s=o??!1;let a=r&&!s||!r&&s,l=r||s,c=n.get("rowSelection"),d=c&&typeof c!="string"?!ly(c):!!t?.getColDef().showDisabledCheckboxes;this.setVisible(l&&(a?d:!0)),this.setDisplayed(l&&(a?d:!0)),l&&this.eCheckbox.setDisabled(a),i?.removeHidden&&this.setDisplayed(l)}getIsVisible(){let t=this.overrides;if(t)return t.isVisible;let e=this.gos.get("rowSelection");return e&&typeof e!="string"?oc(e):this.column?.getColDef()?.checkboxSelection}},tJ=class{constructor(t,e){this.rowModel=t,this.pinnedRowModel=e,this.selectAll=!1,this.rootId=null,this.endId=null,this.cachedRange=[]}reset(){this.rootId=null,this.endId=null,this.cachedRange.length=0}setRoot(t){this.rootId=t.id,this.endId=null,this.cachedRange.length=0}setEndRange(t){this.endId=t.id,this.cachedRange.length=0}getRange(){if(this.cachedRange.length===0){let t=this.getRoot(),e=this.getEnd();if(t==null||e==null)return this.cachedRange;this.cachedRange=this.getNodesInRange(t,e)??[]}return this.cachedRange}isInRange(t){return this.rootId===null?!1:this.getRange().some(e=>e.id===t.id)}getRoot(t){if(this.rootId)return this.getRowNode(this.rootId);if(t)return this.setRoot(t),t}getEnd(){if(this.endId)return this.getRowNode(this.endId)}getRowNode(t){let e,{rowModel:i,pinnedRowModel:n}=this;return e??(e=i.getRowNode(t)),n?.isManual()&&(e??(e=n.getPinnedRowById(t,"top")),e??(e=n.getPinnedRowById(t,"bottom"))),e}truncate(t){let e=this.getRange();if(e.length===0)return{keep:[],discard:[]};let i=e[0].id===this.rootId,n=e.findIndex(r=>r.id===t.id);if(n>-1){let r=e.slice(0,n),o=e.slice(n+1);return this.setEndRange(t),i?{keep:r,discard:o}:{keep:o,discard:r}}else return{keep:e,discard:[]}}extend(t,e=!1){let i=this.getRoot();if(i==null){let r=this.getRange().slice();return e&&t.depthFirstSearch(o=>!o.group&&r.push(o)),r.push(t),this.setRoot(t),{keep:r,discard:[]}}let n=this.getNodesInRange(i,t);if(!n)return this.setRoot(t),{keep:[t],discard:[]};if(n.find(r=>r.id===this.endId))return this.setEndRange(t),{keep:this.getRange(),discard:[]};{let r=this.getRange().slice();return this.setEndRange(t),{keep:this.getRange(),discard:r}}}getNodesInRange(t,e){let{pinnedRowModel:i,rowModel:n}=this;if(!i?.isManual())return n.getNodesInRangeForSelection(t,e);if(t.rowPinned==="top"&&!e.rowPinned)return Dn(i,"top",t,void 0).concat(n.getNodesInRangeForSelection(n.getRow(0),e)??[]);if(t.rowPinned==="bottom"&&!e.rowPinned){let r=Dn(i,"bottom",void 0,t),o=n.getRowCount(),s=n.getRow(o-1);return(n.getNodesInRangeForSelection(e,s)??[]).concat(r)}if(!t.rowPinned&&!e.rowPinned)return n.getNodesInRangeForSelection(t,e);if(t.rowPinned==="top"&&e.rowPinned==="top")return Dn(i,"top",t,e);if(t.rowPinned==="bottom"&&e.rowPinned==="top"){let r=Dn(i,"top",e,void 0),o=Dn(i,"bottom",void 0,t),s=n.getRow(0),a=n.getRow(n.getRowCount()-1);return r.concat(n.getNodesInRangeForSelection(s,a)??[]).concat(o)}if(!t.rowPinned&&e.rowPinned==="top")return Dn(i,"top",e,void 0).concat(n.getNodesInRangeForSelection(n.getRow(0),t)??[]);if(t.rowPinned==="top"&&e.rowPinned==="bottom"){let r=Dn(i,"top",t,void 0),o=Dn(i,"bottom",void 0,e),s=n.getRow(0),a=n.getRow(n.getRowCount()-1);return r.concat(n.getNodesInRangeForSelection(s,a)??[]).concat(o)}if(t.rowPinned==="bottom"&&e.rowPinned==="bottom")return Dn(i,"bottom",t,e);if(!t.rowPinned&&e.rowPinned==="bottom"){let r=Dn(i,"bottom",void 0,e),o=n.getRow(n.getRowCount());return(n.getNodesInRangeForSelection(t,o)??[]).concat(r)}return null}},iJ=class extends H{constructor(t){super(),this.column=t,this.cbSelectAllVisible=!1,this.processingEventFromCheckbox=!1}onSpaceKeyDown(t){let e=this.cbSelectAll;e.isDisplayed()&&!e.getGui().contains(St(this.beans))&&(t.preventDefault(),e.setValue(!e.getValue()))}getCheckboxGui(){return this.cbSelectAll.getGui()}setComp(t){this.headerCellCtrl=t;let e=this.createManagedBean(new NS);this.cbSelectAll=e,e.addCss("ag-header-select-all"),vs(e.getGui(),"presentation"),this.showOrHideSelectAll();let i=this.updateStateOfCheckbox.bind(this);this.addManagedEventListeners({newColumnsLoaded:()=>this.showOrHideSelectAll(),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),selectionChanged:i,paginationChanged:i,modelUpdated:i}),this.addManagedPropertyListener("rowSelection",({currentValue:n,previousValue:r})=>{let o=s=>typeof s=="string"||!s||s.mode==="singleRow"?void 0:s.selectAll;o(n)!==o(r)&&this.showOrHideSelectAll(),this.updateStateOfCheckbox()}),this.addManagedListeners(e,{fieldValueChanged:this.onCbSelectAll.bind(this)}),e.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()}onDisplayedColumnsChanged(t){this.isAlive()&&this.showOrHideSelectAll(t.source==="uiColumnMoved")}showOrHideSelectAll(t=!1){let e=this.isCheckboxSelection();this.cbSelectAllVisible=e,this.cbSelectAll.setDisplayed(e),e&&(this.checkRightRowModelType("selectAllCheckbox"),this.checkSelectionType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel(t)}updateStateOfCheckbox(){if(!this.cbSelectAllVisible||this.processingEventFromCheckbox)return;this.processingEventFromCheckbox=!0;let t=this.getSelectAllMode(),e=this.beans.selectionSvc,i=this.cbSelectAll,n=e.getSelectAllState(t);i.setValue(n);let r=e.hasNodesToSelect(t);i.setDisabled(!r),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}refreshSelectAllLabel(t=!1){let e=this.getLocaleTextFunc(),{headerCellCtrl:i,cbSelectAll:n,cbSelectAllVisible:r}=this,o=n.getValue(),s=Nm(e,o),a=e("ariaRowSelectAll","Press Space to toggle all rows selection");i.setAriaDescriptionProperty("selectAll",r?`${a} (${s})`:null),n.setInputAriaLabel(e("ariaHeaderSelection","Column with Header Selection")),t||i.announceAriaDescription()}checkSelectionType(t){return dh(this.gos)?!0:(K(128,{feature:t}),!1)}checkRightRowModelType(t){let{gos:e,rowModel:i}=this.beans;return Lt(e)||wc(e)?!0:(K(129,{feature:t,rowModel:i.getType()}),!1)}onCbSelectAll(){if(this.processingEventFromCheckbox||!this.cbSelectAllVisible)return;let t=this.cbSelectAll.getValue(),e=this.getSelectAllMode(),i="uiSelectAll";e==="currentPage"?i="uiSelectAllCurrentPage":e==="filtered"&&(i="uiSelectAllFiltered");let n={source:i,selectAll:e},r=this.beans.selectionSvc;t?r.selectAllRowNodes(n):r.deselectAllRowNodes(n)}isCheckboxSelection(){let{column:t,gos:e,beans:i}=this,o=typeof e.get("rowSelection")=="object"?"headerCheckbox":"headerCheckboxSelection";return a8(i,t)&&this.checkRightRowModelType(o)&&this.checkSelectionType(o)}getSelectAllMode(){let t=QD(this.gos,!1);if(t)return t;let{headerCheckboxSelectionCurrentPageOnly:e,headerCheckboxSelectionFilteredOnly:i}=this.column.getColDef();return e?"currentPage":i?"filtered":"all"}destroy(){super.destroy(),this.cbSelectAll=void 0,this.headerCellCtrl=void 0}};function a8({gos:t,selectionColSvc:e},i){let n=t.get("rowSelection"),r=i.getColDef(),{headerCheckboxSelection:o}=r,s=!1;if(typeof n=="object"){let l=Po(i),c=IS(i);(ym(n)==="autoGroupColumn"&&c||l&&e?.isSelectionColumnEnabled())&&(s=om(n))}else typeof o=="function"?s=o(Ee(t,{column:i,colDef:r})):s=!!o;return s}var nJ=class extends H{postConstruct(){let{gos:t,beans:e}=this;this.selectionCtx=new tJ(e.rowModel,e.pinnedRowModel),this.addManagedPropertyListeners(["isRowSelectable","rowSelection"],()=>{let i=Ky(t);i!==this.isRowSelectable&&(this.isRowSelectable=i,this.updateSelectable())}),this.isRowSelectable=Ky(t),this.addManagedEventListeners({cellValueChanged:i=>this.updateRowSelectable(i.node),rowNodeDataChanged:i=>this.updateRowSelectable(i.node)})}destroy(){super.destroy(),this.selectionCtx.reset()}createCheckboxSelectionComponent(){return new eJ}createSelectAllFeature(t){if(a8(this.beans,t))return new iJ(t)}isMultiSelect(){return dh(this.gos)}onRowCtrlSelected(t,e,i){let n=!!t.rowNode.isSelected();t.forEachGui(i,r=>{r.rowComp.toggleCss("ag-row-selected",n);let o=r.element;SD(o,n),o.contains(St(this.beans))&&e(r)})}announceAriaRowSelection(t){if(this.isRowSelectionBlocked(t))return;let e=t.isSelected(),i=this.beans.editSvc?.isEditing({rowNode:t});if(!t.selectable||i)return;let r=this.getLocaleTextFunc()(e?"ariaRowDeselect":"ariaRowSelect",`Press SPACE to ${e?"deselect":"select"} this row`);this.beans.ariaAnnounce?.announceValue(r,"rowSelection")}isRowSelectionBlocked(t){return!t.selectable||t.rowPinned&&!xh(t)||!xa(this.gos)}updateRowSelectable(t,e){let i=t.rowPinned&&t.pinnedSibling?t.pinnedSibling.selectable:this.isRowSelectable?.(t)??!0;return this.setRowSelectable(t,i,e),i}setRowSelectable(t,e,i){if(t.selectable!==e){if(t.selectable=e,t.dispatchRowEvent("selectableChanged"),i)return;if(uh(this.gos)){let r=this.calculateSelectedFromChildren(t);this.setNodesSelected({nodes:[t],newValue:r??!1,source:"selectableChanged"});return}t.isSelected()&&!t.selectable&&this.setNodesSelected({nodes:[t],newValue:!1,source:"selectableChanged"})}}calculateSelectedFromChildren(t){let e=!1,i=!1;if(!t.childrenAfterGroup?.length)return t.selectable?t.__selected:null;for(let n=0;n<t.childrenAfterGroup.length;n++){let r=t.childrenAfterGroup[n],o=r.isSelected();if(!r.selectable){let s=this.calculateSelectedFromChildren(r);if(s===null)continue;o=s}switch(o){case!0:e=!0;break;case!1:i=!0;break;default:return}}if(!(e&&i))return e?!0:i?!1:t.selectable?t.__selected:null}selectRowNode(t,e,i,n="api"){let r=!t.selectable&&e,o=t.__selected===e;if(r||o)return!1;t.__selected=e,t.dispatchRowEvent("rowSelected");let s=t.sibling;s&&s.footer&&s.__localEventService&&s.dispatchRowEvent("rowSelected");let a=t.pinnedSibling;return a?.rowPinned&&a.__localEventService&&a.dispatchRowEvent("rowSelected"),this.eventSvc.dispatchEvent(k(w({},cY(t,this.gos,"rowSelected")),{event:i||null,source:n})),!0}isCellCheckboxSelection(t,e){let i=this.gos.get("rowSelection");if(i&&typeof i!="string"){let n=Po(t)&&oc(i);return t.isColumnFunc(e,n)}else return t.isColumnFunc(e,t.colDef.checkboxSelection)}inferNodeSelections(t,e,i,n){let{gos:r,selectionCtx:o}=this,s=t.isSelected(),a=uh(r),l=Mq(r),c=Iq(r),d=this.isMultiSelect(),u=n==="rowClicked";if(u&&!(l||c))return null;if(e&&i&&d){let h=o.getRoot();if(h)if(h.isSelected()){let p=o.isInRange(t)?o.truncate(t):o.extend(t,a);return{deselect:p.discard,select:p.keep,reset:!1}}else{let p=o.extend(t,a);return{select:[],deselect:p.keep,reset:!1}}else return null}else if(e&&d){let h=o.selectAll?this.beans.rowModel.getRow(0):void 0,p=o.getRoot(h),f=o.isInRange(t)?o.truncate(t):o.extend(t,a);return{select:f.keep,deselect:f.discard,reset:o.selectAll||!!(p&&!p.isSelected())}}else if(i){if(u){let h=!s;return h&&!l||!h&&!c?null:(o.setRoot(t),{node:t,newValue:h,clearSelection:!1})}return o.setRoot(t),{node:t,newValue:!s,clearSelection:!d}}else{o.setRoot(t);let h=Aq(r),p=xm(r)==="filteredDescendants",f=u&&(!h||!l);if(p&&s===void 0&&Lt(r))return{node:t,newValue:!1,checkFilteredNodes:!0,clearSelection:!d||f};if(u){let g=s?!h:l;return g===s&&!f||g&&!l||!g&&!c?null:{node:t,newValue:g,clearSelection:!d||f,keepDescendants:t.group&&a}}return{node:t,newValue:!s,clearSelection:!d||f}}}},_y={TAB_GUARD:"ag-tab-guard",TAB_GUARD_TOP:"ag-tab-guard-top",TAB_GUARD_BOTTOM:"ag-tab-guard-bottom"},rJ=class extends H{constructor(t){super(),this.skipTabGuardFocus=!1,this.forcingFocusOut=!1,this.allowFocus=!1;let{comp:e,eTopGuard:i,eBottomGuard:n,focusTrapActive:r,forceFocusOutWhenTabGuardsAreEmpty:o,isFocusableContainer:s,focusInnerElement:a,onFocusIn:l,onFocusOut:c,shouldStopEventPropagation:d,onTabKeyDown:u,handleKeyDown:h,isEmpty:p,eFocusableElement:f}=t;this.comp=e,this.eTopGuard=i,this.eBottomGuard=n,this.providedFocusInnerElement=a,this.eFocusableElement=f,this.focusTrapActive=!!r,this.forceFocusOutWhenTabGuardsAreEmpty=!!o,this.isFocusableContainer=!!s,this.providedFocusIn=l,this.providedFocusOut=c,this.providedShouldStopEventPropagation=d,this.providedOnTabKeyDown=u,this.providedHandleKeyDown=h,this.providedIsEmpty=p}postConstruct(){this.createManagedBean(new bc(this.eFocusableElement,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:t=>this.onTabKeyDown(t),handleKeyDown:t=>this.handleKeyDown(t),onFocusIn:t=>this.onFocusIn(t),onFocusOut:t=>this.onFocusOut(t)})),this.activateTabGuards();for(let t of[this.eTopGuard,this.eBottomGuard])this.addManagedElementListeners(t,{focus:this.onFocus.bind(this)})}handleKeyDown(t){this.providedHandleKeyDown&&this.providedHandleKeyDown(t)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return this.providedShouldStopEventPropagation?this.providedShouldStopEventPropagation():!1}activateTabGuards(){if(this.forcingFocusOut)return;let t=this.gos.get("tabIndex");this.comp.setTabIndex(t.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(t){if(this.isFocusableContainer&&!this.eFocusableElement.contains(t.relatedTarget)&&!this.allowFocus){this.findNextElementOutsideAndFocus(t.target===this.eBottomGuard);return}if(this.skipTabGuardFocus){this.skipTabGuardFocus=!1;return}if(this.forceFocusOutWhenTabGuardsAreEmpty&&(this.providedIsEmpty?this.providedIsEmpty():ac(this.eFocusableElement,".ag-tab-guard").length===0)){this.findNextElementOutsideAndFocus(t.target===this.eBottomGuard);return}if(this.isFocusableContainer&&this.eFocusableElement.contains(t.relatedTarget))return;let e=t.target===this.eBottomGuard;!(this.providedFocusInnerElement?this.providedFocusInnerElement(e):this.focusInnerElement(e))&&this.forceFocusOutWhenTabGuardsAreEmpty&&this.findNextElementOutsideAndFocus(t.target===this.eBottomGuard)}findNextElementOutsideAndFocus(t){let e=ri(this.beans),i=ac(e.body,null,!0),n=i.indexOf(t?this.eTopGuard:this.eBottomGuard);if(n===-1)return;let r,o;t?(r=0,o=n):(r=n+1,o=i.length);let s=i.slice(r,o),a=this.gos.get("tabIndex");s.sort((l,c)=>{let d=Number.parseInt(l.getAttribute("tabindex")||"0"),u=Number.parseInt(c.getAttribute("tabindex")||"0");return u===a?1:d===a?-1:d===0?1:u===0?-1:d-u}),s[t?s.length-1:0]?.focus()}onFocusIn(t){this.focusTrapActive||this.forcingFocusOut||(this.providedFocusIn&&this.providedFocusIn(t),this.isFocusableContainer||this.deactivateTabGuards())}onFocusOut(t){this.focusTrapActive||(this.providedFocusOut&&this.providedFocusOut(t),this.eFocusableElement.contains(t.relatedTarget)||this.activateTabGuards())}onTabKeyDown(t){if(this.providedOnTabKeyDown){this.providedOnTabKeyDown(t);return}if(this.focusTrapActive||t.defaultPrevented)return;let e=this.tabGuardsAreActive();e&&this.deactivateTabGuards();let i=this.getNextFocusableElement(t.shiftKey);e&&setTimeout(()=>this.activateTabGuards(),0),i&&(i.focus(),t.preventDefault())}focusInnerElement(t=!1){let e=ac(this.eFocusableElement);return this.tabGuardsAreActive()&&(e.splice(0,1),e.splice(e.length-1,1)),e.length?(e[t?e.length-1:0].focus({preventScroll:!0}),!0):!1}getNextFocusableElement(t){return Oa(this.beans,this.eFocusableElement,!1,t)}forceFocusOutOfContainer(t=!1){if(this.forcingFocusOut)return;let e=t?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,this.forcingFocusOut=!0,e.focus(),window.setTimeout(()=>{this.forcingFocusOut=!1,this.activateTabGuards()})}isTabGuard(t,e){return t===this.eTopGuard&&!e||t===this.eBottomGuard&&(e??!0)}setAllowFocus(t){this.allowFocus=t}},oJ=class extends H{constructor(t){super(),this.comp=t}initialiseTabGuard(t){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.comp.getFocusableElement();let{eTopGuard:e,eBottomGuard:i,eFocusableElement:n}=this,r=[e,i],o={setTabIndex:m=>{for(let v of r)m!=null?v.setAttribute("tabindex",m):v.removeAttribute("tabindex")}};this.addTabGuards(e,i);let{focusTrapActive:s=!1,onFocusIn:a,onFocusOut:l,focusInnerElement:c,handleKeyDown:d,onTabKeyDown:u,shouldStopEventPropagation:h,isEmpty:p,forceFocusOutWhenTabGuardsAreEmpty:f,isFocusableContainer:g}=t;this.tabGuardCtrl=this.createManagedBean(new rJ({comp:o,focusTrapActive:s,eTopGuard:e,eBottomGuard:i,eFocusableElement:n,onFocusIn:a,onFocusOut:l,focusInnerElement:c,handleKeyDown:d,onTabKeyDown:u,shouldStopEventPropagation:h,isEmpty:p,forceFocusOutWhenTabGuardsAreEmpty:f,isFocusableContainer:g}))}getTabGuardCtrl(){return this.tabGuardCtrl}createTabGuard(t){let e=ri(this.beans).createElement("div"),i=t==="top"?_y.TAB_GUARD_TOP:_y.TAB_GUARD_BOTTOM;return e.classList.add(_y.TAB_GUARD,i),vs(e,"presentation"),e}addTabGuards(t,e){let i=this.eFocusableElement;i.insertAdjacentElement("afterbegin",t),i.insertAdjacentElement("beforeend",e)}removeAllChildrenExceptTabGuards(){let t=[this.eTopGuard,this.eBottomGuard];hi(this.comp.getFocusableElement()),this.addTabGuards(...t)}forceFocusOutOfContainer(t=!1){this.tabGuardCtrl.forceFocusOutOfContainer(t)}appendChild(t,e,i){_S(e)||(e=e.getGui());let{eBottomGuard:n}=this;n?n.insertAdjacentElement("beforebegin",e):t(e,i)}destroy(){let{eTopGuard:t,eBottomGuard:e}=this;Xi(t),Xi(e),super.destroy()}},l8=class extends et{initialiseTabGuard(t){this.tabGuardFeature=this.createManagedBean(new oJ(this)),this.tabGuardFeature.initialiseTabGuard(t)}forceFocusOutOfContainer(t=!1){this.tabGuardFeature.forceFocusOutOfContainer(t)}appendChild(t,e){this.tabGuardFeature.appendChild(super.appendChild.bind(this),t,e)}},sJ=500,aJ=550,Zg,lJ=t=>{if(!Zg)Zg=new WeakSet;else if(Zg.has(t))return!1;return Zg.add(t),!0},wa=class{constructor(t,e=!1){this.eElement=t,this.preventClick=e,this.startListener=null,this.handlers=[],this.eventSvc=void 0,this.touchStart=null,this.lastTapTime=null,this.longPressTimer=0,this.moved=!1}addEventListener(t,e){let i=this.eventSvc;if(!i){if(i===null)return;this.eventSvc=i=new ka;let n=this.onTouchStart.bind(this);this.startListener=n,this.eElement.addEventListener("touchstart",n,{passive:!0})}i.addEventListener(t,e)}removeEventListener(t,e){this.eventSvc?.removeEventListener(t,e)}onTouchStart(t){if(this.touchStart||!lJ(t))return;let e=t.touches[0];this.touchStart=e;let i=this.handlers;if(!i.length){let n=this.eElement,r=n.ownerDocument,o=this.onTouchMove.bind(this),s=this.onTouchEnd.bind(this),a=this.onTouchCancel.bind(this),l={passive:!0},c={passive:!1};nm(i,[n,"touchmove",o,l],[r,"touchcancel",a,l],[r,"touchend",s,c],[r,"contextmenu",fs,c])}this.clearLongPress(),this.longPressTimer=window.setTimeout(()=>{this.longPressTimer=0,this.touchStart===e&&!this.moved&&(this.moved=!0,this.eventSvc?.dispatchEvent({type:"longTap",touchStart:e,touchEvent:t}))},aJ)}onTouchMove(t){let{moved:e,touchStart:i}=this;if(!e&&i){let n=Ju(i,t.touches);n&&!MD(n,i,4)&&(this.clearLongPress(),this.moved=!0)}}onTouchEnd(t){let e=this.touchStart;!e||!Ju(e,t.changedTouches)||(this.moved||(this.eventSvc?.dispatchEvent({type:"tap",touchStart:e}),this.checkDoubleTap(e)),this.preventClick&&fs(t),this.cancel())}onTouchCancel(t){let e=this.touchStart;!e||!Ju(e,t.changedTouches)||(this.lastTapTime=null,this.cancel())}checkDoubleTap(t){let e=Date.now(),i=this.lastTapTime;i&&e-i>sJ&&(this.eventSvc?.dispatchEvent({type:"doubleTap",touchStart:t}),e=null),this.lastTapTime=e}cancel(){this.clearLongPress(),kS(this.handlers),this.touchStart=null}clearLongPress(){window.clearTimeout(this.longPressTimer),this.longPressTimer=0,this.moved=!1}destroy(){let t=this.startListener;t&&(this.startListener=null,this.eElement.removeEventListener("touchstart",t)),this.cancel(),this.eElement=null,this.eventSvc=null}};var cJ=class{constructor(t){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=t.scrollContainer,this.scrollHorizontally=t.scrollAxis.includes("x"),this.scrollVertically=t.scrollAxis.includes("y"),this.scrollByTick=t.scrollByTick!=null?t.scrollByTick:20,t.onScrollCallback&&(this.onScrollCallback=t.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=t.getVerticalPosition,this.setVerticalPosition=t.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=t.getHorizontalPosition,this.setHorizontalPosition=t.setHorizontalPosition),this.shouldSkipVerticalScroll=t.shouldSkipVerticalScroll||(()=>!1),this.shouldSkipHorizontalScroll=t.shouldSkipHorizontalScroll||(()=>!1)}get scrolling(){return this.tickingInterval!==null}check(t,e=!1){let i=e||this.shouldSkipVerticalScroll();if(i&&this.shouldSkipHorizontalScroll())return;let n=this.scrollContainer.getBoundingClientRect(),r=this.scrollByTick;this.tickLeft=t.clientX<n.left+r,this.tickRight=t.clientX>n.right-r,this.tickUp=t.clientY<n.top+r&&!i,this.tickDown=t.clientY>n.bottom-r&&!i,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}ensureTickingStarted(){this.tickingInterval===null&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)}doTick(){this.tickCount++;let t=this.tickCount>20?200:this.tickCount>10?80:40;if(this.scrollVertically){let e=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(e-t),this.tickDown&&this.setVerticalPosition(e+t)}if(this.scrollHorizontally){let e=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(e-t),this.tickRight&&this.setHorizontalPosition(e+t)}this.onScrollCallback&&this.onScrollCallback()}ensureCleared(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)}},e2=class{constructor(t="javascript"){this.frameworkName=t,this.renderingEngine="vanilla",this.batchFrameworkComps=!1,this.wrapIncoming=e=>e(),this.wrapOutgoing=e=>e(),this.baseDocLink=`${OD}/${this.frameworkName}-data-grid`,yq(this.baseDocLink)}frameworkComponent(t){return null}isFrameworkComponent(t){return!1}getDocLink(t){return this.baseDocLink+(t?"/"+t:"")}};function dJ(t){return{beanName:"gridApi",bean:t.getBean("apiFunctionSvc").api}}var uJ=["licenseManager","environment","eventSvc","gos","paginationAutoPageSizeSvc","apiFunctionSvc","gridApi","registry","agCompUtils","userCompFactory","rowContainerHeight","horizontalResizeSvc","localeSvc","pinnedRowModel","dragSvc","colGroupSvc","visibleCols","popupSvc","selectionSvc","colFilter","quickFilter","filterManager","colModel","headerNavigation","pageBounds","pagination","pageBoundsListener","rowSpanSvc","stickyRowSvc","rowRenderer","expressionSvc","alignedGridsSvc","navigation","valueCache","valueSvc","autoWidthCalc","filterMenuFactory","dragAndDrop","focusSvc","cellNavigation","cellStyles","scrollVisibleSvc","sortSvc","colHover","colAnimation","autoColSvc","selectionColSvc","changeDetectionSvc","animationFrameSvc","undoRedo","colDefFactory","rowStyleSvc","rowNodeBlockLoader","rowNodeSorter","ctrlsSvc","pinnedCols","dataTypeSvc","syncSvc","overlays","stateSvc","expansionSvc","apiEventSvc","ariaAnnounce","menuSvc","colMoves","colAutosize","colFlex","colResize","pivotColsSvc","valueColsSvc","rowGroupColsSvc","colNames","colViewport","pivotResultCols","showRowGroupCols","validation"],IT=Object.fromEntries(uJ.map((t,e)=>[t,e]));function hJ(t,e){let i=(t.beanName?IT[t.beanName]:void 0)??Number.MAX_SAFE_INTEGER,n=(e.beanName?IT[e.beanName]:void 0)??Number.MAX_SAFE_INTEGER;return i-n}function pJ(t,e){return t?.beanName==="gridDestroySvc"?-1:e?.beanName==="gridDestroySvc"?1:0}var fJ={tag:"div",cls:"ag-pinned-left-header",role:"rowgroup"},gJ={tag:"div",cls:"ag-pinned-right-header",role:"rowgroup"},mJ={tag:"div",cls:"ag-header-viewport",role:"rowgroup",attrs:{tabindex:"-1"},children:[{tag:"div",ref:"eCenterContainer",cls:"ag-header-container",role:"presentation"}]},ky=class extends et{constructor(t){super(),this.eCenterContainer=re,this.headerRowComps={},this.rowCompsList=[],this.pinned=t}postConstruct(){this.selectAndSetTemplate();let t={setDisplayed:i=>this.setDisplayed(i),setCtrls:i=>this.setCtrls(i),setCenterWidth:i=>this.eCenterContainer.style.width=i,setViewportScrollLeft:i=>this.getGui().scrollLeft=i,setPinnedContainerWidth:i=>{let n=this.getGui();n.style.width=i,n.style.maxWidth=i,n.style.minWidth=i}};this.createManagedBean(new MX(this.pinned)).setComp(t,this.getGui())}selectAndSetTemplate(){let t=this.pinned=="left",e=this.pinned=="right",i=t?fJ:e?gJ:mJ;this.setTemplate(i),this.eRowContainer=this.eCenterContainer!==re?this.eCenterContainer:this.getGui()}destroy(){this.setCtrls([]),super.destroy()}destroyRowComp(t){this.destroyBean(t),t.getGui().remove()}setCtrls(t){let e=this.headerRowComps;this.headerRowComps={},this.rowCompsList=[];let i,n=r=>{let o=r.getGui();o.parentElement!=this.eRowContainer&&this.eRowContainer.appendChild(o),i&&_D(this.eRowContainer,o,i),i=o};for(let r of t){let o=r.instanceId,s=e[o];delete e[o];let a=s||this.createBean(new kX(r));this.headerRowComps[o]=a,this.rowCompsList.push(a),n(a)}for(let r of Object.values(e))this.destroyRowComp(r)}},vJ={tag:"div",cls:"ag-header",role:"presentation"},CJ=class extends et{constructor(){super(vJ)}postConstruct(){let t={toggleCss:(n,r)=>this.toggleCss(n,r),setHeightAndMinHeight:n=>{this.getGui().style.height=n,this.getGui().style.minHeight=n}};this.createManagedBean(new yX).setComp(t,this.getGui(),this.getFocusableElement());let i=n=>{this.createManagedBean(n),this.appendChild(n)};i(new ky("left")),i(new ky(null)),i(new ky("right"))}},wJ={selector:"AG-HEADER-ROOT",component:CJ},bJ=class extends et{constructor(t,e,i,n,r){super(),this.cellCtrl=e,this.rendererVersion=0,this.editorVersion=0,this.beans=t,this.gos=t.gos,this.column=e.column,this.rowNode=e.rowNode,this.eRow=n;let o=Nt({tag:"div",role:e.getCellAriaRole(),attrs:{"comp-id":`${this.getCompId()}`,"col-id":e.column.colIdSanitised}});this.eCell=o;let s;e.isCellSpanning()?(s=Nt({tag:"div",cls:"ag-spanned-cell-wrapper",role:"presentation"}),s.appendChild(o),this.setTemplateFromElement(s)):this.setTemplateFromElement(o),this.cellCssManager=new fM(()=>o),this.forceWrapper=e.isForceWrapper(),this.refreshWrapper(!1);let a={toggleCss:(l,c)=>this.cellCssManager.toggleCss(l,c),setUserStyles:l=>vh(o,l),getFocusableElement:()=>o,setIncludeSelection:l=>this.includeSelection=l,setIncludeRowDrag:l=>this.includeRowDrag=l,setIncludeDndSource:l=>this.includeDndSource=l,setRenderDetails:(l,c,d)=>this.setRenderDetails(l,c,d),setEditDetails:(l,c,d)=>this.setEditDetails(l,c,d),getCellEditor:()=>this.cellEditor||null,getCellRenderer:()=>this.cellRenderer||null,getParentOfValue:()=>this.getParentOfValue(),refreshEditStyles:(l,c)=>this.refreshEditStyles(l,c)};e.setComp(a,o,s,this.eCellWrapper,i,r,void 0)}getParentOfValue(){return this.eCellValue??this.eCellWrapper??this.eCell}setRenderDetails(t,e,i){if(this.cellEditor&&!this.cellEditorPopupWrapper)return;this.firstRender=this.firstRender==null;let r=this.refreshWrapper(!1);this.refreshEditStyles(!1),t?!(i||r)&&this.refreshCellRenderer(t)||(this.destroyRenderer(),this.createCellRendererInstance(t)):(this.destroyRenderer(),this.insertValueWithoutCellRenderer(e)),this.rowDraggingComp?.refreshVisibility()}setEditDetails(t,e,i){t?this.createCellEditorInstance(t,e,i):this.destroyEditor()}removeControls(){let t=this.beans.context;this.checkboxSelectionComp=t.destroyBean(this.checkboxSelectionComp),this.dndSourceComp=t.destroyBean(this.dndSourceComp),this.rowDraggingComp=t.destroyBean(this.rowDraggingComp)}refreshWrapper(t){let e=this.includeRowDrag||this.includeDndSource||this.includeSelection,i=e||this.forceWrapper,n=i&&this.eCellWrapper==null;n&&(this.eCellWrapper=Nt({tag:"div",cls:"ag-cell-wrapper",role:"presentation"}),this.eCell.appendChild(this.eCellWrapper));let r=!i&&this.eCellWrapper!=null;r&&(Xi(this.eCellWrapper),this.eCellWrapper=void 0),this.cellCssManager.toggleCss("ag-cell-value",!i);let o=!t&&i,s=o&&this.eCellValue==null;if(s){let c=this.cellCtrl.getCellValueClass();this.eCellValue=Nt({tag:"span",cls:c,role:"presentation"}),this.eCellWrapper.appendChild(this.eCellValue)}let a=!o&&this.eCellValue!=null;a&&(Xi(this.eCellValue),this.eCellValue=void 0);let l=n||r||s||a;return l&&this.removeControls(),!t&&e&&this.addControls(),l}addControls(){let{cellCtrl:t,eCellWrapper:e,eCellValue:i,includeRowDrag:n,includeDndSource:r,includeSelection:o}=this,s=a=>{a&&e.insertBefore(a.getGui(),i)};n&&this.rowDraggingComp==null&&(this.rowDraggingComp=t.createRowDragComp(),s(this.rowDraggingComp)),r&&this.dndSourceComp==null&&(this.dndSourceComp=t.createDndSource(),s(this.dndSourceComp)),o&&this.checkboxSelectionComp==null&&(this.checkboxSelectionComp=t.createSelectionCheckbox(),s(this.checkboxSelectionComp))}createCellEditorInstance(t,e,i){let n=this.editorVersion,r=t.newAgStackInstance(),{params:o}=t;r.then(a=>this.afterCellEditorCreated(n,a,o,e,i)),wt(this.cellEditor)&&o.cellStartedEdit&&this.cellCtrl.focusCell(!0)}insertValueWithoutCellRenderer(t){let e=this.getParentOfValue();hi(e);let i=Cc(t);i!=null&&(e.textContent=i)}destroyRenderer(){let{context:t}=this.beans;this.cellRenderer=t.destroyBean(this.cellRenderer),Xi(this.cellRendererGui),this.cellRendererGui=null,this.rendererVersion++}destroyEditor(){let{context:t}=this.beans;(this.cellEditorPopupWrapper?.getGui().contains(St(this.beans))||this.cellCtrl.hasBrowserFocus())&&this.eCell.focus({preventScroll:!0}),this.hideEditorPopup?.(),this.hideEditorPopup=void 0,this.cellEditor=t.destroyBean(this.cellEditor),this.cellEditorPopupWrapper=t.destroyBean(this.cellEditorPopupWrapper),Xi(this.cellEditorGui),this.cellCtrl.disableEditorTooltipFeature(),this.cellEditorGui=null,this.editorVersion++}refreshCellRenderer(t){if(this.cellRenderer?.refresh==null||this.cellRendererClass!==t.componentClass)return!1;let e=this.cellRenderer.refresh(t.params);return e===!0||e===void 0}createCellRendererInstance(t){let e=this.rendererVersion,i=o=>s=>{if(this.rendererVersion!==e||!this.isAlive())return;let l=o.newAgStackInstance(),c=this.afterCellRendererCreated.bind(this,e,o.componentClass);l?.then(c)},{animationFrameSvc:n}=this.beans,r;if(n?.active&&this.firstRender?r=(o,s=!1)=>{n.createTask(i(o),this.rowNode.rowIndex,"p2",o.componentFromFramework,s)}:r=o=>i(o)(),t.params?.deferRender&&!this.cellCtrl.rowNode.group){let{loadingComp:o,onReady:s}=this.cellCtrl.getDeferLoadingCellRenderer();o&&(r(o),s.then(()=>r(t,!0)))}else r(t)}afterCellRendererCreated(t,e,i){if(!this.isAlive()||t!==this.rendererVersion){this.beans.context.destroyBean(i);return}this.cellRenderer=i,this.cellRendererClass=e;let r=i.getGui();if(this.cellRendererGui=r,r!=null){let o=this.getParentOfValue();hi(o),o.appendChild(r)}}afterCellEditorCreated(t,e,i,n,r){let o=t!==this.editorVersion,{context:s}=this.beans;if(o){s.destroyBean(e);return}if(e.isCancelBeforeStart?.()){s.destroyBean(e),this.cellCtrl.stopEditing(!0);return}if(!e.getGui){K(97,{colId:this.column.getId()}),s.destroyBean(e);return}this.cellEditor=e,this.cellEditorGui=e.getGui();let l=n||e.isPopup?.();l?this.addPopupCellEditor(i,r):this.addInCellEditor(),this.refreshEditStyles(!0,l),e.afterGuiAttached?.(),this.cellCtrl.enableEditorTooltipFeature(e),this.cellCtrl.cellEditorAttached()}refreshEditStyles(t,e){let{cellCssManager:i}=this;i.toggleCss("ag-cell-inline-editing",t&&!e),i.toggleCss("ag-cell-popup-editing",t&&!!e),i.toggleCss("ag-cell-not-inline-editing",!t||!!e)}addInCellEditor(){let{eCell:t}=this;t.contains(St(this.beans))&&t.focus(),this.destroyRenderer(),this.refreshWrapper(!0),hi(this.getParentOfValue()),this.cellEditorGui&&this.getParentOfValue().appendChild(this.cellEditorGui)}addPopupCellEditor(t,e){let{gos:i,context:n,popupSvc:r,editSvc:o}=this.beans;i.get("editType")==="fullRow"&&K(98);let s=this.cellEditorPopupWrapper=n.createBean(o.createPopupEditorWrapper(t)),{cellEditor:a,cellEditorGui:l,eCell:c,rowNode:d,column:u,cellCtrl:h}=this,p=s.getGui();l&&p.appendChild(l);let f=i.get("stopEditingWhenCellsLoseFocus"),g=e??a.getPopupPosition?.()??"over",m=i.get("enableRtl"),v={ePopup:p,column:u,rowNode:d,type:"popupCellEditor",eventSource:c,position:g,alignSide:m?"right":"left",keepWithinBounds:!0},C=r.positionPopupByComponent.bind(r,v),b=r.addPopup({modal:f,eChild:p,closeOnEsc:!0,closedCallback:()=>{h.onPopupEditorClosed()},anchorToElement:c,positionCallback:C,ariaOwns:c});b&&(this.hideEditorPopup=b.hideFunc)}detach(){this.getGui().remove()}destroy(){this.destroyRenderer(),this.destroyEditor(),this.removeControls(),super.destroy()}},yJ=class extends et{constructor(t,e,i){super(),this.cellComps=new Map,this.beans=e,this.rowCtrl=t;let n=Nt({tag:"div",role:"row",attrs:{"comp-id":`${this.getCompId()}`}});this.setInitialStyle(n,i),this.setTemplateFromElement(n);let r=n.style;this.domOrder=this.rowCtrl.getDomOrder();let o={setDomOrder:s=>this.domOrder=s,setCellCtrls:s=>this.setCellCtrls(s),showFullWidth:s=>this.showFullWidth(s),getFullWidthCellRenderer:()=>this.fullWidthCellRenderer,getFullWidthCellRendererParams:()=>this.fullWidthCellRendererParams,toggleCss:(s,a)=>this.toggleCss(s,a),setUserStyles:s=>vh(n,s),setTop:s=>r.top=s,setTransform:s=>r.transform=s,setRowIndex:s=>n.setAttribute("row-index",s),setRowId:s=>n.setAttribute("row-id",s),setRowBusinessKey:s=>n.setAttribute("row-business-key",s),refreshFullWidth:s=>{let a=s();return this.fullWidthCellRendererParams=a,this.fullWidthCellRenderer?.refresh?.(a)??!1}};t.setComp(o,this.getGui(),i,void 0),this.addDestroyFunc(()=>{t.unsetComp(i)})}setInitialStyle(t,e){let i=this.rowCtrl.getInitialTransform(e);if(i)t.style.setProperty("transform",i);else{let n=this.rowCtrl.getInitialRowTop(e);n&&t.style.setProperty("top",n)}}showFullWidth(t){let e=n=>{if(this.isAlive()){let r=n.getGui();this.getGui().appendChild(r),this.rowCtrl.setupDetailRowAutoHeight(r),this.setFullWidthRowComp(n,t.params)}else this.beans.context.destroyBean(n)};t.newAgStackInstance().then(e)}setCellCtrls(t){let e=new Map(this.cellComps);for(let i of t){let n=i.instanceId;this.cellComps.has(n)?e.delete(n):this.newCellComp(i)}this.destroyCells(e),this.ensureDomOrder(t)}ensureDomOrder(t){if(!this.domOrder)return;let e=[];for(let i of t){let n=this.cellComps.get(i.instanceId);n&&e.push(n.getGui())}kD(this.getGui(),e)}newCellComp(t){let e=this.beans.editSvc?.isEditing(t,{withOpenEditor:!0})??!1,i=new bJ(this.beans,t,this.rowCtrl.printLayout,this.getGui(),e);this.cellComps.set(t.instanceId,i),this.getGui().appendChild(i.getGui())}destroy(){super.destroy(),this.destroyCells(this.cellComps)}setFullWidthRowComp(t,e){this.fullWidthCellRenderer=t,this.fullWidthCellRendererParams=e,this.addDestroyFunc(()=>{this.fullWidthCellRenderer=this.beans.context.destroyBean(this.fullWidthCellRenderer),this.fullWidthCellRendererParams=void 0})}destroyCells(t){for(let e of t.values()){if(!e)return;let i=e.cellCtrl.instanceId;if(this.cellComps.get(i)!==e)return;e.detach(),e.destroy(),this.cellComps.delete(i)}}};function SJ(t,e,i){let n=!!i.gos.get("enableCellSpan")&&!!e.getSpannedRowCtrls,r={tag:"div",ref:"eContainer",cls:cm(t),role:"rowgroup"};if(e.type==="center"||n){let o={tag:"div",ref:"eSpannedContainer",cls:`ag-spanning-container ${UY(t)}`,role:"presentation"};return r.role="presentation",{tag:"div",ref:"eViewport",cls:`ag-viewport ${YM(t)}`,role:"rowgroup",children:[r,n?o:null]}}return r}var xJ=class extends et{constructor(t){super(),this.eViewport=re,this.eContainer=re,this.eSpannedContainer=re,this.rowCompsNoSpan={},this.rowCompsWithSpan={},this.name=t?.name,this.options=yh(this.name)}postConstruct(){this.setTemplate(SJ(this.name,this.options,this.beans));let t={setHorizontalScroll:i=>this.eViewport.scrollLeft=i,setViewportHeight:i=>this.eViewport.style.height=i,setRowCtrls:({rowCtrls:i})=>this.setRowCtrls(i),setSpannedRowCtrls:i=>this.setRowCtrls(i,!0),setDomOrder:i=>{this.domOrder=i},setContainerWidth:i=>{this.eContainer.style.width=i,this.eSpannedContainer&&(this.eSpannedContainer.style.width=i)},setOffsetTop:i=>{let n=`translateY(${i})`;this.eContainer.style.transform=n,this.eSpannedContainer&&(this.eSpannedContainer.style.transform=n)}};this.createManagedBean(new eX(this.name)).setComp(t,this.eContainer,this.eSpannedContainer,this.eViewport)}destroy(){this.setRowCtrls([]),this.setRowCtrls([],!0),super.destroy(),this.lastPlacedElement=null}setRowCtrls(t,e){let{beans:i,options:n}=this,r=e?this.eSpannedContainer:this.eContainer,o=e?w({},this.rowCompsWithSpan):w({},this.rowCompsNoSpan),s={};e?this.rowCompsWithSpan=s:this.rowCompsNoSpan=s,this.lastPlacedElement=null;let a=[];for(let l of t){let c=l.instanceId,d=o[c],u;if(d)u=d,delete o[c];else{if(!l.rowNode.displayed)continue;u=new yJ(l,i,n.type)}s[c]=u,a.push([u,!d])}this.removeOldRows(Object.values(o)),this.addRowNodes(a,r)}addRowNodes(t,e){let{domOrder:i}=this;for(let[n,r]of t){let o=n.getGui();i?this.ensureDomOrder(o,e):r&&e.appendChild(o)}}removeOldRows(t){for(let e of t)e.getGui().remove(),e.destroy()}ensureDomOrder(t,e){_D(e,t,this.lastPlacedElement),this.lastPlacedElement=t}},EJ={selector:"AG-ROW-CONTAINER",component:xJ};function Gu(t,e){return e.map(i=>{let n=`e${i[0].toUpperCase()+i.substring(1)}RowContainer`;return t[n]={name:i},{tag:"ag-row-container",ref:n,attrs:{name:i}}})}function PJ(t){let e={},i={tag:"div",ref:"eGridRoot",cls:"ag-root ag-unselectable",children:[{tag:"ag-header-root"},{tag:"div",ref:"eTop",cls:"ag-floating-top",role:"presentation",children:Gu(e,["topLeft","topCenter","topRight","topFullWidth"])},{tag:"div",ref:"eBody",cls:"ag-body",role:"presentation",children:[{tag:"div",ref:"eBodyViewport",cls:"ag-body-viewport",role:"presentation",children:Gu(e,["left","center","right","fullWidth"])},{tag:"ag-fake-vertical-scroll"}]},{tag:"div",ref:"eStickyTop",cls:"ag-sticky-top",role:"presentation",children:Gu(e,["stickyTopLeft","stickyTopCenter","stickyTopRight","stickyTopFullWidth"])},{tag:"div",ref:"eStickyBottom",cls:"ag-sticky-bottom",role:"presentation",children:Gu(e,["stickyBottomLeft","stickyBottomCenter","stickyBottomRight","stickyBottomFullWidth"])},{tag:"div",ref:"eBottom",cls:"ag-floating-bottom",role:"presentation",children:Gu(e,["bottomLeft","bottomCenter","bottomRight","bottomFullWidth"])},{tag:"ag-fake-horizontal-scroll"},t?{tag:"ag-overlay-wrapper"}:null]};return{paramsMap:e,elementParams:i}}var RJ=class extends et{constructor(){super(...arguments),this.eGridRoot=re,this.eBodyViewport=re,this.eStickyTop=re,this.eStickyBottom=re,this.eTop=re,this.eBottom=re,this.eBody=re}postConstruct(){let{overlays:t,rangeSvc:e}=this.beans,i=t?.getOverlayWrapperSelector(),{paramsMap:n,elementParams:r}=PJ(!!i);this.setTemplate(r,[...i?[i]:[],aX,dX,wJ,EJ],n);let o=(a,l)=>{let c=`${a}px`;l.style.minHeight=c,l.style.height=c},s={setRowAnimationCssOnBodyViewport:(a,l)=>this.setRowAnimationCssOnBodyViewport(a,l),setColumnCount:a=>Nj(this.getGui(),a),setRowCount:a=>Oj(this.getGui(),a),setTopHeight:a=>o(a,this.eTop),setBottomHeight:a=>o(a,this.eBottom),setTopInvisible:a=>this.eTop.classList.toggle("ag-invisible",a),setBottomInvisible:a=>this.eBottom.classList.toggle("ag-invisible",a),setStickyTopHeight:a=>this.eStickyTop.style.height=a,setStickyTopTop:a=>this.eStickyTop.style.top=a,setStickyTopWidth:a=>this.eStickyTop.style.width=a,setStickyBottomHeight:a=>{this.eStickyBottom.style.height=a,this.eStickyBottom.classList.toggle("ag-invisible",a==="0px")},setStickyBottomBottom:a=>this.eStickyBottom.style.bottom=a,setStickyBottomWidth:a=>this.eStickyBottom.style.width=a,setColumnMovingCss:(a,l)=>this.toggleCss(a,l),updateLayoutClasses:(a,l)=>{let c=[this.eBodyViewport.classList,this.eBody.classList];for(let d of c)d.toggle(Qn.AUTO_HEIGHT,l.autoHeight),d.toggle(Qn.NORMAL,l.normal),d.toggle(Qn.PRINT,l.print);this.toggleCss(Qn.AUTO_HEIGHT,l.autoHeight),this.toggleCss(Qn.NORMAL,l.normal),this.toggleCss(Qn.PRINT,l.print)},setAlwaysVerticalScrollClass:(a,l)=>this.eBodyViewport.classList.toggle(QM,l),registerBodyViewportResizeListener:a=>{let l=Ss(this.beans,this.eBodyViewport,a);this.addDestroyFunc(()=>l())},setPinnedTopBottomOverflowY:a=>this.eTop.style.overflowY=this.eBottom.style.overflowY=a,setCellSelectableCss:(a,l)=>{for(let c of[this.eTop,this.eBodyViewport,this.eBottom])c.classList.toggle(a,l)},setBodyViewportWidth:a=>this.eBodyViewport.style.width=a,setGridRootRole:a=>vs(this.eGridRoot,a)};this.ctrl=this.createManagedBean(new nX),this.ctrl.setComp(s,this.getGui(),this.eBodyViewport,this.eTop,this.eBottom,this.eStickyTop,this.eStickyBottom),(e&&So(this.gos)||dh(this.gos))&&Aj(this.getGui(),!0)}setRowAnimationCssOnBodyViewport(t,e){let i=this.eBodyViewport.classList;i.toggle("ag-row-animation",e),i.toggle("ag-row-no-animation",!e)}},_J={selector:"AG-GRID-BODY",component:RJ},kJ=class extends H{constructor(){super(...arguments),this.additionalFocusableContainers=new Set}setComp(t,e,i){this.view=t,this.eGridHostDiv=e,this.eGui=i,this.eGui.setAttribute("grid-id",this.beans.context.getId());let{dragAndDrop:n,ctrlsSvc:r}=this.beans;n?.registerGridDropTarget(()=>this.eGui,this),this.createManagedBean(new qS(this.view)),this.view.setRtlClass(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr");let o=Ss(this.beans,this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc(()=>o()),r.register("gridCtrl",this)}isDetailGrid(){return EM(this.getGui())?.getAttribute("row-id")?.startsWith("detail")||!1}getOptionalSelectors(){let t=this.beans;return{paginationSelector:t.pagination?.getPaginationSelector(),gridHeaderDropZonesSelector:t.registry?.getSelector("AG-GRID-HEADER-DROP-ZONES"),sideBarSelector:t.sideBar?.getSelector(),statusBarSelector:t.registry?.getSelector("AG-STATUS-BAR"),watermarkSelector:t.licenseManager?.getWatermarkSelector()}}onGridSizeChanged(){this.eventSvc.dispatchEvent({type:"gridSizeChanged",clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight})}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(t){let{view:e}=this;if(t===!1)e.setCursor(null);else{let i=t===1?"ew-resize":"ns-resize";e.setCursor(i)}}disableUserSelect(t){this.view.setUserSelect(t?"none":null)}focusNextInnerContainer(t){let e=this.getFocusableContainers(),{indexWithFocus:i,nextIndex:n}=this.getNextFocusableIndex(e,t);if(n<0||n>=e.length)return!1;if(n===0){if(i>0){let{visibleCols:r,focusSvc:o}=this.beans,s=r.allCols,a=dt(s);if(o.focusGridView({column:a,backwards:!0}))return!0}return!1}return this.focusContainer(e[n],t)}focusInnerElement(t){if(this.gos.getCallback("focusGridInnerElement")?.({fromBottom:!!t}))return!0;let i=this.getFocusableContainers(),{focusSvc:n,visibleCols:r}=this.beans,o=r.allCols;if(t){if(i.length>1)return this.focusContainer(dt(i),t);let s=dt(o);if(n.focusGridView({column:s,backwards:t}))return!0}if(this.gos.get("headerHeight")===0||Ra(this.beans)){if(n.focusGridView({column:o[0],backwards:t}))return!0;for(let s=1;s<i.length;s++)if(Ta(i[s].getGui(),t))return!0;return!1}return n.focusFirstHeader()}forceFocusOutOfContainer(t=!1){this.view.forceFocusOutOfContainer(t)}addFocusableContainer(t){this.additionalFocusableContainers.add(t)}removeFocusableContainer(t){this.additionalFocusableContainers.delete(t)}allowFocusForNextCoreContainer(t){let e=this.view.getFocusableContainers(),{nextIndex:i,indexWithFocus:n}=this.getNextFocusableIndex(e,t);if(n===-1||i<0||i>=e.length)return;let r=e[i];r.setAllowFocus?.(!0),setTimeout(()=>{r.setAllowFocus?.(!1)})}isFocusable(){let t=this.beans;return!Wm(t)||!Ra(t)||!!t.sideBar?.comp?.isDisplayed()}getNextFocusableIndex(t,e){let i=St(this.beans),n=t.findIndex(o=>o.getGui().contains(i)),r=n+(e?-1:1);return{indexWithFocus:n,nextIndex:r}}focusContainer(t,e){t.setAllowFocus?.(!0);let i=Ta(t.getGui(),e,!1,!0);return t.setAllowFocus?.(!1),i}getFocusableContainers(){return[...this.view.getFocusableContainers(),...this.additionalFocusableContainers]}destroy(){this.additionalFocusableContainers.clear(),super.destroy()}},FJ=class extends l8{constructor(t){super(),this.gridBody=re,this.sideBar=re,this.pagination=re,this.rootWrapperBody=re,this.eGridDiv=t}postConstruct(){let t={destroyGridUi:()=>this.destroyBean(this),setRtlClass:o=>this.addCss(o),forceFocusOutOfContainer:this.forceFocusOutOfContainer.bind(this),updateLayoutClasses:this.updateLayoutClasses.bind(this),getFocusableContainers:this.getFocusableContainers.bind(this),setUserSelect:o=>{this.getGui().style.userSelect=o??"",this.getGui().style.webkitUserSelect=o??""},setCursor:o=>{this.getGui().style.cursor=o??""}},e=this.createManagedBean(new kJ),i=e.getOptionalSelectors(),n=this.createTemplate(i),r=[_J,...Object.values(i).filter(o=>!!o)];this.setTemplate(n,r),e.setComp(t,this.eGridDiv,this.getGui()),this.insertGridIntoDom(),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:o=>e.focusInnerElement(o),forceFocusOutWhenTabGuardsAreEmpty:!0,isEmpty:()=>!e.isFocusable()})}insertGridIntoDom(){let t=this.getGui();this.eGridDiv.appendChild(t),this.addDestroyFunc(()=>{t.remove(),Cs(this.gos,"Grid removed from DOM")})}updateLayoutClasses(t,e){let i=this.rootWrapperBody.classList,{AUTO_HEIGHT:n,NORMAL:r,PRINT:o}=Qn,{autoHeight:s,normal:a,print:l}=e;i.toggle(n,s),i.toggle(r,a),i.toggle(o,l),this.toggleCss(n,s),this.toggleCss(r,a),this.toggleCss(o,l)}createTemplate(t){let e=t.gridHeaderDropZonesSelector?{tag:"ag-grid-header-drop-zones"}:null,i=t.sideBarSelector?{tag:"ag-side-bar",ref:"sideBar"}:null,n=t.statusBarSelector?{tag:"ag-status-bar"}:null,r=t.watermarkSelector?{tag:"ag-watermark"}:null,o=t.paginationSelector?{tag:"ag-pagination",ref:"pagination"}:null;return{tag:"div",cls:"ag-root-wrapper",role:"presentation",children:[e,{tag:"div",ref:"rootWrapperBody",cls:"ag-root-wrapper-body",role:"presentation",children:[{tag:"ag-grid-body",ref:"gridBody"},i]},n,o,r]}}getFocusableElement(){return this.rootWrapperBody}forceFocusOutOfContainer(t=!1){if(!t&&this.pagination?.isDisplayed()){this.pagination.forceFocusOutOfContainer(t);return}super.forceFocusOutOfContainer(t)}getFocusableContainers(){let t=[this.gridBody];for(let e of[this.sideBar,this.pagination])e&&t.push(e);return t.filter(e=>Nr(e.getGui()))}},_e=(t,e)=>{for(let i of Object.keys(e))e[i]=t;return e},AT=w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w({dispatchEvent:"CommunityCore"},_e("CommunityCore",{destroy:0,getGridId:0,getGridOption:0,isDestroyed:0,setGridOption:0,updateGridOptions:0,isModuleRegistered:0})),_e("GridState",{getState:0,setState:0})),_e("SharedRowSelection",{setNodesSelected:0,selectAll:0,deselectAll:0,selectAllFiltered:0,deselectAllFiltered:0,selectAllOnCurrentPage:0,deselectAllOnCurrentPage:0,getSelectedNodes:0,getSelectedRows:0})),_e("RowApi",{redrawRows:0,setRowNodeExpanded:0,getRowNode:0,addRenderedRowListener:0,getRenderedNodes:0,forEachNode:0,getFirstDisplayedRowIndex:0,getLastDisplayedRowIndex:0,getDisplayedRowAtIndex:0,getDisplayedRowCount:0})),_e("ScrollApi",{getVerticalPixelRange:0,getHorizontalPixelRange:0,ensureColumnVisible:0,ensureIndexVisible:0,ensureNodeVisible:0})),_e("KeyboardNavigation",{getFocusedCell:0,clearFocusedCell:0,setFocusedCell:0,tabToNextCell:0,tabToPreviousCell:0,setFocusedHeader:0})),_e("EventApi",{addEventListener:0,addGlobalListener:0,removeEventListener:0,removeGlobalListener:0})),_e("ValueCache",{expireValueCache:0})),_e("CellApi",{getCellValue:0})),_e("SharedMenu",{showColumnMenu:0,hidePopupMenu:0})),_e("Sort",{onSortChanged:0})),_e("PinnedRow",{getPinnedTopRowCount:0,getPinnedBottomRowCount:0,getPinnedTopRow:0,getPinnedBottomRow:0,forEachPinnedRow:0})),_e("Overlay",{showLoadingOverlay:0,showNoRowsOverlay:0,hideOverlay:0})),_e("RenderApi",{setGridAriaProperty:0,refreshCells:0,refreshHeader:0,isAnimationFrameQueueEmpty:0,flushAllAnimationFrames:0,getSizesForCurrentTheme:0,getCellRendererInstances:0})),_e("HighlightChanges",{flashCells:0})),_e("RowDrag",{addRowDropZone:0,removeRowDropZone:0,getRowDropZoneParams:0,getRowDropPositionIndicator:0,setRowDropPositionIndicator:0})),_e("ColumnApi",{getColumnDefs:0,getColumnDef:0,getDisplayNameForColumn:0,getColumn:0,getColumns:0,applyColumnState:0,getColumnState:0,resetColumnState:0,isPinning:0,isPinningLeft:0,isPinningRight:0,getDisplayedColAfter:0,getDisplayedColBefore:0,setColumnsVisible:0,setColumnsPinned:0,getAllGridColumns:0,getDisplayedLeftColumns:0,getDisplayedCenterColumns:0,getDisplayedRightColumns:0,getAllDisplayedColumns:0,getAllDisplayedVirtualColumns:0})),_e("ColumnAutoSize",{sizeColumnsToFit:0,autoSizeColumns:0,autoSizeAllColumns:0})),_e("ColumnGroup",{setColumnGroupOpened:0,getColumnGroup:0,getProvidedColumnGroup:0,getDisplayNameForColumnGroup:0,getColumnGroupState:0,setColumnGroupState:0,resetColumnGroupState:0,getLeftDisplayedColumnGroups:0,getCenterDisplayedColumnGroups:0,getRightDisplayedColumnGroups:0,getAllDisplayedColumnGroups:0})),_e("ColumnMove",{moveColumnByIndex:0,moveColumns:0})),_e("ColumnResize",{setColumnWidths:0})),_e("ColumnHover",{isColumnHovered:0})),_e("EditCore",{getCellEditorInstances:0,getEditingCells:0,getEditRowValues:0,stopEditing:0,startEditingCell:0,isEditing:0,validateEdit:0})),_e("BatchEdit",{startBatchEdit:0,cancelBatchEdit:0,commitBatchEdit:0,isBatchEditing:0})),_e("UndoRedoEdit",{undoCellEditing:0,redoCellEditing:0,getCurrentUndoSize:0,getCurrentRedoSize:0})),_e("FilterCore",{isAnyFilterPresent:0,onFilterChanged:0})),_e("ColumnFilter",{isColumnFilterPresent:0,getColumnFilterInstance:0,destroyFilter:0,setFilterModel:0,getFilterModel:0,getColumnFilterModel:0,setColumnFilterModel:0,showColumnFilter:0,hideColumnFilter:0,getColumnFilterHandler:0,doFilterAction:0})),_e("QuickFilter",{isQuickFilterPresent:0,getQuickFilter:0,resetQuickFilter:0})),_e("Find",{findGetActiveMatch:0,findGetTotalMatches:0,findGoTo:0,findNext:0,findPrevious:0,findGetNumMatches:0,findGetParts:0,findClearActive:0,findRefresh:0})),_e("Pagination",{paginationIsLastPageFound:0,paginationGetPageSize:0,paginationGetCurrentPage:0,paginationGetTotalPages:0,paginationGetRowCount:0,paginationGoToNextPage:0,paginationGoToPreviousPage:0,paginationGoToFirstPage:0,paginationGoToLastPage:0,paginationGoToPage:0})),_e("CsrmSsrmSharedApi",{expandAll:0,collapseAll:0})),_e("SsrmInfiniteSharedApi",{setRowCount:0,getCacheBlockState:0,isLastRowIndexKnown:0})),_e("ClientSideRowModelApi",{onGroupExpandedOrCollapsed:0,refreshClientSideRowModel:0,isRowDataEmpty:0,forEachLeafNode:0,forEachNodeAfterFilter:0,forEachNodeAfterFilterAndSort:0,applyTransaction:0,applyTransactionAsync:0,flushAsyncTransactions:0,getBestCostNodeSelection:0,onRowHeightChanged:0,resetRowHeights:0})),_e("CsvExport",{getDataAsCsv:0,exportDataAsCsv:0})),_e("InfiniteRowModel",{refreshInfiniteCache:0,purgeInfiniteCache:0,getInfiniteRowCount:0})),_e("AdvancedFilter",{getAdvancedFilterModel:0,setAdvancedFilterModel:0,showAdvancedFilterBuilder:0,hideAdvancedFilterBuilder:0})),_e("IntegratedCharts",{getChartModels:0,getChartRef:0,getChartImageDataURL:0,downloadChart:0,openChartToolPanel:0,closeChartToolPanel:0,createRangeChart:0,createPivotChart:0,createCrossFilterChart:0,updateChart:0,restoreChart:0})),_e("Clipboard",{copyToClipboard:0,cutToClipboard:0,copySelectedRowsToClipboard:0,copySelectedRangeToClipboard:0,copySelectedRangeDown:0,pasteFromClipboard:0})),_e("ExcelExport",{getDataAsExcel:0,exportDataAsExcel:0,getSheetDataForExcel:0,getMultipleSheetsAsExcel:0,exportMultipleSheetsAsExcel:0})),_e("SharedMasterDetail",{addDetailGridInfo:0,removeDetailGridInfo:0,getDetailGridInfo:0,forEachDetailGridInfo:0})),_e("ContextMenu",{showContextMenu:0})),_e("ColumnMenu",{showColumnChooser:0,hideColumnChooser:0})),_e("CellSelection",{getCellRanges:0,addCellRange:0,clearRangeSelection:0,clearCellSelection:0})),_e("SharedRowGrouping",{setRowGroupColumns:0,removeRowGroupColumns:0,addRowGroupColumns:0,getRowGroupColumns:0,moveRowGroupColumn:0})),_e("SharedAggregation",{addAggFuncs:0,clearAggFuncs:0,setColumnAggFunc:0})),_e("SharedPivot",{isPivotMode:0,getPivotResultColumn:0,setValueColumns:0,getValueColumns:0,removeValueColumns:0,addValueColumns:0,setPivotColumns:0,removePivotColumns:0,addPivotColumns:0,getPivotColumns:0,setPivotResultColumns:0,getPivotResultColumns:0})),_e("ServerSideRowModelApi",{getServerSideSelectionState:0,setServerSideSelectionState:0,applyServerSideTransaction:0,applyServerSideTransactionAsync:0,applyServerSideRowData:0,retryServerSideLoads:0,flushServerSideAsyncTransactions:0,refreshServerSide:0,getServerSideGroupLevelState:0,onRowHeightChanged:0,resetRowHeights:0})),_e("SideBar",{isSideBarVisible:0,setSideBarVisible:0,setSideBarPosition:0,openToolPanel:0,closeToolPanel:0,getOpenedToolPanel:0,refreshToolPanel:0,isToolPanelShowing:0,getToolPanelInstance:0,getSideBar:0})),_e("StatusBar",{getStatusPanel:0})),_e("AiToolkit",{getStructuredSchema:0})),Fy={isDestroyed:()=>!0,destroy(){},preConstruct(){},postConstruct(){},preWireBeans(){},wireBeans(){}},TJ=(t,e)=>t.eventSvc.dispatchEvent(e),c8=class{};Reflect.defineProperty(c8,"name",{value:"GridApi"});var DJ=class extends H{constructor(){super(),this.beanName="apiFunctionSvc",this.api=new c8,this.fns=k(w({},Fy),{dispatchEvent:TJ}),this.preDestroyLink="";let{api:t}=this;for(let e of Object.keys(AT))t[e]=this.makeApi(e)[e]}postConstruct(){this.preDestroyLink=this.beans.frameworkOverrides.getDocLink("grid-lifecycle/#grid-pre-destroyed")}addFunction(t,e){let{fns:i,beans:n}=this;i!==Fy&&(i[t]=n?.validation?.validateApiFunction(t,e)??e)}makeApi(t){return{[t]:(...e)=>{let{beans:i,fns:{[t]:n}}=this;return n?n(i,...e):this.apiNotFound(t)}}}apiNotFound(t){let{beans:e,gos:i,preDestroyLink:n}=this;if(!e)K(26,{fnName:t,preDestroyLink:n});else{let r=AT[t];i.assertModuleRegistered(r,`api.${t}`)&&K(27,{fnName:t,module:r})}}destroy(){super.destroy(),this.fns=Fy,this.beans=null}};function MJ(t){return t.context.getId()}function IJ(t){t.gridDestroySvc.destroy()}function AJ(t){return t.gridDestroySvc.destroyCalled}function OJ(t,e){return t.gos.get(e)}function LJ(t,e,i){d8(t,{[e]:i})}function d8(t,e){t.gos.updateGridOptions({options:e})}function NJ(t,e){let i=e.replace(/Module$/,"");return t.gos.isModuleRegistered(i)}var BJ={tag:"div",cls:"ag-drag-handle ag-row-drag",attrs:{draggable:"true"}},HJ=class extends et{constructor(t,e,i){super(BJ),this.rowNode=t,this.column=e,this.eCell=i}postConstruct(){this.getGui().appendChild(Mn("rowDrag",this.beans,null)),this.addGuiEventListener("mousedown",e=>{e.stopPropagation()}),this.addDragSource(),this.checkVisibility()}addDragSource(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))}onDragStart(t){let{rowNode:e,column:i,eCell:n,gos:r}=this,o=i.getColDef().dndSourceOnRowDrag,s=t.dataTransfer;if(s.setDragImage(n,0,0),o){let a=Ee(r,{rowNode:e,dragEvent:t});o(a)}else try{let a=JSON.stringify(e.data);s.setData("application/json",a),s.setData("text/plain",a)}catch{}}checkVisibility(){let t=this.column.isDndSource(this.rowNode);this.setDisplayed(t)}};function zJ(t,e){t.rowDragSvc?.rowDragFeature?.addRowDropZone(e)}function VJ(t,e){let i=t.dragAndDrop?.findExternalZone(e.getContainer());i&&t.dragAndDrop?.removeDropTarget(i)}function GJ(t,e){return t.rowDragSvc?.rowDragFeature?.getRowDropZone(e)}function WJ(t){let e=t.rowDropHighlightSvc;return e?{row:e.row,dropIndicatorPosition:e.position}:{row:null,dropIndicatorPosition:"none"}}function UJ(t,e){let i=t.rowDropHighlightSvc;if(!i)return;let n=e?.row,r=e?.dropIndicatorPosition;r!=="above"&&r!=="below"&&r!=="inside"&&(r="none");let o=n?.rowIndex;o==null||r==="none"?i.clear():i.set(n,r)}var jJ=class extends oY{shouldPreventMouseEvent(t){return this.gos.get("enableCellTextSelection")&&super.shouldPreventMouseEvent(t)}},qJ=class extends H{constructor(){super(...arguments),this.beanName="horizontalResizeSvc"}addResizeBar(t){let e={dragStartPixels:t.dragStartPixels||0,eElement:t.eResizeBar,onDragStart:this.onDragStart.bind(this,t),onDragStop:this.onDragStop.bind(this,t),onDragging:this.onDragging.bind(this,t),onDragCancel:this.onDragStop.bind(this,t),includeTouch:!0,stopPropagationForTouch:!0},{dragSvc:i}=this.beans;return i.addDragSource(e),()=>i.removeDragSource(e)}onDragStart(t,e){this.dragStartX=e.clientX,this.setResizeIcons();let i=e instanceof MouseEvent&&e.shiftKey===!0;t.onResizeStart(i)}setResizeIcons(){let t=this.beans.ctrlsSvc.get("gridCtrl");t.setResizeCursor(1),t.disableUserSelect(!0)}onDragStop(t){t.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){let t=this.beans.ctrlsSvc.get("gridCtrl");t.setResizeCursor(!1),t.disableUserSelect(!1)}onDragging(t,e){this.resizeAmount=e.clientX-this.dragStartX,t.onResizing(this.resizeAmount)}},$J={tag:"div",cls:"ag-drag-handle ag-row-drag",attrs:{"aria-hidden":"true"}},KJ=class extends et{constructor(t,e,i,n,r,o=!1){super(),this.cellValueFn=t,this.rowNode=e,this.column=i,this.customGui=n,this.dragStartPixels=r,this.alwaysVisible=o,this.dragSource=null}isCustomGui(){return this.customGui!=null}postConstruct(){let{beans:t,customGui:e}=this;e?this.setDragElement(e,this.dragStartPixels):(this.setTemplate($J),this.getGui().appendChild(Mn("rowDrag",t,null)),this.addDragSource()),this.alwaysVisible||this.initCellDrag()}initCellDrag(){let{beans:t,gos:e,rowNode:i}=this,n=this.refreshVisibility.bind(this);this.addManagedPropertyListener("suppressRowDrag",n),this.addManagedListeners(i,{dataChanged:n,cellChanged:n}),this.addManagedListeners(t.eventSvc,e.get("rowDragManaged")?{sortChanged:n,filterChanged:n,columnRowGroupChanged:n,newColumnsLoaded:n}:{newColumnsLoaded:n})}setDragElement(t,e){this.setTemplateFromElement(t,void 0,void 0,!0),this.addDragSource(e)}refreshVisibility(){if(this.alwaysVisible)return;let t={skipAriaHidden:!0};if(this.isNeverDisplayed()){this.setDisplayed(!1,t);return}let e=this.column,i=typeof e?.getColDef().rowDrag=="function",n=!e||this.isCustomGui()||e.isRowDrag(this.rowNode);n&&this.rowNode.footer&&this.gos.get("rowDragManaged")&&(n=!1,i=!0),this.setDisplayed(i||n,t),this.setVisible(n,t)}isNeverDisplayed(){let{gos:t,beans:e}=this;return!!(t.get("suppressRowDrag")||t.get("rowDragManaged")&&e.rowDragSvc.rowDragFeature?.shouldPreventRowMove()&&!e.dragAndDrop?.hasExternalDropZones())}getSelectedNodes(){let t=this.rowNode;if(!this.gos.get("rowDragMultiRow"))return[t];let i=this.beans.selectionSvc?.getSelectedNodes()??[];return i.indexOf(t)!==-1?i:[t]}getDragItem(){let{column:t,rowNode:e}=this;return{rowNode:e,rowNodes:this.getSelectedNodes(),columns:t?[t]:void 0,defaultTextValue:this.cellValueFn()}}getRowDragText(t){if(t){let e=t.getColDef();if(e.rowDragText)return e.rowDragText}return this.gos.get("rowDragText")}addDragSource(t=4){if(this.dragSource&&this.removeDragSource(),this.gos.get("rowDragManaged")&&this.rowNode.footer)return;let e=this.getGui();this.gos.get("enableCellTextSelection")&&(this.removeMouseDownListener(),this.mouseDownListener=this.addManagedElementListeners(e,{mousedown:n=>{n?.preventDefault()}})[0]);let i=this.getLocaleTextFunc();this.dragSource={type:2,eElement:e,dragItemName:n=>{let r=n?.dragItem||this.getDragItem(),o=(n?.dropTarget?.rows.length??r.rowNodes?.length)||1,s=this.getRowDragText(this.column);return s?s(r,o):o===1?this.cellValueFn():`${o} ${i("rowDragRows","rows")}`},getDragItem:()=>this.getDragItem(),dragStartPixels:t,dragSourceDomDataKey:this.gos.getDomDataKey()},this.beans.dragAndDrop.addDragSource(this.dragSource,!0)}destroy(){this.removeDragSource(),this.removeMouseDownListener(),super.destroy()}removeDragSource(){this.dragSource&&(this.beans.dragAndDrop.removeDragSource(this.dragSource),this.dragSource=null)}removeMouseDownListener(){this.mouseDownListener&&(this.mouseDownListener(),this.mouseDownListener=void 0)}},dm=class{constructor(){this.reordered=!1,this.removals=new Set,this.updates=new Set,this.adds=new Set}};function YJ(t){let{rowIndex:e,rowPinned:i,column:n}=t;return`${e}.${i??"null"}.${n.getId()}`}function u8(t,e){let i=t.column===e.column,n=t.rowPinned===e.rowPinned,r=t.rowIndex===e.rowIndex;return i&&n&&r}function XJ(t,e){switch(t.rowPinned){case"top":if(e.rowPinned!=="top")return!0;break;case"bottom":if(e.rowPinned!=="bottom")return!1;break;default:if(ae(e.rowPinned))return e.rowPinned!=="top";break}return t.rowIndex<e.rowIndex}function JJ(t,e){return!t&&!e?!0:t&&!e||!t&&e?!1:t.rowIndex===e.rowIndex&&t.rowPinned==e.rowPinned}function QJ(t){let e=0,i,{pinnedRowModel:n,rowModel:r,pageBounds:o}=t;return n?.getPinnedTopRowCount()?i="top":r.getRowCount()?(i=null,e=o.getFirstRow()):n?.getPinnedBottomRowCount()&&(i="bottom"),i===void 0?null:{rowIndex:e,rowPinned:i}}function ZJ(t){let e,i=null,{pinnedRowModel:n,pageBounds:r}=t,o=n?.getPinnedBottomRowCount(),s=n?.getPinnedTopRowCount();return o?(i="bottom",e=o-1):t.rowModel.getRowCount()?e=r.getLastRow():s&&(i="top",e=s-1),e===void 0?null:{rowIndex:e,rowPinned:i}}function xo(t,e){switch(e.rowPinned){case"top":return t.pinnedRowModel?.getPinnedTopRow(e.rowIndex);case"bottom":return t.pinnedRowModel?.getPinnedBottomRow(e.rowIndex);default:return t.rowModel.getRow(e.rowIndex)}}function ec(t,e){let i=t.spannedRowRenderer?.getCellByPosition(e);if(i)return i;let n=t.rowRenderer.getRowByPosition(e);return n?n.getCellCtrl(e.column):null}function eQ(t,e,i){let{rowModel:n,pinnedRowModel:r}=t,o;return o??(o=n?.getRowNode(e)),i?o??(o=r?.getPinnedRowById(e,i)):(o??(o=r?.getPinnedRowById(e,"top")),o??(o=r?.getPinnedRowById(e,"bottom"))),o}function Mm(t,e,i=!1){let{rowIndex:n,rowPinned:r}=e,{pageBounds:o,pinnedRowModel:s,rowModel:a}=t;if(n===0)return r==="top"?null:r==="bottom"&&a.isRowsToRender()?{rowIndex:o.getLastRow(),rowPinned:null}:s?.isRowsToRender("top")?{rowIndex:s.getPinnedTopRowCount()-1,rowPinned:"top"}:null;if(i){let l=r?void 0:a.getRow(n);return h8(t,l,!0)??{rowIndex:n-1,rowPinned:r}}return{rowIndex:n-1,rowPinned:r}}function OT(t,e,i=!1){let{rowIndex:n,rowPinned:r}=e,{pageBounds:o,pinnedRowModel:s,rowModel:a}=t;if(tQ(t,e))return r==="bottom"?null:r==="top"&&a.isRowsToRender()?{rowIndex:o.getFirstRow(),rowPinned:null}:s?.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;if(i){let l=r?void 0:a.getRow(n);return h8(t,l)??{rowIndex:n+1,rowPinned:r}}return{rowIndex:n+1,rowPinned:r}}function h8(t,e,i=!1){let{gos:n,rowRenderer:r}=t;if(!e?.sticky||!$D(n))return;let o=r.getStickyTopRowCtrls(),s=r.getStickyBottomRowCtrls(),a=!s.some(u=>u.rowNode.rowIndex===e.rowIndex),l=a?o:s,c=(i?-1:1)*(a?-1:1),d;for(let u=0;u<l.length;u++)if(l[u].rowNode.rowIndex===e.rowIndex){d=l[u+c];break}return d?{rowIndex:d.rowNode.rowIndex,rowPinned:null}:void 0}function tQ(t,e){let{rowPinned:i,rowIndex:n}=e,{pinnedRowModel:r,pageBounds:o}=t;return i==="top"?(r?.getPinnedTopRowCount()??0)-1<=n:i==="bottom"?(r?.getPinnedBottomRowCount()??0)-1<=n:o.getLastRow()<=n}var fh=class{constructor(t,e){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=t,this.pathRoot={rowNode:e,children:null},this.mapToItems[e.id]=this.pathRoot}depthFirstSearchChangedPath(t,e){let{rowNode:i,children:n}=t;if(n)for(let r=0;r<n.length;++r)this.depthFirstSearchChangedPath(n[r],e);e(i)}depthFirstSearchEverything(t,e,i){let n=t.childrenAfterGroup;if(n)for(let r=0,o=n.length;r<o;++r){let s=n[r];s.childrenAfterGroup?this.depthFirstSearchEverything(s,e,i):i&&e(s)}e(t)}forEachChangedNodeDepthFirst(t,e=!1,i=!1){this.active&&!i?this.depthFirstSearchChangedPath(this.pathRoot,t):this.depthFirstSearchEverything(this.pathRoot.rowNode,t,e)}executeFromRootNode(t){t(this.pathRoot.rowNode)}createPathItems(t){let e=t,i=0;for(;!this.mapToItems[e.id];){let n={rowNode:e,children:null};this.mapToItems[e.id]=n,i++,e=e.parent}return i}populateColumnsMap(t,e){if(!this.keepingColumns||!e)return;let i=t;for(;i;){this.nodeIdsToColumns[i.id]||(this.nodeIdsToColumns[i.id]={});for(let n of e)this.nodeIdsToColumns[i.id][n.getId()]=!0;i=i.parent}}linkPathItems(t,e){let i=t;for(let n=0;n<e;n++){let r=this.mapToItems[i.id],o=this.mapToItems[i.parent.id];o.children||(o.children=[]),o.children.push(r),i=i.parent}}addParentNode(t,e){if(!t||t.isRowPinned())return;let i=this.createPathItems(t);this.linkPathItems(t,i),this.populateColumnsMap(t,e)}canSkip(t){return this.active&&!this.mapToItems[t.id]}getValueColumnsForNode(t,e){if(!this.keepingColumns)return e;let i=this.nodeIdsToColumns[t.id];return e.filter(r=>i[r.getId()])}getNotValueColumnsForNode(t,e){if(!this.keepingColumns)return null;let i=this.nodeIdsToColumns[t.id];return e.filter(r=>!i[r.getId()])}},iQ=class{constructor(t,e){this.beans=t,this.groupThrottled=!1,this.scrollChanged=!1,this.scrollChanging=!1,this.oldVScroll=null,this.groupTimer=null,this.groupTarget=null,this.onGroupThrottle=()=>{this.groupTimer=null,this.groupThrottled=!0,this.beans.dragAndDrop?.nudge()};let i=()=>e.scrollFeature.getVScrollPosition().top;this.autoScroll=new cJ({scrollContainer:e.eBodyViewport,scrollAxis:"y",getVerticalPosition:i,setVerticalPosition:n=>e.scrollFeature.setVerticalScrollPosition(n),onScrollCallback:()=>{let n=i();if(this.oldVScroll!==n){this.oldVScroll=n,this.scrollChanging=!0;return}let r=this.scrollChanging;this.scrollChanged=r,this.scrollChanging=!1,r&&(this.beans.dragAndDrop?.nudge(),this.scrollChanged=!1)}})}updateGroup(t,e){this.groupTarget&&this.groupTarget!==t&&this.clearGroup(),t&&(e&&this.groupThrottled&&!t.expanded&&t.childrenAfterSort?.length&&t.isExpandable()&&t.setExpanded(!0,void 0,!0),t.expanded&&t.childrenAfterSort?.length&&(this.groupThrottled=!0,this.groupTarget=t))}startGroup(t){this.groupTarget=t,this.groupTimer===null&&(this.groupTimer=window.setTimeout(this.onGroupThrottle,this.beans.gos.get("rowDragInsertDelay")))}clearGroup(){this.groupThrottled=!1,this.groupTarget=null;let t=this.groupTimer;t!==null&&(this.groupTimer=null,window.clearTimeout(t))}clear(){this.clearGroup(),this.autoScroll.ensureCleared(),this.oldVScroll=null,this.scrollChanged=!1,this.scrollChanging=!1}},nQ=class extends H{constructor(t){super(),this.eContainer=t,this.lastDraggingEvent=null,this.nudger=null}postConstruct(){let t=this.beans;t.ctrlsSvc.whenReady(this,e=>{this.nudger=new iQ(t,e.gridBodyCtrl)})}destroy(){super.destroy(),this.nudger?.clear(),this.nudger=null,this.lastDraggingEvent=null,this.eContainer=null}getContainer(){return this.eContainer}isInterestedIn(t){return t===2}getIconName(t){return t?.dropTarget?.allowed===!1||this.gos.get("rowDragManaged")&&this.shouldPreventRowMove()?"notAllowed":"move"}shouldPreventRowMove(){let{rowGroupColsSvc:t,filterManager:e,sortSvc:i}=this.beans;return!!((t?.columns??[]).length||e?.isAnyFilterPresent()||i?.isSortActive())}getRowNodes(t){if(!this.isFromThisGrid(t))return t.dragItem.rowNodes||[];let e=t.dragItem.rowNode;if(this.gos.get("rowDragMultiRow")){let i=this.beans.selectionSvc?.getSelectedNodes();if(i&&i.indexOf(e)>=0)return i.slice().sort(sQ)}return[e]}onDragEnter(t){this.dragging(t,!0)}onDragging(t){this.dragging(t,!1)}dragging(t,e){let{lastDraggingEvent:i,beans:n}=this;if(e){let s=this.getRowNodes(t);t.dragItem.rowNodes=s,BT(s,!0)}this.lastDraggingEvent=t;let r=t.fromNudge,o=this.makeRowsDrop(i,t,r,!1);n.rowDropHighlightSvc?.fromDrag(t),e&&this.dispatchGridEvent("rowDragEnter",t),this.dispatchGridEvent("rowDragMove",t),o?.rowDragManaged&&o.moved&&o.allowed&&o.sameGrid&&!o.suppressMoveWhenRowDragging&&(!r&&!this.nudger?.autoScroll.scrolling||this.nudger?.scrollChanged)&&this.dropRows(o),this.nudger?.autoScroll.check(t.event)}isFromThisGrid(t){return t.dragSource.dragSourceDomDataKey===this.gos.getDomDataKey()}makeRowsDrop(t,e,i,n){let{beans:r,gos:o}=this,s=this.newRowsDrop(e,n),a=r.rowModel;if(e.dropTarget=s,e.changed=!1,!s)return null;let{sameGrid:l,rootNode:c,source:d,target:u,rows:h}=s;u??(u=a.getRow(a.getRowCount()-1)??null);let p=!!this.beans.groupStage?.treeData&&l,f=null;if(u?.footer){let b=um(a,-1,u)??um(a,1,u);f=u.sibling??c,u=b??null}u?.detail&&(u=u.parent),s.moved&&(s.moved=d!==u);let g=.5;if(u&&(l&&s.moved&&(f||!p)?g=d.rowIndex>u.rowIndex?-.5:.5:g=(s.y-u.rowTop-u.rowHeight/2)/u.rowHeight||0),!p&&l&&u&&s.moved&&Lt(o)){let b=aQ(a,s);b&&(g=d.rowIndex>b.rowIndex?-.5:.5,u=b,s.moved&&(s.moved=d!==u))}let m=this.nudger;m?.updateGroup(u,i),p&&!f&&m&&(!u||g>=.5&&u.rowIndex===r.pageBounds.getLastRow()?f=c:s.moved&&this.targetShouldBeParent(u,g,h)&&(m.groupThrottled&&(f=u),!i&&(!f||u&&!u.expanded&&u.childrenAfterSort?.length)&&m.startGroup(u)),f??(f=u?.parent??c));let v=!1;if(f){if(f===u&&f!==c){let b=f.expanded?um(a,1,u):null;b?.parent===f?(u=b,g=-.5):v=!0}if(u&&!v){let b=u;for(;b&&b!==c&&b!==f;)u=b,b=b.parent}}s.target=u,s.newParent=f,s.moved&&(s.moved=d!==u);let C=g<0?"above":"below";return s.position=s.moved?v?"inside":C:"none",this.validateRowsDrop(s,p,C,n),e.changed||(e.changed=oQ(t?.dropTarget,s)),s}newRowsDrop(t,e){let{beans:i,gos:n}=this,r=i.rowModel.rootNode,o=Lt(n)?n.get("rowDragManaged"):!1,s=n.get("suppressMoveWhenRowDragging"),a=this.isFromThisGrid(t),{rowNode:l,rowNodes:c}=t.dragItem;if(c||(c=l?[l]:[]),l||(l=c[0]),!l||!r)return null;let d=this.beans.dragAndDrop.isDropZoneWithinThisGrid(t),u=!0;o&&(!c.length||this.shouldPreventRowMove()||(s||!a)&&!d)&&(u=!1);let h=xT(i,t).y,p=this.getOverNode(h);return{api:i.gridApi,context:i.gridOptions.context,draggingEvent:t,rowDragManaged:o,suppressMoveWhenRowDragging:s,sameGrid:a,withinGrid:d,rootNode:r,moved:l!==p,y:h,overNode:p,overIndex:p?.rowIndex??-1,position:"none",source:l,target:p??null,newParent:null,rows:c,allowed:u,highlight:!e&&o&&s&&(d||!a)}}validateRowsDrop(t,e,i,n){let{rowDragManaged:r,suppressMoveWhenRowDragging:o}=t;e||(t.newParent=null),o&&!t.moved&&(t.allowed=!1);let s=(!r||t.allowed)&&this.gos.get("isRowValidDropPosition");if(s){e&&t.newParent&&LT(t.rows,t.newParent)&&(t.newParent=null);let a=s(t);if(!a)t.allowed=!1;else if(typeof a=="object"){a.rows!==void 0&&(t.rows=a.rows??[]),e&&a.newParent!==void 0&&(t.newParent=a.newParent),a.target!==void 0&&(t.target=a.target),a.position&&(t.position=a.position),a.allowed!==void 0?t.allowed=a.allowed:r||(t.allowed=!0);let l=t.draggingEvent;a.changed&&l&&(l.changed=!0),!n&&a.highlight!==void 0&&(t.highlight=a.highlight)}}r&&(t.rows=this.filterRows(t)),e&&t.newParent&&LT(t.rows,t.newParent)&&(t.newParent=null),o&&(!t.rows.length||t.position==="none")&&(t.allowed=!1),(!t.allowed||!t.newParent)&&t.position==="inside"&&(t.position=i)}targetShouldBeParent(t,e,i){let n=t.rowIndex,r=.25;if(e<-.5+r)return!1;if(e<.5-r)return!0;let o,s=n+1,a=this.beans.rowModel;do o=a.getRow(s++);while(o?.footer);let l=t.childrenAfterGroup;if(o&&o.parent===t&&l?.length){let c=new Set(i);for(let d of l)if(d.rowIndex!==null&&!c.has(d))return!0}return!1}addRowDropZone(t){if(!t.getContainer()){K(55);return}let e=this.beans.dragAndDrop;if(e.findExternalZone(t.getContainer())){K(56);return}let i=t.fromGrid?t:{getContainer:t.getContainer,onDragEnter:t.onDragEnter&&(r=>t.onDragEnter(this.rowDragEvent("rowDragEnter",r))),onDragLeave:t.onDragLeave&&(r=>t.onDragLeave(this.rowDragEvent("rowDragLeave",r))),onDragging:t.onDragging&&(r=>t.onDragging(this.rowDragEvent("rowDragMove",r))),onDragStop:t.onDragStop&&(r=>t.onDragStop(this.rowDragEvent("rowDragEnd",r))),onDragCancel:t.onDragCancel&&(r=>t.onDragCancel(this.rowDragEvent("rowDragCancel",r)))},n=w({isInterestedIn:r=>r===2,getIconName:()=>"move",external:!0},i);e.addDropTarget(n),this.addDestroyFunc(()=>e.removeDropTarget(n))}getRowDropZone(t){return{getContainer:this.getContainer.bind(this),onDragEnter:i=>{this.onDragEnter(i),t?.onDragEnter?.(this.rowDragEvent("rowDragEnter",i))},onDragLeave:i=>{this.onDragLeave(i),t?.onDragLeave?.(this.rowDragEvent("rowDragLeave",i))},onDragging:i=>{this.onDragging(i),t?.onDragging?.(this.rowDragEvent("rowDragMove",i))},onDragStop:i=>{this.onDragStop(i),t?.onDragStop?.(this.rowDragEvent("rowDragEnd",i))},onDragCancel:i=>{this.onDragCancel(i),t?.onDragCancel?.(this.rowDragEvent("rowDragCancel",i))},fromGrid:!0}}getOverNode(t){let{pageBounds:e,rowModel:i}=this.beans,r=t>e.getCurrentPagePixelRange().pageLastPixel?-1:i.getRowIndexAtPixel(t);return r>=0?i.getRow(r):void 0}rowDragEvent(t,e){let i=this.beans,{dragItem:n,dropTarget:r,event:o,vDirection:s}=e,a=r?.rootNode===i.rowModel.rootNode,l=a?r.y:xT(i,e).y,c=a?r.overNode:this.getOverNode(l),d=a?r.overIndex:c?.rowIndex??-1;return{api:i.gridApi,context:i.gridOptions.context,type:t,event:o,node:n.rowNode,nodes:n.rowNodes,overIndex:d,overNode:c,y:l,vDirection:s,rowsDrop:r}}dispatchGridEvent(t,e){let i=this.rowDragEvent(t,e);this.eventSvc.dispatchEvent(i)}onDragLeave(t){this.dispatchGridEvent("rowDragLeave",t),this.stopDragging(t)}onDragStop(t){let e=this.makeRowsDrop(this.lastDraggingEvent,t,!1,!0);this.dispatchGridEvent("rowDragEnd",t),e?.allowed&&e.rowDragManaged&&(e.suppressMoveWhenRowDragging||!e.sameGrid||this.nudger?.autoScroll.scrolling)&&this.dropRows(e),this.stopDragging(t)}onDragCancel(t){this.dispatchGridEvent("rowDragCancel",t),this.stopDragging(t)}stopDragging(t){this.nudger?.clear(),this.beans.rowDropHighlightSvc?.fromDrag(null),BT(t.dragItem.rowNodes,!1)}dropRows(t){return t.sameGrid?this.csrmMoveRows(t):this.csrmAddRows(t)}csrmAddRows({position:t,target:e,rows:i}){let n=pc(this.gos),r=this.beans.rowModel,o=i.filter(({data:a,rowPinned:l})=>!r.getRowNode(n?.({data:a,level:0,rowPinned:l})??a.id)).map(({data:a})=>a);if(o.length===0)return!1;let s=e?NT(e)+(t==="above"?0:1):void 0;return r.updateRowData({add:o,addIndex:s}),!0}filterRows({newParent:t,rows:e}){let i;for(let n=0,r=e.length;n<r;++n){let o=!0,s=e[n];(!s||s.footer||s.rowTop===null&&s!==this.beans.rowModel.getRowNode(s.id)||t&&s.parent!==t&&rQ(s,t)||!dS(s))&&(o=!1),o?i?.push(s):i??(i=e.slice(0,n))}return i??e}csrmMoveRows({position:t,target:e,rows:i,newParent:n,rootNode:r}){let o=!1,s=new Set;for(let h of i){n&&h.parent!==n&&(h.treeParent=n,o=!0);let p=dS(h);p&&s.add(p)}if(!o&&s.size===0)return!1;let a=this.beans.focusSvc,l=a.getFocusedCell(),c=l&&ec(this.beans,l);if(s.size&&this.reorderLeafChildren(s,...this.getMoveRowsBounds(s,e,t==="above"))&&(o=!0),!o)return!1;let d=this.beans.rowModel,u=new dm;return u.reordered=!0,d.refreshModel({step:"group",keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame"),changedPath:new fh(!1,r),changedRowNodes:u}),c?c.focusCell():a.clearFocusedCell(),!0}getMoveRowsBounds(t,e,i){let n=this.beans.rowModel.rootNode?._leafs?.length??0,r=e?NT(e):-1;r<0||r>=n?r=n:i||++r;let o=r,s=Math.min(r,n-1);for(let a of t){let l=a.sourceRowIndex;l<o&&(o=l),l>s&&(s=l)}return[o,r,s]}reorderLeafChildren(t,e,i,n){let r=!1,o=this.beans.rowModel.rootNode?._leafs;if(!t.size||!o)return!1;let s=e;for(let l=e;l<i;++l){let c=o[l];t.has(c)||(c.sourceRowIndex!==s&&(c.sourceRowIndex=s,o[s]=c,r=!0),++s)}let a=n;for(let l=n;l>=i;--l){let c=o[l];t.has(c)||(c.sourceRowIndex!==a&&(c.sourceRowIndex=a,o[a]=c,r=!0),--a)}for(let l of t)l.sourceRowIndex!==s&&(l.sourceRowIndex=s,o[s]=l,r=!0),++s;return r}},um=(t,e,i)=>{if(i){let n=t.getRowCount(),r=i.rowIndex+e;for(;r>=0&&r<n;){let o=t.getRow(r);if(!o||!o.footer&&!o.detail)return o;r+=e}}},rQ=(t,e)=>{let i=e;for(;i;){if(i===t)return!0;i=i.parent}return!1},LT=(t,e)=>{for(let i=0,n=t.length;i<n;++i)if(t[i].parent!==e)return!1;return!0},NT=t=>{let e=dS(t);return e!==void 0?e.sourceRowIndex:-1},dS=t=>t.data?t:HM(t.childrenAfterGroup),oQ=(t,e)=>t!==e&&(!t||t.sameGrid!==e.sameGrid||t.allowed!==e.allowed||t.position!==e.position||t.target!==e.target||t.source!==e.source||t.newParent!==e.newParent||!xs(t.rows,e.rows)),sQ=({rowIndex:t},{rowIndex:e})=>t!==null&&e!==null?t-e:0,BT=(t,e)=>{for(let i=0,n=t?.length||0;i<n;++i){let r=t[i];r.dragging!==e&&(r.dragging=e,r.dispatchRowEvent("draggingChanged"))}},aQ=(t,e)=>{let i=null,n=e.target;if(n&&e.rows.indexOf(n)<0)return null;let r=e.source;if(!n||!r)return null;let o=n.rowIndex-r.rowIndex,s=o<0?-1:1;o=e.suppressMoveWhenRowDragging?Math.abs(o):1;let a=new Set(e.rows);do{let l=um(t,s,n);if(!l)break;a.has(l)||(i=l,--o),n=l}while(o>0);return i},lQ=class extends H{constructor(){super(...arguments),this.beanName="rowDragSvc"}setupRowDrag(t,e){let i=e.createManagedBean(new nQ(t)),n=this.beans.dragAndDrop;n.addDropTarget(i),e.addDestroyFunc(()=>n.removeDropTarget(i)),this.rowDragFeature=i}createRowDragComp(t,e,i,n,r,o){return new KJ(t,e,i,n,r,o)}createRowDragCompForRow(t,e){if(So(this.gos))return;let i=this.getLocaleTextFunc();return this.createRowDragComp(()=>`1 ${i("rowDragRow","row")}`,t,void 0,e,void 0,!0)}createRowDragCompForCell(t,e,i,n,r,o){let s=this.gos;return s.get("rowDragManaged")&&(!Lt(s)||s.get("pagination"))?void 0:this.createRowDragComp(i,t,e,n,r,o)}},cQ=class extends H{constructor(){super(...arguments),this.beanName="rowDropHighlightSvc",this.uiLevel=0,this.dragging=!1,this.row=null,this.position="none"}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this)})}onModelUpdated(){let t=this.row,e=this.dragging;!t||t?.rowIndex===null||this.position==="none"?this.clear():this.set(t,this.position),this.dragging=e}destroy(){this.clear(),super.destroy()}clear(){let t=this.row;this.dragging=!1,t&&(this.uiLevel=0,this.position="none",this.row=null,t.dispatchRowEvent("rowHighlightChanged"))}set(t,e){let i=t!==this.row,n=t.uiLevel,r=e!==this.position,o=n!==this.uiLevel;this.dragging=!1,(i||r||o)&&(i&&this.clear(),this.uiLevel=n,this.position=e,this.row=t,t.dispatchRowEvent("rowHighlightChanged"))}fromDrag(t){let e=t?.dropTarget;if(e){let{highlight:i,target:n,position:r}=e;if(i&&n&&r!=="none"){this.set(n,r),this.dragging=!0;return}}this.dragging&&this.clear()}},p8={moduleName:"Drag",version:oe,beans:[jJ]},dQ={moduleName:"DragAndDrop",version:oe,dynamicBeans:{dndSourceComp:HJ},icons:{rowDrag:"grip"}},f8={moduleName:"SharedDragAndDrop",version:oe,beans:[aY],dependsOn:[p8],userComponents:{agDragAndDropImage:VX},icons:{columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",rowDrag:"grip"}},uQ={moduleName:"RowDrag",version:oe,beans:[cQ,lQ],apiFunctions:{addRowDropZone:zJ,removeRowDropZone:VJ,getRowDropZoneParams:GJ,getRowDropPositionIndicator:WJ,setRowDropPositionIndicator:UJ},dependsOn:[f8]},hQ={moduleName:"HorizontalResize",version:oe,beans:[qJ],dependsOn:[p8]},pQ=":where(.ag-ltr) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:left .2s}.ag-header-group-cell{transition:left .2s,width .2s}}:where(.ag-rtl) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:right .2s}.ag-header-group-cell{transition:right .2s,width .2s}}",fQ=class extends H{constructor(){super(...arguments),this.beanName="colAnimation",this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.activeNext=!1,this.suppressAnimation=!1,this.animationThreadCount=0}postConstruct(){this.beans.ctrlsSvc.whenReady(this,t=>this.gridBodyCtrl=t.gridBodyCtrl)}isActive(){return this.active&&!this.suppressAnimation}setSuppressAnimation(t){this.suppressAnimation=t}start(){if(this.active)return;let{gos:t}=this;t.get("suppressColumnMoveAnimation")||t.get("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0,this.activeNext=!0)}finish(){this.active&&this.flush(()=>this.activeNext=!1,()=>this.active=!1)}executeNextVMTurn(t){this.activeNext?this.executeNextFuncs.push(t):t()}executeLaterVMTurn(t){this.active?this.executeLaterFuncs.push(t):t()}ensureAnimationCssClassPresent(){this.animationThreadCount++;let t=this.animationThreadCount,{gridBodyCtrl:e}=this;e.setColumnMovingCss(!0),this.executeLaterFuncs.push(()=>{this.animationThreadCount===t&&e.setColumnMovingCss(!1)})}flush(t,e){let{executeNextFuncs:i,executeLaterFuncs:n}=this;if(i.length===0&&n.length===0){t(),e();return}let r=o=>{for(;o.length;){let s=o.pop();s&&s()}};this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{t(),r(i)},0),window.setTimeout(()=>{e(),r(n)},200)})}};function gQ(t,e,i){t.colMoves?.moveColumnByIndex(e,i,"api")}function mQ(t,e,i){t.colMoves?.moveColumns(e,i,"api")}var vQ=class extends H{constructor(t){super(),this.pinned=t,this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[]}onDragEnter(t){if(this.clearColumnsList(),this.gos.get("functionsReadOnly"))return;let e=t.dragItem.columns;if(e)for(let i of e)i.isPrimary()&&(i.isAnyFunctionActive()||(i.isAllowValue()?this.columnsToAggregate.push(i):i.isAllowRowGroup()?this.columnsToGroup.push(i):i.isAllowPivot()&&this.columnsToPivot.push(i)))}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?"pinned":"move":null}onDragLeave(t){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(t){}onDragStop(t){let{valueColsSvc:e,rowGroupColsSvc:i,pivotColsSvc:n}=this.beans;this.columnsToAggregate.length>0&&e?.addColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&i?.addColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&n?.addColumns(this.columnsToPivot,"toolPanelDragAndDrop")}onDragCancel(){this.clearColumnsList()}};function CQ(t,e){!e||e.length<=1||e.filter(n=>t.indexOf(n)<0).length>0||e.sort((n,r)=>{let o=t.indexOf(n),s=t.indexOf(r);return o-s})}function wQ(t){let e=[...t];for(let i of t){let n=null,r=i.getParent();for(;r!=null&&r.getDisplayedLeafColumns().length===1;)n=r,r=r.getParent();if(n!=null){let s=!!n.getColGroupDef()?.marryChildren?n.getProvidedColumnGroup().getLeafColumns():n.getLeafColumns();for(let a of s)e.includes(a)||e.push(a)}}return e}function bQ(t,e,i,n){let r=n.allCols,o=null,s=null;for(let a=0;a<t.length;a++){let l=t[a],c=i.getProposedColumnOrder(e,l);if(!i.doesOrderPassRules(c))continue;let d=c.filter(h=>r.includes(h));if(s===null)s=d;else if(!xs(d,s))break;let u=SQ(c);(o===null||u<o.fragCount)&&(o={move:l,fragCount:u})}return o}function g8(t){let{isFromHeader:e,fromLeft:i,xPosition:n,fromEnter:r,fakeEvent:o,pinned:s,gos:a,colModel:l,colMoves:c,visibleCols:d}=t,{allMovingColumns:u}=t;e&&(u=wQ(u));let h=u.slice();CQ(l.getCols(),h);let p=EQ({movingCols:h,draggingRight:i,xPosition:n,pinned:s,gos:a,colModel:l,visibleCols:d}),f=yQ(h,l);if(p.length===0)return;let g=p[0];if(f!==null&&(e||!r)&&!o&&(!i&&g>=f||i&&g<=f))return;let v=bQ(p,h,c,d);if(!v)return;let C=v.move;if(!(C>l.getCols().length-h.length))return{columns:h,toIndex:C}}function m8(t){let{columns:e,toIndex:i}=g8(t)||{},{finished:n,colMoves:r}=t;return!e||i==null?null:(r.moveColumns(e,i,"uiColumnMoved",n),n?null:{columns:e,toIndex:i})}function yQ(t,e){let i=e.getCols(),n=t.map(l=>i.indexOf(l)).sort((l,c)=>l-c),r=n[0];return dt(n)-r!==n.length-1?null:r}function SQ(t){function e(n){let r=[],o=n.getOriginalParent();for(;o!=null;)r.push(o),o=o.getOriginalParent();return r}let i=0;for(let n=0;n<t.length-1;n++){let r=e(t[n]),o=e(t[n+1]);[r,o]=r.length>o.length?[r,o]:[o,r];for(let s of r)o.indexOf(s)===-1&&i++}return i}function xQ(t,e){switch(e){case"left":return t.leftCols;case"right":return t.rightCols;default:return t.centerCols}}function EQ(t){let{movingCols:e,draggingRight:i,xPosition:n,pinned:r,gos:o,colModel:s,visibleCols:a}=t;if(o.get("suppressMovableColumns")||e.some(b=>b.getColDef().suppressMovable))return[];let c=xQ(a,r),d=s.getCols(),u=c.filter(b=>e.includes(b)),h=c.filter(b=>!e.includes(b)),p=d.filter(b=>!e.includes(b)),f=0,g=n;if(i){let b=0;for(let S of u)b+=S.getActualWidth();g-=b}if(g>0){for(let b=0;b<h.length;b++){let S=h[b];if(g-=S.getActualWidth(),g<0)break;f++}i&&f++}let m;if(f>0){let b=h[f-1];m=p.indexOf(b)+1}else m=p.indexOf(h[0]),m===-1&&(m=0);let v=[m],C=(b,S)=>b-S;if(i){let b=m+1,S=d.length-1;for(;b<=S;)v.push(b),b++;v.sort(C)}else{let b=m,S=d.length-1,x=d[b];for(;b<=S&&c.indexOf(x)<0;)b++,v.push(b),x=d[b];b=m-1;let E=0;for(;b>=E;)v.push(b),b--;v.sort(C).reverse()}return v}function uS(t){let{pinned:e,fromKeyboard:i,gos:n,ctrlsSvc:r,useHeaderRow:o,skipScrollPadding:s}=t,a=r.getHeaderRowContainerCtrl(e)?.eViewport,{x:l}=t;return a?(i&&(l-=a.getBoundingClientRect().left),n.get("enableRtl")&&(o&&(a=a.querySelector(".ag-header-row")),l=a.clientWidth-l),e==null&&!s&&(l+=r.get("center").getCenterViewportScrollLeft()),l):0}function Ty(t,e){for(let i of t)i.moving=e,i.dispatchColEvent("movingChanged","uiColumnMoved")}var HT=7,hS=100,em=hS/2,PQ=5,RQ=100,_Q=class extends H{constructor(t){super(),this.pinned=t,this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.isCenterContainer=!ae(t)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,t=>{this.gridBodyCon=t.gridBodyCtrl})}getIconName(){let{pinned:t,lastDraggingEvent:e}=this,{dragItem:i}=e||{},n=i?.columns??[];for(let r of n){let o=r.getPinned();if(r.getColDef().lockPinned){if(o==t)return"move";continue}let s=i?.containerType;if(s===t||!t)return"move";if(t&&(!o||s!==t))return"pinned"}return"notAllowed"}onDragEnter(t){let e=t.dragItem,i=e.columns;if(t.dragSource.type===0)this.setColumnsVisible(i,!0,"uiColumnDragged");else{let r=e.visibleState,o=(i||[]).filter(s=>r[s.getId()]&&!s.isVisible());this.setColumnsVisible(o,!0,"uiColumnDragged")}this.gos.get("suppressMoveWhenColumnDragging")||this.attemptToPinColumns(i,this.pinned),this.onDragging(t,!0,!0)}onDragging(t=this.lastDraggingEvent,e=!1,i=!1,n=!1){let{gos:r,ctrlsSvc:o}=this.beans,s=r.get("suppressMoveWhenColumnDragging");if(n&&!s){this.finishColumnMoving();return}if(this.lastDraggingEvent=t,!t||!n&&wt(t.hDirection))return;let a=uS({x:t.x,pinned:this.pinned,gos:r,ctrlsSvc:o});e||this.checkCenterForScrolling(a),s?this.handleColumnDragWhileSuppressingMovement(t,e,i,a,n):this.handleColumnDragWhileAllowingMovement(t,e,i,a,n)}onDragLeave(){this.ensureIntervalCleared(),this.clearHighlighted(),this.updateDragItemContainerType(),this.lastMovedInfo=null}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}onDragCancel(){this.clearHighlighted(),this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(t,e,i){if(!t?.length)return;let n=t.filter(r=>!r.getColDef().lockVisible);n.length&&this.beans.colModel.setColsVisible(n,e,i)}finishColumnMoving(){this.clearHighlighted();let t=this.lastMovedInfo;if(!t)return;let{columns:e,toIndex:i}=t;this.beans.colMoves.moveColumns(e,i,"uiColumnMoved",!0)}updateDragItemContainerType(){let{lastDraggingEvent:t}=this;if(this.gos.get("suppressMoveWhenColumnDragging")||!t)return;let e=t.dragItem;e&&(e.containerType=this.pinned)}handleColumnDragWhileSuppressingMovement(t,e,i,n,r){let o=this.getAllMovingColumns(t,!0);if(r){let s=this.isAttemptingToPin(o);s&&this.attemptToPinColumns(o,void 0,!0);let{fromLeft:a,xPosition:l}=this.getNormalisedXPositionInfo(o,s)||{};if(a==null||l==null){this.finishColumnMoving();return}this.moveColumnsAfterHighlight({allMovingColumns:o,xPosition:l,fromEnter:e,fakeEvent:i,fromLeft:a})}else{if(!this.beans.dragAndDrop.isDropZoneWithinThisGrid(t))return;this.highlightHoveredColumn(o,n)}}handleColumnDragWhileAllowingMovement(t,e,i,n,r){let o=this.getAllMovingColumns(t),s=this.normaliseDirection(t.hDirection)==="right",a=t.dragSource.type===1,l=this.getMoveColumnParams({allMovingColumns:o,isFromHeader:a,xPosition:n,fromLeft:s,fromEnter:e,fakeEvent:i}),c=m8(k(w({},l),{finished:r}));c&&(this.lastMovedInfo=c)}getAllMovingColumns(t,e=!1){let i=t.dragSource.getDragItem(),n=null;e?(n=i.columnsInSplit,n||(n=i.columns)):n=i.columns;let r=o=>o.getColDef().lockPinned?o.getPinned()==this.pinned:!0;return n?n.filter(r):[]}getMoveColumnParams(t){let{allMovingColumns:e,isFromHeader:i,xPosition:n,fromLeft:r,fromEnter:o,fakeEvent:s}=t,{gos:a,colModel:l,colMoves:c,visibleCols:d}=this.beans;return{allMovingColumns:e,isFromHeader:i,fromLeft:r,xPosition:n,pinned:this.pinned,fromEnter:o,fakeEvent:s,gos:a,colModel:l,colMoves:c,visibleCols:d}}highlightHoveredColumn(t,e){let{gos:i,colModel:n}=this.beans,r=i.get("enableRtl"),o=n.getCols().filter(d=>d.isVisible()&&d.getPinned()===this.pinned),s=null,a=null,l=null;for(let d of o){if(a=d.getActualWidth(),s=this.getNormalisedColumnLeft(d,0,r),s!=null){let u=s+a;if(s<=e&&u>=e){l=d;break}}s=null,a=null}if(l)t.indexOf(l)!==-1&&(l=null);else{for(let d=o.length-1;d>=0;d--){let u=o[d],h=o[d].getParent();if(!h){l=u;break}let p=h?.getDisplayedLeafColumns();if(p.length){l=dt(p);break}}if(!l)return;s=this.getNormalisedColumnLeft(l,0,r),a=l.getActualWidth()}if(this.lastHighlightedColumn?.column!==l&&this.clearHighlighted(),l==null||s==null||a==null)return;let c;e-s<a/2!==r?c=0:c=1,zT(l,c),this.lastHighlightedColumn={column:l,position:c}}getNormalisedXPositionInfo(t,e){let{gos:i,visibleCols:n}=this.beans,r=i.get("enableRtl"),{firstMovingCol:o,column:s,position:a}=this.getColumnMoveAndTargetInfo(t,e,r);if(!o||!s||a==null)return;let l=n.allCols,c=l.indexOf(o),d=l.indexOf(s),u=a===0!==r,h=c<d||c===d&&!u,p=0;if(u?h&&(p-=1):h||(p+=1),d+p===c)return;let f=l[d+p];if(!f)return;let g=this.getNormalisedColumnLeft(f,20,r);return{fromLeft:h,xPosition:g}}getColumnMoveAndTargetInfo(t,e,i){let n=this.lastHighlightedColumn||{},{firstMovingCol:r,lastMovingCol:o}=kQ(t);if(!r||!o||n.column||!e)return w({firstMovingCol:r},n);let a=this.getPinDirection()==="left";return{firstMovingCol:r,position:a?1:0,column:a!==i?r:o}}normaliseDirection(t){if(this.gos.get("enableRtl"))switch(t){case"left":return"right";case"right":return"left"}return t}getNormalisedColumnLeft(t,e,i){let{gos:n,ctrlsSvc:r}=this.beans,o=t.getLeft();if(o==null)return null;let s=t.getActualWidth();return uS({x:i?o+s-e:o+e,pinned:t.getPinned(),useHeaderRow:i,skipScrollPadding:!0,gos:n,ctrlsSvc:r})}isAttemptingToPin(t){let e=this.needToMoveLeft||this.needToMoveRight,i=this.failedMoveAttempts>HT;return e&&i||t.some(n=>n.getPinned()!==this.pinned)}moveColumnsAfterHighlight(t){let{allMovingColumns:e,xPosition:i,fromEnter:n,fakeEvent:r,fromLeft:o}=t,s=this.getMoveColumnParams({allMovingColumns:e,isFromHeader:!0,xPosition:i,fromLeft:o,fromEnter:n,fakeEvent:r}),{columns:a,toIndex:l}=g8(s)||{};a&&l!=null&&(this.lastMovedInfo={columns:a,toIndex:l}),this.finishColumnMoving()}clearHighlighted(){let{lastHighlightedColumn:t}=this;t&&(zT(t.column,null),this.lastHighlightedColumn=null)}checkCenterForScrolling(t){if(!this.isCenterContainer)return;let e=this.beans.ctrlsSvc.get("center"),i=e.getCenterViewportScrollLeft(),n=i+e.getCenterWidth(),r,o;this.gos.get("enableRtl")?(r=t<i+em,o=t>n-em):(o=t<i+em,r=t>n-em),this.needToMoveRight=r,this.needToMoveLeft=o,o||r?this.ensureIntervalStarted():this.ensureIntervalCleared()}ensureIntervalStarted(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),RQ),this.beans.dragAndDrop.setDragImageCompIcon(this.needToMoveLeft?"left":"right",!0))}ensureIntervalCleared(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.failedMoveAttempts=0,this.beans.dragAndDrop.setDragImageCompIcon(this.getIconName()))}moveInterval(){let t;this.intervalCount++,t=10+this.intervalCount*PQ,t>hS&&(t=hS);let e=null,i=this.gridBodyCon.scrollFeature;if(this.needToMoveLeft?e=i.scrollHorizontally(-t):this.needToMoveRight&&(e=i.scrollHorizontally(t)),e!==0)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;let{pinnedCols:n,dragAndDrop:r,gos:o}=this.beans;if(this.failedMoveAttempts<=HT+1||!n)return;if(r.setDragImageCompIcon("pinned"),!o.get("suppressMoveWhenColumnDragging")){let s=this.lastDraggingEvent?.dragItem.columns;this.attemptToPinColumns(s,void 0,!0)}}}getPinDirection(){if(this.needToMoveLeft||this.pinned==="left")return"left";if(this.needToMoveRight||this.pinned==="right")return"right"}attemptToPinColumns(t,e,i=!1){let n=(t||[]).filter(s=>!s.getColDef().lockPinned);if(!n.length)return 0;i&&(e=this.getPinDirection());let{pinnedCols:r,dragAndDrop:o}=this.beans;return r?.setColsPinned(n,e,"uiColumnDragged"),i&&o.nudge(),n.length}destroy(){super.destroy(),this.lastDraggingEvent=null,this.clearHighlighted(),this.lastMovedInfo=null}};function zT(t,e){t.highlighted!==e&&(t.highlighted=e,t.dispatchColEvent("headerHighlightChanged","uiColumnMoved"))}function kQ(t){let e=t.length,i,n;for(let r=0;r<e;r++){if(!i){let o=t[r];o.getLeft()!=null&&(i=o)}if(!n){let o=t[e-1-r];o.getLeft()!=null&&(n=o)}if(i&&n)break}return{firstMovingCol:i,lastMovingCol:n}}var FQ=class extends H{constructor(t,e){super(),this.pinned=t,this.eContainer=e}postConstruct(){let{ctrlsSvc:t,dragAndDrop:e}=this.beans,i=this.pinned;t.whenReady(this,n=>{let r,o=n.gridBodyCtrl.eBodyViewport;switch(i){case"left":r=[[o,n.left.eContainer],[n.bottomLeft.eContainer],[n.topLeft.eContainer]];break;case"right":r=[[o,n.right.eContainer],[n.bottomRight.eContainer],[n.topRight.eContainer]];break;default:r=[[o,n.center.eViewport],[n.bottomCenter.eViewport],[n.topCenter.eViewport]];break}this.eSecondaryContainers=r}),this.moveColumnFeature=this.createManagedBean(new _Q(i)),this.bodyDropPivotTarget=this.createManagedBean(new vQ(i)),e.addDropTarget(this),this.addDestroyFunc(()=>e.removeDropTarget(this))}isInterestedIn(t){return t===1||t===0&&this.gos.get("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(t){return this.beans.colModel.isPivotMode()&&t.dragSource.type===0}onDragEnter(t){this.currentDropListener=this.isDropColumnInPivotMode(t)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(t)}onDragLeave(t){this.currentDropListener.onDragLeave(t)}onDragging(t){this.currentDropListener.onDragging(t)}onDragStop(t){this.currentDropListener.onDragStop(t)}onDragCancel(){this.currentDropListener.onDragCancel()}},TQ=class extends H{constructor(){super(...arguments),this.beanName="colMoves"}moveColumnByIndex(t,e,i){let n=this.beans.colModel.getCols();if(!n)return;let r=n[t];this.moveColumns([r],e,i)}moveColumns(t,e,i,n=!0){let{colModel:r,colAnimation:o,visibleCols:s,eventSvc:a}=this.beans,l=r.getCols();if(!l)return;if(e>l.length-t.length){K(30,{toIndex:e});return}o?.start();let c=r.getColsForKeys(t);this.doesMovePassRules(c,e)&&(rT(r.getCols(),c,e),s.refresh(i),a.dispatchEvent({type:"columnMoved",columns:c,column:c.length===1?c[0]:null,toIndex:e,finished:n,source:i})),o?.finish()}doesMovePassRules(t,e){let i=this.getProposedColumnOrder(t,e);return this.doesOrderPassRules(i)}doesOrderPassRules(t){let{colModel:e,gos:i}=this.beans;return!(!lM(t,e.getColTree())||!(r=>{let o=c=>c?c==="left"||c===!0?-1:1:0,s=i.get("enableRtl"),a=s?1:-1,l=!0;for(let c of r){let d=o(c.getColDef().lockPosition);s?d>a&&(l=!1):d<a&&(l=!1),a=d}return l})(t))}getProposedColumnOrder(t,e){let n=this.beans.colModel.getCols().slice();return rT(n,t,e),n}createBodyDropTarget(t,e){return new FQ(t,e)}moveHeader(t,e,i,n,r){let{ctrlsSvc:o,gos:s,colModel:a,visibleCols:l,focusSvc:c}=this.beans,d=e.getBoundingClientRect(),u=d.left,h=Ot(i),p=h?d.width:i.getActualWidth(),f=t==="left"!==s.get("enableRtl"),g=uS({x:f?u-20:u+p+20,pinned:n,fromKeyboard:!0,gos:s,ctrlsSvc:o}),m=c.focusedHeader;m8({allMovingColumns:h?i.getLeafColumns():[i],isFromHeader:!0,fromLeft:t==="right",xPosition:g,pinned:n,fromEnter:!1,fakeEvent:!1,gos:s,colModel:a,colMoves:this,visibleCols:l,finished:!0});let v;if(h){let C=i.getDisplayedLeafColumns();v=f?C[0]:dt(C)}else v=i;if(o.getScrollFeature().ensureColumnVisible(v,"auto"),(!r.isAlive()||s.get("ensureDomOrder"))&&m){let C;if(h){let b=i.getGroupId(),S=i.getLeafColumns();if(!S.length)return;let x=S[0].getParent();if(!x)return;C=DQ(x,b)}else C=i;C&&c.focusHeaderPosition({headerPosition:k(w({},m),{column:C})})}}setDragSourceForHeader(t,e,i){let{gos:n,colModel:r,dragAndDrop:o,visibleCols:s}=this.beans,a=!n.get("suppressDragLeaveHidesColumns"),l=Ot(e),c=l?e.getProvidedColumnGroup().getLeafColumns():[e],u={type:1,eElement:t,getDefaultIconName:()=>a?"hide":"notAllowed",getDragItem:l?()=>IQ(e,s.allCols):()=>MQ(e),dragItemName:i,onDragStarted:()=>{a=!n.get("suppressDragLeaveHidesColumns"),Ty(c,!0)},onDragStopped:()=>Ty(c,!1),onDragCancelled:()=>Ty(c,!1),onGridEnter:h=>{if(a){let{columns:p=[],visibleState:f}=h??{},g=l?v=>!f||f[v.getColId()]:()=>!0,m=p.filter(v=>!v.getColDef().lockVisible&&g(v));r.setColsVisible(m,!0,"uiColumnMoved")}},onGridExit:h=>{if(a){let p=h?.columns?.filter(f=>!f.getColDef().lockVisible)||[];r.setColsVisible(p,!1,"uiColumnMoved")}}};return o.addDragSource(u,!0),u}};function DQ(t,e){for(;t;){if(t.getGroupId()===e)return t;t=t.getParent()}}function MQ(t){let e={};return e[t.getId()]=t.isVisible(),{columns:[t],visibleState:e,containerType:t.pinned}}function IQ(t,e){let i=t.getProvidedColumnGroup().getLeafColumns(),n={};for(let a of i)n[a.getId()]=a.isVisible();let r=[];for(let a of e)i.indexOf(a)>=0&&(r.push(a),er(i,a));for(let a of i)r.push(a);let o=[],s=t.getLeafColumns();for(let a of r)s.indexOf(a)!==-1&&o.push(a);return{columns:r,columnsInSplit:o,visibleState:n,containerType:o[0]?.pinned}}var AQ={moduleName:"ColumnMove",version:oe,beans:[TQ,fQ],apiFunctions:{moveColumnByIndex:gQ,moveColumns:mQ},dependsOn:[f8],css:[pQ]},OQ=class extends H{constructor(){super(...arguments),this.beanName="autoWidthCalc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,t=>{this.centerRowContainerCtrl=t.center})}getPreferredWidthForColumn(t,e){let i=this.getHeaderCellForColumn(t);if(!i)return-1;let n=this.beans.rowRenderer.getAllCellsNotSpanningForColumn(t);return e||n.push(i),this.getPreferredWidthForElements(n)}getPreferredWidthForColumnGroup(t){let e=this.getHeaderCellForColumn(t);return e?this.getPreferredWidthForElements([e]):-1}getPreferredWidthForElements(t,e){let i=document.createElement("form");i.style.position="fixed";let n=this.centerRowContainerCtrl.eContainer;for(let o of t)this.cloneItemIntoDummy(o,i);n.appendChild(i);let r=i.offsetWidth;return i.remove(),e=e??this.gos.get("autoSizePadding"),r+e}getHeaderCellForColumn(t){let e=null;for(let i of this.beans.ctrlsSvc.getHeaderRowContainerCtrls()){let n=i.getHtmlElementForColumnHeader(t);n!=null&&(e=n)}return e}cloneItemIntoDummy(t,e){let i=t.cloneNode(!0);i.style.width="",i.style.position="static",i.style.left="";let n=document.createElement("div"),r=n.classList;["ag-header-cell","ag-header-group-cell"].some(a=>i.classList.contains(a))?(r.add("ag-header","ag-header-row"),n.style.position="static"):r.add("ag-row");let s=t.parentElement;for(;s;){if(["ag-header-row","ag-row"].some(l=>s.classList.contains(l))){for(let l=0;l<s.classList.length;l++){let c=s.classList[l];c!="ag-row-position-absolute"&&r.add(c)}break}s=s.parentElement}n.appendChild(i),e.appendChild(n)}},v8={moduleName:"AutoWidth",version:oe,beans:[OQ]};function LQ(t,e,i=!0,n="api"){t.colResize?.setColumnWidths(e,!1,i,n)}var NQ=class extends H{constructor(t,e,i,n){super(),this.comp=t,this.eResize=e,this.pinned=i,this.columnGroup=n}postConstruct(){if(!this.columnGroup.isResizable()){this.comp.setResizableDisplayed(!1);return}let{horizontalResizeSvc:t,gos:e,colAutosize:i}=this.beans,n=t.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});this.addDestroyFunc(n),!e.get("suppressAutoSize")&&i&&this.addDestroyFunc(i.addColumnGroupResize(this.eResize,this.columnGroup,()=>this.resizeLeafColumnsToFit("uiColumnResized")))}onResizeStart(t){let{columnsToResize:e,resizeStartWidth:i,resizeRatios:n,groupAfterColumns:r,groupAfterStartWidth:o,groupAfterRatios:s}=this.getInitialValues(t);this.resizeCols=e,this.resizeStartWidth=i,this.resizeRatios=n,this.resizeTakeFromCols=r,this.resizeTakeFromStartWidth=o,this.resizeTakeFromRatios=s,this.toggleColumnResizing(!0)}onResizing(t,e,i="uiColumnResized"){let n=this.normaliseDragChange(e),r=this.resizeStartWidth+n;this.resizeColumnsFromLocalValues(r,i,t)}getInitialValues(t){let e=l=>l.reduce((c,d)=>c+d.getActualWidth(),0),i=(l,c)=>l.map(d=>d.getActualWidth()/c),n=this.getColumnsToResize(),r=e(n),o=i(n,r),s={columnsToResize:n,resizeStartWidth:r,resizeRatios:o},a=null;if(t&&(a=this.beans.colGroupSvc?.getGroupAtDirection(this.columnGroup,"After")??null),a){let l=a.getDisplayedLeafColumns(),c=s.groupAfterColumns=l.filter(u=>u.isResizable()),d=s.groupAfterStartWidth=e(c);s.groupAfterRatios=i(c,d)}else s.groupAfterColumns=void 0,s.groupAfterStartWidth=void 0,s.groupAfterRatios=void 0;return s}resizeLeafColumnsToFit(t){let e=this.beans.autoWidthCalc.getPreferredWidthForColumnGroup(this.columnGroup),i=this.getInitialValues();e>i.resizeStartWidth&&this.resizeColumns(i,e,t,!0)}resizeColumnsFromLocalValues(t,e,i=!0){if(!this.resizeCols||!this.resizeRatios)return;let n={columnsToResize:this.resizeCols,resizeStartWidth:this.resizeStartWidth,resizeRatios:this.resizeRatios,groupAfterColumns:this.resizeTakeFromCols,groupAfterStartWidth:this.resizeTakeFromStartWidth,groupAfterRatios:this.resizeTakeFromRatios};this.resizeColumns(n,t,e,i)}resizeColumns(t,e,i,n=!0){let{columnsToResize:r,resizeStartWidth:o,resizeRatios:s,groupAfterColumns:a,groupAfterStartWidth:l,groupAfterRatios:c}=t,d=[];if(d.push({columns:r,ratios:s,width:e}),a){let u=e-o;d.push({columns:a,ratios:c,width:l-u})}this.beans.colResize?.resizeColumnSets({resizeSets:d,finished:n,source:i}),n&&this.toggleColumnResizing(!1)}toggleColumnResizing(t){this.comp.toggleCss("ag-column-resizing",t)}getColumnsToResize(){return this.columnGroup.getDisplayedLeafColumns().filter(e=>e.isResizable())}normaliseDragChange(t){let e=t;return this.gos.get("enableRtl")?this.pinned!=="left"&&(e*=-1):this.pinned==="right"&&(e*=-1),e}destroy(){super.destroy(),this.resizeCols=void 0,this.resizeRatios=void 0,this.resizeTakeFromCols=void 0,this.resizeTakeFromRatios=void 0}},BQ=class extends H{constructor(t,e,i,n,r){super(),this.pinned=t,this.column=e,this.eResize=i,this.comp=n,this.ctrl=r}postConstruct(){let t=[],e,i,n=()=>{if(Ct(this.eResize,e),!e)return;let{horizontalResizeSvc:s,colAutosize:a}=this.beans,l=s.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});t.push(l),i&&a&&t.push(a.addColumnAutosizeListeners(this.eResize,this.column))},r=()=>{for(let s of t)s();t.length=0},o=()=>{let s=this.column.isResizable(),a=!this.gos.get("suppressAutoSize")&&!this.column.getColDef().suppressAutoSize;(s!==e||a!==i)&&(e=s,i=a,r(),n())};o(),this.addDestroyFunc(r),this.ctrl.setRefreshFunction("resize",o)}onResizing(t,e){let{column:i,lastResizeAmount:n,resizeStartWidth:r,beans:o}=this,s=this.normaliseResizeAmount(e),a=r+s,l=[{key:i,newWidth:a}],{pinnedCols:c,ctrlsSvc:d,colResize:u}=o;if(this.column.getPinned()){let h=c?.leftWidth??0,p=c?.rightWidth??0,f=ah(d.getGridBodyCtrl().eBodyViewport)-50;if(h+p+(s-n)>f)return}this.lastResizeAmount=s,u?.setColumnWidths(l,this.resizeWithShiftKey,t,"uiColumnResized"),t&&this.toggleColumnResizing(!1)}onResizeStart(t){this.resizeStartWidth=this.column.getActualWidth(),this.lastResizeAmount=0,this.resizeWithShiftKey=t,this.toggleColumnResizing(!0)}toggleColumnResizing(t){this.column.resizing=t,this.comp.toggleCss("ag-column-resizing",t)}normaliseResizeAmount(t){let e=t,i=this.pinned!=="left",n=this.pinned==="right";return this.gos.get("enableRtl")?i&&(e*=-1):n&&(e*=-1),e}},HQ=class extends H{constructor(){super(...arguments),this.beanName="colResize"}setColumnWidths(t,e,i,n){let r=[],{colModel:o,gos:s,visibleCols:a}=this.beans;for(let l of t){let c=o.getColDefCol(l.key)||o.getCol(l.key);if(!c)continue;if(r.push({width:l.newWidth,ratios:[1],columns:[c]}),s.get("colResizeDefault")==="shift"&&(e=!e),e){let u=a.getColAfter(c);if(!u)continue;let h=c.getActualWidth()-l.newWidth,p=u.getActualWidth()+h;r.push({width:p,ratios:[1],columns:[u]})}}r.length!==0&&this.resizeColumnSets({resizeSets:r,finished:i,source:n})}resizeColumnSets(t){let{resizeSets:e,finished:i,source:n}=t;if(!(!e||e.every(d=>zQ(d)))){if(i){let d=e&&e.length>0?e[0].columns:null;fc(this.eventSvc,d,i,n)}return}let o=[],s=[];for(let d of e){let{width:u,columns:h,ratios:p}=d,f={},g={};for(let C of h)s.push(C);let m=!0,v=0;for(;m;){if(v++,v>1e3){at(31);break}m=!1;let C=[],b=0,S=u;h.forEach((E,P)=>{if(g[E.getId()])S-=f[E.getId()];else{C.push(E);let B=p[P];b+=B}});let x=1/b;C.forEach((E,P)=>{let L=P===C.length-1,B;L?B=S:(B=Math.round(p[P]*u*x),S-=B);let j=E.getMinWidth(),q=E.getMaxWidth();B<j?(B=j,g[E.getId()]=!0,m=!0):q>0&&B>q&&(B=q,g[E.getId()]=!0,m=!0),f[E.getId()]=B})}for(let C of h){let b=f[C.getId()];C.getActualWidth()!==b&&(C.setActualWidth(b,n),o.push(C))}}let a=o.length>0,l=[];if(a){let{colFlex:d,visibleCols:u,colViewport:h}=this.beans;l=d?.refreshFlexedColumns({resizingCols:s,skipSetLeft:!0})??[],u.setLeftValues(n),u.updateBodyWidths(),h.checkViewportColumns()}let c=s.concat(l);(a||i)&&fc(this.eventSvc,c,i,n,l)}resizeHeader(t,e,i){if(!t.isResizable())return;let n=t.getActualWidth(),r=t.getMinWidth(),o=t.getMaxWidth(),s=Math.min(Math.max(n+e,r),o);this.setColumnWidths([{key:t,newWidth:s}],i,!0,"uiColumnResized")}createResizeFeature(t,e,i,n,r){return new BQ(t,e,i,n,r)}createGroupResizeFeature(t,e,i,n){return new NQ(t,e,i,n)}};function zQ(t){let{columns:e,width:i}=t,n=0,r=0,o=!0;for(let l of e){let c=l.getMinWidth();n+=c||0;let d=l.getMaxWidth();d>0?r+=d:o=!1}let s=i>=n,a=!o||i<=r;return s&&a}var VQ={moduleName:"ColumnResize",version:oe,beans:[HQ],apiFunctions:{setColumnWidths:LQ},dependsOn:[hQ,v8]},GQ=class extends H{constructor(t,e){super(),this.removeChildListenersFuncs=[],this.columnGroup=e,this.comp=t}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListeners(this.columnGroup,{displayedChildrenChanged:this.onDisplayedChildrenChanged.bind(this)}),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();let t=this.onWidthChanged.bind(this);for(let e of this.columnGroup.getLeafColumns())e.__addEventListener("widthChanged",t),e.__addEventListener("visibleChanged",t),this.removeChildListenersFuncs.push(()=>{e.__removeEventListener("widthChanged",t),e.__removeEventListener("visibleChanged",t)})}removeListenersOnChildrenColumns(){for(let t of this.removeChildListenersFuncs)t();this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){let t=this.columnGroup.getActualWidth();this.comp.setWidth(`${t}px`),this.comp.toggleCss("ag-hidden",t===0)}},WQ=class extends ZS{constructor(){super(...arguments),this.onSuppressColMoveChange=()=>{!this.isAlive()||this.isSuppressMoving()?this.removeDragSource():this.dragSource||this.setDragSource(this.eGui)}}wireComp(t,e,i,n,r){let{column:o,beans:s}=this,{context:a,colNames:l,colHover:c,rangeSvc:d,colResize:u}=s;this.comp=t,r=wh(this,a,r),this.setGui(e,r),this.displayName=l.getDisplayNameForColumnGroup(o,"header"),this.refreshHeaderStyles(),this.addClasses(),this.setupMovingCss(r),this.setupExpandable(r),this.setupTooltip(),this.setupAutoHeight({wrapperElement:n,compBean:r}),this.setupUserComp(),this.addHeaderMouseListeners(r),this.addManagedPropertyListener("groupHeaderHeight",this.refreshMaxHeaderHeight.bind(this)),this.refreshMaxHeaderHeight();let h=this.rowCtrl.pinned,p=o.getProvidedColumnGroup().getLeafColumns();c?.createHoverFeature(r,p,e),d?.createRangeHighlightFeature(r,o,t),r.createManagedBean(new QS(o,e,s)),r.createManagedBean(new GQ(t,o)),u?this.resizeFeature=r.createManagedBean(u.createGroupResizeFeature(t,i,h,o)):t.setResizableDisplayed(!1),r.createManagedBean(new bc(e,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)})),this.addHighlightListeners(r,p),r.addManagedPropertyListener("suppressMovableColumns",this.onSuppressColMoveChange),this.addResizeAndMoveKeyboardListeners(r),r.addDestroyFunc(()=>this.clearComponent())}getHeaderClassParams(){let{column:t,beans:e}=this,i=t.getDefinition();return Ee(e.gos,{colDef:i,columnGroup:t,floatingFilter:!1})}refreshMaxHeaderHeight(){let{gos:t,comp:e}=this,i=t.get("groupHeaderHeight");i!=null?i===0?e.setHeaderWrapperHidden(!0):e.setHeaderWrapperMaxHeight(i):(e.setHeaderWrapperHidden(!1),e.setHeaderWrapperMaxHeight(null))}addHighlightListeners(t,e){if(this.beans.gos.get("suppressMoveWhenColumnDragging"))for(let i of e)t.addManagedListeners(i,{headerHighlightChanged:this.onLeafColumnHighlightChanged.bind(this,i)})}onLeafColumnHighlightChanged(t){let e=this.column.getDisplayedLeafColumns(),i=e[0]===t,n=dt(e)===t;if(!i&&!n)return;let r=t.getHighlighted(),o=!!this.rowCtrl.getHeaderCellCtrls().find(l=>l.column.isMoving()),s=!1,a=!1;if(o){let l=this.beans.gos.get("enableRtl"),c=r===1,d=r===0;i&&(l?a=c:s=d),n&&(l?s=d:a=c)}this.comp.toggleCss("ag-header-highlight-before",s),this.comp.toggleCss("ag-header-highlight-after",a)}resizeHeader(t,e){let{resizeFeature:i}=this;if(!i)return;let n=i.getInitialValues(e);i.resizeColumns(n,n.resizeStartWidth+t,"uiColumnResized",!0)}resizeLeafColumnsToFit(t){this.resizeFeature?.resizeLeafColumnsToFit(t)}setupUserComp(){let{colGroupSvc:t,userCompFactory:e,gos:i,enterpriseMenuFactory:n}=this.beans,r=this.column,o=r.getProvidedColumnGroup(),s=Ee(i,{displayName:this.displayName,columnGroup:r,setExpanded:l=>{t.setColumnGroupOpened(o,l,"gridInitializing")},setTooltip:(l,c)=>{i.assertModuleRegistered("Tooltip",3),this.setupTooltip(l,c)},showColumnMenu:(l,c)=>n?.showMenuAfterButtonClick(o,l,"columnMenu",c),showColumnMenuAfterMouseClick:(l,c)=>n?.showMenuAfterMouseEvent(o,l,"columnMenu",c),eGridHeader:this.eGui}),a=I$(e,s);a&&this.comp.setUserCompDetails(a)}addHeaderMouseListeners(t){let e=r=>this.handleMouseOverChange(r.type==="mouseenter"),i=()=>this.dispatchColumnMouseEvent("columnHeaderClicked",this.column.getProvidedColumnGroup()),n=r=>this.handleContextMenuMouseEvent(r,void 0,this.column.getProvidedColumnGroup());t.addManagedListeners(this.eGui,{mouseenter:e,mouseleave:e,click:i,contextmenu:n})}handleMouseOverChange(t){this.eventSvc.dispatchEvent({type:t?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column.getProvidedColumnGroup()})}setupTooltip(t,e){this.tooltipFeature=this.beans.tooltipSvc?.setupHeaderGroupTooltip(this.tooltipFeature,this,t,e)}setupExpandable(t){let e=this.column.getProvidedColumnGroup();this.refreshExpanded();let i=this.refreshExpanded.bind(this);t.addManagedListeners(e,{expandedChanged:i,expandableChanged:i})}refreshExpanded(){let{column:t}=this;this.expandable=t.isExpandable();let e=t.isExpanded();this.expandable?this.comp.setAriaExpanded(e?"true":"false"):this.comp.setAriaExpanded(void 0),this.refreshHeaderStyles()}addClasses(){let{column:t}=this,e=t.getColGroupDef(),i=e8(e,this.gos,null,t);t.isPadding()?(i.push("ag-header-group-cell-no-group"),t.getLeafColumns().every(r=>r.isSpanHeaderHeight())&&i.push("ag-header-span-height")):(i.push("ag-header-group-cell-with-group"),e?.wrapHeaderText&&i.push("ag-header-cell-wrap-text"));for(let n of i)this.comp.toggleCss(n,!0)}setupMovingCss(t){let{column:e}=this,n=e.getProvidedColumnGroup().getLeafColumns(),r=()=>this.comp.toggleCss("ag-header-cell-moving",e.isMoving());for(let o of n)t.addManagedListeners(o,{movingChanged:r});r()}onFocusIn(t){this.eGui.contains(t.relatedTarget)||this.focusThis()}handleKeyDown(t){super.handleKeyDown(t);let e=this.getWrapperHasFocus();if(!(!this.expandable||!e)&&t.key===A.ENTER){let i=this.column,n=!i.isExpanded();this.beans.colGroupSvc.setColumnGroupOpened(i.getProvidedColumnGroup(),n,"uiColumnExpanded")}}setDragSource(t){!this.isAlive()||this.isSuppressMoving()||(this.removeDragSource(),t&&(this.dragSource=this.beans.colMoves?.setDragSourceForHeader(t,this.column,this.displayName)??null))}isSuppressMoving(){return this.gos.get("suppressMovableColumns")||this.column.getLeafColumns().some(t=>t.getColDef().suppressMovable||t.getColDef().lockPosition)}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function UQ(t,e,i){t.colGroupSvc?.setColumnGroupOpened(e,i,"api")}function jQ(t,e,i){return t.colGroupSvc?.getColumnGroup(e,i)??null}function qQ(t,e){return t.colGroupSvc?.getProvidedColGroup(e)??null}function $Q(t,e,i){return t.colNames.getDisplayNameForColumnGroup(e,i)||""}function KQ(t){return t.colGroupSvc?.getColumnGroupState()??[]}function YQ(t,e){t.colGroupSvc?.setColumnGroupState(e,"api")}function XQ(t){t.colGroupSvc?.resetColumnGroupState("api")}function JQ(t){return t.visibleCols.treeLeft}function QQ(t){return t.visibleCols.treeCenter}function ZQ(t){return t.visibleCols.treeRight}function eZ(t){return t.visibleCols.getAllTrees()}function tZ(t,e){for(let i=0;i<e.length;i++){let n=t.indexOf(e[i]);n>=0&&(t[n]=t[t.length-1],t.pop())}}var iZ=class extends H{constructor(){super(...arguments),this.beanName="visibleCols",this.colsAndGroupsMap={},this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.headerGroupRowCount=0,this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.isBodyWidthDirty=!0}refresh(t,e=!1){let{colFlex:i,colModel:n,colGroupSvc:r,colViewport:o,selectionColSvc:s}=this.beans;e||this.buildTrees(n,r),r?.updateOpenClosedVisibility(),this.leftCols=Dy(this.treeLeft),this.centerCols=Dy(this.treeCenter),this.rightCols=Dy(this.treeRight),s?.refreshVisibility(this.leftCols,this.centerCols,this.rightCols),this.joinColsAriaOrder(n),this.joinCols(),this.headerGroupRowCount=this.getHeaderRowCount(),this.setLeftValues(t),this.autoHeightCols=this.allCols.filter(a=>a.isAutoHeight()),i?.refreshFlexedColumns(),this.updateBodyWidths(),this.setFirstRightAndLastLeftPinned(n,this.leftCols,this.rightCols,t),o.checkViewportColumns(!1),this.eventSvc.dispatchEvent({type:"displayedColumnsChanged",source:t})}getHeaderRowCount(){if(!this.gos.get("hidePaddedHeaderRows"))return this.beans.colModel.cols.treeDepth;let t=0;for(let e of this.allCols){let i=e.getParent();for(;i;){if(!i.isPadding()){let n=i.getProvidedColumnGroup().getLevel()+1;n>t&&(t=n);break}i=i.getParent()}}return t}updateBodyWidths(){let t=mo(this.centerCols),e=mo(this.leftCols),i=mo(this.rightCols);this.isBodyWidthDirty=this.bodyWidth!==t,(this.bodyWidth!==t||this.leftWidth!==e||this.rightWidth!==i)&&(this.bodyWidth=t,this.leftWidth=e,this.rightWidth=i,this.eventSvc.dispatchEvent({type:"columnContainerWidthChanged"}),this.eventSvc.dispatchEvent({type:"displayedColumnsWidthChanged"}))}setLeftValues(t){this.setLeftValuesOfCols(t),this.setLeftValuesOfGroups()}setFirstRightAndLastLeftPinned(t,e,i,n){let r,o;this.gos.get("enableRtl")?(r=e?e[0]:null,o=i?dt(i):null):(r=e?dt(e):null,o=i?i[0]:null);for(let s of t.getCols())s.setLastLeftPinned(s===r,n),s.setFirstRightPinned(s===o,n)}buildTrees(t,e){let i=t.getColsToShow(),n=i.filter(l=>l.getPinned()=="left"),r=i.filter(l=>l.getPinned()=="right"),o=i.filter(l=>l.getPinned()!="left"&&l.getPinned()!="right"),s=new pM,a=l=>e?e.createColumnGroups(l):l.columns;this.treeLeft=a({columns:n,idCreator:s,pinned:"left",oldDisplayedGroups:this.treeLeft}),this.treeRight=a({columns:r,idCreator:s,pinned:"right",oldDisplayedGroups:this.treeRight}),this.treeCenter=a({columns:o,idCreator:s,pinned:null,oldDisplayedGroups:this.treeCenter}),this.updateColsAndGroupsMap()}clear(){this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.ariaOrderColumns=[]}joinColsAriaOrder(t){let e=t.getCols(),i=[],n=[],r=[];for(let o of e){let s=o.getPinned();s?s===!0||s==="left"?i.push(o):r.push(o):n.push(o)}this.ariaOrderColumns=i.concat(n).concat(r)}getAriaColIndex(t){let e;return Ot(t)?e=t.getLeafColumns()[0]:e=t,this.ariaOrderColumns.indexOf(e)+1}setLeftValuesOfGroups(){for(let t of[this.treeLeft,this.treeRight,this.treeCenter])for(let e of t)Ot(e)&&e.checkLeft()}setLeftValuesOfCols(t){let{colModel:e}=this.beans;if(!e.getColDefCols())return;let n=e.getCols().slice(0),r=this.gos.get("enableRtl");for(let o of[this.leftCols,this.rightCols,this.centerCols]){if(r){let s=mo(o);for(let a of o)s-=a.getActualWidth(),a.setLeft(s,t)}else{let s=0;for(let a of o)a.setLeft(s,t),s+=a.getActualWidth()}tZ(n,o)}for(let o of n)o.setLeft(null,t)}joinCols(){this.gos.get("enableRtl")?this.allCols=this.rightCols.concat(this.centerCols).concat(this.leftCols):this.allCols=this.leftCols.concat(this.centerCols).concat(this.rightCols)}getAllTrees(){return this.treeLeft&&this.treeRight&&this.treeCenter?this.treeLeft.concat(this.treeCenter).concat(this.treeRight):null}isColDisplayed(t){return this.allCols.indexOf(t)>=0}getLeftColsForRow(t){let{leftCols:e,beans:{colModel:i}}=this;return i.colSpanActive?this.getColsForRow(t,e):e}getRightColsForRow(t){let{rightCols:e,beans:{colModel:i}}=this;return i.colSpanActive?this.getColsForRow(t,e):e}getColsForRow(t,e,i,n){let r=[],o=null;for(let s=0;s<e.length;s++){let a=e[s],l=e.length-s,c=Math.min(a.getColSpan(t),l),d=[a];if(c>1){let h=c-1;for(let p=1;p<=h;p++)d.push(e[s+p]);s+=h}let u;if(i){u=!1;for(let h of d)i(h)&&(u=!0)}else u=!0;u&&(r.length===0&&o&&(n&&n(a))&&r.push(o),r.push(a)),o=a}return r}getContainerWidth(t){switch(t){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}getColBefore(t){let e=this.allCols,i=e.indexOf(t);return i>0?e[i-1]:null}isPinningLeft(){return this.leftCols.length>0}isPinningRight(){return this.rightCols.length>0}updateColsAndGroupsMap(){this.colsAndGroupsMap={};let t=e=>{this.colsAndGroupsMap[e.getUniqueId()]=e};_a(this.treeCenter,!1,t),_a(this.treeLeft,!1,t),_a(this.treeRight,!1,t)}isVisible(t){return this.colsAndGroupsMap[t.getUniqueId()]===t}getFirstColumn(){let t=this.gos.get("enableRtl"),e=["leftCols","centerCols","rightCols"];t&&e.reverse();for(let i=0;i<e.length;i++){let n=this[e[i]];if(n.length)return t?dt(n):n[0]}return null}getColAfter(t){let e=this.allCols,i=e.indexOf(t);return i<e.length-1?e[i+1]:null}getColsLeftWidth(){return mo(this.leftCols)}getDisplayedColumnsRightWidth(){return mo(this.rightCols)}isColAtEdge(t,e){let i=this.allCols;if(!i.length)return!1;let n=e==="first",r;if(Ot(t)){let o=t.getDisplayedLeafColumns();if(!o.length)return!1;r=n?o[0]:dt(o)}else r=t;return(n?i[0]:dt(i))===r}};function _a(t,e,i){if(t)for(let n=0;n<t.length;n++){let r=t[n];if(Ot(r)){let o=e?r.getDisplayedChildren():r.getChildren();_a(o,e,i)}i(r)}}function Dy(t){let e=[];return _a(t,!0,i=>{bs(i)&&e.push(i)}),e}var nZ=class extends H{constructor(){super(...arguments),this.beanName="colGroupSvc"}getColumnGroupState(){let t=[],e=this.beans.colModel.getColTree();return bo(null,e,i=>{Fi(i)&&t.push({groupId:i.getGroupId(),open:i.isExpanded()})}),t}resetColumnGroupState(t){let e=this.beans.colModel.getColDefColTree();if(!e)return;let i=[];bo(null,e,n=>{if(Fi(n)){let r=n.getColGroupDef(),o={groupId:n.getGroupId(),open:r?r.openByDefault:void 0};i.push(o)}}),this.setColumnGroupState(i,t)}setColumnGroupState(t,e){let{colModel:i,colAnimation:n,visibleCols:r,eventSvc:o}=this.beans;if(!i.getColTree().length)return;n?.start();let a=[];for(let l of t){let c=l.groupId,d=l.open,u=this.getProvidedColGroup(c);u&&u.isExpanded()!==d&&(u.setExpanded(d),a.push(u))}r.refresh(e,!0),a.length&&o.dispatchEvent({type:"columnGroupOpened",columnGroup:a.length===1?a[0]:void 0,columnGroups:a}),n?.finish()}setColumnGroupOpened(t,e,i){let n;Fi(t)?n=t.getId():n=t||"",this.setColumnGroupState([{groupId:n,open:e}],i)}getProvidedColGroup(t){let e=null;return bo(null,this.beans.colModel.getColTree(),i=>{Fi(i)&&i.getId()===t&&(e=i)}),e}getGroupAtDirection(t,e){let i=t.getProvidedColumnGroup().getLevel()+t.getPaddingLevel(),n=t.getDisplayedLeafColumns(),r=e==="After"?dt(n):n[0],o=`getCol${e}`;for(;;){let s=this.beans.visibleCols[o](r);if(!s)return null;let a=this.getColGroupAtLevel(s,i);if(a!==t)return a}}getColGroupAtLevel(t,e){let i=t.getParent(),n,r;for(;n=i.getProvidedColumnGroup().getLevel(),r=i.getPaddingLevel(),!(n+r<=e);)i=i.getParent();return i}updateOpenClosedVisibility(){let t=this.beans.visibleCols.getAllTrees();_a(t,!1,e=>{Ot(e)&&e.calculateDisplayedColumns()})}getColumnGroup(t,e){if(!t)return null;if(Ot(t))return t;let i=this.beans.visibleCols.getAllTrees(),n=typeof e=="number",r=null;return _a(i,!1,o=>{if(Ot(o)){let s=o,a;n?a=t===s.getGroupId()&&e===s.getPartId():a=t===s.getGroupId(),a&&(r=s)}}),r}createColumnGroups(t){let{columns:e,idCreator:i,pinned:n,oldDisplayedGroups:r,isStandaloneStructure:o}=t,s=this.mapOldGroupsById(r),a=[],l=e;for(;l.length;){let c=l;l=[];let d=0,u=h=>{let p=d;d=h;let f=c[p],m=(Ot(f)?f.getProvidedColumnGroup():f).getOriginalParent();if(m==null){for(let C=p;C<h;C++)a.push(c[C]);return}let v=this.createColumnGroup(m,i,s,n,o);for(let C=p;C<h;C++)v.addChild(c[C]);l.push(v)};for(let h=1;h<c.length;h++){let p=c[h],g=(Ot(p)?p.getProvidedColumnGroup():p).getOriginalParent(),m=c[d],C=(Ot(m)?m.getProvidedColumnGroup():m).getOriginalParent();g!==C&&u(h)}d<c.length&&u(c.length)}return o||this.setupParentsIntoCols(a,null),a}createProvidedColumnGroup(t,e,i,n,r,o,s){let a=r.getUniqueKey(e.groupId||null,null),l=nT(this.beans,e,a),c=new sm(l,a,!1,i);this.createBean(c);let d=this.findExistingGroup(e,o);d&&o.splice(d.idx,1);let u=d?.group;u&&c.setExpanded(u.isExpanded());let h=oM(this.beans,l.children,i+1,t,n,r,o,s);return c.setChildren(h),c}balanceColumnTree(t,e,i,n){let r=[];for(let o=0;o<t.length;o++){let s=t[o];if(Fi(s)){let a=s,l=this.balanceColumnTree(a.getChildren(),e+1,i,n);a.setChildren(l),r.push(a)}else{let a,l;for(let c=e;c<i;c++){let d=n.getUniqueKey(null,null),u=nT(this.beans,null,d),h=new sm(u,d,!0,c);this.createBean(h),l&&l.setChildren([h]),l=h,a||(a=l)}if(a&&l)if(r.push(a),t.some(d=>Fi(d))){l.setChildren([s]);continue}else{l.setChildren(t);break}r.push(s)}}return r}findDepth(t){let e=0,i=t;for(;i?.[0]&&Fi(i[0]);)e++,i=i[0].getChildren();return e}findMaxDepth(t,e){let i=e;for(let n=0;n<t.length;n++){let r=t[n];if(Fi(r)){let o=r,s=this.findMaxDepth(o.getChildren(),e+1);i<s&&(i=s)}}return i}balanceTreeForAutoCols(t,e){let i=[];for(let n of t){let r=n;for(let o=e-1;o>=0;o--){let s=new sm(null,`FAKE_PATH_${n.getId()}}_${o}`,!0,o);this.createBean(s),s.setChildren([r]),r.originalParent=s,r=s}e===0&&(n.originalParent=null),i.push(r)}return i}findExistingGroup(t,e){if(t.groupId!=null)for(let n=0;n<e.length;n++){let r=e[n];if(r.getColGroupDef()&&r.getId()===t.groupId)return{idx:n,group:r}}}createColumnGroup(t,e,i,n,r){let o=t.getGroupId(),s=e.getInstanceIdForKey(o),a=BM(o,s),l=i[a];return l&&l.getProvidedColumnGroup()!==t&&(l=null),ae(l)?l.reset():(l=new ph(t,o,s,n),r||this.createBean(l)),l}mapOldGroupsById(t){let e={},i=n=>{for(let r of n)if(Ot(r)){let o=r;e[r.getUniqueId()]=o,i(o.getChildren())}};return t&&i(t),e}setupParentsIntoCols(t,e){for(let i of t??[])if(i.parent!==e&&(this.beans.colViewport.colsWithinViewportHash=""),i.parent=e,Ot(i)){let n=i;this.setupParentsIntoCols(n.getChildren(),n)}}},rZ={moduleName:"ColumnGroup",version:oe,dynamicBeans:{headerGroupCellCtrl:WQ},beans:[nZ],apiFunctions:{getAllDisplayedColumnGroups:eZ,getCenterDisplayedColumnGroups:QQ,getColumnGroup:jQ,getColumnGroupState:KQ,getDisplayNameForColumnGroup:$Q,getLeftDisplayedColumnGroups:JQ,getProvidedColumnGroup:qQ,getRightDisplayedColumnGroups:ZQ,resetColumnGroupState:XQ,setColumnGroupOpened:UQ,setColumnGroupState:YQ}},oZ={tag:"div",cls:"ag-skeleton-container"},sZ=class extends et{constructor(){super(oZ)}init(t){let e=`ag-cell-skeleton-renderer-${this.getCompId()}`;this.getGui().setAttribute("id",e),this.addDestroyFunc(()=>oh(t.eParentOfValue)),oh(t.eParentOfValue,e),t.deferRender?this.setupLoading(t):t.node.failedLoad?this.setupFailed():this.setupLoading(t)}setupFailed(){let t=this.getLocaleTextFunc();this.getGui().textContent=t("loadingError","ERR");let e=t("ariaSkeletonCellLoadingFailed","Row failed to load");hc(this.getGui(),e)}setupLoading(t){let e=Nt({tag:"div",cls:"ag-skeleton-effect"}),i=t.node.rowIndex;if(i!=null){let o=75+25*(i%2===0?Math.sin(i):Math.cos(i));e.style.width=`${o}%`}this.getGui().appendChild(e);let n=this.getLocaleTextFunc(),r=t.deferRender?n("ariaDeferSkeletonCellLoading","Cell is loading"):n("ariaSkeletonCellLoading","Row data is loading");hc(this.getGui(),r)}refresh(t){return!1}},aZ={moduleName:"CheckboxCellRenderer",version:oe,userComponents:{agCheckboxCellRenderer:UX}},lZ={moduleName:"SkeletonCellRenderer",version:oe,userComponents:{agSkeletonCellRenderer:sZ}};function cZ(t,e){let i=t.colModel.getColDefCol(e);return i?i.getColDef():null}function dZ(t){return t.colModel.getColumnDefs(!0)}function uZ(t,e,i){return t.colNames.getDisplayNameForColumn(e,i)||""}function hZ(t,e){return t.colModel.getColDefCol(e)}function pZ(t){return t.colModel.getColDefCols()}function fZ(t,e){return Zn(t,e,"api")}function gZ(t){return Rm(t)}function mZ(t){r$(t,"api")}function vZ(t){return t.visibleCols.isPinningLeft()||t.visibleCols.isPinningRight()}function CZ(t){return t.visibleCols.isPinningLeft()}function wZ(t){return t.visibleCols.isPinningRight()}function bZ(t,e){return t.visibleCols.getColAfter(e)}function yZ(t,e){return t.visibleCols.getColBefore(e)}function SZ(t,e,i){t.colModel.setColsVisible(e,i,"api")}function xZ(t,e,i){t.pinnedCols?.setColsPinned(e,i,"api")}function EZ(t){return t.colModel.getCols()}function PZ(t){return t.visibleCols.leftCols}function RZ(t){return t.visibleCols.centerCols}function _Z(t){return t.visibleCols.rightCols}function kZ(t){return t.visibleCols.allCols}function FZ(t){return t.colViewport.getViewportColumns()}function pS(t,e){if(!t)return;let i=t,n={};for(let r of Object.keys(i)){if(e&&e.indexOf(r)>=0||AD.has(r))continue;let o=i[r];typeof o=="object"&&o!==null&&o.constructor===Object?n[r]=pS(o):n[r]=o}return n}var TZ=class extends H{constructor(){super(...arguments),this.beanName="colDefFactory"}wireBeans(t){this.rowGroupColsSvc=t.rowGroupColsSvc,this.pivotColsSvc=t.pivotColsSvc}getColumnDefs(t,e,i,n,r=!1){let o=t.slice();e?o.sort((l,c)=>i.indexOf(l)-i.indexOf(c)):(i||r)&&o.sort((l,c)=>n.indexOf(l)-n.indexOf(c));let s=this.rowGroupColsSvc?.columns,a=this.pivotColsSvc?.columns;return this.buildColumnDefs(o,s,a)}buildColumnDefs(t,e=[],i=[]){let n=[],r={};for(let o of t){let s=this.createDefFromColumn(o,e,i),a=!0,l=s,c=o.getOriginalParent(),d=null;for(;c;){let u=null;if(c.isPadding()){c=c.getOriginalParent();continue}let h=r[c.getGroupId()];if(h){h.children.push(l),a=!1;break}if(u=this.createDefFromGroup(c),u&&(u.children=[l],r[u.groupId]=u,l=u,c=c.getOriginalParent()),c!=null&&d===c){a=!1;break}d=c}a&&n.push(l)}return n}createDefFromGroup(t){let e=pS(t.getColGroupDef(),["children"]);return e&&(e.groupId=t.getGroupId()),e}createDefFromColumn(t,e,i){let n=pS(t.getColDef());return n.colId=t.getColId(),n.width=t.getActualWidth(),n.rowGroup=t.isRowGroupActive(),n.rowGroupIndex=t.isRowGroupActive()?e.indexOf(t):null,n.pivot=t.isPivotActive(),n.pivotIndex=t.isPivotActive()?i.indexOf(t):null,n.aggFunc=t.isValueActive()?t.getAggFunc():null,n.hide=t.isVisible()?void 0:!0,n.pinned=t.isPinned()?t.getPinned():null,n.sort=t.getSort()?t.getSort():null,n.sortIndex=t.getSortIndex()!=null?t.getSortIndex():null,n}},DZ=class extends H{constructor(){super(...arguments),this.beanName="colFlex",this.columnsHidden=!1}refreshFlexedColumns(t={}){let e=t.source??"flex";t.viewportWidth!=null&&(this.flexViewportWidth=t.viewportWidth);let i=this.flexViewportWidth,{visibleCols:n,colDelayRenderSvc:r}=this.beans,o=n.centerCols,s=-1;if(t.resizingCols){let g=new Set(t.resizingCols);for(let m=o.length-1;m>=0;m--)if(g.has(o[m])){s=m;break}}let a=!1,l=o.map((g,m)=>{let v=g.getFlex(),C=v!=null&&v>0&&m>s;return a||(a=C),{col:g,isFlex:C,flex:Math.max(0,v??0),initialSize:g.getActualWidth(),min:g.getMinWidth(),max:g.getMaxWidth(),targetSize:0}});if(a?(r?.hideColumns("colFlex"),this.columnsHidden=!0):this.columnsHidden&&this.revealColumns(r),!i||!a)return[];let c=l.length,d=l.reduce((g,m)=>g+m.flex,0),u=i,h=(g,m)=>{g.frozenSize=m,g.col.setActualWidth(m,e),u-=m,d-=g.flex,c-=1},p=g=>g.frozenSize!=null;for(let g of l)g.isFlex||h(g,g.initialSize);for(;c>0;){let g=Math.round(d<1?u*d:u),m,v=0,C=0;for(let x of l){if(p(x))continue;m=x,C+=g*(x.flex/d);let E=C-v,P=Math.round(E);x.targetSize=P,v+=P}m&&(m.targetSize+=g-v);let b=0;for(let x of l){if(p(x))continue;let E=x.targetSize,P=Math.min(Math.max(E,x.min),x.max);b+=P-E,x.violationType=P===E?void 0:P<E?"max":"min",x.targetSize=P}let S=b===0?"all":b>0?"min":"max";for(let x of l)p(x)||(S==="all"||x.violationType===S)&&h(x,x.targetSize)}t.skipSetLeft||n.setLeftValues(e),t.updateBodyWidths&&n.updateBodyWidths();let f=l.filter(g=>g.isFlex&&!g.violationType).map(g=>g.col);if(t.fireResizedEvent){let g=l.filter(v=>v.initialSize!==v.frozenSize).map(v=>v.col),m=l.filter(v=>v.flex).map(v=>v.col);fc(this.eventSvc,g,!0,e,m)}return this.revealColumns(r),f}revealColumns(t){this.columnsHidden&&(t?.revealColumns("colFlex"),this.columnsHidden=!1)}initCol(t){let{flex:e,initialFlex:i}=t.colDef;e!==void 0?t.flex=e:i!==void 0&&(t.flex=i)}setColFlex(t,e){t.flex=e??null,t.dispatchStateUpdatedEvent("flex")}};function th(t,e,i){if(!e||!t)return;if(!i)return t[e];let n=e.split("."),r=t;for(let o=0;o<n.length;o++){if(r==null)return;r=r[n[o]]}return r}var MZ=["dateTimeString","dateString","text","number","boolean","date"],IZ=class extends H{constructor(){super(...arguments),this.beanName="dataTypeSvc",this.dataTypeDefinitions={},this.isPendingInference=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[],this.columnDefinitionPropsPerDataType={number(){return{cellEditor:"agNumberCellEditor"}},boolean(){return{cellEditor:"agCheckboxCellEditor",cellRenderer:"agCheckboxCellRenderer",getFindText:()=>null,suppressKeyboardEvent:t=>!!t.colDef.editable&&t.event.key===A.SPACE}},date({formatValue:t}){return{cellEditor:"agDateCellEditor",keyCreator:t}},dateString({formatValue:t}){return{cellEditor:"agDateStringCellEditor",keyCreator:t}},dateTime(t){return this.date(t)},dateTimeString(t){return this.dateString(t)},object({formatValue:t,colModel:e,colId:i}){return{cellEditorParams:{useFormatter:!0},comparator:(n,r)=>{let o=e.getColDefCol(i),s=o?.getColDef();if(!o||!s)return 0;let a=n==null?"":t({column:o,node:null,value:n}),l=r==null?"":t({column:o,node:null,value:r});return a===l?0:a>l?1:-1},keyCreator:t}},text(){return{}}}}wireBeans(t){this.colModel=t.colModel}postConstruct(){this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",t=>{this.processDataTypeDefinitions(),this.colModel.recreateColumnDefs(t)})}processDataTypeDefinitions(){let t=this.getDefaultDataTypes(),e={},i={},n=d=>u=>{let{column:h,node:p,value:f}=u,g=h.getColDef().valueFormatter;return g===d.groupSafeValueFormatter&&(g=d.valueFormatter),this.beans.valueSvc.formatValue(h,p,f,g)};for(let d of Object.keys(t)){let u=t[d],h=k(w({},u),{groupSafeValueFormatter:WT(u,this.gos)});e[d]=h,i[d]=n(h)}let r=this.gos.get("dataTypeDefinitions")??{},o={};for(let d of Object.keys(r)){let u=r[d],h=this.processDataTypeDefinition(u,r,[d],t);h&&(e[d]=h,u.dataTypeMatcher&&(o[d]=u.dataTypeMatcher),i[d]=n(h))}let{valueParser:s,valueFormatter:a}=t.object,{valueParser:l,valueFormatter:c}=e.object;this.hasObjectValueParser=l!==s,this.hasObjectValueFormatter=c!==a,this.formatValueFuncs=i,this.dataTypeDefinitions=e,this.dataTypeMatchers=this.sortKeysInMatchers(o,t)}sortKeysInMatchers(t,e){let i=w({},t);for(let n of MZ)delete i[n],i[n]=t[n]??e[n].dataTypeMatcher;return i}processDataTypeDefinition(t,e,i,n){let r,o=t.extendsDataType;if(t.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),t.extendsDataType===t.baseDataType){let s=n[o],a=e[o];if(s&&a&&(s=a),!GT(t,s,o))return;r=VT(s,t)}else{if(i.includes(o)){K(44);return}let s=e[o];if(!GT(t,s,o))return;let a=this.processDataTypeDefinition(s,e,[...i,o],n);if(!a)return;r=VT(a,t)}return k(w({},r),{groupSafeValueFormatter:WT(r,this.gos)})}updateColDefAndGetColumnType(t,e,i){let{cellDataType:n}=e,{field:r}=e;if(n===void 0&&(n=t.cellDataType),(n==null||n===!0)&&(n=this.canInferCellDataType(t,e)?this.inferCellDataType(r,i):!1),!n){t.cellDataType=!1;return}let o=this.dataTypeDefinitions[n];if(!o){K(47,{cellDataType:n});return}return t.cellDataType=n,o.groupSafeValueFormatter&&(t.valueFormatter=o.groupSafeValueFormatter),o.valueParser&&(t.valueParser=o.valueParser),o.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(t,n,o,i),o.columnTypes}addColumnListeners(t){if(!this.isPendingInference)return;let e=this.columnStateUpdatesPendingInference[t.getColId()];if(!e)return;let i=n=>{e.add(n.key)};t.__addEventListener("columnStateUpdated",i),this.columnStateUpdateListenerDestroyFuncs.push(()=>t.__removeEventListener("columnStateUpdated",i))}canInferCellDataType(t,e){let{gos:i}=this;if(!Lt(i))return!1;let n={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(My(e,n))return!1;let r=e.type===null?t.type:e.type;if(r){let o=i.get("columnTypes")??{};if(Pm(r).some(a=>{let l=o[a.trim()];return l&&My(l,n)}))return!1}return!My(t,n)}inferCellDataType(t,e){if(!t)return;let i,n=this.getInitialData();if(n){let o=t.includes(".")&&!this.gos.get("suppressFieldDotNotation");i=th(n,t,o)}else this.initWaitForRowData(e);return i==null?void 0:Object.keys(this.dataTypeMatchers).find(o=>this.dataTypeMatchers[o](i))??"object"}getInitialData(){let t=this.gos.get("rowData");if(t?.length)return t[0];if(this.initialData)return this.initialData;{let e=this.beans.rowModel.rootNode?._leafs;if(e?.length)return e[0].data}return null}initWaitForRowData(t){if(this.columnStateUpdatesPendingInference[t]=new Set,this.isPendingInference)return;this.isPendingInference=!0;let e=this.isColumnTypeOverrideInDataTypeDefinitions,{colAutosize:i,eventSvc:n}=this.beans;e&&i&&(i.shouldQueueResizeOperations=!0);let[r]=this.addManagedEventListeners({rowDataUpdateStarted:o=>{let{firstRowData:s}=o;s&&(r?.(),this.isPendingInference=!1,this.processColumnsPendingInference(s,e),this.columnStateUpdatesPendingInference={},e&&i?.processResizeOperations(),n.dispatchEvent({type:"dataTypesInferred"}))}})}processColumnsPendingInference(t,e){this.initialData=t;let i=[];this.destroyColumnStateUpdateListeners();let n={},r={};for(let o of Object.keys(this.columnStateUpdatesPendingInference)){let s=this.columnStateUpdatesPendingInference[o],a=this.colModel.getCol(o);if(!a)return;let l=a.getColDef();if(!this.resetColDefIntoCol(a,"cellDataTypeInferred"))return;let c=a.getColDef();if(e&&c.type&&c.type!==l.type){let d=OZ(a,s);d.rowGroup&&d.rowGroupIndex==null&&(n[o]=d),d.pivot&&d.pivotIndex==null&&(r[o]=d),i.push(d)}}e&&i.push(...this.generateColumnStateForRowGroupAndPivotIndexes(n,r)),i.length&&Zn(this.beans,{state:i},"cellDataTypeInferred"),this.initialData=null}generateColumnStateForRowGroupAndPivotIndexes(t,e){let i={},{rowGroupColsSvc:n,pivotColsSvc:r}=this.beans;return n?.restoreColumnOrder(i,t),r?.restoreColumnOrder(i,e),Object.values(i)}resetColDefIntoCol(t,e){let i=t.getUserProvidedColDef();if(!i)return!1;let n=Yy(this.beans,i,t.getColId());return t.setColDef(n,i,e),!0}getDateStringTypeDefinition(t){let{dateString:e}=this.dataTypeDefinitions;return t?this.getDataTypeDefinition(t)??e:e}getDateParserFunction(t){return this.getDateStringTypeDefinition(t).dateParser}getDateFormatterFunction(t){return this.getDateStringTypeDefinition(t).dateFormatter}getDateIncludesTimeFlag(t){return t==="dateTime"||t==="dateTimeString"}getDataTypeDefinition(t){let e=t.getColDef();if(e.cellDataType)return this.dataTypeDefinitions[e.cellDataType]}getBaseDataType(t){return this.getDataTypeDefinition(t)?.baseDataType}checkType(t,e){if(e==null)return!0;let i=this.getDataTypeDefinition(t)?.dataTypeMatcher;return i?i(e):!0}validateColDef(t){let e=i=>K(48,{property:i});if(t.cellDataType==="object"){let{object:i}=this.dataTypeDefinitions;t.valueFormatter===i.groupSafeValueFormatter&&!this.hasObjectValueFormatter&&e("Formatter"),t.editable&&t.valueParser===i.valueParser&&!this.hasObjectValueParser&&e("Parser")}}postProcess(t){let e=t.cellDataType;if(!e||typeof e!="string")return;let{dataTypeDefinitions:i,beans:n,formatValueFuncs:r}=this,o=i[e];o&&n.colFilter?.setColDefPropsForDataType(t,o,r[e])}getFormatValue(t){return this.formatValueFuncs[t]}isColPendingInference(t){return this.isPendingInference&&!!this.columnStateUpdatesPendingInference[t]}setColDefPropertiesForBaseDataType(t,e,i,n){let r=this.formatValueFuncs[e],o=this.columnDefinitionPropsPerDataType[i.baseDataType]({colDef:t,cellDataType:e,colModel:this.colModel,dataTypeDefinition:i,colId:n,formatValue:r});Object.assign(t,o)}getDateObjectTypeDef(t){let e=this.getLocaleTextFunc(),i=this.getDateIncludesTimeFlag(t);return{baseDataType:t,valueParser:n=>Ji(n.newValue&&String(n.newValue)),valueFormatter:n=>n.value==null?"":!(n.value instanceof Date)||isNaN(n.value.getTime())?e("invalidDate","Invalid Date"):un(n.value,i)??"",dataTypeMatcher:n=>n instanceof Date}}getDateStringTypeDef(t){let e=this.getDateIncludesTimeFlag(t);return{baseDataType:t,dateParser:i=>Ji(i)??void 0,dateFormatter:i=>un(i??null,e)??void 0,valueParser:i=>am(String(i.newValue))?i.newValue:null,valueFormatter:i=>am(String(i.value))?String(i.value):"",dataTypeMatcher:i=>typeof i=="string"&&am(i)}}getDefaultDataTypes(){let t=this.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:e=>e.newValue?.trim?.()===""?null:Number(e.newValue),valueFormatter:e=>e.value==null?"":typeof e.value!="number"||isNaN(e.value)?t("invalidNumber","Invalid Number"):String(e.value),dataTypeMatcher:e=>typeof e=="number"},text:{baseDataType:"text",valueParser:e=>e.newValue===""?null:Vy(e.newValue),dataTypeMatcher:e=>typeof e=="string"},boolean:{baseDataType:"boolean",valueParser:e=>e.newValue==null?e.newValue:e.newValue?.trim?.()===""?null:String(e.newValue).toLowerCase()==="true",valueFormatter:e=>e.value==null?"":String(e.value),dataTypeMatcher:e=>typeof e=="boolean"},date:this.getDateObjectTypeDef("date"),dateString:this.getDateStringTypeDef("dateString"),dateTime:this.getDateObjectTypeDef("dateTime"),dateTimeString:k(w({},this.getDateStringTypeDef("dateTimeString")),{dataTypeMatcher:e=>typeof e=="string"&&X$(e)}),object:{baseDataType:"object",valueParser:()=>null,valueFormatter:e=>Vy(e.value)??""}}}destroyColumnStateUpdateListeners(){for(let t of this.columnStateUpdateListenerDestroyFuncs)t();this.columnStateUpdateListenerDestroyFuncs=[]}destroy(){this.dataTypeDefinitions={},this.dataTypeMatchers={},this.formatValueFuncs={},this.columnStateUpdatesPendingInference={},this.destroyColumnStateUpdateListeners(),super.destroy()}};function VT(t,e){let i=w(w({},t),e);return t.columnTypes&&e.columnTypes&&e.appendColumnTypes&&(i.columnTypes=[...Pm(t.columnTypes),...Pm(e.columnTypes)]),i}function GT(t,e,i){return e?e.baseDataType!==t.baseDataType?(K(46),!1):!0:(K(45,{parentCellDataType:i}),!1)}function WT(t,e){if(t.valueFormatter)return i=>{if(i.node?.group){let n=(i.colDef.pivotValueColumn??i.column).getAggFunc();if(n){if(n==="first"||n==="last")return t.valueFormatter(i);if(t.baseDataType==="number"&&n!=="count"){if(typeof i.value=="number")return t.valueFormatter(i);if(typeof i.value=="object"){if(!i.value)return;if("toNumber"in i.value)return t.valueFormatter(k(w({},i),{value:i.value.toNumber()}));if("value"in i.value)return t.valueFormatter(k(w({},i),{value:i.value.value}))}}return}}else if(e.get("groupHideOpenParents")&&i.column.isRowGroupActive()&&typeof i.value=="string"&&!t.dataTypeMatcher?.(i.value))return;return t.valueFormatter(i)}}function AZ(t,e,i,n){if(!e[i])return!1;let r=t[i];return r===null?(e[i]=!1,!1):n===void 0?!!r:r===n}function My(t,e){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some(([i,n])=>AZ(t,e,i,n))}function OZ(t,e){let i=hM(t);for(let n of e)delete i[n],n==="rowGroup"?delete i.rowGroupIndex:n==="pivot"&&delete i.pivotIndex;return i}var LZ={moduleName:"DataType",version:oe,beans:[IZ],dependsOn:[aZ]},NZ={moduleName:"ColumnFlex",version:oe,beans:[DZ]},C8={moduleName:"ColumnApi",version:oe,beans:[TZ],apiFunctions:{getColumnDef:cZ,getDisplayNameForColumn:uZ,getColumn:hZ,getColumns:pZ,applyColumnState:fZ,getColumnState:gZ,resetColumnState:mZ,isPinning:vZ,isPinningLeft:CZ,isPinningRight:wZ,getDisplayedColAfter:bZ,getDisplayedColBefore:yZ,setColumnsVisible:SZ,setColumnsPinned:xZ,getAllGridColumns:EZ,getDisplayedLeftColumns:PZ,getDisplayedCenterColumns:RZ,getDisplayedRightColumns:_Z,getAllDisplayedColumns:kZ,getAllDisplayedVirtualColumns:FZ,getColumnDefs:dZ}};function BZ(t){if(!t||t==null)return null;let e=/([a-z])([A-Z])/g,i=/([A-Z]+)([A-Z])([a-z])/g;return t.replace(e,"$1 $2").replace(i,"$1 $2$3").replace(/\./g," ").split(" ").map(r=>r.substring(0,1).toUpperCase()+(r.length>1?r.substring(1,r.length):"")).join(" ")}var HZ=class extends H{constructor(){super(...arguments),this.beanName="colNames"}getDisplayNameForColumn(t,e,i=!1){if(!t)return null;let n=this.getHeaderName(t.getColDef(),t,null,null,e),{aggColNameSvc:r}=this.beans;return i&&r?r.getHeaderName(t,n):n}getDisplayNameForProvidedColumnGroup(t,e,i){let n=e?.getColGroupDef();return n?this.getHeaderName(n,null,t,e,i):null}getDisplayNameForColumnGroup(t,e){return this.getDisplayNameForProvidedColumnGroup(t,t.getProvidedColumnGroup(),e)}getHeaderName(t,e,i,n,r){let o=t.headerValueGetter;if(o){let s=Ee(this.gos,{colDef:t,column:e,columnGroup:i,providedColumnGroup:n,location:r});return typeof o=="function"?o(s):typeof o=="string"?this.beans.expressionSvc?.evaluate(o,s)??null:""}else{if(t.headerName!=null)return t.headerName;if(t.field)return BZ(t.field)}return""}},zZ=class extends H{constructor(){super(...arguments),this.beanName="colViewport",this.colsWithinViewport=[],this.headerColsWithinViewport=[],this.colsWithinViewportHash="",this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.columnsToRenderLeft=[],this.columnsToRenderRight=[],this.columnsToRenderCenter=[]}wireBeans(t){this.visibleCols=t.visibleCols,this.colModel=t.colModel}postConstruct(){this.suppressColumnVirtualisation=this.gos.get("suppressColumnVirtualisation")}setScrollPosition(t,e,i=!1){let{visibleCols:n}=this,r=n.isBodyWidthDirty;if(!(t===this.scrollWidth&&e===this.scrollPosition&&!r)){if(this.scrollWidth=t,this.scrollPosition=e,n.isBodyWidthDirty=!0,this.gos.get("enableRtl")){let s=n.bodyWidth;this.viewportLeft=s-e-t,this.viewportRight=s-e}else this.viewportLeft=e,this.viewportRight=t+e;this.colModel.ready&&this.checkViewportColumns(i)}}getColumnHeadersToRender(t){switch(t){case"left":return this.columnsToRenderLeft;case"right":return this.columnsToRenderRight;default:return this.columnsToRenderCenter}}getHeadersToRender(t,e){let i;switch(t){case"left":i=this.rowsOfHeadersToRenderLeft[e];break;case"right":i=this.rowsOfHeadersToRenderRight[e];break;default:i=this.rowsOfHeadersToRenderCenter[e];break}return i??[]}extractViewportColumns(){let t=this.visibleCols.centerCols;this.isColumnVirtualisationSuppressed()?(this.colsWithinViewport=t,this.headerColsWithinViewport=t):(this.colsWithinViewport=t.filter(this.isColumnInRowViewport.bind(this)),this.headerColsWithinViewport=t.filter(this.isColumnInHeaderViewport.bind(this)))}isColumnVirtualisationSuppressed(){return this.suppressColumnVirtualisation||this.viewportRight===0}clear(){this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.colsWithinViewportHash=""}isColumnInHeaderViewport(t){return t.isAutoHeaderHeight()||VZ(t)?!0:this.isColumnInRowViewport(t)}isColumnInRowViewport(t){if(t.isAutoHeight())return!0;let e=t.getLeft()||0,i=e+t.getActualWidth(),n=this.viewportLeft-200,r=this.viewportRight+200,o=e<n&&i<n,s=e>r&&i>r;return!o&&!s}getViewportColumns(){let{leftCols:t,rightCols:e}=this.visibleCols;return this.colsWithinViewport.concat(t).concat(e)}getColsWithinViewport(t){if(!this.colModel.colSpanActive)return this.colsWithinViewport;let e=o=>{let s=o.getLeft();return ae(s)&&s>this.viewportLeft},i=this.isColumnVirtualisationSuppressed()?void 0:this.isColumnInRowViewport.bind(this),{visibleCols:n}=this,r=n.centerCols;return n.getColsForRow(t,r,i,e)}checkViewportColumns(t=!1){this.extractViewport()&&this.eventSvc.dispatchEvent({type:"virtualColumnsChanged",afterScroll:t})}calculateHeaderRows(){let{leftCols:t,rightCols:e}=this.visibleCols;this.columnsToRenderLeft=t,this.columnsToRenderRight=e,this.columnsToRenderCenter=this.colsWithinViewport;let i=n=>{let r=new Set,o={};for(let s of n){let a=s.getParent(),l=s.isSpanHeaderHeight();for(;a&&!r.has(a);){if(l&&a.isPadding()){a=a.getParent();continue}let d=a.getProvidedColumnGroup().getLevel();o[d]??(o[d]=[]),o[d].push(a),r.add(a),a=a.getParent()}}return o};this.rowsOfHeadersToRenderLeft=i(t),this.rowsOfHeadersToRenderRight=i(e),this.rowsOfHeadersToRenderCenter=i(this.headerColsWithinViewport)}extractViewport(){let t=n=>`${n.getId()}-${n.getPinned()||"normal"}`;this.extractViewportColumns();let e=this.getViewportColumns().map(t).join("#"),i=this.colsWithinViewportHash!==e;return i&&(this.colsWithinViewportHash=e,this.calculateHeaderRows()),i}};function VZ(t){for(;t;){if(t.isAutoHeaderHeight())return!0;t=t.getParent()}return!1}var GZ=class extends H{constructor(){super(...arguments),this.beanName="agCompUtils"}adaptFunction(t,e){if(!t.cellRenderer)return null;class i{refresh(){return!1}getGui(){return this.eGui}init(r){let o=e(r),s=typeof o;if(s==="string"||s==="number"||s==="boolean"){this.eGui=ES("<span>"+o+"</span>");return}if(o==null){this.eGui=Nt({tag:"span"});return}this.eGui=o}}return i}},WZ={moduleName:"CellRendererFunction",version:oe,beans:[GZ]},UZ=class extends $K{constructor(){super(...arguments),this.agGridDefaults={},this.agGridDefaultOverrides={},this.jsComps={},this.selectors={},this.icons={}}postConstruct(){let t=this.gos.get("components");if(t!=null)for(let e of Object.keys(t))this.jsComps[e]=t[e]}registerModule(t){let{icons:e,userComponents:i,dynamicBeans:n,selectors:r}=t;if(i){let o=(s,a,l,c)=>{this.agGridDefaults[s]=a,(l||c)&&(this.agGridDefaultOverrides[s]={params:l,processParams:c})};for(let s of Object.keys(i)){let a=i[s];if(j$(a)&&(a=a.getComp(this.beans)),typeof a=="object"){let{classImp:l,params:c,processParams:d}=a;o(s,l,c,d)}else o(s,a)}}this.registerDynamicBeans(n);for(let o of r??[])this.selectors[o.selector]=o;if(e)for(let o of Object.keys(e))this.icons[o]=e[o]}getUserComponent(t,e){let i=(a,l,c,d)=>({componentFromFramework:l,component:a,params:c,processParams:d}),{frameworkOverrides:n}=this.beans,r=n.frameworkComponent(e,this.gos.get("components"));if(r!=null)return i(r,!0);let o=this.jsComps[e];if(o){let a=n.isFrameworkComponent(o);return i(o,a)}let s=this.agGridDefaults[e];if(s){let a=this.agGridDefaultOverrides[e];return i(s,!1,a?.params,a?.processParams)}return this.beans.validation?.missingUserComponent(t,e,this.agGridDefaults,this.jsComps),null}getSelector(t){return this.selectors[t]}getIcon(t){return this.icons[t]}getDynamicError(t,e){return e?Or(279,{name:t}):this.beans.validation?.missingDynamicBean(t)??Or(256)}},jZ=23,qZ=class extends H{constructor(){super(...arguments),this.beanName="ctrlsSvc",this.params={},this.ready=!1,this.readyCallbacks=[]}postConstruct(){this.addEventListener("ready",()=>{if(this.updateReady(),this.ready){for(let t of this.readyCallbacks)t(this.params);this.readyCallbacks.length=0}},this.beans.frameworkOverrides.runWhenReadyAsync?.()??!1)}updateReady(){let t=Object.values(this.params);this.ready=t.length===jZ&&t.every(e=>e?.isAlive()??!1)}whenReady(t,e){this.ready?e(this.params):this.readyCallbacks.push(e),t.addDestroyFunc(()=>{let i=this.readyCallbacks.indexOf(e);i>=0&&this.readyCallbacks.splice(i,1)})}register(t,e){this.params[t]=e,this.updateReady(),this.ready&&this.dispatchLocalEvent({type:"ready"}),e.addDestroyFunc(()=>{this.updateReady()})}get(t){return this.params[t]}getGridBodyCtrl(){return this.params.gridBodyCtrl}getHeaderRowContainerCtrls(){let{leftHeader:t,centerHeader:e,rightHeader:i}=this.params;return[t,i,e]}getHeaderRowContainerCtrl(t){let e=this.params;switch(t){case"left":return e.leftHeader;case"right":return e.rightHeader;default:return e.centerHeader}}getScrollFeature(){return this.getGridBodyCtrl().scrollFeature}},$Z='.ag-aria-description-container{border:0;z-index:9999;clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px}.ag-unselectable{-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-selectable{-webkit-user-select:text;-moz-user-select:text;user-select:text}.ag-tab-guard{display:block;height:0;position:absolute;width:0}:where(.ag-virtual-list-viewport) .ag-tab-guard{position:sticky}.ag-tab-guard-top{top:1px}.ag-tab-guard-bottom{bottom:1px}.ag-shake-left-to-right{animation-direction:alternate;animation-duration:.2s;animation-iteration-count:infinite;animation-name:ag-shake-left-to-right}@keyframes ag-shake-left-to-right{0%{padding-left:6px;padding-right:2px}to{padding-left:2px;padding-right:6px}}.ag-body-horizontal-scroll-viewport,.ag-body-vertical-scroll-viewport,.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport,.ag-virtual-list-viewport{flex:1 1 auto;height:100%;min-width:0;overflow:hidden;position:relative}.ag-viewport{position:relative}.ag-spanning-container{position:absolute;top:0;z-index:1}.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport{overflow-x:auto;-ms-overflow-style:none!important;scrollbar-width:none!important;&::-webkit-scrollbar{display:none!important}}.ag-body-viewport{display:flex;overflow-x:hidden;&:where(.ag-layout-normal){overflow-y:auto;-webkit-overflow-scrolling:touch}}.ag-floating-bottom-container,.ag-floating-top-container,.ag-sticky-bottom-container,.ag-sticky-top-container{min-height:1px}.ag-center-cols-viewport{min-height:100%;width:100%}.ag-body-horizontal-scroll-viewport{overflow-x:scroll}.ag-body-vertical-scroll-viewport{overflow-y:scroll}.ag-virtual-list-viewport{overflow:auto;width:100%}.ag-body-container,.ag-body-horizontal-scroll-container,.ag-body-vertical-scroll-container,.ag-center-cols-container,.ag-floating-bottom-container,.ag-floating-bottom-full-width-container,.ag-floating-top-container,.ag-full-width-container,.ag-header-container,.ag-pinned-left-cols-container,.ag-pinned-right-cols-container,.ag-sticky-bottom-container,.ag-sticky-top-container,.ag-virtual-list-container{position:relative}.ag-floating-bottom-container,.ag-floating-top-container,.ag-header-container,.ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top,.ag-sticky-bottom-container,.ag-sticky-top-container{height:100%;white-space:nowrap}.ag-center-cols-container,.ag-pinned-right-cols-container{display:block}.ag-body-horizontal-scroll-container{height:100%}.ag-body-vertical-scroll-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container,.ag-full-width-container,.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{pointer-events:none;position:absolute;top:0}:where(.ag-ltr) .ag-floating-bottom-full-width-container,:where(.ag-ltr) .ag-floating-top-full-width-container,:where(.ag-ltr) .ag-full-width-container,:where(.ag-ltr) .ag-sticky-bottom-full-width-container,:where(.ag-ltr) .ag-sticky-top-full-width-container{left:0}:where(.ag-rtl) .ag-floating-bottom-full-width-container,:where(.ag-rtl) .ag-floating-top-full-width-container,:where(.ag-rtl) .ag-full-width-container,:where(.ag-rtl) .ag-sticky-bottom-full-width-container,:where(.ag-rtl) .ag-sticky-top-full-width-container{right:0}.ag-full-width-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container{display:inline-block;height:100%;overflow:hidden;width:100%}.ag-virtual-list-container{overflow:hidden}.ag-body{display:flex;flex:1 1 auto;flex-direction:row!important;min-height:0;position:relative}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:flex;min-height:0;min-width:0;position:relative;&:where(.ag-scrollbar-invisible){bottom:0;position:absolute;&:where(.ag-apple-scrollbar){opacity:0;transition:opacity .4s;visibility:hidden;&:where(.ag-scrollbar-scrolling,.ag-scrollbar-active){opacity:1;visibility:visible}}}}.ag-body-horizontal-scroll{width:100%;&:where(.ag-scrollbar-invisible){left:0;right:0}}.ag-body-vertical-scroll{height:100%;&:where(.ag-scrollbar-invisible){top:0;z-index:10}}:where(.ag-ltr) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){right:0}}:where(.ag-rtl) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){left:0}}.ag-force-vertical-scroll{overflow-y:scroll!important}.ag-horizontal-left-spacer,.ag-horizontal-right-spacer{height:100%;min-width:0;overflow-x:scroll;&:where(.ag-scroller-corner){overflow-x:hidden}}:where(.ag-row-animation) .ag-row{transition:transform .4s,top .4s,opacity .2s;&:where(.ag-after-created){transition:transform .4s,top .4s,height .4s,opacity .2s}}:where(.ag-row-animation.ag-prevent-animation) .ag-row{transition:none!important;&:where(.ag-row.ag-after-created){transition:none!important}}:where(.ag-row-no-animation) .ag-row{transition:none}.ag-row-loading{align-items:center;display:flex}.ag-row-position-absolute{position:absolute}.ag-row-position-relative{position:relative}.ag-full-width-row{overflow:hidden;pointer-events:all}.ag-row-inline-editing{z-index:1}.ag-row-dragging{z-index:2}.ag-stub-cell{align-items:center;display:flex}.ag-cell{display:inline-block;height:100%;position:absolute;white-space:nowrap;&:focus-visible{box-shadow:none}}.ag-cell-value{flex:1 1 auto}.ag-cell-value:not(.ag-allow-overflow),.ag-group-value{overflow:hidden;text-overflow:ellipsis}.ag-cell-wrap-text{white-space:normal;word-break:break-word}:where(.ag-cell) .ag-icon{display:inline-block;vertical-align:middle}.ag-floating-top{display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}:where(.ag-floating-top:not(.ag-invisible)){border-bottom:var(--ag-pinned-row-border)}.ag-floating-bottom{display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}:where(.ag-floating-bottom:not(.ag-invisible)){border-top:var(--ag-pinned-row-border)}.ag-sticky-bottom,.ag-sticky-top{background-color:var(--ag-data-background-color);display:flex;height:0;overflow:hidden;position:absolute;width:100%;z-index:1}.ag-opacity-zero{opacity:0!important}.ag-cell-label-container{align-items:center;display:flex;flex-direction:row-reverse;height:100%;justify-content:space-between;width:100%}:where(.ag-right-aligned-header){.ag-cell-label-container{flex-direction:row}.ag-header-cell-text{text-align:end}}.ag-column-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr){direction:ltr;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row}}:where(.ag-rtl){direction:rtl;text-align:right;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row-reverse}.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{display:block}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(180deg)}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(-180deg)}}.ag-measurement-container{height:0;overflow:hidden;visibility:hidden;width:0}.ag-measurement-element-border{display:inline-block;&:before{border-left:var(--ag-internal-measurement-border);content:"";display:block}}.ag-group{position:relative;width:100%}.ag-group-title-bar{align-items:center;display:flex;padding:var(--ag-spacing)}.ag-group-title{display:inline;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:where(.ag-group-title-bar) .ag-group-title{cursor:default}.ag-group-toolbar{align-items:center;display:flex;padding:var(--ag-spacing)}.ag-group-container{display:flex}.ag-disabled .ag-group-container{pointer-events:none}.ag-disabled-group-container,.ag-disabled-group-title-bar{opacity:.5}.ag-group-container-horizontal{flex-flow:row wrap}.ag-group-container-vertical{flex-direction:column}.ag-group-title-bar-icon{cursor:pointer;flex:none}:where(.ag-ltr) .ag-group-title-bar-icon{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-group-title-bar-icon{margin-left:var(--ag-spacing)}:where(.ag-group-item-alignment-stretch) .ag-group-item{align-items:stretch}:where(.ag-group-item-alignment-start) .ag-group-item{align-items:flex-start}:where(.ag-group-item-alignment-end) .ag-group-item{align-items:flex-end}:where(.ag-ltr) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-left:var(--ag-row-group-indent-size)}:where(.ag-rtl) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-right:var(--ag-row-group-indent-size)}:where(.ag-ltr) .ag-row-group-leaf-indent{margin-left:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}:where(.ag-rtl) .ag-row-group-leaf-indent{margin-right:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}.ag-value-change-delta{padding:0 2px}.ag-value-change-delta-up{color:var(--ag-value-change-delta-up-color)}.ag-value-change-delta-down{color:var(--ag-value-change-delta-down-color)}.ag-value-change-value{background-color:transparent;border-radius:1px;padding-left:1px;padding-right:1px;transition:background-color 1s}.ag-value-change-value-highlight{background-color:var(--ag-value-change-value-highlight-background-color);transition:background-color .1s}.ag-cell-data-changed{background-color:var(--ag-value-change-value-highlight-background-color)!important}.ag-cell-data-changed-animation{background-color:transparent}.ag-cell-highlight{background-color:var(--ag-range-selection-highlight-color)!important}.ag-row,.ag-spanned-row{color:var(--ag-cell-text-color);font-family:var(--ag-cell-font-family);font-size:var(--ag-data-font-size);white-space:nowrap;--ag-internal-content-line-height:calc(min(var(--ag-row-height), var(--ag-line-height, 1000px)) - var(--ag-internal-row-border-width, 1px) - 2px)}.ag-row{background-color:var(--ag-data-background-color);border-bottom:var(--ag-row-border);height:var(--ag-row-height);width:100%;&.ag-row-editing-invalid{background-color:var(--ag-full-row-edit-invalid-background-color)}}:where(.ag-body-vertical-content-no-gap>div>div>div,.ag-body-vertical-content-no-gap>div>div>div>div)>.ag-row-last{border-bottom-color:transparent}.ag-sticky-bottom{border-top:var(--ag-row-border);box-sizing:content-box!important}.ag-group-contracted,.ag-group-expanded{cursor:pointer}.ag-cell,.ag-full-width-row .ag-cell-wrapper.ag-row-group{border:1px solid transparent;line-height:var(--ag-internal-content-line-height);-webkit-font-smoothing:subpixel-antialiased}:where(.ag-ltr) .ag-cell{border-right:var(--ag-column-border)}:where(.ag-rtl) .ag-cell{border-left:var(--ag-column-border)}.ag-spanned-cell-wrapper{background-color:var(--ag-data-background-color);position:absolute}.ag-spanned-cell-wrapper>.ag-spanned-cell{display:block;position:relative}:where(.ag-ltr) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-right-color:transparent}:where(.ag-rtl) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-left-color:transparent}.ag-cell-wrapper{align-items:center;display:flex;>:where(:not(.ag-cell-value,.ag-group-value)){align-items:center;display:flex;height:var(--ag-internal-content-line-height)}&:where(.ag-row-group){align-items:flex-start}:where(.ag-full-width-row) &:where(.ag-row-group){align-items:center;height:100%}}:where(.ag-ltr) .ag-cell-wrapper{padding-left:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-rtl) .ag-cell-wrapper{padding-right:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-cell-wrap-text:not(.ag-cell-auto-height)) .ag-cell-wrapper{align-items:normal;height:100%;:where(.ag-cell-value){height:100%}}:where(.ag-ltr) .ag-row>.ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}:where(.ag-rtl) .ag-row>.ag-cell-wrapper.ag-row-group{padding-right:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-cell-focus:not(.ag-cell-range-selected):focus-within,.ag-cell-range-single-cell,.ag-cell-range-single-cell.ag-cell-range-handle,.ag-context-menu-open .ag-cell-focus:not(.ag-cell-range-selected),.ag-context-menu-open .ag-full-width-row.ag-row-focus .ag-cell-wrapper.ag-row-group,.ag-full-width-row.ag-row-focus:focus .ag-cell-wrapper.ag-row-group{border:1px solid;border-color:var(--ag-range-selection-border-color);border-style:var(--ag-range-selection-border-style);outline:initial}.ag-full-width-row.ag-row-focus:focus{box-shadow:none}:where(.ag-ltr) .ag-group-contracted,:where(.ag-ltr) .ag-group-expanded,:where(.ag-ltr) .ag-row-drag,:where(.ag-ltr) .ag-selection-checkbox{margin-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-group-contracted,:where(.ag-rtl) .ag-group-expanded,:where(.ag-rtl) .ag-row-drag,:where(.ag-rtl) .ag-selection-checkbox{margin-left:var(--ag-cell-widget-spacing)}:where(.ag-ltr) .ag-group-child-count{margin-left:3px}:where(.ag-rtl) .ag-group-child-count{margin-right:3px}.ag-row-highlight-above:after,.ag-row-highlight-below:after,.ag-row-highlight-inside:after{background-color:var(--ag-range-selection-border-color);content:"";height:1px;pointer-events:none;position:absolute;width:calc(100% - 1px)}:where(.ag-ltr) .ag-row-highlight-above:after,:where(.ag-ltr) .ag-row-highlight-below:after,:where(.ag-ltr) .ag-row-highlight-inside:after{left:1px}:where(.ag-rtl) .ag-row-highlight-above:after,:where(.ag-rtl) .ag-row-highlight-below:after,:where(.ag-rtl) .ag-row-highlight-inside:after{right:1px}.ag-row-highlight-above:after{top:0}.ag-row-highlight-below:after{bottom:0}.ag-row-highlight-indent:after{display:block;width:auto}:where(.ag-ltr) .ag-row-highlight-indent:after{left:calc((var(--ag-cell-widget-spacing) + var(--ag-icon-size))*2 + var(--ag-cell-horizontal-padding) + var(--ag-row-highlight-level)*var(--ag-row-group-indent-size));right:1px}:where(.ag-rtl) .ag-row-highlight-indent:after{left:1px;right:calc((var(--ag-cell-widget-spacing) + var(--ag-icon-size))*2 + var(--ag-cell-horizontal-padding) + var(--ag-row-highlight-level)*var(--ag-row-group-indent-size))}.ag-row-highlight-inside:after{background-color:var(--ag-selected-row-background-color);border:1px solid var(--ag-range-selection-border-color);display:block;height:auto;inset:0;width:auto}.ag-body,.ag-floating-bottom,.ag-floating-top{background-color:var(--ag-data-background-color)}.ag-row-odd{background-color:var(--ag-odd-row-background-color)}.ag-row-selected:before{background-color:var(--ag-selected-row-background-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-full-width-row.ag-row-group:before,.ag-row-hover:not(.ag-full-width-row):before{background-color:var(--ag-row-hover-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-row-selected:before{background-color:var(--ag-row-hover-color);background-image:linear-gradient(var(--ag-selected-row-background-color),var(--ag-selected-row-background-color))}.ag-row.ag-full-width-row.ag-row-group>*{position:relative}.ag-column-hover{background-color:var(--ag-column-hover-color)}.ag-header-range-highlight{background-color:var(--ag-range-header-highlight-color)}.ag-right-aligned-cell{font-variant-numeric:tabular-nums}:where(.ag-ltr) .ag-right-aligned-cell{text-align:right}:where(.ag-rtl) .ag-right-aligned-cell{text-align:left}.ag-right-aligned-cell .ag-cell-value,.ag-right-aligned-cell .ag-group-value{margin-left:auto}:where(.ag-ltr) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-ltr) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level));padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}:where(.ag-rtl) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-rtl) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-row>.ag-cell-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}.ag-row-dragging{cursor:move;opacity:.5}.ag-details-row{background-color:var(--ag-data-background-color);padding:calc(var(--ag-spacing)*3.75)}.ag-layout-auto-height,.ag-layout-print{.ag-center-cols-container,.ag-center-cols-viewport{min-height:150px}}.ag-overlay-loading-wrapper{background-color:var(--ag-modal-overlay-background-color)}.ag-skeleton-container{align-content:center;height:100%;width:100%}.ag-skeleton-effect{animation:ag-skeleton-loading 1.5s ease-in-out .5s infinite;background-color:var(--ag-row-loading-skeleton-effect-color);border-radius:.25rem;height:1em;width:100%}:where(.ag-ltr) .ag-right-aligned-cell .ag-skeleton-effect{margin-left:auto}:where(.ag-rtl) .ag-right-aligned-cell .ag-skeleton-effect{margin-right:auto}@keyframes ag-skeleton-loading{0%{background-color:var(--ag-row-loading-skeleton-effect-color)}50%{background-color:color-mix(in srgb,transparent,var(--ag-row-loading-skeleton-effect-color) 40%)}to{background-color:var(--ag-row-loading-skeleton-effect-color)}}.ag-loading{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-loading{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-loading{padding-right:var(--ag-cell-horizontal-padding)}:where(.ag-ltr) .ag-loading-icon{padding-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-loading-icon{padding-left:var(--ag-cell-widget-spacing)}.ag-icon-loading{animation-duration:1s;animation-iteration-count:infinite;animation-name:spin;animation-timing-function:linear}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.ag-header{background-color:var(--ag-header-background-color);border-bottom:var(--ag-header-row-border);color:var(--ag-header-text-color);display:flex;font-family:var(--ag-header-font-family);font-size:var(--ag-header-font-size);font-weight:var(--ag-header-font-weight);overflow:hidden;white-space:nowrap;width:100%}.ag-header-row{height:var(--ag-header-height);position:absolute}.ag-floating-filter-button-button,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,:where(.ag-header-cell-sortable) .ag-header-cell-label{cursor:pointer}:where(.ag-ltr) .ag-header-expand-icon{margin-left:4px}:where(.ag-rtl) .ag-header-expand-icon{margin-right:4px}.ag-header-row:where(:not(:first-child)){:where(.ag-header-cell:not(.ag-header-span-height.ag-header-span-total,.ag-header-parent-hidden),.ag-header-group-cell.ag-header-group-cell-with-group){border-top:var(--ag-header-row-border)}}.ag-header-row:where(:not(.ag-header-row-column-group)){overflow:hidden}:where(.ag-header.ag-header-allow-overflow) .ag-header-row{overflow:visible}.ag-header-cell{display:inline-flex;overflow:hidden}.ag-header-group-cell{contain:paint;display:flex}.ag-header-cell,.ag-header-group-cell{align-items:center;gap:var(--ag-cell-widget-spacing);height:100%;padding:0 var(--ag-cell-horizontal-padding);position:absolute}@property --ag-internal-moving-color{syntax:"<color>";inherits:false;initial-value:transparent}@property --ag-internal-hover-color{syntax:"<color>";inherits:false;initial-value:transparent}.ag-header-cell:where(:not(.ag-floating-filter)),.ag-header-group-cell{&:before{background-image:linear-gradient(var(--ag-internal-hover-color),var(--ag-internal-hover-color)),linear-gradient(var(--ag-internal-moving-color),var(--ag-internal-moving-color));content:"";inset:0;position:absolute;--ag-internal-moving-color:transparent;--ag-internal-hover-color:transparent;transition:--ag-internal-moving-color var(--ag-header-cell-background-transition-duration),--ag-internal-hover-color var(--ag-header-cell-background-transition-duration)}&:where(:hover):before{--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}&:where(.ag-header-cell-moving):before{--ag-internal-moving-color:var(--ag-header-cell-moving-background-color);--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}}:where(.ag-header-cell:not(.ag-floating-filter) *,.ag-header-group-cell *){position:relative;z-index:1}.ag-header-cell-menu-button:where(:not(.ag-header-menu-always-show)){opacity:0;transition:opacity .2s}.ag-header-cell-filter-button,:where(.ag-header-cell.ag-header-active) .ag-header-cell-menu-button{opacity:1}.ag-header-cell-label,.ag-header-group-cell-label{align-items:center;align-self:stretch;display:flex;flex:1 1 auto;overflow:hidden;padding:5px 0}:where(.ag-ltr) .ag-sort-indicator-icon{padding-left:var(--ag-spacing)}:where(.ag-rtl) .ag-sort-indicator-icon{padding-right:var(--ag-spacing)}.ag-header-cell-label{text-overflow:ellipsis}.ag-header-group-cell-label.ag-sticky-label{flex:none;max-width:100%;overflow:visible;position:sticky}:where(.ag-ltr) .ag-header-group-cell-label.ag-sticky-label{left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-header-group-cell-label.ag-sticky-label{right:var(--ag-cell-horizontal-padding)}.ag-header-cell-text,.ag-header-group-text{overflow:hidden;text-overflow:ellipsis}.ag-header-cell-text{word-break:break-word}.ag-header-cell-comp-wrapper{width:100%}:where(.ag-header-group-cell) .ag-header-cell-comp-wrapper{display:flex}:where(.ag-header-cell:not(.ag-header-cell-auto-height)) .ag-header-cell-comp-wrapper{align-items:center;display:flex;height:100%}.ag-header-cell-wrap-text .ag-header-cell-comp-wrapper{white-space:normal}.ag-header-cell-comp-wrapper-limited-height>*{overflow:hidden}:where(.ag-right-aligned-header) .ag-header-cell-label{flex-direction:row-reverse}:where(.ag-ltr) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-ltr) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}.ag-header-cell:after,.ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{content:"";height:var(--ag-header-column-border-height);position:absolute;top:calc(50% - var(--ag-header-column-border-height)*.5);z-index:1}:where(.ag-ltr) .ag-header-cell:after,:where(.ag-ltr) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-right:var(--ag-header-column-border);right:0}:where(.ag-rtl) .ag-header-cell:after,:where(.ag-rtl) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-left:var(--ag-header-column-border);left:0}.ag-header-highlight-after:after,.ag-header-highlight-before:after{background-color:var(--ag-accent-color);content:"";height:100%;position:absolute;width:1px}:where(.ag-ltr) .ag-header-highlight-before:after{left:0}:where(.ag-rtl) .ag-header-highlight-before:after{right:0}:where(.ag-ltr) .ag-header-highlight-after:after{right:0;:where(.ag-pinned-left-header) &{right:1px}}:where(.ag-rtl) .ag-header-highlight-after:after{left:0;:where(.ag-pinned-left-header) &{left:1px}}.ag-header-cell-resize{align-items:center;cursor:ew-resize;display:flex;height:100%;position:absolute;top:0;width:8px;z-index:2;&:after{background-color:var(--ag-header-column-resize-handle-color);content:"";height:var(--ag-header-column-resize-handle-height);position:absolute;top:calc(50% - var(--ag-header-column-resize-handle-height)*.5);width:var(--ag-header-column-resize-handle-width);z-index:1}}:where(.ag-ltr) .ag-header-cell-resize{right:-3px;&:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-rtl) .ag-header-cell-resize{left:-3px;&:after{right:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-header-cell.ag-header-span-height) .ag-header-cell-resize:after{height:calc(100% - var(--ag-spacing)*4);top:calc(var(--ag-spacing)*2)}.ag-header-group-cell-no-group:where(.ag-header-span-height){display:none}.ag-sort-indicator-container{display:flex;gap:var(--ag-spacing)}.ag-layout-print{&.ag-body{display:block;height:unset}&.ag-root-wrapper{display:inline-block}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:none}&.ag-force-vertical-scroll{overflow-y:visible!important}}@media print{.ag-root-wrapper.ag-layout-print{display:table;.ag-body-horizontal-scroll-viewport,.ag-body-viewport,.ag-center-cols-container,.ag-center-cols-viewport,.ag-root,.ag-root-wrapper-body,.ag-virtual-list-viewport{display:block!important;height:auto!important;overflow:hidden!important}.ag-cell,.ag-row{-moz-column-break-inside:avoid;break-inside:avoid}}}ag-grid,ag-grid-angular{display:block}.ag-root-wrapper{border:var(--ag-wrapper-border);border-radius:var(--ag-wrapper-border-radius);display:flex;flex-direction:column;overflow:hidden;position:relative;&.ag-layout-normal{height:100%}}.ag-root-wrapper-body{display:flex;flex-direction:row;&.ag-layout-normal{flex:1 1 auto;height:0;min-height:0}}.ag-root{display:flex;flex-direction:column;position:relative;&.ag-layout-auto-height,&.ag-layout-normal{flex:1 1 auto;overflow:hidden;width:0}&.ag-layout-normal{height:100%}}.ag-virtual-list-item{height:var(--ag-list-item-height);position:absolute;width:100%}.ag-list-item-hovered:after{background-color:var(--ag-accent-color);content:"";height:1px;left:0;position:absolute;right:0}.ag-item-highlight-top:after{top:0}.ag-item-highlight-bottom:after{bottom:0}.ag-drag-handle{color:var(--ag-drag-handle-color);cursor:grab;:where(.ag-icon){color:var(--ag-drag-handle-color)}}.ag-chart-menu-icon,.ag-chart-settings-next,.ag-chart-settings-prev,.ag-column-group-icons,.ag-column-select-header-icon,.ag-filter-toolpanel-expand,.ag-floating-filter-button-button,.ag-group-title-bar-icon,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,.ag-panel-title-bar-button-icon,.ag-set-filter-group-icons,:where(.ag-group-contracted) .ag-icon,:where(.ag-group-expanded) .ag-icon{background-color:var(--ag-icon-button-background-color);border-radius:var(--ag-icon-button-border-radius);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-background-color);color:var(--ag-icon-button-color);&:hover{background-color:var(--ag-icon-button-hover-background-color);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-hover-background-color);color:var(--ag-icon-button-hover-color)}}.ag-filter-active{background-image:linear-gradient(var(--ag-icon-button-active-background-color),var(--ag-icon-button-active-background-color));border-radius:1px;outline:solid var(--ag-icon-button-background-spread) var(--ag-icon-button-active-background-color);position:relative;&:after{background-color:var(--ag-icon-button-active-indicator-color);border-radius:50%;content:"";height:6px;position:absolute;top:-1px;width:6px}:where(.ag-icon-filter){clip-path:path("M8,0C8,4.415 11.585,8 16,8L16,16L0,16L0,0L8,0Z");color:var(--ag-icon-button-active-color)}}:where(.ag-ltr) .ag-filter-active{&:after{right:-1px}}:where(.ag-rtl) .ag-filter-active{&:after{left:-1px}}.ag-menu{background-color:var(--ag-menu-background-color);border:var(--ag-menu-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-menu-shadow);color:var(--ag-menu-text-color);max-height:100%;overflow-y:auto;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}',KZ={wrapperBorder:!0,rowBorder:!0,headerRowBorder:!0,footerRowBorder:{ref:"rowBorder"},columnBorder:{style:"solid",width:1,color:"transparent"},headerColumnBorder:!1,headerColumnBorderHeight:"100%",pinnedColumnBorder:!0,pinnedRowBorder:!0,sidePanelBorder:!0,sideBarPanelWidth:250,sideBarBackgroundColor:{ref:"chromeBackgroundColor"},sideButtonBarBackgroundColor:{ref:"sideBarBackgroundColor"},sideButtonBarTopPadding:0,sideButtonSelectedUnderlineWidth:2,sideButtonSelectedUnderlineColor:"transparent",sideButtonSelectedUnderlineTransitionDuration:0,sideButtonBackgroundColor:"transparent",sideButtonTextColor:{ref:"textColor"},sideButtonHoverBackgroundColor:{ref:"sideButtonBackgroundColor"},sideButtonHoverTextColor:{ref:"sideButtonTextColor"},sideButtonSelectedBackgroundColor:Di,sideButtonSelectedTextColor:{ref:"sideButtonTextColor"},sideButtonBorder:"solid 1px transparent",sideButtonSelectedBorder:!0,sideButtonLeftPadding:{ref:"spacing"},sideButtonRightPadding:{ref:"spacing"},sideButtonVerticalPadding:{calc:"spacing * 3"},headerBackgroundColor:{ref:"chromeBackgroundColor"},headerFontFamily:{ref:"fontFamily"},cellFontFamily:{ref:"fontFamily"},headerFontWeight:500,headerFontSize:{ref:"fontSize"},dataFontSize:{ref:"fontSize"},headerTextColor:{ref:"textColor"},headerCellHoverBackgroundColor:"transparent",headerCellMovingBackgroundColor:{ref:"headerCellHoverBackgroundColor"},headerCellBackgroundTransitionDuration:"0.2s",cellTextColor:{ref:"textColor"},rangeSelectionBorderStyle:"solid",rangeSelectionBorderColor:Qt,rangeSelectionBackgroundColor:ln(.2),rangeSelectionChartBackgroundColor:"#0058FF1A",rangeSelectionChartCategoryBackgroundColor:"#00FF841A",rangeSelectionHighlightColor:ln(.5),rangeHeaderHighlightColor:_K(.08),rowNumbersSelectedColor:ln(.5),rowHoverColor:ln(.08),columnHoverColor:ln(.05),selectedRowBackgroundColor:ln(.12),modalOverlayBackgroundColor:{ref:"backgroundColor",mix:.66},dataBackgroundColor:Di,oddRowBackgroundColor:{ref:"dataBackgroundColor"},wrapperBorderRadius:8,cellHorizontalPadding:{calc:"spacing * 2 * cellHorizontalPaddingScale"},cellWidgetSpacing:{calc:"spacing * 1.5"},cellHorizontalPaddingScale:1,rowGroupIndentSize:{calc:"cellWidgetSpacing + iconSize"},valueChangeDeltaUpColor:"#43a047",valueChangeDeltaDownColor:"#e53935",valueChangeValueHighlightBackgroundColor:"#16a08580",rowHeight:{calc:"max(iconSize, dataFontSize) + spacing * 3.25 * rowVerticalPaddingScale"},rowVerticalPaddingScale:1,headerHeight:{calc:"max(iconSize, dataFontSize) + spacing * 4 * headerVerticalPaddingScale"},headerVerticalPaddingScale:1,paginationPanelHeight:{ref:"rowHeight",calc:"max(rowHeight, 22px)"},dragHandleColor:Tn(.7),headerColumnResizeHandleHeight:"30%",headerColumnResizeHandleWidth:2,headerColumnResizeHandleColor:{ref:"borderColor"},widgetContainerHorizontalPadding:{calc:"spacing * 1.5"},widgetContainerVerticalPadding:{calc:"spacing * 1.5"},widgetHorizontalSpacing:{calc:"spacing * 1.5"},widgetVerticalSpacing:{ref:"spacing"},iconButtonColor:{ref:"iconColor"},iconButtonBackgroundColor:"transparent",iconButtonBackgroundSpread:4,iconButtonBorderRadius:1,iconButtonHoverColor:{ref:"iconButtonColor"},iconButtonHoverBackgroundColor:Tn(.1),iconButtonActiveColor:Qt,iconButtonActiveBackgroundColor:ln(.28),iconButtonActiveIndicatorColor:Qt,menuBorder:{color:Tn(.2)},menuBackgroundColor:Ti(.03),menuTextColor:Ti(.95),menuShadow:{ref:"popupShadow"},menuSeparatorColor:{ref:"borderColor"},setFilterIndentSize:{ref:"iconSize"},chartMenuPanelWidth:260,chartMenuLabelColor:Tn(.8),dialogShadow:{ref:"popupShadow"},cellEditingBorder:{color:Qt},cellEditingShadow:{ref:"cardShadow"},fullRowEditInvalidBackgroundColor:{ref:"invalidColor",onto:"backgroundColor",mix:.25},dialogBorder:{color:Tn(.2)},panelBackgroundColor:Di,panelTitleBarHeight:{ref:"headerHeight"},panelTitleBarBackgroundColor:{ref:"headerBackgroundColor"},panelTitleBarIconColor:{ref:"headerTextColor"},panelTitleBarTextColor:{ref:"headerTextColor"},panelTitleBarFontWeight:{ref:"headerFontWeight"},panelTitleBarBorder:!0,columnSelectIndentSize:{ref:"iconSize"},toolPanelSeparatorBorder:!0,columnDropCellBackgroundColor:Tn(.07),columnDropCellTextColor:{ref:"textColor"},columnDropCellDragHandleColor:{ref:"textColor"},columnDropCellBorder:{color:Tn(.13)},selectCellBackgroundColor:Tn(.07),selectCellBorder:{color:Tn(.13)},advancedFilterBuilderButtonBarBorder:!0,advancedFilterBuilderIndentSize:{calc:"spacing * 2 + iconSize"},advancedFilterBuilderJoinPillColor:"#f08e8d",advancedFilterBuilderColumnPillColor:"#a6e194",advancedFilterBuilderOptionPillColor:"#f3c08b",advancedFilterBuilderValuePillColor:"#85c0e4",filterPanelApplyButtonColor:Di,filterPanelApplyButtonBackgroundColor:Qt,filterPanelCardSubtleColor:{ref:"textColor",mix:.7},filterPanelCardSubtleHoverColor:{ref:"textColor"},findMatchColor:Jl,findMatchBackgroundColor:"#ffff00",findActiveMatchColor:Jl,findActiveMatchBackgroundColor:"#ffa500",filterToolPanelGroupIndent:{ref:"spacing"},rowLoadingSkeletonEffectColor:Tn(.15),statusBarLabelColor:Jl,statusBarLabelFontWeight:500,statusBarValueColor:Jl,statusBarValueFontWeight:500,pinnedSourceRowTextColor:{ref:"textColor"},pinnedSourceRowBackgroundColor:{ref:"dataBackgroundColor"},pinnedSourceRowFontWeight:600,pinnedRowFontWeight:600,pinnedRowBackgroundColor:{ref:"dataBackgroundColor"},pinnedRowTextColor:{ref:"textColor"}},YZ=".ag-cell-batch-edit{background-color:var(--ag-cell-batch-edit-background-color);color:var(--ag-cell-batch-edit-text-color);display:inherit}.ag-row-batch-edit{background-color:var(--ag-row-batch-edit-background-color);color:var(--ag-row-batch-edit-text-color)}",w8={cellBatchEditBackgroundColor:"rgba(220 181 139 / 16%)",cellBatchEditTextColor:"#422f00",rowBatchEditBackgroundColor:{ref:"cellBatchEditBackgroundColor"},rowBatchEditTextColor:{ref:"cellBatchEditTextColor"}},XZ=k(w({},w8),{cellBatchEditTextColor:"#f3d0b3"}),JZ=()=>hn({feature:"batchEditStyle",params:w8,css:YZ}),QZ=JZ(),b8=":where(.ag-button){background:none;border:none;color:inherit;cursor:pointer;font-family:inherit;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0;text-indent:inherit;text-shadow:inherit;text-transform:inherit;word-spacing:inherit;&:disabled{cursor:default}&:focus-visible{box-shadow:var(--ag-focus-shadow);outline:none}}.ag-standard-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:var(--ag-button-background-color);border:var(--ag-button-border);border-radius:var(--ag-button-border-radius);color:var(--ag-button-text-color);cursor:pointer;font-weight:var(--ag-button-font-weight);padding:var(--ag-button-vertical-padding) var(--ag-button-horizontal-padding);&:hover{background-color:var(--ag-button-hover-background-color);border:var(--ag-button-hover-border);color:var(--ag-button-hover-text-color)}&:active{background-color:var(--ag-button-active-background-color);border:var(--ag-button-active-border);color:var(--ag-button-active-text-color)}&:disabled{background-color:var(--ag-button-disabled-background-color);border:var(--ag-button-disabled-border);color:var(--ag-button-disabled-text-color)}}",y8={buttonTextColor:"inherit",buttonFontWeight:"normal",buttonBackgroundColor:"transparent",buttonBorder:!1,buttonBorderRadius:{ref:"borderRadius"},buttonHorizontalPadding:{calc:"spacing * 2"},buttonVerticalPadding:{ref:"spacing"},buttonHoverTextColor:{ref:"buttonTextColor"},buttonHoverBackgroundColor:{ref:"buttonBackgroundColor"},buttonHoverBorder:{ref:"buttonBorder"},buttonActiveTextColor:{ref:"buttonHoverTextColor"},buttonActiveBackgroundColor:{ref:"buttonHoverBackgroundColor"},buttonActiveBorder:{ref:"buttonHoverBorder"},buttonDisabledTextColor:{ref:"inputDisabledTextColor"},buttonDisabledBackgroundColor:{ref:"inputDisabledBackgroundColor"},buttonDisabledBorder:{ref:"inputDisabledBorder"}};var ZZ=()=>hn({feature:"buttonStyle",params:k(w({},y8),{buttonBackgroundColor:Di,buttonBorder:!0,buttonHoverBackgroundColor:{ref:"rowHoverColor"},buttonActiveBorder:{color:Qt}}),css:b8}),eee=ZZ(),tee=()=>hn({feature:"buttonStyle",params:k(w({},y8),{buttonBackgroundColor:Di,buttonBorder:{color:Qt},buttonFontWeight:600,buttonTextColor:Qt,buttonHoverBackgroundColor:{ref:"rowHoverColor"},buttonActiveBackgroundColor:Qt,buttonActiveTextColor:Di}),css:b8}),iee=tee();var nee=".ag-column-drop-vertical-empty-message{align-items:center;border:dashed var(--ag-border-width);border-color:var(--ag-border-color);display:flex;inset:0;justify-content:center;margin:calc(var(--ag-spacing)*1.5) calc(var(--ag-spacing)*2);overflow:hidden;padding:calc(var(--ag-spacing)*2);position:absolute}";var ree=()=>hn({feature:"columnDropStyle",css:nee}),t2=ree();var oee={warn:(...t)=>{K(t[0],t[1])},error:(...t)=>{at(t[0],t[1])},preInitErr:(...t)=>{qu(t[0],t[2],t[1])}},S8=()=>BK(oee).withParams(KZ).withPart(eee).withPart(t2).withPart(QZ),see='.ag-checkbox-input-wrapper,.ag-radio-button-input-wrapper{background-color:var(--ag-checkbox-unchecked-background-color);border:solid var(--ag-checkbox-border-width) var(--ag-checkbox-unchecked-border-color);flex:none;height:var(--ag-icon-size);position:relative;width:var(--ag-icon-size);:where(input){-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:block;height:var(--ag-icon-size);margin:0;opacity:0;width:var(--ag-icon-size)}&:after{content:"";display:block;inset:0;-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;pointer-events:none;position:absolute}&:where(.ag-checked){background-color:var(--ag-checkbox-checked-background-color);border-color:var(--ag-checkbox-checked-border-color);&:after{background-color:var(--ag-checkbox-checked-shape-color)}}&:where(:focus-within,:active){box-shadow:var(--ag-focus-shadow)}&:where(.ag-disabled){filter:grayscale();opacity:.5}}.ag-checkbox-input-wrapper{border-radius:var(--ag-checkbox-border-radius);&:where(.ag-checked):after{-webkit-mask-image:var(--ag-checkbox-checked-shape-image);mask-image:var(--ag-checkbox-checked-shape-image)}&:where(.ag-indeterminate){background-color:var(--ag-checkbox-indeterminate-background-color);border-color:var(--ag-checkbox-indeterminate-border-color);&:after{background-color:var(--ag-checkbox-indeterminate-shape-color);-webkit-mask-image:var(--ag-checkbox-indeterminate-shape-image);mask-image:var(--ag-checkbox-indeterminate-shape-image)}}}.ag-cell-editing-error .ag-checkbox-input-wrapper:focus-within{box-shadow:var(--ag-focus-error-shadow)}.ag-radio-button-input-wrapper{border-radius:100%;&:where(.ag-checked):after{-webkit-mask-image:var(--ag-radio-checked-shape-image);mask-image:var(--ag-radio-checked-shape-image)}}',aee=()=>hn({feature:"checkboxStyle",params:{checkboxBorderWidth:1,checkboxBorderRadius:{ref:"borderRadius"},checkboxUncheckedBackgroundColor:Di,checkboxUncheckedBorderColor:Ti(.3),checkboxCheckedBackgroundColor:Qt,checkboxCheckedBorderColor:{ref:"checkboxCheckedBackgroundColor"},checkboxCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="7" fill="none"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75" d="M1 3.5 3.5 6l5-5"/></svg>'},checkboxCheckedShapeColor:Di,checkboxIndeterminateBackgroundColor:Ti(.3),checkboxIndeterminateBorderColor:{ref:"checkboxIndeterminateBackgroundColor"},checkboxIndeterminateShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="2" fill="none"><rect width="10" height="2" fill="#000" rx="1"/></svg>'},checkboxIndeterminateShapeColor:Di,radioCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="6" height="6" fill="none"><circle cx="3" cy="3" r="3" fill="#000"/></svg>'}},css:see}),x8=aee();var E8=()=>k(w(w({},Fm),XZ),{backgroundColor:"hsl(217, 0%, 17%)",foregroundColor:"#FFF",chromeBackgroundColor:Ti(.05),rowHoverColor:ln(.15),selectedRowBackgroundColor:ln(.2),menuBackgroundColor:Ti(.1),browserColorScheme:"dark",popupShadow:"0 0px 20px #000A",cardShadow:"0 1px 4px 1px #000A",advancedFilterBuilderJoinPillColor:"#7a3a37",advancedFilterBuilderColumnPillColor:"#355f2d",advancedFilterBuilderOptionPillColor:"#5a3168",advancedFilterBuilderValuePillColor:"#374c86",filterPanelApplyButtonColor:Jl,findMatchColor:Di,findActiveMatchColor:Di,checkboxUncheckedBorderColor:Ti(.4),toggleButtonOffBackgroundColor:Ti(.4),rowBatchEditBackgroundColor:Ti(.1)});var lee=()=>k(w({},E8()),{backgroundColor:"#1f2836"});var cee=()=>hn({feature:"colorScheme",params:Fm,modeParams:{light:Fm,dark:E8(),"dark-blue":lee()}}),P8=cee();var dee=`.ag-icon-aggregation:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M24 6H8v2l8 8-8 8v2h16v-2H11l8-8-8-8h13z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-arrows:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M7.515 11.171 2.687 16l4.828 4.829-1.414 1.414L-.142 16l6.243-6.243zm16.97 0 1.414-1.414L32.142 16l-6.243 6.243-1.414-1.414L29.313 16zM16.028 13.2l2.829 2.828-2.829 2.829-2.828-2.829zm-4.857 11.285L16 29.313l4.829-4.828 1.414 1.414L16 32.142l-6.243-6.243zm0-16.97L9.757 6.101 16-.142l6.243 6.243-1.414 1.414L16 2.687z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-asc:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m5.333 16 1.88 1.88 7.453-7.44v16.227h2.667V10.44l7.44 7.453L26.666 16 15.999 5.333 5.332 16z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-cancel:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M16 2.667A13.32 13.32 0 0 0 2.667 16c0 7.373 5.96 13.333 13.333 13.333S29.333 23.373 29.333 16 23.373 2.667 16 2.667m6.667 18.12-1.88 1.88L16 17.88l-4.787 4.787-1.88-1.88L14.12 16l-4.787-4.787 1.88-1.88L16 14.12l4.787-4.787 1.88 1.88L17.88 16z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-chart:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Ctitle%3Echart%3C/title%3E%3Cg fill='%23000' fill-rule='nonzero'%3E%3Cpath d='M14 7h4v18h-4zM8 17h4v8H8zM20 13h4v12h-4z'/%3E%3C/g%3E%3C/svg%3E")}.ag-icon-color-picker:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M23.907 17.587 10.574 4.254l-1.88 1.88 3.173 3.173-8.28 8.28 10.16 10.16zm-16.547 0 6.387-6.387 6.387 6.387zm18.387 2s-2.667 2.893-2.667 4.667c0 1.467 1.2 2.667 2.667 2.667s2.667-1.2 2.667-2.667c0-1.773-2.667-4.667-2.667-4.667' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-columns:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M26 25H6V7h20zM12 11H8v12h4zm6 0h-4v12h4zm6 12V11h-4v12z' style='fill-rule:nonzero' transform='translate(0 -1)'/%3E%3C/svg%3E")}.ag-icon-contracted:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m12 6 10 10-10 10-2-2 8-8-8-8z'/%3E%3C/svg%3E")}.ag-icon-copy:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M22 1.333H6A2.675 2.675 0 0 0 3.333 4v18.667H6V4h16zm4 5.334H11.333a2.675 2.675 0 0 0-2.667 2.667v18.667c0 1.467 1.2 2.667 2.667 2.667H26c1.467 0 2.667-1.2 2.667-2.667V9.334c0-1.467-1.2-2.667-2.667-2.667M26 28H11.333V9.333H26z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-cross:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M15.984 13.894 27.05 2.828l2.122 2.122-11.066 11.066 11.066 11.066-2.122 2.12-11.066-11.066L4.918 29.202l-2.12-2.12 11.066-11.066L2.798 4.95l2.12-2.122z'/%3E%3C/svg%3E")}.ag-icon-csv:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M384 131.9c-7.753-8.433-110.425-128.473-114.9-133L48-.1C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48zm-35.9 2.1H257V27.9zM30 479V27h200l1 105c0 13.3-1.3 29 12 29h111l1 318z' style='fill-rule:nonzero' transform='translate(3.934 -.054)scale(.06285)'/%3E%3Cpath d='M.688-.226a.2.2 0 0 1-.017.074.28.28 0 0 1-.145.14.412.412 0 0 1-.234.013.28.28 0 0 1-.202-.168.468.468 0 0 1-.04-.19q0-.086.025-.155a.319.319 0 0 1 .182-.191.4.4 0 0 1 .134-.025q.087 0 .155.035a.3.3 0 0 1 .104.085.17.17 0 0 1 .036.097.06.06 0 0 1-.018.044.06.06 0 0 1-.042.019.06.06 0 0 1-.042-.013.2.2 0 0 1-.031-.046.2.2 0 0 0-.066-.079.16.16 0 0 0-.095-.027.17.17 0 0 0-.142.068.3.3 0 0 0-.053.193.4.4 0 0 0 .023.139.2.2 0 0 0 .067.083.2.2 0 0 0 .1.027q.063 0 .106-.031a.2.2 0 0 0 .065-.091.2.2 0 0 1 .023-.046q.014-.018.044-.018a.06.06 0 0 1 .044.018.06.06 0 0 1 .019.045' style='fill-rule:nonzero' transform='matrix(8.39799 0 0 12.455 7.122 25.977)'/%3E%3Cpath d='M.622-.215a.2.2 0 0 1-.033.117.23.23 0 0 1-.098.081.4.4 0 0 1-.153.029.34.34 0 0 1-.175-.04.23.23 0 0 1-.079-.077.17.17 0 0 1-.031-.093q0-.027.019-.045a.06.06 0 0 1 .046-.019.06.06 0 0 1 .039.014.1.1 0 0 1 .027.044.3.3 0 0 0 .03.057q.015.023.044.038.03.015.076.015.065 0 .105-.03a.09.09 0 0 0 .04-.075.08.08 0 0 0-.022-.058.14.14 0 0 0-.056-.034 1 1 0 0 0-.092-.025.7.7 0 0 1-.129-.042.2.2 0 0 1-.083-.066.17.17 0 0 1-.03-.104q0-.058.032-.105a.2.2 0 0 1 .093-.07.4.4 0 0 1 .144-.025q.066 0 .114.016a.3.3 0 0 1 .08.044.2.2 0 0 1 .046.057q.015.03.015.058a.07.07 0 0 1-.018.046.06.06 0 0 1-.046.021q-.025 0-.038-.012a.2.2 0 0 1-.028-.041.2.2 0 0 0-.047-.063Q.387-.625.326-.625a.15.15 0 0 0-.09.025q-.035.024-.035.059 0 .021.012.037a.1.1 0 0 0 .032.027.4.4 0 0 0 .111.036q.06.015.11.031.048.018.083.042a.2.2 0 0 1 .054.062.2.2 0 0 1 .019.091' style='fill-rule:nonzero' transform='matrix(8.39799 0 0 12.455 13.339 25.977)'/%3E%3Cpath d='m.184-.633.162.48.163-.483q.013-.038.019-.053a.062.062 0 0 1 .061-.039q.018 0 .034.009a.1.1 0 0 1 .025.025q.009.015.009.031L.654-.64l-.007.025-.009.024-.173.468-.019.051a.2.2 0 0 1-.021.042.1.1 0 0 1-.033.03.1.1 0 0 1-.049.012.1.1 0 0 1-.05-.011A.1.1 0 0 1 .26-.03a.2.2 0 0 1-.021-.042L.22-.123.05-.587.041-.612.033-.638.03-.662q0-.025.02-.046a.07.07 0 0 1 .05-.02q.037 0 .053.023.015.023.031.072' style='fill-rule:nonzero' transform='matrix(8.39799 0 0 12.455 18.94 25.977)'/%3E%3C/svg%3E")}.ag-icon-cut:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M13.775 15.198 3.835 2.945a1.501 1.501 0 0 1 2.33-1.89l14.997 18.488A6.003 6.003 0 0 1 29.657 25c0 3.311-2.688 6-6 6s-6-2.689-6-6c0-1.335.437-2.569 1.176-3.566l-3.127-3.855-3.001 3.7A5.97 5.97 0 0 1 14 25c0 3.311-2.689 6-6 6s-6-2.689-6-6a6.003 6.003 0 0 1 8.315-5.536zm9.882 6.702a3.1 3.1 0 0 0-3.1 3.1c0 1.711 1.389 3.1 3.1 3.1s3.1-1.389 3.1-3.1-1.389-3.1-3.1-3.1M8 21.95a3.05 3.05 0 1 0 .001 6.101A3.05 3.05 0 0 0 8 21.95m9.63-11.505 1.932 2.381 8.015-9.881a1.5 1.5 0 0 0-2.329-1.89z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-desc:before,.ag-icon-down:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m26.667 16-1.88-1.88-7.453 7.44V5.333h-2.667V21.56l-7.44-7.453L5.334 16l10.667 10.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-excel:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M384 131.9c-7.753-8.433-110.425-128.473-114.9-133L48-.1C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48zm-35.9 2.1H257V27.9zM30 479V27h200l1 105c0 13.3-1.3 29 12 29h111l1 318z' style='fill-rule:nonzero' transform='translate(3.934 -.054)scale(.06285)'/%3E%3Cpath d='m.052-.139.16-.234-.135-.208a.4.4 0 0 1-.028-.052.1.1 0 0 1-.01-.042.05.05 0 0 1 .018-.037.07.07 0 0 1 .045-.016q.03 0 .047.018a1 1 0 0 1 .047.066l.107.174.115-.174.024-.038.019-.026.021-.015a.1.1 0 0 1 .027-.005.06.06 0 0 1 .044.016.05.05 0 0 1 .018.039q0 .033-.038.089l-.141.211.152.234a.3.3 0 0 1 .03.051.1.1 0 0 1 .009.038.1.1 0 0 1-.008.031.1.1 0 0 1-.024.023.1.1 0 0 1-.034.008.1.1 0 0 1-.035-.008.1.1 0 0 1-.023-.022L.427-.067.301-.265l-.134.204-.022.034-.016.019a.1.1 0 0 1-.022.015.1.1 0 0 1-.03.005.06.06 0 0 1-.044-.016.06.06 0 0 1-.017-.047q0-.036.036-.088' style='fill-rule:nonzero' transform='matrix(17.82892 0 0 16.50777 10.371 25.928)'/%3E%3C/svg%3E")}.ag-icon-expanded:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M20 26 10 16 20 6l2 2-8 8 8 8z'/%3E%3C/svg%3E")}.ag-icon-eye-slash:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Ctitle%3Eeye-slash%3C/title%3E%3Cpath fill='%23000' fill-rule='nonzero' d='M8.95 10.364 7 8.414 8.414 7l2.32 2.32A13.2 13.2 0 0 1 16.5 8c5.608 0 10.542 3.515 12.381 8.667L29 17l-.119.333a13 13 0 0 1-4.255 5.879l1.466 1.466-1.414 1.414-1.754-1.753A13.2 13.2 0 0 1 16.5 26c-5.608 0-10.542-3.515-12.381-8.667L4 17l.119-.333a13 13 0 0 1 4.83-6.303m1.445 1.445A11.02 11.02 0 0 0 6.148 17c1.646 4.177 5.728 7 10.352 7 1.76 0 3.441-.409 4.94-1.146l-1.878-1.878A5.06 5.06 0 0 1 16.5 22c-2.789 0-5.05-2.239-5.05-5 0-1.158.398-2.223 1.065-3.07zm1.855-.974 1.794 1.795A5.07 5.07 0 0 1 16.5 12c2.789 0 5.05 2.239 5.05 5 0 .9-.24 1.745-.661 2.474l2.305 2.306A11 11 0 0 0 26.852 17c-1.646-4.177-5.728-7-10.352-7-1.495 0-2.933.295-4.25.835'/%3E%3C/svg%3E")}.ag-icon-eye:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M16.5 23c4.624 0 8.706-2.823 10.352-7-1.646-4.177-5.728-7-10.352-7s-8.706 2.823-10.352 7c1.646 4.177 5.728 7 10.352 7M4.119 15.667C5.958 10.515 10.892 7 16.5 7s10.542 3.515 12.381 8.667L29 16l-.119.333C27.042 21.485 22.108 25 16.5 25S5.958 21.485 4.119 16.333L4 16zM16.5 21c2.789 0 5.049-2.239 5.049-5s-2.26-5-5.049-5-5.049 2.239-5.049 5 2.26 5 5.049 5' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-filter:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m28 8-8 8v5l-6 6V16L6 8V6h22zM9 8l7 7v7l2-2v-5l7-7z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-first:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M24.273 22.12 18.153 16l6.12-6.12L22.393 8l-8 8 8 8zM7.727 8h2.667v16H7.727z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-group:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M14 7v1H9V7zm0-3v1H5.001V4zm-7 7H5v-1h2zm0-3H5V7h2zM3 5H1V4h2zm11 5v1H9v-1zm-7 4H5v-1h2zm7-1v1H9v-1z' style='fill-rule:nonzero' transform='matrix(2 0 0 2 0 -2)'/%3E%3C/svg%3E")}.ag-icon-last:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m7.727 9.88 6.12 6.12-6.12 6.12L9.607 24l8-8-8-8zM21.607 8h2.667v16h-2.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-left:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M26.667 14.667H10.44l7.453-7.453L16 5.334 5.333 16.001 16 26.668l1.88-1.88-7.44-7.453h16.227z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-linked:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M5.2 16a4.136 4.136 0 0 1 4.133-4.133h5.333V9.334H9.333a6.67 6.67 0 0 0-6.667 6.667 6.67 6.67 0 0 0 6.667 6.667h5.333v-2.533H9.333A4.136 4.136 0 0 1 5.2 16.002zm5.467 1.333h10.667v-2.667H10.667zm12-8h-5.333v2.533h5.333a4.136 4.136 0 0 1 4.133 4.133 4.136 4.136 0 0 1-4.133 4.133h-5.333v2.533h5.333a6.67 6.67 0 0 0 6.667-6.667 6.67 6.67 0 0 0-6.667-6.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-loading:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M17 29h-2v-8h2zm-3.586-9L7 26.414 5.586 25 12 18.586zm13 5L25 26.414 18.586 20 20 18.586zM29 17h-8v-2h8zm-18 0H3v-2h8zm2.414-5L12 13.414 5.586 7 7 5.586zm13-5L20 13.414 18.586 12 25 5.586zM17 11h-2V3h2z' style='fill-rule:nonzero' transform='translate(-3.692 -3.692)scale(1.23077)'/%3E%3C/svg%3E")}.ag-icon-maximize:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M14 30H2V18h2.828v7.05l8.254-8.252 2.12 2.12-8.252 8.254H14zm4-28h12v12h-2.828V6.95l-8.254 8.252-2.12-2.12 8.252-8.254H18z'/%3E%3C/svg%3E")}.ag-icon-menu:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M20 13H0v-2h20zm0-6H0V5h20zm0-6H0v-2h20z' style='fill-rule:nonzero' transform='translate(6 9)'/%3E%3C/svg%3E")}.ag-icon-menu-alt:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='%23000' d='M16 19a3 3 0 1 0 0-6 3 3 0 0 0 0 6M16 11a3 3 0 1 0 0-6 3 3 0 0 0 0 6M16 27a3 3 0 1 0 0-6 3 3 0 0 0 0 6'/%3E%3C/svg%3E")}.ag-icon-minimize:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M2 18h12v12h-2.828v-7.05l-8.254 8.252-2.12-2.12 8.252-8.254H2zm28-4H18V2h2.828v7.05L29.082.798l2.12 2.12-8.252 8.254H30z'/%3E%3C/svg%3E")}.ag-icon-minus:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M6.572 6.572a13.32 13.32 0 0 0 0 18.856 13.32 13.32 0 0 0 18.856 0 13.32 13.32 0 0 0 0-18.856 13.32 13.32 0 0 0-18.856 0m17.527 8.099v2.658H7.901v-2.658z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-next:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M10.94 6 9.06 7.88 17.167 16 9.06 24.12 10.94 26l10-10z' style='fill-rule:nonzero' transform='translate(1)'/%3E%3C/svg%3E")}.ag-icon-none:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Ctitle%3Enone%3C/title%3E%3Cg fill='%23000' fill-rule='nonzero'%3E%3Cpath d='M23.708 14.645 16 6.939l-7.708 7.706 1.416 1.416L16 9.767l6.292 6.294zM23.708 20.355 16 28.061l-7.708-7.706 1.416-1.416L16 25.233l6.292-6.294z'/%3E%3C/g%3E%3C/svg%3E")}.ag-icon-not-allowed:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M16 2.667C8.64 2.667 2.667 8.64 2.667 16S8.64 29.333 16 29.333 29.333 23.36 29.333 16 23.36 2.667 16 2.667M5.333 16c0-5.893 4.773-10.667 10.667-10.667 2.467 0 4.733.84 6.533 2.253L7.586 22.533A10.54 10.54 0 0 1 5.333 16M16 26.667c-2.467 0-4.733-.84-6.533-2.253L24.414 9.467A10.54 10.54 0 0 1 26.667 16c0 5.893-4.773 10.667-10.667 10.667' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-paste:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M25.334 4H19.76C19.2 2.453 17.733 1.333 16 1.333S12.8 2.453 12.24 4H6.667A2.675 2.675 0 0 0 4 6.667V28c0 1.467 1.2 2.667 2.667 2.667h18.667c1.467 0 2.667-1.2 2.667-2.667V6.667C28.001 5.2 26.801 4 25.334 4M16 4c.733 0 1.333.6 1.333 1.333s-.6 1.333-1.333 1.333-1.333-.6-1.333-1.333S15.267 4 16 4m9.333 24H6.666V6.667h2.667v4h13.333v-4h2.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-pin:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m10.78 19.777-4.668-4.666s.032-1 .67-1.87c1.366-1.86 4.052-1.96 6.056-1.572l3.158-3.108c-.7-2.342 3.352-5.046 3.352-5.046l9.166 9.168q-.334.447-.67.894c-1.074 1.426-2.538 2.63-4.272 2.338l-3.32 3.218c.046.344.042.03.118 1.152.144 2.13-.64 4.324-2.632 5.34l-.746.364-4.798-4.798-7.292 7.294-1.416-1.416zm8.24-13.672c-.688.568-1.416 1.45-1.024 2.072l.49.722-4.986 4.988c-1.988-.506-4.346-.636-5.156.614l9.02 9.032q.14-.099.272-.21c1.226-1.08.764-3.04.498-4.9l4.79-4.79s1.47.938 2.936-.776l-6.79-6.79q-.026.019-.05.038' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-pivot:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M25.128 2.002c2.56.096 4.772 2.292 4.87 4.87a712 712 0 0 1 0 18.256c-.096 2.56-2.292 4.772-4.87 4.87a712 712 0 0 1-18.256 0c-2.558-.096-4.772-2.29-4.87-4.87a712 712 0 0 1 0-18.256c.096-2.56 2.292-4.772 4.87-4.87a712 712 0 0 1 18.256 0m2.966 7.954H9.892v18.136c5.086.13 10.18.098 15.264-.096 1.48-.094 2.746-1.35 2.84-2.84.192-5.064.226-10.134.098-15.2M3.968 24.1q.015.528.036 1.056c.094 1.484 1.354 2.746 2.84 2.84l1.012.036V24.1zM22 15.414l-.292.294-1.416-1.416L23 11.586l2.708 2.706-1.416 1.416-.292-.294v3.592c-.032 2.604-2.246 4.892-4.872 4.992L15.414 24l.294.292-1.416 1.416L11.586 23l2.706-2.708 1.416 1.416-.322.32c3.372.03 6.578-.164 6.614-3.034zM3.88 18.038c.002 1.346.012 2.694.038 4.04h3.938v-4.04zm.05-6.062a681 681 0 0 0-.044 4.042h3.97v-4.042zm5.962-7.99Q8.449 3.999 7.006 4c-1.57.02-2.946 1.348-3.004 2.922q-.02 1.517-.042 3.034h3.896v-2.02h2.036zm14.244-.016v3.966h3.898q-.017-.546-.038-1.092c-.094-1.48-1.35-2.746-2.84-2.84q-.51-.019-1.02-.034m-8.14-.054q-2.035.022-4.07.048v3.972h4.07zm6.106.008a213 213 0 0 0-4.07-.022v4.034h4.07z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-plus:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M6.572 6.572a13.32 13.32 0 0 0 0 18.856 13.32 13.32 0 0 0 18.856 0 13.32 13.32 0 0 0 0-18.856 13.32 13.32 0 0 0-18.856 0m17.527 8.099v2.658h-6.77v6.77h-2.658v-6.77h-6.77v-2.658h6.77v-6.77h2.658v6.77z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-previous:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M21.94 7.88 20.06 6l-10 10 10 10 1.88-1.88L13.833 16z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-right:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m16 5.333-1.88 1.88 7.44 7.453H5.333v2.667H21.56l-7.44 7.453 1.88 1.88 10.667-10.667L16 5.332z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-save:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M15.708 2.355 8 10.061.292 2.355 1.708.939 8 7.233 14.292.939z' style='fill-rule:nonzero' transform='translate(8 14)'/%3E%3Cpath d='M5 26h22v2H5zM15 4h2v18h-2z'/%3E%3C/svg%3E")}.ag-icon-small-down:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M7.334 10.667 16 21.334l8.667-10.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-small-left:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M21.333 7.334 10.666 16l10.667 8.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-small-right:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M10.667 24.666 21.334 16 10.667 7.333z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-small-up:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M7.334 21.333 16 10.666l8.667 10.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-tick:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M11.586 22.96 27.718 6.828 29.84 8.95 11.586 27.202 2.4 18.016l2.12-2.122z'/%3E%3C/svg%3E")}.ag-icon-tree-closed:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m11.94 6-1.88 1.88L18.167 16l-8.107 8.12L11.94 26l10-10z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-tree-indeterminate:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M6 13.5h20v3H6z'/%3E%3C/svg%3E")}.ag-icon-tree-open:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M24.12 9.06 16 17.167 7.88 9.06 6 10.94l10 10 10-10z' style='fill-rule:nonzero' transform='translate(0 1)'/%3E%3C/svg%3E")}.ag-icon-unlinked:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M22.667 9.333h-5.333v2.533h5.333a4.136 4.136 0 0 1 4.133 4.133c0 1.907-1.307 3.507-3.08 3.973l1.947 1.947c2.173-1.107 3.667-3.32 3.667-5.92a6.67 6.67 0 0 0-6.667-6.667zm-1.334 5.334h-2.92l2.667 2.667h.253zM2.667 5.693 6.814 9.84A6.65 6.65 0 0 0 2.667 16a6.67 6.67 0 0 0 6.667 6.667h5.333v-2.533H9.334a4.136 4.136 0 0 1-4.133-4.133c0-2.12 1.613-3.867 3.68-4.093l2.76 2.76h-.973v2.667h3.64l3.027 3.027v2.307h2.307l5.347 5.333 1.68-1.68L4.362 4.002 2.669 5.695z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-up:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m5.333 16 1.88 1.88 7.453-7.44v16.227h2.667V10.44l7.44 7.453L26.666 16 15.999 5.333 5.332 16z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-grip:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M8 24H6v-4h2zm6 0h-2v-4h2zm6 0h-2v-4h2zm6 0h-2v-4h2zM8 18H6v-4h2zm6 0h-2v-4h2zm6 0h-2v-4h2zm6 0h-2v-4h2zM8 12H6V8h2zm6 0h-2V8h2zm6 0h-2V8h2zm6 0h-2V8h2z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-settings:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='%23000' d='M30 8h-4.1c-.5-2.3-2.5-4-4.9-4s-4.4 1.7-4.9 4H2v2h14.1c.5 2.3 2.5 4 4.9 4s4.4-1.7 4.9-4H30zm-9 4c-1.7 0-3-1.3-3-3s1.3-3 3-3 3 1.3 3 3-1.3 3-3 3M2 24h4.1c.5 2.3 2.5 4 4.9 4s4.4-1.7 4.9-4H30v-2H15.9c-.5-2.3-2.5-4-4.9-4s-4.4 1.7-4.9 4H2zm9-4c1.7 0 3 1.3 3 3s-1.3 3-3 3-3-1.3-3-3 1.3-3 3-3'/%3E%3C/svg%3E")}.ag-icon-column-arrow:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M11 4a1 1 0 0 1 1 1v22a1 1 0 1 1-2 0V5a1 1 0 0 1 1-1' clip-rule='evenodd'/%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M2 13a1 1 0 0 1 1-1h23.5a1 1 0 1 1 0 2H3a1 1 0 0 1-1-1' clip-rule='evenodd'/%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M2 4h18v24H2zm2 2v20h14V6zM26.793 13 23 9.207l1.414-1.414L29.621 13l-5.207 5.207L23 16.793z' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-un-pin:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='m6.112 15.111 3.272 3.271 1.436-1.402-2.476-2.479c.81-1.25 3.168-1.12 5.156-.614l4.986-4.988-.49-.722c-.392-.622.336-1.504 1.024-2.072l.008-.007.01-.006.032-.025 1.447 1.447 1.432-1.397-2.601-2.602s-4.052 2.704-3.352 5.046l-3.158 3.108c-2.004-.388-4.69-.288-6.056 1.572-.638.87-.67 1.87-.67 1.87m.581 11.582.014.014 5.502-5.501 4.783 4.783.746-.364c1.992-1.016 2.776-3.21 2.632-5.34-.055-.805-.068-.87-.088-.97-.008-.04-.017-.085-.03-.182l3.32-3.218c1.734.292 3.198-.912 4.272-2.338q.337-.447.67-.894l-.001-.001-.007-.007-.007-.007-.007-.007-3.87-3.87 1.585-1.584-1.414-1.414-14.381 14.38-1.237 1.209-5.69 5.687 1.417 1.416zM23.21 10.206l2.65 2.651c-1.465 1.714-2.935.776-2.935.776l-4.79 4.79q.041.291.087.583c.257 1.676.513 3.35-.585 4.317a4 4 0 0 1-.272.21l-3.739-3.744z' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-pinned-top:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' d='m16.708 10.878 8.708 8.706L24 21l-6.292-6.294V27h-2V14.706L9.416 21 8 19.584q4.348-4.344 8.691-8.69zM25 6H8v2h17z'/%3E%3C/svg%3E")}.ag-icon-pinned-bottom:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' d='M16.708 22.122 8 13.416 9.416 12l6.292 6.294V6h2v12.294L24 12l1.416 1.416-8.691 8.69zM7.416 28h17v-2h-17z'/%3E%3C/svg%3E")}.ag-icon-chevron-up:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' viewBox='0 0 16 16'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M3.479 10.521a.75.75 0 0 1 0-1.06l4-4a.75.75 0 0 1 1.06 0l4 4a.75.75 0 0 1-1.06 1.06l-3.47-3.47-3.47 3.47a.75.75 0 0 1-1.06 0' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-chevron-down:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' viewBox='0 0 16 16'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M12.521 5.461a.75.75 0 0 1 0 1.06l-4 4a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 0 1 1.06-1.06l3.47 3.47 3.47-3.47a.75.75 0 0 1 1.06 0' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-chevron-left:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' viewBox='0 0 16 16'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M10.53 12.512a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 0 1 0-1.06l4-4a.75.75 0 0 1 1.06 1.06l-3.47 3.47 3.47 3.47a.75.75 0 0 1 0 1.06' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-chevron-right:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' viewBox='0 0 16 16'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M5.47 3.47a.75.75 0 0 1 1.06 0l4 4a.75.75 0 0 1 0 1.06l-4 4a.75.75 0 0 1-1.06-1.06L8.94 8 5.47 4.53a.75.75 0 0 1 0-1.06' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-filter-add:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' d='M19.834 8H8c0 .304.06.612.258.842 2.716 2.854 6.682 5.548 6.742 7.974V21l2-1.5v-2.684c.056-2.267 2.968-4.417 5.49-6.75v3.087c-1.081.974-2.245 1.968-3.232 3.005a1.05 1.05 0 0 0-.258.682v3.66L13 25c0-2.74.066-5.482-.002-8.222a1.05 1.05 0 0 0-.256-.62C10.026 13.304 6.06 10.61 6 8.184V6h13.834z'/%3E%3Cpath fill='currentColor' d='M26 6h2.946v2.002H26v3.313h-2.002V8.002h-2.946V6h2.946V3.04H26z'/%3E%3C/svg%3E")}.ag-icon-edit:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' d='M6.222 25.778h1.611l14.834-14.811-1.611-1.611-14.834 14.81zM4 28v-4.733L22.644 4.656a2.26 2.26 0 0 1 1.567-.634q.423 0 .833.167.412.166.734.478l1.589 1.6q.333.322.483.733t.15.822q0 .423-.161.839-.162.416-.472.728L8.733 28zm17.856-17.833-.8-.811 1.61 1.61z'/%3E%3C/svg%3E")}`,uee=hn({feature:"iconSet",css:dee});var R8={aggregation:'<path d="M18 7V4H6l6 8-6 8h12v-3"/>',arrows:'<polyline points="5 9 2 12 5 15"/><polyline points="9 5 12 2 15 5"/><polyline points="15 19 12 22 9 19"/><polyline points="19 9 22 12 19 15"/><line x1="2" x2="22" y1="12" y2="12"/><line x1="12" x2="12" y1="2" y2="22"/>',asc:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',cancel:'<path d="m18 6-12 12"/><path d="m6 6 12 12"/>',chart:'<line x1="18" x2="18" y1="20" y2="10"/><line x1="12" x2="12" y1="20" y2="4"/><line x1="6" x2="6" y1="20" y2="14"/>',"color-picker":'<path d="m19 11-8-8-8.6 8.6a2 2 0 0 0 0 2.8l5.2 5.2c.8.8 2 .8 2.8 0L19 11Z"/><path d="m5 2 5 5"/><path d="M2 13h15"/><path d="M22 20a2 2 0 1 1-4 0c0-1.6 1.7-2.4 2-4 .3 1.6 2 2.4 2 4Z"/>',columns:'<path d="M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18"/>',contracted:'<path d="m9 18 6-6-6-6"/>',copy:'<rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/>',cross:'<path d="M18 6 6 18"/><path d="m6 6 12 12"/>',csv:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',cut:'<circle cx="6" cy="6" r="3"/><path d="M8.12 8.12 12 12"/><path d="M20 4 8.12 15.88"/><circle cx="6" cy="18" r="3"/><path d="M14.8 14.8 20 20"/>',desc:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',down:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',excel:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',expanded:'<path d="m15 18-6-6 6-6"/>',"eye-slash":'<path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"/><line x1="2" x2="22" y1="2" y2="22"/>',eye:'<path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/>',filter:'<path d="M3 6h18"/><path d="M7 12h10"/><path d="M10 18h4"/>',first:'<path d="m17 18-6-6 6-6"/><path d="M7 6v12"/>',group:'<path d="M16 12H3"/><path d="M16 18H3"/><path d="M10 6H3"/><path d="M21 18V8a2 2 0 0 0-2-2h-5"/><path d="m16 8-2-2 2-2"/>',last:'<path d="m7 18 6-6-6-6"/><path d="M17 6v12"/>',left:'<path d="m12 19-7-7 7-7"/><path d="M19 12H5"/>',linked:'<path d="M9 17H7A5 5 0 0 1 7 7h2"/><path d="M15 7h2a5 5 0 1 1 0 10h-2"/><line x1="8" x2="16" y1="12" y2="12"/>',loading:'<line x1="12" x2="12" y1="2" y2="6"/><line x1="12" x2="12" y1="18" y2="22"/><line x1="4.93" x2="7.76" y1="4.93" y2="7.76"/><line x1="16.24" x2="19.07" y1="16.24" y2="19.07"/><line x1="2" x2="6" y1="12" y2="12"/><line x1="18" x2="22" y1="12" y2="12"/><line x1="4.93" x2="7.76" y1="19.07" y2="16.24"/><line x1="16.24" x2="19.07" y1="7.76" y2="4.93"/>',maximize:'<polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" x2="14" y1="3" y2="10"/><line x1="3" x2="10" y1="21" y2="14"/>',menu:'<line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/>',"menu-alt":'<circle cx="12" cy="5" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="12" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="19" r="0.75" fill="#D9D9D9"/>',minimize:'<polyline points="4 14 10 14 10 20"/><polyline points="20 10 14 10 14 4"/><line x1="14" x2="21" y1="10" y2="3"/><line x1="3" x2="10" y1="21" y2="14"/>',minus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/>',next:'<path d="m9 18 6-6-6-6"/>',none:'<path d="m7 15 5 5 5-5"/><path d="m7 9 5-5 5 5"/>',"not-allowed":'<circle cx="12" cy="12" r="10"/><path d="m4.9 4.9 14.2 14.2"/>',paste:'<path d="M15 2H9a1 1 0 0 0-1 1v2c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V3c0-.6-.4-1-1-1Z"/><path d="M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M16 4h2a2 2 0 0 1 2 2v2M11 14h10"/><path d="m17 10 4 4-4 4"/>',pin:'<line x1="12" x2="12" y1="17" y2="22"/><path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"/>',pivot:'<path d="M15 3v18"/><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M21 9H3"/><path d="M21 15H3"/>',plus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/><path d="M12 8v8"/>',previous:'<path d="m15 18-6-6 6-6"/>',right:'<path d="M5 12h14"/><path d="m12 5 7 7-7 7"/>',save:'<path d="M12 17V3"/><path d="m6 11 6 6 6-6"/><path d="M19 21H5"/>',"small-left":'<path d="m15 18-6-6 6-6"/>',"small-right":'<path d="m9 18 6-6-6-6"/>',tick:'<path d="M20 6 9 17l-5-5"/>',"tree-closed":'<path d="m9 18 6-6-6-6"/>',"tree-indeterminate":'<path d="M5 12h14"/>',"tree-open":'<path d="m6 9 6 6 6-6"/>',unlinked:'<path d="M9 17H7A5 5 0 0 1 7 7"/><path d="M15 7h2a5 5 0 0 1 4 8"/><line x1="8" x2="12" y1="12" y2="12"/><line x1="2" x2="22" y1="2" y2="22"/>',up:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',grip:'<circle cx="5" cy="8" r="0.5"/><circle cx="12" cy="8" r="0.5"/><circle cx="19" cy="8" r="0.5"/><circle cx="5" cy="16" r="0.5"/><circle cx="12" cy="16" r="0.5"/><circle cx="19" cy="16" r="0.5"/><g stroke="none" fill="currentColor"><circle cx="5" cy="8" r="1"/><circle cx="12" cy="8" r="1"/><circle cx="19" cy="8" r="1"/><circle cx="5" cy="16" r="1"/><circle cx="12" cy="16" r="1"/><circle cx="19" cy="16" r="1"/></g>',settings:'<path d="M20 7h-9"/><path d="M14 17H5"/><circle cx="17" cy="17" r="3"/><circle cx="7" cy="7" r="3"/>'},_8={"column-arrow":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" viewBox="0 0 32 32"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 26C0 28.2092 1.79086 30 4 30H14C16.2091 30 18 28.2092 18 26V15H25.8786L24.4394 16.4393C23.8536 17.0251 23.8536 17.9749 24.4394 18.5607C25.0252 19.1464 25.9748 19.1464 26.5606 18.5607L30.5606 14.5607C31.1464 13.9749 31.1464 13.0251 30.5606 12.4393L26.5606 8.43934C25.9748 7.85356 25.0252 7.85356 24.4394 8.43934C23.8536 9.02512 23.8536 9.97488 24.4394 10.5607L25.8786 12H18V6C18 3.79086 16.2091 2 14 2H4C1.79086 2 0 3.79086 0 6V26ZM14 5H10.5V12H15V6C15 5.44772 14.5523 5 14 5ZM4 5H7.5V12H3V6C3 5.44772 3.44772 5 4 5ZM10.5 15H15V26C15 26.5522 14.5523 27 14 27H10.5V15ZM4 27H7.5V15H3V26C3 26.5522 3.44772 27 4 27Z" fill="currentColor"/></svg>',"small-down":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 10.667 16 21.334l8.667-10.667H7.334Z"/></svg>',"small-up":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 21.333 16 10.666l8.667 10.667H7.334Z"/></svg>',"pinned-top":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M12.53 3.72A.75.75 0 0 1 12 5H4a.75.75 0 0 1 0-1.5h8a.75.75 0 0 1 .53.22ZM3.269 10.744a.75.75 0 0 1 .2-.524l4-4a.75.75 0 0 1 1.06 0l4 4a.75.75 0 1 1-1.06 1.06L8.75 8.56V14a.75.75 0 0 1-1.5 0V8.56l-2.72 2.72a.75.75 0 0 1-1.26-.536Z"/></svg>',"pinned-bottom":'<svg xmlns="http://www.w3.org/2000/svg" fill="none" class="ag-icon" viewBox="0 0 16 16"><path fill="currentColor" d="M3.47 12.28A.75.75 0 0 1 4 11h8a.75.75 0 0 1 0 1.5H4a.75.75 0 0 1-.53-.22ZM12.731 5.256a.75.75 0 0 1-.2.524l-4 4a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 1 1 1.06-1.06l2.72 2.72V2a.75.75 0 0 1 1.5 0v5.44l2.72-2.72a.75.75 0 0 1 1.26.536Z"/></svg>',"un-pin":'<svg xmlns="http://www.w3.org/2000/svg" fill="none" class="ag-icon" viewBox="0 0 16 16"><path fill="currentColor" d="M8 11a.75.75 0 0 0-.75.75v3.333a.75.75 0 1 0 1.5 0V11.75A.75.75 0 0 0 8 11Z"/><path fill="currentColor" d="M13.11 1.436a.75.75 0 0 0-1.22-.872l-10 14a.75.75 0 1 0 1.22.872L5.207 12.5h7.376a.75.75 0 0 0 .75-.75v-1.174a2.08 2.08 0 0 0-1.153-1.863l-1.185-.599-.005-.002a.58.58 0 0 1-.323-.522V5.165a2.083 2.083 0 0 0 1.854-2.904l.589-.825Zm-3.943 5.52v.634a2.08 2.08 0 0 0 1.153 1.863l1.185.6.005.002a.58.58 0 0 1 .323.522V11H6.28l2.887-4.044ZM9.277 1H5.25a2.084 2.084 0 0 0-.083 4.165v1.676l1.5-2.132v-.292a.75.75 0 0 0-.75-.75H5.25a.584.584 0 0 1 0-1.167h2.972L9.277 1Z"/></svg>',"chevron-down":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 6L8 10L4 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-up":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 10L8 6L12 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-left":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 12L6 8L10 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-right":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"filter-add":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.12126 7.75L10.8517 7.75" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M6.65934 11.748L9.32778 11.748" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M12.2943 1.04872V6.19184M14.9886 3.74341H9.68478" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M8.25488 3C8.04799 3.18323 7.91706 3.45099 7.91699 3.74902C7.91713 4.04868 8.04988 4.31681 8.25879 4.5H2C1.58579 4.5 1.25 4.16421 1.25 3.75C1.25 3.33579 1.58579 3 2 3H8.25488Z" fill="currentColor"/></svg>',edit:'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 10.6262V12.5012H5.375L10.905 6.97122L9.03 5.09622L3.5 10.6262ZM12.355 5.52122C12.4014 5.47497 12.4381 5.42002 12.4632 5.35953C12.4883 5.29905 12.5012 5.23421 12.5012 5.16872C12.5012 5.10324 12.4883 5.0384 12.4632 4.97791C12.4381 4.91742 12.4014 4.86248 12.355 4.81622L11.185 3.64622C11.1387 3.59987 11.0838 3.5631 11.0233 3.53801C10.9628 3.51291 10.898 3.5 10.8325 3.5C10.767 3.5 10.7022 3.51291 10.6417 3.53801C10.5812 3.5631 10.5263 3.59987 10.48 3.64622L9.565 4.56122L11.44 6.43622L12.355 5.52122Z" fill="currentColor"/></svg>'},hee=(t={})=>{let e="";for(let i of[...Object.keys(R8),...Object.keys(_8)]){let n=pee(i,t.strokeWidth);e+=`.ag-icon-${i}::before { mask-image: url('data:image/svg+xml,${encodeURIComponent(n)}'); }
`}return e},pee=(t,e=1.5)=>{let i=_8[t];if(i)return i;let n=R8[t];if(!n)throw new Error(`Missing icon data for ${t}`);return`<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="black" stroke-width="${e}" viewBox="0 0 24 24"><style>* { vector-effect: non-scaling-stroke; }</style>`+n+"</svg>"},fee=(t={})=>hn({feature:"iconSet",css:()=>hee(t)});var gee=fee();var mee=':where(.ag-input-field-input[type=number]:not(.ag-number-field-input-stepper)){-webkit-appearance:textfield;-moz-appearance:textfield;appearance:textfield;&::-webkit-inner-spin-button,&::-webkit-outer-spin-button{-webkit-appearance:none;appearance:none;margin:0}}.ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){background-color:var(--ag-input-background-color);border:var(--ag-input-border);border-radius:var(--ag-input-border-radius);color:var(--ag-input-text-color);font-family:inherit;font-size:inherit;line-height:inherit;margin:0;min-height:var(--ag-input-height);padding:0;&:where(:disabled){background-color:var(--ag-input-disabled-background-color);border:var(--ag-input-disabled-border);color:var(--ag-input-disabled-text-color)}&:where(:focus){background-color:var(--ag-input-focus-background-color);border:var(--ag-input-focus-border);box-shadow:var(--ag-input-focus-shadow);color:var(--ag-input-focus-text-color);outline:none}&:where(:invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&:where(.invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&::-moz-placeholder{color:var(--ag-input-placeholder-text-color)}&::placeholder{color:var(--ag-input-placeholder-text-color)}}:where(.ag-ltr) .ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){padding-left:var(--ag-input-padding-start)}:where(.ag-rtl) .ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){padding-right:var(--ag-input-padding-start)}:where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select){.ag-input-wrapper:before{background-color:currentcolor;color:var(--ag-input-icon-color);content:"";display:block;height:12px;-webkit-mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;opacity:.5;position:absolute;width:12px}}:where(.ag-ltr) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select){.ag-input-wrapper:before{margin-left:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-left:calc(var(--ag-spacing)*1.5 + 12px)}}:where(.ag-rtl) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select){.ag-input-wrapper:before{margin-right:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-right:calc(var(--ag-spacing)*1.5 + 12px)}}',vee=".ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){&:focus{box-shadow:var(--ag-focus-shadow);&:where(.invalid),&:where(:invalid){box-shadow:var(--ag-focus-error-shadow)}}}";var Cee={inputBackgroundColor:"transparent",inputBorder:!1,inputBorderRadius:0,inputTextColor:{ref:"textColor"},inputPlaceholderTextColor:{ref:"inputTextColor",mix:.5},inputPaddingStart:0,inputHeight:{calc:"max(iconSize, fontSize) + spacing * 2"},inputFocusBackgroundColor:{ref:"inputBackgroundColor"},inputFocusBorder:{ref:"inputBorder"},inputFocusShadow:"none",inputFocusTextColor:{ref:"inputTextColor"},inputDisabledBackgroundColor:{ref:"inputBackgroundColor"},inputDisabledBorder:{ref:"inputBorder"},inputDisabledTextColor:{ref:"inputTextColor"},inputInvalidBackgroundColor:{ref:"inputBackgroundColor"},inputInvalidBorder:{ref:"inputBorder"},inputInvalidTextColor:{ref:"inputTextColor"},inputIconColor:{ref:"inputTextColor"},pickerButtonBorder:!1,pickerButtonFocusBorder:{ref:"inputFocusBorder"},pickerButtonBackgroundColor:{ref:"backgroundColor"},pickerButtonFocusBackgroundColor:{ref:"backgroundColor"},pickerListBorder:!1,pickerListBackgroundColor:{ref:"backgroundColor"},colorPickerThumbSize:18,colorPickerTrackSize:12,colorPickerThumbBorderWidth:3,colorPickerTrackBorderRadius:12,colorPickerColorBorderRadius:4};var wee=()=>hn({feature:"inputStyle",params:k(w({},Cee),{inputBackgroundColor:Di,inputBorder:!0,inputBorderRadius:{ref:"borderRadius"},inputPaddingStart:{ref:"spacing"},inputFocusBorder:{color:Qt},inputFocusShadow:{ref:"focusShadow"},inputDisabledBackgroundColor:Ti(.06),inputDisabledTextColor:{ref:"textColor",mix:.5},inputInvalidBorder:{color:{ref:"invalidColor"}},pickerButtonBorder:!0,pickerListBorder:!0}),css:()=>mee+vee}),k8=wee();var F8='.ag-tabs-header{background-color:var(--ag-tab-bar-background-color);border-bottom:var(--ag-tab-bar-border);display:flex;flex:1;gap:var(--ag-tab-spacing);padding:var(--ag-tab-bar-top-padding) var(--ag-tab-bar-horizontal-padding) 0}.ag-tabs-header-wrapper{display:flex}.ag-tabs-close-button-wrapper{align-items:center;border:0;display:flex;padding:var(--ag-spacing)}:where(.ag-ltr) .ag-tabs-close-button-wrapper{border-right:solid var(--ag-border-width) var(--ag-border-color)}:where(.ag-rtl) .ag-tabs-close-button-wrapper{border-left:solid var(--ag-border-width) var(--ag-border-color)}.ag-tabs-close-button{background-color:unset;border:0;cursor:pointer;padding:0}.ag-tab{align-items:center;background-color:var(--ag-tab-background-color);border-left:var(--ag-tab-selected-border-width) solid transparent;border-right:var(--ag-tab-selected-border-width) solid transparent;color:var(--ag-tab-text-color);cursor:pointer;display:flex;flex:1;justify-content:center;padding:var(--ag-tab-top-padding) var(--ag-tab-horizontal-padding) var(--ag-tab-bottom-padding);position:relative;&:hover{background-color:var(--ag-tab-hover-background-color);color:var(--ag-tab-hover-text-color)}&.ag-tab-selected{background-color:var(--ag-tab-selected-background-color);color:var(--ag-tab-selected-text-color)}&:after{background-color:var(--ag-tab-selected-underline-color);bottom:0;content:"";display:block;height:var(--ag-tab-selected-underline-width);left:0;opacity:0;position:absolute;right:0;transition:opacity var(--ag-tab-selected-underline-transition-duration)}&.ag-tab-selected:after{opacity:1}}:where(.ag-ltr) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-left-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-right-color:var(--ag-tab-selected-border-color)}}}:where(.ag-rtl) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-right-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-left-color:var(--ag-tab-selected-border-color)}}}';var T8={tabBarBackgroundColor:"transparent",tabBarHorizontalPadding:0,tabBarTopPadding:0,tabBackgroundColor:"transparent",tabTextColor:{ref:"textColor"},tabHorizontalPadding:{ref:"spacing"},tabTopPadding:{ref:"spacing"},tabBottomPadding:{ref:"spacing"},tabSpacing:"0",tabHoverBackgroundColor:{ref:"tabBackgroundColor"},tabHoverTextColor:{ref:"tabTextColor"},tabSelectedBackgroundColor:{ref:"tabBackgroundColor"},tabSelectedTextColor:{ref:"tabTextColor"},tabSelectedBorderWidth:{ref:"borderWidth"},tabSelectedBorderColor:"transparent",tabSelectedUnderlineColor:"transparent",tabSelectedUnderlineWidth:0,tabSelectedUnderlineTransitionDuration:0,tabBarBorder:!1};var bee=()=>hn({feature:"tabStyle",params:k(w({},T8),{tabBarBorder:!0,tabBarBackgroundColor:Tn(.05),tabTextColor:{ref:"textColor",mix:.7},tabSelectedTextColor:{ref:"textColor"},tabHoverTextColor:{ref:"textColor"},tabSelectedBorderColor:{ref:"borderColor"},tabSelectedBackgroundColor:Di}),css:F8}),yee=bee();var See=()=>hn({feature:"tabStyle",params:k(w({},T8),{tabBarBorder:!0,tabBarBackgroundColor:{ref:"chromeBackgroundColor"},tabHoverTextColor:Qt,tabSelectedTextColor:Qt,tabSelectedUnderlineColor:Qt,tabSelectedUnderlineWidth:2,tabSelectedUnderlineTransitionDuration:"0.3s"}),css:F8}),xee=See();var Eee=()=>S8().withPart(x8).withPart(P8).withPart(gee).withPart(yee).withPart(k8).withPart(t2).withParams({fontFamily:[{googleFont:"IBM Plex Sans"},"-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu"]}),Pee=Eee(),Ree=()=>S8().withPart(iee).withPart(x8).withPart(P8).withPart(uee).withPart(xee).withPart(k8).withPart(t2).withParams({accentColor:"#2196f3",selectedRowBackgroundColor:ln(.3),inputFocusBorder:{color:ln(.4)},focusShadow:{radius:2,spread:1.6,color:ln(.4)},iconButtonHoverBackgroundColor:"transparent",iconButtonActiveBackgroundColor:"transparent",checkboxUncheckedBorderColor:Ti(.45),checkboxIndeterminateBackgroundColor:Ti(.45),checkboxIndeterminateBorderColor:Ti(.45),checkboxBorderWidth:2,checkboxBorderRadius:2,fontSize:13,dataFontSize:14,headerFontWeight:700,borderRadius:3,wrapperBorderRadius:3,tabSelectedUnderlineColor:Qt,tabSelectedBorderWidth:0,tabSelectedUnderlineTransitionDuration:.3,sideButtonSelectedUnderlineColor:Qt,sideButtonSelectedUnderlineWidth:2,sideButtonSelectedUnderlineTransitionDuration:.3,sideButtonBorder:!1,sideButtonSelectedBorder:!1,sideButtonBarTopPadding:{calc:"spacing * 3"},sideButtonSelectedBackgroundColor:"transparent",sideButtonHoverTextColor:Qt,iconButtonHoverColor:Qt,toggleButtonWidth:28,toggleButtonHeight:18,toggleButtonSwitchInset:1,toggleButtonOffBackgroundColor:Ti(.45),colorPickerThumbSize:13,colorPickerTrackSize:11,colorPickerThumbBorderWidth:2,colorPickerTrackBorderRadius:2,colorPickerColorBorderRadius:2}),jm=Ree();var _ee={cssName:"--ag-cell-horizontal-padding",changeKey:"cellHorizontalPaddingChanged",defaultValue:16},kee={cssName:"--ag-indentation-level",changeKey:"indentationLevelChanged",defaultValue:0,noWarn:!0,cacheDefault:!0},Fee={cssName:"--ag-row-group-indent-size",changeKey:"rowGroupIndentSizeChanged",defaultValue:0},UT={cssName:"--ag-row-height",changeKey:"rowHeightChanged",defaultValue:42},jT={cssName:"--ag-header-height",changeKey:"headerHeightChanged",defaultValue:48},qT={cssName:"--ag-list-item-height",changeKey:"listItemHeightChanged",defaultValue:24},Iy={cssName:"--ag-row-border",changeKey:"rowBorderWidthChanged",defaultValue:1,border:!0},$T={cssName:"--ag-pinned-row-border",changeKey:"pinnedRowBorderWidthChanged",defaultValue:1,border:!0};function Tee(t,e){for(let i of e.sort((n,r)=>n.moduleName.localeCompare(r.moduleName))){let n=i.css;n&&t.set(`module-${i.moduleName}`,n)}}var Dee=class extends qK{constructor(){super(...arguments),this.sizeEls=new Map,this.lastKnownValues=new Map,this.sizesMeasured=!1}initVariables(){this.addManagedPropertyListener("rowHeight",()=>this.refreshRowHeightVariable()),this.getSizeEl(UT),this.getSizeEl(jT),this.getSizeEl(qT),this.getSizeEl(Iy),this.getSizeEl($T),this.refreshRowBorderWidthVariable()}getPinnedRowBorderWidth(){return this.getCSSVariablePixelValue($T)}getRowBorderWidth(){return this.getCSSVariablePixelValue(Iy)}getDefaultRowHeight(){return this.getCSSVariablePixelValue(UT)}getDefaultHeaderHeight(){return this.getCSSVariablePixelValue(jT)}getDefaultCellHorizontalPadding(){return this.getCSSVariablePixelValue(_ee)}getCellPaddingLeft(){let t=this.getDefaultCellHorizontalPadding(),e=this.getCSSVariablePixelValue(kee),i=this.getCSSVariablePixelValue(Fee);return t-1+i*e}getCellPadding(){let t=this.getDefaultCellHorizontalPadding()-1;return this.getCellPaddingLeft()+t}getDefaultColumnMinWidth(){return Math.min(36,this.getDefaultRowHeight())}getDefaultListItemHeight(){return this.getCSSVariablePixelValue(qT)}refreshRowHeightVariable(){let{eRootDiv:t}=this,e=t.style.getPropertyValue("--ag-line-height").trim(),i=this.gos.get("rowHeight");if(i==null||isNaN(i)||!isFinite(i))return e!==null&&t.style.setProperty("--ag-line-height",null),-1;let n=`${i}px`;return e!=n?(t.style.setProperty("--ag-line-height",n),i):e!=""?Number.parseFloat(e):-1}getCSSVariablePixelValue(t){let e=this.lastKnownValues.get(t);if(e!=null)return e;let i=this.measureSizeEl(t);return i==="detached"||i==="no-styles"?(t.cacheDefault&&this.lastKnownValues.set(t,t.defaultValue),t.defaultValue):(this.lastKnownValues.set(t,i),i)}measureSizeEl(t){let e=this.getSizeEl(t);if(e.offsetParent==null)return"detached";let i=e.offsetWidth;return i===Ay?"no-styles":(this.sizesMeasured=!0,i)}getMeasurementContainer(){let t=this.eMeasurementContainer;return t||(t=this.eMeasurementContainer=Nt({tag:"div",cls:"ag-measurement-container"}),this.eRootDiv.appendChild(t)),t}getSizeEl(t){let e=this.sizeEls.get(t);if(e)return e;let i=this.getMeasurementContainer();e=Nt({tag:"div"});let{border:n,noWarn:r}=t;n?(e.className="ag-measurement-element-border",e.style.setProperty("--ag-internal-measurement-border",`var(${t.cssName}, solid ${Ay}px)`)):e.style.width=`var(${t.cssName}, ${Ay}px)`,i.appendChild(e),this.sizeEls.set(t,e);let o=this.measureSizeEl(t);o==="no-styles"&&!r&&K(9,{variable:t});let s=Ss(this.beans,e,()=>{let a=this.measureSizeEl(t);a==="detached"||a==="no-styles"||(this.lastKnownValues.set(t,a),a!==o&&(o=a,this.fireStylesChangedEvent(t.changeKey)))});return this.addDestroyFunc(()=>s()),e}fireStylesChangedEvent(t){t==="rowBorderWidthChanged"&&this.refreshRowBorderWidthVariable(),this.eventSvc.dispatchEvent({type:"gridStylesChanged",[t]:!0})}refreshRowBorderWidthVariable(){let t=this.getCSSVariablePixelValue(Iy);this.eRootDiv.style.setProperty("--ag-internal-row-border-width",`${t}px`)}postProcessThemeChange(t,e){t&&getComputedStyle(this.getMeasurementContainer()).getPropertyValue("--ag-legacy-styles-loaded")&&at(e?106:239)}getAdditionalCss(){let t=new Map;return t.set("core",[$Z]),Tee(t,Array.from(Cq())),t}getDefaultTheme(){return Pee}themeError(t){at(240,{theme:t})}},Ay=15538,Mee=class extends KK{postConstruct(){let{globalListener:t,globalSyncListener:e}=this.beans;t&&this.addGlobalListener(t,!0),e&&this.addGlobalListener(e,!1)}};function D8(t,e,i){let n=t.visibleCols.headerGroupRowCount;if(i>=n)return{column:e,headerRowIndex:i};let r=e.getParent();for(;r&&r.getProvidedColumnGroup().getLevel()>i;)r=r.getParent();let o=e.isSpanHeaderHeight();return!r||o&&r.isPadding()?{column:e,headerRowIndex:n}:{column:r,headerRowIndex:r.getProvidedColumnGroup().getLevel()}}var Iee=class extends H{constructor(){super(...arguments),this.beanName="headerNavigation",this.currentHeaderRowWithoutSpan=-1}postConstruct(){let t=this.beans;t.ctrlsSvc.whenReady(this,i=>{this.gridBodyCon=i.gridBodyCtrl});let e=ri(t);this.addManagedElementListeners(e,{mousedown:()=>{this.currentHeaderRowWithoutSpan=-1}})}getHeaderPositionForColumn(t,e){let i,{colModel:n,colGroupSvc:r,ctrlsSvc:o}=this.beans;if(typeof t=="string"?(i=n.getCol(t),i||(i=r?.getColumnGroup(t)??null)):i=t,!i)return null;let a=o.getHeaderRowContainerCtrl()?.getAllCtrls(),l=dt(a||[]).type==="filter",c=Ir(this.beans)-1,d=-1,u=i;for(;u;)d++,u=u.getParent();let h=d;return e&&l&&h===c-1&&h++,h===-1?null:{headerRowIndex:h,column:i}}navigateVertically(t,e){let{focusSvc:i,visibleCols:n}=this.beans,{focusedHeader:r}=i;if(!r)return!1;let{headerRowIndex:o}=r,s=r.column,a=Ir(this.beans),l=this.getHeaderRowType(o),c=n.headerGroupRowCount,{headerRowIndex:d,column:u,headerRowIndexWithoutSpan:h}=t==="UP"?Aee(l,s,o):Oee(s,o,c),p=!1;return d<0&&(d=0,u=s,p=!0),d>=a?(d=-1,this.currentHeaderRowWithoutSpan=-1):h!==void 0&&(this.currentHeaderRowWithoutSpan=h),!p&&!u?!1:i.focusHeaderPosition({headerPosition:{headerRowIndex:d,column:u},allowUserOverride:!0,event:e})}navigateHorizontally(t,e=!1,i){let{focusSvc:n,gos:r}=this.beans,o=w({},n.focusedHeader),s,a;this.currentHeaderRowWithoutSpan!==-1?o.headerRowIndex=this.currentHeaderRowWithoutSpan:this.currentHeaderRowWithoutSpan=o.headerRowIndex,t==="LEFT"!==r.get("enableRtl")?(a="Before",s=this.findHeader(o,a)):(a="After",s=this.findHeader(o,a));let l=r.getCallback("tabToNextHeader");if(e&&l){let c=n.focusHeaderPositionFromUserFunc({userFunc:l,headerPosition:s,direction:a});if(c){let{headerRowIndex:d}=n.focusedHeader||{};d!=null&&d!=o.headerRowIndex&&(this.currentHeaderRowWithoutSpan=d)}return c}return s||!e?n.focusHeaderPosition({headerPosition:s,direction:a,fromTab:e,allowUserOverride:!0,event:i}):this.focusNextHeaderRow(o,a,i)}focusNextHeaderRow(t,e,i){let n=this.beans,r=t.headerRowIndex,o=null,s,a=Ir(n),l=this.beans.visibleCols.allCols;if(e==="Before"){if(r<=0)return!1;o=dt(l),s=r-1,this.currentHeaderRowWithoutSpan-=1}else o=l[0],s=r+1,this.currentHeaderRowWithoutSpan<a?this.currentHeaderRowWithoutSpan+=1:this.currentHeaderRowWithoutSpan=-1;let{column:c,headerRowIndex:d}=D8(this.beans,o,s);return d>=a&&(d=-1),n.focusSvc.focusHeaderPosition({headerPosition:{column:c,headerRowIndex:d},direction:e,fromTab:!0,allowUserOverride:!0,event:i})}scrollToColumn(t,e="After"){if(t.getPinned())return;let i;if(Ot(t)){let n=t.getDisplayedLeafColumns();i=e==="Before"?dt(n):n[0]}else i=t;this.gridBodyCon.scrollFeature.ensureColumnVisible(i)}findHeader(t,e){let{colGroupSvc:i,visibleCols:n}=this.beans,r=t.column;if(r instanceof ph){let l=r.getDisplayedLeafColumns();r=e==="Before"?l[0]:l[l.length-1]}let o=e==="Before"?n.getColBefore(r):n.getColAfter(r);if(!o)return;let s=n.headerGroupRowCount;if(t.headerRowIndex>=s)return{headerRowIndex:t.headerRowIndex,column:o};let a=i?.getColGroupAtLevel(o,t.headerRowIndex);return a?a.isPadding()&&o.isSpanHeaderHeight()?{headerRowIndex:n.headerGroupRowCount,column:o}:{headerRowIndex:t.headerRowIndex,column:a??o}:{headerRowIndex:o instanceof Aa&&o.isSpanHeaderHeight()?n.headerGroupRowCount:t.headerRowIndex,column:o}}getHeaderRowType(t){let e=this.beans.ctrlsSvc.getHeaderRowContainerCtrl();if(e)return e.getRowType(t)}};function Aee(t,e,i){let n=i-1;if(t!=="filter"){let r=e instanceof Aa&&e.isSpanHeaderHeight(),o=e.getParent();for(;o&&(o.getProvidedColumnGroup().getLevel()>n||r&&o.isPadding());)o=o.getParent();if(o)return r?{column:o,headerRowIndex:o.getProvidedColumnGroup().getLevel(),headerRowIndexWithoutSpan:n}:{column:o,headerRowIndex:n,headerRowIndexWithoutSpan:n}}return{column:e,headerRowIndex:n,headerRowIndexWithoutSpan:n}}function Oee(t,e,i){let n=e+1,r={column:t,headerRowIndex:n,headerRowIndexWithoutSpan:n};if(t instanceof ph){if(n>=i)return{column:t.getDisplayedLeafColumns()[0],headerRowIndex:i,headerRowIndexWithoutSpan:n};let s=t.getDisplayedChildren()[0];if(s instanceof ph&&s.isPadding()){let l=s.getDisplayedLeafColumns()[0];l.isSpanHeaderHeight()&&(s=l)}r.column=s,s instanceof Aa&&s.isSpanHeaderHeight()&&(r.headerRowIndex=i,r.headerRowIndexWithoutSpan=n)}return r}var Lee=class extends H{constructor(){super(...arguments),this.beanName="focusSvc",this.focusFallbackTimeout=null,this.needsFocusRestored=!1}wireBeans(t){this.colModel=t.colModel,this.visibleCols=t.visibleCols,this.rowRenderer=t.rowRenderer,this.navigation=t.navigation,this.filterManager=t.filterManager,this.overlays=t.overlays}postConstruct(){let t=this.clearFocusedCell.bind(this);this.addManagedEventListeners({columnPivotModeChanged:t,newColumnsLoaded:this.onColumnEverythingChanged.bind(this),columnGroupOpened:t,columnRowGroupChanged:t}),this.addDestroyFunc(eK(this.beans))}attemptToRecoverFocus(){this.needsFocusRestored=!0,this.focusFallbackTimeout!=null&&clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=window.setTimeout(this.setFocusRecovered.bind(this),100)}setFocusRecovered(){this.needsFocusRestored=!1,this.focusFallbackTimeout!=null&&(clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=null)}shouldTakeFocus(){return this.gos.get("suppressFocusAfterRefresh")?(this.setFocusRecovered(),!1):this.needsFocusRestored?(this.setFocusRecovered(),!0):this.doesRowOrCellHaveBrowserFocus()}onColumnEverythingChanged(){if(!this.focusedCell)return;let t=this.focusedCell.column,e=this.colModel.getCol(t.getId());t!==e&&this.clearFocusedCell()}getFocusCellToUseAfterRefresh(){let{gos:t,focusedCell:e}=this;return t.get("suppressFocusAfterRefresh")||t.get("suppressCellFocus")||!e||!this.doesRowOrCellHaveBrowserFocus()?null:e}getFocusHeaderToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedHeader||!this.isDomDataPresentInHierarchy(St(this.beans),r8)?null:this.focusedHeader}doesRowOrCellHaveBrowserFocus(){let t=St(this.beans);return this.isDomDataPresentInHierarchy(t,Tm)?!0:this.isDomDataPresentInHierarchy(t,Dm)}isDomDataPresentInHierarchy(t,e){let i=t;for(;i;){if(qD(this.gos,i,e))return!0;i=i.parentNode}return!1}getFocusedCell(){return this.focusedCell}getFocusEventParams(t){let{rowIndex:e,rowPinned:i,column:n}=t,r={rowIndex:e,rowPinned:i,column:n,isFullWidthCell:!1},o=this.rowRenderer.getRowByPosition({rowIndex:e,rowPinned:i});return o&&(r.isFullWidthCell=o.isFullWidth()),r}clearFocusedCell(){if(this.focusedCell==null)return;let t=this.getFocusEventParams(this.focusedCell);this.focusedCell=null,this.eventSvc.dispatchEvent(w({type:"cellFocusCleared"},t))}setFocusedCell(t){this.setFocusRecovered();let{column:e,rowIndex:i,rowPinned:n,forceBrowserFocus:r=!1,preventScrollOnBrowserFocus:o=!1,sourceEvent:s}=t,a=this.colModel.getCol(e);if(!a){this.focusedCell=null;return}this.focusedCell={rowIndex:i,rowPinned:Co(n),column:a};let l=this.getFocusEventParams(this.focusedCell);this.eventSvc.dispatchEvent(k(w(w({type:"cellFocused"},l),this.previousCellFocusParams&&{previousParams:this.previousCellFocusParams}),{forceBrowserFocus:r,preventScrollOnBrowserFocus:o,sourceEvent:s})),this.previousCellFocusParams=l}isCellFocused(t){return this.focusedCell==null?!1:u8(t,this.focusedCell)}isHeaderWrapperFocused(t){if(this.focusedHeader==null)return!1;let{column:e,rowCtrl:{rowIndex:i,pinned:n}}=t,{column:r,headerRowIndex:o}=this.focusedHeader;return e===r&&i===o&&n==r.getPinned()}focusHeaderPosition(t){if(this.setFocusRecovered(),Ra(this.beans))return!1;let{direction:e,fromTab:i,allowUserOverride:n,event:r,fromCell:o,rowWithoutSpanValue:s,scroll:a=!0}=t,{headerPosition:l}=t;if(o&&this.filterManager?.isAdvFilterHeaderActive())return this.focusAdvancedFilter(l);if(n){let c=this.focusedHeader,d=Ir(this.beans);if(i){let u=this.gos.getCallback("tabToNextHeader");u&&(l=this.getHeaderPositionFromUserFunc({userFunc:u,direction:e,currentPosition:c,headerPosition:l,headerRowCount:d}))}else{let u=this.gos.getCallback("navigateToNextHeader");if(u&&r){let h={key:r.key,previousHeaderPosition:c,nextHeaderPosition:l,headerRowCount:d,event:r};l=u(h)}}}return l?this.focusProvidedHeaderPosition({headerPosition:l,direction:e,event:r,fromCell:o,rowWithoutSpanValue:s,scroll:a}):!1}focusHeaderPositionFromUserFunc(t){if(Ra(this.beans))return!1;let{userFunc:e,headerPosition:i,direction:n,event:r}=t,o=this.focusedHeader,s=Ir(this.beans),a=this.getHeaderPositionFromUserFunc({userFunc:e,direction:n,currentPosition:o,headerPosition:i,headerRowCount:s});return!!a&&this.focusProvidedHeaderPosition({headerPosition:a,direction:n,event:r})}getHeaderPositionFromUserFunc(t){let{userFunc:e,direction:i,currentPosition:n,headerPosition:r,headerRowCount:o}=t,a=e({backwards:i==="Before",previousHeaderPosition:n,nextHeaderPosition:r,headerRowCount:o});return a===!0?n:a===!1?null:a}focusProvidedHeaderPosition(t){let{headerPosition:e,direction:i,fromCell:n,rowWithoutSpanValue:r,event:o,scroll:s=!0}=t,{column:a,headerRowIndex:l}=e,{filterManager:c,ctrlsSvc:d,headerNavigation:u}=this.beans;if(this.focusedHeader&&bX(t.headerPosition,this.focusedHeader))return!1;if(l===-1)return c?.isAdvFilterHeaderActive()?this.focusAdvancedFilter(e):this.focusGridView({column:a,event:o});s&&u?.scrollToColumn(a,i);let p=d.getHeaderRowContainerCtrl(a.getPinned())?.focusHeader(e.headerRowIndex,a,o)||!1;return u&&p&&(r!=null||n)&&(u.currentHeaderRowWithoutSpan=r??-1),p}focusFirstHeader(){if(this.overlays?.isExclusive()&&this.focusOverlay())return!0;let t=this.visibleCols.allCols[0];if(!t)return!1;let e=D8(this.beans,t,0);return this.focusHeaderPosition({headerPosition:e,rowWithoutSpanValue:0})}focusLastHeader(t){if(this.overlays?.isExclusive()&&this.focusOverlay(!0))return!0;let e=Ir(this.beans)-1,i=dt(this.visibleCols.allCols);return this.focusHeaderPosition({headerPosition:{headerRowIndex:e,column:i},rowWithoutSpanValue:-1,event:t})}focusPreviousFromFirstCell(t){return this.filterManager?.isAdvFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(t)}isAnyCellFocused(){return!!this.focusedCell}isRowFocused(t,e){return this.focusedCell==null?!1:this.focusedCell.rowIndex===t&&this.focusedCell.rowPinned===Co(e)}focusOverlay(t){let e=this.overlays?.isVisible()&&this.overlays.eWrapper?.getGui();return!!e&&Ta(e,t)}focusGridView(t){let{backwards:e=!1,canFocusOverlay:i=!0,event:n}=t;if(this.overlays?.isExclusive())return i&&this.focusOverlay(e);if(Wm(this.beans))return e&&!Ra(this.beans)?this.focusLastHeader():i&&this.focusOverlay(e)?!0:e?!1:mc(this.beans,e);let r=e?ZJ(this.beans):QJ(this.beans);if(r){let o=t.column??this.focusedHeader?.column,{rowIndex:s,rowPinned:a}=r,l=xo(this.beans,r);if(!o||!l||s==null)return!1;if(o.isSuppressNavigable(l)){let c=this.gos.get("enableRtl"),d;return!n||n.key===A.TAB?d=c?A.LEFT:A.RIGHT:d=n.key,this.beans.navigation?.navigateToNextCell(null,d,{rowIndex:s,column:o,rowPinned:a||null},!0),!0}return this.navigation?.ensureCellVisible({rowIndex:s,column:o,rowPinned:a}),e&&this.rowRenderer.getRowByPosition(r)?.isFullWidth()&&this.navigation?.tryToFocusFullWidthRow(r,e)||(this.setFocusedCell({rowIndex:s,column:o,rowPinned:Co(a),forceBrowserFocus:!0}),this.beans.rangeSvc?.setRangeToCell({rowIndex:s,rowPinned:a,column:o})),!0}return!!(i&&this.focusOverlay(e)||e&&this.focusLastHeader())}focusAdvancedFilter(t){return this.advFilterFocusColumn=t?.column,this.beans.advancedFilter?.getCtrl().focusHeaderComp()??!1}focusNextFromAdvancedFilter(t,e){let i=(e?void 0:this.advFilterFocusColumn)??this.visibleCols.allCols?.[0];return t?this.focusHeaderPosition({headerPosition:{column:i,headerRowIndex:Ir(this.beans)-1}}):this.focusGridView({column:i})}clearAdvancedFilterColumn(){this.advFilterFocusColumn=void 0}},Nee=class extends H{constructor(){super(...arguments),this.beanName="scrollVisibleSvc"}wireBeans(t){this.ctrlsSvc=t.ctrlsSvc,this.colAnimation=t.colAnimation}postConstruct(){this.horizontalScrollShowing=this.gos.get("alwaysShowHorizontalScroll")===!0,this.verticalScrollShowing=this.gos.get("alwaysShowVerticalScroll")===!0,this.getScrollbarWidth(),this.addManagedEventListeners({displayedColumnsChanged:this.updateScrollVisible.bind(this),displayedColumnsWidthChanged:this.updateScrollVisible.bind(this)})}updateScrollVisible(){let{colAnimation:t}=this;t?.isActive()?t.executeLaterVMTurn(()=>{t.executeLaterVMTurn(()=>this.updateScrollVisibleImpl())}):this.updateScrollVisibleImpl()}updateScrollVisibleImpl(){let t=this.ctrlsSvc.get("center");if(!t||this.colAnimation?.isActive())return;let e={horizontalScrollShowing:t.isHorizontalScrollShowing(),verticalScrollShowing:this.verticalScrollShowing};this.setScrollsVisible(e),this.updateScrollGap()}updateScrollGap(){let t=this.ctrlsSvc.get("center"),e=t.hasHorizontalScrollGap(),i=t.hasVerticalScrollGap();(this.horizontalScrollGap!==e||this.verticalScrollGap!==i)&&(this.horizontalScrollGap=e,this.verticalScrollGap=i,this.eventSvc.dispatchEvent({type:"scrollGapChanged"}))}setScrollsVisible(t){(this.horizontalScrollShowing!==t.horizontalScrollShowing||this.verticalScrollShowing!==t.verticalScrollShowing)&&(this.horizontalScrollShowing=t.horizontalScrollShowing,this.verticalScrollShowing=t.verticalScrollShowing,this.eventSvc.dispatchEvent({type:"scrollVisibilityChanged"}))}getScrollbarWidth(){if(this.scrollbarWidth==null){let t=this.gos.get("scrollbarWidth"),i=typeof t=="number"&&t>=0?t:$$();i!=null&&(this.scrollbarWidth=i,this.eventSvc.dispatchEvent({type:"scrollbarWidthChanged"}))}return this.scrollbarWidth}},Bee=class extends H{constructor(){super(...arguments),this.beanName="gridDestroySvc",this.destroyCalled=!1}destroy(){if(this.destroyCalled)return;let{stateSvc:t,ctrlsSvc:e,context:i}=this.beans;this.eventSvc.dispatchEvent({type:"gridPreDestroyed",state:t?.getState()??{}}),this.destroyCalled=!0,e.get("gridCtrl")?.destroyGridUi(),i.destroy(),super.destroy()}},hm=new Set(["gridPreDestroyed","fillStart","pasteStart"]),Hee=["columnEverythingChanged","newColumnsLoaded","columnPivotModeChanged","pivotMaxColumnsExceeded","columnRowGroupChanged","expandOrCollapseAll","columnPivotChanged","gridColumnsChanged","columnValueChanged","columnMoved","columnVisible","columnPinned","columnGroupOpened","columnResized","displayedColumnsChanged","virtualColumnsChanged","columnHeaderMouseOver","columnHeaderMouseLeave","columnHeaderClicked","columnHeaderContextMenu","asyncTransactionsFlushed","rowGroupOpened","rowDataUpdated","pinnedRowDataChanged","pinnedRowsChanged","rangeSelectionChanged","cellSelectionChanged","chartCreated","chartRangeSelectionChanged","chartOptionsChanged","chartDestroyed","toolPanelVisibleChanged","toolPanelSizeChanged","modelUpdated","cutStart","cutEnd","pasteStart","pasteEnd","fillStart","fillEnd","cellSelectionDeleteStart","cellSelectionDeleteEnd","rangeDeleteStart","rangeDeleteEnd","undoStarted","undoEnded","redoStarted","redoEnded","cellClicked","cellDoubleClicked","cellMouseDown","cellContextMenu","cellValueChanged","cellEditRequest","rowValueChanged","headerFocused","cellFocused","rowSelected","selectionChanged","tooltipShow","tooltipHide","cellKeyDown","cellMouseOver","cellMouseOut","filterChanged","filterModified","filterUiChanged","filterOpened","floatingFilterUiChanged","advancedFilterBuilderVisibleChanged","sortChanged","virtualRowRemoved","rowClicked","rowDoubleClicked","gridReady","gridPreDestroyed","gridSizeChanged","viewportChanged","firstDataRendered","dragStarted","dragStopped","dragCancelled","rowEditingStarted","rowEditingStopped","cellEditingStarted","cellEditingStopped","bodyScroll","bodyScrollEnd","paginationChanged","componentStateChanged","storeRefreshed","stateUpdated","columnMenuVisibleChanged","contextMenuVisibleChanged","rowDragEnter","rowDragMove","rowDragLeave","rowDragEnd","rowDragCancel","findChanged","rowResizeStarted","rowResizeEnded","columnsReset","bulkEditingStarted","bulkEditingStopped","batchEditingStarted","batchEditingStopped"];var i2=Hee.reduce((t,e)=>(t[e]=Bq(e),t),{}),Wu=(t,e)=>({tag:"span",ref:`eSort${t}`,cls:`ag-sort-indicator-icon ag-sort-${e} ag-hidden`,attrs:{"aria-hidden":"true"}}),zee={tag:"span",cls:"ag-sort-indicator-container",children:[Wu("Order","order"),Wu("Asc","ascending-icon"),Wu("Desc","descending-icon"),Wu("Mixed","mixed-icon"),Wu("None","none-icon")]},n2=class extends et{constructor(t){super(),this.eSortOrder=re,this.eSortAsc=re,this.eSortDesc=re,this.eSortMixed=re,this.eSortNone=re,t||this.setTemplate(zee)}attachCustomElements(t,e,i,n,r){this.eSortOrder=t,this.eSortAsc=e,this.eSortDesc=i,this.eSortMixed=n,this.eSortNone=r}setupSort(t,e=!1){if(this.column=t,this.suppressOrder=e,this.setupMultiSortIndicator(),!t.isSortable()&&!t.getColDef().showRowGroup)return;this.addInIcon("sortAscending",this.eSortAsc,t),this.addInIcon("sortDescending",this.eSortDesc,t),this.addInIcon("sortUnSort",this.eSortNone,t);let i=this.updateIcons.bind(this),n=this.onSortChanged.bind(this);this.addManagedPropertyListener("unSortIcon",i),this.addManagedEventListeners({newColumnsLoaded:i,sortChanged:n,columnRowGroupChanged:n}),this.onSortChanged()}addInIcon(t,e,i){if(e==null)return;let n=Mn(t,this.beans,i);n&&e.appendChild(n)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){let{eSortAsc:t,eSortDesc:e,eSortNone:i,column:n,gos:r,beans:o}=this,s=o.sortSvc.getDisplaySortForColumn(n);if(t&&Ct(t,s==="asc",{skipAriaHidden:!0}),e&&Ct(e,s==="desc",{skipAriaHidden:!0}),i){let a=!n.getColDef().unSortIcon&&!r.get("unSortIcon"),l=s==null;Ct(i,!a&&l,{skipAriaHidden:!0})}}setupMultiSortIndicator(){let{eSortMixed:t,column:e,gos:i}=this;this.addInIcon("sortUnSort",t,e);let n=e.getColDef().showRowGroup;Dr(i)&&n&&(this.addManagedEventListeners({sortChanged:this.updateMultiSortIndicator.bind(this),columnRowGroupChanged:this.updateMultiSortIndicator.bind(this)}),this.updateMultiSortIndicator())}updateMultiSortIndicator(){let{eSortMixed:t,beans:e,column:i}=this;if(t){let n=e.sortSvc.getDisplaySortForColumn(i)==="mixed";Ct(t,n,{skipAriaHidden:!0})}}updateSortOrder(){let{eSortOrder:t,column:e,beans:{sortSvc:i}}=this;if(!t)return;let n=i.getColumnsWithSortingOrdered(),r=i.getDisplaySortIndexForColumn(e)??-1,o=n.some(a=>i.getDisplaySortIndexForColumn(a)??!1),s=r>=0&&o;Ct(t,s,{skipAriaHidden:!0}),r>=0?t.textContent=(r+1).toString():hi(t)}},Vee={selector:"AG-SORT-INDICATOR",component:n2},gh=["asc","desc",null],Gee=class extends H{constructor(){super(...arguments),this.beanName="sortSvc"}progressSort(t,e,i){let n=this.getNextSortDirection(t);this.setSortForColumn(t,n,e,i)}progressSortFromEvent(t,e){let n=this.gos.get("multiSortKey")==="ctrl"?e.ctrlKey||e.metaKey:e.shiftKey;this.progressSort(t,n,"uiColumnSorted")}setSortForColumn(t,e,i,n){e!=="asc"&&e!=="desc"&&(e=null);let{gos:r,showRowGroupCols:o}=this.beans,s=Dr(r),a=[t];if(s&&t.getColDef().showRowGroup){let u=o?.getSourceColumnsForGroupColumn?.(t)?.filter(h=>h.isSortable());u&&(a=[t,...u])}for(let d of a)this.setColSort(d,e,n);let l=(i||r.get("alwaysMultiSort"))&&!r.get("suppressMultiSort"),c=[];if(!l){let d=this.clearSortBarTheseColumns(a,n);c.push(...d)}this.updateSortIndex(t),c.push(...a),this.dispatchSortChangedEvents(n,c)}updateSortIndex(t){let{gos:e,colModel:i,showRowGroupCols:n}=this.beans,r=Dr(e),o=n?.getShowRowGroupCol(t.getId()),s=r&&o||t,a=this.getColumnsWithSortingOrdered();i.forAllCols(d=>this.setColSortIndex(d,null));let l=a.filter(d=>r&&d.getColDef().showRowGroup?!1:d!==s);(s.getSort()?[...l,s]:l).forEach((d,u)=>this.setColSortIndex(d,u))}onSortChanged(t,e){this.dispatchSortChangedEvents(t,e)}isSortActive(){let t=!1;return this.beans.colModel.forAllCols(e=>{e.getSort()&&(t=!0)}),t}dispatchSortChangedEvents(t,e){let i={type:"sortChanged",source:t};e&&(i.columns=e),this.eventSvc.dispatchEvent(i)}clearSortBarTheseColumns(t,e){let i=[];return this.beans.colModel.forAllCols(n=>{t.includes(n)||(n.getSort()&&i.push(n),this.setColSort(n,void 0,e))}),i}getNextSortDirection(t){let e=t.getColDef().sortingOrder??this.gos.get("sortingOrder")??gh,i=e.indexOf(t.getSort()),n=i<0,r=i==e.length-1;return n||r?e[0]:e[i+1]}getIndexedSortMap(){let{gos:t,colModel:e,showRowGroupCols:i,rowGroupColsSvc:n}=this.beans,r=[];if(e.forAllCols(c=>{c.getSort()&&r.push(c)}),e.isPivotMode()){let c=Dr(t);r=r.filter(d=>{let u=!!d.getAggFunc(),h=!d.isPrimary(),p=c?i?.getShowRowGroupCol(d.getId()):d.getColDef().showRowGroup;return u||h||p})}let o=n?.columns.filter(c=>!!c.getSort())??[],s={};r.forEach((c,d)=>s[c.getId()]=d),r.sort((c,d)=>{let u=c.getSortIndex(),h=d.getSortIndex();if(u!=null&&h!=null)return u-h;if(u==null&&h==null){let p=s[c.getId()],f=s[d.getId()];return p>f?1:-1}else return h==null?-1:1});let a=Dr(t)&&!!o.length;a&&(r=[...new Set(r.map(c=>i?.getShowRowGroupCol(c.getId())??c))]);let l=new Map;if(r.forEach((c,d)=>l.set(c,d)),a)for(let c of o){let d=i.getShowRowGroupCol(c.getId());l.set(c,l.get(d))}return l}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort(([,t],[,e])=>t-e).map(([t])=>t)}getSortModel(){return this.getColumnsWithSortingOrdered().filter(t=>t.getSort()).map(t=>({sort:t.getSort(),colId:t.getId()}))}getSortOptions(){return this.getColumnsWithSortingOrdered().filter(t=>t.getSort()).map(t=>({sort:t.getSort(),column:t}))}canColumnDisplayMixedSort(t){let e=Dr(this.gos),i=!!t.getColDef().showRowGroup;return e&&i}getDisplaySortForColumn(t){let e=this.beans.showRowGroupCols?.getSourceColumnsForGroupColumn(t);if(!this.canColumnDisplayMixedSort(t)||!e?.length)return t.getSort();let n=t.getColDef().field!=null||!!t.getColDef().valueGetter?[t,...e]:e,r=n[0].getSort();return n.every(s=>s.getSort()==r)?r:"mixed"}getDisplaySortIndexForColumn(t){return this.getIndexedSortMap().get(t)}setupHeader(t,e,i){let n=0;t.addManagedListeners(e,{movingChanged:()=>{n=Date.now()}}),i&&t.addManagedElementListeners(i,{click:o=>{let s=e.isMoving(),l=Date.now()-n<50;s||l||this.progressSortFromEvent(e,o)}});let r=()=>{let o=e.getSort();if(t.toggleCss("ag-header-cell-sorted-asc",o==="asc"),t.toggleCss("ag-header-cell-sorted-desc",o==="desc"),t.toggleCss("ag-header-cell-sorted-none",!o),e.getColDef().showRowGroup){let l=!this.beans.showRowGroupCols?.getSourceColumnsForGroupColumn(e)?.every(c=>e.getSort()==c.getSort());t.toggleCss("ag-header-cell-sorted-mixed",l)}};t.addManagedEventListeners({sortChanged:r,columnRowGroupChanged:r})}initCol(t){let{sort:e,initialSort:i,sortIndex:n,initialSortIndex:r}=t.colDef;e!==void 0?(e==="asc"||e==="desc")&&(t.sort=e):(i==="asc"||i==="desc")&&(t.sort=i),n!==void 0?n!==null&&(t.sortIndex=n):r!==null&&(t.sortIndex=r)}updateColSort(t,e,i){e!==void 0&&(e==="desc"||e==="asc"?this.setColSort(t,e,i):this.setColSort(t,void 0,i))}setColSort(t,e,i){t.sort!==e&&(t.sort=e,t.dispatchColEvent("sortChanged",i)),t.dispatchStateUpdatedEvent("sort")}setColSortIndex(t,e){t.sortIndex=e,t.dispatchStateUpdatedEvent("sortIndex")}createSortIndicator(t){return new n2(t)}getSortIndicatorSelector(){return Vee}},cc={agSetColumnFilter:"SetFilter",agSetColumnFloatingFilter:"SetFilter",agMultiColumnFilter:"MultiFilter",agMultiColumnFloatingFilter:"MultiFilter",agGroupColumnFilter:"GroupFilter",agGroupColumnFloatingFilter:"GroupFilter",agGroupCellRenderer:"GroupCellRenderer",agGroupRowRenderer:"GroupCellRenderer",agRichSelect:"RichSelect",agRichSelectCellEditor:"RichSelect",agDetailCellRenderer:"SharedMasterDetail",agSparklineCellRenderer:"Sparklines",agDragAndDropImage:"SharedDragAndDrop",agColumnHeader:"ColumnHeaderComp",agColumnGroupHeader:"ColumnGroupHeaderComp",agSortIndicator:"Sort",agAnimateShowChangeCellRenderer:"HighlightChanges",agAnimateSlideCellRenderer:"HighlightChanges",agLoadingCellRenderer:"LoadingCellRenderer",agSkeletonCellRenderer:"SkeletonCellRenderer",agCheckboxCellRenderer:"CheckboxCellRenderer",agLoadingOverlay:"Overlay",agNoRowsOverlay:"Overlay",agTooltipComponent:"Tooltip",agReadOnlyFloatingFilter:"CustomFilter",agTextColumnFilter:"TextFilter",agNumberColumnFilter:"NumberFilter",agDateColumnFilter:"DateFilter",agDateInput:"DateFilter",agTextColumnFloatingFilter:"TextFilter",agNumberColumnFloatingFilter:"NumberFilter",agDateColumnFloatingFilter:"DateFilter",agCellEditor:"TextEditor",agSelectCellEditor:"SelectEditor",agTextCellEditor:"TextEditor",agNumberCellEditor:"NumberEditor",agDateCellEditor:"DateEditor",agDateStringCellEditor:"DateEditor",agCheckboxCellEditor:"CheckboxEditor",agLargeTextCellEditor:"LargeTextEditor",agMenuItem:"MenuItem",agColumnsToolPanel:"ColumnsToolPanel",agFiltersToolPanel:"FiltersToolPanel",agNewFiltersToolPanel:"NewFiltersToolPanel",agAggregationComponent:"StatusBar",agSelectedRowCountComponent:"StatusBar",agTotalRowCountComponent:"StatusBar",agFilteredRowCountComponent:"StatusBar",agTotalAndFilteredRowCountComponent:"StatusBar",agFindCellRenderer:"Find"};function KT(t){return`"${t}"`}var Wee=()=>({checkboxSelection:{version:"32.2",message:"Use `rowSelection.checkboxes` in `GridOptions` instead."},headerCheckboxSelection:{version:"32.2",message:"Use `rowSelection.headerCheckbox = true` in `GridOptions` instead."},headerCheckboxSelectionFilteredOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "filtered"` in `GridOptions` instead.'},headerCheckboxSelectionCurrentPageOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "currentPage"` in `GridOptions` instead.'},showDisabledCheckboxes:{version:"32.2",message:"Use `rowSelection.hideDisabledCheckboxes = true` in `GridOptions` instead."},rowGroupingHierarchy:{version:"34.3",message:"Use `colDef.groupHierarchy` instead."}}),Uee={aggFunc:"SharedAggregation",autoHeight:"RowAutoHeight",cellClass:"CellStyle",cellClassRules:"CellStyle",cellEditor:({cellEditor:t,editable:e})=>e?typeof t=="string"?cc[t]??"CustomEditor":"CustomEditor":null,cellRenderer:({cellRenderer:t})=>typeof t!="string"?null:cc[t],cellStyle:"CellStyle",columnChooserParams:"ColumnMenu",contextMenuItems:"ContextMenu",dndSource:"DragAndDrop",dndSourceOnRowDrag:"DragAndDrop",editable:({editable:t,cellEditor:e})=>t&&!e?"TextEditor":null,enableCellChangeFlash:"HighlightChanges",enablePivot:"SharedPivot",enableRowGroup:"SharedRowGrouping",enableValue:"SharedAggregation",filter:({filter:t})=>t&&typeof t!="string"&&typeof t!="boolean"?"CustomFilter":typeof t=="string"?cc[t]??"ColumnFilter":"ColumnFilter",floatingFilter:"ColumnFilter",getQuickFilterText:"QuickFilter",headerTooltip:"Tooltip",headerTooltipValueGetter:"Tooltip",mainMenuItems:"ColumnMenu",menuTabs:t=>{let e=["columnsMenuTab","generalMenuTab"];return t.menuTabs?.some(i=>e.includes(i))?"ColumnMenu":null},pivot:"SharedPivot",pivotIndex:"SharedPivot",rowDrag:"RowDrag",rowGroup:"SharedRowGrouping",rowGroupIndex:"SharedRowGrouping",tooltipField:"Tooltip",tooltipValueGetter:"Tooltip",tooltipComponentSelector:"Tooltip",spanRows:"CellSpan",groupHierarchy:"SharedRowGrouping"},jee=()=>({autoHeight:{supportedRowModels:["clientSide","serverSide"],validate:(e,{paginationAutoPageSize:i})=>i?"colDef.autoHeight is not supported with paginationAutoPageSize.":null},cellRendererParams:{validate:e=>(e.rowGroup!=null||e.rowGroupIndex!=null||e.cellRenderer==="agGroupCellRenderer")&&"checkbox"in e.cellRendererParams?'Since v33.0, `cellRendererParams.checkbox` has been deprecated. Use `rowSelection.checkboxLocation = "autoGroupColumn"` instead.':null},flex:{validate:(e,i)=>i.autoSizeStrategy?"colDef.flex is not supported with gridOptions.autoSizeStrategy":null},headerCheckboxSelection:{supportedRowModels:["clientSide","serverSide"],validate:(e,{rowSelection:i})=>i==="multiple"?null:"headerCheckboxSelection is only supported with rowSelection=multiple"},headerCheckboxSelectionCurrentPageOnly:{supportedRowModels:["clientSide"],validate:(e,{rowSelection:i})=>i==="multiple"?null:"headerCheckboxSelectionCurrentPageOnly is only supported with rowSelection=multiple"},headerCheckboxSelectionFilteredOnly:{supportedRowModels:["clientSide"],validate:(e,{rowSelection:i})=>i==="multiple"?null:"headerCheckboxSelectionFilteredOnly is only supported with rowSelection=multiple"},headerValueGetter:{validate:e=>{let i=e.headerValueGetter;return typeof i=="function"||typeof i=="string"?null:"headerValueGetter must be a function or a valid string expression"}},icons:{validate:({icons:e})=>{if(e){if(e.smallDown)return Or(262);if(e.smallLeft)return Or(263);if(e.smallRight)return Or(264)}return null}},sortingOrder:{validate:e=>{let i=e.sortingOrder;if(Array.isArray(i)&&i.length>0){let n=i.filter(r=>!gh.includes(r));if(n.length>0)return`sortingOrder must be an array with elements from [${gh.map(bm).join()}], currently it includes [${n.map(bm).join()}]`}else if(!Array.isArray(i)||i.length<=0)return`sortingOrder must be an array with at least one element, currently it's ${i}`;return null}},type:{validate:e=>{let i=e.type;return i instanceof Array?i.some(r=>typeof r!="string")?"if colDef.type is supplied an array it should be of type 'string[]'":null:typeof i=="string"?null:"colDef.type should be of type 'string' | 'string[]'"}},rowSpan:{validate:(e,{suppressRowTransform:i})=>i?null:"colDef.rowSpan requires suppressRowTransform to be enabled."},spanRows:{dependencies:{editable:{required:[!1,void 0]},rowDrag:{required:[!1,void 0]},colSpan:{required:[void 0]},rowSpan:{required:[void 0]}},validate:(e,{rowSelection:i,cellSelection:n,suppressRowTransform:r,enableCellSpan:o,rowDragEntireRow:s,enableCellTextSelection:a})=>typeof i=="object"&&i?.mode==="singleRow"&&i?.enableClickSelection?"colDef.spanRows is not supported with rowSelection.clickSelection":n?"colDef.spanRows is not supported with cellSelection.":r?"colDef.spanRows is not supported with suppressRowTransform.":o?s?"colDef.spanRows is not supported with rowDragEntireRow.":a?"colDef.spanRows is not supported with enableCellTextSelection.":null:"colDef.spanRows requires enableCellSpan to be enabled."},groupHierarchy:{validate(e,{groupHierarchyConfig:i={}},n){let r=new Set(["year","quarter","month","formattedMonth","day","hour","minute","second"]),o=[];for(let s of e.groupHierarchy??[]){if(typeof s=="object"){n.validation?.validateColDef(s);continue}!r.has(s)&&!(s in i)&&o.push(KT(s))}if(o.length>0){let s=`The following parts of colDef.groupHierarchy are not recognised: ${o.join(", ")}.`,a=`Choose one of ${[...r].map(KT).join(", ")}, or define your own parts in gridOptions.groupHierarchyConfig.`;return`${s}
${a}`}return null}}}),qee={headerName:void 0,columnGroupShow:void 0,headerStyle:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,headerTooltipValueGetter:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellAriaRole:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnChooserParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressHeaderMenuButton:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,spanRows:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,tooltipComponentSelector:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0,mainMenuItems:void 0,contextMenuItems:void 0,suppressFloatingFilterButton:void 0,suppressHeaderFilterButton:void 0,suppressHeaderContextMenu:void 0,loadingCellRenderer:void 0,loadingCellRendererParams:void 0,loadingCellRendererSelector:void 0,context:void 0,dateComponent:void 0,dateComponentParams:void 0,getFindText:void 0,rowGroupingHierarchy:void 0,groupHierarchy:void 0},$ee=()=>Object.keys(qee),Kee=()=>({objectName:"colDef",allProperties:$ee(),docsUrl:"column-properties/",deprecations:Wee(),validations:jee()}),Yee=["overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","groupDisplayType","treeDataDisplayType","treeDataChildrenField","treeDataParentIdField","colResizeDefault","tooltipTrigger","serverSidePivotResultFieldSeparator","columnMenu","tooltipShowMode","invalidEditValueMode","grandTotalRow","themeCssLayer","findSearchValue","styleNonce","renderingMode"],Xee=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","dragAndDropImageComponentParams","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","themeStyleContainer","statusBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions","advancedFilterParent","advancedFilterBuilderParams","advancedFilterParams","initialState","autoSizeStrategy","selectionColumnDef","findOptions","filterHandlers","groupHierarchyConfig"],Jee=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass","paginationPageSizeSelector"],M8=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","groupLockGroupColumns","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","pivotDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDuration","cellFadeDuration","tabIndex","pivotMaxGeneratedColumns","rowDragInsertDelay"],Qee=["theme","rowSelection"],r2=["cellSelection","sideBar","rowNumbers","suppressGroupChangesColumnVisibility","groupAggFiltering","suppressStickyTotalRow","groupHideParentOfSingleChild","enableRowPinning"],I8=["loadThemeGoogleFonts","suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHeaderFocus","suppressHorizontalScroll","groupSelectsChildren","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressColumnMoveAnimation","suppressMoveWhenColumnDragging","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","allowContextMenuWithControlKey","suppressContextMenu","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressFocusAfterRefresh","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","enableCellSpan","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","includeHiddenColumnsInAdvancedFilter","suppressMultiRangeSelection","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","tooltipInteraction","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideSortAllLevels","serverSideEnableClientSideSort","serverSideOnlyRefreshFilteredGroups","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","groupMaintainOrder","columnHoverHighlight","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressCutToClipboard","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","enableAdvancedFilter","masterDetail","treeData","reactiveCustomComponents","applyQuickFilterBeforePivotOrAgg","suppressServerSideFullWidthLoadingRow","suppressAdvancedFilterEval","loading","maintainColumnOrder","enableStrictPivotColumnOrder","suppressSetFilterByDefault","enableFilterHandlers","suppressStartEditOnTab","hidePaddedHeaderRows","ssrmExpandAllAffectsAllRows"],Zee=["doesExternalFilterPass","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","dragAndDropImageComponent","fullWidthCellRenderer","loadingCellRenderer","loadingOverlayComponent","noRowsOverlayComponent","detailCellRenderer","quickFilterParser","quickFilterMatcher","getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getFullRowEditValidationErrors","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","focusGridInnerElement","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processUnpinnedColumns","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","loadingCellRendererSelector","getRowId","chartMenuItems","groupTotalRow","alwaysPassFilter","isRowPinnable","isRowPinned","isRowValidDropPosition"],ete=()=>[...Jee,...Xee,...Yee,...M8,...Zee,...I8,...r2,...Qee],tte=()=>({suppressLoadingOverlay:{version:"32",message:"Use `loading`=false instead."},enableFillHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeSelection:{version:"32.2",message:"Use `cellSelection = true` instead."},suppressMultiRangeSelection:{version:"32.2",message:"Use `cellSelection.suppressMultiRanges` instead."},suppressClearOnFillReduction:{version:"32.2",message:"Use `cellSelection.handle.suppressClearOnFillReduction` instead."},fillHandleDirection:{version:"32.2",message:"Use `cellSelection.handle.direction` instead."},fillOperation:{version:"32.2",message:"Use `cellSelection.handle.setFillValue` instead."},suppressRowClickSelection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},suppressRowDeselection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},rowMultiSelectWithClick:{version:"32.2",message:"Use `rowSelection.enableSelectionWithoutKeys` instead."},groupSelectsChildren:{version:"32.2",message:'Use `rowSelection.groupSelects = "descendants"` instead.'},groupSelectsFiltered:{version:"32.2",message:'Use `rowSelection.groupSelects = "filteredDescendants"` instead.'},isRowSelectable:{version:"32.2",message:"Use `selectionOptions.isRowSelectable` instead."},suppressCopySingleCellRanges:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},suppressCopyRowsToClipboard:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},onRangeSelectionChanged:{version:"32.2",message:"Use `onCellSelectionChanged` instead."},onRangeDeleteStart:{version:"32.2",message:"Use `onCellSelectionDeleteStart` instead."},onRangeDeleteEnd:{version:"32.2",message:"Use `onCellSelectionDeleteEnd` instead."},suppressBrowserResizeObserver:{version:"32.2",message:"The grid always uses the browser's ResizeObserver, this grid option has no effect."},onColumnEverythingChanged:{version:"32.2",message:"Either use `onDisplayedColumnsChanged` which is fired at the same time, or use one of the more specific column events."},groupRemoveSingleChildren:{version:"33",message:"Use `groupHideParentOfSingleChild` instead."},groupRemoveLowestSingleChildren:{version:"33",message:'Use `groupHideParentOfSingleChild: "leafGroupsOnly"` instead.'},suppressRowGroupHidesColumns:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressHideOnGroup"` instead.'},suppressMakeColumnVisibleAfterUnGroup:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressShowOnUngroup"` instead.'},unSortIcon:{version:"33",message:"Use `defaultColDef.unSortIcon` instead."},sortingOrder:{version:"33",message:"Use `defaultColDef.sortingOrder` instead."},suppressPropertyNamesCheck:{version:"33",message:"`gridOptions` and `columnDefs` both have a `context` property that should be used for arbitrary user data. This means that column definitions and gridOptions should only contain valid properties making this property redundant."},suppressAdvancedFilterEval:{version:"34",message:"Advanced filter no longer uses function evaluation, so this option has no effect."}});function Fr(t,e,i){return typeof e=="number"||e==null?e==null||e>=i?null:`${t}: value should be greater than or equal to ${i}`:`${t}: value should be a number`}var ite={alignedGrids:"AlignedGrids",allowContextMenuWithControlKey:"ContextMenu",autoSizeStrategy:"ColumnAutoSize",cellSelection:"CellSelection",columnHoverHighlight:"ColumnHover",datasource:"InfiniteRowModel",doesExternalFilterPass:"ExternalFilter",editType:"EditCore",invalidEditValueMode:"EditCore",enableAdvancedFilter:"AdvancedFilter",enableCellSpan:"CellSpan",enableCharts:"IntegratedCharts",enableRangeSelection:"CellSelection",enableRowPinning:"PinnedRow",findSearchValue:"Find",getFullRowEditValidationErrors:"EditCore",getContextMenuItems:"ContextMenu",getLocaleText:"Locale",getMainMenuItems:"ColumnMenu",getRowClass:"RowStyle",getRowStyle:"RowStyle",groupTotalRow:"SharedRowGrouping",grandTotalRow:"ClientSideRowModelHierarchy",initialState:"GridState",isExternalFilterPresent:"ExternalFilter",isRowPinnable:"PinnedRow",isRowPinned:"PinnedRow",localeText:"Locale",masterDetail:"SharedMasterDetail",pagination:"Pagination",pinnedBottomRowData:"PinnedRow",pinnedTopRowData:"PinnedRow",pivotMode:"SharedPivot",pivotPanelShow:"RowGroupingPanel",quickFilterText:"QuickFilter",rowClass:"RowStyle",rowClassRules:"RowStyle",rowData:"ClientSideRowModel",rowDragManaged:"RowDrag",rowGroupPanelShow:"RowGroupingPanel",rowNumbers:"RowNumbers",rowSelection:"SharedRowSelection",rowStyle:"RowStyle",serverSideDatasource:"ServerSideRowModel",sideBar:"SideBar",statusBar:"StatusBar",treeData:"SharedTreeData",undoRedoCellEditing:"UndoRedoEdit",valueCache:"ValueCache",viewportDatasource:"ViewportRowModel"},nte=()=>{let t={autoSizePadding:{validate({autoSizePadding:i}){return Fr("autoSizePadding",i,0)}},cacheBlockSize:{supportedRowModels:["serverSide","infinite"],validate({cacheBlockSize:i}){return Fr("cacheBlockSize",i,1)}},cacheOverflowSize:{validate({cacheOverflowSize:i}){return Fr("cacheOverflowSize",i,1)}},datasource:{supportedRowModels:["infinite"]},domLayout:{validate:i=>{let n=i.domLayout,r=["autoHeight","normal","print"];return n&&!r.includes(n)?`domLayout must be one of [${r.join()}], currently it's ${n}`:null}},enableFillHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeSelection:{dependencies:{rowDragEntireRow:{required:[!1,void 0]}}},enableRowPinning:{supportedRowModels:["clientSide"],validate({enableRowPinning:i,pinnedTopRowData:n,pinnedBottomRowData:r}){return i&&(n||r)?"Manual row pinning cannot be used together with pinned row data. Either set `enableRowPinning` to `false`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":null}},isRowPinnable:{supportedRowModels:["clientSide"],validate({enableRowPinning:i,isRowPinnable:n,pinnedTopRowData:r,pinnedBottomRowData:o}){return n&&(r||o)?"Manual row pinning cannot be used together with pinned row data. Either remove `isRowPinnable`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":!i&&n?"`isRowPinnable` requires `enableRowPinning` to be set.":null}},isRowPinned:{supportedRowModels:["clientSide"],validate({enableRowPinning:i,isRowPinned:n,pinnedTopRowData:r,pinnedBottomRowData:o}){return n&&(r||o)?"Manual row pinning cannot be used together with pinned row data. Either remove `isRowPinned`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":!i&&n?"`isRowPinned` requires `enableRowPinning` to be set.":null}},groupDefaultExpanded:{supportedRowModels:["clientSide"]},groupHideOpenParents:{supportedRowModels:["clientSide","serverSide"],dependencies:{groupTotalRow:{required:[void 0,"bottom"]},treeData:{required:[void 0,!1],reason:"Tree Data has values at the group level so it doesn't make sense to hide them."}}},groupHideParentOfSingleChild:{dependencies:{groupHideOpenParents:{required:[void 0,!1]}}},groupRemoveLowestSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveSingleChildren:{required:[void 0,!1]}}},groupRemoveSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveLowestSingleChildren:{required:[void 0,!1]}}},groupSelectsChildren:{dependencies:{rowSelection:{required:["multiple"]}}},groupHierarchyConfig:{validate({groupHierarchyConfig:i={}},n,r){for(let o of Object.keys(i))r.validation?.validateColDef(i[o]);return null}},icons:{validate:({icons:i})=>{if(i){if(i.smallDown)return Or(262);if(i.smallLeft)return Or(263);if(i.smallRight)return Or(264)}return null}},infiniteInitialRowCount:{validate({infiniteInitialRowCount:i}){return Fr("infiniteInitialRowCount",i,1)}},initialGroupOrderComparator:{supportedRowModels:["clientSide"]},ssrmExpandAllAffectsAllRows:{validate:i=>{if(typeof i.ssrmExpandAllAffectsAllRows=="boolean"){if(i.rowModelType!=="serverSide")return"'ssrmExpandAllAffectsAllRows' is only supported with the Server Side Row Model.";if(i.ssrmExpandAllAffectsAllRows&&typeof i.getRowId!="function")return"'getRowId' callback must be provided for Server Side Row Model grouping to work correctly."}return null}},keepDetailRowsCount:{validate({keepDetailRowsCount:i}){return Fr("keepDetailRowsCount",i,1)}},paginationPageSize:{validate({paginationPageSize:i}){return Fr("paginationPageSize",i,1)}},paginationPageSizeSelector:{validate:i=>{let n=i.paginationPageSizeSelector;return typeof n=="boolean"||n==null||n.length?null:`'paginationPageSizeSelector' cannot be an empty array.
                    If you want to hide the page size selector, set paginationPageSizeSelector to false.`}},pivotMode:{dependencies:{treeData:{required:[!1,void 0],reason:"Pivot Mode is not supported with Tree Data."}}},quickFilterText:{supportedRowModels:["clientSide"]},rowBuffer:{validate({rowBuffer:i}){return Fr("rowBuffer",i,0)}},rowClass:{validate:i=>typeof i.rowClass=="function"?"rowClass should not be a function, please use getRowClass instead":null},rowData:{supportedRowModels:["clientSide"]},rowDragManaged:{supportedRowModels:["clientSide"],dependencies:{pagination:{required:[!1,void 0]}}},rowSelection:{validate({rowSelection:i}){return i&&typeof i=="string"?'As of version 32.2.1, using `rowSelection` with the values "single" or "multiple" has been deprecated. Use the object value instead.':i&&typeof i!="object"?"Expected `RowSelectionOptions` object for the `rowSelection` property.":i&&i.mode!=="multiRow"&&i.mode!=="singleRow"?`Selection mode "${i.mode}" is invalid. Use one of 'singleRow' or 'multiRow'.`:null}},rowStyle:{validate:i=>{let n=i.rowStyle;return n&&typeof n=="function"?"rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead":null}},serverSideDatasource:{supportedRowModels:["serverSide"]},serverSideInitialRowCount:{supportedRowModels:["serverSide"],validate({serverSideInitialRowCount:i}){return Fr("serverSideInitialRowCount",i,1)}},serverSideOnlyRefreshFilteredGroups:{supportedRowModels:["serverSide"]},serverSideSortAllLevels:{supportedRowModels:["serverSide"]},sortingOrder:{validate:i=>{let n=i.sortingOrder;if(Array.isArray(n)&&n.length>0){let r=n.filter(o=>!gh.includes(o));if(r.length>0)return`sortingOrder must be an array with elements from [${gh.map(bm).join()}], currently it includes [${r.map(bm).join()}]`}else if(!Array.isArray(n)||n.length<=0)return`sortingOrder must be an array with at least one element, currently it's ${n}`;return null}},tooltipHideDelay:{validate:i=>i.tooltipHideDelay&&i.tooltipHideDelay<0?"tooltipHideDelay should not be lower than 0":null},tooltipShowDelay:{validate:i=>i.tooltipShowDelay&&i.tooltipShowDelay<0?"tooltipShowDelay should not be lower than 0":null},treeData:{supportedRowModels:["clientSide","serverSide"],validate:i=>{let n=i.rowModelType??"clientSide";switch(n){case"clientSide":{let{treeDataChildrenField:r,treeDataParentIdField:o,getDataPath:s,getRowId:a}=i;if(!r&&!o&&!s)return"treeData requires either 'treeDataChildrenField' or 'treeDataParentIdField' or 'getDataPath' in the clientSide row model.";if(r){if(s)return"Cannot use both 'treeDataChildrenField' and 'getDataPath' at the same time.";if(o)return"Cannot use both 'treeDataChildrenField' and 'treeDataParentIdField' at the same time."}if(o){if(!a)return"getRowId callback not provided, tree data with parent id cannot be built.";if(s)return"Cannot use both 'treeDataParentIdField' and 'getDataPath' at the same time."}return null}case"serverSide":{let r=`treeData requires 'isServerSideGroup' and 'getServerSideGroupKey' in the ${n} row model.`;return i.isServerSideGroup&&i.getServerSideGroupKey?null:r}}return null}},viewportDatasource:{supportedRowModels:["viewport"]},viewportRowModelBufferSize:{validate({viewportRowModelBufferSize:i}){return Fr("viewportRowModelBufferSize",i,0)}},viewportRowModelPageSize:{validate({viewportRowModelPageSize:i}){return Fr("viewportRowModelPageSize",i,1)}},rowDragEntireRow:{dependencies:{cellSelection:{required:[void 0]}}},autoGroupColumnDef:{validate({autoGroupColumnDef:i,showOpenedGroup:n}){return i?.field&&n?"autoGroupColumnDef.field and showOpenedGroup are not supported when used together.":i?.valueGetter&&n?"autoGroupColumnDef.valueGetter and showOpenedGroup are not supported when used together.":null}},renderingMode:{validate:i=>{let n=i.renderingMode,r=["default","legacy"];return n&&!r.includes(n)?`renderingMode must be one of [${r.join()}], currently it's ${n}`:null}},autoSizeStrategy:{validate:({autoSizeStrategy:i})=>{if(!i)return null;let n=["fitCellContents","fitGridWidth","fitProvidedWidth"],r=i.type;return r!=="fitCellContents"&&r!=="fitGridWidth"&&r!=="fitProvidedWidth"?`Invalid Auto-size strategy. \`autoSizeStrategy\` must be one of ${n.map(o=>'"'+o+'"').join(", ")}, currently it's ${r}`:r==="fitProvidedWidth"&&typeof i.width!="number"?`When using the 'fitProvidedWidth' auto-size strategy, must provide a numeric \`width\`. You provided ${i.width}`:null}}},e={};for(let i of I8)e[i]={expectedType:"boolean"};for(let i of M8)e[i]={expectedType:"number"};return Vi(e,t),e},rte=()=>({objectName:"gridOptions",allProperties:[...ete(),...Object.values(i2)],propertyExceptions:["api"],docsUrl:"grid-options/",deprecations:tte(),validations:nte()}),ote=0,ste=0,YT="__ag_grid_instance",ate=class extends H{constructor(){super(...arguments),this.beanName="gos",this.domDataKey="__AG_"+Math.random().toString(),this.instanceId=ste++,this.gridReadyFired=!1,this.queueEvents=[],this.propEventSvc=new ka,this.globalEventHandlerFactory=t=>(e,i)=>{if(!this.isAlive())return;let n=hm.has(e);if(n&&!t||!n&&t||!lte(e))return;let r=(o,s)=>{let a=i2[o],l=this.gridOptions[a];typeof l=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>l(s))};if(this.gridReadyFired)r(e,i);else if(e==="gridReady"){r(e,i),this.gridReadyFired=!0;for(let o of this.queueEvents)r(o.eventName,o.event);this.queueEvents=[]}else this.queueEvents.push({eventName:e,event:i})}}wireBeans(t){this.gridOptions=t.gridOptions,this.validation=t.validation,this.api=t.gridApi,this.gridId=t.context.getId()}get gridOptionsContext(){return this.gridOptions.context}postConstruct(){this.validateGridOptions(this.gridOptions),this.eventSvc.addGlobalListener(this.globalEventHandlerFactory().bind(this),!0),this.eventSvc.addGlobalListener(this.globalEventHandlerFactory(!0).bind(this),!1),this.propEventSvc.setFrameworkOverrides(this.beans.frameworkOverrides),this.addManagedEventListeners({gridOptionsChanged:({options:t})=>{this.updateGridOptions({options:t,force:!0,source:"optionsUpdated"})}})}destroy(){super.destroy(),this.queueEvents=[]}get(t){return this.gridOptions[t]??hq[t]}getCallback(t){return this.mergeGridCommonParams(this.gridOptions[t])}exists(t){return ae(this.gridOptions[t])}mergeGridCommonParams(t){return t&&(i=>t(this.addCommon(i)))}updateGridOptions({options:t,force:e,source:i="api"}){let n={id:ote++,properties:[]},r=[],{gridOptions:o,validation:s}=this;for(let a of Object.keys(t)){let l=TS.applyGlobalGridOption(a,t[a]);s?.warnOnInitialPropertyUpdate(i,a);let c=e||typeof l=="object"&&i==="api",d=o[a];if(c||d!==l){o[a]=l;let u={type:a,currentValue:l,previousValue:d,changeSet:n,source:i};r.push(u)}}this.validateGridOptions(this.gridOptions),n.properties=r.map(a=>a.type);for(let a of r)Cs(this,`Updated property ${a.type} from`,a.previousValue," to ",a.currentValue),this.propEventSvc.dispatchEvent(a)}addPropertyEventListener(t,e){this.propEventSvc.addEventListener(t,e)}removePropertyEventListener(t,e){this.propEventSvc.removeEventListener(t,e)}getDomDataKey(){return this.domDataKey}addCommon(t){return t.api=this.api,t.context=this.gridOptionsContext,t}validateOptions(t,e){for(let i of Object.keys(t)){let n=t[i];if(n==null||n===!1)continue;let r=e[i];typeof r=="function"&&(r=r(t,this.gridOptions,this.beans)),r&&this.assertModuleRegistered(r,i)}}validateGridOptions(t){this.validateOptions(t,ite),this.validation?.processGridOptions(t)}validateColDef(t,e,i){(i||!this.beans.dataTypeSvc?.isColPendingInference(e))&&(this.validateOptions(t,Uee),this.validation?.validateColDef(t))}assertModuleRegistered(t,e){let i=Array.isArray(t)?t.some(n=>this.isModuleRegistered(n)):this.isModuleRegistered(t);return i||at(200,k(w({},this.getModuleErrorParams()),{moduleName:t,reasonOrId:e})),i}getModuleErrorParams(){return{gridId:this.gridId,gridScoped:DS(),rowModelType:this.get("rowModelType"),isUmd:HD()}}isModuleRegistered(t){return Uy(t,this.gridId,this.get("rowModelType"))}setInstanceDomData(t){t[YT]=this.instanceId}isElementInThisInstance(t){let e=t;for(;e;){let i=e[YT];if(ae(i))return i===this.instanceId;e=e.parentElement}return!1}};function lte(t){return!!i2[t]}function A8(t){let e={"aria-hidden":"true"};return{tag:"div",cls:"ag-cell-label-container",role:"presentation",children:[{tag:"span",ref:"eMenu",cls:"ag-header-icon ag-header-cell-menu-button",attrs:e},{tag:"span",ref:"eFilterButton",cls:"ag-header-icon ag-header-cell-filter-button",attrs:e},{tag:"div",ref:"eLabel",cls:"ag-header-cell-label",role:"presentation",children:[{tag:"span",ref:"eText",cls:"ag-header-cell-text"},{tag:"span",ref:"eFilter",cls:"ag-header-icon ag-header-label-icon ag-filter-icon",attrs:e},t?{tag:"ag-sort-indicator",ref:"eSortIndicator"}:null]}]}}var cte=A8(!0),dte=A8(!1),ute=class extends et{constructor(){super(...arguments),this.eFilter=re,this.eFilterButton=re,this.eSortIndicator=re,this.eMenu=re,this.eLabel=re,this.eText=re,this.eSortOrder=re,this.eSortAsc=re,this.eSortDesc=re,this.eSortMixed=re,this.eSortNone=re,this.isLoadingInnerComponent=!1}refresh(t){let e=this.params;if(this.params=t,this.workOutTemplate(t,!!this.beans?.sortSvc)!=this.currentTemplate||this.workOutShowMenu()!=this.currentShowMenu||t.enableSorting!=this.currentSort||this.currentSuppressMenuHide!=null&&this.shouldSuppressMenuHide()!=this.currentSuppressMenuHide||e.enableFilterButton!=t.enableFilterButton||e.enableFilterIcon!=t.enableFilterIcon)return!1;if(this.innerHeaderComponent){let i=w({},t);Vi(i,t.innerHeaderComponentParams),this.innerHeaderComponent.refresh?.(i)}else this.setDisplayName(t);return!0}workOutTemplate(t,e){let i=t.template;return i?i?.trim?i.trim():i:e?cte:dte}init(t){this.params=t;let{sortSvc:e,touchSvc:i,rowNumbersSvc:n,userCompFactory:r}=this.beans,o=e?.getSortIndicatorSelector();this.currentTemplate=this.workOutTemplate(t,!!o),this.setTemplate(this.currentTemplate,o?[o]:void 0),i?.setupForHeader(this),this.setMenu(),this.setupSort(),n?.setupForHeader(this),this.setupFilterIcon(),this.setupFilterButton(),this.workOutInnerHeaderComponent(r,t),this.setDisplayName(t)}workOutInnerHeaderComponent(t,e){let i=M$(t,e,e);i&&(this.isLoadingInnerComponent=!0,i.newAgStackInstance().then(n=>{this.isLoadingInnerComponent=!1,n&&(this.isAlive()?(this.innerHeaderComponent=n,this.eText&&this.eText.appendChild(n.getGui())):this.destroyBean(n))}))}setDisplayName(t){let{displayName:e}=t,i=this.currentDisplayName;this.currentDisplayName=e,!(!this.eText||i===e||this.innerHeaderComponent||this.isLoadingInnerComponent)&&(this.eText.textContent=Cc(e))}addInIcon(t,e,i){let n=Mn(t,this.beans,i);n&&e.appendChild(n)}workOutShowMenu(){return this.params.enableMenu&&!!this.beans.menuSvc?.isHeaderMenuButtonEnabled()}shouldSuppressMenuHide(){return!!this.beans.menuSvc?.isHeaderMenuButtonAlwaysShowEnabled()}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu){Xi(this.eMenu),this.eMenu=void 0;return}let{gos:t,eMenu:e,params:i}=this,n=dn(t);this.addInIcon(n?"menu":"menuAlt",e,i.column),e.classList.toggle("ag-header-menu-icon",!n);let r=this.shouldSuppressMenuHide();this.currentSuppressMenuHide=r,this.addManagedElementListeners(e,{click:()=>this.showColumnMenu(this.eMenu)}),this.toggleMenuAlwaysShow(r)}toggleMenuAlwaysShow(t){this.eMenu?.classList.toggle("ag-header-menu-always-show",t)}showColumnMenu(t){let{currentSuppressMenuHide:e,params:i}=this;e||this.toggleMenuAlwaysShow(!0),i.showColumnMenu(t,()=>{e||this.toggleMenuAlwaysShow(!1)})}onMenuKeyboardShortcut(t){let{params:e,gos:i,beans:n,eMenu:r,eFilterButton:o}=this,s=e.column,a=dn(i);if(t&&!a){if(n.menuSvc?.isFilterMenuInHeaderEnabled(s))return e.showFilter(o??r??this.getGui()),!0}else if(e.enableMenu)return this.showColumnMenu(r??o??this.getGui()),!0;return!1}setupSort(){let{sortSvc:t}=this.beans;if(!t)return;let{enableSorting:e,column:i}=this.params;if(this.currentSort=e,!this.eSortIndicator){this.eSortIndicator=this.createBean(t.createSortIndicator(!0));let{eSortIndicator:n,eSortOrder:r,eSortAsc:o,eSortDesc:s,eSortMixed:a,eSortNone:l}=this;n.attachCustomElements(r,o,s,a,l)}this.eSortIndicator.setupSort(i),this.currentSort&&t.setupHeader(this,i,this.eLabel)}setupFilterIcon(){let{eFilter:t,params:e}=this;if(!t)return;let i=()=>{let n=e.column.isFilterActive();Ct(t,n,{skipAriaHidden:!0})};this.configureFilter(e.enableFilterIcon,t,i,"filterActive")}setupFilterButton(){let{eFilterButton:t,params:e}=this;if(!t)return;this.configureFilter(e.enableFilterButton,t,this.onFilterChangedButton.bind(this),"filter")?this.addManagedElementListeners(t,{click:()=>e.showFilter(t)}):this.eFilterButton=void 0}configureFilter(t,e,i,n){if(!t)return Xi(e),!1;let r=this.params.column;return this.addInIcon(n,e,r),this.addManagedListeners(r,{filterChanged:i}),i(),!0}onFilterChangedButton(){let t=this.params.column.isFilterActive();this.eFilterButton.classList.toggle("ag-filter-active",t)}getAnchorElementForMenu(t){let{eFilterButton:e,eMenu:i}=this;return t?e??i??this.getGui():i??e??this.getGui()}destroy(){super.destroy(),this.innerHeaderComponent&&(this.destroyBean(this.innerHeaderComponent),this.innerHeaderComponent=void 0)}},hte={tag:"div",cls:"ag-header-group-cell-label",role:"presentation",children:[{tag:"span",ref:"agLabel",cls:"ag-header-group-text",role:"presentation"},{tag:"span",ref:"agOpened",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"},{tag:"span",ref:"agClosed",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"}]},pte=class extends et{constructor(){super(hte),this.agOpened=re,this.agClosed=re,this.agLabel=re,this.isLoadingInnerComponent=!1}init(t){let{userCompFactory:e,touchSvc:i}=this.beans;this.params=t,this.checkWarnings(),this.workOutInnerHeaderGroupComponent(e,t),this.setupLabel(t),this.addGroupExpandIcon(t),this.setupExpandIcons(),i?.setupForHeaderGroup(this)}checkWarnings(){this.params.template&&K(89)}workOutInnerHeaderGroupComponent(t,e){let i=A$(t,e,e);i&&(this.isLoadingInnerComponent=!0,i.newAgStackInstance().then(n=>{this.isLoadingInnerComponent=!1,n&&(this.isAlive()?(this.innerHeaderGroupComponent=n,this.agLabel.appendChild(n.getGui())):this.destroyBean(n))}))}setupExpandIcons(){let{agOpened:t,agClosed:e,params:{columnGroup:i},beans:n}=this;this.addInIcon("columnGroupOpened",t),this.addInIcon("columnGroupClosed",e);let r=l=>{if(yo(l))return;let c=!i.isExpanded();n.colGroupSvc.setColumnGroupOpened(i.getProvidedColumnGroup(),c,"uiColumnExpanded")};this.addTouchAndClickListeners(n,e,r),this.addTouchAndClickListeners(n,t,r);let o=l=>{Da(l)};this.addManagedElementListeners(e,{dblclick:o}),this.addManagedElementListeners(t,{dblclick:o}),this.addManagedElementListeners(this.getGui(),{dblclick:r}),this.updateIconVisibility();let s=i.getProvidedColumnGroup(),a=this.updateIconVisibility.bind(this);this.addManagedListeners(s,{expandedChanged:a,expandableChanged:a})}addTouchAndClickListeners(t,e,i){t.touchSvc?.setupForHeaderGroupElement(this,e,i),this.addManagedElementListeners(e,{click:i})}updateIconVisibility(){let{agOpened:t,agClosed:e,params:{columnGroup:i}}=this;if(i.isExpandable()){let n=i.isExpanded();Ct(t,n),Ct(e,!n)}else Ct(t,!1),Ct(e,!1)}addInIcon(t,e){let i=Mn(t,this.beans,null);i&&e.appendChild(i)}addGroupExpandIcon(t){if(!t.columnGroup.isExpandable()){let{agOpened:e,agClosed:i}=this;Ct(e,!1),Ct(i,!1)}}setupLabel(t){let{displayName:e,columnGroup:i}=t,n=this.innerHeaderGroupComponent||this.isLoadingInnerComponent;ae(e)&&!n&&(this.agLabel.textContent=Cc(e)),this.toggleCss("ag-sticky-label",!i.getColGroupDef()?.suppressStickyLabel)}destroy(){super.destroy(),this.innerHeaderGroupComponent&&(this.destroyBean(this.innerHeaderGroupComponent),this.innerHeaderGroupComponent=void 0)}},fte={moduleName:"ColumnHeaderComp",version:oe,userComponents:{agColumnHeader:ute},icons:{menu:"menu",menuAlt:"menu-alt"}},gte={moduleName:"ColumnGroupHeaderComp",version:oe,userComponents:{agColumnGroupHeader:pte},icons:{columnGroupOpened:"expanded",columnGroupClosed:"contracted"}},mte=class extends H{constructor(){super(...arguments),this.beanName="animationFrameSvc",this.p1={list:[],sorted:!1},this.p2={list:[],sorted:!1},this.f1={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastScrollTop=0,this.taskCount=0}setScrollTop(t){this.scrollGoingDown=t>=this.lastScrollTop,t===0&&(this.scrollGoingDown=!0),this.lastScrollTop=t}postConstruct(){this.active=!this.gos.get("suppressAnimationFrame"),this.batchFrameworkComps=this.beans.frameworkOverrides.batchFrameworkComps}verify(){this.active===!1&&K(92)}createTask(t,e,i,n,r=!1){this.verify();let o=i;n&&this.batchFrameworkComps&&(o="f1");let s={task:t,index:e,createOrder:++this.taskCount,deferred:r};this.addTaskToList(this[o],s),this.schedule()}addTaskToList(t,e){t.list.push(e),t.sorted=!1}sortTaskList(t){if(t.sorted)return;let e=this.scrollGoingDown?1:-1;t.list.sort((i,n)=>i.deferred!==n.deferred?i.deferred?-1:1:i.index!==n.index?e*(n.index-i.index):n.createOrder-i.createOrder),t.sorted=!0}addDestroyTask(t){this.verify(),this.destroyTasks.push(t),this.schedule()}executeFrame(t){let{p1:e,p2:i,f1:n,destroyTasks:r,beans:o}=this,{ctrlsSvc:s,frameworkOverrides:a}=o,l=e.list,c=i.list,d=n.list,u=Date.now(),h=0,p=t<=0,f=s.getScrollFeature();for(;p||h<t;){if(!f.scrollGridIfNeeded()){let m;if(l.length)this.sortTaskList(e),m=l.pop().task;else if(c.length)this.sortTaskList(i),m=c.pop().task;else if(d.length)a.wrapOutgoing(()=>{for(;(p||h<t)&&!f.scrollGridIfNeeded();){if(d.length)this.sortTaskList(n),m=d.pop().task,m();else break;h=Date.now()-u}}),m=()=>{};else if(r.length)m=r.pop();else break;m()}h=Date.now()-u}l.length||c.length||d.length||r.length?this.requestFrame():this.ticking=!1}flushAllFrames(){this.active&&this.executeFrame(-1)}schedule(){this.active&&(this.ticking||(this.ticking=!0,this.requestFrame()))}requestFrame(){let t=this.executeFrame.bind(this,60);Eo(this.beans,t)}isQueueEmpty(){return!this.ticking}},vte={moduleName:"AnimationFrame",version:oe,beans:[mte]},Cte=class extends H{constructor(){super(...arguments),this.beanName="iconSvc"}createIconNoSpan(t,e){return Mn(t,this.beans,e?.column)}},wte=class extends H{constructor(){super(...arguments),this.beanName="touchSvc"}mockBodyContextMenu(t,e){this.mockContextMenu(t,t.eBodyViewport,e)}mockHeaderContextMenu(t,e){this.mockContextMenu(t,t.eGui,e)}mockRowContextMenu(t){if(!Pa())return;let e=(i,n,r)=>{let{rowCtrl:o,cellCtrl:s}=t.getControlsForEventTarget(r?.target??null);s?.column&&s.dispatchCellContextMenuEvent(r??null),this.beans.contextMenuSvc?.handleContextMenuMouseEvent(void 0,r,o,s)};this.mockContextMenu(t,t.element,e)}handleCellDoubleClick(t,e){return(()=>{if(!Pa()||DD("dblclick"))return!1;let n=Date.now(),r=n-t.lastIPadMouseClickEvent<200;return t.lastIPadMouseClickEvent=n,r})()?(t.onCellDoubleClicked(e),e.preventDefault(),!0):!1}setupForHeader(t){let{gos:e,sortSvc:i,menuSvc:n}=this.beans;if(e.get("suppressTouch"))return;let{params:r,eMenu:o,eFilterButton:s}=t,a=new wa(t.getGui(),!0);t.addDestroyFunc(()=>a.destroy());let l=t.shouldSuppressMenuHide(),c=l&&ae(o)&&r.enableMenu,d=a;if(c&&(d=new wa(o,!0),t.addDestroyFunc(()=>d.destroy())),r.enableMenu||n?.isHeaderContextMenuEnabled(r.column)){let u=c?"tap":"longTap",h=p=>r.showColumnMenuAfterMouseClick(p.touchStart);t.addManagedListeners(d,{[u]:h}),t.addManagedListeners(a,{longTap:h})}if(r.enableSorting){let u=h=>{let p=h.touchStart.target;l&&(o?.contains(p)||s?.contains(p))||i?.progressSort(r.column,!1,"uiColumnSorted")};t.addManagedListeners(a,{tap:u})}if(r.enableFilterButton&&s){let u=new wa(s,!0);t.addManagedListeners(u,{tap:()=>r.showFilter(s)}),t.addDestroyFunc(()=>u.destroy())}}setupForHeaderGroup(t){let e=t.params;if(this.beans.menuSvc?.isHeaderContextMenuEnabled(e.columnGroup.getProvidedColumnGroup())){let i=new wa(e.eGridHeader,!0),n=r=>e.showColumnMenuAfterMouseClick(r.touchStart);t.addManagedListeners(i,{longTap:n}),t.addDestroyFunc(()=>i.destroy())}}setupForHeaderGroupElement(t,e,i){let n=new wa(e,!0);t.addManagedListeners(n,{tap:i}),t.addDestroyFunc(()=>n.destroy())}mockContextMenu(t,e,i){if(!Pa())return;let n=new wa(e),r=o=>{lh(this.beans,o.touchEvent)&&i(void 0,o.touchStart,o.touchEvent)};t.addManagedListeners(n,{longTap:r}),t.addDestroyFunc(()=>n.destroy())}},bte={moduleName:"Touch",version:oe,beans:[wte]},yte=class extends H{constructor(){super(...arguments),this.beanName="cellNavigation"}wireBeans(t){this.rowSpanSvc=t.rowSpanSvc}getNextCellToFocus(t,e,i=!1){return i?this.getNextCellToFocusWithCtrlPressed(t,e):this.getNextCellToFocusWithoutCtrlPressed(t,e)}getNextCellToFocusWithCtrlPressed(t,e){let i=t===A.UP,n=t===A.DOWN,r=t===A.LEFT,o,s,{pageBounds:a,gos:l,visibleCols:c,pinnedRowModel:d}=this.beans,{rowPinned:u}=e;if(i||n)u&&d?i?s=0:s=u==="top"?d.getPinnedTopRowCount()-1:d.getPinnedBottomRowCount()-1:s=i?a.getFirstRow():a.getLastRow(),o=e.column;else{let h=l.get("enableRtl");s=e.rowIndex,o=(r!==h?c.allCols:[...c.allCols].reverse()).find(f=>this.isCellGoodToFocusOn({rowIndex:s,rowPinned:null,column:f}))}return o?{rowIndex:s,rowPinned:u,column:o}:null}getNextCellToFocusWithoutCtrlPressed(t,e){let i=e,n=!1;for(;!n;){switch(t){case A.UP:i=this.getCellAbove(i);break;case A.DOWN:i=this.getCellBelow(i);break;case A.RIGHT:i=this.gos.get("enableRtl")?this.getCellToLeft(i):this.getCellToRight(i);break;case A.LEFT:i=this.gos.get("enableRtl")?this.getCellToRight(i):this.getCellToLeft(i);break;default:i=null,K(8,{key:t});break}i?n=this.isCellGoodToFocusOn(i):n=!0}return i}isCellGoodToFocusOn(t){let e=t.column,i,{pinnedRowModel:n,rowModel:r}=this.beans;switch(t.rowPinned){case"top":i=n?.getPinnedTopRow(t.rowIndex);break;case"bottom":i=n?.getPinnedBottomRow(t.rowIndex);break;default:i=r.getRow(t.rowIndex);break}return i?!this.isSuppressNavigable(e,i):!1}getCellToLeft(t){if(!t)return null;let e=this.beans.visibleCols.getColBefore(t.column);return e?{rowIndex:t.rowIndex,column:e,rowPinned:t.rowPinned}:null}getCellToRight(t){if(!t)return null;let e=this.beans.visibleCols.getColAfter(t.column);return e?{rowIndex:t.rowIndex,column:e,rowPinned:t.rowPinned}:null}getCellBelow(t){if(!t)return null;let e=this.rowSpanSvc?.getCellEnd(t)??t,i=OT(this.beans,e,!0);return i?{rowIndex:i.rowIndex,column:t.column,rowPinned:i.rowPinned}:null}getCellAbove(t){if(!t)return null;let e=this.rowSpanSvc?.getCellStart(t)??t,i=Mm(this.beans,{rowIndex:e.rowIndex,rowPinned:e.rowPinned},!0);return i?{rowIndex:i.rowIndex,column:t.column,rowPinned:i.rowPinned}:null}getNextTabbedCell(t,e){return e?this.getNextTabbedCellBackwards(t):this.getNextTabbedCellForwards(t)}getNextTabbedCellForwards(t){let{visibleCols:e,pagination:i}=this.beans,n=e.allCols,r=t.rowIndex,o=t.rowPinned,s=e.getColAfter(t.column);if(!s){s=n[0];let a=OT(this.beans,t,!0);if(wt(a)||!a.rowPinned&&!(i?.isRowInPage(a.rowIndex)??!0))return null;r=a?a.rowIndex:null,o=a?a.rowPinned:null}return{rowIndex:r,column:s,rowPinned:o}}getNextTabbedCellBackwards(t){let{beans:e}=this,{visibleCols:i,pagination:n}=e,r=i.allCols,o=t.rowIndex,s=t.rowPinned,a=i.getColBefore(t.column);if(!a){a=dt(r);let l=Mm(e,{rowIndex:t.rowIndex,rowPinned:t.rowPinned},!0);if(wt(l)||!l.rowPinned&&!(n?.isRowInPage(l.rowIndex)??!0))return null;o=l?l.rowIndex:null,s=l?l.rowPinned:null}return{rowIndex:o,column:a,rowPinned:s}}isSuppressNavigable(t,e){let{suppressNavigable:i}=t.colDef;if(typeof i=="boolean")return i;if(typeof i=="function"){let n=t.createColumnFunctionCallbackParams(e);return i(n)}return!1}};function Ste(t){return t.focusSvc.getFocusedCell()}function xte(t){return t.focusSvc.clearFocusedCell()}function Ete(t,e,i,n){t.focusSvc.setFocusedCell({rowIndex:e,column:i,rowPinned:n,forceBrowserFocus:!0})}function Pte(t,e){return t.navigation?.tabToNextCell(!1,e)??!1}function Rte(t,e){return t.navigation?.tabToNextCell(!0,e)??!1}function _te(t,e,i=!1){let n=t.headerNavigation?.getHeaderPositionForColumn(e,i);n&&t.focusSvc.focusHeaderPosition({headerPosition:n})}var kte=class extends H{constructor(){super(...arguments),this.beanName="editModelSvc",this.edits=new Map,this.cellValidations=new O8,this.rowValidations=new L8,this.suspendEdits=!1}suspend(t){this.suspendEdits=t}removeEdits({rowNode:t,column:e}){if(!this.hasEdits({rowNode:t})||!t)return;let i=this.getEditRow(t);e?i.delete(e):i.clear(),i.size===0&&this.edits.delete(t)}getEditRow(t,e={}){if(this.suspendEdits||this.edits.size===0)return;let i=t&&this.edits.get(t);if(i)return i;if(e.checkSiblings){let n=t.pinnedSibling;if(n)return this.getEditRow(n)}}getEditRowDataValue(t,{checkSiblings:e}={}){if(!t||this.edits.size===0)return;let i=this.getEditRow(t),n=t.pinnedSibling,r=e&&n&&this.getEditRow(n);if(!i&&!r)return;let o=Object.assign({},t.data),s=(a,l)=>a.forEach(({pendingValue:c},d)=>{c!==In&&(l[d.getColId()]=c)});return i&&s(i,o),r&&s(r,o),o}getEdit(t,e){let i=this._getEdit(t);return e&&i?w({},i):i}_getEdit(t){if(!this.suspendEdits&&this.edits.size!==0)return t.rowNode&&t.column&&this.getEditRow(t.rowNode)?.get(t.column)}getEditMap(t=!0){if(this.suspendEdits||this.edits.size===0)return new Map;if(!t)return this.edits;let e=new Map;return this.edits.forEach((i,n)=>{let r=new Map;i.forEach((l,a)=>{var c=l,{editorState:o}=c,s=Vt(c,["editorState"]);return r.set(a,w({},s))}),e.set(n,r)}),e}setEditMap(t){this.edits.clear(),t.forEach((e,i)=>{let n=new Map;e.forEach((r,o)=>n.set(o,w({},r))),this.edits.set(i,n)})}setEdit(t,e){(this.edits.size===0||!this.edits.has(t.rowNode))&&this.edits.set(t.rowNode,new Map);let i=this._getEdit(t),n=Object.assign(w(w({editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}},i),e));return this.getEditRow(t.rowNode).set(t.column,n),n}clearEditValue(t){let{rowNode:e,column:i}=t;if(e)if(i){let n=this._getEdit(t);n&&(n.editorValue=void 0,n.pendingValue=n.sourceValue,n.state="changed")}else this.getEditRow(e)?.forEach(n=>{n.editorValue=void 0,n.pendingValue=n.sourceValue,n.state="changed"})}getState(t){if(!this.suspendEdits)return this.getEdit(t)?.state}getEditPositions(t){if(this.suspendEdits||(t??this.edits).size===0)return[];let e=[];return(t??this.edits).forEach((i,n)=>{for(let o of i.keys()){let r=i.get(o),{editorState:s}=r,a=Vt(r,["editorState"]);e.push(w({rowNode:n,column:o},a))}}),e}hasRowEdits(t,e){return this.suspendEdits||this.edits.size===0?!1:!!this.getEditRow(t,e)}hasEdits(t={},e={}){if(this.suspendEdits||this.edits.size===0)return!1;let{rowNode:i,column:n}=t,{withOpenEditor:r}=e;if(i){let o=this.getEditRow(i,e);return o?n?r?this.getEdit(t)?.state==="editing":o.has(n)??!1:o.size!==0?r?Array.from(o.values()).some(({state:s})=>s==="editing"):!0:!1:!1}return r?this.getEditPositions().some(({state:o})=>o==="editing"):this.edits.size>0}start(t){let e=this.getEditRow(t.rowNode)??new Map,{rowNode:i,column:n}=t;n&&!e.has(n)&&e.set(n,{editorValue:void 0,pendingValue:In,sourceValue:this.beans.valueSvc.getValue(n,i,!1,"api"),state:"editing",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}}),this.edits.set(i,e)}stop(t){this.hasEdits(t)&&(t?this.removeEdits(t):this.clear())}clear(){for(let t of this.edits.values())t.clear();this.edits.clear()}getCellValidationModel(){return this.cellValidations}getRowValidationModel(){return this.rowValidations}setCellValidationModel(t){this.cellValidations=t}setRowValidationModel(t){this.rowValidations=t}destroy(){super.destroy(),this.clear()}},O8=class{constructor(){this.cellValidations=new Map}getCellValidation(t){let{rowNode:e,column:i}=t||{};return this.cellValidations?.get(e)?.get(i)}hasCellValidation(t){return!t?.rowNode||!t.column?this.cellValidations.size>0:!!this.getCellValidation(t)}setCellValidation(t,e){let{rowNode:i,column:n}=t;this.cellValidations.has(i)||this.cellValidations.set(i,new Map),this.cellValidations.get(i).set(n,e)}clearCellValidation(t){let{rowNode:e,column:i}=t;this.cellValidations.get(e)?.delete(i)}setCellValidationMap(t){this.cellValidations=t}getCellValidationMap(){return this.cellValidations}clearCellValidationMap(){this.cellValidations.clear()}},L8=class{constructor(){this.rowValidations=new Map}getRowValidation(t){let{rowNode:e}=t||{};return this.rowValidations.get(e)}hasRowValidation(t){return t?.rowNode?!!this.getRowValidation(t):this.rowValidations.size>0}setRowValidation({rowNode:t},e){this.rowValidations.set(t,e)}clearRowValidation({rowNode:t}){this.rowValidations.delete(t)}setRowValidationMap(t){this.rowValidations=t}getRowValidationMap(){return this.rowValidations}clearRowValidationMap(){this.rowValidations.clear()}};function o2(t,e={}){let{rowIndex:i,rowId:n,rowCtrl:r,rowPinned:o}=e;if(r)return r;let{rowModel:s,rowRenderer:a}=t,{rowNode:l}=e;return l||(n?l=eQ(t,n,o):i!=null&&(l=s.getRow(i))),a.getRowCtrls(l?[l]:[])?.[0]}function yt(t,e={}){let{cellCtrl:i,colId:n,columnId:r,column:o}=e;if(i)return i;let s=t.colModel.getCol(n??r??fS(o)),a=e.rowCtrl??o2(t,e),l=a?.getCellCtrl(s)??void 0;if(l)return l;let c=e.rowNode??a?.rowNode;if(c)return t.rowRenderer.getCellCtrls([c],[s])?.[0]}function XT(t){let{editSvc:e}=t;e?.isBatchEditing()?dc(t):e?.stopEditing(void 0,{source:"api"})}function Fte(t,e,i){let{gos:n,popupSvc:r}=e;if(!n.get("stopEditingWhenCellsLoseFocus"))return;let o=s=>{let a=s.relatedTarget;if(Qy(a)===null){XT(e);return}let l=i.some(c=>c.contains(a))&&n.isElementInThisInstance(a);l||(l=!!r&&(r.getActivePopups().some(c=>c.contains(a))||r.isElementWithinCustomPopup(a))),l||XT(e)};for(let s of i)t.addManagedElementListeners(s,{focusout:o})}function fS(t){if(t)return typeof t=="string"?t:t.getColId()}var In=Symbol("unedited");function N8(t,e={}){let i=[],n=t.rowRenderer.getCellCtrls(e.rowNodes,e.columns);for(let r of n){let o=r.comp?.getCellEditor();o&&i.push({ctrl:r,editor:hh(o)})}return i}var Tte=(t,e={})=>N8(t,e).map(i=>i.editor);function Dte(t,e,i,n,r,o){e.length===0&&i?.rowNode&&i?.column&&vc(t,i,{key:n,event:r,cellStartedEdit:o});let{valueSvc:s,editSvc:a,editModelSvc:l}=t,{rowNode:c,column:d}=i??{};for(let u of e){let{rowNode:h,column:p}=u,f=yt(t,u);if(!f){if(h&&p){let m=s.getValue(p,h,void 0,"api"),b=(i?.rowNode===h&&i?.column===p&&n||void 0)??a?.getCellDataValue(u,!1)??s.getValueForDisplay(p,h)?.value??m??In;l?.setEdit(u,{pendingValue:b,sourceValue:m,state:"editing"})}continue}let g=o&&c===f.rowNode&&f.column===d;vc(t,{rowNode:c,column:f.column},{key:g?n:null,event:g?r:null,cellStartedEdit:g&&o})}}function vo({pendingValue:t,sourceValue:e}){return t===In&&(t=e),t!==e}function vc(t,e,i){let n=t.gos.get("enableGroupEdit"),{key:r,event:o,cellStartedEdit:s,silent:a}=i??{},l=yt(t,e),c=l?.comp?.getCellEditor(),d=H8(t,e,r,s&&!a),u=t.editModelSvc?.getEdit(e),h=d.value;if(h===void 0&&(h=u?.sourceValue),t.editModelSvc?.setEdit(e,{editorValue:h,state:"editing"}),c){c.refresh?.(d);return}let p=e.column.getColDef(),f=vM(t.userCompFactory,p,d),g=f?.popupFromSelector!=null?f.popupFromSelector:!!p.cellEditorPopup,m=f?.popupPositionFromSelector!=null?f.popupPositionFromSelector:p.cellEditorPopupPosition;if(z8(f.params,o),l){l.editCompDetails=f,l.onEditorAttachedFuncs.push(()=>l.rangeFeature?.unsetComp()),l.comp?.setEditDetails(f,g,m,t.gos.get("reactiveCustomComponents")),l?.rowCtrl?.refreshRow({suppressFlash:!0});let v=t.editModelSvc?.getEdit(e,!0);!a&&!v?.editorState?.cellStartedEditing&&(t.editSvc?.dispatchCellEvent(e,o,"cellEditingStarted",n?{value:h}:{}),t.editModelSvc?.setEdit(e,{editorState:{cellStartedEditing:!0}}))}}function B8(t,e,i){let n={editorValueExists:!1};if(s2(t)&&(e.getValidationErrors?.()?.length??0)>0||i?.isCancelling)return n;if(i?.isStopping){let o=e?.isCancelAfterEnd?.();if(o)return k(w({},n),{isCancelAfterEnd:o})}return{editorValue:e.getValue(),editorValueExists:!0}}function H8(t,e,i,n){let{valueSvc:r,gos:o,editSvc:s}=t,a=t.gos.get("enableGroupEdit"),l=yt(t,e),c=e.rowNode?.rowIndex??void 0,d=s?.isBatchEditing(),u=t.colModel.getCol(e.column.getId()),{rowNode:h,column:p}=e,f=l.comp?.getCellEditor(),g=s?.getCellDataValue(e,!1),m=g===void 0?f?B8(t,f)?.editorValue:void 0:g,v=m===In?r.getValueForDisplay(u,h)?.value:m;return Ee(o,{value:a?m:v,eventKey:i??null,column:p,colDef:p.getColDef(),rowIndex:c,node:h,data:h.data,cellStartedEdit:n??!1,onKeyDown:l?.onKeyDown.bind(l),stopEditing:C=>{s.stopEditing(e,{source:d?"ui":"api",suppressNavigateAfterEdit:C}),Im(t,e)},eGridCell:l?.eGui,parseValue:C=>r.parseValue(u,h,C,l?.value),formatValue:l?.formatValue.bind(l),validate:()=>{s?.validateEdit()}})}function gS(t,e){let{editModelSvc:i}=t;i?.getEditMap().forEach((n,r)=>{n.forEach((o,s)=>{!e&&(o.state==="editing"||o.pendingValue===In)||!vo(o)&&(o.state!=="editing"||e)&&i?.removeEdits({rowNode:r,column:s})})})}function Mte(t,e){let i=e.comp?.getCellEditor();if(!i?.refresh)return;let{eventKey:n,cellStartedEdit:r}=e.editCompDetails.params,{column:o}=e,s=H8(t,e,n,r),a=o.getColDef(),l=vM(t.userCompFactory,a,s);i.refresh(z8(l.params,n))}function z8(t,e){return e instanceof KeyboardEvent&&t.column.getColDef().cellEditor==="agNumberCellEditor"?t.suppressPreventDefault=["-","+",".","e"].includes(e?.key??"")||t.suppressPreventDefault:e?.preventDefault?.(),t}function ya(t,e){for(let i of t.editModelSvc?.getEditPositions()??[]){let n=yt(t,i);if(!n)continue;let r=n.comp?.getCellEditor();if(!r)continue;let{editorValue:o,editorValueExists:s,isCancelAfterEnd:a}=B8(t,r,e);a&&t.editModelSvc?.setEdit(i,{editorState:{isCancelAfterEnd:a}}),pm(t,i,o,void 0,!s,e)}}function pm(t,e,i,n,r,o){let{editModelSvc:s,valueSvc:a}=t;if(!s)return;let{rowNode:l,column:c}=e;if(!(l&&c))return;let d=s.getEdit(e,!0);d?.sourceValue||(d=s.setEdit(e,{sourceValue:a.getValue(c,l,void 0,"api"),pendingValue:d?d.editorValue:In})),s.setEdit(e,{editorValue:r?d.sourceValue:i}),o?.persist&&Ite(t,e)}function Ite(t,e){let{editModelSvc:i}=t,n=i?.getEdit(e,!0);i?.setEdit(e,{pendingValue:n?.editorValue})}function dc(t,e,i){e||(e=t.editModelSvc?.getEditPositions());for(let n of e??[])Im(t,n,i)}function Im(t,e,i){let n=t.gos.get("enableGroupEdit"),{editModelSvc:r}=t,o=yt(t,e),s=r?.getEdit(e,!0);if(!o){s&&r?.setEdit(e,{state:"changed"});return}let{comp:a}=o;if(a&&!a.getCellEditor()){if(o?.refreshCell(),s){r?.setEdit(e,{state:"changed"});let c=n?JT(i,s):{valueChanged:!1,newValue:void 0,oldValue:s.sourceValue};QT(t,e,c,i)}return}if(s2(t)){let c=a?.getCellEditor()?.getValidationErrors?.(),d=r?.getCellValidationModel();c?.length?d?.setCellValidation(e,{errorMessages:c}):d?.clearCellValidation(e)}r?.setEdit(e,{state:"changed"}),a?.setEditDetails(),a?.refreshEditStyles(!1,!1),o?.refreshCell({force:!0,suppressFlash:!0});let l=r?.getEdit(e);if(l&&l.state==="changed"){let c=n?JT(i,l):{valueChanged:vo(l)&&!i?.cancel,newValue:i?.cancel||l.editorState.isCancelAfterEnd?void 0:l?.editorValue??s?.pendingValue,oldValue:l?.sourceValue};QT(t,e,c,i)}}function JT(t,e){return t?.cancel?{valueChanged:!1,oldValue:e.sourceValue,newValue:void 0,value:e.sourceValue}:{valueChanged:!1,oldValue:e.sourceValue,newValue:e.pendingValue,value:e.sourceValue}}function QT(t,e,i,{silent:n,event:r}={}){let{editSvc:o,editModelSvc:s}=t,a=s?.getEdit(e),{editorState:l}=a||{},{isCancelBeforeStart:c}=l||{};!n&&!c&&(o?.dispatchCellEvent(e,r,"cellEditingStopped",i),s?.setEdit(e,{editorState:{cellStoppedEditing:!0}}))}function s2(t){let{gos:e,colModel:i}=t,n=!!e.get("getFullRowEditValidationErrors"),r=i.getColumnDefs()?.filter(s=>s.editable).some(({cellEditorParams:s})=>{let{minLength:a,maxLength:l,getValidationErrors:c,min:d,max:u}=s||{};return a!==void 0||l!==void 0||c!==void 0||d!==void 0||u!==void 0}),o=t.gridApi.getCellEditorInstances().some(s=>s.getValidationElement||s.getValidationErrors);return r||n||o}function Ma(t,e){if(!(e||s2(t)))return;let i=N8(t),n=new O8,{ariaAnnounce:r,localeSvc:o,editModelSvc:s,gos:a}=t,l=a.get("editType")==="fullRow",d=ID(o)("ariaValidationErrorPrefix","Cell Editor Validation");for(let h of i){let{ctrl:p,editor:f}=h,{rowNode:g,column:m}=p,v=f.getValidationErrors?.()??[],C=f.getValidationElement?.(!1)||!f.isPopup?.()&&p.eGui;if(C){let b=v!=null&&v.length>0,S=b?v.join(". "):"";Tj(C,b),b&&r.announceValue(`${d} ${v}`,"editorValidation"),C instanceof HTMLInputElement?C.setCustomValidity(S):C.classList.toggle("invalid",b)}v?.length>0&&n.setCellValidation({rowNode:g,column:m},{errorMessages:v})}ya(t,{persist:!1}),s?.setCellValidationModel(n);let u=new Set;for(let{ctrl:h}of i)u.add(h.rowCtrl);if(l){let h=Ate(t);s?.setRowValidationModel(h)}for(let h of u.values()){h.rowEditStyleFeature?.applyRowStyles();for(let p of h.getAllCellCtrls())p.tooltipFeature?.refreshTooltip(!0),p.editorTooltipFeature?.refreshTooltip(!0),p.editStyleFeature?.applyCellStyles?.()}}var Ate=t=>{let e=new L8,i=t.gos.get("getFullRowEditValidationErrors"),n=t.editModelSvc?.getEditMap();if(!n)return e;for(let r of n.keys()){let o=n.get(r);if(!o)continue;let s=[],{rowIndex:a,rowPinned:l}=r;for(let d of o.keys()){let u=o.get(d);if(!u)continue;let{editorValue:h,pendingValue:p,sourceValue:f}=u,g=h??(p===In?void 0:p)??f;s.push({column:d,colId:d.getColId(),rowIndex:a,rowPinned:l,oldValue:f,newValue:g})}let c=i?.({editorsState:s})??[];c.length>0&&e.setRowValidation({rowNode:r},{errorMessages:c})}return e};function Ote(t){Ma(t,!0);let e=t.editModelSvc?.getCellValidationModel().getCellValidationMap();if(!e)return null;let i=[];return e.forEach((n,r)=>{n.forEach(({errorMessages:o},s)=>{i.push({column:s,rowIndex:r.rowIndex,rowPinned:r.rowPinned,messages:o??null})})}),i}function Lte(t,e,i,{rowNode:n,column:r},o){return Ee(t.gos,{type:i,node:n,data:n.data,value:o,column:r,colDef:r.getColDef(),rowPinned:n.rowPinned,event:e,rowIndex:n.rowIndex})}function Nte(t,e=!1){return t===A.DELETE?!0:!e&&t===A.BACKSPACE?bM():!1}var Bte=class extends H{constructor(t,e,i,n){super(),this.cellCtrl=t,this.rowNode=i,this.rowCtrl=n,this.beans=e}init(){this.eGui=this.cellCtrl.eGui}onKeyDown(t){let e=t.key;switch(e){case A.ENTER:this.onEnterKeyDown(t);break;case A.F2:this.onF2KeyDown(t);break;case A.ESCAPE:this.onEscapeKeyDown(t);break;case A.TAB:this.onTabKeyDown(t);break;case A.BACKSPACE:case A.DELETE:this.onBackspaceOrDeleteKeyDown(e,t);break;case A.DOWN:case A.UP:case A.RIGHT:case A.LEFT:this.onNavigationKeyDown(t,e);break}}onNavigationKeyDown(t,e){let{cellCtrl:i,beans:n}=this;if(!n.editSvc?.isEditing(i,{withOpenEditor:!0})){if(t.shiftKey&&i.isRangeSelectionEnabled())this.onShiftRangeSelect(t);else{let r=i.getFocusedCellPosition();n.navigation?.navigateToNextCell(t,e,r,!0)}t.preventDefault()}}onShiftRangeSelect(t){let{rangeSvc:e,navigation:i}=this.beans;if(!e)return;let n=e.extendLatestRangeInDirection(t);n&&(t.key===A.LEFT||t.key===A.RIGHT?i?.ensureColumnVisible(n.column):i?.ensureRowVisible(n.rowIndex))}onTabKeyDown(t){this.beans.navigation?.onTabKeyDown(this.cellCtrl,t)}onBackspaceOrDeleteKeyDown(t,e){let{cellCtrl:i,beans:n,rowNode:r}=this,{gos:o,rangeSvc:s,eventSvc:a,editSvc:l}=n;if(a.dispatchEvent({type:"keyShortcutChangedCellStart"}),Nte(t,o.get("enableCellEditingOnBackspace"))&&!l?.isEditing(i,{withOpenEditor:!0})){if(s&&So(o))s.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"});else if(i.isCellEditable()){let{column:c}=i,d=this.beans.valueSvc.getDeleteValue(c,r);r.setDataValue(c,d,"cellClear")}}else l?.isEditing(i,{withOpenEditor:!0})||n.editSvc?.startEditing(i,{startedEdit:!0,event:e});a.dispatchEvent({type:"keyShortcutChangedCellEnd"})}onEnterKeyDown(t){let{cellCtrl:e,beans:i}=this,{editSvc:n,navigation:r}=i,o=n?.isEditing(e,{withOpenEditor:!0}),s=e.rowNode,a=n?.isRowEditing(s,{withOpenEditor:!0}),l=c=>{n?.startEditing(c,{startedEdit:!0,event:t,source:"edit"})&&t.preventDefault()};if(o||a){if(this.isCtrlEnter(t)){n?.applyBulkEdit(e,i?.rangeSvc?.getCellRanges()||[]);return}if(Ma(i),n?.checkNavWithValidation(void 0,t)==="block-stop")return;n?.isEditing(e,{withOpenEditor:!0})?n?.stopEditing(e,{event:t,source:"edit"}):a&&!e.isCellEditable()?n?.stopEditing({rowNode:s},{event:t,source:"edit"}):l(e)}else if(i.gos.get("enterNavigatesVertically")){let c=t.shiftKey?A.UP:A.DOWN;r?.navigateToNextCell(null,c,e.cellPosition,!1)}else{if(n?.hasValidationErrors())return;n?.hasValidationErrors(e)&&n.revertSingleCellEdit(e,!0),l(e)}}isCtrlEnter(t){return(t.ctrlKey||t.metaKey)&&t.key===A.ENTER}onF2KeyDown(t){let{cellCtrl:e,beans:{editSvc:i}}=this;i?.isEditing()&&(Ma(this.beans),i?.checkNavWithValidation(void 0,t)==="block-stop")||i?.startEditing(e,{startedEdit:!0,event:t})}onEscapeKeyDown(t){let{cellCtrl:e,beans:{editSvc:i}}=this;i?.checkNavWithValidation(e,t)==="block-stop"&&i.revertSingleCellEdit(e),i?.stopEditing(e,{event:t,cancel:!0})}processCharacter(t){let i=t.target!==this.eGui,{beans:{editSvc:n},cellCtrl:r}=this;if(i||n?.isEditing(r,{withOpenEditor:!0}))return;if(t.key===A.SPACE)this.onSpaceKeyDown(t);else if(n?.isCellEditable(r,"ui")){if(n?.hasValidationErrors()&&!n?.hasValidationErrors(r))return;n?.startEditing(r,{startedEdit:!0,event:t,source:"api"}),!r.editCompDetails?.params?.suppressPreventDefault&&t.preventDefault()}}onSpaceKeyDown(t){let{gos:e,editSvc:i}=this.beans,{rowNode:n}=this.cellCtrl;!i?.isEditing(this.cellCtrl,{withOpenEditor:!0})&&xa(e)&&this.beans.selectionSvc?.handleSelectionEvent(t,n,"spaceKey"),t.preventDefault()}},Hte=class extends H{constructor(t,e,i){super(),this.cellCtrl=t,this.column=i,this.beans=e}onMouseEvent(t,e){if(!yo(e))switch(t){case"click":this.onCellClicked(e);break;case"mousedown":case"touchstart":this.onMouseDown(e);break;case"dblclick":this.onCellDoubleClicked(e);break;case"mouseout":this.onMouseOut(e);break;case"mouseover":this.onMouseOver(e);break}}onCellClicked(t){if(this.beans.touchSvc?.handleCellDoubleClick(this,t))return;let{eventSvc:e,rangeSvc:i,editSvc:n,editModelSvc:r,frameworkOverrides:o,gos:s}=this.beans,a=t.ctrlKey||t.metaKey,{cellCtrl:l}=this,{column:c,cellPosition:d,rowNode:u}=l,h=lm(s,c,u,t);i&&a&&!h&&i.getCellRangeCount(d)>1&&i.intersectLastRange(!0);let p=l.createEvent(t,"cellClicked");p.isEventHandlingSuppressed=h,e.dispatchEvent(p);let f=c.getColDef();if(f.onCellClicked&&window.setTimeout(()=>{o.wrapOutgoing(()=>{f.onCellClicked(p)})},0),!h&&r?.getState(l)!=="editing"){let g=n?.isEditing(),m=r?.getCellValidationModel().getCellValidationMap().size??0,v=r?.getRowValidationModel().getRowValidationMap().size??0;if(g&&(m>0||v>0))return;n?.shouldStartEditing(l,t)?n?.startEditing(l,{event:t}):n?.shouldStopEditing(l,t)&&(this.beans.gos.get("editType")==="fullRow"?n?.stopEditing(l,{event:t,source:"edit"}):n?.stopEditing(void 0,{event:t,source:"edit"}))}}onCellDoubleClicked(t){let{column:e,beans:i,cellCtrl:n}=this,{eventSvc:r,frameworkOverrides:o,editSvc:s,editModelSvc:a,gos:l}=i,c=lm(l,n.column,n.rowNode,t),d=e.getColDef(),u=n.createEvent(t,"cellDoubleClicked");if(u.isEventHandlingSuppressed=c,r.dispatchEvent(u),typeof d.onCellDoubleClicked=="function"&&window.setTimeout(()=>{o.wrapOutgoing(()=>{d.onCellDoubleClicked(u)})},0),!c&&s?.shouldStartEditing(n,t)&&a?.getState(n)!=="editing"){let h=s?.isEditing(),p=a?.getCellValidationModel().getCellValidationMap().size??0,f=a?.getRowValidationModel().getRowValidationMap().size??0;if(h&&(p>0||f>0))return;s?.startEditing(n,{event:t})}}onMouseDown(t){let{ctrlKey:e,metaKey:i,shiftKey:n}=t,r=t.target,{cellCtrl:o,beans:s}=this,{eventSvc:a,rangeSvc:l,rowNumbersSvc:c,focusSvc:d,gos:u,editSvc:h}=s,{column:p,rowNode:f,cellPosition:g}=o,m=lm(u,p,f,t),v=()=>{let x=o.createEvent(t,"cellMouseDown");x.isEventHandlingSuppressed=m,a.dispatchEvent(x)};if(m){v();return}if(this.isRightClickInExistingRange(t))return;let C=l&&!l.isEmpty(),b=this.containsWidget(r),S=wo(p);if(c&&S&&!c.handleMouseDownOnCell(g,t)){l&&t.preventDefault(),t.stopImmediatePropagation();return}if(!n||!C){let x=h?.isEditing(o),P=u.get("enableCellTextSelection")&&t.defaultPrevented,L=(Es()||P)&&!x&&!Yu(r)&&!b;o.focusCell(L,t)}if(n&&C&&!d.isCellFocused(g)){t.preventDefault();let x=d.getFocusedCell();if(x){let{column:E,rowIndex:P,rowPinned:L}=x;h?.isEditing(x)&&h?.stopEditing(x),d.setFocusedCell({column:E,rowIndex:P,rowPinned:L,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,sourceEvent:t})}}if(!b){if(l){S&&t.preventDefault();let x=iT(s,t)&&S;if(n)l.extendLatestRangeToCell(g);else if(!x){let E=e||i;l.setRangeToCell(g,E)}}v()}}isRightClickInExistingRange(t){let{rangeSvc:e}=this.beans;if(e){let i=e.isCellInAnyRange(this.cellCtrl.cellPosition),n=iT(this.beans,t);if(i&&n)return!0}return!1}containsWidget(t){return Sa(t,"ag-selection-checkbox",3)||Sa(t,"ag-drag-handle",3)}onMouseOut(t){if(this.mouseStayingInsideCell(t))return;let{eventSvc:e,colHover:i}=this.beans;e.dispatchEvent(this.cellCtrl.createEvent(t,"cellMouseOut")),i?.clearMouseOver()}onMouseOver(t){if(this.mouseStayingInsideCell(t))return;let{eventSvc:e,colHover:i}=this.beans;e.dispatchEvent(this.cellCtrl.createEvent(t,"cellMouseOver")),i?.setMouseOver([this.column])}mouseStayingInsideCell(t){if(!t.target||!t.relatedTarget)return!1;let e=this.cellCtrl.eGui,i=e.contains(t.target),n=e.contains(t.relatedTarget);return i&&n}},zte=class extends H{constructor(t,e){super(),this.cellCtrl=t,this.beans=e,this.column=t.column,this.rowNode=t.rowNode}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode),this.addManagedListeners(this.beans.eventSvc,{newColumnsLoaded:()=>this.onNewColumnsLoaded()})}init(){this.eSetLeft=this.cellCtrl.getRootElement(),this.eContent=this.cellCtrl.eGui;let t=this.cellCtrl.getCellSpan();if(t||(this.setupColSpan(),this.setupRowSpan()),this.onLeftChanged(),this.onWidthChanged(),t||this._legacyApplyRowSpan(),t){let e=this.refreshSpanHeight.bind(this,t);e(),this.addManagedListeners(this.beans.eventSvc,{paginationChanged:e,recalculateRowBounds:e,pinnedHeightChanged:e})}}refreshSpanHeight(t){let e=t.getCellHeight();e!=null&&(this.eContent.style.height=`${e}px`)}onNewColumnsLoaded(){let t=this.column.getRowSpan(this.rowNode);this.rowSpan!==t&&(this.rowSpan=t,this._legacyApplyRowSpan(!0))}onDisplayColumnsChanged(){let t=this.getColSpanningList();xs(this.colsSpanning,t)||(this.colsSpanning=t,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){this.column.getColDef().colSpan!=null&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onWidthChanged.bind(this)}))}onWidthChanged(){if(!this.eContent)return;let t=this.getCellWidth();this.eContent.style.width=`${t}px`}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce((t,e)=>t+e.getActualWidth(),0):this.column.getActualWidth()}getColSpanningList(){let{column:t,rowNode:e}=this,i=t.getColSpan(e),n=[];if(i===1)n.push(t);else{let r=t,o=t.getPinned();for(let s=0;r&&s<i&&(n.push(r),r=this.beans.visibleCols.getColAfter(r),!(!r||wt(r)||o!==r.getPinned()));s++);}return n}onLeftChanged(){if(!this.eSetLeft)return;let t=this.modifyLeftForPrintLayout(this.getCellLeft());this.eSetLeft.style.left=t+"px"}getCellLeft(){let t;return this.beans.gos.get("enableRtl")&&this.colsSpanning?t=dt(this.colsSpanning):t=this.column,t.getLeft()}modifyLeftForPrintLayout(t){if(!this.cellCtrl.printLayout||this.column.getPinned()==="left")return t;let{visibleCols:e}=this.beans,i=e.getColsLeftWidth();if(this.column.getPinned()==="right"){let n=e.bodyWidth;return i+n+(t||0)}return i+(t||0)}_legacyApplyRowSpan(t){if(this.rowSpan===1&&!t)return;let i=Ea(this.beans)*this.rowSpan;this.eContent.style.height=`${i}px`,this.eContent.style.zIndex="1"}destroy(){super.destroy()}},Vte="ag-cell",Gte="ag-cell-auto-height",Wte="ag-cell-normal-height",Ute="ag-cell-focus",jte="ag-cell-first-right-pinned",qte="ag-cell-last-left-pinned",$te="ag-cell-not-inline-editing",Kte="ag-cell-wrap-text",Yte=0,uc=class extends H{constructor(t,e,i,n){super(),this.column=t,this.rowNode=e,this.rowCtrl=n,this.rangeFeature=void 0,this.rowResizeFeature=void 0,this.positionFeature=void 0,this.customStyleFeature=void 0,this.editStyleFeature=void 0,this.mouseListener=void 0,this.keyboardListener=void 0,this.suppressRefreshCell=!1,this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.focusEventWhileNotReady=null,this.hasBeenFocused=!1,this.hasEdit=!1,this.tooltipFeature=void 0,this.editorTooltipFeature=void 0,this.beans=i,this.gos=i.gos,this.editSvc=i.editSvc,this.hasEdit=!!i.editSvc;let{colId:r}=t;this.instanceId=r+"-"+Yte++,this.createCellPosition(),this.updateAndFormatValue(!1)}addFeatures(){let{beans:t}=this;this.positionFeature=new zte(this,t),this.customStyleFeature=t.cellStyles?.createCellCustomStyleFeature(this,t),this.editStyleFeature=t.editSvc?.createCellStyleFeature(this,t),this.mouseListener=new Hte(this,t,this.column),this.keyboardListener=new Bte(this,t,this.rowNode,this.rowCtrl),this.enableTooltipFeature();let{rangeSvc:e}=t;e&&So(t.gos)&&(this.rangeFeature=e.createCellRangeFeature(t,this)),wo(this.column)&&(this.rowResizeFeature=this.beans.rowNumbersSvc.createRowNumbersRowResizerFeature(t,this))}isCellSpanning(){return!1}getCellSpan(){}removeFeatures(){let t=this.beans.context;this.positionFeature=t.destroyBean(this.positionFeature),this.editorTooltipFeature=t.destroyBean(this.editorTooltipFeature),this.customStyleFeature=t.destroyBean(this.customStyleFeature),this.editStyleFeature=t.destroyBean(this.editStyleFeature),this.mouseListener=t.destroyBean(this.mouseListener),this.keyboardListener=t.destroyBean(this.keyboardListener),this.rangeFeature=t.destroyBean(this.rangeFeature),this.rowResizeFeature=t.destroyBean(this.rowResizeFeature),this.disableTooltipFeature()}enableTooltipFeature(t,e){this.tooltipFeature=this.beans.tooltipSvc?.enableCellTooltipFeature(this,t,e)}disableTooltipFeature(){this.tooltipFeature=this.beans.context.destroyBean(this.tooltipFeature)}enableEditorTooltipFeature(t){this.editorTooltipFeature&&this.disableEditorTooltipFeature(),this.editorTooltipFeature=this.beans.tooltipSvc?.setupCellEditorTooltip(this,t),Ma(this.beans)}disableEditorTooltipFeature(){this.editorTooltipFeature=this.beans.context.destroyBean(this.editorTooltipFeature)}setComp(t,e,i,n,r,o,s){if(this.comp=t,this.eGui=e,this.printLayout=r,s??(s=this),this.addDomData(s),this.addFeatures(),s.addDestroyFunc(()=>this.removeFeatures()),this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.setupFocus(),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),this.setupAutoHeight(n,s),this.refreshFirstAndLastStyles(),this.refreshAriaColIndex(),this.positionFeature?.init(),this.customStyleFeature?.setComp(t),this.editStyleFeature?.setComp(t),this.tooltipFeature?.refreshTooltip(),this.keyboardListener?.init(),this.rangeFeature?.setComp(t),this.rowResizeFeature?.refreshRowResizer(),o&&this.isCellEditable()||this.hasEdit&&this.editSvc?.isEditing(this,{withOpenEditor:!0})?this.editSvc?.startEditing(this,{startedEdit:!1,source:"api",silent:!0,continueEditing:!0}):this.showValue(!1,!0),this.onCompAttachedFuncs.length){for(let a of this.onCompAttachedFuncs)a();this.onCompAttachedFuncs=[]}}setupAutoHeight(t,e){this.isAutoHeight=this.beans.rowAutoHeight?.setupCellAutoHeight(this,t,e)??!1}getCellAriaRole(){return this.column.getColDef().cellAriaRole??"gridcell"}isCellRenderer(){let t=this.column.getColDef();return t.cellRenderer!=null||t.cellRendererSelector!=null}getValueToDisplay(){return this.valueFormatted??this.value}getDeferLoadingCellRenderer(){let{beans:t,column:e}=this,{userCompFactory:i,ctrlsSvc:n,eventSvc:r}=t,o=e.getColDef(),s=this.createCellRendererParams();s.deferRender=!0;let a=lT(i,o,s);if(n.getGridBodyCtrl()?.scrollFeature?.isScrolling()){let l,c=new Et(u=>{l=u}),[d]=this.addManagedListeners(r,{bodyScrollEnd:()=>{l(),d()}});return{loadingComp:a,onReady:c}}return{loadingComp:a,onReady:Et.resolve()}}showValue(t,e){let{beans:i,column:n,rowNode:r,rangeFeature:o}=this,{userCompFactory:s}=i,a=this.getValueToDisplay(),l,c=r.stub&&r.groupData?.[n.getId()]==null,d=n.getColDef();if(c||this.isCellRenderer()){let u=this.createCellRendererParams();!c||wo(n)?l=aT(s,d,u):l=lT(s,d,u)}if(!l&&!c&&i.findSvc?.isMatch(r,n)){let u=this.createCellRendererParams();l=aT(s,k(w({},n.getColDef()),{cellRenderer:"agFindCellRenderer"}),u)}if(this.hasEdit&&this.editSvc.isBatchEditing()&&this.editSvc.isRowEditing(r,{checkSiblings:!0})){let u=this.editSvc.prepDetailsDuringBatch(this,{compDetails:l,valueToDisplay:a});u&&(u.compDetails?l=u.compDetails:u.valueToDisplay&&(a=u.valueToDisplay))}this.comp.setRenderDetails(l,a,t),this.customRowDragComp?.refreshVisibility(),!e&&o&&Eo(i,()=>o?.refreshHandle()),this.rowResizeFeature?.refreshRowResizer()}setupControlComps(){let t=this.column.getColDef();this.includeSelection=this.isIncludeControl(this.isCheckboxSelection(t),!0),this.includeRowDrag=this.isIncludeControl(t.rowDrag),this.includeDndSource=this.isIncludeControl(t.dndSource),this.comp.setIncludeSelection(this.includeSelection),this.comp.setIncludeDndSource(this.includeDndSource),this.comp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gos.get("enableCellTextSelection")||this.column.isAutoHeight()}getCellValueClass(){let t="ag-cell-value",e=this.column.getColDef().cellRenderer==="agCheckboxCellRenderer",i="";return e&&(i=" ag-allow-overflow"),`${t}${i}`}isIncludeControl(t,e=!1){return(this.rowNode.rowPinned==null||e&&xh(this.rowNode))&&!!t}isCheckboxSelection(t){let{rowSelection:e,groupDisplayType:i}=this.beans.gridOptions,n=ym(e),r=Po(this.column);return i==="custom"&&n!=="selectionColumn"&&r?!1:t.checkboxSelection||r&&typeof e=="object"&&oc(e)}refreshShouldDestroy(){let t=this.column.getColDef(),e=this.includeSelection!=this.isIncludeControl(this.isCheckboxSelection(t),!0),i=this.includeRowDrag!=this.isIncludeControl(t.rowDrag),n=this.includeDndSource!=this.isIncludeControl(t.dndSource),r=this.isAutoHeight!=this.column.isAutoHeight();return e||i||n||r}onPopupEditorClosed(){let{editSvc:t}=this.beans;t?.isEditing(this,{withOpenEditor:!0})&&t?.stopEditing(this,{source:t?.isBatchEditing()?"ui":"api"})}stopEditing(t=!1){let{editSvc:e}=this.beans;return e?.stopEditing(this,{cancel:t,source:e?.isBatchEditing()?"ui":"api"})??!1}createCellRendererParams(){let{value:t,valueFormatted:e,column:i,rowNode:n,comp:r,eGui:o,beans:{valueSvc:s,gos:a,editSvc:l}}=this;return Ee(a,{value:t,valueFormatted:e,getValue:()=>s.getValueForDisplay(i,n).value,setValue:d=>l?.setDataValue({rowNode:n,column:i},d)||n.setDataValue(i,d),formatValue:this.formatValue.bind(this),data:n.data,node:n,pinned:i.getPinned(),colDef:i.getColDef(),column:i,refreshCell:this.refreshCell.bind(this),eGridCell:o,eParentOfValue:r.getParentOfValue(),registerRowDragger:(d,u,h,p)=>this.registerRowDragger(d,u,p),setTooltip:(d,u)=>{a.assertModuleRegistered("Tooltip",3),this.tooltipFeature&&this.disableTooltipFeature(),this.enableTooltipFeature(d,u),this.tooltipFeature?.refreshTooltip()}})}onCellChanged(t){t.column===this.column&&this.refreshCell({})}refreshOrDestroyCell(t){if(this.refreshShouldDestroy()?this.rowCtrl?.recreateCell(this):this.refreshCell(t),this.hasEdit&&this.editCompDetails){let{editSvc:e,comp:i}=this;!i?.getCellEditor()&&e.isEditing(this,{withOpenEditor:!0})&&e.startEditing(this,{startedEdit:!1,source:"api",silent:!0})}}refreshCell({force:t,suppressFlash:e,newData:i}={}){let{editStyleFeature:n,customStyleFeature:r,rowCtrl:{rowEditStyleFeature:o},beans:{cellFlashSvc:s,filterManager:a},column:l,comp:c,suppressRefreshCell:d,tooltipFeature:u}=this;if(d)return;let{field:h,valueGetter:p,showRowGroup:f,enableCellChangeFlash:g}=l.getColDef(),m=h==null&&p==null&&f==null,v=t||m||i,C=!!c,b=this.updateAndFormatValue(C),S=v||b;if(C){if(S){this.showValue(!!i,!1);let x=a?.isSuppressFlashingCellsBecauseFiltering();!e&&!x&&g&&s?.flashCell(this),n?.applyCellStyles?.(),r?.applyUserStyles(),r?.applyClassesFromColDef(),o?.applyRowStyles()}u?.refreshTooltip(),r?.applyCellClassRules()}}isCellEditable(){return this.column.isCellEditable(this.rowNode)}formatValue(t){return this.callValueFormatter(t)??t}callValueFormatter(t){return this.beans.valueSvc.formatValue(this.column,this.rowNode,t)}updateAndFormatValue(t){let e=this.value,i=this.valueFormatted,{value:n,valueFormatted:r}=this.beans.valueSvc.getValueForDisplay(this.column,this.rowNode,!0);return this.value=n,this.valueFormatted=r,t?!this.valuesAreEqual(e,this.value)||this.valueFormatted!=i:!0}valuesAreEqual(t,e){let i=this.column.getColDef();return i.equals?i.equals(t,e):t===e}addDomData(t){let e=this.eGui;Fa(this.beans.gos,e,Tm,this),t.addDestroyFunc(()=>Fa(this.beans.gos,e,Tm,null))}createEvent(t,e){let{rowNode:i,column:n,value:r,beans:o}=this;return Lte(o,t,e,{rowNode:i,column:n},r)}processCharacter(t){this.keyboardListener?.processCharacter(t)}onKeyDown(t){this.keyboardListener?.onKeyDown(t)}onMouseEvent(t,e){this.mouseListener?.onMouseEvent(t,e)}getColSpanningList(){return this.positionFeature?.getColSpanningList()??[]}onLeftChanged(){this.comp&&this.positionFeature?.onLeftChanged()}onDisplayedColumnsChanged(){this.eGui&&(this.refreshAriaColIndex(),this.refreshFirstAndLastStyles())}refreshFirstAndLastStyles(){let{comp:t,column:e,beans:i}=this;t8(t,e,i.visibleCols)}refreshAriaColIndex(){let t=this.beans.visibleCols.getAriaColIndex(this.column);yD(this.eGui,t)}onWidthChanged(){return this.positionFeature?.onWidthChanged()}getRowPosition(){let{rowIndex:t,rowPinned:e}=this.cellPosition;return{rowIndex:t,rowPinned:e}}updateRangeBordersIfRangeCount(){this.comp&&this.rangeFeature?.updateRangeBordersIfRangeCount()}onCellSelectionChanged(){this.comp&&this.rangeFeature?.onCellSelectionChanged()}isRangeSelectionEnabled(){return this.rangeFeature!=null}focusCell(t=!1,e){let i=this.editSvc?.allowedFocusTargetOnValidation(this);i&&i!==this||this.beans.focusSvc.setFocusedCell(k(w({},this.getFocusedCellPosition()),{forceBrowserFocus:t,sourceEvent:e}))}restoreFocus(t=!1){let{beans:{editSvc:e,focusSvc:i},comp:n}=this;if(!n||e?.isEditing(this)||!this.isCellFocused()||!i.shouldTakeFocus())return;let r=()=>{if(!this.isAlive())return;let o=n.getFocusableElement();this.isCellFocused()&&o.focus({preventScroll:!0})};if(t){setTimeout(r,0);return}r()}onRowIndexChanged(){this.createCellPosition(),this.onCellFocused(),this.restoreFocus(),this.rangeFeature?.onCellSelectionChanged(),this.rowResizeFeature?.refreshRowResizer()}onSuppressCellFocusChanged(t){let e=this.eGui;e&&(wo(this.column)&&(t=!0),cn(e,"tabindex",t?void 0:-1))}onFirstRightPinnedChanged(){if(!this.comp)return;let t=this.column.isFirstRightPinned();this.comp.toggleCss(jte,t)}onLastLeftPinnedChanged(){if(!this.comp)return;let t=this.column.isLastLeftPinned();this.comp.toggleCss(qte,t)}checkCellFocused(){return this.beans.focusSvc.isCellFocused(this.cellPosition)}isCellFocused(){let t=this.checkCellFocused();return this.hasBeenFocused||(this.hasBeenFocused=t),t}setupFocus(){this.restoreFocus(!0),this.onCellFocused(this.focusEventWhileNotReady??void 0)}onCellFocused(t){let{beans:e}=this;if(Wm(e))return;if(!this.comp){t&&(this.focusEventWhileNotReady=t);return}let i=this.isCellFocused(),n=e.editSvc?.isEditing(this)??!1;if(this.comp.toggleCss(Ute,i),i&&t?.forceBrowserFocus){let r=this.comp.getFocusableElement();if(n){let o=ac(r,null,!0);o.length&&(r=o[0])}r.focus({preventScroll:!!t.preventScrollOnBrowserFocus})}i&&t&&this.rowCtrl.announceDescription()}createCellPosition(){let{rowIndex:t,rowPinned:e}=this.rowNode;this.cellPosition={rowIndex:t,rowPinned:Co(e),column:this.column}}applyStaticCssClasses(){let{comp:t}=this;t.toggleCss(Vte,!0),t.toggleCss($te,!0);let e=this.column.isAutoHeight()==!0;t.toggleCss(Gte,e),t.toggleCss(Wte,!e)}onColumnHover(){this.beans.colHover?.onCellColumnHover(this.column,this.comp)}onColDefChanged(){this.comp&&(this.column.isTooltipEnabled()?(this.disableTooltipFeature(),this.enableTooltipFeature()):this.disableTooltipFeature(),this.setWrapText(),this.editSvc?.isEditing(this)?this.editSvc?.handleColDefChanged(this):this.refreshOrDestroyCell({force:!0,suppressFlash:!0}))}setWrapText(){let t=this.column.getColDef().wrapText==!0;this.comp.toggleCss(Kte,t)}dispatchCellContextMenuEvent(t){let e=this.column.getColDef(),i=this.createEvent(t,"cellContextMenu"),{beans:n}=this;n.eventSvc.dispatchEvent(i),e.onCellContextMenu&&window.setTimeout(()=>{n.frameworkOverrides.wrapOutgoing(()=>{e.onCellContextMenu(i)})},0)}getCellRenderer(){return this.comp?.getCellRenderer()??null}destroy(){this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.isCellFocused()&&this.hasBrowserFocus()&&this.beans.focusSvc.attemptToRecoverFocus(),super.destroy()}hasBrowserFocus(){return this.eGui?.contains(St(this.beans))??!1}createSelectionCheckbox(){let t=this.beans.selectionSvc?.createCheckboxSelectionComponent();if(t)return this.beans.context.createBean(t),t.init({rowNode:this.rowNode,column:this.column}),t}createDndSource(){let t=this.beans.registry.createDynamicBean("dndSourceComp",!1,this.rowNode,this.column,this.eGui);return t&&this.beans.context.createBean(t),t}registerRowDragger(t,e,i){if(this.customRowDragComp){this.customRowDragComp.setDragElement(t,e);return}let n=this.createRowDragComp(t,e,i);n&&(this.customRowDragComp=n,this.addDestroyFunc(()=>{this.beans.context.destroyBean(n),this.customRowDragComp=null}),n.refreshVisibility())}createRowDragComp(t,e,i){let n=this.beans.rowDragSvc?.createRowDragCompForCell(this.rowNode,this.column,()=>this.value,t,e,i);if(n)return this.beans.context.createBean(n),n}cellEditorAttached(){for(let t of this.onEditorAttachedFuncs)t();this.onEditorAttachedFuncs=[]}setFocusedCellPosition(t){}getFocusedCellPosition(){return this.cellPosition}refreshAriaRowIndex(){}getRootElement(){return this.eGui}};function a2(t,e,i,n,r,o){if(i==null&&e==null)return;let s={},a={},l=(c,d)=>{for(let u of c.split(" "))u.trim()!=""&&d(u)};if(i){let c=Object.keys(i);for(let d=0;d<c.length;d++){let u=c[d],h=i[u],p;typeof h=="string"?p=t?t.evaluate(h,n):!0:typeof h=="function"&&(p=h(n)),l(u,f=>{p?s[f]=!0:a[f]=!0})}}if(e&&o)for(let c of Object.keys(e))l(c,d=>{s[d]||(a[d]=!0)});o&&Object.keys(a).forEach(o),Object.keys(s).forEach(r)}function ZT(t){if(t.group)return t.level;let e=t.parent;return e?e.level+1:0}var Xte=class extends H{constructor(){super(...arguments),this.beanName="rowStyleSvc"}processClassesFromGridOptions(t,e){let i=this.gos,n=s=>{if(typeof s=="string")t.push(s);else if(Array.isArray(s))for(let a of s)t.push(a)},r=i.get("rowClass");r&&n(r);let o=i.getCallback("getRowClass");if(o){let s={data:e.data,node:e,rowIndex:e.rowIndex},a=o(s);n(a)}}preProcessRowClassRules(t,e){this.processRowClassRules(e,i=>{t.push(i)},()=>{})}processRowClassRules(t,e,i){let{gos:n,expressionSvc:r}=this.beans,o=Ee(n,{data:t.data,node:t,rowIndex:t.rowIndex});a2(r,void 0,n.get("rowClassRules"),o,e,i)}processStylesFromGridOptions(t){let e=this.gos,i=e.get("rowStyle"),n=e.getCallback("getRowStyle"),r;if(n){let o={data:t.data,node:t,rowIndex:t.rowIndex};r=n(o)}if(r||i)return Object.assign({},i,r)}},Jte=0,Am=class extends H{constructor(t,e,i,n,r){super(),this.rowNode=t,this.useAnimationFrameForCreate=n,this.printLayout=r,this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.rowDragComps=[],this.lastMouseDownOnDragger=!1,this.emptyStyle={},this.updateColumnListsPending=!1,this.rowId=null,this.businessKey=null,this.beans=e,this.gos=e.gos,this.paginationPage=e.pagination?.getCurrentPage()??0,this.suppressRowTransform=this.gos.get("suppressRowTransform"),this.instanceId=t.id+"-"+Jte++,this.rowId=Ku(t.id),this.initRowBusinessKey(),this.rowFocused=e.focusSvc.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=ZT(this.rowNode),this.setRowType(),this.setAnimateFlags(i),this.rowStyles=this.processStylesFromGridOptions(),this.rowEditStyleFeature=e.editSvc?.createRowStyleFeature(this,e),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gos.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if(typeof this.businessKeyForNodeFunc!="function")return;let t=this.businessKeyForNodeFunc(this.rowNode);this.businessKey=Ku(t)}updateGui(t,e){t==="left"?this.leftGui=e:t==="right"?this.rightGui=e:t==="fullWidth"?this.fullWidthGui=e:this.centerGui=e}setComp(t,e,i,n){let{context:r,focusSvc:o}=this.beans;n=wh(this,r,n);let s={rowComp:t,element:e,containerType:i,compBean:n};this.allRowGuis.push(s),this.updateGui(i,s),this.initialiseRowComp(s);let a=this.rowNode,l=this.rowType==="FullWidthLoading"||a.stub,c=!a.data&&this.beans.rowModel.getType()==="infinite";!l&&!c&&!a.rowPinned&&this.beans.rowRenderer.dispatchFirstDataRenderedEvent();let d=this.fullWidthGui?.element;d&&!this.beans.editSvc?.isEditing(this)&&o.isRowFocused(a.rowIndex,a.rowPinned)&&o.shouldTakeFocus()&&setTimeout(()=>d.focus({preventScroll:!0}),0)}unsetComp(t){this.allRowGuis=this.allRowGuis.filter(e=>e.containerType!==t),this.updateGui(t,void 0)}isCacheable(){return this.rowType==="FullWidthDetail"&&this.gos.get("keepDetailRows")}setCached(t){let e=t?"none":"";for(let i of this.allRowGuis)i.element.style.display=e}initialiseRowComp(t){let e=this.gos;this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.listenOnDomOrder(t),this.onRowHeightChanged(t),this.updateRowIndexes(t),this.setFocusedClasses(t),this.setStylesFromGridOptions(!1,t),xa(e)&&this.rowNode.selectable&&this.onRowSelected(t),this.updateColumnLists(!this.useAnimationFrameForCreate);let i=t.rowComp,n=this.getInitialRowClasses(t.containerType);for(let r of n)i.toggleCss(r,!0);this.executeSlideAndFadeAnimations(t),this.rowNode.group&&Gy(t.element,this.rowNode.expanded==!0),this.setRowCompRowId(i),this.setRowCompRowBusinessKey(i),Fa(e,t.element,Dm,this),t.compBean.addDestroyFunc(()=>Fa(e,t.element,Dm,null)),this.useAnimationFrameForCreate?this.beans.animationFrameSvc.createTask(this.addHoverFunctionality.bind(this,t),this.rowNode.rowIndex,"p2",!1):this.addHoverFunctionality(t),this.isFullWidth()&&this.setupFullWidth(t),e.get("rowDragEntireRow")&&this.addRowDraggerToRow(t),this.useAnimationFrameForCreate&&this.beans.animationFrameSvc.addDestroyTask(()=>{this.isAlive()&&t.rowComp.toggleCss("ag-after-created",!0)}),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(t){this.businessKey!=null&&t.setRowBusinessKey(this.businessKey)}setRowCompRowId(t){let e=Ku(this.rowNode.id);this.rowId=e,e!=null&&t.setRowId(e)}executeSlideAndFadeAnimations(t){let{containerType:e}=t;this.slideInAnimation[e]&&(Wy(()=>{this.onTopChanged()}),this.slideInAnimation[e]=!1),this.fadeInAnimation[e]&&(Wy(()=>{t.rowComp.toggleCss("ag-opacity-zero",!1)}),this.fadeInAnimation[e]=!1)}addRowDraggerToRow(t){let e=this.beans.rowDragSvc?.createRowDragCompForRow(this.rowNode,t.element);if(!e)return;let i=this.createBean(e,this.beans.context);this.rowDragComps.push(i),t.compBean.addDestroyFunc(()=>{this.rowDragComps=this.rowDragComps.filter(n=>n!==i),this.rowEditStyleFeature=this.destroyBean(this.rowEditStyleFeature,this.beans.context),this.destroyBean(i,this.beans.context)})}setupFullWidth(t){let e=this.getPinnedForContainer(t.containerType),i=this.createFullWidthCompDetails(t.element,e);t.rowComp.showFullWidth(i)}getFullWidthCellRenderers(){return this.gos.get("embedFullWidthRows")?this.allRowGuis.map(t=>t?.rowComp?.getFullWidthCellRenderer()):[this.fullWidthGui?.rowComp?.getFullWidthCellRenderer()]}executeProcessRowPostCreateFunc(){let t=this.gos.getCallback("processRowPostCreate");if(!t||!this.areAllContainersReady())return;let e={eRow:this.centerGui.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)};t(e)}areAllContainersReady(){let{leftGui:t,centerGui:e,rightGui:i,beans:{visibleCols:n}}=this,r=!!t||!n.isPinningLeft(),o=!!e,s=!!i||!n.isPinningRight();return r&&o&&s}isNodeFullWidthCell(){if(this.rowNode.detail)return!0;let t=this.beans.gos.getCallback("isFullWidthRow");return t?t({rowNode:this.rowNode}):!1}setRowType(){let t=this.rowNode.stub&&!this.gos.get("suppressServerSideFullWidthLoadingRow")&&!this.gos.get("groupHideOpenParents"),e=this.isNodeFullWidthCell(),i=this.gos.get("masterDetail")&&this.rowNode.detail,n=this.beans.colModel.isPivotMode(),r=XD(this.gos,this.rowNode,n);t?this.rowType="FullWidthLoading":i?this.rowType="FullWidthDetail":e?this.rowType="FullWidth":r?this.rowType="FullWidthGroup":this.rowType="Normal"}updateColumnLists(t=!1,e=!1){if(this.isFullWidth())return;let{animationFrameSvc:i}=this.beans;if(!i?.active||t||this.printLayout){this.updateColumnListsImpl(e);return}this.updateColumnListsPending||(i.createTask(()=>{this.active&&this.updateColumnListsImpl(!0)},this.rowNode.rowIndex,"p1",!1),this.updateColumnListsPending=!0)}getNewCellCtrl(t){if(!this.beans.rowSpanSvc?.isCellSpanning(t,this.rowNode))return new uc(t,this.rowNode,this.beans,this)}isCorrectCtrlForSpan(t){return!this.beans.rowSpanSvc?.isCellSpanning(t.column,this.rowNode)}createCellCtrls(t,e,i=null){let n={list:[],map:{}},r=(c,d,u)=>{u!=null?n.list.splice(u,0,d):n.list.push(d),n.map[c]=d},o=[];for(let c of e){let d=c.getInstanceId(),u=t.map[d];u&&!this.isCorrectCtrlForSpan(u)&&(u.destroy(),u=void 0),u||(u=this.getNewCellCtrl(c)),u&&r(d,u)}for(let c of t.list){let d=c.column.getInstanceId();if(n.map[d]!=null)continue;!this.isCellEligibleToBeRemoved(c,i)?o.push([d,c]):c.destroy()}if(o.length)for(let[c,d]of o){let u=n.list.findIndex(p=>p.column.getLeft()>d.column.getLeft()),h=u===-1?void 0:Math.max(u-1,0);r(c,d,h)}let{focusSvc:s,visibleCols:a}=this.beans,l=s.getFocusedCell();if(l&&l.column.getPinned()==i){let c=l.column.getInstanceId();if(!n.map[c]&&a.allCols.includes(l.column)){let u=this.createFocusedCellCtrl();if(u){let h=n.list.findIndex(f=>f.column.getLeft()>u.column.getLeft()),p=h===-1?void 0:Math.max(h-1,0);r(c,u,p)}}}return n}createFocusedCellCtrl(){let{focusSvc:t,rowSpanSvc:e}=this.beans,i=t.getFocusedCell();if(!i)return;let n=e?.getCellSpan(i.column,this.rowNode);if(n){if(n.firstNode!==this.rowNode||!n.doesSpanContain(i))return}else if(!t.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned))return;return this.getNewCellCtrl(i.column)}updateColumnListsImpl(t){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(t)}setCellCtrls(t){for(let e of this.allRowGuis){let i=this.getCellCtrlsForContainer(e.containerType);e.rowComp.setCellCtrls(i,t)}}getCellCtrlsForContainer(t){switch(t){case"left":return this.leftCellCtrls.list;case"right":return this.rightCellCtrls.list;case"fullWidth":return[];case"center":return this.centerCellCtrls.list}}createAllCellCtrls(){let t=this.beans.colViewport,e=this.beans.visibleCols;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,e.allCols),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{let i=t.getColsWithinViewport(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,i);let n=e.getLeftColsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,n,"left");let r=e.getRightColsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,r,"right")}}isCellEligibleToBeRemoved(t,e){let{column:r}=t;if(r.getPinned()!=e||!this.isCorrectCtrlForSpan(t))return!0;let{visibleCols:o,editSvc:s}=this.beans,a=s?.isEditing(t),l=t.isCellFocused();return a||l?!(o.allCols.indexOf(r)>=0):!0}getDomOrder(){return this.gos.get("ensureDomOrder")||pi(this.gos,"print")}listenOnDomOrder(t){let e=()=>{t.rowComp.setDomOrder(this.getDomOrder())};t.compBean.addManagedPropertyListeners(["domLayout","ensureDomOrder"],e)}setAnimateFlags(t){if(this.rowNode.sticky||!t)return;let e=ae(this.rowNode.oldRowTop),{visibleCols:i}=this.beans,n=i.isPinningLeft(),r=i.isPinningRight();if(e){let{slideInAnimation:o}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){o.fullWidth=!0;return}o.center=!0,o.left=n,o.right=r}else{let{fadeInAnimation:o}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){o.fullWidth=!0;return}o.center=!0,o.left=n,o.right=r}}isFullWidth(){return this.rowType!=="Normal"}refreshFullWidth(){let t=(s,a)=>s?s.rowComp.refreshFullWidth(()=>this.createFullWidthCompDetails(s.element,a).params):!0,e=t(this.fullWidthGui,null),i=t(this.centerGui,null),n=t(this.leftGui,"left"),r=t(this.rightGui,"right");return e&&i&&n&&r}addListeners(){let{beans:t,gos:e,rowNode:i}=this,{expansionSvc:n,eventSvc:r,context:o,rowSpanSvc:s}=t;this.addManagedListeners(this.rowNode,w({heightChanged:()=>this.onRowHeightChanged(),rowSelected:()=>this.onRowSelected(),rowIndexChanged:this.onRowIndexChanged.bind(this),topChanged:this.onTopChanged.bind(this)},n?.getRowExpandedListeners(this)??{})),i.detail&&this.addManagedListeners(i.parent,{dataChanged:this.onRowNodeDataChanged.bind(this)}),this.addManagedListeners(i,{dataChanged:this.onRowNodeDataChanged.bind(this),cellChanged:this.postProcessCss.bind(this),rowHighlightChanged:this.onRowNodeHighlightChanged.bind(this),draggingChanged:this.postProcessRowDragging.bind(this),uiLevelChanged:this.onUiLevelChanged.bind(this),rowPinned:this.onRowPinned.bind(this)}),this.addManagedListeners(r,{paginationPixelOffsetChanged:this.onPaginationPixelOffsetChanged.bind(this),heightScaleChanged:this.onTopChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),virtualColumnsChanged:this.onVirtualColumnsChanged.bind(this),cellFocused:this.onCellFocusChanged.bind(this),cellFocusCleared:this.onCellFocusChanged.bind(this),paginationChanged:this.onPaginationChanged.bind(this),modelUpdated:this.refreshFirstAndLastRowStyles.bind(this),columnMoved:()=>this.updateColumnLists()}),s&&this.addManagedListeners(s,{spannedCellsUpdated:({pinned:a})=>{a&&!i.rowPinned||this.updateColumnLists()}}),this.addDestroyFunc(()=>{this.rowDragComps=this.destroyBeans(this.rowDragComps,o),this.tooltipFeature=this.destroyBean(this.tooltipFeature,o),this.rowEditStyleFeature=this.destroyBean(this.rowEditStyleFeature,o)}),this.addManagedPropertyListeners(["rowStyle","getRowStyle","rowClass","getRowClass","rowClassRules"],this.postProcessCss.bind(this)),this.addManagedPropertyListener("rowDragEntireRow",()=>{if(e.get("rowDragEntireRow")){for(let l of this.allRowGuis)this.addRowDraggerToRow(l);return}this.rowDragComps=this.destroyBeans(this.rowDragComps,o)}),this.addListenersForCellComps()}addListenersForCellComps(){this.addManagedListeners(this.rowNode,{rowIndexChanged:()=>{for(let t of this.getAllCellCtrls())t.onRowIndexChanged()},cellChanged:t=>{for(let e of this.getAllCellCtrls())e.onCellChanged(t)}})}onRowPinned(){for(let t of this.allRowGuis)t.rowComp.toggleCss("ag-row-pinned-source",!!this.rowNode.pinnedSibling)}onRowNodeDataChanged(t){this.refreshRow({suppressFlash:!t.update,newData:!t.update})}refreshRow(t){if(this.isFullWidth()!==!!this.isNodeFullWidthCell()){this.beans.rowRenderer.redrawRow(this.rowNode);return}if(this.isFullWidth()){this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode);return}for(let i of this.getAllCellCtrls())i.refreshCell(t);for(let i of this.allRowGuis)this.setRowCompRowId(i.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(i.rowComp);this.onRowSelected(),this.postProcessCss()}postProcessCss(){this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.rowEditStyleFeature?.applyRowStyles(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){let t=this.beans.rowDropHighlightSvc,e=t?.row===this.rowNode?t.position:"none",i=e==="above",n=e==="inside",r=e==="below",s=this.gos.get("treeData")&&(r||i),a=this.rowNode.uiLevel.toString();for(let l of this.allRowGuis){let c=l.rowComp;c.toggleCss("ag-row-highlight-above",i),c.toggleCss("ag-row-highlight-inside",n),c.toggleCss("ag-row-highlight-below",r),c.toggleCss("ag-row-highlight-indent",s),s?l.element.style.setProperty("--ag-row-highlight-level",a):l.element.style.removeProperty("--ag-row-highlight-level")}}postProcessRowDragging(){let t=this.rowNode.dragging;for(let e of this.allRowGuis)e.rowComp.toggleCss("ag-row-dragging",t)}onDisplayedColumnsChanged(){this.updateColumnLists(!0),this.beans.rowAutoHeight?.requestCheckAutoHeight()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:Co(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}onKeyboardNavigate(t){let e=this.findFullWidthInfoForEvent(t);if(!e)return;let{rowGui:i,column:n}=e;if(!(i.element===t.target))return;let s=this.rowNode,{focusSvc:a,navigation:l}=this.beans,c=a.getFocusedCell(),d={rowIndex:s.rowIndex,rowPinned:s.rowPinned,column:c?.column??n};l?.navigateToNextCell(t,t.key,d,!0),t.preventDefault()}onTabKeyDown(t){if(t.defaultPrevented||yo(t))return;let e=this.allRowGuis.find(a=>a.element.contains(t.target)),i=e?e.element:null,n=i===t.target,r=St(this.beans),o=!1;i&&r&&(o=i.contains(r)&&r.classList.contains("ag-cell"));let s=null;!n&&!o&&(s=Oa(this.beans,i,!1,t.shiftKey)),(this.isFullWidth()&&n||!s)&&this.beans.navigation?.onTabKeyDown(this,t)}getFullWidthElement(){return this.fullWidthGui?this.fullWidthGui.element:null}getRowYPosition(){let t=this.allRowGuis.find(e=>Nr(e.element))?.element;return t?t.getBoundingClientRect().top:0}onSuppressCellFocusChanged(t){let e=this.isFullWidth()&&t?void 0:this.gos.get("tabIndex");for(let i of this.allRowGuis)cn(i.element,"tabindex",e)}onFullWidthRowFocused(t){let e=this.rowNode,i=t?this.isFullWidth()&&t.rowIndex===e.rowIndex&&t.rowPinned==e.rowPinned:!1,n;if(this.fullWidthGui)n=this.fullWidthGui.element;else{let o=this.beans.colModel.getCol(t?.column)?.pinned;o?n=o==="right"?this.rightGui?.element:this.leftGui?.element:n=this.centerGui?.element}n&&(n.classList.toggle("ag-full-width-focus",i),i&&t?.forceBrowserFocus&&n.focus({preventScroll:!0}))}recreateCell(t){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,t),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,t),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,t),t.destroy(),this.updateColumnLists()}removeCellCtrl(t,e){let i={list:[],map:{}};for(let n of t.list)n!==e&&(i.list.push(n),i.map[n.column.getInstanceId()]=n);return i}onMouseEvent(t,e){switch(t){case"dblclick":this.onRowDblClick(e);break;case"click":this.onRowClick(e);break;case"touchstart":case"mousedown":this.onRowMouseDown(e);break}}createRowEvent(t,e){let{rowNode:i}=this;return Ee(this.gos,{type:t,node:i,data:i.data,rowIndex:i.rowIndex,rowPinned:i.rowPinned,event:e})}createRowEventWithSource(t,e){let i=this.createRowEvent(t,e);return i.source=this,i}onRowDblClick(t){if(yo(t))return;let e=this.createRowEventWithSource("rowDoubleClicked",t);e.isEventHandlingSuppressed=this.isSuppressMouseEvent(t),this.beans.eventSvc.dispatchEvent(e)}findFullWidthInfoForEvent(t){if(!t)return;let e=this.findFullWidthRowGui(t.target),i=this.getColumnForFullWidth(e);if(!(!e||!i))return{rowGui:e,column:i}}findFullWidthRowGui(t){return this.allRowGuis.find(e=>e.element.contains(t))}getColumnForFullWidth(t){let{visibleCols:e}=this.beans;switch(t?.containerType){case"center":return e.centerCols[0];case"left":return e.leftCols[0];case"right":return e.rightCols[0];default:return e.allCols[0]}}onRowMouseDown(t){if(this.lastMouseDownOnDragger=Sa(t.target,"ag-row-drag",3),!this.isFullWidth()||this.isSuppressMouseEvent(t))return;let{rangeSvc:e,focusSvc:i}=this.beans;e?.removeAllCellRanges();let n=this.findFullWidthInfoForEvent(t);if(!n)return;let{rowGui:r,column:o}=n,s=r.element,a=t.target,l=this.rowNode,c=t.defaultPrevented||Es();s&&s.contains(a)&&Yu(a)&&(c=!1),i.setFocusedCell({rowIndex:l.rowIndex,column:o,rowPinned:l.rowPinned,forceBrowserFocus:c})}isSuppressMouseEvent(t){let{gos:e,rowNode:i}=this;if(this.isFullWidth()){let r=this.findFullWidthRowGui(t.target);return MY(e,r?.rowComp.getFullWidthCellRendererParams(),i,t)}let n=KS(e,t.target);return n!=null&&lm(e,n.column,i,t)}onRowClick(t){if(yo(t)||this.lastMouseDownOnDragger)return;let i=this.isSuppressMouseEvent(t),{eventSvc:n,selectionSvc:r}=this.beans,o=this.createRowEventWithSource("rowClicked",t);o.isEventHandlingSuppressed=i,n.dispatchEvent(o),!i&&r?.handleSelectionEvent(t,this.rowNode,"rowClicked")}setupDetailRowAutoHeight(t){this.rowType==="FullWidthDetail"&&this.beans.masterDetailSvc?.setupDetailRowAutoHeight(this,t)}createFullWidthCompDetails(t,e){let{gos:i,rowNode:n}=this,r=Ee(i,{fullWidth:!0,data:n.data,node:n,value:n.key,valueFormatted:n.key,eGridCell:t,eParentOfValue:t,pinned:e,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(s,a,l,c)=>this.addFullWidthRowDragging(s,a,l,c),setTooltip:(s,a)=>{i.assertModuleRegistered("Tooltip",3),this.setupFullWidthRowTooltip(s,a)}}),o=this.beans.userCompFactory;switch(this.rowType){case"FullWidthDetail":return B$(o,r);case"FullWidthGroup":{let{value:s,valueFormatted:a}=this.beans.valueSvc.getValueForDisplay(void 0,this.rowNode,!0);return r.value=s,r.valueFormatted=a,N$(o,r)}case"FullWidthLoading":return L$(o,r);default:return O$(o,r)}}setupFullWidthRowTooltip(t,e){this.fullWidthGui&&(this.tooltipFeature=this.beans.tooltipSvc?.setupFullWidthRowTooltip(this.tooltipFeature,this,t,e))}addFullWidthRowDragging(t,e,i="",n){let{rowDragSvc:r,context:o}=this.beans;if(!r||!this.isFullWidth())return;let s=r.createRowDragComp(()=>i,this.rowNode,void 0,t,e,n);this.createBean(s,o),this.addDestroyFunc(()=>{this.destroyBean(s,o)})}onUiLevelChanged(){let t=ZT(this.rowNode);if(this.rowLevel!=t){let e="ag-row-level-"+t,i="ag-row-level-"+this.rowLevel;for(let n of this.allRowGuis)n.rowComp.toggleCss(e,!0),n.rowComp.toggleCss(i,!1)}this.rowLevel=t}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getLastRow()}refreshFirstAndLastRowStyles(){let t=this.isFirstRowOnPage(),e=this.isLastRowOnPage();if(this.firstRowOnPage!==t){this.firstRowOnPage=t;for(let i of this.allRowGuis)i.rowComp.toggleCss("ag-row-first",t)}if(this.lastRowOnPage!==e){this.lastRowOnPage=e;for(let i of this.allRowGuis)i.rowComp.toggleCss("ag-row-last",e)}}getAllCellCtrls(){return this.leftCellCtrls.list.length===0&&this.rightCellCtrls.list.length===0?this.centerCellCtrls.list:[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){let t=[];if(this.beans.rowStyleSvc?.processClassesFromGridOptions(t,this.rowNode),!!t.length)for(let e of t)for(let i of this.allRowGuis)i.rowComp.toggleCss(e,!0)}postProcessRowClassRules(){this.beans.rowStyleSvc?.processRowClassRules(this.rowNode,t=>{for(let e of this.allRowGuis)e.rowComp.toggleCss(t,!0)},t=>{for(let e of this.allRowGuis)e.rowComp.toggleCss(t,!1)})}setStylesFromGridOptions(t,e){t&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(e,i=>i.rowComp.setUserStyles(this.rowStyles))}getPinnedForContainer(t){return t==="left"||t==="right"?t:null}getInitialRowClasses(t){let e=this.getPinnedForContainer(t),i=this.isFullWidth(),{rowNode:n,beans:r}=this,o=[];o.push("ag-row"),o.push(this.rowFocused?"ag-row-focus":"ag-row-no-focus"),this.fadeInAnimation[t]&&o.push("ag-opacity-zero"),o.push(n.rowIndex%2===0?"ag-row-even":"ag-row-odd"),n.isRowPinned()&&(o.push("ag-row-pinned"),r.pinnedRowModel?.isManual()&&o.push("ag-row-pinned-manual")),!n.isRowPinned()&&n.pinnedSibling&&o.push("ag-row-pinned-source"),n.isSelected()&&o.push("ag-row-selected"),n.footer&&o.push("ag-row-footer"),o.push("ag-row-level-"+this.rowLevel),n.stub&&o.push("ag-row-loading"),i&&o.push("ag-full-width-row"),r.expansionSvc?.addExpandedCss(o,n),n.dragging&&o.push("ag-row-dragging");let{rowStyleSvc:s}=r;return s&&(s.processClassesFromGridOptions(o,n),s.preProcessRowClassRules(o,n)),o.push(this.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),this.isFirstRowOnPage()&&o.push("ag-row-first"),this.isLastRowOnPage()&&o.push("ag-row-last"),i&&(e==="left"&&o.push("ag-cell-last-left-pinned"),e==="right"&&o.push("ag-cell-first-right-pinned")),o}processStylesFromGridOptions(){return this.beans.rowStyleSvc?.processStylesFromGridOptions(this.rowNode)??this.emptyStyle}onRowSelected(t){this.beans.selectionSvc?.onRowCtrlSelected(this,e=>{(e===this.centerGui||e===this.fullWidthGui)&&this.announceDescription()},t)}announceDescription(){this.beans.selectionSvc?.announceAriaRowSelection(this.rowNode)}addHoverFunctionality(t){if(!this.active)return;let{element:e,compBean:i}=t,{rowNode:n,beans:r,gos:o}=this;i.addManagedListeners(e,{pointerenter:s=>{s.pointerType==="mouse"&&n.dispatchRowEvent("mouseEnter")},pointerleave:s=>{s.pointerType==="mouse"&&n.dispatchRowEvent("mouseLeave")}}),i.addManagedListeners(n,{mouseEnter:()=>{!r.dragSvc?.dragging&&!o.get("suppressRowHoverHighlight")&&(e.classList.add("ag-row-hover"),n.setHovered(!0))},mouseLeave:()=>{this.resetHoveredStatus(e)}})}resetHoveredStatus(t){let e=t?[t]:this.allRowGuis.map(i=>i.element);for(let i of e)i.classList.remove("ag-row-hover");this.rowNode.setHovered(!1)}roundRowTopToBounds(t){let e=this.beans.ctrlsSvc.getScrollFeature().getApproximateVScollPosition(),i=this.applyPaginationOffset(e.top,!0)-100,n=this.applyPaginationOffset(e.bottom,!0)+100;return Math.min(Math.max(i,t),n)}forEachGui(t,e){if(t)e(t);else for(let i of this.allRowGuis)e(i)}isRowRendered(){return this.allRowGuis.length>0}onRowHeightChanged(t){if(this.rowNode.rowHeight==null)return;let e=this.rowNode.rowHeight,i=this.beans.environment.getDefaultRowHeight(),r=jD(this.gos)?ws(this.beans,this.rowNode).height:void 0,o=r?`${Math.min(i,r)-2}px`:void 0;this.forEachGui(t,s=>{s.element.style.height=`${e}px`,o&&s.element.style.setProperty("--ag-line-height",o)})}destroyFirstPass(t=!1){this.active=!1;let{rowNode:e}=this;if(!t&&rc(this.gos)&&!e.sticky)if(e.rowTop!=null){let r=this.roundRowTopToBounds(e.rowTop);this.setRowTop(r)}else for(let r of this.allRowGuis)r.rowComp.toggleCss("ag-opacity-zero",!0);this.fullWidthGui?.element.contains(St(this.beans))&&this.beans.focusSvc.attemptToRecoverFocus(),e.setHovered(!1);let i=this.createRowEvent("virtualRowRemoved");this.dispatchLocalEvent(i),this.beans.eventSvc.dispatchEvent(i),super.destroy()}destroySecondPass(){this.allRowGuis.length=0;let t=e=>{for(let i of e.list)i.destroy();return{list:[],map:{}}};this.centerCellCtrls=t(this.centerCellCtrls),this.leftCellCtrls=t(this.leftCellCtrls),this.rightCellCtrls=t(this.rightCellCtrls)}setFocusedClasses(t){this.forEachGui(t,e=>{e.rowComp.toggleCss("ag-row-focus",this.rowFocused),e.rowComp.toggleCss("ag-row-no-focus",!this.rowFocused)})}onCellFocusChanged(){let{focusSvc:t}=this.beans,e=t.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);e!==this.rowFocused&&(this.rowFocused=e,this.setFocusedClasses())}onPaginationChanged(){let t=this.beans.pagination?.getCurrentPage()??0;this.paginationPage!==t&&(this.paginationPage=t,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(t,e=!1){if(this.rowNode.isRowPinned()||this.rowNode.sticky)return t;let i=this.beans.pageBounds.getPixelOffset();return t+i*(e?1:-1)}setRowTop(t){if(!this.printLayout&&ae(t)){let e=this.applyPaginationOffset(t),r=`${this.rowNode.isRowPinned()||this.rowNode.sticky?e:this.beans.rowContainerHeight.getRealPixelPosition(e)}px`;this.setRowTopStyle(r)}}getInitialRowTop(t){return this.suppressRowTransform?this.getInitialRowTopShared(t):void 0}getInitialTransform(t){return this.suppressRowTransform?void 0:`translateY(${this.getInitialRowTopShared(t)})`}getInitialRowTopShared(t){if(this.printLayout)return"";let e=this.rowNode,i;if(e.sticky)i=e.stickyRowTop;else{let n=this.slideInAnimation[t]?this.roundRowTopToBounds(e.oldRowTop):e.rowTop,r=this.applyPaginationOffset(n);i=e.isRowPinned()?r:this.beans.rowContainerHeight.getRealPixelPosition(r)}return i+"px"}setRowTopStyle(t){for(let e of this.allRowGuis)this.suppressRowTransform?e.rowComp.setTop(t):e.rowComp.setTransform(`translateY(${t})`)}getCellCtrl(t,e=!1){let i=null;for(let n of this.getAllCellCtrls())n.column==t&&(i=n);if(i!=null||e)return i;for(let n of this.getAllCellCtrls())n?.getColSpanningList().indexOf(t)>=0&&(i=n);return i}onRowIndexChanged(){this.rowNode.rowIndex!=null&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}updateRowIndexes(t){let e=this.rowNode.getRowIndexString();if(e===null)return;let i=(this.beans.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0)+(this.beans.filterManager?.getHeaderRowCount()??0),n=this.rowNode.rowIndex%2===0,r=i+this.rowNode.rowIndex+1;this.forEachGui(t,o=>{o.rowComp.setRowIndex(e),o.rowComp.toggleCss("ag-row-even",n),o.rowComp.toggleCss("ag-row-odd",!n),fm(o.element,r)})}},Qte=class extends H{constructor(){super(),this.beanName="navigation",this.onPageDown=J5(this.onPageDown,100),this.onPageUp=J5(this.onPageUp,100)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,t=>{this.gridBodyCon=t.gridBodyCtrl})}handlePageScrollingKey(t,e=!1){let i=t.key,n=t.altKey,r=t.ctrlKey||t.metaKey,o=!!this.beans.rangeSvc&&t.shiftKey,s=rX(this.gos,t),a=!1;switch(i){case A.PAGE_HOME:case A.PAGE_END:!r&&!n&&(this.onHomeOrEndKey(i),a=!0);break;case A.LEFT:case A.RIGHT:case A.UP:case A.DOWN:if(!s)return!1;r&&!n&&!o&&(this.onCtrlUpDownLeftRight(i,s),a=!0);break;case A.PAGE_DOWN:case A.PAGE_UP:!r&&!n&&(a=this.handlePageUpDown(i,s,e));break}return a&&t.preventDefault(),a}handlePageUpDown(t,e,i){return i&&(e=this.beans.focusSvc.getFocusedCell()),e?(t===A.PAGE_UP?this.onPageUp(e):this.onPageDown(e),!0):!1}navigateTo({scrollIndex:t,scrollType:e,scrollColumn:i,focusIndex:n,focusColumn:r,isAsync:o,rowPinned:s}){let{scrollFeature:a}=this.gridBodyCon;ae(i)&&!i.isPinned()&&a.ensureColumnVisible(i),ae(t)&&a.ensureIndexVisible(t,e),o||a.ensureIndexVisible(n);let{focusSvc:l,rangeSvc:c}=this.beans;l.setFocusedCell({rowIndex:n,column:r,rowPinned:s,forceBrowserFocus:!0}),c?.setRangeToCell({rowIndex:n,rowPinned:s,column:r})}onPageDown(t){let e=this.beans,i=Oy(e),n=this.getViewportHeight(),{pageBounds:r,rowModel:o,rowAutoHeight:s}=e,a=r.getPixelOffset(),l=i.top+n,c=o.getRowIndexAtPixel(l+a);s?.active?this.navigateToNextPageWithAutoHeight(t,c):this.navigateToNextPage(t,c)}onPageUp(t){let e=this.beans,i=Oy(e),{pageBounds:n,rowModel:r,rowAutoHeight:o}=e,s=n.getPixelOffset(),a=i.top,l=r.getRowIndexAtPixel(a+s);o?.active?this.navigateToNextPageWithAutoHeight(t,l,!0):this.navigateToNextPage(t,l,!0)}navigateToNextPage(t,e,i=!1){let{pageBounds:n,rowModel:r}=this.beans,o=this.getViewportHeight(),s=n.getFirstRow(),a=n.getLastRow(),l=n.getPixelOffset(),c=r.getRow(t.rowIndex),d=i?c?.rowHeight-o-l:o-l,u=c?.rowTop+d,h=r.getRowIndexAtPixel(u+l);if(h===t.rowIndex){let f=i?-1:1;e=h=t.rowIndex+f}let p;i?(p="bottom",h<s&&(h=s),e<s&&(e=s)):(p="top",h>a&&(h=a),e>a&&(e=a)),this.isRowTallerThanView(r.getRow(h))&&(e=h,p="top"),this.navigateTo({scrollIndex:e,scrollType:p,scrollColumn:null,focusIndex:h,focusColumn:t.column})}navigateToNextPageWithAutoHeight(t,e,i=!1){this.navigateTo({scrollIndex:e,scrollType:i?"bottom":"top",scrollColumn:null,focusIndex:e,focusColumn:t.column}),setTimeout(()=>{let n=this.getNextFocusIndexForAutoHeight(t,i);this.navigateTo({scrollIndex:e,scrollType:i?"bottom":"top",scrollColumn:null,focusIndex:n,focusColumn:t.column,isAsync:!0})},50)}getNextFocusIndexForAutoHeight(t,e=!1){let i=e?-1:1,n=this.getViewportHeight(),{pageBounds:r,rowModel:o}=this.beans,s=r.getLastRow(),a=0,l=t.rowIndex;for(;l>=0&&l<=s;){let c=o.getRow(l);if(c){let d=c.rowHeight??0;if(a+d>n)break;a+=d}l+=i}return Math.max(0,Math.min(l,s))}getViewportHeight(){let t=this.beans,e=Oy(t),i=this.beans.scrollVisibleSvc.getScrollbarWidth(),n=e.bottom-e.top;return t.ctrlsSvc.get("center").isHorizontalScrollShowing()&&(n-=i),n}isRowTallerThanView(t){if(!t)return!1;let e=t.rowHeight;return typeof e!="number"?!1:e>this.getViewportHeight()}onCtrlUpDownLeftRight(t,e){let i=this.beans.cellNavigation.getNextCellToFocus(t,e,!0),n=this.getNormalisedPosition(i),{rowIndex:r,rowPinned:o,column:s}=n??i,a=s;this.navigateTo({scrollIndex:r,scrollType:null,scrollColumn:a,focusIndex:r,focusColumn:a,rowPinned:o})}onHomeOrEndKey(t){let e=t===A.PAGE_HOME,{visibleCols:i,pageBounds:n,rowModel:r}=this.beans,o=i.allCols,s=e?n.getFirstRow():n.getLastRow(),a=r.getRow(s);if(!a)return;let l=(e?o:[...o].reverse()).find(c=>!c.isSuppressNavigable(a));l&&this.navigateTo({scrollIndex:s,scrollType:null,scrollColumn:l,focusIndex:s,focusColumn:l})}onTabKeyDown(t,e){let i=e.shiftKey,n=this.tabToNextCellCommon(t,i,e),r=this.beans,{ctrlsSvc:o,pageBounds:s,focusSvc:a,gos:l}=r;if(n!==!1){n?e.preventDefault():n===null&&o.get("gridCtrl").allowFocusForNextCoreContainer(i);return}if(i){let{rowIndex:c,rowPinned:d}=t.getRowPosition();(d?c===0:c===s.getFirstRow())&&(l.get("headerHeight")===0||Ra(r)?mc(r,!0,!0):(e.preventDefault(),a.focusPreviousFromFirstCell(e)))}else t instanceof uc&&t.focusCell(!0),(a.focusOverlay(!1)||mc(r,i))&&e.preventDefault()}tabToNextCell(t,e){let i=this.beans,{focusSvc:n,rowRenderer:r}=i,o=n.getFocusedCell();if(!o)return!1;let s=ec(i,o);return!s&&(s=r.getRowByPosition(o),!s?.isFullWidth())?!1:!!this.tabToNextCellCommon(s,t,e,"api")}tabToNextCellCommon(t,e,i,n="ui"){let{editSvc:r,focusSvc:o}=this.beans,s,a=t instanceof uc?t:t.getAllCellCtrls()?.[0];return r?.isEditing()?s=r?.moveToNextCell(a,e,i,n):s=this.moveToNextCellNotEditing(t,e,i),s===null?s:s||!!o.focusedHeader}moveToNextCellNotEditing(t,e,i){let n=this.beans.visibleCols.allCols,r;if(t instanceof Am){if(r=k(w({},t.getRowPosition()),{column:e?n[0]:dt(n)}),this.gos.get("embedFullWidthRows")&&i){let s=t.findFullWidthInfoForEvent(i);s&&(r.column=s.column)}}else r=t.getFocusedCellPosition();let o=this.findNextCellToFocusOn(r,{backwards:e,startEditing:!1});if(o===!1)return null;if(o instanceof uc)o.focusCell(!0);else if(o)return this.tryToFocusFullWidthRow(o,e);return ae(o)}findNextCellToFocusOn(t,{backwards:e,startEditing:i,skipToNextEditableCell:n}){let r=t,o=this.beans,{cellNavigation:s,gos:a,focusSvc:l,rowRenderer:c,rangeSvc:d}=o;for(;;){t!==r&&(t=r),e||(r=this.getLastCellOfColSpan(r)),r=s.getNextTabbedCell(r,e);let u=a.getCallback("tabToNextCell");if(ae(u)){let g=u({backwards:e,editing:i,previousCellPosition:t,nextCellPosition:r||null});if(g===!0)r=t;else{if(g===!1)return!1;r={rowIndex:g.rowIndex,column:g.column,rowPinned:g.rowPinned}}}if(!r)return null;if(r.rowIndex<0){let f=Ir(o);return l.focusHeaderPosition({headerPosition:{headerRowIndex:f+r.rowIndex,column:r.column},fromCell:!0}),null}let h=a.get("editType")==="fullRow";if(i&&(!h||n)&&!this.isCellEditable(r))continue;this.ensureCellVisible(r);let p=ec(o,r);if(!p){let f=c.getRowByPosition(r);if(!f||!f.isFullWidth()||i)continue;return k(w({},f.getRowPosition()),{column:r?.column})}if(!s.isSuppressNavigable(p.column,p.rowNode))return p.setFocusedCellPosition(r),d?.setRangeToCell(r),p}}isCellEditable(t){let e=this.lookupRowNodeForCell(t);return e?t.column.isCellEditable(e):!1}lookupRowNodeForCell({rowIndex:t,rowPinned:e}){let{pinnedRowModel:i,rowModel:n}=this.beans;return e==="top"?i?.getPinnedTopRow(t):e==="bottom"?i?.getPinnedBottomRow(t):n.getRow(t)}navigateToNextCell(t,e,i,n){let r=i,o=!1,s=this.beans,{cellNavigation:a,focusSvc:l,gos:c}=s;for(;r&&(r===i||!this.isValidNavigateCell(r));)c.get("enableRtl")?e===A.LEFT&&(r=this.getLastCellOfColSpan(r)):e===A.RIGHT&&(r=this.getLastCellOfColSpan(r)),r=a.getNextCellToFocus(e,r),o=wt(r);if(o&&t&&t.key===A.UP&&(r={rowIndex:-1,rowPinned:null,column:i.column}),n){let u=c.getCallback("navigateToNextCell");if(ae(u)){let p=u({key:e,previousCellPosition:i,nextCellPosition:r||null,event:t});ae(p)?r={rowPinned:p.rowPinned,rowIndex:p.rowIndex,column:p.column}:r=null}}if(!r)return;if(r.rowIndex<0){let u=Ir(s);l.focusHeaderPosition({headerPosition:{headerRowIndex:u+r.rowIndex,column:i.column},event:t||void 0,fromCell:!0});return}let d=this.getNormalisedPosition(r);d?this.focusPosition(d):this.tryToFocusFullWidthRow(r)}getNormalisedPosition(t){if(!!this.beans.spannedRowRenderer?.getCellByPosition(t))return t;this.ensureCellVisible(t);let i=ec(this.beans,t);return i?(t=i.getFocusedCellPosition(),this.ensureCellVisible(t),t):null}tryToFocusFullWidthRow(t,e){let{visibleCols:i,rowRenderer:n,focusSvc:r,eventSvc:o}=this.beans,s=i.allCols;if(!n.getRowByPosition(t)?.isFullWidth())return!1;let l=r.getFocusedCell(),c={rowIndex:t.rowIndex,rowPinned:t.rowPinned,column:t.column||(e?dt(s):s[0])};this.focusPosition(c);let d=e??(l!=null&&XJ(c,l));return o.dispatchEvent({type:"fullWidthRowFocused",rowIndex:c.rowIndex,rowPinned:c.rowPinned,column:c.column,isFullWidthCell:!0,fromBelow:d}),!0}focusPosition(t){let{focusSvc:e,rangeSvc:i}=this.beans;e.setFocusedCell({rowIndex:t.rowIndex,column:t.column,rowPinned:t.rowPinned,forceBrowserFocus:!0}),i?.setRangeToCell(t)}isValidNavigateCell(t){return!!xo(this.beans,t)}getLastCellOfColSpan(t){let e=ec(this.beans,t);if(!e)return t;let i=e.getColSpanningList();return i.length===1?t:{rowIndex:t.rowIndex,column:dt(i),rowPinned:t.rowPinned}}ensureCellVisible(t){let e=$D(this.gos),i=this.beans.rowModel.getRow(t.rowIndex),n=e&&i?.sticky,{scrollFeature:r}=this.gridBodyCon;!n&&wt(t.rowPinned)&&r.ensureIndexVisible(t.rowIndex),t.column.isPinned()||r.ensureColumnVisible(t.column)}ensureColumnVisible(t){let e=this.gridBodyCon.scrollFeature;t.isPinned()||e.ensureColumnVisible(t)}ensureRowVisible(t){this.gridBodyCon.scrollFeature.ensureIndexVisible(t)}};function Oy(t){return t.ctrlsSvc.getScrollFeature().getVScrollPosition()}var Zte={moduleName:"KeyboardNavigation",version:oe,beans:[Qte,yte,Iee],apiFunctions:{getFocusedCell:Ste,clearFocusedCell:xte,setFocusedCell:Ete,setFocusedHeader:_te,tabToNextCell:Pte,tabToPreviousCell:Rte}},eie=class extends H{constructor(){super(...arguments),this.beanName="pageBoundsListener"}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this),recalculateRowBounds:this.calculatePages.bind(this)}),this.onModelUpdated()}onModelUpdated(t){this.calculatePages(),this.eventSvc.dispatchEvent({type:"paginationChanged",animate:t?.animate??!1,newData:t?.newData??!1,newPage:t?.newPage??!1,newPageSize:t?.newPageSize??!1,keepRenderedRows:t?.keepRenderedRows??!1})}calculatePages(){let{pageBounds:t,pagination:e,rowModel:i}=this.beans;e?e.calculatePages():t.calculateBounds(0,i.getRowCount()-1)}},tie=class extends H{constructor(){super(...arguments),this.beanName="pageBounds",this.pixelOffset=0}getFirstRow(){return this.topRowBounds?.rowIndex??-1}getLastRow(){return this.bottomRowBounds?.rowIndex??-1}getCurrentPageHeight(){let{topRowBounds:t,bottomRowBounds:e}=this;return!t||!e?0:Math.max(e.rowTop+e.rowHeight-t.rowTop,0)}getCurrentPagePixelRange(){let{topRowBounds:t,bottomRowBounds:e}=this,i=t?.rowTop??0,n=e?e.rowTop+e.rowHeight:0;return{pageFirstPixel:i,pageLastPixel:n}}calculateBounds(t,e){let{rowModel:i}=this.beans,n=i.getRowBounds(t);n&&(n.rowIndex=t),this.topRowBounds=n;let r=i.getRowBounds(e);r&&(r.rowIndex=e),this.bottomRowBounds=r,this.calculatePixelOffset()}getPixelOffset(){return this.pixelOffset}calculatePixelOffset(){let t=this.topRowBounds?.rowTop??0;this.pixelOffset!==t&&(this.pixelOffset=t,this.eventSvc.dispatchEvent({type:"paginationPixelOffsetChanged"}))}},iie=".ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top{min-width:0;overflow:hidden;position:relative}.ag-pinned-left-sticky-top,.ag-pinned-right-sticky-top{height:100%;overflow:hidden;position:relative}.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{height:100%;overflow:hidden;width:100%}.ag-pinned-left-header,.ag-pinned-right-header{display:inline-block;height:100%;overflow:hidden;position:relative}.ag-body-horizontal-scroll:not(.ag-scrollbar-invisible){.ag-horizontal-left-spacer:not(.ag-scroller-corner){border-right:var(--ag-pinned-column-border)}.ag-horizontal-right-spacer:not(.ag-scroller-corner){border-left:var(--ag-pinned-column-border)}}.ag-pinned-right-header{border-left:var(--ag-pinned-column-border)}.ag-pinned-left-header{border-right:var(--ag-pinned-column-border)}.ag-cell.ag-cell-first-right-pinned:not(.ag-cell-range-left,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-left:var(--ag-pinned-column-border)}.ag-cell.ag-cell-last-left-pinned:not(.ag-cell-range-right,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-right:var(--ag-pinned-column-border)}.ag-pinned-left-header .ag-header-cell-resize:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}.ag-pinned-right-header .ag-header-cell-resize:after{left:50%}.ag-pinned-left-header .ag-header-cell-resize{right:-3px}.ag-pinned-right-header .ag-header-cell-resize{left:-3px}",nie=class extends H{constructor(t,e){super(),this.isLeft=t,this.elements=e,this.getWidth=t?()=>this.beans.pinnedCols.leftWidth:()=>this.beans.pinnedCols.rightWidth}postConstruct(){this.addManagedEventListeners({[`${this.isLeft?"left":"right"}PinnedWidthChanged`]:this.onPinnedWidthChanged.bind(this)})}onPinnedWidthChanged(){let t=this.getWidth(),e=t>0;for(let i of this.elements)i&&(Ct(i,e),Ar(i,t))}},rie=class extends H{constructor(){super(...arguments),this.beanName="pinnedCols"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl});let t=this.checkContainerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:t,displayedColumnsWidthChanged:t}),this.addManagedPropertyListener("domLayout",t)}checkContainerWidths(){let{gos:t,visibleCols:e,eventSvc:i}=this.beans,n=pi(t,"print"),r=n?0:e.getColsLeftWidth(),o=n?0:e.getDisplayedColumnsRightWidth();r!=this.leftWidth&&(this.leftWidth=r,i.dispatchEvent({type:"leftPinnedWidthChanged"})),o!=this.rightWidth&&(this.rightWidth=o,i.dispatchEvent({type:"rightPinnedWidthChanged"}))}keepPinnedColumnsNarrowerThanViewport(){let t=this.gridBodyCtrl.eBodyViewport,e=ah(t);if(e<=50)return;let i=this.getPinnedColumnsOverflowingViewport(e-50),n=this.gos.getCallback("processUnpinnedColumns"),{columns:r,hasLockedPinned:o}=i,s=r;!s.length&&!o||(n&&(s=n({columns:s,viewportWidth:e})),s?.length&&(s=s.filter(a=>!wo(a)),this.setColsPinned(s,null,"viewportSizeFeature")))}createPinnedWidthFeature(t,...e){return new nie(t,e)}setColsPinned(t,e,i){let{colModel:n,colAnimation:r,visibleCols:o,gos:s}=this.beans;if(!n.cols||!t?.length)return;if(pi(s,"print")){K(37);return}r?.start();let a;e===!0||e==="left"?a="left":e==="right"?a="right":a=null;let l=[];for(let c of t){if(!c)continue;let d=n.getCol(c);d&&d.getPinned()!==a&&(this.setColPinned(d,a),l.push(d))}l.length&&(o.refresh(i),dM(this.eventSvc,l,i)),r?.finish()}initCol(t){let{pinned:e,initialPinned:i}=t.colDef;e!==void 0?this.setColPinned(t,e):this.setColPinned(t,i)}setColPinned(t,e){e===!0||e==="left"?t.pinned="left":e==="right"?t.pinned="right":t.pinned=null,t.dispatchStateUpdatedEvent("pinned")}setupHeaderPinnedWidth(t){let{scrollVisibleSvc:e}=this.beans;if(t.pinned==null)return;let i=t.pinned==="left",n=t.pinned==="right";t.hidden=!0;let r=()=>{let o=i?this.leftWidth:this.rightWidth;if(o==null)return;let s=o==0,a=t.hidden!==s,l=this.gos.get("enableRtl"),c=e.getScrollbarWidth(),u=e.verticalScrollShowing&&(l&&i||!l&&n)?o+c:o;t.comp.setPinnedContainerWidth(`${u}px`),t.comp.setDisplayed(!s),a&&(t.hidden=s,t.refresh())};t.addManagedEventListeners({leftPinnedWidthChanged:r,rightPinnedWidthChanged:r,scrollVisibilityChanged:r,scrollbarWidthChanged:r})}getHeaderResizeDiff(t,e){if(e.getPinned()){let{leftWidth:n,rightWidth:r}=this,o=ah(this.beans.ctrlsSvc.getGridBodyCtrl().eBodyViewport)-50;if(n+r+t>o)if(o>n+r)t=o-n-r;else return 0}return t}getPinnedColumnsOverflowingViewport(t){let e=this.rightWidth??0,i=this.leftWidth??0,n=e+i,r=!1;if(n<t)return{columns:[],hasLockedPinned:r};let{visibleCols:o}=this.beans,s=[...o.leftCols],a=[...o.rightCols],l=0,c=0,d=0,u=[],h=n-d-t;for(;(c<s.length||l<a.length)&&h>0;){if(l<a.length){let p=a[l++];if(p.colDef.lockPinned){r=!0;continue}h-=p.getActualWidth(),u.push(p)}if(c<s.length&&h>0){let p=s[c++];if(p.colDef.lockPinned){r=!0;continue}h-=p.getActualWidth(),u.push(p)}}return{columns:u,hasLockedPinned:r}}},oie={moduleName:"PinnedColumn",version:oe,beans:[rie],css:[iie]},sie=class extends H{constructor(){super(),this.beanName="ariaAnnounce",this.descriptionContainer=null,this.pendingAnnouncements=new Map,this.lastAnnouncement="",this.updateAnnouncement=ui(this,this.updateAnnouncement.bind(this),200)}postConstruct(){let t=this.beans,e=ri(t),i=this.descriptionContainer=e.createElement("div");i.classList.add("ag-aria-description-container"),wD(i,"polite"),Fj(i,"additions text"),kj(i,!0),t.eGridDiv.appendChild(i)}announceValue(t,e){this.pendingAnnouncements.set(e,t),this.updateAnnouncement()}updateAnnouncement(){if(!this.descriptionContainer)return;let t=Array.from(this.pendingAnnouncements.values()).join(". ");this.pendingAnnouncements.clear(),this.descriptionContainer.textContent="",setTimeout(()=>{this.handleAnnouncementUpdate(t)},50)}handleAnnouncementUpdate(t){if(!this.isAlive()||!this.descriptionContainer)return;let e=t;if(e==null||e.replace(/[ .]/g,"")==""){this.lastAnnouncement="";return}this.lastAnnouncement===e&&(e=`${e}\u200B`),this.lastAnnouncement=e,this.descriptionContainer.textContent=e}destroy(){super.destroy();let{descriptionContainer:t}=this;t&&(hi(t),t.remove()),this.descriptionContainer=null,this.pendingAnnouncements.clear()}},aie={moduleName:"Aria",version:oe,beans:[sie]},lie=":where(.ag-delay-render){.ag-cell,.ag-header-cell,.ag-header-group-cell,.ag-row,.ag-spanned-cell-wrapper{visibility:hidden}}",eD="ag-delay-render",cie=class extends H{constructor(){super(...arguments),this.beanName="colDelayRenderSvc",this.hideRequested=!1,this.alreadyRevealed=!1,this.timesRetried=0,this.requesters=new Set}hideColumns(t){this.alreadyRevealed||this.requesters.has(t)||(this.requesters.add(t),this.hideRequested||(this.beans.ctrlsSvc.whenReady(this,e=>{e.gridBodyCtrl.eGridBody.classList.add(eD)}),this.hideRequested=!0))}revealColumns(t){if(this.alreadyRevealed||!this.isAlive()||(this.requesters.delete(t),this.requesters.size>0))return;let{renderStatus:e,ctrlsSvc:i}=this.beans;if(e){if(!e.areHeaderCellsRendered()&&this.timesRetried<5){this.timesRetried++,setTimeout(()=>this.revealColumns(t));return}this.timesRetried=0}i.getGridBodyCtrl().eGridBody.classList.remove(eD),this.alreadyRevealed=!0}},die={moduleName:"ColumnDelayRender",version:oe,beans:[cie],css:[lie]};function uie(t){t.overlays?.showLoadingOverlay()}function hie(t){t.overlays?.showNoRowsOverlay()}function pie(t){t.overlays?.hideOverlay()}var fie=".ag-overlay{inset:0;pointer-events:none;position:absolute;z-index:2}.ag-overlay-panel,.ag-overlay-wrapper{display:flex;height:100%;width:100%}.ag-overlay-wrapper{align-items:center;flex:none;justify-content:center;text-align:center}.ag-overlay-loading-wrapper{pointer-events:all}.ag-overlay-loading-center{background:var(--ag-background-color);border:solid var(--ag-border-width) var(--ag-border-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-popup-shadow);padding:var(--ag-spacing)}",gie={tag:"div",cls:"ag-overlay",role:"presentation",children:[{tag:"div",cls:"ag-overlay-panel",role:"presentation",children:[{tag:"div",ref:"eOverlayWrapper",cls:"ag-overlay-wrapper",role:"presentation"}]}]},V8=class extends et{constructor(){super(gie),this.eOverlayWrapper=re,this.activePromise=null,this.activeOverlay=null,this.updateListenerDestroyFunc=null,this.activeCssClass=null,this.elToFocusAfter=null,this.registerCSS(fie)}handleKeyDown(t){if(t.key!==A.TAB||t.defaultPrevented||yo(t))return;let e=this.beans;if(Oa(e,this.eOverlayWrapper,!1,t.shiftKey))return;let n=!1;t.shiftKey?n=e.focusSvc.focusGridView({column:dt(e.visibleCols.allCols),backwards:!0,canFocusOverlay:!1}):n=mc(e,!1),n&&t.preventDefault()}updateLayoutClasses(t,e){let i=this.eOverlayWrapper.classList,{AUTO_HEIGHT:n,NORMAL:r,PRINT:o}=Qn;i.toggle(n,e.autoHeight),i.toggle(r,e.normal),i.toggle(o,e.print)}postConstruct(){this.createManagedBean(new qS(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.beans.overlays.setOverlayWrapperComp(this),this.addManagedElementListeners(this.getFocusableElement(),{keydown:this.handleKeyDown.bind(this)})}setWrapperTypeClass(t){let e=this.eOverlayWrapper.classList;this.activeCssClass&&e.toggle(this.activeCssClass,!1),this.activeCssClass=t,e.toggle(t,!0)}showOverlay(t,e,i,n){if(this.setWrapperTypeClass(e),this.destroyActiveOverlay(),this.elToFocusAfter=null,this.activePromise=t,!!t){if(this.setDisplayed(!0,{skipAriaHidden:!0}),i&&this.isGridFocused()){let r=St(this.beans);r&&!gD(this.beans)&&(this.elToFocusAfter=r)}t.then(r=>{if(this.activePromise!==t){this.activeOverlay!==r&&(this.destroyBean(r),r=null);return}if(this.activePromise=null,!!r){if(this.activeOverlay!==r&&(this.eOverlayWrapper.appendChild(r.getGui()),this.activeOverlay=r,n)){let o=r;this.updateListenerDestroyFunc=this.addManagedPropertyListener(n,({currentValue:s})=>{o.refresh?.(Ee(this.gos,w({},s??{})))})}i&&this.isGridFocused()&&Ta(this.eOverlayWrapper)}})}}updateOverlayWrapperPaddingTop(t){this.eOverlayWrapper.style.setProperty("padding-top",`${t}px`)}destroyActiveOverlay(){this.activePromise=null;let t=this.activeOverlay;if(!t)return;let e=this.elToFocusAfter;this.activeOverlay=null,this.elToFocusAfter=null,e&&!this.isGridFocused()&&(e=null);let i=this.updateListenerDestroyFunc;i&&(i(),this.updateListenerDestroyFunc=null),this.destroyBean(t),hi(this.eOverlayWrapper),e?.focus?.({preventScroll:!0})}hideOverlay(){this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}isGridFocused(){let t=St(this.beans);return!!t&&this.beans.eGridDiv.contains(t)}destroy(){this.elToFocusAfter=null,this.destroyActiveOverlay(),this.beans.overlays.setOverlayWrapperComp(void 0),super.destroy()}},mie={selector:"AG-OVERLAY-WRAPPER",component:V8},vie=class extends H{constructor(){super(...arguments),this.beanName="overlays",this.state=0,this.showInitialOverlay=!0,this.wrapperPadding=0}postConstruct(){this.isClientSide=Lt(this.gos),this.isServerSide=!this.isClientSide&&wc(this.gos);let t=()=>this.updateOverlayVisibility();this.addManagedEventListeners({newColumnsLoaded:t,rowDataUpdated:t,gridSizeChanged:this.refreshWrapperPadding.bind(this),rowCountReady:()=>{this.showInitialOverlay=!1,this.updateOverlayVisibility()}}),this.addManagedPropertyListener("loading",t)}setOverlayWrapperComp(t){this.eWrapper=t,this.updateOverlayVisibility()}isVisible(){return this.state!==0&&!!this.eWrapper}isExclusive(){return this.state===1&&!!this.eWrapper}showLoadingOverlay(){this.showInitialOverlay=!1;let t=this.gos,e=t.get("loading");!e&&(e!==void 0||t.get("suppressLoadingOverlay"))||this.doShowLoadingOverlay()}showNoRowsOverlay(){this.showInitialOverlay=!1;let t=this.gos;t.get("loading")||t.get("suppressNoRowsOverlay")||this.doShowNoRowsOverlay()}hideOverlay(){if(this.showInitialOverlay=!1,this.gos.get("loading")){K(99);return}this.doHideOverlay()}getOverlayWrapperSelector(){return mie}getOverlayWrapperCompClass(){return V8}updateOverlayVisibility(){if(!this.eWrapper){this.state=0;return}let{state:t,isClientSide:e,isServerSide:i,beans:{gos:n,colModel:r,rowModel:o}}=this,s=this.gos.get("loading");s!==void 0&&(this.showInitialOverlay=!1),this.showInitialOverlay&&s===void 0&&!n.get("suppressLoadingOverlay")&&(s=!n.get("columnDefs")||!r.ready||!n.get("rowData")&&e),s?t!==1&&this.doShowLoadingOverlay():(this.showInitialOverlay=!1,e&&o.isEmpty()&&!n.get("suppressNoRowsOverlay")?t!==2&&this.doShowNoRowsOverlay():(t===1||!i&&t!==0)&&this.doHideOverlay())}doShowLoadingOverlay(){this.eWrapper&&(this.state=1,this.showOverlay(V$(this.beans.userCompFactory,Ee(this.gos,{})),"ag-overlay-loading-wrapper","loadingOverlayComponentParams"),this.updateExclusive())}doShowNoRowsOverlay(){this.eWrapper&&(this.state=2,this.showOverlay(G$(this.beans.userCompFactory,Ee(this.gos,{})),"ag-overlay-no-rows-wrapper","noRowsOverlayComponentParams"),this.updateExclusive())}doHideOverlay(){this.eWrapper&&(this.state=0,this.eWrapper.hideOverlay(),this.updateExclusive())}showOverlay(t,e,i){let n=t?.newAgStackInstance()??null;this.eWrapper?.showOverlay(n,e,this.isExclusive(),i),this.refreshWrapperPadding()}updateExclusive(){let t=this.exclusive;this.exclusive=this.isExclusive(),this.exclusive!==t&&this.eventSvc.dispatchEvent({type:"overlayExclusiveChanged"})}refreshWrapperPadding(){let t=this.eWrapper;if(!t)return;let e=0;this.state===2&&(e=this.beans.ctrlsSvc.get("gridHeaderCtrl")?.headerHeight||0),this.wrapperPadding!==e&&(this.wrapperPadding=e,t.updateOverlayWrapperPaddingTop(e))}},Cie={moduleName:"Overlay",version:oe,userComponents:{agLoadingOverlay:OX,agNoRowsOverlay:NX},apiFunctions:{showLoadingOverlay:uie,showNoRowsOverlay:hie,hideOverlay:pie},beans:[vie]},wie=class extends H{constructor(){super(...arguments),this.beanName="rowContainerHeight",this.scrollY=0,this.uiBodyHeight=0}postConstruct(){this.addManagedEventListeners({bodyHeightChanged:this.updateOffset.bind(this)}),this.maxDivHeight=q$(),Cs(this.gos,"RowContainerHeightService - maxDivHeight = "+this.maxDivHeight)}updateOffset(){if(!this.stretching)return;let t=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition().top,e=this.getUiBodyHeight();(t!==this.scrollY||e!==this.uiBodyHeight)&&(this.scrollY=t,this.uiBodyHeight=e,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;let t=this.scrollY/this.maxScrollY,e=t*this.pixelsToShave;Cs(this.gos,`RowContainerHeightService - Div Stretch Offset = ${e} (${this.pixelsToShave} * ${t})`),this.setDivStretchOffset(e)}setUiContainerHeight(t){t!==this.uiContainerHeight&&(this.uiContainerHeight=t,this.eventSvc.dispatchEvent({type:"rowContainerHeightChanged"}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(t){let e=typeof t=="number"?Math.floor(t):null;this.divStretchOffset!==e&&(this.divStretchOffset=e,this.eventSvc.dispatchEvent({type:"heightScaleChanged"}))}setModelHeight(t){this.modelHeight=t,this.stretching=t!=null&&this.maxDivHeight>0&&t>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getRealPixelPosition(t){return t-this.divStretchOffset}getUiBodyHeight(){let t=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition();return t.bottom-t.top}getScrollPositionForPixel(t){if(this.pixelsToShave<=0)return t;let e=this.modelHeight-this.getUiBodyHeight(),i=t/e;return this.maxScrollY*i}},bie=400,yie=class extends H{constructor(){super(...arguments),this.beanName="rowRenderer",this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1,this.setupRangeSelectionListeners=()=>{let t=()=>{for(let o of this.getAllCellCtrls())o.onCellSelectionChanged()},e=()=>{for(let o of this.getAllCellCtrls())o.updateRangeBordersIfRangeCount()},i=()=>{this.eventSvc.addListener("cellSelectionChanged",t),this.eventSvc.addListener("columnMoved",e),this.eventSvc.addListener("columnPinned",e),this.eventSvc.addListener("columnVisible",e)},n=()=>{this.eventSvc.removeListener("cellSelectionChanged",t),this.eventSvc.removeListener("columnMoved",e),this.eventSvc.removeListener("columnPinned",e),this.eventSvc.removeListener("columnVisible",e)};this.addDestroyFunc(()=>n()),this.addManagedPropertyListeners(["enableRangeSelection","cellSelection"],()=>{So(this.gos)?i():n()}),So(this.gos)&&i()}}wireBeans(t){this.pageBounds=t.pageBounds,this.colModel=t.colModel,this.pinnedRowModel=t.pinnedRowModel,this.rowModel=t.rowModel,this.focusSvc=t.focusSvc,this.rowContainerHeight=t.rowContainerHeight,this.ctrlsSvc=t.ctrlsSvc,this.editSvc=t.editSvc}postConstruct(){this.ctrlsSvc.whenReady(this,t=>{this.gridBodyCtrl=t.gridBodyCtrl,this.initialise()})}initialise(){this.addManagedEventListeners({paginationChanged:this.onPageLoaded.bind(this),pinnedRowDataChanged:this.onPinnedRowDataChanged.bind(this),pinnedRowsChanged:this.onPinnedRowsChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),bodyScroll:this.onBodyScroll.bind(this),bodyHeightChanged:this.redraw.bind(this,{})}),this.addManagedPropertyListeners(["domLayout","embedFullWidthRows"],()=>this.onDomLayoutChanged()),this.addManagedPropertyListeners(["suppressMaxRenderedRowRestriction","rowBuffer"],()=>this.redraw()),this.addManagedPropertyListener("suppressCellFocus",n=>this.onSuppressCellFocusChanged(n.currentValue)),this.addManagedPropertyListeners(["groupSuppressBlankHeader","getBusinessKeyForNode","fullWidthCellRenderer","fullWidthCellRendererParams","suppressStickyTotalRow","groupRowRenderer","groupRowRendererParams","loadingCellRenderer","loadingCellRendererParams","detailCellRenderer","detailCellRendererParams","enableRangeSelection","enableCellTextSelection"],()=>this.redrawRows()),this.addManagedPropertyListener("cellSelection",({currentValue:n,previousValue:r})=>{(!r&&n||r&&!n)&&this.redrawRows()});let{stickyRowSvc:t,gos:e,showRowGroupCols:i}=this.beans;if(i&&this.addManagedPropertyListener("showOpenedGroup",()=>{let n=i.getShowRowGroupCols();n.length&&this.refreshCells({columns:n,force:!0})}),t)this.stickyRowFeature=t.createStickyRowFeature(this,this.createRowCon.bind(this),this.destroyRowCtrls.bind(this));else{let n=this.gridBodyCtrl;n.setStickyTopHeight(0),n.setStickyBottomHeight(0)}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=pi(e,"print"),this.embedFullWidthRows=this.printLayout||e.get("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gos.get("keepDetailRows")){let t=this.getKeepDetailRowsCount(),e=t??3;this.cachedRowCtrls=new Sie(e)}}getKeepDetailRowsCount(){return this.gos.get("keepDetailRowsCount")}getStickyTopRowCtrls(){return this.stickyRowFeature?.stickyTopRowCtrls??[]}getStickyBottomRowCtrls(){return this.stickyRowFeature?.stickyBottomRowCtrls??[]}updateAllRowCtrls(){let t=Object.values(this.rowCtrlsByRowIndex),e=Object.values(this.zombieRowCtrls),i=this.cachedRowCtrls?.getEntries()??[];e.length>0||i.length>0?this.allRowCtrls=[...t,...e,...i]:this.allRowCtrls=t}isCellBeingRendered(t,e){let i=this.rowCtrlsByRowIndex[t];return!e||!i?!!i:i.isFullWidth()?!0:!!this.beans.spannedRowRenderer?.getCellByPosition({rowIndex:t,column:e,rowPinned:null})||!!i.getCellCtrl(e)||!i.isRowRendered()}updateCellFocus(t){for(let e of this.getAllCellCtrls())e.onCellFocused(t);for(let e of this.getFullWidthRowCtrls())e.onFullWidthRowFocused(t)}onCellFocusChanged(t){if(t?.rowIndex!=null&&!t.rowPinned){let e=this.beans.colModel.getCol(t.column)??void 0;this.isCellBeingRendered(t.rowIndex,e)||this.redraw()}this.updateCellFocus(t)}onSuppressCellFocusChanged(t){for(let e of this.getAllCellCtrls())e.onSuppressCellFocusChanged(t);for(let e of this.getFullWidthRowCtrls())e.onSuppressCellFocusChanged(t)}registerCellEventListeners(){this.addManagedEventListeners({cellFocused:t=>this.onCellFocusChanged(t),cellFocusCleared:()=>this.updateCellFocus(),flashCells:t=>{let{cellFlashSvc:e}=this.beans;if(e)for(let i of this.getAllCellCtrls())e.onFlashCells(i,t)},columnHoverChanged:()=>{for(let t of this.getAllCellCtrls())t.onColumnHover()},displayedColumnsChanged:()=>{for(let t of this.getAllCellCtrls())t.onDisplayedColumnsChanged()},displayedColumnsWidthChanged:()=>{if(this.printLayout)for(let t of this.getAllCellCtrls())t.onLeftChanged()}}),this.setupRangeSelectionListeners(),this.refreshListenersToColumnsForCellComps(),this.addManagedEventListeners({gridColumnsChanged:this.refreshListenersToColumnsForCellComps.bind(this)}),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){for(let t of this.destroyFuncsForColumnListeners)t();this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners();let t=this.colModel.getCols();for(let e of t){let i=l=>{for(let c of this.getAllCellCtrls())c.column===e&&l(c)},n=()=>{i(l=>l.onLeftChanged())},r=()=>{i(l=>l.onWidthChanged())},o=()=>{i(l=>l.onFirstRightPinnedChanged())},s=()=>{i(l=>l.onLastLeftPinnedChanged())},a=()=>{i(l=>l.onColDefChanged())};e.__addEventListener("leftChanged",n),e.__addEventListener("widthChanged",r),e.__addEventListener("firstRightPinnedChanged",o),e.__addEventListener("lastLeftPinnedChanged",s),e.__addEventListener("colDefChanged",a),this.destroyFuncsForColumnListeners.push(()=>{e.__removeEventListener("leftChanged",n),e.__removeEventListener("widthChanged",r),e.__removeEventListener("firstRightPinnedChanged",o),e.__removeEventListener("lastLeftPinnedChanged",s),e.__removeEventListener("colDefChanged",a)})}}onDomLayoutChanged(){let t=pi(this.gos,"print"),e=t||this.gos.get("embedFullWidthRows"),i=e!==this.embedFullWidthRows||this.printLayout!==t;this.printLayout=t,this.embedFullWidthRows=e,i&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;let t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t)}onPageLoaded(t){let e={recycleRows:t.keepRenderedRows,animate:t.animate,newData:t.newData,newPage:t.newPage,onlyBody:!0};this.redrawAfterModelUpdate(e)}getAllCellsNotSpanningForColumn(t){let e=[];for(let i of this.getAllRowCtrls()){let n=i.getCellCtrl(t,!0)?.eGui;n&&e.push(n)}return e}refreshFloatingRowComps(t=!0){this.refreshFloatingRows(this.topRowCtrls,"top",t),this.refreshFloatingRows(this.bottomRowCtrls,"bottom",t)}refreshFloatingRows(t,e,i){let{pinnedRowModel:n,beans:r,printLayout:o}=this,s=Object.fromEntries(t.map(l=>[l.rowNode.id,l]));n?.forEachPinnedRow(e,(l,c)=>{let d=t[c];d&&n.getPinnedRowById(d.rowNode.id,e)===void 0&&(d.destroyFirstPass(),d.destroySecondPass()),l.id in s&&i?(t[c]=s[l.id],delete s[l.id]):t[c]=new Am(l,r,!1,!1,o)});let a=(e==="top"?n?.getPinnedTopRowCount():n?.getPinnedBottomRowCount())??0;t.length=a}onPinnedRowDataChanged(){let t={recycleRows:!0};this.redrawAfterModelUpdate(t)}onPinnedRowsChanged(){this.redrawAfterModelUpdate({recycleRows:!0})}redrawRow(t,e=!1){if(t.sticky)this.stickyRowFeature?.refreshStickyNode(t);else if(this.cachedRowCtrls?.has(t)){this.cachedRowCtrls.removeRow(t);return}else{let i=n=>{let r=n[t.rowIndex];r&&r.rowNode===t&&(r.destroyFirstPass(),r.destroySecondPass(),n[t.rowIndex]=this.createRowCon(t,!1,!1))};switch(t.rowPinned){case"top":i(this.topRowCtrls);break;case"bottom":i(this.bottomRowCtrls);break;default:i(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}e||this.dispatchDisplayedRowsChanged(!1)}redrawRows(t){let{editSvc:e}=this.beans;if(e?.isEditing()&&(e.isBatchEditing()?e.cleanupEditors():e.stopEditing(void 0,{source:"api"})),t!=null){for(let n of t??[])this.redrawRow(n,!0);this.dispatchDisplayedRowsChanged(!1);return}this.redrawAfterModelUpdate()}redrawAfterModelUpdate(t={}){this.getLockOnRefresh();let e=this.beans.focusSvc?.getFocusCellToUseAfterRefresh();this.updateContainerHeights(),this.scrollToTopIfNewData(t);let i=!t.domLayoutChanged&&!!t.recycleRows,n=t.animate&&rc(this.gos),r=i?this.getRowsToRecycle():null;i||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender();let{stickyRowFeature:o,gos:s}=this;if(o){o.checkStickyRows();let a=o.extraTopHeight+o.extraBottomHeight;a&&this.updateContainerHeights(a)}this.recycleRows(r,n),this.gridBodyCtrl.updateRowCount(),t.onlyBody||this.refreshFloatingRowComps(s.get("enableRowPinning")?i:void 0),this.dispatchDisplayedRowsChanged(),e!=null&&this.restoreFocusedCell(e),this.releaseLockOnRefresh()}scrollToTopIfNewData(t){let e=t.newData||t.newPage,i=this.gos.get("suppressScrollOnNewData");e&&!i&&(this.gridBodyCtrl.scrollFeature.scrollToTop(),this.stickyRowFeature?.resetOffsets())}updateContainerHeights(t=0){let{rowContainerHeight:e}=this;if(this.printLayout){e.setModelHeight(null);return}let i=this.pageBounds.getCurrentPageHeight();i===0&&(i=1),e.setModelHeight(i+t)}getLockOnRefresh(){if(this.refreshInProgress)throw new Error(Or(252));this.refreshInProgress=!0,this.beans.frameworkOverrides.getLockOnRefresh?.()}releaseLockOnRefresh(){this.refreshInProgress=!1,this.beans.frameworkOverrides.releaseLockOnRefresh?.()}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(t){if(!t)return;let e=this.beans.focusSvc,i=this.findPositionToFocus(t);if(!i){e.focusHeaderPosition({headerPosition:{headerRowIndex:Ir(this.beans)-1,column:t.column}});return}if(t.rowIndex!==i.rowIndex||t.rowPinned!=i.rowPinned){e.setFocusedCell(k(w({},i),{preventScrollOnBrowserFocus:!0,forceBrowserFocus:!0}));return}e.doesRowOrCellHaveBrowserFocus()||this.updateCellFocus(Ee(this.gos,k(w({},i),{forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,type:"cellFocused"})))}findPositionToFocus(t){let{pagination:e,pageBounds:i}=this.beans,n=t;for(n.rowPinned==null&&e&&i&&!e.isRowInPage(n.rowIndex)&&(n={rowPinned:null,rowIndex:i.getFirstRow()});n;){if(n.rowPinned==null&&i)if(n.rowIndex<i.getFirstRow()){if(n=Mm(this.beans,{rowPinned:null,rowIndex:0}),!n)return null}else n.rowIndex>i.getLastRow()&&(n={rowPinned:null,rowIndex:i.getLastRow()});let r=this.getRowByPosition(n);if(r?.isAlive())return k(w({},r.getRowPosition()),{column:t.column});n=Mm(this.beans,n)}return null}getAllCellCtrls(){let t=[],e=this.getAllRowCtrls(),i=e.length;for(let n=0;n<i;n++){let r=e[n].getAllCellCtrls(),o=r.length;for(let s=0;s<o;s++)t.push(r[s])}return t}getAllRowCtrls(){let{spannedRowRenderer:t}=this.beans,e=this.getStickyTopRowCtrls(),i=this.getStickyBottomRowCtrls();return[...this.topRowCtrls,...this.bottomRowCtrls,...e,...i,...t?.getCtrls("top")??[],...t?.getCtrls("bottom")??[],...t?.getCtrls("center")??[],...Object.values(this.rowCtrlsByRowIndex)]}addRenderedRowListener(t,e,i){let n=this.rowCtrlsByRowIndex[e];n&&n.addEventListener(t,i)}refreshCells({rowNodes:t,columns:e,force:i,suppressFlash:n}={}){let r={force:i,newData:!1,suppressFlash:n};for(let o of this.getCellCtrls(t,e))o.refreshOrDestroyCell(r);this.refreshFullWidth(t)}refreshRows(t={}){for(let e of this.getRowCtrls(t.rowNodes))e.refreshRow(t);this.refreshFullWidth(t.rowNodes)}refreshFullWidth(t){if(!t)return;let e=!1;for(let i of this.getRowCtrls(t)){if(!i.isFullWidth())continue;i.refreshFullWidth()||(e=!0,this.redrawRow(i.rowNode,!0))}e&&this.dispatchDisplayedRowsChanged(!1)}getRowCtrls(t){let e=mS(t),i=this.getAllRowCtrls();return!t||!e?i:i.filter(n=>{let r=n.rowNode;return vS(r,e)})}getCellCtrls(t,e){let i;ae(e)&&(i={},e.forEach(r=>{let o=this.colModel.getCol(r);ae(o)&&(i[o.getId()]=!0)}));let n=[];for(let r of this.getRowCtrls(t))for(let o of r.getAllCellCtrls()){let s=o.column.getId();i&&!i[s]||n.push(o)}return n}destroy(){this.removeAllRowComps(!0),super.destroy()}removeAllRowComps(t=!1){let e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e,t),this.stickyRowFeature?.destroyStickyCtrls()}getRowsToRecycle(){let t=[];for(let i of Object.keys(this.rowCtrlsByRowIndex))this.rowCtrlsByRowIndex[i].rowNode.id==null&&t.push(i);this.removeRowCtrls(t);let e={};for(let i of Object.values(this.rowCtrlsByRowIndex)){let n=i.rowNode;e[n.id]=i}return this.rowCtrlsByRowIndex={},e}removeRowCtrls(t,e=!1){for(let i of t){let n=this.rowCtrlsByRowIndex[i];n&&(n.destroyFirstPass(e),n.destroySecondPass()),delete this.rowCtrlsByRowIndex[i]}}onBodyScroll(t){t.direction==="vertical"&&this.redraw({afterScroll:!0})}redraw(t={}){let{focusSvc:e,animationFrameSvc:i}=this.beans,{afterScroll:n}=t,r,o=this.stickyRowFeature;o&&(r=e?.getFocusCellToUseAfterRefresh()||void 0);let s=this.firstRenderedRow,a=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();let l=!1;if(o){l=o.checkStickyRows();let d=o.extraTopHeight+o.extraBottomHeight;d&&this.updateContainerHeights(d)}let c=this.firstRenderedRow!==s||this.lastRenderedRow!==a;if(!(n&&!l&&!c)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,n),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(n&&!l),r!=null)){let d=e?.getFocusCellToUseAfterRefresh();r!=null&&d==null&&(i?.flushAllFrames(),this.restoreFocusedCell(r))}}removeRowCompsNotToDraw(t,e){let i={};for(let o of t)i[o]=!0;let r=Object.keys(this.rowCtrlsByRowIndex).filter(o=>!i[o]);this.removeRowCtrls(r,e)}calculateIndexesToDraw(t){let e=[];for(let s=this.firstRenderedRow;s<=this.lastRenderedRow;s++)e.push(s);let i=this.beans.pagination,n=this.beans.focusSvc?.getFocusedCell()?.rowIndex;n!=null&&(n<this.firstRenderedRow||n>this.lastRenderedRow)&&(!i||i.isRowInPage(n))&&n<this.rowModel.getRowCount()&&e.push(n);let r=s=>{let a=s.rowNode.rowIndex;a==null||a===n||(a<this.firstRenderedRow||a>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(s)&&e.push(a)};for(let s of Object.values(this.rowCtrlsByRowIndex))r(s);if(t)for(let s of Object.values(t))r(s);e.sort((s,a)=>s-a);let o=[];for(let s=0;s<e.length;s++){let a=e[s],l=this.rowModel.getRow(a);l&&!l.sticky&&o.push(a)}return o}recycleRows(t,e=!1,i=!1){let n=this.calculateIndexesToDraw(t);(this.printLayout||i)&&(e=!1),this.removeRowCompsNotToDraw(n,!e);for(let r of n)this.createOrUpdateRowCtrl(r,t,e,i);if(t){let{animationFrameSvc:r}=this.beans;r?.active&&i&&!this.printLayout?r.addDestroyTask(()=>{this.destroyRowCtrls(t,e),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}):this.destroyRowCtrls(t,e)}this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(t=!1){this.eventSvc.dispatchEvent({type:"displayedRowsChanged",afterScroll:t})}onDisplayedColumnsChanged(){let{visibleCols:t}=this.beans,e=t.isPinningLeft(),i=t.isPinningRight();(this.pinningLeft!==e||i!==this.pinningRight)&&(this.pinningLeft=e,this.pinningRight=i,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){let t=[];for(let e of this.getFullWidthRowCtrls()){let i=e.rowNode.rowIndex;t.push(i.toString())}this.refreshFloatingRowComps(),this.removeRowCtrls(t),this.redraw({afterScroll:!0})}getFullWidthRowCtrls(t){let e=mS(t);return this.getAllRowCtrls().filter(i=>{if(!i.isFullWidth())return!1;let n=i.rowNode;return!(e!=null&&!vS(n,e))})}createOrUpdateRowCtrl(t,e,i,n){let r,o=this.rowCtrlsByRowIndex[t];if(o||(r=this.rowModel.getRow(t),ae(r)&&ae(e)&&e[r.id]&&r.alreadyRendered&&(o=e[r.id],e[r.id]=null)),!o)if(r||(r=this.rowModel.getRow(t)),ae(r))o=this.createRowCon(r,i,n);else return;r&&(r.alreadyRendered=!0),this.rowCtrlsByRowIndex[t]=o}destroyRowCtrls(t,e){let i=[];if(t){for(let n of Object.values(t))if(n){if(this.cachedRowCtrls&&n.isCacheable()){this.cachedRowCtrls.addRow(n);continue}if(n.destroyFirstPass(!e),e){let r=n.instanceId;this.zombieRowCtrls[r]=n,i.push(()=>{n.destroySecondPass(),delete this.zombieRowCtrls[r]})}else n.destroySecondPass()}}e&&(i.push(()=>{this.isAlive()&&(this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged())}),window.setTimeout(()=>{for(let n of i)n()},bie))}getRowBuffer(){return this.gos.get("rowBuffer")}getRowBufferInPixels(){let t=this.getRowBuffer(),e=Ea(this.beans);return t*e}workOutFirstAndLastRowsToRender(){let{rowContainerHeight:t,pageBounds:e,rowModel:i}=this;t.updateOffset();let n,r;if(!i.isRowsToRender())n=0,r=-1;else if(this.printLayout)this.beans.environment.refreshRowHeightVariable(),n=e.getFirstRow(),r=e.getLastRow();else{let d=this.getRowBufferInPixels(),u=this.ctrlsSvc.getScrollFeature(),h=this.gos.get("suppressRowVirtualisation"),p=!1,f,g;do{let S=e.getPixelOffset(),{pageFirstPixel:x,pageLastPixel:E}=e.getCurrentPagePixelRange(),P=t.divStretchOffset,L=u.getVScrollPosition(),B=L.top,j=L.bottom;h?(f=x+P,g=E+P):(f=Math.max(B+S-d,x)+P,g=Math.min(j+S+d,E)+P),this.firstVisibleVPixel=Math.max(B+S,x)+P,this.lastVisibleVPixel=Math.min(j+S,E)+P,p=this.ensureAllRowsInRangeHaveHeightsCalculated(f,g)}while(p);let m=i.getRowIndexAtPixel(f),v=i.getRowIndexAtPixel(g),C=e.getFirstRow(),b=e.getLastRow();m<C&&(m=C),v>b&&(v=b),n=m,r=v}let o=pi(this.gos,"normal"),s=this.gos.get("suppressMaxRenderedRowRestriction"),a=Math.max(this.getRowBuffer(),500);o&&!s&&r-n>a&&(r=n+a);let l=n!==this.firstRenderedRow,c=r!==this.lastRenderedRow;(l||c)&&(this.firstRenderedRow=n,this.lastRenderedRow=r,this.eventSvc.dispatchEvent({type:"viewportChanged",firstRow:n,lastRow:r}))}dispatchFirstDataRenderedEvent(){this.dataFirstRenderedFired||(this.dataFirstRenderedFired=!0,Eo(this.beans,()=>{this.beans.eventSvc.dispatchEvent({type:"firstDataRendered",firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow})}))}ensureAllRowsInRangeHaveHeightsCalculated(t,e){let i=this.pinnedRowModel?.ensureRowHeightsValid(),n=this.stickyRowFeature?.ensureRowHeightsValid(),{pageBounds:r,rowModel:o}=this,s=o.ensureRowHeightsValid(t,e,r.getFirstRow(),r.getLastRow());return(s||n)&&this.eventSvc.dispatchEvent({type:"recalculateRowBounds"}),n||s||i?(this.updateContainerHeights(),!0):!1}doNotUnVirtualiseRow(t){let n=t.rowNode,r=this.focusSvc.isRowFocused(n.rowIndex,n.rowPinned),o=this.editSvc?.isEditing(t),s=n.detail;return r||o||s?!!this.isRowPresent(n):!1}isRowPresent(t){return this.rowModel.isRowPresent(t)?this.beans.pagination?.isRowInPage(t.rowIndex)??!0:!1}createRowCon(t,e,i){let n=this.cachedRowCtrls?.getRow(t)??null;if(n)return n;let r=i&&!this.printLayout&&!!this.beans.animationFrameSvc?.active;return new Am(t,this.beans,e,r,this.printLayout)}getRenderedNodes(){let t=Object.values(this.rowCtrlsByRowIndex).map(n=>n.rowNode),e=this.getStickyTopRowCtrls().map(n=>n.rowNode),i=this.getStickyBottomRowCtrls().map(n=>n.rowNode);return[...e,...t,...i]}getRowByPosition(t){let e,{rowIndex:i}=t;switch(t.rowPinned){case"top":e=this.topRowCtrls[i];break;case"bottom":e=this.bottomRowCtrls[i];break;default:e=this.rowCtrlsByRowIndex[i],e||(e=this.getStickyTopRowCtrls().find(n=>n.rowNode.rowIndex===i)||null,e||(e=this.getStickyBottomRowCtrls().find(n=>n.rowNode.rowIndex===i)||null));break}return e}isRangeInRenderedViewport(t,e){if(t==null||e==null)return!1;let n=t>this.lastRenderedRow;return!(e<this.firstRenderedRow)&&!n}},Sie=class{constructor(t){this.entriesMap={},this.entriesList=[],this.maxCount=t}addRow(t){if(this.entriesMap[t.rowNode.id]=t,this.entriesList.push(t),t.setCached(!0),this.entriesList.length>this.maxCount){let e=this.entriesList[0];e.destroyFirstPass(),e.destroySecondPass(),this.removeFromCache(e)}}getRow(t){if(t?.id==null)return null;let e=this.entriesMap[t.id];return e?(this.removeFromCache(e),e.setCached(!1),e.rowNode!=t?null:e):null}has(t){return this.entriesMap[t.id]!=null}removeRow(t){let e=t.id,i=this.entriesMap[e];delete this.entriesMap[e],er(this.entriesList,i)}removeFromCache(t){let e=t.rowNode.id;delete this.entriesMap[e],er(this.entriesList,t)}getEntries(){return this.entriesList}};function mS(t){if(!t)return;let e={top:{},bottom:{},normal:{}};for(let i of t){let n=i.id;switch(i.rowPinned){case"top":e.top[n]=i;break;case"bottom":e.bottom[n]=i;break;default:e.normal[n]=i;break}}return e}function vS(t,e){let i=t.id;switch(t.rowPinned){case"top":return e.top[i]!=null;case"bottom":return e.bottom[i]!=null;default:return e.normal[i]!=null}}var xie=class extends H{constructor(){super(...arguments),this.beanName="rowNodeSorter"}postConstruct(){let{gos:t}=this;this.isAccentedSort=t.get("accentedSort"),this.primaryColumnsSortGroups=Dr(t),this.addManagedPropertyListener("accentedSort",e=>this.isAccentedSort=e.currentValue),this.addManagedPropertyListener("autoGroupColumnDef",()=>this.primaryColumnsSortGroups=Dr(t))}doFullSort(t,e){let i=t.map((n,r)=>({currentPos:r,rowNode:n}));return i.sort(this.compareRowNodes.bind(this,e)),i.map(n=>n.rowNode)}compareRowNodes(t,e,i){let n=e.rowNode,r=i.rowNode;for(let o=0,s=t.length;o<s;o++){let a=t[o],l=a.sort==="desc",c=this.getValue(n,a.column),d=this.getValue(r,a.column),u,h=this.getComparator(a,n);if(h?u=h(c,d,n,r,l):u=yj(c,d,this.isAccentedSort),!isNaN(u)&&u!==0)return a.sort==="asc"?u:u*-1}return e.currentPos-i.currentPos}getComparator(t,e){let i=t.column,n=i.getColDef().comparator;if(n!=null)return n;if(!i.getColDef().showRowGroup)return;let r=!e.group&&i.getColDef().field;if(!r)return;let o=this.beans.colModel.getColDefCol(r);if(o)return o.getColDef().comparator}getValue(t,e){let{valueSvc:i,colModel:n,showRowGroupCols:r,gos:o}=this.beans;if(!this.primaryColumnsSortGroups)return i.getValue(e,t,!1);if(t.rowGroupColumn===e){if(YD(o,n.isPivotActive())){let c=t.data?t:HM(t.childrenAfterGroup);return c&&i.getValue(e,c,!1)}let l=r?.getShowRowGroupCol(e.getId());return l?t.groupData?.[l.getId()]:void 0}if(!(t.group&&e.getColDef().showRowGroup))return i.getValue(e,t,!1)}};function Eie(t){t.sortSvc?.onSortChanged("api")}var G8={moduleName:"Sort",version:oe,beans:[Gee,xie],apiFunctions:{onSortChanged:Eie},userComponents:{agSortIndicator:n2},icons:{sortAscending:"asc",sortDescending:"desc",sortUnSort:"none"}},Pie=class extends H{constructor(){super(...arguments),this.beanName="syncSvc",this.waitingForColumns=!1}postConstruct(){this.addManagedPropertyListener("columnDefs",t=>this.setColumnDefs(t))}start(){this.beans.ctrlsSvc.whenReady(this,()=>{let t=this.gos.get("columnDefs");t?this.setColumnsAndData(t):this.waitingForColumns=!0,this.gridReady()})}setColumnsAndData(t){let{colModel:e,rowModel:i}=this.beans;e.setColumnDefs(t??[],"gridInitializing"),i.start()}gridReady(){let{eventSvc:t,gos:e}=this;t.dispatchEvent({type:"gridReady"}),Cs(e,`initialised successfully, enterprise = ${e.isModuleRegistered("EnterpriseCore")}`)}setColumnDefs(t){let e=this.gos.get("columnDefs");if(e){if(this.waitingForColumns){this.waitingForColumns=!1,this.setColumnsAndData(e);return}this.beans.colModel.setColumnDefs(e,sc(t.source))}}};function Rie(t){t.valueCache?.expire()}function _ie(t,e){let{colKey:i,rowNode:n,useFormatter:r}=e,o=t.colModel.getColDefCol(i)??t.colModel.getCol(i);if(wt(o))return null;let s=t.valueSvc.getValueForDisplay(o,n,r);return r?s.valueFormatted??Cc(s.value):s.value}var kie="paste",Fie=class extends H{constructor(){super(...arguments),this.beanName="changeDetectionSvc",this.clientSideRowModel=null}postConstruct(){let{gos:t,rowModel:e}=this.beans;Lt(t,e)&&(this.clientSideRowModel=e),this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this)})}onCellValueChanged(t){let{gos:e,rowRenderer:i}=this.beans;if(t.source===kie||e.get("suppressChangeDetection"))return;let n=t.node,r=[n],o=this.clientSideRowModel,s=o?.rootNode;if(s&&!n.isRowPinned()){let a=e.get("aggregateOnlyChangedColumns"),l=new fh(a,s);l.addParentNode(n.parent,[t.column]),o.doAggregate(l),l.forEachChangedNodeDepthFirst(c=>{r.push(c),c.sibling&&r.push(c.sibling)})}i.refreshCells({rowNodes:r})}},Tie=class extends H{constructor(){super(...arguments),this.beanName="expressionSvc",this.cache={}}evaluate(t,e){if(typeof t=="string")return this.evaluateExpression(t,e);at(15,{expression:t})}evaluateExpression(t,e){try{return this.createExpressionFunction(t)(e.value,e.context,e.oldValue,e.newValue,e.value,e.node,e.data,e.colDef,e.rowIndex,e.api,e.getValue,e.column,e.columnGroup)}catch(i){return at(16,{expression:t,params:e,e:i}),null}}createExpressionFunction(t){let e=this.cache;if(e[t])return e[t];let i=this.createFunctionBody(t),n=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, getValue, column, columnGroup",i);return e[t]=n,n}createFunctionBody(t){return t.includes("return")?t:"return "+t+";"}},Die=class extends H{constructor(){super(...arguments),this.beanName="valueCache",this.cacheVersion=0}postConstruct(){let t=this.gos;this.active=t.get("valueCache"),this.neverExpires=t.get("valueCacheNeverExpires")}onDataChanged(){this.neverExpires||this.expire()}expire(){this.cacheVersion++}setValue(t,e,i){if(this.active){let n=this.cacheVersion;t.__cacheVersion!==n&&(t.__cacheVersion=n,t.__cacheData={}),t.__cacheData[e]=i}}getValue(t,e){if(!(!this.active||t.__cacheVersion!==this.cacheVersion))return t.__cacheData[e]}},Mie={moduleName:"ValueCache",version:oe,beans:[Die],apiFunctions:{expireValueCache:Rie}},Iie={moduleName:"Expression",version:oe,beans:[Tie]},Aie={moduleName:"ChangeDetection",version:oe,beans:[Fie]},Oie={moduleName:"CellApi",version:oe,apiFunctions:{getCellValue:_ie}},Lie=class extends H{constructor(){super(...arguments),this.beanName="valueSvc",this.hasEditSvc=!1,this.initialised=!1,this.isSsrm=!1}wireBeans(t){this.expressionSvc=t.expressionSvc,this.colModel=t.colModel,this.valueCache=t.valueCache,this.dataTypeSvc=t.dataTypeSvc,this.editSvc=t.editSvc,this.hasEditSvc=!!t.editSvc}postConstruct(){this.initialised||this.init()}init(){this.executeValueGetter=this.valueCache?this.executeValueGetterWithValueCache.bind(this):this.executeValueGetterWithoutValueCache.bind(this),this.isSsrm=wc(this.gos),this.cellExpressions=this.gos.get("enableCellExpressions"),this.isTreeData=this.gos.get("treeData"),this.initialised=!0;let t=e=>this.callColumnCellValueChangedHandler(e);this.eventSvc.addListener("cellValueChanged",t,!0),this.addDestroyFunc(()=>this.eventSvc.removeListener("cellValueChanged",t,!0)),this.addManagedPropertyListener("treeData",e=>this.isTreeData=e.currentValue)}getValueForDisplay(t,e,i=!1,n=!1,r="ui"){let{showRowGroupColValueSvc:o}=this.beans,s=!t&&e.group,a=t?.colDef.showRowGroup,l=!this.isTreeData||e.footer;if(o&&l&&(s||a)){let g=o.getGroupValue(e,t);if(g==null)return{value:null,valueFormatted:null};if(!i)return{value:g.value,valueFormatted:null};let m=o.formatAndPrefixGroupColValue(g,t,n);return{value:g.value,valueFormatted:m}}if(!t)return{value:e.key,valueFormatted:null};let c=e.leafGroup&&this.colModel.isPivotMode(),d=e.group&&e.expanded&&!e.footer&&!c,u=this.gos.get("groupSuppressBlankHeader")||!e.sibling,h=d&&!u,p=this.getValue(t,e,h,r),f=i&&!(n&&t.colDef.useValueFormatterForExport===!1);return{value:p,valueFormatted:f?this.formatValue(t,e,p):null}}getValue(t,e,i=!1,n="ui"){if(this.initialised||this.init(),!e)return;let r=t.getColDef(),o=r.field,s=t.getColId(),a=e.data;if(this.hasEditSvc&&n==="ui"){let g=this.editSvc;if(g.isEditing()){let m=g.getCellDataValue({rowNode:e,column:t},!0);if(m!==void 0)return m}}let l,c=r.showRowGroup;if(typeof c=="string"&&(this.beans.rowGroupColsSvc?.getColumnIndex(c)??-1)>e.level)return null;let d=typeof c!="string"||!e.group,u=e.groupData&&s in e.groupData,h=!i&&e.aggData&&e.aggData[s]!==void 0,p=this.isSsrm&&i&&!!r.aggFunc,f=this.isSsrm&&e.footer&&e.field&&(r.showRowGroup===!0||r.showRowGroup===e.field);if(this.isTreeData&&h)l=e.aggData[s];else if(this.isTreeData&&r.valueGetter)l=this.executeValueGetter(r.valueGetter,a,t,e);else if(this.isTreeData&&o&&a)l=th(a,o,t.isFieldContainsDots());else if(u)l=e.groupData[s];else if(h)l=e.aggData[s];else if(r.valueGetter&&!p){if(!d)return l;l=this.executeValueGetter(r.valueGetter,a,t,e)}else if(f)l=th(a,e.field,t.isFieldContainsDots());else if(o&&a&&!p){if(!d)return l;l=th(a,o,t.isFieldContainsDots())}if(this.cellExpressions&&typeof l=="string"&&l.indexOf("=")===0){let g=l.substring(1);l=this.executeValueGetter(g,a,t,e)}return l}parseValue(t,e,i,n){let r=t.getColDef(),o=r.valueParser;if(ae(o)){let s=Ee(this.gos,{node:e,data:e?.data,oldValue:n,newValue:i,colDef:r,column:t});return typeof o=="function"?o(s):this.expressionSvc?.evaluate(o,s)}return i}getDeleteValue(t,e){return ae(t.getColDef().valueParser)?this.parseValue(t,e,"",this.getValueForDisplay(t,e).value)??null:null}formatValue(t,e,i,n,r=!0){let{expressionSvc:o}=this.beans,s=null,a,l=t.getColDef();if(n?a=n:r&&(a=l.valueFormatter),a){let c=e?e.data:null,d=Ee(this.gos,{value:i,node:e,data:c,colDef:l,column:t});typeof a=="function"?s=a(d):s=o?o.evaluate(a,d):null}else if(l.refData)return l.refData[i]||"";return s==null&&Array.isArray(i)&&(s=i.join(", ")),s}setValue(t,e,i,n){let r=this.colModel.getColDefCol(e);if(!t||!r)return!1;wt(t.data)&&(t.data={});let{field:o,valueSetter:s}=r.getColDef();if(wt(o)&&wt(s))return K(17),!1;if(this.dataTypeSvc&&!this.dataTypeSvc.checkType(r,i))return K(135),!1;let a=Ee(this.gos,{node:t,data:t.data,oldValue:this.getValue(r,t,void 0,n),newValue:i,colDef:r.getColDef(),column:r});a.newValue=i;let l;if(ae(s)?typeof s=="function"?l=s(a):l=this.expressionSvc?.evaluate(s,a):l=this.setValueUsingField(t.data,o,i,r.isFieldContainsDots()),l===void 0&&(l=!0),!l)return!1;t.resetQuickFilterAggregateText(),this.valueCache?.onDataChanged();let c=this.getValue(r,t);return this.dispatchCellValueChangedEvent(t,a,c,n),t.pinnedSibling&&this.dispatchCellValueChangedEvent(t.pinnedSibling,a,c,n),!0}dispatchCellValueChangedEvent(t,e,i,n){this.eventSvc.dispatchEvent({type:"cellValueChanged",event:null,rowIndex:t.rowIndex,rowPinned:t.rowPinned,column:e.column,colDef:e.colDef,data:t.data,node:t,oldValue:e.oldValue,newValue:i,value:i,source:n})}callColumnCellValueChangedHandler(t){let e=t.colDef.onCellValueChanged;typeof e=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>{e({node:t.node,data:t.data,oldValue:t.oldValue,newValue:t.newValue,colDef:t.colDef,column:t.column,api:t.api,context:t.context})})}setValueUsingField(t,e,i,n){if(!e)return!1;let r=!1;if(!n)r=t[e]===i,r||(t[e]=i);else{let o=e.split("."),s=t;for(;o.length>0&&s;){let a=o.shift();o.length===0?(r=s[a]===i,r||(s[a]=i)):s=s[a]}}return!r}executeValueGetterWithValueCache(t,e,i,n){let r=i.getColId(),o=this.valueCache.getValue(n,r);if(o!==void 0)return o;let s=this.executeValueGetterWithoutValueCache(t,e,i,n);return this.valueCache.setValue(n,r,s),s}executeValueGetterWithoutValueCache(t,e,i,n){let r=Ee(this.gos,{data:e,node:n,column:i,colDef:i.getColDef(),getValue:this.getValueCallback.bind(this,n)}),o;return typeof t=="function"?o=t(r):o=this.expressionSvc?.evaluate(t,r),o}getValueCallback(t,e){let i=this.colModel.getColDefCol(e);return i?this.getValue(i,t):null}getKeyForNode(t,e){let i=this.getValue(t,e),n=t.getColDef().keyCreator,r=i;if(n){let o=Ee(this.gos,{value:i,colDef:t.getColDef(),column:t,node:e,data:e.data});r=n(o)}return typeof r=="string"||r==null||(r=String(r),r==="[object Object]"&&K(121)),r}},Nie={moduleName:"CommunityCore",version:oe,beans:[Bee,DJ,UZ,h$,wie,iZ,Mee,ate,l$,tie,eie,yie,Lie,Lee,Dee,Nee,qZ,Pie,HZ,zZ,Cte],icons:{selectOpen:"small-down",smallDown:"small-down",colorPicker:"color-picker",smallUp:"small-up",checkboxChecked:"small-up",checkboxIndeterminate:"checkbox-indeterminate",checkboxUnchecked:"checkbox-unchecked",radioButtonOn:"radio-button-on",radioButtonOff:"radio-button-off",smallLeft:"small-left",smallRight:"small-right"},apiFunctions:{getGridId:MJ,destroy:IJ,isDestroyed:AJ,getGridOption:OJ,setGridOption:LJ,updateGridOptions:d8,isModuleRegistered:NJ},dependsOn:[LZ,AQ,VQ,G8,fte,rZ,gte,Cie,Aie,vte,Zte,oie,aie,bte,WZ,NZ,Iie,lZ,die]},W8={AdvancedFilter:1,AiToolkit:1,AllEnterprise:1,BatchEdit:1,CellSelection:1,Clipboard:1,ColumnMenu:1,ColumnsToolPanel:1,ContextMenu:1,ExcelExport:1,FiltersToolPanel:1,Find:1,GridCharts:1,IntegratedCharts:1,GroupFilter:1,MasterDetail:1,Menu:1,MultiFilter:1,NewFiltersToolPanel:1,Pivot:1,RangeSelection:1,RichSelect:1,RowNumbers:1,RowGrouping:1,RowGroupingPanel:1,ServerSideRowModelApi:1,ServerSideRowModel:1,SetFilter:1,SideBar:1,Sparklines:1,StatusBar:1,TreeData:1,ViewportRowModel:1},Ly=["TextFilter","NumberFilter","DateFilter","SetFilter","MultiFilter","GroupFilter","CustomFilter"],Bie={EditCore:["TextEditor","NumberEditor","DateEditor","CheckboxEditor","LargeTextEditor","SelectEditor","RichSelect","CustomEditor"],CheckboxCellRenderer:["AllCommunity"],ClientSideRowModelHierarchy:["RowGrouping","Pivot","TreeData"],ColumnFilter:Ly,ColumnGroupHeaderComp:["AllCommunity"],ColumnGroup:["AllCommunity"],ColumnHeaderComp:["AllCommunity"],ColumnMove:["AllCommunity"],ColumnResize:["AllCommunity"],CommunityCore:["AllCommunity"],CsrmSsrmSharedApi:["ClientSideRowModelApi","ServerSideRowModelApi"],RowModelSharedApi:["ClientSideRowModelApi","ServerSideRowModelApi"],EnterpriseCore:["AllEnterprise"],FilterCore:[...Ly,"QuickFilter","ExternalFilter","AdvancedFilter"],GroupCellRenderer:["RowGrouping","Pivot","TreeData","MasterDetail","ServerSideRowModel"],KeyboardNavigation:["AllCommunity"],LoadingCellRenderer:["ServerSideRowModel"],MenuCore:["ColumnMenu","ContextMenu"],MenuItem:["ColumnMenu","ContextMenu","MultiFilter","IntegratedCharts","ColumnsToolPanel"],Overlay:["AllCommunity"],PinnedColumn:["AllCommunity"],SharedAggregation:["RowGrouping","Pivot","TreeData","ServerSideRowModel"],SharedDragAndDrop:["AllCommunity"],SharedMasterDetail:["MasterDetail","ServerSideRowModel"],SharedMenu:[...Ly,"ColumnMenu","ContextMenu"],SharedPivot:["Pivot","ServerSideRowModel"],SharedRowGrouping:["RowGrouping","ServerSideRowModel"],SharedRowSelection:["RowSelection","ServerSideRowModel"],SkeletonCellRenderer:["ServerSideRowModel"],Sort:["AllCommunity"],SsrmInfiniteSharedApi:["InfiniteRowModel","ServerSideRowModelApi"],SharedTreeData:["TreeData","ServerSideRowModel"]},Hie={InfiniteRowModel:"infinite",ClientSideRowModelApi:"clientSide",ClientSideRowModel:"clientSide",ServerSideRowModelApi:"serverSide",ServerSideRowModel:"serverSide",ViewportRowModel:"viewport"};function zie(t,e){let i=[];for(let n of Array.isArray(t)?t:[t]){let r=Bie[n];if(r)for(let o of r){let s=Hie[o];(!s||s===e)&&i.push(o)}else i.push(n)}return i}var U8=()=>`No AG Grid modules are registered! It is recommended to start with all Community features via the AllCommunityModule:
                    
    import { ModuleRegistry, AllCommunityModule } from 'ag-grid-community';
    
    ModuleRegistry.registerModules([ AllCommunityModule ]);
    `,Vie=t=>{let e=t.map(n=>`import { ${ih(n)} } from '${W8[n]?"ag-grid-enterprise":"ag-grid-community"}';`);return t.some(n=>n==="IntegratedCharts"||n==="Sparklines")&&e.push("import { AgChartsEnterpriseModule } from 'ag-charts-enterprise';"),`import { ModuleRegistry } from 'ag-grid-community'; 
${e.join(` 
`)} 

ModuleRegistry.registerModules([ ${t.map(n=>ih(n,!0)).join(", ")} ]); 

For more info see: ${nc}/modules/`};function ih(t,e=!1){return e&&(t==="IntegratedCharts"||t==="Sparklines")?`${t}Module.with(AgChartsEnterpriseModule)`:`${t}Module`}function Gie(t,e){let i=e.filter(o=>o==="IntegratedCharts"||o==="Sparklines"),n="";return!globalThis?.agCharts&&i.length>0?n=`Unable to use ${t} as either the ag-charts-community or ag-charts-enterprise script needs to be included alongside ag-grid-enterprise.
`:e.some(o=>W8[o])&&(n=n+`Unable to use ${t} as that requires the ag-grid-enterprise script to be included.
`),n}function j8({moduleName:t,rowModelType:e}){return`To use the ${t}Module you must set the gridOption "rowModelType='${e}'"`}var tD=({reasonOrId:t,moduleName:e,gridScoped:i,gridId:n,rowModelType:r,additionalText:o,isUmd:s})=>{let a=zie(e,r),l=typeof t=="string"?t:qie[t];if(s)return Gie(l,a);let c=a.filter(h=>h==="IntegratedCharts"||h==="Sparklines"),d=c.length>0?`${c.map(h=>ih(h)).join()} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.`:"";return`${`Unable to use ${l} as ${a.length>1?"one of "+a.map(h=>ih(h)).join(", "):ih(a[0])} is not registered${i?" for gridId: "+n:""}. ${d} Check if you have registered the module:
`}
${Vie(a)}`+(o?` 

${o}`:"")},iD=t=>`${t} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.

import { AgChartsEnterpriseModule } from 'ag-charts-enterprise';
import { ModuleRegistry } from 'ag-grid-community';
import { ${t} } from 'ag-grid-enterprise';
    
ModuleRegistry.registerModules([${t}.with(AgChartsEnterpriseModule)]);
    `,Wie=t=>`AG Grid: Unable to use the Clipboard API (navigator.clipboard.${t}()). The reason why it could not be used has been logged in the previous line. For this reason the grid has defaulted to using a workaround which doesn't perform as well. Either fix why Clipboard API is blocked, OR stop this message from appearing by setting grid property suppressClipboardApi=true (which will default the grid to using the workaround rather than the API.`,Uie={1:()=>"`rowData` must be an array",2:({nodeId:t})=>`Duplicate node id '${t}' detected from getRowId callback, this could cause issues in your grid.`,3:()=>"Calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.",4:({id:t})=>`Could not find row id=${t}, data item was not found for this id`,5:({data:t})=>["Could not find data item as object was not found.",t," Consider using getRowId to help the Grid find matching row data"],6:()=>"'groupHideOpenParents' only works when specifying specific columns for 'colDef.showRowGroup'",7:()=>"Pivoting is not supported with aligned grids as it may produce different columns in each grid.",8:({key:t})=>`Unknown key for navigation ${t}`,9:({variable:t})=>`No value for ${t?.cssName}. This usually means that the grid has been initialised before styles have been loaded. The default value of ${t?.defaultValue} will be used and updated when styles load.`,10:({eventType:t})=>`As of v33, the '${t}' event is deprecated. Use the global 'modelUpdated' event to determine when row children have changed.`,11:()=>"No gridOptions provided to createGrid",12:({colKey:t})=>["column ",t," not found"],13:()=>"Could not find rowIndex, this means tasks are being executed on a rowNode that has been removed from the grid.",14:({groupPrefix:t})=>`Row IDs cannot start with ${t}, this is a reserved prefix for AG Grid's row grouping feature.`,15:({expression:t})=>["value should be either a string or a function",t],16:({expression:t,params:e,e:i})=>["Processing of the expression failed","Expression = ",t,"Params = ",e,"Exception = ",i],17:()=>"you need either field or valueSetter set on colDef for editing to work",18:()=>"alignedGrids contains an undefined option.",19:()=>"alignedGrids - No api found on the linked grid.",20:()=>`You may want to configure via a callback to avoid setup race conditions:
                     "alignedGrids: () => [linkedGrid]"`,21:()=>"pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.",22:({key:t})=>`${t} is an initial property and cannot be updated.`,23:()=>"The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead.",24:()=>"row height must be a number if not using standard row model",25:({id:t})=>["The getRowId callback must return a string. The ID ",t," is being cast to a string."],26:({fnName:t,preDestroyLink:e})=>`Grid API function ${t}() cannot be called as the grid has been destroyed.
 Either clear local references to the grid api, when it is destroyed, or check gridApi.isDestroyed() to avoid calling methods against a destroyed grid.
 To run logic when the grid is about to be destroyed use the gridPreDestroy event. See: ${e}`,27:({fnName:t,module:e})=>`API function '${t}' not registered to module '${e}'`,28:()=>"setRowCount cannot be used while using row grouping.",29:()=>"tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?",30:({toIndex:t})=>["tried to insert columns in invalid location, toIndex = ",t,"remember that you should not count the moving columns when calculating the new index"],31:()=>"infinite loop in resizeColumnSets",32:()=>"applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state.",33:()=>"stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON.",34:({key:t})=>`the column type '${t}' is a default column type and cannot be overridden.`,35:()=>"Column type definitions 'columnTypes' with a 'type' attribute are not supported because a column type cannot refer to another column type. Only column definitions 'columnDefs' can use the 'type' attribute to refer to a column type.",36:({t})=>"colDef.type '"+t+"' does not correspond to defined gridOptions.columnTypes",37:()=>"Changing the column pinning status is not allowed with domLayout='print'",38:({iconName:t})=>`provided icon '${t}' needs to be a string or a function`,39:()=>"Applying column order broke a group where columns should be married together. Applying new order has been discarded.",40:({e:t,method:e})=>`${t}
${Wie(e)}`,41:()=>"Browser did not allow document.execCommand('copy'). Ensure 'api.copySelectedRowsToClipboard() is invoked via a user event, i.e. button click, otherwise the browser will prevent it for security reasons.",42:()=>"Browser does not support document.execCommand('copy') for clipboard operations",43:({iconName:t})=>`As of v33, icon '${t}' is deprecated. Use the icon CSS name instead.`,44:()=>'Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.',45:({parentCellDataType:t})=>`The data type definition ${t} does not exist.`,46:()=>'The "baseDataType" property of a data type definition must match that of its parent.',47:({cellDataType:t})=>`Missing data type definition - "${t}"`,48:({property:t})=>`Cell data type is "object" but no Value ${t} has been provided. Please either provide an object data type definition with a Value ${t}, or set "colDef.value${t}"`,49:({methodName:t})=>`Framework component is missing the method ${t}()`,50:({compName:t})=>`Could not find component ${t}, did you forget to configure this component?`,51:()=>"Export cancelled. Export is not allowed as per your configuration.",52:()=>"There is no `window` associated with the current `document`",53:()=>"unknown value type during csv conversion",54:()=>"Could not find document body, it is needed for drag and drop and context menu.",55:()=>"addRowDropZone - A container target needs to be provided",56:()=>"addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.",57:()=>"unable to show popup filter, filter instantiation failed",58:()=>"no values found for select cellEditor",59:()=>"cannot select pinned rows",60:()=>"cannot select node until it has finished loading",61:()=>"since version v32.2.0, rowNode.isFullWidthCell() has been deprecated. Instead check `rowNode.detail` followed by the user provided `isFullWidthRow` grid option.",62:({colId:t})=>`setFilterModel() - no column found for colId: ${t}`,63:({colId:t})=>`setFilterModel() - unable to fully apply model, filtering disabled for colId: ${t}`,64:({colId:t})=>`setFilterModel() - unable to fully apply model, unable to create filter for colId: ${t}`,65:()=>"filter missing setModel method, which is needed for setFilterModel",66:()=>"filter API missing getModel method, which is needed for getFilterModel",67:()=>"Filter is missing isFilterActive() method",68:()=>"Column Filter API methods have been disabled as Advanced Filters are enabled.",69:({guiFromFilter:t})=>`getGui method from filter returned ${t}; it should be a DOM element.`,70:({newFilter:t})=>`Grid option quickFilterText only supports string inputs, received: ${typeof t}`,71:()=>"debounceMs is ignored when apply button is present",72:({keys:t})=>["ignoring FilterOptionDef as it doesn't contain one of ",t],73:()=>"invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'",74:()=>"no filter options for filter",75:()=>"Unknown button type specified",76:({filterModelType:t})=>['Unexpected type of filter "',t,'", it looks like the filter was configured with incorrect Filter Options'],77:()=>"Filter model is missing 'conditions'",78:()=>'Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.',79:()=>'"filterParams.maxNumConditions" must be greater than or equal to zero.',80:()=>'"filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.',81:()=>'"filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".',82:({param:t})=>`DateFilter ${t} is not a number`,83:()=>"DateFilter minValidYear should be <= maxValidYear",84:()=>"DateFilter minValidDate should be <= maxValidDate",85:()=>"DateFilter should not have both minValidDate and minValidYear parameters set at the same time! minValidYear will be ignored.",86:()=>"DateFilter should not have both maxValidDate and maxValidYear parameters set at the same time! maxValidYear will be ignored.",87:()=>"DateFilter parameter minValidDate should always be lower than or equal to parameter maxValidDate.",88:({index:t})=>`Invalid row index for ensureIndexVisible: ${t}`,89:()=>"A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)",90:()=>"datasource is missing getRows method",91:()=>"Filter is missing method doesFilterPass",92:()=>"AnimationFrameService called but animation frames are off",93:()=>"cannot add multiple ranges when `cellSelection.suppressMultiRanges = true`",94:({paginationPageSizeOption:t,pageSizeSet:e,pageSizesSet:i,pageSizeOptions:n})=>`'paginationPageSize=${t}'${e?"":" (default value)"}, but ${t} is not included in${i?"":" the default"} paginationPageSizeSelector=[${n?.join(", ")}].`,95:({paginationPageSizeOption:t,paginationPageSizeSelector:e})=>`Either set '${e}' to an array that includes ${t} or to 'false' to disable the page size selector.`,96:({id:t,data:e})=>["Duplicate ID",t,"found for pinned row with data",e,"When `getRowId` is defined, it must return unique IDs for all pinned rows. Use the `rowPinned` parameter."],97:({colId:t})=>`cellEditor for column ${t} is missing getGui() method`,98:()=>"popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.",99:()=>"Since v32, `api.hideOverlay()` does not hide the loading overlay when `loading=true`. Set `loading=false` instead.",101:({propertyName:t,componentName:e,agGridDefaults:i,jsComps:n})=>{let r=[],o=[...Object.keys(i??[]).filter(a=>!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(a)),...Object.keys(n??[]).filter(a=>!!n[a])],s=eS({inputValue:e,allSuggestions:o,hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;return r.push(`Could not find '${e}' component. It was configured as "${t}: '${e}'" but it wasn't found in the list of registered components.
`),s.length>0&&r.push(`         Did you mean: [${s.slice(0,3)}]?
`),r.push("If using a custom component check it has been registered correctly."),r},102:()=>"selectAll: 'filtered' only works when gridOptions.rowModelType='clientSide'",103:()=>"Invalid selection state. When using client-side row model, the state must conform to `string[]`.",104:({value:t,param:e})=>`Numeric value ${t} passed to ${e} param will be interpreted as ${t} seconds. If this is intentional use "${t}s" to silence this warning.`,105:({e:t})=>["chart rendering failed",t],106:()=>`Theming API and Legacy Themes are both used in the same page. A Theming API theme has been provided to the 'theme' grid option, but the file (ag-grid.css) is also included and will cause styling issues. Remove ag-grid.css from the page. See the migration guide: ${nc}/theming-migration/`,107:({key:t,value:e})=>`Invalid value for theme param ${t} - ${e}`,108:({e:t})=>["chart update failed",t],109:({inputValue:t,allSuggestions:e})=>{let i=eS({inputValue:t,allSuggestions:e,hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;return[`Could not find '${t}' aggregate function. It was configured as "aggFunc: '${t}'" but it wasn't found in the list of registered aggregations.`,i.length>0?`         Did you mean: [${i.slice(0,3)}]?`:"","If using a custom aggregation function check it has been registered correctly."].join(`
`)},110:()=>"groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup",111:()=>"Invalid selection state. When `groupSelects` is enabled, the state must conform to `IServerSideGroupSelectionState`.",113:()=>"Set Filter cannot initialise because you are using a row model that does not contain all rows in the browser. Either use a different filter type, or configure Set Filter such that you provide it with values",114:({component:t})=>`Could not find component with name of ${t}. Is it in Vue.components?`,116:()=>"Invalid selection state. The state must conform to `IServerSideSelectionState`.",117:()=>"selectAll must be of boolean type.",118:()=>"Infinite scrolling must be enabled in order to set the row count.",119:()=>"Unable to instantiate filter",120:()=>"MultiFloatingFilterComp expects MultiFilter as its parent",121:()=>"a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (see AG Grid docs) or b) to toString() on the object to return a key",122:()=>"could not find the document, document is empty",123:()=>"Advanced Filter is only supported with the Client-Side Row Model or Server-Side Row Model.",124:()=>"No active charts to update.",125:({chartId:t})=>`Unable to update chart. No active chart found with ID: ${t}.`,126:()=>"unable to restore chart as no chart model is provided",127:({allRange:t})=>`unable to create chart as ${t?"there are no columns in the grid":"no range is selected"}.`,128:({feature:t})=>`${t} is only available if using 'multiRow' selection mode.`,129:({feature:t,rowModel:e})=>`${t} is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ${e}.`,130:()=>'cannot multi select unless selection mode is "multiRow"',132:()=>"Row selection features are not available unless `rowSelection` is enabled.",133:({iconName:t})=>`icon '${t}' function should return back a string or a dom object`,134:({iconName:t})=>`Did not find icon '${t}'`,135:()=>"Data type of the new value does not match the cell data type of the column",136:()=>"Unable to update chart as the 'type' is missing. It must be either 'rangeChartUpdate', 'pivotChartUpdate', or 'crossFilterChartUpdate'.",137:({type:t,currentChartType:e})=>`Unable to update chart as a '${t}' update type is not permitted on a ${e}.`,138:({chartType:t})=>`invalid chart type supplied: ${t}`,139:({customThemeName:t})=>`a custom chart theme with the name ${t} has been supplied but not added to the 'chartThemes' list`,140:({name:t})=>`no stock theme exists with the name '${t}' and no custom chart theme with that name was supplied to 'customChartThemes'`,141:()=>"cross filtering with row grouping is not supported.",142:()=>"cross filtering is only supported in the client side row model.",143:({panel:t})=>`'${t}' is not a valid Chart Tool Panel name`,144:({type:t})=>`Invalid charts data panel group name supplied: '${t}'`,145:({group:t})=>`As of v32, only one charts customize panel group can be expanded at a time. '${t}' will not be expanded.`,146:({comp:t})=>`Unable to instantiate component '${t}' as its module hasn't been loaded. Add 'ValidationModule' to see which module is required.`,147:({group:t})=>`Invalid charts customize panel group name supplied: '${t}'`,148:({group:t})=>`invalid chartGroupsDef config '${t}'`,149:({group:t,chartType:e})=>`invalid chartGroupsDef config '${t}.${e}'`,150:()=>"'seriesChartTypes' are required when the 'customCombo' chart type is specified.",151:({chartType:t})=>`invalid chartType '${t}' supplied in 'seriesChartTypes', converting to 'line' instead.`,152:({colId:t})=>`no 'seriesChartType' found for colId = '${t}', defaulting to 'line'.`,153:({chartDataType:t})=>`unexpected chartDataType value '${t}' supplied, instead use 'category', 'series' or 'excluded'`,154:({colId:t})=>`cross filtering requires a 'agSetColumnFilter' or 'agMultiColumnFilter' to be defined on the column with id: ${t}`,155:({option:t})=>`'${t}' is not a valid Chart Toolbar Option`,156:({panel:t})=>`Invalid panel in chartToolPanelsDef.panels: '${t}'`,157:({unrecognisedGroupIds:t})=>["unable to find group(s) for supplied groupIds:",t],158:()=>"can not expand a column item that does not represent a column group header",159:()=>"Invalid params supplied to createExcelFileForExcel() - `ExcelExportParams.data` is empty.",160:()=>"Export cancelled. Export is not allowed as per your configuration.",161:()=>"The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'",162:({id:t,dataType:e})=>`Unrecognized data type for excel export [${t}.dataType=${e}]`,163:({featureName:t})=>`Excel table export does not work with ${t}. The exported Excel file will not contain any Excel tables.
 Please turn off ${t} to enable Excel table exports.`,164:()=>"Unable to add data table to Excel sheet: A table already exists.",165:()=>"Unable to add data table to Excel sheet: Missing required parameters.",166:({unrecognisedGroupIds:t})=>["unable to find groups for these supplied groupIds:",t],167:({unrecognisedColIds:t})=>["unable to find columns for these supplied colIds:",t],168:()=>"detailCellRendererParams.template should be function or string",169:()=>'Reference to eDetailGrid was missing from the details template. Please add data-ref="eDetailGrid" to the template.',170:({providedStrategy:t})=>`invalid cellRendererParams.refreshStrategy = ${t} supplied, defaulting to refreshStrategy = 'rows'.`,171:()=>"could not find detail grid options for master detail, please set gridOptions.detailCellRendererParams.detailGridOptions",172:()=>"could not find getDetailRowData for master / detail, please set gridOptions.detailCellRendererParams.getDetailRowData",173:({group:t})=>`invalid chartGroupsDef config '${t}'`,174:({group:t,chartType:e})=>`invalid chartGroupsDef config '${t}.${e}'`,175:({menuTabName:t,itemsToConsider:e})=>[`Trying to render an invalid menu item '${t}'. Check that your 'menuTabs' contains one of `,e],176:({key:t})=>`unknown menu item type ${t}`,177:()=>"valid values for cellSelection.handle.direction are 'x', 'y' and 'xy'. Default to 'xy'.",178:({colId:t})=>`column ${t} is not visible`,179:()=>"totalValueGetter should be either a function or a string (expression)",180:()=>"agRichSelectCellEditor requires cellEditorParams.values to be set",181:()=>"agRichSelectCellEditor cannot have `multiSelect` and `allowTyping` set to `true`. AllowTyping has been turned off.",182:()=>'you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data',183:()=>"Group Column Filter only works on group columns. Please use a different filter.",184:({parentGroupData:t,childNodeData:e})=>["duplicate group keys for row data, keys should be unique",[t,e]],185:({data:t})=>["getDataPath() should not return an empty path",[t]],186:({rowId:t,rowData:e,duplicateRowsData:i})=>["duplicate group keys for row data, keys should be unique",t,e,...i??[]],187:({rowId:t,firstData:e,secondData:i})=>[`Duplicate node id ${t}. Row IDs are provided via the getRowId() callback. Please modify the getRowId() callback code to provide unique row id values.`,"first instance",e,"second instance",i],188:t=>`getRowId callback must be provided for Server Side Row Model ${t?.feature||"selection"} to work correctly.`,189:({startRow:t})=>`invalid value ${t} for startRow, the value should be >= 0`,190:({rowGroupId:t,data:e})=>["null and undefined values are not allowed for server side row model keys",t?`column = ${t}`:"","data is ",e],194:({method:t})=>`calling gridApi.${t}() is only possible when using rowModelType=\`clientSide\`.`,195:({justCurrentPage:t})=>`selecting just ${t?"current page":"filtered"} only works when gridOptions.rowModelType='clientSide'`,196:({key:t})=>`Provided ids must be of string type. Invalid id provided: ${t}`,197:()=>"`toggledNodes` must be an array of string ids.",199:()=>"getSelectedNodes and getSelectedRows functions cannot be used with select all functionality with the server-side row model. Use `api.getServerSideSelectionState()` instead.",200:tD,201:({rowModelType:t})=>`Could not find row model for rowModelType = ${t}`,202:()=>"`getSelectedNodes` and `getSelectedRows` functions cannot be used with `groupSelectsChildren` and the server-side row model. Use `api.getServerSideSelectionState()` instead.",203:()=>"Server Side Row Model does not support Dynamic Row Height and Cache Purging. Either a) remove getRowHeight() callback or b) remove maxBlocksInCache property. Purging has been disabled.",204:()=>"Server Side Row Model does not support Auto Row Height and Cache Purging. Either a) remove colDef.autoHeight or b) remove maxBlocksInCache property. Purging has been disabled.",205:({duplicateIdText:t})=>`Unable to display rows as duplicate row ids (${t}) were returned by the getRowId callback. Please modify the getRowId callback to provide unique ids.`,206:()=>"getRowId callback must be implemented for transactions to work. Transaction was ignored.",207:()=>'The Set Filter Parameter "defaultToNothingSelected" value was ignored because it does not work when "excelMode" is used.',208:()=>"Set Filter Value Formatter must return string values. Please ensure the Set Filter Value Formatter returns string values for complex objects.",209:()=>`Set Filter Key Creator is returning null for provided values and provided values are primitives. Please provide complex objects. See ${nc}/filter-set-filter-list/#filter-value-types`,210:()=>"Set Filter has a Key Creator, but provided values are primitives. Did you mean to provide complex objects?",211:()=>"property treeList=true for Set Filter params, but you did not provide a treeListPathGetter or values of type Date.",212:()=>"please review all your toolPanel components, it seems like at least one of them doesn't have an id",213:()=>"Advanced Filter does not work with Filters Tool Panel. Filters Tool Panel has been disabled.",214:({key:t})=>`unable to lookup Tool Panel as invalid key supplied: ${t}`,215:({key:t,defaultByKey:e})=>`the key ${t} is not a valid key for specifying a tool panel, valid keys are: ${Object.keys(e??{}).join(",")}`,216:({name:t})=>`Missing component for '${t}'`,217:({invalidColIds:t})=>["unable to find grid columns for the supplied colDef(s):",t],218:({property:t,defaultOffset:e})=>`${t} must be a number, the value you provided is not a valid number. Using the default of ${e}px.`,219:({property:t})=>`Property ${t} does not exist on the target object.`,220:({lineDash:t})=>`'${t}' is not a valid 'lineDash' option.`,221:()=>"agAggregationComponent should only be used with the client and server side row model.",222:()=>"agFilteredRowCountComponent should only be used with the client side row model.",223:()=>"agSelectedRowCountComponent should only be used with the client and server side row model.",224:()=>"agTotalAndFilteredRowCountComponent should only be used with the client side row model.",225:()=>"agTotalRowCountComponent should only be used with the client side row model.",226:()=>"viewport is missing init method.",227:()=>"menu item icon must be DOM node or string",228:({menuItemOrString:t})=>`unrecognised menu item ${t}`,229:({index:t})=>["invalid row index for ensureIndexVisible: ",t],230:()=>"detailCellRendererParams.template is not supported by AG Grid React. To change the template, provide a Custom Detail Cell Renderer. See https://www.ag-grid.com/react-data-grid/master-detail-custom-detail/",231:()=>"As of v32, using custom components with `reactiveCustomComponents = false` is deprecated.",232:()=>"Using both rowData and v-model. rowData will be ignored.",233:({methodName:t})=>`Framework component is missing the method ${t}()`,234:()=>'Group Column Filter does not work with the colDef property "field". This property will be ignored.',235:()=>'Group Column Filter does not work with the colDef property "filterValueGetter". This property will be ignored.',236:()=>'Group Column Filter does not work with the colDef property "filterParams". This property will be ignored.',237:()=>"Group Column Filter does not work with Tree Data enabled. Please disable Tree Data, or use a different filter.",238:()=>"setRowCount can only accept a positive row count.",239:()=>'Theming API and CSS File Themes are both used in the same page. In v33 we released the Theming API as the new default method of styling the grid. See the migration docs https://www.ag-grid.com/react-data-grid/theming-migration/. Because no value was provided to the `theme` grid option it defaulted to themeQuartz. But the file (ag-grid.css) is also included and will cause styling issues. Either pass the string "legacy" to the theme grid option to use v32 style themes, or remove ag-grid.css from the page to use Theming API.',240:({theme:t})=>`theme grid option must be a Theming API theme object or the string "legacy", received: ${t}`,243:()=>"Failed to deserialize state - each provided state object must be an object.",244:()=>"Failed to deserialize state - `selectAllChildren` must be a boolean value or undefined.",245:()=>"Failed to deserialize state - `toggledNodes` must be an array.",246:()=>"Failed to deserialize state - Every `toggledNode` requires an associated string id.",247:()=>`Row selection state could not be parsed due to invalid data. Ensure all child state has toggledNodes or does not conform with the parent rule. 
Please rebuild the selection state and reapply it.`,248:()=>"SetFloatingFilter expects SetFilter as its parent",249:()=>"Must supply a Value Formatter in Set Filter params when using a Key Creator",250:()=>"Must supply a Key Creator in Set Filter params when `treeList = true` on a group column, and Tree Data or Row Grouping is enabled.",251:({chartType:t})=>`AG Grid: Unable to create chart as an invalid chartType = '${t}' was supplied.`,252:()=>`cannot get grid to draw rows when it is in the middle of drawing rows. 
Your code probably called a grid API method while the grid was in the render stage. 
To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). 
To see what part of your code that caused the refresh check this stacktrace.`,253:({version:t})=>["Illegal version string: ",t],254:()=>"Cannot create chart: no chart themes available.",255:({point:t})=>`Lone surrogate U+${t?.toString(16).toUpperCase()} is not a scalar value`,256:()=>"Unable to initialise. See validation error, or load ValidationModule if missing.",257:()=>iD("IntegratedChartsModule"),258:()=>iD("SparklinesModule"),259:({part:t})=>`the argument to theme.withPart must be a Theming API part object, received: ${t}`,260:({propName:t,compName:e,gridScoped:i,gridId:n,rowModelType:r})=>tD({reasonOrId:`AG Grid '${t}' component: ${e}`,moduleName:cc[e],gridId:n,gridScoped:i,rowModelType:r}),261:()=>"As of v33, `column.isHovered()` is deprecated. Use `api.isColumnHovered(column)` instead.",262:()=>'As of v33, icon key "smallDown" is deprecated. Use "advancedFilterBuilderSelect" for Advanced Filter Builder dropdown, "selectOpen" for Select cell editor and dropdowns (e.g. Integrated Charts menu), "richSelectOpen" for Rich Select cell editor.',263:()=>'As of v33, icon key "smallLeft" is deprecated. Use "panelDelimiterRtl" for Row Group Panel / Pivot Panel, "subMenuOpenRtl" for sub-menus.',264:()=>'As of v33, icon key "smallRight" is deprecated. Use "panelDelimiter" for Row Group Panel / Pivot Panel, "subMenuOpen" for sub-menus.',265:({colId:t})=>`Unable to infer chart data type for column '${t}' if first data entry is null. Please specify "chartDataType", or a "cellDataType" in the column definition. For more information, see ${nc}/integrated-charts-range-chart#coldefchartdatatype .`,266:()=>'As of v33.1, using "keyCreator" with the Rich Select Editor has been deprecated. It now requires the "formatValue" callback to convert complex data to strings.',267:()=>"Detail grids can not use a different theme to the master grid, the `theme` detail grid option will be ignored.",268:()=>"Transactions aren't supported with tree data when using treeDataChildrenField",269:()=>"When `masterSelects: 'detail'`, detail grids must be configured with multi-row selection",270:({id:t,parentId:e})=>`Cycle detected for row with id='${t}' and parent id='${e}'. Resetting the parent for row with id='${t}' and showing it as a root-level node.`,271:({id:t,parentId:e})=>`Parent row not found for row with id='${t}' and parent id='${e}'. Showing row with id='${t}' as a root-level node.`,272:()=>U8(),273:({providedId:t,usedId:e})=>`Provided column id '${t}' was already in use, ensure all column and group ids are unique. Using '${e}' instead.`,274:({prop:t})=>{let e=`Since v33, ${t} has been deprecated.`;switch(t){case"maxComponentCreationTimeMs":e+=" This property is no longer required and so will be removed in a future version.";break;case"setGridApi":e+=" This method is not called by AG Grid. To access the GridApi see: https://ag-grid.com/react-data-grid/grid-interface/#grid-api ";break;case"children":e+=" For multiple versions AgGridReact does not support children.";break}return e},275:j8,276:()=>"Row Numbers Row Resizer cannot be used when Grid Columns have `autoHeight` enabled.",277:({colId:t})=>`'enableFilterHandlers' is set to true, but column '${t}' does not have 'filter.doesFilterPass' or 'filter.handler' set.`,278:({colId:t})=>`Unable to create filter handler for column '${t}'`,279:t=>{},280:({colId:t})=>`'name' must be provided for custom filter components for column '${t}`,281:({colId:t})=>`Filter for column '${t}' does not have 'filterParams.buttons', but the new Filters Tool Panel has buttons configured. Either configure buttons for the filter, or disable buttons on the Filters Tool Panel.`,282:()=>"New filter tool panel requires `enableFilterHandlers: true`.",283:()=>"As of v34, use the same method on the filter handler (`api.getColumnFilterHandler(colKey)`) instead.",284:()=>"As of v34, filters are active when they have a model. Use `api.getColumnFilterModel()` instead.",285:()=>"As of v34, use (`api.getColumnFilterModel()`) instead.",286:()=>"As of v34, use (`api.setColumnFilterModel()`) instead.",287:()=>"`api.doFilterAction()` requires `enableFilterHandlers = true",288:()=>"`api.getColumnFilterModel(key, true)` requires `enableFilterHandlers = true",289:({rowModelType:t})=>`Row Model '${t}' is not supported with Batch Editing`,290:({rowIndex:t,rowPinned:e})=>`Row with index '${t}' and pinned state '${e}' not found`,291:()=>"License Key being set multiple times with different values. This can result in an incorrect license key being used,",292:({colId:t})=>`The Multi Filter for column '${t}' has buttons configured against the child filters. When 'enableFilterHandlers=true', buttons must instead be provided against the parent Multi Filter params. The child filter buttons will be ignored.`};function jie(t,e){let i=Uie[t];if(!i)return[`Missing error text for error id ${t}!`];let n=i(e),o=`
See ${WD(t,e)}`;return Array.isArray(n)?n.concat(o):[n,o]}var qie={1:"Charting Aggregation",2:"pivotResultFields",3:"setTooltip"},nD=new WeakMap,rD=new WeakMap;function q8(t,e,i){if(!e)return at(11),{};let n=i,r;if(!n?.setThemeOnGridDiv){let s=Nt({tag:"div"});s.style.height="100%",t.appendChild(s),t=s,r=()=>t.remove()}return new Kie().create(t,e,s=>{let a=new FJ(t);s.createBean(a)},void 0,i,r)}var $ie=1,Kie=class{create(t,e,i,n,r,o){let s=TS.applyGlobalGridOptions(e),a=s.gridId??String($ie++),l=this.getRegisteredModules(r,a,s.rowModelType),c=this.createBeansList(s.rowModelType,l,a),d=this.createProvidedBeans(t,s,r);if(!c)return;let h={providedBeanInstances:d,beanClasses:c,id:a,beanInitComparator:hJ,beanDestroyComparator:pJ,derivedBeans:[dJ],destroyCallback:()=>{rD.delete(f),nD.delete(t),mq(a),o?.()}},p=new UK(h);this.registerModuleFeatures(p,l),i(p),p.getBean("syncSvc").start(),n?.(p);let f=p.getBean("gridApi");return nD.set(t,f),rD.set(f,t),f}getRegisteredModules(t,e,i){return ch(Nie,void 0,!0),t?.modules?.forEach(n=>ch(n,e)),vq(e,oD(i))}registerModuleFeatures(t,e){let i=t.getBean("registry"),n=t.getBean("apiFunctionSvc");for(let r of e){i.registerModule(r);let o=r.apiFunctions;if(o){let s=Object.keys(o);for(let a of s)n?.addFunction(a,o[a])}}}createProvidedBeans(t,e,i){let n=i?i.frameworkOverrides:null;wt(n)&&(n=new e2);let r={gridOptions:e,eGridDiv:t,eRootDiv:t,globalListener:i?i.globalListener:null,globalSyncListener:i?i.globalSyncListener:null,frameworkOverrides:n};return i?.providedBeanInstances&&Object.assign(r,i.providedBeanInstances),r}createBeansList(t,e,i){let n={clientSide:"ClientSideRowModel",infinite:"InfiniteRowModel",serverSide:"ServerSideRowModel",viewport:"ViewportRowModel"},r=oD(t),o=n[r];if(!o){qu(201,{rowModelType:r},`Unknown rowModelType ${r}.`);return}if(!wq()){qu(272,void 0,U8());return}if(!t){let a=Object.entries(n).filter(([l,c])=>Uy(c,i,l));if(a.length==1){let[l,c]=a[0];if(l!==r){let d={moduleName:c,rowModelType:l};qu(275,d,j8(d));return}}}if(!Uy(o,i,r)){qu(200,{reasonOrId:`rowModelType = '${r}'`,moduleName:o,gridScoped:DS(),gridId:i,rowModelType:r},`Missing module ${o}Module for rowModelType ${r}.`);return}let s=new Set;for(let a of e)for(let l of a.beans??[])s.add(l);return Array.from(s)}};function oD(t){return t??"clientSide"}function Ps(t){let e=t.rowModel;return e.getType()==="clientSide"?e:void 0}function qm(t){let e=t.rowModel;return e.getType()==="infinite"?e:void 0}function Yie(t){let e=t.rowModel;return e.getType()==="serverSide"?e:void 0}var Xie=class extends H{constructor(){super(...arguments),this.beanName="localeSvc"}getLocaleTextFunc(){let t=this.gos,e=t.getCallback("getLocaleText");return e?iq(e):nq(t.get("localeText"))}};function Jie(t,e=!1){let i=[],n=[],r=[],o=[],s=[],a=[],l=[],c=[],d=[],u=0;for(let h=0;h<t.length;h++){let{colId:p,sort:f,sortIndex:g,rowGroup:m,rowGroupIndex:v,aggFunc:C,pivot:b,pivotIndex:S,pinned:x,hide:E,width:P,flex:L}=t[h];d.push(p),f&&(i[g??u++]={colId:p,sort:f}),m&&(n[v??0]=p),typeof C=="string"&&r.push({colId:p,aggFunc:C}),b&&(o[S??0]=p),x&&(x==="right"?a:s).push(p),E&&l.push(p),(L!=null||P)&&c.push({colId:p,flex:L??void 0,width:P})}return{sort:i.length?{sortModel:Ny(i)}:void 0,rowGroup:n.length?{groupColIds:Ny(n)}:void 0,aggregation:r.length?{aggregationModel:r}:void 0,pivot:o.length||e?{pivotMode:e,pivotColIds:Ny(o)}:void 0,columnPinning:s.length||a.length?{leftColIds:s,rightColIds:a}:void 0,columnVisibility:l.length?{hiddenColIds:l}:void 0,columnSizing:c.length?{columnSizingModel:c}:void 0,columnOrder:d.length?{orderedColIds:d}:void 0}}function Ny(t){return t.filter(e=>e!=null)}function Qie(t){let e=[];for(let{groupId:i,open:n}of t)n&&e.push(i);return e.length?{openColumnGroupIds:e}:void 0}var $8=class{wrap(t,e,i,n){let r=this.createWrapper(t,n);for(let o of e??[])this.createMethod(r,o,!0);for(let o of i??[])this.createMethod(r,o,!1);return r}createMethod(t,e,i){t.addMethod(e,this.createMethodProxy(t,e,i))}createMethodProxy(t,e,i){return function(){return t.hasMethod(e)?t.callMethod(e,arguments):(i&&K(49,{methodName:e}),null)}}};function By(t){return t.get("tooltipShowMode")==="whenTruncated"}function Zie(t,e){if(typeof t!="number")return"";let i=e(),n=i("thousandSeparator",","),r=i("decimalSeparator",".");return t.toString().replace(".",r).replace(/(\d)(?=(\d{3})+(?!\d))/g,`$1${n}`)}var ene=class extends H{getFileName(t){let e=this.getDefaultFileExtension();return t?.length||(t=this.getDefaultFileName()),t.includes(".")?t:`${t}.${e}`}getData(t){let e=this.createSerializingSession(t);return this.beans.gridSerializer.serialize(e,t)}getDefaultFileName(){return`export.${this.getDefaultFileExtension()}`}},tne=class{constructor(t){let{colModel:e,rowGroupColsSvc:i,colNames:n,valueSvc:r,gos:o,processCellCallback:s,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c}=t;this.colModel=e,this.rowGroupColsSvc=i,this.colNames=n,this.valueSvc=r,this.gos=o,this.processCellCallback=s,this.processHeaderCallback=a,this.processGroupHeaderCallback=l,this.processRowGroupCallback=c}prepare(t){}extractHeaderValue(t){return this.getHeaderName(this.processHeaderCallback,t)??""}extractRowCellValue(t,e,i,n,r){let o=e===0&&XD(this.gos,r,this.colModel.isPivotMode());if(this.processRowGroupCallback&&(this.gos.get("treeData")||r.group)&&(t.isRowGroupDisplayed(r.rowGroupColumn?.getColId()??"")||o))return{value:this.processRowGroupCallback(Ee(this.gos,{column:t,node:r}))??""};if(this.processCellCallback)return{value:this.processCellCallback(Ee(this.gos,{accumulatedRowIndex:i,column:t,node:r,value:this.valueSvc.getValueForDisplay(t,r,void 0,void 0).value,type:n,parseValue:h=>this.valueSvc.parseValue(t,r,h,this.valueSvc.getValue(t,r,void 0)),formatValue:h=>this.valueSvc.formatValue(t,r,h)??h}))??""};let s=this.gos.get("treeData"),a=this.valueSvc,l=r.level===-1&&r.footer,c=t.colDef.showRowGroup===!0&&(r.group||s);if(!l&&(o||c)){let h="",p=r;for(;p&&p.level!==-1;){let{value:f,valueFormatted:g}=a.getValueForDisplay(o?void 0:t,p,!0,!0);h=` -> ${g??f??""}${h}`,p=p.parent}return{value:h,valueFormatted:h}}let{value:d,valueFormatted:u}=a.getValueForDisplay(t,r,!0,!0);return{value:d??"",valueFormatted:u}}getHeaderName(t,e){return t?t(Ee(this.gos,{column:e})):this.colNames.getDisplayNameForColumn(e,"csv",!0)}};function ine(t,e){let i=document.defaultView||window;if(!i){K(52);return}let n=document.createElement("a"),r=i.URL.createObjectURL(e);n.setAttribute("href",r),n.setAttribute("download",t),n.style.display="none",document.body.appendChild(n),n.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:i})),n.remove(),i.setTimeout(()=>{i.URL.revokeObjectURL(r)},0)}var nne={enableBrowserTooltips:!0,tooltipTrigger:!0,tooltipMouseTrack:!0,tooltipShowMode:!0,tooltipInteraction:!0,defaultColGroupDef:!0,suppressAutoSize:!0,skipHeaderOnAutoSize:!0,autoSizeStrategy:!0,components:!0,stopEditingWhenCellsLoseFocus:!0,undoRedoCellEditing:!0,undoRedoCellEditingLimit:!0,excelStyles:!0,cacheQuickFilter:!0,customChartThemes:!0,chartThemeOverrides:!0,chartToolPanelsDef:!0,loadingCellRendererSelector:!0,localeText:!0,keepDetailRows:!0,keepDetailRowsCount:!0,detailRowHeight:!0,detailRowAutoHeight:!0,tabIndex:!0,valueCache:!0,valueCacheNeverExpires:!0,enableCellExpressions:!0,suppressTouch:!0,suppressBrowserResizeObserver:!0,suppressPropertyNamesCheck:!0,debug:!0,dragAndDropImageComponent:!0,loadingOverlayComponent:!0,suppressLoadingOverlay:!0,noRowsOverlayComponent:!0,paginationPageSizeSelector:!0,paginateChildRows:!0,pivotPanelShow:!0,pivotSuppressAutoColumn:!0,suppressExpandablePivotGroups:!0,aggFuncs:!0,allowShowChangeAfterFilter:!0,ensureDomOrder:!0,enableRtl:!0,suppressColumnVirtualisation:!0,suppressMaxRenderedRowRestriction:!0,suppressRowVirtualisation:!0,rowDragText:!0,groupLockGroupColumns:!0,suppressGroupRowsSticky:!0,rowModelType:!0,cacheOverflowSize:!0,infiniteInitialRowCount:!0,serverSideInitialRowCount:!0,maxBlocksInCache:!0,maxConcurrentDatasourceRequests:!0,blockLoadDebounceMillis:!0,serverSideOnlyRefreshFilteredGroups:!0,serverSidePivotResultFieldSeparator:!0,viewportRowModelPageSize:!0,viewportRowModelBufferSize:!0,debounceVerticalScrollbar:!0,suppressAnimationFrame:!0,suppressPreventDefaultOnMouseWheel:!0,scrollbarWidth:!0,icons:!0,suppressRowTransform:!0,gridId:!0,enableGroupEdit:!0,initialState:!0,processUnpinnedColumns:!0,createChartContainer:!0,getLocaleText:!0,getRowId:!0,reactiveCustomComponents:!0,renderingMode:!0,columnMenu:!0,suppressSetFilterByDefault:!0,getDataPath:!0,enableCellSpan:!0,enableFilterHandlers:!0,filterHandlers:!0},Yi="clientSide",ki="serverSide",$l="infinite",rne={onGroupExpandedOrCollapsed:[Yi],refreshClientSideRowModel:[Yi],isRowDataEmpty:[Yi],forEachLeafNode:[Yi],forEachNodeAfterFilter:[Yi],forEachNodeAfterFilterAndSort:[Yi],resetRowHeights:[Yi,ki],applyTransaction:[Yi],applyTransactionAsync:[Yi],flushAsyncTransactions:[Yi],getBestCostNodeSelection:[Yi],getServerSideSelectionState:[ki],setServerSideSelectionState:[ki],applyServerSideTransaction:[ki],applyServerSideTransactionAsync:[ki],applyServerSideRowData:[ki],retryServerSideLoads:[ki],flushServerSideAsyncTransactions:[ki],refreshServerSide:[ki],getServerSideGroupLevelState:[ki],refreshInfiniteCache:[$l],purgeInfiniteCache:[$l],getInfiniteRowCount:[$l],isLastRowIndexKnown:[$l,ki],expandAll:[Yi,ki],collapseAll:[Yi,ki],onRowHeightChanged:[Yi,ki],setRowCount:[$l,ki],getCacheBlockState:[$l,ki]},one={showLoadingOverlay:{version:"v32",message:'`showLoadingOverlay` is deprecated. Use the grid option "loading"=true instead or setGridOption("loading", true).'},clearRangeSelection:{version:"v32.2",message:"Use `clearCellSelection` instead."},getInfiniteRowCount:{version:"v32.2",old:"getInfiniteRowCount()",new:"getDisplayedRowCount()"},selectAllFiltered:{version:"v33",old:"selectAllFiltered()",new:'selectAll("filtered")'},deselectAllFiltered:{version:"v33",old:"deselectAllFiltered()",new:'deselectAll("filtered")'},selectAllOnCurrentPage:{version:"v33",old:"selectAllOnCurrentPage()",new:'selectAll("currentPage")'},deselectAllOnCurrentPage:{version:"v33",old:"deselectAllOnCurrentPage()",new:'deselectAll("currentPage")'}};function sne(t,e,i){let n=one[t];if(n){let{version:o,new:s,old:a,message:l}=n,c=a??t;return(...d)=>{let u=s?`Please use ${s} instead. `:"";return Qu(`Since ${o} api.${c} is deprecated. ${u}${l??""}`),e.apply(e,d)}}let r=rne[t];return r?(...o)=>{let s=i.rowModel.getType();if(!r.includes(s)){tc(`api.${t} can only be called when gridOptions.rowModelType is ${r.join(" or ")}`);return}return e.apply(e,o)}:e}var ane={detailCellRendererCtrl:"SharedMasterDetail",dndSourceComp:"DragAndDrop",fillHandle:"CellSelection",groupCellRendererCtrl:"GroupCellRenderer",headerFilterCellCtrl:"ColumnFilter",headerGroupCellCtrl:"ColumnGroup",rangeHandle:"CellSelection",tooltipFeature:"Tooltip",highlightTooltipFeature:"Tooltip",tooltipStateManager:"Tooltip",groupStrategy:"RowGrouping",treeGroupStrategy:"TreeData",rowNumberRowResizer:"RowNumbers",singleCell:"EditCore",fullRow:"EditCore",agSetColumnFilterHandler:"SetFilter",agMultiColumnFilterHandler:"MultiFilter",agGroupColumnFilterHandler:"GroupFilter",agNumberColumnFilterHandler:"NumberFilter",agDateColumnFilterHandler:"DateFilter",agTextColumnFilterHandler:"TextFilter"},lne={expanded:1,contracted:1,"tree-closed":1,"tree-open":1,"tree-indeterminate":1,pin:1,"eye-slash":1,arrows:1,left:1,right:1,group:1,aggregation:1,pivot:1,"not-allowed":1,chart:1,cross:1,cancel:1,tick:1,first:1,previous:1,next:1,last:1,linked:1,unlinked:1,"color-picker":1,loading:1,menu:1,"menu-alt":1,filter:1,"filter-add":1,columns:1,maximize:1,minimize:1,copy:1,cut:1,paste:1,grip:1,save:1,csv:1,excel:1,"small-down":1,"small-left":1,"small-right":1,"small-up":1,asc:1,desc:1,none:1,up:1,down:1,plus:1,minus:1,settings:1,"checkbox-checked":1,"checkbox-indeterminate":1,"checkbox-unchecked":1,"radio-button-on":1,"radio-button-off":1,eye:1,"column-arrow":1,"un-pin":1,"pinned-top":1,"pinned-bottom":1,"chevron-up":1,"chevron-down":1,"chevron-left":1,"chevron-right":1,edit:1},cne={chart:"MenuCore",cancel:"EnterpriseCore",first:"Pagination",previous:"Pagination",next:"Pagination",last:"Pagination",linked:"IntegratedCharts",loadingMenuItems:"MenuCore",unlinked:"IntegratedCharts",menu:"ColumnHeaderComp",legacyMenu:"ColumnMenu",filter:"ColumnFilter",filterActive:"ColumnFilter",filterAdd:"NewFiltersToolPanel",filterCardCollapse:"NewFiltersToolPanel",filterCardExpand:"NewFiltersToolPanel",filterCardEditing:"NewFiltersToolPanel",filterTab:"ColumnMenu",filtersToolPanel:"FiltersToolPanel",columns:["MenuCore"],columnsToolPanel:["ColumnsToolPanel"],maximize:"EnterpriseCore",minimize:"EnterpriseCore",save:"MenuCore",columnGroupOpened:"ColumnGroupHeaderComp",columnGroupClosed:"ColumnGroupHeaderComp",accordionOpen:"EnterpriseCore",accordionClosed:"EnterpriseCore",accordionIndeterminate:"EnterpriseCore",columnSelectClosed:["ColumnsToolPanel","ColumnMenu"],columnSelectOpen:["ColumnsToolPanel","ColumnMenu"],columnSelectIndeterminate:["ColumnsToolPanel","ColumnMenu"],columnMovePin:"SharedDragAndDrop",columnMoveHide:"SharedDragAndDrop",columnMoveMove:"SharedDragAndDrop",columnMoveLeft:"SharedDragAndDrop",columnMoveRight:"SharedDragAndDrop",columnMoveGroup:"SharedDragAndDrop",columnMoveValue:"SharedDragAndDrop",columnMovePivot:"SharedDragAndDrop",dropNotAllowed:"SharedDragAndDrop",ensureColumnVisible:["ColumnsToolPanel","ColumnMenu"],groupContracted:"GroupCellRenderer",groupExpanded:"GroupCellRenderer",setFilterGroupClosed:"SetFilter",setFilterGroupOpen:"SetFilter",setFilterGroupIndeterminate:"SetFilter",setFilterLoading:"SetFilter",close:"EnterpriseCore",check:"MenuItem",colorPicker:"CommunityCore",groupLoading:"LoadingCellRenderer",menuAlt:"ColumnHeaderComp",menuPin:"MenuCore",menuValue:"MenuCore",menuAddRowGroup:["MenuCore","ColumnsToolPanel"],menuRemoveRowGroup:["MenuCore","ColumnsToolPanel"],clipboardCopy:"MenuCore",clipboardCut:"MenuCore",clipboardPaste:"MenuCore",pivotPanel:["ColumnsToolPanel","RowGroupingPanel"],rowGroupPanel:["ColumnsToolPanel","RowGroupingPanel"],valuePanel:"ColumnsToolPanel",columnDrag:"EnterpriseCore",rowDrag:["RowDrag","DragAndDrop"],csvExport:"MenuCore",excelExport:"MenuCore",smallDown:"CommunityCore",selectOpen:"CommunityCore",richSelectOpen:"RichSelect",richSelectRemove:"RichSelect",smallLeft:"CommunityCore",smallRight:"CommunityCore",subMenuOpen:"MenuItem",subMenuOpenRtl:"MenuItem",panelDelimiter:"RowGroupingPanel",panelDelimiterRtl:"RowGroupingPanel",smallUp:"CommunityCore",sortAscending:["MenuCore","Sort"],sortDescending:["MenuCore","Sort"],sortUnSort:["MenuCore","Sort"],advancedFilterBuilder:"AdvancedFilter",advancedFilterBuilderDrag:"AdvancedFilter",advancedFilterBuilderInvalid:"AdvancedFilter",advancedFilterBuilderMoveUp:"AdvancedFilter",advancedFilterBuilderMoveDown:"AdvancedFilter",advancedFilterBuilderAdd:"AdvancedFilter",advancedFilterBuilderRemove:"AdvancedFilter",advancedFilterBuilderSelectOpen:"AdvancedFilter",chartsMenu:"IntegratedCharts",chartsMenuEdit:"IntegratedCharts",chartsMenuAdvancedSettings:"IntegratedCharts",chartsMenuAdd:"IntegratedCharts",chartsColorPicker:"IntegratedCharts",chartsThemePrevious:"IntegratedCharts",chartsThemeNext:"IntegratedCharts",chartsDownload:"IntegratedCharts",checkboxChecked:"CommunityCore",checkboxIndeterminate:"CommunityCore",checkboxUnchecked:"CommunityCore",radioButtonOn:"CommunityCore",radioButtonOff:"CommunityCore",rowPin:"PinnedRow",rowUnpin:"PinnedRow",rowPinBottom:"PinnedRow",rowPinTop:"PinnedRow"},dne=new Set(["colorPicker","smallUp","checkboxChecked","checkboxIndeterminate","checkboxUnchecked","radioButtonOn","radioButtonOff","smallDown","smallLeft","smallRight"]),une=class extends H{constructor(){super(...arguments),this.beanName="validation"}wireBeans(t){this.gridOptions=t.gridOptions,bq(jie)}warnOnInitialPropertyUpdate(t,e){t==="api"&&nne[e]&&K(22,{key:e})}processGridOptions(t){this.processOptions(t,rte())}validateApiFunction(t,e){return sne(t,e,this.beans)}missingUserComponent(t,e,i,n){let r=cc[e];r?this.gos.assertModuleRegistered(r,`AG Grid '${t}' component: ${e}`):K(101,{propertyName:t,componentName:e,agGridDefaults:i,jsComps:n})}missingDynamicBean(t){let e=ane[t];return e?Or(200,k(w({},this.gos.getModuleErrorParams()),{moduleName:e,reasonOrId:t})):void 0}checkRowEvents(t){pne.has(t)&&K(10,{eventType:t})}validateIcon(t){if(dne.has(t)&&K(43,{iconName:t}),lne[t])return;let e=cne[t];if(e){at(200,{reasonOrId:`icon '${t}'`,moduleName:e,gridScoped:DS(),gridId:this.beans.context.getId(),rowModelType:this.gos.get("rowModelType"),additionalText:"Alternatively, use the CSS icon name directly."});return}K(134,{iconName:t})}isProvidedUserComp(t){return!!cc[t]}validateColDef(t){this.processOptions(t,Kee())}processOptions(t,e){let{validations:i,deprecations:n,allProperties:r,propertyExceptions:o,objectName:s,docsUrl:a}=e;r&&this.gridOptions.suppressPropertyNamesCheck!==!0&&this.checkProperties(t,[...o??[],...Object.keys(n)],r,s,a);let l=new Set;if(Object.keys(t).forEach(d=>{let u=n[d];if(u){let{message:C,version:b}=u;l.add(`As of v${b}, ${String(d)} is deprecated. ${C??""}`)}let h=t[d];if(h==null||h===!1)return;let p=i[d];if(!p)return;let{dependencies:f,validate:g,supportedRowModels:m,expectedType:v}=p;if(v){let C=typeof h;if(C!==v){l.add(`${String(d)} should be of type '${v}' but received '${C}' (${h}).`);return}}if(m){let C=this.gridOptions.rowModelType??"clientSide";if(!m.includes(C)){l.add(`${String(d)} is not supported with the '${C}' row model. It is only valid with: ${m.join(", ")}.`);return}}if(f){let C=this.checkForRequiredDependencies(d,f,t);if(C){l.add(C);return}}if(g){let C=g(t,this.gridOptions,this.beans);if(C){l.add(C);return}}}),l.size>0)for(let d of l)Qu(d)}checkForRequiredDependencies(t,e,i){let r=Object.entries(e).filter(([o,s])=>{let a=i[o];return!s.required.includes(a)});return r.length===0?null:r.map(([o,s])=>`'${String(t)}' requires '${o}' to be one of [${s.required.map(a=>a===null?"null":a===void 0?"undefined":a).join(", ")}]. ${s.reason??""}`).join(`
           `)}checkProperties(t,e,i,n,r){let o=["__ob__","__v_skip","__metadata__"],s=hne(Object.getOwnPropertyNames(t),[...o,...e,...i],i),a=Object.keys(s);for(let l of a){let c=s[l],d=`invalid ${n} property '${l}' did you mean any of these: ${c.slice(0,8).join(", ")}.`;i.includes("context")&&(d+=`
If you are trying to annotate ${n} with application data, use the '${n}.context' property instead.`),Qu(d)}if(a.length>0&&r){let l=this.beans.frameworkOverrides.getDocLink(r);Qu(`to see all the valid ${n} properties please check: ${l}`)}}};function hne(t,e,i){let n={},r=t.filter(o=>!e.some(s=>s===o));if(r.length>0)for(let o of r)n[o]=eS({inputValue:o,allSuggestions:i}).values;return n}var pne=new Set(["firstChildChanged","lastChildChanged","childIndexChanged"]),fne={moduleName:"Validation",version:oe,beans:[une]};function K8(t){let e=t.sibling;e&&(e.childrenAfterFilter=t.childrenAfterFilter)}var gne=class extends H{constructor(){super(...arguments),this.beanName="filterStage",this.step="filter",this.refreshProps=["excludeChildrenWhenTreeDataFiltering"]}wireBeans(t){this.filterManager=t.filterManager}execute(t){let{changedPath:e}=t;this.filter(e)}filter(t){let e=!!this.filterManager?.isChildFilterPresent();this.filterNodes(e,t)}filterNodes(t,e){let i=(n,r)=>{n.hasChildren()&&t&&!r?n.childrenAfterFilter=n.childrenAfterGroup.filter(o=>{let s=o.childrenAfterFilter&&o.childrenAfterFilter.length>0,a=o.data&&this.filterManager.doesRowPassFilter({rowNode:o});return s||a}):n.childrenAfterFilter=n.childrenAfterGroup,K8(n)};if(this.doingTreeDataFiltering()){let n=(o,s)=>{if(o.childrenAfterGroup)for(let a=0;a<o.childrenAfterGroup.length;a++){let l=o.childrenAfterGroup[a],c=s||this.filterManager.doesRowPassFilter({rowNode:l});l.childrenAfterGroup?n(o.childrenAfterGroup[a],c):i(l,c)}i(o,s)},r=o=>n(o,!1);e.executeFromRootNode(r)}else{let n=r=>i(r,!1);e.forEachChangedNodeDepthFirst(n,!0)}}doingTreeDataFiltering(){return this.gos.get("treeData")&&!this.gos.get("excludeChildrenWhenTreeDataFiltering")}},mne=class extends ZS{constructor(){super(...arguments),this.iconCreated=!1}wireComp(t,e,i,n,r){this.comp=t;let o=wh(this,this.beans.context,r);this.eButtonShowMainFilter=i,this.eFloatingFilterBody=n,this.setGui(e,o),this.setupActive(),this.refreshHeaderStyles(),this.setupWidth(o),this.setupLeft(o),this.setupHover(o),this.setupFocus(o),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(o),this.setupUi(),o.addManagedElementListeners(this.eButtonShowMainFilter,{click:this.showParentFilter.bind(this)}),this.setupFilterChangedListener(o);let s=()=>this.onColDefChanged(o);o.addManagedListeners(this.column,{colDefChanged:s}),o.addManagedEventListeners({filterSwitched:({column:a})=>{a===this.column&&s()}}),o.addDestroyFunc(()=>{this.eButtonShowMainFilter=null,this.eFloatingFilterBody=null,this.userCompDetails=null,this.clearComponent()})}resizeHeader(){}moveHeader(){}getHeaderClassParams(){let{column:t,beans:e}=this,i=t.colDef;return Ee(e.gos,{colDef:i,column:t,floatingFilter:!0})}setupActive(){let t=this.column.getColDef(),e=!!t.filter,i=!!t.floatingFilter;this.active=e&&i}setupUi(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),!this.active||this.iconCreated)return;let t=Mn("filter",this.beans,this.column);t&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(t))}setupFocus(t){t.createManagedBean(new bc(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}setupAria(){let t=this.getLocaleTextFunc();hc(this.eButtonShowMainFilter,t("ariaFilterMenuOpen","Open Filter Menu"))}onTabKeyDown(t){let{beans:e}=this;if(St(e)===this.eGui)return;let r=Oa(e,this.eGui,null,t.shiftKey);if(r){e.headerNavigation?.scrollToColumn(this.column),t.preventDefault(),r.focus();return}let o=this.findNextColumnWithFloatingFilter(t.shiftKey);o&&e.focusSvc.focusHeaderPosition({headerPosition:{headerRowIndex:this.rowCtrl.rowIndex,column:o},event:t})&&t.preventDefault()}findNextColumnWithFloatingFilter(t){let e=this.beans.visibleCols,i=this.column;do if(i=t?e.getColBefore(i):e.getColAfter(i),!i)break;while(!i.getColDef().filter||!i.getColDef().floatingFilter);return i}handleKeyDown(t){super.handleKeyDown(t);let e=this.getWrapperHasFocus();switch(t.key){case A.UP:case A.DOWN:case A.LEFT:case A.RIGHT:if(e)return;Da(t);case A.ENTER:e&&Ta(this.eGui)&&t.preventDefault();break;case A.ESCAPE:e||this.eGui.focus()}}onFocusIn(t){if(this.eGui.contains(t.relatedTarget))return;let i=!!t.relatedTarget&&!t.relatedTarget.classList.contains("ag-floating-filter"),n=!!t.relatedTarget&&Sa(t.relatedTarget,"ag-floating-filter");if(i&&n&&t.target===this.eGui){let r=this.lastFocusEvent,o=!!(r&&r.key===A.TAB);if(r&&o){let s=r.shiftKey;Ta(this.eGui,s)}}this.focusThis()}setupHover(t){this.beans.colHover?.addHeaderFilterColumnHoverListener(t,this.comp,this.column,this.eGui)}setupLeft(t){let e=new QS(this.column,this.eGui,this.beans);t.createManagedBean(e)}setupFilterButton(){this.suppressFilterButton=!this.beans.menuSvc?.isFloatingFilterButtonEnabled(this.column),this.highlightFilterButtonWhenActive=!dn(this.gos)}setupUserComp(){if(!this.active)return;let t=this.beans.colFilter?.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter());t&&this.setCompDetails(t)}setCompDetails(t){this.userCompDetails=t,this.comp.setCompDetails(t)}showParentFilter(){let t=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.beans.menuSvc?.showFilterMenu({column:this.column,buttonElement:t,containerType:"floatingFilter",positionBy:"button"})}setupSyncWithFilter(t){if(!this.active)return;let{beans:{colFilter:e},column:i,gos:n}=this,r=o=>{if(o?.source==="filterDestroyed"&&(!this.isAlive()||!e?.isAlive()))return;let s=this.comp.getFloatingFilterComp();s&&s.then(a=>{if(a){if(n.get("enableFilterHandlers")){let d=o,u="filter";d?.afterFloatingFilter?u="ui":d?.afterDataChange?u="dataChanged":o?.source==="api"&&(u="api"),this.updateFloatingFilterParams(this.userCompDetails,u);return}let l=e?.getCurrentFloatingFilterParentModel(i),c=o?k(w({},o),{columns:o.columns??[],source:o.source==="api"?"api":"columnFilter"}):null;a.onParentModelChanged(l,c)}})};[this.destroySyncListener]=t.addManagedListeners(i,{filterChanged:r}),e?.isFilterActive(i)&&r(null)}setupWidth(t){let e=()=>{let i=`${this.column.getActualWidth()}px`;this.comp.setWidth(i)};t.addManagedListeners(this.column,{widthChanged:e}),e()}setupFilterChangedListener(t){this.active&&([this.destroyFilterChangedListener]=t.addManagedListeners(this.column,{filterChanged:this.updateFilterButton.bind(this)}),this.updateFilterButton())}updateFilterButton(){if(!this.suppressFilterButton&&this.comp){let t=!!this.beans.filterManager?.isFilterAllowed(this.column);this.comp.setButtonWrapperDisplayed(t),this.highlightFilterButtonWhenActive&&t&&this.eButtonShowMainFilter.classList.toggle("ag-filter-active",this.column.isFilterActive())}}onColDefChanged(t){let e=this.active;this.setupActive();let i=!e&&this.active;e&&!this.active&&(this.destroySyncListener(),this.destroyFilterChangedListener());let n=this.beans.colFilter,r=this.active?n?.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter()):null,o=this.comp.getFloatingFilterComp();!o||!r?this.updateCompDetails(t,r,i):o.then(s=>{!s||n?.areFilterCompsDifferent(this.userCompDetails??null,r)?this.updateCompDetails(t,r,i):this.updateFloatingFilterParams(r,"colDef")})}updateCompDetails(t,e,i){this.isAlive()&&(this.setCompDetails(e),this.setupFilterButton(),this.setupUi(),i&&(this.setupSyncWithFilter(t),this.setupFilterChangedListener(t)))}updateFloatingFilterParams(t,e){if(!t)return;let i=t.params;this.comp.getFloatingFilterComp()?.then(n=>{typeof n?.refresh=="function"&&(this.gos.get("enableFilterHandlers")&&(i=k(w({},i),{model:ni(this.beans.colFilter?.model??{},this.column.getColId()),source:e})),n.refresh(i))})}addResizeAndMoveKeyboardListeners(){}destroy(){super.destroy(),this.destroySyncListener=null,this.destroyFilterChangedListener=null}};function vne(t,e){let i=t.colModel.getCol(e);if(!i){at(12,{colKey:e});return}t.menuSvc?.showColumnMenu({column:i,positionBy:"auto"})}function Cne(t){t.menuSvc?.hidePopupMenu()}var wne={moduleName:"SharedMenu",version:oe,beans:[IX],apiFunctions:{showColumnMenu:vne,hidePopupMenu:Cne}},bne=class extends eY{postConstruct(){this.beans.ctrlsSvc.whenReady(this,t=>{this.gridCtrl=t.gridCtrl}),this.addManagedEventListeners({gridStylesChanged:this.handleThemeChange.bind(this)})}getDefaultPopupParent(){return this.gridCtrl.getGui()}positionPopupForMenu(t){let{eventSource:e,ePopup:i,event:n}=t,r=e.getBoundingClientRect(),o=this.getParentRect();this.setAlignedTo(e,i);let s=!1,a=()=>{let l=this.keepXYWithinBounds(i,r.top-o.top,0),c=i.clientWidth>0?i.clientWidth:200;s||(i.style.minWidth=`${c}px`,s=!0);let u=o.right-o.left-c,h;return this.gos.get("enableRtl")?(h=f(),h<0&&(h=p(),this.setAlignedStyles(i,"left")),h>u&&(h=0,this.setAlignedStyles(i,"right"))):(h=p(),h>u&&(h=f(),this.setAlignedStyles(i,"right")),h<0&&(h=0,this.setAlignedStyles(i,"left"))),{x:h,y:l};function p(){return r.right-o.left-2}function f(){return r.left-o.left-c}};this.positionPopup({ePopup:i,keepWithinBounds:!0,updatePosition:a,postProcessCallback:()=>this.callPostProcessPopup(t,"subMenu",i,e,n instanceof MouseEvent?n:void 0)})}callPostProcessPopup(t,e,i,n,r){let o=this.gos.getCallback("postProcessPopup");if(o){let{column:s,rowNode:a}=t;o({column:s,rowNode:a,ePopup:i,type:e,eventSource:n,mouseEvent:r})}}getActivePopups(){return this.popupList.map(t=>t.element)}handleThemeChange(t){if(t.themeChanged){let e=this.beans.environment;for(let i of this.popupList)e.applyThemeClasses(i.wrapper)}}hasAnchoredPopup(){return this.popupList.some(t=>t.isAnchored)}isStopPropagation(t){return yo(t)}},$m={moduleName:"Popup",version:oe,beans:[bne]},yne=".ag-set-filter{--ag-indentation-level:0}.ag-set-filter-item{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-set-filter-item{padding-left:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}:where(.ag-rtl) .ag-set-filter-item{padding-right:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}.ag-set-filter-item-checkbox{display:flex;height:100%;width:100%}.ag-set-filter-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr) .ag-set-filter-group-icons{margin-right:var(--ag-widget-container-horizontal-padding)}:where(.ag-rtl) .ag-set-filter-group-icons{margin-left:var(--ag-widget-container-horizontal-padding)}.ag-filter-body-wrapper{display:flex;flex-direction:column}:where(.ag-menu:not(.ag-tabs) .ag-filter) .ag-filter-body-wrapper,:where(.ag-menu:not(.ag-tabs) .ag-filter)>:not(.ag-filter-wrapper){min-width:180px}.ag-filter-filter{flex:1 1 0px}.ag-filter-condition{display:flex;justify-content:center}.ag-floating-filter-body{display:flex;flex:1 1 auto;height:100%;position:relative}.ag-floating-filter-full-body{align-items:center;display:flex;flex:1 1 auto;height:100%;overflow:hidden;width:100%}:where(.ag-floating-filter-full-body)>div{flex:1 1 auto}.ag-floating-filter-input{align-items:center;display:flex;width:100%;>*{flex:1 1 auto}:where(.ag-input-field-input[type=date]),:where(.ag-input-field-input[type=datetime-local]){width:1px}}.ag-floating-filter-button{display:flex;flex:none}.ag-date-floating-filter-wrapper{display:flex}.ag-set-floating-filter-input :where(input)[disabled]{pointer-events:none}.ag-floating-filter-button-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:none;height:var(--ag-icon-size);width:var(--ag-icon-size)}.ag-filter-loading{align-items:unset;background-color:var(--ag-chrome-background-color);height:100%;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);position:absolute;width:100%;z-index:1;:where(.ag-menu) &{background-color:var(--ag-menu-background-color)}}.ag-filter-separator{border-top:solid var(--ag-border-width) var(--menu-separator-color)}:where(.ag-filter-select) .ag-picker-field-wrapper{width:0}.ag-filter-condition-operator{height:17px}:where(.ag-ltr) .ag-filter-condition-operator-or{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-condition-operator-or{margin-right:calc(var(--ag-spacing)*2)}.ag-set-filter-select-all{padding-top:var(--ag-widget-container-vertical-padding)}.ag-filter-no-matches,.ag-set-filter-list{height:calc(var(--ag-list-item-height)*6)}.ag-filter-no-matches{padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}.ag-set-filter-tree-list{height:calc(var(--ag-list-item-height)*10)}.ag-set-filter-filter{margin-left:var(--ag-widget-container-horizontal-padding);margin-right:var(--ag-widget-container-horizontal-padding);margin-top:var(--ag-widget-container-vertical-padding)}.ag-filter-to{margin-top:var(--ag-widget-vertical-spacing)}.ag-mini-filter{margin:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}:where(.ag-ltr) .ag-set-filter-add-group-indent{margin-left:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-rtl) .ag-set-filter-add-group-indent{margin-right:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-filter-menu) .ag-set-filter-list{min-width:200px}.ag-filter-virtual-list-item:focus-visible{box-shadow:inset var(--ag-focus-shadow)}.ag-filter-apply-panel{display:flex;justify-content:flex-end;overflow:hidden;padding:var(--ag-widget-vertical-spacing) var(--ag-widget-container-horizontal-padding) var(--ag-widget-container-vertical-padding)}.ag-filter-apply-panel-button{line-height:1.5}:where(.ag-ltr) .ag-filter-apply-panel-button{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-apply-panel-button{margin-right:calc(var(--ag-spacing)*2)}.ag-simple-filter-body-wrapper{display:flex;flex-direction:column;min-height:calc(var(--ag-list-item-height) + var(--ag-widget-container-vertical-padding) + var(--ag-widget-vertical-spacing));overflow-y:auto;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);padding-bottom:calc(var(--ag-widget-container-vertical-padding) - var(--ag-widget-vertical-spacing));&>*{margin-bottom:var(--ag-widget-vertical-spacing)}:where(.ag-resizer-wrapper){margin:0}}.ag-multi-filter-menu-item{margin:var(--ag-spacing) 0}.ag-multi-filter-group-title-bar{background-color:transparent;color:var(--ag-header-text-color);font-weight:500;padding:calc(var(--ag-spacing)*1.5) var(--ag-spacing)}.ag-group-filter-field-select-wrapper{display:flex;flex-direction:column;gap:var(--ag-widget-vertical-spacing);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}";function Sne(t){let e=t.filterManager;return!!e?.isColumnFilterPresent()||!!e?.isAggregateFilterPresent()}function xne(t,e){return t.filterManager?.getColumnFilterInstance(e)??Promise.resolve(void 0)}function Ene(t,e){let i=t.colModel.getColDefCol(e);if(i)return t.colFilter?.destroyFilter(i,"api")}function Pne(t,e){t.frameworkOverrides.wrapIncoming(()=>t.filterManager?.setFilterModel(e))}function Rne(t){return t.filterManager?.getFilterModel()??{}}function _ne(t,e,i){let{gos:n,colModel:r,colFilter:o}=t;i&&!n.get("enableFilterHandlers")&&(K(288),i=!1);let s=r.getColDefCol(e);return s?o?.getModelForColumn(s,i)??null:null}function kne(t,e,i){return t.filterManager?.setColumnFilterModel(e,i)??Promise.resolve()}function Fne(t,e){let i=t.colModel.getCol(e);if(!i){at(12,{colKey:e});return}t.menuSvc?.showFilterMenu({column:i,containerType:"columnFilter",positionBy:"auto"})}function Tne(t){t.menuSvc?.hideFilterMenu()}function Dne(t,e){let i=t.colModel.getCol(e);if(!i){at(12,{colKey:e});return}return t.colFilter?.getHandler(i,!0)}function Mne(t,e){let{colModel:i,colFilter:n,gos:r}=t;if(!r.get("enableFilterHandlers")){K(287);return}let{colId:o,action:s}=e;if(o){let a=i.getColById(o);a&&n?.updateModel(a,s)}else n?.updateAllModels(s)}var Ine={filterHandler:()=>({doesFilterPass:()=>!0})},Ane=class extends H{constructor(){super(...arguments),this.beanName="colFilter",this.allColumnFilters=new Map,this.allColumnListeners=new Map,this.activeAggregateFilters=[],this.activeColumnFilters=[],this.processingFilterChange=!1,this.modelUpdates=[],this.columnModelUpdates=[],this.state=new Map,this.handlerMap=w({},zM),this.isGlobalButtons=!1,this.activeFilterComps=new Set}postConstruct(){this.addManagedEventListeners({gridColumnsChanged:this.onColumnsChanged.bind(this),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)});let t=this.gos,e=w({},t.get("initialState")?.filter?.filterModel??{});this.initialModel=e,this.model=w({},e),t.get("enableFilterHandlers")||delete this.handlerMap.agMultiColumnFilter}refreshModel(){this.onNewRowsLoaded("rowDataUpdated")}setModel(t,e="api",i){let{colModel:n,dataTypeSvc:r,filterManager:o}=this.beans;if(r?.isPendingInference){this.modelUpdates.push({model:t,source:e});return}let s=[],a=this.getModel(!0);if(t){let l=new Set(Object.keys(t));this.allColumnFilters.forEach((c,d)=>{let u=t[d];s.push(this.setModelOnFilterWrapper(c,u)),l.delete(d)}),l.forEach(c=>{let d=n.getColDefCol(c)||n.getCol(c);if(!d){K(62,{colId:c});return}if(!d.isFilterAllowed()){K(63,{colId:c});return}let u=this.getOrCreateFilterWrapper(d,!0);if(!u){K(64,{colId:c});return}s.push(this.setModelOnFilterWrapper(u,t[c],!0))})}else this.model={},this.allColumnFilters.forEach(l=>{s.push(this.setModelOnFilterWrapper(l,null))});Et.all(s).then(()=>{let l=this.getModel(!0),c=[];this.allColumnFilters.forEach((d,u)=>{let h=a?a[u]:null,p=l?l[u]:null;rh(h,p)||c.push(d.column)}),c.length>0?o?.onFilterChanged({columns:c,source:e}):i&&this.updateActive("filterChanged")})}getModel(t){let e={},{allColumnFilters:i,initialModel:n,beans:{colModel:r}}=this;if(i.forEach((o,s)=>{let a=this.getModelFromFilterWrapper(o);ae(a)&&(e[s]=a)}),!t)for(let o of Object.keys(n)){let s=n[o];ae(s)&&!i.has(o)&&r.getCol(o)?.isFilterAllowed()&&(e[o]=s)}return e}setState(t,e,i="api"){if(this.state.clear(),e)for(let n of Object.keys(e)){let r=e[n];this.state.set(n,{model:ni(this.model,n),state:r})}this.setModel(t,i,!0)}getState(){let t=this.state;if(!t.size)return;let e={},i=!1;return t.forEach((n,r)=>{let o=n.state;o!=null&&(i=!0,e[r]=o)}),i?e:void 0}getModelFromFilterWrapper(t){let i=t.column.getColId();if(t.isHandler)return ni(this.model,i);let n=t.filter;return n?typeof n.getModel!="function"?(K(66),null):n.getModel():ni(this.initialModel,i)}isFilterPresent(){return this.activeColumnFilters.length>0}isAggFilterPresent(){return!!this.activeAggregateFilters.length}disableFilters(){this.initialModel={};let{allColumnFilters:t}=this;return t.size?(t.forEach(e=>this.disposeFilterWrapper(e,"advancedFilterEnabled")),!0):!1}updateActiveFilters(){let t=c=>c?c.isFilterActive?c.isFilterActive():(K(67),!1):!1,{colModel:e,gos:i}=this.beans,n=!!$y(i),r=c=>{if(!c.isPrimary())return!0;let u=!e.isPivotActive();return!c.isValueActive()||!u?!1:e.isPivotMode()?!0:n},o=[],s=[],a=(c,d,u)=>{d&&(r(c)?o.push(u):s.push(u))},l=[];return this.allColumnFilters.forEach(c=>{let d=c.column,u=d.getColId();if(c.isHandler)l.push(Et.resolve().then(()=>{a(d,this.isHandlerActive(d),{colId:u,isHandler:!0,handler:c.handler,handlerParams:c.handlerParams})}));else{let h=us(c);h&&l.push(h.then(p=>{a(d,t(p),{colId:u,isHandler:!1,comp:p})}))}}),Et.all(l).then(()=>{this.activeAggregateFilters=o,this.activeColumnFilters=s})}updateFilterFlagInColumns(t,e){let i=[];return this.allColumnFilters.forEach(n=>{let r=n.column;if(n.isHandler)i.push(Et.resolve().then(()=>{this.setColFilterActive(r,this.isHandlerActive(r),t,e)}));else{let o=us(n);o&&i.push(o.then(s=>{this.setColFilterActive(r,s.isFilterActive(),t,e)}))}}),this.beans.groupFilter?.updateFilterFlags(t,e),Et.all(i)}doFiltersPass(t,e,i){let{data:n,aggData:r}=t,o=i?this.activeAggregateFilters:this.activeColumnFilters,s=i?r:n,a=this.model;for(let l=0;l<o.length;l++){let c=o[l],{colId:d,isHandler:u}=c;if(d!==e)if(u){let{handler:h,handlerParams:p}=c;if(!h.doesFilterPass({node:t,data:s,model:ni(a,d),handlerParams:p}))return!1}else{let h=c.comp;if(typeof h.doesFilterPass!="function"){at(91);continue}if(!h.doesFilterPass({node:t,data:s}))return!1}}return!0}getHandlerParams(t){let e=this.allColumnFilters.get(t.getColId());return e?.isHandler?e.handlerParams:void 0}callOnFilterChangedOutsideRenderCycle(t){let{rowRenderer:e,filterManager:i}=this.beans,n=()=>{this.isAlive()&&i?.onFilterChanged(t)};e.isRefreshInProgress()?setTimeout(n,0):n()}updateBeforeFilterChanged(t={}){let{column:e,additionalEventAttributes:i}=t,n=e?.getColId();return this.updateActiveFilters().then(()=>this.updateFilterFlagInColumns("filterChanged",i).then(()=>{this.allColumnFilters.forEach(r=>{let{column:o,isHandler:s}=r;n!==o.getColId()&&(s&&r.handler.onAnyFilterChanged?.(),us(r,s)?.then(a=>{typeof a?.onAnyFilterChanged=="function"&&a.onAnyFilterChanged()}))}),this.processingFilterChange=!0}))}updateAfterFilterChanged(){this.processingFilterChange=!1}isSuppressFlashingCellsBecauseFiltering(){return!(this.gos.get("allowShowChangeAfterFilter")??!1)&&this.processingFilterChange}onNewRowsLoaded(t){let e=[];this.allColumnFilters.forEach(i=>{let n=i.isHandler;n&&i.handler.onNewRowsLoaded?.();let r=us(i,n);r&&e.push(r.then(o=>{o.onNewRowsLoaded?.()}))}),Et.all(e).then(()=>this.updateActive(t,{afterDataChange:!0}))}updateActive(t,e){this.updateFilterFlagInColumns(t,e).then(()=>this.updateActiveFilters())}createGetValue(t,e){let{filterValueSvc:i,colModel:n}=this.beans;return(r,o)=>{let s=o?n.getCol(o):t;return s?i.getValue(s,r,e):void 0}}isFilterActive(t){let e=this.cachedFilter(t);if(e?.isHandler)return this.isHandlerActive(t);let i=e?.filter;return i?i.isFilterActive():ni(this.initialModel,t.getColId())!=null}isHandlerActive(t){let e=ae(ni(this.model,t.getColId()));if(e)return e;let i=this.beans.groupFilter;return i?.isGroupFilter(t)?i.isFilterActive(t):!1}getOrCreateFilterUi(t){let e=this.getOrCreateFilterWrapper(t,!0);return e?us(e):null}getFilterUiForDisplay(t){let e=this.getOrCreateFilterWrapper(t,!0);if(!e)return null;let i=us(e);return i?i.then(n=>({comp:n,params:e.filterUi.filterParams,isHandler:e.isHandler})):null}getHandler(t,e){let i=this.getOrCreateFilterWrapper(t,e);return i?.isHandler?i.handler:void 0}getOrCreateFilterWrapper(t,e){if(!t.isFilterAllowed())return;let i=this.cachedFilter(t);return!i&&e&&(i=this.createFilterWrapper(t),this.setColumnFilterWrapper(t,i)),i}cachedFilter(t){return this.allColumnFilters.get(t.getColId())}getDefaultFilter(t,e=!1){return this.getDefaultFilterFromDataType(()=>this.beans.dataTypeSvc?.getBaseDataType(t),e)}getDefaultFilterFromDataType(t,e=!1){return Lq(this.gos)?e?"agSetColumnFloatingFilter":"agSetColumnFilter":EY(t(),e)}getDefaultFloatingFilter(t){return this.getDefaultFilter(t,!0)}createFilterComp(t,e,i,n,r,o){let s=()=>{let c=this.createFilterCompParams(t,r,o),d=n(c,r);return H$(this.beans.userCompFactory,e,d,i)},a=s();return a?{compDetails:a,createFilterUi:c=>(c?s():a).newAgStackInstance()}:null}createFilterInstance(t,e,i,n){let r=this.beans.selectableFilter;r?.isSelectable(e)&&(e=r.getFilterDef(t,e));let{handler:o,handlerParams:s,handlerGenerator:a}=this.createHandler(t,e,i)??{},l=this.createFilterComp(t,e,i,n,!!o,"init");if(!l)return{compDetails:null,createFilterUi:null,handler:o,handlerGenerator:a,handlerParams:s};let{compDetails:c,createFilterUi:d}=l;return this.isGlobalButtons&&(c.params?.buttons?.length||K(281,{colId:t.getColId()})),{compDetails:c,handler:o,handlerGenerator:a,handlerParams:s,createFilterUi:d}}createBaseFilterParams(t,e){let{filterManager:i,rowModel:n}=this.beans;return Ee(this.gos,{column:t,colDef:t.getColDef(),getValue:this.createGetValue(t),doesRowPassOtherFilter:e?()=>!0:r=>i?.doesRowPassOtherFilters(t.getColId(),r)??!0,rowModel:n})}createFilterCompParams(t,e,i,n){let r=this.filterChangedCallbackFactory(t),o=this.createBaseFilterParams(t,n);if(o.filterChangedCallback=r,o.filterModifiedCallback=n?()=>{}:s=>this.filterModified(t,s),e){let s=o,a=t.getColId(),l=ni(this.model,a);s.model=l,s.state=this.state.get(a)??{model:l},s.onModelChange=(c,d)=>{this.updateStoredModel(a,c),this.refreshHandlerAndUi(t,c,"ui",!1,d).then(()=>{r(k(w({},d),{source:"columnFilter"}))})},s.onStateChange=c=>{this.updateState(t,c),this.updateOrRefreshFilterUi(t)},s.onAction=(c,d,u)=>{this.updateModel(t,c,d),this.dispatchLocalEvent({type:"filterAction",column:t,action:c,event:u})},s.getHandler=()=>this.getHandler(t,!0),s.onUiChange=c=>this.filterUiChanged(t,c),s.source=i}return o}createFilterUiForHandler(t,e){return e?{created:!1,create:e,filterParams:t.params,compDetails:t}:null}createFilterUiLegacy(t,e,i){let n=e(),r={created:!0,create:e,filterParams:t.params,compDetails:t,promise:n};return n.then(i),r}createFilterWrapper(t){let{compDetails:e,handler:i,handlerGenerator:n,handlerParams:r,createFilterUi:o}=this.createFilterInstance(t,t.getColDef(),this.getDefaultFilter(t),a=>a),s=t.getColId();if(i)return delete this.initialModel[s],i.init?.(k(w({},r),{source:"init",model:ni(this.model,s)})),{column:t,isHandler:!0,handler:i,handlerGenerator:n,handlerParams:r,filterUi:this.createFilterUiForHandler(e,o)};if(o){let a={column:t,filterUi:null,isHandler:!1};return a.filterUi=this.createFilterUiLegacy(e,o,l=>{a.filter=l??void 0}),a}return{column:t,filterUi:null,isHandler:!1}}createHandlerFunc(t,e,i){let{gos:n,frameworkOverrides:r,registry:o}=this.beans,s,a=p=>{let f=p.filter;if(gM(f)){let g=f.handler;return g||(s=f.doesFilterPass,s?()=>({doesFilterPass:s}):void 0)}return typeof f=="string"?f:void 0},l=n.get("enableFilterHandlers"),c=l?a(e):void 0,d=p=>()=>this.createBean(o.createDynamicBean(p,!0)),u,h;if(typeof c=="string"){let p=n.get("filterHandlers")?.[c];p!=null?u=p:hY.has(c)&&(u=d(c),h=c)}else u=c;if(!u){let p,{compName:f,jsComp:g,fwComp:m}=CM(r,e);f?p=f:g==null&&m==null&&e.filter===!0&&(p=i),h=this.handlerMap[p],h&&(u=d(h))}return u?{filterHandler:u,handlerNameOrCallback:s??h}:l?(Lt(n)&&K(277,{colId:t.getColId()}),Ine):void 0}createHandler(t,e,i){let n=this.createHandlerFunc(t,e,i);if(!n)return;let r=cy(this.beans.userCompFactory,e,this.createFilterCompParams(t,!0,"init")),{handlerNameOrCallback:o,filterHandler:s}=n,{handler:a,handlerParams:l}=this.createHandlerFromFunc(t,s,r);return{handler:a,handlerParams:l,handlerGenerator:o??s}}createHandlerFromFunc(t,e,i){let n=t.getColDef(),r=e(Ee(this.gos,{column:t,colDef:n})),o=this.createHandlerParams(t,i);return{handler:r,handlerParams:o}}createHandlerParams(t,e){let i=t.getColDef(),n=t.getColId(),r=this.filterChangedCallbackFactory(t);return Ee(this.gos,{colDef:i,column:t,getValue:this.createGetValue(t),doesRowPassOtherFilter:o=>this.beans.filterManager?.doesRowPassOtherFilters(n,o)??!0,onModelChange:(o,s)=>{this.updateStoredModel(n,o),this.refreshHandlerAndUi(t,o,"handler",!1,s).then(()=>{r(k(w({},s),{source:"columnFilter"}))})},filterParams:e})}onColumnsChanged(){let t=[],{colModel:e,filterManager:i,groupFilter:n}=this.beans;this.allColumnFilters.forEach((o,s)=>{let a;o.column.isPrimary()?a=e.getColDefCol(s):a=e.getCol(s),!(a&&a===o.column)&&(t.push(o.column),this.disposeFilterWrapper(o,"columnChanged"),this.disposeColumnListener(s))});let r=n&&t.every(o=>n.isGroupFilter(o));t.length>0&&!r&&i?.onFilterChanged({columns:t,source:"api"})}isFilterAllowed(t){if(!t.isFilterAllowed())return!1;let i=this.beans.groupFilter;return i?.isGroupFilter(t)?i.isFilterAllowed(t):!0}getFloatingFilterCompDetails(t,e){let{userCompFactory:i,frameworkOverrides:n,selectableFilter:r}=this.beans,o=h=>{let p=this.getOrCreateFilterUi(t);p?.then(f=>{h(hh(f))})},s=t.getColDef(),a=r?.isSelectable(s)?r.getFilterDef(t,s):s,l=FY(n,a,()=>this.getDefaultFloatingFilter(t))??"agReadOnlyFloatingFilter",c=this.gos.get("enableFilterHandlers"),d=cy(i,a,this.createFilterCompParams(t,c,"init",!0)),u=Ee(this.gos,{column:t,filterParams:d,currentParentModel:()=>this.getCurrentFloatingFilterParentModel(t),parentFilterInstance:o,showParentFilter:e});if(c){let h=u,p=t.getColId(),f=this.filterChangedCallbackFactory(t);h.onUiChange=g=>this.floatingFilterUiChanged(t,g),h.model=ni(this.model,p),h.onModelChange=(g,m)=>{this.updateStoredModel(p,g),this.refreshHandlerAndUi(t,g,"floating",!0,m).then(()=>{f(k(w({},m),{source:"columnFilter"}))})},h.getHandler=()=>this.getHandler(t,!0),h.source="init"}return U$(i,s,u,l)}getCurrentFloatingFilterParentModel(t){return this.getModelFromFilterWrapper(this.cachedFilter(t)??{column:t})}destroyFilterUi(t,e,i,n){let r="paramsUpdated";if(t.isHandler){let o=e.getColId();delete this.initialModel[o],this.state.delete(o);let s=t.filterUi,a=this.createFilterUiForHandler(i,n);t.filterUi=a;let l=this.eventSvc;s?.created?s.promise.then(c=>{this.destroyBean(c),l.dispatchEvent({type:"filterDestroyed",source:r,column:e})}):l.dispatchEvent({type:"filterHandlerDestroyed",source:r,column:e})}else this.destroyFilter(e,r)}destroyFilter(t,e="api"){let i=t.getColId(),n=this.allColumnFilters.get(i);this.disposeColumnListener(i),delete this.initialModel[i],n&&this.disposeFilterWrapper(n,e).then(r=>{r&&this.isAlive()&&this.beans.filterManager?.onFilterChanged({columns:[t],source:"api"})})}disposeColumnListener(t){let e=this.allColumnListeners.get(t);e&&(this.allColumnListeners.delete(t),e())}disposeFilterWrapper(t,e){let i=!1,{column:n,isHandler:r,filterUi:o}=t,s=n.getColId();r&&(i=this.isHandlerActive(n),this.destroyBean(t.handler),delete this.model[s],this.state.delete(s));let a=()=>{this.setColFilterActive(n,!1,"filterDestroyed"),this.allColumnFilters.delete(s),this.eventSvc.dispatchEvent({type:"filterDestroyed",source:e,column:n})};if(o){if(o.created)return o.promise.then(l=>(i=r?i:!!l?.isFilterActive(),this.destroyBean(l),a(),i));a()}return Et.resolve(i)}filterChangedCallbackFactory(t){return e=>{this.callOnFilterChangedOutsideRenderCycle({additionalEventAttributes:e,columns:[t],column:t,source:e?.source??"columnFilter"})}}filterParamsChanged(t,e="api"){let i=this.allColumnFilters.get(t);if(!i)return;let n=this.beans,r=i.column,o=r.getColDef(),s=r.isFilterAllowed(),a=this.getDefaultFilter(r),l=n.selectableFilter,c=l?.isSelectable(o)?l.getFilterDef(r,o):o,d=s?this.createHandlerFunc(r,c,this.getDefaultFilter(r)):void 0,u=!!d,h=i.isHandler;if(h!=u){this.destroyFilter(r,"paramsUpdated");return}let{compDetails:p,createFilterUi:f}=(s?this.createFilterComp(r,c,a,m=>m,u,"colDef"):null)??{compDetails:null,createFilterUi:null},g=p?.params??cy(n.userCompFactory,c,this.createFilterCompParams(r,u,"colDef"));if(h){let m=d?.handlerNameOrCallback??d?.filterHandler,v=ni(this.model,t);if(i.handlerGenerator!=m){let C=i.handler,{handler:b,handlerParams:S}=this.createHandlerFromFunc(r,d.filterHandler,g);i.handler=b,i.handlerParams=S,i.handlerGenerator=m,delete this.model[t],b.init?.(k(w({},S),{source:"init",model:null})),this.destroyBean(C),v!=null&&this.beans.filterManager?.onFilterChanged({columns:[r],source:e})}else{let C=this.createHandlerParams(r,p?.params);i.handlerParams=C,i.handler.refresh?.(k(w({},C),{source:"colDef",model:v}))}}if(this.areFilterCompsDifferent(i.filterUi?.compDetails??null,p)||!i.filterUi||!p){this.destroyFilterUi(i,r,p,f);return}i.filterUi.filterParams=g,us(i,h)?.then(m=>{(m?.refresh?m.refresh(g):!0)===!1?this.destroyFilterUi(i,r,p,f):this.dispatchLocalEvent({type:"filterParamsChanged",column:r,params:g})})}refreshHandlerAndUi(t,e,i,n,r){let o=this.cachedFilter(t);if(!o)return n&&this.getOrCreateFilterWrapper(t,!0),Et.resolve();if(!o.isHandler)return Et.resolve();let{filterUi:s,handler:a,handlerParams:l}=o;return pY(()=>{if(s){let{created:c,filterParams:d}=s;if(c)return s.promise.then(u=>u?{filter:u,filterParams:d}:void 0);s.refreshed=!0}return Et.resolve(void 0)},a,l,e,this.state.get(t.getColId())??{model:e},i,r)}setColumnFilterWrapper(t,e){let i=t.getColId();this.allColumnFilters.set(i,e),this.allColumnListeners.set(i,this.addManagedListeners(t,{colDefChanged:()=>this.filterParamsChanged(i)})[0])}areFilterCompsDifferent(t,e){if(!e||!t)return!0;let{componentClass:i}=t,{componentClass:n}=e;return!(i===n||i?.render&&n?.render&&i.render===n.render)}hasFloatingFilters(){return this.beans.colModel.getCols().some(e=>e.getColDef().floatingFilter)}getFilterInstance(t){let e=this.beans.colModel.getColDefCol(t);if(!e)return Promise.resolve(void 0);let i=this.getOrCreateFilterUi(e);return i?new Promise(n=>{i.then(r=>{n(hh(r))})}):Promise.resolve(null)}processFilterModelUpdateQueue(){this.modelUpdates.forEach(({model:t,source:e})=>this.setModel(t,e)),this.modelUpdates=[],this.columnModelUpdates.forEach(({key:t,model:e,resolve:i})=>{this.setModelForColumn(t,e).then(()=>i())}),this.columnModelUpdates=[]}getModelForColumn(t,e){if(e){let{state:n,model:r}=this,o=t.getColId(),s=n.get(o);return s?s.model??null:ni(r,o)}let i=this.cachedFilter(t);return i?this.getModelFromFilterWrapper(i):null}setModelForColumn(t,e){if(this.beans.dataTypeSvc?.isPendingInference){let i=()=>{},n=new Promise(r=>{i=r});return this.columnModelUpdates.push({key:t,model:e,resolve:i}),n}return new Promise(i=>{this.setModelForColumnLegacy(t,e).then(n=>i(n))})}getStateForColumn(t){return this.state.get(t)??{model:ni(this.model,t)}}setModelForColumnLegacy(t,e){let i=this.beans.colModel.getColDefCol(t),n=i?this.getOrCreateFilterWrapper(i,!0):null;return n?this.setModelOnFilterWrapper(n,e):Et.resolve()}setColDefPropsForDataType(t,e,i){let n=t.filter,r=n===!0?this.getDefaultFilterFromDataType(()=>e.baseDataType):n;if(typeof r!="string")return;let o,s,a=this.beans,{filterParams:l,filterValueGetter:c}=t;r==="agMultiColumnFilter"?{filterParams:o,filterValueGetter:s}=a.multiFilter?.getParamsForDataType(l,c,e,i)??{}:{filterParams:o,filterValueGetter:s}=yY(r,l,c,e,i,a,this.getLocaleTextFunc()),t.filterParams=o,s&&(t.filterValueGetter=s)}setColFilterActive(t,e,i,n){t.filterActive!==e&&(t.filterActive=e,t.dispatchColEvent("filterActiveChanged",i)),t.dispatchColEvent("filterChanged",i,n)}setModelOnFilterWrapper(t,e,i){return new Et(n=>{if(t.isHandler){let o=t.column,s=o.getColId(),a=this.model[s];if(this.updateStoredModel(s,e),i&&e===a){n();return}this.refreshHandlerAndUi(o,e,"api").then(()=>n());return}let r=us(t);if(r){r.then(o=>{if(typeof o?.setModel!="function"){K(65),n();return}(o.setModel(e)||Et.resolve()).then(()=>n())});return}n()})}updateStoredModel(t,e){ae(e)?this.model[t]=e:delete this.model[t];let i=this.state.get(t),n={model:e,state:i?.state};this.state.set(t,n)}filterModified(t,e){this.getOrCreateFilterUi(t)?.then(i=>{this.eventSvc.dispatchEvent(w({type:"filterModified",column:t,filterInstance:i},e))})}filterUiChanged(t,e){this.gos.get("enableFilterHandlers")&&this.eventSvc.dispatchEvent(w({type:"filterUiChanged",column:t},e))}floatingFilterUiChanged(t,e){this.gos.get("enableFilterHandlers")&&this.eventSvc.dispatchEvent(w({type:"floatingFilterUiChanged",column:t},e))}updateModel(t,e,i){let n=t.getColId(),r=this.cachedFilter(t),o=()=>r?.filterUi;vT(e,o,()=>ni(this.model,n),()=>this.state.get(n),s=>this.updateState(t,s),s=>o()?.filterParams?.onModelChange(s,i),r?.isHandler?r.handler.processModelToApply?.bind(r.handler):void 0)}updateAllModels(t,e){let i=[];this.allColumnFilters.forEach((n,r)=>{let o=this.beans.colModel.getColDefCol(r);o&&vT(t,()=>n.filterUi,()=>ni(this.model,r),()=>this.state.get(r),s=>this.updateState(o,s),s=>{this.updateStoredModel(r,s),this.dispatchLocalEvent({type:"filterAction",column:o,action:t}),i.push(this.refreshHandlerAndUi(o,s,"ui"))},n?.isHandler?n.handler.processModelToApply?.bind(n.handler):void 0)}),i.length&&Et.all(i).then(()=>{this.callOnFilterChangedOutsideRenderCycle({source:"columnFilter",additionalEventAttributes:e,columns:[]})})}updateOrRefreshFilterUi(t){let e=t.getColId();GM(()=>this.cachedFilter(t)?.filterUi,()=>ni(this.model,e),()=>this.state.get(e))}updateState(t,e){this.state.set(t.getColId(),e),this.dispatchLocalEvent({type:"filterStateChanged",column:t,state:e})}canApplyAll(){let{state:t,model:e,activeFilterComps:i}=this;for(let r of i)if(r.source==="COLUMN_MENU")return!1;let n=!1;for(let r of t.keys()){let o=t.get(r);if(o.valid===!1)return!1;(o.model??null)!==ni(e,r)&&(n=!0)}return n}hasUnappliedModel(t){let{model:e,state:i}=this;return(i.get(t)?.model??null)!==ni(e,t)}setGlobalButtons(t){this.isGlobalButtons=t,this.dispatchLocalEvent({type:"filterGlobalButtons",isGlobal:t})}shouldKeepStateOnDetach(t,e){if(e==="newFiltersToolPanel")return!0;let i=this.beans.filterPanelSvc;return i?.isActive?!!i.getState(t.getColId()):!1}destroy(){super.destroy(),this.allColumnFilters.forEach(t=>this.disposeFilterWrapper(t,"gridDestroyed")),this.allColumnListeners.clear(),this.state.clear(),this.activeFilterComps.clear()}};function One(t){return!!t.filterManager?.isAnyFilterPresent()}function Lne(t,e="api"){t.filterManager?.onFilterChanged({source:e})}var Nne=class extends H{constructor(){super(...arguments),this.beanName="filterManager",this.advFilterModelUpdateQueue=[]}wireBeans(t){this.quickFilter=t.quickFilter,this.advancedFilter=t.advancedFilter,this.colFilter=t.colFilter}postConstruct(){let t=this.refreshFiltersForAggregations.bind(this),e=this.updateAdvFilterColumns.bind(this);this.addManagedEventListeners({columnValueChanged:t,columnPivotChanged:t,columnPivotModeChanged:t,newColumnsLoaded:e,columnVisible:e,advancedFilterEnabledChanged:({enabled:n})=>this.onAdvFilterEnabledChanged(n),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.addManagedPropertyListeners(["isExternalFilterPresent","doesExternalFilterPass"],()=>{this.onFilterChanged({source:"api"})}),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",()=>{this.updateAggFiltering(),this.onFilterChanged()}),this.quickFilter&&this.addManagedListeners(this.quickFilter,{quickFilterChanged:()=>this.onFilterChanged({source:"quickFilter"})});let{gos:i}=this;this.alwaysPassFilter=i.get("alwaysPassFilter"),this.addManagedPropertyListener("alwaysPassFilter",()=>{this.alwaysPassFilter=i.get("alwaysPassFilter"),this.onFilterChanged({source:"api"})})}isExternalFilterPresentCallback(){let t=this.gos.getCallback("isExternalFilterPresent");return typeof t=="function"&&t({})}doesExternalFilterPass(t){let e=this.gos.get("doesExternalFilterPass");return typeof e=="function"&&e(t)}setFilterState(t,e,i="api"){this.isAdvFilterEnabled()||this.colFilter?.setState(t,e,i)}setFilterModel(t,e="api",i){if(this.isAdvFilterEnabled()){i||this.warnAdvFilters();return}this.colFilter?.setModel(t,e)}getFilterModel(){return this.colFilter?.getModel()??{}}getFilterState(){return this.colFilter?.getState()}isColumnFilterPresent(){return!!this.colFilter?.isFilterPresent()}isAggregateFilterPresent(){return!!this.colFilter?.isAggFilterPresent()}isChildFilterPresent(){return this.isColumnFilterPresent()||this.isQuickFilterPresent()||this.externalFilterPresent||this.isAdvFilterPresent()}isAnyFilterPresent(){return this.isChildFilterPresent()||this.isAggregateFilterPresent()}isAdvFilterPresent(){return this.isAdvFilterEnabled()&&this.advancedFilter.isFilterPresent()}onAdvFilterEnabledChanged(t){t?this.colFilter?.disableFilters()&&this.onFilterChanged({source:"advancedFilter"}):this.advancedFilter?.isFilterPresent()&&(this.advancedFilter.setModel(null),this.onFilterChanged({source:"advancedFilter"}))}isAdvFilterEnabled(){return!!this.advancedFilter?.isEnabled()}isAdvFilterHeaderActive(){return this.isAdvFilterEnabled()&&this.advancedFilter.isHeaderActive()}refreshFiltersForAggregations(){$y(this.gos)&&this.isAnyFilterPresent()&&this.onFilterChanged()}onFilterChanged(t={}){let{source:e,additionalEventAttributes:i,columns:n=[]}=t;this.externalFilterPresent=this.isExternalFilterPresentCallback(),(this.colFilter?this.colFilter.updateBeforeFilterChanged(t):Et.resolve()).then(()=>{let r={source:e,type:"filterChanged",columns:n};i&&Vi(r,i),this.eventSvc.dispatchEvent(r),this.colFilter?.updateAfterFilterChanged()})}isSuppressFlashingCellsBecauseFiltering(){return!!this.colFilter?.isSuppressFlashingCellsBecauseFiltering()}isQuickFilterPresent(){return!!this.quickFilter?.isFilterPresent()}updateAggFiltering(){this.aggFiltering=!!$y(this.gos)}isAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&this.shouldApplyQuickFilterAfterAgg()}isNonAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&!this.shouldApplyQuickFilterAfterAgg()}shouldApplyQuickFilterAfterAgg(){return(this.aggFiltering||this.beans.colModel.isPivotMode())&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")}doesRowPassOtherFilters(t,e){return this.doesRowPassFilter({rowNode:e,colIdToSkip:t})}doesRowPassAggregateFilters(t){let{rowNode:e}=t;return this.alwaysPassFilter?.(e)?!0:!(this.isAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(e)||this.isAggregateFilterPresent()&&!this.colFilter.doFiltersPass(e,t.colIdToSkip,!0))}doesRowPassFilter(t){let{rowNode:e}=t;return this.alwaysPassFilter?.(e)?!0:!(this.isNonAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(e)||this.externalFilterPresent&&!this.doesExternalFilterPass(e)||this.isColumnFilterPresent()&&!this.colFilter.doFiltersPass(e,t.colIdToSkip)||this.isAdvFilterPresent()&&!this.advancedFilter.doesFilterPass(e))}isFilterAllowed(t){return this.isAdvFilterEnabled()?!1:!!this.colFilter?.isFilterAllowed(t)}getAdvFilterModel(){return this.isAdvFilterEnabled()?this.advancedFilter.getModel():null}setAdvFilterModel(t,e="api"){if(this.isAdvFilterEnabled()){if(this.beans.dataTypeSvc?.isPendingInference){this.advFilterModelUpdateQueue.push(t);return}this.advancedFilter.setModel(t??null),this.onFilterChanged({source:e})}}toggleAdvFilterBuilder(t,e){this.isAdvFilterEnabled()&&this.advancedFilter.getCtrl().toggleFilterBuilder({source:e,force:t})}updateAdvFilterColumns(){this.isAdvFilterEnabled()&&this.advancedFilter.updateValidity()&&this.onFilterChanged({source:"advancedFilter"})}hasFloatingFilters(){return this.isAdvFilterEnabled()?!1:!!this.colFilter?.hasFloatingFilters()}getColumnFilterInstance(t){return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve(void 0)):this.colFilter?.getFilterInstance(t)??Promise.resolve(void 0)}warnAdvFilters(){K(68)}setupAdvFilterHeaderComp(t){this.advancedFilter?.getCtrl().setupHeaderComp(t)}getHeaderRowCount(){return this.isAdvFilterHeaderActive()?1:0}getHeaderHeight(){return this.isAdvFilterHeaderActive()?this.advancedFilter.getCtrl().getHeaderHeight():0}processFilterModelUpdateQueue(){for(let t of this.advFilterModelUpdateQueue)this.setAdvFilterModel(t);this.advFilterModelUpdateQueue=[]}setColumnFilterModel(t,e){return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve()):this.colFilter?.setModelForColumn(t,e)??Promise.resolve()}},Bne=class extends H{constructor(){super(...arguments),this.beanName="filterMenuFactory"}wireBeans(t){this.popupSvc=t.popupSvc}hideActiveMenu(){this.hidePopup?.()}showMenuAfterMouseEvent(t,e,i,n){t&&!t.isColumn||this.showPopup(t,r=>{this.popupSvc?.positionPopupUnderMouseEvent({column:t,type:i,mouseEvent:e,ePopup:r})},i,e.target,dn(this.gos),n)}showMenuAfterButtonClick(t,e,i,n){if(t&&!t.isColumn)return;let r=-1,o="left",s=dn(this.gos);!s&&this.gos.get("enableRtl")&&(r=1,o="right");let a=s?void 0:4*r,l=s?void 0:4;this.showPopup(t,c=>{this.popupSvc?.positionPopupByComponent({type:i,eventSource:e,ePopup:c,nudgeX:a,nudgeY:l,alignSide:o,keepWithinBounds:!0,position:"under",column:t})},i,e,s,n)}showPopup(t,e,i,n,r,o){let s=t?this.createBean(new wY(t,"COLUMN_MENU")):void 0;if(this.activeMenu=s,!s?.hasFilter()||!t){at(57);return}let a=Nt({tag:"div",cls:`ag-menu${r?"":" ag-filter-menu"}`,role:"presentation"});[this.tabListener]=this.addManagedElementListeners(a,{keydown:g=>this.trapFocusWithin(g,a)}),a.appendChild(s?.getGui());let l,c=()=>s?.afterGuiDetached(),d=Nq(this.gos)?n??this.beans.ctrlsSvc.getGridBodyCtrl().eGridBody:void 0,u=g=>{PT(t,!1,"contextMenu");let m=g instanceof KeyboardEvent;this.tabListener&&(this.tabListener=this.tabListener()),m&&n&&Nr(n)&&EM(n)?.focus({preventScroll:!0}),c(),this.destroyBean(this.activeMenu),this.dispatchVisibleChangedEvent(!1,i,t),o?.()},h=this.getLocaleTextFunc(),p=r&&i!=="columnFilter"?h("ariaLabelColumnMenu","Column Menu"):h("ariaLabelColumnFilter","Column Filter"),f=this.popupSvc?.addPopup({modal:!0,eChild:a,closeOnEsc:!0,closedCallback:u,positionCallback:()=>e(a),anchorToElement:d,ariaLabel:p});f&&(this.hidePopup=l=f.hideFunc),s.afterInit().then(()=>{e(a),s.afterGuiAttached({container:i,hidePopup:l})}),PT(t,!0,"contextMenu"),this.dispatchVisibleChangedEvent(!0,i,t)}trapFocusWithin(t,e){t.key!==A.TAB||t.defaultPrevented||Oa(this.beans,e,!1,t.shiftKey)||(t.preventDefault(),Ta(e,t.shiftKey))}dispatchVisibleChangedEvent(t,e,i){this.eventSvc.dispatchEvent({type:"columnMenuVisibleChanged",visible:t,switchingTab:!1,key:e,column:i??null,columnGroup:null})}isMenuEnabled(t){return t.isFilterAllowed()&&(t.getColDef().menuTabs??["filterMenuTab"]).includes("filterMenuTab")}showMenuAfterContextMenuEvent(){}destroy(){this.destroyBean(this.activeMenu),super.destroy()}},Hne=class extends H{constructor(){super(...arguments),this.beanName="filterValueSvc"}getValue(t,e,i){if(!e)return;let n=t.getColDef(),{selectableFilter:r,valueSvc:o}=this.beans,s=i??r?.getFilterValueGetter(t.getColId())??n.filterValueGetter;return s?this.executeFilterValueGetter(s,e.data,t,e,n):o.getValue(t,e)}executeFilterValueGetter(t,e,i,n,r){let{expressionSvc:o,valueSvc:s}=this.beans,a=Ee(this.gos,{data:e,node:n,column:i,colDef:r,getValue:s.getValueCallback.bind(s,n)});return typeof t=="function"?t(a):o?.evaluate(t,a)}},zne={tag:"div",cls:"ag-floating-filter-input",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eFloatingFilterText"}]},Vne=class extends et{constructor(){super(zne,[zm]),this.eFloatingFilterText=re}init(t){this.params=t;let e=this.beans.colNames.getDisplayNameForColumn(t.column,"header",!0);if(this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(`${e} ${this.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`),this.gos.get("enableFilterHandlers")){let i=t,n=i.getHandler();if(n.getModelAsString){let r=n.getModelAsString(i.model);this.eFloatingFilterText.setValue(r)}}}onParentModelChanged(t){if(t==null){this.eFloatingFilterText.setValue("");return}this.params.parentFilterInstance(e=>{if(e.getModelAsString){let i=e.getModelAsString(t);this.eFloatingFilterText.setValue(i)}})}refresh(t){this.init(t)}},l2=class{constructor(){this.customFilterOptions={}}init(t,e){this.filterOptions=t.filterOptions??e,this.mapCustomOptions(),this.defaultOption=this.getDefaultItem(t.defaultOption)}refresh(t,e){let i=t.filterOptions??e;this.filterOptions!==i&&(this.filterOptions=i,this.customFilterOptions={},this.mapCustomOptions()),this.defaultOption=this.getDefaultItem(t.defaultOption)}mapCustomOptions(){let{filterOptions:t}=this;if(t)for(let e of t){if(typeof e=="string")continue;let i=[["displayKey"],["displayName"],["predicate","test"]],n=r=>r.some(o=>e[o]!=null)?!0:(K(72,{keys:r}),!1);if(!i.every(n)){this.filterOptions=t.filter(r=>r===e)||[];continue}this.customFilterOptions[e.displayKey]=e}}getDefaultItem(t){let{filterOptions:e}=this;if(t)return t;if(e.length>=1){let i=e[0];if(typeof i=="string")return i;if(i.displayKey)return i.displayKey;K(73)}else K(74)}getCustomOption(t){return this.customFilterOptions[t]}};function nh(t,e,i){return i==null?t.splice(e):t.splice(e,i)}function Om(t){return t==null||typeof t=="string"&&t.trim().length===0}function Gne(t){return t==="AND"||t==="OR"?t:"AND"}function Wne(t,e,i){if(t==null)return;let{predicate:n}=t;if(n!=null&&!e.some(r=>r==null))return n(e,i)}function Une(t,e){let i=t.length;return i>e&&(t.splice(e),K(78),i=e),i}function mh(t,e){let i=e.getCustomOption(t);if(i){let{numberOfInputs:r}=i;return r??1}return t&&["empty","notBlank","blank"].indexOf(t)>=0?0:t==="inRange"?2:1}var c2=class extends kY{constructor(t,e,i){super(t,"simple-filter"),this.mapValuesFromModel=e,this.defaultOptions=i,this.eTypes=[],this.eJoinPanels=[],this.eJoinAnds=[],this.eJoinOrs=[],this.eConditionBodies=[],this.listener=()=>this.onUiChanged(),this.lastUiCompletePosition=null,this.joinOperatorId=0}setParams(t){super.setParams(t);let e=new l2;this.optionsFactory=e,e.init(t,this.defaultOptions),this.commonUpdateSimpleParams(t),this.createOption(),this.createMissingConditionsAndOperators()}updateParams(t,e){this.optionsFactory.refresh(t,this.defaultOptions),super.updateParams(t,e),this.commonUpdateSimpleParams(t)}commonUpdateSimpleParams(t){this.setNumConditions(t),this.defaultJoinOperator=Gne(t.defaultJoinOperator),this.filterPlaceholder=t.filterPlaceholder,this.createFilterListOptions();let e=this.getGui();this.isReadOnly()?e.setAttribute("tabindex","-1"):e.removeAttribute("tabindex")}onFloatingFilterChanged(t,e){this.setTypeFromFloatingFilter(t),this.setValueFromFloatingFilter(e),this.onUiChanged("immediately",!0)}setTypeFromFloatingFilter(t){this.eTypes.forEach((e,i)=>{let n=i===0?t:this.optionsFactory.defaultOption;e.setValue(n,!0)})}getModelFromUi(){let t=this.getUiCompleteConditions();return t.length===0?null:this.maxNumConditions>1&&t.length>1?{filterType:this.filterType,operator:this.getJoinOperator(),conditions:t}:t[0]}getConditionTypes(){return this.eTypes.map(t=>t.getValue())}getConditionType(t){return this.eTypes[t].getValue()}getJoinOperator(){let{eJoinOrs:t,defaultJoinOperator:e}=this;return t.length===0?e:t[0].getValue()===!0?"OR":"AND"}areNonNullModelsEqual(t,e){let i=!t.operator,n=!e.operator;if(!i&&n||i&&!n)return!1;let o;if(i){let s=t,a=e;o=this.areSimpleModelsEqual(s,a)}else{let s=t,a=e;o=s.operator===a.operator&&xs(s.conditions,a.conditions,(l,c)=>this.areSimpleModelsEqual(l,c))}return o}setModelIntoUi(t,e){if(t==null)return this.resetUiToDefaults(e),Et.resolve();if(t.operator){let n=t,r=n.conditions;r==null&&(r=[],K(77));let o=Une(r,this.maxNumConditions),s=this.getNumConditions();if(o<s)this.removeConditionsAndOperators(o);else if(o>s)for(let l=s;l<o;l++)this.createJoinOperatorPanel(),this.createOption();let a=n.operator==="OR";this.eJoinAnds.forEach(l=>l.setValue(!a,!0)),this.eJoinOrs.forEach(l=>l.setValue(a,!0)),r.forEach((l,c)=>{this.eTypes[c].setValue(l.type,!0),this.setConditionIntoUi(l,c)})}else{let n=t;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(n.type,!0),this.setConditionIntoUi(n,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.updateUiVisibility(),e||this.params.onUiChange(this.getUiChangeEventParams()),Et.resolve()}setNumConditions(t){let e=t.maxNumConditions??2;e<1&&(K(79),e=1),this.maxNumConditions=e;let i=t.numAlwaysVisibleConditions??1;i<1&&(K(80),i=1),i>e&&(K(81),i=e),this.numAlwaysVisibleConditions=i}createOption(){let t=this.getGui(),e=this.createManagedBean(new zS);this.eTypes.push(e),e.addCss("ag-filter-select"),t.appendChild(e.getGui());let i=this.createEValue();this.eConditionBodies.push(i),t.appendChild(i),this.putOptionsIntoDropdown(e),this.resetType(e);let n=this.getNumConditions()-1;this.forEachPositionInput(n,r=>this.resetInput(r)),this.addChangedListeners(e,n)}createJoinOperatorPanel(){let t=Nt({tag:"div",cls:"ag-filter-condition"});this.eJoinPanels.push(t);let e=this.createJoinOperator(this.eJoinAnds,t,"and"),i=this.createJoinOperator(this.eJoinOrs,t,"or");this.getGui().appendChild(t);let n=this.eJoinPanels.length-1,r=this.joinOperatorId++;this.resetJoinOperatorAnd(e,n,r),this.resetJoinOperatorOr(i,n,r),this.isReadOnly()||(e.onValueChange(this.listener),i.onValueChange(this.listener))}createJoinOperator(t,e,i){let n=this.createManagedBean(new oK);t.push(n);let r="ag-filter-condition-operator";return n.addCss(r),n.addCss(`${r}-${i}`),e.appendChild(n.getGui()),n}createFilterListOptions(){this.filterListOptions=this.optionsFactory.filterOptions.map(t=>typeof t=="string"?this.createBoilerplateListOption(t):this.createCustomListOption(t))}putOptionsIntoDropdown(t){let{filterListOptions:e}=this;for(let i of e)t.addOption(i);t.setDisabled(e.length<=1)}createBoilerplateListOption(t){return{value:t,text:this.translate(t)}}createCustomListOption(t){let{displayKey:e}=t,i=this.optionsFactory.getCustomOption(t.displayKey);return{value:e,text:i?this.getLocaleTextFunc()(i.displayKey,i.displayName):this.translate(e)}}createBodyTemplate(){return null}getAgComponents(){return[]}updateUiVisibility(){let t=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,t)}updateNumConditions(){let t=-1,e=!0;for(let i=0;i<this.getNumConditions();i++)this.isConditionUiComplete(i)?t=i:e=!1;if(this.shouldAddNewConditionAtEnd(e))this.createJoinOperatorPanel(),this.createOption();else{let i=this.lastUiCompletePosition??this.getNumConditions()-2;if(t<i){this.removeConditionsAndOperators(i+1);let n=t+1,r=i-n;r>0&&this.removeConditionsAndOperators(n,r),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=t}updateConditionStatusesAndValues(t,e){this.eTypes.forEach((n,r)=>{let o=this.isConditionDisabled(r,t);n.setDisabled(o||this.filterListOptions.length<=1),r===1&&(sh(this.eJoinPanels[0],o),this.eJoinAnds[0].setDisabled(o),this.eJoinOrs[0].setDisabled(o))}),this.eConditionBodies.forEach((n,r)=>{Ct(n,this.isConditionBodyVisible(r))});let i=(e??this.getJoinOperator())==="OR";for(let n of this.eJoinAnds)n.setValue(!i,!0);for(let n of this.eJoinOrs)n.setValue(i,!0);this.forEachInput((n,r,o,s)=>{this.setElementDisplayed(n,r<s),this.setElementDisabled(n,this.isConditionDisabled(o,t))}),this.resetPlaceholder()}shouldAddNewConditionAtEnd(t){return t&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}removeConditionsAndOperators(t,e){if(t>=this.getNumConditions())return;let{eTypes:i,eConditionBodies:n,eJoinPanels:r,eJoinAnds:o,eJoinOrs:s}=this;this.removeComponents(i,t,e),this.removeElements(n,t,e),this.removeEValues(t,e);let a=Math.max(t-1,0);this.removeElements(r,a,e),this.removeComponents(o,a,e),this.removeComponents(s,a,e)}removeElements(t,e,i){let n=nh(t,e,i);for(let r of n)Xi(r)}removeComponents(t,e,i){let n=nh(t,e,i);for(let r of n)Xi(r.getGui()),this.destroyBean(r)}afterGuiAttached(t){if(super.afterGuiAttached(t),this.resetPlaceholder(),!t?.suppressFocus){let e;if(!this.isReadOnly()){let i=this.getInputs(0)[0];i instanceof ba&&this.isConditionBodyVisible(0)?e=i.getInputElement():e=this.eTypes[0]?.getFocusableElement()}(e??this.getGui()).focus({preventScroll:!0})}}afterGuiDetached(){super.afterGuiDetached();let t=this.params;if(this.beans.colFilter?.shouldKeepStateOnDetach(t.column))return;t.onStateChange({model:t.model});let e=-1,i=-1,n=!1,r=this.getJoinOperator();for(let s=this.getNumConditions()-1;s>=0;s--)if(this.isConditionUiComplete(s))e===-1&&(e=s,i=s);else{let a=s>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(s-1),l=s<e;(a||l)&&(this.removeConditionsAndOperators(s,1),n=!0,l&&i--)}let o=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),o=!0),this.shouldAddNewConditionAtEnd(i===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),o=!0),o&&this.updateConditionStatusesAndValues(i,r),n&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=i}getModelAsString(t){return this.params.getHandler()?.getModelAsString?.(t)??""}getPlaceholderText(t,e){let i=this.translate(t);if(typeof this.filterPlaceholder=="function"){let n=this.eTypes[e].getValue(),r=this.translate(n);i=this.filterPlaceholder({filterOptionKey:n,filterOption:r,placeholder:i})}else typeof this.filterPlaceholder=="string"&&(i=this.filterPlaceholder);return i}resetPlaceholder(){let t=this.getLocaleTextFunc();this.forEachInput((e,i,n,r)=>{if(!(e instanceof ba))return;let o=i===0&&r>1?"inRangeStart":i===0?"filterOoo":"inRangeEnd",s=i===0&&r>1?t("ariaFilterFromValue","Filter from value"):i===0?t("ariaFilterValue","Filter Value"):t("ariaFilterToValue","Filter to Value");e.setInputPlaceholder(this.getPlaceholderText(o,n)),e.setInputAriaLabel(s)})}setElementValue(t,e,i){t instanceof ba&&t.setValue(e!=null?String(e):null,!0)}setElementDisplayed(t,e){sT(t)&&Ct(t.getGui(),e)}setElementDisabled(t,e){sT(t)&&sh(t.getGui(),e)}attachElementOnChange(t,e){t instanceof ba&&t.onValueChange(e)}forEachInput(t){this.getConditionTypes().forEach((e,i)=>{this.forEachPositionTypeInput(i,e,t)})}forEachPositionInput(t,e){let i=this.getConditionType(t);this.forEachPositionTypeInput(t,i,e)}forEachPositionTypeInput(t,e,i){let n=mh(e,this.optionsFactory),r=this.getInputs(t);for(let o=0;o<r.length;o++){let s=r[o];s!=null&&i(s,o,t,n)}}isConditionDisabled(t,e){return this.isReadOnly()?!0:t===0?!1:t>e+1}isConditionBodyVisible(t){let e=this.getConditionType(t);return mh(e,this.optionsFactory)>0}isConditionUiComplete(t){return!(t>=this.getNumConditions()||this.getConditionType(t)==="empty"||this.getValues(t).some(i=>i==null))}getNumConditions(){return this.eTypes.length}getUiCompleteConditions(){let t=[];for(let e=0;e<this.getNumConditions();e++)this.isConditionUiComplete(e)&&t.push(this.createCondition(e));return t}createMissingConditionsAndOperators(){if(!this.isReadOnly())for(let t=this.getNumConditions();t<this.numAlwaysVisibleConditions;t++)this.createJoinOperatorPanel(),this.createOption()}resetUiToDefaults(t){this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach(e=>this.resetType(e)),this.eJoinAnds.forEach((e,i)=>this.resetJoinOperatorAnd(e,i,this.joinOperatorId+i)),this.eJoinOrs.forEach((e,i)=>this.resetJoinOperatorOr(e,i,this.joinOperatorId+i)),this.joinOperatorId++,this.forEachInput(e=>this.resetInput(e)),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,this.updateUiVisibility(),t||this.params.onUiChange(this.getUiChangeEventParams())}resetType(t){let i=this.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");t.setValue(this.optionsFactory.defaultOption,!0).setAriaLabel(i).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}resetJoinOperatorAnd(t,e,i){this.resetJoinOperator(t,e,this.defaultJoinOperator==="AND",this.translate("andCondition"),i)}resetJoinOperatorOr(t,e,i){this.resetJoinOperator(t,e,this.defaultJoinOperator==="OR",this.translate("orCondition"),i)}resetJoinOperator(t,e,i,n,r){this.updateJoinOperatorDisabled(t.setValue(i,!0).setName(`ag-simple-filter-and-or-${this.getCompId()}-${r}`).setLabel(n),e)}updateJoinOperatorsDisabled(){let t=(e,i)=>this.updateJoinOperatorDisabled(e,i);this.eJoinAnds.forEach(t),this.eJoinOrs.forEach(t)}updateJoinOperatorDisabled(t,e){t.setDisabled(this.isReadOnly()||e>0)}resetInput(t){this.setElementValue(t,null),this.setElementDisabled(t,this.isReadOnly())}setConditionIntoUi(t,e){let i=this.mapValuesFromModel(t,this.optionsFactory);this.forEachInput((n,r,o)=>{o===e&&this.setElementValue(n,i[r]!=null?i[r]:null)})}setValueFromFloatingFilter(t){this.forEachInput((e,i,n)=>{this.setElementValue(e,i===0&&n===0?t:null,!0)})}addChangedListeners(t,e){this.isReadOnly()||(t.onValueChange(this.listener),this.forEachPositionInput(e,i=>{this.attachElementOnChange(i,this.listener)}))}hasInvalidInputs(){return!1}isReadOnly(){return!!this.params.readOnly}},Y8=class{constructor(t,e,i,n,r,o){this.alive=!0,this.context=t,this.eParent=r;let s=z$(e,i,n);s&&s.newAgStackInstance().then(a=>{if(!this.alive){t.destroyBean(a);return}if(this.dateComp=a,!a)return;r.appendChild(a.getGui()),a?.afterGuiAttached?.();let{tempValue:l,disabled:c}=this;l&&a.setDate(l),c!=null&&a.setDisabled?.(c),o?.(this)})}destroy(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)}getDate(){return this.dateComp?this.dateComp.getDate():this.tempValue}setDate(t){let e=this.dateComp;e?e.setDate(t):this.tempValue=t}setDisabled(t){let e=this.dateComp;e?e.setDisabled?.(t):this.disabled=t}setDisplayed(t){Ct(this.eParent,t)}setInputPlaceholder(t){this.dateComp?.setInputPlaceholder?.(t)}setInputAriaLabel(t){this.dateComp?.setInputAriaLabel?.(t)}afterGuiAttached(t){this.dateComp?.afterGuiAttached?.(t)}updateParams(t){this.dateComp?.refresh?.(t)}},d2=["equals","notEqual","lessThan","greaterThan","inRange","blank","notBlank"];function X8(t,e){let{dateFrom:i,dateTo:n,type:r}=t||{};return[i&&Ji(i,void 0,!0)||null,n&&Ji(n,void 0,!0)||null].slice(0,mh(r,e))}var sD=1e3,aD=1/0,jne=class extends c2{constructor(){super("dateFilter",X8,d2),this.eConditionPanelsFrom=[],this.eConditionPanelsTo=[],this.dateConditionFromComps=[],this.dateConditionToComps=[],this.minValidYear=sD,this.maxValidYear=aD,this.minValidDate=null,this.maxValidDate=null,this.filterType="date"}afterGuiAttached(t){super.afterGuiAttached(t),this.dateConditionFromComps[0].afterGuiAttached(t)}commonUpdateSimpleParams(t){super.commonUpdateSimpleParams(t);let e=(l,c)=>{let d=t[l];if(d!=null)if(isNaN(d))K(82,{param:l});else return d==null?c:Number(d);return c},i=e("minValidYear",sD),n=e("maxValidYear",aD);this.minValidYear=i,this.maxValidYear=n,i>n&&K(83);let{minValidDate:r,maxValidDate:o}=t,s=r instanceof Date?r:Ji(r);this.minValidDate=s;let a=o instanceof Date?o:Ji(o);this.maxValidDate=a,s&&a&&s>a&&K(84)}createDateCompWrapper(t){let{beans:{userCompFactory:e,context:i,gos:n},params:r}=this,o=new Y8(i,e,r.colDef,Ee(n,{onDateChanged:()=>this.onUiChanged(),filterParams:r,location:"filter"}),t);return this.addDestroyFunc(()=>o.destroy()),o}setElementValue(t,e){t.setDate(e)}setElementDisplayed(t,e){t.setDisplayed(e)}setElementDisabled(t,e){t.setDisabled(e)}createEValue(){let t=Nt({tag:"div",cls:"ag-filter-body"});return this.createFromToElement(t,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(t,this.eConditionPanelsTo,this.dateConditionToComps,"to"),t}createFromToElement(t,e,i,n){let r=Nt({tag:"div",cls:`ag-filter-${n} ag-filter-date-${n}`});e.push(r),t.appendChild(r),i.push(this.createDateCompWrapper(r))}removeEValues(t,e){this.removeDateComps(this.dateConditionFromComps,t,e),this.removeDateComps(this.dateConditionToComps,t,e),nh(this.eConditionPanelsFrom,t,e),nh(this.eConditionPanelsTo,t,e)}removeDateComps(t,e,i){let n=nh(t,e,i);for(let r of n)r.destroy()}isValidDateValue(t){if(t===null)return!1;let{minValidDate:e,maxValidDate:i,minValidYear:n,maxValidYear:r}=this;if(e){if(t<e)return!1}else if(t.getUTCFullYear()<n)return!1;if(i){if(t>i)return!1}else if(t.getUTCFullYear()>r)return!1;return!0}isConditionUiComplete(t){if(!super.isConditionUiComplete(t))return!1;let e=!0;return this.forEachInput((i,n,r,o)=>{r!==t||!e||n>=o||(e=e&&this.isValidDateValue(i.getDate()))}),e}areSimpleModelsEqual(t,e){return t.dateFrom===e.dateFrom&&t.dateTo===e.dateTo&&t.type===e.type}createCondition(t){let e=this.getConditionType(t),i={},n=this.getValues(t),r=this.params.useIsoSeparator?"T":" ";return n.length>0&&(i.dateFrom=un(n[0],!0,r)),n.length>1&&(i.dateTo=un(n[1],!0,r)),w({dateFrom:null,dateTo:null,filterType:this.filterType,type:e},i)}resetPlaceholder(){let t=this.getLocaleTextFunc(),e=this.translate("dateFormatOoo"),i=t("ariaFilterValue","Filter Value");this.forEachInput(n=>{n.setInputPlaceholder(e),n.setInputAriaLabel(i)})}getInputs(t){let{dateConditionFromComps:e,dateConditionToComps:i}=this;return t>=e.length?[null,null]:[e[t],i[t]]}getValues(t){let e=[];return this.forEachPositionInput(t,(i,n,r,o)=>{n<o&&e.push(i.getDate())}),e}translate(t){return t==="lessThan"?super.translate("before"):t==="greaterThan"?super.translate("after"):super.translate(t)}},J8=class extends H{constructor(t,e){super(),this.mapValuesFromModel=t,this.defaultOptions=e}init(t){let e=t.filterParams,i=new l2;this.optionsFactory=i,i.init(e,this.defaultOptions),this.filterModelFormatter=this.createManagedBean(new this.FilterModelFormatterClass(i,e)),this.updateParams(t),this.validateModel(t)}refresh(t){if(t.source==="colDef"){let e=t.filterParams,i=this.optionsFactory;i.refresh(e,this.defaultOptions),this.filterModelFormatter.updateParams({optionsFactory:i,filterParams:e}),this.updateParams(t)}this.validateModel(t)}updateParams(t){this.params=t}doesFilterPass(t){let e=t.model;if(e==null)return!0;let{operator:i}=e,n=[];if(i){let s=e;n.push(...s.conditions??[])}else n.push(e);let r=i&&i==="OR"?"some":"every",o=this.params.getValue(t.node);return n[r](s=>this.individualConditionPasses(t,s,o))}getModelAsString(t,e){return this.filterModelFormatter.getModelAsString(t,e)??""}validateModel(t){let{model:e,filterParams:{filterOptions:i,maxNumConditions:n}}=t;if(e==null)return;let o=jM(e)?e.conditions:[e],s=i?.map(d=>typeof d=="string"?d:d.displayKey)??this.defaultOptions;if(!(!o||o.every(d=>s.find(u=>u===d.type)!==void 0))){this.params=k(w({},t),{model:null}),t.onModelChange(null);return}let l=!1,c=this.filterType;if((o&&!o.every(d=>d.filterType===c)||e.filterType!==c)&&(o=o.map(d=>k(w({},d),{filterType:c})),l=!0),typeof n=="number"&&o&&o.length>n&&(o=o.slice(0,n),l=!0),l){let d=o.length>1?k(w({},e),{filterType:c,conditions:o}):k(w({},o[0]),{filterType:c});this.params=k(w({},t),{model:d}),t.onModelChange(d)}}individualConditionPasses(t,e,i){let n=this.optionsFactory,r=this.mapValuesFromModel(e,n),o=n.getCustomOption(e.type),s=Wne(o,r,i);return s??(i==null?this.evaluateNullValue(e.type):this.evaluateNonNullValue(r,i,e,t))}},Q8=class extends J8{evaluateNullValue(t){let{includeBlanksInEquals:e,includeBlanksInNotEqual:i,includeBlanksInGreaterThan:n,includeBlanksInLessThan:r,includeBlanksInRange:o}=this.params.filterParams;switch(t){case"equals":if(e)return!0;break;case"notEqual":if(i)return!0;break;case"greaterThan":case"greaterThanOrEqual":if(n)return!0;break;case"lessThan":case"lessThanOrEqual":if(r)return!0;break;case"inRange":if(o)return!0;break;case"blank":return!0;case"notBlank":return!1}return!1}evaluateNonNullValue(t,e,i){let n=i.type;if(!this.isValid(e))return n==="notEqual"||n==="notBlank";let r=this.comparator(),o=t[0]!=null?r(t[0],e):0;switch(n){case"equals":return o===0;case"notEqual":return o!==0;case"greaterThan":return o>0;case"greaterThanOrEqual":return o>=0;case"lessThan":return o<0;case"lessThanOrEqual":return o<=0;case"inRange":{let s=r(t[1],e);return this.params.filterParams.inRangeInclusive?o>=0&&s<=0:o>0&&s<0}case"blank":return Om(e);case"notBlank":return!Om(e);default:return K(76,{filterModelType:n}),!0}}},Z8={equals:"Equals",notEqual:"NotEqual",greaterThan:"GreaterThan",greaterThanOrEqual:"GreaterThanOrEqual",lessThan:"LessThan",lessThanOrEqual:"LessThanOrEqual",inRange:"InRange"},qne={contains:"Contains",notContains:"NotContains",equals:"TextEquals",notEqual:"TextNotEqual",startsWith:"StartsWith",endsWith:"EndsWith",inRange:"InRange"},u2=class extends H{constructor(t,e,i){super(),this.optionsFactory=t,this.filterParams=e,this.valueFormatter=i}getModelAsString(t,e){let i=this.getLocaleTextFunc(),n=e==="filterToolPanel";if(!t)return n?ms(this,"filterSummaryInactive"):null;if(t.operator!=null){let o=t,a=(o.conditions??[]).map(c=>this.getModelAsString(c,e)),l=o.operator==="AND"?"andCondition":"orCondition";return a.join(` ${ms(this,l)} `)}else{if(t.type==="blank"||t.type==="notBlank")return n?ms(this,t.type==="blank"?"filterSummaryBlank":"filterSummaryNotBlank"):i(t.type,t.type);{let o=t,s=this.optionsFactory.getCustomOption(o.type),{displayKey:a,displayName:l,numberOfInputs:c}=s||{};return a&&l&&c===0?i(a,l):this.conditionToString(o,n,o.type==="inRange"||c===2,a,l)}}}updateParams(t){let{optionsFactory:e,filterParams:i}=t;this.optionsFactory=e,this.filterParams=i}conditionForToolPanel(t,e,i,n,r,o){let s,a=this.getTypeKey(t);return a&&(s=ms(this,a)),r&&o&&(s=this.getLocaleTextFunc()(r,o)),s!=null?e?`${s} ${ms(this,"filterSummaryInRangeValues",[i(),n()])}`:`${s} ${i()}`:null}getTypeKey(t){let e=this.filterTypeKeys[t];return e?`filterSummary${e}`:null}formatValue(t){let e=this.valueFormatter;return e?e(t??null)??"":String(t)}},eI=class extends u2{constructor(t,e){super(t,e,i=>{let{dataTypeSvc:n,valueSvc:r}=this.beans,o=e.column,s=n?.getDateFormatterFunction(o),a=s?s(i??void 0):i;return r.formatValue(o,null,a)}),this.filterTypeKeys=Z8}conditionToString(t,e,i,n,r){let{type:o}=t,s=Ji(t.dateFrom),a=Ji(t.dateTo),l=this.filterParams.inRangeFloatingFilterDateFormat,c=e?this.formatValue.bind(this):h=>Zy(h,l),d=()=>s!==null?c(s):"null",u=()=>a!==null?c(a):"null";if(e){let h=this.conditionForToolPanel(o,i,d,u,n,r);if(h!=null)return h}return i?`${d()}-${u()}`:s!=null?c(s):`${o}`}};function $ne(t,e){let i=e;return i<t?-1:i>t?1:0}var Kne=class extends Q8{constructor(){super(X8,d2),this.filterType="date",this.FilterModelFormatterClass=eI}comparator(){return this.params.filterParams.comparator??$ne}isValid(t){let e=this.params.filterParams.isValidDate;return!e||e(t)}},tI=class extends et{constructor(){super(...arguments),this.defaultDebounceMs=0}setLastTypeFromModel(t){if(!t){this.lastType=this.optionsFactory.defaultOption;return}let e=t.operator,i;e?i=t.conditions[0]:i=t,this.lastType=i.type}canWeEditAfterModelFromParentFilter(t){if(!t)return this.isTypeEditable(this.lastType);if(t.operator)return!1;let i=t;return this.isTypeEditable(i.type)}init(t){this.params=t;let e=this.gos.get("enableFilterHandlers");if(this.reactive=e,this.setParams(t),e){let i=t;this.onModelUpdated(i.model)}}setParams(t){let e=new l2;this.optionsFactory=e,e.init(t.filterParams,this.defaultOptions),this.filterModelFormatter=this.createManagedBean(new this.FilterModelFormatterClass(e,t.filterParams)),this.setSimpleParams(t,!1)}setSimpleParams(t,e=!0){let i=this.optionsFactory.defaultOption;e||(this.lastType=i),this.readOnly=!!t.filterParams.readOnly;let n=this.isTypeEditable(i);this.setEditable(n)}refresh(t){this.params=t;let e=t,i=this.reactive;if((!i||e.source==="colDef")&&this.updateParams(t),i){let{source:n,model:r}=e;if(n==="dataChanged"||n==="ui")return;this.onModelUpdated(r)}}updateParams(t){let e=this.optionsFactory;e.refresh(t.filterParams,this.defaultOptions),this.setSimpleParams(t),this.filterModelFormatter.updateParams({optionsFactory:e,filterParams:t.filterParams})}onParentModelChanged(t,e){e?.afterFloatingFilter||e?.afterDataChange||this.onModelUpdated(t)}hasSingleInput(t){let e=this.optionsFactory.getCustomOption(t)?.numberOfInputs;return e==null||e==1}isTypeEditable(t){let e=["inRange","empty","blank","notBlank"];return!!t&&!this.readOnly&&this.hasSingleInput(t)&&e.indexOf(t)<0}getAriaLabel(t){return`${this.beans.colNames.getDisplayNameForColumn(t.column,"header",!0)} ${this.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`}},Yne={tag:"div",cls:"ag-floating-filter-input",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eReadOnlyText"},{tag:"div",ref:"eDateWrapper",cls:"ag-date-floating-filter-wrapper"}]},Xne=class extends tI{constructor(){super(Yne,[zm]),this.eReadOnlyText=re,this.eDateWrapper=re,this.FilterModelFormatterClass=eI,this.filterType="date",this.defaultOptions=d2}setParams(t){super.setParams(t),this.createDateComponent();let e=this.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(e("ariaDateFilterInput","Date Filter Input"))}updateParams(t){super.updateParams(t),this.dateComp.updateParams(this.getDateComponentParams()),this.updateCompOnModelChange(t.currentParentModel())}updateCompOnModelChange(t){let e=!this.readOnly&&this.canWeEditAfterModelFromParentFilter(t);if(this.setEditable(e),e){let i=t?Ji(t.dateFrom):null;this.dateComp.setDate(i),this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(t)),this.dateComp.setDate(null)}setEditable(t){Ct(this.eDateWrapper,t),Ct(this.eReadOnlyText.getGui(),!t)}onModelUpdated(t){super.setLastTypeFromModel(t),this.updateCompOnModelChange(t)}onDateChanged(){let t=this.dateComp.getDate();if(this.reactive){let e=this.params;e.onUiChange();let i=e.model,n=un(t),r=n==null?null:k(w({},i??{filterType:this.filterType,type:this.lastType??this.optionsFactory.defaultOption}),{dateFrom:n});e.onModelChange(r,{afterFloatingFilter:!0})}else this.params.parentFilterInstance(e=>{e?.onFloatingFilterChanged(this.lastType||null,t)})}getDateComponentParams(){let{filterParams:t}=this.params,e=jS(t,this.defaultDebounceMs);return Ee(this.gos,{onDateChanged:ui(this,this.onDateChanged.bind(this),e),filterParams:t,location:"floatingFilter"})}createDateComponent(){let{beans:{context:t,userCompFactory:e},eDateWrapper:i,params:n}=this;this.dateComp=new Y8(t,e,n.column.getColDef(),this.getDateComponentParams(),i,r=>{r.setInputAriaLabel(this.getAriaLabel(n))}),this.addDestroyFunc(()=>this.dateComp.destroy())}},Jne={tag:"div",cls:"ag-filter-filter",children:[{tag:"ag-input-text-field",ref:"eDateInput",cls:"ag-date-filter"}]},Qne=class extends et{constructor(){super(Jne,[zm]),this.eDateInput=re,this.isApply=!1,this.applyOnFocusOut=!1}init(t){this.params=t,this.setParams(t);let e=this.eDateInput.getInputElement();this.addManagedListeners(e,{mouseDown:()=>{this.eDateInput.isDisabled()||this.usingSafariDatePicker||e.focus({preventScroll:!0})},input:this.handleInput.bind(this,!1),change:this.handleInput.bind(this,!0),focusout:this.handleFocusOut.bind(this)})}handleInput(t){if(!this.eDateInput.isDisabled()){if(this.isApply){this.applyOnFocusOut=!t,t&&this.params.onDateChanged();return}t||this.params.onDateChanged()}}handleFocusOut(){this.applyOnFocusOut&&(this.applyOnFocusOut=!1,this.params.onDateChanged())}setParams(t){let e=this.eDateInput.getInputElement(),i=this.shouldUseBrowserDatePicker(t);this.usingSafariDatePicker=i&&Es();let{minValidYear:n,maxValidYear:r,minValidDate:o,maxValidDate:s,buttons:a,includeTime:l,colDef:c}=t.filterParams||{},d=this.beans.dataTypeSvc,u=l??d?.getDateIncludesTimeFlag?.(c.cellDataType)??!1;if(i?u?(e.type="datetime-local",e.step="1"):e.type="date":e.type="text",o&&n&&K(85),s&&r&&K(86),o&&s){let[h,p]=[o,s].map(f=>f instanceof Date?f:Ji(f));h&&p&&h.getTime()>p.getTime()&&K(87)}o?o instanceof Date?e.min=Zy(o):e.min=o:n&&(e.min=`${n}-01-01`),s?s instanceof Date?e.max=Zy(s):e.max=s:r&&(e.max=`${r}-12-31`),this.isApply=t.location==="floatingFilter"&&!!a?.includes("apply")}refresh(t){this.params=t,this.setParams(t)}getDate(){return Ji(this.eDateInput.getValue())}setDate(t){let e=this.params.filterParams.colDef.cellDataType,i=this.beans.dataTypeSvc?.getDateIncludesTimeFlag(e)??!1;this.eDateInput.setValue(un(t,i))}setInputPlaceholder(t){this.eDateInput.setInputPlaceholder(t)}setInputAriaLabel(t){this.eDateInput.setAriaLabel(t)}setDisabled(t){this.eDateInput.setDisabled(t)}afterGuiAttached(t){t?.suppressFocus||this.eDateInput.getInputElement().focus({preventScroll:!0})}shouldUseBrowserDatePicker(t){return t?.filterParams?.browserDatePicker??!0}},h2=["equals","notEqual","greaterThan","greaterThanOrEqual","lessThan","lessThanOrEqual","inRange","blank","notBlank"];function CS(t){let{allowedCharPattern:e}=t??{};return e??null}function wS(t){return t==null||isNaN(t)?null:t}function iI(t,e){let{filter:i,filterTo:n,type:r}=t||{};return[wS(i),wS(n)].slice(0,mh(r,e))}var Zne=class extends c2{constructor(){super("numberFilter",iI,h2),this.eValuesFrom=[],this.eValuesTo=[],this.filterType="number",this.defaultDebounceMs=500}setElementValue(t,e,i){let{numberFormatter:n}=this.params,r=!i&&n?n(e??null):e;super.setElementValue(t,r)}createEValue(){let t=CS(this.params),e=Nt({tag:"div",cls:"ag-filter-body",role:"presentation"});return this.createFromToElement(e,this.eValuesFrom,"from",t),this.createFromToElement(e,this.eValuesTo,"to",t),e}createFromToElement(t,e,i,n){let r=this.createManagedBean(n?new La({allowedCharPattern:n}):new HS);r.addCss(`ag-filter-${i}`),r.addCss("ag-filter-filter"),e.push(r),t.appendChild(r.getGui())}removeEValues(t,e){let i=n=>this.removeComponents(n,t,e);i(this.eValuesFrom),i(this.eValuesTo)}getValues(t){let e=[];return this.forEachPositionInput(t,(i,n,r,o)=>{n<o&&e.push(wS(this.stringToFloat(i.getValue())))}),e}areSimpleModelsEqual(t,e){return t.filter===e.filter&&t.filterTo===e.filterTo&&t.type===e.type}stringToFloat(t){if(typeof t=="number")return t;let e=Co(t);e!=null&&e.trim()===""&&(e=null);let i=this.params.numberParser;return i?i(e):e==null||e.trim()==="-"?null:Number.parseFloat(e)}createCondition(t){let e=this.getConditionType(t),i={filterType:this.filterType,type:e},n=this.getValues(t);return n.length>0&&(i.filter=n[0]),n.length>1&&(i.filterTo=n[1]),i}getInputs(t){let{eValuesFrom:e,eValuesTo:i}=this;return t>=e.length?[null,null]:[e[t],i[t]]}hasInvalidInputs(){let t=!1;return this.forEachInput(e=>{e.getInputElement().validity.valid||(t=!0)}),t}},nI=class extends u2{constructor(t,e){super(t,e,e.numberFormatter),this.filterTypeKeys=Z8}conditionToString(t,e,i,n,r){let{filter:o,filterTo:s,type:a}=t,l=this.formatValue.bind(this);if(e){let c=this.conditionForToolPanel(a,i,()=>l(o),()=>l(s),n,r);if(c!=null)return c}return i?`${l(o)}-${l(s)}`:o!=null?l(o):`${a}`}},ere=class extends Q8{constructor(){super(iI,h2),this.filterType="number",this.FilterModelFormatterClass=nI}comparator(){return(t,e)=>t===e?0:t<e?1:-1}isValid(t){return!isNaN(t)}},rI=class extends H{constructor(t){super(),this.params=t,this.eInput=re,this.onValueChanged=()=>{}}setupGui(t){this.eInput=this.createManagedBean(new La(this.params?.config));let e=this.eInput.getGui();t.appendChild(e);let i=n=>this.onValueChanged(n);this.addManagedListeners(e,{input:i,keydown:i})}setEditable(t){this.eInput.setDisabled(!t)}getValue(){return this.eInput.getValue()}setValue(t,e){this.eInput.setValue(t,e)}setValueChangedListener(t){this.onValueChanged=t}setParams({ariaLabel:t,autoComplete:e}){let{eInput:i}=this;i.setInputAriaLabel(t),e!==void 0&&i.setAutoComplete(e)}};function bS(t){let e=t?.trim();return e===""?t:e}function oI(t,e){let{filter:i,filterTo:n,type:r}=t||{};return[i||null,n||null].slice(0,mh(r,e))}var tre={tag:"div",ref:"eFloatingFilterInputContainer",cls:"ag-floating-filter-input",role:"presentation"},sI=class extends tI{constructor(){super(...arguments),this.eFloatingFilterInputContainer=re,this.defaultDebounceMs=500}postConstruct(){this.setTemplate(tre)}onModelUpdated(t){this.setLastTypeFromModel(t),this.setEditable(this.canWeEditAfterModelFromParentFilter(t)),this.inputSvc.setValue(this.filterModelFormatter.getModelAsString(t))}setParams(t){this.setupFloatingFilterInputService(t),super.setParams(t),this.setTextInputParams(t)}setupFloatingFilterInputService(t){this.inputSvc=this.createFloatingFilterInputService(t),this.inputSvc.setupGui(this.eFloatingFilterInputContainer)}setTextInputParams(t){let e=t.browserAutoComplete??!1,{inputSvc:i,defaultDebounceMs:n,readOnly:r}=this;if(i.setParams({ariaLabel:this.getAriaLabel(t),autoComplete:e}),this.applyActive=Gm(t.filterParams),!r){let o=jS(t.filterParams,n),s=ui(this,this.syncUpWithParentFilter.bind(this),o);i.setValueChangedListener(s)}}updateParams(t){super.updateParams(t),this.setTextInputParams(t)}recreateFloatingFilterInputService(t){let{inputSvc:e}=this,i=e.getValue();hi(this.eFloatingFilterInputContainer),this.destroyBean(e),this.setupFloatingFilterInputService(t),e.setValue(i,!0)}syncUpWithParentFilter(t){let e=t.key===A.ENTER,i=this.reactive;if(i&&this.params.onUiChange(),this.applyActive&&!e)return;let{inputSvc:n,params:r,lastType:o}=this,s=n.getValue();if(r.filterParams.trimInput&&(s=bS(s),n.setValue(s,!0)),i){let a=r,l=a.model,c=this.convertValue(s),d=c==null?null:k(w({},l??{filterType:this.filterType,type:o??this.optionsFactory.defaultOption}),{filter:c});a.onModelChange(d,{afterFloatingFilter:!0})}else r.parentFilterInstance(a=>{a?.onFloatingFilterChanged(o||null,s||null)})}convertValue(t){return t||null}setEditable(t){this.inputSvc.setEditable(t)}},ire=class extends H{constructor(){super(...arguments),this.onValueChanged=()=>{},this.numberInputActive=!0}setupGui(t){this.eNumberInput=this.createManagedBean(new HS),this.eTextInput=this.createManagedBean(new La),this.eTextInput.setDisabled(!0);let e=this.eNumberInput.getGui(),i=this.eTextInput.getGui();t.appendChild(e),t.appendChild(i),this.setupListeners(e,n=>this.onValueChanged(n)),this.setupListeners(i,n=>this.onValueChanged(n))}setEditable(t){this.numberInputActive=t,this.eNumberInput.setDisplayed(this.numberInputActive),this.eTextInput.setDisplayed(!this.numberInputActive)}setAutoComplete(t){this.eNumberInput.setAutoComplete(t),this.eTextInput.setAutoComplete(t)}getValue(){return this.getActiveInputElement().getValue()}setValue(t,e){this.getActiveInputElement().setValue(t,e)}getActiveInputElement(){return this.numberInputActive?this.eNumberInput:this.eTextInput}setValueChangedListener(t){this.onValueChanged=t}setupListeners(t,e){this.addManagedListeners(t,{input:e,keydown:e})}setParams(t){this.setAriaLabel(t.ariaLabel),t.autoComplete!==void 0&&this.setAutoComplete(t.autoComplete)}setAriaLabel(t){this.eNumberInput.setInputAriaLabel(t),this.eTextInput.setInputAriaLabel(t)}},nre=class extends sI{constructor(){super(...arguments),this.FilterModelFormatterClass=nI,this.filterType="number",this.defaultOptions=h2}updateParams(t){CS(t.filterParams)!==this.allowedCharPattern&&this.recreateFloatingFilterInputService(t),super.updateParams(t)}createFloatingFilterInputService(t){return this.allowedCharPattern=CS(t.filterParams),this.allowedCharPattern?this.createManagedBean(new rI({config:{allowedCharPattern:this.allowedCharPattern}})):this.createManagedBean(new ire)}convertValue(t){return t?Number(t):null}},p2=["contains","notContains","equals","notEqual","startsWith","endsWith","blank","notBlank"],rre=class extends c2{constructor(){super("textFilter",oI,p2),this.filterType="text",this.eValuesFrom=[],this.eValuesTo=[],this.defaultDebounceMs=500}createCondition(t){let e=this.getConditionType(t),i={filterType:this.filterType,type:e},n=this.getValues(t);return n.length>0&&(i.filter=n[0]),n.length>1&&(i.filterTo=n[1]),i}areSimpleModelsEqual(t,e){return t.filter===e.filter&&t.filterTo===e.filterTo&&t.type===e.type}getInputs(t){let{eValuesFrom:e,eValuesTo:i}=this;return t>=e.length?[null,null]:[e[t],i[t]]}getValues(t){let e=[];return this.forEachPositionInput(t,(i,n,r,o)=>{n<o&&e.push(Co(i.getValue()))}),e}createEValue(){let t=Nt({tag:"div",cls:"ag-filter-body",role:"presentation"}),{eValuesFrom:e,eValuesTo:i}=this;return this.createFromToElement(t,e,"from"),this.createFromToElement(t,i,"to"),t}createFromToElement(t,e,i){let n=this.createManagedBean(new La);n.addCss(`ag-filter-${i}`),n.addCss("ag-filter-filter"),e.push(n),t.appendChild(n.getGui())}removeEValues(t,e){let i=o=>this.removeComponents(o,t,e),{eValuesFrom:n,eValuesTo:r}=this;i(n),i(r)}},aI=class extends u2{constructor(){super(...arguments),this.filterTypeKeys=qne}conditionToString(t,e,i,n,r){let{filter:o,filterTo:s,type:a}=t;if(e){let l=d=>()=>ms(this,"filterSummaryTextQuote",[d]),c=this.conditionForToolPanel(a,i,l(o),l(s),n,r);if(c!=null)return c}return i?`${o}-${s}`:o!=null?`${o}`:`${a}`}},ore=({filterOption:t,value:e,filterText:i})=>{if(i==null)return!1;switch(t){case"contains":return e.includes(i);case"notContains":return!e.includes(i);case"equals":return e===i;case"notEqual":return e!=i;case"startsWith":return e.indexOf(i)===0;case"endsWith":{let n=e.lastIndexOf(i);return n>=0&&n===e.length-i.length}default:return!1}},sre=t=>t,are=t=>t==null?null:t.toString().toLowerCase(),lre=class extends J8{constructor(){super(oI,p2),this.filterType="text",this.FilterModelFormatterClass=aI}updateParams(t){super.updateParams(t);let e=t.filterParams;this.matcher=e.textMatcher??ore,this.formatter=e.textFormatter??(e.caseSensitive?sre:are)}evaluateNullValue(t){return t?["notEqual","notContains","blank"].indexOf(t)>=0:!1}evaluateNonNullValue(t,e,i,n){let r=t.map(h=>this.formatter(h))||[],o=this.formatter(e),{api:s,colDef:a,column:l,context:c,filterParams:{textFormatter:d}}=this.params;if(i.type==="blank")return Om(e);if(i.type==="notBlank")return!Om(e);let u={api:s,colDef:a,column:l,context:c,node:n.node,data:n.data,filterOption:i.type,value:o,textFormatter:d};return r.some(h=>this.matcher(k(w({},u),{filterText:h})))}processModelToApply(t){if(t&&this.params.filterParams.trimInput){let e=i=>{let n=w({},i),{filter:r,filterTo:o}=i;return r&&(n.filter=bS(r)??null),o&&(n.filterTo=bS(o)??null),n};return jM(t)?k(w({},t),{conditions:t.conditions.map(e)}):e(t)}return t}},cre=class extends sI{constructor(){super(...arguments),this.FilterModelFormatterClass=aI,this.filterType="text",this.defaultOptions=p2}createFloatingFilterInputService(){return this.createManagedBean(new rI)}};function dre(t){return!!t.quickFilter?.isFilterPresent()}function ure(t){return t.quickFilter?.getText()}function hre(t){t.quickFilter?.resetCache()}var pre=class extends H{constructor(){super(...arguments),this.beanName="quickFilter",this.quickFilter=null,this.quickFilterParts=null}postConstruct(){let t=this.resetCache.bind(this),e=this.gos;this.addManagedEventListeners({columnPivotModeChanged:t,newColumnsLoaded:t,columnRowGroupChanged:t,columnVisible:()=>{e.get("includeHiddenColumnsInQuickFilter")||this.resetCache()}}),this.addManagedPropertyListener("quickFilterText",i=>this.setFilter(i.currentValue)),this.addManagedPropertyListeners(["includeHiddenColumnsInQuickFilter","applyQuickFilterBeforePivotOrAgg"],()=>this.onColumnConfigChanged()),this.quickFilter=this.parseFilter(e.get("quickFilterText")),this.parser=e.get("quickFilterParser"),this.matcher=e.get("quickFilterMatcher"),this.setFilterParts(),this.addManagedPropertyListeners(["quickFilterMatcher","quickFilterParser"],()=>this.setParserAndMatcher())}refreshCols(){let{autoColSvc:t,colModel:e,gos:i,pivotResultCols:n}=this.beans,r=e.isPivotMode(),o=t?.getColumns(),s=e.getColDefCols(),a=(r&&!i.get("applyQuickFilterBeforePivotOrAgg")?n?.getPivotResultCols()?.list:s)??[];o&&(a=a.concat(o)),this.colsToUse=i.get("includeHiddenColumnsInQuickFilter")?a:a.filter(l=>l.isVisible()||l.isRowGroupActive())}isFilterPresent(){return this.quickFilter!==null}doesRowPass(t){let e=this.gos.get("cacheQuickFilter");return this.matcher?this.doesRowPassMatcher(e,t):this.quickFilterParts.every(i=>e?this.doesRowPassCache(t,i):this.doesRowPassNoCache(t,i))}resetCache(){this.beans.rowModel.forEachNode(t=>t.quickFilterAggregateText=null)}getText(){return this.gos.get("quickFilterText")}setFilterParts(){let{quickFilter:t,parser:e}=this;t?this.quickFilterParts=e?e(t):t.split(" "):this.quickFilterParts=null}parseFilter(t){return ae(t)?t.toUpperCase():null}setFilter(t){if(t!=null&&typeof t!="string"){K(70,{newFilter:t});return}let e=this.parseFilter(t);this.quickFilter!==e&&(this.quickFilter=e,this.setFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}setParserAndMatcher(){let t=this.gos.get("quickFilterParser"),e=this.gos.get("quickFilterMatcher"),i=t!==this.parser||e!==this.matcher;this.parser=t,this.matcher=e,i&&(this.setFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}onColumnConfigChanged(){this.refreshCols(),this.resetCache(),this.isFilterPresent()&&this.dispatchLocalEvent({type:"quickFilterChanged"})}doesRowPassNoCache(t,e){return this.colsToUse.some(i=>{let n=this.getTextForColumn(i,t);return ae(n)&&n.includes(e)})}doesRowPassCache(t,e){return this.checkGenerateAggText(t),t.quickFilterAggregateText.includes(e)}doesRowPassMatcher(t,e){let i;t?(this.checkGenerateAggText(e),i=e.quickFilterAggregateText):i=this.getAggText(e);let{quickFilterParts:n,matcher:r}=this;return r(n,i)}checkGenerateAggText(t){t.quickFilterAggregateText||(t.quickFilterAggregateText=this.getAggText(t))}getTextForColumn(t,e){let i=this.beans.filterValueSvc.getValue(t,e),n=t.getColDef();if(n.getQuickFilterText){let r=Ee(this.gos,{value:i,node:e,data:e.data,column:t,colDef:n});i=n.getQuickFilterText(r)}return ae(i)?i.toString().toUpperCase():null}getAggText(t){let e=[];for(let i of this.colsToUse){let n=this.getTextForColumn(i,t);ae(n)&&e.push(n)}return e.join(`
`)}},fre={moduleName:"ClientSideRowModelFilter",version:oe,rowModels:["clientSide"],beans:[gne]},f2={moduleName:"FilterCore",version:oe,beans:[Nne],apiFunctions:{isAnyFilterPresent:One,onFilterChanged:Lne},css:[yne],dependsOn:[fre]},lI={moduleName:"FilterValue",version:oe,beans:[Hne]},Km={moduleName:"ColumnFilter",version:oe,beans:[Ane,Bne],dynamicBeans:{headerFilterCellCtrl:mne},icons:{filter:"filter",filterActive:"filter"},apiFunctions:{isColumnFilterPresent:Sne,getColumnFilterInstance:xne,destroyFilter:Ene,setFilterModel:Pne,getFilterModel:Rne,getColumnFilterModel:_ne,setColumnFilterModel:kne,showColumnFilter:Fne,hideColumnFilter:Tne,getColumnFilterHandler:Dne,doFilterAction:Mne},dependsOn:[f2,$m,lI,wne]},gre={moduleName:"CustomFilter",version:oe,userComponents:{agReadOnlyFloatingFilter:Vne},dependsOn:[Km]},mre={moduleName:"TextFilter",version:oe,dependsOn:[Km],userComponents:{agTextColumnFilter:{classImp:rre,params:{useForm:!0}},agTextColumnFloatingFilter:cre},dynamicBeans:{agTextColumnFilterHandler:lre}},vre={moduleName:"NumberFilter",version:oe,dependsOn:[Km],userComponents:{agNumberColumnFilter:{classImp:Zne,params:{useForm:!0}},agNumberColumnFloatingFilter:nre},dynamicBeans:{agNumberColumnFilterHandler:ere}},Cre={moduleName:"DateFilter",version:oe,dependsOn:[Km],userComponents:{agDateColumnFilter:{classImp:jne,params:{useForm:!0}},agDateInput:Qne,agDateColumnFloatingFilter:Xne},dynamicBeans:{agDateColumnFilterHandler:Kne}},wre={moduleName:"QuickFilterCore",version:oe,rowModels:["clientSide"],beans:[pre],dependsOn:[f2,lI]},bre={moduleName:"QuickFilter",version:oe,apiFunctions:{isQuickFilterPresent:dre,getQuickFilter:ure,resetQuickFilter:hre},dependsOn:[wre]},yre={moduleName:"ExternalFilter",version:oe,dependsOn:[f2]},Sre=".ag-tooltip{background-color:var(--ag-tooltip-background-color);border:var(--ag-tooltip-border);border-radius:var(--ag-border-radius);color:var(--ag-tooltip-text-color);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);position:absolute;white-space:normal;z-index:99999;&:where(.ag-cell-editor-tooltip){background-color:var(--ag-tooltip-error-background-color);border:var(--ag-tooltip-error-border);color:var(--ag-tooltip-error-text-color);font-weight:500}}.ag-tooltip-custom{position:absolute;z-index:99999}.ag-tooltip-custom:where(:not(.ag-tooltip-interactive)),.ag-tooltip:where(:not(.ag-tooltip-interactive)){pointer-events:none}.ag-tooltip-animate{transition:opacity 1s;&:where(.ag-tooltip-hiding){opacity:0}}",Hy=(t,e,i)=>{let{editModelSvc:n}=t,r=n?.getCellValidationModel()?.getCellValidation(e)?.errorMessages,o=n?.getRowValidationModel().getRowValidation(e)?.errorMessages,s=r||o;return s?.length?s.join(i("tooltipValidationErrorSeparator",". ")):void 0},xre=class extends H{constructor(){super(...arguments),this.beanName="tooltipSvc"}setupHeaderTooltip(t,e,i,n){t&&e.destroyBean(t);let r=this.gos,o=By(r),{column:s,eGui:a}=e,l=s.getColDef();!n&&o&&!l.headerComponent&&(n=im(()=>a.querySelector(".ag-header-cell-text")));let c="header",u=this.beans.colNames.getDisplayNameForColumn(s,"header",!0),h=i??u,p={getGui:()=>a,getLocation:()=>c,getTooltipValue:()=>i??l?.headerTooltipValueGetter?.(Ee(r,{location:c,colDef:l,column:s,value:h,valueFormatted:u}))??l?.headerTooltip,shouldDisplayTooltip:n,getAdditionalParams:()=>({column:s,colDef:s.getColDef()})},f=this.createTooltipFeature(p);return f&&(f=e.createBean(f),e.setRefreshFunction("tooltip",()=>f.refreshTooltip())),f}setupHeaderGroupTooltip(t,e,i,n){t&&e.destroyBean(t);let r=this.gos,o=By(r),{column:s,eGui:a}=e,l=s.getColGroupDef();!n&&o&&!l?.headerGroupComponent&&(n=im(()=>a.querySelector(".ag-header-group-text")));let c="headerGroup",u=this.beans.colNames.getDisplayNameForColumnGroup(s,"header"),h=i??u,p={getGui:()=>a,getLocation:()=>c,getTooltipValue:()=>i??l?.headerTooltipValueGetter?.(Ee(r,{location:c,colDef:l,column:s,value:h,valueFormatted:u}))??l?.headerTooltip,shouldDisplayTooltip:n,getAdditionalParams:()=>{let g={column:s};return l&&(g.colDef=l),g}},f=this.createTooltipFeature(p);return f&&e.createBean(f)}enableCellTooltipFeature(t,e,i){let{beans:n}=this,{gos:r,editSvc:o}=n,{column:s,rowNode:a}=t,l="cell",c=()=>{let p=!!!o?.isEditing(t)&&Hy(n,t,this.getLocaleTextFunc());if(p)return l="cellEditor",p;l="cell";let f=s.getColDef(),g=a.data;if(f.tooltipField&&ae(g))return th(g,f.tooltipField,s.isTooltipFieldContainsDots());let m=f.tooltipValueGetter;return m?m(Ee(r,{location:"cell",colDef:s.getColDef(),column:s,rowIndex:t.cellPosition.rowIndex,node:a,data:a.data,value:t.value,valueFormatted:t.valueFormatted})):null},d=By(r);i||(d&&!t.isCellRenderer()?i=()=>{let h=!!o?.isEditing(t);if(!h&&Hy(n,t,this.getLocaleTextFunc()))return!0;if(!s.isTooltipEnabled())return!1;let g=im(()=>{let m=t.eGui;return m.children.length===0?m:m.querySelector(".ag-cell-value")});return!h&&g()}:i=()=>!o?.isEditing(t));let u={getGui:()=>t.eGui,getLocation:()=>l,getTooltipValue:e!=null?()=>e:c,shouldDisplayTooltip:i,getAdditionalParams:()=>({column:s,colDef:s.getColDef(),rowIndex:t.cellPosition.rowIndex,node:a,data:a.data,valueFormatted:t.valueFormatted})};return this.createTooltipFeature(u,n)}setupFullWidthRowTooltip(t,e,i,n){let r={getGui:()=>e.getFullWidthElement(),getTooltipValue:()=>i,getLocation:()=>"fullWidthRow",shouldDisplayTooltip:n},o=this.beans,s=o.context;t&&e.destroyBean(t,s);let a=this.createTooltipFeature(r,o);if(a)return e.createBean(a,s)}setupCellEditorTooltip(t,e){let{beans:i}=this,{context:n}=i,r=e.getValidationElement?.(!0)||!e.isPopup?.()&&t.eGui;if(!r)return;let o={getGui:()=>r,getTooltipValue:()=>Hy(i,t,this.getLocaleTextFunc()),getLocation:()=>"cellEditor",shouldDisplayTooltip:()=>{let{editModelSvc:a}=i,l=a?.getRowValidationModel()?.getRowValidationMap(),c=a?.getCellValidationModel()?.getCellValidationMap(),d=!!l&&l.size>0,u=!!c&&c.size>0;return d||u}},s=this.createTooltipFeature(o,i);if(s)return t.createBean(s,n)}initCol(t){let{colDef:e}=t;t.tooltipEnabled=ae(e.tooltipField)||ae(e.tooltipValueGetter)||ae(e.tooltipComponent)}createTooltipFeature(t,e){return this.beans.registry.createDynamicBean("tooltipFeature",!1,t,e)}},Ere=class extends JK{createTooltipComp(t,e){W$(this.beans.userCompFactory,t)?.newAgStackInstance().then(e)}setEventHandlers(t){[this.onColumnMovedEventCallback]=this.addManagedEventListeners({columnMoved:t})}clearEventHandlers(){this.onColumnMovedEventCallback?.(),this.onColumnMovedEventCallback=void 0}},cI={moduleName:"Tooltip",version:oe,beans:[xre],dynamicBeans:{tooltipFeature:OM,highlightTooltipFeature:QK,tooltipStateManager:Ere},userComponents:{agTooltipComponent:tY},dependsOn:[$m],css:[Sre]},Xl=class{constructor(t){this.cellValueChanges=t}},zy=class extends Xl{constructor(t,e,i,n){super(t),this.initialRange=e,this.finalRange=i,this.ranges=n}},Pre=10,lD=class{constructor(t){this.actionStack=[],this.maxStackSize=t||Pre,this.actionStack=new Array(this.maxStackSize)}pop(){return this.actionStack.pop()}push(t){t.cellValueChanges&&t.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(t))}clear(){this.actionStack=[]}getCurrentStackSize(){return this.actionStack.length}},Rre=class extends H{constructor(){super(...arguments),this.beanName="undoRedo",this.cellValueChanges=[],this.activeCellEdit=null,this.activeRowEdit=null,this.isPasting=!1,this.isRangeInAction=!1,this.batchEditing=!1,this.bulkEditing=!1,this.onCellValueChanged=t=>{let e={column:t.column,rowIndex:t.rowIndex,rowPinned:t.rowPinned},i=this.activeCellEdit!==null&&u8(this.activeCellEdit,e),n=this.activeRowEdit!==null&&JJ(this.activeRowEdit,e);if(!(i||n||this.isPasting||this.isRangeInAction))return;let{rowPinned:o,rowIndex:s,column:a,oldValue:l,value:c}=t,d={rowPinned:o,rowIndex:s,columnId:a.getColId(),newValue:c,oldValue:l};this.cellValueChanges.push(d)},this.clearStacks=()=>{this.undoStack.clear(),this.redoStack.clear()}}postConstruct(){let{gos:t,ctrlsSvc:e}=this.beans;if(!t.get("undoRedoCellEditing"))return;let i=t.get("undoRedoCellEditingLimit");if(i<=0)return;this.undoStack=new lD(i),this.redoStack=new lD(i),this.addListeners();let n=this.clearStacks.bind(this);this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this),modelUpdated:r=>{r.keepUndoRedoStack||this.clearStacks()},columnPivotModeChanged:n,newColumnsLoaded:n,columnGroupOpened:n,columnRowGroupChanged:n,columnMoved:n,columnPinned:n,columnVisible:n,rowDragEnd:n}),e.whenReady(this,r=>{this.gridBodyCtrl=r.gridBodyCtrl})}getCurrentUndoStackSize(){return this.undoStack?.getCurrentStackSize()??0}getCurrentRedoStackSize(){return this.redoStack?.getCurrentStackSize()??0}undo(t){let{eventSvc:e,undoStack:i,redoStack:n}=this;e.dispatchEvent({type:"undoStarted",source:t});let r=this.undoRedo(i,n,"initialRange","oldValue","undo");e.dispatchEvent({type:"undoEnded",source:t,operationPerformed:r})}redo(t){let{eventSvc:e,undoStack:i,redoStack:n}=this;e.dispatchEvent({type:"redoStarted",source:t});let r=this.undoRedo(n,i,"finalRange","newValue","redo");e.dispatchEvent({type:"redoEnded",source:t,operationPerformed:r})}undoRedo(t,e,i,n,r){if(!t)return!1;let o=t.pop();return o?.cellValueChanges?(this.processAction(o,s=>s[n],r),o instanceof zy?this.processRange(o.ranges||[o[i]]):this.processCell(o.cellValueChanges),e.push(o),!0):!1}processAction(t,e,i){for(let n of t.cellValueChanges){let{rowIndex:r,rowPinned:o,columnId:s}=n,a={rowIndex:r,rowPinned:o},l=xo(this.beans,a);l.displayed&&l.setDataValue(s,e(n),i)}}processRange(t){let e,i=this.beans.rangeSvc;i.removeAllCellRanges(!0),t.forEach((n,r)=>{if(!n)return;let o=n.startRow,s=n.endRow;r===t.length-1&&(e={rowPinned:o.rowPinned,rowIndex:o.rowIndex,columnId:n.startColumn.getColId()},this.setLastFocusedCell(e));let a={rowStartIndex:o.rowIndex,rowStartPinned:o.rowPinned,rowEndIndex:s.rowIndex,rowEndPinned:s.rowPinned,columnStart:n.startColumn,columns:n.columns};i.addCellRange(a)})}processCell(t){let e=t[0],{rowIndex:i,rowPinned:n}=e,r={rowIndex:i,rowPinned:n},o=xo(this.beans,r),s={rowPinned:e.rowPinned,rowIndex:o.rowIndex,columnId:e.columnId};this.setLastFocusedCell(s)}setLastFocusedCell(t){let{rowIndex:e,columnId:i,rowPinned:n}=t,{colModel:r,focusSvc:o,rangeSvc:s}=this.beans,a=r.getCol(i);if(!a)return;let{scrollFeature:l}=this.gridBodyCtrl;l.ensureIndexVisible(e),l.ensureColumnVisible(a);let c={rowIndex:e,column:a,rowPinned:n};o.setFocusedCell(k(w({},c),{forceBrowserFocus:!0})),s?.setRangeToCell(c)}addListeners(){this.addManagedEventListeners({rowEditingStarted:t=>{this.activeRowEdit={rowIndex:t.rowIndex,rowPinned:t.rowPinned}},rowEditingStopped:()=>{let t=new Xl(this.cellValueChanges);this.pushActionsToUndoStack(t),this.activeRowEdit=null},cellEditingStarted:t=>{this.activeCellEdit={column:t.column,rowIndex:t.rowIndex,rowPinned:t.rowPinned}},cellEditingStopped:t=>{if(this.activeCellEdit=null,t.valueChanged&&!this.activeRowEdit&&!this.isPasting&&!this.isRangeInAction){let i=new Xl(this.cellValueChanges);this.pushActionsToUndoStack(i)}},pasteStart:()=>{this.isPasting=!0},pasteEnd:()=>{let t=new Xl(this.cellValueChanges);this.pushActionsToUndoStack(t),this.isPasting=!1},fillStart:()=>{this.isRangeInAction=!0},fillEnd:t=>{let e=new zy(this.cellValueChanges,t.initialRange,t.finalRange);this.pushActionsToUndoStack(e),this.isRangeInAction=!1},keyShortcutChangedCellStart:()=>{this.isRangeInAction=!0},keyShortcutChangedCellEnd:()=>{let t,{rangeSvc:e,gos:i}=this.beans;e&&So(i)?t=new zy(this.cellValueChanges,void 0,void 0,[...e.getCellRanges()]):t=new Xl(this.cellValueChanges),this.pushActionsToUndoStack(t),this.isRangeInAction=!1},batchEditingStarted:()=>this.startBigChange("batchEditing"),batchEditingStopped:({changes:t})=>this.stopBigChange("batchEditing",t),bulkEditingStarted:()=>this.startBigChange("bulkEditing"),bulkEditingStopped:({changes:t})=>this.stopBigChange("bulkEditing",t)})}startBigChange(t){this.updateBigChange(t,!0)}updateBigChange(t,e){t==="bulkEditing"?this.bulkEditing=e:this.batchEditing=e}stopBigChange(t,e){if(t==="bulkEditing"&&!this.bulkEditing||t==="batchEditing"&&!this.batchEditing||(this.updateBigChange(t,!1),e?.length===0))return;let i=new Xl(e??[]);this.pushActionsToUndoStack(i),this.cellValueChanges=[]}pushActionsToUndoStack(t){this.undoStack.push(t),this.cellValueChanges=[],this.redoStack.clear()}},_re=".ag-cell-inline-editing{border:var(--ag-cell-editing-border)!important;border-radius:var(--ag-border-radius);box-shadow:var(--ag-cell-editing-shadow);padding:0;z-index:1;.ag-cell-edit-wrapper,.ag-cell-editor,.ag-cell-wrapper,:where(.ag-cell-editor) .ag-input-field-input,:where(.ag-cell-editor) .ag-wrapper{height:100%;line-height:normal;min-height:100%;width:100%}&.ag-cell-editing-error{border-color:var(--ag-invalid-color)!important}}:where(.ag-popup-editor) .ag-large-text{background-color:var(--ag-background-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);padding:0}.ag-large-text-input{display:block;height:auto;padding:var(--ag-cell-horizontal-padding)}:where(.ag-rtl .ag-large-text-input) textarea{resize:none}:where(.ag-ltr) .ag-checkbox-edit{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-checkbox-edit{padding-right:var(--ag-cell-horizontal-padding)}:where(.ag-row.ag-row-editing-invalid .ag-cell-inline-editing){opacity:.8}.ag-popup-editor{position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}",kre={tag:"div",cls:"ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit",children:[{tag:"ag-checkbox",ref:"eEditor",role:"presentation"}]},Fre=class extends Um{constructor(){super(kre,[BS]),this.eEditor=re}initialiseEditor(t){let e=t.value??void 0,i=this.eEditor;i.setValue(e),i.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(e),this.addManagedListeners(i,{fieldValueChanged:r=>this.setAriaLabel(r.selected)})}getValue(){return this.eEditor.getValue()}focusIn(){this.eEditor.getFocusableElement().focus()}afterGuiAttached(){this.params.cellStartedEdit&&this.focusIn()}isPopup(){return!1}setAriaLabel(t){let e=this.getLocaleTextFunc(),i=Nm(e,t),n=e("ariaToggleCellValue","Press SPACE to toggle cell value");this.eEditor.setInputAriaLabel(`${n} (${i})`)}getValidationElement(t){return t?this.params.eGridCell:this.eEditor.getInputElement()}getValidationErrors(){let{params:t}=this,{getValidationErrors:e}=t,i=this.getValue();return e?e({value:i,internalErrors:null,cellEditorParams:t}):null}},Ym=class extends Um{constructor(t){super(),this.cellEditorInput=t,this.eEditor=re}initialiseEditor(t){let{cellEditorInput:e}=this;this.setTemplate({tag:"div",cls:"ag-cell-edit-wrapper",children:[e.getTemplate()]},e.getAgComponents());let{eEditor:i}=this,{cellStartedEdit:n,eventKey:r,suppressPreventDefault:o}=t;i.getInputElement().setAttribute("title",""),e.init(i,t);let s,a=!0;n?(this.focusAfterAttached=!0,r===A.BACKSPACE||r===A.DELETE?s="":r&&r.length===1?o?a=!1:s=r:(s=e.getStartValue(),r!==A.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,s=e.getStartValue()),a&&s!=null&&i.setStartValue(s),this.addGuiEventListener("keydown",l=>{let{key:c}=l;(c===A.PAGE_UP||c===A.PAGE_DOWN)&&l.preventDefault()})}afterGuiAttached(){let t=this.getLocaleTextFunc(),e=this.eEditor;if(e.setInputAriaLabel(t("ariaInputEditor","Input Editor")),!this.focusAfterAttached)return;Es()||e.getFocusableElement().focus();let i=e.getInputElement();this.highlightAllOnFocus?i.select():this.cellEditorInput.setCaret?.()}focusIn(){let{eEditor:t}=this,e=t.getFocusableElement(),i=t.getInputElement();e.focus(),i.select()}getValue(){return this.cellEditorInput.getValue()}isPopup(){return!1}getValidationElement(){return this.eEditor.getInputElement()}getValidationErrors(){return this.cellEditorInput.getValidationErrors()}},Tre={tag:"ag-input-date-field",ref:"eEditor",cls:"ag-cell-editor"},Dre=class{constructor(t,e){this.getDataTypeService=t,this.getLocaleTextFunc=e}getTemplate(){return Tre}getAgComponents(){return[RM]}init(t,e){this.eEditor=t,this.params=e;let{min:i,max:n,step:r,colDef:o}=e;i!=null&&t.setMin(i),n!=null&&t.setMax(n),r!=null&&t.setStep(r),this.includeTime=e.includeTime??this.getDataTypeService()?.getDateIncludesTimeFlag?.(o.cellDataType),this.includeTime!=null&&t.setIncludeTime(this.includeTime)}getValidationErrors(){let e=this.eEditor.getInputElement().valueAsDate,{params:i}=this,{min:n,max:r,getValidationErrors:o}=i,s=[],a=this.getLocaleTextFunc();if(e instanceof Date&&!isNaN(e.getTime())){if(n){let l=n instanceof Date?n:new Date(n);if(e<l){let c=l.toLocaleDateString();s.push(a("minDateValidation",`Date must be after ${c}`,[c]))}}if(r){let l=r instanceof Date?r:new Date(r);if(e>l){let c=l.toLocaleDateString();s.push(a("maxDateValidation",`Date must be before ${c}`,[c]))}}}return s.length||(s=null),o?o({value:e,cellEditorParams:i,internalErrors:s}):s}getValue(){let{eEditor:t,params:e}=this,i=t.getDate();return!ae(i)&&!ae(e.value)?e.value:i??null}getStartValue(){let{value:t}=this.params;if(t instanceof Date)return un(t,this.includeTime??!1)}},Mre=class extends Ym{constructor(){super(new Dre(()=>this.beans.dataTypeSvc,()=>this.getLocaleTextFunc()))}},Ire={tag:"ag-input-date-field",ref:"eEditor",cls:"ag-cell-editor"},Are=class{constructor(t,e){this.getDataTypeService=t,this.getLocaleTextFunc=e}getTemplate(){return Ire}getAgComponents(){return[RM]}init(t,e){this.eEditor=t,this.params=e;let{min:i,max:n,step:r,colDef:o}=e;i!=null&&t.setMin(i),n!=null&&t.setMax(n),r!=null&&t.setStep(r),this.includeTime=e.includeTime??this.getDataTypeService()?.getDateIncludesTimeFlag?.(o.cellDataType),this.includeTime!=null&&t.setIncludeTime(this.includeTime)}getValidationErrors(){let{eEditor:t,params:e}=this,i=t.getInputElement().value,n=this.formatDate(this.parseDate(i??void 0)),{min:r,max:o,getValidationErrors:s}=e,a=[];if(n){let l=new Date(n),c=this.getLocaleTextFunc();if(r){let d=new Date(r);if(l<d){let u=d.toLocaleDateString();a.push(c("minDateValidation",`Date must be after ${u}`,[u]))}}if(o){let d=new Date(o);if(l>d){let u=d.toLocaleDateString();a.push(c("maxDateValidation",`Date must be before ${u}`,[u]))}}}return a.length||(a=null),s?s({value:this.getValue(),cellEditorParams:e,internalErrors:a}):a}getValue(){let{params:t,eEditor:e}=this,i=this.formatDate(e.getDate());return!ae(i)&&!ae(t.value)?t.value:t.parseValue(i??"")}getStartValue(){return un(this.parseDate(this.params.value??void 0)??null,this.includeTime??!1)}parseDate(t){let e=this.getDataTypeService();return e?e.getDateParserFunction(this.params.column)(t):Ji(t)??void 0}formatDate(t){let e=this.getDataTypeService();return e?e.getDateFormatterFunction(this.params.column)(t):un(t??null,this.includeTime??!1)??void 0}},Ore=class extends Ym{constructor(){super(new Are(()=>this.beans.dataTypeSvc,()=>this.getLocaleTextFunc()))}},Lre={tag:"div",cls:"ag-large-text",children:[{tag:"ag-input-text-area",ref:"eEditor",cls:"ag-large-text-input"}]},Nre=class extends Um{constructor(){super(Lre,[aK]),this.eEditor=re}initialiseEditor(t){let{eEditor:e}=this,{cellStartedEdit:i,eventKey:n,maxLength:r,cols:o,rows:s}=t;this.focusAfterAttached=i,e.getInputElement().setAttribute("title",""),e.setMaxLength(r||200).setCols(o||60).setRows(s||10);let a;i?(this.focusAfterAttached=!0,n===A.BACKSPACE||n===A.DELETE?a="":n&&n.length===1?a=n:(a=this.getStartValue(t),n!==A.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,a=this.getStartValue(t)),a!=null&&e.setValue(a,!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()}getStartValue(t){let{value:e}=t;return e?.toString()??e}onKeyDown(t){let e=t.key;(e===A.LEFT||e===A.UP||e===A.RIGHT||e===A.DOWN||t.shiftKey&&e===A.ENTER)&&t.stopPropagation()}afterGuiAttached(){let{eEditor:t,focusAfterAttached:e,highlightAllOnFocus:i}=this,n=this.getLocaleTextFunc();t.setInputAriaLabel(n("ariaInputEditor","Input Editor")),e&&(t.getFocusableElement().focus(),i&&t.getInputElement().select())}getValue(){let{eEditor:t,params:e}=this,{value:i}=e,n=t.getValue();return!ae(n)&&!ae(i)?i:e.parseValue(n)}getValidationElement(){return this.eEditor.getInputElement()}getValidationErrors(){let{params:t}=this,{maxLength:e,getValidationErrors:i}=t,n=this.getLocaleTextFunc(),r=this.getValue(),o=[];return typeof r=="string"&&e!=null&&r.length>e&&o.push(n("maxLengthValidation",`Must be ${e} characters or fewer.`,[String(e)])),o.length||(o=null),i?i({value:r,internalErrors:o,cellEditorParams:t}):o}},Bre={tag:"ag-input-number-field",ref:"eEditor",cls:"ag-cell-editor"},Hre=class{constructor(t){this.getLocaleTextFunc=t}getTemplate(){return Bre}getAgComponents(){return[lK]}init(t,e){this.eEditor=t,this.params=e;let{max:i,min:n,precision:r,step:o}=e;i!=null&&t.setMax(i),n!=null&&t.setMin(n),r!=null&&t.setPrecision(r),o!=null&&t.setStep(o);let s=t.getInputElement();e.preventStepping?t.addManagedElementListeners(s,{keydown:this.preventStepping}):e.showStepperButtons&&s.classList.add("ag-number-field-input-stepper")}getValidationErrors(){let{params:t}=this,{min:e,max:i,getValidationErrors:n}=t,o=this.eEditor.getInputElement().valueAsNumber,s=this.getLocaleTextFunc(),a=[];return typeof o=="number"&&(e!=null&&o<e&&a.push(s("minValueValidation",`Must be greater than or equal to ${e}.`,[String(e)])),i!=null&&o>i&&a.push(s("maxValueValidation",`Must be less than or equal to ${i}.`,[String(i)]))),a.length||(a=null),n?n({value:o,cellEditorParams:t,internalErrors:a}):a}preventStepping(t){(t.key===A.UP||t.key===A.DOWN)&&t.preventDefault()}getValue(){let{eEditor:t,params:e}=this,i=t.getValue();if(!ae(i)&&!ae(e.value))return e.value;let n=e.parseValue(i);if(n==null)return n;if(typeof n=="string"){if(n==="")return null;n=Number(n)}return isNaN(n)?null:n}getStartValue(){return this.params.value}setCaret(){Es()&&this.eEditor.getInputElement().focus({preventScroll:!0})}},zre=class extends Ym{constructor(){super(new Hre(()=>this.getLocaleTextFunc()))}},Vre={tag:"div",cls:"ag-cell-edit-wrapper",children:[{tag:"ag-select",ref:"eEditor",cls:"ag-cell-editor"}]},Gre=class extends Um{constructor(){super(Vre,[wK]),this.eEditor=re,this.startedByEnter=!1}wireBeans(t){this.valueSvc=t.valueSvc}initialiseEditor(t){this.focusAfterAttached=t.cellStartedEdit;let{eEditor:e,valueSvc:i,gos:n}=this,{values:r,value:o,eventKey:s}=t;if(wt(r)){K(58);return}this.startedByEnter=s!=null?s===A.ENTER:!1;let a=!1;r.forEach(u=>{let h={value:u},p=i.formatValue(t.column,null,u),f=p!=null;h.text=f?p:u,e.addOption(h),a=a||o===u}),a?e.setValue(t.value,!0):t.values.length&&e.setValue(t.values[0],!0);let{valueListGap:l,valueListMaxWidth:c,valueListMaxHeight:d}=t;l!=null&&e.setPickerGap(l),d!=null&&e.setPickerMaxHeight(d),c!=null&&e.setPickerMaxWidth(c),n.get("editType")!=="fullRow"&&this.addManagedListeners(this.eEditor,{selectedItem:()=>t.stopEditing()})}afterGuiAttached(){this.focusAfterAttached&&this.eEditor.getFocusableElement().focus(),this.startedByEnter&&setTimeout(()=>{this.isAlive()&&this.eEditor.showPicker()})}focusIn(){this.eEditor.getFocusableElement().focus()}getValue(){return this.eEditor.getValue()}isPopup(){return!1}getValidationElement(){return this.eEditor.getAriaElement()}getValidationErrors(){let{params:t}=this,{values:e,getValidationErrors:i}=t,n=this.getValue(),r=[];if(e&&!e.includes(n)){let o=this.getLocaleTextFunc();r.push(o("invalidSelectionValidation","Invalid selection."))}else r=null;return i?i({value:n,internalErrors:r,cellEditorParams:t}):r}},Wre={tag:"ag-input-text-field",ref:"eEditor",cls:"ag-cell-editor"},Ure=class{constructor(t){this.getLocaleTextFunc=t}getTemplate(){return Wre}getAgComponents(){return[zm]}init(t,e){this.eEditor=t,this.params=e;let i=e.maxLength;i!=null&&t.setMaxLength(i)}getValidationErrors(){let{params:t}=this,{maxLength:e,getValidationErrors:i}=t,n=this.getValue(),r=this.getLocaleTextFunc(),o=[];return e!=null&&typeof n=="string"&&n.length>e&&o.push(r("maxLengthValidation",`Must be ${e} characters or fewer.`,[String(e)])),o.length||(o=null),i?i({value:n,cellEditorParams:t,internalErrors:o}):o}getValue(){let{eEditor:t,params:e}=this,i=t.getValue();return!ae(i)&&!ae(e.value)?e.value:e.parseValue(i)}getStartValue(){let t=this.params;return t.useFormatter||t.column.getColDef().refData?t.formatValue(t.value):t.value}setCaret(){Es()&&this.eEditor.getInputElement().focus({preventScroll:!0});let t=this.eEditor,e=t.getValue(),i=ae(e)&&e.length||0;i&&t.getInputElement().setSelectionRange(i,i)}},cD=class extends Ym{constructor(){super(new Ure(()=>this.getLocaleTextFunc()))}};function jre(t){return t.ctrlsSvc.getScrollFeature().getVScrollPosition()}function qre(t){return t.ctrlsSvc.getScrollFeature().getHScrollPosition()}function dI(t,e,i="auto"){t.frameworkOverrides.wrapIncoming(()=>t.ctrlsSvc.getScrollFeature().ensureColumnVisible(e,i),"ensureVisible")}function uI(t,e,i){t.frameworkOverrides.wrapIncoming(()=>t.ctrlsSvc.getScrollFeature().ensureIndexVisible(e,i),"ensureVisible")}function $re(t,e,i=null){t.frameworkOverrides.wrapIncoming(()=>t.ctrlsSvc.getScrollFeature().ensureNodeVisible(e,i),"ensureVisible")}function Kre(t){t.undoRedo?.undo("api")}function Yre(t){t.undoRedo?.redo("api")}function Xre(t,e){return t.editModelSvc?.getEditRowDataValue(e,{checkSiblings:!0})}function Jre(t){let e=t.editModelSvc?.getEditMap(),i=[];return e?.forEach((n,r)=>{let{rowIndex:o,rowPinned:s}=r;n.forEach((a,l)=>{let{editorValue:c,pendingValue:d,sourceValue:u,state:h}=a,p=vo(a),f=c??d;f===In&&(f=void 0);let g={newValue:f,oldValue:u,state:h,column:l,colId:l.getColId(),colKey:l.getColId(),rowIndex:o,rowPinned:s};(h==="editing"||h==="changed"&&p)&&i.push(g)})}),i}function Qre(t,e=!1){let{editSvc:i}=t;if(i?.isBatchEditing()){if(e)for(let n of t.editModelSvc?.getEditPositions()??[])n.state==="editing"&&i.revertSingleCellEdit(n);else ya(t,{persist:!0});dc(t,void 0,{cancel:e})}else i?.stopEditing(void 0,{cancel:e,source:"edit",forceStop:!e,forceCancel:e})}function Zre(t,e){let i=yt(t,e);return t.editSvc?.isEditing(i)??!1}function eoe(t,e){let{key:i,colKey:n,rowIndex:r,rowPinned:o}=e,{editSvc:s,colModel:a}=t,l=a.getCol(n);if(!l){K(12,{colKey:n});return}let d=xo(t,{rowIndex:r,rowPinned:o||null,column:l});if(!d){K(290,{rowIndex:r,rowPinned:o});return}if(!l.isCellEditable(d))return;o==null&&uI(t,r),dI(t,n),s?.startEditing({rowNode:d,column:l},{event:i?new KeyboardEvent("keydown",{key:i}):void 0,source:"api"})}function toe(t){return t.editSvc?.validateEdit()||null}function ioe(t){return t.undoRedo?.getCurrentUndoStackSize()??0}function noe(t){return t.undoRedo?.getCurrentRedoStackSize()??0}var roe={tag:"div",cls:"ag-popup-editor",attrs:{tabindex:"-1"}},ooe=class extends OS{constructor(t){super(roe),this.params=t}postConstruct(){Fa(this.gos,this.getGui(),"popupEditorWrapper",!0),this.addKeyDownListener()}addKeyDownListener(){let t=this.getGui(),e=this.params,i=n=>{aS(this.gos,n,e.node,e.column,!0)||e.onKeyDown(n)};this.addManagedElementListeners(t,{keydown:i})}};function soe(t,{column:e},i,n,r="ui"){if(i instanceof KeyboardEvent&&(i.key===A.TAB||i.key===A.ENTER||i.key===A.F2||i.key===A.BACKSPACE&&n))return!0;if(i?.shiftKey&&t.rangeSvc?.getCellRanges().length!=0)return!1;let s=e?.getColDef(),a=aoe(t.gos,s),l=i?.type;return l==="click"&&i?.detail===1&&a===1||l==="dblclick"&&i?.detail===2&&a===2?!0:r==="api"?n??!1:!1}function aoe(t,e){return t.get("suppressClickEdit")===!0?0:t.get("singleClickEdit")===!0||e?.singleClickEdit?1:2}function yS(t,{rowNode:e,column:i},n="ui"){let r=i.getColDef().editable,o=t.editModelSvc;return i.isColumnFunc(e,r)||!!o&&o.hasEdits({rowNode:e,column:i},{withOpenEditor:!0})}function loe(t,e,i="ui"){let n=yS(t,e,i);return n===!0||i==="ui"?n:t.colModel.getCols().some(o=>yS(t,{rowNode:e.rowNode,column:o},i))}var Lm=(t,e=!1)=>{if(t!==void 0)return vo(t)||e&&t.state==="editing"};function hI(t,e,i=!1){return Lm(t.editModelSvc?.getEdit(e),i)}var pI=(t,e,i)=>{if(t)for(let n=0,r=t.length;n<r;++n){let o=t[n];if(o.data&&(Lm(e?.getEdit({rowNode:o,column:i}))||Lm(e?.getEdit({rowNode:o.pinnedSibling,column:i})))||pI(o.childrenAfterGroup,e,i))return!0}};function fI(t,e){let{column:i,rowNode:n}=e;return t.gos.get("groupTotalRow")&&!n?.footer?!1:pI(n?.childrenAfterGroup,t.editModelSvc,i)}function gI(t,{rowNode:e,column:i}){if(e=e.pinnedSibling,!!e)return Lm(t.editModelSvc?.getEdit({rowNode:e,column:i}))}var coe=class extends H{constructor(t,e){super(),this.cellCtrl=t,this.beans=e,this.editSvc=e.editSvc,this.editModelSvc=e.editModelSvc}setComp(t){this.cellComp=t,this.applyCellStyles()}applyCellStyles(){let{cellCtrl:t,editSvc:e,beans:i}=this;if(e?.isBatchEditing()&&e.isEditing()){let r=hI(i,t)||fI(i,t)||gI(i,t);this.applyBatchingStyle(r)}else this.applyBatchingStyle(!1);let n=!!this.editModelSvc?.getCellValidationModel().hasCellValidation(this.cellCtrl);this.cellComp.toggleCss("ag-cell-editing-error",n)}applyBatchingStyle(t){this.cellComp.toggleCss("ag-cell-editing",t??!1),this.cellComp.toggleCss("ag-cell-batch-edit",(t&&this.editSvc?.isBatchEditing())??!1)}},doe=class extends H{constructor(t,e){super(),this.rowCtrl=t,this.beans=e,this.gos=e.gos,this.editSvc=e.editSvc,this.editModelSvc=e.editModelSvc}applyRowStyles(){let{rowCtrl:t,editModelSvc:e,beans:i}=this,n=t.rowNode,r=e?.getEditRow(n),o=this.editModelSvc?.getRowValidationModel().hasRowValidation({rowNode:n});if(!r&&n.pinnedSibling&&(n=n.pinnedSibling,r=e?.getEditRow(n)),r){let s=Array.from(r.keys()).some(a=>{let l={rowNode:n,column:a};return hI(i,l,!0)||fI(i,l)||gI(i,l)});this.applyStyle(o,s);return}this.applyStyle(o)}applyStyle(t=!1,e=!1){let i=this.editSvc?.isBatchEditing()??!1,n=this.gos.get("editType")==="fullRow";this.rowCtrl?.forEachGui(void 0,({rowComp:r})=>{r.toggleCss("ag-row-editing",n&&e),r.toggleCss("ag-row-batch-edit",n&&e&&i),r.toggleCss("ag-row-inline-editing",e),r.toggleCss("ag-row-not-inline-editing",!e),r.toggleCss("ag-row-editing-invalid",n&&e&&t)})}},uoe=({rowModel:t,pinnedRowModel:e,editModelSvc:i},n)=>{let r=new Set;t.forEachNode(o=>n.has(o)&&r.add(o)),e?.forEachPinnedRow("top",o=>n.has(o)&&r.add(o)),e?.forEachPinnedRow("bottom",o=>n.has(o)&&r.add(o));for(let o of n)r.has(o)||i.removeEdits({rowNode:o});return r},hoe=({editModelSvc:t},e,i)=>{for(let n of e)t?.getEditRow(n)?.forEach((r,o)=>!i.has(o)&&t.removeEdits({rowNode:n,column:o}))},poe=t=>()=>{let e=new Set(t.colModel.getCols()),i=t.editModelSvc.getEditMap(!0),n=new Set(i.keys());hoe(t,uoe(t,n),e)},foe=new Set(["undo","redo","paste","bulk","rangeSvc"]),goe=new Set(["ui","api"]),mI={paste:"api",rangeSvc:"api",fillHandle:"api",cellClear:"api",bulk:"api"},moe=new Set(Object.keys(mI)),voe=new Set(["paste","rangeSvc","renderer","cellClear","redo","undo"]),tm={cancel:!0,source:"api"},Coe={cancel:!1,source:"api"},Kl={checkSiblings:!0},Uu={force:!0,suppressFlash:!0},woe=class extends H{constructor(){super(...arguments),this.beanName="editSvc",this.batch=!1,this.stopping=!1,this.committing=!1}postConstruct(){let{beans:t}=this;this.model=t.editModelSvc,this.valueSvc=t.valueSvc,this.rangeSvc=t.rangeSvc,this.addManagedPropertyListener("editType",({currentValue:n})=>{this.stopEditing(void 0,tm),this.createStrategy(n)});let e=poe(t),i=()=>{let n=this.model.getCellValidationModel().getCellValidationMap().size>0,r=this.model.getRowValidationModel().getRowValidationMap().size>0;return n||r?this.stopEditing(void 0,tm):this.isEditing()&&(this.isBatchEditing()?dc(t,this.model.getEditPositions()):this.stopEditing(void 0,Coe)),!1};this.addManagedEventListeners({columnPinned:e,columnVisible:e,columnRowGroupChanged:e,rowExpansionStateChanged:e,pinnedRowsChanged:e,displayedRowsChanged:e,sortChanged:i,filterChanged:i,cellFocused:this.onCellFocused.bind(this)})}isBatchEditing(){return this.batch}setBatchEditing(t){t?(this.batch=!0,this.stopEditing(void 0,tm)):(this.stopEditing(void 0,tm),this.batch=!1)}createStrategy(t){let{beans:e,gos:i,strategy:n}=this,r=dD(i,t);if(n){if(n.beanName===r)return n;this.destroyStrategy()}return this.strategy=this.createOptionalManagedBean(e.registry.createDynamicBean(r,!0))}destroyStrategy(){this.strategy&&(this.strategy.destroy(),this.strategy=this.destroyBean(this.strategy))}shouldStartEditing(t,e,i,n="ui"){let r=soe(this.beans,t,e,i,n);return r&&(this.strategy??(this.strategy=this.createStrategy())),r}shouldStopEditing(t,e,i="ui"){return this.strategy?.shouldStop(t,e,i)??null}shouldCancelEditing(t,e,i="ui"){return this.strategy?.shouldCancel(t,e,i)??null}validateEdit(){return Ote(this.beans)}isEditing(t,e){return this.model.hasEdits(t,e??Kl)}isRowEditing(t,e){return(t&&this.model.hasRowEdits(t,e))??!1}startEditing(t,e){let{startedEdit:i=!0,event:n=null,source:r="ui",ignoreEventKey:o=!1,silent:s}=e;if(this.strategy??(this.strategy=this.createStrategy()),!this.isCellEditable(t,"api"))return;let a=yt(this.beans,t);if(a&&!a.comp){a.onCompAttachedFuncs.push(()=>this.startEditing(t,e));return}let l=this.shouldStartEditing(t,n,i,r);if(l===!1&&r!=="api"){this.isEditing(t)&&this.stopEditing();return}!this.batch&&this.shouldStopEditing(t,void 0,r)&&!e.continueEditing&&this.stopEditing(void 0,{source:r}),l&&this.isBatchEditing()&&this.dispatchBatchEvent("batchEditingStarted",new Map),this.strategy.start({position:t,event:n,source:r,ignoreEventKey:o,startedEdit:i,silent:s})}stopEditing(t,e){let{event:i,cancel:n,source:r="ui",forceCancel:o,forceStop:s}=e||{},{beans:a,model:l}=this;if(moe.has(r)&&this.isBatchEditing())return this.bulkRefresh(t),!1;let c=this.committing?mI[r]:r;if(!(this.committing||this.isEditing(t)||this.isBatchEditing()&&l.hasEdits(t,Kl))||!this.strategy||this.stopping)return!1;this.stopping=!0;let u=yt(a,t);u&&(u.onEditorAttachedFuncs=[]);let h=l.getEditMap(!0),p=!1,f=!n&&(!!this.shouldStopEditing(t,i,c)||this.committing&&!this.batch)||(s??!1),g=n&&!!this.shouldCancelEditing(t,i,c)||(o??!1);if(f||g){ya(a,{persist:!0,isCancelling:g||n,isStopping:f});let m=l.getEditMap(),v=this.processEdits(m,n,r);this.strategy?.stop(n,i);for(let C of v)l.clearEditValue(C);this.bulkRefresh(void 0,h);for(let C of l.getEditPositions(m)){let b=yt(a,C),S=vo(C);b?.refreshCell({force:!0,suppressFlash:!S})}h=m,p||(p=f)}else if(i instanceof KeyboardEvent&&this.batch&&this.strategy?.midBatchInputsAllowed(t)&&this.isEditing(t,{withOpenEditor:!0})){let{key:m}=i,v=m===A.ENTER,C=m===A.ESCAPE,b=m===A.TAB;(v||b||C)&&(v||b?ya(a,{persist:!0}):C&&this.revertSingleCellEdit(u),this.isBatchEditing()?this.strategy?.cleanupEditors():dc(a,l.getEditPositions(),{event:i,cancel:C}),i.preventDefault(),this.bulkRefresh(t,h,{suppressFlash:!0}),h=l.getEditMap())}else ya(a,{persist:!0}),h=l.getEditMap();return p&&t&&this.model.removeEdits(t),this.navigateAfterEdit(e,u?.cellPosition),gS(a),this.model.hasEdits()||(this.model.getCellValidationModel().clearCellValidationMap(),this.model.getRowValidationModel().clearRowValidationMap()),this.bulkRefresh(),g&&this.beans.rowRenderer.refreshRows({rowNodes:Array.from(h.keys())}),this.isBatchEditing()&&(this.beans.rowRenderer.refreshRows({suppressFlash:!0,force:!0}),p&&f&&this.dispatchBatchEvent("batchEditingStopped",h)),this.stopping=!1,p}navigateAfterEdit(t,e){if(!t||!e)return;let{event:i,suppressNavigateAfterEdit:n}=t;if(!(i instanceof KeyboardEvent)||n)return;let{key:o,shiftKey:s}=i,a=this.gos.get("enterNavigatesVerticallyAfterEdit");if(o!==A.ENTER||!a)return;let l=s?A.UP:A.DOWN;this.beans.navigation?.navigateToNextCell(null,l,e,!1)}processEdits(t,e=!1,i){let n=Array.from(t.keys()),r=this.model.getCellValidationModel().getCellValidationMap().size>0||this.model.getRowValidationModel().getRowValidationMap().size>0,o=[];for(let s of n){let a=t.get(s);for(let l of a.keys()){let c=a.get(l),d={rowNode:s,column:l},u=vo(c);!e&&u&&!r&&(this.setNodeDataValue(s,l,c.pendingValue,void 0,i)||o.push(d))}}return o}setNodeDataValue(t,e,i,n,r="edit"){let{beans:o}=this,s=yt(o,{rowNode:t,column:e}),a=goe.has(r)?"edit":r;s&&(s.suppressRefreshCell=!0),this.commitNextEdit();let l=t.setDataValue(e,i,a);return s&&(s.suppressRefreshCell=!1),n&&s?.refreshCell(Uu),l}setEditMap(t,e){this.strategy??(this.strategy=this.createStrategy()),this.strategy?.setEditMap(t,e),this.bulkRefresh();let i=Uu;e?.forceRefreshOfEditCellsOnly&&(i=w(w({},boe(t)),Uu)),this.beans.rowRenderer.refreshCells(i)}dispatchEditValuesChanged({rowNode:t,column:e},i={}){if(!t||!e||!i)return;let{pendingValue:n,sourceValue:r}=i,{rowIndex:o,rowPinned:s,data:a}=t;this.beans.eventSvc.dispatchEvent({type:"cellEditValuesChanged",node:t,rowIndex:o,rowPinned:s,column:e,source:"api",data:a,newValue:n,oldValue:r,value:n,colDef:e.getColDef()})}bulkRefresh(t={},e,i={}){let{beans:n,gos:r}=this,{editModelSvc:o,rowModel:s}=n;Lt(r,s)&&(t.rowNode&&t.column?this.refCell(t,this.model.getEdit(t),i):e&&o?.getEditMap(!1)?.forEach((a,l)=>{for(let c of a.keys())this.refCell({rowNode:l,column:c},a.get(c),i)}))}refCell({rowNode:t,column:e},i,n={}){let{beans:r,gos:o}=this,s=new Set([t]),a=new Set,l=t.pinnedSibling;l&&s.add(l);let c=t.sibling;c&&a.add(c);let d=t.parent;for(;d;)d.sibling?.footer&&o.get("groupTotalRow")||!d.parent&&d.sibling&&o.get("grandTotalRow")?a.add(d.sibling):a.add(d),d=d.parent;for(let u of s)this.dispatchEditValuesChanged({rowNode:u,column:e},i);for(let u of s)yt(r,{rowNode:u,column:e})?.refreshCell(n);for(let u of a)yt(r,{rowNode:u,column:e})?.refreshCell(n)}stopAllEditing(t=!1,e="ui"){this.isEditing()&&this.stopEditing(void 0,{cancel:t,source:e})}isCellEditable(t,e="ui"){let{rowNode:i}=t,{gos:n,beans:r}=this;if(i.group){if(n.get("treeData")){if(!i.data&&!n.get("enableGroupEdit"))return!1}else if(!n.get("enableGroupEdit"))return!1}let o=dD(n)==="fullRow"?loe(r,t,e):yS(r,t,e);return o&&(this.strategy??(this.strategy=this.createStrategy())),o}cellEditingInvalidCommitBlocks(){return this.gos.get("invalidEditValueMode")==="block"}checkNavWithValidation(t,e,i=!0){if(this.hasValidationErrors(t)){let n=yt(this.beans,t);return this.cellEditingInvalidCommitBlocks()?(e?.preventDefault?.(),i&&(!n?.hasBrowserFocus()&&n?.focusCell(),n?.comp?.getCellEditor()?.focusIn?.()),"block-stop"):(n&&this.revertSingleCellEdit(n),"revert-continue")}return"continue"}revertSingleCellEdit(t,e=!1){let i=yt(this.beans,t);i?.comp?.getCellEditor()&&(dc(this.beans,[t],{silent:!0}),this.model.clearEditValue(t),vc(this.beans,t,{silent:!0}),Ma(this.beans),i?.refreshCell(Uu),e&&(i?.focusCell(),i?.comp?.getCellEditor()?.focusIn?.()))}hasValidationErrors(t){Ma(this.beans);let e=yt(this.beans,t);e&&(e.refreshCell(Uu),e.rowCtrl.rowEditStyleFeature?.applyRowStyles());let i=!1;return t?.rowNode?(i||(i=this.model.getRowValidationModel().hasRowValidation({rowNode:t.rowNode})),t.column&&(i||(i=this.model.getCellValidationModel().hasCellValidation({rowNode:t.rowNode,column:t.column})))):(i||(i=this.model.getCellValidationModel().getCellValidationMap().size>0),i||(i=this.model.getRowValidationModel().getRowValidationMap().size>0)),i}moveToNextCell(t,e,i,n="ui"){let r,o=this.isEditing(),s=o&&this.checkNavWithValidation(void 0,i)==="block-stop";return t instanceof uc&&o&&(r=this.strategy?.moveToNextEditingCell(t,e,i,n,s)),r===null||(r=r||!!this.beans.focusSvc.focusedHeader,r===!1&&!s&&this.stopEditing()),r}getCellDataValue({rowNode:t,column:e},i=!0){if(!t||!e)return;let n=this.model.getEdit({rowNode:t,column:e}),r=t.pinnedSibling;if(r){let s=this.model.getEdit({rowNode:r,column:e});s&&(n=s)}let o=i?n?.editorValue??n?.pendingValue:n?.pendingValue;return o===In||!n?n?.sourceValue??this.valueSvc.getValue(e,t,!1,"api"):o}addStopEditingWhenGridLosesFocus(t){Fte(this,this.beans,t)}createPopupEditorWrapper(t){return new ooe(t)}commitNextEdit(){this.committing=!0}setDataValue(t,e,i){try{if((!this.isEditing()||this.committing)&&!voe.has(i))return;let{beans:n}=this;this.strategy??(this.strategy=this.createStrategy());let r=this.isBatchEditing()?"ui":this.committing?i??"api":"api";if(!i||foe.has(i))return pm(n,t,e,i,void 0,{persist:!0}),this.setNodeDataValue(t.rowNode,t.column,e,!0,i);let o=this.model.getEdit(t);if(o){if(o.pendingValue===e)return!1;if(o.sourceValue!==e)return pm(n,t,e,i,void 0,{persist:!0}),this.stopEditing(t,{source:r,suppressNavigateAfterEdit:!0}),!0;if(o.sourceValue===e)return n.editModelSvc?.removeEdits(t),this.dispatchEditValuesChanged(t,k(w({},o),{pendingValue:e})),!0}return pm(n,t,e,i,void 0,{persist:!0}),this.stopEditing(t,{source:r,suppressNavigateAfterEdit:!0}),!0}finally{this.committing=!1}}handleColDefChanged(t){Mte(this.beans,t)}destroy(){this.model.clear(),this.destroyStrategy(),super.destroy()}prepDetailsDuringBatch(t,e){if(!this.batch||!this.model.hasRowEdits(t.rowNode,Kl))return;let{rowNode:n,column:r}=t,{compDetails:o,valueToDisplay:s}=e;if(o){let{params:l}=o;return l.data=this.model.getEditRowDataValue(n,Kl),{compDetails:o}}let a=this.model.getEditRow(t.rowNode,Kl);if(s!==void 0&&a?.has(r))return{valueToDisplay:this.valueSvc.getValue(r,n)}}cleanupEditors(){this.strategy?.cleanupEditors()}dispatchCellEvent(t,e,i,n){this.strategy?.dispatchCellEvent(t,e,i,n)}dispatchBatchEvent(t,e){this.eventSvc.dispatchEvent(this.createBatchEditEvent(t,e))}createBatchEditEvent(t,e){return Ee(this.gos,w({type:t},t==="batchEditingStopped"?{changes:this.toEventChangeList(e)}:{}))}toEventChangeList(t){return this.model.getEditPositions(t).map(e=>({rowIndex:e.rowNode.rowIndex,rowPinned:e.rowNode.rowPinned,columnId:e.column.getColId(),newValue:e.pendingValue,oldValue:e.sourceValue}))}applyBulkEdit({rowNode:t,column:e},i){if(!i||i.length===0)return;let{beans:n,rangeSvc:r,valueSvc:o}=this;ya(n,{persist:!0});let s=this.model.getEditMap(!0),a=s.get(t)?.get(e)?.pendingValue;this.batch||this.eventSvc.dispatchEvent({type:"bulkEditingStarted"}),i.forEach(c=>{if(r?.forEachRowInRange(c,d=>{let u=xo(n,d);if(u===void 0)return;let h=s.get(u)??new Map;for(let p of c.columns)if(p&&this.isCellEditable({rowNode:u,column:p},"api")){let f=o.getValue(p,u,!0,"api"),g=o.parseValue(p,u??null,a,f);Number.isNaN(g)&&(g=null),h.set(p,{editorValue:void 0,pendingValue:g,sourceValue:f,state:"changed",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}})}h.size>0&&s.set(u,h)}),this.setEditMap(s),this.batch){this.cleanupEditors(),gS(n),this.bulkRefresh();return}this.commitNextEdit(),this.stopEditing(void 0,{source:"bulk"}),this.eventSvc.dispatchEvent({type:"bulkEditingStopped",changes:this.toEventChangeList(s)})}),this.bulkRefresh();let l=yt(n,{rowNode:t,column:e});l&&l.focusCell(!0)}createCellStyleFeature(t,e){return new coe(t,e)}createRowStyleFeature(t,e){return new doe(t,e)}setEditingCells(t,e){let{beans:i}=this,{colModel:n,valueSvc:r}=i,o=new Map;for(let{colId:s,column:a,colKey:l,rowIndex:c,rowPinned:d,newValue:u,state:h}of t){let p=s?n.getCol(s):l?n.getCol(l):a;if(!p)continue;let f=xo(i,{rowIndex:c,rowPinned:d});if(!f)continue;let g=r.getValue(p,f,!0,"api");if(!e?.forceRefreshOfEditCellsOnly&&!vo({pendingValue:u,sourceValue:g})&&h!=="editing")continue;let m=o.get(f);m||(m=new Map,o.set(f,m)),u===void 0&&(u=In),m.set(p,{editorValue:void 0,pendingValue:u,sourceValue:g,state:h??"changed",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}})}this.setEditMap(o,e)}onCellFocused(t){let e=yt(this.beans,t);if(!e||!this.isEditing(e,Kl))return;let i=this.model.getEdit(e);if(!i||!vo(i))return;let r=this.getLocaleTextFunc()("ariaPendingChange","Pending Change");this.beans.ariaAnnounce?.announceValue(r,"pendingChange")}allowedFocusTargetOnValidation(t){return yt(this.beans,t)}};function boe(t){return{rowNodes:t?Array.from(t.keys()):void 0,columns:t?[...new Set(Array.from(t.values()).flatMap(e=>Array.from(e.keys())))]:void 0}}function dD(t,e){return e??t.get("editType")??"singleCell"}var vI=class extends H{postConstruct(){this.model=this.beans.editModelSvc,this.editSvc=this.beans.editSvc,this.addManagedEventListeners({cellFocused:this.onCellFocusChanged?.bind(this),cellFocusCleared:this.onCellFocusChanged?.bind(this)})}clearEdits(t){this.model.clearEditValue(t)}onCellFocusChanged(t){let e,i=t.previousParams,{editSvc:n,beans:r}=this,o=t.type==="cellFocused"?t.sourceEvent:null;i&&(e=yt(r,i));let{gos:s,editModelSvc:a}=r,l=t.type==="cellFocusCleared";if(n.isEditing(void 0,{withOpenEditor:!0})){let{column:c,rowIndex:d,rowPinned:u}=t,h={column:c,rowNode:xo(r,{rowIndex:d,rowPinned:u})},p=s.get("invalidEditValueMode")==="block";if(p)return;let f=!p,g=!!a?.getCellValidationModel().hasCellValidation(h),m=f&&g;(i||l?n.stopEditing(void 0,{cancel:m,source:l&&f?"api":void 0,event:o}):!0)||(n.isBatchEditing()?n.cleanupEditors():n.stopEditing(void 0,{source:"api"}))}e?.refreshCell({suppressFlash:!0,force:!0})}stop(t,e){let i=this.model.getEditPositions(),n={all:[],pass:[],fail:[]};for(let r of i){if(n.all.push(r),(this.model.getCellValidationModel().getCellValidation(r)?.errorMessages?.length??0)>0){n.fail.push(r);continue}n.pass.push(r)}if(t)for(let r of i)Im(this.beans,r,{cancel:t}),this.model.stop(r);else{let r=this.processValidationResults(n);if(r.destroy.length>0)for(let o of r.destroy)Im(this.beans,o,{event:e,cancel:t}),this.model.stop(o);if(r.keep.length>0)for(let o of r.keep){let s=yt(this.beans,o);this.editSvc?.cellEditingInvalidCommitBlocks()||s&&this.editSvc.revertSingleCellEdit(s)}}return!0}cleanupEditors({rowNode:t}={},e){ya(this.beans,{persist:!1});let i=this.model.getEditPositions(),n=[];if(t)for(let r of i)r.rowNode!==t&&n.push(r);else for(let r of i)n.push(r);dc(this.beans,n),gS(this.beans,e)}setFocusOutOnEditor(t){t.comp?.getCellEditor()?.focusOut?.()}setFocusInOnEditor(t){let e=t.comp,i=e?.getCellEditor();if(i?.focusIn)i.focusIn();else{let n=this.beans.gos.get("editType")==="fullRow";t.focusCell(n),t.onEditorAttachedFuncs.push(()=>e?.getCellEditor()?.focusIn?.())}}setupEditors(t){let{event:e,ignoreEventKey:i=!1,startedEdit:n,position:r,cells:o=this.model.getEditPositions()}=t,s=e instanceof KeyboardEvent&&!i&&e.key||void 0;Dte(this.beans,o,r,s,e,n)}dispatchCellEvent(t,e,i,n){let r=yt(this.beans,t);r&&this.eventSvc.dispatchEvent(w(w({},r.createEvent(e??null,i)),n))}dispatchRowEvent(t,e,i){if(i)return;let n=o2(this.beans,t);n&&this.eventSvc.dispatchEvent(n.createRowEvent(e))}shouldStop(t,e,i="ui"){let n=this.editSvc.isBatchEditing();return n&&i==="api"?!0:n&&(i==="ui"||i==="edit")?!1:i==="api"?!0:e instanceof KeyboardEvent&&!n?e.key===A.ENTER:null}shouldCancel(t,e,i="ui"){let n=this.editSvc.isBatchEditing();return!!(e instanceof KeyboardEvent&&!n&&e.key===A.ESCAPE||n&&i==="api"||i==="api")}setEditMap(t,e){e?.update||this.editSvc.stopEditing(void 0,{cancel:!0,source:"api"});let i=[];if(t.forEach((n,r)=>{n.forEach((o,s)=>{o.state==="editing"&&i.push(k(w({},o),{rowNode:r,column:s}))})}),e?.update&&(t=new Map([...this.model.getEditMap(),...t])),this.model?.setEditMap(t),i.length>0){let n=i.at(-1),r=n.pendingValue===In?void 0:n.pendingValue;this.start({position:n,event:new KeyboardEvent("keydown",{key:r}),source:"api"});let o=yt(this.beans,n);o&&this.setFocusInOnEditor(o)}}destroy(){this.cleanupEditors(),super.destroy()}},yoe=class extends vI{constructor(){super(...arguments),this.beanName="fullRow",this.startedRows=[]}shouldStop(t,e,i="ui"){let{rowNode:n}=t||{};if(!o2(this.beans,{rowNode:this.rowNode}))return!0;let o=super.shouldStop({rowNode:this.rowNode},e,i);return o!==null?o:this.rowNode?n!==this.rowNode:!1}midBatchInputsAllowed({rowNode:t}){return t?this.model.hasEdits({rowNode:t}):!1}clearEdits(t){this.model.clearEditValue(t)}start(t){let{position:e,silent:i,startedEdit:n,event:r,ignoreEventKey:o}=t,{rowNode:s}=e;this.rowNode!==s&&super.cleanupEditors(e);let a=this.beans.visibleCols.allCols,l=[],c=[];for(let d of a)d.isCellEditable(s)&&c.push(d);if(c.length!=0){this.dispatchRowEvent({rowNode:s},"rowEditingStarted",i),this.startedRows.push(s);for(let d of c){let u={rowNode:s,column:d};l.push(u),this.model.hasEdits(u)||this.model.start(u)}this.rowNode=s,this.setupEditors({cells:l,position:e,startedEdit:n,event:r,ignoreEventKey:o})}}processValidationResults(t){return t.fail.length>0&&this.editSvc.cellEditingInvalidCommitBlocks()?{destroy:[],keep:t.all}:{destroy:t.all,keep:[]}}stop(t,e){let{rowNode:i}=this;if(i&&!this.model.hasRowEdits(i))return!1;let n=[];if(t||this.model.getEditMap().forEach((r,o)=>{if(!(!r||r.size===0)){for(let s of r.values())if(vo(s)){n.push(o);break}}}),Ma(this.beans),!t&&this.editSvc?.checkNavWithValidation({rowNode:i})==="block-stop")return!1;super.stop(t,e);for(let r of n)this.dispatchRowEvent({rowNode:r},"rowValueChanged");return this.cleanupEditors({rowNode:i},!0),this.rowNode=void 0,!0}onCellFocusChanged(t){let{rowIndex:e}=t,i=t.previousParams;if(i?.rowIndex===e||t.sourceEvent instanceof KeyboardEvent)return;let n=yt(this.beans,i);this.gos.get("invalidEditValueMode")==="block"&&n&&(this.model.getCellValidationModel().getCellValidation(n)||this.model.getRowValidationModel().getRowValidation(n))||super.onCellFocusChanged(t)}cleanupEditors(t={},e){super.cleanupEditors(t,e);for(let i of this.startedRows)this.dispatchRowEvent({rowNode:i},"rowEditingStopped");this.startedRows.length=0}moveToNextEditingCell(t,e,i,n="ui",r=!1){let o=t.cellPosition,s;this.model.suspend(!0);try{s=this.beans.navigation?.findNextCellToFocusOn(o,{backwards:e,startEditing:!0,skipToNextEditableCell:!1})}finally{this.model.suspend(!1)}if(s===!1)return null;if(s==null)return!1;let a=s.cellPosition,l=t.isCellEditable(),c=s.isCellEditable(),d=a&&o.rowIndex===a.rowIndex&&o.rowPinned===a.rowPinned;l&&this.setFocusOutOnEditor(t),this.restoreEditors();let u=this.gos.get("suppressStartEditOnTab");return c&&!r?u?s.focusCell(!0,i):(s.comp?.getCellEditor()||vc(this.beans,s,{event:i,cellStartedEdit:!0}),this.setFocusInOnEditor(s),s.focusCell(!1,i)):(c&&r&&this.setFocusInOnEditor(s),s.focusCell(!0,i)),!d&&!r&&(this.editSvc?.stopEditing({rowNode:t.rowNode},{event:i}),this.cleanupEditors(s,!0),u?s.focusCell(!0,i):this.editSvc.startEditing(s,{startedEdit:!0,event:i,source:n,ignoreEventKey:!0})),t.rowCtrl?.refreshRow({suppressFlash:!0,force:!0}),!0}restoreEditors(){this.model.getEditMap().forEach((t,e)=>t.forEach(({state:i},n)=>{if(i!=="editing")return;let r=yt(this.beans,{rowNode:e,column:n});r&&!r.comp?.getCellEditor()&&vc(this.beans,r,{silent:!0})}))}destroy(){super.destroy(),this.rowNode=void 0,this.startedRows.length=0}},Soe=class extends vI{constructor(){super(...arguments),this.beanName="singleCell"}shouldStop(t,e,i="ui"){let n=super.shouldStop(t,e,i);if(n!==null)return n;let{rowNode:r,column:o}=t||{};return(!this.rowNode||!this.column)&&r&&o?null:this.rowNode!==r||this.column!==o}midBatchInputsAllowed(t){return this.model.hasEdits(t)}start(t){let{position:e,startedEdit:i,event:n,ignoreEventKey:r}=t;(this.rowNode!==e.rowNode||this.column!==e.column)&&super.cleanupEditors(),this.rowNode=e.rowNode,this.column=e.column,this.model.start(e),this.setupEditors({cells:[e],position:e,startedEdit:i,event:n,ignoreEventKey:r})}dispatchRowEvent(t,e,i){}processValidationResults(t){return t.fail.length>0&&this.editSvc.cellEditingInvalidCommitBlocks()?{destroy:[],keep:t.all}:{destroy:t.all,keep:[]}}stop(t,e){return super.stop(t,e),this.rowNode=void 0,this.column=void 0,!0}onCellFocusChanged(t){let{colModel:e,editSvc:i}=this.beans,{rowIndex:n,column:r,rowPinned:o}=t,s=xo(this.beans,{rowIndex:n,rowPinned:o}),a=fS(r),l=e.getCol(a),c=t.previousParams;if(c){let d=fS(c.column);if(c?.rowIndex===n&&d===a&&c?.rowPinned===o)return}i?.isEditing({rowNode:s,column:l},{withOpenEditor:!0})&&t.type==="cellFocused"||super.onCellFocusChanged(t)}moveToNextEditingCell(t,e,i,n="ui",r=!1){let o=this.beans.focusSvc.getFocusedCell();o&&(t=ec(this.beans,o)??t);let s=t.cellPosition,a,l=this.beans.gos.get("editType")==="fullRow";l&&this.model.suspend(!0),r||(t.eGui.focus(),this.editSvc?.stopEditing(t,{source:this.editSvc?.isBatchEditing()?"ui":"api",event:i}));try{a=this.beans.navigation?.findNextCellToFocusOn(s,{backwards:e,startEditing:!0})}finally{l&&this.model.suspend(!1)}if(a===!1)return null;if(a==null)return!1;let c=a.cellPosition,d=t.isCellEditable(),u=a.isCellEditable(),h=c&&s.rowIndex===c.rowIndex&&s.rowPinned===c.rowPinned;d&&!r&&this.setFocusOutOnEditor(t);let p=this.gos.get("suppressStartEditOnTab");if(!h&&!r&&(super.cleanupEditors(a,!0),p?a.focusCell(!0,i):this.editSvc.startEditing(a,{startedEdit:!0,event:i,source:n,ignoreEventKey:!0})),u&&!r){if(a.focusCell(!1,i),p)a.focusCell(!0,i);else if(!a.comp?.getCellEditor()){let f=this.editSvc?.isEditing(a,{withOpenEditor:!0});vc(this.beans,a,{event:i,cellStartedEdit:!0,silent:f}),this.setFocusInOnEditor(a),this.cleanupEditors(a)}}else u&&r&&this.setFocusInOnEditor(a),a.focusCell(!0,i);return t.rowCtrl?.refreshRow({suppressFlash:!0,force:!0}),!0}destroy(){super.destroy(),this.rowNode=void 0,this.column=void 0}},Rs={moduleName:"EditCore",version:oe,beans:[kte,woe],apiFunctions:{getEditingCells:Jre,getEditRowValues:Xre,getCellEditorInstances:Tte,startEditingCell:eoe,stopEditing:Qre,isEditing:Zre,validateEdit:toe},dynamicBeans:{singleCell:Soe,fullRow:yoe},dependsOn:[$m,cI],css:[_re]},xoe={moduleName:"UndoRedoEdit",version:oe,beans:[Rre],apiFunctions:{undoCellEditing:Kre,redoCellEditing:Yre,getCurrentUndoSize:ioe,getCurrentRedoSize:noe},dependsOn:[Rs]},Eoe={moduleName:"TextEditor",version:oe,userComponents:{agCellEditor:cD,agTextCellEditor:cD},dependsOn:[Rs]},Poe={moduleName:"NumberEditor",version:oe,userComponents:{agNumberCellEditor:{classImp:zre}},dependsOn:[Rs]},Roe={moduleName:"DateEditor",version:oe,userComponents:{agDateCellEditor:Mre,agDateStringCellEditor:Ore},dependsOn:[Rs]},_oe={moduleName:"CheckboxEditor",version:oe,userComponents:{agCheckboxCellEditor:Fre},dependsOn:[Rs]},koe={moduleName:"SelectEditor",version:oe,userComponents:{agSelectCellEditor:Gre},dependsOn:[Rs]},Foe={moduleName:"LargeTextEditor",version:oe,userComponents:{agLargeTextCellEditor:Nre},dependsOn:[Rs]},Toe={moduleName:"CustomEditor",version:oe,dependsOn:[Rs]},Doe=class extends H{constructor(){super(...arguments),this.beanName="selectionColSvc"}postConstruct(){this.addManagedPropertyListener("rowSelection",t=>{this.onSelectionOptionsChanged(t.currentValue,t.previousValue,sc(t.source))}),this.addManagedPropertyListener("selectionColumnDef",this.updateColumns.bind(this))}addColumns(t){let e=this.columns;e!=null&&(t.list=e.list.concat(t.list),t.tree=e.tree.concat(t.tree),jq(t))}createColumns(t,e){let i=()=>{Em(this.beans,this.columns?.tree),this.columns=null},n=t.treeDepth,o=(this.columns?.treeDepth??-1)==n,s=this.generateSelectionCols();if(Uq(s,this.columns?.list??[])&&o)return;i();let{colGroupSvc:l}=this.beans,c=l?.findDepth(t.tree)??0,d=l?.balanceTreeForAutoCols(s,c)??[];this.columns={list:s,tree:d,treeDepth:c,map:{}},e(h=>{if(!h)return null;let p=h.filter(f=>!Po(f));return[...s,...p]})}updateColumns(t){let e=sc(t.source);for(let i of this.columns?.list??[]){let n=this.createSelectionColDef(t.currentValue);i.setColDef(n,null,e),Zn(this.beans,{state:[k(w({},n),{colId:i.getColId()})]},e)}}getColumn(t){return this.columns?.list.find(e=>Zu(e,t))??null}getColumns(){return this.columns?.list??null}isSelectionColumnEnabled(){let{gos:t,beans:e}=this,i=t.get("rowSelection");if(typeof i!="object"||!xa(t))return!1;let n=(e.autoColSvc?.getColumns()?.length??0)>0;if(i.checkboxLocation==="autoGroupColumn"&&n)return!1;let r=!!oc(i),o=om(i);return r||o}createSelectionColDef(t){let{gos:e}=this,i=t??e.get("selectionColumnDef"),n=e.get("enableRtl"),a=i??{},{rowSpan:r,spanRows:o}=a,s=Vt(a,["rowSpan","spanRows"]);return k(w({width:50,resizable:!1,suppressHeaderMenuButton:!0,sortable:!1,suppressMovable:!0,lockPosition:n?"right":"left",comparator(l,c,d,u){let h=d.isSelected(),p=u.isSelected();return h===p?0:h?1:-1},editable:!1,suppressFillHandle:!0,pinned:null},s),{colId:iM,chartDataType:"excluded"})}generateSelectionCols(){if(!this.isSelectionColumnEnabled())return[];let t=this.createSelectionColDef(),e=t.colId;this.gos.validateColDef(t,e,!0);let i=new Aa(t,null,e,!1);return this.createBean(i),[i]}onSelectionOptionsChanged(t,e,i){let n=e&&typeof e!="string"?oc(e):void 0,r=t&&typeof t!="string"?oc(t):void 0,o=n!==r,s=e&&typeof e!="string"?om(e):void 0,a=t&&typeof t!="string"?om(t):void 0,l=s!==a,c=ym(t),d=ym(e);(o||l||c!==d)&&this.beans.colModel.refreshAll(i)}destroy(){Em(this.beans,this.columns?.tree),super.destroy()}refreshVisibility(t,e,i){if(!this.columns?.list.length)return;let n=t.length+e.length+i.length;if(n===0)return;let r=this.columns.list[0];if(!r.isVisible())return;let o=()=>{let l;switch(r.pinned){case"left":case!0:l=t;break;case"right":l=i;break;default:l=e}l&&er(l,r)};(this.beans.rowNumbersSvc?.getColumn(nM)?2:1)===n&&o()}};function Moe(t,e){if(!e.nodes.every(s=>s.rowPinned&&!xh(s)?(K(59),!1):s.id===void 0?(K(60),!1):!0))return;let{nodes:n,source:r,newValue:o}=e;t.selectionSvc?.setNodesSelected({nodes:n,source:r??"api",newValue:o})}function Ioe(t,e,i="apiSelectAll"){t.selectionSvc?.selectAllRowNodes({source:i,selectAll:e})}function Aoe(t,e,i="apiSelectAll"){t.selectionSvc?.deselectAllRowNodes({source:i,selectAll:e})}function Ooe(t,e="apiSelectAllFiltered"){t.selectionSvc?.selectAllRowNodes({source:e,selectAll:"filtered"})}function Loe(t,e="apiSelectAllFiltered"){t.selectionSvc?.deselectAllRowNodes({source:e,selectAll:"filtered"})}function Noe(t,e="apiSelectAllCurrentPage"){t.selectionSvc?.selectAllRowNodes({source:e,selectAll:"currentPage"})}function Boe(t,e="apiSelectAllCurrentPage"){t.selectionSvc?.deselectAllRowNodes({source:e,selectAll:"currentPage"})}function Hoe(t){return t.selectionSvc?.getSelectedNodes()??[]}function zoe(t){return t.selectionSvc?.getSelectedRows()??[]}var Voe=class extends nJ{constructor(){super(...arguments),this.beanName="selectionSvc",this.selectedNodes=new Map,this.detailSelection=new Map,this.masterSelectsDetail=!1}postConstruct(){super.postConstruct();let{gos:t}=this;this.mode=Sm(t),this.groupSelectsDescendants=uh(t),this.groupSelectsFiltered=xm(t)==="filteredDescendants",this.masterSelectsDetail=tT(t)==="detail",this.addManagedPropertyListeners(["groupSelectsChildren","groupSelectsFiltered","rowSelection"],()=>{let e=uh(t),i=Sm(t),n=xm(t)==="filteredDescendants";this.masterSelectsDetail=tT(t)==="detail",(e!==this.groupSelectsDescendants||n!==this.groupSelectsFiltered||i!==this.mode)&&(this.deselectAllRowNodes({source:"api"}),this.groupSelectsDescendants=e,this.groupSelectsFiltered=n,this.mode=i)}),this.addManagedEventListeners({rowSelected:this.onRowSelected.bind(this)})}destroy(){super.destroy(),this.resetNodes()}handleSelectionEvent(t,e,i){if(this.isRowSelectionBlocked(e))return 0;let n=this.inferNodeSelections(e,t.shiftKey,t.metaKey||t.ctrlKey,i);if(n==null)return 0;if(this.selectionCtx.selectAll=!1,"select"in n)return n.reset?this.resetNodes():this.selectRange(n.deselect,!1,i),this.selectRange(n.select,!0,i);{let r=n.checkFilteredNodes?wI(n.node):n.newValue;return this.setNodesSelected({nodes:[n.node],newValue:r,clearSelection:n.clearSelection,keepDescendants:n.keepDescendants,event:t,source:i})}}setNodesSelected({newValue:t,clearSelection:e,suppressFinishActions:i,nodes:n,event:r,source:o,keepDescendants:s=!1}){if(n.length===0)return 0;let{gos:a}=this;if(!xa(a)&&t)return K(132),0;if(n.length>1&&!this.isMultiSelect())return K(130),0;let l=0;for(let c=0;c<n.length;c++){let d=n[c],u=Yl(d);if(u.rowPinned&&!xh(u)){K(59);continue}if(u.id===void 0){K(60);continue}this.groupSelectsFiltered&&u.group&&!a.get("treeData")||this.selectRowNode(u,t,r,o)&&(this.detailSelection.delete(u.id),l++),this.groupSelectsDescendants&&u.childrenAfterGroup?.length&&(l+=this.selectChildren(u,t,o))}return i||(n.length===1&&o==="api"&&this.selectionCtx.setRoot(Yl(n[0])),t&&(e||!this.isMultiSelect())&&(l+=this.clearOtherNodes(Yl(n[0]),s,o)),l>0&&(this.updateGroupsFromChildrenSelections(o),this.dispatchSelectionChanged(o))),l}selectRange(t,e,i){let n=0;return t.forEach(r=>{let o=Yl(r);if(o.group&&this.groupSelectsDescendants)return;this.selectRowNode(o,e,void 0,i)&&n++}),n>0&&(this.updateGroupsFromChildrenSelections(i),this.dispatchSelectionChanged(i)),n}selectChildren(t,e,i){let n=this.groupSelectsFiltered?t.childrenAfterAggFilter:t.childrenAfterGroup;return n?this.setNodesSelected({newValue:e,clearSelection:!1,suppressFinishActions:!0,source:i,nodes:n}):0}getSelectedNodes(){return Array.from(this.selectedNodes.values())}getSelectedRows(){let t=[];return this.selectedNodes.forEach(e=>e.data&&t.push(e.data)),t}getSelectionCount(){return this.selectedNodes.size}filterFromSelection(t){let e=new Map;this.selectedNodes.forEach((i,n)=>{t(i)&&e.set(n,i)}),this.selectedNodes=e}updateGroupsFromChildrenSelections(t,e){if(!this.groupSelectsDescendants)return!1;let{gos:i,rowModel:n}=this.beans;if(!Lt(i,n))return!1;let r=n.rootNode;if(!r)return!1;e||(e=new fh(!0,r),e.active=!1);let o=!1;return e.forEachChangedNodeDepthFirst(s=>{if(s!==r){let a=this.calculateSelectedFromChildren(s);o=this.selectRowNode(s,a===null?!1:a,void 0,t)||o}}),o}clearOtherNodes(t,e,i){let n=new Map,r=0;return this.selectedNodes.forEach(o=>{let s=o.id==t.id;if((e?!Woe(t,o):!0)&&!s){let l=this.selectedNodes.get(o.id);r+=this.setNodesSelected({nodes:[l],newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:i}),this.groupSelectsDescendants&&o.parent&&n.set(o.parent.id,o.parent)}}),n.forEach(o=>{let s=this.calculateSelectedFromChildren(o);this.selectRowNode(o,s===null?!1:s,void 0,i)}),r}onRowSelected(t){let e=t.node;this.groupSelectsDescendants&&e.group||(e.isSelected()?this.selectedNodes.set(e.id,e):this.selectedNodes.delete(e.id))}syncInRowNode(t,e){this.syncInOldRowNode(t,e),this.syncInNewRowNode(t)}createDaemonNode(t){if(!t.id)return;let e=new ys(this.beans);return e.id=t.id,e.data=t.data,e.__selected=t.__selected,e.level=t.level,e}syncInOldRowNode(t,e){e&&t.id!==e.id&&this.selectedNodes.get(e.id)==t&&this.selectedNodes.set(e.id,e)}syncInNewRowNode(t){this.selectedNodes.has(t.id)?(t.__selected=!0,this.selectedNodes.set(t.id,t)):t.__selected=!1}reset(t){let e=this.getSelectionCount();this.resetNodes(),e&&this.dispatchSelectionChanged(t)}resetNodes(){this.selectedNodes.forEach(t=>{this.selectRowNode(t,!1)}),this.selectedNodes.clear()}getBestCostNodeSelection(){let{gos:t,rowModel:e}=this.beans;if(!Lt(t,e))return;let i=e.getTopLevelNodes();if(i===null)return;let n=[];function r(o){for(let s=0,a=o.length;s<a;s++){let l=o[s];l.isSelected()?n.push(l):l.group&&l.childrenAfterGroup&&r(l.childrenAfterGroup)}}return r(i),n}isEmpty(){return this.getSelectionCount()===0}deselectAllRowNodes({source:t,selectAll:e}){let i=Lt(this.gos),n=!1,r=o=>{let s=this.selectRowNode(Yl(o),!1,void 0,t);n||(n=s)};if(e==="currentPage"||e==="filtered"){if(!i){at(102);return}this.getNodesToSelect(e).forEach(r)}else this.selectedNodes.forEach(r),this.reset(t);if(this.selectionCtx.selectAll=!1,i&&this.groupSelectsDescendants){let o=this.updateGroupsFromChildrenSelections(t);n||(n=o)}n&&this.dispatchSelectionChanged(t)}getSelectedCounts(t){let e=0,i=0;return this.getNodesToSelect(t).forEach(n=>{this.groupSelectsDescendants&&n.group||(n.isSelected()?e++:n.selectable&&i++)}),{selectedCount:e,notSelectedCount:i}}getSelectAllState(t){let{selectedCount:e,notSelectedCount:i}=this.getSelectedCounts(t);return CI(e,i)??null}hasNodesToSelect(t){return this.getNodesToSelect(t).filter(e=>e.selectable).length>0}getNodesToSelect(t){if(!this.canSelectAll())return[];let e=[],i=r=>e.push(r);if(t==="currentPage")return this.forEachNodeOnPage(r=>{if(!r.group){i(r);return}if(!r.expanded&&!r.footer){let o=s=>{i(s),s.childrenAfterFilter?.forEach(o)};o(r);return}this.groupSelectsDescendants||i(r)}),e;let n=this.beans.rowModel;return t==="filtered"?(n.forEachNodeAfterFilter(i),e):(n.forEachNode(i),e)}forEachNodeOnPage(t){let{pageBounds:e,rowModel:i}=this.beans,n=e.getFirstRow(),r=e.getLastRow();for(let o=n;o<=r;o++){let s=i.getRow(o);s&&t(s)}}selectAllRowNodes(t){let{gos:e,selectionCtx:i}=this;if(!xa(e)){K(132);return}if(Dq(e)&&!dh(e)){K(130);return}if(!this.canSelectAll())return;let{source:n,selectAll:r}=t,o=!1;if(this.getNodesToSelect(r).forEach(s=>{let a=this.selectRowNode(Yl(s),!0,void 0,n);o||(o=a)}),i.selectAll=!0,Lt(e)&&this.groupSelectsDescendants){let s=this.updateGroupsFromChildrenSelections(n);o||(o=s)}o&&this.dispatchSelectionChanged(n)}getSelectionState(){return this.isEmpty()?null:Array.from(this.selectedNodes.keys())}setSelectionState(t,e,i){if(t||(t=[]),!Array.isArray(t)){at(103);return}let n=new Set(t),r=[];this.beans.rowModel.forEachNode(o=>{n.has(o.id)&&r.push(o)}),i&&this.resetNodes(),this.setNodesSelected({newValue:!0,nodes:r,source:e})}canSelectAll(){return Lt(this.beans.gos)}updateSelectable(t){let{gos:e,rowModel:i}=this.beans;if(!xa(e))return;let n="selectableChanged",r=t!==void 0,o=Lt(e)&&this.groupSelectsDescendants,s=[],a=l=>{if(r&&!l.group)return;if(o&&l.group){let d=l.childrenAfterGroup?.some(u=>u.selectable)??!1;this.setRowSelectable(l,d,!0);return}!this.updateRowSelectable(l,!0)&&l.isSelected()&&s.push(l)};if(o){if(t===void 0){let l=i.rootNode;t=l?new fh(!1,l):void 0}t?.forEachChangedNodeDepthFirst(a,!r,!r)}else i.forEachNode(a);s.length&&this.setNodesSelected({nodes:s,newValue:!1,source:n}),!r&&o&&this.updateGroupsFromChildrenSelections?.(n)}updateSelectableAfterGrouping(t){this.updateSelectable(t),this.groupSelectsDescendants&&this.updateGroupsFromChildrenSelections?.("rowGroupChanged",t)&&this.dispatchSelectionChanged("rowGroupChanged")}refreshMasterNodeState(t,e){if(!this.masterSelectsDetail)return;let i=t.detailNode?.detailGridInfo?.api;if(!i)return;let n=Goe(i);if(t.isSelected()!==n&&this.selectRowNode(t,n,e,"masterDetail")&&this.dispatchSelectionChanged("masterDetail"),!n){let o=this.detailSelection.get(t.id)??new Set;for(let s of i.getSelectedNodes())o.add(s.id);this.detailSelection.set(t.id,o)}}setDetailSelectionState(t,e,i){if(this.masterSelectsDetail){if(!dh(e)){K(269);return}switch(t.isSelected()){case!0:{i.selectAll();break}case!1:{i.deselectAll();break}case void 0:{let n=this.detailSelection.get(t.id);if(n){let r=[];for(let o of n){let s=i.getRowNode(o);s&&r.push(s)}i.setNodesSelected({nodes:r,newValue:!0,source:"masterDetail"})}break}default:break}}}dispatchSelectionChanged(t){this.eventSvc.dispatchEvent({type:"selectionChanged",source:t,selectedNodes:this.getSelectedNodes(),serverSideState:null})}};function Yl(t){return xh(t)?t.pinnedSibling:t.footer?t.sibling:t}function Goe(t){let e=0,i=0;return t.forEachNode(n=>{n.isSelected()?e++:n.selectable&&i++}),CI(e,i)}function CI(t,e){if(t===0&&e===0)return!1;if(!(t>0&&e>0))return t>0}function Woe(t,e){let i=e.parent;for(;i;){if(i===t)return!0;i=i.parent}return!1}function wI(t){let e=t.isSelected()===!1,i=t.childrenAfterFilter?.some(wI)??!1;return e||i}var Uoe={moduleName:"SharedRowSelection",version:oe,beans:[Doe],apiFunctions:{setNodesSelected:Moe,selectAll:Ioe,deselectAll:Aoe,selectAllFiltered:Ooe,deselectAllFiltered:Loe,selectAllOnCurrentPage:Noe,deselectAllOnCurrentPage:Boe,getSelectedNodes:Hoe,getSelectedRows:zoe}},joe={moduleName:"RowSelection",version:oe,rowModels:["clientSide","infinite","viewport"],beans:[Voe],dependsOn:[Uoe]};function qoe(t){t.expansionSvc?.expandAll(!0)}function $oe(t){t.expansionSvc?.expandAll(!1)}function bI(t){t.rowModel?.onRowHeightChanged()}function yI(t){if(t.rowAutoHeight?.active){K(3);return}t.rowModel?.resetRowHeights()}function Koe(t,e,i){let n=Yie(t);if(n){if(t.rowGroupColsSvc?.columns.length===0){if(e<0){at(238);return}n.setRowCount(e,i);return}at(28);return}qm(t)?.setRowCount(e,i)}function Yoe(t){return wc(t.gos)?t.rowModel.getBlockStates():t.rowNodeBlockLoader?.getBlockState()??{}}function Xoe(t){return t.rowModel.isLastRowIndexKnown()}var Joe={moduleName:"CsrmSsrmSharedApi",version:oe,apiFunctions:{expandAll:qoe,collapseAll:$oe}},Qoe={moduleName:"RowModelSharedApi",version:oe,apiFunctions:{onRowHeightChanged:bI,resetRowHeights:yI}},Zoe={moduleName:"SsrmInfiniteSharedApi",version:oe,apiFunctions:{setRowCount:Koe,getCacheBlockState:Yoe,isLastRowIndexKnown:Xoe}},ese=class extends H{constructor(){super(...arguments),this.beanName="alignedGridsSvc",this.consuming=!1}getAlignedGridApis(){let t=this.gos.get("alignedGrids")??[],e=typeof t=="function";return typeof t=="function"&&(t=t()),t.map(n=>{if(!n){at(18),e||at(20);return}if(this.isGridApi(n))return n;let r=n;return"current"in r?r.current?.api:(r.api||at(19),r.api)}).filter(n=>!!n&&!n.isDestroyed())}isGridApi(t){return!!t&&!!t.dispatchEvent}postConstruct(){let t=this.fireColumnEvent.bind(this);this.addManagedEventListeners({columnMoved:t,columnVisible:t,columnPinned:t,columnGroupOpened:t,columnResized:t,bodyScroll:this.fireScrollEvent.bind(this),alignedGridColumn:({event:e})=>this.onColumnEvent(e),alignedGridScroll:({event:e})=>this.onScrollEvent(e)})}fireEvent(t){if(!this.consuming)for(let e of this.getAlignedGridApis())e.isDestroyed()||e.dispatchEvent(t)}onEvent(t){this.consuming=!0,t(),this.consuming=!1}fireColumnEvent(t){this.fireEvent({type:"alignedGridColumn",event:t})}fireScrollEvent(t){t.direction==="horizontal"&&this.fireEvent({type:"alignedGridScroll",event:t})}onScrollEvent(t){this.onEvent(()=>{this.beans.ctrlsSvc.getScrollFeature().setHorizontalScrollPosition(t.left,!0)})}extractDataFromEvent(t,e){let i=[];return t.columns?t.columns.forEach(n=>{i.push(e(n))}):t.column&&i.push(e(t.column)),i}getMasterColumns(t){return this.extractDataFromEvent(t,e=>e)}getColumnIds(t){return this.extractDataFromEvent(t,e=>e.getColId())}onColumnEvent(t){this.onEvent(()=>{switch(t.type){case"columnMoved":case"columnVisible":case"columnPinned":case"columnResized":{this.processColumnEvent(t);break}case"columnGroupOpened":{this.processGroupOpenedEvent(t);break}case"columnPivotChanged":K(21);break}})}processGroupOpenedEvent(t){let{colGroupSvc:e}=this.beans;if(e)for(let i of t.columnGroups){let n=null;i&&(n=e.getProvidedColGroup(i.getGroupId())),!(i&&!n)&&e.setColumnGroupOpened(n,i.isExpanded(),"alignedGridChanged")}}processColumnEvent(t){let e=t.column,i=null,n=this.beans,{colResize:r,ctrlsSvc:o,colModel:s}=n;if(e&&(i=s.getColDefCol(e.getColId())),e&&!i)return;let a=this.getMasterColumns(t);switch(t.type){case"columnMoved":{let u=t.api.getColumnState().map(h=>({colId:h.colId}));Zn(n,{state:u,applyOrder:!0},"alignedGridChanged")}break;case"columnVisible":{let u=t.api.getColumnState().map(h=>({colId:h.colId,hide:h.hide}));Zn(n,{state:u},"alignedGridChanged")}break;case"columnPinned":{let u=t.api.getColumnState().map(h=>({colId:h.colId,pinned:h.pinned}));Zn(n,{state:u},"alignedGridChanged")}break;case"columnResized":{let d=t,u={};for(let h of a)u[h.getId()]={key:h.getColId(),newWidth:h.getActualWidth()};for(let h of d.flexColumns??[])u[h.getId()]&&delete u[h.getId()];r?.setColumnWidths(Object.values(u),!1,d.finished,"alignedGridChanged");break}}let c=o.getGridBodyCtrl().isVerticalScrollShowing();for(let d of this.getAlignedGridApis())d.setGridOption("alwaysShowVerticalScroll",c)}},tse={moduleName:"AlignedGrids",version:oe,beans:[ese],dependsOn:[C8]},ise=class extends H{constructor(t){super(),this.rootNode=t,this.nextId=0,this.allNodesMap={},uD(t)}getRowNode(t){return this.allNodesMap[t]}setNewRowData(t){let{selectionSvc:e,pinnedRowModel:i,groupStage:n}=this.beans;e?.reset("rowDataChanged"),i?.isManual()&&i.reset(),this.dispatchRowDataUpdateStarted(t),this.allNodesMap=Object.create(null),this.nextId=0;let r=uD(this.rootNode),o=new Array(t.length);r._leafs=o;let s=0,a=n?.getNestedDataGetter(),l=a?new Set:null,c=(d,u)=>{let h=d.level+1;for(let p=0,f=u.length;p<f;++p){let g=u[p];if(!g)continue;let m=this.createRowNode(g,h);if(m.sourceRowIndex=s,o[s++]=m,l&&!l.has(g)){l.add(g),m.treeParent=d;let v=a(g);v&&c(m,v)}}};c(r,t),o.length=s}setImmutableRowData(t,e){let{rootNode:i,gos:n}=this;this.dispatchRowDataUpdateStarted(e);let r=pc(n),o=t.changedRowNodes,{adds:s,updates:a}=o,l=new Set,c=[],d=this.beans.groupStage?.getNestedDataGetter(),u=n.get("suppressMaintainUnsortedOrder")?void 0:!1,h=-1,p=!1,f=(v,C)=>{if(!u&&u!==void 0){let b=v.sourceRowIndex;u=b<=h,h=b}v.data!==C&&(v.updateData(C),s.has(v)||a.add(v),!v.selectable&&v.isSelected()&&c.push(v))},g=(v,C,b)=>{for(let S=0,x=C.length;S<x;++S){let E=C[S];if(!E)continue;let P=this.getRowNode(r({data:E,level:b}));if(P?(f(P,E),p||(p=!!d&&P.treeParent!==v)):(P=this.createRowNode(E,b),s.add(P)),!d||l.has(P)){l.add(P);continue}l.add(P),P.treeParent=v;let L=d(E);L&&g(P,L,b+1)}};g(i,e,0);let m=this.deleteUnusedNodes(l,o,c)||u||s.size>0;if(m){let v=i._leafs??(i._leafs=[]);u===void 0?ase(v,l,o):sse(v,l)&&(o.reordered=!0)}(m||p||a.size)&&(t.rowDataUpdated=!0,this.deselect(c))}deleteUnusedNodes(t,{removals:e},i){let n=this.rootNode._leafs;for(let r=0,o=n.length;r<o;r++){let s=n[r];t.has(s)||(e.add(s),s.isSelected()&&i.push(s),this.deleteNode(s))}return e.size>0}updateRowData(t,e){if(this.dispatchRowDataUpdateStarted(t.add),this.beans.groupStage?.getNestedDataGetter())return K(268),{remove:[],update:[],add:[]};let i=[],n=pc(this.gos),r=this.executeRemove(n,t,e,i),o=this.executeUpdate(n,t,e,i),s=this.executeAdd(t,e);return this.deselect(i),{remove:r,update:o,add:s}}executeRemove(t,{remove:e},{adds:i,updates:n,removals:r},o){let s=this.rootNode._leafs,a=s?.length,l=e?.length;if(!l||!a)return[];let c=0,d=a,u=0,h,p=new Array(l);for(let f=0;f<l;++f){let g=this.lookupNode(t,e[f]);if(!g)continue;let m=g.sourceRowIndex;m<d&&(d=m),m>u&&(u=m),g.isSelected()&&o.push(g),this.deleteNode(g),i.delete(g)?(h??(h=new Set),h.add(g)):(n.delete(g),r.add(g)),p[c++]=g}return p.length=c,c&&ose(s,d,u,r,h),p}executeUpdate(t,{update:e},{adds:i,updates:n},r){let o=e?.length;if(!o)return[];let s=new Array(o),a=0;for(let l=0;l<o;l++){let c=e[l],d=this.lookupNode(t,c);d&&(d.updateData(c),!d.selectable&&d.isSelected()&&r.push(d),s[a++]=d,i.has(d)||n.add(d))}return s.length=a,s}executeAdd(t,e){var i;let n=(i=this.rootNode)._leafs??(i._leafs=[]),r=n.length,o=t.add,s=o?.length;if(!s)return[];let a=r+s,l=this.sanitizeAddIndex(n,t.addIndex);if(l<r){for(let u=r-1,h=a-1;u>=l;--u){let p=n[u];p.sourceRowIndex=h,n[h--]=p}e.reordered=!0}n.length=a;let c=new Array(s),d=e.adds;for(let u=0;u<s;u++){let h=this.createRowNode(o[u],0);d.add(h),h.sourceRowIndex=l,n[l]=h,c[u]=h,l++}return c}dispatchRowDataUpdateStarted(t){this.eventSvc.dispatchEvent({type:"rowDataUpdateStarted",firstRowData:t?.length?t[0]:null})}deselect(t){let e="rowDataChanged",i=this.beans.selectionSvc;t.length&&i?.setNodesSelected({newValue:!1,nodes:t,suppressFinishActions:!0,source:e}),i?.updateGroupsFromChildrenSelections?.(e),t.length&&this.eventSvc.dispatchEvent({type:"selectionChanged",source:e,selectedNodes:i?.getSelectedNodes()??null,serverSideState:null})}createRowNode(t,e){let i=new ys(this.beans);i.parent=this.rootNode,i.level=e,i.group=!1,i.expanded=!1,i.setDataAndId(t,String(this.nextId++));let n=i.id,r=this.allNodesMap;return r[n]&&K(2,{nodeId:n}),r[n]=i,i}deleteNode(t){t.clearRowTopAndRowIndex();let e=t.id,i=this.allNodesMap;i[e]===t&&delete i[e];let n=t.pinnedSibling;n&&this.beans.pinnedRowModel?.pinRow(n,null)}lookupNode(t,e){if(!t)return rse(this.rootNode._leafs,e);let i=t({data:e,level:0}),n=this.allNodesMap[i];return n||(at(4,{id:i}),null)}sanitizeAddIndex(t,e){let i=t.length;if(typeof e!="number"||e<0||e>=i||Number.isNaN(e))return i;e=Math.ceil(e);let n=this.gos;return e>0&&n.get("treeData")&&n.get("getDataPath")&&(e=nse(t,e)),e}},nse=(t,e)=>{for(let i=0,n=t.length;i<n;i++)if(t[i]?.rowIndex==e-1)return i+1;return e},uD=t=>{t.group=!0,t.level=-1,t.id="ROOT_NODE_ID",t._leafs?.length!==0&&(t._leafs=[]);let e=[],i=[],n=[],r=[];t.childrenAfterGroup=e,t.childrenAfterSort=i,t.childrenAfterAggFilter=n,t.childrenAfterFilter=r;let o=t.sibling;return o&&(o.childrenAfterGroup=e,o.childrenAfterSort=i,o.childrenAfterAggFilter=n,o.childrenAfterFilter=r,o.childrenMapped=t.childrenMapped),t.updateHasChildren(),t},rse=(t,e)=>{if(t)for(let i=0,n=t.length;i<n;i++){let r=t[i];if(r.data===e)return r}return at(5,{data:e}),null},ose=(t,e,i,n,r)=>{e=Math.max(0,e);for(let o=e,s=t.length;o<s;++o){let a=t[o];o<=i&&(n.has(a)||r?.has(a))||(a.sourceRowIndex=e,t[e++]=a)}t.length=e},sse=(t,e)=>{let i=e.size;t.length=i;let n=0,r=!1,o=!1;for(let s of e){let a=s.sourceRowIndex;a===n?o||(o=r):(a>=0?o=!0:r=!0,s.sourceRowIndex=n,t[n]=s),++n}return o},ase=(t,e,{removals:i,adds:n})=>{let r=t.length;t.length=e.size;let o=0;for(let s=0;s<r;++s){let a=t[s];i.has(a)||(o!==s&&(a.sourceRowIndex=o,t[o]=a),++o)}for(let s of n)s.sourceRowIndex<0&&(s.sourceRowIndex=o,t[o++]=s);t.length=o},SI=t=>{let e=t.childrenAfterSort,i=t.sibling;if(i&&(i.childrenAfterSort=e),!!e)for(let n=0,r=e.length-1;n<=r;n++){let o=e[n],s=n===0,a=n===r;o.firstChild!==s&&(o.firstChild=s,o.dispatchRowEvent("firstChildChanged")),o.lastChild!==a&&(o.lastChild=a,o.dispatchRowEvent("lastChildChanged")),o.childIndex!==n&&(o.childIndex=n,o.dispatchRowEvent("childIndexChanged"))}},lse=class extends H{constructor(){super(...arguments),this.beanName="sortStage",this.step="sort",this.refreshProps=["postSortRows","groupDisplayType","accentedSort"]}execute(t){let e=this.beans.sortSvc.getSortOptions(),i=e.length>0&&!!t.changedRowNodes&&this.gos.get("deltaSort");this.sort(e,i,t.changedRowNodes,t.changedPath)}sort(t,e,i,n){let{gos:r,colModel:o,rowGroupColsSvc:s,rowNodeSorter:a,rowRenderer:l,showRowGroupCols:c}=this.beans,d=r.get("groupMaintainOrder"),u=o.getCols().some(C=>C.isRowGroupActive()),h=s?.columns,p=o.isPivotMode(),f=r.getCallback("postSortRows"),g=!1,m,v=C=>{let b=p&&C.leafGroup,S=d&&u&&!C.leafGroup;S&&(m??(m=this.shouldSortContainsGroupCols(t)),S&&(S=!m));let x=null;if(S){let E=!1;if(h){let P=C.level+1;P<h.length&&(E=h[P].getSort()===null)}E||(x=use(C))}else!t.length||b||(e&&i?x=cse(a,C,i,n,t):x=a.doFullSort(C.childrenAfterAggFilter,t));if(x||(x=C.childrenAfterAggFilter?.slice(0)??[]),g||(g=C.childrenAfterSort?.[0]!==x[0]),C.childrenAfterSort=x,SI(C),f){let E={nodes:C.childrenAfterSort};f(E)}};if(n?.forEachChangedNodeDepthFirst(v),g&&r.get("groupHideOpenParents")){let C=c?.getShowRowGroupCols();C?.length&&l.refreshCells({columns:C,force:!0})}}shouldSortContainsGroupCols(t){let e=t.length;if(!e)return!1;if(Dr(this.gos)){for(let i=0;i<e;++i){let n=t[i].column;if(n.isPrimary()&&n.isRowGroupActive())return!0}return!1}for(let i=0;i<e;++i)if(t[i].column.getColDef().showRowGroup)return!0;return!1}},cse=(t,e,i,n,r)=>{let o=e.childrenAfterAggFilter,s=e.childrenAfterSort;if(!s)return t.doFullSort(o,r);let a=new Set,l=[],{updates:c,adds:d}=i;for(let h=0,p=o.length;h<p;++h){let f=o[h];c.has(f)||d.has(f)||n&&!n.canSkip(f)?l.push({currentPos:l.length,rowNode:f}):a.add(f)}let u=s.filter(h=>a.has(h)).map((h,p)=>({currentPos:p,rowNode:h}));return l.sort((h,p)=>t.compareRowNodes(r,h,p)),dse(t,r,l,u)},dse=(t,e,i,n)=>{let r=0,o=0,s=i.length,a=n.length,l=new Array(s+a),c=0;for(;r<s&&o<a;){let d=i[r],u=n[o];t.compareRowNodes(e,d,u)<0?(l[c++]=d.rowNode,++r):(l[c++]=u.rowNode,++o)}for(;r<s;)l[c++]=i[r++].rowNode;for(;o<a;)l[c++]=n[o++].rowNode;return l},use=t=>{let e=t.childrenAfterSort,i=t.childrenAfterAggFilter,n=e?.length,r=i?.length;if(!n||!r)return null;let o=new Array(r),s=new Set;for(let l=0;l<r;++l)s.add(i[l]);let a=0;for(let l=0;l<n;++l){let c=e[l];s.delete(c)&&(o[a++]=c)}if(s.size===0&&a===n)return e;for(let l of s)o[a++]=l;return o.length=a,o},hse=class extends H{constructor(){super(...arguments),this.beanName="rowModel",this.rootNode=null,this.rowCountReady=!1,this.nodeManager=void 0,this.rowsToDisplay=[],this.rowDataUpdatedPending=!1,this.asyncTransactions=null,this.asyncTransactionsTimer=0,this.started=!1,this.refreshingModel=!1,this.rowNodesCountReady=!1,this.stages=[],this.stagesRefreshProps=new Map,this.onRowHeightChanged_debounced=ui(this,this.onRowHeightChanged.bind(this),100)}postConstruct(){let t=this.beans,e=new ys(t);this.rootNode=e,this.nodeManager=this.createBean(new ise(e));let i=this.refreshModel.bind(this,{step:"group"}),n=this.refreshModel.bind(this,{step:"group",afterColumnsChanged:!0,keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame")});this.addManagedEventListeners({newColumnsLoaded:n,columnRowGroupChanged:i,columnValueChanged:this.onValueChanged.bind(this),columnPivotChanged:this.refreshModel.bind(this,{step:"pivot"}),filterChanged:this.onFilterChanged.bind(this),sortChanged:this.onSortChanged.bind(this),columnPivotModeChanged:i,gridStylesChanged:this.onGridStylesChanges.bind(this),gridReady:this.onGridReady.bind(this),rowExpansionStateChanged:this.onRowGroupOpened.bind(this)}),this.addPropertyListeners()}addPropertyListeners(){let{beans:t,stagesRefreshProps:e}=this,i=[t.groupStage,t.filterStage,t.pivotStage,t.aggStage,t.sortStage,t.filterAggStage,t.flattenStage].filter(n=>!!n);this.stages=i;for(let n=i.length-1;n>=0;--n)for(let r of i[n].refreshProps)e.set(r,n);this.addManagedPropertyListeners([...e.keys()],n=>{let r=n.changeSet?.properties;r&&this.onPropChange(r)}),this.addManagedPropertyListener("rowData",()=>this.onPropChange(["rowData"])),this.addManagedPropertyListener("rowHeight",()=>this.resetRowHeights())}start(){this.started=!0,this.rowNodesCountReady?this.refreshModel({step:"group",rowDataUpdated:!0,newData:!0}):this.setInitialData()}setInitialData(){this.gos.get("rowData")&&this.onPropChange(["rowData"])}ensureRowHeightsValid(t,e,i,n){let r,o=!1;do{r=!1;let s=this.getRowIndexAtPixel(t),a=this.getRowIndexAtPixel(e),l=Math.max(s,i),c=Math.min(a,n);for(let d=l;d<=c;d++){let u=this.getRow(d);if(u.rowHeightEstimated){let h=ws(this.beans,u);u.setRowHeight(h.height),r=!0,o=!0}}r&&this.setRowTopAndRowIndex()}while(r);return o}onPropChange(t){let{nodeManager:e,gos:i,beans:n}=this,r=n.groupStage;if(!e)return;let o=new Set(t),s=r?.onPropChange(o),a;o.has("rowData")?a=i.get("rowData"):s&&(a=r?.extractData()),a&&!Array.isArray(a)&&(a=null,K(1));let l={step:"nothing",changedProps:o};a&&(!s&&!this.isEmpty()&&a.length>0&&i.exists("getRowId")&&!i.get("resetRowDataOnUpdate")?(l.keepRenderedRows=!0,l.animate=!i.get("suppressAnimationFrame"),l.changedRowNodes=new dm,e.setImmutableRowData(l,a)):(l.rowDataUpdated=!0,l.newData=!0,e.setNewRowData(a),this.rowNodesCountReady=!0));let c=l.rowDataUpdated?"group":this.getRefreshedStage(t);c&&(l.step=c,this.refreshModel(l))}getRefreshedStage(t){let{stages:e,stagesRefreshProps:i}=this,n=e.length,r=n;for(let o=0,s=t.length;o<s&&r;++o)r=Math.min(r,i.get(t[o])??r);return r<n?e[r].step:null}setRowTopAndRowIndex(t){let{beans:e,rowsToDisplay:i}=this,n=e.environment.getDefaultRowHeight(),r=0,o=pi(this.gos,"normal");for(let s=0,a=i.length;s<a;++s){let l=i[s],c=l.id;if(c!=null&&t?.add(c),l.rowHeight==null){let d=ws(e,l,o,n);l.setRowHeight(d.height,d.estimated)}l.setRowTop(r),l.setRowIndex(s),r+=l.rowHeight}}clearRowTopAndRowIndex(t,e){let i=t.active,n=s=>{s?.id!=null&&!e.has(s.id)&&s.clearRowTopAndRowIndex()},r=s=>{n(s),n(s.detailNode),n(s.sibling);let a=s.childrenAfterGroup;if(!s.hasChildren()||!a)return;let l=s.level==-1;if(!(i&&!l&&!s.expanded))for(let d=0,u=a.length;d<u;++d)r(a[d])},o=this.rootNode;o&&r(o)}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay.length}getTopLevelRowCount(){let{rootNode:t,rowsToDisplay:e}=this;if(!t||!e.length)return 0;if(e[0]===t)return 1;let n=t.sibling?.displayed?1:0;return(t.childrenAfterSort?.length??0)+n}getTopLevelRowDisplayedIndex(t){let{beans:e,rootNode:i,rowsToDisplay:n}=this;if(!i||!n.length||n[0]===i)return t;let o=i.childrenAfterSort,s=l=>{let c=o[l];if(this.gos.get("groupHideOpenParents"))for(;c.expanded&&c.childrenAfterSort&&c.childrenAfterSort.length>0;)c=c.childrenAfterSort[0];return c.rowIndex},a=e.footerSvc;return a?a?.getTopDisplayIndex(n,t,o,s):s(t)}getTopLevelIndexFromDisplayedIndex(t){let{rootNode:e,rowsToDisplay:i}=this;if(!e||!i.length||i[0]===e)return t;let r=this.getRow(t);r.footer&&(r=r.sibling);let o=r.parent;for(;o&&o!==e;)r=o,o=r.parent;let s=e.childrenAfterSort?.indexOf(r)??-1;return s>=0?s:t}getRowBounds(t){let e=this.rowsToDisplay[t];return e?{rowTop:e.rowTop,rowHeight:e.rowHeight}:null}onRowGroupOpened(){this.refreshModel({step:"map",keepRenderedRows:!0,animate:rc(this.gos)})}onFilterChanged({afterDataChange:t,columns:e}){if(!t){let n=e.length===0||e.some(r=>r.isPrimary())?"filter":"filter_aggregates";this.refreshModel({step:n,keepRenderedRows:!0,animate:rc(this.gos)})}}onSortChanged(){this.refreshModel({step:"sort",keepRenderedRows:!0,animate:rc(this.gos)})}getType(){return"clientSide"}onValueChanged(){this.refreshModel({step:this.beans.colModel.isPivotActive()?"pivot":"aggregate"})}createChangePath(t){let e=new fh(!1,this.rootNode);return e.active=t,e}isSuppressModelUpdateAfterUpdateTransaction(t){if(!this.gos.get("suppressModelUpdateAfterUpdateTransaction"))return!1;let{changedRowNodes:e,newData:i,rowDataUpdated:n}=t;return!(!e||i||!n||e.removals.size||e.adds.size)}refreshModel(t){let{nodeManager:e,beans:i,eventSvc:n,started:r,refreshingModel:o}=this;if(!e)return;let s=!!t.rowDataUpdated,a=t.changedPath??(t.changedPath=this.createChangePath(!t.newData&&s));if(r&&s&&n.dispatchEvent({type:"rowDataUpdated"}),!r||o||i.colModel.changeEventsDispatching||this.isSuppressModelUpdateAfterUpdateTransaction(t)){this.rowDataUpdatedPending||(this.rowDataUpdatedPending=s);return}switch(this.rowDataUpdatedPending&&(this.rowDataUpdatedPending=!1,t.step="group"),this.refreshingModel=!0,i.masterDetailSvc?.refreshModel(t),s&&t.step!=="group"&&i.colFilter?.refreshModel(),t.step){case"group":this.doGrouping(t);case"filter":this.doFilter(a);case"pivot":this.doPivot(a);case"aggregate":this.doAggregate(a);case"filter_aggregates":this.doFilterAggregates(a);case"sort":this.doSort(t.changedRowNodes,a);case"map":this.doRowsToDisplay()}let l=new Set;this.setRowTopAndRowIndex(l),this.clearRowTopAndRowIndex(a,l),this.refreshingModel=!1,n.dispatchEvent({type:"modelUpdated",animate:t.animate,keepRenderedRows:t.keepRenderedRows,newData:t.newData,newPage:!1,keepUndoRedoStack:t.keepUndoRedoStack})}isEmpty(){return!this.rootNode?._leafs?.length||!this.beans.colModel?.ready}isRowsToRender(){return this.rowsToDisplay.length>0}getNodesInRangeForSelection(t,e){let i=!1,n=!1,r=[],o=uh(this.gos);return this.forEachNodeAfterFilterAndSort(s=>{if(n)return;if(i&&(s===e||s===t)&&(n=!0,o&&s.group)){xI(r,s);return}if(!i){if(s!==e&&s!==t)return;i=!0,e===t&&(n=!0)}(!s.group||!o)&&r.push(s)}),r}getTopLevelNodes(){return this.rootNode?.childrenAfterGroup??null}getRow(t){return this.rowsToDisplay[t]}isRowPresent(t){return this.rowsToDisplay.indexOf(t)>=0}getRowIndexAtPixel(t){let e=this.rowsToDisplay,i=e.length;if(this.isEmpty()||i===0)return-1;let n=0,r=i-1;if(t<=0)return 0;if(e[r].rowTop<=t)return r;let s=-1,a=-1;for(;;){let l=Math.floor((n+r)/2),c=e[l];if(this.isRowInPixel(c,t)||(c.rowTop<t?n=l+1:c.rowTop>t&&(r=l-1),s===n&&a===r))return l;s=n,a=r}}isRowInPixel(t,e){let i=t.rowTop,n=i+t.rowHeight;return i<=e&&n>e}forEachLeafNode(t){let e=this.rootNode?._leafs;if(e)for(let i=0,n=e.length;i<n;++i)t(e[i],i)}forEachNode(t,e=!1){this.depthFirstSearchRowNodes(t,e)}forEachDisplayedNode(t){let e=this.rowsToDisplay;for(let i=0,n=e.length;i<n;++i)t(e[i],i)}forEachNodeAfterFilter(t,e=!1){this.depthFirstSearchRowNodes(t,e,i=>i.childrenAfterAggFilter)}forEachNodeAfterFilterAndSort(t,e=!1){this.depthFirstSearchRowNodes(t,e,i=>i.childrenAfterSort)}forEachPivotNode(t,e,i){let{colModel:n,rowGroupColsSvc:r}=this.beans;if(!n.isPivotMode())return;if(!r?.columns.length){t(this.rootNode,0);return}let o=i?"childrenAfterSort":"childrenAfterGroup";this.depthFirstSearchRowNodes(t,e,s=>s.leafGroup?null:s[o])}depthFirstSearchRowNodes(t,e=!1,i=o=>o.childrenAfterGroup,n=this.rootNode,r=0){let o=r;if(!n)return o;let s=n===this.rootNode;if(s||t(n,o++),n.hasChildren()&&!n.footer){let a=i(n);if(a){let l=this.beans.footerSvc;o=l?.addTotalRows(o,n,t,e,s,"top")??o;for(let c of a)o=this.depthFirstSearchRowNodes(t,e,i,c,o);return l?.addTotalRows(o,n,t,e,s,"bottom")??o}}return o}doAggregate(t){let e=this.rootNode;e&&this.beans.aggStage?.execute({rowNode:e,changedPath:t})}doFilterAggregates(t){let e=this.rootNode,i=this.beans.filterAggStage;if(i){i.execute({rowNode:e,changedPath:t});return}e.childrenAfterAggFilter=e.childrenAfterFilter}doSort(t,e){let i=this.beans.sortStage;if(i){i.execute({rowNode:this.rootNode,changedRowNodes:t,changedPath:e});return}e.forEachChangedNodeDepthFirst(n=>{n.childrenAfterSort=n.childrenAfterAggFilter.slice(0),SI(n)})}doGrouping(t){let e=this.rootNode,n=this.beans.groupStage?.execute({rowNode:e,changedRowNodes:t.changedRowNodes,changedPath:t.changedPath,afterColumnsChanged:!!t.afterColumnsChanged});if(n===void 0){let r=e._leafs;e.childrenAfterGroup=r,e.updateHasChildren();let o=e.sibling;o&&(o.childrenAfterGroup=r)}(n||t.rowDataUpdated)&&this.beans.colFilter?.refreshModel(),!this.rowCountReady&&this.rowNodesCountReady&&(this.rowCountReady=!0,this.eventSvc.dispatchEventOnce({type:"rowCountReady"}))}doFilter(t){let e=this.beans.filterStage;if(e){e.execute({rowNode:this.rootNode,changedPath:t});return}t.forEachChangedNodeDepthFirst(i=>{i.childrenAfterFilter=i.childrenAfterGroup,K8(i)},!0)}doPivot(t){this.beans.pivotStage?.execute({rowNode:this.rootNode,changedPath:t})}getRowNode(t){let e=this.nodeManager?.getRowNode(t);return typeof e=="object"?e:typeof t=="string"&&t.indexOf(rS)===0?this.beans.groupStage?.getNode(t):void 0}batchUpdateRowData(t,e){if(!this.asyncTransactionsTimer){this.asyncTransactions=[];let i=this.gos.get("asyncTransactionWaitMillis");this.asyncTransactionsTimer=setTimeout(()=>this.executeBatchUpdateRowData(),i)}this.asyncTransactions.push({rowDataTransaction:t,callback:e})}flushAsyncTransactions(){let t=this.asyncTransactionsTimer;t&&(clearTimeout(t),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){let{nodeManager:t,beans:e,eventSvc:i,asyncTransactions:n}=this;if(!t)return;e.valueCache?.onDataChanged();let r=[],o=[],s=new dm;for(let{rowDataTransaction:a,callback:l}of n??[]){this.rowNodesCountReady=!0;let c=t.updateRowData(a,s);r.push(c),l&&o.push(l.bind(null,c))}this.commitTransactions(s),o.length>0&&setTimeout(()=>{for(let a=0,l=o.length;a<l;a++)o[a]()},0),r.length>0&&i.dispatchEvent({type:"asyncTransactionsFlushed",results:r}),this.asyncTransactionsTimer=0,this.asyncTransactions=null}updateRowData(t){let e=this.nodeManager;if(!e)return null;this.beans.valueCache?.onDataChanged(),this.rowNodesCountReady=!0;let i=new dm,n=e.updateRowData(t,i);return this.commitTransactions(i),n}commitTransactions(t){this.refreshModel({step:"group",rowDataUpdated:!0,keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame"),changedRowNodes:t,changedPath:this.createChangePath(!0)})}doRowsToDisplay(){let{beans:t,rootNode:e}=this,i=t.flattenStage;if(i){this.rowsToDisplay=i.execute({rowNode:e});return}let n=this.rootNode.childrenAfterSort??[];for(let r of n)r.setUiLevel(0);this.rowsToDisplay=n}onRowHeightChanged(){this.refreshModel({step:"map",keepRenderedRows:!0,keepUndoRedoStack:!0})}resetRowHeights(){let t=this.rootNode;if(!t)return;let e=this.resetRowHeightsForAllRowNodes();t.setRowHeight(t.rowHeight,!0);let i=t.sibling;i?.setRowHeight(i.rowHeight,!0),e&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let t=!1;return this.forEachNode(e=>{e.setRowHeight(e.rowHeight,!0);let i=e.detailNode;i?.setRowHeight(i.rowHeight,!0);let n=e.sibling;n?.setRowHeight(n.rowHeight,!0),t=!0}),t}onGridStylesChanges(t){t.rowHeightChanged&&!this.beans.rowAutoHeight?.active&&this.resetRowHeights()}onGridReady(){this.started||this.setInitialData()}destroy(){super.destroy(),this.nodeManager=this.destroyBean(this.nodeManager),this.started=!1,this.rootNode=null,this.rowsToDisplay=[],this.asyncTransactions=null,clearTimeout(this.asyncTransactionsTimer)}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}},xI=(t,e)=>{let i=e.childrenAfterGroup;if(i)for(let n=0,r=i.length;n<r;++n){let o=i[n];o.data&&t.push(o),o.group&&xI(t,o)}};function pse(t){t.expansionSvc?.onGroupExpandedOrCollapsed()}function fse(t,e){let i=Ps(t);i&&((!e||e==="everything")&&(e="group"),i.refreshModel({step:e,keepRenderedRows:!0,animate:!t.gos.get("suppressAnimationFrame")}))}function gse(t){return Ps(t)?.isEmpty()??!0}function mse(t,e){Ps(t)?.forEachLeafNode(e)}function vse(t,e){Ps(t)?.forEachNodeAfterFilter(e)}function Cse(t,e){Ps(t)?.forEachNodeAfterFilterAndSort(e)}function wse(t,e){return t.frameworkOverrides.wrapIncoming(()=>Ps(t)?.updateRowData(e))}function bse(t,e,i){t.frameworkOverrides.wrapIncoming(()=>Ps(t)?.batchUpdateRowData(e,i))}function yse(t){t.frameworkOverrides.wrapIncoming(()=>Ps(t)?.flushAsyncTransactions())}function Sse(t){return t.selectionSvc?.getBestCostNodeSelection()}var xse={moduleName:"ClientSideRowModel",version:oe,rowModels:["clientSide"],beans:[hse,lse],dependsOn:[G8]},Ese={moduleName:"ClientSideRowModelApi",version:oe,apiFunctions:{onGroupExpandedOrCollapsed:pse,refreshClientSideRowModel:fse,isRowDataEmpty:gse,forEachLeafNode:mse,forEachNodeAfterFilter:vse,forEachNodeAfterFilterAndSort:Cse,applyTransaction:wse,applyTransactionAsync:bse,flushAsyncTransactions:yse,getBestCostNodeSelection:Sse,resetRowHeights:yI,onRowHeightChanged:bI},dependsOn:[Joe,Qoe]},Pse=class extends H{constructor(){super(...arguments),this.beanName="gridSerializer"}wireBeans(t){this.visibleCols=t.visibleCols,this.colModel=t.colModel,this.rowModel=t.rowModel,this.pinnedRowModel=t.pinnedRowModel}serialize(t,e={}){let{allColumns:i,columnKeys:n,skipRowGroups:r,exportRowNumbers:o}=e,s=this.getColumnsToExport({allColumns:i,skipRowGroups:r,columnKeys:n,exportRowNumbers:o});return[this.prepareSession(s),this.prependContent(e),this.exportColumnGroups(e,s),this.exportHeaders(e,s),this.processPinnedTopRows(e,s),this.processRows(e,s),this.processPinnedBottomRows(e,s),this.appendContent(e)].reduce((a,l)=>l(a),t).parse()}processRow(t,e,i,n){let r=e.shouldRowBeSkipped||(()=>!1),s=e.rowPositions!=null||!!e.onlySelected,a=this.gos.get("groupHideOpenParents")&&!s,l=this.colModel.isPivotMode()?n.leafGroup:!n.group,c=!!n.footer,d=n.allChildrenCount===1&&n.childrenAfterGroup?.length===1&&Fq(this.gos,n);if(!l&&!c&&(e.skipRowGroups||d||a)||e.onlySelected&&!n.isSelected()||e.skipPinnedTop&&n.rowPinned==="top"||e.skipPinnedBottom&&n.rowPinned==="bottom"||n.stub||n.level===-1&&!l&&!c||r(Ee(this.gos,{node:n})))return;let p=t.onNewBodyRow(n);if(i.forEach((f,g)=>{p.onColumn(f,g,n)}),e.getCustomContentBelowRow){let f=e.getCustomContentBelowRow(Ee(this.gos,{node:n}));f&&t.addCustomContent(f)}}appendContent(t){return e=>{let i=t.appendContent;return i&&e.addCustomContent(i),e}}prependContent(t){return e=>{let i=t.prependContent;return i&&e.addCustomContent(i),e}}prepareSession(t){return e=>(e.prepare(t),e)}exportColumnGroups(t,e){return i=>{if(!t.skipColumnGroupHeaders){let n=new pM,{colGroupSvc:r}=this.beans,o=r?r.createColumnGroups({columns:e,idCreator:n,pinned:null,isStandaloneStructure:!0}):e;this.recursivelyAddHeaderGroups(o,i,t.processGroupHeaderCallback)}return i}}exportHeaders(t,e){return i=>{if(!t.skipColumnHeaders){let n=i.onNewHeaderRow();e.forEach((r,o)=>{n.onColumn(r,o,void 0)})}return i}}processPinnedTopRows(t,e){return i=>{let n=this.processRow.bind(this,i,t,e);return t.rowPositions?t.rowPositions.filter(r=>r.rowPinned==="top").sort((r,o)=>r.rowIndex-o.rowIndex).map(r=>this.pinnedRowModel?.getPinnedTopRow(r.rowIndex)).forEach(n):this.pinnedRowModel?.isManual()||this.pinnedRowModel?.forEachPinnedRow("top",n),i}}processRows(t,e){return i=>{let n=this.rowModel,r=Lt(this.gos,n),o=wc(this.gos,n),s=!r&&t.onlySelected,a=this.processRow.bind(this,i,t,e),{exportedRows:l="filteredAndSorted"}=t;if(t.rowPositions)t.rowPositions.filter(c=>c.rowPinned==null).sort((c,d)=>c.rowIndex-d.rowIndex).map(c=>n.getRow(c.rowIndex)).forEach(a);else if(this.colModel.isPivotMode())r?n.forEachPivotNode(a,!0,l==="filteredAndSorted"):o?n.forEachNodeAfterFilterAndSort(a,!0):n.forEachNode(a);else if(t.onlySelectedAllPages||s){let c=this.beans.selectionSvc?.getSelectedNodes()??[];this.replicateSortedOrder(c),c.forEach(a)}else l==="all"?n.forEachNode(a):r||o?n.forEachNodeAfterFilterAndSort(a,!0):n.forEachNode(a);return i}}replicateSortedOrder(t){let{sortSvc:e,rowNodeSorter:i}=this.beans;if(!e||!i)return;let n=e.getSortOptions(),r=(o,s)=>o.rowIndex!=null&&s.rowIndex!=null?o.rowIndex-s.rowIndex:o.level===s.level?o.parent?.id===s.parent?.id?i.compareRowNodes(n,{rowNode:o,currentPos:o.rowIndex??-1},{rowNode:s,currentPos:s.rowIndex??-1}):r(o.parent,s.parent):o.level>s.level?r(o.parent,s):r(o,s.parent);t.sort(r)}processPinnedBottomRows(t,e){return i=>{let n=this.processRow.bind(this,i,t,e);return t.rowPositions?t.rowPositions.filter(r=>r.rowPinned==="bottom").sort((r,o)=>r.rowIndex-o.rowIndex).map(r=>this.pinnedRowModel?.getPinnedBottomRow(r.rowIndex)).forEach(n):this.pinnedRowModel?.isManual()||this.pinnedRowModel?.forEachPinnedRow("bottom",n),i}}getColumnsToExport(t){let{allColumns:e=!1,skipRowGroups:i=!1,exportRowNumbers:n=!1,columnKeys:r}=t,{colModel:o,gos:s,visibleCols:a}=this,l=o.isPivotMode(),c=h=>Po(h)?!1:!wo(h)||n;if(r?.length)return o.getColsForKeys(r).filter(c);let d=s.get("treeData"),u=[];return e&&!l?u=o.getCols():u=a.allCols,u=u.filter(h=>c(h)&&(i&&!d?!IS(h):!0)),u}recursivelyAddHeaderGroups(t,e,i){let n=[];for(let r of t){let o=r;if(o.getChildren)for(let s of o.getChildren()??[])n.push(s)}t.length>0&&Ot(t[0])&&this.doAddHeaderHeader(e,t,i),n&&n.length>0&&this.recursivelyAddHeaderGroups(n,e,i)}doAddHeaderHeader(t,e,i){let n=t.onNewHeaderGroupingRow(),r=0;for(let o of e){let s=o,a;i?a=i(Ee(this.gos,{columnGroup:s})):a=this.beans.colNames.getDisplayNameForColumnGroup(s,"header");let c=(s.isExpandable()?s.getLeafColumns():[]).reduce((d,u,h,p)=>{let f=dt(d);return u.getColumnGroupShow()==="open"?(!f||f[1]!=null)&&(f=[h],d.push(f)):f&&f[1]==null&&(f[1]=h-1),h===p.length-1&&f&&f[1]==null&&(f[1]=h),d},[]);n.onColumn(s,a||"",r++,s.getLeafColumns().length-1,c)}}},Rse={moduleName:"SharedExport",version:oe,beans:[Pse]},hD=`\r
`,_se=class extends tne{constructor(t){super(t),this.config=t,this.isFirstLine=!0,this.result="";let{suppressQuotes:e,columnSeparator:i}=t;this.suppressQuotes=e,this.columnSeparator=i}addCustomContent(t){t&&(typeof t=="string"?(/^\s*\n/.test(t)||this.beginNewLine(),t=t.replace(/\r?\n/g,hD),this.result+=t):t.forEach(e=>{this.beginNewLine(),e.forEach((i,n)=>{n!==0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(i.data.value||""),i.mergeAcross&&this.appendEmptyCells(i.mergeAcross)})}))}onNewHeaderGroupingRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}onNewHeaderGroupingRowColumn(t,e,i,n){i!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(e),this.appendEmptyCells(n)}appendEmptyCells(t){for(let e=1;e<=t;e++)this.result+=this.columnSeparator+this.putInQuotes("")}onNewHeaderRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}onNewHeaderRowColumn(t,e){e!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(t))}onNewBodyRow(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}onNewBodyRowColumn(t,e,i){e!=0&&(this.result+=this.columnSeparator);let n=this.extractRowCellValue(t,e,e,"csv",i);this.result+=this.putInQuotes(n.valueFormatted??n.value)}putInQuotes(t){if(this.suppressQuotes)return t;if(t==null)return'""';let e;return typeof t=="string"?e=t:typeof t.toString=="function"?e=t.toString():(K(53),e=""),'"'+e.replace(/"/g,'""')+'"'}parse(){return this.result}beginNewLine(){this.isFirstLine||(this.result+=hD),this.isFirstLine=!1}},kse=class extends ene{constructor(){super(...arguments),this.beanName="csvCreator"}wireBeans(t){this.colModel=t.colModel,this.colNames=t.colNames,this.rowGroupColsSvc=t.rowGroupColsSvc,this.valueSvc=t.valueSvc}getMergedParams(t){let e=this.gos.get("defaultCsvExportParams");return Object.assign({},e,t)}export(t){if(this.isExportSuppressed()){K(51);return}let e=this.getMergedParams(t),i=this.getData(e),n=new Blob(["\uFEFF",i],{type:"text/plain"}),r=typeof e.fileName=="function"?e.fileName(Ee(this.gos,{})):e.fileName;ine(this.getFileName(r),n)}exportDataAsCsv(t){this.export(t)}getDataAsCsv(t,e=!1){let i=e?Object.assign({},t):this.getMergedParams(t);return this.getData(i)}getDefaultFileExtension(){return"csv"}createSerializingSession(t){let{colModel:e,colNames:i,rowGroupColsSvc:n,valueSvc:r,gos:o}=this,{processCellCallback:s,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c,suppressQuotes:d,columnSeparator:u}=t;return new _se({colModel:e,colNames:i,valueSvc:r,gos:o,processCellCallback:s||void 0,processHeaderCallback:a||void 0,processGroupHeaderCallback:l||void 0,processRowGroupCallback:c||void 0,suppressQuotes:d||!1,columnSeparator:u||",",rowGroupColsSvc:n})}isExportSuppressed(){return this.gos.get("suppressCsvExport")}};function Fse(t,e){return t.csvCreator?.getDataAsCsv(e)}function Tse(t,e){t.csvCreator?.exportDataAsCsv(e)}var Dse={moduleName:"CsvExport",version:oe,beans:[kse],apiFunctions:{getDataAsCsv:Fse,exportDataAsCsv:Tse},dependsOn:[Rse]},Mse=class extends H{constructor(t,e,i){super(),this.id=t,this.parentCache=e,this.params=i,this.state="needsLoading",this.version=0,this.startRow=t*i.blockSize,this.endRow=this.startRow+i.blockSize}load(){this.state="loading",this.loadFromDatasource()}setStateWaitingToLoad(){this.version++,this.state="needsLoading"}pageLoadFailed(t){this.isRequestMostRecentAndLive(t)&&(this.state="failed"),this.dispatchLocalEvent({type:"loadComplete"})}pageLoaded(t,e,i){this.successCommon(t,{rowData:e,rowCount:i})}isRequestMostRecentAndLive(t){let e=t===this.version,i=this.isAlive();return e&&i}successCommon(t,e){this.dispatchLocalEvent({type:"loadComplete"}),this.isRequestMostRecentAndLive(t)&&(this.state="loaded",this.processServerResult(e))}postConstruct(){this.rowNodes=[];let{params:{blockSize:t,rowHeight:e},startRow:i,beans:n,rowNodes:r}=this;for(let o=0;o<t;o++){let s=i+o,a=new ys(n);a.setRowHeight(e),a.uiLevel=0,a.setRowIndex(s),a.setRowTop(e*s),r.push(a)}}getBlockStateJson(){let{id:t,startRow:e,endRow:i,state:n}=this;return{id:""+t,state:{blockNumber:t,startRow:e,endRow:i,pageStatus:n}}}setDataAndId(t,e,i){ae(e)?t.setDataAndId(e,i.toString()):t.setDataAndId(void 0,void 0)}loadFromDatasource(){let t=this.createLoadParams();if(wt(this.params.datasource.getRows)){K(90);return}window.setTimeout(()=>{this.params.datasource.getRows(t)},0)}createLoadParams(){let{startRow:t,endRow:e,version:i,params:{sortModel:n,filterModel:r},gos:o}=this;return{startRow:t,endRow:e,successCallback:this.pageLoaded.bind(this,i),failCallback:this.pageLoadFailed.bind(this,i),sortModel:n,filterModel:r,context:Ee(o,{}).context}}forEachNode(t,e,i){this.rowNodes.forEach((n,r)=>{this.startRow+r<i&&t(n,e.value++)})}getRow(t,e=!1){e||(this.lastAccessed=this.params.lastAccessedSequence.value++);let i=t-this.startRow;return this.rowNodes[i]}processServerResult(t){let{rowNodes:e,beans:i}=this;e.forEach((r,o)=>{let s=t.rowData?t.rowData[o]:void 0;!r.id&&r.alreadyRendered&&s&&(e[o]=new ys(i),e[o].setRowIndex(r.rowIndex),e[o].setRowTop(r.rowTop),e[o].setRowHeight(r.rowHeight),r.clearRowTopAndRowIndex()),this.setDataAndId(e[o],s,this.startRow+o)});let n=t.rowCount!=null&&t.rowCount>=0?t.rowCount:void 0;this.parentCache.pageLoaded(this,n)}destroy(){for(let t of this.rowNodes)t.clearRowTopAndRowIndex();super.destroy()}},Ise=2,Ase=class extends H{constructor(t){super(),this.params=t,this.lastRowIndexKnown=!1,this.blocks={},this.blockCount=0,this.rowCount=t.initialRowCount}getRow(t,e=!1){let i=Math.floor(t/this.params.blockSize),n=this.blocks[i];if(!n){if(e)return;n=this.createBlock(i)}return n.getRow(t)}createBlock(t){let e=this.params,i=this.createBean(new Mse(t,this,e));return this.blocks[i.id]=i,this.blockCount++,this.purgeBlocksIfNeeded(i),e.rowNodeBlockLoader.addBlock(i),i}refreshCache(){if(this.blockCount==0){this.purgeCache();return}for(let e of this.getBlocksInOrder())e.setStateWaitingToLoad();this.params.rowNodeBlockLoader.checkBlockToLoad()}destroy(){for(let t of this.getBlocksInOrder())this.destroyBlock(t);super.destroy()}getRowCount(){return this.rowCount}isLastRowIndexKnown(){return this.lastRowIndexKnown}pageLoaded(t,e){this.isAlive()&&(Cs(this.gos,`InfiniteCache - onPageLoaded: page = ${t.id}, lastRow = ${e}`),this.checkRowCount(t,e),this.onCacheUpdated())}purgeBlocksIfNeeded(t){let e=this.getBlocksInOrder().filter(s=>s!=t),i=(s,a)=>a.lastAccessed-s.lastAccessed;e.sort(i);let n=this.params.maxBlocksInCache>0,r=n?this.params.maxBlocksInCache-1:null,o=Ise-1;e.forEach((s,a)=>{let l=s.state==="needsLoading"&&a>=o,c=n?a>=r:!1;if(l||c){if(this.isBlockCurrentlyDisplayed(s)||this.isBlockFocused(s))return;this.removeBlockFromCache(s)}})}isBlockFocused(t){let e=this.beans.focusSvc.getFocusCellToUseAfterRefresh();if(!e||e.rowPinned!=null)return!1;let{startRow:i,endRow:n}=t;return e.rowIndex>=i&&e.rowIndex<n}isBlockCurrentlyDisplayed(t){let{startRow:e,endRow:i}=t;return this.beans.rowRenderer.isRangeInRenderedViewport(e,i-1)}removeBlockFromCache(t){t&&this.destroyBlock(t)}checkRowCount(t,e){if(typeof e=="number"&&e>=0)this.rowCount=e,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){let{blockSize:i,overflowSize:n}=this.params,o=(t.id+1)*i+n;this.rowCount<o&&(this.rowCount=o)}}setRowCount(t,e){this.rowCount=t,ae(e)&&(this.lastRowIndexKnown=e),this.lastRowIndexKnown||this.rowCount%this.params.blockSize===0&&this.rowCount++,this.onCacheUpdated()}forEachNodeDeep(t){let e={value:0};for(let i of this.getBlocksInOrder())i.forEachNode(t,e,this.rowCount)}getBlocksInOrder(){let t=(i,n)=>i.id-n.id;return Object.values(this.blocks).sort(t)}destroyBlock(t){delete this.blocks[t.id],this.destroyBean(t),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(t)}onCacheUpdated(){this.isAlive()&&(this.destroyAllBlocksPastVirtualRowCount(),this.eventSvc.dispatchEvent({type:"storeUpdated"}))}destroyAllBlocksPastVirtualRowCount(){let t=[];for(let e of this.getBlocksInOrder())e.id*this.params.blockSize>=this.rowCount&&t.push(e);if(t.length>0)for(let e of t)this.destroyBlock(e)}purgeCache(){for(let t of this.getBlocksInOrder())this.removeBlockFromCache(t);this.lastRowIndexKnown=!1,this.rowCount===0&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()}getRowNodesInRange(t,e){let i=[],n=-1,r=!1,o={value:0},s=!1;for(let l of this.getBlocksInOrder())if(!s){if(r&&n+1!==l.id){s=!0;continue}n=l.id,l.forEachNode(c=>{let d=c===t||c===e;(r||d)&&i.push(c),d&&(r=!r)},o,this.rowCount)}return s||r?[]:i}},Ose=class extends H{constructor(){super(...arguments),this.beanName="rowModel",this.rootNode=null}getRowBounds(t){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*t}}ensureRowHeightsValid(){return!1}postConstruct(){if(this.gos.get("rowModelType")!=="infinite")return;let t=this.beans,e=new ys(t);this.rootNode=e,e.level=-1,this.rowHeight=Ea(t),this.addEventListeners(),this.addDestroyFunc(()=>this.destroyCache())}start(){this.setDatasource(this.gos.get("datasource"))}destroy(){this.destroyDatasource(),super.destroy(),this.rootNode=null}destroyDatasource(){this.datasource&&(this.destroyBean(this.datasource),this.beans.rowRenderer.datasourceChanged(),this.datasource=null)}addEventListeners(){this.addManagedEventListeners({filterChanged:this.reset.bind(this),sortChanged:this.reset.bind(this),newColumnsLoaded:this.onColumnEverything.bind(this),storeUpdated:this.dispatchModelUpdatedEvent.bind(this)}),this.addManagedPropertyListener("datasource",()=>this.setDatasource(this.gos.get("datasource"))),this.addManagedPropertyListener("cacheBlockSize",()=>this.resetCache()),this.addManagedPropertyListener("rowHeight",()=>{this.rowHeight=Ea(this.beans),this.cacheParams.rowHeight=this.rowHeight,this.updateRowHeights()})}onColumnEverything(){let t;this.cacheParams?t=!rh(this.cacheParams.sortModel,this.beans.sortSvc?.getSortModel()??[]):t=!0,t&&this.reset()}getType(){return"infinite"}setDatasource(t){this.destroyDatasource(),this.datasource=t,t&&this.reset()}isEmpty(){return!this.infiniteCache}isRowsToRender(){return!!this.infiniteCache}getNodesInRangeForSelection(t,e){return this.infiniteCache?.getRowNodesInRange(t,e)??[]}reset(){if(!this.datasource)return;pc(this.gos)!=null||this.beans.selectionSvc?.reset("rowDataChanged"),this.resetCache()}dispatchModelUpdatedEvent(){this.eventSvc.dispatchEvent({type:"modelUpdated",newPage:!1,newPageSize:!1,newData:!1,keepRenderedRows:!0,animate:!1})}resetCache(){this.destroyCache();let t=this.beans,{filterManager:e,sortSvc:i,rowNodeBlockLoader:n,eventSvc:r,gos:o}=t;this.cacheParams={datasource:this.datasource,filterModel:e?.getFilterModel()??{},sortModel:i?.getSortModel()??[],rowNodeBlockLoader:n,initialRowCount:o.get("infiniteInitialRowCount"),maxBlocksInCache:o.get("maxBlocksInCache"),rowHeight:Ea(t),overflowSize:o.get("cacheOverflowSize"),blockSize:o.get("cacheBlockSize"),lastAccessedSequence:{value:0}},this.infiniteCache=this.createBean(new Ase(this.cacheParams)),r.dispatchEventOnce({type:"rowCountReady"}),this.dispatchModelUpdatedEvent()}updateRowHeights(){this.forEachNode(t=>{t.setRowHeight(this.rowHeight),t.setRowTop(this.rowHeight*t.rowIndex)}),this.dispatchModelUpdatedEvent()}destroyCache(){this.infiniteCache=this.destroyBean(this.infiniteCache)}getRow(t){let e=this.infiniteCache;if(e&&!(t>=e.getRowCount()))return e.getRow(t)}getRowNode(t){let e;return this.forEachNode(i=>{i.id===t&&(e=i)}),e}forEachNode(t){this.infiniteCache?.forEachNodeDeep(t)}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(t){return t}getRowIndexAtPixel(t){if(this.rowHeight!==0){let e=Math.floor(t/this.rowHeight),i=this.getRowCount()-1;return e>i?i:e}return 0}getRowCount(){return this.infiniteCache?this.infiniteCache.getRowCount():0}isRowPresent(t){return!!this.getRowNode(t.id)}refreshCache(){this.infiniteCache?.refreshCache()}purgeCache(){this.infiniteCache?.purgeCache()}isLastRowIndexKnown(){return this.infiniteCache?.isLastRowIndexKnown()??!1}setRowCount(t,e){this.infiniteCache?.setRowCount(t,e)}resetRowHeights(){}onRowHeightChanged(){}};function Lse(t){qm(t)?.refreshCache()}function Nse(t){qm(t)?.purgeCache()}function Bse(t){return qm(t)?.getRowCount()}var Hse=class extends H{constructor(){super(...arguments),this.beanName="rowNodeBlockLoader",this.activeBlockLoadsCount=0,this.blocks=[],this.active=!0}postConstruct(){this.maxConcurrentRequests=Tq(this.gos);let t=this.gos.get("blockLoadDebounceMillis");t&&t>0&&(this.checkBlockToLoadDebounce=ui(this,this.performCheckBlocksToLoad.bind(this),t))}addBlock(t){this.blocks.push(t),t.addEventListener("loadComplete",this.loadComplete.bind(this)),this.checkBlockToLoad()}removeBlock(t){er(this.blocks,t)}destroy(){super.destroy(),this.active=!1}loadComplete(){this.activeBlockLoadsCount--,this.checkBlockToLoad()}checkBlockToLoad(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()}performCheckBlocksToLoad(){if(!this.active)return;if(this.printCacheStatus(),this.maxConcurrentRequests!=null&&this.activeBlockLoadsCount>=this.maxConcurrentRequests){Cs(this.gos,"RowNodeBlockLoader - checkBlockToLoad: max loads exceeded");return}let t=this.maxConcurrentRequests!=null?this.maxConcurrentRequests-this.activeBlockLoadsCount:1,e=this.blocks.filter(i=>i.state==="needsLoading").slice(0,t);this.activeBlockLoadsCount+=e.length;for(let i of e)i.load();this.printCacheStatus()}getBlockState(){let t={};return this.blocks.forEach(e=>{let{id:i,state:n}=e.getBlockStateJson();t[i]=n}),t}printCacheStatus(){Cs(this.gos,`RowNodeBlockLoader - printCacheStatus: activePageLoadsCount = ${this.activeBlockLoadsCount}, blocks = ${JSON.stringify(this.getBlockState())}`)}},zse={moduleName:"InfiniteRowModelCore",version:oe,rowModels:["infinite"],beans:[Ose,Hse]},Vse={moduleName:"InfiniteRowModel",version:oe,apiFunctions:{refreshInfiniteCache:Lse,purgeInfiniteCache:Nse,getInfiniteRowCount:Bse},dependsOn:[zse,Zoe]},Gse="\u2191",Wse="\u2193",Use={tag:"span",children:[{tag:"span",ref:"eDelta",cls:"ag-value-change-delta"},{tag:"span",ref:"eValue",cls:"ag-value-change-value"}]},jse=class extends et{constructor(){super(Use),this.eValue=re,this.eDelta=re,this.refreshCount=0}init(t){this.refresh(t,!0)}showDelta(t,e){let i=Math.abs(e),n=t.formatValue(i),r=ae(n)?n:i,o=e>=0,s=this.eDelta;o?s.textContent=Gse+r:s.textContent=Wse+r,s.classList.toggle("ag-value-change-delta-up",o),s.classList.toggle("ag-value-change-delta-down",!o)}setTimerToRemoveDelta(){this.refreshCount++;let t=this.refreshCount;this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{t===this.refreshCount&&this.hideDeltaValue()},2e3)})}hideDeltaValue(){this.eValue.classList.remove("ag-value-change-value-highlight"),hi(this.eDelta)}refresh(t,e=!1){let{value:i,valueFormatted:n}=t,{eValue:r,lastValue:o,beans:s}=this;if(i===o||(ae(n)?r.textContent=n:ae(i)?r.textContent=i:hi(r),s.filterManager?.isSuppressFlashingCellsBecauseFiltering()))return!1;let a=i&&typeof i=="object"&&"toNumber"in i?i.toNumber():i,l=o&&typeof o=="object"&&"toNumber"in o?o.toNumber():o;if(a===l)return!1;if(typeof a=="number"&&typeof l=="number"){let c=a-l;this.showDelta(t,c)}return o&&r.classList.add("ag-value-change-value-highlight"),e||this.setTimerToRemoveDelta(),this.lastValue=i,!0}},qse=".ag-value-slide-out{opacity:1}:where(.ag-ltr) .ag-value-slide-out{margin-right:5px;transition:opacity 3s,margin-right 3s}:where(.ag-rtl) .ag-value-slide-out{margin-left:5px;transition:opacity 3s,margin-left 3s}:where(.ag-ltr,.ag-rtl) .ag-value-slide-out{transition-timing-function:linear}.ag-value-slide-out-end{opacity:0}:where(.ag-ltr) .ag-value-slide-out-end{margin-right:10px}:where(.ag-rtl) .ag-value-slide-out-end{margin-left:10px}",$se={tag:"span",children:[{tag:"span",ref:"eCurrent",cls:"ag-value-slide-current"}]},Kse=class extends et{constructor(){super($se),this.eCurrent=re,this.refreshCount=0,this.registerCSS(qse)}init(t){this.refresh(t,!0)}addSlideAnimation(){this.refreshCount++;let t=this.refreshCount;this.ePrevious?.remove();let{beans:e,eCurrent:i}=this,n=Nt({tag:"span",cls:"ag-value-slide-previous ag-value-slide-out"});this.ePrevious=n,n.textContent=i.textContent,this.getGui().insertBefore(n,i),e.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{t===this.refreshCount&&this.ePrevious.classList.add("ag-value-slide-out-end")},50),window.setTimeout(()=>{t===this.refreshCount&&(this.ePrevious?.remove(),this.ePrevious=null)},3e3)})}refresh(t,e=!1){let i=t.value;if(wt(i)&&(i=""),i===this.lastValue||this.beans.filterManager?.isSuppressFlashingCellsBecauseFiltering())return!1;e||this.addSlideAnimation(),this.lastValue=i;let n=this.eCurrent;return ae(t.valueFormatted)?n.textContent=t.valueFormatted:ae(t.value)?n.textContent=i:hi(n),!0}},Yse=class extends H{constructor(){super(...arguments),this.beanName="cellFlashSvc",this.nextAnimationTime=null,this.nextAnimationCycle=null,this.animations={highlight:new Map,"data-changed":new Map}}animateCell(t,e,i=this.beans.gos.get("cellFlashDuration"),n=this.beans.gos.get("cellFadeDuration")){let r=this.animations[e];r.delete(t);let o=Date.now(),s=o+i,a=o+i+n,l={phase:"flash",flashEndTime:s,fadeEndTime:a};r.set(t,l);let c=`ag-cell-${e}`,d=`${c}-animation`,{comp:u,eGui:{style:h}}=t;u.toggleCss(c,!0),u.toggleCss(d,!1),h.removeProperty("transition"),h.removeProperty("transition-delay"),this.nextAnimationTime&&s+15<this.nextAnimationTime&&(clearTimeout(this.nextAnimationCycle),this.nextAnimationCycle=null,this.nextAnimationTime=null),this.nextAnimationCycle||(this.beans.frameworkOverrides.wrapIncoming(()=>{this.nextAnimationCycle=setTimeout(this.advanceAnimations.bind(this),i)}),this.nextAnimationTime=s)}advanceAnimations(){let t=Date.now(),e=null;for(let i of Object.keys(this.animations)){let n=this.animations[i],r=`ag-cell-${i}`,o=`${r}-animation`;for(let[s,a]of n){if(!s.isAlive()||!s.comp){n.delete(s);continue}let{phase:l,flashEndTime:c,fadeEndTime:d}=a,u=l==="flash"?c:d;if(!(t+15>=u)){e=Math.min(u,e??1/0);continue}let{comp:p,eGui:{style:f}}=s;switch(l){case"flash":p.toggleCss(r,!1),p.toggleCss(o,!0),f.transition=`background-color ${d-c}ms`,f.transitionDelay=`${c-t}ms`,e=Math.min(d,e??1/0),a.phase="fade";break;case"fade":p.toggleCss(r,!1),p.toggleCss(o,!1),f.removeProperty("transition"),f.removeProperty("transition-delay"),n.delete(s);break}}}e==null?(this.nextAnimationTime=null,this.nextAnimationCycle=null):e&&(this.nextAnimationCycle=setTimeout(this.advanceAnimations.bind(this),e-t),this.nextAnimationTime=e)}onFlashCells(t,e){if(!t.comp)return;let i=YJ(t.cellPosition);e.cells[i]&&this.animateCell(t,"highlight")}flashCell(t,e){this.animateCell(t,"data-changed",e?.flashDuration,e?.fadeDuration)}destroy(){for(let t of Object.keys(this.animations))this.animations[t].clear()}};function Xse(t,e={}){let{cellFlashSvc:i}=t;i&&t.frameworkOverrides.wrapIncoming(()=>{for(let n of t.rowRenderer.getCellCtrls(e.rowNodes,e.columns))i.flashCell(n,e)})}var Jse={moduleName:"HighlightChanges",version:oe,beans:[Yse],userComponents:{agAnimateShowChangeCellRenderer:jse,agAnimateSlideCellRenderer:Kse},apiFunctions:{flashCells:Xse}};function Qse(t){return t.stateSvc?.getState()??{}}function Zse(t,e,i){return t.stateSvc?.setState(e,i)}function pD(t){return t=w({},t),t.version||(t.version="32.1.0"),t.version==="32.1.0"&&(t=eae(t)),t.version=oe,t}function eae(t){return t.cellSelection=tae(t,"rangeSelection"),t}function tae(t,e){if(t&&typeof t=="object")return t[e]}var iae=class extends H{constructor(){super(...arguments),this.beanName="stateSvc",this.updateRowGroupExpansionStateTimer=0,this.suppressEvents=!0,this.queuedUpdateSources=new Set,this.dispatchStateUpdateEventDebounced=ui(this,()=>this.dispatchQueuedStateUpdateEvents(),0),this.onRowGroupOpenedDebounced=ui(this,()=>{this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(this.updateCachedState("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("rowGroupExpansion",void 0)):(this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("ssrmRowGroupExpansion",void 0))},0),this.onRowSelectedDebounced=ui(this,()=>{this.staleStateKeys.delete("rowSelection"),this.updateCachedState("rowSelection",this.getRowSelectionState())},0),this.staleStateKeys=new Set}postConstruct(){let{gos:t,ctrlsSvc:e,colDelayRenderSvc:i}=this.beans;this.isClientSideRowModel=Lt(t);let n=pD(t.get("initialState")??{}),r=n.partialColumnState;delete n.partialColumnState,this.cachedState=n;let o=this.suppressEventsAndDispatchInitEvent.bind(this);e.whenReady(this,()=>o(()=>this.setupStateOnGridReady(n))),(n.columnOrder||n.columnVisibility||n.columnSizing||n.columnPinning||n.columnGroup)&&i?.hideColumns("columnState");let[s,a,l]=this.addManagedEventListeners({newColumnsLoaded:({source:c})=>{c==="gridInitializing"&&(s(),o(()=>{this.setupStateOnColumnsInitialised(n,!!r),i?.revealColumns("columnState")}))},rowCountReady:()=>{a?.(),o(()=>this.setupStateOnRowCountReady(n))},firstDataRendered:()=>{l?.(),o(()=>this.setupStateOnFirstDataRendered(n))}})}destroy(){super.destroy(),clearTimeout(this.updateRowGroupExpansionStateTimer),this.queuedUpdateSources.clear()}getState(){return this.staleStateKeys.size&&this.refreshStaleState(),this.cachedState}setState(t,e){let i=pD(t);delete i.partialColumnState,this.cachedState=i,this.startSuppressEvents();let n="api",r=e?new Set(e):void 0;this.setGridReadyState(i,n,r),this.setColumnsInitialisedState(i,n,!!r,r),this.setRowCountState(i,n,r),setTimeout(()=>{this.isAlive()&&this.setFirstDataRenderedState(i,n,r),this.stopSuppressEvents(n)})}setGridReadyState(t,e,i){e==="api"&&!i?.has("sideBar")&&this.beans.sideBar?.comp?.setState(t.sideBar),this.updateCachedState("sideBar",this.getSideBarState())}setupStateOnGridReady(t){this.setGridReadyState(t,"gridInitializing");let e=()=>this.updateCachedState("sideBar",this.getSideBarState());this.addManagedEventListeners({toolPanelVisibleChanged:e,sideBarUpdated:e})}updateColumnAndGroupState(){this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","rowGroup","sort"]),this.updateCachedState("columnGroup",this.getColumnGroupState())}setColumnsInitialisedState(t,e,i,n){this.setColumnState(t,e,i,n),this.setColumnGroupState(t,e,n),this.updateColumnAndGroupState()}setupStateOnColumnsInitialised(t,e){this.setColumnsInitialisedState(t,"gridInitializing",e);let i=n=>()=>this.updateColumnState([n]);this.addManagedEventListeners({columnValueChanged:i("aggregation"),columnMoved:i("columnOrder"),columnPinned:i("columnPinning"),columnResized:i("columnSizing"),columnVisible:i("columnVisibility"),columnPivotChanged:i("pivot"),columnPivotModeChanged:i("pivot"),columnRowGroupChanged:i("rowGroup"),sortChanged:i("sort"),newColumnsLoaded:this.updateColumnAndGroupState.bind(this),columnGroupOpened:()=>this.updateCachedState("columnGroup",this.getColumnGroupState())})}setRowCountState(t,e,i){let{filter:n,rowGroupExpansion:r,ssrmRowGroupExpansion:o,rowSelection:s,pagination:a}=t,l=(d,u)=>!i?.has(d)&&(u||e==="api");l("filter",n)&&this.setFilterState(n),l("rowGroupExpansion",r)&&this.setRowGroupExpansionState(o,r,e),l("rowSelection",s)&&this.setRowSelectionState(s,e),l("pagination",a)&&this.setPaginationState(a,e);let c=this.updateCachedState.bind(this);c("filter",this.getFilterState()),this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(c("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),c("rowGroupExpansion",void 0)):(c("rowGroupExpansion",this.getRowGroupExpansionState()),c("ssrmRowGroupExpansion",void 0)),c("rowSelection",this.getRowSelectionState()),c("pagination",this.getPaginationState())}setupStateOnRowCountReady(t){this.setRowCountState(t,"gridInitializing");let e=this.updateCachedState.bind(this),i=()=>{this.updateRowGroupExpansionStateTimer=0,this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(e("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),e("rowGroupExpansion",void 0)):(e("rowGroupExpansion",this.getRowGroupExpansionState()),e("ssrmRowGroupExpansion",void 0))},n=()=>e("filter",this.getFilterState()),{gos:r,colFilter:o}=this.beans;this.addManagedEventListeners({filterChanged:n,rowExpansionStateChanged:this.onRowGroupOpenedDebounced,expandOrCollapseAll:i,columnRowGroupChanged:i,rowDataUpdated:()=>{(r.get("groupDefaultExpanded")!==0||r.get("isGroupOpenByDefault"))&&(this.updateRowGroupExpansionStateTimer||(this.updateRowGroupExpansionStateTimer=setTimeout(i)))},selectionChanged:()=>{this.staleStateKeys.add("rowSelection"),this.onRowSelectedDebounced()},paginationChanged:s=>{(s.newPage||s.newPageSize)&&e("pagination",this.getPaginationState())}}),o&&this.addManagedListeners(o,{filterStateChanged:n})}setFirstDataRenderedState(t,e,i){let{scroll:n,cellSelection:r,focusedCell:o,columnOrder:s,rowPinning:a}=t,l=(u,h)=>!i?.has(u)&&(h||e==="api");l("focusedCell",o)&&this.setFocusedCellState(o),l("cellSelection",r)&&this.setCellSelectionState(r),l("scroll",n)&&this.setScrollState(n),l("rowPinning",a)&&this.setRowPinningState(a),this.setColumnPivotState(!!s?.orderedColIds,e);let c=this.updateCachedState.bind(this);c("sideBar",this.getSideBarState()),c("focusedCell",this.getFocusedCellState());let d=this.getRangeSelectionState();c("rangeSelection",d),c("cellSelection",d),c("scroll",this.getScrollState())}setupStateOnFirstDataRendered(t){this.setFirstDataRenderedState(t,"gridInitializing");let e=this.updateCachedState.bind(this),i=()=>e("focusedCell",this.getFocusedCellState());this.addManagedEventListeners({cellFocused:i,cellFocusCleared:i,cellSelectionChanged:n=>{if(n.finished){let r=this.getRangeSelectionState();e("rangeSelection",r),e("cellSelection",r)}},bodyScrollEnd:()=>e("scroll",this.getScrollState()),pinnedRowsChanged:()=>e("rowPinning",this.getRowPinningState())})}getColumnState(){let t=this.beans;return Jie(Rm(t),t.colModel.isPivotMode())}setColumnState(t,e,i,n){let{sort:r,rowGroup:o,aggregation:s,pivot:a,columnPinning:l,columnVisibility:c,columnSizing:d,columnOrder:u}=t,h=!1,p=(q,Y)=>{let he=!n?.has(q)&&!!(Y||e==="api");return h||(h=he),he},f={},g=q=>{let Y=f[q];return Y||(Y={colId:q},f[q]=Y,Y)},m={},v=p("sort",r);v&&r?.sortModel.forEach(({colId:q,sort:Y},he)=>{let Se=g(q);Se.sort=Y,Se.sortIndex=he}),(v||!i)&&(m.sort=null,m.sortIndex=null);let C=p("rowGroup",o);C&&o?.groupColIds.forEach((q,Y)=>{let he=g(q);he.rowGroup=!0,he.rowGroupIndex=Y}),(C||!i)&&(m.rowGroup=null,m.rowGroupIndex=null);let b=p("aggregation",s);b&&s?.aggregationModel.forEach(({colId:q,aggFunc:Y})=>{g(q).aggFunc=Y}),(b||!i)&&(m.aggFunc=null);let S=p("pivot",a);S&&(a?.pivotColIds.forEach((q,Y)=>{let he=g(q);he.pivot=!0,he.pivotIndex=Y}),this.gos.updateGridOptions({options:{pivotMode:!!a?.pivotMode},source:e})),(S||!i)&&(m.pivot=null,m.pivotIndex=null);let x=p("columnPinning",l);if(x){for(let q of l?.leftColIds??[])g(q).pinned="left";for(let q of l?.rightColIds??[])g(q).pinned="right"}(x||!i)&&(m.pinned=null);let E=p("columnVisibility",c);if(E)for(let q of c?.hiddenColIds??[])g(q).hide=!0;(E||!i)&&(m.hide=null);let P=p("columnSizing",d);if(P)for(let{colId:q,flex:Y,width:he}of d?.columnSizingModel??[]){let Se=g(q);Se.flex=Y??null,Se.width=he}(P||!i)&&(m.flex=null);let L=u?.orderedColIds,B=!!L?.length&&!n?.has("columnOrder"),j=B?L.map(q=>g(q)):Object.values(f);(j.length||h)&&(this.columnStates=j,Zn(this.beans,{state:j,applyOrder:B,defaultState:m},e))}setColumnPivotState(t,e){let i=this.columnStates;this.columnStates=void 0;let n=this.columnGroupStates;this.columnGroupStates=void 0;let r=this.beans,{pivotResultCols:o,colGroupSvc:s}=r;if(o?.isPivotResultColsPresent()){if(i){let a=[];for(let l of i)o.getPivotResultCol(l.colId)&&a.push(l);Zn(r,{state:a,applyOrder:t},e)}n&&s?.setColumnGroupState(n,e)}}getColumnGroupState(){let t=this.beans.colGroupSvc;if(!t)return;let e=t.getColumnGroupState();return Qie(e)}setColumnGroupState(t,e,i){let n=this.beans.colGroupSvc;if(!n||i?.has("columnGroup")||e!=="api"&&!Object.prototype.hasOwnProperty.call(t,"columnGroup"))return;let r=new Set(t.columnGroup?.openColumnGroupIds),s=n.getColumnGroupState().map(({groupId:a})=>{let l=r.has(a);return l&&r.delete(a),{groupId:a,open:l}});for(let a of r)s.push({groupId:a,open:!0});s.length&&(this.columnGroupStates=s),n.setColumnGroupState(s,e)}getFilterState(){let t=this.beans.filterManager,e=t?.getFilterModel();e&&Object.keys(e).length===0&&(e=void 0);let i=t?.getFilterState(),n=t?.getAdvFilterModel()??void 0;return e||n||i?{filterModel:e,columnFilterState:i,advancedFilterModel:n}:void 0}setFilterState(t){let e=this.beans.filterManager,{filterModel:i,columnFilterState:n,advancedFilterModel:r}=t??{filterModel:null,columnFilterState:null,advancedFilterModel:null};(i!==void 0||n!==void 0)&&e?.setFilterState(i??null,n??null,"columnFilter"),r!==void 0&&e?.setAdvFilterModel(r??null,"advancedFilter")}getRangeSelectionState(){let t=this.beans.rangeSvc?.getCellRanges().map(e=>{let{id:i,type:n,startRow:r,endRow:o,columns:s,startColumn:a}=e;return{id:i,type:n,startRow:r,endRow:o,colIds:s.map(l=>l.getColId()),startColId:a.getColId()}});return t?.length?{cellRanges:t}:void 0}setCellSelectionState(t){let{gos:e,rangeSvc:i,colModel:n,visibleCols:r}=this.beans;if(!So(e)||!i)return;let o=[];for(let s of t?.cellRanges??[]){let a=[];for(let c of s.colIds){let d=n.getCol(c);d&&a.push(d)}if(!a.length)continue;let l=n.getCol(s.startColId);if(!l){let c=r.allCols,d=new Set(a);l=c.find(u=>d.has(u))}o.push(k(w({},s),{columns:a,startColumn:l}))}i.setCellRanges(o)}getScrollState(){if(!this.isClientSideRowModel)return;let t=this.beans.ctrlsSvc.getScrollFeature(),{left:e}=t?.getHScrollPosition()??{left:0},{top:i}=t?.getVScrollPosition()??{top:0};return i||e?{top:i,left:e}:void 0}setScrollState(t){if(!this.isClientSideRowModel)return;let{top:e,left:i}=t??{top:0,left:0},{frameworkOverrides:n,rowRenderer:r,animationFrameSvc:o,ctrlsSvc:s}=this.beans;n.wrapIncoming(()=>{s.get("center").setCenterViewportScrollLeft(i),s.getScrollFeature()?.setVerticalScrollPosition(e),r.redraw({afterScroll:!0}),o?.flushAllFrames()})}getSideBarState(){return this.beans.sideBar?.comp?.getState()}getFocusedCellState(){if(!this.isClientSideRowModel)return;let t=this.beans.focusSvc.getFocusedCell();if(t){let{column:e,rowIndex:i,rowPinned:n}=t;return{colId:e.getColId(),rowIndex:i,rowPinned:n}}}setFocusedCellState(t){if(!this.isClientSideRowModel)return;let{focusSvc:e,colModel:i}=this.beans;if(!t){e.clearFocusedCell();return}let{colId:n,rowIndex:r,rowPinned:o}=t;e.setFocusedCell({column:i.getCol(n),rowIndex:r,rowPinned:o,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}getPaginationState(){let{pagination:t,gos:e}=this.beans;if(!t)return;let i=t.getCurrentPage(),n=e.get("paginationAutoPageSize")?void 0:t.getPageSize();if(!(!i&&!n))return{page:i,pageSize:n}}setPaginationState(t,e){let{pagination:i,gos:n}=this.beans;if(!i)return;let{pageSize:r,page:o}=t??{page:0,pageSize:n.get("paginationPageSize")},s=e==="gridInitializing";r&&!n.get("paginationAutoPageSize")&&i.setPageSize(r,s?"initialState":"pageSizeSelector"),typeof o=="number"&&(s?i.setPage(o):i.goToPage(o))}getRowSelectionState(){let t=this.beans.selectionSvc;if(!t)return;let e=t.getSelectionState();return!e||!Array.isArray(e)&&(e.selectAll===!1||e.selectAllChildren===!1)&&!e?.toggledNodes?.length?void 0:e}setRowSelectionState(t,e){this.beans.selectionSvc?.setSelectionState(t,e,e==="api")}getRowGroupExpansionState(){let{expansionSvc:t}=this.beans;if(t)return t.getExpansionState()}getRowPinningState(){return this.beans.pinnedRowModel?.getPinnedState()}setRowPinningState(t){let e=this.beans.pinnedRowModel;t?e?.setPinnedState(t):e?.reset()}setRowGroupExpansionState(t,e,i){let n=this.beans.expansionSvc;if(!n)return;let r=e??{expandedRowGroupIds:[],collapsedRowGroupIds:[]};n.setExpansionState(r,i)}updateColumnState(t){let e=this.getColumnState(),i=!1,n=this.cachedState;for(let r of Object.keys(e)){let o=e[r];rh(o,n[r])||(i=!0)}this.cachedState=w(w({},n),e),i&&this.dispatchStateUpdateEvent(t)}updateCachedState(t,e){let i=this.cachedState[t];this.setCachedStateValue(t,e),rh(e,i)||this.dispatchStateUpdateEvent([t])}setCachedStateValue(t,e){this.cachedState=k(w({},this.cachedState),{[t]:e})}refreshStaleState(){let t=this.staleStateKeys;for(let e of t)e==="rowSelection"&&this.setCachedStateValue(e,this.getRowSelectionState());t.clear()}dispatchStateUpdateEvent(t){if(!this.suppressEvents){for(let e of t)this.queuedUpdateSources.add(e);this.dispatchStateUpdateEventDebounced()}}dispatchQueuedStateUpdateEvents(){let t=this.queuedUpdateSources,e=Array.from(t);t.clear(),this.eventSvc.dispatchEvent({type:"stateUpdated",sources:e,state:this.cachedState})}startSuppressEvents(){this.suppressEvents=!0,this.beans.colAnimation?.setSuppressAnimation(!0)}stopSuppressEvents(t){setTimeout(()=>{this.suppressEvents=!1,this.queuedUpdateSources.clear(),this.isAlive()&&(this.beans.colAnimation?.setSuppressAnimation(!1),this.dispatchStateUpdateEvent([t]))})}suppressEventsAndDispatchInitEvent(t){this.startSuppressEvents(),t(),this.stopSuppressEvents("gridInitializing")}},nae={moduleName:"GridState",version:oe,beans:[iae],apiFunctions:{getState:Qse,setState:Zse}};function rae(t){return t.rowModel.isLastRowIndexKnown()}function oae(t){return t.pagination?.getPageSize()??100}function sae(t){return t.pagination?.getCurrentPage()??0}function aae(t){return t.pagination?.getTotalPages()??1}function lae(t){return t.pagination?t.pagination.getMasterRowCount():t.rowModel.getRowCount()}function cae(t){t.pagination?.goToNextPage()}function dae(t){t.pagination?.goToPreviousPage()}function uae(t){t.pagination?.goToFirstPage()}function hae(t){t.pagination?.goToLastPage()}function pae(t,e){t.pagination?.goToPage(e)}var fae=class extends H{constructor(){super(...arguments),this.beanName="paginationAutoPageSizeSvc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,t=>{this.centerRowsCtrl=t.center;let e=this.checkPageSize.bind(this);this.addManagedEventListeners({bodyHeightChanged:e,scrollVisibilityChanged:e}),this.addManagedPropertyListener("paginationAutoPageSize",this.onPaginationAutoSizeChanged.bind(this)),this.checkPageSize()})}notActive(){return!this.gos.get("paginationAutoPageSize")||this.centerRowsCtrl==null}onPaginationAutoSizeChanged(){this.notActive()?this.beans.pagination.unsetAutoCalculatedPageSize():this.checkPageSize()}checkPageSize(){if(this.notActive())return;let t=this.centerRowsCtrl.viewportSizeFeature.getBodyHeight();if(t>0){let e=this.beans,i=()=>{let n=Math.max(Ea(e),1),r=Math.floor(t/n);e.pagination.setPageSize(r,"autoCalculated")};this.isBodyRendered?ui(this,i,50)():(i(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}},ju="paginationPageSizeSelector",gae={tag:"span",cls:"ag-paging-page-size"},mae=class extends et{constructor(){super(gae),this.hasEmptyOption=!1,this.handlePageSizeItemSelected=()=>{if(!this.selectPageSizeComp)return;let t=this.selectPageSizeComp.getValue();if(!t)return;let e=Number(t);isNaN(e)||e<1||e===this.pagination.getPageSize()||(this.pagination.setPageSize(e,"pageSizeSelector"),this.hasEmptyOption&&this.toggleSelectDisplay(!0),this.selectPageSizeComp.getFocusableElement().focus())}}wireBeans(t){this.pagination=t.pagination}postConstruct(){this.addManagedPropertyListener(ju,()=>{this.onPageSizeSelectorValuesChange()}),this.addManagedEventListeners({paginationChanged:t=>this.handlePaginationChanged(t)})}handlePaginationChanged(t){if(!this.selectPageSizeComp||!t?.newPageSize)return;let e=this.pagination.getPageSize();this.getPageSizeSelectorValues().includes(e)?this.selectPageSizeComp.setValue(e.toString()):this.hasEmptyOption?this.selectPageSizeComp.setValue(""):this.toggleSelectDisplay(!0)}toggleSelectDisplay(t){this.selectPageSizeComp&&!t&&this.reset(),t&&(this.reloadPageSizesSelector(),this.selectPageSizeComp)}reset(){hi(this.getGui()),this.selectPageSizeComp&&(this.selectPageSizeComp=this.destroyBean(this.selectPageSizeComp))}onPageSizeSelectorValuesChange(){this.selectPageSizeComp&&this.shouldShowPageSizeSelector()&&this.reloadPageSizesSelector()}shouldShowPageSizeSelector(){return this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel")&&!this.gos.get("paginationAutoPageSize")&&this.gos.get(ju)!==!1}reloadPageSizesSelector(){let t=this.getPageSizeSelectorValues(),e=this.pagination.getPageSize(),i=!e||!t.includes(e);if(i){let r=this.gos.exists("paginationPageSize"),o=this.gos.get(ju)!==!0;K(94,{pageSizeSet:r,pageSizesSet:o,pageSizeOptions:t,paginationPageSizeOption:e}),o||K(95,{paginationPageSizeOption:e,paginationPageSizeSelector:ju}),t.unshift("")}let n=String(i?"":e);this.selectPageSizeComp?(xs(this.pageSizeOptions,t)||(this.selectPageSizeComp.clearOptions().addOptions(this.createPageSizeSelectOptions(t)),this.pageSizeOptions=t),this.selectPageSizeComp.setValue(n,!0)):this.createPageSizeSelectorComp(t,n),this.hasEmptyOption=i}createPageSizeSelectOptions(t){return t.map(e=>({value:String(e)}))}createPageSizeSelectorComp(t,e){let i=this.getLocaleTextFunc(),n=i("pageSizeSelectorLabel","Page Size:"),r=i("ariaPageSizeSelectorLabel","Page Size");this.selectPageSizeComp=this.createManagedBean(new zS).addOptions(this.createPageSizeSelectOptions(t)).setValue(e).setAriaLabel(r).setLabel(n).onValueChange(()=>this.handlePageSizeItemSelected()),this.appendChild(this.selectPageSizeComp)}getPageSizeSelectorValues(){let t=[20,50,100],e=this.gos.get(ju);return!Array.isArray(e)||!e?.length?t:[...e].sort((i,n)=>i-n)}destroy(){this.toggleSelectDisplay(!1),super.destroy()}},vae={selector:"AG-PAGE-SIZE-SELECTOR",component:mae},Cae=".ag-paging-panel{align-items:center;border-top:var(--ag-footer-row-border);display:flex;gap:calc(var(--ag-spacing)*4);height:var(--ag-pagination-panel-height);justify-content:flex-end;padding:0 var(--ag-cell-horizontal-padding)}:where(.ag-paging-page-size) .ag-wrapper{min-width:50px}.ag-paging-page-summary-panel{align-items:center;display:flex;gap:var(--ag-cell-widget-spacing);.ag-disabled &{pointer-events:none}}.ag-paging-button{cursor:pointer;position:relative;&.ag-disabled{cursor:default;opacity:.5}}.ag-paging-number,.ag-paging-row-summary-panel-number{font-weight:500}",wae=class extends l8{constructor(){super(),this.btFirst=re,this.btPrevious=re,this.btNext=re,this.btLast=re,this.lbRecordCount=re,this.lbFirstRowOnPage=re,this.lbLastRowOnPage=re,this.lbCurrent=re,this.lbTotal=re,this.pageSizeComp=re,this.previousAndFirstButtonsDisabled=!1,this.nextButtonDisabled=!1,this.lastButtonDisabled=!1,this.areListenersSetup=!1,this.allowFocusInnerElement=!1,this.registerCSS(Cae)}wireBeans(t){this.rowModel=t.rowModel,this.pagination=t.pagination,this.ariaAnnounce=t.ariaAnnounce}postConstruct(){let t=this.gos.get("enableRtl");this.setTemplate(this.getTemplate(),[vae]);let{btFirst:e,btPrevious:i,btNext:n,btLast:r}=this;this.activateTabIndex([e,i,n,r]),e.insertAdjacentElement("afterbegin",Mn(t?"last":"first",this.beans)),i.insertAdjacentElement("afterbegin",Mn(t?"next":"previous",this.beans)),n.insertAdjacentElement("afterbegin",Mn(t?"previous":"next",this.beans)),r.insertAdjacentElement("afterbegin",Mn(t?"first":"last",this.beans)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.addManagedPropertyListeners(["paginationPageSizeSelector","paginationAutoPageSize","suppressPaginationPanel"],()=>this.onPageSizeRelatedOptionsChange()),this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector()),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:o=>this.allowFocusInnerElement?this.tabGuardFeature.getTabGuardCtrl().focusInnerElement(o):mX(this.beans,o),forceFocusOutWhenTabGuardsAreEmpty:!0}),this.onPaginationChanged()}setAllowFocus(t){this.allowFocusInnerElement=t}onPaginationChanged(){let e=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.setDisplayed(e),e&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateLabels(),this.onPageSizeRelatedOptionsChange())}onPageSizeRelatedOptionsChange(){this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector())}setupListeners(){if(!this.areListenersSetup){this.addManagedEventListeners({paginationChanged:this.onPaginationChanged.bind(this)});for(let t of[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}]){let{el:e,fn:i}=t;this.addManagedListeners(e,{click:i,keydown:n=>{(n.key===A.ENTER||n.key===A.SPACE)&&(n.preventDefault(),i())}})}gX(this.beans,this,this.getGui()),this.areListenersSetup=!0}}onBtFirst(){this.previousAndFirstButtonsDisabled||this.pagination.goToFirstPage()}formatNumber(t){let e=this.gos.getCallback("paginationNumberFormatter");return e?e({value:t}):Zie(t,this.getLocaleTextFunc.bind(this))}getTemplate(){let t=this.getLocaleTextFunc(),e=`ag-${this.getCompId()}`;return{tag:"div",cls:"ag-paging-panel ag-unselectable",attrs:{id:`${e}`},children:[{tag:"ag-page-size-selector",ref:"pageSizeComp"},{tag:"span",cls:"ag-paging-row-summary-panel",children:[{tag:"span",ref:"lbFirstRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${e}-first-row`}},{tag:"span",attrs:{id:`${e}-to`},children:t("to","to")},{tag:"span",ref:"lbLastRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${e}-last-row`}},{tag:"span",attrs:{id:`${e}-of`},children:t("of","of")},{tag:"span",ref:"lbRecordCount",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${e}-row-count`}}]},{tag:"span",cls:"ag-paging-page-summary-panel",role:"presentation",children:[{tag:"div",ref:"btFirst",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":t("firstPage","First Page")}},{tag:"div",ref:"btPrevious",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":t("previousPage","Previous Page")}},{tag:"span",cls:"ag-paging-description",children:[{tag:"span",attrs:{id:`${e}-start-page`},children:t("page","Page")},{tag:"span",ref:"lbCurrent",cls:"ag-paging-number",attrs:{id:`${e}-start-page-number`}},{tag:"span",attrs:{id:`${e}-of-page`},children:t("of","of")},{tag:"span",ref:"lbTotal",cls:"ag-paging-number",attrs:{id:`${e}-of-page-number`}}]},{tag:"div",ref:"btNext",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":t("nextPage","Next Page")}},{tag:"div",ref:"btLast",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":t("lastPage","Last Page")}}]}]}}onBtNext(){this.nextButtonDisabled||this.pagination.goToNextPage()}onBtPrevious(){this.previousAndFirstButtonsDisabled||this.pagination.goToPreviousPage()}onBtLast(){this.lastButtonDisabled||this.pagination.goToLastPage()}enableOrDisableButtons(){let t=this.pagination.getCurrentPage(),e=this.rowModel.isLastRowIndexKnown(),i=this.pagination.getTotalPages();this.previousAndFirstButtonsDisabled=t===0,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);let n=this.isZeroPagesToDisplay(),r=t===i-1;this.nextButtonDisabled=r||n,this.lastButtonDisabled=!e||n||t===i-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}toggleButtonDisabled(t,e){Dj(t,e),t.classList.toggle("ag-disabled",e)}isZeroPagesToDisplay(){let t=this.rowModel.isLastRowIndexKnown(),e=this.pagination.getTotalPages();return t&&e===0}updateLabels(){let t=this.rowModel.isLastRowIndexKnown(),e=this.pagination.getTotalPages(),i=this.pagination.getMasterRowCount(),n=t?i:null,r=this.pagination.getCurrentPage(),o=this.pagination.getPageSize(),s,a;this.isZeroPagesToDisplay()?s=a=0:(s=o*r+1,a=s+o-1,t&&a>n&&(a=n));let l=s+o-1,c=!t&&i<l,d=this.formatNumber(s);this.lbFirstRowOnPage.textContent=d;let u,h=this.getLocaleTextFunc();c?u=h("pageLastRowUnknown","?"):u=this.formatNumber(a),this.lbLastRowOnPage.textContent=u;let f=e>0?r+1:0,g=this.formatNumber(f);this.lbCurrent.textContent=g;let m,v;if(t)m=this.formatNumber(e),v=this.formatNumber(n);else{let C=h("more","more");m=C,v=C}this.lbTotal.textContent=m,this.lbRecordCount.textContent=v,this.announceAriaStatus(d,u,v,g,m)}announceAriaStatus(t,e,i,n,r){let o=this.getLocaleTextFunc(),s=o("page","Page"),a=o("to","to"),l=o("of","of"),c=`${t} ${a} ${e} ${l} ${i}`,d=`${s} ${n} ${l} ${r}`;c!==this.ariaRowStatus&&(this.ariaRowStatus=c,this.ariaAnnounce?.announceValue(c,"paginationRow")),d!==this.ariaPageStatus&&(this.ariaPageStatus=d,this.ariaAnnounce?.announceValue(d,"paginationPage"))}},bae={selector:"AG-PAGINATION",component:wae},yae=class extends H{constructor(){super(...arguments),this.beanName="pagination",this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=0,this.masterRowCount=0}postConstruct(){let t=this.gos;this.active=t.get("pagination"),this.pageSizeFromGridOptions=t.get("paginationPageSize"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedPropertyListener("pagination",this.onPaginationGridOptionChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPageSizeGridOptionChanged.bind(this))}getPaginationSelector(){return bae}isPaginateChildRows(){let t=this.gos;return t.get("groupHideParentOfSingleChild")||t.get("groupRemoveSingleChildren")||t.get("groupRemoveLowestSingleChildren")?!0:t.get("paginateChildRows")}onPaginationGridOptionChanged(){this.active=this.gos.get("pagination"),this.calculatePages(),this.dispatchPaginationChangedEvent({keepRenderedRows:!0})}onPageSizeGridOptionChanged(){this.setPageSize(this.gos.get("paginationPageSize"),"gridOptions")}goToPage(t){let e=this.currentPage;if(!this.active||e===t||typeof e!="number")return;let{editSvc:i}=this.beans;i?.isEditing()&&(i.isBatchEditing()?i.cleanupEditors():i.stopEditing(void 0,{source:"api"})),this.currentPage=t,this.calculatePages(),this.dispatchPaginationChangedEvent({newPage:!0})}goToPageWithIndex(t){if(!this.active)return;let e=t;this.paginateChildRows||(e=this.beans.rowModel.getTopLevelIndexFromDisplayedIndex?.(t)??t),this.goToPage(Math.floor(e/this.pageSize))}isRowInPage(t){return this.active?t>=this.topDisplayedRowIndex&&t<=this.bottomDisplayedRowIndex:!0}getCurrentPage(){return this.currentPage}goToNextPage(){this.goToPage(this.currentPage+1)}goToPreviousPage(){this.goToPage(this.currentPage-1)}goToFirstPage(){this.goToPage(0)}goToLastPage(){let t=this.beans.rowModel.getRowCount(),e=Math.floor(t/this.pageSize);this.goToPage(e)}getPageSize(){return this.pageSize}getTotalPages(){return this.totalPages}setPage(t){this.currentPage=t}get pageSize(){return ae(this.pageSizeAutoCalculated)&&this.gos.get("paginationAutoPageSize")?this.pageSizeAutoCalculated:ae(this.pageSizeFromPageSizeSelector)?this.pageSizeFromPageSizeSelector:ae(this.pageSizeFromInitialState)?this.pageSizeFromInitialState:ae(this.pageSizeFromGridOptions)?this.pageSizeFromGridOptions:this.defaultPageSize}calculatePages(){this.active?this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly():this.calculatedPagesNotActive(),this.beans.pageBounds.calculateBounds(this.topDisplayedRowIndex,this.bottomDisplayedRowIndex)}unsetAutoCalculatedPageSize(){if(this.pageSizeAutoCalculated===void 0)return;let t=this.pageSizeAutoCalculated;this.pageSizeAutoCalculated=void 0,this.pageSize!==t&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0}))}setPageSize(t,e){let i=this.pageSize;switch(e){case"autoCalculated":this.pageSizeAutoCalculated=t;break;case"pageSizeSelector":this.pageSizeFromPageSizeSelector=t,this.currentPage!==0&&this.goToFirstPage();break;case"initialState":this.pageSizeFromInitialState=t;break;case"gridOptions":this.pageSizeFromGridOptions=t,this.pageSizeFromInitialState=void 0,this.pageSizeFromPageSizeSelector=void 0,this.currentPage!==0&&this.goToFirstPage();break}i!==this.pageSize&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0,keepRenderedRows:!0}))}setZeroRows(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}adjustCurrentPageIfInvalid(){let t=this.totalPages;this.currentPage>=t&&(this.currentPage=t-1);let e=this.currentPage;(!isFinite(e)||isNaN(e)||e<0)&&(this.currentPage=0)}calculatePagesMasterRowsOnly(){let t=this.beans.rowModel,e=t.getTopLevelRowCount();if(this.masterRowCount=e,e<=0){this.setZeroRows();return}let i=this.pageSize,n=e-1;this.totalPages=Math.floor(n/i)+1,this.adjustCurrentPageIfInvalid();let r=this.currentPage,o=i*r,s=i*(r+1)-1;if(s>n&&(s=n),this.topDisplayedRowIndex=t.getTopLevelRowDisplayedIndex(o),s===n)this.bottomDisplayedRowIndex=t.getRowCount()-1;else{let a=t.getTopLevelRowDisplayedIndex(s+1);this.bottomDisplayedRowIndex=a-1}}getMasterRowCount(){return this.masterRowCount}calculatePagesAllRows(){let t=this.beans.rowModel.getRowCount();if(this.masterRowCount=t,t===0){this.setZeroRows();return}let{pageSize:e,currentPage:i}=this,n=t-1;this.totalPages=Math.floor(n/e)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=e*i,this.bottomDisplayedRowIndex=e*(i+1)-1,this.bottomDisplayedRowIndex>n&&(this.bottomDisplayedRowIndex=n)}calculatedPagesNotActive(){this.setPageSize(void 0,"autoCalculated"),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.beans.rowModel.getRowCount()-1}dispatchPaginationChangedEvent(t){let{keepRenderedRows:e=!1,newPage:i=!1,newPageSize:n=!1}=t;this.eventSvc.dispatchEvent({type:"paginationChanged",animate:!1,newData:!1,newPage:i,newPageSize:n,keepRenderedRows:e})}},Sae={moduleName:"Pagination",version:oe,beans:[yae,fae],icons:{first:"first",previous:"previous",next:"next",last:"last"},apiFunctions:{paginationIsLastPageFound:rae,paginationGetPageSize:oae,paginationGetCurrentPage:sae,paginationGetTotalPages:aae,paginationGetRowCount:lae,paginationGoToNextPage:cae,paginationGoToPreviousPage:dae,paginationGoToFirstPage:uae,paginationGoToLastPage:hae,paginationGoToPage:pae},dependsOn:[$m]};function xae(t,e={}){let i=e?e.rowNodes:void 0;t.frameworkOverrides.wrapIncoming(()=>t.rowRenderer.redrawRows(i))}function EI(t,e,i,n,r){e&&(n&&e.parent&&e.parent.level!==-1&&EI(t,e.parent,i,n,r),e.setExpanded(i,void 0,r))}function Eae(t,e){return t.rowModel.getRowNode(e)}function Pae(t,e,i,n){t.rowRenderer.addRenderedRowListener(e,i,n)}function Rae(t){return t.rowRenderer.getRenderedNodes()}function _ae(t,e,i){t.rowModel.forEachNode(e,i)}function kae(t){return t.rowRenderer.firstRenderedRow}function Fae(t){return t.rowRenderer.lastRenderedRow}function Tae(t,e){return t.rowModel.getRow(e)}function Dae(t){return t.rowModel.getRowCount()}var Mae={moduleName:"RowApi",version:oe,apiFunctions:{redrawRows:xae,setRowNodeExpanded:EI,getRowNode:Eae,addRenderedRowListener:Pae,getRenderedNodes:Rae,forEachNode:_ae,getFirstDisplayedRowIndex:kae,getLastDisplayedRowIndex:Fae,getDisplayedRowAtIndex:Tae,getDisplayedRowCount:Dae}},Iae={moduleName:"ScrollApi",version:oe,apiFunctions:{getVerticalPixelRange:jre,getHorizontalPixelRange:qre,ensureColumnVisible:dI,ensureIndexVisible:uI,ensureNodeVisible:$re}};function Aae(t,e,i){if(!e)return;let n=t.ctrlsSvc.getGridBodyCtrl().eGridBody,r=`aria-${e}`;i===null?n.removeAttribute(r):n.setAttribute(r,i)}function Oae(t,e={}){t.frameworkOverrides.wrapIncoming(()=>t.rowRenderer.refreshCells(e))}function Lae(t){t.frameworkOverrides.wrapIncoming(()=>{for(let e of t.ctrlsSvc.getHeaderRowContainerCtrls())e.refresh()})}function Nae(t){return t.animationFrameSvc?.isQueueEmpty()??!0}function Bae(t){t.animationFrameSvc?.flushAllFrames()}function Hae(t){return{rowHeight:Ea(t),headerHeight:Sh(t)}}function zae(t,e={}){let i=[];for(let o of t.rowRenderer.getCellCtrls(e.rowNodes,e.columns)){let s=o.getCellRenderer();s!=null&&i.push(hh(s))}if(e.columns?.length)return i;let n=[],r=mS(e.rowNodes);for(let o of t.rowRenderer.getAllRowCtrls()){if(r&&!vS(o.rowNode,r)||!o.isFullWidth())continue;let s=o.getFullWidthCellRenderers();for(let a=0;a<s.length;a++){let l=s[a];l!=null&&n.push(hh(l))}}return[...n,...i]}var Vae={moduleName:"RenderApi",version:oe,apiFunctions:{setGridAriaProperty:Aae,refreshCells:Oae,refreshHeader:Lae,isAnimationFrameQueueEmpty:Nae,flushAllAnimationFrames:Bae,getSizesForCurrentTheme:Hae,getCellRendererInstances:zae}};function Gae(t,e){typeof e=="number"?t.colAutosize?.sizeColumnsToFit(e,"api"):t.colAutosize?.sizeColumnsToFitGridBody(e)}function PI({colAutosize:t,visibleCols:e},i,n){Array.isArray(i)?t?.autoSizeCols({colKeys:i,skipHeader:n,source:"api"}):t?.autoSizeCols(k(w({},i),{colKeys:i.colIds??e.allCols,source:"api"}))}function Wae(t,e){e&&typeof e=="object"?PI(t,e):t.colAutosize?.autoSizeAllColumns({source:"api",skipHeader:e})}var Uae=class extends H{constructor(){super(...arguments),this.beanName="colAutosize",this.timesDelayed=0,this.shouldQueueResizeOperations=!1,this.resizeOperationQueue=[]}postConstruct(){let{gos:t}=this,e=t.get("autoSizeStrategy");if(e){let i=!1,n=e.type;if(n==="fitGridWidth"||n==="fitProvidedWidth")i=!0;else if(n==="fitCellContents"){this.addManagedEventListeners({firstDataRendered:()=>this.onFirstDataRendered(e)});let r=t.get("rowData");i=r!=null&&r.length>0&&Lt(t)}i&&this.beans.colDelayRenderSvc?.hideColumns(n)}}autoSizeCols(t){let{eventSvc:e,visibleCols:i}=this.beans;this.innerAutoSizeCols(t).then(n=>{let r=c=>fc(e,Array.from(c),!0,"autosizeColumns");if(!t.scaleUpToFitGridWidth)return r(n);let o=fD(this.beans),s=c=>i.leftCols.some(d=>Zu(d,c)),a=c=>i.rightCols.some(d=>Zu(d,c)),l=t.colKeys.filter(c=>!Po(c)&&!wo(c)&&!s(c)&&!a(c));this.sizeColumnsToFit(o,t.source,!0,{defaultMaxWidth:t.defaultMaxWidth,defaultMinWidth:t.defaultMinWidth,columnLimits:t.columnLimits?.map(c=>k(w({},c),{key:c.colId})),colKeys:l,onlyScaleUp:!0}),r(n)})}innerAutoSizeCols(t){return new Promise((e,i)=>{if(this.shouldQueueResizeOperations)return this.pushResizeOperation(()=>this.innerAutoSizeCols(t).then(e,i));let{colKeys:n,skipHeader:r,skipHeaderGroups:o,stopAtGroup:s,defaultMaxWidth:a,defaultMinWidth:l,columnLimits:c=[],source:d="api"}=t,{animationFrameSvc:u,renderStatus:h,colModel:p,autoWidthCalc:f,visibleCols:g}=this.beans;if(u?.flushAllFrames(),this.timesDelayed<5&&h&&(!h.areHeaderCellsRendered()||!h.areCellsRendered())){this.timesDelayed++,setTimeout(()=>{this.isAlive()&&this.innerAutoSizeCols(t).then(e,i)});return}this.timesDelayed=0;let m=new Set,v=-1,C=Object.fromEntries(c.map(P=>{var L=P,{colId:x}=L,E=Vt(L,["colId"]);return[x,E]})),b=r??this.gos.get("skipHeaderOnAutoSize"),S=o??b;for(;v!==0;){v=0;let x=[];for(let E of n){if(!E||Wq(E))continue;let P=p.getCol(E);if(!P||m.has(P))continue;let L=f.getPreferredWidthForColumn(P,b);if(L>0){let B=C[P.colId]??{};B.minWidth??(B.minWidth=l),B.maxWidth??(B.maxWidth=a);let j=jae(P,L,B);P.setActualWidth(j,d),m.add(P),v++}x.push(P)}x.length&&g.refresh(d)}S||this.autoSizeColumnGroupsByColumns(n,d,s),e(m)})}autoSizeColumn(t,e,i){this.autoSizeCols({colKeys:[t],skipHeader:i,skipHeaderGroups:!0,source:e})}autoSizeColumnGroupsByColumns(t,e,i){let{colModel:n,ctrlsSvc:r}=this.beans,o=new Set,s=n.getColsForKeys(t);for(let l of s){let c=l.getParent();for(;c&&c!=i;)c.isPadding()||o.add(c),c=c.getParent()}let a;for(let l of o){for(let c of r.getHeaderRowContainerCtrls())if(a=c.getHeaderCtrlForColumn(l),a)break;a?.resizeLeafColumnsToFit(e)}}autoSizeAllColumns(t){if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.autoSizeAllColumns(t));return}this.autoSizeCols(w({colKeys:this.beans.visibleCols.allCols},t))}addColumnAutosizeListeners(t,e){let i=this.gos.get("skipHeaderOnAutoSize"),n=()=>{this.autoSizeColumn(e,"uiColumnResized",i)};t.addEventListener("dblclick",n);let r=new wa(t);return r.addEventListener("doubleTap",n),()=>{t.removeEventListener("dblclick",n),r.destroy()}}addColumnGroupResize(t,e,i){let n=this.gos.get("skipHeaderOnAutoSize"),r=()=>{let o=[],s=e.getDisplayedLeafColumns();for(let a of s)a.getColDef().suppressAutoSize||o.push(a.getColId());o.length>0&&this.autoSizeCols({colKeys:o,skipHeader:n,stopAtGroup:e,source:"uiColumnResized"}),i()};return t.addEventListener("dblclick",r),()=>t.removeEventListener("dblclick",r)}sizeColumnsToFitGridBody(t,e){if(!this.isAlive())return;let i=fD(this.beans);if(i>0){this.sizeColumnsToFit(i,"sizeColumnsToFit",!1,t);return}e===void 0?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(t,100)},0):e===100?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(t,500)},100):e===500?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(t,-1)},500):K(29)}sizeColumnsToFit(t,e="sizeColumnsToFit",i,n){if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.sizeColumnsToFit(t,e,i,n));return}let r={};for(let f of n?.columnLimits??[]){let g=f,{key:m}=g,v=Vt(g,["key"]);r[typeof m=="string"?m:m.getColId()]=v}let o=this.beans.visibleCols.allCols;if(t<=0||!o.length)return;let s=mo(o);if(n?.onlyScaleUp&&s>t||t===s&&o.every(v=>{if(v.colDef.suppressSizeToFit)return!0;let C=r?.[v.getId()],b=C?.minWidth??n?.defaultMinWidth,S=C?.maxWidth??n?.defaultMaxWidth,x=v.getActualWidth();return(b==null||x>=b)&&(S==null||x<=S)}))return;let l=[],c=[];for(let m of o){let v=n?.colKeys?.some(C=>Zu(m,C))??!0;m.getColDef().suppressSizeToFit||!v?c.push(m):l.push(m)}let d=l.slice(0),u=!1,h=m=>{er(l,m),c.push(m)};for(let m of l){m.resetActualWidth(e);let v=r?.[m.getId()],C=v?.minWidth??n?.defaultMinWidth,b=v?.maxWidth??n?.defaultMaxWidth,S=m.getActualWidth();typeof C=="number"&&S<C?m.setActualWidth(C,e,!0):typeof b=="number"&&S>b&&m.setActualWidth(b,e,!0)}for(;!u;){u=!0;let m=t-mo(c);if(m<=0)for(let v of l){let C=r?.[v.getId()]?.minWidth??n?.defaultMinWidth??v.minWidth;v.setActualWidth(C,e,!0)}else{let v=m/mo(l),C=m;for(let b=l.length-1;b>=0;b--){let S=l[b],x=r?.[S.getId()],E=x?.minWidth??n?.defaultMinWidth,P=x?.maxWidth??n?.defaultMaxWidth,L=S.getMinWidth(),B=S.getMaxWidth(),j=typeof E=="number"&&E>L?E:L,q=typeof P=="number"&&P<B?P:B,Y=Math.round(S.getActualWidth()*v);Y<j?(Y=j,h(S),u=!1):Y>q?(Y=q,h(S),u=!1):b===0&&(Y=C),S.setActualWidth(Y,e,!0),C-=Y}}}for(let m of d)m.fireColumnWidthChangedEvent(e);let p=this.beans.visibleCols;p.setLeftValues(e),p.updateBodyWidths(),!i&&fc(this.eventSvc,d,!0,e)}applyAutosizeStrategy(){let{gos:t,colDelayRenderSvc:e}=this.beans,i=t.get("autoSizeStrategy");i?.type!=="fitGridWidth"&&i?.type!=="fitProvidedWidth"||setTimeout(()=>{if(!this.isAlive())return;let n=i.type;if(n==="fitGridWidth"){let{columnLimits:r,defaultMinWidth:o,defaultMaxWidth:s}=i,a=r?.map(({colId:l,minWidth:c,maxWidth:d})=>({key:l,minWidth:c,maxWidth:d}));this.sizeColumnsToFitGridBody({defaultMinWidth:o,defaultMaxWidth:s,columnLimits:a})}else n==="fitProvidedWidth"&&this.sizeColumnsToFit(i.width,"sizeColumnsToFit");e?.revealColumns(n)})}onFirstDataRendered(i){var n=i,{colIds:t}=n,e=Vt(n,["colIds"]);setTimeout(()=>{if(!this.isAlive())return;let r="autosizeColumns";t?this.autoSizeCols(k(w({},e),{source:r,colKeys:t})):this.autoSizeAllColumns(k(w({},e),{source:r})),this.beans.colDelayRenderSvc?.revealColumns(e.type)})}processResizeOperations(){this.shouldQueueResizeOperations=!1;for(let t of this.resizeOperationQueue)t();this.resizeOperationQueue=[]}pushResizeOperation(t){this.resizeOperationQueue.push(t)}destroy(){this.resizeOperationQueue.length=0,super.destroy()}};function jae(t,e,i={}){let n=i.minWidth??t.getMinWidth();e<n&&(e=n);let r=i.maxWidth??t.getMaxWidth();return e>r&&(e=r),e}function fD({ctrlsSvc:t,scrollVisibleSvc:e}){let i=t.getGridBodyCtrl(),r=i.isVerticalScrollShowing()?e.getScrollbarWidth():0;return ah(i.eGridBody)-r}var qae={moduleName:"ColumnAutoSize",version:oe,beans:[Uae],apiFunctions:{sizeColumnsToFit:Gae,autoSizeColumns:PI,autoSizeAllColumns:Wae},dependsOn:[v8]},$ae=".ag-row-pinned-source{background-color:var(--ag-pinned-source-row-background-color);color:var(--ag-pinned-source-row-text-color);font-weight:var(--ag-pinned-source-row-font-weight)}.ag-row-pinned-manual{background-color:var(--ag-pinned-row-background-color);color:var(--ag-pinned-row-text-color);font-weight:var(--ag-pinned-row-font-weight)}";function Kae(t){return t.pinnedRowModel?.getPinnedTopRowCount()??0}function Yae(t){return t.pinnedRowModel?.getPinnedBottomRowCount()??0}function Xae(t,e){return t.pinnedRowModel?.getPinnedTopRow(e)}function Jae(t,e){return t.pinnedRowModel?.getPinnedBottomRow(e)}function Qae(t,e,i){return t.pinnedRowModel?.forEachPinnedRow(e,i)}var Zae={moduleName:"PinnedRow",version:oe,beans:[QX],css:[$ae],apiFunctions:{getPinnedTopRowCount:Kae,getPinnedBottomRowCount:Yae,getPinnedTopRow:Xae,getPinnedBottomRow:Jae,forEachPinnedRow:Qae},icons:{rowPin:"pin",rowPinTop:"pinned-top",rowPinBottom:"pinned-bottom",rowUnpin:"un-pin"}},ele=class{constructor(t,e){this.col=t,this.firstNode=e,this.cellSpan=!0,this.spannedNodes=new Set,this.addSpannedNode(e)}reset(){this.spannedNodes.clear(),this.addSpannedNode(this.firstNode)}addSpannedNode(t){this.spannedNodes.add(t),this.lastNode=t}getLastNode(){return this.lastNode}getCellHeight(){return this.lastNode.rowTop+this.lastNode.rowHeight-this.firstNode.rowTop-1}doesSpanContain(t){return t.column!==this.col||t.rowPinned!=this.firstNode.rowPinned?!1:this.firstNode.rowIndex<=t.rowIndex&&t.rowIndex<=this.lastNode.rowIndex}getLastNodeAutoHeight(){let t=this.firstNode.__autoHeights?.[this.col.getColId()];if(t==null)return;let e=0;for(let i of this.spannedNodes)i!==this.lastNode&&(e+=i.rowHeight);return t-e}},tle=class extends H{constructor(t){super(),this.column=t}buildCache(t){let{column:e,beans:{gos:i,pinnedRowModel:n,rowModel:r,valueSvc:o,pagination:s}}=this,{colDef:a}=e,l=this.getNodeMap(t),c=new Map,d=i.getCallback("isFullWidthRow"),u=a.equals,h=a.spanRows,p=typeof h=="function",f=null,g=null,m,v=(b,S)=>{f=b,g=null,m=S},C=b=>{let S=!b.isExpandable()&&!b.group&&!b.detail&&(d?!d({rowNode:b}):!0);if(b.rowIndex==null||!S){v(null,null);return}if(f==null||b.level!==f.level||b.footer||g&&b.rowIndex-1!==g?.getLastNode().rowIndex){v(b,o.getValue(e,b));return}let x=o.getValue(e,b);if(p){let E=Ee(i,{valueA:m,nodeA:f,valueB:x,nodeB:b,column:e,colDef:a});if(!h(E)){v(b,x);return}}else if(u?!u(m,x):m!==x){v(b,x);return}if(!g){let E=l?.get(f);E?.firstNode===f?(E.reset(),g=E):g=new ele(e,f),c.set(f,g)}g.addSpannedNode(b),c.set(b,g)};switch(t){case"center":r.forEachDisplayedNode?.(b=>{(!s||s.isRowInPage(b.rowIndex))&&C(b)}),this.centerValueNodeMap=c;break;case"top":n?.forEachPinnedRow("top",C),this.topValueNodeMap=c;break;case"bottom":n?.forEachPinnedRow("bottom",C),this.bottomValueNodeMap=c;break}}isCellSpanning(t){return!!this.getCellSpan(t)}getCellSpan(t){return this.getNodeMap(t.rowPinned).get(t)}getNodeMap(t){switch(t){case"top":return this.topValueNodeMap;case"bottom":return this.bottomValueNodeMap;default:return this.centerValueNodeMap}}},ile=class extends H{constructor(){super(...arguments),this.beanName="rowSpanSvc",this.spanningColumns=new Map,this.debouncePinnedEvent=ui(this,this.dispatchCellsUpdatedEvent.bind(this,!0),0),this.debounceModelEvent=ui(this,this.dispatchCellsUpdatedEvent.bind(this,!1),0),this.pinnedTimeout=null,this.modelTimeout=null}postConstruct(){let t=this.onRowDataUpdated.bind(this),e=this.buildPinnedCaches.bind(this);this.addManagedEventListeners({paginationChanged:this.buildModelCaches.bind(this),pinnedRowDataChanged:e,pinnedRowsChanged:e,rowNodeDataChanged:t,cellValueChanged:t})}register(t){let{gos:e}=this.beans;if(!e.get("enableCellSpan")||this.spanningColumns.has(t))return;let i=this.createManagedBean(new tle(t));this.spanningColumns.set(t,i),i.buildCache("top"),i.buildCache("bottom"),i.buildCache("center"),this.debouncePinnedEvent(),this.debounceModelEvent()}dispatchCellsUpdatedEvent(t){this.dispatchLocalEvent({type:"spannedCellsUpdated",pinned:t})}deregister(t){this.spanningColumns.delete(t)}onRowDataUpdated({node:t}){let{spannedRowRenderer:e}=this.beans;if(t.rowPinned){if(this.pinnedTimeout!=null)return;this.pinnedTimeout=window.setTimeout(()=>{this.pinnedTimeout=null,this.buildPinnedCaches(),e?.createCtrls("top"),e?.createCtrls("bottom")},0);return}this.modelTimeout==null&&(this.modelTimeout=window.setTimeout(()=>{this.modelTimeout=null,this.buildModelCaches(),e?.createCtrls("center")},0))}buildModelCaches(){this.modelTimeout!=null&&clearTimeout(this.modelTimeout),this.spanningColumns.forEach(t=>t.buildCache("center")),this.debounceModelEvent()}buildPinnedCaches(){this.pinnedTimeout!=null&&clearTimeout(this.pinnedTimeout),this.spanningColumns.forEach(t=>{t.buildCache("top"),t.buildCache("bottom")}),this.debouncePinnedEvent()}isCellSpanning(t,e){let i=this.spanningColumns.get(t);return i?i.isCellSpanning(e):!1}getCellSpanByPosition(t){let{pinnedRowModel:e,rowModel:i}=this.beans,n=t.column,r=t.rowIndex,o=this.spanningColumns.get(n);if(!o)return;let s;switch(t.rowPinned){case"top":s=e?.getPinnedTopRow(r);break;case"bottom":s=e?.getPinnedBottomRow(r);break;default:s=i.getRow(r)}if(s)return o.getCellSpan(s)}getCellStart(t){let e=this.getCellSpanByPosition(t);return e?k(w({},t),{rowIndex:e.firstNode.rowIndex}):t}getCellEnd(t){let e=this.getCellSpanByPosition(t);return e?k(w({},t),{rowIndex:e.getLastNode().rowIndex}):t}getCellSpan(t,e){let i=this.spanningColumns.get(t);if(i)return i.getCellSpan(e)}forEachSpannedColumn(t,e){for(let[i,n]of this.spanningColumns)if(n.isCellSpanning(t)){let r=n.getCellSpan(t);e(i,r)}}destroy(){super.destroy(),this.spanningColumns.clear()}},nle=class extends uc{constructor(t,e,i){super(t.col,t.firstNode,i,e),this.cellSpan=t,this.SPANNED_CELL_CSS_CLASS="ag-spanned-cell"}setComp(t,e,i,n,r,o,s){this.eWrapper=i,super.setComp(t,e,i,n,r,o,s),this.setAriaRowSpan(),this.refreshAriaRowIndex()}isCellSpanning(){return!0}getCellSpan(){return this.cellSpan}refreshAriaRowIndex(){let{eGui:t,rowNode:e}=this;!t||e.rowIndex==null||fm(t,e.rowIndex)}setAriaRowSpan(){Lj(this.eGui,this.cellSpan.spannedNodes.size)}setFocusedCellPosition(t){this.focusedCellPosition=t}getFocusedCellPosition(){return this.focusedCellPosition??this.cellPosition}checkCellFocused(){let t=this.beans.focusSvc.getFocusedCell();return!!t&&this.cellSpan.doesSpanContain(t)}applyStaticCssClasses(){super.applyStaticCssClasses(),this.comp.toggleCss(this.SPANNED_CELL_CSS_CLASS,!0)}onCellFocused(t){let{beans:e}=this;if(Wm(e)){this.focusedCellPosition=void 0;return}let i=this.isCellFocused();i||(this.focusedCellPosition=void 0),t&&i&&(this.focusedCellPosition={rowIndex:t.rowIndex,rowPinned:t.rowPinned,column:t.column}),super.onCellFocused(t)}getRootElement(){return this.eWrapper}},rle=class extends Am{onRowIndexChanged(){super.onRowIndexChanged();for(let t of this.getAllCellCtrls())t.refreshAriaRowIndex()}getInitialRowClasses(t){return["ag-spanned-row"]}getNewCellCtrl(t){let e=this.beans.rowSpanSvc?.getCellSpan(t,this.rowNode);if(!(!e||e.firstNode!==this.rowNode))return new nle(e,this,this.beans)}isCorrectCtrlForSpan(t){let e=this.beans.rowSpanSvc?.getCellSpan(t.column,this.rowNode);return!e||e.firstNode!==this.rowNode?!1:t.getCellSpan()===e}onRowHeightChanged(){}refreshFirstAndLastRowStyles(){}addHoverFunctionality(){}resetHoveredStatus(){}},ole=class extends H{constructor(){super(...arguments),this.beanName="spannedRowRenderer",this.topCtrls=new Map,this.bottomCtrls=new Map,this.centerCtrls=new Map}postConstruct(){this.addManagedEventListeners({displayedRowsChanged:this.createAllCtrls.bind(this)})}createAllCtrls(){this.createCtrls("top"),this.createCtrls("bottom"),this.createCtrls("center")}createCtrls(t){let{rowSpanSvc:e}=this.beans,i=this.getCtrlsMap(t),n=i.size,r=this.getAllRelevantRowControls(t),o=new Map,s=!1;for(let l of r)l.isAlive()&&e?.forEachSpannedColumn(l.rowNode,(c,d)=>{if(o.has(d.firstNode))return;let u=i.get(d.firstNode);if(u){o.set(d.firstNode,u),i.delete(d.firstNode);return}s=!0;let h=new rle(d.firstNode,this.beans,!1,!1,!1);o.set(d.firstNode,h)});this.setCtrlsMap(t,o);let a=o.size===n;if(!(!s&&a)){for(let l of i.values())l.destroyFirstPass(!0),l.destroySecondPass();this.dispatchLocalEvent({type:"spannedRowsUpdated",ctrlsKey:t})}}getAllRelevantRowControls(t){let{rowRenderer:e}=this.beans;switch(t){case"top":return e.topRowCtrls;case"bottom":return e.bottomRowCtrls;case"center":return e.allRowCtrls}}getCellByPosition(t){let{rowSpanSvc:e}=this.beans,i=e?.getCellSpanByPosition(t);if(!i)return;let n=this.getCtrlsMap(t.rowPinned).get(i.firstNode);if(n)return n.getAllCellCtrls().find(r=>r.column===t.column)}getCtrls(t){return[...this.getCtrlsMap(t).values()]}destroyRowCtrls(t){for(let e of this.getCtrlsMap(t).values())e.destroyFirstPass(!0),e.destroySecondPass();this.setCtrlsMap(t,new Map)}getCtrlsMap(t){switch(t){case"top":return this.topCtrls;case"bottom":return this.bottomCtrls;default:return this.centerCtrls}}setCtrlsMap(t,e){switch(t){case"top":this.topCtrls=e;break;case"bottom":this.bottomCtrls=e;break;default:this.centerCtrls=e;break}}destroy(){super.destroy(),this.destroyRowCtrls("top"),this.destroyRowCtrls("bottom"),this.destroyRowCtrls("center")}},sle={moduleName:"CellSpan",version:oe,beans:[ile,ole]},ale=class extends H{constructor(t,e){super(),this.cellCtrl=t,this.staticClasses=[],this.beans=e,this.column=t.column}setComp(t){this.cellComp=t,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}applyCellClassRules(){let{column:t,cellComp:e}=this,i=t.colDef,n=i.cellClassRules,r=this.getCellClassParams(t,i);a2(this.beans.expressionSvc,n===this.cellClassRules?void 0:this.cellClassRules,n,r,o=>e.toggleCss(o,!0),o=>e.toggleCss(o,!1)),this.cellClassRules=n}applyUserStyles(){let t=this.column,e=t.colDef,i=e.cellStyle;if(!i)return;let n;if(typeof i=="function"){let r=this.getCellClassParams(t,e);n=i(r)}else n=i;n&&this.cellComp.setUserStyles(n)}applyClassesFromColDef(){let{column:t,cellComp:e}=this,i=t.colDef,n=this.getCellClassParams(t,i);for(let o of this.staticClasses)e.toggleCss(o,!1);let r=this.beans.cellStyles.getStaticCellClasses(i,n);this.staticClasses=r;for(let o of r)e.toggleCss(o,!0)}getCellClassParams(t,e){let{value:i,rowNode:n}=this.cellCtrl;return Ee(this.beans.gos,{value:i,data:n.data,node:n,colDef:e,column:t,rowIndex:n.rowIndex})}},lle=class extends H{constructor(){super(...arguments),this.beanName="cellStyles"}processAllCellClasses(t,e,i,n){a2(this.beans.expressionSvc,void 0,t.cellClassRules,e,i,n),this.processStaticCellClasses(t,e,i)}getStaticCellClasses(t,e){let{cellClass:i}=t;if(!i)return[];let n;return typeof i=="function"?n=i(e):n=i,typeof n=="string"&&(n=[n]),n||[]}createCellCustomStyleFeature(t,e){return new ale(t,e)}processStaticCellClasses(t,e,i){this.getStaticCellClasses(t,e).forEach(r=>{i(r)})}},cle={moduleName:"CellStyle",version:oe,beans:[lle]},dle={moduleName:"RowStyle",version:oe,beans:[Xte]};function ule(t,e){return!!t.colHover?.isHovered(e)}var hle=class extends H{constructor(t,e){super(),this.columns=t,this.element=e,this.destroyManagedListeners=[],this.enableFeature=i=>{let{beans:n,gos:r,element:o,columns:s}=this,a=n.colHover;if(i??!!r.get("columnHoverHighlight"))this.destroyManagedListeners=this.addManagedElementListeners(o,{mouseover:a.setMouseOver.bind(a,s),mouseout:a.clearMouseOver.bind(a)});else{for(let c of this.destroyManagedListeners)c();this.destroyManagedListeners=[]}}}postConstruct(){this.addManagedPropertyListener("columnHoverHighlight",({currentValue:t})=>{this.enableFeature(t)}),this.enableFeature()}destroy(){super.destroy(),this.destroyManagedListeners=null}},ple="ag-column-hover",fle=class extends H{constructor(){super(...arguments),this.beanName="colHover"}postConstruct(){this.addManagedPropertyListener("columnHoverHighlight",({currentValue:t})=>{t||this.clearMouseOver()})}setMouseOver(t){this.updateState(t)}clearMouseOver(){this.updateState(null)}isHovered(t){if(!this.gos.get("columnHoverHighlight"))return!1;let e=this.selectedColumns;return!!e&&e.indexOf(t)>=0}addHeaderColumnHoverListener(t,e,i){let n=()=>{let r=this.isHovered(i);e.toggleCss("ag-column-hover",r)};t.addManagedEventListeners({columnHoverChanged:n}),n()}onCellColumnHover(t,e){if(!e)return;let i=this.isHovered(t);e.toggleCss(ple,i)}addHeaderFilterColumnHoverListener(t,e,i,n){this.createHoverFeature(t,[i],n);let r=()=>{let o=this.isHovered(i);e.toggleCss("ag-column-hover",o)};t.addManagedEventListeners({columnHoverChanged:r}),r()}createHoverFeature(t,e,i){t.createManagedBean(new hle(e,i))}updateState(t){this.selectedColumns=t,this.eventSvc.dispatchEvent({type:"columnHoverChanged"})}},gle={moduleName:"ColumnHover",version:oe,beans:[fle],apiFunctions:{isColumnHovered:ule}},mle=class extends H{constructor(){super(...arguments),this.beanName="apiEventSvc",this.syncListeners=new Map,this.asyncListeners=new Map,this.syncGlobalListeners=new Set,this.globalListenerPairs=new Map}postConstruct(){this.wrapSvc=this.beans.frameworkOverrides.createGlobalEventListenerWrapper?.()}addListener(t,e){let i=this.wrapSvc?.wrap(t,e)??e,n=!hm.has(t),r=n?this.asyncListeners:this.syncListeners;r.has(t)||r.set(t,new Set),r.get(t).add(i),this.eventSvc.addListener(t,i,n)}removeListener(t,e){let i=this.wrapSvc?.unwrap(t,e)??e,r=!!this.asyncListeners.get(t)?.delete(i);r||this.syncListeners.get(t)?.delete(i),this.eventSvc.removeListener(t,i,r)}addGlobalListener(t){let e=this.wrapSvc?.wrapGlobal(t)??t,i=(o,s)=>{hm.has(o)&&e(o,s)},n=(o,s)=>{hm.has(o)||e(o,s)};this.globalListenerPairs.set(t,{syncListener:i,asyncListener:n});let r=this.eventSvc;r.addGlobalListener(i,!1),r.addGlobalListener(n,!0)}removeGlobalListener(t){let{eventSvc:e,wrapSvc:i,globalListenerPairs:n}=this,r=i?.unwrapGlobal(t)??t;if(n.has(r)){let{syncListener:s,asyncListener:a}=n.get(r);e.removeGlobalListener(s,!1),e.removeGlobalListener(a,!0),n.delete(t)}else this.syncGlobalListeners.delete(r),e.removeGlobalListener(r,!1)}destroyEventListeners(t,e){t.forEach((i,n)=>{i.forEach(r=>this.eventSvc.removeListener(n,r,e)),i.clear()}),t.clear()}destroyGlobalListeners(t,e){for(let i of t)this.eventSvc.removeGlobalListener(i,e);t.clear()}destroy(){super.destroy(),this.destroyEventListeners(this.syncListeners,!1),this.destroyEventListeners(this.asyncListeners,!0),this.destroyGlobalListeners(this.syncGlobalListeners,!1);let{globalListenerPairs:t,eventSvc:e}=this;t.forEach(({syncListener:i,asyncListener:n})=>{e.removeGlobalListener(i,!1),e.removeGlobalListener(n,!0)}),t.clear()}};function vle(t,e,i){t.apiEventSvc?.addListener(e,i)}function Cle(t,e,i){t.apiEventSvc?.removeListener(e,i)}function wle(t,e){t.apiEventSvc?.addGlobalListener(e)}function ble(t,e){t.apiEventSvc?.removeGlobalListener(e)}var yle={moduleName:"EventApi",version:oe,apiFunctions:{addEventListener:vle,addGlobalListener:wle,removeEventListener:Cle,removeGlobalListener:ble},beans:[mle]},Sle={moduleName:"Locale",version:oe,beans:[Xie]},xle=class extends H{constructor(){super(...arguments),this.beanName="rowAutoHeight",this.wasEverActive=!1,this._debouncedCalculateRowHeights=ui(this,this.calculateRowHeights.bind(this),1)}requestCheckAutoHeight(){this.wasEverActive&&this._debouncedCalculateRowHeights()}calculateRowHeights(){let{visibleCols:t,rowModel:e,rowSpanSvc:i,pinnedRowModel:n}=this.beans,r=t.autoHeightCols,o=!1,s=a=>{let l=a.__autoHeights,c=ws(this.beans,a).height;for(let d of r){let u=l?.[d.getColId()],h=i?.getCellSpan(d,a);if(h){if(h.getLastNode()!==a)continue;if(u=i?.getCellSpan(d,a)?.getLastNodeAutoHeight(),!u)return}if(u==null){if(this.colSpanSkipCell(d,a))continue;return}c=Math.max(u,c)}c!==a.rowHeight&&(a.setRowHeight(c),o=!0)};n?.forEachPinnedRow?.("top",s),n?.forEachPinnedRow?.("bottom",s),e.forEachDisplayedNode?.(s),o&&e.onRowHeightChanged?.()}setRowAutoHeight(t,e,i){if(t.__autoHeights??(t.__autoHeights={}),e==null){delete t.__autoHeights[i.getId()];return}let n=t.__autoHeights[i.getId()];t.__autoHeights[i.getId()]=e,n!==e&&this.requestCheckAutoHeight()}colSpanSkipCell(t,e){let{colModel:i,colViewport:n,visibleCols:r}=this.beans;if(!i.colSpanActive)return!1;let o=[];switch(t.getPinned()){case"left":o=r.getLeftColsForRow(e);break;case"right":o=r.getRightColsForRow(e);break;case null:o=n.getColsWithinViewport(e);break}return!o.includes(t)}setupCellAutoHeight(t,e,i){if(!t.column.isAutoHeight()||!e)return!1;this.wasEverActive=!0;let n=e.parentElement,{rowNode:r,column:o}=t,s=this.beans,a=d=>{if(this.beans.editSvc?.isEditing(t)||!t.isAlive()||!i.isAlive())return;let{paddingTop:u,paddingBottom:h,borderBottomWidth:p,borderTopWidth:f}=Ia(n),g=u+h+p+f,v=e.offsetHeight+g;if(d<5){let b=!ri(s)?.contains(e),S=v==0;if(b||S){window.setTimeout(()=>a(d+1),0);return}}this.setRowAutoHeight(r,v,o)},l=()=>a(0);l();let c=Ss(s,e,l);return i.addDestroyFunc(()=>{c(),this.setRowAutoHeight(r,void 0,o)}),!0}setAutoHeightActive(t){this.active=t.list.some(e=>e.isVisible()&&e.isAutoHeight())}areRowsMeasured(){if(!this.active)return!0;let t=this.beans.rowRenderer.getAllRowCtrls(),e=null;for(let{rowNode:i}of t)if((!e||this.beans.colModel.colSpanActive)&&(e=this.beans.colViewport.getColsWithinViewport(i).filter(r=>r.isAutoHeight())),e.length!==0){if(!i.__autoHeights)return!1;for(let n of e){let r=i.__autoHeights[n.getColId()];if(!r||i.rowHeight<r)return!1}}return!0}},Ele={moduleName:"RowAutoHeight",version:oe,beans:[xle]},Xm={moduleName:"AllCommunity",version:oe,dependsOn:[xse,Dse,Vse,fne,Eoe,Poe,Roe,_oe,koe,Foe,Toe,xoe,mre,vre,Cre,gre,bre,yre,nae,tse,Sae,C8,Mae,Iae,Vae,qae,uQ,Zae,joe,Mie,cle,gle,dle,yle,Oie,Jse,cI,Sle,Ele,dQ,Ese,sle]};var Ple=(()=>{let e=class e{constructor(){this.vcr=Z(Ka)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=Ie({type:e,selectors:[["ag-component-container"]],standalone:!1,decls:0,vars:0,template:function(r,o){},encapsulation:2});let t=e;return t})(),kI=16,g2=0;function Rle(t){let e=new Map;for(let i=0;i<kI;i++){let n=t.createComponent(Ple);e.set(i,n),Xi(n.location.nativeElement)}return e}var _le=new Set(["doesFilterPass","isFilterActive"]),RI=(()=>{let e=class e extends $8{setViewContainerRef(n,r){this.viewContainerRef=n,this.angularFrameworkOverrides=r}createWrapper(n){let r=this.angularFrameworkOverrides,o=this;o.compShards??=Rle(this.viewContainerRef);class s extends m2{init(c){r.runInsideAngular(()=>{super.init(c),this._componentRef.changeDetectorRef.detectChanges()})}createComponent(){return o.createComponent(n)}hasMethod(c){return a.getFrameworkComponentInstance()[c]!=null}callMethod(c,d){let u=this.getFrameworkComponentInstance(),h=u[c];return _le.has(c)?h.apply(u,d):r.runInsideAngular(()=>h.apply(u,d))}addMethod(c,d){a[c]=d}}let a=new s;return a}createComponent(n){return g2=(g2+1)%kI,this.compShards.get(g2).instance.vcr.createComponent(n)}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=Ns(e)))(o||e)}})(),e.\u0275prov=Hn({token:e,factory:e.\u0275fac});let t=e;return t})(),m2=class{init(e){this._params=e,this._componentRef=this.createComponent(),this._agAwareComponent=this._componentRef.instance,this._frameworkComponentInstance=this._componentRef.instance,this._eGui=this._componentRef.location.nativeElement,Xi(this._eGui),this._agAwareComponent.agInit(this._params)}getGui(){return this._eGui}getRootElement(){return this._eGui.firstChild}destroy(){this._frameworkComponentInstance&&typeof this._frameworkComponentInstance.destroy=="function"&&this._frameworkComponentInstance.destroy(),this._componentRef?.destroy()}getFrameworkComponentInstance(){return this._frameworkComponentInstance}},Jm=class{constructor(e){this.frameworkOverrides=e,this.wrappedListeners=new Map,this.wrappedGlobalListeners=new Map}wrap(e,i){let{frameworkOverrides:n,wrappedListeners:r}=this,o=i;if(n.shouldWrapOutgoing){o=a=>{n.wrapOutgoing(()=>i(a))};let s=r.get(e);s||(s=new Map,r.set(e,s)),s.set(i,o)}return o}wrapGlobal(e){let{frameworkOverrides:i,wrappedGlobalListeners:n}=this,r=e;return i.shouldWrapOutgoing&&(r=(o,s)=>{i.wrapOutgoing(()=>e(o,s))},n.set(e,r)),r}unwrap(e,i){let{wrappedListeners:n}=this,r=n.get(e);if(r){let o=r.get(i);if(o)return r.delete(i),r.size===0&&n.delete(e),o}return i}unwrapGlobal(e){let{wrappedGlobalListeners:i}=this,n=i.get(e);return n?(i.delete(e),n):e}},_I=(()=>{let e=class e extends e2{constructor(n){super("angular"),this._ngZone=n,this.batchFrameworkComps=!0,this.isRunningWithinTestZone=!1,this.wrapIncoming=(r,o)=>this.runOutside(r,o),this.wrapOutgoing=r=>this.runInsideAngular(r),this.isRunningWithinTestZone=window?.AG_GRID_UNDER_TEST??!!window?.Zone?.AsyncTestZoneSpec,this._ngZone?this.isRunningWithinTestZone?this.runOutside=(r,o)=>o==="resize-observer"||o==="popupPositioning"?this._ngZone.runOutsideAngular(r):r():this.runOutside=r=>this._ngZone.runOutsideAngular(r):this.runOutside=r=>r()}get shouldWrapOutgoing(){return this._ngZone&&Wi.isInAngularZone()}createLocalEventListenerWrapper(n,r){if(this.shouldWrapOutgoing)return n??(r.setFrameworkOverrides(this),new Jm(this))}createGlobalEventListenerWrapper(){return new Jm(this)}isFrameworkComponent(n){if(!n)return!1;let r=n.prototype;return r&&"agInit"in r}runInsideAngular(n){return!this._ngZone||Wi.isInAngularZone()?n():this._ngZone.run(n)}runOutsideAngular(n,r){return this.runOutside(n,r)}};e.\u0275fac=function(r){return new(r||e)(cx(Wi))},e.\u0275prov=Hn({token:e,factory:e.\u0275fac});let t=e;return t})(),yc=(()=>{let e=class e{constructor(n,r,o,s){this._viewContainerRef=r,this._angularFrameworkOverrides=o,this._frameworkCompWrapper=s,this._initialised=!1,this._destroyed=!1,this._holdEvents=!0,this._fullyReady=new Promise(a=>{this._resolveFullyReady=a}),this.statusBar=void 0,this.sideBar=void 0,this.suppressContextMenu=void 0,this.preventDefaultOnContextMenu=void 0,this.allowContextMenuWithControlKey=void 0,this.columnMenu=void 0,this.suppressMenuHide=void 0,this.enableBrowserTooltips=void 0,this.tooltipTrigger=void 0,this.tooltipShowDelay=void 0,this.tooltipHideDelay=void 0,this.tooltipMouseTrack=void 0,this.tooltipShowMode=void 0,this.tooltipInteraction=void 0,this.popupParent=void 0,this.copyHeadersToClipboard=void 0,this.copyGroupHeadersToClipboard=void 0,this.clipboardDelimiter=void 0,this.suppressCopyRowsToClipboard=void 0,this.suppressCopySingleCellRanges=void 0,this.suppressLastEmptyLineOnPaste=void 0,this.suppressClipboardPaste=void 0,this.suppressClipboardApi=void 0,this.suppressCutToClipboard=void 0,this.columnDefs=void 0,this.defaultColDef=void 0,this.defaultColGroupDef=void 0,this.columnTypes=void 0,this.dataTypeDefinitions=void 0,this.maintainColumnOrder=void 0,this.enableStrictPivotColumnOrder=void 0,this.suppressFieldDotNotation=void 0,this.headerHeight=void 0,this.groupHeaderHeight=void 0,this.floatingFiltersHeight=void 0,this.pivotHeaderHeight=void 0,this.pivotGroupHeaderHeight=void 0,this.hidePaddedHeaderRows=void 0,this.allowDragFromColumnsToolPanel=void 0,this.suppressMovableColumns=void 0,this.suppressColumnMoveAnimation=void 0,this.suppressMoveWhenColumnDragging=void 0,this.suppressDragLeaveHidesColumns=void 0,this.suppressGroupChangesColumnVisibility=void 0,this.suppressMakeColumnVisibleAfterUnGroup=void 0,this.suppressRowGroupHidesColumns=void 0,this.colResizeDefault=void 0,this.suppressAutoSize=void 0,this.autoSizePadding=void 0,this.skipHeaderOnAutoSize=void 0,this.autoSizeStrategy=void 0,this.components=void 0,this.editType=void 0,this.suppressStartEditOnTab=void 0,this.getFullRowEditValidationErrors=void 0,this.invalidEditValueMode=void 0,this.singleClickEdit=void 0,this.suppressClickEdit=void 0,this.readOnlyEdit=void 0,this.stopEditingWhenCellsLoseFocus=void 0,this.enterNavigatesVertically=void 0,this.enterNavigatesVerticallyAfterEdit=void 0,this.enableCellEditingOnBackspace=void 0,this.undoRedoCellEditing=void 0,this.undoRedoCellEditingLimit=void 0,this.defaultCsvExportParams=void 0,this.suppressCsvExport=void 0,this.defaultExcelExportParams=void 0,this.suppressExcelExport=void 0,this.excelStyles=void 0,this.findSearchValue=void 0,this.findOptions=void 0,this.quickFilterText=void 0,this.cacheQuickFilter=void 0,this.includeHiddenColumnsInQuickFilter=void 0,this.quickFilterParser=void 0,this.quickFilterMatcher=void 0,this.applyQuickFilterBeforePivotOrAgg=void 0,this.excludeChildrenWhenTreeDataFiltering=void 0,this.enableAdvancedFilter=void 0,this.alwaysPassFilter=void 0,this.includeHiddenColumnsInAdvancedFilter=void 0,this.advancedFilterParent=void 0,this.advancedFilterBuilderParams=void 0,this.advancedFilterParams=void 0,this.suppressAdvancedFilterEval=void 0,this.suppressSetFilterByDefault=void 0,this.enableFilterHandlers=void 0,this.filterHandlers=void 0,this.enableCharts=void 0,this.chartThemes=void 0,this.customChartThemes=void 0,this.chartThemeOverrides=void 0,this.chartToolPanelsDef=void 0,this.chartMenuItems=void 0,this.loadingCellRenderer=void 0,this.loadingCellRendererParams=void 0,this.loadingCellRendererSelector=void 0,this.localeText=void 0,this.masterDetail=void 0,this.keepDetailRows=void 0,this.keepDetailRowsCount=void 0,this.detailCellRenderer=void 0,this.detailCellRendererParams=void 0,this.detailRowHeight=void 0,this.detailRowAutoHeight=void 0,this.context=void 0,this.alignedGrids=void 0,this.tabIndex=void 0,this.rowBuffer=void 0,this.valueCache=void 0,this.valueCacheNeverExpires=void 0,this.enableCellExpressions=void 0,this.suppressTouch=void 0,this.suppressFocusAfterRefresh=void 0,this.suppressBrowserResizeObserver=void 0,this.suppressPropertyNamesCheck=void 0,this.suppressChangeDetection=void 0,this.debug=void 0,this.loading=void 0,this.overlayLoadingTemplate=void 0,this.loadingOverlayComponent=void 0,this.loadingOverlayComponentParams=void 0,this.suppressLoadingOverlay=void 0,this.overlayNoRowsTemplate=void 0,this.noRowsOverlayComponent=void 0,this.noRowsOverlayComponentParams=void 0,this.suppressNoRowsOverlay=void 0,this.pagination=void 0,this.paginationPageSize=void 0,this.paginationPageSizeSelector=void 0,this.paginationAutoPageSize=void 0,this.paginateChildRows=void 0,this.suppressPaginationPanel=void 0,this.pivotMode=void 0,this.pivotPanelShow=void 0,this.pivotMaxGeneratedColumns=void 0,this.pivotDefaultExpanded=void 0,this.pivotColumnGroupTotals=void 0,this.pivotRowTotals=void 0,this.pivotSuppressAutoColumn=void 0,this.suppressExpandablePivotGroups=void 0,this.functionsReadOnly=void 0,this.aggFuncs=void 0,this.suppressAggFuncInHeader=void 0,this.alwaysAggregateAtRootLevel=void 0,this.aggregateOnlyChangedColumns=void 0,this.suppressAggFilteredOnly=void 0,this.removePivotHeaderRowWhenSingleValueColumn=void 0,this.animateRows=void 0,this.cellFlashDuration=void 0,this.cellFadeDuration=void 0,this.allowShowChangeAfterFilter=void 0,this.domLayout=void 0,this.ensureDomOrder=void 0,this.enableCellSpan=void 0,this.enableRtl=void 0,this.suppressColumnVirtualisation=void 0,this.suppressMaxRenderedRowRestriction=void 0,this.suppressRowVirtualisation=void 0,this.rowDragManaged=void 0,this.rowDragInsertDelay=void 0,this.suppressRowDrag=void 0,this.suppressMoveWhenRowDragging=void 0,this.rowDragEntireRow=void 0,this.rowDragMultiRow=void 0,this.rowDragText=void 0,this.dragAndDropImageComponent=void 0,this.dragAndDropImageComponentParams=void 0,this.fullWidthCellRenderer=void 0,this.fullWidthCellRendererParams=void 0,this.embedFullWidthRows=void 0,this.groupDisplayType=void 0,this.groupDefaultExpanded=void 0,this.autoGroupColumnDef=void 0,this.groupMaintainOrder=void 0,this.groupSelectsChildren=void 0,this.groupLockGroupColumns=void 0,this.groupAggFiltering=void 0,this.groupTotalRow=void 0,this.grandTotalRow=void 0,this.suppressStickyTotalRow=void 0,this.groupSuppressBlankHeader=void 0,this.groupSelectsFiltered=void 0,this.showOpenedGroup=void 0,this.groupHideParentOfSingleChild=void 0,this.groupRemoveSingleChildren=void 0,this.groupRemoveLowestSingleChildren=void 0,this.groupHideOpenParents=void 0,this.groupAllowUnbalanced=void 0,this.rowGroupPanelShow=void 0,this.groupRowRenderer=void 0,this.groupRowRendererParams=void 0,this.treeData=void 0,this.treeDataChildrenField=void 0,this.treeDataParentIdField=void 0,this.rowGroupPanelSuppressSort=void 0,this.suppressGroupRowsSticky=void 0,this.groupHierarchyConfig=void 0,this.pinnedTopRowData=void 0,this.pinnedBottomRowData=void 0,this.enableRowPinning=void 0,this.isRowPinnable=void 0,this.isRowPinned=void 0,this.rowModelType=void 0,this.rowData=void 0,this.asyncTransactionWaitMillis=void 0,this.suppressModelUpdateAfterUpdateTransaction=void 0,this.datasource=void 0,this.cacheOverflowSize=void 0,this.infiniteInitialRowCount=void 0,this.serverSideInitialRowCount=void 0,this.suppressServerSideFullWidthLoadingRow=void 0,this.cacheBlockSize=void 0,this.maxBlocksInCache=void 0,this.maxConcurrentDatasourceRequests=void 0,this.blockLoadDebounceMillis=void 0,this.purgeClosedRowNodes=void 0,this.serverSideDatasource=void 0,this.serverSideSortAllLevels=void 0,this.serverSideEnableClientSideSort=void 0,this.serverSideOnlyRefreshFilteredGroups=void 0,this.serverSidePivotResultFieldSeparator=void 0,this.viewportDatasource=void 0,this.viewportRowModelPageSize=void 0,this.viewportRowModelBufferSize=void 0,this.alwaysShowHorizontalScroll=void 0,this.alwaysShowVerticalScroll=void 0,this.debounceVerticalScrollbar=void 0,this.suppressHorizontalScroll=void 0,this.suppressScrollOnNewData=void 0,this.suppressScrollWhenPopupsAreOpen=void 0,this.suppressAnimationFrame=void 0,this.suppressMiddleClickScrolls=void 0,this.suppressPreventDefaultOnMouseWheel=void 0,this.scrollbarWidth=void 0,this.rowSelection=void 0,this.cellSelection=void 0,this.rowMultiSelectWithClick=void 0,this.suppressRowDeselection=void 0,this.suppressRowClickSelection=void 0,this.suppressCellFocus=void 0,this.suppressHeaderFocus=void 0,this.selectionColumnDef=void 0,this.rowNumbers=void 0,this.suppressMultiRangeSelection=void 0,this.enableCellTextSelection=void 0,this.enableRangeSelection=void 0,this.enableRangeHandle=void 0,this.enableFillHandle=void 0,this.fillHandleDirection=void 0,this.suppressClearOnFillReduction=void 0,this.sortingOrder=void 0,this.accentedSort=void 0,this.unSortIcon=void 0,this.suppressMultiSort=void 0,this.alwaysMultiSort=void 0,this.multiSortKey=void 0,this.suppressMaintainUnsortedOrder=void 0,this.icons=void 0,this.rowHeight=void 0,this.rowStyle=void 0,this.rowClass=void 0,this.rowClassRules=void 0,this.suppressRowHoverHighlight=void 0,this.suppressRowTransform=void 0,this.columnHoverHighlight=void 0,this.gridId=void 0,this.deltaSort=void 0,this.treeDataDisplayType=void 0,this.enableGroupEdit=void 0,this.initialState=void 0,this.theme=void 0,this.loadThemeGoogleFonts=void 0,this.themeCssLayer=void 0,this.styleNonce=void 0,this.themeStyleContainer=void 0,this.getContextMenuItems=void 0,this.getMainMenuItems=void 0,this.postProcessPopup=void 0,this.processUnpinnedColumns=void 0,this.processCellForClipboard=void 0,this.processHeaderForClipboard=void 0,this.processGroupHeaderForClipboard=void 0,this.processCellFromClipboard=void 0,this.sendToClipboard=void 0,this.processDataFromClipboard=void 0,this.isExternalFilterPresent=void 0,this.doesExternalFilterPass=void 0,this.getChartToolbarItems=void 0,this.createChartContainer=void 0,this.focusGridInnerElement=void 0,this.navigateToNextHeader=void 0,this.tabToNextHeader=void 0,this.navigateToNextCell=void 0,this.tabToNextCell=void 0,this.getLocaleText=void 0,this.getDocument=void 0,this.paginationNumberFormatter=void 0,this.getGroupRowAgg=void 0,this.isGroupOpenByDefault=void 0,this.ssrmExpandAllAffectsAllRows=void 0,this.initialGroupOrderComparator=void 0,this.processPivotResultColDef=void 0,this.processPivotResultColGroupDef=void 0,this.getDataPath=void 0,this.getChildCount=void 0,this.getServerSideGroupLevelParams=void 0,this.isServerSideGroupOpenByDefault=void 0,this.isApplyServerSideTransaction=void 0,this.isServerSideGroup=void 0,this.getServerSideGroupKey=void 0,this.getBusinessKeyForNode=void 0,this.getRowId=void 0,this.resetRowDataOnUpdate=void 0,this.processRowPostCreate=void 0,this.isRowSelectable=void 0,this.isRowMaster=void 0,this.fillOperation=void 0,this.postSortRows=void 0,this.getRowStyle=void 0,this.getRowClass=void 0,this.getRowHeight=void 0,this.isFullWidthRow=void 0,this.isRowValidDropPosition=void 0,this.toolPanelVisibleChanged=new W,this.toolPanelSizeChanged=new W,this.columnMenuVisibleChanged=new W,this.contextMenuVisibleChanged=new W,this.cutStart=new W,this.cutEnd=new W,this.pasteStart=new W,this.pasteEnd=new W,this.columnVisible=new W,this.columnPinned=new W,this.columnResized=new W,this.columnMoved=new W,this.columnValueChanged=new W,this.columnPivotModeChanged=new W,this.columnPivotChanged=new W,this.columnGroupOpened=new W,this.newColumnsLoaded=new W,this.gridColumnsChanged=new W,this.displayedColumnsChanged=new W,this.virtualColumnsChanged=new W,this.columnEverythingChanged=new W,this.columnsReset=new W,this.columnHeaderMouseOver=new W,this.columnHeaderMouseLeave=new W,this.columnHeaderClicked=new W,this.columnHeaderContextMenu=new W,this.componentStateChanged=new W,this.cellValueChanged=new W,this.cellEditRequest=new W,this.rowValueChanged=new W,this.cellEditingStarted=new W,this.cellEditingStopped=new W,this.rowEditingStarted=new W,this.rowEditingStopped=new W,this.bulkEditingStarted=new W,this.bulkEditingStopped=new W,this.batchEditingStarted=new W,this.batchEditingStopped=new W,this.undoStarted=new W,this.undoEnded=new W,this.redoStarted=new W,this.redoEnded=new W,this.cellSelectionDeleteStart=new W,this.cellSelectionDeleteEnd=new W,this.rangeDeleteStart=new W,this.rangeDeleteEnd=new W,this.fillStart=new W,this.fillEnd=new W,this.filterOpened=new W,this.filterChanged=new W,this.filterModified=new W,this.filterUiChanged=new W,this.floatingFilterUiChanged=new W,this.advancedFilterBuilderVisibleChanged=new W,this.findChanged=new W,this.chartCreated=new W,this.chartRangeSelectionChanged=new W,this.chartOptionsChanged=new W,this.chartDestroyed=new W,this.cellKeyDown=new W,this.gridReady=new W,this.firstDataRendered=new W,this.gridSizeChanged=new W,this.modelUpdated=new W,this.virtualRowRemoved=new W,this.viewportChanged=new W,this.bodyScroll=new W,this.bodyScrollEnd=new W,this.dragStarted=new W,this.dragStopped=new W,this.dragCancelled=new W,this.stateUpdated=new W,this.paginationChanged=new W,this.rowDragEnter=new W,this.rowDragMove=new W,this.rowDragLeave=new W,this.rowDragEnd=new W,this.rowDragCancel=new W,this.rowResizeStarted=new W,this.rowResizeEnded=new W,this.columnRowGroupChanged=new W,this.rowGroupOpened=new W,this.expandOrCollapseAll=new W,this.pivotMaxColumnsExceeded=new W,this.pinnedRowDataChanged=new W,this.pinnedRowsChanged=new W,this.rowDataUpdated=new W,this.asyncTransactionsFlushed=new W,this.storeRefreshed=new W,this.headerFocused=new W,this.cellClicked=new W,this.cellDoubleClicked=new W,this.cellFocused=new W,this.cellMouseOver=new W,this.cellMouseOut=new W,this.cellMouseDown=new W,this.rowClicked=new W,this.rowDoubleClicked=new W,this.rowSelected=new W,this.selectionChanged=new W,this.cellContextMenu=new W,this.rangeSelectionChanged=new W,this.cellSelectionChanged=new W,this.tooltipShow=new W,this.tooltipHide=new W,this.sortChanged=new W,this._nativeElement=n.nativeElement,this._fullyReady.then(()=>{this._holdEvents=!1})}ngAfterViewInit(){this._angularFrameworkOverrides.runOutsideAngular(()=>{this._frameworkCompWrapper.setViewContainerRef(this._viewContainerRef,this._angularFrameworkOverrides);let n=Object.keys(this).filter(l=>!(l.startsWith("_")||l=="gridOptions"||l=="modules"||this[l]instanceof W)),r={};for(let l of n){let c=Fle(l,this[l]);r[l]=c}let o=ZD(this.gridOptions,r,n),s={globalListener:this.globalListener.bind(this),frameworkOverrides:this._angularFrameworkOverrides,providedBeanInstances:{frameworkCompWrapper:this._frameworkCompWrapper},modules:this.modules||[],setThemeOnGridDiv:!0},a=q8(this._nativeElement,o,s);a&&(this.api=a),this._initialised=!0,this._resolveFullyReady()})}ngOnChanges(n){this._initialised&&this._angularFrameworkOverrides.runOutsideAngular(()=>{let r={};for(let o of Object.keys(n)){let s=n[o];r[o]=s.currentValue}eM(r,this.api)})}ngOnDestroy(){this._initialised&&(this._destroyed=!0,this.api?.destroy())}isEmitterUsed(n){let o=this[n],s=o?.observed??o?.observers?.length>0,a=`on${n.charAt(0).toUpperCase()}${n.substring(1)}`,l=!!this.gridOptions&&!!this.gridOptions[a];return s||l}globalListener(n,r){if(this._destroyed)return;let o=this[n];if(o&&this.isEmitterUsed(n)){let s=()=>this._angularFrameworkOverrides.runInsideAngular(()=>o.emit(r));this._holdEvents?this._fullyReady.then(()=>s()):s()}}};e.\u0275fac=function(r){return new(r||e)(Yc(Ai),Yc(Ka),Yc(_I),Yc(RI))},e.\u0275cmp=Ie({type:e,selectors:[["ag-grid-angular"]],inputs:{gridOptions:"gridOptions",modules:"modules",statusBar:"statusBar",sideBar:"sideBar",suppressContextMenu:[2,"suppressContextMenu","suppressContextMenu",O],preventDefaultOnContextMenu:[2,"preventDefaultOnContextMenu","preventDefaultOnContextMenu",O],allowContextMenuWithControlKey:[2,"allowContextMenuWithControlKey","allowContextMenuWithControlKey",O],columnMenu:"columnMenu",suppressMenuHide:[2,"suppressMenuHide","suppressMenuHide",O],enableBrowserTooltips:[2,"enableBrowserTooltips","enableBrowserTooltips",O],tooltipTrigger:"tooltipTrigger",tooltipShowDelay:"tooltipShowDelay",tooltipHideDelay:"tooltipHideDelay",tooltipMouseTrack:[2,"tooltipMouseTrack","tooltipMouseTrack",O],tooltipShowMode:"tooltipShowMode",tooltipInteraction:[2,"tooltipInteraction","tooltipInteraction",O],popupParent:"popupParent",copyHeadersToClipboard:[2,"copyHeadersToClipboard","copyHeadersToClipboard",O],copyGroupHeadersToClipboard:[2,"copyGroupHeadersToClipboard","copyGroupHeadersToClipboard",O],clipboardDelimiter:"clipboardDelimiter",suppressCopyRowsToClipboard:[2,"suppressCopyRowsToClipboard","suppressCopyRowsToClipboard",O],suppressCopySingleCellRanges:[2,"suppressCopySingleCellRanges","suppressCopySingleCellRanges",O],suppressLastEmptyLineOnPaste:[2,"suppressLastEmptyLineOnPaste","suppressLastEmptyLineOnPaste",O],suppressClipboardPaste:[2,"suppressClipboardPaste","suppressClipboardPaste",O],suppressClipboardApi:[2,"suppressClipboardApi","suppressClipboardApi",O],suppressCutToClipboard:[2,"suppressCutToClipboard","suppressCutToClipboard",O],columnDefs:"columnDefs",defaultColDef:"defaultColDef",defaultColGroupDef:"defaultColGroupDef",columnTypes:"columnTypes",dataTypeDefinitions:"dataTypeDefinitions",maintainColumnOrder:[2,"maintainColumnOrder","maintainColumnOrder",O],enableStrictPivotColumnOrder:[2,"enableStrictPivotColumnOrder","enableStrictPivotColumnOrder",O],suppressFieldDotNotation:[2,"suppressFieldDotNotation","suppressFieldDotNotation",O],headerHeight:"headerHeight",groupHeaderHeight:"groupHeaderHeight",floatingFiltersHeight:"floatingFiltersHeight",pivotHeaderHeight:"pivotHeaderHeight",pivotGroupHeaderHeight:"pivotGroupHeaderHeight",hidePaddedHeaderRows:[2,"hidePaddedHeaderRows","hidePaddedHeaderRows",O],allowDragFromColumnsToolPanel:[2,"allowDragFromColumnsToolPanel","allowDragFromColumnsToolPanel",O],suppressMovableColumns:[2,"suppressMovableColumns","suppressMovableColumns",O],suppressColumnMoveAnimation:[2,"suppressColumnMoveAnimation","suppressColumnMoveAnimation",O],suppressMoveWhenColumnDragging:[2,"suppressMoveWhenColumnDragging","suppressMoveWhenColumnDragging",O],suppressDragLeaveHidesColumns:[2,"suppressDragLeaveHidesColumns","suppressDragLeaveHidesColumns",O],suppressGroupChangesColumnVisibility:"suppressGroupChangesColumnVisibility",suppressMakeColumnVisibleAfterUnGroup:[2,"suppressMakeColumnVisibleAfterUnGroup","suppressMakeColumnVisibleAfterUnGroup",O],suppressRowGroupHidesColumns:[2,"suppressRowGroupHidesColumns","suppressRowGroupHidesColumns",O],colResizeDefault:"colResizeDefault",suppressAutoSize:[2,"suppressAutoSize","suppressAutoSize",O],autoSizePadding:"autoSizePadding",skipHeaderOnAutoSize:[2,"skipHeaderOnAutoSize","skipHeaderOnAutoSize",O],autoSizeStrategy:"autoSizeStrategy",components:"components",editType:"editType",suppressStartEditOnTab:[2,"suppressStartEditOnTab","suppressStartEditOnTab",O],getFullRowEditValidationErrors:"getFullRowEditValidationErrors",invalidEditValueMode:"invalidEditValueMode",singleClickEdit:[2,"singleClickEdit","singleClickEdit",O],suppressClickEdit:[2,"suppressClickEdit","suppressClickEdit",O],readOnlyEdit:[2,"readOnlyEdit","readOnlyEdit",O],stopEditingWhenCellsLoseFocus:[2,"stopEditingWhenCellsLoseFocus","stopEditingWhenCellsLoseFocus",O],enterNavigatesVertically:[2,"enterNavigatesVertically","enterNavigatesVertically",O],enterNavigatesVerticallyAfterEdit:[2,"enterNavigatesVerticallyAfterEdit","enterNavigatesVerticallyAfterEdit",O],enableCellEditingOnBackspace:[2,"enableCellEditingOnBackspace","enableCellEditingOnBackspace",O],undoRedoCellEditing:[2,"undoRedoCellEditing","undoRedoCellEditing",O],undoRedoCellEditingLimit:"undoRedoCellEditingLimit",defaultCsvExportParams:"defaultCsvExportParams",suppressCsvExport:[2,"suppressCsvExport","suppressCsvExport",O],defaultExcelExportParams:"defaultExcelExportParams",suppressExcelExport:[2,"suppressExcelExport","suppressExcelExport",O],excelStyles:"excelStyles",findSearchValue:"findSearchValue",findOptions:"findOptions",quickFilterText:"quickFilterText",cacheQuickFilter:[2,"cacheQuickFilter","cacheQuickFilter",O],includeHiddenColumnsInQuickFilter:[2,"includeHiddenColumnsInQuickFilter","includeHiddenColumnsInQuickFilter",O],quickFilterParser:"quickFilterParser",quickFilterMatcher:"quickFilterMatcher",applyQuickFilterBeforePivotOrAgg:[2,"applyQuickFilterBeforePivotOrAgg","applyQuickFilterBeforePivotOrAgg",O],excludeChildrenWhenTreeDataFiltering:[2,"excludeChildrenWhenTreeDataFiltering","excludeChildrenWhenTreeDataFiltering",O],enableAdvancedFilter:[2,"enableAdvancedFilter","enableAdvancedFilter",O],alwaysPassFilter:"alwaysPassFilter",includeHiddenColumnsInAdvancedFilter:[2,"includeHiddenColumnsInAdvancedFilter","includeHiddenColumnsInAdvancedFilter",O],advancedFilterParent:"advancedFilterParent",advancedFilterBuilderParams:"advancedFilterBuilderParams",advancedFilterParams:"advancedFilterParams",suppressAdvancedFilterEval:[2,"suppressAdvancedFilterEval","suppressAdvancedFilterEval",O],suppressSetFilterByDefault:[2,"suppressSetFilterByDefault","suppressSetFilterByDefault",O],enableFilterHandlers:[2,"enableFilterHandlers","enableFilterHandlers",O],filterHandlers:"filterHandlers",enableCharts:[2,"enableCharts","enableCharts",O],chartThemes:"chartThemes",customChartThemes:"customChartThemes",chartThemeOverrides:"chartThemeOverrides",chartToolPanelsDef:"chartToolPanelsDef",chartMenuItems:"chartMenuItems",loadingCellRenderer:"loadingCellRenderer",loadingCellRendererParams:"loadingCellRendererParams",loadingCellRendererSelector:"loadingCellRendererSelector",localeText:"localeText",masterDetail:[2,"masterDetail","masterDetail",O],keepDetailRows:[2,"keepDetailRows","keepDetailRows",O],keepDetailRowsCount:"keepDetailRowsCount",detailCellRenderer:"detailCellRenderer",detailCellRendererParams:"detailCellRendererParams",detailRowHeight:"detailRowHeight",detailRowAutoHeight:[2,"detailRowAutoHeight","detailRowAutoHeight",O],context:"context",alignedGrids:"alignedGrids",tabIndex:"tabIndex",rowBuffer:"rowBuffer",valueCache:[2,"valueCache","valueCache",O],valueCacheNeverExpires:[2,"valueCacheNeverExpires","valueCacheNeverExpires",O],enableCellExpressions:[2,"enableCellExpressions","enableCellExpressions",O],suppressTouch:[2,"suppressTouch","suppressTouch",O],suppressFocusAfterRefresh:[2,"suppressFocusAfterRefresh","suppressFocusAfterRefresh",O],suppressBrowserResizeObserver:[2,"suppressBrowserResizeObserver","suppressBrowserResizeObserver",O],suppressPropertyNamesCheck:[2,"suppressPropertyNamesCheck","suppressPropertyNamesCheck",O],suppressChangeDetection:[2,"suppressChangeDetection","suppressChangeDetection",O],debug:[2,"debug","debug",O],loading:[2,"loading","loading",O],overlayLoadingTemplate:"overlayLoadingTemplate",loadingOverlayComponent:"loadingOverlayComponent",loadingOverlayComponentParams:"loadingOverlayComponentParams",suppressLoadingOverlay:[2,"suppressLoadingOverlay","suppressLoadingOverlay",O],overlayNoRowsTemplate:"overlayNoRowsTemplate",noRowsOverlayComponent:"noRowsOverlayComponent",noRowsOverlayComponentParams:"noRowsOverlayComponentParams",suppressNoRowsOverlay:[2,"suppressNoRowsOverlay","suppressNoRowsOverlay",O],pagination:[2,"pagination","pagination",O],paginationPageSize:"paginationPageSize",paginationPageSizeSelector:"paginationPageSizeSelector",paginationAutoPageSize:[2,"paginationAutoPageSize","paginationAutoPageSize",O],paginateChildRows:[2,"paginateChildRows","paginateChildRows",O],suppressPaginationPanel:[2,"suppressPaginationPanel","suppressPaginationPanel",O],pivotMode:[2,"pivotMode","pivotMode",O],pivotPanelShow:"pivotPanelShow",pivotMaxGeneratedColumns:"pivotMaxGeneratedColumns",pivotDefaultExpanded:"pivotDefaultExpanded",pivotColumnGroupTotals:"pivotColumnGroupTotals",pivotRowTotals:"pivotRowTotals",pivotSuppressAutoColumn:[2,"pivotSuppressAutoColumn","pivotSuppressAutoColumn",O],suppressExpandablePivotGroups:[2,"suppressExpandablePivotGroups","suppressExpandablePivotGroups",O],functionsReadOnly:[2,"functionsReadOnly","functionsReadOnly",O],aggFuncs:"aggFuncs",suppressAggFuncInHeader:[2,"suppressAggFuncInHeader","suppressAggFuncInHeader",O],alwaysAggregateAtRootLevel:[2,"alwaysAggregateAtRootLevel","alwaysAggregateAtRootLevel",O],aggregateOnlyChangedColumns:[2,"aggregateOnlyChangedColumns","aggregateOnlyChangedColumns",O],suppressAggFilteredOnly:[2,"suppressAggFilteredOnly","suppressAggFilteredOnly",O],removePivotHeaderRowWhenSingleValueColumn:[2,"removePivotHeaderRowWhenSingleValueColumn","removePivotHeaderRowWhenSingleValueColumn",O],animateRows:[2,"animateRows","animateRows",O],cellFlashDuration:"cellFlashDuration",cellFadeDuration:"cellFadeDuration",allowShowChangeAfterFilter:[2,"allowShowChangeAfterFilter","allowShowChangeAfterFilter",O],domLayout:"domLayout",ensureDomOrder:[2,"ensureDomOrder","ensureDomOrder",O],enableCellSpan:[2,"enableCellSpan","enableCellSpan",O],enableRtl:[2,"enableRtl","enableRtl",O],suppressColumnVirtualisation:[2,"suppressColumnVirtualisation","suppressColumnVirtualisation",O],suppressMaxRenderedRowRestriction:[2,"suppressMaxRenderedRowRestriction","suppressMaxRenderedRowRestriction",O],suppressRowVirtualisation:[2,"suppressRowVirtualisation","suppressRowVirtualisation",O],rowDragManaged:[2,"rowDragManaged","rowDragManaged",O],rowDragInsertDelay:"rowDragInsertDelay",suppressRowDrag:[2,"suppressRowDrag","suppressRowDrag",O],suppressMoveWhenRowDragging:[2,"suppressMoveWhenRowDragging","suppressMoveWhenRowDragging",O],rowDragEntireRow:[2,"rowDragEntireRow","rowDragEntireRow",O],rowDragMultiRow:[2,"rowDragMultiRow","rowDragMultiRow",O],rowDragText:"rowDragText",dragAndDropImageComponent:"dragAndDropImageComponent",dragAndDropImageComponentParams:"dragAndDropImageComponentParams",fullWidthCellRenderer:"fullWidthCellRenderer",fullWidthCellRendererParams:"fullWidthCellRendererParams",embedFullWidthRows:[2,"embedFullWidthRows","embedFullWidthRows",O],groupDisplayType:"groupDisplayType",groupDefaultExpanded:"groupDefaultExpanded",autoGroupColumnDef:"autoGroupColumnDef",groupMaintainOrder:[2,"groupMaintainOrder","groupMaintainOrder",O],groupSelectsChildren:[2,"groupSelectsChildren","groupSelectsChildren",O],groupLockGroupColumns:"groupLockGroupColumns",groupAggFiltering:"groupAggFiltering",groupTotalRow:"groupTotalRow",grandTotalRow:"grandTotalRow",suppressStickyTotalRow:"suppressStickyTotalRow",groupSuppressBlankHeader:[2,"groupSuppressBlankHeader","groupSuppressBlankHeader",O],groupSelectsFiltered:[2,"groupSelectsFiltered","groupSelectsFiltered",O],showOpenedGroup:[2,"showOpenedGroup","showOpenedGroup",O],groupHideParentOfSingleChild:"groupHideParentOfSingleChild",groupRemoveSingleChildren:[2,"groupRemoveSingleChildren","groupRemoveSingleChildren",O],groupRemoveLowestSingleChildren:[2,"groupRemoveLowestSingleChildren","groupRemoveLowestSingleChildren",O],groupHideOpenParents:[2,"groupHideOpenParents","groupHideOpenParents",O],groupAllowUnbalanced:[2,"groupAllowUnbalanced","groupAllowUnbalanced",O],rowGroupPanelShow:"rowGroupPanelShow",groupRowRenderer:"groupRowRenderer",groupRowRendererParams:"groupRowRendererParams",treeData:[2,"treeData","treeData",O],treeDataChildrenField:"treeDataChildrenField",treeDataParentIdField:"treeDataParentIdField",rowGroupPanelSuppressSort:[2,"rowGroupPanelSuppressSort","rowGroupPanelSuppressSort",O],suppressGroupRowsSticky:[2,"suppressGroupRowsSticky","suppressGroupRowsSticky",O],groupHierarchyConfig:"groupHierarchyConfig",pinnedTopRowData:"pinnedTopRowData",pinnedBottomRowData:"pinnedBottomRowData",enableRowPinning:"enableRowPinning",isRowPinnable:"isRowPinnable",isRowPinned:"isRowPinned",rowModelType:"rowModelType",rowData:"rowData",asyncTransactionWaitMillis:"asyncTransactionWaitMillis",suppressModelUpdateAfterUpdateTransaction:[2,"suppressModelUpdateAfterUpdateTransaction","suppressModelUpdateAfterUpdateTransaction",O],datasource:"datasource",cacheOverflowSize:"cacheOverflowSize",infiniteInitialRowCount:"infiniteInitialRowCount",serverSideInitialRowCount:"serverSideInitialRowCount",suppressServerSideFullWidthLoadingRow:[2,"suppressServerSideFullWidthLoadingRow","suppressServerSideFullWidthLoadingRow",O],cacheBlockSize:"cacheBlockSize",maxBlocksInCache:"maxBlocksInCache",maxConcurrentDatasourceRequests:"maxConcurrentDatasourceRequests",blockLoadDebounceMillis:"blockLoadDebounceMillis",purgeClosedRowNodes:[2,"purgeClosedRowNodes","purgeClosedRowNodes",O],serverSideDatasource:"serverSideDatasource",serverSideSortAllLevels:[2,"serverSideSortAllLevels","serverSideSortAllLevels",O],serverSideEnableClientSideSort:[2,"serverSideEnableClientSideSort","serverSideEnableClientSideSort",O],serverSideOnlyRefreshFilteredGroups:[2,"serverSideOnlyRefreshFilteredGroups","serverSideOnlyRefreshFilteredGroups",O],serverSidePivotResultFieldSeparator:"serverSidePivotResultFieldSeparator",viewportDatasource:"viewportDatasource",viewportRowModelPageSize:"viewportRowModelPageSize",viewportRowModelBufferSize:"viewportRowModelBufferSize",alwaysShowHorizontalScroll:[2,"alwaysShowHorizontalScroll","alwaysShowHorizontalScroll",O],alwaysShowVerticalScroll:[2,"alwaysShowVerticalScroll","alwaysShowVerticalScroll",O],debounceVerticalScrollbar:[2,"debounceVerticalScrollbar","debounceVerticalScrollbar",O],suppressHorizontalScroll:[2,"suppressHorizontalScroll","suppressHorizontalScroll",O],suppressScrollOnNewData:[2,"suppressScrollOnNewData","suppressScrollOnNewData",O],suppressScrollWhenPopupsAreOpen:[2,"suppressScrollWhenPopupsAreOpen","suppressScrollWhenPopupsAreOpen",O],suppressAnimationFrame:[2,"suppressAnimationFrame","suppressAnimationFrame",O],suppressMiddleClickScrolls:[2,"suppressMiddleClickScrolls","suppressMiddleClickScrolls",O],suppressPreventDefaultOnMouseWheel:[2,"suppressPreventDefaultOnMouseWheel","suppressPreventDefaultOnMouseWheel",O],scrollbarWidth:"scrollbarWidth",rowSelection:"rowSelection",cellSelection:"cellSelection",rowMultiSelectWithClick:[2,"rowMultiSelectWithClick","rowMultiSelectWithClick",O],suppressRowDeselection:[2,"suppressRowDeselection","suppressRowDeselection",O],suppressRowClickSelection:[2,"suppressRowClickSelection","suppressRowClickSelection",O],suppressCellFocus:[2,"suppressCellFocus","suppressCellFocus",O],suppressHeaderFocus:[2,"suppressHeaderFocus","suppressHeaderFocus",O],selectionColumnDef:"selectionColumnDef",rowNumbers:"rowNumbers",suppressMultiRangeSelection:[2,"suppressMultiRangeSelection","suppressMultiRangeSelection",O],enableCellTextSelection:[2,"enableCellTextSelection","enableCellTextSelection",O],enableRangeSelection:[2,"enableRangeSelection","enableRangeSelection",O],enableRangeHandle:[2,"enableRangeHandle","enableRangeHandle",O],enableFillHandle:[2,"enableFillHandle","enableFillHandle",O],fillHandleDirection:"fillHandleDirection",suppressClearOnFillReduction:[2,"suppressClearOnFillReduction","suppressClearOnFillReduction",O],sortingOrder:"sortingOrder",accentedSort:[2,"accentedSort","accentedSort",O],unSortIcon:[2,"unSortIcon","unSortIcon",O],suppressMultiSort:[2,"suppressMultiSort","suppressMultiSort",O],alwaysMultiSort:[2,"alwaysMultiSort","alwaysMultiSort",O],multiSortKey:"multiSortKey",suppressMaintainUnsortedOrder:[2,"suppressMaintainUnsortedOrder","suppressMaintainUnsortedOrder",O],icons:"icons",rowHeight:"rowHeight",rowStyle:"rowStyle",rowClass:"rowClass",rowClassRules:"rowClassRules",suppressRowHoverHighlight:[2,"suppressRowHoverHighlight","suppressRowHoverHighlight",O],suppressRowTransform:[2,"suppressRowTransform","suppressRowTransform",O],columnHoverHighlight:[2,"columnHoverHighlight","columnHoverHighlight",O],gridId:"gridId",deltaSort:[2,"deltaSort","deltaSort",O],treeDataDisplayType:"treeDataDisplayType",enableGroupEdit:[2,"enableGroupEdit","enableGroupEdit",O],initialState:"initialState",theme:"theme",loadThemeGoogleFonts:[2,"loadThemeGoogleFonts","loadThemeGoogleFonts",O],themeCssLayer:"themeCssLayer",styleNonce:"styleNonce",themeStyleContainer:"themeStyleContainer",getContextMenuItems:"getContextMenuItems",getMainMenuItems:"getMainMenuItems",postProcessPopup:"postProcessPopup",processUnpinnedColumns:"processUnpinnedColumns",processCellForClipboard:"processCellForClipboard",processHeaderForClipboard:"processHeaderForClipboard",processGroupHeaderForClipboard:"processGroupHeaderForClipboard",processCellFromClipboard:"processCellFromClipboard",sendToClipboard:"sendToClipboard",processDataFromClipboard:"processDataFromClipboard",isExternalFilterPresent:"isExternalFilterPresent",doesExternalFilterPass:"doesExternalFilterPass",getChartToolbarItems:"getChartToolbarItems",createChartContainer:"createChartContainer",focusGridInnerElement:"focusGridInnerElement",navigateToNextHeader:"navigateToNextHeader",tabToNextHeader:"tabToNextHeader",navigateToNextCell:"navigateToNextCell",tabToNextCell:"tabToNextCell",getLocaleText:"getLocaleText",getDocument:"getDocument",paginationNumberFormatter:"paginationNumberFormatter",getGroupRowAgg:"getGroupRowAgg",isGroupOpenByDefault:"isGroupOpenByDefault",ssrmExpandAllAffectsAllRows:[2,"ssrmExpandAllAffectsAllRows","ssrmExpandAllAffectsAllRows",O],initialGroupOrderComparator:"initialGroupOrderComparator",processPivotResultColDef:"processPivotResultColDef",processPivotResultColGroupDef:"processPivotResultColGroupDef",getDataPath:"getDataPath",getChildCount:"getChildCount",getServerSideGroupLevelParams:"getServerSideGroupLevelParams",isServerSideGroupOpenByDefault:"isServerSideGroupOpenByDefault",isApplyServerSideTransaction:"isApplyServerSideTransaction",isServerSideGroup:"isServerSideGroup",getServerSideGroupKey:"getServerSideGroupKey",getBusinessKeyForNode:"getBusinessKeyForNode",getRowId:"getRowId",resetRowDataOnUpdate:[2,"resetRowDataOnUpdate","resetRowDataOnUpdate",O],processRowPostCreate:"processRowPostCreate",isRowSelectable:"isRowSelectable",isRowMaster:"isRowMaster",fillOperation:"fillOperation",postSortRows:"postSortRows",getRowStyle:"getRowStyle",getRowClass:"getRowClass",getRowHeight:"getRowHeight",isFullWidthRow:"isFullWidthRow",isRowValidDropPosition:"isRowValidDropPosition"},outputs:{toolPanelVisibleChanged:"toolPanelVisibleChanged",toolPanelSizeChanged:"toolPanelSizeChanged",columnMenuVisibleChanged:"columnMenuVisibleChanged",contextMenuVisibleChanged:"contextMenuVisibleChanged",cutStart:"cutStart",cutEnd:"cutEnd",pasteStart:"pasteStart",pasteEnd:"pasteEnd",columnVisible:"columnVisible",columnPinned:"columnPinned",columnResized:"columnResized",columnMoved:"columnMoved",columnValueChanged:"columnValueChanged",columnPivotModeChanged:"columnPivotModeChanged",columnPivotChanged:"columnPivotChanged",columnGroupOpened:"columnGroupOpened",newColumnsLoaded:"newColumnsLoaded",gridColumnsChanged:"gridColumnsChanged",displayedColumnsChanged:"displayedColumnsChanged",virtualColumnsChanged:"virtualColumnsChanged",columnEverythingChanged:"columnEverythingChanged",columnsReset:"columnsReset",columnHeaderMouseOver:"columnHeaderMouseOver",columnHeaderMouseLeave:"columnHeaderMouseLeave",columnHeaderClicked:"columnHeaderClicked",columnHeaderContextMenu:"columnHeaderContextMenu",componentStateChanged:"componentStateChanged",cellValueChanged:"cellValueChanged",cellEditRequest:"cellEditRequest",rowValueChanged:"rowValueChanged",cellEditingStarted:"cellEditingStarted",cellEditingStopped:"cellEditingStopped",rowEditingStarted:"rowEditingStarted",rowEditingStopped:"rowEditingStopped",bulkEditingStarted:"bulkEditingStarted",bulkEditingStopped:"bulkEditingStopped",batchEditingStarted:"batchEditingStarted",batchEditingStopped:"batchEditingStopped",undoStarted:"undoStarted",undoEnded:"undoEnded",redoStarted:"redoStarted",redoEnded:"redoEnded",cellSelectionDeleteStart:"cellSelectionDeleteStart",cellSelectionDeleteEnd:"cellSelectionDeleteEnd",rangeDeleteStart:"rangeDeleteStart",rangeDeleteEnd:"rangeDeleteEnd",fillStart:"fillStart",fillEnd:"fillEnd",filterOpened:"filterOpened",filterChanged:"filterChanged",filterModified:"filterModified",filterUiChanged:"filterUiChanged",floatingFilterUiChanged:"floatingFilterUiChanged",advancedFilterBuilderVisibleChanged:"advancedFilterBuilderVisibleChanged",findChanged:"findChanged",chartCreated:"chartCreated",chartRangeSelectionChanged:"chartRangeSelectionChanged",chartOptionsChanged:"chartOptionsChanged",chartDestroyed:"chartDestroyed",cellKeyDown:"cellKeyDown",gridReady:"gridReady",firstDataRendered:"firstDataRendered",gridSizeChanged:"gridSizeChanged",modelUpdated:"modelUpdated",virtualRowRemoved:"virtualRowRemoved",viewportChanged:"viewportChanged",bodyScroll:"bodyScroll",bodyScrollEnd:"bodyScrollEnd",dragStarted:"dragStarted",dragStopped:"dragStopped",dragCancelled:"dragCancelled",stateUpdated:"stateUpdated",paginationChanged:"paginationChanged",rowDragEnter:"rowDragEnter",rowDragMove:"rowDragMove",rowDragLeave:"rowDragLeave",rowDragEnd:"rowDragEnd",rowDragCancel:"rowDragCancel",rowResizeStarted:"rowResizeStarted",rowResizeEnded:"rowResizeEnded",columnRowGroupChanged:"columnRowGroupChanged",rowGroupOpened:"rowGroupOpened",expandOrCollapseAll:"expandOrCollapseAll",pivotMaxColumnsExceeded:"pivotMaxColumnsExceeded",pinnedRowDataChanged:"pinnedRowDataChanged",pinnedRowsChanged:"pinnedRowsChanged",rowDataUpdated:"rowDataUpdated",asyncTransactionsFlushed:"asyncTransactionsFlushed",storeRefreshed:"storeRefreshed",headerFocused:"headerFocused",cellClicked:"cellClicked",cellDoubleClicked:"cellDoubleClicked",cellFocused:"cellFocused",cellMouseOver:"cellMouseOver",cellMouseOut:"cellMouseOut",cellMouseDown:"cellMouseDown",rowClicked:"rowClicked",rowDoubleClicked:"rowDoubleClicked",rowSelected:"rowSelected",selectionChanged:"selectionChanged",cellContextMenu:"cellContextMenu",rangeSelectionChanged:"rangeSelectionChanged",cellSelectionChanged:"cellSelectionChanged",tooltipShow:"tooltipShow",tooltipHide:"tooltipHide",sortChanged:"sortChanged"},features:[Xe([_I,RI]),lp],decls:0,vars:0,template:function(r,o){},encapsulation:2});let t=e;return t})(),kle=new Set(r2);function Fle(t,e){return kle.has(t)?e===""?!0:e==="false"?!1:e:e}function Tle(t,e){if(t&1){let i=je();D(0,"button",2),te("click",function(){let r=ie(i).$implicit,o=X();return ne(o.onActionClick(r))}),ee(1,"ng-icon",3),F()}if(t&2){let i=e.$implicit;de("variant",i.variant||"ghost"),M(),de("name",i.icon)}}var Na=(()=>{class t{actions=[];data;agInit(i){this.actions=i.actions||[],this.data=i.data}refresh(i){return this.actions=i.actions||[],this.data=i.data,!0}onActionClick(i){i.action(this.data)}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=Ie({type:t,selectors:[["gh-ag-grid-actions-cell"]],decls:3,vars:0,consts:[[1,"flex","gap-2","h-full","items-center"],["hlmBtn","","size","icon",3,"variant"],["hlmBtn","","size","icon",3,"click","variant"],["hlm","","size","sm",3,"name"]],template:function(n,r){n&1&&(D(0,"div",0),Vn(1,Tle,2,2,"button",1,cp),F()),n&2&&(M(),Gn(r.actions))},dependencies:[_t,wi,Ci],encapsulation:2,changeDetection:0})}return t})();var Hr=class{supabaseGlobal=Z(ol);supabase=this.supabaseGlobal.supabase;loadingCount=ve(0);loading=Fe(()=>this.loadingCount()>0);flexibleItems=jn({loader:async()=>{let{data:e,error:i}=await this.supabase.from("flexible_items").select("*").order("created_at",{ascending:!1});if(i)throw i;return e||[]}});createItem(e){this.loadingCount.update(i=>i+1),$e(this.supabase.from("flexible_items").insert({name:e.name,description:e.description||null,user_defined_properties:e.user_defined_properties||{}}).select().single()).pipe(rt(i=>Ye({error:i})),Qe(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.flexibleItems.reload()})}updateItem(e,i){this.loadingCount.update(n=>n+1),$e(this.supabase.from("flexible_items").update(i).eq("id",e).select().single()).pipe(rt(n=>Ye({error:n})),Qe(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error)throw n.error;this.flexibleItems.reload()})}deleteItem(e){this.loadingCount.update(i=>i+1),$e(this.supabase.from("flexible_items").delete().eq("id",e)).pipe(rt(i=>Ye({error:i})),Qe(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.flexibleItems.reload()})}deleteItems(e){this.loadingCount.update(i=>i+1),$e(this.supabase.from("flexible_items").delete().in("id",e)).pipe(rt(i=>Ye({error:i})),Qe(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.flexibleItems.reload()})}addItemToHousePlan(e,i){this.loadingCount.update(n=>n+1),$e(this.supabase.from("house_plan_items").insert({house_plan_id:e.house_plan_id,flexible_item_id:e.flexible_item_id,position_x:e.position_x||0,position_y:e.position_y||0,rotation:e.rotation||0,scale:e.scale||1}).select().single()).pipe(rt(n=>Ye({error:n})),Qe(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error)throw n.error;n?.data?i?.(n.data):i?.({id:"",house_plan_id:e.house_plan_id,flexible_item_id:e.flexible_item_id,position_x:e.position_x||0,position_y:e.position_y||0,rotation:e.rotation||0,scale:e.scale||1,created_at:""})})}updateHousePlanItem(e,i){this.loadingCount.update(n=>n+1),$e(this.supabase.from("house_plan_items").update(i).eq("id",e).select().single()).pipe(rt(n=>Ye({error:n})),Qe(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error)throw n.error})}removeItemFromHousePlan(e){this.loadingCount.update(i=>i+1),$e(this.supabase.from("house_plan_items").delete().eq("id",e)).pipe(rt(i=>Ye({error:i})),Qe(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error})}getHousePlanItemsResource(e){return jn({params:()=>({planId:e}),loader:async({params:i})=>{let{data:n,error:r}=await this.supabase.from("house_plan_items").select(`
            *,
            item:flexible_item_id (*)
          `).eq("house_plan_id",i.planId);if(r)throw r;return n||[]}})}};var Y7=nt(K7(),1),X7=nt(Hh(),1),b3=nt(p0(),1),w3=nt($t(),1),J7=nt(i3(),1),Q7=nt(L2(),1);var Z7=["*"];function y3(t){let e=t.getLayer()||t.getStage();e&&e.batchDraw()}function eO(t,e={},i={}){"id"in e&&console.warn('ng2-konva: You are using "id" attribute for Konva node. In some very rare cases it may produce bugs. Currently we recommend not to use it and use "name" attribute instead.');let n=t.getStage(),r={},o=!1;if(Object.keys(i).forEach(s=>{let a=s.slice(0,2)==="on",l=i[s]!==e[s];if(a&&l){let d=s.slice(2).toLowerCase();d.slice(0,7)==="content"&&(d="content"+d.slice(7,8).toUpperCase()+d.slice(8)),n.off(d,i[s])}!Object.hasOwn(e,s)&&n.setAttr(s,void 0)}),Object.keys(e).forEach(s=>{let a=s.slice(0,2)==="on",l=i[s]!==e[s];if(a&&l){let c=s.slice(2).toLowerCase();c.slice(0,7)==="content"&&(c="content"+c.slice(7,8).toUpperCase()+c.slice(8)),e[s]&&(n.off(c),n.on(c,d=>{e[s]({angularComponent:t,event:d})}))}!a&&(e[s]!==i[s]||e[s]!==n.getAttr(s))&&(o=!0,r[s]=e[s])}),o){n.setAttrs(r),y3(n);let s;Object.keys(r).forEach(a=>{if(s=r[a],s instanceof Image&&!s.complete){let l=n;s.addEventListener("load",function(){let c=l.getLayer();c&&c.batchDraw()})}})}}function Tpe(t){return t.replace(/^\w|[A-Z]|\b\w/g,function(e,i){return i==0?e.toLowerCase():e.toUpperCase()}).replace(/\s+/g,"")}function Dpe(t){return t.charAt(0).toUpperCase()+t.slice(1)}function Mpe(t){return Dpe(Tpe(t.slice(3).replace("-"," ")))}function tO(t){let e={};return["mouseover","mousemove","mouseout","mouseenter","mouseleave","mousedown","mouseup","wheel","contextmenu","click","dblclick","touchstart","touchmove","touchend","tap","dbltap","dragstart","dragmove","dragend","transformstart","transform","transformend"].forEach(i=>{let r=t[i];r.listeners?.length>0&&(e["on"+i]=r.emit.bind(r))}),e}var fv=(()=>{class t{shapes=Hv(t);config=nd();#e=pt(()=>{let i=this.config();i&&this.uploadKonva(i)});mouseover=ue();mousemove=ue();mouseout=ue();mouseenter=ue();mouseleave=ue();mousedown=ue();mouseup=ue();wheel=ue();contextmenu=ue();click=ue();dblclick=ue();touchstart=ue();touchmove=ue();touchend=ue();tap=ue();dbltap=ue();dragstart=ue();dragmove=ue();dragend=ue();transformstart=ue();transform=ue();transformend=ue();nameNode=Mpe(Z(Ai).nativeElement.localName);cacheProps={};_stage;getStage(){return this._stage}getNode(){return this._stage}getConfig(){return this.config()||{}}constructor(){this.initKonva()}initKonva(){this._stage||(this._stage=new w3.Shape),this.nameNode==="Shape"?this._stage=new w3.Shape:this.nameNode==="Sprite"?this._stage=new J7.Sprite(this.config()):this._stage=new Y7.default[this.nameNode](void 0);let i=this._stage.to.bind(this._stage);this._stage.to=r=>{i(r),setTimeout(()=>{Object.keys(this._stage.attrs).forEach(o=>{typeof this._stage.attrs[o]!="function"&&this.config()&&this.config.update(s=>k(w({},s),{[o]:this._stage.attrs[o]}))})},200)};let n=this.config();n&&this.uploadKonva(n)}uploadKonva(i){if(!this._stage)return;let n=w(w({},i),tO(this));eO(this,n,this.cacheProps),this.cacheProps=n}#t=pt(()=>{this.shapes().forEach((i,n)=>{this!==i&&((this._stage instanceof X7.Group||this._stage instanceof b3.Layer)&&this._stage.add(i.getStage()),i.getStage().zIndex(n),y3(this._stage))})});ngOnDestroy(){this._stage.destroy()}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=Ie({type:t,selectors:[["ko-shape"],["ko-layer"],["ko-circle"],["ko-fastlayer"],["ko-group"],["ko-label"],["ko-rect"],["ko-ellipse"],["ko-wedge"],["ko-line"],["ko-sprite"],["ko-image"],["ko-text"],["ko-text-path"],["ko-star"],["ko-ring"],["ko-arc"],["ko-tag"],["ko-path"],["ko-regular-polygon"],["ko-arrow"],["ko-transformer"]],contentQueries:function(n,r,o){n&1&&up(o,r.shapes,t,4),n&2&&ed()},inputs:{config:[1,"config"]},outputs:{config:"configChange",mouseover:"mouseover",mousemove:"mousemove",mouseout:"mouseout",mouseenter:"mouseenter",mouseleave:"mouseleave",mousedown:"mousedown",mouseup:"mouseup",wheel:"wheel",contextmenu:"contextmenu",click:"click",dblclick:"dblclick",touchstart:"touchstart",touchmove:"touchmove",touchend:"touchend",tap:"tap",dbltap:"dbltap",dragstart:"dragstart",dragmove:"dragmove",dragend:"dragend",transformstart:"transformstart",transform:"transform",transformend:"transformend"},ngContentSelectors:Z7,decls:2,vars:0,template:function(n,r){n&1&&(Qc(),Xa(0,"div"),Zc(1),Jc())},encapsulation:2})}return t})(),iO=(()=>{class t{nodeContainer=Z(Ai).nativeElement;shapes=Hv(fv);config=Re();#e=pt(()=>{let i=this.config();i&&(this._stage?this.uploadKonva(i):(this._stage=new Q7.Stage(k(w({},i),{container:this.nodeContainer})),this.uploadKonva(i)))});mouseover=ue();mousemove=ue();mouseout=ue();mouseenter=ue();mouseleave=ue();mousedown=ue();mouseup=ue();wheel=ue();contextmenu=ue();click=ue();dblclick=ue();touchstart=ue();touchmove=ue();touchend=ue();tap=ue();dbltap=ue();dragstart=ue();dragmove=ue();dragend=ue();transformstart=ue();transform=ue();transformend=ue();_stage;cacheProps={};getStage(){return this._stage}getNode(){return this._stage}getConfig(){return this.config()||{}}uploadKonva(i){let n=w(w({},i),tO(this));eO(this,n,this.cacheProps),this.cacheProps=n}#t=pt(()=>{this.shapes().forEach((i,n)=>{if(!(i.getStage()instanceof b3.Layer))throw"You can only add Layer Nodes to Stage Nodes!";this._stage.add(i.getStage()),i.getStage().zIndex(n),y3(this._stage)})});ngOnDestroy(){this._stage.destroy()}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=Ie({type:t,selectors:[["ko-stage"]],contentQueries:function(n,r,o){n&1&&up(o,r.shapes,fv,4),n&2&&ed()},inputs:{config:[1,"config"]},outputs:{mouseover:"mouseover",mousemove:"mousemove",mouseout:"mouseout",mouseenter:"mouseenter",mouseleave:"mouseleave",mousedown:"mousedown",mouseup:"mouseup",wheel:"wheel",contextmenu:"contextmenu",click:"click",dblclick:"dblclick",touchstart:"touchstart",touchmove:"touchmove",touchend:"touchend",tap:"tap",dbltap:"dbltap",dragstart:"dragstart",dragmove:"dragmove",dragend:"dragend",transformstart:"transformstart",transform:"transform",transformend:"transformend"},ngContentSelectors:Z7,decls:2,vars:0,template:function(n,r){n&1&&(Qc(),Xa(0,"div"),Zc(1),Jc())},encapsulation:2})}return t})();var Ipe=()=>[10,5],Ape=(t,e)=>({points:t,stroke:"#3b82f6",strokeWidth:4,lineCap:"round",lineJoin:"round",dash:e}),Ope=(t,e,i)=>({x:t,y:e,listening:!0,name:i}),Lpe=(t,e,i,n)=>({width:36,height:36,offsetX:18,offsetY:18,cornerRadius:8,fill:t,stroke:e,strokeWidth:i,opacity:n}),Npe=(t,e)=>({text:t,fontSize:12,fill:"#111827",width:80,align:"center",offsetX:40,offsetY:e}),Bpe=t=>({image:t,width:20,height:20,offsetX:10,offsetY:10}),Hpe=(t,e)=>e.name,zpe=(t,e)=>e.id;function Vpe(t,e){if(t&1&&ee(0,"ko-line",2),t&2){let i=e.$implicit;de("config",i)}}function Gpe(t,e){if(t&1){let i=je();D(0,"ko-line",3),te("click",function(){let r=ie(i).$implicit,o=X();return ne(o.onWallClick(r.name))})("mouseenter",function(){let r=ie(i).$implicit,o=X();return ne(o.onWallMouseEnter(r.name))})("mouseleave",function(){ie(i);let r=X();return ne(r.onWallMouseLeave())}),F()}if(t&2){let i=e.$implicit;de("config",i)}}function Wpe(t,e){if(t&1&&ee(0,"ko-line",2),t&2){let i=X();de("config",Nv(2,Ape,i.tempLine(),hp(1,Ipe)))}}function Upe(t,e){if(t&1&&ee(0,"ko-image",2),t&2){let i=X().$implicit;de("config",id(1,Bpe,i.iconImage))}}function jpe(t,e){if(t&1){let i=je();D(0,"ko-group",3),te("click",function(){let r=ie(i).$implicit,o=X();return ne(o.onItemClick(r.id))})("mouseenter",function(){let r=ie(i).$implicit,o=X();return ne(o.onItemMouseEnter(r.id))})("mouseleave",function(){ie(i);let r=X();return ne(r.onItemMouseLeave())}),ee(1,"ko-rect",2),ze(2,Upe,1,3,"ko-image",2),ee(3,"ko-text",2),F()}if(t&2){let i=e.$implicit,n=X();de("config",gx(4,Ope,i.x,i.y,i.konvaName)),M(),de("config",mx(8,Lpe,n.selectedItemId()===i.id?"#fb923c":"#fbbf24",n.selectedItemId()===i.id?"#c2410c":n.hoveredItemId()===i.id?"#f97316":"#92400e",n.selectedItemId()===i.id?3:2,n.selectedItemId()===i.id?1:.9)),M(),Ve(i.iconImage?2:-1),M(),de("config",Nv(13,Npe,i.name,-24))}}var gv=class t{static ITEM_SIZE=36;static ITEM_RADIUS=t.ITEM_SIZE/2;canvasWidth=Re(1600);canvasHeight=Re(1200);gridSize=Re(20);drawingMode=Re("select");zoom=Re(1);stagePosition=Re({x:0,y:0});items=nd.required();activeFlexibleItemId=Re(null);walls=nd.required();wallClicked=ue();wallMouseEnter=ue();wallMouseLeave=ue();zoomChanged=ue();stagePositionChanged=ue();wallCreated=ue();wallMoved=ue();wallDeleted=ue();itemClicked=ue();itemMoved=ue();itemDeleted=ue();itemPlaced=ue();selectedWallId=ve(null);hoveredWallId=ve(null);selectedItemId=ve(null);hoveredItemId=ve(null);isDrawing=ve(!1);tempLine=ve(null);isDragging=ve(!1);draggedWallId=ve(null);dragStartPos=ve(null);draggedWallInitialCoords=ve(null);isItemDragging=ve(!1);draggedItemId=ve(null);itemDragStartPos=ve(null);draggedItemInitialPos=ve(null);isPanning=ve(!1);panStartPos=ve(null);panInitialStagePos=ve(null);iconCache=new Map;iconLoadingSignal=ve(0);gridLines=Fe(()=>{let e=[],i=this.canvasWidth(),n=this.canvasHeight(),r=this.gridSize();for(let o=0;o<=i;o+=r)e.push({points:[o,0,o,n],stroke:"#e5e7eb",strokeWidth:o%(r*5)===0?1.5:.5});for(let o=0;o<=n;o+=r)e.push({points:[0,o,i,o],stroke:"#e5e7eb",strokeWidth:o%(r*5)===0?1.5:.5});return e});wallLines=Fe(()=>{let e=this.hoveredWallId(),i=this.selectedWallId(),n=this.draggedWallId();return this.walls().map(r=>{let o=r.color,s=1;return r.id===n?(o="#10b981",s=.7):r.id===i?o="#3b82f6":r.id===e&&(o="#6366f1"),{name:r.id,points:[r.start_x,r.start_y,r.end_x,r.end_y],stroke:o,strokeWidth:4,opacity:s,hitStrokeWidth:20,lineCap:"round",lineJoin:"round",listening:!0}})});itemShapes=Fe(()=>(this.iconLoadingSignal(),(this.items()||[]).map(e=>({id:e.id,konvaName:e.id,name:e.item?.name||"Item",icon:e.item?.icon||null,iconImage:e.item?.icon?this.getIconImage(e.item.icon):null,x:e.position_x??0,y:e.position_y??0}))));constructor(){pt(()=>{this.items().forEach(i=>{i.item?.icon&&this.loadIconImage(i.item.icon)})})}stageConfig=Fe(()=>({width:this.canvasWidth(),height:this.canvasHeight(),scaleX:this.zoom(),scaleY:this.zoom(),x:this.stagePosition().x,y:this.stagePosition().y}));cursorStyle=Fe(()=>this.isPanning()?"grabbing":this.drawingMode()==="draw"?"crosshair":this.drawingMode()==="add-item"?this.activeFlexibleItemId()?"copy":"not-allowed":this.drawingMode()==="delete"?"not-allowed":this.drawingMode()==="move"?this.isItemDragging()||this.isDragging()?"grabbing":"grab":"default");onStageMouseDown(e){let i=e?.event?.target?.getStage();if(!i)return;let n=i.getPointerPosition();if(!n)return;let r=e.event.evt;if(r.button===1||r.button===0&&r.ctrlKey){this.isPanning.set(!0),this.panStartPos.set({x:r.clientX,y:r.clientY}),this.panInitialStagePos.set(w({},this.stagePosition()));return}let o=this.getCanvasPosition(n),s=this.getItemAtPosition(o),a=this.getWallAtPosition(o);switch(this.drawingMode()){case"draw":{if(this.isDrawing()){let l=this.tempLine();l&&this.wallCreated.emit({start_x:l[0],start_y:l[1],end_x:l[2],end_y:l[3]}),this.isDrawing.set(!1),this.tempLine.set(null)}else{this.isDrawing.set(!0);let l=this.snapToGrid(o);this.tempLine.set([l.x,l.y,l.x,l.y])}break}case"add-item":{if(!this.activeFlexibleItemId())return;let l=this.snapToGrid(o);this.itemPlaced.emit({x:l.x,y:l.y});break}case"move":{if(s){this.startItemDrag(s,o);break}a&&(this.isDragging.set(!0),this.draggedWallId.set(a.id),this.dragStartPos.set({x:o.x,y:o.y}),this.draggedWallInitialCoords.set(a));break}case"delete":{if(s){this.items.update(l=>l.filter(c=>c.id!==s.id)),this.selectedItemId.set(null),this.itemDeleted.emit(s.id);break}a&&(this.walls.update(l=>l.filter(c=>c.id!==a.id)),this.selectedWallId.set(null),this.wallDeleted.emit(a.id));break}case"select":break}}onStageMouseMove(e){let i=e?.event?.target?.getStage();if(!i)return;let n=i.getPointerPosition();if(!n)return;let r=e.event.evt;if(this.isPanning()){let o=this.panStartPos(),s=this.panInitialStagePos();if(o&&s){let a=r.clientX-o.x,l=r.clientY-o.y;this.stagePositionChanged.emit({x:s.x+a,y:s.y+l})}return}if(this.drawingMode()==="draw"&&this.isDrawing()){let o=this.getCanvasPosition(n),s=this.snapToGrid(o),a=this.tempLine();a&&this.tempLine.set([a[0],a[1],s.x,s.y])}else if(this.drawingMode()==="move"){if(this.isItemDragging()){this.applyItemDragMovement(n);return}this.isDragging()&&this.applyWallDragMovement(n)}}onStageMouseUp(e){if(this.isPanning()){this.isPanning.set(!1),this.panStartPos.set(null),this.panInitialStagePos.set(null);return}if(this.drawingMode()==="move"&&this.isItemDragging()){this.finishItemDrag();return}this.drawingMode()==="move"&&this.isDragging()&&this.finishWallDrag()}onWallClick(e){this.drawingMode()==="select"&&(this.selectedWallId.set(e),this.selectedItemId.set(null),this.wallClicked.emit(e))}onWallMouseEnter(e){this.hoveredWallId.set(e),this.wallMouseEnter.emit(e)}onWallMouseLeave(){this.hoveredWallId.set(null),this.wallMouseLeave.emit()}onItemClick(e){this.drawingMode()==="select"&&(this.selectedItemId.set(e),this.selectedWallId.set(null),this.itemClicked.emit(e))}onItemMouseEnter(e){this.hoveredItemId.set(e)}onItemMouseLeave(){this.hoveredItemId.set(null)}startItemDrag(e,i){this.isItemDragging.set(!0),this.draggedItemId.set(e.id),this.itemDragStartPos.set({x:i.x,y:i.y}),this.draggedItemInitialPos.set({x:e.position_x??0,y:e.position_y??0})}applyItemDragMovement(e){let i=this.draggedItemId(),n=this.itemDragStartPos(),r=this.draggedItemInitialPos();if(!(i&&n&&r))return;let o=this.getCanvasPosition(e),s=o.x-n.x,a=o.y-n.y,l=this.snapToGrid({x:r.x+s,y:r.y+a});this.items.update(c=>c.map(d=>d.id===i?k(w({},d),{position_x:l.x,position_y:l.y}):d))}finishItemDrag(){let e=this.draggedItemId();if(e){let i=this.items().find(n=>n.id===e);if(i){let n=this.snapToGrid({x:i.position_x??0,y:i.position_y??0});this.items.update(r=>r.map(o=>o.id===e?k(w({},o),{position_x:n.x,position_y:n.y}):o)),this.itemMoved.emit({id:e,position_x:n.x,position_y:n.y})}}this.isItemDragging.set(!1),this.draggedItemId.set(null),this.itemDragStartPos.set(null),this.draggedItemInitialPos.set(null)}applyWallDragMovement(e){let i=this.draggedWallId(),n=this.dragStartPos(),r=this.draggedWallInitialCoords();if(!(i&&n&&r))return;let o=this.getCanvasPosition(e),s=o.x-n.x,a=o.y-n.y;this.walls.update(l=>l.map(c=>c.id===i?k(w({},c),{start_x:r.start_x+s,start_y:r.start_y+a,end_x:r.end_x+s,end_y:r.end_y+a}):c))}finishWallDrag(){let e=this.draggedWallId();if(e){let i=this.walls().find(n=>n.id===e);if(i){let n=this.snapToGrid({x:i.start_x,y:i.start_y}),r=this.snapToGrid({x:i.end_x,y:i.end_y});this.walls.update(o=>o.map(s=>s.id===e?k(w({},s),{start_x:n.x,start_y:n.y,end_x:r.x,end_y:r.y}):s)),this.wallMoved.emit({id:e,start_x:n.x,start_y:n.y,end_x:r.x,end_y:r.y})}}this.isDragging.set(!1),this.draggedWallId.set(null),this.dragStartPos.set(null),this.draggedWallInitialCoords.set(null)}snapToGrid(e){let i=this.gridSize();return{x:Math.round(e.x/i)*i,y:Math.round(e.y/i)*i}}getCanvasPosition(e){let i=this.zoom(),n=this.stagePosition();return{x:(e.x-n.x)/i,y:(e.y-n.y)/i}}getWallAtPosition(e){for(let n of this.walls())if(this.distanceToLineSegment(e,{x:n.start_x,y:n.start_y},{x:n.end_x,y:n.end_y})<10)return n;return null}getItemAtPosition(e){for(let i of this.items()){let n=i.position_x??0,r=i.position_y??0;if(e.x>=n-t.ITEM_RADIUS&&e.x<=n+t.ITEM_RADIUS&&e.y>=r-t.ITEM_RADIUS&&e.y<=r+t.ITEM_RADIUS)return i}return null}distanceToLineSegment(e,i,n){let r=n.x-i.x,o=n.y-i.y,s=r*r+o*o;if(s===0)return Math.sqrt((e.x-i.x)**2+(e.y-i.y)**2);let a=((e.x-i.x)*r+(e.y-i.y)*o)/s;a=Math.max(0,Math.min(1,a));let l=i.x+a*r,c=i.y+a*o;return Math.sqrt((e.x-l)**2+(e.y-c)**2)}getIconImage(e){return this.iconCache.get(e)||null}loadIconImage(e){if(this.iconCache.has(e))return;let i=Hs[e];if(!i){console.warn(`Icon ${e} not found in @ng-icons/lucide`);return}let r=`
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        ${i.data||i}
      </svg>
    `,o=new Blob([r],{type:"image/svg+xml"}),s=URL.createObjectURL(o),a=new Image;a.onload=()=>{this.iconCache.set(e,a),URL.revokeObjectURL(s),this.iconLoadingSignal.update(l=>l+1)},a.onerror=()=>{console.error(`Failed to load icon: ${e}`),URL.revokeObjectURL(s)},a.src=s}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=Ie({type:t,selectors:[["gh-house-plan-canvas"]],inputs:{canvasWidth:[1,"canvasWidth"],canvasHeight:[1,"canvasHeight"],gridSize:[1,"gridSize"],drawingMode:[1,"drawingMode"],zoom:[1,"zoom"],stagePosition:[1,"stagePosition"],items:[1,"items"],activeFlexibleItemId:[1,"activeFlexibleItemId"],walls:[1,"walls"]},outputs:{items:"itemsChange",walls:"wallsChange",wallClicked:"wallClicked",wallMouseEnter:"wallMouseEnter",wallMouseLeave:"wallMouseLeave",zoomChanged:"zoomChanged",stagePositionChanged:"stagePositionChanged",wallCreated:"wallCreated",wallMoved:"wallMoved",wallDeleted:"wallDeleted",itemClicked:"itemClicked",itemMoved:"itemMoved",itemDeleted:"itemDeleted",itemPlaced:"itemPlaced"},decls:12,vars:4,consts:[[1,"bg-white","inline-block"],[3,"mousedown","mousemove","mouseup","config"],[3,"config"],[3,"click","mouseenter","mouseleave","config"]],template:function(i,n){i&1&&(D(0,"div",0)(1,"ko-stage",1),te("mousedown",function(o){return n.onStageMouseDown(o)})("mousemove",function(o){return n.onStageMouseMove(o)})("mouseup",function(o){return n.onStageMouseUp(o)}),D(2,"ko-layer"),Vn(3,Vpe,1,1,"ko-line",2,cp),F(),D(5,"ko-layer"),Vn(6,Gpe,1,1,"ko-line",2,Hpe),ze(8,Wpe,1,5,"ko-line",2),F(),D(9,"ko-layer"),Vn(10,jpe,4,16,"ko-group",2,zpe),F()()()),i&2&&(Wn("cursor",n.cursorStyle()),M(),de("config",n.stageConfig()),M(2),Gn(n.gridLines()),M(3),Gn(n.wallLines()),M(2),Ve(n.tempLine()?8:-1),M(2),Gn(n.itemShapes()))},dependencies:[vn,iO,fv],encapsulation:2,changeDetection:0})};var S3=(()=>{class t{_computedClass=Fe(()=>bx("block",this.userClass()));userClass=Re("",{alias:"class"});static \u0275fac=function(n){return new(n||t)};static \u0275dir=Yt({type:t,selectors:[["ng-scrollbar","hlm",""],["ng-scrollbar","hlmScrollbar",""]],hostAttrs:["data-slot","scroll-area"],hostVars:12,hostBindings:function(n,r){n&2&&(Un(r._computedClass()),Wn("--scrollbar-border-radius","100px")("--scrollbar-offset",3)("--scrollbar-thumb-color","var(--border)")("--scrollbar-thumb-hover-color","var(--border)")("--scrollbar-thickness",7))},inputs:{userClass:[1,"class","userClass"]}})}return t})();var $pe=4,Kpe=.001,Ype=1e-7,Xpe=10,$h=11,mv=1/($h-1),Jpe=typeof Float32Array=="function";function nO(t,e){return 1-3*e+3*t}function rO(t,e){return 3*e-6*t}function oO(t){return 3*t}function vv(t,e,i){return((nO(e,i)*t+rO(e,i))*t+oO(e))*t}function sO(t,e,i){return 3*nO(e,i)*t*t+2*rO(e,i)*t+oO(e)}function Qpe(t,e,i,n,r){let o,s,a=0;do s=e+(i-e)/2,o=vv(s,n,r)-t,o>0?i=s:e=s;while(Math.abs(o)>Ype&&++a<Xpe);return s}function Zpe(t,e,i,n){for(let r=0;r<$pe;++r){let o=sO(e,i,n);if(o===0)return e;let s=vv(e,i,n)-t;e-=s/o}return e}function efe(t){return t}function tfe(t,e,i,n){if(!(0<=t&&t<=1&&0<=i&&i<=1))throw new Error("bezier x values must be in [0, 1] range");if(t===e&&i===n)return efe;let r=Jpe?new Float32Array($h):new Array($h);for(let s=0;s<$h;++s)r[s]=vv(s*mv,t,i);function o(s){let a=0,l=1,c=$h-1;for(;l!==c&&r[l]<=s;++l)a+=mv;--l;let d=(s-r[l])/(r[l+1]-r[l]),u=a+d*mv,h=sO(u,t,i);return h>=Kpe?Zpe(s,u,t,i):h===0?u:Qpe(s,a,a+mv,t,i)}return function(a){return a===0?0:a===1?1:vv(o(a),e,n)}}var ife={duration:468,easing:{x1:.42,y1:0,x2:.58,y2:1}},nfe=new tn("SMOOTH_SCROLL_OPTIONS",{providedIn:"root",factory:()=>ife});var aO=(()=>{let e=class e{constructor(){this.document=Z(Bo),this.zone=Z(Wi),this._defaultOptions=Z(nfe),this.onGoingScrolls=new Map}get now(){return this.document.defaultView.performance?.now?.bind(this.document.defaultView.performance)||Date.now}scrollElement(n,r,o){n.scrollLeft=r,n.scrollTop=o}getElement(n,r){return typeof n=="string"?(r||this.document).querySelector(n):$n(n)}getScrollDestroyerRef(n){return this.onGoingScrolls.has(n)&&this.onGoingScrolls.get(n).next(),this.onGoingScrolls.set(n,new bt).get(n)}step(n){return new jc(r=>{let o=(this.now()-n.startTime)/n.duration;o=o>1?1:o;let s=n.easing(o);n.currentX=n.startX+(n.x-n.startX)*s,n.currentY=n.startY+(n.y-n.startY)*s,this.scrollElement(n.scrollable,n.currentX,n.currentY),requestAnimationFrame(()=>{r.next(),r.complete()})})}isReached(n,r){return n.currentX===n.x&&n.currentY===n.y?(r.next(),!0):!1}scrolling(n,r){return this.step(n).pipe($c(()=>!this.isReached(n,r)),en(()=>this.scrolling(n,r)))}onScrollReached(n,r,o){o.complete(),this.onGoingScrolls.delete(n),this.zone.run(()=>r())}interrupted(n,r){return Yr(Ii(n,"wheel",{passive:!0,capture:!0}),Ii(n,"touchmove",{passive:!0,capture:!0}),r).pipe(sp(1))}applyScrollToOptions(n,r){return r.duration?new Promise(o=>{this.zone.runOutsideAngular(()=>{let s=this.getScrollDestroyerRef(n),a={scrollable:n,startTime:this.now(),startX:n.scrollLeft,startY:n.scrollTop,x:r.left==null?n.scrollLeft:~~r.left,y:r.top==null?n.scrollTop:~~r.top,duration:r.duration,easing:tfe(r.easing.x1,r.easing.y1,r.easing.x2,r.easing.y2)};this.scrolling(a,s).pipe(gn(this.interrupted(n,s)),Qe(()=>this.onScrollReached(n,o,s))).subscribe()})}):(this.scrollElement(n,r.left,r.top),Promise.resolve())}scrollTo(n,r){let o=this.getElement(n),s=getComputedStyle(o).direction==="rtl",a=k(w(w({},this._defaultOptions),r),{left:r.left==null?s?r.end:r.start:r.left,right:r.right==null?s?r.start:r.end:r.right});return a.bottom!=null&&(a.top=o.scrollHeight-o.clientHeight-a.bottom),s?(a.left!=null&&(a.right=o.scrollWidth-o.clientWidth-a.left),a.left=a.right?-a.right:a.right):a.right!=null&&(a.left=o.scrollWidth-o.clientWidth-a.right),this.applyScrollToOptions(o,a)}scrollToElement(n,r,o={}){let s=this.getElement(n),a=this.getElement(r,s),l=getComputedStyle(s).direction==="rtl";if(!a||!s)return Promise.resolve();let c=s.getBoundingClientRect(),d=a.getBoundingClientRect(),u=k(w(w({},this._defaultOptions),o),{top:d.top+s.scrollTop-c.top+(o.top||0),left:o.left==null?l?o.end:o.start:o.left,right:o.right==null?l?o.start:o.end:o.right});if(o.center){let p=c.left+c.width/2,f=c.top+c.height/2,g=d.left+d.width/2,m=d.top+d.height/2;return u.left=g-p+s.scrollLeft,u.top=m-f+s.scrollTop,this.applyScrollToOptions(s,u)}if(u.bottom!=null){let p=c.height-d.height;u.top=d.top+s.scrollTop-c.top-p+(o.bottom||0)}u.left=d.left-c.left+s.scrollLeft+(u.left||0),u.right!=null&&(u.left=d.right-c.left+s.scrollLeft-c.width+(u.right||0));let h={top:u.top,left:u.left,easing:u.easing,duration:u.duration};return this.applyScrollToOptions(s,h)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Hn({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var rfe=["scrollbarButton",""];function ofe(t,e){if(t&1&&ee(0,"button",4)(1,"button",5),t&2){let i=X();Un(Jr("ng-scrollbar-button ",i.cmp.buttonClass())),M(),Un(Jr("ng-scrollbar-button ",i.cmp.buttonClass()))}}function sfe(t,e){if(t&1&&ee(0,"button",4)(1,"button",5),t&2){let i=X();Un(Jr("ng-scrollbar-button ",i.cmp.buttonClass())),M(),Un(Jr("ng-scrollbar-button ",i.cmp.buttonClass()))}}var afe="[_nghost-%COMP%]{position:absolute;inset:0;pointer-events:none;min-width:calc(var(--viewport-width) * 1px);min-height:calc(var(--viewport-height) * 1px)}.ng-scrollbar-sticky[_ngcontent-%COMP%]{top:calc(var(--_scrollbar-wrapper-top) * 1px);left:calc(var(--_scrollbar-wrapper-left) * 1px);right:calc(var(--_scrollbar-wrapper-right) * 1px);height:calc(var(--_scrollbar-wrapper-height) * 1px);width:calc(var(--_scrollbar-wrapper-width) * 1px);position:sticky;z-index:100;opacity:var(--_scrollbar-hover-opacity);transition:var(--_scrollbar-opacity-transition);pointer-events:var(--_scrollbar-pointer-events)}.ng-scrollbar-track-wrapper[_ngcontent-%COMP%]{touch-action:none;-webkit-user-select:none;user-select:none;top:var(--_scrollbar-track-top);bottom:var(--_scrollbar-track-bottom);right:var(--_scrollbar-track-right);left:var(--_scrollbar-track-left);transition:var(--INTERNAL-scrollbar-track-wrapper-transition);position:absolute;overflow:hidden;display:flex;place-items:center}.ng-scrollbar-track[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;background-color:var(--INTERNAL-scrollbar-track-color);border-radius:var(--INTERNAL-scrollbar-border-radius);cursor:default;z-index:1;order:2}.ng-scrollbar-thumb[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;transition:var(--INTERNAL-scrollbar-thumb-transition);border-radius:var(--INTERNAL-scrollbar-border-radius);height:var(--_thumb-height);width:var(--_thumb-width);animation-name:_ngcontent-%COMP%_scrollbarThumbAnimation;animation-duration:1ms;animation-timing-function:linear}@keyframes _ngcontent-%COMP%_scrollbarThumbAnimation{0%{translate:var(--_scrollbar-thumb-transform-from)}to{translate:var(--_scrollbar-thumb-transform-to)}}";function lfe(t,e){t&1&&ee(0,"scrollbar-y")}function cfe(t,e){t&1&&ee(0,"scrollbar-x")}var dfe=["contentWrapper"],ufe=["*"];var lO=(()=>{let e=class e{constructor(){this.nativeElement=Z(Ai).nativeElement}};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=Yt({type:e,selectors:[["","scrollViewport",""]]});let t=e;return t})();function P3(t){return mn(()=>t.onselectstart=()=>!1)}function R3(t){return mn(()=>t.onselectstart=null)}function Kh(){return mn(t=>{t.preventDefault(),t.stopPropagation()})}function hfe(t,e){return t.pipe(lx(e||0,null,{leading:!1,trailing:!0}))}var Cv=(function(t){return t.Viewport="ng-scroll-viewport",t.Content="ng-scroll-content",t.Spacer="ng-scroll-spacer",t})(Cv||{}),cO=(()=>{let e=class e{constructor(){this.initialized=ve(!1)}get offsetHeight(){return this.nativeElement.offsetHeight}get offsetWidth(){return this.nativeElement.offsetWidth}get scrollTop(){return this.nativeElement.scrollTop}get scrollLeft(){return this.nativeElement.scrollLeft}get contentHeight(){return this.contentWrapperElement.offsetHeight}get contentWidth(){return this.contentWrapperElement.offsetWidth}get scrollMaxX(){return this.contentWidth-this.offsetWidth}get scrollMaxY(){return this.contentHeight-this.offsetHeight}init(n,r,o){n.classList.add(Cv.Viewport),this.nativeElement=n,r.classList.add(Cv.Content),o?(o.classList.add(Cv.Spacer),this.contentWrapperElement=o):this.contentWrapperElement=r,this.initialized.set(!0)}reset(){this.nativeElement=null,this.contentWrapperElement=null,this.initialized.set(!1)}scrollYTo(n){this.nativeElement.scrollTop=n}scrollXTo(n){this.nativeElement.scrollLeft=n}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Hn({token:e,factory:e.\u0275fac});let t=e;return t})(),Xh=new tn("NG_SCROLLBAR"),pfe={trackClass:"",thumbClass:"",buttonClass:"",orientation:"auto",appearance:"native",visibility:"native",position:"native",trackScrollDuration:50,sensorThrottleTime:0,disableSensor:!1,disableInteraction:!1,buttons:!1,hoverOffset:!1},ffe="https://cdn.statically.io/gist/MurhafSousli/c852b6a672069396953f06ddd4b64620/raw/ef55db72e2abb7bc002ed79f4ad4cf408bfdb72f/scroll-timeline-lite.js",E3=(function(t){return t.AfterInit="AfterInit",t.Resized="ResizeObserver",t})(E3||{}),gfe=new tn("NG_SCROLLBAR_OPTIONS",{providedIn:"root",factory:()=>pfe}),mfe=new tn("NG_SCROLLBAR_POLYFILL",{providedIn:"root",factory:()=>ffe});var vfe=(()=>{let e=class e{constructor(){this.options=Z(gfe),this.sharedResizeObserver=Z(gE),this.zone=Z(Wi),this.platform=Z($x),this.isMobile=this.platform.IOS||this.platform.ANDROID,this.dir=Z(ad),this.smoothScroll=Z(aO),this.viewport=Z(cO,{self:!0}),this.nativeElement=Z(Ai).nativeElement,this.direction=wx(this.dir.change,{initialValue:this.dir.value}),this.dragging=ve("none"),this.orientation=Re(this.options.orientation),this.visibility=Re(this.options.visibility),this.buttons=Re(this.options.buttons,{transform:O}),this.disableInteraction=Re(this.options.disableInteraction,{transform:O}),this.disableSensor=Re(this.options.disableSensor,{transform:O}),this.sensorThrottleTime=Re(this.options.sensorThrottleTime,{transform:od}),this.hoverOffset=Re(this.options.hoverOffset,{transform:O}),this.viewportDimension=ve({width:0,height:0}),this.contentDimension=ve({width:0,height:0}),this.state=Fe(()=>{let o=!1,s=!1,a=!1,l=!1,c=this.orientation(),d=this.visibility(),u=this.viewportDimension(),h=this.contentDimension();return(c==="auto"||c==="vertical")&&(a=h.height>u.height,o=d==="visible"||a),(c==="auto"||c==="horizontal")&&(l=h.width>u.width,s=d==="visible"||l),{verticalUsed:o,horizontalUsed:s,isVerticallyScrollable:a,isHorizontallyScrollable:l}}),this.isVerticallyScrollable=Fe(()=>this.state().isVerticallyScrollable),this.isHorizontallyScrollable=Fe(()=>this.state().isHorizontallyScrollable),this.verticalUsed=Fe(()=>this.state().verticalUsed),this.horizontalUsed=Fe(()=>this.state().horizontalUsed),this.trackScrollDuration=Re(this.options.trackScrollDuration,{transform:od}),this.appearance=Re(this.options.appearance),this.position=Re(this.options.position),this.trackClass=Re(this.options.trackClass),this.thumbClass=Re(this.options.thumbClass),this.buttonClass=Re(this.options.thumbClass),this.afterInit=ue(),this.afterUpdate=ue();let n,r;pp({earlyRead:o=>{let s=this.disableSensor(),a=this.sensorThrottleTime(),l=this.viewport.initialized();Bs(()=>{l&&(s?requestAnimationFrame(()=>this.update(E3.AfterInit)):this.zone.runOutsideAngular(()=>{n=hfe(ax([this.sharedResizeObserver.observe(this.viewport.nativeElement),this.sharedResizeObserver.observe(this.viewport.contentWrapperElement)]),a).subscribe(()=>{this.zone.run(()=>{this.updateDimensions(),r?this.afterUpdate.emit():this.afterInit.emit(),r=!0})})})),o(()=>n?.unsubscribe())})}})}update(n){this.updateDimensions(),n===E3.AfterInit?this.afterInit.emit():this.afterUpdate.emit()}scrollTo(n){return this.smoothScroll.scrollTo(this.viewport.nativeElement,n)}scrollToElement(n,r){return this.smoothScroll.scrollToElement(this.viewport.nativeElement,n,r)}updateDimensions(){this.viewportDimension.set({width:this.viewport.offsetWidth,height:this.viewport.offsetHeight}),this.contentDimension.set({width:this.viewport.contentWidth,height:this.viewport.contentHeight})}};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=Yt({type:e,hostVars:22,hostBindings:function(r,o){r&2&&(Ya("verticalUsed",o.verticalUsed())("horizontalUsed",o.horizontalUsed())("isVerticallyScrollable",o.isVerticallyScrollable())("isHorizontallyScrollable",o.isHorizontallyScrollable())("mobile",o.isMobile)("dir",o.direction())("position",o.position())("dragging",o.dragging())("appearance",o.appearance())("visibility",o.visibility())("orientation",o.orientation())("disableInteraction",o.disableInteraction()),Wn("--content-height",o.contentDimension().height)("--content-width",o.contentDimension().width)("--viewport-height",o.viewportDimension().height)("--viewport-width",o.viewportDimension().width),Xt("ng-scrollbar",!0))},inputs:{orientation:[1,"orientation"],visibility:[1,"visibility"],buttons:[1,"buttons"],disableInteraction:[1,"disableInteraction"],disableSensor:[1,"disableSensor"],sensorThrottleTime:[1,"sensorThrottleTime"],hoverOffset:[1,"hoverOffset"],trackScrollDuration:[1,"trackScrollDuration"],appearance:[1,"appearance"],position:[1,"position"],trackClass:[1,"trackClass"],thumbClass:[1,"thumbClass"],buttonClass:[1,"buttonClass"]},outputs:{afterInit:"afterInit",afterUpdate:"afterUpdate"},features:[Xe([{provide:Xh,useExisting:e}])]});let t=e;return t})(),_3=new tn("SCROLLBAR_CONTROL"),dO=(()=>{let e=class e{constructor(){this.trackSize=ve(0),this.cmp=Z(Xh)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=Yt({type:e});let t=e;return t})(),k3=(()=>{let e=class e{constructor(){this.cmp=Z(Xh),this.control=Z(_3),this.document=Z(Bo),this.zone=Z(Wi),this.nativeElement=Z(Ai).nativeElement,pt(n=>{let r=this.cmp.disableInteraction();Bs(()=>{r||this.zone.runOutsideAngular(()=>{this._pointerEventsSub=this.pointerEvents.subscribe()}),n(()=>this._pointerEventsSub?.unsubscribe())})})}};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=Yt({type:e});let t=e;return t})(),Yh=(()=>{let e=class e extends k3{get viewportSize(){return this.cmp.viewport[this.control.sizeProperty]}get clientRect(){return this.nativeElement.getBoundingClientRect()}get offset(){return this.clientRect[this.control.rectOffsetProperty]}get size(){return this.nativeElement[this.control.sizeProperty]}get pointerEvents(){let n=Ii(this.nativeElement,"pointerdown").pipe(Kh(),P3(this.document)),r=Ii(this.document,"pointerup",{passive:!0}).pipe(R3(this.document)),o=Ii(this.nativeElement,"pointerover",{passive:!0}).pipe(mn(c=>this.currMousePosition=c[this.control.offsetProperty]),Kr(()=>!0)),s=Ii(this.nativeElement,"pointerout",{passive:!0}).pipe(Kr(()=>!1)),a=Yr(o,s).pipe(qc(!0)),l=Ii(this.nativeElement,"pointermove",{passive:!0}).pipe(mn(c=>this.currMousePosition=c[this.control.offsetProperty]));return n.pipe(en(c=>(l.pipe(gn(r)).subscribe(),this.onTrackFirstClick(c).pipe(Dv(200),en(()=>a.pipe(en(d=>{let u=this.getScrollDirection(this.currMousePosition),h=this.scrollDirection===u;return d&&h?this.onTrackOngoingMousedown():sx}))),gn(r)))))}constructor(){pp({earlyRead:()=>{this.cmp.viewportDimension(),this.cmp.contentDimension(),Bs(()=>{this.control.trackSize.set(this.size),this.size||requestAnimationFrame(()=>this.control.trackSize.set(this.size))})}}),super()}onTrackFirstClick(n){return this.currMousePosition=n[this.control.offsetProperty],this.scrollDirection=this.getScrollDirection(this.currMousePosition),this.scrollMax=this.control.viewportScrollMax,this.scrollTo(this.nextStep())}nextStep(){if(this.scrollDirection==="forward"){let r=this.getScrollForwardStep();return r>=this.scrollMax?this.scrollMax:r}let n=this.getScrollBackwardStep();return n<=0?0:n}onTrackOngoingMousedown(){let n=this.nextStep();return this.scrollTo(n).pipe($c(()=>!this.isReached(n)),en(()=>this.onTrackOngoingMousedown()))}isReached(n){return this.scrollDirection==="forward"?n>=this.scrollMax:n<=0}};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=Yt({type:e,features:[zn]});let t=e;return t})(),Cfe=(()=>{let e=class e extends Yh{get contentSize(){return this.cmp.viewport.contentWidth}constructor(){pt(()=>{this.cmp.direction()==="rtl"?(this.getCurrPosition=()=>(this.contentSize-this.viewportSize-this.control.viewportScrollOffset)*this.size/this.contentSize,this.getScrollDirection=n=>n<this.getCurrPosition()?"forward":"backward"):(this.getCurrPosition=()=>this.control.viewportScrollOffset*this.size/this.contentSize,this.getScrollDirection=n=>n>this.getCurrPosition()?"forward":"backward")}),super()}scrollTo(n){return $e(this.cmp.scrollTo({start:n,duration:this.cmp.trackScrollDuration()}))}getScrollForwardStep(){return this.control.viewportScrollOffset+this.viewportSize}getScrollBackwardStep(){return this.control.viewportScrollOffset-this.viewportSize}};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=Yt({type:e,selectors:[["","scrollbarTrackX",""]],features:[Xe([{provide:Yh,useExisting:e}]),zn]});let t=e;return t})(),wfe=(()=>{let e=class e extends Yh{get contentSize(){return this.cmp.viewport.contentHeight}getCurrPosition(){return this.control.viewportScrollOffset*this.size/this.contentSize}getScrollDirection(n){return n>this.getCurrPosition()?"forward":"backward"}scrollTo(n){return $e(this.cmp.scrollTo({top:n,duration:this.cmp.trackScrollDuration()}))}getScrollForwardStep(){return this.control.viewportScrollOffset+this.viewportSize}getScrollBackwardStep(){return this.control.viewportScrollOffset-this.viewportSize}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=Ns(e)))(o||e)}})(),e.\u0275dir=Yt({type:e,selectors:[["","scrollbarTrackY",""]],features:[Xe([{provide:Yh,useExisting:e}]),zn]});let t=e;return t})(),uO=(()=>{let e=class e{constructor(){this.isBrowser=vx(Z(hx)),this._polyfillUrl=Z(mfe),this.document=Z(Bo),this.window=this.document.defaultView,this.scrollTimelinePolyfill=ve(null),this.isBrowser&&(!this.window.ScrollTimeline||!CSS.supports("animation-timeline","scroll()"))&&this.initPolyfill()}async initPolyfill(){try{let n=this.document.createElement("script");n.src=this._polyfillUrl,await new Promise((r,o)=>{n.onload=r,n.onerror=o,this.document.head.appendChild(n)}),this.window.ScrollTimeline?this.scrollTimelinePolyfill.set(this.window.ScrollTimeline):console.error("[NgScrollbar]: ScrollTimeline is not attached to the window object.")}catch(n){console.error("[NgScrollbar]: Error loading ScrollTimeline script:",n)}}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Hn({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),wv=(()=>{let e=class e extends k3{get size(){return this.nativeElement.getBoundingClientRect()[this.control.rectSizeProperty]}get trackMax(){return this.track.size-this.size}get pointerEvents(){return Ii(this.nativeElement,"pointerdown").pipe(Kh(),P3(this.document),en(n=>{let r,o,s=Ye(n).pipe(mn(()=>{r=this.trackMax,o=this.control.viewportScrollMax,this.setDragging(this.control.axis)})),a=Ii(this.document,"pointermove").pipe(Kh()),l=Ii(this.document,"pointerup",{capture:!0}).pipe(Kh(),R3(this.document),mn(()=>this.setDragging("none")));return s.pipe(Kr(c=>c[this.control.offsetProperty]),en(c=>a.pipe(Kr(d=>d[this.control.clientProperty]),Kr(d=>d-this.track.offset),Kr(d=>o*(d-c)/r),mn(d=>this.control.instantScrollTo(d,o)),gn(l))))}))}constructor(){pp({earlyRead:()=>{let n=this.manager.scrollTimelinePolyfill();Bs(()=>{n&&!this._animation&&(this._animation=bfe(n,this.nativeElement,this.cmp.viewport.nativeElement,this.control.axis))})}}),super(),this.manager=Z(uO),this.track=Z(Yh)}setDragging(n){this.zone.run(()=>this.cmp.dragging.set(n))}};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=Yt({type:e,features:[zn]});let t=e;return t})();function bfe(t,e,i,n){return e.animate({translate:["var(--_scrollbar-thumb-transform-from)","var(--_scrollbar-thumb-transform-to)"]},{fill:"both",easing:"linear",timeline:new t({source:i,axis:n})})}var yfe=(()=>{let e=class e extends wv{};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=Ns(e)))(o||e)}})(),e.\u0275dir=Yt({type:e,selectors:[["","scrollbarThumbX",""]],features:[Xe([{provide:wv,useExisting:e}]),zn]});let t=e;return t})(),Sfe=(()=>{let e=class e extends wv{};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=Ns(e)))(o||e)}})(),e.\u0275dir=Yt({type:e,selectors:[["","scrollbarThumbY",""]],features:[Xe([{provide:wv,useExisting:e}]),zn]});let t=e;return t})(),xfe={forward:(t,e)=>t<e,backward:t=>t>0},hO={forward:(t,e)=>e+t,backward:(t,e)=>e-t},Efe={rtl:{forward:(t,e,i)=>i-e-t,backward:(t,e,i)=>i-e+t},ltr:hO},pO=(()=>{let e=class e extends k3{get pointerEvents(){let n=Ii(this.nativeElement,"pointerdown").pipe(Kh(),P3(this.document)),r=Ii(this.document,"pointerup",{passive:!0}).pipe(R3(this.document)),o=Ii(this.nativeElement,"pointerleave",{passive:!0}),s=Yr(r,o);return n.pipe(en(()=>this.firstScrollStep().pipe(Dv(this.afterFirstClickDelay),en(()=>this.onOngoingPointerdown()),gn(s))))}constructor(){pt(()=>{let n=this.scrollDirection(),r=this.cmp.direction();Bs(()=>{this.canScroll=xfe[n],this.control.axis==="x"?this.nextStep=Efe[r][n]:this.nextStep=hO[n]})}),super(),this.scrollbarButton=Re.required(),this.scrollDirection=Re.required(),this.afterFirstClickDelay=120,this.firstClickDuration=100,this.scrollBy=50,this.onGoingScrollBy=12}firstScrollStep(){let n=this.nextStep(this.scrollBy,this.control.viewportScrollOffset,this.control.viewportScrollMax);return this.control.scrollTo(n,this.firstClickDuration)}onGoingScrollStep(){let n=this.control.viewportScrollMax,r=this.nextStep(this.onGoingScrollBy,this.control.viewportScrollOffset,n);this.control.instantScrollTo(r,n)}onOngoingPointerdown(){return op(0,rp).pipe($c(()=>this.canScroll(this.control.viewportScrollOffset,this.control.viewportScrollMax)),mn(()=>this.onGoingScrollStep()))}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=Ie({type:e,selectors:[["button","scrollbarButton",""]],inputs:{scrollbarButton:[1,"scrollbarButton"],scrollDirection:[1,"scrollDirection"]},features:[zn],attrs:rfe,decls:3,vars:0,consts:[[1,"ng-scrollbar-button-icon"],["viewBox","0 0 512 512","xmlns","http://www.w3.org/2000/svg"],["d","M413.1,327.3l-1.8-2.1l-136-156.5c-4.6-5.3-11.5-8.6-19.2-8.6c-7.7,0-14.6,3.4-19.2,8.6L101,324.9l-2.3,2.6  C97,330,96,333,96,336.2c0,8.7,7.4,15.8,16.6,15.8v0h286.8v0c9.2,0,16.6-7.1,16.6-15.8C416,332.9,414.9,329.8,413.1,327.3z"]],template:function(r,o){r&1&&(Xa(0,"div",0),dx(),Xa(1,"svg",1),dp(2,"path",2),Jc()())},styles:["[_nghost-%COMP%]{position:relative;border:none;margin:0;padding:0;border-radius:0;appearance:none;background-color:var(--INTERNAL-scrollbar-button-color)}[_nghost-%COMP%]   svg[_ngcontent-%COMP%]{width:100%;height:100%;fill:var(--INTERNAL-scrollbar-button-fill)}[_nghost-%COMP%]:hover{background:var(--INTERNAL-scrollbar-button-hover-color)}[_nghost-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--INTERNAL-scrollbar-button-hover-fill)}[_nghost-%COMP%]:active{background:var(--INTERNAL-scrollbar-button-active-color)}[_nghost-%COMP%]:active   svg[_ngcontent-%COMP%]{fill:var(--INTERNAL-scrollbar-button-active-fill)}[scrollbarButton=top][_nghost-%COMP%], [scrollbarButton=start][_nghost-%COMP%]{order:1}[scrollbarButton=bottom][_nghost-%COMP%], [scrollbarButton=end][_nghost-%COMP%]{order:3}[scrollbarButton=top][_nghost-%COMP%], [scrollbarButton=bottom][_nghost-%COMP%]{width:100%;height:var(--INTERNAL-scrollbar-button-size)}[scrollbarButton=start][_nghost-%COMP%], [scrollbarButton=end][_nghost-%COMP%]{width:var(--INTERNAL-scrollbar-button-size);height:100%}[scrollbarButton=bottom][_nghost-%COMP%]{--_button-rotate: 180deg}[scrollbarButton=start][_nghost-%COMP%]{--_button-rotate: -90deg}[scrollbarButton=start][_nghost-%COMP%]   .ng-scrollbar-button-icon[_ngcontent-%COMP%]{writing-mode:vertical-lr}[scrollbarButton=end][_nghost-%COMP%]{--_button-rotate: 90deg}[scrollbarButton=end][_nghost-%COMP%]   .ng-scrollbar-button-icon[_ngcontent-%COMP%]{writing-mode:vertical-rl}.ng-scrollbar-button-icon[_ngcontent-%COMP%]{rotate:var(--_button-rotate);display:flex;place-content:center;place-items:center;width:100%;height:100%}"],changeDetection:0});let t=e;return t})(),Pfe=(()=>{let e=class e extends dO{constructor(){super(...arguments),this.rectOffsetProperty="top",this.rectSizeProperty="height",this.sizeProperty="offsetHeight",this.clientProperty="clientY",this.offsetProperty="offsetY",this.axis="y"}get viewportScrollMax(){return this.cmp.viewport.scrollMaxY}get viewportScrollOffset(){return this.cmp.viewport.scrollTop}scrollTo(n,r){return $e(this.cmp.scrollTo({top:n,duration:r}))}instantScrollTo(n){this.cmp.viewport.scrollYTo(n)}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=Ns(e)))(o||e)}})(),e.\u0275cmp=Ie({type:e,selectors:[["scrollbar-y"]],hostVars:2,hostBindings:function(r,o){r&2&&Wn("--track-size",o.trackSize())},features:[Xe([{provide:_3,useExisting:e}]),zn],decls:5,vars:11,consts:[[1,"ng-scrollbar-sticky"],[1,"ng-scrollbar-track-wrapper"],["scrollbarTrackY",""],["scrollbarThumbY",""],["scrollbarButton","top","scrollDirection","backward"],["scrollbarButton","bottom","scrollDirection","forward"]],template:function(r,o){r&1&&(D(0,"div",0)(1,"div",1)(2,"div",2),ee(3,"div",3),F(),ze(4,ofe,2,6),F()()),r&2&&(Xt("ng-scrollbar-hover",o.cmp.hoverOffset()),M(),Xt("ng-scrollbar-hover",!o.cmp.hoverOffset()),M(),Un(Jr("ng-scrollbar-track ",o.cmp.trackClass())),M(),Un(Jr("ng-scrollbar-thumb ",o.cmp.thumbClass())),M(),Ve(o.cmp.buttons()?4:-1))},dependencies:[wfe,Sfe,pO],styles:["[_nghost-%COMP%]{position:absolute;inset:0;pointer-events:none;min-width:calc(var(--viewport-width) * 1px);min-height:calc(var(--viewport-height) * 1px)}.ng-scrollbar-sticky[_ngcontent-%COMP%]{top:calc(var(--_scrollbar-wrapper-top) * 1px);left:calc(var(--_scrollbar-wrapper-left) * 1px);right:calc(var(--_scrollbar-wrapper-right) * 1px);height:calc(var(--_scrollbar-wrapper-height) * 1px);width:calc(var(--_scrollbar-wrapper-width) * 1px);position:sticky;z-index:100;opacity:var(--_scrollbar-hover-opacity);transition:var(--_scrollbar-opacity-transition);pointer-events:var(--_scrollbar-pointer-events)}.ng-scrollbar-track-wrapper[_ngcontent-%COMP%]{touch-action:none;-webkit-user-select:none;user-select:none;top:var(--_scrollbar-track-top);bottom:var(--_scrollbar-track-bottom);right:var(--_scrollbar-track-right);left:var(--_scrollbar-track-left);transition:var(--INTERNAL-scrollbar-track-wrapper-transition);position:absolute;overflow:hidden;display:flex;place-items:center}.ng-scrollbar-track[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;background-color:var(--INTERNAL-scrollbar-track-color);border-radius:var(--INTERNAL-scrollbar-border-radius);cursor:default;z-index:1;order:2}.ng-scrollbar-thumb[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;transition:var(--INTERNAL-scrollbar-thumb-transition);border-radius:var(--INTERNAL-scrollbar-border-radius);height:var(--_thumb-height);width:var(--_thumb-width);animation-name:_ngcontent-%COMP%_scrollbarThumbAnimation;animation-duration:1ms;animation-timing-function:linear}@keyframes _ngcontent-%COMP%_scrollbarThumbAnimation{0%{translate:var(--_scrollbar-thumb-transform-from)}to{translate:var(--_scrollbar-thumb-transform-to)}}","[_nghost-%COMP%]{--_scrollbar-wrapper-top: 0;--_scrollbar-wrapper-left: var(--_scrollbar-wrapper-y-left);--_scrollbar-wrapper-right: var(--_scrollbar-wrapper-y-right);--_scrollbar-wrapper-height: var(--viewport-height);--_scrollbar-wrapper-width: var(--_scrollbar-thickness);--_scrollbar-track-top: var(--_vertical-top);--_scrollbar-track-bottom: var(--_vertical-bottom);--_scrollbar-track-right: var(--_vertical-right);--_scrollbar-track-left: var(--_vertical-left);--thumb-size: max(calc(var(--viewport-height) * var(--track-size) / var(--content-height)), var(--INTERNAL-scrollbar-thumb-min-size));--_thumb-height: calc(var(--thumb-size) * 1px);--_thumb-width: 100%;--_scrollbar-y-thumb-transform-to-value: calc(var(--track-size) - var(--thumb-size));--_scrollbar-thumb-transform-from: 0 0;--_scrollbar-thumb-transform-to: 0 calc(var(--_scrollbar-y-thumb-transform-to-value) * 1px)}.ng-scrollbar-track-wrapper[_ngcontent-%COMP%]{width:var(--_track-y-thickness);flex-direction:column}.ng-scrollbar-hover[_ngcontent-%COMP%]:hover, .ng-scrollbar-hover[_ngcontent-%COMP%]:active{--_track-y-thickness: var(--_scrollbar-hover-thickness-px);--_thumb-y-color: var(--INTERNAL-scrollbar-thumb-hover-color)}.ng-scrollbar-thumb[_ngcontent-%COMP%]{animation-timeline:var(--_animation-timeline-y);min-height:calc(var(--INTERNAL-scrollbar-thumb-min-size) * 1px);display:var(--_vertical-thumb-display);background-color:var(--_thumb-y-color)}"],changeDetection:0});let t=e;return t})(),Rfe=(()=>{let e=class e extends dO{get viewportScrollMax(){return this.cmp.viewport.scrollMaxX}get viewportScrollOffset(){return Math.abs(this.cmp.viewport.scrollLeft)}constructor(){pt(()=>{this.cmp.direction()==="rtl"?this.handlePosition=(n,r)=>-(r-n):this.handlePosition=n=>n}),super(),this.manager=Z(uO),this.rectOffsetProperty="left",this.rectSizeProperty="width",this.sizeProperty="offsetWidth",this.clientProperty="clientX",this.offsetProperty="offsetX",this.axis="x"}scrollTo(n,r){return $e(this.cmp.scrollTo({left:n,duration:r}))}instantScrollTo(n,r){this.cmp.viewport.scrollXTo(this.handlePosition(n,r))}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=Ie({type:e,selectors:[["scrollbar-x"]],hostVars:3,hostBindings:function(r,o){r&2&&(Ya("dir",o.cmp.direction()),Wn("--track-size",o.trackSize()))},features:[Xe([{provide:_3,useExisting:e}]),zn],decls:5,vars:11,consts:[[1,"ng-scrollbar-sticky"],[1,"ng-scrollbar-track-wrapper"],["scrollbarTrackX",""],["scrollbarThumbX",""],["scrollbarButton","start","scrollDirection","backward"],["scrollbarButton","end","scrollDirection","forward"]],template:function(r,o){r&1&&(D(0,"div",0)(1,"div",1)(2,"div",2),ee(3,"div",3),F(),ze(4,sfe,2,6),F()()),r&2&&(Xt("ng-scrollbar-hover",o.cmp.hoverOffset()),M(),Xt("ng-scrollbar-hover",!o.cmp.hoverOffset()),M(),Un(Jr("ng-scrollbar-track ",o.cmp.trackClass())),M(),Un(Jr("ng-scrollbar-thumb ",o.cmp.thumbClass())),M(),Ve(o.cmp.buttons()?4:-1))},dependencies:[Cfe,yfe,pO],styles:[afe,"[_nghost-%COMP%]{--_scrollbar-wrapper-top: var(--_scrollbar-wrapper-x-top);--_scrollbar-wrapper-left: 0;--_scrollbar-wrapper-right: 0;--_scrollbar-wrapper-height: var(--_scrollbar-thickness);--_scrollbar-wrapper-width: var(--viewport-width);--_scrollbar-track-top: var(--_horizontal-top);--_scrollbar-track-bottom: var(--_horizontal-bottom);--_scrollbar-track-right: var(--_horizontal-right);--_scrollbar-track-left: var(--_horizontal-left);--thumb-size: max(calc(var(--viewport-width) * var(--track-size) / var(--content-width)), var(--INTERNAL-scrollbar-thumb-min-size));--_thumb-height: 100%;--_thumb-width: calc(var(--thumb-size) * 1px);--_scrollbar-x-thumb-transform-to-value: calc(var(--track-size) - var(--thumb-size));--_scrollbar-thumb-transform-from: 0;--_scrollbar-thumb-transform-to: calc(var(--_scrollbar-x-thumb-transform-to-value) * 1px)}[_nghost-%COMP%]   .ng-scrollbar-button[scrollbarButton=start][_ngcontent-%COMP%]{_--button-rotate:90}[_nghost-%COMP%]   .ng-scrollbar-button[scrollbarButton=end][_ngcontent-%COMP%]{_--button-rotate:-90}[dir=rtl][_nghost-%COMP%]   .ng-scrollbar-thumb[_ngcontent-%COMP%]{animation-name:_ngcontent-%COMP%_scrollbarThumbRTLAnimation;will-change:right;--_scrollbar-thumb-transform-to: calc(var(--_scrollbar-x-thumb-transform-to-value) * -1px)}[dir=rtl][_nghost-%COMP%]   .ng-scrollbar-button[scrollbarButton=start][_ngcontent-%COMP%]{--_button-rotate: 90deg}[dir=rtl][_nghost-%COMP%]   .ng-scrollbar-button[scrollbarButton=end][_ngcontent-%COMP%]{--_button-rotate: -90deg}.ng-scrollbar-track-wrapper[_ngcontent-%COMP%]{height:var(--_track-x-thickness);flex-direction:row}.ng-scrollbar-hover[_ngcontent-%COMP%]:hover, .ng-scrollbar-hover[_ngcontent-%COMP%]:active{--_track-x-thickness: var(--_scrollbar-hover-thickness-px);--_thumb-x-color: var(--INTERNAL-scrollbar-thumb-hover-color)}.ng-scrollbar-thumb[_ngcontent-%COMP%]{animation-timeline:var(--_animation-timeline-x);min-width:calc(var(--INTERNAL-scrollbar-thumb-min-size) * 1px);display:var(--_horizontal-thumb-display);background-color:var(--_thumb-x-color)}@keyframes _ngcontent-%COMP%_scrollbarThumbRTLAnimation{0%{right:var(--_scrollbar-thumb-transform-from)}to{right:calc(var(--_scrollbar-thumb-transform-to) * -1)}}"],changeDetection:0});let t=e;return t})(),x3=(()=>{let e=class e{constructor(){this.cmp=Z(Xh)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=Ie({type:e,selectors:[["scrollbars"]],decls:2,vars:2,template:function(r,o){r&1&&(ze(0,lfe,1,0,"scrollbar-y"),ze(1,cfe,1,0,"scrollbar-x")),r&2&&(Ve(o.cmp.verticalUsed()?0:-1),M(),Ve(o.cmp.horizontalUsed()?1:-1))},dependencies:[Rfe,Pfe],styles:["[_nghost-%COMP%]{display:contents}"],changeDetection:0});let t=e;return t})(),fO=(()=>{let e=class e extends vfe{constructor(){pt(()=>{let n=this.contentWrapper().nativeElement;Bs(()=>{this.viewport.init(this.nativeElement,n)})}),super(),this.contentWrapper=Bv.required("contentWrapper"),this._scrollbars=Bv.required(x3)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=Ie({type:e,selectors:[["ng-scrollbar",3,"externalViewport",""]],viewQuery:function(r,o){r&1&&(Ov(o.contentWrapper,dfe,5),Ov(o._scrollbars,x3,5)),r&2&&ed(2)},exportAs:["ngScrollbar"],features:[Xe([{provide:Xh,useExisting:e},cO]),zn],ngContentSelectors:ufe,decls:4,vars:0,consts:[["contentWrapper",""]],template:function(r,o){r&1&&(Qc(),D(0,"div",null,0),Zc(2),ee(3,"scrollbars"),F())},dependencies:[x3],styles:["[_nghost-%COMP%]{display:block;position:relative;max-height:100%;max-width:100%;--INTERNAL-scrollbar-border-radius: var(--scrollbar-border-radius, 0px);--INTERNAL-scrollbar-thickness: var(--scrollbar-thickness, 5);--INTERNAL-scrollbar-offset: var(--scrollbar-offset, 0);--INTERNAL-scrollbar-track-wrapper-transition: var(--scrollbar-track-wrapper-transition, width 60ms linear, height 60ms linear);--INTERNAL-scrollbar-track-color: var(--scrollbar-track-color, transparent);--INTERNAL-scrollbar-thumb-color: var(--scrollbar-thumb-color, rgb(0 0 0 / 20%));--INTERNAL-scrollbar-thumb-hover-color: var(--scrollbar-thumb-hover-color, var(--INTERNAL-scrollbar-thumb-color));--INTERNAL-scrollbar-hover-thickness: var(--scrollbar-hover-thickness, var(--INTERNAL-scrollbar-thickness));--INTERNAL-scrollbar-thumb-transition: var(--scrollbar-thumb-transition, none);--INTERNAL-scrollbar-thumb-min-size: var(--scrollbar-thumb-min-size, 20);--INTERNAL-scrollbar-button-color: var(--scrollbar-button-color, var(--INTERNAL-scrollbar-thumb-color));--INTERNAL-scrollbar-button-hover-color: var(--scrollbar-button-hover-color, var(--INTERNAL-scrollbar-button-color));--INTERNAL-scrollbar-button-active-color: var(--scrollbar-button-active-color, var(--INTERNAL-scrollbar-button-hover-color));--INTERNAL-scrollbar-button-fill: var(--scrollbar-button-fill, white);--INTERNAL-scrollbar-button-hover-fill: var(--scrollbar-button-hover-fill, var(--INTERNAL-scrollbar-button-fill));--INTERNAL-scrollbar-button-active-fill: var(--scrollbar-button-active-fill, var(--INTERNAL-scrollbar-button-hover-fill));--INTERNAL-scrollbar-button-size: var(--scrollbar-button-size, 20px);--INTERNAL-scrollbar-hover-opacity-transition-enter-duration: var(--scrollbar-hover-opacity-transition-enter-duration, 0);--INTERNAL-scrollbar-hover-opacity-transition-leave-duration: var(--scrollbar-hover-opacity-transition-leave-duration, .4s);--INTERNAL-scrollbar-hover-opacity-transition-leave-delay: var(--scrollbar-hover-opacity-transition-leave-delay, 1s);--INTERNAL-scrollbar-overscroll-behavior: var(--scrollbar-overscroll-behavior, initial);--INTERNAL-scrollbar-mobile-overscroll-behavior: var(--scrollbar-mobile-overscroll-behavior, none);--_scrollbar-thickness: calc(var(--INTERNAL-scrollbar-thickness) + var(--INTERNAL-scrollbar-offset) * 2);--_scrollbar-pointer-events: auto;--_scrollbar-offset-px: calc(var(--INTERNAL-scrollbar-offset) * 1px);--_scrollbar-thickness-px: calc(var(--INTERNAL-scrollbar-thickness) * 1px);--_scrollbar-hover-thickness-px: calc(var(--INTERNAL-scrollbar-hover-thickness) * 1px);--_viewport-padding-top: 0;--_viewport-padding-bottom: 0;--_viewport-padding-left: 0;--_viewport-padding-right: 0;--_horizontal-thumb-display: block;--_vertical-thumb-display: block;--_viewport-overflow: auto;--_viewport-pointer-events: auto;--_thumb-x-color: var(--INTERNAL-scrollbar-thumb-color);--_thumb-y-color: var(--INTERNAL-scrollbar-thumb-color);--_track-y-thickness: var(--_scrollbar-thickness-px);--_track-x-thickness: var(--_scrollbar-thickness-px);--_viewport-overscroll-behavior: var(--INTERNAL-scrollbar-overscroll-behavior);--_scrollbar-content-width: fit-content}[_nghost-%COMP%]{--_spacer-width: var(--spacer-width);--_spacer-height: var(--spacer-height);--_vertical-top: var(--_scrollbar-offset-px);--_vertical-bottom: var(--_scrollbar-offset-px);--_horizontal-left: var(--_scrollbar-offset-px);--_horizontal-right: var(--_scrollbar-offset-px);--_horizontal-top: initial;--_horizontal-bottom: var(--_scrollbar-offset-px);--_scrollbar-wrapper-x-top: calc(var(--viewport-height) - var(--_scrollbar-thickness));--reached-offset: 1px;--reached-offset-top: var(--reached-offset);--reached-offset-bottom: var(--reached-offset);--reached-offset-start: var(--reached-offset);--reached-offset-end: var(--reached-offset);--dropped-offset: 1px;--dropped-offset-top: var(--dropped-offset);--dropped-offset-bottom: var(--dropped-offset);--dropped-offset-start: var(--dropped-offset);--dropped-offset-end: var(--dropped-offset);--_viewport_scroll-timeline: unset;--_animation-timeline-y: unset;--_scrollbar-y-thumb-transform-to-value: unset;--_scrollbar-x-thumb-transform-to-value: unset;--_scrollbar-thumb-transform-from: unset;--_scrollbar-thumb-transform-to: unset}.ng-scrollbar-external-viewport[_nghost-%COMP%]     .ng-scroll-viewport{min-height:100%;min-width:100%;height:100%;max-height:100%;max-width:100%}.ng-scroll-viewport[_nghost-%COMP%], .ng-scrollbar-external-viewport[_nghost-%COMP%]     .ng-scroll-viewport{position:relative;overflow:var(--_viewport-overflow);scroll-timeline:var(--_viewport_scroll-timeline);box-sizing:border-box!important;-webkit-overflow-scrolling:touch;will-change:scroll-position;-webkit-user-select:var(--_viewport-user-select);user-select:var(--_viewport-user-select);overscroll-behavior:var(--_viewport-overscroll-behavior);pointer-events:var(--_viewport-pointer-events)}.ng-scroll-viewport[_nghost-%COMP%] > .ng-scroll-content[_ngcontent-%COMP%], .ng-scrollbar-external-viewport[_nghost-%COMP%]     .ng-scroll-viewport>.ng-scroll-content{width:var(--_scrollbar-content-width);z-index:1;min-width:100%;min-height:100%;contain:content;padding:var(--_viewport-padding-top, 0) var(--_viewport-padding-right, 0) var(--_viewport-padding-bottom, 0) var(--_viewport-padding-left, 0)}[appearance=native][_nghost-%COMP%]{--_spacer-width: calc(var(--spacer-width) + var(--_scrollbar-thickness));--_spacer-height: calc(var(--spacer-height) + var(--_scrollbar-thickness))}.ng-scroll-viewport[_nghost-%COMP%] > .ng-scroll-spacer[_ngcontent-%COMP%], .ng-scrollbar-external-viewport[_nghost-%COMP%]     .ng-scroll-viewport>.ng-scroll-spacer{position:relative;width:calc(var(--_spacer-width) * 1px);height:calc(var(--_spacer-height) * 1px)}.ng-scroll-viewport[_nghost-%COMP%], .ng-scrollbar-external-viewport[_nghost-%COMP%]     .ng-scroll-viewport{scrollbar-width:none!important}.ng-scroll-viewport[_nghost-%COMP%]::-webkit-scrollbar, .ng-scrollbar-external-viewport[_nghost-%COMP%]     .ng-scroll-viewport::-webkit-scrollbar{display:none!important}[position=invertX][_nghost-%COMP%], [position=invertAll][_nghost-%COMP%]{--_horizontal-top: var(--_scrollbar-offset-px);--_horizontal-bottom: initial;--_scrollbar-wrapper-x-top: 0}[dir=ltr][_nghost-%COMP%]{--_scrollbar-wrapper-y-right: initial;--_vertical-right: var(--_scrollbar-offset-px);--_vertical-left: initial;--_scrollbar-wrapper-y-left: calc(var(--viewport-width) - var(--_scrollbar-thickness))}[dir=ltr][position=invertY][_nghost-%COMP%], [dir=ltr][position=invertAll][_nghost-%COMP%]{--_vertical-left: var(--_scrollbar-offset-px);--_vertical-right: initial;--_scrollbar-wrapper-y-left: 0}[dir=rtl][_nghost-%COMP%]{--_scrollbar-wrapper-y-left: initial;--_vertical-left: var(--_scrollbar-offset-px);--_vertical-right: initial;--_scrollbar-wrapper-y-right: calc(var(--viewport-width) - var(--_scrollbar-thickness))}[dir=rtl][position=invertY][_nghost-%COMP%], [dir=rtl][position=invertAll][_nghost-%COMP%]{--_vertical-right: var(--_scrollbar-offset-px);--_vertical-left: initial;--_scrollbar-wrapper-y-right: 0}[verticalUsed=true][horizontalUsed=true][_nghost-%COMP%]{--_scrollbar-thickness-margin: calc(var(--INTERNAL-scrollbar-thickness) + var(--INTERNAL-scrollbar-offset) * 3);--_scrollbar-thickness-margin-px: calc(var(--_scrollbar-thickness-margin) * 1px)}[horizontalUsed=true][_nghost-%COMP%]{--_vertical-top: var(--_scrollbar-offset-px);--_vertical-bottom: var(--_scrollbar-thickness-margin-px)}[horizontalUsed=true][position=invertX][_nghost-%COMP%], [horizontalUsed=true][position=invertAll][_nghost-%COMP%]{--_vertical-top: var(--_scrollbar-thickness-margin-px);--_vertical-bottom: var(--_scrollbar-offset-px)}[verticalUsed=true][dir=ltr][_nghost-%COMP%]{--_horizontal-left: var(--_scrollbar-offset-px);--_horizontal-right: var(--_scrollbar-thickness-margin-px)}[verticalUsed=true][dir=rtl][_nghost-%COMP%]{--_horizontal-left: var(--_scrollbar-thickness-margin-px);--_horizontal-right: var(--_scrollbar-offset-px)}[verticalUsed=true][position=invertY][dir=ltr][_nghost-%COMP%], [verticalUsed=true][position=invertAll][dir=ltr][_nghost-%COMP%]{--_horizontal-left: var(--_scrollbar-thickness-margin-px);--_horizontal-right: var(--_scrollbar-offset-px)}[verticalUsed=true][position=invertY][dir=rtl][_nghost-%COMP%], [verticalUsed=true][position=invertAll][dir=rtl][_nghost-%COMP%]{--_horizontal-left: var(--_scrollbar-offset-px);--_horizontal-right: var(--_scrollbar-thickness-margin-px)}[appearance=native][verticalUsed=true][dir=ltr][_nghost-%COMP%]{--_viewport-padding-left: 0;--_viewport-padding-right: calc(var(--_scrollbar-thickness) * 1px)}[appearance=native][verticalUsed=true][dir=rtl][_nghost-%COMP%]{--_viewport-padding-left: calc(var(--_scrollbar-thickness) * 1px);--_viewport-padding-right: 0}[appearance=native][verticalUsed=true][position=invertY][dir=ltr][_nghost-%COMP%], [appearance=native][verticalUsed=true][position=invertAll][dir=ltr][_nghost-%COMP%]{--_viewport-padding-left: calc(var(--_scrollbar-thickness) * 1px);--_viewport-padding-right: 0}[appearance=native][verticalUsed=true][position=invertY][dir=rtl][_nghost-%COMP%], [appearance=native][verticalUsed=true][position=invertAll][dir=rtl][_nghost-%COMP%]{--_viewport-padding-left: 0;--_viewport-padding-right: calc(var(--_scrollbar-thickness) * 1px)}[appearance=native][horizontalUsed=true][_nghost-%COMP%]{--_viewport-padding-top: 0;--_viewport-padding-bottom: calc(var(--_scrollbar-thickness) * 1px)}[appearance=native][horizontalUsed=true][position=invertX][_nghost-%COMP%], [appearance=native][horizontalUsed=true][position=invertAll][_nghost-%COMP%]{--_viewport-padding-top: calc(var(--_scrollbar-thickness) * 1px);--_viewport-padding-bottom: 0}[visibility=hover][_nghost-%COMP%]{--_scrollbar-hover-opacity: 0;--_scrollbar-opacity-transition: opacity var(--INTERNAL-scrollbar-hover-opacity-transition-leave-duration) var(--INTERNAL-scrollbar-hover-opacity-transition-leave-delay)}[visibility=hover][_nghost-%COMP%]:hover, [visibility=hover][_nghost-%COMP%]:active, [visibility=hover][_nghost-%COMP%]:focus{--_scrollbar-hover-opacity: 1;--_scrollbar-opacity-transition: opacity var(--INTERNAL-scrollbar-hover-opacity-transition-enter-duration)}[dir=ltr][_nghost-%COMP%]     .scroll-reached-trigger-element[trigger=start], [dir=ltr][_nghost-%COMP%]     .scroll-dropped-trigger-element[trigger=start]{left:0;right:unset}[dir=ltr][_nghost-%COMP%]     .scroll-reached-trigger-element[trigger=end], [dir=ltr][_nghost-%COMP%]     .scroll-dropped-trigger-element[trigger=end]{right:0;left:unset}[dir=rtl][_nghost-%COMP%]     .scroll-reached-trigger-element[trigger=start], [dir=rtl][_nghost-%COMP%]     .scroll-dropped-trigger-element[trigger=start]{right:0;left:unset}[dir=rtl][_nghost-%COMP%]     .scroll-reached-trigger-element[trigger=end], [dir=rtl][_nghost-%COMP%]     .scroll-dropped-trigger-element[trigger=end]{left:0;right:unset}[_nghost-%COMP%]     .ng-scroll-reached-wrapper, [_nghost-%COMP%]     .ng-scroll-dropped-wrapper, [_nghost-%COMP%]     .scroll-reached-trigger-element, [_nghost-%COMP%]     .scroll-dropped-trigger-element{position:absolute;-webkit-user-select:none;user-select:none;pointer-events:none;z-index:-9999}[_nghost-%COMP%]     .ng-scroll-reached-wrapper, [_nghost-%COMP%]     .ng-scroll-dropped-wrapper{visibility:hidden;inset:0;min-width:calc(var(--viewport-width) * 1px);min-height:calc(var(--viewport-height) * 1px)}[_nghost-%COMP%]     [isHorizontallyScrollable=false] .scroll-reached-trigger-element[trigger=end], [_nghost-%COMP%]     [isHorizontallyScrollable=false] .scroll-dropped-trigger-element[trigger=end]{display:none}[_nghost-%COMP%]     [isVerticallyScrollable=false] .scroll-reached-trigger-element[trigger=bottom], [_nghost-%COMP%]     [isVerticallyScrollable=false] .scroll-dropped-trigger-element[trigger=bottom]{display:none}[_nghost-%COMP%]     .scroll-reached-trigger-element{background:red}[_nghost-%COMP%]     .scroll-reached-trigger-element[trigger=top], [_nghost-%COMP%]     .scroll-reached-trigger-element[trigger=bottom]{left:0;right:0}[_nghost-%COMP%]     .scroll-reached-trigger-element[trigger=start], [_nghost-%COMP%]     .scroll-reached-trigger-element[trigger=end]{top:0;bottom:0}[_nghost-%COMP%]     .scroll-reached-trigger-element[trigger=top]{top:0;height:var(--reached-offset-top)}[_nghost-%COMP%]     .scroll-reached-trigger-element[trigger=bottom]{bottom:0;height:var(--reached-offset-bottom)}[_nghost-%COMP%]     .scroll-reached-trigger-element[trigger=start]{width:var(--reached-offset-start)}[_nghost-%COMP%]     .scroll-reached-trigger-element[trigger=end]{width:var(--reached-offset-end)}[_nghost-%COMP%]   .scroll-dropped-trigger-element[_ngcontent-%COMP%]{background:#00f}[_nghost-%COMP%]   .scroll-dropped-trigger-element[trigger=top][_ngcontent-%COMP%], [_nghost-%COMP%]   .scroll-dropped-trigger-element[trigger=bottom][_ngcontent-%COMP%]{left:0;right:0}[_nghost-%COMP%]   .scroll-dropped-trigger-element[trigger=start][_ngcontent-%COMP%], [_nghost-%COMP%]   .scroll-dropped-trigger-element[trigger=end][_ngcontent-%COMP%]{top:0;bottom:0}[_nghost-%COMP%]   .scroll-dropped-trigger-element[trigger=top][_ngcontent-%COMP%]{top:0;height:var(--dropped-offset-top)}[_nghost-%COMP%]   .scroll-dropped-trigger-element[trigger=bottom][_ngcontent-%COMP%]{bottom:0;height:var(--dropped-offset-bottom)}[_nghost-%COMP%]   .scroll-dropped-trigger-element[trigger=start][_ngcontent-%COMP%]{width:var(--dropped-offset-start)}[_nghost-%COMP%]   .scroll-dropped-trigger-element[trigger=end][_ngcontent-%COMP%]{width:var(--dropped-offset-end)}[verticalUsed=true][_nghost-%COMP%]{--_timeline-scope: --scrollerY;--_animation-timeline-y: --scrollerY;--_viewport_scroll-timeline: --scrollerY y}[horizontalUsed=true][_nghost-%COMP%]{--_timeline-scope: --scrollerX;--_animation-timeline-x: --scrollerX;--_viewport_scroll-timeline: --scrollerX x}[verticalUsed=true][horizontalUsed=true][_nghost-%COMP%]{--_timeline-scope: --scrollerX, --scrollerY;--_viewport_scroll-timeline: --scrollerX x, --scrollerY y}[orientation=vertical][_nghost-%COMP%]{--_viewport-overflow: hidden auto;--_scrollbar-content-width: unset}[orientation=horizontal][_nghost-%COMP%]{--_viewport-overflow: auto hidden}[disableInteraction=true][_nghost-%COMP%]{--_viewport-pointer-events: none;--_scrollbar-pointer-events: none}[isVerticallyScrollable=false][_nghost-%COMP%]{--_vertical-thumb-display: none}[isHorizontallyScrollable=false][_nghost-%COMP%]{--_horizontal-thumb-display: none}[dragging=x][_nghost-%COMP%], [dragging=y][_nghost-%COMP%]{--_viewport-user-select: none}[dragging=x][_nghost-%COMP%]{--_track-x-thickness: calc(var(--INTERNAL-scrollbar-hover-thickness) * 1px);--_thumb-x-color: var(var(--INTERNAL-scrollbar-thumb-min-size))}[dragging=y][_nghost-%COMP%]{--_track-y-thickness: calc(var(--INTERNAL-scrollbar-hover-thickness) * 1px);--_thumb-y-color: var(var(--INTERNAL-scrollbar-thumb-min-size))}[mobile=true][_nghost-%COMP%]{--_viewport-overscroll-behavior: var(--INTERNAL-scrollbar-mobile-overscroll-behavior)}"],changeDetection:0});let t=e;return t})();var gO=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Xc({type:e}),e.\u0275inj=Kc({});let t=e;return t})();function kfe(t,e){if(t&1){let i=je();D(0,"button",15),te("click",function(){let r=ie(i).$implicit,o=X().$implicit;return X().onIconClick(r),ne(o.close())}),ee(1,"ng-icon",16),F()}if(t&2){let i=e.$implicit,n=X(2);de("variant",n.selectedIcon()===i?"default":"outline")("title",i),M(),de("name",i)}}function Ffe(t,e){t&1&&(D(0,"div",13),se(1),fe(2,"transloco"),F()),t&2&&(M(),Ke(" ",ge(2,1,"flexibleItems.iconPicker.noResults")," "))}function Tfe(t,e){if(t&1&&(D(0,"div",14)(1,"span"),se(2),fe(3,"transloco"),F(),D(4,"code",17),se(5),F()()),t&2){let i=X(2);M(2),Ke("",ge(3,2,"flexibleItems.iconPicker.selected"),":"),M(3),Ze(i.selectedIcon())}}function Dfe(t,e){if(t&1){let i=je();D(0,"div",5)(1,"div",6)(2,"div",7)(3,"label",8),se(4),fe(5,"transloco"),F(),D(6,"input",9),fe(7,"transloco"),te("input",function(r){ie(i);let o=X();return ne(o.onSearchChange(r.target.value))}),F()(),D(8,"ng-scrollbar",10)(9,"div",11),Vn(10,kfe,2,3,"button",12,fx),ze(12,Ffe,3,3,"div",13),F()(),ze(13,Tfe,6,4,"div",14),F()()}if(t&2){let i=X();M(4),Ze(ge(5,5,"flexibleItems.iconPicker.searchLabel")),M(2),de("value",i.searchTerm())("placeholder",ge(7,7,"flexibleItems.iconPicker.searchPlaceholder")),M(4),Gn(i.filteredIcons()),M(2),Ve(i.filteredIcons().length===0?12:-1),M(),Ve(i.selectedIcon()?13:-1)}}var mO=(()=>{class t{selectedIcon=ve("lucideBox");disabled=ve(!1);allIcons=ve(Object.keys(Hs));searchTerm=ve("");filteredIcons=Fe(()=>{let i=this.searchTerm().toLowerCase();return i?this.allIcons().filter(n=>n.toLowerCase().includes(i)):this.allIcons()});onIconClick(i){this.disabled()||(this.selectedIcon.set(i),this.onChange(i),this.onTouched())}onSearchChange(i){this.searchTerm.set(i)}onChange=()=>{};onTouched=()=>{};writeValue(i){i&&this.selectedIcon.set(i)}registerOnChange(i){this.onChange=i}registerOnTouched(i){this.onTouched=i}setDisabledState(i){this.disabled.set(i)}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=Ie({type:t,selectors:[["gh-icon-picker"]],features:[Xe([vi(Hs),{provide:gp,useExisting:ap(()=>t),multi:!0}])],decls:5,vars:2,consts:[[3,"closeDelay"],["type","button","hlmPopoverTrigger","","hlmBtn","","variant","outline",1,"h-16","w-16","rounded-full","p-0"],[1,"h-14","w-14","flex","items-center","justify-center"],["hlm","","hlmAvatarFallback","","size","sm",3,"name"],["hlmPopoverContent","","class","w-[400px] p-4",4,"brnPopoverContent"],["hlmPopoverContent","",1,"w-[400px]","p-4"],[1,"space-y-4"],[1,"space-y-2"],["hlmLabel","","for","icon-search"],["hlmInput","","id","icon-search","type","text",3,"input","value","placeholder"],["hlm","",1,"h-[300px]","w-full","rounded-md","border","p-2"],["scrollViewport","",1,"grid","grid-cols-6","gap-2"],["type","button","hlmBtn","","size","icon",1,"h-10","w-10",3,"variant","title"],[1,"col-span-full","text-center","py-4","text-muted-foreground","text-sm"],[1,"flex","items-center","gap-2","text-xs","text-muted-foreground","pt-2","border-t"],["type","button","hlmBtn","","size","icon",1,"h-10","w-10",3,"click","variant","title"],["hlm","","size","sm",3,"name"],[1,"text-xs","font-mono"]],template:function(n,r){n&1&&(D(0,"hlm-popover",0)(1,"button",1)(2,"hlm-avatar",2),ee(3,"ng-icon",3),F()(),ar(4,Dfe,14,9,"div",4),F()),n&2&&(de("closeDelay",100),M(3),de("name",r.selectedIcon()))},dependencies:[il,wn,cE,iE,nE,_t,wi,Ci,bn,yn,dE,uE,hE,S3,gO,fO,lO,Cn],encapsulation:2,changeDetection:0})}return t})();function D3(t){let e=t.cloneNode(!0),i=e.querySelectorAll("[id]"),n=t.nodeName.toLowerCase();e.removeAttribute("id");for(let r=0;r<i.length;r++)i[r].removeAttribute("id");return n==="canvas"?wO(t,e):(n==="input"||n==="select"||n==="textarea")&&CO(t,e),vO("canvas",t,e,wO),vO("input, textarea, select",t,e,CO),e}function vO(t,e,i,n){let r=e.querySelectorAll(t);if(r.length){let o=i.querySelectorAll(t);for(let s=0;s<r.length;s++)n(r[s],o[s])}}var Mfe=0;function CO(t,e){e.type!=="file"&&(e.value=t.value),e.type==="radio"&&e.name&&(e.name=`mat-clone-${e.name}-${Mfe++}`)}function wO(t,e){let i=e.getContext("2d");if(i)try{i.drawImage(t,0,0)}catch{}}function N3(t){let e=t.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height,x:e.x,y:e.y}}function M3(t,e,i){let{top:n,bottom:r,left:o,right:s}=t;return i>=n&&i<=r&&e>=o&&e<=s}function Ife(t,e){let i=e.left<t.left,n=e.left+e.width>t.right,r=e.top<t.top,o=e.top+e.height>t.bottom;return i||n||r||o}function ip(t,e,i){t.top+=e,t.bottom=t.top+t.height,t.left+=i,t.right=t.left+t.width}function bO(t,e,i,n){let{top:r,right:o,bottom:s,left:a,width:l,height:c}=t,d=l*e,u=c*e;return n>r-u&&n<s+u&&i>a-d&&i<o+d}var bv=class{_document;positions=new Map;constructor(e){this._document=e}clear(){this.positions.clear()}cache(e){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),e.forEach(i=>{this.positions.set(i,{scrollPosition:{top:i.scrollTop,left:i.scrollLeft},clientRect:N3(i)})})}handleScroll(e){let i=sd(e),n=this.positions.get(i);if(!n)return null;let r=n.scrollPosition,o,s;if(i===this._document){let c=this.getViewportScrollPosition();o=c.top,s=c.left}else o=i.scrollTop,s=i.scrollLeft;let a=r.top-o,l=r.left-s;return this.positions.forEach((c,d)=>{c.clientRect&&i!==d&&i.contains(d)&&ip(c.clientRect,a,l)}),r.top=o,r.left=s,{top:a,left:l}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}};function IO(t,e){let i=t.rootNodes;if(i.length===1&&i[0].nodeType===e.ELEMENT_NODE)return i[0];let n=e.createElement("div");return i.forEach(r=>n.appendChild(r)),n}function B3(t,e,i){for(let n in e)if(e.hasOwnProperty(n)){let r=e[n];r?t.setProperty(n,r,i?.has(n)?"important":""):t.removeProperty(n)}return t}function Bc(t,e){let i=e?"":"none";B3(t.style,{"touch-action":e?"":"none","-webkit-user-drag":e?"":"none","-webkit-tap-highlight-color":e?"":"transparent","user-select":i,"-ms-user-select":i,"-webkit-user-select":i,"-moz-user-select":i})}function yO(t,e,i){B3(t.style,{position:e?"":"fixed",top:e?"":"0",opacity:e?"":"0",left:e?"":"-999em"},i)}function yv(t,e){return e&&e!="none"?t+" "+e:t}function SO(t,e){t.style.width=`${e.width}px`,t.style.height=`${e.height}px`,t.style.transform=np(e.left,e.top)}function np(t,e){return`translate3d(${Math.round(t)}px, ${Math.round(e)}px, 0)`}function xO(t){let e=t.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(t)*e}function Afe(t){let e=getComputedStyle(t),i=F3(e,"transition-property"),n=i.find(a=>a==="transform"||a==="all");if(!n)return 0;let r=i.indexOf(n),o=F3(e,"transition-duration"),s=F3(e,"transition-delay");return xO(o[r])+xO(s[r])}function F3(t,e){return t.getPropertyValue(e).split(",").map(n=>n.trim())}var Ofe=new Set(["position"]),I3=class{_document;_rootElement;_direction;_initialDomRect;_previewTemplate;_previewClass;_pickupPositionOnPage;_initialTransform;_zIndex;_renderer;_previewEmbeddedView;_preview;get element(){return this._preview}constructor(e,i,n,r,o,s,a,l,c,d){this._document=e,this._rootElement=i,this._direction=n,this._initialDomRect=r,this._previewTemplate=o,this._previewClass=s,this._pickupPositionOnPage=a,this._initialTransform=l,this._zIndex=c,this._renderer=d}attach(e){this._preview=this._createPreview(),e.appendChild(this._preview),EO(this._preview)&&this._preview.showPopover()}destroy(){this._preview.remove(),this._previewEmbeddedView?.destroy(),this._preview=this._previewEmbeddedView=null}setTransform(e){this._preview.style.transform=e}getBoundingClientRect(){return this._preview.getBoundingClientRect()}addClass(e){this._preview.classList.add(e)}getTransitionDuration(){return Afe(this._preview)}addEventListener(e,i){return this._renderer.listen(this._preview,e,i)}_createPreview(){let e=this._previewTemplate,i=this._previewClass,n=e?e.template:null,r;if(n&&e){let o=e.matchSize?this._initialDomRect:null,s=e.viewContainer.createEmbeddedView(n,e.context);s.detectChanges(),r=IO(s,this._document),this._previewEmbeddedView=s,e.matchSize?SO(r,o):r.style.transform=np(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else r=D3(this._rootElement),SO(r,this._initialDomRect),this._initialTransform&&(r.style.transform=this._initialTransform);return B3(r.style,{"pointer-events":"none",margin:EO(r)?"0 auto 0 0":"0",position:"fixed",top:"0",left:"0","z-index":this._zIndex+""},Ofe),Bc(r,!1),r.classList.add("cdk-drag-preview"),r.setAttribute("popover","manual"),r.setAttribute("dir",this._direction),i&&(Array.isArray(i)?i.forEach(o=>r.classList.add(o)):r.classList.add(i)),r}};function EO(t){return"showPopover"in t}var Lfe={passive:!0},PO={passive:!1},Nfe={passive:!1,capture:!0},Bfe=800,RO="cdk-drag-placeholder",_O=new Set(["position"]),A3=class{_config;_document;_ngZone;_viewportRuler;_dragDropRegistry;_renderer;_rootElementCleanups;_cleanupShadowRootSelectStart;_preview;_previewContainer;_placeholderRef;_placeholder;_pickupPositionInElement;_pickupPositionOnPage;_marker;_anchor=null;_passiveTransform={x:0,y:0};_activeTransform={x:0,y:0};_initialTransform;_hasStartedDragging=ve(!1);_hasMoved;_initialContainer;_initialIndex;_parentPositions;_moveEvents=new bt;_pointerDirectionDelta;_pointerPositionAtLastDirectionChange;_lastKnownPointerPosition;_rootElement;_ownerSVGElement;_rootElementTapHighlight;_pointerMoveSubscription=$a.EMPTY;_pointerUpSubscription=$a.EMPTY;_scrollSubscription=$a.EMPTY;_resizeSubscription=$a.EMPTY;_lastTouchEventTime;_dragStartTime;_boundaryElement=null;_nativeInteractionsEnabled=!0;_initialDomRect;_previewRect;_boundaryRect;_previewTemplate;_placeholderTemplate;_handles=[];_disabledHandles=new Set;_dropContainer;_direction="ltr";_parentDragRef;_cachedShadowRoot;lockAxis=null;dragStartDelay=0;previewClass;scale=1;get disabled(){return this._disabled||!!(this._dropContainer&&this._dropContainer.disabled)}set disabled(e){e!==this._disabled&&(this._disabled=e,this._toggleNativeDragInteractions(),this._handles.forEach(i=>Bc(i,e)))}_disabled=!1;beforeStarted=new bt;started=new bt;released=new bt;ended=new bt;entered=new bt;exited=new bt;dropped=new bt;moved=this._moveEvents;data;constrainPosition;constructor(e,i,n,r,o,s,a){this._config=i,this._document=n,this._ngZone=r,this._viewportRuler=o,this._dragDropRegistry=s,this._renderer=a,this.withRootElement(e).withParent(i.parentDragRef||null),this._parentPositions=new bv(n),s.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(e){this._handles=e.map(n=>$n(n)),this._handles.forEach(n=>Bc(n,this.disabled)),this._toggleNativeDragInteractions();let i=new Set;return this._disabledHandles.forEach(n=>{this._handles.indexOf(n)>-1&&i.add(n)}),this._disabledHandles=i,this}withPreviewTemplate(e){return this._previewTemplate=e,this}withPlaceholderTemplate(e){return this._placeholderTemplate=e,this}withRootElement(e){let i=$n(e);if(i!==this._rootElement){this._removeRootElementListeners();let n=this._renderer;this._rootElementCleanups=this._ngZone.runOutsideAngular(()=>[n.listen(i,"mousedown",this._pointerDown,PO),n.listen(i,"touchstart",this._pointerDown,Lfe),n.listen(i,"dragstart",this._nativeDragStart,PO)]),this._initialTransform=void 0,this._rootElement=i}return typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(e){return this._boundaryElement=e?$n(e):null,this._resizeSubscription.unsubscribe(),e&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(e){return this._parentDragRef=e,this}dispose(){this._removeRootElementListeners(),this.isDragging()&&this._rootElement?.remove(),this._marker?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeListeners(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._marker=this._parentDragRef=null}isDragging(){return this._hasStartedDragging()&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}resetToBoundary(){if(this._boundaryElement&&this._rootElement&&Ife(this._boundaryElement.getBoundingClientRect(),this._rootElement.getBoundingClientRect())){let e=this._boundaryElement.getBoundingClientRect(),i=this._rootElement.getBoundingClientRect(),n=0,r=0;i.left<e.left?n=e.left-i.left:i.right>e.right&&(n=e.right-i.right),i.top<e.top?r=e.top-i.top:i.bottom>e.bottom&&(r=e.bottom-i.bottom);let o=this._activeTransform.x,s=this._activeTransform.y,a=o+n,l=s+r;this._rootElement.style.transform=np(a,l),this._activeTransform={x:a,y:l},this._passiveTransform={x:a,y:l}}}disableHandle(e){!this._disabledHandles.has(e)&&this._handles.indexOf(e)>-1&&(this._disabledHandles.add(e),Bc(e,!0))}enableHandle(e){this._disabledHandles.has(e)&&(this._disabledHandles.delete(e),Bc(e,this.disabled))}withDirection(e){return this._direction=e,this}_withDropContainer(e){this._dropContainer=e}getFreeDragPosition(){let e=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:e.x,y:e.y}}setFreeDragPosition(e){return this._activeTransform={x:0,y:0},this._passiveTransform.x=e.x,this._passiveTransform.y=e.y,this._dropContainer||this._applyRootElementTransform(e.x,e.y),this}withPreviewContainer(e){return this._previewContainer=e,this}_sortFromLastPointerPosition(){let e=this._lastKnownPointerPosition;e&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(e),e)}_removeListeners(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe(),this._cleanupShadowRootSelectStart?.(),this._cleanupShadowRootSelectStart=void 0}_destroyPreview(){this._preview?.destroy(),this._preview=null}_destroyPlaceholder(){this._anchor?.remove(),this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._anchor=this._placeholderRef=null}_pointerDown=e=>{if(this.beforeStarted.next(),this._handles.length){let i=this._getTargetHandle(e);i&&!this._disabledHandles.has(i)&&!this.disabled&&this._initializeDragSequence(i,e)}else this.disabled||this._initializeDragSequence(this._rootElement,e)};_pointerMove=e=>{let i=this._getPointerPositionOnPage(e);if(!this._hasStartedDragging()){let r=Math.abs(i.x-this._pickupPositionOnPage.x),o=Math.abs(i.y-this._pickupPositionOnPage.y);if(r+o>=this._config.dragStartThreshold){let a=Date.now()>=this._dragStartTime+this._getDragStartDelay(e),l=this._dropContainer;if(!a){this._endDragSequence(e);return}(!l||!l.isDragging()&&!l.isReceiving())&&(e.cancelable&&e.preventDefault(),this._hasStartedDragging.set(!0),this._ngZone.run(()=>this._startDragSequence(e)))}return}e.cancelable&&e.preventDefault();let n=this._getConstrainedPointerPosition(i);if(this._hasMoved=!0,this._lastKnownPointerPosition=i,this._updatePointerDirectionDelta(n),this._dropContainer)this._updateActiveDropContainer(n,i);else{let r=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,o=this._activeTransform;o.x=n.x-r.x+this._passiveTransform.x,o.y=n.y-r.y+this._passiveTransform.y,this._applyRootElementTransform(o.x,o.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:n,event:e,distance:this._getDragDistance(n),delta:this._pointerDirectionDelta})})};_pointerUp=e=>{this._endDragSequence(e)};_endDragSequence(e){if(this._dragDropRegistry.isDragging(this)&&(this._removeListeners(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),!!this._hasStartedDragging()))if(this.released.next({source:this,event:e}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(e),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;let i=this._getPointerPositionOnPage(e);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(i),dropPoint:i,event:e})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(e){ep(e)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();let i=this._getShadowRoot(),n=this._dropContainer;if(i&&this._ngZone.runOutsideAngular(()=>{this._cleanupShadowRootSelectStart=this._renderer.listen(i,"selectstart",Hfe,Nfe)}),n){let r=this._rootElement,o=r.parentNode,s=this._placeholder=this._createPlaceholderElement(),a=this._marker=this._marker||this._document.createComment("");o.insertBefore(a,r),this._initialTransform=r.style.transform||"",this._preview=new I3(this._document,this._rootElement,this._direction,this._initialDomRect,this._previewTemplate||null,this.previewClass||null,this._pickupPositionOnPage,this._initialTransform,this._config.zIndex||1e3,this._renderer),this._preview.attach(this._getPreviewInsertionPoint(o,i)),yO(r,!1,_O),this._document.body.appendChild(o.replaceChild(s,r)),this.started.next({source:this,event:e}),n.start(),this._initialContainer=n,this._initialIndex=n.getItemIndex(this)}else this.started.next({source:this,event:e}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(n?n.getScrollableParents():[])}_initializeDragSequence(e,i){this._parentDragRef&&i.stopPropagation();let n=this.isDragging(),r=ep(i),o=!r&&i.button!==0,s=this._rootElement,a=sd(i),l=!r&&this._lastTouchEventTime&&this._lastTouchEventTime+Bfe>Date.now(),c=r?tE(i):eE(i);if(a&&a.draggable&&i.type==="mousedown"&&i.preventDefault(),n||o||l||c)return;if(this._handles.length){let h=s.style;this._rootElementTapHighlight=h.webkitTapHighlightColor||"",h.webkitTapHighlightColor="transparent"}this._hasMoved=!1,this._hasStartedDragging.set(this._hasMoved),this._removeListeners(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(h=>this._updateOnScroll(h)),this._boundaryElement&&(this._boundaryRect=N3(this._boundaryElement));let d=this._previewTemplate;this._pickupPositionInElement=d&&d.template&&!d.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,e,i);let u=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(i);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:u.x,y:u.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,i)}_cleanupDragArtifacts(e){yO(this._rootElement,!0,_O),this._marker.parentNode.replaceChild(this._rootElement,this._marker),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{let i=this._dropContainer,n=i.getItemIndex(this),r=this._getPointerPositionOnPage(e),o=this._getDragDistance(r),s=i._isOverContainer(r.x,r.y);this.ended.next({source:this,distance:o,dropPoint:r,event:e}),this.dropped.next({item:this,currentIndex:n,previousIndex:this._initialIndex,container:i,previousContainer:this._initialContainer,isPointerOverContainer:s,distance:o,dropPoint:r,event:e}),i.drop(this,n,this._initialIndex,this._initialContainer,s,o,r,e),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:e,y:i},{x:n,y:r}){let o=this._initialContainer._getSiblingContainerFromPosition(this,e,i);!o&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(e,i)&&(o=this._initialContainer),o&&o!==this._dropContainer&&this._ngZone.run(()=>{let s=this._dropContainer.getItemIndex(this),a=this._dropContainer.getItemAtIndex(s+1)?.getVisibleElement()||null;this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._conditionallyInsertAnchor(o,this._dropContainer,a),this._dropContainer=o,this._dropContainer.enter(this,e,i,o===this._initialContainer&&o.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:o,currentIndex:o.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(n,r),this._dropContainer._sortItem(this,e,i,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(e,i):this._applyPreviewTransform(e-this._pickupPositionInElement.x,i-this._pickupPositionInElement.y))}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();let e=this._placeholder.getBoundingClientRect();this._preview.addClass("cdk-drag-animating"),this._applyPreviewTransform(e.left,e.top);let i=this._preview.getTransitionDuration();return i===0?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(n=>{let r=a=>{(!a||this._preview&&sd(a)===this._preview.element&&a.propertyName==="transform")&&(s(),n(),clearTimeout(o))},o=setTimeout(r,i*1.5),s=this._preview.addEventListener("transitionend",r)}))}_createPlaceholderElement(){let e=this._placeholderTemplate,i=e?e.template:null,n;return i?(this._placeholderRef=e.viewContainer.createEmbeddedView(i,e.context),this._placeholderRef.detectChanges(),n=IO(this._placeholderRef,this._document)):n=D3(this._rootElement),n.style.pointerEvents="none",n.classList.add(RO),n}_getPointerPositionInElement(e,i,n){let r=i===this._rootElement?null:i,o=r?r.getBoundingClientRect():e,s=ep(n)?n.targetTouches[0]:n,a=this._getViewportScrollPosition(),l=s.pageX-o.left-a.left,c=s.pageY-o.top-a.top;return{x:o.left-e.left+l,y:o.top-e.top+c}}_getPointerPositionOnPage(e){let i=this._getViewportScrollPosition(),n=ep(e)?e.touches[0]||e.changedTouches[0]||{pageX:0,pageY:0}:e,r=n.pageX-i.left,o=n.pageY-i.top;if(this._ownerSVGElement){let s=this._ownerSVGElement.getScreenCTM();if(s){let a=this._ownerSVGElement.createSVGPoint();return a.x=r,a.y=o,a.matrixTransform(s.inverse())}}return{x:r,y:o}}_getConstrainedPointerPosition(e){let i=this._dropContainer?this._dropContainer.lockAxis:null,{x:n,y:r}=this.constrainPosition?this.constrainPosition(e,this,this._initialDomRect,this._pickupPositionInElement):e;if(this.lockAxis==="x"||i==="x"?r=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):(this.lockAxis==="y"||i==="y")&&(n=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){let{x:o,y:s}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,a=this._boundaryRect,{width:l,height:c}=this._getPreviewRect(),d=a.top+s,u=a.bottom-(c-s),h=a.left+o,p=a.right-(l-o);n=kO(n,h,p),r=kO(r,d,u)}return{x:n,y:r}}_updatePointerDirectionDelta(e){let{x:i,y:n}=e,r=this._pointerDirectionDelta,o=this._pointerPositionAtLastDirectionChange,s=Math.abs(i-o.x),a=Math.abs(n-o.y);return s>this._config.pointerDirectionChangeThreshold&&(r.x=i>o.x?1:-1,o.x=i),a>this._config.pointerDirectionChangeThreshold&&(r.y=n>o.y?1:-1,o.y=n),r}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;let e=this._handles.length>0||!this.isDragging();e!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=e,Bc(this._rootElement,e))}_removeRootElementListeners(){this._rootElementCleanups?.forEach(e=>e()),this._rootElementCleanups=void 0}_applyRootElementTransform(e,i){let n=1/this.scale,r=np(e*n,i*n),o=this._rootElement.style;this._initialTransform==null&&(this._initialTransform=o.transform&&o.transform!="none"?o.transform:""),o.transform=yv(r,this._initialTransform)}_applyPreviewTransform(e,i){let n=this._previewTemplate?.template?void 0:this._initialTransform,r=np(e,i);this._preview.setTransform(yv(r,n))}_getDragDistance(e){let i=this._pickupPositionOnPage;return i?{x:e.x-i.x,y:e.y-i.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:e,y:i}=this._passiveTransform;if(e===0&&i===0||this.isDragging()||!this._boundaryElement)return;let n=this._rootElement.getBoundingClientRect(),r=this._boundaryElement.getBoundingClientRect();if(r.width===0&&r.height===0||n.width===0&&n.height===0)return;let o=r.left-n.left,s=n.right-r.right,a=r.top-n.top,l=n.bottom-r.bottom;r.width>n.width?(o>0&&(e+=o),s>0&&(e-=s)):e=0,r.height>n.height?(a>0&&(i+=a),l>0&&(i-=l)):i=0,(e!==this._passiveTransform.x||i!==this._passiveTransform.y)&&this.setFreeDragPosition({y:i,x:e})}_getDragStartDelay(e){let i=this.dragStartDelay;return typeof i=="number"?i:ep(e)?i.touch:i?i.mouse:0}_updateOnScroll(e){let i=this._parentPositions.handleScroll(e);if(i){let n=sd(e);this._boundaryRect&&n!==this._boundaryElement&&n.contains(this._boundaryElement)&&ip(this._boundaryRect,i.top,i.left),this._pickupPositionOnPage.x+=i.left,this._pickupPositionOnPage.y+=i.top,this._dropContainer||(this._activeTransform.x-=i.left,this._activeTransform.y-=i.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return this._cachedShadowRoot===void 0&&(this._cachedShadowRoot=vp(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(e,i){let n=this._previewContainer||"global";if(n==="parent")return e;if(n==="global"){let r=this._document;return i||r.fullscreenElement||r.webkitFullscreenElement||r.mozFullScreenElement||r.msFullscreenElement||r.body}return $n(n)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_nativeDragStart=e=>{if(this._handles.length){let i=this._getTargetHandle(e);i&&!this._disabledHandles.has(i)&&!this.disabled&&e.preventDefault()}else this.disabled||e.preventDefault()};_getTargetHandle(e){return this._handles.find(i=>e.target&&(e.target===i||i.contains(e.target)))}_conditionallyInsertAnchor(e,i,n){if(e===this._initialContainer)this._anchor?.remove(),this._anchor=null;else if(i===this._initialContainer&&i.hasAnchor){let r=this._anchor??=D3(this._placeholder);r.classList.remove(RO),r.classList.add("cdk-drag-anchor"),r.style.transform="",n?n.before(r):$n(i.element).appendChild(r)}}};function kO(t,e,i){return Math.max(e,Math.min(i,t))}function ep(t){return t.type[0]==="t"}function Hfe(t){t.preventDefault()}function xv(t,e,i){let n=FO(e,t.length-1),r=FO(i,t.length-1);if(n===r)return;let o=t[n],s=r<n?-1:1;for(let a=n;a!==r;a+=s)t[a]=t[a+s];t[r]=o}function FO(t,e){return Math.max(0,Math.min(e,t))}var Sv=class{_dragDropRegistry;_element;_sortPredicate;_itemPositions=[];_activeDraggables;orientation="vertical";direction;constructor(e){this._dragDropRegistry=e}_previousSwap={drag:null,delta:0,overlaps:!1};start(e){this.withItems(e)}sort(e,i,n,r){let o=this._itemPositions,s=this._getItemIndexFromPointerPosition(e,i,n,r);if(s===-1&&o.length>0)return null;let a=this.orientation==="horizontal",l=o.findIndex(m=>m.drag===e),c=o[s],d=o[l].clientRect,u=c.clientRect,h=l>s?1:-1,p=this._getItemOffsetPx(d,u,h),f=this._getSiblingOffsetPx(l,o,h),g=o.slice();return xv(o,l,s),o.forEach((m,v)=>{if(g[v]===m)return;let C=m.drag===e,b=C?p:f,S=C?e.getPlaceholderElement():m.drag.getRootElement();m.offset+=b;let x=Math.round(m.offset*(1/m.drag.scale));a?(S.style.transform=yv(`translate3d(${x}px, 0, 0)`,m.initialTransform),ip(m.clientRect,0,b)):(S.style.transform=yv(`translate3d(0, ${x}px, 0)`,m.initialTransform),ip(m.clientRect,b,0))}),this._previousSwap.overlaps=M3(u,i,n),this._previousSwap.drag=c.drag,this._previousSwap.delta=a?r.x:r.y,{previousIndex:l,currentIndex:s}}enter(e,i,n,r){let o=r==null||r<0?this._getItemIndexFromPointerPosition(e,i,n):r,s=this._activeDraggables,a=s.indexOf(e),l=e.getPlaceholderElement(),c=s[o];if(c===e&&(c=s[o+1]),!c&&(o==null||o===-1||o<s.length-1)&&this._shouldEnterAsFirstChild(i,n)&&(c=s[0]),a>-1&&s.splice(a,1),c&&!this._dragDropRegistry.isDragging(c)){let d=c.getRootElement();d.parentElement.insertBefore(l,d),s.splice(o,0,e)}else this._element.appendChild(l),s.push(e);l.style.transform="",this._cacheItemPositions()}withItems(e){this._activeDraggables=e.slice(),this._cacheItemPositions()}withSortPredicate(e){this._sortPredicate=e}reset(){this._activeDraggables?.forEach(e=>{let i=e.getRootElement();if(i){let n=this._itemPositions.find(r=>r.drag===e)?.initialTransform;i.style.transform=n||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(e){return this._getVisualItemPositions().findIndex(i=>i.drag===e)}getItemAtIndex(e){return this._getVisualItemPositions()[e]?.drag||null}updateOnScroll(e,i){this._itemPositions.forEach(({clientRect:n})=>{ip(n,e,i)}),this._itemPositions.forEach(({drag:n})=>{this._dragDropRegistry.isDragging(n)&&n._sortFromLastPointerPosition()})}withElementContainer(e){this._element=e}_cacheItemPositions(){let e=this.orientation==="horizontal";this._itemPositions=this._activeDraggables.map(i=>{let n=i.getVisibleElement();return{drag:i,offset:0,initialTransform:n.style.transform||"",clientRect:N3(n)}}).sort((i,n)=>e?i.clientRect.left-n.clientRect.left:i.clientRect.top-n.clientRect.top)}_getVisualItemPositions(){return this.orientation==="horizontal"&&this.direction==="rtl"?this._itemPositions.slice().reverse():this._itemPositions}_getItemOffsetPx(e,i,n){let r=this.orientation==="horizontal",o=r?i.left-e.left:i.top-e.top;return n===-1&&(o+=r?i.width-e.width:i.height-e.height),o}_getSiblingOffsetPx(e,i,n){let r=this.orientation==="horizontal",o=i[e].clientRect,s=i[e+n*-1],a=o[r?"width":"height"]*n;if(s){let l=r?"left":"top",c=r?"right":"bottom";n===-1?a-=s.clientRect[l]-o[c]:a+=o[l]-s.clientRect[c]}return a}_shouldEnterAsFirstChild(e,i){if(!this._activeDraggables.length)return!1;let n=this._itemPositions,r=this.orientation==="horizontal";if(n[0].drag!==this._activeDraggables[0]){let s=n[n.length-1].clientRect;return r?e>=s.right:i>=s.bottom}else{let s=n[0].clientRect;return r?e<=s.left:i<=s.top}}_getItemIndexFromPointerPosition(e,i,n,r){let o=this.orientation==="horizontal",s=this._itemPositions.findIndex(({drag:a,clientRect:l})=>{if(a===e)return!1;if(r){let c=o?r.x:r.y;if(a===this._previousSwap.drag&&this._previousSwap.overlaps&&c===this._previousSwap.delta)return!1}return o?i>=Math.floor(l.left)&&i<Math.floor(l.right):n>=Math.floor(l.top)&&n<Math.floor(l.bottom)});return s===-1||!this._sortPredicate(s,e)?-1:s}},O3=class{_document;_dragDropRegistry;_element;_sortPredicate;_rootNode;_activeItems;_previousSwap={drag:null,deltaX:0,deltaY:0,overlaps:!1};_relatedNodes=[];constructor(e,i){this._document=e,this._dragDropRegistry=i}start(e){let i=this._element.childNodes;this._relatedNodes=[];for(let n=0;n<i.length;n++){let r=i[n];this._relatedNodes.push([r,r.nextSibling])}this.withItems(e)}sort(e,i,n,r){let o=this._getItemIndexFromPointerPosition(e,i,n),s=this._previousSwap;if(o===-1||this._activeItems[o]===e)return null;let a=this._activeItems[o];if(s.drag===a&&s.overlaps&&s.deltaX===r.x&&s.deltaY===r.y)return null;let l=this.getItemIndex(e),c=e.getPlaceholderElement(),d=a.getRootElement();o>l?d.after(c):d.before(c),xv(this._activeItems,l,o);let u=this._getRootNode().elementFromPoint(i,n);return s.deltaX=r.x,s.deltaY=r.y,s.drag=a,s.overlaps=d===u||d.contains(u),{previousIndex:l,currentIndex:o}}enter(e,i,n,r){let o=this._activeItems.indexOf(e);o>-1&&this._activeItems.splice(o,1);let s=r==null||r<0?this._getItemIndexFromPointerPosition(e,i,n):r;s===-1&&(s=this._getClosestItemIndexToPointer(e,i,n));let a=this._activeItems[s];a&&!this._dragDropRegistry.isDragging(a)?(this._activeItems.splice(s,0,e),a.getRootElement().before(e.getPlaceholderElement())):(this._activeItems.push(e),this._element.appendChild(e.getPlaceholderElement()))}withItems(e){this._activeItems=e.slice()}withSortPredicate(e){this._sortPredicate=e}reset(){let e=this._element,i=this._previousSwap;for(let n=this._relatedNodes.length-1;n>-1;n--){let[r,o]=this._relatedNodes[n];r.parentNode===e&&r.nextSibling!==o&&(o===null?e.appendChild(r):o.parentNode===e&&e.insertBefore(r,o))}this._relatedNodes=[],this._activeItems=[],i.drag=null,i.deltaX=i.deltaY=0,i.overlaps=!1}getActiveItemsSnapshot(){return this._activeItems}getItemIndex(e){return this._activeItems.indexOf(e)}getItemAtIndex(e){return this._activeItems[e]||null}updateOnScroll(){this._activeItems.forEach(e=>{this._dragDropRegistry.isDragging(e)&&e._sortFromLastPointerPosition()})}withElementContainer(e){e!==this._element&&(this._element=e,this._rootNode=void 0)}_getItemIndexFromPointerPosition(e,i,n){let r=this._getRootNode().elementFromPoint(Math.floor(i),Math.floor(n)),o=r?this._activeItems.findIndex(s=>{let a=s.getRootElement();return r===a||a.contains(r)}):-1;return o===-1||!this._sortPredicate(o,e)?-1:o}_getRootNode(){return this._rootNode||(this._rootNode=vp(this._element)||this._document),this._rootNode}_getClosestItemIndexToPointer(e,i,n){if(this._activeItems.length===0)return-1;if(this._activeItems.length===1)return 0;let r=1/0,o=-1;for(let s=0;s<this._activeItems.length;s++){let a=this._activeItems[s];if(a!==e){let{x:l,y:c}=a.getRootElement().getBoundingClientRect(),d=Math.hypot(i-l,n-c);d<r&&(r=d,o=s)}}return o}},TO=.05,AO=.05,Bn=(function(t){return t[t.NONE=0]="NONE",t[t.UP=1]="UP",t[t.DOWN=2]="DOWN",t})(Bn||{}),Gi=(function(t){return t[t.NONE=0]="NONE",t[t.LEFT=1]="LEFT",t[t.RIGHT=2]="RIGHT",t})(Gi||{}),L3=class{_dragDropRegistry;_ngZone;_viewportRuler;element;disabled=!1;sortingDisabled=!1;lockAxis=null;autoScrollDisabled=!1;autoScrollStep=2;hasAnchor=!1;enterPredicate=()=>!0;sortPredicate=()=>!0;beforeStarted=new bt;entered=new bt;exited=new bt;dropped=new bt;sorted=new bt;receivingStarted=new bt;receivingStopped=new bt;data;_container;_isDragging=!1;_parentPositions;_sortStrategy;_domRect;_draggables=[];_siblings=[];_activeSiblings=new Set;_viewportScrollSubscription=$a.EMPTY;_verticalScrollDirection=Bn.NONE;_horizontalScrollDirection=Gi.NONE;_scrollNode;_stopScrollTimers=new bt;_cachedShadowRoot=null;_document;_scrollableElements=[];_initialScrollSnap;_direction="ltr";constructor(e,i,n,r,o){this._dragDropRegistry=i,this._ngZone=r,this._viewportRuler=o;let s=this.element=$n(e);this._document=n,this.withOrientation("vertical").withElementContainer(s),i.registerDropContainer(this),this._parentPositions=new bv(n)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(e,i,n,r){this._draggingStarted(),r==null&&this.sortingDisabled&&(r=this._draggables.indexOf(e)),this._sortStrategy.enter(e,i,n,r),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:e,container:this,currentIndex:this.getItemIndex(e)})}exit(e){this._reset(),this.exited.next({item:e,container:this})}drop(e,i,n,r,o,s,a,l={}){this._reset(),this.dropped.next({item:e,currentIndex:i,previousIndex:n,container:this,previousContainer:r,isPointerOverContainer:o,distance:s,dropPoint:a,event:l})}withItems(e){let i=this._draggables;return this._draggables=e,e.forEach(n=>n._withDropContainer(this)),this.isDragging()&&(i.filter(r=>r.isDragging()).every(r=>e.indexOf(r)===-1)?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(e){return this._direction=e,this._sortStrategy instanceof Sv&&(this._sortStrategy.direction=e),this}connectedTo(e){return this._siblings=e.slice(),this}withOrientation(e){if(e==="mixed")this._sortStrategy=new O3(this._document,this._dragDropRegistry);else{let i=new Sv(this._dragDropRegistry);i.direction=this._direction,i.orientation=e,this._sortStrategy=i}return this._sortStrategy.withElementContainer(this._container),this._sortStrategy.withSortPredicate((i,n)=>this.sortPredicate(i,n,this)),this}withScrollableParents(e){let i=this._container;return this._scrollableElements=e.indexOf(i)===-1?[i,...e]:e.slice(),this}withElementContainer(e){if(e===this._container)return this;let i=$n(this.element),n=this._scrollableElements.indexOf(this._container),r=this._scrollableElements.indexOf(e);return n>-1&&this._scrollableElements.splice(n,1),r>-1&&this._scrollableElements.splice(r,1),this._sortStrategy&&this._sortStrategy.withElementContainer(e),this._cachedShadowRoot=null,this._scrollableElements.unshift(e),this._container=e,this}getScrollableParents(){return this._scrollableElements}getItemIndex(e){return this._isDragging?this._sortStrategy.getItemIndex(e):this._draggables.indexOf(e)}getItemAtIndex(e){return this._isDragging?this._sortStrategy.getItemAtIndex(e):this._draggables[e]||null}isReceiving(){return this._activeSiblings.size>0}_sortItem(e,i,n,r){if(this.sortingDisabled||!this._domRect||!bO(this._domRect,TO,i,n))return;let o=this._sortStrategy.sort(e,i,n,r);o&&this.sorted.next({previousIndex:o.previousIndex,currentIndex:o.currentIndex,container:this,item:e})}_startScrollingIfNecessary(e,i){if(this.autoScrollDisabled)return;let n,r=Bn.NONE,o=Gi.NONE;if(this._parentPositions.positions.forEach((s,a)=>{a===this._document||!s.clientRect||n||bO(s.clientRect,TO,e,i)&&([r,o]=zfe(a,s.clientRect,this._direction,e,i),(r||o)&&(n=a))}),!r&&!o){let{width:s,height:a}=this._viewportRuler.getViewportSize(),l={width:s,height:a,top:0,right:s,bottom:a,left:0};r=OO(l,i),o=LO(l,e),n=window}n&&(r!==this._verticalScrollDirection||o!==this._horizontalScrollDirection||n!==this._scrollNode)&&(this._verticalScrollDirection=r,this._horizontalScrollDirection=o,this._scrollNode=n,(r||o)&&n?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){let e=this._container.style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=e.msScrollSnapType||e.scrollSnapType||"",e.scrollSnapType=e.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(this._container).clientRect}_reset(){this._isDragging=!1;let e=this._container.style;e.scrollSnapType=e.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(i=>i._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_startScrollInterval=()=>{this._stopScrolling(),op(0,rp).pipe(gn(this._stopScrollTimers)).subscribe(()=>{let e=this._scrollNode,i=this.autoScrollStep;this._verticalScrollDirection===Bn.UP?e.scrollBy(0,-i):this._verticalScrollDirection===Bn.DOWN&&e.scrollBy(0,i),this._horizontalScrollDirection===Gi.LEFT?e.scrollBy(-i,0):this._horizontalScrollDirection===Gi.RIGHT&&e.scrollBy(i,0)})};_isOverContainer(e,i){return this._domRect!=null&&M3(this._domRect,e,i)}_getSiblingContainerFromPosition(e,i,n){return this._siblings.find(r=>r._canReceive(e,i,n))}_canReceive(e,i,n){if(!this._domRect||!M3(this._domRect,i,n)||!this.enterPredicate(e,this))return!1;let r=this._getShadowRoot().elementFromPoint(i,n);return r?r===this._container||this._container.contains(r):!1}_startReceiving(e,i){let n=this._activeSiblings;!n.has(e)&&i.every(r=>this.enterPredicate(r,this)||this._draggables.indexOf(r)>-1)&&(n.add(e),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:e,receiver:this,items:i}))}_stopReceiving(e){this._activeSiblings.delete(e),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:e,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(e=>{if(this.isDragging()){let i=this._parentPositions.handleScroll(e);i&&this._sortStrategy.updateOnScroll(i.top,i.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){let e=vp(this._container);this._cachedShadowRoot=e||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){let e=this._sortStrategy.getActiveItemsSnapshot().filter(i=>i.isDragging());this._siblings.forEach(i=>i._startReceiving(this,e))}};function OO(t,e){let{top:i,bottom:n,height:r}=t,o=r*AO;return e>=i-o&&e<=i+o?Bn.UP:e>=n-o&&e<=n+o?Bn.DOWN:Bn.NONE}function LO(t,e){let{left:i,right:n,width:r}=t,o=r*AO;return e>=i-o&&e<=i+o?Gi.LEFT:e>=n-o&&e<=n+o?Gi.RIGHT:Gi.NONE}function zfe(t,e,i,n,r){let o=OO(e,r),s=LO(e,n),a=Bn.NONE,l=Gi.NONE;if(o){let c=t.scrollTop;o===Bn.UP?c>0&&(a=Bn.UP):t.scrollHeight-c>t.clientHeight&&(a=Bn.DOWN)}if(s){let c=t.scrollLeft;i==="rtl"?s===Gi.RIGHT?c<0&&(l=Gi.RIGHT):t.scrollWidth+c>t.clientWidth&&(l=Gi.LEFT):s===Gi.LEFT?c>0&&(l=Gi.LEFT):t.scrollWidth-c>t.clientWidth&&(l=Gi.RIGHT)}return[a,l]}var tp={capture:!0},T3={passive:!1,capture:!0},Vfe=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275cmp=Ie({type:t,selectors:[["ng-component"]],hostAttrs:["cdk-drag-resets-container",""],decls:0,vars:0,template:function(n,r){},styles:[`@layer cdk-resets{.cdk-drag-preview{background:none;border:none;padding:0;color:inherit;inset:auto}}.cdk-drag-placeholder *,.cdk-drag-preview *{pointer-events:none !important}
`],encapsulation:2,changeDetection:0})}return t})(),NO=(()=>{class t{_ngZone=Z(Wi);_document=Z(Bo);_styleLoader=Z(Kx);_renderer=Z(Iv).createRenderer(null,null);_cleanupDocumentTouchmove;_scroll=new bt;_dropInstances=new Set;_dragInstances=new Set;_activeDragInstances=ve([]);_globalListeners;_draggingPredicate=i=>i.isDragging();_domNodesToDirectives=null;pointerMove=new bt;pointerUp=new bt;constructor(){}registerDropContainer(i){this._dropInstances.has(i)||this._dropInstances.add(i)}registerDragItem(i){this._dragInstances.add(i),this._dragInstances.size===1&&this._ngZone.runOutsideAngular(()=>{this._cleanupDocumentTouchmove?.(),this._cleanupDocumentTouchmove=this._renderer.listen(this._document,"touchmove",this._persistentTouchmoveListener,T3)})}removeDropContainer(i){this._dropInstances.delete(i)}removeDragItem(i){this._dragInstances.delete(i),this.stopDragging(i),this._dragInstances.size===0&&this._cleanupDocumentTouchmove?.()}startDragging(i,n){if(!(this._activeDragInstances().indexOf(i)>-1)&&(this._styleLoader.load(Vfe),this._activeDragInstances.update(r=>[...r,i]),this._activeDragInstances().length===1)){let r=n.type.startsWith("touch"),o=a=>this.pointerUp.next(a),s=[["scroll",a=>this._scroll.next(a),tp],["selectstart",this._preventDefaultWhileDragging,T3]];r?s.push(["touchend",o,tp],["touchcancel",o,tp]):s.push(["mouseup",o,tp]),r||s.push(["mousemove",a=>this.pointerMove.next(a),T3]),this._ngZone.runOutsideAngular(()=>{this._globalListeners=s.map(([a,l,c])=>this._renderer.listen(this._document,a,l,c))})}}stopDragging(i){this._activeDragInstances.update(n=>{let r=n.indexOf(i);return r>-1?(n.splice(r,1),[...n]):n}),this._activeDragInstances().length===0&&this._clearGlobalListeners()}isDragging(i){return this._activeDragInstances().indexOf(i)>-1}scrolled(i){let n=[this._scroll];return i&&i!==this._document&&n.push(new jc(r=>this._ngZone.runOutsideAngular(()=>{let o=this._renderer.listen(i,"scroll",s=>{this._activeDragInstances().length&&r.next(s)},tp);return()=>{o()}}))),Yr(...n)}registerDirectiveNode(i,n){this._domNodesToDirectives??=new WeakMap,this._domNodesToDirectives.set(i,n)}removeDirectiveNode(i){this._domNodesToDirectives?.delete(i)}getDragDirectiveForNode(i){return this._domNodesToDirectives?.get(i)||null}ngOnDestroy(){this._dragInstances.forEach(i=>this.removeDragItem(i)),this._dropInstances.forEach(i=>this.removeDropContainer(i)),this._domNodesToDirectives=null,this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_preventDefaultWhileDragging=i=>{this._activeDragInstances().length>0&&i.preventDefault()};_persistentTouchmoveListener=i=>{this._activeDragInstances().length>0&&(this._activeDragInstances().some(this._draggingPredicate)&&i.preventDefault(),this.pointerMove.next(i))};_clearGlobalListeners(){this._globalListeners?.forEach(i=>i()),this._globalListeners=void 0}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Hn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Gfe={dragStartThreshold:5,pointerDirectionChangeThreshold:5},H3=(()=>{class t{_document=Z(Bo);_ngZone=Z(Wi);_viewportRuler=Z(Jx);_dragDropRegistry=Z(NO);_renderer=Z(Iv).createRenderer(null,null);constructor(){}createDrag(i,n=Gfe){return new A3(i,n,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry,this._renderer)}createDropList(i){return new L3(i,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Hn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),DO=new tn("CDK_DRAG_PARENT");var Wfe=new tn("CdkDragHandle");var BO=new tn("CDK_DRAG_CONFIG"),HO=new tn("CdkDropList"),zO=(()=>{class t{element=Z(Ai);dropContainer=Z(HO,{optional:!0,skipSelf:!0});_ngZone=Z(Wi);_viewContainerRef=Z(Ka);_dir=Z(ad,{optional:!0});_changeDetectorRef=Z(rd);_selfHandle=Z(Wfe,{optional:!0,self:!0});_parentDrag=Z(DO,{optional:!0,skipSelf:!0});_dragDropRegistry=Z(NO);_destroyed=new bt;_handles=new ox([]);_previewTemplate;_placeholderTemplate;_dragRef;data;lockAxis=null;rootElementSelector;boundaryElement;dragStartDelay;freeDragPosition;get disabled(){return this._disabled||!!(this.dropContainer&&this.dropContainer.disabled)}set disabled(i){this._disabled=i,this._dragRef.disabled=this._disabled}_disabled;constrainPosition;previewClass;previewContainer;scale=1;started=new W;released=new W;ended=new W;entered=new W;exited=new W;dropped=new W;moved=new jc(i=>{let n=this._dragRef.moved.pipe(Kr(r=>({source:this,pointerPosition:r.pointerPosition,event:r.event,delta:r.delta,distance:r.distance}))).subscribe(i);return()=>{n.unsubscribe()}});_injector=Z(Mv);constructor(){let i=this.dropContainer,n=Z(BO,{optional:!0}),r=Z(H3);this._dragRef=r.createDrag(this.element,{dragStartThreshold:n&&n.dragStartThreshold!=null?n.dragStartThreshold:5,pointerDirectionChangeThreshold:n&&n.pointerDirectionChangeThreshold!=null?n.pointerDirectionChangeThreshold:5,zIndex:n?.zIndex}),this._dragRef.data=this,this._dragDropRegistry.registerDirectiveNode(this.element.nativeElement,this),n&&this._assignDefaults(n),i&&(i.addItem(this),i._dropListRef.beforeStarted.pipe(gn(this._destroyed)).subscribe(()=>{this._dragRef.scale=this.scale})),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}resetToBoundary(){this._dragRef.resetToBoundary()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(i){this._dragRef.setFreeDragPosition(i)}ngAfterViewInit(){px(()=>{this._updateRootElement(),this._setupHandlesListener(),this._dragRef.scale=this.scale,this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)},{injector:this._injector})}ngOnChanges(i){let n=i.rootElementSelector,r=i.freeDragPosition;n&&!n.firstChange&&this._updateRootElement(),this._dragRef.scale=this.scale,r&&!r.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this),this._dragDropRegistry.removeDirectiveNode(this.element.nativeElement),this._ngZone.runOutsideAngular(()=>{this._handles.complete(),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_addHandle(i){let n=this._handles.getValue();n.push(i),this._handles.next(n)}_removeHandle(i){let n=this._handles.getValue(),r=n.indexOf(i);r>-1&&(n.splice(r,1),this._handles.next(n))}_setPreviewTemplate(i){this._previewTemplate=i}_resetPreviewTemplate(i){i===this._previewTemplate&&(this._previewTemplate=null)}_setPlaceholderTemplate(i){this._placeholderTemplate=i}_resetPlaceholderTemplate(i){i===this._placeholderTemplate&&(this._placeholderTemplate=null)}_updateRootElement(){let i=this.element.nativeElement,n=i;this.rootElementSelector&&(n=i.closest!==void 0?i.closest(this.rootElementSelector):i.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(n||i)}_getBoundaryElement(){let i=this.boundaryElement;return i?typeof i=="string"?this.element.nativeElement.closest(i):$n(i):null}_syncInputs(i){i.beforeStarted.subscribe(()=>{if(!i.isDragging()){let n=this._dir,r=this.dragStartDelay,o=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,s=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;i.disabled=this.disabled,i.lockAxis=this.lockAxis,i.scale=this.scale,i.dragStartDelay=typeof r=="object"&&r?r:zv(r),i.constrainPosition=this.constrainPosition,i.previewClass=this.previewClass,i.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(o).withPreviewTemplate(s).withPreviewContainer(this.previewContainer||"global"),n&&i.withDirection(n.value)}}),i.beforeStarted.pipe(sp(1)).subscribe(()=>{if(this._parentDrag){i.withParent(this._parentDrag._dragRef);return}let n=this.element.nativeElement.parentElement;for(;n;){let r=this._dragDropRegistry.getDragDirectiveForNode(n);if(r){i.withParent(r._dragRef);break}n=n.parentElement}})}_handleEvents(i){i.started.subscribe(n=>{this.started.emit({source:this,event:n.event}),this._changeDetectorRef.markForCheck()}),i.released.subscribe(n=>{this.released.emit({source:this,event:n.event})}),i.ended.subscribe(n=>{this.ended.emit({source:this,distance:n.distance,dropPoint:n.dropPoint,event:n.event}),this._changeDetectorRef.markForCheck()}),i.entered.subscribe(n=>{this.entered.emit({container:n.container.data,item:this,currentIndex:n.currentIndex})}),i.exited.subscribe(n=>{this.exited.emit({container:n.container.data,item:this})}),i.dropped.subscribe(n=>{this.dropped.emit({previousIndex:n.previousIndex,currentIndex:n.currentIndex,previousContainer:n.previousContainer.data,container:n.container.data,isPointerOverContainer:n.isPointerOverContainer,item:this,distance:n.distance,dropPoint:n.dropPoint,event:n.event})})}_assignDefaults(i){let{lockAxis:n,dragStartDelay:r,constrainPosition:o,previewClass:s,boundaryElement:a,draggingDisabled:l,rootElementSelector:c,previewContainer:d}=i;this.disabled=l??!1,this.dragStartDelay=r||0,this.lockAxis=n||null,o&&(this.constrainPosition=o),s&&(this.previewClass=s),a&&(this.boundaryElement=a),c&&(this.rootElementSelector=c),d&&(this.previewContainer=d)}_setupHandlesListener(){this._handles.pipe(mn(i=>{let n=i.map(r=>r.element);this._selfHandle&&this.rootElementSelector&&n.push(this.element),this._dragRef.withHandles(n)}),en(i=>Yr(...i.map(n=>n._stateChanges.pipe(qc(n))))),gn(this._destroyed)).subscribe(i=>{let n=this._dragRef,r=i.element.nativeElement;i.disabled?n.disableHandle(r):n.enableHandle(r)})}static \u0275fac=function(n){return new(n||t)};static \u0275dir=Yt({type:t,selectors:[["","cdkDrag",""]],hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(n,r){n&2&&Xt("cdk-drag-disabled",r.disabled)("cdk-drag-dragging",r._dragRef.isDragging())},inputs:{data:[0,"cdkDragData","data"],lockAxis:[0,"cdkDragLockAxis","lockAxis"],rootElementSelector:[0,"cdkDragRootElement","rootElementSelector"],boundaryElement:[0,"cdkDragBoundary","boundaryElement"],dragStartDelay:[0,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[0,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[2,"cdkDragDisabled","disabled",O],constrainPosition:[0,"cdkDragConstrainPosition","constrainPosition"],previewClass:[0,"cdkDragPreviewClass","previewClass"],previewContainer:[0,"cdkDragPreviewContainer","previewContainer"],scale:[2,"cdkDragScale","scale",od]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[Xe([{provide:DO,useExisting:t}]),lp]})}return t})(),MO=new tn("CdkDropListGroup");var VO=(()=>{class t{element=Z(Ai);_changeDetectorRef=Z(rd);_scrollDispatcher=Z(Xx);_dir=Z(ad,{optional:!0});_group=Z(MO,{optional:!0,skipSelf:!0});_latestSortedRefs;_destroyed=new bt;_scrollableParentsResolved;static _dropLists=[];_dropListRef;connectedTo=[];data;orientation;id=Z(Zx).getId("cdk-drop-list-");lockAxis=null;get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(i){this._dropListRef.disabled=this._disabled=i}_disabled;sortingDisabled;enterPredicate=()=>!0;sortPredicate=()=>!0;autoScrollDisabled;autoScrollStep;elementContainerSelector;hasAnchor;dropped=new W;entered=new W;exited=new W;sorted=new W;_unsortedItems=new Set;constructor(){let i=Z(H3),n=Z(BO,{optional:!0});this._dropListRef=i.createDropList(this.element),this._dropListRef.data=this,n&&this._assignDefaults(n),this._dropListRef.enterPredicate=(r,o)=>this.enterPredicate(r.data,o.data),this._dropListRef.sortPredicate=(r,o,s)=>this.sortPredicate(r,o.data,s.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),t._dropLists.push(this),this._group&&this._group._items.add(this)}addItem(i){this._unsortedItems.add(i),i._dragRef._withDropContainer(this._dropListRef),this._dropListRef.isDragging()&&this._syncItemsWithRef(this.getSortedItems().map(n=>n._dragRef))}removeItem(i){if(this._unsortedItems.delete(i),this._latestSortedRefs){let n=this._latestSortedRefs.indexOf(i._dragRef);n>-1&&(this._latestSortedRefs.splice(n,1),this._syncItemsWithRef(this._latestSortedRefs))}}getSortedItems(){return Array.from(this._unsortedItems).sort((i,n)=>i._dragRef.getVisibleElement().compareDocumentPosition(n._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){let i=t._dropLists.indexOf(this);i>-1&&t._dropLists.splice(i,1),this._group&&this._group._items.delete(this),this._latestSortedRefs=void 0,this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(i){this._dir&&this._dir.change.pipe(qc(this._dir.value),gn(this._destroyed)).subscribe(n=>i.withDirection(n)),i.beforeStarted.subscribe(()=>{let n=Yx(this.connectedTo).map(r=>{if(typeof r=="string"){let o=t._dropLists.find(s=>s.id===r);return o}return r});if(this._group&&this._group._items.forEach(r=>{n.indexOf(r)===-1&&n.push(r)}),!this._scrollableParentsResolved){let r=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(o=>o.getElementRef().nativeElement);this._dropListRef.withScrollableParents(r),this._scrollableParentsResolved=!0}if(this.elementContainerSelector){let r=this.element.nativeElement.querySelector(this.elementContainerSelector);i.withElementContainer(r)}i.disabled=this.disabled,i.lockAxis=this.lockAxis,i.sortingDisabled=this.sortingDisabled,i.autoScrollDisabled=this.autoScrollDisabled,i.autoScrollStep=zv(this.autoScrollStep,2),i.hasAnchor=this.hasAnchor,i.connectedTo(n.filter(r=>r&&r!==this).map(r=>r._dropListRef)).withOrientation(this.orientation)})}_handleEvents(i){i.beforeStarted.subscribe(()=>{this._syncItemsWithRef(this.getSortedItems().map(n=>n._dragRef)),this._changeDetectorRef.markForCheck()}),i.entered.subscribe(n=>{this.entered.emit({container:this,item:n.item.data,currentIndex:n.currentIndex})}),i.exited.subscribe(n=>{this.exited.emit({container:this,item:n.item.data}),this._changeDetectorRef.markForCheck()}),i.sorted.subscribe(n=>{this.sorted.emit({previousIndex:n.previousIndex,currentIndex:n.currentIndex,container:this,item:n.item.data})}),i.dropped.subscribe(n=>{this.dropped.emit({previousIndex:n.previousIndex,currentIndex:n.currentIndex,previousContainer:n.previousContainer.data,container:n.container.data,item:n.item.data,isPointerOverContainer:n.isPointerOverContainer,distance:n.distance,dropPoint:n.dropPoint,event:n.event}),this._changeDetectorRef.markForCheck()}),Yr(i.receivingStarted,i.receivingStopped).subscribe(()=>this._changeDetectorRef.markForCheck())}_assignDefaults(i){let{lockAxis:n,draggingDisabled:r,sortingDisabled:o,listAutoScrollDisabled:s,listOrientation:a}=i;this.disabled=r??!1,this.sortingDisabled=o??!1,this.autoScrollDisabled=s??!1,this.orientation=a||"vertical",this.lockAxis=n||null}_syncItemsWithRef(i){this._latestSortedRefs=i,this._dropListRef.withItems(i)}static \u0275fac=function(n){return new(n||t)};static \u0275dir=Yt({type:t,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(n,r){n&2&&(Ya("id",r.id),Xt("cdk-drop-list-disabled",r.disabled)("cdk-drop-list-dragging",r._dropListRef.isDragging())("cdk-drop-list-receiving",r._dropListRef.isReceiving()))},inputs:{connectedTo:[0,"cdkDropListConnectedTo","connectedTo"],data:[0,"cdkDropListData","data"],orientation:[0,"cdkDropListOrientation","orientation"],id:"id",lockAxis:[0,"cdkDropListLockAxis","lockAxis"],disabled:[2,"cdkDropListDisabled","disabled",O],sortingDisabled:[2,"cdkDropListSortingDisabled","sortingDisabled",O],enterPredicate:[0,"cdkDropListEnterPredicate","enterPredicate"],sortPredicate:[0,"cdkDropListSortPredicate","sortPredicate"],autoScrollDisabled:[2,"cdkDropListAutoScrollDisabled","autoScrollDisabled",O],autoScrollStep:[0,"cdkDropListAutoScrollStep","autoScrollStep"],elementContainerSelector:[0,"cdkDropListElementContainer","elementContainerSelector"],hasAnchor:[2,"cdkDropListHasAnchor","hasAnchor",O]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],features:[Xe([{provide:MO,useValue:void 0},{provide:HO,useExisting:t}])]})}return t})();var GO=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=Xc({type:t});static \u0275inj=Kc({providers:[H3],imports:[Qx]})}return t})();var WO=t=>[t],UO=(t,e)=>e.id;function jfe(t,e){if(t&1){let i=je();D(0,"div",7)(1,"div",11)(2,"div",12),se(3),F(),D(4,"div",13),se(5),F()(),D(6,"button",14),te("click",function(){let r=ie(i).$implicit,o=X();return ne(o.addMaterial(r))}),ee(7,"ng-icon",15),F()()}if(t&2){let i=e.$implicit;M(3),Ze(i.name),M(2),Ke("",i.thickness," mm")}}function qfe(t,e){t&1&&(D(0,"div",8),se(1,"Keine Materialien verf\xFCgbar"),F())}function $fe(t,e){if(t&1){let i=je();D(0,"div",7)(1,"div",16)(2,"span",17),se(3),F(),D(4,"div",11)(5,"div",12),se(6),F(),D(7,"div",13),se(8),F()()(),D(9,"div",18)(10,"button",19),te("click",function(){let r=ie(i).$implicit,o=X();return ne(o.moveUp(r))}),ee(11,"ng-icon",20),F(),D(12,"button",19),te("click",function(){let r=ie(i).$implicit,o=X();return ne(o.moveDown(r))}),ee(13,"ng-icon",21),F(),D(14,"button",22),te("click",function(){let r=ie(i).$implicit,o=X();return ne(o.removeMaterial(r))}),ee(15,"ng-icon",23),F()()()}if(t&2){let i=e.$implicit,n=X();M(3),Ze(i.position),M(3),Ze(i.material.name),M(2),Ke("",i.material.thickness," mm"),M(2),de("disabled",i.position===1),M(2),de("disabled",i.position===n.selectedLayers().length)}}function Kfe(t,e){t&1&&(D(0,"div",8),se(1,"Keine Schichten hinzugef\xFCgt"),F())}var jO=(()=>{class t{allMaterials=Re.required();initialSelectedLayers=Re([]);layersChanged=ue();selectedLayersSignal=ve([]);selectedLayers=this.selectedLayersSignal.asReadonly();availableMaterials=Fe(()=>{let i=new Set(this.selectedLayers().map(n=>n.materialId));return this.allMaterials().filter(n=>!i.has(n.id))});constructor(){pt(()=>{let i=this.initialSelectedLayers();i.length>0&&this.selectedLayersSignal().length===0&&this.selectedLayersSignal.set([...i])})}totalThickness=Fe(()=>this.selectedLayers().reduce((i,n)=>i+n.material.thickness,0));addMaterial(i){let n=this.selectedLayersSignal(),r=n.length>0?Math.max(...n.map(s=>s.position)):0,o={id:crypto.randomUUID(),materialId:i.id,material:i,position:r+1};this.selectedLayersSignal.update(s=>[...s,o]),this.emitChanges()}removeMaterial(i){this.selectedLayersSignal.update(n=>n.filter(o=>o.id!==i.id).sort((o,s)=>o.position-s.position).map((o,s)=>k(w({},o),{position:s+1}))),this.emitChanges()}moveUp(i){i.position!==1&&(this.selectedLayersSignal.update(n=>{let r=[...n].sort((s,a)=>s.position-a.position),o=r.findIndex(s=>s.id===i.id);return o>0?([r[o-1],r[o]]=[r[o],r[o-1]],r.map((s,a)=>k(w({},s),{position:a+1}))):n}),this.emitChanges())}moveDown(i){let n=this.selectedLayers();i.position!==n.length&&(this.selectedLayersSignal.update(r=>{let o=[...r].sort((a,l)=>a.position-l.position),s=o.findIndex(a=>a.id===i.id);return s<o.length-1?([o[s],o[s+1]]=[o[s+1],o[s]],o.map((a,l)=>k(w({},a),{position:l+1}))):r}),this.emitChanges())}onDropAvailable(i){if(i.previousContainer!==i.container){let n=i.previousContainer.data[i.previousIndex];this.removeMaterial(n)}}onDropSelected(i){if(i.previousContainer===i.container){let n=[...this.selectedLayersSignal()];xv(n,i.previousIndex,i.currentIndex);let r=n.map((o,s)=>k(w({},o),{position:s+1}));this.selectedLayersSignal.set(r),this.emitChanges()}else{let n=i.previousContainer.data[i.previousIndex];this.addMaterial(n)}}emitChanges(){this.layersChanged.emit(this.selectedLayersSignal())}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=Ie({type:t,selectors:[["gh-material-dual-list"]],inputs:{allMaterials:[1,"allMaterials"],initialSelectedLayers:[1,"initialSelectedLayers"]},outputs:{layersChanged:"layersChanged"},features:[Xe([vi({lucideArrowRight:Ex,lucideTrash:dr,lucideChevronUp:kx,lucideChevronDown:_x})])],decls:26,vars:11,consts:[["availableList","cdkDropList"],["selectedList","cdkDropList"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"border","rounded-lg","p-4"],[1,"font-semibold","mb-3"],[1,"h-[400px]","overflow-y-auto"],["cdkDropList","",1,"space-y-2","min-h-[50px]","p-2",3,"cdkDropListDropped","cdkDropListData","cdkDropListConnectedTo"],["cdkDrag","",1,"flex","items-center","justify-between","p-3","bg-muted","rounded-md","border","cursor-move","hover:bg-accent","transition-colors"],[1,"text-center","text-muted-foreground","p-4"],[1,"text-sm","font-normal","text-muted-foreground","ml-2"],[1,"mt-4","text-sm","text-muted-foreground"],[1,"flex-1","min-w-0"],[1,"font-medium","truncate"],[1,"text-sm","text-muted-foreground"],["hlmBtn","","size","icon-sm","variant","ghost",1,"flex-shrink-0","ml-2",3,"click"],["hlm","","name","lucideArrowRight","size","sm"],[1,"flex","items-center","gap-2","flex-1","min-w-0"],[1,"text-xs","font-semibold","text-muted-foreground","w-6"],[1,"flex","gap-1","flex-shrink-0","ml-2"],["hlmBtn","","size","icon-sm","variant","ghost",3,"click","disabled"],["hlm","","name","lucideChevronUp","size","sm"],["hlm","","name","lucideChevronDown","size","sm"],["hlmBtn","","size","icon-sm","variant","destructive",3,"click"],["hlm","","name","lucideTrash","size","sm"]],template:function(n,r){if(n&1){let o=je();D(0,"div",2)(1,"div",3)(2,"h3",4),se(3,"Verf\xFCgbare Materialien"),F(),D(4,"div",5)(5,"div",6,0),te("cdkDropListDropped",function(a){return ie(o),ne(r.onDropAvailable(a))}),Vn(7,jfe,8,2,"div",7,UO),ze(9,qfe,2,0,"div",8),F()()(),D(10,"div",3)(11,"h3",4),se(12," Ausgew\xE4hlte Schichten "),D(13,"span",9),se(14,"Gesamtdicke: "),D(15,"strong"),se(16),F()()(),D(17,"div",5)(18,"div",6,1),te("cdkDropListDropped",function(a){return ie(o),ne(r.onDropSelected(a))}),Vn(20,$fe,16,5,"div",7,UO),ze(22,Kfe,2,0,"div",8),F()()()(),D(23,"div",10)(24,"p"),se(25,"\u{1F4A1} Tipp: Ziehen Sie Materialien per Drag & Drop zwischen den Listen oder verwenden Sie die Buttons. Position 1 = au\xDFen."),F()()}if(n&2){let o=Lv(6),s=Lv(19);M(5),de("cdkDropListData",r.availableMaterials())("cdkDropListConnectedTo",id(7,WO,s)),M(2),Gn(r.availableMaterials()),M(2),Ve(r.availableMaterials().length===0?9:-1),M(7),Ke("",r.totalThickness()," mm"),M(2),de("cdkDropListData",r.selectedLayers())("cdkDropListConnectedTo",id(9,WO,o)),M(2),Gn(r.selectedLayers()),M(2),Ve(r.selectedLayers().length===0?22:-1)}},dependencies:[vn,GO,VO,zO,_t,wi,Ci],encapsulation:2,changeDetection:0})}return t})();function Yfe(t,e){t&1&&(D(0,"p",9),se(1,"Materialname ist erforderlich"),F())}function Xfe(t,e){t&1&&(D(0,"p",9),se(1,"Dicke ist erforderlich und muss eine positive Zahl sein"),F())}function Jfe(t,e){if(t&1){let i=je();D(0,"hlm-sheet-content",2)(1,"hlm-sheet-header")(2,"h3",3),se(3),F(),D(4,"p",4),se(5,"Geben Sie die Details f\xFCr das Material ein."),F()(),D(6,"form",5)(7,"div",6)(8,"label",7),se(9,"Materialname *"),F(),ee(10,"input",8),ze(11,Yfe,2,0,"p",9),F(),D(12,"div",6)(13,"label",10),se(14,"Dicke (mm) *"),F(),ee(15,"input",11),ze(16,Xfe,2,0,"p",9),F(),D(17,"div",6)(18,"label",12),se(19,"Beschreibung"),F(),ee(20,"input",13),F()(),D(21,"hlm-sheet-footer",14)(22,"button",15),te("click",function(){let r=ie(i).$implicit;return ne(r.close())}),se(23," Abbrechen "),F(),D(24,"button",16),te("click",function(){let r=ie(i).$implicit,o=X();return ne(o.save(r))}),se(25," Speichern "),F()()()}if(t&2){let i=X();M(3),Ze(i.isEdit()?"Material bearbeiten":"Neues Material"),M(3),de("formGroup",i.form),M(5),Ve(i.form.controls.name.touched&&i.form.controls.name.invalid?11:-1),M(5),Ve(i.form.controls.thickness.touched&&i.form.controls.thickness.invalid?16:-1),M(8),de("disabled",i.form.invalid)}}var qO=(()=>{class t{material=Re(null);state=Re("closed");stateChanged=ue();save$=ue();isEdit=Fe(()=>!!this.material()?.id);form=new Qa({name:new qn("",[Vo.required]),thickness:new qn(null,[Vo.required,Vo.min(0)]),description:new qn("")});constructor(){pt(()=>{let i=this.material();i?this.form.patchValue({name:i.name||"",thickness:i.thickness||0,description:i.description||""}):this.form.reset()})}save(i){if(this.form.invalid)return;let n=this.form.value;this.save$.emit({name:n.name||"",thickness:n.thickness||0,description:n.description||""}),this.form.reset(),i.close()}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=Ie({type:t,selectors:[["gh-material-edit-sheet"]],inputs:{material:[1,"material"],state:[1,"state"]},outputs:{stateChanged:"stateChanged",save$:"save$"},decls:2,vars:1,consts:[["side","right",3,"stateChanged","state"],["class","w-full sm:max-w-md",4,"brnSheetContent"],[1,"w-full","sm:max-w-md"],["hlmSheetTitle",""],["hlmSheetDescription",""],[1,"space-y-4","p-4",3,"formGroup"],[1,"space-y-2"],["hlmLabel","","for","name"],["hlmInput","","id","name","formControlName","name","placeholder","z.B. Holz, Ziegel"],[1,"text-sm","text-destructive"],["hlmLabel","","for","thickness"],["hlmInput","","id","thickness","type","number","formControlName","thickness","placeholder","z.B. 20"],["hlmLabel","","for","description"],["hlmInput","","id","description","formControlName","description","placeholder","Optionale Beschreibung"],[1,"flex","justify-end","gap-2"],["hlmBtn","","variant","outline",3,"click"],["hlmBtn","",3,"click","disabled"]],template:function(n,r){n&1&&(D(0,"hlm-sheet",0),te("stateChanged",function(s){return r.stateChanged.emit(s)}),ar(1,Jfe,26,5,"hlm-sheet-content",1),F()),n&2&&de("state",r.state())},dependencies:[nl,Za,lr,yx,cr,Ja,el,tl,Wo,Uo,jo,qo,$o,Ko,Yo,_t,bn,yn],encapsulation:2,changeDetection:0})}return t})();var $r=class{supabaseGlobal=Z(ol);supabase=this.supabaseGlobal.supabase;loadingCount=ve(0);loading=Fe(()=>this.loadingCount()>0);materialLayers=jn({loader:async()=>{let{data:e,error:i}=await this.supabase.from("material_layers").select("*").order("created_at",{ascending:!1});if(i)throw i;return e||[]}});wallStructures=jn({loader:async()=>{let{data:e,error:i}=await this.supabase.from("wall_structures").select("*").order("created_at",{ascending:!1});if(i)throw i;return e||[]}});selectedStructureIdSignal=ve(null);structureLayers=jn({params:()=>({structureId:this.selectedStructureIdSignal()}),loader:async({params:e})=>{if(!e.structureId)return[];let{data:i,error:n}=await this.supabase.from("wall_structure_layers").select(`
          *,
          material:material_layers(*)
        `).eq("wall_structure_id",e.structureId).order("position",{ascending:!0});if(n)throw n;return i||[]}});selectedStructureId=Fe(()=>this.selectedStructureIdSignal());selectStructure(e){this.selectedStructureIdSignal.set(e)}createMaterialLayer(e){this.loadingCount.update(i=>i+1),$e(this.supabase.from("material_layers").insert({name:e.name,thickness:e.thickness,description:e.description||null}).select().single()).pipe(rt(i=>(console.error("Error creating material layer:",i),Ye({error:i}))),Qe(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.materialLayers.reload()})}updateMaterialLayer(e,i){this.loadingCount.update(n=>n+1),$e(this.supabase.from("material_layers").update(i).eq("id",e).select().single()).pipe(rt(n=>(console.error("Error updating material layer:",n),Ye({error:n}))),Qe(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error)throw n.error;this.materialLayers.reload()})}deleteMaterialLayers(e){this.loadingCount.update(i=>i+1),$e(this.supabase.from("material_layers").delete().in("id",e)).pipe(rt(i=>(console.error("Error deleting material layers:",i),Ye({error:i}))),Qe(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.materialLayers.reload()})}createWallStructure(e){this.loadingCount.update(i=>i+1),$e(this.supabase.from("wall_structures").insert({name:e.name}).select().single()).pipe(rt(i=>(console.error("Error creating wall structure:",i),Ye({error:i}))),Qe(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.wallStructures.reload()})}createWallStructureWithLayers(e,i){this.loadingCount.update(n=>n+1),$e(this.supabase.from("wall_structures").insert({name:e.name}).select().single()).pipe(rt(n=>(console.error("Error creating wall structure:",n),Ye({error:n}))),Qe(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error)throw n.error;let r=n.data;i.length>0&&this.addLayersToStructureSync(r.id,i),this.wallStructures.reload()})}updateWallStructure(e,i){this.loadingCount.update(n=>n+1),$e(this.supabase.from("wall_structures").update(i).eq("id",e).select().single()).pipe(rt(n=>(console.error("Error updating wall structure:",n),Ye({error:n}))),Qe(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error)throw n.error;this.wallStructures.reload()})}updateWallStructureWithLayers(e,i,n){this.loadingCount.update(r=>r+1),$e(this.supabase.from("wall_structures").update(i).eq("id",e).select().single()).pipe(rt(r=>(console.error("Error updating wall structure:",r),Ye({error:r}))),Qe(()=>this.loadingCount.update(r=>r-1))).subscribe(r=>{if(r?.error)throw r.error;this.replaceStructureLayers(e,n),this.wallStructures.reload()})}deleteWallStructure(e){this.loadingCount.update(i=>i+1),$e(this.supabase.from("wall_structures").delete().eq("id",e)).pipe(rt(i=>(console.error("Error deleting wall structure:",i),Ye({error:i}))),Qe(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.wallStructures.reload(),this.selectedStructureIdSignal()===e&&this.selectedStructureIdSignal.set(null)})}addLayerToStructure(e){this.loadingCount.update(i=>i+1),$e(this.supabase.from("wall_structure_layers").insert(e).select().single()).pipe(rt(i=>(console.error("Error adding layer to structure:",i),Ye({error:i}))),Qe(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.structureLayers.reload()})}removeLayersFromStructure(e){this.loadingCount.update(i=>i+1),$e(this.supabase.from("wall_structure_layers").delete().in("id",e)).pipe(rt(i=>(console.error("Error removing layers from structure:",i),Ye({error:i}))),Qe(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.structureLayers.reload()})}addLayersToStructureSync(e,i){this.loadingCount.update(r=>r+1);let n=i.map(r=>({wall_structure_id:e,material_layer_id:r.materialId,position:r.position}));$e(this.supabase.from("wall_structure_layers").insert(n)).pipe(rt(r=>(console.error("Error adding layers to structure:",r),Ye({error:r}))),Qe(()=>this.loadingCount.update(r=>r-1))).subscribe(r=>{if(r?.error)throw r.error;this.structureLayers.reload()})}replaceStructureLayers(e,i){this.loadingCount.update(n=>n+1),$e(this.supabase.from("wall_structure_layers").delete().eq("wall_structure_id",e)).pipe(rt(n=>(console.error("Error removing existing layers:",n),Ye({error:n})))).subscribe(n=>{if(n?.error)throw this.loadingCount.update(r=>r-1),n.error;if(i.length>0){let r=i.map(o=>({wall_structure_id:e,material_layer_id:o.materialId,position:o.position}));$e(this.supabase.from("wall_structure_layers").insert(r)).pipe(rt(o=>(console.error("Error adding new layers:",o),Ye({error:o}))),Qe(()=>this.loadingCount.update(o=>o-1))).subscribe(o=>{if(o?.error)throw o.error;this.structureLayers.reload()})}else this.loadingCount.update(r=>r-1),this.structureLayers.reload()})}};function Qfe(t,e){t&1&&(D(0,"div",5),ee(1,"hlm-spinner",10),F())}function Zfe(t,e){t&1&&(D(0,"p",15),se(1,"Name ist erforderlich"),F())}function ege(t,e){if(t&1){let i=je();D(0,"gh-material-dual-list",18),te("layersChanged",function(r){ie(i);let o=X(3);return ne(o.onLayersChanged(r))}),F()}if(t&2){let i=X(3);de("allMaterials",i.allMaterials())("initialSelectedLayers",i.currentLayers())}}function tge(t,e){if(t&1){let i=je();D(0,"gh-material-dual-list",19),te("layersChanged",function(r){ie(i);let o=X(3);return ne(o.onLayersChanged(r))}),F()}if(t&2){let i=X(3);de("allMaterials",i.allMaterials())}}function ige(t,e){if(t&1&&(D(0,"div",6)(1,"form",11)(2,"div",12)(3,"label",13),se(4,"Wandaufbau Name *"),F(),ee(5,"input",14),ze(6,Zfe,2,0,"p",15),F()(),ze(7,ege,1,2,"gh-material-dual-list",16)(8,tge,1,1,"gh-material-dual-list",17),F()),t&2){let i=X(2);M(),de("formGroup",i.form),M(5),Ve(i.form.controls.name.touched&&i.form.controls.name.invalid?6:-1),M(),Ve(i.isEdit()?7:8)}}function nge(t,e){if(t&1){let i=je();D(0,"hlm-sheet-content",2)(1,"hlm-sheet-header")(2,"h3",3),se(3),F(),D(4,"p",4),se(5,"Geben Sie den Namen ein und w\xE4hlen Sie die Materialien f\xFCr den Aufbau aus."),F()(),ze(6,Qfe,2,0,"div",5)(7,ige,9,3,"div",6),D(8,"hlm-sheet-footer",7)(9,"button",8),te("click",function(){let r=ie(i).$implicit;return ne(r.close())}),se(10," Abbrechen "),F(),D(11,"button",9),te("click",function(){let r=ie(i).$implicit,o=X();return ne(o.save(r))}),se(12," Speichern "),F()()()}if(t&2){let i=X();M(3),Ze(i.isEdit()?"Wandaufbau bearbeiten":"Neuer Wandaufbau"),M(3),Ve(i.loadingLayers()?6:7),M(5),de("disabled",i.form.invalid||i.service.loading())}}var $O=(()=>{class t{service=Z($r);structure=Re(null);state=Re("closed");stateChanged=ue();save$=ue();isEdit=Fe(()=>!!this.structure()?.id);selectedLayersSignal=ve([]);form=new Qa({name:new qn("",[Vo.required])});allMaterials=Fe(()=>this.service.materialLayers.value()||[]);loadingLayers=Fe(()=>this.structure()&&this.service.structureLayers.isLoading());currentLayers=Fe(()=>this.structure()?(this.service.structureLayers.value()||[]).map(r=>({id:r.id,materialId:r.material_layer_id,material:r.material,position:r.position})):[]);constructor(){pt(()=>{let i=this.structure();i?(this.form.patchValue({name:i.name||""}),this.service.selectStructure(i.id)):(this.form.reset(),this.selectedLayersSignal.set([]),this.service.selectStructure(null))})}onLayersChanged(i){this.selectedLayersSignal.set(i)}save(i){if(this.form.invalid)return;let n=this.form.value;this.save$.emit({structure:{name:n.name||""},layers:this.selectedLayersSignal()}),this.form.reset(),this.selectedLayersSignal.set([]),i.close()}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=Ie({type:t,selectors:[["gh-wall-structure-edit-sheet"]],inputs:{structure:[1,"structure"],state:[1,"state"]},outputs:{stateChanged:"stateChanged",save$:"save$"},decls:2,vars:1,consts:[["side","right",3,"stateChanged","state"],["class","w-full sm:max-w-5xl",4,"brnSheetContent"],[1,"w-full","sm:max-w-5xl"],["hlmSheetTitle",""],["hlmSheetDescription",""],[1,"flex","justify-center","items-center","h-[500px]"],[1,"space-y-6","p-4","overflow-y-auto","max-h-[calc(100vh-200px)]"],[1,"flex","justify-end","gap-2"],["hlmBtn","","variant","outline",3,"click"],["hlmBtn","",3,"click","disabled"],["size","large"],[3,"formGroup"],[1,"space-y-2"],["hlmLabel","","for","name"],["hlmInput","","id","name","formControlName","name","placeholder","z.B. Au\xDFenwand mit D\xE4mmung"],[1,"text-sm","text-destructive"],[3,"allMaterials","initialSelectedLayers"],[3,"allMaterials"],[3,"layersChanged","allMaterials","initialSelectedLayers"],[3,"layersChanged","allMaterials"]],template:function(n,r){n&1&&(D(0,"hlm-sheet",0),te("stateChanged",function(s){return r.stateChanged.emit(s)}),ar(1,nge,13,3,"hlm-sheet-content",1),F()),n&2&&de("state",r.state())},dependencies:[nl,Za,lr,cr,Ja,el,tl,Wo,Uo,jo,qo,$o,Ko,Yo,_t,bn,yn,ur,jO],encapsulation:2,changeDetection:0})}return t})();function rge(t,e){t&1&&(D(0,"p",12),se(1),fe(2,"transloco"),F()),t&2&&(M(),Ze(ge(2,1,"flexibleItems.dialog.nameRequired")))}function oge(t,e){if(t&1){let i=je();D(0,"hlm-sheet-content",2)(1,"hlm-sheet-header")(2,"h3",3),se(3),fe(4,"transloco"),F(),D(5,"p",4),se(6),fe(7,"transloco"),F()(),D(8,"form",5),te("ngSubmit",function(){ie(i);let r=X();return ne(r.onSubmit())}),D(9,"div",6),ee(10,"gh-icon-picker",7),F(),D(11,"div",8)(12,"div",9)(13,"label",10),se(14),fe(15,"transloco"),F(),ee(16,"input",11),fe(17,"transloco"),ze(18,rge,3,3,"p",12),F()(),D(19,"div",13)(20,"label",14),se(21),fe(22,"transloco"),F(),D(23,"gh-tiptap-editor",15),te("contentChange",function(r){ie(i);let o=X();return o.form.controls.description.setValue(r),o.form.controls.description.markAsDirty(),ne(o.form.controls.description.markAsTouched())}),F(),D(24,"p",16),se(25),fe(26,"transloco"),F()(),D(27,"div",13)(28,"gh-property-editor",17),te("valueChange",function(r){ie(i);let o=X();return o.form.controls.userProperties.setValue(r),o.form.controls.userProperties.markAsDirty(),ne(o.form.controls.userProperties.markAsTouched())}),F()()(),D(29,"hlm-sheet-footer",18)(30,"button",19),te("click",function(){ie(i);let r=X();return ne(r.onCancel())}),se(31),fe(32,"transloco"),F(),D(33,"button",20),te("click",function(){ie(i);let r=X();return ne(r.onSubmit())}),se(34),fe(35,"transloco"),F()()()}if(t&2){let i=X();M(3),Ze(ge(4,14,i.dialogTitle())),M(3),Ke(" ",ge(7,16,"flexibleItems.dialog.description")," "),M(2),de("formGroup",i.form),M(6),Ze(ge(15,18,"flexibleItems.dialog.nameLabel")),M(2),de("placeholder",ge(17,20,"flexibleItems.dialog.namePlaceholder")),M(2),Ve(i.form.controls.name.invalid&&i.form.controls.name.touched?18:-1),M(3),Ze(ge(22,22,"flexibleItems.dialog.descriptionLabel")),M(2),de("initialContent",i.form.controls.description.value),M(2),Ze(ge(26,24,"flexibleItems.dialog.descriptionHint")),M(3),de("mode","view")("initialValue",i.form.controls.userProperties.value),M(3),Ke(" ",ge(32,26,"common.cancel")," "),M(2),de("disabled",i.form.invalid),M(),Ke(" ",ge(35,28,"common.save")," ")}}var KO=(()=>{class t{service=Z(Hr);state=Re.required();item=Re(null);stateChanged=ue();form=new Qa({name:new qn("",{nonNullable:!0,validators:[Vo.required]}),description:new qn("",{nonNullable:!0}),userProperties:new qn(null,{nonNullable:!0}),icon:new qn("lucideBox",{nonNullable:!0})});dialogTitle=Fe(()=>this.item()?"flexibleItems.dialog.editTitle":"flexibleItems.dialog.addTitle");constructor(){pt(()=>{let i=this.item();console.log("Current Item changed:",i),i?this.form.patchValue({name:i.name,description:i.description||"",userProperties:i.user_defined_properties||null,icon:i.icon||"lucideBox"}):this.form.reset({name:"",description:"",userProperties:null,icon:"lucideBox"})})}onSubmit(){if(this.form.invalid)return;let i=this.form.value,n=i.userProperties&&i.userProperties.length>0?i.userProperties:void 0,r=this.item();r?this.service.updateItem(r.id,{name:i.name,description:i.description||void 0,icon:i.icon||void 0,user_defined_properties:n}):this.service.createItem({name:i.name,description:i.description||void 0,icon:i.icon||void 0,user_defined_properties:n}),this.stateChanged.emit("closed")}onCancel(){this.stateChanged.emit("closed")}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=Ie({type:t,selectors:[["gh-flexible-item-dialog"]],inputs:{state:[1,"state"],item:[1,"item"]},outputs:{stateChanged:"stateChanged"},features:[Xe([vi(Hs)])],decls:2,vars:1,consts:[["side","right",3,"stateChanged","state"],["class","w-full sm:max-w-3xl",4,"brnSheetContent"],[1,"w-full","sm:max-w-3xl"],["hlmSheetTitle",""],["hlmSheetDescription",""],[1,"space-y-6","p-4","overflow-y-auto","max-h-[calc(100vh-200px)]",3,"ngSubmit","formGroup"],[1,"flex","justify-center","items-center"],["formControlName","icon"],[1,"flex","gap-2","items-center","w-full"],[1,"space-y-2","flex-1"],["hlmLabel","","for","name"],["hlmInput","","id","name","type","text","formControlName","name","required","",3,"placeholder"],[1,"text-sm","text-destructive"],[1,"space-y-2"],["hlmLabel",""],["minHeight","200px",3,"contentChange","initialContent"],[1,"text-xs","text-muted-foreground"],[3,"valueChange","mode","initialValue"],[1,"flex","justify-end","gap-2"],["hlmBtn","","variant","outline","type","button",3,"click"],["hlmBtn","","variant","default","type","button",3,"click","disabled"]],template:function(n,r){n&1&&(D(0,"hlm-sheet",0),te("stateChanged",function(s){return r.stateChanged.emit(s)}),ar(1,oge,36,30,"hlm-sheet-content",1),F()),n&2&&de("state",r.state())},dependencies:[nl,Za,lr,cr,Ja,Sx,el,tl,wn,Wo,Uo,jo,qo,$o,Ko,Yo,_t,bn,yn,mO,$5,sE,Cn],encapsulation:2,changeDetection:0})}return t})();function sge(t,e){t&1&&(D(0,"div",8),ee(1,"hlm-spinner",11),F())}function age(t,e){if(t&1){let i=je();D(0,"div",9)(1,"ag-grid-angular",12),te("gridReady",function(r){ie(i);let o=X();return ne(o.onGridReady(r))}),F()()}if(t&2){let i=X();M(),de("rowData",i.items())("columnDefs",i.columnDefs)("defaultColDef",i.defaultColDef)("rowSelection",i.rowSelection)("theme",i.theme)}}Bm.registerModules([Xm]);var YO=(()=>{class t{theme=jm;service=Z(Hr);gridApi=ve(null);sheetState=ve("closed");editingItem=ve(null);items=Fe(()=>this.service.flexibleItems.value()||[]);loading=Fe(()=>this.service.flexibleItems.isLoading()||this.service.loading());columnDefs=[{field:"name",headerName:"Name",flex:1,minWidth:200},{field:"description",headerName:"Beschreibung",flex:2,minWidth:250,valueFormatter:i=>{if(!i.value)return"";let n=document.createElement("div");return n.innerHTML=i.value,n.textContent||n.innerText||""}},{field:"user_defined_properties",headerName:"Eigenschaften",flex:1,minWidth:150,valueFormatter:i=>!i.value||Object.keys(i.value).length===0?"-":`${Object.keys(i.value).length} Eigenschaften`},{field:"created_at",headerName:"Erstellt am",width:180,valueFormatter:i=>i.value?new Date(i.value).toLocaleDateString("de-DE"):""},{headerName:"Aktionen",width:100,cellRenderer:Na,cellRendererParams:{actions:[{icon:"lucidePencil",variant:"ghost",action:i=>this.editItem(i)}]},sortable:!1,filter:!1}];defaultColDef={sortable:!0,filter:!0,resizable:!0};rowSelection={mode:"multiRow"};onGridReady(i){this.gridApi.set(i.api)}addItem(){this.editingItem.set(null),this.sheetState.set("open")}editItem(i){this.editingItem.set(i),this.sheetState.set("open")}deleteSelectedItems(){let i=this.gridApi();if(!i)return;let n=i.getSelectedRows();if(n.length===0){alert("Bitte w\xE4hlen Sie mindestens ein Element aus.");return}if(confirm(`M\xF6chten Sie wirklich ${n.length} Element(e) l\xF6schen?`)){let r=n.map(o=>o.id);this.service.deleteItems(r)}}onSheetStateChanged(i){this.sheetState.set(i),i==="closed"&&this.editingItem.set(null)}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=Ie({type:t,selectors:[["gh-flexible-items"]],features:[Xe([Hr,vi({lucidePlus:Go,lucideTrash:dr,lucidePencil:rl})])],decls:17,vars:15,consts:[[1,"p-4","md:p-6","space-y-6"],[1,"flex","flex-col","space-y-4"],[3,"title","description"],[1,"flex","flex-wrap","gap-2"],["hlmBtn","","variant","default",3,"click"],["hlm","","name","lucidePlus","size","sm",1,"mr-2"],["hlmBtn","","variant","destructive",3,"click"],["hlm","","name","lucideTrash","size","sm",1,"mr-2"],[1,"flex","justify-center","p-8"],[1,"h-[600px]","w-full"],[3,"stateChanged","state","item"],["size","large"],[1,"w-full","h-full",3,"gridReady","rowData","columnDefs","defaultColDef","rowSelection","theme"]],template:function(n,r){n&1&&(D(0,"div",0)(1,"div",1),ee(2,"gh-section-header",2),fe(3,"transloco"),fe(4,"transloco"),D(5,"div",3)(6,"button",4),te("click",function(){return r.addItem()}),ee(7,"ng-icon",5),se(8),fe(9,"transloco"),F(),D(10,"button",6),te("click",function(){return r.deleteSelectedItems()}),ee(11,"ng-icon",7),se(12),fe(13,"transloco"),F()()(),ze(14,sge,2,0,"div",8)(15,age,2,5,"div",9),F(),D(16,"gh-flexible-item-dialog",10),te("stateChanged",function(s){return r.onSheetStateChanged(s)}),F()),n&2&&(M(2),de("title",ge(3,7,"flexibleItems.title"))("description",ge(4,9,"flexibleItems.description")),M(6),Ke(" ",ge(9,11,"flexibleItems.addNew")," "),M(4),Ke(" ",ge(13,13,"flexibleItems.deleteSelected")," "),M(2),Ve(r.loading()?14:15),M(2),de("state",r.sheetState())("item",r.editingItem()))},dependencies:[vn,yc,_t,ur,wi,Ci,wn,sl,KO,Cn],encapsulation:2,changeDetection:0})}return t})();var Ls=class{supabaseGlobal=Z(ol);authService=Z(rE);supabase=this.supabaseGlobal.supabase;loadingCount=ve(0);loading=Fe(()=>this.loadingCount()>0);plans=jn({loader:async()=>{let{data:e,error:i}=await this.supabase.from("house_plans").select("*").order("created_at",{ascending:!1});if(i)throw i;return e||[]}});planIdSignal=ve(null);currentPlan=jn({params:()=>({planId:this.planIdSignal()}),loader:async({params:e})=>{if(!e.planId)return null;let{data:i,error:n}=await this.supabase.from("house_plans").select("*").eq("id",e.planId).single();if(n)throw n;return i}});currentPlanWalls=jn({params:()=>({planId:this.planIdSignal()}),loader:async({params:e})=>{if(!e.planId)return[];let{data:i,error:n}=await this.supabase.from("house_plan_walls").select("*").eq("house_plan_id",e.planId).order("created_at",{ascending:!0});if(n)throw n;return i||[]}});loadPlan(e){this.planIdSignal.set(e)}createPlan(e){this.loadingCount.update(n=>n+1);let i=this.authService.user()?.id;if(!i){console.error("User not authenticated"),this.loadingCount.update(n=>n-1);return}$e(this.supabase.from("house_plans").insert({user_id:i,name:e.name,description:e.description||null,scale:e.scale||20}).select().single()).pipe(rt(n=>(console.error("Error creating plan:",n),Ye({error:n}))),Qe(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error){console.error("Failed to create plan:",n.error);return}this.plans.reload()})}updatePlan(e,i){this.loadingCount.update(n=>n+1),$e(this.supabase.from("house_plans").update(i).eq("id",e).select().single()).pipe(rt(n=>(console.error("Error updating plan:",n),Ye({error:n}))),Qe(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error){console.error("Failed to update plan:",n.error);return}this.plans.reload(),this.planIdSignal()===e&&this.currentPlan.reload()})}deletePlan(e){this.loadingCount.update(i=>i+1),$e(this.supabase.from("house_plans").delete().eq("id",e)).pipe(rt(i=>(console.error("Error deleting plan:",i),Ye({error:i}))),Qe(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error){console.error("Failed to delete plan:",i.error);return}this.plans.reload()})}clearCurrentPlan(){this.planIdSignal.set(null)}createWall(e){this.loadingCount.update(i=>i+1),$e(this.supabase.from("house_plan_walls").insert({house_plan_id:e.house_plan_id,wall_structure_id:e.wall_structure_id||null,name:e.name||null,start_x:e.start_x,start_y:e.start_y,end_x:e.end_x,end_y:e.end_y,color:e.color||"#000000"}).select().single()).pipe(rt(i=>(console.error("Error creating wall:",i),Ye({error:i}))),Qe(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error){console.error("Failed to create wall:",i.error);return}this.planIdSignal()===e.house_plan_id&&this.currentPlanWalls.reload()})}updateWall(e,i){this.loadingCount.update(n=>n+1),$e(this.supabase.from("house_plan_walls").update(i).eq("id",e).select().single()).pipe(rt(n=>(console.error("Error updating wall:",n),Ye({error:n}))),Qe(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error){console.error("Failed to update wall:",n.error);return}this.currentPlanWalls.reload()})}deleteWall(e){this.loadingCount.update(i=>i+1),$e(this.supabase.from("house_plan_walls").delete().eq("id",e)).pipe(rt(i=>(console.error("Error deleting wall:",i),Ye({error:i}))),Qe(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error){console.error("Failed to delete wall:",i.error);return}this.currentPlanWalls.reload()})}deleteWalls(e){this.loadingCount.update(i=>i+1),$e(this.supabase.from("house_plan_walls").delete().in("id",e)).pipe(rt(i=>(console.error("Error deleting walls:",i),Ye({error:i}))),Qe(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error){console.error("Failed to delete walls:",i.error);return}this.currentPlanWalls.reload()})}};var lge=()=>[];function cge(t,e){t&1&&(D(0,"div",1),ee(1,"hlm-spinner",5),F())}function dge(t,e){if(t&1){let i=je();D(0,"div",2)(1,"p"),se(2),fe(3,"transloco"),F(),D(4,"button",6),te("click",function(){ie(i);let r=X();return ne(r.goBack())}),ee(5,"ng-icon",7),se(6),fe(7,"transloco"),F()()}if(t&2){let i=X();M(2),td("",ge(3,3,"common.error"),": ",i.plansService.currentPlan.error()),M(4),Ke(" ",ge(7,5,"common.back")," ")}}function uge(t,e){if(t&1){let i=je();D(0,"div",35)(1,"span",38),se(2),F(),D(3,"button",39),fe(4,"transloco"),te("click",function(){ie(i);let r=X(2);return r.selectedFlexibleItemId.set(null),ne(r.drawingMode.set("select"))}),ee(5,"ng-icon",25),F()()}if(t&2){let i=X(2);M(2),Ze(i.selectedFlexibleItemName()),M(),de("hlmTooltipTrigger",ge(4,2,"housePlan.clearSelection"))}}function hge(t,e){if(t&1){let i=je();D(0,"div",8)(1,"div",9)(2,"button",10),te("click",function(){ie(i);let r=X();return ne(r.goBack())}),ee(3,"ng-icon",11),F(),D(4,"div")(5,"h1",12),se(6),fe(7,"transloco"),F(),D(8,"p",13),se(9),fe(10,"transloco"),F()()(),D(11,"div",14)(12,"button",15),te("click",function(){ie(i);let r=X();return ne(r.clearAll())}),ee(13,"ng-icon",16),se(14),fe(15,"transloco"),F(),D(16,"button",17),te("click",function(){ie(i);let r=X();return ne(r.savePlan())}),ee(17,"ng-icon",18),se(18),fe(19,"transloco"),F()()(),D(20,"div",19)(21,"div",20)(22,"button",21),fe(23,"transloco"),te("click",function(){ie(i);let r=X();return ne(r.setDrawingMode("select"))}),ee(24,"ng-icon",22),F(),D(25,"button",21),fe(26,"transloco"),te("click",function(){ie(i);let r=X();return ne(r.setDrawingMode("draw"))}),ee(27,"ng-icon",23),F(),D(28,"button",21),fe(29,"transloco"),te("click",function(){ie(i);let r=X();return ne(r.setDrawingMode("move"))}),ee(30,"ng-icon",24),F(),D(31,"button",21),fe(32,"transloco"),te("click",function(){ie(i);let r=X();return ne(r.setDrawingMode("delete"))}),ee(33,"ng-icon",25),F(),D(34,"button",26),fe(35,"transloco"),te("click",function(){ie(i);let r=X();return ne(r.setDrawingMode("add-item"))}),ee(36,"ng-icon",27),F(),ee(37,"div",28),D(38,"button",29),fe(39,"transloco"),te("click",function(){ie(i);let r=X();return ne(r.zoomIn())}),ee(40,"ng-icon",30),F(),D(41,"button",29),fe(42,"transloco"),te("click",function(){ie(i);let r=X();return ne(r.zoomOut())}),ee(43,"ng-icon",31),F(),D(44,"button",29),fe(45,"transloco"),te("click",function(){ie(i);let r=X();return ne(r.resetZoom())}),ee(46,"ng-icon",32),F(),ee(47,"div",28),D(48,"div",33)(49,"hlm-autocomplete",34),zo("searchChange",function(r){ie(i);let o=X();return Xr(o.flexibleItemSearch,r)||(o.flexibleItemSearch=r),ne(r)}),te("valueChange",function(r){ie(i);let o=X();return ne(o.handleFlexibleItemSelection(r))}),F()(),ze(50,uge,6,4,"div",35),F(),D(51,"div",36)(52,"gh-house-plan-canvas",37),zo("wallsChange",function(r){ie(i);let o=X();return Xr(o.walls,r)||(o.walls=r),ne(r)})("itemsChange",function(r){ie(i);let o=X();return Xr(o.planItems,r)||(o.planItems=r),ne(r)}),te("wallClicked",function(r){ie(i);let o=X();return ne(o.onWallClick(r))})("wallCreated",function(r){ie(i);let o=X();return ne(o.onWallCreated(r))})("wallMoved",function(r){ie(i);let o=X();return ne(o.onWallMoved(r))})("wallDeleted",function(r){ie(i);let o=X();return ne(o.onWallDeleted(r))})("itemMoved",function(r){ie(i);let o=X();return ne(o.onItemMoved(r))})("itemDeleted",function(r){ie(i);let o=X();return ne(o.onItemDeleted(r))})("itemPlaced",function(r){ie(i);let o=X();return ne(o.onFlexibleItemPlaced(r))})("stagePositionChanged",function(r){ie(i);let o=X();return ne(o.onStagePositionChanged(r))}),F()()()}if(t&2){let i,n=X();M(6),Ke(" ",((i=n.plansService.currentPlan.value())==null?null:i.name)||ge(7,36,"housePlan.title")," "),M(3),Ze(ge(10,38,"housePlan.subtitle")),M(5),Ke(" ",ge(15,40,"common.clear")," "),M(2),de("disabled",n.plansService.loading()),M(2),Ke(" ",ge(19,42,"common.save")," "),M(4),de("variant",n.drawingMode()==="select"?"default":"outline")("hlmTooltipTrigger",ge(23,44,"housePlan.select")),M(3),de("variant",n.drawingMode()==="draw"?"default":"outline")("hlmTooltipTrigger",ge(26,46,"housePlan.drawWall")),M(3),de("variant",n.drawingMode()==="move"?"default":"outline")("hlmTooltipTrigger",ge(29,48,"housePlan.move")),M(3),de("variant",n.drawingMode()==="delete"?"destructive":"outline")("hlmTooltipTrigger",ge(32,50,"housePlan.delete")),M(3),de("variant",n.drawingMode()==="add-item"?"default":"outline")("hlmTooltipTrigger",ge(35,52,"housePlan.placeFlexibleItem"))("disabled",!n.selectedFlexibleItemId()),M(4),de("hlmTooltipTrigger",ge(39,54,"housePlan.zoomIn"))("disabled",n.zoom()>=n.maxZoom),M(3),de("hlmTooltipTrigger",ge(42,56,"housePlan.zoomOut"))("disabled",n.zoom()<=n.minZoom),M(3),de("hlmTooltipTrigger",ge(45,58,"housePlan.resetZoom"))("disabled",n.zoom()===1&&n.stagePosition().x===0&&n.stagePosition().y===0),M(5),de("searchPlaceholderText","Select item to place...")("filteredOptions",n.filteredFlexibleItems()),Ho("search",n.flexibleItemSearch),de("autocompleteEmptyClass","p-2 text-sm text-muted-foreground"),M(),Ve(n.selectedFlexibleItem()?50:-1),M(2),de("canvasWidth",n.canvasWidth)("canvasHeight",n.canvasHeight)("gridSize",n.gridSize)("drawingMode",n.drawingMode())("zoom",n.zoom())("stagePosition",n.stagePosition()),Ho("walls",n.walls)("items",n.planItems),de("activeFlexibleItemId",n.selectedFlexibleItemId())}}function pge(t,e){if(t&1){let i=je();D(0,"div",48)(1,"span",38),se(2),F(),D(3,"button",51),te("click",function(){ie(i);let r=X(2);return ne(r.clearWallStructure())}),ee(4,"ng-icon",25),F()()}if(t&2){let i=X(2);M(2),Ze(i.selectedWallStructure().name)}}function fge(t,e){t&1&&(D(0,"p",52),se(1),fe(2,"transloco"),F()),t&2&&(M(),Ke("",ge(2,1,"common.loading"),"..."))}function gge(t,e){t&1&&(D(0,"p",52),se(1),fe(2,"transloco"),F()),t&2&&(M(),Ze(ge(2,1,"housePlan.noStructuresAvailable")))}function mge(t,e){if(t&1){let i=je();D(0,"hlm-autocomplete",34),fe(1,"transloco"),zo("searchChange",function(r){ie(i);let o=X(2);return Xr(o.wallStructureSearch,r)||(o.wallStructureSearch=r),ne(r)}),te("valueChange",function(r){ie(i);let o=X(2);return ne(o.handleWallStructureSelection(r))}),F(),ze(2,fge,3,3,"p",52)(3,gge,3,3,"p",52)}if(t&2){let i=X(2);de("searchPlaceholderText",ge(1,5,"housePlan.searchWallStructure"))("filteredOptions",i.filteredWallStructures()),Ho("search",i.wallStructureSearch),de("autocompleteEmptyClass","p-2 text-sm text-muted-foreground"),M(2),Ve(i.wallStructuresService.wallStructures.isLoading()?2:(i.wallStructuresService.wallStructures.value()||hp(7,lge)).length===0?3:-1)}}function vge(t,e){if(t&1&&(D(0,"div",49)(1,"p",38),se(2),fe(3,"transloco"),F(),D(4,"p",47),se(5),fe(6,"transloco"),F()()),t&2){let i=X(2);M(2),Ze(ge(3,3,"housePlan.dimensions")),M(3),td(" ",ge(6,5,"housePlan.length"),": ",i.calculateWallLength(i.selectedWall()).toFixed(2)," m ")}}function Cge(t,e){if(t&1){let i=je();D(0,"hlm-sheet-content")(1,"hlm-sheet-header")(2,"h3",40),se(3),fe(4,"transloco"),F(),D(5,"p",41),se(6),fe(7,"transloco"),F()(),D(8,"div",42)(9,"div",43)(10,"label",44),se(11),fe(12,"transloco"),F(),D(13,"input",45),zo("ngModelChange",function(r){ie(i);let o=X();return Xr(o.wallName,r)||(o.wallName=r),ne(r)}),F()(),D(14,"div",43)(15,"label",46),se(16),fe(17,"transloco"),F(),D(18,"p",47),se(19),fe(20,"transloco"),F(),ze(21,pge,5,1,"div",48)(22,mge,4,8),F(),ze(23,vge,7,7,"div",49),F(),D(24,"hlm-sheet-footer")(25,"button",15),te("click",function(){ie(i);let r=X();return ne(r.closeMetadataSheet())}),se(26),fe(27,"transloco"),F(),D(28,"button",50),te("click",function(){ie(i);let r=X();return ne(r.saveWallMetadata())}),se(29),fe(30,"transloco"),F()()()}if(t&2){let i=X();M(3),Ze(ge(4,10,"housePlan.wallMetadata")),M(3),Ze(ge(7,12,"housePlan.wallMetadataDesc")),M(5),Ke(" ",ge(12,14,"housePlan.wallName")," "),M(2),Ho("ngModel",i.wallName),M(3),Ze(ge(17,16,"housePlan.wallStructure")),M(3),Ze(ge(20,18,"housePlan.wallStructureDesc")),M(2),Ve(i.selectedWallStructure()?21:22),M(2),Ve(i.selectedWall()?23:-1),M(3),Ke(" ",ge(27,20,"common.cancel")," "),M(3),Ke(" ",ge(30,22,"common.save")," ")}}var XO=(()=>{class t{route=Z(Cx);router=Z(fp);plansService=Z(Ls);wallStructuresService=Z($r);flexibleItemsService=Z(Hr);planItemsResource=this.createPlanItemsResource();constructor(){pt(()=>{let i=oE(Kn.app.homeDocumentation.housePlan,this.route.snapshot.params).id;i&&this.plansService.loadPlan(i)}),pt(()=>{let i=this.plansService.currentPlanWalls.value();i&&this.walls.set(i)}),this.planItemsResource&&pt(()=>{let i=this.planItemsResource.value();i&&this.planItems.set(i)})}canvasWidth=1600;canvasHeight=1200;gridSize=20;zoom=ve(1);minZoom=.1;maxZoom=5;stagePosition=ve({x:0,y:0});drawingMode=ve("select");walls=ve([]);selectedWallId=ve(null);planItems=ve([]);isMetadataSheetOpen=ve(!1);selectedWall=Fe(()=>{let i=this.selectedWallId();return i&&this.walls().find(n=>n.id===i)||null});wallName=ve("");wallStructureId=ve(null);wallStructureSearch=ve("");selectedFlexibleItemId=ve(null);flexibleItemSearch=ve("");filteredWallStructures=Fe(()=>{let i=this.wallStructuresService.wallStructures.value()||[],n=this.wallStructureSearch().toLowerCase();return n?i.filter(r=>r.name.toLowerCase().includes(n)):i});filteredFlexibleItems=Fe(()=>{let i=this.flexibleItemsService.flexibleItems.value()||[],n=this.flexibleItemSearch().toLowerCase();return n?i.filter(r=>{let o=(r.description||"").toLowerCase();return r.name.toLowerCase().includes(n)||o.includes(n)}):i});selectedFlexibleItem=Fe(()=>{let i=this.selectedFlexibleItemId();return i&&(this.flexibleItemsService.flexibleItems.value()||[]).find(n=>n.id===i)||null});selectedFlexibleItemName=Fe(()=>this.selectedFlexibleItem()?.name||"");selectedWallStructure=Fe(()=>{let i=this.wallStructureId();return i&&(this.wallStructuresService.wallStructures.value()||[]).find(r=>r.id===i)||null});setDrawingMode(i){this.drawingMode.set(i),i!=="select"&&this.selectedWallId.set(null)}onWallClick(i){this.selectedWallId.set(i);let n=this.walls().find(r=>r.id===i);n&&(this.wallName.set(n.name||""),this.wallStructureId.set(n.wall_structure_id||null),this.wallStructureSearch.set(""),this.isMetadataSheetOpen.set(!0))}onWallCreated(i){let n=this.route.snapshot.paramMap.get("id");n&&this.plansService.createWall({house_plan_id:n,start_x:i.start_x,start_y:i.start_y,end_x:i.end_x,end_y:i.end_y,color:"#1f2937",name:`Wall ${this.walls().length+1}`})}onWallMoved(i){this.plansService.updateWall(i.id,{start_x:i.start_x,start_y:i.start_y,end_x:i.end_x,end_y:i.end_y})}onWallDeleted(i){this.plansService.deleteWall(i)}handleWallStructureSelection(i){this.wallStructureId.set(i),this.wallStructureSearch.set("")}handleFlexibleItemSelection(i){this.selectedFlexibleItemId.set(i),this.drawingMode.set("add-item")}clearWallStructure(){this.wallStructureId.set(null),this.wallStructureSearch.set("")}saveWallMetadata(){let i=this.selectedWallId();i&&(this.plansService.updateWall(i,{name:this.wallName()||void 0,wall_structure_id:this.wallStructureId()||void 0}),this.isMetadataSheetOpen.set(!1))}closeMetadataSheet(){this.isMetadataSheetOpen.set(!1),this.selectedWallId.set(null),this.wallStructureSearch.set("")}deleteSelectedWall(){let i=this.selectedWallId();i&&(this.plansService.deleteWall(i),this.isMetadataSheetOpen.set(!1),this.selectedWallId.set(null))}clearAll(){if(confirm("Are you sure you want to clear all walls?")){let i=this.walls().map(n=>n.id);i.length>0&&this.plansService.deleteWalls(i),this.selectedWallId.set(null)}}savePlan(){}goBack(){this.router.navigate([wp(Kn.app.homeDocumentation.housePlans,{})])}calculateWallLength(i){let n=Math.sqrt(Math.pow(i.end_x-i.start_x,2)+Math.pow(i.end_y-i.start_y,2)),r=this.plansService.currentPlan.value()?.scale||20;return n/r}zoomIn(){let i=this.zoom(),n=Math.min(this.maxZoom,i*1.2),r=this.canvasWidth/2,o=this.canvasHeight/2,s=this.stagePosition(),a={x:(r-s.x)/i,y:(o-s.y)/i},l={x:r-a.x*n,y:o-a.y*n};this.zoom.set(n),this.stagePosition.set(l)}zoomOut(){let i=this.zoom(),n=Math.max(this.minZoom,i/1.2),r=this.canvasWidth/2,o=this.canvasHeight/2,s=this.stagePosition(),a={x:(r-s.x)/i,y:(o-s.y)/i},l={x:r-a.x*n,y:o-a.y*n};this.zoom.set(n),this.stagePosition.set(l)}resetZoom(){this.zoom.set(1),this.stagePosition.set({x:0,y:0})}onStagePositionChanged(i){this.stagePosition.set(i)}onFlexibleItemPlaced(i){let n=this.route.snapshot.paramMap.get("id"),r=this.selectedFlexibleItemId();!n||!r||this.flexibleItemsService.addItemToHousePlan({house_plan_id:n,flexible_item_id:r,position_x:i.x,position_y:i.y},o=>{this.planItems.update(s=>[...s,k(w({},o),{item:this.selectedFlexibleItem()||void 0})]),this.planItemsResource?.reload()})}onItemMoved(i){this.planItems.update(n=>n.map(r=>r.id===i.id?k(w({},r),{position_x:i.position_x,position_y:i.position_y}):r)),this.flexibleItemsService.updateHousePlanItem(i.id,{position_x:i.position_x,position_y:i.position_y})}onItemDeleted(i){this.planItems.update(n=>n.filter(r=>r.id!==i)),this.flexibleItemsService.removeItemFromHousePlan(i)}createPlanItemsResource(){let i=this.route.snapshot.paramMap.get("id");return i?this.flexibleItemsService.getHousePlanItemsResource(i):null}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=Ie({type:t,selectors:[["gh-house-plan-editor"]],features:[Xe([Ls,$r,Hr,vi({lucidePointer:Hx,lucidePencil:rl,lucideMove:Bx,lucideTrash:dr,lucideSquare:Ux,lucideSave:Wx,lucideArrowUpDown:Px,lucideArrowLeft:xx,lucidePlus:Go,lucideMinus:Nx,lucideRotateCcw:Gx}),pE({transformOptionToString:i=>("flexible_item_id"in i,i.name),transformOptionToValue:i=>("flexible_item_id"in i,i.id)})])],decls:6,vars:2,consts:[[1,"h-full","flex","flex-col"],[1,"flex","items-center","justify-center","flex-1"],[1,"text-center","py-12","text-destructive","flex-1"],["side","right",3,"stateChanged","state"],[4,"brnSheetContent"],["size","large"],["hlmBtn","","variant","outline",1,"mt-4",3,"click"],["hlm","","name","lucideArrowLeft","size","sm",1,"mr-2"],[1,"flex","items-center","justify-between","p-4","md:p-6","pb-0"],[1,"flex","items-center","gap-4"],["hlmBtn","","variant","ghost","size","icon",3,"click"],["hlm","","name","lucideArrowLeft","size","sm"],[1,"text-2xl","md:text-3xl","font-bold"],[1,"text-muted-foreground","mt-1"],[1,"flex","gap-2"],["hlmBtn","","variant","outline",3,"click"],["hlm","","name","lucideTrash","size","sm",1,"mr-2"],["hlmBtn","",3,"click","disabled"],["hlm","","name","lucideSave","size","sm",1,"mr-2"],[1,"flex-1","flex","flex-col","p-4","md:p-6","pt-4","gap-4","min-h-0"],[1,"flex","items-center","gap-2","flex-wrap","w-full"],["hlmBtn","","size","icon",3,"click","variant","hlmTooltipTrigger"],["hlm","","name","lucidePointer","size","sm"],["hlm","","name","lucidePencil","size","sm"],["hlm","","name","lucideMove","size","sm"],["hlm","","name","lucideTrash","size","sm"],["hlmBtn","","size","icon",3,"click","variant","hlmTooltipTrigger","disabled"],["hlm","","name","lucideSquare","size","sm"],[1,"w-px","h-8","bg-border","mx-1"],["hlmBtn","","variant","outline","size","icon",3,"click","hlmTooltipTrigger","disabled"],["hlm","","name","lucidePlus","size","sm"],["hlm","","name","lucideMinus","size","sm"],["hlm","","name","lucideRotateCcw","size","sm"],[1,"w-64"],[3,"searchChange","valueChange","searchPlaceholderText","filteredOptions","search","autocompleteEmptyClass"],[1,"flex","items-center","gap-2","px-3","py-1","bg-accent","rounded-md"],[1,"flex-1","min-h-0","overflow-auto","border","rounded-md","bg-muted/30"],[3,"wallsChange","itemsChange","wallClicked","wallCreated","wallMoved","wallDeleted","itemMoved","itemDeleted","itemPlaced","stagePositionChanged","canvasWidth","canvasHeight","gridSize","drawingMode","zoom","stagePosition","walls","items","activeFlexibleItemId"],[1,"text-sm","font-medium"],["hlmBtn","","variant","ghost","size","icon",1,"h-6","w-6",3,"click","hlmTooltipTrigger"],["hlmSheetTitle",""],["hlmSheetDescription",""],[1,"space-y-4","px-4"],[1,"space-y-2"],["hlmLabel","","for","wall-name"],["hlmInput","","id","wall-name","type","text",3,"ngModelChange","ngModel"],["hlmLabel",""],[1,"text-sm","text-muted-foreground"],[1,"flex","items-center","justify-between","p-2","bg-accent","rounded-md"],[1,"space-y-2","pt-4","border-t"],["hlmBtn","",3,"click"],["hlmBtn","","variant","ghost","size","icon",1,"h-6","w-6",3,"click"],[1,"text-sm","text-muted-foreground","italic"]],template:function(n,r){n&1&&(D(0,"div",0),ze(1,cge,2,0,"div",1)(2,dge,8,7,"div",2)(3,hge,53,60),F(),D(4,"hlm-sheet",3),te("stateChanged",function(s){return r.isMetadataSheetOpen.set(s==="open")}),ar(5,Cge,31,24,"hlm-sheet-content",4),F()),n&2&&(M(),Ve(r.plansService.currentPlan.isLoading()?1:r.plansService.currentPlan.error()?2:3),M(3),de("state",r.isMetadataSheetOpen()?"open":"closed"))},dependencies:[vn,il,lr,cr,mp,_t,bn,yn,wi,Ci,ur,Uo,jo,qo,$o,Ko,Yo,fE,lE,Wo,wn,gv,Cn],encapsulation:2,changeDetection:0})}return t})();function wge(t,e){t&1&&(D(0,"div",5),ee(1,"hlm-spinner",9),F())}function bge(t,e){if(t&1&&(D(0,"div",6)(1,"p"),se(2),fe(3,"transloco"),F()()),t&2){let i=X();M(2),td("",ge(3,2,"common.error"),": ",i.plansService.plans.error())}}function yge(t,e){if(t&1){let i=je();D(0,"div",7)(1,"p",10),se(2),fe(3,"transloco"),F(),D(4,"button",3),te("click",function(){ie(i);let r=X();return ne(r.openCreateDialog())}),ee(5,"ng-icon",4),se(6),fe(7,"transloco"),F()()}t&2&&(M(2),Ze(ge(3,2,"housePlans.noPlans")),M(4),Ke(" ",ge(7,4,"housePlans.createFirst")," "))}function Sge(t,e){if(t&1&&ee(0,"ag-grid-angular",8),t&2){let i=X();de("rowData",i.plansService.plans.value())("columnDefs",i.columnDefs)("defaultColDef",i.defaultColDef)("gridOptions",i.gridOptions)}}function xge(t,e){if(t&1){let i=je();D(0,"div",11),te("click",function(){ie(i);let r=X();return ne(r.closeCreateDialog())}),F(),D(1,"div",12)(2,"div",13)(3,"div")(4,"h3",14),se(5),fe(6,"transloco"),F(),D(7,"p",15),se(8),fe(9,"transloco"),F()(),D(10,"div",16)(11,"label",17),se(12),fe(13,"transloco"),F(),D(14,"input",18),fe(15,"transloco"),zo("ngModelChange",function(r){ie(i);let o=X();return Xr(o.newPlanName,r)||(o.newPlanName=r),ne(r)}),F()(),D(16,"div",16)(17,"label",19),se(18),fe(19,"transloco"),F(),D(20,"textarea",20),fe(21,"transloco"),zo("ngModelChange",function(r){ie(i);let o=X();return Xr(o.newPlanDescription,r)||(o.newPlanDescription=r),ne(r)}),F()(),D(22,"div",21)(23,"button",22),te("click",function(){ie(i);let r=X();return ne(r.closeCreateDialog())}),se(24),fe(25,"transloco"),F(),D(26,"button",23),te("click",function(){ie(i);let r=X();return ne(r.createPlan())}),se(27),fe(28,"transloco"),F()()()()}if(t&2){let i=X();M(5),Ze(ge(6,11,"housePlans.createNewPlan")),M(3),Ze(ge(9,13,"housePlans.createNewPlanDesc")),M(4),Ke(" ",ge(13,15,"housePlans.planName")," "),M(2),Ho("ngModel",i.newPlanName),de("placeholder",ge(15,17,"housePlans.planNamePlaceholder")),M(4),Ke(" ",ge(19,19,"housePlans.planDescription")," "),M(2),Ho("ngModel",i.newPlanDescription),de("placeholder",ge(21,21,"housePlans.planDescriptionPlaceholder")),M(4),Ke(" ",ge(25,23,"common.cancel")," "),M(2),de("disabled",!i.newPlanName.trim()),M(),Ke(" ",ge(28,25,"common.create")," ")}}var JO=(()=>{class t{router=Z(fp);plansService=Z(Ls);columnDefs=[{headerName:"Name",field:"name",flex:2,sortable:!0,filter:!0},{headerName:"Description",field:"description",flex:3,sortable:!0,filter:!0},{headerName:"Created",field:"created_at",flex:2,sortable:!0,valueFormatter:i=>i.value?new Date(i.value).toLocaleDateString():""},{headerName:"Actions",cellRenderer:Na,cellRendererParams:{actions:[{icon:"lucideEye",variant:"ghost",action:i=>this.viewPlan(i.id)},{icon:"lucideTrash",variant:"ghost",action:i=>this.deletePlan(i.id)}]},flex:1,sortable:!1,filter:!1}];defaultColDef={resizable:!0,sortable:!0};gridOptions={rowHeight:48,headerHeight:48,pagination:!0,paginationPageSize:20,paginationPageSizeSelector:[10,20,50,100]};showCreateDialog=!1;newPlanName="";newPlanDescription="";openCreateDialog(){this.showCreateDialog=!0,this.newPlanName="",this.newPlanDescription=""}closeCreateDialog(){this.showCreateDialog=!1}createPlan(){this.newPlanName.trim()&&(this.plansService.createPlan({name:this.newPlanName,description:this.newPlanDescription||void 0}),this.closeCreateDialog())}viewPlan(i){this.router.navigate([aE(Kn.app.homeDocumentation.housePlan,{path:{id:i},query:{}}).path])}deletePlan(i){confirm("Are you sure you want to delete this plan?")&&this.plansService.deletePlan(i)}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=Ie({type:t,selectors:[["gh-house-plans-list"]],features:[Xe([Ls,vi({lucidePlus:Go,lucideEye:Tx,lucideTrash:dr})])],decls:15,vars:11,consts:[[1,"p-4","md:p-6","space-y-4"],[1,"flex","items-center","justify-between"],[3,"title","description"],["hlmBtn","",3,"click"],["hlm","","name","lucidePlus","size","sm",1,"mr-2"],[1,"flex","items-center","justify-center","py-12"],[1,"text-center","py-12","text-destructive"],[1,"text-center","py-12"],[1,"ag-theme-alpine",2,"width","100%","height","600px",3,"rowData","columnDefs","defaultColDef","gridOptions"],["size","large"],[1,"text-muted-foreground","mb-4"],[1,"fixed","inset-0","z-50","bg-black/50",3,"click"],[1,"fixed","left-1/2","top-1/2","z-50","w-full","max-w-lg","-translate-x-1/2","-translate-y-1/2","bg-background","shadow-lg","rounded-lg","p-6"],[1,"space-y-4"],[1,"text-lg","font-semibold"],[1,"text-sm","text-muted-foreground"],[1,"space-y-2"],["hlmLabel","","for","plan-name"],["hlmInput","","id","plan-name","type","text",3,"ngModelChange","ngModel","placeholder"],["hlmLabel","","for","plan-description"],["hlmInput","","id","plan-description","rows","3",3,"ngModelChange","ngModel","placeholder"],[1,"flex","gap-2","pt-4"],["hlmBtn","","variant","outline",1,"flex-1",3,"click"],["hlmBtn","",1,"flex-1",3,"click","disabled"]],template:function(n,r){n&1&&(D(0,"div",0)(1,"div",1),ee(2,"gh-section-header",2),fe(3,"transloco"),fe(4,"transloco"),D(5,"button",3),te("click",function(){return r.openCreateDialog()}),ee(6,"ng-icon",4),se(7),fe(8,"transloco"),F()(),D(9,"div"),ze(10,wge,2,0,"div",5)(11,bge,4,4,"div",6)(12,yge,8,6,"div",7)(13,Sge,1,4,"ag-grid-angular",8),F()(),ze(14,xge,29,27)),n&2&&(M(2),de("title",ge(3,5,"housePlans.title"))("description",ge(4,7,"housePlans.subtitle")),M(5),Ke(" ",ge(8,9,"housePlans.createNew")," "),M(3),Ve(r.plansService.plans.isLoading()?10:r.plansService.plans.error()?11:!r.plansService.plans.value()||r.plansService.plans.value().length===0?12:13),M(4),Ve(r.showCreateDialog?14:-1))},dependencies:[vn,il,lr,cr,mp,yc,_t,bn,yn,wi,Ci,ur,wn,sl,Cn],encapsulation:2,changeDetection:0})}return t})();function Ege(t,e){t&1&&(D(0,"div",10),ee(1,"hlm-spinner",16),F())}function Pge(t,e){if(t&1){let i=je();D(0,"div",11)(1,"ag-grid-angular",17),te("gridReady",function(r){ie(i);let o=X();return ne(o.onMaterialsGridReady(r))}),F()()}if(t&2){let i=X();M(),de("rowData",i.materialLayers())("columnDefs",i.materialColumnDefs)("defaultColDef",i.defaultColDef)("rowSelection",i.materialRowSelection)("theme",i.theme)}}function Rge(t,e){t&1&&(D(0,"div",10),ee(1,"hlm-spinner",16),F())}function _ge(t,e){if(t&1){let i=je();D(0,"div",13)(1,"ag-grid-angular",17),te("gridReady",function(r){ie(i);let o=X();return ne(o.onStructuresGridReady(r))}),F()()}if(t&2){let i=X();M(),de("rowData",i.wallStructures())("columnDefs",i.structureColumnDefs)("defaultColDef",i.defaultColDef)("rowSelection",i.rowSelection)("theme",i.theme)}}Bm.registerModules([Xm]);var QO=(()=>{class t{theme=jm;service=Z($r);materialsGridApi=ve(null);structuresGridApi=ve(null);editingMaterial=ve(null);editingStructure=ve(null);isMaterialSheetOpen=ve(!1);isStructureSheetOpen=ve(!1);materialLayers=Fe(()=>this.service.materialLayers.value()||[]);wallStructures=Fe(()=>this.service.wallStructures.value()||[]);materialColumnDefs=[{field:"name",headerName:"Materialname",flex:1},{field:"thickness",headerName:"Dicke (mm)",width:150,valueFormatter:i=>i.value?`${i.value} mm`:"0 mm"},{field:"description",headerName:"Beschreibung",flex:2},{headerName:"Aktionen",width:100,cellRenderer:Na,cellRendererParams:{actions:[{icon:"lucidePencil",variant:"ghost",action:i=>this.editMaterial(i)}]},sortable:!1,filter:!1}];structureColumnDefs=[{field:"name",headerName:"Wandaufbau Name",flex:1},{field:"created_at",headerName:"Erstellt am",width:180,valueFormatter:i=>i.value?new Date(i.value).toLocaleDateString("de-DE"):""},{headerName:"Aktionen",width:100,cellRenderer:Na,cellRendererParams:{actions:[{icon:"lucidePencil",variant:"ghost",action:i=>this.editStructure(i)}]},sortable:!1,filter:!1}];defaultColDef={sortable:!0,filter:!0,resizable:!0};rowSelection={mode:"singleRow"};materialRowSelection={mode:"multiRow"};onMaterialsGridReady(i){this.materialsGridApi.set(i.api)}onStructuresGridReady(i){this.structuresGridApi.set(i.api)}editMaterial(i){this.editingMaterial.set(i),this.isMaterialSheetOpen.set(!0)}editStructure(i){this.editingStructure.set(i),this.isStructureSheetOpen.set(!0)}onMaterialSave(i){let n=this.editingMaterial();if(n){let r={name:i.name,thickness:i.thickness,description:i.description===null?void 0:i.description};this.service.updateMaterialLayer(n.id,r)}else{if(!i.name||i.thickness===void 0)return;let r={name:i.name,thickness:i.thickness,description:i.description===null?void 0:i.description};this.service.createMaterialLayer(r)}this.editingMaterial.set(null),this.isMaterialSheetOpen.set(!1)}onStructureSave(i){let n=this.editingStructure();if(n){let r={name:i.structure.name};this.service.updateWallStructureWithLayers(n.id,r,i.layers)}else{if(!i.structure.name)return;let r={name:i.structure.name};this.service.createWallStructureWithLayers(r,i.layers)}this.editingStructure.set(null),this.isStructureSheetOpen.set(!1)}addMaterial(){this.editingMaterial.set(null),this.isMaterialSheetOpen.set(!0)}deleteSelectedMaterials(){let i=this.materialsGridApi();if(!i)return;let n=i.getSelectedRows();if(n.length>0){let r=n.map(o=>o.id);this.service.deleteMaterialLayers(r)}}addWallStructure(){this.editingStructure.set(null),this.isStructureSheetOpen.set(!0)}deleteSelectedStructure(){let i=this.structuresGridApi();if(!i)return;let n=i.getSelectedRows();n.length>0&&this.service.deleteWallStructure(n[0].id)}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=Ie({type:t,selectors:[["gh-wall-structures"]],features:[Xe([$r,vi({lucidePlus:Go,lucideTrash:dr,lucidePencil:rl})])],decls:36,vars:30,consts:[["materialSheet",""],["structureSheet",""],[1,"p-4","md:p-6","space-y-6"],[1,"flex","flex-col","space-y-4"],[3,"title","description"],[1,"flex","flex-wrap","gap-2"],["hlmBtn","","variant","default",3,"click"],["hlm","","name","lucidePlus","size","sm",1,"mr-2"],["hlmBtn","","variant","destructive",3,"click"],["hlm","","name","lucideTrash","size","sm",1,"mr-2"],[1,"flex","justify-center","p-8"],[1,"h-[300px]","w-full"],["hlmSeparator","",1,"my-6"],[1,"h-[400px]","w-full"],[3,"stateChanged","save$","material","state"],[3,"stateChanged","save$","structure","state"],["size","large"],[1,"w-full","h-full",3,"gridReady","rowData","columnDefs","defaultColDef","rowSelection","theme"]],template:function(n,r){if(n&1){let o=je();D(0,"div",2)(1,"div",3),ee(2,"gh-section-header",4),fe(3,"transloco"),fe(4,"transloco"),D(5,"div",5)(6,"button",6),te("click",function(){return ie(o),ne(r.addMaterial())}),ee(7,"ng-icon",7),se(8),fe(9,"transloco"),F(),D(10,"button",8),te("click",function(){return ie(o),ne(r.deleteSelectedMaterials())}),ee(11,"ng-icon",9),se(12),fe(13,"transloco"),F()()(),ze(14,Ege,2,0,"div",10)(15,Pge,2,5,"div",11),ee(16,"div",12),D(17,"div",3),ee(18,"gh-section-header",4),fe(19,"transloco"),fe(20,"transloco"),D(21,"div",5)(22,"button",6),te("click",function(){return ie(o),ne(r.addWallStructure())}),ee(23,"ng-icon",7),se(24),fe(25,"transloco"),F(),D(26,"button",8),te("click",function(){return ie(o),ne(r.deleteSelectedStructure())}),ee(27,"ng-icon",9),se(28),fe(29,"transloco"),F()()(),ze(30,Rge,2,0,"div",10)(31,_ge,2,5,"div",13),F(),D(32,"gh-material-edit-sheet",14,0),te("stateChanged",function(a){return ie(o),ne(r.isMaterialSheetOpen.set(a==="open"))})("save$",function(a){return ie(o),ne(r.onMaterialSave(a))}),F(),D(34,"gh-wall-structure-edit-sheet",15,1),te("stateChanged",function(a){return ie(o),ne(r.isStructureSheetOpen.set(a==="open"))})("save$",function(a){return ie(o),ne(r.onStructureSave(a))}),F()}n&2&&(M(2),de("title",ge(3,14,"wallStructures.materialLibrary.title"))("description",ge(4,16,"wallStructures.materialLibrary.description")),M(6),Ke(" ",ge(9,18,"wallStructures.materialLibrary.addNew")," "),M(4),Ke(" ",ge(13,20,"wallStructures.materialLibrary.deleteSelected")," "),M(2),Ve(r.service.materialLayers.isLoading()?14:15),M(4),de("title",ge(19,22,"wallStructures.structures.title"))("description",ge(20,24,"wallStructures.structures.description")),M(6),Ke(" ",ge(25,26,"wallStructures.structures.addNew")," "),M(4),Ke(" ",ge(29,28,"wallStructures.structures.deleteSelected")," "),M(2),Ve(r.service.wallStructures.isLoading()?30:31),M(2),de("material",r.editingMaterial())("state",r.isMaterialSheetOpen()?"open":"closed"),M(2),de("structure",r.editingStructure())("state",r.isStructureSheetOpen()?"open":"closed"))},dependencies:[vn,yc,_t,ur,Cp,wn,wi,Ci,sl,qO,$O,Cn],encapsulation:2,changeDetection:0})}return t})();var I8e=[{path:ld(Kn.app.homeDocumentation._.wallStructures),component:QO},{path:ld(Kn.app.homeDocumentation._.flexibleItems),component:YO},{path:ld(Kn.app.homeDocumentation._.housePlans),component:JO},{path:wp(Kn.app.homeDocumentation._.housePlan,{id:":id"}),component:XO},{path:"",redirectTo:ld(Kn.app.homeDocumentation._.wallStructures),pathMatch:"full"}];export{Kye as FileUploadComponent,XO as HousePlanEditorComponent,$5 as TiptapEditorComponent,QO as WallStructuresComponent,I8e as homeDocumentationRoutes};
