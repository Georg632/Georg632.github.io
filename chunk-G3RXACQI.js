import{e as ut,f as gt}from"./chunk-ZM5TKIQN.js";import{$ as H,$a as b,A as te,Ba as Re,Ca as Ie,Cd as X,Da as se,E as v,Ed as et,F as g,G as h,Ga as qe,Gc as Ye,Gd as tt,Hc as he,Ia as I,Ib as le,Ja as y,Jb as de,Ka as q,L as p,La as S,Lb as k,Ld as Q,Mb as ce,Md as it,Na as W,Nd as nt,O as Le,Oa as $,Ob as me,Oc as Ze,Od as ot,Pa as j,Pc as Ge,Pd as st,Qb as pe,Qd as rt,R as r,Ta as We,Tb as ue,Tc as fe,Ua as A,Ub as Qe,Ud as be,Vc as Xe,Wb as Ue,Wd as at,X as B,Xd as lt,Yb as ge,Yd as _e,Z as L,Zb as Ke,Zd as dt,_a as f,aa as De,ae as Me,cb as $e,cc as Y,db as l,de as ve,eb as z,ec as O,fa as M,fc as Z,g as N,ga as E,gb as re,ge as ct,h as w,ha as V,hb as G,he as mt,ib as c,ie as pt,jb as xe,k as ze,ka as ie,la as ne,lb as je,ma as C,mb as U,me as Se,na as a,o as P,oa as d,p as Oe,pa as T,pb as ae,pd as Je,r as D,tb as K,u as R,ua as F,va as oe,wa as m,x as ee,ya as u}from"./chunk-DKPONISH.js";import{a as J,b as Ve,c as Fe,d as Ae}from"./chunk-X37JSKTG.js";var ht=(()=>{class n{static _uniqueId=0;id=c(`brn-toggle-${++n._uniqueId}`);value=c();disabled=c(!1,{transform:ae});state=U("off");type=c("button");ariaLabel=c(null,{alias:"aria-label"});_isOn=l(()=>this.state()==="on");toggle(){this.disabled()||this.state.set(this._isOn()?"off":"on")}static \u0275fac=function(e){return new(e||n)};static \u0275dir=L({type:n,selectors:[["button","brnToggle",""]],hostVars:7,hostBindings:function(e,i){e&1&&m("click",function(){return i.toggle()}),e&2&&(oe("id",i.id())("type",i.type()),M("disabled",i.disabled()?!0:null)("data-disabled",i.disabled()?!0:null)("data-state",i.state())("aria-pressed",i._isOn())("aria-label",i.ariaLabel()||null))},inputs:{id:[1,"id"],value:[1,"value"],disabled:[1,"disabled"],state:[1,"state"],type:[1,"type"],ariaLabel:[1,"aria-label","ariaLabel"]},outputs:{state:"stateChange"}})}return n})();var It=ce('hover:bg-muted hover:text-muted-foreground focus-visible:border-ring data-[state=on]:bg-accent data-[state=on]:text-accent-foreground focus-visible:ring-ring/50 inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium whitespace-nowrap transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&_ng-icon]:pointer-events-none [&_ng-icon]:shrink-0 [&_ng-icon:not([class*="text-"])]:text-base',{variants:{variant:{default:"bg-transparent",outline:"border-input hover:bg-accent hover:text-accent-foreground border bg-transparent shadow-xs"},size:{default:"h-9 min-w-9 px-2",sm:"h-8 min-w-8 px-1.5",lg:"h-10 min-w-10 px-2.5"}},defaultVariants:{variant:"default",size:"default"}}),ke=(()=>{class n{variant=c("default");size=c("default");userClass=c("",{alias:"class"});_computedClass=l(()=>k(It({variant:this.variant(),size:this.size()}),this.userClass()));static \u0275fac=function(e){return new(e||n)};static \u0275dir=L({type:n,selectors:[["button","hlmToggle",""]],hostAttrs:["data-slot","toggle"],hostVars:2,hostBindings:function(e,i){e&2&&I(i._computedClass())},inputs:{variant:[1,"variant"],size:[1,"size"],userClass:[1,"class","userClass"]},features:[H([{directive:ht,inputs:["id","id","value","value","disabled","disabled","state","state","aria-label","aria-label","type","type"],outputs:["stateChange","stateChange"]}])]})}return n})();var _t=(()=>{class n{variant=c("default");size=c("default");disabled=c(!1);state=U("off");isAnimating=p(!1);animationDirection=p("");constructor(){z(()=>{let t=this.state();this.animationDirection()===""&&t==="off"||(t==="on"?this.animationDirection.set("fill"):this.animationDirection.set("empty"),this.isAnimating.set(!0),setTimeout(()=>{this.isAnimating.set(!1)},800))})}animationClass=l(()=>{if(!this.isAnimating())return"";let t=this.animationDirection();return t==="fill"?"animate-bounce-shake":t==="empty"?"animate-empty":""});buttonClass=l(()=>{let t=this.state(),e=this.animationClass(),i="";return t==="on"?i="bg-green-100 hover:bg-green-200 dark:bg-green-900/30 dark:hover:bg-green-900/50 border-green-300 dark:border-green-700":i="bg-muted/50 hover:bg-muted dark:bg-muted/20 dark:hover:bg-muted/40 border-muted-foreground/20",`${e} ${i}`});iconClass=l(()=>{let t=this.state(),e=this.isAnimating();if(t==="on"){let i="text-green-600 dark:text-green-400";return e&&this.animationDirection()==="fill"?`${i} animate-fill`:i}return"text-muted-foreground/60"});static \u0275fac=function(e){return new(e||n)};static \u0275cmp=B({type:n,selectors:[["gh-shopping-basket-toggle"]],inputs:{variant:[1,"variant"],size:[1,"size"],disabled:[1,"disabled"],state:[1,"state"]},outputs:{state:"stateChange"},features:[A([O({lucideShoppingBasket:Ze})])],decls:2,vars:9,consts:[["hlmToggle","",1,"relative","overflow-hidden","transition-all","duration-300",3,"stateChange","variant","size","disabled","state"],["hlm","",1,"transition-all","duration-500",3,"name"]],template:function(e,i){e&1&&(a(0,"button",0),j("stateChange",function(s){return $(i.state,s)||(i.state=s),s}),T(1,"ng-icon",1),d()),e&2&&(I(i.buttonClass()),C("variant",i.variant())("size",i.size())("disabled",i.disabled()),W("state",i.state),r(),I(i.iconClass()),C("name","lucideShoppingBasket"))},dependencies:[ke,Q,Z],styles:["@keyframes _ngcontent-%COMP%_bounce-shake{0%,to{transform:translateY(0) rotate(0) scale(1)}10%{transform:translateY(-8px) rotate(-5deg) scale(1.1)}20%{transform:translateY(-8px) rotate(5deg) scale(1.1)}30%{transform:translateY(-8px) rotate(-5deg) scale(1.1)}40%{transform:translateY(0) rotate(0) scale(1)}50%{transform:scale(.95)}60%{transform:scale(1.05)}70%{transform:scale(.98)}80%{transform:scale(1.02)}90%{transform:scale(1)}}@keyframes _ngcontent-%COMP%_fill-basket{0%{opacity:1}50%{opacity:.6;filter:brightness(1.5)}to{opacity:1}}@keyframes _ngcontent-%COMP%_empty-basket{0%{transform:scale(1);opacity:1}30%{transform:scale(.8) rotate(-10deg);opacity:.7}60%{transform:scale(1.1) rotate(10deg);opacity:.8}to{transform:scale(1) rotate(0);opacity:1}}.animate-bounce-shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_bounce-shake .8s ease-in-out}.animate-fill[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fill-basket .5s ease-in-out}.animate-empty[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_empty-basket .6s ease-in-out}[_nghost-%COMP%]{display:inline-block}"],changeDetection:0})}return n})();var Ce=(()=>{class n{supabase=v(ve);authService=v(dt);currentListId=p(null);loadingCount=p(0);loading=l(()=>this.loadingCount()>0);items=re({params:()=>({listId:this.currentListId()}),loader:async({params:t})=>{if(!t.listId)return[];let{data:e,error:i}=await this.supabase.supabase.from("shopping_list_item").select("*").eq("list_id",t.listId).order("created_at",{ascending:!1});if(i)throw i;return e??[]}});count=l(()=>this.items.value()?.length??0);setCurrentList(t){this.currentListId.set(t)}addItem(t,e){let i=this.currentListId();if(!i)return w({error:new Error("No list selected")});let o=this.authService.user()?.id;return o?(this.loadingCount.update(s=>s+1),N(this.supabase.supabase.from("shopping_list_item").insert({product_name:t,additional_info:e,list_id:i,creator_id:o,active:!0,active_changed:new Date().toISOString()}).select().single()).pipe(P(s=>w({error:s})),D(()=>this.loadingCount.update(s=>s-1)),ee(s=>{if(s?.error)throw s.error;this.items.reload()}),R(s=>{if(s?.error)throw s.error;return w(s.data)}))):w({error:new Error("User not authenticated")})}updateItem(t,e){return this.loadingCount.update(i=>i+1),N(this.supabase.supabase.from("shopping_list_item").update(e).eq("id",t).select().single()).pipe(P(i=>w({error:i})),D(()=>this.loadingCount.update(i=>i-1)),ee(i=>{if(i?.error)throw i.error;this.items.reload()}),R(i=>{if(i?.error)throw i.error;return w(i.data)}))}deleteItem(t){return this.loadingCount.update(e=>e+1),N(this.supabase.supabase.from("shopping_list_item").delete().eq("id",t)).pipe(P(e=>w({error:e})),D(()=>this.loadingCount.update(e=>e-1)),ee(e=>{if(e?.error)throw e.error;this.items.reload()}),R(e=>{if(e?.error)throw e.error;return w(void 0)}))}toggleItem(t,e){return this.updateItem(t,{active:e,active_changed:new Date().toISOString()})}static \u0275fac=function(e){return new(e||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function St(n,_){if(n&1){let t=F();a(0,"input",7),m("ngModelChange",function(i){g(t);let o=u();return h(o.editingName.set(i))})("blur",function(){g(t);let i=u();return h(i.saveInline())})("keydown.enter",function(i){g(t);let o=u();return i.preventDefault(),h(o.saveInline())})("keydown.escape",function(){g(t);let i=u();return h(i.cancelEdit())}),d()}if(n&2){let t=u();C("id",We("edit-",t.item().id))("ngModel",t.editingName())}}function kt(n,_){if(n&1){let t=F();a(0,"div",5)(1,"h3",8),m("click",function(){g(t);let i=u();return h(i.startEdit())}),y(2),d()()}if(n&2){let t=u();r(2),S(" ",t.item().product_name," ")}}var Ct=(()=>{class n{service=v(Ce);item=c.required();itemUpdated=G();itemDeleted=G();busyCount=p(0);busy=l(()=>this.busyCount()>0);editingName=p(null);isEditing=l(()=>this.editingName()!==null);toggleItem(){let t=this.item();this.busyCount.update(e=>e+1),this.service.toggleItem(t.id,!t.active).pipe(D(()=>this.busyCount.update(e=>e-1))).subscribe({next:()=>this.itemUpdated.emit(),error:e=>console.error("Toggle error:",e)})}onBasketToggle(t){let e=this.item(),i=t==="on";e.active!==i&&(this.busyCount.update(o=>o+1),this.service.toggleItem(e.id,i).pipe(D(()=>this.busyCount.update(o=>o-1))).subscribe({next:()=>this.itemUpdated.emit(),error:o=>console.error("Toggle error:",o)}))}deleteItem(){if(!confirm("Are you sure you want to delete this item?"))return;let t=this.item();this.busyCount.update(e=>e+1),this.service.deleteItem(t.id).pipe(D(()=>this.busyCount.update(e=>e-1))).subscribe({next:()=>this.itemDeleted.emit(),error:e=>console.error("Delete error:",e)})}startEdit(){this.editingName.set(this.item().product_name??""),setTimeout(()=>{let t=document.getElementById("edit-"+this.item().id);t?.focus(),t?.select()},0)}saveInline(){let t=(this.editingName()||"").trim(),e=this.item();if(t===(e.product_name??"").trim()){this.cancelEdit();return}this.busyCount.update(i=>i+1),this.service.updateItem(e.id,{product_name:t}).pipe(D(()=>{this.busyCount.update(i=>i-1),this.cancelEdit()})).subscribe({next:()=>this.itemUpdated.emit(),error:i=>console.error("Update error:",i)})}cancelEdit(){this.editingName.set(null)}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=B({type:n,selectors:[["lib-shopping-list-item-card"]],inputs:{item:[1,"item"]},outputs:{itemUpdated:"itemUpdated",itemDeleted:"itemDeleted"},features:[A([O({lucideTrash:fe})])],decls:7,vars:4,consts:[["hlmCard","",1,"group","p-2","sm:p-3","relative"],["hlmCardContent",""],[1,"flex","items-center","gap-3","w-full"],[1,"flex-1","min-w-0"],["hlmInput","",1,"w-full",3,"id","ngModel"],[1,"h-8","flex","items-center"],["size","sm","variant","outline",1,"ml-auto",3,"stateChange","state"],["hlmInput","",1,"w-full",3,"ngModelChange","blur","keydown.enter","keydown.escape","id","ngModel"],["hlmCardTitle","",1,"truncate","cursor-pointer","hover:text-primary",3,"click"]],template:function(e,i){e&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),E(4,St,1,3,"input",4)(5,kt,3,1,"div",5),d(),a(6,"gh-shopping-basket-toggle",6),m("stateChange",function(s){return i.onBasketToggle(s)}),d()()()()),e&2&&(qe("opacity-60",!i.item().active),r(4),V(i.isEditing()?4:5),r(2),C("state",i.item().active?"on":"off"))},dependencies:[K,Y,pe,ue,ge,ct,pt,mt,be,_t],encapsulation:2,changeDetection:0})}return n})();var ye=(()=>{class n{orientation=c("horizontal");$orientation=this.orientation;direction=c("ltr");$direction=this.direction;activeTab=U(void 0,{alias:"brnTabs"});$activeTab=this.activeTab.asReadonly();activationMode=c("automatic");$activationMode=this.activationMode;tabActivated=G();_tabs=p({});$tabs=this._tabs.asReadonly();registerTrigger(t,e){this.updateEntry(t,{trigger:e})}registerContent(t,e){this.updateEntry(t,{content:e})}unregisterTrigger(t){this.updateEntry(t,{trigger:void 0}),this.activeTab()===t&&this.activeTab.set(void 0)}unregisterContent(t){this.updateEntry(t,{content:void 0})}updateEntry(t,e){this._tabs.update(i=>{let o=i[t]??{},s=J(J({},o),e);if(!s.trigger&&!s.content){let Ee=i,{[t]:Yt}=Ee;return Ae(Ee,[Fe(t)])}return Ve(J({},i),{[t]:s})})}emitTabActivated(t){this.tabActivated.emit(t)}setActiveTab(t){this.activeTab.set(t)}static \u0275fac=function(e){return new(e||n)};static \u0275dir=L({type:n,selectors:[["","brnTabs",""]],hostVars:2,hostBindings:function(e,i){e&2&&M("data-orientation",i.orientation())("dir",i.direction())},inputs:{orientation:[1,"orientation"],direction:[1,"direction"],activeTab:[1,"brnTabs","activeTab"],activationMode:[1,"activationMode"]},outputs:{activeTab:"brnTabsChange",tabActivated:"tabActivated"},exportAs:["brnTabs"]})}return n})();var Te=(()=>{class n{elementRef=v(Le);_root=v(ye);_orientation=this._root.$orientation;triggerFor=c.required({alias:"brnTabsTrigger"});selected=l(()=>this._root.$activeTab()===this.triggerFor());_contentId=l(()=>`brn-tabs-content-${this.triggerFor()}`);_labelId=l(()=>`brn-tabs-label-${this.triggerFor()}`);_disabled=c(!1,{alias:"disabled",transform:ae});get disabled(){return this._disabled()}constructor(){z(()=>{let t=this.triggerFor();$e(()=>this._root.registerTrigger(t,this))})}focus(){this.elementRef.nativeElement.focus(),this._root.$activationMode()==="automatic"&&this.activate()}activate(){this.triggerFor()&&(this._root.setActiveTab(this.triggerFor()),this._root.emitTabActivated(this.triggerFor()))}get key(){return this.triggerFor()}ngOnDestroy(){this._root.unregisterTrigger(this.triggerFor())}static \u0275fac=function(e){return new(e||n)};static \u0275dir=L({type:n,selectors:[["button","brnTabsTrigger",""]],hostAttrs:["type","button","role","tab"],hostVars:9,hostBindings:function(e,i){e&1&&m("click",function(){return i.activate()}),e&2&&(oe("id",i._labelId())("tabIndex",i._disabled()?-1:i.selected()?0:-1),M("aria-selected",i.selected())("aria-controls",i._contentId())("aria-disabled",i._disabled())("data-state",i.selected()?"active":"inactive")("data-orientation",i._orientation())("data-disabled",i._disabled()?"":void 0)("disabled",i._disabled()?"":void 0))},inputs:{triggerFor:[1,"brnTabsTrigger","triggerFor"],_disabled:[1,"disabled","_disabled"]},exportAs:["brnTabsTrigger"]})}return n})(),Tt=(()=>{class n{_root=v(ye);_orientation=this._root.$orientation;_direction=this._root.$direction;_activeTab=this._root.$activeTab;_tabs=this._root.$tabs;_elementRef=v(Le);_keyDownListener=ze(this._elementRef.nativeElement,"keydown");_keyManager;triggers=je(Te,{descendants:!0});ngAfterContentInit(){this._keyManager=new lt(this.triggers()).withHorizontalOrientation(this._direction()).withHomeAndEnd().withPageUpDown().withWrap(),this._keyDownListener.pipe(Oe(1)).subscribe(()=>{let t=this._activeTab(),e=this._tabs(),i=0;if(t){let o=e[t];o&&(i=this.triggers().indexOf(o.trigger))}this._keyManager?.setActiveItem(i)}),this._keyDownListener.subscribe(t=>{"key"in t&&(this._orientation()==="horizontal"&&(t.key==="ArrowUp"||t.key==="ArrowDown")||this._orientation()==="vertical"&&(t.key==="ArrowLeft"||t.key==="ArrowRight"))||this._keyManager?.onKeydown(t)})}static \u0275fac=function(e){return new(e||n)};static \u0275dir=L({type:n,selectors:[["","brnTabsList",""]],contentQueries:function(e,i,o){e&1&&Re(o,i.triggers,Te,5),e&2&&se()},hostAttrs:["role","tablist"],hostVars:2,hostBindings:function(e,i){e&2&&M("aria-orientation",i._orientation())("data-orientation",i._orientation())},exportAs:["brnTabsList"]})}return n})();var hn=Je({passive:!0});var Pe=(()=>{class n{tab=c.required();userClass=c("",{alias:"class"});_computedClass=l(()=>k("flex flex-col gap-2",this.userClass()));static \u0275fac=function(e){return new(e||n)};static \u0275dir=L({type:n,selectors:[["","hlmTabs",""],["hlm-tabs"]],hostAttrs:["data-slot","tabs"],hostVars:2,hostBindings:function(e,i){e&2&&I(i._computedClass())},inputs:{tab:[1,"tab"],userClass:[1,"class","userClass"]},features:[H([{directive:ye,inputs:["orientation","orientation","direction","direction","activationMode","activationMode","brnTabs","tab"],outputs:["tabActivated","tabActivated"]}])]})}return n})();var yt=ce("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",{variants:{orientation:{horizontal:"h-10 space-x-1",vertical:"mt-2 h-fit flex-col space-y-1"}},defaultVariants:{orientation:"horizontal"}}),Be=(()=>{class n{orientation=c("horizontal");userClass=c("",{alias:"class"});_computedClass=l(()=>k(yt({orientation:this.orientation()}),this.userClass()));static \u0275fac=function(e){return new(e||n)};static \u0275dir=L({type:n,selectors:[["","hlmTabsList",""],["hlm-tabs-list"]],hostAttrs:["data-slot","tabs-list"],hostVars:2,hostBindings:function(e,i){e&2&&I(i._computedClass())},inputs:{orientation:[1,"orientation"],userClass:[1,"class","userClass"]},features:[H([Tt])]})}return n})();var He=(()=>{class n{triggerFor=c.required({alias:"hlmTabsTrigger"});userClass=c("",{alias:"class"});_computedClass=l(()=>k("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_ng-icon]:pointer-events-none [&_ng-icon]:shrink-0 [&_ng-icon:not([class*='text-'])]:text-base",this.userClass()));static \u0275fac=function(e){return new(e||n)};static \u0275dir=L({type:n,selectors:[["","hlmTabsTrigger",""]],hostAttrs:["data-slot","tabs-trigger"],hostVars:2,hostBindings:function(e,i){e&2&&I(i._computedClass())},inputs:{triggerFor:[1,"hlmTabsTrigger","triggerFor"],userClass:[1,"class","userClass"]},features:[H([{directive:Te,inputs:["brnTabsTrigger","hlmTabsTrigger","disabled","disabled"]}])]})}return n})();var we=(()=>{class n{supabase=v(ve);userId=p(null);loadingCount=p(0);loading=l(()=>this.loadingCount()>0);lists=re({params:()=>({userId:this.userId()}),loader:async({params:t})=>{if(!t.userId)return[];let{data:e,error:i}=await this.supabase.supabase.from("shopping_list").select("*").eq("creator_id",t.userId).order("created_at",{ascending:!0});if(i)throw i;return e??[]}});selectedListId=p(null);selectedList=l(()=>{let t=this.selectedListId();return(this.lists.value()??[]).find(i=>i.id===t)??null});constructor(){this.supabase.supabase.auth.getSession().then(({data:t})=>{let e=t?.session?.user??null;e&&this.userId.set(e.id)}).catch(()=>{}),this.supabase.supabase.auth.onAuthStateChange((t,e)=>{let i=e?.user?.id??null;this.userId.set(i),i||this.selectedListId.set(null)}),z(()=>{let t=this.lists.value();!this.selectedListId()&&t&&t.length>0&&this.selectedListId.set(t[0].id)})}createList(t){this.loadingCount.update(e=>e+1),N(this.supabase.supabase.auth.getUser()).pipe(R(e=>{let i=e?.data?.user?.id;return i?N(this.supabase.supabase.from("shopping_list").insert({name:t,creator_id:i}).select().single()):w({error:new Error("Not authenticated")})}),P(e=>w({error:e})),D(()=>this.loadingCount.update(e=>e-1))).subscribe(e=>{if(e?.error)throw e.error;this.lists.reload(),e?.data&&this.selectedListId.set(e.data.id)})}updateList(t,e){this.loadingCount.update(i=>i+1),N(this.supabase.supabase.from("shopping_list").update({name:e}).eq("id",t).select().single()).pipe(P(i=>w({error:i})),D(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.lists.reload()})}deleteList(t){this.loadingCount.update(e=>e+1),N(this.supabase.supabase.from("shopping_list").delete().eq("id",t)).pipe(P(e=>w({error:e})),D(()=>this.loadingCount.update(e=>e-1))).subscribe(e=>{if(e?.error)throw e.error;this.selectedListId()===t&&this.selectedListId.set(null),this.lists.reload()})}static \u0275fac=function(e){return new(e||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Et=["editDialog"],Vt=(n,_)=>_.id;function Ft(n,_){n&1&&T(0,"hlm-spinner",3)}function At(n,_){if(n&1){let t=F();a(0,"div",6)(1,"button",12),m("click",function(){let i=g(t).$implicit,o=u();return h(o.onTabChange(i.id))}),y(2),a(3,"button",13),f(4,"transloco"),m("click",function(i){let o=g(t).$implicit,s=u();return h(s.openEditDialog(i,o))}),T(5,"ng-icon",14),d(),a(6,"button",13),f(7,"transloco"),m("click",function(i){let o=g(t).$implicit,s=u();return h(s.deleteList(i,o.id))}),T(8,"ng-icon",15),d()()()}if(n&2){let t=_.$implicit;r(),C("hlmTabsTrigger",t.id),r(),S(" ",t.name," "),r(),M("aria-label",b(4,4,"common.edit")),r(3),M("aria-label",b(7,6,"common.delete"))}}function zt(n,_){n&1&&(T(0,"hlm-spinner",3),y(1),f(2,"transloco")),n&2&&(r(),S(" ",b(2,1,"common.creating")," "))}function Ot(n,_){n&1&&(y(0),f(1,"transloco")),n&2&&S(" ",b(1,1,"common.create")," ")}function Rt(n,_){if(n&1){let t=F();a(0,"hlm-dialog-content",16)(1,"hlm-dialog-header")(2,"h3",17),y(3),f(4,"transloco"),d(),a(5,"p",18),y(6),f(7,"transloco"),d()(),a(8,"div",19)(9,"div",20)(10,"label",21),y(11),f(12,"transloco"),d(),a(13,"input",22),f(14,"transloco"),j("ngModelChange",function(i){g(t);let o=u();return $(o.newListName,i)||(o.newListName=i),h(i)}),m("keydown.enter",function(){g(t);let i=u();return h(i.createList())}),d()()(),a(15,"hlm-dialog-footer")(16,"button",23),m("click",function(){g(t);let i=u();return h(i.closeDialog())}),y(17),f(18,"transloco"),d(),a(19,"button",24),m("click",function(){g(t);let i=u();return h(i.createList())}),E(20,zt,3,3)(21,Ot,2,3),d()()()}if(n&2){let t=u();r(3),q(b(4,8,"shoppingList.createList")),r(3),q(b(7,10,"shoppingList.createListDescription")),r(5),q(b(12,12,"shoppingList.listName")),r(2),W("ngModel",t.newListName),C("placeholder",b(14,14,"shoppingList.listNamePlaceholder")),r(4),S(" ",b(18,16,"common.cancel")," "),r(2),C("disabled",!t.newListName().trim()||t.creatingList()),r(),V(t.creatingList()?20:21)}}function qt(n,_){n&1&&(T(0,"hlm-spinner",3),y(1),f(2,"transloco")),n&2&&(r(),S(" ",b(2,1,"common.updating")," "))}function Wt(n,_){n&1&&(y(0),f(1,"transloco")),n&2&&S(" ",b(1,1,"common.save")," ")}function $t(n,_){if(n&1){let t=F();a(0,"hlm-dialog-content",16)(1,"hlm-dialog-header")(2,"h3",17),y(3),f(4,"transloco"),d(),a(5,"p",18),y(6),f(7,"transloco"),d()(),a(8,"div",19)(9,"div",20)(10,"label",25),y(11),f(12,"transloco"),d(),a(13,"input",26),f(14,"transloco"),j("ngModelChange",function(i){g(t);let o=u();return $(o.editListName,i)||(o.editListName=i),h(i)}),m("keydown.enter",function(){g(t);let i=u();return h(i.updateList())}),d()()(),a(15,"hlm-dialog-footer")(16,"button",23),m("click",function(){g(t);let i=u();return h(i.closeEditDialog())}),y(17),f(18,"transloco"),d(),a(19,"button",24),m("click",function(){g(t);let i=u();return h(i.updateList())}),E(20,qt,3,3)(21,Wt,2,3),d()()()}if(n&2){let t=u();r(3),q(b(4,8,"shoppingList.editList")),r(3),q(b(7,10,"shoppingList.editListDescription")),r(5),q(b(12,12,"shoppingList.listName")),r(2),W("ngModel",t.editListName),C("placeholder",b(14,14,"shoppingList.listNamePlaceholder")),r(4),S(" ",b(18,16,"common.cancel")," "),r(2),C("disabled",!t.editListName().trim()||t.updatingList()),r(),V(t.updatingList()?20:21)}}var wt=(()=>{class n{listManager=v(we);lists=l(()=>this.listManager.lists.value()??[]);selectedListId=this.listManager.selectedListId;loading=l(()=>this.listManager.lists.isLoading()||this.listManager.loading());createDialog=xe.required(X);editDialog=xe.required("editDialog");newListName=p("");creatingList=p(!1);editingList=p(null);editListName=p("");updatingList=p(!1);onTabChange(t){this.listManager.selectedListId.set(t)}openCreateDialog(){this.newListName.set(""),this.createDialog().open()}closeDialog(){this.createDialog().close(),this.newListName.set("")}createList(){let t=this.newListName().trim();if(t){this.creatingList.set(!0);try{this.listManager.createList(t),this.closeDialog()}finally{this.creatingList.set(!1)}}}openEditDialog(t,e){t.stopPropagation(),this.editingList.set(e),this.editListName.set(e.name),this.editDialog().open()}closeEditDialog(){this.editDialog().close(),this.editingList.set(null),this.editListName.set("")}updateList(){let t=this.editingList(),e=this.editListName().trim();if(!(!t||!e)){this.updatingList.set(!0);try{this.listManager.updateList(t.id,e),this.closeEditDialog()}finally{this.updatingList.set(!1)}}}deleteList(t,e){t.stopPropagation(),confirm("Are you sure you want to delete this list?")&&this.listManager.deleteList(e)}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=B({type:n,selectors:[["lib-shopping-list-tabs"]],viewQuery:function(e,i){e&1&&(Ie(i.createDialog,X,5),Ie(i.editDialog,Et,5)),e&2&&se(2)},features:[A([O({lucidePlus:he,lucideX:Xe,lucidePencil:Ye,lucideTrash:fe})])],decls:17,vars:5,consts:[["createDialog",""],["editDialog",""],[1,"flex","items-center","gap-2","min-w-0"],["size","small"],[1,"flex-1","min-w-0","overflow-hidden",3,"tab"],[1,"w-full","border-b","overflow-x-auto","overflow-y-hidden","scrollbar-hide"],[1,"flex","items-center","gap-1","flex-shrink-0","group"],["hlmBtn","","size","icon","variant","ghost",1,"flex-shrink-0",3,"click"],["hlm","","name","lucidePlus","size","sm"],["closeDelay","100",3,"closed"],["hlm",""],["class","sm:max-w-[425px]",4,"brnDialogContent"],[1,"whitespace-nowrap",3,"click","hlmTabsTrigger"],["hlmBtn","","size","icon-xs","variant","ghost",3,"click"],["hlm","","size","xs","name","lucidePencil"],["hlm","","size","xs","name","lucideTrash"],[1,"sm:max-w-[425px]"],["hlmDialogTitle",""],["hlmDialogDescription",""],[1,"grid","gap-4","py-4"],[1,"grid","gap-2"],["hlmLabel","","for","listName"],["hlmInput","","id","listName",3,"ngModelChange","keydown.enter","ngModel","placeholder"],["hlmBtn","","variant","outline",3,"click"],["hlmBtn","",3,"click","disabled"],["hlmLabel","","for","editListName"],["hlmInput","","id","editListName",3,"ngModelChange","keydown.enter","ngModel","placeholder"]],template:function(e,i){if(e&1){let o=F();a(0,"div",2),E(1,Ft,1,0,"hlm-spinner",3),a(2,"hlm-tabs",4)(3,"hlm-tabs-list",5),ie(4,At,9,8,"div",6,Vt),d()(),a(6,"button",7),f(7,"transloco"),m("click",function(){return g(o),h(i.openCreateDialog())}),T(8,"ng-icon",8),d()(),a(9,"brn-dialog",9,0),m("closed",function(){return g(o),h(i.closeDialog())}),T(11,"brn-dialog-overlay",10),De(12,Rt,22,18,"hlm-dialog-content",11),d(),a(13,"brn-dialog",9,1),m("closed",function(){return g(o),h(i.closeEditDialog())}),T(15,"brn-dialog-overlay",10),De(16,$t,22,18,"hlm-dialog-content",11),d()}e&2&&(r(),V(i.loading()?1:-1),r(),C("tab",i.selectedListId()??""),r(2),ne(i.lists()),r(2),M("aria-label",b(7,3,"shoppingList.createList")))},dependencies:[K,Y,pe,ue,ge,Pe,Be,He,me,Q,Z,X,tt,et,it,nt,ot,st,rt,be,at,_e,de,le],encapsulation:2,changeDetection:0})}return n})();var jt=(n,_)=>_.id;function Qt(n,_){n&1&&(a(0,"div",4),T(1,"hlm-spinner",11),d())}function Ut(n,_){if(n&1&&T(0,"lib-shopping-list-item-card",10),n&2){let t=_.$implicit;C("item",t)}}var Lt=(()=>{class n{service=v(Ce);listManager=v(we);newItemName=p("");items=l(()=>this.service.items.value()??[]);loading=l(()=>this.service.items.isLoading()||this.service.loading());sortedItems=l(()=>(this.items()??[]).slice().sort((e,i)=>{if(e.active===i.active){let o=e.active_changed?new Date(e.active_changed).getTime():0;return(i.active_changed?new Date(i.active_changed).getTime():0)-o}return e.active?-1:1}));filteredOptions=l(()=>(this.items()??[]).filter(e=>!e.active&&e.product_name.toLowerCase().includes(this.newItemName().toLowerCase())));constructor(){z(()=>{let t=this.listManager.selectedListId();this.service.setCurrentList(t)})}handleSearch(t){let e=this.items().find(i=>i.product_name===t);!e||e.active||(this.service.toggleItem(e.id,!0).subscribe(),this.clearAutocomplete())}clearAutocomplete(){this.newItemName.set("")}focusAddInput(){try{document.getElementById("add-input")?.focus()}catch{}}addItem(){let t=this.newItemName();t&&this.service.addItem(t,void 0).subscribe({next:()=>{this.clearAutocomplete()},error:e=>{console.error("Add item error:",e)}})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=B({type:n,selectors:[["lib-sl-dashboard"]],features:[A([O({lucideShoppingCart:Ge,lucidePlus:he}),ut({transformOptionToString:t=>t.product_name,transformOptionToValue:t=>t.product_name})])],decls:14,vars:7,consts:[[1,"h-dvh","flex","flex-col","gap-4"],[1,"px-4"],[1,"flex-1","flex","flex-col","gap-4","overflow-hidden","py-4"],[1,"flex","sm:flex-row","gap-2","items-stretch","sm:items-center","relative","px-4",3,"ngSubmit"],[1,"absolute","inset-0","bg-background/50","flex","justify-center","items-center","z-10","rounded-lg"],[3,"searchChange","valueChange","keydown.enter","searchPlaceholderText","filteredOptions","search","autocompleteEmptyClass"],["hlmBtn","","size","icon","variant","default","type","submit"],["hlm","","name","lucidePlus","size","sm"],[1,"flex-1","overflow-auto"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-3","xl:grid-cols-4","gap-4","px-4"],[3,"item"],["size","large"]],template:function(e,i){e&1&&(a(0,"div",0)(1,"div",1),T(2,"lib-shopping-list-tabs"),d(),a(3,"main",2)(4,"form",3),m("ngSubmit",function(){return i.addItem()}),E(5,Qt,2,0,"div",4),a(6,"hlm-autocomplete",5),f(7,"transloco"),j("searchChange",function(s){return $(i.newItemName,s)||(i.newItemName=s),s}),m("valueChange",function(s){return i.handleSearch(s)})("keydown.enter",function(){return i.addItem()}),d(),a(8,"button",6),T(9,"ng-icon",7),d()(),a(10,"section",8)(11,"div",9),ie(12,Ut,1,1,"lib-shopping-list-item-card",10,jt),d()()()()),e&2&&(r(5),V(i.loading()?5:-1),r(),C("searchPlaceholderText",b(7,5,"shoppingList.searchPlaceholder"))("filteredOptions",i.filteredOptions()),W("search",i.newItemName),C("autocompleteEmptyClass","hidden"),r(6),ne(i.sortedItems()))},dependencies:[K,Y,Ke,Qe,Ue,me,Q,Z,_e,gt,Ct,wt,de,le],encapsulation:2,changeDetection:0})}return n})();var os=[{path:Se(Me.app.shoppingList._.root._),component:Lt},{path:"**",redirectTo:Se(Me.app.shoppingList._.root._)}];export{_t as ShoppingBasketToggleComponent,Ce as ShoppingListService,os as shoppingListRoutes};
