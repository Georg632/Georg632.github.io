import{a as m,b as I,d as et,e as X,g as Y}from"./chunk-X37JSKTG.js";var Or=X((Og,wo)=>{"use strict";function qd(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}wo.exports=qd});var xo=X((Ig,_o)=>{"use strict";var Hd=typeof global=="object"&&global&&global.Object===Object&&global;_o.exports=Hd});var $i=X((Rg,So)=>{"use strict";var $d=xo(),Vd=typeof self=="object"&&self&&self.Object===Object&&self,Wd=$d||Vd||Function("return this")();So.exports=Wd});var Po=X((Ng,Fo)=>{"use strict";var Gd=$i(),Kd=function(){return Gd.Date.now()};Fo.exports=Kd});var To=X((Bg,Eo)=>{"use strict";var Xd=/\s/;function Yd(r){for(var e=r.length;e--&&Xd.test(r.charAt(e)););return e}Eo.exports=Yd});var Co=X((Dg,ko)=>{"use strict";var Qd=To(),Jd=/^\s+/;function Zd(r){return r&&r.slice(0,Qd(r)+1).replace(Jd,"")}ko.exports=Zd});var Vi=X((Lg,Uo)=>{"use strict";var ec=$i(),tc=ec.Symbol;Uo.exports=tc});var Ro=X((jg,Io)=>{"use strict";var Ao=Vi(),Oo=Object.prototype,rc=Oo.hasOwnProperty,ic=Oo.toString,zt=Ao?Ao.toStringTag:void 0;function nc(r){var e=rc.call(r,zt),t=r[zt];try{r[zt]=void 0;var i=!0}catch{}var n=ic.call(r);return i&&(e?r[zt]=t:delete r[zt]),n}Io.exports=nc});var Bo=X((Mg,No)=>{"use strict";var sc=Object.prototype,oc=sc.toString;function ac(r){return oc.call(r)}No.exports=ac});var Mo=X((zg,jo)=>{"use strict";var Do=Vi(),lc=Ro(),uc=Bo(),dc="[object Null]",cc="[object Undefined]",Lo=Do?Do.toStringTag:void 0;function pc(r){return r==null?r===void 0?cc:dc:Lo&&Lo in Object(r)?lc(r):uc(r)}jo.exports=pc});var qo=X((qg,zo)=>{"use strict";function hc(r){return r!=null&&typeof r=="object"}zo.exports=hc});var $o=X((Hg,Ho)=>{"use strict";var fc=Mo(),mc=qo(),gc="[object Symbol]";function yc(r){return typeof r=="symbol"||mc(r)&&fc(r)==gc}Ho.exports=yc});var Ko=X(($g,Go)=>{"use strict";var bc=Co(),Vo=Or(),vc=$o(),Wo=NaN,wc=/^[-+]0x[0-9a-f]+$/i,_c=/^0b[01]+$/i,xc=/^0o[0-7]+$/i,Sc=parseInt;function Fc(r){if(typeof r=="number")return r;if(vc(r))return Wo;if(Vo(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=Vo(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=bc(r);var t=_c.test(r);return t||xc.test(r)?Sc(r.slice(2),t?2:8):wc.test(r)?Wo:+r}Go.exports=Fc});var Gi=X((Vg,Yo)=>{"use strict";var Pc=Or(),Wi=Po(),Xo=Ko(),Ec="Expected a function",Tc=Math.max,kc=Math.min;function Cc(r,e,t){var i,n,s,o,a,u,c=0,p=!1,d=!1,v=!0;if(typeof r!="function")throw new TypeError(Ec);e=Xo(e)||0,Pc(t)&&(p=!!t.leading,d="maxWait"in t,s=d?Tc(Xo(t.maxWait)||0,e):s,v="trailing"in t?!!t.trailing:v);function b(N){var D=i,V=n;return i=n=void 0,c=N,o=r.apply(V,D),o}function x(N){return c=N,a=setTimeout(U,e),p?b(N):o}function A(N){var D=N-u,V=N-c,G=e-D;return d?kc(G,s-V):G}function C(N){var D=N-u,V=N-c;return u===void 0||D>=e||D<0||d&&V>=s}function U(){var N=Wi();if(C(N))return P(N);a=setTimeout(U,A(N))}function P(N){return a=void 0,v&&i?b(N):(i=n=void 0,o)}function k(){a!==void 0&&clearTimeout(a),c=0,i=u=n=a=void 0}function B(){return a===void 0?o:P(Wi())}function j(){var N=Wi(),D=C(N);if(i=arguments,n=this,u=N,D){if(a===void 0)return x(u);if(d)return clearTimeout(a),a=setTimeout(U,e),b(u)}return a===void 0&&(a=setTimeout(U,e)),o}return j.cancel=k,j.flush=B,j}Yo.exports=Cc});var Jo=X((Wg,Qo)=>{"use strict";var Uc=Gi(),Ac=Or(),Oc="Expected a function";function Ic(r,e,t){var i=!0,n=!0;if(typeof r!="function")throw new TypeError(Oc);return Ac(t)&&(i="leading"in t?!!t.leading:i,n="trailing"in t?!!t.trailing:n),Uc(r,e,{leading:i,maxWait:e,trailing:n})}Qo.exports=Ic});var ea=X((Gg,Zo)=>{"use strict";Zo.exports=function(){var e={},t=e._fns={};e.emit=function(o,a,u,c,p,d,v){var b=i(o);b.length&&n(o,b,[a,u,c,p,d,v])},e.on=function(o,a){t[o]||(t[o]=[]),t[o].push(a)},e.once=function(o,a){function u(){a.apply(this,arguments),e.off(o,u)}this.on(o,u)},e.off=function(o,a){var u=[];if(o&&a){var c=this._fns[o],p=0,d=c?c.length:0;for(p;p<d;p++)c[p]!==a&&u.push(c[p])}u.length?this._fns[o]=u:delete this._fns[o]};function i(s){var o=t[s]?t[s]:[],a=s.indexOf(":"),u=a===-1?[s]:[s.substring(0,a),s.substring(a+1)],c=Object.keys(t),p=0,d=c.length;for(p;p<d;p++){var v=c[p];if(v==="*"&&(o=o.concat(t[v])),u.length===2&&u[0]===v){o=o.concat(t[v]);break}}return o}function n(s,o,a){var u=0,c=o.length;for(u;u<c&&o[u];u++)o[u].event=s,o[u].apply(o[u],a)}return e}});var qt=X((ey,sa)=>{"use strict";sa.exports=function(e){if(typeof e!="number"||Number.isNaN(e))throw new TypeError(`Expected a number, got ${typeof e}`);let t=e<0,i=Math.abs(e);if(t&&(i=-i),i===0)return"0 B";let n=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],s=Math.min(Math.floor(Math.log(i)/Math.log(1024)),n.length-1),o=Number(i/1024**s),a=n[s];return`${o>=10||o%1===0?Math.round(o):o.toFixed(1)} ${a}`}});var la=X((ty,aa)=>{"use strict";function oa(r,e){this.text=r=r||"",this.hasWild=~r.indexOf("*"),this.separator=e,this.parts=r.split(e)}oa.prototype.match=function(r){var e=!0,t=this.parts,i,n=t.length,s;if(typeof r=="string"||r instanceof String)if(!this.hasWild&&this.text!=r)e=!1;else{for(s=(r||"").split(this.separator),i=0;e&&i<n;i++)t[i]!=="*"&&(i<s.length?e=t[i]===s[i]:e=!1);e=e&&s}else if(typeof r.splice=="function")for(e=[],i=r.length;i--;)this.match(r[i])&&(e[e.length]=r[i]);else if(typeof r=="object"){e={};for(var o in r)this.match(o)&&(e[o]=r[o])}return e};aa.exports=function(r,e,t){var i=new oa(r,t||/[\/\.]/);return typeof e<"u"?i.match(e):i}});var da=X((ry,ua)=>{"use strict";var Bc=la(),Dc=/[\/\+\.]/;ua.exports=function(r,e){function t(i){var n=Bc(i,r,Dc);return n&&n.length>=2}return e?t(e.split(";")[0]):t}});var ga=X((Ji,Zi)=>{"use strict";(function(r,e){typeof Ji=="object"&&typeof Zi<"u"?Zi.exports=e():typeof define=="function"&&define.amd?define(e):(r=typeof globalThis<"u"?globalThis:r||self,r.Compressor=e())})(Ji,function(){"use strict";function r(_,y){var w=Object.keys(_);if(Object.getOwnPropertySymbols){var S=Object.getOwnPropertySymbols(_);y&&(S=S.filter(function(O){return Object.getOwnPropertyDescriptor(_,O).enumerable})),w.push.apply(w,S)}return w}function e(_){for(var y=1;y<arguments.length;y++){var w=arguments[y]!=null?arguments[y]:{};y%2?r(Object(w),!0).forEach(function(S){s(_,S,w[S])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(w)):r(Object(w)).forEach(function(S){Object.defineProperty(_,S,Object.getOwnPropertyDescriptor(w,S))})}return _}function t(_,y){if(!(_ instanceof y))throw new TypeError("Cannot call a class as a function")}function i(_,y){for(var w=0;w<y.length;w++){var S=y[w];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(_,u(S.key),S)}}function n(_,y,w){return y&&i(_.prototype,y),w&&i(_,w),Object.defineProperty(_,"prototype",{writable:!1}),_}function s(_,y,w){return y=u(y),y in _?Object.defineProperty(_,y,{value:w,enumerable:!0,configurable:!0,writable:!0}):_[y]=w,_}function o(){return o=Object.assign?Object.assign.bind():function(_){for(var y=1;y<arguments.length;y++){var w=arguments[y];for(var S in w)Object.prototype.hasOwnProperty.call(w,S)&&(_[S]=w[S])}return _},o.apply(this,arguments)}function a(_,y){if(typeof _!="object"||_===null)return _;var w=_[Symbol.toPrimitive];if(w!==void 0){var S=w.call(_,y||"default");if(typeof S!="object")return S;throw new TypeError("@@toPrimitive must return a primitive value.")}return(y==="string"?String:Number)(_)}function u(_){var y=a(_,"string");return typeof y=="symbol"?y:String(y)}var c={exports:{}};(function(_){typeof window>"u"||(function(y){var w=y.HTMLCanvasElement&&y.HTMLCanvasElement.prototype,S=y.Blob&&(function(){try{return!!new Blob}catch{return!1}})(),O=S&&y.Uint8Array&&(function(){try{return new Blob([new Uint8Array(100)]).size===100}catch{return!1}})(),R=y.BlobBuilder||y.WebKitBlobBuilder||y.MozBlobBuilder||y.MSBlobBuilder,W=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,q=(S||R)&&y.atob&&y.ArrayBuffer&&y.Uint8Array&&function(M){var z,Q,J,be,re,L,ve,ae,Qe;if(z=M.match(W),!z)throw new Error("invalid data URI");for(Q=z[2]?z[1]:"text/plain"+(z[3]||";charset=US-ASCII"),J=!!z[4],be=M.slice(z[0].length),J?re=atob(be):re=decodeURIComponent(be),L=new ArrayBuffer(re.length),ve=new Uint8Array(L),ae=0;ae<re.length;ae+=1)ve[ae]=re.charCodeAt(ae);return S?new Blob([O?ve:L],{type:Q}):(Qe=new R,Qe.append(L),Qe.getBlob(Q))};y.HTMLCanvasElement&&!w.toBlob&&(w.mozGetAsFile?w.toBlob=function(M,z,Q){var J=this;setTimeout(function(){Q&&w.toDataURL&&q?M(q(J.toDataURL(z,Q))):M(J.mozGetAsFile("blob",z))})}:w.toDataURL&&q&&(w.msToBlob?w.toBlob=function(M,z,Q){var J=this;setTimeout(function(){(z&&z!=="image/png"||Q)&&w.toDataURL&&q?M(q(J.toDataURL(z,Q))):M(J.msToBlob(z))})}:w.toBlob=function(M,z,Q){var J=this;setTimeout(function(){M(q(J.toDataURL(z,Q)))})})),_.exports?_.exports=q:y.dataURLtoBlob=q})(window)})(c);var p=c.exports,d=function(y){return typeof Blob>"u"?!1:y instanceof Blob||Object.prototype.toString.call(y)==="[object Blob]"},v={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},b=typeof window<"u"&&typeof window.document<"u",x=b?window:{},A=function(y){return y>0&&y<1/0},C=Array.prototype.slice;function U(_){return Array.from?Array.from(_):C.call(_)}var P=/^image\/.+$/;function k(_){return P.test(_)}function B(_){var y=k(_)?_.substr(6):"";return y==="jpeg"&&(y="jpg"),".".concat(y)}var j=String.fromCharCode;function N(_,y,w){var S="",O;for(w+=y,O=y;O<w;O+=1)S+=j(_.getUint8(O));return S}var D=x.btoa;function V(_,y){for(var w=[],S=8192,O=new Uint8Array(_);O.length>0;)w.push(j.apply(null,U(O.subarray(0,S)))),O=O.subarray(S);return"data:".concat(y,";base64,").concat(D(w.join("")))}function G(_){var y=new DataView(_),w;try{var S,O,R;if(y.getUint8(0)===255&&y.getUint8(1)===216)for(var W=y.byteLength,q=2;q+1<W;){if(y.getUint8(q)===255&&y.getUint8(q+1)===225){O=q;break}q+=1}if(O){var M=O+4,z=O+10;if(N(y,M,4)==="Exif"){var Q=y.getUint16(z);if(S=Q===18761,(S||Q===19789)&&y.getUint16(z+2,S)===42){var J=y.getUint32(z+4,S);J>=8&&(R=z+J)}}}if(R){var be=y.getUint16(R,S),re,L;for(L=0;L<be;L+=1)if(re=R+L*12+2,y.getUint16(re,S)===274){re+=8,w=y.getUint16(re,S),y.setUint16(re,1,S);break}}}catch{w=1}return w}function ue(_){var y=0,w=1,S=1;switch(_){case 2:w=-1;break;case 3:y=-180;break;case 4:S=-1;break;case 5:y=90,S=-1;break;case 6:y=90;break;case 7:y=90,w=-1;break;case 8:y=-90;break}return{rotate:y,scaleX:w,scaleY:S}}var K=/\.\d*(?:0|9){12}\d*$/;function se(_){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return K.test(_)?Math.round(_*y)/y:_}function oe(_){var y=_.aspectRatio,w=_.height,S=_.width,O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none",R=A(S),W=A(w);if(R&&W){var q=w*y;(O==="contain"||O==="none")&&q>S||O==="cover"&&q<S?w=S/y:S=w*y}else R?w=S/y:W&&(S=w*y);return{width:S,height:w}}function Fe(_){for(var y=U(new Uint8Array(_)),w=y.length,S=[],O=0;O+3<w;){var R=y[O],W=y[O+1];if(R===255&&W===218)break;if(R===255&&W===216)O+=2;else{var q=y[O+2]*256+y[O+3],M=O+q+2,z=y.slice(O,M);S.push(z),O=M}}return S.reduce(function(Q,J){return J[0]===255&&J[1]===225?Q.concat(J):Q},[])}function Se(_,y){var w=U(new Uint8Array(_));if(w[2]!==255||w[3]!==224)return _;var S=w[4]*256+w[5],O=[255,216].concat(y,w.slice(4+S));return new Uint8Array(O)}var g=x.ArrayBuffer,h=x.FileReader,f=x.URL||x.webkitURL,F=/\.\w+$/,T=x.Compressor,E=(function(){function _(y,w){t(this,_),this.file=y,this.exif=[],this.image=new Image,this.options=e(e({},v),w),this.aborted=!1,this.result=null,this.init()}return n(_,[{key:"init",value:function(){var w=this,S=this.file,O=this.options;if(!d(S)){this.fail(new Error("The first argument must be a File or Blob object."));return}var R=S.type;if(!k(R)){this.fail(new Error("The first argument must be an image File or Blob object."));return}if(!f||!h){this.fail(new Error("The current browser does not support image compression."));return}g||(O.checkOrientation=!1,O.retainExif=!1);var W=R==="image/jpeg",q=W&&O.checkOrientation,M=W&&O.retainExif;if(f&&!q&&!M)this.load({url:f.createObjectURL(S)});else{var z=new h;this.reader=z,z.onload=function(Q){var J=Q.target,be=J.result,re={},L=1;q&&(L=G(be),L>1&&o(re,ue(L))),M&&(w.exif=Fe(be)),q||M?!f||L>1?re.url=V(be,R):re.url=f.createObjectURL(S):re.url=be,w.load(re)},z.onabort=function(){w.fail(new Error("Aborted to read the image with FileReader."))},z.onerror=function(){w.fail(new Error("Failed to read the image with FileReader."))},z.onloadend=function(){w.reader=null},q||M?z.readAsArrayBuffer(S):z.readAsDataURL(S)}}},{key:"load",value:function(w){var S=this,O=this.file,R=this.image;R.onload=function(){S.draw(e(e({},w),{},{naturalWidth:R.naturalWidth,naturalHeight:R.naturalHeight}))},R.onabort=function(){S.fail(new Error("Aborted to load the image."))},R.onerror=function(){S.fail(new Error("Failed to load the image."))},x.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(x.navigator.userAgent)&&(R.crossOrigin="anonymous"),R.alt=O.name,R.src=w.url}},{key:"draw",value:function(w){var S=this,O=w.naturalWidth,R=w.naturalHeight,W=w.rotate,q=W===void 0?0:W,M=w.scaleX,z=M===void 0?1:M,Q=w.scaleY,J=Q===void 0?1:Q,be=this.file,re=this.image,L=this.options,ve=document.createElement("canvas"),ae=ve.getContext("2d"),Qe=Math.abs(q)%180===90,hi=(L.resize==="contain"||L.resize==="cover")&&A(L.width)&&A(L.height),_t=Math.max(L.maxWidth,0)||1/0,xt=Math.max(L.maxHeight,0)||1/0,St=Math.max(L.minWidth,0)||0,Ft=Math.max(L.minHeight,0)||0,Je=O/R,de=L.width,ce=L.height;if(Qe){var _s=[xt,_t];_t=_s[0],xt=_s[1];var xs=[Ft,St];St=xs[0],Ft=xs[1];var Ss=[ce,de];de=Ss[0],ce=Ss[1]}hi&&(Je=de/ce);var Fs=oe({aspectRatio:Je,width:_t,height:xt},"contain");_t=Fs.width,xt=Fs.height;var Ps=oe({aspectRatio:Je,width:St,height:Ft},"cover");if(St=Ps.width,Ft=Ps.height,hi){var Es=oe({aspectRatio:Je,width:de,height:ce},L.resize);de=Es.width,ce=Es.height}else{var Ts=oe({aspectRatio:Je,width:de,height:ce}),ks=Ts.width;de=ks===void 0?O:ks;var Cs=Ts.height;ce=Cs===void 0?R:Cs}de=Math.floor(se(Math.min(Math.max(de,St),_t))),ce=Math.floor(se(Math.min(Math.max(ce,Ft),xt)));var pd=-de/2,hd=-ce/2,fd=de,md=ce,fi=[];if(hi){var Us=0,As=0,mi=O,gi=R,Os=oe({aspectRatio:Je,width:O,height:R},{contain:"cover",cover:"contain"}[L.resize]);mi=Os.width,gi=Os.height,Us=(O-mi)/2,As=(R-gi)/2,fi.push(Us,As,mi,gi)}if(fi.push(pd,hd,fd,md),Qe){var Is=[ce,de];de=Is[0],ce=Is[1]}ve.width=de,ve.height=ce,k(L.mimeType)||(L.mimeType=be.type);var Rs="transparent";be.size>L.convertSize&&L.convertTypes.indexOf(L.mimeType)>=0&&(L.mimeType="image/jpeg");var Ns=L.mimeType==="image/jpeg";if(Ns&&(Rs="#fff"),ae.fillStyle=Rs,ae.fillRect(0,0,de,ce),L.beforeDraw&&L.beforeDraw.call(this,ae,ve),!this.aborted&&(ae.save(),ae.translate(de/2,ce/2),ae.rotate(q*Math.PI/180),ae.scale(z,J),ae.drawImage.apply(ae,[re].concat(fi)),ae.restore(),L.drew&&L.drew.call(this,ae,ve),!this.aborted)){var Bs=function(Pt){if(!S.aborted){var Ds=function(Et){return S.done({naturalWidth:O,naturalHeight:R,result:Et})};if(Pt&&Ns&&L.retainExif&&S.exif&&S.exif.length>0){var Ls=function(Et){return Ds(p(V(Se(Et,S.exif),L.mimeType)))};if(Pt.arrayBuffer)Pt.arrayBuffer().then(Ls).catch(function(){S.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))});else{var Ze=new h;S.reader=Ze,Ze.onload=function(yi){var Et=yi.target;Ls(Et.result)},Ze.onabort=function(){S.fail(new Error("Aborted to read the compressed image with FileReader."))},Ze.onerror=function(){S.fail(new Error("Failed to read the compressed image with FileReader."))},Ze.onloadend=function(){S.reader=null},Ze.readAsArrayBuffer(Pt)}}else Ds(Pt)}};ve.toBlob?ve.toBlob(Bs,L.mimeType,L.quality):Bs(p(ve.toDataURL(L.mimeType,L.quality)))}}},{key:"done",value:function(w){var S=w.naturalWidth,O=w.naturalHeight,R=w.result,W=this.file,q=this.image,M=this.options;if(f&&q.src.indexOf("blob:")===0&&f.revokeObjectURL(q.src),R)if(M.strict&&!M.retainExif&&R.size>W.size&&M.mimeType===W.type&&!(M.width>S||M.height>O||M.minWidth>S||M.minHeight>O||M.maxWidth<S||M.maxHeight<O))R=W;else{var z=new Date;R.lastModified=z.getTime(),R.lastModifiedDate=z,R.name=W.name,R.name&&R.type!==W.type&&(R.name=R.name.replace(F,B(R.type)))}else R=W;this.result=R,M.success&&M.success.call(this,R)}},{key:"fail",value:function(w){var S=this.options;if(S.error)S.error.call(this,w);else throw w}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=T,_}},{key:"setDefaults",value:function(w){o(v,w)}}]),_})();return E})});var ye=X((Zy,Hr)=>{"use strict";(function(){"use strict";var r={}.hasOwnProperty;function e(){for(var n="",s=0;s<arguments.length;s++){var o=arguments[s];o&&(n=i(n,t(o)))}return n}function t(n){if(typeof n=="string"||typeof n=="number")return n;if(typeof n!="object")return"";if(Array.isArray(n))return e.apply(null,n);if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]"))return n.toString();var s="";for(var o in n)r.call(n,o)&&n[o]&&(s=i(s,o));return s}function i(n,s){return s?n?n+" "+s:n+s:n}typeof Hr<"u"&&Hr.exports?(e.default=e,Hr.exports=e):typeof define=="function"&&typeof define.amd=="object"&&define.amd?define("classnames",[],function(){return e}):window.classNames=e})()});var Ya=X((Db,wn)=>{"use strict";var vp=Object.prototype.hasOwnProperty,me="~";function tr(){}Object.create&&(tr.prototype=Object.create(null),new tr().__proto__||(me=!1));function wp(r,e,t){this.fn=r,this.context=e,this.once=t||!1}function Xa(r,e,t,i,n){if(typeof t!="function")throw new TypeError("The listener must be a function");var s=new wp(t,i||r,n),o=me?me+e:e;return r._events[o]?r._events[o].fn?r._events[o]=[r._events[o],s]:r._events[o].push(s):(r._events[o]=s,r._eventsCount++),r}function Vr(r,e){--r._eventsCount===0?r._events=new tr:delete r._events[e]}function he(){this._events=new tr,this._eventsCount=0}he.prototype.eventNames=function(){var e=[],t,i;if(this._eventsCount===0)return e;for(i in t=this._events)vp.call(t,i)&&e.push(me?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};he.prototype.listeners=function(e){var t=me?me+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,s=i.length,o=new Array(s);n<s;n++)o[n]=i[n].fn;return o};he.prototype.listenerCount=function(e){var t=me?me+e:e,i=this._events[t];return i?i.fn?1:i.length:0};he.prototype.emit=function(e,t,i,n,s,o){var a=me?me+e:e;if(!this._events[a])return!1;var u=this._events[a],c=arguments.length,p,d;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),c){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,i),!0;case 4:return u.fn.call(u.context,t,i,n),!0;case 5:return u.fn.call(u.context,t,i,n,s),!0;case 6:return u.fn.call(u.context,t,i,n,s,o),!0}for(d=1,p=new Array(c-1);d<c;d++)p[d-1]=arguments[d];u.fn.apply(u.context,p)}else{var v=u.length,b;for(d=0;d<v;d++)switch(u[d].once&&this.removeListener(e,u[d].fn,void 0,!0),c){case 1:u[d].fn.call(u[d].context);break;case 2:u[d].fn.call(u[d].context,t);break;case 3:u[d].fn.call(u[d].context,t,i);break;case 4:u[d].fn.call(u[d].context,t,i,n);break;default:if(!p)for(b=1,p=new Array(c-1);b<c;b++)p[b-1]=arguments[b];u[d].fn.apply(u[d].context,p)}}return!0};he.prototype.on=function(e,t,i){return Xa(this,e,t,i,!1)};he.prototype.once=function(e,t,i){return Xa(this,e,t,i,!0)};he.prototype.removeListener=function(e,t,i,n){var s=me?me+e:e;if(!this._events[s])return this;if(!t)return Vr(this,s),this;var o=this._events[s];if(o.fn)o.fn===t&&(!n||o.once)&&(!i||o.context===i)&&Vr(this,s);else{for(var a=0,u=[],c=o.length;a<c;a++)(o[a].fn!==t||n&&!o[a].once||i&&o[a].context!==i)&&u.push(o[a]);u.length?this._events[s]=u.length===1?u[0]:u:Vr(this,s)}return this};he.prototype.removeAllListeners=function(e){var t;return e?(t=me?me+e:e,this._events[t]&&Vr(this,t)):(this._events=new tr,this._eventsCount=0),this};he.prototype.off=he.prototype.removeListener;he.prototype.addListener=he.prototype.on;he.prefixed=me;he.EventEmitter=he;typeof wn<"u"&&(wn.exports=he)});var yu=X((vw,gu)=>{"use strict";gu.exports=function(e,t){if(t=t.split(":")[0],e=+e,!e)return!1;switch(t){case"http":case"ws":return e!==80;case"https":case"wss":return e!==443;case"ftp":return e!==21;case"gopher":return e!==70;case"file":return!1}return e!==0}});var wu=X(ns=>{"use strict";var $h=Object.prototype.hasOwnProperty,Vh;function bu(r){try{return decodeURIComponent(r.replace(/\+/g," "))}catch{return null}}function vu(r){try{return encodeURIComponent(r)}catch{return null}}function Wh(r){for(var e=/([^=?#&]+)=?([^&]*)/g,t={},i;i=e.exec(r);){var n=bu(i[1]),s=bu(i[2]);n===null||s===null||n in t||(t[n]=s)}return t}function Gh(r,e){e=e||"";var t=[],i,n;typeof e!="string"&&(e="?");for(n in r)if($h.call(r,n)){if(i=r[n],!i&&(i===null||i===Vh||isNaN(i))&&(i=""),n=vu(n),i=vu(i),n===null||i===null)continue;t.push(n+"="+i)}return t.length?e+t.join("&"):""}ns.stringify=Gh;ns.parse=Wh});var ku=X((_w,Tu)=>{"use strict";var xu=yu(),si=wu(),Kh=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,Su=/[\n\r\t]/g,Xh=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,Fu=/:\d+$/,Yh=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,Qh=/^[a-zA-Z]:/;function os(r){return(r||"").toString().replace(Kh,"")}var ss=[["#","hash"],["?","query"],function(e,t){return Oe(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],_u={hash:1,query:1};function Pu(r){var e;typeof window<"u"?e=window:typeof global<"u"?e=global:typeof self<"u"?e=self:e={};var t=e.location||{};r=r||t;var i={},n=typeof r,s;if(r.protocol==="blob:")i=new Ie(unescape(r.pathname),{});else if(n==="string"){i=new Ie(r,{});for(s in _u)delete i[s]}else if(n==="object"){for(s in r)s in _u||(i[s]=r[s]);i.slashes===void 0&&(i.slashes=Xh.test(r.href))}return i}function Oe(r){return r==="file:"||r==="ftp:"||r==="http:"||r==="https:"||r==="ws:"||r==="wss:"}function Eu(r,e){r=os(r),r=r.replace(Su,""),e=e||{};var t=Yh.exec(r),i=t[1]?t[1].toLowerCase():"",n=!!t[2],s=!!t[3],o=0,a;return n?s?(a=t[2]+t[3]+t[4],o=t[2].length+t[3].length):(a=t[2]+t[4],o=t[2].length):s?(a=t[3]+t[4],o=t[3].length):a=t[4],i==="file:"?o>=2&&(a=a.slice(2)):Oe(i)?a=t[4]:i?n&&(a=a.slice(2)):o>=2&&Oe(e.protocol)&&(a=t[4]),{protocol:i,slashes:n||Oe(i),slashesCount:o,rest:a}}function Jh(r,e){if(r==="")return e;for(var t=(e||"/").split("/").slice(0,-1).concat(r.split("/")),i=t.length,n=t[i-1],s=!1,o=0;i--;)t[i]==="."?t.splice(i,1):t[i]===".."?(t.splice(i,1),o++):o&&(i===0&&(s=!0),t.splice(i,1),o--);return s&&t.unshift(""),(n==="."||n==="..")&&t.push(""),t.join("/")}function Ie(r,e,t){if(r=os(r),r=r.replace(Su,""),!(this instanceof Ie))return new Ie(r,e,t);var i,n,s,o,a,u,c=ss.slice(),p=typeof e,d=this,v=0;for(p!=="object"&&p!=="string"&&(t=e,e=null),t&&typeof t!="function"&&(t=si.parse),e=Pu(e),n=Eu(r||"",e),i=!n.protocol&&!n.slashes,d.slashes=n.slashes||i&&e.slashes,d.protocol=n.protocol||e.protocol||"",r=n.rest,(n.protocol==="file:"&&(n.slashesCount!==2||Qh.test(r))||!n.slashes&&(n.protocol||n.slashesCount<2||!Oe(d.protocol)))&&(c[3]=[/(.*)/,"pathname"]);v<c.length;v++){if(o=c[v],typeof o=="function"){r=o(r,d);continue}s=o[0],u=o[1],s!==s?d[u]=r:typeof s=="string"?(a=s==="@"?r.lastIndexOf(s):r.indexOf(s),~a&&(typeof o[2]=="number"?(d[u]=r.slice(0,a),r=r.slice(a+o[2])):(d[u]=r.slice(a),r=r.slice(0,a)))):(a=s.exec(r))&&(d[u]=a[1],r=r.slice(0,a.index)),d[u]=d[u]||i&&o[3]&&e[u]||"",o[4]&&(d[u]=d[u].toLowerCase())}t&&(d.query=t(d.query)),i&&e.slashes&&d.pathname.charAt(0)!=="/"&&(d.pathname!==""||e.pathname!=="")&&(d.pathname=Jh(d.pathname,e.pathname)),d.pathname.charAt(0)!=="/"&&Oe(d.protocol)&&(d.pathname="/"+d.pathname),xu(d.port,d.protocol)||(d.host=d.hostname,d.port=""),d.username=d.password="",d.auth&&(a=d.auth.indexOf(":"),~a?(d.username=d.auth.slice(0,a),d.username=encodeURIComponent(decodeURIComponent(d.username)),d.password=d.auth.slice(a+1),d.password=encodeURIComponent(decodeURIComponent(d.password))):d.username=encodeURIComponent(decodeURIComponent(d.auth)),d.auth=d.password?d.username+":"+d.password:d.username),d.origin=d.protocol!=="file:"&&Oe(d.protocol)&&d.host?d.protocol+"//"+d.host:"null",d.href=d.toString()}function Zh(r,e,t){var i=this;switch(r){case"query":typeof e=="string"&&e.length&&(e=(t||si.parse)(e)),i[r]=e;break;case"port":i[r]=e,xu(e,i.protocol)?e&&(i.host=i.hostname+":"+e):(i.host=i.hostname,i[r]="");break;case"hostname":i[r]=e,i.port&&(e+=":"+i.port),i.host=e;break;case"host":i[r]=e,Fu.test(e)?(e=e.split(":"),i.port=e.pop(),i.hostname=e.join(":")):(i.hostname=e,i.port="");break;case"protocol":i.protocol=e.toLowerCase(),i.slashes=!t;break;case"pathname":case"hash":if(e){var n=r==="pathname"?"/":"#";i[r]=e.charAt(0)!==n?n+e:e}else i[r]=e;break;case"username":case"password":i[r]=encodeURIComponent(e);break;case"auth":var s=e.indexOf(":");~s?(i.username=e.slice(0,s),i.username=encodeURIComponent(decodeURIComponent(i.username)),i.password=e.slice(s+1),i.password=encodeURIComponent(decodeURIComponent(i.password))):i.username=encodeURIComponent(decodeURIComponent(e))}for(var o=0;o<ss.length;o++){var a=ss[o];a[4]&&(i[a[1]]=i[a[1]].toLowerCase())}return i.auth=i.password?i.username+":"+i.password:i.username,i.origin=i.protocol!=="file:"&&Oe(i.protocol)&&i.host?i.protocol+"//"+i.host:"null",i.href=i.toString(),i}function ef(r){(!r||typeof r!="function")&&(r=si.stringify);var e,t=this,i=t.host,n=t.protocol;n&&n.charAt(n.length-1)!==":"&&(n+=":");var s=n+(t.protocol&&t.slashes||Oe(t.protocol)?"//":"");return t.username?(s+=t.username,t.password&&(s+=":"+t.password),s+="@"):t.password?(s+=":"+t.password,s+="@"):t.protocol!=="file:"&&Oe(t.protocol)&&!i&&t.pathname!=="/"&&(s+="@"),(i[i.length-1]===":"||Fu.test(t.hostname)&&!t.port)&&(i+=":"),s+=i+t.pathname,e=typeof t.query=="object"?r(t.query):t.query,e&&(s+=e.charAt(0)!=="?"?"?"+e:e),t.hash&&(s+=t.hash),s}Ie.prototype={set:Zh,toString:ef};Ie.extractProtocol=Eu;Ie.location=Pu;Ie.trimLeft=os;Ie.qs=si;Tu.exports=Ie});var js={name:"@uppy/store-default",description:"The default simple object-based store for Uppy.",version:"5.0.0",license:"MIT",main:"lib/index.js",type:"module",sideEffects:!1,scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","uppy","uppy-store"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},devDependencies:{jsdom:"^26.1.0",typescript:"^5.8.3",vitest:"^3.2.4"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},exports:{".":"./lib/index.js","./package.json":"./package.json"},files:["src","lib","dist","CHANGELOG.md"]};var bi=class{static VERSION=js.version;state={};#e=new Set;getState(){return this.state}setState(e){let t=m({},this.state),i=m(m({},this.state),e);this.state=i,this.#t(t,i,e)}subscribe(e){return this.#e.add(e),()=>{this.#e.delete(e)}}#t(...e){this.#e.forEach(t=>{t(...e)})}},Ms=bi;function tt(r,e){return Object.hasOwn(r,e)}var yd=/^data:([^/]+\/[^,;]+(?:[^,]*?))(;base64)?,([\s\S]*)$/;function bd(r,e,t){let i=yd.exec(r),n=e.mimeType??i?.[1]??"plain/text",s;if(i?.[2]!=null){let o=atob(decodeURIComponent(i[3])),a=new Uint8Array(o.length);for(let u=0;u<o.length;u++)a[u]=o.charCodeAt(u);s=[a]}else i?.[3]!=null&&(s=[decodeURIComponent(i[3])]);return t?new File(s,e.name||"",{type:n}):new Blob(s,{type:n})}var vi=bd;function Tt(r,e,t,i){return t===0||r===e?r:i===0?e:r+(e-r)*2**(-i/t)}var kt=['a[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','area[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])',"input:not([disabled]):not([inert]):not([aria-hidden])","select:not([disabled]):not([inert]):not([aria-hidden])","textarea:not([disabled]):not([inert]):not([aria-hidden])","button:not([disabled]):not([inert]):not([aria-hidden])",'iframe:not([tabindex^="-"]):not([inert]):not([aria-hidden])','object:not([tabindex^="-"]):not([inert]):not([aria-hidden])','embed:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[contenteditable]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[tabindex]:not([tabindex^="-"]):not([inert]):not([aria-hidden])'];var wi=class extends Error{cause;isNetworkError;request;constructor(e,t=null){super("This looks like a network error, the endpoint might be blocked by an internet provider or a firewall."),this.cause=e,this.isNetworkError=!0,this.request=t}},_i=wi;function xi(r){let e=t=>"error"in t&&!!t.error;return r.filter(t=>!e(t))}function Si(r){return r.filter(e=>!e.progress?.uploadStarted||!e.isRestored)}function Ct(r){return typeof r!="object"||r===null||!("nodeType"in r)?!1:r.nodeType===Node.ELEMENT_NODE}function vd(r){if(typeof r=="string"){let e=document.querySelectorAll(r);return e.length===0?null:Array.from(e)}return typeof r=="object"&&Ct(r)?[r]:null}var _r=vd;function wd(r,e=document){return typeof r=="string"?e.querySelector(r):Ct(r)?r:null}var Fi=wd;function Pe(r){let e=r.lastIndexOf(".");return e===-1||e===r.length-1?{name:r,extension:void 0}:{name:r.slice(0,e),extension:r.slice(e+1)}}var Pi={__proto__:null,md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",webp:"image/webp",gif:"image/gif",heic:"image/heic",heif:"image/heif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",dicom:"application/dicom",doc:"application/msword",msg:"application/vnd.ms-outlook",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel",txt:"text/plain",text:"text/plain",conf:"text/plain",log:"text/plain",pdf:"application/pdf",zip:"application/zip","7z":"application/x-7z-compressed",rar:"application/x-rar-compressed",tar:"application/x-tar",gz:"application/gzip",dmg:"application/x-apple-diskimage"};function rt(r){if(r.type)return r.type;let e=r.name?Pe(r.name).extension?.toLowerCase():null;return e&&e in Pi?Pi[e]:"application/octet-stream"}function _d(r){return r.charCodeAt(0).toString(32)}function zs(r){let e="";return r.replace(/[^A-Z0-9]/gi,t=>(e+=`-${_d(t)}`,"/"))+e}function Ei(r,e){let t=e||"uppy";return typeof r.name=="string"&&(t+=`-${zs(r.name.toLowerCase())}`),r.type!==void 0&&(t+=`-${r.type}`),r.meta&&typeof r.meta.relativePath=="string"&&(t+=`-${zs(r.meta.relativePath.toLowerCase())}`),r.data.size!==void 0&&(t+=`-${r.data.size}`),r.data.lastModified!==void 0&&(t+=`-${r.data.lastModified}`),t}function xd(r){return!r.isRemote||!r.remote?!1:new Set(["box","dropbox","drive","facebook","unsplash"]).has(r.remote.provider)}function Ut(r,e){if(xd(r))return r.id;let t=rt(r);return Ei(I(m({},r),{type:t}),e)}function xr(r,e){return r===!0?Object.keys(e):Array.isArray(r)?r:[]}var Re=Array.from;function Ti(r){let e=Re(r.files);return Promise.resolve(e)}function Sr(r,e,t,{onSuccess:i}){r.readEntries(n=>{let s=[...e,...n];n.length?queueMicrotask(()=>{Sr(r,s,t,{onSuccess:i})}):i(s)},n=>{t(n),i(e)})}function qs(r,e){return r==null?r:{kind:r.isFile?"file":r.isDirectory?"directory":void 0,name:r.name,getFile(){return new Promise((t,i)=>r.file(t,i))},async*values(){let t=r.createReader();yield*await new Promise(n=>{Sr(t,[],e,{onSuccess:s=>n(s.map(o=>qs(o,e)))})})},isSameEntry:void 0}}async function*Hs(r,e,t=void 0){let i=()=>`${e}/${r.name}`;if(r.kind==="file"){let n=await r.getFile();n!=null?(n.relativePath=e?i():null,yield n):t!=null&&(yield t)}else if(r.kind==="directory")for await(let n of r.values())yield*Hs(n,e?i():r.name);else t!=null&&(yield t)}async function*ki(r,e){let t=await Promise.all(Array.from(r.items,async i=>{let n;return n??=qs(typeof i.getAsEntry=="function"?i.getAsEntry():i.webkitGetAsEntry(),e),{fileSystemHandle:n,lastResortFile:i.getAsFile()}}));for(let{lastResortFile:i,fileSystemHandle:n}of t)if(n!=null)try{yield*Hs(n,"",i)}catch(s){i!=null?yield i:e(s)}else i!=null&&(yield i)}async function Fr(r,e){let t=e?.logDropError??Function.prototype;try{let i=[];for await(let n of ki(r,t))i.push(n);return i}catch{return Ti(r)}}function Sd(r){for(;r&&!r.dir;)r=r.parentNode;return r?.dir}var Ci=Sd;function Ui(r){return r<10?`0${r}`:r.toString()}function Me(){let r=new Date,e=Ui(r.getHours()),t=Ui(r.getMinutes()),i=Ui(r.getSeconds());return`${e}:${t}:${i}`}function Pr(){if(typeof window>"u")return!1;let r=document.body;return!(r==null||window==null||!("draggable"in r)||!("ondragstart"in r)||!("ondrop"in r)||!("FormData"in window)||!("FileReader"in window))}function Fd(r){return r?r.readyState!==0&&r.readyState!==4||r.status===0:!1}var Ai=Fd;function At(r){return r.startsWith("blob:")}function Ot(r){return r?/^[^/]+\/(jpe?g|gif|png|svg|svg\+xml|bmp|webp|avif)$/.test(r):!1}function Oi(r){let e=Math.floor(r/3600)%24,t=Math.floor(r/60)%60,i=Math.floor(r%60);return{hours:e,minutes:t,seconds:i}}function Er(r){let e=Oi(r),t=e.hours===0?"":`${e.hours}h`,i=e.minutes===0?"":`${e.hours===0?e.minutes:` ${e.minutes.toString(10).padStart(2,"0")}`}m`,n=e.hours!==0?"":`${e.minutes===0?e.seconds:` ${e.seconds.toString(10).padStart(2,"0")}`}s`;return`${t}${i}${n}`}function Pd(r){return new Error("Cancelled",{cause:r})}function $s(r){if(r!=null){let e=()=>this.abort(r.reason);r.addEventListener("abort",e,{once:!0});let t=()=>{r.removeEventListener("abort",e)};this.then?.(t,t)}return this}var ze=class{#e=0;#t=[];#r=!1;#i;#n=1;#u;#o;limit;constructor(e){typeof e!="number"||e===0?this.limit=1/0:this.limit=e}#a(e){this.#e+=1;let t=!1,i;try{i=e()}catch(n){throw this.#e-=1,n}return{abort:n=>{t||(t=!0,this.#e-=1,i?.(n),this.#s())},done:()=>{t||(t=!0,this.#e-=1,this.#s())}}}#s(){queueMicrotask(()=>this.#h())}#h(){if(this.#r||this.#e>=this.limit||this.#t.length===0)return;let e=this.#t.shift();if(e==null)throw new Error("Invariant violation: next is null");let t=this.#a(e.fn);e.abort=t.abort,e.done=t.done}#l(e,t){let i={fn:e,priority:t?.priority||0,abort:()=>{this.#c(i)},done:()=>{throw new Error("Cannot mark a queued request as done: this indicates a bug")}},n=this.#t.findIndex(s=>i.priority>s.priority);return n===-1?this.#t.push(i):this.#t.splice(n,0,i),i}#c(e){let t=this.#t.indexOf(e);t!==-1&&this.#t.splice(t,1)}run(e,t){return!this.#r&&this.#e<this.limit?this.#a(e):this.#l(e,t)}wrapSyncFunction(e,t){return(...i)=>{let n=this.run(()=>(e(...i),queueMicrotask(()=>n.done()),()=>{}),t);return{abortOn:$s,abort(){n.abort()}}}}wrapPromiseFunction(e,t){return(...i)=>{let n,s=new Promise((o,a)=>{n=this.run(()=>{let u,c;try{c=Promise.resolve(e(...i))}catch(p){c=Promise.reject(p)}return c.then(p=>{u?a(u):(n.done(),o(p))},p=>{u?a(u):(n.done(),a(p))}),p=>{u=Pd(p)}},t)});return s.abort=o=>{n.abort(o)},s.abortOn=$s,s}}resume(){this.#r=!1,clearTimeout(this.#i);for(let e=0;e<this.limit;e++)this.#s()}#d=()=>this.resume();pause(e=null){this.#r=!0,clearTimeout(this.#i),e!=null&&(this.#i=setTimeout(this.#d,e))}rateLimit(e){clearTimeout(this.#o),this.pause(e),this.limit>1&&Number.isFinite(this.limit)&&(this.#u=this.limit-1,this.limit=this.#n,this.#o=setTimeout(this.#p,e))}#p=()=>{if(this.#r){this.#o=setTimeout(this.#p,0);return}this.#n=this.limit,this.limit=Math.ceil((this.#u+this.#n)/2);for(let e=this.#n;e<=this.limit;e++)this.#s();this.#u-this.#n>3?this.#o=setTimeout(this.#p,2e3):this.#n=Math.floor(this.#n/2)};get isPaused(){return this.#r}},Ed=Symbol("__queue");function Tr(r){return I(m({},r),{type:r.mimeType,extension:r.name?Pe(r.name).extension:null})}function Td(r,e,t){let i=[];return r.forEach(n=>typeof n!="string"?i.push(n):e[Symbol.split](n).forEach((s,o,a)=>{s!==""&&i.push(s),o<a.length-1&&i.push(t)})),i}function Vs(r,e){let t=/\$/g,i="$$$$",n=[r];if(e==null)return n;for(let s of Object.keys(e))if(s!=="_"){let o=e[s];typeof o=="string"&&(o=t[Symbol.replace](o,i)),n=Td(n,new RegExp(`%\\{${s}\\}`,"g"),o)}return n}var kd=r=>{throw new Error(`missing string: ${r}`)},qe=class{locale;constructor(e,{onMissingKey:t=kd}={}){this.locale={strings:{},pluralize(i){return i===1?0:1}},Array.isArray(e)?e.forEach(this.#t,this):this.#t(e),this.#e=t}#e;#t(e){if(!e?.strings)return;let t=this.locale;Object.assign(this.locale,{strings:m(m({},t.strings),e.strings),pluralize:e.pluralize||t.pluralize})}translate(e,t){return this.translateArray(e,t).join("")}translateArray(e,t){let i=this.locale.strings[e];if(i==null&&(this.#e(e),i=e),typeof i=="object"){if(t&&typeof t.smart_count<"u"){let s=this.locale.pluralize(t.smart_count);return Vs(i[s],t)}throw new Error("Attempted to use a string with plural forms, but no value was given for %{smart_count}")}if(typeof i!="string")throw new Error("string was not a string");return Vs(i,t)}};function It(r,e){if(e===0)return"";if(r.length<=e)return r;if(e<=4)return`${r.slice(0,e-1)}\u2026`;let t=e-3,i=Math.ceil(t/2),n=Math.floor(t/2);return r.slice(0,i)+"..."+r.slice(-n)}var Bt,$,Ys,Cd,He,Ws,Qs,Js,Zs,Bi,Ii,Ri,Ud,Nt={},eo=[],Ad=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Dt=Array.isArray;function ke(r,e){for(var t in e)r[t]=e[t];return r}function Di(r){r&&r.parentNode&&r.parentNode.removeChild(r)}function Lt(r,e,t){var i,n,s,o={};for(s in e)s=="key"?i=e[s]:s=="ref"?n=e[s]:o[s]=e[s];if(arguments.length>2&&(o.children=arguments.length>3?Bt.call(arguments,2):t),typeof r=="function"&&r.defaultProps!=null)for(s in r.defaultProps)o[s]===void 0&&(o[s]=r.defaultProps[s]);return Rt(r,o,i,n,null)}function Rt(r,e,t,i,n){var s={type:r,props:e,key:t,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:n??++Ys,__i:-1,__u:0};return n==null&&$.vnode!=null&&$.vnode(s),s}function to(){return{current:null}}function ie(r){return r.children}function pe(r,e){this.props=r,this.context=e}function it(r,e){if(e==null)return r.__?it(r.__,r.__i+1):null;for(var t;e<r.__k.length;e++)if((t=r.__k[e])!=null&&t.__e!=null)return t.__e;return typeof r.type=="function"?it(r):null}function ro(r){var e,t;if((r=r.__)!=null&&r.__c!=null){for(r.__e=r.__c.base=null,e=0;e<r.__k.length;e++)if((t=r.__k[e])!=null&&t.__e!=null){r.__e=r.__c.base=t.__e;break}return ro(r)}}function Gs(r){(!r.__d&&(r.__d=!0)&&He.push(r)&&!Cr.__r++||Ws!=$.debounceRendering)&&((Ws=$.debounceRendering)||Qs)(Cr)}function Cr(){for(var r,e,t,i,n,s,o,a=1;He.length;)He.length>a&&He.sort(Js),r=He.shift(),a=He.length,r.__d&&(t=void 0,i=void 0,n=(i=(e=r).__v).__e,s=[],o=[],e.__P&&((t=ke({},i)).__v=i.__v+1,$.vnode&&$.vnode(t),Li(e.__P,t,i,e.__n,e.__P.namespaceURI,32&i.__u?[n]:null,s,n??it(i),!!(32&i.__u),o),t.__v=i.__v,t.__.__k[t.__i]=t,so(s,t,o),i.__e=i.__=null,t.__e!=n&&ro(t)));Cr.__r=0}function io(r,e,t,i,n,s,o,a,u,c,p){var d,v,b,x,A,C,U,P=i&&i.__k||eo,k=e.length;for(u=Od(t,e,P,u,k),d=0;d<k;d++)(b=t.__k[d])!=null&&(v=b.__i==-1?Nt:P[b.__i]||Nt,b.__i=d,C=Li(r,b,v,n,s,o,a,u,c,p),x=b.__e,b.ref&&v.ref!=b.ref&&(v.ref&&ji(v.ref,null,b),p.push(b.ref,b.__c||x,b)),A==null&&x!=null&&(A=x),(U=!!(4&b.__u))||v.__k===b.__k?u=no(b,u,r,U):typeof b.type=="function"&&C!==void 0?u=C:x&&(u=x.nextSibling),b.__u&=-7);return t.__e=A,u}function Od(r,e,t,i,n){var s,o,a,u,c,p=t.length,d=p,v=0;for(r.__k=new Array(n),s=0;s<n;s++)(o=e[s])!=null&&typeof o!="boolean"&&typeof o!="function"?(u=s+v,(o=r.__k[s]=typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?Rt(null,o,null,null,null):Dt(o)?Rt(ie,{children:o},null,null,null):o.constructor==null&&o.__b>0?Rt(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=r,o.__b=r.__b+1,a=null,(c=o.__i=Id(o,t,u,d))!=-1&&(d--,(a=t[c])&&(a.__u|=2)),a==null||a.__v==null?(c==-1&&(n>p?v--:n<p&&v++),typeof o.type!="function"&&(o.__u|=4)):c!=u&&(c==u-1?v--:c==u+1?v++:(c>u?v--:v++,o.__u|=4))):r.__k[s]=null;if(d)for(s=0;s<p;s++)(a=t[s])!=null&&(2&a.__u)==0&&(a.__e==i&&(i=it(a)),ao(a,a));return i}function no(r,e,t,i){var n,s;if(typeof r.type=="function"){for(n=r.__k,s=0;n&&s<n.length;s++)n[s]&&(n[s].__=r,e=no(n[s],e,t,i));return e}r.__e!=e&&(i&&(e&&r.type&&!e.parentNode&&(e=it(r)),t.insertBefore(r.__e,e||null)),e=r.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function Ce(r,e){return e=e||[],r==null||typeof r=="boolean"||(Dt(r)?r.some(function(t){Ce(t,e)}):e.push(r)),e}function Id(r,e,t,i){var n,s,o,a=r.key,u=r.type,c=e[t],p=c!=null&&(2&c.__u)==0;if(c===null&&r.key==null||p&&a==c.key&&u==c.type)return t;if(i>(p?1:0)){for(n=t-1,s=t+1;n>=0||s<e.length;)if((c=e[o=n>=0?n--:s++])!=null&&(2&c.__u)==0&&a==c.key&&u==c.type)return o}return-1}function Ks(r,e,t){e[0]=="-"?r.setProperty(e,t??""):r[e]=t==null?"":typeof t!="number"||Ad.test(e)?t:t+"px"}function kr(r,e,t,i,n){var s,o;e:if(e=="style")if(typeof t=="string")r.style.cssText=t;else{if(typeof i=="string"&&(r.style.cssText=i=""),i)for(e in i)t&&e in t||Ks(r.style,e,"");if(t)for(e in t)i&&t[e]==i[e]||Ks(r.style,e,t[e])}else if(e[0]=="o"&&e[1]=="n")s=e!=(e=e.replace(Zs,"$1")),o=e.toLowerCase(),e=o in r||e=="onFocusOut"||e=="onFocusIn"?o.slice(2):e.slice(2),r.l||(r.l={}),r.l[e+s]=t,t?i?t.u=i.u:(t.u=Bi,r.addEventListener(e,s?Ri:Ii,s)):r.removeEventListener(e,s?Ri:Ii,s);else{if(n=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in r)try{r[e]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&e[4]!="-"?r.removeAttribute(e):r.setAttribute(e,e=="popover"&&t==1?"":t))}}function Xs(r){return function(e){if(this.l){var t=this.l[e.type+r];if(e.t==null)e.t=Bi++;else if(e.t<t.u)return;return t($.event?$.event(e):e)}}}function Li(r,e,t,i,n,s,o,a,u,c){var p,d,v,b,x,A,C,U,P,k,B,j,N,D,V,G,ue,K=e.type;if(e.constructor!=null)return null;128&t.__u&&(u=!!(32&t.__u),s=[a=e.__e=t.__e]),(p=$.__b)&&p(e);e:if(typeof K=="function")try{if(U=e.props,P="prototype"in K&&K.prototype.render,k=(p=K.contextType)&&i[p.__c],B=p?k?k.props.value:p.__:i,t.__c?C=(d=e.__c=t.__c).__=d.__E:(P?e.__c=d=new K(U,B):(e.__c=d=new pe(U,B),d.constructor=K,d.render=Nd),k&&k.sub(d),d.props=U,d.state||(d.state={}),d.context=B,d.__n=i,v=d.__d=!0,d.__h=[],d._sb=[]),P&&d.__s==null&&(d.__s=d.state),P&&K.getDerivedStateFromProps!=null&&(d.__s==d.state&&(d.__s=ke({},d.__s)),ke(d.__s,K.getDerivedStateFromProps(U,d.__s))),b=d.props,x=d.state,d.__v=e,v)P&&K.getDerivedStateFromProps==null&&d.componentWillMount!=null&&d.componentWillMount(),P&&d.componentDidMount!=null&&d.__h.push(d.componentDidMount);else{if(P&&K.getDerivedStateFromProps==null&&U!==b&&d.componentWillReceiveProps!=null&&d.componentWillReceiveProps(U,B),!d.__e&&d.shouldComponentUpdate!=null&&d.shouldComponentUpdate(U,d.__s,B)===!1||e.__v==t.__v){for(e.__v!=t.__v&&(d.props=U,d.state=d.__s,d.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.some(function(se){se&&(se.__=e)}),j=0;j<d._sb.length;j++)d.__h.push(d._sb[j]);d._sb=[],d.__h.length&&o.push(d);break e}d.componentWillUpdate!=null&&d.componentWillUpdate(U,d.__s,B),P&&d.componentDidUpdate!=null&&d.__h.push(function(){d.componentDidUpdate(b,x,A)})}if(d.context=B,d.props=U,d.__P=r,d.__e=!1,N=$.__r,D=0,P){for(d.state=d.__s,d.__d=!1,N&&N(e),p=d.render(d.props,d.state,d.context),V=0;V<d._sb.length;V++)d.__h.push(d._sb[V]);d._sb=[]}else do d.__d=!1,N&&N(e),p=d.render(d.props,d.state,d.context),d.state=d.__s;while(d.__d&&++D<25);d.state=d.__s,d.getChildContext!=null&&(i=ke(ke({},i),d.getChildContext())),P&&!v&&d.getSnapshotBeforeUpdate!=null&&(A=d.getSnapshotBeforeUpdate(b,x)),G=p,p!=null&&p.type===ie&&p.key==null&&(G=oo(p.props.children)),a=io(r,Dt(G)?G:[G],e,t,i,n,s,o,a,u,c),d.base=e.__e,e.__u&=-161,d.__h.length&&o.push(d),C&&(d.__E=d.__=null)}catch(se){if(e.__v=null,u||s!=null)if(se.then){for(e.__u|=u?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;s[s.indexOf(a)]=null,e.__e=a}else{for(ue=s.length;ue--;)Di(s[ue]);Ni(e)}else e.__e=t.__e,e.__k=t.__k,se.then||Ni(e);$.__e(se,e,t)}else s==null&&e.__v==t.__v?(e.__k=t.__k,e.__e=t.__e):a=e.__e=Rd(t.__e,e,t,i,n,s,o,u,c);return(p=$.diffed)&&p(e),128&e.__u?void 0:a}function Ni(r){r&&r.__c&&(r.__c.__e=!0),r&&r.__k&&r.__k.forEach(Ni)}function so(r,e,t){for(var i=0;i<t.length;i++)ji(t[i],t[++i],t[++i]);$.__c&&$.__c(e,r),r.some(function(n){try{r=n.__h,n.__h=[],r.some(function(s){s.call(n)})}catch(s){$.__e(s,n.__v)}})}function oo(r){return typeof r!="object"||r==null||r.__b&&r.__b>0?r:Dt(r)?r.map(oo):ke({},r)}function Rd(r,e,t,i,n,s,o,a,u){var c,p,d,v,b,x,A,C=t.props,U=e.props,P=e.type;if(P=="svg"?n="http://www.w3.org/2000/svg":P=="math"?n="http://www.w3.org/1998/Math/MathML":n||(n="http://www.w3.org/1999/xhtml"),s!=null){for(c=0;c<s.length;c++)if((b=s[c])&&"setAttribute"in b==!!P&&(P?b.localName==P:b.nodeType==3)){r=b,s[c]=null;break}}if(r==null){if(P==null)return document.createTextNode(U);r=document.createElementNS(n,P,U.is&&U),a&&($.__m&&$.__m(e,s),a=!1),s=null}if(P==null)C===U||a&&r.data==U||(r.data=U);else{if(s=s&&Bt.call(r.childNodes),C=t.props||Nt,!a&&s!=null)for(C={},c=0;c<r.attributes.length;c++)C[(b=r.attributes[c]).name]=b.value;for(c in C)if(b=C[c],c!="children"){if(c=="dangerouslySetInnerHTML")d=b;else if(!(c in U)){if(c=="value"&&"defaultValue"in U||c=="checked"&&"defaultChecked"in U)continue;kr(r,c,null,b,n)}}for(c in U)b=U[c],c=="children"?v=b:c=="dangerouslySetInnerHTML"?p=b:c=="value"?x=b:c=="checked"?A=b:a&&typeof b!="function"||C[c]===b||kr(r,c,b,C[c],n);if(p)a||d&&(p.__html==d.__html||p.__html==r.innerHTML)||(r.innerHTML=p.__html),e.__k=[];else if(d&&(r.innerHTML=""),io(e.type=="template"?r.content:r,Dt(v)?v:[v],e,t,i,P=="foreignObject"?"http://www.w3.org/1999/xhtml":n,s,o,s?s[0]:t.__k&&it(t,0),a,u),s!=null)for(c=s.length;c--;)Di(s[c]);a||(c="value",P=="progress"&&x==null?r.removeAttribute("value"):x!=null&&(x!==r[c]||P=="progress"&&!x||P=="option"&&x!=C[c])&&kr(r,c,x,C[c],n),c="checked",A!=null&&A!=r[c]&&kr(r,c,A,C[c],n))}return r}function ji(r,e,t){try{if(typeof r=="function"){var i=typeof r.__u=="function";i&&r.__u(),i&&e==null||(r.__u=r(e))}else r.current=e}catch(n){$.__e(n,t)}}function ao(r,e,t){var i,n;if($.unmount&&$.unmount(r),(i=r.ref)&&(i.current&&i.current!=r.__e||ji(i,null,e)),(i=r.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(s){$.__e(s,e)}i.base=i.__P=null}if(i=r.__k)for(n=0;n<i.length;n++)i[n]&&ao(i[n],e,t||typeof r.type!="function");t||Di(r.__e),r.__c=r.__=r.__e=void 0}function Nd(r,e,t){return this.constructor(r,t)}function Mi(r,e,t){var i,n,s,o;e==document&&(e=document.documentElement),$.__&&$.__(r,e),n=(i=typeof t=="function")?null:t&&t.__k||e.__k,s=[],o=[],Li(e,r=(!i&&t||e).__k=Lt(ie,null,[r]),n||Nt,Nt,e.namespaceURI,!i&&t?[t]:n?null:e.firstChild?Bt.call(e.childNodes):null,s,!i&&t?t:n?n.__e:e.firstChild,i,o),so(s,r,o)}function Ur(r,e,t){var i,n,s,o,a=ke({},r.props);for(s in r.type&&r.type.defaultProps&&(o=r.type.defaultProps),e)s=="key"?i=e[s]:s=="ref"?n=e[s]:a[s]=e[s]===void 0&&o!=null?o[s]:e[s];return arguments.length>2&&(a.children=arguments.length>3?Bt.call(arguments,2):t),Rt(r.type,a,i||r.key,n||r.ref,null)}Bt=eo.slice,$={__e:function(r,e,t,i){for(var n,s,o;e=e.__;)if((n=e.__c)&&!n.__)try{if((s=n.constructor)&&s.getDerivedStateFromError!=null&&(n.setState(s.getDerivedStateFromError(r)),o=n.__d),n.componentDidCatch!=null&&(n.componentDidCatch(r,i||{}),o=n.__d),o)return n.__E=n}catch(a){r=a}throw r}},Ys=0,Cd=function(r){return r!=null&&r.constructor==null},pe.prototype.setState=function(r,e){var t;t=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=ke({},this.state),typeof r=="function"&&(r=r(ke({},t),this.props)),r&&ke(t,r),r!=null&&this.__v&&(e&&this._sb.push(e),Gs(this))},pe.prototype.forceUpdate=function(r){this.__v&&(this.__e=!0,r&&this.__h.push(r),Gs(this))},pe.prototype.render=ie,He=[],Qs=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Js=function(r,e){return r.__v.__b-e.__v.__b},Cr.__r=0,Zs=/(PointerCapture)$|Capture$/i,Bi=0,Ii=Xs(!1),Ri=Xs(!0),Ud=0;var Bd=0,Ym=Array.isArray;function l(r,e,t,i,n,s){e||(e={});var o,a,u=e;if("ref"in u)for(a in u={},e)a=="ref"?o=e[a]:u[a]=e[a];var c={type:r,props:u,key:t,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Bd,__i:-1,__u:0,__source:n,__self:s};if(typeof r=="function"&&(o=r.defaultProps))for(a in o)u[a]===void 0&&(u[a]=o[a]);return $.vnode&&$.vnode(c),c}var jt,Z,zi,lo,Mt=0,yo=[],ee=$,uo=ee.__b,co=ee.__r,po=ee.diffed,ho=ee.__c,fo=ee.unmount,mo=ee.__;function Hi(r,e){ee.__h&&ee.__h(Z,r,Mt||e),Mt=0;var t=Z.__H||(Z.__H={__:[],__h:[]});return r>=t.__.length&&t.__.push({}),t.__[r]}function we(r){return Mt=1,Dd(vo,r)}function Dd(r,e,t){var i=Hi(jt++,2);if(i.t=r,!i.__c&&(i.__=[t?t(e):vo(void 0,e),function(a){var u=i.__N?i.__N[0]:i.__[0],c=i.t(u,a);u!==c&&(i.__N=[c,i.__[1]],i.__c.setState({}))}],i.__c=Z,!Z.__f)){var n=function(a,u,c){if(!i.__c.__H)return!0;var p=i.__c.__H.__.filter(function(v){return!!v.__c});if(p.every(function(v){return!v.__N}))return!s||s.call(this,a,u,c);var d=i.__c.props!==a;return p.forEach(function(v){if(v.__N){var b=v.__[0];v.__=v.__N,v.__N=void 0,b!==v.__[0]&&(d=!0)}}),s&&s.call(this,a,u,c)||d};Z.__f=!0;var s=Z.shouldComponentUpdate,o=Z.componentWillUpdate;Z.componentWillUpdate=function(a,u,c){if(this.__e){var p=s;s=void 0,n(a,u,c),s=p}o&&o.call(this,a,u,c)},Z.shouldComponentUpdate=n}return i.__N||i.__}function Ee(r,e){var t=Hi(jt++,3);!ee.__s&&bo(t.__H,e)&&(t.__=r,t.u=e,Z.__H.__h.push(t))}function Be(r){return Mt=5,$e(function(){return{current:r}},[])}function $e(r,e){var t=Hi(jt++,7);return bo(t.__H,e)&&(t.__=r(),t.__H=e,t.__h=r),t.__}function Te(r,e){return Mt=8,$e(function(){return r},e)}function Ld(){for(var r;r=yo.shift();)if(r.__P&&r.__H)try{r.__H.__h.forEach(Ar),r.__H.__h.forEach(qi),r.__H.__h=[]}catch(e){r.__H.__h=[],ee.__e(e,r.__v)}}ee.__b=function(r){Z=null,uo&&uo(r)},ee.__=function(r,e){r&&e.__k&&e.__k.__m&&(r.__m=e.__k.__m),mo&&mo(r,e)},ee.__r=function(r){co&&co(r),jt=0;var e=(Z=r.__c).__H;e&&(zi===Z?(e.__h=[],Z.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.u=t.__N=void 0})):(e.__h.forEach(Ar),e.__h.forEach(qi),e.__h=[],jt=0)),zi=Z},ee.diffed=function(r){po&&po(r);var e=r.__c;e&&e.__H&&(e.__H.__h.length&&(yo.push(e)!==1&&lo===ee.requestAnimationFrame||((lo=ee.requestAnimationFrame)||jd)(Ld)),e.__H.__.forEach(function(t){t.u&&(t.__H=t.u),t.u=void 0})),zi=Z=null},ee.__c=function(r,e){e.some(function(t){try{t.__h.forEach(Ar),t.__h=t.__h.filter(function(i){return!i.__||qi(i)})}catch(i){e.some(function(n){n.__h&&(n.__h=[])}),e=[],ee.__e(i,t.__v)}}),ho&&ho(r,e)},ee.unmount=function(r){fo&&fo(r);var e,t=r.__c;t&&t.__H&&(t.__H.__.forEach(function(i){try{Ar(i)}catch(n){e=n}}),t.__H=void 0,e&&ee.__e(e,t.__v))};var go=typeof requestAnimationFrame=="function";function jd(r){var e,t=function(){clearTimeout(i),go&&cancelAnimationFrame(e),setTimeout(r)},i=setTimeout(t,35);go&&(e=requestAnimationFrame(t))}function Ar(r){var e=Z,t=r.__c;typeof t=="function"&&(r.__c=void 0,t()),Z=e}function qi(r){var e=Z;r.__c=r.__(),Z=e}function bo(r,e){return!r||r.length!==e.length||e.some(function(t,i){return t!==r[i]})}function vo(r,e){return typeof e=="function"?e(r):e}var Md={position:"relative",width:"100%",minHeight:"100%"},zd={position:"absolute",top:0,left:0,width:"100%",overflow:"visible"};function nt(o){var a=o,{data:r,rowHeight:e,renderRow:t,overscanCount:i=10,padding:n=4}=a,s=et(a,["data","rowHeight","renderRow","overscanCount","padding"]);let u=Be(null),[c,p]=we(0),[d,v]=we(0);Ee(()=>{function B(){u.current!=null&&d!==u.current.offsetHeight&&v(u.current.offsetHeight)}return B(),window.addEventListener("resize",B),()=>{window.removeEventListener("resize",B)}},[d]);let b=Te(()=>{u.current&&p(u.current.scrollTop)},[]),x=Math.floor(c/e),A=Math.floor(d/e);i&&(x=Math.max(0,x-x%i),A+=i);let C=x+A+n,U=r.slice(x,C),P=I(m({},Md),{height:r.length*e}),k=I(m({},zd),{top:x*e});return l("div",I(m({onScroll:b,ref:u},s),{children:l("div",{role:"presentation",style:P,children:l("div",{role:"presentation",style:k,children:U.map(t)})})}))}var ha=Y(Jo(),1),fa=Y(ea(),1);var Rc="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";var De=(r=21)=>{let e="",t=r|0;for(;t--;)e+=Rc[Math.random()*64|0];return e};var ta={name:"@uppy/core",description:"Core module for the extensible JavaScript file upload widget with support for drag&drop, resumable uploads, previews, restrictions, file processing/encoding, remote providers like Instagram, Dropbox, Google Drive, S3 and more :dog:",version:"5.0.2",license:"MIT",style:"dist/style.min.css",type:"module",sideEffects:["*.css"],scripts:{build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","uppy","uppy-plugin"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],exports:{".":"./lib/index.js","./css/style.min.css":"./dist/style.min.css","./css/style.css":"./dist/style.css","./css/style.scss":"./src/style.scss","./package.json":"./package.json"},dependencies:{"@transloadit/prettier-bytes":"^0.3.4","@uppy/store-default":"^5.0.0","@uppy/utils":"^7.0.2",lodash:"^4.17.21","mime-match":"^1.0.2","namespace-emitter":"^2.0.1",nanoid:"^5.0.9",preact:"^10.5.13"},devDependencies:{"@types/deep-freeze":"^0",cssnano:"^7.0.7","deep-freeze":"^0.0.1",jsdom:"^26.1.0",postcss:"^8.5.6","postcss-cli":"^11.0.1",sass:"^1.89.2",typescript:"^5.8.3",vitest:"^3.2.4"}};function Ki(r,e){return e.name?e.name:r.split("/")[0]==="image"?`${r.split("/")[0]}.${r.split("/")[1]}`:"noname"}var ra={strings:{addBulkFilesFailed:{0:"Failed to add %{smart_count} file due to an internal error",1:"Failed to add %{smart_count} files due to internal errors"},youCanOnlyUploadX:{0:"You can only upload %{smart_count} file",1:"You can only upload %{smart_count} files"},youHaveToAtLeastSelectX:{0:"You have to select at least %{smart_count} file",1:"You have to select at least %{smart_count} files"},aggregateExceedsSize:"You selected %{size} of files, but maximum allowed size is %{sizeAllowed}",exceedsSize:"%{file} exceeds maximum allowed size of %{size}",missingRequiredMetaField:"Missing required meta fields",missingRequiredMetaFieldOnFile:"Missing required meta fields in %{fileName}",inferiorSize:"This file is smaller than the allowed size of %{size}",youCanOnlyUploadFileTypes:"You can only upload: %{types}",noMoreFilesAllowed:"Cannot add more files",noDuplicates:"Cannot add the duplicate file '%{fileName}', it already exists",companionError:"Connection with Companion failed",authAborted:"Authentication aborted",companionUnauthorizeHint:"To unauthorize to your %{provider} account, please go to %{url}",failedToUpload:"Failed to upload %{file}",noInternetConnection:"No Internet connection",connectedToInternet:"Connected to the Internet",noFilesFound:"You have no files or folders here",noSearchResults:"Unfortunately, there are no results for this search",selectX:{0:"Select %{smart_count}",1:"Select %{smart_count}"},allFilesFromFolderNamed:"All files from folder %{name}",openFolderNamed:"Open folder %{name}",cancel:"Cancel",logOut:"Log out",logIn:"Log in",pickFiles:"Pick files",pickPhotos:"Pick photos",filter:"Filter",resetFilter:"Reset filter",loading:"Loading...",loadedXFiles:"Loaded %{numFiles} files",authenticateWithTitle:"Please authenticate with %{pluginName} to select files",authenticateWith:"Connect to %{pluginName}",signInWithGoogle:"Sign in with Google",searchImages:"Search for images",enterTextToSearch:"Enter text to search for images",search:"Search",resetSearch:"Reset search",emptyFolderAdded:"No files were added from empty folder",addedNumFiles:"Added %{numFiles} file(s)",folderAlreadyAdded:'The folder "%{folder}" was already added',folderAdded:{0:"Added %{smart_count} file from %{folder}",1:"Added %{smart_count} files from %{folder}"},additionalRestrictionsFailed:"%{count} additional restrictions were not fulfilled",unnamed:"Unnamed",pleaseWait:"Please wait"}};var ia={debug:()=>{},warn:()=>{},error:(...r)=>console.error(`[Uppy] [${Me()}]`,...r)},na={debug:(...r)=>console.debug(`[Uppy] [${Me()}]`,...r),warn:(...r)=>console.warn(`[Uppy] [${Me()}]`,...r),error:(...r)=>console.error(`[Uppy] [${Me()}]`,...r)};var Ht=Y(qt(),1),ca=Y(da(),1),pa={maxFileSize:null,minFileSize:null,maxTotalFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null,requiredMetaFields:[]},ge=class extends Error{isUserFacing;file;constructor(e,t){super(e),this.isUserFacing=t?.isUserFacing??!0,t?.file&&(this.file=t.file)}isRestriction=!0},Ir=class{getI18n;getOpts;constructor(e,t){this.getI18n=t,this.getOpts=()=>{let i=e();if(i.restrictions?.allowedFileTypes!=null&&!Array.isArray(i.restrictions.allowedFileTypes))throw new TypeError("`restrictions.allowedFileTypes` must be an array");return i}}validateAggregateRestrictions(e,t){let{maxTotalFileSize:i,maxNumberOfFiles:n}=this.getOpts().restrictions;if(n&&e.filter(o=>!o.isGhost).length+t.length>n)throw new ge(`${this.getI18n()("youCanOnlyUploadX",{smart_count:n})}`);if(i){let s=[...e,...t].reduce((o,a)=>o+(a.size??0),0);if(s>i)throw new ge(this.getI18n()("aggregateExceedsSize",{sizeAllowed:(0,Ht.default)(i),size:(0,Ht.default)(s)}))}}validateSingleFile(e){let{maxFileSize:t,minFileSize:i,allowedFileTypes:n}=this.getOpts().restrictions;if(n&&!n.some(o=>o.includes("/")?e.type?(0,ca.default)(e.type.replace(/;.*?$/,""),o):!1:o[0]==="."&&e.extension?e.extension.toLowerCase()===o.slice(1).toLowerCase():!1)){let o=n.join(", ");throw new ge(this.getI18n()("youCanOnlyUploadFileTypes",{types:o}),{file:e})}if(t&&e.size!=null&&e.size>t)throw new ge(this.getI18n()("exceedsSize",{size:(0,Ht.default)(t),file:e.name??this.getI18n()("unnamed")}),{file:e});if(i&&e.size!=null&&e.size<i)throw new ge(this.getI18n()("inferiorSize",{size:(0,Ht.default)(i)}),{file:e})}validate(e,t){t.forEach(i=>{this.validateSingleFile(i)}),this.validateAggregateRestrictions(e,t)}validateMinNumberOfFiles(e){let{minNumberOfFiles:t}=this.getOpts().restrictions;if(t&&Object.keys(e).length<t)throw new ge(this.getI18n()("youHaveToAtLeastSelectX",{smart_count:t}))}getMissingRequiredMetaFields(e){let t=new ge(this.getI18n()("missingRequiredMetaFieldOnFile",{fileName:e.name??this.getI18n()("unnamed")})),{requiredMetaFields:i}=this.getOpts().restrictions,n=[];for(let s of i)(!Object.hasOwn(e.meta,s)||e.meta[s]==="")&&n.push(s);return{missingFields:n,error:t}}};function Xi(r){if(r==null&&typeof navigator<"u"&&(r=navigator.userAgent),!r)return!0;let e=/Edge\/(\d+\.\d+)/.exec(r);if(!e)return!0;let i=e[1].split(".",2),n=parseInt(i[0],10),s=parseInt(i[1],10);return n<15||n===15&&s<15063||n>18||n===18&&s>=18218}var Rr={totalProgress:0,allowNewUpload:!0,error:null,recoveredState:null},Yi=class r{static VERSION=ta.version;#e=Object.create(null);#t;#r;#i=(0,fa.default)();#n=new Set;#u=new Set;#o=new Set;defaultLocale;locale;opts;store;i18n;i18nArray;scheduledAutoProceed=null;wasOffline=!1;constructor(e){this.defaultLocale=ra;let t={id:"uppy",autoProceed:!1,allowMultipleUploadBatches:!0,debug:!1,restrictions:pa,meta:{},onBeforeFileAdded:(n,s)=>!Object.hasOwn(s,n.id),onBeforeUpload:n=>n,store:new Ms,logger:ia,infoTimeout:5e3},i=m(m({},t),e);this.opts=I(m({},i),{restrictions:m(m({},t.restrictions),e?.restrictions)}),e?.logger&&e.debug?this.log("You are using a custom `logger`, but also set `debug: true`, which uses built-in logger to output logs to console. Ignoring `debug: true` and using your custom `logger`.","warning"):e?.debug&&(this.opts.logger=na),this.log(`Using Core v${r.VERSION}`),this.i18nInit(),this.store=this.opts.store,this.setState(I(m({},Rr),{plugins:{},files:{},currentUploads:{},capabilities:{uploadProgress:Xi(),individualCancellation:!0,resumableUploads:!1},meta:m({},this.opts.meta),info:[]})),this.#t=new Ir(()=>this.opts,()=>this.i18n),this.#r=this.store.subscribe((n,s,o)=>{this.emit("state-update",n,s,o),this.updateAll(s)}),this.opts.debug&&typeof window<"u"&&(window[this.opts.id]=this),this.#b()}emit(e,...t){this.#i.emit(e,...t)}on(e,t){return this.#i.on(e,t),this}once(e,t){return this.#i.once(e,t),this}off(e,t){return this.#i.off(e,t),this}updateAll(e){this.iteratePlugins(t=>{t.update(e)})}setState(e){this.store.setState(e)}getState(){return this.store.getState()}patchFilesState(e){let t=this.getState().files;this.setState({files:m(m({},t),Object.fromEntries(Object.entries(e).map(([i,n])=>[i,m(m({},t[i]),n)])))})}setFileState(e,t){if(!this.getState().files[e])throw new Error(`Can\u2019t set state for ${e} (the file could have been removed)`);this.patchFilesState({[e]:t})}i18nInit(){let e=i=>this.log(`Missing i18n string: ${i}`,"error"),t=new qe([this.defaultLocale,this.opts.locale],{onMissingKey:e});this.i18n=t.translate.bind(t),this.i18nArray=t.translateArray.bind(t),this.locale=t.locale}setOptions(e){this.opts=I(m(m({},this.opts),e),{restrictions:m(m({},this.opts.restrictions),e?.restrictions)}),e.meta&&this.setMeta(e.meta),this.i18nInit(),e.locale&&this.iteratePlugins(t=>{t.setOptions(e)}),this.setState(void 0)}resetProgress(){let e={percentage:0,bytesUploaded:!1,uploadComplete:!1,uploadStarted:null},t=m({},this.getState().files),i=Object.create(null);Object.keys(t).forEach(n=>{i[n]=I(m({},t[n]),{progress:m(m({},t[n].progress),e),tus:void 0,transloadit:void 0})}),this.setState(m({files:i},Rr))}clear(){let{capabilities:e,currentUploads:t}=this.getState();if(Object.keys(t).length>0&&!e.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");this.setState(I(m({},Rr),{files:{}}))}addPreProcessor(e){this.#n.add(e)}removePreProcessor(e){return this.#n.delete(e)}addPostProcessor(e){this.#o.add(e)}removePostProcessor(e){return this.#o.delete(e)}addUploader(e){this.#u.add(e)}removeUploader(e){return this.#u.delete(e)}setMeta(e){let t=m(m({},this.getState().meta),e),i=m({},this.getState().files);Object.keys(i).forEach(n=>{i[n]=I(m({},i[n]),{meta:m(m({},i[n].meta),e)})}),this.log("Adding metadata:"),this.log(e),this.setState({meta:t,files:i})}setFileMeta(e,t){let i=m({},this.getState().files);if(!i[e]){this.log(`Was trying to set metadata for a file that has been removed: ${e}`);return}let n=m(m({},i[e].meta),t);i[e]=I(m({},i[e]),{meta:n}),this.setState({files:i})}getFile(e){return this.getState().files[e]}getFiles(){let{files:e}=this.getState();return Object.values(e)}getFilesByIds(e){return e.map(t=>this.getFile(t))}getObjectOfFilesPerState(){let{files:e,totalProgress:t,error:i}=this.getState(),n=Object.values(e),s=[],o=[],a=[],u=[],c=[],p=[],d=[],v=[],b=[];for(let x of n){let{progress:A}=x;!A.uploadComplete&&A.uploadStarted&&(s.push(x),x.isPaused||v.push(x)),A.uploadStarted||o.push(x),(A.uploadStarted||A.preprocess||A.postprocess)&&a.push(x),A.uploadStarted&&u.push(x),x.isPaused&&c.push(x),A.uploadComplete&&p.push(x),x.error&&d.push(x),(A.preprocess||A.postprocess)&&b.push(x)}return{newFiles:o,startedFiles:a,uploadStartedFiles:u,pausedFiles:c,completeFiles:p,erroredFiles:d,inProgressFiles:s,inProgressNotPausedFiles:v,processingFiles:b,isUploadStarted:u.length>0,isAllComplete:t===100&&p.length===n.length&&b.length===0,isAllErrored:!!i&&d.length===n.length,isAllPaused:s.length!==0&&c.length===s.length,isUploadInProgress:s.length>0,isSomeGhost:n.some(x=>x.isGhost)}}#a(e){for(let o of e)o.isRestriction?this.emit("restriction-failed",o.file,o):this.emit("error",o,o.file),this.log(o,"warning");let t=e.filter(o=>o.isUserFacing),i=4,n=t.slice(0,i),s=t.slice(i);n.forEach(({message:o,details:a=""})=>{this.info({message:o,details:a},"error",this.opts.infoTimeout)}),s.length>0&&this.info({message:this.i18n("additionalRestrictionsFailed",{count:s.length})})}validateRestrictions(e,t=this.getFiles()){try{this.#t.validate(t,[e])}catch(i){return i}return null}validateSingleFile(e){try{this.#t.validateSingleFile(e)}catch(t){return t.message}return null}validateAggregateRestrictions(e){let t=this.getFiles();try{this.#t.validateAggregateRestrictions(t,e)}catch(i){return i.message}return null}#s(e){let{missingFields:t,error:i}=this.#t.getMissingRequiredMetaFields(e);return t.length>0?(this.setFileState(e.id,{missingRequiredMetaFields:t,error:i.message}),this.log(i.message),this.emit("restriction-failed",e,i),!1):(t.length===0&&e.missingRequiredMetaFields&&this.setFileState(e.id,{missingRequiredMetaFields:[]}),!0)}#h(e){let t=!0;for(let i of Object.values(e))this.#s(i)||(t=!1);return t}#l(e){let{allowNewUpload:t}=this.getState();if(t===!1){let i=new ge(this.i18n("noMoreFilesAllowed"),{file:e});throw this.#a([i]),i}}checkIfFileAlreadyExists(e){let{files:t}=this.getState();return!!(t[e]&&!t[e].isGhost)}#c(e){let t=e instanceof File?{name:e.name,type:e.type,size:e.size,data:e}:e,i=rt(t),n=Ki(i,t),s=Pe(n).extension,o=Ut(t,this.getID()),a=t.meta||{};a.name=n,a.type=i;let u=Number.isFinite(t.data.size)?t.data.size:null;return{source:t.source||"",id:o,name:n,extension:s||"",meta:m(m({},this.getState().meta),a),type:i,data:t.data,progress:{percentage:0,bytesUploaded:!1,bytesTotal:u,uploadComplete:!1,uploadStarted:null},size:u,isGhost:!1,isRemote:t.isRemote||!1,remote:t.remote,preview:t.preview}}#d(){this.opts.autoProceed&&!this.scheduledAutoProceed&&(this.scheduledAutoProceed=setTimeout(()=>{this.scheduledAutoProceed=null,this.upload().catch(e=>{e.isRestriction||this.log(e.stack||e.message||e)})},4))}#p(e){let{files:t}=this.getState(),i=m({},t),n=[],s=[];for(let o of e)try{let a=this.#c(o),u=t[a.id]?.isGhost;if(u){let p=t[a.id];a=I(m({},p),{isGhost:!1,data:o.data}),this.log(`Replaced the blob in the restored ghost file: ${a.name}, ${a.id}`)}let c=this.opts.onBeforeFileAdded(a,i);if(t=this.getState().files,i=m(m({},t),i),!c&&this.checkIfFileAlreadyExists(a.id))throw new ge(this.i18n("noDuplicates",{fileName:a.name??this.i18n("unnamed")}),{file:o});if(c===!1&&!u)throw new ge("Cannot add the file because onBeforeFileAdded returned false.",{isUserFacing:!1,file:o});typeof c=="object"&&c!==null&&(a=c),this.#t.validateSingleFile(a),i[a.id]=a,n.push(a)}catch(a){s.push(a)}try{this.#t.validateAggregateRestrictions(Object.values(t),n)}catch(o){return s.push(o),{nextFilesState:t,validFilesToAdd:[],errors:s}}return{nextFilesState:i,validFilesToAdd:n,errors:s}}addFile(e){this.#l(e);let{nextFilesState:t,validFilesToAdd:i,errors:n}=this.#p([e]),s=n.filter(a=>a.isRestriction);if(this.#a(s),n.length>0)throw n[0];this.setState({files:t});let[o]=i;return this.emit("file-added",o),this.emit("files-added",i),this.log(`Added file: ${o.name}, ${o.id}, mime type: ${o.type}`),this.#d(),o.id}addFiles(e){this.#l();let{nextFilesState:t,validFilesToAdd:i,errors:n}=this.#p(e),s=n.filter(a=>a.isRestriction);this.#a(s);let o=n.filter(a=>!a.isRestriction);if(o.length>0){let a=`Multiple errors occurred while adding files:
`;if(o.forEach(u=>{a+=`
 * ${u.message}`}),this.info({message:this.i18n("addBulkFilesFailed",{smart_count:o.length}),details:a},"error",this.opts.infoTimeout),typeof AggregateError=="function")throw new AggregateError(o,a);{let u=new Error(a);throw u.errors=o,u}}this.setState({files:t}),i.forEach(a=>{this.emit("file-added",a)}),this.emit("files-added",i),i.length>5?this.log(`Added batch of ${i.length} files`):Object.values(i).forEach(a=>{this.log(`Added file: ${a.name}
 id: ${a.id}
 type: ${a.type}`)}),i.length>0&&this.#d()}removeFiles(e){let{files:t,currentUploads:i}=this.getState(),n=m({},t),s=m({},i),o=Object.create(null);e.forEach(p=>{t[p]&&(o[p]=t[p],delete n[p])});function a(p){return o[p]===void 0}Object.keys(s).forEach(p=>{let d=i[p].fileIDs.filter(a);if(d.length===0){delete s[p];return}let{capabilities:v}=this.getState();if(d.length!==i[p].fileIDs.length&&!v.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");s[p]=I(m({},i[p]),{fileIDs:d})});let u={currentUploads:s,files:n};Object.keys(n).length===0&&(u.allowNewUpload=!0,u.error=null,u.recoveredState=null),this.setState(u),this.#y();let c=Object.keys(o);c.forEach(p=>{this.emit("file-removed",o[p])}),c.length>5?this.log(`Removed ${c.length} files`):this.log(`Removed files: ${c.join(", ")}`)}removeFile(e){this.removeFiles([e])}pauseResume(e){if(!this.getState().capabilities.resumableUploads||this.getFile(e).progress.uploadComplete)return;let t=this.getFile(e),n=!(t.isPaused||!1);return this.setFileState(e,{isPaused:n}),this.emit("upload-pause",t,n),n}pauseAll(){let e=m({},this.getState().files);Object.keys(e).filter(i=>!e[i].progress.uploadComplete&&e[i].progress.uploadStarted).forEach(i=>{let n=I(m({},e[i]),{isPaused:!0});e[i]=n}),this.setState({files:e}),this.emit("pause-all")}resumeAll(){let e=m({},this.getState().files);Object.keys(e).filter(i=>!e[i].progress.uploadComplete&&e[i].progress.uploadStarted).forEach(i=>{let n=I(m({},e[i]),{isPaused:!1,error:null});e[i]=n}),this.setState({files:e}),this.emit("resume-all")}#w(){let{files:e}=this.getState();return Object.keys(e).filter(t=>{let i=e[t];return i.error&&(!i.missingRequiredMetaFields||i.missingRequiredMetaFields.length===0)})}async#_(){let e=this.#w(),t=m({},this.getState().files);if(e.forEach(n=>{t[n]=I(m({},t[n]),{isPaused:!1,error:null})}),this.setState({files:t,error:null}),this.emit("retry-all",this.getFilesByIds(e)),e.length===0)return{successful:[],failed:[]};let i=this.#m(e,{forceAllowNewUpload:!0});return this.#S(i)}async retryAll(){let e=await this.#_();return this.emit("complete",e),e}cancelAll(){this.emit("cancel-all");let{files:e}=this.getState(),t=Object.keys(e);t.length&&this.removeFiles(t),this.setState(Rr)}retryUpload(e){this.setFileState(e,{error:null,isPaused:!1}),this.emit("upload-retry",this.getFile(e));let t=this.#m([e],{forceAllowNewUpload:!0});return this.#S(t)}logout(){this.iteratePlugins(e=>{e.provider?.logout?.()})}#F=(e,t)=>{let i=e?this.getFile(e.id):void 0;if(e==null||!i){this.log(`Not setting progress for a file that has been removed: ${e?.id}`);return}if(i.progress.percentage===100){this.log(`Not setting progress for a file that has been already uploaded: ${e.id}`);return}let n={bytesTotal:t.bytesTotal,percentage:t.bytesTotal!=null&&Number.isFinite(t.bytesTotal)&&t.bytesTotal>0?Math.round(t.bytesUploaded/t.bytesTotal*100):void 0};i.progress.uploadStarted!=null?this.setFileState(e.id,{progress:I(m(m({},i.progress),n),{bytesUploaded:t.bytesUploaded})}):this.setFileState(e.id,{progress:m(m({},i.progress),n)}),this.#y()};#x(){let e=this.#P(),t=null;e!=null&&(t=Math.round(e*100),t>100?t=100:t<0&&(t=0)),this.emit("progress",t??0),this.setState({totalProgress:t??0})}#y=(0,ha.default)(()=>this.#x(),500,{leading:!0,trailing:!0});[Symbol.for("uppy test: updateTotalProgress")](){return this.#x()}#P(){let t=this.getFiles().filter(u=>u.progress.uploadStarted||u.progress.preprocess||u.progress.postprocess);if(t.length===0)return 0;if(t.every(u=>u.progress.uploadComplete))return 1;let i=u=>u.progress.bytesTotal!=null&&u.progress.bytesTotal!==0,n=t.filter(i),s=t.filter(u=>!i(u));if(n.every(u=>u.progress.uploadComplete)&&s.length>0&&!s.every(u=>u.progress.uploadComplete))return null;let o=n.reduce((u,c)=>u+(c.progress.bytesTotal??0),0),a=n.reduce((u,c)=>u+(c.progress.bytesUploaded||0),0);return o===0?0:a/o}#b(){let e=(n,s,o)=>{let a=n.message||"Unknown error";n.details&&(a+=` ${n.details}`),this.setState({error:a}),s!=null&&s.id in this.getState().files&&this.setFileState(s.id,{error:a,response:o})};this.on("error",e),this.on("upload-error",(n,s,o)=>{if(e(s,n,o),typeof s=="object"&&s.message){this.log(s.message,"error");let a=new Error(this.i18n("failedToUpload",{file:n?.name??""}));a.isUserFacing=!0,a.details=s.message,s.details&&(a.details+=` ${s.details}`),this.#a([a])}else this.#a([s])});let t=null;this.on("upload-stalled",(n,s)=>{let{message:o}=n,a=s.map(u=>u.meta.name).join(", ");t||(this.info({message:o,details:a},"warning",this.opts.infoTimeout),t=setTimeout(()=>{t=null},this.opts.infoTimeout)),this.log(`${o} ${a}`.trim(),"warning")}),this.on("upload",()=>{this.setState({error:null})});let i=n=>{let s=n.filter(a=>{let u=a!=null&&this.getFile(a.id);return u||this.log(`Not setting progress for a file that has been removed: ${a?.id}`),u}),o=Object.fromEntries(s.map(a=>[a.id,{progress:{uploadStarted:Date.now(),uploadComplete:!1,bytesUploaded:0,bytesTotal:a.size}}]));this.patchFilesState(o)};this.on("upload-start",i),this.on("upload-progress",this.#F),this.on("upload-success",(n,s)=>{if(n==null||!this.getFile(n.id)){this.log(`Not setting progress for a file that has been removed: ${n?.id}`);return}let o=this.getFile(n.id).progress;this.setFileState(n.id,{progress:I(m({},o),{postprocess:this.#o.size>0?{mode:"indeterminate"}:void 0,uploadComplete:!0,percentage:100,bytesUploaded:o.bytesTotal}),response:s,uploadURL:s.uploadURL,isPaused:!1}),n.size==null&&this.setFileState(n.id,{size:s.bytesUploaded||o.bytesTotal}),this.#y()}),this.on("preprocess-progress",(n,s)=>{if(n==null||!this.getFile(n.id)){this.log(`Not setting progress for a file that has been removed: ${n?.id}`);return}this.setFileState(n.id,{progress:I(m({},this.getFile(n.id).progress),{preprocess:s})})}),this.on("preprocess-complete",n=>{if(n==null||!this.getFile(n.id)){this.log(`Not setting progress for a file that has been removed: ${n?.id}`);return}let s=m({},this.getState().files);s[n.id]=I(m({},s[n.id]),{progress:m({},s[n.id].progress)}),delete s[n.id].progress.preprocess,this.setState({files:s})}),this.on("postprocess-progress",(n,s)=>{if(n==null||!this.getFile(n.id)){this.log(`Not setting progress for a file that has been removed: ${n?.id}`);return}this.setFileState(n.id,{progress:I(m({},this.getState().files[n.id].progress),{postprocess:s})})}),this.on("postprocess-complete",n=>{if(n==null||!this.getFile(n.id)){this.log(`Not setting progress for a file that has been removed: ${n?.id}`);return}let s=m({},this.getState().files);s[n.id]=I(m({},s[n.id]),{progress:m({},s[n.id].progress)}),delete s[n.id].progress.postprocess,this.setState({files:s})}),this.on("restored",()=>{this.#y()}),this.on("dashboard:file-edit-complete",n=>{n&&this.#s(n)}),typeof window<"u"&&window.addEventListener&&(window.addEventListener("online",this.#f),window.addEventListener("offline",this.#f),setTimeout(this.#f,3e3))}updateOnlineStatus(){window.navigator.onLine??!0?(this.emit("is-online"),this.wasOffline&&(this.emit("back-online"),this.info(this.i18n("connectedToInternet"),"success",3e3),this.wasOffline=!1)):(this.emit("is-offline"),this.info(this.i18n("noInternetConnection"),"error",0),this.wasOffline=!0)}#f=this.updateOnlineStatus.bind(this);getID(){return this.opts.id}use(e,...t){if(typeof e!="function"){let o=`Expected a plugin class, but got ${e===null?"null":typeof e}. Please verify that the plugin was imported and spelled correctly.`;throw new TypeError(o)}let i=new e(this,...t),n=i.id;if(!n)throw new Error("Your plugin must have an id");if(!i.type)throw new Error("Your plugin must have a type");let s=this.getPlugin(n);if(s){let o=`Already found a plugin named '${s.id}'. Tried to use: '${n}'.
Uppy plugins must have unique \`id\` options.`;throw new Error(o)}return e.VERSION&&this.log(`Using ${n} v${e.VERSION}`),i.type in this.#e?this.#e[i.type].push(i):this.#e[i.type]=[i],i.install(),this.emit("plugin-added",i),this}getPlugin(e){for(let t of Object.values(this.#e)){let i=t.find(n=>n.id===e);if(i!=null)return i}}[Symbol.for("uppy test: getPlugins")](e){return this.#e[e]}iteratePlugins(e){Object.values(this.#e).flat(1).forEach(e)}removePlugin(e){this.log(`Removing plugin ${e.id}`),this.emit("plugin-remove",e),e.uninstall&&e.uninstall();let t=this.#e[e.type],i=t.findIndex(o=>o.id===e.id);i!==-1&&t.splice(i,1);let n=this.getState(),s={plugins:I(m({},n.plugins),{[e.id]:void 0})};this.setState(s)}destroy(){this.log(`Closing Uppy instance ${this.opts.id}: removing all files and uninstalling plugins`),this.cancelAll(),this.#r(),this.iteratePlugins(e=>{this.removePlugin(e)}),typeof window<"u"&&window.removeEventListener&&(window.removeEventListener("online",this.#f),window.removeEventListener("offline",this.#f))}hideInfo(){let{info:e}=this.getState();this.setState({info:e.slice(1)}),this.emit("info-hidden")}info(e,t="info",i=3e3){let n=typeof e=="object";this.setState({info:[...this.getState().info,{type:t,message:n?e.message:e,details:n?e.details:null}]}),setTimeout(()=>this.hideInfo(),i),this.emit("info-visible")}log(e,t){let{logger:i}=this.opts;switch(t){case"error":i.error(e);break;case"warning":i.warn(e);break;default:i.debug(e);break}}#v=new Map;registerRequestClient(e,t){this.#v.set(e,t)}getRequestClientForFile(e){if(!e.remote)throw new Error(`Tried to get RequestClient for a non-remote file ${e.id}`);let t=this.#v.get(e.remote.requestClientId);if(t==null)throw new Error(`requestClientId "${e.remote.requestClientId}" not registered for file "${e.id}"`);return t}async restore(e){if(this.log(`Core: attempting to restore upload "${e}"`),!this.getState().currentUploads[e])throw this.#g(e),new Error("Nonexistent upload");let t=await this.#S(e);return this.emit("complete",t),t}#m(e,t={}){let{forceAllowNewUpload:i=!1}=t,{allowNewUpload:n,currentUploads:s}=this.getState();if(!n&&!i)throw new Error("Cannot create a new upload: already uploading.");let o=De();return this.emit("upload",o,this.getFilesByIds(e)),this.setState({allowNewUpload:this.opts.allowMultipleUploadBatches!==!1&&this.opts.allowMultipleUploads!==!1,currentUploads:I(m({},s),{[o]:{fileIDs:e,step:0,result:{}}})}),o}[Symbol.for("uppy test: createUpload")](...e){return this.#m(...e)}#E(e){let{currentUploads:t}=this.getState();return t[e]}addResultData(e,t){if(!this.#E(e)){this.log(`Not setting result for an upload that has been removed: ${e}`);return}let{currentUploads:i}=this.getState(),n=I(m({},i[e]),{result:m(m({},i[e].result),t)});this.setState({currentUploads:I(m({},i),{[e]:n})})}#g(e){let t=m({},this.getState().currentUploads);delete t[e],this.setState({currentUploads:t})}async#S(e){let t=()=>{let{currentUploads:o}=this.getState();return o[e]},i=t(),n=[...this.#n,...this.#u,...this.#o];try{for(let o=i.step||0;o<n.length&&i;o++){let a=n[o];this.setState({currentUploads:I(m({},this.getState().currentUploads),{[e]:I(m({},i),{step:o})})});let{fileIDs:u}=i;await a(u,e),i=t()}}catch(o){throw this.#g(e),o}if(i){i.fileIDs.forEach(c=>{let p=this.getFile(c);p?.progress.postprocess&&this.emit("postprocess-complete",p)});let o=i.fileIDs.map(c=>this.getFile(c)),a=o.filter(c=>!c.error),u=o.filter(c=>c.error);this.addResultData(e,{successful:a,failed:u,uploadID:e}),i=t()}let s;return i&&(s=i.result,this.#g(e)),s==null&&(this.log(`Not setting result for an upload that has been removed: ${e}`),s={successful:[],failed:[],uploadID:e}),s}async upload(){this.#e.uploader?.length||this.log("No uploader type plugins are used","warning");let{files:e}=this.getState();if(this.#w().length>0){let n=await this.#_();if(!(this.getFiles().filter(o=>o.progress.uploadStarted==null).length>0))return this.emit("complete",n),n;({files:e}=this.getState())}let i=this.opts.onBeforeUpload(e);return i===!1?Promise.reject(new Error("Not starting the upload because onBeforeUpload returned false")):(i&&typeof i=="object"&&(e=i,this.setState({files:e})),Promise.resolve().then(()=>this.#t.validateMinNumberOfFiles(e)).catch(n=>{throw this.#a([n]),n}).then(()=>{if(!this.#h(e))throw new ge(this.i18n("missingRequiredMetaField"))}).catch(n=>{throw n}).then(async()=>{let{currentUploads:n}=this.getState(),s=Object.values(n).flatMap(c=>c.fileIDs),o=[];Object.keys(e).forEach(c=>{let p=this.getFile(c);!p.progress.uploadStarted&&s.indexOf(c)===-1&&o.push(p.id)});let a=this.#m(o),u=await this.#S(a);return this.emit("complete",u),u}).catch(n=>{throw this.emit("error",n),this.log(n,"error"),n}))}},ma=Yi;var Ne=class{uppy;opts;id;defaultLocale;i18n;i18nArray;type;VERSION;constructor(e,t){this.uppy=e,this.opts=t??{}}getPluginState(){let{plugins:e}=this.uppy.getState();return e?.[this.id]||{}}setPluginState(e){let{plugins:t}=this.uppy.getState();this.uppy.setState({plugins:I(m({},t),{[this.id]:m(m({},t[this.id]),e)})})}setOptions(e){this.opts=m(m({},this.opts),e),this.setPluginState(void 0),this.i18nInit()}i18nInit(){let e=new qe([this.defaultLocale,this.uppy.locale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.setPluginState(void 0)}addTarget(e){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")}install(){}uninstall(){}update(e){}afterUpdate(){}};var $t=class{#e;#t=[];constructor(e){this.#e=e}on(e,t){return this.#t.push([e,t]),this.#e.on(e,t)}remove(){for(let[e,t]of this.#t.splice(0))this.#e.off(e,t)}onFilePause(e,t){this.on("upload-pause",(i,n)=>{e===i?.id&&t(n)})}onFileRemove(e,t){this.on("file-removed",i=>{e===i.id&&t(i.id)})}onPause(e,t){this.on("upload-pause",(i,n)=>{e===i?.id&&t(n)})}onRetry(e,t){this.on("upload-retry",i=>{e===i?.id&&t()})}onRetryAll(e,t){this.on("retry-all",()=>{this.#e.getFile(e)&&t()})}onPauseAll(e,t){this.on("pause-all",()=>{this.#e.getFile(e)&&t()})}onCancelAll(e,t){this.on("cancel-all",(...i)=>{this.#e.getFile(e)&&t(...i)})}onResumeAll(e,t){this.on("resume-all",()=>{this.#e.getFile(e)&&t()})}};function Lc(r){let e=null,t;return(...i)=>(t=i,e||(e=Promise.resolve().then(()=>(e=null,r(...t)))),e)}var Qi=class r extends Ne{#e;isTargetDOMEl;el;parent;title;getTargetPlugin(e){let t;if(typeof e?.addTarget=="function")t=e,t instanceof r||console.warn(new Error("The provided plugin is not an instance of UIPlugin. This is an indication of a bug with the way Uppy is bundled.",{cause:{targetPlugin:t,UIPlugin:r}}));else if(typeof e=="function"){let i=e;this.uppy.iteratePlugins(n=>{n instanceof i&&(t=n)})}return t}mount(e,t){let i=t.id,n=Fi(e);if(n){this.isTargetDOMEl=!0;let a=document.createElement("div");return a.classList.add("uppy-Root"),this.#e=Lc(u=>{this.uppy.getPlugin(this.id)&&(Mi(this.render(u,a),a),this.afterUpdate())}),this.uppy.log(`Installing ${i} to a DOM element '${e}'`),this.opts.replaceTargetContent&&(n.innerHTML=""),Mi(this.render(this.uppy.getState(),a),a),this.el=a,n.appendChild(a),a.dir=this.opts.direction||Ci(a)||"ltr",this.onMount(),this.el}let s=this.getTargetPlugin(e);if(s)return this.uppy.log(`Installing ${i} to ${s.id}`),this.parent=s,this.el=s.addTarget(t),this.onMount(),this.el;this.uppy.log(`Not installing ${i}`);let o=`Invalid target option given to ${i}.`;throw typeof e=="function"?o+=" The given target is not a Plugin class. Please check that you're not specifying a React Component instead of a plugin. If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.":o+="If you meant to target an HTML element, please make sure that the element exists. Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. (see https://github.com/transloadit/uppy/issues/1042)\n\nIf you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.",new Error(o)}render(e,t){throw new Error("Extend the render method to add your plugin to a DOM element")}update(e){this.el!=null&&this.#e?.(e)}unmount(){this.isTargetDOMEl&&this.el?.remove(),this.onUnmount()}onMount(){}onUnmount(){}},Vt=Qi;var en=Y(qt(),1);var va=Y(ga(),1);var ya={strings:{compressingImages:"Compressing images...",compressedX:"Saved %{size} by compressing images"}};var jc={quality:.6,limit:10},ba=class extends Ne{#e;constructor(e,t){super(e,m(m({},jc),t)),this.id=this.opts.id||"Compressor",this.type="modifier",this.defaultLocale=ya,this.#e=new ze(this.opts.limit),this.i18nInit(),this.prepareUpload=this.prepareUpload.bind(this),this.compress=this.compress.bind(this)}compress(e){return new Promise((t,i)=>{new va.default(e,I(m({},this.opts),{success:t,error:i}))})}async prepareUpload(e){let t=0,i=[],n=this.#e.wrapPromiseFunction(async o=>{try{let a=await this.compress(o.data),u=o.data.size-a.size;this.uppy.log(`[Image Compressor] Image ${o.id} compressed by ${(0,en.default)(u)}`),t+=u;let{name:c,type:p,size:d}=a,v=Pe(c),x=`${Pe(o.meta.name).name}.${v.extension}`;this.uppy.setFileState(o.id,I(m(m(m(m({},c&&{name:c}),v.extension&&{extension:v.extension}),p&&{type:p}),d&&{size:d}),{data:a,meta:I(m({},o.meta),{type:p,name:x})})),i.push(o)}catch(a){this.uppy.log(`[Image Compressor] Failed to compress ${o.id}:`,"warning"),this.uppy.log(a,"warning")}}),s=e.map(o=>{let a=this.uppy.getFile(o);return this.uppy.emit("preprocess-progress",a,{mode:"indeterminate",message:this.i18n("compressingImages")}),a.isRemote||(a.data.type||(a.data=a.data.slice(0,a.data.size,a.type)),!a.type?.startsWith("image/"))?Promise.resolve():n(a)});await Promise.all(s),this.uppy.emit("compressor:complete",i),t>1024&&this.uppy.info(this.i18n("compressedX",{size:(0,en.default)(t)}),"info");for(let o of e){let a=this.uppy.getFile(o);this.uppy.emit("preprocess-complete",a)}}install(){this.uppy.addPreProcessor(this.prepareUpload)}uninstall(){this.uppy.removePreProcessor(this.prepareUpload)}};function H(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}var ka=typeof self<"u"?self:global,Xt=typeof navigator<"u",Mc=Xt&&typeof HTMLImageElement>"u",wa=!(typeof global>"u"||typeof process>"u"||!process.versions||!process.versions.node),Ca=ka.Buffer,Ua=!!Ca,zc=r=>r!==void 0;function Aa(r){return r===void 0||(r instanceof Map?r.size===0:Object.values(r).filter(zc).length===0)}function ne(r){let e=new Error(r);throw delete e.stack,e}function _a(r){let e=(function(t){let i=0;return t.ifd0.enabled&&(i+=1024),t.exif.enabled&&(i+=2048),t.makerNote&&(i+=2048),t.userComment&&(i+=1024),t.gps.enabled&&(i+=512),t.interop.enabled&&(i+=100),t.ifd1.enabled&&(i+=1024),i+2048})(r);return r.jfif.enabled&&(e+=50),r.xmp.enabled&&(e+=2e4),r.iptc.enabled&&(e+=14e3),r.icc.enabled&&(e+=6e3),e}var tn=r=>String.fromCharCode.apply(null,r),xa=typeof TextDecoder<"u"?new TextDecoder("utf-8"):void 0,We=class r{static from(e,t){return e instanceof this&&e.le===t?e:new r(e,void 0,void 0,t)}constructor(e,t=0,i,n){if(typeof n=="boolean"&&(this.le=n),Array.isArray(e)&&(e=new Uint8Array(e)),e===0)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){i===void 0&&(i=e.byteLength-t);let s=new DataView(e,t,i);this._swapDataView(s)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof r){i===void 0&&(i=e.byteLength-t),(t+=e.byteOffset)+i>e.byteOffset+e.byteLength&&ne("Creating view outside of available memory in ArrayBuffer");let s=new DataView(e.buffer,t,i);this._swapDataView(s)}else if(typeof e=="number"){let s=new DataView(new ArrayBuffer(e));this._swapDataView(s)}else ne("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,i=r){return e instanceof DataView||e instanceof r?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||ne("BufferView.set(): Invalid data argument."),this.toUint8().set(e,t),new i(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new r(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return n=this.getUint8Array(e,t),xa?xa.decode(n):Ua?Buffer.from(n).toString("utf8"):decodeURIComponent(escape(tn(n)));var n}getLatin1String(e=0,t=this.byteLength){let i=this.getUint8Array(e,t);return tn(i)}getUnicodeString(e=0,t=this.byteLength){let i=[];for(let n=0;n<t&&e+n<this.byteLength;n+=2)i.push(this.getUint16(e+n));return tn(i)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,i){switch(t){case 1:return this.getUint8(e,i);case 2:return this.getUint16(e,i);case 4:return this.getUint32(e,i);case 8:return this.getUint64&&this.getUint64(e,i)}}getUint(e,t,i){switch(t){case 8:return this.getUint8(e,i);case 16:return this.getUint16(e,i);case 32:return this.getUint32(e,i);case 64:return this.getUint64&&this.getUint64(e,i)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}};function nn(r,e){ne(`${r} '${e}' was not loaded, try using full build of exifr.`)}var Yt=class extends Map{constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||nn(this.kind,e),t&&(e in t||(function(i,n){ne(`Unknown ${i} '${n}'.`)})(this.kind,e),t[e].enabled||nn(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}},jr=new Yt("file parser"),_e=new Yt("segment parser"),Zt=new Yt("file reader"),qc=ka.fetch;function Sa(r,e){return(t=r).startsWith("data:")||t.length>1e4?on(r,e,"base64"):wa&&r.includes("://")?sn(r,e,"url",Nr):wa?on(r,e,"fs"):Xt?sn(r,e,"url",Nr):void ne("Invalid input argument");var t}async function sn(r,e,t,i){return Zt.has(t)?on(r,e,t):i?(async function(n,s){let o=await s(n);return new We(o)})(r,i):void ne(`Parser ${t} is not loaded`)}async function on(r,e,t){let i=new(Zt.get(t))(r,e);return await i.read(),i}var Nr=r=>qc(r).then(e=>e.arrayBuffer()),Qt=r=>new Promise((e,t)=>{let i=new FileReader;i.onloadend=()=>e(i.result||new ArrayBuffer),i.onerror=t,i.readAsArrayBuffer(r)}),an=class extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}};function Oa(r,e,t){let i=new an;for(let[n,s]of t)i.set(n,s);if(Array.isArray(e))for(let n of e)r.set(n,i);else r.set(e,i);return i}function Ia(r,e,t){let i,n=r.get(e);for(i of t)n.set(i[0],i[1])}var er=new Map,pn=new Map,hn=new Map,st=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],Mr=["jfif","xmp","icc","iptc","ihdr"],Jt=["tiff",...Mr],te=["ifd0","ifd1","exif","gps","interop"],ot=[...Jt,...te],at=["makerNote","userComment"],zr=["translateKeys","translateValues","reviveValues","multiSegment"],lt=[...zr,"sanitize","mergeOutput","silentErrors"],Br=class{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}},Ve=class extends Br{get needed(){return this.enabled||this.deps.size>0}constructor(e,t,i,n){if(super(),H(this,"enabled",!1),H(this,"skip",new Set),H(this,"pick",new Set),H(this,"deps",new Set),H(this,"translateKeys",!1),H(this,"translateValues",!1),H(this,"reviveValues",!1),this.key=e,this.enabled=t,this.parse=this.enabled,this.applyInheritables(n),this.canBeFiltered=te.includes(e),this.canBeFiltered&&(this.dict=er.get(e)),i!==void 0)if(Array.isArray(i))this.parse=this.enabled=!0,this.canBeFiltered&&i.length>0&&this.translateTagSet(i,this.pick);else if(typeof i=="object"){if(this.enabled=!0,this.parse=i.parse!==!1,this.canBeFiltered){let{pick:s,skip:o}=i;s&&s.length>0&&this.translateTagSet(s,this.pick),o&&o.length>0&&this.translateTagSet(o,this.skip)}this.applyInheritables(i)}else i===!0||i===!1?this.parse=this.enabled=i:ne(`Invalid options argument: ${i}`)}applyInheritables(e){let t,i;for(t of zr)i=e[t],i!==void 0&&(this[t]=i)}translateTagSet(e,t){if(this.dict){let i,n,{tagKeys:s,tagValues:o}=this.dict;for(i of e)typeof i=="string"?(n=o.indexOf(i),n===-1&&(n=s.indexOf(Number(i))),n!==-1&&t.add(Number(s[n]))):t.add(i)}else for(let i of e)t.add(i)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,Dr(this.pick,this.deps)):this.enabled&&this.pick.size>0&&Dr(this.pick,this.deps)}},fe={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},Fa=new Map,Ge=class extends Br{static useCached(e){let t=Fa.get(e);return t!==void 0||(t=new this(e),Fa.set(e,t)),t}constructor(e){super(),e===!0?this.setupFromTrue():e===void 0?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):typeof e=="object"?this.setupFromObject(e):ne(`Invalid options argument ${e}`),this.firstChunkSize===void 0&&(this.firstChunkSize=Xt?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of st)this[e]=fe[e];for(e of lt)this[e]=fe[e];for(e of at)this[e]=fe[e];for(e of ot)this[e]=new Ve(e,fe[e],void 0,this)}setupFromTrue(){let e;for(e of st)this[e]=fe[e];for(e of lt)this[e]=fe[e];for(e of at)this[e]=!0;for(e of ot)this[e]=new Ve(e,!0,void 0,this)}setupFromArray(e){let t;for(t of st)this[t]=fe[t];for(t of lt)this[t]=fe[t];for(t of at)this[t]=fe[t];for(t of ot)this[t]=new Ve(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,te)}setupFromObject(e){let t;for(t of(te.ifd0=te.ifd0||te.image,te.ifd1=te.ifd1||te.thumbnail,Object.assign(this,e),st))this[t]=rn(e[t],fe[t]);for(t of lt)this[t]=rn(e[t],fe[t]);for(t of at)this[t]=rn(e[t],fe[t]);for(t of Jt)this[t]=new Ve(t,fe[t],e[t],this);for(t of te)this[t]=new Ve(t,fe[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,te,ot),e.tiff===!0?this.batchEnableWithBool(te,!0):e.tiff===!1?this.batchEnableWithUserValue(te,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,te):typeof e.tiff=="object"&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,te)}batchEnableWithBool(e,t){for(let i of e)this[i].enabled=t}batchEnableWithUserValue(e,t){for(let i of e){let n=t[i];this[i].enabled=n!==!1&&n!==void 0}}setupGlobalFilters(e,t,i,n=i){if(e&&e.length){for(let o of n)this[o].enabled=!1;let s=Pa(e,i);for(let[o,a]of s)Dr(this[o].pick,a),this[o].enabled=!0}else if(t&&t.length){let s=Pa(t,i);for(let[o,a]of s)Dr(this[o].skip,a)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:i,iptc:n,icc:s}=this;this.makerNote?t.deps.add(37500):t.skip.add(37500),this.userComment?t.deps.add(37510):t.skip.add(37510),i.enabled||e.skip.add(700),n.enabled||e.skip.add(33723),s.enabled||e.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:i,interop:n}=this;n.needed&&(t.deps.add(40965),e.deps.add(40965)),t.needed&&e.deps.add(34665),i.needed&&e.deps.add(34853),this.tiff.enabled=te.some(s=>this[s].enabled===!0)||this.makerNote||this.userComment;for(let s of te)this[s].finalizeFilters()}get onlyTiff(){return!Mr.map(e=>this[e].enabled).some(e=>e===!0)&&this.tiff.enabled}checkLoadedPlugins(){for(let e of Jt)this[e].enabled&&!_e.has(e)&&nn("segment parser",e)}};function Pa(r,e){let t,i,n,s,o=[];for(n of e){for(s of(t=er.get(n),i=[],t))(r.includes(s[0])||r.includes(s[1]))&&i.push(s[0]);i.length&&o.push([n,i])}return o}function rn(r,e){return r!==void 0?r:e!==void 0?e:void 0}function Dr(r,e){for(let t of e)r.add(t)}H(Ge,"default",fe);var ut=class{constructor(e){H(this,"parsers",{}),H(this,"output",{}),H(this,"errors",[]),H(this,"pushToErrors",t=>this.errors.push(t)),this.options=Ge.useCached(e)}async read(e){this.file=await(function(t,i){return typeof t=="string"?Sa(t,i):Xt&&!Mc&&t instanceof HTMLImageElement?Sa(t.src,i):t instanceof Uint8Array||t instanceof ArrayBuffer||t instanceof DataView?new We(t):Xt&&t instanceof Blob?sn(t,i,"blob",Qt):void ne("Invalid input argument")})(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,t=e.getUint16(0);for(let[i,n]of jr)if(n.canHandle(e,t))return this.fileParser=new n(this.options,this.file,this.parsers),e[i]=!0;this.file.close&&this.file.close(),ne("Unknown file format")}async parse(){let{output:e,errors:t}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),t.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&t.length>0&&(e.errors=t),Aa(i=e)?void 0:i;var i}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let t=Object.values(this.parsers).map(async i=>{let n=await i.parse();i.assignToOutput(e,n)});this.options.silentErrors&&(t=t.map(i=>i.catch(this.pushToErrors))),await Promise.all(t)}async extractThumbnail(){this.setup();let{options:e,file:t}=this,i=_e.get("tiff",e);var n;if(t.tiff?n={start:0,type:"tiff"}:t.jpeg&&(n=await this.fileParser.getOrFindSegment("tiff")),n===void 0)return;let s=await this.fileParser.ensureSegmentChunk(n),o=this.parsers.tiff=new i(s,e,t),a=await o.extractThumbnail();return t.close&&t.close(),a}};async function Ra(r,e){let t=new ut(e);return await t.read(r),t.parse()}var Hc=Object.freeze({__proto__:null,parse:Ra,Exifr:ut,fileParsers:jr,segmentParsers:_e,fileReaders:Zt,tagKeys:er,tagValues:pn,tagRevivers:hn,createDictionary:Oa,extendDictionary:Ia,fetchUrlAsArrayBuffer:Nr,readBlobAsArrayBuffer:Qt,chunkedProps:st,otherSegments:Mr,segments:Jt,tiffBlocks:te,segmentsAndBlocks:ot,tiffExtractables:at,inheritables:zr,allFormatters:lt,Options:Ge}),Le=class{static findPosition(e,t){let i=e.getUint16(t+2)+2,n=typeof this.headerLength=="function"?this.headerLength(e,t,i):this.headerLength,s=t+n,o=i-n;return{offset:t,length:i,headerLength:n,start:s,size:o,end:s+o}}static parse(e,t={}){return new this(e,new Ge({[this.type]:t}),e).parse()}normalizeInput(e){return e instanceof We?e:new We(e)}constructor(e,t={},i){H(this,"errors",[]),H(this,"raw",new Map),H(this,"handleError",n=>{if(!this.options.silentErrors)throw n;this.errors.push(n.message)}),this.chunk=this.normalizeInput(e),this.file=i,this.type=this.constructor.type,this.globalOptions=this.options=t,this.localOptions=t[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let i=hn.get(t),n=pn.get(t),s=er.get(t),o=this.options[t],a=o.reviveValues&&!!i,u=o.translateValues&&!!n,c=o.translateKeys&&!!s,p={};for(let[d,v]of e)a&&i.has(d)?v=i.get(d)(v):u&&n.has(d)&&(v=this.translateValue(v,n.get(d))),c&&s.has(d)&&(d=s.get(d)||d),p[d]=v;return p}translateValue(e,t){return t[e]||t.DEFAULT||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,i){if(this.globalOptions.mergeOutput)return Object.assign(e,i);e[t]?Object.assign(e[t],i):e[t]=i}};H(Le,"headerLength",4),H(Le,"type",void 0),H(Le,"multiSegment",!1),H(Le,"canHandle",()=>!1);function $c(r){return r===192||r===194||r===196||r===219||r===221||r===218||r===254}function Vc(r){return r>=224&&r<=239}function Wc(r,e,t){for(let[i,n]of _e)if(n.canHandle(r,e,t))return i}var Lr=class extends class{constructor(e,t,i){H(this,"errors",[]),H(this,"ensureSegmentChunk",async n=>{let s=n.start,o=n.size||65536;if(this.file.chunked)if(this.file.available(s,o))n.chunk=this.file.subarray(s,o);else try{n.chunk=await this.file.readChunk(s,o)}catch(a){ne(`Couldn't read segment: ${JSON.stringify(n)}. ${a.message}`)}else this.file.byteLength>s+o?n.chunk=this.file.subarray(s,o):n.size===void 0?n.chunk=this.file.subarray(s):ne("Segment unreachable: "+JSON.stringify(n));return n.chunk}),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=t,this.parsers=i}injectSegment(e,t){this.options[e].enabled&&this.createParser(e,t)}createParser(e,t){let i=new(_e.get(e))(t,this.options,this.file);return this.parsers[e]=i}createParsers(e){for(let t of e){let{type:i,chunk:n}=t,s=this.options[i];if(s&&s.enabled){let o=this.parsers[i];o&&o.append||o||this.createParser(i,n)}}}async readSegments(e){let t=e.map(this.ensureSegmentChunk);await Promise.all(t)}}{constructor(...e){super(...e),H(this,"appSegments",[]),H(this,"jpegSegments",[]),H(this,"unknownSegments",[])}static canHandle(e,t){return t===65496}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){e===!0?(this.findAll=!0,this.wanted=new Set(_e.keyList())):(e=e===void 0?_e.keyList().filter(t=>this.options[t].enabled):e.filter(t=>this.options[t].enabled&&_e.has(t)),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:i,findAll:n,wanted:s,remaining:o}=this;if(!n&&this.file.chunked&&(n=Array.from(s).some(a=>{let u=_e.get(a),c=this.options[a];return u.multiSegment&&c.multiSegment}),n&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,i.byteLength),!this.options.onlyTiff&&i.chunked){let a=!1;for(;o.size>0&&!a&&(i.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:u}=i,c=this.appSegments.some(p=>!this.file.available(p.offset||p.start,p.length||p.size));if(a=e>u&&!c?!await i.readNextChunk(e):!await i.readNextChunk(u),(e=this.findAppSegmentsInRange(e,i.byteLength))===void 0)return}}}findAppSegmentsInRange(e,t){t-=2;let i,n,s,o,a,u,{file:c,findAll:p,wanted:d,remaining:v,options:b}=this;for(;e<t;e++)if(c.getUint8(e)===255){if(i=c.getUint8(e+1),Vc(i)){if(n=c.getUint16(e+2),s=Wc(c,e,n),s&&d.has(s)&&(o=_e.get(s),a=o.findPosition(c,e),u=b[s],a.type=s,this.appSegments.push(a),!p&&(o.multiSegment&&u.multiSegment?(this.unfinishedMultiSegment=a.chunkNumber<a.chunkCount,this.unfinishedMultiSegment||v.delete(s)):v.delete(s),v.size===0)))break;b.recordUnknownSegments&&(a=Le.findPosition(c,e),a.marker=i,this.unknownSegments.push(a)),e+=n+1}else if($c(i)){if(n=c.getUint16(e+2),i===218&&b.stopAfterSos!==!1)return;b.recordJpegSegments&&this.jpegSegments.push({offset:e,length:n,marker:i}),e+=n+1}}return e}mergeMultiSegments(){if(!this.appSegments.some(t=>t.multiSegment))return;let e=(function(t,i){let n,s,o,a=new Map;for(let u=0;u<t.length;u++)n=t[u],s=n[i],a.has(s)?o=a.get(s):a.set(s,o=[]),o.push(n);return Array.from(a)})(this.appSegments,"type");this.mergedAppSegments=e.map(([t,i])=>{let n=_e.get(t,this.options);return n.handleMultiSegments?{type:t,chunk:n.handleMultiSegments(i)}:i[0]})}getSegment(e){return this.appSegments.find(t=>t.type===e)}async getOrFindSegment(e){let t=this.getSegment(e);return t===void 0&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}};H(Lr,"type","jpeg"),jr.set("jpeg",Lr);var Gc=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4],ln=class extends Le{parseHeader(){var e=this.chunk.getUint16();e===18761?this.le=!0:e===19789&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,i=new Map){let{pick:n,skip:s}=this.options[t];n=new Set(n);let o=n.size>0,a=s.size===0,u=this.chunk.getUint16(e);e+=2;for(let c=0;c<u;c++){let p=this.chunk.getUint16(e);if(o){if(n.has(p)&&(i.set(p,this.parseTag(e,p,t)),n.delete(p),n.size===0))break}else!a&&s.has(p)||i.set(p,this.parseTag(e,p,t));e+=12}return i}parseTag(e,t,i){let{chunk:n}=this,s=n.getUint16(e+2),o=n.getUint32(e+4),a=Gc[s];if(a*o<=4?e+=8:e=n.getUint32(e+8),(s<1||s>13)&&ne(`Invalid TIFF value type. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${s}, offset ${e}`),e>n.byteLength&&ne(`Invalid TIFF value offset. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${s}, offset ${e} is outside of chunk size ${n.byteLength}`),s===1)return n.getUint8Array(e,o);if(s===2)return(u=(function(c){for(;c.endsWith("\0");)c=c.slice(0,-1);return c})(u=n.getString(e,o)).trim())===""?void 0:u;var u;if(s===7)return n.getUint8Array(e,o);if(o===1)return this.parseTagValue(s,e);{let c=new((function(d){switch(d){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}})(s))(o),p=a;for(let d=0;d<o;d++)c[d]=this.parseTagValue(s,e),e+=p;return c}}parseTagValue(e,t){let{chunk:i}=this;switch(e){case 1:return i.getUint8(t);case 3:return i.getUint16(t);case 4:return i.getUint32(t);case 5:return i.getUint32(t)/i.getUint32(t+4);case 6:return i.getInt8(t);case 8:return i.getInt16(t);case 9:return i.getInt32(t);case 10:return i.getInt32(t)/i.getInt32(t+4);case 11:return i.getFloat(t);case 12:return i.getDouble(t);case 13:return i.getUint32(t);default:ne(`Invalid tiff type ${e}`)}}},Kt=class extends ln{static canHandle(e,t){return e.getUint8(t+1)===225&&e.getUint32(t+4)===1165519206&&e.getUint16(t+8)===0}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let t=this[e]();return t.catch!==void 0&&(t=t.catch(this.handleError)),t}findIfd0Offset(){this.ifd0Offset===void 0&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(this.ifd1Offset===void 0){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let i=new Map;return this[t]=i,this.parseTags(e,t,i),i}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&ne("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&ne(`IFD0 offset points to outside of file.
this.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,_a(this.options));let t=this.parseBlock(this.ifd0Offset,"ifd0");return t.size!==0?(this.exifOffset=t.get(34665),this.interopOffset=t.get(40965),this.gpsOffset=t.get(34853),this.xmp=t.get(700),this.iptc=t.get(33723),this.icc=t.get(34675),this.options.sanitize&&(t.delete(34665),t.delete(40965),t.delete(34853),t.delete(700),t.delete(33723),t.delete(34675)),t):void 0}async parseExifBlock(){if(this.exif||(this.ifd0||await this.parseIfd0Block(),this.exifOffset===void 0))return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,_a(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get(40965)),this.makerNote=e.get(37500),this.userComment=e.get(37510),this.options.sanitize&&(e.delete(40965),e.delete(37500),e.delete(37510)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let i=e.get(t);i&&i.length===1&&e.set(t,i[0])}async parseGpsBlock(){if(this.gps||(this.ifd0||await this.parseIfd0Block(),this.gpsOffset===void 0))return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",Ea(...e.get(2),e.get(1))),e.set("longitude",Ea(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),this.interopOffset!==void 0||this.exif||await this.parseExifBlock(),this.interopOffset!==void 0))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),this.ifd1===void 0)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,i,n={};for(t of te)if(e=this[t],!Aa(e))if(i=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if(t==="ifd1")continue;Object.assign(n,i)}else n[t]=i;return this.makerNote&&(n.makerNote=this.makerNote),this.userComment&&(n.userComment=this.userComment),n}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[i,n]of Object.entries(t))this.assignObjectToOutput(e,i,n)}};function Ea(r,e,t,i){var n=r+e/60+t/3600;return i!=="S"&&i!=="W"||(n*=-1),n}H(Kt,"type","tiff"),H(Kt,"headerLength",10),_e.set("tiff",Kt);var Ny=Object.freeze({__proto__:null,default:Hc,Exifr:ut,fileParsers:jr,segmentParsers:_e,fileReaders:Zt,tagKeys:er,tagValues:pn,tagRevivers:hn,createDictionary:Oa,extendDictionary:Ia,fetchUrlAsArrayBuffer:Nr,readBlobAsArrayBuffer:Qt,chunkedProps:st,otherSegments:Mr,segments:Jt,tiffBlocks:te,segmentsAndBlocks:ot,tiffExtractables:at,inheritables:zr,allFormatters:lt,Options:Ge,parse:Ra}),fn={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},By=Object.assign({},fn,{firstChunkSize:4e4,gps:[1,2,3,4]});var Dy=Object.assign({},fn,{tiff:!1,ifd1:!0,mergeOutput:!1});var Kc=Object.assign({},fn,{firstChunkSize:4e4,ifd0:[274]});async function Xc(r){let e=new ut(Kc);await e.read(r);let t=await e.parse();if(t&&t.ifd0)return t.ifd0[274]}var Yc=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}}),Wt=!0,Gt=!0;if(typeof navigator=="object"){let r=navigator.userAgent;if(r.includes("iPad")||r.includes("iPhone")){let e=r.match(/OS (\d+)_(\d+)/);if(e){let[,t,i]=e;Wt=Number(t)+.1*Number(i)<13.4,Gt=!1}}else if(r.includes("OS X 10")){let[,e]=r.match(/OS X 10[_.](\d+)/);Wt=Gt=Number(e)<15}if(r.includes("Chrome/")){let[,e]=r.match(/Chrome\/(\d+)/);Wt=Gt=Number(e)<81}else if(r.includes("Firefox/")){let[,e]=r.match(/Firefox\/(\d+)/);Wt=Gt=Number(e)<77}}async function Na(r){let e=await Xc(r);return Object.assign({canvas:Wt,css:Gt},Yc[e])}var un=class extends We{constructor(...e){super(...e),H(this,"ranges",new dn),this.byteLength!==0&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,i){if(e===0&&this.byteLength===0&&i){let n=new DataView(i.buffer||i,i.byteOffset,i.byteLength);this._swapDataView(n)}else{let n=e+t;if(n>this.byteLength){let{dataView:s}=this._extend(n);this._swapDataView(s)}}}_extend(e){let t;t=Ua?Ca.allocUnsafe(e):new Uint8Array(e);let i=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:i}}subarray(e,t,i=!1){return t=t||this._lengthToEnd(e),i&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,i=!1){i&&this._tryExtend(t,e.byteLength,e);let n=super.set(e,t);return this.ranges.add(t,n.byteLength),n}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}},dn=class{constructor(){H(this,"list",[])}get length(){return this.list.length}add(e,t,i=0){let n=e+t,s=this.list.filter(o=>Ta(e,o.offset,n)||Ta(e,o.end,n));if(s.length>0){e=Math.min(e,...s.map(a=>a.offset)),n=Math.max(n,...s.map(a=>a.end)),t=n-e;let o=s.shift();o.offset=e,o.length=t,o.end=n,this.list=this.list.filter(a=>!s.includes(a))}else this.list.push({offset:e,length:t,end:n})}available(e,t){let i=e+t;return this.list.some(n=>n.offset<=e&&i<=n.end)}};function Ta(r,e,t){return r<=e&&e<=t}var cn=class extends un{constructor(e,t){super(0),H(this,"chunksRead",0),this.input=e,this.options=t}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,i=await this.readChunk(e,t);return!!i&&i.byteLength===t}async readChunk(e,t){if(this.chunksRead++,(t=this.safeWrapAddress(e,t))!==0)return this._readChunk(e,t)}safeWrapAddress(e,t){return this.size!==void 0&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(this.ranges.list.length!==0)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return this.size!==void 0&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}};Zt.set("blob",class extends cn{async readWhole(){this.chunked=!1;let r=await Qt(this.input);this._swapArrayBuffer(r)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(r,e){let t=e?r+e:void 0,i=this.input.slice(r,t),n=await Qt(i);return this.set(n,r,!0)}});var Ba={name:"@uppy/thumbnail-generator",description:"Uppy plugin that generates small previews of images to show on your upload UI.",version:"5.0.1",license:"MIT",type:"module",sideEffects:!1,scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","uppy","uppy-plugin","thumbnail","preview","resize"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],exports:{".":"./lib/index.js","./package.json":"./package.json"},dependencies:{"@uppy/utils":"^7.0.2",exifr:"^7.0.0"},devDependencies:{jsdom:"^26.1.0","namespace-emitter":"2.0.1",typescript:"^5.8.3",vitest:"^3.2.4"},peerDependencies:{"@uppy/core":"^5.0.2"}};var Da={strings:{generatingThumbnails:"Generating thumbnails..."}};function Jc(r,e,t){try{r.getContext("2d").getImageData(0,0,1,1)}catch(i){if(i.code===18)return Promise.reject(new Error("cannot read image, probably an svg with external resources"))}return r.toBlob?new Promise(i=>{r.toBlob(i,e,t)}).then(i=>{if(i===null)throw new Error("cannot read image, probably an svg with external resources");return i}):Promise.resolve().then(()=>vi(r.toDataURL(e,t),{})).then(i=>{if(i===null)throw new Error("could not extract blob, probably an old browser");return i})}function Zc(r,e){let t=r.width,i=r.height;(e.deg===90||e.deg===270)&&(t=r.height,i=r.width);let n=document.createElement("canvas");n.width=t,n.height=i;let s=n.getContext("2d");return s.translate(t/2,i/2),e.canvas&&(s.rotate(e.rad),s.scale(e.scaleX,e.scaleY)),s.drawImage(r,-r.width/2,-r.height/2,r.width,r.height),n}function ep(r){let e=r.width/r.height,t=5e6,i=4096,n=Math.floor(Math.sqrt(t*e)),s=Math.floor(t/Math.sqrt(t*e));if(n>i&&(n=i,s=Math.round(n/e)),s>i&&(s=i,n=Math.round(e*s)),r.width>n){let o=document.createElement("canvas");return o.width=n,o.height=s,o.getContext("2d").drawImage(r,0,0,n,s),o}return r}var tp={thumbnailWidth:null,thumbnailHeight:null,thumbnailType:"image/jpeg",waitForThumbnailsBeforeUpload:!1,lazy:!1},qr=class extends Vt{static VERSION=Ba.version;queue;queueProcessing;defaultThumbnailDimension;thumbnailType;constructor(e,t){if(super(e,m(m({},tp),t)),this.type="modifier",this.id=this.opts.id||"ThumbnailGenerator",this.title="Thumbnail Generator",this.queue=[],this.queueProcessing=!1,this.defaultThumbnailDimension=200,this.thumbnailType=this.opts.thumbnailType,this.defaultLocale=Da,this.i18nInit(),this.opts.lazy&&this.opts.waitForThumbnailsBeforeUpload)throw new Error("ThumbnailGenerator: The `lazy` and `waitForThumbnailsBeforeUpload` options are mutually exclusive. Please ensure at most one of them is set to `true`.")}createThumbnail(e,t,i){let n=URL.createObjectURL(e.data),s=new Promise((a,u)=>{let c=new Image;c.src=n,c.addEventListener("load",()=>{URL.revokeObjectURL(n),a(c)}),c.addEventListener("error",p=>{URL.revokeObjectURL(n),u(p.error||new Error("Could not create thumbnail"))})}),o=Na(e.data).catch(()=>1);return Promise.all([s,o]).then(([a,u])=>{let c=this.getProportionalDimensions(a,t,i,u.deg),p=Zc(a,u),d=this.resizeImage(p,c.width,c.height);return Jc(d,this.thumbnailType,80)}).then(a=>URL.createObjectURL(a))}getProportionalDimensions(e,t,i,n){let s=e.width/e.height;if((n===90||n===270)&&(s=e.height/e.width),t!=null){let o=t;return e.width<t&&(o=e.width),{width:o,height:Math.round(o/s)}}if(i!=null){let o=i;return e.height<i&&(o=e.height),{width:Math.round(o*s),height:o}}return{width:this.defaultThumbnailDimension,height:Math.round(this.defaultThumbnailDimension/s)}}resizeImage(e,t,i){let n=ep(e),s=Math.ceil(Math.log2(n.width/t));s<1&&(s=1);let o=t*2**(s-1),a=i*2**(s-1),u=2;for(;s--;){let c=document.createElement("canvas");c.width=o,c.height=a,c.getContext("2d").drawImage(n,0,0,o,a),n=c,o=Math.round(o/u),a=Math.round(a/u)}return n}setPreviewURL(e,t){this.uppy.setFileState(e,{preview:t})}addToQueue(e){this.queue.push(e),this.queueProcessing===!1&&this.processQueue()}processQueue(){if(this.queueProcessing=!0,this.queue.length>0){let e=this.uppy.getFile(this.queue.shift());return e?this.requestThumbnail(e).catch(()=>{}).then(()=>this.processQueue()):(this.uppy.log("[ThumbnailGenerator] file was removed before a thumbnail could be generated, but not removed from the queue. This is probably a bug","error"),Promise.resolve())}return this.queueProcessing=!1,this.uppy.log("[ThumbnailGenerator] Emptied thumbnail queue"),this.uppy.emit("thumbnail:all-generated"),Promise.resolve()}requestThumbnail(e){return Ot(e.type)&&!e.isRemote?this.createThumbnail(e,this.opts.thumbnailWidth,this.opts.thumbnailHeight).then(t=>{this.setPreviewURL(e.id,t),this.uppy.log(`[ThumbnailGenerator] Generated thumbnail for ${e.id}`),this.uppy.emit("thumbnail:generated",this.uppy.getFile(e.id),t)}).catch(t=>{this.uppy.log(`[ThumbnailGenerator] Failed thumbnail for ${e.id}:`,"warning"),this.uppy.log(t,"warning"),this.uppy.emit("thumbnail:error",this.uppy.getFile(e.id),t)}):Promise.resolve()}onFileAdded=e=>{!e.preview&&e.data&&Ot(e.type)&&!e.isRemote&&this.addToQueue(e.id)};onCancelRequest=e=>{let t=this.queue.indexOf(e.id);t!==-1&&this.queue.splice(t,1)};onFileRemoved=e=>{let t=this.queue.indexOf(e.id);t!==-1&&this.queue.splice(t,1),e.preview&&At(e.preview)&&URL.revokeObjectURL(e.preview)};onRestored=()=>{this.uppy.getFiles().filter(t=>t.isRestored).forEach(t=>{(!t.preview||At(t.preview))&&this.addToQueue(t.id)})};onAllFilesRemoved=()=>{this.queue=[]};waitUntilAllProcessed=e=>{e.forEach(i=>{let n=this.uppy.getFile(i);this.uppy.emit("preprocess-progress",n,{mode:"indeterminate",message:this.i18n("generatingThumbnails")})});let t=()=>{e.forEach(i=>{let n=this.uppy.getFile(i);this.uppy.emit("preprocess-complete",n)})};return new Promise(i=>{this.queueProcessing?this.uppy.once("thumbnail:all-generated",()=>{t(),i()}):(t(),i())})};install(){this.uppy.on("file-removed",this.onFileRemoved),this.uppy.on("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("thumbnail:cancel",this.onCancelRequest)):(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("file-added",this.onFileAdded),this.uppy.on("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.addPreProcessor(this.waitUntilAllProcessed)}uninstall(){this.uppy.off("file-removed",this.onFileRemoved),this.uppy.off("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("thumbnail:cancel",this.onCancelRequest)):(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("file-added",this.onFileAdded),this.uppy.off("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.removePreProcessor(this.waitUntilAllProcessed)}};function rp(){return l("svg",{width:"26",height:"26",viewBox:"0 0 26 26",xmlns:"http://www.w3.org/2000/svg",children:l("g",{fill:"none","fill-rule":"evenodd",children:[l("circle",{fill:"#FFF",cx:"13",cy:"13",r:"13"}),l("path",{d:"M21.64 13.205c0-.639-.057-1.252-.164-1.841H13v3.481h4.844a4.14 4.14 0 01-1.796 2.716v2.259h2.908c1.702-1.567 2.684-3.875 2.684-6.615z",fill:"#4285F4","fill-rule":"nonzero"}),l("path",{d:"M13 22c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H4.957v2.332A8.997 8.997 0 0013 22z",fill:"#34A853","fill-rule":"nonzero"}),l("path",{d:"M7.964 14.71A5.41 5.41 0 017.682 13c0-.593.102-1.17.282-1.71V8.958H4.957A8.996 8.996 0 004 13c0 1.452.348 2.827.957 4.042l3.007-2.332z",fill:"#FBBC05","fill-rule":"nonzero"}),l("path",{d:"M13 7.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C17.463 4.891 15.426 4 13 4a8.997 8.997 0 00-8.043 4.958l3.007 2.332C8.672 9.163 10.656 7.58 13 7.58z",fill:"#EA4335","fill-rule":"nonzero"}),l("path",{d:"M4 4h18v18H4z"})]})})}function ip({pluginName:r,i18n:e,onAuth:t}){let i=r==="Google Drive",n=Te(s=>{s.preventDefault(),t()},[t]);return l("form",{onSubmit:n,children:i?l("button",{type:"submit",className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Provider-authBtn uppy-Provider-btn-google","data-uppy-super-focusable":!0,children:[l(rp,{}),e("signInWithGoogle")]}):l("button",{type:"submit",className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Provider-authBtn","data-uppy-super-focusable":!0,children:e("authenticateWith",{pluginName:r})})})}var np=({pluginName:r,i18n:e,onAuth:t})=>l(ip,{pluginName:r,i18n:e,onAuth:t});function mn({loading:r,pluginName:e,pluginIcon:t,i18n:i,handleAuth:n,renderForm:s=np}){return l("div",{className:"uppy-Provider-auth",children:[l("div",{className:"uppy-Provider-authIcon",children:t()}),l("div",{className:"uppy-Provider-authTitle",children:i("authenticateWithTitle",{pluginName:e})}),s({pluginName:e,i18n:i,loading:r,onAuth:n})]})}var al=Y(ye(),1);var La={name:"@uppy/provider-views",description:"View library for Uppy remote provider plugins.",version:"5.0.2",license:"MIT",style:"dist/style.min.css",type:"module",sideEffects:["*.css"],scripts:{build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","uppy"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],exports:{".":"./lib/index.js","./css/style.min.css":"./dist/style.min.css","./css/style.css":"./dist/style.css","./css/style.scss":"./src/style.scss","./package.json":"./package.json"},dependencies:{"@uppy/utils":"^7.0.2",classnames:"^2.2.6",nanoid:"^5.0.9","p-queue":"^8.0.0",preact:"^10.5.13"},devDependencies:{"@types/gapi":"^0.0.47","@types/google.accounts":"^0.0.14","@types/google.picker":"^0.0.42",cssnano:"^7.0.7",jsdom:"^26.1.0",postcss:"^8.5.6","postcss-cli":"^11.0.1",sass:"^1.89.2",typescript:"^5.8.3",vitest:"^3.2.4"},peerDependencies:{"@uppy/core":"^5.0.2"}};var ja=Y(ye(),1);function op(){return l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:11,height:14.5,viewBox:"0 0 44 58",children:l("path",{d:"M27.437.517a1 1 0 0 0-.094.03H4.25C2.037.548.217 2.368.217 4.58v48.405c0 2.212 1.82 4.03 4.03 4.03H39.03c2.21 0 4.03-1.818 4.03-4.03V15.61a1 1 0 0 0-.03-.28 1 1 0 0 0 0-.093 1 1 0 0 0-.03-.032 1 1 0 0 0 0-.03 1 1 0 0 0-.032-.063 1 1 0 0 0-.03-.063 1 1 0 0 0-.032 0 1 1 0 0 0-.03-.063 1 1 0 0 0-.032-.03 1 1 0 0 0-.03-.063 1 1 0 0 0-.063-.062l-14.593-14a1 1 0 0 0-.062-.062A1 1 0 0 0 28 .708a1 1 0 0 0-.374-.157 1 1 0 0 0-.156 0 1 1 0 0 0-.03-.03l-.003-.003zM4.25 2.547h22.218v9.97c0 2.21 1.82 4.03 4.03 4.03h10.564v36.438a2.02 2.02 0 0 1-2.032 2.032H4.25c-1.13 0-2.032-.9-2.032-2.032V4.58c0-1.13.902-2.032 2.03-2.032zm24.218 1.345l10.375 9.937.75.718H30.5c-1.13 0-2.032-.9-2.032-2.03V3.89z"})})}function ap(){return l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",style:{minWidth:16,marginRight:3},viewBox:"0 0 276.157 276.157",children:l("path",{d:"M273.08 101.378c-3.3-4.65-8.86-7.32-15.254-7.32h-24.34V67.59c0-10.2-8.3-18.5-18.5-18.5h-85.322c-3.63 0-9.295-2.875-11.436-5.805l-6.386-8.735c-4.982-6.814-15.104-11.954-23.546-11.954H58.73c-9.292 0-18.638 6.608-21.737 15.372l-2.033 5.752c-.958 2.71-4.72 5.37-7.596 5.37H18.5C8.3 49.09 0 57.39 0 67.59v167.07c0 .886.16 1.73.443 2.52.152 3.306 1.18 6.424 3.053 9.064 3.3 4.652 8.86 7.32 15.255 7.32h188.487c11.395 0 23.27-8.425 27.035-19.18l40.677-116.188c2.11-6.035 1.43-12.164-1.87-16.816zM18.5 64.088h8.864c9.295 0 18.64-6.607 21.738-15.37l2.032-5.75c.96-2.712 4.722-5.373 7.597-5.373h29.565c3.63 0 9.295 2.876 11.437 5.806l6.386 8.735c4.982 6.815 15.104 11.954 23.546 11.954h85.322c1.898 0 3.5 1.602 3.5 3.5v26.47H69.34c-11.395 0-23.27 8.423-27.035 19.178L15 191.23V67.59c0-1.898 1.603-3.5 3.5-3.5zm242.29 49.15l-40.676 116.188c-1.674 4.78-7.812 9.135-12.877 9.135H18.75c-1.447 0-2.576-.372-3.02-.997-.442-.625-.422-1.814.057-3.18l40.677-116.19c1.674-4.78 7.812-9.134 12.877-9.134h188.487c1.448 0 2.577.372 3.02.997.443.625.423 1.814-.056 3.18z"})})}function lp(){return l("svg",{"aria-hidden":"true",focusable:"false",style:{width:16,marginRight:4},viewBox:"0 0 58 58",children:[l("path",{d:"M36.537 28.156l-11-7a1.005 1.005 0 0 0-1.02-.033C24.2 21.3 24 21.635 24 22v14a1 1 0 0 0 1.537.844l11-7a1.002 1.002 0 0 0 0-1.688zM26 34.18V23.82L34.137 29 26 34.18z"}),l("path",{d:"M57 6H1a1 1 0 0 0-1 1v44a1 1 0 0 0 1 1h56a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1zM10 28H2v-9h8v9zm-8 2h8v9H2v-9zm10 10V8h34v42H12V40zm44-12h-8v-9h8v9zm-8 2h8v9h-8v-9zm8-22v9h-8V8h8zM2 8h8v9H2V8zm0 42v-9h8v9H2zm54 0h-8v-9h8v9z"})]})}function dt({itemIconString:r,alt:e=void 0}){if(r===null)return null;switch(r){case"file":return l(op,{});case"folder":return l(ap,{});case"video":return l(lp,{});default:return l("img",{src:r,alt:e,referrerPolicy:"no-referrer",loading:"lazy",width:16,height:16})}}function up({file:r,toggleCheckbox:e,className:t,isDisabled:i,restrictionError:n,showTitles:s,children:o=null,i18n:a}){return l("li",{className:t,title:i&&n?n:void 0,children:[l("input",{type:"checkbox",className:"uppy-u-reset uppy-ProviderBrowserItem-checkbox uppy-ProviderBrowserItem-checkbox--grid",onChange:e,name:"listitem",id:r.id,checked:r.status==="checked",disabled:i,"data-uppy-super-focusable":!0}),l("label",{htmlFor:r.id,"aria-label":r.data.name??a("unnamed"),className:"uppy-u-reset uppy-ProviderBrowserItem-inner",children:[l(dt,{itemIconString:r.data.thumbnail||r.data.icon}),s&&(r.data.name??a("unnamed")),o]})]})}var gn=up;function yn({file:r,openFolder:e,className:t,isDisabled:i,restrictionError:n,toggleCheckbox:s,showTitles:o,i18n:a}){return l("li",{className:t,title:r.status!=="checked"&&n?n:void 0,children:[l("input",{type:"checkbox",className:"uppy-u-reset uppy-ProviderBrowserItem-checkbox",onChange:s,name:"listitem",id:r.id,checked:r.status==="checked","aria-label":r.data.isFolder?a("allFilesFromFolderNamed",{name:r.data.name??a("unnamed")}):null,disabled:i,"data-uppy-super-focusable":!0}),r.data.isFolder?l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-ProviderBrowserItem-inner",onClick:()=>e(r.id),"aria-label":a("openFolderNamed",{name:r.data.name??a("unnamed")}),children:[l("div",{className:"uppy-ProviderBrowserItem-iconWrap",children:l(dt,{itemIconString:r.data.icon})}),o&&r.data.name?l("span",{children:r.data.name}):a("unnamed")]}):l("label",{htmlFor:r.id,className:"uppy-u-reset uppy-ProviderBrowserItem-inner",children:[l("div",{className:"uppy-ProviderBrowserItem-iconWrap",children:l(dt,{itemIconString:r.data.icon})}),o&&(r.data.name??a("unnamed"))]})]})}function bn(r){let{viewType:e,toggleCheckbox:t,showTitles:i,i18n:n,openFolder:s,file:o,utmSource:a}=r,u=o.type==="folder"?null:o.restrictionError,c=!!u&&o.status!=="checked",p={file:o,openFolder:s,toggleCheckbox:t,utmSource:a,i18n:n,viewType:e,showTitles:i,className:(0,ja.default)("uppy-ProviderBrowserItem",{"uppy-ProviderBrowserItem--disabled":c},{"uppy-ProviderBrowserItem--noPreview":o.data.icon==="video"},{"uppy-ProviderBrowserItem--is-checked":o.status==="checked"},{"uppy-ProviderBrowserItem--is-partial":o.status==="partial"}),isDisabled:c,restrictionError:u};switch(e){case"grid":return l(gn,m({},p));case"list":return l(yn,m({},p));case"unsplash":return l(gn,I(m({},p),{children:l("a",{href:`${o.data.author.url}?utm_source=${a}&utm_medium=referral`,target:"_blank",rel:"noopener noreferrer",className:"uppy-ProviderBrowserItem-author",tabIndex:-1,children:o.data.author.name})}));default:throw new Error(`There is no such type ${e}`)}}function dp(r){let{displayedPartialTree:e,viewType:t,toggleCheckbox:i,handleScroll:n,showTitles:s,i18n:o,isLoading:a,openFolder:u,noResultsLabel:c,virtualList:p,utmSource:d}=r,[v,b]=we(!1);if(Ee(()=>{let A=U=>{U.key==="Shift"&&b(!1)},C=U=>{U.key==="Shift"&&b(!0)};return document.addEventListener("keyup",A),document.addEventListener("keydown",C),()=>{document.removeEventListener("keyup",A),document.removeEventListener("keydown",C)}},[]),a)return l("div",{className:"uppy-Provider-loading",children:typeof a=="string"?a:o("loading")});if(e.length===0)return l("div",{className:"uppy-Provider-empty",children:c});let x=A=>l(bn,{viewType:t,toggleCheckbox:C=>{C.stopPropagation(),C.preventDefault(),document.getSelection()?.removeAllRanges(),i(A,v)},showTitles:s,i18n:o,openFolder:u,file:A,utmSource:d},A.id);return p?l("div",{className:"uppy-ProviderBrowser-body",children:l(nt,{className:"uppy-ProviderBrowser-list",data:e,renderRow:x,rowHeight:35.5})}):l("div",{className:"uppy-ProviderBrowser-body",children:l("ul",{className:"uppy-ProviderBrowser-list",onScroll:n,tabIndex:-1,children:e.map(x)})})}var Ma=dp;var za=Y(ye(),1);var cp=r=>r.filter(t=>t.type==="file"&&t.status==="checked"?!0:t.type==="folder"&&t.status==="checked"?!r.some(n=>n.type!=="root"&&n.parentId===t.id):!1).length,$r=cp;function vn({cancelSelection:r,donePicking:e,i18n:t,partialTree:i,validateAggregateRestrictions:n}){let s=$e(()=>n(i),[i,n]),o=$e(()=>$r(i),[i]);return o===0?null:l("div",{className:"uppy-ProviderBrowser-footer",children:[l("div",{className:"uppy-ProviderBrowser-footer-buttons",children:[l("button",{className:(0,za.default)("uppy-u-reset uppy-c-btn uppy-c-btn-primary",{"uppy-c-btn--disabled":s}),disabled:!!s,onClick:e,type:"button",children:t("selectX",{smart_count:o})}),l("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-link",onClick:r,type:"button",children:t("cancel")})]}),s&&l("div",{className:"uppy-ProviderBrowser-footer-error",children:s})]})}function pp({searchString:r,setSearchString:e,submitSearchString:t,wrapperClassName:i,inputClassName:n,inputLabel:s,clearSearchLabel:o="",showButton:a=!1,buttonLabel:u="",buttonCSSClassName:c=""}){let p=b=>{e(b.target.value)},d=Te(b=>{b.preventDefault(),t()},[t]),[v]=we(()=>{let b=document.createElement("form");return b.setAttribute("tabindex","-1"),b.id=De(),b});return Ee(()=>(document.body.appendChild(v),v.addEventListener("submit",d),()=>{v.removeEventListener("submit",d),document.body.removeChild(v)}),[v,d]),l("section",{className:i,children:[l("input",{className:`uppy-u-reset ${n}`,type:"search","aria-label":s,placeholder:s,value:r,onInput:p,form:v.id,"data-uppy-super-focusable":!0}),!a&&l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-ProviderBrowser-searchFilterIcon",width:"12",height:"12",viewBox:"0 0 12 12",children:l("path",{d:"M8.638 7.99l3.172 3.172a.492.492 0 1 1-.697.697L7.91 8.656a4.977 4.977 0 0 1-2.983.983C2.206 9.639 0 7.481 0 4.819 0 2.158 2.206 0 4.927 0c2.721 0 4.927 2.158 4.927 4.82a4.74 4.74 0 0 1-1.216 3.17zm-3.71.685c2.176 0 3.94-1.726 3.94-3.856 0-2.129-1.764-3.855-3.94-3.855C2.75.964.984 2.69.984 4.819c0 2.13 1.765 3.856 3.942 3.856z"})}),!a&&r&&l("button",{className:"uppy-u-reset uppy-ProviderBrowser-searchFilterReset",type:"button","aria-label":o,title:o,onClick:()=>e(""),children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",viewBox:"0 0 19 19",children:l("path",{d:"M17.318 17.232L9.94 9.854 9.586 9.5l-.354.354-7.378 7.378h.707l-.62-.62v.706L9.318 9.94l.354-.354-.354-.354L1.94 1.854v.707l.62-.62h-.706l7.378 7.378.354.354.354-.354 7.378-7.378h-.707l.622.62v-.706L9.854 9.232l-.354.354.354.354 7.378 7.378.708-.707-7.38-7.378v.708l7.38-7.38.353-.353-.353-.353-.622-.622-.353-.353-.354.352-7.378 7.38h.708L2.56 1.23 2.208.88l-.353.353-.622.62-.353.355.352.353 7.38 7.38v-.708l-7.38 7.38-.353.353.352.353.622.622.353.353.354-.353 7.38-7.38h-.708l7.38 7.38z"})})}),a&&l("button",{className:`uppy-u-reset uppy-c-btn uppy-c-btn-primary ${c}`,type:"submit",form:v.id,children:u})]})}var qa=pp;var hp=(r,e,t)=>({id:r.id,source:e.id,name:r.name||r.id,type:r.mimeType,isRemote:!0,data:r,preview:r.thumbnail||void 0,meta:{authorName:r.author?.name,authorUrl:r.author?.url,relativePath:r.relDirPath||null,absolutePath:r.absDirPath},body:{fileId:r.id},remote:{companionUrl:e.opts.companionUrl,url:`${t.fileUrl(r.requestPath)}`,body:{fileId:r.id},providerName:t.name,provider:t.provider,requestClientId:t.provider}}),Ha=hp;var fp=(r,e,t)=>{let i=r.map(o=>Ha(o,e,t)),n=[],s=[];i.forEach(o=>{e.uppy.checkIfFileAlreadyExists(Ut(o,e.uppy.getID()))?s.push(o):n.push(o)}),n.length>0&&e.uppy.info(e.uppy.i18n("addedNumFiles",{numFiles:n.length})),s.length>0&&e.uppy.info(`Not adding ${s.length} files because they already exist`),e.uppy.addFiles(n)},$a=fp;var mp=(r,e,t,i)=>{let n=e.findIndex(s=>s.id===i);if(n!==-1&&t){let s=e.findIndex(a=>a.id===r);return e.slice(Math.min(n,s),Math.max(n,s)+1).map(a=>a.id)}return[r]},Va=mp;var gp=r=>e=>{if(!e.isAuthError){if(e.name==="AbortError"){r.log("Aborting request","warning");return}r.log(e,"error"),e.name==="UserFacingApiError"&&r.info({message:r.i18n("companionError"),details:r.i18n(e.message)},"warning",5e3)}},ct=gp;var yp=(r,e)=>{let t=r.find(n=>n.id===e),i=[];for(;i=[t,...i],t.type!=="root";){let n=t.parentId;t=r.find(s=>s.id===n)}return i},Wa=yp;var Ga=(r,e,t)=>{let i=e===null?"null":e;if(t[i])return t[i];let n=r.find(o=>o.id===e);if(n.type==="root")return[];let s=[...Ga(r,n.parentId,t),n];return t[i]=s,s},bp=r=>{let e=Object.create(null);return r.filter(n=>n.type==="file"&&n.status==="checked").map(n=>{let s=Ga(r,n.id,e),o=s.findIndex(p=>p.type==="folder"&&p.status==="checked"),a=s.slice(o),u=`/${s.map(p=>p.data.name).join("/")}`,c=a.length===1?void 0:a.map(p=>p.data.name).join("/");return I(m({},n.data),{absDirPath:u,relDirPath:c})})},Ka=bp;var _n=Y(Ya(),1);var rr=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},xn=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}},Qa=r=>globalThis.DOMException===void 0?new xn(r):new DOMException(r),Ja=r=>{let e=r.reason===void 0?Qa("This operation was aborted."):r.reason;return e instanceof Error?e:Qa(e)};function Sn(r,e){let{milliseconds:t,fallback:i,message:n,customTimers:s={setTimeout,clearTimeout}}=e,o,a,c=new Promise((p,d)=>{if(typeof t!="number"||Math.sign(t)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(e.signal){let{signal:b}=e;b.aborted&&d(Ja(b)),a=()=>{d(Ja(b))},b.addEventListener("abort",a,{once:!0})}if(t===Number.POSITIVE_INFINITY){r.then(p,d);return}let v=new rr;o=s.setTimeout.call(void 0,()=>{if(i){try{p(i())}catch(b){d(b)}return}typeof r.cancel=="function"&&r.cancel(),n===!1?p():n instanceof Error?d(n):(v.message=n??`Promise timed out after ${t} milliseconds`,d(v))},t),(async()=>{try{p(await r)}catch(b){d(b)}})()}).finally(()=>{c.clear(),a&&e.signal&&e.signal.removeEventListener("abort",a)});return c.clear=()=>{s.clearTimeout.call(void 0,o),o=void 0},c}function Fn(r,e,t){let i=0,n=r.length;for(;n>0;){let s=Math.trunc(n/2),o=i+s;t(r[o],e)<=0?(i=++o,n-=s+1):n=s}return i}var Wr=class{#e=[];enqueue(e,t){t=m({priority:0},t);let i={priority:t.priority,id:t.id,run:e};if(this.size===0||this.#e[this.size-1].priority>=t.priority){this.#e.push(i);return}let n=Fn(this.#e,i,(s,o)=>o.priority-s.priority);this.#e.splice(n,0,i)}setPriority(e,t){let i=this.#e.findIndex(s=>s.id===e);if(i===-1)throw new ReferenceError(`No promise function with the id "${e}" exists in the queue.`);let[n]=this.#e.splice(i,1);this.enqueue(n.run,{priority:t,id:e})}dequeue(){return this.#e.shift()?.run}filter(e){return this.#e.filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return this.#e.length}};var Gr=class extends _n.default{#e;#t;#r=0;#i;#n;#u=0;#o;#a;#s;#h;#l=0;#c;#d;#p;#w=1n;timeout;constructor(e){if(super(),e=m({carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Wr},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${e.intervalCap?.toString()??""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${e.interval?.toString()??""}\` (${typeof e.interval})`);this.#e=e.carryoverConcurrencyCount,this.#t=e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,this.#i=e.intervalCap,this.#n=e.interval,this.#s=new e.queueClass,this.#h=e.queueClass,this.concurrency=e.concurrency,this.timeout=e.timeout,this.#p=e.throwOnTimeout===!0,this.#d=e.autoStart===!1}get#_(){return this.#t||this.#r<this.#i}get#F(){return this.#l<this.#c}#x(){this.#l--,this.#b(),this.emit("next")}#y(){this.#v(),this.#f(),this.#a=void 0}get#P(){let e=Date.now();if(this.#o===void 0){let t=this.#u-e;if(t<0)this.#r=this.#e?this.#l:0;else return this.#a===void 0&&(this.#a=setTimeout(()=>{this.#y()},t)),!0}return!1}#b(){if(this.#s.size===0)return this.#o&&clearInterval(this.#o),this.#o=void 0,this.emit("empty"),this.#l===0&&this.emit("idle"),!1;if(!this.#d){let e=!this.#P;if(this.#_&&this.#F){let t=this.#s.dequeue();return t?(this.emit("active"),t(),e&&this.#f(),!0):!1}}return!1}#f(){this.#t||this.#o!==void 0||(this.#o=setInterval(()=>{this.#v()},this.#n),this.#u=Date.now()+this.#n)}#v(){this.#r===0&&this.#l===0&&this.#o&&(clearInterval(this.#o),this.#o=void 0),this.#r=this.#e?this.#l:0,this.#m()}#m(){for(;this.#b(););}get concurrency(){return this.#c}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this.#c=e,this.#m()}async#E(e){return new Promise((t,i)=>{e.addEventListener("abort",()=>{i(e.reason)},{once:!0})})}setPriority(e,t){this.#s.setPriority(e,t)}async add(e,t={}){return t.id??=(this.#w++).toString(),t=m({timeout:this.timeout,throwOnTimeout:this.#p},t),new Promise((i,n)=>{this.#s.enqueue(async()=>{this.#l++;try{t.signal?.throwIfAborted(),this.#r++;let s=e({signal:t.signal});t.timeout&&(s=Sn(Promise.resolve(s),{milliseconds:t.timeout})),t.signal&&(s=Promise.race([s,this.#E(t.signal)]));let o=await s;i(o),this.emit("completed",o)}catch(s){if(s instanceof rr&&!t.throwOnTimeout){i();return}n(s),this.emit("error",s)}finally{this.#x()}},t),this.emit("add"),this.#b()})}async addAll(e,t){return Promise.all(e.map(async i=>this.add(i,t)))}start(){return this.#d?(this.#d=!1,this.#m(),this):this}pause(){this.#d=!0}clear(){this.#s=new this.#h}async onEmpty(){this.#s.size!==0&&await this.#g("empty")}async onSizeLessThan(e){this.#s.size<e||await this.#g("next",()=>this.#s.size<e)}async onIdle(){this.#l===0&&this.#s.size===0||await this.#g("idle")}async#g(e,t){return new Promise(i=>{let n=()=>{t&&!t()||(this.off(e,n),i())};this.on(e,n)})}get size(){return this.#s.size}sizeBy(e){return this.#s.filter(e).length}get pending(){return this.#l}get isPaused(){return this.#d}};var _p=r=>r.map(e=>m({},e)),Kr=_p;var Za=async(r,e,t,i,n)=>{let s=[],o=t.cached?t.nextPagePath:t.id;for(;o;){let d=await i(o);s=s.concat(d.items),o=d.nextPagePath}let a=s.filter(d=>d.isFolder===!0),u=s.filter(d=>d.isFolder===!1),c=a.map(d=>({type:"folder",id:d.requestPath,cached:!1,nextPagePath:null,status:"checked",parentId:t.id,data:d})),p=u.map(d=>{let v=n(d);return{type:"file",id:d.requestPath,restrictionError:v,status:v?"unchecked":"checked",parentId:t.id,data:d}});t.cached=!0,t.nextPagePath=null,e.push(...p,...c),c.forEach(async d=>{r.add(()=>Za(r,e,d,i,n))})},xp=async(r,e,t,i)=>{let n=new Gr({concurrency:6}),s=Kr(r);return s.filter(a=>a.type==="folder"&&a.status==="checked"&&(a.cached===!1||a.nextPagePath)).forEach(a=>{n.add(()=>Za(n,s,a,e,t))}),n.on("completed",()=>{let a=s.filter(u=>u.type==="file"&&u.status==="checked").length;i(a)}),await n.onIdle(),s},el=xp;var Sp=(r,e,t,i,n)=>{let s=e.filter(b=>b.isFolder===!0),o=e.filter(b=>b.isFolder===!1),a=t.type==="folder"&&t.status==="checked",u=s.map(b=>({type:"folder",id:b.requestPath,cached:!1,nextPagePath:null,status:a?"checked":"unchecked",parentId:t.id,data:b})),c=o.map(b=>{let x=n(b);return{type:"file",id:b.requestPath,restrictionError:x,status:a&&!x?"checked":"unchecked",parentId:t.id,data:b}}),p=I(m({},t),{cached:!0,nextPagePath:i});return[...r.map(b=>b.id===p.id?p:b),...u,...c]},tl=Sp;var Fp=(r,e,t,i,n)=>{let s=r.find(x=>x.id===e),o=t.filter(x=>x.isFolder===!0),a=t.filter(x=>x.isFolder===!1),u=I(m({},s),{nextPagePath:i}),c=r.map(x=>x.id===u.id?u:x),p=u.type==="folder"&&u.status==="checked",d=o.map(x=>({type:"folder",id:x.requestPath,cached:!1,nextPagePath:null,status:p?"checked":"unchecked",parentId:u.id,data:x})),v=a.map(x=>{let A=n(x);return{type:"file",id:x.requestPath,restrictionError:A,status:p&&!A?"checked":"unchecked",parentId:u.id,data:x}});return[...c,...d,...v]},rl=Fp;var Pn=(r,e,t)=>{r.filter(n=>n.type!=="root"&&n.parentId===e).forEach(n=>{n.status=t&&!(n.type==="file"&&n.restrictionError)?"checked":"unchecked",Pn(r,n.id,t)})},En=(r,e)=>{let t=r.find(o=>o.id===e);if(t.type==="root")return;let i=r.filter(o=>o.type!=="root"&&o.parentId===t.id&&!(o.type==="file"&&o.restrictionError)),n=i.every(o=>o.status==="checked"),s=i.every(o=>o.status==="unchecked");n?t.status="checked":s?t.status="unchecked":t.status="partial",En(r,t.parentId)},Pp=(r,e)=>{let t=Kr(r);if(e.length>=2){let i=t.filter(n=>n.type!=="root"&&e.includes(n.id));i.forEach(n=>{n.type==="file"?n.status=n.restrictionError?"unchecked":"checked":n.status="checked"}),i.forEach(n=>{Pn(t,n.id,!0)}),En(t,i[0].parentId)}else{let i=t.find(n=>n.id===e[0]);i.status=i.status==="checked"?"unchecked":"checked",Pn(t,i.id,i.status==="checked"),En(t,i.parentId)}return t},il=Pp;var ir={afterOpenFolder:tl,afterScrollFolder:rl,afterToggleCheckbox:il,afterFill:el};var Ep=r=>{let{scrollHeight:e,scrollTop:t,offsetHeight:i}=r.target;return e-(t+i)<50},nl=Ep;var sl=Y(ye(),1);function Tn(r){let{openFolder:e,title:t,breadcrumbsIcon:i,breadcrumbs:n,i18n:s}=r;return l("div",{className:"uppy-Provider-breadcrumbs",children:[l("div",{className:"uppy-Provider-breadcrumbsIcon",children:i}),n.map((o,a)=>l(ie,{children:[l("button",{type:"button",className:"uppy-u-reset uppy-c-btn",onClick:()=>e(o.id),children:o.type==="root"?t:o.data.name??s("unnamed")},o.id),n.length===a+1?"":" / "]}))]})}function kn({i18n:r,logout:e,username:t}){return l(ie,{children:[t&&l("span",{className:"uppy-ProviderBrowser-user",children:t},"username"),l("button",{type:"button",onClick:e,className:"uppy-u-reset uppy-c-btn uppy-ProviderBrowser-userLogout",children:r("logOut")},"logout")]})}function Cn(r){return l("div",{className:"uppy-ProviderBrowser-header",children:l("div",{className:(0,sl.default)("uppy-ProviderBrowser-headerBar",!r.showBreadcrumbs&&"uppy-ProviderBrowser-headerBar--simple"),children:[r.showBreadcrumbs&&l(Tn,{openFolder:r.openFolder,breadcrumbs:r.breadcrumbs,breadcrumbsIcon:r.pluginIcon?.(),title:r.title,i18n:r.i18n}),l(kn,{logout:r.logout,username:r.username,i18n:r.i18n})]})})}function nr(){return l("svg",{"aria-hidden":"true",focusable:"false",width:"30",height:"30",viewBox:"0 0 30 30",children:l("path",{d:"M15 30c8.284 0 15-6.716 15-15 0-8.284-6.716-15-15-15C6.716 0 0 6.716 0 15c0 8.284 6.716 15 15 15zm4.258-12.676v6.846h-8.426v-6.846H5.204l9.82-12.364 9.82 12.364H19.26z"})})}var ol=r=>({authenticated:void 0,partialTree:[{type:"root",id:r,cached:!1,nextPagePath:null}],currentFolderId:r,searchString:"",didFirstRender:!1,username:null,loading:!1}),Xr=class{static VERSION=La.version;plugin;provider;opts;isHandlingScroll=!1;lastCheckbox=null;constructor(e,t){this.plugin=e,this.provider=t.provider;let i={viewType:"list",showTitles:!0,showFilter:!0,showBreadcrumbs:!0,loadAllFiles:!1,virtualList:!1};this.opts=m(m({},i),t),this.openFolder=this.openFolder.bind(this),this.logout=this.logout.bind(this),this.handleAuth=this.handleAuth.bind(this),this.handleScroll=this.handleScroll.bind(this),this.resetPluginState=this.resetPluginState.bind(this),this.donePicking=this.donePicking.bind(this),this.render=this.render.bind(this),this.cancelSelection=this.cancelSelection.bind(this),this.toggleCheckbox=this.toggleCheckbox.bind(this),this.resetPluginState(),this.plugin.uppy.on("dashboard:close-panel",this.resetPluginState),this.plugin.uppy.registerRequestClient(this.provider.provider,this.provider)}resetPluginState(){this.plugin.setPluginState(ol(this.plugin.rootFolderId))}tearDown(){}setLoading(e){this.plugin.setPluginState({loading:e})}cancelSelection(){let{partialTree:e}=this.plugin.getPluginState(),t=e.map(i=>i.type==="root"?i:I(m({},i),{status:"unchecked"}));this.plugin.setPluginState({partialTree:t})}#e;async#t(e){this.#e?.abort();let t=new AbortController;this.#e=t;let i=()=>{t.abort()};try{this.plugin.uppy.on("dashboard:close-panel",i),this.plugin.uppy.on("cancel-all",i),await e(t.signal)}finally{this.plugin.uppy.off("dashboard:close-panel",i),this.plugin.uppy.off("cancel-all",i),this.#e=void 0}}async openFolder(e){this.lastCheckbox=null;let{partialTree:t}=this.plugin.getPluginState(),i=t.find(n=>n.id===e);if(i.cached){this.plugin.setPluginState({currentFolderId:e,searchString:""});return}this.setLoading(!0),await this.#t(async n=>{let s=e,o=[];do{let{username:u,nextPagePath:c,items:p}=await this.provider.list(s,{signal:n});this.plugin.setPluginState({username:u}),s=c,o=o.concat(p),this.setLoading(this.plugin.uppy.i18n("loadedXFiles",{numFiles:o.length}))}while(this.opts.loadAllFiles&&s);let a=ir.afterOpenFolder(t,o,i,s,this.validateSingleFile);this.plugin.setPluginState({partialTree:a,currentFolderId:e,searchString:""})}).catch(ct(this.plugin.uppy)),this.setLoading(!1)}async logout(){await this.#t(async e=>{let t=await this.provider.logout({signal:e});if(t.ok){if(!t.revoked){let i=this.plugin.uppy.i18n("companionUnauthorizeHint",{provider:this.plugin.title,url:t.manual_revoke_url});this.plugin.uppy.info(i,"info",7e3)}this.plugin.setPluginState(I(m({},ol(this.plugin.rootFolderId)),{authenticated:!1}))}}).catch(ct(this.plugin.uppy))}async handleAuth(e){await this.#t(async t=>{this.setLoading(!0),await this.provider.login({authFormData:e,signal:t}),this.plugin.setPluginState({authenticated:!0}),await Promise.all([this.provider.fetchPreAuthToken(),this.openFolder(this.plugin.rootFolderId)])}).catch(ct(this.plugin.uppy)),this.setLoading(!1)}async handleScroll(e){let{partialTree:t,currentFolderId:i}=this.plugin.getPluginState(),n=t.find(s=>s.id===i);nl(e)&&!this.isHandlingScroll&&n.nextPagePath&&(this.isHandlingScroll=!0,await this.#t(async s=>{let{nextPagePath:o,items:a}=await this.provider.list(n.nextPagePath,{signal:s}),u=ir.afterScrollFolder(t,i,a,o,this.validateSingleFile);this.plugin.setPluginState({partialTree:u})}).catch(ct(this.plugin.uppy)),this.isHandlingScroll=!1)}validateSingleFile=e=>{let t=Tr(e);return this.plugin.uppy.validateSingleFile(t)};async donePicking(){let{partialTree:e}=this.plugin.getPluginState();this.setLoading(!0),await this.#t(async t=>{let i=await ir.afterFill(e,o=>this.provider.list(o,{signal:t}),this.validateSingleFile,o=>{this.setLoading(this.plugin.uppy.i18n("addedNumFiles",{numFiles:o}))});if(this.validateAggregateRestrictions(i)){this.plugin.setPluginState({partialTree:i});return}let s=Ka(i);$a(s,this.plugin,this.provider),this.resetPluginState()}).catch(ct(this.plugin.uppy)),this.setLoading(!1)}toggleCheckbox(e,t){let{partialTree:i}=this.plugin.getPluginState(),n=Va(e.id,this.getDisplayedPartialTree(),t,this.lastCheckbox),s=ir.afterToggleCheckbox(i,n);this.plugin.setPluginState({partialTree:s}),this.lastCheckbox=e.id}getDisplayedPartialTree=()=>{let{partialTree:e,currentFolderId:t,searchString:i}=this.plugin.getPluginState(),n=e.filter(o=>o.type!=="root"&&o.parentId===t);return i===""?n:n.filter(o=>(o.data.name??this.plugin.uppy.i18n("unnamed")).toLowerCase().indexOf(i.toLowerCase())!==-1)};getBreadcrumbs=()=>{let{partialTree:e,currentFolderId:t}=this.plugin.getPluginState();return Wa(e,t)};getSelectedAmount=()=>{let{partialTree:e}=this.plugin.getPluginState();return $r(e)};validateAggregateRestrictions=e=>{let i=e.filter(n=>n.type==="file"&&n.status==="checked").map(n=>n.data);return this.plugin.uppy.validateAggregateRestrictions(i)};render(e,t={}){let{didFirstRender:i}=this.plugin.getPluginState(),{i18n:n}=this.plugin.uppy;i||(this.plugin.setPluginState({didFirstRender:!0}),this.provider.fetchPreAuthToken(),this.openFolder(this.plugin.rootFolderId));let s=m(m({},this.opts),t),{authenticated:o,loading:a}=this.plugin.getPluginState(),u=this.plugin.icon||nr;if(o===!1)return l(mn,{pluginName:this.plugin.title,pluginIcon:u,handleAuth:this.handleAuth,i18n:this.plugin.uppy.i18n,renderForm:s.renderAuthForm,loading:a});let{partialTree:c,username:p,searchString:d}=this.plugin.getPluginState(),v=this.getBreadcrumbs();return l("div",{className:(0,al.default)("uppy-ProviderBrowser",`uppy-ProviderBrowser-viewType--${s.viewType}`),children:[l(Cn,{showBreadcrumbs:s.showBreadcrumbs,openFolder:this.openFolder,breadcrumbs:v,pluginIcon:u,title:this.plugin.title,logout:this.logout,username:p,i18n:n}),s.showFilter&&l(qa,{searchString:d,setSearchString:b=>{this.plugin.setPluginState({searchString:b})},submitSearchString:()=>{},inputLabel:n("filter"),clearSearchLabel:n("resetFilter"),wrapperClassName:"uppy-ProviderBrowser-searchFilter",inputClassName:"uppy-ProviderBrowser-searchFilterInput"}),l(Ma,{toggleCheckbox:this.toggleCheckbox,displayedPartialTree:this.getDisplayedPartialTree(),openFolder:this.openFolder,virtualList:s.virtualList,noResultsLabel:n("noFilesFound"),handleScroll:this.handleScroll,viewType:s.viewType,showTitles:s.showTitles,i18n:this.plugin.uppy.i18n,isLoading:a,utmSource:"Companion"}),l(vn,{partialTree:c,donePicking:this.donePicking,cancelSelection:this.cancelSelection,i18n:n,validateAggregateRestrictions:this.validateAggregateRestrictions})]})}};var ll={name:"@uppy/dashboard",description:"Universal UI plugin for Uppy.",version:"5.0.2",license:"MIT",style:"dist/style.min.css",type:"module",sideEffects:["*.css"],scripts:{build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build",test:"vitest run --silent='passed-only'","test:e2e":"vitest watch --project browser --browser.headless false"},keywords:["file uploader","uppy","uppy-plugin","dashboard","ui"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],exports:{".":"./lib/index.js","./css/style.css":"./dist/style.css","./css/style.min.css":"./dist/style.min.css","./css/style.scss":"./src/style.scss","./package.json":"./package.json"},dependencies:{"@transloadit/prettier-bytes":"^0.3.4","@uppy/provider-views":"^5.0.2","@uppy/thumbnail-generator":"^5.0.1","@uppy/utils":"^7.0.2",classnames:"^2.2.6",lodash:"^4.17.21",nanoid:"^5.0.9",preact:"^10.5.13","shallow-equal":"^3.0.0"},devDependencies:{"@uppy/core":"^5.0.2","@uppy/google-drive":"^5.0.1","@uppy/url":"^5.0.1","@uppy/webcam":"^5.0.1","@vitest/browser":"^3.2.4",cssnano:"^7.0.7",jsdom:"^26.1.0",playwright:"1.54.1",postcss:"^8.5.6","postcss-cli":"^11.0.1","resize-observer-polyfill":"^1.5.0",sass:"^1.89.2",typescript:"^5.8.3",vitest:"^3.2.4"},peerDependencies:{"@uppy/core":"^5.0.2"}};var zl=Y(ye(),1);var Un=class extends pe{fileInput=null;folderInput=null;mobilePhotoFileInput=null;mobileVideoFileInput=null;triggerFileInputClick=()=>{this.fileInput?.click()};triggerFolderInputClick=()=>{this.folderInput?.click()};triggerVideoCameraInputClick=()=>{this.mobileVideoFileInput?.click()};triggerPhotoCameraInputClick=()=>{this.mobilePhotoFileInput?.click()};onFileInputChange=e=>{this.props.handleInputChange(e),e.currentTarget.value=""};renderHiddenInput=(e,t)=>l("input",{className:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabIndex:-1,webkitdirectory:e,type:"file",name:"files[]",multiple:this.props.maxNumberOfFiles!==1,onChange:this.onFileInputChange,accept:this.props.allowedFileTypes?.join(", "),ref:t});renderHiddenCameraInput=(e,t,i)=>{let s={photo:"image/*",video:"video/*"}[e];return l("input",{className:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabIndex:-1,type:"file",name:`camera-${e}`,onChange:this.onFileInputChange,capture:t===""?"environment":t,accept:s,ref:i})};renderMyDeviceAcquirer=()=>l("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MyDevice",children:l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerFileInputClick,children:[l("div",{className:"uppy-DashboardTab-inner",children:l("svg",{className:"uppy-DashboardTab-iconMyDevice","aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:l("path",{d:"M8.45 22.087l-1.305-6.674h17.678l-1.572 6.674H8.45zm4.975-12.412l1.083 1.765a.823.823 0 00.715.386h7.951V13.5H8.587V9.675h4.838zM26.043 13.5h-1.195v-2.598c0-.463-.336-.75-.798-.75h-8.356l-1.082-1.766A.823.823 0 0013.897 8H7.728c-.462 0-.815.256-.815.718V13.5h-.956a.97.97 0 00-.746.37.972.972 0 00-.19.81l1.724 8.565c.095.44.484.755.933.755H24c.44 0 .824-.3.929-.727l2.043-8.568a.972.972 0 00-.176-.825.967.967 0 00-.753-.38z",fill:"currentcolor","fill-rule":"evenodd"})})}),l("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("myDevice")})]})});renderPhotoCamera=()=>l("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MobilePhotoCamera",children:l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerPhotoCameraInputClick,children:[l("div",{className:"uppy-DashboardTab-inner",children:l("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:l("path",{d:"M23.5 9.5c1.417 0 2.5 1.083 2.5 2.5v9.167c0 1.416-1.083 2.5-2.5 2.5h-15c-1.417 0-2.5-1.084-2.5-2.5V12c0-1.417 1.083-2.5 2.5-2.5h2.917l1.416-2.167C13 7.167 13.25 7 13.5 7h5c.25 0 .5.167.667.333L20.583 9.5H23.5zM16 11.417a4.706 4.706 0 00-4.75 4.75 4.704 4.704 0 004.75 4.75 4.703 4.703 0 004.75-4.75c0-2.663-2.09-4.75-4.75-4.75zm0 7.825c-1.744 0-3.076-1.332-3.076-3.074 0-1.745 1.333-3.077 3.076-3.077 1.744 0 3.074 1.333 3.074 3.076s-1.33 3.075-3.074 3.075z",fill:"#02B383","fill-rule":"nonzero"})})}),l("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("takePictureBtn")})]})});renderVideoCamera=()=>l("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MobileVideoCamera",children:l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerVideoCameraInputClick,children:[l("div",{className:"uppy-DashboardTab-inner",children:l("svg",{"aria-hidden":"true",width:"32",height:"32",viewBox:"0 0 32 32",children:l("path",{fill:"#FF675E",fillRule:"nonzero",d:"m21.254 14.277 2.941-2.588c.797-.313 1.243.818 1.09 1.554-.01 2.094.02 4.189-.017 6.282-.126.915-1.145 1.08-1.58.34l-2.434-2.142c-.192.287-.504 1.305-.738.468-.104-1.293-.028-2.596-.05-3.894.047-.312.381.823.426 1.069.063-.384.206-.744.362-1.09zm-12.939-3.73c3.858.013 7.717-.025 11.574.02.912.129 1.492 1.237 1.351 2.217-.019 2.412.04 4.83-.03 7.239-.17 1.025-1.166 1.59-2.029 1.429-3.705-.012-7.41.025-11.114-.019-.913-.129-1.492-1.237-1.352-2.217.018-2.404-.036-4.813.029-7.214.136-.82.83-1.473 1.571-1.454z "})})}),l("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("recordVideoBtn")})]})});renderBrowseButton=(e,t)=>{let i=this.props.acquirers.length;return l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-Dashboard-browse",onClick:t,"data-uppy-super-focusable":i===0,children:e})};renderDropPasteBrowseTagline=e=>{let t=this.renderBrowseButton(this.props.i18n("browseFiles"),this.triggerFileInputClick),i=this.renderBrowseButton(this.props.i18n("browseFolders"),this.triggerFolderInputClick),n=this.props.fileManagerSelectionType,s=n.charAt(0).toUpperCase()+n.slice(1);return l("div",{class:"uppy-Dashboard-AddFiles-title",children:this.props.disableLocalFiles?this.props.i18n("importFiles"):e>0?this.props.i18nArray(`dropPasteImport${s}`,{browseFiles:t,browseFolders:i,browse:t}):this.props.i18nArray(`dropPaste${s}`,{browseFiles:t,browseFolders:i,browse:t})})};[Symbol.for("uppy test: disable unused locale key warning")](){this.props.i18nArray("dropPasteBoth"),this.props.i18nArray("dropPasteFiles"),this.props.i18nArray("dropPasteFolders"),this.props.i18nArray("dropPasteImportBoth"),this.props.i18nArray("dropPasteImportFiles"),this.props.i18nArray("dropPasteImportFolders")}renderAcquirer=e=>l("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":e.id,children:l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-cy":e.id,"aria-controls":`uppy-DashboardContent-panel--${e.id}`,"aria-selected":this.props.activePickerPanel?.id===e.id,"data-uppy-super-focusable":!0,onClick:()=>this.props.showPanel(e.id),children:[l("div",{className:"uppy-DashboardTab-inner",children:e.icon()}),l("div",{className:"uppy-DashboardTab-name",children:e.name})]})});renderAcquirers=e=>{let t=[...e],i=t.splice(e.length-2,e.length);return l(ie,{children:[t.map(n=>this.renderAcquirer(n)),l("span",{role:"presentation",style:{"white-space":"nowrap"},children:i.map(n=>this.renderAcquirer(n))})]})};renderSourcesList=(e,t)=>{let{showNativePhotoCameraButton:i,showNativeVideoCameraButton:n}=this.props,s=[],o="myDevice";t||s.push({key:o,elements:this.renderMyDeviceAcquirer()}),i&&s.push({key:"nativePhotoCameraButton",elements:this.renderPhotoCamera()}),n&&s.push({key:"nativePhotoCameraButton",elements:this.renderVideoCamera()}),s.push(...e.map(p=>({key:p.id,elements:this.renderAcquirer(p)}))),s.length===1&&s[0].key===o&&(s=[]);let u=[...s],c=u.splice(s.length-2,s.length);return l(ie,{children:[this.renderDropPasteBrowseTagline(s.length),l("div",{className:"uppy-Dashboard-AddFiles-list",role:"tablist",children:[u.map(({key:p,elements:d})=>l(ie,{children:d},p)),l("span",{role:"presentation",style:{"white-space":"nowrap"},children:c.map(({key:p,elements:d})=>l(ie,{children:d},p))})]})]})};renderPoweredByUppy(){let{i18nArray:e}=this.props,t=l("span",{children:[l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-Dashboard-poweredByIcon",width:"11",height:"11",viewBox:"0 0 11 11",children:l("path",{d:"M7.365 10.5l-.01-4.045h2.612L5.5.806l-4.467 5.65h2.604l.01 4.044h3.718z",fillRule:"evenodd"})}),l("span",{className:"uppy-Dashboard-poweredByUppy",children:"Uppy"})]}),i=e("poweredBy",{uppy:t});return l("a",{tabIndex:-1,href:"https://uppy.io",rel:"noreferrer noopener",target:"_blank",className:"uppy-Dashboard-poweredBy",children:i})}render(){let{showNativePhotoCameraButton:e,showNativeVideoCameraButton:t,nativeCameraFacingMode:i}=this.props;return l("div",{className:"uppy-Dashboard-AddFiles",children:[this.renderHiddenInput(!1,n=>{this.fileInput=n}),this.renderHiddenInput(!0,n=>{this.folderInput=n}),e&&this.renderHiddenCameraInput("photo",i,n=>{this.mobilePhotoFileInput=n}),t&&this.renderHiddenCameraInput("video",i,n=>{this.mobileVideoFileInput=n}),this.renderSourcesList(this.props.acquirers,this.props.disableLocalFiles),l("div",{className:"uppy-Dashboard-AddFiles-info",children:[this.props.note&&l("div",{className:"uppy-Dashboard-note",children:this.props.note}),this.props.proudlyDisplayPoweredByUppy&&this.renderPoweredByUppy()]})]})}},Yr=Un;var ul=Y(ye(),1);var kp=r=>l("div",{className:(0,ul.default)("uppy-Dashboard-AddFilesPanel",r.className),"data-uppy-panelType":"AddFiles","aria-hidden":!r.showAddFilesPanel,children:[l("div",{className:"uppy-DashboardContent-bar",children:[l("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:r.i18n("addingMoreFiles")}),l("button",{className:"uppy-DashboardContent-back",type:"button",onClick:()=>r.toggleAddFilesPanel(!1),children:r.i18n("back")})]}),l(Yr,m({},r))]}),dl=kp;var cl=Y(ye(),1);function Cp(r){let e=r.files[r.fileCardFor],t=()=>{r.uppy.emit("file-editor:cancel",e),r.closeFileEditor()};return l("div",{className:(0,cl.default)("uppy-DashboardContent-panel",r.className),role:"tabpanel","data-uppy-panelType":"FileEditor",id:"uppy-DashboardContent-panel--editor",children:[l("div",{className:"uppy-DashboardContent-bar",children:[l("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:r.i18nArray("editing",{file:l("span",{className:"uppy-DashboardContent-titleFile",children:e.meta?e.meta.name:e.name})})}),l("button",{className:"uppy-DashboardContent-back",type:"button",onClick:t,children:r.i18n("cancel")}),l("button",{className:"uppy-DashboardContent-save",type:"button",onClick:r.saveFileEditor,children:r.i18n("save")})]}),l("div",{className:"uppy-DashboardContent-panelBody",children:r.editors.map(i=>r.uppy.getPlugin(i.id).render(r.state))})]})}var pl=Cp;var hl=Y(ye(),1);function Up(){return l("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25",children:l("g",{fill:"#686DE0",fillRule:"evenodd",children:[l("path",{d:"M5 7v10h15V7H5zm0-1h15a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1z",fillRule:"nonzero"}),l("path",{d:"M6.35 17.172l4.994-5.026a.5.5 0 0 1 .707 0l2.16 2.16 3.505-3.505a.5.5 0 0 1 .707 0l2.336 2.31-.707.72-1.983-1.97-3.505 3.505a.5.5 0 0 1-.707 0l-2.16-2.159-3.938 3.939-1.409.026z",fillRule:"nonzero"}),l("circle",{cx:"7.5",cy:"9.5",r:"1.5"})]})})}function Ap(){return l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:l("path",{d:"M9.5 18.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V7.25a.5.5 0 0 1 .379-.485l9-2.25A.5.5 0 0 1 18.5 5v11.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V8.67l-8 2v7.97zm8-11v-2l-8 2v2l8-2zM7 19.64c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1zm9-2c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1z",fill:"#049BCF",fillRule:"nonzero"})})}function Op(){return l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:l("path",{d:"M16 11.834l4.486-2.691A1 1 0 0 1 22 10v6a1 1 0 0 1-1.514.857L16 14.167V17a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v2.834zM15 9H5v8h10V9zm1 4l5 3v-6l-5 3z",fill:"#19AF67",fillRule:"nonzero"})})}function Ip(){return l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:l("path",{d:"M9.766 8.295c-.691-1.843-.539-3.401.747-3.726 1.643-.414 2.505.938 2.39 3.299-.039.79-.194 1.662-.537 3.148.324.49.66.967 1.055 1.51.17.231.382.488.629.757 1.866-.128 3.653.114 4.918.655 1.487.635 2.192 1.685 1.614 2.84-.566 1.133-1.839 1.084-3.416.249-1.141-.604-2.457-1.634-3.51-2.707a13.467 13.467 0 0 0-2.238.426c-1.392 4.051-4.534 6.453-5.707 4.572-.986-1.58 1.38-4.206 4.914-5.375.097-.322.185-.656.264-1.001.08-.353.306-1.31.407-1.737-.678-1.059-1.2-2.031-1.53-2.91zm2.098 4.87c-.033.144-.068.287-.104.427l.033-.01-.012.038a14.065 14.065 0 0 1 1.02-.197l-.032-.033.052-.004a7.902 7.902 0 0 1-.208-.271c-.197-.27-.38-.526-.555-.775l-.006.028-.002-.003c-.076.323-.148.632-.186.8zm5.77 2.978c1.143.605 1.832.632 2.054.187.26-.519-.087-1.034-1.113-1.473-.911-.39-2.175-.608-3.55-.608.845.766 1.787 1.459 2.609 1.894zM6.559 18.789c.14.223.693.16 1.425-.413.827-.648 1.61-1.747 2.208-3.206-2.563 1.064-4.102 2.867-3.633 3.62zm5.345-10.97c.088-1.793-.351-2.48-1.146-2.28-.473.119-.564 1.05-.056 2.405.213.566.52 1.188.908 1.859.18-.858.268-1.453.294-1.984z",fill:"#E2514A",fillRule:"nonzero"})})}function Rp(){return l("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25",children:l("path",{d:"M10.45 2.05h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V2.55a.5.5 0 0 1 .5-.5zm2.05 1.024h1.05a.5.5 0 0 1 .5.5V3.6a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5v-.001zM10.45 0h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V.5a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 3.074h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 1.024h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm-2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-1.656 3.074l-.82 5.946c.52.302 1.174.458 1.976.458.803 0 1.455-.156 1.975-.458l-.82-5.946h-2.311zm0-1.025h2.312c.512 0 .946.378 1.015.885l.82 5.946c.056.412-.142.817-.501 1.026-.686.398-1.515.597-2.49.597-.974 0-1.804-.199-2.49-.597a1.025 1.025 0 0 1-.5-1.026l.819-5.946c.07-.507.503-.885 1.015-.885zm.545 6.6a.5.5 0 0 1-.397-.561l.143-.999a.5.5 0 0 1 .495-.429h.74a.5.5 0 0 1 .495.43l.143.998a.5.5 0 0 1-.397.561c-.404.08-.819.08-1.222 0z",fill:"#00C469",fillRule:"nonzero"})})}function Np(){return l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:l("g",{fill:"#A7AFB7",fillRule:"nonzero",children:[l("path",{d:"M5.5 22a.5.5 0 0 1-.5-.5v-18a.5.5 0 0 1 .5-.5h10.719a.5.5 0 0 1 .367.16l3.281 3.556a.5.5 0 0 1 .133.339V21.5a.5.5 0 0 1-.5.5h-14zm.5-1h13V7.25L16 4H6v17z"}),l("path",{d:"M15 4v3a1 1 0 0 0 1 1h3V7h-3V4h-1z"})]})})}function Bp(){return l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:l("path",{d:"M4.5 7h13a.5.5 0 1 1 0 1h-13a.5.5 0 0 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h10a.5.5 0 1 1 0 1h-10a.5.5 0 1 1 0-1z",fill:"#5A5E69",fillRule:"nonzero"})})}function Ke(r){let e={color:"#838999",icon:Np()};if(!r)return e;let t=r.split("/")[0],i=r.split("/")[1];return t==="text"?{color:"#5a5e69",icon:Bp()}:t==="image"?{color:"#686de0",icon:Up()}:t==="audio"?{color:"#068dbb",icon:Ap()}:t==="video"?{color:"#19af67",icon:Op()}:t==="application"&&i==="pdf"?{color:"#e25149",icon:Ip()}:t==="application"&&["zip","x-7z-compressed","x-zip-compressed","x-rar-compressed","x-tar","x-gzip","x-apple-diskimage"].indexOf(i)!==-1?{color:"#00C469",icon:Rp()}:e}function Dp(r){let{tagName:e}=r.target;if(e==="INPUT"||e==="TEXTAREA"){r.stopPropagation();return}r.preventDefault(),r.stopPropagation()}var Ue=Dp;function sr(r){let{file:e}=r;if(e.preview)return l("img",{draggable:!1,className:"uppy-Dashboard-Item-previewImg",alt:e.name,src:e.preview});let{color:t,icon:i}=Ke(e.type);return l("div",{className:"uppy-Dashboard-Item-previewIconWrap",children:[l("span",{className:"uppy-Dashboard-Item-previewIcon",style:{color:t},children:i}),l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-Dashboard-Item-previewIconBg",width:"58",height:"76",viewBox:"0 0 58 76",children:l("rect",{fill:"#FFF",width:"58",height:"76",rx:"3",fillRule:"evenodd"})})]})}function An(r){let{computedMetaFields:e,requiredMetaFields:t,updateMeta:i,form:n,formState:s}=r,o={text:"uppy-u-reset uppy-c-textInput uppy-Dashboard-FileCard-input"};return e.map(a=>{let u=`uppy-Dashboard-FileCard-input-${a.id}`,c=t.includes(a.id);return l("fieldset",{className:"uppy-Dashboard-FileCard-fieldset",children:[l("label",{className:"uppy-Dashboard-FileCard-label",htmlFor:u,children:a.name}),a.render!==void 0?a.render({value:s[a.id],onChange:p=>i(p,a.id),fieldCSSClasses:o,required:c,form:n.id},Lt):l("input",{className:o.text,id:u,form:n.id,type:a.type||"text",required:c,value:s[a.id],placeholder:a.placeholder,onInput:p=>i(p.target.value,a.id),"data-uppy-super-focusable":!0})]},a.id)})}function On(r){let{files:e,fileCardFor:t,toggleFileCard:i,saveFileCard:n,metaFields:s,requiredMetaFields:o,openFileEditor:a,i18n:u,i18nArray:c,className:p,canEditFile:d}=r,v=()=>typeof s=="function"?s(e[t]):s,b=e[t],x=v()??[],A=d(b),C={};x.forEach(D=>{C[D.id]=b.meta[D.id]??""});let[U,P]=we(C),k=Te(D=>{D.preventDefault(),n(U,t)},[n,U,t]),B=(D,V)=>{P(I(m({},U),{[V]:D}))},j=()=>{i(!1)},[N]=we(()=>{let D=document.createElement("form");return D.setAttribute("tabindex","-1"),D.id=De(),D});return Ee(()=>(document.body.appendChild(N),N.addEventListener("submit",k),()=>{N.removeEventListener("submit",k),N.parentNode&&document.body.removeChild(N)}),[N,k]),l("div",{className:(0,hl.default)("uppy-Dashboard-FileCard",p),"data-uppy-panelType":"FileCard",onDragOver:Ue,onDragLeave:Ue,onDrop:Ue,onPaste:Ue,children:[l("div",{className:"uppy-DashboardContent-bar",children:[l("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:c("editing",{file:l("span",{className:"uppy-DashboardContent-titleFile",children:b.meta?b.meta.name:b.name})})}),l("button",{className:"uppy-DashboardContent-back",type:"button",form:N.id,title:u("finishEditingFile"),onClick:j,children:u("cancel")})]}),l("div",{className:"uppy-Dashboard-FileCard-inner",children:[l("div",{className:"uppy-Dashboard-FileCard-preview",style:{backgroundColor:Ke(b.type).color},children:[l(sr,{file:b}),A&&l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-Dashboard-FileCard-edit",onClick:D=>{k(D),a(b)},children:u("editImage")})]}),l("div",{className:"uppy-Dashboard-FileCard-info",children:l(An,{computedMetaFields:x,requiredMetaFields:o,updateMeta:B,form:N,formState:U})}),l("div",{className:"uppy-Dashboard-FileCard-actions",children:[l("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Dashboard-FileCard-actionsBtn",type:"submit",form:N.id,children:u("saveChanges")}),l("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-link uppy-Dashboard-FileCard-actionsBtn",type:"button",onClick:j,form:N.id,children:u("cancel")})]})]})]})}var yl=Y(ye(),1);function fl(r,e){if(r===e)return!0;if(!r||!e)return!1;let t=Object.keys(r),i=Object.keys(e),n=t.length;if(i.length!==n)return!1;for(let s=0;s<n;s++){let o=t[s];if(r[o]!==e[o]||!Object.prototype.hasOwnProperty.call(e,o))return!1}return!0}function In(r,e="Copy the URL below"){return new Promise(t=>{let i=document.createElement("textarea");i.setAttribute("style",{position:"fixed",top:0,left:0,width:"2em",height:"2em",padding:0,border:"none",outline:"none",boxShadow:"none",background:"transparent"}),i.value=r,document.body.appendChild(i),i.select();let n=()=>{document.body.removeChild(i),window.prompt(e,r),t()};try{return document.execCommand("copy")?(document.body.removeChild(i),t()):n()}catch{return document.body.removeChild(i),n()}})}function Lp({file:r,uploadInProgressOrComplete:e,metaFields:t,canEditFile:i,i18n:n,onClick:s}){return!e&&t&&t.length>0||!e&&i(r)?l("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-action uppy-Dashboard-Item-action--edit",type:"button","aria-label":n("editFileWithFilename",{file:r.meta.name}),title:n("editFileWithFilename",{file:r.meta.name}),onClick:()=>s(),children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 14",children:l("g",{fillRule:"evenodd",children:[l("path",{d:"M1.5 10.793h2.793A1 1 0 0 0 5 10.5L11.5 4a1 1 0 0 0 0-1.414L9.707.793a1 1 0 0 0-1.414 0l-6.5 6.5A1 1 0 0 0 1.5 8v2.793zm1-1V8L9 1.5l1.793 1.793-6.5 6.5H2.5z",fillRule:"nonzero"}),l("rect",{x:"1",y:"12.293",width:"11",height:"1",rx:".5"}),l("path",{fillRule:"nonzero",d:"M6.793 2.5L9.5 5.207l.707-.707L7.5 1.793z"})]})})}):null}function jp({i18n:r,onClick:e,file:t}){return l("button",{className:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--remove",type:"button","aria-label":r("removeFile",{file:t.meta.name}),title:r("removeFile",{file:t.meta.name}),onClick:()=>e(),children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"18",height:"18",viewBox:"0 0 18 18",children:[l("path",{d:"M9 0C4.034 0 0 4.034 0 9s4.034 9 9 9 9-4.034 9-9-4.034-9-9-9z"}),l("path",{fill:"#FFF",d:"M13 12.222l-.778.778L9 9.778 5.778 13 5 12.222 8.222 9 5 5.778 5.778 5 9 8.222 12.222 5l.778.778L9.778 9z"})]})})}function Mp({file:r,uppy:e,i18n:t}){let i=n=>{In(r.uploadURL,t("copyLinkToClipboardFallback")).then(()=>{e.log("Link copied to clipboard."),e.info(t("copyLinkToClipboardSuccess"),"info",3e3)}).catch(e.log).then(()=>n.target.focus({preventScroll:!0}))};return l("button",{className:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--copyLink",type:"button","aria-label":t("copyLink"),title:t("copyLink"),onClick:n=>i(n),children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 12",children:l("path",{d:"M7.94 7.703a2.613 2.613 0 0 1-.626 2.681l-.852.851a2.597 2.597 0 0 1-1.849.766A2.616 2.616 0 0 1 2.764 7.54l.852-.852a2.596 2.596 0 0 1 2.69-.625L5.267 7.099a1.44 1.44 0 0 0-.833.407l-.852.851a1.458 1.458 0 0 0 1.03 2.486c.39 0 .755-.152 1.03-.426l.852-.852c.231-.231.363-.522.406-.824l1.04-1.038zm4.295-5.937A2.596 2.596 0 0 0 10.387 1c-.698 0-1.355.272-1.849.766l-.852.851a2.614 2.614 0 0 0-.624 2.688l1.036-1.036c.041-.304.173-.6.407-.833l.852-.852c.275-.275.64-.426 1.03-.426a1.458 1.458 0 0 1 1.03 2.486l-.852.851a1.442 1.442 0 0 1-.824.406l-1.04 1.04a2.596 2.596 0 0 0 2.683-.628l.851-.85a2.616 2.616 0 0 0 0-3.697zm-6.88 6.883a.577.577 0 0 0 .82 0l3.474-3.474a.579.579 0 1 0-.819-.82L5.355 7.83a.579.579 0 0 0 0 .819z"})})})}function Rn(r){let{uppy:e,file:t,uploadInProgressOrComplete:i,canEditFile:n,metaFields:s,showLinkToFileUploadResult:o,showRemoveButton:a,i18n:u,toggleFileCard:c,openFileEditor:p}=r;return l("div",{className:"uppy-Dashboard-Item-actionWrapper",children:[l(Lp,{i18n:u,file:t,uploadInProgressOrComplete:i,canEditFile:n,metaFields:s,onClick:()=>{s&&s.length>0?c(!0,t.id):p(t)}}),o&&t.uploadURL?l(Mp,{file:t,uppy:e,i18n:u}):null,a?l(jp,{i18n:u,file:t,onClick:()=>e.removeFile(t.id)}):null]})}var ml=Y(qt(),1);var zp=(r,e)=>(typeof e=="function"?e():e).filter(n=>n.id===r)[0].name;function or(r){let{file:e,toggleFileCard:t,i18n:i,metaFields:n}=r,{missingRequiredMetaFields:s}=e;if(!s?.length)return null;let o=s.map(a=>zp(a,n)).join(", ");return l("div",{className:"uppy-Dashboard-Item-errorMessage",children:[i("missingRequiredMetaFields",{smart_count:s.length,fields:o})," ",l("button",{type:"button",class:"uppy-u-reset uppy-Dashboard-Item-errorMessageBtn",onClick:()=>t(!0,e.id),children:i("editFile")})]})}var qp=r=>{let{author:e,name:t}=r.file.meta;function i(){return r.isSingleFile&&r.containerHeight>=350?90:r.containerWidth<=352?35:r.containerWidth<=576?60:e?20:30}return l("div",{className:"uppy-Dashboard-Item-name",title:t,children:It(t,i())})},Hp=r=>{let{author:e}=r.file.meta,t=r.file.remote?.providerName,i="\xB7";return e?l("div",{className:"uppy-Dashboard-Item-author",children:[l("a",{href:`${e.url}?utm_source=Companion&utm_medium=referral`,target:"_blank",rel:"noopener noreferrer",children:It(e.name,13)}),t?l(ie,{children:[` ${i} `,t,` ${i} `]}):null]}):null},$p=r=>r.file.size&&l("div",{className:"uppy-Dashboard-Item-statusSize",children:(0,ml.default)(r.file.size)}),Vp=r=>r.file.isGhost&&l("span",{children:[" \u2022 ",l("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-reSelect",type:"button",onClick:()=>r.toggleAddFilesPanel(!0),children:r.i18n("reSelect")})]}),Wp=({file:r,onClick:e})=>r.error?l("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-errorDetails","aria-label":r.error,"data-microtip-position":"bottom","data-microtip-size":"medium",onClick:e,type:"button",children:"?"}):null;function Nn(r){let{file:e,i18n:t,toggleFileCard:i,metaFields:n,toggleAddFilesPanel:s,isSingleFile:o,containerHeight:a,containerWidth:u}=r;return l("div",{className:"uppy-Dashboard-Item-fileInfo","data-uppy-file-source":e.source,children:[l("div",{className:"uppy-Dashboard-Item-fileName",children:[qp({file:e,isSingleFile:o,containerHeight:a,containerWidth:u}),l(Wp,{file:e,onClick:()=>alert(e.error)})]}),l("div",{className:"uppy-Dashboard-Item-status",children:[Hp({file:e}),$p({file:e}),Vp({file:e,toggleAddFilesPanel:s,i18n:t})]}),l(or,{file:e,i18n:t,toggleFileCard:i,metaFields:n})]})}function Bn(r){let{file:e,i18n:t,toggleFileCard:i,metaFields:n,showLinkToFileUploadResult:s}=r,a=e.preview?"rgba(255, 255, 255, 0.5)":Ke(e.type).color;return l("div",{className:"uppy-Dashboard-Item-previewInnerWrap",style:{backgroundColor:a},children:[s&&e.uploadURL&&l("a",{className:"uppy-Dashboard-Item-previewLink",href:e.uploadURL,rel:"noreferrer noopener",target:"_blank","aria-label":e.meta.name,children:l("span",{hidden:!0,children:e.meta.name})}),l(sr,{file:e}),l(or,{file:e,i18n:t,toggleFileCard:i,metaFields:n})]})}function Gp(r){if(!r.isUploaded){if(r.error&&!r.hideRetryButton){r.uppy.retryUpload(r.file.id);return}r.resumableUploads&&!r.hidePauseResumeButton?r.uppy.pauseResume(r.file.id):r.individualCancellation&&!r.hideCancelButton&&r.uppy.removeFile(r.file.id)}}function gl(r){return r.isUploaded?r.i18n("uploadComplete"):r.error?r.i18n("retryUpload"):r.resumableUploads?r.file.isPaused?r.i18n("resumeUpload"):r.i18n("pauseUpload"):r.individualCancellation?r.i18n("cancelUpload"):""}function Dn(r){return l("div",{className:"uppy-Dashboard-Item-progress",children:l("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-progressIndicator",type:"button","aria-label":gl(r),title:gl(r),onClick:()=>Gp(r),children:r.children})})}function Qr({children:r}){return l("svg",{"aria-hidden":"true",focusable:"false",width:"70",height:"70",viewBox:"0 0 36 36",className:"uppy-c-icon uppy-Dashboard-Item-progressIcon--circle",children:r})}function Ln({progress:r}){let e=2*Math.PI*15;return l("g",{children:[l("circle",{className:"uppy-Dashboard-Item-progressIcon--bg",r:"15",cx:"18",cy:"18","stroke-width":"2",fill:"none"}),l("circle",{className:"uppy-Dashboard-Item-progressIcon--progress",r:"15",cx:"18",cy:"18",transform:"rotate(-90, 18, 18)",fill:"none","stroke-width":"2","stroke-dasharray":e,"stroke-dashoffset":e-e/100*r})]})}function jn(r){return!r.file.progress.uploadStarted||r.file.progress.percentage===void 0?null:r.isUploaded?l("div",{className:"uppy-Dashboard-Item-progress",children:l("div",{className:"uppy-Dashboard-Item-progressIndicator",children:l(Qr,{children:[l("circle",{r:"15",cx:"18",cy:"18",fill:"#1bb240"}),l("polygon",{className:"uppy-Dashboard-Item-progressIcon--check",transform:"translate(2, 3)",points:"14 22.5 7 15.2457065 8.99985857 13.1732815 14 18.3547104 22.9729883 9 25 11.1005634"})]})})}):r.recoveredState?null:r.error&&!r.hideRetryButton?l(Dn,I(m({},r),{children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-Dashboard-Item-progressIcon--retry",width:"28",height:"31",viewBox:"0 0 16 19",children:[l("path",{d:"M16 11a8 8 0 1 1-8-8v2a6 6 0 1 0 6 6h2z"}),l("path",{d:"M7.9 3H10v2H7.9z"}),l("path",{d:"M8.536.5l3.535 3.536-1.414 1.414L7.12 1.914z"}),l("path",{d:"M10.657 2.621l1.414 1.415L8.536 7.57 7.12 6.157z"})]})})):r.resumableUploads&&!r.hidePauseResumeButton?l(Dn,I(m({},r),{children:l(Qr,{children:[l(Ln,{progress:r.file.progress.percentage}),r.file.isPaused?l("polygon",{className:"uppy-Dashboard-Item-progressIcon--play",transform:"translate(3, 3)",points:"12 20 12 10 20 15"}):l("g",{className:"uppy-Dashboard-Item-progressIcon--pause",transform:"translate(14.5, 13)",children:[l("rect",{x:"0",y:"0",width:"2",height:"10",rx:"0"}),l("rect",{x:"5",y:"0",width:"2",height:"10",rx:"0"})]})]})})):!r.resumableUploads&&r.individualCancellation&&!r.hideCancelButton?l(Dn,I(m({},r),{children:l(Qr,{children:[l(Ln,{progress:r.file.progress.percentage}),l("polygon",{className:"cancel",transform:"translate(2, 2)",points:"19.8856516 11.0625 16 14.9481516 12.1019737 11.0625 11.0625 12.1143484 14.9481516 16 11.0625 19.8980263 12.1019737 20.9375 16 17.0518484 19.8856516 20.9375 20.9375 19.8980263 17.0518484 16 20.9375 12"})]})})):l("div",{className:"uppy-Dashboard-Item-progress",children:l("div",{className:"uppy-Dashboard-Item-progressIndicator",children:l(Qr,{children:l(Ln,{progress:r.file.progress.percentage})})})})}var Jr=class extends pe{componentDidMount(){let{file:e}=this.props;e.preview||this.props.handleRequestThumbnail(e)}shouldComponentUpdate(e){return!fl(this.props,e)}componentDidUpdate(){let{file:e}=this.props;e.preview||this.props.handleRequestThumbnail(e)}componentWillUnmount(){let{file:e}=this.props;e.preview||this.props.handleCancelThumbnail(e)}render(){let{file:e}=this.props,t=e.progress.preprocess||e.progress.postprocess,i=!!e.progress.uploadComplete&&!t&&!e.error,n=!!e.progress.uploadStarted||!!t,s=e.progress.uploadStarted&&!e.progress.uploadComplete||t,o=e.error||!1,{isGhost:a}=e,u=(this.props.individualCancellation||!s)&&!i;i&&this.props.showRemoveButtonAfterComplete&&(u=!0);let c=(0,yl.default)({"uppy-Dashboard-Item":!0,"is-inprogress":s&&!this.props.recoveredState,"is-processing":t,"is-complete":i,"is-error":!!o,"is-resumable":this.props.resumableUploads,"is-noIndividualCancellation":!this.props.individualCancellation,"is-ghost":a});return l("div",{className:c,id:`uppy_${e.id}`,role:this.props.role,children:[l("div",{className:"uppy-Dashboard-Item-preview",children:[l(Bn,{file:e,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,i18n:this.props.i18n,toggleFileCard:this.props.toggleFileCard,metaFields:this.props.metaFields}),l(jn,{uppy:this.props.uppy,file:e,error:o,isUploaded:i,hideRetryButton:this.props.hideRetryButton,hideCancelButton:this.props.hideCancelButton,hidePauseResumeButton:this.props.hidePauseResumeButton,recoveredState:this.props.recoveredState,resumableUploads:this.props.resumableUploads,individualCancellation:this.props.individualCancellation,i18n:this.props.i18n})]}),l("div",{className:"uppy-Dashboard-Item-fileInfoAndButtons",children:[l(Nn,{file:e,containerWidth:this.props.containerWidth,containerHeight:this.props.containerHeight,i18n:this.props.i18n,toggleAddFilesPanel:this.props.toggleAddFilesPanel,toggleFileCard:this.props.toggleFileCard,metaFields:this.props.metaFields,isSingleFile:this.props.isSingleFile}),l(Rn,{file:e,metaFields:this.props.metaFields,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,showRemoveButton:u,canEditFile:this.props.canEditFile,uploadInProgressOrComplete:n,toggleFileCard:this.props.toggleFileCard,openFileEditor:this.props.openFileEditor,uppy:this.props.uppy,i18n:this.props.i18n})]})]})}};function Kp(r,e){let t=[],i=[];return r.forEach(n=>{i.length<e?i.push(n):(t.push(i),i=[n])}),i.length&&t.push(i),t}function Mn({id:r,i18n:e,uppy:t,files:i,resumableUploads:n,hideRetryButton:s,hidePauseResumeButton:o,hideCancelButton:a,showLinkToFileUploadResult:u,showRemoveButtonAfterComplete:c,metaFields:p,isSingleFile:d,toggleFileCard:v,handleRequestThumbnail:b,handleCancelThumbnail:x,recoveredState:A,individualCancellation:C,itemsPerRow:U,openFileEditor:P,canEditFile:k,toggleAddFilesPanel:B,containerWidth:j,containerHeight:N}){let D=U===1?71:200,V=$e(()=>{let ue=(se,oe)=>Number(i[oe].isGhost)-Number(i[se].isGhost),K=Object.keys(i);return A&&K.sort(ue),Kp(K,U)},[i,U,A]),G=ue=>l("div",{class:"uppy-Dashboard-filesInner",role:"presentation",children:ue.map(K=>l(Jr,{uppy:t,id:r,i18n:e,resumableUploads:n,individualCancellation:C,hideRetryButton:s,hidePauseResumeButton:o,hideCancelButton:a,showLinkToFileUploadResult:u,showRemoveButtonAfterComplete:c,metaFields:p,recoveredState:A,isSingleFile:d,containerWidth:j,containerHeight:N,toggleFileCard:v,handleRequestThumbnail:b,handleCancelThumbnail:x,role:"listitem",openFileEditor:P,canEditFile:k,toggleAddFilesPanel:B,file:i[K]},K))},ue[0]);return d?l("div",{class:"uppy-Dashboard-files",children:G(V[0])}):l(nt,{class:"uppy-Dashboard-files",role:"list",data:V,renderRow:G,rowHeight:D})}var bl=300,Zr=class extends pe{ref=to();componentWillEnter(e){this.ref.current.style.opacity="1",this.ref.current.style.transform="none",setTimeout(e,bl)}componentWillLeave(e){this.ref.current.style.opacity="0",this.ref.current.style.transform="translateY(350%)",setTimeout(e,bl)}render(){let{children:e}=this.props;return l("div",{className:"uppy-Informer-animated",ref:this.ref,children:e})}};function Xp(r,e){return Object.assign(r,e)}function Yp(r,e){return r?.key??e}function Qp(r,e){let t=r._ptgLinkedRefs||(r._ptgLinkedRefs={});return t[e]||(t[e]=i=>{r.refs[e]=i})}function ar(r){let e={};for(let t=0;t<r.length;t++)if(r[t]!=null){let i=Yp(r[t],t.toString(36));e[i]=r[t]}return e}function Jp(r,e){r=r||{},e=e||{};let t=o=>Object.hasOwn(e,o)?e[o]:r[o],i={},n=[];for(let o in r)Object.hasOwn(e,o)?n.length&&(i[o]=n,n=[]):n.push(o);let s={};for(let o in e){if(Object.hasOwn(i,o))for(let a=0;a<i[o].length;a++){let u=i[o][a];s[i[o][a]]=t(u)}s[o]=t(o)}for(let o=0;o<n.length;o++)s[n[o]]=t(n[o]);return s}var Zp=r=>r,eh=(()=>{class r extends pe{constructor(t,i){super(t,i),this.refs={},this.state={children:ar(Ce(Ce(this.props.children))||[])},this.performAppear=this.performAppear.bind(this),this.performEnter=this.performEnter.bind(this),this.performLeave=this.performLeave.bind(this)}componentWillMount(){this.currentlyTransitioningKeys={},this.keysToAbortLeave=[],this.keysToEnter=[],this.keysToLeave=[]}componentDidMount(){let t=this.state.children;for(let i in t)t[i]&&this.performAppear(i)}componentWillReceiveProps(t){let i=ar(Ce(t.children)||[]),n=this.state.children;this.setState(o=>({children:Jp(o.children,i)}));let s;for(s in i)if(Object.hasOwn(i,s)){let o=n&&Object.hasOwn(n,s);i[s]&&o&&this.currentlyTransitioningKeys[s]?(this.keysToEnter.push(s),this.keysToAbortLeave.push(s)):i[s]&&!o&&!this.currentlyTransitioningKeys[s]&&this.keysToEnter.push(s)}for(s in n)if(Object.hasOwn(n,s)){let o=i&&Object.hasOwn(i,s);n[s]&&!o&&!this.currentlyTransitioningKeys[s]&&this.keysToLeave.push(s)}}componentDidUpdate(){let{keysToEnter:t}=this;this.keysToEnter=[],t.forEach(this.performEnter);let{keysToLeave:i}=this;this.keysToLeave=[],i.forEach(this.performLeave)}_finishAbort(t){let i=this.keysToAbortLeave.indexOf(t);i!==-1&&this.keysToAbortLeave.splice(i,1)}performAppear(t){this.currentlyTransitioningKeys[t]=!0;let i=this.refs[t];i?.componentWillAppear?i.componentWillAppear(this._handleDoneAppearing.bind(this,t)):this._handleDoneAppearing(t)}_handleDoneAppearing(t){let i=this.refs[t];i?.componentDidAppear&&i.componentDidAppear(),delete this.currentlyTransitioningKeys[t],this._finishAbort(t);let n=ar(Ce(this.props.children)||[]);(!n||!Object.hasOwn(n,t))&&this.performLeave(t)}performEnter(t){this.currentlyTransitioningKeys[t]=!0;let i=this.refs[t];i?.componentWillEnter?i.componentWillEnter(this._handleDoneEntering.bind(this,t)):this._handleDoneEntering(t)}_handleDoneEntering(t){let i=this.refs[t];i?.componentDidEnter&&i.componentDidEnter(),delete this.currentlyTransitioningKeys[t],this._finishAbort(t);let n=ar(Ce(this.props.children)||[]);(!n||!Object.hasOwn(n,t))&&this.performLeave(t)}performLeave(t){if(this.keysToAbortLeave.indexOf(t)!==-1)return;this.currentlyTransitioningKeys[t]=!0;let n=this.refs[t];n?.componentWillLeave?n.componentWillLeave(this._handleDoneLeaving.bind(this,t)):this._handleDoneLeaving(t)}_handleDoneLeaving(t){if(this.keysToAbortLeave.indexOf(t)!==-1)return;let n=this.refs[t];n?.componentDidLeave&&n.componentDidLeave(),delete this.currentlyTransitioningKeys[t];let s=ar(Ce(this.props.children)||[]);if(s&&Object.hasOwn(s,t))this.performEnter(t);else{let o=Xp({},this.state.children);delete o[t],this.setState({children:o})}}render(b,{children:v}){var x=b,{childFactory:t,transitionLeave:i,transitionName:n,transitionAppear:s,transitionEnter:o,transitionLeaveTimeout:a,transitionEnterTimeout:u,transitionAppearTimeout:c,component:p}=x,d=et(x,["childFactory","transitionLeave","transitionName","transitionAppear","transitionEnter","transitionLeaveTimeout","transitionEnterTimeout","transitionAppearTimeout","component"]);let A=Object.entries(v).map(([C,U])=>{if(!U)return;let P=Qp(this,C);return Ur(t(U),{ref:P,key:C})}).filter(Boolean);return Lt(p,d,A)}}return r.defaultProps={component:"span",childFactory:Zp},r})(),vl=eh;var lr=class extends pe{render(){let{info:e}=this.props.uppy.getState();return l("div",{className:"uppy uppy-Informer",children:l(vl,{children:e.map(t=>l(Zr,{children:l("p",{role:"alert",children:[t.message," ",t.details&&l("span",{"aria-label":t.details,"data-microtip-position":"top-left","data-microtip-size":"medium",role:"tooltip",onClick:()=>alert(`${t.message} 

 ${t.details}`),children:"?"})]})},t.message))})})}};var wl=Y(ye(),1);function th({activePickerPanel:r,className:e,hideAllPanels:t,i18n:i,state:n,uppy:s}){let o=Be(null);return l("div",{className:(0,wl.default)("uppy-DashboardContent-panel",e),role:"tabpanel","data-uppy-panelType":"PickerPanel",id:`uppy-DashboardContent-panel--${r.id}`,onDragOver:Ue,onDragLeave:Ue,onDrop:Ue,onPaste:Ue,children:[l("div",{className:"uppy-DashboardContent-bar",children:[l("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:i("importFrom",{name:r.name})}),l("button",{className:"uppy-DashboardContent-back",type:"button",onClick:t,children:i("cancel")})]}),l("div",{ref:o,className:"uppy-DashboardContent-panelBody",children:s.getPlugin(r.id).render(n,o.current)})]})}var _l=th;var Ae={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete",STATE_PAUSED:"paused"};function rh(r,e,t,i={}){if(r)return Ae.STATE_ERROR;if(e)return Ae.STATE_COMPLETE;if(t)return Ae.STATE_PAUSED;let n=Ae.STATE_WAITING,s=Object.keys(i);for(let o=0;o<s.length;o++){let{progress:a}=i[s[o]];if(a.uploadStarted&&!a.uploadComplete)return Ae.STATE_UPLOADING;a.preprocess&&n!==Ae.STATE_UPLOADING&&(n=Ae.STATE_PREPROCESSING),a.postprocess&&n!==Ae.STATE_UPLOADING&&n!==Ae.STATE_PREPROCESSING&&(n=Ae.STATE_POSTPROCESSING)}return n}function ih({files:r,i18n:e,isAllComplete:t,isAllErrored:i,isAllPaused:n,inProgressNotPausedFiles:s,newFiles:o,processingFiles:a}){switch(rh(i,t,n,r)){case"uploading":return e("uploadingXFiles",{smart_count:s.length});case"preprocessing":case"postprocessing":return e("processingXFiles",{smart_count:a.length});case"paused":return e("uploadPaused");case"waiting":return e("xFilesSelected",{smart_count:o.length});case"complete":return e("uploadComplete");case"error":return e("error");default:}}function nh(r){let{i18n:e,isAllComplete:t,hideCancelButton:i,maxNumberOfFiles:n,toggleAddFilesPanel:s,uppy:o}=r,{allowNewUpload:a}=r;return a&&n&&(a=r.totalFileCount<r.maxNumberOfFiles),l("div",{className:"uppy-DashboardContent-bar",children:[!t&&!i?l("button",{className:"uppy-DashboardContent-back",type:"button",onClick:()=>o.cancelAll(),children:e("cancel")}):l("div",{}),l("div",{className:"uppy-DashboardContent-title",children:l(ih,m({},r))}),a?l("button",{className:"uppy-DashboardContent-addMore",type:"button","aria-label":e("addMoreFiles"),title:e("addMoreFiles"),onClick:()=>s(!0),children:[l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"15",height:"15",viewBox:"0 0 15 15",children:l("path",{d:"M8 6.5h6a.5.5 0 0 1 .5.5v.5a.5.5 0 0 1-.5.5H8v6a.5.5 0 0 1-.5.5H7a.5.5 0 0 1-.5-.5V8h-6a.5.5 0 0 1-.5-.5V7a.5.5 0 0 1 .5-.5h6v-6A.5.5 0 0 1 7 0h.5a.5.5 0 0 1 .5.5v6z"})}),l("span",{className:"uppy-DashboardContent-addMoreCaption",children:e("addMore")})]}):l("div",{})]})}var xl=nh;var Fl=Y(ye(),1);var pt="uppy-transition-slideDownUp",Sl=250;function sh({children:r}){let[e,t]=we(null),[i,n]=we(""),s=Be(),o=Be(),a=Be(),u=Te(()=>{n(`${pt}-enter`),cancelAnimationFrame(a.current),clearTimeout(o.current),o.current=void 0,a.current=requestAnimationFrame(()=>{n(`${pt}-enter ${pt}-enter-active`),s.current=setTimeout(()=>{n("")},Sl)})},[]),c=Te(()=>{n(`${pt}-leave`),cancelAnimationFrame(a.current),clearTimeout(s.current),s.current=void 0,a.current=requestAnimationFrame(()=>{n(`${pt}-leave ${pt}-leave-active`),o.current=setTimeout(()=>{t(null),n("")},Sl)})},[]);return Ee(()=>{let p=Ce(r)[0];e!==p&&(p&&!e?u():e&&!p&&!o.current&&c(),t(p))},[r,e,u,c]),Ee(()=>()=>{clearTimeout(s.current),clearTimeout(o.current),cancelAnimationFrame(a.current)},[]),e?Ur(e,{className:(0,Fl.default)(i,e.props.className)}):null}var ur=sh;var xe={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete"};var Vn=Y(ye(),1);var zn=Y(qt(),1);var qn=Y(ye(),1);var oh="\xB7",Pl=()=>` ${oh} `;function El(r){let{newFiles:e,isUploadStarted:t,recoveredState:i,i18n:n,uploadState:s,isSomeGhost:o,startUpload:a}=r,u=(0,qn.default)("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--upload",{"uppy-c-btn-primary":s===xe.STATE_WAITING},{"uppy-StatusBar-actionBtn--disabled":o}),c=e&&t&&!i?n("uploadXNewFiles",{smart_count:e}):n("uploadXFiles",{smart_count:e});return l("button",{type:"button",className:u,"aria-label":n("uploadXFiles",{smart_count:e}),onClick:a,disabled:o,"data-uppy-super-focusable":!0,children:c})}function Tl(r){let{i18n:e,uppy:t}=r;return l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--retry","aria-label":e("retryUpload"),onClick:()=>t.retryAll().catch(()=>{}),"data-uppy-super-focusable":!0,"data-cy":"retry",children:[l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"8",height:"10",viewBox:"0 0 8 10",children:l("path",{d:"M4 2.408a2.75 2.75 0 1 0 2.75 2.75.626.626 0 0 1 1.25.018v.023a4 4 0 1 1-4-4.041V.25a.25.25 0 0 1 .389-.208l2.299 1.533a.25.25 0 0 1 0 .416l-2.3 1.533A.25.25 0 0 1 4 3.316v-.908z"})}),e("retry")]})}function kl(r){let{i18n:e,uppy:t}=r;return l("button",{type:"button",className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",title:e("cancel"),"aria-label":e("cancel"),onClick:()=>t.cancelAll(),"data-cy":"cancel","data-uppy-super-focusable":!0,children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16",children:l("g",{fill:"none",fillRule:"evenodd",children:[l("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),l("path",{fill:"#FFF",d:"M9.283 8l2.567 2.567-1.283 1.283L8 9.283 5.433 11.85 4.15 10.567 6.717 8 4.15 5.433 5.433 4.15 8 6.717l2.567-2.567 1.283 1.283z"})]})})})}function Cl(r){let{isAllPaused:e,i18n:t,isAllComplete:i,resumableUploads:n,uppy:s}=r,o=t(e?"resume":"pause");function a(){if(!i){if(!n){s.cancelAll();return}if(e){s.resumeAll();return}s.pauseAll()}}return l("button",{title:o,"aria-label":o,className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",type:"button",onClick:a,"data-cy":"togglePauseResume","data-uppy-super-focusable":!0,children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16",children:l("g",{fill:"none",fillRule:"evenodd",children:[l("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),l("path",{fill:"#FFF",d:e?"M6 4.25L11.5 8 6 11.75z":"M5 4.5h2v7H5v-7zm4 0h2v7H9v-7z"})]})})})}function Ul(r){let{i18n:e,doneButtonHandler:t}=r;return l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--done",onClick:t,"data-uppy-super-focusable":!0,children:e("done")})}function Al(){return l("svg",{className:"uppy-StatusBar-spinner","aria-hidden":"true",focusable:"false",width:"14",height:"14",children:l("path",{d:"M13.983 6.547c-.12-2.509-1.64-4.893-3.939-5.936-2.48-1.127-5.488-.656-7.556 1.094C.524 3.367-.398 6.048.162 8.562c.556 2.495 2.46 4.52 4.94 5.183 2.932.784 5.61-.602 7.256-3.015-1.493 1.993-3.745 3.309-6.298 2.868-2.514-.434-4.578-2.349-5.153-4.84a6.226 6.226 0 0 1 2.98-6.778C6.34.586 9.74 1.1 11.373 3.493c.407.596.693 1.282.842 1.988.127.598.073 1.197.161 1.794.078.525.543 1.257 1.15.864.525-.341.49-1.05.456-1.592-.007-.15.02.3 0 0",fillRule:"evenodd"})})}function Ol(r){let{progress:e}=r,{value:t,mode:i,message:n}=e;return l("div",{className:"uppy-StatusBar-content",children:[l(Al,{}),i==="determinate"?`${Math.round(t*100)}% \xB7 `:"",n]})}function ah(r){let{numUploads:e,complete:t,totalUploadedSize:i,totalSize:n,totalETA:s,i18n:o}=r,a=e>1,u=(0,zn.default)(i);return l("div",{className:"uppy-StatusBar-statusSecondary",children:[a&&o("filesUploadedOfTotal",{complete:t,smart_count:e}),l("span",{className:"uppy-StatusBar-additionalInfo",children:[a&&Pl(),n!=null?o("dataUploadedOfTotal",{complete:u,total:(0,zn.default)(n)}):o("dataUploadedOfUnknown",{complete:u}),Pl(),s!=null&&o("xTimeLeft",{time:Er(s)})]})]})}function Il(r){let{i18n:e,complete:t,numUploads:i}=r;return l("div",{className:"uppy-StatusBar-statusSecondary",children:e("filesUploadedOfTotal",{complete:t,smart_count:i})})}function lh(r){let{i18n:e,newFiles:t,startUpload:i}=r,n=(0,qn.default)("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--uploadNewlyAdded");return l("div",{className:"uppy-StatusBar-statusSecondary",children:[l("div",{className:"uppy-StatusBar-statusSecondaryHint",children:e("xMoreFilesAdded",{smart_count:t})}),l("button",{type:"button",className:n,"aria-label":e("uploadXFiles",{smart_count:t}),onClick:i,children:e("upload")})]})}function Rl(r){let{i18n:e,supportsUploadProgress:t,totalProgress:i,hideProgressDetails:n,isUploadStarted:s,isAllComplete:o,isAllPaused:a,newFiles:u,numUploads:c,complete:p,totalUploadedSize:d,totalSize:v,totalETA:b,startUpload:x}=r,A=u&&s;if(!s||o)return null;let C=e(a?"paused":"uploading");function U(){return!a&&!A&&!n?t?l(ah,{numUploads:c,complete:p,totalUploadedSize:d,totalSize:v,totalETA:b,i18n:e}):l(Il,{i18n:e,complete:p,numUploads:c}):null}return l("div",{className:"uppy-StatusBar-content",title:C,children:[a?null:l(Al,{}),l("div",{className:"uppy-StatusBar-status",children:[l("div",{className:"uppy-StatusBar-statusPrimary",children:t&&i!==0?`${C}: ${i}%`:C}),U(),A?l(lh,{i18n:e,newFiles:u,startUpload:x}):null]})]})}function Nl(r){let{i18n:e}=r;return l("div",{className:"uppy-StatusBar-content",role:"status",title:e("complete"),children:l("div",{className:"uppy-StatusBar-status",children:l("div",{className:"uppy-StatusBar-statusPrimary",children:[l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"15",height:"11",viewBox:"0 0 15 11",children:l("path",{d:"M.414 5.843L1.627 4.63l3.472 3.472L13.202 0l1.212 1.213L5.1 10.528z"})}),e("complete")]})})})}function Bl(r){let{error:e,i18n:t,complete:i,numUploads:n}=r;function s(){let o=`${t("uploadFailed")} 

 ${e}`;alert(o)}return l("div",{className:"uppy-StatusBar-content",title:t("uploadFailed"),children:[l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"11",height:"11",viewBox:"0 0 11 11",children:l("path",{d:"M4.278 5.5L0 1.222 1.222 0 5.5 4.278 9.778 0 11 1.222 6.722 5.5 11 9.778 9.778 11 5.5 6.722 1.222 11 0 9.778z"})}),l("div",{className:"uppy-StatusBar-status",children:[l("div",{className:"uppy-StatusBar-statusPrimary",children:[t("uploadFailed"),l("button",{className:"uppy-u-reset uppy-StatusBar-details","aria-label":t("showErrorDetails"),"data-microtip-position":"top-right","data-microtip-size":"medium",onClick:s,type:"button",children:"?"})]}),l(Il,{i18n:t,complete:i,numUploads:n})]})]})}function dr(r){let e=[],t="indeterminate",i;for(let{progress:s}of Object.values(r)){let{preprocess:o,postprocess:a}=s;i==null&&(o||a)&&({mode:t,message:i}=o||a),o?.mode==="determinate"&&e.push(o.value),a?.mode==="determinate"&&e.push(a.value)}let n=e.reduce((s,o)=>s+o/e.length,0);return{mode:t,message:i,value:n}}var{STATE_ERROR:Dl,STATE_WAITING:uh,STATE_PREPROCESSING:Hn,STATE_UPLOADING:ei,STATE_POSTPROCESSING:$n,STATE_COMPLETE:ti}=xe;function Wn({newFiles:r,allowNewUpload:e,isUploadInProgress:t,isAllPaused:i,resumableUploads:n,error:s,hideUploadButton:o=void 0,hidePauseResumeButton:a=!1,hideCancelButton:u=!1,hideRetryButton:c=!1,recoveredState:p,uploadState:d,totalProgress:v,files:b,supportsUploadProgress:x,hideAfterFinish:A=!1,isSomeGhost:C,doneButtonHandler:U=void 0,isUploadStarted:P,i18n:k,startUpload:B,uppy:j,isAllComplete:N,hideProgressDetails:D=void 0,numUploads:V,complete:G,totalSize:ue,totalETA:K,totalUploadedSize:se}){function oe(){switch(d){case $n:case Hn:{let W=dr(b);return W.mode==="determinate"?W.value*100:v}case Dl:return null;case ei:return x?v:null;default:return v}}function Fe(){switch(d){case $n:case Hn:{let{mode:W}=dr(b);return W==="indeterminate"}case ei:return!x;default:return!1}}let Se=oe(),g=Se??100,h=!s&&r&&(!t&&!i||p)&&e&&!o,f=!u&&d!==uh&&d!==ti,F=n&&!a&&d===ei,T=s&&!N&&!c,E=U&&d===ti,_=(0,Vn.default)("uppy-StatusBar-progress",{"is-indeterminate":Fe()}),y=(0,Vn.default)("uppy-StatusBar",`is-${d}`,{"has-ghosts":C}),w=(()=>{switch(d){case Hn:case $n:return l(Ol,{progress:dr(b)});case ti:return l(Nl,{i18n:k});case Dl:return l(Bl,{error:s,i18n:k,numUploads:V,complete:G});case ei:return l(Rl,{i18n:k,supportsUploadProgress:x,totalProgress:v,hideProgressDetails:D,isUploadStarted:P,isAllComplete:N,isAllPaused:i,newFiles:r,numUploads:V,complete:G,totalUploadedSize:se,totalSize:ue,totalETA:K,startUpload:B});default:return null}})();return!(h||T||F||f||E)&&!w||d===ti&&A?null:l("div",{className:y,children:[l("div",{className:_,style:{width:`${g}%`},role:"progressbar","aria-label":`${g}%`,"aria-valuetext":`${g}%`,"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":Se}),w,l("div",{className:"uppy-StatusBar-actions",children:[h?l(El,{newFiles:r,isUploadStarted:P,recoveredState:p,i18n:k,isSomeGhost:C,startUpload:B,uploadState:d}):null,T?l(Tl,{i18n:k,uppy:j}):null,F?l(Cl,{isAllPaused:i,i18n:k,isAllComplete:N,resumableUploads:n,uppy:j}):null,f?l(kl,{i18n:k,uppy:j}):null,E?l(Ul,{i18n:k,doneButtonHandler:U}):null]})]})}var dh=2e3,ch=2e3;function ph(r,e,t,i){if(r)return xe.STATE_ERROR;if(e)return xe.STATE_COMPLETE;if(t)return xe.STATE_WAITING;let n=xe.STATE_WAITING,s=Object.keys(i);for(let o=0;o<s.length;o++){let{progress:a}=i[s[o]];if(a.uploadStarted&&!a.uploadComplete)return xe.STATE_UPLOADING;a.preprocess&&(n=xe.STATE_PREPROCESSING),a.postprocess&&n!==xe.STATE_PREPROCESSING&&(n=xe.STATE_POSTPROCESSING)}return n}var ri=class extends pe{#e;#t;#r;#i;componentDidMount(){this.#e=performance.now(),this.#t=this.props.uppy.getFiles().reduce((e,t)=>e+(t.progress.bytesUploaded||0),0),this.props.uppy.on("upload",this.#n)}componentWillUnmount(){this.props.uppy.off("upload",this.#n)}#n=()=>{let{recoveredState:e}=this.props.uppy.getState();if(this.#r=null,this.#i=null,e){this.#t=Object.values(e.files).reduce((t,{progress:i})=>t+(i.bytesUploaded||0),0),this.props.uppy.emit("restore-confirmed");return}this.#e=performance.now(),this.#t=0};#u(e){if(e.total==null||e.total===0)return null;let t=e.total-e.uploaded;if(t<=0)return null;this.#e??=performance.now();let i=performance.now()-this.#e;if(i===0)return Math.round((this.#i??0)/100)/10;if(this.#t==null)return this.#t=e.uploaded,null;let n=e.uploaded-this.#t;if(this.#t=e.uploaded,n<=0)return Math.round((this.#i??0)/100)/10;let s=n/i;if(!Number.isFinite(s)||s<=0)return null;let o=this.#r==null?s:Tt(s,this.#r,dh,i);if(!Number.isFinite(o)||o<=0)return null;this.#r=o;let a=t/o;if(!Number.isFinite(a)||a<0)return null;let u=Math.max((this.#i??0)-i,0),c=this.#i==null?a:Tt(a,u,ch,i);return!Number.isFinite(c)||c<0?null:(this.#i=c,this.#e=performance.now(),Math.round(c/100)/10)}startUpload=()=>this.props.uppy.upload().catch(()=>{});render(){let{capabilities:e,files:t,allowNewUpload:i,totalProgress:n,error:s,recoveredState:o}=this.props.uppy.getState(),{newFiles:a,startedFiles:u,completeFiles:c,isUploadStarted:p,isAllComplete:d,isAllPaused:v,isUploadInProgress:b,isSomeGhost:x}=this.props.uppy.getObjectOfFilesPerState(),A=o?Object.values(t):a,C=!!e.resumableUploads,U=e.uploadProgress!==!1,P=null,k=0;u.every(j=>j.progress.bytesTotal!=null&&j.progress.bytesTotal!==0)?(P=0,u.forEach(j=>{P+=j.progress.bytesTotal||0,k+=j.progress.bytesUploaded||0})):u.forEach(j=>{k+=j.progress.bytesUploaded||0});let B=this.#u({uploaded:k,total:P});return l(Wn,{error:s,uploadState:ph(s,d,o,t||{}),allowNewUpload:i,totalProgress:n,totalSize:P,totalUploadedSize:k,isAllComplete:d,isAllPaused:v,isUploadStarted:p,isUploadInProgress:b,isSomeGhost:x,recoveredState:o,complete:c.length,newFiles:A.length,numUploads:u.length,totalETA:B,files:t,i18n:this.props.i18n,uppy:this.props.uppy,startUpload:this.startUpload,doneButtonHandler:this.props.doneButtonHandler,resumableUploads:C,supportsUploadProgress:U,hideProgressDetails:this.props.hideProgressDetails,hideUploadButton:this.props.hideUploadButton,hideRetryButton:this.props.hideRetryButton,hidePauseResumeButton:this.props.hidePauseResumeButton,hideCancelButton:this.props.hideCancelButton,hideAfterFinish:this.props.hideAfterFinish})}};var Ll=900,jl=700,Gn=576,Ml=330;function Kn(r){let e=r.totalFileCount===0,t=r.totalFileCount===1,i=r.containerWidth>Gn,n=r.containerHeight>Ml,s=(0,zl.default)({"uppy-Dashboard":!0,"uppy-Dashboard--isDisabled":r.disabled,"uppy-Dashboard--animateOpenClose":r.animateOpenClose,"uppy-Dashboard--isClosing":r.isClosing,"uppy-Dashboard--isDraggingOver":r.isDraggingOver,"uppy-Dashboard--modal":!r.inline,"uppy-size--md":r.containerWidth>Gn,"uppy-size--lg":r.containerWidth>jl,"uppy-size--xl":r.containerWidth>Ll,"uppy-size--height-md":r.containerHeight>Ml,"uppy-Dashboard--isAddFilesPanelVisible":r.showAddFilesPanel,"uppy-Dashboard--isInnerWrapVisible":r.areInsidesReadyToBeVisible,"uppy-Dashboard--singleFile":r.singleFileFullScreen&&t&&n}),o=1;r.containerWidth>Ll?o=5:r.containerWidth>jl?o=4:r.containerWidth>Gn&&(o=3);let a=r.showSelectedFiles&&!e,u=r.recoveredState?Object.keys(r.recoveredState.files).length:null,c=r.files?Object.keys(r.files).filter(v=>r.files[v].isGhost).length:0,p=()=>c>0?r.i18n("recoveredXFiles",{smart_count:c}):r.i18n("recoveredAllFiles");return l("div",{className:s,"data-uppy-theme":r.theme,"data-uppy-num-acquirers":r.acquirers.length,"data-uppy-drag-drop-supported":!r.disableLocalFiles&&Pr(),"aria-hidden":r.inline?"false":r.isHidden,"aria-disabled":r.disabled,"aria-label":r.inline?r.i18n("dashboardTitle"):r.i18n("dashboardWindowTitle"),onPaste:r.handlePaste,onDragOver:r.handleDragOver,onDragLeave:r.handleDragLeave,onDrop:r.handleDrop,children:[l("div",{"aria-hidden":"true",className:"uppy-Dashboard-overlay",tabIndex:-1,onClick:r.handleClickOutside}),l("div",{className:"uppy-Dashboard-inner",role:r.inline?void 0:"dialog",style:{width:r.inline&&r.width?r.width:"",height:r.inline&&r.height?r.height:""},children:[r.inline?null:l("button",{className:"uppy-u-reset uppy-Dashboard-close",type:"button","aria-label":r.i18n("closeModal"),title:r.i18n("closeModal"),onClick:r.closeModal,children:l("span",{"aria-hidden":"true",children:"\xD7"})}),l("div",{className:"uppy-Dashboard-innerWrap",children:[l("div",{className:"uppy-Dashboard-dropFilesHereHint",children:r.i18n("dropHint")}),a&&l(xl,m({},r)),u&&l("div",{className:"uppy-Dashboard-serviceMsg",children:[l("svg",{className:"uppy-Dashboard-serviceMsg-icon","aria-hidden":"true",focusable:"false",width:"21",height:"16",viewBox:"0 0 24 19",children:l("g",{transform:"translate(0 -1)",fill:"none",fillRule:"evenodd",children:[l("path",{d:"M12.857 1.43l10.234 17.056A1 1 0 0122.234 20H1.766a1 1 0 01-.857-1.514L11.143 1.429a1 1 0 011.714 0z",fill:"#FFD300"}),l("path",{fill:"#000",d:"M11 6h2l-.3 8h-1.4z"}),l("circle",{fill:"#000",cx:"12",cy:"17",r:"1"})]})}),l("strong",{className:"uppy-Dashboard-serviceMsg-title",children:r.i18n("sessionRestored")}),l("div",{className:"uppy-Dashboard-serviceMsg-text",children:p()})]}),a?l(Mn,{id:r.id,i18n:r.i18n,uppy:r.uppy,files:r.files,resumableUploads:r.resumableUploads,hideRetryButton:r.hideRetryButton,hidePauseResumeButton:r.hidePauseResumeButton,hideCancelButton:r.hideCancelButton,showLinkToFileUploadResult:r.showLinkToFileUploadResult,showRemoveButtonAfterComplete:r.showRemoveButtonAfterComplete,metaFields:r.metaFields,toggleFileCard:r.toggleFileCard,handleRequestThumbnail:r.handleRequestThumbnail,handleCancelThumbnail:r.handleCancelThumbnail,recoveredState:r.recoveredState,individualCancellation:r.individualCancellation,openFileEditor:r.openFileEditor,canEditFile:r.canEditFile,toggleAddFilesPanel:r.toggleAddFilesPanel,isSingleFile:t,itemsPerRow:o,containerWidth:r.containerWidth,containerHeight:r.containerHeight}):l(Yr,{i18n:r.i18n,i18nArray:r.i18nArray,acquirers:r.acquirers,handleInputChange:r.handleInputChange,maxNumberOfFiles:r.maxNumberOfFiles,allowedFileTypes:r.allowedFileTypes,showNativePhotoCameraButton:r.showNativePhotoCameraButton,showNativeVideoCameraButton:r.showNativeVideoCameraButton,nativeCameraFacingMode:r.nativeCameraFacingMode,showPanel:r.showPanel,activePickerPanel:r.activePickerPanel,disableLocalFiles:r.disableLocalFiles,fileManagerSelectionType:r.fileManagerSelectionType,note:r.note,proudlyDisplayPoweredByUppy:r.proudlyDisplayPoweredByUppy}),l(ur,{children:r.showAddFilesPanel?l(dl,I(m({},r),{isSizeMD:i}),"AddFiles"):null}),l(ur,{children:r.fileCardFor?l(On,m({},r),"FileCard"):null}),l(ur,{children:r.activePickerPanel?l(_l,m({},r),"Picker"):null}),l(ur,{children:r.showFileEditor?l(pl,m({},r),"Editor"):null}),l("div",{className:"uppy-Dashboard-progressindicators",children:[!r.disableInformer&&l(lr,{uppy:r.uppy}),!r.disableStatusBar&&l(ri,{uppy:r.uppy,i18n:r.i18n,hideProgressDetails:r.hideProgressDetails,hideUploadButton:r.hideUploadButton,hideRetryButton:r.hideRetryButton,hidePauseResumeButton:r.hidePauseResumeButton,hideCancelButton:r.hideCancelButton,hideAfterFinish:r.hideProgressAfterFinish,doneButtonHandler:r.doneButtonHandler}),!r.disableInformer&&l(lr,{uppy:r.uppy}),r.progressindicators.map(v=>r.uppy.getPlugin(v.id).render(r.state))]})]})]})]})}var ql={strings:{closeModal:"Close Modal",addMoreFiles:"Add more files",addingMoreFiles:"Adding more files",importFrom:"Import from %{name}",dashboardWindowTitle:"Uppy Dashboard Window (Press escape to close)",dashboardTitle:"Uppy Dashboard",copyLinkToClipboardSuccess:"Link copied to clipboard.",copyLinkToClipboardFallback:"Copy the URL below",copyLink:"Copy link",back:"Back",removeFile:"Remove file",editFile:"Edit file",editImage:"Edit image",editing:"Editing %{file}",error:"Error",finishEditingFile:"Finish editing file",saveChanges:"Save changes",myDevice:"My Device",dropHint:"Drop your files here",uploadComplete:"Upload complete",uploadPaused:"Upload paused",resumeUpload:"Resume upload",pauseUpload:"Pause upload",retryUpload:"Retry upload",cancelUpload:"Cancel upload",xFilesSelected:{0:"%{smart_count} file selected",1:"%{smart_count} files selected"},uploadingXFiles:{0:"Uploading %{smart_count} file",1:"Uploading %{smart_count} files"},processingXFiles:{0:"Processing %{smart_count} file",1:"Processing %{smart_count} files"},poweredBy:"Powered by %{uppy}",addMore:"Add more",editFileWithFilename:"Edit file %{file}",save:"Save",cancel:"Cancel",dropPasteFiles:"Drop files here or %{browseFiles}",dropPasteFolders:"Drop files here or %{browseFolders}",dropPasteBoth:"Drop files here, %{browseFiles} or %{browseFolders}",dropPasteImportFiles:"Drop files here, %{browseFiles} or import from:",dropPasteImportFolders:"Drop files here, %{browseFolders} or import from:",dropPasteImportBoth:"Drop files here, %{browseFiles}, %{browseFolders} or import from:",importFiles:"Import files from:",browseFiles:"browse files",browseFolders:"browse folders",recoveredXFiles:{0:"We could not fully recover 1 file. Please re-select it and resume the upload.",1:"We could not fully recover %{smart_count} files. Please re-select them and resume the upload."},recoveredAllFiles:"We restored all files. You can now resume the upload.",sessionRestored:"Session restored",reSelect:"Re-select",missingRequiredMetaFields:{0:"Missing required meta field: %{fields}.",1:"Missing required meta fields: %{fields}."},takePictureBtn:"Take Picture",recordVideoBtn:"Record Video",uploading:"Uploading",complete:"Complete",uploadFailed:"Upload failed",paused:"Paused",retry:"Retry",pause:"Pause",resume:"Resume",done:"Done",filesUploadedOfTotal:{0:"%{complete} of %{smart_count} file uploaded",1:"%{complete} of %{smart_count} files uploaded"},dataUploadedOfTotal:"%{complete} of %{total}",dataUploadedOfUnknown:"%{complete} of unknown",xTimeLeft:"%{time} left",uploadXFiles:{0:"Upload %{smart_count} file",1:"Upload %{smart_count} files"},uploadXNewFiles:{0:"Upload +%{smart_count} file",1:"Upload +%{smart_count} files"},upload:"Upload",xMoreFilesAdded:{0:"%{smart_count} more file added",1:"%{smart_count} more files added"},showErrorDetails:"Show error details"}};var Hl=Y(Gi(),1);function cr(r,e){if(e){let t=r.querySelector(`[data-uppy-paneltype="${e}"]`);if(t)return t}return r}function Xn(){let r=!1;return(0,Hl.default)((t,i)=>{let n=cr(t,i),s=n.contains(document.activeElement);if(s&&r)return;let o=n.querySelector("[data-uppy-super-focusable]");s&&!o||(o?(o.focus({preventScroll:!0}),r=!0):(n.querySelector(kt)?.focus({preventScroll:!0}),r=!1))},260)}function $l(r,e){let t=e[0];t&&(t.focus(),r.preventDefault())}function hh(r,e){let t=e[e.length-1];t&&(t.focus(),r.preventDefault())}function fh(r){return r.contains(document.activeElement)}function Yn(r,e,t){let i=cr(t,e),n=Re(i.querySelectorAll(kt)),s=n.indexOf(document.activeElement);fh(i)?r.shiftKey&&s===0?hh(r,n):!r.shiftKey&&s===n.length-1&&$l(r,n):$l(r,n)}function Vl(r,e,t){e===null||Yn(r,e,t)}var Wl=9,gh=27;function Gl(){let r={};return r.promise=new Promise((e,t)=>{r.resolve=e,r.reject=t}),r}var yh={target:"body",metaFields:[],thumbnailWidth:280,thumbnailType:"image/jpeg",waitForThumbnailsBeforeUpload:!1,defaultPickerIcon:nr,showLinkToFileUploadResult:!1,hideProgressDetails:!1,hideUploadButton:!1,hideCancelButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideProgressAfterFinish:!1,note:null,singleFileFullScreen:!0,disableStatusBar:!1,disableInformer:!1,disableThumbnailGenerator:!1,fileManagerSelectionType:"files",proudlyDisplayPoweredByUppy:!0,showSelectedFiles:!0,showRemoveButtonAfterComplete:!1,showNativePhotoCameraButton:!1,showNativeVideoCameraButton:!1,theme:"light",autoOpen:null,disabled:!1,disableLocalFiles:!1,nativeCameraFacingMode:"",onDragLeave:()=>{},onDragOver:()=>{},onDrop:()=>{},plugins:[],doneButtonHandler:void 0,onRequestCloseModal:null,inline:!1,animateOpenClose:!0,browserBackButtonClose:!1,closeAfterFinish:!1,closeModalOnClickOutside:!1,disablePageScrollWhenModalOpen:!0,trigger:null,width:750,height:550},Qn=class extends Vt{static VERSION=ll.version;#e;modalName=`uppy-Dashboard-${De()}`;superFocus=Xn();ifFocusedOnUppyRecently=!1;dashboardIsDisabled;savedScrollPosition;savedActiveElement;resizeObserver;darkModeMediaQuery;makeDashboardInsidesVisibleAnywayTimeout;constructor(e,t){let i=t?.autoOpen??null;super(e,I(m(m({},yh),t),{autoOpen:i})),this.id=this.opts.id||"Dashboard",this.title="Dashboard",this.type="orchestrator",this.defaultLocale=ql,this.opts.doneButtonHandler===void 0&&(this.opts.doneButtonHandler=()=>{this.uppy.clear(),this.requestCloseModal()}),this.opts.onRequestCloseModal??=()=>this.closeModal(),this.i18nInit()}removeTarget=e=>{let i=this.getPluginState().targets.filter(n=>n.id!==e.id);this.setPluginState({targets:i})};addTarget=e=>{let t=e.id||e.constructor.name,i=e.title||t,n=e.type;if(n!=="acquirer"&&n!=="progressindicator"&&n!=="editor")return this.uppy.log("Dashboard: can only be targeted by plugins of types: acquirer, progressindicator, editor","error"),null;let s={id:t,name:i,type:n},a=this.getPluginState().targets.slice();return a.push(s),this.setPluginState({targets:a}),this.el};hideAllPanels=()=>{let e=this.getPluginState(),t={activePickerPanel:void 0,showAddFilesPanel:!1,activeOverlayType:null,fileCardFor:null,showFileEditor:!1};e.activePickerPanel===t.activePickerPanel&&e.showAddFilesPanel===t.showAddFilesPanel&&e.showFileEditor===t.showFileEditor&&e.activeOverlayType===t.activeOverlayType||(this.setPluginState(t),this.uppy.emit("dashboard:close-panel",e.activePickerPanel?.id))};showPanel=e=>{let{targets:t}=this.getPluginState(),i=t.find(n=>n.type==="acquirer"&&n.id===e);this.setPluginState({activePickerPanel:i,activeOverlayType:"PickerPanel"}),this.uppy.emit("dashboard:show-panel",e)};canEditFile=e=>{let{targets:t}=this.getPluginState();return this.#a(t).some(n=>this.uppy.getPlugin(n.id).canEditFile(e))};openFileEditor=e=>{let{targets:t}=this.getPluginState(),i=this.#a(t);this.setPluginState({showFileEditor:!0,fileCardFor:e.id||null,activeOverlayType:"FileEditor"}),i.forEach(n=>{this.uppy.getPlugin(n.id).selectFile(e)})};closeFileEditor=()=>{let{metaFields:e}=this.getPluginState();e&&e.length>0?this.setPluginState({showFileEditor:!1,activeOverlayType:"FileCard"}):this.setPluginState({showFileEditor:!1,fileCardFor:null,activeOverlayType:"AddFiles"})};saveFileEditor=()=>{let{targets:e}=this.getPluginState();this.#a(e).forEach(i=>{this.uppy.getPlugin(i.id).save()}),this.closeFileEditor()};openModal=()=>{let{promise:e,resolve:t}=Gl();if(this.savedScrollPosition=window.pageYOffset,this.savedActiveElement=document.activeElement,this.opts.disablePageScrollWhenModalOpen&&document.body.classList.add("uppy-Dashboard-isFixed"),this.opts.animateOpenClose&&this.getPluginState().isClosing){let i=()=>{this.setPluginState({isHidden:!1}),this.el.removeEventListener("animationend",i,!1),t()};this.el.addEventListener("animationend",i,!1)}else this.setPluginState({isHidden:!1}),t();return this.opts.browserBackButtonClose&&this.updateBrowserHistory(),document.addEventListener("keydown",this.handleKeyDownInModal),this.uppy.emit("dashboard:modal-open"),e};closeModal=e=>{let t=e?.manualClose??!0,{isHidden:i,isClosing:n}=this.getPluginState();if(i||n)return;let{promise:s,resolve:o}=Gl();if(this.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove("uppy-Dashboard-isFixed"),this.opts.animateOpenClose){this.setPluginState({isClosing:!0});let a=()=>{this.setPluginState({isHidden:!0,isClosing:!1}),this.superFocus.cancel(),this.savedActiveElement.focus(),this.el.removeEventListener("animationend",a,!1),o()};this.el.addEventListener("animationend",a,!1)}else this.setPluginState({isHidden:!0}),this.superFocus.cancel(),this.savedActiveElement.focus(),o();return document.removeEventListener("keydown",this.handleKeyDownInModal),t&&this.opts.browserBackButtonClose&&history.state?.[this.modalName]&&history.back(),this.uppy.emit("dashboard:modal-closed"),s};isModalOpen=()=>!this.getPluginState().isHidden||!1;requestCloseModal=()=>this.opts.onRequestCloseModal?this.opts.onRequestCloseModal():this.closeModal();setDarkModeCapability=e=>{let{capabilities:t}=this.uppy.getState();this.uppy.setState({capabilities:I(m({},t),{darkMode:e})})};handleSystemDarkModeChange=e=>{let t=e.matches;this.uppy.log(`[Dashboard] Dark mode is ${t?"on":"off"}`),this.setDarkModeCapability(t)};toggleFileCard=(e,t)=>{let i=this.uppy.getFile(t);e?this.uppy.emit("dashboard:file-edit-start",i):this.uppy.emit("dashboard:file-edit-complete",i),this.setPluginState({fileCardFor:e?t:null,activeOverlayType:e?"FileCard":null})};toggleAddFilesPanel=e=>{this.setPluginState({showAddFilesPanel:e,activeOverlayType:e?"AddFiles":null})};addFiles=e=>{let t=e.map(i=>({source:this.id,name:i.name,type:i.type,data:i,meta:{relativePath:i.relativePath||i.webkitRelativePath||null}}));try{this.uppy.addFiles(t)}catch(i){this.uppy.log(i)}};startListeningToResize=()=>{this.resizeObserver=new ResizeObserver(e=>{let t=e[0],{width:i,height:n}=t.contentRect;this.setPluginState({containerWidth:i,containerHeight:n,areInsidesReadyToBeVisible:!0})}),this.resizeObserver.observe(this.el.querySelector(".uppy-Dashboard-inner")),this.makeDashboardInsidesVisibleAnywayTimeout=setTimeout(()=>{let e=this.getPluginState(),t=!this.opts.inline&&e.isHidden;!e.areInsidesReadyToBeVisible&&!t&&(this.uppy.log("[Dashboard] resize event didn\u2019t fire on time: defaulted to mobile layout","warning"),this.setPluginState({areInsidesReadyToBeVisible:!0}))},1e3)};stopListeningToResize=()=>{this.resizeObserver.disconnect(),clearTimeout(this.makeDashboardInsidesVisibleAnywayTimeout)};recordIfFocusedOnUppyRecently=e=>{this.el.contains(e.target)?this.ifFocusedOnUppyRecently=!0:(this.ifFocusedOnUppyRecently=!1,this.superFocus.cancel())};disableInteractiveElements=e=>{let t=["a[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])",'[role="button"]:not([disabled])'],i=this.#e??Re(this.el.querySelectorAll(t)).filter(n=>!n.classList.contains("uppy-Dashboard-close"));for(let n of i)n.tagName==="A"?n.setAttribute("aria-disabled",e):n.disabled=e;e?this.#e=i:this.#e=null,this.dashboardIsDisabled=e};updateBrowserHistory=()=>{history.state?.[this.modalName]||history.pushState(I(m({},history.state),{[this.modalName]:!0}),""),window.addEventListener("popstate",this.handlePopState,!1)};handlePopState=e=>{this.isModalOpen()&&(!e.state||!e.state[this.modalName])&&this.closeModal({manualClose:!1}),!this.isModalOpen()&&e.state?.[this.modalName]&&history.back()};handleKeyDownInModal=e=>{e.keyCode===gh&&this.requestCloseModal(),e.keyCode===Wl&&Yn(e,this.getPluginState().activeOverlayType,this.el)};handleClickOutside=()=>{this.opts.closeModalOnClickOutside&&this.requestCloseModal()};handlePaste=e=>{this.uppy.iteratePlugins(i=>{i.type==="acquirer"&&i.handleRootPaste?.(e)});let t=Re(e.clipboardData.files);t.length>0&&(this.uppy.log("[Dashboard] Files pasted"),this.addFiles(t))};handleInputChange=e=>{e.preventDefault();let t=Re(e.currentTarget.files||[]);t.length>0&&(this.uppy.log("[Dashboard] Files selected through input"),this.addFiles(t))};handleDragOver=e=>{e.preventDefault(),e.stopPropagation();let t=()=>{let o=!0;return this.uppy.iteratePlugins(a=>{a.canHandleRootDrop?.(e)&&(o=!0)}),o},i=()=>{let{types:o}=e.dataTransfer;return o.some(a=>a==="Files")},n=t(),s=i();if(!n&&!s||this.opts.disabled||this.opts.disableLocalFiles&&(s||!n)||!this.uppy.getState().allowNewUpload){e.dataTransfer.dropEffect="none";return}e.dataTransfer.dropEffect="copy",this.setPluginState({isDraggingOver:!0}),this.opts.onDragOver(e)};handleDragLeave=e=>{e.preventDefault(),e.stopPropagation(),this.setPluginState({isDraggingOver:!1}),this.opts.onDragLeave(e)};handleDrop=async e=>{e.preventDefault(),e.stopPropagation(),this.setPluginState({isDraggingOver:!1}),this.uppy.iteratePlugins(s=>{s.type==="acquirer"&&s.handleRootDrop?.(e)});let t=!1,i=s=>{this.uppy.log(s,"error"),t||(this.uppy.info(s.message,"error"),t=!0)};this.uppy.log("[Dashboard] Processing dropped files");let n=await Fr(e.dataTransfer,{logDropError:i});n.length>0&&(this.uppy.log("[Dashboard] Files dropped"),this.addFiles(n)),this.opts.onDrop(e)};handleRequestThumbnail=e=>{this.opts.waitForThumbnailsBeforeUpload||this.uppy.emit("thumbnail:request",e)};handleCancelThumbnail=e=>{this.opts.waitForThumbnailsBeforeUpload||this.uppy.emit("thumbnail:cancel",e)};handleKeyDownInInline=e=>{e.keyCode===Wl&&Vl(e,this.getPluginState().activeOverlayType,this.el)};handlePasteOnBody=e=>{this.el.contains(document.activeElement)&&this.handlePaste(e)};handleComplete=({failed:e})=>{this.opts.closeAfterFinish&&!e?.length&&this.requestCloseModal()};handleCancelRestore=()=>{this.uppy.emit("restore-canceled")};#t=()=>{if(this.opts.disableThumbnailGenerator)return;let e=600,t=this.uppy.getFiles();if(t.length===1){let i=this.uppy.getPlugin(`${this.id}:ThumbnailGenerator`);i?.setOptions({thumbnailWidth:e});let n=I(m({},t[0]),{preview:void 0});i?.requestThumbnail(n).then(()=>{i?.setOptions({thumbnailWidth:this.opts.thumbnailWidth})})}};#r=e=>{let t=e[0],{metaFields:i}=this.getPluginState(),n=i&&i.length>0,s=this.canEditFile(t);n&&this.opts.autoOpen==="metaEditor"?this.toggleFileCard(!0,t.id):s&&this.opts.autoOpen==="imageEditor"&&this.openFileEditor(t)};initEvents=()=>{if(this.opts.trigger&&!this.opts.inline){let e=_r(this.opts.trigger);e?e.forEach(t=>t.addEventListener("click",this.openModal)):this.uppy.log("Dashboard modal trigger not found. Make sure `trigger` is set in Dashboard options, unless you are planning to call `dashboard.openModal()` method yourself","warning")}this.startListeningToResize(),document.addEventListener("paste",this.handlePasteOnBody),this.uppy.on("plugin-added",this.#l),this.uppy.on("plugin-remove",this.removeTarget),this.uppy.on("file-added",this.hideAllPanels),this.uppy.on("dashboard:modal-closed",this.hideAllPanels),this.uppy.on("complete",this.handleComplete),this.uppy.on("files-added",this.#t),this.uppy.on("file-removed",this.#t),document.addEventListener("focus",this.recordIfFocusedOnUppyRecently,!0),document.addEventListener("click",this.recordIfFocusedOnUppyRecently,!0),this.opts.inline&&this.el.addEventListener("keydown",this.handleKeyDownInInline),this.opts.autoOpen&&this.uppy.on("files-added",this.#r)};removeEvents=()=>{let e=_r(this.opts.trigger);!this.opts.inline&&e&&e.forEach(t=>t.removeEventListener("click",this.openModal)),this.stopListeningToResize(),document.removeEventListener("paste",this.handlePasteOnBody),window.removeEventListener("popstate",this.handlePopState,!1),this.uppy.off("plugin-added",this.#l),this.uppy.off("plugin-remove",this.removeTarget),this.uppy.off("file-added",this.hideAllPanels),this.uppy.off("dashboard:modal-closed",this.hideAllPanels),this.uppy.off("complete",this.handleComplete),this.uppy.off("files-added",this.#t),this.uppy.off("file-removed",this.#t),document.removeEventListener("focus",this.recordIfFocusedOnUppyRecently),document.removeEventListener("click",this.recordIfFocusedOnUppyRecently),this.opts.inline&&this.el.removeEventListener("keydown",this.handleKeyDownInInline),this.opts.autoOpen&&this.uppy.off("files-added",this.#r)};superFocusOnEachUpdate=()=>{let e=this.el.contains(document.activeElement),t=document.activeElement===document.body||document.activeElement===null,i=this.uppy.getState().info.length===0,n=!this.opts.inline;i&&(n||e||t&&this.ifFocusedOnUppyRecently)?this.superFocus(this.el,this.getPluginState().activeOverlayType):this.superFocus.cancel()};afterUpdate=()=>{if(this.opts.disabled&&!this.dashboardIsDisabled){this.disableInteractiveElements(!0);return}!this.opts.disabled&&this.dashboardIsDisabled&&this.disableInteractiveElements(!1),this.superFocusOnEachUpdate()};saveFileCard=(e,t)=>{this.uppy.setFileMeta(t,e),this.toggleFileCard(!1,t)};#i=e=>{let t=this.uppy.getPlugin(e.id);return I(m({},e),{icon:t.icon||this.opts.defaultPickerIcon,render:t.render})};#n=e=>{let t=this.uppy.getPlugin(e.id);return typeof t.isSupported!="function"?!0:t.isSupported()};#u=e=>e.filter(t=>t.type==="acquirer"&&this.#n(t)).map(this.#i);#o=e=>e.filter(t=>t.type==="progressindicator").map(this.#i);#a=e=>e.filter(t=>t.type==="editor").map(this.#i);render=e=>{let t=this.getPluginState(),{files:i,capabilities:n,allowNewUpload:s}=e,{newFiles:o,uploadStartedFiles:a,completeFiles:u,erroredFiles:c,inProgressFiles:p,inProgressNotPausedFiles:d,processingFiles:v,isUploadStarted:b,isAllComplete:x,isAllPaused:A}=this.uppy.getObjectOfFilesPerState(),C=this.#u(t.targets),U=this.#o(t.targets),P=this.#a(t.targets),k;return this.opts.theme==="auto"?k=n.darkMode?"dark":"light":k=this.opts.theme,["files","folders","both"].indexOf(this.opts.fileManagerSelectionType)<0&&(this.opts.fileManagerSelectionType="files",console.warn(`Unsupported option for "fileManagerSelectionType". Using default of "${this.opts.fileManagerSelectionType}".`)),Kn({state:e,isHidden:t.isHidden,files:i,newFiles:o,uploadStartedFiles:a,completeFiles:u,erroredFiles:c,inProgressFiles:p,inProgressNotPausedFiles:d,processingFiles:v,isUploadStarted:b,isAllComplete:x,isAllPaused:A,totalFileCount:Object.keys(i).length,totalProgress:e.totalProgress,allowNewUpload:s,acquirers:C,theme:k,disabled:this.opts.disabled,disableLocalFiles:this.opts.disableLocalFiles,direction:this.opts.direction,activePickerPanel:t.activePickerPanel,showFileEditor:t.showFileEditor,saveFileEditor:this.saveFileEditor,closeFileEditor:this.closeFileEditor,disableInteractiveElements:this.disableInteractiveElements,animateOpenClose:this.opts.animateOpenClose,isClosing:t.isClosing,progressindicators:U,editors:P,autoProceed:this.uppy.opts.autoProceed,id:this.id,closeModal:this.requestCloseModal,handleClickOutside:this.handleClickOutside,handleInputChange:this.handleInputChange,handlePaste:this.handlePaste,inline:this.opts.inline,showPanel:this.showPanel,hideAllPanels:this.hideAllPanels,i18n:this.i18n,i18nArray:this.i18nArray,uppy:this.uppy,note:this.opts.note,recoveredState:e.recoveredState,metaFields:t.metaFields,resumableUploads:n.resumableUploads||!1,individualCancellation:n.individualCancellation,isMobileDevice:n.isMobileDevice,fileCardFor:t.fileCardFor,toggleFileCard:this.toggleFileCard,toggleAddFilesPanel:this.toggleAddFilesPanel,showAddFilesPanel:t.showAddFilesPanel,saveFileCard:this.saveFileCard,openFileEditor:this.openFileEditor,canEditFile:this.canEditFile,width:this.opts.width,height:this.opts.height,showLinkToFileUploadResult:this.opts.showLinkToFileUploadResult,fileManagerSelectionType:this.opts.fileManagerSelectionType,proudlyDisplayPoweredByUppy:this.opts.proudlyDisplayPoweredByUppy,showRemoveButtonAfterComplete:this.opts.showRemoveButtonAfterComplete,containerWidth:t.containerWidth,containerHeight:t.containerHeight,areInsidesReadyToBeVisible:t.areInsidesReadyToBeVisible,parentElement:this.el,allowedFileTypes:this.uppy.opts.restrictions.allowedFileTypes,maxNumberOfFiles:this.uppy.opts.restrictions.maxNumberOfFiles,requiredMetaFields:this.uppy.opts.restrictions.requiredMetaFields,showSelectedFiles:this.opts.showSelectedFiles,showNativePhotoCameraButton:this.opts.showNativePhotoCameraButton,showNativeVideoCameraButton:this.opts.showNativeVideoCameraButton,nativeCameraFacingMode:this.opts.nativeCameraFacingMode,singleFileFullScreen:this.opts.singleFileFullScreen,handleCancelRestore:this.handleCancelRestore,handleRequestThumbnail:this.handleRequestThumbnail,handleCancelThumbnail:this.handleCancelThumbnail,isDraggingOver:t.isDraggingOver,handleDragOver:this.handleDragOver,handleDragLeave:this.handleDragLeave,handleDrop:this.handleDrop,disableInformer:this.opts.disableInformer,disableStatusBar:this.opts.disableStatusBar,hideProgressDetails:this.opts.hideProgressDetails,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,hideCancelButton:this.opts.hideCancelButton,hideProgressAfterFinish:this.opts.hideProgressAfterFinish,doneButtonHandler:this.opts.doneButtonHandler})};#s=()=>{let{plugins:e}=this.opts;e.forEach(t=>{let i=this.uppy.getPlugin(t);i?i.mount(this,i):this.uppy.log(`[Uppy] Dashboard could not find plugin '${t}', make sure to uppy.use() the plugins you are specifying`,"warning")})};#h=()=>{this.uppy.iteratePlugins(this.#l)};#l=e=>{let t=["acquirer","editor"];e&&!e.opts?.target&&t.includes(e.type)&&(this.getPluginState().targets.some(n=>e.id===n.id)||e.mount(this,e))};#c(){let{thumbnailWidth:e,thumbnailHeight:t,thumbnailType:i,waitForThumbnailsBeforeUpload:n}=this.opts;return{thumbnailWidth:e,thumbnailHeight:t,thumbnailType:i,waitForThumbnailsBeforeUpload:n,lazy:!n}}setOptions(e){super.setOptions(e),this.uppy.getPlugin(this.#d())?.setOptions(this.#c())}#d(){return`${this.id}:ThumbnailGenerator`}install=()=>{this.setPluginState({isHidden:!0,fileCardFor:null,activeOverlayType:null,showAddFilesPanel:!1,activePickerPanel:void 0,showFileEditor:!1,metaFields:this.opts.metaFields,targets:[],areInsidesReadyToBeVisible:!1,isDraggingOver:!1});let{inline:e,closeAfterFinish:t}=this.opts;if(e&&t)throw new Error("[Dashboard] `closeAfterFinish: true` cannot be used on an inline Dashboard, because an inline Dashboard cannot be closed at all. Either set `inline: false`, or disable the `closeAfterFinish` option.");let{allowMultipleUploads:i,allowMultipleUploadBatches:n}=this.uppy.opts;(i||n)&&t&&this.uppy.log("[Dashboard] When using `closeAfterFinish`, we recommended setting the `allowMultipleUploadBatches` option to `false` in the Uppy constructor. See https://uppy.io/docs/uppy/#allowMultipleUploads-true","warning");let{target:s}=this.opts;s&&this.mount(s,this),this.opts.disableThumbnailGenerator||this.uppy.use(qr,m({id:this.#d()},this.#c())),this.darkModeMediaQuery=typeof window<"u"&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)"):null;let o=this.darkModeMediaQuery?this.darkModeMediaQuery.matches:!1;this.uppy.log(`[Dashboard] Dark mode is ${o?"on":"off"}`),this.setDarkModeCapability(o),this.opts.theme==="auto"&&this.darkModeMediaQuery?.addListener(this.handleSystemDarkModeChange),this.#s(),this.#h(),this.initEvents()};uninstall=()=>{if(!this.opts.disableThumbnailGenerator){let t=this.uppy.getPlugin(`${this.id}:ThumbnailGenerator`);t&&this.uppy.removePlugin(t)}let{plugins:e}=this.opts;e.forEach(t=>{let i=this.uppy.getPlugin(t);i&&i.unmount()}),this.opts.theme==="auto"&&this.darkModeMediaQuery?.removeListener(this.handleSystemDarkModeChange),this.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove("uppy-Dashboard-isFixed"),this.unmount(),this.removeEvents()}};function ht(r){"@babel/helpers - typeof";return ht=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ht(r)}function Kl(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,vh(i.key),i)}}function bh(r,e,t){return e&&Kl(r.prototype,e),t&&Kl(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function vh(r){var e=wh(r,"string");return ht(e)=="symbol"?e:e+""}function wh(r,e){if(ht(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var i=t.call(r,e||"default");if(ht(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _h(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function xh(r,e,t){return e=hr(e),Sh(r,Zn()?Reflect.construct(e,t||[],hr(r).constructor):e.apply(r,t))}function Sh(r,e){if(e&&(ht(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fh(r)}function Fh(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Ph(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&pr(r,e)}function Jn(r){var e=typeof Map=="function"?new Map:void 0;return Jn=function(i){if(i===null||!Th(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(i))return e.get(i);e.set(i,n)}function n(){return Eh(i,arguments,hr(this).constructor)}return n.prototype=Object.create(i.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),pr(n,i)},Jn(r)}function Eh(r,e,t){if(Zn())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var n=new(r.bind.apply(r,i));return t&&pr(n,t.prototype),n}function Zn(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Zn=function(){return!!r})()}function Th(r){try{return Function.toString.call(r).indexOf("[native code]")!==-1}catch{return typeof r=="function"}}function pr(r,e){return pr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,n){return i.__proto__=n,i},pr(r,e)}function hr(r){return hr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},hr(r)}var kh=(function(r){function e(t){var i,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(_h(this,e),i=xh(this,e,[t]),i.originalRequest=s,i.originalResponse=o,i.causingError=n,n!=null&&(t+=", caused by ".concat(n.toString())),s!=null){var a=s.getHeader("X-Request-ID")||"n/a",u=s.getMethod(),c=s.getURL(),p=o?o.getStatus():"n/a",d=o?o.getBody()||"":"n/a";t+=", originated from request (method: ".concat(u,", url: ").concat(c,", response code: ").concat(p,", response text: ").concat(d,", request id: ").concat(a,")")}return i.message=t,i}return Ph(e,r),bh(e)})(Jn(Error)),ft=kh;var Ch=!1;function je(r){Ch&&console.log(r)}function fr(r){"@babel/helpers - typeof";return fr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fr(r)}function Uh(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Xl(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,Oh(i.key),i)}}function Ah(r,e,t){return e&&Xl(r.prototype,e),t&&Xl(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function Oh(r){var e=Ih(r,"string");return fr(e)=="symbol"?e:e+""}function Ih(r,e){if(fr(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var i=t.call(r,e||"default");if(fr(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Yl=(function(){function r(){Uh(this,r)}return Ah(r,[{key:"listAllUploads",value:function(){return Promise.resolve([])}},{key:"findUploadsByFingerprint",value:function(t){return Promise.resolve([])}},{key:"removeUpload",value:function(t){return Promise.resolve()}},{key:"addUpload",value:function(t,i){return Promise.resolve(null)}}])})();var ru="3.7.8",Rh=ru,gt=typeof Buffer=="function",Ql=typeof TextDecoder=="function"?new TextDecoder:void 0,Jl=typeof TextEncoder=="function"?new TextEncoder:void 0,Nh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",mr=Array.prototype.slice.call(Nh),ii=(r=>{let e={};return r.forEach((t,i)=>e[t]=i),e})(mr),Bh=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,le=String.fromCharCode.bind(String),Zl=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):r=>new Uint8Array(Array.prototype.slice.call(r,0)),iu=r=>r.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),nu=r=>r.replace(/[^A-Za-z0-9\+\/]/g,""),su=r=>{let e,t,i,n,s="",o=r.length%3;for(let a=0;a<r.length;){if((t=r.charCodeAt(a++))>255||(i=r.charCodeAt(a++))>255||(n=r.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=t<<16|i<<8|n,s+=mr[e>>18&63]+mr[e>>12&63]+mr[e>>6&63]+mr[e&63]}return o?s.slice(0,o-3)+"===".substring(o):s},rs=typeof btoa=="function"?r=>btoa(r):gt?r=>Buffer.from(r,"binary").toString("base64"):su,es=gt?r=>Buffer.from(r).toString("base64"):r=>{let t=[];for(let i=0,n=r.length;i<n;i+=4096)t.push(le.apply(null,r.subarray(i,i+4096)));return rs(t.join(""))},ni=(r,e=!1)=>e?iu(es(r)):es(r),Dh=r=>{if(r.length<2){var e=r.charCodeAt(0);return e<128?r:e<2048?le(192|e>>>6)+le(128|e&63):le(224|e>>>12&15)+le(128|e>>>6&63)+le(128|e&63)}else{var e=65536+(r.charCodeAt(0)-55296)*1024+(r.charCodeAt(1)-56320);return le(240|e>>>18&7)+le(128|e>>>12&63)+le(128|e>>>6&63)+le(128|e&63)}},Lh=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,ou=r=>r.replace(Lh,Dh),eu=gt?r=>Buffer.from(r,"utf8").toString("base64"):Jl?r=>es(Jl.encode(r)):r=>rs(ou(r)),mt=(r,e=!1)=>e?iu(eu(r)):eu(r),tu=r=>mt(r,!0),jh=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,Mh=r=>{switch(r.length){case 4:var e=(7&r.charCodeAt(0))<<18|(63&r.charCodeAt(1))<<12|(63&r.charCodeAt(2))<<6|63&r.charCodeAt(3),t=e-65536;return le((t>>>10)+55296)+le((t&1023)+56320);case 3:return le((15&r.charCodeAt(0))<<12|(63&r.charCodeAt(1))<<6|63&r.charCodeAt(2));default:return le((31&r.charCodeAt(0))<<6|63&r.charCodeAt(1))}},au=r=>r.replace(jh,Mh),lu=r=>{if(r=r.replace(/\s+/g,""),!Bh.test(r))throw new TypeError("malformed base64.");r+="==".slice(2-(r.length&3));let e,t,i,n=[];for(let s=0;s<r.length;)e=ii[r.charAt(s++)]<<18|ii[r.charAt(s++)]<<12|(t=ii[r.charAt(s++)])<<6|(i=ii[r.charAt(s++)]),t===64?n.push(le(e>>16&255)):i===64?n.push(le(e>>16&255,e>>8&255)):n.push(le(e>>16&255,e>>8&255,e&255));return n.join("")},is=typeof atob=="function"?r=>atob(nu(r)):gt?r=>Buffer.from(r,"base64").toString("binary"):lu,uu=gt?r=>Zl(Buffer.from(r,"base64")):r=>Zl(is(r).split("").map(e=>e.charCodeAt(0))),du=r=>uu(cu(r)),zh=gt?r=>Buffer.from(r,"base64").toString("utf8"):Ql?r=>Ql.decode(uu(r)):r=>au(is(r)),cu=r=>nu(r.replace(/[-_]/g,e=>e=="-"?"+":"/")),ts=r=>zh(cu(r)),qh=r=>{if(typeof r!="string")return!1;let e=r.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(e)||!/[^\s0-9a-zA-Z\-_]/.test(e)},pu=r=>({value:r,enumerable:!1,writable:!0,configurable:!0}),hu=function(){let r=(e,t)=>Object.defineProperty(String.prototype,e,pu(t));r("fromBase64",function(){return ts(this)}),r("toBase64",function(e){return mt(this,e)}),r("toBase64URI",function(){return mt(this,!0)}),r("toBase64URL",function(){return mt(this,!0)}),r("toUint8Array",function(){return du(this)})},fu=function(){let r=(e,t)=>Object.defineProperty(Uint8Array.prototype,e,pu(t));r("toBase64",function(e){return ni(this,e)}),r("toBase64URI",function(){return ni(this,!0)}),r("toBase64URL",function(){return ni(this,!0)})},Hh=()=>{hu(),fu()},mu={version:ru,VERSION:Rh,atob:is,atobPolyfill:lu,btoa:rs,btoaPolyfill:su,fromBase64:ts,toBase64:mt,encode:mt,encodeURI:tu,encodeURL:tu,utob:ou,btou:au,decode:ts,isValid:qh,fromUint8Array:ni,toUint8Array:du,extendString:hu,extendUint8Array:fu,extendBuiltins:Hh};var zu=Y(ku());function as(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var e=Math.random()*16|0,t=r==="x"?e:e&3|8;return t.toString(16)})}function ls(){"use strict";ls=function(){return e};var r,e={},t=Object.prototype,i=t.hasOwnProperty,n=Object.defineProperty||function(g,h,f){g[h]=f.value},s=typeof Symbol=="function"?Symbol:{},o=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function c(g,h,f){return Object.defineProperty(g,h,{value:f,enumerable:!0,configurable:!0,writable:!0}),g[h]}try{c({},"")}catch{c=function(f,F,T){return f[F]=T}}function p(g,h,f,F){var T=h&&h.prototype instanceof U?h:U,E=Object.create(T.prototype),_=new Fe(F||[]);return n(E,"_invoke",{value:ue(g,f,_)}),E}function d(g,h,f){try{return{type:"normal",arg:g.call(h,f)}}catch(F){return{type:"throw",arg:F}}}e.wrap=p;var v="suspendedStart",b="suspendedYield",x="executing",A="completed",C={};function U(){}function P(){}function k(){}var B={};c(B,o,function(){return this});var j=Object.getPrototypeOf,N=j&&j(j(Se([])));N&&N!==t&&i.call(N,o)&&(B=N);var D=k.prototype=U.prototype=Object.create(B);function V(g){["next","throw","return"].forEach(function(h){c(g,h,function(f){return this._invoke(h,f)})})}function G(g,h){function f(T,E,_,y){var w=d(g[T],g,E);if(w.type!=="throw"){var S=w.arg,O=S.value;return O&&Xe(O)=="object"&&i.call(O,"__await")?h.resolve(O.__await).then(function(R){f("next",R,_,y)},function(R){f("throw",R,_,y)}):h.resolve(O).then(function(R){S.value=R,_(S)},function(R){return f("throw",R,_,y)})}y(w.arg)}var F;n(this,"_invoke",{value:function(E,_){function y(){return new h(function(w,S){f(E,_,w,S)})}return F=F?F.then(y,y):y()}})}function ue(g,h,f){var F=v;return function(T,E){if(F===x)throw Error("Generator is already running");if(F===A){if(T==="throw")throw E;return{value:r,done:!0}}for(f.method=T,f.arg=E;;){var _=f.delegate;if(_){var y=K(_,f);if(y){if(y===C)continue;return y}}if(f.method==="next")f.sent=f._sent=f.arg;else if(f.method==="throw"){if(F===v)throw F=A,f.arg;f.dispatchException(f.arg)}else f.method==="return"&&f.abrupt("return",f.arg);F=x;var w=d(g,h,f);if(w.type==="normal"){if(F=f.done?A:b,w.arg===C)continue;return{value:w.arg,done:f.done}}w.type==="throw"&&(F=A,f.method="throw",f.arg=w.arg)}}}function K(g,h){var f=h.method,F=g.iterator[f];if(F===r)return h.delegate=null,f==="throw"&&g.iterator.return&&(h.method="return",h.arg=r,K(g,h),h.method==="throw")||f!=="return"&&(h.method="throw",h.arg=new TypeError("The iterator does not provide a '"+f+"' method")),C;var T=d(F,g.iterator,h.arg);if(T.type==="throw")return h.method="throw",h.arg=T.arg,h.delegate=null,C;var E=T.arg;return E?E.done?(h[g.resultName]=E.value,h.next=g.nextLoc,h.method!=="return"&&(h.method="next",h.arg=r),h.delegate=null,C):E:(h.method="throw",h.arg=new TypeError("iterator result is not an object"),h.delegate=null,C)}function se(g){var h={tryLoc:g[0]};1 in g&&(h.catchLoc=g[1]),2 in g&&(h.finallyLoc=g[2],h.afterLoc=g[3]),this.tryEntries.push(h)}function oe(g){var h=g.completion||{};h.type="normal",delete h.arg,g.completion=h}function Fe(g){this.tryEntries=[{tryLoc:"root"}],g.forEach(se,this),this.reset(!0)}function Se(g){if(g||g===""){var h=g[o];if(h)return h.call(g);if(typeof g.next=="function")return g;if(!isNaN(g.length)){var f=-1,F=function T(){for(;++f<g.length;)if(i.call(g,f))return T.value=g[f],T.done=!1,T;return T.value=r,T.done=!0,T};return F.next=F}}throw new TypeError(Xe(g)+" is not iterable")}return P.prototype=k,n(D,"constructor",{value:k,configurable:!0}),n(k,"constructor",{value:P,configurable:!0}),P.displayName=c(k,u,"GeneratorFunction"),e.isGeneratorFunction=function(g){var h=typeof g=="function"&&g.constructor;return!!h&&(h===P||(h.displayName||h.name)==="GeneratorFunction")},e.mark=function(g){return Object.setPrototypeOf?Object.setPrototypeOf(g,k):(g.__proto__=k,c(g,u,"GeneratorFunction")),g.prototype=Object.create(D),g},e.awrap=function(g){return{__await:g}},V(G.prototype),c(G.prototype,a,function(){return this}),e.AsyncIterator=G,e.async=function(g,h,f,F,T){T===void 0&&(T=Promise);var E=new G(p(g,h,f,F),T);return e.isGeneratorFunction(h)?E:E.next().then(function(_){return _.done?_.value:E.next()})},V(D),c(D,u,"Generator"),c(D,o,function(){return this}),c(D,"toString",function(){return"[object Generator]"}),e.keys=function(g){var h=Object(g),f=[];for(var F in h)f.push(F);return f.reverse(),function T(){for(;f.length;){var E=f.pop();if(E in h)return T.value=E,T.done=!1,T}return T.done=!0,T}},e.values=Se,Fe.prototype={constructor:Fe,reset:function(h){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(oe),!h)for(var f in this)f.charAt(0)==="t"&&i.call(this,f)&&!isNaN(+f.slice(1))&&(this[f]=r)},stop:function(){this.done=!0;var h=this.tryEntries[0].completion;if(h.type==="throw")throw h.arg;return this.rval},dispatchException:function(h){if(this.done)throw h;var f=this;function F(S,O){return _.type="throw",_.arg=h,f.next=S,O&&(f.method="next",f.arg=r),!!O}for(var T=this.tryEntries.length-1;T>=0;--T){var E=this.tryEntries[T],_=E.completion;if(E.tryLoc==="root")return F("end");if(E.tryLoc<=this.prev){var y=i.call(E,"catchLoc"),w=i.call(E,"finallyLoc");if(y&&w){if(this.prev<E.catchLoc)return F(E.catchLoc,!0);if(this.prev<E.finallyLoc)return F(E.finallyLoc)}else if(y){if(this.prev<E.catchLoc)return F(E.catchLoc,!0)}else{if(!w)throw Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return F(E.finallyLoc)}}}},abrupt:function(h,f){for(var F=this.tryEntries.length-1;F>=0;--F){var T=this.tryEntries[F];if(T.tryLoc<=this.prev&&i.call(T,"finallyLoc")&&this.prev<T.finallyLoc){var E=T;break}}E&&(h==="break"||h==="continue")&&E.tryLoc<=f&&f<=E.finallyLoc&&(E=null);var _=E?E.completion:{};return _.type=h,_.arg=f,E?(this.method="next",this.next=E.finallyLoc,C):this.complete(_)},complete:function(h,f){if(h.type==="throw")throw h.arg;return h.type==="break"||h.type==="continue"?this.next=h.arg:h.type==="return"?(this.rval=this.arg=h.arg,this.method="return",this.next="end"):h.type==="normal"&&f&&(this.next=f),C},finish:function(h){for(var f=this.tryEntries.length-1;f>=0;--f){var F=this.tryEntries[f];if(F.finallyLoc===h)return this.complete(F.completion,F.afterLoc),oe(F),C}},catch:function(h){for(var f=this.tryEntries.length-1;f>=0;--f){var F=this.tryEntries[f];if(F.tryLoc===h){var T=F.completion;if(T.type==="throw"){var E=T.arg;oe(F)}return E}}throw Error("illegal catch attempt")},delegateYield:function(h,f,F){return this.delegate={iterator:Se(h),resultName:f,nextLoc:F},this.method==="next"&&(this.arg=r),C}},e}function Cu(r,e,t,i,n,s,o){try{var a=r[s](o),u=a.value}catch(c){t(c);return}a.done?e(u):Promise.resolve(u).then(i,n)}function tf(r){return function(){var e=this,t=arguments;return new Promise(function(i,n){var s=r.apply(e,t);function o(u){Cu(s,i,n,o,a,"next",u)}function a(u){Cu(s,i,n,o,a,"throw",u)}o(void 0)})}}function Lu(r,e){return sf(r)||nf(r,e)||ju(r,e)||rf()}function rf(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nf(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var i,n,s,o,a=[],u=!0,c=!1;try{if(s=(t=t.call(r)).next,e===0){if(Object(t)!==t)return;u=!1}else for(;!(u=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);u=!0);}catch(p){c=!0,n=p}finally{try{if(!u&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(c)throw n}}return a}}function sf(r){if(Array.isArray(r))return r}function Xe(r){"@babel/helpers - typeof";return Xe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xe(r)}function of(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=ju(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var i=0,n=function(){};return{s:n,n:function(){return i>=r.length?{done:!0}:{done:!1,value:r[i++]}},e:function(c){throw c},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,o=!1,a;return{s:function(){t=t.call(r)},n:function(){var c=t.next();return s=c.done,c},e:function(c){o=!0,a=c},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(o)throw a}}}}function ju(r,e){if(r){if(typeof r=="string")return Uu(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Uu(r,e)}}function Uu(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=r[t];return i}function Au(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),t.push.apply(t,i)}return t}function yt(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Au(Object(t),!0).forEach(function(i){af(r,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Au(Object(t)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(t,i))})}return r}function af(r,e,t){return e=Mu(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function lf(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Ou(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,Mu(i.key),i)}}function uf(r,e,t){return e&&Ou(r.prototype,e),t&&Ou(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function Mu(r){var e=df(r,"string");return Xe(e)=="symbol"?e:e+""}function df(r,e){if(Xe(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var i=t.call(r,e||"default");if(Xe(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var oi="tus-v1",ai="ietf-draft-03",gr="ietf-draft-05",cf={endpoint:null,uploadUrl:null,metadata:{},metadataForPartialUploads:{},fingerprint:null,uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,onUploadUrlAvailable:null,overridePatchMethod:!1,headers:{},addRequestId:!1,onBeforeRequest:null,onAfterResponse:null,onShouldRetry:Hu,chunkSize:Number.POSITIVE_INFINITY,retryDelays:[0,1e3,3e3,5e3],parallelUploads:1,parallelUploadBoundaries:null,storeFingerprintForResuming:!0,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1,urlStorage:null,fileReader:null,httpStack:null,protocol:oi},qu=(function(){function r(e,t){lf(this,r),"resume"in t&&console.log("tus: The `resume` option has been removed in tus-js-client v2. Please use the URL storage API instead."),this.options=t,this.options.chunkSize=Number(this.options.chunkSize),this._urlStorage=this.options.urlStorage,this.file=e,this.url=null,this._req=null,this._fingerprint=null,this._urlStorageKey=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0,this._parallelUploads=null,this._parallelUploadUrls=null}return uf(r,[{key:"findPreviousUploads",value:function(){var t=this;return this.options.fingerprint(this.file,this.options).then(function(i){return t._urlStorage.findUploadsByFingerprint(i)})}},{key:"resumeFromPreviousUpload",value:function(t){this.url=t.uploadUrl||null,this._parallelUploadUrls=t.parallelUploadUrls||null,this._urlStorageKey=t.urlStorageKey}},{key:"start",value:function(){var t=this,i=this.file;if(!i){this._emitError(new Error("tus: no file or stream to upload provided"));return}if(![oi,ai,gr].includes(this.options.protocol)){this._emitError(new Error("tus: unsupported protocol ".concat(this.options.protocol)));return}if(!this.options.endpoint&&!this.options.uploadUrl&&!this.url){this._emitError(new Error("tus: neither an endpoint or an upload URL is provided"));return}var n=this.options.retryDelays;if(n!=null&&Object.prototype.toString.call(n)!=="[object Array]"){this._emitError(new Error("tus: the `retryDelays` option must either be an array or null"));return}if(this.options.parallelUploads>1)for(var s=0,o=["uploadUrl","uploadSize","uploadLengthDeferred"];s<o.length;s++){var a=o[s];if(this.options[a]){this._emitError(new Error("tus: cannot use the ".concat(a," option when parallelUploads is enabled")));return}}if(this.options.parallelUploadBoundaries){if(this.options.parallelUploads<=1){this._emitError(new Error("tus: cannot use the `parallelUploadBoundaries` option when `parallelUploads` is disabled"));return}if(this.options.parallelUploads!==this.options.parallelUploadBoundaries.length){this._emitError(new Error("tus: the `parallelUploadBoundaries` must have the same length as the value of `parallelUploads`"));return}}this.options.fingerprint(i,this.options).then(function(u){return u==null?je("No fingerprint was calculated meaning that the upload cannot be stored in the URL storage."):je("Calculated fingerprint: ".concat(u)),t._fingerprint=u,t._source?t._source:t.options.fileReader.openFile(i,t.options.chunkSize)}).then(function(u){if(t._source=u,t.options.uploadLengthDeferred)t._size=null;else if(t.options.uploadSize!=null){if(t._size=Number(t.options.uploadSize),Number.isNaN(t._size)){t._emitError(new Error("tus: cannot convert `uploadSize` option into a number"));return}}else if(t._size=t._source.size,t._size==null){t._emitError(new Error("tus: cannot automatically derive upload's size from input. Specify it manually using the `uploadSize` option or use the `uploadLengthDeferred` option"));return}t.options.parallelUploads>1||t._parallelUploadUrls!=null?t._startParallelUpload():t._startSingleUpload()}).catch(function(u){t._emitError(u)})}},{key:"_startParallelUpload",value:function(){var t,i=this,n=this._size,s=0;this._parallelUploads=[];var o=this._parallelUploadUrls!=null?this._parallelUploadUrls.length:this.options.parallelUploads,a=(t=this.options.parallelUploadBoundaries)!==null&&t!==void 0?t:hf(this._source.size,o);this._parallelUploadUrls&&a.forEach(function(p,d){p.uploadUrl=i._parallelUploadUrls[d]||null}),this._parallelUploadUrls=new Array(a.length);var u=a.map(function(p,d){var v=0;return i._source.slice(p.start,p.end).then(function(b){var x=b.value;return new Promise(function(A,C){var U=yt(yt({},i.options),{},{uploadUrl:p.uploadUrl||null,storeFingerprintForResuming:!1,removeFingerprintOnSuccess:!1,parallelUploads:1,parallelUploadBoundaries:null,metadata:i.options.metadataForPartialUploads,headers:yt(yt({},i.options.headers),{},{"Upload-Concat":"partial"}),onSuccess:A,onError:C,onProgress:function(B){s=s-v+B,v=B,i._emitProgress(s,n)},onUploadUrlAvailable:function(){i._parallelUploadUrls[d]=P.url,i._parallelUploadUrls.filter(function(B){return!!B}).length===a.length&&i._saveUploadInUrlStorage()}}),P=new r(x,U);P.start(),i._parallelUploads.push(P)})})}),c;Promise.all(u).then(function(){c=i._openRequest("POST",i.options.endpoint),c.setHeader("Upload-Concat","final;".concat(i._parallelUploadUrls.join(" ")));var p=Iu(i.options.metadata);return p!==""&&c.setHeader("Upload-Metadata",p),i._sendRequest(c,null)}).then(function(p){if(!bt(p.getStatus(),200)){i._emitHttpError(c,p,"tus: unexpected response while creating upload");return}var d=p.getHeader("Location");if(d==null){i._emitHttpError(c,p,"tus: invalid or missing Location header");return}i.url=Du(i.options.endpoint,d),je("Created upload at ".concat(i.url)),i._emitSuccess(p)}).catch(function(p){i._emitError(p)})}},{key:"_startSingleUpload",value:function(){if(this._aborted=!1,this.url!=null){je("Resuming upload from previous URL: ".concat(this.url)),this._resumeUpload();return}if(this.options.uploadUrl!=null){je("Resuming upload from provided URL: ".concat(this.options.uploadUrl)),this.url=this.options.uploadUrl,this._resumeUpload();return}je("Creating a new upload"),this._createUpload()}},{key:"abort",value:function(t){var i=this;if(this._parallelUploads!=null){var n=of(this._parallelUploads),s;try{for(n.s();!(s=n.n()).done;){var o=s.value;o.abort(t)}}catch(a){n.e(a)}finally{n.f()}}return this._req!==null&&this._req.abort(),this._aborted=!0,this._retryTimeout!=null&&(clearTimeout(this._retryTimeout),this._retryTimeout=null),!t||this.url==null?Promise.resolve():r.terminate(this.url,this.options).then(function(){return i._removeFromUrlStorage()})}},{key:"_emitHttpError",value:function(t,i,n,s){this._emitError(new ft(n,s,t,i))}},{key:"_emitError",value:function(t){var i=this;if(!this._aborted){if(this.options.retryDelays!=null){var n=this._offset!=null&&this._offset>this._offsetBeforeRetry;if(n&&(this._retryAttempt=0),Bu(t,this._retryAttempt,this.options)){var s=this.options.retryDelays[this._retryAttempt++];this._offsetBeforeRetry=this._offset,this._retryTimeout=setTimeout(function(){i.start()},s);return}}if(typeof this.options.onError=="function")this.options.onError(t);else throw t}}},{key:"_emitSuccess",value:function(t){this.options.removeFingerprintOnSuccess&&this._removeFromUrlStorage(),typeof this.options.onSuccess=="function"&&this.options.onSuccess({lastResponse:t})}},{key:"_emitProgress",value:function(t,i){typeof this.options.onProgress=="function"&&this.options.onProgress(t,i)}},{key:"_emitChunkComplete",value:function(t,i,n){typeof this.options.onChunkComplete=="function"&&this.options.onChunkComplete(t,i,n)}},{key:"_createUpload",value:function(){var t=this;if(!this.options.endpoint){this._emitError(new Error("tus: unable to create upload because no endpoint is provided"));return}var i=this._openRequest("POST",this.options.endpoint);this.options.uploadLengthDeferred?i.setHeader("Upload-Defer-Length","1"):i.setHeader("Upload-Length","".concat(this._size));var n=Iu(this.options.metadata);n!==""&&i.setHeader("Upload-Metadata",n);var s;this.options.uploadDataDuringCreation&&!this.options.uploadLengthDeferred?(this._offset=0,s=this._addChunkToRequest(i)):((this.options.protocol===ai||this.options.protocol===gr)&&i.setHeader("Upload-Complete","?0"),s=this._sendRequest(i,null)),s.then(function(o){if(!bt(o.getStatus(),200)){t._emitHttpError(i,o,"tus: unexpected response while creating upload");return}var a=o.getHeader("Location");if(a==null){t._emitHttpError(i,o,"tus: invalid or missing Location header");return}if(t.url=Du(t.options.endpoint,a),je("Created upload at ".concat(t.url)),typeof t.options.onUploadUrlAvailable=="function"&&t.options.onUploadUrlAvailable(),t._size===0){t._emitSuccess(o),t._source.close();return}t._saveUploadInUrlStorage().then(function(){t.options.uploadDataDuringCreation?t._handleUploadResponse(i,o):(t._offset=0,t._performUpload())})}).catch(function(o){t._emitHttpError(i,null,"tus: failed to create upload",o)})}},{key:"_resumeUpload",value:function(){var t=this,i=this._openRequest("HEAD",this.url),n=this._sendRequest(i,null);n.then(function(s){var o=s.getStatus();if(!bt(o,200)){if(o===423){t._emitHttpError(i,s,"tus: upload is currently locked; retry later");return}if(bt(o,400)&&t._removeFromUrlStorage(),!t.options.endpoint){t._emitHttpError(i,s,"tus: unable to resume upload (new upload cannot be created without an endpoint)");return}t.url=null,t._createUpload();return}var a=Number.parseInt(s.getHeader("Upload-Offset"),10);if(Number.isNaN(a)){t._emitHttpError(i,s,"tus: invalid or missing offset value");return}var u=Number.parseInt(s.getHeader("Upload-Length"),10);if(Number.isNaN(u)&&!t.options.uploadLengthDeferred&&t.options.protocol===oi){t._emitHttpError(i,s,"tus: invalid or missing length value");return}typeof t.options.onUploadUrlAvailable=="function"&&t.options.onUploadUrlAvailable(),t._saveUploadInUrlStorage().then(function(){if(a===u){t._emitProgress(u,u),t._emitSuccess(s);return}t._offset=a,t._performUpload()})}).catch(function(s){t._emitHttpError(i,null,"tus: failed to resume upload",s)})}},{key:"_performUpload",value:function(){var t=this;if(!this._aborted){var i;this.options.overridePatchMethod?(i=this._openRequest("POST",this.url),i.setHeader("X-HTTP-Method-Override","PATCH")):i=this._openRequest("PATCH",this.url),i.setHeader("Upload-Offset","".concat(this._offset));var n=this._addChunkToRequest(i);n.then(function(s){if(!bt(s.getStatus(),200)){t._emitHttpError(i,s,"tus: unexpected response while uploading chunk");return}t._handleUploadResponse(i,s)}).catch(function(s){t._aborted||t._emitHttpError(i,null,"tus: failed to upload chunk at offset ".concat(t._offset),s)})}}},{key:"_addChunkToRequest",value:function(t){var i=this,n=this._offset,s=this._offset+this.options.chunkSize;return t.setProgressHandler(function(o){i._emitProgress(n+o,i._size)}),this.options.protocol===oi?t.setHeader("Content-Type","application/offset+octet-stream"):this.options.protocol===gr&&t.setHeader("Content-Type","application/partial-upload"),(s===Number.POSITIVE_INFINITY||s>this._size)&&!this.options.uploadLengthDeferred&&(s=this._size),this._source.slice(n,s).then(function(o){var a=o.value,u=o.done,c=a!=null&&a.size?a.size:0;i.options.uploadLengthDeferred&&u&&(i._size=i._offset+c,t.setHeader("Upload-Length","".concat(i._size)));var p=i._offset+c;return!i.options.uploadLengthDeferred&&u&&p!==i._size?Promise.reject(new Error("upload was configured with a size of ".concat(i._size," bytes, but the source is done after ").concat(p," bytes"))):a===null?i._sendRequest(t):((i.options.protocol===ai||i.options.protocol===gr)&&t.setHeader("Upload-Complete",u?"?1":"?0"),i._emitProgress(i._offset,i._size),i._sendRequest(t,a))})}},{key:"_handleUploadResponse",value:function(t,i){var n=Number.parseInt(i.getHeader("Upload-Offset"),10);if(Number.isNaN(n)){this._emitHttpError(t,i,"tus: invalid or missing offset value");return}if(this._emitProgress(n,this._size),this._emitChunkComplete(n-this._offset,n,this._size),this._offset=n,n===this._size){this._emitSuccess(i),this._source.close();return}this._performUpload()}},{key:"_openRequest",value:function(t,i){var n=Ru(t,i,this.options);return this._req=n,n}},{key:"_removeFromUrlStorage",value:function(){var t=this;this._urlStorageKey&&(this._urlStorage.removeUpload(this._urlStorageKey).catch(function(i){t._emitError(i)}),this._urlStorageKey=null)}},{key:"_saveUploadInUrlStorage",value:function(){var t=this;if(!this.options.storeFingerprintForResuming||!this._fingerprint||this._urlStorageKey!==null)return Promise.resolve();var i={size:this._size,metadata:this.options.metadata,creationTime:new Date().toString()};return this._parallelUploads?i.parallelUploadUrls=this._parallelUploadUrls:i.uploadUrl=this.url,this._urlStorage.addUpload(this._fingerprint,i).then(function(n){t._urlStorageKey=n})}},{key:"_sendRequest",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return Nu(t,i,this.options)}}],[{key:"terminate",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=Ru("DELETE",t,i);return Nu(n,null,i).then(function(s){if(s.getStatus()!==204)throw new ft("tus: unexpected response while terminating upload",null,n,s)}).catch(function(s){if(s instanceof ft||(s=new ft("tus: failed to terminate upload",s,n,null)),!Bu(s,0,i))throw s;var o=i.retryDelays[0],a=i.retryDelays.slice(1),u=yt(yt({},i),{},{retryDelays:a});return new Promise(function(c){return setTimeout(c,o)}).then(function(){return r.terminate(t,u)})})}}])})();function Iu(r){return Object.entries(r).map(function(e){var t=Lu(e,2),i=t[0],n=t[1];return"".concat(i," ").concat(mu.encode(String(n)))}).join(",")}function bt(r,e){return r>=e&&r<e+100}function Ru(r,e,t){var i=t.httpStack.createRequest(r,e);t.protocol===ai?i.setHeader("Upload-Draft-Interop-Version","5"):t.protocol===gr?i.setHeader("Upload-Draft-Interop-Version","6"):i.setHeader("Tus-Resumable","1.0.0");for(var n=t.headers||{},s=0,o=Object.entries(n);s<o.length;s++){var a=Lu(o[s],2),u=a[0],c=a[1];i.setHeader(u,c)}if(t.addRequestId){var p=as();i.setHeader("X-Request-ID",p)}return i}function Nu(r,e,t){return us.apply(this,arguments)}function us(){return us=tf(ls().mark(function r(e,t,i){var n;return ls().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(typeof i.onBeforeRequest!="function"){o.next=3;break}return o.next=3,i.onBeforeRequest(e);case 3:return o.next=5,e.send(t);case 5:if(n=o.sent,typeof i.onAfterResponse!="function"){o.next=9;break}return o.next=9,i.onAfterResponse(e,n);case 9:return o.abrupt("return",n);case 10:case"end":return o.stop()}},r)})),us.apply(this,arguments)}function pf(){var r=!0;return typeof navigator<"u"&&navigator.onLine===!1&&(r=!1),r}function Bu(r,e,t){return t.retryDelays==null||e>=t.retryDelays.length||r.originalRequest==null?!1:t&&typeof t.onShouldRetry=="function"?t.onShouldRetry(r,e,t):Hu(r)}function Hu(r){var e=r.originalResponse?r.originalResponse.getStatus():0;return(!bt(e,400)||e===409||e===423)&&pf()}function Du(r,e){return new zu.default(e,r).toString()}function hf(r,e){for(var t=Math.floor(r/e),i=[],n=0;n<e;n++)i.push({start:t*n,end:t*(n+1)});return i[e-1].end=r,i}qu.defaultOptions=cf;var li=qu;var ff=function(){return typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative"},ui=ff;function ds(r){return new Promise(function(e,t){var i=new XMLHttpRequest;i.responseType="blob",i.onload=function(){var n=i.response;e(n)},i.onerror=function(n){t(n)},i.open("GET",r),i.send()})}var mf=function(){return typeof window<"u"&&(typeof window.PhoneGap<"u"||typeof window.Cordova<"u"||typeof window.cordova<"u")},$u=mf;function cs(r){return new Promise(function(e,t){var i=new FileReader;i.onload=function(){var n=new Uint8Array(i.result);e({value:n})},i.onerror=function(n){t(n)},i.readAsArrayBuffer(r)})}function yr(r){"@babel/helpers - typeof";return yr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yr(r)}function gf(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Vu(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,bf(i.key),i)}}function yf(r,e,t){return e&&Vu(r.prototype,e),t&&Vu(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function bf(r){var e=vf(r,"string");return yr(e)=="symbol"?e:e+""}function vf(r,e){if(yr(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var i=t.call(r,e||"default");if(yr(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var ps=(function(){function r(e){gf(this,r),this._file=e,this.size=e.size}return yf(r,[{key:"slice",value:function(t,i){if($u())return cs(this._file.slice(t,i));var n=this._file.slice(t,i),s=i>=this.size;return Promise.resolve({value:n,done:s})}},{key:"close",value:function(){}}])})();function br(r){"@babel/helpers - typeof";return br=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},br(r)}function wf(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Wu(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,xf(i.key),i)}}function _f(r,e,t){return e&&Wu(r.prototype,e),t&&Wu(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function xf(r){var e=Sf(r,"string");return br(e)=="symbol"?e:e+""}function Sf(r,e){if(br(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var i=t.call(r,e||"default");if(br(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Gu(r){return r===void 0?0:r.size!==void 0?r.size:r.length}function Ff(r,e){if(r.concat)return r.concat(e);if(r instanceof Blob)return new Blob([r,e],{type:r.type});if(r.set){var t=new r.constructor(r.length+e.length);return t.set(r),t.set(e,r.length),t}throw new Error("Unknown data type")}var Ku=(function(){function r(e){wf(this,r),this._buffer=void 0,this._bufferOffset=0,this._reader=e,this._done=!1}return _f(r,[{key:"slice",value:function(t,i){return t<this._bufferOffset?Promise.reject(new Error("Requested data is before the reader's current offset")):this._readUntilEnoughDataOrDone(t,i)}},{key:"_readUntilEnoughDataOrDone",value:function(t,i){var n=this,s=i<=this._bufferOffset+Gu(this._buffer);if(this._done||s){var o=this._getDataFromBuffer(t,i),a=o==null?this._done:!1;return Promise.resolve({value:o,done:a})}return this._reader.read().then(function(u){var c=u.value,p=u.done;return p?n._done=!0:n._buffer===void 0?n._buffer=c:n._buffer=Ff(n._buffer,c),n._readUntilEnoughDataOrDone(t,i)})}},{key:"_getDataFromBuffer",value:function(t,i){t>this._bufferOffset&&(this._buffer=this._buffer.slice(t-this._bufferOffset),this._bufferOffset=t);var n=Gu(this._buffer)===0;return this._done&&n?null:this._buffer.slice(0,i-t)}},{key:"close",value:function(){this._reader.cancel&&this._reader.cancel()}}])})();function Ye(r){"@babel/helpers - typeof";return Ye=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ye(r)}function hs(){"use strict";hs=function(){return e};var r,e={},t=Object.prototype,i=t.hasOwnProperty,n=Object.defineProperty||function(g,h,f){g[h]=f.value},s=typeof Symbol=="function"?Symbol:{},o=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function c(g,h,f){return Object.defineProperty(g,h,{value:f,enumerable:!0,configurable:!0,writable:!0}),g[h]}try{c({},"")}catch{c=function(f,F,T){return f[F]=T}}function p(g,h,f,F){var T=h&&h.prototype instanceof U?h:U,E=Object.create(T.prototype),_=new Fe(F||[]);return n(E,"_invoke",{value:ue(g,f,_)}),E}function d(g,h,f){try{return{type:"normal",arg:g.call(h,f)}}catch(F){return{type:"throw",arg:F}}}e.wrap=p;var v="suspendedStart",b="suspendedYield",x="executing",A="completed",C={};function U(){}function P(){}function k(){}var B={};c(B,o,function(){return this});var j=Object.getPrototypeOf,N=j&&j(j(Se([])));N&&N!==t&&i.call(N,o)&&(B=N);var D=k.prototype=U.prototype=Object.create(B);function V(g){["next","throw","return"].forEach(function(h){c(g,h,function(f){return this._invoke(h,f)})})}function G(g,h){function f(T,E,_,y){var w=d(g[T],g,E);if(w.type!=="throw"){var S=w.arg,O=S.value;return O&&Ye(O)=="object"&&i.call(O,"__await")?h.resolve(O.__await).then(function(R){f("next",R,_,y)},function(R){f("throw",R,_,y)}):h.resolve(O).then(function(R){S.value=R,_(S)},function(R){return f("throw",R,_,y)})}y(w.arg)}var F;n(this,"_invoke",{value:function(E,_){function y(){return new h(function(w,S){f(E,_,w,S)})}return F=F?F.then(y,y):y()}})}function ue(g,h,f){var F=v;return function(T,E){if(F===x)throw Error("Generator is already running");if(F===A){if(T==="throw")throw E;return{value:r,done:!0}}for(f.method=T,f.arg=E;;){var _=f.delegate;if(_){var y=K(_,f);if(y){if(y===C)continue;return y}}if(f.method==="next")f.sent=f._sent=f.arg;else if(f.method==="throw"){if(F===v)throw F=A,f.arg;f.dispatchException(f.arg)}else f.method==="return"&&f.abrupt("return",f.arg);F=x;var w=d(g,h,f);if(w.type==="normal"){if(F=f.done?A:b,w.arg===C)continue;return{value:w.arg,done:f.done}}w.type==="throw"&&(F=A,f.method="throw",f.arg=w.arg)}}}function K(g,h){var f=h.method,F=g.iterator[f];if(F===r)return h.delegate=null,f==="throw"&&g.iterator.return&&(h.method="return",h.arg=r,K(g,h),h.method==="throw")||f!=="return"&&(h.method="throw",h.arg=new TypeError("The iterator does not provide a '"+f+"' method")),C;var T=d(F,g.iterator,h.arg);if(T.type==="throw")return h.method="throw",h.arg=T.arg,h.delegate=null,C;var E=T.arg;return E?E.done?(h[g.resultName]=E.value,h.next=g.nextLoc,h.method!=="return"&&(h.method="next",h.arg=r),h.delegate=null,C):E:(h.method="throw",h.arg=new TypeError("iterator result is not an object"),h.delegate=null,C)}function se(g){var h={tryLoc:g[0]};1 in g&&(h.catchLoc=g[1]),2 in g&&(h.finallyLoc=g[2],h.afterLoc=g[3]),this.tryEntries.push(h)}function oe(g){var h=g.completion||{};h.type="normal",delete h.arg,g.completion=h}function Fe(g){this.tryEntries=[{tryLoc:"root"}],g.forEach(se,this),this.reset(!0)}function Se(g){if(g||g===""){var h=g[o];if(h)return h.call(g);if(typeof g.next=="function")return g;if(!isNaN(g.length)){var f=-1,F=function T(){for(;++f<g.length;)if(i.call(g,f))return T.value=g[f],T.done=!1,T;return T.value=r,T.done=!0,T};return F.next=F}}throw new TypeError(Ye(g)+" is not iterable")}return P.prototype=k,n(D,"constructor",{value:k,configurable:!0}),n(k,"constructor",{value:P,configurable:!0}),P.displayName=c(k,u,"GeneratorFunction"),e.isGeneratorFunction=function(g){var h=typeof g=="function"&&g.constructor;return!!h&&(h===P||(h.displayName||h.name)==="GeneratorFunction")},e.mark=function(g){return Object.setPrototypeOf?Object.setPrototypeOf(g,k):(g.__proto__=k,c(g,u,"GeneratorFunction")),g.prototype=Object.create(D),g},e.awrap=function(g){return{__await:g}},V(G.prototype),c(G.prototype,a,function(){return this}),e.AsyncIterator=G,e.async=function(g,h,f,F,T){T===void 0&&(T=Promise);var E=new G(p(g,h,f,F),T);return e.isGeneratorFunction(h)?E:E.next().then(function(_){return _.done?_.value:E.next()})},V(D),c(D,u,"Generator"),c(D,o,function(){return this}),c(D,"toString",function(){return"[object Generator]"}),e.keys=function(g){var h=Object(g),f=[];for(var F in h)f.push(F);return f.reverse(),function T(){for(;f.length;){var E=f.pop();if(E in h)return T.value=E,T.done=!1,T}return T.done=!0,T}},e.values=Se,Fe.prototype={constructor:Fe,reset:function(h){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(oe),!h)for(var f in this)f.charAt(0)==="t"&&i.call(this,f)&&!isNaN(+f.slice(1))&&(this[f]=r)},stop:function(){this.done=!0;var h=this.tryEntries[0].completion;if(h.type==="throw")throw h.arg;return this.rval},dispatchException:function(h){if(this.done)throw h;var f=this;function F(S,O){return _.type="throw",_.arg=h,f.next=S,O&&(f.method="next",f.arg=r),!!O}for(var T=this.tryEntries.length-1;T>=0;--T){var E=this.tryEntries[T],_=E.completion;if(E.tryLoc==="root")return F("end");if(E.tryLoc<=this.prev){var y=i.call(E,"catchLoc"),w=i.call(E,"finallyLoc");if(y&&w){if(this.prev<E.catchLoc)return F(E.catchLoc,!0);if(this.prev<E.finallyLoc)return F(E.finallyLoc)}else if(y){if(this.prev<E.catchLoc)return F(E.catchLoc,!0)}else{if(!w)throw Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return F(E.finallyLoc)}}}},abrupt:function(h,f){for(var F=this.tryEntries.length-1;F>=0;--F){var T=this.tryEntries[F];if(T.tryLoc<=this.prev&&i.call(T,"finallyLoc")&&this.prev<T.finallyLoc){var E=T;break}}E&&(h==="break"||h==="continue")&&E.tryLoc<=f&&f<=E.finallyLoc&&(E=null);var _=E?E.completion:{};return _.type=h,_.arg=f,E?(this.method="next",this.next=E.finallyLoc,C):this.complete(_)},complete:function(h,f){if(h.type==="throw")throw h.arg;return h.type==="break"||h.type==="continue"?this.next=h.arg:h.type==="return"?(this.rval=this.arg=h.arg,this.method="return",this.next="end"):h.type==="normal"&&f&&(this.next=f),C},finish:function(h){for(var f=this.tryEntries.length-1;f>=0;--f){var F=this.tryEntries[f];if(F.finallyLoc===h)return this.complete(F.completion,F.afterLoc),oe(F),C}},catch:function(h){for(var f=this.tryEntries.length-1;f>=0;--f){var F=this.tryEntries[f];if(F.tryLoc===h){var T=F.completion;if(T.type==="throw"){var E=T.arg;oe(F)}return E}}throw Error("illegal catch attempt")},delegateYield:function(h,f,F){return this.delegate={iterator:Se(h),resultName:f,nextLoc:F},this.method==="next"&&(this.arg=r),C}},e}function Xu(r,e,t,i,n,s,o){try{var a=r[s](o),u=a.value}catch(c){t(c);return}a.done?e(u):Promise.resolve(u).then(i,n)}function Pf(r){return function(){var e=this,t=arguments;return new Promise(function(i,n){var s=r.apply(e,t);function o(u){Xu(s,i,n,o,a,"next",u)}function a(u){Xu(s,i,n,o,a,"throw",u)}o(void 0)})}}function Ef(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Yu(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,kf(i.key),i)}}function Tf(r,e,t){return e&&Yu(r.prototype,e),t&&Yu(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function kf(r){var e=Cf(r,"string");return Ye(e)=="symbol"?e:e+""}function Cf(r,e){if(Ye(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var i=t.call(r,e||"default");if(Ye(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Qu=(function(){function r(){Ef(this,r)}return Tf(r,[{key:"openFile",value:(function(){var e=Pf(hs().mark(function i(n,s){var o;return hs().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!(ui()&&n&&typeof n.uri<"u")){u.next=11;break}return u.prev=1,u.next=4,ds(n.uri);case 4:return o=u.sent,u.abrupt("return",new ps(o));case 8:throw u.prev=8,u.t0=u.catch(1),new Error("tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. ".concat(u.t0));case 11:if(!(typeof n.slice=="function"&&typeof n.size<"u")){u.next=13;break}return u.abrupt("return",Promise.resolve(new ps(n)));case 13:if(typeof n.read!="function"){u.next=18;break}if(s=Number(s),Number.isFinite(s)){u.next=17;break}return u.abrupt("return",Promise.reject(new Error("cannot create source for stream without a finite value for the `chunkSize` option")));case 17:return u.abrupt("return",Promise.resolve(new Ku(n,s)));case 18:return u.abrupt("return",Promise.reject(new Error("source object may only be an instance of File, Blob, or Reader in this environment")));case 19:case"end":return u.stop()}},i,null,[[1,8]])}));function t(i,n){return e.apply(this,arguments)}return t})()}])})();function fs(r,e){return ui()?Promise.resolve(Uf(r,e)):Promise.resolve(["tus-br",r.name,r.type,r.size,r.lastModified,e.endpoint].join("-"))}function Uf(r,e){var t=r.exif?Af(JSON.stringify(r.exif)):"noexif";return["tus-rn",r.name||"noname",r.size||"nosize",t,e.endpoint].join("/")}function Af(r){var e=0;if(r.length===0)return e;for(var t=0;t<r.length;t++){var i=r.charCodeAt(t);e=(e<<5)-e+i,e&=e}return e}function vr(r){"@babel/helpers - typeof";return vr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vr(r)}function ms(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Ju(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,Of(i.key),i)}}function gs(r,e,t){return e&&Ju(r.prototype,e),t&&Ju(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function Of(r){var e=If(r,"string");return vr(e)=="symbol"?e:e+""}function If(r,e){if(vr(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var i=t.call(r,e||"default");if(vr(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Zu=(function(){function r(){ms(this,r)}return gs(r,[{key:"createRequest",value:function(t,i){return new Rf(t,i)}},{key:"getName",value:function(){return"XHRHttpStack"}}])})();var Rf=(function(){function r(e,t){ms(this,r),this._xhr=new XMLHttpRequest,this._xhr.open(e,t,!0),this._method=e,this._url=t,this._headers={}}return gs(r,[{key:"getMethod",value:function(){return this._method}},{key:"getURL",value:function(){return this._url}},{key:"setHeader",value:function(t,i){this._xhr.setRequestHeader(t,i),this._headers[t]=i}},{key:"getHeader",value:function(t){return this._headers[t]}},{key:"setProgressHandler",value:function(t){"upload"in this._xhr&&(this._xhr.upload.onprogress=function(i){i.lengthComputable&&t(i.loaded)})}},{key:"send",value:function(){var t=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return new Promise(function(n,s){t._xhr.onload=function(){n(new Nf(t._xhr))},t._xhr.onerror=function(o){s(o)},t._xhr.send(i)})}},{key:"abort",value:function(){return this._xhr.abort(),Promise.resolve()}},{key:"getUnderlyingObject",value:function(){return this._xhr}}])})(),Nf=(function(){function r(e){ms(this,r),this._xhr=e}return gs(r,[{key:"getStatus",value:function(){return this._xhr.status}},{key:"getHeader",value:function(t){return this._xhr.getResponseHeader(t)}},{key:"getBody",value:function(){return this._xhr.responseText}},{key:"getUnderlyingObject",value:function(){return this._xhr}}])})();function wr(r){"@babel/helpers - typeof";return wr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wr(r)}function Bf(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function ed(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,Lf(i.key),i)}}function Df(r,e,t){return e&&ed(r.prototype,e),t&&ed(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function Lf(r){var e=jf(r,"string");return wr(e)=="symbol"?e:e+""}function jf(r,e){if(wr(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var i=t.call(r,e||"default");if(wr(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var bs=!1;try{bs="localStorage"in window,di="tusSupport",ys=localStorage.getItem(di),localStorage.setItem(di,ys),ys===null&&localStorage.removeItem(di)}catch(r){if(r.code===r.SECURITY_ERR||r.code===r.QUOTA_EXCEEDED_ERR)bs=!1;else throw r}var di,ys,td=bs,rd=(function(){function r(){Bf(this,r)}return Df(r,[{key:"findAllUploads",value:function(){var t=this._findEntries("tus::");return Promise.resolve(t)}},{key:"findUploadsByFingerprint",value:function(t){var i=this._findEntries("tus::".concat(t,"::"));return Promise.resolve(i)}},{key:"removeUpload",value:function(t){return localStorage.removeItem(t),Promise.resolve()}},{key:"addUpload",value:function(t,i){var n=Math.round(Math.random()*1e12),s="tus::".concat(t,"::").concat(n);return localStorage.setItem(s,JSON.stringify(i)),Promise.resolve(s)}},{key:"_findEntries",value:function(t){for(var i=[],n=0;n<localStorage.length;n++){var s=localStorage.key(n);if(s.indexOf(t)===0)try{var o=JSON.parse(localStorage.getItem(s));o.urlStorageKey=s,i.push(o)}catch{}}return i}}])})();function wt(r){"@babel/helpers - typeof";return wt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wt(r)}function Mf(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function id(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,od(i.key),i)}}function zf(r,e,t){return e&&id(r.prototype,e),t&&id(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function qf(r,e,t){return e=ci(e),Hf(r,sd()?Reflect.construct(e,t||[],ci(r).constructor):e.apply(r,t))}function Hf(r,e){if(e&&(wt(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $f(r)}function $f(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function sd(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(sd=function(){return!!r})()}function ci(r){return ci=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ci(r)}function Vf(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&vs(r,e)}function vs(r,e){return vs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,n){return i.__proto__=n,i},vs(r,e)}function nd(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),t.push.apply(t,i)}return t}function vt(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?nd(Object(t),!0).forEach(function(i){Wf(r,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):nd(Object(t)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(t,i))})}return r}function Wf(r,e,t){return e=od(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function od(r){var e=Gf(r,"string");return wt(e)=="symbol"?e:e+""}function Gf(r,e){if(wt(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var i=t.call(r,e||"default");if(wt(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var pi=vt(vt({},li.defaultOptions),{},{httpStack:new Zu,fileReader:new Qu,urlStorage:td?new rd:new Yl,fingerprint:fs}),ad=(function(r){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Mf(this,e),i=vt(vt({},pi),i),qf(this,e,[t,i])}return Vf(e,r),zf(e,null,[{key:"terminate",value:function(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return n=vt(vt({},pi),n),li.terminate(i,n)}}])})(li),e_=typeof XMLHttpRequest=="function"&&typeof Blob=="function"&&typeof Blob.prototype.slice=="function";var ud={name:"@uppy/tus",description:"Resumable uploads for Uppy using Tus.io",version:"5.0.1",license:"MIT",type:"module",sideEffects:!1,scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","uppy","uppy-plugin","upload","resumable","tus"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],exports:{".":"./lib/index.js","./package.json":"./package.json"},dependencies:{"@uppy/companion-client":"^5.0.1","@uppy/utils":"^7.0.2","tus-js-client":"^4.2.3"},devDependencies:{"@uppy/core":"^5.0.2",jsdom:"^26.1.0",typescript:"^5.8.3",vitest:"^3.2.4"},peerDependencies:{"@uppy/core":"^5.0.2"}};function Xf(){return typeof window<"u"&&(typeof window.PhoneGap<"u"||typeof window.Cordova<"u"||typeof window.cordova<"u")}function Yf(){return typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative"}function ws(r){return(e,t)=>{if(Xf()||Yf())return pi.fingerprint(e,t);let i=["tus",r.id,t.endpoint].join("-");return Promise.resolve(i)}}var cd={endpoint:"",uploadUrl:null,metadata:{},uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,overridePatchMethod:!1,headers:{},addRequestId:!1,chunkSize:1/0,retryDelays:[100,1e3,3e3,5e3],parallelUploads:1,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1},Qf={limit:20,retryDelays:cd.retryDelays,withCredentials:!1,allowedMetaFields:!0},dd=class extends Ne{static VERSION=ud.version;#e;requests;uploaders;uploaderEvents;constructor(e,t){if(super(e,m(m({},Qf),t)),this.type="uploader",this.id=this.opts.id||"Tus",t?.allowedMetaFields===void 0&&"metaFields"in this.opts)throw new Error("The `metaFields` option has been renamed to `allowedMetaFields`.");if("autoRetry"in t)throw new Error("The `autoRetry` option was deprecated and has been removed.");this.requests=this.opts.rateLimitedQueue??new ze(this.opts.limit),this.#e=this.opts.retryDelays?.values(),this.uploaders=Object.create(null),this.uploaderEvents=Object.create(null)}resetUploaderReferences(e,t){let i=this.uploaders[e];i&&(i.abort(),t?.abort&&i.abort(!0),this.uploaders[e]=null),this.uploaderEvents[e]&&(this.uploaderEvents[e].remove(),this.uploaderEvents[e]=null)}#t(e){return this.resetUploaderReferences(e.id),new Promise((t,i)=>{let n,s,o,a=m(m({},this.opts),e.tus||{});typeof a.headers=="function"&&(a.headers=a.headers(e));let U=a,{onShouldRetry:u,onBeforeRequest:c}=U,p=et(U,["onShouldRetry","onBeforeRequest"]),d=m(m({},cd),p);d.fingerprint=ws(e),d.onBeforeRequest=async P=>{let k=P.getUnderlyingObject();k.withCredentials=!!a.withCredentials;let B;if(typeof c=="function"&&(B=c(P,e)),tt(n,"shouldBeRequeued")){if(!n.shouldBeRequeued)return Promise.reject();let j,N=new Promise(D=>{j=D});n=this.requests.run(()=>(e.isPaused&&n.abort(),j(),()=>{})),await Promise.all([N,B]);return}return B},d.onError=P=>{this.uppy.log(P);let k=P.originalRequest!=null?P.originalRequest.getUnderlyingObject():null;Ai(k)&&(P=new _i(P,k)),this.resetUploaderReferences(e.id),n?.abort(),typeof a.onError=="function"&&a.onError(P),i(P)},d.onProgress=(P,k)=>{this.onReceiveUploadUrl(e,o.url),typeof a.onProgress=="function"&&a.onProgress(P,k);let B=this.uppy.getFile(e.id);this.uppy.emit("upload-progress",B,{uploadStarted:B.progress.uploadStarted??0,bytesUploaded:P,bytesTotal:k})},d.onSuccess=P=>{let k={uploadURL:o.url??void 0,status:200,body:{xhr:P.lastResponse.getUnderlyingObject()}};if(this.uppy.emit("upload-success",this.uppy.getFile(e.id),k),this.resetUploaderReferences(e.id),n.done(),o.url){let{name:B}=o.file;this.uppy.log(`Download ${B} from ${o.url}`)}typeof a.onSuccess=="function"&&a.onSuccess(P),t(o)};let v=P=>{let k=P?.originalResponse?.getStatus();if(k===429){if(!this.requests.isPaused){let B=this.#e?.next();if(B==null||B.done)return!1;this.requests.rateLimit(B.value)}}else{if(k!=null&&k>=400&&k<500&&k!==409&&k!==423)return!1;typeof navigator<"u"&&navigator.onLine===!1&&(this.requests.isPaused||(this.requests.pause(),window.addEventListener("online",()=>{this.requests.resume()},{once:!0})))}return n.abort(),n={shouldBeRequeued:!0,abort(){this.shouldBeRequeued=!1},done(){throw new Error("Cannot mark a queued request as done: this indicates a bug")},fn(){throw new Error("Cannot run a queued request: this indicates a bug")}},!0};u!=null?d.onShouldRetry=(P,k)=>u(P,k,a,v):d.onShouldRetry=v;let b=(P,k,B)=>{tt(P,k)&&!tt(P,B)&&(P[B]=P[k])},x={};xr(a.allowedMetaFields,e.meta).forEach(P=>{x[P]=String(e.meta[P])}),b(x,"type","filetype"),b(x,"name","filename"),d.metadata=x,o=new ad(e.data,d),this.uploaders[e.id]=o;let C=new $t(this.uppy);this.uploaderEvents[e.id]=C,s=()=>(e.isPaused||o.start(),()=>{}),o.findPreviousUploads().then(P=>{let k=P[0];k&&(this.uppy.log(`[Tus] Resuming upload of ${e.id} started at ${k.creationTime}`),o.resumeFromPreviousUpload(k)),n=this.requests.run(s)}),C.onFileRemove(e.id,P=>{n.abort(),this.resetUploaderReferences(e.id,{abort:!!o.url}),t(`upload ${P} was removed`)}),C.onPause(e.id,P=>{n.abort(),P?o.abort():n=this.requests.run(s)}),C.onPauseAll(e.id,()=>{n.abort(),o.abort()}),C.onCancelAll(e.id,()=>{n.abort(),this.resetUploaderReferences(e.id,{abort:!!o.url}),t(`upload ${e.id} was canceled`)}),C.onResumeAll(e.id,()=>{n.abort(),e.error&&o.abort(),n=this.requests.run(s)})}).catch(t=>{throw this.uppy.emit("upload-error",e,t),t})}onReceiveUploadUrl(e,t){let i=this.uppy.getFile(e.id);i&&(!i.tus||i.tus.uploadUrl!==t)&&(this.uppy.log("[Tus] Storing upload url"),this.uppy.setFileState(i.id,{tus:I(m({},i.tus),{uploadUrl:t})}))}#r(e){let t=m({},this.opts);return e.tus&&Object.assign(t,e.tus),typeof t.headers=="function"&&(t.headers=t.headers(e)),I(m({},e.remote?.body),{endpoint:t.endpoint,uploadUrl:t.uploadUrl,protocol:"tus",size:e.data.size,headers:t.headers,metadata:e.meta})}async#i(e){let t=xi(e),i=Si(t);this.uppy.emit("upload-start",i),await Promise.allSettled(t.map(n=>{if(n.isRemote){let s=()=>this.requests,o=new AbortController,a=c=>{c.id===n.id&&o.abort()};this.uppy.on("file-removed",a);let u=this.uppy.getRequestClientForFile(n).uploadRemoteFile(n,this.#r(n),{signal:o.signal,getQueue:s});return this.requests.wrapSyncFunction(()=>{this.uppy.off("file-removed",a)},{priority:-1})(),u}return this.#t(n)}))}#n=async e=>{if(e.length===0){this.uppy.log("[Tus] No files to upload");return}this.opts.limit===0&&this.uppy.log("[Tus] When uploading multiple files at once, consider setting the `limit` option (to `10` for example), to limit the number of concurrent uploads, which helps prevent memory and network issues: https://uppy.io/docs/tus/#limit-0","warning"),this.uppy.log("[Tus] Uploading...");let t=this.uppy.getFilesByIds(e);await this.#i(t)};install(){this.uppy.setState({capabilities:I(m({},this.uppy.getState().capabilities),{resumableUploads:!0})}),this.uppy.addUploader(this.#n)}uninstall(){this.uppy.setState({capabilities:I(m({},this.uppy.getState().capabilities),{resumableUploads:!1})}),this.uppy.removeUploader(this.#n)}};export{ma as a,ba as b,qr as c,Qn as d,dd as e};
