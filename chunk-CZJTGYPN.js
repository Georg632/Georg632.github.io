import{g as pt,h as ut,i as gt,j as ht,k as ft}from"./chunk-B26AYUHC.js";import{$ as S,$a as b,$d as st,A as te,Aa as u,Ba as se,Ca as re,Da as Re,E as T,Ea as Se,F as g,Fa as ae,G as h,Ia as je,Jc as Ye,Ka as x,Kc as be,La as v,M as p,Ma as H,Na as k,Nd as X,Ob as ce,P as xe,Pa as j,Pb as me,Pd as et,Qa as q,Ra as W,Rb as N,Rc as Ze,Rd as tt,Sb as pe,Sc as Ge,T as a,Ub as ue,Va as qe,Vd as it,Wa as z,Wb as ge,Wc as _e,Yc as Xe,Yd as nt,Z as L,Zb as he,Zd as $,_a as f,_b as Qe,_d as ot,ac as Ue,ae as rt,ba as E,be as at,ca as Ie,cb as We,cc as fe,ce as lt,db as d,dc as Ke,eb as O,g as P,gb as le,ge as ve,h as w,ha as M,hb as G,ia as V,ib as c,ic as K,ie as dt,ja as F,jb as Me,je as Ce,k as ze,kc as R,ke as ct,lb as $e,lc as Y,le as mt,ma as ie,mb as Q,na as ne,o as B,oa as y,oe as Te,p as Oe,pa as s,pb as de,qa as l,r as D,ra as _,u as Z,ub as U,wa as A,wd as Je,x as ee,xa as oe,ya as m}from"./chunk-AAVFTCNP.js";import{a as J,b as Ve,c as Fe,d as Ae}from"./chunk-X37JSKTG.js";var bt=(()=>{class n{static _uniqueId=0;id=c(`brn-toggle-${++n._uniqueId}`);value=c();disabled=c(!1,{transform:de});state=Q("off");type=c("button");ariaLabel=c(null,{alias:"aria-label"});_isOn=d(()=>this.state()==="on");toggle(){this.disabled()||this.state.set(this._isOn()?"off":"on")}static \u0275fac=function(e){return new(e||n)};static \u0275dir=S({type:n,selectors:[["button","brnToggle",""]],hostVars:7,hostBindings:function(e,i){e&1&&m("click",function(){return i.toggle()}),e&2&&(oe("id",i.id())("type",i.type()),M("disabled",i.disabled()?!0:null)("data-disabled",i.disabled()?!0:null)("data-state",i.state())("aria-pressed",i._isOn())("aria-label",i.ariaLabel()||null))},inputs:{id:[1,"id"],value:[1,"value"],disabled:[1,"disabled"],state:[1,"state"],type:[1,"type"],ariaLabel:[1,"aria-label","ariaLabel"]},outputs:{state:"stateChange"}})}return n})();var St=pe('hover:bg-muted hover:text-muted-foreground focus-visible:border-ring data-[state=on]:bg-accent data-[state=on]:text-accent-foreground focus-visible:ring-ring/50 inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium whitespace-nowrap transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&_ng-icon]:pointer-events-none [&_ng-icon]:shrink-0 [&_ng-icon:not([class*="text-"])]:text-base',{variants:{variant:{default:"bg-transparent",outline:"border-input hover:bg-accent hover:text-accent-foreground border bg-transparent shadow-xs"},size:{default:"h-9 min-w-9 px-2",sm:"h-8 min-w-8 px-1.5",lg:"h-10 min-w-10 px-2.5"}},defaultVariants:{variant:"default",size:"default"}}),ke=(()=>{class n{variant=c("default");size=c("default");userClass=c("",{alias:"class"});_computedClass=d(()=>N(St({variant:this.variant(),size:this.size()}),this.userClass()));static \u0275fac=function(e){return new(e||n)};static \u0275dir=S({type:n,selectors:[["button","hlmToggle",""]],hostAttrs:["data-slot","toggle"],hostVars:2,hostBindings:function(e,i){e&2&&x(i._computedClass())},inputs:{variant:[1,"variant"],size:[1,"size"],userClass:[1,"class","userClass"]},features:[E([{directive:bt,inputs:["id","id","value","value","disabled","disabled","state","state","aria-label","aria-label","type","type"],outputs:["stateChange","stateChange"]}])]})}return n})();var Ct=(()=>{class n{variant=c("default");size=c("default");disabled=c(!1);state=Q("off");isAnimating=p(!1);animationDirection=p("");constructor(){O(()=>{let t=this.state();this.animationDirection()===""&&t==="off"||(t==="on"?this.animationDirection.set("fill"):this.animationDirection.set("empty"),this.isAnimating.set(!0),setTimeout(()=>{this.isAnimating.set(!1)},800))})}animationClass=d(()=>{if(!this.isAnimating())return"";let t=this.animationDirection();return t==="fill"?"animate-bounce-shake":t==="empty"?"animate-empty":""});buttonClass=d(()=>{let t=this.state(),e=this.animationClass(),i="";return t==="on"?i="bg-green-100 hover:bg-green-200 dark:bg-green-900/30 dark:hover:bg-green-900/50 border-green-300 dark:border-green-700":i="bg-muted/50 hover:bg-muted dark:bg-muted/20 dark:hover:bg-muted/40 border-muted-foreground/20",`${e} ${i}`});iconClass=d(()=>{let t=this.state(),e=this.isAnimating();if(t==="on"){let i="text-green-600 dark:text-green-400";return e&&this.animationDirection()==="fill"?`${i} animate-fill`:i}return"text-muted-foreground/60"});static \u0275fac=function(e){return new(e||n)};static \u0275cmp=L({type:n,selectors:[["gh-shopping-basket-toggle"]],inputs:{variant:[1,"variant"],size:[1,"size"],disabled:[1,"disabled"],state:[1,"state"]},outputs:{state:"stateChange"},features:[z([R({lucideShoppingBasket:Ze})])],decls:2,vars:9,consts:[["hlmToggle","",1,"relative","overflow-hidden","transition-all","duration-300",3,"stateChange","variant","size","disabled","state"],["hlm","",1,"transition-all","duration-500",3,"name"]],template:function(e,i){e&1&&(s(0,"button",0),W("stateChange",function(r){return q(i.state,r)||(i.state=r),r}),_(1,"ng-icon",1),l()),e&2&&(x(i.buttonClass()),y("variant",i.variant())("size",i.size())("disabled",i.disabled()),j("state",i.state),a(),x(i.iconClass()),y("name","lucideShoppingBasket"))},dependencies:[ke,$,Y],styles:["@keyframes _ngcontent-%COMP%_bounce-shake{0%,to{transform:translateY(0) rotate(0) scale(1)}10%{transform:translateY(-8px) rotate(-5deg) scale(1.1)}20%{transform:translateY(-8px) rotate(5deg) scale(1.1)}30%{transform:translateY(-8px) rotate(-5deg) scale(1.1)}40%{transform:translateY(0) rotate(0) scale(1)}50%{transform:scale(.95)}60%{transform:scale(1.05)}70%{transform:scale(.98)}80%{transform:scale(1.02)}90%{transform:scale(1)}}@keyframes _ngcontent-%COMP%_fill-basket{0%{opacity:1}50%{opacity:.6;filter:brightness(1.5)}to{opacity:1}}@keyframes _ngcontent-%COMP%_empty-basket{0%{transform:scale(1);opacity:1}30%{transform:scale(.8) rotate(-10deg);opacity:.7}60%{transform:scale(1.1) rotate(10deg);opacity:.8}to{transform:scale(1) rotate(0);opacity:1}}.animate-bounce-shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_bounce-shake .8s ease-in-out}.animate-fill[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fill-basket .5s ease-in-out}.animate-empty[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_empty-basket .6s ease-in-out}[_nghost-%COMP%]{display:inline-block}"],changeDetection:0})}return n})();var ye=(()=>{class n{supabase=T(Te);authService=T(ct);currentListId=p(null);loadingCount=p(0);loading=d(()=>this.loadingCount()>0);items=le({params:()=>({listId:this.currentListId()}),loader:async({params:t})=>{if(!t.listId)return[];let{data:e,error:i}=await this.supabase.supabase.from("shopping_list_item").select("*").eq("list_id",t.listId).order("created_at",{ascending:!1});if(i)throw i;return e??[]}});count=d(()=>this.items.value()?.length??0);setCurrentList(t){this.currentListId.set(t)}addItem(t,e){let i=this.currentListId();if(!i)return w({error:new Error("No list selected")});let o=this.authService.user()?.id;return o?(this.loadingCount.update(r=>r+1),P(this.supabase.supabase.from("shopping_list_item").insert({product_name:t,additional_info:e,list_id:i,creator_id:o,active:!0,active_changed:new Date().toISOString()}).select().single()).pipe(B(r=>w({error:r})),D(()=>this.loadingCount.update(r=>r-1)),ee(r=>{if(r?.error)throw r.error;this.items.reload()}),Z(r=>{if(r?.error)throw r.error;return w(r.data)}))):w({error:new Error("User not authenticated")})}updateItem(t,e){return this.loadingCount.update(i=>i+1),P(this.supabase.supabase.from("shopping_list_item").update(e).eq("id",t).select().single()).pipe(B(i=>w({error:i})),D(()=>this.loadingCount.update(i=>i-1)),ee(i=>{if(i?.error)throw i.error;this.items.reload()}),Z(i=>{if(i?.error)throw i.error;return w(i.data)}))}deleteItem(t){return this.loadingCount.update(e=>e+1),P(this.supabase.supabase.from("shopping_list_item").delete().eq("id",t)).pipe(B(e=>w({error:e})),D(()=>this.loadingCount.update(e=>e-1)),ee(e=>{if(e?.error)throw e.error;this.items.reload()}),Z(e=>{if(e?.error)throw e.error;return w(void 0)}))}toggleItem(t,e){return this.updateItem(t,{active:e,active_changed:new Date().toISOString()})}static \u0275fac=function(e){return new(e||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Nt(n,C){if(n&1){let t=A();s(0,"input",7),m("ngModelChange",function(i){g(t);let o=u();return h(o.editingName.set(i))})("blur",function(){g(t);let i=u();return h(i.saveInline())})("keydown.enter",function(i){g(t);let o=u();return i.preventDefault(),h(o.saveInline())})("keydown.escape",function(){g(t);let i=u();return h(i.cancelEdit())}),l()}if(n&2){let t=u();y("id",qe("edit-",t.item().id))("ngModel",t.editingName())}}function Pt(n,C){if(n&1){let t=A();s(0,"div",5)(1,"h3",8),m("click",function(){g(t);let i=u();return h(i.startEdit())}),v(2),l()()}if(n&2){let t=u();a(2),k(" ",t.item().product_name," ")}}var yt=(()=>{class n{service=T(ye);item=c.required();itemUpdated=G();itemDeleted=G();busyCount=p(0);busy=d(()=>this.busyCount()>0);editingName=p(null);isEditing=d(()=>this.editingName()!==null);toggleItem(){let t=this.item();this.busyCount.update(e=>e+1),this.service.toggleItem(t.id,!t.active).pipe(D(()=>this.busyCount.update(e=>e-1))).subscribe({next:()=>this.itemUpdated.emit(),error:e=>console.error("Toggle error:",e)})}onBasketToggle(t){let e=this.item(),i=t==="on";e.active!==i&&(this.busyCount.update(o=>o+1),this.service.toggleItem(e.id,i).pipe(D(()=>this.busyCount.update(o=>o-1))).subscribe({next:()=>this.itemUpdated.emit(),error:o=>console.error("Toggle error:",o)}))}deleteItem(){if(!confirm("Are you sure you want to delete this item?"))return;let t=this.item();this.busyCount.update(e=>e+1),this.service.deleteItem(t.id).pipe(D(()=>this.busyCount.update(e=>e-1))).subscribe({next:()=>this.itemDeleted.emit(),error:e=>console.error("Delete error:",e)})}startEdit(){this.editingName.set(this.item().product_name??""),setTimeout(()=>{let t=document.getElementById("edit-"+this.item().id);t?.focus(),t?.select()},0)}saveInline(){let t=(this.editingName()||"").trim(),e=this.item();if(t===(e.product_name??"").trim()){this.cancelEdit();return}this.busyCount.update(i=>i+1),this.service.updateItem(e.id,{product_name:t}).pipe(D(()=>{this.busyCount.update(i=>i-1),this.cancelEdit()})).subscribe({next:()=>this.itemUpdated.emit(),error:i=>console.error("Update error:",i)})}cancelEdit(){this.editingName.set(null)}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=L({type:n,selectors:[["lib-shopping-list-item-card"]],inputs:{item:[1,"item"]},outputs:{itemUpdated:"itemUpdated",itemDeleted:"itemDeleted"},features:[z([R({lucideTrash:_e})])],decls:7,vars:4,consts:[["hlmCard","",1,"group","p-2","sm:p-3","relative"],["hlmCardContent",""],[1,"flex","items-center","gap-3","w-full"],[1,"flex-1","min-w-0"],["hlmInput","",1,"w-full",3,"id","ngModel"],[1,"h-8","flex","items-center"],["size","sm","variant","outline",1,"ml-auto",3,"stateChange","state"],["hlmInput","",1,"w-full",3,"ngModelChange","blur","keydown.enter","keydown.escape","id","ngModel"],["hlmCardTitle","",1,"truncate","cursor-pointer","hover:text-primary",3,"click"]],template:function(e,i){e&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),V(4,Nt,1,3,"input",4)(5,Pt,3,1,"div",5),l(),s(6,"gh-shopping-basket-toggle",6),m("stateChange",function(r){return i.onBasketToggle(r)}),l()()()()),e&2&&(je("opacity-60",!i.item().active),a(4),F(i.isEditing()?4:5),a(2),y("state",i.item().active?"on":"off"))},dependencies:[U,K,ge,he,fe,gt,ft,ht,ve,Ct],encapsulation:2,changeDetection:0})}return n})();var De=(()=>{class n{orientation=c("horizontal");$orientation=this.orientation;direction=c("ltr");$direction=this.direction;activeTab=Q(void 0,{alias:"brnTabs"});$activeTab=this.activeTab.asReadonly();activationMode=c("automatic");$activationMode=this.activationMode;tabActivated=G();_tabs=p({});$tabs=this._tabs.asReadonly();registerTrigger(t,e){this.updateEntry(t,{trigger:e})}registerContent(t,e){this.updateEntry(t,{content:e})}unregisterTrigger(t){this.updateEntry(t,{trigger:void 0}),this.activeTab()===t&&this.activeTab.set(void 0)}unregisterContent(t){this.updateEntry(t,{content:void 0})}updateEntry(t,e){this._tabs.update(i=>{let o=i[t]??{},r=J(J({},o),e);if(!r.trigger&&!r.content){let Ee=i,{[t]:Jt}=Ee;return Ae(Ee,[Fe(t)])}return Ve(J({},i),{[t]:r})})}emitTabActivated(t){this.tabActivated.emit(t)}setActiveTab(t){this.activeTab.set(t)}static \u0275fac=function(e){return new(e||n)};static \u0275dir=S({type:n,selectors:[["","brnTabs",""]],hostVars:2,hostBindings:function(e,i){e&2&&M("data-orientation",i.orientation())("dir",i.direction())},inputs:{orientation:[1,"orientation"],direction:[1,"direction"],activeTab:[1,"brnTabs","activeTab"],activationMode:[1,"activationMode"]},outputs:{activeTab:"brnTabsChange",tabActivated:"tabActivated"},exportAs:["brnTabs"]})}return n})();var we=(()=>{class n{elementRef=T(xe);_root=T(De);_orientation=this._root.$orientation;triggerFor=c.required({alias:"brnTabsTrigger"});selected=d(()=>this._root.$activeTab()===this.triggerFor());_contentId=d(()=>`brn-tabs-content-${this.triggerFor()}`);_labelId=d(()=>`brn-tabs-label-${this.triggerFor()}`);_disabled=c(!1,{alias:"disabled",transform:de});get disabled(){return this._disabled()}constructor(){O(()=>{let t=this.triggerFor();We(()=>this._root.registerTrigger(t,this))})}focus(){this.elementRef.nativeElement.focus(),this._root.$activationMode()==="automatic"&&this.activate()}activate(){this.triggerFor()&&(this._root.setActiveTab(this.triggerFor()),this._root.emitTabActivated(this.triggerFor()))}get key(){return this.triggerFor()}ngOnDestroy(){this._root.unregisterTrigger(this.triggerFor())}static \u0275fac=function(e){return new(e||n)};static \u0275dir=S({type:n,selectors:[["button","brnTabsTrigger",""]],hostAttrs:["type","button","role","tab"],hostVars:9,hostBindings:function(e,i){e&1&&m("click",function(){return i.activate()}),e&2&&(oe("id",i._labelId())("tabIndex",i._disabled()?-1:i.selected()?0:-1),M("aria-selected",i.selected())("aria-controls",i._contentId())("aria-disabled",i._disabled())("data-state",i.selected()?"active":"inactive")("data-orientation",i._orientation())("data-disabled",i._disabled()?"":void 0)("disabled",i._disabled()?"":void 0))},inputs:{triggerFor:[1,"brnTabsTrigger","triggerFor"],_disabled:[1,"disabled","_disabled"]},exportAs:["brnTabsTrigger"]})}return n})(),wt=(()=>{class n{_root=T(De);_orientation=this._root.$orientation;_direction=this._root.$direction;_activeTab=this._root.$activeTab;_tabs=this._root.$tabs;_elementRef=T(xe);_keyDownListener=ze(this._elementRef.nativeElement,"keydown");_keyManager;triggers=$e(we,{descendants:!0});ngAfterContentInit(){this._keyManager=new it(this.triggers()).withHorizontalOrientation(this._direction()).withHomeAndEnd().withPageUpDown().withWrap(),this._keyDownListener.pipe(Oe(1)).subscribe(()=>{let t=this._activeTab(),e=this._tabs(),i=0;if(t){let o=e[t];o&&(i=this.triggers().indexOf(o.trigger))}this._keyManager?.setActiveItem(i)}),this._keyDownListener.subscribe(t=>{"key"in t&&(this._orientation()==="horizontal"&&(t.key==="ArrowUp"||t.key==="ArrowDown")||this._orientation()==="vertical"&&(t.key==="ArrowLeft"||t.key==="ArrowRight"))||this._keyManager?.onKeydown(t)})}static \u0275fac=function(e){return new(e||n)};static \u0275dir=S({type:n,selectors:[["","brnTabsList",""]],contentQueries:function(e,i,o){e&1&&Re(o,i.triggers,we,5),e&2&&ae()},hostAttrs:["role","tablist"],hostVars:2,hostBindings:function(e,i){e&2&&M("aria-orientation",i._orientation())("data-orientation",i._orientation())},exportAs:["brnTabsList"]})}return n})();var vn=Je({passive:!0});var Bt=["*"],Pe=(()=>{class n{tab=c.required();userClass=c("",{alias:"class"});_computedClass=d(()=>N("flex flex-col gap-2",this.userClass()));static \u0275fac=function(e){return new(e||n)};static \u0275cmp=L({type:n,selectors:[["hlm-tabs"]],hostVars:2,hostBindings:function(e,i){e&2&&x(i._computedClass())},inputs:{tab:[1,"tab"],userClass:[1,"class","userClass"]},features:[E([{directive:De,inputs:["orientation","orientation","direction","direction","activationMode","activationMode","brnTabs","tab"],outputs:["tabActivated","tabActivated"]}])],ngContentSelectors:Bt,decls:1,vars:0,template:function(e,i){e&1&&(se(),re(0))},encapsulation:2,changeDetection:0})}return n})();var Ht=["*"],Dt=pe("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",{variants:{orientation:{horizontal:"h-10 space-x-1",vertical:"mt-2 h-fit flex-col space-y-1"}},defaultVariants:{orientation:"horizontal"}}),Be=(()=>{class n{orientation=c("horizontal");userClass=c("",{alias:"class"});_computedClass=d(()=>N(Dt({orientation:this.orientation()}),this.userClass()));static \u0275fac=function(e){return new(e||n)};static \u0275cmp=L({type:n,selectors:[["hlm-tabs-list"]],hostVars:2,hostBindings:function(e,i){e&2&&x(i._computedClass())},inputs:{orientation:[1,"orientation"],userClass:[1,"class","userClass"]},features:[E([wt])],ngContentSelectors:Ht,decls:1,vars:0,template:function(e,i){e&1&&(se(),re(0))},encapsulation:2,changeDetection:0})}return n})();var He=(()=>{class n{triggerFor=c.required({alias:"hlmTabsTrigger"});userClass=c("",{alias:"class"});_computedClass=d(()=>N("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_ng-icon]:pointer-events-none [&_ng-icon]:shrink-0 [&_ng-icon]:text-base",this.userClass()));static \u0275fac=function(e){return new(e||n)};static \u0275dir=S({type:n,selectors:[["","hlmTabsTrigger",""]],hostVars:2,hostBindings:function(e,i){e&2&&x(i._computedClass())},inputs:{triggerFor:[1,"hlmTabsTrigger","triggerFor"],userClass:[1,"class","userClass"]},features:[E([{directive:we,inputs:["brnTabsTrigger","hlmTabsTrigger","disabled","disabled"]}])]})}return n})();var Le=(()=>{class n{supabase=T(Te);userId=p(null);loadingCount=p(0);loading=d(()=>this.loadingCount()>0);lists=le({params:()=>({userId:this.userId()}),loader:async({params:t})=>{if(!t.userId)return[];let{data:e,error:i}=await this.supabase.supabase.from("shopping_list").select("*").eq("creator_id",t.userId).order("created_at",{ascending:!0});if(i)throw i;return e??[]}});selectedListId=p(null);selectedList=d(()=>{let t=this.selectedListId();return(this.lists.value()??[]).find(i=>i.id===t)??null});constructor(){this.supabase.supabase.auth.getSession().then(({data:t})=>{let e=t?.session?.user??null;e&&this.userId.set(e.id)}).catch(()=>{}),this.supabase.supabase.auth.onAuthStateChange((t,e)=>{let i=e?.user?.id??null;this.userId.set(i),i||this.selectedListId.set(null)}),O(()=>{let t=this.lists.value();!this.selectedListId()&&t&&t.length>0&&this.selectedListId.set(t[0].id)})}createList(t){this.loadingCount.update(e=>e+1),P(this.supabase.supabase.auth.getUser()).pipe(B(e=>w({error:e})),D(()=>this.loadingCount.update(e=>e-1))).subscribe(e=>{if(e?.error)throw e.error;let i=e?.data?.user?.id;if(!i)throw new Error("Not authenticated");this.loadingCount.update(o=>o+1),P(this.supabase.supabase.from("shopping_list").insert({name:t,creator_id:i}).select().single()).pipe(B(o=>w({error:o})),D(()=>this.loadingCount.update(o=>o-1))).subscribe(o=>{if(o?.error)throw o.error;this.lists.reload(),o?.data&&this.selectedListId.set(o.data.id)})})}updateList(t,e){this.loadingCount.update(i=>i+1),P(this.supabase.supabase.from("shopping_list").update({name:e}).eq("id",t).select().single()).pipe(B(i=>w({error:i})),D(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.lists.reload()})}deleteList(t){this.loadingCount.update(e=>e+1),P(this.supabase.supabase.from("shopping_list").delete().eq("id",t)).pipe(B(e=>w({error:e})),D(()=>this.loadingCount.update(e=>e-1))).subscribe(e=>{if(e?.error)throw e.error;this.selectedListId()===t&&this.selectedListId.set(null),this.lists.reload()})}static \u0275fac=function(e){return new(e||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var zt=["editDialog"],Ot=(n,C)=>C.id;function Rt(n,C){n&1&&_(0,"hlm-spinner",3)}function jt(n,C){if(n&1){let t=A();s(0,"div",6)(1,"button",12),m("click",function(){let i=g(t).$implicit,o=u();return h(o.onTabChange(i.id))}),v(2),s(3,"button",13),f(4,"transloco"),m("click",function(i){let o=g(t).$implicit,r=u();return h(r.openEditDialog(i,o))}),_(5,"ng-icon",14),l(),s(6,"button",13),f(7,"transloco"),m("click",function(i){let o=g(t).$implicit,r=u();return h(r.deleteList(i,o.id))}),_(8,"ng-icon",15),l()()()}if(n&2){let t=C.$implicit;a(),y("hlmTabsTrigger",t.id),a(),k(" ",t.name," "),a(),M("aria-label",b(4,4,"common.edit")),a(3),M("aria-label",b(7,6,"common.delete"))}}function qt(n,C){n&1&&(_(0,"hlm-spinner",3),v(1),f(2,"transloco")),n&2&&(a(),k(" ",b(2,1,"common.creating")," "))}function Wt(n,C){n&1&&(v(0),f(1,"transloco")),n&2&&k(" ",b(1,1,"common.create")," ")}function $t(n,C){if(n&1){let t=A();s(0,"hlm-dialog-content",16)(1,"hlm-dialog-header")(2,"h3",17),v(3),f(4,"transloco"),l(),s(5,"p",18),v(6),f(7,"transloco"),l()(),s(8,"div",19)(9,"div",20)(10,"label",21),v(11),f(12,"transloco"),l(),s(13,"input",22),f(14,"transloco"),W("ngModelChange",function(i){g(t);let o=u();return q(o.newListName,i)||(o.newListName=i),h(i)}),m("keydown.enter",function(){g(t);let i=u();return h(i.createList())}),l()()(),s(15,"hlm-dialog-footer")(16,"button",23),m("click",function(){g(t);let i=u();return h(i.closeDialog())}),v(17),f(18,"transloco"),l(),s(19,"button",24),m("click",function(){g(t);let i=u();return h(i.createList())}),V(20,qt,3,3)(21,Wt,2,3),l()()()}if(n&2){let t=u();a(3),H(b(4,8,"shoppingList.createList")),a(3),H(b(7,10,"shoppingList.createListDescription")),a(5),H(b(12,12,"shoppingList.listName")),a(2),j("ngModel",t.newListName),y("placeholder",b(14,14,"shoppingList.listNamePlaceholder")),a(4),k(" ",b(18,16,"common.cancel")," "),a(2),y("disabled",!t.newListName().trim()||t.creatingList()),a(),F(t.creatingList()?20:21)}}function Qt(n,C){n&1&&(_(0,"hlm-spinner",3),v(1),f(2,"transloco")),n&2&&(a(),k(" ",b(2,1,"common.updating")," "))}function Ut(n,C){n&1&&(v(0),f(1,"transloco")),n&2&&k(" ",b(1,1,"common.save")," ")}function Kt(n,C){if(n&1){let t=A();s(0,"hlm-dialog-content",16)(1,"hlm-dialog-header")(2,"h3",17),v(3),f(4,"transloco"),l(),s(5,"p",18),v(6),f(7,"transloco"),l()(),s(8,"div",19)(9,"div",20)(10,"label",25),v(11),f(12,"transloco"),l(),s(13,"input",26),f(14,"transloco"),W("ngModelChange",function(i){g(t);let o=u();return q(o.editListName,i)||(o.editListName=i),h(i)}),m("keydown.enter",function(){g(t);let i=u();return h(i.updateList())}),l()()(),s(15,"hlm-dialog-footer")(16,"button",23),m("click",function(){g(t);let i=u();return h(i.closeEditDialog())}),v(17),f(18,"transloco"),l(),s(19,"button",24),m("click",function(){g(t);let i=u();return h(i.updateList())}),V(20,Qt,3,3)(21,Ut,2,3),l()()()}if(n&2){let t=u();a(3),H(b(4,8,"shoppingList.editList")),a(3),H(b(7,10,"shoppingList.editListDescription")),a(5),H(b(12,12,"shoppingList.listName")),a(2),j("ngModel",t.editListName),y("placeholder",b(14,14,"shoppingList.listNamePlaceholder")),a(4),k(" ",b(18,16,"common.cancel")," "),a(2),y("disabled",!t.editListName().trim()||t.updatingList()),a(),F(t.updatingList()?20:21)}}var Lt=(()=>{class n{listManager=T(Le);lists=d(()=>this.listManager.lists.value()??[]);selectedListId=this.listManager.selectedListId;loading=d(()=>this.listManager.lists.isLoading()||this.listManager.loading());createDialog=Me.required(X);editDialog=Me.required("editDialog");newListName=p("");creatingList=p(!1);editingList=p(null);editListName=p("");updatingList=p(!1);onTabChange(t){this.listManager.selectedListId.set(t)}openCreateDialog(){this.newListName.set(""),this.createDialog().open()}closeDialog(){this.createDialog().close(),this.newListName.set("")}createList(){let t=this.newListName().trim();if(t){this.creatingList.set(!0);try{this.listManager.createList(t),this.closeDialog()}finally{this.creatingList.set(!1)}}}openEditDialog(t,e){t.stopPropagation(),this.editingList.set(e),this.editListName.set(e.name),this.editDialog().open()}closeEditDialog(){this.editDialog().close(),this.editingList.set(null),this.editListName.set("")}updateList(){let t=this.editingList(),e=this.editListName().trim();if(!(!t||!e)){this.updatingList.set(!0);try{this.listManager.updateList(t.id,e),this.closeEditDialog()}finally{this.updatingList.set(!1)}}}deleteList(t,e){t.stopPropagation(),confirm("Are you sure you want to delete this list?")&&this.listManager.deleteList(e)}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=L({type:n,selectors:[["lib-shopping-list-tabs"]],viewQuery:function(e,i){e&1&&(Se(i.createDialog,X,5),Se(i.editDialog,zt,5)),e&2&&ae(2)},features:[z([R({lucidePlus:be,lucideX:Xe,lucidePencil:Ye,lucideTrash:_e})])],decls:17,vars:5,consts:[["createDialog",""],["editDialog",""],[1,"flex","items-center","gap-2","min-w-0"],["size","small"],[1,"flex-1","min-w-0","overflow-hidden",3,"tab"],[1,"w-full","border-b","overflow-x-auto","overflow-y-hidden","scrollbar-hide"],[1,"flex","items-center","gap-1","flex-shrink-0","group"],["hlmBtn","","size","icon","variant","ghost",1,"flex-shrink-0",3,"click"],["hlm","","name","lucidePlus","size","sm"],["closeDelay","100",3,"closed"],["hlm",""],["class","sm:max-w-[425px]",4,"brnDialogContent"],[1,"whitespace-nowrap",3,"click","hlmTabsTrigger"],["hlmBtn","","size","icon-xs","variant","ghost",3,"click"],["hlm","","size","xs","name","lucidePencil"],["hlm","","size","xs","name","lucideTrash"],[1,"sm:max-w-[425px]"],["hlmDialogTitle",""],["hlmDialogDescription",""],[1,"grid","gap-4","py-4"],[1,"grid","gap-2"],["hlmLabel","","for","listName"],["hlmInput","","id","listName",3,"ngModelChange","keydown.enter","ngModel","placeholder"],["hlmBtn","","variant","outline",3,"click"],["hlmBtn","",3,"click","disabled"],["hlmLabel","","for","editListName"],["hlmInput","","id","editListName",3,"ngModelChange","keydown.enter","ngModel","placeholder"]],template:function(e,i){if(e&1){let o=A();s(0,"div",2),V(1,Rt,1,0,"hlm-spinner",3),s(2,"hlm-tabs",4)(3,"hlm-tabs-list",5),ie(4,jt,9,8,"div",6,Ot),l()(),s(6,"button",7),f(7,"transloco"),m("click",function(){return g(o),h(i.openCreateDialog())}),_(8,"ng-icon",8),l()(),s(9,"brn-dialog",9,0),m("closed",function(){return g(o),h(i.closeDialog())}),_(11,"brn-dialog-overlay",10),Ie(12,$t,22,18,"hlm-dialog-content",11),l(),s(13,"brn-dialog",9,1),m("closed",function(){return g(o),h(i.closeEditDialog())}),_(15,"brn-dialog-overlay",10),Ie(16,Kt,22,18,"hlm-dialog-content",11),l()}e&2&&(a(),F(i.loading()?1:-1),a(),y("tab",i.selectedListId()??""),a(2),ne(i.lists()),a(2),M("aria-label",b(7,3,"shoppingList.createList")))},dependencies:[U,K,ge,he,fe,Pe,Be,He,ue,$,Y,X,tt,et,ot,st,rt,at,nt,lt,ve,dt,Ce,me,ce],encapsulation:2,changeDetection:0})}return n})();var Yt=(n,C)=>C.id;function Zt(n,C){n&1&&(s(0,"div",11),_(1,"hlm-spinner",18),l())}function Gt(n,C){if(n&1&&_(0,"lib-shopping-list-item-card",17),n&2){let t=C.$implicit;y("item",t)}}var xt=(()=>{class n{service=T(ye);listManager=T(Le);newItemName=p("");items=d(()=>this.service.items.value()??[]);loading=d(()=>this.service.items.isLoading()||this.service.loading());sortedItems=d(()=>(this.items()??[]).slice().sort((e,i)=>{if(e.active===i.active){let o=e.active_changed?new Date(e.active_changed).getTime():0;return(i.active_changed?new Date(i.active_changed).getTime():0)-o}return e.active?-1:1}));filteredOptions=d(()=>(this.items()??[]).filter(e=>!e.active&&e.product_name.toLowerCase().includes(this.newItemName().toLowerCase())));constructor(){O(()=>{let t=this.listManager.selectedListId();this.service.setCurrentList(t)})}handleSearch(t){let e=this.items().find(i=>i.product_name===t);!e||e.active||(this.service.toggleItem(e.id,!0).subscribe(),this.clearAutocomplete())}clearAutocomplete(){this.newItemName.set("")}focusAddInput(){try{document.getElementById("add-input")?.focus()}catch{}}addItem(){let t=this.newItemName();t&&this.service.addItem(t,void 0).subscribe({next:()=>{this.clearAutocomplete()},error:e=>{console.error("Add item error:",e)}})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=L({type:n,selectors:[["lib-sl-dashboard"]],features:[z([R({lucideShoppingCart:Ge,lucidePlus:be}),pt({transformOptionToString:t=>t.product_name,transformOptionToValue:t=>t.product_name})])],decls:24,vars:10,consts:[[1,"h-dvh","flex","flex-col","gap-4"],["hlmCard","",1,"w-full","rounded-none","flex-initial"],[1,"mx-auto","px-4","py-3","flex","items-center","justify-between"],[1,"flex","items-center","gap-3"],[1,"p-2","bg-primary/10","rounded-lg"],["hlm","","name","lucideShoppingCart","size","sm",1,"text-primary"],[1,"text-lg","font-semibold"],[1,"flex","items-center","gap-2"],[1,"px-4"],[1,"flex-1","flex","flex-col","gap-4","overflow-hidden","py-4"],[1,"flex","sm:flex-row","gap-2","items-stretch","sm:items-center","relative","px-4",3,"ngSubmit"],[1,"absolute","inset-0","bg-background/50","flex","justify-center","items-center","z-10","rounded-lg"],[3,"searchChange","valueChange","keydown.enter","searchPlaceholderText","filteredOptions","search","autocompleteEmptyClass"],["hlmBtn","","size","icon","variant","default","type","submit"],["hlm","","name","lucidePlus","size","sm"],[1,"flex-1","overflow-auto"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-3","xl:grid-cols-4","gap-4","px-4"],[3,"item"],["size","large"]],template:function(e,i){e&1&&(s(0,"div",0)(1,"header",1)(2,"div",2)(3,"div",3)(4,"div",4),_(5,"ng-icon",5),l(),s(6,"h1",6),v(7),f(8,"transloco"),l()(),s(9,"div",7),_(10,"gh-user-avatar"),l()()(),s(11,"div",8),_(12,"lib-shopping-list-tabs"),l(),s(13,"main",9)(14,"form",10),m("ngSubmit",function(){return i.addItem()}),V(15,Zt,2,0,"div",11),s(16,"hlm-autocomplete",12),f(17,"transloco"),W("searchChange",function(r){return q(i.newItemName,r)||(i.newItemName=r),r}),m("valueChange",function(r){return i.handleSearch(r)})("keydown.enter",function(){return i.addItem()}),l(),s(18,"button",13),_(19,"ng-icon",14),l()(),s(20,"section",15)(21,"div",16),ie(22,Gt,1,1,"lib-shopping-list-item-card",17,Yt),l()()()()),e&2&&(a(7),H(b(8,6,"shoppingList.title")),a(8),F(i.loading()?15:-1),a(),y("searchPlaceholderText",b(17,8,"shoppingList.searchPlaceholder"))("filteredOptions",i.filteredOptions()),j("search",i.newItemName),y("autocompleteEmptyClass","hidden"),a(6),ne(i.sortedItems()))},dependencies:[U,K,Ke,Qe,Ue,ue,$,Y,Ce,ut,yt,Lt,me,mt,ce],encapsulation:2,changeDetection:0})}return n})();var ms=[{path:"dashboard",component:xt},{path:"**",redirectTo:"dashboard"}];export{Ct as ShoppingBasketToggleComponent,ye as ShoppingListService,ms as shoppingListRoutes};
