import{a as Uy,b as qy,d as $y,e as jy}from"./chunk-XNWGUTUA.js";import{a as Ky,b as Yy,c as Xy,d as Jy,e as Qy,f as Zy,g as eS,h as tS,i as iS,l as nS}from"./chunk-B26AYUHC.js";import{$ as se,$a as N,$b as ka,$c as wu,A as qi,Aa as I,Ac as Y1,B as bs,Ba as ct,Bb as P1,Bc as X1,C as bt,Ca as ze,Cb as D1,Cc as J1,D as w1,Da as Ri,Db as fu,Dc as Q1,Dd as Ry,E as k,Ea as $n,Eb as M1,Ec as Z1,Ed as Py,F as j,Fa as ii,Fb as k1,Fc as ey,Fd as Dy,G as K,Ga as Ki,Gc as ty,H as b1,Ha as jt,Hc as iy,Hd as My,Ia as dt,Ib as T1,Ic as ny,Id as Su,J as _a,Ja as _1,Jb as Pa,Jc as Aa,Jd as xu,K as Li,Ka as ce,Kc as Jn,Kd as Eu,L as To,La as F,Lb as F1,Lc as oy,Ld as _u,M as J,Ma as we,Mb as sc,Mc as ry,Md as ky,N as uu,Na as de,Nc as sy,Nd as dc,O as _i,Oa as Io,Ob as Kt,Oc as ay,Od as Ty,P as Je,Pa as Ss,Pb as Yt,Pc as ly,Pd as Fy,Qa as xs,Qd as Iy,R as xr,Ra as Es,Rb as le,Rd as Ay,S as y1,Sb as Da,Sd as Ly,T as E,Tb as I1,Tc as cy,U as ic,Ub as Ze,Uc as dy,V as Uf,Va as Ao,Vb as Dr,Vc as uy,Vd as Oy,W as Fo,Wa as ue,Wb as Yn,Wc as ln,Wd as Ny,X as nc,Xa as Rr,Xb as Mr,Xc as hy,Xd as By,Y as Er,Ya as oc,Yb as qf,Yc as py,Z as re,Za as R1,Zb as Xn,Zc as ac,Zd as We,_ as ys,_a as O,_b as Ma,_c as Cu,a as xa,aa as Ot,ab as _s,ac as A1,ad as lc,b as Ql,ba as $i,bc as In,bd as gy,c as qe,ca as Dt,cb as Oi,cc as mu,cd as fy,d as f1,da as G,db as L,dc as Ta,dd as $f,de as Hy,e as du,ea as di,eb as _e,ec as L1,ed as An,ee as Vy,f as m1,fa as _r,fb as Rs,fc as kr,fd as Ds,fe as Gy,g as Ve,ga as S1,gb as kn,gc as Fa,ge as Pi,h as Ge,ha as Qe,hb as oe,hc as O1,hd as bu,he as Kf,i as Rn,ia as ve,ib as M,ic as Tr,id as my,ie as Ni,j as v1,ja as Ce,jb as jn,jc as Ia,je as Qn,k as $t,ka as hu,kb as Kn,kc as nt,ke as zy,l as ws,la as x1,lb as Ra,lc as ot,ld as vy,le as Wy,m as ko,ma as ei,mb as Yi,mc as N1,na as ti,nb as rc,nc as B1,nd as Cy,o as Xe,oa as U,ob as Tn,oc as H1,od as wy,oe as La,p as Ea,pa as S,pb as D,pc as V1,pd as by,q as Zl,qa as x,qb as Fn,qc as G1,qd as jf,r as $e,ra as H,rb as gu,rc as vu,rd as yy,sa as Pn,sc as z1,sd as cc,t as ec,ta as Dn,tb as Ps,td as Sy,u as xi,ua as pu,ub as ui,uc as W1,ud as xy,v as lt,va as Mn,vb as Pr,vc as U1,vd as Ey,w as tc,wa as xe,wc as q1,wd as _y,x as an,xa as ji,xc as $1,xd as yu,y as C1,ya as V,yc as j1,z as Ei,za as E1,zc as K1}from"./chunk-AAVFTCNP.js";import{a as b,b as z,d as Ai,e as me,g as Sa}from"./chunk-X37JSKTG.js";var Ie=me(Zt=>{"use strict";Object.defineProperty(Zt,"__esModule",{value:!0});Zt._registerNode=Zt.Konva=Zt.glob=void 0;var DX=Math.PI/180;function MX(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}Zt.glob=typeof global<"u"?global:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{};Zt.Konva={_global:Zt.glob,version:"9.3.22",isBrowser:MX(),isUnminified:/param/.test((function(e){}).toString()),dblClickWindow:400,getAngle(e){return Zt.Konva.angleDeg?e*DX:e},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return Zt.Konva.DD.isDragging},isTransforming(){var e;return(e=Zt.Konva.Transformer)===null||e===void 0?void 0:e.isTransforming()},isDragReady(){return!!Zt.Konva.DD.node},releaseCanvasOnDestroy:!0,document:Zt.glob.document,_injectGlobal(e){Zt.glob.Konva=e}};var kX=e=>{Zt.Konva[e.prototype.getClassName()]=e};Zt._registerNode=kX;Zt.Konva._injectGlobal(Zt.Konva)});var St=me(ht=>{"use strict";Object.defineProperty(ht,"__esModule",{value:!0});ht.Util=ht.Transform=void 0;var Vw=Ie(),Ww=class e{constructor(t=[1,0,0,1,0,0]){this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new e(this.m)}copyInto(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]}point(t){let i=this.m;return{x:i[0]*t.x+i[2]*t.y+i[4],y:i[1]*t.x+i[3]*t.y+i[5]}}translate(t,i){return this.m[4]+=this.m[0]*t+this.m[2]*i,this.m[5]+=this.m[1]*t+this.m[3]*i,this}scale(t,i){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=i,this.m[3]*=i,this}rotate(t){let i=Math.cos(t),n=Math.sin(t),o=this.m[0]*i+this.m[2]*n,r=this.m[1]*i+this.m[3]*n,s=this.m[0]*-n+this.m[2]*i,a=this.m[1]*-n+this.m[3]*i;return this.m[0]=o,this.m[1]=r,this.m[2]=s,this.m[3]=a,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(t,i){let n=this.m[0]+this.m[2]*i,o=this.m[1]+this.m[3]*i,r=this.m[2]+this.m[0]*t,s=this.m[3]+this.m[1]*t;return this.m[0]=n,this.m[1]=o,this.m[2]=r,this.m[3]=s,this}multiply(t){let i=this.m[0]*t.m[0]+this.m[2]*t.m[1],n=this.m[1]*t.m[0]+this.m[3]*t.m[1],o=this.m[0]*t.m[2]+this.m[2]*t.m[3],r=this.m[1]*t.m[2]+this.m[3]*t.m[3],s=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],a=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=i,this.m[1]=n,this.m[2]=o,this.m[3]=r,this.m[4]=s,this.m[5]=a,this}invert(){let t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),i=this.m[3]*t,n=-this.m[1]*t,o=-this.m[2]*t,r=this.m[0]*t,s=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),a=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=i,this.m[1]=n,this.m[2]=o,this.m[3]=r,this.m[4]=s,this.m[5]=a,this}getMatrix(){return this.m}decompose(){let t=this.m[0],i=this.m[1],n=this.m[2],o=this.m[3],r=this.m[4],s=this.m[5],a=t*o-i*n,l={x:r,y:s,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(t!=0||i!=0){let c=Math.sqrt(t*t+i*i);l.rotation=i>0?Math.acos(t/c):-Math.acos(t/c),l.scaleX=c,l.scaleY=a/c,l.skewX=(t*n+i*o)/a,l.skewY=0}else if(n!=0||o!=0){let c=Math.sqrt(n*n+o*o);l.rotation=Math.PI/2-(o>0?Math.acos(-n/c):-Math.acos(n/c)),l.scaleX=a/c,l.scaleY=c,l.skewX=0,l.skewY=(t*n+i*o)/a}return l.rotation=ht.Util._getRotation(l.rotation),l}};ht.Transform=Ww;var TX="[object Array]",FX="[object Number]",IX="[object String]",AX="[object Boolean]",LX=Math.PI/180,OX=180/Math.PI,Gw="#",NX="",BX="0",HX="Konva warning: ",lM="Konva error: ",VX="rgb(",zw={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},GX=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,ug=[],zX=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(e){setTimeout(e,60)};ht.Util={_isElement(e){return!!(e&&e.nodeType==1)},_isFunction(e){return!!(e&&e.constructor&&e.call&&e.apply)},_isPlainObject(e){return!!e&&e.constructor===Object},_isArray(e){return Object.prototype.toString.call(e)===TX},_isNumber(e){return Object.prototype.toString.call(e)===FX&&!isNaN(e)&&isFinite(e)},_isString(e){return Object.prototype.toString.call(e)===IX},_isBoolean(e){return Object.prototype.toString.call(e)===AX},isObject(e){return e instanceof Object},isValidSelector(e){if(typeof e!="string")return!1;let t=e[0];return t==="#"||t==="."||t===t.toUpperCase()},_sign(e){return e===0||e>0?1:-1},requestAnimFrame(e){ug.push(e),ug.length===1&&zX(function(){let t=ug;ug=[],t.forEach(function(i){i()})})},createCanvasElement(){let e=document.createElement("canvas");try{e.style=e.style||{}}catch{}return e},createImageElement(){return document.createElement("img")},_isInDocument(e){for(;e=e.parentNode;)if(e==document)return!0;return!1},_urlToImage(e,t){let i=ht.Util.createImageElement();i.onload=function(){t(i)},i.src=e},_rgbToHex(e,t,i){return((1<<24)+(e<<16)+(t<<8)+i).toString(16).slice(1)},_hexToRgb(e){e=e.replace(Gw,NX);let t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:t&255}},getRandomColor(){let e=(Math.random()*16777215<<0).toString(16);for(;e.length<6;)e=BX+e;return Gw+e},getRGB(e){let t;return e in zw?(t=zw[e],{r:t[0],g:t[1],b:t[2]}):e[0]===Gw?this._hexToRgb(e.substring(1)):e.substr(0,4)===VX?(t=GX.exec(e.replace(/ /g,"")),{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}):{r:0,g:0,b:0}},colorToRGBA(e){return e=e||"black",ht.Util._namedColorToRBA(e)||ht.Util._hex3ColorToRGBA(e)||ht.Util._hex4ColorToRGBA(e)||ht.Util._hex6ColorToRGBA(e)||ht.Util._hex8ColorToRGBA(e)||ht.Util._rgbColorToRGBA(e)||ht.Util._rgbaColorToRGBA(e)||ht.Util._hslColorToRGBA(e)},_namedColorToRBA(e){let t=zw[e.toLowerCase()];return t?{r:t[0],g:t[1],b:t[2],a:1}:null},_rgbColorToRGBA(e){if(e.indexOf("rgb(")===0){e=e.match(/rgb\(([^)]+)\)/)[1];let t=e.split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:1}}},_rgbaColorToRGBA(e){if(e.indexOf("rgba(")===0){e=e.match(/rgba\(([^)]+)\)/)[1];let t=e.split(/ *, */).map((i,n)=>i.slice(-1)==="%"?n===3?parseInt(i)/100:parseInt(i)/100*255:Number(i));return{r:t[0],g:t[1],b:t[2],a:t[3]}}},_hex8ColorToRGBA(e){if(e[0]==="#"&&e.length===9)return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:parseInt(e.slice(7,9),16)/255}},_hex6ColorToRGBA(e){if(e[0]==="#"&&e.length===7)return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:1}},_hex4ColorToRGBA(e){if(e[0]==="#"&&e.length===5)return{r:parseInt(e[1]+e[1],16),g:parseInt(e[2]+e[2],16),b:parseInt(e[3]+e[3],16),a:parseInt(e[4]+e[4],16)/255}},_hex3ColorToRGBA(e){if(e[0]==="#"&&e.length===4)return{r:parseInt(e[1]+e[1],16),g:parseInt(e[2]+e[2],16),b:parseInt(e[3]+e[3],16),a:1}},_hslColorToRGBA(e){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(e)){let[t,...i]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e),n=Number(i[0])/360,o=Number(i[1])/100,r=Number(i[2])/100,s,a,l;if(o===0)return l=r*255,{r:Math.round(l),g:Math.round(l),b:Math.round(l),a:1};r<.5?s=r*(1+o):s=r+o-r*o;let c=2*r-s,d=[0,0,0];for(let u=0;u<3;u++)a=n+1/3*-(u-1),a<0&&a++,a>1&&a--,6*a<1?l=c+(s-c)*6*a:2*a<1?l=s:3*a<2?l=c+(s-c)*(2/3-a)*6:l=c,d[u]=l*255;return{r:Math.round(d[0]),g:Math.round(d[1]),b:Math.round(d[2]),a:1}}},haveIntersection(e,t){return!(t.x>e.x+e.width||t.x+t.width<e.x||t.y>e.y+e.height||t.y+t.height<e.y)},cloneObject(e){let t={};for(let i in e)this._isPlainObject(e[i])?t[i]=this.cloneObject(e[i]):this._isArray(e[i])?t[i]=this.cloneArray(e[i]):t[i]=e[i];return t},cloneArray(e){return e.slice(0)},degToRad(e){return e*LX},radToDeg(e){return e*OX},_degToRad(e){return ht.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),ht.Util.degToRad(e)},_radToDeg(e){return ht.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),ht.Util.radToDeg(e)},_getRotation(e){return Vw.Konva.angleDeg?ht.Util.radToDeg(e):e},_capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)},throw(e){throw new Error(lM+e)},error(e){console.error(lM+e)},warn(e){Vw.Konva.showWarnings&&console.warn(HX+e)},each(e,t){for(let i in e)t(i,e[i])},_inRange(e,t,i){return t<=e&&e<i},_getProjectionToSegment(e,t,i,n,o,r){let s,a,l,c=(e-i)*(e-i)+(t-n)*(t-n);if(c==0)s=e,a=t,l=(o-i)*(o-i)+(r-n)*(r-n);else{let d=((o-e)*(i-e)+(r-t)*(n-t))/c;d<0?(s=e,a=t,l=(e-o)*(e-o)+(t-r)*(t-r)):d>1?(s=i,a=n,l=(i-o)*(i-o)+(n-r)*(n-r)):(s=e+d*(i-e),a=t+d*(n-t),l=(s-o)*(s-o)+(a-r)*(a-r))}return[s,a,l]},_getProjectionToLine(e,t,i){let n=ht.Util.cloneObject(e),o=Number.MAX_VALUE;return t.forEach(function(r,s){if(!i&&s===t.length-1)return;let a=t[(s+1)%t.length],l=ht.Util._getProjectionToSegment(r.x,r.y,a.x,a.y,e.x,e.y),c=l[0],d=l[1],u=l[2];u<o&&(n.x=c,n.y=d,o=u)}),n},_prepareArrayForTween(e,t,i){let n=[],o=[];if(e.length>t.length){let s=t;t=e,e=s}for(let s=0;s<e.length;s+=2)n.push({x:e[s],y:e[s+1]});for(let s=0;s<t.length;s+=2)o.push({x:t[s],y:t[s+1]});let r=[];return o.forEach(function(s){let a=ht.Util._getProjectionToLine(s,n,i);r.push(a.x),r.push(a.y)}),r},_prepareToStringify(e){let t;e.visitedByCircularReferenceRemoval=!0;for(let i in e)if(e.hasOwnProperty(i)&&e[i]&&typeof e[i]=="object"){if(t=Object.getOwnPropertyDescriptor(e,i),e[i].visitedByCircularReferenceRemoval||ht.Util._isElement(e[i]))if(t.configurable)delete e[i];else return null;else if(ht.Util._prepareToStringify(e[i])===null)if(t.configurable)delete e[i];else return null}return delete e.visitedByCircularReferenceRemoval,e},_assign(e,t){for(let i in t)e[i]=t[i];return e},_getFirstPointerId(e){return e.touches?e.changedTouches[0].identifier:e.pointerId||999},releaseCanvas(...e){Vw.Konva.releaseCanvasOnDestroy&&e.forEach(t=>{t.width=0,t.height=0})},drawRoundedRectPath(e,t,i,n){let o=0,r=0,s=0,a=0;typeof n=="number"?o=r=s=a=Math.min(n,t/2,i/2):(o=Math.min(n[0]||0,t/2,i/2),r=Math.min(n[1]||0,t/2,i/2),a=Math.min(n[2]||0,t/2,i/2),s=Math.min(n[3]||0,t/2,i/2)),e.moveTo(o,0),e.lineTo(t-r,0),e.arc(t-r,r,r,Math.PI*3/2,0,!1),e.lineTo(t,i-a),e.arc(t-a,i-a,a,0,Math.PI/2,!1),e.lineTo(s,i),e.arc(s,i-s,s,Math.PI/2,Math.PI,!1),e.lineTo(0,o),e.arc(o,o,o,Math.PI,Math.PI*3/2,!1)}}});var $w=me(ls=>{"use strict";Object.defineProperty(ls,"__esModule",{value:!0});ls.HitContext=ls.SceneContext=ls.Context=void 0;var uM=St(),WX=Ie();function UX(e){let t=[],i=e.length,n=uM.Util;for(let o=0;o<i;o++){let r=e[o];n._isNumber(r)?r=Math.round(r*1e3)/1e3:n._isString(r)||(r=r+""),t.push(r)}return t}var cM=",",qX="(",$X=")",jX="([",KX="])",YX=";",XX="()",JX="=",dM=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],QX=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],ZX=100,Fl=class{constructor(t){this.canvas=t,WX.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,i){let n=this.traceArr,o=n.length,r="",s,a,l,c;for(s=0;s<o;s++)a=n[s],l=a.method,l?(c=a.args,r+=l,t?r+=XX:uM.Util._isArray(c[0])?r+=jX+c.join(cM)+KX:(i&&(c=c.map(d=>typeof d=="number"?Math.floor(d):d)),r+=qX+c.join(cM)+$X)):(r+=a.property,t||(r+=JX+a.val)),r+=YX;return r}clearTrace(){this.traceArr=[]}_trace(t){let i=this.traceArr,n;i.push(t),n=i.length,n>=ZX&&i.shift()}reset(){let t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){let i=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,i.getWidth()/i.pixelRatio,i.getHeight()/i.pixelRatio)}_applyLineCap(t){let i=t.attrs.lineCap;i&&this.setAttr("lineCap",i)}_applyOpacity(t){let i=t.getAbsoluteOpacity();i!==1&&this.setAttr("globalAlpha",i)}_applyLineJoin(t){let i=t.attrs.lineJoin;i&&this.setAttr("lineJoin",i)}setAttr(t,i){this._context[t]=i}arc(t,i,n,o,r,s){this._context.arc(t,i,n,o,r,s)}arcTo(t,i,n,o,r){this._context.arcTo(t,i,n,o,r)}beginPath(){this._context.beginPath()}bezierCurveTo(t,i,n,o,r,s){this._context.bezierCurveTo(t,i,n,o,r,s)}clearRect(t,i,n,o){this._context.clearRect(t,i,n,o)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,i){let n=arguments;if(n.length===2)return this._context.createImageData(t,i);if(n.length===1)return this._context.createImageData(t)}createLinearGradient(t,i,n,o){return this._context.createLinearGradient(t,i,n,o)}createPattern(t,i){return this._context.createPattern(t,i)}createRadialGradient(t,i,n,o,r,s){return this._context.createRadialGradient(t,i,n,o,r,s)}drawImage(t,i,n,o,r,s,a,l,c){let d=arguments,u=this._context;d.length===3?u.drawImage(t,i,n):d.length===5?u.drawImage(t,i,n,o,r):d.length===9&&u.drawImage(t,i,n,o,r,s,a,l,c)}ellipse(t,i,n,o,r,s,a,l){this._context.ellipse(t,i,n,o,r,s,a,l)}isPointInPath(t,i,n,o){return n?this._context.isPointInPath(n,t,i,o):this._context.isPointInPath(t,i,o)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,i,n,o){this._context.fillRect(t,i,n,o)}strokeRect(t,i,n,o){this._context.strokeRect(t,i,n,o)}fillText(t,i,n,o){o?this._context.fillText(t,i,n,o):this._context.fillText(t,i,n)}measureText(t){return this._context.measureText(t)}getImageData(t,i,n,o){return this._context.getImageData(t,i,n,o)}lineTo(t,i){this._context.lineTo(t,i)}moveTo(t,i){this._context.moveTo(t,i)}rect(t,i,n,o){this._context.rect(t,i,n,o)}roundRect(t,i,n,o,r){this._context.roundRect(t,i,n,o,r)}putImageData(t,i,n){this._context.putImageData(t,i,n)}quadraticCurveTo(t,i,n,o){this._context.quadraticCurveTo(t,i,n,o)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,i){this._context.scale(t,i)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,i,n,o,r,s){this._context.setTransform(t,i,n,o,r,s)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,i,n,o){this._context.strokeText(t,i,n,o)}transform(t,i,n,o,r,s){this._context.transform(t,i,n,o,r,s)}translate(t,i){this._context.translate(t,i)}_enableTrace(){let t=this,i=dM.length,n=this.setAttr,o,r,s=function(a){let l=t[a],c;t[a]=function(){return r=UX(Array.prototype.slice.call(arguments,0)),c=l.apply(t,arguments),t._trace({method:a,args:r}),c}};for(o=0;o<i;o++)s(dM[o]);t.setAttr=function(){n.apply(t,arguments);let a=arguments[0],l=arguments[1];(a==="shadowOffsetX"||a==="shadowOffsetY"||a==="shadowBlur")&&(l=l/this.canvas.getPixelRatio()),t._trace({property:a,val:l})}}_applyGlobalCompositeOperation(t){let i=t.attrs.globalCompositeOperation;!i||i==="source-over"||this.setAttr("globalCompositeOperation",i)}};ls.Context=Fl;QX.forEach(function(e){Object.defineProperty(Fl.prototype,e,{get(){return this._context[e]},set(t){this._context[e]=t}})});var Uw=class extends Fl{constructor(t,{willReadFrequently:i=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:i})}_fillColor(t){let i=t.fill();this.setAttr("fillStyle",i),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){let i=t._getLinearGradient();i&&(this.setAttr("fillStyle",i),t._fillFunc(this))}_fillRadialGradient(t){let i=t._getRadialGradient();i&&(this.setAttr("fillStyle",i),t._fillFunc(this))}_fill(t){let i=t.fill(),n=t.getFillPriority();if(i&&n==="color"){this._fillColor(t);return}let o=t.getFillPatternImage();if(o&&n==="pattern"){this._fillPattern(t);return}let r=t.getFillLinearGradientColorStops();if(r&&n==="linear-gradient"){this._fillLinearGradient(t);return}let s=t.getFillRadialGradientColorStops();if(s&&n==="radial-gradient"){this._fillRadialGradient(t);return}i?this._fillColor(t):o?this._fillPattern(t):r?this._fillLinearGradient(t):s&&this._fillRadialGradient(t)}_strokeLinearGradient(t){let i=t.getStrokeLinearGradientStartPoint(),n=t.getStrokeLinearGradientEndPoint(),o=t.getStrokeLinearGradientColorStops(),r=this.createLinearGradient(i.x,i.y,n.x,n.y);if(o){for(let s=0;s<o.length;s+=2)r.addColorStop(o[s],o[s+1]);this.setAttr("strokeStyle",r)}}_stroke(t){let i=t.dash(),n=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!n){this.save();let r=this.getCanvas().getPixelRatio();this.setTransform(r,0,0,r,0,0)}this._applyLineCap(t),i&&t.dashEnabled()&&(this.setLineDash(i),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),n||this.restore()}}_applyShadow(t){var i,n,o;let r=(i=t.getShadowRGBA())!==null&&i!==void 0?i:"black",s=(n=t.getShadowBlur())!==null&&n!==void 0?n:5,a=(o=t.getShadowOffset())!==null&&o!==void 0?o:{x:0,y:0},l=t.getAbsoluteScale(),c=this.canvas.getPixelRatio(),d=l.x*c,u=l.y*c;this.setAttr("shadowColor",r),this.setAttr("shadowBlur",s*Math.min(Math.abs(d),Math.abs(u))),this.setAttr("shadowOffsetX",a.x*d),this.setAttr("shadowOffsetY",a.y*u)}};ls.SceneContext=Uw;var qw=class extends Fl{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){let i=t.getStrokeScaleEnabled();if(!i){this.save();let r=this.getCanvas().getPixelRatio();this.setTransform(r,0,0,r,0,0)}this._applyLineCap(t);let n=t.hitStrokeWidth(),o=n==="auto"?t.strokeWidth():n;this.setAttr("lineWidth",o),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),i||this.restore()}}};ls.HitContext=qw});var Id=me(cs=>{"use strict";Object.defineProperty(cs,"__esModule",{value:!0});cs.HitCanvas=cs.SceneCanvas=cs.Canvas=void 0;var pg=St(),hM=$w(),pM=Ie(),hg;function eJ(){if(hg)return hg;let e=pg.Util.createCanvasElement(),t=e.getContext("2d");return hg=(function(){let i=pM.Konva._global.devicePixelRatio||1,n=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return i/n})(),pg.Util.releaseCanvas(e),hg}var Fd=class{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;let n=(t||{}).pixelRatio||pM.Konva.pixelRatio||eJ();this.pixelRatio=n,this._canvas=pg.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){let i=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/i,this.getHeight()/i)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";let i=this.pixelRatio;this.getContext()._context.scale(i,i)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";let i=this.pixelRatio;this.getContext()._context.scale(i,i)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,i){this.setWidth(t||0),this.setHeight(i||0)}toDataURL(t,i){try{return this._canvas.toDataURL(t,i)}catch{try{return this._canvas.toDataURL()}catch(o){return pg.Util.error("Unable to get data URL. "+o.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};cs.Canvas=Fd;var jw=class extends Fd{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new hM.SceneContext(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}};cs.SceneCanvas=jw;var Kw=class extends Fd{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new hM.HitContext(this),this.setSize(t.width,t.height)}};cs.HitCanvas=Kw});var gg=me(Ut=>{"use strict";Object.defineProperty(Ut,"__esModule",{value:!0});Ut.DD=void 0;var Ad=Ie(),tJ=St();Ut.DD={get isDragging(){let e=!1;return Ut.DD._dragElements.forEach(t=>{t.dragStatus==="dragging"&&(e=!0)}),e},justDragged:!1,get node(){let e;return Ut.DD._dragElements.forEach(t=>{e=t.node}),e},_dragElements:new Map,_drag(e){let t=[];Ut.DD._dragElements.forEach((i,n)=>{let{node:o}=i,r=o.getStage();r.setPointersPositions(e),i.pointerId===void 0&&(i.pointerId=tJ.Util._getFirstPointerId(e));let s=r._changedPointerPositions.find(a=>a.id===i.pointerId);if(s){if(i.dragStatus!=="dragging"){let a=o.dragDistance();if(Math.max(Math.abs(s.x-i.startPointerPos.x),Math.abs(s.y-i.startPointerPos.y))<a||(o.startDrag({evt:e}),!o.isDragging()))return}o._setDragPosition(e,i),t.push(o)}}),t.forEach(i=>{i.fire("dragmove",{type:"dragmove",target:i,evt:e},!0)})},_endDragBefore(e){let t=[];Ut.DD._dragElements.forEach(i=>{let{node:n}=i,o=n.getStage();if(e&&o.setPointersPositions(e),!o._changedPointerPositions.find(a=>a.id===i.pointerId))return;(i.dragStatus==="dragging"||i.dragStatus==="stopped")&&(Ut.DD.justDragged=!0,Ad.Konva._mouseListenClick=!1,Ad.Konva._touchListenClick=!1,Ad.Konva._pointerListenClick=!1,i.dragStatus="stopped");let s=i.node.getLayer()||i.node instanceof Ad.Konva.Stage&&i.node;s&&t.indexOf(s)===-1&&t.push(s)}),t.forEach(i=>{i.draw()})},_endDragAfter(e){Ut.DD._dragElements.forEach((t,i)=>{t.dragStatus==="stopped"&&t.node.fire("dragend",{type:"dragend",target:t.node,evt:e},!0),t.dragStatus!=="dragging"&&Ut.DD._dragElements.delete(i)})}};Ad.Konva.isBrowser&&(window.addEventListener("mouseup",Ut.DD._endDragBefore,!0),window.addEventListener("touchend",Ut.DD._endDragBefore,!0),window.addEventListener("touchcancel",Ut.DD._endDragBefore,!0),window.addEventListener("mousemove",Ut.DD._drag),window.addEventListener("touchmove",Ut.DD._drag),window.addEventListener("mouseup",Ut.DD._endDragAfter,!1),window.addEventListener("touchend",Ut.DD._endDragAfter,!1),window.addEventListener("touchcancel",Ut.DD._endDragAfter,!1))});var Oe=me(rn=>{"use strict";Object.defineProperty(rn,"__esModule",{value:!0});rn.RGBComponent=iJ;rn.alphaComponent=nJ;rn.getNumberValidator=oJ;rn.getNumberOrArrayOfNumbersValidator=rJ;rn.getNumberOrAutoValidator=sJ;rn.getStringValidator=aJ;rn.getStringOrGradientValidator=lJ;rn.getFunctionValidator=cJ;rn.getNumberArrayValidator=dJ;rn.getBooleanValidator=uJ;rn.getComponentValidator=hJ;var ur=Ie(),Rt=St();function hr(e){return Rt.Util._isString(e)?'"'+e+'"':Object.prototype.toString.call(e)==="[object Number]"||Rt.Util._isBoolean(e)?e:Object.prototype.toString.call(e)}function iJ(e){return e>255?255:e<0?0:Math.round(e)}function nJ(e){return e>1?1:e<1e-4?1e-4:e}function oJ(){if(ur.Konva.isUnminified)return function(e,t){return Rt.Util._isNumber(e)||Rt.Util.warn(hr(e)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),e}}function rJ(e){if(ur.Konva.isUnminified)return function(t,i){let n=Rt.Util._isNumber(t),o=Rt.Util._isArray(t)&&t.length==e;return!n&&!o&&Rt.Util.warn(hr(t)+' is a not valid value for "'+i+'" attribute. The value should be a number or Array<number>('+e+")"),t}}function sJ(){if(ur.Konva.isUnminified)return function(e,t){return Rt.Util._isNumber(e)||e==="auto"||Rt.Util.warn(hr(e)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),e}}function aJ(){if(ur.Konva.isUnminified)return function(e,t){return Rt.Util._isString(e)||Rt.Util.warn(hr(e)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),e}}function lJ(){if(ur.Konva.isUnminified)return function(e,t){let i=Rt.Util._isString(e),n=Object.prototype.toString.call(e)==="[object CanvasGradient]"||e&&e.addColorStop;return i||n||Rt.Util.warn(hr(e)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),e}}function cJ(){if(ur.Konva.isUnminified)return function(e,t){return Rt.Util._isFunction(e)||Rt.Util.warn(hr(e)+' is a not valid value for "'+t+'" attribute. The value should be a function.'),e}}function dJ(){if(ur.Konva.isUnminified)return function(e,t){let i=Int8Array?Object.getPrototypeOf(Int8Array):null;return i&&e instanceof i||(Rt.Util._isArray(e)?e.forEach(function(n){Rt.Util._isNumber(n)||Rt.Util.warn('"'+t+'" attribute has non numeric element '+n+". Make sure that all elements are numbers.")}):Rt.Util.warn(hr(e)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),e}}function uJ(){if(ur.Konva.isUnminified)return function(e,t){return e===!0||e===!1||Rt.Util.warn(hr(e)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),e}}function hJ(e){if(ur.Konva.isUnminified)return function(t,i){return t==null||Rt.Util.isObject(t)||Rt.Util.warn(hr(t)+' is a not valid value for "'+i+'" attribute. The value should be an object with properties '+e),t}}});var Ae=me(Gn=>{"use strict";Object.defineProperty(Gn,"__esModule",{value:!0});Gn.Factory=void 0;var sn=St(),pJ=Oe(),Ld="get",Od="set";Gn.Factory={addGetterSetter(e,t,i,n,o){Gn.Factory.addGetter(e,t,i),Gn.Factory.addSetter(e,t,n,o),Gn.Factory.addOverloadedGetterSetter(e,t)},addGetter(e,t,i){let n=Ld+sn.Util._capitalize(t);e.prototype[n]=e.prototype[n]||function(){let o=this.attrs[t];return o===void 0?i:o}},addSetter(e,t,i,n){let o=Od+sn.Util._capitalize(t);e.prototype[o]||Gn.Factory.overWriteSetter(e,t,i,n)},overWriteSetter(e,t,i,n){let o=Od+sn.Util._capitalize(t);e.prototype[o]=function(r){return i&&r!==void 0&&r!==null&&(r=i.call(this,r,t)),this._setAttr(t,r),n&&n.call(this),this}},addComponentsGetterSetter(e,t,i,n,o){let r=i.length,s=sn.Util._capitalize,a=Ld+s(t),l=Od+s(t);e.prototype[a]=function(){let d={};for(let u=0;u<r;u++){let h=i[u];d[h]=this.getAttr(t+s(h))}return d};let c=(0,pJ.getComponentValidator)(i);e.prototype[l]=function(d){let u=this.attrs[t];n&&(d=n.call(this,d,t)),c&&c.call(this,d,t);for(let h in d)d.hasOwnProperty(h)&&this._setAttr(t+s(h),d[h]);return d||i.forEach(h=>{this._setAttr(t+s(h),void 0)}),this._fireChangeEvent(t,u,d),o&&o.call(this),this},Gn.Factory.addOverloadedGetterSetter(e,t)},addOverloadedGetterSetter(e,t){let i=sn.Util._capitalize(t),n=Od+i,o=Ld+i;e.prototype[t]=function(){return arguments.length?(this[n](arguments[0]),this):this[o]()}},addDeprecatedGetterSetter(e,t,i,n){sn.Util.error("Adding deprecated "+t);let o=Ld+sn.Util._capitalize(t),r=t+" property is deprecated and will be removed soon. Look at Konva change log for more information.";e.prototype[o]=function(){sn.Util.error(r);let s=this.attrs[t];return s===void 0?i:s},Gn.Factory.addSetter(e,t,n,function(){sn.Util.error(r)}),Gn.Factory.addOverloadedGetterSetter(e,t)},backCompat(e,t){sn.Util.each(t,function(i,n){let o=e.prototype[n],r=Ld+sn.Util._capitalize(i),s=Od+sn.Util._capitalize(i);function a(){o.apply(this,arguments),sn.Util.error('"'+i+'" method is deprecated and will be removed soon. Use ""'+n+'" instead.')}e.prototype[i]=a,e.prototype[r]=a,e.prototype[s]=a})},afterSetFilter(){this._filterUpToDate=!1}}});var Pt=me(Cg=>{"use strict";Object.defineProperty(Cg,"__esModule",{value:!0});Cg.Node=void 0;var Il=Id(),Sn=gg(),Nd=Ae(),ds=Ie(),Be=St(),It=Oe(),mg="absoluteOpacity",fg="allEventListeners",pr="absoluteTransform",gM="absoluteScale",fa="canvas",gJ="Change",fJ="children",mJ="konva",Yw="listening",vJ="mouseenter",CJ="mouseleave",wJ="pointerenter",bJ="pointerleave",yJ="touchenter",SJ="touchleave",fM="set",mM="Shape",vg=" ",vM="stage",us="transform",xJ="Stage",Xw="visible",EJ=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(vg),_J=1,ke=class e{constructor(t){this._id=_J++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===us||t===pr)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,i){let n=this._cache.get(t);return(n===void 0||(t===us||t===pr)&&n.dirty===!0)&&(n=i.call(this),this._cache.set(t,n)),n}_calculate(t,i,n){if(!this._attachedDepsListeners.get(t)){let o=i.map(r=>r+"Change.konva").join(vg);this.on(o,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,n)}_getCanvasCache(){return this._cache.get(fa)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===pr&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(fa)){let{scene:t,filter:i,hit:n,buffer:o}=this._cache.get(fa);Be.Util.releaseCanvas(t,i,n,o),this._cache.delete(fa)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){let i=t||{},n={};(i.x===void 0||i.y===void 0||i.width===void 0||i.height===void 0)&&(n=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let o=Math.ceil(i.width||n.width),r=Math.ceil(i.height||n.height),s=i.pixelRatio,a=i.x===void 0?Math.floor(n.x):i.x,l=i.y===void 0?Math.floor(n.y):i.y,c=i.offset||0,d=i.drawBorder||!1,u=i.hitCanvasPixelRatio||1;if(!o||!r){Be.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}let h=Math.abs(Math.round(n.x)-a)>.5?1:0,p=Math.abs(Math.round(n.y)-l)>.5?1:0;o+=c*2+h,r+=c*2+p,a-=c,l-=c;let g=new Il.SceneCanvas({pixelRatio:s,width:o,height:r}),f=new Il.SceneCanvas({pixelRatio:s,width:0,height:0,willReadFrequently:!0}),m=new Il.HitCanvas({pixelRatio:u,width:o,height:r}),v=g.getContext(),C=m.getContext(),w=new Il.SceneCanvas({width:g.width/g.pixelRatio+Math.abs(a),height:g.height/g.pixelRatio+Math.abs(l),pixelRatio:g.pixelRatio}),y=w.getContext();return m.isCache=!0,g.isCache=!0,this._cache.delete(fa),this._filterUpToDate=!1,i.imageSmoothingEnabled===!1&&(g.getContext()._context.imageSmoothingEnabled=!1,f.getContext()._context.imageSmoothingEnabled=!1),v.save(),C.save(),y.save(),v.translate(-a,-l),C.translate(-a,-l),y.translate(-a,-l),w.x=a,w.y=l,this._isUnderCache=!0,this._clearSelfAndDescendantCache(mg),this._clearSelfAndDescendantCache(gM),this.drawScene(g,this,w),this.drawHit(m,this),this._isUnderCache=!1,v.restore(),C.restore(),d&&(v.save(),v.beginPath(),v.rect(0,0,o,r),v.closePath(),v.setAttr("strokeStyle","red"),v.setAttr("lineWidth",5),v.stroke(),v.restore()),this._cache.set(fa,{scene:g,filter:f,hit:m,buffer:w,x:a,y:l}),this._requestDraw(),this}isCached(){return this._cache.has(fa)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,i){let n=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],o=1/0,r=1/0,s=-1/0,a=-1/0,l=this.getAbsoluteTransform(i);return n.forEach(function(c){let d=l.point(c);o===void 0&&(o=s=d.x,r=a=d.y),o=Math.min(o,d.x),r=Math.min(r,d.y),s=Math.max(s,d.x),a=Math.max(a,d.y)}),{x:o,y:r,width:s-o,height:a-r}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);let i=this._getCanvasCache();t.translate(i.x,i.y);let n=this._getCachedSceneCanvas(),o=n.pixelRatio;t.drawImage(n._canvas,0,0,n.width/o,n.height/o),t.restore()}_drawCachedHitCanvas(t){let i=this._getCanvasCache(),n=i.hit;t.save(),t.translate(i.x,i.y),t.drawImage(n._canvas,0,0,n.width/n.pixelRatio,n.height/n.pixelRatio),t.restore()}_getCachedSceneCanvas(){let t=this.filters(),i=this._getCanvasCache(),n=i.scene,o=i.filter,r=o.getContext(),s,a,l,c;if(t){if(!this._filterUpToDate){let d=n.pixelRatio;o.setSize(n.width/n.pixelRatio,n.height/n.pixelRatio);try{for(s=t.length,r.clear(),r.drawImage(n._canvas,0,0,n.getWidth()/d,n.getHeight()/d),a=r.getImageData(0,0,o.getWidth(),o.getHeight()),l=0;l<s;l++){if(c=t[l],typeof c!="function"){Be.Util.error("Filter should be type of function, but got "+typeof c+" instead. Please check correct filters");continue}c.call(this,a),r.putImageData(a,0,0)}}catch(u){Be.Util.error("Unable to apply filter. "+u.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return o}return n}on(t,i){if(this._cache&&this._cache.delete(fg),arguments.length===3)return this._delegate.apply(this,arguments);let n=t.split(vg);for(let o=0;o<n.length;o++){let s=n[o].split("."),a=s[0],l=s[1]||"";this.eventListeners[a]||(this.eventListeners[a]=[]),this.eventListeners[a].push({name:l,handler:i})}return this}off(t,i){let n=(t||"").split(vg),o=n.length,r,s,a,l,c,d;if(this._cache&&this._cache.delete(fg),!t)for(s in this.eventListeners)this._off(s);for(r=0;r<o;r++)if(a=n[r],l=a.split("."),c=l[0],d=l[1],c)this.eventListeners[c]&&this._off(c,d,i);else for(s in this.eventListeners)this._off(s,d,i);return this}dispatchEvent(t){let i={target:this,type:t.type,evt:t};return this.fire(t.type,i),this}addEventListener(t,i){return this.on(t,function(n){i.call(this,n.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,i,n){let o=this;this.on(t,function(r){let s=r.target.findAncestors(i,!0,o);for(let a=0;a<s.length;a++)r=Be.Util.cloneObject(r),r.currentTarget=s[a],n.call(s[a],r)})}remove(){return this.isDragging()&&this.stopDrag(),Sn.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(pr),this._clearSelfAndDescendantCache(mg),this._clearSelfAndDescendantCache(gM),this._clearSelfAndDescendantCache(vM),this._clearSelfAndDescendantCache(Xw),this._clearSelfAndDescendantCache(Yw)}_remove(){this._clearCaches();let t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){let i="get"+Be.Util._capitalize(t);return Be.Util._isFunction(this[i])?this[i]():this.attrs[t]}getAncestors(){let t=this.getParent(),i=[];for(;t;)i.push(t),t=t.getParent();return i}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{let i,n;if(!t)return this;for(i in t)i!==fJ&&(n=fM+Be.Util._capitalize(i),Be.Util._isFunction(this[n])?this[n](t[i]):this._setAttr(i,t[i]))}),this}isListening(){return this._getCache(Yw,this._isListening)}_isListening(t){if(!this.listening())return!1;let n=this.getParent();return n&&n!==t&&this!==t?n._isListening(t):!0}isVisible(){return this._getCache(Xw,this._isVisible)}_isVisible(t){if(!this.visible())return!1;let n=this.getParent();return n&&n!==t&&this!==t?n._isVisible(t):!0}shouldDrawHit(t,i=!1){if(t)return this._isVisible(t)&&this._isListening(t);let n=this.getLayer(),o=!1;Sn.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(s.node.nodeType==="Stage"||s.node.getLayer()===n)&&(o=!0)});let r=!i&&!ds.Konva.hitOnDragEnabled&&(o||ds.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!r}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let t=this.getDepth(),i=this,n=0,o,r,s,a;function l(d){for(o=[],r=d.length,s=0;s<r;s++)a=d[s],n++,a.nodeType!==mM&&(o=o.concat(a.getChildren().slice())),a._id===i._id&&(s=r);o.length>0&&o[0].getDepth()<=t&&l(o)}let c=this.getStage();return i.nodeType!==xJ&&c&&l(c.getChildren()),n}getDepth(){let t=0,i=this.parent;for(;i;)t++,i=i.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(us),this._clearSelfAndDescendantCache(pr)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){let t=this.getStage();if(!t)return null;let i=t.getPointerPosition();if(!i)return null;let n=this.getAbsoluteTransform().copy();return n.invert(),n.point(i)}getAbsolutePosition(t){let i=!1,n=this.parent;for(;n;){if(n.isCached()){i=!0;break}n=n.parent}i&&!t&&(t=!0);let o=this.getAbsoluteTransform(t).getMatrix(),r=new Be.Transform,s=this.offset();return r.m=o.slice(),r.translate(s.x,s.y),r.getTranslation()}setAbsolutePosition(t){let s=this._clearTransform(),{x:i,y:n}=s,o=Ai(s,["x","y"]);this.attrs.x=i,this.attrs.y=n,this._clearCache(us);let r=this._getAbsoluteTransform().copy();return r.invert(),r.translate(t.x,t.y),t={x:this.attrs.x+r.getTranslation().x,y:this.attrs.y+r.getTranslation().y},this._setTransform(o),this.setPosition({x:t.x,y:t.y}),this._clearCache(us),this._clearSelfAndDescendantCache(pr),this}_setTransform(t){let i;for(i in t)this.attrs[i]=t[i]}_clearTransform(){let t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){let i=t.x,n=t.y,o=this.x(),r=this.y();return i!==void 0&&(o+=i),n!==void 0&&(r+=n),this.setPosition({x:o,y:r}),this}_eachAncestorReverse(t,i){let n=[],o=this.getParent(),r,s;if(!(i&&i._id===this._id)){for(n.unshift(this);o&&(!i||o._id!==i._id);)n.unshift(o),o=o.parent;for(r=n.length,s=0;s<r;s++)t(n[s])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return Be.Util.warn("Node has no parent. moveToTop function is ignored."),!1;let t=this.index,i=this.parent.getChildren().length;return t<i-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return Be.Util.warn("Node has no parent. moveUp function is ignored."),!1;let t=this.index,i=this.parent.getChildren().length;return t<i-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return Be.Util.warn("Node has no parent. moveDown function is ignored."),!1;let t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return Be.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;let t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return Be.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&Be.Util.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");let i=this.index;return this.parent.children.splice(i,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(mg,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let t=this.opacity(),i=this.getParent();return i&&!i._isUnderCache&&(t*=i.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){let t=this.getAttrs(),i,n,o,r,s,a={attrs:{},className:this.getClassName()};for(i in t)n=t[i],s=Be.Util.isObject(n)&&!Be.Util._isPlainObject(n)&&!Be.Util._isArray(n),!s&&(o=typeof this[i]=="function"&&this[i],delete t[i],r=o?o.call(this):null,t[i]=n,r!==n&&(a.attrs[i]=n));return Be.Util._prepareToStringify(a)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,i,n){let o=[];i&&this._isMatch(t)&&o.push(this);let r=this.parent;for(;r;){if(r===n)return o;r._isMatch(t)&&o.push(r),r=r.parent}return o}isAncestorOf(t){return!1}findAncestor(t,i,n){return this.findAncestors(t,i,n)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);let i=t.replace(/ /g,"").split(","),n=i.length,o,r;for(o=0;o<n;o++)if(r=i[o],Be.Util.isValidSelector(r)||(Be.Util.warn('Selector "'+r+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),Be.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),Be.Util.warn("Konva is awesome, right?")),r.charAt(0)==="#"){if(this.id()===r.slice(1))return!0}else if(r.charAt(0)==="."){if(this.hasName(r.slice(1)))return!0}else if(this.className===r||this.nodeType===r)return!0;return!1}getLayer(){let t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(vM,this._getStage)}_getStage(){let t=this.getParent();return t?t.getStage():null}fire(t,i={},n){return i.target=i.target||this,n?this._fireAndBubble(t,i):this._fire(t,i),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(pr,this._getAbsoluteTransform)}_getAbsoluteTransform(t){let i;if(t)return i=new Be.Transform,this._eachAncestorReverse(function(n){let o=n.transformsEnabled();o==="all"?i.multiply(n.getTransform()):o==="position"&&i.translate(n.x()-n.offsetX(),n.y()-n.offsetY())},t),i;{i=this._cache.get(pr)||new Be.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(i):i.reset();let n=this.transformsEnabled();if(n==="all")i.multiply(this.getTransform());else if(n==="position"){let o=this.attrs.x||0,r=this.attrs.y||0,s=this.attrs.offsetX||0,a=this.attrs.offsetY||0;i.translate(o-s,r-a)}return i.dirty=!1,i}}getAbsoluteScale(t){let i=this;for(;i;)i._isUnderCache&&(t=i),i=i.getParent();let o=this.getAbsoluteTransform(t).decompose();return{x:o.scaleX,y:o.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(us,this._getTransform)}_getTransform(){var t,i;let n=this._cache.get(us)||new Be.Transform;n.reset();let o=this.x(),r=this.y(),s=ds.Konva.getAngle(this.rotation()),a=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,l=(i=this.attrs.scaleY)!==null&&i!==void 0?i:1,c=this.attrs.skewX||0,d=this.attrs.skewY||0,u=this.attrs.offsetX||0,h=this.attrs.offsetY||0;return(o!==0||r!==0)&&n.translate(o,r),s!==0&&n.rotate(s),(c!==0||d!==0)&&n.skew(c,d),(a!==1||l!==1)&&n.scale(a,l),(u!==0||h!==0)&&n.translate(-1*u,-1*h),n.dirty=!1,n}clone(t){let i=Be.Util.cloneObject(this.attrs),n,o,r,s,a;for(n in t)i[n]=t[n];let l=new this.constructor(i);for(n in this.eventListeners)for(o=this.eventListeners[n],r=o.length,s=0;s<r;s++)a=o[s],a.name.indexOf(mJ)<0&&(l.eventListeners[n]||(l.eventListeners[n]=[]),l.eventListeners[n].push(a));return l}_toKonvaCanvas(t){t=t||{};let i=this.getClientRect(),n=this.getStage(),o=t.x!==void 0?t.x:Math.floor(i.x),r=t.y!==void 0?t.y:Math.floor(i.y),s=t.pixelRatio||1,a=new Il.SceneCanvas({width:t.width||Math.ceil(i.width)||(n?n.width():0),height:t.height||Math.ceil(i.height)||(n?n.height():0),pixelRatio:s}),l=a.getContext(),c=new Il.SceneCanvas({width:a.width/a.pixelRatio+Math.abs(o),height:a.height/a.pixelRatio+Math.abs(r),pixelRatio:a.pixelRatio});return t.imageSmoothingEnabled===!1&&(l._context.imageSmoothingEnabled=!1),l.save(),(o||r)&&l.translate(-1*o,-1*r),this.drawScene(a,void 0,c),l.restore(),a}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};let i=t.mimeType||null,n=t.quality||null,o=this._toKonvaCanvas(t).toDataURL(i,n);return t.callback&&t.callback(o),o}toImage(t){return new Promise((i,n)=>{try{let o=t?.callback;o&&delete t.callback,Be.Util._urlToImage(this.toDataURL(t),function(r){i(r),o?.(r)})}catch(o){n(o)}})}toBlob(t){return new Promise((i,n)=>{try{let o=t?.callback;o&&delete t.callback,this.toCanvas(t).toBlob(r=>{i(r),o?.(r)},t?.mimeType,t?.quality)}catch(o){n(o)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():ds.Konva.dragDistance}_off(t,i,n){let o=this.eventListeners[t],r,s,a;for(r=0;r<o.length;r++)if(s=o[r].name,a=o[r].handler,(s!=="konva"||i==="konva")&&(!i||s===i)&&(!n||n===a)){if(o.splice(r,1),o.length===0){delete this.eventListeners[t];break}r--}}_fireChangeEvent(t,i,n){this._fire(t+gJ,{oldVal:i,newVal:n})}addName(t){if(!this.hasName(t)){let i=this.name(),n=i?i+" "+t:t;this.name(n)}return this}hasName(t){if(!t)return!1;let i=this.name();return i?(i||"").split(/\s/g).indexOf(t)!==-1:!1}removeName(t){let i=(this.name()||"").split(/\s/g),n=i.indexOf(t);return n!==-1&&(i.splice(n,1),this.name(i.join(" "))),this}setAttr(t,i){let n=this[fM+Be.Util._capitalize(t)];return Be.Util._isFunction(n)?n.call(this,i):this._setAttr(t,i),this}_requestDraw(){if(ds.Konva.autoDrawEnabled){let t=this.getLayer()||this.getStage();t?.batchDraw()}}_setAttr(t,i){let n=this.attrs[t];n===i&&!Be.Util.isObject(i)||(i==null?delete this.attrs[t]:this.attrs[t]=i,this._shouldFireChangeEvents&&this._fireChangeEvent(t,n,i),this._requestDraw())}_setComponentAttr(t,i,n){let o;n!==void 0&&(o=this.attrs[t],o||(this.attrs[t]=this.getAttr(t)),this.attrs[t][i]=n,this._fireChangeEvent(t,o,n))}_fireAndBubble(t,i,n){i&&this.nodeType===mM&&(i.target=this);let o=[vJ,CJ,wJ,bJ,yJ,SJ];if(!(o.indexOf(t)!==-1&&(n&&(this===n||this.isAncestorOf&&this.isAncestorOf(n))||this.nodeType==="Stage"&&!n))){this._fire(t,i);let s=o.indexOf(t)!==-1&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(i&&!i.cancelBubble||!i)&&this.parent&&this.parent.isListening()&&!s&&(n&&n.parent?this._fireAndBubble.call(this.parent,t,i,n):this._fireAndBubble.call(this.parent,t,i))}}_getProtoListeners(t){var i,n,o;let r=(i=this._cache.get(fg))!==null&&i!==void 0?i:{},s=r?.[t];if(s===void 0){s=[];let a=Object.getPrototypeOf(this);for(;a;){let l=(o=(n=a.eventListeners)===null||n===void 0?void 0:n[t])!==null&&o!==void 0?o:[];s.push(...l),a=Object.getPrototypeOf(a)}r[t]=s,this._cache.set(fg,r)}return s}_fire(t,i){i=i||{},i.currentTarget=this,i.type=t;let n=this._getProtoListeners(t);if(n)for(let r=0;r<n.length;r++)n[r].handler.call(this,i);let o=this.eventListeners[t];if(o)for(let r=0;r<o.length;r++)o[r].handler.call(this,i)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){let i=t?t.pointerId:void 0,n=this.getStage(),o=this.getAbsolutePosition();if(!n)return;let r=n._getPointerById(i)||n._changedPointerPositions[0]||o;Sn.DD._dragElements.set(this._id,{node:this,startPointerPos:r,offset:{x:r.x-o.x,y:r.y-o.y},dragStatus:"ready",pointerId:i})}startDrag(t,i=!0){Sn.DD._dragElements.has(this._id)||this._createDragElement(t);let n=Sn.DD._dragElements.get(this._id);n.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},i)}_setDragPosition(t,i){let n=this.getStage()._getPointerById(i.pointerId);if(!n)return;let o={x:n.x-i.offset.x,y:n.y-i.offset.y},r=this.dragBoundFunc();if(r!==void 0){let s=r.call(this,o,t);s?o=s:Be.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==o.x||this._lastPos.y!==o.y)&&(this.setAbsolutePosition(o),this._requestDraw()),this._lastPos=o}stopDrag(t){let i=Sn.DD._dragElements.get(this._id);i&&(i.dragStatus="stopped"),Sn.DD._endDragBefore(t),Sn.DD._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){let t=Sn.DD._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){if(!(!(t.evt.button!==void 0)||ds.Konva.dragButtons.indexOf(t.evt.button)>=0)||this.isDragging())return;let o=!1;Sn.DD._dragElements.forEach(r=>{this.isAncestorOf(r.node)&&(o=!0)}),o||this._createDragElement(t)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;let i=Sn.DD._dragElements.get(this._id),n=i&&i.dragStatus==="dragging",o=i&&i.dragStatus==="ready";n?this.stopDrag():o&&Sn.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){let i=this.getStage();if(!i)return!1;let n={x:-t.x,y:-t.y,width:i.width()+2*t.x,height:i.height()+2*t.y};return Be.Util.haveIntersection(n,this.getClientRect())}static create(t,i){return Be.Util._isString(t)&&(t=JSON.parse(t)),this._createNode(t,i)}static _createNode(t,i){let n=e.prototype.getClassName.call(t),o=t.children,r,s,a;i&&(t.attrs.container=i),ds.Konva[n]||(Be.Util.warn('Can not find a node with class name "'+n+'". Fallback to "Shape".'),n="Shape");let l=ds.Konva[n];if(r=new l(t.attrs),o)for(s=o.length,a=0;a<s;a++)r.add(e._createNode(o[a]));return r}};Cg.Node=ke;ke.prototype.nodeType="Node";ke.prototype._attrsAffectingSize=[];ke.prototype.eventListeners={};ke.prototype.on.call(ke.prototype,EJ,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(us),this._clearSelfAndDescendantCache(pr)});ke.prototype.on.call(ke.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(Xw)});ke.prototype.on.call(ke.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(Yw)});ke.prototype.on.call(ke.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(mg)});var at=Nd.Factory.addGetterSetter;at(ke,"zIndex");at(ke,"absolutePosition");at(ke,"position");at(ke,"x",0,(0,It.getNumberValidator)());at(ke,"y",0,(0,It.getNumberValidator)());at(ke,"globalCompositeOperation","source-over",(0,It.getStringValidator)());at(ke,"opacity",1,(0,It.getNumberValidator)());at(ke,"name","",(0,It.getStringValidator)());at(ke,"id","",(0,It.getStringValidator)());at(ke,"rotation",0,(0,It.getNumberValidator)());Nd.Factory.addComponentsGetterSetter(ke,"scale",["x","y"]);at(ke,"scaleX",1,(0,It.getNumberValidator)());at(ke,"scaleY",1,(0,It.getNumberValidator)());Nd.Factory.addComponentsGetterSetter(ke,"skew",["x","y"]);at(ke,"skewX",0,(0,It.getNumberValidator)());at(ke,"skewY",0,(0,It.getNumberValidator)());Nd.Factory.addComponentsGetterSetter(ke,"offset",["x","y"]);at(ke,"offsetX",0,(0,It.getNumberValidator)());at(ke,"offsetY",0,(0,It.getNumberValidator)());at(ke,"dragDistance",void 0,(0,It.getNumberValidator)());at(ke,"width",0,(0,It.getNumberValidator)());at(ke,"height",0,(0,It.getNumberValidator)());at(ke,"listening",!0,(0,It.getBooleanValidator)());at(ke,"preventDefault",!0,(0,It.getBooleanValidator)());at(ke,"filters",void 0,function(e){return this._filterUpToDate=!1,e});at(ke,"visible",!0,(0,It.getBooleanValidator)());at(ke,"transformsEnabled","all",(0,It.getStringValidator)());at(ke,"size");at(ke,"dragBoundFunc");at(ke,"draggable",!1,(0,It.getBooleanValidator)());Nd.Factory.backCompat(ke,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"})});var Bd=me(bg=>{"use strict";Object.defineProperty(bg,"__esModule",{value:!0});bg.Container=void 0;var Al=Ae(),Jw=Pt(),wg=Oe(),gr=class extends Jw.Node{constructor(){super(...arguments),this.children=[]}getChildren(t){let i=this.children||[];return t?i.filter(t):i}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(let n=0;n<t.length;n++)this.add(t[n]);return this}let i=t[0];return i.getParent()?(i.moveTo(this),this):(this._validateAdd(i),i.index=this.getChildren().length,i.parent=this,i._clearCaches(),this.getChildren().push(i),this._fire("add",{child:i}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){let i=this._generalFind(t,!0);return i.length>0?i[0]:void 0}_generalFind(t,i){let n=[];return this._descendants(o=>{let r=o._isMatch(t);return r&&n.push(o),!!(r&&i)}),n}_descendants(t){let i=!1,n=this.getChildren();for(let o of n){if(i=t(o),i)return!0;if(o.hasChildren()&&(i=o._descendants(t),i))return!0}return!1}toObject(){let t=Jw.Node.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(i=>{t.children.push(i.toObject())}),t}isAncestorOf(t){let i=t.getParent();for(;i;){if(i._id===this._id)return!0;i=i.getParent()}return!1}clone(t){let i=Jw.Node.prototype.clone.call(this,t);return this.getChildren().forEach(function(n){i.add(n.clone())}),i}getAllIntersections(t){let i=[];return this.find("Shape").forEach(n=>{n.isVisible()&&n.intersects(t)&&i.push(n)}),i}_clearSelfAndDescendantCache(t){var i;super._clearSelfAndDescendantCache(t),!this.isCached()&&((i=this.children)===null||i===void 0||i.forEach(function(n){n._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(i,n){i.index=n}),this._requestDraw()}drawScene(t,i,n){let o=this.getLayer(),r=t||o&&o.getCanvas(),s=r&&r.getContext(),a=this._getCanvasCache(),l=a&&a.scene,c=r&&r.isCache;if(!this.isVisible()&&!c)return this;if(l){s.save();let d=this.getAbsoluteTransform(i).getMatrix();s.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this._drawCachedSceneCanvas(s),s.restore()}else this._drawChildren("drawScene",r,i,n);return this}drawHit(t,i){if(!this.shouldDrawHit(i))return this;let n=this.getLayer(),o=t||n&&n.hitCanvas,r=o&&o.getContext(),s=this._getCanvasCache();if(s&&s.hit){r.save();let l=this.getAbsoluteTransform(i).getMatrix();r.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this._drawCachedHitCanvas(r),r.restore()}else this._drawChildren("drawHit",o,i);return this}_drawChildren(t,i,n,o){var r;let s=i&&i.getContext(),a=this.clipWidth(),l=this.clipHeight(),c=this.clipFunc(),d=typeof a=="number"&&typeof l=="number"||c,u=n===this;if(d){s.save();let p=this.getAbsoluteTransform(n),g=p.getMatrix();s.transform(g[0],g[1],g[2],g[3],g[4],g[5]),s.beginPath();let f;if(c)f=c.call(this,s,this);else{let m=this.clipX(),v=this.clipY();s.rect(m||0,v||0,a,l)}s.clip.apply(s,f),g=p.copy().invert().getMatrix(),s.transform(g[0],g[1],g[2],g[3],g[4],g[5])}let h=!u&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";h&&(s.save(),s._applyGlobalCompositeOperation(this)),(r=this.children)===null||r===void 0||r.forEach(function(p){p[t](i,n,o)}),h&&s.restore(),d&&s.restore()}getClientRect(t={}){var i;let n=t.skipTransform,o=t.relativeTo,r,s,a,l,c={x:1/0,y:1/0,width:0,height:0},d=this;(i=this.children)===null||i===void 0||i.forEach(function(p){if(!p.visible())return;let g=p.getClientRect({relativeTo:d,skipShadow:t.skipShadow,skipStroke:t.skipStroke});g.width===0&&g.height===0||(r===void 0?(r=g.x,s=g.y,a=g.x+g.width,l=g.y+g.height):(r=Math.min(r,g.x),s=Math.min(s,g.y),a=Math.max(a,g.x+g.width),l=Math.max(l,g.y+g.height)))});let u=this.find("Shape"),h=!1;for(let p=0;p<u.length;p++)if(u[p]._isVisible(this)){h=!0;break}return h&&r!==void 0?c={x:r,y:s,width:a-r,height:l-s}:c={x:0,y:0,width:0,height:0},n?c:this._transformedRect(c,o)}};bg.Container=gr;Al.Factory.addComponentsGetterSetter(gr,"clip",["x","y","width","height"]);Al.Factory.addGetterSetter(gr,"clipX",void 0,(0,wg.getNumberValidator)());Al.Factory.addGetterSetter(gr,"clipY",void 0,(0,wg.getNumberValidator)());Al.Factory.addGetterSetter(gr,"clipWidth",void 0,(0,wg.getNumberValidator)());Al.Factory.addGetterSetter(gr,"clipHeight",void 0,(0,wg.getNumberValidator)());Al.Factory.addGetterSetter(gr,"clipFunc")});var Zw=me(ma=>{"use strict";Object.defineProperty(ma,"__esModule",{value:!0});ma.getCapturedShape=PJ;ma.createEvent=Qw;ma.hasPointerCapture=DJ;ma.setPointerCapture=MJ;ma.releaseCapture=wM;var RJ=Ie(),Hd=new Map,CM=RJ.Konva._global.PointerEvent!==void 0;function PJ(e){return Hd.get(e)}function Qw(e){return{evt:e,pointerId:e.pointerId}}function DJ(e,t){return Hd.get(e)===t}function MJ(e,t){wM(e),t.getStage()&&(Hd.set(e,t),CM&&t._fire("gotpointercapture",Qw(new PointerEvent("gotpointercapture"))))}function wM(e,t){let i=Hd.get(e);if(!i)return;let n=i.getStage();n&&n.content,Hd.delete(e),CM&&i._fire("lostpointercapture",Qw(new PointerEvent("lostpointercapture")))}});var rb=me(xo=>{"use strict";Object.defineProperty(xo,"__esModule",{value:!0});xo.Stage=xo.stages=void 0;var So=St(),kJ=Ae(),bM=Bd(),At=Ie(),eb=Id(),tb=gg(),TJ=Ie(),fr=Zw(),FJ="Stage",IJ="string",yM="px",AJ="mouseout",xM="mouseleave",EM="mouseover",_M="mouseenter",RM="mousemove",PM="mousedown",DM="mouseup",Vd="pointermove",Gd="pointerdown",Ol="pointerup",zd="pointercancel",LJ="lostpointercapture",yg="pointerout",Wd="pointerleave",Sg="pointerover",xg="pointerenter",nb="contextmenu",MM="touchstart",kM="touchend",TM="touchmove",FM="touchcancel",ob="wheel",OJ=5,NJ=[[_M,"_pointerenter"],[PM,"_pointerdown"],[RM,"_pointermove"],[DM,"_pointerup"],[xM,"_pointerleave"],[MM,"_pointerdown"],[TM,"_pointermove"],[kM,"_pointerup"],[FM,"_pointercancel"],[EM,"_pointerover"],[ob,"_wheel"],[nb,"_contextmenu"],[Gd,"_pointerdown"],[Vd,"_pointermove"],[Ol,"_pointerup"],[zd,"_pointercancel"],[Wd,"_pointerleave"],[LJ,"_lostpointercapture"]],ib={mouse:{[yg]:AJ,[Wd]:xM,[Sg]:EM,[xg]:_M,[Vd]:RM,[Gd]:PM,[Ol]:DM,[zd]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[yg]:"touchout",[Wd]:"touchleave",[Sg]:"touchover",[xg]:"touchenter",[Vd]:TM,[Gd]:MM,[Ol]:kM,[zd]:FM,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[yg]:yg,[Wd]:Wd,[Sg]:Sg,[xg]:xg,[Vd]:Vd,[Gd]:Gd,[Ol]:Ol,[zd]:zd,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},Ud=e=>e.indexOf("pointer")>=0?"pointer":e.indexOf("touch")>=0?"touch":"mouse",Ll=e=>{let t=Ud(e);if(t==="pointer")return At.Konva.pointerEventsEnabled&&ib.pointer;if(t==="touch")return ib.touch;if(t==="mouse")return ib.mouse};function SM(e={}){return(e.clipFunc||e.clipWidth||e.clipHeight)&&So.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),e}var BJ="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";xo.stages=[];var Nl=class extends bM.Container{constructor(t){super(SM(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),xo.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{SM(this.attrs)}),this._checkVisibility()}_validateAdd(t){let i=t.getType()==="Layer",n=t.getType()==="FastLayer";i||n||So.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;let t=this.visible()?"":"none";this.content.style.display=t}setContainer(t){if(typeof t===IJ){let i;if(t.charAt(0)==="."){let n=t.slice(1);t=document.getElementsByClassName(n)[0]}else t.charAt(0)!=="#"?i=t:i=t.slice(1),t=document.getElementById(i);if(!t)throw"Can not find container in document with id "+i}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){let t=this.children,i=t.length;for(let n=0;n<i;n++)t[n].clear();return this}clone(t){return t||(t={}),t.container=typeof document<"u"&&document.createElement("div"),bM.Container.prototype.clone.call(this,t)}destroy(){super.destroy();let t=this.content;t&&So.Util._isInDocument(t)&&this.container().removeChild(t);let i=xo.stages.indexOf(this);return i>-1&&xo.stages.splice(i,1),So.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){let t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(So.Util.warn(BJ),null)}_getPointerById(t){return this._pointerPositions.find(i=>i.id===t)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(t){t=t||{},t.x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();let i=new eb.SceneCanvas({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),n=i.getContext()._context,o=this.children;return(t.x||t.y)&&n.translate(-1*t.x,-1*t.y),o.forEach(function(r){if(!r.isVisible())return;let s=r._toKonvaCanvas(t);n.drawImage(s._canvas,t.x,t.y,s.getWidth()/s.getPixelRatio(),s.getHeight()/s.getPixelRatio())}),i}getIntersection(t){if(!t)return null;let i=this.children,n=i.length,o=n-1;for(let r=o;r>=0;r--){let s=i[r].getIntersection(t);if(s)return s}return null}_resizeDOM(){let t=this.width(),i=this.height();this.content&&(this.content.style.width=t+yM,this.content.style.height=i+yM),this.bufferCanvas.setSize(t,i),this.bufferHitCanvas.setSize(t,i),this.children.forEach(n=>{n.setSize({width:t,height:i}),n.draw()})}add(t,...i){if(arguments.length>1){for(let o=0;o<arguments.length;o++)this.add(arguments[o]);return this}super.add(t);let n=this.children.length;return n>OJ&&So.Util.warn("The stage has "+n+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),t.setSize({width:this.width(),height:this.height()}),t.draw(),At.Konva.isBrowser&&this.content.appendChild(t.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(t){return fr.hasPointerCapture(t,this)}setPointerCapture(t){fr.setPointerCapture(t,this)}releaseCapture(t){fr.releaseCapture(t,this)}getLayers(){return this.children}_bindContentEvents(){At.Konva.isBrowser&&NJ.forEach(([t,i])=>{this.content.addEventListener(t,n=>{this[i](n)},{passive:!1})})}_pointerenter(t){this.setPointersPositions(t);let i=Ll(t.type);i&&this._fire(i.pointerenter,{evt:t,target:this,currentTarget:this})}_pointerover(t){this.setPointersPositions(t);let i=Ll(t.type);i&&this._fire(i.pointerover,{evt:t,target:this,currentTarget:this})}_getTargetShape(t){let i=this[t+"targetShape"];return i&&!i.getStage()&&(i=null),i}_pointerleave(t){let i=Ll(t.type),n=Ud(t.type);if(!i)return;this.setPointersPositions(t);let o=this._getTargetShape(n),r=!(At.Konva.isDragging()||At.Konva.isTransforming())||At.Konva.hitOnDragEnabled;o&&r?(o._fireAndBubble(i.pointerout,{evt:t}),o._fireAndBubble(i.pointerleave,{evt:t}),this._fire(i.pointerleave,{evt:t,target:this,currentTarget:this}),this[n+"targetShape"]=null):r&&(this._fire(i.pointerleave,{evt:t,target:this,currentTarget:this}),this._fire(i.pointerout,{evt:t,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(t){let i=Ll(t.type),n=Ud(t.type);if(!i)return;this.setPointersPositions(t);let o=!1;this._changedPointerPositions.forEach(r=>{let s=this.getIntersection(r);if(tb.DD.justDragged=!1,At.Konva["_"+n+"ListenClick"]=!0,!s||!s.isListening()){this[n+"ClickStartShape"]=void 0;return}At.Konva.capturePointerEventsEnabled&&s.setPointerCapture(r.id),this[n+"ClickStartShape"]=s,s._fireAndBubble(i.pointerdown,{evt:t,pointerId:r.id}),o=!0;let a=t.type.indexOf("touch")>=0;s.preventDefault()&&t.cancelable&&a&&t.preventDefault()}),o||this._fire(i.pointerdown,{evt:t,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(t){let i=Ll(t.type),n=Ud(t.type);if(!i||(At.Konva.isDragging()&&tb.DD.node.preventDefault()&&t.cancelable&&t.preventDefault(),this.setPointersPositions(t),!(!(At.Konva.isDragging()||At.Konva.isTransforming())||At.Konva.hitOnDragEnabled)))return;let r={},s=!1,a=this._getTargetShape(n);this._changedPointerPositions.forEach(l=>{let c=fr.getCapturedShape(l.id)||this.getIntersection(l),d=l.id,u={evt:t,pointerId:d},h=a!==c;if(h&&a&&(a._fireAndBubble(i.pointerout,b({},u),c),a._fireAndBubble(i.pointerleave,b({},u),c)),c){if(r[c._id])return;r[c._id]=!0}c&&c.isListening()?(s=!0,h&&(c._fireAndBubble(i.pointerover,b({},u),a),c._fireAndBubble(i.pointerenter,b({},u),a),this[n+"targetShape"]=c),c._fireAndBubble(i.pointermove,b({},u))):a&&(this._fire(i.pointerover,{evt:t,target:this,currentTarget:this,pointerId:d}),this[n+"targetShape"]=null)}),s||this._fire(i.pointermove,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(t){let i=Ll(t.type),n=Ud(t.type);if(!i)return;this.setPointersPositions(t);let o=this[n+"ClickStartShape"],r=this[n+"ClickEndShape"],s={},a=!1;this._changedPointerPositions.forEach(l=>{let c=fr.getCapturedShape(l.id)||this.getIntersection(l);if(c){if(c.releaseCapture(l.id),s[c._id])return;s[c._id]=!0}let d=l.id,u={evt:t,pointerId:d},h=!1;At.Konva["_"+n+"InDblClickWindow"]?(h=!0,clearTimeout(this[n+"DblTimeout"])):tb.DD.justDragged||(At.Konva["_"+n+"InDblClickWindow"]=!0,clearTimeout(this[n+"DblTimeout"])),this[n+"DblTimeout"]=setTimeout(function(){At.Konva["_"+n+"InDblClickWindow"]=!1},At.Konva.dblClickWindow),c&&c.isListening()?(a=!0,this[n+"ClickEndShape"]=c,c._fireAndBubble(i.pointerup,b({},u)),At.Konva["_"+n+"ListenClick"]&&o&&o===c&&(c._fireAndBubble(i.pointerclick,b({},u)),h&&r&&r===c&&c._fireAndBubble(i.pointerdblclick,b({},u)))):(this[n+"ClickEndShape"]=null,At.Konva["_"+n+"ListenClick"]&&this._fire(i.pointerclick,{evt:t,target:this,currentTarget:this,pointerId:d}),h&&this._fire(i.pointerdblclick,{evt:t,target:this,currentTarget:this,pointerId:d}))}),a||this._fire(i.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),At.Konva["_"+n+"ListenClick"]=!1,t.cancelable&&n!=="touch"&&n!=="pointer"&&t.preventDefault()}_contextmenu(t){this.setPointersPositions(t);let i=this.getIntersection(this.getPointerPosition());i&&i.isListening()?i._fireAndBubble(nb,{evt:t}):this._fire(nb,{evt:t,target:this,currentTarget:this})}_wheel(t){this.setPointersPositions(t);let i=this.getIntersection(this.getPointerPosition());i&&i.isListening()?i._fireAndBubble(ob,{evt:t}):this._fire(ob,{evt:t,target:this,currentTarget:this})}_pointercancel(t){this.setPointersPositions(t);let i=fr.getCapturedShape(t.pointerId)||this.getIntersection(this.getPointerPosition());i&&i._fireAndBubble(Ol,fr.createEvent(t)),fr.releaseCapture(t.pointerId)}_lostpointercapture(t){fr.releaseCapture(t.pointerId)}setPointersPositions(t){let i=this._getContentPosition(),n=null,o=null;t=t||window.event,t.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(t.touches,r=>{this._pointerPositions.push({id:r.identifier,x:(r.clientX-i.left)/i.scaleX,y:(r.clientY-i.top)/i.scaleY})}),Array.prototype.forEach.call(t.changedTouches||t.touches,r=>{this._changedPointerPositions.push({id:r.identifier,x:(r.clientX-i.left)/i.scaleX,y:(r.clientY-i.top)/i.scaleY})})):(n=(t.clientX-i.left)/i.scaleX,o=(t.clientY-i.top)/i.scaleY,this.pointerPos={x:n,y:o},this._pointerPositions=[{x:n,y:o,id:So.Util._getFirstPointerId(t)}],this._changedPointerPositions=[{x:n,y:o,id:So.Util._getFirstPointerId(t)}])}_setPointerPosition(t){So.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};let t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new eb.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new eb.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!At.Konva.isBrowser)return;let t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}cache(){return So.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(t){t.batchDraw()}),this}};xo.Stage=Nl;Nl.prototype.nodeType=FJ;(0,TJ._registerNode)(Nl);kJ.Factory.addGetterSetter(Nl,"container");At.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{xo.stages.forEach(e=>{e.batchDraw()})})});var Vt=me(mr=>{"use strict";Object.defineProperty(mr,"__esModule",{value:!0});mr.Shape=mr.shapes=void 0;var HJ=Ie(),Eo=St(),he=Ae(),IM=Pt(),Ht=Oe(),VJ=Ie(),sb=Zw(),AM="hasShadow",LM="shadowRGBA",OM="patternImage",NM="linearGradient",BM="radialGradient",Eg;function ab(){return Eg||(Eg=Eo.Util.createCanvasElement().getContext("2d"),Eg)}mr.shapes={};function GJ(e){let t=this.attrs.fillRule;t?e.fill(t):e.fill()}function zJ(e){e.stroke()}function WJ(e){let t=this.attrs.fillRule;t?e.fill(t):e.fill()}function UJ(e){e.stroke()}function qJ(){this._clearCache(AM)}function $J(){this._clearCache(LM)}function jJ(){this._clearCache(OM)}function KJ(){this._clearCache(NM)}function YJ(){this._clearCache(BM)}var ne=class extends IM.Node{constructor(t){super(t);let i;for(;i=Eo.Util.getRandomColor(),!(i&&!(i in mr.shapes)););this.colorKey=i,mr.shapes[i]=this}getContext(){return Eo.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return Eo.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(AM,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(OM,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){let i=ab().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(i&&i.setTransform){let n=new Eo.Transform;n.translate(this.fillPatternX(),this.fillPatternY()),n.rotate(HJ.Konva.getAngle(this.fillPatternRotation())),n.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),n.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());let o=n.getMatrix(),r=typeof DOMMatrix>"u"?{a:o[0],b:o[1],c:o[2],d:o[3],e:o[4],f:o[5]}:new DOMMatrix(o);i.setTransform(r)}return i}}_getLinearGradient(){return this._getCache(NM,this.__getLinearGradient)}__getLinearGradient(){let t=this.fillLinearGradientColorStops();if(t){let i=ab(),n=this.fillLinearGradientStartPoint(),o=this.fillLinearGradientEndPoint(),r=i.createLinearGradient(n.x,n.y,o.x,o.y);for(let s=0;s<t.length;s+=2)r.addColorStop(t[s],t[s+1]);return r}}_getRadialGradient(){return this._getCache(BM,this.__getRadialGradient)}__getRadialGradient(){let t=this.fillRadialGradientColorStops();if(t){let i=ab(),n=this.fillRadialGradientStartPoint(),o=this.fillRadialGradientEndPoint(),r=i.createRadialGradient(n.x,n.y,this.fillRadialGradientStartRadius(),o.x,o.y,this.fillRadialGradientEndRadius());for(let s=0;s<t.length;s+=2)r.addColorStop(t[s],t[s+1]);return r}}getShadowRGBA(){return this._getCache(LM,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;let t=Eo.Util.colorToRGBA(this.shadowColor());if(t)return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){let t=this.hitStrokeWidth();return t==="auto"?this.hasStroke():this.strokeEnabled()&&!!t}intersects(t){let i=this.getStage();if(!i)return!1;let n=i.bufferHitCanvas;return n.getContext().clear(),this.drawHit(n,void 0,!0),n.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data[3]>0}destroy(){return IM.Node.prototype.destroy.call(this),delete mr.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(t){var i;if(!((i=this.attrs.perfectDrawEnabled)!==null&&i!==void 0?i:!0))return!1;let o=t||this.hasFill(),r=this.hasStroke(),s=this.getAbsoluteOpacity()!==1;if(o&&r&&s)return!0;let a=this.hasShadow(),l=this.shadowForStrokeEnabled();return!!(o&&r&&a&&l)}setStrokeHitEnabled(t){Eo.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){let t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}}getClientRect(t={}){let i=!1,n=this.getParent();for(;n;){if(n.isCached()){i=!0;break}n=n.getParent()}let o=t.skipTransform,r=t.relativeTo||i&&this.getStage()||void 0,s=this.getSelfRect(),l=!t.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,c=s.width+l,d=s.height+l,u=!t.skipShadow&&this.hasShadow(),h=u?this.shadowOffsetX():0,p=u?this.shadowOffsetY():0,g=c+Math.abs(h),f=d+Math.abs(p),m=u&&this.shadowBlur()||0,v=g+m*2,C=f+m*2,w={width:v,height:C,x:-(l/2+m)+Math.min(h,0)+s.x,y:-(l/2+m)+Math.min(p,0)+s.y};return o?w:this._transformedRect(w,r)}drawScene(t,i,n){let o=this.getLayer(),r=t||o.getCanvas(),s=r.getContext(),a=this._getCanvasCache(),l=this.getSceneFunc(),c=this.hasShadow(),d,u=!1,h=i===this;if(!this.isVisible()&&!h)return this;if(a){s.save();let p=this.getAbsoluteTransform(i).getMatrix();return s.transform(p[0],p[1],p[2],p[3],p[4],p[5]),this._drawCachedSceneCanvas(s),s.restore(),this}if(!l)return this;if(s.save(),this._useBufferCanvas()&&!u){d=this.getStage();let p=n||d.bufferCanvas,g=p.getContext();g.clear(),g.save(),g._applyLineJoin(this);let f=this.getAbsoluteTransform(i).getMatrix();g.transform(f[0],f[1],f[2],f[3],f[4],f[5]),l.call(this,g,this),g.restore();let m=p.pixelRatio;c&&s._applyShadow(this),s._applyOpacity(this),s._applyGlobalCompositeOperation(this),s.drawImage(p._canvas,p.x||0,p.y||0,p.width/m,p.height/m)}else{if(s._applyLineJoin(this),!h){let p=this.getAbsoluteTransform(i).getMatrix();s.transform(p[0],p[1],p[2],p[3],p[4],p[5]),s._applyOpacity(this),s._applyGlobalCompositeOperation(this)}c&&s._applyShadow(this),l.call(this,s,this)}return s.restore(),this}drawHit(t,i,n=!1){if(!this.shouldDrawHit(i,n))return this;let o=this.getLayer(),r=t||o.hitCanvas,s=r&&r.getContext(),a=this.hitFunc()||this.sceneFunc(),l=this._getCanvasCache(),c=l&&l.hit;if(this.colorKey||Eo.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),c){s.save();let u=this.getAbsoluteTransform(i).getMatrix();return s.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedHitCanvas(s),s.restore(),this}if(!a)return this;if(s.save(),s._applyLineJoin(this),!(this===i)){let u=this.getAbsoluteTransform(i).getMatrix();s.transform(u[0],u[1],u[2],u[3],u[4],u[5])}return a.call(this,s,this),s.restore(),this}drawHitFromCache(t=0){let i=this._getCanvasCache(),n=this._getCachedSceneCanvas(),o=i.hit,r=o.getContext(),s=o.getWidth(),a=o.getHeight();r.clear(),r.drawImage(n._canvas,0,0,s,a);try{let l=r.getImageData(0,0,s,a),c=l.data,d=c.length,u=Eo.Util._hexToRgb(this.colorKey);for(let h=0;h<d;h+=4)c[h+3]>t?(c[h]=u.r,c[h+1]=u.g,c[h+2]=u.b,c[h+3]=255):c[h+3]=0;r.putImageData(l,0,0)}catch(l){Eo.Util.error("Unable to draw hit graph from cached scene canvas. "+l.message)}return this}hasPointerCapture(t){return sb.hasPointerCapture(t,this)}setPointerCapture(t){sb.setPointerCapture(t,this)}releaseCapture(t){sb.releaseCapture(t,this)}};mr.Shape=ne;ne.prototype._fillFunc=GJ;ne.prototype._strokeFunc=zJ;ne.prototype._fillFuncHit=WJ;ne.prototype._strokeFuncHit=UJ;ne.prototype._centroid=!1;ne.prototype.nodeType="Shape";(0,VJ._registerNode)(ne);ne.prototype.eventListeners={};ne.prototype.on.call(ne.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",qJ);ne.prototype.on.call(ne.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",$J);ne.prototype.on.call(ne.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",jJ);ne.prototype.on.call(ne.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",KJ);ne.prototype.on.call(ne.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",YJ);he.Factory.addGetterSetter(ne,"stroke",void 0,(0,Ht.getStringOrGradientValidator)());he.Factory.addGetterSetter(ne,"strokeWidth",2,(0,Ht.getNumberValidator)());he.Factory.addGetterSetter(ne,"fillAfterStrokeEnabled",!1);he.Factory.addGetterSetter(ne,"hitStrokeWidth","auto",(0,Ht.getNumberOrAutoValidator)());he.Factory.addGetterSetter(ne,"strokeHitEnabled",!0,(0,Ht.getBooleanValidator)());he.Factory.addGetterSetter(ne,"perfectDrawEnabled",!0,(0,Ht.getBooleanValidator)());he.Factory.addGetterSetter(ne,"shadowForStrokeEnabled",!0,(0,Ht.getBooleanValidator)());he.Factory.addGetterSetter(ne,"lineJoin");he.Factory.addGetterSetter(ne,"lineCap");he.Factory.addGetterSetter(ne,"sceneFunc");he.Factory.addGetterSetter(ne,"hitFunc");he.Factory.addGetterSetter(ne,"dash");he.Factory.addGetterSetter(ne,"dashOffset",0,(0,Ht.getNumberValidator)());he.Factory.addGetterSetter(ne,"shadowColor",void 0,(0,Ht.getStringValidator)());he.Factory.addGetterSetter(ne,"shadowBlur",0,(0,Ht.getNumberValidator)());he.Factory.addGetterSetter(ne,"shadowOpacity",1,(0,Ht.getNumberValidator)());he.Factory.addComponentsGetterSetter(ne,"shadowOffset",["x","y"]);he.Factory.addGetterSetter(ne,"shadowOffsetX",0,(0,Ht.getNumberValidator)());he.Factory.addGetterSetter(ne,"shadowOffsetY",0,(0,Ht.getNumberValidator)());he.Factory.addGetterSetter(ne,"fillPatternImage");he.Factory.addGetterSetter(ne,"fill",void 0,(0,Ht.getStringOrGradientValidator)());he.Factory.addGetterSetter(ne,"fillPatternX",0,(0,Ht.getNumberValidator)());he.Factory.addGetterSetter(ne,"fillPatternY",0,(0,Ht.getNumberValidator)());he.Factory.addGetterSetter(ne,"fillLinearGradientColorStops");he.Factory.addGetterSetter(ne,"strokeLinearGradientColorStops");he.Factory.addGetterSetter(ne,"fillRadialGradientStartRadius",0);he.Factory.addGetterSetter(ne,"fillRadialGradientEndRadius",0);he.Factory.addGetterSetter(ne,"fillRadialGradientColorStops");he.Factory.addGetterSetter(ne,"fillPatternRepeat","repeat");he.Factory.addGetterSetter(ne,"fillEnabled",!0);he.Factory.addGetterSetter(ne,"strokeEnabled",!0);he.Factory.addGetterSetter(ne,"shadowEnabled",!0);he.Factory.addGetterSetter(ne,"dashEnabled",!0);he.Factory.addGetterSetter(ne,"strokeScaleEnabled",!0);he.Factory.addGetterSetter(ne,"fillPriority","color");he.Factory.addComponentsGetterSetter(ne,"fillPatternOffset",["x","y"]);he.Factory.addGetterSetter(ne,"fillPatternOffsetX",0,(0,Ht.getNumberValidator)());he.Factory.addGetterSetter(ne,"fillPatternOffsetY",0,(0,Ht.getNumberValidator)());he.Factory.addComponentsGetterSetter(ne,"fillPatternScale",["x","y"]);he.Factory.addGetterSetter(ne,"fillPatternScaleX",1,(0,Ht.getNumberValidator)());he.Factory.addGetterSetter(ne,"fillPatternScaleY",1,(0,Ht.getNumberValidator)());he.Factory.addComponentsGetterSetter(ne,"fillLinearGradientStartPoint",["x","y"]);he.Factory.addComponentsGetterSetter(ne,"strokeLinearGradientStartPoint",["x","y"]);he.Factory.addGetterSetter(ne,"fillLinearGradientStartPointX",0);he.Factory.addGetterSetter(ne,"strokeLinearGradientStartPointX",0);he.Factory.addGetterSetter(ne,"fillLinearGradientStartPointY",0);he.Factory.addGetterSetter(ne,"strokeLinearGradientStartPointY",0);he.Factory.addComponentsGetterSetter(ne,"fillLinearGradientEndPoint",["x","y"]);he.Factory.addComponentsGetterSetter(ne,"strokeLinearGradientEndPoint",["x","y"]);he.Factory.addGetterSetter(ne,"fillLinearGradientEndPointX",0);he.Factory.addGetterSetter(ne,"strokeLinearGradientEndPointX",0);he.Factory.addGetterSetter(ne,"fillLinearGradientEndPointY",0);he.Factory.addGetterSetter(ne,"strokeLinearGradientEndPointY",0);he.Factory.addComponentsGetterSetter(ne,"fillRadialGradientStartPoint",["x","y"]);he.Factory.addGetterSetter(ne,"fillRadialGradientStartPointX",0);he.Factory.addGetterSetter(ne,"fillRadialGradientStartPointY",0);he.Factory.addComponentsGetterSetter(ne,"fillRadialGradientEndPoint",["x","y"]);he.Factory.addGetterSetter(ne,"fillRadialGradientEndPointX",0);he.Factory.addGetterSetter(ne,"fillRadialGradientEndPointY",0);he.Factory.addGetterSetter(ne,"fillPatternRotation",0);he.Factory.addGetterSetter(ne,"fillRule",void 0,(0,Ht.getStringValidator)());he.Factory.backCompat(ne,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})});var Rg=me(_g=>{"use strict";Object.defineProperty(_g,"__esModule",{value:!0});_g.Layer=void 0;var vr=St(),lb=Bd(),Bl=Pt(),cb=Ae(),HM=Id(),XJ=Oe(),JJ=Vt(),QJ=Ie(),ZJ="#",eQ="beforeDraw",tQ="draw",VM=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],iQ=VM.length,hs=class extends lb.Container{constructor(t){super(t),this.canvas=new HM.SceneCanvas,this.hitCanvas=new HM.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);let i=this.getStage();return i&&i.content&&(i.content.removeChild(this.getNativeCanvasElement()),t<i.children.length-1?i.content.insertBefore(this.getNativeCanvasElement(),i.children[t+1].getCanvas()._canvas):i.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){Bl.Node.prototype.moveToTop.call(this);let t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!Bl.Node.prototype.moveUp.call(this))return!1;let i=this.getStage();return!i||!i.content?!1:(i.content.removeChild(this.getNativeCanvasElement()),this.index<i.children.length-1?i.content.insertBefore(this.getNativeCanvasElement(),i.children[this.index+1].getCanvas()._canvas):i.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(Bl.Node.prototype.moveDown.call(this)){let t=this.getStage();if(t){let i=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),i[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(Bl.Node.prototype.moveToBottom.call(this)){let t=this.getStage();if(t){let i=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),i[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){let t=this.getNativeCanvasElement();return Bl.Node.prototype.remove.call(this),t&&t.parentNode&&vr.Util._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:i}){return this.canvas.setSize(t,i),this.hitCanvas.setSize(t,i),this._setSmoothEnabled(),this}_validateAdd(t){let i=t.getType();i!=="Group"&&i!=="Shape"&&vr.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t=t||{},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),Bl.Node.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){vr.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){vr.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,vr.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;let i=1,n=!1;for(;;){for(let o=0;o<iQ;o++){let r=VM[o],s=this._getIntersection({x:t.x+r.x*i,y:t.y+r.y*i}),a=s.shape;if(a)return a;if(n=!!s.antialiased,!s.antialiased)break}if(n)i+=1;else return null}}_getIntersection(t){let i=this.hitCanvas.pixelRatio,n=this.hitCanvas.context.getImageData(Math.round(t.x*i),Math.round(t.y*i),1,1).data,o=n[3];if(o===255){let r=vr.Util._rgbToHex(n[0],n[1],n[2]),s=JJ.shapes[ZJ+r];return s?{shape:s}:{antialiased:!0}}else if(o>0)return{antialiased:!0};return{}}drawScene(t,i,n){let o=this.getLayer(),r=t||o&&o.getCanvas();return this._fire(eQ,{node:this}),this.clearBeforeDraw()&&r.getContext().clear(),lb.Container.prototype.drawScene.call(this,r,i,n),this._fire(tQ,{node:this}),this}drawHit(t,i){let n=this.getLayer(),o=t||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),lb.Container.prototype.drawHit.call(this,o,i),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){vr.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return vr.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;let t=this.parent;!!this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}destroy(){return vr.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};_g.Layer=hs;hs.prototype.nodeType="Layer";(0,QJ._registerNode)(hs);cb.Factory.addGetterSetter(hs,"imageSmoothingEnabled",!0);cb.Factory.addGetterSetter(hs,"clearBeforeDraw",!0);cb.Factory.addGetterSetter(hs,"hitGraphEnabled",!0,(0,XJ.getBooleanValidator)())});var GM=me(Pg=>{"use strict";Object.defineProperty(Pg,"__esModule",{value:!0});Pg.FastLayer=void 0;var nQ=St(),oQ=Rg(),rQ=Ie(),qd=class extends oQ.Layer{constructor(t){super(t),this.listening(!1),nQ.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};Pg.FastLayer=qd;qd.prototype.nodeType="FastLayer";(0,rQ._registerNode)(qd)});var jd=me(Dg=>{"use strict";Object.defineProperty(Dg,"__esModule",{value:!0});Dg.Group=void 0;var sQ=St(),aQ=Bd(),lQ=Ie(),$d=class extends aQ.Container{_validateAdd(t){let i=t.getType();i!=="Group"&&i!=="Shape"&&sQ.Util.throw("You may only add groups and shapes to groups.")}};Dg.Group=$d;$d.prototype.nodeType="Group";(0,lQ._registerNode)($d)});var kg=me(Mg=>{"use strict";Object.defineProperty(Mg,"__esModule",{value:!0});Mg.Animation=void 0;var db=Ie(),zM=St(),ub=(function(){return db.glob.performance&&db.glob.performance.now?function(){return db.glob.performance.now()}:function(){return new Date().getTime()}})(),Hl=class e{constructor(t,i){this.id=e.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:ub(),frameRate:0},this.func=t,this.setLayers(i)}setLayers(t){let i=[];return t&&(i=Array.isArray(t)?t:[t]),this.layers=i,this}getLayers(){return this.layers}addLayer(t){let i=this.layers,n=i.length;for(let o=0;o<n;o++)if(i[o]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){let i=e.animations,n=i.length;for(let o=0;o<n;o++)if(i[o].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=ub(),e._addAnimation(this),this}stop(){return e._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){let i=t.id,n=this.animations,o=n.length;for(let r=0;r<o;r++)if(n[r].id===i){this.animations.splice(r,1);break}}static _runFrames(){let t={},i=this.animations;for(let n=0;n<i.length;n++){let o=i[n],r=o.layers,s=o.func;o._updateFrameObject(ub());let a=r.length,l;if(s?l=s.call(o,o.frame)!==!1:l=!0,!!l)for(let c=0;c<a;c++){let d=r[c];d._id!==void 0&&(t[d._id]=d)}}for(let n in t)t.hasOwnProperty(n)&&t[n].batchDraw()}static _animationLoop(){let t=e;t.animations.length?(t._runFrames(),zM.Util.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,zM.Util.requestAnimFrame(this._animationLoop))}};Mg.Animation=Hl;Hl.animations=[];Hl.animIdCounter=0;Hl.animRunning=!1});var $M=me(_o=>{"use strict";Object.defineProperty(_o,"__esModule",{value:!0});_o.Easings=_o.Tween=void 0;var Cr=St(),cQ=kg(),dQ=Pt(),uQ=Ie(),hQ={node:1,duration:1,easing:1,onFinish:1,yoyo:1},pQ=1,WM=2,UM=3,qM=["fill","stroke","shadowColor"],gQ=0,hb=class{constructor(t,i,n,o,r,s,a){this.prop=t,this.propFunc=i,this.begin=o,this._pos=o,this.duration=s,this._change=0,this.prevPos=0,this.yoyo=a,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=n,this._change=r-this.begin,this.pause()}fire(t){let i=this[t];i&&i()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t}getPosition(t){return t===void 0&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=WM,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=UM,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){let t=this.getTimer()-this._startTime;this.state===WM?this.setTime(t):this.state===UM&&this.setTime(this.duration-t)}pause(){this.state=pQ,this.fire("onPause")}getTimer(){return new Date().getTime()}},Vl=class e{constructor(t){let i=this,n=t.node,o=n._id,r=t.easing||_o.Easings.Linear,s=!!t.yoyo,a,l;typeof t.duration>"u"?a=.3:t.duration===0?a=.001:a=t.duration,this.node=n,this._id=gQ++;let c=n.getLayer()||(n instanceof uQ.Konva.Stage?n.getLayers():null);c||Cr.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new cQ.Animation(function(){i.tween.onEnterFrame()},c),this.tween=new hb(l,function(d){i._tweenFunc(d)},r,0,1,a*1e3,s),this._addListeners(),e.attrs[o]||(e.attrs[o]={}),e.attrs[o][this._id]||(e.attrs[o][this._id]={}),e.tweens[o]||(e.tweens[o]={});for(l in t)hQ[l]===void 0&&this._addAttr(l,t[l]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset,this.onUpdate=t.onUpdate}_addAttr(t,i){let n=this.node,o=n._id,r,s,a,l,c,d=e.tweens[o][t];d&&delete e.attrs[o][d][t];let u=n.getAttr(t);if(Cr.Util._isArray(i))if(r=[],s=Math.max(i.length,u.length),t==="points"&&i.length!==u.length&&(i.length>u.length?(l=u,u=Cr.Util._prepareArrayForTween(u,i,n.closed())):(a=i,i=Cr.Util._prepareArrayForTween(i,u,n.closed()))),t.indexOf("fill")===0)for(let h=0;h<s;h++)if(h%2===0)r.push(i[h]-u[h]);else{let p=Cr.Util.colorToRGBA(u[h]);c=Cr.Util.colorToRGBA(i[h]),u[h]=p,r.push({r:c.r-p.r,g:c.g-p.g,b:c.b-p.b,a:c.a-p.a})}else for(let h=0;h<s;h++)r.push(i[h]-u[h]);else qM.indexOf(t)!==-1?(u=Cr.Util.colorToRGBA(u),c=Cr.Util.colorToRGBA(i),r={r:c.r-u.r,g:c.g-u.g,b:c.b-u.b,a:c.a-u.a}):r=i-u;e.attrs[o][this._id][t]={start:u,diff:r,end:i,trueEnd:a,trueStart:l},e.tweens[o][t]=this._id}_tweenFunc(t){let i=this.node,n=e.attrs[i._id][this._id],o,r,s,a,l,c,d,u;for(o in n){if(r=n[o],s=r.start,a=r.diff,u=r.end,Cr.Util._isArray(s))if(l=[],d=Math.max(s.length,u.length),o.indexOf("fill")===0)for(c=0;c<d;c++)c%2===0?l.push((s[c]||0)+a[c]*t):l.push("rgba("+Math.round(s[c].r+a[c].r*t)+","+Math.round(s[c].g+a[c].g*t)+","+Math.round(s[c].b+a[c].b*t)+","+(s[c].a+a[c].a*t)+")");else for(c=0;c<d;c++)l.push((s[c]||0)+a[c]*t);else qM.indexOf(o)!==-1?l="rgba("+Math.round(s.r+a.r*t)+","+Math.round(s.g+a.g*t)+","+Math.round(s.b+a.b*t)+","+(s.a+a.a*t)+")":l=s+a*t;i.setAttr(o,l)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{let t=this.node,i=e.attrs[t._id][this._id];i.points&&i.points.trueEnd&&t.setAttr("points",i.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{let t=this.node,i=e.attrs[t._id][this._id];i.points&&i.points.trueStart&&t.points(i.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(t*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){let t=this.node._id,i=this._id,n=e.tweens[t];this.pause(),this.anim&&this.anim.stop();for(let o in n)delete e.tweens[t][o];delete e.attrs[t][i],e.tweens[t]&&(Object.keys(e.tweens[t]).length===0&&delete e.tweens[t],Object.keys(e.attrs[t]).length===0&&delete e.attrs[t])}};_o.Tween=Vl;Vl.attrs={};Vl.tweens={};dQ.Node.prototype.to=function(e){let t=e.onFinish;e.node=this,e.onFinish=function(){this.destroy(),t&&t()},new Vl(e).play()};_o.Easings={BackEaseIn(e,t,i,n){return i*(e/=n)*e*((1.70158+1)*e-1.70158)+t},BackEaseOut(e,t,i,n){return i*((e=e/n-1)*e*((1.70158+1)*e+1.70158)+1)+t},BackEaseInOut(e,t,i,n){let o=1.70158;return(e/=n/2)<1?i/2*(e*e*(((o*=1.525)+1)*e-o))+t:i/2*((e-=2)*e*(((o*=1.525)+1)*e+o)+2)+t},ElasticEaseIn(e,t,i,n,o,r){let s=0;return e===0?t:(e/=n)===1?t+i:(r||(r=n*.3),!o||o<Math.abs(i)?(o=i,s=r/4):s=r/(2*Math.PI)*Math.asin(i/o),-(o*Math.pow(2,10*(e-=1))*Math.sin((e*n-s)*(2*Math.PI)/r))+t)},ElasticEaseOut(e,t,i,n,o,r){let s=0;return e===0?t:(e/=n)===1?t+i:(r||(r=n*.3),!o||o<Math.abs(i)?(o=i,s=r/4):s=r/(2*Math.PI)*Math.asin(i/o),o*Math.pow(2,-10*e)*Math.sin((e*n-s)*(2*Math.PI)/r)+i+t)},ElasticEaseInOut(e,t,i,n,o,r){let s=0;return e===0?t:(e/=n/2)===2?t+i:(r||(r=n*(.3*1.5)),!o||o<Math.abs(i)?(o=i,s=r/4):s=r/(2*Math.PI)*Math.asin(i/o),e<1?-.5*(o*Math.pow(2,10*(e-=1))*Math.sin((e*n-s)*(2*Math.PI)/r))+t:o*Math.pow(2,-10*(e-=1))*Math.sin((e*n-s)*(2*Math.PI)/r)*.5+i+t)},BounceEaseOut(e,t,i,n){return(e/=n)<1/2.75?i*(7.5625*e*e)+t:e<2/2.75?i*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?i*(7.5625*(e-=2.25/2.75)*e+.9375)+t:i*(7.5625*(e-=2.625/2.75)*e+.984375)+t},BounceEaseIn(e,t,i,n){return i-_o.Easings.BounceEaseOut(n-e,0,i,n)+t},BounceEaseInOut(e,t,i,n){return e<n/2?_o.Easings.BounceEaseIn(e*2,0,i,n)*.5+t:_o.Easings.BounceEaseOut(e*2-n,0,i,n)*.5+i*.5+t},EaseIn(e,t,i,n){return i*(e/=n)*e+t},EaseOut(e,t,i,n){return-i*(e/=n)*(e-2)+t},EaseInOut(e,t,i,n){return(e/=n/2)<1?i/2*e*e+t:-i/2*(--e*(e-2)-1)+t},StrongEaseIn(e,t,i,n){return i*(e/=n)*e*e*e*e+t},StrongEaseOut(e,t,i,n){return i*((e=e/n-1)*e*e*e*e+1)+t},StrongEaseInOut(e,t,i,n){return(e/=n/2)<1?i/2*e*e*e*e*e+t:i/2*((e-=2)*e*e*e*e+2)+t},Linear(e,t,i,n){return i*e/n+t}}});var XM=me(Gl=>{"use strict";Object.defineProperty(Gl,"__esModule",{value:!0});Gl.Konva=void 0;var fQ=Ie(),pb=St(),mQ=Pt(),vQ=Bd(),jM=rb(),CQ=Rg(),wQ=GM(),bQ=jd(),yQ=gg(),KM=Vt(),SQ=kg(),YM=$M(),xQ=$w(),EQ=Id();Gl.Konva=pb.Util._assign(fQ.Konva,{Util:pb.Util,Transform:pb.Transform,Node:mQ.Node,Container:vQ.Container,Stage:jM.Stage,stages:jM.stages,Layer:CQ.Layer,FastLayer:wQ.FastLayer,Group:bQ.Group,DD:yQ.DD,Shape:KM.Shape,shapes:KM.shapes,Animation:SQ.Animation,Tween:YM.Tween,Easings:YM.Easings,Context:xQ.Context,Canvas:EQ.Canvas});Gl.default=Gl.Konva});var QM=me(Ig=>{"use strict";Object.defineProperty(Ig,"__esModule",{value:!0});Ig.Arc=void 0;var Tg=Ae(),_Q=Vt(),JM=Ie(),Fg=Oe(),RQ=Ie(),zn=class extends _Q.Shape{_sceneFunc(t){let i=JM.Konva.getAngle(this.angle()),n=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,i,n),t.arc(0,0,this.innerRadius(),i,0,!n),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){let t=this.innerRadius(),i=this.outerRadius(),n=this.clockwise(),o=JM.Konva.getAngle(n?360-this.angle():this.angle()),r=Math.cos(Math.min(o,Math.PI)),s=1,a=Math.sin(Math.min(Math.max(Math.PI,o),3*Math.PI/2)),l=Math.sin(Math.min(o,Math.PI/2)),c=r*(r>0?t:i),d=s*(s>0?i:t),u=a*(a>0?t:i),h=l*(l>0?i:t);return{x:c,y:n?-1*h:u,width:d-c,height:h-u}}};Ig.Arc=zn;zn.prototype._centroid=!0;zn.prototype.className="Arc";zn.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];(0,RQ._registerNode)(zn);Tg.Factory.addGetterSetter(zn,"innerRadius",0,(0,Fg.getNumberValidator)());Tg.Factory.addGetterSetter(zn,"outerRadius",0,(0,Fg.getNumberValidator)());Tg.Factory.addGetterSetter(zn,"angle",0,(0,Fg.getNumberValidator)());Tg.Factory.addGetterSetter(zn,"clockwise",!1,(0,Fg.getBooleanValidator)())});var fb=me(Lg=>{"use strict";Object.defineProperty(Lg,"__esModule",{value:!0});Lg.Line=void 0;var Ag=Ae(),PQ=Ie(),DQ=Vt(),ek=Oe();function gb(e,t,i,n,o,r,s){let a=Math.sqrt(Math.pow(i-e,2)+Math.pow(n-t,2)),l=Math.sqrt(Math.pow(o-i,2)+Math.pow(r-n,2)),c=s*a/(a+l),d=s*l/(a+l),u=i-c*(o-e),h=n-c*(r-t),p=i+d*(o-e),g=n+d*(r-t);return[u,h,p,g]}function ZM(e,t){let i=e.length,n=[];for(let o=2;o<i-2;o+=2){let r=gb(e[o-2],e[o-1],e[o],e[o+1],e[o+2],e[o+3],t);isNaN(r[0])||(n.push(r[0]),n.push(r[1]),n.push(e[o]),n.push(e[o+1]),n.push(r[2]),n.push(r[3]))}return n}var Ro=class extends DQ.Shape{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){let i=this.points(),n=i.length,o=this.tension(),r=this.closed(),s=this.bezier();if(!n)return;let a=0;if(t.beginPath(),t.moveTo(i[0],i[1]),o!==0&&n>4){let l=this.getTensionPoints(),c=l.length;for(a=r?0:4,r||t.quadraticCurveTo(l[0],l[1],l[2],l[3]);a<c-2;)t.bezierCurveTo(l[a++],l[a++],l[a++],l[a++],l[a++],l[a++]);r||t.quadraticCurveTo(l[c-2],l[c-1],i[n-2],i[n-1])}else if(s)for(a=2;a<n;)t.bezierCurveTo(i[a++],i[a++],i[a++],i[a++],i[a++],i[a++]);else for(a=2;a<n;a+=2)t.lineTo(i[a],i[a+1]);r?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():ZM(this.points(),this.tension())}_getTensionPointsClosed(){let t=this.points(),i=t.length,n=this.tension(),o=gb(t[i-2],t[i-1],t[0],t[1],t[2],t[3],n),r=gb(t[i-4],t[i-3],t[i-2],t[i-1],t[0],t[1],n),s=ZM(t,n);return[o[2],o[3]].concat(s).concat([r[0],r[1],t[i-2],t[i-1],r[2],r[3],o[0],o[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:t=this.points();let i=t[0],n=t[0],o=t[1],r=t[1],s,a;for(let l=0;l<t.length/2;l++)s=t[l*2],a=t[l*2+1],i=Math.min(i,s),n=Math.max(n,s),o=Math.min(o,a),r=Math.max(r,a);return{x:i,y:o,width:n-i,height:r-o}}};Lg.Line=Ro;Ro.prototype.className="Line";Ro.prototype._attrsAffectingSize=["points","bezier","tension"];(0,PQ._registerNode)(Ro);Ag.Factory.addGetterSetter(Ro,"closed",!1);Ag.Factory.addGetterSetter(Ro,"bezier",!1);Ag.Factory.addGetterSetter(Ro,"tension",0,(0,ek.getNumberValidator)());Ag.Factory.addGetterSetter(Ro,"points",[],(0,ek.getNumberArrayValidator)())});var tk=me(ci=>{"use strict";Object.defineProperty(ci,"__esModule",{value:!0});ci.t2length=ci.getQuadraticArcLength=ci.getCubicArcLength=ci.binomialCoefficients=ci.cValues=ci.tValues=void 0;ci.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]];ci.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]];ci.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];var MQ=(e,t,i)=>{let n,o,s=i/2;n=0;for(let a=0;a<20;a++)o=s*ci.tValues[20][a]+s,n+=ci.cValues[20][a]*TQ(e,t,o);return s*n};ci.getCubicArcLength=MQ;var kQ=(e,t,i)=>{i===void 0&&(i=1);let n=e[0]-2*e[1]+e[2],o=t[0]-2*t[1]+t[2],r=2*e[1]-2*e[0],s=2*t[1]-2*t[0],a=4*(n*n+o*o),l=4*(n*r+o*s),c=r*r+s*s;if(a===0)return i*Math.sqrt(Math.pow(e[2]-e[0],2)+Math.pow(t[2]-t[0],2));let d=l/(2*a),u=c/a,h=i+d,p=u-d*d,g=h*h+p>0?Math.sqrt(h*h+p):0,f=d*d+p>0?Math.sqrt(d*d+p):0,m=d+Math.sqrt(d*d+p)!==0?p*Math.log(Math.abs((h+g)/(d+f))):0;return Math.sqrt(a)/2*(h*g-d*f+m)};ci.getQuadraticArcLength=kQ;function TQ(e,t,i){let n=mb(1,i,e),o=mb(1,i,t),r=n*n+o*o;return Math.sqrt(r)}var mb=(e,t,i)=>{let n=i.length-1,o,r;if(n===0)return 0;if(e===0){r=0;for(let s=0;s<=n;s++)r+=ci.binomialCoefficients[n][s]*Math.pow(1-t,n-s)*Math.pow(t,s)*i[s];return r}else{o=new Array(n);for(let s=0;s<n;s++)o[s]=n*(i[s+1]-i[s]);return mb(e-1,t,o)}},FQ=(e,t,i)=>{let n=1,o=e/t,r=(e-i(o))/t,s=0;for(;n>.001;){let a=i(o+r),l=Math.abs(e-a)/t;if(l<n)n=l,o+=r;else{let c=i(o-r),d=Math.abs(e-c)/t;d<n?(n=d,o-=r):r/=2}if(s++,s>500)break}return o};ci.t2length=FQ});var Ng=me(Og=>{"use strict";Object.defineProperty(Og,"__esModule",{value:!0});Og.Path=void 0;var IQ=Ae(),AQ=Ie(),LQ=Vt(),zl=tk(),va=class e extends LQ.Shape{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=e.parsePathData(this.data()),this.pathLength=e.getPathLength(this.dataArray)}_sceneFunc(t){let i=this.dataArray;t.beginPath();let n=!1;for(let o=0;o<i.length;o++){let r=i[o].command,s=i[o].points;switch(r){case"L":t.lineTo(s[0],s[1]);break;case"M":t.moveTo(s[0],s[1]);break;case"C":t.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case"Q":t.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case"A":let a=s[0],l=s[1],c=s[2],d=s[3],u=s[4],h=s[5],p=s[6],g=s[7],f=c>d?c:d,m=c>d?1:c/d,v=c>d?d/c:1;t.translate(a,l),t.rotate(p),t.scale(m,v),t.arc(0,0,f,u,u+h,1-g),t.scale(1/m,1/v),t.rotate(-p),t.translate(-a,-l);break;case"z":n=!0,t.closePath();break}}!n&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){let t=[];this.dataArray.forEach(function(l){if(l.command==="A"){let c=l.points[4],d=l.points[5],u=l.points[4]+d,h=Math.PI/180;if(Math.abs(c-u)<h&&(h=Math.abs(c-u)),d<0)for(let p=c-h;p>u;p-=h){let g=e.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],p,0);t.push(g.x,g.y)}else for(let p=c+h;p<u;p+=h){let g=e.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],p,0);t.push(g.x,g.y)}}else if(l.command==="C")for(let c=0;c<=1;c+=.01){let d=e.getPointOnCubicBezier(c,l.start.x,l.start.y,l.points[0],l.points[1],l.points[2],l.points[3],l.points[4],l.points[5]);t.push(d.x,d.y)}else t=t.concat(l.points)});let i=t[0],n=t[0],o=t[1],r=t[1],s,a;for(let l=0;l<t.length/2;l++)s=t[l*2],a=t[l*2+1],isNaN(s)||(i=Math.min(i,s),n=Math.max(n,s)),isNaN(a)||(o=Math.min(o,a),r=Math.max(r,a));return{x:i,y:o,width:n-i,height:r-o}}getLength(){return this.pathLength}getPointAtLength(t){return e.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,i,n,o){return Math.sqrt((n-t)*(n-t)+(o-i)*(o-i))}static getPathLength(t){let i=0;for(let n=0;n<t.length;++n)i+=t[n].pathLength;return i}static getPointAtLengthOfDataArray(t,i){let n,o=0,r=i.length;if(!r)return null;for(;o<r&&t>i[o].pathLength;)t-=i[o].pathLength,++o;if(o===r)return n=i[o-1].points.slice(-2),{x:n[0],y:n[1]};if(t<.01)return i[o].command==="M"?(n=i[o].points.slice(0,2),{x:n[0],y:n[1]}):{x:i[o].start.x,y:i[o].start.y};let s=i[o],a=s.points;switch(s.command){case"L":return e.getPointOnLine(t,s.start.x,s.start.y,a[0],a[1]);case"C":return e.getPointOnCubicBezier((0,zl.t2length)(t,e.getPathLength(i),f=>(0,zl.getCubicArcLength)([s.start.x,a[0],a[2],a[4]],[s.start.y,a[1],a[3],a[5]],f)),s.start.x,s.start.y,a[0],a[1],a[2],a[3],a[4],a[5]);case"Q":return e.getPointOnQuadraticBezier((0,zl.t2length)(t,e.getPathLength(i),f=>(0,zl.getQuadraticArcLength)([s.start.x,a[0],a[2]],[s.start.y,a[1],a[3]],f)),s.start.x,s.start.y,a[0],a[1],a[2],a[3]);case"A":let l=a[0],c=a[1],d=a[2],u=a[3],h=a[5],p=a[6],g=a[4];return g+=h*t/s.pathLength,e.getPointOnEllipticalArc(l,c,d,u,g,p)}return null}static getPointOnLine(t,i,n,o,r,s,a){s=s??i,a=a??n;let l=this.getLineLength(i,n,o,r);if(l<1e-10)return{x:i,y:n};if(o===i)return{x:s,y:a+(r>n?t:-t)};let c=(r-n)/(o-i),d=Math.sqrt(t*t/(1+c*c))*(o<i?-1:1),u=c*d;if(Math.abs(a-n-c*(s-i))<1e-10)return{x:s+d,y:a+u};let h=((s-i)*(o-i)+(a-n)*(r-n))/(l*l),p=i+h*(o-i),g=n+h*(r-n),f=this.getLineLength(s,a,p,g),m=Math.sqrt(t*t-f*f),v=Math.sqrt(m*m/(1+c*c))*(o<i?-1:1),C=c*v;return{x:p+v,y:g+C}}static getPointOnCubicBezier(t,i,n,o,r,s,a,l,c){function d(m){return m*m*m}function u(m){return 3*m*m*(1-m)}function h(m){return 3*m*(1-m)*(1-m)}function p(m){return(1-m)*(1-m)*(1-m)}let g=l*d(t)+s*u(t)+o*h(t)+i*p(t),f=c*d(t)+a*u(t)+r*h(t)+n*p(t);return{x:g,y:f}}static getPointOnQuadraticBezier(t,i,n,o,r,s,a){function l(p){return p*p}function c(p){return 2*p*(1-p)}function d(p){return(1-p)*(1-p)}let u=s*l(t)+o*c(t)+i*d(t),h=a*l(t)+r*c(t)+n*d(t);return{x:u,y:h}}static getPointOnEllipticalArc(t,i,n,o,r,s){let a=Math.cos(s),l=Math.sin(s),c={x:n*Math.cos(r),y:o*Math.sin(r)};return{x:t+(c.x*a-c.y*l),y:i+(c.x*l+c.y*a)}}static parsePathData(t){if(!t)return[];let i=t,n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];i=i.replace(new RegExp(" ","g"),",");for(let u=0;u<n.length;u++)i=i.replace(new RegExp(n[u],"g"),"|"+n[u]);let o=i.split("|"),r=[],s=[],a=0,l=0,c=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,d;for(let u=1;u<o.length;u++){let h=o[u],p=h.charAt(0);for(h=h.slice(1),s.length=0;d=c.exec(h);)s.push(d[0]);let g=[];for(let f=0,m=s.length;f<m;f++){if(s[f]==="00"){g.push(0,0);continue}let v=parseFloat(s[f]);isNaN(v)?g.push(0):g.push(v)}for(;g.length>0&&!isNaN(g[0]);){let f="",m=[],v=a,C=l,w,y,_,R,P,B,q,$,te,Q;switch(p){case"l":a+=g.shift(),l+=g.shift(),f="L",m.push(a,l);break;case"L":a=g.shift(),l=g.shift(),m.push(a,l);break;case"m":let ge=g.shift(),Me=g.shift();if(a+=ge,l+=Me,f="M",r.length>2&&r[r.length-1].command==="z"){for(let De=r.length-2;De>=0;De--)if(r[De].command==="M"){a=r[De].points[0]+ge,l=r[De].points[1]+Me;break}}m.push(a,l),p="l";break;case"M":a=g.shift(),l=g.shift(),f="M",m.push(a,l),p="L";break;case"h":a+=g.shift(),f="L",m.push(a,l);break;case"H":a=g.shift(),f="L",m.push(a,l);break;case"v":l+=g.shift(),f="L",m.push(a,l);break;case"V":l=g.shift(),f="L",m.push(a,l);break;case"C":m.push(g.shift(),g.shift(),g.shift(),g.shift()),a=g.shift(),l=g.shift(),m.push(a,l);break;case"c":m.push(a+g.shift(),l+g.shift(),a+g.shift(),l+g.shift()),a+=g.shift(),l+=g.shift(),f="C",m.push(a,l);break;case"S":y=a,_=l,w=r[r.length-1],w.command==="C"&&(y=a+(a-w.points[2]),_=l+(l-w.points[3])),m.push(y,_,g.shift(),g.shift()),a=g.shift(),l=g.shift(),f="C",m.push(a,l);break;case"s":y=a,_=l,w=r[r.length-1],w.command==="C"&&(y=a+(a-w.points[2]),_=l+(l-w.points[3])),m.push(y,_,a+g.shift(),l+g.shift()),a+=g.shift(),l+=g.shift(),f="C",m.push(a,l);break;case"Q":m.push(g.shift(),g.shift()),a=g.shift(),l=g.shift(),m.push(a,l);break;case"q":m.push(a+g.shift(),l+g.shift()),a+=g.shift(),l+=g.shift(),f="Q",m.push(a,l);break;case"T":y=a,_=l,w=r[r.length-1],w.command==="Q"&&(y=a+(a-w.points[0]),_=l+(l-w.points[1])),a=g.shift(),l=g.shift(),f="Q",m.push(y,_,a,l);break;case"t":y=a,_=l,w=r[r.length-1],w.command==="Q"&&(y=a+(a-w.points[0]),_=l+(l-w.points[1])),a+=g.shift(),l+=g.shift(),f="Q",m.push(y,_,a,l);break;case"A":R=g.shift(),P=g.shift(),B=g.shift(),q=g.shift(),$=g.shift(),te=a,Q=l,a=g.shift(),l=g.shift(),f="A",m=this.convertEndpointToCenterParameterization(te,Q,a,l,q,$,R,P,B);break;case"a":R=g.shift(),P=g.shift(),B=g.shift(),q=g.shift(),$=g.shift(),te=a,Q=l,a+=g.shift(),l+=g.shift(),f="A",m=this.convertEndpointToCenterParameterization(te,Q,a,l,q,$,R,P,B);break}r.push({command:f||p,points:m,start:{x:v,y:C},pathLength:this.calcLength(v,C,f||p,m)})}(p==="z"||p==="Z")&&r.push({command:"z",points:[],start:void 0,pathLength:0})}return r}static calcLength(t,i,n,o){let r,s,a,l,c=e;switch(n){case"L":return c.getLineLength(t,i,o[0],o[1]);case"C":return(0,zl.getCubicArcLength)([t,o[0],o[2],o[4]],[i,o[1],o[3],o[5]],1);case"Q":return(0,zl.getQuadraticArcLength)([t,o[0],o[2]],[i,o[1],o[3]],1);case"A":r=0;let d=o[4],u=o[5],h=o[4]+u,p=Math.PI/180;if(Math.abs(d-h)<p&&(p=Math.abs(d-h)),s=c.getPointOnEllipticalArc(o[0],o[1],o[2],o[3],d,0),u<0)for(l=d-p;l>h;l-=p)a=c.getPointOnEllipticalArc(o[0],o[1],o[2],o[3],l,0),r+=c.getLineLength(s.x,s.y,a.x,a.y),s=a;else for(l=d+p;l<h;l+=p)a=c.getPointOnEllipticalArc(o[0],o[1],o[2],o[3],l,0),r+=c.getLineLength(s.x,s.y,a.x,a.y),s=a;return a=c.getPointOnEllipticalArc(o[0],o[1],o[2],o[3],h,0),r+=c.getLineLength(s.x,s.y,a.x,a.y),r}return 0}static convertEndpointToCenterParameterization(t,i,n,o,r,s,a,l,c){let d=c*(Math.PI/180),u=Math.cos(d)*(t-n)/2+Math.sin(d)*(i-o)/2,h=-1*Math.sin(d)*(t-n)/2+Math.cos(d)*(i-o)/2,p=u*u/(a*a)+h*h/(l*l);p>1&&(a*=Math.sqrt(p),l*=Math.sqrt(p));let g=Math.sqrt((a*a*(l*l)-a*a*(h*h)-l*l*(u*u))/(a*a*(h*h)+l*l*(u*u)));r===s&&(g*=-1),isNaN(g)&&(g=0);let f=g*a*h/l,m=g*-l*u/a,v=(t+n)/2+Math.cos(d)*f-Math.sin(d)*m,C=(i+o)/2+Math.sin(d)*f+Math.cos(d)*m,w=function($){return Math.sqrt($[0]*$[0]+$[1]*$[1])},y=function($,te){return($[0]*te[0]+$[1]*te[1])/(w($)*w(te))},_=function($,te){return($[0]*te[1]<$[1]*te[0]?-1:1)*Math.acos(y($,te))},R=_([1,0],[(u-f)/a,(h-m)/l]),P=[(u-f)/a,(h-m)/l],B=[(-1*u-f)/a,(-1*h-m)/l],q=_(P,B);return y(P,B)<=-1&&(q=Math.PI),y(P,B)>=1&&(q=0),s===0&&q>0&&(q=q-2*Math.PI),s===1&&q<0&&(q=q+2*Math.PI),[v,C,a,l,R,q,d,s]}};Og.Path=va;va.prototype.className="Path";va.prototype._attrsAffectingSize=["data"];(0,AQ._registerNode)(va);IQ.Factory.addGetterSetter(va,"data")});var ok=me(Hg=>{"use strict";Object.defineProperty(Hg,"__esModule",{value:!0});Hg.Arrow=void 0;var Bg=Ae(),OQ=fb(),nk=Oe(),NQ=Ie(),ik=Ng(),wr=class extends OQ.Line{_sceneFunc(t){super._sceneFunc(t);let i=Math.PI*2,n=this.points(),o=n,r=this.tension()!==0&&n.length>4;r&&(o=this.getTensionPoints());let s=this.pointerLength(),a=n.length,l,c;if(r){let h=[o[o.length-4],o[o.length-3],o[o.length-2],o[o.length-1],n[a-2],n[a-1]],p=ik.Path.calcLength(o[o.length-4],o[o.length-3],"C",h),g=ik.Path.getPointOnQuadraticBezier(Math.min(1,1-s/p),h[0],h[1],h[2],h[3],h[4],h[5]);l=n[a-2]-g.x,c=n[a-1]-g.y}else l=n[a-2]-n[a-4],c=n[a-1]-n[a-3];let d=(Math.atan2(c,l)+i)%i,u=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(n[a-2],n[a-1]),t.rotate(d),t.moveTo(0,0),t.lineTo(-s,u/2),t.lineTo(-s,-u/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(n[0],n[1]),r?(l=(o[0]+o[2])/2-n[0],c=(o[1]+o[3])/2-n[1]):(l=n[2]-n[0],c=n[3]-n[1]),t.rotate((Math.atan2(-c,-l)+i)%i),t.moveTo(0,0),t.lineTo(-s,u/2),t.lineTo(-s,-u/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){let i=this.dashEnabled();i&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),i&&(this.attrs.dashEnabled=!0)}getSelfRect(){let t=super.getSelfRect(),i=this.pointerWidth()/2;return{x:t.x,y:t.y-i,width:t.width,height:t.height+i*2}}};Hg.Arrow=wr;wr.prototype.className="Arrow";(0,NQ._registerNode)(wr);Bg.Factory.addGetterSetter(wr,"pointerLength",10,(0,nk.getNumberValidator)());Bg.Factory.addGetterSetter(wr,"pointerWidth",10,(0,nk.getNumberValidator)());Bg.Factory.addGetterSetter(wr,"pointerAtBeginning",!1);Bg.Factory.addGetterSetter(wr,"pointerAtEnding",!0)});var rk=me(Vg=>{"use strict";Object.defineProperty(Vg,"__esModule",{value:!0});Vg.Circle=void 0;var BQ=Ae(),HQ=Vt(),VQ=Oe(),GQ=Ie(),ps=class extends HQ.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}};Vg.Circle=ps;ps.prototype._centroid=!0;ps.prototype.className="Circle";ps.prototype._attrsAffectingSize=["radius"];(0,GQ._registerNode)(ps);BQ.Factory.addGetterSetter(ps,"radius",0,(0,VQ.getNumberValidator)())});var ak=me(Gg=>{"use strict";Object.defineProperty(Gg,"__esModule",{value:!0});Gg.Ellipse=void 0;var vb=Ae(),zQ=Vt(),sk=Oe(),WQ=Ie(),Po=class extends zQ.Shape{_sceneFunc(t){let i=this.radiusX(),n=this.radiusY();t.beginPath(),t.save(),i!==n&&t.scale(1,n/i),t.arc(0,0,i,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}};Gg.Ellipse=Po;Po.prototype.className="Ellipse";Po.prototype._centroid=!0;Po.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,WQ._registerNode)(Po);vb.Factory.addComponentsGetterSetter(Po,"radius",["x","y"]);vb.Factory.addGetterSetter(Po,"radiusX",0,(0,sk.getNumberValidator)());vb.Factory.addGetterSetter(Po,"radiusY",0,(0,sk.getNumberValidator)())});var lk=me(zg=>{"use strict";Object.defineProperty(zg,"__esModule",{value:!0});zg.Image=void 0;var Cb=St(),Ca=Ae(),UQ=Vt(),qQ=Ie(),Kd=Oe(),xn=class e extends UQ.Shape{constructor(t){super(t),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",i=>{this._removeImageLoad(i.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){let t=this.image();t&&t.complete||t&&t.readyState===4||t&&t.addEventListener&&t.addEventListener("load",this._loadListener)}_removeImageLoad(t){t&&t.removeEventListener&&t.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){let t=!!this.cornerRadius(),i=this.hasShadow();return t&&i?!0:super._useBufferCanvas(!0)}_sceneFunc(t){let i=this.getWidth(),n=this.getHeight(),o=this.cornerRadius(),r=this.attrs.image,s;if(r){let a=this.attrs.cropWidth,l=this.attrs.cropHeight;a&&l?s=[r,this.cropX(),this.cropY(),a,l,0,0,i,n]:s=[r,0,0,i,n]}(this.hasFill()||this.hasStroke()||o)&&(t.beginPath(),o?Cb.Util.drawRoundedRectPath(t,i,n,o):t.rect(0,0,i,n),t.closePath(),t.fillStrokeShape(this)),r&&(o&&t.clip(),t.drawImage.apply(t,s))}_hitFunc(t){let i=this.width(),n=this.height(),o=this.cornerRadius();t.beginPath(),o?Cb.Util.drawRoundedRectPath(t,i,n,o):t.rect(0,0,i,n),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,i;return(t=this.attrs.width)!==null&&t!==void 0?t:(i=this.image())===null||i===void 0?void 0:i.width}getHeight(){var t,i;return(t=this.attrs.height)!==null&&t!==void 0?t:(i=this.image())===null||i===void 0?void 0:i.height}static fromURL(t,i,n=null){let o=Cb.Util.createImageElement();o.onload=function(){let r=new e({image:o});i(r)},o.onerror=n,o.crossOrigin="Anonymous",o.src=t}};zg.Image=xn;xn.prototype.className="Image";(0,qQ._registerNode)(xn);Ca.Factory.addGetterSetter(xn,"cornerRadius",0,(0,Kd.getNumberOrArrayOfNumbersValidator)(4));Ca.Factory.addGetterSetter(xn,"image");Ca.Factory.addComponentsGetterSetter(xn,"crop",["x","y","width","height"]);Ca.Factory.addGetterSetter(xn,"cropX",0,(0,Kd.getNumberValidator)());Ca.Factory.addGetterSetter(xn,"cropY",0,(0,Kd.getNumberValidator)());Ca.Factory.addGetterSetter(xn,"cropWidth",0,(0,Kd.getNumberValidator)());Ca.Factory.addGetterSetter(xn,"cropHeight",0,(0,Kd.getNumberValidator)())});var uk=me(Wl=>{"use strict";Object.defineProperty(Wl,"__esModule",{value:!0});Wl.Tag=Wl.Label=void 0;var Wg=Ae(),$Q=Vt(),jQ=jd(),xb=Oe(),ck=Ie(),dk=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],KQ="Change.konva",YQ="none",wb="up",bb="right",yb="down",Sb="left",XQ=dk.length,Yd=class extends jQ.Group{constructor(t){super(t),this.on("add.konva",function(i){this._addListeners(i.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){let i=this,n,o=function(){i._sync()};for(n=0;n<XQ;n++)t.on(dk[n]+KQ,o)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let t=this.getText(),i=this.getTag(),n,o,r,s,a,l,c;if(t&&i){switch(n=t.width(),o=t.height(),r=i.pointerDirection(),s=i.pointerWidth(),c=i.pointerHeight(),a=0,l=0,r){case wb:a=n/2,l=-1*c;break;case bb:a=n+s,l=o/2;break;case yb:a=n/2,l=o+c;break;case Sb:a=-1*s,l=o/2;break}i.setAttrs({x:-1*a,y:-1*l,width:n,height:o}),t.setAttrs({x:-1*a,y:-1*l})}}};Wl.Label=Yd;Yd.prototype.className="Label";(0,ck._registerNode)(Yd);var br=class extends $Q.Shape{_sceneFunc(t){let i=this.width(),n=this.height(),o=this.pointerDirection(),r=this.pointerWidth(),s=this.pointerHeight(),a=this.cornerRadius(),l=0,c=0,d=0,u=0;typeof a=="number"?l=c=d=u=Math.min(a,i/2,n/2):(l=Math.min(a[0]||0,i/2,n/2),c=Math.min(a[1]||0,i/2,n/2),u=Math.min(a[2]||0,i/2,n/2),d=Math.min(a[3]||0,i/2,n/2)),t.beginPath(),t.moveTo(l,0),o===wb&&(t.lineTo((i-r)/2,0),t.lineTo(i/2,-1*s),t.lineTo((i+r)/2,0)),t.lineTo(i-c,0),t.arc(i-c,c,c,Math.PI*3/2,0,!1),o===bb&&(t.lineTo(i,(n-s)/2),t.lineTo(i+r,n/2),t.lineTo(i,(n+s)/2)),t.lineTo(i,n-u),t.arc(i-u,n-u,u,0,Math.PI/2,!1),o===yb&&(t.lineTo((i+r)/2,n),t.lineTo(i/2,n+s),t.lineTo((i-r)/2,n)),t.lineTo(d,n),t.arc(d,n-d,d,Math.PI/2,Math.PI,!1),o===Sb&&(t.lineTo(0,(n+s)/2),t.lineTo(-1*r,n/2),t.lineTo(0,(n-s)/2)),t.lineTo(0,l),t.arc(l,l,l,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){let t=0,i=0,n=this.pointerWidth(),o=this.pointerHeight(),r=this.pointerDirection(),s=this.width(),a=this.height();return r===wb?(i-=o,a+=o):r===yb?a+=o:r===Sb?(t-=n*1.5,s+=n):r===bb&&(s+=n*1.5),{x:t,y:i,width:s,height:a}}};Wl.Tag=br;br.prototype.className="Tag";(0,ck._registerNode)(br);Wg.Factory.addGetterSetter(br,"pointerDirection",YQ);Wg.Factory.addGetterSetter(br,"pointerWidth",0,(0,xb.getNumberValidator)());Wg.Factory.addGetterSetter(br,"pointerHeight",0,(0,xb.getNumberValidator)());Wg.Factory.addGetterSetter(br,"cornerRadius",0,(0,xb.getNumberOrArrayOfNumbersValidator)(4))});var Eb=me(Ug=>{"use strict";Object.defineProperty(Ug,"__esModule",{value:!0});Ug.Rect=void 0;var JQ=Ae(),QQ=Vt(),ZQ=Ie(),eZ=St(),tZ=Oe(),Ul=class extends QQ.Shape{_sceneFunc(t){let i=this.cornerRadius(),n=this.width(),o=this.height();t.beginPath(),i?eZ.Util.drawRoundedRectPath(t,n,o,i):t.rect(0,0,n,o),t.closePath(),t.fillStrokeShape(this)}};Ug.Rect=Ul;Ul.prototype.className="Rect";(0,ZQ._registerNode)(Ul);JQ.Factory.addGetterSetter(Ul,"cornerRadius",0,(0,tZ.getNumberOrArrayOfNumbersValidator)(4))});var gk=me(qg=>{"use strict";Object.defineProperty(qg,"__esModule",{value:!0});qg.RegularPolygon=void 0;var hk=Ae(),iZ=Vt(),pk=Oe(),nZ=Ie(),yr=class extends iZ.Shape{_sceneFunc(t){let i=this._getPoints();t.beginPath(),t.moveTo(i[0].x,i[0].y);for(let n=1;n<i.length;n++)t.lineTo(i[n].x,i[n].y);t.closePath(),t.fillStrokeShape(this)}_getPoints(){let t=this.attrs.sides,i=this.attrs.radius||0,n=[];for(let o=0;o<t;o++)n.push({x:i*Math.sin(o*2*Math.PI/t),y:-1*i*Math.cos(o*2*Math.PI/t)});return n}getSelfRect(){let t=this._getPoints(),i=t[0].x,n=t[0].y,o=t[0].x,r=t[0].y;return t.forEach(s=>{i=Math.min(i,s.x),n=Math.max(n,s.x),o=Math.min(o,s.y),r=Math.max(r,s.y)}),{x:i,y:o,width:n-i,height:r-o}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}};qg.RegularPolygon=yr;yr.prototype.className="RegularPolygon";yr.prototype._centroid=!0;yr.prototype._attrsAffectingSize=["radius"];(0,nZ._registerNode)(yr);hk.Factory.addGetterSetter(yr,"radius",0,(0,pk.getNumberValidator)());hk.Factory.addGetterSetter(yr,"sides",0,(0,pk.getNumberValidator)())});var Ck=me($g=>{"use strict";Object.defineProperty($g,"__esModule",{value:!0});$g.Ring=void 0;var mk=Ae(),oZ=Vt(),vk=Oe(),rZ=Ie(),fk=Math.PI*2,Sr=class extends oZ.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,fk,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),fk,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}};$g.Ring=Sr;Sr.prototype.className="Ring";Sr.prototype._centroid=!0;Sr.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,rZ._registerNode)(Sr);mk.Factory.addGetterSetter(Sr,"innerRadius",0,(0,vk.getNumberValidator)());mk.Factory.addGetterSetter(Sr,"outerRadius",0,(0,vk.getNumberValidator)())});var _b=me(jg=>{"use strict";Object.defineProperty(jg,"__esModule",{value:!0});jg.Sprite=void 0;var wa=Ae(),sZ=Vt(),aZ=kg(),wk=Oe(),lZ=Ie(),En=class extends sZ.Shape{constructor(t){super(t),this._updated=!0,this.anim=new aZ.Animation(()=>{let i=this._updated;return this._updated=!1,i}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){let i=this.animation(),n=this.frameIndex(),o=n*4,r=this.animations()[i],s=this.frameOffsets(),a=r[o+0],l=r[o+1],c=r[o+2],d=r[o+3],u=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,c,d),t.closePath(),t.fillStrokeShape(this)),u)if(s){let h=s[i],p=n*2;t.drawImage(u,a,l,c,d,h[p+0],h[p+1],c,d)}else t.drawImage(u,a,l,c,d,0,0,c,d)}_hitFunc(t){let i=this.animation(),n=this.frameIndex(),o=n*4,r=this.animations()[i],s=this.frameOffsets(),a=r[o+2],l=r[o+3];if(t.beginPath(),s){let c=s[i],d=n*2;t.rect(c[d+0],c[d+1],a,l)}else t.rect(0,0,a,l);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){let t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;let t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){let t=this.frameIndex(),i=this.animation(),n=this.animations(),o=n[i],r=o.length/4;t<r-1?this.frameIndex(t+1):this.frameIndex(0)}};jg.Sprite=En;En.prototype.className="Sprite";(0,lZ._registerNode)(En);wa.Factory.addGetterSetter(En,"animation");wa.Factory.addGetterSetter(En,"animations");wa.Factory.addGetterSetter(En,"frameOffsets");wa.Factory.addGetterSetter(En,"image");wa.Factory.addGetterSetter(En,"frameIndex",0,(0,wk.getNumberValidator)());wa.Factory.addGetterSetter(En,"frameRate",17,(0,wk.getNumberValidator)());wa.Factory.backCompat(En,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"})});var bk=me(Kg=>{"use strict";Object.defineProperty(Kg,"__esModule",{value:!0});Kg.Star=void 0;var Rb=Ae(),cZ=Vt(),Pb=Oe(),dZ=Ie(),Do=class extends cZ.Shape{_sceneFunc(t){let i=this.innerRadius(),n=this.outerRadius(),o=this.numPoints();t.beginPath(),t.moveTo(0,0-n);for(let r=1;r<o*2;r++){let s=r%2===0?n:i,a=s*Math.sin(r*Math.PI/o),l=-1*s*Math.cos(r*Math.PI/o);t.lineTo(a,l)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}};Kg.Star=Do;Do.prototype.className="Star";Do.prototype._centroid=!0;Do.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,dZ._registerNode)(Do);Rb.Factory.addGetterSetter(Do,"numPoints",5,(0,Pb.getNumberValidator)());Rb.Factory.addGetterSetter(Do,"innerRadius",0,(0,Pb.getNumberValidator)());Rb.Factory.addGetterSetter(Do,"outerRadius",0,(0,Pb.getNumberValidator)())});var Fb=me(Jd=>{"use strict";Object.defineProperty(Jd,"__esModule",{value:!0});Jd.Text=void 0;Jd.stringToArray=ba;var Tb=St(),Si=Ae(),uZ=Vt(),Db=Ie(),gs=Oe(),hZ=Ie();function ba(e){return[...e].reduce((t,i,n,o)=>{if(new RegExp("\\p{Emoji}","u").test(i)){let r=o[n+1];r&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(r)?(t.push(i+r),o[n+1]=""):t.push(i)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(i+(o[n+1]||""))?t.push(i+o[n+1]):n>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(i)?t[t.length-1]+=i:i&&t.push(i);return t},[])}var ql="auto",pZ="center",_k="inherit",Xd="justify",gZ="Change.konva",fZ="2d",yk="-",Rk="left",mZ="text",vZ="Text",CZ="top",wZ="bottom",Sk="middle",Pk="normal",bZ="px ",Yg=" ",yZ="right",xk="rtl",SZ="word",xZ="char",Ek="none",Mb="\u2026",Dk=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],EZ=Dk.length;function _Z(e){return e.split(",").map(t=>{t=t.trim();let i=t.indexOf(" ")>=0,n=t.indexOf('"')>=0||t.indexOf("'")>=0;return i&&!n&&(t=`"${t}"`),t}).join(", ")}var Xg;function kb(){return Xg||(Xg=Tb.Util.createCanvasElement().getContext(fZ),Xg)}function RZ(e){e.fillText(this._partialText,this._partialTextX,this._partialTextY)}function PZ(e){e.setAttr("miterLimit",2),e.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function DZ(e){return e=e||{},!e.fillLinearGradientColorStops&&!e.fillRadialGradientColorStops&&!e.fillPatternImage&&(e.fill=e.fill||"black"),e}var wt=class extends uZ.Shape{constructor(t){super(DZ(t)),this._partialTextX=0,this._partialTextY=0;for(let i=0;i<EZ;i++)this.on(Dk[i]+gZ,this._setTextData);this._setTextData()}_sceneFunc(t){let i=this.textArr,n=i.length;if(!this.text())return;let o=this.padding(),r=this.fontSize(),s=this.lineHeight()*r,a=this.verticalAlign(),l=this.direction(),c=0,d=this.align(),u=this.getWidth(),h=this.letterSpacing(),p=this.fill(),g=this.textDecoration(),f=g.indexOf("underline")!==-1,m=g.indexOf("line-through")!==-1,v;l=l===_k?t.direction:l;let C=s/2,w=Sk;if(Db.Konva._fixTextRendering){let y=this.measureSize("M");w="alphabetic",C=(y.fontBoundingBoxAscent-y.fontBoundingBoxDescent)/2+s/2}for(l===xk&&t.setAttr("direction",l),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",w),t.setAttr("textAlign",Rk),a===Sk?c=(this.getHeight()-n*s-o*2)/2:a===wZ&&(c=this.getHeight()-n*s-o*2),t.translate(o,c+o),v=0;v<n;v++){let y=0,_=0,R=i[v],P=R.text,B=R.width,q=R.lastInParagraph;if(t.save(),d===yZ?y+=u-B-o*2:d===pZ&&(y+=(u-B-o*2)/2),f){t.save(),t.beginPath();let $=Db.Konva._fixTextRendering?Math.round(r/4):Math.round(r/2),te=y,Q=C+_+$;t.moveTo(te,Q);let ge=d===Xd&&!q?u-o*2:B;t.lineTo(te+Math.round(ge),Q),t.lineWidth=r/15;let Me=this._getLinearGradient();t.strokeStyle=Me||p,t.stroke(),t.restore()}if(m){t.save(),t.beginPath();let $=Db.Konva._fixTextRendering?-Math.round(r/4):0;t.moveTo(y,C+_+$);let te=d===Xd&&!q?u-o*2:B;t.lineTo(y+Math.round(te),C+_+$),t.lineWidth=r/15;let Q=this._getLinearGradient();t.strokeStyle=Q||p,t.stroke(),t.restore()}if(l!==xk&&(h!==0||d===Xd)){let $=P.split(" ").length-1,te=ba(P);for(let Q=0;Q<te.length;Q++){let ge=te[Q];ge===" "&&!q&&d===Xd&&(y+=(u-o*2-B)/$),this._partialTextX=y,this._partialTextY=C+_,this._partialText=ge,t.fillStrokeShape(this),y+=this.measureSize(ge).width+h}}else h!==0&&t.setAttr("letterSpacing",`${h}px`),this._partialTextX=y,this._partialTextY=C+_,this._partialText=P,t.fillStrokeShape(this);t.restore(),n>1&&(C+=s)}}_hitFunc(t){let i=this.getWidth(),n=this.getHeight();t.beginPath(),t.rect(0,0,i,n),t.closePath(),t.fillStrokeShape(this)}setText(t){let i=Tb.Util._isString(t)?t:t==null?"":t+"";return this._setAttr(mZ,i),this}getWidth(){return this.attrs.width===ql||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===ql||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return Tb.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var i,n,o,r,s,a,l,c,d,u,h;let p=kb(),g=this.fontSize(),f;p.save(),p.font=this._getContextFont(),f=p.measureText(t),p.restore();let m=g/100;return{actualBoundingBoxAscent:(i=f.actualBoundingBoxAscent)!==null&&i!==void 0?i:71.58203125*m,actualBoundingBoxDescent:(n=f.actualBoundingBoxDescent)!==null&&n!==void 0?n:0,actualBoundingBoxLeft:(o=f.actualBoundingBoxLeft)!==null&&o!==void 0?o:-7.421875*m,actualBoundingBoxRight:(r=f.actualBoundingBoxRight)!==null&&r!==void 0?r:75.732421875*m,alphabeticBaseline:(s=f.alphabeticBaseline)!==null&&s!==void 0?s:0,emHeightAscent:(a=f.emHeightAscent)!==null&&a!==void 0?a:100*m,emHeightDescent:(l=f.emHeightDescent)!==null&&l!==void 0?l:-20*m,fontBoundingBoxAscent:(c=f.fontBoundingBoxAscent)!==null&&c!==void 0?c:91*m,fontBoundingBoxDescent:(d=f.fontBoundingBoxDescent)!==null&&d!==void 0?d:21*m,hangingBaseline:(u=f.hangingBaseline)!==null&&u!==void 0?u:72.80000305175781*m,ideographicBaseline:(h=f.ideographicBaseline)!==null&&h!==void 0?h:-21*m,width:f.width,height:g}}_getContextFont(){return this.fontStyle()+Yg+this.fontVariant()+Yg+(this.fontSize()+bZ)+_Z(this.fontFamily())}_addTextLine(t){this.align()===Xd&&(t=t.trim());let n=this._getTextWidth(t);return this.textArr.push({text:t,width:n,lastInParagraph:!1})}_getTextWidth(t){let i=this.letterSpacing(),n=t.length;return kb().measureText(t).width+i*n}_setTextData(){let t=this.text().split(`
`),i=+this.fontSize(),n=0,o=this.lineHeight()*i,r=this.attrs.width,s=this.attrs.height,a=r!==ql&&r!==void 0,l=s!==ql&&s!==void 0,c=this.padding(),d=r-c*2,u=s-c*2,h=0,p=this.wrap(),g=p!==Ek,f=p!==xZ&&g,m=this.ellipsis();this.textArr=[],kb().font=this._getContextFont();let v=m?this._getTextWidth(Mb):0;for(let C=0,w=t.length;C<w;++C){let y=t[C],_=this._getTextWidth(y);if(a&&_>d)for(;y.length>0;){let R=0,P=ba(y).length,B="",q=0;for(;R<P;){let $=R+P>>>1,te=ba(y),Q=te.slice(0,$+1).join(""),ge=this._getTextWidth(Q);(m&&l&&h+o>u?ge+v:ge)<=d?(R=$+1,B=Q,q=ge):P=$}if(B){if(f){let Q=ba(y),ge=ba(B),Me=Q[ge.length],De=Me===Yg||Me===yk,xt;if(De&&q<=d)xt=ge.length;else{let Ui=ge.lastIndexOf(Yg),He=ge.lastIndexOf(yk);xt=Math.max(Ui,He)+1}xt>0&&(R=xt,B=Q.slice(0,R).join(""),q=this._getTextWidth(B))}if(B=B.trimRight(),this._addTextLine(B),n=Math.max(n,q),h+=o,this._shouldHandleEllipsis(h)){this._tryToAddEllipsisToLastLine();break}if(y=ba(y).slice(R).join("").trimLeft(),y.length>0&&(_=this._getTextWidth(y),_<=d)){this._addTextLine(y),h+=o,n=Math.max(n,_);break}}else break}else this._addTextLine(y),h+=o,n=Math.max(n,_),this._shouldHandleEllipsis(h)&&C<w-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),l&&h+o>u)break}this.textHeight=i,this.textWidth=n}_shouldHandleEllipsis(t){let i=+this.fontSize(),n=this.lineHeight()*i,o=this.attrs.height,r=o!==ql&&o!==void 0,s=this.padding(),a=o-s*2;return!(this.wrap()!==Ek)||r&&t+n>a}_tryToAddEllipsisToLastLine(){let t=this.attrs.width,i=t!==ql&&t!==void 0,n=this.padding(),o=t-n*2,r=this.ellipsis(),s=this.textArr[this.textArr.length-1];!s||!r||(i&&(this._getTextWidth(s.text+Mb)<o||(s.text=s.text.slice(0,s.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(s.text+Mb))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){let t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,i=this.hasShadow();return t&&i?!0:super._useBufferCanvas()}};Jd.Text=wt;wt.prototype._fillFunc=RZ;wt.prototype._strokeFunc=PZ;wt.prototype.className=vZ;wt.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,hZ._registerNode)(wt);Si.Factory.overWriteSetter(wt,"width",(0,gs.getNumberOrAutoValidator)());Si.Factory.overWriteSetter(wt,"height",(0,gs.getNumberOrAutoValidator)());Si.Factory.addGetterSetter(wt,"direction",_k);Si.Factory.addGetterSetter(wt,"fontFamily","Arial");Si.Factory.addGetterSetter(wt,"fontSize",12,(0,gs.getNumberValidator)());Si.Factory.addGetterSetter(wt,"fontStyle",Pk);Si.Factory.addGetterSetter(wt,"fontVariant",Pk);Si.Factory.addGetterSetter(wt,"padding",0,(0,gs.getNumberValidator)());Si.Factory.addGetterSetter(wt,"align",Rk);Si.Factory.addGetterSetter(wt,"verticalAlign",CZ);Si.Factory.addGetterSetter(wt,"lineHeight",1,(0,gs.getNumberValidator)());Si.Factory.addGetterSetter(wt,"wrap",SZ);Si.Factory.addGetterSetter(wt,"ellipsis",!1,(0,gs.getBooleanValidator)());Si.Factory.addGetterSetter(wt,"letterSpacing",0,(0,gs.getNumberValidator)());Si.Factory.addGetterSetter(wt,"text","",(0,gs.getStringValidator)());Si.Factory.addGetterSetter(wt,"textDecoration","")});var Ik=me(Jg=>{"use strict";Object.defineProperty(Jg,"__esModule",{value:!0});Jg.TextPath=void 0;var Ib=St(),Wn=Ae(),MZ=Vt(),Qd=Ng(),Ab=Fb(),Mk=Oe(),kZ=Ie(),TZ="",kk="normal";function Tk(e){e.fillText(this.partialText,0,0)}function Fk(e){e.strokeText(this.partialText,0,0)}var Lt=class extends MZ.Shape{constructor(t){super(t),this.dummyCanvas=Ib.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return Qd.Path.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;let i=this.pathLength;return t-1>i?null:Qd.Path.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=Qd.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();let i=this.textDecoration(),n=this.fill(),o=this.fontSize(),r=this.glyphInfo;i==="underline"&&t.beginPath();for(let s=0;s<r.length;s++){t.save();let a=r[s].p0;t.translate(a.x,a.y),t.rotate(r[s].rotation),this.partialText=r[s].text,t.fillStrokeShape(this),i==="underline"&&(s===0&&t.moveTo(0,o/2+1),t.lineTo(o,o/2+1)),t.restore()}i==="underline"&&(t.strokeStyle=n,t.lineWidth=o/20,t.stroke()),t.restore()}_hitFunc(t){t.beginPath();let i=this.glyphInfo;if(i.length>=1){let n=i[0].p0;t.moveTo(n.x,n.y)}for(let n=0;n<i.length;n++){let o=i[n].p1;t.lineTo(o.x,o.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return Ib.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return Ab.Text.prototype.setText.call(this,t)}_getContextFont(){return Ab.Text.prototype._getContextFont.call(this)}_getTextSize(t){let n=this.dummyCanvas.getContext("2d");n.save(),n.font=this._getContextFont();let o=n.measureText(t);return n.restore(),{width:o.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){let{width:t,height:i}=this._getTextSize(this.attrs.text);if(this.textWidth=t,this.textHeight=i,this.glyphInfo=[],!this.attrs.data)return null;let n=this.letterSpacing(),o=this.align(),r=this.kerningFunc(),s=Math.max(this.textWidth+((this.attrs.text||"").length-1)*n,0),a=0;o==="center"&&(a=Math.max(0,this.pathLength/2-s/2)),o==="right"&&(a=Math.max(0,this.pathLength-s));let l=(0,Ab.stringToArray)(this.text()),c=a;for(let d=0;d<l.length;d++){let u=this._getPointAtLength(c);if(!u)return;let h=this._getTextSize(l[d]).width+n;if(l[d]===" "&&o==="justify"){let C=this.text().split(" ").length-1;h+=(this.pathLength-s)/C}let p=this._getPointAtLength(c+h);if(!p)return;let g=Qd.Path.getLineLength(u.x,u.y,p.x,p.y),f=0;if(r)try{f=r(l[d-1],l[d])*this.fontSize()}catch{f=0}u.x+=f,p.x+=f,this.textWidth+=f;let m=Qd.Path.getPointOnLine(f+g/2,u.x,u.y,p.x,p.y),v=Math.atan2(p.y-u.y,p.x-u.x);this.glyphInfo.push({transposeX:m.x,transposeY:m.y,text:l[d],rotation:v,p0:u,p1:p}),c+=h}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};let t=[];this.glyphInfo.forEach(function(c){t.push(c.p0.x),t.push(c.p0.y),t.push(c.p1.x),t.push(c.p1.y)});let i=t[0]||0,n=t[0]||0,o=t[1]||0,r=t[1]||0,s,a;for(let c=0;c<t.length/2;c++)s=t[c*2],a=t[c*2+1],i=Math.min(i,s),n=Math.max(n,s),o=Math.min(o,a),r=Math.max(r,a);let l=this.fontSize();return{x:i-l/2,y:o-l/2,width:n-i+l,height:r-o+l}}destroy(){return Ib.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};Jg.TextPath=Lt;Lt.prototype._fillFunc=Tk;Lt.prototype._strokeFunc=Fk;Lt.prototype._fillFuncHit=Tk;Lt.prototype._strokeFuncHit=Fk;Lt.prototype.className="TextPath";Lt.prototype._attrsAffectingSize=["text","fontSize","data"];(0,kZ._registerNode)(Lt);Wn.Factory.addGetterSetter(Lt,"data");Wn.Factory.addGetterSetter(Lt,"fontFamily","Arial");Wn.Factory.addGetterSetter(Lt,"fontSize",12,(0,Mk.getNumberValidator)());Wn.Factory.addGetterSetter(Lt,"fontStyle",kk);Wn.Factory.addGetterSetter(Lt,"align","left");Wn.Factory.addGetterSetter(Lt,"letterSpacing",0,(0,Mk.getNumberValidator)());Wn.Factory.addGetterSetter(Lt,"textBaseline","middle");Wn.Factory.addGetterSetter(Lt,"fontVariant",kk);Wn.Factory.addGetterSetter(Lt,"text",TZ);Wn.Factory.addGetterSetter(Lt,"textDecoration","");Wn.Factory.addGetterSetter(Lt,"kerningFunc",void 0)});var Vk=me(Zg=>{"use strict";Object.defineProperty(Zg,"__esModule",{value:!0});Zg.Transformer=void 0;var st=St(),Ke=Ae(),Ak=Pt(),FZ=Vt(),IZ=Eb(),Lk=jd(),Un=Ie(),fs=Oe(),AZ=Ie(),Bk="tr-konva",LZ=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(e=>e+`.${Bk}`).join(" "),Ok="nodesRect",OZ=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],NZ={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},BZ="ontouchstart"in Un.Konva._global;function HZ(e,t,i){if(e==="rotater")return i;t+=st.Util.degToRad(NZ[e]||0);let n=(st.Util.radToDeg(t)%360+360)%360;return st.Util._inRange(n,315+22.5,360)||st.Util._inRange(n,0,22.5)?"ns-resize":st.Util._inRange(n,45-22.5,45+22.5)?"nesw-resize":st.Util._inRange(n,90-22.5,90+22.5)?"ew-resize":st.Util._inRange(n,135-22.5,135+22.5)?"nwse-resize":st.Util._inRange(n,180-22.5,180+22.5)?"ns-resize":st.Util._inRange(n,225-22.5,225+22.5)?"nesw-resize":st.Util._inRange(n,270-22.5,270+22.5)?"ew-resize":st.Util._inRange(n,315-22.5,315+22.5)?"nwse-resize":(st.Util.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}var Qg=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],Nk=1e8;function VZ(e){return{x:e.x+e.width/2*Math.cos(e.rotation)+e.height/2*Math.sin(-e.rotation),y:e.y+e.height/2*Math.cos(e.rotation)+e.width/2*Math.sin(e.rotation)}}function Hk(e,t,i){let n=i.x+(e.x-i.x)*Math.cos(t)-(e.y-i.y)*Math.sin(t),o=i.y+(e.x-i.x)*Math.sin(t)+(e.y-i.y)*Math.cos(t);return z(b({},e),{rotation:e.rotation+t,x:n,y:o})}function GZ(e,t){let i=VZ(e);return Hk(e,t,i)}function zZ(e,t,i){let n=t;for(let o=0;o<e.length;o++){let r=Un.Konva.getAngle(e[o]),s=Math.abs(r-t)%(Math.PI*2);Math.min(s,Math.PI*2-s)<i&&(n=r)}return n}var Lb=0,Ne=class extends Lk.Group{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(LZ,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return st.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return Bk+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();let i=t.filter(o=>o.isAncestorOf(this)?(st.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=t=i,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(o=>{let r=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(o._attrsAffectingSize.length){let s=o._attrsAffectingSize.map(a=>a+"Change."+this._getEventNamespace()).join(" ");o.on(s,r)}o.on(OZ.map(s=>s+`.${this._getEventNamespace()}`).join(" "),r),o.on(`absoluteTransformChange.${this._getEventNamespace()}`,r),this._proxyDrag(o)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let i;t.on(`dragstart.${this._getEventNamespace()}`,n=>{i=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(n,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,n=>{if(!i)return;let o=t.getAbsolutePosition(),r=o.x-i.x,s=o.y-i.y;this.nodes().forEach(a=>{if(a===t||a.isDragging())return;let l=a.getAbsolutePosition();a.setAbsolutePosition({x:l.x+r,y:l.y+s}),a.startDrag(n)}),i=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(Ok),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(Ok,this.__getNodeRect)}__getNodeShape(t,i=this.rotation(),n){let o=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),r=t.getAbsoluteScale(n),s=t.getAbsolutePosition(n),a=o.x*r.x-t.offsetX()*r.x,l=o.y*r.y-t.offsetY()*r.y,c=(Un.Konva.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),d={x:s.x+a*Math.cos(c)+l*Math.sin(-c),y:s.y+l*Math.cos(c)+a*Math.sin(c),width:o.width*r.x,height:o.height*r.y,rotation:c};return Hk(d,-Un.Konva.getAngle(i),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-Nk,y:-Nk,width:0,height:0,rotation:0};let i=[];this.nodes().map(c=>{let d=c.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),u=[{x:d.x,y:d.y},{x:d.x+d.width,y:d.y},{x:d.x+d.width,y:d.y+d.height},{x:d.x,y:d.y+d.height}],h=c.getAbsoluteTransform();u.forEach(function(p){let g=h.point(p);i.push(g)})});let n=new st.Transform;n.rotate(-Un.Konva.getAngle(this.rotation()));let o=1/0,r=1/0,s=-1/0,a=-1/0;i.forEach(function(c){let d=n.point(c);o===void 0&&(o=s=d.x,r=a=d.y),o=Math.min(o,d.x),r=Math.min(r,d.y),s=Math.max(s,d.x),a=Math.max(a,d.y)}),n.invert();let l=n.point({x:o,y:r});return{x:l.x,y:l.y,width:s-o,height:a-r,rotation:Un.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Qg.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){let i=new IZ.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:BZ?10:"auto"}),n=this;i.on("mousedown touchstart",function(o){n._handleMouseDown(o)}),i.on("dragstart",o=>{i.stopDrag(),o.cancelBubble=!0}),i.on("dragend",o=>{o.cancelBubble=!0}),i.on("mouseenter",()=>{let o=Un.Konva.getAngle(this.rotation()),r=this.rotateAnchorCursor(),s=HZ(t,o,r);i.getStage().content&&(i.getStage().content.style.cursor=s),this._cursorChange=!0}),i.on("mouseout",()=>{i.getStage().content&&(i.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(i)}_createBack(){let t=new FZ.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(i,n){let o=n.getParent(),r=o.padding();i.beginPath(),i.rect(-r,-r,n.width()+r*2,n.height()+r*2),i.moveTo(n.width()/2,-r),o.rotateEnabled()&&o.rotateLineVisible()&&i.lineTo(n.width()/2,-o.rotateAnchorOffset()*st.Util._sign(n.height())-r),i.fillStrokeShape(n)},hitFunc:(i,n)=>{if(!this.shouldOverdrawWholeArea())return;let o=this.padding();i.beginPath(),i.rect(-o,-o,n.width()+o*2,n.height()+o*2),i.fillStrokeShape(n)}});this.add(t),this._proxyDrag(t),t.on("dragstart",i=>{i.cancelBubble=!0}),t.on("dragmove",i=>{i.cancelBubble=!0}),t.on("dragend",i=>{i.cancelBubble=!0}),this.on("dragmove",i=>{this.update()})}_handleMouseDown(t){if(this._transforming)return;this._movingAnchorName=t.target.name().split(" ")[0];let i=this._getNodeRect(),n=i.width,o=i.height,r=Math.sqrt(Math.pow(n,2)+Math.pow(o,2));this.sin=Math.abs(o/r),this.cos=Math.abs(n/r),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;let s=t.target.getAbsolutePosition(),a=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:a.x-s.x,y:a.y-s.y},Lb++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(l=>{l._fire("transformstart",{evt:t.evt,target:l})})}_handleMouseMove(t){let i,n,o,r=this.findOne("."+this._movingAnchorName),s=r.getStage();s.setPointersPositions(t);let a=s.getPointerPosition(),l={x:a.x-this._anchorDragOffset.x,y:a.y-this._anchorDragOffset.y},c=r.getAbsolutePosition();this.anchorDragBoundFunc()&&(l=this.anchorDragBoundFunc()(c,l,t)),r.setAbsolutePosition(l);let d=r.getAbsolutePosition();if(c.x===d.x&&c.y===d.y)return;if(this._movingAnchorName==="rotater"){let C=this._getNodeRect();i=r.x()-C.width/2,n=-r.y()+C.height/2;let w=Math.atan2(-n,i)+Math.PI/2;C.height<0&&(w-=Math.PI);let _=Un.Konva.getAngle(this.rotation())+w,R=Un.Konva.getAngle(this.rotationSnapTolerance()),B=zZ(this.rotationSnaps(),_,R)-C.rotation,q=GZ(C,B);this._fitNodesInto(q,t);return}let u=this.shiftBehavior(),h;u==="inverted"?h=this.keepRatio()&&!t.shiftKey:u==="none"?h=this.keepRatio():h=this.keepRatio()||t.shiftKey;let p=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(h){let C=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};o=Math.sqrt(Math.pow(C.x-r.x(),2)+Math.pow(C.y-r.y(),2));let w=this.findOne(".top-left").x()>C.x?-1:1,y=this.findOne(".top-left").y()>C.y?-1:1;i=o*this.cos*w,n=o*this.sin*y,this.findOne(".top-left").x(C.x-i),this.findOne(".top-left").y(C.y-n)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(r.y());else if(this._movingAnchorName==="top-right"){if(h){let C=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};o=Math.sqrt(Math.pow(r.x()-C.x,2)+Math.pow(C.y-r.y(),2));let w=this.findOne(".top-right").x()<C.x?-1:1,y=this.findOne(".top-right").y()>C.y?-1:1;i=o*this.cos*w,n=o*this.sin*y,this.findOne(".top-right").x(C.x+i),this.findOne(".top-right").y(C.y-n)}var g=r.position();this.findOne(".top-left").y(g.y),this.findOne(".bottom-right").x(g.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(r.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(r.x());else if(this._movingAnchorName==="bottom-left"){if(h){let C=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};o=Math.sqrt(Math.pow(C.x-r.x(),2)+Math.pow(r.y()-C.y,2));let w=C.x<r.x()?-1:1,y=r.y()<C.y?-1:1;i=o*this.cos*w,n=o*this.sin*y,r.x(C.x-i),r.y(C.y+n)}g=r.position(),this.findOne(".top-left").x(g.x),this.findOne(".bottom-right").y(g.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(r.y());else if(this._movingAnchorName==="bottom-right"){if(h){let C=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};o=Math.sqrt(Math.pow(r.x()-C.x,2)+Math.pow(r.y()-C.y,2));let w=this.findOne(".bottom-right").x()<C.x?-1:1,y=this.findOne(".bottom-right").y()<C.y?-1:1;i=o*this.cos*w,n=o*this.sin*y,this.findOne(".bottom-right").x(C.x+i),this.findOne(".bottom-right").y(C.y+n)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(p=this.centeredScaling()||t.altKey,p){let C=this.findOne(".top-left"),w=this.findOne(".bottom-right"),y=C.x(),_=C.y(),R=this.getWidth()-w.x(),P=this.getHeight()-w.y();w.move({x:-y,y:-_}),C.move({x:R,y:P})}let f=this.findOne(".top-left").getAbsolutePosition();i=f.x,n=f.y;let m=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),v=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:i,y:n,width:m,height:v,rotation:Un.Konva.getAngle(this.rotation())},t)}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var i;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));let n=this.getNode();Lb--,this._fire("transformend",{evt:t,target:n}),(i=this.getLayer())===null||i===void 0||i.batchDraw(),n&&this._nodes.forEach(o=>{var r;o._fire("transformend",{evt:t,target:o}),(r=o.getLayer())===null||r===void 0||r.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(t,i){let n=this._getNodeRect(),o=1;if(st.Util._inRange(t.width,-this.padding()*2-o,o)){this.update();return}if(st.Util._inRange(t.height,-this.padding()*2-o,o)){this.update();return}let r=new st.Transform;if(r.rotate(Un.Konva.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){let h=r.point({x:-this.padding()*2,y:0});t.x+=h.x,t.y+=h.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){let h=r.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){let h=r.point({x:0,y:-this.padding()*2});t.x+=h.x,t.y+=h.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){let h=r.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){let h=this.boundBoxFunc()(n,t);h?t=h:st.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}let s=1e7,a=new st.Transform;a.translate(n.x,n.y),a.rotate(n.rotation),a.scale(n.width/s,n.height/s);let l=new st.Transform,c=t.width/s,d=t.height/s;this.flipEnabled()===!1?(l.translate(t.x,t.y),l.rotate(t.rotation),l.translate(t.width<0?t.width:0,t.height<0?t.height:0),l.scale(Math.abs(c),Math.abs(d))):(l.translate(t.x,t.y),l.rotate(t.rotation),l.scale(c,d));let u=l.multiply(a.invert());this._nodes.forEach(h=>{var p;let g=h.getParent().getAbsoluteTransform(),f=h.getTransform().copy();f.translate(h.offsetX(),h.offsetY());let m=new st.Transform;m.multiply(g.copy().invert()).multiply(u).multiply(g).multiply(f);let v=m.decompose();h.setAttrs(v),(p=h.getLayer())===null||p===void 0||p.batchDraw()}),this.rotation(st.Util._getRotation(t.rotation)),this._nodes.forEach(h=>{this._fire("transform",{evt:i,target:h}),h._fire("transform",{evt:i,target:h})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,i){this.findOne(t).setAttrs(i)}update(){var t;let i=this._getNodeRect();this.rotation(st.Util._getRotation(i.rotation));let n=i.width,o=i.height,r=this.enabledAnchors(),s=this.resizeEnabled(),a=this.padding(),l=this.anchorSize(),c=this.find("._anchor");c.forEach(u=>{u.setAttrs({width:l,height:l,offsetX:l/2,offsetY:l/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:l/2+a,offsetY:l/2+a,visible:s&&r.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:n/2,y:0,offsetY:l/2+a,visible:s&&r.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:n,y:0,offsetX:l/2-a,offsetY:l/2+a,visible:s&&r.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:o/2,offsetX:l/2+a,visible:s&&r.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:n,y:o/2,offsetX:l/2-a,visible:s&&r.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:o,offsetX:l/2+a,offsetY:l/2-a,visible:s&&r.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:n/2,y:o,offsetY:l/2-a,visible:s&&r.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:n,y:o,offsetX:l/2-a,offsetY:l/2-a,visible:s&&r.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:n/2,y:-this.rotateAnchorOffset()*st.Util._sign(o)-a,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:n,height:o,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});let d=this.anchorStyleFunc();d&&c.forEach(u=>{d(u)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();let t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),Lk.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return Ak.Node.prototype.toObject.call(this)}clone(t){return Ak.Node.prototype.clone.call(this,t)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};Zg.Transformer=Ne;Ne.isTransforming=()=>Lb>0;function WZ(e){return e instanceof Array||st.Util.warn("enabledAnchors value should be an array"),e instanceof Array&&e.forEach(function(t){Qg.indexOf(t)===-1&&st.Util.warn("Unknown anchor name: "+t+". Available names are: "+Qg.join(", "))}),e||[]}Ne.prototype.className="Transformer";(0,AZ._registerNode)(Ne);Ke.Factory.addGetterSetter(Ne,"enabledAnchors",Qg,WZ);Ke.Factory.addGetterSetter(Ne,"flipEnabled",!0,(0,fs.getBooleanValidator)());Ke.Factory.addGetterSetter(Ne,"resizeEnabled",!0);Ke.Factory.addGetterSetter(Ne,"anchorSize",10,(0,fs.getNumberValidator)());Ke.Factory.addGetterSetter(Ne,"rotateEnabled",!0);Ke.Factory.addGetterSetter(Ne,"rotateLineVisible",!0);Ke.Factory.addGetterSetter(Ne,"rotationSnaps",[]);Ke.Factory.addGetterSetter(Ne,"rotateAnchorOffset",50,(0,fs.getNumberValidator)());Ke.Factory.addGetterSetter(Ne,"rotateAnchorCursor","crosshair");Ke.Factory.addGetterSetter(Ne,"rotationSnapTolerance",5,(0,fs.getNumberValidator)());Ke.Factory.addGetterSetter(Ne,"borderEnabled",!0);Ke.Factory.addGetterSetter(Ne,"anchorStroke","rgb(0, 161, 255)");Ke.Factory.addGetterSetter(Ne,"anchorStrokeWidth",1,(0,fs.getNumberValidator)());Ke.Factory.addGetterSetter(Ne,"anchorFill","white");Ke.Factory.addGetterSetter(Ne,"anchorCornerRadius",0,(0,fs.getNumberValidator)());Ke.Factory.addGetterSetter(Ne,"borderStroke","rgb(0, 161, 255)");Ke.Factory.addGetterSetter(Ne,"borderStrokeWidth",1,(0,fs.getNumberValidator)());Ke.Factory.addGetterSetter(Ne,"borderDash");Ke.Factory.addGetterSetter(Ne,"keepRatio",!0);Ke.Factory.addGetterSetter(Ne,"shiftBehavior","default");Ke.Factory.addGetterSetter(Ne,"centeredScaling",!1);Ke.Factory.addGetterSetter(Ne,"ignoreStroke",!1);Ke.Factory.addGetterSetter(Ne,"padding",0,(0,fs.getNumberValidator)());Ke.Factory.addGetterSetter(Ne,"nodes");Ke.Factory.addGetterSetter(Ne,"node");Ke.Factory.addGetterSetter(Ne,"boundBoxFunc");Ke.Factory.addGetterSetter(Ne,"anchorDragBoundFunc");Ke.Factory.addGetterSetter(Ne,"anchorStyleFunc");Ke.Factory.addGetterSetter(Ne,"shouldOverdrawWholeArea",!1);Ke.Factory.addGetterSetter(Ne,"useSingleNodeRotation",!0);Ke.Factory.backCompat(Ne,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"})});var zk=me(tf=>{"use strict";Object.defineProperty(tf,"__esModule",{value:!0});tf.Wedge=void 0;var ef=Ae(),UZ=Vt(),qZ=Ie(),Gk=Oe(),$Z=Ie(),qn=class extends UZ.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,qZ.Konva.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}};tf.Wedge=qn;qn.prototype.className="Wedge";qn.prototype._centroid=!0;qn.prototype._attrsAffectingSize=["radius"];(0,$Z._registerNode)(qn);ef.Factory.addGetterSetter(qn,"radius",0,(0,Gk.getNumberValidator)());ef.Factory.addGetterSetter(qn,"angle",0,(0,Gk.getNumberValidator)());ef.Factory.addGetterSetter(qn,"clockwise",!1);ef.Factory.backCompat(qn,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"})});var qk=me(nf=>{"use strict";Object.defineProperty(nf,"__esModule",{value:!0});nf.Blur=void 0;var Wk=Ae(),jZ=Pt(),KZ=Oe();function Uk(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var YZ=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],XZ=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function JZ(e,t){let i=e.data,n=e.width,o=e.height,r,s,a,l,c,d,u,h,p,g,f,m,v,C,w,y,_,R,P,B,q=t+t+1,$=n-1,te=o-1,Q=t+1,ge=Q*(Q+1)/2,Me=new Uk,De=YZ[t],xt=XZ[t],Ui=null,He=Me,pt=null,Ye=null;for(let Gt=1;Gt<q;Gt++)He=He.next=new Uk,Gt===Q&&(Ui=He);He.next=Me,a=s=0;for(let Gt=0;Gt<o;Gt++){m=v=C=w=l=c=d=u=0,h=Q*(y=i[s]),p=Q*(_=i[s+1]),g=Q*(R=i[s+2]),f=Q*(P=i[s+3]),l+=ge*y,c+=ge*_,d+=ge*R,u+=ge*P,He=Me;for(let zt=0;zt<Q;zt++)He.r=y,He.g=_,He.b=R,He.a=P,He=He.next;for(let zt=1;zt<Q;zt++)r=s+(($<zt?$:zt)<<2),l+=(He.r=y=i[r])*(B=Q-zt),c+=(He.g=_=i[r+1])*B,d+=(He.b=R=i[r+2])*B,u+=(He.a=P=i[r+3])*B,m+=y,v+=_,C+=R,w+=P,He=He.next;pt=Me,Ye=Ui;for(let zt=0;zt<n;zt++)i[s+3]=P=u*De>>xt,P!==0?(P=255/P,i[s]=(l*De>>xt)*P,i[s+1]=(c*De>>xt)*P,i[s+2]=(d*De>>xt)*P):i[s]=i[s+1]=i[s+2]=0,l-=h,c-=p,d-=g,u-=f,h-=pt.r,p-=pt.g,g-=pt.b,f-=pt.a,r=a+((r=zt+t+1)<$?r:$)<<2,m+=pt.r=i[r],v+=pt.g=i[r+1],C+=pt.b=i[r+2],w+=pt.a=i[r+3],l+=m,c+=v,d+=C,u+=w,pt=pt.next,h+=y=Ye.r,p+=_=Ye.g,g+=R=Ye.b,f+=P=Ye.a,m-=y,v-=_,C-=R,w-=P,Ye=Ye.next,s+=4;a+=n}for(let Gt=0;Gt<n;Gt++){v=C=w=m=c=d=u=l=0,s=Gt<<2,h=Q*(y=i[s]),p=Q*(_=i[s+1]),g=Q*(R=i[s+2]),f=Q*(P=i[s+3]),l+=ge*y,c+=ge*_,d+=ge*R,u+=ge*P,He=Me;for(let qt=0;qt<Q;qt++)He.r=y,He.g=_,He.b=R,He.a=P,He=He.next;let zt=n;for(let qt=1;qt<=t;qt++)s=zt+Gt<<2,l+=(He.r=y=i[s])*(B=Q-qt),c+=(He.g=_=i[s+1])*B,d+=(He.b=R=i[s+2])*B,u+=(He.a=P=i[s+3])*B,m+=y,v+=_,C+=R,w+=P,He=He.next,qt<te&&(zt+=n);s=Gt,pt=Me,Ye=Ui;for(let qt=0;qt<o;qt++)r=s<<2,i[r+3]=P=u*De>>xt,P>0?(P=255/P,i[r]=(l*De>>xt)*P,i[r+1]=(c*De>>xt)*P,i[r+2]=(d*De>>xt)*P):i[r]=i[r+1]=i[r+2]=0,l-=h,c-=p,d-=g,u-=f,h-=pt.r,p-=pt.g,g-=pt.b,f-=pt.a,r=Gt+((r=qt+Q)<te?r:te)*n<<2,l+=m+=pt.r=i[r],c+=v+=pt.g=i[r+1],d+=C+=pt.b=i[r+2],u+=w+=pt.a=i[r+3],pt=pt.next,h+=y=Ye.r,p+=_=Ye.g,g+=R=Ye.b,f+=P=Ye.a,m-=y,v-=_,C-=R,w-=P,Ye=Ye.next,s+=n}}var QZ=function(t){let i=Math.round(this.blurRadius());i>0&&JZ(t,i)};nf.Blur=QZ;Wk.Factory.addGetterSetter(jZ.Node,"blurRadius",0,(0,KZ.getNumberValidator)(),Wk.Factory.afterSetFilter)});var jk=me(of=>{"use strict";Object.defineProperty(of,"__esModule",{value:!0});of.Brighten=void 0;var $k=Ae(),ZZ=Pt(),eee=Oe(),tee=function(e){let t=this.brightness()*255,i=e.data,n=i.length;for(let o=0;o<n;o+=4)i[o]+=t,i[o+1]+=t,i[o+2]+=t};of.Brighten=tee;$k.Factory.addGetterSetter(ZZ.Node,"brightness",0,(0,eee.getNumberValidator)(),$k.Factory.afterSetFilter)});var Yk=me(rf=>{"use strict";Object.defineProperty(rf,"__esModule",{value:!0});rf.Contrast=void 0;var Kk=Ae(),iee=Pt(),nee=Oe(),oee=function(e){let t=Math.pow((this.contrast()+100)/100,2),i=e.data,n=i.length,o=150,r=150,s=150;for(let a=0;a<n;a+=4)o=i[a],r=i[a+1],s=i[a+2],o/=255,o-=.5,o*=t,o+=.5,o*=255,r/=255,r-=.5,r*=t,r+=.5,r*=255,s/=255,s-=.5,s*=t,s+=.5,s*=255,o=o<0?0:o>255?255:o,r=r<0?0:r>255?255:r,s=s<0?0:s>255?255:s,i[a]=o,i[a+1]=r,i[a+2]=s};rf.Contrast=oee;Kk.Factory.addGetterSetter(iee.Node,"contrast",0,(0,nee.getNumberValidator)(),Kk.Factory.afterSetFilter)});var Jk=me(af=>{"use strict";Object.defineProperty(af,"__esModule",{value:!0});af.Emboss=void 0;var ms=Ae(),sf=Pt(),ree=St(),Xk=Oe(),see=function(e){let t=this.embossStrength()*10,i=this.embossWhiteLevel()*255,n=this.embossDirection(),o=this.embossBlend(),r=e.data,s=e.width,a=e.height,l=s*4,c=0,d=0,u=a;switch(n){case"top-left":c=-1,d=-1;break;case"top":c=-1,d=0;break;case"top-right":c=-1,d=1;break;case"right":c=0,d=1;break;case"bottom-right":c=1,d=1;break;case"bottom":c=1,d=0;break;case"bottom-left":c=1,d=-1;break;case"left":c=0,d=-1;break;default:ree.Util.error("Unknown emboss direction: "+n)}do{let h=(u-1)*l,p=c;u+p<1&&(p=0),u+p>a&&(p=0);let g=(u-1+p)*s*4,f=s;do{let m=h+(f-1)*4,v=d;f+v<1&&(v=0),f+v>s&&(v=0);let C=g+(f-1+v)*4,w=r[m]-r[C],y=r[m+1]-r[C+1],_=r[m+2]-r[C+2],R=w,P=R>0?R:-R,B=y>0?y:-y,q=_>0?_:-_;if(B>P&&(R=y),q>P&&(R=_),R*=t,o){let $=r[m]+R,te=r[m+1]+R,Q=r[m+2]+R;r[m]=$>255?255:$<0?0:$,r[m+1]=te>255?255:te<0?0:te,r[m+2]=Q>255?255:Q<0?0:Q}else{let $=i-R;$<0?$=0:$>255&&($=255),r[m]=r[m+1]=r[m+2]=$}}while(--f)}while(--u)};af.Emboss=see;ms.Factory.addGetterSetter(sf.Node,"embossStrength",.5,(0,Xk.getNumberValidator)(),ms.Factory.afterSetFilter);ms.Factory.addGetterSetter(sf.Node,"embossWhiteLevel",.5,(0,Xk.getNumberValidator)(),ms.Factory.afterSetFilter);ms.Factory.addGetterSetter(sf.Node,"embossDirection","top-left",void 0,ms.Factory.afterSetFilter);ms.Factory.addGetterSetter(sf.Node,"embossBlend",!1,void 0,ms.Factory.afterSetFilter)});var Zk=me(lf=>{"use strict";Object.defineProperty(lf,"__esModule",{value:!0});lf.Enhance=void 0;var Qk=Ae(),aee=Pt(),lee=Oe();function Ob(e,t,i,n,o){let r=i-t,s=o-n;if(r===0)return n+s/2;if(s===0)return n;let a=(e-t)/r;return a=s*a+n,a}var cee=function(e){let t=e.data,i=t.length,n=t[0],o=n,r,s=t[1],a=s,l,c=t[2],d=c,u,h=this.enhance();if(h===0)return;for(let w=0;w<i;w+=4)r=t[w+0],r<n?n=r:r>o&&(o=r),l=t[w+1],l<s?s=l:l>a&&(a=l),u=t[w+2],u<c?c=u:u>d&&(d=u);o===n&&(o=255,n=0),a===s&&(a=255,s=0),d===c&&(d=255,c=0);let p,g,f,m,v,C;if(h>0)p=o+h*(255-o),g=n-h*(n-0),f=a+h*(255-a),m=s-h*(s-0),v=d+h*(255-d),C=c-h*(c-0);else{let w=(o+n)*.5;p=o+h*(o-w),g=n+h*(n-w);let y=(a+s)*.5;f=a+h*(a-y),m=s+h*(s-y);let _=(d+c)*.5;v=d+h*(d-_),C=c+h*(c-_)}for(let w=0;w<i;w+=4)t[w+0]=Ob(t[w+0],n,o,g,p),t[w+1]=Ob(t[w+1],s,a,m,f),t[w+2]=Ob(t[w+2],c,d,C,v)};lf.Enhance=cee;Qk.Factory.addGetterSetter(aee.Node,"enhance",0,(0,lee.getNumberValidator)(),Qk.Factory.afterSetFilter)});var eT=me(cf=>{"use strict";Object.defineProperty(cf,"__esModule",{value:!0});cf.Grayscale=void 0;var dee=function(e){let t=e.data,i=t.length;for(let n=0;n<i;n+=4){let o=.34*t[n]+.5*t[n+1]+.16*t[n+2];t[n]=o,t[n+1]=o,t[n+2]=o}};cf.Grayscale=dee});var tT=me(df=>{"use strict";Object.defineProperty(df,"__esModule",{value:!0});df.HSL=void 0;var $l=Ae(),Nb=Pt(),Bb=Oe();$l.Factory.addGetterSetter(Nb.Node,"hue",0,(0,Bb.getNumberValidator)(),$l.Factory.afterSetFilter);$l.Factory.addGetterSetter(Nb.Node,"saturation",0,(0,Bb.getNumberValidator)(),$l.Factory.afterSetFilter);$l.Factory.addGetterSetter(Nb.Node,"luminance",0,(0,Bb.getNumberValidator)(),$l.Factory.afterSetFilter);var uee=function(e){let t=e.data,i=t.length,n=1,o=Math.pow(2,this.saturation()),r=Math.abs(this.hue()+360)%360,s=this.luminance()*127,a=n*o*Math.cos(r*Math.PI/180),l=n*o*Math.sin(r*Math.PI/180),c=.299*n+.701*a+.167*l,d=.587*n-.587*a+.33*l,u=.114*n-.114*a-.497*l,h=.299*n-.299*a-.328*l,p=.587*n+.413*a+.035*l,g=.114*n-.114*a+.293*l,f=.299*n-.3*a+1.25*l,m=.587*n-.586*a-1.05*l,v=.114*n+.886*a-.2*l,C,w,y,_;for(let R=0;R<i;R+=4)C=t[R+0],w=t[R+1],y=t[R+2],_=t[R+3],t[R+0]=c*C+d*w+u*y+s,t[R+1]=h*C+p*w+g*y+s,t[R+2]=f*C+m*w+v*y+s,t[R+3]=_};df.HSL=uee});var iT=me(uf=>{"use strict";Object.defineProperty(uf,"__esModule",{value:!0});uf.HSV=void 0;var jl=Ae(),Hb=Pt(),Vb=Oe(),hee=function(e){let t=e.data,i=t.length,n=Math.pow(2,this.value()),o=Math.pow(2,this.saturation()),r=Math.abs(this.hue()+360)%360,s=n*o*Math.cos(r*Math.PI/180),a=n*o*Math.sin(r*Math.PI/180),l=.299*n+.701*s+.167*a,c=.587*n-.587*s+.33*a,d=.114*n-.114*s-.497*a,u=.299*n-.299*s-.328*a,h=.587*n+.413*s+.035*a,p=.114*n-.114*s+.293*a,g=.299*n-.3*s+1.25*a,f=.587*n-.586*s-1.05*a,m=.114*n+.886*s-.2*a;for(let v=0;v<i;v+=4){let C=t[v+0],w=t[v+1],y=t[v+2],_=t[v+3];t[v+0]=l*C+c*w+d*y,t[v+1]=u*C+h*w+p*y,t[v+2]=g*C+f*w+m*y,t[v+3]=_}};uf.HSV=hee;jl.Factory.addGetterSetter(Hb.Node,"hue",0,(0,Vb.getNumberValidator)(),jl.Factory.afterSetFilter);jl.Factory.addGetterSetter(Hb.Node,"saturation",0,(0,Vb.getNumberValidator)(),jl.Factory.afterSetFilter);jl.Factory.addGetterSetter(Hb.Node,"value",0,(0,Vb.getNumberValidator)(),jl.Factory.afterSetFilter)});var nT=me(hf=>{"use strict";Object.defineProperty(hf,"__esModule",{value:!0});hf.Invert=void 0;var pee=function(e){let t=e.data,i=t.length;for(let n=0;n<i;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2]};hf.Invert=pee});var aT=me(gf=>{"use strict";Object.defineProperty(gf,"__esModule",{value:!0});gf.Kaleidoscope=void 0;var pf=Ae(),rT=Pt(),oT=St(),sT=Oe(),gee=function(e,t,i){let n=e.data,o=t.data,r=e.width,s=e.height,a=i.polarCenterX||r/2,l=i.polarCenterY||s/2,c=Math.sqrt(a*a+l*l),d=r-a,u=s-l,h=Math.sqrt(d*d+u*u);c=h>c?h:c;let p=s,g=r,f=360/g*Math.PI/180;for(let m=0;m<g;m+=1){let v=Math.sin(m*f),C=Math.cos(m*f);for(let w=0;w<p;w+=1){d=Math.floor(a+c*w/p*C),u=Math.floor(l+c*w/p*v);let y=(u*r+d)*4,_=n[y+0],R=n[y+1],P=n[y+2],B=n[y+3];y=(m+w*r)*4,o[y+0]=_,o[y+1]=R,o[y+2]=P,o[y+3]=B}}},fee=function(e,t,i){let n=e.data,o=t.data,r=e.width,s=e.height,a=i.polarCenterX||r/2,l=i.polarCenterY||s/2,c=Math.sqrt(a*a+l*l),d=r-a,u=s-l,h=Math.sqrt(d*d+u*u);c=h>c?h:c;let p=s,g=r,f=i.polarRotation||0,m,v;for(d=0;d<r;d+=1)for(u=0;u<s;u+=1){let C=d-a,w=u-l,y=Math.sqrt(C*C+w*w)*p/c,_=(Math.atan2(w,C)*180/Math.PI+360+f)%360;_=_*g/360,m=Math.floor(_),v=Math.floor(y);let R=(v*r+m)*4,P=n[R+0],B=n[R+1],q=n[R+2],$=n[R+3];R=(u*r+d)*4,o[R+0]=P,o[R+1]=B,o[R+2]=q,o[R+3]=$}},mee=function(e){let t=e.width,i=e.height,n,o,r,s,a,l,c,d,u,h,p=Math.round(this.kaleidoscopePower()),g=Math.round(this.kaleidoscopeAngle()),f=Math.floor(t*(g%360)/360);if(p<1)return;let m=oT.Util.createCanvasElement();m.width=t,m.height=i;let v=m.getContext("2d").getImageData(0,0,t,i);oT.Util.releaseCanvas(m),gee(e,v,{polarCenterX:t/2,polarCenterY:i/2});let C=t/Math.pow(2,p);for(;C<=8;)C=C*2,p-=1;C=Math.ceil(C);let w=C,y=0,_=w,R=1;for(f+C>t&&(y=w,_=0,R=-1),o=0;o<i;o+=1)for(n=y;n!==_;n+=R)r=Math.round(n+f)%t,u=(t*o+r)*4,a=v.data[u+0],l=v.data[u+1],c=v.data[u+2],d=v.data[u+3],h=(t*o+n)*4,v.data[h+0]=a,v.data[h+1]=l,v.data[h+2]=c,v.data[h+3]=d;for(o=0;o<i;o+=1)for(w=Math.floor(C),s=0;s<p;s+=1){for(n=0;n<w+1;n+=1)u=(t*o+n)*4,a=v.data[u+0],l=v.data[u+1],c=v.data[u+2],d=v.data[u+3],h=(t*o+w*2-n-1)*4,v.data[h+0]=a,v.data[h+1]=l,v.data[h+2]=c,v.data[h+3]=d;w*=2}fee(v,e,{polarRotation:0})};gf.Kaleidoscope=mee;pf.Factory.addGetterSetter(rT.Node,"kaleidoscopePower",2,(0,sT.getNumberValidator)(),pf.Factory.afterSetFilter);pf.Factory.addGetterSetter(rT.Node,"kaleidoscopeAngle",0,(0,sT.getNumberValidator)(),pf.Factory.afterSetFilter)});var cT=me(mf=>{"use strict";Object.defineProperty(mf,"__esModule",{value:!0});mf.Mask=void 0;var lT=Ae(),vee=Pt(),Cee=Oe();function ff(e,t,i){let n=(i*e.width+t)*4,o=[];return o.push(e.data[n++],e.data[n++],e.data[n++],e.data[n++]),o}function Zd(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2))}function wee(e){let t=[0,0,0];for(let i=0;i<e.length;i++)t[0]+=e[i][0],t[1]+=e[i][1],t[2]+=e[i][2];return t[0]/=e.length,t[1]/=e.length,t[2]/=e.length,t}function bee(e,t){let i=ff(e,0,0),n=ff(e,e.width-1,0),o=ff(e,0,e.height-1),r=ff(e,e.width-1,e.height-1),s=t||10;if(Zd(i,n)<s&&Zd(n,r)<s&&Zd(r,o)<s&&Zd(o,i)<s){let a=wee([n,i,r,o]),l=[];for(let c=0;c<e.width*e.height;c++){let d=Zd(a,[e.data[c*4],e.data[c*4+1],e.data[c*4+2]]);l[c]=d<s?0:255}return l}}function yee(e,t){for(let i=0;i<e.width*e.height;i++)e.data[4*i+3]=t[i]}function See(e,t,i){let n=[1,1,1,1,0,1,1,1,1],o=Math.round(Math.sqrt(n.length)),r=Math.floor(o/2),s=[];for(let a=0;a<i;a++)for(let l=0;l<t;l++){let c=a*t+l,d=0;for(let u=0;u<o;u++)for(let h=0;h<o;h++){let p=a+u-r,g=l+h-r;if(p>=0&&p<i&&g>=0&&g<t){let f=p*t+g,m=n[u*o+h];d+=e[f]*m}}s[c]=d===2040?255:0}return s}function xee(e,t,i){let n=[1,1,1,1,1,1,1,1,1],o=Math.round(Math.sqrt(n.length)),r=Math.floor(o/2),s=[];for(let a=0;a<i;a++)for(let l=0;l<t;l++){let c=a*t+l,d=0;for(let u=0;u<o;u++)for(let h=0;h<o;h++){let p=a+u-r,g=l+h-r;if(p>=0&&p<i&&g>=0&&g<t){let f=p*t+g,m=n[u*o+h];d+=e[f]*m}}s[c]=d>=1020?255:0}return s}function Eee(e,t,i){let n=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],o=Math.round(Math.sqrt(n.length)),r=Math.floor(o/2),s=[];for(let a=0;a<i;a++)for(let l=0;l<t;l++){let c=a*t+l,d=0;for(let u=0;u<o;u++)for(let h=0;h<o;h++){let p=a+u-r,g=l+h-r;if(p>=0&&p<i&&g>=0&&g<t){let f=p*t+g,m=n[u*o+h];d+=e[f]*m}}s[c]=d}return s}var _ee=function(e){let t=this.threshold(),i=bee(e,t);return i&&(i=See(i,e.width,e.height),i=xee(i,e.width,e.height),i=Eee(i,e.width,e.height),yee(e,i)),e};mf.Mask=_ee;lT.Factory.addGetterSetter(vee.Node,"threshold",0,(0,Cee.getNumberValidator)(),lT.Factory.afterSetFilter)});var uT=me(vf=>{"use strict";Object.defineProperty(vf,"__esModule",{value:!0});vf.Noise=void 0;var dT=Ae(),Ree=Pt(),Pee=Oe(),Dee=function(e){let t=this.noise()*255,i=e.data,n=i.length,o=t/2;for(let r=0;r<n;r+=4)i[r+0]+=o-2*o*Math.random(),i[r+1]+=o-2*o*Math.random(),i[r+2]+=o-2*o*Math.random()};vf.Noise=Dee;dT.Factory.addGetterSetter(Ree.Node,"noise",.2,(0,Pee.getNumberValidator)(),dT.Factory.afterSetFilter)});var pT=me(Cf=>{"use strict";Object.defineProperty(Cf,"__esModule",{value:!0});Cf.Pixelate=void 0;var hT=Ae(),Mee=St(),kee=Pt(),Tee=Oe(),Fee=function(e){let t=Math.ceil(this.pixelSize()),i=e.width,n=e.height,o=Math.ceil(i/t),r=Math.ceil(n/t),s=e.data;if(t<=0){Mee.Util.error("pixelSize value can not be <= 0");return}for(let a=0;a<o;a+=1)for(let l=0;l<r;l+=1){let c=0,d=0,u=0,h=0,p=a*t,g=p+t,f=l*t,m=f+t,v=0;for(let C=p;C<g;C+=1)if(!(C>=i))for(let w=f;w<m;w+=1){if(w>=n)continue;let y=(i*w+C)*4;c+=s[y+0],d+=s[y+1],u+=s[y+2],h+=s[y+3],v+=1}c=c/v,d=d/v,u=u/v,h=h/v;for(let C=p;C<g;C+=1)if(!(C>=i))for(let w=f;w<m;w+=1){if(w>=n)continue;let y=(i*w+C)*4;s[y+0]=c,s[y+1]=d,s[y+2]=u,s[y+3]=h}}};Cf.Pixelate=Fee;hT.Factory.addGetterSetter(kee.Node,"pixelSize",8,(0,Tee.getNumberValidator)(),hT.Factory.afterSetFilter)});var fT=me(wf=>{"use strict";Object.defineProperty(wf,"__esModule",{value:!0});wf.Posterize=void 0;var gT=Ae(),Iee=Pt(),Aee=Oe(),Lee=function(e){let t=Math.round(this.levels()*254)+1,i=e.data,n=i.length,o=255/t;for(let r=0;r<n;r+=1)i[r]=Math.floor(i[r]/o)*o};wf.Posterize=Lee;gT.Factory.addGetterSetter(Iee.Node,"levels",.5,(0,Aee.getNumberValidator)(),gT.Factory.afterSetFilter)});var mT=me(yf=>{"use strict";Object.defineProperty(yf,"__esModule",{value:!0});yf.RGB=void 0;var bf=Ae(),Gb=Pt(),Oee=Oe(),Nee=function(e){let t=e.data,i=t.length,n=this.red(),o=this.green(),r=this.blue();for(let s=0;s<i;s+=4){let a=(.34*t[s]+.5*t[s+1]+.16*t[s+2])/255;t[s]=a*n,t[s+1]=a*o,t[s+2]=a*r,t[s+3]=t[s+3]}};yf.RGB=Nee;bf.Factory.addGetterSetter(Gb.Node,"red",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});bf.Factory.addGetterSetter(Gb.Node,"green",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});bf.Factory.addGetterSetter(Gb.Node,"blue",0,Oee.RGBComponent,bf.Factory.afterSetFilter)});var vT=me(xf=>{"use strict";Object.defineProperty(xf,"__esModule",{value:!0});xf.RGBA=void 0;var eu=Ae(),Sf=Pt(),Bee=Oe(),Hee=function(e){let t=e.data,i=t.length,n=this.red(),o=this.green(),r=this.blue(),s=this.alpha();for(let a=0;a<i;a+=4){let l=1-s;t[a]=n*s+t[a]*l,t[a+1]=o*s+t[a+1]*l,t[a+2]=r*s+t[a+2]*l}};xf.RGBA=Hee;eu.Factory.addGetterSetter(Sf.Node,"red",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});eu.Factory.addGetterSetter(Sf.Node,"green",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});eu.Factory.addGetterSetter(Sf.Node,"blue",0,Bee.RGBComponent,eu.Factory.afterSetFilter);eu.Factory.addGetterSetter(Sf.Node,"alpha",1,function(e){return this._filterUpToDate=!1,e>1?1:e<0?0:e})});var CT=me(Ef=>{"use strict";Object.defineProperty(Ef,"__esModule",{value:!0});Ef.Sepia=void 0;var Vee=function(e){let t=e.data,i=t.length;for(let n=0;n<i;n+=4){let o=t[n+0],r=t[n+1],s=t[n+2];t[n+0]=Math.min(255,o*.393+r*.769+s*.189),t[n+1]=Math.min(255,o*.349+r*.686+s*.168),t[n+2]=Math.min(255,o*.272+r*.534+s*.131)}};Ef.Sepia=Vee});var wT=me(_f=>{"use strict";Object.defineProperty(_f,"__esModule",{value:!0});_f.Solarize=void 0;var Gee=function(e){let t=e.data,i=e.width,n=e.height,o=i*4,r=n;do{let s=(r-1)*o,a=i;do{let l=s+(a-1)*4,c=t[l],d=t[l+1],u=t[l+2];c>127&&(c=255-c),d>127&&(d=255-d),u>127&&(u=255-u),t[l]=c,t[l+1]=d,t[l+2]=u}while(--a)}while(--r)};_f.Solarize=Gee});var yT=me(Rf=>{"use strict";Object.defineProperty(Rf,"__esModule",{value:!0});Rf.Threshold=void 0;var bT=Ae(),zee=Pt(),Wee=Oe(),Uee=function(e){let t=this.threshold()*255,i=e.data,n=i.length;for(let o=0;o<n;o+=1)i[o]=i[o]<t?0:255};Rf.Threshold=Uee;bT.Factory.addGetterSetter(zee.Node,"threshold",.5,(0,Wee.getNumberValidator)(),bT.Factory.afterSetFilter)});var ET=me(Pf=>{"use strict";Object.defineProperty(Pf,"__esModule",{value:!0});Pf.Konva=void 0;var ST=XM(),qee=QM(),$ee=ok(),jee=rk(),Kee=ak(),Yee=lk(),xT=uk(),Xee=fb(),Jee=Ng(),Qee=Eb(),Zee=gk(),ete=Ck(),tte=_b(),ite=bk(),nte=Fb(),ote=Ik(),rte=Vk(),ste=zk(),ate=qk(),lte=jk(),cte=Yk(),dte=Jk(),ute=Zk(),hte=eT(),pte=tT(),gte=iT(),fte=nT(),mte=aT(),vte=cT(),Cte=uT(),wte=pT(),bte=fT(),yte=mT(),Ste=vT(),xte=CT(),Ete=wT(),_te=yT();Pf.Konva=ST.Konva.Util._assign(ST.Konva,{Arc:qee.Arc,Arrow:$ee.Arrow,Circle:jee.Circle,Ellipse:Kee.Ellipse,Image:Yee.Image,Label:xT.Label,Tag:xT.Tag,Line:Xee.Line,Path:Jee.Path,Rect:Qee.Rect,RegularPolygon:Zee.RegularPolygon,Ring:ete.Ring,Sprite:tte.Sprite,Star:ite.Star,Text:nte.Text,TextPath:ote.TextPath,Transformer:rte.Transformer,Wedge:ste.Wedge,Filters:{Blur:ate.Blur,Brighten:lte.Brighten,Contrast:cte.Contrast,Emboss:dte.Emboss,Enhance:ute.Enhance,Grayscale:hte.Grayscale,HSL:pte.HSL,HSV:gte.HSV,Invert:fte.Invert,Kaleidoscope:mte.Kaleidoscope,Mask:vte.Mask,Noise:Cte.Noise,Pixelate:wte.Pixelate,Posterize:bte.Posterize,RGB:yte.RGB,RGBA:Ste.RGBA,Sepia:xte.Sepia,Solarize:Ete.Solarize,Threshold:_te.Threshold}})});var PT=me((_T,RT)=>{"use strict";Object.defineProperty(_T,"__esModule",{value:!0});var Rte=ET();RT.exports=Rte.Konva});var oS=(()=>{class e{uploadEndpoint=M("");maxFileSize=M(10*1024*1024);allowedFileTypes=M(["image/*","application/pdf",".doc",".docx"]);maxNumberOfFiles=M(10);note=M("");uploadComplete=oe();uploadError=oe();filesAdded=oe();uppy=null;ngOnInit(){this.initializeUppy()}ngOnDestroy(){this.uppy?.destroy()}initializeUppy(){this.uppy=new Uy({id:"file-uploader",autoProceed:!1,allowMultipleUploadBatches:!0,restrictions:{maxFileSize:this.maxFileSize(),maxNumberOfFiles:this.maxNumberOfFiles(),allowedFileTypes:this.allowedFileTypes()}}).use($y,{inline:!0,target:"#uppy-dashboard",height:400,width:"100%",theme:"auto",proudlyDisplayPoweredByUppy:!1,hideProgressDetails:!1,hideUploadButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideCancelButton:!1,showRemoveButtonAfterComplete:!0,note:this.note()||"Images up to 10MB, PDFs and documents allowed"}).use(qy,{quality:.8,limit:10}),this.uploadEndpoint()&&this.uppy.use(jy,{endpoint:this.uploadEndpoint(),retryDelays:[0,1e3,3e3,5e3],chunkSize:5*1024*1024}),this.uppy.on("file-added",()=>{this.filesAdded.emit(this.uppy?.getFiles().length??0)}),this.uppy.on("complete",i=>{let n=[];i.successful&&(n=i.successful.map(o=>({id:o.id,name:o.name,size:o.size,type:o.type??"unknown",url:o.response?.uploadURL}))),this.uploadComplete.emit(n)}),this.uppy.on("error",i=>{this.uploadError.emit(i)}),this.uppy.on("upload-error",(i,n)=>{console.error("Upload error for file:",i?.name,n),this.uploadError.emit(n)})}clearFiles(){this.uppy?.cancelAll()}getFiles(){return this.uppy?.getFiles()??[]}upload(){this.uppy?.upload()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["gh-file-upload"]],inputs:{uploadEndpoint:[1,"uploadEndpoint"],maxFileSize:[1,"maxFileSize"],allowedFileTypes:[1,"allowedFileTypes"],maxNumberOfFiles:[1,"maxNumberOfFiles"],note:[1,"note"]},outputs:{uploadComplete:"uploadComplete",uploadError:"uploadError",filesAdded:"filesAdded"},decls:1,vars:0,consts:[["id","uppy-dashboard"]],template:function(n,o){n&1&&pu(0,"div",0)},styles:["[_nghost-%COMP%]{display:block;width:100%}#uppy-dashboard[_ngcontent-%COMP%]{border-radius:.5rem;overflow:hidden}[_nghost-%COMP%]     .uppy-Dashboard-inner{background-color:hsl(var(--background));border:1px solid hsl(var(--border));border-radius:.5rem}[_nghost-%COMP%]     .uppy-Dashboard-AddFiles{border-color:hsl(var(--border))}[_nghost-%COMP%]     .uppy-Dashboard-AddFiles-title{color:hsl(var(--foreground))}[_nghost-%COMP%]     .uppy-Dashboard-note{color:hsl(var(--muted-foreground))}[_nghost-%COMP%]     .uppy-DashboardContent-bar{background-color:hsl(var(--muted));border-bottom:1px solid hsl(var(--border))}[_nghost-%COMP%]     .uppy-DashboardContent-title{color:hsl(var(--foreground))}[_nghost-%COMP%]     .uppy-DashboardItem{border-bottom:1px solid hsl(var(--border))}[_nghost-%COMP%]     .uppy-DashboardItem-name{color:hsl(var(--foreground))}[_nghost-%COMP%]     .uppy-DashboardItem-status{color:hsl(var(--muted-foreground))}[_nghost-%COMP%]     .uppy-StatusBar{background-color:hsl(var(--muted));border-top:1px solid hsl(var(--border))}[_nghost-%COMP%]     .uppy-StatusBar-actionBtn--upload{background-color:hsl(var(--primary));color:hsl(var(--primary-foreground))}[_nghost-%COMP%]     .uppy-StatusBar-actionBtn--upload:hover{background-color:hsl(var(--primary) / .9)}[_nghost-%COMP%]     .uppy-StatusBar-progress{background-color:hsl(var(--primary))}@media (prefers-color-scheme: dark){[_nghost-%COMP%]     .uppy-Dashboard-AddFiles{background-color:hsl(var(--background))}[_nghost-%COMP%]     .uppy-Dashboard-dropFilesHereHint{color:hsl(var(--muted-foreground))}}"],changeDetection:0})}return e})();var j6=["*"],uc=(()=>{class e extends dc{side=M("top");sideState=Rs(()=>this.side());constructor(){super(),_e(()=>{let i=this.sideState();Oi(()=>{i==="top"&&this.mutablePositionStrategy.set(this.positionBuilder.global().top()),i==="bottom"&&this.mutablePositionStrategy.set(this.positionBuilder.global().bottom()),i==="left"&&this.mutablePositionStrategy.set(this.positionBuilder.global().left()),i==="right"&&this.mutablePositionStrategy.set(this.positionBuilder.global().right())})})}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["brn-sheet"]],inputs:{side:[1,"side"]},exportAs:["brnSheet"],features:[ue([{provide:dc,useExisting:Ei(()=>e)}]),Ot],ngContentSelectors:j6,decls:1,vars:0,template:function(n,o){n&1&&(ct(),ze(0))},encapsulation:2,changeDetection:0})}return e})(),rS=(()=>{class e extends Ty{static \u0275fac=(()=>{let i;return function(o){return(i||(i=_i(e)))(o||e)}})();static \u0275dir=se({type:e,selectors:[["button","brnSheetClose",""]],features:[Ot]})}return e})(),Zn=(()=>{class e extends Fy{side=k(uc).sideState;static \u0275fac=(()=>{let i;return function(o){return(i||(i=_i(e)))(o||e)}})();static \u0275dir=se({type:e,selectors:[["","brnSheetContent",""]],features:[ue([_u(()=>e),xu(()=>e)]),Ot]})}return e})(),sS=(()=>{class e extends Iy{static \u0275fac=(()=>{let i;return function(o){return(i||(i=_i(e)))(o||e)}})();static \u0275dir=se({type:e,selectors:[["","brnSheetDescription",""]],hostVars:1,hostBindings:function(n,o){n&2&&ji("id",o._id())},features:[Ot]})}return e})(),aS=(()=>{class e extends Ay{static \u0275fac=(()=>{let i;return function(o){return(i||(i=_i(e)))(o||e)}})();static \u0275cmp=re({type:e,selectors:[["brn-sheet-overlay"]],features:[ue([Dy(()=>e)]),Ot],decls:0,vars:0,template:function(n,o){},encapsulation:2,changeDetection:0})}return e})(),lS=(()=>{class e extends Ly{static \u0275fac=(()=>{let i;return function(o){return(i||(i=_i(e)))(o||e)}})();static \u0275dir=se({type:e,selectors:[["","brnSheetTitle",""]],hostVars:1,hostBindings:function(n,o){n&2&&ji("id",o._id())},features:[Ot]})}return e})();var Yf=(()=>{class e{_classSettable=Py({optional:!0,host:!0});userClass=M("",{alias:"class"});_computedClass=L(()=>le("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 bg-black/50",this.userClass()));constructor(){_e(()=>{let i=this._computedClass();Oi(()=>this._classSettable?.setClassToCustomElement(i))})}static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["","hlmSheetOverlay",""],["brn-sheet-overlay","hlm",""]],hostVars:2,hostBindings:function(n,o){n&2&&ce(o._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var K6=["*"],Ln=(()=>{class e extends uc{static \u0275fac=(()=>{let i;return function(o){return(i||(i=_i(e)))(o||e)}})();static \u0275cmp=re({type:e,selectors:[["hlm-sheet"]],exportAs:["hlmSheet"],features:[ue([{provide:dc,useExisting:Ei(()=>uc)},{provide:uc,useExisting:Ei(()=>e)},ky({})]),Ot],ngContentSelectors:K6,decls:2,vars:0,consts:[["hlm",""]],template:function(n,o){n&1&&(ct(),H(0,"brn-sheet-overlay",0),ze(1))},dependencies:[aS,Yf],encapsulation:2,changeDetection:0})}return e})();var Xf=(()=>{class e{userClass=M("",{alias:"class"});_computedClass=L(()=>le("ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["","hlmSheetClose",""],["","brnSheetClose","","hlm",""]],hostVars:2,hostBindings:function(n,o){n&2&&ce(o._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var Y6=["*"],X6=Da("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b",bottom:"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",left:"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",right:"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm"}},defaultVariants:{side:"right"}}),On=(()=>{class e{_stateProvider=Eu({host:!0});_sideProvider=Su({host:!0});state=this._stateProvider.state??J("closed");_renderer=k(Fo);_element=k(Je);constructor(){_e(()=>{this._renderer.setAttribute(this._element.nativeElement,"data-state",this.state())})}userClass=M("",{alias:"class"});_computedClass=L(()=>le(X6({side:this._sideProvider.side()}),this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["hlm-sheet-content"]],hostVars:3,hostBindings:function(n,o){n&2&&(Qe("data-state",o.state()),ce(o._computedClass()))},inputs:{userClass:[1,"class","userClass"]},features:[ue([nt({lucideX:py})])],ngContentSelectors:Y6,decls:5,vars:0,consts:[["brnSheetClose","","hlm",""],[1,"sr-only"],["hlm","","size","sm","name","lucideX"]],template:function(n,o){n&1&&(ct(),ze(0),S(1,"button",0)(2,"span",1),F(3,"Close"),x(),H(4,"ng-icon",2),x())},dependencies:[Xf,rS,ot,We],encapsulation:2,changeDetection:0})}return e})();var Lo=(()=>{class e{userClass=M("",{alias:"class"});_computedClass=L(()=>le("text-muted-foreground text-sm",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["","hlmSheetDescription",""]],hostVars:2,hostBindings:function(n,o){n&2&&ce(o._computedClass())},inputs:{userClass:[1,"class","userClass"]},features:[$i([sS])]})}return e})();var J6=["*"],Oo=(()=>{class e{userClass=M("",{alias:"class"});_computedClass=L(()=>le("mt-auto flex flex-col gap-2 p-4",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["hlm-sheet-footer"]],hostVars:2,hostBindings:function(n,o){n&2&&ce(o._computedClass())},inputs:{userClass:[1,"class","userClass"]},ngContentSelectors:J6,decls:1,vars:0,template:function(n,o){n&1&&(ct(),ze(0))},encapsulation:2,changeDetection:0})}return e})();var Q6=["*"],No=(()=>{class e{userClass=M("",{alias:"class"});_computedClass=L(()=>le("flex flex-col gap-1.5 p-4",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["hlm-sheet-header"]],hostVars:2,hostBindings:function(n,o){n&2&&ce(o._computedClass())},inputs:{userClass:[1,"class","userClass"]},ngContentSelectors:Q6,decls:1,vars:0,template:function(n,o){n&1&&(ct(),ze(0))},encapsulation:2,changeDetection:0})}return e})();var Bo=(()=>{class e{userClass=M("",{alias:"class"});_computedClass=L(()=>le("text-foreground font-semibold",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["","hlmSheetTitle",""]],hostVars:2,hostBindings:function(n,o){n&2&&ce(o._computedClass())},inputs:{userClass:[1,"class","userClass"]},features:[$i([lS])]})}return e})();var Z6={sidebarWidth:"16rem",sidebarWidthMobile:"18rem",sidebarWidthIcon:"3rem",sidebarCookieName:"sidebar_state",sidebarCookieMaxAge:3600*24*7,sidebarKeyboardShortcut:"b",mobileBreakpoint:"768px"},e4=new bt("HlmSidebarConfig");function Oa(){return k(e4,{optional:!0})??Z6}var Ms=(()=>{class e{_config=Oa();_document=k(Li);_window=this._document.defaultView;_open=J(!0);_openMobile=J(!1);_isMobile=J(!1);_variant=J("sidebar");_mediaQuery=null;open=this._open.asReadonly();openMobile=this._openMobile.asReadonly();isMobile=this._isMobile.asReadonly();variant=this._variant.asReadonly();state=L(()=>this._open()?"expanded":"collapsed");constructor(){let i=k(To);_r(()=>{if(!this._window)return;let n=this._document.cookie.split("; ").find(l=>l.startsWith(`${this._config.sidebarCookieName}=`));if(n){let l=n.split("=")[1];this._open.set(l==="true")}this._mediaQuery=this._window.matchMedia(`(max-width: ${this._config.mobileBreakpoint})`),this._isMobile.set(this._mediaQuery.matches);let o=l=>{this._isMobile.set(l.matches),l.matches||this._openMobile.set(!1)};this._mediaQuery.addEventListener("change",o);let r=l=>{l.key===this._config.sidebarKeyboardShortcut&&(l.ctrlKey||l.metaKey)&&(l.preventDefault(),this.toggleSidebar())};this._window.addEventListener("keydown",r);let s,a=()=>{this._window&&(s&&this._window.clearTimeout(s),s=this._window.setTimeout(()=>{this._mediaQuery&&this._isMobile.set(this._mediaQuery.matches)},100))};this._window.addEventListener("resize",a),i.onDestroy(()=>{this._window&&(this._mediaQuery&&this._mediaQuery.removeEventListener("change",o),this._window.removeEventListener("keydown",r),this._window.removeEventListener("resize",a),s&&this._window.clearTimeout(s))})})}setOpen(i){this._open.set(i),this._document.cookie=`${this._config.sidebarCookieName}=${i}; path=/; max-age=${this._config.sidebarCookieMaxAge}`}setOpenMobile(i){this._isMobile()&&this._openMobile.set(i)}setVariant(i){this._variant.set(i)}toggleSidebar(){this._isMobile()?this._openMobile.update(i=>!i):this.setOpen(!this._open())}static \u0275fac=function(n){return new(n||e)};static \u0275prov=qi({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var t4=["*"];function i4(e,t){e&1&&ze(0)}function n4(e,t){e&1&&Mn(0)}function o4(e,t){if(e&1&&(S(0,"div",4),Dt(1,n4,1,0,"ng-container",5),x()),e&2){let i=I(),n=Ki(1);ce(i._nonCollapsibleComputedClass()),E(),U("ngTemplateOutlet",n)}}function r4(e,t){e&1&&Mn(0)}function s4(e,t){if(e&1&&(S(0,"hlm-sheet-content",8)(1,"div",9),Dt(2,r4,1,0,"ng-container",5),x()()),e&2){let i=I(2),n=Ki(1);jt("--sidebar-width",i.sidebarWidthMobile()),E(2),U("ngTemplateOutlet",n)}}function a4(e,t){if(e&1){let i=xe();S(0,"hlm-sheet",6),V("stateChanged",function(o){j(i);let r=I();return K(r._sidebarService.setOpenMobile(o==="open"))}),Dt(1,s4,3,3,"hlm-sheet-content",7),x()}if(e&2){let i=I();U("side",i.side())("state",i._sidebarService.openMobile()?"open":"closed")}}function l4(e,t){e&1&&Mn(0)}function c4(e,t){if(e&1&&(S(0,"div",3),H(1,"div",10),S(2,"div",11)(3,"div",12),Dt(4,l4,1,0,"ng-container",5),x()()()),e&2){let i=I(),n=Ki(1);Qe("data-state",i._sidebarService.state())("data-collapsible",i._sidebarService.state()==="collapsed"?i.collapsible():"")("data-variant",i.variant())("data-side",i.side()),E(),ce(i._sidebarGapComputedClass()),E(),ce(i._sidebarContainerComputedClass()),E(2),U("ngTemplateOutlet",n)}}var Jf=(()=>{class e{_sidebarService=k(Ms);_config=Oa();sidebarWidthMobile=M(this._config.sidebarWidthMobile);side=M("left");variant=M(this._sidebarService.variant());collapsible=M("offcanvas");nonCollapsibleClass=M("");_nonCollapsibleComputedClass=L(()=>le("bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col",this.nonCollapsibleClass()));_sidebarGapComputedClass=L(()=>le("relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",this.variant()==="floating"||this.variant()==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]"));sidebarContainerClass=M("");_sidebarContainerComputedClass=L(()=>le("fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex",this.side()==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",this.variant()==="floating"||this.variant()==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l",this.sidebarContainerClass()));constructor(){_e(()=>{this._sidebarService.setVariant(this.variant())})}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["hlm-sidebar"]],inputs:{sidebarWidthMobile:[1,"sidebarWidthMobile"],side:[1,"side"],variant:[1,"variant"],collapsible:[1,"collapsible"],nonCollapsibleClass:[1,"nonCollapsibleClass"],sidebarContainerClass:[1,"sidebarContainerClass"]},ngContentSelectors:t4,decls:5,vars:1,consts:[["contentContainer",""],["data-slot","sidebar",3,"class"],[3,"side","state"],["data-slot","sidebar",1,"text-sidebar-foreground","group","peer","hidden","md:block"],["data-slot","sidebar"],[4,"ngTemplateOutlet"],[3,"stateChanged","side","state"],["data-slot","sidebar","data-sidebar","sidebar","data-mobile","true","class","bg-sidebar text-sidebar-foreground h-screen w-[var(--sidebar-width)] p-0 [&>button]:hidden",3,"--sidebar-width",4,"brnSheetContent"],["data-slot","sidebar","data-sidebar","sidebar","data-mobile","true",1,"bg-sidebar","text-sidebar-foreground","h-screen","w-[var(--sidebar-width)]","p-0","[&>button]:hidden"],[1,"flex","h-full","w-full","flex-col"],["data-slot","sidebar-gap"],["data-slot","sidebar-container"],["data-sidebar","sidebar","data-slot","sidebar-inner",1,"bg-sidebar","group-data-[variant=floating]:border-sidebar-border","flex","h-full","w-full","flex-col","group-data-[variant=floating]:rounded-lg","group-data-[variant=floating]:border","group-data-[variant=floating]:shadow"]],template:function(n,o){n&1&&(ct(),Dt(0,i4,1,0,"ng-template",null,0,_s),ve(2,o4,2,3,"div",1)(3,a4,2,2,"hlm-sheet",2)(4,c4,5,9,"div",3)),n&2&&(E(2),Ce(o.collapsible()==="none"?2:o._sidebarService.isMobile()?3:4))},dependencies:[Ln,On,Ps,Zn],encapsulation:2,changeDetection:0})}return e})();var Qf=(()=>{class e{userClass=M("",{alias:"class"});_computedClass=L(()=>le("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["","hlmSidebarContent",""],["hlm-sidebar-content"]],hostAttrs:["data-slot","sidebar-content","data-sidebar","content"],hostVars:2,hostBindings:function(n,o){n&2&&ce(o._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var Zf=(()=>{class e{userClass=M("",{alias:"class"});_computedClass=L(()=>le("flex flex-col gap-2 p-2",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["","hlmSidebarFooter",""],["hlm-sidebar-footer"]],hostAttrs:["data-slot","sidebar-footer","data-sidebar","footer"],hostVars:2,hostBindings:function(n,o){n&2&&ce(o._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var em=(()=>{class e{userClass=M("",{alias:"class"});_computedClass=L(()=>le("relative flex w-full min-w-0 flex-col p-2",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["","hlmSidebarGroup",""],["hlm-sidebar-group"]],hostAttrs:["data-slot","sidebar-group","data-sidebar","group"],hostVars:2,hostBindings:function(n,o){n&2&&ce(o._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var tm=(()=>{class e{userClass=M("",{alias:"class"});_computedClass=L(()=>le("w-full text-sm",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["div","hlmSidebarGroupContent",""]],hostAttrs:["data-slot","sidebar-group-content","data-sidebar","group-content"],hostVars:2,hostBindings:function(n,o){n&2&&ce(o._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var im=(()=>{class e{userClass=M("",{alias:"class"});_computedClass=L(()=>le("text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium transition-[margin,opa] duration-200 ease-linear outline-none focus-visible:ring-2 [&>_ng-icon]:size-4 [&>_ng-icon]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["div","hlmSidebarGroupLabel",""],["button","hlmSidebarGroupLabel",""]],hostAttrs:["data-slot","sidebar-group-label","data-sidebar","group-label"],hostVars:2,hostBindings:function(n,o){n&2&&ce(o._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var nm=(()=>{class e{userClass=M("",{alias:"class"});_computedClass=L(()=>le("flex flex-col gap-2 p-2",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["","hlmSidebarHeader",""],["hlm-sidebar-header"]],hostAttrs:["data-slot","sidebar-header","data-sidebar","header"],hostVars:2,hostBindings:function(n,o){n&2&&ce(o._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var om=(()=>{class e{userClass=M("",{alias:"class"});_computedClass=L(()=>le("bg-background relative flex w-full flex-1 flex-col","md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["main","hlmSidebarInset",""]],hostAttrs:["data-slot","sidebar-inset"],hostVars:2,hostBindings:function(n,o){n&2&&ce(o._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var rm=(()=>{class e{userClass=M("",{alias:"class"});_computedClass=L(()=>le("flex w-full min-w-0 flex-col gap-1",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["ul","hlmSidebarMenu",""]],hostAttrs:["data-slot","sidebar-menu","data-sidebar","menu"],hostVars:2,hostBindings:function(n,o){n&2&&ce(o._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var d4=["tooltip"];function u4(e,t){if(e&1&&F(0),e&2){let i=I();de(" ",i.content," ")}}function h4(e,t){if(e&1&&Mn(0,2),e&2){let i=I();U("ngTemplateOutlet",i.content)}}var p4=(()=>{class e{tooltipTemplate=J(null);static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["","brnTooltip",""]]})}return e})(),g4=(()=>{class e{_cdr=k(Tn);_isBrowser=Pr(k(xr));_renderer2=k(Fo);_contentHovered=J(!1);tooltipClasses=J("");side=J("above");content=null;_showTimeoutId;_hideTimeoutId;_animateTimeoutId;triggerElement;mouseLeaveHideDelay=0;exitAnimationDuration=0;tooltip=jn("tooltip",{read:Je});_closeOnInteraction=!1;_isVisible=!1;_onHide=new qe;afterHidden=this._onHide.asObservable();show(i){this._hideTimeoutId!==null&&clearTimeout(this._hideTimeoutId),this._animateTimeoutId!==null&&clearTimeout(this._animateTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleDataAttributes(!0,this.side()),this._toggleVisibility(!0),this._showTimeoutId=void 0},i)}hide(i,n){this._showTimeoutId!==null&&clearTimeout(this._showTimeoutId),this._animateTimeoutId=setTimeout(()=>{this._animateTimeoutId=void 0,!this._contentHovered()&&this._toggleDataAttributes(!1,this.side())},Math.max(i,0)),this._hideTimeoutId=setTimeout(()=>{this._hideTimeoutId=void 0,!this._contentHovered()&&this._toggleVisibility(!1)},i+n)}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this.triggerElement=void 0}_isTypeOfString(i){return typeof i=="string"}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0,0)}_markForCheck(){this._cdr.markForCheck()}_handleMouseLeave({relatedTarget:i}){(!i||!this.triggerElement?.contains(i))&&(this.isVisible()?this.hide(this.mouseLeaveHideDelay,this.exitAnimationDuration):this._finalize(!1)),this._contentHovered.set(!1)}_cancelPendingAnimations(){this._showTimeoutId!==null&&clearTimeout(this._showTimeoutId),this._hideTimeoutId!==null&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalize(i){i?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(i){let n=this.tooltip()?.nativeElement;!n||!this._isBrowser||(this._renderer2.setStyle(n,"visibility",i?"visible":"hidden"),i?this._renderer2.removeStyle(n,"display"):this._renderer2.setStyle(n,"display","none"),this._isVisible=i)}_toggleDataAttributes(i,n){let o=this.tooltip()?.nativeElement;!o||!this._isBrowser||(this._renderer2.setAttribute(o,"data-side",n),this._renderer2.setAttribute(o,"data-state",i?"open":"closed"))}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["brn-tooltip-content"]],viewQuery:function(n,o){n&1&&$n(o.tooltip,d4,5,Je),n&2&&ii()},hostAttrs:["aria-hidden","true"],hostVars:2,hostBindings:function(n,o){n&1&&V("mouseleave",function(s){return o._handleMouseLeave(s)}),n&2&&jt("zoom",o.isVisible()?1:null)},decls:4,vars:5,consts:[["tooltip",""],[3,"mouseenter","mouseleave"],[3,"ngTemplateOutlet"]],template:function(n,o){if(n&1){let r=xe();S(0,"div",1,0),V("mouseenter",function(){return j(r),K(o._contentHovered.set(!0))})("mouseleave",function(){return j(r),K(o._contentHovered.set(!1))}),ve(2,u4,1,1)(3,h4,1,1,"ng-container",2),x()}n&2&&(ce(o.tooltipClasses()),jt("visibility","hidden"),E(2),Ce(o._isTypeOfString(o.content)?2:3))},dependencies:[Ps],encapsulation:2,changeDetection:0})}return e})();var sm={showDelay:0,hideDelay:0,exitAnimationDuration:0,touchendHideDelay:1500},hS=new bt("brn-tooltip-default-options",{providedIn:"root",factory:()=>sm});function pS(e){return{provide:hS,useValue:b(b({},sm),e)}}function f4(){return k(hS,{optional:!0})??sm}var m4=20;function dS(e){return Error(`Tooltip position "${e}" is invalid.`)}var gS=new bt("brn-tooltip-scroll-strategy"),v4={provide:gS,deps:[jf],useFactory:e=>()=>e.scrollStrategies.reposition({scrollThrottle:m4})},C4="tooltip-panel",uS=_y({passive:!0}),w4=500,b4=8,y4=8,fS=(()=>{class e{_tooltipDirective=k(p4,{optional:!0});_tooltipComponent=g4;_cssClassPrefix="brn";_destroyed=new qe;_passiveListeners=[];_defaultOptions=f4();_overlay=k(jf);_elementRef=k(Je);_scrollDispatcher=k(bu);_viewContainerRef=k(Er);_ngZone=k(di);_platform=k(Cu);_ariaDescriber=k(Ky);_focusMonitor=k(yu);_dir=k(Ds);_scrollStrategy=k(gS);_document=k(Li);_portal;_viewInitialized=!1;_pointerExitEventsInitialized=!1;_viewportMargin=8;_currentPosition;_touchstartTimeout;_overlayRef=null;_tooltipInstance=null;position=M(this._defaultOptions?.position??"above");positionAtOrigin=M(this._defaultOptions?.positionAtOrigin??!1,{transform:D});brnTooltipDisabled=M(!1,{transform:D});showDelay=M(this._defaultOptions?.showDelay??0,{transform:Fn});hideDelay=M(this._defaultOptions?.hideDelay??0,{transform:Fn});exitAnimationDuration=M(this._defaultOptions?.exitAnimationDuration??0,{transform:Fn});tooltipContentClasses=M(this._defaultOptions?.tooltipContentClasses??"",{alias:"tooltipContentClasses"});computedTooltipContentClasses=L(()=>J(this.tooltipContentClasses()));touchGestures=M(this._defaultOptions?.touchGestures??"auto");ariaDescribedBy=M("",{alias:"aria-describedby"});computedAriaDescribedBy=L(()=>J(this.ariaDescribedBy()));ariaDescribedByPrevious=Ry(this.computedAriaDescribedBy);brnTooltipTrigger=M(null);brnTooltipTriggerState=L(()=>this._tooltipDirective?this._tooltipDirective.tooltipTemplate():this.brnTooltipTrigger());constructor(){this._dir.change.pipe(lt(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)}),this._viewportMargin=b4,this._initBrnTooltipTriggerEffect(),this._initAriaDescribedByPreviousEffect(),this._initTooltipContentClassesEffect(),this._initPositionEffect(),this._initPositionAtOriginEffect(),this._initBrnTooltipDisabledEffect(),this._initExitAnimationDurationEffect(),this._initHideDelayEffect()}setTooltipContentClasses(i){this.computedTooltipContentClasses().set(i)}setAriaDescribedBy(i){this.computedAriaDescribedBy().set(i)}_initPositionEffect(){_e(()=>{this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition())})}_initBrnTooltipDisabledEffect(){_e(()=>{this.brnTooltipDisabled()?this.hide(0):this._setupPointerEnterEventsIfNeeded()})}_initPositionAtOriginEffect(){_e(()=>{let i=this.positionAtOrigin();this._detach(),this._overlayRef=null})}_initTooltipContentClassesEffect(){_e(()=>{this._tooltipInstance&&this._tooltipInstance.tooltipClasses.set(this.computedTooltipContentClasses()()??"")})}_initAriaDescribedByPreviousEffect(){_e(()=>{let i=this.computedAriaDescribedBy()();this._ariaDescriber.removeDescription(this._elementRef.nativeElement,Oi(()=>this.ariaDescribedByPrevious()()),"tooltip"),i&&!this._isTooltipVisible()&&this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriber.describe(this._elementRef.nativeElement,i,"tooltip")})})})}_initBrnTooltipTriggerEffect(){_e(()=>{let i=this.brnTooltipTriggerState(),n=this._isTooltipVisible();Oi(()=>{!i&&n?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipContent())})})}_initExitAnimationDurationEffect(){_e(()=>{this._tooltipInstance&&(this._tooltipInstance.exitAnimationDuration=this.exitAnimationDuration())})}_initHideDelayEffect(){_e(()=>{this._tooltipInstance&&(this._tooltipInstance.mouseLeaveHideDelay=this.hideDelay())})}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(lt(this._destroyed)).subscribe(i=>{i?i==="keyboard"&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))}),My&&!this.computedAriaDescribedBy()&&console.warn('BrnTooltip: "aria-describedby" attribute is required for accessibility')}ngOnDestroy(){let i=this._elementRef.nativeElement;clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([n,o])=>i.removeEventListener(n,o,uS)),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(i,this.computedAriaDescribedBy()(),"tooltip"),this._focusMonitor.stopMonitoring(i)}show(i=this.showDelay(),n){if(this.brnTooltipDisabled()||this._isTooltipVisible()){this._tooltipInstance?._cancelPendingAnimations();return}let o=this._createOverlay(n);this._detach(),this._portal=this._portal||new Cy(this._tooltipComponent,this._viewContainerRef);let r=this._tooltipInstance=o.attach(this._portal).instance;r.triggerElement=this._elementRef.nativeElement,r.mouseLeaveHideDelay=this.hideDelay(),r.tooltipClasses.set(this.computedTooltipContentClasses()()),r.exitAnimationDuration=this.exitAnimationDuration(),r.side.set(this._currentPosition??"above"),r.afterHidden.pipe(lt(this._destroyed)).subscribe(()=>this._detach()),this._updateTooltipContent(),r.show(i)}hide(i=this.hideDelay(),n=this.exitAnimationDuration()){let o=this._tooltipInstance;o&&(o.isVisible()?o.hide(i,n):(o._cancelPendingAnimations(),this._detach()))}toggle(i){this._isTooltipVisible()?this.hide():this.show(void 0,i)}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(i){if(this._overlayRef){let r=this._overlayRef.getConfig().positionStrategy;if((!this.positionAtOrigin()||!i)&&r._origin instanceof Je)return this._overlayRef;this._detach()}let n=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),o=this._overlay.position().flexibleConnectedTo(this.positionAtOrigin()?i||this._elementRef:this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(n);return o.positionChanges.pipe(lt(this._destroyed)).subscribe(r=>{this._updateCurrentPositionClass(r.connectionPair),this._tooltipInstance&&r.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:o,panelClass:`${this._cssClassPrefix}-${C4}`,scrollStrategy:this._scrollStrategy()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(lt(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(lt(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(lt(this._destroyed)).subscribe(r=>{this._isTooltipVisible()&&r.key==="Escape"&&!by(r)&&(r.preventDefault(),r.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._overlayRef}_detach(){this._overlayRef?.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(i){let n=i.getConfig().positionStrategy,o=this._getOrigin(),r=this._getOverlayPosition();n.withPositions([this._addOffset(b(b({},o.main),r.main)),this._addOffset(b(b({},o.fallback),r.fallback))])}_addOffset(i){let n=y4,o=!this._dir||this._dir.value==="ltr";return i.originY==="top"?i.offsetY=-n:i.originY==="bottom"?i.offsetY=n:i.originX==="start"?i.offsetX=o?-n:n:i.originX==="end"&&(i.offsetX=o?n:-n),i}_getOrigin(){let i=!this._dir||this._dir.value==="ltr",n=this.position(),o;if(n==="above"||n==="below")o={originX:"center",originY:n==="above"?"top":"bottom"};else if(n==="before"||n==="left"&&i||n==="right"&&!i)o={originX:"start",originY:"center"};else if(n==="after"||n==="right"&&i||n==="left"&&!i)o={originX:"end",originY:"center"};else if(typeof rc()>"u"||rc())throw dS(n);let{x:r,y:s}=this._invertPosition(o.originX,o.originY);return{main:o,fallback:{originX:r,originY:s}}}_getOverlayPosition(){let i=!this._dir||this._dir.value==="ltr",n=this.position(),o;if(n==="above")o={overlayX:"center",overlayY:"bottom"};else if(n==="below")o={overlayX:"center",overlayY:"top"};else if(n==="before"||n==="left"&&i||n==="right"&&!i)o={overlayX:"end",overlayY:"center"};else if(n==="after"||n==="right"&&i||n==="left"&&!i)o={overlayX:"start",overlayY:"center"};else if(typeof rc()>"u"||rc())throw dS(n);let{x:r,y:s}=this._invertPosition(o.overlayX,o.overlayY);return{main:o,fallback:{overlayX:r,overlayY:s}}}_updateTooltipContent(){this._tooltipInstance&&(this._tooltipInstance.content=this.brnTooltipTriggerState(),this._tooltipInstance._markForCheck(),this._ngZone.onMicrotaskEmpty.pipe(Ea(1),lt(this._destroyed)).subscribe(()=>{this._tooltipInstance&&this._overlayRef?.updatePosition()}))}_invertPosition(i,n){return this.position()==="above"||this.position()==="below"?n==="top"?n="bottom":n==="bottom"&&(n="top"):i==="end"?i="start":i==="start"&&(i="end"),{x:i,y:n}}_updateCurrentPositionClass(i){let{overlayY:n,originX:o,originY:r}=i,s;n==="center"?this._dir&&this._dir.value==="rtl"?s=o==="end"?"left":"right":s=o==="start"?"left":"right":s=n==="bottom"&&r==="top"?"above":"below",s!==this._currentPosition&&(this._tooltipInstance?.side.set(s),this._currentPosition=s)}_setupPointerEnterEventsIfNeeded(){this.brnTooltipDisabled()||!this.brnTooltipTriggerState()||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",i=>{this._setupPointerExitEventsIfNeeded();let n;i.x!==void 0&&i.y!==void 0&&(n=i),this.show(void 0,n)}]):this.touchGestures()!=="off"&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",i=>{let n=i.targetTouches?.[0],o=n?{x:n.clientX,y:n.clientY}:void 0;this._setupPointerExitEventsIfNeeded(),clearTimeout(this._touchstartTimeout),this._touchstartTimeout=setTimeout(()=>this.show(void 0,o),w4)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;let i=[];if(this._platformSupportsMouseEvents())i.push(["mouseleave",n=>{let o=n.relatedTarget;(!o||!this._overlayRef?.overlayElement.contains(o))&&this.hide()}],["wheel",n=>this._wheelListener(n)]);else if(this.touchGestures()!=="off"){this._disableNativeGesturesIfNecessary();let n=()=>{clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions?.touchendHideDelay)};i.push(["touchend",n],["touchcancel",n])}this._addListeners(i),this._passiveListeners.push(...i)}_addListeners(i){i.forEach(([n,o])=>{this._elementRef.nativeElement.addEventListener(n,o,uS)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(i){if(this._isTooltipVisible()){let n=this._document.elementFromPoint(i.clientX,i.clientY),o=this._elementRef.nativeElement;n!==o&&!o.contains(n)&&this.hide()}}_disableNativeGesturesIfNecessary(){let i=this.touchGestures();if(i!=="off"){let n=this._elementRef.nativeElement,o=n.style;(i==="on"||n.nodeName!=="INPUT"&&n.nodeName!=="TEXTAREA")&&(o.userSelect=o.msUserSelect=o.webkitUserSelect=o.MozUserSelect="none"),(i==="on"||!n.draggable)&&(o.webkitUserDrag="none"),o.touchAction="none",o.webkitTapHighlightColor="transparent"}}static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["","brnTooltipTrigger",""]],hostAttrs:[1,"brn-tooltip-trigger"],hostVars:2,hostBindings:function(n,o){n&2&&dt("brn-tooltip-disabled",o.brnTooltipDisabled())},inputs:{position:[1,"position"],positionAtOrigin:[1,"positionAtOrigin"],brnTooltipDisabled:[1,"brnTooltipDisabled"],showDelay:[1,"showDelay"],hideDelay:[1,"hideDelay"],exitAnimationDuration:[1,"exitAnimationDuration"],tooltipContentClasses:[1,"tooltipContentClasses"],touchGestures:[1,"touchGestures"],ariaDescribedBy:[1,"aria-describedby","ariaDescribedBy"],brnTooltipTrigger:[1,"brnTooltipTrigger"]},exportAs:["brnTooltipTrigger"],features:[ue([v4])]})}return e})();var mS="bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 z-50 w-fit rounded-md px-3 py-1.5 text-xs text-balance data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=below]:slide-in-from-top-2 data-[side=above]:slide-in-from-bottom-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 ";var x4=Da("peer/menu-button ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground flex w-full items-center justify-start gap-2 overflow-hidden rounded-md p-2 text-left text-sm transition-[width,height,padding] outline-none group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 hover:cursor-pointer focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 disabled:hover:cursor-default aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium [&>_ng-icon]:size-4 [&>_ng-icon]:shrink-0 group-data-[collapsible=icon]:[&>span]:hidden [&>span:last-child]:truncate",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-sidebar-border hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-sidebar-accent"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),am=(()=>{class e{_sidebarService=k(Ms);variant=M("default");size=M("default");isActive=M(!1,{transform:D});userClass=M("",{alias:"class"});_isTooltipHidden=L(()=>this._sidebarService.state()!=="collapsed"||this._sidebarService.isMobile());_computedClass=L(()=>le(x4({variant:this.variant(),size:this.size()}),this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["button","hlmSidebarMenuButton",""],["a","hlmSidebarMenuButton",""]],hostAttrs:["data-slot","sidebar-menu-button","data-sidebar","menu-button"],hostVars:4,hostBindings:function(n,o){n&2&&(Qe("data-size",o.size())("data-active",o.isActive()),ce(o._computedClass()))},inputs:{variant:[1,"variant"],size:[1,"size"],isActive:[1,"isActive"],userClass:[1,"class","userClass"]},features:[ue([pS({showDelay:150,hideDelay:0,exitAnimationDuration:150,tooltipContentClasses:mS,position:"left"})]),$i([{directive:fS,inputs:["brnTooltipTrigger","tooltip","aria-describedby","aria-describedby"]}])]})}return e})();var lm=(()=>{class e{userClass=M("",{alias:"class"});_computedClass=L(()=>le("group/menu-item relative",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["li","hlmSidebarMenuItem",""]],hostAttrs:["data-slot","sidebar-menu-item","data-sidebar","menu-item"],hostVars:2,hostBindings:function(n,o){n&2&&ce(o._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var R4={orientation:"horizontal"},P4=new bt("BrnSeparatorConfig");function D4(){return k(P4,{optional:!0})??R4}var vS=(()=>{class e{_config=D4();orientation=M(this._config.orientation);decorative=M(!0,{transform:D});_role=L(()=>this.decorative()?"none":"separator");_ariaOrientation=L(()=>this.decorative()?void 0:this.orientation()==="vertical"?"vertical":void 0);static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["","brnSeparator",""],["brn-separator"]],hostVars:3,hostBindings:function(n,o){n&2&&(ji("role",o._role()),Qe("aria-orientation",o._ariaOrientation())("data-orientation",o.orientation()))},inputs:{orientation:[1,"orientation"],decorative:[1,"decorative"]}})}return e})();var k4="bg-border inline-flex shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",Fr=(()=>{class e{userClass=M("",{alias:"class"});_computedClass=L(()=>le(k4,this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["","hlmSeparator",""],["hlm-separator"]],hostVars:2,hostBindings:function(n,o){n&2&&ce(o._computedClass())},inputs:{userClass:[1,"class","userClass"]},features:[$i([{directive:vS,inputs:["orientation","orientation","decorative","decorative"]}])]})}return e})();var T4=["hlmSidebarTrigger",""],cm=(()=>{class e{_hlmBtn=k(Ze);_sidebarService=k(Ms);constructor(){this._hlmBtn.setClass("size-7")}_onClick(){this._sidebarService.toggleSidebar()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["button","hlmSidebarTrigger",""]],hostAttrs:["data-slot","sidebar-trigger","data-sidebar","trigger"],hostBindings:function(n,o){n&1&&V("click",function(){return o._onClick()})},features:[ue([nt({lucidePanelLeft:iy}),I1({variant:"ghost",size:"icon"})]),$i([Ze])],attrs:T4,decls:1,vars:0,consts:[["hlm","","name","lucidePanelLeft","size","sm"]],template:function(n,o){n&1&&H(0,"ng-icon",0)},dependencies:[We,ot],encapsulation:2,changeDetection:0})}return e})();var dm=(()=>{class e{_config=Oa();userClass=M("",{alias:"class"});_computedClass=L(()=>le("group/sidebar-wrapper has-[[data-variant=inset]]:bg-sidebar flex min-h-svh w-full",this.userClass()));sidebarWidth=M(this._config.sidebarWidth);sidebarWidthIcon=M(this._config.sidebarWidthIcon);static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["","hlmSidebarWrapper",""],["hlm-sidebar-wrapper"]],hostAttrs:["data-slot","sidebar-wrapper"],hostVars:6,hostBindings:function(n,o){n&2&&(ce(o._computedClass()),jt("--sidebar-width",o.sidebarWidth())("--sidebar-width-icon",o.sidebarWidthIcon()))},inputs:{userClass:[1,"class","userClass"],sidebarWidth:[1,"sidebarWidth"],sidebarWidthIcon:[1,"sidebarWidthIcon"]}})}return e})();var I4=(e,t)=>t.path;function A4(e,t){if(e&1&&(S(0,"li",5)(1,"a",17),H(2,"ng-icon",18),S(3,"span"),F(4),O(5,"transloco"),x()()()),e&2){let i=t.$implicit;E(),U("routerLink",i.path),E(),U("name",i.icon),E(2),we(N(5,3,i.label))}}var CS=(()=>{class e{navigationItems=[{path:"dashboard",label:"homeDocumentation.nav.dashboard",icon:"lucideHouse"},{path:"house-plans",label:"homeDocumentation.nav.housePlans",icon:"lucideSquareDashedBottom"},{path:"wall-structures",label:"homeDocumentation.nav.wallStructures",icon:"lucideConstruction"},{path:"flexible-items",label:"homeDocumentation.nav.flexibleItems",icon:"lucidePackage"}];static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["gh-home-shell"]],features:[ue([nt({lucideHouse:K1,lucideConstruction:U1,lucideSquareDashedBottom:cy,lucidePackage:ty})])],decls:33,vars:12,consts:[[1,"border-b"],[1,"px-4","py-2","text-lg","font-semibold"],["hlmSidebarGroupLabel",""],["hlmSidebarGroupContent",""],["hlmSidebarMenu",""],["hlmSidebarMenuItem",""],[1,"border-t","p-2"],[1,"px-2","text-xs","text-muted-foreground"],["hlmSidebarRail",""],["hlmSidebarInset",""],[1,"sticky","top-0","z-10","flex","h-14","shrink-0","items-center","gap-2","border-b","bg-background","px-4"],["hlmSidebarTrigger",""],[1,"sr-only"],[1,"flex-1"],[1,"text-lg","font-semibold"],[1,"flex","items-center","gap-2"],[1,"flex-1","overflow-auto"],["hlmSidebarMenuButton","","routerLinkActive","bg-sidebar-accent text-sidebar-accent-foreground",3,"routerLink"],["hlm","","size","sm",3,"name"]],template:function(n,o){n&1&&(S(0,"hlm-sidebar-wrapper")(1,"hlm-sidebar")(2,"hlm-sidebar-header",0)(3,"h2",1),F(4),O(5,"transloco"),x()(),S(6,"hlm-sidebar-content")(7,"hlm-sidebar-group")(8,"div",2),F(9),O(10,"transloco"),x(),S(11,"div",3)(12,"ul",4),ei(13,A4,6,5,"li",5,I4),x()()()(),S(15,"hlm-sidebar-footer",6)(16,"p",7),F(17),O(18,"transloco"),x()(),H(19,"div",8),x(),S(20,"main",9)(21,"header",10)(22,"button",11)(23,"span",12),F(24,"Toggle Sidebar"),x()(),S(25,"div",13)(26,"h1",14),F(27),O(28,"transloco"),x()(),S(29,"div",15),H(30,"gh-user-avatar"),x()(),S(31,"main",16),H(32,"router-outlet"),x()()()),n&2&&(E(4),de(" ",N(5,4,"homeDocumentation.title")," "),E(5),de(" ",N(10,6,"homeDocumentation.nav.navigation")," "),E(4),ti(o.navigationItems),E(4),de(" ",N(18,8,"homeDocumentation.nav.footer")," "),E(10),we(N(28,10,"homeDocumentation.title")))},dependencies:[ui,T1,D1,M1,k1,Yt,Wy,Jf,Qf,Zf,em,tm,im,nm,om,rm,am,lm,cm,dm,We,ot,Kt],encapsulation:2,changeDetection:0})}return e})();function L4(e,t){if(e&1&&(Pn(0,"p",1),F(1),Dn()),e&2){let i=I();E(),we(i.description())}}var eo=(()=>{class e{title=M.required();description=M("");static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["gh-section-header"]],inputs:{title:[1,"title"],description:[1,"description"]},decls:4,vars:2,consts:[[1,"text-2xl","font-bold"],[1,"text-muted-foreground","mt-1"]],template:function(n,o){n&1&&(Pn(0,"div")(1,"h2",0),F(2),Dn(),ve(3,L4,2,1,"p",1),Dn()),n&2&&(E(2),we(o.title()),E(),Ce(o.description()?3:-1))},encapsulation:2,changeDetection:0})}return e})();function hi(e){this.content=e}hi.prototype={constructor:hi,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return t==-1?void 0:this.content[t+1]},update:function(e,t,i){var n=i&&i!=e?this.remove(i):this,o=n.find(e),r=n.content.slice();return o==-1?r.push(i||e,t):(r[o+1]=t,i&&(r[o]=i)),new hi(r)},remove:function(e){var t=this.find(e);if(t==-1)return this;var i=this.content.slice();return i.splice(t,2),new hi(i)},addToStart:function(e,t){return new hi([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var i=this.remove(e).content.slice();return i.push(e,t),new hi(i)},addBefore:function(e,t,i){var n=this.remove(t),o=n.content.slice(),r=n.find(e);return o.splice(r==-1?o.length:r,0,t,i),new hi(o)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return e=hi.from(e),e.size?new hi(e.content.concat(this.subtract(e).content)):this},append:function(e){return e=hi.from(e),e.size?new hi(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=hi.from(e);for(var i=0;i<e.content.length;i+=2)t=t.remove(e.content[i]);return t},toObject:function(){var e={};return this.forEach(function(t,i){e[t]=i}),e},get size(){return this.content.length>>1}};hi.from=function(e){if(e instanceof hi)return e;var t=[];if(e)for(var i in e)t.push(i,e[i]);return new hi(t)};var um=hi;function DS(e,t,i){for(let n=0;;n++){if(n==e.childCount||n==t.childCount)return e.childCount==t.childCount?null:i;let o=e.child(n),r=t.child(n);if(o==r){i+=o.nodeSize;continue}if(!o.sameMarkup(r))return i;if(o.isText&&o.text!=r.text){for(let s=0;o.text[s]==r.text[s];s++)i++;return i}if(o.content.size||r.content.size){let s=DS(o.content,r.content,i+1);if(s!=null)return s}i+=o.nodeSize}}function MS(e,t,i,n){for(let o=e.childCount,r=t.childCount;;){if(o==0||r==0)return o==r?null:{a:i,b:n};let s=e.child(--o),a=t.child(--r),l=s.nodeSize;if(s==a){i-=l,n-=l;continue}if(!s.sameMarkup(a))return{a:i,b:n};if(s.isText&&s.text!=a.text){let c=0,d=Math.min(s.text.length,a.text.length);for(;c<d&&s.text[s.text.length-c-1]==a.text[a.text.length-c-1];)c++,i--,n--;return{a:i,b:n}}if(s.content.size||a.content.size){let c=MS(s.content,a.content,i-1,n-1);if(c)return c}i-=l,n-=l}}var Y=class e{constructor(t,i){if(this.content=t,this.size=i||0,i==null)for(let n=0;n<t.length;n++)this.size+=t[n].nodeSize}nodesBetween(t,i,n,o=0,r){for(let s=0,a=0;a<i;s++){let l=this.content[s],c=a+l.nodeSize;if(c>t&&n(l,o+a,r||null,s)!==!1&&l.content.size){let d=a+1;l.nodesBetween(Math.max(0,t-d),Math.min(l.content.size,i-d),n,o+d)}a=c}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,i,n,o){let r="",s=!0;return this.nodesBetween(t,i,(a,l)=>{let c=a.isText?a.text.slice(Math.max(t,l)-l,i-l):a.isLeaf?o?typeof o=="function"?o(a):o:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&n&&(s?s=!1:r+=n),r+=c},0),r}append(t){if(!t.size)return this;if(!this.size)return t;let i=this.lastChild,n=t.firstChild,o=this.content.slice(),r=0;for(i.isText&&i.sameMarkup(n)&&(o[o.length-1]=i.withText(i.text+n.text),r=1);r<t.content.length;r++)o.push(t.content[r]);return new e(o,this.size+t.size)}cut(t,i=this.size){if(t==0&&i==this.size)return this;let n=[],o=0;if(i>t)for(let r=0,s=0;s<i;r++){let a=this.content[r],l=s+a.nodeSize;l>t&&((s<t||l>i)&&(a.isText?a=a.cut(Math.max(0,t-s),Math.min(a.text.length,i-s)):a=a.cut(Math.max(0,t-s-1),Math.min(a.content.size,i-s-1))),n.push(a),o+=a.nodeSize),s=l}return new e(n,o)}cutByIndex(t,i){return t==i?e.empty:t==0&&i==this.content.length?this:new e(this.content.slice(t,i))}replaceChild(t,i){let n=this.content[t];if(n==i)return this;let o=this.content.slice(),r=this.size+i.nodeSize-n.nodeSize;return o[t]=i,new e(o,r)}addToStart(t){return new e([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new e(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let i=0;i<this.content.length;i++)if(!this.content[i].eq(t.content[i]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let i=this.content[t];if(!i)throw new RangeError("Index "+t+" out of range for "+this);return i}maybeChild(t){return this.content[t]||null}forEach(t){for(let i=0,n=0;i<this.content.length;i++){let o=this.content[i];t(o,n,i),n+=o.nodeSize}}findDiffStart(t,i=0){return DS(this,t,i)}findDiffEnd(t,i=this.size,n=t.size){return MS(this,t,i,n)}findIndex(t){if(t==0)return Du(0,t);if(t==this.size)return Du(this.content.length,t);if(t>this.size||t<0)throw new RangeError(`Position ${t} outside of fragment (${this})`);for(let i=0,n=0;;i++){let o=this.child(i),r=n+o.nodeSize;if(r>=t)return r==t?Du(i+1,r):Du(i,n);n=r}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(t=>t.toJSON()):null}static fromJSON(t,i){if(!i)return e.empty;if(!Array.isArray(i))throw new RangeError("Invalid input for Fragment.fromJSON");return new e(i.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return e.empty;let i,n=0;for(let o=0;o<t.length;o++){let r=t[o];n+=r.nodeSize,o&&r.isText&&t[o-1].sameMarkup(r)?(i||(i=t.slice(0,o)),i[i.length-1]=r.withText(i[i.length-1].text+r.text)):i&&i.push(r)}return new e(i||t,n)}static from(t){if(!t)return e.empty;if(t instanceof e)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new e([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}};Y.empty=new Y([],0);var hm={index:0,offset:0};function Du(e,t){return hm.index=e,hm.offset=t,hm}function ku(e,t){if(e===t)return!0;if(!(e&&typeof e=="object")||!(t&&typeof t=="object"))return!1;let i=Array.isArray(e);if(Array.isArray(t)!=i)return!1;if(i){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!ku(e[n],t[n]))return!1}else{for(let n in e)if(!(n in t)||!ku(e[n],t[n]))return!1;for(let n in t)if(!(n in e))return!1}return!0}var it=(()=>{class e{constructor(i,n){this.type=i,this.attrs=n}addToSet(i){let n,o=!1;for(let r=0;r<i.length;r++){let s=i[r];if(this.eq(s))return i;if(this.type.excludes(s.type))n||(n=i.slice(0,r));else{if(s.type.excludes(this.type))return i;!o&&s.type.rank>this.type.rank&&(n||(n=i.slice(0,r)),n.push(this),o=!0),n&&n.push(s)}}return n||(n=i.slice()),o||n.push(this),n}removeFromSet(i){for(let n=0;n<i.length;n++)if(this.eq(i[n]))return i.slice(0,n).concat(i.slice(n+1));return i}isInSet(i){for(let n=0;n<i.length;n++)if(this.eq(i[n]))return!0;return!1}eq(i){return this==i||this.type==i.type&&ku(this.attrs,i.attrs)}toJSON(){let i={type:this.type.name};for(let n in this.attrs){i.attrs=this.attrs;break}return i}static fromJSON(i,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let o=i.marks[n.type];if(!o)throw new RangeError(`There is no mark type ${n.type} in this schema`);let r=o.create(n.attrs);return o.checkAttrs(r.attrs),r}static sameSet(i,n){if(i==n)return!0;if(i.length!=n.length)return!1;for(let o=0;o<i.length;o++)if(!i[o].eq(n[o]))return!1;return!0}static setFrom(i){if(!i||Array.isArray(i)&&i.length==0)return e.none;if(i instanceof e)return[i];let n=i.slice();return n.sort((o,r)=>o.type.rank-r.type.rank),n}}return e.none=[],e})(),Fs=class extends Error{},ae=class e{constructor(t,i,n){this.content=t,this.openStart=i,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,i){let n=TS(this.content,t+this.openStart,i);return n&&new e(n,this.openStart,this.openEnd)}removeBetween(t,i){return new e(kS(this.content,t+this.openStart,i+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,i){if(!i)return e.empty;let n=i.openStart||0,o=i.openEnd||0;if(typeof n!="number"||typeof o!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new e(Y.fromJSON(t,i.content),n,o)}static maxOpen(t,i=!0){let n=0,o=0;for(let r=t.firstChild;r&&!r.isLeaf&&(i||!r.type.spec.isolating);r=r.firstChild)n++;for(let r=t.lastChild;r&&!r.isLeaf&&(i||!r.type.spec.isolating);r=r.lastChild)o++;return new e(t,n,o)}};ae.empty=new ae(Y.empty,0,0);function kS(e,t,i){let{index:n,offset:o}=e.findIndex(t),r=e.maybeChild(n),{index:s,offset:a}=e.findIndex(i);if(o==t||r.isText){if(a!=i&&!e.child(s).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(i))}if(n!=s)throw new RangeError("Removing non-flat range");return e.replaceChild(n,r.copy(kS(r.content,t-o-1,i-o-1)))}function TS(e,t,i,n){let{index:o,offset:r}=e.findIndex(t),s=e.maybeChild(o);if(r==t||s.isText)return n&&!n.canReplace(o,o,i)?null:e.cut(0,t).append(i).append(e.cut(t));let a=TS(s.content,t-r-1,i,s);return a&&e.replaceChild(o,s.copy(a))}function O4(e,t,i){if(i.openStart>e.depth)throw new Fs("Inserted content deeper than insertion position");if(e.depth-i.openStart!=t.depth-i.openEnd)throw new Fs("Inconsistent open depths");return FS(e,t,i,0)}function FS(e,t,i,n){let o=e.index(n),r=e.node(n);if(o==t.index(n)&&n<e.depth-i.openStart){let s=FS(e,t,i,n+1);return r.copy(r.content.replaceChild(o,s))}else if(i.content.size)if(!i.openStart&&!i.openEnd&&e.depth==n&&t.depth==n){let s=e.parent,a=s.content;return Ts(s,a.cut(0,e.parentOffset).append(i.content).append(a.cut(t.parentOffset)))}else{let{start:s,end:a}=N4(i,e);return Ts(r,AS(e,s,a,t,n))}else return Ts(r,Tu(e,t,n))}function IS(e,t){if(!t.type.compatibleContent(e.type))throw new Fs("Cannot join "+t.type.name+" onto "+e.type.name)}function gm(e,t,i){let n=e.node(i);return IS(n,t.node(i)),n}function ks(e,t){let i=t.length-1;i>=0&&e.isText&&e.sameMarkup(t[i])?t[i]=e.withText(t[i].text+e.text):t.push(e)}function hc(e,t,i,n){let o=(t||e).node(i),r=0,s=t?t.index(i):o.childCount;e&&(r=e.index(i),e.depth>i?r++:e.textOffset&&(ks(e.nodeAfter,n),r++));for(let a=r;a<s;a++)ks(o.child(a),n);t&&t.depth==i&&t.textOffset&&ks(t.nodeBefore,n)}function Ts(e,t){return e.type.checkContent(t),e.copy(t)}function AS(e,t,i,n,o){let r=e.depth>o&&gm(e,t,o+1),s=n.depth>o&&gm(i,n,o+1),a=[];return hc(null,e,o,a),r&&s&&t.index(o)==i.index(o)?(IS(r,s),ks(Ts(r,AS(e,t,i,n,o+1)),a)):(r&&ks(Ts(r,Tu(e,t,o+1)),a),hc(t,i,o,a),s&&ks(Ts(s,Tu(i,n,o+1)),a)),hc(n,null,o,a),new Y(a)}function Tu(e,t,i){let n=[];if(hc(null,e,i,n),e.depth>i){let o=gm(e,t,i+1);ks(Ts(o,Tu(e,t,i+1)),n)}return hc(t,null,i,n),new Y(n)}function N4(e,t){let i=t.depth-e.openStart,o=t.node(i).copy(e.content);for(let r=i-1;r>=0;r--)o=t.node(r).copy(Y.from(o));return{start:o.resolveNoCache(e.openStart+i),end:o.resolveNoCache(o.content.size-e.openEnd-i)}}var Fu=class e{constructor(t,i,n){this.pos=t,this.path=i,this.parentOffset=n,this.depth=i.length/3-1}resolveDepth(t){return t==null?this.depth:t<0?this.depth+t:t}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(t){return this.path[this.resolveDepth(t)*3]}index(t){return this.path[this.resolveDepth(t)*3+1]}indexAfter(t){return t=this.resolveDepth(t),this.index(t)+(t==this.depth&&!this.textOffset?0:1)}start(t){return t=this.resolveDepth(t),t==0?0:this.path[t*3-1]+1}end(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size}before(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]}after(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]+this.path[t*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let t=this.parent,i=this.index(this.depth);if(i==t.childCount)return null;let n=this.pos-this.path[this.path.length-1],o=t.child(i);return n?t.child(i).cut(n):o}get nodeBefore(){let t=this.index(this.depth),i=this.pos-this.path[this.path.length-1];return i?this.parent.child(t).cut(0,i):t==0?null:this.parent.child(t-1)}posAtIndex(t,i){i=this.resolveDepth(i);let n=this.path[i*3],o=i==0?0:this.path[i*3-1]+1;for(let r=0;r<t;r++)o+=n.child(r).nodeSize;return o}marks(){let t=this.parent,i=this.index();if(t.content.size==0)return it.none;if(this.textOffset)return t.child(i).marks;let n=t.maybeChild(i-1),o=t.maybeChild(i);if(!n){let a=n;n=o,o=a}let r=n.marks;for(var s=0;s<r.length;s++)r[s].type.spec.inclusive===!1&&(!o||!r[s].isInSet(o.marks))&&(r=r[s--].removeFromSet(r));return r}marksAcross(t){let i=this.parent.maybeChild(this.index());if(!i||!i.isInline)return null;let n=i.marks,o=t.parent.maybeChild(t.index());for(var r=0;r<n.length;r++)n[r].type.spec.inclusive===!1&&(!o||!n[r].isInSet(o.marks))&&(n=n[r--].removeFromSet(n));return n}sharedDepth(t){for(let i=this.depth;i>0;i--)if(this.start(i)<=t&&this.end(i)>=t)return i;return 0}blockRange(t=this,i){if(t.pos<this.pos)return t.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!i||i(this.node(n))))return new Is(this,t,n);return null}sameParent(t){return this.pos-this.parentOffset==t.pos-t.parentOffset}max(t){return t.pos>this.pos?t:this}min(t){return t.pos<this.pos?t:this}toString(){let t="";for(let i=1;i<=this.depth;i++)t+=(t?"/":"")+this.node(i).type.name+"_"+this.index(i-1);return t+":"+this.parentOffset}static resolve(t,i){if(!(i>=0&&i<=t.content.size))throw new RangeError("Position "+i+" out of range");let n=[],o=0,r=i;for(let s=t;;){let{index:a,offset:l}=s.content.findIndex(r),c=r-l;if(n.push(s,a,o+l),!c||(s=s.child(a),s.isText))break;r=c-1,o+=l+1}return new e(i,n,r)}static resolveCached(t,i){let n=wS.get(t);if(n)for(let r=0;r<n.elts.length;r++){let s=n.elts[r];if(s.pos==i)return s}else wS.set(t,n=new fm);let o=n.elts[n.i]=e.resolve(t,i);return n.i=(n.i+1)%B4,o}},fm=class{constructor(){this.elts=[],this.i=0}},B4=12,wS=new WeakMap,Is=class{constructor(t,i,n){this.$from=t,this.$to=i,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}},H4=Object.create(null),Bi=class e{constructor(t,i,n,o=it.none){this.type=t,this.attrs=i,this.marks=o,this.content=n||Y.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(t){return this.content.child(t)}maybeChild(t){return this.content.maybeChild(t)}forEach(t){this.content.forEach(t)}nodesBetween(t,i,n,o=0){this.content.nodesBetween(t,i,n,o,this)}descendants(t){this.nodesBetween(0,this.content.size,t)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(t,i,n,o){return this.content.textBetween(t,i,n,o)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)}sameMarkup(t){return this.hasMarkup(t.type,t.attrs,t.marks)}hasMarkup(t,i,n){return this.type==t&&ku(this.attrs,i||t.defaultAttrs||H4)&&it.sameSet(this.marks,n||it.none)}copy(t=null){return t==this.content?this:new e(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new e(this.type,this.attrs,this.content,t)}cut(t,i=this.content.size){return t==0&&i==this.content.size?this:this.copy(this.content.cut(t,i))}slice(t,i=this.content.size,n=!1){if(t==i)return ae.empty;let o=this.resolve(t),r=this.resolve(i),s=n?0:o.sharedDepth(i),a=o.start(s),c=o.node(s).content.cut(o.pos-a,r.pos-a);return new ae(c,o.depth-s,r.depth-s)}replace(t,i,n){return O4(this.resolve(t),this.resolve(i),n)}nodeAt(t){for(let i=this;;){let{index:n,offset:o}=i.content.findIndex(t);if(i=i.maybeChild(n),!i)return null;if(o==t||i.isText)return i;t-=o+1}}childAfter(t){let{index:i,offset:n}=this.content.findIndex(t);return{node:this.content.maybeChild(i),index:i,offset:n}}childBefore(t){if(t==0)return{node:null,index:0,offset:0};let{index:i,offset:n}=this.content.findIndex(t);if(n<t)return{node:this.content.child(i),index:i,offset:n};let o=this.content.child(i-1);return{node:o,index:i-1,offset:n-o.nodeSize}}resolve(t){return Fu.resolveCached(this,t)}resolveNoCache(t){return Fu.resolve(this,t)}rangeHasMark(t,i,n){let o=!1;return i>t&&this.nodesBetween(t,i,r=>(n.isInSet(r.marks)&&(o=!0),!o)),o}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),LS(this.marks,t)}contentMatchAt(t){let i=this.type.contentMatch.matchFragment(this.content,0,t);if(!i)throw new Error("Called contentMatchAt on a node with invalid content");return i}canReplace(t,i,n=Y.empty,o=0,r=n.childCount){let s=this.contentMatchAt(t).matchFragment(n,o,r),a=s&&s.matchFragment(this.content,i);if(!a||!a.validEnd)return!1;for(let l=o;l<r;l++)if(!this.type.allowsMarks(n.child(l).marks))return!1;return!0}canReplaceWith(t,i,n,o){if(o&&!this.type.allowsMarks(o))return!1;let r=this.contentMatchAt(t).matchType(n),s=r&&r.matchFragment(this.content,i);return s?s.validEnd:!1}canAppend(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let t=it.none;for(let i=0;i<this.marks.length;i++){let n=this.marks[i];n.type.checkAttrs(n.attrs),t=n.addToSet(t)}if(!it.sameSet(t,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(i=>i.type.name)}`);this.content.forEach(i=>i.check())}toJSON(){let t={type:this.type.name};for(let i in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(i=>i.toJSON())),t}static fromJSON(t,i){if(!i)throw new RangeError("Invalid input for Node.fromJSON");let n;if(i.marks){if(!Array.isArray(i.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=i.marks.map(t.markFromJSON)}if(i.type=="text"){if(typeof i.text!="string")throw new RangeError("Invalid text node in JSON");return t.text(i.text,n)}let o=Y.fromJSON(t,i.content),r=t.nodeType(i.type).create(i.attrs,o,n);return r.type.checkAttrs(r.attrs),r}};Bi.prototype.text=void 0;var mm=class e extends Bi{constructor(t,i,n,o){if(super(t,i,null,o),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):LS(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(t,i){return this.text.slice(t,i)}get nodeSize(){return this.text.length}mark(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)}withText(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)}cut(t=0,i=this.text.length){return t==0&&i==this.text.length?this:this.withText(this.text.slice(t,i))}eq(t){return this.sameMarkup(t)&&this.text==t.text}toJSON(){let t=super.toJSON();return t.text=this.text,t}};function LS(e,t){for(let i=e.length-1;i>=0;i--)t=e[i].type.name+"("+t+")";return t}var As=class e{constructor(t){this.validEnd=t,this.next=[],this.wrapCache=[]}static parse(t,i){let n=new vm(t,i);if(n.next==null)return e.empty;let o=OS(n);n.next&&n.err("Unexpected trailing text");let r=$4(q4(o));return j4(r,n),r}matchType(t){for(let i=0;i<this.next.length;i++)if(this.next[i].type==t)return this.next[i].next;return null}matchFragment(t,i=0,n=t.childCount){let o=this;for(let r=i;o&&r<n;r++)o=o.matchType(t.child(r).type);return o}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let t=0;t<this.next.length;t++){let{type:i}=this.next[t];if(!(i.isText||i.hasRequiredAttrs()))return i}return null}compatible(t){for(let i=0;i<this.next.length;i++)for(let n=0;n<t.next.length;n++)if(this.next[i].type==t.next[n].type)return!0;return!1}fillBefore(t,i=!1,n=0){let o=[this];function r(s,a){let l=s.matchFragment(t,n);if(l&&(!i||l.validEnd))return Y.from(a.map(c=>c.createAndFill()));for(let c=0;c<s.next.length;c++){let{type:d,next:u}=s.next[c];if(!(d.isText||d.hasRequiredAttrs())&&o.indexOf(u)==-1){o.push(u);let h=r(u,a.concat(d));if(h)return h}}return null}return r(this,[])}findWrapping(t){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==t)return this.wrapCache[n+1];let i=this.computeWrapping(t);return this.wrapCache.push(t,i),i}computeWrapping(t){let i=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let o=n.shift(),r=o.match;if(r.matchType(t)){let s=[];for(let a=o;a.type;a=a.via)s.push(a.type);return s.reverse()}for(let s=0;s<r.next.length;s++){let{type:a,next:l}=r.next[s];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in i)&&(!o.type||l.validEnd)&&(n.push({match:a.contentMatch,type:a,via:o}),i[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(t){if(t>=this.next.length)throw new RangeError(`There's no ${t}th edge in this content match`);return this.next[t]}toString(){let t=[];function i(n){t.push(n);for(let o=0;o<n.next.length;o++)t.indexOf(n.next[o].next)==-1&&i(n.next[o].next)}return i(this),t.map((n,o)=>{let r=o+(n.validEnd?"*":" ")+" ";for(let s=0;s<n.next.length;s++)r+=(s?", ":"")+n.next[s].type.name+"->"+t.indexOf(n.next[s].next);return r}).join(`
`)}};As.empty=new As(!0);var vm=class{constructor(t,i){this.string=t,this.nodeTypes=i,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(t){return this.next==t&&(this.pos++||!0)}err(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")}};function OS(e){let t=[];do t.push(V4(e));while(e.eat("|"));return t.length==1?t[0]:{type:"choice",exprs:t}}function V4(e){let t=[];do t.push(G4(e));while(e.next&&e.next!=")"&&e.next!="|");return t.length==1?t[0]:{type:"seq",exprs:t}}function G4(e){let t=U4(e);for(;;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else if(e.eat("{"))t=z4(e,t);else break;return t}function bS(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function z4(e,t){let i=bS(e),n=i;return e.eat(",")&&(e.next!="}"?n=bS(e):n=-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:i,max:n,expr:t}}function W4(e,t){let i=e.nodeTypes,n=i[t];if(n)return[n];let o=[];for(let r in i){let s=i[r];s.isInGroup(t)&&o.push(s)}return o.length==0&&e.err("No node type or group '"+t+"' found"),o}function U4(e){if(e.eat("(")){let t=OS(e);return e.eat(")")||e.err("Missing closing paren"),t}else if(/\W/.test(e.next))e.err("Unexpected token '"+e.next+"'");else{let t=W4(e,e.next).map(i=>(e.inline==null?e.inline=i.isInline:e.inline!=i.isInline&&e.err("Mixing inline and block content"),{type:"name",value:i}));return e.pos++,t.length==1?t[0]:{type:"choice",exprs:t}}}function q4(e){let t=[[]];return o(r(e,0),i()),t;function i(){return t.push([])-1}function n(s,a,l){let c={term:l,to:a};return t[s].push(c),c}function o(s,a){s.forEach(l=>l.to=a)}function r(s,a){if(s.type=="choice")return s.exprs.reduce((l,c)=>l.concat(r(c,a)),[]);if(s.type=="seq")for(let l=0;;l++){let c=r(s.exprs[l],a);if(l==s.exprs.length-1)return c;o(c,a=i())}else if(s.type=="star"){let l=i();return n(a,l),o(r(s.expr,l),l),[n(l)]}else if(s.type=="plus"){let l=i();return o(r(s.expr,a),l),o(r(s.expr,l),l),[n(l)]}else{if(s.type=="opt")return[n(a)].concat(r(s.expr,a));if(s.type=="range"){let l=a;for(let c=0;c<s.min;c++){let d=i();o(r(s.expr,l),d),l=d}if(s.max==-1)o(r(s.expr,l),l);else for(let c=s.min;c<s.max;c++){let d=i();n(l,d),o(r(s.expr,l),d),l=d}return[n(l)]}else{if(s.type=="name")return[n(a,void 0,s.value)];throw new Error("Unknown expr type")}}}}function NS(e,t){return t-e}function yS(e,t){let i=[];return n(t),i.sort(NS);function n(o){let r=e[o];if(r.length==1&&!r[0].term)return n(r[0].to);i.push(o);for(let s=0;s<r.length;s++){let{term:a,to:l}=r[s];!a&&i.indexOf(l)==-1&&n(l)}}}function $4(e){let t=Object.create(null);return i(yS(e,0));function i(n){let o=[];n.forEach(s=>{e[s].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let d=0;d<o.length;d++)o[d][0]==a&&(c=o[d][1]);yS(e,l).forEach(d=>{c||o.push([a,c=[]]),c.indexOf(d)==-1&&c.push(d)})})});let r=t[n.join(",")]=new As(n.indexOf(e.length-1)>-1);for(let s=0;s<o.length;s++){let a=o[s][1].sort(NS);r.next.push({type:o[s][0],next:t[a.join(",")]||i(a)})}return r}}function j4(e,t){for(let i=0,n=[e];i<n.length;i++){let o=n[i],r=!o.validEnd,s=[];for(let a=0;a<o.next.length;a++){let{type:l,next:c}=o.next[a];s.push(l.name),r&&!(l.isText||l.hasRequiredAttrs())&&(r=!1),n.indexOf(c)==-1&&n.push(c)}r&&t.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function BS(e){let t=Object.create(null);for(let i in e){let n=e[i];if(!n.hasDefault)return null;t[i]=n.default}return t}function HS(e,t){let i=Object.create(null);for(let n in e){let o=t&&t[n];if(o===void 0){let r=e[n];if(r.hasDefault)o=r.default;else throw new RangeError("No value supplied for attribute "+n)}i[n]=o}return i}function VS(e,t,i,n){for(let o in t)if(!(o in e))throw new RangeError(`Unsupported attribute ${o} for ${i} of type ${o}`);for(let o in e){let r=e[o];r.validate&&r.validate(t[o])}}function GS(e,t){let i=Object.create(null);if(t)for(let n in t)i[n]=new Cm(e,n,t[n]);return i}var Iu=class e{constructor(t,i,n){this.name=t,this.schema=i,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=GS(t,n.attrs),this.defaultAttrs=BS(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||t=="text"),this.isText=t=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==As.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(t){return this.groups.indexOf(t)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1}compatibleContent(t){return this==t||this.contentMatch.compatible(t.contentMatch)}computeAttrs(t){return!t&&this.defaultAttrs?this.defaultAttrs:HS(this.attrs,t)}create(t=null,i,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Bi(this,this.computeAttrs(t),Y.from(i),it.setFrom(n))}createChecked(t=null,i,n){return i=Y.from(i),this.checkContent(i),new Bi(this,this.computeAttrs(t),i,it.setFrom(n))}createAndFill(t=null,i,n){if(t=this.computeAttrs(t),i=Y.from(i),i.size){let s=this.contentMatch.fillBefore(i);if(!s)return null;i=s.append(i)}let o=this.contentMatch.matchFragment(i),r=o&&o.fillBefore(Y.empty,!0);return r?new Bi(this,t,i.append(r),it.setFrom(n)):null}validContent(t){let i=this.contentMatch.matchFragment(t);if(!i||!i.validEnd)return!1;for(let n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0}checkContent(t){if(!this.validContent(t))throw new RangeError(`Invalid content for node ${this.name}: ${t.toString().slice(0,50)}`)}checkAttrs(t){VS(this.attrs,t,"node",this.name)}allowsMarkType(t){return this.markSet==null||this.markSet.indexOf(t)>-1}allowsMarks(t){if(this.markSet==null)return!0;for(let i=0;i<t.length;i++)if(!this.allowsMarkType(t[i].type))return!1;return!0}allowedMarks(t){if(this.markSet==null)return t;let i;for(let n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?i&&i.push(t[n]):i||(i=t.slice(0,n));return i?i.length?i:it.none:t}static compile(t,i){let n=Object.create(null);t.forEach((r,s)=>n[r]=new e(r,i,s));let o=i.spec.topNode||"doc";if(!n[o])throw new RangeError("Schema is missing its top node type ('"+o+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let r in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}};function K4(e,t,i){let n=i.split("|");return o=>{let r=o===null?"null":typeof o;if(n.indexOf(r)<0)throw new RangeError(`Expected value of type ${n} for attribute ${t} on type ${e}, got ${r}`)}}var Cm=class{constructor(t,i,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate=typeof n.validate=="string"?K4(t,i,n.validate):n.validate}get isRequired(){return!this.hasDefault}},gc=class e{constructor(t,i,n,o){this.name=t,this.rank=i,this.schema=n,this.spec=o,this.attrs=GS(t,o.attrs),this.excluded=null;let r=BS(this.attrs);this.instance=r?new it(this,r):null}create(t=null){return!t&&this.instance?this.instance:new it(this,HS(this.attrs,t))}static compile(t,i){let n=Object.create(null),o=0;return t.forEach((r,s)=>n[r]=new e(r,o++,i,s)),n}removeFromSet(t){for(var i=0;i<t.length;i++)t[i].type==this&&(t=t.slice(0,i).concat(t.slice(i+1)),i--);return t}isInSet(t){for(let i=0;i<t.length;i++)if(t[i].type==this)return t[i]}checkAttrs(t){VS(this.attrs,t,"mark",this.name)}excludes(t){return this.excluded.indexOf(t)>-1}},Ba=class{constructor(t){this.linebreakReplacement=null,this.cached=Object.create(null);let i=this.spec={};for(let o in t)i[o]=t[o];i.nodes=um.from(t.nodes),i.marks=um.from(t.marks||{}),this.nodes=Iu.compile(this.spec.nodes,this),this.marks=gc.compile(this.spec.marks,this);let n=Object.create(null);for(let o in this.nodes){if(o in this.marks)throw new RangeError(o+" can not be both a node and a mark");let r=this.nodes[o],s=r.spec.content||"",a=r.spec.marks;if(r.contentMatch=n[s]||(n[s]=As.parse(s,this.nodes)),r.inlineContent=r.contentMatch.inlineContent,r.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!r.isInline||!r.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=r}r.markSet=a=="_"?null:a?SS(this,a.split(" ")):a==""||!r.inlineContent?[]:null}for(let o in this.marks){let r=this.marks[o],s=r.spec.excludes;r.excluded=s==null?[r]:s==""?[]:SS(this,s.split(" "))}this.nodeFromJSON=o=>Bi.fromJSON(this,o),this.markFromJSON=o=>it.fromJSON(this,o),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(t,i=null,n,o){if(typeof t=="string")t=this.nodeType(t);else if(t instanceof Iu){if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}else throw new RangeError("Invalid node type: "+t);return t.createChecked(i,n,o)}text(t,i){let n=this.nodes.text;return new mm(n,n.defaultAttrs,t,it.setFrom(i))}mark(t,i){return typeof t=="string"&&(t=this.marks[t]),t.create(i)}nodeType(t){let i=this.nodes[t];if(!i)throw new RangeError("Unknown node type: "+t);return i}};function SS(e,t){let i=[];for(let n=0;n<t.length;n++){let o=t[n],r=e.marks[o],s=r;if(r)i.push(r);else for(let a in e.marks){let l=e.marks[a];(o=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(o)>-1)&&i.push(s=l)}if(!s)throw new SyntaxError("Unknown mark type: '"+t[n]+"'")}return i}function Y4(e){return e.tag!=null}function X4(e){return e.style!=null}var to=class e{constructor(t,i){this.schema=t,this.rules=i,this.tags=[],this.styles=[];let n=this.matchedStyles=[];i.forEach(o=>{if(Y4(o))this.tags.push(o);else if(X4(o)){let r=/[^=]*/.exec(o.style)[0];n.indexOf(r)<0&&n.push(r),this.styles.push(o)}}),this.normalizeLists=!this.tags.some(o=>{if(!/^(ul|ol)\b/.test(o.tag)||!o.node)return!1;let r=t.nodes[o.node];return r.contentMatch.matchType(r)})}parse(t,i={}){let n=new Au(this,i,!1);return n.addAll(t,it.none,i.from,i.to),n.finish()}parseSlice(t,i={}){let n=new Au(this,i,!0);return n.addAll(t,it.none,i.from,i.to),ae.maxOpen(n.finish())}matchTag(t,i,n){for(let o=n?this.tags.indexOf(n)+1:0;o<this.tags.length;o++){let r=this.tags[o];if(Z4(t,r.tag)&&(r.namespace===void 0||t.namespaceURI==r.namespace)&&(!r.context||i.matchesContext(r.context))){if(r.getAttrs){let s=r.getAttrs(t);if(s===!1)continue;r.attrs=s||void 0}return r}}}matchStyle(t,i,n,o){for(let r=o?this.styles.indexOf(o)+1:0;r<this.styles.length;r++){let s=this.styles[r],a=s.style;if(!(a.indexOf(t)!=0||s.context&&!n.matchesContext(s.context)||a.length>t.length&&(a.charCodeAt(t.length)!=61||a.slice(t.length+1)!=i))){if(s.getAttrs){let l=s.getAttrs(i);if(l===!1)continue;s.attrs=l||void 0}return s}}}static schemaRules(t){let i=[];function n(o){let r=o.priority==null?50:o.priority,s=0;for(;s<i.length;s++){let a=i[s];if((a.priority==null?50:a.priority)<r)break}i.splice(s,0,o)}for(let o in t.marks){let r=t.marks[o].spec.parseDOM;r&&r.forEach(s=>{n(s=ES(s)),s.mark||s.ignore||s.clearMark||(s.mark=o)})}for(let o in t.nodes){let r=t.nodes[o].spec.parseDOM;r&&r.forEach(s=>{n(s=ES(s)),s.node||s.ignore||s.mark||(s.node=o)})}return i}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new e(t,e.schemaRules(t)))}},zS={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},J4={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},WS={ol:!0,ul:!0},fc=1,wm=2,pc=4;function xS(e,t,i){return t!=null?(t?fc:0)|(t==="full"?wm:0):e&&e.whitespace=="pre"?fc|wm:i&~pc}var Na=class{constructor(t,i,n,o,r,s){this.type=t,this.attrs=i,this.marks=n,this.solid=o,this.options=s,this.content=[],this.activeMarks=it.none,this.match=r||(s&pc?null:t.contentMatch)}findWrapping(t){if(!this.match){if(!this.type)return[];let i=this.type.contentMatch.fillBefore(Y.from(t));if(i)this.match=this.type.contentMatch.matchFragment(i);else{let n=this.type.contentMatch,o;return(o=n.findWrapping(t.type))?(this.match=n,o):null}}return this.match.findWrapping(t.type)}finish(t){if(!(this.options&fc)){let n=this.content[this.content.length-1],o;if(n&&n.isText&&(o=/[ \t\r\n\u000c]+$/.exec(n.text))){let r=n;n.text.length==o[0].length?this.content.pop():this.content[this.content.length-1]=r.withText(r.text.slice(0,r.text.length-o[0].length))}}let i=Y.from(this.content);return!t&&this.match&&(i=i.append(this.match.fillBefore(Y.empty,!0))),this.type?this.type.create(this.attrs,i,this.marks):i}inlineContext(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!zS.hasOwnProperty(t.parentNode.nodeName.toLowerCase())}},Au=class{constructor(t,i,n){this.parser=t,this.options=i,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let o=i.topNode,r,s=xS(null,i.preserveWhitespace,0)|(n?pc:0);o?r=new Na(o.type,o.attrs,it.none,!0,i.topMatch||o.type.contentMatch,s):n?r=new Na(null,null,it.none,!0,null,s):r=new Na(t.schema.topNodeType,null,it.none,!0,null,s),this.nodes=[r],this.find=i.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(t,i){t.nodeType==3?this.addTextNode(t,i):t.nodeType==1&&this.addElement(t,i)}addTextNode(t,i){let n=t.nodeValue,o=this.top,r=o.options&wm?"full":this.localPreserveWS||(o.options&fc)>0,{schema:s}=this.parser;if(r==="full"||o.inlineContext(t)||/[^ \t\r\n\u000c]/.test(n)){if(r)if(r==="full")n=n.replace(/\r\n?/g,`
`);else if(s.linebreakReplacement&&/[\r\n]/.test(n)&&this.top.findWrapping(s.linebreakReplacement.create())){let a=n.split(/\r?\n|\r/);for(let l=0;l<a.length;l++)l&&this.insertNode(s.linebreakReplacement.create(),i,!0),a[l]&&this.insertNode(s.text(a[l]),i,!/\S/.test(a[l]));n=""}else n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let a=o.content[o.content.length-1],l=t.previousSibling;(!a||l&&l.nodeName=="BR"||a.isText&&/[ \t\r\n\u000c]$/.test(a.text))&&(n=n.slice(1))}n&&this.insertNode(s.text(n),i,!/\S/.test(n)),this.findInText(t)}else this.findInside(t)}addElement(t,i,n){let o=this.localPreserveWS,r=this.top;(t.tagName=="PRE"||/pre/.test(t.style&&t.style.whiteSpace))&&(this.localPreserveWS=!0);let s=t.nodeName.toLowerCase(),a;WS.hasOwnProperty(s)&&this.parser.normalizeLists&&Q4(t);let l=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(a=this.parser.matchTag(t,this,n));e:if(l?l.ignore:J4.hasOwnProperty(s))this.findInside(t),this.ignoreFallback(t,i);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(t=l.skip);let c,d=this.needsBlock;if(zS.hasOwnProperty(s))r.content.length&&r.content[0].isInline&&this.open&&(this.open--,r=this.top),c=!0,r.type||(this.needsBlock=!0);else if(!t.firstChild){this.leafFallback(t,i);break e}let u=l&&l.skip?i:this.readStyles(t,i);u&&this.addAll(t,u),c&&this.sync(r),this.needsBlock=d}else{let c=this.readStyles(t,i);c&&this.addElementByRule(t,l,c,l.consuming===!1?a:void 0)}this.localPreserveWS=o}leafFallback(t,i){t.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode(`
`),i)}ignoreFallback(t,i){t.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),i,!0)}readStyles(t,i){let n=t.style;if(n&&n.length)for(let o=0;o<this.parser.matchedStyles.length;o++){let r=this.parser.matchedStyles[o],s=n.getPropertyValue(r);if(s)for(let a=void 0;;){let l=this.parser.matchStyle(r,s,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?i=i.filter(c=>!l.clearMark(c)):i=i.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return i}addElementByRule(t,i,n,o){let r,s;if(i.node)if(s=this.parser.schema.nodes[i.node],s.isLeaf)this.insertNode(s.create(i.attrs),n,t.nodeName=="BR")||this.leafFallback(t,n);else{let l=this.enter(s,i.attrs||null,n,i.preserveWhitespace);l&&(r=!0,n=l)}else{let l=this.parser.schema.marks[i.mark];n=n.concat(l.create(i.attrs))}let a=this.top;if(s&&s.isLeaf)this.findInside(t);else if(o)this.addElement(t,n,o);else if(i.getContent)this.findInside(t),i.getContent(t,this.parser.schema).forEach(l=>this.insertNode(l,n,!1));else{let l=t;typeof i.contentElement=="string"?l=t.querySelector(i.contentElement):typeof i.contentElement=="function"?l=i.contentElement(t):i.contentElement&&(l=i.contentElement),this.findAround(t,l,!0),this.addAll(l,n),this.findAround(t,l,!1)}r&&this.sync(a)&&this.open--}addAll(t,i,n,o){let r=n||0;for(let s=n?t.childNodes[n]:t.firstChild,a=o==null?null:t.childNodes[o];s!=a;s=s.nextSibling,++r)this.findAtPoint(t,r),this.addDOM(s,i);this.findAtPoint(t,r)}findPlace(t,i,n){let o,r;for(let s=this.open,a=0;s>=0;s--){let l=this.nodes[s],c=l.findWrapping(t);if(c&&(!o||o.length>c.length+a)&&(o=c,r=l,!c.length))break;if(l.solid){if(n)break;a+=2}}if(!o)return null;this.sync(r);for(let s=0;s<o.length;s++)i=this.enterInner(o[s],null,i,!1);return i}insertNode(t,i,n){if(t.isInline&&this.needsBlock&&!this.top.type){let r=this.textblockFromContext();r&&(i=this.enterInner(r,null,i))}let o=this.findPlace(t,i,n);if(o){this.closeExtra();let r=this.top;r.match&&(r.match=r.match.matchType(t.type));let s=it.none;for(let a of o.concat(t.marks))(r.type?r.type.allowsMarkType(a.type):_S(a.type,t.type))&&(s=a.addToSet(s));return r.content.push(t.mark(s)),!0}return!1}enter(t,i,n,o){let r=this.findPlace(t.create(i),n,!1);return r&&(r=this.enterInner(t,i,n,!0,o)),r}enterInner(t,i,n,o=!1,r){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(t);let a=xS(t,r,s.options);s.options&pc&&s.content.length==0&&(a|=pc);let l=it.none;return n=n.filter(c=>(s.type?s.type.allowsMarkType(c.type):_S(c.type,t))?(l=c.addToSet(l),!1):!0),this.nodes.push(new Na(t,i,l,o,null,a)),this.open++,n}closeExtra(t=!1){let i=this.nodes.length-1;if(i>this.open){for(;i>this.open;i--)this.nodes[i-1].content.push(this.nodes[i].finish(t));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(t){for(let i=this.open;i>=0;i--){if(this.nodes[i]==t)return this.open=i,!0;this.localPreserveWS&&(this.nodes[i].options|=fc)}return!1}get currentPos(){this.closeExtra();let t=0;for(let i=this.open;i>=0;i--){let n=this.nodes[i].content;for(let o=n.length-1;o>=0;o--)t+=n[o].nodeSize;i&&t++}return t}findAtPoint(t,i){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==i&&(this.find[n].pos=this.currentPos)}findInside(t){if(this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&t.nodeType==1&&t.contains(this.find[i].node)&&(this.find[i].pos=this.currentPos)}findAround(t,i,n){if(t!=i&&this.find)for(let o=0;o<this.find.length;o++)this.find[o].pos==null&&t.nodeType==1&&t.contains(this.find[o].node)&&i.compareDocumentPosition(this.find[o].node)&(n?2:4)&&(this.find[o].pos=this.currentPos)}findInText(t){if(this.find)for(let i=0;i<this.find.length;i++)this.find[i].node==t&&(this.find[i].pos=this.currentPos-(t.nodeValue.length-this.find[i].offset))}matchesContext(t){if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);let i=t.split("/"),n=this.options.context,o=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),r=-(n?n.depth+1:0)+(o?0:1),s=(a,l)=>{for(;a>=0;a--){let c=i[a];if(c==""){if(a==i.length-1||a==0)continue;for(;l>=r;l--)if(s(a-1,l))return!0;return!1}else{let d=l>0||l==0&&o?this.nodes[l].type:n&&l>=r?n.node(l-r).type:null;if(!d||d.name!=c&&!d.isInGroup(c))return!1;l--}}return!0};return s(i.length-1,this.open)}textblockFromContext(){let t=this.options.context;if(t)for(let i=t.depth;i>=0;i--){let n=t.node(i).contentMatchAt(t.indexAfter(i)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let i in this.parser.schema.nodes){let n=this.parser.schema.nodes[i];if(n.isTextblock&&n.defaultAttrs)return n}}};function Q4(e){for(let t=e.firstChild,i=null;t;t=t.nextSibling){let n=t.nodeType==1?t.nodeName.toLowerCase():null;n&&WS.hasOwnProperty(n)&&i?(i.appendChild(t),t=i):n=="li"?i=t:n&&(i=null)}}function Z4(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function ES(e){let t={};for(let i in e)t[i]=e[i];return t}function _S(e,t){let i=t.schema.nodes;for(let n in i){let o=i[n];if(!o.allowsMarkType(e))continue;let r=[],s=a=>{r.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:d}=a.edge(l);if(c==t||r.indexOf(d)<0&&s(d))return!0}};if(s(o.contentMatch))return!0}}var Vo=class e{constructor(t,i){this.nodes=t,this.marks=i}serializeFragment(t,i={},n){n||(n=pm(i).createDocumentFragment());let o=n,r=[];return t.forEach(s=>{if(r.length||s.marks.length){let a=0,l=0;for(;a<r.length&&l<s.marks.length;){let c=s.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(r[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<r.length;)o=r.pop()[1];for(;l<s.marks.length;){let c=s.marks[l++],d=this.serializeMark(c,s.isInline,i);d&&(r.push([c,o]),o.appendChild(d.dom),o=d.contentDOM||d.dom)}}o.appendChild(this.serializeNodeInner(s,i))}),n}serializeNodeInner(t,i){let{dom:n,contentDOM:o}=Mu(pm(i),this.nodes[t.type.name](t),null,t.attrs);if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,i,o)}return n}serializeNode(t,i={}){let n=this.serializeNodeInner(t,i);for(let o=t.marks.length-1;o>=0;o--){let r=this.serializeMark(t.marks[o],t.isInline,i);r&&((r.contentDOM||r.dom).appendChild(n),n=r.dom)}return n}serializeMark(t,i,n={}){let o=this.marks[t.type.name];return o&&Mu(pm(n),o(t,i),null,t.attrs)}static renderSpec(t,i,n=null,o){return Mu(t,i,n,o)}static fromSchema(t){return t.cached.domSerializer||(t.cached.domSerializer=new e(this.nodesFromSchema(t),this.marksFromSchema(t)))}static nodesFromSchema(t){let i=RS(t.nodes);return i.text||(i.text=n=>n.text),i}static marksFromSchema(t){return RS(t.marks)}};function RS(e){let t={};for(let i in e){let n=e[i].spec.toDOM;n&&(t[i]=n)}return t}function pm(e){return e.document||window.document}var PS=new WeakMap;function eF(e){let t=PS.get(e);return t===void 0&&PS.set(e,t=tF(e)),t}function tF(e){let t=null;function i(n){if(n&&typeof n=="object")if(Array.isArray(n))if(typeof n[0]=="string")t||(t=[]),t.push(n);else for(let o=0;o<n.length;o++)i(n[o]);else for(let o in n)i(n[o])}return i(e),t}function Mu(e,t,i,n){if(typeof t=="string")return{dom:e.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let o=t[0],r;if(typeof o!="string")throw new RangeError("Invalid array passed to renderSpec");if(n&&(r=eF(n))&&r.indexOf(t)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=o.indexOf(" ");s>0&&(i=o.slice(0,s),o=o.slice(s+1));let a,l=i?e.createElementNS(i,o):e.createElement(o),c=t[1],d=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){d=2;for(let u in c)if(c[u]!=null){let h=u.indexOf(" ");h>0?l.setAttributeNS(u.slice(0,h),u.slice(h+1),c[u]):u=="style"&&l.style?l.style.cssText=c[u]:l.setAttribute(u,c[u])}}for(let u=d;u<t.length;u++){let h=t[u];if(h===0){if(u<t.length-1||u>d)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:p,contentDOM:g}=Mu(e,h,i,n);if(l.appendChild(p),g){if(a)throw new RangeError("Multiple content holes");a=g}}}return{dom:l,contentDOM:a}}var $S=65535,jS=Math.pow(2,16);function iF(e,t){return e+t*jS}function US(e){return e&$S}function nF(e){return(e-(e&$S))/jS}var KS=1,YS=2,Lu=4,XS=8,Cc=class{constructor(t,i,n){this.pos=t,this.delInfo=i,this.recover=n}get deleted(){return(this.delInfo&XS)>0}get deletedBefore(){return(this.delInfo&(KS|Lu))>0}get deletedAfter(){return(this.delInfo&(YS|Lu))>0}get deletedAcross(){return(this.delInfo&Lu)>0}},Go=class e{constructor(t,i=!1){if(this.ranges=t,this.inverted=i,!t.length&&e.empty)return e.empty}recover(t){let i=0,n=US(t);if(!this.inverted)for(let o=0;o<n;o++)i+=this.ranges[o*3+2]-this.ranges[o*3+1];return this.ranges[n*3]+i+nF(t)}mapResult(t,i=1){return this._map(t,i,!1)}map(t,i=1){return this._map(t,i,!0)}_map(t,i,n){let o=0,r=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?o:0);if(l>t)break;let c=this.ranges[a+r],d=this.ranges[a+s],u=l+c;if(t<=u){let h=c?t==l?-1:t==u?1:i:i,p=l+o+(h<0?0:d);if(n)return p;let g=t==(i<0?l:u)?null:iF(a/3,t-l),f=t==l?YS:t==u?KS:Lu;return(i<0?t!=l:t!=u)&&(f|=XS),new Cc(p,f,g)}o+=d-c}return n?t+o:new Cc(t+o,0,null)}touches(t,i){let n=0,o=US(i),r=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?n:0);if(l>t)break;let c=this.ranges[a+r],d=l+c;if(t<=d&&a==o*3)return!0;n+=this.ranges[a+s]-c}return!1}forEach(t){let i=this.inverted?2:1,n=this.inverted?1:2;for(let o=0,r=0;o<this.ranges.length;o+=3){let s=this.ranges[o],a=s-(this.inverted?r:0),l=s+(this.inverted?0:r),c=this.ranges[o+i],d=this.ranges[o+n];t(a,a+c,l,l+d),r+=d-c}}invert(){return new e(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return t==0?e.empty:new e(t<0?[0,-t,0]:[0,0,t])}};Go.empty=new Go([]);var wc=class e{constructor(t,i,n=0,o=t?t.length:0){this.mirror=i,this.from=n,this.to=o,this._maps=t||[],this.ownData=!(t||i)}get maps(){return this._maps}slice(t=0,i=this.maps.length){return new e(this._maps,this.mirror,t,i)}appendMap(t,i){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(t),i!=null&&this.setMirror(this._maps.length-1,i)}appendMapping(t){for(let i=0,n=this._maps.length;i<t._maps.length;i++){let o=t.getMirror(i);this.appendMap(t._maps[i],o!=null&&o<i?n+o:void 0)}}getMirror(t){if(this.mirror){for(let i=0;i<this.mirror.length;i++)if(this.mirror[i]==t)return this.mirror[i+(i%2?-1:1)]}}setMirror(t,i){this.mirror||(this.mirror=[]),this.mirror.push(t,i)}appendMappingInverted(t){for(let i=t.maps.length-1,n=this._maps.length+t._maps.length;i>=0;i--){let o=t.getMirror(i);this.appendMap(t._maps[i].invert(),o!=null&&o>i?n-o-1:void 0)}}invert(){let t=new e;return t.appendMappingInverted(this),t}map(t,i=1){if(this.mirror)return this._map(t,i,!0);for(let n=this.from;n<this.to;n++)t=this._maps[n].map(t,i);return t}mapResult(t,i=1){return this._map(t,i,!1)}_map(t,i,n){let o=0;for(let r=this.from;r<this.to;r++){let s=this._maps[r],a=s.mapResult(t,i);if(a.recover!=null){let l=this.getMirror(r);if(l!=null&&l>r&&l<this.to){r=l,t=this._maps[l].recover(a.recover);continue}}o|=a.delInfo,t=a.pos}return n?t:new Cc(t,o,null)}},bm=Object.create(null),Xt=class{getMap(){return Go.empty}merge(t){return null}static fromJSON(t,i){if(!i||!i.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=bm[i.stepType];if(!n)throw new RangeError(`No step type ${i.stepType} defined`);return n.fromJSON(t,i)}static jsonID(t,i){if(t in bm)throw new RangeError("Duplicate use of step JSON ID "+t);return bm[t]=i,i.prototype.jsonID=t,i}},ni=class e{constructor(t,i){this.doc=t,this.failed=i}static ok(t){return new e(t,null)}static fail(t){return new e(null,t)}static fromReplace(t,i,n,o){try{return e.ok(t.replace(i,n,o))}catch(r){if(r instanceof Fs)return e.fail(r.message);throw r}}};function _m(e,t,i){let n=[];for(let o=0;o<e.childCount;o++){let r=e.child(o);r.content.size&&(r=r.copy(_m(r.content,t,r))),r.isInline&&(r=t(r,i,o)),n.push(r)}return Y.fromArray(n)}var bc=class e extends Xt{constructor(t,i,n){super(),this.from=t,this.to=i,this.mark=n}apply(t){let i=t.slice(this.from,this.to),n=t.resolve(this.from),o=n.node(n.sharedDepth(this.to)),r=new ae(_m(i.content,(s,a)=>!s.isAtom||!a.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),o),i.openStart,i.openEnd);return ni.fromReplace(t,this.from,this.to,r)}invert(){return new zo(this.from,this.to,this.mark)}map(t){let i=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return i.deleted&&n.deleted||i.pos>=n.pos?null:new e(i.pos,n.pos,this.mark)}merge(t){return t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,i){if(typeof i.from!="number"||typeof i.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new e(i.from,i.to,t.markFromJSON(i.mark))}};Xt.jsonID("addMark",bc);var zo=class e extends Xt{constructor(t,i,n){super(),this.from=t,this.to=i,this.mark=n}apply(t){let i=t.slice(this.from,this.to),n=new ae(_m(i.content,o=>o.mark(this.mark.removeFromSet(o.marks)),t),i.openStart,i.openEnd);return ni.fromReplace(t,this.from,this.to,n)}invert(){return new bc(this.from,this.to,this.mark)}map(t){let i=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return i.deleted&&n.deleted||i.pos>=n.pos?null:new e(i.pos,n.pos,this.mark)}merge(t){return t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,i){if(typeof i.from!="number"||typeof i.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new e(i.from,i.to,t.markFromJSON(i.mark))}};Xt.jsonID("removeMark",zo);var yc=class e extends Xt{constructor(t,i){super(),this.pos=t,this.mark=i}apply(t){let i=t.nodeAt(this.pos);if(!i)return ni.fail("No node at mark step's position");let n=i.type.create(i.attrs,null,this.mark.addToSet(i.marks));return ni.fromReplace(t,this.pos,this.pos+1,new ae(Y.from(n),0,i.isLeaf?0:1))}invert(t){let i=t.nodeAt(this.pos);if(i){let n=this.mark.addToSet(i.marks);if(n.length==i.marks.length){for(let o=0;o<i.marks.length;o++)if(!i.marks[o].isInSet(n))return new e(this.pos,i.marks[o]);return new e(this.pos,this.mark)}}return new Ha(this.pos,this.mark)}map(t){let i=t.mapResult(this.pos,1);return i.deletedAfter?null:new e(i.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,i){if(typeof i.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new e(i.pos,t.markFromJSON(i.mark))}};Xt.jsonID("addNodeMark",yc);var Ha=class e extends Xt{constructor(t,i){super(),this.pos=t,this.mark=i}apply(t){let i=t.nodeAt(this.pos);if(!i)return ni.fail("No node at mark step's position");let n=i.type.create(i.attrs,null,this.mark.removeFromSet(i.marks));return ni.fromReplace(t,this.pos,this.pos+1,new ae(Y.from(n),0,i.isLeaf?0:1))}invert(t){let i=t.nodeAt(this.pos);return!i||!this.mark.isInSet(i.marks)?this:new yc(this.pos,this.mark)}map(t){let i=t.mapResult(this.pos,1);return i.deletedAfter?null:new e(i.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,i){if(typeof i.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new e(i.pos,t.markFromJSON(i.mark))}};Xt.jsonID("removeNodeMark",Ha);var pi=class e extends Xt{constructor(t,i,n,o=!1){super(),this.from=t,this.to=i,this.slice=n,this.structure=o}apply(t){return this.structure&&xm(t,this.from,this.to)?ni.fail("Structure replace would overwrite content"):ni.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new Go([this.from,this.to-this.from,this.slice.size])}invert(t){return new e(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let i=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return i.deletedAcross&&n.deletedAcross?null:new e(i.pos,Math.max(i.pos,n.pos),this.slice,this.structure)}merge(t){if(!(t instanceof e)||t.structure||this.structure)return null;if(this.from+this.slice.size==t.from&&!this.slice.openEnd&&!t.slice.openStart){let i=this.slice.size+t.slice.size==0?ae.empty:new ae(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new e(this.from,this.to+(t.to-t.from),i,this.structure)}else if(t.to==this.from&&!this.slice.openStart&&!t.slice.openEnd){let i=this.slice.size+t.slice.size==0?ae.empty:new ae(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new e(t.from,this.to,i,this.structure)}else return null}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,i){if(typeof i.from!="number"||typeof i.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new e(i.from,i.to,ae.fromJSON(t,i.slice),!!i.structure)}};Xt.jsonID("replace",pi);var Nt=class e extends Xt{constructor(t,i,n,o,r,s,a=!1){super(),this.from=t,this.to=i,this.gapFrom=n,this.gapTo=o,this.slice=r,this.insert=s,this.structure=a}apply(t){if(this.structure&&(xm(t,this.from,this.gapFrom)||xm(t,this.gapTo,this.to)))return ni.fail("Structure gap-replace would overwrite content");let i=t.slice(this.gapFrom,this.gapTo);if(i.openStart||i.openEnd)return ni.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,i.content);return n?ni.fromReplace(t,this.from,this.to,n):ni.fail("Content does not fit in gap")}getMap(){return new Go([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let i=this.gapTo-this.gapFrom;return new e(this.from,this.from+this.slice.size+i,this.from+this.insert,this.from+this.insert+i,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let i=t.mapResult(this.from,1),n=t.mapResult(this.to,-1),o=this.from==this.gapFrom?i.pos:t.map(this.gapFrom,-1),r=this.to==this.gapTo?n.pos:t.map(this.gapTo,1);return i.deletedAcross&&n.deletedAcross||o<i.pos||r>n.pos?null:new e(i.pos,n.pos,o,r,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,i){if(typeof i.from!="number"||typeof i.to!="number"||typeof i.gapFrom!="number"||typeof i.gapTo!="number"||typeof i.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new e(i.from,i.to,i.gapFrom,i.gapTo,ae.fromJSON(t,i.slice),i.insert,!!i.structure)}};Xt.jsonID("replaceAround",Nt);function xm(e,t,i){let n=e.resolve(t),o=i-t,r=n.depth;for(;o>0&&r>0&&n.indexAfter(r)==n.node(r).childCount;)r--,o--;if(o>0){let s=n.node(r).maybeChild(n.indexAfter(r));for(;o>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,o--}}return!1}function oF(e,t,i,n){let o=[],r=[],s,a;e.doc.nodesBetween(t,i,(l,c,d)=>{if(!l.isInline)return;let u=l.marks;if(!n.isInSet(u)&&d.type.allowsMarkType(n.type)){let h=Math.max(c,t),p=Math.min(c+l.nodeSize,i),g=n.addToSet(u);for(let f=0;f<u.length;f++)u[f].isInSet(g)||(s&&s.to==h&&s.mark.eq(u[f])?s.to=p:o.push(s=new zo(h,p,u[f])));a&&a.to==h?a.to=p:r.push(a=new bc(h,p,n))}}),o.forEach(l=>e.step(l)),r.forEach(l=>e.step(l))}function rF(e,t,i,n){let o=[],r=0;e.doc.nodesBetween(t,i,(s,a)=>{if(!s.isInline)return;r++;let l=null;if(n instanceof gc){let c=s.marks,d;for(;d=n.isInSet(c);)(l||(l=[])).push(d),c=d.removeFromSet(c)}else n?n.isInSet(s.marks)&&(l=[n]):l=s.marks;if(l&&l.length){let c=Math.min(a+s.nodeSize,i);for(let d=0;d<l.length;d++){let u=l[d],h;for(let p=0;p<o.length;p++){let g=o[p];g.step==r-1&&u.eq(o[p].style)&&(h=g)}h?(h.to=c,h.step=r):o.push({style:u,from:Math.max(a,t),to:c,step:r})}}}),o.forEach(s=>e.step(new zo(s.from,s.to,s.style)))}function Rm(e,t,i,n=i.contentMatch,o=!0){let r=e.doc.nodeAt(t),s=[],a=t+1;for(let l=0;l<r.childCount;l++){let c=r.child(l),d=a+c.nodeSize,u=n.matchType(c.type);if(!u)s.push(new pi(a,d,ae.empty));else{n=u;for(let h=0;h<c.marks.length;h++)i.allowsMarkType(c.marks[h].type)||e.step(new zo(a,d,c.marks[h]));if(o&&c.isText&&i.whitespace!="pre"){let h,p=/\r?\n|\r/g,g;for(;h=p.exec(c.text);)g||(g=new ae(Y.from(i.schema.text(" ",i.allowedMarks(c.marks))),0,0)),s.push(new pi(a+h.index,a+h.index+h[0].length,g))}}a=d}if(!n.validEnd){let l=n.fillBefore(Y.empty,!0);e.replace(a,a,new ae(l,0,0))}for(let l=s.length-1;l>=0;l--)e.step(s[l])}function sF(e,t,i){return(t==0||e.canReplace(t,e.childCount))&&(i==e.childCount||e.canReplace(0,i))}function Wo(e){let i=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let n=e.depth,o=0,r=0;;--n){let s=e.$from.node(n),a=e.$from.index(n)+o,l=e.$to.indexAfter(n)-r;if(n<e.depth&&s.canReplace(a,l,i))return n;if(n==0||s.type.spec.isolating||!sF(s,a,l))break;a&&(o=1),l<s.childCount&&(r=1)}return null}function aF(e,t,i){let{$from:n,$to:o,depth:r}=t,s=n.before(r+1),a=o.after(r+1),l=s,c=a,d=Y.empty,u=0;for(let g=r,f=!1;g>i;g--)f||n.index(g)>0?(f=!0,d=Y.from(n.node(g).copy(d)),u++):l--;let h=Y.empty,p=0;for(let g=r,f=!1;g>i;g--)f||o.after(g+1)<o.end(g)?(f=!0,h=Y.from(o.node(g).copy(h)),p++):c++;e.step(new Nt(l,c,s,a,new ae(d.append(h),u,p),d.size-u,!0))}function za(e,t,i=null,n=e){let o=lF(e,t),r=o&&cF(n,t);return r?o.map(qS).concat({type:t,attrs:i}).concat(r.map(qS)):null}function qS(e){return{type:e,attrs:null}}function lF(e,t){let{parent:i,startIndex:n,endIndex:o}=e,r=i.contentMatchAt(n).findWrapping(t);if(!r)return null;let s=r.length?r[0]:t;return i.canReplaceWith(n,o,s)?r:null}function cF(e,t){let{parent:i,startIndex:n,endIndex:o}=e,r=i.child(n),s=t.contentMatch.findWrapping(r.type);if(!s)return null;let l=(s.length?s[s.length-1]:t).contentMatch;for(let c=n;l&&c<o;c++)l=l.matchType(i.child(c).type);return!l||!l.validEnd?null:s}function dF(e,t,i){let n=Y.empty;for(let s=i.length-1;s>=0;s--){if(n.size){let a=i[s].type.contentMatch.matchFragment(n);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=Y.from(i[s].type.create(i[s].attrs,n))}let o=t.start,r=t.end;e.step(new Nt(o,r,o,r,new ae(n,0,0),i.length,!0))}function uF(e,t,i,n,o){if(!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let r=e.steps.length;e.doc.nodesBetween(t,i,(s,a)=>{let l=typeof o=="function"?o(s):o;if(s.isTextblock&&!s.hasMarkup(n,l)&&hF(e.doc,e.mapping.slice(r).map(a),n)){let c=null;if(n.schema.linebreakReplacement){let p=n.whitespace=="pre",g=!!n.contentMatch.matchType(n.schema.linebreakReplacement);p&&!g?c=!1:!p&&g&&(c=!0)}c===!1&&QS(e,s,a,r),Rm(e,e.mapping.slice(r).map(a,1),n,void 0,c===null);let d=e.mapping.slice(r),u=d.map(a,1),h=d.map(a+s.nodeSize,1);return e.step(new Nt(u,h,u+1,h-1,new ae(Y.from(n.create(l,null,s.marks)),0,0),1,!0)),c===!0&&JS(e,s,a,r),!1}})}function JS(e,t,i,n){t.forEach((o,r)=>{if(o.isText){let s,a=/\r?\n|\r/g;for(;s=a.exec(o.text);){let l=e.mapping.slice(n).map(i+1+r+s.index);e.replaceWith(l,l+1,t.type.schema.linebreakReplacement.create())}}})}function QS(e,t,i,n){t.forEach((o,r)=>{if(o.type==o.type.schema.linebreakReplacement){let s=e.mapping.slice(n).map(i+1+r);e.replaceWith(s,s+1,t.type.schema.text(`
`))}})}function hF(e,t,i){let n=e.resolve(t),o=n.index();return n.parent.canReplaceWith(o,o+1,i)}function pF(e,t,i,n,o){let r=e.doc.nodeAt(t);if(!r)throw new RangeError("No node at given position");i||(i=r.type);let s=i.create(n,null,o||r.marks);if(r.isLeaf)return e.replaceWith(t,t+r.nodeSize,s);if(!i.validContent(r.content))throw new RangeError("Invalid content for node type "+i.name);e.step(new Nt(t,t+r.nodeSize,t+1,t+r.nodeSize-1,new ae(Y.from(s),0,0),1,!0))}function Ji(e,t,i=1,n){let o=e.resolve(t),r=o.depth-i,s=n&&n[n.length-1]||o.parent;if(r<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!s.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(let c=o.depth-1,d=i-2;c>r;c--,d--){let u=o.node(c),h=o.index(c);if(u.type.spec.isolating)return!1;let p=u.content.cutByIndex(h,u.childCount),g=n&&n[d+1];g&&(p=p.replaceChild(0,g.type.create(g.attrs)));let f=n&&n[d]||u;if(!u.canReplace(h+1,u.childCount)||!f.type.validContent(p))return!1}let a=o.indexAfter(r),l=n&&n[0];return o.node(r).canReplaceWith(a,a,l?l.type:o.node(r+1).type)}function gF(e,t,i=1,n){let o=e.doc.resolve(t),r=Y.empty,s=Y.empty;for(let a=o.depth,l=o.depth-i,c=i-1;a>l;a--,c--){r=Y.from(o.node(a).copy(r));let d=n&&n[c];s=Y.from(d?d.type.create(d.attrs,s):o.node(a).copy(s))}e.step(new pi(t,t,new ae(r.append(s),i,i),!0))}function cn(e,t){let i=e.resolve(t),n=i.index();return ZS(i.nodeBefore,i.nodeAfter)&&i.parent.canReplace(n,n+1)}function fF(e,t){t.content.size||e.type.compatibleContent(t.type);let i=e.contentMatchAt(e.childCount),{linebreakReplacement:n}=e.type.schema;for(let o=0;o<t.childCount;o++){let r=t.child(o),s=r.type==n?e.type.schema.nodes.text:r.type;if(i=i.matchType(s),!i||!e.type.allowsMarks(r.marks))return!1}return i.validEnd}function ZS(e,t){return!!(e&&t&&!e.isLeaf&&fF(e,t))}function Ls(e,t,i=-1){let n=e.resolve(t);for(let o=n.depth;;o--){let r,s,a=n.index(o);if(o==n.depth?(r=n.nodeBefore,s=n.nodeAfter):i>0?(r=n.node(o+1),a++,s=n.node(o).maybeChild(a)):(r=n.node(o).maybeChild(a-1),s=n.node(o+1)),r&&!r.isTextblock&&ZS(r,s)&&n.node(o).canReplace(a,a+1))return t;if(o==0)break;t=i<0?n.before(o):n.after(o)}}function mF(e,t,i){let n=null,{linebreakReplacement:o}=e.doc.type.schema,r=e.doc.resolve(t-i),s=r.node().type;if(o&&s.inlineContent){let d=s.whitespace=="pre",u=!!s.contentMatch.matchType(o);d&&!u?n=!1:!d&&u&&(n=!0)}let a=e.steps.length;if(n===!1){let d=e.doc.resolve(t+i);QS(e,d.node(),d.before(),a)}s.inlineContent&&Rm(e,t+i-1,s,r.node().contentMatchAt(r.index()),n==null);let l=e.mapping.slice(a),c=l.map(t-i);if(e.step(new pi(c,l.map(t+i,-1),ae.empty,!0)),n===!0){let d=e.doc.resolve(c);JS(e,d.node(),d.before(),e.steps.length)}return e}function vF(e,t,i){let n=e.resolve(t);if(n.parent.canReplaceWith(n.index(),n.index(),i))return t;if(n.parentOffset==0)for(let o=n.depth-1;o>=0;o--){let r=n.index(o);if(n.node(o).canReplaceWith(r,r,i))return n.before(o+1);if(r>0)return null}if(n.parentOffset==n.parent.content.size)for(let o=n.depth-1;o>=0;o--){let r=n.indexAfter(o);if(n.node(o).canReplaceWith(r,r,i))return n.after(o+1);if(r<n.node(o).childCount)return null}return null}function Bu(e,t,i){let n=e.resolve(t);if(!i.content.size)return t;let o=i.content;for(let r=0;r<i.openStart;r++)o=o.firstChild.content;for(let r=1;r<=(i.openStart==0&&i.size?2:1);r++)for(let s=n.depth;s>=0;s--){let a=s==n.depth?0:n.pos<=(n.start(s+1)+n.end(s+1))/2?-1:1,l=n.index(s)+(a>0?1:0),c=n.node(s),d=!1;if(r==1)d=c.canReplace(l,l,o);else{let u=c.contentMatchAt(l).findWrapping(o.firstChild.type);d=u&&c.canReplaceWith(l,l,u[0])}if(d)return a==0?n.pos:a<0?n.before(s+1):n.after(s+1)}return null}function Sc(e,t,i=t,n=ae.empty){if(t==i&&!n.size)return null;let o=e.resolve(t),r=e.resolve(i);return e2(o,r,n)?new pi(t,i,n):new Em(o,r,n).fit()}function e2(e,t,i){return!i.openStart&&!i.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),i.content)}var Em=class{constructor(t,i,n){this.$from=t,this.$to=i,this.unplaced=n,this.frontier=[],this.placed=Y.empty;for(let o=0;o<=t.depth;o++){let r=t.node(o);this.frontier.push({type:r.type,match:r.contentMatchAt(t.indexAfter(o))})}for(let o=t.depth;o>0;o--)this.placed=Y.from(t.node(o).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let t=this.mustMoveInline(),i=this.placed.size-this.depth-this.$from.depth,n=this.$from,o=this.close(t<0?this.$to:n.doc.resolve(t));if(!o)return null;let r=this.placed,s=n.depth,a=o.depth;for(;s&&a&&r.childCount==1;)r=r.firstChild.content,s--,a--;let l=new ae(r,s,a);return t>-1?new Nt(n.pos,t,this.$to.pos,this.$to.end(),l,i):l.size||n.pos!=this.$to.pos?new pi(n.pos,o.pos,l):null}findFittable(){let t=this.unplaced.openStart;for(let i=this.unplaced.content,n=0,o=this.unplaced.openEnd;n<t;n++){let r=i.firstChild;if(i.childCount>1&&(o=0),r.type.spec.isolating&&o<=n){t=n;break}i=r.content}for(let i=1;i<=2;i++)for(let n=i==1?t:this.unplaced.openStart;n>=0;n--){let o,r=null;n?(r=ym(this.unplaced.content,n-1).firstChild,o=r.content):o=this.unplaced.content;let s=o.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],d,u=null;if(i==1&&(s?c.matchType(s.type)||(u=c.fillBefore(Y.from(s),!1)):r&&l.compatibleContent(r.type)))return{sliceDepth:n,frontierDepth:a,parent:r,inject:u};if(i==2&&s&&(d=c.findWrapping(s.type)))return{sliceDepth:n,frontierDepth:a,parent:r,wrap:d};if(r&&c.matchType(r.type))break}}}openMore(){let{content:t,openStart:i,openEnd:n}=this.unplaced,o=ym(t,i);return!o.childCount||o.firstChild.isLeaf?!1:(this.unplaced=new ae(t,i+1,Math.max(n,o.size+i>=t.size-n?i+1:0)),!0)}dropNode(){let{content:t,openStart:i,openEnd:n}=this.unplaced,o=ym(t,i);if(o.childCount<=1&&i>0){let r=t.size-i<=i+o.size;this.unplaced=new ae(mc(t,i-1,1),i-1,r?i-1:n)}else this.unplaced=new ae(mc(t,i,1),i,n)}placeNodes({sliceDepth:t,frontierDepth:i,parent:n,inject:o,wrap:r}){for(;this.depth>i;)this.closeFrontierNode();if(r)for(let f=0;f<r.length;f++)this.openFrontierNode(r[f]);let s=this.unplaced,a=n?n.content:s.content,l=s.openStart-t,c=0,d=[],{match:u,type:h}=this.frontier[i];if(o){for(let f=0;f<o.childCount;f++)d.push(o.child(f));u=u.matchFragment(o)}let p=a.size+t-(s.content.size-s.openEnd);for(;c<a.childCount;){let f=a.child(c),m=u.matchType(f.type);if(!m)break;c++,(c>1||l==0||f.content.size)&&(u=m,d.push(t2(f.mark(h.allowedMarks(f.marks)),c==1?l:0,c==a.childCount?p:-1)))}let g=c==a.childCount;g||(p=-1),this.placed=vc(this.placed,i,Y.from(d)),this.frontier[i].match=u,g&&p<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let f=0,m=a;f<p;f++){let v=m.lastChild;this.frontier.push({type:v.type,match:v.contentMatchAt(v.childCount)}),m=v.content}this.unplaced=g?t==0?ae.empty:new ae(mc(s.content,t-1,1),t-1,p<0?s.openEnd:t-1):new ae(mc(s.content,t,c),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let t=this.frontier[this.depth],i;if(!t.type.isTextblock||!Sm(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(i=this.findCloseLevel(this.$to))&&i.depth==this.depth)return-1;let{depth:n}=this.$to,o=this.$to.after(n);for(;n>1&&o==this.$to.end(--n);)++o;return o}findCloseLevel(t){e:for(let i=Math.min(this.depth,t.depth);i>=0;i--){let{match:n,type:o}=this.frontier[i],r=i<t.depth&&t.end(i+1)==t.pos+(t.depth-(i+1)),s=Sm(t,i,o,n,r);if(s){for(let a=i-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],d=Sm(t,a,c,l,!0);if(!d||d.childCount)continue e}return{depth:i,fit:s,move:r?t.doc.resolve(t.after(i+1)):t}}}}close(t){let i=this.findCloseLevel(t);if(!i)return null;for(;this.depth>i.depth;)this.closeFrontierNode();i.fit.childCount&&(this.placed=vc(this.placed,i.depth,i.fit)),t=i.move;for(let n=i.depth+1;n<=t.depth;n++){let o=t.node(n),r=o.type.contentMatch.fillBefore(o.content,!0,t.index(n));this.openFrontierNode(o.type,o.attrs,r)}return t}openFrontierNode(t,i=null,n){let o=this.frontier[this.depth];o.match=o.match.matchType(t),this.placed=vc(this.placed,this.depth,Y.from(t.create(i,n))),this.frontier.push({type:t,match:t.contentMatch})}closeFrontierNode(){let i=this.frontier.pop().match.fillBefore(Y.empty,!0);i.childCount&&(this.placed=vc(this.placed,this.frontier.length,i))}};function mc(e,t,i){return t==0?e.cutByIndex(i,e.childCount):e.replaceChild(0,e.firstChild.copy(mc(e.firstChild.content,t-1,i)))}function vc(e,t,i){return t==0?e.append(i):e.replaceChild(e.childCount-1,e.lastChild.copy(vc(e.lastChild.content,t-1,i)))}function ym(e,t){for(let i=0;i<t;i++)e=e.firstChild.content;return e}function t2(e,t,i){if(t<=0)return e;let n=e.content;return t>1&&(n=n.replaceChild(0,t2(n.firstChild,t-1,n.childCount==1?i-1:0))),t>0&&(n=e.type.contentMatch.fillBefore(n).append(n),i<=0&&(n=n.append(e.type.contentMatch.matchFragment(n).fillBefore(Y.empty,!0)))),e.copy(n)}function Sm(e,t,i,n,o){let r=e.node(t),s=o?e.indexAfter(t):e.index(t);if(s==r.childCount&&!i.compatibleContent(r.type))return null;let a=n.fillBefore(r.content,!0,s);return a&&!CF(i,r.content,s)?a:null}function CF(e,t,i){for(let n=i;n<t.childCount;n++)if(!e.allowsMarks(t.child(n).marks))return!0;return!1}function wF(e){return e.spec.defining||e.spec.definingForContent}function bF(e,t,i,n){if(!n.size)return e.deleteRange(t,i);let o=e.doc.resolve(t),r=e.doc.resolve(i);if(e2(o,r,n))return e.step(new pi(t,i,n));let s=n2(o,r);s[s.length-1]==0&&s.pop();let a=-(o.depth+1);s.unshift(a);for(let h=o.depth,p=o.pos-1;h>0;h--,p--){let g=o.node(h).type.spec;if(g.defining||g.definingAsContext||g.isolating)break;s.indexOf(h)>-1?a=h:o.before(h)==p&&s.splice(1,0,-h)}let l=s.indexOf(a),c=[],d=n.openStart;for(let h=n.content,p=0;;p++){let g=h.firstChild;if(c.push(g),p==n.openStart)break;h=g.content}for(let h=d-1;h>=0;h--){let p=c[h],g=wF(p.type);if(g&&!p.sameMarkup(o.node(Math.abs(a)-1)))d=h;else if(g||!p.type.isTextblock)break}for(let h=n.openStart;h>=0;h--){let p=(h+d+1)%(n.openStart+1),g=c[p];if(g)for(let f=0;f<s.length;f++){let m=s[(f+l)%s.length],v=!0;m<0&&(v=!1,m=-m);let C=o.node(m-1),w=o.index(m-1);if(C.canReplaceWith(w,w,g.type,g.marks))return e.replace(o.before(m),v?r.after(m):i,new ae(i2(n.content,0,n.openStart,p),p,n.openEnd))}}let u=e.steps.length;for(let h=s.length-1;h>=0&&(e.replace(t,i,n),!(e.steps.length>u));h--){let p=s[h];p<0||(t=o.before(p),i=r.after(p))}}function i2(e,t,i,n,o){if(t<i){let r=e.firstChild;e=e.replaceChild(0,r.copy(i2(r.content,t+1,i,n,r)))}if(t>n){let r=o.contentMatchAt(0),s=r.fillBefore(e).append(e);e=s.append(r.matchFragment(s).fillBefore(Y.empty,!0))}return e}function yF(e,t,i,n){if(!n.isInline&&t==i&&e.doc.resolve(t).parent.content.size){let o=vF(e.doc,t,n.type);o!=null&&(t=i=o)}e.replaceRange(t,i,new ae(Y.from(n),0,0))}function SF(e,t,i){let n=e.doc.resolve(t),o=e.doc.resolve(i),r=n2(n,o);for(let s=0;s<r.length;s++){let a=r[s],l=s==r.length-1;if(l&&a==0||n.node(a).type.contentMatch.validEnd)return e.delete(n.start(a),o.end(a));if(a>0&&(l||n.node(a-1).canReplace(n.index(a-1),o.indexAfter(a-1))))return e.delete(n.before(a),o.after(a))}for(let s=1;s<=n.depth&&s<=o.depth;s++)if(t-n.start(s)==n.depth-s&&i>n.end(s)&&o.end(s)-i!=o.depth-s&&n.start(s-1)==o.start(s-1)&&n.node(s-1).canReplace(n.index(s-1),o.index(s-1)))return e.delete(n.before(s),i);e.delete(t,i)}function n2(e,t){let i=[],n=Math.min(e.depth,t.depth);for(let o=n;o>=0;o--){let r=e.start(o);if(r<e.pos-(e.depth-o)||t.end(o)>t.pos+(t.depth-o)||e.node(o).type.spec.isolating||t.node(o).type.spec.isolating)break;(r==t.start(o)||o==e.depth&&o==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&o&&t.start(o-1)==r-1)&&i.push(o)}return i}var Ou=class e extends Xt{constructor(t,i,n){super(),this.pos=t,this.attr=i,this.value=n}apply(t){let i=t.nodeAt(this.pos);if(!i)return ni.fail("No node at attribute step's position");let n=Object.create(null);for(let r in i.attrs)n[r]=i.attrs[r];n[this.attr]=this.value;let o=i.type.create(n,null,i.marks);return ni.fromReplace(t,this.pos,this.pos+1,new ae(Y.from(o),0,i.isLeaf?0:1))}getMap(){return Go.empty}invert(t){return new e(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let i=t.mapResult(this.pos,1);return i.deletedAfter?null:new e(i.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,i){if(typeof i.pos!="number"||typeof i.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new e(i.pos,i.attr,i.value)}};Xt.jsonID("attr",Ou);var Nu=class e extends Xt{constructor(t,i){super(),this.attr=t,this.value=i}apply(t){let i=Object.create(null);for(let o in t.attrs)i[o]=t.attrs[o];i[this.attr]=this.value;let n=t.type.create(i,t.content,t.marks);return ni.ok(n)}getMap(){return Go.empty}invert(t){return new e(this.attr,t.attrs[this.attr])}map(t){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(t,i){if(typeof i.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new e(i.attr,i.value)}};Xt.jsonID("docAttr",Nu);var Va=class extends Error{};Va=function e(t){let i=Error.call(this,t);return i.__proto__=e.prototype,i};Va.prototype=Object.create(Error.prototype);Va.prototype.constructor=Va;Va.prototype.name="TransformError";var Ga=class{constructor(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new wc}get before(){return this.docs.length?this.docs[0]:this.doc}step(t){let i=this.maybeStep(t);if(i.failed)throw new Va(i.failed);return this}maybeStep(t){let i=t.apply(this.doc);return i.failed||this.addStep(t,i.doc),i}get docChanged(){return this.steps.length>0}addStep(t,i){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=i}replace(t,i=t,n=ae.empty){let o=Sc(this.doc,t,i,n);return o&&this.step(o),this}replaceWith(t,i,n){return this.replace(t,i,new ae(Y.from(n),0,0))}delete(t,i){return this.replace(t,i,ae.empty)}insert(t,i){return this.replaceWith(t,t,i)}replaceRange(t,i,n){return bF(this,t,i,n),this}replaceRangeWith(t,i,n){return yF(this,t,i,n),this}deleteRange(t,i){return SF(this,t,i),this}lift(t,i){return aF(this,t,i),this}join(t,i=1){return mF(this,t,i),this}wrap(t,i){return dF(this,t,i),this}setBlockType(t,i=t,n,o=null){return uF(this,t,i,n,o),this}setNodeMarkup(t,i,n=null,o){return pF(this,t,i,n,o),this}setNodeAttribute(t,i,n){return this.step(new Ou(t,i,n)),this}setDocAttribute(t,i){return this.step(new Nu(t,i)),this}addNodeMark(t,i){return this.step(new yc(t,i)),this}removeNodeMark(t,i){let n=this.doc.nodeAt(t);if(!n)throw new RangeError("No node at position "+t);if(i instanceof it)i.isInSet(n.marks)&&this.step(new Ha(t,i));else{let o=n.marks,r,s=[];for(;r=i.isInSet(o);)s.push(new Ha(t,r)),o=r.removeFromSet(o);for(let a=s.length-1;a>=0;a--)this.step(s[a])}return this}split(t,i=1,n){return gF(this,t,i,n),this}addMark(t,i,n){return oF(this,t,i,n),this}removeMark(t,i,n){return rF(this,t,i,n),this}clearIncompatible(t,i,n){return Rm(this,t,i,n),this}};var Pm=Object.create(null),Re=class{constructor(t,i,n){this.$anchor=t,this.$head=i,this.ranges=n||[new Vu(t.min(i),t.max(i))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let t=this.ranges;for(let i=0;i<t.length;i++)if(t[i].$from.pos!=t[i].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(t,i=ae.empty){let n=i.content.lastChild,o=null;for(let a=0;a<i.openEnd;a++)o=n,n=n.lastChild;let r=t.steps.length,s=this.ranges;for(let a=0;a<s.length;a++){let{$from:l,$to:c}=s[a],d=t.mapping.slice(r);t.replaceRange(d.map(l.pos),d.map(c.pos),a?ae.empty:i),a==0&&s2(t,r,(n?n.isInline:o&&o.isTextblock)?-1:1)}}replaceWith(t,i){let n=t.steps.length,o=this.ranges;for(let r=0;r<o.length;r++){let{$from:s,$to:a}=o[r],l=t.mapping.slice(n),c=l.map(s.pos),d=l.map(a.pos);r?t.deleteRange(c,d):(t.replaceRangeWith(c,d,i),s2(t,n,i.isInline?-1:1))}}static findFrom(t,i,n=!1){let o=t.parent.inlineContent?new Se(t):Wa(t.node(0),t.parent,t.pos,t.index(),i,n);if(o)return o;for(let r=t.depth-1;r>=0;r--){let s=i<0?Wa(t.node(0),t.node(r),t.before(r+1),t.index(r),i,n):Wa(t.node(0),t.node(r),t.after(r+1),t.index(r)+1,i,n);if(s)return s}return null}static near(t,i=1){return this.findFrom(t,i)||this.findFrom(t,-i)||new Di(t.node(0))}static atStart(t){return Wa(t,t,0,0,1)||new Di(t)}static atEnd(t){return Wa(t,t,t.content.size,t.childCount,-1)||new Di(t)}static fromJSON(t,i){if(!i||!i.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=Pm[i.type];if(!n)throw new RangeError(`No selection type ${i.type} defined`);return n.fromJSON(t,i)}static jsonID(t,i){if(t in Pm)throw new RangeError("Duplicate use of selection JSON ID "+t);return Pm[t]=i,i.prototype.jsonID=t,i}getBookmark(){return Se.between(this.$anchor,this.$head).getBookmark()}};Re.prototype.visible=!0;var Vu=class{constructor(t,i){this.$from=t,this.$to=i}},o2=!1;function r2(e){!o2&&!e.parent.inlineContent&&(o2=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}var Se=class e extends Re{constructor(t,i=t){r2(t),r2(i),super(t,i)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(t,i){let n=t.resolve(i.map(this.head));if(!n.parent.inlineContent)return Re.near(n);let o=t.resolve(i.map(this.anchor));return new e(o.parent.inlineContent?o:n,n)}replace(t,i=ae.empty){if(super.replace(t,i),i==ae.empty){let n=this.$from.marksAcross(this.$to);n&&t.ensureMarks(n)}}eq(t){return t instanceof e&&t.anchor==this.anchor&&t.head==this.head}getBookmark(){return new Gu(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(t,i){if(typeof i.anchor!="number"||typeof i.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new e(t.resolve(i.anchor),t.resolve(i.head))}static create(t,i,n=i){let o=t.resolve(i);return new this(o,n==i?o:t.resolve(n))}static between(t,i,n){let o=t.pos-i.pos;if((!n||o)&&(n=o>=0?1:-1),!i.parent.inlineContent){let r=Re.findFrom(i,n,!0)||Re.findFrom(i,-n,!0);if(r)i=r.$head;else return Re.near(i,n)}return t.parent.inlineContent||(o==0?t=i:(t=(Re.findFrom(t,-n,!0)||Re.findFrom(t,n,!0)).$anchor,t.pos<i.pos!=o<0&&(t=i))),new e(t,i)}};Re.jsonID("text",Se);var Gu=class e{constructor(t,i){this.anchor=t,this.head=i}map(t){return new e(t.map(this.anchor),t.map(this.head))}resolve(t){return Se.between(t.resolve(this.anchor),t.resolve(this.head))}},pe=class e extends Re{constructor(t){let i=t.nodeAfter,n=t.node(0).resolve(t.pos+i.nodeSize);super(t,n),this.node=i}map(t,i){let{deleted:n,pos:o}=i.mapResult(this.anchor),r=t.resolve(o);return n?Re.near(r):new e(r)}content(){return new ae(Y.from(this.node),0,0)}eq(t){return t instanceof e&&t.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Mm(this.anchor)}static fromJSON(t,i){if(typeof i.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new e(t.resolve(i.anchor))}static create(t,i){return new e(t.resolve(i))}static isSelectable(t){return!t.isText&&t.type.spec.selectable!==!1}};pe.prototype.visible=!1;Re.jsonID("node",pe);var Mm=class e{constructor(t){this.anchor=t}map(t){let{deleted:i,pos:n}=t.mapResult(this.anchor);return i?new Gu(n,n):new e(n)}resolve(t){let i=t.resolve(this.anchor),n=i.nodeAfter;return n&&pe.isSelectable(n)?new pe(i):Re.near(i)}},Di=class e extends Re{constructor(t){super(t.resolve(0),t.resolve(t.content.size))}replace(t,i=ae.empty){if(i==ae.empty){t.delete(0,t.doc.content.size);let n=Re.atStart(t.doc);n.eq(t.selection)||t.setSelection(n)}else super.replace(t,i)}toJSON(){return{type:"all"}}static fromJSON(t){return new e(t)}map(t){return new e(t)}eq(t){return t instanceof e}getBookmark(){return xF}};Re.jsonID("all",Di);var xF={map(){return this},resolve(e){return new Di(e)}};function Wa(e,t,i,n,o,r=!1){if(t.inlineContent)return Se.create(e,i);for(let s=n-(o>0?0:1);o>0?s<t.childCount:s>=0;s+=o){let a=t.child(s);if(a.isAtom){if(!r&&pe.isSelectable(a))return pe.create(e,i-(o<0?a.nodeSize:0))}else{let l=Wa(e,a,i+o,o<0?a.childCount:0,o,r);if(l)return l}i+=a.nodeSize*o}return null}function s2(e,t,i){let n=e.steps.length-1;if(n<t)return;let o=e.steps[n];if(!(o instanceof pi||o instanceof Nt))return;let r=e.mapping.maps[n],s;r.forEach((a,l,c,d)=>{s==null&&(s=d)}),e.setSelection(Re.near(e.doc.resolve(s),i))}var a2=1,Hu=2,l2=4,km=class extends Ga{constructor(t){super(t.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=t.selection,this.storedMarks=t.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=(this.updated|a2)&~Hu,this.storedMarks=null,this}get selectionSet(){return(this.updated&a2)>0}setStoredMarks(t){return this.storedMarks=t,this.updated|=Hu,this}ensureMarks(t){return it.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this}addStoredMark(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Hu)>0}addStep(t,i){super.addStep(t,i),this.updated=this.updated&~Hu,this.storedMarks=null}setTime(t){return this.time=t,this}replaceSelection(t){return this.selection.replace(this,t),this}replaceSelectionWith(t,i=!0){let n=this.selection;return i&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||it.none))),n.replaceWith(this,t),this}deleteSelection(){return this.selection.replace(this),this}insertText(t,i,n){let o=this.doc.type.schema;if(i==null)return t?this.replaceSelectionWith(o.text(t),!0):this.deleteSelection();{if(n==null&&(n=i),!t)return this.deleteRange(i,n);let r=this.storedMarks;if(!r){let s=this.doc.resolve(i);r=n==i?s.marks():s.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(i,n,o.text(t,r)),!this.selection.empty&&this.selection.to==i+t.length&&this.setSelection(Re.near(this.selection.$to)),this}}setMeta(t,i){return this.meta[typeof t=="string"?t:t.key]=i,this}getMeta(t){return this.meta[typeof t=="string"?t:t.key]}get isGeneric(){for(let t in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=l2,this}get scrolledIntoView(){return(this.updated&l2)>0}};function c2(e,t){return!t||!e?e:e.bind(t)}var Os=class{constructor(t,i,n){this.name=t,this.init=c2(i.init,n),this.apply=c2(i.apply,n)}},EF=[new Os("doc",{init(e){return e.doc||e.schema.topNodeType.createAndFill()},apply(e){return e.doc}}),new Os("selection",{init(e,t){return e.selection||Re.atStart(t.doc)},apply(e){return e.selection}}),new Os("storedMarks",{init(e){return e.storedMarks||null},apply(e,t,i,n){return n.selection.$cursor?e.storedMarks:null}}),new Os("scrollToSelection",{init(){return 0},apply(e,t){return e.scrolledIntoView?t+1:t}})],xc=class{constructor(t,i){this.schema=t,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=EF.slice(),i&&i.forEach(n=>{if(this.pluginsByKey[n.key])throw new RangeError("Adding different instances of a keyed plugin ("+n.key+")");this.plugins.push(n),this.pluginsByKey[n.key]=n,n.spec.state&&this.fields.push(new Os(n.key,n.spec.state,n))})}},zu=class e{constructor(t){this.config=t}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(t){return this.applyTransaction(t).state}filterTransaction(t,i=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=i){let o=this.config.plugins[n];if(o.spec.filterTransaction&&!o.spec.filterTransaction.call(o,t,this))return!1}return!0}applyTransaction(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};let i=[t],n=this.applyInner(t),o=null;for(;;){let r=!1;for(let s=0;s<this.config.plugins.length;s++){let a=this.config.plugins[s];if(a.spec.appendTransaction){let l=o?o[s].n:0,c=o?o[s].state:this,d=l<i.length&&a.spec.appendTransaction.call(a,l?i.slice(l):i,c,n);if(d&&n.filterTransaction(d,s)){if(d.setMeta("appendedTransaction",t),!o){o=[];for(let u=0;u<this.config.plugins.length;u++)o.push(u<s?{state:n,n:i.length}:{state:this,n:0})}i.push(d),n=n.applyInner(d),r=!0}o&&(o[s]={state:n,n:i.length})}}if(!r)return{state:n,transactions:i}}}applyInner(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let i=new e(this.config),n=this.config.fields;for(let o=0;o<n.length;o++){let r=n[o];i[r.name]=r.apply(t,this[r.name],this,i)}return i}get tr(){return new km(this)}static create(t){let i=new xc(t.doc?t.doc.type.schema:t.schema,t.plugins),n=new e(i);for(let o=0;o<i.fields.length;o++)n[i.fields[o].name]=i.fields[o].init(t,n);return n}reconfigure(t){let i=new xc(this.schema,t.plugins),n=i.fields,o=new e(i);for(let r=0;r<n.length;r++){let s=n[r].name;o[s]=this.hasOwnProperty(s)?this[s]:n[r].init(t,o)}return o}toJSON(t){let i={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(i.storedMarks=this.storedMarks.map(n=>n.toJSON())),t&&typeof t=="object")for(let n in t){if(n=="doc"||n=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let o=t[n],r=o.spec.state;r&&r.toJSON&&(i[n]=r.toJSON.call(o,this[o.key]))}return i}static fromJSON(t,i,n){if(!i)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");let o=new xc(t.schema,t.plugins),r=new e(o);return o.fields.forEach(s=>{if(s.name=="doc")r.doc=Bi.fromJSON(t.schema,i.doc);else if(s.name=="selection")r.selection=Re.fromJSON(r.doc,i.selection);else if(s.name=="storedMarks")i.storedMarks&&(r.storedMarks=i.storedMarks.map(t.schema.markFromJSON));else{if(n)for(let a in n){let l=n[a],c=l.spec.state;if(l.key==s.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(i,a)){r[s.name]=c.fromJSON.call(l,t,i[a],r);return}}r[s.name]=s.init(t,r)}}),r}};function d2(e,t,i){for(let n in e){let o=e[n];o instanceof Function?o=o.bind(t):n=="handleDOMEvents"&&(o=d2(o,t,{})),i[n]=o}return i}var Pe=class{constructor(t){this.spec=t,this.props={},t.props&&d2(t.props,this,this.props),this.key=t.key?t.key.key:u2("plugin")}getState(t){return t[this.key]}},Dm=Object.create(null);function u2(e){return e in Dm?e+"$"+ ++Dm[e]:(Dm[e]=0,e+"$")}var Fe=class{constructor(t="key"){this.key=u2(t)}get(t){return t.config.pluginsByKey[this.key]}getState(t){return t[this.key]}};var Wu=(e,t)=>e.selection.empty?!1:(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function p2(e,t){let{$cursor:i}=e.selection;return!i||(t?!t.endOfTextblock("backward",e):i.parentOffset>0)?null:i}var Fm=(e,t,i)=>{let n=p2(e,i);if(!n)return!1;let o=Am(n);if(!o){let s=n.blockRange(),a=s&&Wo(s);return a==null?!1:(t&&t(e.tr.lift(s,a).scrollIntoView()),!0)}let r=o.nodeBefore;if(S2(e,o,t,-1))return!0;if(n.parent.content.size==0&&(Ua(r,"end")||pe.isSelectable(r)))for(let s=n.depth;;s--){let a=Sc(e.doc,n.before(s),n.after(s),ae.empty);if(a&&a.slice.size<a.to-a.from){if(t){let l=e.tr.step(a);l.setSelection(Ua(r,"end")?Re.findFrom(l.doc.resolve(l.mapping.map(o.pos,-1)),-1):pe.create(l.doc,o.pos-r.nodeSize)),t(l.scrollIntoView())}return!0}if(s==1||n.node(s-1).childCount>1)break}return r.isAtom&&o.depth==n.depth-1?(t&&t(e.tr.delete(o.pos-r.nodeSize,o.pos).scrollIntoView()),!0):!1},g2=(e,t,i)=>{let n=p2(e,i);if(!n)return!1;let o=Am(n);return o?m2(e,o,t):!1},f2=(e,t,i)=>{let n=v2(e,i);if(!n)return!1;let o=Nm(n);return o?m2(e,o,t):!1};function m2(e,t,i){let n=t.nodeBefore,o=n,r=t.pos-1;for(;!o.isTextblock;r--){if(o.type.spec.isolating)return!1;let d=o.lastChild;if(!d)return!1;o=d}let s=t.nodeAfter,a=s,l=t.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let d=a.firstChild;if(!d)return!1;a=d}let c=Sc(e.doc,r,l,ae.empty);if(!c||c.from!=r||c instanceof pi&&c.slice.size>=l-r)return!1;if(i){let d=e.tr.step(c);d.setSelection(Se.create(d.doc,r)),i(d.scrollIntoView())}return!0}function Ua(e,t,i=!1){for(let n=e;n;n=t=="start"?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(i&&n.childCount!=1)return!1}return!1}var Im=(e,t,i)=>{let{$head:n,empty:o}=e.selection,r=n;if(!o)return!1;if(n.parent.isTextblock){if(i?!i.endOfTextblock("backward",e):n.parentOffset>0)return!1;r=Am(n)}let s=r&&r.nodeBefore;return!s||!pe.isSelectable(s)?!1:(t&&t(e.tr.setSelection(pe.create(e.doc,r.pos-s.nodeSize)).scrollIntoView()),!0)};function Am(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function v2(e,t){let{$cursor:i}=e.selection;return!i||(t?!t.endOfTextblock("forward",e):i.parentOffset<i.parent.content.size)?null:i}var Lm=(e,t,i)=>{let n=v2(e,i);if(!n)return!1;let o=Nm(n);if(!o)return!1;let r=o.nodeAfter;if(S2(e,o,t,1))return!0;if(n.parent.content.size==0&&(Ua(r,"start")||pe.isSelectable(r))){let s=Sc(e.doc,n.before(),n.after(),ae.empty);if(s&&s.slice.size<s.to-s.from){if(t){let a=e.tr.step(s);a.setSelection(Ua(r,"start")?Re.findFrom(a.doc.resolve(a.mapping.map(o.pos)),1):pe.create(a.doc,a.mapping.map(o.pos))),t(a.scrollIntoView())}return!0}}return r.isAtom&&o.depth==n.depth-1?(t&&t(e.tr.delete(o.pos,o.pos+r.nodeSize).scrollIntoView()),!0):!1},Om=(e,t,i)=>{let{$head:n,empty:o}=e.selection,r=n;if(!o)return!1;if(n.parent.isTextblock){if(i?!i.endOfTextblock("forward",e):n.parentOffset<n.parent.content.size)return!1;r=Nm(n)}let s=r&&r.nodeAfter;return!s||!pe.isSelectable(s)?!1:(t&&t(e.tr.setSelection(pe.create(e.doc,r.pos)).scrollIntoView()),!0)};function Nm(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let i=e.node(t);if(e.index(t)+1<i.childCount)return e.doc.resolve(e.after(t+1));if(i.type.spec.isolating)break}return null}var C2=(e,t)=>{let i=e.selection,n=i instanceof pe,o;if(n){if(i.node.isTextblock||!cn(e.doc,i.from))return!1;o=i.from}else if(o=Ls(e.doc,i.from,-1),o==null)return!1;if(t){let r=e.tr.join(o);n&&r.setSelection(pe.create(r.doc,o-e.doc.resolve(o).nodeBefore.nodeSize)),t(r.scrollIntoView())}return!0},w2=(e,t)=>{let i=e.selection,n;if(i instanceof pe){if(i.node.isTextblock||!cn(e.doc,i.to))return!1;n=i.to}else if(n=Ls(e.doc,i.to,1),n==null)return!1;return t&&t(e.tr.join(n).scrollIntoView()),!0},b2=(e,t)=>{let{$from:i,$to:n}=e.selection,o=i.blockRange(n),r=o&&Wo(o);return r==null?!1:(t&&t(e.tr.lift(o,r).scrollIntoView()),!0)},Bm=(e,t)=>{let{$head:i,$anchor:n}=e.selection;return!i.parent.type.spec.code||!i.sameParent(n)?!1:(t&&t(e.tr.insertText(`
`).scrollIntoView()),!0)};function Hm(e){for(let t=0;t<e.edgeCount;t++){let{type:i}=e.edge(t);if(i.isTextblock&&!i.hasRequiredAttrs())return i}return null}var Vm=(e,t)=>{let{$head:i,$anchor:n}=e.selection;if(!i.parent.type.spec.code||!i.sameParent(n))return!1;let o=i.node(-1),r=i.indexAfter(-1),s=Hm(o.contentMatchAt(r));if(!s||!o.canReplaceWith(r,r,s))return!1;if(t){let a=i.after(),l=e.tr.replaceWith(a,a,s.createAndFill());l.setSelection(Re.near(l.doc.resolve(a),1)),t(l.scrollIntoView())}return!0},Gm=(e,t)=>{let i=e.selection,{$from:n,$to:o}=i;if(i instanceof Di||n.parent.inlineContent||o.parent.inlineContent)return!1;let r=Hm(o.parent.contentMatchAt(o.indexAfter()));if(!r||!r.isTextblock)return!1;if(t){let s=(!n.parentOffset&&o.index()<o.parent.childCount?n:o).pos,a=e.tr.insert(s,r.createAndFill());a.setSelection(Se.create(a.doc,s+1)),t(a.scrollIntoView())}return!0},zm=(e,t)=>{let{$cursor:i}=e.selection;if(!i||i.parent.content.size)return!1;if(i.depth>1&&i.after()!=i.end(-1)){let r=i.before();if(Ji(e.doc,r))return t&&t(e.tr.split(r).scrollIntoView()),!0}let n=i.blockRange(),o=n&&Wo(n);return o==null?!1:(t&&t(e.tr.lift(n,o).scrollIntoView()),!0)};function _F(e){return(t,i)=>{let{$from:n,$to:o}=t.selection;if(t.selection instanceof pe&&t.selection.node.isBlock)return!n.parentOffset||!Ji(t.doc,n.pos)?!1:(i&&i(t.tr.split(n.pos).scrollIntoView()),!0);if(!n.depth)return!1;let r=[],s,a,l=!1,c=!1;for(let p=n.depth;;p--)if(n.node(p).isBlock){l=n.end(p)==n.pos+(n.depth-p),c=n.start(p)==n.pos-(n.depth-p),a=Hm(n.node(p-1).contentMatchAt(n.indexAfter(p-1)));let f=e&&e(o.parent,l,n);r.unshift(f||(l&&a?{type:a}:null)),s=p;break}else{if(p==1)return!1;r.unshift(null)}let d=t.tr;(t.selection instanceof Se||t.selection instanceof Di)&&d.deleteSelection();let u=d.mapping.map(n.pos),h=Ji(d.doc,u,r.length,r);if(h||(r[0]=a?{type:a}:null,h=Ji(d.doc,u,r.length,r)),!h)return!1;if(d.split(u,r.length,r),!l&&c&&n.node(s).type!=a){let p=d.mapping.map(n.before(s)),g=d.doc.resolve(p);a&&n.node(s-1).canReplaceWith(g.index(),g.index()+1,a)&&d.setNodeMarkup(d.mapping.map(n.before(s)),a)}return i&&i(d.scrollIntoView()),!0}}var RF=_F();var y2=(e,t)=>{let{$from:i,to:n}=e.selection,o,r=i.sharedDepth(n);return r==0?!1:(o=i.before(r),t&&t(e.tr.setSelection(pe.create(e.doc,o))),!0)},PF=(e,t)=>(t&&t(e.tr.setSelection(new Di(e.doc))),!0);function DF(e,t,i){let n=t.nodeBefore,o=t.nodeAfter,r=t.index();return!n||!o||!n.type.compatibleContent(o.type)?!1:!n.content.size&&t.parent.canReplace(r-1,r)?(i&&i(e.tr.delete(t.pos-n.nodeSize,t.pos).scrollIntoView()),!0):!t.parent.canReplace(r,r+1)||!(o.isTextblock||cn(e.doc,t.pos))?!1:(i&&i(e.tr.join(t.pos).scrollIntoView()),!0)}function S2(e,t,i,n){let o=t.nodeBefore,r=t.nodeAfter,s,a,l=o.type.spec.isolating||r.type.spec.isolating;if(!l&&DF(e,t,i))return!0;let c=!l&&t.parent.canReplace(t.index(),t.index()+1);if(c&&(s=(a=o.contentMatchAt(o.childCount)).findWrapping(r.type))&&a.matchType(s[0]||r.type).validEnd){if(i){let p=t.pos+r.nodeSize,g=Y.empty;for(let v=s.length-1;v>=0;v--)g=Y.from(s[v].create(null,g));g=Y.from(o.copy(g));let f=e.tr.step(new Nt(t.pos-1,p,t.pos,p,new ae(g,1,0),s.length,!0)),m=f.doc.resolve(p+2*s.length);m.nodeAfter&&m.nodeAfter.type==o.type&&cn(f.doc,m.pos)&&f.join(m.pos),i(f.scrollIntoView())}return!0}let d=r.type.spec.isolating||n>0&&l?null:Re.findFrom(t,1),u=d&&d.$from.blockRange(d.$to),h=u&&Wo(u);if(h!=null&&h>=t.depth)return i&&i(e.tr.lift(u,h).scrollIntoView()),!0;if(c&&Ua(r,"start",!0)&&Ua(o,"end")){let p=o,g=[];for(;g.push(p),!p.isTextblock;)p=p.lastChild;let f=r,m=1;for(;!f.isTextblock;f=f.firstChild)m++;if(p.canReplace(p.childCount,p.childCount,f.content)){if(i){let v=Y.empty;for(let w=g.length-1;w>=0;w--)v=Y.from(g[w].copy(v));let C=e.tr.step(new Nt(t.pos-g.length,t.pos+r.nodeSize,t.pos+m,t.pos+r.nodeSize-m,new ae(v,g.length,0),0,!0));i(C.scrollIntoView())}return!0}}return!1}function x2(e){return function(t,i){let n=t.selection,o=e<0?n.$from:n.$to,r=o.depth;for(;o.node(r).isInline;){if(!r)return!1;r--}return o.node(r).isTextblock?(i&&i(t.tr.setSelection(Se.create(t.doc,e<0?o.start(r):o.end(r)))),!0):!1}}var Wm=x2(-1),Um=x2(1);function E2(e,t=null){return function(i,n){let{$from:o,$to:r}=i.selection,s=o.blockRange(r),a=s&&za(s,e,t);return a?(n&&n(i.tr.wrap(s,a).scrollIntoView()),!0):!1}}function qm(e,t=null){return function(i,n){let o=!1;for(let r=0;r<i.selection.ranges.length&&!o;r++){let{$from:{pos:s},$to:{pos:a}}=i.selection.ranges[r];i.doc.nodesBetween(s,a,(l,c)=>{if(o)return!1;if(!(!l.isTextblock||l.hasMarkup(e,t)))if(l.type==e)o=!0;else{let d=i.doc.resolve(c),u=d.index();o=d.parent.canReplaceWith(u,u+1,e)}})}if(!o)return!1;if(n){let r=i.tr;for(let s=0;s<i.selection.ranges.length;s++){let{$from:{pos:a},$to:{pos:l}}=i.selection.ranges[s];r.setBlockType(a,l,e,t)}n(r.scrollIntoView())}return!0}}function $m(...e){return function(t,i,n){for(let o=0;o<e.length;o++)if(e[o](t,i,n))return!0;return!1}}var Tm=$m(Wu,Fm,Im),h2=$m(Wu,Lm,Om),Lr={Enter:$m(Bm,Gm,zm,RF),"Mod-Enter":Vm,Backspace:Tm,"Mod-Backspace":Tm,"Shift-Backspace":Tm,Delete:h2,"Mod-Delete":h2,"Mod-a":PF},MF={"Ctrl-h":Lr.Backspace,"Alt-Backspace":Lr["Mod-Backspace"],"Ctrl-d":Lr.Delete,"Ctrl-Alt-Backspace":Lr["Mod-Delete"],"Alt-Delete":Lr["Mod-Delete"],"Alt-d":Lr["Mod-Delete"],"Ctrl-a":Wm,"Ctrl-e":Um};for(let e in Lr)MF[e]=Lr[e];var hde=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform?os.platform()=="darwin":!1;function _2(e,t=null){return function(i,n){let{$from:o,$to:r}=i.selection,s=o.blockRange(r);if(!s)return!1;let a=n?i.tr:null;return kF(a,s,e,t)?(n&&n(a.scrollIntoView()),!0):!1}}function kF(e,t,i,n=null){let o=!1,r=t,s=t.$from.doc;if(t.depth>=2&&t.$from.node(t.depth-1).type.compatibleContent(i)&&t.startIndex==0){if(t.$from.index(t.depth-1)==0)return!1;let l=s.resolve(t.start-2);r=new Is(l,l,t.depth),t.endIndex<t.parent.childCount&&(t=new Is(t.$from,s.resolve(t.$to.end(t.depth)),t.depth)),o=!0}let a=za(r,i,n,t);return a?(e&&TF(e,t,a,o,i),!0):!1}function TF(e,t,i,n,o){let r=Y.empty;for(let d=i.length-1;d>=0;d--)r=Y.from(i[d].type.create(i[d].attrs,r));e.step(new Nt(t.start-(n?2:0),t.end,t.start,t.end,new ae(r,0,0),i.length,!0));let s=0;for(let d=0;d<i.length;d++)i[d].type==o&&(s=d+1);let a=i.length-s,l=t.start+i.length-(n?2:0),c=t.parent;for(let d=t.startIndex,u=t.endIndex,h=!0;d<u;d++,h=!1)!h&&Ji(e.doc,l,a)&&(e.split(l,a),l+=2*a),l+=c.child(d).nodeSize;return e}function R2(e){return function(t,i){let{$from:n,$to:o}=t.selection,r=n.blockRange(o,s=>s.childCount>0&&s.firstChild.type==e);return r?i?n.node(r.depth-1).type==e?FF(t,i,e,r):IF(t,i,r):!0:!1}}function FF(e,t,i,n){let o=e.tr,r=n.end,s=n.$to.end(n.depth);r<s&&(o.step(new Nt(r-1,s,r,s,new ae(Y.from(i.create(null,n.parent.copy())),1,0),1,!0)),n=new Is(o.doc.resolve(n.$from.pos),o.doc.resolve(s),n.depth));let a=Wo(n);if(a==null)return!1;o.lift(n,a);let l=o.doc.resolve(o.mapping.map(r,-1)-1);return cn(o.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&o.join(l.pos),t(o.scrollIntoView()),!0}function IF(e,t,i){let n=e.tr,o=i.parent;for(let p=i.end,g=i.endIndex-1,f=i.startIndex;g>f;g--)p-=o.child(g).nodeSize,n.delete(p-1,p+1);let r=n.doc.resolve(i.start),s=r.nodeAfter;if(n.mapping.map(i.end)!=i.start+r.nodeAfter.nodeSize)return!1;let a=i.startIndex==0,l=i.endIndex==o.childCount,c=r.node(-1),d=r.index(-1);if(!c.canReplace(d+(a?0:1),d+1,s.content.append(l?Y.empty:Y.from(o))))return!1;let u=r.pos,h=u+s.nodeSize;return n.step(new Nt(u-(a?1:0),h+(l?1:0),u+1,h-1,new ae((a?Y.empty:Y.from(o.copy(Y.empty))).append(l?Y.empty:Y.from(o.copy(Y.empty))),a?0:1,l?0:1),a?0:1)),t(n.scrollIntoView()),!0}function P2(e){return function(t,i){let{$from:n,$to:o}=t.selection,r=n.blockRange(o,c=>c.childCount>0&&c.firstChild.type==e);if(!r)return!1;let s=r.startIndex;if(s==0)return!1;let a=r.parent,l=a.child(s-1);if(l.type!=e)return!1;if(i){let c=l.lastChild&&l.lastChild.type==a.type,d=Y.from(c?e.create():null),u=new ae(Y.from(e.create(null,Y.from(a.type.create(null,d)))),c?3:1,0),h=r.start,p=r.end;i(t.tr.step(new Nt(h-(c?3:1),p,h,p,u,1,!0)).scrollIntoView())}return!0}}var oi=function(e){for(var t=0;;t++)if(e=e.previousSibling,!e)return t},Ya=function(e){let t=e.assignedSlot||e.parentNode;return t&&t.nodeType==11?t.host:t},Qm=null,qo=function(e,t,i){let n=Qm||(Qm=document.createRange());return n.setEnd(e,i??e.nodeValue.length),n.setStart(e,t||0),n},AF=function(){Qm=null},Ws=function(e,t,i,n){return i&&(D2(e,t,i,n,-1)||D2(e,t,i,n,1))},LF=/^(img|br|input|textarea|hr)$/i;function D2(e,t,i,n,o){for(var r;;){if(e==i&&t==n)return!0;if(t==(o<0?0:un(e))){let s=e.parentNode;if(!s||s.nodeType!=1||Tc(e)||LF.test(e.nodeName)||e.contentEditable=="false")return!1;t=oi(e)+(o<0?0:1),e=s}else if(e.nodeType==1){let s=e.childNodes[t+(o<0?-1:0)];if(s.nodeType==1&&s.contentEditable=="false")if(!((r=s.pmViewDesc)===null||r===void 0)&&r.ignoreForSelection)t+=o;else return!1;else e=s,t=o<0?un(e):0}else return!1}}function un(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function OF(e,t){for(;;){if(e.nodeType==3&&t)return e;if(e.nodeType==1&&t>0){if(e.contentEditable=="false")return null;e=e.childNodes[t-1],t=un(e)}else if(e.parentNode&&!Tc(e))t=oi(e),e=e.parentNode;else return null}}function NF(e,t){for(;;){if(e.nodeType==3&&t<e.nodeValue.length)return e;if(e.nodeType==1&&t<e.childNodes.length){if(e.contentEditable=="false")return null;e=e.childNodes[t],t=0}else if(e.parentNode&&!Tc(e))t=oi(e)+1,e=e.parentNode;else return null}}function BF(e,t,i){for(let n=t==0,o=t==un(e);n||o;){if(e==i)return!0;let r=oi(e);if(e=e.parentNode,!e)return!1;n=n&&r==0,o=o&&r==un(e)}}function Tc(e){let t;for(let i=e;i&&!(t=i.pmViewDesc);i=i.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}var eh=function(e){return e.focusNode&&Ws(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function Ns(e,t){let i=document.createEvent("Event");return i.initEvent("keydown",!0,!0),i.keyCode=e,i.key=i.code=t,i}function HF(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}function VF(e,t,i){if(e.caretPositionFromPoint)try{let n=e.caretPositionFromPoint(t,i);if(n)return{node:n.offsetNode,offset:Math.min(un(n.offsetNode),n.offset)}}catch{}if(e.caretRangeFromPoint){let n=e.caretRangeFromPoint(t,i);if(n)return{node:n.startContainer,offset:Math.min(un(n.startContainer),n.startOffset)}}}var io=typeof navigator<"u"?navigator:null,M2=typeof document<"u"?document:null,Gr=io&&io.userAgent||"",Zm=/Edge\/(\d+)/.exec(Gr),a3=/MSIE \d/.exec(Gr),e0=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Gr),Hi=!!(a3||e0||Zm),Hr=a3?document.documentMode:e0?+e0[1]:Zm?+Zm[1]:0,hn=!Hi&&/gecko\/(\d+)/i.test(Gr);hn&&+(/Firefox\/(\d+)/.exec(Gr)||[0,0])[1];var t0=!Hi&&/Chrome\/(\d+)/.exec(Gr),fi=!!t0,l3=t0?+t0[1]:0,Mi=!Hi&&!!io&&/Apple Computer/.test(io.vendor),Xa=Mi&&(/Mobile\/\w+/.test(Gr)||!!io&&io.maxTouchPoints>2),dn=Xa||(io?/Mac/.test(io.platform):!1),GF=io?/Win/.test(io.platform):!1,$o=/Android \d/.test(Gr),Fc=!!M2&&"webkitFontSmoothing"in M2.documentElement.style,zF=Fc?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function WF(e){let t=e.defaultView&&e.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function Uo(e,t){return typeof e=="number"?e:e[t]}function UF(e){let t=e.getBoundingClientRect(),i=t.width/e.offsetWidth||1,n=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*i,top:t.top,bottom:t.top+e.clientHeight*n}}function k2(e,t,i){let n=e.someProp("scrollThreshold")||0,o=e.someProp("scrollMargin")||5,r=e.dom.ownerDocument;for(let s=i||e.dom;s;){if(s.nodeType!=1){s=Ya(s);continue}let a=s,l=a==r.body,c=l?WF(r):UF(a),d=0,u=0;if(t.top<c.top+Uo(n,"top")?u=-(c.top-t.top+Uo(o,"top")):t.bottom>c.bottom-Uo(n,"bottom")&&(u=t.bottom-t.top>c.bottom-c.top?t.top+Uo(o,"top")-c.top:t.bottom-c.bottom+Uo(o,"bottom")),t.left<c.left+Uo(n,"left")?d=-(c.left-t.left+Uo(o,"left")):t.right>c.right-Uo(n,"right")&&(d=t.right-c.right+Uo(o,"right")),d||u)if(l)r.defaultView.scrollBy(d,u);else{let p=a.scrollLeft,g=a.scrollTop;u&&(a.scrollTop+=u),d&&(a.scrollLeft+=d);let f=a.scrollLeft-p,m=a.scrollTop-g;t={left:t.left-f,top:t.top-m,right:t.right-f,bottom:t.bottom-m}}let h=l?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(h))break;s=h=="absolute"?s.offsetParent:Ya(s)}}function qF(e){let t=e.dom.getBoundingClientRect(),i=Math.max(0,t.top),n,o;for(let r=(t.left+t.right)/2,s=i+1;s<Math.min(innerHeight,t.bottom);s+=5){let a=e.root.elementFromPoint(r,s);if(!a||a==e.dom||!e.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=i-20){n=a,o=l.top;break}}return{refDOM:n,refTop:o,stack:c3(e.dom)}}function c3(e){let t=[],i=e.ownerDocument;for(let n=e;n&&(t.push({dom:n,top:n.scrollTop,left:n.scrollLeft}),e!=i);n=Ya(n));return t}function $F({refDOM:e,refTop:t,stack:i}){let n=e?e.getBoundingClientRect().top:0;d3(i,n==0?0:n-t)}function d3(e,t){for(let i=0;i<e.length;i++){let{dom:n,top:o,left:r}=e[i];n.scrollTop!=o+t&&(n.scrollTop=o+t),n.scrollLeft!=r&&(n.scrollLeft=r)}}var qa=null;function jF(e){if(e.setActive)return e.setActive();if(qa)return e.focus(qa);let t=c3(e);e.focus(qa==null?{get preventScroll(){return qa={preventScroll:!0},!0}}:void 0),qa||(qa=!1,d3(t,0))}function u3(e,t){let i,n=2e8,o,r=0,s=t.top,a=t.top,l,c;for(let d=e.firstChild,u=0;d;d=d.nextSibling,u++){let h;if(d.nodeType==1)h=d.getClientRects();else if(d.nodeType==3)h=qo(d).getClientRects();else continue;for(let p=0;p<h.length;p++){let g=h[p];if(g.top<=s&&g.bottom>=a){s=Math.max(g.bottom,s),a=Math.min(g.top,a);let f=g.left>t.left?g.left-t.left:g.right<t.left?t.left-g.right:0;if(f<n){i=d,n=f,o=f&&i.nodeType==3?{left:g.right<t.left?g.right:g.left,top:t.top}:t,d.nodeType==1&&f&&(r=u+(t.left>=(g.left+g.right)/2?1:0));continue}}else g.top>t.top&&!l&&g.left<=t.left&&g.right>=t.left&&(l=d,c={left:Math.max(g.left,Math.min(g.right,t.left)),top:g.top});!i&&(t.left>=g.right&&t.top>=g.top||t.left>=g.left&&t.top>=g.bottom)&&(r=u+1)}}return!i&&l&&(i=l,o=c,n=0),i&&i.nodeType==3?KF(i,o):!i||n&&i.nodeType==1?{node:e,offset:r}:u3(i,o)}function KF(e,t){let i=e.nodeValue.length,n=document.createRange();for(let o=0;o<i;o++){n.setEnd(e,o+1),n.setStart(e,o);let r=Or(n,1);if(r.top!=r.bottom&&m0(t,r))return{node:e,offset:o+(t.left>=(r.left+r.right)/2?1:0)}}return{node:e,offset:0}}function m0(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function YF(e,t){let i=e.parentNode;return i&&/^li$/i.test(i.nodeName)&&t.left<e.getBoundingClientRect().left?i:e}function XF(e,t,i){let{node:n,offset:o}=u3(t,i),r=-1;if(n.nodeType==1&&!n.firstChild){let s=n.getBoundingClientRect();r=s.left!=s.right&&i.left>(s.left+s.right)/2?1:-1}return e.docView.posFromDOM(n,o,r)}function JF(e,t,i,n){let o=-1;for(let r=t,s=!1;r!=e.dom;){let a=e.docView.nearestDesc(r,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(a.dom.nodeName)&&(!s&&l.left>n.left||l.top>n.top?o=a.posBefore:(!s&&l.right<n.left||l.bottom<n.top)&&(o=a.posAfter),s=!0),!a.contentDOM&&o<0&&!a.node.isText))return(a.node.isBlock?n.top<(l.top+l.bottom)/2:n.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;r=a.dom.parentNode}return o>-1?o:e.docView.posFromDOM(t,i,-1)}function h3(e,t,i){let n=e.childNodes.length;if(n&&i.top<i.bottom)for(let o=Math.max(0,Math.min(n-1,Math.floor(n*(t.top-i.top)/(i.bottom-i.top))-2)),r=o;;){let s=e.childNodes[r];if(s.nodeType==1){let a=s.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(m0(t,c))return h3(s,t,c)}}if((r=(r+1)%n)==o)break}return e}function QF(e,t){let i=e.dom.ownerDocument,n,o=0,r=VF(i,t.left,t.top);r&&({node:n,offset:o}=r);let s=(e.root.elementFromPoint?e.root:i).elementFromPoint(t.left,t.top),a;if(!s||!e.dom.contains(s.nodeType!=1?s.parentNode:s)){let c=e.dom.getBoundingClientRect();if(!m0(t,c)||(s=h3(e.dom,t,c),!s))return null}if(Mi)for(let c=s;n&&c;c=Ya(c))c.draggable&&(n=void 0);if(s=YF(s,t),n){if(hn&&n.nodeType==1&&(o=Math.min(o,n.childNodes.length),o<n.childNodes.length)){let d=n.childNodes[o],u;d.nodeName=="IMG"&&(u=d.getBoundingClientRect()).right<=t.left&&u.bottom>t.top&&o++}let c;Fc&&o&&n.nodeType==1&&(c=n.childNodes[o-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=t.top&&o--,n==e.dom&&o==n.childNodes.length-1&&n.lastChild.nodeType==1&&t.top>n.lastChild.getBoundingClientRect().bottom?a=e.state.doc.content.size:(o==0||n.nodeType!=1||n.childNodes[o-1].nodeName!="BR")&&(a=JF(e,n,o,t))}a==null&&(a=XF(e,s,t));let l=e.docView.nearestDesc(s,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function T2(e){return e.top<e.bottom||e.left<e.right}function Or(e,t){let i=e.getClientRects();if(i.length){let n=i[t<0?0:i.length-1];if(T2(n))return n}return Array.prototype.find.call(i,T2)||e.getBoundingClientRect()}var ZF=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function p3(e,t,i){let{node:n,offset:o,atom:r}=e.docView.domFromPos(t,i<0?-1:1),s=Fc||hn;if(n.nodeType==3)if(s&&(ZF.test(n.nodeValue)||(i<0?!o:o==n.nodeValue.length))){let l=Or(qo(n,o,o),i);if(hn&&o&&/\s/.test(n.nodeValue[o-1])&&o<n.nodeValue.length){let c=Or(qo(n,o-1,o-1),-1);if(c.top==l.top){let d=Or(qo(n,o,o+1),-1);if(d.top!=l.top)return Ec(d,d.left<c.left)}}return l}else{let l=o,c=o,d=i<0?1:-1;return i<0&&!o?(c++,d=-1):i>=0&&o==n.nodeValue.length?(l--,d=1):i<0?l--:c++,Ec(Or(qo(n,l,c),d),d<0)}if(!e.state.doc.resolve(t-(r||0)).parent.inlineContent){if(r==null&&o&&(i<0||o==un(n))){let l=n.childNodes[o-1];if(l.nodeType==1)return jm(l.getBoundingClientRect(),!1)}if(r==null&&o<un(n)){let l=n.childNodes[o];if(l.nodeType==1)return jm(l.getBoundingClientRect(),!0)}return jm(n.getBoundingClientRect(),i>=0)}if(r==null&&o&&(i<0||o==un(n))){let l=n.childNodes[o-1],c=l.nodeType==3?qo(l,un(l)-(s?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return Ec(Or(c,1),!1)}if(r==null&&o<un(n)){let l=n.childNodes[o];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?qo(l,0,s?0:1):l.nodeType==1?l:null:null;if(c)return Ec(Or(c,-1),!0)}return Ec(Or(n.nodeType==3?qo(n):n,-i),i>=0)}function Ec(e,t){if(e.width==0)return e;let i=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:i,right:i}}function jm(e,t){if(e.height==0)return e;let i=t?e.top:e.bottom;return{top:i,bottom:i,left:e.left,right:e.right}}function g3(e,t,i){let n=e.state,o=e.root.activeElement;n!=t&&e.updateState(t),o!=e.dom&&e.focus();try{return i()}finally{n!=t&&e.updateState(n),o!=e.dom&&o&&o.focus()}}function e5(e,t,i){let n=t.selection,o=i=="up"?n.$from:n.$to;return g3(e,t,()=>{let{node:r}=e.docView.domFromPos(o.pos,i=="up"?-1:1);for(;;){let a=e.docView.nearestDesc(r,!0);if(!a)break;if(a.node.isBlock){r=a.contentDOM||a.dom;break}r=a.dom.parentNode}let s=p3(e,o.pos,1);for(let a=r.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=qo(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let d=l[c];if(d.bottom>d.top+1&&(i=="up"?s.top-d.top>(d.bottom-s.top)*2:d.bottom-s.bottom>(s.bottom-d.top)*2))return!1}}return!0})}var t5=/[\u0590-\u08ac]/;function i5(e,t,i){let{$head:n}=t.selection;if(!n.parent.isTextblock)return!1;let o=n.parentOffset,r=!o,s=o==n.parent.content.size,a=e.domSelection();return a?!t5.test(n.parent.textContent)||!a.modify?i=="left"||i=="backward"?r:s:g3(e,t,()=>{let{focusNode:l,focusOffset:c,anchorNode:d,anchorOffset:u}=e.domSelectionRange(),h=a.caretBidiLevel;a.modify("move",i,"character");let p=n.depth?e.docView.domAfterPos(n.before()):e.dom,{focusNode:g,focusOffset:f}=e.domSelectionRange(),m=g&&!p.contains(g.nodeType==1?g:g.parentNode)||l==g&&c==f;try{a.collapse(d,u),l&&(l!=d||c!=u)&&a.extend&&a.extend(l,c)}catch{}return h!=null&&(a.caretBidiLevel=h),m}):n.pos==n.start()||n.pos==n.end()}var F2=null,I2=null,A2=!1;function n5(e,t,i){return F2==t&&I2==i?A2:(F2=t,I2=i,A2=i=="up"||i=="down"?e5(e,t,i):i5(e,t,i))}var pn=0,L2=1,Bs=2,no=3,Us=class{constructor(t,i,n,o){this.parent=t,this.children=i,this.dom=n,this.contentDOM=o,this.dirty=pn,n.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,i,n){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let i=0;i<this.children.length;i++)t+=this.children[i].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let i=0,n=this.posAtStart;;i++){let o=this.children[i];if(o==t)return n;n+=o.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,i,n){if(this.contentDOM&&this.contentDOM.contains(t.nodeType==1?t:t.parentNode))if(n<0){let r,s;if(t==this.contentDOM)r=t.childNodes[i-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;r=t.previousSibling}for(;r&&!((s=r.pmViewDesc)&&s.parent==this);)r=r.previousSibling;return r?this.posBeforeChild(s)+s.size:this.posAtStart}else{let r,s;if(t==this.contentDOM)r=t.childNodes[i];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;r=t.nextSibling}for(;r&&!((s=r.pmViewDesc)&&s.parent==this);)r=r.nextSibling;return r?this.posBeforeChild(s):this.posAtEnd}let o;if(t==this.dom&&this.contentDOM)o=i>oi(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))o=t.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(i==0)for(let r=t;;r=r.parentNode){if(r==this.dom){o=!1;break}if(r.previousSibling)break}if(o==null&&i==t.childNodes.length)for(let r=t;;r=r.parentNode){if(r==this.dom){o=!0;break}if(r.nextSibling)break}}return o??n>0?this.posAtEnd:this.posAtStart}nearestDesc(t,i=!1){for(let n=!0,o=t;o;o=o.parentNode){let r=this.getDesc(o),s;if(r&&(!i||r.node))if(n&&(s=r.nodeDOM)&&!(s.nodeType==1?s.contains(t.nodeType==1?t:t.parentNode):s==t))n=!1;else return r}}getDesc(t){let i=t.pmViewDesc;for(let n=i;n;n=n.parent)if(n==this)return i}posFromDOM(t,i,n){for(let o=t;o;o=o.parentNode){let r=this.getDesc(o);if(r)return r.localPosFromDOM(t,i,n)}return-1}descAt(t){for(let i=0,n=0;i<this.children.length;i++){let o=this.children[i],r=n+o.size;if(n==t&&r!=n){for(;!o.border&&o.children.length;)for(let s=0;s<o.children.length;s++){let a=o.children[s];if(a.size){o=a;break}}return o}if(t<r)return o.descAt(t-n-o.border);n=r}}domFromPos(t,i){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let n=0,o=0;for(let r=0;n<this.children.length;n++){let s=this.children[n],a=r+s.size;if(a>t||s instanceof $u){o=t-r;break}r=a}if(o)return this.children[n].domFromPos(o-this.children[n].border,i);for(let r;n&&!(r=this.children[n-1]).size&&r instanceof Uu&&r.side>=0;n--);if(i<=0){let r,s=!0;for(;r=n?this.children[n-1]:null,!(!r||r.dom.parentNode==this.contentDOM);n--,s=!1);return r&&i&&s&&!r.border&&!r.domAtom?r.domFromPos(r.size,i):{node:this.contentDOM,offset:r?oi(r.dom)+1:0}}else{let r,s=!0;for(;r=n<this.children.length?this.children[n]:null,!(!r||r.dom.parentNode==this.contentDOM);n++,s=!1);return r&&s&&!r.border&&!r.domAtom?r.domFromPos(0,i):{node:this.contentDOM,offset:r?oi(r.dom):this.contentDOM.childNodes.length}}}parseRange(t,i,n=0){if(this.children.length==0)return{node:this.contentDOM,from:t,to:i,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let o=-1,r=-1;for(let s=n,a=0;;a++){let l=this.children[a],c=s+l.size;if(o==-1&&t<=c){let d=s+l.border;if(t>=d&&i<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(t,i,d);t=s;for(let u=a;u>0;u--){let h=this.children[u-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){o=oi(h.dom)+1;break}t-=h.size}o==-1&&(o=0)}if(o>-1&&(c>i||a==this.children.length-1)){i=c;for(let d=a+1;d<this.children.length;d++){let u=this.children[d];if(u.size&&u.dom.parentNode==this.contentDOM&&!u.emptyChildAt(-1)){r=oi(u.dom);break}i+=u.size}r==-1&&(r=this.contentDOM.childNodes.length);break}s=c}return{node:this.contentDOM,from:t,to:i,fromOffset:o,toOffset:r}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let i=this.children[t<0?0:this.children.length-1];return i.size==0||i.emptyChildAt(t)}domAfterPos(t){let{node:i,offset:n}=this.domFromPos(t,0);if(i.nodeType!=1||n==i.childNodes.length)throw new RangeError("No node after pos "+t);return i.childNodes[n]}setSelection(t,i,n,o=!1){let r=Math.min(t,i),s=Math.max(t,i);for(let p=0,g=0;p<this.children.length;p++){let f=this.children[p],m=g+f.size;if(r>g&&s<m)return f.setSelection(t-g-f.border,i-g-f.border,n,o);g=m}let a=this.domFromPos(t,t?-1:1),l=i==t?a:this.domFromPos(i,i?-1:1),c=n.root.getSelection(),d=n.domSelectionRange(),u=!1;if((hn||Mi)&&t==i){let{node:p,offset:g}=a;if(p.nodeType==3){if(u=!!(g&&p.nodeValue[g-1]==`
`),u&&g==p.nodeValue.length)for(let f=p,m;f;f=f.parentNode){if(m=f.nextSibling){m.nodeName=="BR"&&(a=l={node:m.parentNode,offset:oi(m)+1});break}let v=f.pmViewDesc;if(v&&v.node&&v.node.isBlock)break}}else{let f=p.childNodes[g-1];u=f&&(f.nodeName=="BR"||f.contentEditable=="false")}}if(hn&&d.focusNode&&d.focusNode!=l.node&&d.focusNode.nodeType==1){let p=d.focusNode.childNodes[d.focusOffset];p&&p.contentEditable=="false"&&(o=!0)}if(!(o||u&&Mi)&&Ws(a.node,a.offset,d.anchorNode,d.anchorOffset)&&Ws(l.node,l.offset,d.focusNode,d.focusOffset))return;let h=!1;if((c.extend||t==i)&&!(u&&hn)){c.collapse(a.node,a.offset);try{t!=i&&c.extend(l.node,l.offset),h=!0}catch{}}if(!h){if(t>i){let g=a;a=l,l=g}let p=document.createRange();p.setEnd(l.node,l.offset),p.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(p)}}ignoreMutation(t){return!this.contentDOM&&t.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,i){for(let n=0,o=0;o<this.children.length;o++){let r=this.children[o],s=n+r.size;if(n==s?t<=s&&i>=n:t<s&&i>n){let a=n+r.border,l=s-r.border;if(t>=a&&i<=l){this.dirty=t==n||i==s?Bs:L2,t==a&&i==l&&(r.contentLost||r.dom.parentNode!=this.contentDOM)?r.dirty=no:r.markDirty(t-a,i-a);return}else r.dirty=r.dom==r.contentDOM&&r.dom.parentNode==this.contentDOM&&!r.children.length?Bs:no}n=s}this.dirty=Bs}markParentsDirty(){let t=1;for(let i=this.parent;i;i=i.parent,t++){let n=t==1?Bs:L2;i.dirty<n&&(i.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(t){return!1}},Uu=class extends Us{constructor(t,i,n,o){let r,s=i.type.toDOM;if(typeof s=="function"&&(s=s(n,()=>{if(!r)return o;if(r.parent)return r.parent.posBeforeChild(r)})),!i.type.spec.raw){if(s.nodeType!=1){let a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(t,[],s,null),this.widget=i,this.widget=i,r=this}matchesWidget(t){return this.dirty==pn&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let i=this.widget.spec.stopEvent;return i?i(t):!1}ignoreMutation(t){return t.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}},i0=class extends Us{constructor(t,i,n,o){super(t,[],i,null),this.textDOM=n,this.text=o}get size(){return this.text.length}localPosFromDOM(t,i){return t!=this.textDOM?this.posAtStart+(i?this.size:0):this.posAtStart+i}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return t.type==="characterData"&&t.target.nodeValue==t.oldValue}},Ja=class e extends Us{constructor(t,i,n,o,r){super(t,[],n,o),this.mark=i,this.spec=r}static create(t,i,n,o){let r=o.nodeViews[i.type.name],s=r&&r(i,o,n);return(!s||!s.dom)&&(s=Vo.renderSpec(document,i.type.spec.toDOM(i,n),null,i.attrs)),new e(t,i,s.dom,s.contentDOM||s.dom,s)}parseRule(){return this.dirty&no||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(t){return this.dirty!=no&&this.mark.eq(t)}markDirty(t,i){if(super.markDirty(t,i),this.dirty!=pn){let n=this.parent;for(;!n.node;)n=n.parent;n.dirty<this.dirty&&(n.dirty=this.dirty),this.dirty=pn}}slice(t,i,n){let o=e.create(this.parent,this.mark,!0,n),r=this.children,s=this.size;i<s&&(r=s0(r,i,s,n)),t>0&&(r=s0(r,0,t,n));for(let a=0;a<r.length;a++)r[a].parent=o;return o.children=r,o}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}},Vr=class e extends Us{constructor(t,i,n,o,r,s,a,l,c){super(t,[],r,s),this.node=i,this.outerDeco=n,this.innerDeco=o,this.nodeDOM=a}static create(t,i,n,o,r,s){let a=r.nodeViews[i.type.name],l,c=a&&a(i,r,()=>{if(!l)return s;if(l.parent)return l.parent.posBeforeChild(l)},n,o),d=c&&c.dom,u=c&&c.contentDOM;if(i.isText){if(!d)d=document.createTextNode(i.text);else if(d.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else d||({dom:d,contentDOM:u}=Vo.renderSpec(document,i.type.spec.toDOM(i),null,i.attrs));!u&&!i.isText&&d.nodeName!="BR"&&(d.hasAttribute("contenteditable")||(d.contentEditable="false"),i.type.spec.draggable&&(d.draggable=!0));let h=d;return d=v3(d,n,i),c?l=new n0(t,i,n,o,d,u||null,h,c,r,s+1):i.isText?new qu(t,i,n,o,d,h,r):new e(t,i,n,o,d,u||null,h,r,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(t.preserveWhitespace="full"),!this.contentDOM)t.getContent=()=>this.node.content;else if(!this.contentLost)t.contentElement=this.contentDOM;else{for(let i=this.children.length-1;i>=0;i--){let n=this.children[i];if(this.dom.contains(n.dom.parentNode)){t.contentElement=n.dom.parentNode;break}}t.contentElement||(t.getContent=()=>Y.empty)}return t}matchesNode(t,i,n){return this.dirty==pn&&t.eq(this.node)&&ju(i,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,i){let n=this.node.inlineContent,o=i,r=t.composing?this.localCompositionInfo(t,i):null,s=r&&r.pos>-1?r:null,a=r&&r.pos<0,l=new r0(this,s&&s.node,t);a5(this.node,this.innerDeco,(c,d,u)=>{c.spec.marks?l.syncToMarks(c.spec.marks,n,t):c.type.side>=0&&!u&&l.syncToMarks(d==this.node.childCount?it.none:this.node.child(d).marks,n,t),l.placeWidget(c,t,o)},(c,d,u,h)=>{l.syncToMarks(c.marks,n,t);let p;l.findNodeMatch(c,d,u,h)||a&&t.state.selection.from>o&&t.state.selection.to<o+c.nodeSize&&(p=l.findIndexWithChild(r.node))>-1&&l.updateNodeAt(c,d,u,p,t)||l.updateNextNode(c,d,u,t,h,o)||l.addNode(c,d,u,t,o),o+=c.nodeSize}),l.syncToMarks([],n,t),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==Bs)&&(s&&this.protectLocalComposition(t,s),f3(this.contentDOM,this.children,t),Xa&&l5(this.dom))}localCompositionInfo(t,i){let{from:n,to:o}=t.state.selection;if(!(t.state.selection instanceof Se)||n<i||o>i+this.node.content.size)return null;let r=t.input.compositionNode;if(!r||!this.dom.contains(r.parentNode))return null;if(this.node.inlineContent){let s=r.nodeValue,a=c5(this.node.content,s,n-i,o-i);return a<0?null:{node:r,pos:a,text:s}}else return{node:r,pos:-1,text:""}}protectLocalComposition(t,{node:i,pos:n,text:o}){if(this.getDesc(i))return;let r=i;for(;r.parentNode!=this.contentDOM;r=r.parentNode){for(;r.previousSibling;)r.parentNode.removeChild(r.previousSibling);for(;r.nextSibling;)r.parentNode.removeChild(r.nextSibling);r.pmViewDesc&&(r.pmViewDesc=void 0)}let s=new i0(this,r,i,o);t.input.compositionNodes.push(s),this.children=s0(this.children,n,n+o.length,t,s)}update(t,i,n,o){return this.dirty==no||!t.sameMarkup(this.node)?!1:(this.updateInner(t,i,n,o),!0)}updateInner(t,i,n,o){this.updateOuterDeco(i),this.node=t,this.innerDeco=n,this.contentDOM&&this.updateChildren(o,this.posAtStart),this.dirty=pn}updateOuterDeco(t){if(ju(t,this.outerDeco))return;let i=this.nodeDOM.nodeType!=1,n=this.dom;this.dom=m3(this.dom,this.nodeDOM,o0(this.outerDeco,this.node,i),o0(t,this.node,i)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}};function O2(e,t,i,n,o){v3(n,t,e);let r=new Vr(void 0,e,t,i,n,n,n,o,0);return r.contentDOM&&r.updateChildren(o,0),r}var qu=class e extends Vr{constructor(t,i,n,o,r,s,a){super(t,i,n,o,r,null,s,a,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,i,n,o){return this.dirty==no||this.dirty!=pn&&!this.inParent()||!t.sameMarkup(this.node)?!1:(this.updateOuterDeco(i),(this.dirty!=pn||t.text!=this.node.text)&&t.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=t.text,o.trackWrites==this.nodeDOM&&(o.trackWrites=null)),this.node=t,this.dirty=pn,!0)}inParent(){let t=this.parent.contentDOM;for(let i=this.nodeDOM;i;i=i.parentNode)if(i==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,i,n){return t==this.nodeDOM?this.posAtStart+Math.min(i,this.node.text.length):super.localPosFromDOM(t,i,n)}ignoreMutation(t){return t.type!="characterData"&&t.type!="selection"}slice(t,i,n){let o=this.node.cut(t,i),r=document.createTextNode(o.text);return new e(this.parent,o,this.outerDeco,this.innerDeco,r,r,n)}markDirty(t,i){super.markDirty(t,i),this.dom!=this.nodeDOM&&(t==0||i==this.nodeDOM.nodeValue.length)&&(this.dirty=no)}get domAtom(){return!1}isText(t){return this.node.text==t}},$u=class extends Us{parseRule(){return{ignore:!0}}matchesHack(t){return this.dirty==pn&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}},n0=class extends Vr{constructor(t,i,n,o,r,s,a,l,c,d){super(t,i,n,o,r,s,a,c,d),this.spec=l}update(t,i,n,o){if(this.dirty==no)return!1;if(this.spec.update&&(this.node.type==t.type||this.spec.multiType)){let r=this.spec.update(t,i,n);return r&&this.updateInner(t,i,n,o),r}else return!this.contentDOM&&!t.isLeaf?!1:super.update(t,i,n,o)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,i,n,o){this.spec.setSelection?this.spec.setSelection(t,i,n.root):super.setSelection(t,i,n,o)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return this.spec.stopEvent?this.spec.stopEvent(t):!1}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}};function f3(e,t,i){let n=e.firstChild,o=!1;for(let r=0;r<t.length;r++){let s=t[r],a=s.dom;if(a.parentNode==e){for(;a!=n;)n=N2(n),o=!0;n=n.nextSibling}else o=!0,e.insertBefore(a,n);if(s instanceof Ja){let l=n?n.previousSibling:e.lastChild;f3(s.contentDOM,s.children,i),n=l?l.nextSibling:e.firstChild}}for(;n;)n=N2(n),o=!0;o&&i.trackWrites==e&&(i.trackWrites=null)}var _c=function(e){e&&(this.nodeName=e)};_c.prototype=Object.create(null);var Hs=[new _c];function o0(e,t,i){if(e.length==0)return Hs;let n=i?Hs[0]:new _c,o=[n];for(let r=0;r<e.length;r++){let s=e[r].type.attrs;if(s){s.nodeName&&o.push(n=new _c(s.nodeName));for(let a in s){let l=s[a];l!=null&&(i&&o.length==1&&o.push(n=new _c(t.isInline?"span":"div")),a=="class"?n.class=(n.class?n.class+" ":"")+l:a=="style"?n.style=(n.style?n.style+";":"")+l:a!="nodeName"&&(n[a]=l))}}}return o}function m3(e,t,i,n){if(i==Hs&&n==Hs)return t;let o=t;for(let r=0;r<n.length;r++){let s=n[r],a=i[r];if(r){let l;a&&a.nodeName==s.nodeName&&o!=e&&(l=o.parentNode)&&l.nodeName.toLowerCase()==s.nodeName||(l=document.createElement(s.nodeName),l.pmIsDeco=!0,l.appendChild(o),a=Hs[0]),o=l}o5(o,a||Hs[0],s)}return o}function o5(e,t,i){for(let n in t)n!="class"&&n!="style"&&n!="nodeName"&&!(n in i)&&e.removeAttribute(n);for(let n in i)n!="class"&&n!="style"&&n!="nodeName"&&i[n]!=t[n]&&e.setAttribute(n,i[n]);if(t.class!=i.class){let n=t.class?t.class.split(" ").filter(Boolean):[],o=i.class?i.class.split(" ").filter(Boolean):[];for(let r=0;r<n.length;r++)o.indexOf(n[r])==-1&&e.classList.remove(n[r]);for(let r=0;r<o.length;r++)n.indexOf(o[r])==-1&&e.classList.add(o[r]);e.classList.length==0&&e.removeAttribute("class")}if(t.style!=i.style){if(t.style){let n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,o;for(;o=n.exec(t.style);)e.style.removeProperty(o[1])}i.style&&(e.style.cssText+=i.style)}}function v3(e,t,i){return m3(e,e,Hs,o0(t,i,e.nodeType!=1))}function ju(e,t){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++)if(!e[i].type.eq(t[i].type))return!1;return!0}function N2(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}var r0=class{constructor(t,i,n){this.lock=i,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=r5(t.node.content,t)}destroyBetween(t,i){if(t!=i){for(let n=t;n<i;n++)this.top.children[n].destroy();this.top.children.splice(t,i-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,i,n){let o=0,r=this.stack.length>>1,s=Math.min(r,t.length);for(;o<s&&(o==r-1?this.top:this.stack[o+1<<1]).matchesMark(t[o])&&t[o].type.spec.spanning!==!1;)o++;for(;o<r;)this.destroyRest(),this.top.dirty=pn,this.index=this.stack.pop(),this.top=this.stack.pop(),r--;for(;r<t.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(t[r])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=Ja.create(this.top,t[r],i,n);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,r++}}findNodeMatch(t,i,n,o){let r=-1,s;if(o>=this.preMatch.index&&(s=this.preMatch.matches[o-this.preMatch.index]).parent==this.top&&s.matchesNode(t,i,n))r=this.top.children.indexOf(s,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(t,i,n)&&!this.preMatch.matched.has(c)){r=a;break}}return r<0?!1:(this.destroyBetween(this.index,r),this.index++,!0)}updateNodeAt(t,i,n,o,r){let s=this.top.children[o];return s.dirty==no&&s.dom==s.contentDOM&&(s.dirty=Bs),s.update(t,i,n,r)?(this.destroyBetween(this.index,o),this.index++,!0):!1}findIndexWithChild(t){for(;;){let i=t.parentNode;if(!i)return-1;if(i==this.top.contentDOM){let n=t.pmViewDesc;if(n){for(let o=this.index;o<this.top.children.length;o++)if(this.top.children[o]==n)return o}return-1}t=i}}updateNextNode(t,i,n,o,r,s){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof Vr){let c=this.preMatch.matched.get(l);if(c!=null&&c!=r)return!1;let d=l.dom,u,h=this.isLocked(d)&&!(t.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==t.text&&l.dirty!=no&&ju(i,l.outerDeco));if(!h&&l.update(t,i,n,o))return this.destroyBetween(this.index,a),l.dom!=d&&(this.changed=!0),this.index++,!0;if(!h&&(u=this.recreateWrapper(l,t,i,n,o,s)))return this.destroyBetween(this.index,a),this.top.children[this.index]=u,u.contentDOM&&(u.dirty=Bs,u.updateChildren(o,s+1),u.dirty=pn),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(t,i,n,o,r,s){if(t.dirty||i.isAtom||!t.children.length||!t.node.content.eq(i.content)||!ju(n,t.outerDeco)||!o.eq(t.innerDeco))return null;let a=Vr.create(this.top,i,n,o,r,s);if(a.contentDOM){a.children=t.children,t.children=[];for(let l of a.children)l.parent=a}return t.destroy(),a}addNode(t,i,n,o,r){let s=Vr.create(this.top,t,i,n,o,r);s.contentDOM&&s.updateChildren(o,r+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(t,i,n){let o=this.index<this.top.children.length?this.top.children[this.index]:null;if(o&&o.matchesWidget(t)&&(t==o.widget||!o.widget.type.toDOM.parentNode))this.index++;else{let r=new Uu(this.top,t,i,n);this.top.children.splice(this.index++,0,r),this.changed=!0}}addTextblockHacks(){let t=this.top.children[this.index-1],i=this.top;for(;t instanceof Ja;)i=t,t=i.children[i.children.length-1];(!t||!(t instanceof qu)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((Mi||fi)&&t&&t.dom.contentEditable=="false"&&this.addHackNode("IMG",i),this.addHackNode("BR",this.top))}addHackNode(t,i){if(i==this.top&&this.index<i.children.length&&i.children[this.index].matchesHack(t))this.index++;else{let n=document.createElement(t);t=="IMG"&&(n.className="ProseMirror-separator",n.alt=""),t=="BR"&&(n.className="ProseMirror-trailingBreak");let o=new $u(this.top,[],n,null);i!=this.top?i.children.push(o):i.children.splice(this.index++,0,o),this.changed=!0}}isLocked(t){return this.lock&&(t==this.lock||t.nodeType==1&&t.contains(this.lock.parentNode))}};function r5(e,t){let i=t,n=i.children.length,o=e.childCount,r=new Map,s=[];e:for(;o>0;){let a;for(;;)if(n){let c=i.children[n-1];if(c instanceof Ja)i=c,n=c.children.length;else{a=c,n--;break}}else{if(i==t)break e;n=i.parent.children.indexOf(i),i=i.parent}let l=a.node;if(l){if(l!=e.child(o-1))break;--o,r.set(a,o),s.push(a)}}return{index:o,matched:r,matches:s.reverse()}}function s5(e,t){return e.type.side-t.type.side}function a5(e,t,i,n){let o=t.locals(e),r=0;if(o.length==0){for(let c=0;c<e.childCount;c++){let d=e.child(c);n(d,o,t.forChild(r,d),c),r+=d.nodeSize}return}let s=0,a=[],l=null;for(let c=0;;){let d,u;for(;s<o.length&&o[s].to==r;){let m=o[s++];m.widget&&(d?(u||(u=[d])).push(m):d=m)}if(d)if(u){u.sort(s5);for(let m=0;m<u.length;m++)i(u[m],c,!!l)}else i(d,c,!!l);let h,p;if(l)p=-1,h=l,l=null;else if(c<e.childCount)p=c,h=e.child(c++);else break;for(let m=0;m<a.length;m++)a[m].to<=r&&a.splice(m--,1);for(;s<o.length&&o[s].from<=r&&o[s].to>r;)a.push(o[s++]);let g=r+h.nodeSize;if(h.isText){let m=g;s<o.length&&o[s].from<m&&(m=o[s].from);for(let v=0;v<a.length;v++)a[v].to<m&&(m=a[v].to);m<g&&(l=h.cut(m-r),h=h.cut(0,m-r),g=m,p=-1)}else for(;s<o.length&&o[s].to<g;)s++;let f=h.isInline&&!h.isLeaf?a.filter(m=>!m.inline):a.slice();n(h,f,t.forChild(r,h),p),r=g}}function l5(e){if(e.nodeName=="UL"||e.nodeName=="OL"){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}function c5(e,t,i,n){for(let o=0,r=0;o<e.childCount&&r<=n;){let s=e.child(o++),a=r;if(r+=s.nodeSize,!s.isText)continue;let l=s.text;for(;o<e.childCount;){let c=e.child(o++);if(r+=c.nodeSize,!c.isText)break;l+=c.text}if(r>=i){if(r>=n&&l.slice(n-t.length-a,n-a)==t)return n-t.length;let c=a<n?l.lastIndexOf(t,n-a-1):-1;if(c>=0&&c+t.length+a>=i)return a+c;if(i==n&&l.length>=n+t.length-a&&l.slice(n-a,n-a+t.length)==t)return n}}return-1}function s0(e,t,i,n,o){let r=[];for(let s=0,a=0;s<e.length;s++){let l=e[s],c=a,d=a+=l.size;c>=i||d<=t?r.push(l):(c<t&&r.push(l.slice(0,t-c,n)),o&&(r.push(o),o=void 0),d>i&&r.push(l.slice(i-c,l.size,n)))}return r}function v0(e,t=null){let i=e.domSelectionRange(),n=e.state.doc;if(!i.focusNode)return null;let o=e.docView.nearestDesc(i.focusNode),r=o&&o.size==0,s=e.docView.posFromDOM(i.focusNode,i.focusOffset,1);if(s<0)return null;let a=n.resolve(s),l,c;if(eh(i)){for(l=s;o&&!o.node;)o=o.parent;let u=o.node;if(o&&u.isAtom&&pe.isSelectable(u)&&o.parent&&!(u.isInline&&BF(i.focusNode,i.focusOffset,o.dom))){let h=o.posBefore;c=new pe(s==h?a:n.resolve(h))}}else{if(i instanceof e.dom.ownerDocument.defaultView.Selection&&i.rangeCount>1){let u=s,h=s;for(let p=0;p<i.rangeCount;p++){let g=i.getRangeAt(p);u=Math.min(u,e.docView.posFromDOM(g.startContainer,g.startOffset,1)),h=Math.max(h,e.docView.posFromDOM(g.endContainer,g.endOffset,-1))}if(u<0)return null;[l,s]=h==e.state.selection.anchor?[h,u]:[u,h],a=n.resolve(s)}else l=e.docView.posFromDOM(i.anchorNode,i.anchorOffset,1);if(l<0)return null}let d=n.resolve(l);if(!c){let u=t=="pointer"||e.state.selection.head<a.pos&&!r?1:-1;c=C0(e,d,a,u)}return c}function C3(e){return e.editable?e.hasFocus():b3(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function jo(e,t=!1){let i=e.state.selection;if(w3(e,i),!!C3(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&fi){let n=e.domSelectionRange(),o=e.domObserver.currentSelection;if(n.anchorNode&&o.anchorNode&&Ws(n.anchorNode,n.anchorOffset,o.anchorNode,o.anchorOffset)){e.input.mouseDown.delayedSelectionSync=!0,e.domObserver.setCurSelection();return}}if(e.domObserver.disconnectSelection(),e.cursorWrapper)u5(e);else{let{anchor:n,head:o}=i,r,s;B2&&!(i instanceof Se)&&(i.$from.parent.inlineContent||(r=H2(e,i.from)),!i.empty&&!i.$from.parent.inlineContent&&(s=H2(e,i.to))),e.docView.setSelection(n,o,e,t),B2&&(r&&V2(r),s&&V2(s)),i.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&d5(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}var B2=Mi||fi&&l3<63;function H2(e,t){let{node:i,offset:n}=e.docView.domFromPos(t,0),o=n<i.childNodes.length?i.childNodes[n]:null,r=n?i.childNodes[n-1]:null;if(Mi&&o&&o.contentEditable=="false")return Km(o);if((!o||o.contentEditable=="false")&&(!r||r.contentEditable=="false")){if(o)return Km(o);if(r)return Km(r)}}function Km(e){return e.contentEditable="true",Mi&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function V2(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function d5(e){let t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);let i=e.domSelectionRange(),n=i.anchorNode,o=i.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{(i.anchorNode!=n||i.anchorOffset!=o)&&(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(()=>{(!C3(e)||e.state.selection.visible)&&e.dom.classList.remove("ProseMirror-hideselection")},20))})}function u5(e){let t=e.domSelection();if(!t)return;let i=e.cursorWrapper.dom,n=i.nodeName=="IMG";n?t.collapse(i.parentNode,oi(i)+1):t.collapse(i,0),!n&&!e.state.selection.visible&&Hi&&Hr<=11&&(i.disabled=!0,i.disabled=!1)}function w3(e,t){if(t instanceof pe){let i=e.docView.descAt(t.from);i!=e.lastSelectedViewDesc&&(G2(e),i&&i.selectNode(),e.lastSelectedViewDesc=i)}else G2(e)}function G2(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function C0(e,t,i,n){return e.someProp("createSelectionBetween",o=>o(e,t,i))||Se.between(t,i,n)}function z2(e){return e.editable&&!e.hasFocus()?!1:b3(e)}function b3(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(t.anchorNode.nodeType==3?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(t.focusNode.nodeType==3?t.focusNode.parentNode:t.focusNode))}catch{return!1}}function h5(e){let t=e.docView.domFromPos(e.state.selection.anchor,0),i=e.domSelectionRange();return Ws(t.node,t.offset,i.anchorNode,i.anchorOffset)}function a0(e,t){let{$anchor:i,$head:n}=e.selection,o=t>0?i.max(n):i.min(n),r=o.parent.inlineContent?o.depth?e.doc.resolve(t>0?o.after():o.before()):null:o;return r&&Re.findFrom(r,t)}function Nr(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function W2(e,t,i){let n=e.state.selection;if(n instanceof Se)if(i.indexOf("s")>-1){let{$head:o}=n,r=o.textOffset?null:t<0?o.nodeBefore:o.nodeAfter;if(!r||r.isText||!r.isLeaf)return!1;let s=e.state.doc.resolve(o.pos+r.nodeSize*(t<0?-1:1));return Nr(e,new Se(n.$anchor,s))}else if(n.empty){if(e.endOfTextblock(t>0?"forward":"backward")){let o=a0(e.state,t);return o&&o instanceof pe?Nr(e,o):!1}else if(!(dn&&i.indexOf("m")>-1)){let o=n.$head,r=o.textOffset?null:t<0?o.nodeBefore:o.nodeAfter,s;if(!r||r.isText)return!1;let a=t<0?o.pos-r.nodeSize:o.pos;return r.isAtom||(s=e.docView.descAt(a))&&!s.contentDOM?pe.isSelectable(r)?Nr(e,new pe(t<0?e.state.doc.resolve(o.pos-r.nodeSize):o)):Fc?Nr(e,new Se(e.state.doc.resolve(t<0?a:a+r.nodeSize))):!1:!1}}else return!1;else{if(n instanceof pe&&n.node.isInline)return Nr(e,new Se(t>0?n.$to:n.$from));{let o=a0(e.state,t);return o?Nr(e,o):!1}}}function Ku(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function Rc(e,t){let i=e.pmViewDesc;return i&&i.size==0&&(t<0||e.nextSibling||e.nodeName!="BR")}function $a(e,t){return t<0?p5(e):g5(e)}function p5(e){let t=e.domSelectionRange(),i=t.focusNode,n=t.focusOffset;if(!i)return;let o,r,s=!1;for(hn&&i.nodeType==1&&n<Ku(i)&&Rc(i.childNodes[n],-1)&&(s=!0);;)if(n>0){if(i.nodeType!=1)break;{let a=i.childNodes[n-1];if(Rc(a,-1))o=i,r=--n;else if(a.nodeType==3)i=a,n=i.nodeValue.length;else break}}else{if(y3(i))break;{let a=i.previousSibling;for(;a&&Rc(a,-1);)o=i.parentNode,r=oi(a),a=a.previousSibling;if(a)i=a,n=Ku(i);else{if(i=i.parentNode,i==e.dom)break;n=0}}}s?l0(e,i,n):o&&l0(e,o,r)}function g5(e){let t=e.domSelectionRange(),i=t.focusNode,n=t.focusOffset;if(!i)return;let o=Ku(i),r,s;for(;;)if(n<o){if(i.nodeType!=1)break;let a=i.childNodes[n];if(Rc(a,1))r=i,s=++n;else break}else{if(y3(i))break;{let a=i.nextSibling;for(;a&&Rc(a,1);)r=a.parentNode,s=oi(a)+1,a=a.nextSibling;if(a)i=a,n=0,o=Ku(i);else{if(i=i.parentNode,i==e.dom)break;n=o=0}}}r&&l0(e,r,s)}function y3(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function f5(e,t){for(;e&&t==e.childNodes.length&&!Tc(e);)t=oi(e)+1,e=e.parentNode;for(;e&&t<e.childNodes.length;){let i=e.childNodes[t];if(i.nodeType==3)return i;if(i.nodeType==1&&i.contentEditable=="false")break;e=i,t=0}}function m5(e,t){for(;e&&!t&&!Tc(e);)t=oi(e),e=e.parentNode;for(;e&&t;){let i=e.childNodes[t-1];if(i.nodeType==3)return i;if(i.nodeType==1&&i.contentEditable=="false")break;e=i,t=e.childNodes.length}}function l0(e,t,i){if(t.nodeType!=3){let r,s;(s=f5(t,i))?(t=s,i=0):(r=m5(t,i))&&(t=r,i=r.nodeValue.length)}let n=e.domSelection();if(!n)return;if(eh(n)){let r=document.createRange();r.setEnd(t,i),r.setStart(t,i),n.removeAllRanges(),n.addRange(r)}else n.extend&&n.extend(t,i);e.domObserver.setCurSelection();let{state:o}=e;setTimeout(()=>{e.state==o&&jo(e)},50)}function U2(e,t){let i=e.state.doc.resolve(t);if(!(fi||GF)&&i.parent.inlineContent){let o=e.coordsAtPos(t);if(t>i.start()){let r=e.coordsAtPos(t-1),s=(r.top+r.bottom)/2;if(s>o.top&&s<o.bottom&&Math.abs(r.left-o.left)>1)return r.left<o.left?"ltr":"rtl"}if(t<i.end()){let r=e.coordsAtPos(t+1),s=(r.top+r.bottom)/2;if(s>o.top&&s<o.bottom&&Math.abs(r.left-o.left)>1)return r.left>o.left?"ltr":"rtl"}}return getComputedStyle(e.dom).direction=="rtl"?"rtl":"ltr"}function q2(e,t,i){let n=e.state.selection;if(n instanceof Se&&!n.empty||i.indexOf("s")>-1||dn&&i.indexOf("m")>-1)return!1;let{$from:o,$to:r}=n;if(!o.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let s=a0(e.state,t);if(s&&s instanceof pe)return Nr(e,s)}if(!o.parent.inlineContent){let s=t<0?o:r,a=n instanceof Di?Re.near(s,t):Re.findFrom(s,t);return a?Nr(e,a):!1}return!1}function $2(e,t){if(!(e.state.selection instanceof Se))return!0;let{$head:i,$anchor:n,empty:o}=e.state.selection;if(!i.sameParent(n))return!0;if(!o)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let r=!i.textOffset&&(t<0?i.nodeBefore:i.nodeAfter);if(r&&!r.isText){let s=e.state.tr;return t<0?s.delete(i.pos-r.nodeSize,i.pos):s.delete(i.pos,i.pos+r.nodeSize),e.dispatch(s),!0}return!1}function j2(e,t,i){e.domObserver.stop(),t.contentEditable=i,e.domObserver.start()}function v5(e){if(!Mi||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:i}=e.domSelectionRange();if(t&&t.nodeType==1&&i==0&&t.firstChild&&t.firstChild.contentEditable=="false"){let n=t.firstChild;j2(e,n,"true"),setTimeout(()=>j2(e,n,"false"),20)}return!1}function C5(e){let t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}function w5(e,t){let i=t.keyCode,n=C5(t);if(i==8||dn&&i==72&&n=="c")return $2(e,-1)||$a(e,-1);if(i==46&&!t.shiftKey||dn&&i==68&&n=="c")return $2(e,1)||$a(e,1);if(i==13||i==27)return!0;if(i==37||dn&&i==66&&n=="c"){let o=i==37?U2(e,e.state.selection.from)=="ltr"?-1:1:-1;return W2(e,o,n)||$a(e,o)}else if(i==39||dn&&i==70&&n=="c"){let o=i==39?U2(e,e.state.selection.from)=="ltr"?1:-1:1;return W2(e,o,n)||$a(e,o)}else{if(i==38||dn&&i==80&&n=="c")return q2(e,-1,n)||$a(e,-1);if(i==40||dn&&i==78&&n=="c")return v5(e)||q2(e,1,n)||$a(e,1);if(n==(dn?"m":"c")&&(i==66||i==73||i==89||i==90))return!0}return!1}function w0(e,t){e.someProp("transformCopied",p=>{t=p(t,e)});let i=[],{content:n,openStart:o,openEnd:r}=t;for(;o>1&&r>1&&n.childCount==1&&n.firstChild.childCount==1;){o--,r--;let p=n.firstChild;i.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),n=p.content}let s=e.someProp("clipboardSerializer")||Vo.fromSchema(e.state.schema),a=P3(),l=a.createElement("div");l.appendChild(s.serializeFragment(n,{document:a}));let c=l.firstChild,d,u=0;for(;c&&c.nodeType==1&&(d=R3[c.nodeName.toLowerCase()]);){for(let p=d.length-1;p>=0;p--){let g=a.createElement(d[p]);for(;l.firstChild;)g.appendChild(l.firstChild);l.appendChild(g),u++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${o} ${r}${u?` -${u}`:""} ${JSON.stringify(i)}`);let h=e.someProp("clipboardTextSerializer",p=>p(t,e))||t.content.textBetween(0,t.content.size,`

`);return{dom:l,text:h,slice:t}}function S3(e,t,i,n,o){let r=o.parent.type.spec.code,s,a;if(!i&&!t)return null;let l=!!t&&(n||r||!i);if(l){if(e.someProp("transformPastedText",h=>{t=h(t,r||n,e)}),r)return a=new ae(Y.from(e.state.schema.text(t.replace(/\r\n?/g,`
`))),0,0),e.someProp("transformPasted",h=>{a=h(a,e,!0)}),a;let u=e.someProp("clipboardTextParser",h=>h(t,o,n,e));if(u)a=u;else{let h=o.marks(),{schema:p}=e.state,g=Vo.fromSchema(p);s=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(f=>{let m=s.appendChild(document.createElement("p"));f&&m.appendChild(g.serializeNode(p.text(f,h)))})}}else e.someProp("transformPastedHTML",u=>{i=u(i,e)}),s=x5(i),Fc&&E5(s);let c=s&&s.querySelector("[data-pm-slice]"),d=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(d&&d[3])for(let u=+d[3];u>0;u--){let h=s.firstChild;for(;h&&h.nodeType!=1;)h=h.nextSibling;if(!h)break;s=h}if(a||(a=(e.someProp("clipboardParser")||e.someProp("domParser")||to.fromSchema(e.state.schema)).parseSlice(s,{preserveWhitespace:!!(l||d),context:o,ruleFromNode(h){return h.nodeName=="BR"&&!h.nextSibling&&h.parentNode&&!b5.test(h.parentNode.nodeName)?{ignore:!0}:null}})),d)a=_5(K2(a,+d[1],+d[2]),d[4]);else if(a=ae.maxOpen(y5(a.content,o),!0),a.openStart||a.openEnd){let u=0,h=0;for(let p=a.content.firstChild;u<a.openStart&&!p.type.spec.isolating;u++,p=p.firstChild);for(let p=a.content.lastChild;h<a.openEnd&&!p.type.spec.isolating;h++,p=p.lastChild);a=K2(a,u,h)}return e.someProp("transformPasted",u=>{a=u(a,e,l)}),a}var b5=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function y5(e,t){if(e.childCount<2)return e;for(let i=t.depth;i>=0;i--){let o=t.node(i).contentMatchAt(t.index(i)),r,s=[];if(e.forEach(a=>{if(!s)return;let l=o.findWrapping(a.type),c;if(!l)return s=null;if(c=s.length&&r.length&&E3(l,r,a,s[s.length-1],0))s[s.length-1]=c;else{s.length&&(s[s.length-1]=_3(s[s.length-1],r.length));let d=x3(a,l);s.push(d),o=o.matchType(d.type),r=l}}),s)return Y.from(s)}return e}function x3(e,t,i=0){for(let n=t.length-1;n>=i;n--)e=t[n].create(null,Y.from(e));return e}function E3(e,t,i,n,o){if(o<e.length&&o<t.length&&e[o]==t[o]){let r=E3(e,t,i,n.lastChild,o+1);if(r)return n.copy(n.content.replaceChild(n.childCount-1,r));if(n.contentMatchAt(n.childCount).matchType(o==e.length-1?i.type:e[o+1]))return n.copy(n.content.append(Y.from(x3(i,e,o+1))))}}function _3(e,t){if(t==0)return e;let i=e.content.replaceChild(e.childCount-1,_3(e.lastChild,t-1)),n=e.contentMatchAt(e.childCount).fillBefore(Y.empty,!0);return e.copy(i.append(n))}function c0(e,t,i,n,o,r){let s=t<0?e.firstChild:e.lastChild,a=s.content;return e.childCount>1&&(r=0),o<n-1&&(a=c0(a,t,i,n,o+1,r)),o>=i&&(a=t<0?s.contentMatchAt(0).fillBefore(a,r<=o).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(Y.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,s.copy(a))}function K2(e,t,i){return t<e.openStart&&(e=new ae(c0(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),i<e.openEnd&&(e=new ae(c0(e.content,1,i,e.openEnd,0,0),e.openStart,i)),e}var R3={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},Y2=null;function P3(){return Y2||(Y2=document.implementation.createHTMLDocument("title"))}var Ym=null;function S5(e){let t=window.trustedTypes;return t?(Ym||(Ym=t.defaultPolicy||t.createPolicy("ProseMirrorClipboard",{createHTML:i=>i})),Ym.createHTML(e)):e}function x5(e){let t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));let i=P3().createElement("div"),n=/<([a-z][^>\s]+)/i.exec(e),o;if((o=n&&R3[n[1].toLowerCase()])&&(e=o.map(r=>"<"+r+">").join("")+e+o.map(r=>"</"+r+">").reverse().join("")),i.innerHTML=S5(e),o)for(let r=0;r<o.length;r++)i=i.querySelector(o[r])||i;return i}function E5(e){let t=e.querySelectorAll(fi?"span:not([class]):not([style])":"span.Apple-converted-space");for(let i=0;i<t.length;i++){let n=t[i];n.childNodes.length==1&&n.textContent=="\xA0"&&n.parentNode&&n.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),n)}}function _5(e,t){if(!e.size)return e;let i=e.content.firstChild.type.schema,n;try{n=JSON.parse(t)}catch{return e}let{content:o,openStart:r,openEnd:s}=e;for(let a=n.length-2;a>=0;a-=2){let l=i.nodes[n[a]];if(!l||l.hasRequiredAttrs())break;o=Y.from(l.create(n[a+1],o)),r++,s++}return new ae(o,r,s)}var ki={},Ti={},R5={touchstart:!0,touchmove:!0},d0=class{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}};function P5(e){for(let t in ki){let i=ki[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=n=>{M5(e,n)&&!b0(e,n)&&(e.editable||!(n.type in Ti))&&i(e,n)},R5[t]?{passive:!0}:void 0)}Mi&&e.dom.addEventListener("input",()=>null),u0(e)}function Br(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function D5(e){e.domObserver.stop();for(let t in e.input.eventHandlers)e.dom.removeEventListener(t,e.input.eventHandlers[t]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}function u0(e){e.someProp("handleDOMEvents",t=>{for(let i in t)e.input.eventHandlers[i]||e.dom.addEventListener(i,e.input.eventHandlers[i]=n=>b0(e,n))})}function b0(e,t){return e.someProp("handleDOMEvents",i=>{let n=i[t.type];return n?n(e,t)||t.defaultPrevented:!1})}function M5(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let i=t.target;i!=e.dom;i=i.parentNode)if(!i||i.nodeType==11||i.pmViewDesc&&i.pmViewDesc.stopEvent(t))return!1;return!0}function k5(e,t){!b0(e,t)&&ki[t.type]&&(e.editable||!(t.type in Ti))&&ki[t.type](e,t)}Ti.keydown=(e,t)=>{let i=t;if(e.input.shiftKey=i.keyCode==16||i.shiftKey,!M3(e,i)&&(e.input.lastKeyCode=i.keyCode,e.input.lastKeyCodeTime=Date.now(),!($o&&fi&&i.keyCode==13)))if(i.keyCode!=229&&e.domObserver.forceFlush(),Xa&&i.keyCode==13&&!i.ctrlKey&&!i.altKey&&!i.metaKey){let n=Date.now();e.input.lastIOSEnter=n,e.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{e.input.lastIOSEnter==n&&(e.someProp("handleKeyDown",o=>o(e,Ns(13,"Enter"))),e.input.lastIOSEnter=0)},200)}else e.someProp("handleKeyDown",n=>n(e,i))||w5(e,i)?i.preventDefault():Br(e,"key")};Ti.keyup=(e,t)=>{t.keyCode==16&&(e.input.shiftKey=!1)};Ti.keypress=(e,t)=>{let i=t;if(M3(e,i)||!i.charCode||i.ctrlKey&&!i.altKey||dn&&i.metaKey)return;if(e.someProp("handleKeyPress",o=>o(e,i))){i.preventDefault();return}let n=e.state.selection;if(!(n instanceof Se)||!n.$from.sameParent(n.$to)){let o=String.fromCharCode(i.charCode),r=()=>e.state.tr.insertText(o).scrollIntoView();!/[\r\n]/.test(o)&&!e.someProp("handleTextInput",s=>s(e,n.$from.pos,n.$to.pos,o,r))&&e.dispatch(r()),i.preventDefault()}};function th(e){return{left:e.clientX,top:e.clientY}}function T5(e,t){let i=t.x-e.clientX,n=t.y-e.clientY;return i*i+n*n<100}function y0(e,t,i,n,o){if(n==-1)return!1;let r=e.state.doc.resolve(n);for(let s=r.depth+1;s>0;s--)if(e.someProp(t,a=>s>r.depth?a(e,i,r.nodeAfter,r.before(s),o,!0):a(e,i,r.node(s),r.before(s),o,!1)))return!0;return!1}function Ka(e,t,i){if(e.focused||e.focus(),e.state.selection.eq(t))return;let n=e.state.tr.setSelection(t);i=="pointer"&&n.setMeta("pointer",!0),e.dispatch(n)}function F5(e,t){if(t==-1)return!1;let i=e.state.doc.resolve(t),n=i.nodeAfter;return n&&n.isAtom&&pe.isSelectable(n)?(Ka(e,new pe(i),"pointer"),!0):!1}function I5(e,t){if(t==-1)return!1;let i=e.state.selection,n,o;i instanceof pe&&(n=i.node);let r=e.state.doc.resolve(t);for(let s=r.depth+1;s>0;s--){let a=s>r.depth?r.nodeAfter:r.node(s);if(pe.isSelectable(a)){n&&i.$from.depth>0&&s>=i.$from.depth&&r.before(i.$from.depth+1)==i.$from.pos?o=r.before(i.$from.depth):o=r.before(s);break}}return o!=null?(Ka(e,pe.create(e.state.doc,o),"pointer"),!0):!1}function A5(e,t,i,n,o){return y0(e,"handleClickOn",t,i,n)||e.someProp("handleClick",r=>r(e,t,n))||(o?I5(e,i):F5(e,i))}function L5(e,t,i,n){return y0(e,"handleDoubleClickOn",t,i,n)||e.someProp("handleDoubleClick",o=>o(e,t,n))}function O5(e,t,i,n){return y0(e,"handleTripleClickOn",t,i,n)||e.someProp("handleTripleClick",o=>o(e,t,n))||N5(e,i,n)}function N5(e,t,i){if(i.button!=0)return!1;let n=e.state.doc;if(t==-1)return n.inlineContent?(Ka(e,Se.create(n,0,n.content.size),"pointer"),!0):!1;let o=n.resolve(t);for(let r=o.depth+1;r>0;r--){let s=r>o.depth?o.nodeAfter:o.node(r),a=o.before(r);if(s.inlineContent)Ka(e,Se.create(n,a+1,a+1+s.content.size),"pointer");else if(pe.isSelectable(s))Ka(e,pe.create(n,a),"pointer");else continue;return!0}}function S0(e){return Yu(e)}var D3=dn?"metaKey":"ctrlKey";ki.mousedown=(e,t)=>{let i=t;e.input.shiftKey=i.shiftKey;let n=S0(e),o=Date.now(),r="singleClick";o-e.input.lastClick.time<500&&T5(i,e.input.lastClick)&&!i[D3]&&e.input.lastClick.button==i.button&&(e.input.lastClick.type=="singleClick"?r="doubleClick":e.input.lastClick.type=="doubleClick"&&(r="tripleClick")),e.input.lastClick={time:o,x:i.clientX,y:i.clientY,type:r,button:i.button};let s=e.posAtCoords(th(i));s&&(r=="singleClick"?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new h0(e,s,i,!!n)):(r=="doubleClick"?L5:O5)(e,s.pos,s.inside,i)?i.preventDefault():Br(e,"pointer"))};var h0=class{constructor(t,i,n,o){this.view=t,this.pos=i,this.event=n,this.flushed=o,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!n[D3],this.allowDefault=n.shiftKey;let r,s;if(i.inside>-1)r=t.state.doc.nodeAt(i.inside),s=i.inside;else{let d=t.state.doc.resolve(i.pos);r=d.parent,s=d.depth?d.before():0}let a=o?null:n.target,l=a?t.docView.nearestDesc(a,!0):null;this.target=l&&l.nodeDOM.nodeType==1?l.nodeDOM:null;let{selection:c}=t.state;(n.button==0&&r.type.spec.draggable&&r.type.spec.selectable!==!1||c instanceof pe&&c.from<=s&&c.to>s)&&(this.mightDrag={node:r,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&hn&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),Br(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>jo(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let i=this.pos;this.view.state.doc!=this.startDoc&&(i=this.view.posAtCoords(th(t))),this.updateAllowDefault(t),this.allowDefault||!i?Br(this.view,"pointer"):A5(this.view,i.pos,i.inside,t,this.selectNode)?t.preventDefault():t.button==0&&(this.flushed||Mi&&this.mightDrag&&!this.mightDrag.node.isAtom||fi&&!this.view.state.selection.visible&&Math.min(Math.abs(i.pos-this.view.state.selection.from),Math.abs(i.pos-this.view.state.selection.to))<=2)?(Ka(this.view,Re.near(this.view.state.doc.resolve(i.pos)),"pointer"),t.preventDefault()):Br(this.view,"pointer")}move(t){this.updateAllowDefault(t),Br(this.view,"pointer"),t.buttons==0&&this.done()}updateAllowDefault(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)}};ki.touchstart=e=>{e.input.lastTouch=Date.now(),S0(e),Br(e,"pointer")};ki.touchmove=e=>{e.input.lastTouch=Date.now(),Br(e,"pointer")};ki.contextmenu=e=>S0(e);function M3(e,t){return e.composing?!0:Mi&&Math.abs(t.timeStamp-e.input.compositionEndedAt)<500?(e.input.compositionEndedAt=-2e8,!0):!1}var B5=$o?5e3:-1;Ti.compositionstart=Ti.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,i=t.selection.$to;if(t.selection instanceof Se&&(t.storedMarks||!i.textOffset&&i.parentOffset&&i.nodeBefore.marks.some(n=>n.type.spec.inclusive===!1)))e.markCursor=e.state.storedMarks||i.marks(),Yu(e,!0),e.markCursor=null;else if(Yu(e,!t.selection.empty),hn&&t.selection.empty&&i.parentOffset&&!i.textOffset&&i.nodeBefore.marks.length){let n=e.domSelectionRange();for(let o=n.focusNode,r=n.focusOffset;o&&o.nodeType==1&&r!=0;){let s=r<0?o.lastChild:o.childNodes[r-1];if(!s)break;if(s.nodeType==3){let a=e.domSelection();a&&a.collapse(s,s.nodeValue.length);break}else o=s,r=-1}}e.input.composing=!0}k3(e,B5)};Ti.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionNode=null,e.input.compositionPendingChanges&&Promise.resolve().then(()=>e.domObserver.flush()),e.input.compositionID++,k3(e,20))};function k3(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout(()=>Yu(e),t))}function T3(e){for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=V5());e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function H5(e){let t=e.domSelectionRange();if(!t.focusNode)return null;let i=OF(t.focusNode,t.focusOffset),n=NF(t.focusNode,t.focusOffset);if(i&&n&&i!=n){let o=n.pmViewDesc,r=e.domObserver.lastChangedTextNode;if(i==r||n==r)return r;if(!o||!o.isText(n.nodeValue))return n;if(e.input.compositionNode==n){let s=i.pmViewDesc;if(!(!s||!s.isText(i.nodeValue)))return n}}return i||n}function V5(){let e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}function Yu(e,t=!1){if(!($o&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),T3(e),t||e.docView&&e.docView.dirty){let i=v0(e),n=e.state.selection;return i&&!i.eq(n)?e.dispatch(e.state.tr.setSelection(i)):(e.markCursor||t)&&!n.$from.node(n.$from.sharedDepth(n.to)).inlineContent?e.dispatch(e.state.tr.deleteSelection()):e.updateState(e.state),!0}return!1}}function G5(e,t){if(!e.dom.parentNode)return;let i=e.dom.parentNode.appendChild(document.createElement("div"));i.appendChild(t),i.style.cssText="position: fixed; left: -10000px; top: 10px";let n=getSelection(),o=document.createRange();o.selectNodeContents(t),e.dom.blur(),n.removeAllRanges(),n.addRange(o),setTimeout(()=>{i.parentNode&&i.parentNode.removeChild(i),e.focus()},50)}var Pc=Hi&&Hr<15||Xa&&zF<604;ki.copy=Ti.cut=(e,t)=>{let i=t,n=e.state.selection,o=i.type=="cut";if(n.empty)return;let r=Pc?null:i.clipboardData,s=n.content(),{dom:a,text:l}=w0(e,s);r?(i.preventDefault(),r.clearData(),r.setData("text/html",a.innerHTML),r.setData("text/plain",l)):G5(e,a),o&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function z5(e){return e.openStart==0&&e.openEnd==0&&e.content.childCount==1?e.content.firstChild:null}function W5(e,t){if(!e.dom.parentNode)return;let i=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,n=e.dom.parentNode.appendChild(document.createElement(i?"textarea":"div"));i||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus();let o=e.input.shiftKey&&e.input.lastKeyCode!=45;setTimeout(()=>{e.focus(),n.parentNode&&n.parentNode.removeChild(n),i?Dc(e,n.value,null,o,t):Dc(e,n.textContent,n.innerHTML,o,t)},50)}function Dc(e,t,i,n,o){let r=S3(e,t,i,n,e.state.selection.$from);if(e.someProp("handlePaste",l=>l(e,o,r||ae.empty)))return!0;if(!r)return!1;let s=z5(r),a=s?e.state.tr.replaceSelectionWith(s,n):e.state.tr.replaceSelection(r);return e.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function F3(e){let t=e.getData("text/plain")||e.getData("Text");if(t)return t;let i=e.getData("text/uri-list");return i?i.replace(/\r?\n/g," "):""}Ti.paste=(e,t)=>{let i=t;if(e.composing&&!$o)return;let n=Pc?null:i.clipboardData,o=e.input.shiftKey&&e.input.lastKeyCode!=45;n&&Dc(e,F3(n),n.getData("text/html"),o,i)?i.preventDefault():W5(e,i)};var Xu=class{constructor(t,i,n){this.slice=t,this.move=i,this.node=n}},U5=dn?"altKey":"ctrlKey";function I3(e,t){let i=e.someProp("dragCopies",n=>!n(t));return i??!t[U5]}ki.dragstart=(e,t)=>{let i=t,n=e.input.mouseDown;if(n&&n.done(),!i.dataTransfer)return;let o=e.state.selection,r=o.empty?null:e.posAtCoords(th(i)),s;if(!(r&&r.pos>=o.from&&r.pos<=(o instanceof pe?o.to-1:o.to))){if(n&&n.mightDrag)s=pe.create(e.state.doc,n.mightDrag.pos);else if(i.target&&i.target.nodeType==1){let u=e.docView.nearestDesc(i.target,!0);u&&u.node.type.spec.draggable&&u!=e.docView&&(s=pe.create(e.state.doc,u.posBefore))}}let a=(s||e.state.selection).content(),{dom:l,text:c,slice:d}=w0(e,a);(!i.dataTransfer.files.length||!fi||l3>120)&&i.dataTransfer.clearData(),i.dataTransfer.setData(Pc?"Text":"text/html",l.innerHTML),i.dataTransfer.effectAllowed="copyMove",Pc||i.dataTransfer.setData("text/plain",c),e.dragging=new Xu(d,I3(e,i),s)};ki.dragend=e=>{let t=e.dragging;window.setTimeout(()=>{e.dragging==t&&(e.dragging=null)},50)};Ti.dragover=Ti.dragenter=(e,t)=>t.preventDefault();Ti.drop=(e,t)=>{let i=t,n=e.dragging;if(e.dragging=null,!i.dataTransfer)return;let o=e.posAtCoords(th(i));if(!o)return;let r=e.state.doc.resolve(o.pos),s=n&&n.slice;s?e.someProp("transformPasted",g=>{s=g(s,e,!1)}):s=S3(e,F3(i.dataTransfer),Pc?null:i.dataTransfer.getData("text/html"),!1,r);let a=!!(n&&I3(e,i));if(e.someProp("handleDrop",g=>g(e,i,s||ae.empty,a))){i.preventDefault();return}if(!s)return;i.preventDefault();let l=s?Bu(e.state.doc,r.pos,s):r.pos;l==null&&(l=r.pos);let c=e.state.tr;if(a){let{node:g}=n;g?g.replace(c):c.deleteSelection()}let d=c.mapping.map(l),u=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,h=c.doc;if(u?c.replaceRangeWith(d,d,s.content.firstChild):c.replaceRange(d,d,s),c.doc.eq(h))return;let p=c.doc.resolve(d);if(u&&pe.isSelectable(s.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(s.content.firstChild))c.setSelection(new pe(p));else{let g=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((f,m,v,C)=>g=C),c.setSelection(C0(e,p,c.doc.resolve(g)))}e.focus(),e.dispatch(c.setMeta("uiEvent","drop"))};ki.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&jo(e)},20))};ki.blur=(e,t)=>{let i=t;e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),i.relatedTarget&&e.dom.contains(i.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)};ki.beforeinput=(e,t)=>{if(fi&&$o&&t.inputType=="deleteContentBackward"){e.domObserver.flushSoon();let{domChangeCount:n}=e.input;setTimeout(()=>{if(e.input.domChangeCount!=n||(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",r=>r(e,Ns(8,"Backspace")))))return;let{$cursor:o}=e.state.selection;o&&o.pos>0&&e.dispatch(e.state.tr.delete(o.pos-1,o.pos).scrollIntoView())},50)}};for(let e in Ti)ki[e]=Ti[e];function Mc(e,t){if(e==t)return!0;for(let i in e)if(e[i]!==t[i])return!1;for(let i in t)if(!(i in e))return!1;return!0}var Ju=class e{constructor(t,i){this.toDOM=t,this.spec=i||Gs,this.side=this.spec.side||0}map(t,i,n,o){let{pos:r,deleted:s}=t.mapResult(i.from+o,this.side<0?-1:1);return s?null:new mi(r-n,r-n,this)}valid(){return!0}eq(t){return this==t||t instanceof e&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&Mc(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}},Vs=class e{constructor(t,i){this.attrs=t,this.spec=i||Gs}map(t,i,n,o){let r=t.map(i.from+o,this.spec.inclusiveStart?-1:1)-n,s=t.map(i.to+o,this.spec.inclusiveEnd?1:-1)-n;return r>=s?null:new mi(r,s,this)}valid(t,i){return i.from<i.to}eq(t){return this==t||t instanceof e&&Mc(this.attrs,t.attrs)&&Mc(this.spec,t.spec)}static is(t){return t.type instanceof e}destroy(){}},p0=class e{constructor(t,i){this.attrs=t,this.spec=i||Gs}map(t,i,n,o){let r=t.mapResult(i.from+o,1);if(r.deleted)return null;let s=t.mapResult(i.to+o,-1);return s.deleted||s.pos<=r.pos?null:new mi(r.pos-n,s.pos-n,this)}valid(t,i){let{index:n,offset:o}=t.content.findIndex(i.from),r;return o==i.from&&!(r=t.child(n)).isText&&o+r.nodeSize==i.to}eq(t){return this==t||t instanceof e&&Mc(this.attrs,t.attrs)&&Mc(this.spec,t.spec)}destroy(){}},mi=class e{constructor(t,i,n){this.from=t,this.to=i,this.type=n}copy(t,i){return new e(t,i,this.type)}eq(t,i=0){return this.type.eq(t.type)&&this.from+i==t.from&&this.to+i==t.to}map(t,i,n){return this.type.map(t,this,i,n)}static widget(t,i,n){return new e(t,t,new Ju(i,n))}static inline(t,i,n,o){return new e(t,i,new Vs(n,o))}static node(t,i,n,o){return new e(t,i,new p0(n,o))}get spec(){return this.type.spec}get inline(){return this.type instanceof Vs}get widget(){return this.type instanceof Ju}},ja=[],Gs={},Mt=class e{constructor(t,i){this.local=t.length?t:ja,this.children=i.length?i:ja}static create(t,i){return i.length?Zu(i,t,0,Gs):gi}find(t,i,n){let o=[];return this.findInner(t??0,i??1e9,o,0,n),o}findInner(t,i,n,o,r){for(let s=0;s<this.local.length;s++){let a=this.local[s];a.from<=i&&a.to>=t&&(!r||r(a.spec))&&n.push(a.copy(a.from+o,a.to+o))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<i&&this.children[s+1]>t){let a=this.children[s]+1;this.children[s+2].findInner(t-a,i-a,n,o+a,r)}}map(t,i,n){return this==gi||t.maps.length==0?this:this.mapInner(t,i,0,0,n||Gs)}mapInner(t,i,n,o,r){let s;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(t,n,o);l&&l.type.valid(i,l)?(s||(s=[])).push(l):r.onRemove&&r.onRemove(this.local[a].spec)}return this.children.length?q5(this.children,s||[],t,i,n,o,r):s?new e(s.sort(zs),ja):gi}add(t,i){return i.length?this==gi?e.create(t,i):this.addInner(t,i,0):this}addInner(t,i,n){let o,r=0;t.forEach((a,l)=>{let c=l+n,d;if(d=L3(i,a,c)){for(o||(o=this.children.slice());r<o.length&&o[r]<l;)r+=3;o[r]==l?o[r+2]=o[r+2].addInner(a,d,c+1):o.splice(r,0,l,l+a.nodeSize,Zu(d,a,c+1,Gs)),r+=3}});let s=A3(r?O3(i):i,-n);for(let a=0;a<s.length;a++)s[a].type.valid(t,s[a])||s.splice(a--,1);return new e(s.length?this.local.concat(s).sort(zs):this.local,o||this.children)}remove(t){return t.length==0||this==gi?this:this.removeInner(t,0)}removeInner(t,i){let n=this.children,o=this.local;for(let r=0;r<n.length;r+=3){let s,a=n[r]+i,l=n[r+1]+i;for(let d=0,u;d<t.length;d++)(u=t[d])&&u.from>a&&u.to<l&&(t[d]=null,(s||(s=[])).push(u));if(!s)continue;n==this.children&&(n=this.children.slice());let c=n[r+2].removeInner(s,a+1);c!=gi?n[r+2]=c:(n.splice(r,3),r-=3)}if(o.length){for(let r=0,s;r<t.length;r++)if(s=t[r])for(let a=0;a<o.length;a++)o[a].eq(s,i)&&(o==this.local&&(o=this.local.slice()),o.splice(a--,1))}return n==this.children&&o==this.local?this:o.length||n.length?new e(o,n):gi}forChild(t,i){if(this==gi)return this;if(i.isLeaf)return e.empty;let n,o;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=t){this.children[a]==t&&(n=this.children[a+2]);break}let r=t+1,s=r+i.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<s&&l.to>r&&l.type instanceof Vs){let c=Math.max(r,l.from)-r,d=Math.min(s,l.to)-r;c<d&&(o||(o=[])).push(l.copy(c,d))}}if(o){let a=new e(o.sort(zs),ja);return n?new Qu([a,n]):a}return n||gi}eq(t){if(this==t)return!0;if(!(t instanceof e)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let i=0;i<this.local.length;i++)if(!this.local[i].eq(t.local[i]))return!1;for(let i=0;i<this.children.length;i+=3)if(this.children[i]!=t.children[i]||this.children[i+1]!=t.children[i+1]||!this.children[i+2].eq(t.children[i+2]))return!1;return!0}locals(t){return x0(this.localsInner(t))}localsInner(t){if(this==gi)return ja;if(t.inlineContent||!this.local.some(Vs.is))return this.local;let i=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof Vs||i.push(this.local[n]);return i}forEachSet(t){t(this)}};Mt.empty=new Mt([],[]);Mt.removeOverlap=x0;var gi=Mt.empty,Qu=class e{constructor(t){this.members=t}map(t,i){let n=this.members.map(o=>o.map(t,i,Gs));return e.from(n)}forChild(t,i){if(i.isLeaf)return Mt.empty;let n=[];for(let o=0;o<this.members.length;o++){let r=this.members[o].forChild(t,i);r!=gi&&(r instanceof e?n=n.concat(r.members):n.push(r))}return e.from(n)}eq(t){if(!(t instanceof e)||t.members.length!=this.members.length)return!1;for(let i=0;i<this.members.length;i++)if(!this.members[i].eq(t.members[i]))return!1;return!0}locals(t){let i,n=!0;for(let o=0;o<this.members.length;o++){let r=this.members[o].localsInner(t);if(r.length)if(!i)i=r;else{n&&(i=i.slice(),n=!1);for(let s=0;s<r.length;s++)i.push(r[s])}}return i?x0(n?i:i.sort(zs)):ja}static from(t){switch(t.length){case 0:return gi;case 1:return t[0];default:return new e(t.every(i=>i instanceof Mt)?t:t.reduce((i,n)=>i.concat(n instanceof Mt?n:n.members),[]))}}forEachSet(t){for(let i=0;i<this.members.length;i++)this.members[i].forEachSet(t)}};function q5(e,t,i,n,o,r,s){let a=e.slice();for(let c=0,d=r;c<i.maps.length;c++){let u=0;i.maps[c].forEach((h,p,g,f)=>{let m=f-g-(p-h);for(let v=0;v<a.length;v+=3){let C=a[v+1];if(C<0||h>C+d-u)continue;let w=a[v]+d-u;p>=w?a[v+1]=h<=w?-2:-1:h>=d&&m&&(a[v]+=m,a[v+1]+=m)}u+=m}),d=i.maps[c].map(d,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let d=i.map(e[c]+r),u=d-o;if(u<0||u>=n.content.size){l=!0;continue}let h=i.map(e[c+1]+r,-1),p=h-o,{index:g,offset:f}=n.content.findIndex(u),m=n.maybeChild(g);if(m&&f==u&&f+m.nodeSize==p){let v=a[c+2].mapInner(i,m,d+1,e[c]+r+1,s);v!=gi?(a[c]=u,a[c+1]=p,a[c+2]=v):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=$5(a,e,t,i,o,r,s),d=Zu(c,n,0,s);t=d.local;for(let u=0;u<a.length;u+=3)a[u+1]<0&&(a.splice(u,3),u-=3);for(let u=0,h=0;u<d.children.length;u+=3){let p=d.children[u];for(;h<a.length&&a[h]<p;)h+=3;a.splice(h,0,d.children[u],d.children[u+1],d.children[u+2])}}return new Mt(t.sort(zs),a)}function A3(e,t){if(!t||!e.length)return e;let i=[];for(let n=0;n<e.length;n++){let o=e[n];i.push(new mi(o.from+t,o.to+t,o.type))}return i}function $5(e,t,i,n,o,r,s){function a(l,c){for(let d=0;d<l.local.length;d++){let u=l.local[d].map(n,o,c);u?i.push(u):s.onRemove&&s.onRemove(l.local[d].spec)}for(let d=0;d<l.children.length;d+=3)a(l.children[d+2],l.children[d]+c+1)}for(let l=0;l<e.length;l+=3)e[l+1]==-1&&a(e[l+2],t[l]+r+1);return i}function L3(e,t,i){if(t.isLeaf)return null;let n=i+t.nodeSize,o=null;for(let r=0,s;r<e.length;r++)(s=e[r])&&s.from>i&&s.to<n&&((o||(o=[])).push(s),e[r]=null);return o}function O3(e){let t=[];for(let i=0;i<e.length;i++)e[i]!=null&&t.push(e[i]);return t}function Zu(e,t,i,n){let o=[],r=!1;t.forEach((a,l)=>{let c=L3(e,a,l+i);if(c){r=!0;let d=Zu(c,a,i+l+1,n);d!=gi&&o.push(l,l+a.nodeSize,d)}});let s=A3(r?O3(e):e,-i).sort(zs);for(let a=0;a<s.length;a++)s[a].type.valid(t,s[a])||(n.onRemove&&n.onRemove(s[a].spec),s.splice(a--,1));return s.length||o.length?new Mt(s,o):gi}function zs(e,t){return e.from-t.from||e.to-t.to}function x0(e){let t=e;for(let i=0;i<t.length-1;i++){let n=t[i];if(n.from!=n.to)for(let o=i+1;o<t.length;o++){let r=t[o];if(r.from==n.from){r.to!=n.to&&(t==e&&(t=e.slice()),t[o]=r.copy(r.from,n.to),X2(t,o+1,r.copy(n.to,r.to)));continue}else{r.from<n.to&&(t==e&&(t=e.slice()),t[i]=n.copy(n.from,r.from),X2(t,o,n.copy(r.from,n.to)));break}}}return t}function X2(e,t,i){for(;t<e.length&&zs(i,e[t])>0;)t++;e.splice(t,0,i)}function Xm(e){let t=[];return e.someProp("decorations",i=>{let n=i(e.state);n&&n!=gi&&t.push(n)}),e.cursorWrapper&&t.push(Mt.create(e.state.doc,[e.cursorWrapper.deco])),Qu.from(t)}var j5={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},K5=Hi&&Hr<=11,g0=class{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}},f0=class{constructor(t,i){this.view=t,this.handleDOMChange=i,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new g0,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(n=>{for(let o=0;o<n.length;o++)this.queue.push(n[o]);Hi&&Hr<=11&&n.some(o=>o.type=="childList"&&o.removedNodes.length||o.type=="characterData"&&o.oldValue.length>o.target.nodeValue.length)?this.flushSoon():this.flush()}),K5&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,j5)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let i=0;i<t.length;i++)this.queue.push(t[i]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(z2(this.view)){if(this.suppressingSelectionUpdates)return jo(this.view);if(Hi&&Hr<=11&&!this.view.state.selection.empty){let t=this.view.domSelectionRange();if(t.focusNode&&Ws(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(t){if(!t.focusNode)return!0;let i=new Set,n;for(let r=t.focusNode;r;r=Ya(r))i.add(r);for(let r=t.anchorNode;r;r=Ya(r))if(i.has(r)){n=r;break}let o=n&&this.view.docView.nearestDesc(n);if(o&&o.ignoreMutation({type:"selection",target:n.nodeType==3?n.parentNode:n}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}flush(){let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let i=this.pendingRecords();i.length&&(this.queue=[]);let n=t.domSelectionRange(),o=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&z2(t)&&!this.ignoreSelectionChange(n),r=-1,s=-1,a=!1,l=[];if(t.editable)for(let d=0;d<i.length;d++){let u=this.registerMutation(i[d],l);u&&(r=r<0?u.from:Math.min(u.from,r),s=s<0?u.to:Math.max(u.to,s),u.typeOver&&(a=!0))}if(hn&&l.length){let d=l.filter(u=>u.nodeName=="BR");if(d.length==2){let[u,h]=d;u.parentNode&&u.parentNode.parentNode==h.parentNode?h.remove():u.remove()}else{let{focusNode:u}=this.currentSelection;for(let h of d){let p=h.parentNode;p&&p.nodeName=="LI"&&(!u||J5(t,u)!=p)&&h.remove()}}}let c=null;r<0&&o&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&eh(n)&&(c=v0(t))&&c.eq(Re.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,jo(t),this.currentSelection.set(n),t.scrollToSelection()):(r>-1||o)&&(r>-1&&(t.docView.markDirty(r,s),Y5(t)),this.handleDOMChange(r,s,a,l),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(n)||jo(t),this.currentSelection.set(n))}registerMutation(t,i){if(i.indexOf(t.target)>-1)return null;let n=this.view.docView.nearestDesc(t.target);if(t.type=="attributes"&&(n==this.view.docView||t.attributeName=="contenteditable"||t.attributeName=="style"&&!t.oldValue&&!t.target.getAttribute("style"))||!n||n.ignoreMutation(t))return null;if(t.type=="childList"){for(let d=0;d<t.addedNodes.length;d++){let u=t.addedNodes[d];i.push(u),u.nodeType==3&&(this.lastChangedTextNode=u)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(t.target))return{from:n.posBefore,to:n.posAfter};let o=t.previousSibling,r=t.nextSibling;if(Hi&&Hr<=11&&t.addedNodes.length)for(let d=0;d<t.addedNodes.length;d++){let{previousSibling:u,nextSibling:h}=t.addedNodes[d];(!u||Array.prototype.indexOf.call(t.addedNodes,u)<0)&&(o=u),(!h||Array.prototype.indexOf.call(t.addedNodes,h)<0)&&(r=h)}let s=o&&o.parentNode==t.target?oi(o)+1:0,a=n.localPosFromDOM(t.target,s,-1),l=r&&r.parentNode==t.target?oi(r):t.target.childNodes.length,c=n.localPosFromDOM(t.target,l,1);return{from:a,to:c}}else return t.type=="attributes"?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=t.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:t.target.nodeValue==t.oldValue})}},J2=new WeakMap,Q2=!1;function Y5(e){if(!J2.has(e)&&(J2.set(e,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace)!==-1)){if(e.requiresGeckoHackNode=hn,Q2)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Q2=!0}}function Z2(e,t){let i=t.startContainer,n=t.startOffset,o=t.endContainer,r=t.endOffset,s=e.domAtPos(e.state.selection.anchor);return Ws(s.node,s.offset,o,r)&&([i,n,o,r]=[o,r,i,n]),{anchorNode:i,anchorOffset:n,focusNode:o,focusOffset:r}}function X5(e,t){if(t.getComposedRanges){let o=t.getComposedRanges(e.root)[0];if(o)return Z2(e,o)}let i;function n(o){o.preventDefault(),o.stopImmediatePropagation(),i=o.getTargetRanges()[0]}return e.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",n,!0),i?Z2(e,i):null}function J5(e,t){for(let i=t.parentNode;i&&i!=e.dom;i=i.parentNode){let n=e.docView.nearestDesc(i,!0);if(n&&n.node.isBlock)return i}return null}function Q5(e,t,i){let{node:n,fromOffset:o,toOffset:r,from:s,to:a}=e.docView.parseRange(t,i),l=e.domSelectionRange(),c,d=l.anchorNode;if(d&&e.dom.contains(d.nodeType==1?d:d.parentNode)&&(c=[{node:d,offset:l.anchorOffset}],eh(l)||c.push({node:l.focusNode,offset:l.focusOffset})),fi&&e.input.lastKeyCode===8)for(let m=r;m>o;m--){let v=n.childNodes[m-1],C=v.pmViewDesc;if(v.nodeName=="BR"&&!C){r=m;break}if(!C||C.size)break}let u=e.state.doc,h=e.someProp("domParser")||to.fromSchema(e.state.schema),p=u.resolve(s),g=null,f=h.parse(n,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:o,to:r,preserveWhitespace:p.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:Z5,context:p});if(c&&c[0].pos!=null){let m=c[0].pos,v=c[1]&&c[1].pos;v==null&&(v=m),g={anchor:m+s,head:v+s}}return{doc:f,sel:g,from:s,to:a}}function Z5(e){let t=e.pmViewDesc;if(t)return t.parseRule();if(e.nodeName=="BR"&&e.parentNode){if(Mi&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let i=document.createElement("div");return i.appendChild(document.createElement("li")),{skip:i}}else if(e.parentNode.lastChild==e||Mi&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if(e.nodeName=="IMG"&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}var eI=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function tI(e,t,i,n,o){let r=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,t<0){let P=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,B=v0(e,P);if(B&&!e.state.selection.eq(B)){if(fi&&$o&&e.input.lastKeyCode===13&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",$=>$(e,Ns(13,"Enter"))))return;let q=e.state.tr.setSelection(B);P=="pointer"?q.setMeta("pointer",!0):P=="key"&&q.scrollIntoView(),r&&q.setMeta("composition",r),e.dispatch(q)}return}let s=e.state.doc.resolve(t),a=s.sharedDepth(i);t=s.before(a+1),i=e.state.doc.resolve(i).after(a+1);let l=e.state.selection,c=Q5(e,t,i),d=e.state.doc,u=d.slice(c.from,c.to),h,p;e.input.lastKeyCode===8&&Date.now()-100<e.input.lastKeyCodeTime?(h=e.state.selection.to,p="end"):(h=e.state.selection.from,p="start"),e.input.lastKeyCode=null;let g=oI(u.content,c.doc.content,c.from,h,p);if(g&&e.input.domChangeCount++,(Xa&&e.input.lastIOSEnter>Date.now()-225||$o)&&o.some(P=>P.nodeType==1&&!eI.test(P.nodeName))&&(!g||g.endA>=g.endB)&&e.someProp("handleKeyDown",P=>P(e,Ns(13,"Enter")))){e.input.lastIOSEnter=0;return}if(!g)if(n&&l instanceof Se&&!l.empty&&l.$head.sameParent(l.$anchor)&&!e.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))g={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let P=e3(e,e.state.doc,c.sel);if(P&&!P.eq(e.state.selection)){let B=e.state.tr.setSelection(P);r&&B.setMeta("composition",r),e.dispatch(B)}}return}e.state.selection.from<e.state.selection.to&&g.start==g.endB&&e.state.selection instanceof Se&&(g.start>e.state.selection.from&&g.start<=e.state.selection.from+2&&e.state.selection.from>=c.from?g.start=e.state.selection.from:g.endA<e.state.selection.to&&g.endA>=e.state.selection.to-2&&e.state.selection.to<=c.to&&(g.endB+=e.state.selection.to-g.endA,g.endA=e.state.selection.to)),Hi&&Hr<=11&&g.endB==g.start+1&&g.endA==g.start&&g.start>c.from&&c.doc.textBetween(g.start-c.from-1,g.start-c.from+1)==" \xA0"&&(g.start--,g.endA--,g.endB--);let f=c.doc.resolveNoCache(g.start-c.from),m=c.doc.resolveNoCache(g.endB-c.from),v=d.resolve(g.start),C=f.sameParent(m)&&f.parent.inlineContent&&v.end()>=g.endA;if((Xa&&e.input.lastIOSEnter>Date.now()-225&&(!C||o.some(P=>P.nodeName=="DIV"||P.nodeName=="P"))||!C&&f.pos<c.doc.content.size&&(!f.sameParent(m)||!f.parent.inlineContent)&&f.pos<m.pos&&!/\S/.test(c.doc.textBetween(f.pos,m.pos,"","")))&&e.someProp("handleKeyDown",P=>P(e,Ns(13,"Enter")))){e.input.lastIOSEnter=0;return}if(e.state.selection.anchor>g.start&&nI(d,g.start,g.endA,f,m)&&e.someProp("handleKeyDown",P=>P(e,Ns(8,"Backspace")))){$o&&fi&&e.domObserver.suppressSelectionUpdates();return}fi&&g.endB==g.start&&(e.input.lastChromeDelete=Date.now()),$o&&!C&&f.start()!=m.start()&&m.parentOffset==0&&f.depth==m.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==g.endA&&(g.endB-=2,m=c.doc.resolveNoCache(g.endB-c.from),setTimeout(()=>{e.someProp("handleKeyDown",function(P){return P(e,Ns(13,"Enter"))})},20));let w=g.start,y=g.endA,_=P=>{let B=P||e.state.tr.replace(w,y,c.doc.slice(g.start-c.from,g.endB-c.from));if(c.sel){let q=e3(e,B.doc,c.sel);q&&!(fi&&e.composing&&q.empty&&(g.start!=g.endB||e.input.lastChromeDelete<Date.now()-100)&&(q.head==w||q.head==B.mapping.map(y)-1)||Hi&&q.empty&&q.head==w)&&B.setSelection(q)}return r&&B.setMeta("composition",r),B.scrollIntoView()},R;if(C)if(f.pos==m.pos){Hi&&Hr<=11&&f.parentOffset==0&&(e.domObserver.suppressSelectionUpdates(),setTimeout(()=>jo(e),20));let P=_(e.state.tr.delete(w,y)),B=d.resolve(g.start).marksAcross(d.resolve(g.endA));B&&P.ensureMarks(B),e.dispatch(P)}else if(g.endA==g.endB&&(R=iI(f.parent.content.cut(f.parentOffset,m.parentOffset),v.parent.content.cut(v.parentOffset,g.endA-v.start())))){let P=_(e.state.tr);R.type=="add"?P.addMark(w,y,R.mark):P.removeMark(w,y,R.mark),e.dispatch(P)}else if(f.parent.child(f.index()).isText&&f.index()==m.index()-(m.textOffset?0:1)){let P=f.parent.textBetween(f.parentOffset,m.parentOffset),B=()=>_(e.state.tr.insertText(P,w,y));e.someProp("handleTextInput",q=>q(e,w,y,P,B))||e.dispatch(B())}else e.dispatch(_());else e.dispatch(_())}function e3(e,t,i){return Math.max(i.anchor,i.head)>t.content.size?null:C0(e,t.resolve(i.anchor),t.resolve(i.head))}function iI(e,t){let i=e.firstChild.marks,n=t.firstChild.marks,o=i,r=n,s,a,l;for(let d=0;d<n.length;d++)o=n[d].removeFromSet(o);for(let d=0;d<i.length;d++)r=i[d].removeFromSet(r);if(o.length==1&&r.length==0)a=o[0],s="add",l=d=>d.mark(a.addToSet(d.marks));else if(o.length==0&&r.length==1)a=r[0],s="remove",l=d=>d.mark(a.removeFromSet(d.marks));else return null;let c=[];for(let d=0;d<t.childCount;d++)c.push(l(t.child(d)));if(Y.from(c).eq(e))return{mark:a,type:s}}function nI(e,t,i,n,o){if(i-t<=o.pos-n.pos||Jm(n,!0,!1)<o.pos)return!1;let r=e.resolve(t);if(!n.parent.isTextblock){let a=r.nodeAfter;return a!=null&&i==t+a.nodeSize}if(r.parentOffset<r.parent.content.size||!r.parent.isTextblock)return!1;let s=e.resolve(Jm(r,!0,!0));return!s.parent.isTextblock||s.pos>i||Jm(s,!0,!1)<i?!1:n.parent.content.cut(n.parentOffset).eq(s.parent.content)}function Jm(e,t,i){let n=e.depth,o=t?e.end():e.pos;for(;n>0&&(t||e.indexAfter(n)==e.node(n).childCount);)n--,o++,t=!1;if(i){let r=e.node(n).maybeChild(e.indexAfter(n));for(;r&&!r.isLeaf;)r=r.firstChild,o++}return o}function oI(e,t,i,n,o){let r=e.findDiffStart(t,i);if(r==null)return null;let{a:s,b:a}=e.findDiffEnd(t,i+e.size,i+t.size);if(o=="end"){let l=Math.max(0,r-Math.min(s,a));n-=s+l-r}if(s<r&&e.size<t.size){let l=n<=r&&n>=s?r-n:0;r-=l,r&&r<t.size&&t3(t.textBetween(r-1,r+1))&&(r+=l?1:-1),a=r+(a-s),s=r}else if(a<r){let l=n<=r&&n>=a?r-n:0;r-=l,r&&r<e.size&&t3(e.textBetween(r-1,r+1))&&(r+=l?1:-1),s=r+(s-a),a=r}return{start:r,endA:s,endB:a}}function t3(e){if(e.length!=2)return!1;let t=e.charCodeAt(0),i=e.charCodeAt(1);return t>=56320&&t<=57343&&i>=55296&&i<=56319}var kc=class{constructor(t,i){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new d0,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=i,this.state=i.state,this.directPlugins=i.plugins||[],this.directPlugins.forEach(s3),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):typeof t=="function"?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=o3(this),n3(this),this.nodeViews=r3(this),this.docView=O2(this.state.doc,i3(this),Xm(this),this.dom,this),this.domObserver=new f0(this,(n,o,r,s)=>tI(this,n,o,r,s)),this.domObserver.start(),P5(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let i in t)this._props[i]=t[i];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&u0(this);let i=this._props;this._props=t,t.plugins&&(t.plugins.forEach(s3),this.directPlugins=t.plugins),this.updateStateInner(t.state,i)}setProps(t){let i={};for(let n in this._props)i[n]=this._props[n];i.state=this.state;for(let n in t)i[n]=t[n];this.update(i)}updateState(t){this.updateStateInner(t,this._props)}updateStateInner(t,i){var n;let o=this.state,r=!1,s=!1;t.storedMarks&&this.composing&&(T3(this),s=!0),this.state=t;let a=o.plugins!=t.plugins||this._props.plugins!=i.plugins;if(a||this._props.plugins!=i.plugins||this._props.nodeViews!=i.nodeViews){let p=r3(this);sI(p,this.nodeViews)&&(this.nodeViews=p,r=!0)}(a||i.handleDOMEvents!=this._props.handleDOMEvents)&&u0(this),this.editable=o3(this),n3(this);let l=Xm(this),c=i3(this),d=o.plugins!=t.plugins&&!o.doc.eq(t.doc)?"reset":t.scrollToSelection>o.scrollToSelection?"to selection":"preserve",u=r||!this.docView.matchesNode(t.doc,c,l);(u||!t.selection.eq(o.selection))&&(s=!0);let h=d=="preserve"&&s&&this.dom.style.overflowAnchor==null&&qF(this);if(s){this.domObserver.stop();let p=u&&(Hi||fi)&&!this.composing&&!o.selection.empty&&!t.selection.empty&&rI(o.selection,t.selection);if(u){let g=fi?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=H5(this)),(r||!this.docView.update(t.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=O2(t.doc,c,l,this.dom,this)),g&&!this.trackWrites&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&h5(this))?jo(this,p):(w3(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(o),!((n=this.dragging)===null||n===void 0)&&n.node&&!o.doc.eq(t.doc)&&this.updateDraggedNode(this.dragging,o),d=="reset"?this.dom.scrollTop=0:d=="to selection"?this.scrollToSelection():h&&$F(h)}scrollToSelection(){let t=this.domSelectionRange().focusNode;if(!(!t||!this.dom.contains(t.nodeType==1?t:t.parentNode))){if(!this.someProp("handleScrollToSelection",i=>i(this)))if(this.state.selection instanceof pe){let i=this.docView.domAfterPos(this.state.selection.from);i.nodeType==1&&k2(this,i.getBoundingClientRect(),t)}else k2(this,this.coordsAtPos(this.state.selection.head,1),t)}}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(!t||t.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let i=0;i<this.directPlugins.length;i++){let n=this.directPlugins[i];n.spec.view&&this.pluginViews.push(n.spec.view(this))}for(let i=0;i<this.state.plugins.length;i++){let n=this.state.plugins[i];n.spec.view&&this.pluginViews.push(n.spec.view(this))}}else for(let i=0;i<this.pluginViews.length;i++){let n=this.pluginViews[i];n.update&&n.update(this,t)}}updateDraggedNode(t,i){let n=t.node,o=-1;if(this.state.doc.nodeAt(n.from)==n.node)o=n.from;else{let r=n.from+(this.state.doc.content.size-i.doc.content.size);(r>0&&this.state.doc.nodeAt(r))==n.node&&(o=r)}this.dragging=new Xu(t.slice,t.move,o<0?void 0:pe.create(this.state.doc,o))}someProp(t,i){let n=this._props&&this._props[t],o;if(n!=null&&(o=i?i(n):n))return o;for(let s=0;s<this.directPlugins.length;s++){let a=this.directPlugins[s].props[t];if(a!=null&&(o=i?i(a):a))return o}let r=this.state.plugins;if(r)for(let s=0;s<r.length;s++){let a=r[s].props[t];if(a!=null&&(o=i?i(a):a))return o}}hasFocus(){if(Hi){let t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if(t.contentEditable=="false")return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&jF(this.dom),jo(this),this.domObserver.start()}get root(){let t=this._root;if(t==null){for(let i=this.dom.parentNode;i;i=i.parentNode)if(i.nodeType==9||i.nodeType==11&&i.host)return i.getSelection||(Object.getPrototypeOf(i).getSelection=()=>i.ownerDocument.getSelection()),this._root=i}return t||document}updateRoot(){this._root=null}posAtCoords(t){return QF(this,t)}coordsAtPos(t,i=1){return p3(this,t,i)}domAtPos(t,i=0){return this.docView.domFromPos(t,i)}nodeDOM(t){let i=this.docView.descAt(t);return i?i.nodeDOM:null}posAtDOM(t,i,n=-1){let o=this.docView.posFromDOM(t,i,n);if(o==null)throw new RangeError("DOM position not inside the editor");return o}endOfTextblock(t,i){return n5(this,i||this.state,t)}pasteHTML(t,i){return Dc(this,"",t,!1,i||new ClipboardEvent("paste"))}pasteText(t,i){return Dc(this,t,null,!0,i||new ClipboardEvent("paste"))}serializeForClipboard(t){return w0(this,t)}destroy(){this.docView&&(D5(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Xm(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,AF())}get isDestroyed(){return this.docView==null}dispatchEvent(t){return k5(this,t)}domSelectionRange(){let t=this.domSelection();return t?Mi&&this.root.nodeType===11&&HF(this.dom.ownerDocument)==this.dom&&X5(this,t)||t:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}};kc.prototype.dispatch=function(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))};function i3(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",i=>{if(typeof i=="function"&&(i=i(e.state)),i)for(let n in i)n=="class"?t.class+=" "+i[n]:n=="style"?t.style=(t.style?t.style+";":"")+i[n]:!t[n]&&n!="contenteditable"&&n!="nodeName"&&(t[n]=String(i[n]))}),t.translate||(t.translate="no"),[mi.node(0,e.state.doc.content.size,t)]}function n3(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:mi.widget(e.state.selection.from,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function o3(e){return!e.someProp("editable",t=>t(e.state)===!1)}function rI(e,t){let i=Math.min(e.$anchor.sharedDepth(e.head),t.$anchor.sharedDepth(t.head));return e.$anchor.start(i)!=t.$anchor.start(i)}function r3(e){let t=Object.create(null);function i(n){for(let o in n)Object.prototype.hasOwnProperty.call(t,o)||(t[o]=n[o])}return e.someProp("nodeViews",i),e.someProp("markViews",i),t}function sI(e,t){let i=0,n=0;for(let o in e){if(e[o]!=t[o])return!0;i++}for(let o in t)n++;return i!=n}function s3(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Ko={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},nh={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},aI=typeof navigator<"u"&&/Mac/.test(navigator.platform),lI=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(Bt=0;Bt<10;Bt++)Ko[48+Bt]=Ko[96+Bt]=String(Bt);var Bt;for(Bt=1;Bt<=24;Bt++)Ko[Bt+111]="F"+Bt;var Bt;for(Bt=65;Bt<=90;Bt++)Ko[Bt]=String.fromCharCode(Bt+32),nh[Bt]=String.fromCharCode(Bt);var Bt;for(ih in Ko)nh.hasOwnProperty(ih)||(nh[ih]=Ko[ih]);var ih;function N3(e){var t=aI&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||lI&&e.shiftKey&&e.key&&e.key.length==1||e.key=="Unidentified",i=!t&&e.key||(e.shiftKey?nh:Ko)[e.keyCode]||e.key||"Unidentified";return i=="Esc"&&(i="Escape"),i=="Del"&&(i="Delete"),i=="Left"&&(i="ArrowLeft"),i=="Up"&&(i="ArrowUp"),i=="Right"&&(i="ArrowRight"),i=="Down"&&(i="ArrowDown"),i}var cI=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),dI=typeof navigator<"u"&&/Win/.test(navigator.platform);function uI(e){let t=e.split(/-(?!$)/),i=t[t.length-1];i=="Space"&&(i=" ");let n,o,r,s;for(let a=0;a<t.length-1;a++){let l=t[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))o=!0;else if(/^s(hift)?$/i.test(l))r=!0;else if(/^mod$/i.test(l))cI?s=!0:o=!0;else throw new Error("Unrecognized modifier name: "+l)}return n&&(i="Alt-"+i),o&&(i="Ctrl-"+i),s&&(i="Meta-"+i),r&&(i="Shift-"+i),i}function hI(e){let t=Object.create(null);for(let i in e)t[uI(i)]=e[i];return t}function E0(e,t,i=!0){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),i&&t.shiftKey&&(e="Shift-"+e),e}function B3(e){return new Pe({props:{handleKeyDown:_0(e)}})}function _0(e){let t=hI(e);return function(i,n){let o=N3(n),r,s=t[E0(o,n)];if(s&&s(i.state,i.dispatch,i))return!0;if(o.length==1&&o!=" "){if(n.shiftKey){let a=t[E0(o,n,!1)];if(a&&a(i.state,i.dispatch,i))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(dI&&n.ctrlKey&&n.altKey)&&(r=Ko[n.keyCode])&&r!=o){let a=t[E0(r,n)];if(a&&a(i.state,i.dispatch,i))return!0}}return!1}}var pI=Object.defineProperty,F0=(e,t)=>{for(var i in t)pI(e,i,{get:t[i],enumerable:!0})};function uh(e){let{state:t,transaction:i}=e,{selection:n}=i,{doc:o}=i,{storedMarks:r}=i;return z(b({},t),{apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return r},get selection(){return n},get doc(){return o},get tr(){return n=i.selection,o=i.doc,r=i.storedMarks,i}})}var hh=class{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){let{rawCommands:e,editor:t,state:i}=this,{view:n}=t,{tr:o}=i,r=this.buildProps(o);return Object.fromEntries(Object.entries(e).map(([s,a])=>[s,(...c)=>{let d=a(...c)(r);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&n.dispatch(o),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){let{rawCommands:i,editor:n,state:o}=this,{view:r}=n,s=[],a=!!e,l=e||o.tr,c=()=>(!a&&t&&!l.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(l),s.every(u=>u===!0)),d=z(b({},Object.fromEntries(Object.entries(i).map(([u,h])=>[u,(...g)=>{let f=this.buildProps(l,t),m=h(...g)(f);return s.push(m),d}]))),{run:c});return d}createCan(e){let{rawCommands:t,state:i}=this,n=!1,o=e||i.tr,r=this.buildProps(o,n),s=Object.fromEntries(Object.entries(t).map(([a,l])=>[a,(...c)=>l(...c)(z(b({},r),{dispatch:void 0}))]));return z(b({},s),{chain:()=>this.createChain(o,n)})}buildProps(e,t=!0){let{rawCommands:i,editor:n,state:o}=this,{view:r}=n,s={tr:e,editor:n,view:r,state:uh({state:o,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(i).map(([a,l])=>[a,(...c)=>l(...c)(s)]))}};return s}},K3={};F0(K3,{blur:()=>gI,clearContent:()=>fI,clearNodes:()=>mI,command:()=>vI,createParagraphNear:()=>CI,cut:()=>wI,deleteCurrentNode:()=>bI,deleteNode:()=>yI,deleteRange:()=>SI,deleteSelection:()=>xI,enter:()=>EI,exitCode:()=>_I,extendMarkRange:()=>RI,first:()=>PI,focus:()=>MI,forEach:()=>kI,insertContent:()=>TI,insertContentAt:()=>AI,joinBackward:()=>NI,joinDown:()=>OI,joinForward:()=>BI,joinItemBackward:()=>HI,joinItemForward:()=>VI,joinTextblockBackward:()=>GI,joinTextblockForward:()=>zI,joinUp:()=>LI,keyboardShortcut:()=>UI,lift:()=>qI,liftEmptyBlock:()=>$I,liftListItem:()=>jI,newlineInCode:()=>KI,resetAttributes:()=>YI,scrollIntoView:()=>XI,selectAll:()=>JI,selectNodeBackward:()=>QI,selectNodeForward:()=>ZI,selectParentNode:()=>eA,selectTextblockEnd:()=>tA,selectTextblockStart:()=>iA,setContent:()=>nA,setMark:()=>vA,setMeta:()=>CA,setNode:()=>wA,setNodeSelection:()=>bA,setTextDirection:()=>yA,setTextSelection:()=>SA,sinkListItem:()=>xA,splitBlock:()=>EA,splitListItem:()=>_A,toggleList:()=>RA,toggleMark:()=>PA,toggleNode:()=>DA,toggleWrap:()=>MA,undoInputRule:()=>kA,unsetAllMarks:()=>TA,unsetMark:()=>FA,unsetTextDirection:()=>IA,updateAttributes:()=>AA,wrapIn:()=>LA,wrapInList:()=>OA});var gI=()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var i;e.isDestroyed||(t.dom.blur(),(i=window?.getSelection())==null||i.removeAllRanges())}),!0),fI=(e=!0)=>({commands:t})=>t.setContent("",{emitUpdate:e}),mI=()=>({state:e,tr:t,dispatch:i})=>{let{selection:n}=t,{ranges:o}=n;return i&&o.forEach(({$from:r,$to:s})=>{e.doc.nodesBetween(r.pos,s.pos,(a,l)=>{if(a.type.isText)return;let{doc:c,mapping:d}=t,u=c.resolve(d.map(l)),h=c.resolve(d.map(l+a.nodeSize)),p=u.blockRange(h);if(!p)return;let g=Wo(p);if(a.type.isTextblock){let{defaultType:f}=u.parent.contentMatchAt(u.index());t.setNodeMarkup(p.start,f)}(g||g===0)&&t.lift(p,g)})}),!0},vI=e=>t=>e(t),CI=()=>({state:e,dispatch:t})=>Gm(e,t),wI=(e,t)=>({editor:i,tr:n})=>{let{state:o}=i,r=o.doc.slice(e.from,e.to);n.deleteRange(e.from,e.to);let s=n.mapping.map(t);return n.insert(s,r.content),n.setSelection(new Se(n.doc.resolve(Math.max(s-1,0)))),!0},bI=()=>({tr:e,dispatch:t})=>{let{selection:i}=e,n=i.$anchor.node();if(n.content.size>0)return!1;let o=e.selection.$anchor;for(let r=o.depth;r>0;r-=1)if(o.node(r).type===n.type){if(t){let a=o.before(r),l=o.after(r);e.delete(a,l).scrollIntoView()}return!0}return!1};function Et(e,t){if(typeof e=="string"){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}var yI=e=>({tr:t,state:i,dispatch:n})=>{let o=Et(e,i.schema),r=t.selection.$anchor;for(let s=r.depth;s>0;s-=1)if(r.node(s).type===o){if(n){let l=r.before(s),c=r.after(s);t.delete(l,c).scrollIntoView()}return!0}return!1},SI=e=>({tr:t,dispatch:i})=>{let{from:n,to:o}=e;return i&&t.delete(n,o),!0},xI=()=>({state:e,dispatch:t})=>Wu(e,t),EI=()=>({commands:e})=>e.keyboardShortcut("Enter"),_I=()=>({state:e,dispatch:t})=>Vm(e,t);function I0(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function ch(e,t,i={strict:!0}){let n=Object.keys(t);return n.length?n.every(o=>i.strict?t[o]===e[o]:I0(t[o])?t[o].test(e[o]):t[o]===e[o]):!0}function Y3(e,t,i={}){return e.find(n=>n.type===t&&ch(Object.fromEntries(Object.keys(i).map(o=>[o,n.attrs[o]])),i))}function H3(e,t,i={}){return!!Y3(e,t,i)}function A0(e,t,i){var n;if(!e||!t)return;let o=e.parent.childAfter(e.parentOffset);if((!o.node||!o.node.marks.some(d=>d.type===t))&&(o=e.parent.childBefore(e.parentOffset)),!o.node||!o.node.marks.some(d=>d.type===t)||(i=i||((n=o.node.marks[0])==null?void 0:n.attrs),!Y3([...o.node.marks],t,i)))return;let s=o.index,a=e.start()+o.offset,l=s+1,c=a+o.node.nodeSize;for(;s>0&&H3([...e.parent.child(s-1).marks],t,i);)s-=1,a-=e.parent.child(s).nodeSize;for(;l<e.parent.childCount&&H3([...e.parent.child(l).marks],t,i);)c+=e.parent.child(l).nodeSize,l+=1;return{from:a,to:c}}function Yo(e,t){if(typeof e=="string"){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}var RI=(e,t={})=>({tr:i,state:n,dispatch:o})=>{let r=Yo(e,n.schema),{doc:s,selection:a}=i,{$from:l,from:c,to:d}=a;if(o){let u=A0(l,r,t);if(u&&u.from<=c&&u.to>=d){let h=Se.create(s,u.from,u.to);i.setSelection(h)}}return!0},PI=e=>t=>{let i=typeof e=="function"?e(t):e;for(let n=0;n<i.length;n+=1)if(i[n](t))return!0;return!1};function X3(e){return e instanceof Se}function qs(e=0,t=0,i=0){return Math.min(Math.max(e,t),i)}function J3(e,t=null){if(!t)return null;let i=Re.atStart(e),n=Re.atEnd(e);if(t==="start"||t===!0)return i;if(t==="end")return n;let o=i.from,r=n.to;return t==="all"?Se.create(e,qs(0,o,r),qs(e.content.size,o,r)):Se.create(e,qs(t,o,r),qs(t,o,r))}function DI(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function L0(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var MI=(e=null,t={})=>({editor:i,view:n,tr:o,dispatch:r})=>{t=b({scrollIntoView:!0},t);let s=()=>{(L0()||DI())&&n.dom.focus(),requestAnimationFrame(()=>{i.isDestroyed||(n.focus(),t?.scrollIntoView&&i.commands.scrollIntoView())})};if(n.hasFocus()&&e===null||e===!1)return!0;if(r&&e===null&&!X3(i.state.selection))return s(),!0;let a=J3(o.doc,e)||i.state.selection,l=i.state.selection.eq(a);return r&&(l||o.setSelection(a),l&&o.storedMarks&&o.setStoredMarks(o.storedMarks),s()),!0},kI=(e,t)=>i=>e.every((n,o)=>t(n,z(b({},i),{index:o}))),TI=(e,t)=>({tr:i,commands:n})=>n.insertContentAt({from:i.selection.from,to:i.selection.to},e,t),Q3=e=>{let t=e.childNodes;for(let i=t.length-1;i>=0;i-=1){let n=t[i];n.nodeType===3&&n.nodeValue&&/^(\n\s\s|\n)$/.test(n.nodeValue)?e.removeChild(n):n.nodeType===1&&Q3(n)}return e};function oh(e){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");let t=`<body>${e}</body>`,i=new window.DOMParser().parseFromString(t,"text/html").body;return Q3(i)}function Ic(e,t,i){if(e instanceof Bi||e instanceof Y)return e;i=b({slice:!0,parseOptions:{}},i);let n=typeof e=="object"&&e!==null,o=typeof e=="string";if(n)try{if(Array.isArray(e)&&e.length>0)return Y.fromArray(e.map(a=>t.nodeFromJSON(a)));let s=t.nodeFromJSON(e);return i.errorOnInvalidContent&&s.check(),s}catch(r){if(i.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:r});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",r),Ic("",t,i)}if(o){if(i.errorOnInvalidContent){let s=!1,a="",l=new Ba({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(s=!0,a=typeof c=="string"?c:c.outerHTML,null)}]}})});if(i.slice?to.fromSchema(l).parseSlice(oh(e),i.parseOptions):to.fromSchema(l).parse(oh(e),i.parseOptions),i.errorOnInvalidContent&&s)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}let r=to.fromSchema(t);return i.slice?r.parseSlice(oh(e),i.parseOptions).content:r.parse(oh(e),i.parseOptions)}return Ic("",t,i)}function FI(e,t,i){let n=e.steps.length-1;if(n<t)return;let o=e.steps[n];if(!(o instanceof pi||o instanceof Nt))return;let r=e.mapping.maps[n],s=0;r.forEach((a,l,c,d)=>{s===0&&(s=d)}),e.setSelection(Re.near(e.doc.resolve(s),i))}var II=e=>!("type"in e),AI=(e,t,i)=>({tr:n,dispatch:o,editor:r})=>{var s;if(o){i=b({parseOptions:r.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1},i);let a,l=m=>{r.emit("contentError",{editor:r,error:m,disableCollaboration:()=>{"collaboration"in r.storage&&typeof r.storage.collaboration=="object"&&r.storage.collaboration&&(r.storage.collaboration.isDisabled=!0)}})},c=b({preserveWhitespace:"full"},i.parseOptions);if(!i.errorOnInvalidContent&&!r.options.enableContentCheck&&r.options.emitContentError)try{Ic(t,r.schema,{parseOptions:c,errorOnInvalidContent:!0})}catch(m){l(m)}try{a=Ic(t,r.schema,{parseOptions:c,errorOnInvalidContent:(s=i.errorOnInvalidContent)!=null?s:r.options.enableContentCheck})}catch(m){return l(m),!1}let{from:d,to:u}=typeof e=="number"?{from:e,to:e}:{from:e.from,to:e.to},h=!0,p=!0;if((II(a)?a:[a]).forEach(m=>{m.check(),h=h?m.isText&&m.marks.length===0:!1,p=p?m.isBlock:!1}),d===u&&p){let{parent:m}=n.doc.resolve(d);m.isTextblock&&!m.type.spec.code&&!m.childCount&&(d-=1,u+=1)}let f;if(h){if(Array.isArray(t))f=t.map(m=>m.text||"").join("");else if(t instanceof Y){let m="";t.forEach(v=>{v.text&&(m+=v.text)}),f=m}else typeof t=="object"&&t&&t.text?f=t.text:f=t;n.insertText(f,d,u)}else{f=a;let m=n.doc.resolve(d),v=m.node(),C=m.parentOffset===0,w=v.isText||v.isTextblock,y=v.content.size>0;C&&w&&y&&(d=Math.max(0,d-1)),n.replaceWith(d,u,f)}i.updateSelection&&FI(n,n.steps.length-1,-1),i.applyInputRules&&n.setMeta("applyInputRules",{from:d,text:f}),i.applyPasteRules&&n.setMeta("applyPasteRules",{from:d,text:f})}return!0},LI=()=>({state:e,dispatch:t})=>C2(e,t),OI=()=>({state:e,dispatch:t})=>w2(e,t),NI=()=>({state:e,dispatch:t})=>Fm(e,t),BI=()=>({state:e,dispatch:t})=>Lm(e,t),HI=()=>({state:e,dispatch:t,tr:i})=>{try{let n=Ls(e.doc,e.selection.$from.pos,-1);return n==null?!1:(i.join(n,2),t&&t(i),!0)}catch{return!1}},VI=()=>({state:e,dispatch:t,tr:i})=>{try{let n=Ls(e.doc,e.selection.$from.pos,1);return n==null?!1:(i.join(n,2),t&&t(i),!0)}catch{return!1}},GI=()=>({state:e,dispatch:t})=>g2(e,t),zI=()=>({state:e,dispatch:t})=>f2(e,t);function Z3(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function WI(e){let t=e.split(/-(?!$)/),i=t[t.length-1];i==="Space"&&(i=" ");let n,o,r,s;for(let a=0;a<t.length-1;a+=1){let l=t[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))o=!0;else if(/^s(hift)?$/i.test(l))r=!0;else if(/^mod$/i.test(l))L0()||Z3()?s=!0:o=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return n&&(i=`Alt-${i}`),o&&(i=`Ctrl-${i}`),s&&(i=`Meta-${i}`),r&&(i=`Shift-${i}`),i}var UI=e=>({editor:t,view:i,tr:n,dispatch:o})=>{let r=WI(e).split(/-(?!$)/),s=r.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:r.includes("Alt"),ctrlKey:r.includes("Ctrl"),metaKey:r.includes("Meta"),shiftKey:r.includes("Shift"),bubbles:!0,cancelable:!0}),l=t.captureTransaction(()=>{i.someProp("handleKeyDown",c=>c(i,a))});return l?.steps.forEach(c=>{let d=c.map(n.mapping);d&&o&&n.maybeStep(d)}),!0};function oo(e,t,i={}){let{from:n,to:o,empty:r}=e.selection,s=t?Et(t,e.schema):null,a=[];e.doc.nodesBetween(n,o,(u,h)=>{if(u.isText)return;let p=Math.max(n,h),g=Math.min(o,h+u.nodeSize);a.push({node:u,from:p,to:g})});let l=o-n,c=a.filter(u=>s?s.name===u.node.type.name:!0).filter(u=>ch(u.node.attrs,i,{strict:!1}));return r?!!c.length:c.reduce((u,h)=>u+h.to-h.from,0)>=l}var qI=(e,t={})=>({state:i,dispatch:n})=>{let o=Et(e,i.schema);return oo(i,o,t)?b2(i,n):!1},$I=()=>({state:e,dispatch:t})=>zm(e,t),jI=e=>({state:t,dispatch:i})=>{let n=Et(e,t.schema);return R2(n)(t,i)},KI=()=>({state:e,dispatch:t})=>Bm(e,t);function ph(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function V3(e,t){let i=typeof t=="string"?[t]:t;return Object.keys(e).reduce((n,o)=>(i.includes(o)||(n[o]=e[o]),n),{})}var YI=(e,t)=>({tr:i,state:n,dispatch:o})=>{let r=null,s=null,a=ph(typeof e=="string"?e:e.name,n.schema);if(!a)return!1;a==="node"&&(r=Et(e,n.schema)),a==="mark"&&(s=Yo(e,n.schema));let l=!1;return i.selection.ranges.forEach(c=>{n.doc.nodesBetween(c.$from.pos,c.$to.pos,(d,u)=>{r&&r===d.type&&(l=!0,o&&i.setNodeMarkup(u,void 0,V3(d.attrs,t))),s&&d.marks.length&&d.marks.forEach(h=>{s===h.type&&(l=!0,o&&i.addMark(u,u+d.nodeSize,s.create(V3(h.attrs,t))))})})}),l},XI=()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),JI=()=>({tr:e,dispatch:t})=>{if(t){let i=new Di(e.doc);e.setSelection(i)}return!0},QI=()=>({state:e,dispatch:t})=>Im(e,t),ZI=()=>({state:e,dispatch:t})=>Om(e,t),eA=()=>({state:e,dispatch:t})=>y2(e,t),tA=()=>({state:e,dispatch:t})=>Um(e,t),iA=()=>({state:e,dispatch:t})=>Wm(e,t);function M0(e,t,i={},n={}){return Ic(e,t,{slice:!1,parseOptions:i,errorOnInvalidContent:n.errorOnInvalidContent})}var nA=(e,{errorOnInvalidContent:t,emitUpdate:i=!0,parseOptions:n={}}={})=>({editor:o,tr:r,dispatch:s,commands:a})=>{let{doc:l}=r;if(n.preserveWhitespace!=="full"){let c=M0(e,o.schema,n,{errorOnInvalidContent:t??o.options.enableContentCheck});return s&&r.replaceWith(0,l.content.size,c).setMeta("preventUpdate",!i),!0}return s&&r.setMeta("preventUpdate",!i),a.insertContentAt({from:0,to:l.content.size},e,{parseOptions:n,errorOnInvalidContent:t??o.options.enableContentCheck})};function ex(e,t){let i=Yo(t,e.schema),{from:n,to:o,empty:r}=e.selection,s=[];r?(e.storedMarks&&s.push(...e.storedMarks),s.push(...e.selection.$head.marks())):e.doc.nodesBetween(n,o,l=>{s.push(...l.marks)});let a=s.find(l=>l.type.name===i.name);return a?b({},a.attrs):{}}function O0(e,t){let i=new Ga(e);return t.forEach(n=>{n.steps.forEach(o=>{i.step(o)})}),i}function oA(e){for(let t=0;t<e.edgeCount;t+=1){let{type:i}=e.edge(t);if(i.isTextblock&&!i.hasRequiredAttrs())return i}return null}function tx(e,t,i){let n=[];return e.nodesBetween(t.from,t.to,(o,r)=>{i(o)&&n.push({node:o,pos:r})}),n}function rA(e,t){for(let i=e.depth;i>0;i-=1){let n=e.node(i);if(t(n))return{pos:i>0?e.before(i):0,start:e.start(i),depth:i,node:n}}}function gh(e){return t=>rA(t.$from,e)}function be(e,t,i){return e.config[t]===void 0&&e.parent?be(e.parent,t,i):typeof e.config[t]=="function"?e.config[t].bind(z(b({},i),{parent:e.parent?be(e.parent,t,i):null})):e.config[t]}function N0(e){return e.map(t=>{let i={name:t.name,options:t.options,storage:t.storage},n=be(t,"addExtensions",i);return n?[t,...N0(n())]:t}).flat(10)}function B0(e,t){let i=Vo.fromSchema(t).serializeFragment(e),o=document.implementation.createHTMLDocument().createElement("div");return o.appendChild(i),o.innerHTML}function ix(e){return typeof e=="function"}function et(e,t=void 0,...i){return ix(e)?t?e.bind(t)(...i):e(...i):e}function sA(e={}){return Object.keys(e).length===0&&e.constructor===Object}function Za(e){let t=e.filter(o=>o.type==="extension"),i=e.filter(o=>o.type==="node"),n=e.filter(o=>o.type==="mark");return{baseExtensions:t,nodeExtensions:i,markExtensions:n}}function nx(e){let t=[],{nodeExtensions:i,markExtensions:n}=Za(e),o=[...i,...n],r={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(s=>{let a={name:s.name,options:s.options,storage:s.storage,extensions:o},l=be(s,"addGlobalAttributes",a);if(!l)return;l().forEach(d=>{d.types.forEach(u=>{Object.entries(d.attributes).forEach(([h,p])=>{t.push({type:u,name:h,attribute:b(b({},r),p)})})})})}),o.forEach(s=>{let a={name:s.name,options:s.options,storage:s.storage},l=be(s,"addAttributes",a);if(!l)return;let c=l();Object.entries(c).forEach(([d,u])=>{let h=b(b({},r),u);typeof h?.default=="function"&&(h.default=h.default()),h?.isRequired&&h?.default===void 0&&delete h.default,t.push({type:s.name,name:d,attribute:h})})}),t}function Le(...e){return e.filter(t=>!!t).reduce((t,i)=>{let n=b({},t);return Object.entries(i).forEach(([o,r])=>{if(!n[o]){n[o]=r;return}if(o==="class"){let a=r?String(r).split(" "):[],l=n[o]?n[o].split(" "):[],c=a.filter(d=>!l.includes(d));n[o]=[...l,...c].join(" ")}else if(o==="style"){let a=r?r.split(";").map(d=>d.trim()).filter(Boolean):[],l=n[o]?n[o].split(";").map(d=>d.trim()).filter(Boolean):[],c=new Map;l.forEach(d=>{let[u,h]=d.split(":").map(p=>p.trim());c.set(u,h)}),a.forEach(d=>{let[u,h]=d.split(":").map(p=>p.trim());c.set(u,h)}),n[o]=Array.from(c.entries()).map(([d,u])=>`${d}: ${u}`).join("; ")}else n[o]=r}),n},{})}function dh(e,t){return t.filter(i=>i.type===e.type.name).filter(i=>i.attribute.rendered).map(i=>i.attribute.renderHTML?i.attribute.renderHTML(e.attrs)||{}:{[i.name]:e.attrs[i.name]}).reduce((i,n)=>Le(i,n),{})}function aA(e){return typeof e!="string"?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):e==="true"?!0:e==="false"?!1:e}function G3(e,t){return"style"in e?e:z(b({},e),{getAttrs:i=>{let n=e.getAttrs?e.getAttrs(i):e.attrs;if(n===!1)return!1;let o=t.reduce((r,s)=>{let a=s.attribute.parseHTML?s.attribute.parseHTML(i):aA(i.getAttribute(s.name));return a==null?r:z(b({},r),{[s.name]:a})},{});return b(b({},n),o)}})}function z3(e){return Object.fromEntries(Object.entries(e).filter(([t,i])=>t==="attrs"&&sA(i)?!1:i!=null))}function W3(e){var t,i;let n={};return!((t=e?.attribute)!=null&&t.isRequired)&&"default"in(e?.attribute||{})&&(n.default=e.attribute.default),((i=e?.attribute)==null?void 0:i.validate)!==void 0&&(n.validate=e.attribute.validate),[e.name,n]}function lA(e,t){var i;let n=nx(e),{nodeExtensions:o,markExtensions:r}=Za(e),s=(i=o.find(c=>be(c,"topNode")))==null?void 0:i.name,a=Object.fromEntries(o.map(c=>{let d=n.filter(v=>v.type===c.name),u={name:c.name,options:c.options,storage:c.storage,editor:t},h=e.reduce((v,C)=>{let w=be(C,"extendNodeSchema",u);return b(b({},v),w?w(c):{})},{}),p=z3(z(b({},h),{content:et(be(c,"content",u)),marks:et(be(c,"marks",u)),group:et(be(c,"group",u)),inline:et(be(c,"inline",u)),atom:et(be(c,"atom",u)),selectable:et(be(c,"selectable",u)),draggable:et(be(c,"draggable",u)),code:et(be(c,"code",u)),whitespace:et(be(c,"whitespace",u)),linebreakReplacement:et(be(c,"linebreakReplacement",u)),defining:et(be(c,"defining",u)),isolating:et(be(c,"isolating",u)),attrs:Object.fromEntries(d.map(W3))})),g=et(be(c,"parseHTML",u));g&&(p.parseDOM=g.map(v=>G3(v,d)));let f=be(c,"renderHTML",u);f&&(p.toDOM=v=>f({node:v,HTMLAttributes:dh(v,d)}));let m=be(c,"renderText",u);return m&&(p.toText=m),[c.name,p]})),l=Object.fromEntries(r.map(c=>{let d=n.filter(m=>m.type===c.name),u={name:c.name,options:c.options,storage:c.storage,editor:t},h=e.reduce((m,v)=>{let C=be(v,"extendMarkSchema",u);return b(b({},m),C?C(c):{})},{}),p=z3(z(b({},h),{inclusive:et(be(c,"inclusive",u)),excludes:et(be(c,"excludes",u)),group:et(be(c,"group",u)),spanning:et(be(c,"spanning",u)),code:et(be(c,"code",u)),attrs:Object.fromEntries(d.map(W3))})),g=et(be(c,"parseHTML",u));g&&(p.parseDOM=g.map(m=>G3(m,d)));let f=be(c,"renderHTML",u);return f&&(p.toDOM=m=>f({mark:m,HTMLAttributes:dh(m,d)})),[c.name,p]}));return new Ba({topNode:s,nodes:a,marks:l})}function cA(e){let t=e.filter((i,n)=>e.indexOf(i)!==n);return Array.from(new Set(t))}function k0(e){return e.sort((i,n)=>{let o=be(i,"priority")||100,r=be(n,"priority")||100;return o>r?-1:o<r?1:0})}function U3(e){let t=k0(N0(e)),i=cA(t.map(n=>n.name));return i.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${i.map(n=>`'${n}'`).join(", ")}]. This can lead to issues.`),t}function ox(e,t,i){let{from:n,to:o}=t,{blockSeparator:r=`

`,textSerializers:s={}}=i||{},a="";return e.nodesBetween(n,o,(l,c,d,u)=>{var h;l.isBlock&&c>n&&(a+=r);let p=s?.[l.type.name];if(p)return d&&(a+=p({node:l,pos:c,parent:d,index:u,range:t})),!1;l.isText&&(a+=(h=l?.text)==null?void 0:h.slice(Math.max(n,c)-c,o-c))}),a}function dA(e,t){let i={from:0,to:e.content.size};return ox(e,i,t)}function rx(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,t])=>t.spec.toText).map(([t,i])=>[t,i.spec.toText]))}function uA(e,t){let i=Et(t,e.schema),{from:n,to:o}=e.selection,r=[];e.doc.nodesBetween(n,o,a=>{r.push(a)});let s=r.reverse().find(a=>a.type.name===i.name);return s?b({},s.attrs):{}}function H0(e,t){let i=ph(typeof t=="string"?t:t.name,e.schema);return i==="node"?uA(e,t):i==="mark"?ex(e,t):{}}function hA(e,t=JSON.stringify){let i={};return e.filter(n=>{let o=t(n);return Object.prototype.hasOwnProperty.call(i,o)?!1:i[o]=!0})}function pA(e){let t=hA(e);return t.length===1?t:t.filter((i,n)=>!t.filter((r,s)=>s!==n).some(r=>i.oldRange.from>=r.oldRange.from&&i.oldRange.to<=r.oldRange.to&&i.newRange.from>=r.newRange.from&&i.newRange.to<=r.newRange.to))}function V0(e){let{mapping:t,steps:i}=e,n=[];return t.maps.forEach((o,r)=>{let s=[];if(o.ranges.length)o.forEach((a,l)=>{s.push({from:a,to:l})});else{let{from:a,to:l}=i[r];if(a===void 0||l===void 0)return;s.push({from:a,to:l})}s.forEach(({from:a,to:l})=>{let c=t.slice(r).map(a,-1),d=t.slice(r).map(l),u=t.invert().map(c,-1),h=t.invert().map(d);n.push({oldRange:{from:u,to:h},newRange:{from:c,to:d}})})}),pA(n)}function fh(e,t,i){let n=[];return e===t?i.resolve(e).marks().forEach(o=>{let r=i.resolve(e),s=A0(r,o.type);s&&n.push(b({mark:o},s))}):i.nodesBetween(e,t,(o,r)=>{!o||o?.nodeSize===void 0||n.push(...o.marks.map(s=>({from:r,to:r+o.nodeSize,mark:s})))}),n}var sx=(e,t,i,n=20)=>{let o=e.doc.resolve(i),r=n,s=null;for(;r>0&&s===null;){let a=o.node(r);a?.type.name===t?s=a:r-=1}return[s,r]};function R0(e,t){return t.nodes[e]||t.marks[e]||null}function lh(e,t,i){return Object.fromEntries(Object.entries(i).filter(([n])=>{let o=e.find(r=>r.type===t&&r.name===n);return o?o.attribute.keepOnSplit:!1}))}var gA=(e,t=500)=>{let i="",n=e.parentOffset;return e.parent.nodesBetween(Math.max(0,n-t),n,(o,r,s,a)=>{var l,c;let d=((c=(l=o.type.spec).toText)==null?void 0:c.call(l,{node:o,pos:r,parent:s,index:a}))||o.textContent||"%leaf%";i+=o.isAtom&&!o.isText?d:d.slice(0,Math.max(0,n-r))}),i};function T0(e,t,i={}){let{empty:n,ranges:o}=e.selection,r=t?Yo(t,e.schema):null;if(n)return!!(e.storedMarks||e.selection.$from.marks()).filter(u=>r?r.name===u.type.name:!0).find(u=>ch(u.attrs,i,{strict:!1}));let s=0,a=[];if(o.forEach(({$from:u,$to:h})=>{let p=u.pos,g=h.pos;e.doc.nodesBetween(p,g,(f,m)=>{if(!f.isText&&!f.marks.length)return;let v=Math.max(p,m),C=Math.min(g,m+f.nodeSize),w=C-v;s+=w,a.push(...f.marks.map(y=>({mark:y,from:v,to:C})))})}),s===0)return!1;let l=a.filter(u=>r?r.name===u.mark.type.name:!0).filter(u=>ch(u.mark.attrs,i,{strict:!1})).reduce((u,h)=>u+h.to-h.from,0),c=a.filter(u=>r?u.mark.type!==r&&u.mark.type.excludes(r):!0).reduce((u,h)=>u+h.to-h.from,0);return(l>0?l+c:l)>=s}function fA(e,t,i={}){if(!t)return oo(e,null,i)||T0(e,null,i);let n=ph(t,e.schema);return n==="node"?oo(e,t,i):n==="mark"?T0(e,t,i):!1}var ax=(e,t)=>{let{$from:i,$to:n,$anchor:o}=e.selection;if(t){let r=gh(a=>a.type.name===t)(e.selection);if(!r)return!1;let s=e.doc.resolve(r.pos+1);return o.pos+1===s.end()}return!(n.parentOffset<n.parent.nodeSize-2||i.pos!==n.pos)},lx=e=>{let{$from:t,$to:i}=e.selection;return!(t.parentOffset>0||t.pos!==i.pos)};function q3(e,t){return Array.isArray(t)?t.some(i=>(typeof i=="string"?i:i.name)===e.name):t}function $3(e,t){let{nodeExtensions:i}=Za(t),n=i.find(s=>s.name===e);if(!n)return!1;let o={name:n.name,options:n.options,storage:n.storage},r=et(be(n,"group",o));return typeof r!="string"?!1:r.split(" ").includes("list")}function Ac(e,{checkChildren:t=!0,ignoreWhitespace:i=!1}={}){var n;if(i){if(e.type.name==="hardBreak")return!0;if(e.isText)return/^\s*$/m.test((n=e.text)!=null?n:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(e.content.childCount===0)return!0;if(t){let o=!0;return e.content.forEach(r=>{o!==!1&&(Ac(r,{ignoreWhitespace:i,checkChildren:t})||(o=!1))}),o}return!1}function mh(e){return e instanceof pe}function mA(e,t,i){var n;let{selection:o}=t,r=null;if(X3(o)&&(r=o.$cursor),r){let a=(n=e.storedMarks)!=null?n:r.marks();return r.parent.type.allowsMarkType(i)&&(!!i.isInSet(a)||!a.some(c=>c.type.excludes(i)))}let{ranges:s}=o;return s.some(({$from:a,$to:l})=>{let c=a.depth===0?e.doc.inlineContent&&e.doc.type.allowsMarkType(i):!1;return e.doc.nodesBetween(a.pos,l.pos,(d,u,h)=>{if(c)return!1;if(d.isInline){let p=!h||h.type.allowsMarkType(i),g=!!i.isInSet(d.marks)||!d.marks.some(f=>f.type.excludes(i));c=p&&g}return!c}),c})}var vA=(e,t={})=>({tr:i,state:n,dispatch:o})=>{let{selection:r}=i,{empty:s,ranges:a}=r,l=Yo(e,n.schema);if(o)if(s){let c=ex(n,l);i.addStoredMark(l.create(b(b({},c),t)))}else a.forEach(c=>{let d=c.$from.pos,u=c.$to.pos;n.doc.nodesBetween(d,u,(h,p)=>{let g=Math.max(p,d),f=Math.min(p+h.nodeSize,u);h.marks.find(v=>v.type===l)?h.marks.forEach(v=>{l===v.type&&i.addMark(g,f,l.create(b(b({},v.attrs),t)))}):i.addMark(g,f,l.create(t))})});return mA(n,i,l)},CA=(e,t)=>({tr:i})=>(i.setMeta(e,t),!0),wA=(e,t={})=>({state:i,dispatch:n,chain:o})=>{let r=Et(e,i.schema),s;return i.selection.$anchor.sameParent(i.selection.$head)&&(s=i.selection.$anchor.parent.attrs),r.isTextblock?o().command(({commands:a})=>qm(r,b(b({},s),t))(i)?!0:a.clearNodes()).command(({state:a})=>qm(r,b(b({},s),t))(a,n)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},bA=e=>({tr:t,dispatch:i})=>{if(i){let{doc:n}=t,o=qs(e,0,n.content.size),r=pe.create(n,o);t.setSelection(r)}return!0},yA=(e,t)=>({tr:i,state:n,dispatch:o})=>{let{selection:r}=n,s,a;return typeof t=="number"?(s=t,a=t):t&&"from"in t&&"to"in t?(s=t.from,a=t.to):(s=r.from,a=r.to),o&&i.doc.nodesBetween(s,a,(l,c)=>{l.isText||i.setNodeMarkup(c,void 0,z(b({},l.attrs),{dir:e}))}),!0},SA=e=>({tr:t,dispatch:i})=>{if(i){let{doc:n}=t,{from:o,to:r}=typeof e=="number"?{from:e,to:e}:e,s=Se.atStart(n).from,a=Se.atEnd(n).to,l=qs(o,s,a),c=qs(r,s,a),d=Se.create(n,l,c);t.setSelection(d)}return!0},xA=e=>({state:t,dispatch:i})=>{let n=Et(e,t.schema);return P2(n)(t,i)};function j3(e,t){let i=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(i){let n=i.filter(o=>t?.includes(o.type.name));e.tr.ensureMarks(n)}}var EA=({keepMarks:e=!0}={})=>({tr:t,state:i,dispatch:n,editor:o})=>{let{selection:r,doc:s}=t,{$from:a,$to:l}=r,c=o.extensionManager.attributes,d=lh(c,a.node().type.name,a.node().attrs);if(r instanceof pe&&r.node.isBlock)return!a.parentOffset||!Ji(s,a.pos)?!1:(n&&(e&&j3(i,o.extensionManager.splittableMarks),t.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;let u=l.parentOffset===l.parent.content.size,h=a.depth===0?void 0:oA(a.node(-1).contentMatchAt(a.indexAfter(-1))),p=u&&h?[{type:h,attrs:d}]:void 0,g=Ji(t.doc,t.mapping.map(a.pos),1,p);if(!p&&!g&&Ji(t.doc,t.mapping.map(a.pos),1,h?[{type:h}]:void 0)&&(g=!0,p=h?[{type:h,attrs:d}]:void 0),n){if(g&&(r instanceof Se&&t.deleteSelection(),t.split(t.mapping.map(a.pos),1,p),h&&!u&&!a.parentOffset&&a.parent.type!==h)){let f=t.mapping.map(a.before()),m=t.doc.resolve(f);a.node(-1).canReplaceWith(m.index(),m.index()+1,h)&&t.setNodeMarkup(t.mapping.map(a.before()),h)}e&&j3(i,o.extensionManager.splittableMarks),t.scrollIntoView()}return g},_A=(e,t={})=>({tr:i,state:n,dispatch:o,editor:r})=>{var s;let a=Et(e,n.schema),{$from:l,$to:c}=n.selection,d=n.selection.node;if(d&&d.isBlock||l.depth<2||!l.sameParent(c))return!1;let u=l.node(-1);if(u.type!==a)return!1;let h=r.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(o){let v=Y.empty,C=l.index(-1)?1:l.index(-2)?2:3;for(let B=l.depth-C;B>=l.depth-3;B-=1)v=Y.from(l.node(B).copy(v));let w=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,y=b(b({},lh(h,l.node().type.name,l.node().attrs)),t),_=((s=a.contentMatch.defaultType)==null?void 0:s.createAndFill(y))||void 0;v=v.append(Y.from(a.createAndFill(null,_)||void 0));let R=l.before(l.depth-(C-1));i.replace(R,l.after(-w),new ae(v,4-C,0));let P=-1;i.doc.nodesBetween(R,i.doc.content.size,(B,q)=>{if(P>-1)return!1;B.isTextblock&&B.content.size===0&&(P=q+1)}),P>-1&&i.setSelection(Se.near(i.doc.resolve(P))),i.scrollIntoView()}return!0}let p=c.pos===l.end()?u.contentMatchAt(0).defaultType:null,g=b(b({},lh(h,u.type.name,u.attrs)),t),f=b(b({},lh(h,l.node().type.name,l.node().attrs)),t);i.delete(l.pos,c.pos);let m=p?[{type:a,attrs:g},{type:p,attrs:f}]:[{type:a,attrs:g}];if(!Ji(i.doc,l.pos,2))return!1;if(o){let{selection:v,storedMarks:C}=n,{splittableMarks:w}=r.extensionManager,y=C||v.$to.parentOffset&&v.$from.marks();if(i.split(l.pos,2,m).scrollIntoView(),!y||!o)return!0;let _=y.filter(R=>w.includes(R.type.name));i.ensureMarks(_)}return!0},P0=(e,t)=>{let i=gh(s=>s.type===t)(e.selection);if(!i)return!0;let n=e.doc.resolve(Math.max(0,i.pos-1)).before(i.depth);if(n===void 0)return!0;let o=e.doc.nodeAt(n);return i.node.type===o?.type&&cn(e.doc,i.pos)&&e.join(i.pos),!0},D0=(e,t)=>{let i=gh(s=>s.type===t)(e.selection);if(!i)return!0;let n=e.doc.resolve(i.start).after(i.depth);if(n===void 0)return!0;let o=e.doc.nodeAt(n);return i.node.type===o?.type&&cn(e.doc,n)&&e.join(n),!0},RA=(e,t,i,n={})=>({editor:o,tr:r,state:s,dispatch:a,chain:l,commands:c,can:d})=>{let{extensions:u,splittableMarks:h}=o.extensionManager,p=Et(e,s.schema),g=Et(t,s.schema),{selection:f,storedMarks:m}=s,{$from:v,$to:C}=f,w=v.blockRange(C),y=m||f.$to.parentOffset&&f.$from.marks();if(!w)return!1;let _=gh(R=>$3(R.type.name,u))(f);if(w.depth>=1&&_&&w.depth-_.depth<=1){if(_.node.type===p)return c.liftListItem(g);if($3(_.node.type.name,u)&&p.validContent(_.node.content)&&a)return l().command(()=>(r.setNodeMarkup(_.pos,p),!0)).command(()=>P0(r,p)).command(()=>D0(r,p)).run()}return!i||!y||!a?l().command(()=>d().wrapInList(p,n)?!0:c.clearNodes()).wrapInList(p,n).command(()=>P0(r,p)).command(()=>D0(r,p)).run():l().command(()=>{let R=d().wrapInList(p,n),P=y.filter(B=>h.includes(B.type.name));return r.ensureMarks(P),R?!0:c.clearNodes()}).wrapInList(p,n).command(()=>P0(r,p)).command(()=>D0(r,p)).run()},PA=(e,t={},i={})=>({state:n,commands:o})=>{let{extendEmptyMarkRange:r=!1}=i,s=Yo(e,n.schema);return T0(n,s,t)?o.unsetMark(s,{extendEmptyMarkRange:r}):o.setMark(s,t)},DA=(e,t,i={})=>({state:n,commands:o})=>{let r=Et(e,n.schema),s=Et(t,n.schema),a=oo(n,r,i),l;return n.selection.$anchor.sameParent(n.selection.$head)&&(l=n.selection.$anchor.parent.attrs),a?o.setNode(s,l):o.setNode(r,b(b({},l),i))},MA=(e,t={})=>({state:i,commands:n})=>{let o=Et(e,i.schema);return oo(i,o,t)?n.lift(o):n.wrapIn(o,t)},kA=()=>({state:e,dispatch:t})=>{let i=e.plugins;for(let n=0;n<i.length;n+=1){let o=i[n],r;if(o.spec.isInputRules&&(r=o.getState(e))){if(t){let s=e.tr,a=r.transform;for(let l=a.steps.length-1;l>=0;l-=1)s.step(a.steps[l].invert(a.docs[l]));if(r.text){let l=s.doc.resolve(r.from).marks();s.replaceWith(r.from,r.to,e.schema.text(r.text,l))}else s.delete(r.from,r.to)}return!0}}return!1},TA=()=>({tr:e,dispatch:t})=>{let{selection:i}=e,{empty:n,ranges:o}=i;return n||t&&o.forEach(r=>{e.removeMark(r.$from.pos,r.$to.pos)}),!0},FA=(e,t={})=>({tr:i,state:n,dispatch:o})=>{var r;let{extendEmptyMarkRange:s=!1}=t,{selection:a}=i,l=Yo(e,n.schema),{$from:c,empty:d,ranges:u}=a;if(!o)return!0;if(d&&s){let{from:h,to:p}=a,g=(r=c.marks().find(m=>m.type===l))==null?void 0:r.attrs,f=A0(c,l,g);f&&(h=f.from,p=f.to),i.removeMark(h,p,l)}else u.forEach(h=>{i.removeMark(h.$from.pos,h.$to.pos,l)});return i.removeStoredMark(l),!0},IA=e=>({tr:t,state:i,dispatch:n})=>{let{selection:o}=i,r,s;return typeof e=="number"?(r=e,s=e):e&&"from"in e&&"to"in e?(r=e.from,s=e.to):(r=o.from,s=o.to),n&&t.doc.nodesBetween(r,s,(a,l)=>{if(a.isText)return;let c=b({},a.attrs);delete c.dir,t.setNodeMarkup(l,void 0,c)}),!0},AA=(e,t={})=>({tr:i,state:n,dispatch:o})=>{let r=null,s=null,a=ph(typeof e=="string"?e:e.name,n.schema);if(!a)return!1;a==="node"&&(r=Et(e,n.schema)),a==="mark"&&(s=Yo(e,n.schema));let l=!1;return i.selection.ranges.forEach(c=>{let d=c.$from.pos,u=c.$to.pos,h,p,g,f;i.selection.empty?n.doc.nodesBetween(d,u,(m,v)=>{r&&r===m.type&&(l=!0,g=Math.max(v,d),f=Math.min(v+m.nodeSize,u),h=v,p=m)}):n.doc.nodesBetween(d,u,(m,v)=>{v<d&&r&&r===m.type&&(l=!0,g=Math.max(v,d),f=Math.min(v+m.nodeSize,u),h=v,p=m),v>=d&&v<=u&&(r&&r===m.type&&(l=!0,o&&i.setNodeMarkup(v,void 0,b(b({},m.attrs),t))),s&&m.marks.length&&m.marks.forEach(C=>{if(s===C.type&&(l=!0,o)){let w=Math.max(v,d),y=Math.min(v+m.nodeSize,u);i.addMark(w,y,s.create(b(b({},C.attrs),t)))}}))}),p&&(h!==void 0&&o&&i.setNodeMarkup(h,void 0,b(b({},p.attrs),t)),s&&p.marks.length&&p.marks.forEach(m=>{s===m.type&&o&&i.addMark(g,f,s.create(b(b({},m.attrs),t)))}))}),l},LA=(e,t={})=>({state:i,dispatch:n})=>{let o=Et(e,i.schema);return E2(o,t)(i,n)},OA=(e,t={})=>({state:i,dispatch:n})=>{let o=Et(e,i.schema);return _2(o,t)(i,n)},NA=class{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){let i=this.callbacks[e];return i&&i.forEach(n=>n.apply(this,t)),this}off(e,t){let i=this.callbacks[e];return i&&(t?this.callbacks[e]=i.filter(n=>n!==t):delete this.callbacks[e]),this}once(e,t){let i=(...n)=>{this.off(e,i),t.apply(this,n)};return this.on(e,i)}removeAllListeners(){this.callbacks={}}},vh=class{constructor(e){var t;this.find=e.find,this.handler=e.handler,this.undoable=(t=e.undoable)!=null?t:!0}},BA=(e,t)=>{if(I0(t))return t.exec(e);let i=t(e);if(!i)return null;let n=[i.text];return n.index=i.index,n.input=e,n.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),n.push(i.replaceWith)),n};function rh(e){var t;let{editor:i,from:n,to:o,text:r,rules:s,plugin:a}=e,{view:l}=i;if(l.composing)return!1;let c=l.state.doc.resolve(n);if(c.parent.type.spec.code||(t=c.nodeBefore||c.nodeAfter)!=null&&t.marks.find(h=>h.type.spec.code))return!1;let d=!1,u=gA(c)+r;return s.forEach(h=>{if(d)return;let p=BA(u,h.find);if(!p)return;let g=l.state.tr,f=uh({state:l.state,transaction:g}),m={from:n-(p[0].length-r.length),to:o},{commands:v,chain:C,can:w}=new hh({editor:i,state:f});h.handler({state:f,range:m,match:p,commands:v,chain:C,can:w})===null||!g.steps.length||(h.undoable&&g.setMeta(a,{transform:g,from:n,to:o,text:r}),l.dispatch(g),d=!0)}),d}function HA(e){let{editor:t,rules:i}=e,n=new Pe({state:{init(){return null},apply(o,r,s){let a=o.getMeta(n);if(a)return a;let l=o.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:d}=l;typeof d=="string"?d=d:d=B0(Y.from(d),s.schema);let{from:u}=l,h=u+d.length;rh({editor:t,from:u,to:h,text:d,rules:i,plugin:n})}),o.selectionSet||o.docChanged?null:r}},props:{handleTextInput(o,r,s,a){return rh({editor:t,from:r,to:s,text:a,rules:i,plugin:n})},handleDOMEvents:{compositionend:o=>(setTimeout(()=>{let{$cursor:r}=o.state.selection;r&&rh({editor:t,from:r.pos,to:r.pos,text:"",rules:i,plugin:n})}),!1)},handleKeyDown(o,r){if(r.key!=="Enter")return!1;let{$cursor:s}=o.state.selection;return s?rh({editor:t,from:s.pos,to:s.pos,text:`
`,rules:i,plugin:n}):!1}},isInputRules:!0});return n}function VA(e){return Object.prototype.toString.call(e).slice(8,-1)}function sh(e){return VA(e)!=="Object"?!1:e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function cx(e,t){let i=b({},e);return sh(e)&&sh(t)&&Object.keys(t).forEach(n=>{sh(t[n])&&sh(e[n])?i[n]=cx(e[n],t[n]):i[n]=t[n]}),i}var G0=class{constructor(e={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config=b(b({},this.config),e),this.name=this.config.name}get options(){return b({},et(be(this,"addOptions",{name:this.name}))||{})}get storage(){return b({},et(be(this,"addStorage",{name:this.name,options:this.options}))||{})}configure(e={}){let t=this.extend(z(b({},this.config),{addOptions:()=>cx(this.options,e)}));return t.name=this.name,t.parent=this.parent,t}extend(e={}){let t=new this.constructor(b(b({},this.config),e));return t.parent=this,this.child=t,t.name="name"in e?e.name:t.parent.name,t}},Qi=class dx extends G0{constructor(){super(...arguments),this.type="mark"}static create(t={}){let i=typeof t=="function"?t():t;return new dx(i)}static handleExit({editor:t,mark:i}){let{tr:n}=t.state,o=t.state.selection.$from;if(o.pos===o.end()){let s=o.marks();if(!!!s.find(c=>c?.type.name===i.name))return!1;let l=s.find(c=>c?.type.name===i.name);return l&&n.removeStoredMark(l),n.insertText(" ",o.pos),t.view.dispatch(n),!0}return!1}configure(t){return super.configure(t)}extend(t){let i=typeof t=="function"?t():t;return super.extend(i)}};function GA(e){return typeof e=="number"}var zA=class{constructor(e){this.find=e.find,this.handler=e.handler}},WA=(e,t,i)=>{if(I0(t))return[...e.matchAll(t)];let n=t(e,i);return n?n.map(o=>{let r=[o.text];return r.index=o.index,r.input=e,r.data=o.data,o.replaceWith&&(o.text.includes(o.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),r.push(o.replaceWith)),r}):[]};function UA(e){let{editor:t,state:i,from:n,to:o,rule:r,pasteEvent:s,dropEvent:a}=e,{commands:l,chain:c,can:d}=new hh({editor:t,state:i}),u=[];return i.doc.nodesBetween(n,o,(p,g)=>{var f,m,v,C,w;if((m=(f=p.type)==null?void 0:f.spec)!=null&&m.code||!(p.isText||p.isTextblock||p.isInline))return;let y=(w=(C=(v=p.content)==null?void 0:v.size)!=null?C:p.nodeSize)!=null?w:0,_=Math.max(n,g),R=Math.min(o,g+y);if(_>=R)return;let P=p.isText?p.text||"":p.textBetween(_-g,R-g,void 0,"\uFFFC");WA(P,r.find,s).forEach(q=>{if(q.index===void 0)return;let $=_+q.index+1,te=$+q[0].length,Q={from:i.tr.mapping.map($),to:i.tr.mapping.map(te)},ge=r.handler({state:i,range:Q,match:q,commands:l,chain:c,can:d,pasteEvent:s,dropEvent:a});u.push(ge)})}),u.every(p=>p!==null)}var ah=null,qA=e=>{var t;let i=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(t=i.clipboardData)==null||t.setData("text/html",e),i};function $A(e){let{editor:t,rules:i}=e,n=null,o=!1,r=!1,s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}let l=({state:d,from:u,to:h,rule:p,pasteEvt:g})=>{let f=d.tr,m=uh({state:d,transaction:f});if(!(!UA({editor:t,state:m,from:Math.max(u-1,0),to:h.b-1,rule:p,pasteEvent:g,dropEvent:a})||!f.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,f}};return i.map(d=>new Pe({view(u){let h=g=>{var f;n=(f=u.dom.parentElement)!=null&&f.contains(g.target)?u.dom.parentElement:null,n&&(ah=t)},p=()=>{ah&&(ah=null)};return window.addEventListener("dragstart",h),window.addEventListener("dragend",p),{destroy(){window.removeEventListener("dragstart",h),window.removeEventListener("dragend",p)}}},props:{handleDOMEvents:{drop:(u,h)=>{if(r=n===u.dom.parentElement,a=h,!r){let p=ah;p?.isEditable&&setTimeout(()=>{let g=p.state.selection;g&&p.commands.deleteRange({from:g.from,to:g.to})},10)}return!1},paste:(u,h)=>{var p;let g=(p=h.clipboardData)==null?void 0:p.getData("text/html");return s=h,o=!!g?.includes("data-pm-slice"),!1}}},appendTransaction:(u,h,p)=>{let g=u[0],f=g.getMeta("uiEvent")==="paste"&&!o,m=g.getMeta("uiEvent")==="drop"&&!r,v=g.getMeta("applyPasteRules"),C=!!v;if(!f&&!m&&!C)return;if(C){let{text:_}=v;typeof _=="string"?_=_:_=B0(Y.from(_),p.schema);let{from:R}=v,P=R+_.length,B=qA(_);return l({rule:d,state:p,from:R,to:{b:P},pasteEvt:B})}let w=h.doc.content.findDiffStart(p.doc.content),y=h.doc.content.findDiffEnd(p.doc.content);if(!(!GA(w)||!y||w===y.b))return l({rule:d,state:p,from:w,to:y,pasteEvt:s})}}))}var jA=(()=>{let e=class{constructor(t,i){this.splittableMarks=[],this.editor=i,this.baseExtensions=t,this.extensions=U3(t),this.schema=lA(this.extensions,i),this.setupExtensions()}get commands(){return this.extensions.reduce((t,i)=>{let n={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:this.editor,type:R0(i.name,this.schema)},o=be(i,"addCommands",n);return o?b(b({},t),o()):t},{})}get plugins(){let{editor:t}=this;return k0([...this.extensions].reverse()).flatMap(o=>{let r={name:o.name,options:o.options,storage:this.editor.extensionStorage[o.name],editor:t,type:R0(o.name,this.schema)},s=[],a=be(o,"addKeyboardShortcuts",r),l={};if(o.type==="mark"&&be(o,"exitable",r)&&(l.ArrowRight=()=>Qi.handleExit({editor:t,mark:o})),a){let p=Object.fromEntries(Object.entries(a()).map(([g,f])=>[g,()=>f({editor:t})]));l=b(b({},l),p)}let c=B3(l);s.push(c);let d=be(o,"addInputRules",r);if(q3(o,t.options.enableInputRules)&&d){let p=d();if(p&&p.length){let g=HA({editor:t,rules:p}),f=Array.isArray(g)?g:[g];s.push(...f)}}let u=be(o,"addPasteRules",r);if(q3(o,t.options.enablePasteRules)&&u){let p=u();if(p&&p.length){let g=$A({editor:t,rules:p});s.push(...g)}}let h=be(o,"addProseMirrorPlugins",r);if(h){let p=h();s.push(...p)}return s})}get attributes(){return nx(this.extensions)}get nodeViews(){let{editor:t}=this,{nodeExtensions:i}=Za(this.extensions);return Object.fromEntries(i.filter(n=>!!be(n,"addNodeView")).map(n=>{let o=this.attributes.filter(c=>c.type===n.name),r={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:Et(n.name,this.schema)},s=be(n,"addNodeView",r);if(!s)return[];let a=s();if(!a)return[];let l=(c,d,u,h,p)=>{let g=dh(c,o);return a({node:c,view:d,getPos:u,decorations:h,innerDecorations:p,editor:t,extension:n,HTMLAttributes:g})};return[n.name,l]}))}get markViews(){let{editor:t}=this,{markExtensions:i}=Za(this.extensions);return Object.fromEntries(i.filter(n=>!!be(n,"addMarkView")).map(n=>{let o=this.attributes.filter(l=>l.type===n.name),r={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:Yo(n.name,this.schema)},s=be(n,"addMarkView",r);if(!s)return[];let a=(l,c,d)=>{let u=dh(l,o);return s()({mark:l,view:c,inline:d,editor:t,extension:n,HTMLAttributes:u,updateAttributes:h=>{o8(l,t,h)}})};return[n.name,a]}))}setupExtensions(){let t=this.extensions;this.editor.extensionStorage=Object.fromEntries(t.map(i=>[i.name,i.storage])),t.forEach(i=>{var n;let o={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:this.editor,type:R0(i.name,this.schema)};i.type==="mark"&&((n=et(be(i,"keepOnSplit",o)))==null||n)&&this.splittableMarks.push(i.name);let r=be(i,"onBeforeCreate",o),s=be(i,"onCreate",o),a=be(i,"onUpdate",o),l=be(i,"onSelectionUpdate",o),c=be(i,"onTransaction",o),d=be(i,"onFocus",o),u=be(i,"onBlur",o),h=be(i,"onDestroy",o);r&&this.editor.on("beforeCreate",r),s&&this.editor.on("create",s),a&&this.editor.on("update",a),l&&this.editor.on("selectionUpdate",l),c&&this.editor.on("transaction",c),d&&this.editor.on("focus",d),u&&this.editor.on("blur",u),h&&this.editor.on("destroy",h)})}};return e.resolve=U3,e.sort=k0,e.flatten=N0,e})(),KA={};F0(KA,{ClipboardTextSerializer:()=>hx,Commands:()=>px,Delete:()=>gx,Drop:()=>fx,Editable:()=>mx,FocusEvents:()=>Cx,Keymap:()=>wx,Paste:()=>bx,Tabindex:()=>yx,TextDirection:()=>Sx,focusEventsPluginKey:()=>vx});var Ue=class ux extends G0{constructor(){super(...arguments),this.type="extension"}static create(t={}){let i=typeof t=="function"?t():t;return new ux(i)}configure(t){return super.configure(t)}extend(t){let i=typeof t=="function"?t():t;return super.extend(i)}},hx=Ue.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Pe({key:new Fe("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{let{editor:e}=this,{state:t,schema:i}=e,{doc:n,selection:o}=t,{ranges:r}=o,s=Math.min(...r.map(d=>d.$from.pos)),a=Math.max(...r.map(d=>d.$to.pos)),l=rx(i);return ox(n,{from:s,to:a},z(b({},this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{}),{textSerializers:l}))}}})]}}),px=Ue.create({name:"commands",addCommands(){return b({},K3)}}),gx=Ue.create({name:"delete",onUpdate({transaction:e,appendedTransactions:t}){var i,n,o;let r=()=>{var s,a,l,c;if((c=(l=(a=(s=this.editor.options.coreExtensionOptions)==null?void 0:s.delete)==null?void 0:a.filterTransaction)==null?void 0:l.call(a,e))!=null?c:e.getMeta("y-sync$"))return;let d=O0(e.before,[e,...t]);V0(d).forEach(p=>{d.mapping.mapResult(p.oldRange.from).deletedAfter&&d.mapping.mapResult(p.oldRange.to).deletedBefore&&d.before.nodesBetween(p.oldRange.from,p.oldRange.to,(g,f)=>{let m=f+g.nodeSize-2,v=p.oldRange.from<=f&&m<=p.oldRange.to;this.editor.emit("delete",{type:"node",node:g,from:f,to:m,newFrom:d.mapping.map(f),newTo:d.mapping.map(m),deletedRange:p.oldRange,newRange:p.newRange,partial:!v,editor:this.editor,transaction:e,combinedTransform:d})})});let h=d.mapping;d.steps.forEach((p,g)=>{var f,m;if(p instanceof zo){let v=h.slice(g).map(p.from,-1),C=h.slice(g).map(p.to),w=h.invert().map(v,-1),y=h.invert().map(C),_=(f=d.doc.nodeAt(v-1))==null?void 0:f.marks.some(P=>P.eq(p.mark)),R=(m=d.doc.nodeAt(C))==null?void 0:m.marks.some(P=>P.eq(p.mark));this.editor.emit("delete",{type:"mark",mark:p.mark,from:p.from,to:p.to,deletedRange:{from:w,to:y},newRange:{from:v,to:C},partial:!!(R||_),editor:this.editor,transaction:e,combinedTransform:d})}})};(o=(n=(i=this.editor.options.coreExtensionOptions)==null?void 0:i.delete)==null?void 0:n.async)==null||o?setTimeout(r,0):r()}}),fx=Ue.create({name:"drop",addProseMirrorPlugins(){return[new Pe({key:new Fe("tiptapDrop"),props:{handleDrop:(e,t,i,n)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:i,moved:n})}}})]}}),mx=Ue.create({name:"editable",addProseMirrorPlugins(){return[new Pe({key:new Fe("editable"),props:{editable:()=>this.editor.options.editable}})]}}),vx=new Fe("focusEvents"),Cx=Ue.create({name:"focusEvents",addProseMirrorPlugins(){let{editor:e}=this;return[new Pe({key:vx,props:{handleDOMEvents:{focus:(t,i)=>{e.isFocused=!0;let n=e.state.tr.setMeta("focus",{event:i}).setMeta("addToHistory",!1);return t.dispatch(n),!1},blur:(t,i)=>{e.isFocused=!1;let n=e.state.tr.setMeta("blur",{event:i}).setMeta("addToHistory",!1);return t.dispatch(n),!1}}}})]}}),wx=Ue.create({name:"keymap",addKeyboardShortcuts(){let e=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:a})=>{let{selection:l,doc:c}=a,{empty:d,$anchor:u}=l,{pos:h,parent:p}=u,g=u.parent.isTextblock&&h>0?a.doc.resolve(h-1):u,f=g.parent.type.spec.isolating,m=u.pos-u.parentOffset,v=f&&g.parent.childCount===1?m===u.pos:Re.atStart(c).from===h;return!d||!p.type.isTextblock||p.textContent.length||!v||v&&u.parent.type.name==="paragraph"?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},o=b({},n),r=z(b({},n),{"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()});return L0()||Z3()?r:o},addProseMirrorPlugins(){return[new Pe({key:new Fe("clearDocument"),appendTransaction:(e,t,i)=>{if(e.some(f=>f.getMeta("composition")))return;let n=e.some(f=>f.docChanged)&&!t.doc.eq(i.doc),o=e.some(f=>f.getMeta("preventClearDocument"));if(!n||o)return;let{empty:r,from:s,to:a}=t.selection,l=Re.atStart(t.doc).from,c=Re.atEnd(t.doc).to;if(r||!(s===l&&a===c)||!Ac(i.doc))return;let h=i.tr,p=uh({state:i,transaction:h}),{commands:g}=new hh({editor:this.editor,state:p});if(g.clearNodes(),!!h.steps.length)return h}})]}}),bx=Ue.create({name:"paste",addProseMirrorPlugins(){return[new Pe({key:new Fe("tiptapPaste"),props:{handlePaste:(e,t,i)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:i})}}})]}}),yx=Ue.create({name:"tabindex",addProseMirrorPlugins(){return[new Pe({key:new Fe("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),Sx=Ue.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];let{nodeExtensions:e}=Za(this.extensions);return[{types:e.filter(t=>t.name!=="text").map(t=>t.name),attributes:{dir:{default:this.options.direction,parseHTML:t=>{let i=t.getAttribute("dir");return i&&(i==="ltr"||i==="rtl"||i==="auto")?i:this.options.direction},renderHTML:t=>t.dir?{dir:t.dir}:{}}}}]},addProseMirrorPlugins(){return[new Pe({key:new Fe("textDirection"),props:{attributes:()=>{let e=this.options.direction;return e?{dir:e}:{}}}})]}}),YA=class Qa{constructor(t,i,n=!1,o=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=t,this.editor=i,this.currentNode=o}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var t;return(t=this.actualDepth)!=null?t:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(t){let i=this.from,n=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can\u2019t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}i=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:i,to:n},t)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;let t=this.resolvedPos.start(this.resolvedPos.depth-1),i=this.resolvedPos.doc.resolve(t);return new Qa(i,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new Qa(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new Qa(t,this.editor)}get children(){let t=[];return this.node.content.forEach((i,n)=>{let o=i.isBlock&&!i.isTextblock,r=i.isAtom&&!i.isText,s=this.pos+n+(r?0:1);if(s<0||s>this.resolvedPos.doc.nodeSize-2)return;let a=this.resolvedPos.doc.resolve(s);if(!o&&a.depth<=this.depth)return;let l=new Qa(a,this.editor,o,o?i:null);o&&(l.actualDepth=this.depth+1),t.push(new Qa(a,this.editor,o,o?i:null))}),t}get firstChild(){return this.children[0]||null}get lastChild(){let t=this.children;return t[t.length-1]||null}closest(t,i={}){let n=null,o=this.parent;for(;o&&!n;){if(o.node.type.name===t)if(Object.keys(i).length>0){let r=o.node.attrs,s=Object.keys(i);for(let a=0;a<s.length;a+=1){let l=s[a];if(r[l]!==i[l])break}}else n=o;o=o.parent}return n}querySelector(t,i={}){return this.querySelectorAll(t,i,!0)[0]||null}querySelectorAll(t,i={},n=!1){let o=[];if(!this.children||this.children.length===0)return o;let r=Object.keys(i);return this.children.forEach(s=>{n&&o.length>0||(s.node.type.name===t&&r.every(l=>i[l]===s.node.attrs[l])&&o.push(s),!(n&&o.length>0)&&(o=o.concat(s.querySelectorAll(t,i,n))))}),o}setAttribute(t){let{tr:i}=this.editor.state;i.setNodeMarkup(this.from,void 0,b(b({},this.node.attrs),t)),this.editor.view.dispatch(i)}},XA=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function JA(e,t,i){let n=document.querySelector(`style[data-tiptap-style${i?`-${i}`:""}]`);if(n!==null)return n;let o=document.createElement("style");return t&&o.setAttribute("nonce",t),o.setAttribute(`data-tiptap-style${i?`-${i}`:""}`,""),o.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(o),o}var xx=class extends NA{constructor(e={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:o,moved:r})=>this.options.onDrop(n,o,r)),this.on("paste",({event:n,slice:o})=>this.options.onPaste(n,o)),this.on("delete",this.options.onDelete);let t=this.createDoc(),i=J3(t,this.options.autofocus);this.editorState=zu.create({doc:t,schema:this.schema,selection:i||void 0}),this.options.element&&this.mount(this.options.element)}mount(e){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(e),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){let e=this.editorView.dom;e?.editor&&delete e.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(e){console.warn("Failed to remove CSS element:",e)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=JA(XA,this.options.injectNonce))}setOptions(e={}){this.options=b(b({},this.options),e),!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:e=>{this.editorState=e},dispatch:e=>{this.dispatchTransaction(e)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(e,t)=>{if(this.editorView)return this.editorView[t];if(t==="state")return this.editorState;if(t in e)return Reflect.get(e,t);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${t}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(e,t){let i=ix(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],n=this.state.reconfigure({plugins:i});return this.view.updateState(n),n}unregisterPlugin(e){if(this.isDestroyed)return;let t=this.state.plugins,i=t;if([].concat(e).forEach(o=>{let r=typeof o=="string"?`${o}$`:o.key;i=i.filter(s=>!s.key.startsWith(r))}),t.length===i.length)return;let n=this.state.reconfigure({plugins:i});return this.view.updateState(n),n}createExtensionManager(){var e,t;let n=[...this.options.enableCoreExtensions?[mx,hx.configure({blockSeparator:(t=(e=this.options.coreExtensionOptions)==null?void 0:e.clipboardTextSerializer)==null?void 0:t.blockSeparator}),px,Cx,wx,yx,fx,bx,gx,Sx.configure({direction:this.options.textDirection})].filter(o=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[o.name]!==!1:!0):[],...this.options.extensions].filter(o=>["extension","node","mark"].includes(o?.type));this.extensionManager=new jA(n,this)}createCommandManager(){this.commandManager=new hh({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let e;try{e=M0(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(t){if(!(t instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(t.message))throw t;this.emit("contentError",{editor:this,error:t,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(i=>i.name!=="collaboration"),this.createExtensionManager()}}),e=M0(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return e}createView(e){var t;this.editorView=new kc(e,z(b({},this.options.editorProps),{attributes:b({role:"textbox"},(t=this.options.editorProps)==null?void 0:t.attributes),dispatchTransaction:this.dispatchTransaction.bind(this),state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews}));let i=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(i),this.prependClass(),this.injectCSS();let n=this.view.dom;n.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;let t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(c=>{var d;return(d=this.capturedTransaction)==null?void 0:d.step(c)});return}let{state:t,transactions:i}=this.state.applyTransaction(e),n=!this.state.selection.eq(t.selection),o=i.includes(e),r=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),!o)return;this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e,appendedTransactions:i.slice(1)}),n&&this.emit("selectionUpdate",{editor:this,transaction:e});let s=i.findLast(c=>c.getMeta("focus")||c.getMeta("blur")),a=s?.getMeta("focus"),l=s?.getMeta("blur");a&&this.emit("focus",{editor:this,event:a.event,transaction:s}),l&&this.emit("blur",{editor:this,event:l.event,transaction:s}),!(e.getMeta("preventUpdate")||!i.some(c=>c.docChanged)||r.doc.eq(t.doc))&&this.emit("update",{editor:this,transaction:e,appendedTransactions:i.slice(1)})}getAttributes(e){return H0(this.state,e)}isActive(e,t){let i=typeof e=="string"?e:null,n=typeof e=="string"?t:e;return fA(this.state,i,n)}getJSON(){return this.state.doc.toJSON()}getHTML(){return B0(this.state.doc.content,this.schema)}getText(e){let{blockSeparator:t=`

`,textSerializers:i={}}=e||{};return dA(this.state.doc,{blockSeparator:t,textSerializers:b(b({},rx(this.schema)),i)})}get isEmpty(){return Ac(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var e,t;return(t=(e=this.editorView)==null?void 0:e.isDestroyed)!=null?t:!0}$node(e,t){var i;return((i=this.$doc)==null?void 0:i.querySelector(e,t))||null}$nodes(e,t){var i;return((i=this.$doc)==null?void 0:i.querySelectorAll(e,t))||null}$pos(e){let t=this.state.doc.resolve(e);return new YA(t,this)}get $doc(){return this.$pos(0)}};function ro(e){return new vh({find:e.find,handler:({state:t,range:i,match:n})=>{let o=et(e.getAttributes,void 0,n);if(o===!1||o===null)return null;let{tr:r}=t,s=n[n.length-1],a=n[0];if(s){let l=a.search(/\S/),c=i.from+a.indexOf(s),d=c+s.length;if(fh(i.from,i.to,t.doc).filter(p=>p.mark.type.excluded.find(f=>f===e.type&&f!==p.mark.type)).filter(p=>p.to>c).length)return null;d<i.to&&r.delete(d,i.to),c>i.from&&r.delete(i.from+l,c);let h=i.from+l+s.length;r.addMark(i.from+l,h,e.type.create(o||{})),r.removeStoredMark(e.type)}},undoable:e.undoable})}function Ex(e){return new vh({find:e.find,handler:({state:t,range:i,match:n})=>{let o=et(e.getAttributes,void 0,n)||{},{tr:r}=t,s=i.from,a=i.to,l=e.type.create(o);if(n[1]){let c=n[0].lastIndexOf(n[1]),d=s+c;d>a?d=a:a=d+n[1].length;let u=n[0][n[0].length-1];r.insertText(u,s+n[0].length-1),r.replaceWith(d,a,l)}else if(n[0]){let c=e.type.isInline?s:s-1;r.insert(c,e.type.create(o)).delete(r.mapping.map(s),r.mapping.map(a))}r.scrollIntoView()},undoable:e.undoable})}function Lc(e){return new vh({find:e.find,handler:({state:t,range:i,match:n})=>{let o=t.doc.resolve(i.from),r=et(e.getAttributes,void 0,n)||{};if(!o.node(-1).canReplaceWith(o.index(-1),o.indexAfter(-1),e.type))return null;t.tr.delete(i.from,i.to).setBlockType(i.from,i.from,e.type,r)},undoable:e.undoable})}function so(e){return new vh({find:e.find,handler:({state:t,range:i,match:n,chain:o})=>{let r=et(e.getAttributes,void 0,n)||{},s=t.tr.delete(i.from,i.to),l=s.doc.resolve(i.from).blockRange(),c=l&&za(l,e.type,r);if(!c)return null;if(s.wrap(l,c),e.keepMarks&&e.editor){let{selection:u,storedMarks:h}=t,{splittableMarks:p}=e.editor.extensionManager,g=h||u.$to.parentOffset&&u.$from.marks();if(g){let f=g.filter(m=>p.includes(m.type.name));s.ensureMarks(f)}}if(e.keepAttributes){let u=e.type.name==="bulletList"||e.type.name==="orderedList"?"listItem":"taskList";o().updateAttributes(u,r).run()}let d=s.doc.resolve(i.from-1).nodeBefore;d&&d.type===e.type&&cn(s.doc,i.from-1)&&(!e.joinPredicate||e.joinPredicate(n,d))&&s.join(i.from-1)},undoable:e.undoable})}function _x(e,t){let{selection:i}=e,{$from:n}=i;if(i instanceof pe){let r=n.index();return n.parent.canReplaceWith(r,r+1,t)}let o=n.depth;for(;o>=0;){let r=n.index(o);if(n.node(o).contentMatchAt(r).matchType(t))return!0;o-=1}return!1}var QA={};F0(QA,{createAtomBlockMarkdownSpec:()=>ZA,createBlockMarkdownSpec:()=>e8,createInlineMarkdownSpec:()=>n8,parseAttributes:()=>z0,parseIndentedBlocks:()=>Ch,renderNestedMarkdownContent:()=>Oc,serializeAttributes:()=>W0});function z0(e){if(!e?.trim())return{};let t={},i=[],n=e.replace(/["']([^"']*)["']/g,c=>(i.push(c),`__QUOTED_${i.length-1}__`)),o=n.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(o){let c=o.map(d=>d.trim().slice(1));t.class=c.join(" ")}let r=n.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);r&&(t.id=r[1]);let s=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(n.matchAll(s)).forEach(([,c,d])=>{var u;let h=parseInt(((u=d.match(/__QUOTED_(\d+)__/))==null?void 0:u[1])||"0",10),p=i[h];p&&(t[c]=p.slice(1,-1))});let l=n.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return l&&l.split(/\s+/).filter(Boolean).forEach(d=>{d.match(/^[a-zA-Z][\w-]*$/)&&(t[d]=!0)}),t}function W0(e){if(!e||Object.keys(e).length===0)return"";let t=[];return e.class&&String(e.class).split(/\s+/).filter(Boolean).forEach(n=>t.push(`.${n}`)),e.id&&t.push(`#${e.id}`),Object.entries(e).forEach(([i,n])=>{i==="class"||i==="id"||(n===!0?t.push(i):n!==!1&&n!=null&&t.push(`${i}="${String(n)}"`))}),t.join(" ")}function ZA(e){let{nodeName:t,name:i,parseAttributes:n=z0,serializeAttributes:o=W0,defaultAttributes:r={},requiredAttributes:s=[],allowedAttributes:a}=e,l=i||t,c=d=>{if(!a)return d;let u={};return a.forEach(h=>{h in d&&(u[h]=d[h])}),u};return{parseMarkdown:(d,u)=>{let h=b(b({},r),d.attributes);return u.createNode(t,h,[])},markdownTokenizer:{name:t,level:"block",start(d){var u;let h=new RegExp(`^:::${l}(?:\\s|$)`,"m"),p=(u=d.match(h))==null?void 0:u.index;return p!==void 0?p:-1},tokenize(d,u,h){let p=new RegExp(`^:::${l}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),g=d.match(p);if(!g)return;let f=g[1]||"",m=n(f);if(!s.find(C=>!(C in m)))return{type:t,raw:g[0],attributes:m}}},renderMarkdown:d=>{let u=c(d.attrs||{}),h=o(u),p=h?` {${h}}`:"";return`:::${l}${p} :::`}}}function e8(e){let{nodeName:t,name:i,getContent:n,parseAttributes:o=z0,serializeAttributes:r=W0,defaultAttributes:s={},content:a="block",allowedAttributes:l}=e,c=i||t,d=u=>{if(!l)return u;let h={};return l.forEach(p=>{p in u&&(h[p]=u[p])}),h};return{parseMarkdown:(u,h)=>{let p;if(n){let f=n(u);p=typeof f=="string"?[{type:"text",text:f}]:f}else a==="block"?p=h.parseChildren(u.tokens||[]):p=h.parseInline(u.tokens||[]);let g=b(b({},s),u.attributes);return h.createNode(t,g,p)},markdownTokenizer:{name:t,level:"block",start(u){var h;let p=new RegExp(`^:::${c}`,"m"),g=(h=u.match(p))==null?void 0:h.index;return g!==void 0?g:-1},tokenize(u,h,p){var g;let f=new RegExp(`^:::${c}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),m=u.match(f);if(!m)return;let[v,C=""]=m,w=o(C),y=1,_=v.length,R="",P=/^:::([\w-]*)(\s.*)?/gm,B=u.slice(_);for(P.lastIndex=0;;){let q=P.exec(B);if(q===null)break;let $=q.index,te=q[1];if(!((g=q[2])!=null&&g.endsWith(":::"))){if(te)y+=1;else if(y-=1,y===0){let Q=B.slice(0,$);R=Q.trim();let ge=u.slice(0,_+$+q[0].length),Me=[];if(R)if(a==="block")for(Me=p.blockTokens(Q),Me.forEach(De=>{De.text&&(!De.tokens||De.tokens.length===0)&&(De.tokens=p.inlineTokens(De.text))});Me.length>0;){let De=Me[Me.length-1];if(De.type==="paragraph"&&(!De.text||De.text.trim()===""))Me.pop();else break}else Me=p.inlineTokens(R);return{type:t,raw:ge,attributes:w,content:R,tokens:Me}}}}}},renderMarkdown:(u,h)=>{let p=d(u.attrs||{}),g=r(p),f=g?` {${g}}`:"",m=h.renderChildren(u.content||[],`

`);return`:::${c}${f}

${m}

:::`}}}function t8(e){if(!e.trim())return{};let t={},i=/(\w+)=(?:"([^"]*)"|'([^']*)')/g,n=i.exec(e);for(;n!==null;){let[,o,r,s]=n;t[o]=r||s,n=i.exec(e)}return t}function i8(e){return Object.entries(e).filter(([,t])=>t!=null).map(([t,i])=>`${t}="${i}"`).join(" ")}function n8(e){let{nodeName:t,name:i,getContent:n,parseAttributes:o=t8,serializeAttributes:r=i8,defaultAttributes:s={},selfClosing:a=!1,allowedAttributes:l}=e,c=i||t,d=h=>{if(!l)return h;let p={};return l.forEach(g=>{g in h&&(p[g]=h[g])}),p},u=c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(h,p)=>{let g=b(b({},s),h.attributes);if(a)return p.createNode(t,g);let f=n?n(h):h.content||"";return f?p.createNode(t,g,[p.createTextNode(f)]):p.createNode(t,g,[])},markdownTokenizer:{name:t,level:"inline",start(h){let p=a?new RegExp(`\\[${u}\\s*[^\\]]*\\]`):new RegExp(`\\[${u}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${u}\\]`),g=h.match(p),f=g?.index;return f!==void 0?f:-1},tokenize(h,p,g){let f=a?new RegExp(`^\\[${u}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${u}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${u}\\]`),m=h.match(f);if(!m)return;let v="",C="";if(a){let[,y]=m;C=y}else{let[,y,_]=m;C=y,v=_||""}let w=o(C.trim());return{type:t,raw:m[0],content:v.trim(),attributes:w}}},renderMarkdown:h=>{let p="";n?p=n(h):h.content&&h.content.length>0&&(p=h.content.filter(v=>v.type==="text").map(v=>v.text).join(""));let g=d(h.attrs||{}),f=r(g),m=f?` ${f}`:"";return a?`[${c}${m}]`:`[${c}${m}]${p}[/${c}]`}}}function Ch(e,t,i){var n,o,r,s;let a=e.split(`
`),l=[],c="",d=0,u=t.baseIndentSize||2;for(;d<a.length;){let h=a[d],p=h.match(t.itemPattern);if(!p){if(l.length>0)break;if(h.trim()===""){d+=1,c=`${c}${h}
`;continue}else return}let g=t.extractItemData(p),{indentLevel:f,mainContent:m}=g;c=`${c}${h}
`;let v=[m];for(d+=1;d<a.length;){let _=a[d];if(_.trim()===""){let P=a.slice(d+1).findIndex($=>$.trim()!=="");if(P===-1)break;if((((o=(n=a[d+1+P].match(/^(\s*)/))==null?void 0:n[1])==null?void 0:o.length)||0)>f){v.push(_),c=`${c}${_}
`,d+=1;continue}else break}if((((s=(r=_.match(/^(\s*)/))==null?void 0:r[1])==null?void 0:s.length)||0)>f)v.push(_),c=`${c}${_}
`,d+=1;else break}let C,w=v.slice(1);if(w.length>0){let _=w.map(R=>R.slice(f+u)).join(`
`);_.trim()&&(t.customNestedParser?C=t.customNestedParser(_):C=i.blockTokens(_))}let y=t.createToken(g,C);l.push(y)}if(l.length!==0)return{items:l,raw:c}}function Oc(e,t,i,n){if(!e||!Array.isArray(e.content))return"";let o=typeof i=="function"?i(n):i,[r,...s]=e.content,a=t.renderChildren([r]),l=[`${o}${a}`];return s&&s.length>0&&s.forEach(c=>{let d=t.renderChildren([c]);if(d){let u=d.split(`
`).map(h=>h?t.indent(h):"").join(`
`);l.push(u)}}),l.join(`
`)}function o8(e,t,i={}){let{state:n}=t,{doc:o,tr:r}=n,s=e;o.descendants((a,l)=>{let c=r.mapping.map(l),d=r.mapping.map(l)+a.nodeSize,u=null;if(a.marks.forEach(p=>{if(p!==s)return!1;u=p}),!u)return;let h=!1;if(Object.keys(i).forEach(p=>{i[p]!==u.attrs[p]&&(h=!0)}),h){let p=e.type.create(b(b({},e.attrs),i));r.removeMark(c,d,e.type),r.addMark(c,d,p)}}),r.docChanged&&t.view.dispatch(r)}var ut=class Rx extends G0{constructor(){super(...arguments),this.type="node"}static create(t={}){let i=typeof t=="function"?t():t;return new Rx(i)}configure(t){return super.configure(t)}extend(t){let i=typeof t=="function"?t():t;return super.extend(i)}};function gn(e){return new zA({find:e.find,handler:({state:t,range:i,match:n,pasteEvent:o})=>{let r=et(e.getAttributes,void 0,n,o);if(r===!1||r===null)return null;let{tr:s}=t,a=n[n.length-1],l=n[0],c=i.to;if(a){let d=l.search(/\S/),u=i.from+l.indexOf(a),h=u+a.length;if(fh(i.from,i.to,t.doc).filter(g=>g.mark.type.excluded.find(m=>m===e.type&&m!==g.mark.type)).filter(g=>g.to>u).length)return null;h<i.to&&s.delete(h,i.to),u>i.from&&s.delete(i.from+d,u),c=i.from+d+a.length,s.addMark(i.from+d,c,e.type.create(r||{})),s.removeStoredMark(e.type)}}})}var r8="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5m\xF6gensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",s8="\u03B5\u03BB1\u03C52\u0431\u04331\u0435\u043B3\u0434\u0435\u0442\u04384\u0435\u044E2\u043A\u0430\u0442\u043E\u043B\u0438\u043A6\u043E\u043C3\u043C\u043A\u04342\u043E\u043D1\u0441\u043A\u0432\u04306\u043E\u043D\u043B\u0430\u0439\u043D5\u0440\u04333\u0440\u0443\u04412\u04442\u0441\u0430\u0439\u04423\u0440\u04313\u0443\u043A\u04403\u049B\u0430\u04373\u0570\u0561\u05753\u05D9\u05E9\u05E8\u05D0\u05DC5\u05E7\u05D5\u05DD3\u0627\u0628\u0648\u0638\u0628\u064A5\u0631\u0627\u0645\u0643\u06485\u0644\u0627\u0631\u062F\u06464\u0628\u062D\u0631\u064A\u06465\u062C\u0632\u0627\u0626\u06315\u0633\u0639\u0648\u062F\u064A\u06296\u0639\u0644\u064A\u0627\u06465\u0645\u063A\u0631\u06285\u0645\u0627\u0631\u0627\u062A5\u06CC\u0631\u0627\u06465\u0628\u0627\u0631\u062A2\u0632\u0627\u06314\u064A\u062A\u06433\u06BE\u0627\u0631\u062A5\u062A\u0648\u0646\u06334\u0633\u0648\u062F\u0627\u06463\u0631\u064A\u06295\u0634\u0628\u0643\u06294\u0639\u0631\u0627\u06422\u06282\u0645\u0627\u06464\u0641\u0644\u0633\u0637\u064A\u06466\u0642\u0637\u06313\u0643\u0627\u062B\u0648\u0644\u064A\u06436\u0648\u06453\u0645\u0635\u06312\u0644\u064A\u0633\u064A\u06275\u0648\u0631\u064A\u062A\u0627\u0646\u064A\u06277\u0642\u06394\u0647\u0645\u0631\u0627\u06475\u067E\u0627\u06A9\u0633\u062A\u0627\u06467\u0680\u0627\u0631\u062A4\u0915\u0949\u092E3\u0928\u0947\u091F3\u092D\u093E\u0930\u09240\u092E\u094D3\u094B\u09245\u0938\u0902\u0917\u0920\u09285\u09AC\u09BE\u0982\u09B2\u09BE5\u09AD\u09BE\u09B0\u09A42\u09F0\u09A44\u0A2D\u0A3E\u0A30\u0A244\u0AAD\u0ABE\u0AB0\u0AA44\u0B2D\u0B3E\u0B30\u0B244\u0B87\u0BA8\u0BCD\u0BA4\u0BBF\u0BAF\u0BBE6\u0BB2\u0B99\u0BCD\u0B95\u0BC86\u0B9A\u0BBF\u0B99\u0BCD\u0B95\u0BAA\u0BCD\u0BAA\u0BC2\u0BB0\u0BCD11\u0C2D\u0C3E\u0C30\u0C24\u0C4D5\u0CAD\u0CBE\u0CB0\u0CA44\u0D2D\u0D3E\u0D30\u0D24\u0D025\u0DBD\u0D82\u0D9A\u0DCF4\u0E04\u0E2D\u0E213\u0E44\u0E17\u0E223\u0EA5\u0EB2\u0EA73\u10D2\u10D42\u307F\u3093\u306A3\u30A2\u30DE\u30BE\u30F34\u30AF\u30E9\u30A6\u30C94\u30B0\u30FC\u30B0\u30EB4\u30B3\u30E02\u30B9\u30C8\u30A23\u30BB\u30FC\u30EB3\u30D5\u30A1\u30C3\u30B7\u30E7\u30F36\u30DD\u30A4\u30F3\u30C84\u4E16\u754C2\u4E2D\u4FE11\u56FD1\u570B1\u6587\u7F513\u4E9A\u9A6C\u900A3\u4F01\u4E1A2\u4F5B\u5C712\u4FE1\u606F2\u5065\u5EB72\u516B\u53662\u516C\u53F81\u76CA2\u53F0\u6E7E1\u70632\u5546\u57CE1\u5E971\u68072\u5609\u91CC0\u5927\u9152\u5E975\u5728\u7EBF2\u5927\u62FF2\u5929\u4E3B\u65593\u5A31\u4E502\u5BB6\u96FB2\u5E7F\u4E1C2\u5FAE\u535A2\u6148\u55842\u6211\u7231\u4F603\u624B\u673A2\u62DB\u80582\u653F\u52A11\u5E9C2\u65B0\u52A0\u57612\u95FB2\u65F6\u5C1A2\u66F8\u7C4D2\u673A\u67842\u6DE1\u9A6C\u95213\u6E38\u620F2\u6FB3\u95802\u70B9\u770B2\u79FB\u52A82\u7EC4\u7EC7\u673A\u67844\u7F51\u57401\u5E971\u7AD91\u7EDC2\u8054\u901A2\u8C37\u6B4C2\u8D2D\u72692\u901A\u8CA92\u96C6\u56E22\u96FB\u8A0A\u76C8\u79D14\u98DE\u5229\u6D663\u98DF\u54C12\u9910\u53852\u9999\u683C\u91CC\u62C93\u6E2F2\uB2F7\uB1371\uCEF42\uC0BC\uC1312\uD55C\uAD6D2",X0="numeric",J0="ascii",Q0="alpha",Hc="asciinumeric",Bc="alphanumeric",Z0="domain",Ix="emoji",a8="scheme",l8="slashscheme",U0="whitespace";function c8(e,t){return e in t||(t[e]=[]),t[e]}function $s(e,t,i){t[X0]&&(t[Hc]=!0,t[Bc]=!0),t[J0]&&(t[Hc]=!0,t[Q0]=!0),t[Hc]&&(t[Bc]=!0),t[Q0]&&(t[Bc]=!0),t[Bc]&&(t[Z0]=!0),t[Ix]&&(t[Z0]=!0);for(let n in t){let o=c8(n,i);o.indexOf(e)<0&&o.push(e)}}function d8(e,t){let i={};for(let n in t)t[n].indexOf(e)>=0&&(i[n]=!0);return i}function Vi(e=null){this.j={},this.jr=[],this.jd=null,this.t=e}Vi.groups={};Vi.prototype={accepts(){return!!this.t},go(e){let t=this,i=t.j[e];if(i)return i;for(let n=0;n<t.jr.length;n++){let o=t.jr[n][0],r=t.jr[n][1];if(r&&o.test(e))return r}return t.jd},has(e,t=!1){return t?e in this.j:!!this.go(e)},ta(e,t,i,n){for(let o=0;o<e.length;o++)this.tt(e[o],t,i,n)},tr(e,t,i,n){n=n||Vi.groups;let o;return t&&t.j?o=t:(o=new Vi(t),i&&n&&$s(t,i,n)),this.jr.push([e,o]),o},ts(e,t,i,n){let o=this,r=e.length;if(!r)return o;for(let s=0;s<r-1;s++)o=o.tt(e[s]);return o.tt(e[r-1],t,i,n)},tt(e,t,i,n){n=n||Vi.groups;let o=this;if(t&&t.j)return o.j[e]=t,t;let r=t,s,a=o.go(e);if(a?(s=new Vi,Object.assign(s.j,a.j),s.jr.push.apply(s.jr,a.jr),s.jd=a.jd,s.t=a.t):s=new Vi,r){if(n)if(s.t&&typeof s.t=="string"){let l=Object.assign(d8(s.t,n),i);$s(r,l,n)}else i&&$s(r,i,n);s.t=r}return o.j[e]=s,s}};var Te=(e,t,i,n,o)=>e.ta(t,i,n,o),_t=(e,t,i,n,o)=>e.tr(t,i,n,o),Px=(e,t,i,n,o)=>e.ts(t,i,n,o),X=(e,t,i,n,o)=>e.tt(t,i,n,o),Qo="WORD",ev="UWORD",Ax="ASCIINUMERICAL",Lx="ALPHANUMERICAL",qc="LOCALHOST",tv="TLD",iv="UTLD",Sh="SCHEME",el="SLASH_SCHEME",ov="NUM",nv="WS",rv="NL",Vc="OPENBRACE",Gc="CLOSEBRACE",xh="OPENBRACKET",Eh="CLOSEBRACKET",_h="OPENPAREN",Rh="CLOSEPAREN",Ph="OPENANGLEBRACKET",Dh="CLOSEANGLEBRACKET",Mh="FULLWIDTHLEFTPAREN",kh="FULLWIDTHRIGHTPAREN",Th="LEFTCORNERBRACKET",Fh="RIGHTCORNERBRACKET",Ih="LEFTWHITECORNERBRACKET",Ah="RIGHTWHITECORNERBRACKET",Lh="FULLWIDTHLESSTHAN",Oh="FULLWIDTHGREATERTHAN",Nh="AMPERSAND",Bh="APOSTROPHE",Hh="ASTERISK",Wr="AT",Vh="BACKSLASH",Gh="BACKTICK",zh="CARET",Ur="COLON",sv="COMMA",Wh="DOLLAR",ao="DOT",Uh="EQUALS",av="EXCLAMATION",mn="HYPHEN",zc="PERCENT",qh="PIPE",$h="PLUS",jh="POUND",Wc="QUERY",lv="QUOTE",Ox="FULLWIDTHMIDDLEDOT",cv="SEMI",lo="SLASH",Uc="TILDE",Kh="UNDERSCORE",Nx="EMOJI",Yh="SYM",Bx=Object.freeze({__proto__:null,ALPHANUMERICAL:Lx,AMPERSAND:Nh,APOSTROPHE:Bh,ASCIINUMERICAL:Ax,ASTERISK:Hh,AT:Wr,BACKSLASH:Vh,BACKTICK:Gh,CARET:zh,CLOSEANGLEBRACKET:Dh,CLOSEBRACE:Gc,CLOSEBRACKET:Eh,CLOSEPAREN:Rh,COLON:Ur,COMMA:sv,DOLLAR:Wh,DOT:ao,EMOJI:Nx,EQUALS:Uh,EXCLAMATION:av,FULLWIDTHGREATERTHAN:Oh,FULLWIDTHLEFTPAREN:Mh,FULLWIDTHLESSTHAN:Lh,FULLWIDTHMIDDLEDOT:Ox,FULLWIDTHRIGHTPAREN:kh,HYPHEN:mn,LEFTCORNERBRACKET:Th,LEFTWHITECORNERBRACKET:Ih,LOCALHOST:qc,NL:rv,NUM:ov,OPENANGLEBRACKET:Ph,OPENBRACE:Vc,OPENBRACKET:xh,OPENPAREN:_h,PERCENT:zc,PIPE:qh,PLUS:$h,POUND:jh,QUERY:Wc,QUOTE:lv,RIGHTCORNERBRACKET:Fh,RIGHTWHITECORNERBRACKET:Ah,SCHEME:Sh,SEMI:cv,SLASH:lo,SLASH_SCHEME:el,SYM:Yh,TILDE:Uc,TLD:tv,UNDERSCORE:Kh,UTLD:iv,UWORD:ev,WORD:Qo,WS:nv}),Xo=/[a-z]/,Nc=new RegExp("\\p{L}","u"),q0=new RegExp("\\p{Emoji}","u");var Jo=/\d/,$0=/\s/;var Dx="\r",j0=`
`,u8="\uFE0F",h8="\u200D",K0="\uFFFC",wh=null,bh=null;function p8(e=[]){let t={};Vi.groups=t;let i=new Vi;wh==null&&(wh=Mx(r8)),bh==null&&(bh=Mx(s8)),X(i,"'",Bh),X(i,"{",Vc),X(i,"}",Gc),X(i,"[",xh),X(i,"]",Eh),X(i,"(",_h),X(i,")",Rh),X(i,"<",Ph),X(i,">",Dh),X(i,"\uFF08",Mh),X(i,"\uFF09",kh),X(i,"\u300C",Th),X(i,"\u300D",Fh),X(i,"\u300E",Ih),X(i,"\u300F",Ah),X(i,"\uFF1C",Lh),X(i,"\uFF1E",Oh),X(i,"&",Nh),X(i,"*",Hh),X(i,"@",Wr),X(i,"`",Gh),X(i,"^",zh),X(i,":",Ur),X(i,",",sv),X(i,"$",Wh),X(i,".",ao),X(i,"=",Uh),X(i,"!",av),X(i,"-",mn),X(i,"%",zc),X(i,"|",qh),X(i,"+",$h),X(i,"#",jh),X(i,"?",Wc),X(i,'"',lv),X(i,"/",lo),X(i,";",cv),X(i,"~",Uc),X(i,"_",Kh),X(i,"\\",Vh),X(i,"\u30FB",Ox);let n=_t(i,Jo,ov,{[X0]:!0});_t(n,Jo,n);let o=_t(n,Xo,Ax,{[Hc]:!0}),r=_t(n,Nc,Lx,{[Bc]:!0}),s=_t(i,Xo,Qo,{[J0]:!0});_t(s,Jo,o),_t(s,Xo,s),_t(o,Jo,o),_t(o,Xo,o);let a=_t(i,Nc,ev,{[Q0]:!0});_t(a,Xo),_t(a,Jo,r),_t(a,Nc,a),_t(r,Jo,r),_t(r,Xo),_t(r,Nc,r);let l=X(i,j0,rv,{[U0]:!0}),c=X(i,Dx,nv,{[U0]:!0}),d=_t(i,$0,nv,{[U0]:!0});X(i,K0,d),X(c,j0,l),X(c,K0,d),_t(c,$0,d),X(d,Dx),X(d,j0),_t(d,$0,d),X(d,K0,d);let u=_t(i,q0,Nx,{[Ix]:!0});X(u,"#"),_t(u,q0,u),X(u,u8,u);let h=X(u,h8);X(h,"#"),_t(h,q0,u);let p=[[Xo,s],[Jo,o]],g=[[Xo,null],[Nc,a],[Jo,r]];for(let f=0;f<wh.length;f++)zr(i,wh[f],tv,Qo,p);for(let f=0;f<bh.length;f++)zr(i,bh[f],iv,ev,g);$s(tv,{tld:!0,ascii:!0},t),$s(iv,{utld:!0,alpha:!0},t),zr(i,"file",Sh,Qo,p),zr(i,"mailto",Sh,Qo,p),zr(i,"http",el,Qo,p),zr(i,"https",el,Qo,p),zr(i,"ftp",el,Qo,p),zr(i,"ftps",el,Qo,p),$s(Sh,{scheme:!0,ascii:!0},t),$s(el,{slashscheme:!0,ascii:!0},t),e=e.sort((f,m)=>f[0]>m[0]?1:-1);for(let f=0;f<e.length;f++){let m=e[f][0],C=e[f][1]?{[a8]:!0}:{[l8]:!0};m.indexOf("-")>=0?C[Z0]=!0:Xo.test(m)?Jo.test(m)?C[Hc]=!0:C[J0]=!0:C[X0]=!0,Px(i,m,m,C)}return Px(i,"localhost",qc,{ascii:!0}),i.jd=new Vi(Yh),{start:i,tokens:Object.assign({groups:t},Bx)}}function Hx(e,t){let i=g8(t.replace(/[A-Z]/g,a=>a.toLowerCase())),n=i.length,o=[],r=0,s=0;for(;s<n;){let a=e,l=null,c=0,d=null,u=-1,h=-1;for(;s<n&&(l=a.go(i[s]));)a=l,a.accepts()?(u=0,h=0,d=a):u>=0&&(u+=i[s].length,h++),c+=i[s].length,r+=i[s].length,s++;r-=u,s-=h,c-=u,o.push({t:d.t,v:t.slice(r-c,r),s:r-c,e:r})}return o}function g8(e){let t=[],i=e.length,n=0;for(;n<i;){let o=e.charCodeAt(n),r,s=o<55296||o>56319||n+1===i||(r=e.charCodeAt(n+1))<56320||r>57343?e[n]:e.slice(n,n+2);t.push(s),n+=s.length}return t}function zr(e,t,i,n,o){let r,s=t.length;for(let a=0;a<s-1;a++){let l=t[a];e.j[l]?r=e.j[l]:(r=new Vi(n),r.jr=o.slice(),e.j[l]=r),e=r}return r=new Vi(i),r.jr=o.slice(),e.j[t[s-1]]=r,r}function Mx(e){let t=[],i=[],n=0,o="0123456789";for(;n<e.length;){let r=0;for(;o.indexOf(e[n+r])>=0;)r++;if(r>0){t.push(i.join(""));for(let s=parseInt(e.substring(n,n+r),10);s>0;s--)i.pop();n+=r}else i.push(e[n]),n++}return t}var $c={defaultProtocol:"http",events:null,format:kx,formatHref:kx,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function dv(e,t=null){let i=Object.assign({},$c);e&&(i=Object.assign(i,e instanceof dv?e.o:e));let n=i.ignoreTags,o=[];for(let r=0;r<n.length;r++)o.push(n[r].toUpperCase());this.o=i,t&&(this.defaultRender=t),this.ignoreTags=o}dv.prototype={o:$c,ignoreTags:[],defaultRender(e){return e},check(e){return this.get("validate",e.toString(),e)},get(e,t,i){let n=t!=null,o=this.o[e];return o&&(typeof o=="object"?(o=i.t in o?o[i.t]:$c[e],typeof o=="function"&&n&&(o=o(t,i))):typeof o=="function"&&n&&(o=o(t,i.t,i)),o)},getObj(e,t,i){let n=this.o[e];return typeof n=="function"&&t!=null&&(n=n(t,i.t,i)),n},render(e){let t=e.render(this);return(this.get("render",null,e)||this.defaultRender)(t,e.t,e)}};function kx(e){return e}function Vx(e,t){this.t="token",this.v=e,this.tk=t}Vx.prototype={isLink:!1,toString(){return this.v},toHref(e){return this.toString()},toFormattedString(e){let t=this.toString(),i=e.get("truncate",t,this),n=e.get("format",t,this);return i&&n.length>i?n.substring(0,i)+"\u2026":n},toFormattedHref(e){return e.get("formatHref",this.toHref(e.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(e=$c.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(e),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(e){return{type:this.t,value:this.toFormattedString(e),isLink:this.isLink,href:this.toFormattedHref(e),start:this.startIndex(),end:this.endIndex()}},validate(e){return e.get("validate",this.toString(),this)},render(e){let t=this,i=this.toHref(e.get("defaultProtocol")),n=e.get("formatHref",i,this),o=e.get("tagName",i,t),r=this.toFormattedString(e),s={},a=e.get("className",i,t),l=e.get("target",i,t),c=e.get("rel",i,t),d=e.getObj("attributes",i,t),u=e.getObj("events",i,t);return s.href=n,a&&(s.class=a),l&&(s.target=l),c&&(s.rel=c),d&&Object.assign(s,d),{tagName:o,attributes:s,content:r,eventListeners:u}}};function Xh(e,t){class i extends Vx{constructor(o,r){super(o,r),this.t=e}}for(let n in t)i.prototype[n]=t[n];return i.t=e,i}var Tx=Xh("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),Fx=Xh("text"),f8=Xh("nl"),yh=Xh("url",{isLink:!0,toHref(e=$c.defaultProtocol){return this.hasProtocol()?this.v:`${e}://${this.v}`},hasProtocol(){let e=this.tk;return e.length>=2&&e[0].t!==qc&&e[1].t===Ur}});var fn=e=>new Vi(e);function m8({groups:e}){let t=e.domain.concat([Nh,Hh,Wr,Vh,Gh,zh,Wh,Uh,mn,ov,zc,qh,$h,jh,lo,Yh,Uc,Kh]),i=[Bh,Ur,sv,ao,av,zc,Wc,lv,cv,Ph,Dh,Vc,Gc,Eh,xh,_h,Rh,Mh,kh,Th,Fh,Ih,Ah,Lh,Oh],n=[Nh,Bh,Hh,Vh,Gh,zh,Wh,Uh,mn,Vc,Gc,zc,qh,$h,jh,Wc,lo,Yh,Uc,Kh],o=fn(),r=X(o,Uc);Te(r,n,r),Te(r,e.domain,r);let s=fn(),a=fn(),l=fn();Te(o,e.domain,s),Te(o,e.scheme,a),Te(o,e.slashscheme,l),Te(s,n,r),Te(s,e.domain,s);let c=X(s,Wr);X(r,Wr,c),X(a,Wr,c),X(l,Wr,c);let d=X(r,ao);Te(d,n,r),Te(d,e.domain,r);let u=fn();Te(c,e.domain,u),Te(u,e.domain,u);let h=X(u,ao);Te(h,e.domain,u);let p=fn(Tx);Te(h,e.tld,p),Te(h,e.utld,p),X(c,qc,p);let g=X(u,mn);X(g,mn,g),Te(g,e.domain,u),Te(p,e.domain,u),X(p,ao,h),X(p,mn,g);let f=X(p,Ur);Te(f,e.numeric,Tx);let m=X(s,mn),v=X(s,ao);X(m,mn,m),Te(m,e.domain,s),Te(v,n,r),Te(v,e.domain,s);let C=fn(yh);Te(v,e.tld,C),Te(v,e.utld,C),Te(C,e.domain,s),Te(C,n,r),X(C,ao,v),X(C,mn,m),X(C,Wr,c);let w=X(C,Ur),y=fn(yh);Te(w,e.numeric,y);let _=fn(yh),R=fn();Te(_,t,_),Te(_,i,R),Te(R,t,_),Te(R,i,R),X(C,lo,_),X(y,lo,_);let P=X(a,Ur),B=X(l,Ur),q=X(B,lo),$=X(q,lo);Te(a,e.domain,s),X(a,ao,v),X(a,mn,m),Te(l,e.domain,s),X(l,ao,v),X(l,mn,m),Te(P,e.domain,_),X(P,lo,_),X(P,Wc,_),Te($,e.domain,_),Te($,t,_),X($,lo,_);let te=[[Vc,Gc],[xh,Eh],[_h,Rh],[Ph,Dh],[Mh,kh],[Th,Fh],[Ih,Ah],[Lh,Oh]];for(let Q=0;Q<te.length;Q++){let[ge,Me]=te[Q],De=X(_,ge);X(R,ge,De),X(De,Me,_);let xt=fn(yh);Te(De,t,xt);let Ui=fn();Te(De,i),Te(xt,t,xt),Te(xt,i,Ui),Te(Ui,t,xt),Te(Ui,i,Ui),X(xt,Me,_),X(Ui,Me,_)}return X(o,qc,C),X(o,rv,f8),{start:o,tokens:Bx}}function v8(e,t,i){let n=i.length,o=0,r=[],s=[];for(;o<n;){let a=e,l=null,c=null,d=0,u=null,h=-1;for(;o<n&&!(l=a.go(i[o].t));)s.push(i[o++]);for(;o<n&&(c=l||a.go(i[o].t));)l=null,a=c,a.accepts()?(h=0,u=a):h>=0&&h++,o++,d++;if(h<0)o-=d,o<n&&(s.push(i[o]),o++);else{s.length>0&&(r.push(Y0(Fx,t,s)),s=[]),o-=h,d-=h;let p=u.t,g=i.slice(o-d,o);r.push(Y0(p,t,g))}}return s.length>0&&r.push(Y0(Fx,t,s)),r}function Y0(e,t,i){let n=i[0].s,o=i[i.length-1].e,r=t.slice(n,o);return new e(r,i)}var C8=typeof console<"u"&&console&&console.warn||(()=>{}),w8="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",gt={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function Gx(){return Vi.groups={},gt.scanner=null,gt.parser=null,gt.tokenQueue=[],gt.pluginQueue=[],gt.customSchemes=[],gt.initialized=!1,gt}function uv(e,t=!1){if(gt.initialized&&C8(`linkifyjs: already initialized - will not register custom scheme "${e}" ${w8}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(e))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);gt.customSchemes.push([e,t])}function b8(){gt.scanner=p8(gt.customSchemes);for(let e=0;e<gt.tokenQueue.length;e++)gt.tokenQueue[e][1]({scanner:gt.scanner});gt.parser=m8(gt.scanner.tokens);for(let e=0;e<gt.pluginQueue.length;e++)gt.pluginQueue[e][1]({scanner:gt.scanner,parser:gt.parser});return gt.initialized=!0,gt}function Jh(e){return gt.initialized||b8(),v8(gt.parser.start,e,Hx(gt.scanner.start,e))}Jh.scan=Hx;function Qh(e,t=null,i=null){if(t&&typeof t=="object"){if(i)throw Error(`linkifyjs: Invalid link type ${t}; must be a string`);i=t,t=null}let n=new dv(i),o=Jh(e),r=[];for(let s=0;s<o.length;s++){let a=o[s];a.isLink&&(!t||a.t===t)&&n.check(a)&&r.push(a.toFormattedObject(n))}return r}var hv="[\0- \xA0\u1680\u180E\u2000-\u2029\u205F\u3000]",y8=new RegExp(hv),S8=new RegExp(`${hv}$`),x8=new RegExp(hv,"g");function E8(e){return e.length===1?e[0].isLink:e.length===3&&e[1].isLink?["()","[]"].includes(e[0].value+e[2].value):!1}function _8(e){return new Pe({key:new Fe("autolink"),appendTransaction:(t,i,n)=>{let o=t.some(c=>c.docChanged)&&!i.doc.eq(n.doc),r=t.some(c=>c.getMeta("preventAutolink"));if(!o||r)return;let{tr:s}=n,a=O0(i.doc,[...t]);if(V0(a).forEach(({newRange:c})=>{let d=tx(n.doc,c,p=>p.isTextblock),u,h;if(d.length>1)u=d[0],h=n.doc.textBetween(u.pos,u.pos+u.node.nodeSize,void 0," ");else if(d.length){let p=n.doc.textBetween(c.from,c.to," "," ");if(!S8.test(p))return;u=d[0],h=n.doc.textBetween(u.pos,c.to,void 0," ")}if(u&&h){let p=h.split(y8).filter(Boolean);if(p.length<=0)return!1;let g=p[p.length-1],f=u.pos+h.lastIndexOf(g);if(!g)return!1;let m=Jh(g).map(v=>v.toObject(e.defaultProtocol));if(!E8(m))return!1;m.filter(v=>v.isLink).map(v=>z(b({},v),{from:f+v.start+1,to:f+v.end+1})).filter(v=>n.schema.marks.code?!n.doc.rangeHasMark(v.from,v.to,n.schema.marks.code):!0).filter(v=>e.validate(v.value)).filter(v=>e.shouldAutoLink(v.value)).forEach(v=>{fh(v.from,v.to,n.doc).some(C=>C.mark.type===e.type)||s.addMark(v.from,v.to,e.type.create({href:v.href}))})}}),!!s.steps.length)return s}})}function R8(e){return new Pe({key:new Fe("handleClickLink"),props:{handleClick:(t,i,n)=>{var o,r;if(n.button!==0||!t.editable)return!1;let s=null;if(n.target instanceof HTMLAnchorElement)s=n.target;else{let d=n.target,u=[];for(;d.nodeName!=="DIV";)u.push(d),d=d.parentNode;s=u.find(h=>h.nodeName==="A")}if(!s)return!1;let a=H0(t.state,e.type.name),l=(o=s?.href)!=null?o:a.href,c=(r=s?.target)!=null?r:a.target;return e.enableClickSelection&&e.editor.commands.extendMarkRange(e.type.name),s&&l?(window.open(l,c),!0):!1}}})}function P8(e){return new Pe({key:new Fe("handlePasteLink"),props:{handlePaste:(t,i,n)=>{let{shouldAutoLink:o}=e,{state:r}=t,{selection:s}=r,{empty:a}=s;if(a)return!1;let l="";n.content.forEach(d=>{l+=d.textContent});let c=Qh(l,{defaultProtocol:e.defaultProtocol}).find(d=>d.isLink&&d.value===l);return!l||!c||o!==void 0&&!o(c.href)?!1:e.editor.commands.setMark(e.type,{href:c.href})}}})}function js(e,t){let i=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach(n=>{let o=typeof n=="string"?n:n.scheme;o&&i.push(o)}),!e||e.replace(x8,"").match(new RegExp(`^(?:(?:${i.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var pv=Qi.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(e=>{if(typeof e=="string"){uv(e);return}uv(e.scheme,e.optionalSlashes)})},onDestroy(){Gx()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(e,t)=>!!js(e,t.protocols),validate:e=>!!e,shouldAutoLink:e=>!!e}},addAttributes(){return{href:{default:null,parseHTML(e){return e.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:e=>{let t=e.getAttribute("href");return!t||!this.options.isAllowedUri(t,{defaultValidate:i=>!!js(i,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:e}){return this.options.isAllowedUri(e.href,{defaultValidate:t=>!!js(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",Le(this.options.HTMLAttributes,e),0]:["a",Le(this.options.HTMLAttributes,z(b({},e),{href:""})),0]},markdownTokenName:"link",parseMarkdown:(e,t)=>t.applyMark("link",t.parseInline(e.tokens||[]),{href:e.href,title:e.title||null}),renderMarkdown:(e,t)=>{var i;let n=((i=e.attrs)==null?void 0:i.href)||"";return`[${t.renderChildren(e)}](${n})`},addCommands(){return{setLink:e=>({chain:t})=>{let{href:i}=e;return this.options.isAllowedUri(i,{defaultValidate:n=>!!js(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?t().setMark(this.name,e).setMeta("preventAutolink",!0).run():!1},toggleLink:e=>({chain:t})=>{let{href:i}=e||{};return i&&!this.options.isAllowedUri(i,{defaultValidate:n=>!!js(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:t().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[gn({find:e=>{let t=[];if(e){let{protocols:i,defaultProtocol:n}=this.options,o=Qh(e).filter(r=>r.isLink&&this.options.isAllowedUri(r.value,{defaultValidate:s=>!!js(s,i),protocols:i,defaultProtocol:n}));o.length&&o.forEach(r=>{this.options.shouldAutoLink(r.value)&&t.push({text:r.value,data:{href:r.href},index:r.start})})}return t},type:this.type,getAttributes:e=>{var t;return{href:(t=e.data)==null?void 0:t.href}}})]},addProseMirrorPlugins(){let e=[],{protocols:t,defaultProtocol:i}=this.options;return this.options.autolink&&e.push(_8({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:n=>this.options.isAllowedUri(n,{defaultValidate:o=>!!js(o,t),protocols:t,defaultProtocol:i}),shouldAutoLink:this.options.shouldAutoLink})),this.options.openOnClick===!0&&e.push(R8({type:this.type,editor:this.editor,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&e.push(P8({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),e}}),zx=pv;var tl=(e,t)=>{if(e==="slot")return 0;if(e instanceof Function)return e(t);let o=t??{},{children:i}=o,n=Ai(o,["children"]);if(e==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[e,n,i]};var D8=/^\s*>\s$/,Wx=ut.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:e}){return tl("blockquote",z(b({},Le(this.options.HTMLAttributes,e)),{children:tl("slot",{})}))},parseMarkdown:(e,t)=>t.createNode("blockquote",void 0,t.parseChildren(e.tokens||[])),renderMarkdown:(e,t)=>{if(!e.content)return"";let i=">",n=[];return e.content.forEach(o=>{let a=t.renderChildren([o]).split(`
`).map(l=>l.trim()===""?i:`${i} ${l}`);n.push(a.join(`
`))}),n.join(`
${i}
`)},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[so({find:D8,type:this.type})]}});var M8=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,k8=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,T8=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,F8=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,Ux=Qi.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>e.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return tl("strong",z(b({},Le(this.options.HTMLAttributes,e)),{children:tl("slot",{})}))},markdownTokenName:"strong",parseMarkdown:(e,t)=>t.applyMark("bold",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`**${t.renderChildren(e)}**`,addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[ro({find:M8,type:this.type}),ro({find:T8,type:this.type})]},addPasteRules(){return[gn({find:k8,type:this.type}),gn({find:F8,type:this.type})]}});var I8=/(^|[^`])`([^`]+)`(?!`)$/,A8=/(^|[^`])`([^`]+)`(?!`)/g,qx=Qi.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:e}){return["code",Le(this.options.HTMLAttributes,e),0]},markdownTokenName:"codespan",parseMarkdown:(e,t)=>t.applyMark("code",[{type:"text",text:e.text||""}]),renderMarkdown:(e,t)=>e.content?`\`${t.renderChildren(e.content)}\``:"",addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[ro({find:I8,type:this.type})]},addPasteRules(){return[gn({find:A8,type:this.type})]}});var gv=4,L8=/^```([a-z]+)?[\s\n]$/,O8=/^~~~([a-z]+)?[\s\n]$/,$x=ut.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:gv,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;let{languageClassPrefix:i}=this.options;if(!i)return null;let r=[...((t=e.firstElementChild)==null?void 0:t.classList)||[]].filter(s=>s.startsWith(i)).map(s=>s.replace(i,""))[0];return r||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:e,HTMLAttributes:t}){return["pre",Le(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(e,t)=>{var i;return((i=e.raw)==null?void 0:i.startsWith("```"))===!1&&e.codeBlockStyle!=="indented"?[]:t.createNode("codeBlock",{language:e.lang||null},e.text?[t.createTextNode(e.text)]:[])},renderMarkdown:(e,t)=>{var i;let n="",o=((i=e.attrs)==null?void 0:i.language)||"";return e.content?n=[`\`\`\`${o}`,t.renderChildren(e.content),"```"].join(`
`):n=`\`\`\`${o}

\`\`\``,n},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{let{empty:e,$anchor:t}=this.editor.state.selection,i=t.pos===1;return!e||t.parent.type.name!==this.name?!1:i||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:e})=>{var t;if(!this.options.enableTabIndentation)return!1;let i=(t=this.options.tabSize)!=null?t:gv,{state:n}=e,{selection:o}=n,{$from:r,empty:s}=o;if(r.parent.type!==this.type)return!1;let a=" ".repeat(i);return s?e.commands.insertContent(a):e.commands.command(({tr:l})=>{let{from:c,to:d}=o,p=n.doc.textBetween(c,d,`
`,`
`).split(`
`).map(g=>a+g).join(`
`);return l.replaceWith(c,d,n.schema.text(p)),!0})},"Shift-Tab":({editor:e})=>{var t;if(!this.options.enableTabIndentation)return!1;let i=(t=this.options.tabSize)!=null?t:gv,{state:n}=e,{selection:o}=n,{$from:r,empty:s}=o;return r.parent.type!==this.type?!1:s?e.commands.command(({tr:a})=>{var l;let{pos:c}=r,d=r.start(),u=r.end(),p=n.doc.textBetween(d,u,`
`,`
`).split(`
`),g=0,f=0,m=c-d;for(let R=0;R<p.length;R+=1){if(f+p[R].length>=m){g=R;break}f+=p[R].length+1}let C=((l=p[g].match(/^ */))==null?void 0:l[0])||"",w=Math.min(C.length,i);if(w===0)return!0;let y=d;for(let R=0;R<g;R+=1)y+=p[R].length+1;return a.delete(y,y+w),c-y<=w&&a.setSelection(Se.create(a.doc,y)),!0}):e.commands.command(({tr:a})=>{let{from:l,to:c}=o,h=n.doc.textBetween(l,c,`
`,`
`).split(`
`).map(p=>{var g;let f=((g=p.match(/^ */))==null?void 0:g[0])||"",m=Math.min(f.length,i);return p.slice(m)}).join(`
`);return a.replaceWith(l,c,n.schema.text(h)),!0})},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;let{state:t}=e,{selection:i}=t,{$from:n,empty:o}=i;if(!o||n.parent.type!==this.type)return!1;let r=n.parentOffset===n.parent.nodeSize-2,s=n.parent.textContent.endsWith(`

`);return!r||!s?!1:e.chain().command(({tr:a})=>(a.delete(n.pos-2,n.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;let{state:t}=e,{selection:i,doc:n}=t,{$from:o,empty:r}=i;if(!r||o.parent.type!==this.type||!(o.parentOffset===o.parent.nodeSize-2))return!1;let a=o.after();return a===void 0?!1:n.nodeAt(a)?e.commands.command(({tr:c})=>(c.setSelection(Re.near(n.resolve(a))),!0)):e.commands.exitCode()}}},addInputRules(){return[Lc({find:L8,type:this.type,getAttributes:e=>({language:e[1]})}),Lc({find:O8,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new Pe({key:new Fe("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;let i=t.clipboardData.getData("text/plain"),n=t.clipboardData.getData("vscode-editor-data"),o=n?JSON.parse(n):void 0,r=o?.mode;if(!i||!r)return!1;let{tr:s,schema:a}=e.state,l=a.text(i.replace(/\r\n?/g,`
`));return s.replaceSelectionWith(this.type.create({language:r},l)),s.selection.$from.parent.type!==this.type&&s.setSelection(Se.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),e.dispatch(s),!0}}})]}});var jx=ut.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`

`):""});var Kx=ut.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:e}){return["br",Le(this.options.HTMLAttributes,e)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:i,editor:n})=>e.first([()=>e.exitCode(),()=>e.command(()=>{let{selection:o,storedMarks:r}=i;if(o.$from.parent.type.spec.isolating)return!1;let{keepMarks:s}=this.options,{splittableMarks:a}=n.extensionManager,l=r||o.$to.parentOffset&&o.$from.marks();return t().insertContent({type:this.name}).command(({tr:c,dispatch:d})=>{if(d&&l&&s){let u=l.filter(h=>a.includes(h.type.name));c.ensureMarks(u)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}});var Yx=ut.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,Le(this.options.HTMLAttributes,t),0]},parseMarkdown:(e,t)=>t.createNode("heading",{level:e.depth||1},t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>{var i;let n=(i=e.attrs)!=null&&i.level?parseInt(e.attrs.level,10):1,o="#".repeat(n);return e.content?`${o} ${t.renderChildren(e.content)}`:""},addCommands(){return{setHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.setNode(this.name,e):!1,toggleHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.toggleNode(this.name,"paragraph",e):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>z(b({},e),{[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>Lc({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}});var Xx=ut.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:e}){return["hr",Le(this.options.HTMLAttributes,e)]},markdownTokenName:"hr",parseMarkdown:(e,t)=>t.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{if(!_x(t,t.schema.nodes[this.name]))return!1;let{selection:i}=t,{$to:n}=i,o=e();return mh(i)?o.insertContentAt(n.pos,{type:this.name}):o.insertContent({type:this.name}),o.command(({state:r,tr:s,dispatch:a})=>{if(a){let{$to:l}=s.selection,c=l.end();if(l.nodeAfter)l.nodeAfter.isTextblock?s.setSelection(Se.create(s.doc,l.pos+1)):l.nodeAfter.isBlock?s.setSelection(pe.create(s.doc,l.pos)):s.setSelection(Se.create(s.doc,l.pos));else{let d=r.schema.nodes[this.options.nextNodeType]||l.parent.type.contentMatch.defaultType,u=d?.create();u&&(s.insert(c,u),s.setSelection(Se.create(s.doc,c+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[Ex({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}});var N8=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,B8=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,H8=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,V8=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,Jx=Qi.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>e.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",Le(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(e,t)=>t.applyMark("italic",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`*${t.renderChildren(e)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[ro({find:N8,type:this.type}),ro({find:H8,type:this.type})]},addPasteRules(){return[gn({find:B8,type:this.type}),gn({find:V8,type:this.type})]}});var G8=Object.defineProperty,z8=(e,t)=>{for(var i in t)G8(e,i,{get:t[i],enumerable:!0})},W8="listItem",Qx="textStyle",Zx=/^\s*([-+*])\s$/,vv=ut.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:e}){return["ul",Le(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:(e,t)=>e.type!=="list"||e.ordered?[]:{type:"bulletList",content:e.items?t.parseChildren(e.items):[]},renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(W8,this.editor.getAttributes(Qx)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=so({find:Zx,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=so({find:Zx,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Qx),editor:this.editor})),[e]}}),Cv=ut.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",Le(this.options.HTMLAttributes,e),0]},markdownTokenName:"list_item",parseMarkdown:(e,t)=>{if(e.type!=="list_item")return[];let i=[];if(e.tokens&&e.tokens.length>0)if(e.tokens.some(o=>o.type==="paragraph"))i=t.parseChildren(e.tokens);else{let o=e.tokens[0];if(o&&o.type==="text"&&o.tokens&&o.tokens.length>0){if(i=[{type:"paragraph",content:t.parseInline(o.tokens)}],e.tokens.length>1){let s=e.tokens.slice(1),a=t.parseChildren(s);i.push(...a)}}else i=t.parseChildren(e.tokens)}return i.length===0&&(i=[{type:"paragraph",content:[]}]),{type:"listItem",content:i}},renderMarkdown:(e,t,i)=>Oc(e,t,n=>n.parentType==="bulletList"?"- ":n.parentType==="orderedList"?`${n.index+1}. `:"- ",i),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),U8={};z8(U8,{findListItemPos:()=>jc,getNextListDepth:()=>wv,handleBackspace:()=>fv,handleDelete:()=>mv,hasListBefore:()=>nE,hasListItemAfter:()=>q8,hasListItemBefore:()=>oE,listItemHasSubList:()=>rE,nextListIsDeeper:()=>sE,nextListIsHigher:()=>aE});var jc=(e,t)=>{let{$from:i}=t.selection,n=Et(e,t.schema),o=null,r=i.depth,s=i.pos,a=null;for(;r>0&&a===null;)o=i.node(r),o.type===n?a=r:(r-=1,s-=1);return a===null?null:{$pos:t.doc.resolve(s),depth:a}},wv=(e,t)=>{let i=jc(e,t);if(!i)return!1;let[,n]=sx(t,e,i.$pos.pos+4);return n},nE=(e,t,i)=>{let{$anchor:n}=e.selection,o=Math.max(0,n.pos-2),r=e.doc.resolve(o).node();return!(!r||!i.includes(r.type.name))},oE=(e,t)=>{var i;let{$anchor:n}=t.selection,o=t.doc.resolve(n.pos-2);return!(o.index()===0||((i=o.nodeBefore)==null?void 0:i.type.name)!==e)},rE=(e,t,i)=>{if(!i)return!1;let n=Et(e,t.schema),o=!1;return i.descendants(r=>{r.type===n&&(o=!0)}),o},fv=(e,t,i)=>{if(e.commands.undoInputRule())return!0;if(e.state.selection.from!==e.state.selection.to)return!1;if(!oo(e.state,t)&&nE(e.state,t,i)){let{$anchor:a}=e.state.selection,l=e.state.doc.resolve(a.before()-1),c=[];l.node().descendants((h,p)=>{h.type.name===t&&c.push({node:h,pos:p})});let d=c.at(-1);if(!d)return!1;let u=e.state.doc.resolve(l.start()+d.pos+1);return e.chain().cut({from:a.start()-1,to:a.end()+1},u.end()).joinForward().run()}if(!oo(e.state,t)||!lx(e.state))return!1;let n=jc(t,e.state);if(!n)return!1;let r=e.state.doc.resolve(n.$pos.pos-2).node(n.depth),s=rE(t,e.state,r);return oE(t,e.state)&&!s?e.commands.joinItemBackward():e.chain().liftListItem(t).run()},sE=(e,t)=>{let i=wv(e,t),n=jc(e,t);return!n||!i?!1:i>n.depth},aE=(e,t)=>{let i=wv(e,t),n=jc(e,t);return!n||!i?!1:i<n.depth},mv=(e,t)=>{if(!oo(e.state,t)||!ax(e.state,t))return!1;let{selection:i}=e.state,{$from:n,$to:o}=i;return!i.empty&&n.sameParent(o)?!1:sE(t,e.state)?e.chain().focus(e.state.selection.from+4).lift(t).joinBackward().run():aE(t,e.state)?e.chain().joinForward().joinBackward().run():e.commands.joinItemForward()},q8=(e,t)=>{var i;let{$anchor:n}=t.selection,o=t.doc.resolve(n.pos-n.parentOffset-2);return!(o.index()===o.parent.childCount-1||((i=o.nodeAfter)==null?void 0:i.type.name)!==e)},bv=Ue.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:i})=>{e.state.schema.nodes[i]!==void 0&&mv(e,i)&&(t=!0)}),t},"Mod-Delete":({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:i})=>{e.state.schema.nodes[i]!==void 0&&mv(e,i)&&(t=!0)}),t},Backspace:({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:i,wrapperNames:n})=>{e.state.schema.nodes[i]!==void 0&&fv(e,i,n)&&(t=!0)}),t},"Mod-Backspace":({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:i,wrapperNames:n})=>{e.state.schema.nodes[i]!==void 0&&fv(e,i,n)&&(t=!0)}),t}}}}),eE=/^(\s*)(\d+)\.\s+(.*)$/,$8=/^\s/;function j8(e){let t=[],i=0,n=0;for(;i<e.length;){let o=e[i],r=o.match(eE);if(!r)break;let[,s,a,l]=r,c=s.length,d=l,u=i+1,h=[o];for(;u<e.length;){let p=e[u];if(p.match(eE))break;if(p.trim()==="")h.push(p),d+=`
`,u+=1;else if(p.match($8))h.push(p),d+=`
${p.slice(c+2)}`,u+=1;else break}t.push({indent:c,number:parseInt(a,10),content:d.trim(),raw:h.join(`
`)}),n=u,i=u}return[t,n]}function lE(e,t,i){var n;let o=[],r=0;for(;r<e.length;){let s=e[r];if(s.indent===t){let a=s.content.split(`
`),l=((n=a[0])==null?void 0:n.trim())||"",c=[];l&&c.push({type:"paragraph",raw:l,tokens:i.inlineTokens(l)});let d=a.slice(1).join(`
`).trim();if(d){let p=i.blockTokens(d);c.push(...p)}let u=r+1,h=[];for(;u<e.length&&e[u].indent>t;)h.push(e[u]),u+=1;if(h.length>0){let p=Math.min(...h.map(f=>f.indent)),g=lE(h,p,i);c.push({type:"list",ordered:!0,start:h[0].number,items:g,raw:h.map(f=>f.raw).join(`
`)})}o.push({type:"list_item",raw:s.raw,tokens:c}),r=u}else r+=1}return o}function K8(e,t){return e.map(i=>{if(i.type!=="list_item")return t.parseChildren([i])[0];let n=[];return i.tokens&&i.tokens.length>0&&i.tokens.forEach(o=>{if(o.type==="paragraph"||o.type==="list"||o.type==="blockquote"||o.type==="code")n.push(...t.parseChildren([o]));else if(o.type==="text"&&o.tokens){let r=t.parseChildren([o]);n.push({type:"paragraph",content:r})}else{let r=t.parseChildren([o]);r.length>0&&n.push(...r)}}),{type:"listItem",content:n}})}var Y8="listItem",tE="textStyle",iE=/^(\d+)\.\s$/,yv=ut.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:null,parseHTML:e=>e.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:e}){let n=e,{start:t}=n,i=Ai(n,["start"]);return t===1?["ol",Le(this.options.HTMLAttributes,i),0]:["ol",Le(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:(e,t)=>{if(e.type!=="list"||!e.ordered)return[];let i=e.start||1,n=e.items?K8(e.items,t):[];return i!==1?{type:"orderedList",attrs:{start:i},content:n}:{type:"orderedList",content:n}},renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:e=>{let t=e.match(/^(\s*)(\d+)\.\s+/),i=t?.index;return i!==void 0?i:-1},tokenize:(e,t,i)=>{var n;let o=e.split(`
`),[r,s]=j8(o);if(r.length===0)return;let a=lE(r,0,i);return a.length===0?void 0:{type:"list",ordered:!0,start:((n=r[0])==null?void 0:n.number)||1,items:a,raw:o.slice(0,s).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Y8,this.editor.getAttributes(tE)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=so({find:iE,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,i)=>i.childCount+i.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=so({find:iE,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>b({start:+t[1]},this.editor.getAttributes(tE)),joinPredicate:(t,i)=>i.childCount+i.attrs.start===+t[1],editor:this.editor})),[e]}}),X8=/^\s*(\[([( |x])?\])\s$/,J8=ut.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:e=>{let t=e.getAttribute("data-checked");return t===""||t==="true"},renderHTML:e=>({"data-checked":e.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:e,HTMLAttributes:t}){return["li",Le(this.options.HTMLAttributes,t,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:e.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(e,t)=>{let i=[];if(e.tokens&&e.tokens.length>0?i.push(t.createNode("paragraph",{},t.parseInline(e.tokens))):e.text?i.push(t.createNode("paragraph",{},[t.createNode("text",{text:e.text})])):i.push(t.createNode("paragraph",{},[])),e.nestedTokens&&e.nestedTokens.length>0){let n=t.parseChildren(e.nestedTokens);i.push(...n)}return t.createNode("taskItem",{checked:e.checked||!1},i)},renderMarkdown:(e,t)=>{var i;let o=`- [${(i=e.attrs)!=null&&i.checked?"x":" "}] `;return Oc(e,t,o)},addKeyboardShortcuts(){let e={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?z(b({},e),{Tab:()=>this.editor.commands.sinkListItem(this.name)}):e},addNodeView(){return({node:e,HTMLAttributes:t,getPos:i,editor:n})=>{let o=document.createElement("li"),r=document.createElement("label"),s=document.createElement("span"),a=document.createElement("input"),l=document.createElement("div"),c=d=>{var u,h;a.ariaLabel=((h=(u=this.options.a11y)==null?void 0:u.checkboxLabel)==null?void 0:h.call(u,d,a.checked))||`Task item checkbox for ${d.textContent||"empty task item"}`};return c(e),r.contentEditable="false",a.type="checkbox",a.addEventListener("mousedown",d=>d.preventDefault()),a.addEventListener("change",d=>{if(!n.isEditable&&!this.options.onReadOnlyChecked){a.checked=!a.checked;return}let{checked:u}=d.target;n.isEditable&&typeof i=="function"&&n.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:h})=>{let p=i();if(typeof p!="number")return!1;let g=h.doc.nodeAt(p);return h.setNodeMarkup(p,void 0,z(b({},g?.attrs),{checked:u})),!0}).run(),!n.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(e,u)||(a.checked=!a.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([d,u])=>{o.setAttribute(d,u)}),o.dataset.checked=e.attrs.checked,a.checked=e.attrs.checked,r.append(a,s),o.append(r,l),Object.entries(t).forEach(([d,u])=>{o.setAttribute(d,u)}),{dom:o,contentDOM:l,update:d=>d.type!==this.type?!1:(o.dataset.checked=d.attrs.checked,a.checked=d.attrs.checked,c(d),!0)}}},addInputRules(){return[so({find:X8,type:this.type,getAttributes:e=>({checked:e[e.length-1]==="x"})})]}}),Q8=ut.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:e}){return["ul",Le(this.options.HTMLAttributes,e,{"data-type":this.name}),0]},parseMarkdown:(e,t)=>t.createNode("taskList",{},t.parseChildren(e.items||[])),renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(e){var t;let i=(t=e.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:t.index;return i!==void 0?i:-1},tokenize(e,t,i){let n=r=>{let s=Ch(r,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:a=>({indentLevel:a[1].length,mainContent:a[4],checked:a[3].toLowerCase()==="x"}),createToken:(a,l)=>({type:"taskItem",raw:"",mainContent:a.mainContent,indentLevel:a.indentLevel,checked:a.checked,text:a.mainContent,tokens:i.inlineTokens(a.mainContent),nestedTokens:l}),customNestedParser:n},i);return s?[{type:"taskList",raw:s.raw,items:s.items}]:i.blockTokens(r)},o=Ch(e,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:r=>({indentLevel:r[1].length,mainContent:r[4],checked:r[3].toLowerCase()==="x"}),createToken:(r,s)=>({type:"taskItem",raw:"",mainContent:r.mainContent,indentLevel:r.indentLevel,checked:r.checked,text:r.mainContent,tokens:i.inlineTokens(r.mainContent),nestedTokens:s}),customNestedParser:n},i);if(o)return{type:"taskList",raw:o.raw,items:o.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:e})=>e.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}}),epe=Ue.create({name:"listKit",addExtensions(){let e=[];return this.options.bulletList!==!1&&e.push(vv.configure(this.options.bulletList)),this.options.listItem!==!1&&e.push(Cv.configure(this.options.listItem)),this.options.listKeymap!==!1&&e.push(bv.configure(this.options.listKeymap)),this.options.orderedList!==!1&&e.push(yv.configure(this.options.orderedList)),this.options.taskItem!==!1&&e.push(J8.configure(this.options.taskItem)),this.options.taskList!==!1&&e.push(Q8.configure(this.options.taskList)),e}});var cE=ut.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:e}){return["p",Le(this.options.HTMLAttributes,e),0]},parseMarkdown:(e,t)=>{let i=e.tokens||[];return i.length===1&&i[0].type==="image"?t.parseChildren([i[0]]):t.createNode("paragraph",void 0,t.parseInline(i))},renderMarkdown:(e,t)=>!e||!Array.isArray(e.content)?"":t.renderChildren(e.content),addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}});var Z8=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,e7=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,dE=Qi.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["s",Le(this.options.HTMLAttributes,e),0]},markdownTokenName:"del",parseMarkdown:(e,t)=>t.applyMark("strike",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`~~${t.renderChildren(e)}~~`,addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[ro({find:Z8,type:this.type})]},addPasteRules(){return[gn({find:e7,type:this.type})]}});var uE=ut.create({name:"text",group:"inline",parseMarkdown:e=>({type:"text",text:e.text||""}),renderMarkdown:e=>e.text||""});var hE=Qi.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["u",Le(this.options.HTMLAttributes,e),0]},parseMarkdown(e,t){return t.applyMark(this.name||"underline",t.parseInline(e.tokens||[]))},renderMarkdown(e,t){return`++${t.renderChildren(e)}++`},markdownTokenizer:{name:"underline",level:"inline",start(e){return e.indexOf("++")},tokenize(e,t,i){let o=/^(\+\+)([\s\S]+?)(\+\+)/.exec(e);if(!o)return;let r=o[2].trim();return{type:"underline",raw:o[0],text:r,tokens:i.inlineTokens(r)}}},addCommands(){return{setUnderline:()=>({commands:e})=>e.setMark(this.name),toggleUnderline:()=>({commands:e})=>e.toggleMark(this.name),unsetUnderline:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});function pE(e={}){return new Pe({view(t){return new Sv(t,e)}})}var Sv=class{constructor(t,i){var n;this.editorView=t,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(n=i.width)!==null&&n!==void 0?n:1,this.color=i.color===!1?void 0:i.color||"black",this.class=i.class,this.handlers=["dragover","dragend","drop","dragleave"].map(o=>{let r=s=>{this[o](s)};return t.dom.addEventListener(o,r),{name:o,handler:r}})}destroy(){this.handlers.forEach(({name:t,handler:i})=>this.editorView.dom.removeEventListener(t,i))}update(t,i){this.cursorPos!=null&&i.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(t){t!=this.cursorPos&&(this.cursorPos=t,t==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let t=this.editorView.state.doc.resolve(this.cursorPos),i=!t.parent.inlineContent,n,o=this.editorView.dom,r=o.getBoundingClientRect(),s=r.width/o.offsetWidth,a=r.height/o.offsetHeight;if(i){let u=t.nodeBefore,h=t.nodeAfter;if(u||h){let p=this.editorView.nodeDOM(this.cursorPos-(u?u.nodeSize:0));if(p){let g=p.getBoundingClientRect(),f=u?g.bottom:g.top;u&&h&&(f=(f+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let m=this.width/2*a;n={left:g.left,right:g.right,top:f-m,bottom:f+m}}}}if(!n){let u=this.editorView.coordsAtPos(this.cursorPos),h=this.width/2*s;n={left:u.left-h,right:u.left+h,top:u.top,bottom:u.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",i),this.element.classList.toggle("prosemirror-dropcursor-inline",!i);let c,d;if(!l||l==document.body&&getComputedStyle(l).position=="static")c=-pageXOffset,d=-pageYOffset;else{let u=l.getBoundingClientRect(),h=u.width/l.offsetWidth,p=u.height/l.offsetHeight;c=u.left-l.scrollLeft*h,d=u.top-l.scrollTop*p}this.element.style.left=(n.left-c)/s+"px",this.element.style.top=(n.top-d)/a+"px",this.element.style.width=(n.right-n.left)/s+"px",this.element.style.height=(n.bottom-n.top)/a+"px"}scheduleRemoval(t){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),t)}dragover(t){if(!this.editorView.editable)return;let i=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),n=i&&i.inside>=0&&this.editorView.state.doc.nodeAt(i.inside),o=n&&n.type.spec.disableDropCursor,r=typeof o=="function"?o(this.editorView,i,t):o;if(i&&!r){let s=i.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=Bu(this.editorView.state.doc,s,this.editorView.dragging.slice);a!=null&&(s=a)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(t){this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)}};var vi=class e extends Re{constructor(t){super(t,t)}map(t,i){let n=t.resolve(i.map(this.head));return e.valid(n)?new e(n):Re.near(n)}content(){return ae.empty}eq(t){return t instanceof e&&t.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(t,i){if(typeof i.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new e(t.resolve(i.pos))}getBookmark(){return new xv(this.anchor)}static valid(t){let i=t.parent;if(i.isTextblock||!t7(t)||!i7(t))return!1;let n=i.type.spec.allowGapCursor;if(n!=null)return n;let o=i.contentMatchAt(t.index()).defaultType;return o&&o.isTextblock}static findGapCursorFrom(t,i,n=!1){e:for(;;){if(!n&&e.valid(t))return t;let o=t.pos,r=null;for(let s=t.depth;;s--){let a=t.node(s);if(i>0?t.indexAfter(s)<a.childCount:t.index(s)>0){r=a.child(i>0?t.indexAfter(s):t.index(s)-1);break}else if(s==0)return null;o+=i;let l=t.doc.resolve(o);if(e.valid(l))return l}for(;;){let s=i>0?r.firstChild:r.lastChild;if(!s){if(r.isAtom&&!r.isText&&!pe.isSelectable(r)){t=t.doc.resolve(o+r.nodeSize*i),n=!1;continue e}break}r=s,o+=i;let a=t.doc.resolve(o);if(e.valid(a))return a}return null}}};vi.prototype.visible=!1;vi.findFrom=vi.findGapCursorFrom;Re.jsonID("gapcursor",vi);var xv=class e{constructor(t){this.pos=t}map(t){return new e(t.map(this.pos))}resolve(t){let i=t.resolve(this.pos);return vi.valid(i)?new vi(i):Re.near(i)}};function gE(e){return e.isAtom||e.spec.isolating||e.spec.createGapCursor}function t7(e){for(let t=e.depth;t>=0;t--){let i=e.index(t),n=e.node(t);if(i==0){if(n.type.spec.isolating)return!0;continue}for(let o=n.child(i-1);;o=o.lastChild){if(o.childCount==0&&!o.inlineContent||gE(o.type))return!0;if(o.inlineContent)return!1}}return!0}function i7(e){for(let t=e.depth;t>=0;t--){let i=e.indexAfter(t),n=e.node(t);if(i==n.childCount){if(n.type.spec.isolating)return!0;continue}for(let o=n.child(i);;o=o.firstChild){if(o.childCount==0&&!o.inlineContent||gE(o.type))return!0;if(o.inlineContent)return!1}}return!0}function fE(){return new Pe({props:{decorations:s7,createSelectionBetween(e,t,i){return t.pos==i.pos&&vi.valid(i)?new vi(i):null},handleClick:o7,handleKeyDown:n7,handleDOMEvents:{beforeinput:r7}}})}var n7=_0({ArrowLeft:Zh("horiz",-1),ArrowRight:Zh("horiz",1),ArrowUp:Zh("vert",-1),ArrowDown:Zh("vert",1)});function Zh(e,t){let i=e=="vert"?t>0?"down":"up":t>0?"right":"left";return function(n,o,r){let s=n.selection,a=t>0?s.$to:s.$from,l=s.empty;if(s instanceof Se){if(!r.endOfTextblock(i)||a.depth==0)return!1;l=!1,a=n.doc.resolve(t>0?a.after():a.before())}let c=vi.findGapCursorFrom(a,t,l);return c?(o&&o(n.tr.setSelection(new vi(c))),!0):!1}}function o7(e,t,i){if(!e||!e.editable)return!1;let n=e.state.doc.resolve(t);if(!vi.valid(n))return!1;let o=e.posAtCoords({left:i.clientX,top:i.clientY});return o&&o.inside>-1&&pe.isSelectable(e.state.doc.nodeAt(o.inside))?!1:(e.dispatch(e.state.tr.setSelection(new vi(n))),!0)}function r7(e,t){if(t.inputType!="insertCompositionText"||!(e.state.selection instanceof vi))return!1;let{$from:i}=e.state.selection,n=i.parent.contentMatchAt(i.index()).findWrapping(e.state.schema.nodes.text);if(!n)return!1;let o=Y.empty;for(let s=n.length-1;s>=0;s--)o=Y.from(n[s].createAndFill(null,o));let r=e.state.tr.replace(i.pos,i.pos,new ae(o,0,0));return r.setSelection(Se.near(r.doc.resolve(i.pos+1))),e.dispatch(r),!1}function s7(e){if(!(e.selection instanceof vi))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",Mt.create(e.doc,[mi.widget(e.selection.head,t,{key:"gapcursor"})])}var ep=200,ri=function(){};ri.prototype.append=function(t){return t.length?(t=ri.from(t),!this.length&&t||t.length<ep&&this.leafAppend(t)||this.length<ep&&t.leafPrepend(this)||this.appendInner(t)):this};ri.prototype.prepend=function(t){return t.length?ri.from(t).append(this):this};ri.prototype.appendInner=function(t){return new a7(this,t)};ri.prototype.slice=function(t,i){return t===void 0&&(t=0),i===void 0&&(i=this.length),t>=i?ri.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,i))};ri.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)};ri.prototype.forEach=function(t,i,n){i===void 0&&(i=0),n===void 0&&(n=this.length),i<=n?this.forEachInner(t,i,n,0):this.forEachInvertedInner(t,i,n,0)};ri.prototype.map=function(t,i,n){i===void 0&&(i=0),n===void 0&&(n=this.length);var o=[];return this.forEach(function(r,s){return o.push(t(r,s))},i,n),o};ri.from=function(t){return t instanceof ri?t:t&&t.length?new mE(t):ri.empty};var mE=(function(e){function t(n){e.call(this),this.values=n}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var i={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(o,r){return o==0&&r==this.length?this:new t(this.values.slice(o,r))},t.prototype.getInner=function(o){return this.values[o]},t.prototype.forEachInner=function(o,r,s,a){for(var l=r;l<s;l++)if(o(this.values[l],a+l)===!1)return!1},t.prototype.forEachInvertedInner=function(o,r,s,a){for(var l=r-1;l>=s;l--)if(o(this.values[l],a+l)===!1)return!1},t.prototype.leafAppend=function(o){if(this.length+o.length<=ep)return new t(this.values.concat(o.flatten()))},t.prototype.leafPrepend=function(o){if(this.length+o.length<=ep)return new t(o.flatten().concat(this.values))},i.length.get=function(){return this.values.length},i.depth.get=function(){return 0},Object.defineProperties(t.prototype,i),t})(ri);ri.empty=new mE([]);var a7=(function(e){function t(i,n){e.call(this),this.left=i,this.right=n,this.length=i.length+n.length,this.depth=Math.max(i.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(n){return n<this.left.length?this.left.get(n):this.right.get(n-this.left.length)},t.prototype.forEachInner=function(n,o,r,s){var a=this.left.length;if(o<a&&this.left.forEachInner(n,o,Math.min(r,a),s)===!1||r>a&&this.right.forEachInner(n,Math.max(o-a,0),Math.min(this.length,r)-a,s+a)===!1)return!1},t.prototype.forEachInvertedInner=function(n,o,r,s){var a=this.left.length;if(o>a&&this.right.forEachInvertedInner(n,o-a,Math.max(r,a)-a,s+a)===!1||r<a&&this.left.forEachInvertedInner(n,Math.min(o,a),r,s)===!1)return!1},t.prototype.sliceInner=function(n,o){if(n==0&&o==this.length)return this;var r=this.left.length;return o<=r?this.left.slice(n,o):n>=r?this.right.slice(n-r,o-r):this.left.slice(n,r).append(this.right.slice(0,o-r))},t.prototype.leafAppend=function(n){var o=this.right.leafAppend(n);if(o)return new t(this.left,o)},t.prototype.leafPrepend=function(n){var o=this.left.leafPrepend(n);if(o)return new t(o,this.right)},t.prototype.appendInner=function(n){return this.left.depth>=Math.max(this.right.depth,n.depth)+1?new t(this.left,new t(this.right,n)):new t(this,n)},t})(ri),Ev=ri;var l7=500,Ys=class e{constructor(t,i){this.items=t,this.eventCount=i}popEvent(t,i){if(this.eventCount==0)return null;let n=this.items.length;for(;;n--)if(this.items.get(n-1).selection){--n;break}let o,r;i&&(o=this.remapping(n,this.items.length),r=o.maps.length);let s=t.tr,a,l,c=[],d=[];return this.items.forEach((u,h)=>{if(!u.step){o||(o=this.remapping(n,h+1),r=o.maps.length),r--,d.push(u);return}if(o){d.push(new co(u.map));let p=u.step.map(o.slice(r)),g;p&&s.maybeStep(p).doc&&(g=s.mapping.maps[s.mapping.maps.length-1],c.push(new co(g,void 0,void 0,c.length+d.length))),r--,g&&o.appendMap(g,r)}else s.maybeStep(u.step);if(u.selection)return a=o?u.selection.map(o.slice(r)):u.selection,l=new e(this.items.slice(0,n).append(d.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:s,selection:a}}addTransform(t,i,n,o){let r=[],s=this.eventCount,a=this.items,l=!o&&a.length?a.get(a.length-1):null;for(let d=0;d<t.steps.length;d++){let u=t.steps[d].invert(t.docs[d]),h=new co(t.mapping.maps[d],u,i),p;(p=l&&l.merge(h))&&(h=p,d?r.pop():a=a.slice(0,a.length-1)),r.push(h),i&&(s++,i=void 0),o||(l=h)}let c=s-n.depth;return c>d7&&(a=c7(a,c),s-=c),new e(a.append(r),s)}remapping(t,i){let n=new wc;return this.items.forEach((o,r)=>{let s=o.mirrorOffset!=null&&r-o.mirrorOffset>=t?n.maps.length-o.mirrorOffset:void 0;n.appendMap(o.map,s)},t,i),n}addMaps(t){return this.eventCount==0?this:new e(this.items.append(t.map(i=>new co(i))),this.eventCount)}rebased(t,i){if(!this.eventCount)return this;let n=[],o=Math.max(0,this.items.length-i),r=t.mapping,s=t.steps.length,a=this.eventCount;this.items.forEach(h=>{h.selection&&a--},o);let l=i;this.items.forEach(h=>{let p=r.getMirror(--l);if(p==null)return;s=Math.min(s,p);let g=r.maps[p];if(h.step){let f=t.steps[p].invert(t.docs[p]),m=h.selection&&h.selection.map(r.slice(l+1,p));m&&a++,n.push(new co(g,f,m))}else n.push(new co(g))},o);let c=[];for(let h=i;h<s;h++)c.push(new co(r.maps[h]));let d=this.items.slice(0,o).append(c).append(n),u=new e(d,a);return u.emptyItemCount()>l7&&(u=u.compress(this.items.length-n.length)),u}emptyItemCount(){let t=0;return this.items.forEach(i=>{i.step||t++}),t}compress(t=this.items.length){let i=this.remapping(0,t),n=i.maps.length,o=[],r=0;return this.items.forEach((s,a)=>{if(a>=t)o.push(s),s.selection&&r++;else if(s.step){let l=s.step.map(i.slice(n)),c=l&&l.getMap();if(n--,c&&i.appendMap(c,n),l){let d=s.selection&&s.selection.map(i.slice(n));d&&r++;let u=new co(c.invert(),l,d),h,p=o.length-1;(h=o.length&&o[p].merge(u))?o[p]=h:o.push(u)}}else s.map&&n--},this.items.length,0),new e(Ev.from(o.reverse()),r)}};Ys.empty=new Ys(Ev.empty,0);function c7(e,t){let i;return e.forEach((n,o)=>{if(n.selection&&t--==0)return i=o,!1}),e.slice(i)}var co=class e{constructor(t,i,n,o){this.map=t,this.step=i,this.selection=n,this.mirrorOffset=o}merge(t){if(this.step&&t.step&&!t.selection){let i=t.step.merge(this.step);if(i)return new e(i.getMap().invert(),i,this.selection)}}},uo=class{constructor(t,i,n,o,r){this.done=t,this.undone=i,this.prevRanges=n,this.prevTime=o,this.prevComposition=r}},d7=20;function u7(e,t,i,n){let o=i.getMeta(Ks),r;if(o)return o.historyState;i.getMeta(g7)&&(e=new uo(e.done,e.undone,null,0,-1));let s=i.getMeta("appendedTransaction");if(i.steps.length==0)return e;if(s&&s.getMeta(Ks))return s.getMeta(Ks).redo?new uo(e.done.addTransform(i,void 0,n,tp(t)),e.undone,vE(i.mapping.maps),e.prevTime,e.prevComposition):new uo(e.done,e.undone.addTransform(i,void 0,n,tp(t)),null,e.prevTime,e.prevComposition);if(i.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let a=i.getMeta("composition"),l=e.prevTime==0||!s&&e.prevComposition!=a&&(e.prevTime<(i.time||0)-n.newGroupDelay||!h7(i,e.prevRanges)),c=s?_v(e.prevRanges,i.mapping):vE(i.mapping.maps);return new uo(e.done.addTransform(i,l?t.selection.getBookmark():void 0,n,tp(t)),Ys.empty,c,i.time,a??e.prevComposition)}else return(r=i.getMeta("rebased"))?new uo(e.done.rebased(i,r),e.undone.rebased(i,r),_v(e.prevRanges,i.mapping),e.prevTime,e.prevComposition):new uo(e.done.addMaps(i.mapping.maps),e.undone.addMaps(i.mapping.maps),_v(e.prevRanges,i.mapping),e.prevTime,e.prevComposition)}function h7(e,t){if(!t)return!1;if(!e.docChanged)return!0;let i=!1;return e.mapping.maps[0].forEach((n,o)=>{for(let r=0;r<t.length;r+=2)n<=t[r+1]&&o>=t[r]&&(i=!0)}),i}function vE(e){let t=[];for(let i=e.length-1;i>=0&&t.length==0;i--)e[i].forEach((n,o,r,s)=>t.push(r,s));return t}function _v(e,t){if(!e)return null;let i=[];for(let n=0;n<e.length;n+=2){let o=t.map(e[n],1),r=t.map(e[n+1],-1);o<=r&&i.push(o,r)}return i}function p7(e,t,i){let n=tp(t),o=Ks.get(t).spec.config,r=(i?e.undone:e.done).popEvent(t,n);if(!r)return null;let s=r.selection.resolve(r.transform.doc),a=(i?e.done:e.undone).addTransform(r.transform,t.selection.getBookmark(),o,n),l=new uo(i?a:r.remaining,i?r.remaining:a,null,0,-1);return r.transform.setSelection(s).setMeta(Ks,{redo:i,historyState:l})}var Rv=!1,CE=null;function tp(e){let t=e.plugins;if(CE!=t){Rv=!1,CE=t;for(let i=0;i<t.length;i++)if(t[i].spec.historyPreserveItems){Rv=!0;break}}return Rv}var Ks=new Fe("history"),g7=new Fe("closeHistory");function wE(e={}){return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new Pe({key:Ks,state:{init(){return new uo(Ys.empty,Ys.empty,null,0,-1)},apply(t,i,n){return u7(i,n,t,e)}},config:e,props:{handleDOMEvents:{beforeinput(t,i){let n=i.inputType,o=n=="historyUndo"?Pv:n=="historyRedo"?Dv:null;return!o||!t.editable?!1:(i.preventDefault(),o(t.state,t.dispatch))}}}})}function ip(e,t){return(i,n)=>{let o=Ks.getState(i);if(!o||(e?o.undone:o.done).eventCount==0)return!1;if(n){let r=p7(o,i,e);r&&n(t?r.scrollIntoView():r)}return!0}}var Pv=ip(!1,!0),Dv=ip(!0,!0),Ppe=ip(!1,!1),Dpe=ip(!0,!1);var Ape=Ue.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:e=>e.length,wordCounter:e=>e.split(" ").filter(t=>t!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=e=>{let t=e?.node||this.editor.state.doc;if((e?.mode||this.options.mode)==="textSize"){let n=t.textBetween(0,t.content.size,void 0," ");return this.options.textCounter(n)}return t.nodeSize},this.storage.words=e=>{let t=e?.node||this.editor.state.doc,i=t.textBetween(0,t.content.size," "," ");return this.options.wordCounter(i)}},addProseMirrorPlugins(){let e=!1;return[new Pe({key:new Fe("characterCount"),appendTransaction:(t,i,n)=>{if(e)return;let o=this.options.limit;if(o==null||o===0){e=!0;return}let r=this.storage.characters({node:n.doc});if(r>o){let s=r-o,a=0,l=s;console.warn(`[CharacterCount] Initial content exceeded limit of ${o} characters. Content was automatically trimmed.`);let c=n.tr.deleteRange(a,l);return e=!0,c}e=!0},filterTransaction:(t,i)=>{let n=this.options.limit;if(!t.docChanged||n===0||n===null||n===void 0)return!0;let o=this.storage.characters({node:i.doc}),r=this.storage.characters({node:t.doc});if(r<=n||o>n&&r>n&&r<=o)return!0;if(o>n&&r>n&&r>o||!t.getMeta("paste"))return!1;let a=t.selection.$head.pos,l=r-n,c=a-l,d=a;return t.deleteRange(c,d),!(this.storage.characters({node:t.doc})>n)}})]}}),yE=Ue.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[pE(this.options)]}}),Vpe=Ue.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new Pe({key:new Fe("focus"),props:{decorations:({doc:e,selection:t})=>{let{isEditable:i,isFocused:n}=this.editor,{anchor:o}=t,r=[];if(!i||!n)return Mt.create(e,[]);let s=0;this.options.mode==="deepest"&&e.descendants((l,c)=>{if(l.isText)return;if(!(o>=c&&o<=c+l.nodeSize-1))return!1;s+=1});let a=0;return e.descendants((l,c)=>{if(l.isText||!(o>=c&&o<=c+l.nodeSize-1))return!1;if(a+=1,this.options.mode==="deepest"&&s-a>0||this.options.mode==="shallowest"&&a>1)return this.options.mode==="deepest";r.push(mi.node(c,c+l.nodeSize,{class:this.options.className}))}),Mt.create(e,r)}}})]}}),SE=Ue.create({name:"gapCursor",addProseMirrorPlugins(){return[fE()]},extendNodeSchema(e){var t;let i={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:(t=et(be(e,"allowGapCursor",i)))!=null?t:null}}}),$pe=Ue.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something \u2026",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new Pe({key:new Fe("placeholder"),props:{decorations:({doc:e,selection:t})=>{let i=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:n}=t,o=[];if(!i)return null;let r=this.editor.isEmpty;return e.descendants((s,a)=>{let l=n>=a&&n<=a+s.nodeSize,c=!s.isLeaf&&Ac(s);if((l||!this.options.showOnlyCurrent)&&c){let d=[this.options.emptyNodeClass];r&&d.push(this.options.emptyEditorClass);let u=mi.node(a,a+s.nodeSize,{class:d.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:s,pos:a,hasAnchor:l}):this.options.placeholder});o.push(u)}return this.options.includeChildren}),Mt.create(e,o)}}})]}}),Xpe=Ue.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){let{editor:e,options:t}=this;return[new Pe({key:new Fe("selection"),props:{decorations(i){return i.selection.empty||e.isFocused||!e.isEditable||mh(i.selection)||e.view.dragging?null:Mt.create(i.doc,[mi.inline(i.selection.from,i.selection.to,{class:t.className})])}}})]}});function bE({types:e,node:t}){return t&&Array.isArray(e)&&e.includes(t.type)||t?.type===e}var xE=Ue.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var e;let t=new Fe(this.name),i=((e=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:e.name)||this.options.node||"paragraph",n=Object.entries(this.editor.schema.nodes).map(([,o])=>o).filter(o=>(this.options.notAfter||[]).concat(i).includes(o.name));return[new Pe({key:t,appendTransaction:(o,r,s)=>{let{doc:a,tr:l,schema:c}=s,d=t.getState(s),u=a.content.size,h=c.nodes[i];if(d)return l.insert(u,h.create())},state:{init:(o,r)=>{let s=r.tr.doc.lastChild;return!bE({node:s,types:n})},apply:(o,r)=>{if(!o.docChanged||o.getMeta("__uniqueIDTransaction"))return r;let s=o.doc.lastChild;return!bE({node:s,types:n})}}})]}}),EE=Ue.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:e,dispatch:t})=>Pv(e,t),redo:()=>({state:e,dispatch:t})=>Dv(e,t)}},addProseMirrorPlugins(){return[wE(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-\u044F":()=>this.editor.commands.undo(),"Shift-Mod-\u044F":()=>this.editor.commands.redo()}}});var f7=Ue.create({name:"starterKit",addExtensions(){var e,t,i,n;let o=[];return this.options.bold!==!1&&o.push(Ux.configure(this.options.bold)),this.options.blockquote!==!1&&o.push(Wx.configure(this.options.blockquote)),this.options.bulletList!==!1&&o.push(vv.configure(this.options.bulletList)),this.options.code!==!1&&o.push(qx.configure(this.options.code)),this.options.codeBlock!==!1&&o.push($x.configure(this.options.codeBlock)),this.options.document!==!1&&o.push(jx.configure(this.options.document)),this.options.dropcursor!==!1&&o.push(yE.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&o.push(SE.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&o.push(Kx.configure(this.options.hardBreak)),this.options.heading!==!1&&o.push(Yx.configure(this.options.heading)),this.options.undoRedo!==!1&&o.push(EE.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&o.push(Xx.configure(this.options.horizontalRule)),this.options.italic!==!1&&o.push(Jx.configure(this.options.italic)),this.options.listItem!==!1&&o.push(Cv.configure(this.options.listItem)),this.options.listKeymap!==!1&&o.push(bv.configure((e=this.options)==null?void 0:e.listKeymap)),this.options.link!==!1&&o.push(pv.configure((t=this.options)==null?void 0:t.link)),this.options.orderedList!==!1&&o.push(yv.configure(this.options.orderedList)),this.options.paragraph!==!1&&o.push(cE.configure(this.options.paragraph)),this.options.strike!==!1&&o.push(dE.configure(this.options.strike)),this.options.text!==!1&&o.push(uE.configure(this.options.text)),this.options.underline!==!1&&o.push(hE.configure((i=this.options)==null?void 0:i.underline)),this.options.trailingNode!==!1&&o.push(xE.configure((n=this.options)==null?void 0:n.trailingNode)),o}}),_E=f7;var RE=(()=>{class e{elRef=k(Je);renderer=k(Fo);changeDetectorRef=k(Tn);editor=M.required();outputFormat=M("html");onChange=()=>{};onTouched=()=>{};writeValue(i){this.editor().chain().setContent(i,{emitUpdate:!1}).run()}registerOnChange(i){this.onChange=i}registerOnTouched(i){this.onTouched=i}setDisabledState(i){this.editor().setEditable(!i),this.renderer.setProperty(this.elRef.nativeElement,"disabled",i)}handleChange=({editor:i,transaction:n})=>{if(n.docChanged){if(this.changeDetectorRef.markForCheck(),this.outputFormat()==="html"){this.onChange(i.getHTML());return}this.onChange(i.getJSON())}};ngOnInit(){let i=this.editor(),{innerHTML:n}=this.elRef.nativeElement;this.elRef.nativeElement.innerHTML="",this.elRef.nativeElement.append(...Array.from(i.options.element?.childNodes||[])),i.setOptions({element:this.elRef.nativeElement}),n&&i.chain().setContent(n,{emitUpdate:!1}).run(),i.on("blur",()=>{this.onTouched()}),i.on("update",this.handleChange),i.on("selectionUpdate",()=>this.changeDetectorRef.markForCheck())}ngAfterViewInit(){this.changeDetectorRef.detectChanges()}static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["tiptap","editor",""],["","tiptap","","editor",""],["tiptap-editor","editor",""],["","tiptapEditor","","editor",""]],inputs:{editor:[1,"editor"],outputFormat:[1,"outputFormat"]},features:[ue([{provide:Dr,useExisting:Ei(()=>e),multi:!0}])]})}return e})();var np=(()=>{class e{destroyRef=k(To);suppressEmit=!1;initialContent=M("");minHeight=M("300px");contentChange=oe();editor=new xx({extensions:[_E.configure({heading:{levels:[1,2,3]}}),zx.configure({openOnClick:!1,HTMLAttributes:{class:"text-blue-600 underline hover:text-blue-800"}})],editorProps:{attributes:{class:"prose prose-sm sm:prose lg:prose-lg xl:prose-xl focus:outline-none max-w-none p-4"}},content:this.initialContent()||"",onUpdate:({editor:i})=>{this.suppressEmit||this.contentChange.emit(i.getHTML())}});constructor(){_e(()=>{let i=this.initialContent()||"",n=this.editor.getHTML();i!==n&&(this.suppressEmit=!0,this.editor.commands.setContent(i,{emitUpdate:!1}),this.suppressEmit=!1)}),this.destroyRef.onDestroy(()=>{this.editor?.destroy()})}isBold(){return this.editor?.isActive("bold")??!1}isItalic(){return this.editor?.isActive("italic")??!1}isStrike(){return this.editor?.isActive("strike")??!1}isCode(){return this.editor?.isActive("code")??!1}isH1(){return this.editor?.isActive("heading",{level:1})??!1}isH2(){return this.editor?.isActive("heading",{level:2})??!1}isBulletList(){return this.editor?.isActive("bulletList")??!1}isOrderedList(){return this.editor?.isActive("orderedList")??!1}isBlockquote(){return this.editor?.isActive("blockquote")??!1}toggleBold(){this.editor?.chain().focus().toggleBold().run()}toggleItalic(){this.editor?.chain().focus().toggleItalic().run()}toggleStrike(){this.editor?.chain().focus().toggleStrike().run()}toggleCode(){this.editor?.chain().focus().toggleCode().run()}toggleH1(){this.editor?.chain().focus().toggleHeading({level:1}).run()}toggleH2(){this.editor?.chain().focus().toggleHeading({level:2}).run()}toggleBulletList(){this.editor?.chain().focus().toggleBulletList().run()}toggleOrderedList(){this.editor?.chain().focus().toggleOrderedList().run()}toggleBlockquote(){this.editor?.chain().focus().toggleBlockquote().run()}setLink(){let i=window.prompt("Enter URL:");i&&this.editor?.chain().focus().setLink({href:i}).run()}undo(){this.editor?.chain().focus().undo().run()}redo(){this.editor?.chain().focus().redo().run()}getHTML(){return this.editor?.getHTML()}getJSON(){return this.editor?.getJSON()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["gh-tiptap-editor"]],inputs:{initialContent:[1,"initialContent"],minHeight:[1,"minHeight"]},outputs:{contentChange:"contentChange"},features:[ue([nt({lucideBold:V1,lucideItalic:Y1,lucideStrikethrough:uy,lucideCode:W1,lucideHeading1:$1,lucideHeading2:j1,lucideList:Q1,lucideListOrdered:J1,lucideQuote:ry,lucideUndo:hy,lucideRedo:sy,lucideLink:X1})])],decls:31,vars:21,consts:[[1,"border","rounded-t-md","p-2","bg-muted/30","flex","flex-wrap","gap-1","items-center"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Bold (Ctrl+B)",3,"click"],["hlm","","name","lucideBold","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Italic (Ctrl+I)",3,"click"],["hlm","","name","lucideItalic","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Strikethrough",3,"click"],["hlm","","name","lucideStrikethrough","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Code",3,"click"],["hlm","","name","lucideCode","size","sm"],["hlmSeparator","","orientation","vertical",1,"h-6","mx-1"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Heading 1",3,"click"],["hlm","","name","lucideHeading1","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Heading 2",3,"click"],["hlm","","name","lucideHeading2","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Bullet List",3,"click"],["hlm","","name","lucideList","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Numbered List",3,"click"],["hlm","","name","lucideListOrdered","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Blockquote",3,"click"],["hlm","","name","lucideQuote","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Add Link",3,"click"],["hlm","","name","lucideLink","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Undo (Ctrl+Z)",3,"click"],["hlm","","name","lucideUndo","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Redo (Ctrl+Shift+Z)",3,"click"],["hlm","","name","lucideRedo","size","sm"],[1,"border","border-t-0","rounded-b-md","bg-background"],[1,"block",3,"editor"]],template:function(n,o){n&1&&(S(0,"div",0)(1,"button",1),V("click",function(){return o.toggleBold()}),H(2,"ng-icon",2),x(),S(3,"button",3),V("click",function(){return o.toggleItalic()}),H(4,"ng-icon",4),x(),S(5,"button",5),V("click",function(){return o.toggleStrike()}),H(6,"ng-icon",6),x(),S(7,"button",7),V("click",function(){return o.toggleCode()}),H(8,"ng-icon",8),x(),H(9,"div",9),S(10,"button",10),V("click",function(){return o.toggleH1()}),H(11,"ng-icon",11),x(),S(12,"button",12),V("click",function(){return o.toggleH2()}),H(13,"ng-icon",13),x(),H(14,"div",9),S(15,"button",14),V("click",function(){return o.toggleBulletList()}),H(16,"ng-icon",15),x(),S(17,"button",16),V("click",function(){return o.toggleOrderedList()}),H(18,"ng-icon",17),x(),H(19,"div",9),S(20,"button",18),V("click",function(){return o.toggleBlockquote()}),H(21,"ng-icon",19),x(),S(22,"button",20),V("click",function(){return o.setLink()}),H(23,"ng-icon",21),x(),H(24,"div",9),S(25,"button",22),V("click",function(){return o.undo()}),H(26,"ng-icon",23),x(),S(27,"button",24),V("click",function(){return o.redo()}),H(28,"ng-icon",25),x()(),S(29,"div",26),H(30,"tiptap-editor",27),x()),n&2&&(E(),dt("bg-accent",o.isBold()),E(2),dt("bg-accent",o.isItalic()),E(2),dt("bg-accent",o.isStrike()),E(2),dt("bg-accent",o.isCode()),E(3),dt("bg-accent",o.isH1()),E(2),dt("bg-accent",o.isH2()),E(3),dt("bg-accent",o.isBulletList()),E(2),dt("bg-accent",o.isOrderedList()),E(3),dt("bg-accent",o.isBlockquote()),E(10),jt("min-height",o.minHeight()),U("editor",o.editor))},dependencies:[Ze,We,ot,Fr,RE],encapsulation:2,changeDetection:0})}return e})();var ra=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setFrameworkOverrides(e){this.frameworkOverrides=e}getListeners(e,t,i){let n=t?this.allAsyncListeners:this.allSyncListeners,o=n.get(e);return!o&&i&&(o=new Set,n.set(e,o)),o}noRegisteredListenersExist(){return this.allSyncListeners.size===0&&this.allAsyncListeners.size===0&&this.globalSyncListeners.size===0&&this.globalAsyncListeners.size===0}addEventListener(e,t,i=!1){this.getListeners(e,i,!0).add(t)}removeEventListener(e,t,i=!1){let n=this.getListeners(e,i,!1);n&&(n.delete(t),n.size===0&&(i?this.allAsyncListeners:this.allSyncListeners).delete(e))}addGlobalListener(e,t=!1){this.getGlobalListeners(t).add(e)}removeGlobalListener(e,t=!1){this.getGlobalListeners(t).delete(e)}dispatchEvent(e){this.dispatchToListeners(e,!0),this.dispatchToListeners(e,!1),this.firedEvents[e.type]=!0}dispatchEventOnce(e){this.firedEvents[e.type]||this.dispatchEvent(e)}dispatchToListeners(e,t){let i=e.type;if(t&&"event"in e){let a=e.event;a instanceof Event&&(e.eventPath=a.composedPath())}let{frameworkOverrides:n}=this,o=a=>{let l=n?()=>n.wrapIncoming(a):a;t?this.dispatchAsync(l):l()},r=this.getListeners(i,t,!1);if((r?.size??0)>0){let a=new Set(r);for(let l of a)r?.has(l)&&o(()=>l(e))}let s=this.getGlobalListeners(t);if(s.size>0){let a=new Set(s);for(let l of a)o(()=>l(i,e))}}getGlobalListeners(e){return e?this.globalAsyncListeners:this.globalSyncListeners}dispatchAsync(e){if(this.asyncFunctionsQueue.push(e),!this.scheduled){let t=()=>{window.setTimeout(this.flushAsyncQueue.bind(this),0)};this.frameworkOverrides?this.frameworkOverrides.wrapIncoming(t):t(),this.scheduled=!0}}flushAsyncQueue(){this.scheduled=!1;let e=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[];for(let t of e)t()}};function nr(e){return e==null||e===""?null:e}function ie(e){return e!=null&&e!==""}function mt(e){return!ie(e)}function dC(e){return e!=null&&typeof e.toString=="function"?e.toString():null}function hd(e,t){let i=e?JSON.stringify(e):null,n=t?JSON.stringify(t):null;return i===n}function C7(e,t,i=!1){let n=e==null,o=t==null;if(e?.toNumber&&(e=e.toNumber()),t?.toNumber&&(t=t.toNumber()),n&&o)return 0;if(n)return-1;if(o)return 1;function r(s,a){return s>a?1:s<a?-1:0}if(typeof e!="string"||!i)return r(e,t);try{return e.localeCompare(t)}catch{return r(e,t)}}var w7=/[&<>"']/g,b7={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Dl(e){return e?.toString().toString()??null}function id(e){return Dl(e)?.replace(w7,t=>b7[t])??null}function po(e){return e.eRootDiv.getRootNode()}function Ct(e){return po(e).activeElement}function Qt(e){let{gos:t,eRootDiv:i}=e,n=null,o=t.get("getDocument");return o&&ie(o)?n=o():i&&(n=i.ownerDocument),n&&ie(n)?n:document}function K_(e){let t=Ct(e);return t===null||t===Qt(e).body}function Y_(e){return Qt(e).defaultView||window}function qC(e){let t=null,i=null;try{t=Qt(e).fullscreenElement}catch{}finally{t||(t=po(e));let n=t.querySelector("body");n?i=n:t instanceof ShadowRoot?i=t:t instanceof Document?i=t?.documentElement:i=t}return i}function y7(e){return qC(e)?.clientWidth??(window.innerWidth||-1)}function S7(e){return qC(e)?.clientHeight??(window.innerHeight||-1)}function Vn(e,t,i){i==null||typeof i=="string"&&i==""?X_(e,t):yn(e,t,i)}function yn(e,t,i){e.setAttribute(J_(t),i.toString())}function X_(e,t){e.removeAttribute(J_(t))}function J_(e){return`aria-${e}`}function Jr(e,t){t?e.setAttribute("role",t):e.removeAttribute("role")}function x7(e){let t;return e==="asc"?t="ascending":e==="desc"?t="descending":e==="mixed"?t="other":t="none",t}function E7(e){return e.getAttribute("aria-label")}function Sl(e,t){Vn(e,"label",t)}function pd(e,t){Vn(e,"labelledby",t)}function Q_(e,t){Vn(e,"live",t)}function _7(e,t){Vn(e,"atomic",t)}function R7(e,t){Vn(e,"relevant",t)}function P7(e,t){Vn(e,"invalid",t)}function D7(e,t){Vn(e,"disabled",t)}function Z_(e,t){Vn(e,"hidden",t)}function uC(e,t){yn(e,"expanded",t)}function M7(e,t){yn(e,"setsize",t)}function k7(e,t){yn(e,"posinset",t)}function T7(e,t){yn(e,"multiselectable",t)}function F7(e,t){yn(e,"rowcount",t)}function Pp(e,t){yn(e,"rowindex",t)}function I7(e,t){yn(e,"rowspan",t)}function A7(e,t){yn(e,"colcount",t)}function eR(e,t){yn(e,"colindex",t)}function L7(e,t){yn(e,"colspan",t)}function O7(e,t){yn(e,"sort",t)}function N7(e){X_(e,"sort")}function tR(e,t){Vn(e,"selected",t)}function B7(e,t){Vn(e,"controls",t)}function H7(e,t){B7(e,t.id),pd(t,e.id)}function PE(e,t){Vn(e,"owns",t)}function Xp(e,t){return t===void 0?e("ariaIndeterminate","indeterminate"):t===!0?e("ariaChecked","checked"):e("ariaUnchecked","unchecked")}var V7="[tabindex], input, select, button, textarea, [href]",iR="[disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function nd(e){return!e||!e.matches("input, select, button, textarea")||!e.matches(iR)?!1:bo(e)}function ft(e,t,i={}){let{skipAriaHidden:n}=i;e.classList.toggle("ag-hidden",!t),n||Z_(e,!t)}function G7(e,t,i={}){let{skipAriaHidden:n}=i;e.classList.toggle("ag-invisible",!t),n||Z_(e,!t)}function gd(e,t){let i="disabled",n=t?r=>r.setAttribute(i,""):r=>r.removeAttribute(i);n(e);let o=e.querySelectorAll("input")??[];for(let r of o)n(r)}function Zs(e,t,i){let n=0;for(;e;){if(e.classList.contains(t))return!0;if(e=e.parentElement,typeof i=="number"){if(++n>i)break}else if(e===i)break}return!1}function da(e){let{height:t,width:i,borderTopWidth:n,borderRightWidth:o,borderBottomWidth:r,borderLeftWidth:s,paddingTop:a,paddingRight:l,paddingBottom:c,paddingLeft:d,marginTop:u,marginRight:h,marginBottom:p,marginLeft:g,boxSizing:f}=window.getComputedStyle(e),m=Number.parseFloat;return{height:m(t||"0"),width:m(i||"0"),borderTopWidth:m(n||"0"),borderRightWidth:m(o||"0"),borderBottomWidth:m(r||"0"),borderLeftWidth:m(s||"0"),paddingTop:m(a||"0"),paddingRight:m(l||"0"),paddingBottom:m(c||"0"),paddingLeft:m(d||"0"),marginTop:m(u||"0"),marginRight:m(h||"0"),marginBottom:m(p||"0"),marginLeft:m(g||"0"),boxSizing:f}}function $C(e){let t=da(e);return t.boxSizing==="border-box"?t.height-t.paddingTop-t.paddingBottom-t.borderTopWidth-t.borderBottomWidth:t.height}function fd(e){let t=da(e);return t.boxSizing==="border-box"?t.width-t.paddingLeft-t.paddingRight-t.borderLeftWidth-t.borderRightWidth:t.width}function nR(e){let{height:t,marginBottom:i,marginTop:n}=da(e);return Math.floor(t+i+n)}function Dp(e){let{width:t,marginLeft:i,marginRight:n}=da(e);return Math.floor(t+i+n)}function oR(e){let t=e.getBoundingClientRect(),{borderTopWidth:i,borderLeftWidth:n,borderRightWidth:o,borderBottomWidth:r}=da(e);return{top:t.top+(i||0),left:t.left+(n||0),right:t.right+(o||0),bottom:t.bottom+(r||0)}}function Mp(e,t){let i=e.scrollLeft;return t&&(i=Math.abs(i)),i}function kp(e,t,i){i&&(t*=-1),e.scrollLeft=t}function ai(e){for(;e?.firstChild;)e.firstChild.remove()}function zi(e){e?.parentNode&&e.remove()}function rR(e){return!!e.offsetParent}function bo(e){return e.checkVisibility?e.checkVisibility({checkVisibilityCSS:!0}):!(!rR(e)||window.getComputedStyle(e).visibility!=="visible")}function jC(e){let t=document.createElement("div");return t.innerHTML=(e||"").trim(),t.firstChild}function sR(e,t,i){i&&i.nextSibling===t||(e.firstChild?i?i.nextSibling?e.insertBefore(t,i.nextSibling):e.appendChild(t):e.firstChild&&e.firstChild!==t&&e.insertAdjacentElement("afterbegin",t):e.appendChild(t))}function aR(e,t){for(let i=0;i<t.length;i++){let n=t[i],o=e.children[i];o!==n&&e.insertBefore(n,o)}}function z7(e){return e.replace(/[A-Z]/g,t=>`-${t.toLocaleLowerCase()}`)}function _d(e,t){if(t)for(let i of Object.keys(t)){let n=t[i];if(!i?.length||n==null)continue;let o=z7(i),r=n.toString(),s=r.replace(/\s*!important/g,""),a=s.length!=r.length?"important":void 0;e.style.setProperty(o,s,a)}}function fp(e){return()=>{let t=e();return t?KC(t)||lR(t):!0}}function KC(e){return e.clientWidth<e.scrollWidth}function lR(e){return e.clientHeight<e.scrollHeight}function Tp(e,t){t==="flex"?(e.style.removeProperty("width"),e.style.removeProperty("minWidth"),e.style.removeProperty("maxWidth"),e.style.flex="1 1 auto"):vo(e,t)}function vo(e,t){t=YC(t),e.style.width=t,e.style.maxWidth=t,e.style.minWidth=t}function od(e,t){t=YC(t),e.style.height=t,e.style.maxHeight=t,e.style.minHeight=t}function YC(e){return typeof e=="number"?`${e}px`:e}function XC(e){return e instanceof Node||e instanceof HTMLElement}function en(e,t,i){i==null||i===""?e.removeAttribute(t):e.setAttribute(t,i.toString())}function is(e,t,i){let o=Y_(e).ResizeObserver,r=o?new o(i):null;return r?.observe(t),()=>r?.disconnect()}function cr(e,t){let i=Y_(e);i.requestAnimationFrame?i.requestAnimationFrame(t):i.webkitRequestAnimationFrame?i.webkitRequestAnimationFrame(t):i.setTimeout(t,0)}var cR="data-ref",Mv;function DE(){return Mv??(Mv=document.createTextNode(" ")),Mv.cloneNode()}function Rd(e){let{attrs:t,children:i,cls:n,ref:o,role:r,tag:s}=e,a=document.createElement(s);if(n&&(a.className=n),o&&a.setAttribute(cR,o),r&&a.setAttribute("role",r),t)for(let l of Object.keys(t))a.setAttribute(l,t[l]);if(i)if(typeof i=="string")a.textContent=i;else{let l=!0;for(let c of i)c&&(typeof c=="string"?(a.appendChild(document.createTextNode(c)),l=!1):typeof c=="function"?a.appendChild(c()):(l&&(a.appendChild(DE()),l=!1),a.append(Rd(c)),a.appendChild(DE())))}return a}var W7=["touchstart","touchend","touchmove","touchcancel","scroll"],U7=["wheel"],kv={},dR=(()=>{let e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return i=>{if(typeof kv[i]=="boolean")return kv[i];let n=document.createElement(e[i]||"div");return i="on"+i,kv[i]=i in n}})();function q7(e,t){return!t||!e?!1:j7(t).indexOf(e)>=0}function $7(e){let t=[],i=e.target;for(;i;)t.push(i),i=i.parentElement;return t}function j7(e){let t=e;return t.path?t.path:t.composedPath?t.composedPath():$7(t)}function K7(e,t,i){let n=Y7(t),o;n!=null&&(o={passive:n}),e.addEventListener(t,i,o)}var Y7=e=>{let t=W7.includes(e),i=U7.includes(e);if(t)return!0;if(i)return!1};function uR(e,t,i){if(i===0)return!1;let n=Math.abs(e.clientX-t.clientX),o=Math.abs(e.clientY-t.clientY);return Math.max(n,o)<=i}var rd=(e,t)=>{let i=e.identifier;for(let n=0,o=t.length;n<o;++n){let r=t[n];if(r.identifier===i)return r}return null};function md(e,t){return e.gos.isElementInThisInstance(t.target)}function X7(e,t,i){let o=e.getBoundingClientRect().height,r=y7(i)-2,s=S7(i)-2;if(!e.offsetParent)return;let l=oR(e.offsetParent),{clientY:c,clientX:d}=t,u=c-l.top-o/2,h=d-l.left-10,p=Qt(i),g=p.defaultView||window,f=g.pageYOffset||p.documentElement.scrollTop,m=g.pageXOffset||p.documentElement.scrollLeft;r>0&&h+e.clientWidth>r+m&&(h=r+m-e.clientWidth),h<0&&(h=0),s>0&&u+e.clientHeight>s+f&&(u=s+f-e.clientHeight),u<0&&(u=0),e.style.left=`${h}px`,e.style.top=`${u}px`}var mp=(e,...t)=>{for(let i of t){let[n,o,r,s]=i;n.addEventListener(o,r,s),e.push(i)}},JC=e=>{if(e){for(let[t,i,n,o]of e)t.removeEventListener(i,n,o);e.length=0}},Kr=e=>{e.cancelable&&e.preventDefault()};function J7(e,t){return t}function hR(e){return e?.getLocaleTextFunc()??J7}function Q7(e,t,i,n){let o=t[i];return e.getLocaleTextFunc()(i,typeof o=="function"?o(n):o,n)}function Z7(e){return(t,i,n)=>e({key:t,defaultValue:i,variableValues:n})}function eL(e){return(t,i,n)=>{let o=e?.[t];if(o&&n?.length){let r=0;for(;!(r>=n.length||o.indexOf("${variable}")===-1);)o=o.replace("${variable}",n[r++])}return o??i}}var yo=class{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.propertyListenerId=0,this.lastChangeSetIdLookup={},this.isAlive=()=>!this.destroyed}preWireBeans(e){this.beans=e,this.stubContext=e.context,this.eventSvc=e.eventSvc,this.gos=e.gos}destroy(){let{destroyFunctions:e}=this;for(let t=0;t<e.length;t++)e[t]();e.length=0,this.destroyed=!0,this.dispatchLocalEvent({type:"destroyed"})}addEventListener(e,t,i){this.localEventService||(this.localEventService=new ra),this.localEventService.addEventListener(e,t,i)}removeEventListener(e,t,i){this.localEventService?.removeEventListener(e,t,i)}dispatchLocalEvent(e){this.localEventService?.dispatchEvent(e)}addManagedElementListeners(e,t){return this._setupListeners(e,t)}addManagedEventListeners(e){return this._setupListeners(this.eventSvc,e)}addManagedListeners(e,t){return this._setupListeners(e,t)}_setupListeners(e,t){let i=[];for(let n of Object.keys(t)){let o=t[n];o&&i.push(this._setupListener(e,n,o))}return i}_setupListener(e,t,i){if(this.destroyed)return()=>null;let n;if(tL(e))e.__addEventListener(t,i),n=()=>(e.__removeEventListener(t,i),null);else{let o=iL(e);e instanceof HTMLElement?K7(e,t,i):o?e.addListener(t,i):e.addEventListener(t,i),n=o?()=>(e.removeListener(t,i),null):()=>(e.removeEventListener(t,i),null)}return this.destroyFunctions.push(n),()=>(n(),this.destroyFunctions=this.destroyFunctions.filter(o=>o!==n),null)}setupPropertyListener(e,t){let{gos:i}=this;i.addPropertyEventListener(e,t);let n=()=>(i.removePropertyEventListener(e,t),null);return this.destroyFunctions.push(n),()=>(n(),this.destroyFunctions=this.destroyFunctions.filter(o=>o!==n),null)}addManagedPropertyListener(e,t){return this.destroyed?()=>null:this.setupPropertyListener(e,t)}addManagedPropertyListeners(e,t){if(this.destroyed)return;let i=e.join("-")+this.propertyListenerId++,n=o=>{if(o.changeSet){if(o.changeSet&&o.changeSet.id===this.lastChangeSetIdLookup[i])return;this.lastChangeSetIdLookup[i]=o.changeSet.id}let r={type:"propertyChanged",changeSet:o.changeSet,source:o.source};t(r)};for(let o of e)this.setupPropertyListener(o,n)}getLocaleTextFunc(){return hR(this.beans.localeSvc)}addDestroyFunc(e){this.isAlive()?this.destroyFunctions.push(e):e()}createOptionalManagedBean(e,t){return e?this.createManagedBean(e,t):void 0}createManagedBean(e,t){let i=this.createBean(e,t);return this.addDestroyFunc(this.destroyBean.bind(this,e,t)),i}createBean(e,t,i){return(t||this.stubContext).createBean(e,i)}destroyBean(e,t){return(t||this.stubContext).destroyBean(e)}destroyBeans(e,t){return(t||this.stubContext).destroyBeans(e)}};function tL(e){return e.__addEventListener!==void 0}function iL(e){return e.eventServiceType==="global"}var A=class extends yo{},ME={};function QC(e,t){ME[t]||(e(),ME[t]=!0)}var nL={pending:!1,funcs:[]},oL={pending:!1,funcs:[]};function hC(e,t="setTimeout",i){let n=t==="raf"?oL:nL;if(n.funcs.push(e),n.pending)return;n.pending=!0;let o=()=>{let r=n.funcs.slice();n.funcs.length=0,n.pending=!1;for(let s of r)s()};t==="raf"?cr(i,o):window.setTimeout(o,0)}function si(e,t,i){let n;return function(...o){let r=this;window.clearTimeout(n),n=window.setTimeout(function(){e.isAlive()&&t.apply(r,o)},i)}}function kE(e,t){let i=0;return function(...n){let o=this,r=Date.now();r-i<t||(i=r,e.apply(o,n))}}function rL(e,t,i,n=100){let o=Date.now(),r=null,s=!1,a=()=>{r!=null&&(window.clearInterval(r),r=null)};e.addDestroyFunc(a);let l=()=>{let c=Date.now()-o>n;(t()||c)&&(i(),s=!0,a())};l(),s||(r=window.setInterval(l,10))}var pR=new Set(["__proto__","constructor","prototype"]);function sL(e,t){if(e!=null){if(Array.isArray(e)){for(let i=0;i<e.length;i++)t(i.toString(),e[i]);return}for(let i of Object.keys(e).filter(n=>!pR.has(n)))t(i,e[i])}}function Fi(e,t,i=!0,n=!1){ie(t)&&sL(t,(o,r)=>{let s=e[o];s!==r&&(n&&s==null&&r!=null&&typeof r=="object"&&r.constructor===Object&&(s={},e[o]=s),TE(r)&&TE(s)&&!Array.isArray(s)?Fi(s,r,i,n):(i||r!==void 0)&&(e[o]=r))})}function TE(e){return typeof e=="object"&&e!==null}var aL=(()=>{let e=class er{static applyGlobalGridOptions(i){if(!er.gridOptions)return b({},i);let n={};return Fi(n,er.gridOptions,!0,!0),er.mergeStrategy==="deep"?Fi(n,i,!0,!0):n=b(b({},n),i),er.gridOptions.context&&(n.context=er.gridOptions.context),i.context&&(er.mergeStrategy==="deep"&&n.context&&Fi(i.context,n.context,!0,!0),n.context=i.context),n}static applyGlobalGridOption(i,n){if(er.mergeStrategy==="deep"){let o=lL(i);if(o&&typeof o=="object"&&typeof n=="object")return er.applyGlobalGridOptions({[i]:n})[i]}return n}};return e.gridOptions=void 0,e.mergeStrategy="shallow",e})(),ZC=aL;function lL(e){return ZC.gridOptions?.[e]}var cL={suppressContextMenu:!1,preventDefaultOnContextMenu:!1,allowContextMenuWithControlKey:!1,suppressMenuHide:!0,enableBrowserTooltips:!1,tooltipTrigger:"hover",tooltipShowDelay:2e3,tooltipHideDelay:1e4,tooltipMouseTrack:!1,tooltipShowMode:"standard",tooltipInteraction:!1,copyHeadersToClipboard:!1,copyGroupHeadersToClipboard:!1,clipboardDelimiter:"	",suppressCopyRowsToClipboard:!1,suppressCopySingleCellRanges:!1,suppressLastEmptyLineOnPaste:!1,suppressClipboardPaste:!1,suppressClipboardApi:!1,suppressCutToClipboard:!1,maintainColumnOrder:!1,enableStrictPivotColumnOrder:!1,suppressFieldDotNotation:!1,allowDragFromColumnsToolPanel:!1,suppressMovableColumns:!1,suppressColumnMoveAnimation:!1,suppressMoveWhenColumnDragging:!1,suppressDragLeaveHidesColumns:!1,suppressRowGroupHidesColumns:!1,suppressAutoSize:!1,autoSizePadding:20,skipHeaderOnAutoSize:!1,singleClickEdit:!1,suppressClickEdit:!1,readOnlyEdit:!1,stopEditingWhenCellsLoseFocus:!1,enterNavigatesVertically:!1,enterNavigatesVerticallyAfterEdit:!1,enableCellEditingOnBackspace:!1,undoRedoCellEditing:!1,undoRedoCellEditingLimit:10,suppressCsvExport:!1,suppressExcelExport:!1,cacheQuickFilter:!1,includeHiddenColumnsInQuickFilter:!1,excludeChildrenWhenTreeDataFiltering:!1,enableAdvancedFilter:!1,includeHiddenColumnsInAdvancedFilter:!1,enableCharts:!1,masterDetail:!1,keepDetailRows:!1,keepDetailRowsCount:10,detailRowAutoHeight:!1,tabIndex:0,rowBuffer:10,valueCache:!1,valueCacheNeverExpires:!1,enableCellExpressions:!1,suppressTouch:!1,suppressFocusAfterRefresh:!1,suppressBrowserResizeObserver:!1,suppressPropertyNamesCheck:!1,suppressChangeDetection:!1,debug:!1,suppressLoadingOverlay:!1,suppressNoRowsOverlay:!1,pagination:!1,paginationPageSize:100,paginationPageSizeSelector:!0,paginationAutoPageSize:!1,paginateChildRows:!1,suppressPaginationPanel:!1,pivotMode:!1,pivotPanelShow:"never",pivotDefaultExpanded:0,pivotSuppressAutoColumn:!1,suppressExpandablePivotGroups:!1,functionsReadOnly:!1,suppressAggFuncInHeader:!1,alwaysAggregateAtRootLevel:!1,aggregateOnlyChangedColumns:!1,suppressAggFilteredOnly:!1,removePivotHeaderRowWhenSingleValueColumn:!1,animateRows:!0,cellFlashDuration:500,cellFadeDuration:1e3,allowShowChangeAfterFilter:!1,domLayout:"normal",ensureDomOrder:!1,enableRtl:!1,suppressColumnVirtualisation:!1,suppressMaxRenderedRowRestriction:!1,suppressRowVirtualisation:!1,rowDragManaged:!1,rowDragInsertDelay:500,suppressRowDrag:!1,suppressMoveWhenRowDragging:!1,rowDragEntireRow:!1,rowDragMultiRow:!1,embedFullWidthRows:!1,groupDisplayType:"singleColumn",groupDefaultExpanded:0,groupMaintainOrder:!1,groupSelectsChildren:!1,groupSuppressBlankHeader:!1,groupSelectsFiltered:!1,showOpenedGroup:!1,groupRemoveSingleChildren:!1,groupRemoveLowestSingleChildren:!1,groupHideOpenParents:!1,groupAllowUnbalanced:!1,rowGroupPanelShow:"never",suppressMakeColumnVisibleAfterUnGroup:!1,treeData:!1,rowGroupPanelSuppressSort:!1,suppressGroupRowsSticky:!1,rowModelType:"clientSide",asyncTransactionWaitMillis:50,suppressModelUpdateAfterUpdateTransaction:!1,cacheOverflowSize:1,infiniteInitialRowCount:1,serverSideInitialRowCount:1,cacheBlockSize:100,maxBlocksInCache:-1,maxConcurrentDatasourceRequests:2,blockLoadDebounceMillis:0,purgeClosedRowNodes:!1,serverSideSortAllLevels:!1,serverSideOnlyRefreshFilteredGroups:!1,serverSidePivotResultFieldSeparator:"_",viewportRowModelPageSize:5,viewportRowModelBufferSize:5,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,debounceVerticalScrollbar:!1,suppressHorizontalScroll:!1,suppressScrollOnNewData:!1,suppressScrollWhenPopupsAreOpen:!1,suppressAnimationFrame:!1,suppressMiddleClickScrolls:!1,suppressPreventDefaultOnMouseWheel:!1,rowMultiSelectWithClick:!1,suppressRowDeselection:!1,suppressRowClickSelection:!1,suppressCellFocus:!1,suppressHeaderFocus:!1,suppressMultiRangeSelection:!1,enableCellTextSelection:!1,enableRangeSelection:!1,enableRangeHandle:!1,enableFillHandle:!1,fillHandleDirection:"xy",suppressClearOnFillReduction:!1,accentedSort:!1,unSortIcon:!1,suppressMultiSort:!1,alwaysMultiSort:!1,suppressMaintainUnsortedOrder:!1,suppressRowHoverHighlight:!1,suppressRowTransform:!1,columnHoverHighlight:!1,deltaSort:!1,enableGroupEdit:!1,groupLockGroupColumns:0,serverSideEnableClientSideSort:!1,suppressServerSideFullWidthLoadingRow:!1,pivotMaxGeneratedColumns:-1,columnMenu:"new",reactiveCustomComponents:!0,suppressSetFilterByDefault:!1,rowNumbers:!1,enableFilterHandlers:!1},gR="https://www.ag-grid.com";function Qr(e,t,...i){e.get("debug")&&console.log("AG Grid: "+t,...i)}function sd(e,...t){QC(()=>console.warn("AG Grid: "+e,...t),e+t?.join(""))}function ul(e,...t){QC(()=>console.error("AG Grid: "+e,...t),e+t?.join(""))}var fR=new Set,Fp={},hl={},vp,mR=!1,vR=!1,dL=!1;function uL(e){let[t,i]=e.version.split(".")||[],[n,o]=vp.split(".")||[];return t===n&&i===o}function hL(e){vp||(vp=e.version);let t=n=>`You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. ${n} Please update all modules to the same version.`;e.version?uL(e)||ul(t(`'${e.moduleName}' is version ${e.version} but the other modules are version ${vp}.`)):ul(t(`'${e.moduleName}' is incompatible.`));let i=e.validate?.();i&&!i.isValid&&ul(`${i.message}`)}function vd(e,t,i=!1){i||(mR=!0),hL(e);let n=e.rowModels??["all"];fR.add(e);let o;t!==void 0?(vR=!0,hl[t]===void 0&&(hl[t]={}),o=hl[t]):o=Fp;for(let r of n)o[r]===void 0&&(o[r]={}),o[r][e.moduleName]=e;if(e.dependsOn)for(let r of e.dependsOn)vd(r,t,i)}function pL(e){delete hl[e]}function pC(e,t,i){let n=o=>!!Fp[o]?.[e]||!!hl[t]?.[o]?.[e];return n(i)||n("all")}function ew(){return vR}function gL(e,t){let i=hl[e]??{};return[...Object.values(Fp.all??{}),...Object.values(i.all??{}),...Object.values(Fp[t]??{}),...Object.values(i[t]??{})]}function fL(){return new Set(fR)}function mL(){return mR}function CR(){return dL}var Jp=class{static register(e){vd(e,void 0)}static registerModules(e){for(let t of e)vd(t,void 0)}},ee="34.3.1",FE=2e3,IE=100,wR="_version_",bR=null,pl=`${gR}/javascript-data-grid`;function vL(e){bR=e}function CL(e){pl=e}function yR(e,t,i){return bR?.(e,t)??[SL(e,t,i)]}function tw(e,t,i,n,o){e(`${n?"warning":"error"} #${t}`,...yR(t,i,o))}function wL(e){if(!e)return String(e);let t={};for(let i of Object.keys(e))typeof e[i]!="object"&&typeof e[i]!="function"&&(t[i]=e[i]);return JSON.stringify(t)}function bL(e){let t=e;return e instanceof Error?t=e.toString():typeof e=="object"&&(t=wL(e)),t}function Ip(e){return e===void 0?"undefined":e===null?"null":e}function gC(e,t){return`${e}?${t.toString()}`}function yL(e,t,i){let n=Array.from(t.entries()).sort((r,s)=>s[1].length-r[1].length),o=gC(e,t);for(let[r,s]of n){if(r===wR)continue;let a=o.length-i;if(a<=0)break;let l="...",c=a+l.length,d=s.length-c>IE?s.slice(0,s.length-c)+l:s.slice(0,IE)+l;t.set(r,d),o=gC(e,t)}return o}function SR(e,t){let i=new URLSearchParams;if(i.append(wR,ee),t)for(let r of Object.keys(t))i.append(r,bL(t[r]));let n=`${pl}/errors/${e}`,o=gC(n,i);return o.length<=FE?o:yL(n,i,FE)}var SL=(e,t,i)=>{let n=SR(e,t),o=`${i?i+` 
`:""}Visit ${n}`;return CR()?o:`${o}${i?"":` 
  Alternatively register the ValidationModule to see the full message in the console.`}`};function W(...e){tw(sd,e[0],e[1],!0)}function tt(...e){tw(ul,e[0],e[1],!1)}function ed(e,t,i){tw(ul,e,t,!1,i)}function xL(e,t){let i=t[0];return`error #${i} `+yR(i,t[1],e).join(" ")}function Co(...e){return xL(void 0,e)}function xR(e,t){return e.get("rowModelType")===t}function Tt(e,t){return xR(e,"clientSide")}function Ml(e,t){return xR(e,"serverSide")}function li(e,t){return e.get("domLayout")===t}function ea(e){return Lp(e)!==void 0}function ER(e){return typeof e.get("getRowHeight")=="function"}function EL(e,t){return t?!e.get("enableStrictPivotColumnOrder"):e.get("maintainColumnOrder")}function Zr(e,t,i=!1,n){let{gos:o,environment:r}=e;if(n==null&&(n=r.getDefaultRowHeight()),ER(o)){if(i)return{height:n,estimated:!0};let l={node:t,data:t.data},c=o.getCallback("getRowHeight")(l);if(fC(c))return c===0&&W(23),{height:Math.max(1,c),estimated:!1}}if(t.detail&&o.get("masterDetail"))return _L(o);let s=o.get("rowHeight");return{height:s&&fC(s)?s:n,estimated:!1}}function _L(e){if(e.get("detailRowAutoHeight"))return{height:1,estimated:!1};let t=e.get("detailRowHeight");return fC(t)?{height:t,estimated:!1}:{height:300,estimated:!1}}function ta(e){let{environment:t,gos:i}=e,n=i.get("rowHeight");if(!n||mt(n))return t.getDefaultRowHeight();let o=t.refreshRowHeightVariable();return o!==-1?o:(W(24),t.getDefaultRowHeight())}function fC(e){return!isNaN(e)&&typeof e=="number"&&isFinite(e)}function _R(e,t,i){let n=t[e.getDomDataKey()];return n?n[i]:void 0}function sa(e,t,i,n){let o=e.getDomDataKey(),r=t[o];mt(r)&&(r={},t[o]=r),r[i]=n}function gl(e){return e.get("ensureDomOrder")?!1:e.get("animateRows")}function RR(e){return!(e.get("paginateChildRows")||e.get("groupHideOpenParents")||li(e,"print"))}function go(e){return!e.get("autoGroupColumnDef")?.comparator&&!e.get("treeData")}function mC(e){let t=e.get("groupAggFiltering");if(typeof t=="function")return e.getCallback("groupAggFiltering");if(t===!0)return()=>!0}function PR(e){return e.get("grandTotalRow")}function DR(e,t){return t?!1:e.get("groupDisplayType")==="groupRows"}function MR(e,t,i){return!!t.group&&!t.footer&&DR(e,i)}function xl(e){let t=e.getCallback("getRowId");return t===void 0?t:i=>{let n=t(i);return typeof n!="string"&&(QC(()=>W(25,{id:n}),"getRowIdString"),n=String(n)),n}}function RL(e,t){let i=e.get("groupHideParentOfSingleChild");return!!(i===!0||i==="leafGroupsOnly"&&t.leafGroup||e.get("groupRemoveSingleChildren")||e.get("groupRemoveLowestSingleChildren")&&t.leafGroup)}function PL(e){let t=e.get("maxConcurrentDatasourceRequests");return t>0?t:void 0}function fl(e){return e?.checkboxes??!0}function Cp(e){return e?.mode==="multiRow"&&(e.headerCheckbox??!0)}function Ap(e){if(typeof e=="object")return e.checkboxLocation??"selectionColumn"}function Tv(e){return e?.hideDisabledCheckboxes??!1}function DL(e){return typeof e.get("rowSelection")!="string"}function ar(e){let t=e.get("cellSelection");return t!==void 0?!!t:e.get("enableRangeSelection")}function kR(e){let t=e.get("rowSelection")??"single";if(typeof t=="string"){let i=e.get("suppressRowClickSelection"),n=e.get("suppressRowDeselection");return i&&n?!1:i?"enableDeselection":n?"enableSelection":!0}return t.mode==="singleRow"||t.mode==="multiRow"?t.enableClickSelection??!1:!1}function ML(e){let t=kR(e);return t===!0||t==="enableSelection"}function kL(e){let t=kR(e);return t===!0||t==="enableDeselection"}function vC(e){let t=e.get("rowSelection");return typeof t=="string"?e.get("isRowSelectable"):t?.isRowSelectable}function Lp(e){let t="beanName"in e&&e.beanName==="gos"?e.get("rowSelection"):e.rowSelection;if(typeof t=="string")switch(t){case"multiple":return"multiRow";case"single":return"singleRow";default:return}switch(t?.mode){case"multiRow":case"singleRow":return t.mode;default:return}}function Cd(e){return Lp(e)==="multiRow"}function TL(e){let t=e.get("rowSelection");return typeof t=="string"?e.get("rowMultiSelectWithClick"):t?.enableSelectionWithoutKeys??!1}function Op(e){let t=e.get("rowSelection");if(typeof t=="string"){let i=e.get("groupSelectsChildren"),n=e.get("groupSelectsFiltered");return i&&n?"filteredDescendants":i?"descendants":"self"}return t?.mode==="multiRow"?t.groupSelects:void 0}function TR(e,t=!0){let i=e.get("rowSelection");return typeof i!="object"?t?"all":void 0:i.mode==="multiRow"?i.selectAll:"all"}function FL(e){let t=e.get("rowSelection");return typeof t=="string"?!1:t?.mode==="multiRow"?t.ctrlASelectsRows??!1:!1}function wd(e){let t=Op(e);return t==="descendants"||t==="filteredDescendants"}function AE(e){let t=e.get("rowSelection");return typeof t=="object"&&t.masterSelects||"self"}function IL(e){return e.isModuleRegistered("SetFilter")&&!e.get("suppressSetFilterByDefault")}function tn(e){return e.get("columnMenu")==="legacy"}function AL(e){return!tn(e)}function LL(e){return!e||e.length<2?e:"on"+e[0].toUpperCase()+e.substring(1)}function FR(e,t,i){typeof e!="object"&&(e={});let n=b({},e);for(let o of i){let r=t[o];typeof r<"u"&&(n[o]=r)}return n}function IR(e,t){if(!e)return;let i={},n=!1;for(let s of Object.keys(e))i[s]=e[s],n=!0;if(!n)return;let o={type:"gridOptionsChanged",options:i};t.dispatchEvent(o);let r=b({type:"componentStateChanged"},i);t.dispatchEvent(r)}function ye(e,t){return e.addCommon(t)}function LE({gos:e},t){return t.button===2||t.ctrlKey&&e.get("allowContextMenuWithControlKey")}var OL={resizable:!0,sortable:!0},NL=0;function AR(){return NL++}function es(e){return e instanceof ua}var ua=class extends A{constructor(e,t,i,n){super(),this.colDef=e,this.userProvidedColDef=t,this.colId=i,this.primary=n,this.isColumn=!0,this.instanceId=AR(),this.autoHeaderHeight=null,this.moving=!1,this.resizing=!1,this.menuVisible=!1,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.colEventSvc=new ra,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.flex=null,this.colIdSanitised=id(i)}destroy(){super.destroy(),this.beans.rowSpanSvc?.deregister(this)}getInstanceId(){return this.instanceId}setState(){let{colDef:e,beans:{sortSvc:t,pinnedCols:i,colFlex:n}}=this;t?.initCol(this);let o=e.hide;o!==void 0?this.visible=!o:this.visible=!e.initialHide,i?.initCol(this),n?.initCol(this)}setColDef(e,t,i){let n=e.spanRows!==this.colDef.spanRows;this.colDef=e,this.userProvidedColDef=t,this.initMinAndMaxWidths(),this.initDotNotation(),this.initTooltip(),n&&(this.beans.rowSpanSvc?.deregister(this),this.initRowSpan()),this.dispatchColEvent("colDefChanged",i)}getUserProvidedColDef(){return this.userProvidedColDef}getParent(){return this.parent}getOriginalParent(){return this.originalParent}postConstruct(){this.setState(),this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip(),this.initRowSpan(),this.addPivotListener()}initDotNotation(){let{gos:e,colDef:{field:t,tooltipField:i}}=this,n=e.get("suppressFieldDotNotation");this.fieldContainsDots=ie(t)&&t.includes(".")&&!n,this.tooltipFieldContainsDots=ie(i)&&i.includes(".")&&!n}initMinAndMaxWidths(){let e=this.colDef;this.minWidth=e.minWidth??this.beans.environment.getDefaultColumnMinWidth(),this.maxWidth=e.maxWidth??Number.MAX_SAFE_INTEGER}initTooltip(){this.beans.tooltipSvc?.initCol(this)}initRowSpan(){this.colDef.spanRows&&this.beans.rowSpanSvc?.register(this)}addPivotListener(){let e=this.beans.pivotColDefSvc,t=this.colDef.pivotValueColumn;!e||!t||this.addManagedListeners(t,{colDefChanged:i=>{let n=e.recreateColDef(this.colDef);this.setColDef(n,n,i.source)}})}resetActualWidth(e){let t=this.calculateColInitialWidth(this.colDef);this.setActualWidth(t,e,!0)}calculateColInitialWidth(e){let t,i=e.width,n=e.initialWidth;return i!=null?t=i:n!=null?t=n:t=200,Math.max(Math.min(t,this.maxWidth),this.minWidth)}isEmptyGroup(){return!1}isRowGroupDisplayed(e){return this.beans.showRowGroupCols?.isRowGroupDisplayed(this,e)??!1}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}getHighlighted(){return this.highlighted}__addEventListener(e,t){this.colEventSvc.addEventListener(e,t)}__removeEventListener(e,t){this.colEventSvc.removeEventListener(e,t)}addEventListener(e,t){this.frameworkEventListenerService=this.beans.frameworkOverrides.createLocalEventListenerWrapper?.(this.frameworkEventListenerService,this.colEventSvc);let i=this.frameworkEventListenerService?.wrap(e,t)??t;this.colEventSvc.addEventListener(e,i)}removeEventListener(e,t){let i=this.frameworkEventListenerService?.unwrap(e,t)??t;this.colEventSvc.removeEventListener(e,i)}createColumnFunctionCallbackParams(e){return ye(this.gos,{node:e,data:e.data,column:this,colDef:this.colDef})}isSuppressNavigable(e){return this.beans.cellNavigation?.isSuppressNavigable(this,e)??!1}isCellEditable(e){return this.beans.editSvc?.isCellEditable({rowNode:e,column:this})??!1}isSuppressFillHandle(){return!!this.colDef.suppressFillHandle}isAutoHeight(){return!!this.colDef.autoHeight}isAutoHeaderHeight(){return!!this.colDef.autoHeaderHeight}isRowDrag(e){return this.isColumnFunc(e,this.colDef.rowDrag)}isDndSource(e){return this.isColumnFunc(e,this.colDef.dndSource)}isCellCheckboxSelection(e){return this.beans.selectionSvc?.isCellCheckboxSelection(this,e)??!1}isSuppressPaste(e){return this.isColumnFunc(e,this.colDef?.suppressPaste??null)}isResizable(){return!!this.getColDefValue("resizable")}getColDefValue(e){return this.colDef[e]??OL[e]}isColumnFunc(e,t){if(typeof t=="boolean")return t;if(typeof t=="function"){let i=this.createColumnFunctionCallbackParams(e);return t(i)}return!1}createColumnEvent(e,t){return ye(this.gos,{type:e,column:this,columns:[this],source:t})}isMoving(){return this.moving}getSort(){return this.sort}isSortable(){return!!this.getColDefValue("sortable")}isSortAscending(){return this.sort==="asc"}isSortDescending(){return this.sort==="desc"}isSortNone(){return mt(this.sort)}isSorting(){return ie(this.sort)}getSortIndex(){return this.sortIndex}isMenuVisible(){return this.menuVisible}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(e,t){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchColEvent("leftChanged",t))}isFilterActive(){return this.filterActive}isHovered(){return W(261),!!this.beans.colHover?.isHovered(this)}setFirstRightPinned(e,t){this.firstRightPinned!==e&&(this.firstRightPinned=e,this.dispatchColEvent("firstRightPinnedChanged",t))}setLastLeftPinned(e,t){this.lastLeftPinned!==e&&(this.lastLeftPinned=e,this.dispatchColEvent("lastLeftPinnedChanged",t))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return this.pinned==="left"||this.pinned==="right"}isPinnedLeft(){return this.pinned==="left"}isPinnedRight(){return this.pinned==="right"}getPinned(){return this.pinned}setVisible(e,t){let i=e===!0;this.visible!==i&&(this.visible=i,this.dispatchColEvent("visibleChanged",t)),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){return!this.getColDef().suppressSpanHeaderHeight}getFirstRealParent(){let e=this.getOriginalParent();for(;e?.isPadding();)e=e.getOriginalParent();return e}getColumnGroupPaddingInfo(){let e=this.getParent();if(!e?.isPadding())return{numberOfParents:0,isSpanningTotal:!1};let t=e.getPaddingLevel()+1,i=!0;for(;e;){if(!e.isPadding()){i=!1;break}e=e.getParent()}return{numberOfParents:t,isSpanningTotal:i}}getColDef(){return this.colDef}getDefinition(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){let t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}createBaseColDefParams(e){return ye(this.gos,{node:e,data:e.data,colDef:this.colDef,column:this})}getColSpan(e){if(mt(this.colDef.colSpan))return 1;let t=this.createBaseColDefParams(e),i=this.colDef.colSpan(t);return Math.max(i,1)}getRowSpan(e){if(mt(this.colDef.rowSpan))return 1;let t=this.createBaseColDefParams(e),i=this.colDef.rowSpan(t);return Math.max(i,1)}setActualWidth(e,t,i=!1){e=Math.max(e,this.minWidth),e=Math.min(e,this.maxWidth),this.actualWidth!==e&&(this.actualWidth=e,this.flex!=null&&t!=="flex"&&t!=="gridInitializing"&&(this.flex=null),i||this.fireColumnWidthChangedEvent(t)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(e){this.dispatchColEvent("widthChanged",e)}isGreaterThanMax(e){return e>this.maxWidth}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex}isRowGroupActive(){return this.rowGroupActive}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}isValueActive(){return this.aggregationActive}isAllowPivot(){return this.colDef.enablePivot===!0}isAllowValue(){return this.colDef.enableValue===!0}isAllowRowGroup(){return this.colDef.enableRowGroup===!0}dispatchColEvent(e,t,i){let n=this.createColumnEvent(e,t);i&&Fi(n,i),this.colEventSvc.dispatchEvent(n)}dispatchStateUpdatedEvent(e){this.colEventSvc.dispatchEvent({type:"columnStateUpdated",key:e})}};function wi(e){return e instanceof wp}var wp=class extends A{constructor(e,t,i,n){super(),this.colGroupDef=e,this.groupId=t,this.padding=i,this.level=n,this.isColumn=!1,this.expandable=!1,this.instanceId=AR(),this.expandableListenerRemoveCallback=null,this.expanded=!!e?.openByDefault}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0),super.destroy()}reset(e,t){this.colGroupDef=e,this.level=t,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return this.children?this.children.some(e=>e.isVisible()):!1}isPadding(){return this.padding}setExpanded(e){this.expanded=e===void 0?!1:e,this.dispatchLocalEvent({type:"expandedChanged"})}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(e){this.children=e}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){let e=[];return this.addLeafColumns(e),e}forEachLeafColumn(e){if(this.children)for(let t of this.children)es(t)?e(t):wi(t)&&t.forEachLeafColumn(e)}addLeafColumns(e){if(this.children)for(let t of this.children)es(t)?e.push(t):wi(t)&&t.addLeafColumns(e)}getColumnGroupShow(){let e=this.colGroupDef;if(e)return e.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();let e=this.onColumnVisibilityChanged.bind(this);for(let t of this.getLeafColumns())t.__addEventListener("visibleChanged",e);this.expandableListenerRemoveCallback=()=>{for(let t of this.getLeafColumns())t.__removeEventListener("visibleChanged",e);this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let e=!1,t=!1,i=!1,n=this.findChildrenRemovingPadding();for(let r=0,s=n.length;r<s;r++){let a=n[r];if(!a.isVisible())continue;let l=a.getColumnGroupShow();l==="open"?(e=!0,i=!0):l==="closed"?(t=!0,i=!0):(e=!0,t=!0)}let o=e&&t&&i;this.expandable!==o&&(this.expandable=o,this.dispatchLocalEvent({type:"expandableChanged"}))}findChildrenRemovingPadding(){let e=[],t=i=>{for(let n of i)wi(n)&&n.isPadding()?t(n.children):e.push(n)};return t(this.children),e}onColumnVisibilityChanged(){this.setExpandable()}},BL={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}};function OE(e,t,i){let n={},o=e.gos;return Object.assign(n,o.get("defaultColGroupDef")),Object.assign(n,t),o.validateColDef(n,i),n}var HL=class{constructor(){this.existingKeys={}}addExistingKeys(e){for(let t=0;t<e.length;t++)this.existingKeys[e[t]]=!0}getUniqueKey(e,t){e=dC(e);let i=0;for(;;){let n=e??t;if(n?i!==0&&(n+="_"+i):n=i,!this.existingKeys[n]){let o=String(n);return e&&i>0&&W(273,{providedId:e,usedId:o}),this.existingKeys[o]=!0,o}i++}}},zge=Object.freeze([]);function rt(e){if(e?.length)return e[e.length-1]}function ns(e,t,i){if(e===t)return!0;if(!e||!t)return e==null&&t==null;let n=e.length;if(n!==t.length)return!1;for(let o=0;o<n;o++)if(e[o]!==t[o]&&!i?.(e[o],t[o]))return!1;return!0}function Kc(e,t){if(e)for(let i of e)t(i)}function Hn(e,t){let i=e.indexOf(t);i>=0&&e.splice(i,1)}function NE(e,t,i){for(let n=0;n<t.length;n++)Hn(e,t[n]);for(let n=t.length-1;n>=0;n--)e.splice(i,0,t[n])}var Qp="ag-Grid-AutoColumn",LR="ag-Grid-SelectionColumn",OR="ag-Grid-RowNumbersColumn";function NR(e){let t=[],i=n=>{for(let o=0;o<n.length;o++){let r=n[o];es(r)?t.push(r):wi(r)&&i(r.getChildren())}};return i(e),t}function tr(e){return e.reduce((t,i)=>t+i.getActualWidth(),0)}function Np(e,t,i){let n={};if(!t)return;rr(null,t,r=>{n[r.getInstanceId()]=r}),i&&rr(null,i,r=>{n[r.getInstanceId()]=null});let o=Object.values(n).filter(r=>r!=null);e.context.destroyBeans(o)}function iw(e){return e.getId().startsWith(Qp)}function dr(e){return(typeof e=="string"?e:"getColId"in e?e.getColId():e.colId)?.startsWith(LR)??!1}function or(e){return(typeof e=="string"?e:"getColId"in e?e.getColId():e.colId)?.startsWith(OR)??!1}function VL(e){return dr(e)||or(e)}function Bp(e){let t=[];return e instanceof Array?t=e:typeof e=="string"&&(t=e.split(",")),t}function GL(e,t){return ns(e,t,(i,n)=>i.getColId()===n.getColId())}function zL(e){e.map={};for(let t of e.list)e.map[t.getId()]=t}function ml(e){return e==="optionsUpdated"?"gridOptionsChanged":e}function ad(e,t){let i=e===t,n=e.getColDef()===t,o=e.getColId()==t;return i||n||o}var WL=(e,t)=>(i,n)=>{let o={value1:void 0,value2:void 0},r=!1;return e&&(e[i]!==void 0&&(o.value1=e[i],r=!0),ie(n)&&e[n]!==void 0&&(o.value2=e[n],r=!0)),!r&&t&&(t[i]!==void 0&&(o.value1=t[i]),ie(n)&&t[n]!==void 0&&(o.value2=t[n])),o},UL=(e,t)=>{wi(e)&&e.setupExpandable(),e.originalParent=t};function qL(e,t=null,i,n,o){let r=new HL,{existingCols:s,existingGroups:a,existingColKeys:l}=$L(n);r.addExistingKeys(l);let c=BR(e,t,0,i,s,r,a,o),{colGroupSvc:d}=e,u=d?.findMaxDepth(c,0)??0,h=d?d.balanceColumnTree(c,0,u,r):c;return rr(null,h,UL),{columnTree:h,treeDepth:u}}function $L(e){let t=[],i=[],n=[];return e&&rr(null,e,o=>{if(wi(o)){let r=o;i.push(r)}else{let r=o;n.push(r.getId()),t.push(r)}}),{existingCols:t,existingGroups:i,existingColKeys:n}}function BR(e,t,i,n,o,r,s,a){if(!t)return[];let{colGroupSvc:l}=e,c=new Array(t.length);for(let d=0;d<c.length;d++){let u=t[d];l&&QL(u)?c[d]=l.createProvidedColumnGroup(n,u,i,o,r,s,a):c[d]=jL(e,n,u,o,r,a)}return c}function jL(e,t,i,n,o,r){let s=YL(i,n);s&&n?.splice(s.idx,1);let a=s?.column;if(a){let l=CC(e,i,a.getColId());a.setColDef(l,i,r),KL(e,a,l,r)}else{let l=o.getUniqueKey(i.colId,i.field),c=CC(e,i,l);a=new ua(c,i,l,t),e.context.createBean(a)}return e.dataTypeSvc?.addColumnListeners(a),a}function HR(e,t,i,n,o,r,s,a){let{sortSvc:l,pinnedCols:c,colFlex:d}=e;i!==void 0&&t.setVisible(!i,a),l&&(l.updateColSort(t,n,a),o!==void 0&&l.setColSortIndex(t,o)),r!==void 0&&c?.setColPinned(t,r),s!==void 0&&d?.setColFlex(t,s)}function KL(e,t,i,n){HR(e,t,i.hide,i.sort,i.sortIndex,i.pinned,i.flex,n);let o=t.getFlex();if(!(o!=null&&o>0))if(i.width!=null)t.setActualWidth(i.width,n);else{let r=t.getActualWidth();t.setActualWidth(r,n)}}function YL(e,t){if(t)for(let i=0;i<t.length;i++){let n=t[i].getUserProvidedColDef();if(!n)continue;if(e.colId!=null){if(t[i].getId()===e.colId)return{idx:i,column:t[i]};continue}if(e.field!=null){if(n.field===e.field)return{idx:i,column:t[i]};continue}if(n===e)return{idx:i,column:t[i]}}}function CC(e,t,i,n){let{gos:o,dataTypeSvc:r}=e,s={},a=o.get("defaultColDef");Fi(s,a,!1,!0);let l=XL(e,s,t,i);l&&JL(e,l,s);let c=s.cellDataType;Fi(s,t,!1,!0),c!==void 0&&(s.cellDataType=c);let d=o.get("autoGroupColumnDef"),u=go(o);return t.rowGroup&&d&&u&&Fi(s,{sort:d.sort,initialSort:d.initialSort},!1,!0),r&&(r.postProcess(s),r.validateColDef(s)),o.validateColDef(s,i,n),s}function XL(e,t,i,n){let o=e.dataTypeSvc?.updateColDefAndGetColumnType(t,i,n),r=i.type??o??t.type;return t.type=r,r?Bp(r):void 0}function JL(e,t,i){if(!t.length)return;let n=Object.assign({},BL),o=e.gos.get("columnTypes")||{};for(let r of Object.keys(o)){let s=o[r];r in n?W(34,{key:r}):(s.type&&W(35),n[r]=s)}for(let r of t){let s=n[r.trim()];s?Fi(i,s,!1,!0):W(36,{t:r})}}function QL(e){return e.children!==void 0}function rr(e,t,i){if(t)for(let n=0;n<t.length;n++){let o=t[n];wi(o)&&rr(o,o.getChildren(),i),i(o,e)}}function VR(e,t){let i=[],n=[],o=[];return e.forEach(s=>{let a=s.getColDef().lockPosition;a==="right"?o.push(s):a==="left"||a===!0?i.push(s):n.push(s)}),t.get("enableRtl")?[...o,...n,...i]:[...i,...n,...o]}function GR(e,t){let i=!0;return rr(null,t,n=>{if(!wi(n))return;let o=n;if(!o.getColGroupDef()?.marryChildren)return;let a=[];for(let h of o.getLeafColumns()){let p=e.indexOf(h);a.push(p)}let l=Math.max.apply(Math,a),c=Math.min.apply(Math,a),d=l-c,u=o.getLeafColumns().length-1;d>u&&(i=!1)}),i}function zR(e,t){if(!e||e.length==0)return;let i=t(e[0]);for(let n=1;n<e.length;n++)if(i!==t(e[n]))return;return i}function WR(e,t,i){if(!t.length)return;let n=t.length===1?t[0]:null,o=zR(t,r=>r.getPinned());e.dispatchEvent({type:"columnPinned",pinned:o??null,columns:t,column:n,source:i})}function ZL(e,t,i){if(!t.length)return;let n=t.length===1?t[0]:null,o=zR(t,r=>r.isVisible());e.dispatchEvent({type:"columnVisible",visible:o,columns:t,column:n,source:i})}function eO(e,t,i,n){e.dispatchEvent({type:t,columns:i,column:i&&i.length==1?i[0]:null,source:n})}function El(e,t,i,n,o=null){t?.length&&e.dispatchEvent({type:"columnResized",columns:t,column:t.length===1?t[0]:null,flexColumns:o,finished:i,source:n})}function Bn(e,t,i){let{colModel:n,rowGroupColsSvc:o,pivotColsSvc:r,autoColSvc:s,selectionColSvc:a,colAnimation:l,visibleCols:c,pivotResultCols:d,environment:u,valueColsSvc:h,eventSvc:p,gos:g}=e,f=n.getColDefCols()??[],m=a?.getColumns();if(!f.length&&!m?.length)return!1;if(t?.state&&!t.state.forEach)return W(32),!1;let v=(_,R,P,B,q)=>{if(!_)return;let $=WL(R,t.defaultState),te=$("flex").value1;if(HR(e,_,$("hide").value1,$("sort").value1,$("sortIndex").value1,$("pinned").value1,te,i),te==null){let Q=$("width").value1;if(Q!=null){let ge=_.getColDef().minWidth??u.getDefaultColumnMinWidth();ge!=null&&Q>=ge&&_.setActualWidth(Q,i)}}q||!_.isPrimary()||(h?.syncColumnWithState(_,i,$),o?.syncColumnWithState(_,i,$,P),r?.syncColumnWithState(_,i,$,B))},C=(_,R,P)=>{let B=UR(e,i),q=R.slice(),$={},te={},Q=[],ge=[],Me=[],De=0,xt=o?.columns.slice()??[],Ui=r?.columns.slice()??[];for(let Ye of _){let Gt=Ye.colId;if(Gt.startsWith(Qp)){Q.push(Ye),Me.push(Ye);continue}if(dr(Gt)){ge.push(Ye),Me.push(Ye);continue}let qt=P(Gt);qt?(v(qt,Ye,$,te,!1),Hn(q,qt)):(Me.push(Ye),De+=1)}let He=Ye=>v(Ye,null,$,te,!1);q.forEach(He),o?.sortColumns(BE.bind(o,$,xt)),r?.sortColumns(BE.bind(r,te,Ui)),n.refreshCols(!1,i);let pt=(Ye,Gt,zt=[])=>{for(let qt of Gt){let g1=Ye(qt.colId);Hn(zt,g1),v(g1,qt,null,null,!0)}zt.forEach(He)};return pt(Ye=>s?.getColumn(Ye)??null,Q,s?.getColumns()?.slice()),pt(Ye=>a?.getColumn(Ye)??null,ge,a?.getColumns()?.slice()),iO(t,n,g),c.refresh(i),p.dispatchEvent({type:"columnEverythingChanged",source:i}),B(),{unmatchedAndAutoStates:Me,unmatchedCount:De}};l?.start();let{unmatchedAndAutoStates:w,unmatchedCount:y}=C(t.state||[],f,_=>n.getColDefCol(_));if(w.length>0||ie(t.defaultState)){let _=d?.getPivotResultCols()?.list??[];y=C(w,_,R=>d?.getPivotResultCol(R)??null).unmatchedCount}return l?.finish(),y===0}function tO(e,t){let{colModel:i,autoColSvc:n,selectionColSvc:o,eventSvc:r,gos:s}=e,a=i.getColDefCols();if(!a?.length)return;let l=i.getColDefColTree(),c=NR(l),d=[],u=1e3,h=1e3,p=C=>{let w=qR(C);mt(w.rowGroupIndex)&&w.rowGroup&&(w.rowGroupIndex=u++),mt(w.pivotIndex)&&w.pivot&&(w.pivotIndex=h++),d.push(w)};n?.getColumns()?.forEach(p),o?.getColumns()?.forEach(p),c?.forEach(p),Bn(e,{state:d},t);let g=n?.getColumns()??[],v=[...o?.getColumns()??[],...g,...a].map(C=>({colId:C.colId}));Bn(e,{state:v,applyOrder:!0},t),r.dispatchEvent(ye(s,{type:"columnsReset",source:t}))}function UR(e,t){let{rowGroupColsSvc:i,pivotColsSvc:n,valueColsSvc:o,colModel:r,sortSvc:s,eventSvc:a}=e,l={rowGroupColumns:i?.columns.slice()??[],pivotColumns:n?.columns.slice()??[],valueColumns:o?.columns.slice()??[]},c=Hp(e),d={};for(let u of c)d[u.colId]=u;return()=>{let u=(R,P,B,q)=>{let $=P.map(q),te=B.map(q);if(ns($,te))return;let ge=new Set(P);for(let De of B)ge.delete(De)||ge.add(De);let Me=[...ge];a.dispatchEvent({type:R,columns:Me,column:Me.length===1?Me[0]:null,source:t})},h=R=>{let P=[];return r.forAllCols(B=>{let q=d[B.getColId()];q&&R(q,B)&&P.push(B)}),P},p=R=>R.getColId();u("columnRowGroupChanged",l.rowGroupColumns,i?.columns??[],p),u("columnPivotChanged",l.pivotColumns,n?.columns??[],p);let f=h((R,P)=>{let B=R.aggFunc!=null,q=B!=P.isValueActive(),$=B&&R.aggFunc!=P.getAggFunc();return q||$});f.length>0&&eO(a,"columnValueChanged",f,t),El(a,h((R,P)=>R.width!=P.getActualWidth()),!0,t),WR(a,h((R,P)=>R.pinned!=P.getPinned()),t),ZL(a,h((R,P)=>R.hide==P.isVisible()),t);let y=h((R,P)=>R.sort!=P.getSort()||R.sortIndex!=P.getSortIndex());y.length>0&&s?.dispatchSortChangedEvents(t,y);let _=Hp(e);oO(c,_,t,r,a)}}function Hp(e){let{colModel:t,rowGroupColsSvc:i,pivotColsSvc:n}=e,o=t.getColDefCols();if(mt(o)||!t.isAlive())return[];let r=i?.columns,s=n?.columns,a=[],l=d=>{let u=d.isRowGroupActive()&&r?r.indexOf(d):null,h=d.isPivotActive()&&s?s.indexOf(d):null,p=d.isValueActive()?d.getAggFunc():null,g=d.getSort()!=null?d.getSort():null,f=d.getSortIndex()!=null?d.getSortIndex():null;a.push({colId:d.getColId(),width:d.getActualWidth(),hide:!d.isVisible(),pinned:d.getPinned(),sort:g,sortIndex:f,aggFunc:p,rowGroup:d.isRowGroupActive(),rowGroupIndex:u,pivot:d.isPivotActive(),pivotIndex:h,flex:d.getFlex()??null})};t.forAllCols(d=>l(d));let c=new Map(t.getCols().map((d,u)=>[d.getColId(),u]));return a.sort((d,u)=>{let h=c.has(d.colId)?c.get(d.colId):-1,p=c.has(u.colId)?c.get(u.colId):-1;return h-p}),a}function qR(e){let t=(g,f)=>g??f??null,i=e.getColDef(),n=t(i.sort,i.initialSort),o=t(i.sortIndex,i.initialSortIndex),r=t(i.hide,i.initialHide),s=t(i.pinned,i.initialPinned),a=t(i.width,i.initialWidth),l=t(i.flex,i.initialFlex),c=t(i.rowGroupIndex,i.initialRowGroupIndex),d=t(i.rowGroup,i.initialRowGroup);c==null&&!d&&(c=null,d=null);let u=t(i.pivotIndex,i.initialPivotIndex),h=t(i.pivot,i.initialPivot);u==null&&!h&&(u=null,h=null);let p=t(i.aggFunc,i.initialAggFunc);return{colId:e.getColId(),sort:n,sortIndex:o,hide:r,pinned:s,width:a,flex:l,rowGroup:d,rowGroupIndex:c,pivot:h,pivotIndex:u,aggFunc:p}}function iO(e,t,i){if(!e.applyOrder||!e.state)return;let n=[];for(let o of e.state)o.colId!=null&&n.push(o.colId);nO(t.cols,n,t,i)}function nO(e,t,i,n){if(e==null)return;let o=[],r={};for(let a of t){if(r[a])continue;let l=e.map[a];l&&(o.push(l),r[a]=!0)}let s=0;for(let a of e.list){let l=a.getColId();if(r[l]!=null)continue;l.startsWith(Qp)?o.splice(s++,0,a):o.push(a)}if(o=VR(o,n),!GR(o,i.getColTree())){W(39);return}e.list=o}function oO(e,t,i,n,o){let r={};for(let d of t)r[d.colId]=d;let s={};for(let d of e)r[d.colId]&&(s[d.colId]=!0);let a=e.filter(d=>s[d.colId]),l=t.filter(d=>s[d.colId]),c=[];l.forEach((d,u)=>{let h=a?.[u];if(h&&h.colId!==d.colId){let p=n.getCol(h.colId);p&&c.push(p)}}),c.length&&o.dispatchEvent({type:"columnMoved",columns:c,column:c.length===1?c[0]:null,finished:!0,source:i})}var BE=(e,t,i,n)=>{let o=e[i.getId()],r=e[n.getId()],s=o!=null,a=r!=null;if(s&&a)return o-r;if(s)return-1;if(a)return 1;let l=t.indexOf(i),c=t.indexOf(n),d=l>=0,u=c>=0;return d&&u?l-c:d?-1:1},rO=class extends A{constructor(){super(...arguments),this.beanName="colModel",this.pivotMode=!1,this.ready=!1,this.changeEventsDispatching=!1}postConstruct(){this.pivotMode=this.gos.get("pivotMode"),this.addManagedPropertyListeners(["groupDisplayType","treeData","treeDataDisplayType","groupHideOpenParents","rowNumbers","hidePaddedHeaderRows"],e=>this.refreshAll(ml(e.source))),this.addManagedPropertyListeners(["defaultColDef","defaultColGroupDef","columnTypes","suppressFieldDotNotation"],this.recreateColumnDefs.bind(this)),this.addManagedPropertyListener("pivotMode",e=>this.setPivotMode(this.gos.get("pivotMode"),ml(e.source)))}createColsFromColDefs(e){let{beans:t}=this,{valueCache:i,colAutosize:n,rowGroupColsSvc:o,pivotColsSvc:r,valueColsSvc:s,visibleCols:a,eventSvc:l,groupHierarchyColSvc:c}=t,d=this.colDefs?UR(t,e):void 0;i?.expire();let u=this.colDefCols?.list,h=this.colDefCols?.tree,p=qL(t,this.colDefs,!0,h,e);Np(t,this.colDefCols?.tree,p.columnTree);let g=p.columnTree,f=p.treeDepth,m=NR(g),v={};for(let C of m)v[C.getId()]=C;this.colDefCols={tree:g,treeDepth:f,list:m,map:v},this.createColumnsForService([c],this.colDefCols,e),o?.extractCols(e,u),r?.extractCols(e,u),s?.extractCols(e,u),this.ready=!0,this.refreshCols(!0,e),a.refresh(e),l.dispatchEvent({type:"columnEverythingChanged",source:e}),d&&(this.changeEventsDispatching=!0,d(),this.changeEventsDispatching=!1),l.dispatchEvent({type:"newColumnsLoaded",source:e}),e==="gridInitializing"&&n?.applyAutosizeStrategy()}refreshCols(e,t){if(!this.colDefCols)return;let i=this.cols?.tree;this.saveColOrder();let{autoColSvc:n,selectionColSvc:o,rowNumbersSvc:r,quickFilter:s,pivotResultCols:a,showRowGroupCols:l,rowAutoHeight:c,visibleCols:d,colViewport:u,eventSvc:h}=this.beans,p=this.selectCols(a,this.colDefCols);this.createColumnsForService([n,o,r],p,t);let g=EL(this.gos,this.showingPivotResult);(!e||g)&&this.restoreColOrder(p),this.positionLockedCols(p),l?.refresh(),s?.refreshCols(),this.setColSpanActive(),c?.setAutoHeightActive(p),d.clear(),u.clear(),!ns(i,this.cols.tree)&&h.dispatchEvent({type:"gridColumnsChanged"})}createColumnsForService(e,t,i){for(let n of e)n&&(n.createColumns(t,o=>{this.lastOrder=o(this.lastOrder),this.lastPivotOrder=o(this.lastPivotOrder)},i),n.addColumns(t))}selectCols(e,t){let i=e?.getPivotResultCols()??null;this.showingPivotResult=i!=null;let{map:n,list:o,tree:r,treeDepth:s}=i??t;return this.cols={list:o.slice(),map:b({},n),tree:r.slice(),treeDepth:s},i&&(i.list.some(l=>this.cols?.map[l.getColId()]!==void 0)||(this.lastPivotOrder=null)),this.cols}getColsToShow(){if(!this.cols)return[];let{valueColsSvc:e,selectionColSvc:t,gos:i}=this.beans,n=this.isPivotMode()&&!this.showingPivotResult,o=t?.isSelectionColumnEnabled(),r=i.get("rowNumbers"),s=e?.columns;return this.cols.list.filter(l=>{let c=iw(l);if(n){let d=s?.includes(l);return c||d||o&&dr(l)||r&&or(l)}else return c||l.isVisible()})}refreshAll(e){this.ready&&(this.refreshCols(!1,e),this.beans.visibleCols.refresh(e))}setColsVisible(e,t=!1,i){Bn(this.beans,{state:e.map(n=>({colId:typeof n=="string"?n:n.getColId(),hide:!t}))},i)}restoreColOrder(e){let t=this.showingPivotResult?this.lastPivotOrder:this.lastOrder;if(!t)return;let i=t.filter(u=>e.map[u.getId()]!=null);if(i.length===0)return;if(i.length===e.list.length){e.list=i;return}let n=u=>{let h=u.getOriginalParent();return h?h.getChildren().length>1?!0:n(h):!1};if(!i.some(u=>n(u))){let u=new Set(i);for(let h of e.list)u.has(h)||i.push(h);e.list=i;return}let o=new Map;for(let u=0;u<i.length;u++){let h=i[u];o.set(h,u)}let r=e.list.filter(u=>!o.has(u));if(r.length===0){e.list=i;return}let s=(u,h)=>{let p=h?h.getOriginalParent():u.getOriginalParent();if(!p)return null;let g=null,f=null;for(let m of p.getChildren())if(!(m===h||m===u)){if(m instanceof ua){let v=o.get(m);if(v==null)continue;(g==null||g<v)&&(g=v,f=m);continue}m.forEachLeafColumn(v=>{let C=o.get(v);C!=null&&(g==null||g<C)&&(g=C,f=v)})}return f??s(u,p)},a=[],l=new Map;for(let u of r){let h=s(u,null);if(h==null){a.push(u);continue}let p=l.get(h);p===void 0?l.set(h,u):Array.isArray(p)?p.push(u):l.set(h,[p,u])}let c=new Array(e.list.length),d=c.length-1;for(let u=a.length-1;u>=0;u--)c[d--]=a[u];for(let u=i.length-1;u>=0;u--){let h=i[u],p=l.get(h);if(p)if(Array.isArray(p))for(let g=p.length-1;g>=0;g--){let f=p[g];c[d--]=f}else c[d--]=p;c[d--]=h}e.list=c}positionLockedCols(e){e.list=VR(e.list,this.gos)}saveColOrder(){this.showingPivotResult?this.lastPivotOrder=this.cols?.list??null:this.lastOrder=this.cols?.list??null}getColumnDefs(e){return this.colDefCols&&this.beans.colDefFactory?.getColumnDefs(this.colDefCols.list,this.showingPivotResult,this.lastOrder,this.cols?.list??[],e)}setColSpanActive(){this.colSpanActive=!!this.cols?.list.some(e=>e.getColDef().colSpan!=null)}isPivotMode(){return this.pivotMode}setPivotMode(e,t){if(e===this.pivotMode||(this.pivotMode=e,!this.ready))return;this.refreshCols(!1,t);let{visibleCols:i,eventSvc:n}=this.beans;i.refresh(t),n.dispatchEvent({type:"columnPivotModeChanged"})}isPivotActive(){let e=this.beans.pivotColsSvc?.columns;return this.pivotMode&&!!e?.length}recreateColumnDefs(e){if(!this.cols)return;this.beans.autoColSvc?.updateColumns(e);let t=ml(e.source);this.createColsFromColDefs(t)}setColumnDefs(e,t){this.colDefs=e,this.createColsFromColDefs(t)}destroy(){Np(this.beans,this.colDefCols?.tree),super.destroy()}getColTree(){return this.cols?.tree??[]}getColDefColTree(){return this.colDefCols?.tree??[]}getColDefCols(){return this.colDefCols?.list??null}getCols(){return this.cols?.list??[]}forAllCols(e){let{pivotResultCols:t,autoColSvc:i,selectionColSvc:n,groupHierarchyColSvc:o}=this.beans;Kc(this.colDefCols?.list,e),Kc(i?.columns?.list,e),Kc(n?.columns?.list,e),Kc(o?.columns?.list,e),Kc(t?.getPivotResultCols()?.list,e)}getColsForKeys(e){return e?e.map(t=>this.getCol(t)).filter(t=>t!=null):[]}getColDefCol(e){return this.colDefCols?.list?this.getColFromCollection(e,this.colDefCols):null}getCol(e){return e==null?null:this.getColFromCollection(e,this.cols)}getColById(e){return this.cols?.map[e]??null}getColFromCollection(e,t){if(t==null)return null;let{map:i,list:n}=t;if(typeof e=="string"&&i[e])return i[e];for(let a=0;a<n.length;a++)if(ad(n[a],e))return n[a];let{autoColSvc:o,selectionColSvc:r,groupHierarchyColSvc:s}=this.beans;return o?.getColumn(e)??r?.getColumn(e)??s?.getColumn(e)??null}};var $R=class{constructor(){this.existingIds={}}getInstanceIdForKey(e){let t=this.existingIds[e],i;return typeof t!="number"?i=0:i=t+1,this.existingIds[e]=i,i}};function Pd(e,t,i){return i&&e.addDestroyFunc(()=>t.destroyBean(i)),i??e}var Z=null;function HE(e){return typeof e?.getGui=="function"}var jR=class{constructor(e){this.cssClassStates={},this.getGui=e}toggleCss(e,t){if(!e)return;if(e.indexOf(" ")>=0){let n=(e||"").split(" ");if(n.length>1){for(let o of n)this.toggleCss(o,t);return}}this.cssClassStates[e]!==t&&e.length&&(this.getGui()?.classList.toggle(e,t),this.cssClassStates[e]=t)}},sO=0,Dd=class extends yo{constructor(e,t){super(),this.suppressDataRefValidation=!1,this.displayed=!0,this.visible=!0,this.compId=sO++,this.cssManager=new jR(()=>this.eGui),this.componentSelectors=new Map((t??[]).map(i=>[i.selector,i])),e&&this.setTemplate(e)}preConstruct(){this.wireTemplate(this.getGui());let e="component-"+Object.getPrototypeOf(this)?.constructor?.name;for(let t of this.css??[])this.beans.environment.addGlobalCSS(t,e)}wireTemplate(e,t){e&&this.gos&&(this.applyElementsToComponent(e),this.createChildComponentsFromTags(e,t))}getCompId(){return this.compId}getDataRefAttribute(e){return e.getAttribute?e.getAttribute(cR):null}applyElementsToComponent(e,t,i,n=null){if(t===void 0&&(t=this.getDataRefAttribute(e)),t){let o=this[t];if(o===Z)this[t]=n??e;else{let r=i?.[t];if(!this.suppressDataRefValidation&&!r)throw new Error(`data-ref: ${t} on ${this.constructor.name} with ${o}`)}}}createChildComponentsFromTags(e,t){let i=[];for(let n of e.childNodes??[])i.push(n);for(let n of i){if(!(n instanceof HTMLElement))continue;let o=this.createComponentFromElement(n,r=>{let s=r.getGui();if(s)for(let a of n.attributes??[])s.setAttribute(a.name,a.value)},t);if(o){if(o.addItems&&n.children.length){this.createChildComponentsFromTags(n,t);let r=Array.prototype.slice.call(n.children);o.addItems(r)}this.swapComponentForNode(o,e,n)}else n.childNodes&&this.createChildComponentsFromTags(n,t)}}createComponentFromElement(e,t,i){let n=e.nodeName,o=this.getDataRefAttribute(e),r=n.indexOf("AG-")===0,s=r?this.componentSelectors.get(n):null,a=null;if(s){let l=i&&o?i[o]:void 0;a=new s.component(l),a.setParentComponent(this),this.createBean(a,null,t)}else if(r)throw new Error(`selector: ${n}`);return this.applyElementsToComponent(e,o,i,a),a}swapComponentForNode(e,t,i){let n=e.getGui();t.replaceChild(n,i),t.insertBefore(document.createComment(i.nodeName),n),this.addDestroyFunc(this.destroyBean.bind(this,e))}activateTabIndex(e){let t=this.gos.get("tabIndex");e||(e=[]),e.length||e.push(this.getGui());for(let i of e)i.setAttribute("tabindex",t.toString())}setTemplate(e,t,i){let n;typeof e=="string"||e==null?n=jC(e):n=Rd(e),this.setTemplateFromElement(n,t,i)}setTemplateFromElement(e,t,i,n=!1){if(this.eGui=e,this.suppressDataRefValidation=n,t)for(let o=0;o<t.length;o++){let r=t[o];this.componentSelectors.set(r.selector,r)}this.wireTemplate(e,i)}getGui(){return this.eGui}getFocusableElement(){return this.eGui}getAriaElement(){return this.getFocusableElement()}setParentComponent(e){this.parentComponent=e}getParentComponent(){return this.parentComponent}setGui(e){this.eGui=e}queryForHtmlElement(e){return this.eGui.querySelector(e)}getContainerAndElement(e,t){let i=t;return e==null?null:(i||(i=this.eGui),XC(e)?{element:e,parent:i}:{element:e.getGui(),parent:i})}prependChild(e,t){let{element:i,parent:n}=this.getContainerAndElement(e,t)||{};!i||!n||n.insertAdjacentElement("afterbegin",i)}appendChild(e,t){let{element:i,parent:n}=this.getContainerAndElement(e,t)||{};!i||!n||n.appendChild(i)}isDisplayed(){return this.displayed}setVisible(e,t={}){if(e!==this.visible){this.visible=e;let{skipAriaHidden:i}=t;G7(this.eGui,e,{skipAriaHidden:i})}}setDisplayed(e,t={}){if(e!==this.displayed){this.displayed=e;let{skipAriaHidden:i}=t;ft(this.eGui,e,{skipAriaHidden:i});let n={type:"displayChanged",visible:this.displayed};this.dispatchLocalEvent(n)}}destroy(){this.parentComponent&&(this.parentComponent=void 0),super.destroy()}addGuiEventListener(e,t,i){this.eGui.addEventListener(e,t,i),this.addDestroyFunc(()=>this.eGui.removeEventListener(e,t))}addCss(e){this.cssManager.toggleCss(e,!0)}removeCss(e){this.cssManager.toggleCss(e,!1)}toggleCss(e,t){this.cssManager.toggleCss(e,t)}registerCSS(e){this.css||(this.css=[]),this.css.push(e)}},je=class extends Dd{};function KR(e){return typeof e=="object"&&!!e.component}function aO(e,t){return new yt(i=>{i(window.setInterval(e,t))})}var yt=class td{constructor(t){this.status=0,this.resolution=null,this.waiters=[],t(i=>this.onDone(i),i=>this.onReject(i))}static all(t){return t.length?new td(i=>{let n=t.length,o=new Array(n);t.forEach((r,s)=>{r.then(a=>{o[s]=a,n--,n===0&&i(o)})})}):td.resolve()}static resolve(t=null){return new td(i=>i(t))}then(t){return new td(i=>{this.status===1?i(t(this.resolution)):this.waiters.push(n=>i(t(n)))})}onDone(t){this.status=1,this.resolution=t;for(let i of this.waiters)i(t)}onReject(t){}};function lO(e){return e?e.prototype&&"getGui"in e.prototype:!1}function YR(e,t,i,n){let{name:o}=i,r,s,a,l,c,d;if(t){let u=t,h=u[o+"Selector"],p=h?h(n):null,g=f=>{typeof f=="string"?r=f:f!=null&&f!==!0&&(e.isFrameworkComponent(f)?a=f:s=f)};p?(g(p.component),l=p.params,c=p.popup,d=p.popupPosition):g(u[o])}return{compName:r,jsComp:s,fwComp:a,paramsFromSelector:l,popupFromSelector:c,popupPositionFromSelector:d}}var cO=class extends A{constructor(){super(...arguments),this.beanName="userCompFactory"}wireBeans(e){this.agCompUtils=e.agCompUtils,this.registry=e.registry,this.frameworkCompWrapper=e.frameworkCompWrapper,this.gridOptions=e.gridOptions}getCompDetailsFromGridOptions(e,t,i,n=!1){return this.getCompDetails(this.gridOptions,e,t,i,n)}getCompDetails(e,t,i,n,o=!1){let{name:r,cellRenderer:s}=t,{compName:a,jsComp:l,fwComp:c,paramsFromSelector:d,popupFromSelector:u,popupPositionFromSelector:h}=YR(this.beans.frameworkOverrides,e,t,n),p,g,f=w=>{let y=this.registry.getUserComponent(r,w);y&&(l=y.componentFromFramework?void 0:y.component,c=y.componentFromFramework?y.component:void 0,p=y.params,g=y.processParams)};if(a!=null&&f(a),l==null&&c==null&&i!=null&&f(i),l&&s&&!lO(l)&&(l=this.agCompUtils?.adaptFunction(t,l)),!l&&!c){let{validation:w}=this.beans;o&&(a!==i||!i)?a?w?.isProvidedUserComp(a)||tt(50,{compName:a}):i?w||tt(260,z(b({},this.gos.getModuleErrorParams()),{propName:r,compName:i})):tt(216,{name:r}):i&&!w&&tt(146,{comp:i});return}let m=this.mergeParams(e,t,n,d,p,g),v=l==null,C=l??c;return{componentFromFramework:v,componentClass:C,params:m,type:t,popupFromSelector:u,popupPositionFromSelector:h,newAgStackInstance:()=>this.newAgStackInstance(C,v,m,t)}}newAgStackInstance(e,t,i,n){let o=!t,r;o?r=new e:r=this.frameworkCompWrapper.wrap(e,n.mandatoryMethods,n.optionalMethods,n),this.createBean(r);let s=r.init?.(i);return s==null?yt.resolve(r):s.then(()=>r)}mergeParams(e,t,i,n=null,o,r){let s=b(b({},i),o),l=e?.[t.name+"Params"];if(typeof l=="function"){let c=l(i);Fi(s,c)}else typeof l=="object"&&Fi(s,l);return Fi(s,n),r?r(s):s}},dO={name:"dateComponent",mandatoryMethods:["getDate","setDate"],optionalMethods:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled","refresh"]},uO={name:"dragAndDropImageComponent",mandatoryMethods:["setIcon","setLabel"]},hO={name:"headerComponent",optionalMethods:["refresh"]},pO={name:"innerHeaderComponent"},gO={name:"innerHeaderGroupComponent"},fO={name:"headerGroupComponent"};var mO={name:"cellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0};var vO={name:"loadingCellRenderer",cellRenderer:!0},CO={name:"cellEditor",mandatoryMethods:["getValue"],optionalMethods:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached","refresh"]},wO={name:"loadingOverlayComponent",optionalMethods:["refresh"]},bO={name:"noRowsOverlayComponent",optionalMethods:["refresh"]},yO={name:"tooltipComponent"},nw={name:"filter",mandatoryMethods:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethods:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged","refresh"]},SO={name:"floatingFilterComponent",mandatoryMethods:["onParentModelChanged"],optionalMethods:["afterGuiAttached","refresh"]},xO={name:"fullWidthCellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0},EO={name:"loadingCellRenderer",cellRenderer:!0},_O={name:"groupRowRenderer",optionalMethods:["afterGuiAttached"],cellRenderer:!0},RO={name:"detailCellRenderer",optionalMethods:["refresh"],cellRenderer:!0};function PO(e,t){return e.getCompDetailsFromGridOptions(uO,"agDragAndDropImage",t,!0)}function DO(e,t,i){return e.getCompDetails(t,hO,"agColumnHeader",i)}function MO(e,t,i){return e.getCompDetails(t,pO,void 0,i)}function kO(e,t){let i=t.columnGroup.getColGroupDef();return e.getCompDetails(i,fO,"agColumnGroupHeader",t)}function TO(e,t,i){return e.getCompDetails(t,gO,void 0,i)}function FO(e,t){return e.getCompDetailsFromGridOptions(xO,void 0,t,!0)}function IO(e,t){return e.getCompDetailsFromGridOptions(EO,"agLoadingCellRenderer",t,!0)}function AO(e,t){return e.getCompDetailsFromGridOptions(_O,"agGroupRowRenderer",t,!0)}function LO(e,t){return e.getCompDetailsFromGridOptions(RO,"agDetailCellRenderer",t,!0)}function VE(e,t,i){return e.getCompDetails(t,mO,void 0,i)}function GE(e,t,i){return e.getCompDetails(t,vO,"agSkeletonCellRenderer",i,!0)}function XR(e,t,i){return e.getCompDetails(t,CO,"agCellEditor",i,!0)}function OO(e,t,i,n){let o=t.filter;return KR(o)&&(t={filter:o.component,filterParams:t.filterParams}),e.getCompDetails(t,nw,n,i,!0)}function NO(e,t,i){return e.getCompDetails(t,dO,"agDateInput",i,!0)}function BO(e,t){return e.getCompDetailsFromGridOptions(wO,"agLoadingOverlay",t,!0)}function HO(e,t){return e.getCompDetailsFromGridOptions(bO,"agNoRowsOverlay",t,!0)}function VO(e,t){return e.getCompDetails(t.colDef,yO,"agTooltipComponent",t,!0)}function GO(e,t,i,n){return e.getCompDetails(t,SO,n,i)}function JR(e,t){return YR(e,t,nw)}function Fv(e,t,i){return e.mergeParams(t,nw,i)}function bd(e){let t=e;return t?.getFrameworkComponentInstance!=null?t.getFrameworkComponentInstance():e}function zO(e){return typeof e=="object"&&!!e.getComp}var T={BACKSPACE:"Backspace",TAB:"Tab",ENTER:"Enter",ESCAPE:"Escape",SPACE:" ",LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown",DELETE:"Delete",F2:"F2",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",PAGE_HOME:"Home",PAGE_END:"End",A:"KeyA",C:"KeyC",D:"KeyD",V:"KeyV",X:"KeyX",Y:"KeyY",Z:"KeyZ"},ow=class extends Dd{isPopup(){return!0}setParentComponent(e){e.addCss("ag-has-popup"),super.setParentComponent(e)}destroy(){let e=this.parentComponent;e?.isAlive()&&e.getGui().classList.remove("ag-has-popup"),super.destroy()}},Iv,Av,Lv,Ov,wC,bC,Nv;function rs(){return Iv===void 0&&(Iv=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),Iv}function QR(){return Av===void 0&&(Av=/(firefox)/i.test(navigator.userAgent)),Av}function ZR(){return Lv===void 0&&(Lv=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),Lv}function ia(){return Ov===void 0&&(Ov=/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1),Ov}function yC(e){if(!e)return null;let t=e.tabIndex,i=e.getAttribute("tabIndex");return t===-1&&(i===null||i===""&&!QR())?null:t.toString()}function WO(){if(Nv!==void 0)return Nv;if(!document.body)return-1;let e=1e6,t=QR()?6e6:1e9,i=document.createElement("div");for(document.body.appendChild(i);;){let n=e*2;if(i.style.height=n+"px",n>t||i.clientHeight!==n)break;e=n}return i.remove(),Nv=e,e}function UO(){return bC==null&&eP(),bC}function eP(){let e=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",e.appendChild(t);let i=t.offsetWidth-t.clientWidth;i===0&&t.clientWidth===0&&(i=null),t.parentNode&&t.remove(),i!=null&&(bC=i,wC=i===0)}function tP(){return wC==null&&eP(),wC}var rw="T",qO=new RegExp(`[${rw} ]`),$O=new RegExp(`^\\d{4}-\\d{2}-\\d{2}(${rw}\\d{2}:\\d{2}:\\d{2}\\D?)?`);function fo(e,t){return e.toString().padStart(t,"0")}function nn(e,t=!0,i=rw){if(!e)return null;let n=[e.getFullYear(),e.getMonth()+1,e.getDate()].map(o=>fo(o,2)).join("-");return t&&(n+=i+[e.getHours(),e.getMinutes(),e.getSeconds()].map(o=>fo(o,2)).join(":")),n}function op(e,t=!0){return e?t?[String(e.getFullYear()),String(e.getMonth()+1),fo(e.getDate(),2),fo(e.getHours(),2),`:${fo(e.getMinutes(),2)}`,`:${fo(e.getSeconds(),2)}`]:[e.getFullYear(),e.getMonth()+1,fo(e.getDate(),2)].map(String):null}var Bv=e=>{if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"},zE=["January","February","March","April","May","June","July","August","September","October","November","December"],Hv=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function SC(e,t){if(t==null)return nn(e,!1);let i=fo(e.getFullYear(),4),n={YYYY:()=>i.slice(i.length-4,i.length),YY:()=>i.slice(i.length-2,i.length),Y:()=>`${e.getFullYear()}`,MMMM:()=>zE[e.getMonth()],MMM:()=>zE[e.getMonth()].slice(0,3),MM:()=>fo(e.getMonth()+1,2),Mo:()=>`${e.getMonth()+1}${Bv(e.getMonth()+1)}`,M:()=>`${e.getMonth()+1}`,Do:()=>`${e.getDate()}${Bv(e.getDate())}`,DD:()=>fo(e.getDate(),2),D:()=>`${e.getDate()}`,dddd:()=>Hv[e.getDay()],ddd:()=>Hv[e.getDay()].slice(0,3),dd:()=>Hv[e.getDay()].slice(0,2),do:()=>`${e.getDay()}${Bv(e.getDay())}`,d:()=>`${e.getDay()}`},o=new RegExp(Object.keys(n).join("|"),"g");return t.replace(o,r=>r in n?n[r]():r)}function bp(e,t=!1){return!!Wi(e,t)}function jO(e){return bp(e,!0)}function Wi(e,t=!1,i){if(!e||!i&&!$O.test(e))return null;let[n,o]=e.split(qO);if(!n)return null;let r=n.split("-").map(p=>Number.parseInt(p,10));if(r.filter(p=>!isNaN(p)).length!==3)return null;let[s,a,l]=r,c=new Date(s,a-1,l);if(c.getFullYear()!==s||c.getMonth()!==a-1||c.getDate()!==l||!o&&t)return null;if(!o||o==="00:00:00")return c;let[d,u,h]=o.split(":").map(p=>Number.parseInt(p,10));if(d>=0&&d<24)c.setHours(d);else if(t)return null;if(u>=0&&u<60)c.setMinutes(u);else if(t)return null;if(h>=0&&h<60)c.setSeconds(h);else if(t)return null;return c}function xC(e){let{inputValue:t,allSuggestions:i,hideIrrelevant:n,filterByPercentageOfBestMatch:o}=e,r=(i??[]).map((l,c)=>({value:l,relevance:KO(t,l),idx:c}));if(r.sort((l,c)=>l.relevance-c.relevance),n&&(r=r.filter(l=>l.relevance<Math.max(l.value.length,t.length))),r.length>0&&o&&o>0){let c=r[0].relevance*o;r=r.filter(d=>c-d.relevance<0)}let s=[],a=[];for(let l of r)s.push(l.value),a.push(l.idx);return{values:s,indices:a}}function KO(e,t){e.length<t.length&&([e,t]=[t,e]);let i=[],n=[],o=e.length,r=t.length;for(let a=0;a<=r;a++)i[a]=a;let s=0;for(let a=1;a<=o;a++){n[0]=a;for(let l=1;l<=r;l++){let c=e[a-1],d=t[l-1];if(c.toLocaleLowerCase()===d.toLocaleLowerCase())++s,c===d&&++s,a>1&&l>1&&e[a-2].toLocaleLowerCase()===t[l-2].toLocaleLowerCase()&&(++s,e[a-2]===t[l-2]&&++s),a<o/2-10&&++s,n[l]=i[l-1];else{let u=n[l-1],h=i[l],p=i[l-1];n[l]=1+Math.min(u,h,p)}}[i,n]=[n,i]}return i[r]/(s+1)}function iP(e){return e.altKey||e.ctrlKey||e.metaKey?!1:e.key?.length===1}var EC=!1,Vp=0;function YO(e){Vp>0||(e.addEventListener("keydown",Gp),e.addEventListener("mousedown",Gp))}function XO(e){Vp>0||(e.removeEventListener("keydown",Gp),e.removeEventListener("mousedown",Gp))}function Gp(e){let t=EC,i=e.type==="keydown";i&&(e.ctrlKey||e.metaKey||e.altKey)||t!==i&&(EC=i)}function JO(e){let t=Qt(e);return YO(t),Vp++,()=>{Vp--,XO(t)}}function QO(){return EC}function vl(e,t,i=!1){let n=V7,o=iR;t&&(o+=", "+t),i&&(o+=', [tabindex="-1"]');let r=Array.prototype.slice.apply(e.querySelectorAll(n)).filter(l=>bo(l)),s=Array.prototype.slice.apply(e.querySelectorAll(o));return s.length?((l,c)=>l.filter(d=>c.indexOf(d)===-1))(r,s):r}function aa(e,t=!1,i=!1,n=!1){let o=vl(e,n?".ag-tab-guard":null,i),r=t?rt(o):o[0];return r?(r.focus({preventScroll:!0}),!0):!1}function ha(e,t,i,n){let o=vl(t,i?':not([tabindex="-1"])':null),r=Ct(e),s;i?s=o.findIndex(l=>l.contains(r)):s=o.indexOf(r);let a=s+(n?-1:1);return a<0||a>=o.length?null:o[a]}function nP(e,t=5){let i=0;for(;e&&yC(e)===null&&++i<=t;)e=e.parentElement;return yC(e)===null?null:e}var ZO=".ag-label{white-space:nowrap}:where(.ag-ltr) .ag-label{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-label-align-right) .ag-label{order:1}:where(.ag-ltr) :where(.ag-label-align-right) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-rtl) :where(.ag-label-align-right) .ag-label{margin-right:var(--ag-spacing)}.ag-label-align-right>*{flex:none}.ag-label-align-top{align-items:flex-start;flex-direction:column;>*{align-self:stretch}}.ag-label-ellipsis{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:where(.ag-label-align-top) .ag-label{margin-bottom:calc(var(--ag-spacing)*.5)}",e9=class extends Dd{constructor(e,t,i){super(t,i),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=e||{},this.registerCSS(ZO)}postConstruct(){this.addCss("ag-labeled"),this.eLabel.classList.add("ag-label");let{labelSeparator:e,label:t,labelWidth:i,labelAlignment:n,disabled:o}=this.config;o!=null&&this.setDisabled(o),e!=null&&this.setLabelSeparator(e),t!=null&&this.setLabel(t),i!=null&&this.setLabelWidth(i),this.setLabelAlignment(n||this.labelAlignment),this.refreshLabel()}refreshLabel(){let{label:e,eLabel:t}=this;ai(t),typeof e=="string"?t.innerText=e+this.labelSeparator:e&&t.appendChild(e),e===""?(ft(t,!1),Jr(t,"presentation")):(ft(t,!0),Jr(t,null))}setLabelSeparator(e){return this.labelSeparator===e?this:(this.labelSeparator=e,this.label!=null&&this.refreshLabel(),this)}getLabelId(){let e=this.eLabel;return e.id=e.id||`ag-${this.getCompId()}-label`,e.id}getLabel(){return this.label}setLabel(e){return this.label===e?this:(this.label=e,this.refreshLabel(),this)}setLabelAlignment(e){let i=this.getGui().classList;return i.toggle("ag-label-align-left",e==="left"),i.toggle("ag-label-align-right",e==="right"),i.toggle("ag-label-align-top",e==="top"),this}setLabelEllipsis(e){return this.eLabel.classList.toggle("ag-label-ellipsis",e),this}setLabelWidth(e){return this.label==null?this:(Tp(this.eLabel,e),this)}setDisabled(e){e=!!e;let t=this.getGui();return gd(t,e),t.classList.toggle("ag-disabled",e),this.disabled=e,this}isDisabled(){return!!this.disabled}},oP=class extends e9{constructor(e,t,i,n){super(e,t,i),this.className=n}postConstruct(){super.postConstruct();let{width:e,value:t,onValueChange:i}=this.config;e!=null&&this.setWidth(e),t!=null&&this.setValue(t),i!=null&&this.onValueChange(i),this.className&&this.addCss(this.className),this.refreshAriaLabelledBy()}setLabel(e){return super.setLabel(e),this.refreshAriaLabelledBy(),this}refreshAriaLabelledBy(){let e=this.getAriaElement(),t=this.getLabelId(),i=this.getLabel();i==null||i==""||E7(e)!==null?pd(e,""):pd(e,t??"")}setAriaLabel(e){return Sl(this.getAriaElement(),e),this.refreshAriaLabelledBy(),this}onValueChange(e){return this.addManagedListeners(this,{fieldValueChanged:()=>e(this.getValue())}),this}getWidth(){return this.getGui().clientWidth}setWidth(e){return vo(this.getGui(),e),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(e,t){return this.value===e?this:(this.previousValue=this.value,this.value=e,t||this.dispatchLocalEvent({type:"fieldValueChanged"}),this)}};function t9(e){return{tag:"div",role:"presentation",children:[{tag:"div",ref:"eLabel",cls:"ag-input-field-label"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-input-wrapper",role:"presentation",children:[{tag:e,ref:"eInput",cls:"ag-input-field-input"}]}]}}var Js=class extends oP{constructor(e,t,i="text",n="input"){super(e,e?.template??t9(n),[],t),this.inputType=i,this.displayFieldTag=n,this.eLabel=Z,this.eWrapper=Z,this.eInput=Z}postConstruct(){super.postConstruct(),this.setInputType(this.inputType);let{eLabel:e,eWrapper:t,eInput:i,className:n}=this;e.classList.add(`${n}-label`),t.classList.add(`${n}-input-wrapper`),i.classList.add(`${n}-input`),this.addCss("ag-input-field"),i.id=i.id||`ag-${this.getCompId()}-input`;let{inputName:o,inputWidth:r}=this.config;o!=null&&this.setInputName(o),r!=null&&this.setInputWidth(r),this.addInputListeners(),this.activateTabIndex([i])}addInputListeners(){this.addManagedElementListeners(this.eInput,{input:e=>this.setValue(e.target.value)})}setInputType(e){this.displayFieldTag==="input"&&(this.inputType=e,en(this.eInput,"type",e))}getInputElement(){return this.eInput}setInputWidth(e){return Tp(this.eWrapper,e),this}setInputName(e){return this.getInputElement().setAttribute("name",e),this}getFocusableElement(){return this.eInput}setMaxLength(e){let t=this.eInput;return t.maxLength=e,this}setInputPlaceholder(e){return en(this.eInput,"placeholder",e),this}setInputAriaLabel(e){return Sl(this.eInput,e),this.refreshAriaLabelledBy(),this}setDisabled(e){return gd(this.eInput,e),super.setDisabled(e)}setAutoComplete(e){if(e===!0)en(this.eInput,"autocomplete",null);else{let t=typeof e=="string"?e:"off";en(this.eInput,"autocomplete",t)}return this}},sw=class extends Js{constructor(e,t="ag-checkbox",i="checkbox"){super(e,t,i),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}postConstruct(){super.postConstruct();let{readOnly:e,passive:t}=this.config;typeof e=="boolean"&&this.setReadOnly(e),typeof t=="boolean"&&this.setPassive(t)}addInputListeners(){this.addManagedElementListeners(this.eInput,{click:this.onCheckboxClick.bind(this)}),this.addManagedElementListeners(this.eLabel,{click:this.toggle.bind(this)})}getNextValue(){return this.selected===void 0?!0:!this.selected}setPassive(e){this.passive=e}isReadOnly(){return this.readOnly}setReadOnly(e){this.eWrapper.classList.toggle("ag-disabled",e),this.eInput.disabled=e,this.readOnly=e}setDisabled(e){return this.eWrapper.classList.toggle("ag-disabled",e),super.setDisabled(e)}toggle(){if(this.eInput.disabled)return;let e=this.isSelected(),t=this.getNextValue();this.passive?this.dispatchChange(t,e):this.setValue(t)}getValue(){return this.isSelected()}setValue(e,t){return this.refreshSelectedClass(e),this.setSelected(e,t),this}setName(e){let t=this.getInputElement();return t.name=e,this}isSelected(){return this.selected}setSelected(e,t){if(this.isSelected()===e)return;this.previousValue=this.isSelected(),e=this.selected=typeof e=="boolean"?e:void 0;let i=this.eInput;i.checked=e,i.indeterminate=e===void 0,t||this.dispatchChange(this.selected,this.previousValue)}dispatchChange(e,t,i){this.dispatchLocalEvent({type:"fieldValueChanged",selected:e,previousValue:t,event:i});let n=this.getInputElement();this.eventSvc.dispatchEvent({type:"checkboxChanged",id:n.id,name:n.name,selected:e,previousValue:t})}onCheckboxClick(e){if(this.passive||this.eInput.disabled)return;let t=this.isSelected(),i=this.selected=e.target.checked;this.refreshSelectedClass(i),this.dispatchChange(i,t,e)}refreshSelectedClass(e){let t=this.eWrapper.classList;t.toggle("ag-checked",e===!0),t.toggle("ag-indeterminate",e==null)}},aw={selector:"AG-CHECKBOX",component:sw},i9=class extends sw{constructor(e){super(e,"ag-radio-button","radio")}isSelected(){return this.eInput.checked}toggle(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}addInputListeners(){super.addInputListeners(),this.addManagedEventListeners({checkboxChanged:this.onChange.bind(this)})}onChange(e){let t=this.eInput;e.selected&&e.name&&t.name&&t.name===e.name&&e.id&&t.id!==e.id&&this.setValue(!1,!0)}};var pa=class extends Js{constructor(e,t="ag-text-field",i="text"){super(e,t,i)}postConstruct(){super.postConstruct(),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}setValue(e,t){let i=this.eInput;return i.value!==e&&(i.value=ie(e)?e:""),super.setValue(e,t)}setStartValue(e){this.setValue(e,!0)}preventDisallowedCharacters(){let e=new RegExp(`[${this.config.allowedCharPattern}]`),t=i=>{iP(i)&&i.key&&!e.test(i.key)&&i.preventDefault()};this.addManagedListeners(this.eInput,{keydown:t,paste:i=>{i.clipboardData?.getData("text")?.split("").some(o=>!e.test(o))&&i.preventDefault()}})}},Zp={selector:"AG-INPUT-TEXT-FIELD",component:pa},n9=class extends Js{constructor(e){super(e,"ag-text-area",null,"textarea")}setValue(e,t){let i=super.setValue(e,t);return this.eInput.value=e,i}setCols(e){return this.eInput.cols=e,this}setRows(e){return this.eInput.rows=e,this}},o9={selector:"AG-INPUT-TEXT-AREA",component:n9},lw=class extends pa{constructor(e){super(e,"ag-number-field","number")}postConstruct(){super.postConstruct();let e=this.eInput;this.addManagedListeners(e,{blur:()=>{let r=Number.parseFloat(e.value),s=isNaN(r)?"":this.normalizeValue(r.toString());this.value!==s&&this.setValue(s)},wheel:this.onWheel.bind(this)}),e.step="any";let{precision:t,min:i,max:n,step:o}=this.config;typeof t=="number"&&this.setPrecision(t),typeof i=="number"&&this.setMin(i),typeof n=="number"&&this.setMax(n),typeof o=="number"&&this.setStep(o)}onWheel(e){Ct(this.beans)===this.eInput&&e.preventDefault()}normalizeValue(e){return e===""?"":(this.precision!=null&&(e=this.adjustPrecision(e)),e)}adjustPrecision(e,t){let i=this.precision;if(i==null)return e;if(t){let o=Number.parseFloat(e).toFixed(i);return Number.parseFloat(o).toString()}let n=String(e).split(".");if(n.length>1){if(n[1].length<=i)return e;if(i>0)return`${n[0]}.${n[1].slice(0,i)}`}return n[0]}setMin(e){return this.min===e?this:(this.min=e,en(this.eInput,"min",e),this)}setMax(e){return this.max===e?this:(this.max=e,en(this.eInput,"max",e),this)}setPrecision(e){return this.precision=e,this}setStep(e){return this.step===e?this:(this.step=e,en(this.eInput,"step",e),this)}setValue(e,t){return this.setValueOrInputValue(i=>super.setValue(i,t),()=>this,e)}setStartValue(e){return this.setValueOrInputValue(t=>super.setValue(t,!0),t=>{this.eInput.value=t},e)}setValueOrInputValue(e,t,i){if(ie(i)){let n=this.isScientificNotation(i);if(n&&this.eInput.validity.valid)return e(i);if(!n){i=this.adjustPrecision(i);let o=this.normalizeValue(i);n=i!=o}if(n)return t(i)}return e(i)}getValue(){let e=this.eInput;if(!e.validity.valid)return;let t=e.value;return this.isScientificNotation(t)?this.adjustPrecision(t,!0):super.getValue()}isScientificNotation(e){return typeof e=="string"&&e.includes("e")}},r9={selector:"AG-INPUT-NUMBER-FIELD",component:lw},s9=class extends pa{constructor(e){super(e,"ag-date-field","date")}postConstruct(){super.postConstruct();let e=rs();this.addManagedListeners(this.eInput,{wheel:this.onWheel.bind(this),mousedown:()=>{this.isDisabled()||e||this.eInput.focus()}}),this.eInput.step="any"}onWheel(e){Ct(this.beans)===this.eInput&&e.preventDefault()}setMin(e){let t=e instanceof Date?nn(e??null,!!this.includeTime)??void 0:e;return this.min===t?this:(this.min=t,en(this.eInput,"min",t),this)}setMax(e){let t=e instanceof Date?nn(e??null,!!this.includeTime)??void 0:e;return this.max===t?this:(this.max=t,en(this.eInput,"max",t),this)}setStep(e){return this.step===e?this:(this.step=e,en(this.eInput,"step",e),this)}setIncludeTime(e){return this.includeTime===e?this:(this.includeTime=e,super.setInputType(e?"datetime-local":"date"),e&&this.setStep(1),this)}getDate(){if(this.eInput.validity.valid)return Wi(this.getValue())??void 0}setDate(e,t){this.setValue(nn(e??null,this.includeTime),t)}},rP={selector:"AG-INPUT-DATE-FIELD",component:s9},a9=".ag-list-item{align-items:center;display:flex;height:var(--ag-list-item-height);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;&.ag-active-item{background-color:var(--ag-row-hover-color)}}",l9="ag-active-item",c9=(e,t)=>({tag:"div",cls:`ag-list-item ag-${e}-list-item`,attrs:{role:"option"},children:[{tag:"span",ref:"eText",children:t}]}),d9=class extends Dd{constructor(e,t,i){super(c9(e,t)),this.label=t,this.value=i,this.eText=Z}postConstruct(){this.createTooltip(),this.addEventListeners()}setHighlighted(e){let t=this.getGui();t.classList.toggle(l9,e),tR(t,e),this.dispatchLocalEvent({type:"itemHighlighted",highlighted:e})}getHeight(){return this.getGui().clientHeight}setIndex(e,t){let i=this.getGui();k7(i,e),M7(i,t)}createTooltip(){let e={getTooltipValue:()=>this.label,getGui:()=>this.getGui(),getLocation:()=>"UNKNOWN",shouldDisplayTooltip:()=>KC(this.eText)},t=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("highlightTooltipFeature",!1,e,this));t&&(this.tooltipFeature=t)}addEventListeners(){let e=this.getParentComponent();e&&(this.addGuiEventListener("mouseover",()=>{e.highlightItem(this)}),this.addGuiEventListener("mousedown",t=>{t.preventDefault(),t.stopPropagation(),e.setValue(this.value)}))}},u9=class extends Dd{constructor(e="default"){super({tag:"div",cls:`ag-list ag-${e}-list`}),this.cssIdentifier=e,this.options=[],this.listItems=[],this.highlightedItem=null,this.registerCSS(a9)}postConstruct(){let e=this.getGui();this.addManagedElementListeners(e,{mouseleave:()=>this.clearHighlighted()})}handleKeyDown(e){let t=e.key;switch(t){case T.ENTER:if(!this.highlightedItem)this.setValue(this.getValue());else{let i=this.listItems.indexOf(this.highlightedItem);this.setValueByIndex(i)}break;case T.DOWN:case T.UP:e.preventDefault(),this.navigate(t);break;case T.PAGE_DOWN:case T.PAGE_UP:case T.PAGE_HOME:case T.PAGE_END:e.preventDefault(),this.navigateToPage(t);break}}addOptions(e){for(let t of e)this.addOption(t);return this}addOption(e){let{value:t,text:i}=e,n=i??t;return this.options.push({value:t,text:n}),this.renderOption(t,n),this.updateIndices(),this}clearOptions(){this.options=[],this.reset(!0);for(let e of this.listItems)e.destroy();ai(this.getGui()),this.listItems=[],this.refreshAriaRole()}setValue(e,t){if(this.value===e)return this.fireItemSelected(),this;if(e==null)return this.reset(t),this;let i=this.options.findIndex(n=>n.value===e);if(i!==-1){let n=this.options[i];this.value=n.value,this.displayValue=n.text,this.highlightItem(this.listItems[i]),t||this.fireChangeEvent()}return this}setValueByIndex(e){return this.setValue(this.options[e].value)}getValue(){return this.value}getDisplayValue(){return this.displayValue}refreshHighlighted(){this.clearHighlighted();let e=this.options.findIndex(t=>t.value===this.value);e!==-1&&this.highlightItem(this.listItems[e])}highlightItem(e){let t=e.getGui();if(!bo(t))return;this.clearHighlighted(),e.setHighlighted(!0),this.highlightedItem=e;let i=this.getGui(),{scrollTop:n,clientHeight:o}=i,{offsetTop:r,offsetHeight:s}=t;(r+s>n+o||r<n)&&t.scrollIntoView({block:"nearest"})}hideItemTooltip(){this.highlightedItem?.tooltipFeature?.attemptToHideTooltip()}destroy(){this.hideItemTooltip(),super.destroy()}reset(e){this.value=null,this.displayValue=null,this.clearHighlighted(),e||this.fireChangeEvent()}clearHighlighted(){this.highlightedItem?.setHighlighted(!1),this.highlightedItem=null}renderOption(e,t){let i=new d9(this.cssIdentifier,t,e);i.setParentComponent(this);let n=this.createManagedBean(i);this.listItems.push(n),this.getGui().appendChild(n.getGui())}navigate(e){let t=e===T.DOWN,i,{listItems:n,highlightedItem:o}=this;if(!o)i=t?n[0]:rt(n);else{let s=n.indexOf(o)+(t?1:-1);s=Math.min(Math.max(s,0),n.length-1),i=n[s]}this.highlightItem(i)}navigateToPage(e){let{listItems:t,highlightedItem:i}=this;if(!i||t.length===0)return;let n=t.indexOf(i),o=this.options.length-1,r=t[0].getHeight(),s=Math.floor(this.getGui().clientHeight/r),a=-1;e===T.PAGE_HOME?a=0:e===T.PAGE_END?a=o:e===T.PAGE_DOWN?a=Math.min(n+s,o):e===T.PAGE_UP&&(a=Math.max(n-s,0)),a!==-1&&this.highlightItem(t[a])}refreshAriaRole(){Jr(this.getGui(),this.options.length===0?"presentation":"listbox")}updateIndices(){this.refreshAriaRole();let e=this.listItems,t=e.length;e.forEach((i,n)=>{i.setIndex(n+1,t)})}fireChangeEvent(){this.dispatchLocalEvent({type:"fieldValueChanged"}),this.fireItemSelected()}fireItemSelected(){this.dispatchLocalEvent({type:"selectedItem"})}},h9=".ag-picker-field-display{flex:1 1 auto}.ag-picker-field{align-items:center;display:flex}.ag-picker-field-icon{border:0;cursor:pointer;display:flex;margin:0;padding:0}.ag-picker-field-wrapper{background-color:var(--ag-picker-button-background-color);border:var(--ag-picker-button-border);border-radius:5px;min-height:max(var(--ag-list-item-height),calc(var(--ag-spacing)*4));overflow:hidden;&:where(.ag-picker-has-focus),&:where(:focus-within){background-color:var(--ag-picker-button-focus-background-color);border:var(--ag-picker-button-focus-border);box-shadow:var(--ag-focus-shadow);&:where(.invalid){box-shadow:var(--ag-focus-error-shadow)}}&:where(.invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&:disabled{opacity:.5}}",p9={tag:"div",cls:"ag-picker-field",role:"presentation",children:[{tag:"div",ref:"eLabel"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-picker-field-wrapper ag-picker-collapsed",children:[{tag:"div",ref:"eDisplayField",cls:"ag-picker-field-display"},{tag:"div",ref:"eIcon",cls:"ag-picker-field-icon",attrs:{"aria-hidden":"true"}}]}]},g9=class extends oP{constructor(e){if(super(e,e?.template||p9,e?.agComponents||[],e?.className),this.isPickerDisplayed=!1,this.skipClick=!1,this.pickerGap=4,this.hideCurrentPicker=null,this.eLabel=Z,this.eWrapper=Z,this.eDisplayField=Z,this.eIcon=Z,this.registerCSS(h9),this.ariaRole=e?.ariaRole,this.onPickerFocusIn=this.onPickerFocusIn.bind(this),this.onPickerFocusOut=this.onPickerFocusOut.bind(this),!e)return;let{pickerGap:t,maxPickerHeight:i,variableWidth:n,minPickerWidth:o,maxPickerWidth:r}=e;t!=null&&(this.pickerGap=t),this.variableWidth=!!n,i!=null&&this.setPickerMaxHeight(i),o!=null&&this.setPickerMinWidth(o),r!=null&&this.setPickerMaxWidth(r)}postConstruct(){super.postConstruct(),this.setupAria();let e=`ag-${this.getCompId()}-display`;this.eDisplayField.setAttribute("id",e);let t=this.getAriaElement();this.addManagedElementListeners(t,{keydown:this.onKeyDown.bind(this)}),this.addManagedElementListeners(this.eLabel,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)}),this.addManagedElementListeners(this.eWrapper,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)});let{pickerIcon:i,inputWidth:n}=this.config;if(i){let o=this.beans.iconSvc.createIconNoSpan(i);o&&this.eIcon.appendChild(o)}n!=null&&this.setInputWidth(n)}setupAria(){let e=this.getAriaElement();e.setAttribute("tabindex",this.gos.get("tabIndex").toString()),uC(e,!1),this.ariaRole&&Jr(e,this.ariaRole)}onLabelOrWrapperMouseDown(e){if(e){let t=this.getFocusableElement();if(t!==this.eWrapper&&e?.target===t)return;e.preventDefault(),this.getFocusableElement().focus()}if(this.skipClick){this.skipClick=!1;return}this.isDisabled()||(this.isPickerDisplayed?this.hidePicker():this.showPicker())}onKeyDown(e){switch(e.key){case T.UP:case T.DOWN:case T.ENTER:case T.SPACE:e.preventDefault(),this.onLabelOrWrapperMouseDown();break;case T.ESCAPE:this.isPickerDisplayed&&(e.preventDefault(),e.stopPropagation(),this.hideCurrentPicker&&this.hideCurrentPicker());break}}showPicker(){this.isPickerDisplayed=!0,this.pickerComponent||(this.pickerComponent=this.createPickerComponent());let e=this.pickerComponent.getGui();e.addEventListener("focusin",this.onPickerFocusIn),e.addEventListener("focusout",this.onPickerFocusOut),this.hideCurrentPicker=this.renderAndPositionPicker(),this.toggleExpandedStyles(!0)}renderAndPositionPicker(){let e=this.pickerComponent.getGui();this.gos.get("suppressScrollWhenPopupsAreOpen")||([this.destroyMouseWheelFunc]=this.addManagedEventListeners({bodyScroll:()=>{this.hidePicker()}}));let t=this.getLocaleTextFunc(),{config:{pickerAriaLabelKey:i,pickerAriaLabelValue:n,modalPicker:o=!0},maxPickerHeight:r,minPickerWidth:s,maxPickerWidth:a,variableWidth:l,beans:c,eWrapper:d}=this,u={modal:o,eChild:e,closeOnEsc:!0,closedCallback:()=>{let f=K_(c);this.beforeHidePicker(),f&&this.isAlive()&&this.getFocusableElement().focus()},ariaLabel:t(i,n),anchorToElement:d};e.style.position="absolute";let h=c.popupSvc,p=h.addPopup(u);l?(s&&(e.style.minWidth=s),e.style.width=YC(Dp(d)),a&&(e.style.maxWidth=a)):Tp(e,a??Dp(d));let g=r??`${$C(h.getPopupParent())}px`;return e.style.setProperty("max-height",g),this.alignPickerToComponent(),p.hideFunc}alignPickerToComponent(){if(!this.pickerComponent)return;let{pickerGap:e,config:{pickerType:t},beans:{popupSvc:i,gos:n},eWrapper:o,pickerComponent:r}=this,s=n.get("enableRtl")?"right":"left";i.positionPopupByComponent({type:t,eventSource:o,ePopup:r.getGui(),position:"under",alignSide:s,keepWithinBounds:!0,nudgeY:e})}beforeHidePicker(){this.destroyMouseWheelFunc&&(this.destroyMouseWheelFunc(),this.destroyMouseWheelFunc=void 0),this.toggleExpandedStyles(!1);let e=this.pickerComponent.getGui();e.removeEventListener("focusin",this.onPickerFocusIn),e.removeEventListener("focusout",this.onPickerFocusOut),this.isPickerDisplayed=!1,this.pickerComponent=void 0,this.hideCurrentPicker=null}toggleExpandedStyles(e){if(!this.isAlive())return;let t=this.getAriaElement();uC(t,e);let i=this.eWrapper.classList;i.toggle("ag-picker-expanded",e),i.toggle("ag-picker-collapsed",!e)}onPickerFocusIn(){this.togglePickerHasFocus(!0)}onPickerFocusOut(e){this.pickerComponent?.getGui().contains(e.relatedTarget)||this.togglePickerHasFocus(!1)}togglePickerHasFocus(e){this.pickerComponent&&this.eWrapper.classList.toggle("ag-picker-has-focus",e)}hidePicker(){this.hideCurrentPicker&&(this.hideCurrentPicker(),this.dispatchLocalEvent({type:"pickerHidden"}))}setInputWidth(e){return Tp(this.eWrapper,e),this}getFocusableElement(){return this.eWrapper}setPickerGap(e){return this.pickerGap=e,this}setPickerMinWidth(e){return typeof e=="number"&&(e=`${e}px`),this.minPickerWidth=e??void 0,this}setPickerMaxWidth(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerWidth=e??void 0,this}setPickerMaxHeight(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerHeight=e??void 0,this}destroy(){this.hidePicker(),super.destroy()}},f9=".ag-select{align-items:center;display:flex;&.ag-disabled{opacity:.5}}:where(.ag-select){.ag-picker-field-wrapper{cursor:default}&.ag-disabled .ag-picker-field-wrapper:focus{box-shadow:none}&:not(.ag-cell-editor,.ag-label-align-top){min-height:var(--ag-list-item-height)}.ag-picker-field-display{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ag-picker-field-icon{align-items:center;display:flex}}:where(.ag-ltr) :where(.ag-select){.ag-picker-field-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding)/2);padding-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-select){.ag-picker-field-wrapper{padding-left:var(--ag-spacing);padding-right:calc(var(--ag-cell-horizontal-padding)/2)}}.ag-select-list{background-color:var(--ag-picker-list-background-color);border:var(--ag-picker-list-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);overflow:hidden auto}.ag-select-list-item{cursor:default;-webkit-user-select:none;-moz-user-select:none;user-select:none;:where(span){overflow:hidden;text-overflow:ellipsis;white-space:nowrap}}:where(.ag-ltr) .ag-select-list-item{padding-left:calc(var(--ag-cell-horizontal-padding)/2)}:where(.ag-rtl) .ag-select-list-item{padding-right:calc(var(--ag-cell-horizontal-padding)/2)}",cw=class extends g9{constructor(e){super(b({pickerAriaLabelKey:"ariaLabelSelectField",pickerAriaLabelValue:"Select Field",pickerType:"ag-list",className:"ag-select",pickerIcon:"selectOpen",ariaRole:"combobox"},e)),this.registerCSS(f9)}postConstruct(){this.tooltipFeature=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{shouldDisplayTooltip:fp(()=>this.eDisplayField),getGui:()=>this.getGui()})),super.postConstruct(),this.createListComponent(),this.eWrapper.tabIndex=this.gos.get("tabIndex");let{options:e,value:t,placeholder:i}=this.config;e!=null&&this.addOptions(e),t!=null&&this.setValue(t,!0),i&&t==null&&(this.eDisplayField.textContent=i),this.addManagedElementListeners(this.eWrapper,{focusout:this.onWrapperFocusOut.bind(this)})}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}createListComponent(){let e=this.createBean(new u9("select"));this.listComponent=e,e.setParentComponent(this);let t=e.getAriaElement(),i=`ag-select-list-${e.getCompId()}`;t.setAttribute("id",i),H7(this.getAriaElement(),t),e.addManagedElementListeners(e.getGui(),{mousedown:n=>{n?.preventDefault()}}),e.addManagedListeners(e,{selectedItem:()=>{this.hidePicker(),this.dispatchLocalEvent({type:"selectedItem"})},fieldValueChanged:()=>{this.listComponent&&(this.setValue(this.listComponent.getValue(),!1,!0),this.hidePicker())}})}createPickerComponent(){return this.listComponent}beforeHidePicker(){this.listComponent?.hideItemTooltip(),super.beforeHidePicker()}onKeyDown(e){let{key:t}=e;switch(t===T.TAB&&this.hidePicker(),t){case T.ENTER:case T.UP:case T.DOWN:case T.PAGE_UP:case T.PAGE_DOWN:case T.PAGE_HOME:case T.PAGE_END:e.preventDefault(),this.isPickerDisplayed?this.listComponent?.handleKeyDown(e):super.onKeyDown(e);break;case T.ESCAPE:super.onKeyDown(e);break;case T.SPACE:this.isPickerDisplayed?e.preventDefault():super.onKeyDown(e);break}}showPicker(){let e=this.listComponent;e&&(super.showPicker(),e.refreshHighlighted())}addOptions(e){for(let t of e)this.addOption(t);return this}addOption(e){return this.listComponent.addOption(e),this}clearOptions(){return this.listComponent?.clearOptions(),this.setValue(void 0,!0),this}setValue(e,t,i){let{listComponent:n,config:{placeholder:o},eDisplayField:r,tooltipFeature:s}=this;if(this.value===e||!n)return this;if(i||n.setValue(e,!0),n.getValue()===this.getValue())return this;let l=n.getDisplayValue();return l==null&&o&&(l=o),r.textContent=l,s?.setTooltipAndRefresh(l??null),super.setValue(e,t)}destroy(){this.listComponent=this.destroyBean(this.listComponent),super.destroy()}},m9={selector:"AG-SELECT",component:cw};var v9=':where(.ag-root-wrapper,.ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart),:where(.ag-root-wrapper,.ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]){box-sizing:border-box;&:after,&:before{box-sizing:border-box}&:where(div,span,label):focus-visible{box-shadow:inset var(--ag-focus-shadow);outline:none;&:where(.invalid){box-shadow:inset var(--ag-focus-error-shadow)}}&:where(button){color:inherit}}:where(.ag-root-wrapper,ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]) ::-ms-clear{display:none}.ag-hidden{display:none!important}.ag-invisible{visibility:hidden!important}.ag-popup-child{top:0;z-index:5;&:where(:not(.ag-tooltip-custom)){box-shadow:var(--ag-popup-shadow)}}.ag-input-wrapper,.ag-picker-field-wrapper{align-items:center;display:flex;flex:1 1 auto;line-height:normal;position:relative}.ag-input-field{align-items:center;display:flex;flex-direction:row}.ag-input-field-input:where(:not([type=checkbox],[type=radio])){flex:1 1 auto;min-width:0;width:100%}.ag-chart,.ag-dnd-ghost,.ag-external,.ag-popup,.ag-root-wrapper{cursor:default;line-height:normal;white-space:normal;-webkit-font-smoothing:antialiased;background-color:var(--ag-background-color);color:var(--ag-text-color);color-scheme:var(--ag-browser-color-scheme);font-family:var(--ag-font-family);font-size:var(--ag-font-size);--ag-indentation-level:0}:where(.ag-icon):before{align-items:center;background-color:currentcolor;color:inherit;content:"";display:flex;font-family:inherit;font-size:var(--ag-icon-size);font-style:normal;font-variant:normal;height:var(--ag-icon-size);justify-content:center;line-height:var(--ag-icon-size);-webkit-mask-size:contain;mask-size:contain;text-transform:none;width:var(--ag-icon-size)}.ag-icon{background-position:50%;background-repeat:no-repeat;background-size:contain;color:var(--ag-icon-color);display:block;height:var(--ag-icon-size);position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:var(--ag-icon-size)}.ag-disabled,[disabled]{.ag-icon{opacity:.5}&.ag-icon-grip{opacity:.35}}.ag-resizer{pointer-events:none;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none;z-index:1}:where(.ag-resizer){&.ag-resizer-topLeft{cursor:nwse-resize;height:5px;left:0;top:0;width:5px}&.ag-resizer-top{cursor:ns-resize;height:5px;left:5px;right:5px;top:0}&.ag-resizer-topRight{cursor:nesw-resize;height:5px;right:0;top:0;width:5px}&.ag-resizer-right{bottom:5px;cursor:ew-resize;right:0;top:5px;width:5px}&.ag-resizer-bottomRight{bottom:0;cursor:nwse-resize;height:5px;right:0;width:5px}&.ag-resizer-bottom{bottom:0;cursor:ns-resize;height:5px;left:5px;right:5px}&.ag-resizer-bottomLeft{bottom:0;cursor:nesw-resize;height:5px;left:0;width:5px}&.ag-resizer-left{bottom:5px;cursor:ew-resize;left:0;top:5px;width:5px}}',dw=typeof window!="object"||!window?.document?.fonts?.forEach,_C=!1,_l=(e,t,i,n,o,r)=>{if(dw||_C)return;n&&(e=`@layer ${CSS.escape(n)} { ${e} }`);let s=Cl.map.get(t);if(s||(s=[],Cl.map.set(t,s)),s.some(d=>d.css===e))return;let a=document.createElement("style");r&&a.setAttribute("nonce",r),a.dataset.agGlobalCss=i,a.textContent=e;let l={css:e,el:a,priority:o},c;for(let d of s){if(d.priority>o)break;c=d}if(c){c.el.insertAdjacentElement("afterend",a);let d=s.indexOf(c);s.splice(d+1,0,l)}else t.insertBefore(a,t.querySelector(":not(title, meta)")),s.push(l)},sP=(e,t,i,n)=>{_l(v9,e,"shared",t,0,i),n?.forEach((o,r)=>o.forEach(s=>_l(s,e,r,t,0,i)))},C9=e=>{Cl.grids.add(e)},w9=e=>{if(Cl.grids.delete(e),Cl.grids.size===0){Cl.map=new WeakMap;for(let t of document.head.querySelectorAll("style[data-ag-global-css]"))t.remove()}},WE,Cl=(WE=typeof window=="object"?window:{}).agStyleInjectionState??(WE.agStyleInjectionState={map:new WeakMap,grids:new Set}),on=e=>new aP(e),Yr="$default",b9=0,aP=class{constructor({feature:e,params:t,modeParams:i={},css:n,cssImports:o}){this.feature=e,this.css=n,this.cssImports=o,this.modeParams=b({[Yr]:b(b({},i[Yr]??{}),t??{})},i)}use(e,t,i){let n=this._inject;if(n==null){let{css:o}=this;if(o){let r=`ag-theme-${this.feature??"part"}-${++b9}`;typeof o=="function"&&(o=o()),o=`:where(.${r}) {
${o}
}
`;for(let s of this.cssImports??[])o=`@import url(${JSON.stringify(s)});
${o}`;n={css:o,class:r}}else n=!1;this._inject=n}return n&&e&&_l(n.css,e,n.class,t,1,i),n?n.class:!1}},y9=e=>e.replace(/[A-Z]/g,t=>`-${t}`).toLowerCase(),lP=e=>`--ag-${y9(e)}`,wo=e=>`var(${lP(e)})`,S9=(e,t,i)=>Math.max(t,Math.min(i,e)),x9=e=>{let t=new Map;return i=>{let n=i;return t.has(n)||t.set(n,e(i)),t.get(n)}},Zi=e=>({ref:"accentColor",mix:e}),vn=e=>({ref:"foregroundColor",mix:e}),bi=e=>({ref:"foregroundColor",mix:e,onto:"backgroundColor"}),E9=e=>({ref:"foregroundColor",mix:e,onto:"headerBackgroundColor"}),yi={ref:"backgroundColor"},al={ref:"foregroundColor"},Wt={ref:"accentColor"},zp={backgroundColor:"#fff",foregroundColor:"#181d1f",borderColor:vn(.15),chromeBackgroundColor:bi(.02),browserColorScheme:"light"},_9=z(b({},zp),{textColor:al,accentColor:"#2196f3",invalidColor:"#e02525",fontFamily:["-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu","Cantarell","Helvetica Neue","sans-serif"],subtleTextColor:{ref:"textColor",mix:.5},borderWidth:1,borderRadius:4,spacing:8,fontSize:14,focusShadow:{spread:3,color:Zi(.5)},focusErrorShadow:{spread:3,color:{ref:"invalidColor",onto:"backgroundColor",mix:.5}},popupShadow:"0 0 16px #00000026",cardShadow:"0 1px 4px 1px #00000018",dropdownShadow:{ref:"cardShadow"},listItemHeight:{calc:"max(iconSize, dataFontSize) + widgetVerticalSpacing"},dragAndDropImageBackgroundColor:yi,dragAndDropImageBorder:!0,dragAndDropImageNotAllowedBorder:{color:{ref:"invalidColor",onto:"dragAndDropImageBackgroundColor",mix:.5}},dragAndDropImageShadow:{ref:"popupShadow"},iconSize:16,iconColor:"inherit",toggleButtonWidth:28,toggleButtonHeight:18,toggleButtonOnBackgroundColor:Wt,toggleButtonOffBackgroundColor:bi(.3),toggleButtonSwitchBackgroundColor:yi,toggleButtonSwitchInset:2,tooltipBackgroundColor:{ref:"chromeBackgroundColor"},tooltipErrorBackgroundColor:{ref:"invalidColor",onto:"backgroundColor",mix:.1},tooltipTextColor:{ref:"textColor"},tooltipErrorTextColor:{ref:"invalidColor"},tooltipBorder:!0,tooltipErrorBorder:{color:{ref:"invalidColor",onto:"backgroundColor",mix:.25}}}),R9=["colorScheme","color","length","scale","borderStyle","border","shadow","image","fontFamily","fontWeight","duration"],P9=x9(e=>(e=e.toLowerCase(),R9.find(t=>e.endsWith(t.toLowerCase()))??"length")),eg=e=>typeof e=="object"&&e?.ref?wo(e.ref):typeof e=="string"?e:typeof e=="number"?String(e):!1,uw=e=>{if(typeof e=="string")return e;if(e&&"ref"in e){let t=wo(e.ref);return e.mix==null?t:`color-mix(in srgb, ${e.onto?wo(e.onto):"transparent"}, ${t} ${S9(e.mix*100,0,100)}%)`}return!1},D9=eg,ll=e=>typeof e=="string"?e:typeof e=="number"?`${e}px`:e&&"calc"in e?`calc(${e.calc.replace(/ ?[*/+] ?/g," $& ").replace(/-?\b[a-z][a-z0-9]*\b(?![-(])/gi,i=>i[0]==="-"?i:" "+wo(i)+" ")})`:e&&"ref"in e?wo(e.ref):!1,M9=eg,RC=(e,t)=>typeof e=="string"?e:e===!0?RC({},t):e===!1?t==="columnBorder"?RC({color:"transparent"},t):"none":e&&"ref"in e?wo(e.ref):cP(e.style??"solid")+" "+ll(e.width??{ref:"borderWidth"})+" "+uw(e.color??{ref:"borderColor"}),k9=e=>typeof e=="string"?e:e===!1?"none":e&&"ref"in e?wo(e.ref):[ll(e.offsetX??0),ll(e.offsetY??0),ll(e.radius??0),ll(e.spread??0),uw(e.color??{ref:"foregroundColor"})].join(" "),cP=eg,dP=e=>typeof e=="string"?e.includes(",")?e:UE(e):e&&"googleFont"in e?dP(e.googleFont):e&&"ref"in e?wo(e.ref):Array.isArray(e)?e.map(t=>(typeof t=="object"&&"googleFont"in t&&(t=t.googleFont),UE(t))).join(", "):!1,UE=e=>/^[\w-]+$|\w\(/.test(e)?e:JSON.stringify(e),T9=eg,uP=e=>typeof e=="string"?e:e&&"url"in e?`url(${JSON.stringify(e.url)})`:e&&"svg"in e?uP({url:`data:image/svg+xml,${encodeURIComponent(e.svg)}`}):e&&"ref"in e?wo(e.ref):!1,F9=(e,t,i)=>typeof e=="string"?e:typeof e=="number"?(e>=10&&i.warn(104,{value:e,param:t}),`${e}s`):e&&"ref"in e?wo(e.ref):!1,I9={color:uw,colorScheme:D9,length:ll,scale:M9,border:RC,borderStyle:cP,shadow:k9,image:uP,fontFamily:dP,fontWeight:T9,duration:F9},A9=(e,t,i)=>{let n=P9(e);return I9[n](t,e,i)};var L9=e=>new hP(e),hP=class pP{constructor(t,i=[]){this.themeLogger=t,this.parts=i}withPart(t){return typeof t=="function"&&(t=t()),t instanceof aP?new pP(this.themeLogger,[...this.parts,t]):(this.themeLogger.preInitErr(259,"Invalid part",{part:t}),this)}withoutPart(t){return this.withPart(on({feature:t}))}withParams(t,i=Yr){return this.withPart(on({modeParams:{[i]:t}}))}_startUse({styleContainer:t,cssLayer:i,nonce:n,loadThemeGoogleFonts:o,moduleCss:r}){if(dw||_C)return;N9(),sP(t,i,n,r);let s=O9(this);if(s.length>0)for(let a of s)o&&B9(a,n);for(let a of this.parts)a.use(t,i,n)}_getCssClass(){return _C?"ag-theme-quartz":this._cssClassCache??(this._cssClassCache=qE(this.parts).map(t=>t.use(void 0,void 0,void 0)).filter(Boolean).join(" "))}_getModeParams(){let t=this._paramsCache;if(!t){let i={[Yr]:b({},_9)};for(let n of qE(this.parts))for(let o of Object.keys(n.modeParams)){let r=n.modeParams[o];if(r){let s=i[o]??(i[o]={}),a=new Set;for(let l of Object.keys(r)){let c=r[l];c!==void 0&&(s[l]=c,a.add(l))}if(o===Yr)for(let l of Object.keys(i)){let c=i[l];if(l!==Yr)for(let d of a)delete c[d]}}}this._paramsCache=t=i}return t}_getPerInstanceCss(t){let i="##SELECTOR##",n=this._paramsCssCache;if(!n){let o="",r="",s=this._getModeParams();for(let l of Object.keys(s)){let c=s[l];if(l!==Yr){let u=`:where([data-ag-theme-mode="${typeof CSS=="object"?CSS.escape(l):l}"]) & {
`;o+=u,r+=u}for(let d of Object.keys(c).sort()){let u=c[d],h=A9(d,u,this.themeLogger);if(h===!1)this.themeLogger.error(107,{key:d,value:u});else{let p=lP(d),g=p.replace("--ag-","--ag-inherited-");o+=`	${p}: var(${g}, ${h});
`,r+=`	${g}: var(${p});
`}}l!==Yr&&(o+=`}
`,r+=`}
`)}let a=`${i} {
${o}}
`;a+=`:has(> ${i}):not(${i}) {
${r}}
`,this._paramsCssCache=n=a}return n.replaceAll(i,`:where(.${t})`)}},qE=e=>{let t=new Map;for(let n of e)t.set(n.feature,n);let i=[];for(let n of e)(!n.feature||t.get(n.feature)===n)&&i.push(n);return i},O9=e=>{let t=new Set,i=r=>{if(Array.isArray(r))r.forEach(i);else{let s=r?.googleFont;typeof s=="string"&&t.add(s)}};return Object.values(e._getModeParams()).flatMap(r=>Object.values(r)).forEach(i),Array.from(t).sort()},$E=!1,N9=()=>{if(!$E){$E=!0;for(let e of Array.from(document.head.querySelectorAll('style[data-ag-scope="legacy"]')))e.remove()}},B9=async(e,t)=>{let i=`@import url('https://${H9}/css2?family=${encodeURIComponent(e)}:wght@100;200;300;400;500;600;700;800;900&display=swap');
`;_l(i,document.head,`googleFont:${e}`,void 0,0,t)},H9="fonts.googleapis.com",V9=1,G9=class{constructor(e){this.beans={},this.createdBeans=[],this.destroyed=!1,this.instanceId=V9++,e?.beanClasses&&(this.beanDestroyComparator=e.beanDestroyComparator,this.init(e))}init(e){this.id=e.id,this.beans.context=this,this.destroyCallback=e.destroyCallback;for(let t of Object.keys(e.providedBeanInstances))this.beans[t]=e.providedBeanInstances[t];for(let t of e.beanClasses){let i=new t;i.beanName?this.beans[i.beanName]=i:console.error(`Bean ${t.name} is missing beanName`),this.createdBeans.push(i)}for(let t of e.derivedBeans??[]){let{beanName:i,bean:n}=t(this);this.beans[i]=n,this.createdBeans.push(n)}e.beanInitComparator&&this.createdBeans.sort(e.beanInitComparator),this.initBeans(this.createdBeans)}getBeanInstances(){return Object.values(this.beans)}createBean(e,t){return this.initBeans([e],t),e}initBeans(e,t){let i=this.beans;for(let n of e)n.preWireBeans?.(i),n.wireBeans?.(i);for(let n of e)n.preConstruct?.();t&&e.forEach(t);for(let n of e)n.postConstruct?.()}getBeans(){return this.beans}getBean(e){return this.beans[e]}getId(){return this.id}destroy(){if(this.destroyed)return;this.destroyed=!0;let e=this.getBeanInstances();this.beanDestroyComparator&&e.sort(this.beanDestroyComparator),this.destroyBeans(e),this.beans={},this.createdBeans=[],this.destroyCallback?.()}destroyBean(e){e?.destroy?.()}destroyBeans(e){if(e)for(let t=0;t<e.length;t++)this.destroyBean(e[t]);return[]}isDestroyed(){return this.destroyed}},z9=0,W9=class extends yo{constructor(){super(...arguments),this.beanName="environment",this.paramsClass=`ag-theme-params-${++z9}`,this.globalCSS=[]}wireBeans(e){this.eRootDiv=e.eRootDiv}postConstruct(){let{gos:e,eRootDiv:t}=this;e.setInstanceDomData(t),this.eStyleContainer=e.get("themeStyleContainer")??(t.getRootNode()===document?document.head:t),this.cssLayer=e.get("themeCssLayer"),this.styleNonce=e.get("styleNonce"),this.addManagedPropertyListener("theme",()=>this.handleThemeChange()),this.handleThemeChange(),this.initVariables(),this.addDestroyFunc(()=>w9(this)),this.mutationObserver=new MutationObserver(()=>{this.fireStylesChangedEvent("themeChanged")}),this.addDestroyFunc(()=>this.mutationObserver.disconnect())}applyThemeClasses(e,t=[]){let{theme:i}=this,n;i?n=`${this.paramsClass} ${i._getCssClass()}`:n=this.applyLegacyThemeClasses();for(let o of Array.from(e.classList))o.startsWith("ag-theme-")&&e.classList.remove(o);if(n){let o=e.className;e.className=`${o}${o?" ":""}${n}${t?.length?" "+t.join(" "):""}`}}applyLegacyThemeClasses(){let e="";this.mutationObserver.disconnect();let t=this.eRootDiv;for(;t;){let i=!1;for(let n of Array.from(t.classList))n.startsWith("ag-theme-")&&(i=!0,e=e?`${e} ${n}`:n);i&&this.mutationObserver.observe(t,{attributes:!0,attributeFilter:["class"]}),t=t.parentElement}return e}addGlobalCSS(e,t){this.theme?_l(e,this.eStyleContainer,t,this.cssLayer,0,this.styleNonce):this.globalCSS.push([e,t])}handleThemeChange(){let{gos:e,theme:t}=this,i=e.get("theme"),n;if(i==="legacy")n=void 0;else{let o=i??this.getDefaultTheme();o instanceof hP?n=o:this.themeError(o)}n!==t&&this.handleNewTheme(n),this.postProcessThemeChange(n,i)}handleNewTheme(e){let{gos:t,eRootDiv:i,globalCSS:n}=this,o=this.getAdditionalCss();if(e){C9(this),sP(this.eStyleContainer,this.cssLayer,this.styleNonce,o);for(let[s,a]of n)_l(s,this.eStyleContainer,a,this.cssLayer,0,this.styleNonce);n.length=0}this.theme=e,e?._startUse({loadThemeGoogleFonts:t.get("loadThemeGoogleFonts"),styleContainer:this.eStyleContainer,cssLayer:this.cssLayer,nonce:this.styleNonce,moduleCss:o});let r=this.eParamsStyle;if(!r){r=this.eParamsStyle=Rd({tag:"style"});let s=t.get("styleNonce");s&&r.setAttribute("nonce",s),i.appendChild(r)}dw||(r.textContent=e?._getPerInstanceCss(this.paramsClass)||""),this.applyThemeClasses(i),this.fireStylesChangedEvent("themeChanged")}},U9=class extends yo{constructor(){super(...arguments),this.beanName="registry"}registerDynamicBeans(e){if(e){this.dynamicBeans??(this.dynamicBeans={});for(let t of Object.keys(e))this.dynamicBeans[t]=e[t]}}createDynamicBean(e,t,...i){if(!this.dynamicBeans)throw new Error(this.getDynamicError(e,!0));let n=this.dynamicBeans[e];if(n==null){if(t)throw new Error(this.getDynamicError(e,!1));return}return new n(...i)}},q9=class extends yo{constructor(){super(...arguments),this.beanName="eventSvc",this.eventServiceType="global",this.globalSvc=new ra}addListener(e,t,i){this.globalSvc.addEventListener(e,t,i)}removeListener(e,t,i){this.globalSvc.removeEventListener(e,t,i)}addGlobalListener(e,t=!1){this.globalSvc.addGlobalListener(e,t)}removeGlobalListener(e,t=!1){this.globalSvc.removeGlobalListener(e,t)}dispatchEvent(e){this.globalSvc.dispatchEvent(this.gos.addCommon(e))}dispatchEventOnce(e){this.globalSvc.dispatchEventOnce(this.gos.addCommon(e))}},gP=class extends yo{constructor(e,t){super(),this.ctrl=e,t&&(this.beans=t)}postConstruct(){this.refreshTooltip()}setBrowserTooltip(e,t){let i="title",n=this.ctrl.getGui();n&&(e!=null&&(e!=""||t)?n.setAttribute(i,e):n.removeAttribute(i))}updateTooltipText(){let{getTooltipValue:e}=this.ctrl;e&&(this.tooltip=e())}createTooltipFeatureIfNeeded(){if(this.tooltipManager==null){let e=this.beans.registry.createDynamicBean("tooltipStateManager",!0,this.ctrl,()=>this.tooltip);e&&(this.tooltipManager=this.createBean(e,this.beans.context))}}attemptToShowTooltip(){this.tooltipManager?.prepareToShowTooltip()}attemptToHideTooltip(){this.tooltipManager?.hideTooltip()}setTooltipAndRefresh(e){this.tooltip=e,this.refreshTooltip()}refreshTooltip(e){this.browserTooltips=this.beans.gos.get("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?(this.setBrowserTooltip(this.tooltip),this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context)):(this.setBrowserTooltip(e?"":null,e),this.createTooltipFeatureIfNeeded())}destroy(){this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context),super.destroy()}},$9=1e3,j9=1e3,jE=100,KE,rp=!1,K9=class extends yo{constructor(e,t){super(),this.tooltipCtrl=e,this.getTooltipValue=t,this.interactionEnabled=!1,this.isInteractingWithTooltip=!1,this.state=0,this.tooltipInstanceCount=0,this.tooltipMouseTrack=!1}wireBeans(e){this.popupSvc=e.popupSvc}postConstruct(){this.gos.get("tooltipInteraction")&&(this.interactionEnabled=!0),this.tooltipTrigger=this.getTooltipTrigger(),this.tooltipMouseTrack=this.gos.get("tooltipMouseTrack");let e=this.tooltipCtrl.getGui();this.tooltipTrigger===0&&this.addManagedListeners(e,{mouseenter:this.onMouseEnter.bind(this),mouseleave:this.onMouseLeave.bind(this)}),this.tooltipTrigger===1&&this.addManagedListeners(e,{focusin:this.onFocusIn.bind(this),focusout:this.onFocusOut.bind(this)}),this.addManagedListeners(e,{mousemove:this.onMouseMove.bind(this)}),this.interactionEnabled||this.addManagedListeners(e,{mousedown:this.onMouseDown.bind(this),keydown:this.onKeyDown.bind(this)})}getGridOptionsTooltipDelay(e){let t=this.gos.get(e);return Math.max(200,t)}getTooltipDelay(e){return e==="show"?this.tooltipCtrl.getTooltipShowDelayOverride?.()??this.getGridOptionsTooltipDelay("tooltipShowDelay"):this.tooltipCtrl.getTooltipHideDelayOverride?.()??this.getGridOptionsTooltipDelay("tooltipHideDelay")}destroy(){this.setToDoNothing(),super.destroy()}getTooltipTrigger(){let e=this.gos.get("tooltipTrigger");return!e||e==="hover"?0:1}onMouseEnter(e){this.interactionEnabled&&this.interactiveTooltipTimeoutId&&(this.unlockService(),this.startHideTimeout()),!ia()&&(rp?this.showTooltipTimeoutId=window.setTimeout(()=>{this.prepareToShowTooltip(e)},jE):this.prepareToShowTooltip(e))}onMouseMove(e){this.lastMouseEvent&&(this.lastMouseEvent=e),this.tooltipMouseTrack&&this.state===2&&this.tooltipComp&&this.positionTooltip()}onMouseDown(){this.setToDoNothing()}onMouseLeave(){this.interactionEnabled?this.lockService():this.setToDoNothing()}onFocusIn(){this.prepareToShowTooltip()}onFocusOut(e){let t=e.relatedTarget,i=this.tooltipCtrl.getGui(),n=this.tooltipComp?.getGui();this.isInteractingWithTooltip||i.contains(t)||this.interactionEnabled&&n?.contains(t)||this.setToDoNothing()}onKeyDown(){this.isInteractingWithTooltip&&(this.isInteractingWithTooltip=!1),this.setToDoNothing()}prepareToShowTooltip(e){if(this.state!=0||rp)return;let t=0;e&&(t=this.isLastTooltipHiddenRecently()?200:this.getTooltipDelay("show")),this.lastMouseEvent=e||null,this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),t),this.state=1}isLastTooltipHiddenRecently(){return Date.now()-KE<$9}setToDoNothing(e){!e&&this.state===2&&this.hideTooltip(),this.onBodyScrollEventCallback&&(this.onBodyScrollEventCallback(),this.onBodyScrollEventCallback=void 0),this.clearEventHandlers(),this.onDocumentKeyDownCallback&&(this.onDocumentKeyDownCallback(),this.onDocumentKeyDownCallback=void 0),this.clearTimeouts(),this.state=0,this.lastMouseEvent=null}showTooltip(){let e=this.getTooltipValue(),t=this.tooltipCtrl;if(!ie(e)||t.shouldDisplayTooltip&&!t.shouldDisplayTooltip()){this.setToDoNothing();return}let i=this.gos.addCommon(b({location:t.getLocation?.()??"UNKNOWN",value:e,hideTooltipCallback:()=>this.hideTooltip(!0)},t.getAdditionalParams?.()));this.state=2,this.tooltipInstanceCount++;let n=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.createTooltipComp(i,n)}hideTooltip(e){!e&&this.isInteractingWithTooltip||(this.tooltipComp&&(this.destroyTooltipComp(),KE=Date.now()),this.eventSvc.dispatchEvent({type:"tooltipHide",parentGui:this.tooltipCtrl.getGui()}),e&&(this.isInteractingWithTooltip=!1),this.setToDoNothing(!0))}newTooltipComponentCallback(e,t){if(this.state!==2||this.tooltipInstanceCount!==e){this.destroyBean(t);return}let n=t.getGui();this.tooltipComp=t,n.classList.contains("ag-tooltip")||n.classList.add("ag-tooltip-custom"),this.tooltipTrigger===0&&n.classList.add("ag-tooltip-animate"),this.interactionEnabled&&n.classList.add("ag-tooltip-interactive");let o=this.getLocaleTextFunc(),r=this.popupSvc?.addPopup({eChild:n,ariaLabel:o("ariaLabelTooltip","Tooltip")});if(r&&(this.tooltipPopupDestroyFunc=r.hideFunc),this.positionTooltip(),this.tooltipTrigger===1){let s=()=>this.setToDoNothing();[this.onBodyScrollEventCallback]=this.addManagedEventListeners({bodyScroll:s}),this.setEventHandlers(s)}this.interactionEnabled&&([this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener]=this.addManagedElementListeners(n,{mouseenter:this.onTooltipMouseEnter.bind(this),mouseleave:this.onTooltipMouseLeave.bind(this)}),[this.onDocumentKeyDownCallback]=this.addManagedElementListeners(Qt(this.beans),{keydown:s=>{n.contains(s?.target)||this.onKeyDown()}}),this.tooltipTrigger===1&&([this.tooltipFocusInListener,this.tooltipFocusOutListener]=this.addManagedElementListeners(n,{focusin:this.onTooltipFocusIn.bind(this),focusout:this.onTooltipFocusOut.bind(this)}))),this.eventSvc.dispatchEvent({type:"tooltipShow",tooltipGui:n,parentGui:this.tooltipCtrl.getGui()}),this.startHideTimeout()}onTooltipMouseEnter(){this.isInteractingWithTooltip=!0,this.unlockService()}onTooltipMouseLeave(){this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,this.lockService())}onTooltipFocusIn(){this.isInteractingWithTooltip=!0}isTooltipFocused(){let e=this.tooltipComp?.getGui(),t=Ct(this.beans);return!!e&&e.contains(t)}onTooltipFocusOut(e){let t=this.tooltipCtrl.getGui();this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,t.contains(e.relatedTarget)?this.startHideTimeout():this.hideTooltip())}positionTooltip(){let e={type:"tooltip",ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack};this.lastMouseEvent?this.popupSvc?.positionPopupUnderMouseEvent(z(b({},e),{mouseEvent:this.lastMouseEvent})):this.popupSvc?.positionPopupByComponent(z(b({},e),{eventSource:this.tooltipCtrl.getGui(),position:"under",keepWithinBounds:!0,nudgeY:5}))}destroyTooltipComp(){this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");let e=this.tooltipPopupDestroyFunc,t=this.tooltipComp,i=this.tooltipTrigger===0?j9:0;window.setTimeout(()=>{e(),this.destroyBean(t)},i),this.clearTooltipListeners(),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0}clearTooltipListeners(){for(let e of[this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener,this.tooltipFocusInListener,this.tooltipFocusOutListener])e&&e();this.tooltipMouseEnterListener=this.tooltipMouseLeaveListener=this.tooltipFocusInListener=this.tooltipFocusOutListener=null}lockService(){rp=!0,this.interactiveTooltipTimeoutId=window.setTimeout(()=>{this.unlockService(),this.setToDoNothing()},jE)}unlockService(){rp=!1,this.clearInteractiveTimeout()}startHideTimeout(){this.clearHideTimeout(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.getTooltipDelay("hide"))}clearShowTimeout(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0)}clearHideTimeout(){this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)}clearInteractiveTimeout(){this.interactiveTooltipTimeoutId&&(window.clearTimeout(this.interactiveTooltipTimeoutId),this.interactiveTooltipTimeoutId=void 0)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout(),this.clearInteractiveTimeout()}},Y9=class extends gP{constructor(e,t,i){super(e,i),this.highlightTracker=t,this.onHighlight=this.onHighlight.bind(this)}postConstruct(){super.postConstruct(),this.wireHighlightListeners()}wireHighlightListeners(){this.addManagedPropertyListener("tooltipTrigger",({currentValue:e})=>{this.setTooltipMode(e)}),this.setTooltipMode(this.gos.get("tooltipTrigger")),this.highlightTracker.addEventListener("itemHighlighted",this.onHighlight)}onHighlight(e){this.tooltipMode===1&&(e.highlighted?this.attemptToShowTooltip():this.attemptToHideTooltip())}setTooltipMode(e="focus"){this.tooltipMode=e==="focus"?1:0}destroy(){this.highlightTracker.removeEventListener("itemHighlighted",this.onHighlight),super.destroy()}},sp=0,X9=200,J9=class extends yo{constructor(){super(...arguments),this.beanName="popupSvc",this.popupList=[]}getPopupParent(){let e=this.gos.get("popupParent");return e||this.getDefaultPopupParent()}positionPopupUnderMouseEvent(e){let{ePopup:t,nudgeX:i,nudgeY:n,skipObserver:o}=e;this.positionPopup({ePopup:t,nudgeX:i,nudgeY:n,keepWithinBounds:!0,skipObserver:o,updatePosition:()=>this.calculatePointerAlign(e.mouseEvent),postProcessCallback:()=>this.callPostProcessPopup(e,e.type,e.ePopup,null,e.mouseEvent)})}calculatePointerAlign(e){let t=this.getParentRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}positionPopupByComponent(e){let{ePopup:t,nudgeX:i,nudgeY:n,keepWithinBounds:o,eventSource:r,alignSide:s="left",position:a="over",type:l}=e,c=r.getBoundingClientRect(),d=this.getParentRect();this.setAlignedTo(r,t);let u=()=>{let h=c.left-d.left;s==="right"&&(h-=t.offsetWidth-c.width);let p;return a==="over"?(p=c.top-d.top,this.setAlignedStyles(t,"over")):(this.setAlignedStyles(t,"under"),this.shouldRenderUnderOrAbove(t,c,d,e.nudgeY||0)==="under"?p=c.top-d.top+c.height:p=c.top-t.offsetHeight-(n||0)*2-d.top),{x:h,y:p}};this.positionPopup({ePopup:t,nudgeX:i,nudgeY:n,keepWithinBounds:o,updatePosition:u,postProcessCallback:()=>this.callPostProcessPopup(e,l,t,r,null)})}shouldRenderUnderOrAbove(e,t,i,n){let o=i.bottom-t.bottom,r=t.top-i.top,s=e.offsetHeight+n;return o>s?"under":r>s||r>o?"above":"under"}setAlignedStyles(e,t){let i=this.getPopupIndex(e);if(i===-1)return;let n=this.popupList[i],{alignedToElement:o}=n;if(!o)return;let r=["right","left","over","above","under"];for(let s of r)o.classList.remove(`ag-has-popup-positioned-${s}`),e.classList.remove(`ag-popup-positioned-${s}`);t&&(o.classList.add(`ag-has-popup-positioned-${t}`),e.classList.add(`ag-popup-positioned-${t}`))}setAlignedTo(e,t){let i=this.getPopupIndex(t);if(i!==-1){let n=this.popupList[i];n.alignedToElement=e}}positionPopup(e){let{ePopup:t,keepWithinBounds:i,nudgeX:n,nudgeY:o,skipObserver:r,updatePosition:s}=e,a={width:0,height:0},l=(c=!1)=>{let{x:d,y:u}=s();c&&t.clientWidth===a.width&&t.clientHeight===a.height||(a.width=t.clientWidth,a.height=t.clientHeight,n&&(d+=n),o&&(u+=o),i&&(d=this.keepXYWithinBounds(t,d,1),u=this.keepXYWithinBounds(t,u,0)),t.style.left=`${d}px`,t.style.top=`${u}px`,e.postProcessCallback&&e.postProcessCallback())};if(l(),!r){let c=is(this.beans,t,()=>l(!0));setTimeout(()=>c(),X9)}}getParentRect(){let e=Qt(this.beans),t=this.getPopupParent();return t===e.body?t=e.documentElement:getComputedStyle(t).position==="static"&&(t=t.offsetParent),oR(t)}keepXYWithinBounds(e,t,i){let n=i===0,o=n?"clientHeight":"clientWidth",r=n?"top":"left",s=n?"height":"width",a=n?"scrollTop":"scrollLeft",l=Qt(this.beans),c=l.documentElement,d=this.getPopupParent(),u=e.getBoundingClientRect(),h=d.getBoundingClientRect(),p=l.documentElement.getBoundingClientRect(),g=d===l.body,f=Math.ceil(u[s]),v=g?(n?nR:Dp)(c)+c[a]:d[o];g&&(v-=Math.abs(p[r]-h[r]));let C=v-f;return Math.min(Math.max(t,0),Math.max(C,0))}addPopup(e){let{eChild:t,ariaLabel:i,ariaOwns:n,alwaysOnTop:o,positionCallback:r,anchorToElement:s}=e,a=this.getPopupIndex(t);if(a!==-1)return{hideFunc:this.popupList[a].hideFunc};this.initialisePopupPosition(t);let l=this.createPopupWrapper(t,!!o,i,n),c=this.addEventListenersToPopup(z(b({},e),{wrapperEl:l}));return r&&r(),this.addPopupToPopupList(t,l,c,s),{hideFunc:c}}initialisePopupPosition(e){let i=this.getPopupParent().getBoundingClientRect();ie(e.style.top)||(e.style.top=`${i.top*-1}px`),ie(e.style.left)||(e.style.left=`${i.left*-1}px`)}createPopupWrapper(e,t,i,n){let o=this.getPopupParent(),{environment:r,gos:s}=this.beans,a=Rd({tag:"div"});return r.applyThemeClasses(a),a.classList.add("ag-popup"),e.classList.add(s.get("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),e.hasAttribute("role")||Jr(e,"dialog"),i?Sl(e,i):n&&(e.id||(e.id=`popup-component-${sp}`),PE(n,e.id)),a.appendChild(e),o.appendChild(a),t?this.setAlwaysOnTop(e,!0):this.bringPopupToFront(e),a}addEventListenersToPopup(e){let t=this.beans,i=Qt(t),{wrapperEl:n,eChild:o,closedCallback:r,afterGuiAttached:s,closeOnEsc:a,modal:l,ariaOwns:c}=e,d=!1,u=f=>{if(!n.contains(Ct(t)))return;f.key===T.ESCAPE&&!this.isStopPropagation(f)&&g({keyboardEvent:f})},h=f=>g({mouseEvent:f}),p=f=>g({touchEvent:f}),g=(f={})=>{let{mouseEvent:m,touchEvent:v,keyboardEvent:C,forceHide:w}=f;!w&&(this.isEventFromCurrentPopup({mouseEvent:m,touchEvent:v},o)||d)||(d=!0,n.remove(),i.removeEventListener("keydown",u),i.removeEventListener("mousedown",h),i.removeEventListener("touchstart",p),i.removeEventListener("contextmenu",h),this.eventSvc.removeListener("dragStarted",h),r&&r(m||v||C),this.removePopupFromPopupList(o,c))};return s&&s({hidePopup:g}),window.setTimeout(()=>{a&&i.addEventListener("keydown",u),l&&(i.addEventListener("mousedown",h),this.eventSvc.addListener("dragStarted",h),i.addEventListener("touchstart",p),i.addEventListener("contextmenu",h))},0),g}addPopupToPopupList(e,t,i,n){this.popupList.push({element:e,wrapper:t,hideFunc:i,instanceId:sp,isAnchored:!!n}),n&&this.setPopupPositionRelatedToElement(e,n),sp=sp+1}getPopupIndex(e){return this.popupList.findIndex(t=>t.element===e)}setPopupPositionRelatedToElement(e,t){let i=this.getPopupIndex(e);if(i===-1)return;let n=this.popupList[i];if(n.stopAnchoringPromise&&n.stopAnchoringPromise.then(r=>r&&r()),n.stopAnchoringPromise=void 0,n.isAnchored=!1,!t)return;let o=this.keepPopupPositionedRelativeTo({element:t,ePopup:e,hidePopup:n.hideFunc});return n.stopAnchoringPromise=o,n.isAnchored=!0,o}removePopupFromPopupList(e,t){this.setAlignedStyles(e,null),this.setPopupPositionRelatedToElement(e,null),t&&PE(t,null),this.popupList=this.popupList.filter(i=>i.element!==e)}keepPopupPositionedRelativeTo(e){let t=this.getPopupParent(),i=t.getBoundingClientRect(),{element:n,ePopup:o}=e,r=n.getBoundingClientRect(),s=u=>Number.parseInt(u.substring(0,u.length-1),10),a=(u,h)=>{let p=i[u]-r[u],g=s(o.style[u]);return{initialDiff:p,lastDiff:p,initial:g,last:g,direction:h}},l=a("top",0),c=a("left",1),d=this.beans.frameworkOverrides;return new yt(u=>{d.wrapIncoming(()=>{aO(()=>{let h=t.getBoundingClientRect(),p=n.getBoundingClientRect();if(p.top==0&&p.left==0&&p.height==0&&p.width==0){e.hidePopup();return}let f=(m,v)=>{let C=s(o.style[v]);m.last!==C&&(m.initial=C,m.last=C);let w=h[v]-p[v];if(w!=m.lastDiff){let y=this.keepXYWithinBounds(o,m.initial+m.initialDiff-w,m.direction);o.style[v]=`${y}px`,m.last=y}m.lastDiff=w};f(l,"top"),f(c,"left")},200).then(h=>{u(()=>{h!=null&&window.clearInterval(h)})})},"popupPositioning")})}isEventFromCurrentPopup(e,t){let{mouseEvent:i,touchEvent:n}=e,o=i||n;if(!o)return!1;let r=this.getPopupIndex(t);if(r===-1)return!1;for(let s=r;s<this.popupList.length;s++){let a=this.popupList[s];if(q7(a.element,o))return!0}return this.isElementWithinCustomPopup(o.target)}isElementWithinCustomPopup(e){let t=Qt(this.beans);for(;e&&e!==t.body;){if(e.classList.contains("ag-custom-component-popup")||e.parentElement===null)return!0;e=e.parentElement}return!1}getWrapper(e){for(;!e.classList.contains("ag-popup")&&e.parentElement;)e=e.parentElement;return e.classList.contains("ag-popup")?e:null}setAlwaysOnTop(e,t){let i=this.getWrapper(e);i&&(i.classList.toggle("ag-always-on-top",!!t),t&&this.bringPopupToFront(i))}bringPopupToFront(e){let t=this.getPopupParent(),i=Array.prototype.slice.call(t.querySelectorAll(".ag-popup")),n=i.length,o=this.getWrapper(e);if(!o||n<=1||!t.contains(e))return;let r=[],s=[];for(let h of i)h!==o&&(h.classList.contains("ag-always-on-top")?s.push(h):r.push(h));let a=[],l=s.length,u=o.classList.contains("ag-always-on-top")||!l?[...r,...s,o]:[...r,o,...s];for(let h=0;h<=n;h++){let p=u[h];if(i[h]===u[h]||p===o)continue;let g=p.querySelectorAll("div");for(let f of g)f.scrollTop!==0&&a.push([f,f.scrollTop]);h===0?t.insertAdjacentElement("afterbegin",p):u[h-1].insertAdjacentElement("afterend",p)}for(;a.length;){let h=a.pop();h[0].scrollTop=h[1]}}},Q9=class extends ow{constructor(){super({tag:"div",cls:"ag-tooltip"})}init(e){let{value:t}=e,i=this.getGui();i.textContent=Dl(t);let n=e.location.replace(/([a-z])([A-Z0-9])/g,"$1-$2").toLowerCase();i.classList.add(`ag-${n}-tooltip`)}},fP=(e,t)=>{if(t!=null&&e?.setPointerCapture)try{return e.setPointerCapture(t),e.hasPointerCapture(t)}catch{}return!1},Z9=(e,t)=>{if(typeof PointerEvent>"u"||!(t instanceof PointerEvent))return null;let i=t.pointerId;if(!fP(e,i))return null;let n={eElement:e,pointerId:i,onLost(o){tN(n,o)}};return e.addEventListener("lostpointercapture",n.onLost),n},eN=e=>{if(!e)return;mP(e);let{eElement:t,pointerId:i}=e;if(t){try{t.releasePointerCapture(i)}catch{}e.eElement=null}},mP=e=>{let{eElement:t,onLost:i}=e;t&&i&&(t.removeEventListener("lostpointercapture",i),e.onLost=null)},tN=(e,t)=>{mP(e);let{eElement:i,pointerId:n}=e;i&&t.pointerId===n&&fP(i,n)},il,cl,Zo=e=>{if(!cl)cl=new WeakSet;else if(cl.has(e))return!1;return cl.add(e),!0},iN=class extends yo{constructor(){super(...arguments),this.beanName="dragSvc",this.dragging=!1,this.drag=null,this.dragSources=[]}get startTarget(){return this.drag?.start.target??null}isPointer(){return!!il?.has(po(this.beans))}hasPointerCapture(){let e=this.drag?.pointerCapture;return!!(e&&this.beans.eRootDiv.hasPointerCapture?.(e.pointerId))}destroy(){this.drag&&this.cancelDrag();let e=this.dragSources;for(let t of e)YE(t);e.length=0,super.destroy()}removeDragSource(e){let t=this.dragSources;for(let i=0,n=t.length;i<n;++i){let o=t[i];if(o.params===e){t.splice(i,1),YE(o);break}}}addDragSource(e){if(!this.isAlive())return;let{eElement:t,includeTouch:i}=e,n=[],o;if(i){let c=t.style;c&&(o=c.touchAction,c.touchAction="none")}let r={handlers:n,params:e,oldTouchAction:o};this.dragSources.push(r),mp(n,[t,"pointerdown",c=>this.onPointerDown(e,c),{passive:!1}],[t,"mousedown",c=>this.onMouseDown(e,c)]);let l=this.gos.get("suppressTouch");i&&!l&&mp(n,[t,"touchstart",d=>this.onTouchStart(e,d),{passive:!1}])}cancelDrag(e){let t=this.drag;e??(e=t?.eElement),e&&this.eventSvc.dispatchEvent({type:"dragCancelled",target:e}),t?.params.onDragCancel?.(),this.destroyDrag()}shouldPreventMouseEvent(e){let t=e.type;return(t==="mousemove"||t==="pointermove")&&e.cancelable&&md(this.beans,e)&&!nd(Gv(e))}initDrag(e,...t){this.drag=e;let i=this.beans,n=a=>this.onScroll(a),o=a=>this.onKeyDown(a),r=po(i),s=Qt(i);mp(e.handlers,[r,"contextmenu",Kr],[r,"keydown",o],[s,"scroll",n,{capture:!0}],[s.defaultView||window,"scroll",n],...t)}destroyDrag(){this.dragging=!1;let e=this.drag;if(e){let t=e.rootEl;il?.get(t)===e&&il?.delete(t),this.drag=null,eN(e.pointerCapture),JC(e.handlers)}}onPointerDown(e,t){if(this.isPointer())return;let i=this.beans;if(cl?.has(t))return;let n=t.pointerType;if(n==="touch"&&(i.gos.get("suppressTouch")||!e.includeTouch||(e.stopPropagationForTouch&&t.stopPropagation(),nd(Gv(t))))||!t.isPrimary||n==="mouse"&&t.button!==0)return;this.destroyDrag();let o=po(i),r=e.eElement,s=t.pointerId,a=new Vv(o,e,t,s);il??(il=new WeakMap),il.set(o,a);let l=u=>{u.pointerId===s&&this.onMouseOrPointerMove(u)},c=u=>{u.pointerId===s&&this.onMouseOrPointerUp(u)},d=u=>{u.pointerId===s&&Zo(u)&&this.cancelDrag()};this.initDrag(a,[o,"pointerup",c],[o,"pointercancel",d],[o,"pointermove",l,{passive:!1}],[o,"touchmove",Kr,{passive:!1}],[r,"mousemove",Kr,{passive:!1}]),e.dragStartPixels===0?this.onMouseOrPointerMove(t):Zo(t)}onTouchStart(e,t){if(this.gos.get("suppressTouch")||!e.includeTouch||!Zo(t)||nd(Gv(t)))return;if(e.stopPropagationForTouch&&t.stopPropagation(),this.isPointer()){Kr(t);return}this.destroyDrag();let n=this.beans,o=po(n),r=new Vv(o,e,t.touches[0]),s=c=>this.onTouchMove(c),a=c=>this.onTouchUp(c),l=t.target??e.eElement;this.initDrag(r,[po(n),"touchmove",Kr,{passive:!1}],[l,"touchmove",s,{passive:!0}],[l,"touchend",a,{passive:!0}],[l,"touchcancel",a,{passive:!0}]),e.dragStartPixels===0&&this.onMove(r.start)}onMouseDown(e,t){if(t.button!==0||cl?.has(t)||this.isPointer())return;let i=this.beans;this.destroyDrag();let n=new Vv(po(i),e,t),o=a=>this.onMouseOrPointerMove(a),r=a=>this.onMouseOrPointerUp(a),s=po(i);this.initDrag(n,[s,"mousemove",o],[s,"mouseup",r]),e.dragStartPixels===0?this.onMouseOrPointerMove(t):Zo(t)}onScroll(e){if(!Zo(e))return;let t=this.drag,i=t?.lastDrag;i&&this.dragging&&t.params?.onDragging(i)}onMouseOrPointerMove(e){Zo(e)&&(rs()&&Qt(this.beans).getSelection()?.removeAllRanges(),this.shouldPreventMouseEvent(e)&&Kr(e),this.onMove(e))}onTouchMove(e){let t=this.drag;if(!t||!Zo(e))return;let i=rd(t.start,e.touches);i&&(e.preventDefault(),this.onMove(i))}onMove(e){let t=this.drag;if(!t)return;t.lastDrag=e;let i=t.params;if(!this.dragging){let n=t.start,r=i.dragStartPixels??4;if(uR(e,n,r)||(this.dragging=!0,i.capturePointer&&(t.pointerCapture=Z9(this.beans.eRootDiv,e)),this.eventSvc.dispatchEvent({type:"dragStarted",target:i.eElement}),i.onDragStart(n),this.drag!==t)||(i.onDragging(n),this.drag!==t))return}i.onDragging(e)}onTouchUp(e){let t=this.drag;t&&Zo(e)&&this.onUp(rd(t.start,e.changedTouches))}onMouseOrPointerUp(e){Zo(e)&&this.onUp(e)}onUp(e){let t=this.drag;t&&(e||(e=t.lastDrag),e&&this.dragging&&(this.dragging=!1,t.params.onDragStop(e),this.eventSvc.dispatchEvent({type:"dragStopped",target:t.params.eElement})),this.destroyDrag())}onKeyDown(e){e.key===T.ESCAPE&&this.cancelDrag()}},YE=e=>{JC(e.handlers);let t=e.oldTouchAction;if(t!=null){let i=e.params.eElement.style;i&&(i.touchAction=t)}},Vv=class{constructor(e,t,i,n=null){this.rootEl=e,this.params=t,this.start=i,this.pointerId=n,this.handlers=[],this.lastDrag=null,this.pointerCapture=null,this.eElement=t.eElement}},Gv=e=>{let t=e.target;return t instanceof Element?t:null},nN=class extends yo{constructor(){super(...arguments),this.beanName="dragAndDrop",this.dragSourceAndParamsList=[],this.dragItem=null,this.dragInitialSourcePointerOffsetX=0,this.dragInitialSourcePointerOffsetY=0,this.lastMouseEvent=null,this.lastDraggingEvent=null,this.dragSource=null,this.dragImageParent=null,this.dragImageCompPromise=null,this.dragImageComp=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0,this.dropTargets=[],this.lastDropTarget=null}addDragSource(e,t=!1){let i={capturePointer:!0,dragSource:e,eElement:e.eElement,dragStartPixels:e.dragStartPixels,onDragStart:n=>this.onDragStart(e,n),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),onDragCancel:this.onDragCancel.bind(this),includeTouch:t};this.dragSourceAndParamsList.push(i),this.beans.dragSvc.addDragSource(i)}setDragImageCompIcon(e,t=!1){let i=this.dragImageComp;i&&(t||this.dragImageLastIcon!==e)&&(this.dragImageLastIcon=e,i.setIcon(e,t))}removeDragSource(e){let{dragSourceAndParamsList:t,beans:i}=this,n=t.find(o=>o.dragSource===e);n&&(i.dragSvc?.removeDragSource(n),Hn(t,n))}destroy(){let{dragSourceAndParamsList:e,dropTargets:t,beans:i}=this,n=i.dragSvc;for(let o of e)n?.removeDragSource(o);e.length=0,t.length=0,this.clearDragAndDropProperties(),super.destroy()}nudge(){let e=this.lastMouseEvent;e&&this.onDragging(e,!0)}onDragStart(e,t){this.lastMouseEvent=t,this.dragSource=e,this.dragItem=e.getDragItem();let i=e.eElement.getBoundingClientRect();this.dragInitialSourcePointerOffsetX=t.clientX-i.left,this.dragInitialSourcePointerOffsetY=t.clientY-i.top,e.onDragStarted?.(),this.createAndUpdateDragImageComp(e)}onDragStop(e){let{dragSource:t,lastDropTarget:i}=this;if(t?.onDragStopped?.(),i){let n=this.dropTargetEvent(i,e,!1);i.onDragStop?.(n)}this.clearDragAndDropProperties()}onDragCancel(){let{dragSource:e,lastDropTarget:t,lastMouseEvent:i}=this;if(e?.onDragCancelled?.(),t&&i){let n=this.dropTargetEvent(t,i,!1);t.onDragCancel?.(n)}this.clearDragAndDropProperties()}onDragging(e,t=!1){this.positionDragImageComp(e);let i=this.findCurrentDropTarget(e),{lastDropTarget:n,dragSource:o,dragItem:r}=this,s=!1;if(i!==n){if(s=!0,n){let a=this.dropTargetEvent(n,e,t);n.onDragLeave?.(a)}if(n!==null&&!i?this.handleExit(o,r):n===null&&i&&this.handleEnter(o,r),i){let a=this.dropTargetEvent(i,e,t);i.onDragEnter?.(a)}this.lastDropTarget=i}else if(i){let a=this.dropTargetEvent(i,e,t);i.onDragging?.(a),a?.changed&&(s=!0)}this.lastMouseEvent=e,s&&this.updateDragImageComp()}clearDragAndDropProperties(){this.removeDragImageComp(this.dragImageComp),this.dragImageCompPromise=null,this.dragImageParent=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0,this.lastMouseEvent=null,this.lastDraggingEvent=null,this.lastDropTarget=null,this.dragItem=null,this.dragInitialSourcePointerOffsetX=0,this.dragInitialSourcePointerOffsetY=0,this.dragSource=null}getAllContainersFromDropTarget(e){let t=e.getSecondaryContainers?e.getSecondaryContainers():null,i=[[e.getContainer()]];return t?i.concat(t):i}isMouseOnDropTarget(e,t){let i=this.getAllContainersFromDropTarget(t),n=!1,o=(a,l)=>{for(let c of l){let{width:d,height:u,left:h,right:p,top:g,bottom:f}=c.getBoundingClientRect();if(d===0||u===0)return!1;let m=a.clientX>=h&&a.clientX<p,v=a.clientY>=g&&a.clientY<f;if(!m||!v)return!1}return!0};for(let a of i)if(o(e,a)){n=!0;break}let{eElement:r,type:s}=this.dragSource;return t.targetContainsSource&&!t.getContainer().contains(r)?!1:n&&t.isInterestedIn(s,r)}findCurrentDropTarget(e){let t=this.dropTargets.filter(r=>this.isMouseOnDropTarget(e,r)),i=t.length;if(i===0)return null;if(i===1)return t[0];let o=po(this.beans).elementsFromPoint(e.clientX,e.clientY);for(let r of o)for(let s of t)if(this.getAllContainersFromDropTarget(s).flatMap(l=>l).indexOf(r)!==-1)return s;return null}addDropTarget(e){this.dropTargets.push(e)}removeDropTarget(e){this.dropTargets=this.dropTargets.filter(t=>t.getContainer()!==e.getContainer())}hasExternalDropZones(){return this.dropTargets.some(e=>e.external)}findExternalZone(e){return this.dropTargets.find(t=>t.external&&t.getContainer()===e)||null}dropTargetEvent(e,t,i){let{dragSource:n,dragItem:o,lastDraggingEvent:r,lastMouseEvent:s,dragInitialSourcePointerOffsetX:a,dragInitialSourcePointerOffsetY:l}=this,c=e.getContainer(),d=c.getBoundingClientRect(),{clientX:u,clientY:h}=t,p=u-(s?.clientX||0),g=h-(s?.clientY||0),f=this.createEvent({event:t,x:u-d.left,y:h-d.top,vDirection:g>0?"down":g<0?"up":null,hDirection:p<0?"left":p>0?"right":null,initialSourcePointerOffsetX:a,initialSourcePointerOffsetY:l,dragSource:n,fromNudge:i,dragItem:o,dropZoneTarget:c,dropTarget:r?.dropTarget??null,changed:!!r?.changed});return this.lastDraggingEvent=f,f}positionDragImageComp(e){let t=this.dragImageComp?.getGui();t&&X7(t,e,this.beans)}removeDragImageComp(e){this.dragImageComp===e&&(this.dragImageComp=null),e&&(e.getGui()?.remove(),this.destroyBean(e))}createAndUpdateDragImageComp(e){let t=this.createDragImageComp(e)??null;this.dragImageCompPromise=t,t?.then(i=>{if(t!==this.dragImageCompPromise||!this.lastMouseEvent||!this.isAlive()){this.destroyBean(i);return}this.dragImageCompPromise=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0;let n=this.dragImageComp;n!==i&&(this.dragImageComp=i,this.removeDragImageComp(n)),i&&(this.appendDragImageComp(i),this.updateDragImageComp())})}appendDragImageComp(e){let t=e.getGui(),i=t.style;i.position="absolute",i.zIndex="9999",this.beans.dragSvc?.hasPointerCapture()&&(i.pointerEvents="none"),this.gos.setInstanceDomData(t),this.beans.environment.applyThemeClasses(t),i.top="20px",i.left="20px";let n=qC(this.beans);this.dragImageParent=n,n?n.appendChild(t):this.warnNoBody()}updateDragImageComp(){let{dragImageComp:e,dragSource:t,lastDropTarget:i,lastDraggingEvent:n,dragImageLastLabel:o}=this;if(!e)return;this.setDragImageCompIcon(i?.getIconName?.(n)??null);let r=t?.dragItemName;typeof r=="function"&&(r=r(n)),r||(r=""),o!==r&&(this.dragImageLastLabel=r,e.setLabel(r))}};var oN=class extends nN{createEvent(e){return ye(this.gos,e)}createDragImageComp(e){let{gos:t,beans:i}=this;return PO(i.userCompFactory,ye(t,{dragSource:e}))?.newAgStackInstance()}handleEnter(e,t){e?.onGridEnter?.(t)}handleExit(e,t){e?.onGridExit?.(t)}warnNoBody(){W(54)}isDropZoneWithinThisGrid(e){return this.beans.ctrlsSvc.getGridBodyCtrl().eGridBody.contains(e.dropZoneTarget)}registerGridDropTarget(e,t){let i={getContainer:e,isInterestedIn:n=>n===1||n===0,getIconName:()=>"notAllowed"};this.addDropTarget(i),t.addDestroyFunc(()=>this.removeDropTarget(i))}};function vP(e,t){return e+"_"+t}function kt(e){return e instanceof yd}var yd=class extends A{constructor(e,t,i,n){super(),this.providedColumnGroup=e,this.groupId=t,this.partId=i,this.pinned=n,this.isColumn=!1,this.displayedChildren=[],this.autoHeaderHeight=null,this.parent=null,this.colIdSanitised=id(this.getUniqueId())}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}getUniqueId(){return vP(this.groupId,this.partId)}isEmptyGroup(){return this.displayedChildren.length===0}isMoving(){let e=this.getProvidedColumnGroup().getLeafColumns();return!e||e.length===0?!1:e.every(t=>t.isMoving())}checkLeft(){for(let e of this.displayedChildren)kt(e)&&e.checkLeft();if(this.displayedChildren.length>0)if(this.gos.get("enableRtl")){let t=rt(this.displayedChildren).getLeft();this.setLeft(t)}else{let e=this.displayedChildren[0].getLeft();this.setLeft(e)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(e){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchLocalEvent({type:"leftChanged"}))}getPinned(){return this.pinned}getGroupId(){return this.groupId}getPartId(){return this.partId}getActualWidth(){let e=0;for(let t of this.displayedChildren??[])e+=t.getActualWidth();return e}isResizable(){if(!this.displayedChildren)return!1;let e=!1;for(let t of this.displayedChildren)t.isResizable()&&(e=!0);return e}getMinWidth(){let e=0;for(let t of this.displayedChildren)e+=t.getMinWidth();return e}addChild(e){this.children||(this.children=[]),this.children.push(e)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){let e=[];return this.addLeafColumns(e),e}getDisplayedLeafColumns(){let e=[];return this.addDisplayedLeafColumns(e),e}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(e){this.providedColumnGroup.setExpanded(e)}isAutoHeaderHeight(){return!!this.getColGroupDef()?.autoHeaderHeight}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){let t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}addDisplayedLeafColumns(e){for(let t of this.displayedChildren??[])es(t)?e.push(t):kt(t)&&t.addDisplayedLeafColumns(e)}addLeafColumns(e){for(let t of this.children??[])es(t)?e.push(t):kt(t)&&t.addLeafColumns(e)}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){let e=this.getParent();return!this.isPadding()||!e?.isPadding()?0:1+e.getPaddingLevel()}calculateDisplayedColumns(){this.displayedChildren=[];let e=this;for(;e?.isPadding();)e=e.getParent();if(!(e?e.getProvidedColumnGroup().isExpandable():!1)){this.displayedChildren=this.children,this.dispatchLocalEvent({type:"displayedChildrenChanged"});return}for(let i of this.children??[]){if(kt(i)&&!i.displayedChildren?.length)continue;switch(i.getColumnGroupShow()){case"open":e.getProvidedColumnGroup().isExpanded()&&this.displayedChildren.push(i);break;case"closed":e.getProvidedColumnGroup().isExpanded()||this.displayedChildren.push(i);break;default:this.displayedChildren.push(i);break}}this.dispatchLocalEvent({type:"displayedChildrenChanged"})}},PC="row-group-",hw="t-",pw="b-",rN=0,ts=class{constructor(e){this.master=!1,this.detail=void 0,this.rowIndex=null,this.key=null,this.sourceRowIndex=-1,this._leafs=void 0,this.childrenMapped=null,this.treeParent=null,this.treeNodeFlags=0,this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=rN++,this.alreadyRendered=!1,this.hovered=!1,this.__selected=!1,this.beans=e}get allLeafChildren(){let e=this._leafs;return e===void 0?this.beans.groupStage?.loadLeafs?.(this)??null:e}set allLeafChildren(e){this._leafs=e}setData(e){this.setDataCommon(e,!1)}updateData(e){this.setDataCommon(e,!0)}setDataCommon(e,t){let{valueCache:i,eventSvc:n}=this.beans,o=this.data;this.data=e,i?.onDataChanged(),this.updateDataOnDetailNode(),this.resetQuickFilterAggregateText();let r=this.createDataChangedEvent(e,o,t);if(this.__localEventService?.dispatchEvent(r),this.sibling){this.sibling.data=e;let a=this.sibling.createDataChangedEvent(e,o,t);this.sibling.__localEventService?.dispatchEvent(a)}n.dispatchEvent({type:"rowNodeDataChanged",node:this});let s=this.pinnedSibling;s&&(s.data=e,s.__localEventService?.dispatchEvent(s.createDataChangedEvent(e,o,t)),n.dispatchEvent({type:"rowNodeDataChanged",node:s}))}updateDataOnDetailNode(){let e=this.detailNode;e&&(e.data=this.data)}createDataChangedEvent(e,t,i){return{type:"dataChanged",node:this,oldData:t,newData:e,update:i}}getRowIndexString(){return this.rowIndex==null?(tt(13),null):this.rowPinned==="top"?hw+this.rowIndex:this.rowPinned==="bottom"?pw+this.rowIndex:this.rowIndex.toString()}setDataAndId(e,t){let{selectionSvc:i}=this.beans,n=i?.createDaemonNode?.(this),o=this.data;this.data=e,this.updateDataOnDetailNode(),this.setId(t),i&&(i.updateRowSelectable(this),i.syncInRowNode(this,n));let r=this.createDataChangedEvent(e,o,!1);this.__localEventService?.dispatchEvent(r)}setId(e){let t=xl(this.beans.gos);if(t)if(this.data){let i=this.parent?.getRoute()??[];this.id=t({data:this.data,parentKeys:i.length>0?i:void 0,level:this.level,rowPinned:this.rowPinned}),this.id.startsWith(PC)&&tt(14,{groupPrefix:PC})}else this.id=void 0;else this.id=e}setRowTop(e){if(this.oldRowTop=this.rowTop,this.rowTop===e)return;this.rowTop=e,this.dispatchRowEvent("topChanged");let t=e!==null;this.displayed!==t&&(this.displayed=t,this.dispatchRowEvent("displayedChanged"))}clearRowTopAndRowIndex(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}setHovered(e){this.hovered=e}isHovered(){return this.hovered}setRowHeight(e,t=!1){this.rowHeight=e,this.rowHeightEstimated=t,this.dispatchRowEvent("heightChanged")}setExpanded(e,t,i){this.beans.expansionSvc?.setExpanded(this,e,t,i)}setDataValue(e,t,i){let{colModel:n,valueSvc:o,gos:r,editSvc:s}=this.beans,a=typeof e!="string"?e:n.getCol(e)??n.getColDefCol(e);if(!a)return!1;let l=o.getValueForDisplay(a,this,void 0,void 0,"api").value;if(r.get("readOnlyEdit")){let{beans:{eventSvc:d},data:u,rowIndex:h,rowPinned:p}=this;return d.dispatchEvent({type:"cellEditRequest",event:null,rowIndex:h,rowPinned:p,column:a,colDef:a.colDef,data:u,node:this,oldValue:l,newValue:t,value:t,source:i}),!1}if(s&&!s.committing){let d=s.setDataValue({rowNode:this,column:a},t,i);if(d!=null)return d}let c=o.setValue(this,a,t,i);return this.dispatchCellChangedEvent(a,t,l),c&&this.pinnedSibling?.dispatchCellChangedEvent(a,t,l),c}updateHasChildren(){let e=this.group&&!this.footer||!!this.childrenAfterGroup?.length,{rowChildrenSvc:t}=this.beans;t&&(e=t.getHasChildrenValue(this)),e!==this.__hasChildren&&(this.__hasChildren=!!e,this.dispatchRowEvent("hasChildrenChanged"))}hasChildren(){return this.__hasChildren==null&&this.updateHasChildren(),this.__hasChildren}dispatchCellChangedEvent(e,t,i){let n={type:"cellChanged",node:this,column:e,newValue:t,oldValue:i};this.__localEventService?.dispatchEvent(n)}resetQuickFilterAggregateText(){this.quickFilterAggregateText=null}isExpandable(){return this.beans.expansionSvc?.isExpandable(this)??!1}isSelected(){if(this.footer)return this.sibling.isSelected();let e=this.rowPinned&&this.pinnedSibling;return e?e.isSelected():this.__selected}depthFirstSearch(e){let t=this.childrenAfterGroup;if(t)for(let i=0,n=t.length;i<n;++i)t[i].depthFirstSearch(e);e(this)}dispatchRowEvent(e){this.__localEventService?.dispatchEvent({type:e,node:this})}setSelected(e,t=!1,i="api"){this.beans.selectionSvc?.setNodesSelected({nodes:[this],newValue:e,clearSelection:t,source:i})}isRowPinned(){return!!this.rowPinned}__addEventListener(e,t){(this.__localEventService??(this.__localEventService=new ra)).addEventListener(e,t)}__removeEventListener(e,t){this.removeLocalListener(e,t)}addEventListener(e,t){this.beans.validation?.checkRowEvents(e);let i=this.__localEventService??(this.__localEventService=new ra);this.frameworkEventListenerService=this.beans.frameworkOverrides.createLocalEventListenerWrapper?.(this.frameworkEventListenerService,i);let n=this.frameworkEventListenerService?.wrap(e,t)??t;i.addEventListener(e,n)}removeEventListener(e,t){let i=this.frameworkEventListenerService?.unwrap(e,t)??t;this.removeLocalListener(e,i)}removeLocalListener(e,t){let i=this.__localEventService;i&&(i.removeEventListener(e,t),i.noRegisteredListenersExist()&&(this.__localEventService=null))}isFullWidthCell(){if(W(61),this.detail)return!0;let e=this.beans.gos.getCallback("isFullWidthRow");return e?e({rowNode:this}):!1}getRoute(){if(this.level===-1)return[];if(this.key==null)return;let e=[],t=this;for(;t?.key!=null;)e.push(t.key),t=t.parent;return e.reverse()}setRowIndex(e){this.rowIndex!==e&&(this.rowIndex=e,this.dispatchRowEvent("rowIndexChanged"))}setAllChildrenCount(e){this.allChildrenCount!==e&&(this.allChildrenCount=e,this.dispatchRowEvent("allChildrenCountChanged"))}setUiLevel(e){this.uiLevel!==e&&(this.uiLevel=e,this.dispatchRowEvent("uiLevelChanged"))}getFirstChild(){let e=this.childStore;return e?e.getFirstNode():this.childrenAfterSort?.[0]??null}};function sN(e,t,i){return ye(t,{type:i,node:e,data:e.data,rowIndex:e.rowIndex,rowPinned:e.rowPinned})}var aN=new Set(["__autoHeights","__checkAutoHeightsDebounced","__localEventService","__objectId","_leafs","childStore","oldRowTop","sticky","treeNodeFlags","treeParent"]),lN=(e,t)=>{let i=new ts(t);for(let n of Object.keys(e))aN.has(n)||(i[n]=e[n]);return i.oldRowTop=null,i},CP=e=>{for(;e?.length;){let t=e[0];if(t.data)return t;e=t.childrenAfterGroup}},wP={agSetColumnFilter:"agSetColumnFilterHandler",agMultiColumnFilter:"agMultiColumnFilterHandler",agGroupColumnFilter:"agGroupColumnFilterHandler",agNumberColumnFilter:"agNumberColumnFilterHandler",agDateColumnFilter:"agDateColumnFilterHandler",agTextColumnFilter:"agTextColumnFilterHandler"},cN=new Set(Object.values(wP));function qr(e,t){let i=e.filterUi;if(!i)return null;if(i.created)return i.promise;if(t)return null;let n=i.create(i.refreshed),o=i;return o.created=!0,o.promise=n,n}function dN(e,t,i,n,o,r,s){return t.refresh?.(z(b({},i),{model:n,source:r,additionalEventAttributes:s})),e().then(a=>{if(a){let{filter:l,filterParams:c}=a;bP(l,c,n,o,r,s)}})}function bP(e,t,i,n,o,r){e?.refresh?.(z(b({},t),{model:i,state:n,source:o,additionalEventAttributes:r}))}function yP(e,t,i){let n=e();n?.created&&n.promise.then(o=>{let r=t();bP(o,n.filterParams,r,i()??{model:r},"ui")})}function XE(e,t,i,n,o,r,s){let a,l=!1,c;switch(e){case"apply":{let d=n();c=d?.model??null,s&&(c=s(c)),a={state:d?.state,model:c},l=!0;break}case"clear":{a={model:null};break}case"reset":{a={model:null},l=!0,c=null;break}case"cancel":{a={model:i()};break}}o(a),l?r(c):yP(t,i,n)}function Jt(e,t){return e[t]??null}function Ft(e){return Rd(e)}function uN(e){return{tag:"div",cls:e}}var hN=class extends je{constructor(e){let{className:t="ag-filter-apply-panel"}=e??{};super(uN(t)),this.listeners=[],this.validationMessage=null,this.className=t}updateButtons(e,t){let i=this.buttons;if(this.buttons=e,i===e)return;let n=this.getGui();ai(n);let o;this.destroyListeners();let r=document.createDocumentFragment(),s=this.className,a=({type:c,label:d})=>{let u=v=>{this.dispatchLocalEvent({type:c,event:v})};["apply","clear","reset","cancel"].includes(c)||W(75);let h=c==="apply",g=Ft({tag:"button",attrs:{type:h&&t?"submit":"button"},ref:`${c}FilterButton`,cls:`ag-button ag-standard-button ${s}-button${h?" "+s+"-apply-button":""}`,children:d});this.activateTabIndex([g]),h&&(o=g);let f=v=>{v.key===T.ENTER&&(v.preventDefault(),u(v))},m=this.listeners;g.addEventListener("click",u),m.push(()=>g.removeEventListener("click",u)),g.addEventListener("keydown",f),m.push(()=>g.removeEventListener("keydown",f)),r.append(g)};for(let c of e)a(c);this.eApply=o;let l=this.validationTooltipFeature;o&&!l?this.validationTooltipFeature=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.eApply,getLocation:()=>"advancedFilter",getTooltipShowDelayOverride:()=>1e3})):!o&&l&&(this.validationTooltipFeature=this.destroyBean(l)),n.append(r)}getApplyButton(){return this.eApply}updateValidity(e,t=null){let i=this.eApply;i&&(gd(i,e===!1),this.validationMessage=t??null,this.validationTooltipFeature?.setTooltipAndRefresh(this.validationMessage))}destroyListeners(){for(let e of this.listeners)e();this.listeners=[]}destroy(){this.destroyListeners(),super.destroy()}};var pN={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose one",equals:"Equals",notEqual:"Does not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"Between",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equal to",greaterThanOrEqual:"Greater than or equal to",contains:"Contains",notContains:"Does not contain",startsWith:"Begins with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",before:"Before",after:"After",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd",filterSummaryInactive:"is (All)",filterSummaryContains:"contains",filterSummaryNotContains:"does not contain",filterSummaryTextEquals:"equals",filterSummaryTextNotEqual:"does not equal",filterSummaryStartsWith:"begins with",filterSummaryEndsWith:"ends with",filterSummaryBlank:"is blank",filterSummaryNotBlank:"is not blank",filterSummaryEquals:"=",filterSummaryNotEqual:"!=",filterSummaryGreaterThan:">",filterSummaryGreaterThanOrEqual:">=",filterSummaryLessThan:"<",filterSummaryLessThanOrEqual:"<=",filterSummaryInRange:"between",filterSummaryInRangeValues:e=>`(${e[0]}, ${e[1]})`,filterSummaryTextQuote:e=>`"${e[0]}"`};function Xr(e,t,i){return Q7(e,pN,t,i)}function gw(e,t){let{debounceMs:i}=e;return tg(e)?(i!=null&&W(71),0):i??t}function tg(e){return(e.buttons?.indexOf("apply")??-1)>=0}var gN=class extends je{constructor(e,t,i,n,o,r){super(),this.column=e,this.wrapper=t,this.eventParent=i,this.updateModel=n,this.isGlobalButtons=o,this.enableGlobalButtonCheck=r,this.hidePopup=null,this.applyActive=!1}postConstruct(){let{comp:e,params:t}=this.wrapper,i=t,n=i.useForm,o=n?"form":"div";this.setTemplate({tag:o,cls:"ag-filter-wrapper"}),n&&this.addManagedElementListeners(this.getGui(),{submit:r=>{r?.preventDefault()},keydown:this.handleKeyDown.bind(this)}),this.appendChild(e.getGui()),this.params=i,this.resetButtonsPanel(i),this.addManagedListeners(this.eventParent,b({filterParamsChanged:({column:r,params:s})=>{r===this.column&&this.resetButtonsPanel(s,this.params)},filterStateChanged:({column:r,state:s})=>{r===this.column&&this.eButtons?.updateValidity(s.valid!==!1)},filterAction:({column:r,action:s,event:a})=>{r===this.column&&this.afterAction(s,a)}},this.enableGlobalButtonCheck?{filterGlobalButtons:({isGlobal:r})=>{if(r!==this.isGlobalButtons){this.isGlobalButtons=r;let s=this.params;this.resetButtonsPanel(s,s,!0)}}}:void 0))}afterGuiAttached(e){e&&(this.hidePopup=e.hidePopup)}resetButtonsPanel(e,t,i){let{buttons:n,readOnly:o}=t??{},{buttons:r,readOnly:s,useForm:a}=e;if(!i&&o===s&&hd(n,r))return;let l=r&&r.length>0&&!e.readOnly&&!this.isGlobalButtons,c=this.eButtons;if(l){let d=r.map(u=>{let h=`${u}Filter`;return{type:u,label:Xr(this,h)}});if(this.applyActive=tg(this.params),!c){c=this.createBean(new hN),this.appendChild(c.getGui());let u=this.column,h=p=>({event:g})=>{this.updateModel(u,p,{fromButtons:!0}),this.afterAction(p,g)};c?.addManagedListeners(c,{apply:h("apply"),clear:h("clear"),reset:h("reset"),cancel:h("cancel")}),this.eButtons=c}c.updateButtons(d,a)}else this.applyActive=!1,c&&(zi(c.getGui()),this.eButtons=this.destroyBean(c))}close(e){let t=this.hidePopup;if(!t)return;let i=e,n=i?.key,o;(n===T.ENTER||n===T.SPACE)&&(o={keyboardEvent:i}),t(o),this.hidePopup=null}afterAction(e,t){let{params:i,applyActive:n}=this,o=i?.closeOnApply;switch(e){case"apply":{t?.preventDefault(),o&&n&&this.close(t);break}case"reset":{o&&n&&this.close();break}case"cancel":{o&&this.close(t);break}}}handleKeyDown(e){!e.defaultPrevented&&e.key===T.ENTER&&this.applyActive&&(this.updateModel(this.column,"apply",{fromButtons:!0}),this.afterAction("apply",e))}destroy(){this.hidePopup=null,this.eButtons=this.destroyBean(this.eButtons)}},fN={tag:"div",cls:"ag-filter"},mN=class extends je{constructor(e,t,i){super(fN),this.column=e,this.source=t,this.enableGlobalButtonCheck=i,this.wrapper=null}postConstruct(){this.beans.colFilter?.activeFilterComps.add(this),this.createFilter(!0),this.addManagedEventListeners({filterDestroyed:this.onFilterDestroyed.bind(this)})}hasFilter(){return this.wrapper!=null}getFilter(){return this.wrapper?.then(e=>e.comp)??null}afterInit(){return this.wrapper?.then(()=>{})??yt.resolve()}afterGuiAttached(e){this.afterGuiAttachedParams=e,this.wrapper?.then(t=>{this.comp?.afterGuiAttached(e),t?.comp?.afterGuiAttached?.(e)})}afterGuiDetached(){this.wrapper?.then(e=>{e?.comp?.afterGuiDetached?.()})}createFilter(e){let{column:t,source:i,beans:{colFilter:n}}=this,o=n.getFilterUiForDisplay(t)??null;this.wrapper=o,o?.then(r=>{if(!r)return;let{isHandler:s,comp:a}=r,l;if(s){let c=!!this.enableGlobalButtonCheck,d=this.createBean(new gN(t,r,n,n.updateModel.bind(n),c&&n.isGlobalButtons,c));this.comp=d,l=d.getGui()}else l=a.getGui(),ie(l)||W(69,{guiFromFilter:l});this.appendChild(l),e?this.eventSvc.dispatchEvent({type:"filterOpened",column:t,source:i,eGui:this.getGui()}):a.afterGuiAttached?.(this.afterGuiAttachedParams)})}onFilterDestroyed(e){let{source:t,column:i}=e;(t==="api"||t==="paramsUpdated")&&i.getId()===this.column.getId()&&this.beans.colModel.getColDefCol(this.column)&&(ai(this.getGui()),this.comp=this.destroyBean(this.comp),this.createFilter())}destroy(){this.beans.colFilter?.activeFilterComps.delete(this),this.eventSvc.dispatchEvent({type:"filterClosed",column:this.column}),this.wrapper=null,this.comp=this.destroyBean(this.comp),this.afterGuiAttachedParams=void 0,super.destroy()}},JE={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},QE=["january","february","march","april","may","june","july","august","september","october","november","december"];function vN(e,t){return e==null?-1:t==null?1:Number.parseFloat(e)-Number.parseFloat(t)}function ZE(e){return e instanceof Date&&!isNaN(e.getTime())}var DC={number:()=>{},boolean:()=>({maxNumConditions:1,debounceMs:0,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:(e,t)=>t,numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:(e,t)=>t===!1,numberOfInputs:0}]}),date:()=>({isValidDate:ZE}),dateString:({dataTypeDefinition:e})=>({comparator:(t,i)=>{let n=e.dateParser(i);return i==null||n<t?-1:n>t?1:0},isValidDate:t=>typeof t=="string"&&ZE(e.dateParser(t))}),dateTime:e=>DC.date(e),dateTimeString:e=>DC.dateString(e),object:()=>{},text:()=>{}},MC={number:()=>({comparator:vN}),boolean:({t:e})=>({valueFormatter:t=>ie(t.value)?e(String(t.value),t.value?"True":"False"):e("blanks","(Blanks)")}),date:({formatValue:e,t})=>({valueFormatter:i=>{let n=e(i);return ie(n)?n:t("blanks","(Blanks)")},treeList:!0,treeListFormatter:(i,n)=>{if(i==="NaN")return t("invalidDate","Invalid Date");if(n===1&&i!=null){let o=QE[Number(i)-1];return t(o,JE[o])}return i??t("blanks","(Blanks)")},treeListPathGetter:i=>op(i,!1)}),dateString:({formatValue:e,dataTypeDefinition:t,t:i})=>({valueFormatter:n=>{let o=e(n);return ie(o)?o:i("blanks","(Blanks)")},treeList:!0,treeListPathGetter:n=>op(t.dateParser(n??void 0),!1),treeListFormatter:(n,o)=>{if(o===1&&n!=null){let r=QE[Number(n)-1];return i(r,JE[r])}return n??i("blanks","(Blanks)")}}),dateTime:e=>{let t=MC.date(e);return t.treeListPathGetter=op,t},dateTimeString(e){let t=e.dataTypeDefinition.dateParser,i=MC.dateString(e);return i.treeListPathGetter=n=>op(t(n??void 0)),i},object:({formatValue:e,t})=>({valueFormatter:i=>{let n=e(i);return ie(n)?n:t("blanks","(Blanks)")}}),text:()=>{}};function CN(e,t,i,n,o,r,s){let a=t,l=i,c=e==="agSetColumnFilter";!l&&n.baseDataType==="object"&&!c&&(l=({column:p,node:g})=>o({column:p,node:g,value:r.valueSvc.getValue(p,g)}));let u=(c?MC:DC)[n.baseDataType],h=u({dataTypeDefinition:n,formatValue:o,t:s});return a=typeof t=="object"?b(b({},h),t):h,{filterParams:a,filterValueGetter:l}}var wN={boolean:"agTextColumnFilter",date:"agDateColumnFilter",dateString:"agDateColumnFilter",dateTime:"agDateColumnFilter",dateTimeString:"agDateColumnFilter",number:"agNumberColumnFilter",object:"agTextColumnFilter",text:"agTextColumnFilter"},bN={boolean:"agTextColumnFloatingFilter",date:"agDateColumnFloatingFilter",dateString:"agDateColumnFloatingFilter",dateTime:"agDateColumnFloatingFilter",dateTimeString:"agDateColumnFloatingFilter",number:"agNumberColumnFloatingFilter",object:"agTextColumnFloatingFilter",text:"agTextColumnFloatingFilter"};function yN(e,t=!1){return(t?bN:wN)[e??"text"]}var SP="ag-resizer-wrapper",$r=(e,t)=>({tag:"div",ref:`${e}Resizer`,cls:`ag-resizer ag-resizer-${t}`}),SN={tag:"div",cls:SP,children:[$r("eTopLeft","topLeft"),$r("eTop","top"),$r("eTopRight","topRight"),$r("eRight","right"),$r("eBottomRight","bottomRight"),$r("eBottom","bottom"),$r("eBottomLeft","bottomLeft"),$r("eLeft","left")]},xN=class extends A{constructor(e,t){super(),this.element=e,this.dragStartPosition={x:0,y:0},this.position={x:0,y:0},this.lastSize={width:-1,height:-1},this.positioned=!1,this.resizersAdded=!1,this.resizeListeners=[],this.boundaryEl=null,this.isResizing=!1,this.isMoving=!1,this.resizable={},this.movable=!1,this.currentResizer=null,this.config=Object.assign({},{popup:!1},t)}wireBeans(e){this.popupSvc=e.popupSvc,this.dragSvc=e.dragSvc}center(e){let{clientHeight:t,clientWidth:i}=this.offsetParent,n=i/2-this.getWidth()/2,o=t/2-this.getHeight()/2;this.offsetElement(n,o,e)}initialisePosition(e){if(this.positioned)return;let{centered:t,forcePopupParentAsOffsetParent:i,minWidth:n,width:o,minHeight:r,height:s,x:a,y:l}=this.config;this.offsetParent||this.setOffsetParent();let c=0,d=0,u=bo(this.element);if(u){let h=this.findBoundaryElement(),p=window.getComputedStyle(h);if(p.minWidth!=null){let g=h.offsetWidth-this.element.offsetWidth;d=Number.parseInt(p.minWidth,10)-g}if(p.minHeight!=null){let g=h.offsetHeight-this.element.offsetHeight;c=Number.parseInt(p.minHeight,10)-g}}if(this.minHeight=r||c,this.minWidth=n||d,o&&this.setWidth(o),s&&this.setHeight(s),(!o||!s)&&this.refreshSize(),t)this.center(e);else if(a||l)this.offsetElement(a,l,e);else if(u&&i){let h=this.boundaryEl,p=!0;if(h||(h=this.findBoundaryElement(),p=!1),h){let g=Number.parseFloat(h.style.top),f=Number.parseFloat(h.style.left);p?this.offsetElement(isNaN(f)?0:f,isNaN(g)?0:g,e):this.setPosition(f,g)}}this.positioned=!!this.offsetParent}isPositioned(){return this.positioned}getPosition(){return this.position}setMovable(e,t){if(!this.config.popup||e===this.movable)return;this.movable=e;let i=this.moveElementDragListener||{eElement:t,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};e?(this.dragSvc?.addDragSource(i),this.moveElementDragListener=i):(this.dragSvc?.removeDragSource(i),this.moveElementDragListener=void 0)}setResizable(e){if(this.clearResizeListeners(),e?this.addResizers():this.removeResizers(),typeof e=="boolean"){if(e===!1)return;e={topLeft:e,top:e,topRight:e,right:e,bottomRight:e,bottom:e,bottomLeft:e,left:e}}Object.keys(e).forEach(t=>{let n=!!e[t],o=this.getResizerElement(t),r={dragStartPixels:0,eElement:o,onDragStart:s=>this.onResizeStart(s,t),onDragging:this.onResize.bind(this),onDragStop:s=>this.onResizeEnd(s,t)};(n||!this.isAlive()&&!n)&&(n?(this.dragSvc?.addDragSource(r),this.resizeListeners.push(r),o.style.pointerEvents="all"):o.style.pointerEvents="none",this.resizable[t]=n)})}removeSizeFromEl(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}restoreLastSize(){this.element.style.flex="0 0 auto";let{height:e,width:t}=this.lastSize;t!==-1&&(this.element.style.width=`${t}px`),e!==-1&&(this.element.style.height=`${e}px`)}getHeight(){return this.element.offsetHeight}setHeight(e){let{popup:t}=this.config,i=this.element,n=!1;if(typeof e=="string"&&e.includes("%"))od(i,e),e=nR(i),n=!0;else if(e=Math.max(this.minHeight,e),this.positioned){let o=this.getAvailableHeight();o&&e>o&&(e=o)}this.getHeight()!==e&&(n?(i.style.maxHeight="unset",i.style.minHeight="unset"):t?od(i,e):(i.style.height=`${e}px`,i.style.flex="0 0 auto",this.lastSize.height=typeof e=="number"?e:Number.parseFloat(e)))}getAvailableHeight(){let{popup:e,forcePopupParentAsOffsetParent:t}=this.config;this.positioned||this.initialisePosition();let{clientHeight:i}=this.offsetParent;if(!i)return null;let n=this.element.getBoundingClientRect(),o=this.offsetParent.getBoundingClientRect(),r=e?this.position.y:n.top,s=e?0:o.top,a=0;if(t){let c=this.element.parentElement;if(c){let{bottom:d}=c.getBoundingClientRect();a=d-n.bottom}}return i+s-r-a}getWidth(){return this.element.offsetWidth}setWidth(e){let t=this.element,{popup:i}=this.config,n=!1;if(typeof e=="string"&&e.includes("%"))vo(t,e),e=Dp(t),n=!0;else if(this.positioned){e=Math.max(this.minWidth,e);let{clientWidth:o}=this.offsetParent,r=i?this.position.x:this.element.getBoundingClientRect().left;o&&e+r>o&&(e=o-r)}this.getWidth()!==e&&(n?(t.style.maxWidth="unset",t.style.minWidth="unset"):this.config.popup?vo(t,e):(t.style.width=`${e}px`,t.style.flex=" unset",this.lastSize.width=typeof e=="number"?e:Number.parseFloat(e)))}offsetElement(e=0,t=0,i){let{forcePopupParentAsOffsetParent:n}=this.config,o=n?this.boundaryEl:this.element;o&&(this.popupSvc?.positionPopup({ePopup:o,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:()=>({x:e,y:t}),postProcessCallback:i}),this.setPosition(Number.parseFloat(o.style.left),Number.parseFloat(o.style.top)))}constrainSizeToAvailableHeight(e){if(!this.config.forcePopupParentAsOffsetParent)return;let t=()=>{let i=this.getAvailableHeight();this.element.style.setProperty("max-height",`${i}px`)};e&&this.popupSvc?(this.resizeObserverSubscriber?.(),this.resizeObserverSubscriber=is(this.beans,this.popupSvc?.getPopupParent(),t)):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}setPosition(e,t){this.position.x=e,this.position.y=t}updateDragStartPosition(e,t){this.dragStartPosition={x:e,y:t}}calculateMouseMovement(e){let{e:t,isLeft:i,isTop:n,anywhereWithin:o,topBuffer:r}=e,s=t.clientX-this.dragStartPosition.x,a=t.clientY-this.dragStartPosition.y,l=this.shouldSkipX(t,!!i,!!o,s)?0:s,c=this.shouldSkipY(t,!!n,r,a)?0:a;return{movementX:l,movementY:c}}shouldSkipX(e,t,i,n){let o=this.element.getBoundingClientRect(),r=this.offsetParent.getBoundingClientRect(),s=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.x:o.left,l=a<=0&&r.left>=e.clientX||r.right<=e.clientX&&r.right<=s.right;return l?!0:(t?l=n<0&&e.clientX>a+r.left||n>0&&e.clientX<a+r.left:i?l=n<0&&e.clientX>s.right||n>0&&e.clientX<a+r.left:l=n<0&&e.clientX>s.right||n>0&&e.clientX<s.right,l)}shouldSkipY(e,t,i=0,n){let o=this.element.getBoundingClientRect(),r=this.offsetParent.getBoundingClientRect(),s=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.y:o.top,l=a<=0&&r.top>=e.clientY||r.bottom<=e.clientY&&r.bottom<=s.bottom;return l?!0:(t?l=n<0&&e.clientY>a+r.top+i||n>0&&e.clientY<a+r.top:l=n<0&&e.clientY>s.bottom||n>0&&e.clientY<s.bottom,l)}createResizeMap(){let e=t=>({element:this.element.querySelector(`[data-ref=${t}Resizer]`)});this.resizerMap={topLeft:e("eTopLeft"),top:e("eTop"),topRight:e("eTopRight"),right:e("eRight"),bottomRight:e("eBottomRight"),bottom:e("eBottom"),bottomLeft:e("eBottomLeft"),left:e("eLeft")}}addResizers(){if(this.resizersAdded)return;let e=this.element;e&&(e.appendChild(Ft(SN)),this.createResizeMap(),this.resizersAdded=!0)}removeResizers(){this.resizerMap=void 0,this.element.querySelector(`.${SP}`)?.remove(),this.resizersAdded=!1}getResizerElement(e){return this.resizerMap[e].element}onResizeStart(e,t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!t.match(/top/i),isRight:!!t.match(/right/i),isBottom:!!t.match(/bottom/i),isLeft:!!t.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[t].element.classList.add("ag-active");let{popup:i,forcePopupParentAsOffsetParent:n}=this.config;!i&&!n&&this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)}getSiblings(){let t=this.element.parentElement;return t?Array.prototype.slice.call(t.children).filter(i=>!i.classList.contains("ag-hidden")):null}getMinSizeOfSiblings(){let e=this.getSiblings()||[],t=0,i=0;for(let n=0;n<e.length;n++){let o=e[n],r=!!o.style.flex&&o.style.flex!=="0 0 auto";if(o===this.element)continue;let s=this.minHeight||0,a=this.minWidth||0;if(r){let l=window.getComputedStyle(o);l.minHeight&&(s=Number.parseInt(l.minHeight,10)),l.minWidth&&(a=Number.parseInt(l.minWidth,10))}else s=o.offsetHeight,a=o.offsetWidth;t+=s,i+=a}return{height:t,width:i}}applySizeToSiblings(e){let t=null,i=this.getSiblings();if(i){for(let n=0;n<i.length;n++){let o=i[n];o!==t&&(e?o.style.height=`${o.offsetHeight}px`:o.style.width=`${o.offsetWidth}px`,o.style.flex="0 0 auto",o===this.element&&(t=i[n+1]))}t&&(t.style.removeProperty("height"),t.style.removeProperty("min-height"),t.style.removeProperty("max-height"),t.style.flex="1 1 auto")}}isResizable(){return Object.values(this.resizable).some(e=>e)}onResize(e){if(!this.isResizing||!this.currentResizer)return;let{popup:t,forcePopupParentAsOffsetParent:i}=this.config,{isTop:n,isRight:o,isBottom:r,isLeft:s}=this.currentResizer,a=o||s,l=r||n,{movementX:c,movementY:d}=this.calculateMouseMovement({e,isLeft:s,isTop:n}),u=this.position.x,h=this.position.y,p=0,g=0;if(a&&c){let f=s?-1:1,m=this.getWidth(),v=m+c*f,C=!1;s&&(p=m-v,(u+p<=0||v<=this.minWidth)&&(C=!0,p=0)),C||this.setWidth(v)}if(l&&d){let f=n?-1:1,m=this.getHeight(),v=m+d*f,C=!1;n?(g=m-v,(h+g<=0||v<=this.minHeight)&&(C=!0,g=0)):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&m<v&&this.getMinSizeOfSiblings().height+v>this.element.parentElement.offsetHeight&&(C=!0),C||this.setHeight(v)}this.updateDragStartPosition(e.clientX,e.clientY),((t||i)&&p||g)&&this.offsetElement(u+p,h+g)}onResizeEnd(e,t){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null,this.element.classList.remove("ag-resizing"),this.resizerMap[t].element.classList.remove("ag-active"),this.dispatchLocalEvent({type:"resize"})}refreshSize(){let e=this.element;this.config.popup&&(this.config.width||this.setWidth(e.offsetWidth),this.config.height||this.setHeight(e.offsetHeight))}onMoveStart(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)}onMove(e){if(!this.isMoving)return;let{x:t,y:i}=this.position,n;this.config.calculateTopBuffer&&(n=this.config.calculateTopBuffer());let{movementX:o,movementY:r}=this.calculateMouseMovement({e,isTop:!0,anywhereWithin:!0,topBuffer:n});this.offsetElement(t+o,i+r),this.updateDragStartPosition(e.clientX,e.clientY)}onMoveEnd(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}setOffsetParent(){this.config.forcePopupParentAsOffsetParent&&this.popupSvc?this.offsetParent=this.popupSvc.getPopupParent():this.offsetParent=this.element.offsetParent}findBoundaryElement(){let e=this.element;for(;e;){if(window.getComputedStyle(e).position!=="static")return e;e=e.parentElement}return this.element}clearResizeListeners(){for(;this.resizeListeners.length;){let e=this.resizeListeners.pop();this.dragSvc?.removeDragSource(e)}}destroy(){super.destroy(),this.moveElementDragListener&&this.dragSvc?.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}},xP="__ag_Grid_Stop_Propagation";function la(e){e[xP]=!0}function sr(e){return e[xP]===!0}var EN="ag-focus-managed",kl=class extends A{constructor(e,t={}){super(),this.eFocusable=e,this.callbacks=t,this.callbacks=b({shouldStopEventPropagation:()=>!1,onTabKeyDown:i=>{if(i.defaultPrevented)return;let n=ha(this.beans,this.eFocusable,!1,i.shiftKey);n&&(n.focus(),i.preventDefault())}},t)}postConstruct(){let{eFocusable:e,callbacks:{onFocusIn:t,onFocusOut:i}}=this;e.classList.add(EN),this.addKeyDownListeners(e),t&&this.addManagedElementListeners(e,{focusin:t}),i&&this.addManagedElementListeners(e,{focusout:i})}addKeyDownListeners(e){this.addManagedElementListeners(e,{keydown:t=>{if(t.defaultPrevented||sr(t))return;let{callbacks:i}=this;if(i.shouldStopEventPropagation(t)){la(t);return}t.key===T.TAB?i.onTabKeyDown(t):i.handleKeyDown&&i.handleKeyDown(t)}})}},_N=class extends je{constructor(e,t){super(),this.filterNameKey=e,this.cssIdentifier=t,this.applyActive=!1,this.debouncePending=!1,this.defaultDebounceMs=0}postConstruct(){let e={tag:"div",cls:`ag-filter-body-wrapper ag-${this.cssIdentifier}-body-wrapper`,children:[this.createBodyTemplate()]};this.setTemplate(e,this.getAgComponents()),this.createManagedBean(new kl(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=this.createBean(new xN(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}))}handleKeyDown(e){}init(e){let t=e;this.setParams(t),this.setModelIntoUi(t.state.model,!0).then(()=>this.updateUiVisibility())}refresh(e){let t=e,i=this.params;this.params=t,t.source==="colDef"&&this.updateParams(t,i);let o=t.state,r=this.state;return this.state=o,(o.model!==r.model||o.state!==r.state)&&this.setModelIntoUi(o.model),!0}setParams(e){this.params=e,this.state=e.state,this.commonUpdateParams(e)}updateParams(e,t){this.commonUpdateParams(e,t)}commonUpdateParams(e,t){this.applyActive=tg(e),this.setupApplyDebounced()}doesFilterPass(e){W(283);let{getHandler:t,model:i,column:n}=this.params;return t().doesFilterPass(z(b({},e),{model:i,handlerParams:this.beans.colFilter.getHandlerParams(n)}))}getFilterTitle(){return this.translate(this.filterNameKey)}isFilterActive(){return W(284),this.params.model!=null}setupApplyDebounced(){let e=gw(this.params,this.defaultDebounceMs),t=si(this,this.checkApplyDebounce.bind(this),e);this.applyDebounced=()=>{this.debouncePending=!0,t()}}checkApplyDebounce(){this.debouncePending&&(this.debouncePending=!1,this.doApplyModel())}getModel(){return W(285),this.params.model}setModel(e){W(286);let{beans:t,params:i}=this;return t.colFilter.setModelForColumnLegacy(i.column,e)}applyModel(e="api"){return this.doApplyModel()}canApply(e){return!0}doApplyModel(e){let{params:t,state:i}=this,n=!this.areModelsEqual(t.model,i.model);return n&&t.onAction("apply",e),n}onNewRowsLoaded(){}onUiChanged(e,t=!1){this.updateUiVisibility();let i=this.getModelFromUi(),n={model:i,state:this.getState(),valid:this.canApply(i)};this.state=n;let o=this.params;o.onStateChange(n),o.onUiChange(this.getUiChangeEventParams()),this.gos.get("enableFilterHandlers")||this.eventSvc.dispatchEvent({type:"filterModified",column:o.column,filterInstance:this}),e??(e=this.applyActive?void 0:"debounce"),e==="immediately"?this.doApplyModel({afterFloatingFilter:t,afterDataChange:!1}):e==="debounce"&&this.applyDebounced()}getState(){}getUiChangeEventParams(){}afterGuiAttached(e){this.lastContainerType=e?.container,this.refreshFilterResizer(e?.container)}refreshFilterResizer(e){let{positionableFeature:t,gos:i}=this;if(!t)return;let n=e==="floatingFilter"||e==="columnFilter";n?(t.restoreLastSize(),t.setResizable(i.get("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(t.removeSizeFromEl(),t.setResizable(!1)),t.constrainSizeToAvailableHeight(n)}afterGuiDetached(){this.checkApplyDebounce(),this.positionableFeature?.constrainSizeToAvailableHeight(!1)}destroy(){this.positionableFeature=this.destroyBean(this.positionableFeature),super.destroy()}translate(e){return Xr(this,e)}getPositionableElement(){return this.getGui()}areModelsEqual(e,t){return e===t||e==null&&t==null?!0:e==null||t==null?!1:this.areNonNullModelsEqual(e,t)}};function EP(e){return!!e.operator}function RN(e,t,i){if(t==null)return null;let n=null,{compName:o,jsComp:r,fwComp:s}=JR(e,t);return o?n={agSetColumnFilter:"agSetColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"}[o]:r==null&&s==null&&t.filter===!0&&(n=i()),n}var Nn={AUTO_HEIGHT:"ag-layout-auto-height",NORMAL:"ag-layout-normal",PRINT:"ag-layout-print"},fw=class extends A{constructor(e){super(),this.view=e}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){let e=this.gos.get("domLayout"),t={autoHeight:e==="autoHeight",normal:e==="normal",print:e==="print"},i=t.autoHeight?Nn.AUTO_HEIGHT:t.print?Nn.PRINT:Nn.NORMAL;this.view.updateLayoutClasses(i,t)}},jr="Viewport",e_="fakeVScrollComp",zv=["fakeHScrollComp","centerHeader","topCenter","bottomCenter","stickyTopCenter","stickyBottomCenter"],t_=100,Wv=150,PN=class extends A{constructor(e){super(),this.clearRetryListenerFncs=[],this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.lastOffsetHeight=-1,this.lastScrollTop=-1,this.lastIsHorizontalScrollShowing=!1,this.scrollTimer=0,this.isScrollActive=!1,this.isVerticalPositionInvalidated=!0,this.isHorizontalPositionInvalidated=!0,this.eBodyViewport=e,this.resetLastHScrollDebounced=si(this,()=>this.lastScrollSource[1]=null,Wv),this.resetLastVScrollDebounced=si(this,()=>this.lastScrollSource[0]=null,Wv)}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.animationFrameSvc=e.animationFrameSvc,this.visibleCols=e.visibleCols}destroy(){super.destroy(),this.clearRetryListenerFncs=[],window.clearTimeout(this.scrollTimer)}postConstruct(){this.enableRtl=this.gos.get("enableRtl");let e=this.invalidateVerticalScroll.bind(this),t=this.invalidateHorizontalScroll.bind(this);this.addManagedEventListeners({displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this),bodyHeightChanged:e,scrollGapChanged:t}),this.addManagedElementListeners(this.eBodyViewport,{scroll:e}),this.ctrlsSvc.whenReady(this,i=>{this.centerRowsCtrl=i.center,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()})}invalidateHorizontalScroll(){this.isHorizontalPositionInvalidated=!0}invalidateVerticalScroll(){this.isVerticalPositionInvalidated=!0}addScrollListener(){this.addHorizontalScrollListeners(),this.addVerticalScrollListeners()}addHorizontalScrollListeners(){this.addManagedElementListeners(this.centerRowsCtrl.eViewport,{scroll:this.onHScroll.bind(this,jr)});for(let e of zv){let t=this.ctrlsSvc.get(e);this.registerScrollPartner(t,this.onHScroll.bind(this,e))}}addVerticalScrollListeners(){let e=this.ctrlsSvc.get("fakeVScrollComp"),t=this.gos.get("debounceVerticalScrollbar"),i=t?si(this,this.onVScroll.bind(this,jr),t_):this.onVScroll.bind(this,jr),n=t?si(this,this.onVScroll.bind(this,e_),t_):this.onVScroll.bind(this,e_);this.addManagedElementListeners(this.eBodyViewport,{scroll:i}),this.registerScrollPartner(e,n)}registerScrollPartner(e,t){e.onScrollCallback(t)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(e){this.centerRowsCtrl!=null&&(e===void 0&&(e=this.centerRowsCtrl.getCenterViewportScrollLeft()),this.setScrollLeftForAllContainersExceptCurrent(Math.abs(e)))}setScrollLeftForAllContainersExceptCurrent(e){for(let t of[...zv,jr]){if(this.lastScrollSource[1]===t)continue;let i=this.getViewportForSource(t);kp(i,e,this.enableRtl)}}getViewportForSource(e){return e===jr?this.centerRowsCtrl.eViewport:this.ctrlsSvc.get(e).eViewport}isControllingScroll(e,t){return this.lastScrollSource[t]==null?(t===0?this.lastScrollSource[0]=e:this.lastScrollSource[1]=e,!0):this.lastScrollSource[t]===e}onHScroll(e){if(!this.isControllingScroll(e,1))return;let t=this.centerRowsCtrl.eViewport,{scrollLeft:i}=t;if(this.shouldBlockScrollUpdate(1,i,!0))return;let n=Mp(this.getViewportForSource(e),this.enableRtl);this.doHorizontalScroll(n),this.resetLastHScrollDebounced()}onVScroll(e){if(!this.isControllingScroll(e,0))return;let t;if(e===jr?t=this.eBodyViewport.scrollTop:t=this.ctrlsSvc.get("fakeVScrollComp").getScrollPosition(),this.shouldBlockScrollUpdate(0,t,!0))return;let{animationFrameSvc:i}=this;i?.setScrollTop(t),this.nextScrollTop=t,e===jr?this.ctrlsSvc.get("fakeVScrollComp").setScrollPosition(t):this.eBodyViewport.scrollTop=t,i?.active?i.schedule():this.scrollGridIfNeeded(!0),this.resetLastVScrollDebounced()}doHorizontalScroll(e){let t=this.ctrlsSvc.get("fakeHScrollComp").getScrollPosition();this.scrollLeft===e&&e===t||(this.scrollLeft=e,this.fireScrollEvent(1),this.horizontallyScrollHeaderCenterAndFloatingCenter(e),this.centerRowsCtrl.onHorizontalViewportChanged(!0))}isScrolling(){return this.isScrollActive}fireScrollEvent(e){let t={type:"bodyScroll",direction:e===1?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.isScrollActive=!0,this.eventSvc.dispatchEvent(t),window.clearTimeout(this.scrollTimer),this.scrollTimer=window.setTimeout(()=>{this.scrollTimer=0,this.isScrollActive=!1,this.eventSvc.dispatchEvent(z(b({},t),{type:"bodyScrollEnd"}))},Wv)}shouldBlockScrollUpdate(e,t,i=!1){return i&&!ia()?!1:e===0?this.shouldBlockVerticalScroll(t):this.shouldBlockHorizontalScroll(t)}shouldBlockVerticalScroll(e){let t=$C(this.eBodyViewport),{scrollHeight:i}=this.eBodyViewport;return e<0||e+t>i}shouldBlockHorizontalScroll(e){let t=this.centerRowsCtrl.getCenterWidth(),{scrollWidth:i}=this.centerRowsCtrl.eViewport;if(this.enableRtl){if(e>0)return!0}else if(e<0)return!0;return Math.abs(e)+t>i}redrawRowsAfterScroll(){this.fireScrollEvent(0)}checkScrollLeft(){let e=this.scrollLeft,t=!1;for(let i of zv)if(this.getViewportForSource(i).scrollLeft!==e){t=!0;break}t&&this.onHScroll(jr)}scrollGridIfNeeded(e=!1){let t=this.scrollTop!=this.nextScrollTop;return t&&(this.scrollTop=this.nextScrollTop,e&&this.invalidateVerticalScroll(),this.redrawRowsAfterScroll()),t}setHorizontalScrollPosition(e,t=!1){let n=this.centerRowsCtrl.eViewport.scrollWidth-this.centerRowsCtrl.getCenterWidth();!t&&this.shouldBlockScrollUpdate(1,e)&&(this.enableRtl?e=e>0?0:n:e=Math.min(Math.max(e,0),n)),kp(this.centerRowsCtrl.eViewport,Math.abs(e),this.enableRtl),this.doHorizontalScroll(e)}setVerticalScrollPosition(e){this.invalidateVerticalScroll(),this.eBodyViewport.scrollTop=e}getVScrollPosition(){if(!this.isVerticalPositionInvalidated){let{lastOffsetHeight:i,lastScrollTop:n}=this;return{top:n,bottom:n+i}}this.isVerticalPositionInvalidated=!1;let{scrollTop:e,offsetHeight:t}=this.eBodyViewport;return this.lastScrollTop=e,this.lastOffsetHeight=t,{top:e,bottom:e+t}}getApproximateVScollPosition(){return this.lastScrollTop>=0&&this.lastOffsetHeight>=0?{top:this.scrollTop,bottom:this.scrollTop+this.lastOffsetHeight}:this.getVScrollPosition()}getHScrollPosition(){return this.centerRowsCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.isHorizontalPositionInvalidated&&(this.lastIsHorizontalScrollShowing=this.centerRowsCtrl.isHorizontalScrollShowing(),this.isHorizontalPositionInvalidated=!1),this.lastIsHorizontalScrollShowing}scrollHorizontally(e){let t=this.centerRowsCtrl.eViewport.scrollLeft;return this.setHorizontalScrollPosition(t+e),this.centerRowsCtrl.eViewport.scrollLeft-t}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(e,t=null){let{rowModel:i}=this.beans,n=i.getRowCount(),o=-1;for(let r=0;r<n;r++){let s=i.getRow(r);if(typeof e=="function"){if(s&&e(s)){o=r;break}}else if(e===s||e===s.data){o=r;break}}o>=0&&this.ensureIndexVisible(o,t)}ensureIndexVisible(e,t,i=0){if(li(this.gos,"print"))return;let{rowModel:n}=this.beans,o=n.getRowCount();if(typeof e!="number"||e<0||e>=o){W(88,{index:e});return}this.clearRetryListeners();let{frameworkOverrides:r,pageBounds:s,rowContainerHeight:a,rowRenderer:l}=this.beans;r.wrapIncoming(()=>{let c=this.ctrlsSvc.getGridBodyCtrl(),d=n.getRow(e),u,h,p=0;this.invalidateVerticalScroll();do{let{stickyTopHeight:g,stickyBottomHeight:f}=c,m=d.rowTop,v=d.rowHeight,C=s.getPixelOffset(),w=d.rowTop-C,y=w+d.rowHeight,_=this.getVScrollPosition(),R=a.divStretchOffset,P=_.top+R,B=_.bottom+R,q=B-P,$=a.getScrollPositionForPixel(w),te=a.getScrollPositionForPixel(y-q),Q=Math.min(($+te)/2,w),ge=P+g>w,Me=B-f<y,De=null;t==="top"?De=$-g:t==="bottom"?De=te+f:t==="middle"?De=Q:ge?De=$-g:Me&&(te-$>q?De=$-g:De=te+f),De!==null&&(this.setVerticalScrollPosition(De),l.redraw({afterScroll:!0})),u=m!==d.rowTop||v!==d.rowHeight,h=g!==c.stickyTopHeight||f!==c.stickyBottomHeight,p++}while((u||h)&&p<10);if(this.animationFrameSvc?.flushAllFrames(),i<10&&(d?.stub||!this.beans.rowAutoHeight?.areRowsMeasured())){let g=this.getVScrollPosition().top;this.clearRetryListenerFncs=this.addManagedEventListeners({bodyScroll:()=>{let f=this.getVScrollPosition().top;g!==f&&this.clearRetryListeners()},modelUpdated:()=>{this.clearRetryListeners(),!(e>=n.getRowCount())&&this.ensureIndexVisible(e,t,i+1)}})}})}clearRetryListeners(){for(let e of this.clearRetryListenerFncs)e();this.clearRetryListenerFncs=[]}ensureColumnVisible(e,t="auto"){let{colModel:i,frameworkOverrides:n}=this.beans,o=i.getCol(e);if(!o||o.isPinned()||!this.visibleCols.isColDisplayed(o))return;let r=this.getPositionedHorizontalScroll(o,t);n.wrapIncoming(()=>{r!==null&&this.centerRowsCtrl.setCenterViewportScrollLeft(r),this.centerRowsCtrl.onHorizontalViewportChanged(),this.animationFrameSvc?.flushAllFrames()})}getPositionedHorizontalScroll(e,t){let{columnBeforeStart:i,columnAfterEnd:n}=this.isColumnOutsideViewport(e),o=this.centerRowsCtrl.getCenterWidth()<e.getActualWidth(),r=this.centerRowsCtrl.getCenterWidth(),s=this.enableRtl,a=(s?i:n)||o,l=s?n:i;t!=="auto"&&(a=t==="start",l=t==="end");let c=t==="middle";if(a||l||c){let{colLeft:d,colMiddle:u,colRight:h}=this.getColumnBounds(e);return c?u-r/2:a?s?h:d:s?d-r:h-r}return null}isColumnOutsideViewport(e){let{start:t,end:i}=this.getViewportBounds(),{colLeft:n,colRight:o}=this.getColumnBounds(e),r=this.enableRtl,s=r?t>o:i<o,a=r?i<n:t>n;return{columnBeforeStart:s,columnAfterEnd:a}}getColumnBounds(e){let t=this.enableRtl,i=this.visibleCols.bodyWidth,n=e.getActualWidth(),o=e.getLeft(),r=t?-1:1,s=t?i-o:o,a=s+n*r,l=s+n/2*r;return{colLeft:s,colMiddle:l,colRight:a}}getViewportBounds(){let e=this.centerRowsCtrl.getCenterWidth(),t=this.centerRowsCtrl.getCenterViewportScrollLeft(),i=t,n=e+t;return{start:i,end:n,width:e}}},mw=class extends A{constructor(e,t=!1){super(),this.callback=e,this.addSpacer=t}postConstruct(){let e=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",e),this.addManagedEventListeners({columnContainerWidthChanged:e,displayedColumnsChanged:e,leftPinnedWidthChanged:e}),this.addSpacer&&this.addManagedEventListeners({rightPinnedWidthChanged:e,scrollVisibilityChanged:e,scrollbarWidthChanged:e}),this.setWidth()}setWidth(){let e=li(this.gos,"print"),{visibleCols:t,scrollVisibleSvc:i}=this.beans,n=t.bodyWidth,o=t.getColsLeftWidth(),r=t.getDisplayedColumnsRightWidth(),s;e?s=n+o+r:(s=n,this.addSpacer&&(this.gos.get("enableRtl")?o:r)===0&&i.verticalScrollShowing&&(s+=i.getScrollbarWidth())),this.callback(s)}},DN=class extends A{constructor(e){super(),this.centerContainerCtrl=e}wireBeans(e){this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.listenForResize()}),this.addManagedEventListeners({scrollbarWidthChanged:this.onScrollbarWidthChanged.bind(this)}),this.addManagedPropertyListeners(["alwaysShowHorizontalScroll","alwaysShowVerticalScroll"],()=>{this.checkViewportAndScrolls()})}listenForResize(){let{beans:e,centerContainerCtrl:t,gridBodyCtrl:i}=this,n=()=>{cr(e,()=>{this.onCenterViewportResized()})};t.registerViewportResizeListener(n),i.registerBodyViewportResizeListener(n)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.scrollVisibleSvc.updateScrollGap(),this.centerContainerCtrl.isViewportInTheDOMTree()){let{pinnedCols:e,colFlex:t}=this.beans;e?.keepPinnedColumnsNarrowerThanViewport(),this.checkViewportAndScrolls();let i=this.centerContainerCtrl.getCenterWidth();i!==this.centerWidth&&(this.centerWidth=i,t?.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.scrollFeature.checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){let e=this.gridBodyCtrl.eBodyViewport,t=$C(e);this.bodyHeight!==t&&(this.bodyHeight=t,this.eventSvc.dispatchEvent({type:"bodyHeightChanged"}))}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){if(!this.isAlive())return;let e={horizontalScrollShowing:this.centerContainerCtrl.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleSvc.setScrollsVisible(e)}onHorizontalViewportChanged(){let e=this.centerContainerCtrl.getCenterWidth(),t=this.centerContainerCtrl.getViewportScrollLeft();this.beans.colViewport.setScrollPosition(e,t)}};function yp(e,t,i,n){let o=t.getColDef().cellRendererParams?.suppressMouseEventHandling;return _P(e,t,i,n,o)}function MN(e,t,i,n){let o=t?.suppressMouseEventHandling;return _P(e,void 0,i,n,o)}function _P(e,t,i,n,o){return o?o(ye(e,{column:t,node:i,event:n})):!1}function RP(e,t,i){let n=t;for(;n;){let o=_R(e,n,i);if(o)return o;n=n.parentElement}return null}var Wp="cellCtrl";function vw(e,t){return RP(e,t,Wp)}var Up="renderedRow";function kN(e,t){return RP(e,t,Up)}function kC(e,t,i,n,o){let r=n?n.getColDef().suppressKeyboardEvent:void 0;if(!r)return!1;let s=ye(e,{event:t,editing:o,column:n,node:i,data:i.data,colDef:n.getColDef()});return!!(r&&r(s))}function TN(e){let{pinnedRowModel:t,rowModel:i}=e,[n,o]=[t?.isEmpty("top")??!0,t?.isEmpty("bottom")??!0],r=n?null:"top",s,a;o?(s=null,a=i.getRowCount()-1):(s="bottom",a=t?.getPinnedBottomRowCount()??-1);let{visibleCols:l,rangeSvc:c}=e,d=l.allCols;!c||!d?.length||c.setCellRange({rowStartIndex:0,rowStartPinned:r,rowEndIndex:a,rowEndPinned:s})}var FN=65,IN=67,AN=86,LN=68,ON=90,NN=89;function BN(e){let{keyCode:t}=e,i;switch(t){case FN:i=T.A;break;case IN:i=T.C;break;case AN:i=T.V;break;case LN:i=T.D;break;case ON:i=T.Z;break;case NN:i=T.Y;break;default:i=e.code}return i}var HN=class extends A{constructor(e){super(),this.element=e}postConstruct(){this.addKeyboardListeners(),this.addMouseListeners(),this.beans.touchSvc?.mockRowContextMenu(this),this.editSvc=this.beans.editSvc}addKeyboardListeners(){let e="keydown",t=this.processKeyboardEvent.bind(this,e);this.addManagedElementListeners(this.element,{[e]:t})}addMouseListeners(){let t=["dblclick","contextmenu","mouseover","mouseout","click",dR("touchstart")?"touchstart":"mousedown"];for(let i of t){let n=this.processMouseEvent.bind(this,i);this.addManagedElementListeners(this.element,{[i]:n})}}processMouseEvent(e,t){if(!md(this.beans,t)||sr(t))return;let{cellCtrl:i,rowCtrl:n}=this.getControlsForEventTarget(t.target);e==="contextmenu"?(i?.column&&i.dispatchCellContextMenuEvent(t),this.beans.contextMenuSvc?.handleContextMenuMouseEvent(t,void 0,n,i)):(i&&i.onMouseEvent(e,t),n&&n.onMouseEvent(e,t))}getControlsForEventTarget(e){let{gos:t}=this;return{cellCtrl:vw(t,e),rowCtrl:kN(t,e)}}processKeyboardEvent(e,t){let{cellCtrl:i,rowCtrl:n}=this.getControlsForEventTarget(t.target);t.defaultPrevented||(i?this.processCellKeyboardEvent(i,e,t):n?.isFullWidth()&&this.processFullWidthRowKeyboardEvent(n,e,t))}processCellKeyboardEvent(e,t,i){let n=this.editSvc?.isEditing(e,{withOpenEditor:!0})??!1;!kC(this.gos,i,e.rowNode,e.column,n)&&t==="keydown"&&(!n&&this.beans.navigation?.handlePageScrollingKey(i)||e.onKeyDown(i),this.doGridOperations(i,n),iP(i)&&e.processCharacter(i)),t==="keydown"&&this.eventSvc.dispatchEvent(e.createEvent(i,"cellKeyDown"))}processFullWidthRowKeyboardEvent(e,t,i){let{rowNode:n}=e,{focusSvc:o,navigation:r}=this.beans,a=o.getFocusedCell()?.column;if(!kC(this.gos,i,n,a,!1)){let c=i.key;if(t==="keydown")switch(c){case T.PAGE_HOME:case T.PAGE_END:case T.PAGE_UP:case T.PAGE_DOWN:r?.handlePageScrollingKey(i,!0);break;case T.LEFT:case T.RIGHT:if(!this.gos.get("embedFullWidthRows"))break;case T.UP:case T.DOWN:e.onKeyboardNavigate(i);break;case T.TAB:e.onTabKeyDown(i);break;default:}}t==="keydown"&&this.eventSvc.dispatchEvent(e.createRowEvent("cellKeyDown",i))}doGridOperations(e,t){if(!e.ctrlKey&&!e.metaKey||t||!md(this.beans,e))return;let i=BN(e),{clipboardSvc:n,undoRedo:o}=this.beans;if(i===T.A)return this.onCtrlAndA(e);if(i===T.C)return this.onCtrlAndC(n,e);if(i===T.D)return this.onCtrlAndD(n,e);if(i===T.V)return this.onCtrlAndV(n,e);if(i===T.X)return this.onCtrlAndX(n,e);if(i===T.Y)return this.onCtrlAndY(o);if(i===T.Z)return this.onCtrlAndZ(o,e)}onCtrlAndA(e){let{beans:{rowModel:t,rangeSvc:i,selectionSvc:n},gos:o}=this;i&&ar(o)&&!FL(o)&&t.isRowsToRender()?TN(this.beans):n&&n.selectAllRowNodes({source:"keyboardSelectAll",selectAll:TR(o)}),e.preventDefault()}onCtrlAndC(e,t){if(!e||this.gos.get("enableCellTextSelection"))return;let{cellCtrl:i}=this.getControlsForEventTarget(t.target);this.editSvc?.isEditing(i,{withOpenEditor:!0})||(t.preventDefault(),e.copyToClipboard())}onCtrlAndX(e,t){if(!e||this.gos.get("enableCellTextSelection")||this.gos.get("suppressCutToClipboard"))return;let{cellCtrl:i}=this.getControlsForEventTarget(t.target);this.editSvc?.isEditing(i,{withOpenEditor:!0})||(t.preventDefault(),e.cutToClipboard(void 0,"ui"))}onCtrlAndV(e,t){let{cellCtrl:i}=this.getControlsForEventTarget(t.target);this.editSvc?.isEditing(i,{withOpenEditor:!0})||e&&!this.gos.get("suppressClipboardPaste")&&e.pasteFromClipboard()}onCtrlAndD(e,t){e&&!this.gos.get("suppressClipboardPaste")&&e.copyRangeDown(),t.preventDefault()}onCtrlAndZ(e,t){!this.gos.get("undoRedoCellEditing")||!e||(t.preventDefault(),t.shiftKey?e.redo("ui"):e.undo("ui"))}onCtrlAndY(e){e?.redo("ui")}},PP=class extends A{constructor(e,t){super(),this.eContainer=e,this.eViewport=t}postConstruct(){this.addManagedEventListeners({rowContainerHeightChanged:this.onHeightChanged.bind(this,this.beans.rowContainerHeight)})}onHeightChanged(e){let t=e.uiContainerHeight,i=t!=null?`${t}px`:"";this.eContainer.style.height=i,this.eViewport&&(this.eViewport.style.height=i)}},ap=e=>e.topRowCtrls,lp=e=>e.getStickyTopRowCtrls(),cp=e=>e.getStickyBottomRowCtrls(),dp=e=>e.bottomRowCtrls,up=e=>e.allRowCtrls,Uv=e=>e.getCtrls("top"),qv=e=>e.getCtrls("center"),$v=e=>e.getCtrls("bottom"),VN={center:{type:"center",name:"center-cols",getRowCtrls:up,getSpannedRowCtrls:qv},left:{type:"left",name:"pinned-left-cols",pinnedType:"left",getRowCtrls:up,getSpannedRowCtrls:qv},right:{type:"right",name:"pinned-right-cols",pinnedType:"right",getRowCtrls:up,getSpannedRowCtrls:qv},fullWidth:{type:"fullWidth",name:"full-width",fullWidth:!0,getRowCtrls:up},topCenter:{type:"center",name:"floating-top",getRowCtrls:ap,getSpannedRowCtrls:Uv},topLeft:{type:"left",name:"pinned-left-floating",container:"ag-pinned-left-floating-top",pinnedType:"left",getRowCtrls:ap,getSpannedRowCtrls:Uv},topRight:{type:"right",name:"pinned-right-floating",container:"ag-pinned-right-floating-top",pinnedType:"right",getRowCtrls:ap,getSpannedRowCtrls:Uv},topFullWidth:{type:"fullWidth",name:"floating-top-full-width",fullWidth:!0,getRowCtrls:ap},stickyTopCenter:{type:"center",name:"sticky-top",getRowCtrls:lp},stickyTopLeft:{type:"left",name:"pinned-left-sticky-top",container:"ag-pinned-left-sticky-top",pinnedType:"left",getRowCtrls:lp},stickyTopRight:{type:"right",name:"pinned-right-sticky-top",container:"ag-pinned-right-sticky-top",pinnedType:"right",getRowCtrls:lp},stickyTopFullWidth:{type:"fullWidth",name:"sticky-top-full-width",fullWidth:!0,getRowCtrls:lp},stickyBottomCenter:{type:"center",name:"sticky-bottom",getRowCtrls:cp},stickyBottomLeft:{type:"left",name:"pinned-left-sticky-bottom",container:"ag-pinned-left-sticky-bottom",pinnedType:"left",getRowCtrls:cp},stickyBottomRight:{type:"right",name:"pinned-right-sticky-bottom",container:"ag-pinned-right-sticky-bottom",pinnedType:"right",getRowCtrls:cp},stickyBottomFullWidth:{type:"fullWidth",name:"sticky-bottom-full-width",fullWidth:!0,getRowCtrls:cp},bottomCenter:{type:"center",name:"floating-bottom",getRowCtrls:dp,getSpannedRowCtrls:$v},bottomLeft:{type:"left",name:"pinned-left-floating-bottom",container:"ag-pinned-left-floating-bottom",pinnedType:"left",getRowCtrls:dp,getSpannedRowCtrls:$v},bottomRight:{type:"right",name:"pinned-right-floating-bottom",container:"ag-pinned-right-floating-bottom",pinnedType:"right",getRowCtrls:dp,getSpannedRowCtrls:$v},bottomFullWidth:{type:"fullWidth",name:"floating-bottom-full-width",fullWidth:!0,getRowCtrls:dp}};function DP(e){return`ag-${Md(e).name}-viewport`}function Sp(e){let t=Md(e);return t.container??`ag-${t.name}-container`}function GN(e){return`ag-${Md(e).name}-spanned-cells-container`}function Md(e){return VN[e]}var zN=["topCenter","topLeft","topRight"],WN=["bottomCenter","bottomLeft","bottomRight"],UN=["center","left","right"],qN=["center","left","right","fullWidth"],$N=["stickyTopCenter","stickyBottomCenter","center","topCenter","bottomCenter"],jN=["left","bottomLeft","topLeft","stickyTopLeft","stickyBottomLeft"],KN=["right","bottomRight","topRight","stickyTopRight","stickyBottomRight"],MP=["stickyTopCenter","stickyTopLeft","stickyTopRight"],kP=["stickyBottomCenter","stickyBottomLeft","stickyBottomRight"],YN=[...MP,"stickyTopFullWidth",...kP,"stickyBottomFullWidth"],XN=[...zN,...WN,...UN,...MP,...kP],JN=class extends A{constructor(e){super(),this.name=e,this.visible=!0,this.EMPTY_CTRLS=[],this.options=Md(e)}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.forContainers(["center"],()=>{this.viewportSizeFeature=this.createManagedBean(new DN(this)),this.addManagedEventListeners({stickyTopOffsetChanged:this.onStickyTopOffsetChanged.bind(this)})})}onStickyTopOffsetChanged(e){this.comp.setOffsetTop(`${e.offset}px`)}registerWithCtrlsService(){this.options.fullWidth||this.beans.ctrlsSvc.register(this.name,this)}forContainers(e,t){e.indexOf(this.name)>=0&&t()}setComp(e,t,i,n){this.comp=e,this.eContainer=t,this.eSpannedContainer=i,this.eViewport=n,this.createManagedBean(new HN(this.eViewport??this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder();let{pinnedCols:o,rangeSvc:r}=this.beans,s=()=>this.onPinnedWidthChanged();this.forContainers(jN,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(o?.createPinnedWidthFeature(!0,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({leftPinnedWidthChanged:s})}),this.forContainers(KN,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(o?.createPinnedWidthFeature(!1,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({rightPinnedWidthChanged:s})}),this.forContainers(qN,()=>this.createManagedBean(new PP(this.eContainer,this.name==="center"?n:void 0))),r&&this.forContainers(XN,()=>this.createManagedBean(r.createDragListenerFeature(this.eContainer))),this.forContainers($N,()=>this.createManagedBean(new mw(a=>this.comp.setContainerWidth(`${a}px`)))),this.visible=this.isContainerVisible(),this.addListeners(),this.registerWithCtrlsService()}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}addListeners(){let{spannedRowRenderer:e,gos:t}=this.beans,i=this.onDisplayedColumnsChanged.bind(this);this.addManagedEventListeners({displayedColumnsChanged:i,displayedColumnsWidthChanged:i,displayedRowsChanged:n=>this.onDisplayedRowsChanged(n.afterScroll)}),i(),this.onDisplayedRowsChanged(),e&&this.options.getSpannedRowCtrls&&t.get("enableCellSpan")&&this.addManagedListeners(e,{spannedRowsUpdated:()=>{let n=this.options.getSpannedRowCtrls(e);n&&this.comp.setSpannedRowCtrls(n,!1)}})}listenOnDomOrder(){if(YN.indexOf(this.name)>=0){this.comp.setDomOrder(!0);return}let t=()=>{let i=this.gos.get("ensureDomOrder"),n=li(this.gos,"print");this.comp.setDomOrder(i||n)};this.addManagedPropertyListener("domLayout",t),t()}onDisplayedColumnsChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}addPreventScrollWhileDragging(){let{dragSvc:e}=this.beans;if(!e)return;let t=i=>{e.dragging&&i.cancelable&&i.preventDefault()};this.eContainer.addEventListener("touchmove",t,{passive:!1}),this.addDestroyFunc(()=>this.eContainer.removeEventListener("touchmove",t))}onHorizontalViewportChanged(e=!1){let t=this.getCenterWidth(),i=this.getCenterViewportScrollLeft();this.beans.colViewport.setScrollPosition(t,i,e)}hasHorizontalScrollGap(){return this.eContainer.clientWidth-this.eViewport.clientWidth<0}hasVerticalScrollGap(){return this.eContainer.clientHeight-this.eViewport.clientHeight<0}getCenterWidth(){return fd(this.eViewport)}getCenterViewportScrollLeft(){return Mp(this.eViewport,this.enableRtl)}registerViewportResizeListener(e){let t=is(this.beans,this.eViewport,e);this.addDestroyFunc(()=>t())}isViewportInTheDOMTree(){return rR(this.eViewport)}getViewportScrollLeft(){return Mp(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gos.get("alwaysShowHorizontalScroll")||KC(this.eViewport)}setHorizontalScroll(e){this.comp.setHorizontalScroll(e)}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(e){kp(this.eViewport,e,this.enableRtl)}isContainerVisible(){return!(this.options.pinnedType!=null)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){let e=this.isContainerVisible();this.visible!=e&&(this.visible=e,this.onDisplayedRowsChanged())}onDisplayedRowsChanged(e=!1){let t=this.options.getRowCtrls(this.beans.rowRenderer);if(!this.visible||t.length===0){this.comp.setRowCtrls({rowCtrls:this.EMPTY_CTRLS});return}let i=li(this.gos,"print"),o=this.gos.get("embedFullWidthRows")||i,r=t.filter(s=>{let a=s.isFullWidth();return this.options.fullWidth?!o&&a:o||!a});this.comp.setRowCtrls({rowCtrls:r,useFlushSync:e})}},TP="ag-force-vertical-scroll",QN="ag-selectable",ZN="ag-column-moving",eB=class extends A{constructor(){super(...arguments),this.stickyTopHeight=0,this.stickyBottomHeight=0}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colModel=e.colModel,this.scrollVisibleSvc=e.scrollVisibleSvc,this.pinnedRowModel=e.pinnedRowModel,this.filterManager=e.filterManager,this.rowGroupColsSvc=e.rowGroupColsSvc}setComp(e,t,i,n,o,r,s){this.comp=e,this.eGridBody=t,this.eBodyViewport=i,this.eTop=n,this.eBottom=o,this.eStickyTop=r,this.eStickyBottom=s,this.eCenterColsViewport=i.querySelector(`.${DP("center")}`),this.eFullWidthContainer=i.querySelector(`.${Sp("fullWidth")}`),this.eStickyTopFullWidthContainer=r.querySelector(`.${Sp("stickyTopFullWidth")}`),this.eStickyBottomFullWidthContainer=s.querySelector(`.${Sp("stickyBottomFullWidth")}`),this.setCellTextSelection(this.gos.get("enableCellTextSelection")),this.addManagedPropertyListener("enableCellTextSelection",a=>this.setCellTextSelection(a.currentValue)),this.createManagedBean(new fw(this.comp)),this.scrollFeature=this.createManagedBean(new PN(i)),this.beans.rowDragSvc?.setupRowDrag(i,this),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([n,i,o,r,s]),this.setGridRootRole(),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.updateScrollingClasses(),this.filterManager?.setupAdvFilterHeaderComp(n),this.ctrlsSvc.register("gridBodyCtrl",this)}addEventListeners(){let e=this.setFloatingHeights.bind(this),t=this.setGridRootRole.bind(this),i=this.toggleRowResizeStyles.bind(this);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this),scrollGapChanged:this.updateScrollingClasses.bind(this),pinnedRowDataChanged:e,pinnedHeightChanged:e,pinnedRowsChanged:e,headerHeightChanged:this.setStickyTopOffsetTop.bind(this),columnRowGroupChanged:t,columnPivotChanged:t,rowResizeStarted:i,rowResizeEnded:i}),this.addManagedPropertyListener("treeData",t)}toggleRowResizeStyles(e){let t=e.type==="rowResizeStarted";this.eBodyViewport.classList.toggle("ag-prevent-animation",t)}onGridColumnsChanged(){let e=this.beans.colModel.getCols();this.comp.setColumnCount(e.length)}onScrollVisibilityChanged(){let{scrollVisibleSvc:e}=this,t=e.verticalScrollShowing;this.setVerticalScrollPaddingVisible(t),this.setStickyWidth(t),this.setStickyBottomOffsetBottom();let i=t&&e.getScrollbarWidth()||0,n=tP()?16:0,o=`calc(100% + ${i+n}px)`;cr(this.beans,()=>this.comp.setBodyViewportWidth(o)),this.updateScrollingClasses()}setGridRootRole(){let{rowGroupColsSvc:e,colModel:t}=this,i=this.gos.get("treeData");if(!i){let n=t.isPivotMode();i=(e?e.columns.length:0)>=(n?2:1)}this.comp.setGridRootRole(i?"treegrid":"grid")}addFocusListeners(e){for(let t of e)this.addManagedElementListeners(t,{focusin:i=>{let{target:n}=i,o=Zs(n,"ag-root",t);t.classList.toggle("ag-has-focus",!o)},focusout:i=>{let{target:n,relatedTarget:o}=i,r=t.contains(o),s=Zs(o,"ag-root",t);Zs(n,"ag-root",t)||(!r||s)&&t.classList.remove("ag-has-focus")}})}setColumnMovingCss(e){this.comp.setColumnMovingCss(ZN,e)}setCellTextSelection(e=!1){this.comp.setCellSelectableCss(QN,e)}updateScrollingClasses(){let{eGridBody:{classList:e},scrollVisibleSvc:t}=this;e.toggle("ag-body-vertical-content-no-gap",!t.verticalScrollGap),e.toggle("ag-body-horizontal-content-no-gap",!t.horizontalScrollGap)}disableBrowserDragging(){this.addManagedElementListeners(this.eGridBody,{dragstart:e=>{if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1}})}addStopEditingWhenGridLosesFocus(){this.beans.editSvc?.addStopEditingWhenGridLosesFocus([this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop,this.eStickyBottom])}updateRowCount(){let e=(this.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0)+(this.filterManager?.getHeaderRowCount()??0),{rowModel:t}=this.beans,i=t.isLastRowIndexKnown()?t.getRowCount():-1,n=i===-1?-1:e+i;this.comp.setRowCount(n)}registerBodyViewportResizeListener(e){this.comp.registerBodyViewportResizeListener(e)}setVerticalScrollPaddingVisible(e){let t=e?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(t)}isVerticalScrollShowing(){let e=this.gos.get("alwaysShowVerticalScroll"),t=e?TP:null,i=li(this.gos,"normal");return this.comp.setAlwaysVerticalScrollClass(t,e),e||i&&lR(this.eBodyViewport)}setupRowAnimationCssClass(){let{rowContainerHeight:e,environment:t}=this.beans,i=t.sizesMeasured,n=()=>{let o=i&&gl(this.gos)&&!e.stretching,r=o?"ag-row-animation":"ag-row-no-animation";this.comp.setRowAnimationCssOnBodyViewport(r,o)};n(),this.addManagedEventListeners({heightScaleChanged:n}),this.addManagedPropertyListener("animateRows",n),this.addManagedEventListeners({gridStylesChanged:()=>{!i&&t.sizesMeasured&&(i=!0,n())}})}addBodyViewportListener(){let{eBodyViewport:e,eStickyTop:t,eStickyBottom:i,eTop:n,eBottom:o,beans:{popupSvc:r,touchSvc:s}}=this,a=this.onBodyViewportContextMenu.bind(this);this.addManagedElementListeners(e,{contextmenu:a}),s?.mockBodyContextMenu(this,a),this.addManagedElementListeners(e,{wheel:this.onBodyViewportWheel.bind(this,r)});let l=this.onStickyWheel.bind(this);for(let d of[t,i,n,o])this.addManagedElementListeners(d,{wheel:l});let c=this.onHorizontalWheel.bind(this);for(let d of["left","right","topLeft","topRight","bottomLeft","bottomRight"])this.addManagedElementListeners(this.ctrlsSvc.get(d).eContainer,{wheel:c});this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){this.addManagedElementListeners(this.eFullWidthContainer,{wheel:e=>this.onFullWidthContainerWheel(e)})}onFullWidthContainerWheel(e){let{deltaX:t,deltaY:i,shiftKey:n}=e;(n||Math.abs(t)>Math.abs(i))&&md(this.beans,e)&&this.scrollGridBodyToMatchEvent(e)}onStickyWheel(e){let{deltaY:t}=e;this.scrollVertically(t)>0&&e.preventDefault()}onHorizontalWheel(e){let{deltaX:t,deltaY:i,shiftKey:n}=e;(n||Math.abs(t)>Math.abs(i))&&this.scrollGridBodyToMatchEvent(e)}scrollGridBodyToMatchEvent(e){let{deltaX:t,deltaY:i}=e;e.preventDefault(),this.eCenterColsViewport.scrollBy({left:t||i})}onBodyViewportContextMenu(e,t,i){if(!e&&!i)return;this.gos.get("preventDefaultOnContextMenu")&&(e||i).preventDefault();let{target:n}=e||t;(n===this.eBodyViewport||n===this.ctrlsSvc.get("center").eViewport)&&this.beans.contextMenuSvc?.showContextMenu({mouseEvent:e,touchEvent:i,value:null,anchorToElement:this.eGridBody,source:"ui"})}onBodyViewportWheel(e,t){this.gos.get("suppressScrollWhenPopupsAreOpen")&&e?.hasAnchoredPopup()&&t.preventDefault()}scrollVertically(e){let t=this.eBodyViewport.scrollTop;return this.scrollFeature.setVerticalScrollPosition(t+e),this.eBodyViewport.scrollTop-t}setFloatingHeights(){let{pinnedRowModel:e,beans:{environment:t}}=this,i=e?.getPinnedTopTotalHeight(),n=e?.getPinnedBottomTotalHeight(),o=t.getPinnedRowBorderWidth(),r=t.getRowBorderWidth(),s=o-r,a=i?s+i:0,l=n?s+n:0;this.comp.setTopHeight(a),this.comp.setBottomHeight(l),this.comp.setTopInvisible(a<=0),this.comp.setBottomInvisible(l<=0),this.setStickyTopOffsetTop(),this.setStickyBottomOffsetBottom()}setStickyTopHeight(e=0){this.comp.setStickyTopHeight(`${e}px`),this.stickyTopHeight=e}setStickyBottomHeight(e=0){this.comp.setStickyBottomHeight(`${e}px`),this.stickyBottomHeight=e}setStickyWidth(e){if(!e)this.comp.setStickyTopWidth("100%"),this.comp.setStickyBottomWidth("100%");else{let t=this.scrollVisibleSvc.getScrollbarWidth();this.comp.setStickyTopWidth(`calc(100% - ${t}px)`),this.comp.setStickyBottomWidth(`calc(100% - ${t}px)`)}}setStickyTopOffsetTop(){let t=this.ctrlsSvc.get("gridHeaderCtrl").headerHeight+(this.filterManager?.getHeaderHeight()??0),i=this.pinnedRowModel?.getPinnedTopTotalHeight()??0,n=0;t>0&&(n+=t),i>0&&(n+=i),n>0&&(n+=1),this.comp.setStickyTopTop(`${n}px`)}setStickyBottomOffsetBottom(){let{pinnedRowModel:e,scrollVisibleSvc:t,comp:i}=this,n=e?.getPinnedBottomTotalHeight()??0,r=t.horizontalScrollShowing&&t.getScrollbarWidth()||0,s=n+r;i.setStickyBottomBottom(`${s}px`)}};function tB(e,t){return vw(e,t.target)?.getFocusedCellPosition()??null}function i_(e,t){let i=li(e.gos,"normal"),n=t,o,r;n.clientX!=null||n.clientY!=null?(o=n.clientX,r=n.clientY):(o=n.x,r=n.y);let{pageFirstPixel:s}=e.pageBounds.getCurrentPagePixelRange();if(r+=s,i){let a=e.ctrlsSvc.getScrollFeature(),l=a.getVScrollPosition(),c=a.getHScrollPosition();o+=c.left,r+=l.top}return{x:o,y:r}}var FP=class extends je{constructor(e,t){super(),this.direction=t,this.eViewport=Z,this.eContainer=Z,this.hideTimeout=0,this.setTemplate(e)}postConstruct(){this.addManagedEventListeners({scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this)}),this.onScrollVisibilityChanged(),this.toggleCss("ag-apple-scrollbar",ZR()||ia())}destroy(){super.destroy(),window.clearTimeout(this.hideTimeout)}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.invisibleScrollbar=tP(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){let e=this.getGui(),t=()=>this.toggleCss("ag-scrollbar-active",!0),i=()=>this.toggleCss("ag-scrollbar-active",!1);this.addManagedListeners(e,{mouseenter:t,mousedown:t,touchstart:t,mouseleave:i,touchend:i})}onScrollVisibilityChanged(){this.invisibleScrollbar===void 0&&this.initialiseInvisibleScrollbar(),cr(this.beans,()=>this.setScrollVisible())}hideAndShowInvisibleScrollAsNeeded(){this.addManagedEventListeners({bodyScroll:e=>{e.direction===this.direction&&(this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=0),this.toggleCss("ag-scrollbar-scrolling",!0))},bodyScrollEnd:()=>{this.hideTimeout=window.setTimeout(()=>{this.toggleCss("ag-scrollbar-scrolling",!1),this.hideTimeout=0},400)}})}attemptSettingScrollPosition(e){let t=this.eViewport;rL(this,()=>bo(t),()=>this.setScrollPosition(e),100)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}},iB={tag:"div",cls:"ag-body-horizontal-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eLeftSpacer",cls:"ag-horizontal-left-spacer"},{tag:"div",ref:"eViewport",cls:"ag-body-horizontal-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-horizontal-scroll-container"}]},{tag:"div",ref:"eRightSpacer",cls:"ag-horizontal-right-spacer"}]},nB=class extends FP{constructor(){super(iB,"horizontal"),this.eLeftSpacer=Z,this.eRightSpacer=Z,this.setScrollVisibleDebounce=0}wireBeans(e){this.visibleCols=e.visibleCols,this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){super.postConstruct();let e=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e,pinnedRowDataChanged:this.refreshCompBottom.bind(this)}),this.addManagedPropertyListener("domLayout",e),this.beans.ctrlsSvc.register("fakeHScrollComp",this),this.createManagedBean(new mw(t=>this.eContainer.style.width=`${t}px`)),this.addManagedPropertyListeners(["suppressHorizontalScroll"],this.onScrollVisibilityChanged.bind(this))}destroy(){window.clearTimeout(this.setScrollVisibleDebounce),super.destroy()}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.enableRtl=this.gos.get("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}refreshCompBottom(){if(!this.invisibleScrollbar)return;let e=this.beans.pinnedRowModel?.getPinnedBottomTotalHeight()??0;this.getGui().style.bottom=`${e}px`}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){let e=this.scrollVisibleSvc.verticalScrollShowing,t=this.visibleCols.getDisplayedColumnsRightWidth(),i=!this.enableRtl&&e,n=this.scrollVisibleSvc.getScrollbarWidth();i&&(t+=n),vo(this.eRightSpacer,t),this.eRightSpacer.classList.toggle("ag-scroller-corner",t<=n);let o=this.visibleCols.getColsLeftWidth();this.enableRtl&&e&&(o+=n),vo(this.eLeftSpacer,o),this.eLeftSpacer.classList.toggle("ag-scroller-corner",o<=n)}setScrollVisible(){let e=this.scrollVisibleSvc.horizontalScrollShowing,t=this.invisibleScrollbar,i=this.gos.get("suppressHorizontalScroll"),n=e&&this.scrollVisibleSvc.getScrollbarWidth()||0,r=i?0:n===0&&t?16:n,s=()=>{this.setScrollVisibleDebounce=0,this.toggleCss("ag-scrollbar-invisible",t),od(this.getGui(),r),od(this.eViewport,r),od(this.eContainer,r),r||this.eContainer.style.setProperty("min-height","1px"),this.setVisible(e,{skipAriaHidden:!0})};window.clearTimeout(this.setScrollVisibleDebounce),e?this.setScrollVisibleDebounce=window.setTimeout(s,100):s()}getScrollPosition(){return Mp(this.eViewport,this.enableRtl)}setScrollPosition(e){bo(this.eViewport)||this.attemptSettingScrollPosition(e),kp(this.eViewport,e,this.enableRtl)}},oB={selector:"AG-FAKE-HORIZONTAL-SCROLL",component:nB},rB={tag:"div",cls:"ag-body-vertical-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eViewport",cls:"ag-body-vertical-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-vertical-scroll-container"}]}]},sB=class extends FP{constructor(){super(rB,"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new PP(this.eContainer));let{ctrlsSvc:e}=this.beans;e.register("fakeVScrollComp",this),this.addManagedEventListeners({rowContainerHeightChanged:this.onRowContainerHeightChanged.bind(this,e)})}setScrollVisible(){let{scrollVisibleSvc:e}=this.beans,t=e.verticalScrollShowing,i=this.invisibleScrollbar,n=t&&e.getScrollbarWidth()||0,o=n===0&&i?16:n;this.toggleCss("ag-scrollbar-invisible",i),vo(this.getGui(),o),vo(this.eViewport,o),vo(this.eContainer,o),this.setDisplayed(t,{skipAriaHidden:!0})}onRowContainerHeightChanged(e){let i=e.getGridBodyCtrl().eBodyViewport,n=this.getScrollPosition(),o=i.scrollTop;n!=o&&this.setScrollPosition(o,!0)}getScrollPosition(){return this.eViewport.scrollTop}setScrollPosition(e,t){!t&&!bo(this.eViewport)&&this.attemptSettingScrollPosition(e),this.eViewport.scrollTop=e}},aB={selector:"AG-FAKE-VERTICAL-SCROLL",component:sB},lB="ag-column-first",cB="ag-column-last";function IP(e,t,i,n){return mt(e)?[]:uB(e.headerClass,e,t,i,n)}function AP(e,t,i){e.toggleCss(lB,i.isColAtEdge(t,"first")),e.toggleCss(cB,i.isColAtEdge(t,"last"))}function dB(e,t,i,n){return ye(t,{colDef:e,column:i,columnGroup:n})}function uB(e,t,i,n,o){if(mt(e))return[];let r;if(typeof e=="function"){let s=dB(t,i,n,o);r=e(s)}else r=e;return typeof r=="string"?[r]:Array.isArray(r)?[...r]:[]}function hB(e,t,i){t.addManagedElementListeners(i,{keydown:n=>{if(!n.defaultPrevented&&n.key===T.TAB){let o=n.shiftKey;ha(e,i,!1,o)||Rl(e,o)&&n.preventDefault()}}})}function pB(e,t){return e.ctrlsSvc.get("gridCtrl").focusInnerElement(t)}function na(e){return e.gos.get("suppressHeaderFocus")||!!e.overlays?.isExclusive()}function ig(e){return e.gos.get("suppressCellFocus")||!!e.overlays?.isExclusive()}function Rl(e,t,i=!1){let n=e.ctrlsSvc.get("gridCtrl");return!i&&n.focusNextInnerContainer(t)?!0:((i||!t&&!n.isDetailGrid())&&n.forceFocusOutOfContainer(t),!1)}function mo(e){return e.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0}function Cw(e){let t=[],i=e.ctrlsSvc.getHeaderRowContainerCtrls();for(let n of i){if(!n)continue;let o=n.getGroupRowCount()||0;for(let r=0;r<o;r++){let s=n.getGroupRowCtrlAtIndex(r),a=t[r];if(s){let l=gB(e,s);(a==null||l>a)&&(t[r]=l)}}}return t}function gB(e,t){let n=e.colModel.isPivotMode()?mB(e):OP(e),o=t.getHeaderCellCtrls();for(let r of o){let{column:s}=r,a=s.getAutoHeaderHeight();a!=null&&a>n&&s.isAutoHeaderHeight()&&(n=a)}return n}function ww(e){let i=e.colModel.isPivotMode()?fB(e):kd(e);return e.colModel.forAllCols(n=>{let o=n.getAutoHeaderHeight();o!=null&&o>i&&n.isAutoHeaderHeight()&&(i=o)}),i}function kd(e){return e.gos.get("headerHeight")??e.environment.getDefaultHeaderHeight()}function LP(e){return e.gos.get("floatingFiltersHeight")??kd(e)}function OP(e){return e.gos.get("groupHeaderHeight")??kd(e)}function fB(e){return e.gos.get("pivotHeaderHeight")??kd(e)}function mB(e){return e.gos.get("pivotGroupHeaderHeight")??OP(e)}function vB(e,t){return e.headerRowIndex===t.headerRowIndex&&e.column===t.column}var CB=class extends A{setComp(e,t,i){this.comp=e,this.eGui=t;let{beans:n}=this,{headerNavigation:o,touchSvc:r,ctrlsSvc:s}=n;o&&this.createManagedBean(new kl(i,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedEventListeners({columnPivotModeChanged:this.onPivotModeChanged.bind(this,n),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this,n)}),this.onPivotModeChanged(n),this.setupHeaderHeight();let a=this.onHeaderContextMenu.bind(this);this.addManagedElementListeners(this.eGui,{contextmenu:a}),r?.mockHeaderContextMenu(this,a),s.register("gridHeaderCtrl",this)}setupHeaderHeight(){let e=this.setHeaderHeight.bind(this);e(),this.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],e),this.addManagedEventListeners({headerRowsChanged:e,columnHeaderHeightChanged:e,columnGroupHeaderHeightChanged:()=>cr(this.beans,()=>e()),gridStylesChanged:e,advancedFilterEnabledChanged:e})}setHeaderHeight(){let{beans:e}=this,t=0,i=Cw(e).reduce((r,s)=>r+s,0),n=ww(e);if(e.filterManager?.hasFloatingFilters()&&(t+=LP(e)),t+=i,t+=n,this.headerHeight===t)return;this.headerHeight=t;let o=`${t+1}px`;this.comp.setHeightAndMinHeight(o),this.eventSvc.dispatchEvent({type:"headerHeightChanged"})}onPivotModeChanged(e){let t=e.colModel.isPivotMode();this.comp.toggleCss("ag-pivot-on",t),this.comp.toggleCss("ag-pivot-off",!t)}onDisplayedColumnsChanged(e){let i=e.visibleCols.allCols.some(n=>n.isSpanHeaderHeight());this.comp.toggleCss("ag-header-allow-overflow",i)}onTabKeyDown(e){let t=this.gos.get("enableRtl"),i=e.shiftKey,n=i!==t?"LEFT":"RIGHT",{beans:o}=this,{headerNavigation:r,focusSvc:s}=o;(r.navigateHorizontally(n,!0,e)||!i&&s.focusOverlay(!1)||Rl(o,i,!0))&&e.preventDefault()}handleKeyDown(e){let t=null,{headerNavigation:i}=this.beans;switch(e.key){case T.LEFT:t="LEFT";case T.RIGHT:{ie(t)||(t="RIGHT"),i.navigateHorizontally(t,!1,e)&&e.preventDefault();break}case T.UP:t="UP";case T.DOWN:{ie(t)||(t="DOWN"),i.navigateVertically(t,e)&&e.preventDefault();break}default:return}}onFocusOut(e){let{relatedTarget:t}=e,{eGui:i,beans:n}=this;!t&&i.contains(Ct(n))||i.contains(t)||(n.focusSvc.focusedHeader=null)}onHeaderContextMenu(e,t,i){let{menuSvc:n,ctrlsSvc:o}=this.beans;if(!e&&!i||!n?.isHeaderContextMenuEnabled())return;let{target:r}=e??t;(r===this.eGui||r===o.getHeaderRowContainerCtrl()?.eViewport)&&n.showHeaderContextMenu(void 0,e,i)}},bw=class extends je{constructor(e,t){super(e),this.ctrl=t}getCtrl(){return this.ctrl}},wB={tag:"div",cls:"ag-header-cell",role:"columnheader",children:[{tag:"div",ref:"eResize",cls:"ag-header-cell-resize",role:"presentation"},{tag:"div",ref:"eHeaderCompWrapper",cls:"ag-header-cell-comp-wrapper",role:"presentation"}]},bB=class extends bw{constructor(e){super(wB,e),this.eResize=Z,this.eHeaderCompWrapper=Z,this.headerCompVersion=0}postConstruct(){let e=this.getGui(),t=()=>{let n=this.ctrl.getSelectAllGui();n&&(this.eResize.insertAdjacentElement("afterend",n),this.addDestroyFunc(()=>n.remove()))},i={setWidth:n=>e.style.width=n,toggleCss:(n,o)=>this.toggleCss(n,o),setUserStyles:n=>_d(e,n),setAriaSort:n=>n?O7(e,n):N7(e),setUserCompDetails:n=>this.setUserCompDetails(n),getUserCompInstance:()=>this.headerComp,refreshSelectAllGui:t,removeSelectAllGui:()=>this.ctrl.getSelectAllGui()?.remove()};this.ctrl.setComp(i,this.getGui(),this.eResize,this.eHeaderCompWrapper,void 0),t()}destroy(){this.destroyHeaderComp(),super.destroy()}destroyHeaderComp(){this.headerComp&&(this.headerCompGui?.remove(),this.headerComp=this.destroyBean(this.headerComp),this.headerCompGui=void 0)}setUserCompDetails(e){this.headerCompVersion++;let t=this.headerCompVersion;e.newAgStackInstance().then(i=>this.afterCompCreated(t,i))}afterCompCreated(e,t){if(e!=this.headerCompVersion||!this.isAlive()){this.destroyBean(t);return}this.destroyHeaderComp(),this.headerComp=t,this.headerCompGui=t.getGui(),this.eHeaderCompWrapper.appendChild(this.headerCompGui),this.ctrl.setDragSource(this.getGui())}},yB={tag:"div",cls:"ag-header-group-cell",role:"columnheader",children:[{tag:"div",ref:"eHeaderCompWrapper",cls:"ag-header-cell-comp-wrapper",role:"presentation"},{tag:"div",ref:"eResize",cls:"ag-header-cell-resize",role:"presentation"}]},SB=class extends bw{constructor(e){super(yB,e),this.eResize=Z,this.eHeaderCompWrapper=Z}postConstruct(){let e=this.getGui(),t=(n,o)=>o!=null?e.setAttribute(n,o):e.removeAttribute(n),i={toggleCss:(n,o)=>this.toggleCss(n,o),setUserStyles:n=>_d(e,n),setHeaderWrapperHidden:n=>{n?this.eHeaderCompWrapper.style.setProperty("display","none"):this.eHeaderCompWrapper.style.removeProperty("display")},setHeaderWrapperMaxHeight:n=>{n!=null?this.eHeaderCompWrapper.style.setProperty("max-height",`${n}px`):this.eHeaderCompWrapper.style.removeProperty("max-height"),this.eHeaderCompWrapper.classList.toggle("ag-header-cell-comp-wrapper-limited-height",n!=null)},setResizableDisplayed:n=>ft(this.eResize,n),setWidth:n=>e.style.width=n,setAriaExpanded:n=>t("aria-expanded",n),setUserCompDetails:n=>this.setUserCompDetails(n),getUserCompInstance:()=>this.headerGroupComp};this.ctrl.setComp(i,e,this.eResize,this.eHeaderCompWrapper,void 0)}setUserCompDetails(e){e.newAgStackInstance().then(t=>this.afterHeaderCompCreated(t))}afterHeaderCompCreated(e){let t=()=>this.destroyBean(e);if(!this.isAlive()){t();return}let i=this.getGui(),n=e.getGui();this.eHeaderCompWrapper.appendChild(n),this.addDestroyFunc(t),this.headerGroupComp=e,this.ctrl.setDragSource(i)}},xB={tag:"div",cls:"ag-header-cell ag-floating-filter",role:"gridcell",children:[{tag:"div",ref:"eFloatingFilterBody",role:"presentation"},{tag:"div",ref:"eButtonWrapper",cls:"ag-floating-filter-button ag-hidden",role:"presentation",children:[{tag:"button",ref:"eButtonShowMainFilter",cls:"ag-button ag-floating-filter-button-button",attrs:{type:"button",tabindex:"-1"}}]}]},EB=class extends bw{constructor(e){super(xB,e),this.eFloatingFilterBody=Z,this.eButtonWrapper=Z,this.eButtonShowMainFilter=Z}postConstruct(){let e=this.getGui(),t={toggleCss:(i,n)=>this.toggleCss(i,n),setUserStyles:i=>_d(e,i),addOrRemoveBodyCssClass:(i,n)=>this.eFloatingFilterBody.classList.toggle(i,n),setButtonWrapperDisplayed:i=>ft(this.eButtonWrapper,i),setCompDetails:i=>this.setCompDetails(i),getFloatingFilterComp:()=>this.compPromise,setWidth:i=>e.style.width=i,setMenuIcon:i=>this.eButtonShowMainFilter.appendChild(i)};this.ctrl.setComp(t,e,this.eButtonShowMainFilter,this.eFloatingFilterBody,void 0)}setCompDetails(e){if(!e){this.destroyFloatingFilterComp(),this.compPromise=null;return}this.compPromise=e.newAgStackInstance(),this.compPromise.then(t=>this.afterCompCreated(t))}destroy(){this.destroyFloatingFilterComp(),super.destroy()}destroyFloatingFilterComp(){this.floatingFilterComp&&(this.floatingFilterComp.getGui().remove(),this.floatingFilterComp=this.destroyBean(this.floatingFilterComp))}afterCompCreated(e){if(e){if(!this.isAlive()){this.destroyBean(e);return}this.destroyFloatingFilterComp(),this.floatingFilterComp=e,this.eFloatingFilterBody.appendChild(e.getGui()),e.afterGuiAttached&&e.afterGuiAttached()}}},_B=class extends je{constructor(e){super({tag:"div",cls:e.headerRowClass,role:"row"}),this.ctrl=e,this.headerComps={}}postConstruct(){this.getGui().setAttribute("tabindex",String(this.gos.get("tabIndex"))),Pp(this.getGui(),this.ctrl.getAriaRowIndex());let t={setHeight:i=>this.getGui().style.height=i,setTop:i=>this.getGui().style.top=i,setHeaderCtrls:(i,n)=>this.setHeaderCtrls(i,n),setWidth:i=>this.getGui().style.width=i,setRowIndex:i=>Pp(this.getGui(),i)};this.ctrl.setComp(t,void 0)}destroy(){this.setHeaderCtrls([],!1),super.destroy()}setHeaderCtrls(e,t){if(!this.isAlive())return;let i=this.headerComps;this.headerComps={};for(let n of e){let o=n.instanceId,r=i[o];delete i[o],r==null&&(r=this.createHeaderComp(n),this.getGui().appendChild(r.getGui())),this.headerComps[o]=r}if(Object.values(i).forEach(n=>{n.getGui().remove(),this.destroyBean(n)}),t){let n=Object.values(this.headerComps);n.sort((r,s)=>{let a=r.getCtrl().column.getLeft(),l=s.getCtrl().column.getLeft();return a-l});let o=n.map(r=>r.getGui());aR(this.getGui(),o)}}createHeaderComp(e){let t;switch(this.ctrl.type){case"group":t=new SB(e);break;case"filter":t=new EB(e);break;default:t=new bB(e);break}return this.createBean(t),t.setParentComponent(this),t}},yw=class extends A{constructor(e,t,i,n){super(),this.columnOrGroup=e,this.eCell=t,this.colsSpanning=n,this.columnOrGroup=e,this.ariaEl=t.querySelector("[role=columnheader]")||t,this.beans=i}setColsSpanning(e){this.colsSpanning=e,this.onLeftChanged()}getColumnOrGroup(){let{beans:e,colsSpanning:t}=this;return e.gos.get("enableRtl")&&t?rt(t):this.columnOrGroup}postConstruct(){let e=this.onLeftChanged.bind(this);this.addManagedListeners(this.columnOrGroup,{leftChanged:e}),this.setLeftFirstTime(),this.addManagedEventListeners({displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}setLeftFirstTime(){let{gos:e,colAnimation:t}=this.beans,i=e.get("suppressColumnMoveAnimation"),n=ie(this.columnOrGroup.getOldLeft());t?.isActive()&&n&&!i?this.animateInLeft():this.onLeftChanged()}animateInLeft(){let e=this.getColumnOrGroup(),t=this.modifyLeftForPrintLayout(e,e.getOldLeft()),i=this.modifyLeftForPrintLayout(e,e.getLeft());this.setLeft(t),this.actualLeft=i,this.beans.colAnimation.executeNextVMTurn(()=>{this.actualLeft===i&&this.setLeft(i)})}onLeftChanged(){let e=this.getColumnOrGroup(),t=e.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(e,t),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(e,t){let{gos:i,visibleCols:n}=this.beans;if(!li(i,"print")||e.getPinned()==="left")return t;let r=n.getColsLeftWidth();if(e.getPinned()==="right"){let s=n.bodyWidth;return r+s+t}return r+t}setLeft(e){if(ie(e)&&(this.eCell.style.left=`${e}px`),kt(this.columnOrGroup)){let t=this.columnOrGroup.getLeafColumns();if(!t.length)return;t.length>1&&L7(this.ariaEl,t.length)}}},RB=0,NP="headerCtrl",Sw=class extends A{constructor(e,t){super(),this.column=e,this.rowCtrl=t,this.resizeToggleTimeout=0,this.resizeMultiplier=1,this.resizeFeature=null,this.lastFocusEvent=null,this.dragSource=null,this.reAttemptToFocus=!1,this.instanceId=e.getUniqueId()+"-"+RB++}postConstruct(){let e=this.refreshTabIndex.bind(this);this.addManagedPropertyListeners(["suppressHeaderFocus"],e),this.addManagedEventListeners({overlayExclusiveChanged:e})}setComp(e,t,i,n,o){t.setAttribute("col-id",this.column.colIdSanitised),this.wireComp(e,t,i,n,o),this.reAttemptToFocus&&(this.reAttemptToFocus=!1,this.focus(this.lastFocusEvent??void 0))}shouldStopEventPropagation(e){let{headerRowIndex:t,column:i}=this.beans.focusSvc.focusedHeader,n=i.getDefinition(),o=n?.suppressHeaderKeyboardEvent;if(!ie(o))return!1;let r=ye(this.gos,{colDef:n,column:i,headerRowIndex:t,event:e});return!!o(r)}getWrapperHasFocus(){return Ct(this.beans)===this.eGui}setGui(e,t){this.eGui=e,this.addDomData(t),t.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this)}),t.addManagedElementListeners(this.eGui,{focus:this.onGuiFocus.bind(this)}),this.onDisplayedColumnsChanged(),this.refreshTabIndex()}refreshHeaderStyles(){let e=this.column.getDefinition();if(!e)return;let{headerStyle:t}=e,i;if(typeof t=="function"){let n=this.getHeaderClassParams();i=t(n)}else i=t;i&&this.comp.setUserStyles(i)}onGuiFocus(){this.eventSvc.dispatchEvent({type:"headerFocused",column:this.column})}setupAutoHeight(e){let{wrapperElement:t,checkMeasuringCallback:i,compBean:n}=e,{beans:o}=this,r=u=>{if(!this.isAlive()||!n.isAlive())return;let{paddingTop:h,paddingBottom:p,borderBottomWidth:g,borderTopWidth:f}=da(this.eGui),m=h+p+g+f,C=t.offsetHeight+m;if(u<5){let y=!Qt(o)?.contains(t),_=C==0;if(y||_){hC(()=>r(u+1),"raf",o);return}}this.setColHeaderHeight(this.column,C)},s=!1,a,l=()=>{let u=this.column.isAutoHeaderHeight();u&&!s&&c(),!u&&s&&d()},c=()=>{s=!0,this.comp.toggleCss("ag-header-cell-auto-height",!0),r(0),a=is(this.beans,t,()=>r(0))},d=()=>{s=!1,a&&a(),this.comp.toggleCss("ag-header-cell-auto-height",!1),a=void 0};l(),n.addDestroyFunc(()=>d()),n.addManagedListeners(this.column,{widthChanged:()=>s&&r(0)}),n.addManagedEventListeners({sortChanged:()=>{s&&window.setTimeout(()=>r(0))}}),i&&i(l)}onDisplayedColumnsChanged(){let{comp:e,column:t,beans:i,eGui:n}=this;!e||!t||!n||(AP(e,t,i.visibleCols),eR(n,i.visibleCols.getAriaColIndex(t)))}addResizeAndMoveKeyboardListeners(e){e.addManagedListeners(this.eGui,{keydown:this.onGuiKeyDown.bind(this),keyup:this.onGuiKeyUp.bind(this)})}refreshTabIndex(){let e=na(this.beans);this.eGui&&en(this.eGui,"tabindex",e?null:"-1")}onGuiKeyDown(e){let t=Ct(this.beans),i=e.key===T.LEFT||e.key===T.RIGHT;if(this.isResizing&&(e.preventDefault(),e.stopImmediatePropagation()),t!==this.eGui||!e.shiftKey&&!e.altKey||((this.isResizing||i)&&(e.preventDefault(),e.stopImmediatePropagation()),!i))return;let o=e.key===T.LEFT!==this.gos.get("enableRtl")?"left":"right";if(e.altKey){this.isResizing=!0,this.resizeMultiplier+=1;let r=this.getViewportAdjustedResizeDiff(e);this.resizeHeader(r,e.shiftKey),this.resizeFeature?.toggleColumnResizing(!0)}else this.moveHeader(o)}moveHeader(e){this.beans.colMoves?.moveHeader(e,this.eGui,this.column,this.rowCtrl.pinned,this)}getViewportAdjustedResizeDiff(e){let t=this.getResizeDiff(e),{pinnedCols:i}=this.beans;return i?i.getHeaderResizeDiff(t,this.column):t}getResizeDiff(e){let{gos:t,column:i}=this,n=e.key===T.LEFT!==t.get("enableRtl"),o=i.getPinned(),r=t.get("enableRtl");return o&&r!==(o==="right")&&(n=!n),(n?-1:1)*this.resizeMultiplier}onGuiKeyUp(){this.isResizing&&(this.resizeToggleTimeout&&(window.clearTimeout(this.resizeToggleTimeout),this.resizeToggleTimeout=0),this.isResizing=!1,this.resizeMultiplier=1,this.resizeToggleTimeout=window.setTimeout(()=>{this.resizeFeature?.toggleColumnResizing(!1)},150))}handleKeyDown(e){let t=this.getWrapperHasFocus();switch(e.key){case T.PAGE_DOWN:case T.PAGE_UP:case T.PAGE_HOME:case T.PAGE_END:t&&e.preventDefault()}}addDomData(e){let t=NP,{eGui:i,gos:n}=this;sa(n,i,t,this),e.addDestroyFunc(()=>sa(n,i,t,null))}focus(e){if(!this.isAlive())return!1;let{eGui:t}=this;return t?(t.focus(),this.lastFocusEvent=e||null):this.reAttemptToFocus=!0,!0}focusThis(){this.beans.focusSvc.focusedHeader={headerRowIndex:this.rowCtrl.rowIndex,column:this.column}}removeDragSource(){this.dragSource&&(this.beans.dragAndDrop?.removeDragSource(this.dragSource),this.dragSource=null)}handleContextMenuMouseEvent(e,t,i){let n=e??t,{menuSvc:o,gos:r}=this.beans;r.get("preventDefaultOnContextMenu")&&n.preventDefault(),o?.isHeaderContextMenuEnabled(i)&&o.showHeaderContextMenu(i,e,t),this.dispatchColumnMouseEvent("columnHeaderContextMenu",i)}dispatchColumnMouseEvent(e,t){this.eventSvc.dispatchEvent({type:e,column:t})}setColHeaderHeight(e,t){if(!e.setAutoHeaderHeight(t))return;let{eventSvc:i}=this;e.isColumn?i.dispatchEvent({type:"columnHeaderHeightChanged",column:e,columns:[e],source:"autosizeColumnHeaderHeight"}):i.dispatchEvent({type:"columnGroupHeaderHeightChanged",columnGroup:e,source:"autosizeColumnGroupHeaderHeight"})}clearComponent(){this.removeDragSource(),this.resizeFeature=null,this.comp=null,this.eGui=null}destroy(){super.destroy(),this.column=null,this.lastFocusEvent=null,this.rowCtrl=null}},PB=class extends Sw{constructor(){super(...arguments),this.refreshFunctions={},this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map}wireComp(e,t,i,n,o){this.comp=e;let{rowCtrl:r,column:s,beans:a}=this,{colResize:l,context:c,colHover:d,rangeSvc:u}=a,h=Pd(this,c,o);this.setGui(t,h),this.updateState(),this.setupWidth(h),this.setupMovingCss(h),this.setupMenuClass(h),this.setupSortableClass(h),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight({wrapperElement:n,checkMeasuringCallback:g=>this.setRefreshFunction("measuring",g),compBean:h}),this.addColumnHoverListener(h),this.setupFilterClass(h),this.setupStylesFromColDef(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(h),this.setupSelectAll(h),this.setupUserComp(),this.refreshAria(),l?this.resizeFeature=h.createManagedBean(l.createResizeFeature(r.pinned,s,i,e,this)):ft(i,!1),d?.createHoverFeature(h,[s],t),u?.createRangeHighlightFeature(h,s,e),h.createManagedBean(new yw(s,t,a)),h.createManagedBean(new kl(t,{shouldStopEventPropagation:g=>this.shouldStopEventPropagation(g),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addResizeAndMoveKeyboardListeners(h),h.addManagedPropertyListeners(["suppressMovableColumns","suppressMenuHide","suppressAggFuncInHeader","enableAdvancedFilter"],()=>this.refresh()),h.addManagedListeners(s,{colDefChanged:()=>this.refresh()}),h.addManagedListeners(s,{headerHighlightChanged:this.onHeaderHighlightChanged.bind(this)});let p=()=>this.checkDisplayName();h.addManagedEventListeners({columnValueChanged:p,columnRowGroupChanged:p,columnPivotChanged:p,headerHeightChanged:this.onHeaderHeightChanged.bind(this)}),h.addDestroyFunc(()=>{this.refreshFunctions={},this.selectAllFeature=null,this.dragSourceElement=void 0,this.userCompDetails=null,this.userHeaderClasses.clear(),this.ariaDescriptionProperties.clear(),this.clearComponent()})}resizeHeader(e,t){this.beans.colResize?.resizeHeader(this.column,e,t)}getHeaderClassParams(){let{column:e,beans:t}=this,i=e.colDef;return ye(t.gos,{colDef:i,column:e,floatingFilter:!1})}setupUserComp(){let e=this.lookupUserCompDetails();e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setUserCompDetails(e)}lookupUserCompDetails(){let e=this.createParams(),t=this.column.getColDef();return DO(this.beans.userCompFactory,t,e)}createParams(){let{menuSvc:e,sortSvc:t,colFilter:i,gos:n}=this.beans;return ye(n,{column:this.column,displayName:this.displayName,enableSorting:this.column.isSortable(),enableMenu:this.menuEnabled,enableFilterButton:this.openFilterEnabled&&!!e?.isHeaderFilterButtonEnabled(this.column),enableFilterIcon:!!i&&(!this.openFilterEnabled||tn(this.gos)),showColumnMenu:(r,s)=>{e?.showColumnMenu({column:this.column,buttonElement:r,positionBy:"button",onClosedCallback:s})},showColumnMenuAfterMouseClick:(r,s)=>{e?.showColumnMenu({column:this.column,mouseEvent:r,positionBy:"mouse",onClosedCallback:s})},showFilter:r=>{e?.showFilterMenu({column:this.column,buttonElement:r,containerType:"columnFilter",positionBy:"button"})},progressSort:r=>{t?.progressSort(this.column,!!r,"uiColumnSorted")},setSort:(r,s)=>{t?.setSortForColumn(this.column,r,!!s,"uiColumnSorted")},eGridHeader:this.eGui,setTooltip:(r,s)=>{n.assertModuleRegistered("Tooltip",3),this.setupTooltip(r,s)}})}setupSelectAll(e){let{selectionSvc:t}=this.beans;t&&(this.selectAllFeature=e.createOptionalManagedBean(t.createSelectAllFeature(this.column)),this.selectAllFeature?.setComp(this),e.addManagedPropertyListener("rowSelection",()=>{let i=t.createSelectAllFeature(this.column);i&&!this.selectAllFeature?(this.selectAllFeature=e.createManagedBean(i),this.selectAllFeature?.setComp(this),this.comp.refreshSelectAllGui()):this.selectAllFeature&&!i&&(this.comp.removeSelectAllGui(),this.selectAllFeature=this.destroyBean(this.selectAllFeature))}))}getSelectAllGui(){return this.selectAllFeature?.getCheckboxGui()}handleKeyDown(e){super.handleKeyDown(e),e.key===T.SPACE&&this.selectAllFeature?.onSpaceKeyDown(e),e.key===T.ENTER&&this.onEnterKeyDown(e),e.key===T.DOWN&&e.altKey&&this.showMenuOnKeyPress(e,!1)}onEnterKeyDown(e){e.ctrlKey||e.metaKey?this.showMenuOnKeyPress(e,!0):this.sortable&&this.beans.sortSvc?.progressSort(this.column,e.shiftKey,"uiColumnSorted")}showMenuOnKeyPress(e,t){let i=this.comp.getUserCompInstance();n_(i)&&i.onMenuKeyboardShortcut(t)&&e.preventDefault()}onFocusIn(e){this.eGui.contains(e.relatedTarget)||(this.focusThis(),this.announceAriaDescription()),QO()&&this.setActiveHeader(!0)}onFocusOut(e){this.eGui.contains(e.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(e,t){this.tooltipFeature=this.beans.tooltipSvc?.setupHeaderTooltip(this.tooltipFeature,this,e,t)}setupStylesFromColDef(){this.setRefreshFunction("headerStyles",this.refreshHeaderStyles.bind(this)),this.refreshHeaderStyles()}setupClassesFromColDef(){let e=()=>{let t=this.column.getColDef(),i=IP(t,this.gos,this.column,null),n=this.userHeaderClasses;this.userHeaderClasses=new Set(i);for(let o of i)n.has(o)?n.delete(o):this.comp.toggleCss(o,!0);for(let o of n)this.comp.toggleCss(o,!1)};this.setRefreshFunction("headerClasses",e),e()}setDragSource(e){this.dragSourceElement=e,this.removeDragSource(),!(!e||!this.draggable)&&(this.dragSource=this.beans.colMoves?.setDragSourceForHeader(e,this.column,this.displayName)??null)}updateState(){let{menuSvc:e}=this.beans;this.menuEnabled=!!e?.isColumnMenuInHeaderEnabled(this.column),this.openFilterEnabled=!!e?.isFilterMenuInHeaderEnabled(this.column),this.sortable=this.column.isSortable(),this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}setRefreshFunction(e,t){this.refreshFunctions[e]=t}refresh(){this.updateState(),this.refreshHeaderComp(),this.refreshAria();for(let e of Object.values(this.refreshFunctions))e()}refreshHeaderComp(){let e=this.lookupUserCompDetails();if(!e)return;(this.comp.getUserCompInstance()!=null&&this.userCompDetails.componentClass==e.componentClass?this.attemptHeaderCompRefresh(e.params):!1)?this.setDragSource(this.dragSourceElement):this.setCompDetails(e)}attemptHeaderCompRefresh(e){let t=this.comp.getUserCompInstance();return!t||!t.refresh?!1:t.refresh(e)}calculateDisplayName(){return this.beans.colNames.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(){this.displayName!==this.calculateDisplayName()&&this.refresh()}workOutDraggable(){let e=this.column.getColDef();return!!(!this.gos.get("suppressMovableColumns")&&!e.suppressMovable&&!e.lockPosition)||!!e.enableRowGroup||!!e.enablePivot}setupWidth(e){let t=()=>{let i=this.column.getActualWidth();this.comp.setWidth(`${i}px`)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupMovingCss(e){let t=()=>{this.comp.toggleCss("ag-header-cell-moving",this.column.isMoving())};e.addManagedListeners(this.column,{movingChanged:t}),t()}setupMenuClass(e){let t=()=>{this.comp?.toggleCss("ag-column-menu-visible",this.column.isMenuVisible())};e.addManagedListeners(this.column,{menuVisibleChanged:t}),t()}setupSortableClass(e){let t=()=>{this.comp.toggleCss("ag-header-cell-sortable",!!this.sortable)};t(),this.setRefreshFunction("updateSortable",t),e.addManagedEventListeners({sortChanged:this.refreshAriaSort.bind(this)})}setupFilterClass(e){let t=()=>{let i=this.column.isFilterActive();this.comp.toggleCss("ag-header-cell-filtered",i),this.refreshAria()};e.addManagedListeners(this.column,{filterActiveChanged:t}),t()}setupWrapTextClass(){let e=()=>{let t=!!this.column.getColDef().wrapHeaderText;this.comp.toggleCss("ag-header-cell-wrap-text",t)};e(),this.setRefreshFunction("wrapText",e)}onHeaderHighlightChanged(){let e=this.column.getHighlighted(),t=e===0,i=e===1;this.comp.toggleCss("ag-header-highlight-before",t),this.comp.toggleCss("ag-header-highlight-after",i)}onDisplayedColumnsChanged(){super.onDisplayedColumnsChanged(),this.isAlive()&&this.onHeaderHeightChanged()}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){let{eGui:e,column:t,comp:i,beans:n}=this,o=Cw(this.beans),r=o.reduce((h,p)=>h+p,0)===0;if(i.toggleCss("ag-header-parent-hidden",r),!t.isSpanHeaderHeight()){e.style.removeProperty("top"),e.style.removeProperty("height"),i.toggleCss("ag-header-span-height",!1),i.toggleCss("ag-header-span-total",!1);return}let{numberOfParents:s,isSpanningTotal:a}=this.column.getColumnGroupPaddingInfo();i.toggleCss("ag-header-span-height",s>0);let l=ww(n);if(s===0){i.toggleCss("ag-header-span-total",!1),e.style.setProperty("top","0px"),e.style.setProperty("height",`${l}px`);return}i.toggleCss("ag-header-span-total",a);let c=(this.column.getFirstRealParent()?.getLevel()??-1)+1,d=o.length-c,u=0;for(let h=0;h<d;h++)u+=o[o.length-1-h];e.style.setProperty("top",`${-u}px`),e.style.setProperty("height",`${l+u}px`)}refreshAriaSort(){if(this.sortable){let e=this.getLocaleTextFunc(),t=this.beans.sortSvc?.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(x7(t)),this.setAriaDescriptionProperty("sort",e("ariaSortableColumn","Press ENTER to sort"))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)}refreshAriaMenu(){if(this.menuEnabled){let e=this.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",e("ariaMenuColumn","Press ALT DOWN to open column menu"))}else this.setAriaDescriptionProperty("menu",null)}refreshAriaFilterButton(){if(this.openFilterEnabled&&!tn(this.gos)){let e=this.getLocaleTextFunc();this.setAriaDescriptionProperty("filterButton",e("ariaFilterColumn","Press CTRL ENTER to open filter"))}else this.setAriaDescriptionProperty("filterButton",null)}refreshAriaFiltered(){let e=this.getLocaleTextFunc();this.column.isFilterActive()?this.setAriaDescriptionProperty("filter",e("ariaColumnFiltered","Column Filtered")):this.setAriaDescriptionProperty("filter",null)}setAriaDescriptionProperty(e,t){t!=null?this.ariaDescriptionProperties.set(e,t):this.ariaDescriptionProperties.delete(e)}announceAriaDescription(){if(!this.eGui.contains(Ct(this.beans)))return;let e=Array.from(this.ariaDescriptionProperties.keys()).sort((t,i)=>t==="filter"?-1:i.charCodeAt(0)-t.charCodeAt(0)).map(t=>this.ariaDescriptionProperties.get(t)).join(". ");this.beans.ariaAnnounce?.announceValue(e,"columnHeader")}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaFilterButton(),this.refreshAriaFiltered()}addColumnHoverListener(e){this.beans.colHover?.addHeaderColumnHoverListener(e,this.comp,this.column)}addActiveHeaderMouseListeners(e){let t=o=>this.handleMouseOverChange(o.type==="mouseenter"),i=()=>{this.setActiveHeader(!0),this.dispatchColumnMouseEvent("columnHeaderClicked",this.column)},n=o=>this.handleContextMenuMouseEvent(o,void 0,this.column);e.addManagedListeners(this.eGui,{mouseenter:t,mouseleave:t,click:i,contextmenu:n})}handleMouseOverChange(e){this.setActiveHeader(e),this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column})}setActiveHeader(e){this.comp.toggleCss("ag-header-active",e)}getAnchorElementForMenu(e){let t=this.comp.getUserCompInstance();return n_(t)?t.getAnchorElementForMenu(e):this.eGui}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function n_(e){return typeof e?.getAnchorElementForMenu=="function"&&typeof e.onMenuKeyboardShortcut=="function"}var DB=0,jv=class extends A{constructor(e,t,i){super(),this.rowIndex=e,this.pinned=t,this.type=i,this.instanceId=DB++,this.comp=null,this.allCtrls=[];let n="ag-header-row-column";i==="group"?n="ag-header-row-group":i==="filter"&&(n="ag-header-row-filter"),this.headerRowClass=`ag-header-row ${n}`}setRowIndex(e){this.rowIndex=e,this.comp?.setRowIndex(this.getAriaRowIndex()),this.onRowHeightChanged()}postConstruct(){this.isPrintLayout=li(this.gos,"print"),this.isEnsureDomOrder=this.gos.get("ensureDomOrder")}areCellsRendered(){return this.comp?this.allCtrls.every(e=>e.eGui!=null):!1}setComp(e,t,i=!0){this.comp=e,t=Pd(this,this.beans.context,t),i&&(this.setRowIndex(this.rowIndex),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners(t)}getAriaRowIndex(){return this.rowIndex+1}addEventListeners(e){let t=this.onRowHeightChanged.bind(this),i=this.onDisplayedColumnsChanged.bind(this);e.addManagedEventListeners({columnResized:this.setWidth.bind(this),displayedColumnsChanged:i,virtualColumnsChanged:n=>this.onVirtualColumnsChanged(n.afterScroll),columnGroupHeaderHeightChanged:t,columnHeaderHeightChanged:t,gridStylesChanged:t,advancedFilterEnabledChanged:t}),e.addManagedPropertyListener("domLayout",i),e.addManagedPropertyListener("ensureDomOrder",n=>this.isEnsureDomOrder=n.currentValue),e.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],t)}onDisplayedColumnsChanged(){this.isPrintLayout=li(this.gos,"print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}setWidth(){if(!this.comp)return;let e=this.getWidthForRow();this.comp.setWidth(`${e}px`)}getWidthForRow(){let{visibleCols:e}=this.beans;return this.isPrintLayout?this.pinned!=null?0:e.getContainerWidth("right")+e.getContainerWidth("left")+e.getContainerWidth(null):e.getContainerWidth(this.pinned)}onRowHeightChanged(){if(!this.comp)return;let{topOffset:e,rowHeight:t}=this.getTopAndHeight();this.comp.setTop(e+"px"),this.comp.setHeight(t+"px")}getTopAndHeight(){let e=0,t=Cw(this.beans);for(let o=0;o<t.length;o++){if(o===this.rowIndex&&this.type==="group")return{topOffset:e,rowHeight:t[o]};e+=t[o]}let i=ww(this.beans);if(this.type==="column")return{topOffset:e,rowHeight:i};e+=i;let n=LP(this.beans);return{topOffset:e,rowHeight:n}}onVirtualColumnsChanged(e=!1){if(!this.comp)return;let t=this.getUpdatedHeaderCtrls(),i=this.isEnsureDomOrder||this.isPrintLayout;this.comp.setHeaderCtrls(t,i,e)}getUpdatedHeaderCtrls(){let e=this.ctrlsById;this.ctrlsById=new Map;let t=this.getColumnsInViewport();for(let n of t)this.recycleAndCreateHeaderCtrls(n,this.ctrlsById,e);let i=n=>{let{focusSvc:o,visibleCols:r}=this.beans;return o.isHeaderWrapperFocused(n)?r.isVisible(n.column):!1};if(e)for(let[n,o]of e)i(o)?this.ctrlsById.set(n,o):this.destroyBean(o);return this.allCtrls=Array.from(this.ctrlsById.values()),this.allCtrls}getHeaderCellCtrls(){return this.allCtrls}recycleAndCreateHeaderCtrls(e,t,i){if(e.isEmptyGroup())return;let n=e.getUniqueId(),o;if(i&&(o=i.get(n),i.delete(n)),o&&o.column!=e&&(this.destroyBean(o),o=void 0),o==null)switch(this.type){case"filter":{o=this.createBean(this.beans.registry.createDynamicBean("headerFilterCellCtrl",!0,e,this));break}case"group":o=this.createBean(this.beans.registry.createDynamicBean("headerGroupCellCtrl",!0,e,this));break;default:o=this.createBean(new PB(e,this));break}t.set(n,o)}getColumnsInViewport(){if(!this.isPrintLayout)return this.getComponentsToRender();if(this.pinned)return[];let e=[];for(let t of["left",null,"right"])e.push(...this.getComponentsToRender(t));return e}getComponentsToRender(e=this.pinned){return this.type==="group"?this.beans.colViewport.getHeadersToRender(e,this.rowIndex):this.beans.colViewport.getColumnHeadersToRender(e)}focusHeader(e,t){let i=this.allCtrls.find(o=>o.column==e);return i?i.focus(t):!1}destroy(){this.allCtrls=this.destroyBeans(this.allCtrls),this.ctrlsById=void 0,this.comp=null,super.destroy()}},MB=class extends A{constructor(e){super(),this.pinned=e,this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[]}setComp(e,t){this.comp=e,this.eViewport=t;let{pinnedCols:i,ctrlsSvc:n,colModel:o,colMoves:r}=this.beans;this.setupCenterWidth(),i?.setupHeaderPinnedWidth(this),this.setupDragAndDrop(r,this.eViewport);let s=this.refresh.bind(this,!0);this.addManagedEventListeners({displayedColumnsChanged:s,advancedFilterEnabledChanged:s});let a=`${typeof this.pinned=="string"?this.pinned:"center"}Header`;n.register(a,this),o.ready&&this.refresh()}getAllCtrls(){let e=[...this.groupsRowCtrls];return this.columnsRowCtrl&&e.push(this.columnsRowCtrl),this.filtersRowCtrl&&e.push(this.filtersRowCtrl),e}refresh(e=!1){let{focusSvc:t,filterManager:i,visibleCols:n}=this.beans,o=0,r=t.getFocusHeaderToUseAfterRefresh(),s=()=>{let u=n.headerGroupRowCount;o=u,e||(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls));let h=this.groupsRowCtrls.length;if(h!==u){if(h>u){for(let p=u;p<h;p++)this.destroyBean(this.groupsRowCtrls[p]);this.groupsRowCtrls.length=u;return}for(let p=h;p<u;p++){let g=this.createBean(new jv(p,this.pinned,"group"));this.groupsRowCtrls.push(g)}}},a=()=>{let u=o++;if(this.hidden){this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl);return}this.columnsRowCtrl==null||!e?(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl),this.columnsRowCtrl=this.createBean(new jv(u,this.pinned,"column"))):this.columnsRowCtrl.rowIndex!==u&&this.columnsRowCtrl.setRowIndex(u)},l=()=>{this.includeFloatingFilter=!!i?.hasFloatingFilters()&&!this.hidden;let u=()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)};if(!this.includeFloatingFilter){u();return}e||u();let h=o++;this.filtersRowCtrl?this.filtersRowCtrl.rowIndex!==h&&this.filtersRowCtrl.setRowIndex(h):this.filtersRowCtrl=this.createBean(new jv(h,this.pinned,"filter"))},c=this.getAllCtrls();s(),a(),l();let d=this.getAllCtrls();this.comp.setCtrls(d),this.restoreFocusOnHeader(t,r),c.length!==d.length&&this.beans.eventSvc.dispatchEvent({type:"headerRowsChanged"})}getHeaderCtrlForColumn(e){let t=i=>i?.getHeaderCellCtrls().find(n=>n.column===e);if(es(e))return t(this.columnsRowCtrl);if(this.groupsRowCtrls.length!==0)for(let i=0;i<this.groupsRowCtrls.length;i++){let n=t(this.groupsRowCtrls[i]);if(n)return n}}getHtmlElementForColumnHeader(e){return this.getHeaderCtrlForColumn(e)?.eGui??null}getRowType(e){return this.getAllCtrls()[e]?.type}focusHeader(e,t,i){let o=this.getAllCtrls()[e];return o?o.focusHeader(t,i):!1}getGroupRowCount(){return this.groupsRowCtrls.length}getGroupRowCtrlAtIndex(e){return this.groupsRowCtrls[e]}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}setHorizontalScroll(e){this.comp.setViewportScrollLeft(e)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}destroy(){this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl),this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl),this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls),super.destroy()}setupDragAndDrop(e,t){let i=e?.createBodyDropTarget(this.pinned,t);i&&this.createManagedBean(i)}restoreFocusOnHeader(e,t){if(!t)return;let{column:i}=t;i.getPinned()==this.pinned&&e.focusHeaderPosition({headerPosition:t,scroll:!1})}setupCenterWidth(){this.pinned==null&&this.createManagedBean(new mw(e=>this.comp.setCenterWidth(`${e}px`),!0))}},kB=class extends A{constructor(){super(...arguments),this.beanName="menuSvc"}postConstruct(){let{enterpriseMenuFactory:e,filterMenuFactory:t}=this.beans;this.activeMenuFactory=e??t}showColumnMenu(e){this.showColumnMenuCommon(this.activeMenuFactory,e,"columnMenu")}showFilterMenu(e){this.showColumnMenuCommon(r_(this.beans),e,e.containerType,!0)}showHeaderContextMenu(e,t,i){this.activeMenuFactory?.showMenuAfterContextMenuEvent(e,t,i)}hidePopupMenu(){this.beans.contextMenuSvc?.hideActiveMenu(),this.activeMenuFactory?.hideActiveMenu()}hideFilterMenu(){r_(this.beans)?.hideActiveMenu()}isColumnMenuInHeaderEnabled(e){let{suppressHeaderMenuButton:t}=e.getColDef();return!t&&!!this.activeMenuFactory?.isMenuEnabled(e)&&(tn(this.gos)||!!this.beans.enterpriseMenuFactory)}isFilterMenuInHeaderEnabled(e){return!e.getColDef().suppressHeaderFilterButton&&!!this.beans.filterManager?.isFilterAllowed(e)}isHeaderContextMenuEnabled(e){return!(e&&es(e)?e.getColDef():e?.getColGroupDef())?.suppressHeaderContextMenu&&this.gos.get("columnMenu")==="new"}isHeaderMenuButtonAlwaysShowEnabled(){return this.isSuppressMenuHide()}isHeaderMenuButtonEnabled(){let e=!this.isSuppressMenuHide();return!(ia()&&e)}isHeaderFilterButtonEnabled(e){return this.isFilterMenuInHeaderEnabled(e)&&!tn(this.gos)&&!this.isFloatingFilterButtonDisplayed(e)}isFilterMenuItemEnabled(e){return!!this.beans.filterManager?.isFilterAllowed(e)&&!tn(this.gos)&&!this.isFilterMenuInHeaderEnabled(e)&&!this.isFloatingFilterButtonDisplayed(e)}isFloatingFilterButtonEnabled(e){return!e.getColDef().suppressFloatingFilterButton}isFloatingFilterButtonDisplayed(e){return!!e.getColDef().floatingFilter&&this.isFloatingFilterButtonEnabled(e)}isSuppressMenuHide(){let e=this.gos,t=e.get("suppressMenuHide");return tn(e)?e.exists("suppressMenuHide")?t:!1:t}showColumnMenuCommon(e,t,i,n){let{positionBy:o,onClosedCallback:r}=t,s=t.column;if(o==="button"){let{buttonElement:a}=t;e?.showMenuAfterButtonClick(s,a,i,r,n)}else if(o==="mouse"){let{mouseEvent:a}=t;e?.showMenuAfterMouseEvent(s,a,i,r,n)}else if(s){let a=this.beans,l=a.ctrlsSvc;l.getScrollFeature().ensureColumnVisible(s,"auto"),cr(a,()=>{let c=l.getHeaderRowContainerCtrl(s.getPinned())?.getHeaderCtrlForColumn(s);c&&e?.showMenuAfterButtonClick(s,c.getAnchorElementForMenu(n),i,r,n)})}}};function o_(e,t,i){e.menuVisible!==t&&(e.menuVisible=t,e.dispatchColEvent("menuVisibleChanged",i))}function r_(e){let{enterpriseMenuFactory:t,filterMenuFactory:i,gos:n}=e;return t&&tn(n)?t:i}var ng=class extends ow{constructor(){super(...arguments),this.errorMessages=null}init(e){this.params=e,this.initialiseEditor(e),this.eEditor.onValueChange(()=>e.validate())}destroy(){this.errorMessages=null}},BP=class extends je{constructor(){super()}},TB={tag:"span",cls:"ag-overlay-loading-center"},FB=class extends BP{init(){let e=nr(this.gos.get("overlayLoadingTemplate")?.trim());if(this.setTemplate(e??TB),!e){let i=this.getLocaleTextFunc()("loadingOoo","Loading...");this.getGui().textContent=i,this.beans.ariaAnnounce.announceValue(i,"overlay")}}},IB={tag:"span",cls:"ag-overlay-no-rows-center"},AB=class extends BP{init(){let e=nr(this.gos.get("overlayNoRowsTemplate")?.trim());if(this.setTemplate(e??IB),!e){let i=this.getLocaleTextFunc()("noRowsToShow","No Rows To Show");this.getGui().textContent=i,this.beans.ariaAnnounce.announceValue(i,"overlay")}}};function LB(e,t,i){let n=wn(e,t,i);if(n){let{className:r}=n;if(typeof r=="string"&&r.includes("ag-icon")||typeof r=="object"&&r["ag-icon"])return n}let o=Ft({tag:"span"});return o.appendChild(n),o}function wn(e,t,i){let n=null;e==="smallDown"?W(262):e==="smallLeft"?W(263):e==="smallRight"&&W(264);let o=i?.getColDef().icons;if(o&&(n=o[e]),t.gos&&!n){let r=t.gos.get("icons");r&&(n=r[e])}if(n){let r;if(typeof n=="function")r=n();else if(typeof n=="string")r=n;else{W(38,{iconName:e});return}if(typeof r=="string")return jC(r);if(XC(r))return r;W(133,{iconName:e});return}else{let r=t.registry.getIcon(e);return r||t.validation?.validateIcon(e),Ft({tag:"span",cls:`ag-icon ag-icon-${r??e}`,role:"presentation",attrs:{unselectable:"on"}})}}var OB=".ag-dnd-ghost{align-items:center;background-color:var(--ag-drag-and-drop-image-background-color);border:var(--ag-drag-and-drop-image-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-drag-and-drop-image-shadow);color:var(--ag-text-color);cursor:move;display:flex;font-weight:500;gap:var(--ag-cell-widget-spacing);height:var(--ag-header-height);overflow:hidden;padding-left:var(--ag-cell-horizontal-padding);padding-right:var(--ag-cell-horizontal-padding);text-overflow:ellipsis;transform:translateY(calc(var(--ag-spacing)*2));white-space:nowrap}.ag-dnd-ghost-not-allowed{border:var(--ag-drag-and-drop-image-not-allowed-border)}",NB={tag:"div",children:[{tag:"div",ref:"eGhost",cls:"ag-dnd-ghost ag-unselectable",children:[{tag:"span",ref:"eIcon",cls:"ag-dnd-ghost-icon ag-shake-left-to-right"},{tag:"div",ref:"eLabel",cls:"ag-dnd-ghost-label"}]}]},BB=class extends je{constructor(){super(),this.dragSource=null,this.eIcon=Z,this.eLabel=Z,this.eGhost=Z,this.registerCSS(OB)}postConstruct(){let e=t=>LB(t,this.beans,null);this.dropIconMap={pinned:e("columnMovePin"),hide:e("columnMoveHide"),move:e("columnMoveMove"),left:e("columnMoveLeft"),right:e("columnMoveRight"),group:e("columnMoveGroup"),aggregate:e("columnMoveValue"),pivot:e("columnMovePivot"),notAllowed:e("dropNotAllowed")}}init(e){this.dragSource=e.dragSource,this.setTemplate(NB),this.beans.environment.applyThemeClasses(this.eGhost)}destroy(){this.dragSource=null,super.destroy()}setIcon(e,t){let{eGhost:i,eIcon:n,dragSource:o,dropIconMap:r,gos:s}=this;ai(n);let a=null;e||(e=o?.getDefaultIconName?o.getDefaultIconName():"notAllowed"),a=r[e],i.classList.toggle("ag-dnd-ghost-not-allowed",e==="notAllowed"),n.classList.toggle("ag-shake-left-to-right",t),!(a===r.hide&&s.get("suppressDragLeaveHidesColumns"))&&a&&n.appendChild(a)}setLabel(e){this.eLabel.textContent=e}},HB=".ag-checkbox-cell{height:100%}",VB={tag:"div",cls:"ag-cell-wrapper ag-checkbox-cell",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},GB=class extends je{constructor(){super(VB,[aw]),this.eCheckbox=Z,this.registerCSS(HB)}init(e){this.refresh(e);let{eCheckbox:t,beans:i}=this,n=t.getInputElement();n.setAttribute("tabindex","-1"),Q_(n,"polite"),this.addManagedListeners(n,{click:o=>{if(la(o),t.isDisabled())return;let r=t.getValue();this.onCheckboxChanged(r)},dblclick:o=>{la(o)}}),this.addManagedElementListeners(e.eGridCell,{keydown:o=>{if(o.key===T.SPACE&&!t.isDisabled()){e.eGridCell===Ct(i)&&t.toggle();let r=t.getValue();this.onCheckboxChanged(r),o.preventDefault()}}})}refresh(e){return this.params=e,this.updateCheckbox(e),!0}updateCheckbox(e){let t,i=!0,{value:n,column:o,node:r}=e;if(r.group&&o)if(typeof n=="boolean")t=n;else{let u=o.getColId();u.startsWith(Qp)?t=n==null||n===""?void 0:n==="true":r.aggData&&r.aggData[u]!==void 0||r.sourceRowIndex>=0?t=n??void 0:i=!1}else t=n??void 0;let{eCheckbox:s}=this;if(!i){s.setDisplayed(!1);return}s.setValue(t);let a=e.disabled??!o?.isCellEditable(r);s.setDisabled(a);let l=this.getLocaleTextFunc(),c=Xp(l,t),d=a?c:`${l("ariaToggleCellValue","Press SPACE to toggle cell value")} (${c})`;s.setInputAriaLabel(d)}onCheckboxChanged(e){let{params:t}=this,{column:i,node:n,value:o}=t;this.beans?.editSvc?.setEditingCells([{column:i,colId:i.getColId(),rowIndex:n.rowIndex,rowPinned:n.rowPinned,state:"changed",oldValue:o,newValue:o}],{update:!0,forceRefreshOfEditCellsOnly:!0});let r=n.setDataValue(i,e,"renderer");this.beans.editSvc?.stopEditing({rowNode:n,column:i},{source:this.beans.editSvc?.isBatchEditing()?"ui":"api"}),r||this.updateCheckbox(t)}},s_=class{constructor(e,t){this.beans=e,this.floating=t,this.all=new Set,this.visible=new Set,this.order=[],this.queued=new Set}size(){return this.visible.size}add(e){let{all:t,visible:i,order:n}=this;t.has(e)||(t.add(e),i.add(e),n.push(e),this.sort())}delete(e){this.all.delete(e),this.visible.delete(e),this.queued.delete(e.id),Hn(this.order,e)}has(e){return this.visible.has(e)}forEach(e){this.order.forEach(e)}getByIndex(e){return this.order[e]}getById(e){for(let t of this.visible)if(t.id==e)return t}clear(){let{all:e,visible:t,order:i,queued:n}=this;e.clear(),n.clear(),t.clear(),i.length=0}sort(){let{sortSvc:e,rowNodeSorter:t,gos:i}=this.beans,n=e?.getSortOptions()??[],o=UB(this.order);if(this.order.sort((s,a)=>(s.pinnedSibling?.rowIndex??0)-(a.pinnedSibling?.rowIndex??0)),this.order=t?.doFullSort(this.order,n)??this.order,!o)return;let r=PR(i);r==="bottom"||r==="pinnedBottom"?this.order.push(o):this.order.unshift(o)}hide(e){let{all:t,visible:i}=this;t.forEach(n=>e(n)?i.delete(n):i.add(n)),this.order=Array.from(i),this.sort()}queue(e){this.queued.add(e)}unqueue(e){this.queued.delete(e)}forEachQueued(e){this.queued.forEach(e)}};function HP(e){if(e.level===-1)return!0;let t=e.parent;return t?.childrenAfterSort?.some(i=>i==e)?HP(t):!1}function Kv(e,t){let{gos:i,rowModel:n,filterManager:o}=e;return Ml(i,n)?!n.getRowNode(t.id):o?.isAnyFilterPresent()?!HP(t):i.get("pivotMode")?!t.group:!1}function zB(e){return!!e.footer&&e.level===-1}function WB(e){return!!e.pinnedSibling&&zB(e.pinnedSibling)}function UB(e){let t=e.findIndex(WB);if(t>-1)return e.splice(t,1)?.[0]}var a_=class extends A{postConstruct(){let{gos:e,beans:t}=this;this.top=new s_(t,"top"),this.bottom=new s_(t,"bottom");let i=o=>Kv(t,o.pinnedSibling),n=()=>{let o=e.get("isRowPinned");o&&e.get("enableRowPinning")&&t.rowModel.forEachNode(r=>this.pinRow(r,o(r)),!0),this.refreshRowPositions(),this.dispatchRowPinnedEvents()};this.addManagedEventListeners({gridStylesChanged:this.onGridStylesChanges.bind(this),modelUpdated:({keepRenderedRows:o})=>{this.tryToEmptyQueues(),this.pinGrandTotalRow(),this.forContainers(s=>s.hide(i));let r=this.refreshRowPositions();(!o||r)&&this.dispatchRowPinnedEvents()},columnRowGroupChanged:()=>{this.forContainers($B),this.refreshRowPositions()},rowNodeDataChanged:({node:o})=>{(e.get("isRowPinnable")?.(o)??!0)||this.pinRow(o,null)},firstDataRendered:n}),this.addManagedPropertyListener("pivotMode",()=>{this.forContainers(o=>o.hide(i)),this.dispatchRowPinnedEvents()}),this.addManagedPropertyListener("grandTotalRow",({currentValue:o})=>{this._grandTotalPinned=o==="pinnedBottom"?"bottom":o==="pinnedTop"?"top":null}),this.addManagedPropertyListener("isRowPinned",n)}destroy(){this.reset(!1),super.destroy()}reset(e=!0){this.forContainers(t=>{let i=[];t.forEach(n=>i.push(n)),i.forEach(n=>this.pinRow(n,null)),t.clear()}),e&&this.dispatchRowPinnedEvents()}pinRow(e,t,i){if(e.footer&&e.level>-1)return;if(e.footer&&e.level===-1){this._grandTotalPinned=t,KB(this.beans);return}let n=e.rowPinned??e.pinnedSibling?.rowPinned;if(n!=null&&t!=null&&t!=n){let s=e.rowPinned?e:e.pinnedSibling,a=e.rowPinned?e.pinnedSibling:e;this.pinRow(s,null,i),this.pinRow(a,t,i);return}let r=i&&jB(this.beans,e,i);if(r){r.forEach(s=>this.pinRow(s,t));return}if(t==null){let s=e.rowPinned?e:e.pinnedSibling,a=this.findPinnedRowNode(s);if(!a)return;a.delete(s);let l=s.pinnedSibling;Yv(s),this.refreshRowPositions(t),this.dispatchRowPinnedEvents(l)}else{let s=l_(this.beans,e,t),a=this.getContainer(t);a.add(s),Kv(this.beans,e)&&a.hide(l=>Kv(this.beans,l.pinnedSibling)),this.refreshRowPositions(t),this.dispatchRowPinnedEvents(e)}}isManual(){return!0}isEmpty(e){return this.getContainer(e).size()===0}isRowsToRender(e){return!this.isEmpty(e)}ensureRowHeightsValid(){let e=!1,t=0,i=n=>{if(n.rowHeightEstimated){let o=Zr(this.beans,n);n.setRowTop(t),n.setRowHeight(o.height),t+=o.height,e=!0}};return this.bottom.forEach(i),t=0,this.top.forEach(i),this.eventSvc.dispatchEvent({type:"pinnedHeightChanged"}),e}getPinnedTopTotalHeight(){return c_(this.top)}getPinnedBottomTotalHeight(){return c_(this.bottom)}getPinnedTopRowCount(){return this.top.size()}getPinnedBottomRowCount(){return this.bottom.size()}getPinnedTopRow(e){return this.top.getByIndex(e)}getPinnedBottomRow(e){return this.bottom.getByIndex(e)}getPinnedRowById(e,t){return this.getContainer(t).getById(e)}forEachPinnedRow(e,t){this.getContainer(e).forEach(t)}getPinnedState(){let e=t=>{let i=[];return this.forEachPinnedRow(t,n=>i.push(n.pinnedSibling.id)),i};return{top:e("top"),bottom:e("bottom")}}setPinnedState(e){this.forContainers((t,i)=>{for(let n of e[i]){let o=this.beans.rowModel.getRowNode(n);o?this.pinRow(o,i):t.queue(n)}})}getGrandTotalPinned(){return this._grandTotalPinned}setGrandTotalPinned(e){this._grandTotalPinned=e}tryToEmptyQueues(){this.forContainers((e,t)=>{let i=new Set;e.forEachQueued(n=>{let o=this.beans.rowModel.getRowNode(n);o&&i.add(o)});for(let n of i)e.unqueue(n.id),this.pinRow(n,t)})}pinGrandTotalRow(){let{gos:e,beans:t,_grandTotalPinned:i}=this,n=t.rowModel;if(!Tt(e,n))return;let o=n.rootNode?.sibling;if(!o)return;let r=o.pinnedSibling,s=r&&this.findPinnedRowNode(r);if(i){if(s&&s.floating!==i&&(s.delete(r),Yv(r)),!s||s.floating!==i){let a=l_(t,o,i);this.getContainer(i).add(a)}}else{if(!s)return;s.delete(r),Yv(r)}}onGridStylesChanges(e){e.rowHeightChanged&&this.forContainers(t=>t.forEach(i=>i.setRowHeight(i.rowHeight,!0)))}getContainer(e){return e==="top"?this.top:this.bottom}findPinnedRowNode(e){if(this.top.has(e))return this.top;if(this.bottom.has(e))return this.bottom}refreshRowPositions(e){let t=n=>qB(this.beans,n);if(e)return t(this.getContainer(e));let i=!1;return this.forContainers(n=>{let o=t(n);i||(i=o)}),i}forContainers(e){e(this.top,"top"),e(this.bottom,"bottom")}dispatchRowPinnedEvents(e){this.eventSvc.dispatchEvent({type:"pinnedRowsChanged"}),e?.dispatchRowEvent("rowPinned")}};function qB(e,t){let i=0,n=!1;return t.forEach((o,r)=>{if(n||(n=o.rowTop!==i),o.setRowTop(i),o.rowHeightEstimated||o.rowHeight==null){let s=Zr(e,o).height;n||(n=o.rowHeight!==s),o.setRowHeight(s)}o.setRowIndex(r),i+=o.rowHeight}),n}function l_(e,t,i){if(t.pinnedSibling)return t.pinnedSibling;let n=lN(t,e);n.setRowTop(null),n.setRowIndex(null),n.rowPinned=i;let o=i==="top"?hw:pw;return n.id=`${o}${i}-${t.id}`,n.pinnedSibling=t,t.pinnedSibling=n,n}function Yv(e){if(!e.pinnedSibling)return;e.rowPinned=null,e.setRowTop(null),e.setRowIndex(null);let t=e.pinnedSibling;e.pinnedSibling=void 0,t&&(t.pinnedSibling=void 0,t.rowPinned=null)}function $B(e){let t=new Set;e.forEach(i=>{i.group&&t.add(i)}),t.forEach(i=>e.delete(i))}function jB(e,t,i){let{rowSpanSvc:n}=e,o=(i&&n?.isCellSpanning(i,t))??!1;if(i&&o)return n?.getCellSpan(i,t)?.spannedNodes}function c_(e){let t=e.size();if(t===0)return 0;let i=e.getByIndex(t-1);return i===void 0?0:i.rowTop+i.rowHeight}function KB({gos:e,rowModel:t}){Tt(e,t)&&t.refreshModel({step:"map"})}var d_=class extends A{constructor(){super(...arguments),this.nextId=0,this.pinnedTopRows={cache:{},order:[]},this.pinnedBottomRows={cache:{},order:[]}}postConstruct(){let e=this.gos;this.setPinnedRowData(e.get("pinnedTopRowData"),"top"),this.setPinnedRowData(e.get("pinnedBottomRowData"),"bottom"),this.addManagedPropertyListener("pinnedTopRowData",t=>this.setPinnedRowData(t.currentValue,"top")),this.addManagedPropertyListener("pinnedBottomRowData",t=>this.setPinnedRowData(t.currentValue,"bottom")),this.addManagedEventListeners({gridStylesChanged:this.onGridStylesChanges.bind(this)})}reset(){}isEmpty(e){return this.getCache(e).order.length===0}isRowsToRender(e){return!this.isEmpty(e)}isManual(){return!1}pinRow(e,t){}onGridStylesChanges(e){if(e.rowHeightChanged){let t=i=>{i.setRowHeight(i.rowHeight,!0)};Yc(this.pinnedBottomRows,t),Yc(this.pinnedTopRows,t)}}ensureRowHeightsValid(){let e=!1,t=0,i=n=>{if(n.rowHeightEstimated){let o=Zr(this.beans,n);n.setRowTop(t),n.setRowHeight(o.height),t+=o.height,e=!0}};return Yc(this.pinnedBottomRows,i),t=0,Yc(this.pinnedTopRows,i),this.eventSvc.dispatchEvent({type:"pinnedHeightChanged"}),e}setPinnedRowData(e,t){this.updateNodesFromRowData(e,t),this.eventSvc.dispatchEvent({type:"pinnedRowDataChanged"})}updateNodesFromRowData(e,t){let i=this.getCache(t);if(e===void 0){i.order.length=0,i.cache={};return}let n=xl(this.gos),o=t==="top"?hw:pw,r=new Set(i.order),s=[],a=new Set,l=0,c=-1;for(let d of e){let u=n?.({data:d,level:0,rowPinned:t})??o+this.nextId++;if(a.has(u)){W(96,{id:u,data:d});continue}c++,a.add(u),s.push(u);let h=ld(i,u);if(h!==void 0)h.data!==d&&h.updateData(d),l+=this.setRowTopAndRowIndex(h,l,c),r.delete(u);else{let p=new ts(this.beans);p.id=u,p.data=d,p.rowPinned=t,l+=this.setRowTopAndRowIndex(p,l,c),i.cache[u]=p,i.order.push(u)}}for(let d of r)ld(i,d)?.clearRowTopAndRowIndex(),delete i.cache[d];i.order=s}setRowTopAndRowIndex(e,t,i){return e.setRowTop(t),e.setRowHeight(Zr(this.beans,e).height),e.setRowIndex(i),e.rowHeight}getPinnedTopTotalHeight(){return u_(this.pinnedTopRows)}getPinnedBottomTotalHeight(){return u_(this.pinnedBottomRows)}getPinnedTopRowCount(){return FC(this.pinnedTopRows)}getPinnedBottomRowCount(){return FC(this.pinnedBottomRows)}getPinnedTopRow(e){return TC(this.pinnedTopRows,e)}getPinnedBottomRow(e){return TC(this.pinnedBottomRows,e)}getPinnedRowById(e,t){return ld(this.getCache(t),e)}forEachPinnedRow(e,t){return Yc(this.getCache(e),t)}getCache(e){return e==="top"?this.pinnedTopRows:this.pinnedBottomRows}getPinnedState(){return{top:[],bottom:[]}}setPinnedState(){}getGrandTotalPinned(){}setGrandTotalPinned(){}};function u_(e){let t=FC(e);if(t===0)return 0;let i=TC(e,t-1);return i===void 0?0:i.rowTop+i.rowHeight}function ld(e,t){return e.cache[t]}function TC(e,t){return ld(e,e.order[t])}function Yc(e,t){e.order.forEach((i,n)=>{let o=ld(e,i);o&&t(o,n)})}function FC(e){return e.order.length}var YB=class extends A{constructor(){super(...arguments),this.beanName="pinnedRowModel"}postConstruct(){let{gos:e}=this,t=()=>{let i=e.get("enableRowPinning"),n=PR(e),r=!!i||(n==="pinnedBottom"||n==="pinnedTop"),s=r?this.inner instanceof d_:this.inner instanceof a_;this.inner&&s&&this.destroyBean(this.inner),(s||!this.inner)&&(this.inner=this.createManagedBean(r?new a_:new d_))};this.addManagedPropertyListeners(["enableRowPinning","grandTotalRow"],t),t()}reset(){return this.inner.reset()}isEmpty(e){return this.inner.isEmpty(e)}isManual(){return this.inner.isManual()}isRowsToRender(e){return this.inner.isRowsToRender(e)}pinRow(e,t,i){return this.inner.pinRow(e,t,i)}ensureRowHeightsValid(){return this.inner.ensureRowHeightsValid()}getPinnedRowById(e,t){return this.inner.getPinnedRowById(e,t)}getPinnedTopTotalHeight(){return this.inner.getPinnedTopTotalHeight()}getPinnedBottomTotalHeight(){return this.inner.getPinnedBottomTotalHeight()}getPinnedTopRowCount(){return this.inner.getPinnedTopRowCount()}getPinnedBottomRowCount(){return this.inner.getPinnedBottomRowCount()}getPinnedTopRow(e){return this.inner.getPinnedTopRow(e)}getPinnedBottomRow(e){return this.inner.getPinnedBottomRow(e)}forEachPinnedRow(e,t){return this.inner.forEachPinnedRow(e,t)}getPinnedState(){return this.inner.getPinnedState()}setPinnedState(e){return this.inner.setPinnedState(e)}setGrandTotalPinned(e){return this.inner.setGrandTotalPinned(e)}getGrandTotalPinned(){return this.inner.getGrandTotalPinned()}};function Td(e){return!!(e.rowPinned&&e.pinnedSibling)}function Cn(e,t,i,n){let o=t==="top";if(!i)return Cn(e,t,o?e.getPinnedTopRow(0):e.getPinnedBottomRow(0),n);if(!n){let l=o?e.getPinnedTopRowCount():e.getPinnedBottomRowCount();return Cn(e,t,i,o?e.getPinnedTopRow(l-1):e.getPinnedBottomRow(l-1))}let r=!1,s=!1,a=[];return e.forEachPinnedRow(t,l=>{if(l===i&&!r){r=!0,a.push(l);return}if(r&&l===n){s=!0,a.push(l);return}r&&!s&&a.push(l)}),a}var XB={tag:"div",cls:"ag-selection-checkbox",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},JB=class extends je{constructor(){super(XB,[aw]),this.eCheckbox=Z}postConstruct(){this.eCheckbox.setPassive(!0)}onDataChanged(){this.onSelectionChanged()}onSelectableChanged(){this.showOrHideSelect()}onSelectionChanged(){let e=this.getLocaleTextFunc(),{rowNode:t,eCheckbox:i}=this,n=t.isSelected(),o=Xp(e,n),[r,s]=t.selectable?["ariaRowToggleSelection","Press Space to toggle row selection"]:["ariaRowSelectionDisabled","Row Selection is disabled for this row"],a=e(r,s);i.setValue(n,!0),i.setInputAriaLabel(`${a} (${o})`)}init(e){if(this.rowNode=e.rowNode,this.column=e.column,this.overrides=e.overrides,this.onSelectionChanged(),this.addManagedListeners(this.eCheckbox.getInputElement(),{dblclick:la,click:n=>{la(n),this.beans.selectionSvc?.handleSelectionEvent(n,this.rowNode,"checkboxSelected")}}),this.addManagedListeners(this.rowNode,{rowSelected:this.onSelectionChanged.bind(this),dataChanged:this.onDataChanged.bind(this),selectableChanged:this.onSelectableChanged.bind(this)}),this.addManagedPropertyListener("rowSelection",({currentValue:n,previousValue:o})=>{let r=typeof n=="object"?Tv(n):void 0,s=typeof o=="object"?Tv(o):void 0;r!==s&&this.onSelectableChanged()}),vC(this.gos)||typeof this.getIsVisible()=="function"){let n=this.showOrHideSelect.bind(this);this.addManagedEventListeners({displayedColumnsChanged:n}),this.addManagedListeners(this.rowNode,{dataChanged:n,cellChanged:n}),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")}showOrHideSelect(){let{column:e,rowNode:t,overrides:i,gos:n}=this,o=t.selectable,r=this.getIsVisible(),s;if(typeof r=="function"){let u=i?.callbackParams;if(!e)s=r(z(b({},u),{node:t,data:t.data}));else{let h=e.createColumnFunctionCallbackParams(t);s=r(b(b({},u),h))}}else s=r??!1;let a=o&&!s||!o&&s,l=o||s,c=n.get("rowSelection"),d=c&&typeof c!="string"?!Tv(c):!!e?.getColDef().showDisabledCheckboxes;this.setVisible(l&&(a?d:!0)),this.setDisplayed(l&&(a?d:!0)),l&&this.eCheckbox.setDisabled(a),i?.removeHidden&&this.setDisplayed(l)}getIsVisible(){let e=this.overrides;if(e)return e.isVisible;let t=this.gos.get("rowSelection");return t&&typeof t!="string"?fl(t):this.column?.getColDef()?.checkboxSelection}},QB=class{constructor(e,t){this.rowModel=e,this.pinnedRowModel=t,this.selectAll=!1,this.rootId=null,this.endId=null,this.cachedRange=[]}reset(){this.rootId=null,this.endId=null,this.cachedRange.length=0}setRoot(e){this.rootId=e.id,this.endId=null,this.cachedRange.length=0}setEndRange(e){this.endId=e.id,this.cachedRange.length=0}getRange(){if(this.cachedRange.length===0){let e=this.getRoot(),t=this.getEnd();if(e==null||t==null)return this.cachedRange;this.cachedRange=this.getNodesInRange(e,t)??[]}return this.cachedRange}isInRange(e){return this.rootId===null?!1:this.getRange().some(t=>t.id===e.id)}getRoot(e){if(this.rootId)return this.getRowNode(this.rootId);if(e)return this.setRoot(e),e}getEnd(){if(this.endId)return this.getRowNode(this.endId)}getRowNode(e){let t,{rowModel:i,pinnedRowModel:n}=this;return t??(t=i.getRowNode(e)),n?.isManual()&&(t??(t=n.getPinnedRowById(e,"top")),t??(t=n.getPinnedRowById(e,"bottom"))),t}truncate(e){let t=this.getRange();if(t.length===0)return{keep:[],discard:[]};let i=t[0].id===this.rootId,n=t.findIndex(o=>o.id===e.id);if(n>-1){let o=t.slice(0,n),r=t.slice(n+1);return this.setEndRange(e),i?{keep:o,discard:r}:{keep:r,discard:o}}else return{keep:t,discard:[]}}extend(e,t=!1){let i=this.getRoot();if(i==null){let o=this.getRange().slice();return t&&e.depthFirstSearch(r=>!r.group&&o.push(r)),o.push(e),this.setRoot(e),{keep:o,discard:[]}}let n=this.getNodesInRange(i,e);if(!n)return this.setRoot(e),{keep:[e],discard:[]};if(n.find(o=>o.id===this.endId))return this.setEndRange(e),{keep:this.getRange(),discard:[]};{let o=this.getRange().slice();return this.setEndRange(e),{keep:this.getRange(),discard:o}}}getNodesInRange(e,t){let{pinnedRowModel:i,rowModel:n}=this;if(!i?.isManual())return n.getNodesInRangeForSelection(e,t);if(e.rowPinned==="top"&&!t.rowPinned)return Cn(i,"top",e,void 0).concat(n.getNodesInRangeForSelection(n.getRow(0),t)??[]);if(e.rowPinned==="bottom"&&!t.rowPinned){let o=Cn(i,"bottom",void 0,e),r=n.getRowCount(),s=n.getRow(r-1);return(n.getNodesInRangeForSelection(t,s)??[]).concat(o)}if(!e.rowPinned&&!t.rowPinned)return n.getNodesInRangeForSelection(e,t);if(e.rowPinned==="top"&&t.rowPinned==="top")return Cn(i,"top",e,t);if(e.rowPinned==="bottom"&&t.rowPinned==="top"){let o=Cn(i,"top",t,void 0),r=Cn(i,"bottom",void 0,e),s=n.getRow(0),a=n.getRow(n.getRowCount()-1);return o.concat(n.getNodesInRangeForSelection(s,a)??[]).concat(r)}if(!e.rowPinned&&t.rowPinned==="top")return Cn(i,"top",t,void 0).concat(n.getNodesInRangeForSelection(n.getRow(0),e)??[]);if(e.rowPinned==="top"&&t.rowPinned==="bottom"){let o=Cn(i,"top",e,void 0),r=Cn(i,"bottom",void 0,t),s=n.getRow(0),a=n.getRow(n.getRowCount()-1);return o.concat(n.getNodesInRangeForSelection(s,a)??[]).concat(r)}if(e.rowPinned==="bottom"&&t.rowPinned==="bottom")return Cn(i,"bottom",e,t);if(!e.rowPinned&&t.rowPinned==="bottom"){let o=Cn(i,"bottom",void 0,t),r=n.getRow(n.getRowCount());return(n.getNodesInRangeForSelection(e,r)??[]).concat(o)}return null}},ZB=class extends A{constructor(e){super(),this.column=e,this.cbSelectAllVisible=!1,this.processingEventFromCheckbox=!1}onSpaceKeyDown(e){let t=this.cbSelectAll;t.isDisplayed()&&!t.getGui().contains(Ct(this.beans))&&(e.preventDefault(),t.setValue(!t.getValue()))}getCheckboxGui(){return this.cbSelectAll.getGui()}setComp(e){this.headerCellCtrl=e;let t=this.createManagedBean(new sw);this.cbSelectAll=t,t.addCss("ag-header-select-all"),Jr(t.getGui(),"presentation"),this.showOrHideSelectAll();let i=this.updateStateOfCheckbox.bind(this);this.addManagedEventListeners({newColumnsLoaded:()=>this.showOrHideSelectAll(),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),selectionChanged:i,paginationChanged:i,modelUpdated:i}),this.addManagedPropertyListener("rowSelection",({currentValue:n,previousValue:o})=>{let r=s=>typeof s=="string"||!s||s.mode==="singleRow"?void 0:s.selectAll;r(n)!==r(o)&&this.showOrHideSelectAll(),this.updateStateOfCheckbox()}),this.addManagedListeners(t,{fieldValueChanged:this.onCbSelectAll.bind(this)}),t.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()}onDisplayedColumnsChanged(e){this.isAlive()&&this.showOrHideSelectAll(e.source==="uiColumnMoved")}showOrHideSelectAll(e=!1){let t=this.isCheckboxSelection();this.cbSelectAllVisible=t,this.cbSelectAll.setDisplayed(t),t&&(this.checkRightRowModelType("selectAllCheckbox"),this.checkSelectionType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel(e)}updateStateOfCheckbox(){if(!this.cbSelectAllVisible||this.processingEventFromCheckbox)return;this.processingEventFromCheckbox=!0;let e=this.getSelectAllMode(),t=this.beans.selectionSvc,i=this.cbSelectAll,n=t.getSelectAllState(e);i.setValue(n);let o=t.hasNodesToSelect(e);i.setDisabled(!o),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}refreshSelectAllLabel(e=!1){let t=this.getLocaleTextFunc(),{headerCellCtrl:i,cbSelectAll:n,cbSelectAllVisible:o}=this,r=n.getValue(),s=Xp(t,r),a=t("ariaRowSelectAll","Press Space to toggle all rows selection");i.setAriaDescriptionProperty("selectAll",o?`${a} (${s})`:null),n.setInputAriaLabel(t("ariaHeaderSelection","Column with Header Selection")),e||i.announceAriaDescription()}checkSelectionType(e){return Cd(this.gos)?!0:(W(128,{feature:e}),!1)}checkRightRowModelType(e){let{gos:t,rowModel:i}=this.beans;return Tt(t)||Ml(t)?!0:(W(129,{feature:e,rowModel:i.getType()}),!1)}onCbSelectAll(){if(this.processingEventFromCheckbox||!this.cbSelectAllVisible)return;let e=this.cbSelectAll.getValue(),t=this.getSelectAllMode(),i="uiSelectAll";t==="currentPage"?i="uiSelectAllCurrentPage":t==="filtered"&&(i="uiSelectAllFiltered");let n={source:i,selectAll:t},o=this.beans.selectionSvc;e?o.selectAllRowNodes(n):o.deselectAllRowNodes(n)}isCheckboxSelection(){let{column:e,gos:t,beans:i}=this,r=typeof t.get("rowSelection")=="object"?"headerCheckbox":"headerCheckboxSelection";return VP(i,e)&&this.checkRightRowModelType(r)&&this.checkSelectionType(r)}getSelectAllMode(){let e=TR(this.gos,!1);if(e)return e;let{headerCheckboxSelectionCurrentPageOnly:t,headerCheckboxSelectionFilteredOnly:i}=this.column.getColDef();return t?"currentPage":i?"filtered":"all"}destroy(){super.destroy(),this.cbSelectAll=void 0,this.headerCellCtrl=void 0}};function VP({gos:e,selectionColSvc:t},i){let n=e.get("rowSelection"),o=i.getColDef(),{headerCheckboxSelection:r}=o,s=!1;if(typeof n=="object"){let l=dr(i),c=iw(i);(Ap(n)==="autoGroupColumn"&&c||l&&t?.isSelectionColumnEnabled())&&(s=Cp(n))}else typeof r=="function"?s=r(ye(e,{column:i,colDef:o})):s=!!r;return s}var eH=class extends A{postConstruct(){let{gos:e,beans:t}=this;this.selectionCtx=new QB(t.rowModel,t.pinnedRowModel),this.addManagedPropertyListeners(["isRowSelectable","rowSelection"],()=>{let i=vC(e);i!==this.isRowSelectable&&(this.isRowSelectable=i,this.updateSelectable())}),this.isRowSelectable=vC(e),this.addManagedEventListeners({cellValueChanged:i=>this.updateRowSelectable(i.node),rowNodeDataChanged:i=>this.updateRowSelectable(i.node)})}destroy(){super.destroy(),this.selectionCtx.reset()}createCheckboxSelectionComponent(){return new JB}createSelectAllFeature(e){if(VP(this.beans,e))return new ZB(e)}isMultiSelect(){return Cd(this.gos)}onRowCtrlSelected(e,t,i){let n=!!e.rowNode.isSelected();e.forEachGui(i,o=>{o.rowComp.toggleCss("ag-row-selected",n);let r=o.element;tR(r,n),r.contains(Ct(this.beans))&&t(o)})}announceAriaRowSelection(e){if(this.isRowSelectionBlocked(e))return;let t=e.isSelected(),i=this.beans.editSvc?.isEditing({rowNode:e});if(!e.selectable||i)return;let o=this.getLocaleTextFunc()(t?"ariaRowDeselect":"ariaRowSelect",`Press SPACE to ${t?"deselect":"select"} this row`);this.beans.ariaAnnounce?.announceValue(o,"rowSelection")}isRowSelectionBlocked(e){return!e.selectable||e.rowPinned&&!Td(e)||!ea(this.gos)}updateRowSelectable(e,t){let i=e.rowPinned&&e.pinnedSibling?e.pinnedSibling.selectable:this.isRowSelectable?.(e)??!0;return this.setRowSelectable(e,i,t),i}setRowSelectable(e,t,i){if(e.selectable!==t){if(e.selectable=t,e.dispatchRowEvent("selectableChanged"),i)return;if(wd(this.gos)){let o=this.calculateSelectedFromChildren(e);this.setNodesSelected({nodes:[e],newValue:o??!1,source:"selectableChanged"});return}e.isSelected()&&!e.selectable&&this.setNodesSelected({nodes:[e],newValue:!1,source:"selectableChanged"})}}calculateSelectedFromChildren(e){let t=!1,i=!1;if(!e.childrenAfterGroup?.length)return e.selectable?e.__selected:null;for(let n=0;n<e.childrenAfterGroup.length;n++){let o=e.childrenAfterGroup[n],r=o.isSelected();if(!o.selectable){let s=this.calculateSelectedFromChildren(o);if(s===null)continue;r=s}switch(r){case!0:t=!0;break;case!1:i=!0;break;default:return}}if(!(t&&i))return t?!0:i?!1:e.selectable?e.__selected:null}selectRowNode(e,t,i,n="api"){let o=!e.selectable&&t,r=e.__selected===t;if(o||r)return!1;e.__selected=t,e.dispatchRowEvent("rowSelected");let s=e.sibling;s&&s.footer&&s.__localEventService&&s.dispatchRowEvent("rowSelected");let a=e.pinnedSibling;return a?.rowPinned&&a.__localEventService&&a.dispatchRowEvent("rowSelected"),this.eventSvc.dispatchEvent(z(b({},sN(e,this.gos,"rowSelected")),{event:i||null,source:n})),!0}isCellCheckboxSelection(e,t){let i=this.gos.get("rowSelection");if(i&&typeof i!="string"){let n=dr(e)&&fl(i);return e.isColumnFunc(t,n)}else return e.isColumnFunc(t,e.colDef.checkboxSelection)}inferNodeSelections(e,t,i,n){let{gos:o,selectionCtx:r}=this,s=e.isSelected(),a=wd(o),l=ML(o),c=kL(o),d=this.isMultiSelect(),u=n==="rowClicked";if(u&&!(l||c))return null;if(t&&i&&d){let h=r.getRoot();if(h)if(h.isSelected()){let p=r.isInRange(e)?r.truncate(e):r.extend(e,a);return{deselect:p.discard,select:p.keep,reset:!1}}else{let p=r.extend(e,a);return{select:[],deselect:p.keep,reset:!1}}else return null}else if(t&&d){let h=r.selectAll?this.beans.rowModel.getRow(0):void 0,p=r.getRoot(h),g=r.isInRange(e)?r.truncate(e):r.extend(e,a);return{select:g.keep,deselect:g.discard,reset:r.selectAll||!!(p&&!p.isSelected())}}else if(i){if(u){let h=!s;return h&&!l||!h&&!c?null:(r.setRoot(e),{node:e,newValue:h,clearSelection:!1})}return r.setRoot(e),{node:e,newValue:!s,clearSelection:!d}}else{r.setRoot(e);let h=TL(o),p=Op(o)==="filteredDescendants",g=u&&(!h||!l);if(p&&s===void 0&&Tt(o))return{node:e,newValue:!1,checkFilteredNodes:!0,clearSelection:!d||g};if(u){let f=s?!h:l;return f===s&&!g||f&&!l||!f&&!c?null:{node:e,newValue:f,clearSelection:!d||g,keepDescendants:e.group&&a}}return{node:e,newValue:!s,clearSelection:!d||g}}}},Xv={TAB_GUARD:"ag-tab-guard",TAB_GUARD_TOP:"ag-tab-guard-top",TAB_GUARD_BOTTOM:"ag-tab-guard-bottom"},tH=class extends A{constructor(e){super(),this.skipTabGuardFocus=!1,this.forcingFocusOut=!1,this.allowFocus=!1;let{comp:t,eTopGuard:i,eBottomGuard:n,focusTrapActive:o,forceFocusOutWhenTabGuardsAreEmpty:r,isFocusableContainer:s,focusInnerElement:a,onFocusIn:l,onFocusOut:c,shouldStopEventPropagation:d,onTabKeyDown:u,handleKeyDown:h,isEmpty:p,eFocusableElement:g}=e;this.comp=t,this.eTopGuard=i,this.eBottomGuard=n,this.providedFocusInnerElement=a,this.eFocusableElement=g,this.focusTrapActive=!!o,this.forceFocusOutWhenTabGuardsAreEmpty=!!r,this.isFocusableContainer=!!s,this.providedFocusIn=l,this.providedFocusOut=c,this.providedShouldStopEventPropagation=d,this.providedOnTabKeyDown=u,this.providedHandleKeyDown=h,this.providedIsEmpty=p}postConstruct(){this.createManagedBean(new kl(this.eFocusableElement,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e)})),this.activateTabGuards();for(let e of[this.eTopGuard,this.eBottomGuard])this.addManagedElementListeners(e,{focus:this.onFocus.bind(this)})}handleKeyDown(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return this.providedShouldStopEventPropagation?this.providedShouldStopEventPropagation():!1}activateTabGuards(){if(this.forcingFocusOut)return;let e=this.gos.get("tabIndex");this.comp.setTabIndex(e.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(e){if(this.isFocusableContainer&&!this.eFocusableElement.contains(e.relatedTarget)&&!this.allowFocus){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.skipTabGuardFocus){this.skipTabGuardFocus=!1;return}if(this.forceFocusOutWhenTabGuardsAreEmpty&&(this.providedIsEmpty?this.providedIsEmpty():vl(this.eFocusableElement,".ag-tab-guard").length===0)){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.isFocusableContainer&&this.eFocusableElement.contains(e.relatedTarget))return;let t=e.target===this.eBottomGuard;!(this.providedFocusInnerElement?this.providedFocusInnerElement(t):this.focusInnerElement(t))&&this.forceFocusOutWhenTabGuardsAreEmpty&&this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard)}findNextElementOutsideAndFocus(e){let t=Qt(this.beans),i=vl(t.body,null,!0),n=i.indexOf(e?this.eTopGuard:this.eBottomGuard);if(n===-1)return;let o,r;e?(o=0,r=n):(o=n+1,r=i.length);let s=i.slice(o,r),a=this.gos.get("tabIndex");s.sort((l,c)=>{let d=Number.parseInt(l.getAttribute("tabindex")||"0"),u=Number.parseInt(c.getAttribute("tabindex")||"0");return u===a?1:d===a?-1:d===0?1:u===0?-1:d-u}),s[e?s.length-1:0]?.focus()}onFocusIn(e){this.focusTrapActive||this.forcingFocusOut||(this.providedFocusIn&&this.providedFocusIn(e),this.isFocusableContainer||this.deactivateTabGuards())}onFocusOut(e){this.focusTrapActive||(this.providedFocusOut&&this.providedFocusOut(e),this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards())}onTabKeyDown(e){if(this.providedOnTabKeyDown){this.providedOnTabKeyDown(e);return}if(this.focusTrapActive||e.defaultPrevented)return;let t=this.tabGuardsAreActive();t&&this.deactivateTabGuards();let i=this.getNextFocusableElement(e.shiftKey);t&&setTimeout(()=>this.activateTabGuards(),0),i&&(i.focus(),e.preventDefault())}focusInnerElement(e=!1){let t=vl(this.eFocusableElement);return this.tabGuardsAreActive()&&(t.splice(0,1),t.splice(t.length-1,1)),t.length?(t[e?t.length-1:0].focus({preventScroll:!0}),!0):!1}getNextFocusableElement(e){return ha(this.beans,this.eFocusableElement,!1,e)}forceFocusOutOfContainer(e=!1){if(this.forcingFocusOut)return;let t=e?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,this.forcingFocusOut=!0,t.focus(),window.setTimeout(()=>{this.forcingFocusOut=!1,this.activateTabGuards()})}isTabGuard(e,t){return e===this.eTopGuard&&!t||e===this.eBottomGuard&&(t??!0)}setAllowFocus(e){this.allowFocus=e}},iH=class extends A{constructor(e){super(),this.comp=e}initialiseTabGuard(e){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.comp.getFocusableElement();let{eTopGuard:t,eBottomGuard:i,eFocusableElement:n}=this,o=[t,i],r={setTabIndex:m=>{for(let v of o)m!=null?v.setAttribute("tabindex",m):v.removeAttribute("tabindex")}};this.addTabGuards(t,i);let{focusTrapActive:s=!1,onFocusIn:a,onFocusOut:l,focusInnerElement:c,handleKeyDown:d,onTabKeyDown:u,shouldStopEventPropagation:h,isEmpty:p,forceFocusOutWhenTabGuardsAreEmpty:g,isFocusableContainer:f}=e;this.tabGuardCtrl=this.createManagedBean(new tH({comp:r,focusTrapActive:s,eTopGuard:t,eBottomGuard:i,eFocusableElement:n,onFocusIn:a,onFocusOut:l,focusInnerElement:c,handleKeyDown:d,onTabKeyDown:u,shouldStopEventPropagation:h,isEmpty:p,forceFocusOutWhenTabGuardsAreEmpty:g,isFocusableContainer:f}))}getTabGuardCtrl(){return this.tabGuardCtrl}createTabGuard(e){let t=Qt(this.beans).createElement("div"),i=e==="top"?Xv.TAB_GUARD_TOP:Xv.TAB_GUARD_BOTTOM;return t.classList.add(Xv.TAB_GUARD,i),Jr(t,"presentation"),t}addTabGuards(e,t){let i=this.eFocusableElement;i.insertAdjacentElement("afterbegin",e),i.insertAdjacentElement("beforeend",t)}removeAllChildrenExceptTabGuards(){let e=[this.eTopGuard,this.eBottomGuard];ai(this.comp.getFocusableElement()),this.addTabGuards(...e)}forceFocusOutOfContainer(e=!1){this.tabGuardCtrl.forceFocusOutOfContainer(e)}appendChild(e,t,i){XC(t)||(t=t.getGui());let{eBottomGuard:n}=this;n?n.insertAdjacentElement("beforebegin",t):e(t,i)}destroy(){let{eTopGuard:e,eBottomGuard:t}=this;zi(e),zi(t),super.destroy()}},GP=class extends je{initialiseTabGuard(e){this.tabGuardFeature=this.createManagedBean(new iH(this)),this.tabGuardFeature.initialiseTabGuard(e)}forceFocusOutOfContainer(e=!1){this.tabGuardFeature.forceFocusOutOfContainer(e)}appendChild(e,t){this.tabGuardFeature.appendChild(super.appendChild.bind(this),e,t)}},nH=500,oH=550,hp,rH=e=>{if(!hp)hp=new WeakSet;else if(hp.has(e))return!1;return hp.add(e),!0},Xs=class{constructor(e,t=!1){this.eElement=e,this.preventClick=t,this.startListener=null,this.handlers=[],this.eventSvc=void 0,this.touchStart=null,this.lastTapTime=null,this.longPressTimer=0,this.moved=!1}addEventListener(e,t){let i=this.eventSvc;if(!i){if(i===null)return;this.eventSvc=i=new ra;let n=this.onTouchStart.bind(this);this.startListener=n,this.eElement.addEventListener("touchstart",n,{passive:!0})}i.addEventListener(e,t)}removeEventListener(e,t){this.eventSvc?.removeEventListener(e,t)}onTouchStart(e){if(this.touchStart||!rH(e))return;let t=e.touches[0];this.touchStart=t;let i=this.handlers;if(!i.length){let n=this.eElement,o=n.ownerDocument,r=this.onTouchMove.bind(this),s=this.onTouchEnd.bind(this),a=this.onTouchCancel.bind(this),l={passive:!0},c={passive:!1};mp(i,[n,"touchmove",r,l],[o,"touchcancel",a,l],[o,"touchend",s,c],[o,"contextmenu",Kr,c])}this.clearLongPress(),this.longPressTimer=window.setTimeout(()=>{this.longPressTimer=0,this.touchStart===t&&!this.moved&&(this.moved=!0,this.eventSvc?.dispatchEvent({type:"longTap",touchStart:t,touchEvent:e}))},oH)}onTouchMove(e){let{moved:t,touchStart:i}=this;if(!t&&i){let n=rd(i,e.touches);n&&!uR(n,i,4)&&(this.clearLongPress(),this.moved=!0)}}onTouchEnd(e){let t=this.touchStart;!t||!rd(t,e.changedTouches)||(this.moved||(this.eventSvc?.dispatchEvent({type:"tap",touchStart:t}),this.checkDoubleTap(t)),this.preventClick&&Kr(e),this.cancel())}onTouchCancel(e){let t=this.touchStart;!t||!rd(t,e.changedTouches)||(this.lastTapTime=null,this.cancel())}checkDoubleTap(e){let t=Date.now(),i=this.lastTapTime;i&&t-i>nH&&(this.eventSvc?.dispatchEvent({type:"doubleTap",touchStart:e}),t=null),this.lastTapTime=t}cancel(){this.clearLongPress(),JC(this.handlers),this.touchStart=null}clearLongPress(){window.clearTimeout(this.longPressTimer),this.longPressTimer=0,this.moved=!1}destroy(){let e=this.startListener;e&&(this.startListener=null,this.eElement.removeEventListener("touchstart",e)),this.cancel(),this.eElement=null,this.eventSvc=null}};var sH=class{constructor(e){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=e.scrollContainer,this.scrollHorizontally=e.scrollAxis.includes("x"),this.scrollVertically=e.scrollAxis.includes("y"),this.scrollByTick=e.scrollByTick!=null?e.scrollByTick:20,e.onScrollCallback&&(this.onScrollCallback=e.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=e.getVerticalPosition,this.setVerticalPosition=e.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=e.getHorizontalPosition,this.setHorizontalPosition=e.setHorizontalPosition),this.shouldSkipVerticalScroll=e.shouldSkipVerticalScroll||(()=>!1),this.shouldSkipHorizontalScroll=e.shouldSkipHorizontalScroll||(()=>!1)}get scrolling(){return this.tickingInterval!==null}check(e,t=!1){let i=t||this.shouldSkipVerticalScroll();if(i&&this.shouldSkipHorizontalScroll())return;let n=this.scrollContainer.getBoundingClientRect(),o=this.scrollByTick;this.tickLeft=e.clientX<n.left+o,this.tickRight=e.clientX>n.right-o,this.tickUp=e.clientY<n.top+o&&!i,this.tickDown=e.clientY>n.bottom-o&&!i,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}ensureTickingStarted(){this.tickingInterval===null&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)}doTick(){this.tickCount++;let e=this.tickCount>20?200:this.tickCount>10?80:40;if(this.scrollVertically){let t=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(t-e),this.tickDown&&this.setVerticalPosition(t+e)}if(this.scrollHorizontally){let t=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(t-e),this.tickRight&&this.setHorizontalPosition(t+e)}this.onScrollCallback&&this.onScrollCallback()}ensureCleared(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)}},xw=class{constructor(e="javascript"){this.frameworkName=e,this.renderingEngine="vanilla",this.batchFrameworkComps=!1,this.wrapIncoming=t=>t(),this.wrapOutgoing=t=>t(),this.baseDocLink=`${gR}/${this.frameworkName}-data-grid`,CL(this.baseDocLink)}frameworkComponent(e){return null}isFrameworkComponent(e){return!1}getDocLink(e){return this.baseDocLink+(e?"/"+e:"")}};function aH(e){return{beanName:"gridApi",bean:e.getBean("apiFunctionSvc").api}}var lH=["licenseManager","environment","eventSvc","gos","paginationAutoPageSizeSvc","apiFunctionSvc","gridApi","registry","agCompUtils","userCompFactory","rowContainerHeight","horizontalResizeSvc","localeSvc","pinnedRowModel","dragSvc","colGroupSvc","visibleCols","popupSvc","selectionSvc","colFilter","quickFilter","filterManager","colModel","headerNavigation","pageBounds","pagination","pageBoundsListener","rowSpanSvc","stickyRowSvc","rowRenderer","expressionSvc","alignedGridsSvc","navigation","valueCache","valueSvc","autoWidthCalc","filterMenuFactory","dragAndDrop","focusSvc","cellNavigation","cellStyles","scrollVisibleSvc","sortSvc","colHover","colAnimation","autoColSvc","selectionColSvc","changeDetectionSvc","animationFrameSvc","undoRedo","colDefFactory","rowStyleSvc","rowNodeBlockLoader","rowNodeSorter","ctrlsSvc","pinnedCols","dataTypeSvc","syncSvc","overlays","stateSvc","expansionSvc","apiEventSvc","ariaAnnounce","menuSvc","colMoves","colAutosize","colFlex","colResize","pivotColsSvc","valueColsSvc","rowGroupColsSvc","colNames","colViewport","pivotResultCols","showRowGroupCols","validation"],h_=Object.fromEntries(lH.map((e,t)=>[e,t]));function cH(e,t){let i=(e.beanName?h_[e.beanName]:void 0)??Number.MAX_SAFE_INTEGER,n=(t.beanName?h_[t.beanName]:void 0)??Number.MAX_SAFE_INTEGER;return i-n}function dH(e,t){return e?.beanName==="gridDestroySvc"?-1:t?.beanName==="gridDestroySvc"?1:0}var uH={tag:"div",cls:"ag-pinned-left-header",role:"rowgroup"},hH={tag:"div",cls:"ag-pinned-right-header",role:"rowgroup"},pH={tag:"div",cls:"ag-header-viewport",role:"rowgroup",attrs:{tabindex:"-1"},children:[{tag:"div",ref:"eCenterContainer",cls:"ag-header-container",role:"presentation"}]},Jv=class extends je{constructor(e){super(),this.eCenterContainer=Z,this.headerRowComps={},this.rowCompsList=[],this.pinned=e}postConstruct(){this.selectAndSetTemplate();let e={setDisplayed:i=>this.setDisplayed(i),setCtrls:i=>this.setCtrls(i),setCenterWidth:i=>this.eCenterContainer.style.width=i,setViewportScrollLeft:i=>this.getGui().scrollLeft=i,setPinnedContainerWidth:i=>{let n=this.getGui();n.style.width=i,n.style.maxWidth=i,n.style.minWidth=i}};this.createManagedBean(new MB(this.pinned)).setComp(e,this.getGui())}selectAndSetTemplate(){let e=this.pinned=="left",t=this.pinned=="right",i=e?uH:t?hH:pH;this.setTemplate(i),this.eRowContainer=this.eCenterContainer!==Z?this.eCenterContainer:this.getGui()}destroy(){this.setCtrls([]),super.destroy()}destroyRowComp(e){this.destroyBean(e),e.getGui().remove()}setCtrls(e){let t=this.headerRowComps;this.headerRowComps={},this.rowCompsList=[];let i,n=o=>{let r=o.getGui();r.parentElement!=this.eRowContainer&&this.eRowContainer.appendChild(r),i&&sR(this.eRowContainer,r,i),i=r};for(let o of e){let r=o.instanceId,s=t[r];delete t[r];let a=s||this.createBean(new _B(o));this.headerRowComps[r]=a,this.rowCompsList.push(a),n(a)}for(let o of Object.values(t))this.destroyRowComp(o)}},gH={tag:"div",cls:"ag-header",role:"presentation"},fH=class extends je{constructor(){super(gH)}postConstruct(){let e={toggleCss:(n,o)=>this.toggleCss(n,o),setHeightAndMinHeight:n=>{this.getGui().style.height=n,this.getGui().style.minHeight=n}};this.createManagedBean(new CB).setComp(e,this.getGui(),this.getFocusableElement());let i=n=>{this.createManagedBean(n),this.appendChild(n)};i(new Jv("left")),i(new Jv(null)),i(new Jv("right"))}},mH={selector:"AG-HEADER-ROOT",component:fH},vH=class extends je{constructor(e,t,i,n,o){super(),this.cellCtrl=t,this.rendererVersion=0,this.editorVersion=0,this.beans=e,this.gos=e.gos,this.column=t.column,this.rowNode=t.rowNode,this.eRow=n;let r=Ft({tag:"div",role:t.getCellAriaRole(),attrs:{"comp-id":`${this.getCompId()}`,"col-id":t.column.colIdSanitised}});this.eCell=r;let s;t.isCellSpanning()?(s=Ft({tag:"div",cls:"ag-spanned-cell-wrapper",role:"presentation"}),s.appendChild(r),this.setTemplateFromElement(s)):this.setTemplateFromElement(r),this.cellCssManager=new jR(()=>r),this.forceWrapper=t.isForceWrapper(),this.refreshWrapper(!1);let a={toggleCss:(l,c)=>this.cellCssManager.toggleCss(l,c),setUserStyles:l=>_d(r,l),getFocusableElement:()=>r,setIncludeSelection:l=>this.includeSelection=l,setIncludeRowDrag:l=>this.includeRowDrag=l,setIncludeDndSource:l=>this.includeDndSource=l,setRenderDetails:(l,c,d)=>this.setRenderDetails(l,c,d),setEditDetails:(l,c,d)=>this.setEditDetails(l,c,d),getCellEditor:()=>this.cellEditor||null,getCellRenderer:()=>this.cellRenderer||null,getParentOfValue:()=>this.getParentOfValue(),refreshEditStyles:(l,c)=>this.refreshEditStyles(l,c)};t.setComp(a,r,s,this.eCellWrapper,i,o,void 0)}getParentOfValue(){return this.eCellValue??this.eCellWrapper??this.eCell}setRenderDetails(e,t,i){if(this.cellEditor&&!this.cellEditorPopupWrapper)return;this.firstRender=this.firstRender==null;let o=this.refreshWrapper(!1);this.refreshEditStyles(!1),e?!(i||o)&&this.refreshCellRenderer(e)||(this.destroyRenderer(),this.createCellRendererInstance(e)):(this.destroyRenderer(),this.insertValueWithoutCellRenderer(t)),this.rowDraggingComp?.refreshVisibility()}setEditDetails(e,t,i){e?this.createCellEditorInstance(e,t,i):this.destroyEditor()}removeControls(){let e=this.beans.context;this.checkboxSelectionComp=e.destroyBean(this.checkboxSelectionComp),this.dndSourceComp=e.destroyBean(this.dndSourceComp),this.rowDraggingComp=e.destroyBean(this.rowDraggingComp)}refreshWrapper(e){let t=this.includeRowDrag||this.includeDndSource||this.includeSelection,i=t||this.forceWrapper,n=i&&this.eCellWrapper==null;n&&(this.eCellWrapper=Ft({tag:"div",cls:"ag-cell-wrapper",role:"presentation"}),this.eCell.appendChild(this.eCellWrapper));let o=!i&&this.eCellWrapper!=null;o&&(zi(this.eCellWrapper),this.eCellWrapper=void 0),this.cellCssManager.toggleCss("ag-cell-value",!i);let r=!e&&i,s=r&&this.eCellValue==null;if(s){let c=this.cellCtrl.getCellValueClass();this.eCellValue=Ft({tag:"span",cls:c,role:"presentation"}),this.eCellWrapper.appendChild(this.eCellValue)}let a=!r&&this.eCellValue!=null;a&&(zi(this.eCellValue),this.eCellValue=void 0);let l=n||o||s||a;return l&&this.removeControls(),!e&&t&&this.addControls(),l}addControls(){let{cellCtrl:e,eCellWrapper:t,eCellValue:i,includeRowDrag:n,includeDndSource:o,includeSelection:r}=this,s=a=>{a&&t.insertBefore(a.getGui(),i)};n&&this.rowDraggingComp==null&&(this.rowDraggingComp=e.createRowDragComp(),s(this.rowDraggingComp)),o&&this.dndSourceComp==null&&(this.dndSourceComp=e.createDndSource(),s(this.dndSourceComp)),r&&this.checkboxSelectionComp==null&&(this.checkboxSelectionComp=e.createSelectionCheckbox(),s(this.checkboxSelectionComp))}createCellEditorInstance(e,t,i){let n=this.editorVersion,o=e.newAgStackInstance(),{params:r}=e;o.then(a=>this.afterCellEditorCreated(n,a,r,t,i)),mt(this.cellEditor)&&r.cellStartedEdit&&this.cellCtrl.focusCell(!0)}insertValueWithoutCellRenderer(e){let t=this.getParentOfValue();ai(t);let i=Dl(e);i!=null&&(t.textContent=i)}destroyRenderer(){let{context:e}=this.beans;this.cellRenderer=e.destroyBean(this.cellRenderer),zi(this.cellRendererGui),this.cellRendererGui=null,this.rendererVersion++}destroyEditor(){let{context:e}=this.beans;(this.cellEditorPopupWrapper?.getGui().contains(Ct(this.beans))||this.cellCtrl.hasBrowserFocus())&&this.eCell.focus({preventScroll:!0}),this.hideEditorPopup?.(),this.hideEditorPopup=void 0,this.cellEditor=e.destroyBean(this.cellEditor),this.cellEditorPopupWrapper=e.destroyBean(this.cellEditorPopupWrapper),zi(this.cellEditorGui),this.cellCtrl.disableEditorTooltipFeature(),this.cellEditorGui=null,this.editorVersion++}refreshCellRenderer(e){if(this.cellRenderer?.refresh==null||this.cellRendererClass!==e.componentClass)return!1;let t=this.cellRenderer.refresh(e.params);return t===!0||t===void 0}createCellRendererInstance(e){let t=this.rendererVersion,i=r=>s=>{if(this.rendererVersion!==t||!this.isAlive())return;let l=r.newAgStackInstance(),c=this.afterCellRendererCreated.bind(this,t,r.componentClass);l?.then(c)},{animationFrameSvc:n}=this.beans,o;if(n?.active&&this.firstRender?o=(r,s=!1)=>{n.createTask(i(r),this.rowNode.rowIndex,"p2",r.componentFromFramework,s)}:o=r=>i(r)(),e.params?.deferRender&&!this.cellCtrl.rowNode.group){let{loadingComp:r,onReady:s}=this.cellCtrl.getDeferLoadingCellRenderer();r&&(o(r),s.then(()=>o(e,!0)))}else o(e)}afterCellRendererCreated(e,t,i){if(!this.isAlive()||e!==this.rendererVersion){this.beans.context.destroyBean(i);return}this.cellRenderer=i,this.cellRendererClass=t;let o=i.getGui();if(this.cellRendererGui=o,o!=null){let r=this.getParentOfValue();ai(r),r.appendChild(o)}}afterCellEditorCreated(e,t,i,n,o){let r=e!==this.editorVersion,{context:s}=this.beans;if(r){s.destroyBean(t);return}if(t.isCancelBeforeStart?.()){s.destroyBean(t),this.cellCtrl.stopEditing(!0);return}if(!t.getGui){W(97,{colId:this.column.getId()}),s.destroyBean(t);return}this.cellEditor=t,this.cellEditorGui=t.getGui();let l=n||t.isPopup?.();l?this.addPopupCellEditor(i,o):this.addInCellEditor(),this.refreshEditStyles(!0,l),t.afterGuiAttached?.(),this.cellCtrl.enableEditorTooltipFeature(t),this.cellCtrl.cellEditorAttached()}refreshEditStyles(e,t){let{cellCssManager:i}=this;i.toggleCss("ag-cell-inline-editing",e&&!t),i.toggleCss("ag-cell-popup-editing",e&&!!t),i.toggleCss("ag-cell-not-inline-editing",!e||!!t)}addInCellEditor(){let{eCell:e}=this;e.contains(Ct(this.beans))&&e.focus(),this.destroyRenderer(),this.refreshWrapper(!0),ai(this.getParentOfValue()),this.cellEditorGui&&this.getParentOfValue().appendChild(this.cellEditorGui)}addPopupCellEditor(e,t){let{gos:i,context:n,popupSvc:o,editSvc:r}=this.beans;i.get("editType")==="fullRow"&&W(98);let s=this.cellEditorPopupWrapper=n.createBean(r.createPopupEditorWrapper(e)),{cellEditor:a,cellEditorGui:l,eCell:c,rowNode:d,column:u,cellCtrl:h}=this,p=s.getGui();l&&p.appendChild(l);let g=i.get("stopEditingWhenCellsLoseFocus"),f=t??a.getPopupPosition?.()??"over",m=i.get("enableRtl"),v={ePopup:p,column:u,rowNode:d,type:"popupCellEditor",eventSource:c,position:f,alignSide:m?"right":"left",keepWithinBounds:!0},C=o.positionPopupByComponent.bind(o,v),w=o.addPopup({modal:g,eChild:p,closeOnEsc:!0,closedCallback:()=>{h.onPopupEditorClosed()},anchorToElement:c,positionCallback:C,ariaOwns:c});w&&(this.hideEditorPopup=w.hideFunc)}detach(){this.getGui().remove()}destroy(){this.destroyRenderer(),this.destroyEditor(),this.removeControls(),super.destroy()}},CH=class extends je{constructor(e,t,i){super(),this.cellComps=new Map,this.beans=t,this.rowCtrl=e;let n=Ft({tag:"div",role:"row",attrs:{"comp-id":`${this.getCompId()}`}});this.setInitialStyle(n,i),this.setTemplateFromElement(n);let o=n.style;this.domOrder=this.rowCtrl.getDomOrder();let r={setDomOrder:s=>this.domOrder=s,setCellCtrls:s=>this.setCellCtrls(s),showFullWidth:s=>this.showFullWidth(s),getFullWidthCellRenderer:()=>this.fullWidthCellRenderer,getFullWidthCellRendererParams:()=>this.fullWidthCellRendererParams,toggleCss:(s,a)=>this.toggleCss(s,a),setUserStyles:s=>_d(n,s),setTop:s=>o.top=s,setTransform:s=>o.transform=s,setRowIndex:s=>n.setAttribute("row-index",s),setRowId:s=>n.setAttribute("row-id",s),setRowBusinessKey:s=>n.setAttribute("row-business-key",s),refreshFullWidth:s=>{let a=s();return this.fullWidthCellRendererParams=a,this.fullWidthCellRenderer?.refresh?.(a)??!1}};e.setComp(r,this.getGui(),i,void 0),this.addDestroyFunc(()=>{e.unsetComp(i)})}setInitialStyle(e,t){let i=this.rowCtrl.getInitialTransform(t);if(i)e.style.setProperty("transform",i);else{let n=this.rowCtrl.getInitialRowTop(t);n&&e.style.setProperty("top",n)}}showFullWidth(e){let t=n=>{if(this.isAlive()){let o=n.getGui();this.getGui().appendChild(o),this.rowCtrl.setupDetailRowAutoHeight(o),this.setFullWidthRowComp(n,e.params)}else this.beans.context.destroyBean(n)};e.newAgStackInstance().then(t)}setCellCtrls(e){let t=new Map(this.cellComps);for(let i of e){let n=i.instanceId;this.cellComps.has(n)?t.delete(n):this.newCellComp(i)}this.destroyCells(t),this.ensureDomOrder(e)}ensureDomOrder(e){if(!this.domOrder)return;let t=[];for(let i of e){let n=this.cellComps.get(i.instanceId);n&&t.push(n.getGui())}aR(this.getGui(),t)}newCellComp(e){let t=this.beans.editSvc?.isEditing(e,{withOpenEditor:!0})??!1,i=new vH(this.beans,e,this.rowCtrl.printLayout,this.getGui(),t);this.cellComps.set(e.instanceId,i),this.getGui().appendChild(i.getGui())}destroy(){super.destroy(),this.destroyCells(this.cellComps)}setFullWidthRowComp(e,t){this.fullWidthCellRenderer=e,this.fullWidthCellRendererParams=t,this.addDestroyFunc(()=>{this.fullWidthCellRenderer=this.beans.context.destroyBean(this.fullWidthCellRenderer),this.fullWidthCellRendererParams=void 0})}destroyCells(e){for(let t of e.values()){if(!t)return;let i=t.cellCtrl.instanceId;if(this.cellComps.get(i)!==t)return;t.detach(),t.destroy(),this.cellComps.delete(i)}}};function wH(e,t,i){let n=!!i.gos.get("enableCellSpan")&&!!t.getSpannedRowCtrls,o={tag:"div",ref:"eContainer",cls:Sp(e),role:"rowgroup"};if(t.type==="center"||n){let r={tag:"div",ref:"eSpannedContainer",cls:`ag-spanning-container ${GN(e)}`,role:"presentation"};return o.role="presentation",{tag:"div",ref:"eViewport",cls:`ag-viewport ${DP(e)}`,role:"rowgroup",children:[o,n?r:null]}}return o}var bH=class extends je{constructor(e){super(),this.eViewport=Z,this.eContainer=Z,this.eSpannedContainer=Z,this.rowCompsNoSpan={},this.rowCompsWithSpan={},this.name=e?.name,this.options=Md(this.name)}postConstruct(){this.setTemplate(wH(this.name,this.options,this.beans));let e={setHorizontalScroll:i=>this.eViewport.scrollLeft=i,setViewportHeight:i=>this.eViewport.style.height=i,setRowCtrls:({rowCtrls:i})=>this.setRowCtrls(i),setSpannedRowCtrls:i=>this.setRowCtrls(i,!0),setDomOrder:i=>{this.domOrder=i},setContainerWidth:i=>{this.eContainer.style.width=i,this.eSpannedContainer&&(this.eSpannedContainer.style.width=i)},setOffsetTop:i=>{let n=`translateY(${i})`;this.eContainer.style.transform=n,this.eSpannedContainer&&(this.eSpannedContainer.style.transform=n)}};this.createManagedBean(new JN(this.name)).setComp(e,this.eContainer,this.eSpannedContainer,this.eViewport)}destroy(){this.setRowCtrls([]),this.setRowCtrls([],!0),super.destroy(),this.lastPlacedElement=null}setRowCtrls(e,t){let{beans:i,options:n}=this,o=t?this.eSpannedContainer:this.eContainer,r=t?b({},this.rowCompsWithSpan):b({},this.rowCompsNoSpan),s={};t?this.rowCompsWithSpan=s:this.rowCompsNoSpan=s,this.lastPlacedElement=null;let a=[];for(let l of e){let c=l.instanceId,d=r[c],u;if(d)u=d,delete r[c];else{if(!l.rowNode.displayed)continue;u=new CH(l,i,n.type)}s[c]=u,a.push([u,!d])}this.removeOldRows(Object.values(r)),this.addRowNodes(a,o)}addRowNodes(e,t){let{domOrder:i}=this;for(let[n,o]of e){let r=n.getGui();i?this.ensureDomOrder(r,t):o&&t.appendChild(r)}}removeOldRows(e){for(let t of e)t.getGui().remove(),t.destroy()}ensureDomOrder(e,t){sR(t,e,this.lastPlacedElement),this.lastPlacedElement=e}},yH={selector:"AG-ROW-CONTAINER",component:bH};function Xc(e,t){return t.map(i=>{let n=`e${i[0].toUpperCase()+i.substring(1)}RowContainer`;return e[n]={name:i},{tag:"ag-row-container",ref:n,attrs:{name:i}}})}function SH(e){let t={},i={tag:"div",ref:"eGridRoot",cls:"ag-root ag-unselectable",children:[{tag:"ag-header-root"},{tag:"div",ref:"eTop",cls:"ag-floating-top",role:"presentation",children:Xc(t,["topLeft","topCenter","topRight","topFullWidth"])},{tag:"div",ref:"eBody",cls:"ag-body",role:"presentation",children:[{tag:"div",ref:"eBodyViewport",cls:"ag-body-viewport",role:"presentation",children:Xc(t,["left","center","right","fullWidth"])},{tag:"ag-fake-vertical-scroll"}]},{tag:"div",ref:"eStickyTop",cls:"ag-sticky-top",role:"presentation",children:Xc(t,["stickyTopLeft","stickyTopCenter","stickyTopRight","stickyTopFullWidth"])},{tag:"div",ref:"eStickyBottom",cls:"ag-sticky-bottom",role:"presentation",children:Xc(t,["stickyBottomLeft","stickyBottomCenter","stickyBottomRight","stickyBottomFullWidth"])},{tag:"div",ref:"eBottom",cls:"ag-floating-bottom",role:"presentation",children:Xc(t,["bottomLeft","bottomCenter","bottomRight","bottomFullWidth"])},{tag:"ag-fake-horizontal-scroll"},e?{tag:"ag-overlay-wrapper"}:null]};return{paramsMap:t,elementParams:i}}var xH=class extends je{constructor(){super(...arguments),this.eGridRoot=Z,this.eBodyViewport=Z,this.eStickyTop=Z,this.eStickyBottom=Z,this.eTop=Z,this.eBottom=Z,this.eBody=Z}postConstruct(){let{overlays:e,rangeSvc:t}=this.beans,i=e?.getOverlayWrapperSelector(),{paramsMap:n,elementParams:o}=SH(!!i);this.setTemplate(o,[...i?[i]:[],oB,aB,mH,yH],n);let r=(a,l)=>{let c=`${a}px`;l.style.minHeight=c,l.style.height=c},s={setRowAnimationCssOnBodyViewport:(a,l)=>this.setRowAnimationCssOnBodyViewport(a,l),setColumnCount:a=>A7(this.getGui(),a),setRowCount:a=>F7(this.getGui(),a),setTopHeight:a=>r(a,this.eTop),setBottomHeight:a=>r(a,this.eBottom),setTopInvisible:a=>this.eTop.classList.toggle("ag-invisible",a),setBottomInvisible:a=>this.eBottom.classList.toggle("ag-invisible",a),setStickyTopHeight:a=>this.eStickyTop.style.height=a,setStickyTopTop:a=>this.eStickyTop.style.top=a,setStickyTopWidth:a=>this.eStickyTop.style.width=a,setStickyBottomHeight:a=>{this.eStickyBottom.style.height=a,this.eStickyBottom.classList.toggle("ag-invisible",a==="0px")},setStickyBottomBottom:a=>this.eStickyBottom.style.bottom=a,setStickyBottomWidth:a=>this.eStickyBottom.style.width=a,setColumnMovingCss:(a,l)=>this.toggleCss(a,l),updateLayoutClasses:(a,l)=>{let c=[this.eBodyViewport.classList,this.eBody.classList];for(let d of c)d.toggle(Nn.AUTO_HEIGHT,l.autoHeight),d.toggle(Nn.NORMAL,l.normal),d.toggle(Nn.PRINT,l.print);this.toggleCss(Nn.AUTO_HEIGHT,l.autoHeight),this.toggleCss(Nn.NORMAL,l.normal),this.toggleCss(Nn.PRINT,l.print)},setAlwaysVerticalScrollClass:(a,l)=>this.eBodyViewport.classList.toggle(TP,l),registerBodyViewportResizeListener:a=>{let l=is(this.beans,this.eBodyViewport,a);this.addDestroyFunc(()=>l())},setPinnedTopBottomOverflowY:a=>this.eTop.style.overflowY=this.eBottom.style.overflowY=a,setCellSelectableCss:(a,l)=>{for(let c of[this.eTop,this.eBodyViewport,this.eBottom])c.classList.toggle(a,l)},setBodyViewportWidth:a=>this.eBodyViewport.style.width=a,setGridRootRole:a=>Jr(this.eGridRoot,a)};this.ctrl=this.createManagedBean(new eB),this.ctrl.setComp(s,this.getGui(),this.eBodyViewport,this.eTop,this.eBottom,this.eStickyTop,this.eStickyBottom),(t&&ar(this.gos)||Cd(this.gos))&&T7(this.getGui(),!0)}setRowAnimationCssOnBodyViewport(e,t){let i=this.eBodyViewport.classList;i.toggle("ag-row-animation",t),i.toggle("ag-row-no-animation",!t)}},EH={selector:"AG-GRID-BODY",component:xH},_H=class extends A{constructor(){super(...arguments),this.additionalFocusableContainers=new Set}setComp(e,t,i){this.view=e,this.eGridHostDiv=t,this.eGui=i,this.eGui.setAttribute("grid-id",this.beans.context.getId());let{dragAndDrop:n,ctrlsSvc:o}=this.beans;n?.registerGridDropTarget(()=>this.eGui,this),this.createManagedBean(new fw(this.view)),this.view.setRtlClass(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr");let r=is(this.beans,this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc(()=>r()),o.register("gridCtrl",this)}isDetailGrid(){return nP(this.getGui())?.getAttribute("row-id")?.startsWith("detail")||!1}getOptionalSelectors(){let e=this.beans;return{paginationSelector:e.pagination?.getPaginationSelector(),gridHeaderDropZonesSelector:e.registry?.getSelector("AG-GRID-HEADER-DROP-ZONES"),sideBarSelector:e.sideBar?.getSelector(),statusBarSelector:e.registry?.getSelector("AG-STATUS-BAR"),watermarkSelector:e.licenseManager?.getWatermarkSelector()}}onGridSizeChanged(){this.eventSvc.dispatchEvent({type:"gridSizeChanged",clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight})}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(e){let{view:t}=this;if(e===!1)t.setCursor(null);else{let i=e===1?"ew-resize":"ns-resize";t.setCursor(i)}}disableUserSelect(e){this.view.setUserSelect(e?"none":null)}focusNextInnerContainer(e){let t=this.getFocusableContainers(),{indexWithFocus:i,nextIndex:n}=this.getNextFocusableIndex(t,e);if(n<0||n>=t.length)return!1;if(n===0){if(i>0){let{visibleCols:o,focusSvc:r}=this.beans,s=o.allCols,a=rt(s);if(r.focusGridView({column:a,backwards:!0}))return!0}return!1}return this.focusContainer(t[n],e)}focusInnerElement(e){if(this.gos.getCallback("focusGridInnerElement")?.({fromBottom:!!e}))return!0;let i=this.getFocusableContainers(),{focusSvc:n,visibleCols:o}=this.beans,r=o.allCols;if(e){if(i.length>1)return this.focusContainer(rt(i),e);let s=rt(r);if(n.focusGridView({column:s,backwards:e}))return!0}if(this.gos.get("headerHeight")===0||na(this.beans)){if(n.focusGridView({column:r[0],backwards:e}))return!0;for(let s=1;s<i.length;s++)if(aa(i[s].getGui(),e))return!0;return!1}return n.focusFirstHeader()}forceFocusOutOfContainer(e=!1){this.view.forceFocusOutOfContainer(e)}addFocusableContainer(e){this.additionalFocusableContainers.add(e)}removeFocusableContainer(e){this.additionalFocusableContainers.delete(e)}allowFocusForNextCoreContainer(e){let t=this.view.getFocusableContainers(),{nextIndex:i,indexWithFocus:n}=this.getNextFocusableIndex(t,e);if(n===-1||i<0||i>=t.length)return;let o=t[i];o.setAllowFocus?.(!0),setTimeout(()=>{o.setAllowFocus?.(!1)})}isFocusable(){let e=this.beans;return!ig(e)||!na(e)||!!e.sideBar?.comp?.isDisplayed()}getNextFocusableIndex(e,t){let i=Ct(this.beans),n=e.findIndex(r=>r.getGui().contains(i)),o=n+(t?-1:1);return{indexWithFocus:n,nextIndex:o}}focusContainer(e,t){e.setAllowFocus?.(!0);let i=aa(e.getGui(),t,!1,!0);return e.setAllowFocus?.(!1),i}getFocusableContainers(){return[...this.view.getFocusableContainers(),...this.additionalFocusableContainers]}destroy(){this.additionalFocusableContainers.clear(),super.destroy()}},RH=class extends GP{constructor(e){super(),this.gridBody=Z,this.sideBar=Z,this.pagination=Z,this.rootWrapperBody=Z,this.eGridDiv=e}postConstruct(){let e={destroyGridUi:()=>this.destroyBean(this),setRtlClass:r=>this.addCss(r),forceFocusOutOfContainer:this.forceFocusOutOfContainer.bind(this),updateLayoutClasses:this.updateLayoutClasses.bind(this),getFocusableContainers:this.getFocusableContainers.bind(this),setUserSelect:r=>{this.getGui().style.userSelect=r??"",this.getGui().style.webkitUserSelect=r??""},setCursor:r=>{this.getGui().style.cursor=r??""}},t=this.createManagedBean(new _H),i=t.getOptionalSelectors(),n=this.createTemplate(i),o=[EH,...Object.values(i).filter(r=>!!r)];this.setTemplate(n,o),t.setComp(e,this.eGridDiv,this.getGui()),this.insertGridIntoDom(),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:r=>t.focusInnerElement(r),forceFocusOutWhenTabGuardsAreEmpty:!0,isEmpty:()=>!t.isFocusable()})}insertGridIntoDom(){let e=this.getGui();this.eGridDiv.appendChild(e),this.addDestroyFunc(()=>{e.remove(),Qr(this.gos,"Grid removed from DOM")})}updateLayoutClasses(e,t){let i=this.rootWrapperBody.classList,{AUTO_HEIGHT:n,NORMAL:o,PRINT:r}=Nn,{autoHeight:s,normal:a,print:l}=t;i.toggle(n,s),i.toggle(o,a),i.toggle(r,l),this.toggleCss(n,s),this.toggleCss(o,a),this.toggleCss(r,l)}createTemplate(e){let t=e.gridHeaderDropZonesSelector?{tag:"ag-grid-header-drop-zones"}:null,i=e.sideBarSelector?{tag:"ag-side-bar",ref:"sideBar"}:null,n=e.statusBarSelector?{tag:"ag-status-bar"}:null,o=e.watermarkSelector?{tag:"ag-watermark"}:null,r=e.paginationSelector?{tag:"ag-pagination",ref:"pagination"}:null;return{tag:"div",cls:"ag-root-wrapper",role:"presentation",children:[t,{tag:"div",ref:"rootWrapperBody",cls:"ag-root-wrapper-body",role:"presentation",children:[{tag:"ag-grid-body",ref:"gridBody"},i]},n,r,o]}}getFocusableElement(){return this.rootWrapperBody}forceFocusOutOfContainer(e=!1){if(!e&&this.pagination?.isDisplayed()){this.pagination.forceFocusOutOfContainer(e);return}super.forceFocusOutOfContainer(e)}getFocusableContainers(){let e=[this.gridBody];for(let t of[this.sideBar,this.pagination])t&&e.push(t);return e.filter(t=>bo(t.getGui()))}},Ee=(e,t)=>{for(let i of Object.keys(t))t[i]=e;return t},p_=b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b({dispatchEvent:"CommunityCore"},Ee("CommunityCore",{destroy:0,getGridId:0,getGridOption:0,isDestroyed:0,setGridOption:0,updateGridOptions:0,isModuleRegistered:0})),Ee("GridState",{getState:0,setState:0})),Ee("SharedRowSelection",{setNodesSelected:0,selectAll:0,deselectAll:0,selectAllFiltered:0,deselectAllFiltered:0,selectAllOnCurrentPage:0,deselectAllOnCurrentPage:0,getSelectedNodes:0,getSelectedRows:0})),Ee("RowApi",{redrawRows:0,setRowNodeExpanded:0,getRowNode:0,addRenderedRowListener:0,getRenderedNodes:0,forEachNode:0,getFirstDisplayedRowIndex:0,getLastDisplayedRowIndex:0,getDisplayedRowAtIndex:0,getDisplayedRowCount:0})),Ee("ScrollApi",{getVerticalPixelRange:0,getHorizontalPixelRange:0,ensureColumnVisible:0,ensureIndexVisible:0,ensureNodeVisible:0})),Ee("KeyboardNavigation",{getFocusedCell:0,clearFocusedCell:0,setFocusedCell:0,tabToNextCell:0,tabToPreviousCell:0,setFocusedHeader:0})),Ee("EventApi",{addEventListener:0,addGlobalListener:0,removeEventListener:0,removeGlobalListener:0})),Ee("ValueCache",{expireValueCache:0})),Ee("CellApi",{getCellValue:0})),Ee("SharedMenu",{showColumnMenu:0,hidePopupMenu:0})),Ee("Sort",{onSortChanged:0})),Ee("PinnedRow",{getPinnedTopRowCount:0,getPinnedBottomRowCount:0,getPinnedTopRow:0,getPinnedBottomRow:0,forEachPinnedRow:0})),Ee("Overlay",{showLoadingOverlay:0,showNoRowsOverlay:0,hideOverlay:0})),Ee("RenderApi",{setGridAriaProperty:0,refreshCells:0,refreshHeader:0,isAnimationFrameQueueEmpty:0,flushAllAnimationFrames:0,getSizesForCurrentTheme:0,getCellRendererInstances:0})),Ee("HighlightChanges",{flashCells:0})),Ee("RowDrag",{addRowDropZone:0,removeRowDropZone:0,getRowDropZoneParams:0,getRowDropPositionIndicator:0,setRowDropPositionIndicator:0})),Ee("ColumnApi",{getColumnDefs:0,getColumnDef:0,getDisplayNameForColumn:0,getColumn:0,getColumns:0,applyColumnState:0,getColumnState:0,resetColumnState:0,isPinning:0,isPinningLeft:0,isPinningRight:0,getDisplayedColAfter:0,getDisplayedColBefore:0,setColumnsVisible:0,setColumnsPinned:0,getAllGridColumns:0,getDisplayedLeftColumns:0,getDisplayedCenterColumns:0,getDisplayedRightColumns:0,getAllDisplayedColumns:0,getAllDisplayedVirtualColumns:0})),Ee("ColumnAutoSize",{sizeColumnsToFit:0,autoSizeColumns:0,autoSizeAllColumns:0})),Ee("ColumnGroup",{setColumnGroupOpened:0,getColumnGroup:0,getProvidedColumnGroup:0,getDisplayNameForColumnGroup:0,getColumnGroupState:0,setColumnGroupState:0,resetColumnGroupState:0,getLeftDisplayedColumnGroups:0,getCenterDisplayedColumnGroups:0,getRightDisplayedColumnGroups:0,getAllDisplayedColumnGroups:0})),Ee("ColumnMove",{moveColumnByIndex:0,moveColumns:0})),Ee("ColumnResize",{setColumnWidths:0})),Ee("ColumnHover",{isColumnHovered:0})),Ee("EditCore",{getCellEditorInstances:0,getEditingCells:0,getEditRowValues:0,stopEditing:0,startEditingCell:0,isEditing:0,validateEdit:0})),Ee("BatchEdit",{startBatchEdit:0,cancelBatchEdit:0,commitBatchEdit:0,isBatchEditing:0})),Ee("UndoRedoEdit",{undoCellEditing:0,redoCellEditing:0,getCurrentUndoSize:0,getCurrentRedoSize:0})),Ee("FilterCore",{isAnyFilterPresent:0,onFilterChanged:0})),Ee("ColumnFilter",{isColumnFilterPresent:0,getColumnFilterInstance:0,destroyFilter:0,setFilterModel:0,getFilterModel:0,getColumnFilterModel:0,setColumnFilterModel:0,showColumnFilter:0,hideColumnFilter:0,getColumnFilterHandler:0,doFilterAction:0})),Ee("QuickFilter",{isQuickFilterPresent:0,getQuickFilter:0,resetQuickFilter:0})),Ee("Find",{findGetActiveMatch:0,findGetTotalMatches:0,findGoTo:0,findNext:0,findPrevious:0,findGetNumMatches:0,findGetParts:0,findClearActive:0,findRefresh:0})),Ee("Pagination",{paginationIsLastPageFound:0,paginationGetPageSize:0,paginationGetCurrentPage:0,paginationGetTotalPages:0,paginationGetRowCount:0,paginationGoToNextPage:0,paginationGoToPreviousPage:0,paginationGoToFirstPage:0,paginationGoToLastPage:0,paginationGoToPage:0})),Ee("CsrmSsrmSharedApi",{expandAll:0,collapseAll:0})),Ee("SsrmInfiniteSharedApi",{setRowCount:0,getCacheBlockState:0,isLastRowIndexKnown:0})),Ee("ClientSideRowModelApi",{onGroupExpandedOrCollapsed:0,refreshClientSideRowModel:0,isRowDataEmpty:0,forEachLeafNode:0,forEachNodeAfterFilter:0,forEachNodeAfterFilterAndSort:0,applyTransaction:0,applyTransactionAsync:0,flushAsyncTransactions:0,getBestCostNodeSelection:0,onRowHeightChanged:0,resetRowHeights:0})),Ee("CsvExport",{getDataAsCsv:0,exportDataAsCsv:0})),Ee("InfiniteRowModel",{refreshInfiniteCache:0,purgeInfiniteCache:0,getInfiniteRowCount:0})),Ee("AdvancedFilter",{getAdvancedFilterModel:0,setAdvancedFilterModel:0,showAdvancedFilterBuilder:0,hideAdvancedFilterBuilder:0})),Ee("IntegratedCharts",{getChartModels:0,getChartRef:0,getChartImageDataURL:0,downloadChart:0,openChartToolPanel:0,closeChartToolPanel:0,createRangeChart:0,createPivotChart:0,createCrossFilterChart:0,updateChart:0,restoreChart:0})),Ee("Clipboard",{copyToClipboard:0,cutToClipboard:0,copySelectedRowsToClipboard:0,copySelectedRangeToClipboard:0,copySelectedRangeDown:0,pasteFromClipboard:0})),Ee("ExcelExport",{getDataAsExcel:0,exportDataAsExcel:0,getSheetDataForExcel:0,getMultipleSheetsAsExcel:0,exportMultipleSheetsAsExcel:0})),Ee("SharedMasterDetail",{addDetailGridInfo:0,removeDetailGridInfo:0,getDetailGridInfo:0,forEachDetailGridInfo:0})),Ee("ContextMenu",{showContextMenu:0})),Ee("ColumnMenu",{showColumnChooser:0,hideColumnChooser:0})),Ee("CellSelection",{getCellRanges:0,addCellRange:0,clearRangeSelection:0,clearCellSelection:0})),Ee("SharedRowGrouping",{setRowGroupColumns:0,removeRowGroupColumns:0,addRowGroupColumns:0,getRowGroupColumns:0,moveRowGroupColumn:0})),Ee("SharedAggregation",{addAggFuncs:0,clearAggFuncs:0,setColumnAggFunc:0})),Ee("SharedPivot",{isPivotMode:0,getPivotResultColumn:0,setValueColumns:0,getValueColumns:0,removeValueColumns:0,addValueColumns:0,setPivotColumns:0,removePivotColumns:0,addPivotColumns:0,getPivotColumns:0,setPivotResultColumns:0,getPivotResultColumns:0})),Ee("ServerSideRowModelApi",{getServerSideSelectionState:0,setServerSideSelectionState:0,applyServerSideTransaction:0,applyServerSideTransactionAsync:0,applyServerSideRowData:0,retryServerSideLoads:0,flushServerSideAsyncTransactions:0,refreshServerSide:0,getServerSideGroupLevelState:0,onRowHeightChanged:0,resetRowHeights:0})),Ee("SideBar",{isSideBarVisible:0,setSideBarVisible:0,setSideBarPosition:0,openToolPanel:0,closeToolPanel:0,getOpenedToolPanel:0,refreshToolPanel:0,isToolPanelShowing:0,getToolPanelInstance:0,getSideBar:0})),Ee("StatusBar",{getStatusPanel:0})),Ee("AiToolkit",{getStructuredSchema:0})),Qv={isDestroyed:()=>!0,destroy(){},preConstruct(){},postConstruct(){},preWireBeans(){},wireBeans(){}},PH=(e,t)=>e.eventSvc.dispatchEvent(t),zP=class{};Reflect.defineProperty(zP,"name",{value:"GridApi"});var DH=class extends A{constructor(){super(),this.beanName="apiFunctionSvc",this.api=new zP,this.fns=z(b({},Qv),{dispatchEvent:PH}),this.preDestroyLink="";let{api:e}=this;for(let t of Object.keys(p_))e[t]=this.makeApi(t)[t]}postConstruct(){this.preDestroyLink=this.beans.frameworkOverrides.getDocLink("grid-lifecycle/#grid-pre-destroyed")}addFunction(e,t){let{fns:i,beans:n}=this;i!==Qv&&(i[e]=n?.validation?.validateApiFunction(e,t)??t)}makeApi(e){return{[e]:(...t)=>{let{beans:i,fns:{[e]:n}}=this;return n?n(i,...t):this.apiNotFound(e)}}}apiNotFound(e){let{beans:t,gos:i,preDestroyLink:n}=this;if(!t)W(26,{fnName:e,preDestroyLink:n});else{let o=p_[e];i.assertModuleRegistered(o,`api.${e}`)&&W(27,{fnName:e,module:o})}}destroy(){super.destroy(),this.fns=Qv,this.beans=null}};function MH(e){return e.context.getId()}function kH(e){e.gridDestroySvc.destroy()}function TH(e){return e.gridDestroySvc.destroyCalled}function FH(e,t){return e.gos.get(t)}function IH(e,t,i){WP(e,{[t]:i})}function WP(e,t){e.gos.updateGridOptions({options:t})}function AH(e,t){let i=t.replace(/Module$/,"");return e.gos.isModuleRegistered(i)}var LH={tag:"div",cls:"ag-drag-handle ag-row-drag",attrs:{draggable:"true"}},OH=class extends je{constructor(e,t,i){super(LH),this.rowNode=e,this.column=t,this.eCell=i}postConstruct(){this.getGui().appendChild(wn("rowDrag",this.beans,null)),this.addGuiEventListener("mousedown",t=>{t.stopPropagation()}),this.addDragSource(),this.checkVisibility()}addDragSource(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))}onDragStart(e){let{rowNode:t,column:i,eCell:n,gos:o}=this,r=i.getColDef().dndSourceOnRowDrag,s=e.dataTransfer;if(s.setDragImage(n,0,0),r){let a=ye(o,{rowNode:t,dragEvent:e});r(a)}else try{let a=JSON.stringify(t.data);s.setData("application/json",a),s.setData("text/plain",a)}catch{}}checkVisibility(){let e=this.column.isDndSource(this.rowNode);this.setDisplayed(e)}};function NH(e,t){e.rowDragSvc?.rowDragFeature?.addRowDropZone(t)}function BH(e,t){let i=e.dragAndDrop?.findExternalZone(t.getContainer());i&&e.dragAndDrop?.removeDropTarget(i)}function HH(e,t){return e.rowDragSvc?.rowDragFeature?.getRowDropZone(t)}function VH(e){let t=e.rowDropHighlightSvc;return t?{row:t.row,dropIndicatorPosition:t.position}:{row:null,dropIndicatorPosition:"none"}}function GH(e,t){let i=e.rowDropHighlightSvc;if(!i)return;let n=t?.row,o=t?.dropIndicatorPosition;o!=="above"&&o!=="below"&&o!=="inside"&&(o="none");let r=n?.rowIndex;r==null||o==="none"?i.clear():i.set(n,o)}var zH=class extends iN{shouldPreventMouseEvent(e){return this.gos.get("enableCellTextSelection")&&super.shouldPreventMouseEvent(e)}},WH=class extends A{constructor(){super(...arguments),this.beanName="horizontalResizeSvc"}addResizeBar(e){let t={dragStartPixels:e.dragStartPixels||0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e),onDragCancel:this.onDragStop.bind(this,e),includeTouch:!0,stopPropagationForTouch:!0},{dragSvc:i}=this.beans;return i.addDragSource(t),()=>i.removeDragSource(t)}onDragStart(e,t){this.dragStartX=t.clientX,this.setResizeIcons();let i=t instanceof MouseEvent&&t.shiftKey===!0;e.onResizeStart(i)}setResizeIcons(){let e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(1),e.disableUserSelect(!0)}onDragStop(e){e.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){let e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(!1),e.disableUserSelect(!1)}onDragging(e,t){this.resizeAmount=t.clientX-this.dragStartX,e.onResizing(this.resizeAmount)}},UH={tag:"div",cls:"ag-drag-handle ag-row-drag",attrs:{"aria-hidden":"true"}},qH=class extends je{constructor(e,t,i,n,o,r=!1){super(),this.cellValueFn=e,this.rowNode=t,this.column=i,this.customGui=n,this.dragStartPixels=o,this.alwaysVisible=r,this.dragSource=null}isCustomGui(){return this.customGui!=null}postConstruct(){let{beans:e,customGui:t}=this;t?this.setDragElement(t,this.dragStartPixels):(this.setTemplate(UH),this.getGui().appendChild(wn("rowDrag",e,null)),this.addDragSource()),this.alwaysVisible||this.initCellDrag()}initCellDrag(){let{beans:e,gos:t,rowNode:i}=this,n=this.refreshVisibility.bind(this);this.addManagedPropertyListener("suppressRowDrag",n),this.addManagedListeners(i,{dataChanged:n,cellChanged:n}),this.addManagedListeners(e.eventSvc,t.get("rowDragManaged")?{sortChanged:n,filterChanged:n,columnRowGroupChanged:n,newColumnsLoaded:n}:{newColumnsLoaded:n})}setDragElement(e,t){this.setTemplateFromElement(e,void 0,void 0,!0),this.addDragSource(t)}refreshVisibility(){if(this.alwaysVisible)return;let e={skipAriaHidden:!0};if(this.isNeverDisplayed()){this.setDisplayed(!1,e);return}let t=this.column,i=typeof t?.getColDef().rowDrag=="function",n=!t||this.isCustomGui()||t.isRowDrag(this.rowNode);n&&this.rowNode.footer&&this.gos.get("rowDragManaged")&&(n=!1,i=!0),this.setDisplayed(i||n,e),this.setVisible(n,e)}isNeverDisplayed(){let{gos:e,beans:t}=this;return!!(e.get("suppressRowDrag")||e.get("rowDragManaged")&&t.rowDragSvc.rowDragFeature?.shouldPreventRowMove()&&!t.dragAndDrop?.hasExternalDropZones())}getSelectedNodes(){let e=this.rowNode;if(!this.gos.get("rowDragMultiRow"))return[e];let i=this.beans.selectionSvc?.getSelectedNodes()??[];return i.indexOf(e)!==-1?i:[e]}getDragItem(){let{column:e,rowNode:t}=this;return{rowNode:t,rowNodes:this.getSelectedNodes(),columns:e?[e]:void 0,defaultTextValue:this.cellValueFn()}}getRowDragText(e){if(e){let t=e.getColDef();if(t.rowDragText)return t.rowDragText}return this.gos.get("rowDragText")}addDragSource(e=4){if(this.dragSource&&this.removeDragSource(),this.gos.get("rowDragManaged")&&this.rowNode.footer)return;let t=this.getGui();this.gos.get("enableCellTextSelection")&&(this.removeMouseDownListener(),this.mouseDownListener=this.addManagedElementListeners(t,{mousedown:n=>{n?.preventDefault()}})[0]);let i=this.getLocaleTextFunc();this.dragSource={type:2,eElement:t,dragItemName:n=>{let o=n?.dragItem||this.getDragItem(),r=(n?.dropTarget?.rows.length??o.rowNodes?.length)||1,s=this.getRowDragText(this.column);return s?s(o,r):r===1?this.cellValueFn():`${r} ${i("rowDragRows","rows")}`},getDragItem:()=>this.getDragItem(),dragStartPixels:e,dragSourceDomDataKey:this.gos.getDomDataKey()},this.beans.dragAndDrop.addDragSource(this.dragSource,!0)}destroy(){this.removeDragSource(),this.removeMouseDownListener(),super.destroy()}removeDragSource(){this.dragSource&&(this.beans.dragAndDrop.removeDragSource(this.dragSource),this.dragSource=null)}removeMouseDownListener(){this.mouseDownListener&&(this.mouseDownListener(),this.mouseDownListener=void 0)}},xp=class{constructor(){this.reordered=!1,this.removals=new Set,this.updates=new Set,this.adds=new Set}};function $H(e){let{rowIndex:t,rowPinned:i,column:n}=e;return`${t}.${i??"null"}.${n.getId()}`}function UP(e,t){let i=e.column===t.column,n=e.rowPinned===t.rowPinned,o=e.rowIndex===t.rowIndex;return i&&n&&o}function jH(e,t){switch(e.rowPinned){case"top":if(t.rowPinned!=="top")return!0;break;case"bottom":if(t.rowPinned!=="bottom")return!1;break;default:if(ie(t.rowPinned))return t.rowPinned!=="top";break}return e.rowIndex<t.rowIndex}function KH(e,t){return!e&&!t?!0:e&&!t||!e&&t?!1:e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned}function YH(e){let t=0,i,{pinnedRowModel:n,rowModel:o,pageBounds:r}=e;return n?.getPinnedTopRowCount()?i="top":o.getRowCount()?(i=null,t=r.getFirstRow()):n?.getPinnedBottomRowCount()&&(i="bottom"),i===void 0?null:{rowIndex:t,rowPinned:i}}function XH(e){let t,i=null,{pinnedRowModel:n,pageBounds:o}=e,r=n?.getPinnedBottomRowCount(),s=n?.getPinnedTopRowCount();return r?(i="bottom",t=r-1):e.rowModel.getRowCount()?t=o.getLastRow():s&&(i="top",t=s-1),t===void 0?null:{rowIndex:t,rowPinned:i}}function lr(e,t){switch(t.rowPinned){case"top":return e.pinnedRowModel?.getPinnedTopRow(t.rowIndex);case"bottom":return e.pinnedRowModel?.getPinnedBottomRow(t.rowIndex);default:return e.rowModel.getRow(t.rowIndex)}}function dl(e,t){let i=e.spannedRowRenderer?.getCellByPosition(t);if(i)return i;let n=e.rowRenderer.getRowByPosition(t);return n?n.getCellCtrl(t.column):null}function JH(e,t,i){let{rowModel:n,pinnedRowModel:o}=e,r;return r??(r=n?.getRowNode(t)),i?r??(r=o?.getPinnedRowById(t,i)):(r??(r=o?.getPinnedRowById(t,"top")),r??(r=o?.getPinnedRowById(t,"bottom"))),r}function qp(e,t,i=!1){let{rowIndex:n,rowPinned:o}=t,{pageBounds:r,pinnedRowModel:s,rowModel:a}=e;if(n===0)return o==="top"?null:o==="bottom"&&a.isRowsToRender()?{rowIndex:r.getLastRow(),rowPinned:null}:s?.isRowsToRender("top")?{rowIndex:s.getPinnedTopRowCount()-1,rowPinned:"top"}:null;if(i){let l=o?void 0:a.getRow(n);return qP(e,l,!0)??{rowIndex:n-1,rowPinned:o}}return{rowIndex:n-1,rowPinned:o}}function g_(e,t,i=!1){let{rowIndex:n,rowPinned:o}=t,{pageBounds:r,pinnedRowModel:s,rowModel:a}=e;if(QH(e,t))return o==="bottom"?null:o==="top"&&a.isRowsToRender()?{rowIndex:r.getFirstRow(),rowPinned:null}:s?.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;if(i){let l=o?void 0:a.getRow(n);return qP(e,l)??{rowIndex:n+1,rowPinned:o}}return{rowIndex:n+1,rowPinned:o}}function qP(e,t,i=!1){let{gos:n,rowRenderer:o}=e;if(!t?.sticky||!RR(n))return;let r=o.getStickyTopRowCtrls(),s=o.getStickyBottomRowCtrls(),a=!s.some(u=>u.rowNode.rowIndex===t.rowIndex),l=a?r:s,c=(i?-1:1)*(a?-1:1),d;for(let u=0;u<l.length;u++)if(l[u].rowNode.rowIndex===t.rowIndex){d=l[u+c];break}return d?{rowIndex:d.rowNode.rowIndex,rowPinned:null}:void 0}function QH(e,t){let{rowPinned:i,rowIndex:n}=t,{pinnedRowModel:o,pageBounds:r}=e;return i==="top"?(o?.getPinnedTopRowCount()??0)-1<=n:i==="bottom"?(o?.getPinnedBottomRowCount()??0)-1<=n:r.getLastRow()<=n}var Sd=class{constructor(e,t){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=e,this.pathRoot={rowNode:t,children:null},this.mapToItems[t.id]=this.pathRoot}depthFirstSearchChangedPath(e,t){let{rowNode:i,children:n}=e;if(n)for(let o=0;o<n.length;++o)this.depthFirstSearchChangedPath(n[o],t);t(i)}depthFirstSearchEverything(e,t,i){let n=e.childrenAfterGroup;if(n)for(let o=0,r=n.length;o<r;++o){let s=n[o];s.childrenAfterGroup?this.depthFirstSearchEverything(s,t,i):i&&t(s)}t(e)}forEachChangedNodeDepthFirst(e,t=!1,i=!1){this.active&&!i?this.depthFirstSearchChangedPath(this.pathRoot,e):this.depthFirstSearchEverything(this.pathRoot.rowNode,e,t)}executeFromRootNode(e){e(this.pathRoot.rowNode)}createPathItems(e){let t=e,i=0;for(;!this.mapToItems[t.id];){let n={rowNode:t,children:null};this.mapToItems[t.id]=n,i++,t=t.parent}return i}populateColumnsMap(e,t){if(!this.keepingColumns||!t)return;let i=e;for(;i;){this.nodeIdsToColumns[i.id]||(this.nodeIdsToColumns[i.id]={});for(let n of t)this.nodeIdsToColumns[i.id][n.getId()]=!0;i=i.parent}}linkPathItems(e,t){let i=e;for(let n=0;n<t;n++){let o=this.mapToItems[i.id],r=this.mapToItems[i.parent.id];r.children||(r.children=[]),r.children.push(o),i=i.parent}}addParentNode(e,t){if(!e||e.isRowPinned())return;let i=this.createPathItems(e);this.linkPathItems(e,i),this.populateColumnsMap(e,t)}canSkip(e){return this.active&&!this.mapToItems[e.id]}getValueColumnsForNode(e,t){if(!this.keepingColumns)return t;let i=this.nodeIdsToColumns[e.id];return t.filter(o=>i[o.getId()])}getNotValueColumnsForNode(e,t){if(!this.keepingColumns)return null;let i=this.nodeIdsToColumns[e.id];return t.filter(o=>!i[o.getId()])}},ZH=class{constructor(e,t){this.beans=e,this.groupThrottled=!1,this.scrollChanged=!1,this.scrollChanging=!1,this.oldVScroll=null,this.groupTimer=null,this.groupTarget=null,this.onGroupThrottle=()=>{this.groupTimer=null,this.groupThrottled=!0,this.beans.dragAndDrop?.nudge()};let i=()=>t.scrollFeature.getVScrollPosition().top;this.autoScroll=new sH({scrollContainer:t.eBodyViewport,scrollAxis:"y",getVerticalPosition:i,setVerticalPosition:n=>t.scrollFeature.setVerticalScrollPosition(n),onScrollCallback:()=>{let n=i();if(this.oldVScroll!==n){this.oldVScroll=n,this.scrollChanging=!0;return}let o=this.scrollChanging;this.scrollChanged=o,this.scrollChanging=!1,o&&(this.beans.dragAndDrop?.nudge(),this.scrollChanged=!1)}})}updateGroup(e,t){this.groupTarget&&this.groupTarget!==e&&this.clearGroup(),e&&(t&&this.groupThrottled&&!e.expanded&&e.childrenAfterSort?.length&&e.isExpandable()&&e.setExpanded(!0,void 0,!0),e.expanded&&e.childrenAfterSort?.length&&(this.groupThrottled=!0,this.groupTarget=e))}startGroup(e){this.groupTarget=e,this.groupTimer===null&&(this.groupTimer=window.setTimeout(this.onGroupThrottle,this.beans.gos.get("rowDragInsertDelay")))}clearGroup(){this.groupThrottled=!1,this.groupTarget=null;let e=this.groupTimer;e!==null&&(this.groupTimer=null,window.clearTimeout(e))}clear(){this.clearGroup(),this.autoScroll.ensureCleared(),this.oldVScroll=null,this.scrollChanged=!1,this.scrollChanging=!1}},eV=class extends A{constructor(e){super(),this.eContainer=e,this.lastDraggingEvent=null,this.nudger=null}postConstruct(){let e=this.beans;e.ctrlsSvc.whenReady(this,t=>{this.nudger=new ZH(e,t.gridBodyCtrl)})}destroy(){super.destroy(),this.nudger?.clear(),this.nudger=null,this.lastDraggingEvent=null,this.eContainer=null}getContainer(){return this.eContainer}isInterestedIn(e){return e===2}getIconName(e){return e?.dropTarget?.allowed===!1||this.gos.get("rowDragManaged")&&this.shouldPreventRowMove()?"notAllowed":"move"}shouldPreventRowMove(){let{rowGroupColsSvc:e,filterManager:t,sortSvc:i}=this.beans;return!!((e?.columns??[]).length||t?.isAnyFilterPresent()||i?.isSortActive())}getRowNodes(e){if(!this.isFromThisGrid(e))return e.dragItem.rowNodes||[];let t=e.dragItem.rowNode;if(this.gos.get("rowDragMultiRow")){let i=this.beans.selectionSvc?.getSelectedNodes();if(i&&i.indexOf(t)>=0)return i.slice().sort(nV)}return[t]}onDragEnter(e){this.dragging(e,!0)}onDragging(e){this.dragging(e,!1)}dragging(e,t){let{lastDraggingEvent:i,beans:n}=this;if(t){let s=this.getRowNodes(e);e.dragItem.rowNodes=s,v_(s,!0)}this.lastDraggingEvent=e;let o=e.fromNudge,r=this.makeRowsDrop(i,e,o,!1);n.rowDropHighlightSvc?.fromDrag(e),t&&this.dispatchGridEvent("rowDragEnter",e),this.dispatchGridEvent("rowDragMove",e),r?.rowDragManaged&&r.moved&&r.allowed&&r.sameGrid&&!r.suppressMoveWhenRowDragging&&(!o&&!this.nudger?.autoScroll.scrolling||this.nudger?.scrollChanged)&&this.dropRows(r),this.nudger?.autoScroll.check(e.event)}isFromThisGrid(e){return e.dragSource.dragSourceDomDataKey===this.gos.getDomDataKey()}makeRowsDrop(e,t,i,n){let{beans:o,gos:r}=this,s=this.newRowsDrop(t,n),a=o.rowModel;if(t.dropTarget=s,t.changed=!1,!s)return null;let{sameGrid:l,rootNode:c,source:d,target:u,rows:h}=s;u??(u=a.getRow(a.getRowCount()-1)??null);let p=!!this.beans.groupStage?.treeData&&l,g=null;if(u?.footer){let w=Ep(a,-1,u)??Ep(a,1,u);g=u.sibling??c,u=w??null}u?.detail&&(u=u.parent),s.moved&&(s.moved=d!==u);let f=.5;if(u&&(l&&s.moved&&(g||!p)?f=d.rowIndex>u.rowIndex?-.5:.5:f=(s.y-u.rowTop-u.rowHeight/2)/u.rowHeight||0),!p&&l&&u&&s.moved&&Tt(r)){let w=oV(a,s);w&&(f=d.rowIndex>w.rowIndex?-.5:.5,u=w,s.moved&&(s.moved=d!==u))}let m=this.nudger;m?.updateGroup(u,i),p&&!g&&m&&(!u||f>=.5&&u.rowIndex===o.pageBounds.getLastRow()?g=c:s.moved&&this.targetShouldBeParent(u,f,h)&&(m.groupThrottled&&(g=u),!i&&(!g||u&&!u.expanded&&u.childrenAfterSort?.length)&&m.startGroup(u)),g??(g=u?.parent??c));let v=!1;if(g){if(g===u&&g!==c){let w=g.expanded?Ep(a,1,u):null;w?.parent===g?(u=w,f=-.5):v=!0}if(u&&!v){let w=u;for(;w&&w!==c&&w!==g;)u=w,w=w.parent}}s.target=u,s.newParent=g,s.moved&&(s.moved=d!==u);let C=f<0?"above":"below";return s.position=s.moved?v?"inside":C:"none",this.validateRowsDrop(s,p,C,n),t.changed||(t.changed=iV(e?.dropTarget,s)),s}newRowsDrop(e,t){let{beans:i,gos:n}=this,o=i.rowModel.rootNode,r=Tt(n)?n.get("rowDragManaged"):!1,s=n.get("suppressMoveWhenRowDragging"),a=this.isFromThisGrid(e),{rowNode:l,rowNodes:c}=e.dragItem;if(c||(c=l?[l]:[]),l||(l=c[0]),!l||!o)return null;let d=this.beans.dragAndDrop.isDropZoneWithinThisGrid(e),u=!0;r&&(!c.length||this.shouldPreventRowMove()||(s||!a)&&!d)&&(u=!1);let h=i_(i,e).y,p=this.getOverNode(h);return{api:i.gridApi,context:i.gridOptions.context,draggingEvent:e,rowDragManaged:r,suppressMoveWhenRowDragging:s,sameGrid:a,withinGrid:d,rootNode:o,moved:l!==p,y:h,overNode:p,overIndex:p?.rowIndex??-1,position:"none",source:l,target:p??null,newParent:null,rows:c,allowed:u,highlight:!t&&r&&s&&(d||!a)}}validateRowsDrop(e,t,i,n){let{rowDragManaged:o,suppressMoveWhenRowDragging:r}=e;t||(e.newParent=null),r&&!e.moved&&(e.allowed=!1);let s=(!o||e.allowed)&&this.gos.get("isRowValidDropPosition");if(s){t&&e.newParent&&f_(e.rows,e.newParent)&&(e.newParent=null);let a=s(e);if(!a)e.allowed=!1;else if(typeof a=="object"){a.rows!==void 0&&(e.rows=a.rows??[]),t&&a.newParent!==void 0&&(e.newParent=a.newParent),a.target!==void 0&&(e.target=a.target),a.position&&(e.position=a.position),a.allowed!==void 0?e.allowed=a.allowed:o||(e.allowed=!0);let l=e.draggingEvent;a.changed&&l&&(l.changed=!0),!n&&a.highlight!==void 0&&(e.highlight=a.highlight)}}o&&(e.rows=this.filterRows(e)),t&&e.newParent&&f_(e.rows,e.newParent)&&(e.newParent=null),r&&(!e.rows.length||e.position==="none")&&(e.allowed=!1),(!e.allowed||!e.newParent)&&e.position==="inside"&&(e.position=i)}targetShouldBeParent(e,t,i){let n=e.rowIndex,o=.25;if(t<-.5+o)return!1;if(t<.5-o)return!0;let r,s=n+1,a=this.beans.rowModel;do r=a.getRow(s++);while(r?.footer);let l=e.childrenAfterGroup;if(r&&r.parent===e&&l?.length){let c=new Set(i);for(let d of l)if(d.rowIndex!==null&&!c.has(d))return!0}return!1}addRowDropZone(e){if(!e.getContainer()){W(55);return}let t=this.beans.dragAndDrop;if(t.findExternalZone(e.getContainer())){W(56);return}let i=e.fromGrid?e:{getContainer:e.getContainer,onDragEnter:e.onDragEnter&&(o=>e.onDragEnter(this.rowDragEvent("rowDragEnter",o))),onDragLeave:e.onDragLeave&&(o=>e.onDragLeave(this.rowDragEvent("rowDragLeave",o))),onDragging:e.onDragging&&(o=>e.onDragging(this.rowDragEvent("rowDragMove",o))),onDragStop:e.onDragStop&&(o=>e.onDragStop(this.rowDragEvent("rowDragEnd",o))),onDragCancel:e.onDragCancel&&(o=>e.onDragCancel(this.rowDragEvent("rowDragCancel",o)))},n=b({isInterestedIn:o=>o===2,getIconName:()=>"move",external:!0},i);t.addDropTarget(n),this.addDestroyFunc(()=>t.removeDropTarget(n))}getRowDropZone(e){return{getContainer:this.getContainer.bind(this),onDragEnter:i=>{this.onDragEnter(i),e?.onDragEnter?.(this.rowDragEvent("rowDragEnter",i))},onDragLeave:i=>{this.onDragLeave(i),e?.onDragLeave?.(this.rowDragEvent("rowDragLeave",i))},onDragging:i=>{this.onDragging(i),e?.onDragging?.(this.rowDragEvent("rowDragMove",i))},onDragStop:i=>{this.onDragStop(i),e?.onDragStop?.(this.rowDragEvent("rowDragEnd",i))},onDragCancel:i=>{this.onDragCancel(i),e?.onDragCancel?.(this.rowDragEvent("rowDragCancel",i))},fromGrid:!0}}getOverNode(e){let{pageBounds:t,rowModel:i}=this.beans,o=e>t.getCurrentPagePixelRange().pageLastPixel?-1:i.getRowIndexAtPixel(e);return o>=0?i.getRow(o):void 0}rowDragEvent(e,t){let i=this.beans,{dragItem:n,dropTarget:o,event:r,vDirection:s}=t,a=o?.rootNode===i.rowModel.rootNode,l=a?o.y:i_(i,t).y,c=a?o.overNode:this.getOverNode(l),d=a?o.overIndex:c?.rowIndex??-1;return{api:i.gridApi,context:i.gridOptions.context,type:e,event:r,node:n.rowNode,nodes:n.rowNodes,overIndex:d,overNode:c,y:l,vDirection:s,rowsDrop:o}}dispatchGridEvent(e,t){let i=this.rowDragEvent(e,t);this.eventSvc.dispatchEvent(i)}onDragLeave(e){this.dispatchGridEvent("rowDragLeave",e),this.stopDragging(e)}onDragStop(e){let t=this.makeRowsDrop(this.lastDraggingEvent,e,!1,!0);this.dispatchGridEvent("rowDragEnd",e),t?.allowed&&t.rowDragManaged&&(t.suppressMoveWhenRowDragging||!t.sameGrid||this.nudger?.autoScroll.scrolling)&&this.dropRows(t),this.stopDragging(e)}onDragCancel(e){this.dispatchGridEvent("rowDragCancel",e),this.stopDragging(e)}stopDragging(e){this.nudger?.clear(),this.beans.rowDropHighlightSvc?.fromDrag(null),v_(e.dragItem.rowNodes,!1)}dropRows(e){return e.sameGrid?this.csrmMoveRows(e):this.csrmAddRows(e)}csrmAddRows({position:e,target:t,rows:i}){let n=xl(this.gos),o=this.beans.rowModel,r=i.filter(({data:a,rowPinned:l})=>!o.getRowNode(n?.({data:a,level:0,rowPinned:l})??a.id)).map(({data:a})=>a);if(r.length===0)return!1;let s=t?m_(t)+(e==="above"?0:1):void 0;return o.updateRowData({add:r,addIndex:s}),!0}filterRows({newParent:e,rows:t}){let i;for(let n=0,o=t.length;n<o;++n){let r=!0,s=t[n];(!s||s.footer||s.rowTop===null&&s!==this.beans.rowModel.getRowNode(s.id)||e&&s.parent!==e&&tV(s,e)||!IC(s))&&(r=!1),r?i?.push(s):i??(i=t.slice(0,n))}return i??t}csrmMoveRows({position:e,target:t,rows:i,newParent:n,rootNode:o}){let r=!1,s=new Set;for(let h of i){n&&h.parent!==n&&(h.treeParent=n,r=!0);let p=IC(h);p&&s.add(p)}if(!r&&s.size===0)return!1;let a=this.beans.focusSvc,l=a.getFocusedCell(),c=l&&dl(this.beans,l);if(s.size&&this.reorderLeafChildren(s,...this.getMoveRowsBounds(s,t,e==="above"))&&(r=!0),!r)return!1;let d=this.beans.rowModel,u=new xp;return u.reordered=!0,d.refreshModel({step:"group",keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame"),changedPath:new Sd(!1,o),changedRowNodes:u}),c?c.focusCell():a.clearFocusedCell(),!0}getMoveRowsBounds(e,t,i){let n=this.beans.rowModel.rootNode?._leafs?.length??0,o=t?m_(t):-1;o<0||o>=n?o=n:i||++o;let r=o,s=Math.min(o,n-1);for(let a of e){let l=a.sourceRowIndex;l<r&&(r=l),l>s&&(s=l)}return[r,o,s]}reorderLeafChildren(e,t,i,n){let o=!1,r=this.beans.rowModel.rootNode?._leafs;if(!e.size||!r)return!1;let s=t;for(let l=t;l<i;++l){let c=r[l];e.has(c)||(c.sourceRowIndex!==s&&(c.sourceRowIndex=s,r[s]=c,o=!0),++s)}let a=n;for(let l=n;l>=i;--l){let c=r[l];e.has(c)||(c.sourceRowIndex!==a&&(c.sourceRowIndex=a,r[a]=c,o=!0),--a)}for(let l of e)l.sourceRowIndex!==s&&(l.sourceRowIndex=s,r[s]=l,o=!0),++s;return o}},Ep=(e,t,i)=>{if(i){let n=e.getRowCount(),o=i.rowIndex+t;for(;o>=0&&o<n;){let r=e.getRow(o);if(!r||!r.footer&&!r.detail)return r;o+=t}}},tV=(e,t)=>{let i=t;for(;i;){if(i===e)return!0;i=i.parent}return!1},f_=(e,t)=>{for(let i=0,n=e.length;i<n;++i)if(e[i].parent!==t)return!1;return!0},m_=e=>{let t=IC(e);return t!==void 0?t.sourceRowIndex:-1},IC=e=>e.data?e:CP(e.childrenAfterGroup),iV=(e,t)=>e!==t&&(!e||e.sameGrid!==t.sameGrid||e.allowed!==t.allowed||e.position!==t.position||e.target!==t.target||e.source!==t.source||e.newParent!==t.newParent||!ns(e.rows,t.rows)),nV=({rowIndex:e},{rowIndex:t})=>e!==null&&t!==null?e-t:0,v_=(e,t)=>{for(let i=0,n=e?.length||0;i<n;++i){let o=e[i];o.dragging!==t&&(o.dragging=t,o.dispatchRowEvent("draggingChanged"))}},oV=(e,t)=>{let i=null,n=t.target;if(n&&t.rows.indexOf(n)<0)return null;let o=t.source;if(!n||!o)return null;let r=n.rowIndex-o.rowIndex,s=r<0?-1:1;r=t.suppressMoveWhenRowDragging?Math.abs(r):1;let a=new Set(t.rows);do{let l=Ep(e,s,n);if(!l)break;a.has(l)||(i=l,--r),n=l}while(r>0);return i},rV=class extends A{constructor(){super(...arguments),this.beanName="rowDragSvc"}setupRowDrag(e,t){let i=t.createManagedBean(new eV(e)),n=this.beans.dragAndDrop;n.addDropTarget(i),t.addDestroyFunc(()=>n.removeDropTarget(i)),this.rowDragFeature=i}createRowDragComp(e,t,i,n,o,r){return new qH(e,t,i,n,o,r)}createRowDragCompForRow(e,t){if(ar(this.gos))return;let i=this.getLocaleTextFunc();return this.createRowDragComp(()=>`1 ${i("rowDragRow","row")}`,e,void 0,t,void 0,!0)}createRowDragCompForCell(e,t,i,n,o,r){let s=this.gos;return s.get("rowDragManaged")&&(!Tt(s)||s.get("pagination"))?void 0:this.createRowDragComp(i,e,t,n,o,r)}},sV=class extends A{constructor(){super(...arguments),this.beanName="rowDropHighlightSvc",this.uiLevel=0,this.dragging=!1,this.row=null,this.position="none"}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this)})}onModelUpdated(){let e=this.row,t=this.dragging;!e||e?.rowIndex===null||this.position==="none"?this.clear():this.set(e,this.position),this.dragging=t}destroy(){this.clear(),super.destroy()}clear(){let e=this.row;this.dragging=!1,e&&(this.uiLevel=0,this.position="none",this.row=null,e.dispatchRowEvent("rowHighlightChanged"))}set(e,t){let i=e!==this.row,n=e.uiLevel,o=t!==this.position,r=n!==this.uiLevel;this.dragging=!1,(i||o||r)&&(i&&this.clear(),this.uiLevel=n,this.position=t,this.row=e,e.dispatchRowEvent("rowHighlightChanged"))}fromDrag(e){let t=e?.dropTarget;if(t){let{highlight:i,target:n,position:o}=t;if(i&&n&&o!=="none"){this.set(n,o),this.dragging=!0;return}}this.dragging&&this.clear()}},$P={moduleName:"Drag",version:ee,beans:[zH]},aV={moduleName:"DragAndDrop",version:ee,dynamicBeans:{dndSourceComp:OH},icons:{rowDrag:"grip"}},jP={moduleName:"SharedDragAndDrop",version:ee,beans:[oN],dependsOn:[$P],userComponents:{agDragAndDropImage:BB},icons:{columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",rowDrag:"grip"}},lV={moduleName:"RowDrag",version:ee,beans:[sV,rV],apiFunctions:{addRowDropZone:NH,removeRowDropZone:BH,getRowDropZoneParams:HH,getRowDropPositionIndicator:VH,setRowDropPositionIndicator:GH},dependsOn:[jP]},cV={moduleName:"HorizontalResize",version:ee,beans:[WH],dependsOn:[$P]},dV=":where(.ag-ltr) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:left .2s}.ag-header-group-cell{transition:left .2s,width .2s}}:where(.ag-rtl) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:right .2s}.ag-header-group-cell{transition:right .2s,width .2s}}",uV=class extends A{constructor(){super(...arguments),this.beanName="colAnimation",this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.activeNext=!1,this.suppressAnimation=!1,this.animationThreadCount=0}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>this.gridBodyCtrl=e.gridBodyCtrl)}isActive(){return this.active&&!this.suppressAnimation}setSuppressAnimation(e){this.suppressAnimation=e}start(){if(this.active)return;let{gos:e}=this;e.get("suppressColumnMoveAnimation")||e.get("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0,this.activeNext=!0)}finish(){this.active&&this.flush(()=>this.activeNext=!1,()=>this.active=!1)}executeNextVMTurn(e){this.activeNext?this.executeNextFuncs.push(e):e()}executeLaterVMTurn(e){this.active?this.executeLaterFuncs.push(e):e()}ensureAnimationCssClassPresent(){this.animationThreadCount++;let e=this.animationThreadCount,{gridBodyCtrl:t}=this;t.setColumnMovingCss(!0),this.executeLaterFuncs.push(()=>{this.animationThreadCount===e&&t.setColumnMovingCss(!1)})}flush(e,t){let{executeNextFuncs:i,executeLaterFuncs:n}=this;if(i.length===0&&n.length===0){e(),t();return}let o=r=>{for(;r.length;){let s=r.pop();s&&s()}};this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e(),o(i)},0),window.setTimeout(()=>{t(),o(n)},200)})}};function hV(e,t,i){e.colMoves?.moveColumnByIndex(t,i,"api")}function pV(e,t,i){e.colMoves?.moveColumns(t,i,"api")}var gV=class extends A{constructor(e){super(),this.pinned=e,this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[]}onDragEnter(e){if(this.clearColumnsList(),this.gos.get("functionsReadOnly"))return;let t=e.dragItem.columns;if(t)for(let i of t)i.isPrimary()&&(i.isAnyFunctionActive()||(i.isAllowValue()?this.columnsToAggregate.push(i):i.isAllowRowGroup()?this.columnsToGroup.push(i):i.isAllowPivot()&&this.columnsToPivot.push(i)))}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?"pinned":"move":null}onDragLeave(e){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(e){}onDragStop(e){let{valueColsSvc:t,rowGroupColsSvc:i,pivotColsSvc:n}=this.beans;this.columnsToAggregate.length>0&&t?.addColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&i?.addColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&n?.addColumns(this.columnsToPivot,"toolPanelDragAndDrop")}onDragCancel(){this.clearColumnsList()}};function fV(e,t){!t||t.length<=1||t.filter(n=>e.indexOf(n)<0).length>0||t.sort((n,o)=>{let r=e.indexOf(n),s=e.indexOf(o);return r-s})}function mV(e){let t=[...e];for(let i of e){let n=null,o=i.getParent();for(;o!=null&&o.getDisplayedLeafColumns().length===1;)n=o,o=o.getParent();if(n!=null){let s=!!n.getColGroupDef()?.marryChildren?n.getProvidedColumnGroup().getLeafColumns():n.getLeafColumns();for(let a of s)t.includes(a)||t.push(a)}}return t}function vV(e,t,i,n){let o=n.allCols,r=null,s=null;for(let a=0;a<e.length;a++){let l=e[a],c=i.getProposedColumnOrder(t,l);if(!i.doesOrderPassRules(c))continue;let d=c.filter(h=>o.includes(h));if(s===null)s=d;else if(!ns(d,s))break;let u=wV(c);(r===null||u<r.fragCount)&&(r={move:l,fragCount:u})}return r}function KP(e){let{isFromHeader:t,fromLeft:i,xPosition:n,fromEnter:o,fakeEvent:r,pinned:s,gos:a,colModel:l,colMoves:c,visibleCols:d}=e,{allMovingColumns:u}=e;t&&(u=mV(u));let h=u.slice();fV(l.getCols(),h);let p=yV({movingCols:h,draggingRight:i,xPosition:n,pinned:s,gos:a,colModel:l,visibleCols:d}),g=CV(h,l);if(p.length===0)return;let f=p[0];if(g!==null&&(t||!o)&&!r&&(!i&&f>=g||i&&f<=g))return;let v=vV(p,h,c,d);if(!v)return;let C=v.move;if(!(C>l.getCols().length-h.length))return{columns:h,toIndex:C}}function YP(e){let{columns:t,toIndex:i}=KP(e)||{},{finished:n,colMoves:o}=e;return!t||i==null?null:(o.moveColumns(t,i,"uiColumnMoved",n),n?null:{columns:t,toIndex:i})}function CV(e,t){let i=t.getCols(),n=e.map(l=>i.indexOf(l)).sort((l,c)=>l-c),o=n[0];return rt(n)-o!==n.length-1?null:o}function wV(e){function t(n){let o=[],r=n.getOriginalParent();for(;r!=null;)o.push(r),r=r.getOriginalParent();return o}let i=0;for(let n=0;n<e.length-1;n++){let o=t(e[n]),r=t(e[n+1]);[o,r]=o.length>r.length?[o,r]:[r,o];for(let s of o)r.indexOf(s)===-1&&i++}return i}function bV(e,t){switch(t){case"left":return e.leftCols;case"right":return e.rightCols;default:return e.centerCols}}function yV(e){let{movingCols:t,draggingRight:i,xPosition:n,pinned:o,gos:r,colModel:s,visibleCols:a}=e;if(r.get("suppressMovableColumns")||t.some(w=>w.getColDef().suppressMovable))return[];let c=bV(a,o),d=s.getCols(),u=c.filter(w=>t.includes(w)),h=c.filter(w=>!t.includes(w)),p=d.filter(w=>!t.includes(w)),g=0,f=n;if(i){let w=0;for(let y of u)w+=y.getActualWidth();f-=w}if(f>0){for(let w=0;w<h.length;w++){let y=h[w];if(f-=y.getActualWidth(),f<0)break;g++}i&&g++}let m;if(g>0){let w=h[g-1];m=p.indexOf(w)+1}else m=p.indexOf(h[0]),m===-1&&(m=0);let v=[m],C=(w,y)=>w-y;if(i){let w=m+1,y=d.length-1;for(;w<=y;)v.push(w),w++;v.sort(C)}else{let w=m,y=d.length-1,_=d[w];for(;w<=y&&c.indexOf(_)<0;)w++,v.push(w),_=d[w];w=m-1;let R=0;for(;w>=R;)v.push(w),w--;v.sort(C).reverse()}return v}function AC(e){let{pinned:t,fromKeyboard:i,gos:n,ctrlsSvc:o,useHeaderRow:r,skipScrollPadding:s}=e,a=o.getHeaderRowContainerCtrl(t)?.eViewport,{x:l}=e;return a?(i&&(l-=a.getBoundingClientRect().left),n.get("enableRtl")&&(r&&(a=a.querySelector(".ag-header-row")),l=a.clientWidth-l),t==null&&!s&&(l+=o.get("center").getCenterViewportScrollLeft()),l):0}function Zv(e,t){for(let i of e)i.moving=t,i.dispatchColEvent("movingChanged","uiColumnMoved")}var C_=7,LC=100,pp=LC/2,SV=5,xV=100,EV=class extends A{constructor(e){super(),this.pinned=e,this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.isCenterContainer=!ie(e)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}getIconName(){let{pinned:e,lastDraggingEvent:t}=this,{dragItem:i}=t||{},n=i?.columns??[];for(let o of n){let r=o.getPinned();if(o.getColDef().lockPinned){if(r==e)return"move";continue}let s=i?.containerType;if(s===e||!e)return"move";if(e&&(!r||s!==e))return"pinned"}return"notAllowed"}onDragEnter(e){let t=e.dragItem,i=t.columns;if(e.dragSource.type===0)this.setColumnsVisible(i,!0,"uiColumnDragged");else{let o=t.visibleState,r=(i||[]).filter(s=>o[s.getId()]&&!s.isVisible());this.setColumnsVisible(r,!0,"uiColumnDragged")}this.gos.get("suppressMoveWhenColumnDragging")||this.attemptToPinColumns(i,this.pinned),this.onDragging(e,!0,!0)}onDragging(e=this.lastDraggingEvent,t=!1,i=!1,n=!1){let{gos:o,ctrlsSvc:r}=this.beans,s=o.get("suppressMoveWhenColumnDragging");if(n&&!s){this.finishColumnMoving();return}if(this.lastDraggingEvent=e,!e||!n&&mt(e.hDirection))return;let a=AC({x:e.x,pinned:this.pinned,gos:o,ctrlsSvc:r});t||this.checkCenterForScrolling(a),s?this.handleColumnDragWhileSuppressingMovement(e,t,i,a,n):this.handleColumnDragWhileAllowingMovement(e,t,i,a,n)}onDragLeave(){this.ensureIntervalCleared(),this.clearHighlighted(),this.updateDragItemContainerType(),this.lastMovedInfo=null}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}onDragCancel(){this.clearHighlighted(),this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(e,t,i){if(!e?.length)return;let n=e.filter(o=>!o.getColDef().lockVisible);n.length&&this.beans.colModel.setColsVisible(n,t,i)}finishColumnMoving(){this.clearHighlighted();let e=this.lastMovedInfo;if(!e)return;let{columns:t,toIndex:i}=e;this.beans.colMoves.moveColumns(t,i,"uiColumnMoved",!0)}updateDragItemContainerType(){let{lastDraggingEvent:e}=this;if(this.gos.get("suppressMoveWhenColumnDragging")||!e)return;let t=e.dragItem;t&&(t.containerType=this.pinned)}handleColumnDragWhileSuppressingMovement(e,t,i,n,o){let r=this.getAllMovingColumns(e,!0);if(o){let s=this.isAttemptingToPin(r);s&&this.attemptToPinColumns(r,void 0,!0);let{fromLeft:a,xPosition:l}=this.getNormalisedXPositionInfo(r,s)||{};if(a==null||l==null){this.finishColumnMoving();return}this.moveColumnsAfterHighlight({allMovingColumns:r,xPosition:l,fromEnter:t,fakeEvent:i,fromLeft:a})}else{if(!this.beans.dragAndDrop.isDropZoneWithinThisGrid(e))return;this.highlightHoveredColumn(r,n)}}handleColumnDragWhileAllowingMovement(e,t,i,n,o){let r=this.getAllMovingColumns(e),s=this.normaliseDirection(e.hDirection)==="right",a=e.dragSource.type===1,l=this.getMoveColumnParams({allMovingColumns:r,isFromHeader:a,xPosition:n,fromLeft:s,fromEnter:t,fakeEvent:i}),c=YP(z(b({},l),{finished:o}));c&&(this.lastMovedInfo=c)}getAllMovingColumns(e,t=!1){let i=e.dragSource.getDragItem(),n=null;t?(n=i.columnsInSplit,n||(n=i.columns)):n=i.columns;let o=r=>r.getColDef().lockPinned?r.getPinned()==this.pinned:!0;return n?n.filter(o):[]}getMoveColumnParams(e){let{allMovingColumns:t,isFromHeader:i,xPosition:n,fromLeft:o,fromEnter:r,fakeEvent:s}=e,{gos:a,colModel:l,colMoves:c,visibleCols:d}=this.beans;return{allMovingColumns:t,isFromHeader:i,fromLeft:o,xPosition:n,pinned:this.pinned,fromEnter:r,fakeEvent:s,gos:a,colModel:l,colMoves:c,visibleCols:d}}highlightHoveredColumn(e,t){let{gos:i,colModel:n}=this.beans,o=i.get("enableRtl"),r=n.getCols().filter(d=>d.isVisible()&&d.getPinned()===this.pinned),s=null,a=null,l=null;for(let d of r){if(a=d.getActualWidth(),s=this.getNormalisedColumnLeft(d,0,o),s!=null){let u=s+a;if(s<=t&&u>=t){l=d;break}}s=null,a=null}if(l)e.indexOf(l)!==-1&&(l=null);else{for(let d=r.length-1;d>=0;d--){let u=r[d],h=r[d].getParent();if(!h){l=u;break}let p=h?.getDisplayedLeafColumns();if(p.length){l=rt(p);break}}if(!l)return;s=this.getNormalisedColumnLeft(l,0,o),a=l.getActualWidth()}if(this.lastHighlightedColumn?.column!==l&&this.clearHighlighted(),l==null||s==null||a==null)return;let c;t-s<a/2!==o?c=0:c=1,w_(l,c),this.lastHighlightedColumn={column:l,position:c}}getNormalisedXPositionInfo(e,t){let{gos:i,visibleCols:n}=this.beans,o=i.get("enableRtl"),{firstMovingCol:r,column:s,position:a}=this.getColumnMoveAndTargetInfo(e,t,o);if(!r||!s||a==null)return;let l=n.allCols,c=l.indexOf(r),d=l.indexOf(s),u=a===0!==o,h=c<d||c===d&&!u,p=0;if(u?h&&(p-=1):h||(p+=1),d+p===c)return;let g=l[d+p];if(!g)return;let f=this.getNormalisedColumnLeft(g,20,o);return{fromLeft:h,xPosition:f}}getColumnMoveAndTargetInfo(e,t,i){let n=this.lastHighlightedColumn||{},{firstMovingCol:o,lastMovingCol:r}=_V(e);if(!o||!r||n.column||!t)return b({firstMovingCol:o},n);let a=this.getPinDirection()==="left";return{firstMovingCol:o,position:a?1:0,column:a!==i?o:r}}normaliseDirection(e){if(this.gos.get("enableRtl"))switch(e){case"left":return"right";case"right":return"left"}return e}getNormalisedColumnLeft(e,t,i){let{gos:n,ctrlsSvc:o}=this.beans,r=e.getLeft();if(r==null)return null;let s=e.getActualWidth();return AC({x:i?r+s-t:r+t,pinned:e.getPinned(),useHeaderRow:i,skipScrollPadding:!0,gos:n,ctrlsSvc:o})}isAttemptingToPin(e){let t=this.needToMoveLeft||this.needToMoveRight,i=this.failedMoveAttempts>C_;return t&&i||e.some(n=>n.getPinned()!==this.pinned)}moveColumnsAfterHighlight(e){let{allMovingColumns:t,xPosition:i,fromEnter:n,fakeEvent:o,fromLeft:r}=e,s=this.getMoveColumnParams({allMovingColumns:t,isFromHeader:!0,xPosition:i,fromLeft:r,fromEnter:n,fakeEvent:o}),{columns:a,toIndex:l}=KP(s)||{};a&&l!=null&&(this.lastMovedInfo={columns:a,toIndex:l}),this.finishColumnMoving()}clearHighlighted(){let{lastHighlightedColumn:e}=this;e&&(w_(e.column,null),this.lastHighlightedColumn=null)}checkCenterForScrolling(e){if(!this.isCenterContainer)return;let t=this.beans.ctrlsSvc.get("center"),i=t.getCenterViewportScrollLeft(),n=i+t.getCenterWidth(),o,r;this.gos.get("enableRtl")?(o=e<i+pp,r=e>n-pp):(r=e<i+pp,o=e>n-pp),this.needToMoveRight=o,this.needToMoveLeft=r,r||o?this.ensureIntervalStarted():this.ensureIntervalCleared()}ensureIntervalStarted(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),xV),this.beans.dragAndDrop.setDragImageCompIcon(this.needToMoveLeft?"left":"right",!0))}ensureIntervalCleared(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.failedMoveAttempts=0,this.beans.dragAndDrop.setDragImageCompIcon(this.getIconName()))}moveInterval(){let e;this.intervalCount++,e=10+this.intervalCount*SV,e>LC&&(e=LC);let t=null,i=this.gridBodyCon.scrollFeature;if(this.needToMoveLeft?t=i.scrollHorizontally(-e):this.needToMoveRight&&(t=i.scrollHorizontally(e)),t!==0)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;let{pinnedCols:n,dragAndDrop:o,gos:r}=this.beans;if(this.failedMoveAttempts<=C_+1||!n)return;if(o.setDragImageCompIcon("pinned"),!r.get("suppressMoveWhenColumnDragging")){let s=this.lastDraggingEvent?.dragItem.columns;this.attemptToPinColumns(s,void 0,!0)}}}getPinDirection(){if(this.needToMoveLeft||this.pinned==="left")return"left";if(this.needToMoveRight||this.pinned==="right")return"right"}attemptToPinColumns(e,t,i=!1){let n=(e||[]).filter(s=>!s.getColDef().lockPinned);if(!n.length)return 0;i&&(t=this.getPinDirection());let{pinnedCols:o,dragAndDrop:r}=this.beans;return o?.setColsPinned(n,t,"uiColumnDragged"),i&&r.nudge(),n.length}destroy(){super.destroy(),this.lastDraggingEvent=null,this.clearHighlighted(),this.lastMovedInfo=null}};function w_(e,t){e.highlighted!==t&&(e.highlighted=t,e.dispatchColEvent("headerHighlightChanged","uiColumnMoved"))}function _V(e){let t=e.length,i,n;for(let o=0;o<t;o++){if(!i){let r=e[o];r.getLeft()!=null&&(i=r)}if(!n){let r=e[t-1-o];r.getLeft()!=null&&(n=r)}if(i&&n)break}return{firstMovingCol:i,lastMovingCol:n}}var RV=class extends A{constructor(e,t){super(),this.pinned=e,this.eContainer=t}postConstruct(){let{ctrlsSvc:e,dragAndDrop:t}=this.beans,i=this.pinned;e.whenReady(this,n=>{let o,r=n.gridBodyCtrl.eBodyViewport;switch(i){case"left":o=[[r,n.left.eContainer],[n.bottomLeft.eContainer],[n.topLeft.eContainer]];break;case"right":o=[[r,n.right.eContainer],[n.bottomRight.eContainer],[n.topRight.eContainer]];break;default:o=[[r,n.center.eViewport],[n.bottomCenter.eViewport],[n.topCenter.eViewport]];break}this.eSecondaryContainers=o}),this.moveColumnFeature=this.createManagedBean(new EV(i)),this.bodyDropPivotTarget=this.createManagedBean(new gV(i)),t.addDropTarget(this),this.addDestroyFunc(()=>t.removeDropTarget(this))}isInterestedIn(e){return e===1||e===0&&this.gos.get("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(e){return this.beans.colModel.isPivotMode()&&e.dragSource.type===0}onDragEnter(e){this.currentDropListener=this.isDropColumnInPivotMode(e)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(e)}onDragLeave(e){this.currentDropListener.onDragLeave(e)}onDragging(e){this.currentDropListener.onDragging(e)}onDragStop(e){this.currentDropListener.onDragStop(e)}onDragCancel(){this.currentDropListener.onDragCancel()}},PV=class extends A{constructor(){super(...arguments),this.beanName="colMoves"}moveColumnByIndex(e,t,i){let n=this.beans.colModel.getCols();if(!n)return;let o=n[e];this.moveColumns([o],t,i)}moveColumns(e,t,i,n=!0){let{colModel:o,colAnimation:r,visibleCols:s,eventSvc:a}=this.beans,l=o.getCols();if(!l)return;if(t>l.length-e.length){W(30,{toIndex:t});return}r?.start();let c=o.getColsForKeys(e);this.doesMovePassRules(c,t)&&(NE(o.getCols(),c,t),s.refresh(i),a.dispatchEvent({type:"columnMoved",columns:c,column:c.length===1?c[0]:null,toIndex:t,finished:n,source:i})),r?.finish()}doesMovePassRules(e,t){let i=this.getProposedColumnOrder(e,t);return this.doesOrderPassRules(i)}doesOrderPassRules(e){let{colModel:t,gos:i}=this.beans;return!(!GR(e,t.getColTree())||!(o=>{let r=c=>c?c==="left"||c===!0?-1:1:0,s=i.get("enableRtl"),a=s?1:-1,l=!0;for(let c of o){let d=r(c.getColDef().lockPosition);s?d>a&&(l=!1):d<a&&(l=!1),a=d}return l})(e))}getProposedColumnOrder(e,t){let n=this.beans.colModel.getCols().slice();return NE(n,e,t),n}createBodyDropTarget(e,t){return new RV(e,t)}moveHeader(e,t,i,n,o){let{ctrlsSvc:r,gos:s,colModel:a,visibleCols:l,focusSvc:c}=this.beans,d=t.getBoundingClientRect(),u=d.left,h=kt(i),p=h?d.width:i.getActualWidth(),g=e==="left"!==s.get("enableRtl"),f=AC({x:g?u-20:u+p+20,pinned:n,fromKeyboard:!0,gos:s,ctrlsSvc:r}),m=c.focusedHeader;YP({allMovingColumns:h?i.getLeafColumns():[i],isFromHeader:!0,fromLeft:e==="right",xPosition:f,pinned:n,fromEnter:!1,fakeEvent:!1,gos:s,colModel:a,colMoves:this,visibleCols:l,finished:!0});let v;if(h){let C=i.getDisplayedLeafColumns();v=g?C[0]:rt(C)}else v=i;if(r.getScrollFeature().ensureColumnVisible(v,"auto"),(!o.isAlive()||s.get("ensureDomOrder"))&&m){let C;if(h){let w=i.getGroupId(),y=i.getLeafColumns();if(!y.length)return;let _=y[0].getParent();if(!_)return;C=DV(_,w)}else C=i;C&&c.focusHeaderPosition({headerPosition:z(b({},m),{column:C})})}}setDragSourceForHeader(e,t,i){let{gos:n,colModel:o,dragAndDrop:r,visibleCols:s}=this.beans,a=!n.get("suppressDragLeaveHidesColumns"),l=kt(t),c=l?t.getProvidedColumnGroup().getLeafColumns():[t],u={type:1,eElement:e,getDefaultIconName:()=>a?"hide":"notAllowed",getDragItem:l?()=>kV(t,s.allCols):()=>MV(t),dragItemName:i,onDragStarted:()=>{a=!n.get("suppressDragLeaveHidesColumns"),Zv(c,!0)},onDragStopped:()=>Zv(c,!1),onDragCancelled:()=>Zv(c,!1),onGridEnter:h=>{if(a){let{columns:p=[],visibleState:g}=h??{},f=l?v=>!g||g[v.getColId()]:()=>!0,m=p.filter(v=>!v.getColDef().lockVisible&&f(v));o.setColsVisible(m,!0,"uiColumnMoved")}},onGridExit:h=>{if(a){let p=h?.columns?.filter(g=>!g.getColDef().lockVisible)||[];o.setColsVisible(p,!1,"uiColumnMoved")}}};return r.addDragSource(u,!0),u}};function DV(e,t){for(;e;){if(e.getGroupId()===t)return e;e=e.getParent()}}function MV(e){let t={};return t[e.getId()]=e.isVisible(),{columns:[e],visibleState:t,containerType:e.pinned}}function kV(e,t){let i=e.getProvidedColumnGroup().getLeafColumns(),n={};for(let a of i)n[a.getId()]=a.isVisible();let o=[];for(let a of t)i.indexOf(a)>=0&&(o.push(a),Hn(i,a));for(let a of i)o.push(a);let r=[],s=e.getLeafColumns();for(let a of o)s.indexOf(a)!==-1&&r.push(a);return{columns:o,columnsInSplit:r,visibleState:n,containerType:r[0]?.pinned}}var TV={moduleName:"ColumnMove",version:ee,beans:[PV,uV],apiFunctions:{moveColumnByIndex:hV,moveColumns:pV},dependsOn:[jP],css:[dV]},FV=class extends A{constructor(){super(...arguments),this.beanName="autoWidthCalc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.centerRowContainerCtrl=e.center})}getPreferredWidthForColumn(e,t){let i=this.getHeaderCellForColumn(e);if(!i)return-1;let n=this.beans.rowRenderer.getAllCellsNotSpanningForColumn(e);return t||n.push(i),this.getPreferredWidthForElements(n)}getPreferredWidthForColumnGroup(e){let t=this.getHeaderCellForColumn(e);return t?this.getPreferredWidthForElements([t]):-1}getPreferredWidthForElements(e,t){let i=document.createElement("form");i.style.position="fixed";let n=this.centerRowContainerCtrl.eContainer;for(let r of e)this.cloneItemIntoDummy(r,i);n.appendChild(i);let o=i.offsetWidth;return i.remove(),t=t??this.gos.get("autoSizePadding"),o+t}getHeaderCellForColumn(e){let t=null;for(let i of this.beans.ctrlsSvc.getHeaderRowContainerCtrls()){let n=i.getHtmlElementForColumnHeader(e);n!=null&&(t=n)}return t}cloneItemIntoDummy(e,t){let i=e.cloneNode(!0);i.style.width="",i.style.position="static",i.style.left="";let n=document.createElement("div"),o=n.classList;["ag-header-cell","ag-header-group-cell"].some(a=>i.classList.contains(a))?(o.add("ag-header","ag-header-row"),n.style.position="static"):o.add("ag-row");let s=e.parentElement;for(;s;){if(["ag-header-row","ag-row"].some(l=>s.classList.contains(l))){for(let l=0;l<s.classList.length;l++){let c=s.classList[l];c!="ag-row-position-absolute"&&o.add(c)}break}s=s.parentElement}n.appendChild(i),t.appendChild(n)}},XP={moduleName:"AutoWidth",version:ee,beans:[FV]};function IV(e,t,i=!0,n="api"){e.colResize?.setColumnWidths(t,!1,i,n)}var AV=class extends A{constructor(e,t,i,n){super(),this.comp=e,this.eResize=t,this.pinned=i,this.columnGroup=n}postConstruct(){if(!this.columnGroup.isResizable()){this.comp.setResizableDisplayed(!1);return}let{horizontalResizeSvc:e,gos:t,colAutosize:i}=this.beans,n=e.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});this.addDestroyFunc(n),!t.get("suppressAutoSize")&&i&&this.addDestroyFunc(i.addColumnGroupResize(this.eResize,this.columnGroup,()=>this.resizeLeafColumnsToFit("uiColumnResized")))}onResizeStart(e){let{columnsToResize:t,resizeStartWidth:i,resizeRatios:n,groupAfterColumns:o,groupAfterStartWidth:r,groupAfterRatios:s}=this.getInitialValues(e);this.resizeCols=t,this.resizeStartWidth=i,this.resizeRatios=n,this.resizeTakeFromCols=o,this.resizeTakeFromStartWidth=r,this.resizeTakeFromRatios=s,this.toggleColumnResizing(!0)}onResizing(e,t,i="uiColumnResized"){let n=this.normaliseDragChange(t),o=this.resizeStartWidth+n;this.resizeColumnsFromLocalValues(o,i,e)}getInitialValues(e){let t=l=>l.reduce((c,d)=>c+d.getActualWidth(),0),i=(l,c)=>l.map(d=>d.getActualWidth()/c),n=this.getColumnsToResize(),o=t(n),r=i(n,o),s={columnsToResize:n,resizeStartWidth:o,resizeRatios:r},a=null;if(e&&(a=this.beans.colGroupSvc?.getGroupAtDirection(this.columnGroup,"After")??null),a){let l=a.getDisplayedLeafColumns(),c=s.groupAfterColumns=l.filter(u=>u.isResizable()),d=s.groupAfterStartWidth=t(c);s.groupAfterRatios=i(c,d)}else s.groupAfterColumns=void 0,s.groupAfterStartWidth=void 0,s.groupAfterRatios=void 0;return s}resizeLeafColumnsToFit(e){let t=this.beans.autoWidthCalc.getPreferredWidthForColumnGroup(this.columnGroup),i=this.getInitialValues();t>i.resizeStartWidth&&this.resizeColumns(i,t,e,!0)}resizeColumnsFromLocalValues(e,t,i=!0){if(!this.resizeCols||!this.resizeRatios)return;let n={columnsToResize:this.resizeCols,resizeStartWidth:this.resizeStartWidth,resizeRatios:this.resizeRatios,groupAfterColumns:this.resizeTakeFromCols,groupAfterStartWidth:this.resizeTakeFromStartWidth,groupAfterRatios:this.resizeTakeFromRatios};this.resizeColumns(n,e,t,i)}resizeColumns(e,t,i,n=!0){let{columnsToResize:o,resizeStartWidth:r,resizeRatios:s,groupAfterColumns:a,groupAfterStartWidth:l,groupAfterRatios:c}=e,d=[];if(d.push({columns:o,ratios:s,width:t}),a){let u=t-r;d.push({columns:a,ratios:c,width:l-u})}this.beans.colResize?.resizeColumnSets({resizeSets:d,finished:n,source:i}),n&&this.toggleColumnResizing(!1)}toggleColumnResizing(e){this.comp.toggleCss("ag-column-resizing",e)}getColumnsToResize(){return this.columnGroup.getDisplayedLeafColumns().filter(t=>t.isResizable())}normaliseDragChange(e){let t=e;return this.gos.get("enableRtl")?this.pinned!=="left"&&(t*=-1):this.pinned==="right"&&(t*=-1),t}destroy(){super.destroy(),this.resizeCols=void 0,this.resizeRatios=void 0,this.resizeTakeFromCols=void 0,this.resizeTakeFromRatios=void 0}},LV=class extends A{constructor(e,t,i,n,o){super(),this.pinned=e,this.column=t,this.eResize=i,this.comp=n,this.ctrl=o}postConstruct(){let e=[],t,i,n=()=>{if(ft(this.eResize,t),!t)return;let{horizontalResizeSvc:s,colAutosize:a}=this.beans,l=s.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});e.push(l),i&&a&&e.push(a.addColumnAutosizeListeners(this.eResize,this.column))},o=()=>{for(let s of e)s();e.length=0},r=()=>{let s=this.column.isResizable(),a=!this.gos.get("suppressAutoSize")&&!this.column.getColDef().suppressAutoSize;(s!==t||a!==i)&&(t=s,i=a,o(),n())};r(),this.addDestroyFunc(o),this.ctrl.setRefreshFunction("resize",r)}onResizing(e,t){let{column:i,lastResizeAmount:n,resizeStartWidth:o,beans:r}=this,s=this.normaliseResizeAmount(t),a=o+s,l=[{key:i,newWidth:a}],{pinnedCols:c,ctrlsSvc:d,colResize:u}=r;if(this.column.getPinned()){let h=c?.leftWidth??0,p=c?.rightWidth??0,g=fd(d.getGridBodyCtrl().eBodyViewport)-50;if(h+p+(s-n)>g)return}this.lastResizeAmount=s,u?.setColumnWidths(l,this.resizeWithShiftKey,e,"uiColumnResized"),e&&this.toggleColumnResizing(!1)}onResizeStart(e){this.resizeStartWidth=this.column.getActualWidth(),this.lastResizeAmount=0,this.resizeWithShiftKey=e,this.toggleColumnResizing(!0)}toggleColumnResizing(e){this.column.resizing=e,this.comp.toggleCss("ag-column-resizing",e)}normaliseResizeAmount(e){let t=e,i=this.pinned!=="left",n=this.pinned==="right";return this.gos.get("enableRtl")?i&&(t*=-1):n&&(t*=-1),t}},OV=class extends A{constructor(){super(...arguments),this.beanName="colResize"}setColumnWidths(e,t,i,n){let o=[],{colModel:r,gos:s,visibleCols:a}=this.beans;for(let l of e){let c=r.getColDefCol(l.key)||r.getCol(l.key);if(!c)continue;if(o.push({width:l.newWidth,ratios:[1],columns:[c]}),s.get("colResizeDefault")==="shift"&&(t=!t),t){let u=a.getColAfter(c);if(!u)continue;let h=c.getActualWidth()-l.newWidth,p=u.getActualWidth()+h;o.push({width:p,ratios:[1],columns:[u]})}}o.length!==0&&this.resizeColumnSets({resizeSets:o,finished:i,source:n})}resizeColumnSets(e){let{resizeSets:t,finished:i,source:n}=e;if(!(!t||t.every(d=>NV(d)))){if(i){let d=t&&t.length>0?t[0].columns:null;El(this.eventSvc,d,i,n)}return}let r=[],s=[];for(let d of t){let{width:u,columns:h,ratios:p}=d,g={},f={};for(let C of h)s.push(C);let m=!0,v=0;for(;m;){if(v++,v>1e3){tt(31);break}m=!1;let C=[],w=0,y=u;h.forEach((R,P)=>{if(f[R.getId()])y-=g[R.getId()];else{C.push(R);let q=p[P];w+=q}});let _=1/w;C.forEach((R,P)=>{let B=P===C.length-1,q;B?q=y:(q=Math.round(p[P]*u*_),y-=q);let $=R.getMinWidth(),te=R.getMaxWidth();q<$?(q=$,f[R.getId()]=!0,m=!0):te>0&&q>te&&(q=te,f[R.getId()]=!0,m=!0),g[R.getId()]=q})}for(let C of h){let w=g[C.getId()];C.getActualWidth()!==w&&(C.setActualWidth(w,n),r.push(C))}}let a=r.length>0,l=[];if(a){let{colFlex:d,visibleCols:u,colViewport:h}=this.beans;l=d?.refreshFlexedColumns({resizingCols:s,skipSetLeft:!0})??[],u.setLeftValues(n),u.updateBodyWidths(),h.checkViewportColumns()}let c=s.concat(l);(a||i)&&El(this.eventSvc,c,i,n,l)}resizeHeader(e,t,i){if(!e.isResizable())return;let n=e.getActualWidth(),o=e.getMinWidth(),r=e.getMaxWidth(),s=Math.min(Math.max(n+t,o),r);this.setColumnWidths([{key:e,newWidth:s}],i,!0,"uiColumnResized")}createResizeFeature(e,t,i,n,o){return new LV(e,t,i,n,o)}createGroupResizeFeature(e,t,i,n){return new AV(e,t,i,n)}};function NV(e){let{columns:t,width:i}=e,n=0,o=0,r=!0;for(let l of t){let c=l.getMinWidth();n+=c||0;let d=l.getMaxWidth();d>0?o+=d:r=!1}let s=i>=n,a=!r||i<=o;return s&&a}var BV={moduleName:"ColumnResize",version:ee,beans:[OV],apiFunctions:{setColumnWidths:IV},dependsOn:[cV,XP]},HV=class extends A{constructor(e,t){super(),this.removeChildListenersFuncs=[],this.columnGroup=t,this.comp=e}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListeners(this.columnGroup,{displayedChildrenChanged:this.onDisplayedChildrenChanged.bind(this)}),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();let e=this.onWidthChanged.bind(this);for(let t of this.columnGroup.getLeafColumns())t.__addEventListener("widthChanged",e),t.__addEventListener("visibleChanged",e),this.removeChildListenersFuncs.push(()=>{t.__removeEventListener("widthChanged",e),t.__removeEventListener("visibleChanged",e)})}removeListenersOnChildrenColumns(){for(let e of this.removeChildListenersFuncs)e();this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){let e=this.columnGroup.getActualWidth();this.comp.setWidth(`${e}px`),this.comp.toggleCss("ag-hidden",e===0)}},VV=class extends Sw{constructor(){super(...arguments),this.onSuppressColMoveChange=()=>{!this.isAlive()||this.isSuppressMoving()?this.removeDragSource():this.dragSource||this.setDragSource(this.eGui)}}wireComp(e,t,i,n,o){let{column:r,beans:s}=this,{context:a,colNames:l,colHover:c,rangeSvc:d,colResize:u}=s;this.comp=e,o=Pd(this,a,o),this.setGui(t,o),this.displayName=l.getDisplayNameForColumnGroup(r,"header"),this.refreshHeaderStyles(),this.addClasses(),this.setupMovingCss(o),this.setupExpandable(o),this.setupTooltip(),this.setupAutoHeight({wrapperElement:n,compBean:o}),this.setupUserComp(),this.addHeaderMouseListeners(o),this.addManagedPropertyListener("groupHeaderHeight",this.refreshMaxHeaderHeight.bind(this)),this.refreshMaxHeaderHeight();let h=this.rowCtrl.pinned,p=r.getProvidedColumnGroup().getLeafColumns();c?.createHoverFeature(o,p,t),d?.createRangeHighlightFeature(o,r,e),o.createManagedBean(new yw(r,t,s)),o.createManagedBean(new HV(e,r)),u?this.resizeFeature=o.createManagedBean(u.createGroupResizeFeature(e,i,h,r)):e.setResizableDisplayed(!1),o.createManagedBean(new kl(t,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)})),this.addHighlightListeners(o,p),o.addManagedPropertyListener("suppressMovableColumns",this.onSuppressColMoveChange),this.addResizeAndMoveKeyboardListeners(o),o.addDestroyFunc(()=>this.clearComponent())}getHeaderClassParams(){let{column:e,beans:t}=this,i=e.getDefinition();return ye(t.gos,{colDef:i,columnGroup:e,floatingFilter:!1})}refreshMaxHeaderHeight(){let{gos:e,comp:t}=this,i=e.get("groupHeaderHeight");i!=null?i===0?t.setHeaderWrapperHidden(!0):t.setHeaderWrapperMaxHeight(i):(t.setHeaderWrapperHidden(!1),t.setHeaderWrapperMaxHeight(null))}addHighlightListeners(e,t){if(this.beans.gos.get("suppressMoveWhenColumnDragging"))for(let i of t)e.addManagedListeners(i,{headerHighlightChanged:this.onLeafColumnHighlightChanged.bind(this,i)})}onLeafColumnHighlightChanged(e){let t=this.column.getDisplayedLeafColumns(),i=t[0]===e,n=rt(t)===e;if(!i&&!n)return;let o=e.getHighlighted(),r=!!this.rowCtrl.getHeaderCellCtrls().find(l=>l.column.isMoving()),s=!1,a=!1;if(r){let l=this.beans.gos.get("enableRtl"),c=o===1,d=o===0;i&&(l?a=c:s=d),n&&(l?s=d:a=c)}this.comp.toggleCss("ag-header-highlight-before",s),this.comp.toggleCss("ag-header-highlight-after",a)}resizeHeader(e,t){let{resizeFeature:i}=this;if(!i)return;let n=i.getInitialValues(t);i.resizeColumns(n,n.resizeStartWidth+e,"uiColumnResized",!0)}resizeLeafColumnsToFit(e){this.resizeFeature?.resizeLeafColumnsToFit(e)}setupUserComp(){let{colGroupSvc:e,userCompFactory:t,gos:i,enterpriseMenuFactory:n}=this.beans,o=this.column,r=o.getProvidedColumnGroup(),s=ye(i,{displayName:this.displayName,columnGroup:o,setExpanded:l=>{e.setColumnGroupOpened(r,l,"gridInitializing")},setTooltip:(l,c)=>{i.assertModuleRegistered("Tooltip",3),this.setupTooltip(l,c)},showColumnMenu:(l,c)=>n?.showMenuAfterButtonClick(r,l,"columnMenu",c),showColumnMenuAfterMouseClick:(l,c)=>n?.showMenuAfterMouseEvent(r,l,"columnMenu",c),eGridHeader:this.eGui}),a=kO(t,s);a&&this.comp.setUserCompDetails(a)}addHeaderMouseListeners(e){let t=o=>this.handleMouseOverChange(o.type==="mouseenter"),i=()=>this.dispatchColumnMouseEvent("columnHeaderClicked",this.column.getProvidedColumnGroup()),n=o=>this.handleContextMenuMouseEvent(o,void 0,this.column.getProvidedColumnGroup());e.addManagedListeners(this.eGui,{mouseenter:t,mouseleave:t,click:i,contextmenu:n})}handleMouseOverChange(e){this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column.getProvidedColumnGroup()})}setupTooltip(e,t){this.tooltipFeature=this.beans.tooltipSvc?.setupHeaderGroupTooltip(this.tooltipFeature,this,e,t)}setupExpandable(e){let t=this.column.getProvidedColumnGroup();this.refreshExpanded();let i=this.refreshExpanded.bind(this);e.addManagedListeners(t,{expandedChanged:i,expandableChanged:i})}refreshExpanded(){let{column:e}=this;this.expandable=e.isExpandable();let t=e.isExpanded();this.expandable?this.comp.setAriaExpanded(t?"true":"false"):this.comp.setAriaExpanded(void 0),this.refreshHeaderStyles()}addClasses(){let{column:e}=this,t=e.getColGroupDef(),i=IP(t,this.gos,null,e);e.isPadding()?(i.push("ag-header-group-cell-no-group"),e.getLeafColumns().every(o=>o.isSpanHeaderHeight())&&i.push("ag-header-span-height")):(i.push("ag-header-group-cell-with-group"),t?.wrapHeaderText&&i.push("ag-header-cell-wrap-text"));for(let n of i)this.comp.toggleCss(n,!0)}setupMovingCss(e){let{column:t}=this,n=t.getProvidedColumnGroup().getLeafColumns(),o=()=>this.comp.toggleCss("ag-header-cell-moving",t.isMoving());for(let r of n)e.addManagedListeners(r,{movingChanged:o});o()}onFocusIn(e){this.eGui.contains(e.relatedTarget)||this.focusThis()}handleKeyDown(e){super.handleKeyDown(e);let t=this.getWrapperHasFocus();if(!(!this.expandable||!t)&&e.key===T.ENTER){let i=this.column,n=!i.isExpanded();this.beans.colGroupSvc.setColumnGroupOpened(i.getProvidedColumnGroup(),n,"uiColumnExpanded")}}setDragSource(e){!this.isAlive()||this.isSuppressMoving()||(this.removeDragSource(),e&&(this.dragSource=this.beans.colMoves?.setDragSourceForHeader(e,this.column,this.displayName)??null))}isSuppressMoving(){return this.gos.get("suppressMovableColumns")||this.column.getLeafColumns().some(e=>e.getColDef().suppressMovable||e.getColDef().lockPosition)}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function GV(e,t,i){e.colGroupSvc?.setColumnGroupOpened(t,i,"api")}function zV(e,t,i){return e.colGroupSvc?.getColumnGroup(t,i)??null}function WV(e,t){return e.colGroupSvc?.getProvidedColGroup(t)??null}function UV(e,t,i){return e.colNames.getDisplayNameForColumnGroup(t,i)||""}function qV(e){return e.colGroupSvc?.getColumnGroupState()??[]}function $V(e,t){e.colGroupSvc?.setColumnGroupState(t,"api")}function jV(e){e.colGroupSvc?.resetColumnGroupState("api")}function KV(e){return e.visibleCols.treeLeft}function YV(e){return e.visibleCols.treeCenter}function XV(e){return e.visibleCols.treeRight}function JV(e){return e.visibleCols.getAllTrees()}function QV(e,t){for(let i=0;i<t.length;i++){let n=e.indexOf(t[i]);n>=0&&(e[n]=e[e.length-1],e.pop())}}var ZV=class extends A{constructor(){super(...arguments),this.beanName="visibleCols",this.colsAndGroupsMap={},this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.headerGroupRowCount=0,this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.isBodyWidthDirty=!0}refresh(e,t=!1){let{colFlex:i,colModel:n,colGroupSvc:o,colViewport:r,selectionColSvc:s}=this.beans;t||this.buildTrees(n,o),o?.updateOpenClosedVisibility(),this.leftCols=eC(this.treeLeft),this.centerCols=eC(this.treeCenter),this.rightCols=eC(this.treeRight),s?.refreshVisibility(this.leftCols,this.centerCols,this.rightCols),this.joinColsAriaOrder(n),this.joinCols(),this.headerGroupRowCount=this.getHeaderRowCount(),this.setLeftValues(e),this.autoHeightCols=this.allCols.filter(a=>a.isAutoHeight()),i?.refreshFlexedColumns(),this.updateBodyWidths(),this.setFirstRightAndLastLeftPinned(n,this.leftCols,this.rightCols,e),r.checkViewportColumns(!1),this.eventSvc.dispatchEvent({type:"displayedColumnsChanged",source:e})}getHeaderRowCount(){if(!this.gos.get("hidePaddedHeaderRows"))return this.beans.colModel.cols.treeDepth;let e=0;for(let t of this.allCols){let i=t.getParent();for(;i;){if(!i.isPadding()){let n=i.getProvidedColumnGroup().getLevel()+1;n>e&&(e=n);break}i=i.getParent()}}return e}updateBodyWidths(){let e=tr(this.centerCols),t=tr(this.leftCols),i=tr(this.rightCols);this.isBodyWidthDirty=this.bodyWidth!==e,(this.bodyWidth!==e||this.leftWidth!==t||this.rightWidth!==i)&&(this.bodyWidth=e,this.leftWidth=t,this.rightWidth=i,this.eventSvc.dispatchEvent({type:"columnContainerWidthChanged"}),this.eventSvc.dispatchEvent({type:"displayedColumnsWidthChanged"}))}setLeftValues(e){this.setLeftValuesOfCols(e),this.setLeftValuesOfGroups()}setFirstRightAndLastLeftPinned(e,t,i,n){let o,r;this.gos.get("enableRtl")?(o=t?t[0]:null,r=i?rt(i):null):(o=t?rt(t):null,r=i?i[0]:null);for(let s of e.getCols())s.setLastLeftPinned(s===o,n),s.setFirstRightPinned(s===r,n)}buildTrees(e,t){let i=e.getColsToShow(),n=i.filter(l=>l.getPinned()=="left"),o=i.filter(l=>l.getPinned()=="right"),r=i.filter(l=>l.getPinned()!="left"&&l.getPinned()!="right"),s=new $R,a=l=>t?t.createColumnGroups(l):l.columns;this.treeLeft=a({columns:n,idCreator:s,pinned:"left",oldDisplayedGroups:this.treeLeft}),this.treeRight=a({columns:o,idCreator:s,pinned:"right",oldDisplayedGroups:this.treeRight}),this.treeCenter=a({columns:r,idCreator:s,pinned:null,oldDisplayedGroups:this.treeCenter}),this.updateColsAndGroupsMap()}clear(){this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.ariaOrderColumns=[]}joinColsAriaOrder(e){let t=e.getCols(),i=[],n=[],o=[];for(let r of t){let s=r.getPinned();s?s===!0||s==="left"?i.push(r):o.push(r):n.push(r)}this.ariaOrderColumns=i.concat(n).concat(o)}getAriaColIndex(e){let t;return kt(e)?t=e.getLeafColumns()[0]:t=e,this.ariaOrderColumns.indexOf(t)+1}setLeftValuesOfGroups(){for(let e of[this.treeLeft,this.treeRight,this.treeCenter])for(let t of e)kt(t)&&t.checkLeft()}setLeftValuesOfCols(e){let{colModel:t}=this.beans;if(!t.getColDefCols())return;let n=t.getCols().slice(0),o=this.gos.get("enableRtl");for(let r of[this.leftCols,this.rightCols,this.centerCols]){if(o){let s=tr(r);for(let a of r)s-=a.getActualWidth(),a.setLeft(s,e)}else{let s=0;for(let a of r)a.setLeft(s,e),s+=a.getActualWidth()}QV(n,r)}for(let r of n)r.setLeft(null,e)}joinCols(){this.gos.get("enableRtl")?this.allCols=this.rightCols.concat(this.centerCols).concat(this.leftCols):this.allCols=this.leftCols.concat(this.centerCols).concat(this.rightCols)}getAllTrees(){return this.treeLeft&&this.treeRight&&this.treeCenter?this.treeLeft.concat(this.treeCenter).concat(this.treeRight):null}isColDisplayed(e){return this.allCols.indexOf(e)>=0}getLeftColsForRow(e){let{leftCols:t,beans:{colModel:i}}=this;return i.colSpanActive?this.getColsForRow(e,t):t}getRightColsForRow(e){let{rightCols:t,beans:{colModel:i}}=this;return i.colSpanActive?this.getColsForRow(e,t):t}getColsForRow(e,t,i,n){let o=[],r=null;for(let s=0;s<t.length;s++){let a=t[s],l=t.length-s,c=Math.min(a.getColSpan(e),l),d=[a];if(c>1){let h=c-1;for(let p=1;p<=h;p++)d.push(t[s+p]);s+=h}let u;if(i){u=!1;for(let h of d)i(h)&&(u=!0)}else u=!0;u&&(o.length===0&&r&&(n&&n(a))&&o.push(r),o.push(a)),r=a}return o}getContainerWidth(e){switch(e){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}getColBefore(e){let t=this.allCols,i=t.indexOf(e);return i>0?t[i-1]:null}isPinningLeft(){return this.leftCols.length>0}isPinningRight(){return this.rightCols.length>0}updateColsAndGroupsMap(){this.colsAndGroupsMap={};let e=t=>{this.colsAndGroupsMap[t.getUniqueId()]=t};oa(this.treeCenter,!1,e),oa(this.treeLeft,!1,e),oa(this.treeRight,!1,e)}isVisible(e){return this.colsAndGroupsMap[e.getUniqueId()]===e}getFirstColumn(){let e=this.gos.get("enableRtl"),t=["leftCols","centerCols","rightCols"];e&&t.reverse();for(let i=0;i<t.length;i++){let n=this[t[i]];if(n.length)return e?rt(n):n[0]}return null}getColAfter(e){let t=this.allCols,i=t.indexOf(e);return i<t.length-1?t[i+1]:null}getColsLeftWidth(){return tr(this.leftCols)}getDisplayedColumnsRightWidth(){return tr(this.rightCols)}isColAtEdge(e,t){let i=this.allCols;if(!i.length)return!1;let n=t==="first",o;if(kt(e)){let r=e.getDisplayedLeafColumns();if(!r.length)return!1;o=n?r[0]:rt(r)}else o=e;return(n?i[0]:rt(i))===o}};function oa(e,t,i){if(e)for(let n=0;n<e.length;n++){let o=e[n];if(kt(o)){let r=t?o.getDisplayedChildren():o.getChildren();oa(r,t,i)}i(o)}}function eC(e){let t=[];return oa(e,!0,i=>{es(i)&&t.push(i)}),t}var eG=class extends A{constructor(){super(...arguments),this.beanName="colGroupSvc"}getColumnGroupState(){let e=[],t=this.beans.colModel.getColTree();return rr(null,t,i=>{wi(i)&&e.push({groupId:i.getGroupId(),open:i.isExpanded()})}),e}resetColumnGroupState(e){let t=this.beans.colModel.getColDefColTree();if(!t)return;let i=[];rr(null,t,n=>{if(wi(n)){let o=n.getColGroupDef(),r={groupId:n.getGroupId(),open:o?o.openByDefault:void 0};i.push(r)}}),this.setColumnGroupState(i,e)}setColumnGroupState(e,t){let{colModel:i,colAnimation:n,visibleCols:o,eventSvc:r}=this.beans;if(!i.getColTree().length)return;n?.start();let a=[];for(let l of e){let c=l.groupId,d=l.open,u=this.getProvidedColGroup(c);u&&u.isExpanded()!==d&&(u.setExpanded(d),a.push(u))}o.refresh(t,!0),a.length&&r.dispatchEvent({type:"columnGroupOpened",columnGroup:a.length===1?a[0]:void 0,columnGroups:a}),n?.finish()}setColumnGroupOpened(e,t,i){let n;wi(e)?n=e.getId():n=e||"",this.setColumnGroupState([{groupId:n,open:t}],i)}getProvidedColGroup(e){let t=null;return rr(null,this.beans.colModel.getColTree(),i=>{wi(i)&&i.getId()===e&&(t=i)}),t}getGroupAtDirection(e,t){let i=e.getProvidedColumnGroup().getLevel()+e.getPaddingLevel(),n=e.getDisplayedLeafColumns(),o=t==="After"?rt(n):n[0],r=`getCol${t}`;for(;;){let s=this.beans.visibleCols[r](o);if(!s)return null;let a=this.getColGroupAtLevel(s,i);if(a!==e)return a}}getColGroupAtLevel(e,t){let i=e.getParent(),n,o;for(;n=i.getProvidedColumnGroup().getLevel(),o=i.getPaddingLevel(),!(n+o<=t);)i=i.getParent();return i}updateOpenClosedVisibility(){let e=this.beans.visibleCols.getAllTrees();oa(e,!1,t=>{kt(t)&&t.calculateDisplayedColumns()})}getColumnGroup(e,t){if(!e)return null;if(kt(e))return e;let i=this.beans.visibleCols.getAllTrees(),n=typeof t=="number",o=null;return oa(i,!1,r=>{if(kt(r)){let s=r,a;n?a=e===s.getGroupId()&&t===s.getPartId():a=e===s.getGroupId(),a&&(o=s)}}),o}createColumnGroups(e){let{columns:t,idCreator:i,pinned:n,oldDisplayedGroups:o,isStandaloneStructure:r}=e,s=this.mapOldGroupsById(o),a=[],l=t;for(;l.length;){let c=l;l=[];let d=0,u=h=>{let p=d;d=h;let g=c[p],m=(kt(g)?g.getProvidedColumnGroup():g).getOriginalParent();if(m==null){for(let C=p;C<h;C++)a.push(c[C]);return}let v=this.createColumnGroup(m,i,s,n,r);for(let C=p;C<h;C++)v.addChild(c[C]);l.push(v)};for(let h=1;h<c.length;h++){let p=c[h],f=(kt(p)?p.getProvidedColumnGroup():p).getOriginalParent(),m=c[d],C=(kt(m)?m.getProvidedColumnGroup():m).getOriginalParent();f!==C&&u(h)}d<c.length&&u(c.length)}return r||this.setupParentsIntoCols(a,null),a}createProvidedColumnGroup(e,t,i,n,o,r,s){let a=o.getUniqueKey(t.groupId||null,null),l=OE(this.beans,t,a),c=new wp(l,a,!1,i);this.createBean(c);let d=this.findExistingGroup(t,r);d&&r.splice(d.idx,1);let u=d?.group;u&&c.setExpanded(u.isExpanded());let h=BR(this.beans,l.children,i+1,e,n,o,r,s);return c.setChildren(h),c}balanceColumnTree(e,t,i,n){let o=[];for(let r=0;r<e.length;r++){let s=e[r];if(wi(s)){let a=s,l=this.balanceColumnTree(a.getChildren(),t+1,i,n);a.setChildren(l),o.push(a)}else{let a,l;for(let c=t;c<i;c++){let d=n.getUniqueKey(null,null),u=OE(this.beans,null,d),h=new wp(u,d,!0,c);this.createBean(h),l&&l.setChildren([h]),l=h,a||(a=l)}if(a&&l)if(o.push(a),e.some(d=>wi(d))){l.setChildren([s]);continue}else{l.setChildren(e);break}o.push(s)}}return o}findDepth(e){let t=0,i=e;for(;i?.[0]&&wi(i[0]);)t++,i=i[0].getChildren();return t}findMaxDepth(e,t){let i=t;for(let n=0;n<e.length;n++){let o=e[n];if(wi(o)){let r=o,s=this.findMaxDepth(r.getChildren(),t+1);i<s&&(i=s)}}return i}balanceTreeForAutoCols(e,t){let i=[];for(let n of e){let o=n;for(let r=t-1;r>=0;r--){let s=new wp(null,`FAKE_PATH_${n.getId()}}_${r}`,!0,r);this.createBean(s),s.setChildren([o]),o.originalParent=s,o=s}t===0&&(n.originalParent=null),i.push(o)}return i}findExistingGroup(e,t){if(e.groupId!=null)for(let n=0;n<t.length;n++){let o=t[n];if(o.getColGroupDef()&&o.getId()===e.groupId)return{idx:n,group:o}}}createColumnGroup(e,t,i,n,o){let r=e.getGroupId(),s=t.getInstanceIdForKey(r),a=vP(r,s),l=i[a];return l&&l.getProvidedColumnGroup()!==e&&(l=null),ie(l)?l.reset():(l=new yd(e,r,s,n),o||this.createBean(l)),l}mapOldGroupsById(e){let t={},i=n=>{for(let o of n)if(kt(o)){let r=o;t[o.getUniqueId()]=r,i(r.getChildren())}};return e&&i(e),t}setupParentsIntoCols(e,t){for(let i of e??[])if(i.parent!==t&&(this.beans.colViewport.colsWithinViewportHash=""),i.parent=t,kt(i)){let n=i;this.setupParentsIntoCols(n.getChildren(),n)}}},tG={moduleName:"ColumnGroup",version:ee,dynamicBeans:{headerGroupCellCtrl:VV},beans:[eG],apiFunctions:{getAllDisplayedColumnGroups:JV,getCenterDisplayedColumnGroups:YV,getColumnGroup:zV,getColumnGroupState:qV,getDisplayNameForColumnGroup:UV,getLeftDisplayedColumnGroups:KV,getProvidedColumnGroup:WV,getRightDisplayedColumnGroups:XV,resetColumnGroupState:jV,setColumnGroupOpened:GV,setColumnGroupState:$V}},iG={tag:"div",cls:"ag-skeleton-container"},nG=class extends je{constructor(){super(iG)}init(e){let t=`ag-cell-skeleton-renderer-${this.getCompId()}`;this.getGui().setAttribute("id",t),this.addDestroyFunc(()=>pd(e.eParentOfValue)),pd(e.eParentOfValue,t),e.deferRender?this.setupLoading(e):e.node.failedLoad?this.setupFailed():this.setupLoading(e)}setupFailed(){let e=this.getLocaleTextFunc();this.getGui().textContent=e("loadingError","ERR");let t=e("ariaSkeletonCellLoadingFailed","Row failed to load");Sl(this.getGui(),t)}setupLoading(e){let t=Ft({tag:"div",cls:"ag-skeleton-effect"}),i=e.node.rowIndex;if(i!=null){let r=75+25*(i%2===0?Math.sin(i):Math.cos(i));t.style.width=`${r}%`}this.getGui().appendChild(t);let n=this.getLocaleTextFunc(),o=e.deferRender?n("ariaDeferSkeletonCellLoading","Cell is loading"):n("ariaSkeletonCellLoading","Row data is loading");Sl(this.getGui(),o)}refresh(e){return!1}},oG={moduleName:"CheckboxCellRenderer",version:ee,userComponents:{agCheckboxCellRenderer:GB}},rG={moduleName:"SkeletonCellRenderer",version:ee,userComponents:{agSkeletonCellRenderer:nG}};function sG(e,t){let i=e.colModel.getColDefCol(t);return i?i.getColDef():null}function aG(e){return e.colModel.getColumnDefs(!0)}function lG(e,t,i){return e.colNames.getDisplayNameForColumn(t,i)||""}function cG(e,t){return e.colModel.getColDefCol(t)}function dG(e){return e.colModel.getColDefCols()}function uG(e,t){return Bn(e,t,"api")}function hG(e){return Hp(e)}function pG(e){tO(e,"api")}function gG(e){return e.visibleCols.isPinningLeft()||e.visibleCols.isPinningRight()}function fG(e){return e.visibleCols.isPinningLeft()}function mG(e){return e.visibleCols.isPinningRight()}function vG(e,t){return e.visibleCols.getColAfter(t)}function CG(e,t){return e.visibleCols.getColBefore(t)}function wG(e,t,i){e.colModel.setColsVisible(t,i,"api")}function bG(e,t,i){e.pinnedCols?.setColsPinned(t,i,"api")}function yG(e){return e.colModel.getCols()}function SG(e){return e.visibleCols.leftCols}function xG(e){return e.visibleCols.centerCols}function EG(e){return e.visibleCols.rightCols}function _G(e){return e.visibleCols.allCols}function RG(e){return e.colViewport.getViewportColumns()}function OC(e,t){if(!e)return;let i=e,n={};for(let o of Object.keys(i)){if(t&&t.indexOf(o)>=0||pR.has(o))continue;let r=i[o];typeof r=="object"&&r!==null&&r.constructor===Object?n[o]=OC(r):n[o]=r}return n}var PG=class extends A{constructor(){super(...arguments),this.beanName="colDefFactory"}wireBeans(e){this.rowGroupColsSvc=e.rowGroupColsSvc,this.pivotColsSvc=e.pivotColsSvc}getColumnDefs(e,t,i,n,o=!1){let r=e.slice();t?r.sort((l,c)=>i.indexOf(l)-i.indexOf(c)):(i||o)&&r.sort((l,c)=>n.indexOf(l)-n.indexOf(c));let s=this.rowGroupColsSvc?.columns,a=this.pivotColsSvc?.columns;return this.buildColumnDefs(r,s,a)}buildColumnDefs(e,t=[],i=[]){let n=[],o={};for(let r of e){let s=this.createDefFromColumn(r,t,i),a=!0,l=s,c=r.getOriginalParent(),d=null;for(;c;){let u=null;if(c.isPadding()){c=c.getOriginalParent();continue}let h=o[c.getGroupId()];if(h){h.children.push(l),a=!1;break}if(u=this.createDefFromGroup(c),u&&(u.children=[l],o[u.groupId]=u,l=u,c=c.getOriginalParent()),c!=null&&d===c){a=!1;break}d=c}a&&n.push(l)}return n}createDefFromGroup(e){let t=OC(e.getColGroupDef(),["children"]);return t&&(t.groupId=e.getGroupId()),t}createDefFromColumn(e,t,i){let n=OC(e.getColDef());return n.colId=e.getColId(),n.width=e.getActualWidth(),n.rowGroup=e.isRowGroupActive(),n.rowGroupIndex=e.isRowGroupActive()?t.indexOf(e):null,n.pivot=e.isPivotActive(),n.pivotIndex=e.isPivotActive()?i.indexOf(e):null,n.aggFunc=e.isValueActive()?e.getAggFunc():null,n.hide=e.isVisible()?void 0:!0,n.pinned=e.isPinned()?e.getPinned():null,n.sort=e.getSort()?e.getSort():null,n.sortIndex=e.getSortIndex()!=null?e.getSortIndex():null,n}},DG=class extends A{constructor(){super(...arguments),this.beanName="colFlex",this.columnsHidden=!1}refreshFlexedColumns(e={}){let t=e.source??"flex";e.viewportWidth!=null&&(this.flexViewportWidth=e.viewportWidth);let i=this.flexViewportWidth,{visibleCols:n,colDelayRenderSvc:o}=this.beans,r=n.centerCols,s=-1;if(e.resizingCols){let f=new Set(e.resizingCols);for(let m=r.length-1;m>=0;m--)if(f.has(r[m])){s=m;break}}let a=!1,l=r.map((f,m)=>{let v=f.getFlex(),C=v!=null&&v>0&&m>s;return a||(a=C),{col:f,isFlex:C,flex:Math.max(0,v??0),initialSize:f.getActualWidth(),min:f.getMinWidth(),max:f.getMaxWidth(),targetSize:0}});if(a?(o?.hideColumns("colFlex"),this.columnsHidden=!0):this.columnsHidden&&this.revealColumns(o),!i||!a)return[];let c=l.length,d=l.reduce((f,m)=>f+m.flex,0),u=i,h=(f,m)=>{f.frozenSize=m,f.col.setActualWidth(m,t),u-=m,d-=f.flex,c-=1},p=f=>f.frozenSize!=null;for(let f of l)f.isFlex||h(f,f.initialSize);for(;c>0;){let f=Math.round(d<1?u*d:u),m,v=0,C=0;for(let _ of l){if(p(_))continue;m=_,C+=f*(_.flex/d);let R=C-v,P=Math.round(R);_.targetSize=P,v+=P}m&&(m.targetSize+=f-v);let w=0;for(let _ of l){if(p(_))continue;let R=_.targetSize,P=Math.min(Math.max(R,_.min),_.max);w+=P-R,_.violationType=P===R?void 0:P<R?"max":"min",_.targetSize=P}let y=w===0?"all":w>0?"min":"max";for(let _ of l)p(_)||(y==="all"||_.violationType===y)&&h(_,_.targetSize)}e.skipSetLeft||n.setLeftValues(t),e.updateBodyWidths&&n.updateBodyWidths();let g=l.filter(f=>f.isFlex&&!f.violationType).map(f=>f.col);if(e.fireResizedEvent){let f=l.filter(v=>v.initialSize!==v.frozenSize).map(v=>v.col),m=l.filter(v=>v.flex).map(v=>v.col);El(this.eventSvc,f,!0,t,m)}return this.revealColumns(o),g}revealColumns(e){this.columnsHidden&&(e?.revealColumns("colFlex"),this.columnsHidden=!1)}initCol(e){let{flex:t,initialFlex:i}=e.colDef;t!==void 0?e.flex=t:i!==void 0&&(e.flex=i)}setColFlex(e,t){e.flex=t??null,e.dispatchStateUpdatedEvent("flex")}};function cd(e,t,i){if(!t||!e)return;if(!i)return e[t];let n=t.split("."),o=e;for(let r=0;r<n.length;r++){if(o==null)return;o=o[n[r]]}return o}var MG=["dateTimeString","dateString","text","number","boolean","date"],kG=class extends A{constructor(){super(...arguments),this.beanName="dataTypeSvc",this.dataTypeDefinitions={},this.isPendingInference=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[],this.columnDefinitionPropsPerDataType={number(){return{cellEditor:"agNumberCellEditor"}},boolean(){return{cellEditor:"agCheckboxCellEditor",cellRenderer:"agCheckboxCellRenderer",getFindText:()=>null,suppressKeyboardEvent:e=>!!e.colDef.editable&&e.event.key===T.SPACE}},date({formatValue:e}){return{cellEditor:"agDateCellEditor",keyCreator:e}},dateString({formatValue:e}){return{cellEditor:"agDateStringCellEditor",keyCreator:e}},dateTime(e){return this.date(e)},dateTimeString(e){return this.dateString(e)},object({formatValue:e,colModel:t,colId:i}){return{cellEditorParams:{useFormatter:!0},comparator:(n,o)=>{let r=t.getColDefCol(i),s=r?.getColDef();if(!r||!s)return 0;let a=n==null?"":e({column:r,node:null,value:n}),l=o==null?"":e({column:r,node:null,value:o});return a===l?0:a>l?1:-1},keyCreator:e}},text(){return{}}}}wireBeans(e){this.colModel=e.colModel}postConstruct(){this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",e=>{this.processDataTypeDefinitions(),this.colModel.recreateColumnDefs(e)})}processDataTypeDefinitions(){let e=this.getDefaultDataTypes(),t={},i={},n=d=>u=>{let{column:h,node:p,value:g}=u,f=h.getColDef().valueFormatter;return f===d.groupSafeValueFormatter&&(f=d.valueFormatter),this.beans.valueSvc.formatValue(h,p,g,f)};for(let d of Object.keys(e)){let u=e[d],h=z(b({},u),{groupSafeValueFormatter:S_(u,this.gos)});t[d]=h,i[d]=n(h)}let o=this.gos.get("dataTypeDefinitions")??{},r={};for(let d of Object.keys(o)){let u=o[d],h=this.processDataTypeDefinition(u,o,[d],e);h&&(t[d]=h,u.dataTypeMatcher&&(r[d]=u.dataTypeMatcher),i[d]=n(h))}let{valueParser:s,valueFormatter:a}=e.object,{valueParser:l,valueFormatter:c}=t.object;this.hasObjectValueParser=l!==s,this.hasObjectValueFormatter=c!==a,this.formatValueFuncs=i,this.dataTypeDefinitions=t,this.dataTypeMatchers=this.sortKeysInMatchers(r,e)}sortKeysInMatchers(e,t){let i=b({},e);for(let n of MG)delete i[n],i[n]=e[n]??t[n].dataTypeMatcher;return i}processDataTypeDefinition(e,t,i,n){let o,r=e.extendsDataType;if(e.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),e.extendsDataType===e.baseDataType){let s=n[r],a=t[r];if(s&&a&&(s=a),!y_(e,s,r))return;o=b_(s,e)}else{if(i.includes(r)){W(44);return}let s=t[r];if(!y_(e,s,r))return;let a=this.processDataTypeDefinition(s,t,[...i,r],n);if(!a)return;o=b_(a,e)}return z(b({},o),{groupSafeValueFormatter:S_(o,this.gos)})}updateColDefAndGetColumnType(e,t,i){let{cellDataType:n}=t,{field:o}=t;if(n===void 0&&(n=e.cellDataType),(n==null||n===!0)&&(n=this.canInferCellDataType(e,t)?this.inferCellDataType(o,i):!1),!n){e.cellDataType=!1;return}let r=this.dataTypeDefinitions[n];if(!r){W(47,{cellDataType:n});return}return e.cellDataType=n,r.groupSafeValueFormatter&&(e.valueFormatter=r.groupSafeValueFormatter),r.valueParser&&(e.valueParser=r.valueParser),r.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(e,n,r,i),r.columnTypes}addColumnListeners(e){if(!this.isPendingInference)return;let t=this.columnStateUpdatesPendingInference[e.getColId()];if(!t)return;let i=n=>{t.add(n.key)};e.__addEventListener("columnStateUpdated",i),this.columnStateUpdateListenerDestroyFuncs.push(()=>e.__removeEventListener("columnStateUpdated",i))}canInferCellDataType(e,t){let{gos:i}=this;if(!Tt(i))return!1;let n={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(tC(t,n))return!1;let o=t.type===null?e.type:t.type;if(o){let r=i.get("columnTypes")??{};if(Bp(o).some(a=>{let l=r[a.trim()];return l&&tC(l,n)}))return!1}return!tC(e,n)}inferCellDataType(e,t){if(!e)return;let i,n=this.getInitialData();if(n){let r=e.includes(".")&&!this.gos.get("suppressFieldDotNotation");i=cd(n,e,r)}else this.initWaitForRowData(t);return i==null?void 0:Object.keys(this.dataTypeMatchers).find(r=>this.dataTypeMatchers[r](i))??"object"}getInitialData(){let e=this.gos.get("rowData");if(e?.length)return e[0];if(this.initialData)return this.initialData;{let t=this.beans.rowModel.rootNode?._leafs;if(t?.length)return t[0].data}return null}initWaitForRowData(e){if(this.columnStateUpdatesPendingInference[e]=new Set,this.isPendingInference)return;this.isPendingInference=!0;let t=this.isColumnTypeOverrideInDataTypeDefinitions,{colAutosize:i,eventSvc:n}=this.beans;t&&i&&(i.shouldQueueResizeOperations=!0);let[o]=this.addManagedEventListeners({rowDataUpdateStarted:r=>{let{firstRowData:s}=r;s&&(o?.(),this.isPendingInference=!1,this.processColumnsPendingInference(s,t),this.columnStateUpdatesPendingInference={},t&&i?.processResizeOperations(),n.dispatchEvent({type:"dataTypesInferred"}))}})}processColumnsPendingInference(e,t){this.initialData=e;let i=[];this.destroyColumnStateUpdateListeners();let n={},o={};for(let r of Object.keys(this.columnStateUpdatesPendingInference)){let s=this.columnStateUpdatesPendingInference[r],a=this.colModel.getCol(r);if(!a)return;let l=a.getColDef();if(!this.resetColDefIntoCol(a,"cellDataTypeInferred"))return;let c=a.getColDef();if(t&&c.type&&c.type!==l.type){let d=FG(a,s);d.rowGroup&&d.rowGroupIndex==null&&(n[r]=d),d.pivot&&d.pivotIndex==null&&(o[r]=d),i.push(d)}}t&&i.push(...this.generateColumnStateForRowGroupAndPivotIndexes(n,o)),i.length&&Bn(this.beans,{state:i},"cellDataTypeInferred"),this.initialData=null}generateColumnStateForRowGroupAndPivotIndexes(e,t){let i={},{rowGroupColsSvc:n,pivotColsSvc:o}=this.beans;return n?.restoreColumnOrder(i,e),o?.restoreColumnOrder(i,t),Object.values(i)}resetColDefIntoCol(e,t){let i=e.getUserProvidedColDef();if(!i)return!1;let n=CC(this.beans,i,e.getColId());return e.setColDef(n,i,t),!0}getDateStringTypeDefinition(e){let{dateString:t}=this.dataTypeDefinitions;return e?this.getDataTypeDefinition(e)??t:t}getDateParserFunction(e){return this.getDateStringTypeDefinition(e).dateParser}getDateFormatterFunction(e){return this.getDateStringTypeDefinition(e).dateFormatter}getDateIncludesTimeFlag(e){return e==="dateTime"||e==="dateTimeString"}getDataTypeDefinition(e){let t=e.getColDef();if(t.cellDataType)return this.dataTypeDefinitions[t.cellDataType]}getBaseDataType(e){return this.getDataTypeDefinition(e)?.baseDataType}checkType(e,t){if(t==null)return!0;let i=this.getDataTypeDefinition(e)?.dataTypeMatcher;return i?i(t):!0}validateColDef(e){let t=i=>W(48,{property:i});if(e.cellDataType==="object"){let{object:i}=this.dataTypeDefinitions;e.valueFormatter===i.groupSafeValueFormatter&&!this.hasObjectValueFormatter&&t("Formatter"),e.editable&&e.valueParser===i.valueParser&&!this.hasObjectValueParser&&t("Parser")}}postProcess(e){let t=e.cellDataType;if(!t||typeof t!="string")return;let{dataTypeDefinitions:i,beans:n,formatValueFuncs:o}=this,r=i[t];r&&n.colFilter?.setColDefPropsForDataType(e,r,o[t])}getFormatValue(e){return this.formatValueFuncs[e]}isColPendingInference(e){return this.isPendingInference&&!!this.columnStateUpdatesPendingInference[e]}setColDefPropertiesForBaseDataType(e,t,i,n){let o=this.formatValueFuncs[t],r=this.columnDefinitionPropsPerDataType[i.baseDataType]({colDef:e,cellDataType:t,colModel:this.colModel,dataTypeDefinition:i,colId:n,formatValue:o});Object.assign(e,r)}getDateObjectTypeDef(e){let t=this.getLocaleTextFunc(),i=this.getDateIncludesTimeFlag(e);return{baseDataType:e,valueParser:n=>Wi(n.newValue&&String(n.newValue)),valueFormatter:n=>n.value==null?"":!(n.value instanceof Date)||isNaN(n.value.getTime())?t("invalidDate","Invalid Date"):nn(n.value,i)??"",dataTypeMatcher:n=>n instanceof Date}}getDateStringTypeDef(e){let t=this.getDateIncludesTimeFlag(e);return{baseDataType:e,dateParser:i=>Wi(i)??void 0,dateFormatter:i=>nn(i??null,t)??void 0,valueParser:i=>bp(String(i.newValue))?i.newValue:null,valueFormatter:i=>bp(String(i.value))?String(i.value):"",dataTypeMatcher:i=>typeof i=="string"&&bp(i)}}getDefaultDataTypes(){let e=this.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:t=>t.newValue?.trim?.()===""?null:Number(t.newValue),valueFormatter:t=>t.value==null?"":typeof t.value!="number"||isNaN(t.value)?e("invalidNumber","Invalid Number"):String(t.value),dataTypeMatcher:t=>typeof t=="number"},text:{baseDataType:"text",valueParser:t=>t.newValue===""?null:dC(t.newValue),dataTypeMatcher:t=>typeof t=="string"},boolean:{baseDataType:"boolean",valueParser:t=>t.newValue==null?t.newValue:t.newValue?.trim?.()===""?null:String(t.newValue).toLowerCase()==="true",valueFormatter:t=>t.value==null?"":String(t.value),dataTypeMatcher:t=>typeof t=="boolean"},date:this.getDateObjectTypeDef("date"),dateString:this.getDateStringTypeDef("dateString"),dateTime:this.getDateObjectTypeDef("dateTime"),dateTimeString:z(b({},this.getDateStringTypeDef("dateTimeString")),{dataTypeMatcher:t=>typeof t=="string"&&jO(t)}),object:{baseDataType:"object",valueParser:()=>null,valueFormatter:t=>dC(t.value)??""}}}destroyColumnStateUpdateListeners(){for(let e of this.columnStateUpdateListenerDestroyFuncs)e();this.columnStateUpdateListenerDestroyFuncs=[]}destroy(){this.dataTypeDefinitions={},this.dataTypeMatchers={},this.formatValueFuncs={},this.columnStateUpdatesPendingInference={},this.destroyColumnStateUpdateListeners(),super.destroy()}};function b_(e,t){let i=b(b({},e),t);return e.columnTypes&&t.columnTypes&&t.appendColumnTypes&&(i.columnTypes=[...Bp(e.columnTypes),...Bp(t.columnTypes)]),i}function y_(e,t,i){return t?t.baseDataType!==e.baseDataType?(W(46),!1):!0:(W(45,{parentCellDataType:i}),!1)}function S_(e,t){if(e.valueFormatter)return i=>{if(i.node?.group){let n=(i.colDef.pivotValueColumn??i.column).getAggFunc();if(n){if(n==="first"||n==="last")return e.valueFormatter(i);if(e.baseDataType==="number"&&n!=="count"){if(typeof i.value=="number")return e.valueFormatter(i);if(typeof i.value=="object"){if(!i.value)return;if("toNumber"in i.value)return e.valueFormatter(z(b({},i),{value:i.value.toNumber()}));if("value"in i.value)return e.valueFormatter(z(b({},i),{value:i.value.value}))}}return}}else if(t.get("groupHideOpenParents")&&i.column.isRowGroupActive()&&typeof i.value=="string"&&!e.dataTypeMatcher?.(i.value))return;return e.valueFormatter(i)}}function TG(e,t,i,n){if(!t[i])return!1;let o=e[i];return o===null?(t[i]=!1,!1):n===void 0?!!o:o===n}function tC(e,t){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some(([i,n])=>TG(e,t,i,n))}function FG(e,t){let i=qR(e);for(let n of t)delete i[n],n==="rowGroup"?delete i.rowGroupIndex:n==="pivot"&&delete i.pivotIndex;return i}var IG={moduleName:"DataType",version:ee,beans:[kG],dependsOn:[oG]},AG={moduleName:"ColumnFlex",version:ee,beans:[DG]},JP={moduleName:"ColumnApi",version:ee,beans:[PG],apiFunctions:{getColumnDef:sG,getDisplayNameForColumn:lG,getColumn:cG,getColumns:dG,applyColumnState:uG,getColumnState:hG,resetColumnState:pG,isPinning:gG,isPinningLeft:fG,isPinningRight:mG,getDisplayedColAfter:vG,getDisplayedColBefore:CG,setColumnsVisible:wG,setColumnsPinned:bG,getAllGridColumns:yG,getDisplayedLeftColumns:SG,getDisplayedCenterColumns:xG,getDisplayedRightColumns:EG,getAllDisplayedColumns:_G,getAllDisplayedVirtualColumns:RG,getColumnDefs:aG}};function LG(e){if(!e||e==null)return null;let t=/([a-z])([A-Z])/g,i=/([A-Z]+)([A-Z])([a-z])/g;return e.replace(t,"$1 $2").replace(i,"$1 $2$3").replace(/\./g," ").split(" ").map(o=>o.substring(0,1).toUpperCase()+(o.length>1?o.substring(1,o.length):"")).join(" ")}var OG=class extends A{constructor(){super(...arguments),this.beanName="colNames"}getDisplayNameForColumn(e,t,i=!1){if(!e)return null;let n=this.getHeaderName(e.getColDef(),e,null,null,t),{aggColNameSvc:o}=this.beans;return i&&o?o.getHeaderName(e,n):n}getDisplayNameForProvidedColumnGroup(e,t,i){let n=t?.getColGroupDef();return n?this.getHeaderName(n,null,e,t,i):null}getDisplayNameForColumnGroup(e,t){return this.getDisplayNameForProvidedColumnGroup(e,e.getProvidedColumnGroup(),t)}getHeaderName(e,t,i,n,o){let r=e.headerValueGetter;if(r){let s=ye(this.gos,{colDef:e,column:t,columnGroup:i,providedColumnGroup:n,location:o});return typeof r=="function"?r(s):typeof r=="string"?this.beans.expressionSvc?.evaluate(r,s)??null:""}else{if(e.headerName!=null)return e.headerName;if(e.field)return LG(e.field)}return""}},NG=class extends A{constructor(){super(...arguments),this.beanName="colViewport",this.colsWithinViewport=[],this.headerColsWithinViewport=[],this.colsWithinViewportHash="",this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.columnsToRenderLeft=[],this.columnsToRenderRight=[],this.columnsToRenderCenter=[]}wireBeans(e){this.visibleCols=e.visibleCols,this.colModel=e.colModel}postConstruct(){this.suppressColumnVirtualisation=this.gos.get("suppressColumnVirtualisation")}setScrollPosition(e,t,i=!1){let{visibleCols:n}=this,o=n.isBodyWidthDirty;if(!(e===this.scrollWidth&&t===this.scrollPosition&&!o)){if(this.scrollWidth=e,this.scrollPosition=t,n.isBodyWidthDirty=!0,this.gos.get("enableRtl")){let s=n.bodyWidth;this.viewportLeft=s-t-e,this.viewportRight=s-t}else this.viewportLeft=t,this.viewportRight=e+t;this.colModel.ready&&this.checkViewportColumns(i)}}getColumnHeadersToRender(e){switch(e){case"left":return this.columnsToRenderLeft;case"right":return this.columnsToRenderRight;default:return this.columnsToRenderCenter}}getHeadersToRender(e,t){let i;switch(e){case"left":i=this.rowsOfHeadersToRenderLeft[t];break;case"right":i=this.rowsOfHeadersToRenderRight[t];break;default:i=this.rowsOfHeadersToRenderCenter[t];break}return i??[]}extractViewportColumns(){let e=this.visibleCols.centerCols;this.isColumnVirtualisationSuppressed()?(this.colsWithinViewport=e,this.headerColsWithinViewport=e):(this.colsWithinViewport=e.filter(this.isColumnInRowViewport.bind(this)),this.headerColsWithinViewport=e.filter(this.isColumnInHeaderViewport.bind(this)))}isColumnVirtualisationSuppressed(){return this.suppressColumnVirtualisation||this.viewportRight===0}clear(){this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.colsWithinViewportHash=""}isColumnInHeaderViewport(e){return e.isAutoHeaderHeight()||BG(e)?!0:this.isColumnInRowViewport(e)}isColumnInRowViewport(e){if(e.isAutoHeight())return!0;let t=e.getLeft()||0,i=t+e.getActualWidth(),n=this.viewportLeft-200,o=this.viewportRight+200,r=t<n&&i<n,s=t>o&&i>o;return!r&&!s}getViewportColumns(){let{leftCols:e,rightCols:t}=this.visibleCols;return this.colsWithinViewport.concat(e).concat(t)}getColsWithinViewport(e){if(!this.colModel.colSpanActive)return this.colsWithinViewport;let t=r=>{let s=r.getLeft();return ie(s)&&s>this.viewportLeft},i=this.isColumnVirtualisationSuppressed()?void 0:this.isColumnInRowViewport.bind(this),{visibleCols:n}=this,o=n.centerCols;return n.getColsForRow(e,o,i,t)}checkViewportColumns(e=!1){this.extractViewport()&&this.eventSvc.dispatchEvent({type:"virtualColumnsChanged",afterScroll:e})}calculateHeaderRows(){let{leftCols:e,rightCols:t}=this.visibleCols;this.columnsToRenderLeft=e,this.columnsToRenderRight=t,this.columnsToRenderCenter=this.colsWithinViewport;let i=n=>{let o=new Set,r={};for(let s of n){let a=s.getParent(),l=s.isSpanHeaderHeight();for(;a&&!o.has(a);){if(l&&a.isPadding()){a=a.getParent();continue}let d=a.getProvidedColumnGroup().getLevel();r[d]??(r[d]=[]),r[d].push(a),o.add(a),a=a.getParent()}}return r};this.rowsOfHeadersToRenderLeft=i(e),this.rowsOfHeadersToRenderRight=i(t),this.rowsOfHeadersToRenderCenter=i(this.headerColsWithinViewport)}extractViewport(){let e=n=>`${n.getId()}-${n.getPinned()||"normal"}`;this.extractViewportColumns();let t=this.getViewportColumns().map(e).join("#"),i=this.colsWithinViewportHash!==t;return i&&(this.colsWithinViewportHash=t,this.calculateHeaderRows()),i}};function BG(e){for(;e;){if(e.isAutoHeaderHeight())return!0;e=e.getParent()}return!1}var HG=class extends A{constructor(){super(...arguments),this.beanName="agCompUtils"}adaptFunction(e,t){if(!e.cellRenderer)return null;class i{refresh(){return!1}getGui(){return this.eGui}init(o){let r=t(o),s=typeof r;if(s==="string"||s==="number"||s==="boolean"){this.eGui=jC("<span>"+r+"</span>");return}if(r==null){this.eGui=Ft({tag:"span"});return}this.eGui=r}}return i}},VG={moduleName:"CellRendererFunction",version:ee,beans:[HG]},GG=class extends U9{constructor(){super(...arguments),this.agGridDefaults={},this.agGridDefaultOverrides={},this.jsComps={},this.selectors={},this.icons={}}postConstruct(){let e=this.gos.get("components");if(e!=null)for(let t of Object.keys(e))this.jsComps[t]=e[t]}registerModule(e){let{icons:t,userComponents:i,dynamicBeans:n,selectors:o}=e;if(i){let r=(s,a,l,c)=>{this.agGridDefaults[s]=a,(l||c)&&(this.agGridDefaultOverrides[s]={params:l,processParams:c})};for(let s of Object.keys(i)){let a=i[s];if(zO(a)&&(a=a.getComp(this.beans)),typeof a=="object"){let{classImp:l,params:c,processParams:d}=a;r(s,l,c,d)}else r(s,a)}}this.registerDynamicBeans(n);for(let r of o??[])this.selectors[r.selector]=r;if(t)for(let r of Object.keys(t))this.icons[r]=t[r]}getUserComponent(e,t){let i=(a,l,c,d)=>({componentFromFramework:l,component:a,params:c,processParams:d}),{frameworkOverrides:n}=this.beans,o=n.frameworkComponent(t,this.gos.get("components"));if(o!=null)return i(o,!0);let r=this.jsComps[t];if(r){let a=n.isFrameworkComponent(r);return i(r,a)}let s=this.agGridDefaults[t];if(s){let a=this.agGridDefaultOverrides[t];return i(s,!1,a?.params,a?.processParams)}return this.beans.validation?.missingUserComponent(e,t,this.agGridDefaults,this.jsComps),null}getSelector(e){return this.selectors[e]}getIcon(e){return this.icons[e]}getDynamicError(e,t){return t?Co(279,{name:e}):this.beans.validation?.missingDynamicBean(e)??Co(256)}},zG=23,WG=class extends A{constructor(){super(...arguments),this.beanName="ctrlsSvc",this.params={},this.ready=!1,this.readyCallbacks=[]}postConstruct(){this.addEventListener("ready",()=>{if(this.updateReady(),this.ready){for(let e of this.readyCallbacks)e(this.params);this.readyCallbacks.length=0}},this.beans.frameworkOverrides.runWhenReadyAsync?.()??!1)}updateReady(){let e=Object.values(this.params);this.ready=e.length===zG&&e.every(t=>t?.isAlive()??!1)}whenReady(e,t){this.ready?t(this.params):this.readyCallbacks.push(t),e.addDestroyFunc(()=>{let i=this.readyCallbacks.indexOf(t);i>=0&&this.readyCallbacks.splice(i,1)})}register(e,t){this.params[e]=t,this.updateReady(),this.ready&&this.dispatchLocalEvent({type:"ready"}),t.addDestroyFunc(()=>{this.updateReady()})}get(e){return this.params[e]}getGridBodyCtrl(){return this.params.gridBodyCtrl}getHeaderRowContainerCtrls(){let{leftHeader:e,centerHeader:t,rightHeader:i}=this.params;return[e,i,t]}getHeaderRowContainerCtrl(e){let t=this.params;switch(e){case"left":return t.leftHeader;case"right":return t.rightHeader;default:return t.centerHeader}}getScrollFeature(){return this.getGridBodyCtrl().scrollFeature}},UG='.ag-aria-description-container{border:0;z-index:9999;clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px}.ag-unselectable{-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-selectable{-webkit-user-select:text;-moz-user-select:text;user-select:text}.ag-tab-guard{display:block;height:0;position:absolute;width:0}:where(.ag-virtual-list-viewport) .ag-tab-guard{position:sticky}.ag-tab-guard-top{top:1px}.ag-tab-guard-bottom{bottom:1px}.ag-shake-left-to-right{animation-direction:alternate;animation-duration:.2s;animation-iteration-count:infinite;animation-name:ag-shake-left-to-right}@keyframes ag-shake-left-to-right{0%{padding-left:6px;padding-right:2px}to{padding-left:2px;padding-right:6px}}.ag-body-horizontal-scroll-viewport,.ag-body-vertical-scroll-viewport,.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport,.ag-virtual-list-viewport{flex:1 1 auto;height:100%;min-width:0;overflow:hidden;position:relative}.ag-viewport{position:relative}.ag-spanning-container{position:absolute;top:0;z-index:1}.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport{overflow-x:auto;-ms-overflow-style:none!important;scrollbar-width:none!important;&::-webkit-scrollbar{display:none!important}}.ag-body-viewport{display:flex;overflow-x:hidden;&:where(.ag-layout-normal){overflow-y:auto;-webkit-overflow-scrolling:touch}}.ag-floating-bottom-container,.ag-floating-top-container,.ag-sticky-bottom-container,.ag-sticky-top-container{min-height:1px}.ag-center-cols-viewport{min-height:100%;width:100%}.ag-body-horizontal-scroll-viewport{overflow-x:scroll}.ag-body-vertical-scroll-viewport{overflow-y:scroll}.ag-virtual-list-viewport{overflow:auto;width:100%}.ag-body-container,.ag-body-horizontal-scroll-container,.ag-body-vertical-scroll-container,.ag-center-cols-container,.ag-floating-bottom-container,.ag-floating-bottom-full-width-container,.ag-floating-top-container,.ag-full-width-container,.ag-header-container,.ag-pinned-left-cols-container,.ag-pinned-right-cols-container,.ag-sticky-bottom-container,.ag-sticky-top-container,.ag-virtual-list-container{position:relative}.ag-floating-bottom-container,.ag-floating-top-container,.ag-header-container,.ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top,.ag-sticky-bottom-container,.ag-sticky-top-container{height:100%;white-space:nowrap}.ag-center-cols-container,.ag-pinned-right-cols-container{display:block}.ag-body-horizontal-scroll-container{height:100%}.ag-body-vertical-scroll-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container,.ag-full-width-container,.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{pointer-events:none;position:absolute;top:0}:where(.ag-ltr) .ag-floating-bottom-full-width-container,:where(.ag-ltr) .ag-floating-top-full-width-container,:where(.ag-ltr) .ag-full-width-container,:where(.ag-ltr) .ag-sticky-bottom-full-width-container,:where(.ag-ltr) .ag-sticky-top-full-width-container{left:0}:where(.ag-rtl) .ag-floating-bottom-full-width-container,:where(.ag-rtl) .ag-floating-top-full-width-container,:where(.ag-rtl) .ag-full-width-container,:where(.ag-rtl) .ag-sticky-bottom-full-width-container,:where(.ag-rtl) .ag-sticky-top-full-width-container{right:0}.ag-full-width-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container{display:inline-block;height:100%;overflow:hidden;width:100%}.ag-virtual-list-container{overflow:hidden}.ag-body{display:flex;flex:1 1 auto;flex-direction:row!important;min-height:0;position:relative}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:flex;min-height:0;min-width:0;position:relative;&:where(.ag-scrollbar-invisible){bottom:0;position:absolute;&:where(.ag-apple-scrollbar){opacity:0;transition:opacity .4s;visibility:hidden;&:where(.ag-scrollbar-scrolling,.ag-scrollbar-active){opacity:1;visibility:visible}}}}.ag-body-horizontal-scroll{width:100%;&:where(.ag-scrollbar-invisible){left:0;right:0}}.ag-body-vertical-scroll{height:100%;&:where(.ag-scrollbar-invisible){top:0;z-index:10}}:where(.ag-ltr) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){right:0}}:where(.ag-rtl) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){left:0}}.ag-force-vertical-scroll{overflow-y:scroll!important}.ag-horizontal-left-spacer,.ag-horizontal-right-spacer{height:100%;min-width:0;overflow-x:scroll;&:where(.ag-scroller-corner){overflow-x:hidden}}:where(.ag-row-animation) .ag-row{transition:transform .4s,top .4s,opacity .2s;&:where(.ag-after-created){transition:transform .4s,top .4s,height .4s,opacity .2s}}:where(.ag-row-animation.ag-prevent-animation) .ag-row{transition:none!important;&:where(.ag-row.ag-after-created){transition:none!important}}:where(.ag-row-no-animation) .ag-row{transition:none}.ag-row-loading{align-items:center;display:flex}.ag-row-position-absolute{position:absolute}.ag-row-position-relative{position:relative}.ag-full-width-row{overflow:hidden;pointer-events:all}.ag-row-inline-editing{z-index:1}.ag-row-dragging{z-index:2}.ag-stub-cell{align-items:center;display:flex}.ag-cell{display:inline-block;height:100%;position:absolute;white-space:nowrap;&:focus-visible{box-shadow:none}}.ag-cell-value{flex:1 1 auto}.ag-cell-value:not(.ag-allow-overflow),.ag-group-value{overflow:hidden;text-overflow:ellipsis}.ag-cell-wrap-text{white-space:normal;word-break:break-word}:where(.ag-cell) .ag-icon{display:inline-block;vertical-align:middle}.ag-floating-top{display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}:where(.ag-floating-top:not(.ag-invisible)){border-bottom:var(--ag-pinned-row-border)}.ag-floating-bottom{display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}:where(.ag-floating-bottom:not(.ag-invisible)){border-top:var(--ag-pinned-row-border)}.ag-sticky-bottom,.ag-sticky-top{background-color:var(--ag-data-background-color);display:flex;height:0;overflow:hidden;position:absolute;width:100%;z-index:1}.ag-opacity-zero{opacity:0!important}.ag-cell-label-container{align-items:center;display:flex;flex-direction:row-reverse;height:100%;justify-content:space-between;width:100%}:where(.ag-right-aligned-header){.ag-cell-label-container{flex-direction:row}.ag-header-cell-text{text-align:end}}.ag-column-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr){direction:ltr;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row}}:where(.ag-rtl){direction:rtl;text-align:right;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row-reverse}.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{display:block}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(180deg)}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(-180deg)}}.ag-measurement-container{height:0;overflow:hidden;visibility:hidden;width:0}.ag-measurement-element-border{display:inline-block;&:before{border-left:var(--ag-internal-measurement-border);content:"";display:block}}.ag-group{position:relative;width:100%}.ag-group-title-bar{align-items:center;display:flex;padding:var(--ag-spacing)}.ag-group-title{display:inline;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:where(.ag-group-title-bar) .ag-group-title{cursor:default}.ag-group-toolbar{align-items:center;display:flex;padding:var(--ag-spacing)}.ag-group-container{display:flex}.ag-disabled .ag-group-container{pointer-events:none}.ag-disabled-group-container,.ag-disabled-group-title-bar{opacity:.5}.ag-group-container-horizontal{flex-flow:row wrap}.ag-group-container-vertical{flex-direction:column}.ag-group-title-bar-icon{cursor:pointer;flex:none}:where(.ag-ltr) .ag-group-title-bar-icon{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-group-title-bar-icon{margin-left:var(--ag-spacing)}:where(.ag-group-item-alignment-stretch) .ag-group-item{align-items:stretch}:where(.ag-group-item-alignment-start) .ag-group-item{align-items:flex-start}:where(.ag-group-item-alignment-end) .ag-group-item{align-items:flex-end}:where(.ag-ltr) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-left:var(--ag-row-group-indent-size)}:where(.ag-rtl) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-right:var(--ag-row-group-indent-size)}:where(.ag-ltr) .ag-row-group-leaf-indent{margin-left:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}:where(.ag-rtl) .ag-row-group-leaf-indent{margin-right:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}.ag-value-change-delta{padding:0 2px}.ag-value-change-delta-up{color:var(--ag-value-change-delta-up-color)}.ag-value-change-delta-down{color:var(--ag-value-change-delta-down-color)}.ag-value-change-value{background-color:transparent;border-radius:1px;padding-left:1px;padding-right:1px;transition:background-color 1s}.ag-value-change-value-highlight{background-color:var(--ag-value-change-value-highlight-background-color);transition:background-color .1s}.ag-cell-data-changed{background-color:var(--ag-value-change-value-highlight-background-color)!important}.ag-cell-data-changed-animation{background-color:transparent}.ag-cell-highlight{background-color:var(--ag-range-selection-highlight-color)!important}.ag-row,.ag-spanned-row{color:var(--ag-cell-text-color);font-family:var(--ag-cell-font-family);font-size:var(--ag-data-font-size);white-space:nowrap;--ag-internal-content-line-height:calc(min(var(--ag-row-height), var(--ag-line-height, 1000px)) - var(--ag-internal-row-border-width, 1px) - 2px)}.ag-row{background-color:var(--ag-data-background-color);border-bottom:var(--ag-row-border);height:var(--ag-row-height);width:100%;&.ag-row-editing-invalid{background-color:var(--ag-full-row-edit-invalid-background-color)}}:where(.ag-body-vertical-content-no-gap>div>div>div,.ag-body-vertical-content-no-gap>div>div>div>div)>.ag-row-last{border-bottom-color:transparent}.ag-sticky-bottom{border-top:var(--ag-row-border);box-sizing:content-box!important}.ag-group-contracted,.ag-group-expanded{cursor:pointer}.ag-cell,.ag-full-width-row .ag-cell-wrapper.ag-row-group{border:1px solid transparent;line-height:var(--ag-internal-content-line-height);-webkit-font-smoothing:subpixel-antialiased}:where(.ag-ltr) .ag-cell{border-right:var(--ag-column-border)}:where(.ag-rtl) .ag-cell{border-left:var(--ag-column-border)}.ag-spanned-cell-wrapper{background-color:var(--ag-data-background-color);position:absolute}.ag-spanned-cell-wrapper>.ag-spanned-cell{display:block;position:relative}:where(.ag-ltr) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-right-color:transparent}:where(.ag-rtl) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-left-color:transparent}.ag-cell-wrapper{align-items:center;display:flex;>:where(:not(.ag-cell-value,.ag-group-value)){align-items:center;display:flex;height:var(--ag-internal-content-line-height)}&:where(.ag-row-group){align-items:flex-start}:where(.ag-full-width-row) &:where(.ag-row-group){align-items:center;height:100%}}:where(.ag-ltr) .ag-cell-wrapper{padding-left:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-rtl) .ag-cell-wrapper{padding-right:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-cell-wrap-text:not(.ag-cell-auto-height)) .ag-cell-wrapper{align-items:normal;height:100%;:where(.ag-cell-value){height:100%}}:where(.ag-ltr) .ag-row>.ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}:where(.ag-rtl) .ag-row>.ag-cell-wrapper.ag-row-group{padding-right:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-cell-focus:not(.ag-cell-range-selected):focus-within,.ag-cell-range-single-cell,.ag-cell-range-single-cell.ag-cell-range-handle,.ag-context-menu-open .ag-cell-focus:not(.ag-cell-range-selected),.ag-context-menu-open .ag-full-width-row.ag-row-focus .ag-cell-wrapper.ag-row-group,.ag-full-width-row.ag-row-focus:focus .ag-cell-wrapper.ag-row-group{border:1px solid;border-color:var(--ag-range-selection-border-color);border-style:var(--ag-range-selection-border-style);outline:initial}.ag-full-width-row.ag-row-focus:focus{box-shadow:none}:where(.ag-ltr) .ag-group-contracted,:where(.ag-ltr) .ag-group-expanded,:where(.ag-ltr) .ag-row-drag,:where(.ag-ltr) .ag-selection-checkbox{margin-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-group-contracted,:where(.ag-rtl) .ag-group-expanded,:where(.ag-rtl) .ag-row-drag,:where(.ag-rtl) .ag-selection-checkbox{margin-left:var(--ag-cell-widget-spacing)}:where(.ag-ltr) .ag-group-child-count{margin-left:3px}:where(.ag-rtl) .ag-group-child-count{margin-right:3px}.ag-row-highlight-above:after,.ag-row-highlight-below:after,.ag-row-highlight-inside:after{background-color:var(--ag-range-selection-border-color);content:"";height:1px;pointer-events:none;position:absolute;width:calc(100% - 1px)}:where(.ag-ltr) .ag-row-highlight-above:after,:where(.ag-ltr) .ag-row-highlight-below:after,:where(.ag-ltr) .ag-row-highlight-inside:after{left:1px}:where(.ag-rtl) .ag-row-highlight-above:after,:where(.ag-rtl) .ag-row-highlight-below:after,:where(.ag-rtl) .ag-row-highlight-inside:after{right:1px}.ag-row-highlight-above:after{top:0}.ag-row-highlight-below:after{bottom:0}.ag-row-highlight-indent:after{display:block;width:auto}:where(.ag-ltr) .ag-row-highlight-indent:after{left:calc((var(--ag-cell-widget-spacing) + var(--ag-icon-size))*2 + var(--ag-cell-horizontal-padding) + var(--ag-row-highlight-level)*var(--ag-row-group-indent-size));right:1px}:where(.ag-rtl) .ag-row-highlight-indent:after{left:1px;right:calc((var(--ag-cell-widget-spacing) + var(--ag-icon-size))*2 + var(--ag-cell-horizontal-padding) + var(--ag-row-highlight-level)*var(--ag-row-group-indent-size))}.ag-row-highlight-inside:after{background-color:var(--ag-selected-row-background-color);border:1px solid var(--ag-range-selection-border-color);display:block;height:auto;inset:0;width:auto}.ag-body,.ag-floating-bottom,.ag-floating-top{background-color:var(--ag-data-background-color)}.ag-row-odd{background-color:var(--ag-odd-row-background-color)}.ag-row-selected:before{background-color:var(--ag-selected-row-background-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-full-width-row.ag-row-group:before,.ag-row-hover:not(.ag-full-width-row):before{background-color:var(--ag-row-hover-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-row-selected:before{background-color:var(--ag-row-hover-color);background-image:linear-gradient(var(--ag-selected-row-background-color),var(--ag-selected-row-background-color))}.ag-row.ag-full-width-row.ag-row-group>*{position:relative}.ag-column-hover{background-color:var(--ag-column-hover-color)}.ag-header-range-highlight{background-color:var(--ag-range-header-highlight-color)}.ag-right-aligned-cell{font-variant-numeric:tabular-nums}:where(.ag-ltr) .ag-right-aligned-cell{text-align:right}:where(.ag-rtl) .ag-right-aligned-cell{text-align:left}.ag-right-aligned-cell .ag-cell-value,.ag-right-aligned-cell .ag-group-value{margin-left:auto}:where(.ag-ltr) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-ltr) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level));padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}:where(.ag-rtl) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-rtl) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-row>.ag-cell-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}.ag-row-dragging{cursor:move;opacity:.5}.ag-details-row{background-color:var(--ag-data-background-color);padding:calc(var(--ag-spacing)*3.75)}.ag-layout-auto-height,.ag-layout-print{.ag-center-cols-container,.ag-center-cols-viewport{min-height:150px}}.ag-overlay-loading-wrapper{background-color:var(--ag-modal-overlay-background-color)}.ag-skeleton-container{align-content:center;height:100%;width:100%}.ag-skeleton-effect{animation:ag-skeleton-loading 1.5s ease-in-out .5s infinite;background-color:var(--ag-row-loading-skeleton-effect-color);border-radius:.25rem;height:1em;width:100%}:where(.ag-ltr) .ag-right-aligned-cell .ag-skeleton-effect{margin-left:auto}:where(.ag-rtl) .ag-right-aligned-cell .ag-skeleton-effect{margin-right:auto}@keyframes ag-skeleton-loading{0%{background-color:var(--ag-row-loading-skeleton-effect-color)}50%{background-color:color-mix(in srgb,transparent,var(--ag-row-loading-skeleton-effect-color) 40%)}to{background-color:var(--ag-row-loading-skeleton-effect-color)}}.ag-loading{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-loading{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-loading{padding-right:var(--ag-cell-horizontal-padding)}:where(.ag-ltr) .ag-loading-icon{padding-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-loading-icon{padding-left:var(--ag-cell-widget-spacing)}.ag-icon-loading{animation-duration:1s;animation-iteration-count:infinite;animation-name:spin;animation-timing-function:linear}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.ag-header{background-color:var(--ag-header-background-color);border-bottom:var(--ag-header-row-border);color:var(--ag-header-text-color);display:flex;font-family:var(--ag-header-font-family);font-size:var(--ag-header-font-size);font-weight:var(--ag-header-font-weight);overflow:hidden;white-space:nowrap;width:100%}.ag-header-row{height:var(--ag-header-height);position:absolute}.ag-floating-filter-button-button,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,:where(.ag-header-cell-sortable) .ag-header-cell-label{cursor:pointer}:where(.ag-ltr) .ag-header-expand-icon{margin-left:4px}:where(.ag-rtl) .ag-header-expand-icon{margin-right:4px}.ag-header-row:where(:not(:first-child)){:where(.ag-header-cell:not(.ag-header-span-height.ag-header-span-total,.ag-header-parent-hidden),.ag-header-group-cell.ag-header-group-cell-with-group){border-top:var(--ag-header-row-border)}}.ag-header-row:where(:not(.ag-header-row-column-group)){overflow:hidden}:where(.ag-header.ag-header-allow-overflow) .ag-header-row{overflow:visible}.ag-header-cell{display:inline-flex;overflow:hidden}.ag-header-group-cell{contain:paint;display:flex}.ag-header-cell,.ag-header-group-cell{align-items:center;gap:var(--ag-cell-widget-spacing);height:100%;padding:0 var(--ag-cell-horizontal-padding);position:absolute}@property --ag-internal-moving-color{syntax:"<color>";inherits:false;initial-value:transparent}@property --ag-internal-hover-color{syntax:"<color>";inherits:false;initial-value:transparent}.ag-header-cell:where(:not(.ag-floating-filter)),.ag-header-group-cell{&:before{background-image:linear-gradient(var(--ag-internal-hover-color),var(--ag-internal-hover-color)),linear-gradient(var(--ag-internal-moving-color),var(--ag-internal-moving-color));content:"";inset:0;position:absolute;--ag-internal-moving-color:transparent;--ag-internal-hover-color:transparent;transition:--ag-internal-moving-color var(--ag-header-cell-background-transition-duration),--ag-internal-hover-color var(--ag-header-cell-background-transition-duration)}&:where(:hover):before{--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}&:where(.ag-header-cell-moving):before{--ag-internal-moving-color:var(--ag-header-cell-moving-background-color);--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}}:where(.ag-header-cell:not(.ag-floating-filter) *,.ag-header-group-cell *){position:relative;z-index:1}.ag-header-cell-menu-button:where(:not(.ag-header-menu-always-show)){opacity:0;transition:opacity .2s}.ag-header-cell-filter-button,:where(.ag-header-cell.ag-header-active) .ag-header-cell-menu-button{opacity:1}.ag-header-cell-label,.ag-header-group-cell-label{align-items:center;align-self:stretch;display:flex;flex:1 1 auto;overflow:hidden;padding:5px 0}:where(.ag-ltr) .ag-sort-indicator-icon{padding-left:var(--ag-spacing)}:where(.ag-rtl) .ag-sort-indicator-icon{padding-right:var(--ag-spacing)}.ag-header-cell-label{text-overflow:ellipsis}.ag-header-group-cell-label.ag-sticky-label{flex:none;max-width:100%;overflow:visible;position:sticky}:where(.ag-ltr) .ag-header-group-cell-label.ag-sticky-label{left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-header-group-cell-label.ag-sticky-label{right:var(--ag-cell-horizontal-padding)}.ag-header-cell-text,.ag-header-group-text{overflow:hidden;text-overflow:ellipsis}.ag-header-cell-text{word-break:break-word}.ag-header-cell-comp-wrapper{width:100%}:where(.ag-header-group-cell) .ag-header-cell-comp-wrapper{display:flex}:where(.ag-header-cell:not(.ag-header-cell-auto-height)) .ag-header-cell-comp-wrapper{align-items:center;display:flex;height:100%}.ag-header-cell-wrap-text .ag-header-cell-comp-wrapper{white-space:normal}.ag-header-cell-comp-wrapper-limited-height>*{overflow:hidden}:where(.ag-right-aligned-header) .ag-header-cell-label{flex-direction:row-reverse}:where(.ag-ltr) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-ltr) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}.ag-header-cell:after,.ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{content:"";height:var(--ag-header-column-border-height);position:absolute;top:calc(50% - var(--ag-header-column-border-height)*.5);z-index:1}:where(.ag-ltr) .ag-header-cell:after,:where(.ag-ltr) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-right:var(--ag-header-column-border);right:0}:where(.ag-rtl) .ag-header-cell:after,:where(.ag-rtl) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-left:var(--ag-header-column-border);left:0}.ag-header-highlight-after:after,.ag-header-highlight-before:after{background-color:var(--ag-accent-color);content:"";height:100%;position:absolute;width:1px}:where(.ag-ltr) .ag-header-highlight-before:after{left:0}:where(.ag-rtl) .ag-header-highlight-before:after{right:0}:where(.ag-ltr) .ag-header-highlight-after:after{right:0;:where(.ag-pinned-left-header) &{right:1px}}:where(.ag-rtl) .ag-header-highlight-after:after{left:0;:where(.ag-pinned-left-header) &{left:1px}}.ag-header-cell-resize{align-items:center;cursor:ew-resize;display:flex;height:100%;position:absolute;top:0;width:8px;z-index:2;&:after{background-color:var(--ag-header-column-resize-handle-color);content:"";height:var(--ag-header-column-resize-handle-height);position:absolute;top:calc(50% - var(--ag-header-column-resize-handle-height)*.5);width:var(--ag-header-column-resize-handle-width);z-index:1}}:where(.ag-ltr) .ag-header-cell-resize{right:-3px;&:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-rtl) .ag-header-cell-resize{left:-3px;&:after{right:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-header-cell.ag-header-span-height) .ag-header-cell-resize:after{height:calc(100% - var(--ag-spacing)*4);top:calc(var(--ag-spacing)*2)}.ag-header-group-cell-no-group:where(.ag-header-span-height){display:none}.ag-sort-indicator-container{display:flex;gap:var(--ag-spacing)}.ag-layout-print{&.ag-body{display:block;height:unset}&.ag-root-wrapper{display:inline-block}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:none}&.ag-force-vertical-scroll{overflow-y:visible!important}}@media print{.ag-root-wrapper.ag-layout-print{display:table;.ag-body-horizontal-scroll-viewport,.ag-body-viewport,.ag-center-cols-container,.ag-center-cols-viewport,.ag-root,.ag-root-wrapper-body,.ag-virtual-list-viewport{display:block!important;height:auto!important;overflow:hidden!important}.ag-cell,.ag-row{-moz-column-break-inside:avoid;break-inside:avoid}}}ag-grid,ag-grid-angular{display:block}.ag-root-wrapper{border:var(--ag-wrapper-border);border-radius:var(--ag-wrapper-border-radius);display:flex;flex-direction:column;overflow:hidden;position:relative;&.ag-layout-normal{height:100%}}.ag-root-wrapper-body{display:flex;flex-direction:row;&.ag-layout-normal{flex:1 1 auto;height:0;min-height:0}}.ag-root{display:flex;flex-direction:column;position:relative;&.ag-layout-auto-height,&.ag-layout-normal{flex:1 1 auto;overflow:hidden;width:0}&.ag-layout-normal{height:100%}}.ag-virtual-list-item{height:var(--ag-list-item-height);position:absolute;width:100%}.ag-list-item-hovered:after{background-color:var(--ag-accent-color);content:"";height:1px;left:0;position:absolute;right:0}.ag-item-highlight-top:after{top:0}.ag-item-highlight-bottom:after{bottom:0}.ag-drag-handle{color:var(--ag-drag-handle-color);cursor:grab;:where(.ag-icon){color:var(--ag-drag-handle-color)}}.ag-chart-menu-icon,.ag-chart-settings-next,.ag-chart-settings-prev,.ag-column-group-icons,.ag-column-select-header-icon,.ag-filter-toolpanel-expand,.ag-floating-filter-button-button,.ag-group-title-bar-icon,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,.ag-panel-title-bar-button-icon,.ag-set-filter-group-icons,:where(.ag-group-contracted) .ag-icon,:where(.ag-group-expanded) .ag-icon{background-color:var(--ag-icon-button-background-color);border-radius:var(--ag-icon-button-border-radius);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-background-color);color:var(--ag-icon-button-color);&:hover{background-color:var(--ag-icon-button-hover-background-color);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-hover-background-color);color:var(--ag-icon-button-hover-color)}}.ag-filter-active{background-image:linear-gradient(var(--ag-icon-button-active-background-color),var(--ag-icon-button-active-background-color));border-radius:1px;outline:solid var(--ag-icon-button-background-spread) var(--ag-icon-button-active-background-color);position:relative;&:after{background-color:var(--ag-icon-button-active-indicator-color);border-radius:50%;content:"";height:6px;position:absolute;top:-1px;width:6px}:where(.ag-icon-filter){clip-path:path("M8,0C8,4.415 11.585,8 16,8L16,16L0,16L0,0L8,0Z");color:var(--ag-icon-button-active-color)}}:where(.ag-ltr) .ag-filter-active{&:after{right:-1px}}:where(.ag-rtl) .ag-filter-active{&:after{left:-1px}}.ag-menu{background-color:var(--ag-menu-background-color);border:var(--ag-menu-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-menu-shadow);color:var(--ag-menu-text-color);max-height:100%;overflow-y:auto;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}',qG={wrapperBorder:!0,rowBorder:!0,headerRowBorder:!0,footerRowBorder:{ref:"rowBorder"},columnBorder:{style:"solid",width:1,color:"transparent"},headerColumnBorder:!1,headerColumnBorderHeight:"100%",pinnedColumnBorder:!0,pinnedRowBorder:!0,sidePanelBorder:!0,sideBarPanelWidth:250,sideBarBackgroundColor:{ref:"chromeBackgroundColor"},sideButtonBarBackgroundColor:{ref:"sideBarBackgroundColor"},sideButtonBarTopPadding:0,sideButtonSelectedUnderlineWidth:2,sideButtonSelectedUnderlineColor:"transparent",sideButtonSelectedUnderlineTransitionDuration:0,sideButtonBackgroundColor:"transparent",sideButtonTextColor:{ref:"textColor"},sideButtonHoverBackgroundColor:{ref:"sideButtonBackgroundColor"},sideButtonHoverTextColor:{ref:"sideButtonTextColor"},sideButtonSelectedBackgroundColor:yi,sideButtonSelectedTextColor:{ref:"sideButtonTextColor"},sideButtonBorder:"solid 1px transparent",sideButtonSelectedBorder:!0,sideButtonLeftPadding:{ref:"spacing"},sideButtonRightPadding:{ref:"spacing"},sideButtonVerticalPadding:{calc:"spacing * 3"},headerBackgroundColor:{ref:"chromeBackgroundColor"},headerFontFamily:{ref:"fontFamily"},cellFontFamily:{ref:"fontFamily"},headerFontWeight:500,headerFontSize:{ref:"fontSize"},dataFontSize:{ref:"fontSize"},headerTextColor:{ref:"textColor"},headerCellHoverBackgroundColor:"transparent",headerCellMovingBackgroundColor:{ref:"headerCellHoverBackgroundColor"},headerCellBackgroundTransitionDuration:"0.2s",cellTextColor:{ref:"textColor"},rangeSelectionBorderStyle:"solid",rangeSelectionBorderColor:Wt,rangeSelectionBackgroundColor:Zi(.2),rangeSelectionChartBackgroundColor:"#0058FF1A",rangeSelectionChartCategoryBackgroundColor:"#00FF841A",rangeSelectionHighlightColor:Zi(.5),rangeHeaderHighlightColor:E9(.08),rowNumbersSelectedColor:Zi(.5),rowHoverColor:Zi(.08),columnHoverColor:Zi(.05),selectedRowBackgroundColor:Zi(.12),modalOverlayBackgroundColor:{ref:"backgroundColor",mix:.66},dataBackgroundColor:yi,oddRowBackgroundColor:{ref:"dataBackgroundColor"},wrapperBorderRadius:8,cellHorizontalPadding:{calc:"spacing * 2 * cellHorizontalPaddingScale"},cellWidgetSpacing:{calc:"spacing * 1.5"},cellHorizontalPaddingScale:1,rowGroupIndentSize:{calc:"cellWidgetSpacing + iconSize"},valueChangeDeltaUpColor:"#43a047",valueChangeDeltaDownColor:"#e53935",valueChangeValueHighlightBackgroundColor:"#16a08580",rowHeight:{calc:"max(iconSize, dataFontSize) + spacing * 3.25 * rowVerticalPaddingScale"},rowVerticalPaddingScale:1,headerHeight:{calc:"max(iconSize, dataFontSize) + spacing * 4 * headerVerticalPaddingScale"},headerVerticalPaddingScale:1,paginationPanelHeight:{ref:"rowHeight",calc:"max(rowHeight, 22px)"},dragHandleColor:vn(.7),headerColumnResizeHandleHeight:"30%",headerColumnResizeHandleWidth:2,headerColumnResizeHandleColor:{ref:"borderColor"},widgetContainerHorizontalPadding:{calc:"spacing * 1.5"},widgetContainerVerticalPadding:{calc:"spacing * 1.5"},widgetHorizontalSpacing:{calc:"spacing * 1.5"},widgetVerticalSpacing:{ref:"spacing"},iconButtonColor:{ref:"iconColor"},iconButtonBackgroundColor:"transparent",iconButtonBackgroundSpread:4,iconButtonBorderRadius:1,iconButtonHoverColor:{ref:"iconButtonColor"},iconButtonHoverBackgroundColor:vn(.1),iconButtonActiveColor:Wt,iconButtonActiveBackgroundColor:Zi(.28),iconButtonActiveIndicatorColor:Wt,menuBorder:{color:vn(.2)},menuBackgroundColor:bi(.03),menuTextColor:bi(.95),menuShadow:{ref:"popupShadow"},menuSeparatorColor:{ref:"borderColor"},setFilterIndentSize:{ref:"iconSize"},chartMenuPanelWidth:260,chartMenuLabelColor:vn(.8),dialogShadow:{ref:"popupShadow"},cellEditingBorder:{color:Wt},cellEditingShadow:{ref:"cardShadow"},fullRowEditInvalidBackgroundColor:{ref:"invalidColor",onto:"backgroundColor",mix:.25},dialogBorder:{color:vn(.2)},panelBackgroundColor:yi,panelTitleBarHeight:{ref:"headerHeight"},panelTitleBarBackgroundColor:{ref:"headerBackgroundColor"},panelTitleBarIconColor:{ref:"headerTextColor"},panelTitleBarTextColor:{ref:"headerTextColor"},panelTitleBarFontWeight:{ref:"headerFontWeight"},panelTitleBarBorder:!0,columnSelectIndentSize:{ref:"iconSize"},toolPanelSeparatorBorder:!0,columnDropCellBackgroundColor:vn(.07),columnDropCellTextColor:{ref:"textColor"},columnDropCellDragHandleColor:{ref:"textColor"},columnDropCellBorder:{color:vn(.13)},selectCellBackgroundColor:vn(.07),selectCellBorder:{color:vn(.13)},advancedFilterBuilderButtonBarBorder:!0,advancedFilterBuilderIndentSize:{calc:"spacing * 2 + iconSize"},advancedFilterBuilderJoinPillColor:"#f08e8d",advancedFilterBuilderColumnPillColor:"#a6e194",advancedFilterBuilderOptionPillColor:"#f3c08b",advancedFilterBuilderValuePillColor:"#85c0e4",filterPanelApplyButtonColor:yi,filterPanelApplyButtonBackgroundColor:Wt,filterPanelCardSubtleColor:{ref:"textColor",mix:.7},filterPanelCardSubtleHoverColor:{ref:"textColor"},findMatchColor:al,findMatchBackgroundColor:"#ffff00",findActiveMatchColor:al,findActiveMatchBackgroundColor:"#ffa500",filterToolPanelGroupIndent:{ref:"spacing"},rowLoadingSkeletonEffectColor:vn(.15),statusBarLabelColor:al,statusBarLabelFontWeight:500,statusBarValueColor:al,statusBarValueFontWeight:500,pinnedSourceRowTextColor:{ref:"textColor"},pinnedSourceRowBackgroundColor:{ref:"dataBackgroundColor"},pinnedSourceRowFontWeight:600,pinnedRowFontWeight:600,pinnedRowBackgroundColor:{ref:"dataBackgroundColor"},pinnedRowTextColor:{ref:"textColor"}},$G=".ag-cell-batch-edit{background-color:var(--ag-cell-batch-edit-background-color);color:var(--ag-cell-batch-edit-text-color);display:inherit}.ag-row-batch-edit{background-color:var(--ag-row-batch-edit-background-color);color:var(--ag-row-batch-edit-text-color)}",QP={cellBatchEditBackgroundColor:"rgba(220 181 139 / 16%)",cellBatchEditTextColor:"#422f00",rowBatchEditBackgroundColor:{ref:"cellBatchEditBackgroundColor"},rowBatchEditTextColor:{ref:"cellBatchEditTextColor"}},jG=z(b({},QP),{cellBatchEditTextColor:"#f3d0b3"}),KG=()=>on({feature:"batchEditStyle",params:QP,css:$G}),YG=KG(),ZP=":where(.ag-button){background:none;border:none;color:inherit;cursor:pointer;font-family:inherit;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0;text-indent:inherit;text-shadow:inherit;text-transform:inherit;word-spacing:inherit;&:disabled{cursor:default}&:focus-visible{box-shadow:var(--ag-focus-shadow);outline:none}}.ag-standard-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:var(--ag-button-background-color);border:var(--ag-button-border);border-radius:var(--ag-button-border-radius);color:var(--ag-button-text-color);cursor:pointer;font-weight:var(--ag-button-font-weight);padding:var(--ag-button-vertical-padding) var(--ag-button-horizontal-padding);&:hover{background-color:var(--ag-button-hover-background-color);border:var(--ag-button-hover-border);color:var(--ag-button-hover-text-color)}&:active{background-color:var(--ag-button-active-background-color);border:var(--ag-button-active-border);color:var(--ag-button-active-text-color)}&:disabled{background-color:var(--ag-button-disabled-background-color);border:var(--ag-button-disabled-border);color:var(--ag-button-disabled-text-color)}}",eD={buttonTextColor:"inherit",buttonFontWeight:"normal",buttonBackgroundColor:"transparent",buttonBorder:!1,buttonBorderRadius:{ref:"borderRadius"},buttonHorizontalPadding:{calc:"spacing * 2"},buttonVerticalPadding:{ref:"spacing"},buttonHoverTextColor:{ref:"buttonTextColor"},buttonHoverBackgroundColor:{ref:"buttonBackgroundColor"},buttonHoverBorder:{ref:"buttonBorder"},buttonActiveTextColor:{ref:"buttonHoverTextColor"},buttonActiveBackgroundColor:{ref:"buttonHoverBackgroundColor"},buttonActiveBorder:{ref:"buttonHoverBorder"},buttonDisabledTextColor:{ref:"inputDisabledTextColor"},buttonDisabledBackgroundColor:{ref:"inputDisabledBackgroundColor"},buttonDisabledBorder:{ref:"inputDisabledBorder"}};var XG=()=>on({feature:"buttonStyle",params:z(b({},eD),{buttonBackgroundColor:yi,buttonBorder:!0,buttonHoverBackgroundColor:{ref:"rowHoverColor"},buttonActiveBorder:{color:Wt}}),css:ZP}),JG=XG(),QG=()=>on({feature:"buttonStyle",params:z(b({},eD),{buttonBackgroundColor:yi,buttonBorder:{color:Wt},buttonFontWeight:600,buttonTextColor:Wt,buttonHoverBackgroundColor:{ref:"rowHoverColor"},buttonActiveBackgroundColor:Wt,buttonActiveTextColor:yi}),css:ZP}),ZG=QG();var ez=".ag-column-drop-vertical-empty-message{align-items:center;border:dashed var(--ag-border-width);border-color:var(--ag-border-color);display:flex;inset:0;justify-content:center;margin:calc(var(--ag-spacing)*1.5) calc(var(--ag-spacing)*2);overflow:hidden;padding:calc(var(--ag-spacing)*2);position:absolute}";var tz=()=>on({feature:"columnDropStyle",css:ez}),Ew=tz();var iz={warn:(...e)=>{W(e[0],e[1])},error:(...e)=>{tt(e[0],e[1])},preInitErr:(...e)=>{ed(e[0],e[2],e[1])}},tD=()=>L9(iz).withParams(qG).withPart(JG).withPart(Ew).withPart(YG),nz='.ag-checkbox-input-wrapper,.ag-radio-button-input-wrapper{background-color:var(--ag-checkbox-unchecked-background-color);border:solid var(--ag-checkbox-border-width) var(--ag-checkbox-unchecked-border-color);flex:none;height:var(--ag-icon-size);position:relative;width:var(--ag-icon-size);:where(input){-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:block;height:var(--ag-icon-size);margin:0;opacity:0;width:var(--ag-icon-size)}&:after{content:"";display:block;inset:0;-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;pointer-events:none;position:absolute}&:where(.ag-checked){background-color:var(--ag-checkbox-checked-background-color);border-color:var(--ag-checkbox-checked-border-color);&:after{background-color:var(--ag-checkbox-checked-shape-color)}}&:where(:focus-within,:active){box-shadow:var(--ag-focus-shadow)}&:where(.ag-disabled){filter:grayscale();opacity:.5}}.ag-checkbox-input-wrapper{border-radius:var(--ag-checkbox-border-radius);&:where(.ag-checked):after{-webkit-mask-image:var(--ag-checkbox-checked-shape-image);mask-image:var(--ag-checkbox-checked-shape-image)}&:where(.ag-indeterminate){background-color:var(--ag-checkbox-indeterminate-background-color);border-color:var(--ag-checkbox-indeterminate-border-color);&:after{background-color:var(--ag-checkbox-indeterminate-shape-color);-webkit-mask-image:var(--ag-checkbox-indeterminate-shape-image);mask-image:var(--ag-checkbox-indeterminate-shape-image)}}}.ag-cell-editing-error .ag-checkbox-input-wrapper:focus-within{box-shadow:var(--ag-focus-error-shadow)}.ag-radio-button-input-wrapper{border-radius:100%;&:where(.ag-checked):after{-webkit-mask-image:var(--ag-radio-checked-shape-image);mask-image:var(--ag-radio-checked-shape-image)}}',oz=()=>on({feature:"checkboxStyle",params:{checkboxBorderWidth:1,checkboxBorderRadius:{ref:"borderRadius"},checkboxUncheckedBackgroundColor:yi,checkboxUncheckedBorderColor:bi(.3),checkboxCheckedBackgroundColor:Wt,checkboxCheckedBorderColor:{ref:"checkboxCheckedBackgroundColor"},checkboxCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="7" fill="none"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75" d="M1 3.5 3.5 6l5-5"/></svg>'},checkboxCheckedShapeColor:yi,checkboxIndeterminateBackgroundColor:bi(.3),checkboxIndeterminateBorderColor:{ref:"checkboxIndeterminateBackgroundColor"},checkboxIndeterminateShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="2" fill="none"><rect width="10" height="2" fill="#000" rx="1"/></svg>'},checkboxIndeterminateShapeColor:yi,radioCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="6" height="6" fill="none"><circle cx="3" cy="3" r="3" fill="#000"/></svg>'}},css:nz}),iD=oz();var nD=()=>z(b(b({},zp),jG),{backgroundColor:"hsl(217, 0%, 17%)",foregroundColor:"#FFF",chromeBackgroundColor:bi(.05),rowHoverColor:Zi(.15),selectedRowBackgroundColor:Zi(.2),menuBackgroundColor:bi(.1),browserColorScheme:"dark",popupShadow:"0 0px 20px #000A",cardShadow:"0 1px 4px 1px #000A",advancedFilterBuilderJoinPillColor:"#7a3a37",advancedFilterBuilderColumnPillColor:"#355f2d",advancedFilterBuilderOptionPillColor:"#5a3168",advancedFilterBuilderValuePillColor:"#374c86",filterPanelApplyButtonColor:al,findMatchColor:yi,findActiveMatchColor:yi,checkboxUncheckedBorderColor:bi(.4),toggleButtonOffBackgroundColor:bi(.4),rowBatchEditBackgroundColor:bi(.1)});var rz=()=>z(b({},nD()),{backgroundColor:"#1f2836"});var sz=()=>on({feature:"colorScheme",params:zp,modeParams:{light:zp,dark:nD(),"dark-blue":rz()}}),oD=sz();var az=`.ag-icon-aggregation:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M24 6H8v2l8 8-8 8v2h16v-2H11l8-8-8-8h13z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-arrows:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M7.515 11.171 2.687 16l4.828 4.829-1.414 1.414L-.142 16l6.243-6.243zm16.97 0 1.414-1.414L32.142 16l-6.243 6.243-1.414-1.414L29.313 16zM16.028 13.2l2.829 2.828-2.829 2.829-2.828-2.829zm-4.857 11.285L16 29.313l4.829-4.828 1.414 1.414L16 32.142l-6.243-6.243zm0-16.97L9.757 6.101 16-.142l6.243 6.243-1.414 1.414L16 2.687z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-asc:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m5.333 16 1.88 1.88 7.453-7.44v16.227h2.667V10.44l7.44 7.453L26.666 16 15.999 5.333 5.332 16z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-cancel:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M16 2.667A13.32 13.32 0 0 0 2.667 16c0 7.373 5.96 13.333 13.333 13.333S29.333 23.373 29.333 16 23.373 2.667 16 2.667m6.667 18.12-1.88 1.88L16 17.88l-4.787 4.787-1.88-1.88L14.12 16l-4.787-4.787 1.88-1.88L16 14.12l4.787-4.787 1.88 1.88L17.88 16z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-chart:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Ctitle%3Echart%3C/title%3E%3Cg fill='%23000' fill-rule='nonzero'%3E%3Cpath d='M14 7h4v18h-4zM8 17h4v8H8zM20 13h4v12h-4z'/%3E%3C/g%3E%3C/svg%3E")}.ag-icon-color-picker:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M23.907 17.587 10.574 4.254l-1.88 1.88 3.173 3.173-8.28 8.28 10.16 10.16zm-16.547 0 6.387-6.387 6.387 6.387zm18.387 2s-2.667 2.893-2.667 4.667c0 1.467 1.2 2.667 2.667 2.667s2.667-1.2 2.667-2.667c0-1.773-2.667-4.667-2.667-4.667' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-columns:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M26 25H6V7h20zM12 11H8v12h4zm6 0h-4v12h4zm6 12V11h-4v12z' style='fill-rule:nonzero' transform='translate(0 -1)'/%3E%3C/svg%3E")}.ag-icon-contracted:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m12 6 10 10-10 10-2-2 8-8-8-8z'/%3E%3C/svg%3E")}.ag-icon-copy:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M22 1.333H6A2.675 2.675 0 0 0 3.333 4v18.667H6V4h16zm4 5.334H11.333a2.675 2.675 0 0 0-2.667 2.667v18.667c0 1.467 1.2 2.667 2.667 2.667H26c1.467 0 2.667-1.2 2.667-2.667V9.334c0-1.467-1.2-2.667-2.667-2.667M26 28H11.333V9.333H26z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-cross:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M15.984 13.894 27.05 2.828l2.122 2.122-11.066 11.066 11.066 11.066-2.122 2.12-11.066-11.066L4.918 29.202l-2.12-2.12 11.066-11.066L2.798 4.95l2.12-2.122z'/%3E%3C/svg%3E")}.ag-icon-csv:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M384 131.9c-7.753-8.433-110.425-128.473-114.9-133L48-.1C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48zm-35.9 2.1H257V27.9zM30 479V27h200l1 105c0 13.3-1.3 29 12 29h111l1 318z' style='fill-rule:nonzero' transform='translate(3.934 -.054)scale(.06285)'/%3E%3Cpath d='M.688-.226a.2.2 0 0 1-.017.074.28.28 0 0 1-.145.14.412.412 0 0 1-.234.013.28.28 0 0 1-.202-.168.468.468 0 0 1-.04-.19q0-.086.025-.155a.319.319 0 0 1 .182-.191.4.4 0 0 1 .134-.025q.087 0 .155.035a.3.3 0 0 1 .104.085.17.17 0 0 1 .036.097.06.06 0 0 1-.018.044.06.06 0 0 1-.042.019.06.06 0 0 1-.042-.013.2.2 0 0 1-.031-.046.2.2 0 0 0-.066-.079.16.16 0 0 0-.095-.027.17.17 0 0 0-.142.068.3.3 0 0 0-.053.193.4.4 0 0 0 .023.139.2.2 0 0 0 .067.083.2.2 0 0 0 .1.027q.063 0 .106-.031a.2.2 0 0 0 .065-.091.2.2 0 0 1 .023-.046q.014-.018.044-.018a.06.06 0 0 1 .044.018.06.06 0 0 1 .019.045' style='fill-rule:nonzero' transform='matrix(8.39799 0 0 12.455 7.122 25.977)'/%3E%3Cpath d='M.622-.215a.2.2 0 0 1-.033.117.23.23 0 0 1-.098.081.4.4 0 0 1-.153.029.34.34 0 0 1-.175-.04.23.23 0 0 1-.079-.077.17.17 0 0 1-.031-.093q0-.027.019-.045a.06.06 0 0 1 .046-.019.06.06 0 0 1 .039.014.1.1 0 0 1 .027.044.3.3 0 0 0 .03.057q.015.023.044.038.03.015.076.015.065 0 .105-.03a.09.09 0 0 0 .04-.075.08.08 0 0 0-.022-.058.14.14 0 0 0-.056-.034 1 1 0 0 0-.092-.025.7.7 0 0 1-.129-.042.2.2 0 0 1-.083-.066.17.17 0 0 1-.03-.104q0-.058.032-.105a.2.2 0 0 1 .093-.07.4.4 0 0 1 .144-.025q.066 0 .114.016a.3.3 0 0 1 .08.044.2.2 0 0 1 .046.057q.015.03.015.058a.07.07 0 0 1-.018.046.06.06 0 0 1-.046.021q-.025 0-.038-.012a.2.2 0 0 1-.028-.041.2.2 0 0 0-.047-.063Q.387-.625.326-.625a.15.15 0 0 0-.09.025q-.035.024-.035.059 0 .021.012.037a.1.1 0 0 0 .032.027.4.4 0 0 0 .111.036q.06.015.11.031.048.018.083.042a.2.2 0 0 1 .054.062.2.2 0 0 1 .019.091' style='fill-rule:nonzero' transform='matrix(8.39799 0 0 12.455 13.339 25.977)'/%3E%3Cpath d='m.184-.633.162.48.163-.483q.013-.038.019-.053a.062.062 0 0 1 .061-.039q.018 0 .034.009a.1.1 0 0 1 .025.025q.009.015.009.031L.654-.64l-.007.025-.009.024-.173.468-.019.051a.2.2 0 0 1-.021.042.1.1 0 0 1-.033.03.1.1 0 0 1-.049.012.1.1 0 0 1-.05-.011A.1.1 0 0 1 .26-.03a.2.2 0 0 1-.021-.042L.22-.123.05-.587.041-.612.033-.638.03-.662q0-.025.02-.046a.07.07 0 0 1 .05-.02q.037 0 .053.023.015.023.031.072' style='fill-rule:nonzero' transform='matrix(8.39799 0 0 12.455 18.94 25.977)'/%3E%3C/svg%3E")}.ag-icon-cut:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M13.775 15.198 3.835 2.945a1.501 1.501 0 0 1 2.33-1.89l14.997 18.488A6.003 6.003 0 0 1 29.657 25c0 3.311-2.688 6-6 6s-6-2.689-6-6c0-1.335.437-2.569 1.176-3.566l-3.127-3.855-3.001 3.7A5.97 5.97 0 0 1 14 25c0 3.311-2.689 6-6 6s-6-2.689-6-6a6.003 6.003 0 0 1 8.315-5.536zm9.882 6.702a3.1 3.1 0 0 0-3.1 3.1c0 1.711 1.389 3.1 3.1 3.1s3.1-1.389 3.1-3.1-1.389-3.1-3.1-3.1M8 21.95a3.05 3.05 0 1 0 .001 6.101A3.05 3.05 0 0 0 8 21.95m9.63-11.505 1.932 2.381 8.015-9.881a1.5 1.5 0 0 0-2.329-1.89z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-desc:before,.ag-icon-down:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m26.667 16-1.88-1.88-7.453 7.44V5.333h-2.667V21.56l-7.44-7.453L5.334 16l10.667 10.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-excel:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M384 131.9c-7.753-8.433-110.425-128.473-114.9-133L48-.1C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48zm-35.9 2.1H257V27.9zM30 479V27h200l1 105c0 13.3-1.3 29 12 29h111l1 318z' style='fill-rule:nonzero' transform='translate(3.934 -.054)scale(.06285)'/%3E%3Cpath d='m.052-.139.16-.234-.135-.208a.4.4 0 0 1-.028-.052.1.1 0 0 1-.01-.042.05.05 0 0 1 .018-.037.07.07 0 0 1 .045-.016q.03 0 .047.018a1 1 0 0 1 .047.066l.107.174.115-.174.024-.038.019-.026.021-.015a.1.1 0 0 1 .027-.005.06.06 0 0 1 .044.016.05.05 0 0 1 .018.039q0 .033-.038.089l-.141.211.152.234a.3.3 0 0 1 .03.051.1.1 0 0 1 .009.038.1.1 0 0 1-.008.031.1.1 0 0 1-.024.023.1.1 0 0 1-.034.008.1.1 0 0 1-.035-.008.1.1 0 0 1-.023-.022L.427-.067.301-.265l-.134.204-.022.034-.016.019a.1.1 0 0 1-.022.015.1.1 0 0 1-.03.005.06.06 0 0 1-.044-.016.06.06 0 0 1-.017-.047q0-.036.036-.088' style='fill-rule:nonzero' transform='matrix(17.82892 0 0 16.50777 10.371 25.928)'/%3E%3C/svg%3E")}.ag-icon-expanded:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M20 26 10 16 20 6l2 2-8 8 8 8z'/%3E%3C/svg%3E")}.ag-icon-eye-slash:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Ctitle%3Eeye-slash%3C/title%3E%3Cpath fill='%23000' fill-rule='nonzero' d='M8.95 10.364 7 8.414 8.414 7l2.32 2.32A13.2 13.2 0 0 1 16.5 8c5.608 0 10.542 3.515 12.381 8.667L29 17l-.119.333a13 13 0 0 1-4.255 5.879l1.466 1.466-1.414 1.414-1.754-1.753A13.2 13.2 0 0 1 16.5 26c-5.608 0-10.542-3.515-12.381-8.667L4 17l.119-.333a13 13 0 0 1 4.83-6.303m1.445 1.445A11.02 11.02 0 0 0 6.148 17c1.646 4.177 5.728 7 10.352 7 1.76 0 3.441-.409 4.94-1.146l-1.878-1.878A5.06 5.06 0 0 1 16.5 22c-2.789 0-5.05-2.239-5.05-5 0-1.158.398-2.223 1.065-3.07zm1.855-.974 1.794 1.795A5.07 5.07 0 0 1 16.5 12c2.789 0 5.05 2.239 5.05 5 0 .9-.24 1.745-.661 2.474l2.305 2.306A11 11 0 0 0 26.852 17c-1.646-4.177-5.728-7-10.352-7-1.495 0-2.933.295-4.25.835'/%3E%3C/svg%3E")}.ag-icon-eye:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M16.5 23c4.624 0 8.706-2.823 10.352-7-1.646-4.177-5.728-7-10.352-7s-8.706 2.823-10.352 7c1.646 4.177 5.728 7 10.352 7M4.119 15.667C5.958 10.515 10.892 7 16.5 7s10.542 3.515 12.381 8.667L29 16l-.119.333C27.042 21.485 22.108 25 16.5 25S5.958 21.485 4.119 16.333L4 16zM16.5 21c2.789 0 5.049-2.239 5.049-5s-2.26-5-5.049-5-5.049 2.239-5.049 5 2.26 5 5.049 5' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-filter:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m28 8-8 8v5l-6 6V16L6 8V6h22zM9 8l7 7v7l2-2v-5l7-7z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-first:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M24.273 22.12 18.153 16l6.12-6.12L22.393 8l-8 8 8 8zM7.727 8h2.667v16H7.727z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-group:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M14 7v1H9V7zm0-3v1H5.001V4zm-7 7H5v-1h2zm0-3H5V7h2zM3 5H1V4h2zm11 5v1H9v-1zm-7 4H5v-1h2zm7-1v1H9v-1z' style='fill-rule:nonzero' transform='matrix(2 0 0 2 0 -2)'/%3E%3C/svg%3E")}.ag-icon-last:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m7.727 9.88 6.12 6.12-6.12 6.12L9.607 24l8-8-8-8zM21.607 8h2.667v16h-2.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-left:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M26.667 14.667H10.44l7.453-7.453L16 5.334 5.333 16.001 16 26.668l1.88-1.88-7.44-7.453h16.227z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-linked:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M5.2 16a4.136 4.136 0 0 1 4.133-4.133h5.333V9.334H9.333a6.67 6.67 0 0 0-6.667 6.667 6.67 6.67 0 0 0 6.667 6.667h5.333v-2.533H9.333A4.136 4.136 0 0 1 5.2 16.002zm5.467 1.333h10.667v-2.667H10.667zm12-8h-5.333v2.533h5.333a4.136 4.136 0 0 1 4.133 4.133 4.136 4.136 0 0 1-4.133 4.133h-5.333v2.533h5.333a6.67 6.67 0 0 0 6.667-6.667 6.67 6.67 0 0 0-6.667-6.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-loading:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M17 29h-2v-8h2zm-3.586-9L7 26.414 5.586 25 12 18.586zm13 5L25 26.414 18.586 20 20 18.586zM29 17h-8v-2h8zm-18 0H3v-2h8zm2.414-5L12 13.414 5.586 7 7 5.586zm13-5L20 13.414 18.586 12 25 5.586zM17 11h-2V3h2z' style='fill-rule:nonzero' transform='translate(-3.692 -3.692)scale(1.23077)'/%3E%3C/svg%3E")}.ag-icon-maximize:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M14 30H2V18h2.828v7.05l8.254-8.252 2.12 2.12-8.252 8.254H14zm4-28h12v12h-2.828V6.95l-8.254 8.252-2.12-2.12 8.252-8.254H18z'/%3E%3C/svg%3E")}.ag-icon-menu:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M20 13H0v-2h20zm0-6H0V5h20zm0-6H0v-2h20z' style='fill-rule:nonzero' transform='translate(6 9)'/%3E%3C/svg%3E")}.ag-icon-menu-alt:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='%23000' d='M16 19a3 3 0 1 0 0-6 3 3 0 0 0 0 6M16 11a3 3 0 1 0 0-6 3 3 0 0 0 0 6M16 27a3 3 0 1 0 0-6 3 3 0 0 0 0 6'/%3E%3C/svg%3E")}.ag-icon-minimize:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M2 18h12v12h-2.828v-7.05l-8.254 8.252-2.12-2.12 8.252-8.254H2zm28-4H18V2h2.828v7.05L29.082.798l2.12 2.12-8.252 8.254H30z'/%3E%3C/svg%3E")}.ag-icon-minus:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M6.572 6.572a13.32 13.32 0 0 0 0 18.856 13.32 13.32 0 0 0 18.856 0 13.32 13.32 0 0 0 0-18.856 13.32 13.32 0 0 0-18.856 0m17.527 8.099v2.658H7.901v-2.658z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-next:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M10.94 6 9.06 7.88 17.167 16 9.06 24.12 10.94 26l10-10z' style='fill-rule:nonzero' transform='translate(1)'/%3E%3C/svg%3E")}.ag-icon-none:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Ctitle%3Enone%3C/title%3E%3Cg fill='%23000' fill-rule='nonzero'%3E%3Cpath d='M23.708 14.645 16 6.939l-7.708 7.706 1.416 1.416L16 9.767l6.292 6.294zM23.708 20.355 16 28.061l-7.708-7.706 1.416-1.416L16 25.233l6.292-6.294z'/%3E%3C/g%3E%3C/svg%3E")}.ag-icon-not-allowed:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M16 2.667C8.64 2.667 2.667 8.64 2.667 16S8.64 29.333 16 29.333 29.333 23.36 29.333 16 23.36 2.667 16 2.667M5.333 16c0-5.893 4.773-10.667 10.667-10.667 2.467 0 4.733.84 6.533 2.253L7.586 22.533A10.54 10.54 0 0 1 5.333 16M16 26.667c-2.467 0-4.733-.84-6.533-2.253L24.414 9.467A10.54 10.54 0 0 1 26.667 16c0 5.893-4.773 10.667-10.667 10.667' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-paste:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M25.334 4H19.76C19.2 2.453 17.733 1.333 16 1.333S12.8 2.453 12.24 4H6.667A2.675 2.675 0 0 0 4 6.667V28c0 1.467 1.2 2.667 2.667 2.667h18.667c1.467 0 2.667-1.2 2.667-2.667V6.667C28.001 5.2 26.801 4 25.334 4M16 4c.733 0 1.333.6 1.333 1.333s-.6 1.333-1.333 1.333-1.333-.6-1.333-1.333S15.267 4 16 4m9.333 24H6.666V6.667h2.667v4h13.333v-4h2.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-pin:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m10.78 19.777-4.668-4.666s.032-1 .67-1.87c1.366-1.86 4.052-1.96 6.056-1.572l3.158-3.108c-.7-2.342 3.352-5.046 3.352-5.046l9.166 9.168q-.334.447-.67.894c-1.074 1.426-2.538 2.63-4.272 2.338l-3.32 3.218c.046.344.042.03.118 1.152.144 2.13-.64 4.324-2.632 5.34l-.746.364-4.798-4.798-7.292 7.294-1.416-1.416zm8.24-13.672c-.688.568-1.416 1.45-1.024 2.072l.49.722-4.986 4.988c-1.988-.506-4.346-.636-5.156.614l9.02 9.032q.14-.099.272-.21c1.226-1.08.764-3.04.498-4.9l4.79-4.79s1.47.938 2.936-.776l-6.79-6.79q-.026.019-.05.038' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-pivot:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M25.128 2.002c2.56.096 4.772 2.292 4.87 4.87a712 712 0 0 1 0 18.256c-.096 2.56-2.292 4.772-4.87 4.87a712 712 0 0 1-18.256 0c-2.558-.096-4.772-2.29-4.87-4.87a712 712 0 0 1 0-18.256c.096-2.56 2.292-4.772 4.87-4.87a712 712 0 0 1 18.256 0m2.966 7.954H9.892v18.136c5.086.13 10.18.098 15.264-.096 1.48-.094 2.746-1.35 2.84-2.84.192-5.064.226-10.134.098-15.2M3.968 24.1q.015.528.036 1.056c.094 1.484 1.354 2.746 2.84 2.84l1.012.036V24.1zM22 15.414l-.292.294-1.416-1.416L23 11.586l2.708 2.706-1.416 1.416-.292-.294v3.592c-.032 2.604-2.246 4.892-4.872 4.992L15.414 24l.294.292-1.416 1.416L11.586 23l2.706-2.708 1.416 1.416-.322.32c3.372.03 6.578-.164 6.614-3.034zM3.88 18.038c.002 1.346.012 2.694.038 4.04h3.938v-4.04zm.05-6.062a681 681 0 0 0-.044 4.042h3.97v-4.042zm5.962-7.99Q8.449 3.999 7.006 4c-1.57.02-2.946 1.348-3.004 2.922q-.02 1.517-.042 3.034h3.896v-2.02h2.036zm14.244-.016v3.966h3.898q-.017-.546-.038-1.092c-.094-1.48-1.35-2.746-2.84-2.84q-.51-.019-1.02-.034m-8.14-.054q-2.035.022-4.07.048v3.972h4.07zm6.106.008a213 213 0 0 0-4.07-.022v4.034h4.07z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-plus:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M6.572 6.572a13.32 13.32 0 0 0 0 18.856 13.32 13.32 0 0 0 18.856 0 13.32 13.32 0 0 0 0-18.856 13.32 13.32 0 0 0-18.856 0m17.527 8.099v2.658h-6.77v6.77h-2.658v-6.77h-6.77v-2.658h6.77v-6.77h2.658v6.77z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-previous:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M21.94 7.88 20.06 6l-10 10 10 10 1.88-1.88L13.833 16z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-right:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m16 5.333-1.88 1.88 7.44 7.453H5.333v2.667H21.56l-7.44 7.453 1.88 1.88 10.667-10.667L16 5.332z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-save:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M15.708 2.355 8 10.061.292 2.355 1.708.939 8 7.233 14.292.939z' style='fill-rule:nonzero' transform='translate(8 14)'/%3E%3Cpath d='M5 26h22v2H5zM15 4h2v18h-2z'/%3E%3C/svg%3E")}.ag-icon-small-down:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M7.334 10.667 16 21.334l8.667-10.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-small-left:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M21.333 7.334 10.666 16l10.667 8.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-small-right:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M10.667 24.666 21.334 16 10.667 7.333z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-small-up:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M7.334 21.333 16 10.666l8.667 10.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-tick:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M11.586 22.96 27.718 6.828 29.84 8.95 11.586 27.202 2.4 18.016l2.12-2.122z'/%3E%3C/svg%3E")}.ag-icon-tree-closed:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m11.94 6-1.88 1.88L18.167 16l-8.107 8.12L11.94 26l10-10z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-tree-indeterminate:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M6 13.5h20v3H6z'/%3E%3C/svg%3E")}.ag-icon-tree-open:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M24.12 9.06 16 17.167 7.88 9.06 6 10.94l10 10 10-10z' style='fill-rule:nonzero' transform='translate(0 1)'/%3E%3C/svg%3E")}.ag-icon-unlinked:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M22.667 9.333h-5.333v2.533h5.333a4.136 4.136 0 0 1 4.133 4.133c0 1.907-1.307 3.507-3.08 3.973l1.947 1.947c2.173-1.107 3.667-3.32 3.667-5.92a6.67 6.67 0 0 0-6.667-6.667zm-1.334 5.334h-2.92l2.667 2.667h.253zM2.667 5.693 6.814 9.84A6.65 6.65 0 0 0 2.667 16a6.67 6.67 0 0 0 6.667 6.667h5.333v-2.533H9.334a4.136 4.136 0 0 1-4.133-4.133c0-2.12 1.613-3.867 3.68-4.093l2.76 2.76h-.973v2.667h3.64l3.027 3.027v2.307h2.307l5.347 5.333 1.68-1.68L4.362 4.002 2.669 5.695z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-up:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m5.333 16 1.88 1.88 7.453-7.44v16.227h2.667V10.44l7.44 7.453L26.666 16 15.999 5.333 5.332 16z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-grip:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M8 24H6v-4h2zm6 0h-2v-4h2zm6 0h-2v-4h2zm6 0h-2v-4h2zM8 18H6v-4h2zm6 0h-2v-4h2zm6 0h-2v-4h2zm6 0h-2v-4h2zM8 12H6V8h2zm6 0h-2V8h2zm6 0h-2V8h2zm6 0h-2V8h2z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-settings:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='%23000' d='M30 8h-4.1c-.5-2.3-2.5-4-4.9-4s-4.4 1.7-4.9 4H2v2h14.1c.5 2.3 2.5 4 4.9 4s4.4-1.7 4.9-4H30zm-9 4c-1.7 0-3-1.3-3-3s1.3-3 3-3 3 1.3 3 3-1.3 3-3 3M2 24h4.1c.5 2.3 2.5 4 4.9 4s4.4-1.7 4.9-4H30v-2H15.9c-.5-2.3-2.5-4-4.9-4s-4.4 1.7-4.9 4H2zm9-4c1.7 0 3 1.3 3 3s-1.3 3-3 3-3-1.3-3-3 1.3-3 3-3'/%3E%3C/svg%3E")}.ag-icon-column-arrow:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M11 4a1 1 0 0 1 1 1v22a1 1 0 1 1-2 0V5a1 1 0 0 1 1-1' clip-rule='evenodd'/%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M2 13a1 1 0 0 1 1-1h23.5a1 1 0 1 1 0 2H3a1 1 0 0 1-1-1' clip-rule='evenodd'/%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M2 4h18v24H2zm2 2v20h14V6zM26.793 13 23 9.207l1.414-1.414L29.621 13l-5.207 5.207L23 16.793z' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-un-pin:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='m6.112 15.111 3.272 3.271 1.436-1.402-2.476-2.479c.81-1.25 3.168-1.12 5.156-.614l4.986-4.988-.49-.722c-.392-.622.336-1.504 1.024-2.072l.008-.007.01-.006.032-.025 1.447 1.447 1.432-1.397-2.601-2.602s-4.052 2.704-3.352 5.046l-3.158 3.108c-2.004-.388-4.69-.288-6.056 1.572-.638.87-.67 1.87-.67 1.87m.581 11.582.014.014 5.502-5.501 4.783 4.783.746-.364c1.992-1.016 2.776-3.21 2.632-5.34-.055-.805-.068-.87-.088-.97-.008-.04-.017-.085-.03-.182l3.32-3.218c1.734.292 3.198-.912 4.272-2.338q.337-.447.67-.894l-.001-.001-.007-.007-.007-.007-.007-.007-3.87-3.87 1.585-1.584-1.414-1.414-14.381 14.38-1.237 1.209-5.69 5.687 1.417 1.416zM23.21 10.206l2.65 2.651c-1.465 1.714-2.935.776-2.935.776l-4.79 4.79q.041.291.087.583c.257 1.676.513 3.35-.585 4.317a4 4 0 0 1-.272.21l-3.739-3.744z' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-pinned-top:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' d='m16.708 10.878 8.708 8.706L24 21l-6.292-6.294V27h-2V14.706L9.416 21 8 19.584q4.348-4.344 8.691-8.69zM25 6H8v2h17z'/%3E%3C/svg%3E")}.ag-icon-pinned-bottom:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' d='M16.708 22.122 8 13.416 9.416 12l6.292 6.294V6h2v12.294L24 12l1.416 1.416-8.691 8.69zM7.416 28h17v-2h-17z'/%3E%3C/svg%3E")}.ag-icon-chevron-up:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' viewBox='0 0 16 16'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M3.479 10.521a.75.75 0 0 1 0-1.06l4-4a.75.75 0 0 1 1.06 0l4 4a.75.75 0 0 1-1.06 1.06l-3.47-3.47-3.47 3.47a.75.75 0 0 1-1.06 0' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-chevron-down:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' viewBox='0 0 16 16'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M12.521 5.461a.75.75 0 0 1 0 1.06l-4 4a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 0 1 1.06-1.06l3.47 3.47 3.47-3.47a.75.75 0 0 1 1.06 0' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-chevron-left:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' viewBox='0 0 16 16'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M10.53 12.512a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 0 1 0-1.06l4-4a.75.75 0 0 1 1.06 1.06l-3.47 3.47 3.47 3.47a.75.75 0 0 1 0 1.06' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-chevron-right:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' viewBox='0 0 16 16'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M5.47 3.47a.75.75 0 0 1 1.06 0l4 4a.75.75 0 0 1 0 1.06l-4 4a.75.75 0 0 1-1.06-1.06L8.94 8 5.47 4.53a.75.75 0 0 1 0-1.06' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-filter-add:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' d='M19.834 8H8c0 .304.06.612.258.842 2.716 2.854 6.682 5.548 6.742 7.974V21l2-1.5v-2.684c.056-2.267 2.968-4.417 5.49-6.75v3.087c-1.081.974-2.245 1.968-3.232 3.005a1.05 1.05 0 0 0-.258.682v3.66L13 25c0-2.74.066-5.482-.002-8.222a1.05 1.05 0 0 0-.256-.62C10.026 13.304 6.06 10.61 6 8.184V6h13.834z'/%3E%3Cpath fill='currentColor' d='M26 6h2.946v2.002H26v3.313h-2.002V8.002h-2.946V6h2.946V3.04H26z'/%3E%3C/svg%3E")}.ag-icon-edit:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' d='M6.222 25.778h1.611l14.834-14.811-1.611-1.611-14.834 14.81zM4 28v-4.733L22.644 4.656a2.26 2.26 0 0 1 1.567-.634q.423 0 .833.167.412.166.734.478l1.589 1.6q.333.322.483.733t.15.822q0 .423-.161.839-.162.416-.472.728L8.733 28zm17.856-17.833-.8-.811 1.61 1.61z'/%3E%3C/svg%3E")}`,lz=on({feature:"iconSet",css:az});var rD={aggregation:'<path d="M18 7V4H6l6 8-6 8h12v-3"/>',arrows:'<polyline points="5 9 2 12 5 15"/><polyline points="9 5 12 2 15 5"/><polyline points="15 19 12 22 9 19"/><polyline points="19 9 22 12 19 15"/><line x1="2" x2="22" y1="12" y2="12"/><line x1="12" x2="12" y1="2" y2="22"/>',asc:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',cancel:'<path d="m18 6-12 12"/><path d="m6 6 12 12"/>',chart:'<line x1="18" x2="18" y1="20" y2="10"/><line x1="12" x2="12" y1="20" y2="4"/><line x1="6" x2="6" y1="20" y2="14"/>',"color-picker":'<path d="m19 11-8-8-8.6 8.6a2 2 0 0 0 0 2.8l5.2 5.2c.8.8 2 .8 2.8 0L19 11Z"/><path d="m5 2 5 5"/><path d="M2 13h15"/><path d="M22 20a2 2 0 1 1-4 0c0-1.6 1.7-2.4 2-4 .3 1.6 2 2.4 2 4Z"/>',columns:'<path d="M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18"/>',contracted:'<path d="m9 18 6-6-6-6"/>',copy:'<rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/>',cross:'<path d="M18 6 6 18"/><path d="m6 6 12 12"/>',csv:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',cut:'<circle cx="6" cy="6" r="3"/><path d="M8.12 8.12 12 12"/><path d="M20 4 8.12 15.88"/><circle cx="6" cy="18" r="3"/><path d="M14.8 14.8 20 20"/>',desc:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',down:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',excel:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',expanded:'<path d="m15 18-6-6 6-6"/>',"eye-slash":'<path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"/><line x1="2" x2="22" y1="2" y2="22"/>',eye:'<path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/>',filter:'<path d="M3 6h18"/><path d="M7 12h10"/><path d="M10 18h4"/>',first:'<path d="m17 18-6-6 6-6"/><path d="M7 6v12"/>',group:'<path d="M16 12H3"/><path d="M16 18H3"/><path d="M10 6H3"/><path d="M21 18V8a2 2 0 0 0-2-2h-5"/><path d="m16 8-2-2 2-2"/>',last:'<path d="m7 18 6-6-6-6"/><path d="M17 6v12"/>',left:'<path d="m12 19-7-7 7-7"/><path d="M19 12H5"/>',linked:'<path d="M9 17H7A5 5 0 0 1 7 7h2"/><path d="M15 7h2a5 5 0 1 1 0 10h-2"/><line x1="8" x2="16" y1="12" y2="12"/>',loading:'<line x1="12" x2="12" y1="2" y2="6"/><line x1="12" x2="12" y1="18" y2="22"/><line x1="4.93" x2="7.76" y1="4.93" y2="7.76"/><line x1="16.24" x2="19.07" y1="16.24" y2="19.07"/><line x1="2" x2="6" y1="12" y2="12"/><line x1="18" x2="22" y1="12" y2="12"/><line x1="4.93" x2="7.76" y1="19.07" y2="16.24"/><line x1="16.24" x2="19.07" y1="7.76" y2="4.93"/>',maximize:'<polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" x2="14" y1="3" y2="10"/><line x1="3" x2="10" y1="21" y2="14"/>',menu:'<line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/>',"menu-alt":'<circle cx="12" cy="5" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="12" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="19" r="0.75" fill="#D9D9D9"/>',minimize:'<polyline points="4 14 10 14 10 20"/><polyline points="20 10 14 10 14 4"/><line x1="14" x2="21" y1="10" y2="3"/><line x1="3" x2="10" y1="21" y2="14"/>',minus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/>',next:'<path d="m9 18 6-6-6-6"/>',none:'<path d="m7 15 5 5 5-5"/><path d="m7 9 5-5 5 5"/>',"not-allowed":'<circle cx="12" cy="12" r="10"/><path d="m4.9 4.9 14.2 14.2"/>',paste:'<path d="M15 2H9a1 1 0 0 0-1 1v2c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V3c0-.6-.4-1-1-1Z"/><path d="M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M16 4h2a2 2 0 0 1 2 2v2M11 14h10"/><path d="m17 10 4 4-4 4"/>',pin:'<line x1="12" x2="12" y1="17" y2="22"/><path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"/>',pivot:'<path d="M15 3v18"/><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M21 9H3"/><path d="M21 15H3"/>',plus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/><path d="M12 8v8"/>',previous:'<path d="m15 18-6-6 6-6"/>',right:'<path d="M5 12h14"/><path d="m12 5 7 7-7 7"/>',save:'<path d="M12 17V3"/><path d="m6 11 6 6 6-6"/><path d="M19 21H5"/>',"small-left":'<path d="m15 18-6-6 6-6"/>',"small-right":'<path d="m9 18 6-6-6-6"/>',tick:'<path d="M20 6 9 17l-5-5"/>',"tree-closed":'<path d="m9 18 6-6-6-6"/>',"tree-indeterminate":'<path d="M5 12h14"/>',"tree-open":'<path d="m6 9 6 6 6-6"/>',unlinked:'<path d="M9 17H7A5 5 0 0 1 7 7"/><path d="M15 7h2a5 5 0 0 1 4 8"/><line x1="8" x2="12" y1="12" y2="12"/><line x1="2" x2="22" y1="2" y2="22"/>',up:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',grip:'<circle cx="5" cy="8" r="0.5"/><circle cx="12" cy="8" r="0.5"/><circle cx="19" cy="8" r="0.5"/><circle cx="5" cy="16" r="0.5"/><circle cx="12" cy="16" r="0.5"/><circle cx="19" cy="16" r="0.5"/><g stroke="none" fill="currentColor"><circle cx="5" cy="8" r="1"/><circle cx="12" cy="8" r="1"/><circle cx="19" cy="8" r="1"/><circle cx="5" cy="16" r="1"/><circle cx="12" cy="16" r="1"/><circle cx="19" cy="16" r="1"/></g>',settings:'<path d="M20 7h-9"/><path d="M14 17H5"/><circle cx="17" cy="17" r="3"/><circle cx="7" cy="7" r="3"/>'},sD={"column-arrow":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" viewBox="0 0 32 32"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 26C0 28.2092 1.79086 30 4 30H14C16.2091 30 18 28.2092 18 26V15H25.8786L24.4394 16.4393C23.8536 17.0251 23.8536 17.9749 24.4394 18.5607C25.0252 19.1464 25.9748 19.1464 26.5606 18.5607L30.5606 14.5607C31.1464 13.9749 31.1464 13.0251 30.5606 12.4393L26.5606 8.43934C25.9748 7.85356 25.0252 7.85356 24.4394 8.43934C23.8536 9.02512 23.8536 9.97488 24.4394 10.5607L25.8786 12H18V6C18 3.79086 16.2091 2 14 2H4C1.79086 2 0 3.79086 0 6V26ZM14 5H10.5V12H15V6C15 5.44772 14.5523 5 14 5ZM4 5H7.5V12H3V6C3 5.44772 3.44772 5 4 5ZM10.5 15H15V26C15 26.5522 14.5523 27 14 27H10.5V15ZM4 27H7.5V15H3V26C3 26.5522 3.44772 27 4 27Z" fill="currentColor"/></svg>',"small-down":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 10.667 16 21.334l8.667-10.667H7.334Z"/></svg>',"small-up":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 21.333 16 10.666l8.667 10.667H7.334Z"/></svg>',"pinned-top":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M12.53 3.72A.75.75 0 0 1 12 5H4a.75.75 0 0 1 0-1.5h8a.75.75 0 0 1 .53.22ZM3.269 10.744a.75.75 0 0 1 .2-.524l4-4a.75.75 0 0 1 1.06 0l4 4a.75.75 0 1 1-1.06 1.06L8.75 8.56V14a.75.75 0 0 1-1.5 0V8.56l-2.72 2.72a.75.75 0 0 1-1.26-.536Z"/></svg>',"pinned-bottom":'<svg xmlns="http://www.w3.org/2000/svg" fill="none" class="ag-icon" viewBox="0 0 16 16"><path fill="currentColor" d="M3.47 12.28A.75.75 0 0 1 4 11h8a.75.75 0 0 1 0 1.5H4a.75.75 0 0 1-.53-.22ZM12.731 5.256a.75.75 0 0 1-.2.524l-4 4a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 1 1 1.06-1.06l2.72 2.72V2a.75.75 0 0 1 1.5 0v5.44l2.72-2.72a.75.75 0 0 1 1.26.536Z"/></svg>',"un-pin":'<svg xmlns="http://www.w3.org/2000/svg" fill="none" class="ag-icon" viewBox="0 0 16 16"><path fill="currentColor" d="M8 11a.75.75 0 0 0-.75.75v3.333a.75.75 0 1 0 1.5 0V11.75A.75.75 0 0 0 8 11Z"/><path fill="currentColor" d="M13.11 1.436a.75.75 0 0 0-1.22-.872l-10 14a.75.75 0 1 0 1.22.872L5.207 12.5h7.376a.75.75 0 0 0 .75-.75v-1.174a2.08 2.08 0 0 0-1.153-1.863l-1.185-.599-.005-.002a.58.58 0 0 1-.323-.522V5.165a2.083 2.083 0 0 0 1.854-2.904l.589-.825Zm-3.943 5.52v.634a2.08 2.08 0 0 0 1.153 1.863l1.185.6.005.002a.58.58 0 0 1 .323.522V11H6.28l2.887-4.044ZM9.277 1H5.25a2.084 2.084 0 0 0-.083 4.165v1.676l1.5-2.132v-.292a.75.75 0 0 0-.75-.75H5.25a.584.584 0 0 1 0-1.167h2.972L9.277 1Z"/></svg>',"chevron-down":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 6L8 10L4 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-up":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 10L8 6L12 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-left":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 12L6 8L10 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-right":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"filter-add":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.12126 7.75L10.8517 7.75" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M6.65934 11.748L9.32778 11.748" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M12.2943 1.04872V6.19184M14.9886 3.74341H9.68478" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M8.25488 3C8.04799 3.18323 7.91706 3.45099 7.91699 3.74902C7.91713 4.04868 8.04988 4.31681 8.25879 4.5H2C1.58579 4.5 1.25 4.16421 1.25 3.75C1.25 3.33579 1.58579 3 2 3H8.25488Z" fill="currentColor"/></svg>',edit:'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 10.6262V12.5012H5.375L10.905 6.97122L9.03 5.09622L3.5 10.6262ZM12.355 5.52122C12.4014 5.47497 12.4381 5.42002 12.4632 5.35953C12.4883 5.29905 12.5012 5.23421 12.5012 5.16872C12.5012 5.10324 12.4883 5.0384 12.4632 4.97791C12.4381 4.91742 12.4014 4.86248 12.355 4.81622L11.185 3.64622C11.1387 3.59987 11.0838 3.5631 11.0233 3.53801C10.9628 3.51291 10.898 3.5 10.8325 3.5C10.767 3.5 10.7022 3.51291 10.6417 3.53801C10.5812 3.5631 10.5263 3.59987 10.48 3.64622L9.565 4.56122L11.44 6.43622L12.355 5.52122Z" fill="currentColor"/></svg>'},cz=(e={})=>{let t="";for(let i of[...Object.keys(rD),...Object.keys(sD)]){let n=dz(i,e.strokeWidth);t+=`.ag-icon-${i}::before { mask-image: url('data:image/svg+xml,${encodeURIComponent(n)}'); }
`}return t},dz=(e,t=1.5)=>{let i=sD[e];if(i)return i;let n=rD[e];if(!n)throw new Error(`Missing icon data for ${e}`);return`<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="black" stroke-width="${t}" viewBox="0 0 24 24"><style>* { vector-effect: non-scaling-stroke; }</style>`+n+"</svg>"},uz=(e={})=>on({feature:"iconSet",css:()=>cz(e)});var hz=uz();var pz=':where(.ag-input-field-input[type=number]:not(.ag-number-field-input-stepper)){-webkit-appearance:textfield;-moz-appearance:textfield;appearance:textfield;&::-webkit-inner-spin-button,&::-webkit-outer-spin-button{-webkit-appearance:none;appearance:none;margin:0}}.ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){background-color:var(--ag-input-background-color);border:var(--ag-input-border);border-radius:var(--ag-input-border-radius);color:var(--ag-input-text-color);font-family:inherit;font-size:inherit;line-height:inherit;margin:0;min-height:var(--ag-input-height);padding:0;&:where(:disabled){background-color:var(--ag-input-disabled-background-color);border:var(--ag-input-disabled-border);color:var(--ag-input-disabled-text-color)}&:where(:focus){background-color:var(--ag-input-focus-background-color);border:var(--ag-input-focus-border);box-shadow:var(--ag-input-focus-shadow);color:var(--ag-input-focus-text-color);outline:none}&:where(:invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&:where(.invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&::-moz-placeholder{color:var(--ag-input-placeholder-text-color)}&::placeholder{color:var(--ag-input-placeholder-text-color)}}:where(.ag-ltr) .ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){padding-left:var(--ag-input-padding-start)}:where(.ag-rtl) .ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){padding-right:var(--ag-input-padding-start)}:where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select){.ag-input-wrapper:before{background-color:currentcolor;color:var(--ag-input-icon-color);content:"";display:block;height:12px;-webkit-mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;opacity:.5;position:absolute;width:12px}}:where(.ag-ltr) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select){.ag-input-wrapper:before{margin-left:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-left:calc(var(--ag-spacing)*1.5 + 12px)}}:where(.ag-rtl) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select){.ag-input-wrapper:before{margin-right:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-right:calc(var(--ag-spacing)*1.5 + 12px)}}',gz=".ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){&:focus{box-shadow:var(--ag-focus-shadow);&:where(.invalid),&:where(:invalid){box-shadow:var(--ag-focus-error-shadow)}}}";var fz={inputBackgroundColor:"transparent",inputBorder:!1,inputBorderRadius:0,inputTextColor:{ref:"textColor"},inputPlaceholderTextColor:{ref:"inputTextColor",mix:.5},inputPaddingStart:0,inputHeight:{calc:"max(iconSize, fontSize) + spacing * 2"},inputFocusBackgroundColor:{ref:"inputBackgroundColor"},inputFocusBorder:{ref:"inputBorder"},inputFocusShadow:"none",inputFocusTextColor:{ref:"inputTextColor"},inputDisabledBackgroundColor:{ref:"inputBackgroundColor"},inputDisabledBorder:{ref:"inputBorder"},inputDisabledTextColor:{ref:"inputTextColor"},inputInvalidBackgroundColor:{ref:"inputBackgroundColor"},inputInvalidBorder:{ref:"inputBorder"},inputInvalidTextColor:{ref:"inputTextColor"},inputIconColor:{ref:"inputTextColor"},pickerButtonBorder:!1,pickerButtonFocusBorder:{ref:"inputFocusBorder"},pickerButtonBackgroundColor:{ref:"backgroundColor"},pickerButtonFocusBackgroundColor:{ref:"backgroundColor"},pickerListBorder:!1,pickerListBackgroundColor:{ref:"backgroundColor"},colorPickerThumbSize:18,colorPickerTrackSize:12,colorPickerThumbBorderWidth:3,colorPickerTrackBorderRadius:12,colorPickerColorBorderRadius:4};var mz=()=>on({feature:"inputStyle",params:z(b({},fz),{inputBackgroundColor:yi,inputBorder:!0,inputBorderRadius:{ref:"borderRadius"},inputPaddingStart:{ref:"spacing"},inputFocusBorder:{color:Wt},inputFocusShadow:{ref:"focusShadow"},inputDisabledBackgroundColor:bi(.06),inputDisabledTextColor:{ref:"textColor",mix:.5},inputInvalidBorder:{color:{ref:"invalidColor"}},pickerButtonBorder:!0,pickerListBorder:!0}),css:()=>pz+gz}),aD=mz();var lD='.ag-tabs-header{background-color:var(--ag-tab-bar-background-color);border-bottom:var(--ag-tab-bar-border);display:flex;flex:1;gap:var(--ag-tab-spacing);padding:var(--ag-tab-bar-top-padding) var(--ag-tab-bar-horizontal-padding) 0}.ag-tabs-header-wrapper{display:flex}.ag-tabs-close-button-wrapper{align-items:center;border:0;display:flex;padding:var(--ag-spacing)}:where(.ag-ltr) .ag-tabs-close-button-wrapper{border-right:solid var(--ag-border-width) var(--ag-border-color)}:where(.ag-rtl) .ag-tabs-close-button-wrapper{border-left:solid var(--ag-border-width) var(--ag-border-color)}.ag-tabs-close-button{background-color:unset;border:0;cursor:pointer;padding:0}.ag-tab{align-items:center;background-color:var(--ag-tab-background-color);border-left:var(--ag-tab-selected-border-width) solid transparent;border-right:var(--ag-tab-selected-border-width) solid transparent;color:var(--ag-tab-text-color);cursor:pointer;display:flex;flex:1;justify-content:center;padding:var(--ag-tab-top-padding) var(--ag-tab-horizontal-padding) var(--ag-tab-bottom-padding);position:relative;&:hover{background-color:var(--ag-tab-hover-background-color);color:var(--ag-tab-hover-text-color)}&.ag-tab-selected{background-color:var(--ag-tab-selected-background-color);color:var(--ag-tab-selected-text-color)}&:after{background-color:var(--ag-tab-selected-underline-color);bottom:0;content:"";display:block;height:var(--ag-tab-selected-underline-width);left:0;opacity:0;position:absolute;right:0;transition:opacity var(--ag-tab-selected-underline-transition-duration)}&.ag-tab-selected:after{opacity:1}}:where(.ag-ltr) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-left-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-right-color:var(--ag-tab-selected-border-color)}}}:where(.ag-rtl) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-right-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-left-color:var(--ag-tab-selected-border-color)}}}';var cD={tabBarBackgroundColor:"transparent",tabBarHorizontalPadding:0,tabBarTopPadding:0,tabBackgroundColor:"transparent",tabTextColor:{ref:"textColor"},tabHorizontalPadding:{ref:"spacing"},tabTopPadding:{ref:"spacing"},tabBottomPadding:{ref:"spacing"},tabSpacing:"0",tabHoverBackgroundColor:{ref:"tabBackgroundColor"},tabHoverTextColor:{ref:"tabTextColor"},tabSelectedBackgroundColor:{ref:"tabBackgroundColor"},tabSelectedTextColor:{ref:"tabTextColor"},tabSelectedBorderWidth:{ref:"borderWidth"},tabSelectedBorderColor:"transparent",tabSelectedUnderlineColor:"transparent",tabSelectedUnderlineWidth:0,tabSelectedUnderlineTransitionDuration:0,tabBarBorder:!1};var vz=()=>on({feature:"tabStyle",params:z(b({},cD),{tabBarBorder:!0,tabBarBackgroundColor:vn(.05),tabTextColor:{ref:"textColor",mix:.7},tabSelectedTextColor:{ref:"textColor"},tabHoverTextColor:{ref:"textColor"},tabSelectedBorderColor:{ref:"borderColor"},tabSelectedBackgroundColor:yi}),css:lD}),Cz=vz();var wz=()=>on({feature:"tabStyle",params:z(b({},cD),{tabBarBorder:!0,tabBarBackgroundColor:{ref:"chromeBackgroundColor"},tabHoverTextColor:Wt,tabSelectedTextColor:Wt,tabSelectedUnderlineColor:Wt,tabSelectedUnderlineWidth:2,tabSelectedUnderlineTransitionDuration:"0.3s"}),css:lD}),bz=wz();var yz=()=>tD().withPart(iD).withPart(oD).withPart(hz).withPart(Cz).withPart(aD).withPart(Ew).withParams({fontFamily:[{googleFont:"IBM Plex Sans"},"-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu"]}),Sz=yz(),xz=()=>tD().withPart(ZG).withPart(iD).withPart(oD).withPart(lz).withPart(bz).withPart(aD).withPart(Ew).withParams({accentColor:"#2196f3",selectedRowBackgroundColor:Zi(.3),inputFocusBorder:{color:Zi(.4)},focusShadow:{radius:2,spread:1.6,color:Zi(.4)},iconButtonHoverBackgroundColor:"transparent",iconButtonActiveBackgroundColor:"transparent",checkboxUncheckedBorderColor:bi(.45),checkboxIndeterminateBackgroundColor:bi(.45),checkboxIndeterminateBorderColor:bi(.45),checkboxBorderWidth:2,checkboxBorderRadius:2,fontSize:13,dataFontSize:14,headerFontWeight:700,borderRadius:3,wrapperBorderRadius:3,tabSelectedUnderlineColor:Wt,tabSelectedBorderWidth:0,tabSelectedUnderlineTransitionDuration:.3,sideButtonSelectedUnderlineColor:Wt,sideButtonSelectedUnderlineWidth:2,sideButtonSelectedUnderlineTransitionDuration:.3,sideButtonBorder:!1,sideButtonSelectedBorder:!1,sideButtonBarTopPadding:{calc:"spacing * 3"},sideButtonSelectedBackgroundColor:"transparent",sideButtonHoverTextColor:Wt,iconButtonHoverColor:Wt,toggleButtonWidth:28,toggleButtonHeight:18,toggleButtonSwitchInset:1,toggleButtonOffBackgroundColor:bi(.45),colorPickerThumbSize:13,colorPickerTrackSize:11,colorPickerThumbBorderWidth:2,colorPickerTrackBorderRadius:2,colorPickerColorBorderRadius:2}),og=xz();var Ez={cssName:"--ag-cell-horizontal-padding",changeKey:"cellHorizontalPaddingChanged",defaultValue:16},_z={cssName:"--ag-indentation-level",changeKey:"indentationLevelChanged",defaultValue:0,noWarn:!0,cacheDefault:!0},Rz={cssName:"--ag-row-group-indent-size",changeKey:"rowGroupIndentSizeChanged",defaultValue:0},x_={cssName:"--ag-row-height",changeKey:"rowHeightChanged",defaultValue:42},E_={cssName:"--ag-header-height",changeKey:"headerHeightChanged",defaultValue:48},__={cssName:"--ag-list-item-height",changeKey:"listItemHeightChanged",defaultValue:24},iC={cssName:"--ag-row-border",changeKey:"rowBorderWidthChanged",defaultValue:1,border:!0},R_={cssName:"--ag-pinned-row-border",changeKey:"pinnedRowBorderWidthChanged",defaultValue:1,border:!0};function Pz(e,t){for(let i of t.sort((n,o)=>n.moduleName.localeCompare(o.moduleName))){let n=i.css;n&&e.set(`module-${i.moduleName}`,n)}}var Dz=class extends W9{constructor(){super(...arguments),this.sizeEls=new Map,this.lastKnownValues=new Map,this.sizesMeasured=!1}initVariables(){this.addManagedPropertyListener("rowHeight",()=>this.refreshRowHeightVariable()),this.getSizeEl(x_),this.getSizeEl(E_),this.getSizeEl(__),this.getSizeEl(iC),this.getSizeEl(R_),this.refreshRowBorderWidthVariable()}getPinnedRowBorderWidth(){return this.getCSSVariablePixelValue(R_)}getRowBorderWidth(){return this.getCSSVariablePixelValue(iC)}getDefaultRowHeight(){return this.getCSSVariablePixelValue(x_)}getDefaultHeaderHeight(){return this.getCSSVariablePixelValue(E_)}getDefaultCellHorizontalPadding(){return this.getCSSVariablePixelValue(Ez)}getCellPaddingLeft(){let e=this.getDefaultCellHorizontalPadding(),t=this.getCSSVariablePixelValue(_z),i=this.getCSSVariablePixelValue(Rz);return e-1+i*t}getCellPadding(){let e=this.getDefaultCellHorizontalPadding()-1;return this.getCellPaddingLeft()+e}getDefaultColumnMinWidth(){return Math.min(36,this.getDefaultRowHeight())}getDefaultListItemHeight(){return this.getCSSVariablePixelValue(__)}refreshRowHeightVariable(){let{eRootDiv:e}=this,t=e.style.getPropertyValue("--ag-line-height").trim(),i=this.gos.get("rowHeight");if(i==null||isNaN(i)||!isFinite(i))return t!==null&&e.style.setProperty("--ag-line-height",null),-1;let n=`${i}px`;return t!=n?(e.style.setProperty("--ag-line-height",n),i):t!=""?Number.parseFloat(t):-1}getCSSVariablePixelValue(e){let t=this.lastKnownValues.get(e);if(t!=null)return t;let i=this.measureSizeEl(e);return i==="detached"||i==="no-styles"?(e.cacheDefault&&this.lastKnownValues.set(e,e.defaultValue),e.defaultValue):(this.lastKnownValues.set(e,i),i)}measureSizeEl(e){let t=this.getSizeEl(e);if(t.offsetParent==null)return"detached";let i=t.offsetWidth;return i===nC?"no-styles":(this.sizesMeasured=!0,i)}getMeasurementContainer(){let e=this.eMeasurementContainer;return e||(e=this.eMeasurementContainer=Ft({tag:"div",cls:"ag-measurement-container"}),this.eRootDiv.appendChild(e)),e}getSizeEl(e){let t=this.sizeEls.get(e);if(t)return t;let i=this.getMeasurementContainer();t=Ft({tag:"div"});let{border:n,noWarn:o}=e;n?(t.className="ag-measurement-element-border",t.style.setProperty("--ag-internal-measurement-border",`var(${e.cssName}, solid ${nC}px)`)):t.style.width=`var(${e.cssName}, ${nC}px)`,i.appendChild(t),this.sizeEls.set(e,t);let r=this.measureSizeEl(e);r==="no-styles"&&!o&&W(9,{variable:e});let s=is(this.beans,t,()=>{let a=this.measureSizeEl(e);a==="detached"||a==="no-styles"||(this.lastKnownValues.set(e,a),a!==r&&(r=a,this.fireStylesChangedEvent(e.changeKey)))});return this.addDestroyFunc(()=>s()),t}fireStylesChangedEvent(e){e==="rowBorderWidthChanged"&&this.refreshRowBorderWidthVariable(),this.eventSvc.dispatchEvent({type:"gridStylesChanged",[e]:!0})}refreshRowBorderWidthVariable(){let e=this.getCSSVariablePixelValue(iC);this.eRootDiv.style.setProperty("--ag-internal-row-border-width",`${e}px`)}postProcessThemeChange(e,t){e&&getComputedStyle(this.getMeasurementContainer()).getPropertyValue("--ag-legacy-styles-loaded")&&tt(t?106:239)}getAdditionalCss(){let e=new Map;return e.set("core",[UG]),Pz(e,Array.from(fL())),e}getDefaultTheme(){return Sz}themeError(e){tt(240,{theme:e})}},nC=15538,Mz=class extends q9{postConstruct(){let{globalListener:e,globalSyncListener:t}=this.beans;e&&this.addGlobalListener(e,!0),t&&this.addGlobalListener(t,!1)}};function dD(e,t,i){let n=e.visibleCols.headerGroupRowCount;if(i>=n)return{column:t,headerRowIndex:i};let o=t.getParent();for(;o&&o.getProvidedColumnGroup().getLevel()>i;)o=o.getParent();let r=t.isSpanHeaderHeight();return!o||r&&o.isPadding()?{column:t,headerRowIndex:n}:{column:o,headerRowIndex:o.getProvidedColumnGroup().getLevel()}}var kz=class extends A{constructor(){super(...arguments),this.beanName="headerNavigation",this.currentHeaderRowWithoutSpan=-1}postConstruct(){let e=this.beans;e.ctrlsSvc.whenReady(this,i=>{this.gridBodyCon=i.gridBodyCtrl});let t=Qt(e);this.addManagedElementListeners(t,{mousedown:()=>{this.currentHeaderRowWithoutSpan=-1}})}getHeaderPositionForColumn(e,t){let i,{colModel:n,colGroupSvc:o,ctrlsSvc:r}=this.beans;if(typeof e=="string"?(i=n.getCol(e),i||(i=o?.getColumnGroup(e)??null)):i=e,!i)return null;let a=r.getHeaderRowContainerCtrl()?.getAllCtrls(),l=rt(a||[]).type==="filter",c=mo(this.beans)-1,d=-1,u=i;for(;u;)d++,u=u.getParent();let h=d;return t&&l&&h===c-1&&h++,h===-1?null:{headerRowIndex:h,column:i}}navigateVertically(e,t){let{focusSvc:i,visibleCols:n}=this.beans,{focusedHeader:o}=i;if(!o)return!1;let{headerRowIndex:r}=o,s=o.column,a=mo(this.beans),l=this.getHeaderRowType(r),c=n.headerGroupRowCount,{headerRowIndex:d,column:u,headerRowIndexWithoutSpan:h}=e==="UP"?Tz(l,s,r):Fz(s,r,c),p=!1;return d<0&&(d=0,u=s,p=!0),d>=a?(d=-1,this.currentHeaderRowWithoutSpan=-1):h!==void 0&&(this.currentHeaderRowWithoutSpan=h),!p&&!u?!1:i.focusHeaderPosition({headerPosition:{headerRowIndex:d,column:u},allowUserOverride:!0,event:t})}navigateHorizontally(e,t=!1,i){let{focusSvc:n,gos:o}=this.beans,r=b({},n.focusedHeader),s,a;this.currentHeaderRowWithoutSpan!==-1?r.headerRowIndex=this.currentHeaderRowWithoutSpan:this.currentHeaderRowWithoutSpan=r.headerRowIndex,e==="LEFT"!==o.get("enableRtl")?(a="Before",s=this.findHeader(r,a)):(a="After",s=this.findHeader(r,a));let l=o.getCallback("tabToNextHeader");if(t&&l){let c=n.focusHeaderPositionFromUserFunc({userFunc:l,headerPosition:s,direction:a});if(c){let{headerRowIndex:d}=n.focusedHeader||{};d!=null&&d!=r.headerRowIndex&&(this.currentHeaderRowWithoutSpan=d)}return c}return s||!t?n.focusHeaderPosition({headerPosition:s,direction:a,fromTab:t,allowUserOverride:!0,event:i}):this.focusNextHeaderRow(r,a,i)}focusNextHeaderRow(e,t,i){let n=this.beans,o=e.headerRowIndex,r=null,s,a=mo(n),l=this.beans.visibleCols.allCols;if(t==="Before"){if(o<=0)return!1;r=rt(l),s=o-1,this.currentHeaderRowWithoutSpan-=1}else r=l[0],s=o+1,this.currentHeaderRowWithoutSpan<a?this.currentHeaderRowWithoutSpan+=1:this.currentHeaderRowWithoutSpan=-1;let{column:c,headerRowIndex:d}=dD(this.beans,r,s);return d>=a&&(d=-1),n.focusSvc.focusHeaderPosition({headerPosition:{column:c,headerRowIndex:d},direction:t,fromTab:!0,allowUserOverride:!0,event:i})}scrollToColumn(e,t="After"){if(e.getPinned())return;let i;if(kt(e)){let n=e.getDisplayedLeafColumns();i=t==="Before"?rt(n):n[0]}else i=e;this.gridBodyCon.scrollFeature.ensureColumnVisible(i)}findHeader(e,t){let{colGroupSvc:i,visibleCols:n}=this.beans,o=e.column;if(o instanceof yd){let l=o.getDisplayedLeafColumns();o=t==="Before"?l[0]:l[l.length-1]}let r=t==="Before"?n.getColBefore(o):n.getColAfter(o);if(!r)return;let s=n.headerGroupRowCount;if(e.headerRowIndex>=s)return{headerRowIndex:e.headerRowIndex,column:r};let a=i?.getColGroupAtLevel(r,e.headerRowIndex);return a?a.isPadding()&&r.isSpanHeaderHeight()?{headerRowIndex:n.headerGroupRowCount,column:r}:{headerRowIndex:e.headerRowIndex,column:a??r}:{headerRowIndex:r instanceof ua&&r.isSpanHeaderHeight()?n.headerGroupRowCount:e.headerRowIndex,column:r}}getHeaderRowType(e){let t=this.beans.ctrlsSvc.getHeaderRowContainerCtrl();if(t)return t.getRowType(e)}};function Tz(e,t,i){let n=i-1;if(e!=="filter"){let o=t instanceof ua&&t.isSpanHeaderHeight(),r=t.getParent();for(;r&&(r.getProvidedColumnGroup().getLevel()>n||o&&r.isPadding());)r=r.getParent();if(r)return o?{column:r,headerRowIndex:r.getProvidedColumnGroup().getLevel(),headerRowIndexWithoutSpan:n}:{column:r,headerRowIndex:n,headerRowIndexWithoutSpan:n}}return{column:t,headerRowIndex:n,headerRowIndexWithoutSpan:n}}function Fz(e,t,i){let n=t+1,o={column:e,headerRowIndex:n,headerRowIndexWithoutSpan:n};if(e instanceof yd){if(n>=i)return{column:e.getDisplayedLeafColumns()[0],headerRowIndex:i,headerRowIndexWithoutSpan:n};let s=e.getDisplayedChildren()[0];if(s instanceof yd&&s.isPadding()){let l=s.getDisplayedLeafColumns()[0];l.isSpanHeaderHeight()&&(s=l)}o.column=s,s instanceof ua&&s.isSpanHeaderHeight()&&(o.headerRowIndex=i,o.headerRowIndexWithoutSpan=n)}return o}var Iz=class extends A{constructor(){super(...arguments),this.beanName="focusSvc",this.focusFallbackTimeout=null,this.needsFocusRestored=!1}wireBeans(e){this.colModel=e.colModel,this.visibleCols=e.visibleCols,this.rowRenderer=e.rowRenderer,this.navigation=e.navigation,this.filterManager=e.filterManager,this.overlays=e.overlays}postConstruct(){let e=this.clearFocusedCell.bind(this);this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:this.onColumnEverythingChanged.bind(this),columnGroupOpened:e,columnRowGroupChanged:e}),this.addDestroyFunc(JO(this.beans))}attemptToRecoverFocus(){this.needsFocusRestored=!0,this.focusFallbackTimeout!=null&&clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=window.setTimeout(this.setFocusRecovered.bind(this),100)}setFocusRecovered(){this.needsFocusRestored=!1,this.focusFallbackTimeout!=null&&(clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=null)}shouldTakeFocus(){return this.gos.get("suppressFocusAfterRefresh")?(this.setFocusRecovered(),!1):this.needsFocusRestored?(this.setFocusRecovered(),!0):this.doesRowOrCellHaveBrowserFocus()}onColumnEverythingChanged(){if(!this.focusedCell)return;let e=this.focusedCell.column,t=this.colModel.getCol(e.getId());e!==t&&this.clearFocusedCell()}getFocusCellToUseAfterRefresh(){let{gos:e,focusedCell:t}=this;return e.get("suppressFocusAfterRefresh")||e.get("suppressCellFocus")||!t||!this.doesRowOrCellHaveBrowserFocus()?null:t}getFocusHeaderToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedHeader||!this.isDomDataPresentInHierarchy(Ct(this.beans),NP)?null:this.focusedHeader}doesRowOrCellHaveBrowserFocus(){let e=Ct(this.beans);return this.isDomDataPresentInHierarchy(e,Wp)?!0:this.isDomDataPresentInHierarchy(e,Up)}isDomDataPresentInHierarchy(e,t){let i=e;for(;i;){if(_R(this.gos,i,t))return!0;i=i.parentNode}return!1}getFocusedCell(){return this.focusedCell}getFocusEventParams(e){let{rowIndex:t,rowPinned:i,column:n}=e,o={rowIndex:t,rowPinned:i,column:n,isFullWidthCell:!1},r=this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:i});return r&&(o.isFullWidthCell=r.isFullWidth()),o}clearFocusedCell(){if(this.focusedCell==null)return;let e=this.getFocusEventParams(this.focusedCell);this.focusedCell=null,this.eventSvc.dispatchEvent(b({type:"cellFocusCleared"},e))}setFocusedCell(e){this.setFocusRecovered();let{column:t,rowIndex:i,rowPinned:n,forceBrowserFocus:o=!1,preventScrollOnBrowserFocus:r=!1,sourceEvent:s}=e,a=this.colModel.getCol(t);if(!a){this.focusedCell=null;return}this.focusedCell={rowIndex:i,rowPinned:nr(n),column:a};let l=this.getFocusEventParams(this.focusedCell);this.eventSvc.dispatchEvent(z(b(b({type:"cellFocused"},l),this.previousCellFocusParams&&{previousParams:this.previousCellFocusParams}),{forceBrowserFocus:o,preventScrollOnBrowserFocus:r,sourceEvent:s})),this.previousCellFocusParams=l}isCellFocused(e){return this.focusedCell==null?!1:UP(e,this.focusedCell)}isHeaderWrapperFocused(e){if(this.focusedHeader==null)return!1;let{column:t,rowCtrl:{rowIndex:i,pinned:n}}=e,{column:o,headerRowIndex:r}=this.focusedHeader;return t===o&&i===r&&n==o.getPinned()}focusHeaderPosition(e){if(this.setFocusRecovered(),na(this.beans))return!1;let{direction:t,fromTab:i,allowUserOverride:n,event:o,fromCell:r,rowWithoutSpanValue:s,scroll:a=!0}=e,{headerPosition:l}=e;if(r&&this.filterManager?.isAdvFilterHeaderActive())return this.focusAdvancedFilter(l);if(n){let c=this.focusedHeader,d=mo(this.beans);if(i){let u=this.gos.getCallback("tabToNextHeader");u&&(l=this.getHeaderPositionFromUserFunc({userFunc:u,direction:t,currentPosition:c,headerPosition:l,headerRowCount:d}))}else{let u=this.gos.getCallback("navigateToNextHeader");if(u&&o){let h={key:o.key,previousHeaderPosition:c,nextHeaderPosition:l,headerRowCount:d,event:o};l=u(h)}}}return l?this.focusProvidedHeaderPosition({headerPosition:l,direction:t,event:o,fromCell:r,rowWithoutSpanValue:s,scroll:a}):!1}focusHeaderPositionFromUserFunc(e){if(na(this.beans))return!1;let{userFunc:t,headerPosition:i,direction:n,event:o}=e,r=this.focusedHeader,s=mo(this.beans),a=this.getHeaderPositionFromUserFunc({userFunc:t,direction:n,currentPosition:r,headerPosition:i,headerRowCount:s});return!!a&&this.focusProvidedHeaderPosition({headerPosition:a,direction:n,event:o})}getHeaderPositionFromUserFunc(e){let{userFunc:t,direction:i,currentPosition:n,headerPosition:o,headerRowCount:r}=e,a=t({backwards:i==="Before",previousHeaderPosition:n,nextHeaderPosition:o,headerRowCount:r});return a===!0?n:a===!1?null:a}focusProvidedHeaderPosition(e){let{headerPosition:t,direction:i,fromCell:n,rowWithoutSpanValue:o,event:r,scroll:s=!0}=e,{column:a,headerRowIndex:l}=t,{filterManager:c,ctrlsSvc:d,headerNavigation:u}=this.beans;if(this.focusedHeader&&vB(e.headerPosition,this.focusedHeader))return!1;if(l===-1)return c?.isAdvFilterHeaderActive()?this.focusAdvancedFilter(t):this.focusGridView({column:a,event:r});s&&u?.scrollToColumn(a,i);let p=d.getHeaderRowContainerCtrl(a.getPinned())?.focusHeader(t.headerRowIndex,a,r)||!1;return u&&p&&(o!=null||n)&&(u.currentHeaderRowWithoutSpan=o??-1),p}focusFirstHeader(){if(this.overlays?.isExclusive()&&this.focusOverlay())return!0;let e=this.visibleCols.allCols[0];if(!e)return!1;let t=dD(this.beans,e,0);return this.focusHeaderPosition({headerPosition:t,rowWithoutSpanValue:0})}focusLastHeader(e){if(this.overlays?.isExclusive()&&this.focusOverlay(!0))return!0;let t=mo(this.beans)-1,i=rt(this.visibleCols.allCols);return this.focusHeaderPosition({headerPosition:{headerRowIndex:t,column:i},rowWithoutSpanValue:-1,event:e})}focusPreviousFromFirstCell(e){return this.filterManager?.isAdvFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(e)}isAnyCellFocused(){return!!this.focusedCell}isRowFocused(e,t){return this.focusedCell==null?!1:this.focusedCell.rowIndex===e&&this.focusedCell.rowPinned===nr(t)}focusOverlay(e){let t=this.overlays?.isVisible()&&this.overlays.eWrapper?.getGui();return!!t&&aa(t,e)}focusGridView(e){let{backwards:t=!1,canFocusOverlay:i=!0,event:n}=e;if(this.overlays?.isExclusive())return i&&this.focusOverlay(t);if(ig(this.beans))return t&&!na(this.beans)?this.focusLastHeader():i&&this.focusOverlay(t)?!0:t?!1:Rl(this.beans,t);let o=t?XH(this.beans):YH(this.beans);if(o){let r=e.column??this.focusedHeader?.column,{rowIndex:s,rowPinned:a}=o,l=lr(this.beans,o);if(!r||!l||s==null)return!1;if(r.isSuppressNavigable(l)){let c=this.gos.get("enableRtl"),d;return!n||n.key===T.TAB?d=c?T.LEFT:T.RIGHT:d=n.key,this.beans.navigation?.navigateToNextCell(null,d,{rowIndex:s,column:r,rowPinned:a||null},!0),!0}return this.navigation?.ensureCellVisible({rowIndex:s,column:r,rowPinned:a}),t&&this.rowRenderer.getRowByPosition(o)?.isFullWidth()&&this.navigation?.tryToFocusFullWidthRow(o,t)||(this.setFocusedCell({rowIndex:s,column:r,rowPinned:nr(a),forceBrowserFocus:!0}),this.beans.rangeSvc?.setRangeToCell({rowIndex:s,rowPinned:a,column:r})),!0}return!!(i&&this.focusOverlay(t)||t&&this.focusLastHeader())}focusAdvancedFilter(e){return this.advFilterFocusColumn=e?.column,this.beans.advancedFilter?.getCtrl().focusHeaderComp()??!1}focusNextFromAdvancedFilter(e,t){let i=(t?void 0:this.advFilterFocusColumn)??this.visibleCols.allCols?.[0];return e?this.focusHeaderPosition({headerPosition:{column:i,headerRowIndex:mo(this.beans)-1}}):this.focusGridView({column:i})}clearAdvancedFilterColumn(){this.advFilterFocusColumn=void 0}},Az=class extends A{constructor(){super(...arguments),this.beanName="scrollVisibleSvc"}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colAnimation=e.colAnimation}postConstruct(){this.horizontalScrollShowing=this.gos.get("alwaysShowHorizontalScroll")===!0,this.verticalScrollShowing=this.gos.get("alwaysShowVerticalScroll")===!0,this.getScrollbarWidth(),this.addManagedEventListeners({displayedColumnsChanged:this.updateScrollVisible.bind(this),displayedColumnsWidthChanged:this.updateScrollVisible.bind(this)})}updateScrollVisible(){let{colAnimation:e}=this;e?.isActive()?e.executeLaterVMTurn(()=>{e.executeLaterVMTurn(()=>this.updateScrollVisibleImpl())}):this.updateScrollVisibleImpl()}updateScrollVisibleImpl(){let e=this.ctrlsSvc.get("center");if(!e||this.colAnimation?.isActive())return;let t={horizontalScrollShowing:e.isHorizontalScrollShowing(),verticalScrollShowing:this.verticalScrollShowing};this.setScrollsVisible(t),this.updateScrollGap()}updateScrollGap(){let e=this.ctrlsSvc.get("center"),t=e.hasHorizontalScrollGap(),i=e.hasVerticalScrollGap();(this.horizontalScrollGap!==t||this.verticalScrollGap!==i)&&(this.horizontalScrollGap=t,this.verticalScrollGap=i,this.eventSvc.dispatchEvent({type:"scrollGapChanged"}))}setScrollsVisible(e){(this.horizontalScrollShowing!==e.horizontalScrollShowing||this.verticalScrollShowing!==e.verticalScrollShowing)&&(this.horizontalScrollShowing=e.horizontalScrollShowing,this.verticalScrollShowing=e.verticalScrollShowing,this.eventSvc.dispatchEvent({type:"scrollVisibilityChanged"}))}getScrollbarWidth(){if(this.scrollbarWidth==null){let e=this.gos.get("scrollbarWidth"),i=typeof e=="number"&&e>=0?e:UO();i!=null&&(this.scrollbarWidth=i,this.eventSvc.dispatchEvent({type:"scrollbarWidthChanged"}))}return this.scrollbarWidth}},Lz=class extends A{constructor(){super(...arguments),this.beanName="gridDestroySvc",this.destroyCalled=!1}destroy(){if(this.destroyCalled)return;let{stateSvc:e,ctrlsSvc:t,context:i}=this.beans;this.eventSvc.dispatchEvent({type:"gridPreDestroyed",state:e?.getState()??{}}),this.destroyCalled=!0,t.get("gridCtrl")?.destroyGridUi(),i.destroy(),super.destroy()}},_p=new Set(["gridPreDestroyed","fillStart","pasteStart"]),Oz=["columnEverythingChanged","newColumnsLoaded","columnPivotModeChanged","pivotMaxColumnsExceeded","columnRowGroupChanged","expandOrCollapseAll","columnPivotChanged","gridColumnsChanged","columnValueChanged","columnMoved","columnVisible","columnPinned","columnGroupOpened","columnResized","displayedColumnsChanged","virtualColumnsChanged","columnHeaderMouseOver","columnHeaderMouseLeave","columnHeaderClicked","columnHeaderContextMenu","asyncTransactionsFlushed","rowGroupOpened","rowDataUpdated","pinnedRowDataChanged","pinnedRowsChanged","rangeSelectionChanged","cellSelectionChanged","chartCreated","chartRangeSelectionChanged","chartOptionsChanged","chartDestroyed","toolPanelVisibleChanged","toolPanelSizeChanged","modelUpdated","cutStart","cutEnd","pasteStart","pasteEnd","fillStart","fillEnd","cellSelectionDeleteStart","cellSelectionDeleteEnd","rangeDeleteStart","rangeDeleteEnd","undoStarted","undoEnded","redoStarted","redoEnded","cellClicked","cellDoubleClicked","cellMouseDown","cellContextMenu","cellValueChanged","cellEditRequest","rowValueChanged","headerFocused","cellFocused","rowSelected","selectionChanged","tooltipShow","tooltipHide","cellKeyDown","cellMouseOver","cellMouseOut","filterChanged","filterModified","filterUiChanged","filterOpened","floatingFilterUiChanged","advancedFilterBuilderVisibleChanged","sortChanged","virtualRowRemoved","rowClicked","rowDoubleClicked","gridReady","gridPreDestroyed","gridSizeChanged","viewportChanged","firstDataRendered","dragStarted","dragStopped","dragCancelled","rowEditingStarted","rowEditingStopped","cellEditingStarted","cellEditingStopped","bodyScroll","bodyScrollEnd","paginationChanged","componentStateChanged","storeRefreshed","stateUpdated","columnMenuVisibleChanged","contextMenuVisibleChanged","rowDragEnter","rowDragMove","rowDragLeave","rowDragEnd","rowDragCancel","findChanged","rowResizeStarted","rowResizeEnded","columnsReset","bulkEditingStarted","bulkEditingStopped","batchEditingStarted","batchEditingStopped"];var _w=Oz.reduce((e,t)=>(e[t]=LL(t),e),{}),Jc=(e,t)=>({tag:"span",ref:`eSort${e}`,cls:`ag-sort-indicator-icon ag-sort-${t} ag-hidden`,attrs:{"aria-hidden":"true"}}),Nz={tag:"span",cls:"ag-sort-indicator-container",children:[Jc("Order","order"),Jc("Asc","ascending-icon"),Jc("Desc","descending-icon"),Jc("Mixed","mixed-icon"),Jc("None","none-icon")]},Rw=class extends je{constructor(e){super(),this.eSortOrder=Z,this.eSortAsc=Z,this.eSortDesc=Z,this.eSortMixed=Z,this.eSortNone=Z,e||this.setTemplate(Nz)}attachCustomElements(e,t,i,n,o){this.eSortOrder=e,this.eSortAsc=t,this.eSortDesc=i,this.eSortMixed=n,this.eSortNone=o}setupSort(e,t=!1){if(this.column=e,this.suppressOrder=t,this.setupMultiSortIndicator(),!e.isSortable()&&!e.getColDef().showRowGroup)return;this.addInIcon("sortAscending",this.eSortAsc,e),this.addInIcon("sortDescending",this.eSortDesc,e),this.addInIcon("sortUnSort",this.eSortNone,e);let i=this.updateIcons.bind(this),n=this.onSortChanged.bind(this);this.addManagedPropertyListener("unSortIcon",i),this.addManagedEventListeners({newColumnsLoaded:i,sortChanged:n,columnRowGroupChanged:n}),this.onSortChanged()}addInIcon(e,t,i){if(t==null)return;let n=wn(e,this.beans,i);n&&t.appendChild(n)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){let{eSortAsc:e,eSortDesc:t,eSortNone:i,column:n,gos:o,beans:r}=this,s=r.sortSvc.getDisplaySortForColumn(n);if(e&&ft(e,s==="asc",{skipAriaHidden:!0}),t&&ft(t,s==="desc",{skipAriaHidden:!0}),i){let a=!n.getColDef().unSortIcon&&!o.get("unSortIcon"),l=s==null;ft(i,!a&&l,{skipAriaHidden:!0})}}setupMultiSortIndicator(){let{eSortMixed:e,column:t,gos:i}=this;this.addInIcon("sortUnSort",e,t);let n=t.getColDef().showRowGroup;go(i)&&n&&(this.addManagedEventListeners({sortChanged:this.updateMultiSortIndicator.bind(this),columnRowGroupChanged:this.updateMultiSortIndicator.bind(this)}),this.updateMultiSortIndicator())}updateMultiSortIndicator(){let{eSortMixed:e,beans:t,column:i}=this;if(e){let n=t.sortSvc.getDisplaySortForColumn(i)==="mixed";ft(e,n,{skipAriaHidden:!0})}}updateSortOrder(){let{eSortOrder:e,column:t,beans:{sortSvc:i}}=this;if(!e)return;let n=i.getColumnsWithSortingOrdered(),o=i.getDisplaySortIndexForColumn(t)??-1,r=n.some(a=>i.getDisplaySortIndexForColumn(a)??!1),s=o>=0&&r;ft(e,s,{skipAriaHidden:!0}),o>=0?e.textContent=(o+1).toString():ai(e)}},Bz={selector:"AG-SORT-INDICATOR",component:Rw},xd=["asc","desc",null],Hz=class extends A{constructor(){super(...arguments),this.beanName="sortSvc"}progressSort(e,t,i){let n=this.getNextSortDirection(e);this.setSortForColumn(e,n,t,i)}progressSortFromEvent(e,t){let n=this.gos.get("multiSortKey")==="ctrl"?t.ctrlKey||t.metaKey:t.shiftKey;this.progressSort(e,n,"uiColumnSorted")}setSortForColumn(e,t,i,n){t!=="asc"&&t!=="desc"&&(t=null);let{gos:o,showRowGroupCols:r}=this.beans,s=go(o),a=[e];if(s&&e.getColDef().showRowGroup){let u=r?.getSourceColumnsForGroupColumn?.(e)?.filter(h=>h.isSortable());u&&(a=[e,...u])}for(let d of a)this.setColSort(d,t,n);let l=(i||o.get("alwaysMultiSort"))&&!o.get("suppressMultiSort"),c=[];if(!l){let d=this.clearSortBarTheseColumns(a,n);c.push(...d)}this.updateSortIndex(e),c.push(...a),this.dispatchSortChangedEvents(n,c)}updateSortIndex(e){let{gos:t,colModel:i,showRowGroupCols:n}=this.beans,o=go(t),r=n?.getShowRowGroupCol(e.getId()),s=o&&r||e,a=this.getColumnsWithSortingOrdered();i.forAllCols(d=>this.setColSortIndex(d,null));let l=a.filter(d=>o&&d.getColDef().showRowGroup?!1:d!==s);(s.getSort()?[...l,s]:l).forEach((d,u)=>this.setColSortIndex(d,u))}onSortChanged(e,t){this.dispatchSortChangedEvents(e,t)}isSortActive(){let e=!1;return this.beans.colModel.forAllCols(t=>{t.getSort()&&(e=!0)}),e}dispatchSortChangedEvents(e,t){let i={type:"sortChanged",source:e};t&&(i.columns=t),this.eventSvc.dispatchEvent(i)}clearSortBarTheseColumns(e,t){let i=[];return this.beans.colModel.forAllCols(n=>{e.includes(n)||(n.getSort()&&i.push(n),this.setColSort(n,void 0,t))}),i}getNextSortDirection(e){let t=e.getColDef().sortingOrder??this.gos.get("sortingOrder")??xd,i=t.indexOf(e.getSort()),n=i<0,o=i==t.length-1;return n||o?t[0]:t[i+1]}getIndexedSortMap(){let{gos:e,colModel:t,showRowGroupCols:i,rowGroupColsSvc:n}=this.beans,o=[];if(t.forAllCols(c=>{c.getSort()&&o.push(c)}),t.isPivotMode()){let c=go(e);o=o.filter(d=>{let u=!!d.getAggFunc(),h=!d.isPrimary(),p=c?i?.getShowRowGroupCol(d.getId()):d.getColDef().showRowGroup;return u||h||p})}let r=n?.columns.filter(c=>!!c.getSort())??[],s={};o.forEach((c,d)=>s[c.getId()]=d),o.sort((c,d)=>{let u=c.getSortIndex(),h=d.getSortIndex();if(u!=null&&h!=null)return u-h;if(u==null&&h==null){let p=s[c.getId()],g=s[d.getId()];return p>g?1:-1}else return h==null?-1:1});let a=go(e)&&!!r.length;a&&(o=[...new Set(o.map(c=>i?.getShowRowGroupCol(c.getId())??c))]);let l=new Map;if(o.forEach((c,d)=>l.set(c,d)),a)for(let c of r){let d=i.getShowRowGroupCol(c.getId());l.set(c,l.get(d))}return l}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort(([,e],[,t])=>e-t).map(([e])=>e)}getSortModel(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),colId:e.getId()}))}getSortOptions(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),column:e}))}canColumnDisplayMixedSort(e){let t=go(this.gos),i=!!e.getColDef().showRowGroup;return t&&i}getDisplaySortForColumn(e){let t=this.beans.showRowGroupCols?.getSourceColumnsForGroupColumn(e);if(!this.canColumnDisplayMixedSort(e)||!t?.length)return e.getSort();let n=e.getColDef().field!=null||!!e.getColDef().valueGetter?[e,...t]:t,o=n[0].getSort();return n.every(s=>s.getSort()==o)?o:"mixed"}getDisplaySortIndexForColumn(e){return this.getIndexedSortMap().get(e)}setupHeader(e,t,i){let n=0;e.addManagedListeners(t,{movingChanged:()=>{n=Date.now()}}),i&&e.addManagedElementListeners(i,{click:r=>{let s=t.isMoving(),l=Date.now()-n<50;s||l||this.progressSortFromEvent(t,r)}});let o=()=>{let r=t.getSort();if(e.toggleCss("ag-header-cell-sorted-asc",r==="asc"),e.toggleCss("ag-header-cell-sorted-desc",r==="desc"),e.toggleCss("ag-header-cell-sorted-none",!r),t.getColDef().showRowGroup){let l=!this.beans.showRowGroupCols?.getSourceColumnsForGroupColumn(t)?.every(c=>t.getSort()==c.getSort());e.toggleCss("ag-header-cell-sorted-mixed",l)}};e.addManagedEventListeners({sortChanged:o,columnRowGroupChanged:o})}initCol(e){let{sort:t,initialSort:i,sortIndex:n,initialSortIndex:o}=e.colDef;t!==void 0?(t==="asc"||t==="desc")&&(e.sort=t):(i==="asc"||i==="desc")&&(e.sort=i),n!==void 0?n!==null&&(e.sortIndex=n):o!==null&&(e.sortIndex=o)}updateColSort(e,t,i){t!==void 0&&(t==="desc"||t==="asc"?this.setColSort(e,t,i):this.setColSort(e,void 0,i))}setColSort(e,t,i){e.sort!==t&&(e.sort=t,e.dispatchColEvent("sortChanged",i)),e.dispatchStateUpdatedEvent("sort")}setColSortIndex(e,t){e.sortIndex=t,e.dispatchStateUpdatedEvent("sortIndex")}createSortIndicator(e){return new Rw(e)}getSortIndicatorSelector(){return Bz}},wl={agSetColumnFilter:"SetFilter",agSetColumnFloatingFilter:"SetFilter",agMultiColumnFilter:"MultiFilter",agMultiColumnFloatingFilter:"MultiFilter",agGroupColumnFilter:"GroupFilter",agGroupColumnFloatingFilter:"GroupFilter",agGroupCellRenderer:"GroupCellRenderer",agGroupRowRenderer:"GroupCellRenderer",agRichSelect:"RichSelect",agRichSelectCellEditor:"RichSelect",agDetailCellRenderer:"SharedMasterDetail",agSparklineCellRenderer:"Sparklines",agDragAndDropImage:"SharedDragAndDrop",agColumnHeader:"ColumnHeaderComp",agColumnGroupHeader:"ColumnGroupHeaderComp",agSortIndicator:"Sort",agAnimateShowChangeCellRenderer:"HighlightChanges",agAnimateSlideCellRenderer:"HighlightChanges",agLoadingCellRenderer:"LoadingCellRenderer",agSkeletonCellRenderer:"SkeletonCellRenderer",agCheckboxCellRenderer:"CheckboxCellRenderer",agLoadingOverlay:"Overlay",agNoRowsOverlay:"Overlay",agTooltipComponent:"Tooltip",agReadOnlyFloatingFilter:"CustomFilter",agTextColumnFilter:"TextFilter",agNumberColumnFilter:"NumberFilter",agDateColumnFilter:"DateFilter",agDateInput:"DateFilter",agTextColumnFloatingFilter:"TextFilter",agNumberColumnFloatingFilter:"NumberFilter",agDateColumnFloatingFilter:"DateFilter",agCellEditor:"TextEditor",agSelectCellEditor:"SelectEditor",agTextCellEditor:"TextEditor",agNumberCellEditor:"NumberEditor",agDateCellEditor:"DateEditor",agDateStringCellEditor:"DateEditor",agCheckboxCellEditor:"CheckboxEditor",agLargeTextCellEditor:"LargeTextEditor",agMenuItem:"MenuItem",agColumnsToolPanel:"ColumnsToolPanel",agFiltersToolPanel:"FiltersToolPanel",agNewFiltersToolPanel:"NewFiltersToolPanel",agAggregationComponent:"StatusBar",agSelectedRowCountComponent:"StatusBar",agTotalRowCountComponent:"StatusBar",agFilteredRowCountComponent:"StatusBar",agTotalAndFilteredRowCountComponent:"StatusBar",agFindCellRenderer:"Find"};function P_(e){return`"${e}"`}var Vz=()=>({checkboxSelection:{version:"32.2",message:"Use `rowSelection.checkboxes` in `GridOptions` instead."},headerCheckboxSelection:{version:"32.2",message:"Use `rowSelection.headerCheckbox = true` in `GridOptions` instead."},headerCheckboxSelectionFilteredOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "filtered"` in `GridOptions` instead.'},headerCheckboxSelectionCurrentPageOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "currentPage"` in `GridOptions` instead.'},showDisabledCheckboxes:{version:"32.2",message:"Use `rowSelection.hideDisabledCheckboxes = true` in `GridOptions` instead."},rowGroupingHierarchy:{version:"34.3",message:"Use `colDef.groupHierarchy` instead."}}),Gz={aggFunc:"SharedAggregation",autoHeight:"RowAutoHeight",cellClass:"CellStyle",cellClassRules:"CellStyle",cellEditor:({cellEditor:e,editable:t})=>t?typeof e=="string"?wl[e]??"CustomEditor":"CustomEditor":null,cellRenderer:({cellRenderer:e})=>typeof e!="string"?null:wl[e],cellStyle:"CellStyle",columnChooserParams:"ColumnMenu",contextMenuItems:"ContextMenu",dndSource:"DragAndDrop",dndSourceOnRowDrag:"DragAndDrop",editable:({editable:e,cellEditor:t})=>e&&!t?"TextEditor":null,enableCellChangeFlash:"HighlightChanges",enablePivot:"SharedPivot",enableRowGroup:"SharedRowGrouping",enableValue:"SharedAggregation",filter:({filter:e})=>e&&typeof e!="string"&&typeof e!="boolean"?"CustomFilter":typeof e=="string"?wl[e]??"ColumnFilter":"ColumnFilter",floatingFilter:"ColumnFilter",getQuickFilterText:"QuickFilter",headerTooltip:"Tooltip",headerTooltipValueGetter:"Tooltip",mainMenuItems:"ColumnMenu",menuTabs:e=>{let t=["columnsMenuTab","generalMenuTab"];return e.menuTabs?.some(i=>t.includes(i))?"ColumnMenu":null},pivot:"SharedPivot",pivotIndex:"SharedPivot",rowDrag:"RowDrag",rowGroup:"SharedRowGrouping",rowGroupIndex:"SharedRowGrouping",tooltipField:"Tooltip",tooltipValueGetter:"Tooltip",tooltipComponentSelector:"Tooltip",spanRows:"CellSpan",groupHierarchy:"SharedRowGrouping"},zz=()=>({autoHeight:{supportedRowModels:["clientSide","serverSide"],validate:(t,{paginationAutoPageSize:i})=>i?"colDef.autoHeight is not supported with paginationAutoPageSize.":null},cellRendererParams:{validate:t=>(t.rowGroup!=null||t.rowGroupIndex!=null||t.cellRenderer==="agGroupCellRenderer")&&"checkbox"in t.cellRendererParams?'Since v33.0, `cellRendererParams.checkbox` has been deprecated. Use `rowSelection.checkboxLocation = "autoGroupColumn"` instead.':null},flex:{validate:(t,i)=>i.autoSizeStrategy?"colDef.flex is not supported with gridOptions.autoSizeStrategy":null},headerCheckboxSelection:{supportedRowModels:["clientSide","serverSide"],validate:(t,{rowSelection:i})=>i==="multiple"?null:"headerCheckboxSelection is only supported with rowSelection=multiple"},headerCheckboxSelectionCurrentPageOnly:{supportedRowModels:["clientSide"],validate:(t,{rowSelection:i})=>i==="multiple"?null:"headerCheckboxSelectionCurrentPageOnly is only supported with rowSelection=multiple"},headerCheckboxSelectionFilteredOnly:{supportedRowModels:["clientSide"],validate:(t,{rowSelection:i})=>i==="multiple"?null:"headerCheckboxSelectionFilteredOnly is only supported with rowSelection=multiple"},headerValueGetter:{validate:t=>{let i=t.headerValueGetter;return typeof i=="function"||typeof i=="string"?null:"headerValueGetter must be a function or a valid string expression"}},icons:{validate:({icons:t})=>{if(t){if(t.smallDown)return Co(262);if(t.smallLeft)return Co(263);if(t.smallRight)return Co(264)}return null}},sortingOrder:{validate:t=>{let i=t.sortingOrder;if(Array.isArray(i)&&i.length>0){let n=i.filter(o=>!xd.includes(o));if(n.length>0)return`sortingOrder must be an array with elements from [${xd.map(Ip).join()}], currently it includes [${n.map(Ip).join()}]`}else if(!Array.isArray(i)||i.length<=0)return`sortingOrder must be an array with at least one element, currently it's ${i}`;return null}},type:{validate:t=>{let i=t.type;return i instanceof Array?i.some(o=>typeof o!="string")?"if colDef.type is supplied an array it should be of type 'string[]'":null:typeof i=="string"?null:"colDef.type should be of type 'string' | 'string[]'"}},rowSpan:{validate:(t,{suppressRowTransform:i})=>i?null:"colDef.rowSpan requires suppressRowTransform to be enabled."},spanRows:{dependencies:{editable:{required:[!1,void 0]},rowDrag:{required:[!1,void 0]},colSpan:{required:[void 0]},rowSpan:{required:[void 0]}},validate:(t,{rowSelection:i,cellSelection:n,suppressRowTransform:o,enableCellSpan:r,rowDragEntireRow:s,enableCellTextSelection:a})=>typeof i=="object"&&i?.mode==="singleRow"&&i?.enableClickSelection?"colDef.spanRows is not supported with rowSelection.clickSelection":n?"colDef.spanRows is not supported with cellSelection.":o?"colDef.spanRows is not supported with suppressRowTransform.":r?s?"colDef.spanRows is not supported with rowDragEntireRow.":a?"colDef.spanRows is not supported with enableCellTextSelection.":null:"colDef.spanRows requires enableCellSpan to be enabled."},groupHierarchy:{validate(t,{groupHierarchyConfig:i={}},n){let o=new Set(["year","quarter","month","formattedMonth","day","hour","minute","second"]),r=[];for(let s of t.groupHierarchy??[]){if(typeof s=="object"){n.validation?.validateColDef(s);continue}!o.has(s)&&!(s in i)&&r.push(P_(s))}if(r.length>0){let s=`The following parts of colDef.groupHierarchy are not recognised: ${r.join(", ")}.`,a=`Choose one of ${[...o].map(P_).join(", ")}, or define your own parts in gridOptions.groupHierarchyConfig.`;return`${s}
${a}`}return null}}}),Wz={headerName:void 0,columnGroupShow:void 0,headerStyle:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,headerTooltipValueGetter:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellAriaRole:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnChooserParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressHeaderMenuButton:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,spanRows:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,tooltipComponentSelector:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0,mainMenuItems:void 0,contextMenuItems:void 0,suppressFloatingFilterButton:void 0,suppressHeaderFilterButton:void 0,suppressHeaderContextMenu:void 0,loadingCellRenderer:void 0,loadingCellRendererParams:void 0,loadingCellRendererSelector:void 0,context:void 0,dateComponent:void 0,dateComponentParams:void 0,getFindText:void 0,rowGroupingHierarchy:void 0,groupHierarchy:void 0},Uz=()=>Object.keys(Wz),qz=()=>({objectName:"colDef",allProperties:Uz(),docsUrl:"column-properties/",deprecations:Vz(),validations:zz()}),$z=["overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","groupDisplayType","treeDataDisplayType","treeDataChildrenField","treeDataParentIdField","colResizeDefault","tooltipTrigger","serverSidePivotResultFieldSeparator","columnMenu","tooltipShowMode","invalidEditValueMode","grandTotalRow","themeCssLayer","findSearchValue","styleNonce","renderingMode"],jz=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","dragAndDropImageComponentParams","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","themeStyleContainer","statusBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions","advancedFilterParent","advancedFilterBuilderParams","advancedFilterParams","initialState","autoSizeStrategy","selectionColumnDef","findOptions","filterHandlers","groupHierarchyConfig"],Kz=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass","paginationPageSizeSelector"],uD=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","groupLockGroupColumns","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","pivotDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDuration","cellFadeDuration","tabIndex","pivotMaxGeneratedColumns","rowDragInsertDelay"],Yz=["theme","rowSelection"],Pw=["cellSelection","sideBar","rowNumbers","suppressGroupChangesColumnVisibility","groupAggFiltering","suppressStickyTotalRow","groupHideParentOfSingleChild","enableRowPinning"],hD=["loadThemeGoogleFonts","suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHeaderFocus","suppressHorizontalScroll","groupSelectsChildren","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressColumnMoveAnimation","suppressMoveWhenColumnDragging","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","allowContextMenuWithControlKey","suppressContextMenu","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressFocusAfterRefresh","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","enableCellSpan","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","includeHiddenColumnsInAdvancedFilter","suppressMultiRangeSelection","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","tooltipInteraction","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideSortAllLevels","serverSideEnableClientSideSort","serverSideOnlyRefreshFilteredGroups","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","groupMaintainOrder","columnHoverHighlight","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressCutToClipboard","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","enableAdvancedFilter","masterDetail","treeData","reactiveCustomComponents","applyQuickFilterBeforePivotOrAgg","suppressServerSideFullWidthLoadingRow","suppressAdvancedFilterEval","loading","maintainColumnOrder","enableStrictPivotColumnOrder","suppressSetFilterByDefault","enableFilterHandlers","suppressStartEditOnTab","hidePaddedHeaderRows","ssrmExpandAllAffectsAllRows"],Xz=["doesExternalFilterPass","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","dragAndDropImageComponent","fullWidthCellRenderer","loadingCellRenderer","loadingOverlayComponent","noRowsOverlayComponent","detailCellRenderer","quickFilterParser","quickFilterMatcher","getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getFullRowEditValidationErrors","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","focusGridInnerElement","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processUnpinnedColumns","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","loadingCellRendererSelector","getRowId","chartMenuItems","groupTotalRow","alwaysPassFilter","isRowPinnable","isRowPinned","isRowValidDropPosition"],Jz=()=>[...Kz,...jz,...$z,...uD,...Xz,...hD,...Pw,...Yz],Qz=()=>({suppressLoadingOverlay:{version:"32",message:"Use `loading`=false instead."},enableFillHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeSelection:{version:"32.2",message:"Use `cellSelection = true` instead."},suppressMultiRangeSelection:{version:"32.2",message:"Use `cellSelection.suppressMultiRanges` instead."},suppressClearOnFillReduction:{version:"32.2",message:"Use `cellSelection.handle.suppressClearOnFillReduction` instead."},fillHandleDirection:{version:"32.2",message:"Use `cellSelection.handle.direction` instead."},fillOperation:{version:"32.2",message:"Use `cellSelection.handle.setFillValue` instead."},suppressRowClickSelection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},suppressRowDeselection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},rowMultiSelectWithClick:{version:"32.2",message:"Use `rowSelection.enableSelectionWithoutKeys` instead."},groupSelectsChildren:{version:"32.2",message:'Use `rowSelection.groupSelects = "descendants"` instead.'},groupSelectsFiltered:{version:"32.2",message:'Use `rowSelection.groupSelects = "filteredDescendants"` instead.'},isRowSelectable:{version:"32.2",message:"Use `selectionOptions.isRowSelectable` instead."},suppressCopySingleCellRanges:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},suppressCopyRowsToClipboard:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},onRangeSelectionChanged:{version:"32.2",message:"Use `onCellSelectionChanged` instead."},onRangeDeleteStart:{version:"32.2",message:"Use `onCellSelectionDeleteStart` instead."},onRangeDeleteEnd:{version:"32.2",message:"Use `onCellSelectionDeleteEnd` instead."},suppressBrowserResizeObserver:{version:"32.2",message:"The grid always uses the browser's ResizeObserver, this grid option has no effect."},onColumnEverythingChanged:{version:"32.2",message:"Either use `onDisplayedColumnsChanged` which is fired at the same time, or use one of the more specific column events."},groupRemoveSingleChildren:{version:"33",message:"Use `groupHideParentOfSingleChild` instead."},groupRemoveLowestSingleChildren:{version:"33",message:'Use `groupHideParentOfSingleChild: "leafGroupsOnly"` instead.'},suppressRowGroupHidesColumns:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressHideOnGroup"` instead.'},suppressMakeColumnVisibleAfterUnGroup:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressShowOnUngroup"` instead.'},unSortIcon:{version:"33",message:"Use `defaultColDef.unSortIcon` instead."},sortingOrder:{version:"33",message:"Use `defaultColDef.sortingOrder` instead."},suppressPropertyNamesCheck:{version:"33",message:"`gridOptions` and `columnDefs` both have a `context` property that should be used for arbitrary user data. This means that column definitions and gridOptions should only contain valid properties making this property redundant."},suppressAdvancedFilterEval:{version:"34",message:"Advanced filter no longer uses function evaluation, so this option has no effect."}});function ho(e,t,i){return typeof t=="number"||t==null?t==null||t>=i?null:`${e}: value should be greater than or equal to ${i}`:`${e}: value should be a number`}var Zz={alignedGrids:"AlignedGrids",allowContextMenuWithControlKey:"ContextMenu",autoSizeStrategy:"ColumnAutoSize",cellSelection:"CellSelection",columnHoverHighlight:"ColumnHover",datasource:"InfiniteRowModel",doesExternalFilterPass:"ExternalFilter",editType:"EditCore",invalidEditValueMode:"EditCore",enableAdvancedFilter:"AdvancedFilter",enableCellSpan:"CellSpan",enableCharts:"IntegratedCharts",enableRangeSelection:"CellSelection",enableRowPinning:"PinnedRow",findSearchValue:"Find",getFullRowEditValidationErrors:"EditCore",getContextMenuItems:"ContextMenu",getLocaleText:"Locale",getMainMenuItems:"ColumnMenu",getRowClass:"RowStyle",getRowStyle:"RowStyle",groupTotalRow:"SharedRowGrouping",grandTotalRow:"ClientSideRowModelHierarchy",initialState:"GridState",isExternalFilterPresent:"ExternalFilter",isRowPinnable:"PinnedRow",isRowPinned:"PinnedRow",localeText:"Locale",masterDetail:"SharedMasterDetail",pagination:"Pagination",pinnedBottomRowData:"PinnedRow",pinnedTopRowData:"PinnedRow",pivotMode:"SharedPivot",pivotPanelShow:"RowGroupingPanel",quickFilterText:"QuickFilter",rowClass:"RowStyle",rowClassRules:"RowStyle",rowData:"ClientSideRowModel",rowDragManaged:"RowDrag",rowGroupPanelShow:"RowGroupingPanel",rowNumbers:"RowNumbers",rowSelection:"SharedRowSelection",rowStyle:"RowStyle",serverSideDatasource:"ServerSideRowModel",sideBar:"SideBar",statusBar:"StatusBar",treeData:"SharedTreeData",undoRedoCellEditing:"UndoRedoEdit",valueCache:"ValueCache",viewportDatasource:"ViewportRowModel"},eW=()=>{let e={autoSizePadding:{validate({autoSizePadding:i}){return ho("autoSizePadding",i,0)}},cacheBlockSize:{supportedRowModels:["serverSide","infinite"],validate({cacheBlockSize:i}){return ho("cacheBlockSize",i,1)}},cacheOverflowSize:{validate({cacheOverflowSize:i}){return ho("cacheOverflowSize",i,1)}},datasource:{supportedRowModels:["infinite"]},domLayout:{validate:i=>{let n=i.domLayout,o=["autoHeight","normal","print"];return n&&!o.includes(n)?`domLayout must be one of [${o.join()}], currently it's ${n}`:null}},enableFillHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeSelection:{dependencies:{rowDragEntireRow:{required:[!1,void 0]}}},enableRowPinning:{supportedRowModels:["clientSide"],validate({enableRowPinning:i,pinnedTopRowData:n,pinnedBottomRowData:o}){return i&&(n||o)?"Manual row pinning cannot be used together with pinned row data. Either set `enableRowPinning` to `false`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":null}},isRowPinnable:{supportedRowModels:["clientSide"],validate({enableRowPinning:i,isRowPinnable:n,pinnedTopRowData:o,pinnedBottomRowData:r}){return n&&(o||r)?"Manual row pinning cannot be used together with pinned row data. Either remove `isRowPinnable`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":!i&&n?"`isRowPinnable` requires `enableRowPinning` to be set.":null}},isRowPinned:{supportedRowModels:["clientSide"],validate({enableRowPinning:i,isRowPinned:n,pinnedTopRowData:o,pinnedBottomRowData:r}){return n&&(o||r)?"Manual row pinning cannot be used together with pinned row data. Either remove `isRowPinned`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":!i&&n?"`isRowPinned` requires `enableRowPinning` to be set.":null}},groupDefaultExpanded:{supportedRowModels:["clientSide"]},groupHideOpenParents:{supportedRowModels:["clientSide","serverSide"],dependencies:{groupTotalRow:{required:[void 0,"bottom"]},treeData:{required:[void 0,!1],reason:"Tree Data has values at the group level so it doesn't make sense to hide them."}}},groupHideParentOfSingleChild:{dependencies:{groupHideOpenParents:{required:[void 0,!1]}}},groupRemoveLowestSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveSingleChildren:{required:[void 0,!1]}}},groupRemoveSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveLowestSingleChildren:{required:[void 0,!1]}}},groupSelectsChildren:{dependencies:{rowSelection:{required:["multiple"]}}},groupHierarchyConfig:{validate({groupHierarchyConfig:i={}},n,o){for(let r of Object.keys(i))o.validation?.validateColDef(i[r]);return null}},icons:{validate:({icons:i})=>{if(i){if(i.smallDown)return Co(262);if(i.smallLeft)return Co(263);if(i.smallRight)return Co(264)}return null}},infiniteInitialRowCount:{validate({infiniteInitialRowCount:i}){return ho("infiniteInitialRowCount",i,1)}},initialGroupOrderComparator:{supportedRowModels:["clientSide"]},ssrmExpandAllAffectsAllRows:{validate:i=>{if(typeof i.ssrmExpandAllAffectsAllRows=="boolean"){if(i.rowModelType!=="serverSide")return"'ssrmExpandAllAffectsAllRows' is only supported with the Server Side Row Model.";if(i.ssrmExpandAllAffectsAllRows&&typeof i.getRowId!="function")return"'getRowId' callback must be provided for Server Side Row Model grouping to work correctly."}return null}},keepDetailRowsCount:{validate({keepDetailRowsCount:i}){return ho("keepDetailRowsCount",i,1)}},paginationPageSize:{validate({paginationPageSize:i}){return ho("paginationPageSize",i,1)}},paginationPageSizeSelector:{validate:i=>{let n=i.paginationPageSizeSelector;return typeof n=="boolean"||n==null||n.length?null:`'paginationPageSizeSelector' cannot be an empty array.
                    If you want to hide the page size selector, set paginationPageSizeSelector to false.`}},pivotMode:{dependencies:{treeData:{required:[!1,void 0],reason:"Pivot Mode is not supported with Tree Data."}}},quickFilterText:{supportedRowModels:["clientSide"]},rowBuffer:{validate({rowBuffer:i}){return ho("rowBuffer",i,0)}},rowClass:{validate:i=>typeof i.rowClass=="function"?"rowClass should not be a function, please use getRowClass instead":null},rowData:{supportedRowModels:["clientSide"]},rowDragManaged:{supportedRowModels:["clientSide"],dependencies:{pagination:{required:[!1,void 0]}}},rowSelection:{validate({rowSelection:i}){return i&&typeof i=="string"?'As of version 32.2.1, using `rowSelection` with the values "single" or "multiple" has been deprecated. Use the object value instead.':i&&typeof i!="object"?"Expected `RowSelectionOptions` object for the `rowSelection` property.":i&&i.mode!=="multiRow"&&i.mode!=="singleRow"?`Selection mode "${i.mode}" is invalid. Use one of 'singleRow' or 'multiRow'.`:null}},rowStyle:{validate:i=>{let n=i.rowStyle;return n&&typeof n=="function"?"rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead":null}},serverSideDatasource:{supportedRowModels:["serverSide"]},serverSideInitialRowCount:{supportedRowModels:["serverSide"],validate({serverSideInitialRowCount:i}){return ho("serverSideInitialRowCount",i,1)}},serverSideOnlyRefreshFilteredGroups:{supportedRowModels:["serverSide"]},serverSideSortAllLevels:{supportedRowModels:["serverSide"]},sortingOrder:{validate:i=>{let n=i.sortingOrder;if(Array.isArray(n)&&n.length>0){let o=n.filter(r=>!xd.includes(r));if(o.length>0)return`sortingOrder must be an array with elements from [${xd.map(Ip).join()}], currently it includes [${o.map(Ip).join()}]`}else if(!Array.isArray(n)||n.length<=0)return`sortingOrder must be an array with at least one element, currently it's ${n}`;return null}},tooltipHideDelay:{validate:i=>i.tooltipHideDelay&&i.tooltipHideDelay<0?"tooltipHideDelay should not be lower than 0":null},tooltipShowDelay:{validate:i=>i.tooltipShowDelay&&i.tooltipShowDelay<0?"tooltipShowDelay should not be lower than 0":null},treeData:{supportedRowModels:["clientSide","serverSide"],validate:i=>{let n=i.rowModelType??"clientSide";switch(n){case"clientSide":{let{treeDataChildrenField:o,treeDataParentIdField:r,getDataPath:s,getRowId:a}=i;if(!o&&!r&&!s)return"treeData requires either 'treeDataChildrenField' or 'treeDataParentIdField' or 'getDataPath' in the clientSide row model.";if(o){if(s)return"Cannot use both 'treeDataChildrenField' and 'getDataPath' at the same time.";if(r)return"Cannot use both 'treeDataChildrenField' and 'treeDataParentIdField' at the same time."}if(r){if(!a)return"getRowId callback not provided, tree data with parent id cannot be built.";if(s)return"Cannot use both 'treeDataParentIdField' and 'getDataPath' at the same time."}return null}case"serverSide":{let o=`treeData requires 'isServerSideGroup' and 'getServerSideGroupKey' in the ${n} row model.`;return i.isServerSideGroup&&i.getServerSideGroupKey?null:o}}return null}},viewportDatasource:{supportedRowModels:["viewport"]},viewportRowModelBufferSize:{validate({viewportRowModelBufferSize:i}){return ho("viewportRowModelBufferSize",i,0)}},viewportRowModelPageSize:{validate({viewportRowModelPageSize:i}){return ho("viewportRowModelPageSize",i,1)}},rowDragEntireRow:{dependencies:{cellSelection:{required:[void 0]}}},autoGroupColumnDef:{validate({autoGroupColumnDef:i,showOpenedGroup:n}){return i?.field&&n?"autoGroupColumnDef.field and showOpenedGroup are not supported when used together.":i?.valueGetter&&n?"autoGroupColumnDef.valueGetter and showOpenedGroup are not supported when used together.":null}},renderingMode:{validate:i=>{let n=i.renderingMode,o=["default","legacy"];return n&&!o.includes(n)?`renderingMode must be one of [${o.join()}], currently it's ${n}`:null}},autoSizeStrategy:{validate:({autoSizeStrategy:i})=>{if(!i)return null;let n=["fitCellContents","fitGridWidth","fitProvidedWidth"],o=i.type;return o!=="fitCellContents"&&o!=="fitGridWidth"&&o!=="fitProvidedWidth"?`Invalid Auto-size strategy. \`autoSizeStrategy\` must be one of ${n.map(r=>'"'+r+'"').join(", ")}, currently it's ${o}`:o==="fitProvidedWidth"&&typeof i.width!="number"?`When using the 'fitProvidedWidth' auto-size strategy, must provide a numeric \`width\`. You provided ${i.width}`:null}}},t={};for(let i of hD)t[i]={expectedType:"boolean"};for(let i of uD)t[i]={expectedType:"number"};return Fi(t,e),t},tW=()=>({objectName:"gridOptions",allProperties:[...Jz(),...Object.values(_w)],propertyExceptions:["api"],docsUrl:"grid-options/",deprecations:Qz(),validations:eW()}),iW=0,nW=0,D_="__ag_grid_instance",oW=class extends A{constructor(){super(...arguments),this.beanName="gos",this.domDataKey="__AG_"+Math.random().toString(),this.instanceId=nW++,this.gridReadyFired=!1,this.queueEvents=[],this.propEventSvc=new ra,this.globalEventHandlerFactory=e=>(t,i)=>{if(!this.isAlive())return;let n=_p.has(t);if(n&&!e||!n&&e||!rW(t))return;let o=(r,s)=>{let a=_w[r],l=this.gridOptions[a];typeof l=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>l(s))};if(this.gridReadyFired)o(t,i);else if(t==="gridReady"){o(t,i),this.gridReadyFired=!0;for(let r of this.queueEvents)o(r.eventName,r.event);this.queueEvents=[]}else this.queueEvents.push({eventName:t,event:i})}}wireBeans(e){this.gridOptions=e.gridOptions,this.validation=e.validation,this.api=e.gridApi,this.gridId=e.context.getId()}get gridOptionsContext(){return this.gridOptions.context}postConstruct(){this.validateGridOptions(this.gridOptions),this.eventSvc.addGlobalListener(this.globalEventHandlerFactory().bind(this),!0),this.eventSvc.addGlobalListener(this.globalEventHandlerFactory(!0).bind(this),!1),this.propEventSvc.setFrameworkOverrides(this.beans.frameworkOverrides),this.addManagedEventListeners({gridOptionsChanged:({options:e})=>{this.updateGridOptions({options:e,force:!0,source:"optionsUpdated"})}})}destroy(){super.destroy(),this.queueEvents=[]}get(e){return this.gridOptions[e]??cL[e]}getCallback(e){return this.mergeGridCommonParams(this.gridOptions[e])}exists(e){return ie(this.gridOptions[e])}mergeGridCommonParams(e){return e&&(i=>e(this.addCommon(i)))}updateGridOptions({options:e,force:t,source:i="api"}){let n={id:iW++,properties:[]},o=[],{gridOptions:r,validation:s}=this;for(let a of Object.keys(e)){let l=ZC.applyGlobalGridOption(a,e[a]);s?.warnOnInitialPropertyUpdate(i,a);let c=t||typeof l=="object"&&i==="api",d=r[a];if(c||d!==l){r[a]=l;let u={type:a,currentValue:l,previousValue:d,changeSet:n,source:i};o.push(u)}}this.validateGridOptions(this.gridOptions),n.properties=o.map(a=>a.type);for(let a of o)Qr(this,`Updated property ${a.type} from`,a.previousValue," to ",a.currentValue),this.propEventSvc.dispatchEvent(a)}addPropertyEventListener(e,t){this.propEventSvc.addEventListener(e,t)}removePropertyEventListener(e,t){this.propEventSvc.removeEventListener(e,t)}getDomDataKey(){return this.domDataKey}addCommon(e){return e.api=this.api,e.context=this.gridOptionsContext,e}validateOptions(e,t){for(let i of Object.keys(e)){let n=e[i];if(n==null||n===!1)continue;let o=t[i];typeof o=="function"&&(o=o(e,this.gridOptions,this.beans)),o&&this.assertModuleRegistered(o,i)}}validateGridOptions(e){this.validateOptions(e,Zz),this.validation?.processGridOptions(e)}validateColDef(e,t,i){(i||!this.beans.dataTypeSvc?.isColPendingInference(t))&&(this.validateOptions(e,Gz),this.validation?.validateColDef(e))}assertModuleRegistered(e,t){let i=Array.isArray(e)?e.some(n=>this.isModuleRegistered(n)):this.isModuleRegistered(e);return i||tt(200,z(b({},this.getModuleErrorParams()),{moduleName:e,reasonOrId:t})),i}getModuleErrorParams(){return{gridId:this.gridId,gridScoped:ew(),rowModelType:this.get("rowModelType"),isUmd:CR()}}isModuleRegistered(e){return pC(e,this.gridId,this.get("rowModelType"))}setInstanceDomData(e){e[D_]=this.instanceId}isElementInThisInstance(e){let t=e;for(;t;){let i=t[D_];if(ie(i))return i===this.instanceId;t=t.parentElement}return!1}};function rW(e){return!!_w[e]}function pD(e){let t={"aria-hidden":"true"};return{tag:"div",cls:"ag-cell-label-container",role:"presentation",children:[{tag:"span",ref:"eMenu",cls:"ag-header-icon ag-header-cell-menu-button",attrs:t},{tag:"span",ref:"eFilterButton",cls:"ag-header-icon ag-header-cell-filter-button",attrs:t},{tag:"div",ref:"eLabel",cls:"ag-header-cell-label",role:"presentation",children:[{tag:"span",ref:"eText",cls:"ag-header-cell-text"},{tag:"span",ref:"eFilter",cls:"ag-header-icon ag-header-label-icon ag-filter-icon",attrs:t},e?{tag:"ag-sort-indicator",ref:"eSortIndicator"}:null]}]}}var sW=pD(!0),aW=pD(!1),lW=class extends je{constructor(){super(...arguments),this.eFilter=Z,this.eFilterButton=Z,this.eSortIndicator=Z,this.eMenu=Z,this.eLabel=Z,this.eText=Z,this.eSortOrder=Z,this.eSortAsc=Z,this.eSortDesc=Z,this.eSortMixed=Z,this.eSortNone=Z,this.isLoadingInnerComponent=!1}refresh(e){let t=this.params;if(this.params=e,this.workOutTemplate(e,!!this.beans?.sortSvc)!=this.currentTemplate||this.workOutShowMenu()!=this.currentShowMenu||e.enableSorting!=this.currentSort||this.currentSuppressMenuHide!=null&&this.shouldSuppressMenuHide()!=this.currentSuppressMenuHide||t.enableFilterButton!=e.enableFilterButton||t.enableFilterIcon!=e.enableFilterIcon)return!1;if(this.innerHeaderComponent){let i=b({},e);Fi(i,e.innerHeaderComponentParams),this.innerHeaderComponent.refresh?.(i)}else this.setDisplayName(e);return!0}workOutTemplate(e,t){let i=e.template;return i?i?.trim?i.trim():i:t?sW:aW}init(e){this.params=e;let{sortSvc:t,touchSvc:i,rowNumbersSvc:n,userCompFactory:o}=this.beans,r=t?.getSortIndicatorSelector();this.currentTemplate=this.workOutTemplate(e,!!r),this.setTemplate(this.currentTemplate,r?[r]:void 0),i?.setupForHeader(this),this.setMenu(),this.setupSort(),n?.setupForHeader(this),this.setupFilterIcon(),this.setupFilterButton(),this.workOutInnerHeaderComponent(o,e),this.setDisplayName(e)}workOutInnerHeaderComponent(e,t){let i=MO(e,t,t);i&&(this.isLoadingInnerComponent=!0,i.newAgStackInstance().then(n=>{this.isLoadingInnerComponent=!1,n&&(this.isAlive()?(this.innerHeaderComponent=n,this.eText&&this.eText.appendChild(n.getGui())):this.destroyBean(n))}))}setDisplayName(e){let{displayName:t}=e,i=this.currentDisplayName;this.currentDisplayName=t,!(!this.eText||i===t||this.innerHeaderComponent||this.isLoadingInnerComponent)&&(this.eText.textContent=Dl(t))}addInIcon(e,t,i){let n=wn(e,this.beans,i);n&&t.appendChild(n)}workOutShowMenu(){return this.params.enableMenu&&!!this.beans.menuSvc?.isHeaderMenuButtonEnabled()}shouldSuppressMenuHide(){return!!this.beans.menuSvc?.isHeaderMenuButtonAlwaysShowEnabled()}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu){zi(this.eMenu),this.eMenu=void 0;return}let{gos:e,eMenu:t,params:i}=this,n=tn(e);this.addInIcon(n?"menu":"menuAlt",t,i.column),t.classList.toggle("ag-header-menu-icon",!n);let o=this.shouldSuppressMenuHide();this.currentSuppressMenuHide=o,this.addManagedElementListeners(t,{click:()=>this.showColumnMenu(this.eMenu)}),this.toggleMenuAlwaysShow(o)}toggleMenuAlwaysShow(e){this.eMenu?.classList.toggle("ag-header-menu-always-show",e)}showColumnMenu(e){let{currentSuppressMenuHide:t,params:i}=this;t||this.toggleMenuAlwaysShow(!0),i.showColumnMenu(e,()=>{t||this.toggleMenuAlwaysShow(!1)})}onMenuKeyboardShortcut(e){let{params:t,gos:i,beans:n,eMenu:o,eFilterButton:r}=this,s=t.column,a=tn(i);if(e&&!a){if(n.menuSvc?.isFilterMenuInHeaderEnabled(s))return t.showFilter(r??o??this.getGui()),!0}else if(t.enableMenu)return this.showColumnMenu(o??r??this.getGui()),!0;return!1}setupSort(){let{sortSvc:e}=this.beans;if(!e)return;let{enableSorting:t,column:i}=this.params;if(this.currentSort=t,!this.eSortIndicator){this.eSortIndicator=this.createBean(e.createSortIndicator(!0));let{eSortIndicator:n,eSortOrder:o,eSortAsc:r,eSortDesc:s,eSortMixed:a,eSortNone:l}=this;n.attachCustomElements(o,r,s,a,l)}this.eSortIndicator.setupSort(i),this.currentSort&&e.setupHeader(this,i,this.eLabel)}setupFilterIcon(){let{eFilter:e,params:t}=this;if(!e)return;let i=()=>{let n=t.column.isFilterActive();ft(e,n,{skipAriaHidden:!0})};this.configureFilter(t.enableFilterIcon,e,i,"filterActive")}setupFilterButton(){let{eFilterButton:e,params:t}=this;if(!e)return;this.configureFilter(t.enableFilterButton,e,this.onFilterChangedButton.bind(this),"filter")?this.addManagedElementListeners(e,{click:()=>t.showFilter(e)}):this.eFilterButton=void 0}configureFilter(e,t,i,n){if(!e)return zi(t),!1;let o=this.params.column;return this.addInIcon(n,t,o),this.addManagedListeners(o,{filterChanged:i}),i(),!0}onFilterChangedButton(){let e=this.params.column.isFilterActive();this.eFilterButton.classList.toggle("ag-filter-active",e)}getAnchorElementForMenu(e){let{eFilterButton:t,eMenu:i}=this;return e?t??i??this.getGui():i??t??this.getGui()}destroy(){super.destroy(),this.innerHeaderComponent&&(this.destroyBean(this.innerHeaderComponent),this.innerHeaderComponent=void 0)}},cW={tag:"div",cls:"ag-header-group-cell-label",role:"presentation",children:[{tag:"span",ref:"agLabel",cls:"ag-header-group-text",role:"presentation"},{tag:"span",ref:"agOpened",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"},{tag:"span",ref:"agClosed",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"}]},dW=class extends je{constructor(){super(cW),this.agOpened=Z,this.agClosed=Z,this.agLabel=Z,this.isLoadingInnerComponent=!1}init(e){let{userCompFactory:t,touchSvc:i}=this.beans;this.params=e,this.checkWarnings(),this.workOutInnerHeaderGroupComponent(t,e),this.setupLabel(e),this.addGroupExpandIcon(e),this.setupExpandIcons(),i?.setupForHeaderGroup(this)}checkWarnings(){this.params.template&&W(89)}workOutInnerHeaderGroupComponent(e,t){let i=TO(e,t,t);i&&(this.isLoadingInnerComponent=!0,i.newAgStackInstance().then(n=>{this.isLoadingInnerComponent=!1,n&&(this.isAlive()?(this.innerHeaderGroupComponent=n,this.agLabel.appendChild(n.getGui())):this.destroyBean(n))}))}setupExpandIcons(){let{agOpened:e,agClosed:t,params:{columnGroup:i},beans:n}=this;this.addInIcon("columnGroupOpened",e),this.addInIcon("columnGroupClosed",t);let o=l=>{if(sr(l))return;let c=!i.isExpanded();n.colGroupSvc.setColumnGroupOpened(i.getProvidedColumnGroup(),c,"uiColumnExpanded")};this.addTouchAndClickListeners(n,t,o),this.addTouchAndClickListeners(n,e,o);let r=l=>{la(l)};this.addManagedElementListeners(t,{dblclick:r}),this.addManagedElementListeners(e,{dblclick:r}),this.addManagedElementListeners(this.getGui(),{dblclick:o}),this.updateIconVisibility();let s=i.getProvidedColumnGroup(),a=this.updateIconVisibility.bind(this);this.addManagedListeners(s,{expandedChanged:a,expandableChanged:a})}addTouchAndClickListeners(e,t,i){e.touchSvc?.setupForHeaderGroupElement(this,t,i),this.addManagedElementListeners(t,{click:i})}updateIconVisibility(){let{agOpened:e,agClosed:t,params:{columnGroup:i}}=this;if(i.isExpandable()){let n=i.isExpanded();ft(e,n),ft(t,!n)}else ft(e,!1),ft(t,!1)}addInIcon(e,t){let i=wn(e,this.beans,null);i&&t.appendChild(i)}addGroupExpandIcon(e){if(!e.columnGroup.isExpandable()){let{agOpened:t,agClosed:i}=this;ft(t,!1),ft(i,!1)}}setupLabel(e){let{displayName:t,columnGroup:i}=e,n=this.innerHeaderGroupComponent||this.isLoadingInnerComponent;ie(t)&&!n&&(this.agLabel.textContent=Dl(t)),this.toggleCss("ag-sticky-label",!i.getColGroupDef()?.suppressStickyLabel)}destroy(){super.destroy(),this.innerHeaderGroupComponent&&(this.destroyBean(this.innerHeaderGroupComponent),this.innerHeaderGroupComponent=void 0)}},uW={moduleName:"ColumnHeaderComp",version:ee,userComponents:{agColumnHeader:lW},icons:{menu:"menu",menuAlt:"menu-alt"}},hW={moduleName:"ColumnGroupHeaderComp",version:ee,userComponents:{agColumnGroupHeader:dW},icons:{columnGroupOpened:"expanded",columnGroupClosed:"contracted"}},pW=class extends A{constructor(){super(...arguments),this.beanName="animationFrameSvc",this.p1={list:[],sorted:!1},this.p2={list:[],sorted:!1},this.f1={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastScrollTop=0,this.taskCount=0}setScrollTop(e){this.scrollGoingDown=e>=this.lastScrollTop,e===0&&(this.scrollGoingDown=!0),this.lastScrollTop=e}postConstruct(){this.active=!this.gos.get("suppressAnimationFrame"),this.batchFrameworkComps=this.beans.frameworkOverrides.batchFrameworkComps}verify(){this.active===!1&&W(92)}createTask(e,t,i,n,o=!1){this.verify();let r=i;n&&this.batchFrameworkComps&&(r="f1");let s={task:e,index:t,createOrder:++this.taskCount,deferred:o};this.addTaskToList(this[r],s),this.schedule()}addTaskToList(e,t){e.list.push(t),e.sorted=!1}sortTaskList(e){if(e.sorted)return;let t=this.scrollGoingDown?1:-1;e.list.sort((i,n)=>i.deferred!==n.deferred?i.deferred?-1:1:i.index!==n.index?t*(n.index-i.index):n.createOrder-i.createOrder),e.sorted=!0}addDestroyTask(e){this.verify(),this.destroyTasks.push(e),this.schedule()}executeFrame(e){let{p1:t,p2:i,f1:n,destroyTasks:o,beans:r}=this,{ctrlsSvc:s,frameworkOverrides:a}=r,l=t.list,c=i.list,d=n.list,u=Date.now(),h=0,p=e<=0,g=s.getScrollFeature();for(;p||h<e;){if(!g.scrollGridIfNeeded()){let m;if(l.length)this.sortTaskList(t),m=l.pop().task;else if(c.length)this.sortTaskList(i),m=c.pop().task;else if(d.length)a.wrapOutgoing(()=>{for(;(p||h<e)&&!g.scrollGridIfNeeded();){if(d.length)this.sortTaskList(n),m=d.pop().task,m();else break;h=Date.now()-u}}),m=()=>{};else if(o.length)m=o.pop();else break;m()}h=Date.now()-u}l.length||c.length||d.length||o.length?this.requestFrame():this.ticking=!1}flushAllFrames(){this.active&&this.executeFrame(-1)}schedule(){this.active&&(this.ticking||(this.ticking=!0,this.requestFrame()))}requestFrame(){let e=this.executeFrame.bind(this,60);cr(this.beans,e)}isQueueEmpty(){return!this.ticking}},gW={moduleName:"AnimationFrame",version:ee,beans:[pW]},fW=class extends A{constructor(){super(...arguments),this.beanName="iconSvc"}createIconNoSpan(e,t){return wn(e,this.beans,t?.column)}},mW=class extends A{constructor(){super(...arguments),this.beanName="touchSvc"}mockBodyContextMenu(e,t){this.mockContextMenu(e,e.eBodyViewport,t)}mockHeaderContextMenu(e,t){this.mockContextMenu(e,e.eGui,t)}mockRowContextMenu(e){if(!ia())return;let t=(i,n,o)=>{let{rowCtrl:r,cellCtrl:s}=e.getControlsForEventTarget(o?.target??null);s?.column&&s.dispatchCellContextMenuEvent(o??null),this.beans.contextMenuSvc?.handleContextMenuMouseEvent(void 0,o,r,s)};this.mockContextMenu(e,e.element,t)}handleCellDoubleClick(e,t){return(()=>{if(!ia()||dR("dblclick"))return!1;let n=Date.now(),o=n-e.lastIPadMouseClickEvent<200;return e.lastIPadMouseClickEvent=n,o})()?(e.onCellDoubleClicked(t),t.preventDefault(),!0):!1}setupForHeader(e){let{gos:t,sortSvc:i,menuSvc:n}=this.beans;if(t.get("suppressTouch"))return;let{params:o,eMenu:r,eFilterButton:s}=e,a=new Xs(e.getGui(),!0);e.addDestroyFunc(()=>a.destroy());let l=e.shouldSuppressMenuHide(),c=l&&ie(r)&&o.enableMenu,d=a;if(c&&(d=new Xs(r,!0),e.addDestroyFunc(()=>d.destroy())),o.enableMenu||n?.isHeaderContextMenuEnabled(o.column)){let u=c?"tap":"longTap",h=p=>o.showColumnMenuAfterMouseClick(p.touchStart);e.addManagedListeners(d,{[u]:h}),e.addManagedListeners(a,{longTap:h})}if(o.enableSorting){let u=h=>{let p=h.touchStart.target;l&&(r?.contains(p)||s?.contains(p))||i?.progressSort(o.column,!1,"uiColumnSorted")};e.addManagedListeners(a,{tap:u})}if(o.enableFilterButton&&s){let u=new Xs(s,!0);e.addManagedListeners(u,{tap:()=>o.showFilter(s)}),e.addDestroyFunc(()=>u.destroy())}}setupForHeaderGroup(e){let t=e.params;if(this.beans.menuSvc?.isHeaderContextMenuEnabled(t.columnGroup.getProvidedColumnGroup())){let i=new Xs(t.eGridHeader,!0),n=o=>t.showColumnMenuAfterMouseClick(o.touchStart);e.addManagedListeners(i,{longTap:n}),e.addDestroyFunc(()=>i.destroy())}}setupForHeaderGroupElement(e,t,i){let n=new Xs(t,!0);e.addManagedListeners(n,{tap:i}),e.addDestroyFunc(()=>n.destroy())}mockContextMenu(e,t,i){if(!ia())return;let n=new Xs(t),o=r=>{md(this.beans,r.touchEvent)&&i(void 0,r.touchStart,r.touchEvent)};e.addManagedListeners(n,{longTap:o}),e.addDestroyFunc(()=>n.destroy())}},vW={moduleName:"Touch",version:ee,beans:[mW]},CW=class extends A{constructor(){super(...arguments),this.beanName="cellNavigation"}wireBeans(e){this.rowSpanSvc=e.rowSpanSvc}getNextCellToFocus(e,t,i=!1){return i?this.getNextCellToFocusWithCtrlPressed(e,t):this.getNextCellToFocusWithoutCtrlPressed(e,t)}getNextCellToFocusWithCtrlPressed(e,t){let i=e===T.UP,n=e===T.DOWN,o=e===T.LEFT,r,s,{pageBounds:a,gos:l,visibleCols:c,pinnedRowModel:d}=this.beans,{rowPinned:u}=t;if(i||n)u&&d?i?s=0:s=u==="top"?d.getPinnedTopRowCount()-1:d.getPinnedBottomRowCount()-1:s=i?a.getFirstRow():a.getLastRow(),r=t.column;else{let h=l.get("enableRtl");s=t.rowIndex,r=(o!==h?c.allCols:[...c.allCols].reverse()).find(g=>this.isCellGoodToFocusOn({rowIndex:s,rowPinned:null,column:g}))}return r?{rowIndex:s,rowPinned:u,column:r}:null}getNextCellToFocusWithoutCtrlPressed(e,t){let i=t,n=!1;for(;!n;){switch(e){case T.UP:i=this.getCellAbove(i);break;case T.DOWN:i=this.getCellBelow(i);break;case T.RIGHT:i=this.gos.get("enableRtl")?this.getCellToLeft(i):this.getCellToRight(i);break;case T.LEFT:i=this.gos.get("enableRtl")?this.getCellToRight(i):this.getCellToLeft(i);break;default:i=null,W(8,{key:e});break}i?n=this.isCellGoodToFocusOn(i):n=!0}return i}isCellGoodToFocusOn(e){let t=e.column,i,{pinnedRowModel:n,rowModel:o}=this.beans;switch(e.rowPinned){case"top":i=n?.getPinnedTopRow(e.rowIndex);break;case"bottom":i=n?.getPinnedBottomRow(e.rowIndex);break;default:i=o.getRow(e.rowIndex);break}return i?!this.isSuppressNavigable(t,i):!1}getCellToLeft(e){if(!e)return null;let t=this.beans.visibleCols.getColBefore(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellToRight(e){if(!e)return null;let t=this.beans.visibleCols.getColAfter(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellBelow(e){if(!e)return null;let t=this.rowSpanSvc?.getCellEnd(e)??e,i=g_(this.beans,t,!0);return i?{rowIndex:i.rowIndex,column:e.column,rowPinned:i.rowPinned}:null}getCellAbove(e){if(!e)return null;let t=this.rowSpanSvc?.getCellStart(e)??e,i=qp(this.beans,{rowIndex:t.rowIndex,rowPinned:t.rowPinned},!0);return i?{rowIndex:i.rowIndex,column:e.column,rowPinned:i.rowPinned}:null}getNextTabbedCell(e,t){return t?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)}getNextTabbedCellForwards(e){let{visibleCols:t,pagination:i}=this.beans,n=t.allCols,o=e.rowIndex,r=e.rowPinned,s=t.getColAfter(e.column);if(!s){s=n[0];let a=g_(this.beans,e,!0);if(mt(a)||!a.rowPinned&&!(i?.isRowInPage(a.rowIndex)??!0))return null;o=a?a.rowIndex:null,r=a?a.rowPinned:null}return{rowIndex:o,column:s,rowPinned:r}}getNextTabbedCellBackwards(e){let{beans:t}=this,{visibleCols:i,pagination:n}=t,o=i.allCols,r=e.rowIndex,s=e.rowPinned,a=i.getColBefore(e.column);if(!a){a=rt(o);let l=qp(t,{rowIndex:e.rowIndex,rowPinned:e.rowPinned},!0);if(mt(l)||!l.rowPinned&&!(n?.isRowInPage(l.rowIndex)??!0))return null;r=l?l.rowIndex:null,s=l?l.rowPinned:null}return{rowIndex:r,column:a,rowPinned:s}}isSuppressNavigable(e,t){let{suppressNavigable:i}=e.colDef;if(typeof i=="boolean")return i;if(typeof i=="function"){let n=e.createColumnFunctionCallbackParams(t);return i(n)}return!1}};function wW(e){return e.focusSvc.getFocusedCell()}function bW(e){return e.focusSvc.clearFocusedCell()}function yW(e,t,i,n){e.focusSvc.setFocusedCell({rowIndex:t,column:i,rowPinned:n,forceBrowserFocus:!0})}function SW(e,t){return e.navigation?.tabToNextCell(!1,t)??!1}function xW(e,t){return e.navigation?.tabToNextCell(!0,t)??!1}function EW(e,t,i=!1){let n=e.headerNavigation?.getHeaderPositionForColumn(t,i);n&&e.focusSvc.focusHeaderPosition({headerPosition:n})}var _W=class extends A{constructor(){super(...arguments),this.beanName="editModelSvc",this.edits=new Map,this.cellValidations=new gD,this.rowValidations=new fD,this.suspendEdits=!1}suspend(e){this.suspendEdits=e}removeEdits({rowNode:e,column:t}){if(!this.hasEdits({rowNode:e})||!e)return;let i=this.getEditRow(e);t?i.delete(t):i.clear(),i.size===0&&this.edits.delete(e)}getEditRow(e,t={}){if(this.suspendEdits||this.edits.size===0)return;let i=e&&this.edits.get(e);if(i)return i;if(t.checkSiblings){let n=e.pinnedSibling;if(n)return this.getEditRow(n)}}getEditRowDataValue(e,{checkSiblings:t}={}){if(!e||this.edits.size===0)return;let i=this.getEditRow(e),n=e.pinnedSibling,o=t&&n&&this.getEditRow(n);if(!i&&!o)return;let r=Object.assign({},e.data),s=(a,l)=>a.forEach(({pendingValue:c},d)=>{c!==bn&&(l[d.getColId()]=c)});return i&&s(i,r),o&&s(o,r),r}getEdit(e,t){let i=this._getEdit(e);return t&&i?b({},i):i}_getEdit(e){if(!this.suspendEdits&&this.edits.size!==0)return e.rowNode&&e.column&&this.getEditRow(e.rowNode)?.get(e.column)}getEditMap(e=!0){if(this.suspendEdits||this.edits.size===0)return new Map;if(!e)return this.edits;let t=new Map;return this.edits.forEach((i,n)=>{let o=new Map;i.forEach((l,a)=>{var c=l,{editorState:r}=c,s=Ai(c,["editorState"]);return o.set(a,b({},s))}),t.set(n,o)}),t}setEditMap(e){this.edits.clear(),e.forEach((t,i)=>{let n=new Map;t.forEach((o,r)=>n.set(r,b({},o))),this.edits.set(i,n)})}setEdit(e,t){(this.edits.size===0||!this.edits.has(e.rowNode))&&this.edits.set(e.rowNode,new Map);let i=this._getEdit(e),n=Object.assign(b(b({editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}},i),t));return this.getEditRow(e.rowNode).set(e.column,n),n}clearEditValue(e){let{rowNode:t,column:i}=e;if(t)if(i){let n=this._getEdit(e);n&&(n.editorValue=void 0,n.pendingValue=n.sourceValue,n.state="changed")}else this.getEditRow(t)?.forEach(n=>{n.editorValue=void 0,n.pendingValue=n.sourceValue,n.state="changed"})}getState(e){if(!this.suspendEdits)return this.getEdit(e)?.state}getEditPositions(e){if(this.suspendEdits||(e??this.edits).size===0)return[];let t=[];return(e??this.edits).forEach((i,n)=>{for(let r of i.keys()){let o=i.get(r),{editorState:s}=o,a=Ai(o,["editorState"]);t.push(b({rowNode:n,column:r},a))}}),t}hasRowEdits(e,t){return this.suspendEdits||this.edits.size===0?!1:!!this.getEditRow(e,t)}hasEdits(e={},t={}){if(this.suspendEdits||this.edits.size===0)return!1;let{rowNode:i,column:n}=e,{withOpenEditor:o}=t;if(i){let r=this.getEditRow(i,t);return r?n?o?this.getEdit(e)?.state==="editing":r.has(n)??!1:r.size!==0?o?Array.from(r.values()).some(({state:s})=>s==="editing"):!0:!1:!1}return o?this.getEditPositions().some(({state:r})=>r==="editing"):this.edits.size>0}start(e){let t=this.getEditRow(e.rowNode)??new Map,{rowNode:i,column:n}=e;n&&!t.has(n)&&t.set(n,{editorValue:void 0,pendingValue:bn,sourceValue:this.beans.valueSvc.getValue(n,i,!1,"api"),state:"editing",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}}),this.edits.set(i,t)}stop(e){this.hasEdits(e)&&(e?this.removeEdits(e):this.clear())}clear(){for(let e of this.edits.values())e.clear();this.edits.clear()}getCellValidationModel(){return this.cellValidations}getRowValidationModel(){return this.rowValidations}setCellValidationModel(e){this.cellValidations=e}setRowValidationModel(e){this.rowValidations=e}destroy(){super.destroy(),this.clear()}},gD=class{constructor(){this.cellValidations=new Map}getCellValidation(e){let{rowNode:t,column:i}=e||{};return this.cellValidations?.get(t)?.get(i)}hasCellValidation(e){return!e?.rowNode||!e.column?this.cellValidations.size>0:!!this.getCellValidation(e)}setCellValidation(e,t){let{rowNode:i,column:n}=e;this.cellValidations.has(i)||this.cellValidations.set(i,new Map),this.cellValidations.get(i).set(n,t)}clearCellValidation(e){let{rowNode:t,column:i}=e;this.cellValidations.get(t)?.delete(i)}setCellValidationMap(e){this.cellValidations=e}getCellValidationMap(){return this.cellValidations}clearCellValidationMap(){this.cellValidations.clear()}},fD=class{constructor(){this.rowValidations=new Map}getRowValidation(e){let{rowNode:t}=e||{};return this.rowValidations.get(t)}hasRowValidation(e){return e?.rowNode?!!this.getRowValidation(e):this.rowValidations.size>0}setRowValidation({rowNode:e},t){this.rowValidations.set(e,t)}clearRowValidation({rowNode:e}){this.rowValidations.delete(e)}setRowValidationMap(e){this.rowValidations=e}getRowValidationMap(){return this.rowValidations}clearRowValidationMap(){this.rowValidations.clear()}};function Dw(e,t={}){let{rowIndex:i,rowId:n,rowCtrl:o,rowPinned:r}=t;if(o)return o;let{rowModel:s,rowRenderer:a}=e,{rowNode:l}=t;return l||(n?l=JH(e,n,r):i!=null&&(l=s.getRow(i))),a.getRowCtrls(l?[l]:[])?.[0]}function vt(e,t={}){let{cellCtrl:i,colId:n,columnId:o,column:r}=t;if(i)return i;let s=e.colModel.getCol(n??o??NC(r)),a=t.rowCtrl??Dw(e,t),l=a?.getCellCtrl(s)??void 0;if(l)return l;let c=t.rowNode??a?.rowNode;if(c)return e.rowRenderer.getCellCtrls([c],[s])?.[0]}function M_(e){let{editSvc:t}=e;t?.isBatchEditing()?bl(e):t?.stopEditing(void 0,{source:"api"})}function RW(e,t,i){let{gos:n,popupSvc:o}=t;if(!n.get("stopEditingWhenCellsLoseFocus"))return;let r=s=>{let a=s.relatedTarget;if(yC(a)===null){M_(t);return}let l=i.some(c=>c.contains(a))&&n.isElementInThisInstance(a);l||(l=!!o&&(o.getActivePopups().some(c=>c.contains(a))||o.isElementWithinCustomPopup(a))),l||M_(t)};for(let s of i)e.addManagedElementListeners(s,{focusout:r})}function NC(e){if(e)return typeof e=="string"?e:e.getColId()}var bn=Symbol("unedited");function mD(e,t={}){let i=[],n=e.rowRenderer.getCellCtrls(t.rowNodes,t.columns);for(let o of n){let r=o.comp?.getCellEditor();r&&i.push({ctrl:o,editor:bd(r)})}return i}var PW=(e,t={})=>mD(e,t).map(i=>i.editor);function DW(e,t,i,n,o,r){t.length===0&&i?.rowNode&&i?.column&&Pl(e,i,{key:n,event:o,cellStartedEdit:r});let{valueSvc:s,editSvc:a,editModelSvc:l}=e,{rowNode:c,column:d}=i??{};for(let u of t){let{rowNode:h,column:p}=u,g=vt(e,u);if(!g){if(h&&p){let m=s.getValue(p,h,void 0,"api"),w=(i?.rowNode===h&&i?.column===p&&n||void 0)??a?.getCellDataValue(u,!1)??s.getValueForDisplay(p,h)?.value??m??bn;l?.setEdit(u,{pendingValue:w,sourceValue:m,state:"editing"})}continue}let f=r&&c===g.rowNode&&g.column===d;Pl(e,{rowNode:c,column:g.column},{key:f?n:null,event:f?o:null,cellStartedEdit:f&&r})}}function ir({pendingValue:e,sourceValue:t}){return e===bn&&(e=t),e!==t}function Pl(e,t,i){let n=e.gos.get("enableGroupEdit"),{key:o,event:r,cellStartedEdit:s,silent:a}=i??{},l=vt(e,t),c=l?.comp?.getCellEditor(),d=CD(e,t,o,s&&!a),u=e.editModelSvc?.getEdit(t),h=d.value;if(h===void 0&&(h=u?.sourceValue),e.editModelSvc?.setEdit(t,{editorValue:h,state:"editing"}),c){c.refresh?.(d);return}let p=t.column.getColDef(),g=XR(e.userCompFactory,p,d),f=g?.popupFromSelector!=null?g.popupFromSelector:!!p.cellEditorPopup,m=g?.popupPositionFromSelector!=null?g.popupPositionFromSelector:p.cellEditorPopupPosition;if(wD(g.params,r),l){l.editCompDetails=g,l.onEditorAttachedFuncs.push(()=>l.rangeFeature?.unsetComp()),l.comp?.setEditDetails(g,f,m,e.gos.get("reactiveCustomComponents")),l?.rowCtrl?.refreshRow({suppressFlash:!0});let v=e.editModelSvc?.getEdit(t,!0);!a&&!v?.editorState?.cellStartedEditing&&(e.editSvc?.dispatchCellEvent(t,r,"cellEditingStarted",n?{value:h}:{}),e.editModelSvc?.setEdit(t,{editorState:{cellStartedEditing:!0}}))}}function vD(e,t,i){let n={editorValueExists:!1};if(Mw(e)&&(t.getValidationErrors?.()?.length??0)>0||i?.isCancelling)return n;if(i?.isStopping){let r=t?.isCancelAfterEnd?.();if(r)return z(b({},n),{isCancelAfterEnd:r})}return{editorValue:t.getValue(),editorValueExists:!0}}function CD(e,t,i,n){let{valueSvc:o,gos:r,editSvc:s}=e,a=e.gos.get("enableGroupEdit"),l=vt(e,t),c=t.rowNode?.rowIndex??void 0,d=s?.isBatchEditing(),u=e.colModel.getCol(t.column.getId()),{rowNode:h,column:p}=t,g=l.comp?.getCellEditor(),f=s?.getCellDataValue(t,!1),m=f===void 0?g?vD(e,g)?.editorValue:void 0:f,v=m===bn?o.getValueForDisplay(u,h)?.value:m;return ye(r,{value:a?m:v,eventKey:i??null,column:p,colDef:p.getColDef(),rowIndex:c,node:h,data:h.data,cellStartedEdit:n??!1,onKeyDown:l?.onKeyDown.bind(l),stopEditing:C=>{s.stopEditing(t,{source:d?"ui":"api",suppressNavigateAfterEdit:C}),$p(e,t)},eGridCell:l?.eGui,parseValue:C=>o.parseValue(u,h,C,l?.value),formatValue:l?.formatValue.bind(l),validate:()=>{s?.validateEdit()}})}function BC(e,t){let{editModelSvc:i}=e;i?.getEditMap().forEach((n,o)=>{n.forEach((r,s)=>{!t&&(r.state==="editing"||r.pendingValue===bn)||!ir(r)&&(r.state!=="editing"||t)&&i?.removeEdits({rowNode:o,column:s})})})}function MW(e,t){let i=t.comp?.getCellEditor();if(!i?.refresh)return;let{eventKey:n,cellStartedEdit:o}=t.editCompDetails.params,{column:r}=t,s=CD(e,t,n,o),a=r.getColDef(),l=XR(e.userCompFactory,a,s);i.refresh(wD(l.params,n))}function wD(e,t){return t instanceof KeyboardEvent&&e.column.getColDef().cellEditor==="agNumberCellEditor"?e.suppressPreventDefault=["-","+",".","e"].includes(t?.key??"")||e.suppressPreventDefault:t?.preventDefault?.(),e}function Qs(e,t){for(let i of e.editModelSvc?.getEditPositions()??[]){let n=vt(e,i);if(!n)continue;let o=n.comp?.getCellEditor();if(!o)continue;let{editorValue:r,editorValueExists:s,isCancelAfterEnd:a}=vD(e,o,t);a&&e.editModelSvc?.setEdit(i,{editorState:{isCancelAfterEnd:a}}),Rp(e,i,r,void 0,!s,t)}}function Rp(e,t,i,n,o,r){let{editModelSvc:s,valueSvc:a}=e;if(!s)return;let{rowNode:l,column:c}=t;if(!(l&&c))return;let d=s.getEdit(t,!0);d?.sourceValue||(d=s.setEdit(t,{sourceValue:a.getValue(c,l,void 0,"api"),pendingValue:d?d.editorValue:bn})),s.setEdit(t,{editorValue:o?d.sourceValue:i}),r?.persist&&kW(e,t)}function kW(e,t){let{editModelSvc:i}=e,n=i?.getEdit(t,!0);i?.setEdit(t,{pendingValue:n?.editorValue})}function bl(e,t,i){t||(t=e.editModelSvc?.getEditPositions());for(let n of t??[])$p(e,n,i)}function $p(e,t,i){let n=e.gos.get("enableGroupEdit"),{editModelSvc:o}=e,r=vt(e,t),s=o?.getEdit(t,!0);if(!r){s&&o?.setEdit(t,{state:"changed"});return}let{comp:a}=r;if(a&&!a.getCellEditor()){if(r?.refreshCell(),s){o?.setEdit(t,{state:"changed"});let c=n?k_(i,s):{valueChanged:!1,newValue:void 0,oldValue:s.sourceValue};T_(e,t,c,i)}return}if(Mw(e)){let c=a?.getCellEditor()?.getValidationErrors?.(),d=o?.getCellValidationModel();c?.length?d?.setCellValidation(t,{errorMessages:c}):d?.clearCellValidation(t)}o?.setEdit(t,{state:"changed"}),a?.setEditDetails(),a?.refreshEditStyles(!1,!1),r?.refreshCell({force:!0,suppressFlash:!0});let l=o?.getEdit(t);if(l&&l.state==="changed"){let c=n?k_(i,l):{valueChanged:ir(l)&&!i?.cancel,newValue:i?.cancel||l.editorState.isCancelAfterEnd?void 0:l?.editorValue??s?.pendingValue,oldValue:l?.sourceValue};T_(e,t,c,i)}}function k_(e,t){return e?.cancel?{valueChanged:!1,oldValue:t.sourceValue,newValue:void 0,value:t.sourceValue}:{valueChanged:!1,oldValue:t.sourceValue,newValue:t.pendingValue,value:t.sourceValue}}function T_(e,t,i,{silent:n,event:o}={}){let{editSvc:r,editModelSvc:s}=e,a=s?.getEdit(t),{editorState:l}=a||{},{isCancelBeforeStart:c}=l||{};!n&&!c&&(r?.dispatchCellEvent(t,o,"cellEditingStopped",i),s?.setEdit(t,{editorState:{cellStoppedEditing:!0}}))}function Mw(e){let{gos:t,colModel:i}=e,n=!!t.get("getFullRowEditValidationErrors"),o=i.getColumnDefs()?.filter(s=>s.editable).some(({cellEditorParams:s})=>{let{minLength:a,maxLength:l,getValidationErrors:c,min:d,max:u}=s||{};return a!==void 0||l!==void 0||c!==void 0||d!==void 0||u!==void 0}),r=e.gridApi.getCellEditorInstances().some(s=>s.getValidationElement||s.getValidationErrors);return o||n||r}function ca(e,t){if(!(t||Mw(e)))return;let i=mD(e),n=new gD,{ariaAnnounce:o,localeSvc:r,editModelSvc:s,gos:a}=e,l=a.get("editType")==="fullRow",d=hR(r)("ariaValidationErrorPrefix","Cell Editor Validation");for(let h of i){let{ctrl:p,editor:g}=h,{rowNode:f,column:m}=p,v=g.getValidationErrors?.()??[],C=g.getValidationElement?.(!1)||!g.isPopup?.()&&p.eGui;if(C){let w=v!=null&&v.length>0,y=w?v.join(". "):"";P7(C,w),w&&o.announceValue(`${d} ${v}`,"editorValidation"),C instanceof HTMLInputElement?C.setCustomValidity(y):C.classList.toggle("invalid",w)}v?.length>0&&n.setCellValidation({rowNode:f,column:m},{errorMessages:v})}Qs(e,{persist:!1}),s?.setCellValidationModel(n);let u=new Set;for(let{ctrl:h}of i)u.add(h.rowCtrl);if(l){let h=TW(e);s?.setRowValidationModel(h)}for(let h of u.values()){h.rowEditStyleFeature?.applyRowStyles();for(let p of h.getAllCellCtrls())p.tooltipFeature?.refreshTooltip(!0),p.editorTooltipFeature?.refreshTooltip(!0),p.editStyleFeature?.applyCellStyles?.()}}var TW=e=>{let t=new fD,i=e.gos.get("getFullRowEditValidationErrors"),n=e.editModelSvc?.getEditMap();if(!n)return t;for(let o of n.keys()){let r=n.get(o);if(!r)continue;let s=[],{rowIndex:a,rowPinned:l}=o;for(let d of r.keys()){let u=r.get(d);if(!u)continue;let{editorValue:h,pendingValue:p,sourceValue:g}=u,f=h??(p===bn?void 0:p)??g;s.push({column:d,colId:d.getColId(),rowIndex:a,rowPinned:l,oldValue:g,newValue:f})}let c=i?.({editorsState:s})??[];c.length>0&&t.setRowValidation({rowNode:o},{errorMessages:c})}return t};function FW(e){ca(e,!0);let t=e.editModelSvc?.getCellValidationModel().getCellValidationMap();if(!t)return null;let i=[];return t.forEach((n,o)=>{n.forEach(({errorMessages:r},s)=>{i.push({column:s,rowIndex:o.rowIndex,rowPinned:o.rowPinned,messages:r??null})})}),i}function IW(e,t,i,{rowNode:n,column:o},r){return ye(e.gos,{type:i,node:n,data:n.data,value:r,column:o,colDef:o.getColDef(),rowPinned:n.rowPinned,event:t,rowIndex:n.rowIndex})}function AW(e,t=!1){return e===T.DELETE?!0:!t&&e===T.BACKSPACE?ZR():!1}var LW=class extends A{constructor(e,t,i,n){super(),this.cellCtrl=e,this.rowNode=i,this.rowCtrl=n,this.beans=t}init(){this.eGui=this.cellCtrl.eGui}onKeyDown(e){let t=e.key;switch(t){case T.ENTER:this.onEnterKeyDown(e);break;case T.F2:this.onF2KeyDown(e);break;case T.ESCAPE:this.onEscapeKeyDown(e);break;case T.TAB:this.onTabKeyDown(e);break;case T.BACKSPACE:case T.DELETE:this.onBackspaceOrDeleteKeyDown(t,e);break;case T.DOWN:case T.UP:case T.RIGHT:case T.LEFT:this.onNavigationKeyDown(e,t);break}}onNavigationKeyDown(e,t){let{cellCtrl:i,beans:n}=this;if(!n.editSvc?.isEditing(i,{withOpenEditor:!0})){if(e.shiftKey&&i.isRangeSelectionEnabled())this.onShiftRangeSelect(e);else{let o=i.getFocusedCellPosition();n.navigation?.navigateToNextCell(e,t,o,!0)}e.preventDefault()}}onShiftRangeSelect(e){let{rangeSvc:t,navigation:i}=this.beans;if(!t)return;let n=t.extendLatestRangeInDirection(e);n&&(e.key===T.LEFT||e.key===T.RIGHT?i?.ensureColumnVisible(n.column):i?.ensureRowVisible(n.rowIndex))}onTabKeyDown(e){this.beans.navigation?.onTabKeyDown(this.cellCtrl,e)}onBackspaceOrDeleteKeyDown(e,t){let{cellCtrl:i,beans:n,rowNode:o}=this,{gos:r,rangeSvc:s,eventSvc:a,editSvc:l}=n;if(a.dispatchEvent({type:"keyShortcutChangedCellStart"}),AW(e,r.get("enableCellEditingOnBackspace"))&&!l?.isEditing(i,{withOpenEditor:!0})){if(s&&ar(r))s.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"});else if(i.isCellEditable()){let{column:c}=i,d=this.beans.valueSvc.getDeleteValue(c,o);o.setDataValue(c,d,"cellClear")}}else l?.isEditing(i,{withOpenEditor:!0})||n.editSvc?.startEditing(i,{startedEdit:!0,event:t});a.dispatchEvent({type:"keyShortcutChangedCellEnd"})}onEnterKeyDown(e){let{cellCtrl:t,beans:i}=this,{editSvc:n,navigation:o}=i,r=n?.isEditing(t,{withOpenEditor:!0}),s=t.rowNode,a=n?.isRowEditing(s,{withOpenEditor:!0}),l=c=>{n?.startEditing(c,{startedEdit:!0,event:e,source:"edit"})&&e.preventDefault()};if(r||a){if(this.isCtrlEnter(e)){n?.applyBulkEdit(t,i?.rangeSvc?.getCellRanges()||[]);return}if(ca(i),n?.checkNavWithValidation(void 0,e)==="block-stop")return;n?.isEditing(t,{withOpenEditor:!0})?n?.stopEditing(t,{event:e,source:"edit"}):a&&!t.isCellEditable()?n?.stopEditing({rowNode:s},{event:e,source:"edit"}):l(t)}else if(i.gos.get("enterNavigatesVertically")){let c=e.shiftKey?T.UP:T.DOWN;o?.navigateToNextCell(null,c,t.cellPosition,!1)}else{if(n?.hasValidationErrors())return;n?.hasValidationErrors(t)&&n.revertSingleCellEdit(t,!0),l(t)}}isCtrlEnter(e){return(e.ctrlKey||e.metaKey)&&e.key===T.ENTER}onF2KeyDown(e){let{cellCtrl:t,beans:{editSvc:i}}=this;i?.isEditing()&&(ca(this.beans),i?.checkNavWithValidation(void 0,e)==="block-stop")||i?.startEditing(t,{startedEdit:!0,event:e})}onEscapeKeyDown(e){let{cellCtrl:t,beans:{editSvc:i}}=this;i?.checkNavWithValidation(t,e)==="block-stop"&&i.revertSingleCellEdit(t),i?.stopEditing(t,{event:e,cancel:!0})}processCharacter(e){let i=e.target!==this.eGui,{beans:{editSvc:n},cellCtrl:o}=this;if(i||n?.isEditing(o,{withOpenEditor:!0}))return;if(e.key===T.SPACE)this.onSpaceKeyDown(e);else if(n?.isCellEditable(o,"ui")){if(n?.hasValidationErrors()&&!n?.hasValidationErrors(o))return;n?.startEditing(o,{startedEdit:!0,event:e,source:"api"}),!o.editCompDetails?.params?.suppressPreventDefault&&e.preventDefault()}}onSpaceKeyDown(e){let{gos:t,editSvc:i}=this.beans,{rowNode:n}=this.cellCtrl;!i?.isEditing(this.cellCtrl,{withOpenEditor:!0})&&ea(t)&&this.beans.selectionSvc?.handleSelectionEvent(e,n,"spaceKey"),e.preventDefault()}},OW=class extends A{constructor(e,t,i){super(),this.cellCtrl=e,this.column=i,this.beans=t}onMouseEvent(e,t){if(!sr(t))switch(e){case"click":this.onCellClicked(t);break;case"mousedown":case"touchstart":this.onMouseDown(t);break;case"dblclick":this.onCellDoubleClicked(t);break;case"mouseout":this.onMouseOut(t);break;case"mouseover":this.onMouseOver(t);break}}onCellClicked(e){if(this.beans.touchSvc?.handleCellDoubleClick(this,e))return;let{eventSvc:t,rangeSvc:i,editSvc:n,editModelSvc:o,frameworkOverrides:r,gos:s}=this.beans,a=e.ctrlKey||e.metaKey,{cellCtrl:l}=this,{column:c,cellPosition:d,rowNode:u}=l,h=yp(s,c,u,e);i&&a&&!h&&i.getCellRangeCount(d)>1&&i.intersectLastRange(!0);let p=l.createEvent(e,"cellClicked");p.isEventHandlingSuppressed=h,t.dispatchEvent(p);let g=c.getColDef();if(g.onCellClicked&&window.setTimeout(()=>{r.wrapOutgoing(()=>{g.onCellClicked(p)})},0),!h&&o?.getState(l)!=="editing"){let f=n?.isEditing(),m=o?.getCellValidationModel().getCellValidationMap().size??0,v=o?.getRowValidationModel().getRowValidationMap().size??0;if(f&&(m>0||v>0))return;n?.shouldStartEditing(l,e)?n?.startEditing(l,{event:e}):n?.shouldStopEditing(l,e)&&(this.beans.gos.get("editType")==="fullRow"?n?.stopEditing(l,{event:e,source:"edit"}):n?.stopEditing(void 0,{event:e,source:"edit"}))}}onCellDoubleClicked(e){let{column:t,beans:i,cellCtrl:n}=this,{eventSvc:o,frameworkOverrides:r,editSvc:s,editModelSvc:a,gos:l}=i,c=yp(l,n.column,n.rowNode,e),d=t.getColDef(),u=n.createEvent(e,"cellDoubleClicked");if(u.isEventHandlingSuppressed=c,o.dispatchEvent(u),typeof d.onCellDoubleClicked=="function"&&window.setTimeout(()=>{r.wrapOutgoing(()=>{d.onCellDoubleClicked(u)})},0),!c&&s?.shouldStartEditing(n,e)&&a?.getState(n)!=="editing"){let h=s?.isEditing(),p=a?.getCellValidationModel().getCellValidationMap().size??0,g=a?.getRowValidationModel().getRowValidationMap().size??0;if(h&&(p>0||g>0))return;s?.startEditing(n,{event:e})}}onMouseDown(e){let{ctrlKey:t,metaKey:i,shiftKey:n}=e,o=e.target,{cellCtrl:r,beans:s}=this,{eventSvc:a,rangeSvc:l,rowNumbersSvc:c,focusSvc:d,gos:u,editSvc:h}=s,{column:p,rowNode:g,cellPosition:f}=r,m=yp(u,p,g,e),v=()=>{let _=r.createEvent(e,"cellMouseDown");_.isEventHandlingSuppressed=m,a.dispatchEvent(_)};if(m){v();return}if(this.isRightClickInExistingRange(e))return;let C=l&&!l.isEmpty(),w=this.containsWidget(o),y=or(p);if(c&&y&&!c.handleMouseDownOnCell(f,e)){l&&e.preventDefault(),e.stopImmediatePropagation();return}if(!n||!C){let _=h?.isEditing(r),P=u.get("enableCellTextSelection")&&e.defaultPrevented,B=(rs()||P)&&!_&&!nd(o)&&!w;r.focusCell(B,e)}if(n&&C&&!d.isCellFocused(f)){e.preventDefault();let _=d.getFocusedCell();if(_){let{column:R,rowIndex:P,rowPinned:B}=_;h?.isEditing(_)&&h?.stopEditing(_),d.setFocusedCell({column:R,rowIndex:P,rowPinned:B,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,sourceEvent:e})}}if(!w){if(l){y&&e.preventDefault();let _=LE(s,e)&&y;if(n)l.extendLatestRangeToCell(f);else if(!_){let R=t||i;l.setRangeToCell(f,R)}}v()}}isRightClickInExistingRange(e){let{rangeSvc:t}=this.beans;if(t){let i=t.isCellInAnyRange(this.cellCtrl.cellPosition),n=LE(this.beans,e);if(i&&n)return!0}return!1}containsWidget(e){return Zs(e,"ag-selection-checkbox",3)||Zs(e,"ag-drag-handle",3)}onMouseOut(e){if(this.mouseStayingInsideCell(e))return;let{eventSvc:t,colHover:i}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOut")),i?.clearMouseOver()}onMouseOver(e){if(this.mouseStayingInsideCell(e))return;let{eventSvc:t,colHover:i}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOver")),i?.setMouseOver([this.column])}mouseStayingInsideCell(e){if(!e.target||!e.relatedTarget)return!1;let t=this.cellCtrl.eGui,i=t.contains(e.target),n=t.contains(e.relatedTarget);return i&&n}},NW=class extends A{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.column=e.column,this.rowNode=e.rowNode}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode),this.addManagedListeners(this.beans.eventSvc,{newColumnsLoaded:()=>this.onNewColumnsLoaded()})}init(){this.eSetLeft=this.cellCtrl.getRootElement(),this.eContent=this.cellCtrl.eGui;let e=this.cellCtrl.getCellSpan();if(e||(this.setupColSpan(),this.setupRowSpan()),this.onLeftChanged(),this.onWidthChanged(),e||this._legacyApplyRowSpan(),e){let t=this.refreshSpanHeight.bind(this,e);t(),this.addManagedListeners(this.beans.eventSvc,{paginationChanged:t,recalculateRowBounds:t,pinnedHeightChanged:t})}}refreshSpanHeight(e){let t=e.getCellHeight();t!=null&&(this.eContent.style.height=`${t}px`)}onNewColumnsLoaded(){let e=this.column.getRowSpan(this.rowNode);this.rowSpan!==e&&(this.rowSpan=e,this._legacyApplyRowSpan(!0))}onDisplayColumnsChanged(){let e=this.getColSpanningList();ns(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){this.column.getColDef().colSpan!=null&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onWidthChanged.bind(this)}))}onWidthChanged(){if(!this.eContent)return;let e=this.getCellWidth();this.eContent.style.width=`${e}px`}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce((e,t)=>e+t.getActualWidth(),0):this.column.getActualWidth()}getColSpanningList(){let{column:e,rowNode:t}=this,i=e.getColSpan(t),n=[];if(i===1)n.push(e);else{let o=e,r=e.getPinned();for(let s=0;o&&s<i&&(n.push(o),o=this.beans.visibleCols.getColAfter(o),!(!o||mt(o)||r!==o.getPinned()));s++);}return n}onLeftChanged(){if(!this.eSetLeft)return;let e=this.modifyLeftForPrintLayout(this.getCellLeft());this.eSetLeft.style.left=e+"px"}getCellLeft(){let e;return this.beans.gos.get("enableRtl")&&this.colsSpanning?e=rt(this.colsSpanning):e=this.column,e.getLeft()}modifyLeftForPrintLayout(e){if(!this.cellCtrl.printLayout||this.column.getPinned()==="left")return e;let{visibleCols:t}=this.beans,i=t.getColsLeftWidth();if(this.column.getPinned()==="right"){let n=t.bodyWidth;return i+n+(e||0)}return i+(e||0)}_legacyApplyRowSpan(e){if(this.rowSpan===1&&!e)return;let i=ta(this.beans)*this.rowSpan;this.eContent.style.height=`${i}px`,this.eContent.style.zIndex="1"}destroy(){super.destroy()}},BW="ag-cell",HW="ag-cell-auto-height",VW="ag-cell-normal-height",GW="ag-cell-focus",zW="ag-cell-first-right-pinned",WW="ag-cell-last-left-pinned",UW="ag-cell-not-inline-editing",qW="ag-cell-wrap-text",$W=0,yl=class extends A{constructor(e,t,i,n){super(),this.column=e,this.rowNode=t,this.rowCtrl=n,this.rangeFeature=void 0,this.rowResizeFeature=void 0,this.positionFeature=void 0,this.customStyleFeature=void 0,this.editStyleFeature=void 0,this.mouseListener=void 0,this.keyboardListener=void 0,this.suppressRefreshCell=!1,this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.focusEventWhileNotReady=null,this.hasBeenFocused=!1,this.hasEdit=!1,this.tooltipFeature=void 0,this.editorTooltipFeature=void 0,this.beans=i,this.gos=i.gos,this.editSvc=i.editSvc,this.hasEdit=!!i.editSvc;let{colId:o}=e;this.instanceId=o+"-"+$W++,this.createCellPosition(),this.updateAndFormatValue(!1)}addFeatures(){let{beans:e}=this;this.positionFeature=new NW(this,e),this.customStyleFeature=e.cellStyles?.createCellCustomStyleFeature(this,e),this.editStyleFeature=e.editSvc?.createCellStyleFeature(this,e),this.mouseListener=new OW(this,e,this.column),this.keyboardListener=new LW(this,e,this.rowNode,this.rowCtrl),this.enableTooltipFeature();let{rangeSvc:t}=e;t&&ar(e.gos)&&(this.rangeFeature=t.createCellRangeFeature(e,this)),or(this.column)&&(this.rowResizeFeature=this.beans.rowNumbersSvc.createRowNumbersRowResizerFeature(e,this))}isCellSpanning(){return!1}getCellSpan(){}removeFeatures(){let e=this.beans.context;this.positionFeature=e.destroyBean(this.positionFeature),this.editorTooltipFeature=e.destroyBean(this.editorTooltipFeature),this.customStyleFeature=e.destroyBean(this.customStyleFeature),this.editStyleFeature=e.destroyBean(this.editStyleFeature),this.mouseListener=e.destroyBean(this.mouseListener),this.keyboardListener=e.destroyBean(this.keyboardListener),this.rangeFeature=e.destroyBean(this.rangeFeature),this.rowResizeFeature=e.destroyBean(this.rowResizeFeature),this.disableTooltipFeature()}enableTooltipFeature(e,t){this.tooltipFeature=this.beans.tooltipSvc?.enableCellTooltipFeature(this,e,t)}disableTooltipFeature(){this.tooltipFeature=this.beans.context.destroyBean(this.tooltipFeature)}enableEditorTooltipFeature(e){this.editorTooltipFeature&&this.disableEditorTooltipFeature(),this.editorTooltipFeature=this.beans.tooltipSvc?.setupCellEditorTooltip(this,e),ca(this.beans)}disableEditorTooltipFeature(){this.editorTooltipFeature=this.beans.context.destroyBean(this.editorTooltipFeature)}setComp(e,t,i,n,o,r,s){if(this.comp=e,this.eGui=t,this.printLayout=o,s??(s=this),this.addDomData(s),this.addFeatures(),s.addDestroyFunc(()=>this.removeFeatures()),this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.setupFocus(),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),this.setupAutoHeight(n,s),this.refreshFirstAndLastStyles(),this.refreshAriaColIndex(),this.positionFeature?.init(),this.customStyleFeature?.setComp(e),this.editStyleFeature?.setComp(e),this.tooltipFeature?.refreshTooltip(),this.keyboardListener?.init(),this.rangeFeature?.setComp(e),this.rowResizeFeature?.refreshRowResizer(),r&&this.isCellEditable()||this.hasEdit&&this.editSvc?.isEditing(this,{withOpenEditor:!0})?this.editSvc?.startEditing(this,{startedEdit:!1,source:"api",silent:!0,continueEditing:!0}):this.showValue(!1,!0),this.onCompAttachedFuncs.length){for(let a of this.onCompAttachedFuncs)a();this.onCompAttachedFuncs=[]}}setupAutoHeight(e,t){this.isAutoHeight=this.beans.rowAutoHeight?.setupCellAutoHeight(this,e,t)??!1}getCellAriaRole(){return this.column.getColDef().cellAriaRole??"gridcell"}isCellRenderer(){let e=this.column.getColDef();return e.cellRenderer!=null||e.cellRendererSelector!=null}getValueToDisplay(){return this.valueFormatted??this.value}getDeferLoadingCellRenderer(){let{beans:e,column:t}=this,{userCompFactory:i,ctrlsSvc:n,eventSvc:o}=e,r=t.getColDef(),s=this.createCellRendererParams();s.deferRender=!0;let a=GE(i,r,s);if(n.getGridBodyCtrl()?.scrollFeature?.isScrolling()){let l,c=new yt(u=>{l=u}),[d]=this.addManagedListeners(o,{bodyScrollEnd:()=>{l(),d()}});return{loadingComp:a,onReady:c}}return{loadingComp:a,onReady:yt.resolve()}}showValue(e,t){let{beans:i,column:n,rowNode:o,rangeFeature:r}=this,{userCompFactory:s}=i,a=this.getValueToDisplay(),l,c=o.stub&&o.groupData?.[n.getId()]==null,d=n.getColDef();if(c||this.isCellRenderer()){let u=this.createCellRendererParams();!c||or(n)?l=VE(s,d,u):l=GE(s,d,u)}if(!l&&!c&&i.findSvc?.isMatch(o,n)){let u=this.createCellRendererParams();l=VE(s,z(b({},n.getColDef()),{cellRenderer:"agFindCellRenderer"}),u)}if(this.hasEdit&&this.editSvc.isBatchEditing()&&this.editSvc.isRowEditing(o,{checkSiblings:!0})){let u=this.editSvc.prepDetailsDuringBatch(this,{compDetails:l,valueToDisplay:a});u&&(u.compDetails?l=u.compDetails:u.valueToDisplay&&(a=u.valueToDisplay))}this.comp.setRenderDetails(l,a,e),this.customRowDragComp?.refreshVisibility(),!t&&r&&cr(i,()=>r?.refreshHandle()),this.rowResizeFeature?.refreshRowResizer()}setupControlComps(){let e=this.column.getColDef();this.includeSelection=this.isIncludeControl(this.isCheckboxSelection(e),!0),this.includeRowDrag=this.isIncludeControl(e.rowDrag),this.includeDndSource=this.isIncludeControl(e.dndSource),this.comp.setIncludeSelection(this.includeSelection),this.comp.setIncludeDndSource(this.includeDndSource),this.comp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gos.get("enableCellTextSelection")||this.column.isAutoHeight()}getCellValueClass(){let e="ag-cell-value",t=this.column.getColDef().cellRenderer==="agCheckboxCellRenderer",i="";return t&&(i=" ag-allow-overflow"),`${e}${i}`}isIncludeControl(e,t=!1){return(this.rowNode.rowPinned==null||t&&Td(this.rowNode))&&!!e}isCheckboxSelection(e){let{rowSelection:t,groupDisplayType:i}=this.beans.gridOptions,n=Ap(t),o=dr(this.column);return i==="custom"&&n!=="selectionColumn"&&o?!1:e.checkboxSelection||o&&typeof t=="object"&&fl(t)}refreshShouldDestroy(){let e=this.column.getColDef(),t=this.includeSelection!=this.isIncludeControl(this.isCheckboxSelection(e),!0),i=this.includeRowDrag!=this.isIncludeControl(e.rowDrag),n=this.includeDndSource!=this.isIncludeControl(e.dndSource),o=this.isAutoHeight!=this.column.isAutoHeight();return t||i||n||o}onPopupEditorClosed(){let{editSvc:e}=this.beans;e?.isEditing(this,{withOpenEditor:!0})&&e?.stopEditing(this,{source:e?.isBatchEditing()?"ui":"api"})}stopEditing(e=!1){let{editSvc:t}=this.beans;return t?.stopEditing(this,{cancel:e,source:t?.isBatchEditing()?"ui":"api"})??!1}createCellRendererParams(){let{value:e,valueFormatted:t,column:i,rowNode:n,comp:o,eGui:r,beans:{valueSvc:s,gos:a,editSvc:l}}=this;return ye(a,{value:e,valueFormatted:t,getValue:()=>s.getValueForDisplay(i,n).value,setValue:d=>l?.setDataValue({rowNode:n,column:i},d)||n.setDataValue(i,d),formatValue:this.formatValue.bind(this),data:n.data,node:n,pinned:i.getPinned(),colDef:i.getColDef(),column:i,refreshCell:this.refreshCell.bind(this),eGridCell:r,eParentOfValue:o.getParentOfValue(),registerRowDragger:(d,u,h,p)=>this.registerRowDragger(d,u,p),setTooltip:(d,u)=>{a.assertModuleRegistered("Tooltip",3),this.tooltipFeature&&this.disableTooltipFeature(),this.enableTooltipFeature(d,u),this.tooltipFeature?.refreshTooltip()}})}onCellChanged(e){e.column===this.column&&this.refreshCell({})}refreshOrDestroyCell(e){if(this.refreshShouldDestroy()?this.rowCtrl?.recreateCell(this):this.refreshCell(e),this.hasEdit&&this.editCompDetails){let{editSvc:t,comp:i}=this;!i?.getCellEditor()&&t.isEditing(this,{withOpenEditor:!0})&&t.startEditing(this,{startedEdit:!1,source:"api",silent:!0})}}refreshCell({force:e,suppressFlash:t,newData:i}={}){let{editStyleFeature:n,customStyleFeature:o,rowCtrl:{rowEditStyleFeature:r},beans:{cellFlashSvc:s,filterManager:a},column:l,comp:c,suppressRefreshCell:d,tooltipFeature:u}=this;if(d)return;let{field:h,valueGetter:p,showRowGroup:g,enableCellChangeFlash:f}=l.getColDef(),m=h==null&&p==null&&g==null,v=e||m||i,C=!!c,w=this.updateAndFormatValue(C),y=v||w;if(C){if(y){this.showValue(!!i,!1);let _=a?.isSuppressFlashingCellsBecauseFiltering();!t&&!_&&f&&s?.flashCell(this),n?.applyCellStyles?.(),o?.applyUserStyles(),o?.applyClassesFromColDef(),r?.applyRowStyles()}u?.refreshTooltip(),o?.applyCellClassRules()}}isCellEditable(){return this.column.isCellEditable(this.rowNode)}formatValue(e){return this.callValueFormatter(e)??e}callValueFormatter(e){return this.beans.valueSvc.formatValue(this.column,this.rowNode,e)}updateAndFormatValue(e){let t=this.value,i=this.valueFormatted,{value:n,valueFormatted:o}=this.beans.valueSvc.getValueForDisplay(this.column,this.rowNode,!0);return this.value=n,this.valueFormatted=o,e?!this.valuesAreEqual(t,this.value)||this.valueFormatted!=i:!0}valuesAreEqual(e,t){let i=this.column.getColDef();return i.equals?i.equals(e,t):e===t}addDomData(e){let t=this.eGui;sa(this.beans.gos,t,Wp,this),e.addDestroyFunc(()=>sa(this.beans.gos,t,Wp,null))}createEvent(e,t){let{rowNode:i,column:n,value:o,beans:r}=this;return IW(r,e,t,{rowNode:i,column:n},o)}processCharacter(e){this.keyboardListener?.processCharacter(e)}onKeyDown(e){this.keyboardListener?.onKeyDown(e)}onMouseEvent(e,t){this.mouseListener?.onMouseEvent(e,t)}getColSpanningList(){return this.positionFeature?.getColSpanningList()??[]}onLeftChanged(){this.comp&&this.positionFeature?.onLeftChanged()}onDisplayedColumnsChanged(){this.eGui&&(this.refreshAriaColIndex(),this.refreshFirstAndLastStyles())}refreshFirstAndLastStyles(){let{comp:e,column:t,beans:i}=this;AP(e,t,i.visibleCols)}refreshAriaColIndex(){let e=this.beans.visibleCols.getAriaColIndex(this.column);eR(this.eGui,e)}onWidthChanged(){return this.positionFeature?.onWidthChanged()}getRowPosition(){let{rowIndex:e,rowPinned:t}=this.cellPosition;return{rowIndex:e,rowPinned:t}}updateRangeBordersIfRangeCount(){this.comp&&this.rangeFeature?.updateRangeBordersIfRangeCount()}onCellSelectionChanged(){this.comp&&this.rangeFeature?.onCellSelectionChanged()}isRangeSelectionEnabled(){return this.rangeFeature!=null}focusCell(e=!1,t){let i=this.editSvc?.allowedFocusTargetOnValidation(this);i&&i!==this||this.beans.focusSvc.setFocusedCell(z(b({},this.getFocusedCellPosition()),{forceBrowserFocus:e,sourceEvent:t}))}restoreFocus(e=!1){let{beans:{editSvc:t,focusSvc:i},comp:n}=this;if(!n||t?.isEditing(this)||!this.isCellFocused()||!i.shouldTakeFocus())return;let o=()=>{if(!this.isAlive())return;let r=n.getFocusableElement();this.isCellFocused()&&r.focus({preventScroll:!0})};if(e){setTimeout(o,0);return}o()}onRowIndexChanged(){this.createCellPosition(),this.onCellFocused(),this.restoreFocus(),this.rangeFeature?.onCellSelectionChanged(),this.rowResizeFeature?.refreshRowResizer()}onSuppressCellFocusChanged(e){let t=this.eGui;t&&(or(this.column)&&(e=!0),en(t,"tabindex",e?void 0:-1))}onFirstRightPinnedChanged(){if(!this.comp)return;let e=this.column.isFirstRightPinned();this.comp.toggleCss(zW,e)}onLastLeftPinnedChanged(){if(!this.comp)return;let e=this.column.isLastLeftPinned();this.comp.toggleCss(WW,e)}checkCellFocused(){return this.beans.focusSvc.isCellFocused(this.cellPosition)}isCellFocused(){let e=this.checkCellFocused();return this.hasBeenFocused||(this.hasBeenFocused=e),e}setupFocus(){this.restoreFocus(!0),this.onCellFocused(this.focusEventWhileNotReady??void 0)}onCellFocused(e){let{beans:t}=this;if(ig(t))return;if(!this.comp){e&&(this.focusEventWhileNotReady=e);return}let i=this.isCellFocused(),n=t.editSvc?.isEditing(this)??!1;if(this.comp.toggleCss(GW,i),i&&e?.forceBrowserFocus){let o=this.comp.getFocusableElement();if(n){let r=vl(o,null,!0);r.length&&(o=r[0])}o.focus({preventScroll:!!e.preventScrollOnBrowserFocus})}i&&e&&this.rowCtrl.announceDescription()}createCellPosition(){let{rowIndex:e,rowPinned:t}=this.rowNode;this.cellPosition={rowIndex:e,rowPinned:nr(t),column:this.column}}applyStaticCssClasses(){let{comp:e}=this;e.toggleCss(BW,!0),e.toggleCss(UW,!0);let t=this.column.isAutoHeight()==!0;e.toggleCss(HW,t),e.toggleCss(VW,!t)}onColumnHover(){this.beans.colHover?.onCellColumnHover(this.column,this.comp)}onColDefChanged(){this.comp&&(this.column.isTooltipEnabled()?(this.disableTooltipFeature(),this.enableTooltipFeature()):this.disableTooltipFeature(),this.setWrapText(),this.editSvc?.isEditing(this)?this.editSvc?.handleColDefChanged(this):this.refreshOrDestroyCell({force:!0,suppressFlash:!0}))}setWrapText(){let e=this.column.getColDef().wrapText==!0;this.comp.toggleCss(qW,e)}dispatchCellContextMenuEvent(e){let t=this.column.getColDef(),i=this.createEvent(e,"cellContextMenu"),{beans:n}=this;n.eventSvc.dispatchEvent(i),t.onCellContextMenu&&window.setTimeout(()=>{n.frameworkOverrides.wrapOutgoing(()=>{t.onCellContextMenu(i)})},0)}getCellRenderer(){return this.comp?.getCellRenderer()??null}destroy(){this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.isCellFocused()&&this.hasBrowserFocus()&&this.beans.focusSvc.attemptToRecoverFocus(),super.destroy()}hasBrowserFocus(){return this.eGui?.contains(Ct(this.beans))??!1}createSelectionCheckbox(){let e=this.beans.selectionSvc?.createCheckboxSelectionComponent();if(e)return this.beans.context.createBean(e),e.init({rowNode:this.rowNode,column:this.column}),e}createDndSource(){let e=this.beans.registry.createDynamicBean("dndSourceComp",!1,this.rowNode,this.column,this.eGui);return e&&this.beans.context.createBean(e),e}registerRowDragger(e,t,i){if(this.customRowDragComp){this.customRowDragComp.setDragElement(e,t);return}let n=this.createRowDragComp(e,t,i);n&&(this.customRowDragComp=n,this.addDestroyFunc(()=>{this.beans.context.destroyBean(n),this.customRowDragComp=null}),n.refreshVisibility())}createRowDragComp(e,t,i){let n=this.beans.rowDragSvc?.createRowDragCompForCell(this.rowNode,this.column,()=>this.value,e,t,i);if(n)return this.beans.context.createBean(n),n}cellEditorAttached(){for(let e of this.onEditorAttachedFuncs)e();this.onEditorAttachedFuncs=[]}setFocusedCellPosition(e){}getFocusedCellPosition(){return this.cellPosition}refreshAriaRowIndex(){}getRootElement(){return this.eGui}};function kw(e,t,i,n,o,r){if(i==null&&t==null)return;let s={},a={},l=(c,d)=>{for(let u of c.split(" "))u.trim()!=""&&d(u)};if(i){let c=Object.keys(i);for(let d=0;d<c.length;d++){let u=c[d],h=i[u],p;typeof h=="string"?p=e?e.evaluate(h,n):!0:typeof h=="function"&&(p=h(n)),l(u,g=>{p?s[g]=!0:a[g]=!0})}}if(t&&r)for(let c of Object.keys(t))l(c,d=>{s[d]||(a[d]=!0)});r&&Object.keys(a).forEach(r),Object.keys(s).forEach(o)}function F_(e){if(e.group)return e.level;let t=e.parent;return t?t.level+1:0}var jW=class extends A{constructor(){super(...arguments),this.beanName="rowStyleSvc"}processClassesFromGridOptions(e,t){let i=this.gos,n=s=>{if(typeof s=="string")e.push(s);else if(Array.isArray(s))for(let a of s)e.push(a)},o=i.get("rowClass");o&&n(o);let r=i.getCallback("getRowClass");if(r){let s={data:t.data,node:t,rowIndex:t.rowIndex},a=r(s);n(a)}}preProcessRowClassRules(e,t){this.processRowClassRules(t,i=>{e.push(i)},()=>{})}processRowClassRules(e,t,i){let{gos:n,expressionSvc:o}=this.beans,r=ye(n,{data:e.data,node:e,rowIndex:e.rowIndex});kw(o,void 0,n.get("rowClassRules"),r,t,i)}processStylesFromGridOptions(e){let t=this.gos,i=t.get("rowStyle"),n=t.getCallback("getRowStyle"),o;if(n){let r={data:e.data,node:e,rowIndex:e.rowIndex};o=n(r)}if(o||i)return Object.assign({},i,o)}},KW=0,jp=class extends A{constructor(e,t,i,n,o){super(),this.rowNode=e,this.useAnimationFrameForCreate=n,this.printLayout=o,this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.rowDragComps=[],this.lastMouseDownOnDragger=!1,this.emptyStyle={},this.updateColumnListsPending=!1,this.rowId=null,this.businessKey=null,this.beans=t,this.gos=t.gos,this.paginationPage=t.pagination?.getCurrentPage()??0,this.suppressRowTransform=this.gos.get("suppressRowTransform"),this.instanceId=e.id+"-"+KW++,this.rowId=id(e.id),this.initRowBusinessKey(),this.rowFocused=t.focusSvc.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=F_(this.rowNode),this.setRowType(),this.setAnimateFlags(i),this.rowStyles=this.processStylesFromGridOptions(),this.rowEditStyleFeature=t.editSvc?.createRowStyleFeature(this,t),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gos.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if(typeof this.businessKeyForNodeFunc!="function")return;let e=this.businessKeyForNodeFunc(this.rowNode);this.businessKey=id(e)}updateGui(e,t){e==="left"?this.leftGui=t:e==="right"?this.rightGui=t:e==="fullWidth"?this.fullWidthGui=t:this.centerGui=t}setComp(e,t,i,n){let{context:o,focusSvc:r}=this.beans;n=Pd(this,o,n);let s={rowComp:e,element:t,containerType:i,compBean:n};this.allRowGuis.push(s),this.updateGui(i,s),this.initialiseRowComp(s);let a=this.rowNode,l=this.rowType==="FullWidthLoading"||a.stub,c=!a.data&&this.beans.rowModel.getType()==="infinite";!l&&!c&&!a.rowPinned&&this.beans.rowRenderer.dispatchFirstDataRenderedEvent();let d=this.fullWidthGui?.element;d&&!this.beans.editSvc?.isEditing(this)&&r.isRowFocused(a.rowIndex,a.rowPinned)&&r.shouldTakeFocus()&&setTimeout(()=>d.focus({preventScroll:!0}),0)}unsetComp(e){this.allRowGuis=this.allRowGuis.filter(t=>t.containerType!==e),this.updateGui(e,void 0)}isCacheable(){return this.rowType==="FullWidthDetail"&&this.gos.get("keepDetailRows")}setCached(e){let t=e?"none":"";for(let i of this.allRowGuis)i.element.style.display=t}initialiseRowComp(e){let t=this.gos;this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.listenOnDomOrder(e),this.onRowHeightChanged(e),this.updateRowIndexes(e),this.setFocusedClasses(e),this.setStylesFromGridOptions(!1,e),ea(t)&&this.rowNode.selectable&&this.onRowSelected(e),this.updateColumnLists(!this.useAnimationFrameForCreate);let i=e.rowComp,n=this.getInitialRowClasses(e.containerType);for(let o of n)i.toggleCss(o,!0);this.executeSlideAndFadeAnimations(e),this.rowNode.group&&uC(e.element,this.rowNode.expanded==!0),this.setRowCompRowId(i),this.setRowCompRowBusinessKey(i),sa(t,e.element,Up,this),e.compBean.addDestroyFunc(()=>sa(t,e.element,Up,null)),this.useAnimationFrameForCreate?this.beans.animationFrameSvc.createTask(this.addHoverFunctionality.bind(this,e),this.rowNode.rowIndex,"p2",!1):this.addHoverFunctionality(e),this.isFullWidth()&&this.setupFullWidth(e),t.get("rowDragEntireRow")&&this.addRowDraggerToRow(e),this.useAnimationFrameForCreate&&this.beans.animationFrameSvc.addDestroyTask(()=>{this.isAlive()&&e.rowComp.toggleCss("ag-after-created",!0)}),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(e){this.businessKey!=null&&e.setRowBusinessKey(this.businessKey)}setRowCompRowId(e){let t=id(this.rowNode.id);this.rowId=t,t!=null&&e.setRowId(t)}executeSlideAndFadeAnimations(e){let{containerType:t}=e;this.slideInAnimation[t]&&(hC(()=>{this.onTopChanged()}),this.slideInAnimation[t]=!1),this.fadeInAnimation[t]&&(hC(()=>{e.rowComp.toggleCss("ag-opacity-zero",!1)}),this.fadeInAnimation[t]=!1)}addRowDraggerToRow(e){let t=this.beans.rowDragSvc?.createRowDragCompForRow(this.rowNode,e.element);if(!t)return;let i=this.createBean(t,this.beans.context);this.rowDragComps.push(i),e.compBean.addDestroyFunc(()=>{this.rowDragComps=this.rowDragComps.filter(n=>n!==i),this.rowEditStyleFeature=this.destroyBean(this.rowEditStyleFeature,this.beans.context),this.destroyBean(i,this.beans.context)})}setupFullWidth(e){let t=this.getPinnedForContainer(e.containerType),i=this.createFullWidthCompDetails(e.element,t);e.rowComp.showFullWidth(i)}getFullWidthCellRenderers(){return this.gos.get("embedFullWidthRows")?this.allRowGuis.map(e=>e?.rowComp?.getFullWidthCellRenderer()):[this.fullWidthGui?.rowComp?.getFullWidthCellRenderer()]}executeProcessRowPostCreateFunc(){let e=this.gos.getCallback("processRowPostCreate");if(!e||!this.areAllContainersReady())return;let t={eRow:this.centerGui.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)};e(t)}areAllContainersReady(){let{leftGui:e,centerGui:t,rightGui:i,beans:{visibleCols:n}}=this,o=!!e||!n.isPinningLeft(),r=!!t,s=!!i||!n.isPinningRight();return o&&r&&s}isNodeFullWidthCell(){if(this.rowNode.detail)return!0;let e=this.beans.gos.getCallback("isFullWidthRow");return e?e({rowNode:this.rowNode}):!1}setRowType(){let e=this.rowNode.stub&&!this.gos.get("suppressServerSideFullWidthLoadingRow")&&!this.gos.get("groupHideOpenParents"),t=this.isNodeFullWidthCell(),i=this.gos.get("masterDetail")&&this.rowNode.detail,n=this.beans.colModel.isPivotMode(),o=MR(this.gos,this.rowNode,n);e?this.rowType="FullWidthLoading":i?this.rowType="FullWidthDetail":t?this.rowType="FullWidth":o?this.rowType="FullWidthGroup":this.rowType="Normal"}updateColumnLists(e=!1,t=!1){if(this.isFullWidth())return;let{animationFrameSvc:i}=this.beans;if(!i?.active||e||this.printLayout){this.updateColumnListsImpl(t);return}this.updateColumnListsPending||(i.createTask(()=>{this.active&&this.updateColumnListsImpl(!0)},this.rowNode.rowIndex,"p1",!1),this.updateColumnListsPending=!0)}getNewCellCtrl(e){if(!this.beans.rowSpanSvc?.isCellSpanning(e,this.rowNode))return new yl(e,this.rowNode,this.beans,this)}isCorrectCtrlForSpan(e){return!this.beans.rowSpanSvc?.isCellSpanning(e.column,this.rowNode)}createCellCtrls(e,t,i=null){let n={list:[],map:{}},o=(c,d,u)=>{u!=null?n.list.splice(u,0,d):n.list.push(d),n.map[c]=d},r=[];for(let c of t){let d=c.getInstanceId(),u=e.map[d];u&&!this.isCorrectCtrlForSpan(u)&&(u.destroy(),u=void 0),u||(u=this.getNewCellCtrl(c)),u&&o(d,u)}for(let c of e.list){let d=c.column.getInstanceId();if(n.map[d]!=null)continue;!this.isCellEligibleToBeRemoved(c,i)?r.push([d,c]):c.destroy()}if(r.length)for(let[c,d]of r){let u=n.list.findIndex(p=>p.column.getLeft()>d.column.getLeft()),h=u===-1?void 0:Math.max(u-1,0);o(c,d,h)}let{focusSvc:s,visibleCols:a}=this.beans,l=s.getFocusedCell();if(l&&l.column.getPinned()==i){let c=l.column.getInstanceId();if(!n.map[c]&&a.allCols.includes(l.column)){let u=this.createFocusedCellCtrl();if(u){let h=n.list.findIndex(g=>g.column.getLeft()>u.column.getLeft()),p=h===-1?void 0:Math.max(h-1,0);o(c,u,p)}}}return n}createFocusedCellCtrl(){let{focusSvc:e,rowSpanSvc:t}=this.beans,i=e.getFocusedCell();if(!i)return;let n=t?.getCellSpan(i.column,this.rowNode);if(n){if(n.firstNode!==this.rowNode||!n.doesSpanContain(i))return}else if(!e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned))return;return this.getNewCellCtrl(i.column)}updateColumnListsImpl(e){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(e)}setCellCtrls(e){for(let t of this.allRowGuis){let i=this.getCellCtrlsForContainer(t.containerType);t.rowComp.setCellCtrls(i,e)}}getCellCtrlsForContainer(e){switch(e){case"left":return this.leftCellCtrls.list;case"right":return this.rightCellCtrls.list;case"fullWidth":return[];case"center":return this.centerCellCtrls.list}}createAllCellCtrls(){let e=this.beans.colViewport,t=this.beans.visibleCols;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,t.allCols),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{let i=e.getColsWithinViewport(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,i);let n=t.getLeftColsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,n,"left");let o=t.getRightColsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,o,"right")}}isCellEligibleToBeRemoved(e,t){let{column:o}=e;if(o.getPinned()!=t||!this.isCorrectCtrlForSpan(e))return!0;let{visibleCols:r,editSvc:s}=this.beans,a=s?.isEditing(e),l=e.isCellFocused();return a||l?!(r.allCols.indexOf(o)>=0):!0}getDomOrder(){return this.gos.get("ensureDomOrder")||li(this.gos,"print")}listenOnDomOrder(e){let t=()=>{e.rowComp.setDomOrder(this.getDomOrder())};e.compBean.addManagedPropertyListeners(["domLayout","ensureDomOrder"],t)}setAnimateFlags(e){if(this.rowNode.sticky||!e)return;let t=ie(this.rowNode.oldRowTop),{visibleCols:i}=this.beans,n=i.isPinningLeft(),o=i.isPinningRight();if(t){let{slideInAnimation:r}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){r.fullWidth=!0;return}r.center=!0,r.left=n,r.right=o}else{let{fadeInAnimation:r}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){r.fullWidth=!0;return}r.center=!0,r.left=n,r.right=o}}isFullWidth(){return this.rowType!=="Normal"}refreshFullWidth(){let e=(s,a)=>s?s.rowComp.refreshFullWidth(()=>this.createFullWidthCompDetails(s.element,a).params):!0,t=e(this.fullWidthGui,null),i=e(this.centerGui,null),n=e(this.leftGui,"left"),o=e(this.rightGui,"right");return t&&i&&n&&o}addListeners(){let{beans:e,gos:t,rowNode:i}=this,{expansionSvc:n,eventSvc:o,context:r,rowSpanSvc:s}=e;this.addManagedListeners(this.rowNode,b({heightChanged:()=>this.onRowHeightChanged(),rowSelected:()=>this.onRowSelected(),rowIndexChanged:this.onRowIndexChanged.bind(this),topChanged:this.onTopChanged.bind(this)},n?.getRowExpandedListeners(this)??{})),i.detail&&this.addManagedListeners(i.parent,{dataChanged:this.onRowNodeDataChanged.bind(this)}),this.addManagedListeners(i,{dataChanged:this.onRowNodeDataChanged.bind(this),cellChanged:this.postProcessCss.bind(this),rowHighlightChanged:this.onRowNodeHighlightChanged.bind(this),draggingChanged:this.postProcessRowDragging.bind(this),uiLevelChanged:this.onUiLevelChanged.bind(this),rowPinned:this.onRowPinned.bind(this)}),this.addManagedListeners(o,{paginationPixelOffsetChanged:this.onPaginationPixelOffsetChanged.bind(this),heightScaleChanged:this.onTopChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),virtualColumnsChanged:this.onVirtualColumnsChanged.bind(this),cellFocused:this.onCellFocusChanged.bind(this),cellFocusCleared:this.onCellFocusChanged.bind(this),paginationChanged:this.onPaginationChanged.bind(this),modelUpdated:this.refreshFirstAndLastRowStyles.bind(this),columnMoved:()=>this.updateColumnLists()}),s&&this.addManagedListeners(s,{spannedCellsUpdated:({pinned:a})=>{a&&!i.rowPinned||this.updateColumnLists()}}),this.addDestroyFunc(()=>{this.rowDragComps=this.destroyBeans(this.rowDragComps,r),this.tooltipFeature=this.destroyBean(this.tooltipFeature,r),this.rowEditStyleFeature=this.destroyBean(this.rowEditStyleFeature,r)}),this.addManagedPropertyListeners(["rowStyle","getRowStyle","rowClass","getRowClass","rowClassRules"],this.postProcessCss.bind(this)),this.addManagedPropertyListener("rowDragEntireRow",()=>{if(t.get("rowDragEntireRow")){for(let l of this.allRowGuis)this.addRowDraggerToRow(l);return}this.rowDragComps=this.destroyBeans(this.rowDragComps,r)}),this.addListenersForCellComps()}addListenersForCellComps(){this.addManagedListeners(this.rowNode,{rowIndexChanged:()=>{for(let e of this.getAllCellCtrls())e.onRowIndexChanged()},cellChanged:e=>{for(let t of this.getAllCellCtrls())t.onCellChanged(e)}})}onRowPinned(){for(let e of this.allRowGuis)e.rowComp.toggleCss("ag-row-pinned-source",!!this.rowNode.pinnedSibling)}onRowNodeDataChanged(e){this.refreshRow({suppressFlash:!e.update,newData:!e.update})}refreshRow(e){if(this.isFullWidth()!==!!this.isNodeFullWidthCell()){this.beans.rowRenderer.redrawRow(this.rowNode);return}if(this.isFullWidth()){this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode);return}for(let i of this.getAllCellCtrls())i.refreshCell(e);for(let i of this.allRowGuis)this.setRowCompRowId(i.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(i.rowComp);this.onRowSelected(),this.postProcessCss()}postProcessCss(){this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.rowEditStyleFeature?.applyRowStyles(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){let e=this.beans.rowDropHighlightSvc,t=e?.row===this.rowNode?e.position:"none",i=t==="above",n=t==="inside",o=t==="below",s=this.gos.get("treeData")&&(o||i),a=this.rowNode.uiLevel.toString();for(let l of this.allRowGuis){let c=l.rowComp;c.toggleCss("ag-row-highlight-above",i),c.toggleCss("ag-row-highlight-inside",n),c.toggleCss("ag-row-highlight-below",o),c.toggleCss("ag-row-highlight-indent",s),s?l.element.style.setProperty("--ag-row-highlight-level",a):l.element.style.removeProperty("--ag-row-highlight-level")}}postProcessRowDragging(){let e=this.rowNode.dragging;for(let t of this.allRowGuis)t.rowComp.toggleCss("ag-row-dragging",e)}onDisplayedColumnsChanged(){this.updateColumnLists(!0),this.beans.rowAutoHeight?.requestCheckAutoHeight()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:nr(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}onKeyboardNavigate(e){let t=this.findFullWidthInfoForEvent(e);if(!t)return;let{rowGui:i,column:n}=t;if(!(i.element===e.target))return;let s=this.rowNode,{focusSvc:a,navigation:l}=this.beans,c=a.getFocusedCell(),d={rowIndex:s.rowIndex,rowPinned:s.rowPinned,column:c?.column??n};l?.navigateToNextCell(e,e.key,d,!0),e.preventDefault()}onTabKeyDown(e){if(e.defaultPrevented||sr(e))return;let t=this.allRowGuis.find(a=>a.element.contains(e.target)),i=t?t.element:null,n=i===e.target,o=Ct(this.beans),r=!1;i&&o&&(r=i.contains(o)&&o.classList.contains("ag-cell"));let s=null;!n&&!r&&(s=ha(this.beans,i,!1,e.shiftKey)),(this.isFullWidth()&&n||!s)&&this.beans.navigation?.onTabKeyDown(this,e)}getFullWidthElement(){return this.fullWidthGui?this.fullWidthGui.element:null}getRowYPosition(){let e=this.allRowGuis.find(t=>bo(t.element))?.element;return e?e.getBoundingClientRect().top:0}onSuppressCellFocusChanged(e){let t=this.isFullWidth()&&e?void 0:this.gos.get("tabIndex");for(let i of this.allRowGuis)en(i.element,"tabindex",t)}onFullWidthRowFocused(e){let t=this.rowNode,i=e?this.isFullWidth()&&e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned:!1,n;if(this.fullWidthGui)n=this.fullWidthGui.element;else{let r=this.beans.colModel.getCol(e?.column)?.pinned;r?n=r==="right"?this.rightGui?.element:this.leftGui?.element:n=this.centerGui?.element}n&&(n.classList.toggle("ag-full-width-focus",i),i&&e?.forceBrowserFocus&&n.focus({preventScroll:!0}))}recreateCell(e){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,e),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,e),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,e),e.destroy(),this.updateColumnLists()}removeCellCtrl(e,t){let i={list:[],map:{}};for(let n of e.list)n!==t&&(i.list.push(n),i.map[n.column.getInstanceId()]=n);return i}onMouseEvent(e,t){switch(e){case"dblclick":this.onRowDblClick(t);break;case"click":this.onRowClick(t);break;case"touchstart":case"mousedown":this.onRowMouseDown(t);break}}createRowEvent(e,t){let{rowNode:i}=this;return ye(this.gos,{type:e,node:i,data:i.data,rowIndex:i.rowIndex,rowPinned:i.rowPinned,event:t})}createRowEventWithSource(e,t){let i=this.createRowEvent(e,t);return i.source=this,i}onRowDblClick(e){if(sr(e))return;let t=this.createRowEventWithSource("rowDoubleClicked",e);t.isEventHandlingSuppressed=this.isSuppressMouseEvent(e),this.beans.eventSvc.dispatchEvent(t)}findFullWidthInfoForEvent(e){if(!e)return;let t=this.findFullWidthRowGui(e.target),i=this.getColumnForFullWidth(t);if(!(!t||!i))return{rowGui:t,column:i}}findFullWidthRowGui(e){return this.allRowGuis.find(t=>t.element.contains(e))}getColumnForFullWidth(e){let{visibleCols:t}=this.beans;switch(e?.containerType){case"center":return t.centerCols[0];case"left":return t.leftCols[0];case"right":return t.rightCols[0];default:return t.allCols[0]}}onRowMouseDown(e){if(this.lastMouseDownOnDragger=Zs(e.target,"ag-row-drag",3),!this.isFullWidth()||this.isSuppressMouseEvent(e))return;let{rangeSvc:t,focusSvc:i}=this.beans;t?.removeAllCellRanges();let n=this.findFullWidthInfoForEvent(e);if(!n)return;let{rowGui:o,column:r}=n,s=o.element,a=e.target,l=this.rowNode,c=e.defaultPrevented||rs();s&&s.contains(a)&&nd(a)&&(c=!1),i.setFocusedCell({rowIndex:l.rowIndex,column:r,rowPinned:l.rowPinned,forceBrowserFocus:c})}isSuppressMouseEvent(e){let{gos:t,rowNode:i}=this;if(this.isFullWidth()){let o=this.findFullWidthRowGui(e.target);return MN(t,o?.rowComp.getFullWidthCellRendererParams(),i,e)}let n=vw(t,e.target);return n!=null&&yp(t,n.column,i,e)}onRowClick(e){if(sr(e)||this.lastMouseDownOnDragger)return;let i=this.isSuppressMouseEvent(e),{eventSvc:n,selectionSvc:o}=this.beans,r=this.createRowEventWithSource("rowClicked",e);r.isEventHandlingSuppressed=i,n.dispatchEvent(r),!i&&o?.handleSelectionEvent(e,this.rowNode,"rowClicked")}setupDetailRowAutoHeight(e){this.rowType==="FullWidthDetail"&&this.beans.masterDetailSvc?.setupDetailRowAutoHeight(this,e)}createFullWidthCompDetails(e,t){let{gos:i,rowNode:n}=this,o=ye(i,{fullWidth:!0,data:n.data,node:n,value:n.key,valueFormatted:n.key,eGridCell:e,eParentOfValue:e,pinned:t,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(s,a,l,c)=>this.addFullWidthRowDragging(s,a,l,c),setTooltip:(s,a)=>{i.assertModuleRegistered("Tooltip",3),this.setupFullWidthRowTooltip(s,a)}}),r=this.beans.userCompFactory;switch(this.rowType){case"FullWidthDetail":return LO(r,o);case"FullWidthGroup":{let{value:s,valueFormatted:a}=this.beans.valueSvc.getValueForDisplay(void 0,this.rowNode,!0);return o.value=s,o.valueFormatted=a,AO(r,o)}case"FullWidthLoading":return IO(r,o);default:return FO(r,o)}}setupFullWidthRowTooltip(e,t){this.fullWidthGui&&(this.tooltipFeature=this.beans.tooltipSvc?.setupFullWidthRowTooltip(this.tooltipFeature,this,e,t))}addFullWidthRowDragging(e,t,i="",n){let{rowDragSvc:o,context:r}=this.beans;if(!o||!this.isFullWidth())return;let s=o.createRowDragComp(()=>i,this.rowNode,void 0,e,t,n);this.createBean(s,r),this.addDestroyFunc(()=>{this.destroyBean(s,r)})}onUiLevelChanged(){let e=F_(this.rowNode);if(this.rowLevel!=e){let t="ag-row-level-"+e,i="ag-row-level-"+this.rowLevel;for(let n of this.allRowGuis)n.rowComp.toggleCss(t,!0),n.rowComp.toggleCss(i,!1)}this.rowLevel=e}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getLastRow()}refreshFirstAndLastRowStyles(){let e=this.isFirstRowOnPage(),t=this.isLastRowOnPage();if(this.firstRowOnPage!==e){this.firstRowOnPage=e;for(let i of this.allRowGuis)i.rowComp.toggleCss("ag-row-first",e)}if(this.lastRowOnPage!==t){this.lastRowOnPage=t;for(let i of this.allRowGuis)i.rowComp.toggleCss("ag-row-last",t)}}getAllCellCtrls(){return this.leftCellCtrls.list.length===0&&this.rightCellCtrls.list.length===0?this.centerCellCtrls.list:[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){let e=[];if(this.beans.rowStyleSvc?.processClassesFromGridOptions(e,this.rowNode),!!e.length)for(let t of e)for(let i of this.allRowGuis)i.rowComp.toggleCss(t,!0)}postProcessRowClassRules(){this.beans.rowStyleSvc?.processRowClassRules(this.rowNode,e=>{for(let t of this.allRowGuis)t.rowComp.toggleCss(e,!0)},e=>{for(let t of this.allRowGuis)t.rowComp.toggleCss(e,!1)})}setStylesFromGridOptions(e,t){e&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(t,i=>i.rowComp.setUserStyles(this.rowStyles))}getPinnedForContainer(e){return e==="left"||e==="right"?e:null}getInitialRowClasses(e){let t=this.getPinnedForContainer(e),i=this.isFullWidth(),{rowNode:n,beans:o}=this,r=[];r.push("ag-row"),r.push(this.rowFocused?"ag-row-focus":"ag-row-no-focus"),this.fadeInAnimation[e]&&r.push("ag-opacity-zero"),r.push(n.rowIndex%2===0?"ag-row-even":"ag-row-odd"),n.isRowPinned()&&(r.push("ag-row-pinned"),o.pinnedRowModel?.isManual()&&r.push("ag-row-pinned-manual")),!n.isRowPinned()&&n.pinnedSibling&&r.push("ag-row-pinned-source"),n.isSelected()&&r.push("ag-row-selected"),n.footer&&r.push("ag-row-footer"),r.push("ag-row-level-"+this.rowLevel),n.stub&&r.push("ag-row-loading"),i&&r.push("ag-full-width-row"),o.expansionSvc?.addExpandedCss(r,n),n.dragging&&r.push("ag-row-dragging");let{rowStyleSvc:s}=o;return s&&(s.processClassesFromGridOptions(r,n),s.preProcessRowClassRules(r,n)),r.push(this.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),this.isFirstRowOnPage()&&r.push("ag-row-first"),this.isLastRowOnPage()&&r.push("ag-row-last"),i&&(t==="left"&&r.push("ag-cell-last-left-pinned"),t==="right"&&r.push("ag-cell-first-right-pinned")),r}processStylesFromGridOptions(){return this.beans.rowStyleSvc?.processStylesFromGridOptions(this.rowNode)??this.emptyStyle}onRowSelected(e){this.beans.selectionSvc?.onRowCtrlSelected(this,t=>{(t===this.centerGui||t===this.fullWidthGui)&&this.announceDescription()},e)}announceDescription(){this.beans.selectionSvc?.announceAriaRowSelection(this.rowNode)}addHoverFunctionality(e){if(!this.active)return;let{element:t,compBean:i}=e,{rowNode:n,beans:o,gos:r}=this;i.addManagedListeners(t,{pointerenter:s=>{s.pointerType==="mouse"&&n.dispatchRowEvent("mouseEnter")},pointerleave:s=>{s.pointerType==="mouse"&&n.dispatchRowEvent("mouseLeave")}}),i.addManagedListeners(n,{mouseEnter:()=>{!o.dragSvc?.dragging&&!r.get("suppressRowHoverHighlight")&&(t.classList.add("ag-row-hover"),n.setHovered(!0))},mouseLeave:()=>{this.resetHoveredStatus(t)}})}resetHoveredStatus(e){let t=e?[e]:this.allRowGuis.map(i=>i.element);for(let i of t)i.classList.remove("ag-row-hover");this.rowNode.setHovered(!1)}roundRowTopToBounds(e){let t=this.beans.ctrlsSvc.getScrollFeature().getApproximateVScollPosition(),i=this.applyPaginationOffset(t.top,!0)-100,n=this.applyPaginationOffset(t.bottom,!0)+100;return Math.min(Math.max(i,e),n)}forEachGui(e,t){if(e)t(e);else for(let i of this.allRowGuis)t(i)}isRowRendered(){return this.allRowGuis.length>0}onRowHeightChanged(e){if(this.rowNode.rowHeight==null)return;let t=this.rowNode.rowHeight,i=this.beans.environment.getDefaultRowHeight(),o=ER(this.gos)?Zr(this.beans,this.rowNode).height:void 0,r=o?`${Math.min(i,o)-2}px`:void 0;this.forEachGui(e,s=>{s.element.style.height=`${t}px`,r&&s.element.style.setProperty("--ag-line-height",r)})}destroyFirstPass(e=!1){this.active=!1;let{rowNode:t}=this;if(!e&&gl(this.gos)&&!t.sticky)if(t.rowTop!=null){let o=this.roundRowTopToBounds(t.rowTop);this.setRowTop(o)}else for(let o of this.allRowGuis)o.rowComp.toggleCss("ag-opacity-zero",!0);this.fullWidthGui?.element.contains(Ct(this.beans))&&this.beans.focusSvc.attemptToRecoverFocus(),t.setHovered(!1);let i=this.createRowEvent("virtualRowRemoved");this.dispatchLocalEvent(i),this.beans.eventSvc.dispatchEvent(i),super.destroy()}destroySecondPass(){this.allRowGuis.length=0;let e=t=>{for(let i of t.list)i.destroy();return{list:[],map:{}}};this.centerCellCtrls=e(this.centerCellCtrls),this.leftCellCtrls=e(this.leftCellCtrls),this.rightCellCtrls=e(this.rightCellCtrls)}setFocusedClasses(e){this.forEachGui(e,t=>{t.rowComp.toggleCss("ag-row-focus",this.rowFocused),t.rowComp.toggleCss("ag-row-no-focus",!this.rowFocused)})}onCellFocusChanged(){let{focusSvc:e}=this.beans,t=e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);t!==this.rowFocused&&(this.rowFocused=t,this.setFocusedClasses())}onPaginationChanged(){let e=this.beans.pagination?.getCurrentPage()??0;this.paginationPage!==e&&(this.paginationPage=e,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(e,t=!1){if(this.rowNode.isRowPinned()||this.rowNode.sticky)return e;let i=this.beans.pageBounds.getPixelOffset();return e+i*(t?1:-1)}setRowTop(e){if(!this.printLayout&&ie(e)){let t=this.applyPaginationOffset(e),o=`${this.rowNode.isRowPinned()||this.rowNode.sticky?t:this.beans.rowContainerHeight.getRealPixelPosition(t)}px`;this.setRowTopStyle(o)}}getInitialRowTop(e){return this.suppressRowTransform?this.getInitialRowTopShared(e):void 0}getInitialTransform(e){return this.suppressRowTransform?void 0:`translateY(${this.getInitialRowTopShared(e)})`}getInitialRowTopShared(e){if(this.printLayout)return"";let t=this.rowNode,i;if(t.sticky)i=t.stickyRowTop;else{let n=this.slideInAnimation[e]?this.roundRowTopToBounds(t.oldRowTop):t.rowTop,o=this.applyPaginationOffset(n);i=t.isRowPinned()?o:this.beans.rowContainerHeight.getRealPixelPosition(o)}return i+"px"}setRowTopStyle(e){for(let t of this.allRowGuis)this.suppressRowTransform?t.rowComp.setTop(e):t.rowComp.setTransform(`translateY(${e})`)}getCellCtrl(e,t=!1){let i=null;for(let n of this.getAllCellCtrls())n.column==e&&(i=n);if(i!=null||t)return i;for(let n of this.getAllCellCtrls())n?.getColSpanningList().indexOf(e)>=0&&(i=n);return i}onRowIndexChanged(){this.rowNode.rowIndex!=null&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}updateRowIndexes(e){let t=this.rowNode.getRowIndexString();if(t===null)return;let i=(this.beans.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0)+(this.beans.filterManager?.getHeaderRowCount()??0),n=this.rowNode.rowIndex%2===0,o=i+this.rowNode.rowIndex+1;this.forEachGui(e,r=>{r.rowComp.setRowIndex(t),r.rowComp.toggleCss("ag-row-even",n),r.rowComp.toggleCss("ag-row-odd",!n),Pp(r.element,o)})}},YW=class extends A{constructor(){super(),this.beanName="navigation",this.onPageDown=kE(this.onPageDown,100),this.onPageUp=kE(this.onPageUp,100)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}handlePageScrollingKey(e,t=!1){let i=e.key,n=e.altKey,o=e.ctrlKey||e.metaKey,r=!!this.beans.rangeSvc&&e.shiftKey,s=tB(this.gos,e),a=!1;switch(i){case T.PAGE_HOME:case T.PAGE_END:!o&&!n&&(this.onHomeOrEndKey(i),a=!0);break;case T.LEFT:case T.RIGHT:case T.UP:case T.DOWN:if(!s)return!1;o&&!n&&!r&&(this.onCtrlUpDownLeftRight(i,s),a=!0);break;case T.PAGE_DOWN:case T.PAGE_UP:!o&&!n&&(a=this.handlePageUpDown(i,s,t));break}return a&&e.preventDefault(),a}handlePageUpDown(e,t,i){return i&&(t=this.beans.focusSvc.getFocusedCell()),t?(e===T.PAGE_UP?this.onPageUp(t):this.onPageDown(t),!0):!1}navigateTo({scrollIndex:e,scrollType:t,scrollColumn:i,focusIndex:n,focusColumn:o,isAsync:r,rowPinned:s}){let{scrollFeature:a}=this.gridBodyCon;ie(i)&&!i.isPinned()&&a.ensureColumnVisible(i),ie(e)&&a.ensureIndexVisible(e,t),r||a.ensureIndexVisible(n);let{focusSvc:l,rangeSvc:c}=this.beans;l.setFocusedCell({rowIndex:n,column:o,rowPinned:s,forceBrowserFocus:!0}),c?.setRangeToCell({rowIndex:n,rowPinned:s,column:o})}onPageDown(e){let t=this.beans,i=oC(t),n=this.getViewportHeight(),{pageBounds:o,rowModel:r,rowAutoHeight:s}=t,a=o.getPixelOffset(),l=i.top+n,c=r.getRowIndexAtPixel(l+a);s?.active?this.navigateToNextPageWithAutoHeight(e,c):this.navigateToNextPage(e,c)}onPageUp(e){let t=this.beans,i=oC(t),{pageBounds:n,rowModel:o,rowAutoHeight:r}=t,s=n.getPixelOffset(),a=i.top,l=o.getRowIndexAtPixel(a+s);r?.active?this.navigateToNextPageWithAutoHeight(e,l,!0):this.navigateToNextPage(e,l,!0)}navigateToNextPage(e,t,i=!1){let{pageBounds:n,rowModel:o}=this.beans,r=this.getViewportHeight(),s=n.getFirstRow(),a=n.getLastRow(),l=n.getPixelOffset(),c=o.getRow(e.rowIndex),d=i?c?.rowHeight-r-l:r-l,u=c?.rowTop+d,h=o.getRowIndexAtPixel(u+l);if(h===e.rowIndex){let g=i?-1:1;t=h=e.rowIndex+g}let p;i?(p="bottom",h<s&&(h=s),t<s&&(t=s)):(p="top",h>a&&(h=a),t>a&&(t=a)),this.isRowTallerThanView(o.getRow(h))&&(t=h,p="top"),this.navigateTo({scrollIndex:t,scrollType:p,scrollColumn:null,focusIndex:h,focusColumn:e.column})}navigateToNextPageWithAutoHeight(e,t,i=!1){this.navigateTo({scrollIndex:t,scrollType:i?"bottom":"top",scrollColumn:null,focusIndex:t,focusColumn:e.column}),setTimeout(()=>{let n=this.getNextFocusIndexForAutoHeight(e,i);this.navigateTo({scrollIndex:t,scrollType:i?"bottom":"top",scrollColumn:null,focusIndex:n,focusColumn:e.column,isAsync:!0})},50)}getNextFocusIndexForAutoHeight(e,t=!1){let i=t?-1:1,n=this.getViewportHeight(),{pageBounds:o,rowModel:r}=this.beans,s=o.getLastRow(),a=0,l=e.rowIndex;for(;l>=0&&l<=s;){let c=r.getRow(l);if(c){let d=c.rowHeight??0;if(a+d>n)break;a+=d}l+=i}return Math.max(0,Math.min(l,s))}getViewportHeight(){let e=this.beans,t=oC(e),i=this.beans.scrollVisibleSvc.getScrollbarWidth(),n=t.bottom-t.top;return e.ctrlsSvc.get("center").isHorizontalScrollShowing()&&(n-=i),n}isRowTallerThanView(e){if(!e)return!1;let t=e.rowHeight;return typeof t!="number"?!1:t>this.getViewportHeight()}onCtrlUpDownLeftRight(e,t){let i=this.beans.cellNavigation.getNextCellToFocus(e,t,!0),n=this.getNormalisedPosition(i),{rowIndex:o,rowPinned:r,column:s}=n??i,a=s;this.navigateTo({scrollIndex:o,scrollType:null,scrollColumn:a,focusIndex:o,focusColumn:a,rowPinned:r})}onHomeOrEndKey(e){let t=e===T.PAGE_HOME,{visibleCols:i,pageBounds:n,rowModel:o}=this.beans,r=i.allCols,s=t?n.getFirstRow():n.getLastRow(),a=o.getRow(s);if(!a)return;let l=(t?r:[...r].reverse()).find(c=>!c.isSuppressNavigable(a));l&&this.navigateTo({scrollIndex:s,scrollType:null,scrollColumn:l,focusIndex:s,focusColumn:l})}onTabKeyDown(e,t){let i=t.shiftKey,n=this.tabToNextCellCommon(e,i,t),o=this.beans,{ctrlsSvc:r,pageBounds:s,focusSvc:a,gos:l}=o;if(n!==!1){n?t.preventDefault():n===null&&r.get("gridCtrl").allowFocusForNextCoreContainer(i);return}if(i){let{rowIndex:c,rowPinned:d}=e.getRowPosition();(d?c===0:c===s.getFirstRow())&&(l.get("headerHeight")===0||na(o)?Rl(o,!0,!0):(t.preventDefault(),a.focusPreviousFromFirstCell(t)))}else e instanceof yl&&e.focusCell(!0),(a.focusOverlay(!1)||Rl(o,i))&&t.preventDefault()}tabToNextCell(e,t){let i=this.beans,{focusSvc:n,rowRenderer:o}=i,r=n.getFocusedCell();if(!r)return!1;let s=dl(i,r);return!s&&(s=o.getRowByPosition(r),!s?.isFullWidth())?!1:!!this.tabToNextCellCommon(s,e,t,"api")}tabToNextCellCommon(e,t,i,n="ui"){let{editSvc:o,focusSvc:r}=this.beans,s,a=e instanceof yl?e:e.getAllCellCtrls()?.[0];return o?.isEditing()?s=o?.moveToNextCell(a,t,i,n):s=this.moveToNextCellNotEditing(e,t,i),s===null?s:s||!!r.focusedHeader}moveToNextCellNotEditing(e,t,i){let n=this.beans.visibleCols.allCols,o;if(e instanceof jp){if(o=z(b({},e.getRowPosition()),{column:t?n[0]:rt(n)}),this.gos.get("embedFullWidthRows")&&i){let s=e.findFullWidthInfoForEvent(i);s&&(o.column=s.column)}}else o=e.getFocusedCellPosition();let r=this.findNextCellToFocusOn(o,{backwards:t,startEditing:!1});if(r===!1)return null;if(r instanceof yl)r.focusCell(!0);else if(r)return this.tryToFocusFullWidthRow(r,t);return ie(r)}findNextCellToFocusOn(e,{backwards:t,startEditing:i,skipToNextEditableCell:n}){let o=e,r=this.beans,{cellNavigation:s,gos:a,focusSvc:l,rowRenderer:c,rangeSvc:d}=r;for(;;){e!==o&&(e=o),t||(o=this.getLastCellOfColSpan(o)),o=s.getNextTabbedCell(o,t);let u=a.getCallback("tabToNextCell");if(ie(u)){let f=u({backwards:t,editing:i,previousCellPosition:e,nextCellPosition:o||null});if(f===!0)o=e;else{if(f===!1)return!1;o={rowIndex:f.rowIndex,column:f.column,rowPinned:f.rowPinned}}}if(!o)return null;if(o.rowIndex<0){let g=mo(r);return l.focusHeaderPosition({headerPosition:{headerRowIndex:g+o.rowIndex,column:o.column},fromCell:!0}),null}let h=a.get("editType")==="fullRow";if(i&&(!h||n)&&!this.isCellEditable(o))continue;this.ensureCellVisible(o);let p=dl(r,o);if(!p){let g=c.getRowByPosition(o);if(!g||!g.isFullWidth()||i)continue;return z(b({},g.getRowPosition()),{column:o?.column})}if(!s.isSuppressNavigable(p.column,p.rowNode))return p.setFocusedCellPosition(o),d?.setRangeToCell(o),p}}isCellEditable(e){let t=this.lookupRowNodeForCell(e);return t?e.column.isCellEditable(t):!1}lookupRowNodeForCell({rowIndex:e,rowPinned:t}){let{pinnedRowModel:i,rowModel:n}=this.beans;return t==="top"?i?.getPinnedTopRow(e):t==="bottom"?i?.getPinnedBottomRow(e):n.getRow(e)}navigateToNextCell(e,t,i,n){let o=i,r=!1,s=this.beans,{cellNavigation:a,focusSvc:l,gos:c}=s;for(;o&&(o===i||!this.isValidNavigateCell(o));)c.get("enableRtl")?t===T.LEFT&&(o=this.getLastCellOfColSpan(o)):t===T.RIGHT&&(o=this.getLastCellOfColSpan(o)),o=a.getNextCellToFocus(t,o),r=mt(o);if(r&&e&&e.key===T.UP&&(o={rowIndex:-1,rowPinned:null,column:i.column}),n){let u=c.getCallback("navigateToNextCell");if(ie(u)){let p=u({key:t,previousCellPosition:i,nextCellPosition:o||null,event:e});ie(p)?o={rowPinned:p.rowPinned,rowIndex:p.rowIndex,column:p.column}:o=null}}if(!o)return;if(o.rowIndex<0){let u=mo(s);l.focusHeaderPosition({headerPosition:{headerRowIndex:u+o.rowIndex,column:i.column},event:e||void 0,fromCell:!0});return}let d=this.getNormalisedPosition(o);d?this.focusPosition(d):this.tryToFocusFullWidthRow(o)}getNormalisedPosition(e){if(!!this.beans.spannedRowRenderer?.getCellByPosition(e))return e;this.ensureCellVisible(e);let i=dl(this.beans,e);return i?(e=i.getFocusedCellPosition(),this.ensureCellVisible(e),e):null}tryToFocusFullWidthRow(e,t){let{visibleCols:i,rowRenderer:n,focusSvc:o,eventSvc:r}=this.beans,s=i.allCols;if(!n.getRowByPosition(e)?.isFullWidth())return!1;let l=o.getFocusedCell(),c={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column||(t?rt(s):s[0])};this.focusPosition(c);let d=t??(l!=null&&jH(c,l));return r.dispatchEvent({type:"fullWidthRowFocused",rowIndex:c.rowIndex,rowPinned:c.rowPinned,column:c.column,isFullWidthCell:!0,fromBelow:d}),!0}focusPosition(e){let{focusSvc:t,rangeSvc:i}=this.beans;t.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0}),i?.setRangeToCell(e)}isValidNavigateCell(e){return!!lr(this.beans,e)}getLastCellOfColSpan(e){let t=dl(this.beans,e);if(!t)return e;let i=t.getColSpanningList();return i.length===1?e:{rowIndex:e.rowIndex,column:rt(i),rowPinned:e.rowPinned}}ensureCellVisible(e){let t=RR(this.gos),i=this.beans.rowModel.getRow(e.rowIndex),n=t&&i?.sticky,{scrollFeature:o}=this.gridBodyCon;!n&&mt(e.rowPinned)&&o.ensureIndexVisible(e.rowIndex),e.column.isPinned()||o.ensureColumnVisible(e.column)}ensureColumnVisible(e){let t=this.gridBodyCon.scrollFeature;e.isPinned()||t.ensureColumnVisible(e)}ensureRowVisible(e){this.gridBodyCon.scrollFeature.ensureIndexVisible(e)}};function oC(e){return e.ctrlsSvc.getScrollFeature().getVScrollPosition()}var XW={moduleName:"KeyboardNavigation",version:ee,beans:[YW,CW,kz],apiFunctions:{getFocusedCell:wW,clearFocusedCell:bW,setFocusedCell:yW,setFocusedHeader:EW,tabToNextCell:SW,tabToPreviousCell:xW}},JW=class extends A{constructor(){super(...arguments),this.beanName="pageBoundsListener"}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this),recalculateRowBounds:this.calculatePages.bind(this)}),this.onModelUpdated()}onModelUpdated(e){this.calculatePages(),this.eventSvc.dispatchEvent({type:"paginationChanged",animate:e?.animate??!1,newData:e?.newData??!1,newPage:e?.newPage??!1,newPageSize:e?.newPageSize??!1,keepRenderedRows:e?.keepRenderedRows??!1})}calculatePages(){let{pageBounds:e,pagination:t,rowModel:i}=this.beans;t?t.calculatePages():e.calculateBounds(0,i.getRowCount()-1)}},QW=class extends A{constructor(){super(...arguments),this.beanName="pageBounds",this.pixelOffset=0}getFirstRow(){return this.topRowBounds?.rowIndex??-1}getLastRow(){return this.bottomRowBounds?.rowIndex??-1}getCurrentPageHeight(){let{topRowBounds:e,bottomRowBounds:t}=this;return!e||!t?0:Math.max(t.rowTop+t.rowHeight-e.rowTop,0)}getCurrentPagePixelRange(){let{topRowBounds:e,bottomRowBounds:t}=this,i=e?.rowTop??0,n=t?t.rowTop+t.rowHeight:0;return{pageFirstPixel:i,pageLastPixel:n}}calculateBounds(e,t){let{rowModel:i}=this.beans,n=i.getRowBounds(e);n&&(n.rowIndex=e),this.topRowBounds=n;let o=i.getRowBounds(t);o&&(o.rowIndex=t),this.bottomRowBounds=o,this.calculatePixelOffset()}getPixelOffset(){return this.pixelOffset}calculatePixelOffset(){let e=this.topRowBounds?.rowTop??0;this.pixelOffset!==e&&(this.pixelOffset=e,this.eventSvc.dispatchEvent({type:"paginationPixelOffsetChanged"}))}},ZW=".ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top{min-width:0;overflow:hidden;position:relative}.ag-pinned-left-sticky-top,.ag-pinned-right-sticky-top{height:100%;overflow:hidden;position:relative}.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{height:100%;overflow:hidden;width:100%}.ag-pinned-left-header,.ag-pinned-right-header{display:inline-block;height:100%;overflow:hidden;position:relative}.ag-body-horizontal-scroll:not(.ag-scrollbar-invisible){.ag-horizontal-left-spacer:not(.ag-scroller-corner){border-right:var(--ag-pinned-column-border)}.ag-horizontal-right-spacer:not(.ag-scroller-corner){border-left:var(--ag-pinned-column-border)}}.ag-pinned-right-header{border-left:var(--ag-pinned-column-border)}.ag-pinned-left-header{border-right:var(--ag-pinned-column-border)}.ag-cell.ag-cell-first-right-pinned:not(.ag-cell-range-left,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-left:var(--ag-pinned-column-border)}.ag-cell.ag-cell-last-left-pinned:not(.ag-cell-range-right,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-right:var(--ag-pinned-column-border)}.ag-pinned-left-header .ag-header-cell-resize:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}.ag-pinned-right-header .ag-header-cell-resize:after{left:50%}.ag-pinned-left-header .ag-header-cell-resize{right:-3px}.ag-pinned-right-header .ag-header-cell-resize{left:-3px}",eU=class extends A{constructor(e,t){super(),this.isLeft=e,this.elements=t,this.getWidth=e?()=>this.beans.pinnedCols.leftWidth:()=>this.beans.pinnedCols.rightWidth}postConstruct(){this.addManagedEventListeners({[`${this.isLeft?"left":"right"}PinnedWidthChanged`]:this.onPinnedWidthChanged.bind(this)})}onPinnedWidthChanged(){let e=this.getWidth(),t=e>0;for(let i of this.elements)i&&(ft(i,t),vo(i,e))}},tU=class extends A{constructor(){super(...arguments),this.beanName="pinnedCols"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,t=>{this.gridBodyCtrl=t.gridBodyCtrl});let e=this.checkContainerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}checkContainerWidths(){let{gos:e,visibleCols:t,eventSvc:i}=this.beans,n=li(e,"print"),o=n?0:t.getColsLeftWidth(),r=n?0:t.getDisplayedColumnsRightWidth();o!=this.leftWidth&&(this.leftWidth=o,i.dispatchEvent({type:"leftPinnedWidthChanged"})),r!=this.rightWidth&&(this.rightWidth=r,i.dispatchEvent({type:"rightPinnedWidthChanged"}))}keepPinnedColumnsNarrowerThanViewport(){let e=this.gridBodyCtrl.eBodyViewport,t=fd(e);if(t<=50)return;let i=this.getPinnedColumnsOverflowingViewport(t-50),n=this.gos.getCallback("processUnpinnedColumns"),{columns:o,hasLockedPinned:r}=i,s=o;!s.length&&!r||(n&&(s=n({columns:s,viewportWidth:t})),s?.length&&(s=s.filter(a=>!or(a)),this.setColsPinned(s,null,"viewportSizeFeature")))}createPinnedWidthFeature(e,...t){return new eU(e,t)}setColsPinned(e,t,i){let{colModel:n,colAnimation:o,visibleCols:r,gos:s}=this.beans;if(!n.cols||!e?.length)return;if(li(s,"print")){W(37);return}o?.start();let a;t===!0||t==="left"?a="left":t==="right"?a="right":a=null;let l=[];for(let c of e){if(!c)continue;let d=n.getCol(c);d&&d.getPinned()!==a&&(this.setColPinned(d,a),l.push(d))}l.length&&(r.refresh(i),WR(this.eventSvc,l,i)),o?.finish()}initCol(e){let{pinned:t,initialPinned:i}=e.colDef;t!==void 0?this.setColPinned(e,t):this.setColPinned(e,i)}setColPinned(e,t){t===!0||t==="left"?e.pinned="left":t==="right"?e.pinned="right":e.pinned=null,e.dispatchStateUpdatedEvent("pinned")}setupHeaderPinnedWidth(e){let{scrollVisibleSvc:t}=this.beans;if(e.pinned==null)return;let i=e.pinned==="left",n=e.pinned==="right";e.hidden=!0;let o=()=>{let r=i?this.leftWidth:this.rightWidth;if(r==null)return;let s=r==0,a=e.hidden!==s,l=this.gos.get("enableRtl"),c=t.getScrollbarWidth(),u=t.verticalScrollShowing&&(l&&i||!l&&n)?r+c:r;e.comp.setPinnedContainerWidth(`${u}px`),e.comp.setDisplayed(!s),a&&(e.hidden=s,e.refresh())};e.addManagedEventListeners({leftPinnedWidthChanged:o,rightPinnedWidthChanged:o,scrollVisibilityChanged:o,scrollbarWidthChanged:o})}getHeaderResizeDiff(e,t){if(t.getPinned()){let{leftWidth:n,rightWidth:o}=this,r=fd(this.beans.ctrlsSvc.getGridBodyCtrl().eBodyViewport)-50;if(n+o+e>r)if(r>n+o)e=r-n-o;else return 0}return e}getPinnedColumnsOverflowingViewport(e){let t=this.rightWidth??0,i=this.leftWidth??0,n=t+i,o=!1;if(n<e)return{columns:[],hasLockedPinned:o};let{visibleCols:r}=this.beans,s=[...r.leftCols],a=[...r.rightCols],l=0,c=0,d=0,u=[],h=n-d-e;for(;(c<s.length||l<a.length)&&h>0;){if(l<a.length){let p=a[l++];if(p.colDef.lockPinned){o=!0;continue}h-=p.getActualWidth(),u.push(p)}if(c<s.length&&h>0){let p=s[c++];if(p.colDef.lockPinned){o=!0;continue}h-=p.getActualWidth(),u.push(p)}}return{columns:u,hasLockedPinned:o}}},iU={moduleName:"PinnedColumn",version:ee,beans:[tU],css:[ZW]},nU=class extends A{constructor(){super(),this.beanName="ariaAnnounce",this.descriptionContainer=null,this.pendingAnnouncements=new Map,this.lastAnnouncement="",this.updateAnnouncement=si(this,this.updateAnnouncement.bind(this),200)}postConstruct(){let e=this.beans,t=Qt(e),i=this.descriptionContainer=t.createElement("div");i.classList.add("ag-aria-description-container"),Q_(i,"polite"),R7(i,"additions text"),_7(i,!0),e.eGridDiv.appendChild(i)}announceValue(e,t){this.pendingAnnouncements.set(t,e),this.updateAnnouncement()}updateAnnouncement(){if(!this.descriptionContainer)return;let e=Array.from(this.pendingAnnouncements.values()).join(". ");this.pendingAnnouncements.clear(),this.descriptionContainer.textContent="",setTimeout(()=>{this.handleAnnouncementUpdate(e)},50)}handleAnnouncementUpdate(e){if(!this.isAlive()||!this.descriptionContainer)return;let t=e;if(t==null||t.replace(/[ .]/g,"")==""){this.lastAnnouncement="";return}this.lastAnnouncement===t&&(t=`${t}\u200B`),this.lastAnnouncement=t,this.descriptionContainer.textContent=t}destroy(){super.destroy();let{descriptionContainer:e}=this;e&&(ai(e),e.remove()),this.descriptionContainer=null,this.pendingAnnouncements.clear()}},oU={moduleName:"Aria",version:ee,beans:[nU]},rU=":where(.ag-delay-render){.ag-cell,.ag-header-cell,.ag-header-group-cell,.ag-row,.ag-spanned-cell-wrapper{visibility:hidden}}",I_="ag-delay-render",sU=class extends A{constructor(){super(...arguments),this.beanName="colDelayRenderSvc",this.hideRequested=!1,this.alreadyRevealed=!1,this.timesRetried=0,this.requesters=new Set}hideColumns(e){this.alreadyRevealed||this.requesters.has(e)||(this.requesters.add(e),this.hideRequested||(this.beans.ctrlsSvc.whenReady(this,t=>{t.gridBodyCtrl.eGridBody.classList.add(I_)}),this.hideRequested=!0))}revealColumns(e){if(this.alreadyRevealed||!this.isAlive()||(this.requesters.delete(e),this.requesters.size>0))return;let{renderStatus:t,ctrlsSvc:i}=this.beans;if(t){if(!t.areHeaderCellsRendered()&&this.timesRetried<5){this.timesRetried++,setTimeout(()=>this.revealColumns(e));return}this.timesRetried=0}i.getGridBodyCtrl().eGridBody.classList.remove(I_),this.alreadyRevealed=!0}},aU={moduleName:"ColumnDelayRender",version:ee,beans:[sU],css:[rU]};function lU(e){e.overlays?.showLoadingOverlay()}function cU(e){e.overlays?.showNoRowsOverlay()}function dU(e){e.overlays?.hideOverlay()}var uU=".ag-overlay{inset:0;pointer-events:none;position:absolute;z-index:2}.ag-overlay-panel,.ag-overlay-wrapper{display:flex;height:100%;width:100%}.ag-overlay-wrapper{align-items:center;flex:none;justify-content:center;text-align:center}.ag-overlay-loading-wrapper{pointer-events:all}.ag-overlay-loading-center{background:var(--ag-background-color);border:solid var(--ag-border-width) var(--ag-border-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-popup-shadow);padding:var(--ag-spacing)}",hU={tag:"div",cls:"ag-overlay",role:"presentation",children:[{tag:"div",cls:"ag-overlay-panel",role:"presentation",children:[{tag:"div",ref:"eOverlayWrapper",cls:"ag-overlay-wrapper",role:"presentation"}]}]},bD=class extends je{constructor(){super(hU),this.eOverlayWrapper=Z,this.activePromise=null,this.activeOverlay=null,this.updateListenerDestroyFunc=null,this.activeCssClass=null,this.elToFocusAfter=null,this.registerCSS(uU)}handleKeyDown(e){if(e.key!==T.TAB||e.defaultPrevented||sr(e))return;let t=this.beans;if(ha(t,this.eOverlayWrapper,!1,e.shiftKey))return;let n=!1;e.shiftKey?n=t.focusSvc.focusGridView({column:rt(t.visibleCols.allCols),backwards:!0,canFocusOverlay:!1}):n=Rl(t,!1),n&&e.preventDefault()}updateLayoutClasses(e,t){let i=this.eOverlayWrapper.classList,{AUTO_HEIGHT:n,NORMAL:o,PRINT:r}=Nn;i.toggle(n,t.autoHeight),i.toggle(o,t.normal),i.toggle(r,t.print)}postConstruct(){this.createManagedBean(new fw(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.beans.overlays.setOverlayWrapperComp(this),this.addManagedElementListeners(this.getFocusableElement(),{keydown:this.handleKeyDown.bind(this)})}setWrapperTypeClass(e){let t=this.eOverlayWrapper.classList;this.activeCssClass&&t.toggle(this.activeCssClass,!1),this.activeCssClass=e,t.toggle(e,!0)}showOverlay(e,t,i,n){if(this.setWrapperTypeClass(t),this.destroyActiveOverlay(),this.elToFocusAfter=null,this.activePromise=e,!!e){if(this.setDisplayed(!0,{skipAriaHidden:!0}),i&&this.isGridFocused()){let o=Ct(this.beans);o&&!K_(this.beans)&&(this.elToFocusAfter=o)}e.then(o=>{if(this.activePromise!==e){this.activeOverlay!==o&&(this.destroyBean(o),o=null);return}if(this.activePromise=null,!!o){if(this.activeOverlay!==o&&(this.eOverlayWrapper.appendChild(o.getGui()),this.activeOverlay=o,n)){let r=o;this.updateListenerDestroyFunc=this.addManagedPropertyListener(n,({currentValue:s})=>{r.refresh?.(ye(this.gos,b({},s??{})))})}i&&this.isGridFocused()&&aa(this.eOverlayWrapper)}})}}updateOverlayWrapperPaddingTop(e){this.eOverlayWrapper.style.setProperty("padding-top",`${e}px`)}destroyActiveOverlay(){this.activePromise=null;let e=this.activeOverlay;if(!e)return;let t=this.elToFocusAfter;this.activeOverlay=null,this.elToFocusAfter=null,t&&!this.isGridFocused()&&(t=null);let i=this.updateListenerDestroyFunc;i&&(i(),this.updateListenerDestroyFunc=null),this.destroyBean(e),ai(this.eOverlayWrapper),t?.focus?.({preventScroll:!0})}hideOverlay(){this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}isGridFocused(){let e=Ct(this.beans);return!!e&&this.beans.eGridDiv.contains(e)}destroy(){this.elToFocusAfter=null,this.destroyActiveOverlay(),this.beans.overlays.setOverlayWrapperComp(void 0),super.destroy()}},pU={selector:"AG-OVERLAY-WRAPPER",component:bD},gU=class extends A{constructor(){super(...arguments),this.beanName="overlays",this.state=0,this.showInitialOverlay=!0,this.wrapperPadding=0}postConstruct(){this.isClientSide=Tt(this.gos),this.isServerSide=!this.isClientSide&&Ml(this.gos);let e=()=>this.updateOverlayVisibility();this.addManagedEventListeners({newColumnsLoaded:e,rowDataUpdated:e,gridSizeChanged:this.refreshWrapperPadding.bind(this),rowCountReady:()=>{this.showInitialOverlay=!1,this.updateOverlayVisibility()}}),this.addManagedPropertyListener("loading",e)}setOverlayWrapperComp(e){this.eWrapper=e,this.updateOverlayVisibility()}isVisible(){return this.state!==0&&!!this.eWrapper}isExclusive(){return this.state===1&&!!this.eWrapper}showLoadingOverlay(){this.showInitialOverlay=!1;let e=this.gos,t=e.get("loading");!t&&(t!==void 0||e.get("suppressLoadingOverlay"))||this.doShowLoadingOverlay()}showNoRowsOverlay(){this.showInitialOverlay=!1;let e=this.gos;e.get("loading")||e.get("suppressNoRowsOverlay")||this.doShowNoRowsOverlay()}hideOverlay(){if(this.showInitialOverlay=!1,this.gos.get("loading")){W(99);return}this.doHideOverlay()}getOverlayWrapperSelector(){return pU}getOverlayWrapperCompClass(){return bD}updateOverlayVisibility(){if(!this.eWrapper){this.state=0;return}let{state:e,isClientSide:t,isServerSide:i,beans:{gos:n,colModel:o,rowModel:r}}=this,s=this.gos.get("loading");s!==void 0&&(this.showInitialOverlay=!1),this.showInitialOverlay&&s===void 0&&!n.get("suppressLoadingOverlay")&&(s=!n.get("columnDefs")||!o.ready||!n.get("rowData")&&t),s?e!==1&&this.doShowLoadingOverlay():(this.showInitialOverlay=!1,t&&r.isEmpty()&&!n.get("suppressNoRowsOverlay")?e!==2&&this.doShowNoRowsOverlay():(e===1||!i&&e!==0)&&this.doHideOverlay())}doShowLoadingOverlay(){this.eWrapper&&(this.state=1,this.showOverlay(BO(this.beans.userCompFactory,ye(this.gos,{})),"ag-overlay-loading-wrapper","loadingOverlayComponentParams"),this.updateExclusive())}doShowNoRowsOverlay(){this.eWrapper&&(this.state=2,this.showOverlay(HO(this.beans.userCompFactory,ye(this.gos,{})),"ag-overlay-no-rows-wrapper","noRowsOverlayComponentParams"),this.updateExclusive())}doHideOverlay(){this.eWrapper&&(this.state=0,this.eWrapper.hideOverlay(),this.updateExclusive())}showOverlay(e,t,i){let n=e?.newAgStackInstance()??null;this.eWrapper?.showOverlay(n,t,this.isExclusive(),i),this.refreshWrapperPadding()}updateExclusive(){let e=this.exclusive;this.exclusive=this.isExclusive(),this.exclusive!==e&&this.eventSvc.dispatchEvent({type:"overlayExclusiveChanged"})}refreshWrapperPadding(){let e=this.eWrapper;if(!e)return;let t=0;this.state===2&&(t=this.beans.ctrlsSvc.get("gridHeaderCtrl")?.headerHeight||0),this.wrapperPadding!==t&&(this.wrapperPadding=t,e.updateOverlayWrapperPaddingTop(t))}},fU={moduleName:"Overlay",version:ee,userComponents:{agLoadingOverlay:FB,agNoRowsOverlay:AB},apiFunctions:{showLoadingOverlay:lU,showNoRowsOverlay:cU,hideOverlay:dU},beans:[gU]},mU=class extends A{constructor(){super(...arguments),this.beanName="rowContainerHeight",this.scrollY=0,this.uiBodyHeight=0}postConstruct(){this.addManagedEventListeners({bodyHeightChanged:this.updateOffset.bind(this)}),this.maxDivHeight=WO(),Qr(this.gos,"RowContainerHeightService - maxDivHeight = "+this.maxDivHeight)}updateOffset(){if(!this.stretching)return;let e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition().top,t=this.getUiBodyHeight();(e!==this.scrollY||t!==this.uiBodyHeight)&&(this.scrollY=e,this.uiBodyHeight=t,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;let e=this.scrollY/this.maxScrollY,t=e*this.pixelsToShave;Qr(this.gos,`RowContainerHeightService - Div Stretch Offset = ${t} (${this.pixelsToShave} * ${e})`),this.setDivStretchOffset(t)}setUiContainerHeight(e){e!==this.uiContainerHeight&&(this.uiContainerHeight=e,this.eventSvc.dispatchEvent({type:"rowContainerHeightChanged"}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(e){let t=typeof e=="number"?Math.floor(e):null;this.divStretchOffset!==t&&(this.divStretchOffset=t,this.eventSvc.dispatchEvent({type:"heightScaleChanged"}))}setModelHeight(e){this.modelHeight=e,this.stretching=e!=null&&this.maxDivHeight>0&&e>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getRealPixelPosition(e){return e-this.divStretchOffset}getUiBodyHeight(){let e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition();return e.bottom-e.top}getScrollPositionForPixel(e){if(this.pixelsToShave<=0)return e;let t=this.modelHeight-this.getUiBodyHeight(),i=e/t;return this.maxScrollY*i}},vU=400,CU=class extends A{constructor(){super(...arguments),this.beanName="rowRenderer",this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1,this.setupRangeSelectionListeners=()=>{let e=()=>{for(let r of this.getAllCellCtrls())r.onCellSelectionChanged()},t=()=>{for(let r of this.getAllCellCtrls())r.updateRangeBordersIfRangeCount()},i=()=>{this.eventSvc.addListener("cellSelectionChanged",e),this.eventSvc.addListener("columnMoved",t),this.eventSvc.addListener("columnPinned",t),this.eventSvc.addListener("columnVisible",t)},n=()=>{this.eventSvc.removeListener("cellSelectionChanged",e),this.eventSvc.removeListener("columnMoved",t),this.eventSvc.removeListener("columnPinned",t),this.eventSvc.removeListener("columnVisible",t)};this.addDestroyFunc(()=>n()),this.addManagedPropertyListeners(["enableRangeSelection","cellSelection"],()=>{ar(this.gos)?i():n()}),ar(this.gos)&&i()}}wireBeans(e){this.pageBounds=e.pageBounds,this.colModel=e.colModel,this.pinnedRowModel=e.pinnedRowModel,this.rowModel=e.rowModel,this.focusSvc=e.focusSvc,this.rowContainerHeight=e.rowContainerHeight,this.ctrlsSvc=e.ctrlsSvc,this.editSvc=e.editSvc}postConstruct(){this.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.initialise()})}initialise(){this.addManagedEventListeners({paginationChanged:this.onPageLoaded.bind(this),pinnedRowDataChanged:this.onPinnedRowDataChanged.bind(this),pinnedRowsChanged:this.onPinnedRowsChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),bodyScroll:this.onBodyScroll.bind(this),bodyHeightChanged:this.redraw.bind(this,{})}),this.addManagedPropertyListeners(["domLayout","embedFullWidthRows"],()=>this.onDomLayoutChanged()),this.addManagedPropertyListeners(["suppressMaxRenderedRowRestriction","rowBuffer"],()=>this.redraw()),this.addManagedPropertyListener("suppressCellFocus",n=>this.onSuppressCellFocusChanged(n.currentValue)),this.addManagedPropertyListeners(["groupSuppressBlankHeader","getBusinessKeyForNode","fullWidthCellRenderer","fullWidthCellRendererParams","suppressStickyTotalRow","groupRowRenderer","groupRowRendererParams","loadingCellRenderer","loadingCellRendererParams","detailCellRenderer","detailCellRendererParams","enableRangeSelection","enableCellTextSelection"],()=>this.redrawRows()),this.addManagedPropertyListener("cellSelection",({currentValue:n,previousValue:o})=>{(!o&&n||o&&!n)&&this.redrawRows()});let{stickyRowSvc:e,gos:t,showRowGroupCols:i}=this.beans;if(i&&this.addManagedPropertyListener("showOpenedGroup",()=>{let n=i.getShowRowGroupCols();n.length&&this.refreshCells({columns:n,force:!0})}),e)this.stickyRowFeature=e.createStickyRowFeature(this,this.createRowCon.bind(this),this.destroyRowCtrls.bind(this));else{let n=this.gridBodyCtrl;n.setStickyTopHeight(0),n.setStickyBottomHeight(0)}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=li(t,"print"),this.embedFullWidthRows=this.printLayout||t.get("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gos.get("keepDetailRows")){let e=this.getKeepDetailRowsCount(),t=e??3;this.cachedRowCtrls=new wU(t)}}getKeepDetailRowsCount(){return this.gos.get("keepDetailRowsCount")}getStickyTopRowCtrls(){return this.stickyRowFeature?.stickyTopRowCtrls??[]}getStickyBottomRowCtrls(){return this.stickyRowFeature?.stickyBottomRowCtrls??[]}updateAllRowCtrls(){let e=Object.values(this.rowCtrlsByRowIndex),t=Object.values(this.zombieRowCtrls),i=this.cachedRowCtrls?.getEntries()??[];t.length>0||i.length>0?this.allRowCtrls=[...e,...t,...i]:this.allRowCtrls=e}isCellBeingRendered(e,t){let i=this.rowCtrlsByRowIndex[e];return!t||!i?!!i:i.isFullWidth()?!0:!!this.beans.spannedRowRenderer?.getCellByPosition({rowIndex:e,column:t,rowPinned:null})||!!i.getCellCtrl(t)||!i.isRowRendered()}updateCellFocus(e){for(let t of this.getAllCellCtrls())t.onCellFocused(e);for(let t of this.getFullWidthRowCtrls())t.onFullWidthRowFocused(e)}onCellFocusChanged(e){if(e?.rowIndex!=null&&!e.rowPinned){let t=this.beans.colModel.getCol(e.column)??void 0;this.isCellBeingRendered(e.rowIndex,t)||this.redraw()}this.updateCellFocus(e)}onSuppressCellFocusChanged(e){for(let t of this.getAllCellCtrls())t.onSuppressCellFocusChanged(e);for(let t of this.getFullWidthRowCtrls())t.onSuppressCellFocusChanged(e)}registerCellEventListeners(){this.addManagedEventListeners({cellFocused:e=>this.onCellFocusChanged(e),cellFocusCleared:()=>this.updateCellFocus(),flashCells:e=>{let{cellFlashSvc:t}=this.beans;if(t)for(let i of this.getAllCellCtrls())t.onFlashCells(i,e)},columnHoverChanged:()=>{for(let e of this.getAllCellCtrls())e.onColumnHover()},displayedColumnsChanged:()=>{for(let e of this.getAllCellCtrls())e.onDisplayedColumnsChanged()},displayedColumnsWidthChanged:()=>{if(this.printLayout)for(let e of this.getAllCellCtrls())e.onLeftChanged()}}),this.setupRangeSelectionListeners(),this.refreshListenersToColumnsForCellComps(),this.addManagedEventListeners({gridColumnsChanged:this.refreshListenersToColumnsForCellComps.bind(this)}),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){for(let e of this.destroyFuncsForColumnListeners)e();this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners();let e=this.colModel.getCols();for(let t of e){let i=l=>{for(let c of this.getAllCellCtrls())c.column===t&&l(c)},n=()=>{i(l=>l.onLeftChanged())},o=()=>{i(l=>l.onWidthChanged())},r=()=>{i(l=>l.onFirstRightPinnedChanged())},s=()=>{i(l=>l.onLastLeftPinnedChanged())},a=()=>{i(l=>l.onColDefChanged())};t.__addEventListener("leftChanged",n),t.__addEventListener("widthChanged",o),t.__addEventListener("firstRightPinnedChanged",r),t.__addEventListener("lastLeftPinnedChanged",s),t.__addEventListener("colDefChanged",a),this.destroyFuncsForColumnListeners.push(()=>{t.__removeEventListener("leftChanged",n),t.__removeEventListener("widthChanged",o),t.__removeEventListener("firstRightPinnedChanged",r),t.__removeEventListener("lastLeftPinnedChanged",s),t.__removeEventListener("colDefChanged",a)})}}onDomLayoutChanged(){let e=li(this.gos,"print"),t=e||this.gos.get("embedFullWidthRows"),i=t!==this.embedFullWidthRows||this.printLayout!==e;this.printLayout=e,this.embedFullWidthRows=t,i&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;let e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}onPageLoaded(e){let t={recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0};this.redrawAfterModelUpdate(t)}getAllCellsNotSpanningForColumn(e){let t=[];for(let i of this.getAllRowCtrls()){let n=i.getCellCtrl(e,!0)?.eGui;n&&t.push(n)}return t}refreshFloatingRowComps(e=!0){this.refreshFloatingRows(this.topRowCtrls,"top",e),this.refreshFloatingRows(this.bottomRowCtrls,"bottom",e)}refreshFloatingRows(e,t,i){let{pinnedRowModel:n,beans:o,printLayout:r}=this,s=Object.fromEntries(e.map(l=>[l.rowNode.id,l]));n?.forEachPinnedRow(t,(l,c)=>{let d=e[c];d&&n.getPinnedRowById(d.rowNode.id,t)===void 0&&(d.destroyFirstPass(),d.destroySecondPass()),l.id in s&&i?(e[c]=s[l.id],delete s[l.id]):e[c]=new jp(l,o,!1,!1,r)});let a=(t==="top"?n?.getPinnedTopRowCount():n?.getPinnedBottomRowCount())??0;e.length=a}onPinnedRowDataChanged(){let e={recycleRows:!0};this.redrawAfterModelUpdate(e)}onPinnedRowsChanged(){this.redrawAfterModelUpdate({recycleRows:!0})}redrawRow(e,t=!1){if(e.sticky)this.stickyRowFeature?.refreshStickyNode(e);else if(this.cachedRowCtrls?.has(e)){this.cachedRowCtrls.removeRow(e);return}else{let i=n=>{let o=n[e.rowIndex];o&&o.rowNode===e&&(o.destroyFirstPass(),o.destroySecondPass(),n[e.rowIndex]=this.createRowCon(e,!1,!1))};switch(e.rowPinned){case"top":i(this.topRowCtrls);break;case"bottom":i(this.bottomRowCtrls);break;default:i(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}t||this.dispatchDisplayedRowsChanged(!1)}redrawRows(e){let{editSvc:t}=this.beans;if(t?.isEditing()&&(t.isBatchEditing()?t.cleanupEditors():t.stopEditing(void 0,{source:"api"})),e!=null){for(let n of e??[])this.redrawRow(n,!0);this.dispatchDisplayedRowsChanged(!1);return}this.redrawAfterModelUpdate()}redrawAfterModelUpdate(e={}){this.getLockOnRefresh();let t=this.beans.focusSvc?.getFocusCellToUseAfterRefresh();this.updateContainerHeights(),this.scrollToTopIfNewData(e);let i=!e.domLayoutChanged&&!!e.recycleRows,n=e.animate&&gl(this.gos),o=i?this.getRowsToRecycle():null;i||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender();let{stickyRowFeature:r,gos:s}=this;if(r){r.checkStickyRows();let a=r.extraTopHeight+r.extraBottomHeight;a&&this.updateContainerHeights(a)}this.recycleRows(o,n),this.gridBodyCtrl.updateRowCount(),e.onlyBody||this.refreshFloatingRowComps(s.get("enableRowPinning")?i:void 0),this.dispatchDisplayedRowsChanged(),t!=null&&this.restoreFocusedCell(t),this.releaseLockOnRefresh()}scrollToTopIfNewData(e){let t=e.newData||e.newPage,i=this.gos.get("suppressScrollOnNewData");t&&!i&&(this.gridBodyCtrl.scrollFeature.scrollToTop(),this.stickyRowFeature?.resetOffsets())}updateContainerHeights(e=0){let{rowContainerHeight:t}=this;if(this.printLayout){t.setModelHeight(null);return}let i=this.pageBounds.getCurrentPageHeight();i===0&&(i=1),t.setModelHeight(i+e)}getLockOnRefresh(){if(this.refreshInProgress)throw new Error(Co(252));this.refreshInProgress=!0,this.beans.frameworkOverrides.getLockOnRefresh?.()}releaseLockOnRefresh(){this.refreshInProgress=!1,this.beans.frameworkOverrides.releaseLockOnRefresh?.()}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(e){if(!e)return;let t=this.beans.focusSvc,i=this.findPositionToFocus(e);if(!i){t.focusHeaderPosition({headerPosition:{headerRowIndex:mo(this.beans)-1,column:e.column}});return}if(e.rowIndex!==i.rowIndex||e.rowPinned!=i.rowPinned){t.setFocusedCell(z(b({},i),{preventScrollOnBrowserFocus:!0,forceBrowserFocus:!0}));return}t.doesRowOrCellHaveBrowserFocus()||this.updateCellFocus(ye(this.gos,z(b({},i),{forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,type:"cellFocused"})))}findPositionToFocus(e){let{pagination:t,pageBounds:i}=this.beans,n=e;for(n.rowPinned==null&&t&&i&&!t.isRowInPage(n.rowIndex)&&(n={rowPinned:null,rowIndex:i.getFirstRow()});n;){if(n.rowPinned==null&&i)if(n.rowIndex<i.getFirstRow()){if(n=qp(this.beans,{rowPinned:null,rowIndex:0}),!n)return null}else n.rowIndex>i.getLastRow()&&(n={rowPinned:null,rowIndex:i.getLastRow()});let o=this.getRowByPosition(n);if(o?.isAlive())return z(b({},o.getRowPosition()),{column:e.column});n=qp(this.beans,n)}return null}getAllCellCtrls(){let e=[],t=this.getAllRowCtrls(),i=t.length;for(let n=0;n<i;n++){let o=t[n].getAllCellCtrls(),r=o.length;for(let s=0;s<r;s++)e.push(o[s])}return e}getAllRowCtrls(){let{spannedRowRenderer:e}=this.beans,t=this.getStickyTopRowCtrls(),i=this.getStickyBottomRowCtrls();return[...this.topRowCtrls,...this.bottomRowCtrls,...t,...i,...e?.getCtrls("top")??[],...e?.getCtrls("bottom")??[],...e?.getCtrls("center")??[],...Object.values(this.rowCtrlsByRowIndex)]}addRenderedRowListener(e,t,i){let n=this.rowCtrlsByRowIndex[t];n&&n.addEventListener(e,i)}refreshCells({rowNodes:e,columns:t,force:i,suppressFlash:n}={}){let o={force:i,newData:!1,suppressFlash:n};for(let r of this.getCellCtrls(e,t))r.refreshOrDestroyCell(o);this.refreshFullWidth(e)}refreshRows(e={}){for(let t of this.getRowCtrls(e.rowNodes))t.refreshRow(e);this.refreshFullWidth(e.rowNodes)}refreshFullWidth(e){if(!e)return;let t=!1;for(let i of this.getRowCtrls(e)){if(!i.isFullWidth())continue;i.refreshFullWidth()||(t=!0,this.redrawRow(i.rowNode,!0))}t&&this.dispatchDisplayedRowsChanged(!1)}getRowCtrls(e){let t=HC(e),i=this.getAllRowCtrls();return!e||!t?i:i.filter(n=>{let o=n.rowNode;return VC(o,t)})}getCellCtrls(e,t){let i;ie(t)&&(i={},t.forEach(o=>{let r=this.colModel.getCol(o);ie(r)&&(i[r.getId()]=!0)}));let n=[];for(let o of this.getRowCtrls(e))for(let r of o.getAllCellCtrls()){let s=r.column.getId();i&&!i[s]||n.push(r)}return n}destroy(){this.removeAllRowComps(!0),super.destroy()}removeAllRowComps(e=!1){let t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t,e),this.stickyRowFeature?.destroyStickyCtrls()}getRowsToRecycle(){let e=[];for(let i of Object.keys(this.rowCtrlsByRowIndex))this.rowCtrlsByRowIndex[i].rowNode.id==null&&e.push(i);this.removeRowCtrls(e);let t={};for(let i of Object.values(this.rowCtrlsByRowIndex)){let n=i.rowNode;t[n.id]=i}return this.rowCtrlsByRowIndex={},t}removeRowCtrls(e,t=!1){for(let i of e){let n=this.rowCtrlsByRowIndex[i];n&&(n.destroyFirstPass(t),n.destroySecondPass()),delete this.rowCtrlsByRowIndex[i]}}onBodyScroll(e){e.direction==="vertical"&&this.redraw({afterScroll:!0})}redraw(e={}){let{focusSvc:t,animationFrameSvc:i}=this.beans,{afterScroll:n}=e,o,r=this.stickyRowFeature;r&&(o=t?.getFocusCellToUseAfterRefresh()||void 0);let s=this.firstRenderedRow,a=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();let l=!1;if(r){l=r.checkStickyRows();let d=r.extraTopHeight+r.extraBottomHeight;d&&this.updateContainerHeights(d)}let c=this.firstRenderedRow!==s||this.lastRenderedRow!==a;if(!(n&&!l&&!c)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,n),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(n&&!l),o!=null)){let d=t?.getFocusCellToUseAfterRefresh();o!=null&&d==null&&(i?.flushAllFrames(),this.restoreFocusedCell(o))}}removeRowCompsNotToDraw(e,t){let i={};for(let r of e)i[r]=!0;let o=Object.keys(this.rowCtrlsByRowIndex).filter(r=>!i[r]);this.removeRowCtrls(o,t)}calculateIndexesToDraw(e){let t=[];for(let s=this.firstRenderedRow;s<=this.lastRenderedRow;s++)t.push(s);let i=this.beans.pagination,n=this.beans.focusSvc?.getFocusedCell()?.rowIndex;n!=null&&(n<this.firstRenderedRow||n>this.lastRenderedRow)&&(!i||i.isRowInPage(n))&&n<this.rowModel.getRowCount()&&t.push(n);let o=s=>{let a=s.rowNode.rowIndex;a==null||a===n||(a<this.firstRenderedRow||a>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(s)&&t.push(a)};for(let s of Object.values(this.rowCtrlsByRowIndex))o(s);if(e)for(let s of Object.values(e))o(s);t.sort((s,a)=>s-a);let r=[];for(let s=0;s<t.length;s++){let a=t[s],l=this.rowModel.getRow(a);l&&!l.sticky&&r.push(a)}return r}recycleRows(e,t=!1,i=!1){let n=this.calculateIndexesToDraw(e);(this.printLayout||i)&&(t=!1),this.removeRowCompsNotToDraw(n,!t);for(let o of n)this.createOrUpdateRowCtrl(o,e,t,i);if(e){let{animationFrameSvc:o}=this.beans;o?.active&&i&&!this.printLayout?o.addDestroyTask(()=>{this.destroyRowCtrls(e,t),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}):this.destroyRowCtrls(e,t)}this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(e=!1){this.eventSvc.dispatchEvent({type:"displayedRowsChanged",afterScroll:e})}onDisplayedColumnsChanged(){let{visibleCols:e}=this.beans,t=e.isPinningLeft(),i=e.isPinningRight();(this.pinningLeft!==t||i!==this.pinningRight)&&(this.pinningLeft=t,this.pinningRight=i,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){let e=[];for(let t of this.getFullWidthRowCtrls()){let i=t.rowNode.rowIndex;e.push(i.toString())}this.refreshFloatingRowComps(),this.removeRowCtrls(e),this.redraw({afterScroll:!0})}getFullWidthRowCtrls(e){let t=HC(e);return this.getAllRowCtrls().filter(i=>{if(!i.isFullWidth())return!1;let n=i.rowNode;return!(t!=null&&!VC(n,t))})}createOrUpdateRowCtrl(e,t,i,n){let o,r=this.rowCtrlsByRowIndex[e];if(r||(o=this.rowModel.getRow(e),ie(o)&&ie(t)&&t[o.id]&&o.alreadyRendered&&(r=t[o.id],t[o.id]=null)),!r)if(o||(o=this.rowModel.getRow(e)),ie(o))r=this.createRowCon(o,i,n);else return;o&&(o.alreadyRendered=!0),this.rowCtrlsByRowIndex[e]=r}destroyRowCtrls(e,t){let i=[];if(e){for(let n of Object.values(e))if(n){if(this.cachedRowCtrls&&n.isCacheable()){this.cachedRowCtrls.addRow(n);continue}if(n.destroyFirstPass(!t),t){let o=n.instanceId;this.zombieRowCtrls[o]=n,i.push(()=>{n.destroySecondPass(),delete this.zombieRowCtrls[o]})}else n.destroySecondPass()}}t&&(i.push(()=>{this.isAlive()&&(this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged())}),window.setTimeout(()=>{for(let n of i)n()},vU))}getRowBuffer(){return this.gos.get("rowBuffer")}getRowBufferInPixels(){let e=this.getRowBuffer(),t=ta(this.beans);return e*t}workOutFirstAndLastRowsToRender(){let{rowContainerHeight:e,pageBounds:t,rowModel:i}=this;e.updateOffset();let n,o;if(!i.isRowsToRender())n=0,o=-1;else if(this.printLayout)this.beans.environment.refreshRowHeightVariable(),n=t.getFirstRow(),o=t.getLastRow();else{let d=this.getRowBufferInPixels(),u=this.ctrlsSvc.getScrollFeature(),h=this.gos.get("suppressRowVirtualisation"),p=!1,g,f;do{let y=t.getPixelOffset(),{pageFirstPixel:_,pageLastPixel:R}=t.getCurrentPagePixelRange(),P=e.divStretchOffset,B=u.getVScrollPosition(),q=B.top,$=B.bottom;h?(g=_+P,f=R+P):(g=Math.max(q+y-d,_)+P,f=Math.min($+y+d,R)+P),this.firstVisibleVPixel=Math.max(q+y,_)+P,this.lastVisibleVPixel=Math.min($+y,R)+P,p=this.ensureAllRowsInRangeHaveHeightsCalculated(g,f)}while(p);let m=i.getRowIndexAtPixel(g),v=i.getRowIndexAtPixel(f),C=t.getFirstRow(),w=t.getLastRow();m<C&&(m=C),v>w&&(v=w),n=m,o=v}let r=li(this.gos,"normal"),s=this.gos.get("suppressMaxRenderedRowRestriction"),a=Math.max(this.getRowBuffer(),500);r&&!s&&o-n>a&&(o=n+a);let l=n!==this.firstRenderedRow,c=o!==this.lastRenderedRow;(l||c)&&(this.firstRenderedRow=n,this.lastRenderedRow=o,this.eventSvc.dispatchEvent({type:"viewportChanged",firstRow:n,lastRow:o}))}dispatchFirstDataRenderedEvent(){this.dataFirstRenderedFired||(this.dataFirstRenderedFired=!0,cr(this.beans,()=>{this.beans.eventSvc.dispatchEvent({type:"firstDataRendered",firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow})}))}ensureAllRowsInRangeHaveHeightsCalculated(e,t){let i=this.pinnedRowModel?.ensureRowHeightsValid(),n=this.stickyRowFeature?.ensureRowHeightsValid(),{pageBounds:o,rowModel:r}=this,s=r.ensureRowHeightsValid(e,t,o.getFirstRow(),o.getLastRow());return(s||n)&&this.eventSvc.dispatchEvent({type:"recalculateRowBounds"}),n||s||i?(this.updateContainerHeights(),!0):!1}doNotUnVirtualiseRow(e){let n=e.rowNode,o=this.focusSvc.isRowFocused(n.rowIndex,n.rowPinned),r=this.editSvc?.isEditing(e),s=n.detail;return o||r||s?!!this.isRowPresent(n):!1}isRowPresent(e){return this.rowModel.isRowPresent(e)?this.beans.pagination?.isRowInPage(e.rowIndex)??!0:!1}createRowCon(e,t,i){let n=this.cachedRowCtrls?.getRow(e)??null;if(n)return n;let o=i&&!this.printLayout&&!!this.beans.animationFrameSvc?.active;return new jp(e,this.beans,t,o,this.printLayout)}getRenderedNodes(){let e=Object.values(this.rowCtrlsByRowIndex).map(n=>n.rowNode),t=this.getStickyTopRowCtrls().map(n=>n.rowNode),i=this.getStickyBottomRowCtrls().map(n=>n.rowNode);return[...t,...e,...i]}getRowByPosition(e){let t,{rowIndex:i}=e;switch(e.rowPinned){case"top":t=this.topRowCtrls[i];break;case"bottom":t=this.bottomRowCtrls[i];break;default:t=this.rowCtrlsByRowIndex[i],t||(t=this.getStickyTopRowCtrls().find(n=>n.rowNode.rowIndex===i)||null,t||(t=this.getStickyBottomRowCtrls().find(n=>n.rowNode.rowIndex===i)||null));break}return t}isRangeInRenderedViewport(e,t){if(e==null||t==null)return!1;let n=e>this.lastRenderedRow;return!(t<this.firstRenderedRow)&&!n}},wU=class{constructor(e){this.entriesMap={},this.entriesList=[],this.maxCount=e}addRow(e){if(this.entriesMap[e.rowNode.id]=e,this.entriesList.push(e),e.setCached(!0),this.entriesList.length>this.maxCount){let t=this.entriesList[0];t.destroyFirstPass(),t.destroySecondPass(),this.removeFromCache(t)}}getRow(e){if(e?.id==null)return null;let t=this.entriesMap[e.id];return t?(this.removeFromCache(t),t.setCached(!1),t.rowNode!=e?null:t):null}has(e){return this.entriesMap[e.id]!=null}removeRow(e){let t=e.id,i=this.entriesMap[t];delete this.entriesMap[t],Hn(this.entriesList,i)}removeFromCache(e){let t=e.rowNode.id;delete this.entriesMap[t],Hn(this.entriesList,e)}getEntries(){return this.entriesList}};function HC(e){if(!e)return;let t={top:{},bottom:{},normal:{}};for(let i of e){let n=i.id;switch(i.rowPinned){case"top":t.top[n]=i;break;case"bottom":t.bottom[n]=i;break;default:t.normal[n]=i;break}}return t}function VC(e,t){let i=e.id;switch(e.rowPinned){case"top":return t.top[i]!=null;case"bottom":return t.bottom[i]!=null;default:return t.normal[i]!=null}}var bU=class extends A{constructor(){super(...arguments),this.beanName="rowNodeSorter"}postConstruct(){let{gos:e}=this;this.isAccentedSort=e.get("accentedSort"),this.primaryColumnsSortGroups=go(e),this.addManagedPropertyListener("accentedSort",t=>this.isAccentedSort=t.currentValue),this.addManagedPropertyListener("autoGroupColumnDef",()=>this.primaryColumnsSortGroups=go(e))}doFullSort(e,t){let i=e.map((n,o)=>({currentPos:o,rowNode:n}));return i.sort(this.compareRowNodes.bind(this,t)),i.map(n=>n.rowNode)}compareRowNodes(e,t,i){let n=t.rowNode,o=i.rowNode;for(let r=0,s=e.length;r<s;r++){let a=e[r],l=a.sort==="desc",c=this.getValue(n,a.column),d=this.getValue(o,a.column),u,h=this.getComparator(a,n);if(h?u=h(c,d,n,o,l):u=C7(c,d,this.isAccentedSort),!isNaN(u)&&u!==0)return a.sort==="asc"?u:u*-1}return t.currentPos-i.currentPos}getComparator(e,t){let i=e.column,n=i.getColDef().comparator;if(n!=null)return n;if(!i.getColDef().showRowGroup)return;let o=!t.group&&i.getColDef().field;if(!o)return;let r=this.beans.colModel.getColDefCol(o);if(r)return r.getColDef().comparator}getValue(e,t){let{valueSvc:i,colModel:n,showRowGroupCols:o,gos:r}=this.beans;if(!this.primaryColumnsSortGroups)return i.getValue(t,e,!1);if(e.rowGroupColumn===t){if(DR(r,n.isPivotActive())){let c=e.data?e:CP(e.childrenAfterGroup);return c&&i.getValue(t,c,!1)}let l=o?.getShowRowGroupCol(t.getId());return l?e.groupData?.[l.getId()]:void 0}if(!(e.group&&t.getColDef().showRowGroup))return i.getValue(t,e,!1)}};function yU(e){e.sortSvc?.onSortChanged("api")}var yD={moduleName:"Sort",version:ee,beans:[Hz,bU],apiFunctions:{onSortChanged:yU},userComponents:{agSortIndicator:Rw},icons:{sortAscending:"asc",sortDescending:"desc",sortUnSort:"none"}},SU=class extends A{constructor(){super(...arguments),this.beanName="syncSvc",this.waitingForColumns=!1}postConstruct(){this.addManagedPropertyListener("columnDefs",e=>this.setColumnDefs(e))}start(){this.beans.ctrlsSvc.whenReady(this,()=>{let e=this.gos.get("columnDefs");e?this.setColumnsAndData(e):this.waitingForColumns=!0,this.gridReady()})}setColumnsAndData(e){let{colModel:t,rowModel:i}=this.beans;t.setColumnDefs(e??[],"gridInitializing"),i.start()}gridReady(){let{eventSvc:e,gos:t}=this;e.dispatchEvent({type:"gridReady"}),Qr(t,`initialised successfully, enterprise = ${t.isModuleRegistered("EnterpriseCore")}`)}setColumnDefs(e){let t=this.gos.get("columnDefs");if(t){if(this.waitingForColumns){this.waitingForColumns=!1,this.setColumnsAndData(t);return}this.beans.colModel.setColumnDefs(t,ml(e.source))}}};function xU(e){e.valueCache?.expire()}function EU(e,t){let{colKey:i,rowNode:n,useFormatter:o}=t,r=e.colModel.getColDefCol(i)??e.colModel.getCol(i);if(mt(r))return null;let s=e.valueSvc.getValueForDisplay(r,n,o);return o?s.valueFormatted??Dl(s.value):s.value}var _U="paste",RU=class extends A{constructor(){super(...arguments),this.beanName="changeDetectionSvc",this.clientSideRowModel=null}postConstruct(){let{gos:e,rowModel:t}=this.beans;Tt(e,t)&&(this.clientSideRowModel=t),this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this)})}onCellValueChanged(e){let{gos:t,rowRenderer:i}=this.beans;if(e.source===_U||t.get("suppressChangeDetection"))return;let n=e.node,o=[n],r=this.clientSideRowModel,s=r?.rootNode;if(s&&!n.isRowPinned()){let a=t.get("aggregateOnlyChangedColumns"),l=new Sd(a,s);l.addParentNode(n.parent,[e.column]),r.doAggregate(l),l.forEachChangedNodeDepthFirst(c=>{o.push(c),c.sibling&&o.push(c.sibling)})}i.refreshCells({rowNodes:o})}},PU=class extends A{constructor(){super(...arguments),this.beanName="expressionSvc",this.cache={}}evaluate(e,t){if(typeof e=="string")return this.evaluateExpression(e,t);tt(15,{expression:e})}evaluateExpression(e,t){try{return this.createExpressionFunction(e)(t.value,t.context,t.oldValue,t.newValue,t.value,t.node,t.data,t.colDef,t.rowIndex,t.api,t.getValue,t.column,t.columnGroup)}catch(i){return tt(16,{expression:e,params:t,e:i}),null}}createExpressionFunction(e){let t=this.cache;if(t[e])return t[e];let i=this.createFunctionBody(e),n=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, getValue, column, columnGroup",i);return t[e]=n,n}createFunctionBody(e){return e.includes("return")?e:"return "+e+";"}},DU=class extends A{constructor(){super(...arguments),this.beanName="valueCache",this.cacheVersion=0}postConstruct(){let e=this.gos;this.active=e.get("valueCache"),this.neverExpires=e.get("valueCacheNeverExpires")}onDataChanged(){this.neverExpires||this.expire()}expire(){this.cacheVersion++}setValue(e,t,i){if(this.active){let n=this.cacheVersion;e.__cacheVersion!==n&&(e.__cacheVersion=n,e.__cacheData={}),e.__cacheData[t]=i}}getValue(e,t){if(!(!this.active||e.__cacheVersion!==this.cacheVersion))return e.__cacheData[t]}},MU={moduleName:"ValueCache",version:ee,beans:[DU],apiFunctions:{expireValueCache:xU}},kU={moduleName:"Expression",version:ee,beans:[PU]},TU={moduleName:"ChangeDetection",version:ee,beans:[RU]},FU={moduleName:"CellApi",version:ee,apiFunctions:{getCellValue:EU}},IU=class extends A{constructor(){super(...arguments),this.beanName="valueSvc",this.hasEditSvc=!1,this.initialised=!1,this.isSsrm=!1}wireBeans(e){this.expressionSvc=e.expressionSvc,this.colModel=e.colModel,this.valueCache=e.valueCache,this.dataTypeSvc=e.dataTypeSvc,this.editSvc=e.editSvc,this.hasEditSvc=!!e.editSvc}postConstruct(){this.initialised||this.init()}init(){this.executeValueGetter=this.valueCache?this.executeValueGetterWithValueCache.bind(this):this.executeValueGetterWithoutValueCache.bind(this),this.isSsrm=Ml(this.gos),this.cellExpressions=this.gos.get("enableCellExpressions"),this.isTreeData=this.gos.get("treeData"),this.initialised=!0;let e=t=>this.callColumnCellValueChangedHandler(t);this.eventSvc.addListener("cellValueChanged",e,!0),this.addDestroyFunc(()=>this.eventSvc.removeListener("cellValueChanged",e,!0)),this.addManagedPropertyListener("treeData",t=>this.isTreeData=t.currentValue)}getValueForDisplay(e,t,i=!1,n=!1,o="ui"){let{showRowGroupColValueSvc:r}=this.beans,s=!e&&t.group,a=e?.colDef.showRowGroup,l=!this.isTreeData||t.footer;if(r&&l&&(s||a)){let f=r.getGroupValue(t,e);if(f==null)return{value:null,valueFormatted:null};if(!i)return{value:f.value,valueFormatted:null};let m=r.formatAndPrefixGroupColValue(f,e,n);return{value:f.value,valueFormatted:m}}if(!e)return{value:t.key,valueFormatted:null};let c=t.leafGroup&&this.colModel.isPivotMode(),d=t.group&&t.expanded&&!t.footer&&!c,u=this.gos.get("groupSuppressBlankHeader")||!t.sibling,h=d&&!u,p=this.getValue(e,t,h,o),g=i&&!(n&&e.colDef.useValueFormatterForExport===!1);return{value:p,valueFormatted:g?this.formatValue(e,t,p):null}}getValue(e,t,i=!1,n="ui"){if(this.initialised||this.init(),!t)return;let o=e.getColDef(),r=o.field,s=e.getColId(),a=t.data;if(this.hasEditSvc&&n==="ui"){let f=this.editSvc;if(f.isEditing()){let m=f.getCellDataValue({rowNode:t,column:e},!0);if(m!==void 0)return m}}let l,c=o.showRowGroup;if(typeof c=="string"&&(this.beans.rowGroupColsSvc?.getColumnIndex(c)??-1)>t.level)return null;let d=typeof c!="string"||!t.group,u=t.groupData&&s in t.groupData,h=!i&&t.aggData&&t.aggData[s]!==void 0,p=this.isSsrm&&i&&!!o.aggFunc,g=this.isSsrm&&t.footer&&t.field&&(o.showRowGroup===!0||o.showRowGroup===t.field);if(this.isTreeData&&h)l=t.aggData[s];else if(this.isTreeData&&o.valueGetter)l=this.executeValueGetter(o.valueGetter,a,e,t);else if(this.isTreeData&&r&&a)l=cd(a,r,e.isFieldContainsDots());else if(u)l=t.groupData[s];else if(h)l=t.aggData[s];else if(o.valueGetter&&!p){if(!d)return l;l=this.executeValueGetter(o.valueGetter,a,e,t)}else if(g)l=cd(a,t.field,e.isFieldContainsDots());else if(r&&a&&!p){if(!d)return l;l=cd(a,r,e.isFieldContainsDots())}if(this.cellExpressions&&typeof l=="string"&&l.indexOf("=")===0){let f=l.substring(1);l=this.executeValueGetter(f,a,e,t)}return l}parseValue(e,t,i,n){let o=e.getColDef(),r=o.valueParser;if(ie(r)){let s=ye(this.gos,{node:t,data:t?.data,oldValue:n,newValue:i,colDef:o,column:e});return typeof r=="function"?r(s):this.expressionSvc?.evaluate(r,s)}return i}getDeleteValue(e,t){return ie(e.getColDef().valueParser)?this.parseValue(e,t,"",this.getValueForDisplay(e,t).value)??null:null}formatValue(e,t,i,n,o=!0){let{expressionSvc:r}=this.beans,s=null,a,l=e.getColDef();if(n?a=n:o&&(a=l.valueFormatter),a){let c=t?t.data:null,d=ye(this.gos,{value:i,node:t,data:c,colDef:l,column:e});typeof a=="function"?s=a(d):s=r?r.evaluate(a,d):null}else if(l.refData)return l.refData[i]||"";return s==null&&Array.isArray(i)&&(s=i.join(", ")),s}setValue(e,t,i,n){let o=this.colModel.getColDefCol(t);if(!e||!o)return!1;mt(e.data)&&(e.data={});let{field:r,valueSetter:s}=o.getColDef();if(mt(r)&&mt(s))return W(17),!1;if(this.dataTypeSvc&&!this.dataTypeSvc.checkType(o,i))return W(135),!1;let a=ye(this.gos,{node:e,data:e.data,oldValue:this.getValue(o,e,void 0,n),newValue:i,colDef:o.getColDef(),column:o});a.newValue=i;let l;if(ie(s)?typeof s=="function"?l=s(a):l=this.expressionSvc?.evaluate(s,a):l=this.setValueUsingField(e.data,r,i,o.isFieldContainsDots()),l===void 0&&(l=!0),!l)return!1;e.resetQuickFilterAggregateText(),this.valueCache?.onDataChanged();let c=this.getValue(o,e);return this.dispatchCellValueChangedEvent(e,a,c,n),e.pinnedSibling&&this.dispatchCellValueChangedEvent(e.pinnedSibling,a,c,n),!0}dispatchCellValueChangedEvent(e,t,i,n){this.eventSvc.dispatchEvent({type:"cellValueChanged",event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:t.column,colDef:t.colDef,data:e.data,node:e,oldValue:t.oldValue,newValue:i,value:i,source:n})}callColumnCellValueChangedHandler(e){let t=e.colDef.onCellValueChanged;typeof t=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>{t({node:e.node,data:e.data,oldValue:e.oldValue,newValue:e.newValue,colDef:e.colDef,column:e.column,api:e.api,context:e.context})})}setValueUsingField(e,t,i,n){if(!t)return!1;let o=!1;if(!n)o=e[t]===i,o||(e[t]=i);else{let r=t.split("."),s=e;for(;r.length>0&&s;){let a=r.shift();r.length===0?(o=s[a]===i,o||(s[a]=i)):s=s[a]}}return!o}executeValueGetterWithValueCache(e,t,i,n){let o=i.getColId(),r=this.valueCache.getValue(n,o);if(r!==void 0)return r;let s=this.executeValueGetterWithoutValueCache(e,t,i,n);return this.valueCache.setValue(n,o,s),s}executeValueGetterWithoutValueCache(e,t,i,n){let o=ye(this.gos,{data:t,node:n,column:i,colDef:i.getColDef(),getValue:this.getValueCallback.bind(this,n)}),r;return typeof e=="function"?r=e(o):r=this.expressionSvc?.evaluate(e,o),r}getValueCallback(e,t){let i=this.colModel.getColDefCol(t);return i?this.getValue(i,e):null}getKeyForNode(e,t){let i=this.getValue(e,t),n=e.getColDef().keyCreator,o=i;if(n){let r=ye(this.gos,{value:i,colDef:e.getColDef(),column:e,node:t,data:t.data});o=n(r)}return typeof o=="string"||o==null||(o=String(o),o==="[object Object]"&&W(121)),o}},AU={moduleName:"CommunityCore",version:ee,beans:[Lz,DH,GG,cO,mU,ZV,Mz,oW,rO,QW,JW,CU,IU,Iz,Dz,Az,WG,SU,OG,NG,fW],icons:{selectOpen:"small-down",smallDown:"small-down",colorPicker:"color-picker",smallUp:"small-up",checkboxChecked:"small-up",checkboxIndeterminate:"checkbox-indeterminate",checkboxUnchecked:"checkbox-unchecked",radioButtonOn:"radio-button-on",radioButtonOff:"radio-button-off",smallLeft:"small-left",smallRight:"small-right"},apiFunctions:{getGridId:MH,destroy:kH,isDestroyed:TH,getGridOption:FH,setGridOption:IH,updateGridOptions:WP,isModuleRegistered:AH},dependsOn:[IG,TV,BV,yD,uW,tG,hW,fU,TU,gW,XW,iU,oU,vW,VG,AG,kU,rG,aU]},SD={AdvancedFilter:1,AiToolkit:1,AllEnterprise:1,BatchEdit:1,CellSelection:1,Clipboard:1,ColumnMenu:1,ColumnsToolPanel:1,ContextMenu:1,ExcelExport:1,FiltersToolPanel:1,Find:1,GridCharts:1,IntegratedCharts:1,GroupFilter:1,MasterDetail:1,Menu:1,MultiFilter:1,NewFiltersToolPanel:1,Pivot:1,RangeSelection:1,RichSelect:1,RowNumbers:1,RowGrouping:1,RowGroupingPanel:1,ServerSideRowModelApi:1,ServerSideRowModel:1,SetFilter:1,SideBar:1,Sparklines:1,StatusBar:1,TreeData:1,ViewportRowModel:1},rC=["TextFilter","NumberFilter","DateFilter","SetFilter","MultiFilter","GroupFilter","CustomFilter"],LU={EditCore:["TextEditor","NumberEditor","DateEditor","CheckboxEditor","LargeTextEditor","SelectEditor","RichSelect","CustomEditor"],CheckboxCellRenderer:["AllCommunity"],ClientSideRowModelHierarchy:["RowGrouping","Pivot","TreeData"],ColumnFilter:rC,ColumnGroupHeaderComp:["AllCommunity"],ColumnGroup:["AllCommunity"],ColumnHeaderComp:["AllCommunity"],ColumnMove:["AllCommunity"],ColumnResize:["AllCommunity"],CommunityCore:["AllCommunity"],CsrmSsrmSharedApi:["ClientSideRowModelApi","ServerSideRowModelApi"],RowModelSharedApi:["ClientSideRowModelApi","ServerSideRowModelApi"],EnterpriseCore:["AllEnterprise"],FilterCore:[...rC,"QuickFilter","ExternalFilter","AdvancedFilter"],GroupCellRenderer:["RowGrouping","Pivot","TreeData","MasterDetail","ServerSideRowModel"],KeyboardNavigation:["AllCommunity"],LoadingCellRenderer:["ServerSideRowModel"],MenuCore:["ColumnMenu","ContextMenu"],MenuItem:["ColumnMenu","ContextMenu","MultiFilter","IntegratedCharts","ColumnsToolPanel"],Overlay:["AllCommunity"],PinnedColumn:["AllCommunity"],SharedAggregation:["RowGrouping","Pivot","TreeData","ServerSideRowModel"],SharedDragAndDrop:["AllCommunity"],SharedMasterDetail:["MasterDetail","ServerSideRowModel"],SharedMenu:[...rC,"ColumnMenu","ContextMenu"],SharedPivot:["Pivot","ServerSideRowModel"],SharedRowGrouping:["RowGrouping","ServerSideRowModel"],SharedRowSelection:["RowSelection","ServerSideRowModel"],SkeletonCellRenderer:["ServerSideRowModel"],Sort:["AllCommunity"],SsrmInfiniteSharedApi:["InfiniteRowModel","ServerSideRowModelApi"],SharedTreeData:["TreeData","ServerSideRowModel"]},OU={InfiniteRowModel:"infinite",ClientSideRowModelApi:"clientSide",ClientSideRowModel:"clientSide",ServerSideRowModelApi:"serverSide",ServerSideRowModel:"serverSide",ViewportRowModel:"viewport"};function NU(e,t){let i=[];for(let n of Array.isArray(e)?e:[e]){let o=LU[n];if(o)for(let r of o){let s=OU[r];(!s||s===t)&&i.push(r)}else i.push(n)}return i}var xD=()=>`No AG Grid modules are registered! It is recommended to start with all Community features via the AllCommunityModule:
                    
    import { ModuleRegistry, AllCommunityModule } from 'ag-grid-community';
    
    ModuleRegistry.registerModules([ AllCommunityModule ]);
    `,BU=e=>{let t=e.map(n=>`import { ${dd(n)} } from '${SD[n]?"ag-grid-enterprise":"ag-grid-community"}';`);return e.some(n=>n==="IntegratedCharts"||n==="Sparklines")&&t.push("import { AgChartsEnterpriseModule } from 'ag-charts-enterprise';"),`import { ModuleRegistry } from 'ag-grid-community'; 
${t.join(` 
`)} 

ModuleRegistry.registerModules([ ${e.map(n=>dd(n,!0)).join(", ")} ]); 

For more info see: ${pl}/modules/`};function dd(e,t=!1){return t&&(e==="IntegratedCharts"||e==="Sparklines")?`${e}Module.with(AgChartsEnterpriseModule)`:`${e}Module`}function HU(e,t){let i=t.filter(r=>r==="IntegratedCharts"||r==="Sparklines"),n="";return!globalThis?.agCharts&&i.length>0?n=`Unable to use ${e} as either the ag-charts-community or ag-charts-enterprise script needs to be included alongside ag-grid-enterprise.
`:t.some(r=>SD[r])&&(n=n+`Unable to use ${e} as that requires the ag-grid-enterprise script to be included.
`),n}function ED({moduleName:e,rowModelType:t}){return`To use the ${e}Module you must set the gridOption "rowModelType='${t}'"`}var A_=({reasonOrId:e,moduleName:t,gridScoped:i,gridId:n,rowModelType:o,additionalText:r,isUmd:s})=>{let a=NU(t,o),l=typeof e=="string"?e:WU[e];if(s)return HU(l,a);let c=a.filter(h=>h==="IntegratedCharts"||h==="Sparklines"),d=c.length>0?`${c.map(h=>dd(h)).join()} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.`:"";return`${`Unable to use ${l} as ${a.length>1?"one of "+a.map(h=>dd(h)).join(", "):dd(a[0])} is not registered${i?" for gridId: "+n:""}. ${d} Check if you have registered the module:
`}
${BU(a)}`+(r?` 

${r}`:"")},L_=e=>`${e} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.

import { AgChartsEnterpriseModule } from 'ag-charts-enterprise';
import { ModuleRegistry } from 'ag-grid-community';
import { ${e} } from 'ag-grid-enterprise';
    
ModuleRegistry.registerModules([${e}.with(AgChartsEnterpriseModule)]);
    `,VU=e=>`AG Grid: Unable to use the Clipboard API (navigator.clipboard.${e}()). The reason why it could not be used has been logged in the previous line. For this reason the grid has defaulted to using a workaround which doesn't perform as well. Either fix why Clipboard API is blocked, OR stop this message from appearing by setting grid property suppressClipboardApi=true (which will default the grid to using the workaround rather than the API.`,GU={1:()=>"`rowData` must be an array",2:({nodeId:e})=>`Duplicate node id '${e}' detected from getRowId callback, this could cause issues in your grid.`,3:()=>"Calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.",4:({id:e})=>`Could not find row id=${e}, data item was not found for this id`,5:({data:e})=>["Could not find data item as object was not found.",e," Consider using getRowId to help the Grid find matching row data"],6:()=>"'groupHideOpenParents' only works when specifying specific columns for 'colDef.showRowGroup'",7:()=>"Pivoting is not supported with aligned grids as it may produce different columns in each grid.",8:({key:e})=>`Unknown key for navigation ${e}`,9:({variable:e})=>`No value for ${e?.cssName}. This usually means that the grid has been initialised before styles have been loaded. The default value of ${e?.defaultValue} will be used and updated when styles load.`,10:({eventType:e})=>`As of v33, the '${e}' event is deprecated. Use the global 'modelUpdated' event to determine when row children have changed.`,11:()=>"No gridOptions provided to createGrid",12:({colKey:e})=>["column ",e," not found"],13:()=>"Could not find rowIndex, this means tasks are being executed on a rowNode that has been removed from the grid.",14:({groupPrefix:e})=>`Row IDs cannot start with ${e}, this is a reserved prefix for AG Grid's row grouping feature.`,15:({expression:e})=>["value should be either a string or a function",e],16:({expression:e,params:t,e:i})=>["Processing of the expression failed","Expression = ",e,"Params = ",t,"Exception = ",i],17:()=>"you need either field or valueSetter set on colDef for editing to work",18:()=>"alignedGrids contains an undefined option.",19:()=>"alignedGrids - No api found on the linked grid.",20:()=>`You may want to configure via a callback to avoid setup race conditions:
                     "alignedGrids: () => [linkedGrid]"`,21:()=>"pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.",22:({key:e})=>`${e} is an initial property and cannot be updated.`,23:()=>"The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead.",24:()=>"row height must be a number if not using standard row model",25:({id:e})=>["The getRowId callback must return a string. The ID ",e," is being cast to a string."],26:({fnName:e,preDestroyLink:t})=>`Grid API function ${e}() cannot be called as the grid has been destroyed.
 Either clear local references to the grid api, when it is destroyed, or check gridApi.isDestroyed() to avoid calling methods against a destroyed grid.
 To run logic when the grid is about to be destroyed use the gridPreDestroy event. See: ${t}`,27:({fnName:e,module:t})=>`API function '${e}' not registered to module '${t}'`,28:()=>"setRowCount cannot be used while using row grouping.",29:()=>"tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?",30:({toIndex:e})=>["tried to insert columns in invalid location, toIndex = ",e,"remember that you should not count the moving columns when calculating the new index"],31:()=>"infinite loop in resizeColumnSets",32:()=>"applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state.",33:()=>"stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON.",34:({key:e})=>`the column type '${e}' is a default column type and cannot be overridden.`,35:()=>"Column type definitions 'columnTypes' with a 'type' attribute are not supported because a column type cannot refer to another column type. Only column definitions 'columnDefs' can use the 'type' attribute to refer to a column type.",36:({t:e})=>"colDef.type '"+e+"' does not correspond to defined gridOptions.columnTypes",37:()=>"Changing the column pinning status is not allowed with domLayout='print'",38:({iconName:e})=>`provided icon '${e}' needs to be a string or a function`,39:()=>"Applying column order broke a group where columns should be married together. Applying new order has been discarded.",40:({e,method:t})=>`${e}
${VU(t)}`,41:()=>"Browser did not allow document.execCommand('copy'). Ensure 'api.copySelectedRowsToClipboard() is invoked via a user event, i.e. button click, otherwise the browser will prevent it for security reasons.",42:()=>"Browser does not support document.execCommand('copy') for clipboard operations",43:({iconName:e})=>`As of v33, icon '${e}' is deprecated. Use the icon CSS name instead.`,44:()=>'Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.',45:({parentCellDataType:e})=>`The data type definition ${e} does not exist.`,46:()=>'The "baseDataType" property of a data type definition must match that of its parent.',47:({cellDataType:e})=>`Missing data type definition - "${e}"`,48:({property:e})=>`Cell data type is "object" but no Value ${e} has been provided. Please either provide an object data type definition with a Value ${e}, or set "colDef.value${e}"`,49:({methodName:e})=>`Framework component is missing the method ${e}()`,50:({compName:e})=>`Could not find component ${e}, did you forget to configure this component?`,51:()=>"Export cancelled. Export is not allowed as per your configuration.",52:()=>"There is no `window` associated with the current `document`",53:()=>"unknown value type during csv conversion",54:()=>"Could not find document body, it is needed for drag and drop and context menu.",55:()=>"addRowDropZone - A container target needs to be provided",56:()=>"addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.",57:()=>"unable to show popup filter, filter instantiation failed",58:()=>"no values found for select cellEditor",59:()=>"cannot select pinned rows",60:()=>"cannot select node until it has finished loading",61:()=>"since version v32.2.0, rowNode.isFullWidthCell() has been deprecated. Instead check `rowNode.detail` followed by the user provided `isFullWidthRow` grid option.",62:({colId:e})=>`setFilterModel() - no column found for colId: ${e}`,63:({colId:e})=>`setFilterModel() - unable to fully apply model, filtering disabled for colId: ${e}`,64:({colId:e})=>`setFilterModel() - unable to fully apply model, unable to create filter for colId: ${e}`,65:()=>"filter missing setModel method, which is needed for setFilterModel",66:()=>"filter API missing getModel method, which is needed for getFilterModel",67:()=>"Filter is missing isFilterActive() method",68:()=>"Column Filter API methods have been disabled as Advanced Filters are enabled.",69:({guiFromFilter:e})=>`getGui method from filter returned ${e}; it should be a DOM element.`,70:({newFilter:e})=>`Grid option quickFilterText only supports string inputs, received: ${typeof e}`,71:()=>"debounceMs is ignored when apply button is present",72:({keys:e})=>["ignoring FilterOptionDef as it doesn't contain one of ",e],73:()=>"invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'",74:()=>"no filter options for filter",75:()=>"Unknown button type specified",76:({filterModelType:e})=>['Unexpected type of filter "',e,'", it looks like the filter was configured with incorrect Filter Options'],77:()=>"Filter model is missing 'conditions'",78:()=>'Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.',79:()=>'"filterParams.maxNumConditions" must be greater than or equal to zero.',80:()=>'"filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.',81:()=>'"filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".',82:({param:e})=>`DateFilter ${e} is not a number`,83:()=>"DateFilter minValidYear should be <= maxValidYear",84:()=>"DateFilter minValidDate should be <= maxValidDate",85:()=>"DateFilter should not have both minValidDate and minValidYear parameters set at the same time! minValidYear will be ignored.",86:()=>"DateFilter should not have both maxValidDate and maxValidYear parameters set at the same time! maxValidYear will be ignored.",87:()=>"DateFilter parameter minValidDate should always be lower than or equal to parameter maxValidDate.",88:({index:e})=>`Invalid row index for ensureIndexVisible: ${e}`,89:()=>"A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)",90:()=>"datasource is missing getRows method",91:()=>"Filter is missing method doesFilterPass",92:()=>"AnimationFrameService called but animation frames are off",93:()=>"cannot add multiple ranges when `cellSelection.suppressMultiRanges = true`",94:({paginationPageSizeOption:e,pageSizeSet:t,pageSizesSet:i,pageSizeOptions:n})=>`'paginationPageSize=${e}'${t?"":" (default value)"}, but ${e} is not included in${i?"":" the default"} paginationPageSizeSelector=[${n?.join(", ")}].`,95:({paginationPageSizeOption:e,paginationPageSizeSelector:t})=>`Either set '${t}' to an array that includes ${e} or to 'false' to disable the page size selector.`,96:({id:e,data:t})=>["Duplicate ID",e,"found for pinned row with data",t,"When `getRowId` is defined, it must return unique IDs for all pinned rows. Use the `rowPinned` parameter."],97:({colId:e})=>`cellEditor for column ${e} is missing getGui() method`,98:()=>"popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.",99:()=>"Since v32, `api.hideOverlay()` does not hide the loading overlay when `loading=true`. Set `loading=false` instead.",101:({propertyName:e,componentName:t,agGridDefaults:i,jsComps:n})=>{let o=[],r=[...Object.keys(i??[]).filter(a=>!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(a)),...Object.keys(n??[]).filter(a=>!!n[a])],s=xC({inputValue:t,allSuggestions:r,hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;return o.push(`Could not find '${t}' component. It was configured as "${e}: '${t}'" but it wasn't found in the list of registered components.
`),s.length>0&&o.push(`         Did you mean: [${s.slice(0,3)}]?
`),o.push("If using a custom component check it has been registered correctly."),o},102:()=>"selectAll: 'filtered' only works when gridOptions.rowModelType='clientSide'",103:()=>"Invalid selection state. When using client-side row model, the state must conform to `string[]`.",104:({value:e,param:t})=>`Numeric value ${e} passed to ${t} param will be interpreted as ${e} seconds. If this is intentional use "${e}s" to silence this warning.`,105:({e})=>["chart rendering failed",e],106:()=>`Theming API and Legacy Themes are both used in the same page. A Theming API theme has been provided to the 'theme' grid option, but the file (ag-grid.css) is also included and will cause styling issues. Remove ag-grid.css from the page. See the migration guide: ${pl}/theming-migration/`,107:({key:e,value:t})=>`Invalid value for theme param ${e} - ${t}`,108:({e})=>["chart update failed",e],109:({inputValue:e,allSuggestions:t})=>{let i=xC({inputValue:e,allSuggestions:t,hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;return[`Could not find '${e}' aggregate function. It was configured as "aggFunc: '${e}'" but it wasn't found in the list of registered aggregations.`,i.length>0?`         Did you mean: [${i.slice(0,3)}]?`:"","If using a custom aggregation function check it has been registered correctly."].join(`
`)},110:()=>"groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup",111:()=>"Invalid selection state. When `groupSelects` is enabled, the state must conform to `IServerSideGroupSelectionState`.",113:()=>"Set Filter cannot initialise because you are using a row model that does not contain all rows in the browser. Either use a different filter type, or configure Set Filter such that you provide it with values",114:({component:e})=>`Could not find component with name of ${e}. Is it in Vue.components?`,116:()=>"Invalid selection state. The state must conform to `IServerSideSelectionState`.",117:()=>"selectAll must be of boolean type.",118:()=>"Infinite scrolling must be enabled in order to set the row count.",119:()=>"Unable to instantiate filter",120:()=>"MultiFloatingFilterComp expects MultiFilter as its parent",121:()=>"a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (see AG Grid docs) or b) to toString() on the object to return a key",122:()=>"could not find the document, document is empty",123:()=>"Advanced Filter is only supported with the Client-Side Row Model or Server-Side Row Model.",124:()=>"No active charts to update.",125:({chartId:e})=>`Unable to update chart. No active chart found with ID: ${e}.`,126:()=>"unable to restore chart as no chart model is provided",127:({allRange:e})=>`unable to create chart as ${e?"there are no columns in the grid":"no range is selected"}.`,128:({feature:e})=>`${e} is only available if using 'multiRow' selection mode.`,129:({feature:e,rowModel:t})=>`${e} is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ${t}.`,130:()=>'cannot multi select unless selection mode is "multiRow"',132:()=>"Row selection features are not available unless `rowSelection` is enabled.",133:({iconName:e})=>`icon '${e}' function should return back a string or a dom object`,134:({iconName:e})=>`Did not find icon '${e}'`,135:()=>"Data type of the new value does not match the cell data type of the column",136:()=>"Unable to update chart as the 'type' is missing. It must be either 'rangeChartUpdate', 'pivotChartUpdate', or 'crossFilterChartUpdate'.",137:({type:e,currentChartType:t})=>`Unable to update chart as a '${e}' update type is not permitted on a ${t}.`,138:({chartType:e})=>`invalid chart type supplied: ${e}`,139:({customThemeName:e})=>`a custom chart theme with the name ${e} has been supplied but not added to the 'chartThemes' list`,140:({name:e})=>`no stock theme exists with the name '${e}' and no custom chart theme with that name was supplied to 'customChartThemes'`,141:()=>"cross filtering with row grouping is not supported.",142:()=>"cross filtering is only supported in the client side row model.",143:({panel:e})=>`'${e}' is not a valid Chart Tool Panel name`,144:({type:e})=>`Invalid charts data panel group name supplied: '${e}'`,145:({group:e})=>`As of v32, only one charts customize panel group can be expanded at a time. '${e}' will not be expanded.`,146:({comp:e})=>`Unable to instantiate component '${e}' as its module hasn't been loaded. Add 'ValidationModule' to see which module is required.`,147:({group:e})=>`Invalid charts customize panel group name supplied: '${e}'`,148:({group:e})=>`invalid chartGroupsDef config '${e}'`,149:({group:e,chartType:t})=>`invalid chartGroupsDef config '${e}.${t}'`,150:()=>"'seriesChartTypes' are required when the 'customCombo' chart type is specified.",151:({chartType:e})=>`invalid chartType '${e}' supplied in 'seriesChartTypes', converting to 'line' instead.`,152:({colId:e})=>`no 'seriesChartType' found for colId = '${e}', defaulting to 'line'.`,153:({chartDataType:e})=>`unexpected chartDataType value '${e}' supplied, instead use 'category', 'series' or 'excluded'`,154:({colId:e})=>`cross filtering requires a 'agSetColumnFilter' or 'agMultiColumnFilter' to be defined on the column with id: ${e}`,155:({option:e})=>`'${e}' is not a valid Chart Toolbar Option`,156:({panel:e})=>`Invalid panel in chartToolPanelsDef.panels: '${e}'`,157:({unrecognisedGroupIds:e})=>["unable to find group(s) for supplied groupIds:",e],158:()=>"can not expand a column item that does not represent a column group header",159:()=>"Invalid params supplied to createExcelFileForExcel() - `ExcelExportParams.data` is empty.",160:()=>"Export cancelled. Export is not allowed as per your configuration.",161:()=>"The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'",162:({id:e,dataType:t})=>`Unrecognized data type for excel export [${e}.dataType=${t}]`,163:({featureName:e})=>`Excel table export does not work with ${e}. The exported Excel file will not contain any Excel tables.
 Please turn off ${e} to enable Excel table exports.`,164:()=>"Unable to add data table to Excel sheet: A table already exists.",165:()=>"Unable to add data table to Excel sheet: Missing required parameters.",166:({unrecognisedGroupIds:e})=>["unable to find groups for these supplied groupIds:",e],167:({unrecognisedColIds:e})=>["unable to find columns for these supplied colIds:",e],168:()=>"detailCellRendererParams.template should be function or string",169:()=>'Reference to eDetailGrid was missing from the details template. Please add data-ref="eDetailGrid" to the template.',170:({providedStrategy:e})=>`invalid cellRendererParams.refreshStrategy = ${e} supplied, defaulting to refreshStrategy = 'rows'.`,171:()=>"could not find detail grid options for master detail, please set gridOptions.detailCellRendererParams.detailGridOptions",172:()=>"could not find getDetailRowData for master / detail, please set gridOptions.detailCellRendererParams.getDetailRowData",173:({group:e})=>`invalid chartGroupsDef config '${e}'`,174:({group:e,chartType:t})=>`invalid chartGroupsDef config '${e}.${t}'`,175:({menuTabName:e,itemsToConsider:t})=>[`Trying to render an invalid menu item '${e}'. Check that your 'menuTabs' contains one of `,t],176:({key:e})=>`unknown menu item type ${e}`,177:()=>"valid values for cellSelection.handle.direction are 'x', 'y' and 'xy'. Default to 'xy'.",178:({colId:e})=>`column ${e} is not visible`,179:()=>"totalValueGetter should be either a function or a string (expression)",180:()=>"agRichSelectCellEditor requires cellEditorParams.values to be set",181:()=>"agRichSelectCellEditor cannot have `multiSelect` and `allowTyping` set to `true`. AllowTyping has been turned off.",182:()=>'you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data',183:()=>"Group Column Filter only works on group columns. Please use a different filter.",184:({parentGroupData:e,childNodeData:t})=>["duplicate group keys for row data, keys should be unique",[e,t]],185:({data:e})=>["getDataPath() should not return an empty path",[e]],186:({rowId:e,rowData:t,duplicateRowsData:i})=>["duplicate group keys for row data, keys should be unique",e,t,...i??[]],187:({rowId:e,firstData:t,secondData:i})=>[`Duplicate node id ${e}. Row IDs are provided via the getRowId() callback. Please modify the getRowId() callback code to provide unique row id values.`,"first instance",t,"second instance",i],188:e=>`getRowId callback must be provided for Server Side Row Model ${e?.feature||"selection"} to work correctly.`,189:({startRow:e})=>`invalid value ${e} for startRow, the value should be >= 0`,190:({rowGroupId:e,data:t})=>["null and undefined values are not allowed for server side row model keys",e?`column = ${e}`:"","data is ",t],194:({method:e})=>`calling gridApi.${e}() is only possible when using rowModelType=\`clientSide\`.`,195:({justCurrentPage:e})=>`selecting just ${e?"current page":"filtered"} only works when gridOptions.rowModelType='clientSide'`,196:({key:e})=>`Provided ids must be of string type. Invalid id provided: ${e}`,197:()=>"`toggledNodes` must be an array of string ids.",199:()=>"getSelectedNodes and getSelectedRows functions cannot be used with select all functionality with the server-side row model. Use `api.getServerSideSelectionState()` instead.",200:A_,201:({rowModelType:e})=>`Could not find row model for rowModelType = ${e}`,202:()=>"`getSelectedNodes` and `getSelectedRows` functions cannot be used with `groupSelectsChildren` and the server-side row model. Use `api.getServerSideSelectionState()` instead.",203:()=>"Server Side Row Model does not support Dynamic Row Height and Cache Purging. Either a) remove getRowHeight() callback or b) remove maxBlocksInCache property. Purging has been disabled.",204:()=>"Server Side Row Model does not support Auto Row Height and Cache Purging. Either a) remove colDef.autoHeight or b) remove maxBlocksInCache property. Purging has been disabled.",205:({duplicateIdText:e})=>`Unable to display rows as duplicate row ids (${e}) were returned by the getRowId callback. Please modify the getRowId callback to provide unique ids.`,206:()=>"getRowId callback must be implemented for transactions to work. Transaction was ignored.",207:()=>'The Set Filter Parameter "defaultToNothingSelected" value was ignored because it does not work when "excelMode" is used.',208:()=>"Set Filter Value Formatter must return string values. Please ensure the Set Filter Value Formatter returns string values for complex objects.",209:()=>`Set Filter Key Creator is returning null for provided values and provided values are primitives. Please provide complex objects. See ${pl}/filter-set-filter-list/#filter-value-types`,210:()=>"Set Filter has a Key Creator, but provided values are primitives. Did you mean to provide complex objects?",211:()=>"property treeList=true for Set Filter params, but you did not provide a treeListPathGetter or values of type Date.",212:()=>"please review all your toolPanel components, it seems like at least one of them doesn't have an id",213:()=>"Advanced Filter does not work with Filters Tool Panel. Filters Tool Panel has been disabled.",214:({key:e})=>`unable to lookup Tool Panel as invalid key supplied: ${e}`,215:({key:e,defaultByKey:t})=>`the key ${e} is not a valid key for specifying a tool panel, valid keys are: ${Object.keys(t??{}).join(",")}`,216:({name:e})=>`Missing component for '${e}'`,217:({invalidColIds:e})=>["unable to find grid columns for the supplied colDef(s):",e],218:({property:e,defaultOffset:t})=>`${e} must be a number, the value you provided is not a valid number. Using the default of ${t}px.`,219:({property:e})=>`Property ${e} does not exist on the target object.`,220:({lineDash:e})=>`'${e}' is not a valid 'lineDash' option.`,221:()=>"agAggregationComponent should only be used with the client and server side row model.",222:()=>"agFilteredRowCountComponent should only be used with the client side row model.",223:()=>"agSelectedRowCountComponent should only be used with the client and server side row model.",224:()=>"agTotalAndFilteredRowCountComponent should only be used with the client side row model.",225:()=>"agTotalRowCountComponent should only be used with the client side row model.",226:()=>"viewport is missing init method.",227:()=>"menu item icon must be DOM node or string",228:({menuItemOrString:e})=>`unrecognised menu item ${e}`,229:({index:e})=>["invalid row index for ensureIndexVisible: ",e],230:()=>"detailCellRendererParams.template is not supported by AG Grid React. To change the template, provide a Custom Detail Cell Renderer. See https://www.ag-grid.com/react-data-grid/master-detail-custom-detail/",231:()=>"As of v32, using custom components with `reactiveCustomComponents = false` is deprecated.",232:()=>"Using both rowData and v-model. rowData will be ignored.",233:({methodName:e})=>`Framework component is missing the method ${e}()`,234:()=>'Group Column Filter does not work with the colDef property "field". This property will be ignored.',235:()=>'Group Column Filter does not work with the colDef property "filterValueGetter". This property will be ignored.',236:()=>'Group Column Filter does not work with the colDef property "filterParams". This property will be ignored.',237:()=>"Group Column Filter does not work with Tree Data enabled. Please disable Tree Data, or use a different filter.",238:()=>"setRowCount can only accept a positive row count.",239:()=>'Theming API and CSS File Themes are both used in the same page. In v33 we released the Theming API as the new default method of styling the grid. See the migration docs https://www.ag-grid.com/react-data-grid/theming-migration/. Because no value was provided to the `theme` grid option it defaulted to themeQuartz. But the file (ag-grid.css) is also included and will cause styling issues. Either pass the string "legacy" to the theme grid option to use v32 style themes, or remove ag-grid.css from the page to use Theming API.',240:({theme:e})=>`theme grid option must be a Theming API theme object or the string "legacy", received: ${e}`,243:()=>"Failed to deserialize state - each provided state object must be an object.",244:()=>"Failed to deserialize state - `selectAllChildren` must be a boolean value or undefined.",245:()=>"Failed to deserialize state - `toggledNodes` must be an array.",246:()=>"Failed to deserialize state - Every `toggledNode` requires an associated string id.",247:()=>`Row selection state could not be parsed due to invalid data. Ensure all child state has toggledNodes or does not conform with the parent rule. 
Please rebuild the selection state and reapply it.`,248:()=>"SetFloatingFilter expects SetFilter as its parent",249:()=>"Must supply a Value Formatter in Set Filter params when using a Key Creator",250:()=>"Must supply a Key Creator in Set Filter params when `treeList = true` on a group column, and Tree Data or Row Grouping is enabled.",251:({chartType:e})=>`AG Grid: Unable to create chart as an invalid chartType = '${e}' was supplied.`,252:()=>`cannot get grid to draw rows when it is in the middle of drawing rows. 
Your code probably called a grid API method while the grid was in the render stage. 
To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). 
To see what part of your code that caused the refresh check this stacktrace.`,253:({version:e})=>["Illegal version string: ",e],254:()=>"Cannot create chart: no chart themes available.",255:({point:e})=>`Lone surrogate U+${e?.toString(16).toUpperCase()} is not a scalar value`,256:()=>"Unable to initialise. See validation error, or load ValidationModule if missing.",257:()=>L_("IntegratedChartsModule"),258:()=>L_("SparklinesModule"),259:({part:e})=>`the argument to theme.withPart must be a Theming API part object, received: ${e}`,260:({propName:e,compName:t,gridScoped:i,gridId:n,rowModelType:o})=>A_({reasonOrId:`AG Grid '${e}' component: ${t}`,moduleName:wl[t],gridId:n,gridScoped:i,rowModelType:o}),261:()=>"As of v33, `column.isHovered()` is deprecated. Use `api.isColumnHovered(column)` instead.",262:()=>'As of v33, icon key "smallDown" is deprecated. Use "advancedFilterBuilderSelect" for Advanced Filter Builder dropdown, "selectOpen" for Select cell editor and dropdowns (e.g. Integrated Charts menu), "richSelectOpen" for Rich Select cell editor.',263:()=>'As of v33, icon key "smallLeft" is deprecated. Use "panelDelimiterRtl" for Row Group Panel / Pivot Panel, "subMenuOpenRtl" for sub-menus.',264:()=>'As of v33, icon key "smallRight" is deprecated. Use "panelDelimiter" for Row Group Panel / Pivot Panel, "subMenuOpen" for sub-menus.',265:({colId:e})=>`Unable to infer chart data type for column '${e}' if first data entry is null. Please specify "chartDataType", or a "cellDataType" in the column definition. For more information, see ${pl}/integrated-charts-range-chart#coldefchartdatatype .`,266:()=>'As of v33.1, using "keyCreator" with the Rich Select Editor has been deprecated. It now requires the "formatValue" callback to convert complex data to strings.',267:()=>"Detail grids can not use a different theme to the master grid, the `theme` detail grid option will be ignored.",268:()=>"Transactions aren't supported with tree data when using treeDataChildrenField",269:()=>"When `masterSelects: 'detail'`, detail grids must be configured with multi-row selection",270:({id:e,parentId:t})=>`Cycle detected for row with id='${e}' and parent id='${t}'. Resetting the parent for row with id='${e}' and showing it as a root-level node.`,271:({id:e,parentId:t})=>`Parent row not found for row with id='${e}' and parent id='${t}'. Showing row with id='${e}' as a root-level node.`,272:()=>xD(),273:({providedId:e,usedId:t})=>`Provided column id '${e}' was already in use, ensure all column and group ids are unique. Using '${t}' instead.`,274:({prop:e})=>{let t=`Since v33, ${e} has been deprecated.`;switch(e){case"maxComponentCreationTimeMs":t+=" This property is no longer required and so will be removed in a future version.";break;case"setGridApi":t+=" This method is not called by AG Grid. To access the GridApi see: https://ag-grid.com/react-data-grid/grid-interface/#grid-api ";break;case"children":t+=" For multiple versions AgGridReact does not support children.";break}return t},275:ED,276:()=>"Row Numbers Row Resizer cannot be used when Grid Columns have `autoHeight` enabled.",277:({colId:e})=>`'enableFilterHandlers' is set to true, but column '${e}' does not have 'filter.doesFilterPass' or 'filter.handler' set.`,278:({colId:e})=>`Unable to create filter handler for column '${e}'`,279:e=>{},280:({colId:e})=>`'name' must be provided for custom filter components for column '${e}`,281:({colId:e})=>`Filter for column '${e}' does not have 'filterParams.buttons', but the new Filters Tool Panel has buttons configured. Either configure buttons for the filter, or disable buttons on the Filters Tool Panel.`,282:()=>"New filter tool panel requires `enableFilterHandlers: true`.",283:()=>"As of v34, use the same method on the filter handler (`api.getColumnFilterHandler(colKey)`) instead.",284:()=>"As of v34, filters are active when they have a model. Use `api.getColumnFilterModel()` instead.",285:()=>"As of v34, use (`api.getColumnFilterModel()`) instead.",286:()=>"As of v34, use (`api.setColumnFilterModel()`) instead.",287:()=>"`api.doFilterAction()` requires `enableFilterHandlers = true",288:()=>"`api.getColumnFilterModel(key, true)` requires `enableFilterHandlers = true",289:({rowModelType:e})=>`Row Model '${e}' is not supported with Batch Editing`,290:({rowIndex:e,rowPinned:t})=>`Row with index '${e}' and pinned state '${t}' not found`,291:()=>"License Key being set multiple times with different values. This can result in an incorrect license key being used,",292:({colId:e})=>`The Multi Filter for column '${e}' has buttons configured against the child filters. When 'enableFilterHandlers=true', buttons must instead be provided against the parent Multi Filter params. The child filter buttons will be ignored.`};function zU(e,t){let i=GU[e];if(!i)return[`Missing error text for error id ${e}!`];let n=i(t),r=`
See ${SR(e,t)}`;return Array.isArray(n)?n.concat(r):[n,r]}var WU={1:"Charting Aggregation",2:"pivotResultFields",3:"setTooltip"},O_=new WeakMap,N_=new WeakMap;function _D(e,t,i){if(!t)return tt(11),{};let n=i,o;if(!n?.setThemeOnGridDiv){let s=Ft({tag:"div"});s.style.height="100%",e.appendChild(s),e=s,o=()=>e.remove()}return new qU().create(e,t,s=>{let a=new RH(e);s.createBean(a)},void 0,i,o)}var UU=1,qU=class{create(e,t,i,n,o,r){let s=ZC.applyGlobalGridOptions(t),a=s.gridId??String(UU++),l=this.getRegisteredModules(o,a,s.rowModelType),c=this.createBeansList(s.rowModelType,l,a),d=this.createProvidedBeans(e,s,o);if(!c)return;let h={providedBeanInstances:d,beanClasses:c,id:a,beanInitComparator:cH,beanDestroyComparator:dH,derivedBeans:[aH],destroyCallback:()=>{N_.delete(g),O_.delete(e),pL(a),r?.()}},p=new G9(h);this.registerModuleFeatures(p,l),i(p),p.getBean("syncSvc").start(),n?.(p);let g=p.getBean("gridApi");return O_.set(e,g),N_.set(g,e),g}getRegisteredModules(e,t,i){return vd(AU,void 0,!0),e?.modules?.forEach(n=>vd(n,t)),gL(t,B_(i))}registerModuleFeatures(e,t){let i=e.getBean("registry"),n=e.getBean("apiFunctionSvc");for(let o of t){i.registerModule(o);let r=o.apiFunctions;if(r){let s=Object.keys(r);for(let a of s)n?.addFunction(a,r[a])}}}createProvidedBeans(e,t,i){let n=i?i.frameworkOverrides:null;mt(n)&&(n=new xw);let o={gridOptions:t,eGridDiv:e,eRootDiv:e,globalListener:i?i.globalListener:null,globalSyncListener:i?i.globalSyncListener:null,frameworkOverrides:n};return i?.providedBeanInstances&&Object.assign(o,i.providedBeanInstances),o}createBeansList(e,t,i){let n={clientSide:"ClientSideRowModel",infinite:"InfiniteRowModel",serverSide:"ServerSideRowModel",viewport:"ViewportRowModel"},o=B_(e),r=n[o];if(!r){ed(201,{rowModelType:o},`Unknown rowModelType ${o}.`);return}if(!mL()){ed(272,void 0,xD());return}if(!e){let a=Object.entries(n).filter(([l,c])=>pC(c,i,l));if(a.length==1){let[l,c]=a[0];if(l!==o){let d={moduleName:c,rowModelType:l};ed(275,d,ED(d));return}}}if(!pC(r,i,o)){ed(200,{reasonOrId:`rowModelType = '${o}'`,moduleName:r,gridScoped:ew(),gridId:i,rowModelType:o},`Missing module ${r}Module for rowModelType ${o}.`);return}let s=new Set;for(let a of t)for(let l of a.beans??[])s.add(l);return Array.from(s)}};function B_(e){return e??"clientSide"}function ss(e){let t=e.rowModel;return t.getType()==="clientSide"?t:void 0}function rg(e){let t=e.rowModel;return t.getType()==="infinite"?t:void 0}function $U(e){let t=e.rowModel;return t.getType()==="serverSide"?t:void 0}var jU=class extends A{constructor(){super(...arguments),this.beanName="localeSvc"}getLocaleTextFunc(){let e=this.gos,t=e.getCallback("getLocaleText");return t?Z7(t):eL(e.get("localeText"))}};function KU(e,t=!1){let i=[],n=[],o=[],r=[],s=[],a=[],l=[],c=[],d=[],u=0;for(let h=0;h<e.length;h++){let{colId:p,sort:g,sortIndex:f,rowGroup:m,rowGroupIndex:v,aggFunc:C,pivot:w,pivotIndex:y,pinned:_,hide:R,width:P,flex:B}=e[h];d.push(p),g&&(i[f??u++]={colId:p,sort:g}),m&&(n[v??0]=p),typeof C=="string"&&o.push({colId:p,aggFunc:C}),w&&(r[y??0]=p),_&&(_==="right"?a:s).push(p),R&&l.push(p),(B!=null||P)&&c.push({colId:p,flex:B??void 0,width:P})}return{sort:i.length?{sortModel:sC(i)}:void 0,rowGroup:n.length?{groupColIds:sC(n)}:void 0,aggregation:o.length?{aggregationModel:o}:void 0,pivot:r.length||t?{pivotMode:t,pivotColIds:sC(r)}:void 0,columnPinning:s.length||a.length?{leftColIds:s,rightColIds:a}:void 0,columnVisibility:l.length?{hiddenColIds:l}:void 0,columnSizing:c.length?{columnSizingModel:c}:void 0,columnOrder:d.length?{orderedColIds:d}:void 0}}function sC(e){return e.filter(t=>t!=null)}function YU(e){let t=[];for(let{groupId:i,open:n}of e)n&&t.push(i);return t.length?{openColumnGroupIds:t}:void 0}var RD=class{wrap(e,t,i,n){let o=this.createWrapper(e,n);for(let r of t??[])this.createMethod(o,r,!0);for(let r of i??[])this.createMethod(o,r,!1);return o}createMethod(e,t,i){e.addMethod(t,this.createMethodProxy(e,t,i))}createMethodProxy(e,t,i){return function(){return e.hasMethod(t)?e.callMethod(t,arguments):(i&&W(49,{methodName:t}),null)}}};function aC(e){return e.get("tooltipShowMode")==="whenTruncated"}function XU(e,t){if(typeof e!="number")return"";let i=t(),n=i("thousandSeparator",","),o=i("decimalSeparator",".");return e.toString().replace(".",o).replace(/(\d)(?=(\d{3})+(?!\d))/g,`$1${n}`)}var JU=class extends A{getFileName(e){let t=this.getDefaultFileExtension();return e?.length||(e=this.getDefaultFileName()),e.includes(".")?e:`${e}.${t}`}getData(e){let t=this.createSerializingSession(e);return this.beans.gridSerializer.serialize(t,e)}getDefaultFileName(){return`export.${this.getDefaultFileExtension()}`}},QU=class{constructor(e){let{colModel:t,rowGroupColsSvc:i,colNames:n,valueSvc:o,gos:r,processCellCallback:s,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c}=e;this.colModel=t,this.rowGroupColsSvc=i,this.colNames=n,this.valueSvc=o,this.gos=r,this.processCellCallback=s,this.processHeaderCallback=a,this.processGroupHeaderCallback=l,this.processRowGroupCallback=c}prepare(e){}extractHeaderValue(e){return this.getHeaderName(this.processHeaderCallback,e)??""}extractRowCellValue(e,t,i,n,o){let r=t===0&&MR(this.gos,o,this.colModel.isPivotMode());if(this.processRowGroupCallback&&(this.gos.get("treeData")||o.group)&&(e.isRowGroupDisplayed(o.rowGroupColumn?.getColId()??"")||r))return{value:this.processRowGroupCallback(ye(this.gos,{column:e,node:o}))??""};if(this.processCellCallback)return{value:this.processCellCallback(ye(this.gos,{accumulatedRowIndex:i,column:e,node:o,value:this.valueSvc.getValueForDisplay(e,o,void 0,void 0).value,type:n,parseValue:h=>this.valueSvc.parseValue(e,o,h,this.valueSvc.getValue(e,o,void 0)),formatValue:h=>this.valueSvc.formatValue(e,o,h)??h}))??""};let s=this.gos.get("treeData"),a=this.valueSvc,l=o.level===-1&&o.footer,c=e.colDef.showRowGroup===!0&&(o.group||s);if(!l&&(r||c)){let h="",p=o;for(;p&&p.level!==-1;){let{value:g,valueFormatted:f}=a.getValueForDisplay(r?void 0:e,p,!0,!0);h=` -> ${f??g??""}${h}`,p=p.parent}return{value:h,valueFormatted:h}}let{value:d,valueFormatted:u}=a.getValueForDisplay(e,o,!0,!0);return{value:d??"",valueFormatted:u}}getHeaderName(e,t){return e?e(ye(this.gos,{column:t})):this.colNames.getDisplayNameForColumn(t,"csv",!0)}};function ZU(e,t){let i=document.defaultView||window;if(!i){W(52);return}let n=document.createElement("a"),o=i.URL.createObjectURL(t);n.setAttribute("href",o),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:i})),n.remove(),i.setTimeout(()=>{i.URL.revokeObjectURL(o)},0)}var eq={enableBrowserTooltips:!0,tooltipTrigger:!0,tooltipMouseTrack:!0,tooltipShowMode:!0,tooltipInteraction:!0,defaultColGroupDef:!0,suppressAutoSize:!0,skipHeaderOnAutoSize:!0,autoSizeStrategy:!0,components:!0,stopEditingWhenCellsLoseFocus:!0,undoRedoCellEditing:!0,undoRedoCellEditingLimit:!0,excelStyles:!0,cacheQuickFilter:!0,customChartThemes:!0,chartThemeOverrides:!0,chartToolPanelsDef:!0,loadingCellRendererSelector:!0,localeText:!0,keepDetailRows:!0,keepDetailRowsCount:!0,detailRowHeight:!0,detailRowAutoHeight:!0,tabIndex:!0,valueCache:!0,valueCacheNeverExpires:!0,enableCellExpressions:!0,suppressTouch:!0,suppressBrowserResizeObserver:!0,suppressPropertyNamesCheck:!0,debug:!0,dragAndDropImageComponent:!0,loadingOverlayComponent:!0,suppressLoadingOverlay:!0,noRowsOverlayComponent:!0,paginationPageSizeSelector:!0,paginateChildRows:!0,pivotPanelShow:!0,pivotSuppressAutoColumn:!0,suppressExpandablePivotGroups:!0,aggFuncs:!0,allowShowChangeAfterFilter:!0,ensureDomOrder:!0,enableRtl:!0,suppressColumnVirtualisation:!0,suppressMaxRenderedRowRestriction:!0,suppressRowVirtualisation:!0,rowDragText:!0,groupLockGroupColumns:!0,suppressGroupRowsSticky:!0,rowModelType:!0,cacheOverflowSize:!0,infiniteInitialRowCount:!0,serverSideInitialRowCount:!0,maxBlocksInCache:!0,maxConcurrentDatasourceRequests:!0,blockLoadDebounceMillis:!0,serverSideOnlyRefreshFilteredGroups:!0,serverSidePivotResultFieldSeparator:!0,viewportRowModelPageSize:!0,viewportRowModelBufferSize:!0,debounceVerticalScrollbar:!0,suppressAnimationFrame:!0,suppressPreventDefaultOnMouseWheel:!0,scrollbarWidth:!0,icons:!0,suppressRowTransform:!0,gridId:!0,enableGroupEdit:!0,initialState:!0,processUnpinnedColumns:!0,createChartContainer:!0,getLocaleText:!0,getRowId:!0,reactiveCustomComponents:!0,renderingMode:!0,columnMenu:!0,suppressSetFilterByDefault:!0,getDataPath:!0,enableCellSpan:!0,enableFilterHandlers:!0,filterHandlers:!0},Gi="clientSide",Ci="serverSide",nl="infinite",tq={onGroupExpandedOrCollapsed:[Gi],refreshClientSideRowModel:[Gi],isRowDataEmpty:[Gi],forEachLeafNode:[Gi],forEachNodeAfterFilter:[Gi],forEachNodeAfterFilterAndSort:[Gi],resetRowHeights:[Gi,Ci],applyTransaction:[Gi],applyTransactionAsync:[Gi],flushAsyncTransactions:[Gi],getBestCostNodeSelection:[Gi],getServerSideSelectionState:[Ci],setServerSideSelectionState:[Ci],applyServerSideTransaction:[Ci],applyServerSideTransactionAsync:[Ci],applyServerSideRowData:[Ci],retryServerSideLoads:[Ci],flushServerSideAsyncTransactions:[Ci],refreshServerSide:[Ci],getServerSideGroupLevelState:[Ci],refreshInfiniteCache:[nl],purgeInfiniteCache:[nl],getInfiniteRowCount:[nl],isLastRowIndexKnown:[nl,Ci],expandAll:[Gi,Ci],collapseAll:[Gi,Ci],onRowHeightChanged:[Gi,Ci],setRowCount:[nl,Ci],getCacheBlockState:[nl,Ci]},iq={showLoadingOverlay:{version:"v32",message:'`showLoadingOverlay` is deprecated. Use the grid option "loading"=true instead or setGridOption("loading", true).'},clearRangeSelection:{version:"v32.2",message:"Use `clearCellSelection` instead."},getInfiniteRowCount:{version:"v32.2",old:"getInfiniteRowCount()",new:"getDisplayedRowCount()"},selectAllFiltered:{version:"v33",old:"selectAllFiltered()",new:'selectAll("filtered")'},deselectAllFiltered:{version:"v33",old:"deselectAllFiltered()",new:'deselectAll("filtered")'},selectAllOnCurrentPage:{version:"v33",old:"selectAllOnCurrentPage()",new:'selectAll("currentPage")'},deselectAllOnCurrentPage:{version:"v33",old:"deselectAllOnCurrentPage()",new:'deselectAll("currentPage")'}};function nq(e,t,i){let n=iq[e];if(n){let{version:r,new:s,old:a,message:l}=n,c=a??e;return(...d)=>{let u=s?`Please use ${s} instead. `:"";return sd(`Since ${r} api.${c} is deprecated. ${u}${l??""}`),t.apply(t,d)}}let o=tq[e];return o?(...r)=>{let s=i.rowModel.getType();if(!o.includes(s)){ul(`api.${e} can only be called when gridOptions.rowModelType is ${o.join(" or ")}`);return}return t.apply(t,r)}:t}var oq={detailCellRendererCtrl:"SharedMasterDetail",dndSourceComp:"DragAndDrop",fillHandle:"CellSelection",groupCellRendererCtrl:"GroupCellRenderer",headerFilterCellCtrl:"ColumnFilter",headerGroupCellCtrl:"ColumnGroup",rangeHandle:"CellSelection",tooltipFeature:"Tooltip",highlightTooltipFeature:"Tooltip",tooltipStateManager:"Tooltip",groupStrategy:"RowGrouping",treeGroupStrategy:"TreeData",rowNumberRowResizer:"RowNumbers",singleCell:"EditCore",fullRow:"EditCore",agSetColumnFilterHandler:"SetFilter",agMultiColumnFilterHandler:"MultiFilter",agGroupColumnFilterHandler:"GroupFilter",agNumberColumnFilterHandler:"NumberFilter",agDateColumnFilterHandler:"DateFilter",agTextColumnFilterHandler:"TextFilter"},rq={expanded:1,contracted:1,"tree-closed":1,"tree-open":1,"tree-indeterminate":1,pin:1,"eye-slash":1,arrows:1,left:1,right:1,group:1,aggregation:1,pivot:1,"not-allowed":1,chart:1,cross:1,cancel:1,tick:1,first:1,previous:1,next:1,last:1,linked:1,unlinked:1,"color-picker":1,loading:1,menu:1,"menu-alt":1,filter:1,"filter-add":1,columns:1,maximize:1,minimize:1,copy:1,cut:1,paste:1,grip:1,save:1,csv:1,excel:1,"small-down":1,"small-left":1,"small-right":1,"small-up":1,asc:1,desc:1,none:1,up:1,down:1,plus:1,minus:1,settings:1,"checkbox-checked":1,"checkbox-indeterminate":1,"checkbox-unchecked":1,"radio-button-on":1,"radio-button-off":1,eye:1,"column-arrow":1,"un-pin":1,"pinned-top":1,"pinned-bottom":1,"chevron-up":1,"chevron-down":1,"chevron-left":1,"chevron-right":1,edit:1},sq={chart:"MenuCore",cancel:"EnterpriseCore",first:"Pagination",previous:"Pagination",next:"Pagination",last:"Pagination",linked:"IntegratedCharts",loadingMenuItems:"MenuCore",unlinked:"IntegratedCharts",menu:"ColumnHeaderComp",legacyMenu:"ColumnMenu",filter:"ColumnFilter",filterActive:"ColumnFilter",filterAdd:"NewFiltersToolPanel",filterCardCollapse:"NewFiltersToolPanel",filterCardExpand:"NewFiltersToolPanel",filterCardEditing:"NewFiltersToolPanel",filterTab:"ColumnMenu",filtersToolPanel:"FiltersToolPanel",columns:["MenuCore"],columnsToolPanel:["ColumnsToolPanel"],maximize:"EnterpriseCore",minimize:"EnterpriseCore",save:"MenuCore",columnGroupOpened:"ColumnGroupHeaderComp",columnGroupClosed:"ColumnGroupHeaderComp",accordionOpen:"EnterpriseCore",accordionClosed:"EnterpriseCore",accordionIndeterminate:"EnterpriseCore",columnSelectClosed:["ColumnsToolPanel","ColumnMenu"],columnSelectOpen:["ColumnsToolPanel","ColumnMenu"],columnSelectIndeterminate:["ColumnsToolPanel","ColumnMenu"],columnMovePin:"SharedDragAndDrop",columnMoveHide:"SharedDragAndDrop",columnMoveMove:"SharedDragAndDrop",columnMoveLeft:"SharedDragAndDrop",columnMoveRight:"SharedDragAndDrop",columnMoveGroup:"SharedDragAndDrop",columnMoveValue:"SharedDragAndDrop",columnMovePivot:"SharedDragAndDrop",dropNotAllowed:"SharedDragAndDrop",ensureColumnVisible:["ColumnsToolPanel","ColumnMenu"],groupContracted:"GroupCellRenderer",groupExpanded:"GroupCellRenderer",setFilterGroupClosed:"SetFilter",setFilterGroupOpen:"SetFilter",setFilterGroupIndeterminate:"SetFilter",setFilterLoading:"SetFilter",close:"EnterpriseCore",check:"MenuItem",colorPicker:"CommunityCore",groupLoading:"LoadingCellRenderer",menuAlt:"ColumnHeaderComp",menuPin:"MenuCore",menuValue:"MenuCore",menuAddRowGroup:["MenuCore","ColumnsToolPanel"],menuRemoveRowGroup:["MenuCore","ColumnsToolPanel"],clipboardCopy:"MenuCore",clipboardCut:"MenuCore",clipboardPaste:"MenuCore",pivotPanel:["ColumnsToolPanel","RowGroupingPanel"],rowGroupPanel:["ColumnsToolPanel","RowGroupingPanel"],valuePanel:"ColumnsToolPanel",columnDrag:"EnterpriseCore",rowDrag:["RowDrag","DragAndDrop"],csvExport:"MenuCore",excelExport:"MenuCore",smallDown:"CommunityCore",selectOpen:"CommunityCore",richSelectOpen:"RichSelect",richSelectRemove:"RichSelect",smallLeft:"CommunityCore",smallRight:"CommunityCore",subMenuOpen:"MenuItem",subMenuOpenRtl:"MenuItem",panelDelimiter:"RowGroupingPanel",panelDelimiterRtl:"RowGroupingPanel",smallUp:"CommunityCore",sortAscending:["MenuCore","Sort"],sortDescending:["MenuCore","Sort"],sortUnSort:["MenuCore","Sort"],advancedFilterBuilder:"AdvancedFilter",advancedFilterBuilderDrag:"AdvancedFilter",advancedFilterBuilderInvalid:"AdvancedFilter",advancedFilterBuilderMoveUp:"AdvancedFilter",advancedFilterBuilderMoveDown:"AdvancedFilter",advancedFilterBuilderAdd:"AdvancedFilter",advancedFilterBuilderRemove:"AdvancedFilter",advancedFilterBuilderSelectOpen:"AdvancedFilter",chartsMenu:"IntegratedCharts",chartsMenuEdit:"IntegratedCharts",chartsMenuAdvancedSettings:"IntegratedCharts",chartsMenuAdd:"IntegratedCharts",chartsColorPicker:"IntegratedCharts",chartsThemePrevious:"IntegratedCharts",chartsThemeNext:"IntegratedCharts",chartsDownload:"IntegratedCharts",checkboxChecked:"CommunityCore",checkboxIndeterminate:"CommunityCore",checkboxUnchecked:"CommunityCore",radioButtonOn:"CommunityCore",radioButtonOff:"CommunityCore",rowPin:"PinnedRow",rowUnpin:"PinnedRow",rowPinBottom:"PinnedRow",rowPinTop:"PinnedRow"},aq=new Set(["colorPicker","smallUp","checkboxChecked","checkboxIndeterminate","checkboxUnchecked","radioButtonOn","radioButtonOff","smallDown","smallLeft","smallRight"]),lq=class extends A{constructor(){super(...arguments),this.beanName="validation"}wireBeans(e){this.gridOptions=e.gridOptions,vL(zU)}warnOnInitialPropertyUpdate(e,t){e==="api"&&eq[t]&&W(22,{key:t})}processGridOptions(e){this.processOptions(e,tW())}validateApiFunction(e,t){return nq(e,t,this.beans)}missingUserComponent(e,t,i,n){let o=wl[t];o?this.gos.assertModuleRegistered(o,`AG Grid '${e}' component: ${t}`):W(101,{propertyName:e,componentName:t,agGridDefaults:i,jsComps:n})}missingDynamicBean(e){let t=oq[e];return t?Co(200,z(b({},this.gos.getModuleErrorParams()),{moduleName:t,reasonOrId:e})):void 0}checkRowEvents(e){dq.has(e)&&W(10,{eventType:e})}validateIcon(e){if(aq.has(e)&&W(43,{iconName:e}),rq[e])return;let t=sq[e];if(t){tt(200,{reasonOrId:`icon '${e}'`,moduleName:t,gridScoped:ew(),gridId:this.beans.context.getId(),rowModelType:this.gos.get("rowModelType"),additionalText:"Alternatively, use the CSS icon name directly."});return}W(134,{iconName:e})}isProvidedUserComp(e){return!!wl[e]}validateColDef(e){this.processOptions(e,qz())}processOptions(e,t){let{validations:i,deprecations:n,allProperties:o,propertyExceptions:r,objectName:s,docsUrl:a}=t;o&&this.gridOptions.suppressPropertyNamesCheck!==!0&&this.checkProperties(e,[...r??[],...Object.keys(n)],o,s,a);let l=new Set;if(Object.keys(e).forEach(d=>{let u=n[d];if(u){let{message:C,version:w}=u;l.add(`As of v${w}, ${String(d)} is deprecated. ${C??""}`)}let h=e[d];if(h==null||h===!1)return;let p=i[d];if(!p)return;let{dependencies:g,validate:f,supportedRowModels:m,expectedType:v}=p;if(v){let C=typeof h;if(C!==v){l.add(`${String(d)} should be of type '${v}' but received '${C}' (${h}).`);return}}if(m){let C=this.gridOptions.rowModelType??"clientSide";if(!m.includes(C)){l.add(`${String(d)} is not supported with the '${C}' row model. It is only valid with: ${m.join(", ")}.`);return}}if(g){let C=this.checkForRequiredDependencies(d,g,e);if(C){l.add(C);return}}if(f){let C=f(e,this.gridOptions,this.beans);if(C){l.add(C);return}}}),l.size>0)for(let d of l)sd(d)}checkForRequiredDependencies(e,t,i){let o=Object.entries(t).filter(([r,s])=>{let a=i[r];return!s.required.includes(a)});return o.length===0?null:o.map(([r,s])=>`'${String(e)}' requires '${r}' to be one of [${s.required.map(a=>a===null?"null":a===void 0?"undefined":a).join(", ")}]. ${s.reason??""}`).join(`
           `)}checkProperties(e,t,i,n,o){let r=["__ob__","__v_skip","__metadata__"],s=cq(Object.getOwnPropertyNames(e),[...r,...t,...i],i),a=Object.keys(s);for(let l of a){let c=s[l],d=`invalid ${n} property '${l}' did you mean any of these: ${c.slice(0,8).join(", ")}.`;i.includes("context")&&(d+=`
If you are trying to annotate ${n} with application data, use the '${n}.context' property instead.`),sd(d)}if(a.length>0&&o){let l=this.beans.frameworkOverrides.getDocLink(o);sd(`to see all the valid ${n} properties please check: ${l}`)}}};function cq(e,t,i){let n={},o=e.filter(r=>!t.some(s=>s===r));if(o.length>0)for(let r of o)n[r]=xC({inputValue:r,allSuggestions:i}).values;return n}var dq=new Set(["firstChildChanged","lastChildChanged","childIndexChanged"]),uq={moduleName:"Validation",version:ee,beans:[lq]};function PD(e){let t=e.sibling;t&&(t.childrenAfterFilter=e.childrenAfterFilter)}var hq=class extends A{constructor(){super(...arguments),this.beanName="filterStage",this.step="filter",this.refreshProps=["excludeChildrenWhenTreeDataFiltering"]}wireBeans(e){this.filterManager=e.filterManager}execute(e){let{changedPath:t}=e;this.filter(t)}filter(e){let t=!!this.filterManager?.isChildFilterPresent();this.filterNodes(t,e)}filterNodes(e,t){let i=(n,o)=>{n.hasChildren()&&e&&!o?n.childrenAfterFilter=n.childrenAfterGroup.filter(r=>{let s=r.childrenAfterFilter&&r.childrenAfterFilter.length>0,a=r.data&&this.filterManager.doesRowPassFilter({rowNode:r});return s||a}):n.childrenAfterFilter=n.childrenAfterGroup,PD(n)};if(this.doingTreeDataFiltering()){let n=(r,s)=>{if(r.childrenAfterGroup)for(let a=0;a<r.childrenAfterGroup.length;a++){let l=r.childrenAfterGroup[a],c=s||this.filterManager.doesRowPassFilter({rowNode:l});l.childrenAfterGroup?n(r.childrenAfterGroup[a],c):i(l,c)}i(r,s)},o=r=>n(r,!1);t.executeFromRootNode(o)}else{let n=o=>i(o,!1);t.forEachChangedNodeDepthFirst(n,!0)}}doingTreeDataFiltering(){return this.gos.get("treeData")&&!this.gos.get("excludeChildrenWhenTreeDataFiltering")}},pq=class extends Sw{constructor(){super(...arguments),this.iconCreated=!1}wireComp(e,t,i,n,o){this.comp=e;let r=Pd(this,this.beans.context,o);this.eButtonShowMainFilter=i,this.eFloatingFilterBody=n,this.setGui(t,r),this.setupActive(),this.refreshHeaderStyles(),this.setupWidth(r),this.setupLeft(r),this.setupHover(r),this.setupFocus(r),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(r),this.setupUi(),r.addManagedElementListeners(this.eButtonShowMainFilter,{click:this.showParentFilter.bind(this)}),this.setupFilterChangedListener(r);let s=()=>this.onColDefChanged(r);r.addManagedListeners(this.column,{colDefChanged:s}),r.addManagedEventListeners({filterSwitched:({column:a})=>{a===this.column&&s()}}),r.addDestroyFunc(()=>{this.eButtonShowMainFilter=null,this.eFloatingFilterBody=null,this.userCompDetails=null,this.clearComponent()})}resizeHeader(){}moveHeader(){}getHeaderClassParams(){let{column:e,beans:t}=this,i=e.colDef;return ye(t.gos,{colDef:i,column:e,floatingFilter:!0})}setupActive(){let e=this.column.getColDef(),t=!!e.filter,i=!!e.floatingFilter;this.active=t&&i}setupUi(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),!this.active||this.iconCreated)return;let e=wn("filter",this.beans,this.column);e&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(e))}setupFocus(e){e.createManagedBean(new kl(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}setupAria(){let e=this.getLocaleTextFunc();Sl(this.eButtonShowMainFilter,e("ariaFilterMenuOpen","Open Filter Menu"))}onTabKeyDown(e){let{beans:t}=this;if(Ct(t)===this.eGui)return;let o=ha(t,this.eGui,null,e.shiftKey);if(o){t.headerNavigation?.scrollToColumn(this.column),e.preventDefault(),o.focus();return}let r=this.findNextColumnWithFloatingFilter(e.shiftKey);r&&t.focusSvc.focusHeaderPosition({headerPosition:{headerRowIndex:this.rowCtrl.rowIndex,column:r},event:e})&&e.preventDefault()}findNextColumnWithFloatingFilter(e){let t=this.beans.visibleCols,i=this.column;do if(i=e?t.getColBefore(i):t.getColAfter(i),!i)break;while(!i.getColDef().filter||!i.getColDef().floatingFilter);return i}handleKeyDown(e){super.handleKeyDown(e);let t=this.getWrapperHasFocus();switch(e.key){case T.UP:case T.DOWN:case T.LEFT:case T.RIGHT:if(t)return;la(e);case T.ENTER:t&&aa(this.eGui)&&e.preventDefault();break;case T.ESCAPE:t||this.eGui.focus()}}onFocusIn(e){if(this.eGui.contains(e.relatedTarget))return;let i=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),n=!!e.relatedTarget&&Zs(e.relatedTarget,"ag-floating-filter");if(i&&n&&e.target===this.eGui){let o=this.lastFocusEvent,r=!!(o&&o.key===T.TAB);if(o&&r){let s=o.shiftKey;aa(this.eGui,s)}}this.focusThis()}setupHover(e){this.beans.colHover?.addHeaderFilterColumnHoverListener(e,this.comp,this.column,this.eGui)}setupLeft(e){let t=new yw(this.column,this.eGui,this.beans);e.createManagedBean(t)}setupFilterButton(){this.suppressFilterButton=!this.beans.menuSvc?.isFloatingFilterButtonEnabled(this.column),this.highlightFilterButtonWhenActive=!tn(this.gos)}setupUserComp(){if(!this.active)return;let e=this.beans.colFilter?.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter());e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setCompDetails(e)}showParentFilter(){let e=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.beans.menuSvc?.showFilterMenu({column:this.column,buttonElement:e,containerType:"floatingFilter",positionBy:"button"})}setupSyncWithFilter(e){if(!this.active)return;let{beans:{colFilter:t},column:i,gos:n}=this,o=r=>{if(r?.source==="filterDestroyed"&&(!this.isAlive()||!t?.isAlive()))return;let s=this.comp.getFloatingFilterComp();s&&s.then(a=>{if(a){if(n.get("enableFilterHandlers")){let d=r,u="filter";d?.afterFloatingFilter?u="ui":d?.afterDataChange?u="dataChanged":r?.source==="api"&&(u="api"),this.updateFloatingFilterParams(this.userCompDetails,u);return}let l=t?.getCurrentFloatingFilterParentModel(i),c=r?z(b({},r),{columns:r.columns??[],source:r.source==="api"?"api":"columnFilter"}):null;a.onParentModelChanged(l,c)}})};[this.destroySyncListener]=e.addManagedListeners(i,{filterChanged:o}),t?.isFilterActive(i)&&o(null)}setupWidth(e){let t=()=>{let i=`${this.column.getActualWidth()}px`;this.comp.setWidth(i)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupFilterChangedListener(e){this.active&&([this.destroyFilterChangedListener]=e.addManagedListeners(this.column,{filterChanged:this.updateFilterButton.bind(this)}),this.updateFilterButton())}updateFilterButton(){if(!this.suppressFilterButton&&this.comp){let e=!!this.beans.filterManager?.isFilterAllowed(this.column);this.comp.setButtonWrapperDisplayed(e),this.highlightFilterButtonWhenActive&&e&&this.eButtonShowMainFilter.classList.toggle("ag-filter-active",this.column.isFilterActive())}}onColDefChanged(e){let t=this.active;this.setupActive();let i=!t&&this.active;t&&!this.active&&(this.destroySyncListener(),this.destroyFilterChangedListener());let n=this.beans.colFilter,o=this.active?n?.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter()):null,r=this.comp.getFloatingFilterComp();!r||!o?this.updateCompDetails(e,o,i):r.then(s=>{!s||n?.areFilterCompsDifferent(this.userCompDetails??null,o)?this.updateCompDetails(e,o,i):this.updateFloatingFilterParams(o,"colDef")})}updateCompDetails(e,t,i){this.isAlive()&&(this.setCompDetails(t),this.setupFilterButton(),this.setupUi(),i&&(this.setupSyncWithFilter(e),this.setupFilterChangedListener(e)))}updateFloatingFilterParams(e,t){if(!e)return;let i=e.params;this.comp.getFloatingFilterComp()?.then(n=>{typeof n?.refresh=="function"&&(this.gos.get("enableFilterHandlers")&&(i=z(b({},i),{model:Jt(this.beans.colFilter?.model??{},this.column.getColId()),source:t})),n.refresh(i))})}addResizeAndMoveKeyboardListeners(){}destroy(){super.destroy(),this.destroySyncListener=null,this.destroyFilterChangedListener=null}};function gq(e,t){let i=e.colModel.getCol(t);if(!i){tt(12,{colKey:t});return}e.menuSvc?.showColumnMenu({column:i,positionBy:"auto"})}function fq(e){e.menuSvc?.hidePopupMenu()}var mq={moduleName:"SharedMenu",version:ee,beans:[kB],apiFunctions:{showColumnMenu:gq,hidePopupMenu:fq}},vq=class extends J9{postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridCtrl=e.gridCtrl}),this.addManagedEventListeners({gridStylesChanged:this.handleThemeChange.bind(this)})}getDefaultPopupParent(){return this.gridCtrl.getGui()}positionPopupForMenu(e){let{eventSource:t,ePopup:i,event:n}=e,o=t.getBoundingClientRect(),r=this.getParentRect();this.setAlignedTo(t,i);let s=!1,a=()=>{let l=this.keepXYWithinBounds(i,o.top-r.top,0),c=i.clientWidth>0?i.clientWidth:200;s||(i.style.minWidth=`${c}px`,s=!0);let u=r.right-r.left-c,h;return this.gos.get("enableRtl")?(h=g(),h<0&&(h=p(),this.setAlignedStyles(i,"left")),h>u&&(h=0,this.setAlignedStyles(i,"right"))):(h=p(),h>u&&(h=g(),this.setAlignedStyles(i,"right")),h<0&&(h=0,this.setAlignedStyles(i,"left"))),{x:h,y:l};function p(){return o.right-r.left-2}function g(){return o.left-r.left-c}};this.positionPopup({ePopup:i,keepWithinBounds:!0,updatePosition:a,postProcessCallback:()=>this.callPostProcessPopup(e,"subMenu",i,t,n instanceof MouseEvent?n:void 0)})}callPostProcessPopup(e,t,i,n,o){let r=this.gos.getCallback("postProcessPopup");if(r){let{column:s,rowNode:a}=e;r({column:s,rowNode:a,ePopup:i,type:t,eventSource:n,mouseEvent:o})}}getActivePopups(){return this.popupList.map(e=>e.element)}handleThemeChange(e){if(e.themeChanged){let t=this.beans.environment;for(let i of this.popupList)t.applyThemeClasses(i.wrapper)}}hasAnchoredPopup(){return this.popupList.some(e=>e.isAnchored)}isStopPropagation(e){return sr(e)}},sg={moduleName:"Popup",version:ee,beans:[vq]},Cq=".ag-set-filter{--ag-indentation-level:0}.ag-set-filter-item{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-set-filter-item{padding-left:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}:where(.ag-rtl) .ag-set-filter-item{padding-right:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}.ag-set-filter-item-checkbox{display:flex;height:100%;width:100%}.ag-set-filter-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr) .ag-set-filter-group-icons{margin-right:var(--ag-widget-container-horizontal-padding)}:where(.ag-rtl) .ag-set-filter-group-icons{margin-left:var(--ag-widget-container-horizontal-padding)}.ag-filter-body-wrapper{display:flex;flex-direction:column}:where(.ag-menu:not(.ag-tabs) .ag-filter) .ag-filter-body-wrapper,:where(.ag-menu:not(.ag-tabs) .ag-filter)>:not(.ag-filter-wrapper){min-width:180px}.ag-filter-filter{flex:1 1 0px}.ag-filter-condition{display:flex;justify-content:center}.ag-floating-filter-body{display:flex;flex:1 1 auto;height:100%;position:relative}.ag-floating-filter-full-body{align-items:center;display:flex;flex:1 1 auto;height:100%;overflow:hidden;width:100%}:where(.ag-floating-filter-full-body)>div{flex:1 1 auto}.ag-floating-filter-input{align-items:center;display:flex;width:100%;>*{flex:1 1 auto}:where(.ag-input-field-input[type=date]),:where(.ag-input-field-input[type=datetime-local]){width:1px}}.ag-floating-filter-button{display:flex;flex:none}.ag-date-floating-filter-wrapper{display:flex}.ag-set-floating-filter-input :where(input)[disabled]{pointer-events:none}.ag-floating-filter-button-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:none;height:var(--ag-icon-size);width:var(--ag-icon-size)}.ag-filter-loading{align-items:unset;background-color:var(--ag-chrome-background-color);height:100%;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);position:absolute;width:100%;z-index:1;:where(.ag-menu) &{background-color:var(--ag-menu-background-color)}}.ag-filter-separator{border-top:solid var(--ag-border-width) var(--menu-separator-color)}:where(.ag-filter-select) .ag-picker-field-wrapper{width:0}.ag-filter-condition-operator{height:17px}:where(.ag-ltr) .ag-filter-condition-operator-or{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-condition-operator-or{margin-right:calc(var(--ag-spacing)*2)}.ag-set-filter-select-all{padding-top:var(--ag-widget-container-vertical-padding)}.ag-filter-no-matches,.ag-set-filter-list{height:calc(var(--ag-list-item-height)*6)}.ag-filter-no-matches{padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}.ag-set-filter-tree-list{height:calc(var(--ag-list-item-height)*10)}.ag-set-filter-filter{margin-left:var(--ag-widget-container-horizontal-padding);margin-right:var(--ag-widget-container-horizontal-padding);margin-top:var(--ag-widget-container-vertical-padding)}.ag-filter-to{margin-top:var(--ag-widget-vertical-spacing)}.ag-mini-filter{margin:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}:where(.ag-ltr) .ag-set-filter-add-group-indent{margin-left:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-rtl) .ag-set-filter-add-group-indent{margin-right:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-filter-menu) .ag-set-filter-list{min-width:200px}.ag-filter-virtual-list-item:focus-visible{box-shadow:inset var(--ag-focus-shadow)}.ag-filter-apply-panel{display:flex;justify-content:flex-end;overflow:hidden;padding:var(--ag-widget-vertical-spacing) var(--ag-widget-container-horizontal-padding) var(--ag-widget-container-vertical-padding)}.ag-filter-apply-panel-button{line-height:1.5}:where(.ag-ltr) .ag-filter-apply-panel-button{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-apply-panel-button{margin-right:calc(var(--ag-spacing)*2)}.ag-simple-filter-body-wrapper{display:flex;flex-direction:column;min-height:calc(var(--ag-list-item-height) + var(--ag-widget-container-vertical-padding) + var(--ag-widget-vertical-spacing));overflow-y:auto;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);padding-bottom:calc(var(--ag-widget-container-vertical-padding) - var(--ag-widget-vertical-spacing));&>*{margin-bottom:var(--ag-widget-vertical-spacing)}:where(.ag-resizer-wrapper){margin:0}}.ag-multi-filter-menu-item{margin:var(--ag-spacing) 0}.ag-multi-filter-group-title-bar{background-color:transparent;color:var(--ag-header-text-color);font-weight:500;padding:calc(var(--ag-spacing)*1.5) var(--ag-spacing)}.ag-group-filter-field-select-wrapper{display:flex;flex-direction:column;gap:var(--ag-widget-vertical-spacing);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}";function wq(e){let t=e.filterManager;return!!t?.isColumnFilterPresent()||!!t?.isAggregateFilterPresent()}function bq(e,t){return e.filterManager?.getColumnFilterInstance(t)??Promise.resolve(void 0)}function yq(e,t){let i=e.colModel.getColDefCol(t);if(i)return e.colFilter?.destroyFilter(i,"api")}function Sq(e,t){e.frameworkOverrides.wrapIncoming(()=>e.filterManager?.setFilterModel(t))}function xq(e){return e.filterManager?.getFilterModel()??{}}function Eq(e,t,i){let{gos:n,colModel:o,colFilter:r}=e;i&&!n.get("enableFilterHandlers")&&(W(288),i=!1);let s=o.getColDefCol(t);return s?r?.getModelForColumn(s,i)??null:null}function _q(e,t,i){return e.filterManager?.setColumnFilterModel(t,i)??Promise.resolve()}function Rq(e,t){let i=e.colModel.getCol(t);if(!i){tt(12,{colKey:t});return}e.menuSvc?.showFilterMenu({column:i,containerType:"columnFilter",positionBy:"auto"})}function Pq(e){e.menuSvc?.hideFilterMenu()}function Dq(e,t){let i=e.colModel.getCol(t);if(!i){tt(12,{colKey:t});return}return e.colFilter?.getHandler(i,!0)}function Mq(e,t){let{colModel:i,colFilter:n,gos:o}=e;if(!o.get("enableFilterHandlers")){W(287);return}let{colId:r,action:s}=t;if(r){let a=i.getColById(r);a&&n?.updateModel(a,s)}else n?.updateAllModels(s)}var kq={filterHandler:()=>({doesFilterPass:()=>!0})},Tq=class extends A{constructor(){super(...arguments),this.beanName="colFilter",this.allColumnFilters=new Map,this.allColumnListeners=new Map,this.activeAggregateFilters=[],this.activeColumnFilters=[],this.processingFilterChange=!1,this.modelUpdates=[],this.columnModelUpdates=[],this.state=new Map,this.handlerMap=b({},wP),this.isGlobalButtons=!1,this.activeFilterComps=new Set}postConstruct(){this.addManagedEventListeners({gridColumnsChanged:this.onColumnsChanged.bind(this),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)});let e=this.gos,t=b({},e.get("initialState")?.filter?.filterModel??{});this.initialModel=t,this.model=b({},t),e.get("enableFilterHandlers")||delete this.handlerMap.agMultiColumnFilter}refreshModel(){this.onNewRowsLoaded("rowDataUpdated")}setModel(e,t="api",i){let{colModel:n,dataTypeSvc:o,filterManager:r}=this.beans;if(o?.isPendingInference){this.modelUpdates.push({model:e,source:t});return}let s=[],a=this.getModel(!0);if(e){let l=new Set(Object.keys(e));this.allColumnFilters.forEach((c,d)=>{let u=e[d];s.push(this.setModelOnFilterWrapper(c,u)),l.delete(d)}),l.forEach(c=>{let d=n.getColDefCol(c)||n.getCol(c);if(!d){W(62,{colId:c});return}if(!d.isFilterAllowed()){W(63,{colId:c});return}let u=this.getOrCreateFilterWrapper(d,!0);if(!u){W(64,{colId:c});return}s.push(this.setModelOnFilterWrapper(u,e[c],!0))})}else this.model={},this.allColumnFilters.forEach(l=>{s.push(this.setModelOnFilterWrapper(l,null))});yt.all(s).then(()=>{let l=this.getModel(!0),c=[];this.allColumnFilters.forEach((d,u)=>{let h=a?a[u]:null,p=l?l[u]:null;hd(h,p)||c.push(d.column)}),c.length>0?r?.onFilterChanged({columns:c,source:t}):i&&this.updateActive("filterChanged")})}getModel(e){let t={},{allColumnFilters:i,initialModel:n,beans:{colModel:o}}=this;if(i.forEach((r,s)=>{let a=this.getModelFromFilterWrapper(r);ie(a)&&(t[s]=a)}),!e)for(let r of Object.keys(n)){let s=n[r];ie(s)&&!i.has(r)&&o.getCol(r)?.isFilterAllowed()&&(t[r]=s)}return t}setState(e,t,i="api"){if(this.state.clear(),t)for(let n of Object.keys(t)){let o=t[n];this.state.set(n,{model:Jt(this.model,n),state:o})}this.setModel(e,i,!0)}getState(){let e=this.state;if(!e.size)return;let t={},i=!1;return e.forEach((n,o)=>{let r=n.state;r!=null&&(i=!0,t[o]=r)}),i?t:void 0}getModelFromFilterWrapper(e){let i=e.column.getColId();if(e.isHandler)return Jt(this.model,i);let n=e.filter;return n?typeof n.getModel!="function"?(W(66),null):n.getModel():Jt(this.initialModel,i)}isFilterPresent(){return this.activeColumnFilters.length>0}isAggFilterPresent(){return!!this.activeAggregateFilters.length}disableFilters(){this.initialModel={};let{allColumnFilters:e}=this;return e.size?(e.forEach(t=>this.disposeFilterWrapper(t,"advancedFilterEnabled")),!0):!1}updateActiveFilters(){let e=c=>c?c.isFilterActive?c.isFilterActive():(W(67),!1):!1,{colModel:t,gos:i}=this.beans,n=!!mC(i),o=c=>{if(!c.isPrimary())return!0;let u=!t.isPivotActive();return!c.isValueActive()||!u?!1:t.isPivotMode()?!0:n},r=[],s=[],a=(c,d,u)=>{d&&(o(c)?r.push(u):s.push(u))},l=[];return this.allColumnFilters.forEach(c=>{let d=c.column,u=d.getColId();if(c.isHandler)l.push(yt.resolve().then(()=>{a(d,this.isHandlerActive(d),{colId:u,isHandler:!0,handler:c.handler,handlerParams:c.handlerParams})}));else{let h=qr(c);h&&l.push(h.then(p=>{a(d,e(p),{colId:u,isHandler:!1,comp:p})}))}}),yt.all(l).then(()=>{this.activeAggregateFilters=r,this.activeColumnFilters=s})}updateFilterFlagInColumns(e,t){let i=[];return this.allColumnFilters.forEach(n=>{let o=n.column;if(n.isHandler)i.push(yt.resolve().then(()=>{this.setColFilterActive(o,this.isHandlerActive(o),e,t)}));else{let r=qr(n);r&&i.push(r.then(s=>{this.setColFilterActive(o,s.isFilterActive(),e,t)}))}}),this.beans.groupFilter?.updateFilterFlags(e,t),yt.all(i)}doFiltersPass(e,t,i){let{data:n,aggData:o}=e,r=i?this.activeAggregateFilters:this.activeColumnFilters,s=i?o:n,a=this.model;for(let l=0;l<r.length;l++){let c=r[l],{colId:d,isHandler:u}=c;if(d!==t)if(u){let{handler:h,handlerParams:p}=c;if(!h.doesFilterPass({node:e,data:s,model:Jt(a,d),handlerParams:p}))return!1}else{let h=c.comp;if(typeof h.doesFilterPass!="function"){tt(91);continue}if(!h.doesFilterPass({node:e,data:s}))return!1}}return!0}getHandlerParams(e){let t=this.allColumnFilters.get(e.getColId());return t?.isHandler?t.handlerParams:void 0}callOnFilterChangedOutsideRenderCycle(e){let{rowRenderer:t,filterManager:i}=this.beans,n=()=>{this.isAlive()&&i?.onFilterChanged(e)};t.isRefreshInProgress()?setTimeout(n,0):n()}updateBeforeFilterChanged(e={}){let{column:t,additionalEventAttributes:i}=e,n=t?.getColId();return this.updateActiveFilters().then(()=>this.updateFilterFlagInColumns("filterChanged",i).then(()=>{this.allColumnFilters.forEach(o=>{let{column:r,isHandler:s}=o;n!==r.getColId()&&(s&&o.handler.onAnyFilterChanged?.(),qr(o,s)?.then(a=>{typeof a?.onAnyFilterChanged=="function"&&a.onAnyFilterChanged()}))}),this.processingFilterChange=!0}))}updateAfterFilterChanged(){this.processingFilterChange=!1}isSuppressFlashingCellsBecauseFiltering(){return!(this.gos.get("allowShowChangeAfterFilter")??!1)&&this.processingFilterChange}onNewRowsLoaded(e){let t=[];this.allColumnFilters.forEach(i=>{let n=i.isHandler;n&&i.handler.onNewRowsLoaded?.();let o=qr(i,n);o&&t.push(o.then(r=>{r.onNewRowsLoaded?.()}))}),yt.all(t).then(()=>this.updateActive(e,{afterDataChange:!0}))}updateActive(e,t){this.updateFilterFlagInColumns(e,t).then(()=>this.updateActiveFilters())}createGetValue(e,t){let{filterValueSvc:i,colModel:n}=this.beans;return(o,r)=>{let s=r?n.getCol(r):e;return s?i.getValue(s,o,t):void 0}}isFilterActive(e){let t=this.cachedFilter(e);if(t?.isHandler)return this.isHandlerActive(e);let i=t?.filter;return i?i.isFilterActive():Jt(this.initialModel,e.getColId())!=null}isHandlerActive(e){let t=ie(Jt(this.model,e.getColId()));if(t)return t;let i=this.beans.groupFilter;return i?.isGroupFilter(e)?i.isFilterActive(e):!1}getOrCreateFilterUi(e){let t=this.getOrCreateFilterWrapper(e,!0);return t?qr(t):null}getFilterUiForDisplay(e){let t=this.getOrCreateFilterWrapper(e,!0);if(!t)return null;let i=qr(t);return i?i.then(n=>({comp:n,params:t.filterUi.filterParams,isHandler:t.isHandler})):null}getHandler(e,t){let i=this.getOrCreateFilterWrapper(e,t);return i?.isHandler?i.handler:void 0}getOrCreateFilterWrapper(e,t){if(!e.isFilterAllowed())return;let i=this.cachedFilter(e);return!i&&t&&(i=this.createFilterWrapper(e),this.setColumnFilterWrapper(e,i)),i}cachedFilter(e){return this.allColumnFilters.get(e.getColId())}getDefaultFilter(e,t=!1){return this.getDefaultFilterFromDataType(()=>this.beans.dataTypeSvc?.getBaseDataType(e),t)}getDefaultFilterFromDataType(e,t=!1){return IL(this.gos)?t?"agSetColumnFloatingFilter":"agSetColumnFilter":yN(e(),t)}getDefaultFloatingFilter(e){return this.getDefaultFilter(e,!0)}createFilterComp(e,t,i,n,o,r){let s=()=>{let c=this.createFilterCompParams(e,o,r),d=n(c,o);return OO(this.beans.userCompFactory,t,d,i)},a=s();return a?{compDetails:a,createFilterUi:c=>(c?s():a).newAgStackInstance()}:null}createFilterInstance(e,t,i,n){let o=this.beans.selectableFilter;o?.isSelectable(t)&&(t=o.getFilterDef(e,t));let{handler:r,handlerParams:s,handlerGenerator:a}=this.createHandler(e,t,i)??{},l=this.createFilterComp(e,t,i,n,!!r,"init");if(!l)return{compDetails:null,createFilterUi:null,handler:r,handlerGenerator:a,handlerParams:s};let{compDetails:c,createFilterUi:d}=l;return this.isGlobalButtons&&(c.params?.buttons?.length||W(281,{colId:e.getColId()})),{compDetails:c,handler:r,handlerGenerator:a,handlerParams:s,createFilterUi:d}}createBaseFilterParams(e,t){let{filterManager:i,rowModel:n}=this.beans;return ye(this.gos,{column:e,colDef:e.getColDef(),getValue:this.createGetValue(e),doesRowPassOtherFilter:t?()=>!0:o=>i?.doesRowPassOtherFilters(e.getColId(),o)??!0,rowModel:n})}createFilterCompParams(e,t,i,n){let o=this.filterChangedCallbackFactory(e),r=this.createBaseFilterParams(e,n);if(r.filterChangedCallback=o,r.filterModifiedCallback=n?()=>{}:s=>this.filterModified(e,s),t){let s=r,a=e.getColId(),l=Jt(this.model,a);s.model=l,s.state=this.state.get(a)??{model:l},s.onModelChange=(c,d)=>{this.updateStoredModel(a,c),this.refreshHandlerAndUi(e,c,"ui",!1,d).then(()=>{o(z(b({},d),{source:"columnFilter"}))})},s.onStateChange=c=>{this.updateState(e,c),this.updateOrRefreshFilterUi(e)},s.onAction=(c,d,u)=>{this.updateModel(e,c,d),this.dispatchLocalEvent({type:"filterAction",column:e,action:c,event:u})},s.getHandler=()=>this.getHandler(e,!0),s.onUiChange=c=>this.filterUiChanged(e,c),s.source=i}return r}createFilterUiForHandler(e,t){return t?{created:!1,create:t,filterParams:e.params,compDetails:e}:null}createFilterUiLegacy(e,t,i){let n=t(),o={created:!0,create:t,filterParams:e.params,compDetails:e,promise:n};return n.then(i),o}createFilterWrapper(e){let{compDetails:t,handler:i,handlerGenerator:n,handlerParams:o,createFilterUi:r}=this.createFilterInstance(e,e.getColDef(),this.getDefaultFilter(e),a=>a),s=e.getColId();if(i)return delete this.initialModel[s],i.init?.(z(b({},o),{source:"init",model:Jt(this.model,s)})),{column:e,isHandler:!0,handler:i,handlerGenerator:n,handlerParams:o,filterUi:this.createFilterUiForHandler(t,r)};if(r){let a={column:e,filterUi:null,isHandler:!1};return a.filterUi=this.createFilterUiLegacy(t,r,l=>{a.filter=l??void 0}),a}return{column:e,filterUi:null,isHandler:!1}}createHandlerFunc(e,t,i){let{gos:n,frameworkOverrides:o,registry:r}=this.beans,s,a=p=>{let g=p.filter;if(KR(g)){let f=g.handler;return f||(s=g.doesFilterPass,s?()=>({doesFilterPass:s}):void 0)}return typeof g=="string"?g:void 0},l=n.get("enableFilterHandlers"),c=l?a(t):void 0,d=p=>()=>this.createBean(r.createDynamicBean(p,!0)),u,h;if(typeof c=="string"){let p=n.get("filterHandlers")?.[c];p!=null?u=p:cN.has(c)&&(u=d(c),h=c)}else u=c;if(!u){let p,{compName:g,jsComp:f,fwComp:m}=JR(o,t);g?p=g:f==null&&m==null&&t.filter===!0&&(p=i),h=this.handlerMap[p],h&&(u=d(h))}return u?{filterHandler:u,handlerNameOrCallback:s??h}:l?(Tt(n)&&W(277,{colId:e.getColId()}),kq):void 0}createHandler(e,t,i){let n=this.createHandlerFunc(e,t,i);if(!n)return;let o=Fv(this.beans.userCompFactory,t,this.createFilterCompParams(e,!0,"init")),{handlerNameOrCallback:r,filterHandler:s}=n,{handler:a,handlerParams:l}=this.createHandlerFromFunc(e,s,o);return{handler:a,handlerParams:l,handlerGenerator:r??s}}createHandlerFromFunc(e,t,i){let n=e.getColDef(),o=t(ye(this.gos,{column:e,colDef:n})),r=this.createHandlerParams(e,i);return{handler:o,handlerParams:r}}createHandlerParams(e,t){let i=e.getColDef(),n=e.getColId(),o=this.filterChangedCallbackFactory(e);return ye(this.gos,{colDef:i,column:e,getValue:this.createGetValue(e),doesRowPassOtherFilter:r=>this.beans.filterManager?.doesRowPassOtherFilters(n,r)??!0,onModelChange:(r,s)=>{this.updateStoredModel(n,r),this.refreshHandlerAndUi(e,r,"handler",!1,s).then(()=>{o(z(b({},s),{source:"columnFilter"}))})},filterParams:t})}onColumnsChanged(){let e=[],{colModel:t,filterManager:i,groupFilter:n}=this.beans;this.allColumnFilters.forEach((r,s)=>{let a;r.column.isPrimary()?a=t.getColDefCol(s):a=t.getCol(s),!(a&&a===r.column)&&(e.push(r.column),this.disposeFilterWrapper(r,"columnChanged"),this.disposeColumnListener(s))});let o=n&&e.every(r=>n.isGroupFilter(r));e.length>0&&!o&&i?.onFilterChanged({columns:e,source:"api"})}isFilterAllowed(e){if(!e.isFilterAllowed())return!1;let i=this.beans.groupFilter;return i?.isGroupFilter(e)?i.isFilterAllowed(e):!0}getFloatingFilterCompDetails(e,t){let{userCompFactory:i,frameworkOverrides:n,selectableFilter:o}=this.beans,r=h=>{let p=this.getOrCreateFilterUi(e);p?.then(g=>{h(bd(g))})},s=e.getColDef(),a=o?.isSelectable(s)?o.getFilterDef(e,s):s,l=RN(n,a,()=>this.getDefaultFloatingFilter(e))??"agReadOnlyFloatingFilter",c=this.gos.get("enableFilterHandlers"),d=Fv(i,a,this.createFilterCompParams(e,c,"init",!0)),u=ye(this.gos,{column:e,filterParams:d,currentParentModel:()=>this.getCurrentFloatingFilterParentModel(e),parentFilterInstance:r,showParentFilter:t});if(c){let h=u,p=e.getColId(),g=this.filterChangedCallbackFactory(e);h.onUiChange=f=>this.floatingFilterUiChanged(e,f),h.model=Jt(this.model,p),h.onModelChange=(f,m)=>{this.updateStoredModel(p,f),this.refreshHandlerAndUi(e,f,"floating",!0,m).then(()=>{g(z(b({},m),{source:"columnFilter"}))})},h.getHandler=()=>this.getHandler(e,!0),h.source="init"}return GO(i,s,u,l)}getCurrentFloatingFilterParentModel(e){return this.getModelFromFilterWrapper(this.cachedFilter(e)??{column:e})}destroyFilterUi(e,t,i,n){let o="paramsUpdated";if(e.isHandler){let r=t.getColId();delete this.initialModel[r],this.state.delete(r);let s=e.filterUi,a=this.createFilterUiForHandler(i,n);e.filterUi=a;let l=this.eventSvc;s?.created?s.promise.then(c=>{this.destroyBean(c),l.dispatchEvent({type:"filterDestroyed",source:o,column:t})}):l.dispatchEvent({type:"filterHandlerDestroyed",source:o,column:t})}else this.destroyFilter(t,o)}destroyFilter(e,t="api"){let i=e.getColId(),n=this.allColumnFilters.get(i);this.disposeColumnListener(i),delete this.initialModel[i],n&&this.disposeFilterWrapper(n,t).then(o=>{o&&this.isAlive()&&this.beans.filterManager?.onFilterChanged({columns:[e],source:"api"})})}disposeColumnListener(e){let t=this.allColumnListeners.get(e);t&&(this.allColumnListeners.delete(e),t())}disposeFilterWrapper(e,t){let i=!1,{column:n,isHandler:o,filterUi:r}=e,s=n.getColId();o&&(i=this.isHandlerActive(n),this.destroyBean(e.handler),delete this.model[s],this.state.delete(s));let a=()=>{this.setColFilterActive(n,!1,"filterDestroyed"),this.allColumnFilters.delete(s),this.eventSvc.dispatchEvent({type:"filterDestroyed",source:t,column:n})};if(r){if(r.created)return r.promise.then(l=>(i=o?i:!!l?.isFilterActive(),this.destroyBean(l),a(),i));a()}return yt.resolve(i)}filterChangedCallbackFactory(e){return t=>{this.callOnFilterChangedOutsideRenderCycle({additionalEventAttributes:t,columns:[e],column:e,source:t?.source??"columnFilter"})}}filterParamsChanged(e,t="api"){let i=this.allColumnFilters.get(e);if(!i)return;let n=this.beans,o=i.column,r=o.getColDef(),s=o.isFilterAllowed(),a=this.getDefaultFilter(o),l=n.selectableFilter,c=l?.isSelectable(r)?l.getFilterDef(o,r):r,d=s?this.createHandlerFunc(o,c,this.getDefaultFilter(o)):void 0,u=!!d,h=i.isHandler;if(h!=u){this.destroyFilter(o,"paramsUpdated");return}let{compDetails:p,createFilterUi:g}=(s?this.createFilterComp(o,c,a,m=>m,u,"colDef"):null)??{compDetails:null,createFilterUi:null},f=p?.params??Fv(n.userCompFactory,c,this.createFilterCompParams(o,u,"colDef"));if(h){let m=d?.handlerNameOrCallback??d?.filterHandler,v=Jt(this.model,e);if(i.handlerGenerator!=m){let C=i.handler,{handler:w,handlerParams:y}=this.createHandlerFromFunc(o,d.filterHandler,f);i.handler=w,i.handlerParams=y,i.handlerGenerator=m,delete this.model[e],w.init?.(z(b({},y),{source:"init",model:null})),this.destroyBean(C),v!=null&&this.beans.filterManager?.onFilterChanged({columns:[o],source:t})}else{let C=this.createHandlerParams(o,p?.params);i.handlerParams=C,i.handler.refresh?.(z(b({},C),{source:"colDef",model:v}))}}if(this.areFilterCompsDifferent(i.filterUi?.compDetails??null,p)||!i.filterUi||!p){this.destroyFilterUi(i,o,p,g);return}i.filterUi.filterParams=f,qr(i,h)?.then(m=>{(m?.refresh?m.refresh(f):!0)===!1?this.destroyFilterUi(i,o,p,g):this.dispatchLocalEvent({type:"filterParamsChanged",column:o,params:f})})}refreshHandlerAndUi(e,t,i,n,o){let r=this.cachedFilter(e);if(!r)return n&&this.getOrCreateFilterWrapper(e,!0),yt.resolve();if(!r.isHandler)return yt.resolve();let{filterUi:s,handler:a,handlerParams:l}=r;return dN(()=>{if(s){let{created:c,filterParams:d}=s;if(c)return s.promise.then(u=>u?{filter:u,filterParams:d}:void 0);s.refreshed=!0}return yt.resolve(void 0)},a,l,t,this.state.get(e.getColId())??{model:t},i,o)}setColumnFilterWrapper(e,t){let i=e.getColId();this.allColumnFilters.set(i,t),this.allColumnListeners.set(i,this.addManagedListeners(e,{colDefChanged:()=>this.filterParamsChanged(i)})[0])}areFilterCompsDifferent(e,t){if(!t||!e)return!0;let{componentClass:i}=e,{componentClass:n}=t;return!(i===n||i?.render&&n?.render&&i.render===n.render)}hasFloatingFilters(){return this.beans.colModel.getCols().some(t=>t.getColDef().floatingFilter)}getFilterInstance(e){let t=this.beans.colModel.getColDefCol(e);if(!t)return Promise.resolve(void 0);let i=this.getOrCreateFilterUi(t);return i?new Promise(n=>{i.then(o=>{n(bd(o))})}):Promise.resolve(null)}processFilterModelUpdateQueue(){this.modelUpdates.forEach(({model:e,source:t})=>this.setModel(e,t)),this.modelUpdates=[],this.columnModelUpdates.forEach(({key:e,model:t,resolve:i})=>{this.setModelForColumn(e,t).then(()=>i())}),this.columnModelUpdates=[]}getModelForColumn(e,t){if(t){let{state:n,model:o}=this,r=e.getColId(),s=n.get(r);return s?s.model??null:Jt(o,r)}let i=this.cachedFilter(e);return i?this.getModelFromFilterWrapper(i):null}setModelForColumn(e,t){if(this.beans.dataTypeSvc?.isPendingInference){let i=()=>{},n=new Promise(o=>{i=o});return this.columnModelUpdates.push({key:e,model:t,resolve:i}),n}return new Promise(i=>{this.setModelForColumnLegacy(e,t).then(n=>i(n))})}getStateForColumn(e){return this.state.get(e)??{model:Jt(this.model,e)}}setModelForColumnLegacy(e,t){let i=this.beans.colModel.getColDefCol(e),n=i?this.getOrCreateFilterWrapper(i,!0):null;return n?this.setModelOnFilterWrapper(n,t):yt.resolve()}setColDefPropsForDataType(e,t,i){let n=e.filter,o=n===!0?this.getDefaultFilterFromDataType(()=>t.baseDataType):n;if(typeof o!="string")return;let r,s,a=this.beans,{filterParams:l,filterValueGetter:c}=e;o==="agMultiColumnFilter"?{filterParams:r,filterValueGetter:s}=a.multiFilter?.getParamsForDataType(l,c,t,i)??{}:{filterParams:r,filterValueGetter:s}=CN(o,l,c,t,i,a,this.getLocaleTextFunc()),e.filterParams=r,s&&(e.filterValueGetter=s)}setColFilterActive(e,t,i,n){e.filterActive!==t&&(e.filterActive=t,e.dispatchColEvent("filterActiveChanged",i)),e.dispatchColEvent("filterChanged",i,n)}setModelOnFilterWrapper(e,t,i){return new yt(n=>{if(e.isHandler){let r=e.column,s=r.getColId(),a=this.model[s];if(this.updateStoredModel(s,t),i&&t===a){n();return}this.refreshHandlerAndUi(r,t,"api").then(()=>n());return}let o=qr(e);if(o){o.then(r=>{if(typeof r?.setModel!="function"){W(65),n();return}(r.setModel(t)||yt.resolve()).then(()=>n())});return}n()})}updateStoredModel(e,t){ie(t)?this.model[e]=t:delete this.model[e];let i=this.state.get(e),n={model:t,state:i?.state};this.state.set(e,n)}filterModified(e,t){this.getOrCreateFilterUi(e)?.then(i=>{this.eventSvc.dispatchEvent(b({type:"filterModified",column:e,filterInstance:i},t))})}filterUiChanged(e,t){this.gos.get("enableFilterHandlers")&&this.eventSvc.dispatchEvent(b({type:"filterUiChanged",column:e},t))}floatingFilterUiChanged(e,t){this.gos.get("enableFilterHandlers")&&this.eventSvc.dispatchEvent(b({type:"floatingFilterUiChanged",column:e},t))}updateModel(e,t,i){let n=e.getColId(),o=this.cachedFilter(e),r=()=>o?.filterUi;XE(t,r,()=>Jt(this.model,n),()=>this.state.get(n),s=>this.updateState(e,s),s=>r()?.filterParams?.onModelChange(s,i),o?.isHandler?o.handler.processModelToApply?.bind(o.handler):void 0)}updateAllModels(e,t){let i=[];this.allColumnFilters.forEach((n,o)=>{let r=this.beans.colModel.getColDefCol(o);r&&XE(e,()=>n.filterUi,()=>Jt(this.model,o),()=>this.state.get(o),s=>this.updateState(r,s),s=>{this.updateStoredModel(o,s),this.dispatchLocalEvent({type:"filterAction",column:r,action:e}),i.push(this.refreshHandlerAndUi(r,s,"ui"))},n?.isHandler?n.handler.processModelToApply?.bind(n.handler):void 0)}),i.length&&yt.all(i).then(()=>{this.callOnFilterChangedOutsideRenderCycle({source:"columnFilter",additionalEventAttributes:t,columns:[]})})}updateOrRefreshFilterUi(e){let t=e.getColId();yP(()=>this.cachedFilter(e)?.filterUi,()=>Jt(this.model,t),()=>this.state.get(t))}updateState(e,t){this.state.set(e.getColId(),t),this.dispatchLocalEvent({type:"filterStateChanged",column:e,state:t})}canApplyAll(){let{state:e,model:t,activeFilterComps:i}=this;for(let o of i)if(o.source==="COLUMN_MENU")return!1;let n=!1;for(let o of e.keys()){let r=e.get(o);if(r.valid===!1)return!1;(r.model??null)!==Jt(t,o)&&(n=!0)}return n}hasUnappliedModel(e){let{model:t,state:i}=this;return(i.get(e)?.model??null)!==Jt(t,e)}setGlobalButtons(e){this.isGlobalButtons=e,this.dispatchLocalEvent({type:"filterGlobalButtons",isGlobal:e})}shouldKeepStateOnDetach(e,t){if(t==="newFiltersToolPanel")return!0;let i=this.beans.filterPanelSvc;return i?.isActive?!!i.getState(e.getColId()):!1}destroy(){super.destroy(),this.allColumnFilters.forEach(e=>this.disposeFilterWrapper(e,"gridDestroyed")),this.allColumnListeners.clear(),this.state.clear(),this.activeFilterComps.clear()}};function Fq(e){return!!e.filterManager?.isAnyFilterPresent()}function Iq(e,t="api"){e.filterManager?.onFilterChanged({source:t})}var Aq=class extends A{constructor(){super(...arguments),this.beanName="filterManager",this.advFilterModelUpdateQueue=[]}wireBeans(e){this.quickFilter=e.quickFilter,this.advancedFilter=e.advancedFilter,this.colFilter=e.colFilter}postConstruct(){let e=this.refreshFiltersForAggregations.bind(this),t=this.updateAdvFilterColumns.bind(this);this.addManagedEventListeners({columnValueChanged:e,columnPivotChanged:e,columnPivotModeChanged:e,newColumnsLoaded:t,columnVisible:t,advancedFilterEnabledChanged:({enabled:n})=>this.onAdvFilterEnabledChanged(n),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.addManagedPropertyListeners(["isExternalFilterPresent","doesExternalFilterPass"],()=>{this.onFilterChanged({source:"api"})}),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",()=>{this.updateAggFiltering(),this.onFilterChanged()}),this.quickFilter&&this.addManagedListeners(this.quickFilter,{quickFilterChanged:()=>this.onFilterChanged({source:"quickFilter"})});let{gos:i}=this;this.alwaysPassFilter=i.get("alwaysPassFilter"),this.addManagedPropertyListener("alwaysPassFilter",()=>{this.alwaysPassFilter=i.get("alwaysPassFilter"),this.onFilterChanged({source:"api"})})}isExternalFilterPresentCallback(){let e=this.gos.getCallback("isExternalFilterPresent");return typeof e=="function"&&e({})}doesExternalFilterPass(e){let t=this.gos.get("doesExternalFilterPass");return typeof t=="function"&&t(e)}setFilterState(e,t,i="api"){this.isAdvFilterEnabled()||this.colFilter?.setState(e,t,i)}setFilterModel(e,t="api",i){if(this.isAdvFilterEnabled()){i||this.warnAdvFilters();return}this.colFilter?.setModel(e,t)}getFilterModel(){return this.colFilter?.getModel()??{}}getFilterState(){return this.colFilter?.getState()}isColumnFilterPresent(){return!!this.colFilter?.isFilterPresent()}isAggregateFilterPresent(){return!!this.colFilter?.isAggFilterPresent()}isChildFilterPresent(){return this.isColumnFilterPresent()||this.isQuickFilterPresent()||this.externalFilterPresent||this.isAdvFilterPresent()}isAnyFilterPresent(){return this.isChildFilterPresent()||this.isAggregateFilterPresent()}isAdvFilterPresent(){return this.isAdvFilterEnabled()&&this.advancedFilter.isFilterPresent()}onAdvFilterEnabledChanged(e){e?this.colFilter?.disableFilters()&&this.onFilterChanged({source:"advancedFilter"}):this.advancedFilter?.isFilterPresent()&&(this.advancedFilter.setModel(null),this.onFilterChanged({source:"advancedFilter"}))}isAdvFilterEnabled(){return!!this.advancedFilter?.isEnabled()}isAdvFilterHeaderActive(){return this.isAdvFilterEnabled()&&this.advancedFilter.isHeaderActive()}refreshFiltersForAggregations(){mC(this.gos)&&this.isAnyFilterPresent()&&this.onFilterChanged()}onFilterChanged(e={}){let{source:t,additionalEventAttributes:i,columns:n=[]}=e;this.externalFilterPresent=this.isExternalFilterPresentCallback(),(this.colFilter?this.colFilter.updateBeforeFilterChanged(e):yt.resolve()).then(()=>{let o={source:t,type:"filterChanged",columns:n};i&&Fi(o,i),this.eventSvc.dispatchEvent(o),this.colFilter?.updateAfterFilterChanged()})}isSuppressFlashingCellsBecauseFiltering(){return!!this.colFilter?.isSuppressFlashingCellsBecauseFiltering()}isQuickFilterPresent(){return!!this.quickFilter?.isFilterPresent()}updateAggFiltering(){this.aggFiltering=!!mC(this.gos)}isAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&this.shouldApplyQuickFilterAfterAgg()}isNonAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&!this.shouldApplyQuickFilterAfterAgg()}shouldApplyQuickFilterAfterAgg(){return(this.aggFiltering||this.beans.colModel.isPivotMode())&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")}doesRowPassOtherFilters(e,t){return this.doesRowPassFilter({rowNode:t,colIdToSkip:e})}doesRowPassAggregateFilters(e){let{rowNode:t}=e;return this.alwaysPassFilter?.(t)?!0:!(this.isAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(t)||this.isAggregateFilterPresent()&&!this.colFilter.doFiltersPass(t,e.colIdToSkip,!0))}doesRowPassFilter(e){let{rowNode:t}=e;return this.alwaysPassFilter?.(t)?!0:!(this.isNonAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(t)||this.externalFilterPresent&&!this.doesExternalFilterPass(t)||this.isColumnFilterPresent()&&!this.colFilter.doFiltersPass(t,e.colIdToSkip)||this.isAdvFilterPresent()&&!this.advancedFilter.doesFilterPass(t))}isFilterAllowed(e){return this.isAdvFilterEnabled()?!1:!!this.colFilter?.isFilterAllowed(e)}getAdvFilterModel(){return this.isAdvFilterEnabled()?this.advancedFilter.getModel():null}setAdvFilterModel(e,t="api"){if(this.isAdvFilterEnabled()){if(this.beans.dataTypeSvc?.isPendingInference){this.advFilterModelUpdateQueue.push(e);return}this.advancedFilter.setModel(e??null),this.onFilterChanged({source:t})}}toggleAdvFilterBuilder(e,t){this.isAdvFilterEnabled()&&this.advancedFilter.getCtrl().toggleFilterBuilder({source:t,force:e})}updateAdvFilterColumns(){this.isAdvFilterEnabled()&&this.advancedFilter.updateValidity()&&this.onFilterChanged({source:"advancedFilter"})}hasFloatingFilters(){return this.isAdvFilterEnabled()?!1:!!this.colFilter?.hasFloatingFilters()}getColumnFilterInstance(e){return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve(void 0)):this.colFilter?.getFilterInstance(e)??Promise.resolve(void 0)}warnAdvFilters(){W(68)}setupAdvFilterHeaderComp(e){this.advancedFilter?.getCtrl().setupHeaderComp(e)}getHeaderRowCount(){return this.isAdvFilterHeaderActive()?1:0}getHeaderHeight(){return this.isAdvFilterHeaderActive()?this.advancedFilter.getCtrl().getHeaderHeight():0}processFilterModelUpdateQueue(){for(let e of this.advFilterModelUpdateQueue)this.setAdvFilterModel(e);this.advFilterModelUpdateQueue=[]}setColumnFilterModel(e,t){return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve()):this.colFilter?.setModelForColumn(e,t)??Promise.resolve()}},Lq=class extends A{constructor(){super(...arguments),this.beanName="filterMenuFactory"}wireBeans(e){this.popupSvc=e.popupSvc}hideActiveMenu(){this.hidePopup?.()}showMenuAfterMouseEvent(e,t,i,n){e&&!e.isColumn||this.showPopup(e,o=>{this.popupSvc?.positionPopupUnderMouseEvent({column:e,type:i,mouseEvent:t,ePopup:o})},i,t.target,tn(this.gos),n)}showMenuAfterButtonClick(e,t,i,n){if(e&&!e.isColumn)return;let o=-1,r="left",s=tn(this.gos);!s&&this.gos.get("enableRtl")&&(o=1,r="right");let a=s?void 0:4*o,l=s?void 0:4;this.showPopup(e,c=>{this.popupSvc?.positionPopupByComponent({type:i,eventSource:t,ePopup:c,nudgeX:a,nudgeY:l,alignSide:r,keepWithinBounds:!0,position:"under",column:e})},i,t,s,n)}showPopup(e,t,i,n,o,r){let s=e?this.createBean(new mN(e,"COLUMN_MENU")):void 0;if(this.activeMenu=s,!s?.hasFilter()||!e){tt(57);return}let a=Ft({tag:"div",cls:`ag-menu${o?"":" ag-filter-menu"}`,role:"presentation"});[this.tabListener]=this.addManagedElementListeners(a,{keydown:f=>this.trapFocusWithin(f,a)}),a.appendChild(s?.getGui());let l,c=()=>s?.afterGuiDetached(),d=AL(this.gos)?n??this.beans.ctrlsSvc.getGridBodyCtrl().eGridBody:void 0,u=f=>{o_(e,!1,"contextMenu");let m=f instanceof KeyboardEvent;this.tabListener&&(this.tabListener=this.tabListener()),m&&n&&bo(n)&&nP(n)?.focus({preventScroll:!0}),c(),this.destroyBean(this.activeMenu),this.dispatchVisibleChangedEvent(!1,i,e),r?.()},h=this.getLocaleTextFunc(),p=o&&i!=="columnFilter"?h("ariaLabelColumnMenu","Column Menu"):h("ariaLabelColumnFilter","Column Filter"),g=this.popupSvc?.addPopup({modal:!0,eChild:a,closeOnEsc:!0,closedCallback:u,positionCallback:()=>t(a),anchorToElement:d,ariaLabel:p});g&&(this.hidePopup=l=g.hideFunc),s.afterInit().then(()=>{t(a),s.afterGuiAttached({container:i,hidePopup:l})}),o_(e,!0,"contextMenu"),this.dispatchVisibleChangedEvent(!0,i,e)}trapFocusWithin(e,t){e.key!==T.TAB||e.defaultPrevented||ha(this.beans,t,!1,e.shiftKey)||(e.preventDefault(),aa(t,e.shiftKey))}dispatchVisibleChangedEvent(e,t,i){this.eventSvc.dispatchEvent({type:"columnMenuVisibleChanged",visible:e,switchingTab:!1,key:t,column:i??null,columnGroup:null})}isMenuEnabled(e){return e.isFilterAllowed()&&(e.getColDef().menuTabs??["filterMenuTab"]).includes("filterMenuTab")}showMenuAfterContextMenuEvent(){}destroy(){this.destroyBean(this.activeMenu),super.destroy()}},Oq=class extends A{constructor(){super(...arguments),this.beanName="filterValueSvc"}getValue(e,t,i){if(!t)return;let n=e.getColDef(),{selectableFilter:o,valueSvc:r}=this.beans,s=i??o?.getFilterValueGetter(e.getColId())??n.filterValueGetter;return s?this.executeFilterValueGetter(s,t.data,e,t,n):r.getValue(e,t)}executeFilterValueGetter(e,t,i,n,o){let{expressionSvc:r,valueSvc:s}=this.beans,a=ye(this.gos,{data:t,node:n,column:i,colDef:o,getValue:s.getValueCallback.bind(s,n)});return typeof e=="function"?e(a):r?.evaluate(e,a)}},Nq={tag:"div",cls:"ag-floating-filter-input",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eFloatingFilterText"}]},Bq=class extends je{constructor(){super(Nq,[Zp]),this.eFloatingFilterText=Z}init(e){this.params=e;let t=this.beans.colNames.getDisplayNameForColumn(e.column,"header",!0);if(this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(`${t} ${this.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`),this.gos.get("enableFilterHandlers")){let i=e,n=i.getHandler();if(n.getModelAsString){let o=n.getModelAsString(i.model);this.eFloatingFilterText.setValue(o)}}}onParentModelChanged(e){if(e==null){this.eFloatingFilterText.setValue("");return}this.params.parentFilterInstance(t=>{if(t.getModelAsString){let i=t.getModelAsString(e);this.eFloatingFilterText.setValue(i)}})}refresh(e){this.init(e)}},Tw=class{constructor(){this.customFilterOptions={}}init(e,t){this.filterOptions=e.filterOptions??t,this.mapCustomOptions(),this.defaultOption=this.getDefaultItem(e.defaultOption)}refresh(e,t){let i=e.filterOptions??t;this.filterOptions!==i&&(this.filterOptions=i,this.customFilterOptions={},this.mapCustomOptions()),this.defaultOption=this.getDefaultItem(e.defaultOption)}mapCustomOptions(){let{filterOptions:e}=this;if(e)for(let t of e){if(typeof t=="string")continue;let i=[["displayKey"],["displayName"],["predicate","test"]],n=o=>o.some(r=>t[r]!=null)?!0:(W(72,{keys:o}),!1);if(!i.every(n)){this.filterOptions=e.filter(o=>o===t)||[];continue}this.customFilterOptions[t.displayKey]=t}}getDefaultItem(e){let{filterOptions:t}=this;if(e)return e;if(t.length>=1){let i=t[0];if(typeof i=="string")return i;if(i.displayKey)return i.displayKey;W(73)}else W(74)}getCustomOption(e){return this.customFilterOptions[e]}};function ud(e,t,i){return i==null?e.splice(t):e.splice(t,i)}function Kp(e){return e==null||typeof e=="string"&&e.trim().length===0}function Hq(e){return e==="AND"||e==="OR"?e:"AND"}function Vq(e,t,i){if(e==null)return;let{predicate:n}=e;if(n!=null&&!t.some(o=>o==null))return n(t,i)}function Gq(e,t){let i=e.length;return i>t&&(e.splice(t),W(78),i=t),i}function Ed(e,t){let i=t.getCustomOption(e);if(i){let{numberOfInputs:o}=i;return o??1}return e&&["empty","notBlank","blank"].indexOf(e)>=0?0:e==="inRange"?2:1}var Fw=class extends _N{constructor(e,t,i){super(e,"simple-filter"),this.mapValuesFromModel=t,this.defaultOptions=i,this.eTypes=[],this.eJoinPanels=[],this.eJoinAnds=[],this.eJoinOrs=[],this.eConditionBodies=[],this.listener=()=>this.onUiChanged(),this.lastUiCompletePosition=null,this.joinOperatorId=0}setParams(e){super.setParams(e);let t=new Tw;this.optionsFactory=t,t.init(e,this.defaultOptions),this.commonUpdateSimpleParams(e),this.createOption(),this.createMissingConditionsAndOperators()}updateParams(e,t){this.optionsFactory.refresh(e,this.defaultOptions),super.updateParams(e,t),this.commonUpdateSimpleParams(e)}commonUpdateSimpleParams(e){this.setNumConditions(e),this.defaultJoinOperator=Hq(e.defaultJoinOperator),this.filterPlaceholder=e.filterPlaceholder,this.createFilterListOptions();let t=this.getGui();this.isReadOnly()?t.setAttribute("tabindex","-1"):t.removeAttribute("tabindex")}onFloatingFilterChanged(e,t){this.setTypeFromFloatingFilter(e),this.setValueFromFloatingFilter(t),this.onUiChanged("immediately",!0)}setTypeFromFloatingFilter(e){this.eTypes.forEach((t,i)=>{let n=i===0?e:this.optionsFactory.defaultOption;t.setValue(n,!0)})}getModelFromUi(){let e=this.getUiCompleteConditions();return e.length===0?null:this.maxNumConditions>1&&e.length>1?{filterType:this.filterType,operator:this.getJoinOperator(),conditions:e}:e[0]}getConditionTypes(){return this.eTypes.map(e=>e.getValue())}getConditionType(e){return this.eTypes[e].getValue()}getJoinOperator(){let{eJoinOrs:e,defaultJoinOperator:t}=this;return e.length===0?t:e[0].getValue()===!0?"OR":"AND"}areNonNullModelsEqual(e,t){let i=!e.operator,n=!t.operator;if(!i&&n||i&&!n)return!1;let r;if(i){let s=e,a=t;r=this.areSimpleModelsEqual(s,a)}else{let s=e,a=t;r=s.operator===a.operator&&ns(s.conditions,a.conditions,(l,c)=>this.areSimpleModelsEqual(l,c))}return r}setModelIntoUi(e,t){if(e==null)return this.resetUiToDefaults(t),yt.resolve();if(e.operator){let n=e,o=n.conditions;o==null&&(o=[],W(77));let r=Gq(o,this.maxNumConditions),s=this.getNumConditions();if(r<s)this.removeConditionsAndOperators(r);else if(r>s)for(let l=s;l<r;l++)this.createJoinOperatorPanel(),this.createOption();let a=n.operator==="OR";this.eJoinAnds.forEach(l=>l.setValue(!a,!0)),this.eJoinOrs.forEach(l=>l.setValue(a,!0)),o.forEach((l,c)=>{this.eTypes[c].setValue(l.type,!0),this.setConditionIntoUi(l,c)})}else{let n=e;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(n.type,!0),this.setConditionIntoUi(n,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.updateUiVisibility(),t||this.params.onUiChange(this.getUiChangeEventParams()),yt.resolve()}setNumConditions(e){let t=e.maxNumConditions??2;t<1&&(W(79),t=1),this.maxNumConditions=t;let i=e.numAlwaysVisibleConditions??1;i<1&&(W(80),i=1),i>t&&(W(81),i=t),this.numAlwaysVisibleConditions=i}createOption(){let e=this.getGui(),t=this.createManagedBean(new cw);this.eTypes.push(t),t.addCss("ag-filter-select"),e.appendChild(t.getGui());let i=this.createEValue();this.eConditionBodies.push(i),e.appendChild(i),this.putOptionsIntoDropdown(t),this.resetType(t);let n=this.getNumConditions()-1;this.forEachPositionInput(n,o=>this.resetInput(o)),this.addChangedListeners(t,n)}createJoinOperatorPanel(){let e=Ft({tag:"div",cls:"ag-filter-condition"});this.eJoinPanels.push(e);let t=this.createJoinOperator(this.eJoinAnds,e,"and"),i=this.createJoinOperator(this.eJoinOrs,e,"or");this.getGui().appendChild(e);let n=this.eJoinPanels.length-1,o=this.joinOperatorId++;this.resetJoinOperatorAnd(t,n,o),this.resetJoinOperatorOr(i,n,o),this.isReadOnly()||(t.onValueChange(this.listener),i.onValueChange(this.listener))}createJoinOperator(e,t,i){let n=this.createManagedBean(new i9);e.push(n);let o="ag-filter-condition-operator";return n.addCss(o),n.addCss(`${o}-${i}`),t.appendChild(n.getGui()),n}createFilterListOptions(){this.filterListOptions=this.optionsFactory.filterOptions.map(e=>typeof e=="string"?this.createBoilerplateListOption(e):this.createCustomListOption(e))}putOptionsIntoDropdown(e){let{filterListOptions:t}=this;for(let i of t)e.addOption(i);e.setDisabled(t.length<=1)}createBoilerplateListOption(e){return{value:e,text:this.translate(e)}}createCustomListOption(e){let{displayKey:t}=e,i=this.optionsFactory.getCustomOption(e.displayKey);return{value:t,text:i?this.getLocaleTextFunc()(i.displayKey,i.displayName):this.translate(t)}}createBodyTemplate(){return null}getAgComponents(){return[]}updateUiVisibility(){let e=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,e)}updateNumConditions(){let e=-1,t=!0;for(let i=0;i<this.getNumConditions();i++)this.isConditionUiComplete(i)?e=i:t=!1;if(this.shouldAddNewConditionAtEnd(t))this.createJoinOperatorPanel(),this.createOption();else{let i=this.lastUiCompletePosition??this.getNumConditions()-2;if(e<i){this.removeConditionsAndOperators(i+1);let n=e+1,o=i-n;o>0&&this.removeConditionsAndOperators(n,o),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=e}updateConditionStatusesAndValues(e,t){this.eTypes.forEach((n,o)=>{let r=this.isConditionDisabled(o,e);n.setDisabled(r||this.filterListOptions.length<=1),o===1&&(gd(this.eJoinPanels[0],r),this.eJoinAnds[0].setDisabled(r),this.eJoinOrs[0].setDisabled(r))}),this.eConditionBodies.forEach((n,o)=>{ft(n,this.isConditionBodyVisible(o))});let i=(t??this.getJoinOperator())==="OR";for(let n of this.eJoinAnds)n.setValue(!i,!0);for(let n of this.eJoinOrs)n.setValue(i,!0);this.forEachInput((n,o,r,s)=>{this.setElementDisplayed(n,o<s),this.setElementDisabled(n,this.isConditionDisabled(r,e))}),this.resetPlaceholder()}shouldAddNewConditionAtEnd(e){return e&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}removeConditionsAndOperators(e,t){if(e>=this.getNumConditions())return;let{eTypes:i,eConditionBodies:n,eJoinPanels:o,eJoinAnds:r,eJoinOrs:s}=this;this.removeComponents(i,e,t),this.removeElements(n,e,t),this.removeEValues(e,t);let a=Math.max(e-1,0);this.removeElements(o,a,t),this.removeComponents(r,a,t),this.removeComponents(s,a,t)}removeElements(e,t,i){let n=ud(e,t,i);for(let o of n)zi(o)}removeComponents(e,t,i){let n=ud(e,t,i);for(let o of n)zi(o.getGui()),this.destroyBean(o)}afterGuiAttached(e){if(super.afterGuiAttached(e),this.resetPlaceholder(),!e?.suppressFocus){let t;if(!this.isReadOnly()){let i=this.getInputs(0)[0];i instanceof Js&&this.isConditionBodyVisible(0)?t=i.getInputElement():t=this.eTypes[0]?.getFocusableElement()}(t??this.getGui()).focus({preventScroll:!0})}}afterGuiDetached(){super.afterGuiDetached();let e=this.params;if(this.beans.colFilter?.shouldKeepStateOnDetach(e.column))return;e.onStateChange({model:e.model});let t=-1,i=-1,n=!1,o=this.getJoinOperator();for(let s=this.getNumConditions()-1;s>=0;s--)if(this.isConditionUiComplete(s))t===-1&&(t=s,i=s);else{let a=s>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(s-1),l=s<t;(a||l)&&(this.removeConditionsAndOperators(s,1),n=!0,l&&i--)}let r=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),r=!0),this.shouldAddNewConditionAtEnd(i===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),r=!0),r&&this.updateConditionStatusesAndValues(i,o),n&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=i}getModelAsString(e){return this.params.getHandler()?.getModelAsString?.(e)??""}getPlaceholderText(e,t){let i=this.translate(e);if(typeof this.filterPlaceholder=="function"){let n=this.eTypes[t].getValue(),o=this.translate(n);i=this.filterPlaceholder({filterOptionKey:n,filterOption:o,placeholder:i})}else typeof this.filterPlaceholder=="string"&&(i=this.filterPlaceholder);return i}resetPlaceholder(){let e=this.getLocaleTextFunc();this.forEachInput((t,i,n,o)=>{if(!(t instanceof Js))return;let r=i===0&&o>1?"inRangeStart":i===0?"filterOoo":"inRangeEnd",s=i===0&&o>1?e("ariaFilterFromValue","Filter from value"):i===0?e("ariaFilterValue","Filter Value"):e("ariaFilterToValue","Filter to Value");t.setInputPlaceholder(this.getPlaceholderText(r,n)),t.setInputAriaLabel(s)})}setElementValue(e,t,i){e instanceof Js&&e.setValue(t!=null?String(t):null,!0)}setElementDisplayed(e,t){HE(e)&&ft(e.getGui(),t)}setElementDisabled(e,t){HE(e)&&gd(e.getGui(),t)}attachElementOnChange(e,t){e instanceof Js&&e.onValueChange(t)}forEachInput(e){this.getConditionTypes().forEach((t,i)=>{this.forEachPositionTypeInput(i,t,e)})}forEachPositionInput(e,t){let i=this.getConditionType(e);this.forEachPositionTypeInput(e,i,t)}forEachPositionTypeInput(e,t,i){let n=Ed(t,this.optionsFactory),o=this.getInputs(e);for(let r=0;r<o.length;r++){let s=o[r];s!=null&&i(s,r,e,n)}}isConditionDisabled(e,t){return this.isReadOnly()?!0:e===0?!1:e>t+1}isConditionBodyVisible(e){let t=this.getConditionType(e);return Ed(t,this.optionsFactory)>0}isConditionUiComplete(e){return!(e>=this.getNumConditions()||this.getConditionType(e)==="empty"||this.getValues(e).some(i=>i==null))}getNumConditions(){return this.eTypes.length}getUiCompleteConditions(){let e=[];for(let t=0;t<this.getNumConditions();t++)this.isConditionUiComplete(t)&&e.push(this.createCondition(t));return e}createMissingConditionsAndOperators(){if(!this.isReadOnly())for(let e=this.getNumConditions();e<this.numAlwaysVisibleConditions;e++)this.createJoinOperatorPanel(),this.createOption()}resetUiToDefaults(e){this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach(t=>this.resetType(t)),this.eJoinAnds.forEach((t,i)=>this.resetJoinOperatorAnd(t,i,this.joinOperatorId+i)),this.eJoinOrs.forEach((t,i)=>this.resetJoinOperatorOr(t,i,this.joinOperatorId+i)),this.joinOperatorId++,this.forEachInput(t=>this.resetInput(t)),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,this.updateUiVisibility(),e||this.params.onUiChange(this.getUiChangeEventParams())}resetType(e){let i=this.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");e.setValue(this.optionsFactory.defaultOption,!0).setAriaLabel(i).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}resetJoinOperatorAnd(e,t,i){this.resetJoinOperator(e,t,this.defaultJoinOperator==="AND",this.translate("andCondition"),i)}resetJoinOperatorOr(e,t,i){this.resetJoinOperator(e,t,this.defaultJoinOperator==="OR",this.translate("orCondition"),i)}resetJoinOperator(e,t,i,n,o){this.updateJoinOperatorDisabled(e.setValue(i,!0).setName(`ag-simple-filter-and-or-${this.getCompId()}-${o}`).setLabel(n),t)}updateJoinOperatorsDisabled(){let e=(t,i)=>this.updateJoinOperatorDisabled(t,i);this.eJoinAnds.forEach(e),this.eJoinOrs.forEach(e)}updateJoinOperatorDisabled(e,t){e.setDisabled(this.isReadOnly()||t>0)}resetInput(e){this.setElementValue(e,null),this.setElementDisabled(e,this.isReadOnly())}setConditionIntoUi(e,t){let i=this.mapValuesFromModel(e,this.optionsFactory);this.forEachInput((n,o,r)=>{r===t&&this.setElementValue(n,i[o]!=null?i[o]:null)})}setValueFromFloatingFilter(e){this.forEachInput((t,i,n)=>{this.setElementValue(t,i===0&&n===0?e:null,!0)})}addChangedListeners(e,t){this.isReadOnly()||(e.onValueChange(this.listener),this.forEachPositionInput(t,i=>{this.attachElementOnChange(i,this.listener)}))}hasInvalidInputs(){return!1}isReadOnly(){return!!this.params.readOnly}},DD=class{constructor(e,t,i,n,o,r){this.alive=!0,this.context=e,this.eParent=o;let s=NO(t,i,n);s&&s.newAgStackInstance().then(a=>{if(!this.alive){e.destroyBean(a);return}if(this.dateComp=a,!a)return;o.appendChild(a.getGui()),a?.afterGuiAttached?.();let{tempValue:l,disabled:c}=this;l&&a.setDate(l),c!=null&&a.setDisabled?.(c),r?.(this)})}destroy(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)}getDate(){return this.dateComp?this.dateComp.getDate():this.tempValue}setDate(e){let t=this.dateComp;t?t.setDate(e):this.tempValue=e}setDisabled(e){let t=this.dateComp;t?t.setDisabled?.(e):this.disabled=e}setDisplayed(e){ft(this.eParent,e)}setInputPlaceholder(e){this.dateComp?.setInputPlaceholder?.(e)}setInputAriaLabel(e){this.dateComp?.setInputAriaLabel?.(e)}afterGuiAttached(e){this.dateComp?.afterGuiAttached?.(e)}updateParams(e){this.dateComp?.refresh?.(e)}},Iw=["equals","notEqual","lessThan","greaterThan","inRange","blank","notBlank"];function MD(e,t){let{dateFrom:i,dateTo:n,type:o}=e||{};return[i&&Wi(i,void 0,!0)||null,n&&Wi(n,void 0,!0)||null].slice(0,Ed(o,t))}var H_=1e3,V_=1/0,zq=class extends Fw{constructor(){super("dateFilter",MD,Iw),this.eConditionPanelsFrom=[],this.eConditionPanelsTo=[],this.dateConditionFromComps=[],this.dateConditionToComps=[],this.minValidYear=H_,this.maxValidYear=V_,this.minValidDate=null,this.maxValidDate=null,this.filterType="date"}afterGuiAttached(e){super.afterGuiAttached(e),this.dateConditionFromComps[0].afterGuiAttached(e)}commonUpdateSimpleParams(e){super.commonUpdateSimpleParams(e);let t=(l,c)=>{let d=e[l];if(d!=null)if(isNaN(d))W(82,{param:l});else return d==null?c:Number(d);return c},i=t("minValidYear",H_),n=t("maxValidYear",V_);this.minValidYear=i,this.maxValidYear=n,i>n&&W(83);let{minValidDate:o,maxValidDate:r}=e,s=o instanceof Date?o:Wi(o);this.minValidDate=s;let a=r instanceof Date?r:Wi(r);this.maxValidDate=a,s&&a&&s>a&&W(84)}createDateCompWrapper(e){let{beans:{userCompFactory:t,context:i,gos:n},params:o}=this,r=new DD(i,t,o.colDef,ye(n,{onDateChanged:()=>this.onUiChanged(),filterParams:o,location:"filter"}),e);return this.addDestroyFunc(()=>r.destroy()),r}setElementValue(e,t){e.setDate(t)}setElementDisplayed(e,t){e.setDisplayed(t)}setElementDisabled(e,t){e.setDisabled(t)}createEValue(){let e=Ft({tag:"div",cls:"ag-filter-body"});return this.createFromToElement(e,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(e,this.eConditionPanelsTo,this.dateConditionToComps,"to"),e}createFromToElement(e,t,i,n){let o=Ft({tag:"div",cls:`ag-filter-${n} ag-filter-date-${n}`});t.push(o),e.appendChild(o),i.push(this.createDateCompWrapper(o))}removeEValues(e,t){this.removeDateComps(this.dateConditionFromComps,e,t),this.removeDateComps(this.dateConditionToComps,e,t),ud(this.eConditionPanelsFrom,e,t),ud(this.eConditionPanelsTo,e,t)}removeDateComps(e,t,i){let n=ud(e,t,i);for(let o of n)o.destroy()}isValidDateValue(e){if(e===null)return!1;let{minValidDate:t,maxValidDate:i,minValidYear:n,maxValidYear:o}=this;if(t){if(e<t)return!1}else if(e.getUTCFullYear()<n)return!1;if(i){if(e>i)return!1}else if(e.getUTCFullYear()>o)return!1;return!0}isConditionUiComplete(e){if(!super.isConditionUiComplete(e))return!1;let t=!0;return this.forEachInput((i,n,o,r)=>{o!==e||!t||n>=r||(t=t&&this.isValidDateValue(i.getDate()))}),t}areSimpleModelsEqual(e,t){return e.dateFrom===t.dateFrom&&e.dateTo===t.dateTo&&e.type===t.type}createCondition(e){let t=this.getConditionType(e),i={},n=this.getValues(e),o=this.params.useIsoSeparator?"T":" ";return n.length>0&&(i.dateFrom=nn(n[0],!0,o)),n.length>1&&(i.dateTo=nn(n[1],!0,o)),b({dateFrom:null,dateTo:null,filterType:this.filterType,type:t},i)}resetPlaceholder(){let e=this.getLocaleTextFunc(),t=this.translate("dateFormatOoo"),i=e("ariaFilterValue","Filter Value");this.forEachInput(n=>{n.setInputPlaceholder(t),n.setInputAriaLabel(i)})}getInputs(e){let{dateConditionFromComps:t,dateConditionToComps:i}=this;return e>=t.length?[null,null]:[t[e],i[e]]}getValues(e){let t=[];return this.forEachPositionInput(e,(i,n,o,r)=>{n<r&&t.push(i.getDate())}),t}translate(e){return e==="lessThan"?super.translate("before"):e==="greaterThan"?super.translate("after"):super.translate(e)}},kD=class extends A{constructor(e,t){super(),this.mapValuesFromModel=e,this.defaultOptions=t}init(e){let t=e.filterParams,i=new Tw;this.optionsFactory=i,i.init(t,this.defaultOptions),this.filterModelFormatter=this.createManagedBean(new this.FilterModelFormatterClass(i,t)),this.updateParams(e),this.validateModel(e)}refresh(e){if(e.source==="colDef"){let t=e.filterParams,i=this.optionsFactory;i.refresh(t,this.defaultOptions),this.filterModelFormatter.updateParams({optionsFactory:i,filterParams:t}),this.updateParams(e)}this.validateModel(e)}updateParams(e){this.params=e}doesFilterPass(e){let t=e.model;if(t==null)return!0;let{operator:i}=t,n=[];if(i){let s=t;n.push(...s.conditions??[])}else n.push(t);let o=i&&i==="OR"?"some":"every",r=this.params.getValue(e.node);return n[o](s=>this.individualConditionPasses(e,s,r))}getModelAsString(e,t){return this.filterModelFormatter.getModelAsString(e,t)??""}validateModel(e){let{model:t,filterParams:{filterOptions:i,maxNumConditions:n}}=e;if(t==null)return;let r=EP(t)?t.conditions:[t],s=i?.map(d=>typeof d=="string"?d:d.displayKey)??this.defaultOptions;if(!(!r||r.every(d=>s.find(u=>u===d.type)!==void 0))){this.params=z(b({},e),{model:null}),e.onModelChange(null);return}let l=!1,c=this.filterType;if((r&&!r.every(d=>d.filterType===c)||t.filterType!==c)&&(r=r.map(d=>z(b({},d),{filterType:c})),l=!0),typeof n=="number"&&r&&r.length>n&&(r=r.slice(0,n),l=!0),l){let d=r.length>1?z(b({},t),{filterType:c,conditions:r}):z(b({},r[0]),{filterType:c});this.params=z(b({},e),{model:d}),e.onModelChange(d)}}individualConditionPasses(e,t,i){let n=this.optionsFactory,o=this.mapValuesFromModel(t,n),r=n.getCustomOption(t.type),s=Vq(r,o,i);return s??(i==null?this.evaluateNullValue(t.type):this.evaluateNonNullValue(o,i,t,e))}},TD=class extends kD{evaluateNullValue(e){let{includeBlanksInEquals:t,includeBlanksInNotEqual:i,includeBlanksInGreaterThan:n,includeBlanksInLessThan:o,includeBlanksInRange:r}=this.params.filterParams;switch(e){case"equals":if(t)return!0;break;case"notEqual":if(i)return!0;break;case"greaterThan":case"greaterThanOrEqual":if(n)return!0;break;case"lessThan":case"lessThanOrEqual":if(o)return!0;break;case"inRange":if(r)return!0;break;case"blank":return!0;case"notBlank":return!1}return!1}evaluateNonNullValue(e,t,i){let n=i.type;if(!this.isValid(t))return n==="notEqual"||n==="notBlank";let o=this.comparator(),r=e[0]!=null?o(e[0],t):0;switch(n){case"equals":return r===0;case"notEqual":return r!==0;case"greaterThan":return r>0;case"greaterThanOrEqual":return r>=0;case"lessThan":return r<0;case"lessThanOrEqual":return r<=0;case"inRange":{let s=o(e[1],t);return this.params.filterParams.inRangeInclusive?r>=0&&s<=0:r>0&&s<0}case"blank":return Kp(t);case"notBlank":return!Kp(t);default:return W(76,{filterModelType:n}),!0}}},FD={equals:"Equals",notEqual:"NotEqual",greaterThan:"GreaterThan",greaterThanOrEqual:"GreaterThanOrEqual",lessThan:"LessThan",lessThanOrEqual:"LessThanOrEqual",inRange:"InRange"},Wq={contains:"Contains",notContains:"NotContains",equals:"TextEquals",notEqual:"TextNotEqual",startsWith:"StartsWith",endsWith:"EndsWith",inRange:"InRange"},Aw=class extends A{constructor(e,t,i){super(),this.optionsFactory=e,this.filterParams=t,this.valueFormatter=i}getModelAsString(e,t){let i=this.getLocaleTextFunc(),n=t==="filterToolPanel";if(!e)return n?Xr(this,"filterSummaryInactive"):null;if(e.operator!=null){let r=e,a=(r.conditions??[]).map(c=>this.getModelAsString(c,t)),l=r.operator==="AND"?"andCondition":"orCondition";return a.join(` ${Xr(this,l)} `)}else{if(e.type==="blank"||e.type==="notBlank")return n?Xr(this,e.type==="blank"?"filterSummaryBlank":"filterSummaryNotBlank"):i(e.type,e.type);{let r=e,s=this.optionsFactory.getCustomOption(r.type),{displayKey:a,displayName:l,numberOfInputs:c}=s||{};return a&&l&&c===0?i(a,l):this.conditionToString(r,n,r.type==="inRange"||c===2,a,l)}}}updateParams(e){let{optionsFactory:t,filterParams:i}=e;this.optionsFactory=t,this.filterParams=i}conditionForToolPanel(e,t,i,n,o,r){let s,a=this.getTypeKey(e);return a&&(s=Xr(this,a)),o&&r&&(s=this.getLocaleTextFunc()(o,r)),s!=null?t?`${s} ${Xr(this,"filterSummaryInRangeValues",[i(),n()])}`:`${s} ${i()}`:null}getTypeKey(e){let t=this.filterTypeKeys[e];return t?`filterSummary${t}`:null}formatValue(e){let t=this.valueFormatter;return t?t(e??null)??"":String(e)}},ID=class extends Aw{constructor(e,t){super(e,t,i=>{let{dataTypeSvc:n,valueSvc:o}=this.beans,r=t.column,s=n?.getDateFormatterFunction(r),a=s?s(i??void 0):i;return o.formatValue(r,null,a)}),this.filterTypeKeys=FD}conditionToString(e,t,i,n,o){let{type:r}=e,s=Wi(e.dateFrom),a=Wi(e.dateTo),l=this.filterParams.inRangeFloatingFilterDateFormat,c=t?this.formatValue.bind(this):h=>SC(h,l),d=()=>s!==null?c(s):"null",u=()=>a!==null?c(a):"null";if(t){let h=this.conditionForToolPanel(r,i,d,u,n,o);if(h!=null)return h}return i?`${d()}-${u()}`:s!=null?c(s):`${r}`}};function Uq(e,t){let i=t;return i<e?-1:i>e?1:0}var qq=class extends TD{constructor(){super(MD,Iw),this.filterType="date",this.FilterModelFormatterClass=ID}comparator(){return this.params.filterParams.comparator??Uq}isValid(e){let t=this.params.filterParams.isValidDate;return!t||t(e)}},AD=class extends je{constructor(){super(...arguments),this.defaultDebounceMs=0}setLastTypeFromModel(e){if(!e){this.lastType=this.optionsFactory.defaultOption;return}let t=e.operator,i;t?i=e.conditions[0]:i=e,this.lastType=i.type}canWeEditAfterModelFromParentFilter(e){if(!e)return this.isTypeEditable(this.lastType);if(e.operator)return!1;let i=e;return this.isTypeEditable(i.type)}init(e){this.params=e;let t=this.gos.get("enableFilterHandlers");if(this.reactive=t,this.setParams(e),t){let i=e;this.onModelUpdated(i.model)}}setParams(e){let t=new Tw;this.optionsFactory=t,t.init(e.filterParams,this.defaultOptions),this.filterModelFormatter=this.createManagedBean(new this.FilterModelFormatterClass(t,e.filterParams)),this.setSimpleParams(e,!1)}setSimpleParams(e,t=!0){let i=this.optionsFactory.defaultOption;t||(this.lastType=i),this.readOnly=!!e.filterParams.readOnly;let n=this.isTypeEditable(i);this.setEditable(n)}refresh(e){this.params=e;let t=e,i=this.reactive;if((!i||t.source==="colDef")&&this.updateParams(e),i){let{source:n,model:o}=t;if(n==="dataChanged"||n==="ui")return;this.onModelUpdated(o)}}updateParams(e){let t=this.optionsFactory;t.refresh(e.filterParams,this.defaultOptions),this.setSimpleParams(e),this.filterModelFormatter.updateParams({optionsFactory:t,filterParams:e.filterParams})}onParentModelChanged(e,t){t?.afterFloatingFilter||t?.afterDataChange||this.onModelUpdated(e)}hasSingleInput(e){let t=this.optionsFactory.getCustomOption(e)?.numberOfInputs;return t==null||t==1}isTypeEditable(e){let t=["inRange","empty","blank","notBlank"];return!!e&&!this.readOnly&&this.hasSingleInput(e)&&t.indexOf(e)<0}getAriaLabel(e){return`${this.beans.colNames.getDisplayNameForColumn(e.column,"header",!0)} ${this.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`}},$q={tag:"div",cls:"ag-floating-filter-input",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eReadOnlyText"},{tag:"div",ref:"eDateWrapper",cls:"ag-date-floating-filter-wrapper"}]},jq=class extends AD{constructor(){super($q,[Zp]),this.eReadOnlyText=Z,this.eDateWrapper=Z,this.FilterModelFormatterClass=ID,this.filterType="date",this.defaultOptions=Iw}setParams(e){super.setParams(e),this.createDateComponent();let t=this.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(t("ariaDateFilterInput","Date Filter Input"))}updateParams(e){super.updateParams(e),this.dateComp.updateParams(this.getDateComponentParams()),this.updateCompOnModelChange(e.currentParentModel())}updateCompOnModelChange(e){let t=!this.readOnly&&this.canWeEditAfterModelFromParentFilter(e);if(this.setEditable(t),t){let i=e?Wi(e.dateFrom):null;this.dateComp.setDate(i),this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(e)),this.dateComp.setDate(null)}setEditable(e){ft(this.eDateWrapper,e),ft(this.eReadOnlyText.getGui(),!e)}onModelUpdated(e){super.setLastTypeFromModel(e),this.updateCompOnModelChange(e)}onDateChanged(){let e=this.dateComp.getDate();if(this.reactive){let t=this.params;t.onUiChange();let i=t.model,n=nn(e),o=n==null?null:z(b({},i??{filterType:this.filterType,type:this.lastType??this.optionsFactory.defaultOption}),{dateFrom:n});t.onModelChange(o,{afterFloatingFilter:!0})}else this.params.parentFilterInstance(t=>{t?.onFloatingFilterChanged(this.lastType||null,e)})}getDateComponentParams(){let{filterParams:e}=this.params,t=gw(e,this.defaultDebounceMs);return ye(this.gos,{onDateChanged:si(this,this.onDateChanged.bind(this),t),filterParams:e,location:"floatingFilter"})}createDateComponent(){let{beans:{context:e,userCompFactory:t},eDateWrapper:i,params:n}=this;this.dateComp=new DD(e,t,n.column.getColDef(),this.getDateComponentParams(),i,o=>{o.setInputAriaLabel(this.getAriaLabel(n))}),this.addDestroyFunc(()=>this.dateComp.destroy())}},Kq={tag:"div",cls:"ag-filter-filter",children:[{tag:"ag-input-text-field",ref:"eDateInput",cls:"ag-date-filter"}]},Yq=class extends je{constructor(){super(Kq,[Zp]),this.eDateInput=Z,this.isApply=!1,this.applyOnFocusOut=!1}init(e){this.params=e,this.setParams(e);let t=this.eDateInput.getInputElement();this.addManagedListeners(t,{mouseDown:()=>{this.eDateInput.isDisabled()||this.usingSafariDatePicker||t.focus({preventScroll:!0})},input:this.handleInput.bind(this,!1),change:this.handleInput.bind(this,!0),focusout:this.handleFocusOut.bind(this)})}handleInput(e){if(!this.eDateInput.isDisabled()){if(this.isApply){this.applyOnFocusOut=!e,e&&this.params.onDateChanged();return}e||this.params.onDateChanged()}}handleFocusOut(){this.applyOnFocusOut&&(this.applyOnFocusOut=!1,this.params.onDateChanged())}setParams(e){let t=this.eDateInput.getInputElement(),i=this.shouldUseBrowserDatePicker(e);this.usingSafariDatePicker=i&&rs();let{minValidYear:n,maxValidYear:o,minValidDate:r,maxValidDate:s,buttons:a,includeTime:l,colDef:c}=e.filterParams||{},d=this.beans.dataTypeSvc,u=l??d?.getDateIncludesTimeFlag?.(c.cellDataType)??!1;if(i?u?(t.type="datetime-local",t.step="1"):t.type="date":t.type="text",r&&n&&W(85),s&&o&&W(86),r&&s){let[h,p]=[r,s].map(g=>g instanceof Date?g:Wi(g));h&&p&&h.getTime()>p.getTime()&&W(87)}r?r instanceof Date?t.min=SC(r):t.min=r:n&&(t.min=`${n}-01-01`),s?s instanceof Date?t.max=SC(s):t.max=s:o&&(t.max=`${o}-12-31`),this.isApply=e.location==="floatingFilter"&&!!a?.includes("apply")}refresh(e){this.params=e,this.setParams(e)}getDate(){return Wi(this.eDateInput.getValue())}setDate(e){let t=this.params.filterParams.colDef.cellDataType,i=this.beans.dataTypeSvc?.getDateIncludesTimeFlag(t)??!1;this.eDateInput.setValue(nn(e,i))}setInputPlaceholder(e){this.eDateInput.setInputPlaceholder(e)}setInputAriaLabel(e){this.eDateInput.setAriaLabel(e)}setDisabled(e){this.eDateInput.setDisabled(e)}afterGuiAttached(e){e?.suppressFocus||this.eDateInput.getInputElement().focus({preventScroll:!0})}shouldUseBrowserDatePicker(e){return e?.filterParams?.browserDatePicker??!0}},Lw=["equals","notEqual","greaterThan","greaterThanOrEqual","lessThan","lessThanOrEqual","inRange","blank","notBlank"];function GC(e){let{allowedCharPattern:t}=e??{};return t??null}function zC(e){return e==null||isNaN(e)?null:e}function LD(e,t){let{filter:i,filterTo:n,type:o}=e||{};return[zC(i),zC(n)].slice(0,Ed(o,t))}var Xq=class extends Fw{constructor(){super("numberFilter",LD,Lw),this.eValuesFrom=[],this.eValuesTo=[],this.filterType="number",this.defaultDebounceMs=500}setElementValue(e,t,i){let{numberFormatter:n}=this.params,o=!i&&n?n(t??null):t;super.setElementValue(e,o)}createEValue(){let e=GC(this.params),t=Ft({tag:"div",cls:"ag-filter-body",role:"presentation"});return this.createFromToElement(t,this.eValuesFrom,"from",e),this.createFromToElement(t,this.eValuesTo,"to",e),t}createFromToElement(e,t,i,n){let o=this.createManagedBean(n?new pa({allowedCharPattern:n}):new lw);o.addCss(`ag-filter-${i}`),o.addCss("ag-filter-filter"),t.push(o),e.appendChild(o.getGui())}removeEValues(e,t){let i=n=>this.removeComponents(n,e,t);i(this.eValuesFrom),i(this.eValuesTo)}getValues(e){let t=[];return this.forEachPositionInput(e,(i,n,o,r)=>{n<r&&t.push(zC(this.stringToFloat(i.getValue())))}),t}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}stringToFloat(e){if(typeof e=="number")return e;let t=nr(e);t!=null&&t.trim()===""&&(t=null);let i=this.params.numberParser;return i?i(t):t==null||t.trim()==="-"?null:Number.parseFloat(t)}createCondition(e){let t=this.getConditionType(e),i={filterType:this.filterType,type:t},n=this.getValues(e);return n.length>0&&(i.filter=n[0]),n.length>1&&(i.filterTo=n[1]),i}getInputs(e){let{eValuesFrom:t,eValuesTo:i}=this;return e>=t.length?[null,null]:[t[e],i[e]]}hasInvalidInputs(){let e=!1;return this.forEachInput(t=>{t.getInputElement().validity.valid||(e=!0)}),e}},OD=class extends Aw{constructor(e,t){super(e,t,t.numberFormatter),this.filterTypeKeys=FD}conditionToString(e,t,i,n,o){let{filter:r,filterTo:s,type:a}=e,l=this.formatValue.bind(this);if(t){let c=this.conditionForToolPanel(a,i,()=>l(r),()=>l(s),n,o);if(c!=null)return c}return i?`${l(r)}-${l(s)}`:r!=null?l(r):`${a}`}},Jq=class extends TD{constructor(){super(LD,Lw),this.filterType="number",this.FilterModelFormatterClass=OD}comparator(){return(e,t)=>e===t?0:e<t?1:-1}isValid(e){return!isNaN(e)}},ND=class extends A{constructor(e){super(),this.params=e,this.eInput=Z,this.onValueChanged=()=>{}}setupGui(e){this.eInput=this.createManagedBean(new pa(this.params?.config));let t=this.eInput.getGui();e.appendChild(t);let i=n=>this.onValueChanged(n);this.addManagedListeners(t,{input:i,keydown:i})}setEditable(e){this.eInput.setDisabled(!e)}getValue(){return this.eInput.getValue()}setValue(e,t){this.eInput.setValue(e,t)}setValueChangedListener(e){this.onValueChanged=e}setParams({ariaLabel:e,autoComplete:t}){let{eInput:i}=this;i.setInputAriaLabel(e),t!==void 0&&i.setAutoComplete(t)}};function WC(e){let t=e?.trim();return t===""?e:t}function BD(e,t){let{filter:i,filterTo:n,type:o}=e||{};return[i||null,n||null].slice(0,Ed(o,t))}var Qq={tag:"div",ref:"eFloatingFilterInputContainer",cls:"ag-floating-filter-input",role:"presentation"},HD=class extends AD{constructor(){super(...arguments),this.eFloatingFilterInputContainer=Z,this.defaultDebounceMs=500}postConstruct(){this.setTemplate(Qq)}onModelUpdated(e){this.setLastTypeFromModel(e),this.setEditable(this.canWeEditAfterModelFromParentFilter(e)),this.inputSvc.setValue(this.filterModelFormatter.getModelAsString(e))}setParams(e){this.setupFloatingFilterInputService(e),super.setParams(e),this.setTextInputParams(e)}setupFloatingFilterInputService(e){this.inputSvc=this.createFloatingFilterInputService(e),this.inputSvc.setupGui(this.eFloatingFilterInputContainer)}setTextInputParams(e){let t=e.browserAutoComplete??!1,{inputSvc:i,defaultDebounceMs:n,readOnly:o}=this;if(i.setParams({ariaLabel:this.getAriaLabel(e),autoComplete:t}),this.applyActive=tg(e.filterParams),!o){let r=gw(e.filterParams,n),s=si(this,this.syncUpWithParentFilter.bind(this),r);i.setValueChangedListener(s)}}updateParams(e){super.updateParams(e),this.setTextInputParams(e)}recreateFloatingFilterInputService(e){let{inputSvc:t}=this,i=t.getValue();ai(this.eFloatingFilterInputContainer),this.destroyBean(t),this.setupFloatingFilterInputService(e),t.setValue(i,!0)}syncUpWithParentFilter(e){let t=e.key===T.ENTER,i=this.reactive;if(i&&this.params.onUiChange(),this.applyActive&&!t)return;let{inputSvc:n,params:o,lastType:r}=this,s=n.getValue();if(o.filterParams.trimInput&&(s=WC(s),n.setValue(s,!0)),i){let a=o,l=a.model,c=this.convertValue(s),d=c==null?null:z(b({},l??{filterType:this.filterType,type:r??this.optionsFactory.defaultOption}),{filter:c});a.onModelChange(d,{afterFloatingFilter:!0})}else o.parentFilterInstance(a=>{a?.onFloatingFilterChanged(r||null,s||null)})}convertValue(e){return e||null}setEditable(e){this.inputSvc.setEditable(e)}},Zq=class extends A{constructor(){super(...arguments),this.onValueChanged=()=>{},this.numberInputActive=!0}setupGui(e){this.eNumberInput=this.createManagedBean(new lw),this.eTextInput=this.createManagedBean(new pa),this.eTextInput.setDisabled(!0);let t=this.eNumberInput.getGui(),i=this.eTextInput.getGui();e.appendChild(t),e.appendChild(i),this.setupListeners(t,n=>this.onValueChanged(n)),this.setupListeners(i,n=>this.onValueChanged(n))}setEditable(e){this.numberInputActive=e,this.eNumberInput.setDisplayed(this.numberInputActive),this.eTextInput.setDisplayed(!this.numberInputActive)}setAutoComplete(e){this.eNumberInput.setAutoComplete(e),this.eTextInput.setAutoComplete(e)}getValue(){return this.getActiveInputElement().getValue()}setValue(e,t){this.getActiveInputElement().setValue(e,t)}getActiveInputElement(){return this.numberInputActive?this.eNumberInput:this.eTextInput}setValueChangedListener(e){this.onValueChanged=e}setupListeners(e,t){this.addManagedListeners(e,{input:t,keydown:t})}setParams(e){this.setAriaLabel(e.ariaLabel),e.autoComplete!==void 0&&this.setAutoComplete(e.autoComplete)}setAriaLabel(e){this.eNumberInput.setInputAriaLabel(e),this.eTextInput.setInputAriaLabel(e)}},e$=class extends HD{constructor(){super(...arguments),this.FilterModelFormatterClass=OD,this.filterType="number",this.defaultOptions=Lw}updateParams(e){GC(e.filterParams)!==this.allowedCharPattern&&this.recreateFloatingFilterInputService(e),super.updateParams(e)}createFloatingFilterInputService(e){return this.allowedCharPattern=GC(e.filterParams),this.allowedCharPattern?this.createManagedBean(new ND({config:{allowedCharPattern:this.allowedCharPattern}})):this.createManagedBean(new Zq)}convertValue(e){return e?Number(e):null}},Ow=["contains","notContains","equals","notEqual","startsWith","endsWith","blank","notBlank"],t$=class extends Fw{constructor(){super("textFilter",BD,Ow),this.filterType="text",this.eValuesFrom=[],this.eValuesTo=[],this.defaultDebounceMs=500}createCondition(e){let t=this.getConditionType(e),i={filterType:this.filterType,type:t},n=this.getValues(e);return n.length>0&&(i.filter=n[0]),n.length>1&&(i.filterTo=n[1]),i}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getInputs(e){let{eValuesFrom:t,eValuesTo:i}=this;return e>=t.length?[null,null]:[t[e],i[e]]}getValues(e){let t=[];return this.forEachPositionInput(e,(i,n,o,r)=>{n<r&&t.push(nr(i.getValue()))}),t}createEValue(){let e=Ft({tag:"div",cls:"ag-filter-body",role:"presentation"}),{eValuesFrom:t,eValuesTo:i}=this;return this.createFromToElement(e,t,"from"),this.createFromToElement(e,i,"to"),e}createFromToElement(e,t,i){let n=this.createManagedBean(new pa);n.addCss(`ag-filter-${i}`),n.addCss("ag-filter-filter"),t.push(n),e.appendChild(n.getGui())}removeEValues(e,t){let i=r=>this.removeComponents(r,e,t),{eValuesFrom:n,eValuesTo:o}=this;i(n),i(o)}},VD=class extends Aw{constructor(){super(...arguments),this.filterTypeKeys=Wq}conditionToString(e,t,i,n,o){let{filter:r,filterTo:s,type:a}=e;if(t){let l=d=>()=>Xr(this,"filterSummaryTextQuote",[d]),c=this.conditionForToolPanel(a,i,l(r),l(s),n,o);if(c!=null)return c}return i?`${r}-${s}`:r!=null?`${r}`:`${a}`}},i$=({filterOption:e,value:t,filterText:i})=>{if(i==null)return!1;switch(e){case"contains":return t.includes(i);case"notContains":return!t.includes(i);case"equals":return t===i;case"notEqual":return t!=i;case"startsWith":return t.indexOf(i)===0;case"endsWith":{let n=t.lastIndexOf(i);return n>=0&&n===t.length-i.length}default:return!1}},n$=e=>e,o$=e=>e==null?null:e.toString().toLowerCase(),r$=class extends kD{constructor(){super(BD,Ow),this.filterType="text",this.FilterModelFormatterClass=VD}updateParams(e){super.updateParams(e);let t=e.filterParams;this.matcher=t.textMatcher??i$,this.formatter=t.textFormatter??(t.caseSensitive?n$:o$)}evaluateNullValue(e){return e?["notEqual","notContains","blank"].indexOf(e)>=0:!1}evaluateNonNullValue(e,t,i,n){let o=e.map(h=>this.formatter(h))||[],r=this.formatter(t),{api:s,colDef:a,column:l,context:c,filterParams:{textFormatter:d}}=this.params;if(i.type==="blank")return Kp(t);if(i.type==="notBlank")return!Kp(t);let u={api:s,colDef:a,column:l,context:c,node:n.node,data:n.data,filterOption:i.type,value:r,textFormatter:d};return o.some(h=>this.matcher(z(b({},u),{filterText:h})))}processModelToApply(e){if(e&&this.params.filterParams.trimInput){let t=i=>{let n=b({},i),{filter:o,filterTo:r}=i;return o&&(n.filter=WC(o)??null),r&&(n.filterTo=WC(r)??null),n};return EP(e)?z(b({},e),{conditions:e.conditions.map(t)}):t(e)}return e}},s$=class extends HD{constructor(){super(...arguments),this.FilterModelFormatterClass=VD,this.filterType="text",this.defaultOptions=Ow}createFloatingFilterInputService(){return this.createManagedBean(new ND)}};function a$(e){return!!e.quickFilter?.isFilterPresent()}function l$(e){return e.quickFilter?.getText()}function c$(e){e.quickFilter?.resetCache()}var d$=class extends A{constructor(){super(...arguments),this.beanName="quickFilter",this.quickFilter=null,this.quickFilterParts=null}postConstruct(){let e=this.resetCache.bind(this),t=this.gos;this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:e,columnRowGroupChanged:e,columnVisible:()=>{t.get("includeHiddenColumnsInQuickFilter")||this.resetCache()}}),this.addManagedPropertyListener("quickFilterText",i=>this.setFilter(i.currentValue)),this.addManagedPropertyListeners(["includeHiddenColumnsInQuickFilter","applyQuickFilterBeforePivotOrAgg"],()=>this.onColumnConfigChanged()),this.quickFilter=this.parseFilter(t.get("quickFilterText")),this.parser=t.get("quickFilterParser"),this.matcher=t.get("quickFilterMatcher"),this.setFilterParts(),this.addManagedPropertyListeners(["quickFilterMatcher","quickFilterParser"],()=>this.setParserAndMatcher())}refreshCols(){let{autoColSvc:e,colModel:t,gos:i,pivotResultCols:n}=this.beans,o=t.isPivotMode(),r=e?.getColumns(),s=t.getColDefCols(),a=(o&&!i.get("applyQuickFilterBeforePivotOrAgg")?n?.getPivotResultCols()?.list:s)??[];r&&(a=a.concat(r)),this.colsToUse=i.get("includeHiddenColumnsInQuickFilter")?a:a.filter(l=>l.isVisible()||l.isRowGroupActive())}isFilterPresent(){return this.quickFilter!==null}doesRowPass(e){let t=this.gos.get("cacheQuickFilter");return this.matcher?this.doesRowPassMatcher(t,e):this.quickFilterParts.every(i=>t?this.doesRowPassCache(e,i):this.doesRowPassNoCache(e,i))}resetCache(){this.beans.rowModel.forEachNode(e=>e.quickFilterAggregateText=null)}getText(){return this.gos.get("quickFilterText")}setFilterParts(){let{quickFilter:e,parser:t}=this;e?this.quickFilterParts=t?t(e):e.split(" "):this.quickFilterParts=null}parseFilter(e){return ie(e)?e.toUpperCase():null}setFilter(e){if(e!=null&&typeof e!="string"){W(70,{newFilter:e});return}let t=this.parseFilter(e);this.quickFilter!==t&&(this.quickFilter=t,this.setFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}setParserAndMatcher(){let e=this.gos.get("quickFilterParser"),t=this.gos.get("quickFilterMatcher"),i=e!==this.parser||t!==this.matcher;this.parser=e,this.matcher=t,i&&(this.setFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}onColumnConfigChanged(){this.refreshCols(),this.resetCache(),this.isFilterPresent()&&this.dispatchLocalEvent({type:"quickFilterChanged"})}doesRowPassNoCache(e,t){return this.colsToUse.some(i=>{let n=this.getTextForColumn(i,e);return ie(n)&&n.includes(t)})}doesRowPassCache(e,t){return this.checkGenerateAggText(e),e.quickFilterAggregateText.includes(t)}doesRowPassMatcher(e,t){let i;e?(this.checkGenerateAggText(t),i=t.quickFilterAggregateText):i=this.getAggText(t);let{quickFilterParts:n,matcher:o}=this;return o(n,i)}checkGenerateAggText(e){e.quickFilterAggregateText||(e.quickFilterAggregateText=this.getAggText(e))}getTextForColumn(e,t){let i=this.beans.filterValueSvc.getValue(e,t),n=e.getColDef();if(n.getQuickFilterText){let o=ye(this.gos,{value:i,node:t,data:t.data,column:e,colDef:n});i=n.getQuickFilterText(o)}return ie(i)?i.toString().toUpperCase():null}getAggText(e){let t=[];for(let i of this.colsToUse){let n=this.getTextForColumn(i,e);ie(n)&&t.push(n)}return t.join(`
`)}},u$={moduleName:"ClientSideRowModelFilter",version:ee,rowModels:["clientSide"],beans:[hq]},Nw={moduleName:"FilterCore",version:ee,beans:[Aq],apiFunctions:{isAnyFilterPresent:Fq,onFilterChanged:Iq},css:[Cq],dependsOn:[u$]},GD={moduleName:"FilterValue",version:ee,beans:[Oq]},ag={moduleName:"ColumnFilter",version:ee,beans:[Tq,Lq],dynamicBeans:{headerFilterCellCtrl:pq},icons:{filter:"filter",filterActive:"filter"},apiFunctions:{isColumnFilterPresent:wq,getColumnFilterInstance:bq,destroyFilter:yq,setFilterModel:Sq,getFilterModel:xq,getColumnFilterModel:Eq,setColumnFilterModel:_q,showColumnFilter:Rq,hideColumnFilter:Pq,getColumnFilterHandler:Dq,doFilterAction:Mq},dependsOn:[Nw,sg,GD,mq]},h$={moduleName:"CustomFilter",version:ee,userComponents:{agReadOnlyFloatingFilter:Bq},dependsOn:[ag]},p$={moduleName:"TextFilter",version:ee,dependsOn:[ag],userComponents:{agTextColumnFilter:{classImp:t$,params:{useForm:!0}},agTextColumnFloatingFilter:s$},dynamicBeans:{agTextColumnFilterHandler:r$}},g$={moduleName:"NumberFilter",version:ee,dependsOn:[ag],userComponents:{agNumberColumnFilter:{classImp:Xq,params:{useForm:!0}},agNumberColumnFloatingFilter:e$},dynamicBeans:{agNumberColumnFilterHandler:Jq}},f$={moduleName:"DateFilter",version:ee,dependsOn:[ag],userComponents:{agDateColumnFilter:{classImp:zq,params:{useForm:!0}},agDateInput:Yq,agDateColumnFloatingFilter:jq},dynamicBeans:{agDateColumnFilterHandler:qq}},m$={moduleName:"QuickFilterCore",version:ee,rowModels:["clientSide"],beans:[d$],dependsOn:[Nw,GD]},v$={moduleName:"QuickFilter",version:ee,apiFunctions:{isQuickFilterPresent:a$,getQuickFilter:l$,resetQuickFilter:c$},dependsOn:[m$]},C$={moduleName:"ExternalFilter",version:ee,dependsOn:[Nw]},w$=".ag-tooltip{background-color:var(--ag-tooltip-background-color);border:var(--ag-tooltip-border);border-radius:var(--ag-border-radius);color:var(--ag-tooltip-text-color);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);position:absolute;white-space:normal;z-index:99999;&:where(.ag-cell-editor-tooltip){background-color:var(--ag-tooltip-error-background-color);border:var(--ag-tooltip-error-border);color:var(--ag-tooltip-error-text-color);font-weight:500}}.ag-tooltip-custom{position:absolute;z-index:99999}.ag-tooltip-custom:where(:not(.ag-tooltip-interactive)),.ag-tooltip:where(:not(.ag-tooltip-interactive)){pointer-events:none}.ag-tooltip-animate{transition:opacity 1s;&:where(.ag-tooltip-hiding){opacity:0}}",lC=(e,t,i)=>{let{editModelSvc:n}=e,o=n?.getCellValidationModel()?.getCellValidation(t)?.errorMessages,r=n?.getRowValidationModel().getRowValidation(t)?.errorMessages,s=o||r;return s?.length?s.join(i("tooltipValidationErrorSeparator",". ")):void 0},b$=class extends A{constructor(){super(...arguments),this.beanName="tooltipSvc"}setupHeaderTooltip(e,t,i,n){e&&t.destroyBean(e);let o=this.gos,r=aC(o),{column:s,eGui:a}=t,l=s.getColDef();!n&&r&&!l.headerComponent&&(n=fp(()=>a.querySelector(".ag-header-cell-text")));let c="header",u=this.beans.colNames.getDisplayNameForColumn(s,"header",!0),h=i??u,p={getGui:()=>a,getLocation:()=>c,getTooltipValue:()=>i??l?.headerTooltipValueGetter?.(ye(o,{location:c,colDef:l,column:s,value:h,valueFormatted:u}))??l?.headerTooltip,shouldDisplayTooltip:n,getAdditionalParams:()=>({column:s,colDef:s.getColDef()})},g=this.createTooltipFeature(p);return g&&(g=t.createBean(g),t.setRefreshFunction("tooltip",()=>g.refreshTooltip())),g}setupHeaderGroupTooltip(e,t,i,n){e&&t.destroyBean(e);let o=this.gos,r=aC(o),{column:s,eGui:a}=t,l=s.getColGroupDef();!n&&r&&!l?.headerGroupComponent&&(n=fp(()=>a.querySelector(".ag-header-group-text")));let c="headerGroup",u=this.beans.colNames.getDisplayNameForColumnGroup(s,"header"),h=i??u,p={getGui:()=>a,getLocation:()=>c,getTooltipValue:()=>i??l?.headerTooltipValueGetter?.(ye(o,{location:c,colDef:l,column:s,value:h,valueFormatted:u}))??l?.headerTooltip,shouldDisplayTooltip:n,getAdditionalParams:()=>{let f={column:s};return l&&(f.colDef=l),f}},g=this.createTooltipFeature(p);return g&&t.createBean(g)}enableCellTooltipFeature(e,t,i){let{beans:n}=this,{gos:o,editSvc:r}=n,{column:s,rowNode:a}=e,l="cell",c=()=>{let p=!!!r?.isEditing(e)&&lC(n,e,this.getLocaleTextFunc());if(p)return l="cellEditor",p;l="cell";let g=s.getColDef(),f=a.data;if(g.tooltipField&&ie(f))return cd(f,g.tooltipField,s.isTooltipFieldContainsDots());let m=g.tooltipValueGetter;return m?m(ye(o,{location:"cell",colDef:s.getColDef(),column:s,rowIndex:e.cellPosition.rowIndex,node:a,data:a.data,value:e.value,valueFormatted:e.valueFormatted})):null},d=aC(o);i||(d&&!e.isCellRenderer()?i=()=>{let h=!!r?.isEditing(e);if(!h&&lC(n,e,this.getLocaleTextFunc()))return!0;if(!s.isTooltipEnabled())return!1;let f=fp(()=>{let m=e.eGui;return m.children.length===0?m:m.querySelector(".ag-cell-value")});return!h&&f()}:i=()=>!r?.isEditing(e));let u={getGui:()=>e.eGui,getLocation:()=>l,getTooltipValue:t!=null?()=>t:c,shouldDisplayTooltip:i,getAdditionalParams:()=>({column:s,colDef:s.getColDef(),rowIndex:e.cellPosition.rowIndex,node:a,data:a.data,valueFormatted:e.valueFormatted})};return this.createTooltipFeature(u,n)}setupFullWidthRowTooltip(e,t,i,n){let o={getGui:()=>t.getFullWidthElement(),getTooltipValue:()=>i,getLocation:()=>"fullWidthRow",shouldDisplayTooltip:n},r=this.beans,s=r.context;e&&t.destroyBean(e,s);let a=this.createTooltipFeature(o,r);if(a)return t.createBean(a,s)}setupCellEditorTooltip(e,t){let{beans:i}=this,{context:n}=i,o=t.getValidationElement?.(!0)||!t.isPopup?.()&&e.eGui;if(!o)return;let r={getGui:()=>o,getTooltipValue:()=>lC(i,e,this.getLocaleTextFunc()),getLocation:()=>"cellEditor",shouldDisplayTooltip:()=>{let{editModelSvc:a}=i,l=a?.getRowValidationModel()?.getRowValidationMap(),c=a?.getCellValidationModel()?.getCellValidationMap(),d=!!l&&l.size>0,u=!!c&&c.size>0;return d||u}},s=this.createTooltipFeature(r,i);if(s)return e.createBean(s,n)}initCol(e){let{colDef:t}=e;e.tooltipEnabled=ie(t.tooltipField)||ie(t.tooltipValueGetter)||ie(t.tooltipComponent)}createTooltipFeature(e,t){return this.beans.registry.createDynamicBean("tooltipFeature",!1,e,t)}},y$=class extends K9{createTooltipComp(e,t){VO(this.beans.userCompFactory,e)?.newAgStackInstance().then(t)}setEventHandlers(e){[this.onColumnMovedEventCallback]=this.addManagedEventListeners({columnMoved:e})}clearEventHandlers(){this.onColumnMovedEventCallback?.(),this.onColumnMovedEventCallback=void 0}},zD={moduleName:"Tooltip",version:ee,beans:[b$],dynamicBeans:{tooltipFeature:gP,highlightTooltipFeature:Y9,tooltipStateManager:y$},userComponents:{agTooltipComponent:Q9},dependsOn:[sg],css:[w$]},sl=class{constructor(e){this.cellValueChanges=e}},cC=class extends sl{constructor(e,t,i,n){super(e),this.initialRange=t,this.finalRange=i,this.ranges=n}},S$=10,G_=class{constructor(e){this.actionStack=[],this.maxStackSize=e||S$,this.actionStack=new Array(this.maxStackSize)}pop(){return this.actionStack.pop()}push(e){e.cellValueChanges&&e.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(e))}clear(){this.actionStack=[]}getCurrentStackSize(){return this.actionStack.length}},x$=class extends A{constructor(){super(...arguments),this.beanName="undoRedo",this.cellValueChanges=[],this.activeCellEdit=null,this.activeRowEdit=null,this.isPasting=!1,this.isRangeInAction=!1,this.batchEditing=!1,this.bulkEditing=!1,this.onCellValueChanged=e=>{let t={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned},i=this.activeCellEdit!==null&&UP(this.activeCellEdit,t),n=this.activeRowEdit!==null&&KH(this.activeRowEdit,t);if(!(i||n||this.isPasting||this.isRangeInAction))return;let{rowPinned:r,rowIndex:s,column:a,oldValue:l,value:c}=e,d={rowPinned:r,rowIndex:s,columnId:a.getColId(),newValue:c,oldValue:l};this.cellValueChanges.push(d)},this.clearStacks=()=>{this.undoStack.clear(),this.redoStack.clear()}}postConstruct(){let{gos:e,ctrlsSvc:t}=this.beans;if(!e.get("undoRedoCellEditing"))return;let i=e.get("undoRedoCellEditingLimit");if(i<=0)return;this.undoStack=new G_(i),this.redoStack=new G_(i),this.addListeners();let n=this.clearStacks.bind(this);this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this),modelUpdated:o=>{o.keepUndoRedoStack||this.clearStacks()},columnPivotModeChanged:n,newColumnsLoaded:n,columnGroupOpened:n,columnRowGroupChanged:n,columnMoved:n,columnPinned:n,columnVisible:n,rowDragEnd:n}),t.whenReady(this,o=>{this.gridBodyCtrl=o.gridBodyCtrl})}getCurrentUndoStackSize(){return this.undoStack?.getCurrentStackSize()??0}getCurrentRedoStackSize(){return this.redoStack?.getCurrentStackSize()??0}undo(e){let{eventSvc:t,undoStack:i,redoStack:n}=this;t.dispatchEvent({type:"undoStarted",source:e});let o=this.undoRedo(i,n,"initialRange","oldValue","undo");t.dispatchEvent({type:"undoEnded",source:e,operationPerformed:o})}redo(e){let{eventSvc:t,undoStack:i,redoStack:n}=this;t.dispatchEvent({type:"redoStarted",source:e});let o=this.undoRedo(n,i,"finalRange","newValue","redo");t.dispatchEvent({type:"redoEnded",source:e,operationPerformed:o})}undoRedo(e,t,i,n,o){if(!e)return!1;let r=e.pop();return r?.cellValueChanges?(this.processAction(r,s=>s[n],o),r instanceof cC?this.processRange(r.ranges||[r[i]]):this.processCell(r.cellValueChanges),t.push(r),!0):!1}processAction(e,t,i){for(let n of e.cellValueChanges){let{rowIndex:o,rowPinned:r,columnId:s}=n,a={rowIndex:o,rowPinned:r},l=lr(this.beans,a);l.displayed&&l.setDataValue(s,t(n),i)}}processRange(e){let t,i=this.beans.rangeSvc;i.removeAllCellRanges(!0),e.forEach((n,o)=>{if(!n)return;let r=n.startRow,s=n.endRow;o===e.length-1&&(t={rowPinned:r.rowPinned,rowIndex:r.rowIndex,columnId:n.startColumn.getColId()},this.setLastFocusedCell(t));let a={rowStartIndex:r.rowIndex,rowStartPinned:r.rowPinned,rowEndIndex:s.rowIndex,rowEndPinned:s.rowPinned,columnStart:n.startColumn,columns:n.columns};i.addCellRange(a)})}processCell(e){let t=e[0],{rowIndex:i,rowPinned:n}=t,o={rowIndex:i,rowPinned:n},r=lr(this.beans,o),s={rowPinned:t.rowPinned,rowIndex:r.rowIndex,columnId:t.columnId};this.setLastFocusedCell(s)}setLastFocusedCell(e){let{rowIndex:t,columnId:i,rowPinned:n}=e,{colModel:o,focusSvc:r,rangeSvc:s}=this.beans,a=o.getCol(i);if(!a)return;let{scrollFeature:l}=this.gridBodyCtrl;l.ensureIndexVisible(t),l.ensureColumnVisible(a);let c={rowIndex:t,column:a,rowPinned:n};r.setFocusedCell(z(b({},c),{forceBrowserFocus:!0})),s?.setRangeToCell(c)}addListeners(){this.addManagedEventListeners({rowEditingStarted:e=>{this.activeRowEdit={rowIndex:e.rowIndex,rowPinned:e.rowPinned}},rowEditingStopped:()=>{let e=new sl(this.cellValueChanges);this.pushActionsToUndoStack(e),this.activeRowEdit=null},cellEditingStarted:e=>{this.activeCellEdit={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned}},cellEditingStopped:e=>{if(this.activeCellEdit=null,e.valueChanged&&!this.activeRowEdit&&!this.isPasting&&!this.isRangeInAction){let i=new sl(this.cellValueChanges);this.pushActionsToUndoStack(i)}},pasteStart:()=>{this.isPasting=!0},pasteEnd:()=>{let e=new sl(this.cellValueChanges);this.pushActionsToUndoStack(e),this.isPasting=!1},fillStart:()=>{this.isRangeInAction=!0},fillEnd:e=>{let t=new cC(this.cellValueChanges,e.initialRange,e.finalRange);this.pushActionsToUndoStack(t),this.isRangeInAction=!1},keyShortcutChangedCellStart:()=>{this.isRangeInAction=!0},keyShortcutChangedCellEnd:()=>{let e,{rangeSvc:t,gos:i}=this.beans;t&&ar(i)?e=new cC(this.cellValueChanges,void 0,void 0,[...t.getCellRanges()]):e=new sl(this.cellValueChanges),this.pushActionsToUndoStack(e),this.isRangeInAction=!1},batchEditingStarted:()=>this.startBigChange("batchEditing"),batchEditingStopped:({changes:e})=>this.stopBigChange("batchEditing",e),bulkEditingStarted:()=>this.startBigChange("bulkEditing"),bulkEditingStopped:({changes:e})=>this.stopBigChange("bulkEditing",e)})}startBigChange(e){this.updateBigChange(e,!0)}updateBigChange(e,t){e==="bulkEditing"?this.bulkEditing=t:this.batchEditing=t}stopBigChange(e,t){if(e==="bulkEditing"&&!this.bulkEditing||e==="batchEditing"&&!this.batchEditing||(this.updateBigChange(e,!1),t?.length===0))return;let i=new sl(t??[]);this.pushActionsToUndoStack(i),this.cellValueChanges=[]}pushActionsToUndoStack(e){this.undoStack.push(e),this.cellValueChanges=[],this.redoStack.clear()}},E$=".ag-cell-inline-editing{border:var(--ag-cell-editing-border)!important;border-radius:var(--ag-border-radius);box-shadow:var(--ag-cell-editing-shadow);padding:0;z-index:1;.ag-cell-edit-wrapper,.ag-cell-editor,.ag-cell-wrapper,:where(.ag-cell-editor) .ag-input-field-input,:where(.ag-cell-editor) .ag-wrapper{height:100%;line-height:normal;min-height:100%;width:100%}&.ag-cell-editing-error{border-color:var(--ag-invalid-color)!important}}:where(.ag-popup-editor) .ag-large-text{background-color:var(--ag-background-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);padding:0}.ag-large-text-input{display:block;height:auto;padding:var(--ag-cell-horizontal-padding)}:where(.ag-rtl .ag-large-text-input) textarea{resize:none}:where(.ag-ltr) .ag-checkbox-edit{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-checkbox-edit{padding-right:var(--ag-cell-horizontal-padding)}:where(.ag-row.ag-row-editing-invalid .ag-cell-inline-editing){opacity:.8}.ag-popup-editor{position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}",_$={tag:"div",cls:"ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit",children:[{tag:"ag-checkbox",ref:"eEditor",role:"presentation"}]},R$=class extends ng{constructor(){super(_$,[aw]),this.eEditor=Z}initialiseEditor(e){let t=e.value??void 0,i=this.eEditor;i.setValue(t),i.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(t),this.addManagedListeners(i,{fieldValueChanged:o=>this.setAriaLabel(o.selected)})}getValue(){return this.eEditor.getValue()}focusIn(){this.eEditor.getFocusableElement().focus()}afterGuiAttached(){this.params.cellStartedEdit&&this.focusIn()}isPopup(){return!1}setAriaLabel(e){let t=this.getLocaleTextFunc(),i=Xp(t,e),n=t("ariaToggleCellValue","Press SPACE to toggle cell value");this.eEditor.setInputAriaLabel(`${n} (${i})`)}getValidationElement(e){return e?this.params.eGridCell:this.eEditor.getInputElement()}getValidationErrors(){let{params:e}=this,{getValidationErrors:t}=e,i=this.getValue();return t?t({value:i,internalErrors:null,cellEditorParams:e}):null}},lg=class extends ng{constructor(e){super(),this.cellEditorInput=e,this.eEditor=Z}initialiseEditor(e){let{cellEditorInput:t}=this;this.setTemplate({tag:"div",cls:"ag-cell-edit-wrapper",children:[t.getTemplate()]},t.getAgComponents());let{eEditor:i}=this,{cellStartedEdit:n,eventKey:o,suppressPreventDefault:r}=e;i.getInputElement().setAttribute("title",""),t.init(i,e);let s,a=!0;n?(this.focusAfterAttached=!0,o===T.BACKSPACE||o===T.DELETE?s="":o&&o.length===1?r?a=!1:s=o:(s=t.getStartValue(),o!==T.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,s=t.getStartValue()),a&&s!=null&&i.setStartValue(s),this.addGuiEventListener("keydown",l=>{let{key:c}=l;(c===T.PAGE_UP||c===T.PAGE_DOWN)&&l.preventDefault()})}afterGuiAttached(){let e=this.getLocaleTextFunc(),t=this.eEditor;if(t.setInputAriaLabel(e("ariaInputEditor","Input Editor")),!this.focusAfterAttached)return;rs()||t.getFocusableElement().focus();let i=t.getInputElement();this.highlightAllOnFocus?i.select():this.cellEditorInput.setCaret?.()}focusIn(){let{eEditor:e}=this,t=e.getFocusableElement(),i=e.getInputElement();t.focus(),i.select()}getValue(){return this.cellEditorInput.getValue()}isPopup(){return!1}getValidationElement(){return this.eEditor.getInputElement()}getValidationErrors(){return this.cellEditorInput.getValidationErrors()}},P$={tag:"ag-input-date-field",ref:"eEditor",cls:"ag-cell-editor"},D$=class{constructor(e,t){this.getDataTypeService=e,this.getLocaleTextFunc=t}getTemplate(){return P$}getAgComponents(){return[rP]}init(e,t){this.eEditor=e,this.params=t;let{min:i,max:n,step:o,colDef:r}=t;i!=null&&e.setMin(i),n!=null&&e.setMax(n),o!=null&&e.setStep(o),this.includeTime=t.includeTime??this.getDataTypeService()?.getDateIncludesTimeFlag?.(r.cellDataType),this.includeTime!=null&&e.setIncludeTime(this.includeTime)}getValidationErrors(){let t=this.eEditor.getInputElement().valueAsDate,{params:i}=this,{min:n,max:o,getValidationErrors:r}=i,s=[],a=this.getLocaleTextFunc();if(t instanceof Date&&!isNaN(t.getTime())){if(n){let l=n instanceof Date?n:new Date(n);if(t<l){let c=l.toLocaleDateString();s.push(a("minDateValidation",`Date must be after ${c}`,[c]))}}if(o){let l=o instanceof Date?o:new Date(o);if(t>l){let c=l.toLocaleDateString();s.push(a("maxDateValidation",`Date must be before ${c}`,[c]))}}}return s.length||(s=null),r?r({value:t,cellEditorParams:i,internalErrors:s}):s}getValue(){let{eEditor:e,params:t}=this,i=e.getDate();return!ie(i)&&!ie(t.value)?t.value:i??null}getStartValue(){let{value:e}=this.params;if(e instanceof Date)return nn(e,this.includeTime??!1)}},M$=class extends lg{constructor(){super(new D$(()=>this.beans.dataTypeSvc,()=>this.getLocaleTextFunc()))}},k$={tag:"ag-input-date-field",ref:"eEditor",cls:"ag-cell-editor"},T$=class{constructor(e,t){this.getDataTypeService=e,this.getLocaleTextFunc=t}getTemplate(){return k$}getAgComponents(){return[rP]}init(e,t){this.eEditor=e,this.params=t;let{min:i,max:n,step:o,colDef:r}=t;i!=null&&e.setMin(i),n!=null&&e.setMax(n),o!=null&&e.setStep(o),this.includeTime=t.includeTime??this.getDataTypeService()?.getDateIncludesTimeFlag?.(r.cellDataType),this.includeTime!=null&&e.setIncludeTime(this.includeTime)}getValidationErrors(){let{eEditor:e,params:t}=this,i=e.getInputElement().value,n=this.formatDate(this.parseDate(i??void 0)),{min:o,max:r,getValidationErrors:s}=t,a=[];if(n){let l=new Date(n),c=this.getLocaleTextFunc();if(o){let d=new Date(o);if(l<d){let u=d.toLocaleDateString();a.push(c("minDateValidation",`Date must be after ${u}`,[u]))}}if(r){let d=new Date(r);if(l>d){let u=d.toLocaleDateString();a.push(c("maxDateValidation",`Date must be before ${u}`,[u]))}}}return a.length||(a=null),s?s({value:this.getValue(),cellEditorParams:t,internalErrors:a}):a}getValue(){let{params:e,eEditor:t}=this,i=this.formatDate(t.getDate());return!ie(i)&&!ie(e.value)?e.value:e.parseValue(i??"")}getStartValue(){return nn(this.parseDate(this.params.value??void 0)??null,this.includeTime??!1)}parseDate(e){let t=this.getDataTypeService();return t?t.getDateParserFunction(this.params.column)(e):Wi(e)??void 0}formatDate(e){let t=this.getDataTypeService();return t?t.getDateFormatterFunction(this.params.column)(e):nn(e??null,this.includeTime??!1)??void 0}},F$=class extends lg{constructor(){super(new T$(()=>this.beans.dataTypeSvc,()=>this.getLocaleTextFunc()))}},I$={tag:"div",cls:"ag-large-text",children:[{tag:"ag-input-text-area",ref:"eEditor",cls:"ag-large-text-input"}]},A$=class extends ng{constructor(){super(I$,[o9]),this.eEditor=Z}initialiseEditor(e){let{eEditor:t}=this,{cellStartedEdit:i,eventKey:n,maxLength:o,cols:r,rows:s}=e;this.focusAfterAttached=i,t.getInputElement().setAttribute("title",""),t.setMaxLength(o||200).setCols(r||60).setRows(s||10);let a;i?(this.focusAfterAttached=!0,n===T.BACKSPACE||n===T.DELETE?a="":n&&n.length===1?a=n:(a=this.getStartValue(e),n!==T.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,a=this.getStartValue(e)),a!=null&&t.setValue(a,!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()}getStartValue(e){let{value:t}=e;return t?.toString()??t}onKeyDown(e){let t=e.key;(t===T.LEFT||t===T.UP||t===T.RIGHT||t===T.DOWN||e.shiftKey&&t===T.ENTER)&&e.stopPropagation()}afterGuiAttached(){let{eEditor:e,focusAfterAttached:t,highlightAllOnFocus:i}=this,n=this.getLocaleTextFunc();e.setInputAriaLabel(n("ariaInputEditor","Input Editor")),t&&(e.getFocusableElement().focus(),i&&e.getInputElement().select())}getValue(){let{eEditor:e,params:t}=this,{value:i}=t,n=e.getValue();return!ie(n)&&!ie(i)?i:t.parseValue(n)}getValidationElement(){return this.eEditor.getInputElement()}getValidationErrors(){let{params:e}=this,{maxLength:t,getValidationErrors:i}=e,n=this.getLocaleTextFunc(),o=this.getValue(),r=[];return typeof o=="string"&&t!=null&&o.length>t&&r.push(n("maxLengthValidation",`Must be ${t} characters or fewer.`,[String(t)])),r.length||(r=null),i?i({value:o,internalErrors:r,cellEditorParams:e}):r}},L$={tag:"ag-input-number-field",ref:"eEditor",cls:"ag-cell-editor"},O$=class{constructor(e){this.getLocaleTextFunc=e}getTemplate(){return L$}getAgComponents(){return[r9]}init(e,t){this.eEditor=e,this.params=t;let{max:i,min:n,precision:o,step:r}=t;i!=null&&e.setMax(i),n!=null&&e.setMin(n),o!=null&&e.setPrecision(o),r!=null&&e.setStep(r);let s=e.getInputElement();t.preventStepping?e.addManagedElementListeners(s,{keydown:this.preventStepping}):t.showStepperButtons&&s.classList.add("ag-number-field-input-stepper")}getValidationErrors(){let{params:e}=this,{min:t,max:i,getValidationErrors:n}=e,r=this.eEditor.getInputElement().valueAsNumber,s=this.getLocaleTextFunc(),a=[];return typeof r=="number"&&(t!=null&&r<t&&a.push(s("minValueValidation",`Must be greater than or equal to ${t}.`,[String(t)])),i!=null&&r>i&&a.push(s("maxValueValidation",`Must be less than or equal to ${i}.`,[String(i)]))),a.length||(a=null),n?n({value:r,cellEditorParams:e,internalErrors:a}):a}preventStepping(e){(e.key===T.UP||e.key===T.DOWN)&&e.preventDefault()}getValue(){let{eEditor:e,params:t}=this,i=e.getValue();if(!ie(i)&&!ie(t.value))return t.value;let n=t.parseValue(i);if(n==null)return n;if(typeof n=="string"){if(n==="")return null;n=Number(n)}return isNaN(n)?null:n}getStartValue(){return this.params.value}setCaret(){rs()&&this.eEditor.getInputElement().focus({preventScroll:!0})}},N$=class extends lg{constructor(){super(new O$(()=>this.getLocaleTextFunc()))}},B$={tag:"div",cls:"ag-cell-edit-wrapper",children:[{tag:"ag-select",ref:"eEditor",cls:"ag-cell-editor"}]},H$=class extends ng{constructor(){super(B$,[m9]),this.eEditor=Z,this.startedByEnter=!1}wireBeans(e){this.valueSvc=e.valueSvc}initialiseEditor(e){this.focusAfterAttached=e.cellStartedEdit;let{eEditor:t,valueSvc:i,gos:n}=this,{values:o,value:r,eventKey:s}=e;if(mt(o)){W(58);return}this.startedByEnter=s!=null?s===T.ENTER:!1;let a=!1;o.forEach(u=>{let h={value:u},p=i.formatValue(e.column,null,u),g=p!=null;h.text=g?p:u,t.addOption(h),a=a||r===u}),a?t.setValue(e.value,!0):e.values.length&&t.setValue(e.values[0],!0);let{valueListGap:l,valueListMaxWidth:c,valueListMaxHeight:d}=e;l!=null&&t.setPickerGap(l),d!=null&&t.setPickerMaxHeight(d),c!=null&&t.setPickerMaxWidth(c),n.get("editType")!=="fullRow"&&this.addManagedListeners(this.eEditor,{selectedItem:()=>e.stopEditing()})}afterGuiAttached(){this.focusAfterAttached&&this.eEditor.getFocusableElement().focus(),this.startedByEnter&&setTimeout(()=>{this.isAlive()&&this.eEditor.showPicker()})}focusIn(){this.eEditor.getFocusableElement().focus()}getValue(){return this.eEditor.getValue()}isPopup(){return!1}getValidationElement(){return this.eEditor.getAriaElement()}getValidationErrors(){let{params:e}=this,{values:t,getValidationErrors:i}=e,n=this.getValue(),o=[];if(t&&!t.includes(n)){let r=this.getLocaleTextFunc();o.push(r("invalidSelectionValidation","Invalid selection."))}else o=null;return i?i({value:n,internalErrors:o,cellEditorParams:e}):o}},V$={tag:"ag-input-text-field",ref:"eEditor",cls:"ag-cell-editor"},G$=class{constructor(e){this.getLocaleTextFunc=e}getTemplate(){return V$}getAgComponents(){return[Zp]}init(e,t){this.eEditor=e,this.params=t;let i=t.maxLength;i!=null&&e.setMaxLength(i)}getValidationErrors(){let{params:e}=this,{maxLength:t,getValidationErrors:i}=e,n=this.getValue(),o=this.getLocaleTextFunc(),r=[];return t!=null&&typeof n=="string"&&n.length>t&&r.push(o("maxLengthValidation",`Must be ${t} characters or fewer.`,[String(t)])),r.length||(r=null),i?i({value:n,cellEditorParams:e,internalErrors:r}):r}getValue(){let{eEditor:e,params:t}=this,i=e.getValue();return!ie(i)&&!ie(t.value)?t.value:t.parseValue(i)}getStartValue(){let e=this.params;return e.useFormatter||e.column.getColDef().refData?e.formatValue(e.value):e.value}setCaret(){rs()&&this.eEditor.getInputElement().focus({preventScroll:!0});let e=this.eEditor,t=e.getValue(),i=ie(t)&&t.length||0;i&&e.getInputElement().setSelectionRange(i,i)}},z_=class extends lg{constructor(){super(new G$(()=>this.getLocaleTextFunc()))}};function z$(e){return e.ctrlsSvc.getScrollFeature().getVScrollPosition()}function W$(e){return e.ctrlsSvc.getScrollFeature().getHScrollPosition()}function WD(e,t,i="auto"){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureColumnVisible(t,i),"ensureVisible")}function UD(e,t,i){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureIndexVisible(t,i),"ensureVisible")}function U$(e,t,i=null){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureNodeVisible(t,i),"ensureVisible")}function q$(e){e.undoRedo?.undo("api")}function $$(e){e.undoRedo?.redo("api")}function j$(e,t){return e.editModelSvc?.getEditRowDataValue(t,{checkSiblings:!0})}function K$(e){let t=e.editModelSvc?.getEditMap(),i=[];return t?.forEach((n,o)=>{let{rowIndex:r,rowPinned:s}=o;n.forEach((a,l)=>{let{editorValue:c,pendingValue:d,sourceValue:u,state:h}=a,p=ir(a),g=c??d;g===bn&&(g=void 0);let f={newValue:g,oldValue:u,state:h,column:l,colId:l.getColId(),colKey:l.getColId(),rowIndex:r,rowPinned:s};(h==="editing"||h==="changed"&&p)&&i.push(f)})}),i}function Y$(e,t=!1){let{editSvc:i}=e;if(i?.isBatchEditing()){if(t)for(let n of e.editModelSvc?.getEditPositions()??[])n.state==="editing"&&i.revertSingleCellEdit(n);else Qs(e,{persist:!0});bl(e,void 0,{cancel:t})}else i?.stopEditing(void 0,{cancel:t,source:"edit",forceStop:!t,forceCancel:t})}function X$(e,t){let i=vt(e,t);return e.editSvc?.isEditing(i)??!1}function J$(e,t){let{key:i,colKey:n,rowIndex:o,rowPinned:r}=t,{editSvc:s,colModel:a}=e,l=a.getCol(n);if(!l){W(12,{colKey:n});return}let d=lr(e,{rowIndex:o,rowPinned:r||null,column:l});if(!d){W(290,{rowIndex:o,rowPinned:r});return}if(!l.isCellEditable(d))return;r==null&&UD(e,o),WD(e,n),s?.startEditing({rowNode:d,column:l},{event:i?new KeyboardEvent("keydown",{key:i}):void 0,source:"api"})}function Q$(e){return e.editSvc?.validateEdit()||null}function Z$(e){return e.undoRedo?.getCurrentUndoStackSize()??0}function ej(e){return e.undoRedo?.getCurrentRedoStackSize()??0}var tj={tag:"div",cls:"ag-popup-editor",attrs:{tabindex:"-1"}},ij=class extends ow{constructor(e){super(tj),this.params=e}postConstruct(){sa(this.gos,this.getGui(),"popupEditorWrapper",!0),this.addKeyDownListener()}addKeyDownListener(){let e=this.getGui(),t=this.params,i=n=>{kC(this.gos,n,t.node,t.column,!0)||t.onKeyDown(n)};this.addManagedElementListeners(e,{keydown:i})}};function nj(e,{column:t},i,n,o="ui"){if(i instanceof KeyboardEvent&&(i.key===T.TAB||i.key===T.ENTER||i.key===T.F2||i.key===T.BACKSPACE&&n))return!0;if(i?.shiftKey&&e.rangeSvc?.getCellRanges().length!=0)return!1;let s=t?.getColDef(),a=oj(e.gos,s),l=i?.type;return l==="click"&&i?.detail===1&&a===1||l==="dblclick"&&i?.detail===2&&a===2?!0:o==="api"?n??!1:!1}function oj(e,t){return e.get("suppressClickEdit")===!0?0:e.get("singleClickEdit")===!0||t?.singleClickEdit?1:2}function UC(e,{rowNode:t,column:i},n="ui"){let o=i.getColDef().editable,r=e.editModelSvc;return i.isColumnFunc(t,o)||!!r&&r.hasEdits({rowNode:t,column:i},{withOpenEditor:!0})}function rj(e,t,i="ui"){let n=UC(e,t,i);return n===!0||i==="ui"?n:e.colModel.getCols().some(r=>UC(e,{rowNode:t.rowNode,column:r},i))}var Yp=(e,t=!1)=>{if(e!==void 0)return ir(e)||t&&e.state==="editing"};function qD(e,t,i=!1){return Yp(e.editModelSvc?.getEdit(t),i)}var $D=(e,t,i)=>{if(e)for(let n=0,o=e.length;n<o;++n){let r=e[n];if(r.data&&(Yp(t?.getEdit({rowNode:r,column:i}))||Yp(t?.getEdit({rowNode:r.pinnedSibling,column:i})))||$D(r.childrenAfterGroup,t,i))return!0}};function jD(e,t){let{column:i,rowNode:n}=t;return e.gos.get("groupTotalRow")&&!n?.footer?!1:$D(n?.childrenAfterGroup,e.editModelSvc,i)}function KD(e,{rowNode:t,column:i}){if(t=t.pinnedSibling,!!t)return Yp(e.editModelSvc?.getEdit({rowNode:t,column:i}))}var sj=class extends A{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.editSvc=t.editSvc,this.editModelSvc=t.editModelSvc}setComp(e){this.cellComp=e,this.applyCellStyles()}applyCellStyles(){let{cellCtrl:e,editSvc:t,beans:i}=this;if(t?.isBatchEditing()&&t.isEditing()){let o=qD(i,e)||jD(i,e)||KD(i,e);this.applyBatchingStyle(o)}else this.applyBatchingStyle(!1);let n=!!this.editModelSvc?.getCellValidationModel().hasCellValidation(this.cellCtrl);this.cellComp.toggleCss("ag-cell-editing-error",n)}applyBatchingStyle(e){this.cellComp.toggleCss("ag-cell-editing",e??!1),this.cellComp.toggleCss("ag-cell-batch-edit",(e&&this.editSvc?.isBatchEditing())??!1)}},aj=class extends A{constructor(e,t){super(),this.rowCtrl=e,this.beans=t,this.gos=t.gos,this.editSvc=t.editSvc,this.editModelSvc=t.editModelSvc}applyRowStyles(){let{rowCtrl:e,editModelSvc:t,beans:i}=this,n=e.rowNode,o=t?.getEditRow(n),r=this.editModelSvc?.getRowValidationModel().hasRowValidation({rowNode:n});if(!o&&n.pinnedSibling&&(n=n.pinnedSibling,o=t?.getEditRow(n)),o){let s=Array.from(o.keys()).some(a=>{let l={rowNode:n,column:a};return qD(i,l,!0)||jD(i,l)||KD(i,l)});this.applyStyle(r,s);return}this.applyStyle(r)}applyStyle(e=!1,t=!1){let i=this.editSvc?.isBatchEditing()??!1,n=this.gos.get("editType")==="fullRow";this.rowCtrl?.forEachGui(void 0,({rowComp:o})=>{o.toggleCss("ag-row-editing",n&&t),o.toggleCss("ag-row-batch-edit",n&&t&&i),o.toggleCss("ag-row-inline-editing",t),o.toggleCss("ag-row-not-inline-editing",!t),o.toggleCss("ag-row-editing-invalid",n&&t&&e)})}},lj=({rowModel:e,pinnedRowModel:t,editModelSvc:i},n)=>{let o=new Set;e.forEachNode(r=>n.has(r)&&o.add(r)),t?.forEachPinnedRow("top",r=>n.has(r)&&o.add(r)),t?.forEachPinnedRow("bottom",r=>n.has(r)&&o.add(r));for(let r of n)o.has(r)||i.removeEdits({rowNode:r});return o},cj=({editModelSvc:e},t,i)=>{for(let n of t)e?.getEditRow(n)?.forEach((o,r)=>!i.has(r)&&e.removeEdits({rowNode:n,column:r}))},dj=e=>()=>{let t=new Set(e.colModel.getCols()),i=e.editModelSvc.getEditMap(!0),n=new Set(i.keys());cj(e,lj(e,n),t)},uj=new Set(["undo","redo","paste","bulk","rangeSvc"]),hj=new Set(["ui","api"]),YD={paste:"api",rangeSvc:"api",fillHandle:"api",cellClear:"api",bulk:"api"},pj=new Set(Object.keys(YD)),gj=new Set(["paste","rangeSvc","renderer","cellClear","redo","undo"]),gp={cancel:!0,source:"api"},fj={cancel:!1,source:"api"},ol={checkSiblings:!0},Qc={force:!0,suppressFlash:!0},mj=class extends A{constructor(){super(...arguments),this.beanName="editSvc",this.batch=!1,this.stopping=!1,this.committing=!1}postConstruct(){let{beans:e}=this;this.model=e.editModelSvc,this.valueSvc=e.valueSvc,this.rangeSvc=e.rangeSvc,this.addManagedPropertyListener("editType",({currentValue:n})=>{this.stopEditing(void 0,gp),this.createStrategy(n)});let t=dj(e),i=()=>{let n=this.model.getCellValidationModel().getCellValidationMap().size>0,o=this.model.getRowValidationModel().getRowValidationMap().size>0;return n||o?this.stopEditing(void 0,gp):this.isEditing()&&(this.isBatchEditing()?bl(e,this.model.getEditPositions()):this.stopEditing(void 0,fj)),!1};this.addManagedEventListeners({columnPinned:t,columnVisible:t,columnRowGroupChanged:t,rowExpansionStateChanged:t,pinnedRowsChanged:t,displayedRowsChanged:t,sortChanged:i,filterChanged:i,cellFocused:this.onCellFocused.bind(this)})}isBatchEditing(){return this.batch}setBatchEditing(e){e?(this.batch=!0,this.stopEditing(void 0,gp)):(this.stopEditing(void 0,gp),this.batch=!1)}createStrategy(e){let{beans:t,gos:i,strategy:n}=this,o=W_(i,e);if(n){if(n.beanName===o)return n;this.destroyStrategy()}return this.strategy=this.createOptionalManagedBean(t.registry.createDynamicBean(o,!0))}destroyStrategy(){this.strategy&&(this.strategy.destroy(),this.strategy=this.destroyBean(this.strategy))}shouldStartEditing(e,t,i,n="ui"){let o=nj(this.beans,e,t,i,n);return o&&(this.strategy??(this.strategy=this.createStrategy())),o}shouldStopEditing(e,t,i="ui"){return this.strategy?.shouldStop(e,t,i)??null}shouldCancelEditing(e,t,i="ui"){return this.strategy?.shouldCancel(e,t,i)??null}validateEdit(){return FW(this.beans)}isEditing(e,t){return this.model.hasEdits(e,t??ol)}isRowEditing(e,t){return(e&&this.model.hasRowEdits(e,t))??!1}startEditing(e,t){let{startedEdit:i=!0,event:n=null,source:o="ui",ignoreEventKey:r=!1,silent:s}=t;if(this.strategy??(this.strategy=this.createStrategy()),!this.isCellEditable(e,"api"))return;let a=vt(this.beans,e);if(a&&!a.comp){a.onCompAttachedFuncs.push(()=>this.startEditing(e,t));return}let l=this.shouldStartEditing(e,n,i,o);if(l===!1&&o!=="api"){this.isEditing(e)&&this.stopEditing();return}!this.batch&&this.shouldStopEditing(e,void 0,o)&&!t.continueEditing&&this.stopEditing(void 0,{source:o}),l&&this.isBatchEditing()&&this.dispatchBatchEvent("batchEditingStarted",new Map),this.strategy.start({position:e,event:n,source:o,ignoreEventKey:r,startedEdit:i,silent:s})}stopEditing(e,t){let{event:i,cancel:n,source:o="ui",forceCancel:r,forceStop:s}=t||{},{beans:a,model:l}=this;if(pj.has(o)&&this.isBatchEditing())return this.bulkRefresh(e),!1;let c=this.committing?YD[o]:o;if(!(this.committing||this.isEditing(e)||this.isBatchEditing()&&l.hasEdits(e,ol))||!this.strategy||this.stopping)return!1;this.stopping=!0;let u=vt(a,e);u&&(u.onEditorAttachedFuncs=[]);let h=l.getEditMap(!0),p=!1,g=!n&&(!!this.shouldStopEditing(e,i,c)||this.committing&&!this.batch)||(s??!1),f=n&&!!this.shouldCancelEditing(e,i,c)||(r??!1);if(g||f){Qs(a,{persist:!0,isCancelling:f||n,isStopping:g});let m=l.getEditMap(),v=this.processEdits(m,n,o);this.strategy?.stop(n,i);for(let C of v)l.clearEditValue(C);this.bulkRefresh(void 0,h);for(let C of l.getEditPositions(m)){let w=vt(a,C),y=ir(C);w?.refreshCell({force:!0,suppressFlash:!y})}h=m,p||(p=g)}else if(i instanceof KeyboardEvent&&this.batch&&this.strategy?.midBatchInputsAllowed(e)&&this.isEditing(e,{withOpenEditor:!0})){let{key:m}=i,v=m===T.ENTER,C=m===T.ESCAPE,w=m===T.TAB;(v||w||C)&&(v||w?Qs(a,{persist:!0}):C&&this.revertSingleCellEdit(u),this.isBatchEditing()?this.strategy?.cleanupEditors():bl(a,l.getEditPositions(),{event:i,cancel:C}),i.preventDefault(),this.bulkRefresh(e,h,{suppressFlash:!0}),h=l.getEditMap())}else Qs(a,{persist:!0}),h=l.getEditMap();return p&&e&&this.model.removeEdits(e),this.navigateAfterEdit(t,u?.cellPosition),BC(a),this.model.hasEdits()||(this.model.getCellValidationModel().clearCellValidationMap(),this.model.getRowValidationModel().clearRowValidationMap()),this.bulkRefresh(),f&&this.beans.rowRenderer.refreshRows({rowNodes:Array.from(h.keys())}),this.isBatchEditing()&&(this.beans.rowRenderer.refreshRows({suppressFlash:!0,force:!0}),p&&g&&this.dispatchBatchEvent("batchEditingStopped",h)),this.stopping=!1,p}navigateAfterEdit(e,t){if(!e||!t)return;let{event:i,suppressNavigateAfterEdit:n}=e;if(!(i instanceof KeyboardEvent)||n)return;let{key:r,shiftKey:s}=i,a=this.gos.get("enterNavigatesVerticallyAfterEdit");if(r!==T.ENTER||!a)return;let l=s?T.UP:T.DOWN;this.beans.navigation?.navigateToNextCell(null,l,t,!1)}processEdits(e,t=!1,i){let n=Array.from(e.keys()),o=this.model.getCellValidationModel().getCellValidationMap().size>0||this.model.getRowValidationModel().getRowValidationMap().size>0,r=[];for(let s of n){let a=e.get(s);for(let l of a.keys()){let c=a.get(l),d={rowNode:s,column:l},u=ir(c);!t&&u&&!o&&(this.setNodeDataValue(s,l,c.pendingValue,void 0,i)||r.push(d))}}return r}setNodeDataValue(e,t,i,n,o="edit"){let{beans:r}=this,s=vt(r,{rowNode:e,column:t}),a=hj.has(o)?"edit":o;s&&(s.suppressRefreshCell=!0),this.commitNextEdit();let l=e.setDataValue(t,i,a);return s&&(s.suppressRefreshCell=!1),n&&s?.refreshCell(Qc),l}setEditMap(e,t){this.strategy??(this.strategy=this.createStrategy()),this.strategy?.setEditMap(e,t),this.bulkRefresh();let i=Qc;t?.forceRefreshOfEditCellsOnly&&(i=b(b({},vj(e)),Qc)),this.beans.rowRenderer.refreshCells(i)}dispatchEditValuesChanged({rowNode:e,column:t},i={}){if(!e||!t||!i)return;let{pendingValue:n,sourceValue:o}=i,{rowIndex:r,rowPinned:s,data:a}=e;this.beans.eventSvc.dispatchEvent({type:"cellEditValuesChanged",node:e,rowIndex:r,rowPinned:s,column:t,source:"api",data:a,newValue:n,oldValue:o,value:n,colDef:t.getColDef()})}bulkRefresh(e={},t,i={}){let{beans:n,gos:o}=this,{editModelSvc:r,rowModel:s}=n;Tt(o,s)&&(e.rowNode&&e.column?this.refCell(e,this.model.getEdit(e),i):t&&r?.getEditMap(!1)?.forEach((a,l)=>{for(let c of a.keys())this.refCell({rowNode:l,column:c},a.get(c),i)}))}refCell({rowNode:e,column:t},i,n={}){let{beans:o,gos:r}=this,s=new Set([e]),a=new Set,l=e.pinnedSibling;l&&s.add(l);let c=e.sibling;c&&a.add(c);let d=e.parent;for(;d;)d.sibling?.footer&&r.get("groupTotalRow")||!d.parent&&d.sibling&&r.get("grandTotalRow")?a.add(d.sibling):a.add(d),d=d.parent;for(let u of s)this.dispatchEditValuesChanged({rowNode:u,column:t},i);for(let u of s)vt(o,{rowNode:u,column:t})?.refreshCell(n);for(let u of a)vt(o,{rowNode:u,column:t})?.refreshCell(n)}stopAllEditing(e=!1,t="ui"){this.isEditing()&&this.stopEditing(void 0,{cancel:e,source:t})}isCellEditable(e,t="ui"){let{rowNode:i}=e,{gos:n,beans:o}=this;if(i.group){if(n.get("treeData")){if(!i.data&&!n.get("enableGroupEdit"))return!1}else if(!n.get("enableGroupEdit"))return!1}let r=W_(n)==="fullRow"?rj(o,e,t):UC(o,e,t);return r&&(this.strategy??(this.strategy=this.createStrategy())),r}cellEditingInvalidCommitBlocks(){return this.gos.get("invalidEditValueMode")==="block"}checkNavWithValidation(e,t,i=!0){if(this.hasValidationErrors(e)){let n=vt(this.beans,e);return this.cellEditingInvalidCommitBlocks()?(t?.preventDefault?.(),i&&(!n?.hasBrowserFocus()&&n?.focusCell(),n?.comp?.getCellEditor()?.focusIn?.()),"block-stop"):(n&&this.revertSingleCellEdit(n),"revert-continue")}return"continue"}revertSingleCellEdit(e,t=!1){let i=vt(this.beans,e);i?.comp?.getCellEditor()&&(bl(this.beans,[e],{silent:!0}),this.model.clearEditValue(e),Pl(this.beans,e,{silent:!0}),ca(this.beans),i?.refreshCell(Qc),t&&(i?.focusCell(),i?.comp?.getCellEditor()?.focusIn?.()))}hasValidationErrors(e){ca(this.beans);let t=vt(this.beans,e);t&&(t.refreshCell(Qc),t.rowCtrl.rowEditStyleFeature?.applyRowStyles());let i=!1;return e?.rowNode?(i||(i=this.model.getRowValidationModel().hasRowValidation({rowNode:e.rowNode})),e.column&&(i||(i=this.model.getCellValidationModel().hasCellValidation({rowNode:e.rowNode,column:e.column})))):(i||(i=this.model.getCellValidationModel().getCellValidationMap().size>0),i||(i=this.model.getRowValidationModel().getRowValidationMap().size>0)),i}moveToNextCell(e,t,i,n="ui"){let o,r=this.isEditing(),s=r&&this.checkNavWithValidation(void 0,i)==="block-stop";return e instanceof yl&&r&&(o=this.strategy?.moveToNextEditingCell(e,t,i,n,s)),o===null||(o=o||!!this.beans.focusSvc.focusedHeader,o===!1&&!s&&this.stopEditing()),o}getCellDataValue({rowNode:e,column:t},i=!0){if(!e||!t)return;let n=this.model.getEdit({rowNode:e,column:t}),o=e.pinnedSibling;if(o){let s=this.model.getEdit({rowNode:o,column:t});s&&(n=s)}let r=i?n?.editorValue??n?.pendingValue:n?.pendingValue;return r===bn||!n?n?.sourceValue??this.valueSvc.getValue(t,e,!1,"api"):r}addStopEditingWhenGridLosesFocus(e){RW(this,this.beans,e)}createPopupEditorWrapper(e){return new ij(e)}commitNextEdit(){this.committing=!0}setDataValue(e,t,i){try{if((!this.isEditing()||this.committing)&&!gj.has(i))return;let{beans:n}=this;this.strategy??(this.strategy=this.createStrategy());let o=this.isBatchEditing()?"ui":this.committing?i??"api":"api";if(!i||uj.has(i))return Rp(n,e,t,i,void 0,{persist:!0}),this.setNodeDataValue(e.rowNode,e.column,t,!0,i);let r=this.model.getEdit(e);if(r){if(r.pendingValue===t)return!1;if(r.sourceValue!==t)return Rp(n,e,t,i,void 0,{persist:!0}),this.stopEditing(e,{source:o,suppressNavigateAfterEdit:!0}),!0;if(r.sourceValue===t)return n.editModelSvc?.removeEdits(e),this.dispatchEditValuesChanged(e,z(b({},r),{pendingValue:t})),!0}return Rp(n,e,t,i,void 0,{persist:!0}),this.stopEditing(e,{source:o,suppressNavigateAfterEdit:!0}),!0}finally{this.committing=!1}}handleColDefChanged(e){MW(this.beans,e)}destroy(){this.model.clear(),this.destroyStrategy(),super.destroy()}prepDetailsDuringBatch(e,t){if(!this.batch||!this.model.hasRowEdits(e.rowNode,ol))return;let{rowNode:n,column:o}=e,{compDetails:r,valueToDisplay:s}=t;if(r){let{params:l}=r;return l.data=this.model.getEditRowDataValue(n,ol),{compDetails:r}}let a=this.model.getEditRow(e.rowNode,ol);if(s!==void 0&&a?.has(o))return{valueToDisplay:this.valueSvc.getValue(o,n)}}cleanupEditors(){this.strategy?.cleanupEditors()}dispatchCellEvent(e,t,i,n){this.strategy?.dispatchCellEvent(e,t,i,n)}dispatchBatchEvent(e,t){this.eventSvc.dispatchEvent(this.createBatchEditEvent(e,t))}createBatchEditEvent(e,t){return ye(this.gos,b({type:e},e==="batchEditingStopped"?{changes:this.toEventChangeList(t)}:{}))}toEventChangeList(e){return this.model.getEditPositions(e).map(t=>({rowIndex:t.rowNode.rowIndex,rowPinned:t.rowNode.rowPinned,columnId:t.column.getColId(),newValue:t.pendingValue,oldValue:t.sourceValue}))}applyBulkEdit({rowNode:e,column:t},i){if(!i||i.length===0)return;let{beans:n,rangeSvc:o,valueSvc:r}=this;Qs(n,{persist:!0});let s=this.model.getEditMap(!0),a=s.get(e)?.get(t)?.pendingValue;this.batch||this.eventSvc.dispatchEvent({type:"bulkEditingStarted"}),i.forEach(c=>{if(o?.forEachRowInRange(c,d=>{let u=lr(n,d);if(u===void 0)return;let h=s.get(u)??new Map;for(let p of c.columns)if(p&&this.isCellEditable({rowNode:u,column:p},"api")){let g=r.getValue(p,u,!0,"api"),f=r.parseValue(p,u??null,a,g);Number.isNaN(f)&&(f=null),h.set(p,{editorValue:void 0,pendingValue:f,sourceValue:g,state:"changed",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}})}h.size>0&&s.set(u,h)}),this.setEditMap(s),this.batch){this.cleanupEditors(),BC(n),this.bulkRefresh();return}this.commitNextEdit(),this.stopEditing(void 0,{source:"bulk"}),this.eventSvc.dispatchEvent({type:"bulkEditingStopped",changes:this.toEventChangeList(s)})}),this.bulkRefresh();let l=vt(n,{rowNode:e,column:t});l&&l.focusCell(!0)}createCellStyleFeature(e,t){return new sj(e,t)}createRowStyleFeature(e,t){return new aj(e,t)}setEditingCells(e,t){let{beans:i}=this,{colModel:n,valueSvc:o}=i,r=new Map;for(let{colId:s,column:a,colKey:l,rowIndex:c,rowPinned:d,newValue:u,state:h}of e){let p=s?n.getCol(s):l?n.getCol(l):a;if(!p)continue;let g=lr(i,{rowIndex:c,rowPinned:d});if(!g)continue;let f=o.getValue(p,g,!0,"api");if(!t?.forceRefreshOfEditCellsOnly&&!ir({pendingValue:u,sourceValue:f})&&h!=="editing")continue;let m=r.get(g);m||(m=new Map,r.set(g,m)),u===void 0&&(u=bn),m.set(p,{editorValue:void 0,pendingValue:u,sourceValue:f,state:h??"changed",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}})}this.setEditMap(r,t)}onCellFocused(e){let t=vt(this.beans,e);if(!t||!this.isEditing(t,ol))return;let i=this.model.getEdit(t);if(!i||!ir(i))return;let o=this.getLocaleTextFunc()("ariaPendingChange","Pending Change");this.beans.ariaAnnounce?.announceValue(o,"pendingChange")}allowedFocusTargetOnValidation(e){return vt(this.beans,e)}};function vj(e){return{rowNodes:e?Array.from(e.keys()):void 0,columns:e?[...new Set(Array.from(e.values()).flatMap(t=>Array.from(t.keys())))]:void 0}}function W_(e,t){return t??e.get("editType")??"singleCell"}var XD=class extends A{postConstruct(){this.model=this.beans.editModelSvc,this.editSvc=this.beans.editSvc,this.addManagedEventListeners({cellFocused:this.onCellFocusChanged?.bind(this),cellFocusCleared:this.onCellFocusChanged?.bind(this)})}clearEdits(e){this.model.clearEditValue(e)}onCellFocusChanged(e){let t,i=e.previousParams,{editSvc:n,beans:o}=this,r=e.type==="cellFocused"?e.sourceEvent:null;i&&(t=vt(o,i));let{gos:s,editModelSvc:a}=o,l=e.type==="cellFocusCleared";if(n.isEditing(void 0,{withOpenEditor:!0})){let{column:c,rowIndex:d,rowPinned:u}=e,h={column:c,rowNode:lr(o,{rowIndex:d,rowPinned:u})},p=s.get("invalidEditValueMode")==="block";if(p)return;let g=!p,f=!!a?.getCellValidationModel().hasCellValidation(h),m=g&&f;(i||l?n.stopEditing(void 0,{cancel:m,source:l&&g?"api":void 0,event:r}):!0)||(n.isBatchEditing()?n.cleanupEditors():n.stopEditing(void 0,{source:"api"}))}t?.refreshCell({suppressFlash:!0,force:!0})}stop(e,t){let i=this.model.getEditPositions(),n={all:[],pass:[],fail:[]};for(let o of i){if(n.all.push(o),(this.model.getCellValidationModel().getCellValidation(o)?.errorMessages?.length??0)>0){n.fail.push(o);continue}n.pass.push(o)}if(e)for(let o of i)$p(this.beans,o,{cancel:e}),this.model.stop(o);else{let o=this.processValidationResults(n);if(o.destroy.length>0)for(let r of o.destroy)$p(this.beans,r,{event:t,cancel:e}),this.model.stop(r);if(o.keep.length>0)for(let r of o.keep){let s=vt(this.beans,r);this.editSvc?.cellEditingInvalidCommitBlocks()||s&&this.editSvc.revertSingleCellEdit(s)}}return!0}cleanupEditors({rowNode:e}={},t){Qs(this.beans,{persist:!1});let i=this.model.getEditPositions(),n=[];if(e)for(let o of i)o.rowNode!==e&&n.push(o);else for(let o of i)n.push(o);bl(this.beans,n),BC(this.beans,t)}setFocusOutOnEditor(e){e.comp?.getCellEditor()?.focusOut?.()}setFocusInOnEditor(e){let t=e.comp,i=t?.getCellEditor();if(i?.focusIn)i.focusIn();else{let n=this.beans.gos.get("editType")==="fullRow";e.focusCell(n),e.onEditorAttachedFuncs.push(()=>t?.getCellEditor()?.focusIn?.())}}setupEditors(e){let{event:t,ignoreEventKey:i=!1,startedEdit:n,position:o,cells:r=this.model.getEditPositions()}=e,s=t instanceof KeyboardEvent&&!i&&t.key||void 0;DW(this.beans,r,o,s,t,n)}dispatchCellEvent(e,t,i,n){let o=vt(this.beans,e);o&&this.eventSvc.dispatchEvent(b(b({},o.createEvent(t??null,i)),n))}dispatchRowEvent(e,t,i){if(i)return;let n=Dw(this.beans,e);n&&this.eventSvc.dispatchEvent(n.createRowEvent(t))}shouldStop(e,t,i="ui"){let n=this.editSvc.isBatchEditing();return n&&i==="api"?!0:n&&(i==="ui"||i==="edit")?!1:i==="api"?!0:t instanceof KeyboardEvent&&!n?t.key===T.ENTER:null}shouldCancel(e,t,i="ui"){let n=this.editSvc.isBatchEditing();return!!(t instanceof KeyboardEvent&&!n&&t.key===T.ESCAPE||n&&i==="api"||i==="api")}setEditMap(e,t){t?.update||this.editSvc.stopEditing(void 0,{cancel:!0,source:"api"});let i=[];if(e.forEach((n,o)=>{n.forEach((r,s)=>{r.state==="editing"&&i.push(z(b({},r),{rowNode:o,column:s}))})}),t?.update&&(e=new Map([...this.model.getEditMap(),...e])),this.model?.setEditMap(e),i.length>0){let n=i.at(-1),o=n.pendingValue===bn?void 0:n.pendingValue;this.start({position:n,event:new KeyboardEvent("keydown",{key:o}),source:"api"});let r=vt(this.beans,n);r&&this.setFocusInOnEditor(r)}}destroy(){this.cleanupEditors(),super.destroy()}},Cj=class extends XD{constructor(){super(...arguments),this.beanName="fullRow",this.startedRows=[]}shouldStop(e,t,i="ui"){let{rowNode:n}=e||{};if(!Dw(this.beans,{rowNode:this.rowNode}))return!0;let r=super.shouldStop({rowNode:this.rowNode},t,i);return r!==null?r:this.rowNode?n!==this.rowNode:!1}midBatchInputsAllowed({rowNode:e}){return e?this.model.hasEdits({rowNode:e}):!1}clearEdits(e){this.model.clearEditValue(e)}start(e){let{position:t,silent:i,startedEdit:n,event:o,ignoreEventKey:r}=e,{rowNode:s}=t;this.rowNode!==s&&super.cleanupEditors(t);let a=this.beans.visibleCols.allCols,l=[],c=[];for(let d of a)d.isCellEditable(s)&&c.push(d);if(c.length!=0){this.dispatchRowEvent({rowNode:s},"rowEditingStarted",i),this.startedRows.push(s);for(let d of c){let u={rowNode:s,column:d};l.push(u),this.model.hasEdits(u)||this.model.start(u)}this.rowNode=s,this.setupEditors({cells:l,position:t,startedEdit:n,event:o,ignoreEventKey:r})}}processValidationResults(e){return e.fail.length>0&&this.editSvc.cellEditingInvalidCommitBlocks()?{destroy:[],keep:e.all}:{destroy:e.all,keep:[]}}stop(e,t){let{rowNode:i}=this;if(i&&!this.model.hasRowEdits(i))return!1;let n=[];if(e||this.model.getEditMap().forEach((o,r)=>{if(!(!o||o.size===0)){for(let s of o.values())if(ir(s)){n.push(r);break}}}),ca(this.beans),!e&&this.editSvc?.checkNavWithValidation({rowNode:i})==="block-stop")return!1;super.stop(e,t);for(let o of n)this.dispatchRowEvent({rowNode:o},"rowValueChanged");return this.cleanupEditors({rowNode:i},!0),this.rowNode=void 0,!0}onCellFocusChanged(e){let{rowIndex:t}=e,i=e.previousParams;if(i?.rowIndex===t||e.sourceEvent instanceof KeyboardEvent)return;let n=vt(this.beans,i);this.gos.get("invalidEditValueMode")==="block"&&n&&(this.model.getCellValidationModel().getCellValidation(n)||this.model.getRowValidationModel().getRowValidation(n))||super.onCellFocusChanged(e)}cleanupEditors(e={},t){super.cleanupEditors(e,t);for(let i of this.startedRows)this.dispatchRowEvent({rowNode:i},"rowEditingStopped");this.startedRows.length=0}moveToNextEditingCell(e,t,i,n="ui",o=!1){let r=e.cellPosition,s;this.model.suspend(!0);try{s=this.beans.navigation?.findNextCellToFocusOn(r,{backwards:t,startEditing:!0,skipToNextEditableCell:!1})}finally{this.model.suspend(!1)}if(s===!1)return null;if(s==null)return!1;let a=s.cellPosition,l=e.isCellEditable(),c=s.isCellEditable(),d=a&&r.rowIndex===a.rowIndex&&r.rowPinned===a.rowPinned;l&&this.setFocusOutOnEditor(e),this.restoreEditors();let u=this.gos.get("suppressStartEditOnTab");return c&&!o?u?s.focusCell(!0,i):(s.comp?.getCellEditor()||Pl(this.beans,s,{event:i,cellStartedEdit:!0}),this.setFocusInOnEditor(s),s.focusCell(!1,i)):(c&&o&&this.setFocusInOnEditor(s),s.focusCell(!0,i)),!d&&!o&&(this.editSvc?.stopEditing({rowNode:e.rowNode},{event:i}),this.cleanupEditors(s,!0),u?s.focusCell(!0,i):this.editSvc.startEditing(s,{startedEdit:!0,event:i,source:n,ignoreEventKey:!0})),e.rowCtrl?.refreshRow({suppressFlash:!0,force:!0}),!0}restoreEditors(){this.model.getEditMap().forEach((e,t)=>e.forEach(({state:i},n)=>{if(i!=="editing")return;let o=vt(this.beans,{rowNode:t,column:n});o&&!o.comp?.getCellEditor()&&Pl(this.beans,o,{silent:!0})}))}destroy(){super.destroy(),this.rowNode=void 0,this.startedRows.length=0}},wj=class extends XD{constructor(){super(...arguments),this.beanName="singleCell"}shouldStop(e,t,i="ui"){let n=super.shouldStop(e,t,i);if(n!==null)return n;let{rowNode:o,column:r}=e||{};return(!this.rowNode||!this.column)&&o&&r?null:this.rowNode!==o||this.column!==r}midBatchInputsAllowed(e){return this.model.hasEdits(e)}start(e){let{position:t,startedEdit:i,event:n,ignoreEventKey:o}=e;(this.rowNode!==t.rowNode||this.column!==t.column)&&super.cleanupEditors(),this.rowNode=t.rowNode,this.column=t.column,this.model.start(t),this.setupEditors({cells:[t],position:t,startedEdit:i,event:n,ignoreEventKey:o})}dispatchRowEvent(e,t,i){}processValidationResults(e){return e.fail.length>0&&this.editSvc.cellEditingInvalidCommitBlocks()?{destroy:[],keep:e.all}:{destroy:e.all,keep:[]}}stop(e,t){return super.stop(e,t),this.rowNode=void 0,this.column=void 0,!0}onCellFocusChanged(e){let{colModel:t,editSvc:i}=this.beans,{rowIndex:n,column:o,rowPinned:r}=e,s=lr(this.beans,{rowIndex:n,rowPinned:r}),a=NC(o),l=t.getCol(a),c=e.previousParams;if(c){let d=NC(c.column);if(c?.rowIndex===n&&d===a&&c?.rowPinned===r)return}i?.isEditing({rowNode:s,column:l},{withOpenEditor:!0})&&e.type==="cellFocused"||super.onCellFocusChanged(e)}moveToNextEditingCell(e,t,i,n="ui",o=!1){let r=this.beans.focusSvc.getFocusedCell();r&&(e=dl(this.beans,r)??e);let s=e.cellPosition,a,l=this.beans.gos.get("editType")==="fullRow";l&&this.model.suspend(!0),o||(e.eGui.focus(),this.editSvc?.stopEditing(e,{source:this.editSvc?.isBatchEditing()?"ui":"api",event:i}));try{a=this.beans.navigation?.findNextCellToFocusOn(s,{backwards:t,startEditing:!0})}finally{l&&this.model.suspend(!1)}if(a===!1)return null;if(a==null)return!1;let c=a.cellPosition,d=e.isCellEditable(),u=a.isCellEditable(),h=c&&s.rowIndex===c.rowIndex&&s.rowPinned===c.rowPinned;d&&!o&&this.setFocusOutOnEditor(e);let p=this.gos.get("suppressStartEditOnTab");if(!h&&!o&&(super.cleanupEditors(a,!0),p?a.focusCell(!0,i):this.editSvc.startEditing(a,{startedEdit:!0,event:i,source:n,ignoreEventKey:!0})),u&&!o){if(a.focusCell(!1,i),p)a.focusCell(!0,i);else if(!a.comp?.getCellEditor()){let g=this.editSvc?.isEditing(a,{withOpenEditor:!0});Pl(this.beans,a,{event:i,cellStartedEdit:!0,silent:g}),this.setFocusInOnEditor(a),this.cleanupEditors(a)}}else u&&o&&this.setFocusInOnEditor(a),a.focusCell(!0,i);return e.rowCtrl?.refreshRow({suppressFlash:!0,force:!0}),!0}destroy(){super.destroy(),this.rowNode=void 0,this.column=void 0}},as={moduleName:"EditCore",version:ee,beans:[_W,mj],apiFunctions:{getEditingCells:K$,getEditRowValues:j$,getCellEditorInstances:PW,startEditingCell:J$,stopEditing:Y$,isEditing:X$,validateEdit:Q$},dynamicBeans:{singleCell:wj,fullRow:Cj},dependsOn:[sg,zD],css:[E$]},bj={moduleName:"UndoRedoEdit",version:ee,beans:[x$],apiFunctions:{undoCellEditing:q$,redoCellEditing:$$,getCurrentUndoSize:Z$,getCurrentRedoSize:ej},dependsOn:[as]},yj={moduleName:"TextEditor",version:ee,userComponents:{agCellEditor:z_,agTextCellEditor:z_},dependsOn:[as]},Sj={moduleName:"NumberEditor",version:ee,userComponents:{agNumberCellEditor:{classImp:N$}},dependsOn:[as]},xj={moduleName:"DateEditor",version:ee,userComponents:{agDateCellEditor:M$,agDateStringCellEditor:F$},dependsOn:[as]},Ej={moduleName:"CheckboxEditor",version:ee,userComponents:{agCheckboxCellEditor:R$},dependsOn:[as]},_j={moduleName:"SelectEditor",version:ee,userComponents:{agSelectCellEditor:H$},dependsOn:[as]},Rj={moduleName:"LargeTextEditor",version:ee,userComponents:{agLargeTextCellEditor:A$},dependsOn:[as]},Pj={moduleName:"CustomEditor",version:ee,dependsOn:[as]},Dj=class extends A{constructor(){super(...arguments),this.beanName="selectionColSvc"}postConstruct(){this.addManagedPropertyListener("rowSelection",e=>{this.onSelectionOptionsChanged(e.currentValue,e.previousValue,ml(e.source))}),this.addManagedPropertyListener("selectionColumnDef",this.updateColumns.bind(this))}addColumns(e){let t=this.columns;t!=null&&(e.list=t.list.concat(e.list),e.tree=t.tree.concat(e.tree),zL(e))}createColumns(e,t){let i=()=>{Np(this.beans,this.columns?.tree),this.columns=null},n=e.treeDepth,r=(this.columns?.treeDepth??-1)==n,s=this.generateSelectionCols();if(GL(s,this.columns?.list??[])&&r)return;i();let{colGroupSvc:l}=this.beans,c=l?.findDepth(e.tree)??0,d=l?.balanceTreeForAutoCols(s,c)??[];this.columns={list:s,tree:d,treeDepth:c,map:{}},t(h=>{if(!h)return null;let p=h.filter(g=>!dr(g));return[...s,...p]})}updateColumns(e){let t=ml(e.source);for(let i of this.columns?.list??[]){let n=this.createSelectionColDef(e.currentValue);i.setColDef(n,null,t),Bn(this.beans,{state:[z(b({},n),{colId:i.getColId()})]},t)}}getColumn(e){return this.columns?.list.find(t=>ad(t,e))??null}getColumns(){return this.columns?.list??null}isSelectionColumnEnabled(){let{gos:e,beans:t}=this,i=e.get("rowSelection");if(typeof i!="object"||!ea(e))return!1;let n=(t.autoColSvc?.getColumns()?.length??0)>0;if(i.checkboxLocation==="autoGroupColumn"&&n)return!1;let o=!!fl(i),r=Cp(i);return o||r}createSelectionColDef(e){let{gos:t}=this,i=e??t.get("selectionColumnDef"),n=t.get("enableRtl"),a=i??{},{rowSpan:o,spanRows:r}=a,s=Ai(a,["rowSpan","spanRows"]);return z(b({width:50,resizable:!1,suppressHeaderMenuButton:!0,sortable:!1,suppressMovable:!0,lockPosition:n?"right":"left",comparator(l,c,d,u){let h=d.isSelected(),p=u.isSelected();return h===p?0:h?1:-1},editable:!1,suppressFillHandle:!0,pinned:null},s),{colId:LR,chartDataType:"excluded"})}generateSelectionCols(){if(!this.isSelectionColumnEnabled())return[];let e=this.createSelectionColDef(),t=e.colId;this.gos.validateColDef(e,t,!0);let i=new ua(e,null,t,!1);return this.createBean(i),[i]}onSelectionOptionsChanged(e,t,i){let n=t&&typeof t!="string"?fl(t):void 0,o=e&&typeof e!="string"?fl(e):void 0,r=n!==o,s=t&&typeof t!="string"?Cp(t):void 0,a=e&&typeof e!="string"?Cp(e):void 0,l=s!==a,c=Ap(e),d=Ap(t);(r||l||c!==d)&&this.beans.colModel.refreshAll(i)}destroy(){Np(this.beans,this.columns?.tree),super.destroy()}refreshVisibility(e,t,i){if(!this.columns?.list.length)return;let n=e.length+t.length+i.length;if(n===0)return;let o=this.columns.list[0];if(!o.isVisible())return;let r=()=>{let l;switch(o.pinned){case"left":case!0:l=e;break;case"right":l=i;break;default:l=t}l&&Hn(l,o)};(this.beans.rowNumbersSvc?.getColumn(OR)?2:1)===n&&r()}};function Mj(e,t){if(!t.nodes.every(s=>s.rowPinned&&!Td(s)?(W(59),!1):s.id===void 0?(W(60),!1):!0))return;let{nodes:n,source:o,newValue:r}=t;e.selectionSvc?.setNodesSelected({nodes:n,source:o??"api",newValue:r})}function kj(e,t,i="apiSelectAll"){e.selectionSvc?.selectAllRowNodes({source:i,selectAll:t})}function Tj(e,t,i="apiSelectAll"){e.selectionSvc?.deselectAllRowNodes({source:i,selectAll:t})}function Fj(e,t="apiSelectAllFiltered"){e.selectionSvc?.selectAllRowNodes({source:t,selectAll:"filtered"})}function Ij(e,t="apiSelectAllFiltered"){e.selectionSvc?.deselectAllRowNodes({source:t,selectAll:"filtered"})}function Aj(e,t="apiSelectAllCurrentPage"){e.selectionSvc?.selectAllRowNodes({source:t,selectAll:"currentPage"})}function Lj(e,t="apiSelectAllCurrentPage"){e.selectionSvc?.deselectAllRowNodes({source:t,selectAll:"currentPage"})}function Oj(e){return e.selectionSvc?.getSelectedNodes()??[]}function Nj(e){return e.selectionSvc?.getSelectedRows()??[]}var Bj=class extends eH{constructor(){super(...arguments),this.beanName="selectionSvc",this.selectedNodes=new Map,this.detailSelection=new Map,this.masterSelectsDetail=!1}postConstruct(){super.postConstruct();let{gos:e}=this;this.mode=Lp(e),this.groupSelectsDescendants=wd(e),this.groupSelectsFiltered=Op(e)==="filteredDescendants",this.masterSelectsDetail=AE(e)==="detail",this.addManagedPropertyListeners(["groupSelectsChildren","groupSelectsFiltered","rowSelection"],()=>{let t=wd(e),i=Lp(e),n=Op(e)==="filteredDescendants";this.masterSelectsDetail=AE(e)==="detail",(t!==this.groupSelectsDescendants||n!==this.groupSelectsFiltered||i!==this.mode)&&(this.deselectAllRowNodes({source:"api"}),this.groupSelectsDescendants=t,this.groupSelectsFiltered=n,this.mode=i)}),this.addManagedEventListeners({rowSelected:this.onRowSelected.bind(this)})}destroy(){super.destroy(),this.resetNodes()}handleSelectionEvent(e,t,i){if(this.isRowSelectionBlocked(t))return 0;let n=this.inferNodeSelections(t,e.shiftKey,e.metaKey||e.ctrlKey,i);if(n==null)return 0;if(this.selectionCtx.selectAll=!1,"select"in n)return n.reset?this.resetNodes():this.selectRange(n.deselect,!1,i),this.selectRange(n.select,!0,i);{let o=n.checkFilteredNodes?QD(n.node):n.newValue;return this.setNodesSelected({nodes:[n.node],newValue:o,clearSelection:n.clearSelection,keepDescendants:n.keepDescendants,event:e,source:i})}}setNodesSelected({newValue:e,clearSelection:t,suppressFinishActions:i,nodes:n,event:o,source:r,keepDescendants:s=!1}){if(n.length===0)return 0;let{gos:a}=this;if(!ea(a)&&e)return W(132),0;if(n.length>1&&!this.isMultiSelect())return W(130),0;let l=0;for(let c=0;c<n.length;c++){let d=n[c],u=rl(d);if(u.rowPinned&&!Td(u)){W(59);continue}if(u.id===void 0){W(60);continue}this.groupSelectsFiltered&&u.group&&!a.get("treeData")||this.selectRowNode(u,e,o,r)&&(this.detailSelection.delete(u.id),l++),this.groupSelectsDescendants&&u.childrenAfterGroup?.length&&(l+=this.selectChildren(u,e,r))}return i||(n.length===1&&r==="api"&&this.selectionCtx.setRoot(rl(n[0])),e&&(t||!this.isMultiSelect())&&(l+=this.clearOtherNodes(rl(n[0]),s,r)),l>0&&(this.updateGroupsFromChildrenSelections(r),this.dispatchSelectionChanged(r))),l}selectRange(e,t,i){let n=0;return e.forEach(o=>{let r=rl(o);if(r.group&&this.groupSelectsDescendants)return;this.selectRowNode(r,t,void 0,i)&&n++}),n>0&&(this.updateGroupsFromChildrenSelections(i),this.dispatchSelectionChanged(i)),n}selectChildren(e,t,i){let n=this.groupSelectsFiltered?e.childrenAfterAggFilter:e.childrenAfterGroup;return n?this.setNodesSelected({newValue:t,clearSelection:!1,suppressFinishActions:!0,source:i,nodes:n}):0}getSelectedNodes(){return Array.from(this.selectedNodes.values())}getSelectedRows(){let e=[];return this.selectedNodes.forEach(t=>t.data&&e.push(t.data)),e}getSelectionCount(){return this.selectedNodes.size}filterFromSelection(e){let t=new Map;this.selectedNodes.forEach((i,n)=>{e(i)&&t.set(n,i)}),this.selectedNodes=t}updateGroupsFromChildrenSelections(e,t){if(!this.groupSelectsDescendants)return!1;let{gos:i,rowModel:n}=this.beans;if(!Tt(i,n))return!1;let o=n.rootNode;if(!o)return!1;t||(t=new Sd(!0,o),t.active=!1);let r=!1;return t.forEachChangedNodeDepthFirst(s=>{if(s!==o){let a=this.calculateSelectedFromChildren(s);r=this.selectRowNode(s,a===null?!1:a,void 0,e)||r}}),r}clearOtherNodes(e,t,i){let n=new Map,o=0;return this.selectedNodes.forEach(r=>{let s=r.id==e.id;if((t?!Vj(e,r):!0)&&!s){let l=this.selectedNodes.get(r.id);o+=this.setNodesSelected({nodes:[l],newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:i}),this.groupSelectsDescendants&&r.parent&&n.set(r.parent.id,r.parent)}}),n.forEach(r=>{let s=this.calculateSelectedFromChildren(r);this.selectRowNode(r,s===null?!1:s,void 0,i)}),o}onRowSelected(e){let t=e.node;this.groupSelectsDescendants&&t.group||(t.isSelected()?this.selectedNodes.set(t.id,t):this.selectedNodes.delete(t.id))}syncInRowNode(e,t){this.syncInOldRowNode(e,t),this.syncInNewRowNode(e)}createDaemonNode(e){if(!e.id)return;let t=new ts(this.beans);return t.id=e.id,t.data=e.data,t.__selected=e.__selected,t.level=e.level,t}syncInOldRowNode(e,t){t&&e.id!==t.id&&this.selectedNodes.get(t.id)==e&&this.selectedNodes.set(t.id,t)}syncInNewRowNode(e){this.selectedNodes.has(e.id)?(e.__selected=!0,this.selectedNodes.set(e.id,e)):e.__selected=!1}reset(e){let t=this.getSelectionCount();this.resetNodes(),t&&this.dispatchSelectionChanged(e)}resetNodes(){this.selectedNodes.forEach(e=>{this.selectRowNode(e,!1)}),this.selectedNodes.clear()}getBestCostNodeSelection(){let{gos:e,rowModel:t}=this.beans;if(!Tt(e,t))return;let i=t.getTopLevelNodes();if(i===null)return;let n=[];function o(r){for(let s=0,a=r.length;s<a;s++){let l=r[s];l.isSelected()?n.push(l):l.group&&l.childrenAfterGroup&&o(l.childrenAfterGroup)}}return o(i),n}isEmpty(){return this.getSelectionCount()===0}deselectAllRowNodes({source:e,selectAll:t}){let i=Tt(this.gos),n=!1,o=r=>{let s=this.selectRowNode(rl(r),!1,void 0,e);n||(n=s)};if(t==="currentPage"||t==="filtered"){if(!i){tt(102);return}this.getNodesToSelect(t).forEach(o)}else this.selectedNodes.forEach(o),this.reset(e);if(this.selectionCtx.selectAll=!1,i&&this.groupSelectsDescendants){let r=this.updateGroupsFromChildrenSelections(e);n||(n=r)}n&&this.dispatchSelectionChanged(e)}getSelectedCounts(e){let t=0,i=0;return this.getNodesToSelect(e).forEach(n=>{this.groupSelectsDescendants&&n.group||(n.isSelected()?t++:n.selectable&&i++)}),{selectedCount:t,notSelectedCount:i}}getSelectAllState(e){let{selectedCount:t,notSelectedCount:i}=this.getSelectedCounts(e);return JD(t,i)??null}hasNodesToSelect(e){return this.getNodesToSelect(e).filter(t=>t.selectable).length>0}getNodesToSelect(e){if(!this.canSelectAll())return[];let t=[],i=o=>t.push(o);if(e==="currentPage")return this.forEachNodeOnPage(o=>{if(!o.group){i(o);return}if(!o.expanded&&!o.footer){let r=s=>{i(s),s.childrenAfterFilter?.forEach(r)};r(o);return}this.groupSelectsDescendants||i(o)}),t;let n=this.beans.rowModel;return e==="filtered"?(n.forEachNodeAfterFilter(i),t):(n.forEachNode(i),t)}forEachNodeOnPage(e){let{pageBounds:t,rowModel:i}=this.beans,n=t.getFirstRow(),o=t.getLastRow();for(let r=n;r<=o;r++){let s=i.getRow(r);s&&e(s)}}selectAllRowNodes(e){let{gos:t,selectionCtx:i}=this;if(!ea(t)){W(132);return}if(DL(t)&&!Cd(t)){W(130);return}if(!this.canSelectAll())return;let{source:n,selectAll:o}=e,r=!1;if(this.getNodesToSelect(o).forEach(s=>{let a=this.selectRowNode(rl(s),!0,void 0,n);r||(r=a)}),i.selectAll=!0,Tt(t)&&this.groupSelectsDescendants){let s=this.updateGroupsFromChildrenSelections(n);r||(r=s)}r&&this.dispatchSelectionChanged(n)}getSelectionState(){return this.isEmpty()?null:Array.from(this.selectedNodes.keys())}setSelectionState(e,t,i){if(e||(e=[]),!Array.isArray(e)){tt(103);return}let n=new Set(e),o=[];this.beans.rowModel.forEachNode(r=>{n.has(r.id)&&o.push(r)}),i&&this.resetNodes(),this.setNodesSelected({newValue:!0,nodes:o,source:t})}canSelectAll(){return Tt(this.beans.gos)}updateSelectable(e){let{gos:t,rowModel:i}=this.beans;if(!ea(t))return;let n="selectableChanged",o=e!==void 0,r=Tt(t)&&this.groupSelectsDescendants,s=[],a=l=>{if(o&&!l.group)return;if(r&&l.group){let d=l.childrenAfterGroup?.some(u=>u.selectable)??!1;this.setRowSelectable(l,d,!0);return}!this.updateRowSelectable(l,!0)&&l.isSelected()&&s.push(l)};if(r){if(e===void 0){let l=i.rootNode;e=l?new Sd(!1,l):void 0}e?.forEachChangedNodeDepthFirst(a,!o,!o)}else i.forEachNode(a);s.length&&this.setNodesSelected({nodes:s,newValue:!1,source:n}),!o&&r&&this.updateGroupsFromChildrenSelections?.(n)}updateSelectableAfterGrouping(e){this.updateSelectable(e),this.groupSelectsDescendants&&this.updateGroupsFromChildrenSelections?.("rowGroupChanged",e)&&this.dispatchSelectionChanged("rowGroupChanged")}refreshMasterNodeState(e,t){if(!this.masterSelectsDetail)return;let i=e.detailNode?.detailGridInfo?.api;if(!i)return;let n=Hj(i);if(e.isSelected()!==n&&this.selectRowNode(e,n,t,"masterDetail")&&this.dispatchSelectionChanged("masterDetail"),!n){let r=this.detailSelection.get(e.id)??new Set;for(let s of i.getSelectedNodes())r.add(s.id);this.detailSelection.set(e.id,r)}}setDetailSelectionState(e,t,i){if(this.masterSelectsDetail){if(!Cd(t)){W(269);return}switch(e.isSelected()){case!0:{i.selectAll();break}case!1:{i.deselectAll();break}case void 0:{let n=this.detailSelection.get(e.id);if(n){let o=[];for(let r of n){let s=i.getRowNode(r);s&&o.push(s)}i.setNodesSelected({nodes:o,newValue:!0,source:"masterDetail"})}break}default:break}}}dispatchSelectionChanged(e){this.eventSvc.dispatchEvent({type:"selectionChanged",source:e,selectedNodes:this.getSelectedNodes(),serverSideState:null})}};function rl(e){return Td(e)?e.pinnedSibling:e.footer?e.sibling:e}function Hj(e){let t=0,i=0;return e.forEachNode(n=>{n.isSelected()?t++:n.selectable&&i++}),JD(t,i)}function JD(e,t){if(e===0&&t===0)return!1;if(!(e>0&&t>0))return e>0}function Vj(e,t){let i=t.parent;for(;i;){if(i===e)return!0;i=i.parent}return!1}function QD(e){let t=e.isSelected()===!1,i=e.childrenAfterFilter?.some(QD)??!1;return t||i}var Gj={moduleName:"SharedRowSelection",version:ee,beans:[Dj],apiFunctions:{setNodesSelected:Mj,selectAll:kj,deselectAll:Tj,selectAllFiltered:Fj,deselectAllFiltered:Ij,selectAllOnCurrentPage:Aj,deselectAllOnCurrentPage:Lj,getSelectedNodes:Oj,getSelectedRows:Nj}},zj={moduleName:"RowSelection",version:ee,rowModels:["clientSide","infinite","viewport"],beans:[Bj],dependsOn:[Gj]};function Wj(e){e.expansionSvc?.expandAll(!0)}function Uj(e){e.expansionSvc?.expandAll(!1)}function ZD(e){e.rowModel?.onRowHeightChanged()}function eM(e){if(e.rowAutoHeight?.active){W(3);return}e.rowModel?.resetRowHeights()}function qj(e,t,i){let n=$U(e);if(n){if(e.rowGroupColsSvc?.columns.length===0){if(t<0){tt(238);return}n.setRowCount(t,i);return}tt(28);return}rg(e)?.setRowCount(t,i)}function $j(e){return Ml(e.gos)?e.rowModel.getBlockStates():e.rowNodeBlockLoader?.getBlockState()??{}}function jj(e){return e.rowModel.isLastRowIndexKnown()}var Kj={moduleName:"CsrmSsrmSharedApi",version:ee,apiFunctions:{expandAll:Wj,collapseAll:Uj}},Yj={moduleName:"RowModelSharedApi",version:ee,apiFunctions:{onRowHeightChanged:ZD,resetRowHeights:eM}},Xj={moduleName:"SsrmInfiniteSharedApi",version:ee,apiFunctions:{setRowCount:qj,getCacheBlockState:$j,isLastRowIndexKnown:jj}},Jj=class extends A{constructor(){super(...arguments),this.beanName="alignedGridsSvc",this.consuming=!1}getAlignedGridApis(){let e=this.gos.get("alignedGrids")??[],t=typeof e=="function";return typeof e=="function"&&(e=e()),e.map(n=>{if(!n){tt(18),t||tt(20);return}if(this.isGridApi(n))return n;let o=n;return"current"in o?o.current?.api:(o.api||tt(19),o.api)}).filter(n=>!!n&&!n.isDestroyed())}isGridApi(e){return!!e&&!!e.dispatchEvent}postConstruct(){let e=this.fireColumnEvent.bind(this);this.addManagedEventListeners({columnMoved:e,columnVisible:e,columnPinned:e,columnGroupOpened:e,columnResized:e,bodyScroll:this.fireScrollEvent.bind(this),alignedGridColumn:({event:t})=>this.onColumnEvent(t),alignedGridScroll:({event:t})=>this.onScrollEvent(t)})}fireEvent(e){if(!this.consuming)for(let t of this.getAlignedGridApis())t.isDestroyed()||t.dispatchEvent(e)}onEvent(e){this.consuming=!0,e(),this.consuming=!1}fireColumnEvent(e){this.fireEvent({type:"alignedGridColumn",event:e})}fireScrollEvent(e){e.direction==="horizontal"&&this.fireEvent({type:"alignedGridScroll",event:e})}onScrollEvent(e){this.onEvent(()=>{this.beans.ctrlsSvc.getScrollFeature().setHorizontalScrollPosition(e.left,!0)})}extractDataFromEvent(e,t){let i=[];return e.columns?e.columns.forEach(n=>{i.push(t(n))}):e.column&&i.push(t(e.column)),i}getMasterColumns(e){return this.extractDataFromEvent(e,t=>t)}getColumnIds(e){return this.extractDataFromEvent(e,t=>t.getColId())}onColumnEvent(e){this.onEvent(()=>{switch(e.type){case"columnMoved":case"columnVisible":case"columnPinned":case"columnResized":{this.processColumnEvent(e);break}case"columnGroupOpened":{this.processGroupOpenedEvent(e);break}case"columnPivotChanged":W(21);break}})}processGroupOpenedEvent(e){let{colGroupSvc:t}=this.beans;if(t)for(let i of e.columnGroups){let n=null;i&&(n=t.getProvidedColGroup(i.getGroupId())),!(i&&!n)&&t.setColumnGroupOpened(n,i.isExpanded(),"alignedGridChanged")}}processColumnEvent(e){let t=e.column,i=null,n=this.beans,{colResize:o,ctrlsSvc:r,colModel:s}=n;if(t&&(i=s.getColDefCol(t.getColId())),t&&!i)return;let a=this.getMasterColumns(e);switch(e.type){case"columnMoved":{let u=e.api.getColumnState().map(h=>({colId:h.colId}));Bn(n,{state:u,applyOrder:!0},"alignedGridChanged")}break;case"columnVisible":{let u=e.api.getColumnState().map(h=>({colId:h.colId,hide:h.hide}));Bn(n,{state:u},"alignedGridChanged")}break;case"columnPinned":{let u=e.api.getColumnState().map(h=>({colId:h.colId,pinned:h.pinned}));Bn(n,{state:u},"alignedGridChanged")}break;case"columnResized":{let d=e,u={};for(let h of a)u[h.getId()]={key:h.getColId(),newWidth:h.getActualWidth()};for(let h of d.flexColumns??[])u[h.getId()]&&delete u[h.getId()];o?.setColumnWidths(Object.values(u),!1,d.finished,"alignedGridChanged");break}}let c=r.getGridBodyCtrl().isVerticalScrollShowing();for(let d of this.getAlignedGridApis())d.setGridOption("alwaysShowVerticalScroll",c)}},Qj={moduleName:"AlignedGrids",version:ee,beans:[Jj],dependsOn:[JP]},Zj=class extends A{constructor(e){super(),this.rootNode=e,this.nextId=0,this.allNodesMap={},U_(e)}getRowNode(e){return this.allNodesMap[e]}setNewRowData(e){let{selectionSvc:t,pinnedRowModel:i,groupStage:n}=this.beans;t?.reset("rowDataChanged"),i?.isManual()&&i.reset(),this.dispatchRowDataUpdateStarted(e),this.allNodesMap=Object.create(null),this.nextId=0;let o=U_(this.rootNode),r=new Array(e.length);o._leafs=r;let s=0,a=n?.getNestedDataGetter(),l=a?new Set:null,c=(d,u)=>{let h=d.level+1;for(let p=0,g=u.length;p<g;++p){let f=u[p];if(!f)continue;let m=this.createRowNode(f,h);if(m.sourceRowIndex=s,r[s++]=m,l&&!l.has(f)){l.add(f),m.treeParent=d;let v=a(f);v&&c(m,v)}}};c(o,e),r.length=s}setImmutableRowData(e,t){let{rootNode:i,gos:n}=this;this.dispatchRowDataUpdateStarted(t);let o=xl(n),r=e.changedRowNodes,{adds:s,updates:a}=r,l=new Set,c=[],d=this.beans.groupStage?.getNestedDataGetter(),u=n.get("suppressMaintainUnsortedOrder")?void 0:!1,h=-1,p=!1,g=(v,C)=>{if(!u&&u!==void 0){let w=v.sourceRowIndex;u=w<=h,h=w}v.data!==C&&(v.updateData(C),s.has(v)||a.add(v),!v.selectable&&v.isSelected()&&c.push(v))},f=(v,C,w)=>{for(let y=0,_=C.length;y<_;++y){let R=C[y];if(!R)continue;let P=this.getRowNode(o({data:R,level:w}));if(P?(g(P,R),p||(p=!!d&&P.treeParent!==v)):(P=this.createRowNode(R,w),s.add(P)),!d||l.has(P)){l.add(P);continue}l.add(P),P.treeParent=v;let B=d(R);B&&f(P,B,w+1)}};f(i,t,0);let m=this.deleteUnusedNodes(l,r,c)||u||s.size>0;if(m){let v=i._leafs??(i._leafs=[]);u===void 0?oK(v,l,r):nK(v,l)&&(r.reordered=!0)}(m||p||a.size)&&(e.rowDataUpdated=!0,this.deselect(c))}deleteUnusedNodes(e,{removals:t},i){let n=this.rootNode._leafs;for(let o=0,r=n.length;o<r;o++){let s=n[o];e.has(s)||(t.add(s),s.isSelected()&&i.push(s),this.deleteNode(s))}return t.size>0}updateRowData(e,t){if(this.dispatchRowDataUpdateStarted(e.add),this.beans.groupStage?.getNestedDataGetter())return W(268),{remove:[],update:[],add:[]};let i=[],n=xl(this.gos),o=this.executeRemove(n,e,t,i),r=this.executeUpdate(n,e,t,i),s=this.executeAdd(e,t);return this.deselect(i),{remove:o,update:r,add:s}}executeRemove(e,{remove:t},{adds:i,updates:n,removals:o},r){let s=this.rootNode._leafs,a=s?.length,l=t?.length;if(!l||!a)return[];let c=0,d=a,u=0,h,p=new Array(l);for(let g=0;g<l;++g){let f=this.lookupNode(e,t[g]);if(!f)continue;let m=f.sourceRowIndex;m<d&&(d=m),m>u&&(u=m),f.isSelected()&&r.push(f),this.deleteNode(f),i.delete(f)?(h??(h=new Set),h.add(f)):(n.delete(f),o.add(f)),p[c++]=f}return p.length=c,c&&iK(s,d,u,o,h),p}executeUpdate(e,{update:t},{adds:i,updates:n},o){let r=t?.length;if(!r)return[];let s=new Array(r),a=0;for(let l=0;l<r;l++){let c=t[l],d=this.lookupNode(e,c);d&&(d.updateData(c),!d.selectable&&d.isSelected()&&o.push(d),s[a++]=d,i.has(d)||n.add(d))}return s.length=a,s}executeAdd(e,t){var i;let n=(i=this.rootNode)._leafs??(i._leafs=[]),o=n.length,r=e.add,s=r?.length;if(!s)return[];let a=o+s,l=this.sanitizeAddIndex(n,e.addIndex);if(l<o){for(let u=o-1,h=a-1;u>=l;--u){let p=n[u];p.sourceRowIndex=h,n[h--]=p}t.reordered=!0}n.length=a;let c=new Array(s),d=t.adds;for(let u=0;u<s;u++){let h=this.createRowNode(r[u],0);d.add(h),h.sourceRowIndex=l,n[l]=h,c[u]=h,l++}return c}dispatchRowDataUpdateStarted(e){this.eventSvc.dispatchEvent({type:"rowDataUpdateStarted",firstRowData:e?.length?e[0]:null})}deselect(e){let t="rowDataChanged",i=this.beans.selectionSvc;e.length&&i?.setNodesSelected({newValue:!1,nodes:e,suppressFinishActions:!0,source:t}),i?.updateGroupsFromChildrenSelections?.(t),e.length&&this.eventSvc.dispatchEvent({type:"selectionChanged",source:t,selectedNodes:i?.getSelectedNodes()??null,serverSideState:null})}createRowNode(e,t){let i=new ts(this.beans);i.parent=this.rootNode,i.level=t,i.group=!1,i.expanded=!1,i.setDataAndId(e,String(this.nextId++));let n=i.id,o=this.allNodesMap;return o[n]&&W(2,{nodeId:n}),o[n]=i,i}deleteNode(e){e.clearRowTopAndRowIndex();let t=e.id,i=this.allNodesMap;i[t]===e&&delete i[t];let n=e.pinnedSibling;n&&this.beans.pinnedRowModel?.pinRow(n,null)}lookupNode(e,t){if(!e)return tK(this.rootNode._leafs,t);let i=e({data:t,level:0}),n=this.allNodesMap[i];return n||(tt(4,{id:i}),null)}sanitizeAddIndex(e,t){let i=e.length;if(typeof t!="number"||t<0||t>=i||Number.isNaN(t))return i;t=Math.ceil(t);let n=this.gos;return t>0&&n.get("treeData")&&n.get("getDataPath")&&(t=eK(e,t)),t}},eK=(e,t)=>{for(let i=0,n=e.length;i<n;i++)if(e[i]?.rowIndex==t-1)return i+1;return t},U_=e=>{e.group=!0,e.level=-1,e.id="ROOT_NODE_ID",e._leafs?.length!==0&&(e._leafs=[]);let t=[],i=[],n=[],o=[];e.childrenAfterGroup=t,e.childrenAfterSort=i,e.childrenAfterAggFilter=n,e.childrenAfterFilter=o;let r=e.sibling;return r&&(r.childrenAfterGroup=t,r.childrenAfterSort=i,r.childrenAfterAggFilter=n,r.childrenAfterFilter=o,r.childrenMapped=e.childrenMapped),e.updateHasChildren(),e},tK=(e,t)=>{if(e)for(let i=0,n=e.length;i<n;i++){let o=e[i];if(o.data===t)return o}return tt(5,{data:t}),null},iK=(e,t,i,n,o)=>{t=Math.max(0,t);for(let r=t,s=e.length;r<s;++r){let a=e[r];r<=i&&(n.has(a)||o?.has(a))||(a.sourceRowIndex=t,e[t++]=a)}e.length=t},nK=(e,t)=>{let i=t.size;e.length=i;let n=0,o=!1,r=!1;for(let s of t){let a=s.sourceRowIndex;a===n?r||(r=o):(a>=0?r=!0:o=!0,s.sourceRowIndex=n,e[n]=s),++n}return r},oK=(e,t,{removals:i,adds:n})=>{let o=e.length;e.length=t.size;let r=0;for(let s=0;s<o;++s){let a=e[s];i.has(a)||(r!==s&&(a.sourceRowIndex=r,e[r]=a),++r)}for(let s of n)s.sourceRowIndex<0&&(s.sourceRowIndex=r,e[r++]=s);e.length=r},tM=e=>{let t=e.childrenAfterSort,i=e.sibling;if(i&&(i.childrenAfterSort=t),!!t)for(let n=0,o=t.length-1;n<=o;n++){let r=t[n],s=n===0,a=n===o;r.firstChild!==s&&(r.firstChild=s,r.dispatchRowEvent("firstChildChanged")),r.lastChild!==a&&(r.lastChild=a,r.dispatchRowEvent("lastChildChanged")),r.childIndex!==n&&(r.childIndex=n,r.dispatchRowEvent("childIndexChanged"))}},rK=class extends A{constructor(){super(...arguments),this.beanName="sortStage",this.step="sort",this.refreshProps=["postSortRows","groupDisplayType","accentedSort"]}execute(e){let t=this.beans.sortSvc.getSortOptions(),i=t.length>0&&!!e.changedRowNodes&&this.gos.get("deltaSort");this.sort(t,i,e.changedRowNodes,e.changedPath)}sort(e,t,i,n){let{gos:o,colModel:r,rowGroupColsSvc:s,rowNodeSorter:a,rowRenderer:l,showRowGroupCols:c}=this.beans,d=o.get("groupMaintainOrder"),u=r.getCols().some(C=>C.isRowGroupActive()),h=s?.columns,p=r.isPivotMode(),g=o.getCallback("postSortRows"),f=!1,m,v=C=>{let w=p&&C.leafGroup,y=d&&u&&!C.leafGroup;y&&(m??(m=this.shouldSortContainsGroupCols(e)),y&&(y=!m));let _=null;if(y){let R=!1;if(h){let P=C.level+1;P<h.length&&(R=h[P].getSort()===null)}R||(_=lK(C))}else!e.length||w||(t&&i?_=sK(a,C,i,n,e):_=a.doFullSort(C.childrenAfterAggFilter,e));if(_||(_=C.childrenAfterAggFilter?.slice(0)??[]),f||(f=C.childrenAfterSort?.[0]!==_[0]),C.childrenAfterSort=_,tM(C),g){let R={nodes:C.childrenAfterSort};g(R)}};if(n?.forEachChangedNodeDepthFirst(v),f&&o.get("groupHideOpenParents")){let C=c?.getShowRowGroupCols();C?.length&&l.refreshCells({columns:C,force:!0})}}shouldSortContainsGroupCols(e){let t=e.length;if(!t)return!1;if(go(this.gos)){for(let i=0;i<t;++i){let n=e[i].column;if(n.isPrimary()&&n.isRowGroupActive())return!0}return!1}for(let i=0;i<t;++i)if(e[i].column.getColDef().showRowGroup)return!0;return!1}},sK=(e,t,i,n,o)=>{let r=t.childrenAfterAggFilter,s=t.childrenAfterSort;if(!s)return e.doFullSort(r,o);let a=new Set,l=[],{updates:c,adds:d}=i;for(let h=0,p=r.length;h<p;++h){let g=r[h];c.has(g)||d.has(g)||n&&!n.canSkip(g)?l.push({currentPos:l.length,rowNode:g}):a.add(g)}let u=s.filter(h=>a.has(h)).map((h,p)=>({currentPos:p,rowNode:h}));return l.sort((h,p)=>e.compareRowNodes(o,h,p)),aK(e,o,l,u)},aK=(e,t,i,n)=>{let o=0,r=0,s=i.length,a=n.length,l=new Array(s+a),c=0;for(;o<s&&r<a;){let d=i[o],u=n[r];e.compareRowNodes(t,d,u)<0?(l[c++]=d.rowNode,++o):(l[c++]=u.rowNode,++r)}for(;o<s;)l[c++]=i[o++].rowNode;for(;r<a;)l[c++]=n[r++].rowNode;return l},lK=e=>{let t=e.childrenAfterSort,i=e.childrenAfterAggFilter,n=t?.length,o=i?.length;if(!n||!o)return null;let r=new Array(o),s=new Set;for(let l=0;l<o;++l)s.add(i[l]);let a=0;for(let l=0;l<n;++l){let c=t[l];s.delete(c)&&(r[a++]=c)}if(s.size===0&&a===n)return t;for(let l of s)r[a++]=l;return r.length=a,r},cK=class extends A{constructor(){super(...arguments),this.beanName="rowModel",this.rootNode=null,this.rowCountReady=!1,this.nodeManager=void 0,this.rowsToDisplay=[],this.rowDataUpdatedPending=!1,this.asyncTransactions=null,this.asyncTransactionsTimer=0,this.started=!1,this.refreshingModel=!1,this.rowNodesCountReady=!1,this.stages=[],this.stagesRefreshProps=new Map,this.onRowHeightChanged_debounced=si(this,this.onRowHeightChanged.bind(this),100)}postConstruct(){let e=this.beans,t=new ts(e);this.rootNode=t,this.nodeManager=this.createBean(new Zj(t));let i=this.refreshModel.bind(this,{step:"group"}),n=this.refreshModel.bind(this,{step:"group",afterColumnsChanged:!0,keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame")});this.addManagedEventListeners({newColumnsLoaded:n,columnRowGroupChanged:i,columnValueChanged:this.onValueChanged.bind(this),columnPivotChanged:this.refreshModel.bind(this,{step:"pivot"}),filterChanged:this.onFilterChanged.bind(this),sortChanged:this.onSortChanged.bind(this),columnPivotModeChanged:i,gridStylesChanged:this.onGridStylesChanges.bind(this),gridReady:this.onGridReady.bind(this),rowExpansionStateChanged:this.onRowGroupOpened.bind(this)}),this.addPropertyListeners()}addPropertyListeners(){let{beans:e,stagesRefreshProps:t}=this,i=[e.groupStage,e.filterStage,e.pivotStage,e.aggStage,e.sortStage,e.filterAggStage,e.flattenStage].filter(n=>!!n);this.stages=i;for(let n=i.length-1;n>=0;--n)for(let o of i[n].refreshProps)t.set(o,n);this.addManagedPropertyListeners([...t.keys()],n=>{let o=n.changeSet?.properties;o&&this.onPropChange(o)}),this.addManagedPropertyListener("rowData",()=>this.onPropChange(["rowData"])),this.addManagedPropertyListener("rowHeight",()=>this.resetRowHeights())}start(){this.started=!0,this.rowNodesCountReady?this.refreshModel({step:"group",rowDataUpdated:!0,newData:!0}):this.setInitialData()}setInitialData(){this.gos.get("rowData")&&this.onPropChange(["rowData"])}ensureRowHeightsValid(e,t,i,n){let o,r=!1;do{o=!1;let s=this.getRowIndexAtPixel(e),a=this.getRowIndexAtPixel(t),l=Math.max(s,i),c=Math.min(a,n);for(let d=l;d<=c;d++){let u=this.getRow(d);if(u.rowHeightEstimated){let h=Zr(this.beans,u);u.setRowHeight(h.height),o=!0,r=!0}}o&&this.setRowTopAndRowIndex()}while(o);return r}onPropChange(e){let{nodeManager:t,gos:i,beans:n}=this,o=n.groupStage;if(!t)return;let r=new Set(e),s=o?.onPropChange(r),a;r.has("rowData")?a=i.get("rowData"):s&&(a=o?.extractData()),a&&!Array.isArray(a)&&(a=null,W(1));let l={step:"nothing",changedProps:r};a&&(!s&&!this.isEmpty()&&a.length>0&&i.exists("getRowId")&&!i.get("resetRowDataOnUpdate")?(l.keepRenderedRows=!0,l.animate=!i.get("suppressAnimationFrame"),l.changedRowNodes=new xp,t.setImmutableRowData(l,a)):(l.rowDataUpdated=!0,l.newData=!0,t.setNewRowData(a),this.rowNodesCountReady=!0));let c=l.rowDataUpdated?"group":this.getRefreshedStage(e);c&&(l.step=c,this.refreshModel(l))}getRefreshedStage(e){let{stages:t,stagesRefreshProps:i}=this,n=t.length,o=n;for(let r=0,s=e.length;r<s&&o;++r)o=Math.min(o,i.get(e[r])??o);return o<n?t[o].step:null}setRowTopAndRowIndex(e){let{beans:t,rowsToDisplay:i}=this,n=t.environment.getDefaultRowHeight(),o=0,r=li(this.gos,"normal");for(let s=0,a=i.length;s<a;++s){let l=i[s],c=l.id;if(c!=null&&e?.add(c),l.rowHeight==null){let d=Zr(t,l,r,n);l.setRowHeight(d.height,d.estimated)}l.setRowTop(o),l.setRowIndex(s),o+=l.rowHeight}}clearRowTopAndRowIndex(e,t){let i=e.active,n=s=>{s?.id!=null&&!t.has(s.id)&&s.clearRowTopAndRowIndex()},o=s=>{n(s),n(s.detailNode),n(s.sibling);let a=s.childrenAfterGroup;if(!s.hasChildren()||!a)return;let l=s.level==-1;if(!(i&&!l&&!s.expanded))for(let d=0,u=a.length;d<u;++d)o(a[d])},r=this.rootNode;r&&o(r)}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay.length}getTopLevelRowCount(){let{rootNode:e,rowsToDisplay:t}=this;if(!e||!t.length)return 0;if(t[0]===e)return 1;let n=e.sibling?.displayed?1:0;return(e.childrenAfterSort?.length??0)+n}getTopLevelRowDisplayedIndex(e){let{beans:t,rootNode:i,rowsToDisplay:n}=this;if(!i||!n.length||n[0]===i)return e;let r=i.childrenAfterSort,s=l=>{let c=r[l];if(this.gos.get("groupHideOpenParents"))for(;c.expanded&&c.childrenAfterSort&&c.childrenAfterSort.length>0;)c=c.childrenAfterSort[0];return c.rowIndex},a=t.footerSvc;return a?a?.getTopDisplayIndex(n,e,r,s):s(e)}getTopLevelIndexFromDisplayedIndex(e){let{rootNode:t,rowsToDisplay:i}=this;if(!t||!i.length||i[0]===t)return e;let o=this.getRow(e);o.footer&&(o=o.sibling);let r=o.parent;for(;r&&r!==t;)o=r,r=o.parent;let s=t.childrenAfterSort?.indexOf(o)??-1;return s>=0?s:e}getRowBounds(e){let t=this.rowsToDisplay[e];return t?{rowTop:t.rowTop,rowHeight:t.rowHeight}:null}onRowGroupOpened(){this.refreshModel({step:"map",keepRenderedRows:!0,animate:gl(this.gos)})}onFilterChanged({afterDataChange:e,columns:t}){if(!e){let n=t.length===0||t.some(o=>o.isPrimary())?"filter":"filter_aggregates";this.refreshModel({step:n,keepRenderedRows:!0,animate:gl(this.gos)})}}onSortChanged(){this.refreshModel({step:"sort",keepRenderedRows:!0,animate:gl(this.gos)})}getType(){return"clientSide"}onValueChanged(){this.refreshModel({step:this.beans.colModel.isPivotActive()?"pivot":"aggregate"})}createChangePath(e){let t=new Sd(!1,this.rootNode);return t.active=e,t}isSuppressModelUpdateAfterUpdateTransaction(e){if(!this.gos.get("suppressModelUpdateAfterUpdateTransaction"))return!1;let{changedRowNodes:t,newData:i,rowDataUpdated:n}=e;return!(!t||i||!n||t.removals.size||t.adds.size)}refreshModel(e){let{nodeManager:t,beans:i,eventSvc:n,started:o,refreshingModel:r}=this;if(!t)return;let s=!!e.rowDataUpdated,a=e.changedPath??(e.changedPath=this.createChangePath(!e.newData&&s));if(o&&s&&n.dispatchEvent({type:"rowDataUpdated"}),!o||r||i.colModel.changeEventsDispatching||this.isSuppressModelUpdateAfterUpdateTransaction(e)){this.rowDataUpdatedPending||(this.rowDataUpdatedPending=s);return}switch(this.rowDataUpdatedPending&&(this.rowDataUpdatedPending=!1,e.step="group"),this.refreshingModel=!0,i.masterDetailSvc?.refreshModel(e),s&&e.step!=="group"&&i.colFilter?.refreshModel(),e.step){case"group":this.doGrouping(e);case"filter":this.doFilter(a);case"pivot":this.doPivot(a);case"aggregate":this.doAggregate(a);case"filter_aggregates":this.doFilterAggregates(a);case"sort":this.doSort(e.changedRowNodes,a);case"map":this.doRowsToDisplay()}let l=new Set;this.setRowTopAndRowIndex(l),this.clearRowTopAndRowIndex(a,l),this.refreshingModel=!1,n.dispatchEvent({type:"modelUpdated",animate:e.animate,keepRenderedRows:e.keepRenderedRows,newData:e.newData,newPage:!1,keepUndoRedoStack:e.keepUndoRedoStack})}isEmpty(){return!this.rootNode?._leafs?.length||!this.beans.colModel?.ready}isRowsToRender(){return this.rowsToDisplay.length>0}getNodesInRangeForSelection(e,t){let i=!1,n=!1,o=[],r=wd(this.gos);return this.forEachNodeAfterFilterAndSort(s=>{if(n)return;if(i&&(s===t||s===e)&&(n=!0,r&&s.group)){iM(o,s);return}if(!i){if(s!==t&&s!==e)return;i=!0,t===e&&(n=!0)}(!s.group||!r)&&o.push(s)}),o}getTopLevelNodes(){return this.rootNode?.childrenAfterGroup??null}getRow(e){return this.rowsToDisplay[e]}isRowPresent(e){return this.rowsToDisplay.indexOf(e)>=0}getRowIndexAtPixel(e){let t=this.rowsToDisplay,i=t.length;if(this.isEmpty()||i===0)return-1;let n=0,o=i-1;if(e<=0)return 0;if(t[o].rowTop<=e)return o;let s=-1,a=-1;for(;;){let l=Math.floor((n+o)/2),c=t[l];if(this.isRowInPixel(c,e)||(c.rowTop<e?n=l+1:c.rowTop>e&&(o=l-1),s===n&&a===o))return l;s=n,a=o}}isRowInPixel(e,t){let i=e.rowTop,n=i+e.rowHeight;return i<=t&&n>t}forEachLeafNode(e){let t=this.rootNode?._leafs;if(t)for(let i=0,n=t.length;i<n;++i)e(t[i],i)}forEachNode(e,t=!1){this.depthFirstSearchRowNodes(e,t)}forEachDisplayedNode(e){let t=this.rowsToDisplay;for(let i=0,n=t.length;i<n;++i)e(t[i],i)}forEachNodeAfterFilter(e,t=!1){this.depthFirstSearchRowNodes(e,t,i=>i.childrenAfterAggFilter)}forEachNodeAfterFilterAndSort(e,t=!1){this.depthFirstSearchRowNodes(e,t,i=>i.childrenAfterSort)}forEachPivotNode(e,t,i){let{colModel:n,rowGroupColsSvc:o}=this.beans;if(!n.isPivotMode())return;if(!o?.columns.length){e(this.rootNode,0);return}let r=i?"childrenAfterSort":"childrenAfterGroup";this.depthFirstSearchRowNodes(e,t,s=>s.leafGroup?null:s[r])}depthFirstSearchRowNodes(e,t=!1,i=r=>r.childrenAfterGroup,n=this.rootNode,o=0){let r=o;if(!n)return r;let s=n===this.rootNode;if(s||e(n,r++),n.hasChildren()&&!n.footer){let a=i(n);if(a){let l=this.beans.footerSvc;r=l?.addTotalRows(r,n,e,t,s,"top")??r;for(let c of a)r=this.depthFirstSearchRowNodes(e,t,i,c,r);return l?.addTotalRows(r,n,e,t,s,"bottom")??r}}return r}doAggregate(e){let t=this.rootNode;t&&this.beans.aggStage?.execute({rowNode:t,changedPath:e})}doFilterAggregates(e){let t=this.rootNode,i=this.beans.filterAggStage;if(i){i.execute({rowNode:t,changedPath:e});return}t.childrenAfterAggFilter=t.childrenAfterFilter}doSort(e,t){let i=this.beans.sortStage;if(i){i.execute({rowNode:this.rootNode,changedRowNodes:e,changedPath:t});return}t.forEachChangedNodeDepthFirst(n=>{n.childrenAfterSort=n.childrenAfterAggFilter.slice(0),tM(n)})}doGrouping(e){let t=this.rootNode,n=this.beans.groupStage?.execute({rowNode:t,changedRowNodes:e.changedRowNodes,changedPath:e.changedPath,afterColumnsChanged:!!e.afterColumnsChanged});if(n===void 0){let o=t._leafs;t.childrenAfterGroup=o,t.updateHasChildren();let r=t.sibling;r&&(r.childrenAfterGroup=o)}(n||e.rowDataUpdated)&&this.beans.colFilter?.refreshModel(),!this.rowCountReady&&this.rowNodesCountReady&&(this.rowCountReady=!0,this.eventSvc.dispatchEventOnce({type:"rowCountReady"}))}doFilter(e){let t=this.beans.filterStage;if(t){t.execute({rowNode:this.rootNode,changedPath:e});return}e.forEachChangedNodeDepthFirst(i=>{i.childrenAfterFilter=i.childrenAfterGroup,PD(i)},!0)}doPivot(e){this.beans.pivotStage?.execute({rowNode:this.rootNode,changedPath:e})}getRowNode(e){let t=this.nodeManager?.getRowNode(e);return typeof t=="object"?t:typeof e=="string"&&e.indexOf(PC)===0?this.beans.groupStage?.getNode(e):void 0}batchUpdateRowData(e,t){if(!this.asyncTransactionsTimer){this.asyncTransactions=[];let i=this.gos.get("asyncTransactionWaitMillis");this.asyncTransactionsTimer=setTimeout(()=>this.executeBatchUpdateRowData(),i)}this.asyncTransactions.push({rowDataTransaction:e,callback:t})}flushAsyncTransactions(){let e=this.asyncTransactionsTimer;e&&(clearTimeout(e),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){let{nodeManager:e,beans:t,eventSvc:i,asyncTransactions:n}=this;if(!e)return;t.valueCache?.onDataChanged();let o=[],r=[],s=new xp;for(let{rowDataTransaction:a,callback:l}of n??[]){this.rowNodesCountReady=!0;let c=e.updateRowData(a,s);o.push(c),l&&r.push(l.bind(null,c))}this.commitTransactions(s),r.length>0&&setTimeout(()=>{for(let a=0,l=r.length;a<l;a++)r[a]()},0),o.length>0&&i.dispatchEvent({type:"asyncTransactionsFlushed",results:o}),this.asyncTransactionsTimer=0,this.asyncTransactions=null}updateRowData(e){let t=this.nodeManager;if(!t)return null;this.beans.valueCache?.onDataChanged(),this.rowNodesCountReady=!0;let i=new xp,n=t.updateRowData(e,i);return this.commitTransactions(i),n}commitTransactions(e){this.refreshModel({step:"group",rowDataUpdated:!0,keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame"),changedRowNodes:e,changedPath:this.createChangePath(!0)})}doRowsToDisplay(){let{beans:e,rootNode:t}=this,i=e.flattenStage;if(i){this.rowsToDisplay=i.execute({rowNode:t});return}let n=this.rootNode.childrenAfterSort??[];for(let o of n)o.setUiLevel(0);this.rowsToDisplay=n}onRowHeightChanged(){this.refreshModel({step:"map",keepRenderedRows:!0,keepUndoRedoStack:!0})}resetRowHeights(){let e=this.rootNode;if(!e)return;let t=this.resetRowHeightsForAllRowNodes();e.setRowHeight(e.rowHeight,!0);let i=e.sibling;i?.setRowHeight(i.rowHeight,!0),t&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let e=!1;return this.forEachNode(t=>{t.setRowHeight(t.rowHeight,!0);let i=t.detailNode;i?.setRowHeight(i.rowHeight,!0);let n=t.sibling;n?.setRowHeight(n.rowHeight,!0),e=!0}),e}onGridStylesChanges(e){e.rowHeightChanged&&!this.beans.rowAutoHeight?.active&&this.resetRowHeights()}onGridReady(){this.started||this.setInitialData()}destroy(){super.destroy(),this.nodeManager=this.destroyBean(this.nodeManager),this.started=!1,this.rootNode=null,this.rowsToDisplay=[],this.asyncTransactions=null,clearTimeout(this.asyncTransactionsTimer)}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}},iM=(e,t)=>{let i=t.childrenAfterGroup;if(i)for(let n=0,o=i.length;n<o;++n){let r=i[n];r.data&&e.push(r),r.group&&iM(e,r)}};function dK(e){e.expansionSvc?.onGroupExpandedOrCollapsed()}function uK(e,t){let i=ss(e);i&&((!t||t==="everything")&&(t="group"),i.refreshModel({step:t,keepRenderedRows:!0,animate:!e.gos.get("suppressAnimationFrame")}))}function hK(e){return ss(e)?.isEmpty()??!0}function pK(e,t){ss(e)?.forEachLeafNode(t)}function gK(e,t){ss(e)?.forEachNodeAfterFilter(t)}function fK(e,t){ss(e)?.forEachNodeAfterFilterAndSort(t)}function mK(e,t){return e.frameworkOverrides.wrapIncoming(()=>ss(e)?.updateRowData(t))}function vK(e,t,i){e.frameworkOverrides.wrapIncoming(()=>ss(e)?.batchUpdateRowData(t,i))}function CK(e){e.frameworkOverrides.wrapIncoming(()=>ss(e)?.flushAsyncTransactions())}function wK(e){return e.selectionSvc?.getBestCostNodeSelection()}var bK={moduleName:"ClientSideRowModel",version:ee,rowModels:["clientSide"],beans:[cK,rK],dependsOn:[yD]},yK={moduleName:"ClientSideRowModelApi",version:ee,apiFunctions:{onGroupExpandedOrCollapsed:dK,refreshClientSideRowModel:uK,isRowDataEmpty:hK,forEachLeafNode:pK,forEachNodeAfterFilter:gK,forEachNodeAfterFilterAndSort:fK,applyTransaction:mK,applyTransactionAsync:vK,flushAsyncTransactions:CK,getBestCostNodeSelection:wK,resetRowHeights:eM,onRowHeightChanged:ZD},dependsOn:[Kj,Yj]},SK=class extends A{constructor(){super(...arguments),this.beanName="gridSerializer"}wireBeans(e){this.visibleCols=e.visibleCols,this.colModel=e.colModel,this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel}serialize(e,t={}){let{allColumns:i,columnKeys:n,skipRowGroups:o,exportRowNumbers:r}=t,s=this.getColumnsToExport({allColumns:i,skipRowGroups:o,columnKeys:n,exportRowNumbers:r});return[this.prepareSession(s),this.prependContent(t),this.exportColumnGroups(t,s),this.exportHeaders(t,s),this.processPinnedTopRows(t,s),this.processRows(t,s),this.processPinnedBottomRows(t,s),this.appendContent(t)].reduce((a,l)=>l(a),e).parse()}processRow(e,t,i,n){let o=t.shouldRowBeSkipped||(()=>!1),s=t.rowPositions!=null||!!t.onlySelected,a=this.gos.get("groupHideOpenParents")&&!s,l=this.colModel.isPivotMode()?n.leafGroup:!n.group,c=!!n.footer,d=n.allChildrenCount===1&&n.childrenAfterGroup?.length===1&&RL(this.gos,n);if(!l&&!c&&(t.skipRowGroups||d||a)||t.onlySelected&&!n.isSelected()||t.skipPinnedTop&&n.rowPinned==="top"||t.skipPinnedBottom&&n.rowPinned==="bottom"||n.stub||n.level===-1&&!l&&!c||o(ye(this.gos,{node:n})))return;let p=e.onNewBodyRow(n);if(i.forEach((g,f)=>{p.onColumn(g,f,n)}),t.getCustomContentBelowRow){let g=t.getCustomContentBelowRow(ye(this.gos,{node:n}));g&&e.addCustomContent(g)}}appendContent(e){return t=>{let i=e.appendContent;return i&&t.addCustomContent(i),t}}prependContent(e){return t=>{let i=e.prependContent;return i&&t.addCustomContent(i),t}}prepareSession(e){return t=>(t.prepare(e),t)}exportColumnGroups(e,t){return i=>{if(!e.skipColumnGroupHeaders){let n=new $R,{colGroupSvc:o}=this.beans,r=o?o.createColumnGroups({columns:t,idCreator:n,pinned:null,isStandaloneStructure:!0}):t;this.recursivelyAddHeaderGroups(r,i,e.processGroupHeaderCallback)}return i}}exportHeaders(e,t){return i=>{if(!e.skipColumnHeaders){let n=i.onNewHeaderRow();t.forEach((o,r)=>{n.onColumn(o,r,void 0)})}return i}}processPinnedTopRows(e,t){return i=>{let n=this.processRow.bind(this,i,e,t);return e.rowPositions?e.rowPositions.filter(o=>o.rowPinned==="top").sort((o,r)=>o.rowIndex-r.rowIndex).map(o=>this.pinnedRowModel?.getPinnedTopRow(o.rowIndex)).forEach(n):this.pinnedRowModel?.isManual()||this.pinnedRowModel?.forEachPinnedRow("top",n),i}}processRows(e,t){return i=>{let n=this.rowModel,o=Tt(this.gos,n),r=Ml(this.gos,n),s=!o&&e.onlySelected,a=this.processRow.bind(this,i,e,t),{exportedRows:l="filteredAndSorted"}=e;if(e.rowPositions)e.rowPositions.filter(c=>c.rowPinned==null).sort((c,d)=>c.rowIndex-d.rowIndex).map(c=>n.getRow(c.rowIndex)).forEach(a);else if(this.colModel.isPivotMode())o?n.forEachPivotNode(a,!0,l==="filteredAndSorted"):r?n.forEachNodeAfterFilterAndSort(a,!0):n.forEachNode(a);else if(e.onlySelectedAllPages||s){let c=this.beans.selectionSvc?.getSelectedNodes()??[];this.replicateSortedOrder(c),c.forEach(a)}else l==="all"?n.forEachNode(a):o||r?n.forEachNodeAfterFilterAndSort(a,!0):n.forEachNode(a);return i}}replicateSortedOrder(e){let{sortSvc:t,rowNodeSorter:i}=this.beans;if(!t||!i)return;let n=t.getSortOptions(),o=(r,s)=>r.rowIndex!=null&&s.rowIndex!=null?r.rowIndex-s.rowIndex:r.level===s.level?r.parent?.id===s.parent?.id?i.compareRowNodes(n,{rowNode:r,currentPos:r.rowIndex??-1},{rowNode:s,currentPos:s.rowIndex??-1}):o(r.parent,s.parent):r.level>s.level?o(r.parent,s):o(r,s.parent);e.sort(o)}processPinnedBottomRows(e,t){return i=>{let n=this.processRow.bind(this,i,e,t);return e.rowPositions?e.rowPositions.filter(o=>o.rowPinned==="bottom").sort((o,r)=>o.rowIndex-r.rowIndex).map(o=>this.pinnedRowModel?.getPinnedBottomRow(o.rowIndex)).forEach(n):this.pinnedRowModel?.isManual()||this.pinnedRowModel?.forEachPinnedRow("bottom",n),i}}getColumnsToExport(e){let{allColumns:t=!1,skipRowGroups:i=!1,exportRowNumbers:n=!1,columnKeys:o}=e,{colModel:r,gos:s,visibleCols:a}=this,l=r.isPivotMode(),c=h=>dr(h)?!1:!or(h)||n;if(o?.length)return r.getColsForKeys(o).filter(c);let d=s.get("treeData"),u=[];return t&&!l?u=r.getCols():u=a.allCols,u=u.filter(h=>c(h)&&(i&&!d?!iw(h):!0)),u}recursivelyAddHeaderGroups(e,t,i){let n=[];for(let o of e){let r=o;if(r.getChildren)for(let s of r.getChildren()??[])n.push(s)}e.length>0&&kt(e[0])&&this.doAddHeaderHeader(t,e,i),n&&n.length>0&&this.recursivelyAddHeaderGroups(n,t,i)}doAddHeaderHeader(e,t,i){let n=e.onNewHeaderGroupingRow(),o=0;for(let r of t){let s=r,a;i?a=i(ye(this.gos,{columnGroup:s})):a=this.beans.colNames.getDisplayNameForColumnGroup(s,"header");let c=(s.isExpandable()?s.getLeafColumns():[]).reduce((d,u,h,p)=>{let g=rt(d);return u.getColumnGroupShow()==="open"?(!g||g[1]!=null)&&(g=[h],d.push(g)):g&&g[1]==null&&(g[1]=h-1),h===p.length-1&&g&&g[1]==null&&(g[1]=h),d},[]);n.onColumn(s,a||"",o++,s.getLeafColumns().length-1,c)}}},xK={moduleName:"SharedExport",version:ee,beans:[SK]},q_=`\r
`,EK=class extends QU{constructor(e){super(e),this.config=e,this.isFirstLine=!0,this.result="";let{suppressQuotes:t,columnSeparator:i}=e;this.suppressQuotes=t,this.columnSeparator=i}addCustomContent(e){e&&(typeof e=="string"?(/^\s*\n/.test(e)||this.beginNewLine(),e=e.replace(/\r?\n/g,q_),this.result+=e):e.forEach(t=>{this.beginNewLine(),t.forEach((i,n)=>{n!==0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(i.data.value||""),i.mergeAcross&&this.appendEmptyCells(i.mergeAcross)})}))}onNewHeaderGroupingRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}onNewHeaderGroupingRowColumn(e,t,i,n){i!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(t),this.appendEmptyCells(n)}appendEmptyCells(e){for(let t=1;t<=e;t++)this.result+=this.columnSeparator+this.putInQuotes("")}onNewHeaderRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}onNewHeaderRowColumn(e,t){t!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(e))}onNewBodyRow(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}onNewBodyRowColumn(e,t,i){t!=0&&(this.result+=this.columnSeparator);let n=this.extractRowCellValue(e,t,t,"csv",i);this.result+=this.putInQuotes(n.valueFormatted??n.value)}putInQuotes(e){if(this.suppressQuotes)return e;if(e==null)return'""';let t;return typeof e=="string"?t=e:typeof e.toString=="function"?t=e.toString():(W(53),t=""),'"'+t.replace(/"/g,'""')+'"'}parse(){return this.result}beginNewLine(){this.isFirstLine||(this.result+=q_),this.isFirstLine=!1}},_K=class extends JU{constructor(){super(...arguments),this.beanName="csvCreator"}wireBeans(e){this.colModel=e.colModel,this.colNames=e.colNames,this.rowGroupColsSvc=e.rowGroupColsSvc,this.valueSvc=e.valueSvc}getMergedParams(e){let t=this.gos.get("defaultCsvExportParams");return Object.assign({},t,e)}export(e){if(this.isExportSuppressed()){W(51);return}let t=this.getMergedParams(e),i=this.getData(t),n=new Blob(["\uFEFF",i],{type:"text/plain"}),o=typeof t.fileName=="function"?t.fileName(ye(this.gos,{})):t.fileName;ZU(this.getFileName(o),n)}exportDataAsCsv(e){this.export(e)}getDataAsCsv(e,t=!1){let i=t?Object.assign({},e):this.getMergedParams(e);return this.getData(i)}getDefaultFileExtension(){return"csv"}createSerializingSession(e){let{colModel:t,colNames:i,rowGroupColsSvc:n,valueSvc:o,gos:r}=this,{processCellCallback:s,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c,suppressQuotes:d,columnSeparator:u}=e;return new EK({colModel:t,colNames:i,valueSvc:o,gos:r,processCellCallback:s||void 0,processHeaderCallback:a||void 0,processGroupHeaderCallback:l||void 0,processRowGroupCallback:c||void 0,suppressQuotes:d||!1,columnSeparator:u||",",rowGroupColsSvc:n})}isExportSuppressed(){return this.gos.get("suppressCsvExport")}};function RK(e,t){return e.csvCreator?.getDataAsCsv(t)}function PK(e,t){e.csvCreator?.exportDataAsCsv(t)}var DK={moduleName:"CsvExport",version:ee,beans:[_K],apiFunctions:{getDataAsCsv:RK,exportDataAsCsv:PK},dependsOn:[xK]},MK=class extends A{constructor(e,t,i){super(),this.id=e,this.parentCache=t,this.params=i,this.state="needsLoading",this.version=0,this.startRow=e*i.blockSize,this.endRow=this.startRow+i.blockSize}load(){this.state="loading",this.loadFromDatasource()}setStateWaitingToLoad(){this.version++,this.state="needsLoading"}pageLoadFailed(e){this.isRequestMostRecentAndLive(e)&&(this.state="failed"),this.dispatchLocalEvent({type:"loadComplete"})}pageLoaded(e,t,i){this.successCommon(e,{rowData:t,rowCount:i})}isRequestMostRecentAndLive(e){let t=e===this.version,i=this.isAlive();return t&&i}successCommon(e,t){this.dispatchLocalEvent({type:"loadComplete"}),this.isRequestMostRecentAndLive(e)&&(this.state="loaded",this.processServerResult(t))}postConstruct(){this.rowNodes=[];let{params:{blockSize:e,rowHeight:t},startRow:i,beans:n,rowNodes:o}=this;for(let r=0;r<e;r++){let s=i+r,a=new ts(n);a.setRowHeight(t),a.uiLevel=0,a.setRowIndex(s),a.setRowTop(t*s),o.push(a)}}getBlockStateJson(){let{id:e,startRow:t,endRow:i,state:n}=this;return{id:""+e,state:{blockNumber:e,startRow:t,endRow:i,pageStatus:n}}}setDataAndId(e,t,i){ie(t)?e.setDataAndId(t,i.toString()):e.setDataAndId(void 0,void 0)}loadFromDatasource(){let e=this.createLoadParams();if(mt(this.params.datasource.getRows)){W(90);return}window.setTimeout(()=>{this.params.datasource.getRows(e)},0)}createLoadParams(){let{startRow:e,endRow:t,version:i,params:{sortModel:n,filterModel:o},gos:r}=this;return{startRow:e,endRow:t,successCallback:this.pageLoaded.bind(this,i),failCallback:this.pageLoadFailed.bind(this,i),sortModel:n,filterModel:o,context:ye(r,{}).context}}forEachNode(e,t,i){this.rowNodes.forEach((n,o)=>{this.startRow+o<i&&e(n,t.value++)})}getRow(e,t=!1){t||(this.lastAccessed=this.params.lastAccessedSequence.value++);let i=e-this.startRow;return this.rowNodes[i]}processServerResult(e){let{rowNodes:t,beans:i}=this;t.forEach((o,r)=>{let s=e.rowData?e.rowData[r]:void 0;!o.id&&o.alreadyRendered&&s&&(t[r]=new ts(i),t[r].setRowIndex(o.rowIndex),t[r].setRowTop(o.rowTop),t[r].setRowHeight(o.rowHeight),o.clearRowTopAndRowIndex()),this.setDataAndId(t[r],s,this.startRow+r)});let n=e.rowCount!=null&&e.rowCount>=0?e.rowCount:void 0;this.parentCache.pageLoaded(this,n)}destroy(){for(let e of this.rowNodes)e.clearRowTopAndRowIndex();super.destroy()}},kK=2,TK=class extends A{constructor(e){super(),this.params=e,this.lastRowIndexKnown=!1,this.blocks={},this.blockCount=0,this.rowCount=e.initialRowCount}getRow(e,t=!1){let i=Math.floor(e/this.params.blockSize),n=this.blocks[i];if(!n){if(t)return;n=this.createBlock(i)}return n.getRow(e)}createBlock(e){let t=this.params,i=this.createBean(new MK(e,this,t));return this.blocks[i.id]=i,this.blockCount++,this.purgeBlocksIfNeeded(i),t.rowNodeBlockLoader.addBlock(i),i}refreshCache(){if(this.blockCount==0){this.purgeCache();return}for(let t of this.getBlocksInOrder())t.setStateWaitingToLoad();this.params.rowNodeBlockLoader.checkBlockToLoad()}destroy(){for(let e of this.getBlocksInOrder())this.destroyBlock(e);super.destroy()}getRowCount(){return this.rowCount}isLastRowIndexKnown(){return this.lastRowIndexKnown}pageLoaded(e,t){this.isAlive()&&(Qr(this.gos,`InfiniteCache - onPageLoaded: page = ${e.id}, lastRow = ${t}`),this.checkRowCount(e,t),this.onCacheUpdated())}purgeBlocksIfNeeded(e){let t=this.getBlocksInOrder().filter(s=>s!=e),i=(s,a)=>a.lastAccessed-s.lastAccessed;t.sort(i);let n=this.params.maxBlocksInCache>0,o=n?this.params.maxBlocksInCache-1:null,r=kK-1;t.forEach((s,a)=>{let l=s.state==="needsLoading"&&a>=r,c=n?a>=o:!1;if(l||c){if(this.isBlockCurrentlyDisplayed(s)||this.isBlockFocused(s))return;this.removeBlockFromCache(s)}})}isBlockFocused(e){let t=this.beans.focusSvc.getFocusCellToUseAfterRefresh();if(!t||t.rowPinned!=null)return!1;let{startRow:i,endRow:n}=e;return t.rowIndex>=i&&t.rowIndex<n}isBlockCurrentlyDisplayed(e){let{startRow:t,endRow:i}=e;return this.beans.rowRenderer.isRangeInRenderedViewport(t,i-1)}removeBlockFromCache(e){e&&this.destroyBlock(e)}checkRowCount(e,t){if(typeof t=="number"&&t>=0)this.rowCount=t,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){let{blockSize:i,overflowSize:n}=this.params,r=(e.id+1)*i+n;this.rowCount<r&&(this.rowCount=r)}}setRowCount(e,t){this.rowCount=e,ie(t)&&(this.lastRowIndexKnown=t),this.lastRowIndexKnown||this.rowCount%this.params.blockSize===0&&this.rowCount++,this.onCacheUpdated()}forEachNodeDeep(e){let t={value:0};for(let i of this.getBlocksInOrder())i.forEachNode(e,t,this.rowCount)}getBlocksInOrder(){let e=(i,n)=>i.id-n.id;return Object.values(this.blocks).sort(e)}destroyBlock(e){delete this.blocks[e.id],this.destroyBean(e),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(e)}onCacheUpdated(){this.isAlive()&&(this.destroyAllBlocksPastVirtualRowCount(),this.eventSvc.dispatchEvent({type:"storeUpdated"}))}destroyAllBlocksPastVirtualRowCount(){let e=[];for(let t of this.getBlocksInOrder())t.id*this.params.blockSize>=this.rowCount&&e.push(t);if(e.length>0)for(let t of e)this.destroyBlock(t)}purgeCache(){for(let e of this.getBlocksInOrder())this.removeBlockFromCache(e);this.lastRowIndexKnown=!1,this.rowCount===0&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()}getRowNodesInRange(e,t){let i=[],n=-1,o=!1,r={value:0},s=!1;for(let l of this.getBlocksInOrder())if(!s){if(o&&n+1!==l.id){s=!0;continue}n=l.id,l.forEachNode(c=>{let d=c===e||c===t;(o||d)&&i.push(c),d&&(o=!o)},r,this.rowCount)}return s||o?[]:i}},FK=class extends A{constructor(){super(...arguments),this.beanName="rowModel",this.rootNode=null}getRowBounds(e){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*e}}ensureRowHeightsValid(){return!1}postConstruct(){if(this.gos.get("rowModelType")!=="infinite")return;let e=this.beans,t=new ts(e);this.rootNode=t,t.level=-1,this.rowHeight=ta(e),this.addEventListeners(),this.addDestroyFunc(()=>this.destroyCache())}start(){this.setDatasource(this.gos.get("datasource"))}destroy(){this.destroyDatasource(),super.destroy(),this.rootNode=null}destroyDatasource(){this.datasource&&(this.destroyBean(this.datasource),this.beans.rowRenderer.datasourceChanged(),this.datasource=null)}addEventListeners(){this.addManagedEventListeners({filterChanged:this.reset.bind(this),sortChanged:this.reset.bind(this),newColumnsLoaded:this.onColumnEverything.bind(this),storeUpdated:this.dispatchModelUpdatedEvent.bind(this)}),this.addManagedPropertyListener("datasource",()=>this.setDatasource(this.gos.get("datasource"))),this.addManagedPropertyListener("cacheBlockSize",()=>this.resetCache()),this.addManagedPropertyListener("rowHeight",()=>{this.rowHeight=ta(this.beans),this.cacheParams.rowHeight=this.rowHeight,this.updateRowHeights()})}onColumnEverything(){let e;this.cacheParams?e=!hd(this.cacheParams.sortModel,this.beans.sortSvc?.getSortModel()??[]):e=!0,e&&this.reset()}getType(){return"infinite"}setDatasource(e){this.destroyDatasource(),this.datasource=e,e&&this.reset()}isEmpty(){return!this.infiniteCache}isRowsToRender(){return!!this.infiniteCache}getNodesInRangeForSelection(e,t){return this.infiniteCache?.getRowNodesInRange(e,t)??[]}reset(){if(!this.datasource)return;xl(this.gos)!=null||this.beans.selectionSvc?.reset("rowDataChanged"),this.resetCache()}dispatchModelUpdatedEvent(){this.eventSvc.dispatchEvent({type:"modelUpdated",newPage:!1,newPageSize:!1,newData:!1,keepRenderedRows:!0,animate:!1})}resetCache(){this.destroyCache();let e=this.beans,{filterManager:t,sortSvc:i,rowNodeBlockLoader:n,eventSvc:o,gos:r}=e;this.cacheParams={datasource:this.datasource,filterModel:t?.getFilterModel()??{},sortModel:i?.getSortModel()??[],rowNodeBlockLoader:n,initialRowCount:r.get("infiniteInitialRowCount"),maxBlocksInCache:r.get("maxBlocksInCache"),rowHeight:ta(e),overflowSize:r.get("cacheOverflowSize"),blockSize:r.get("cacheBlockSize"),lastAccessedSequence:{value:0}},this.infiniteCache=this.createBean(new TK(this.cacheParams)),o.dispatchEventOnce({type:"rowCountReady"}),this.dispatchModelUpdatedEvent()}updateRowHeights(){this.forEachNode(e=>{e.setRowHeight(this.rowHeight),e.setRowTop(this.rowHeight*e.rowIndex)}),this.dispatchModelUpdatedEvent()}destroyCache(){this.infiniteCache=this.destroyBean(this.infiniteCache)}getRow(e){let t=this.infiniteCache;if(t&&!(e>=t.getRowCount()))return t.getRow(e)}getRowNode(e){let t;return this.forEachNode(i=>{i.id===e&&(t=i)}),t}forEachNode(e){this.infiniteCache?.forEachNodeDeep(e)}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(e){return e}getRowIndexAtPixel(e){if(this.rowHeight!==0){let t=Math.floor(e/this.rowHeight),i=this.getRowCount()-1;return t>i?i:t}return 0}getRowCount(){return this.infiniteCache?this.infiniteCache.getRowCount():0}isRowPresent(e){return!!this.getRowNode(e.id)}refreshCache(){this.infiniteCache?.refreshCache()}purgeCache(){this.infiniteCache?.purgeCache()}isLastRowIndexKnown(){return this.infiniteCache?.isLastRowIndexKnown()??!1}setRowCount(e,t){this.infiniteCache?.setRowCount(e,t)}resetRowHeights(){}onRowHeightChanged(){}};function IK(e){rg(e)?.refreshCache()}function AK(e){rg(e)?.purgeCache()}function LK(e){return rg(e)?.getRowCount()}var OK=class extends A{constructor(){super(...arguments),this.beanName="rowNodeBlockLoader",this.activeBlockLoadsCount=0,this.blocks=[],this.active=!0}postConstruct(){this.maxConcurrentRequests=PL(this.gos);let e=this.gos.get("blockLoadDebounceMillis");e&&e>0&&(this.checkBlockToLoadDebounce=si(this,this.performCheckBlocksToLoad.bind(this),e))}addBlock(e){this.blocks.push(e),e.addEventListener("loadComplete",this.loadComplete.bind(this)),this.checkBlockToLoad()}removeBlock(e){Hn(this.blocks,e)}destroy(){super.destroy(),this.active=!1}loadComplete(){this.activeBlockLoadsCount--,this.checkBlockToLoad()}checkBlockToLoad(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()}performCheckBlocksToLoad(){if(!this.active)return;if(this.printCacheStatus(),this.maxConcurrentRequests!=null&&this.activeBlockLoadsCount>=this.maxConcurrentRequests){Qr(this.gos,"RowNodeBlockLoader - checkBlockToLoad: max loads exceeded");return}let e=this.maxConcurrentRequests!=null?this.maxConcurrentRequests-this.activeBlockLoadsCount:1,t=this.blocks.filter(i=>i.state==="needsLoading").slice(0,e);this.activeBlockLoadsCount+=t.length;for(let i of t)i.load();this.printCacheStatus()}getBlockState(){let e={};return this.blocks.forEach(t=>{let{id:i,state:n}=t.getBlockStateJson();e[i]=n}),e}printCacheStatus(){Qr(this.gos,`RowNodeBlockLoader - printCacheStatus: activePageLoadsCount = ${this.activeBlockLoadsCount}, blocks = ${JSON.stringify(this.getBlockState())}`)}},NK={moduleName:"InfiniteRowModelCore",version:ee,rowModels:["infinite"],beans:[FK,OK]},BK={moduleName:"InfiniteRowModel",version:ee,apiFunctions:{refreshInfiniteCache:IK,purgeInfiniteCache:AK,getInfiniteRowCount:LK},dependsOn:[NK,Xj]},HK="\u2191",VK="\u2193",GK={tag:"span",children:[{tag:"span",ref:"eDelta",cls:"ag-value-change-delta"},{tag:"span",ref:"eValue",cls:"ag-value-change-value"}]},zK=class extends je{constructor(){super(GK),this.eValue=Z,this.eDelta=Z,this.refreshCount=0}init(e){this.refresh(e,!0)}showDelta(e,t){let i=Math.abs(t),n=e.formatValue(i),o=ie(n)?n:i,r=t>=0,s=this.eDelta;r?s.textContent=HK+o:s.textContent=VK+o,s.classList.toggle("ag-value-change-delta-up",r),s.classList.toggle("ag-value-change-delta-down",!r)}setTimerToRemoveDelta(){this.refreshCount++;let e=this.refreshCount;this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.hideDeltaValue()},2e3)})}hideDeltaValue(){this.eValue.classList.remove("ag-value-change-value-highlight"),ai(this.eDelta)}refresh(e,t=!1){let{value:i,valueFormatted:n}=e,{eValue:o,lastValue:r,beans:s}=this;if(i===r||(ie(n)?o.textContent=n:ie(i)?o.textContent=i:ai(o),s.filterManager?.isSuppressFlashingCellsBecauseFiltering()))return!1;let a=i&&typeof i=="object"&&"toNumber"in i?i.toNumber():i,l=r&&typeof r=="object"&&"toNumber"in r?r.toNumber():r;if(a===l)return!1;if(typeof a=="number"&&typeof l=="number"){let c=a-l;this.showDelta(e,c)}return r&&o.classList.add("ag-value-change-value-highlight"),t||this.setTimerToRemoveDelta(),this.lastValue=i,!0}},WK=".ag-value-slide-out{opacity:1}:where(.ag-ltr) .ag-value-slide-out{margin-right:5px;transition:opacity 3s,margin-right 3s}:where(.ag-rtl) .ag-value-slide-out{margin-left:5px;transition:opacity 3s,margin-left 3s}:where(.ag-ltr,.ag-rtl) .ag-value-slide-out{transition-timing-function:linear}.ag-value-slide-out-end{opacity:0}:where(.ag-ltr) .ag-value-slide-out-end{margin-right:10px}:where(.ag-rtl) .ag-value-slide-out-end{margin-left:10px}",UK={tag:"span",children:[{tag:"span",ref:"eCurrent",cls:"ag-value-slide-current"}]},qK=class extends je{constructor(){super(UK),this.eCurrent=Z,this.refreshCount=0,this.registerCSS(WK)}init(e){this.refresh(e,!0)}addSlideAnimation(){this.refreshCount++;let e=this.refreshCount;this.ePrevious?.remove();let{beans:t,eCurrent:i}=this,n=Ft({tag:"span",cls:"ag-value-slide-previous ag-value-slide-out"});this.ePrevious=n,n.textContent=i.textContent,this.getGui().insertBefore(n,i),t.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.ePrevious.classList.add("ag-value-slide-out-end")},50),window.setTimeout(()=>{e===this.refreshCount&&(this.ePrevious?.remove(),this.ePrevious=null)},3e3)})}refresh(e,t=!1){let i=e.value;if(mt(i)&&(i=""),i===this.lastValue||this.beans.filterManager?.isSuppressFlashingCellsBecauseFiltering())return!1;t||this.addSlideAnimation(),this.lastValue=i;let n=this.eCurrent;return ie(e.valueFormatted)?n.textContent=e.valueFormatted:ie(e.value)?n.textContent=i:ai(n),!0}},$K=class extends A{constructor(){super(...arguments),this.beanName="cellFlashSvc",this.nextAnimationTime=null,this.nextAnimationCycle=null,this.animations={highlight:new Map,"data-changed":new Map}}animateCell(e,t,i=this.beans.gos.get("cellFlashDuration"),n=this.beans.gos.get("cellFadeDuration")){let o=this.animations[t];o.delete(e);let r=Date.now(),s=r+i,a=r+i+n,l={phase:"flash",flashEndTime:s,fadeEndTime:a};o.set(e,l);let c=`ag-cell-${t}`,d=`${c}-animation`,{comp:u,eGui:{style:h}}=e;u.toggleCss(c,!0),u.toggleCss(d,!1),h.removeProperty("transition"),h.removeProperty("transition-delay"),this.nextAnimationTime&&s+15<this.nextAnimationTime&&(clearTimeout(this.nextAnimationCycle),this.nextAnimationCycle=null,this.nextAnimationTime=null),this.nextAnimationCycle||(this.beans.frameworkOverrides.wrapIncoming(()=>{this.nextAnimationCycle=setTimeout(this.advanceAnimations.bind(this),i)}),this.nextAnimationTime=s)}advanceAnimations(){let e=Date.now(),t=null;for(let i of Object.keys(this.animations)){let n=this.animations[i],o=`ag-cell-${i}`,r=`${o}-animation`;for(let[s,a]of n){if(!s.isAlive()||!s.comp){n.delete(s);continue}let{phase:l,flashEndTime:c,fadeEndTime:d}=a,u=l==="flash"?c:d;if(!(e+15>=u)){t=Math.min(u,t??1/0);continue}let{comp:p,eGui:{style:g}}=s;switch(l){case"flash":p.toggleCss(o,!1),p.toggleCss(r,!0),g.transition=`background-color ${d-c}ms`,g.transitionDelay=`${c-e}ms`,t=Math.min(d,t??1/0),a.phase="fade";break;case"fade":p.toggleCss(o,!1),p.toggleCss(r,!1),g.removeProperty("transition"),g.removeProperty("transition-delay"),n.delete(s);break}}}t==null?(this.nextAnimationTime=null,this.nextAnimationCycle=null):t&&(this.nextAnimationCycle=setTimeout(this.advanceAnimations.bind(this),t-e),this.nextAnimationTime=t)}onFlashCells(e,t){if(!e.comp)return;let i=$H(e.cellPosition);t.cells[i]&&this.animateCell(e,"highlight")}flashCell(e,t){this.animateCell(e,"data-changed",t?.flashDuration,t?.fadeDuration)}destroy(){for(let e of Object.keys(this.animations))this.animations[e].clear()}};function jK(e,t={}){let{cellFlashSvc:i}=e;i&&e.frameworkOverrides.wrapIncoming(()=>{for(let n of e.rowRenderer.getCellCtrls(t.rowNodes,t.columns))i.flashCell(n,t)})}var KK={moduleName:"HighlightChanges",version:ee,beans:[$K],userComponents:{agAnimateShowChangeCellRenderer:zK,agAnimateSlideCellRenderer:qK},apiFunctions:{flashCells:jK}};function YK(e){return e.stateSvc?.getState()??{}}function XK(e,t,i){return e.stateSvc?.setState(t,i)}function $_(e){return e=b({},e),e.version||(e.version="32.1.0"),e.version==="32.1.0"&&(e=JK(e)),e.version=ee,e}function JK(e){return e.cellSelection=QK(e,"rangeSelection"),e}function QK(e,t){if(e&&typeof e=="object")return e[t]}var ZK=class extends A{constructor(){super(...arguments),this.beanName="stateSvc",this.updateRowGroupExpansionStateTimer=0,this.suppressEvents=!0,this.queuedUpdateSources=new Set,this.dispatchStateUpdateEventDebounced=si(this,()=>this.dispatchQueuedStateUpdateEvents(),0),this.onRowGroupOpenedDebounced=si(this,()=>{this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(this.updateCachedState("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("rowGroupExpansion",void 0)):(this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("ssrmRowGroupExpansion",void 0))},0),this.onRowSelectedDebounced=si(this,()=>{this.staleStateKeys.delete("rowSelection"),this.updateCachedState("rowSelection",this.getRowSelectionState())},0),this.staleStateKeys=new Set}postConstruct(){let{gos:e,ctrlsSvc:t,colDelayRenderSvc:i}=this.beans;this.isClientSideRowModel=Tt(e);let n=$_(e.get("initialState")??{}),o=n.partialColumnState;delete n.partialColumnState,this.cachedState=n;let r=this.suppressEventsAndDispatchInitEvent.bind(this);t.whenReady(this,()=>r(()=>this.setupStateOnGridReady(n))),(n.columnOrder||n.columnVisibility||n.columnSizing||n.columnPinning||n.columnGroup)&&i?.hideColumns("columnState");let[s,a,l]=this.addManagedEventListeners({newColumnsLoaded:({source:c})=>{c==="gridInitializing"&&(s(),r(()=>{this.setupStateOnColumnsInitialised(n,!!o),i?.revealColumns("columnState")}))},rowCountReady:()=>{a?.(),r(()=>this.setupStateOnRowCountReady(n))},firstDataRendered:()=>{l?.(),r(()=>this.setupStateOnFirstDataRendered(n))}})}destroy(){super.destroy(),clearTimeout(this.updateRowGroupExpansionStateTimer),this.queuedUpdateSources.clear()}getState(){return this.staleStateKeys.size&&this.refreshStaleState(),this.cachedState}setState(e,t){let i=$_(e);delete i.partialColumnState,this.cachedState=i,this.startSuppressEvents();let n="api",o=t?new Set(t):void 0;this.setGridReadyState(i,n,o),this.setColumnsInitialisedState(i,n,!!o,o),this.setRowCountState(i,n,o),setTimeout(()=>{this.isAlive()&&this.setFirstDataRenderedState(i,n,o),this.stopSuppressEvents(n)})}setGridReadyState(e,t,i){t==="api"&&!i?.has("sideBar")&&this.beans.sideBar?.comp?.setState(e.sideBar),this.updateCachedState("sideBar",this.getSideBarState())}setupStateOnGridReady(e){this.setGridReadyState(e,"gridInitializing");let t=()=>this.updateCachedState("sideBar",this.getSideBarState());this.addManagedEventListeners({toolPanelVisibleChanged:t,sideBarUpdated:t})}updateColumnAndGroupState(){this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","rowGroup","sort"]),this.updateCachedState("columnGroup",this.getColumnGroupState())}setColumnsInitialisedState(e,t,i,n){this.setColumnState(e,t,i,n),this.setColumnGroupState(e,t,n),this.updateColumnAndGroupState()}setupStateOnColumnsInitialised(e,t){this.setColumnsInitialisedState(e,"gridInitializing",t);let i=n=>()=>this.updateColumnState([n]);this.addManagedEventListeners({columnValueChanged:i("aggregation"),columnMoved:i("columnOrder"),columnPinned:i("columnPinning"),columnResized:i("columnSizing"),columnVisible:i("columnVisibility"),columnPivotChanged:i("pivot"),columnPivotModeChanged:i("pivot"),columnRowGroupChanged:i("rowGroup"),sortChanged:i("sort"),newColumnsLoaded:this.updateColumnAndGroupState.bind(this),columnGroupOpened:()=>this.updateCachedState("columnGroup",this.getColumnGroupState())})}setRowCountState(e,t,i){let{filter:n,rowGroupExpansion:o,ssrmRowGroupExpansion:r,rowSelection:s,pagination:a}=e,l=(d,u)=>!i?.has(d)&&(u||t==="api");l("filter",n)&&this.setFilterState(n),l("rowGroupExpansion",o)&&this.setRowGroupExpansionState(r,o,t),l("rowSelection",s)&&this.setRowSelectionState(s,t),l("pagination",a)&&this.setPaginationState(a,t);let c=this.updateCachedState.bind(this);c("filter",this.getFilterState()),this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(c("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),c("rowGroupExpansion",void 0)):(c("rowGroupExpansion",this.getRowGroupExpansionState()),c("ssrmRowGroupExpansion",void 0)),c("rowSelection",this.getRowSelectionState()),c("pagination",this.getPaginationState())}setupStateOnRowCountReady(e){this.setRowCountState(e,"gridInitializing");let t=this.updateCachedState.bind(this),i=()=>{this.updateRowGroupExpansionStateTimer=0,this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(t("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),t("rowGroupExpansion",void 0)):(t("rowGroupExpansion",this.getRowGroupExpansionState()),t("ssrmRowGroupExpansion",void 0))},n=()=>t("filter",this.getFilterState()),{gos:o,colFilter:r}=this.beans;this.addManagedEventListeners({filterChanged:n,rowExpansionStateChanged:this.onRowGroupOpenedDebounced,expandOrCollapseAll:i,columnRowGroupChanged:i,rowDataUpdated:()=>{(o.get("groupDefaultExpanded")!==0||o.get("isGroupOpenByDefault"))&&(this.updateRowGroupExpansionStateTimer||(this.updateRowGroupExpansionStateTimer=setTimeout(i)))},selectionChanged:()=>{this.staleStateKeys.add("rowSelection"),this.onRowSelectedDebounced()},paginationChanged:s=>{(s.newPage||s.newPageSize)&&t("pagination",this.getPaginationState())}}),r&&this.addManagedListeners(r,{filterStateChanged:n})}setFirstDataRenderedState(e,t,i){let{scroll:n,cellSelection:o,focusedCell:r,columnOrder:s,rowPinning:a}=e,l=(u,h)=>!i?.has(u)&&(h||t==="api");l("focusedCell",r)&&this.setFocusedCellState(r),l("cellSelection",o)&&this.setCellSelectionState(o),l("scroll",n)&&this.setScrollState(n),l("rowPinning",a)&&this.setRowPinningState(a),this.setColumnPivotState(!!s?.orderedColIds,t);let c=this.updateCachedState.bind(this);c("sideBar",this.getSideBarState()),c("focusedCell",this.getFocusedCellState());let d=this.getRangeSelectionState();c("rangeSelection",d),c("cellSelection",d),c("scroll",this.getScrollState())}setupStateOnFirstDataRendered(e){this.setFirstDataRenderedState(e,"gridInitializing");let t=this.updateCachedState.bind(this),i=()=>t("focusedCell",this.getFocusedCellState());this.addManagedEventListeners({cellFocused:i,cellFocusCleared:i,cellSelectionChanged:n=>{if(n.finished){let o=this.getRangeSelectionState();t("rangeSelection",o),t("cellSelection",o)}},bodyScrollEnd:()=>t("scroll",this.getScrollState()),pinnedRowsChanged:()=>t("rowPinning",this.getRowPinningState())})}getColumnState(){let e=this.beans;return KU(Hp(e),e.colModel.isPivotMode())}setColumnState(e,t,i,n){let{sort:o,rowGroup:r,aggregation:s,pivot:a,columnPinning:l,columnVisibility:c,columnSizing:d,columnOrder:u}=e,h=!1,p=(te,Q)=>{let ge=!n?.has(te)&&!!(Q||t==="api");return h||(h=ge),ge},g={},f=te=>{let Q=g[te];return Q||(Q={colId:te},g[te]=Q,Q)},m={},v=p("sort",o);v&&o?.sortModel.forEach(({colId:te,sort:Q},ge)=>{let Me=f(te);Me.sort=Q,Me.sortIndex=ge}),(v||!i)&&(m.sort=null,m.sortIndex=null);let C=p("rowGroup",r);C&&r?.groupColIds.forEach((te,Q)=>{let ge=f(te);ge.rowGroup=!0,ge.rowGroupIndex=Q}),(C||!i)&&(m.rowGroup=null,m.rowGroupIndex=null);let w=p("aggregation",s);w&&s?.aggregationModel.forEach(({colId:te,aggFunc:Q})=>{f(te).aggFunc=Q}),(w||!i)&&(m.aggFunc=null);let y=p("pivot",a);y&&(a?.pivotColIds.forEach((te,Q)=>{let ge=f(te);ge.pivot=!0,ge.pivotIndex=Q}),this.gos.updateGridOptions({options:{pivotMode:!!a?.pivotMode},source:t})),(y||!i)&&(m.pivot=null,m.pivotIndex=null);let _=p("columnPinning",l);if(_){for(let te of l?.leftColIds??[])f(te).pinned="left";for(let te of l?.rightColIds??[])f(te).pinned="right"}(_||!i)&&(m.pinned=null);let R=p("columnVisibility",c);if(R)for(let te of c?.hiddenColIds??[])f(te).hide=!0;(R||!i)&&(m.hide=null);let P=p("columnSizing",d);if(P)for(let{colId:te,flex:Q,width:ge}of d?.columnSizingModel??[]){let Me=f(te);Me.flex=Q??null,Me.width=ge}(P||!i)&&(m.flex=null);let B=u?.orderedColIds,q=!!B?.length&&!n?.has("columnOrder"),$=q?B.map(te=>f(te)):Object.values(g);($.length||h)&&(this.columnStates=$,Bn(this.beans,{state:$,applyOrder:q,defaultState:m},t))}setColumnPivotState(e,t){let i=this.columnStates;this.columnStates=void 0;let n=this.columnGroupStates;this.columnGroupStates=void 0;let o=this.beans,{pivotResultCols:r,colGroupSvc:s}=o;if(r?.isPivotResultColsPresent()){if(i){let a=[];for(let l of i)r.getPivotResultCol(l.colId)&&a.push(l);Bn(o,{state:a,applyOrder:e},t)}n&&s?.setColumnGroupState(n,t)}}getColumnGroupState(){let e=this.beans.colGroupSvc;if(!e)return;let t=e.getColumnGroupState();return YU(t)}setColumnGroupState(e,t,i){let n=this.beans.colGroupSvc;if(!n||i?.has("columnGroup")||t!=="api"&&!Object.prototype.hasOwnProperty.call(e,"columnGroup"))return;let o=new Set(e.columnGroup?.openColumnGroupIds),s=n.getColumnGroupState().map(({groupId:a})=>{let l=o.has(a);return l&&o.delete(a),{groupId:a,open:l}});for(let a of o)s.push({groupId:a,open:!0});s.length&&(this.columnGroupStates=s),n.setColumnGroupState(s,t)}getFilterState(){let e=this.beans.filterManager,t=e?.getFilterModel();t&&Object.keys(t).length===0&&(t=void 0);let i=e?.getFilterState(),n=e?.getAdvFilterModel()??void 0;return t||n||i?{filterModel:t,columnFilterState:i,advancedFilterModel:n}:void 0}setFilterState(e){let t=this.beans.filterManager,{filterModel:i,columnFilterState:n,advancedFilterModel:o}=e??{filterModel:null,columnFilterState:null,advancedFilterModel:null};(i!==void 0||n!==void 0)&&t?.setFilterState(i??null,n??null,"columnFilter"),o!==void 0&&t?.setAdvFilterModel(o??null,"advancedFilter")}getRangeSelectionState(){let e=this.beans.rangeSvc?.getCellRanges().map(t=>{let{id:i,type:n,startRow:o,endRow:r,columns:s,startColumn:a}=t;return{id:i,type:n,startRow:o,endRow:r,colIds:s.map(l=>l.getColId()),startColId:a.getColId()}});return e?.length?{cellRanges:e}:void 0}setCellSelectionState(e){let{gos:t,rangeSvc:i,colModel:n,visibleCols:o}=this.beans;if(!ar(t)||!i)return;let r=[];for(let s of e?.cellRanges??[]){let a=[];for(let c of s.colIds){let d=n.getCol(c);d&&a.push(d)}if(!a.length)continue;let l=n.getCol(s.startColId);if(!l){let c=o.allCols,d=new Set(a);l=c.find(u=>d.has(u))}r.push(z(b({},s),{columns:a,startColumn:l}))}i.setCellRanges(r)}getScrollState(){if(!this.isClientSideRowModel)return;let e=this.beans.ctrlsSvc.getScrollFeature(),{left:t}=e?.getHScrollPosition()??{left:0},{top:i}=e?.getVScrollPosition()??{top:0};return i||t?{top:i,left:t}:void 0}setScrollState(e){if(!this.isClientSideRowModel)return;let{top:t,left:i}=e??{top:0,left:0},{frameworkOverrides:n,rowRenderer:o,animationFrameSvc:r,ctrlsSvc:s}=this.beans;n.wrapIncoming(()=>{s.get("center").setCenterViewportScrollLeft(i),s.getScrollFeature()?.setVerticalScrollPosition(t),o.redraw({afterScroll:!0}),r?.flushAllFrames()})}getSideBarState(){return this.beans.sideBar?.comp?.getState()}getFocusedCellState(){if(!this.isClientSideRowModel)return;let e=this.beans.focusSvc.getFocusedCell();if(e){let{column:t,rowIndex:i,rowPinned:n}=e;return{colId:t.getColId(),rowIndex:i,rowPinned:n}}}setFocusedCellState(e){if(!this.isClientSideRowModel)return;let{focusSvc:t,colModel:i}=this.beans;if(!e){t.clearFocusedCell();return}let{colId:n,rowIndex:o,rowPinned:r}=e;t.setFocusedCell({column:i.getCol(n),rowIndex:o,rowPinned:r,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}getPaginationState(){let{pagination:e,gos:t}=this.beans;if(!e)return;let i=e.getCurrentPage(),n=t.get("paginationAutoPageSize")?void 0:e.getPageSize();if(!(!i&&!n))return{page:i,pageSize:n}}setPaginationState(e,t){let{pagination:i,gos:n}=this.beans;if(!i)return;let{pageSize:o,page:r}=e??{page:0,pageSize:n.get("paginationPageSize")},s=t==="gridInitializing";o&&!n.get("paginationAutoPageSize")&&i.setPageSize(o,s?"initialState":"pageSizeSelector"),typeof r=="number"&&(s?i.setPage(r):i.goToPage(r))}getRowSelectionState(){let e=this.beans.selectionSvc;if(!e)return;let t=e.getSelectionState();return!t||!Array.isArray(t)&&(t.selectAll===!1||t.selectAllChildren===!1)&&!t?.toggledNodes?.length?void 0:t}setRowSelectionState(e,t){this.beans.selectionSvc?.setSelectionState(e,t,t==="api")}getRowGroupExpansionState(){let{expansionSvc:e}=this.beans;if(e)return e.getExpansionState()}getRowPinningState(){return this.beans.pinnedRowModel?.getPinnedState()}setRowPinningState(e){let t=this.beans.pinnedRowModel;e?t?.setPinnedState(e):t?.reset()}setRowGroupExpansionState(e,t,i){let n=this.beans.expansionSvc;if(!n)return;let o=t??{expandedRowGroupIds:[],collapsedRowGroupIds:[]};n.setExpansionState(o,i)}updateColumnState(e){let t=this.getColumnState(),i=!1,n=this.cachedState;for(let o of Object.keys(t)){let r=t[o];hd(r,n[o])||(i=!0)}this.cachedState=b(b({},n),t),i&&this.dispatchStateUpdateEvent(e)}updateCachedState(e,t){let i=this.cachedState[e];this.setCachedStateValue(e,t),hd(t,i)||this.dispatchStateUpdateEvent([e])}setCachedStateValue(e,t){this.cachedState=z(b({},this.cachedState),{[e]:t})}refreshStaleState(){let e=this.staleStateKeys;for(let t of e)t==="rowSelection"&&this.setCachedStateValue(t,this.getRowSelectionState());e.clear()}dispatchStateUpdateEvent(e){if(!this.suppressEvents){for(let t of e)this.queuedUpdateSources.add(t);this.dispatchStateUpdateEventDebounced()}}dispatchQueuedStateUpdateEvents(){let e=this.queuedUpdateSources,t=Array.from(e);e.clear(),this.eventSvc.dispatchEvent({type:"stateUpdated",sources:t,state:this.cachedState})}startSuppressEvents(){this.suppressEvents=!0,this.beans.colAnimation?.setSuppressAnimation(!0)}stopSuppressEvents(e){setTimeout(()=>{this.suppressEvents=!1,this.queuedUpdateSources.clear(),this.isAlive()&&(this.beans.colAnimation?.setSuppressAnimation(!1),this.dispatchStateUpdateEvent([e]))})}suppressEventsAndDispatchInitEvent(e){this.startSuppressEvents(),e(),this.stopSuppressEvents("gridInitializing")}},eY={moduleName:"GridState",version:ee,beans:[ZK],apiFunctions:{getState:YK,setState:XK}};function tY(e){return e.rowModel.isLastRowIndexKnown()}function iY(e){return e.pagination?.getPageSize()??100}function nY(e){return e.pagination?.getCurrentPage()??0}function oY(e){return e.pagination?.getTotalPages()??1}function rY(e){return e.pagination?e.pagination.getMasterRowCount():e.rowModel.getRowCount()}function sY(e){e.pagination?.goToNextPage()}function aY(e){e.pagination?.goToPreviousPage()}function lY(e){e.pagination?.goToFirstPage()}function cY(e){e.pagination?.goToLastPage()}function dY(e,t){e.pagination?.goToPage(t)}var uY=class extends A{constructor(){super(...arguments),this.beanName="paginationAutoPageSizeSvc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.centerRowsCtrl=e.center;let t=this.checkPageSize.bind(this);this.addManagedEventListeners({bodyHeightChanged:t,scrollVisibilityChanged:t}),this.addManagedPropertyListener("paginationAutoPageSize",this.onPaginationAutoSizeChanged.bind(this)),this.checkPageSize()})}notActive(){return!this.gos.get("paginationAutoPageSize")||this.centerRowsCtrl==null}onPaginationAutoSizeChanged(){this.notActive()?this.beans.pagination.unsetAutoCalculatedPageSize():this.checkPageSize()}checkPageSize(){if(this.notActive())return;let e=this.centerRowsCtrl.viewportSizeFeature.getBodyHeight();if(e>0){let t=this.beans,i=()=>{let n=Math.max(ta(t),1),o=Math.floor(e/n);t.pagination.setPageSize(o,"autoCalculated")};this.isBodyRendered?si(this,i,50)():(i(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}},Zc="paginationPageSizeSelector",hY={tag:"span",cls:"ag-paging-page-size"},pY=class extends je{constructor(){super(hY),this.hasEmptyOption=!1,this.handlePageSizeItemSelected=()=>{if(!this.selectPageSizeComp)return;let e=this.selectPageSizeComp.getValue();if(!e)return;let t=Number(e);isNaN(t)||t<1||t===this.pagination.getPageSize()||(this.pagination.setPageSize(t,"pageSizeSelector"),this.hasEmptyOption&&this.toggleSelectDisplay(!0),this.selectPageSizeComp.getFocusableElement().focus())}}wireBeans(e){this.pagination=e.pagination}postConstruct(){this.addManagedPropertyListener(Zc,()=>{this.onPageSizeSelectorValuesChange()}),this.addManagedEventListeners({paginationChanged:e=>this.handlePaginationChanged(e)})}handlePaginationChanged(e){if(!this.selectPageSizeComp||!e?.newPageSize)return;let t=this.pagination.getPageSize();this.getPageSizeSelectorValues().includes(t)?this.selectPageSizeComp.setValue(t.toString()):this.hasEmptyOption?this.selectPageSizeComp.setValue(""):this.toggleSelectDisplay(!0)}toggleSelectDisplay(e){this.selectPageSizeComp&&!e&&this.reset(),e&&(this.reloadPageSizesSelector(),this.selectPageSizeComp)}reset(){ai(this.getGui()),this.selectPageSizeComp&&(this.selectPageSizeComp=this.destroyBean(this.selectPageSizeComp))}onPageSizeSelectorValuesChange(){this.selectPageSizeComp&&this.shouldShowPageSizeSelector()&&this.reloadPageSizesSelector()}shouldShowPageSizeSelector(){return this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel")&&!this.gos.get("paginationAutoPageSize")&&this.gos.get(Zc)!==!1}reloadPageSizesSelector(){let e=this.getPageSizeSelectorValues(),t=this.pagination.getPageSize(),i=!t||!e.includes(t);if(i){let o=this.gos.exists("paginationPageSize"),r=this.gos.get(Zc)!==!0;W(94,{pageSizeSet:o,pageSizesSet:r,pageSizeOptions:e,paginationPageSizeOption:t}),r||W(95,{paginationPageSizeOption:t,paginationPageSizeSelector:Zc}),e.unshift("")}let n=String(i?"":t);this.selectPageSizeComp?(ns(this.pageSizeOptions,e)||(this.selectPageSizeComp.clearOptions().addOptions(this.createPageSizeSelectOptions(e)),this.pageSizeOptions=e),this.selectPageSizeComp.setValue(n,!0)):this.createPageSizeSelectorComp(e,n),this.hasEmptyOption=i}createPageSizeSelectOptions(e){return e.map(t=>({value:String(t)}))}createPageSizeSelectorComp(e,t){let i=this.getLocaleTextFunc(),n=i("pageSizeSelectorLabel","Page Size:"),o=i("ariaPageSizeSelectorLabel","Page Size");this.selectPageSizeComp=this.createManagedBean(new cw).addOptions(this.createPageSizeSelectOptions(e)).setValue(t).setAriaLabel(o).setLabel(n).onValueChange(()=>this.handlePageSizeItemSelected()),this.appendChild(this.selectPageSizeComp)}getPageSizeSelectorValues(){let e=[20,50,100],t=this.gos.get(Zc);return!Array.isArray(t)||!t?.length?e:[...t].sort((i,n)=>i-n)}destroy(){this.toggleSelectDisplay(!1),super.destroy()}},gY={selector:"AG-PAGE-SIZE-SELECTOR",component:pY},fY=".ag-paging-panel{align-items:center;border-top:var(--ag-footer-row-border);display:flex;gap:calc(var(--ag-spacing)*4);height:var(--ag-pagination-panel-height);justify-content:flex-end;padding:0 var(--ag-cell-horizontal-padding)}:where(.ag-paging-page-size) .ag-wrapper{min-width:50px}.ag-paging-page-summary-panel{align-items:center;display:flex;gap:var(--ag-cell-widget-spacing);.ag-disabled &{pointer-events:none}}.ag-paging-button{cursor:pointer;position:relative;&.ag-disabled{cursor:default;opacity:.5}}.ag-paging-number,.ag-paging-row-summary-panel-number{font-weight:500}",mY=class extends GP{constructor(){super(),this.btFirst=Z,this.btPrevious=Z,this.btNext=Z,this.btLast=Z,this.lbRecordCount=Z,this.lbFirstRowOnPage=Z,this.lbLastRowOnPage=Z,this.lbCurrent=Z,this.lbTotal=Z,this.pageSizeComp=Z,this.previousAndFirstButtonsDisabled=!1,this.nextButtonDisabled=!1,this.lastButtonDisabled=!1,this.areListenersSetup=!1,this.allowFocusInnerElement=!1,this.registerCSS(fY)}wireBeans(e){this.rowModel=e.rowModel,this.pagination=e.pagination,this.ariaAnnounce=e.ariaAnnounce}postConstruct(){let e=this.gos.get("enableRtl");this.setTemplate(this.getTemplate(),[gY]);let{btFirst:t,btPrevious:i,btNext:n,btLast:o}=this;this.activateTabIndex([t,i,n,o]),t.insertAdjacentElement("afterbegin",wn(e?"last":"first",this.beans)),i.insertAdjacentElement("afterbegin",wn(e?"next":"previous",this.beans)),n.insertAdjacentElement("afterbegin",wn(e?"previous":"next",this.beans)),o.insertAdjacentElement("afterbegin",wn(e?"first":"last",this.beans)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.addManagedPropertyListeners(["paginationPageSizeSelector","paginationAutoPageSize","suppressPaginationPanel"],()=>this.onPageSizeRelatedOptionsChange()),this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector()),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:r=>this.allowFocusInnerElement?this.tabGuardFeature.getTabGuardCtrl().focusInnerElement(r):pB(this.beans,r),forceFocusOutWhenTabGuardsAreEmpty:!0}),this.onPaginationChanged()}setAllowFocus(e){this.allowFocusInnerElement=e}onPaginationChanged(){let t=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.setDisplayed(t),t&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateLabels(),this.onPageSizeRelatedOptionsChange())}onPageSizeRelatedOptionsChange(){this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector())}setupListeners(){if(!this.areListenersSetup){this.addManagedEventListeners({paginationChanged:this.onPaginationChanged.bind(this)});for(let e of[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}]){let{el:t,fn:i}=e;this.addManagedListeners(t,{click:i,keydown:n=>{(n.key===T.ENTER||n.key===T.SPACE)&&(n.preventDefault(),i())}})}hB(this.beans,this,this.getGui()),this.areListenersSetup=!0}}onBtFirst(){this.previousAndFirstButtonsDisabled||this.pagination.goToFirstPage()}formatNumber(e){let t=this.gos.getCallback("paginationNumberFormatter");return t?t({value:e}):XU(e,this.getLocaleTextFunc.bind(this))}getTemplate(){let e=this.getLocaleTextFunc(),t=`ag-${this.getCompId()}`;return{tag:"div",cls:"ag-paging-panel ag-unselectable",attrs:{id:`${t}`},children:[{tag:"ag-page-size-selector",ref:"pageSizeComp"},{tag:"span",cls:"ag-paging-row-summary-panel",children:[{tag:"span",ref:"lbFirstRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-first-row`}},{tag:"span",attrs:{id:`${t}-to`},children:e("to","to")},{tag:"span",ref:"lbLastRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-last-row`}},{tag:"span",attrs:{id:`${t}-of`},children:e("of","of")},{tag:"span",ref:"lbRecordCount",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-row-count`}}]},{tag:"span",cls:"ag-paging-page-summary-panel",role:"presentation",children:[{tag:"div",ref:"btFirst",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("firstPage","First Page")}},{tag:"div",ref:"btPrevious",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("previousPage","Previous Page")}},{tag:"span",cls:"ag-paging-description",children:[{tag:"span",attrs:{id:`${t}-start-page`},children:e("page","Page")},{tag:"span",ref:"lbCurrent",cls:"ag-paging-number",attrs:{id:`${t}-start-page-number`}},{tag:"span",attrs:{id:`${t}-of-page`},children:e("of","of")},{tag:"span",ref:"lbTotal",cls:"ag-paging-number",attrs:{id:`${t}-of-page-number`}}]},{tag:"div",ref:"btNext",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("nextPage","Next Page")}},{tag:"div",ref:"btLast",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("lastPage","Last Page")}}]}]}}onBtNext(){this.nextButtonDisabled||this.pagination.goToNextPage()}onBtPrevious(){this.previousAndFirstButtonsDisabled||this.pagination.goToPreviousPage()}onBtLast(){this.lastButtonDisabled||this.pagination.goToLastPage()}enableOrDisableButtons(){let e=this.pagination.getCurrentPage(),t=this.rowModel.isLastRowIndexKnown(),i=this.pagination.getTotalPages();this.previousAndFirstButtonsDisabled=e===0,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);let n=this.isZeroPagesToDisplay(),o=e===i-1;this.nextButtonDisabled=o||n,this.lastButtonDisabled=!t||n||e===i-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}toggleButtonDisabled(e,t){D7(e,t),e.classList.toggle("ag-disabled",t)}isZeroPagesToDisplay(){let e=this.rowModel.isLastRowIndexKnown(),t=this.pagination.getTotalPages();return e&&t===0}updateLabels(){let e=this.rowModel.isLastRowIndexKnown(),t=this.pagination.getTotalPages(),i=this.pagination.getMasterRowCount(),n=e?i:null,o=this.pagination.getCurrentPage(),r=this.pagination.getPageSize(),s,a;this.isZeroPagesToDisplay()?s=a=0:(s=r*o+1,a=s+r-1,e&&a>n&&(a=n));let l=s+r-1,c=!e&&i<l,d=this.formatNumber(s);this.lbFirstRowOnPage.textContent=d;let u,h=this.getLocaleTextFunc();c?u=h("pageLastRowUnknown","?"):u=this.formatNumber(a),this.lbLastRowOnPage.textContent=u;let g=t>0?o+1:0,f=this.formatNumber(g);this.lbCurrent.textContent=f;let m,v;if(e)m=this.formatNumber(t),v=this.formatNumber(n);else{let C=h("more","more");m=C,v=C}this.lbTotal.textContent=m,this.lbRecordCount.textContent=v,this.announceAriaStatus(d,u,v,f,m)}announceAriaStatus(e,t,i,n,o){let r=this.getLocaleTextFunc(),s=r("page","Page"),a=r("to","to"),l=r("of","of"),c=`${e} ${a} ${t} ${l} ${i}`,d=`${s} ${n} ${l} ${o}`;c!==this.ariaRowStatus&&(this.ariaRowStatus=c,this.ariaAnnounce?.announceValue(c,"paginationRow")),d!==this.ariaPageStatus&&(this.ariaPageStatus=d,this.ariaAnnounce?.announceValue(d,"paginationPage"))}},vY={selector:"AG-PAGINATION",component:mY},CY=class extends A{constructor(){super(...arguments),this.beanName="pagination",this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=0,this.masterRowCount=0}postConstruct(){let e=this.gos;this.active=e.get("pagination"),this.pageSizeFromGridOptions=e.get("paginationPageSize"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedPropertyListener("pagination",this.onPaginationGridOptionChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPageSizeGridOptionChanged.bind(this))}getPaginationSelector(){return vY}isPaginateChildRows(){let e=this.gos;return e.get("groupHideParentOfSingleChild")||e.get("groupRemoveSingleChildren")||e.get("groupRemoveLowestSingleChildren")?!0:e.get("paginateChildRows")}onPaginationGridOptionChanged(){this.active=this.gos.get("pagination"),this.calculatePages(),this.dispatchPaginationChangedEvent({keepRenderedRows:!0})}onPageSizeGridOptionChanged(){this.setPageSize(this.gos.get("paginationPageSize"),"gridOptions")}goToPage(e){let t=this.currentPage;if(!this.active||t===e||typeof t!="number")return;let{editSvc:i}=this.beans;i?.isEditing()&&(i.isBatchEditing()?i.cleanupEditors():i.stopEditing(void 0,{source:"api"})),this.currentPage=e,this.calculatePages(),this.dispatchPaginationChangedEvent({newPage:!0})}goToPageWithIndex(e){if(!this.active)return;let t=e;this.paginateChildRows||(t=this.beans.rowModel.getTopLevelIndexFromDisplayedIndex?.(e)??e),this.goToPage(Math.floor(t/this.pageSize))}isRowInPage(e){return this.active?e>=this.topDisplayedRowIndex&&e<=this.bottomDisplayedRowIndex:!0}getCurrentPage(){return this.currentPage}goToNextPage(){this.goToPage(this.currentPage+1)}goToPreviousPage(){this.goToPage(this.currentPage-1)}goToFirstPage(){this.goToPage(0)}goToLastPage(){let e=this.beans.rowModel.getRowCount(),t=Math.floor(e/this.pageSize);this.goToPage(t)}getPageSize(){return this.pageSize}getTotalPages(){return this.totalPages}setPage(e){this.currentPage=e}get pageSize(){return ie(this.pageSizeAutoCalculated)&&this.gos.get("paginationAutoPageSize")?this.pageSizeAutoCalculated:ie(this.pageSizeFromPageSizeSelector)?this.pageSizeFromPageSizeSelector:ie(this.pageSizeFromInitialState)?this.pageSizeFromInitialState:ie(this.pageSizeFromGridOptions)?this.pageSizeFromGridOptions:this.defaultPageSize}calculatePages(){this.active?this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly():this.calculatedPagesNotActive(),this.beans.pageBounds.calculateBounds(this.topDisplayedRowIndex,this.bottomDisplayedRowIndex)}unsetAutoCalculatedPageSize(){if(this.pageSizeAutoCalculated===void 0)return;let e=this.pageSizeAutoCalculated;this.pageSizeAutoCalculated=void 0,this.pageSize!==e&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0}))}setPageSize(e,t){let i=this.pageSize;switch(t){case"autoCalculated":this.pageSizeAutoCalculated=e;break;case"pageSizeSelector":this.pageSizeFromPageSizeSelector=e,this.currentPage!==0&&this.goToFirstPage();break;case"initialState":this.pageSizeFromInitialState=e;break;case"gridOptions":this.pageSizeFromGridOptions=e,this.pageSizeFromInitialState=void 0,this.pageSizeFromPageSizeSelector=void 0,this.currentPage!==0&&this.goToFirstPage();break}i!==this.pageSize&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0,keepRenderedRows:!0}))}setZeroRows(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}adjustCurrentPageIfInvalid(){let e=this.totalPages;this.currentPage>=e&&(this.currentPage=e-1);let t=this.currentPage;(!isFinite(t)||isNaN(t)||t<0)&&(this.currentPage=0)}calculatePagesMasterRowsOnly(){let e=this.beans.rowModel,t=e.getTopLevelRowCount();if(this.masterRowCount=t,t<=0){this.setZeroRows();return}let i=this.pageSize,n=t-1;this.totalPages=Math.floor(n/i)+1,this.adjustCurrentPageIfInvalid();let o=this.currentPage,r=i*o,s=i*(o+1)-1;if(s>n&&(s=n),this.topDisplayedRowIndex=e.getTopLevelRowDisplayedIndex(r),s===n)this.bottomDisplayedRowIndex=e.getRowCount()-1;else{let a=e.getTopLevelRowDisplayedIndex(s+1);this.bottomDisplayedRowIndex=a-1}}getMasterRowCount(){return this.masterRowCount}calculatePagesAllRows(){let e=this.beans.rowModel.getRowCount();if(this.masterRowCount=e,e===0){this.setZeroRows();return}let{pageSize:t,currentPage:i}=this,n=e-1;this.totalPages=Math.floor(n/t)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=t*i,this.bottomDisplayedRowIndex=t*(i+1)-1,this.bottomDisplayedRowIndex>n&&(this.bottomDisplayedRowIndex=n)}calculatedPagesNotActive(){this.setPageSize(void 0,"autoCalculated"),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.beans.rowModel.getRowCount()-1}dispatchPaginationChangedEvent(e){let{keepRenderedRows:t=!1,newPage:i=!1,newPageSize:n=!1}=e;this.eventSvc.dispatchEvent({type:"paginationChanged",animate:!1,newData:!1,newPage:i,newPageSize:n,keepRenderedRows:t})}},wY={moduleName:"Pagination",version:ee,beans:[CY,uY],icons:{first:"first",previous:"previous",next:"next",last:"last"},apiFunctions:{paginationIsLastPageFound:tY,paginationGetPageSize:iY,paginationGetCurrentPage:nY,paginationGetTotalPages:oY,paginationGetRowCount:rY,paginationGoToNextPage:sY,paginationGoToPreviousPage:aY,paginationGoToFirstPage:lY,paginationGoToLastPage:cY,paginationGoToPage:dY},dependsOn:[sg]};function bY(e,t={}){let i=t?t.rowNodes:void 0;e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.redrawRows(i))}function nM(e,t,i,n,o){t&&(n&&t.parent&&t.parent.level!==-1&&nM(e,t.parent,i,n,o),t.setExpanded(i,void 0,o))}function yY(e,t){return e.rowModel.getRowNode(t)}function SY(e,t,i,n){e.rowRenderer.addRenderedRowListener(t,i,n)}function xY(e){return e.rowRenderer.getRenderedNodes()}function EY(e,t,i){e.rowModel.forEachNode(t,i)}function _Y(e){return e.rowRenderer.firstRenderedRow}function RY(e){return e.rowRenderer.lastRenderedRow}function PY(e,t){return e.rowModel.getRow(t)}function DY(e){return e.rowModel.getRowCount()}var MY={moduleName:"RowApi",version:ee,apiFunctions:{redrawRows:bY,setRowNodeExpanded:nM,getRowNode:yY,addRenderedRowListener:SY,getRenderedNodes:xY,forEachNode:EY,getFirstDisplayedRowIndex:_Y,getLastDisplayedRowIndex:RY,getDisplayedRowAtIndex:PY,getDisplayedRowCount:DY}},kY={moduleName:"ScrollApi",version:ee,apiFunctions:{getVerticalPixelRange:z$,getHorizontalPixelRange:W$,ensureColumnVisible:WD,ensureIndexVisible:UD,ensureNodeVisible:U$}};function TY(e,t,i){if(!t)return;let n=e.ctrlsSvc.getGridBodyCtrl().eGridBody,o=`aria-${t}`;i===null?n.removeAttribute(o):n.setAttribute(o,i)}function FY(e,t={}){e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.refreshCells(t))}function IY(e){e.frameworkOverrides.wrapIncoming(()=>{for(let t of e.ctrlsSvc.getHeaderRowContainerCtrls())t.refresh()})}function AY(e){return e.animationFrameSvc?.isQueueEmpty()??!0}function LY(e){e.animationFrameSvc?.flushAllFrames()}function OY(e){return{rowHeight:ta(e),headerHeight:kd(e)}}function NY(e,t={}){let i=[];for(let r of e.rowRenderer.getCellCtrls(t.rowNodes,t.columns)){let s=r.getCellRenderer();s!=null&&i.push(bd(s))}if(t.columns?.length)return i;let n=[],o=HC(t.rowNodes);for(let r of e.rowRenderer.getAllRowCtrls()){if(o&&!VC(r.rowNode,o)||!r.isFullWidth())continue;let s=r.getFullWidthCellRenderers();for(let a=0;a<s.length;a++){let l=s[a];l!=null&&n.push(bd(l))}}return[...n,...i]}var BY={moduleName:"RenderApi",version:ee,apiFunctions:{setGridAriaProperty:TY,refreshCells:FY,refreshHeader:IY,isAnimationFrameQueueEmpty:AY,flushAllAnimationFrames:LY,getSizesForCurrentTheme:OY,getCellRendererInstances:NY}};function HY(e,t){typeof t=="number"?e.colAutosize?.sizeColumnsToFit(t,"api"):e.colAutosize?.sizeColumnsToFitGridBody(t)}function oM({colAutosize:e,visibleCols:t},i,n){Array.isArray(i)?e?.autoSizeCols({colKeys:i,skipHeader:n,source:"api"}):e?.autoSizeCols(z(b({},i),{colKeys:i.colIds??t.allCols,source:"api"}))}function VY(e,t){t&&typeof t=="object"?oM(e,t):e.colAutosize?.autoSizeAllColumns({source:"api",skipHeader:t})}var GY=class extends A{constructor(){super(...arguments),this.beanName="colAutosize",this.timesDelayed=0,this.shouldQueueResizeOperations=!1,this.resizeOperationQueue=[]}postConstruct(){let{gos:e}=this,t=e.get("autoSizeStrategy");if(t){let i=!1,n=t.type;if(n==="fitGridWidth"||n==="fitProvidedWidth")i=!0;else if(n==="fitCellContents"){this.addManagedEventListeners({firstDataRendered:()=>this.onFirstDataRendered(t)});let o=e.get("rowData");i=o!=null&&o.length>0&&Tt(e)}i&&this.beans.colDelayRenderSvc?.hideColumns(n)}}autoSizeCols(e){let{eventSvc:t,visibleCols:i}=this.beans;this.innerAutoSizeCols(e).then(n=>{let o=c=>El(t,Array.from(c),!0,"autosizeColumns");if(!e.scaleUpToFitGridWidth)return o(n);let r=j_(this.beans),s=c=>i.leftCols.some(d=>ad(d,c)),a=c=>i.rightCols.some(d=>ad(d,c)),l=e.colKeys.filter(c=>!dr(c)&&!or(c)&&!s(c)&&!a(c));this.sizeColumnsToFit(r,e.source,!0,{defaultMaxWidth:e.defaultMaxWidth,defaultMinWidth:e.defaultMinWidth,columnLimits:e.columnLimits?.map(c=>z(b({},c),{key:c.colId})),colKeys:l,onlyScaleUp:!0}),o(n)})}innerAutoSizeCols(e){return new Promise((t,i)=>{if(this.shouldQueueResizeOperations)return this.pushResizeOperation(()=>this.innerAutoSizeCols(e).then(t,i));let{colKeys:n,skipHeader:o,skipHeaderGroups:r,stopAtGroup:s,defaultMaxWidth:a,defaultMinWidth:l,columnLimits:c=[],source:d="api"}=e,{animationFrameSvc:u,renderStatus:h,colModel:p,autoWidthCalc:g,visibleCols:f}=this.beans;if(u?.flushAllFrames(),this.timesDelayed<5&&h&&(!h.areHeaderCellsRendered()||!h.areCellsRendered())){this.timesDelayed++,setTimeout(()=>{this.isAlive()&&this.innerAutoSizeCols(e).then(t,i)});return}this.timesDelayed=0;let m=new Set,v=-1,C=Object.fromEntries(c.map(P=>{var B=P,{colId:_}=B,R=Ai(B,["colId"]);return[_,R]})),w=o??this.gos.get("skipHeaderOnAutoSize"),y=r??w;for(;v!==0;){v=0;let _=[];for(let R of n){if(!R||VL(R))continue;let P=p.getCol(R);if(!P||m.has(P))continue;let B=g.getPreferredWidthForColumn(P,w);if(B>0){let q=C[P.colId]??{};q.minWidth??(q.minWidth=l),q.maxWidth??(q.maxWidth=a);let $=zY(P,B,q);P.setActualWidth($,d),m.add(P),v++}_.push(P)}_.length&&f.refresh(d)}y||this.autoSizeColumnGroupsByColumns(n,d,s),t(m)})}autoSizeColumn(e,t,i){this.autoSizeCols({colKeys:[e],skipHeader:i,skipHeaderGroups:!0,source:t})}autoSizeColumnGroupsByColumns(e,t,i){let{colModel:n,ctrlsSvc:o}=this.beans,r=new Set,s=n.getColsForKeys(e);for(let l of s){let c=l.getParent();for(;c&&c!=i;)c.isPadding()||r.add(c),c=c.getParent()}let a;for(let l of r){for(let c of o.getHeaderRowContainerCtrls())if(a=c.getHeaderCtrlForColumn(l),a)break;a?.resizeLeafColumnsToFit(t)}}autoSizeAllColumns(e){if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.autoSizeAllColumns(e));return}this.autoSizeCols(b({colKeys:this.beans.visibleCols.allCols},e))}addColumnAutosizeListeners(e,t){let i=this.gos.get("skipHeaderOnAutoSize"),n=()=>{this.autoSizeColumn(t,"uiColumnResized",i)};e.addEventListener("dblclick",n);let o=new Xs(e);return o.addEventListener("doubleTap",n),()=>{e.removeEventListener("dblclick",n),o.destroy()}}addColumnGroupResize(e,t,i){let n=this.gos.get("skipHeaderOnAutoSize"),o=()=>{let r=[],s=t.getDisplayedLeafColumns();for(let a of s)a.getColDef().suppressAutoSize||r.push(a.getColId());r.length>0&&this.autoSizeCols({colKeys:r,skipHeader:n,stopAtGroup:t,source:"uiColumnResized"}),i()};return e.addEventListener("dblclick",o),()=>e.removeEventListener("dblclick",o)}sizeColumnsToFitGridBody(e,t){if(!this.isAlive())return;let i=j_(this.beans);if(i>0){this.sizeColumnsToFit(i,"sizeColumnsToFit",!1,e);return}t===void 0?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,100)},0):t===100?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,500)},100):t===500?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,-1)},500):W(29)}sizeColumnsToFit(e,t="sizeColumnsToFit",i,n){if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.sizeColumnsToFit(e,t,i,n));return}let o={};for(let g of n?.columnLimits??[]){let f=g,{key:m}=f,v=Ai(f,["key"]);o[typeof m=="string"?m:m.getColId()]=v}let r=this.beans.visibleCols.allCols;if(e<=0||!r.length)return;let s=tr(r);if(n?.onlyScaleUp&&s>e||e===s&&r.every(v=>{if(v.colDef.suppressSizeToFit)return!0;let C=o?.[v.getId()],w=C?.minWidth??n?.defaultMinWidth,y=C?.maxWidth??n?.defaultMaxWidth,_=v.getActualWidth();return(w==null||_>=w)&&(y==null||_<=y)}))return;let l=[],c=[];for(let m of r){let v=n?.colKeys?.some(C=>ad(m,C))??!0;m.getColDef().suppressSizeToFit||!v?c.push(m):l.push(m)}let d=l.slice(0),u=!1,h=m=>{Hn(l,m),c.push(m)};for(let m of l){m.resetActualWidth(t);let v=o?.[m.getId()],C=v?.minWidth??n?.defaultMinWidth,w=v?.maxWidth??n?.defaultMaxWidth,y=m.getActualWidth();typeof C=="number"&&y<C?m.setActualWidth(C,t,!0):typeof w=="number"&&y>w&&m.setActualWidth(w,t,!0)}for(;!u;){u=!0;let m=e-tr(c);if(m<=0)for(let v of l){let C=o?.[v.getId()]?.minWidth??n?.defaultMinWidth??v.minWidth;v.setActualWidth(C,t,!0)}else{let v=m/tr(l),C=m;for(let w=l.length-1;w>=0;w--){let y=l[w],_=o?.[y.getId()],R=_?.minWidth??n?.defaultMinWidth,P=_?.maxWidth??n?.defaultMaxWidth,B=y.getMinWidth(),q=y.getMaxWidth(),$=typeof R=="number"&&R>B?R:B,te=typeof P=="number"&&P<q?P:q,Q=Math.round(y.getActualWidth()*v);Q<$?(Q=$,h(y),u=!1):Q>te?(Q=te,h(y),u=!1):w===0&&(Q=C),y.setActualWidth(Q,t,!0),C-=Q}}}for(let m of d)m.fireColumnWidthChangedEvent(t);let p=this.beans.visibleCols;p.setLeftValues(t),p.updateBodyWidths(),!i&&El(this.eventSvc,d,!0,t)}applyAutosizeStrategy(){let{gos:e,colDelayRenderSvc:t}=this.beans,i=e.get("autoSizeStrategy");i?.type!=="fitGridWidth"&&i?.type!=="fitProvidedWidth"||setTimeout(()=>{if(!this.isAlive())return;let n=i.type;if(n==="fitGridWidth"){let{columnLimits:o,defaultMinWidth:r,defaultMaxWidth:s}=i,a=o?.map(({colId:l,minWidth:c,maxWidth:d})=>({key:l,minWidth:c,maxWidth:d}));this.sizeColumnsToFitGridBody({defaultMinWidth:r,defaultMaxWidth:s,columnLimits:a})}else n==="fitProvidedWidth"&&this.sizeColumnsToFit(i.width,"sizeColumnsToFit");t?.revealColumns(n)})}onFirstDataRendered(i){var n=i,{colIds:e}=n,t=Ai(n,["colIds"]);setTimeout(()=>{if(!this.isAlive())return;let o="autosizeColumns";e?this.autoSizeCols(z(b({},t),{source:o,colKeys:e})):this.autoSizeAllColumns(z(b({},t),{source:o})),this.beans.colDelayRenderSvc?.revealColumns(t.type)})}processResizeOperations(){this.shouldQueueResizeOperations=!1;for(let e of this.resizeOperationQueue)e();this.resizeOperationQueue=[]}pushResizeOperation(e){this.resizeOperationQueue.push(e)}destroy(){this.resizeOperationQueue.length=0,super.destroy()}};function zY(e,t,i={}){let n=i.minWidth??e.getMinWidth();t<n&&(t=n);let o=i.maxWidth??e.getMaxWidth();return t>o&&(t=o),t}function j_({ctrlsSvc:e,scrollVisibleSvc:t}){let i=e.getGridBodyCtrl(),o=i.isVerticalScrollShowing()?t.getScrollbarWidth():0;return fd(i.eGridBody)-o}var WY={moduleName:"ColumnAutoSize",version:ee,beans:[GY],apiFunctions:{sizeColumnsToFit:HY,autoSizeColumns:oM,autoSizeAllColumns:VY},dependsOn:[XP]},UY=".ag-row-pinned-source{background-color:var(--ag-pinned-source-row-background-color);color:var(--ag-pinned-source-row-text-color);font-weight:var(--ag-pinned-source-row-font-weight)}.ag-row-pinned-manual{background-color:var(--ag-pinned-row-background-color);color:var(--ag-pinned-row-text-color);font-weight:var(--ag-pinned-row-font-weight)}";function qY(e){return e.pinnedRowModel?.getPinnedTopRowCount()??0}function $Y(e){return e.pinnedRowModel?.getPinnedBottomRowCount()??0}function jY(e,t){return e.pinnedRowModel?.getPinnedTopRow(t)}function KY(e,t){return e.pinnedRowModel?.getPinnedBottomRow(t)}function YY(e,t,i){return e.pinnedRowModel?.forEachPinnedRow(t,i)}var XY={moduleName:"PinnedRow",version:ee,beans:[YB],css:[UY],apiFunctions:{getPinnedTopRowCount:qY,getPinnedBottomRowCount:$Y,getPinnedTopRow:jY,getPinnedBottomRow:KY,forEachPinnedRow:YY},icons:{rowPin:"pin",rowPinTop:"pinned-top",rowPinBottom:"pinned-bottom",rowUnpin:"un-pin"}},JY=class{constructor(e,t){this.col=e,this.firstNode=t,this.cellSpan=!0,this.spannedNodes=new Set,this.addSpannedNode(t)}reset(){this.spannedNodes.clear(),this.addSpannedNode(this.firstNode)}addSpannedNode(e){this.spannedNodes.add(e),this.lastNode=e}getLastNode(){return this.lastNode}getCellHeight(){return this.lastNode.rowTop+this.lastNode.rowHeight-this.firstNode.rowTop-1}doesSpanContain(e){return e.column!==this.col||e.rowPinned!=this.firstNode.rowPinned?!1:this.firstNode.rowIndex<=e.rowIndex&&e.rowIndex<=this.lastNode.rowIndex}getLastNodeAutoHeight(){let e=this.firstNode.__autoHeights?.[this.col.getColId()];if(e==null)return;let t=0;for(let i of this.spannedNodes)i!==this.lastNode&&(t+=i.rowHeight);return e-t}},QY=class extends A{constructor(e){super(),this.column=e}buildCache(e){let{column:t,beans:{gos:i,pinnedRowModel:n,rowModel:o,valueSvc:r,pagination:s}}=this,{colDef:a}=t,l=this.getNodeMap(e),c=new Map,d=i.getCallback("isFullWidthRow"),u=a.equals,h=a.spanRows,p=typeof h=="function",g=null,f=null,m,v=(w,y)=>{g=w,f=null,m=y},C=w=>{let y=!w.isExpandable()&&!w.group&&!w.detail&&(d?!d({rowNode:w}):!0);if(w.rowIndex==null||!y){v(null,null);return}if(g==null||w.level!==g.level||w.footer||f&&w.rowIndex-1!==f?.getLastNode().rowIndex){v(w,r.getValue(t,w));return}let _=r.getValue(t,w);if(p){let R=ye(i,{valueA:m,nodeA:g,valueB:_,nodeB:w,column:t,colDef:a});if(!h(R)){v(w,_);return}}else if(u?!u(m,_):m!==_){v(w,_);return}if(!f){let R=l?.get(g);R?.firstNode===g?(R.reset(),f=R):f=new JY(t,g),c.set(g,f)}f.addSpannedNode(w),c.set(w,f)};switch(e){case"center":o.forEachDisplayedNode?.(w=>{(!s||s.isRowInPage(w.rowIndex))&&C(w)}),this.centerValueNodeMap=c;break;case"top":n?.forEachPinnedRow("top",C),this.topValueNodeMap=c;break;case"bottom":n?.forEachPinnedRow("bottom",C),this.bottomValueNodeMap=c;break}}isCellSpanning(e){return!!this.getCellSpan(e)}getCellSpan(e){return this.getNodeMap(e.rowPinned).get(e)}getNodeMap(e){switch(e){case"top":return this.topValueNodeMap;case"bottom":return this.bottomValueNodeMap;default:return this.centerValueNodeMap}}},ZY=class extends A{constructor(){super(...arguments),this.beanName="rowSpanSvc",this.spanningColumns=new Map,this.debouncePinnedEvent=si(this,this.dispatchCellsUpdatedEvent.bind(this,!0),0),this.debounceModelEvent=si(this,this.dispatchCellsUpdatedEvent.bind(this,!1),0),this.pinnedTimeout=null,this.modelTimeout=null}postConstruct(){let e=this.onRowDataUpdated.bind(this),t=this.buildPinnedCaches.bind(this);this.addManagedEventListeners({paginationChanged:this.buildModelCaches.bind(this),pinnedRowDataChanged:t,pinnedRowsChanged:t,rowNodeDataChanged:e,cellValueChanged:e})}register(e){let{gos:t}=this.beans;if(!t.get("enableCellSpan")||this.spanningColumns.has(e))return;let i=this.createManagedBean(new QY(e));this.spanningColumns.set(e,i),i.buildCache("top"),i.buildCache("bottom"),i.buildCache("center"),this.debouncePinnedEvent(),this.debounceModelEvent()}dispatchCellsUpdatedEvent(e){this.dispatchLocalEvent({type:"spannedCellsUpdated",pinned:e})}deregister(e){this.spanningColumns.delete(e)}onRowDataUpdated({node:e}){let{spannedRowRenderer:t}=this.beans;if(e.rowPinned){if(this.pinnedTimeout!=null)return;this.pinnedTimeout=window.setTimeout(()=>{this.pinnedTimeout=null,this.buildPinnedCaches(),t?.createCtrls("top"),t?.createCtrls("bottom")},0);return}this.modelTimeout==null&&(this.modelTimeout=window.setTimeout(()=>{this.modelTimeout=null,this.buildModelCaches(),t?.createCtrls("center")},0))}buildModelCaches(){this.modelTimeout!=null&&clearTimeout(this.modelTimeout),this.spanningColumns.forEach(e=>e.buildCache("center")),this.debounceModelEvent()}buildPinnedCaches(){this.pinnedTimeout!=null&&clearTimeout(this.pinnedTimeout),this.spanningColumns.forEach(e=>{e.buildCache("top"),e.buildCache("bottom")}),this.debouncePinnedEvent()}isCellSpanning(e,t){let i=this.spanningColumns.get(e);return i?i.isCellSpanning(t):!1}getCellSpanByPosition(e){let{pinnedRowModel:t,rowModel:i}=this.beans,n=e.column,o=e.rowIndex,r=this.spanningColumns.get(n);if(!r)return;let s;switch(e.rowPinned){case"top":s=t?.getPinnedTopRow(o);break;case"bottom":s=t?.getPinnedBottomRow(o);break;default:s=i.getRow(o)}if(s)return r.getCellSpan(s)}getCellStart(e){let t=this.getCellSpanByPosition(e);return t?z(b({},e),{rowIndex:t.firstNode.rowIndex}):e}getCellEnd(e){let t=this.getCellSpanByPosition(e);return t?z(b({},e),{rowIndex:t.getLastNode().rowIndex}):e}getCellSpan(e,t){let i=this.spanningColumns.get(e);if(i)return i.getCellSpan(t)}forEachSpannedColumn(e,t){for(let[i,n]of this.spanningColumns)if(n.isCellSpanning(e)){let o=n.getCellSpan(e);t(i,o)}}destroy(){super.destroy(),this.spanningColumns.clear()}},eX=class extends yl{constructor(e,t,i){super(e.col,e.firstNode,i,t),this.cellSpan=e,this.SPANNED_CELL_CSS_CLASS="ag-spanned-cell"}setComp(e,t,i,n,o,r,s){this.eWrapper=i,super.setComp(e,t,i,n,o,r,s),this.setAriaRowSpan(),this.refreshAriaRowIndex()}isCellSpanning(){return!0}getCellSpan(){return this.cellSpan}refreshAriaRowIndex(){let{eGui:e,rowNode:t}=this;!e||t.rowIndex==null||Pp(e,t.rowIndex)}setAriaRowSpan(){I7(this.eGui,this.cellSpan.spannedNodes.size)}setFocusedCellPosition(e){this.focusedCellPosition=e}getFocusedCellPosition(){return this.focusedCellPosition??this.cellPosition}checkCellFocused(){let e=this.beans.focusSvc.getFocusedCell();return!!e&&this.cellSpan.doesSpanContain(e)}applyStaticCssClasses(){super.applyStaticCssClasses(),this.comp.toggleCss(this.SPANNED_CELL_CSS_CLASS,!0)}onCellFocused(e){let{beans:t}=this;if(ig(t)){this.focusedCellPosition=void 0;return}let i=this.isCellFocused();i||(this.focusedCellPosition=void 0),e&&i&&(this.focusedCellPosition={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column}),super.onCellFocused(e)}getRootElement(){return this.eWrapper}},tX=class extends jp{onRowIndexChanged(){super.onRowIndexChanged();for(let e of this.getAllCellCtrls())e.refreshAriaRowIndex()}getInitialRowClasses(e){return["ag-spanned-row"]}getNewCellCtrl(e){let t=this.beans.rowSpanSvc?.getCellSpan(e,this.rowNode);if(!(!t||t.firstNode!==this.rowNode))return new eX(t,this,this.beans)}isCorrectCtrlForSpan(e){let t=this.beans.rowSpanSvc?.getCellSpan(e.column,this.rowNode);return!t||t.firstNode!==this.rowNode?!1:e.getCellSpan()===t}onRowHeightChanged(){}refreshFirstAndLastRowStyles(){}addHoverFunctionality(){}resetHoveredStatus(){}},iX=class extends A{constructor(){super(...arguments),this.beanName="spannedRowRenderer",this.topCtrls=new Map,this.bottomCtrls=new Map,this.centerCtrls=new Map}postConstruct(){this.addManagedEventListeners({displayedRowsChanged:this.createAllCtrls.bind(this)})}createAllCtrls(){this.createCtrls("top"),this.createCtrls("bottom"),this.createCtrls("center")}createCtrls(e){let{rowSpanSvc:t}=this.beans,i=this.getCtrlsMap(e),n=i.size,o=this.getAllRelevantRowControls(e),r=new Map,s=!1;for(let l of o)l.isAlive()&&t?.forEachSpannedColumn(l.rowNode,(c,d)=>{if(r.has(d.firstNode))return;let u=i.get(d.firstNode);if(u){r.set(d.firstNode,u),i.delete(d.firstNode);return}s=!0;let h=new tX(d.firstNode,this.beans,!1,!1,!1);r.set(d.firstNode,h)});this.setCtrlsMap(e,r);let a=r.size===n;if(!(!s&&a)){for(let l of i.values())l.destroyFirstPass(!0),l.destroySecondPass();this.dispatchLocalEvent({type:"spannedRowsUpdated",ctrlsKey:e})}}getAllRelevantRowControls(e){let{rowRenderer:t}=this.beans;switch(e){case"top":return t.topRowCtrls;case"bottom":return t.bottomRowCtrls;case"center":return t.allRowCtrls}}getCellByPosition(e){let{rowSpanSvc:t}=this.beans,i=t?.getCellSpanByPosition(e);if(!i)return;let n=this.getCtrlsMap(e.rowPinned).get(i.firstNode);if(n)return n.getAllCellCtrls().find(o=>o.column===e.column)}getCtrls(e){return[...this.getCtrlsMap(e).values()]}destroyRowCtrls(e){for(let t of this.getCtrlsMap(e).values())t.destroyFirstPass(!0),t.destroySecondPass();this.setCtrlsMap(e,new Map)}getCtrlsMap(e){switch(e){case"top":return this.topCtrls;case"bottom":return this.bottomCtrls;default:return this.centerCtrls}}setCtrlsMap(e,t){switch(e){case"top":this.topCtrls=t;break;case"bottom":this.bottomCtrls=t;break;default:this.centerCtrls=t;break}}destroy(){super.destroy(),this.destroyRowCtrls("top"),this.destroyRowCtrls("bottom"),this.destroyRowCtrls("center")}},nX={moduleName:"CellSpan",version:ee,beans:[ZY,iX]},oX=class extends A{constructor(e,t){super(),this.cellCtrl=e,this.staticClasses=[],this.beans=t,this.column=e.column}setComp(e){this.cellComp=e,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}applyCellClassRules(){let{column:e,cellComp:t}=this,i=e.colDef,n=i.cellClassRules,o=this.getCellClassParams(e,i);kw(this.beans.expressionSvc,n===this.cellClassRules?void 0:this.cellClassRules,n,o,r=>t.toggleCss(r,!0),r=>t.toggleCss(r,!1)),this.cellClassRules=n}applyUserStyles(){let e=this.column,t=e.colDef,i=t.cellStyle;if(!i)return;let n;if(typeof i=="function"){let o=this.getCellClassParams(e,t);n=i(o)}else n=i;n&&this.cellComp.setUserStyles(n)}applyClassesFromColDef(){let{column:e,cellComp:t}=this,i=e.colDef,n=this.getCellClassParams(e,i);for(let r of this.staticClasses)t.toggleCss(r,!1);let o=this.beans.cellStyles.getStaticCellClasses(i,n);this.staticClasses=o;for(let r of o)t.toggleCss(r,!0)}getCellClassParams(e,t){let{value:i,rowNode:n}=this.cellCtrl;return ye(this.beans.gos,{value:i,data:n.data,node:n,colDef:t,column:e,rowIndex:n.rowIndex})}},rX=class extends A{constructor(){super(...arguments),this.beanName="cellStyles"}processAllCellClasses(e,t,i,n){kw(this.beans.expressionSvc,void 0,e.cellClassRules,t,i,n),this.processStaticCellClasses(e,t,i)}getStaticCellClasses(e,t){let{cellClass:i}=e;if(!i)return[];let n;return typeof i=="function"?n=i(t):n=i,typeof n=="string"&&(n=[n]),n||[]}createCellCustomStyleFeature(e,t){return new oX(e,t)}processStaticCellClasses(e,t,i){this.getStaticCellClasses(e,t).forEach(o=>{i(o)})}},sX={moduleName:"CellStyle",version:ee,beans:[rX]},aX={moduleName:"RowStyle",version:ee,beans:[jW]};function lX(e,t){return!!e.colHover?.isHovered(t)}var cX=class extends A{constructor(e,t){super(),this.columns=e,this.element=t,this.destroyManagedListeners=[],this.enableFeature=i=>{let{beans:n,gos:o,element:r,columns:s}=this,a=n.colHover;if(i??!!o.get("columnHoverHighlight"))this.destroyManagedListeners=this.addManagedElementListeners(r,{mouseover:a.setMouseOver.bind(a,s),mouseout:a.clearMouseOver.bind(a)});else{for(let c of this.destroyManagedListeners)c();this.destroyManagedListeners=[]}}}postConstruct(){this.addManagedPropertyListener("columnHoverHighlight",({currentValue:e})=>{this.enableFeature(e)}),this.enableFeature()}destroy(){super.destroy(),this.destroyManagedListeners=null}},dX="ag-column-hover",uX=class extends A{constructor(){super(...arguments),this.beanName="colHover"}postConstruct(){this.addManagedPropertyListener("columnHoverHighlight",({currentValue:e})=>{e||this.clearMouseOver()})}setMouseOver(e){this.updateState(e)}clearMouseOver(){this.updateState(null)}isHovered(e){if(!this.gos.get("columnHoverHighlight"))return!1;let t=this.selectedColumns;return!!t&&t.indexOf(e)>=0}addHeaderColumnHoverListener(e,t,i){let n=()=>{let o=this.isHovered(i);t.toggleCss("ag-column-hover",o)};e.addManagedEventListeners({columnHoverChanged:n}),n()}onCellColumnHover(e,t){if(!t)return;let i=this.isHovered(e);t.toggleCss(dX,i)}addHeaderFilterColumnHoverListener(e,t,i,n){this.createHoverFeature(e,[i],n);let o=()=>{let r=this.isHovered(i);t.toggleCss("ag-column-hover",r)};e.addManagedEventListeners({columnHoverChanged:o}),o()}createHoverFeature(e,t,i){e.createManagedBean(new cX(t,i))}updateState(e){this.selectedColumns=e,this.eventSvc.dispatchEvent({type:"columnHoverChanged"})}},hX={moduleName:"ColumnHover",version:ee,beans:[uX],apiFunctions:{isColumnHovered:lX}},pX=class extends A{constructor(){super(...arguments),this.beanName="apiEventSvc",this.syncListeners=new Map,this.asyncListeners=new Map,this.syncGlobalListeners=new Set,this.globalListenerPairs=new Map}postConstruct(){this.wrapSvc=this.beans.frameworkOverrides.createGlobalEventListenerWrapper?.()}addListener(e,t){let i=this.wrapSvc?.wrap(e,t)??t,n=!_p.has(e),o=n?this.asyncListeners:this.syncListeners;o.has(e)||o.set(e,new Set),o.get(e).add(i),this.eventSvc.addListener(e,i,n)}removeListener(e,t){let i=this.wrapSvc?.unwrap(e,t)??t,o=!!this.asyncListeners.get(e)?.delete(i);o||this.syncListeners.get(e)?.delete(i),this.eventSvc.removeListener(e,i,o)}addGlobalListener(e){let t=this.wrapSvc?.wrapGlobal(e)??e,i=(r,s)=>{_p.has(r)&&t(r,s)},n=(r,s)=>{_p.has(r)||t(r,s)};this.globalListenerPairs.set(e,{syncListener:i,asyncListener:n});let o=this.eventSvc;o.addGlobalListener(i,!1),o.addGlobalListener(n,!0)}removeGlobalListener(e){let{eventSvc:t,wrapSvc:i,globalListenerPairs:n}=this,o=i?.unwrapGlobal(e)??e;if(n.has(o)){let{syncListener:s,asyncListener:a}=n.get(o);t.removeGlobalListener(s,!1),t.removeGlobalListener(a,!0),n.delete(e)}else this.syncGlobalListeners.delete(o),t.removeGlobalListener(o,!1)}destroyEventListeners(e,t){e.forEach((i,n)=>{i.forEach(o=>this.eventSvc.removeListener(n,o,t)),i.clear()}),e.clear()}destroyGlobalListeners(e,t){for(let i of e)this.eventSvc.removeGlobalListener(i,t);e.clear()}destroy(){super.destroy(),this.destroyEventListeners(this.syncListeners,!1),this.destroyEventListeners(this.asyncListeners,!0),this.destroyGlobalListeners(this.syncGlobalListeners,!1);let{globalListenerPairs:e,eventSvc:t}=this;e.forEach(({syncListener:i,asyncListener:n})=>{t.removeGlobalListener(i,!1),t.removeGlobalListener(n,!0)}),e.clear()}};function gX(e,t,i){e.apiEventSvc?.addListener(t,i)}function fX(e,t,i){e.apiEventSvc?.removeListener(t,i)}function mX(e,t){e.apiEventSvc?.addGlobalListener(t)}function vX(e,t){e.apiEventSvc?.removeGlobalListener(t)}var CX={moduleName:"EventApi",version:ee,apiFunctions:{addEventListener:gX,addGlobalListener:mX,removeEventListener:fX,removeGlobalListener:vX},beans:[pX]},wX={moduleName:"Locale",version:ee,beans:[jU]},bX=class extends A{constructor(){super(...arguments),this.beanName="rowAutoHeight",this.wasEverActive=!1,this._debouncedCalculateRowHeights=si(this,this.calculateRowHeights.bind(this),1)}requestCheckAutoHeight(){this.wasEverActive&&this._debouncedCalculateRowHeights()}calculateRowHeights(){let{visibleCols:e,rowModel:t,rowSpanSvc:i,pinnedRowModel:n}=this.beans,o=e.autoHeightCols,r=!1,s=a=>{let l=a.__autoHeights,c=Zr(this.beans,a).height;for(let d of o){let u=l?.[d.getColId()],h=i?.getCellSpan(d,a);if(h){if(h.getLastNode()!==a)continue;if(u=i?.getCellSpan(d,a)?.getLastNodeAutoHeight(),!u)return}if(u==null){if(this.colSpanSkipCell(d,a))continue;return}c=Math.max(u,c)}c!==a.rowHeight&&(a.setRowHeight(c),r=!0)};n?.forEachPinnedRow?.("top",s),n?.forEachPinnedRow?.("bottom",s),t.forEachDisplayedNode?.(s),r&&t.onRowHeightChanged?.()}setRowAutoHeight(e,t,i){if(e.__autoHeights??(e.__autoHeights={}),t==null){delete e.__autoHeights[i.getId()];return}let n=e.__autoHeights[i.getId()];e.__autoHeights[i.getId()]=t,n!==t&&this.requestCheckAutoHeight()}colSpanSkipCell(e,t){let{colModel:i,colViewport:n,visibleCols:o}=this.beans;if(!i.colSpanActive)return!1;let r=[];switch(e.getPinned()){case"left":r=o.getLeftColsForRow(t);break;case"right":r=o.getRightColsForRow(t);break;case null:r=n.getColsWithinViewport(t);break}return!r.includes(e)}setupCellAutoHeight(e,t,i){if(!e.column.isAutoHeight()||!t)return!1;this.wasEverActive=!0;let n=t.parentElement,{rowNode:o,column:r}=e,s=this.beans,a=d=>{if(this.beans.editSvc?.isEditing(e)||!e.isAlive()||!i.isAlive())return;let{paddingTop:u,paddingBottom:h,borderBottomWidth:p,borderTopWidth:g}=da(n),f=u+h+p+g,v=t.offsetHeight+f;if(d<5){let w=!Qt(s)?.contains(t),y=v==0;if(w||y){window.setTimeout(()=>a(d+1),0);return}}this.setRowAutoHeight(o,v,r)},l=()=>a(0);l();let c=is(s,t,l);return i.addDestroyFunc(()=>{c(),this.setRowAutoHeight(o,void 0,r)}),!0}setAutoHeightActive(e){this.active=e.list.some(t=>t.isVisible()&&t.isAutoHeight())}areRowsMeasured(){if(!this.active)return!0;let e=this.beans.rowRenderer.getAllRowCtrls(),t=null;for(let{rowNode:i}of e)if((!t||this.beans.colModel.colSpanActive)&&(t=this.beans.colViewport.getColsWithinViewport(i).filter(o=>o.isAutoHeight())),t.length!==0){if(!i.__autoHeights)return!1;for(let n of t){let o=i.__autoHeights[n.getColId()];if(!o||i.rowHeight<o)return!1}}return!0}},yX={moduleName:"RowAutoHeight",version:ee,beans:[bX]},cg={moduleName:"AllCommunity",version:ee,dependsOn:[bK,DK,BK,uq,yj,Sj,xj,Ej,_j,Rj,Pj,bj,p$,g$,f$,h$,v$,C$,eY,Qj,wY,JP,MY,kY,BY,WY,lV,XY,zj,MU,sX,hX,aX,CX,FU,KK,zD,wX,yX,aV,yK,nX]};var SX=(()=>{let t=class t{constructor(){this.vcr=k(Er)}};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=re({type:t,selectors:[["ag-component-container"]],standalone:!1,decls:0,vars:0,template:function(o,r){},encapsulation:2});let e=t;return e})(),aM=16,Bw=0;function xX(e){let t=new Map;for(let i=0;i<aM;i++){let n=e.createComponent(SX);t.set(i,n),zi(n.location.nativeElement)}return t}var EX=new Set(["doesFilterPass","isFilterActive"]),rM=(()=>{let t=class t extends RD{setViewContainerRef(n,o){this.viewContainerRef=n,this.angularFrameworkOverrides=o}createWrapper(n){let o=this.angularFrameworkOverrides,r=this;r.compShards??=xX(this.viewContainerRef);class s extends Hw{init(c){o.runInsideAngular(()=>{super.init(c),this._componentRef.changeDetectorRef.detectChanges()})}createComponent(){return r.createComponent(n)}hasMethod(c){return a.getFrameworkComponentInstance()[c]!=null}callMethod(c,d){let u=this.getFrameworkComponentInstance(),h=u[c];return EX.has(c)?h.apply(u,d):o.runInsideAngular(()=>h.apply(u,d))}addMethod(c,d){a[c]=d}}let a=new s;return a}createComponent(n){return Bw=(Bw+1)%aM,this.compShards.get(Bw).instance.vcr.createComponent(n)}};t.\u0275fac=(()=>{let n;return function(r){return(n||(n=_i(t)))(r||t)}})(),t.\u0275prov=qi({token:t,factory:t.\u0275fac});let e=t;return e})(),Hw=class{init(t){this._params=t,this._componentRef=this.createComponent(),this._agAwareComponent=this._componentRef.instance,this._frameworkComponentInstance=this._componentRef.instance,this._eGui=this._componentRef.location.nativeElement,zi(this._eGui),this._agAwareComponent.agInit(this._params)}getGui(){return this._eGui}getRootElement(){return this._eGui.firstChild}destroy(){this._frameworkComponentInstance&&typeof this._frameworkComponentInstance.destroy=="function"&&this._frameworkComponentInstance.destroy(),this._componentRef?.destroy()}getFrameworkComponentInstance(){return this._frameworkComponentInstance}},dg=class{constructor(t){this.frameworkOverrides=t,this.wrappedListeners=new Map,this.wrappedGlobalListeners=new Map}wrap(t,i){let{frameworkOverrides:n,wrappedListeners:o}=this,r=i;if(n.shouldWrapOutgoing){r=a=>{n.wrapOutgoing(()=>i(a))};let s=o.get(t);s||(s=new Map,o.set(t,s)),s.set(i,r)}return r}wrapGlobal(t){let{frameworkOverrides:i,wrappedGlobalListeners:n}=this,o=t;return i.shouldWrapOutgoing&&(o=(r,s)=>{i.wrapOutgoing(()=>t(r,s))},n.set(t,o)),o}unwrap(t,i){let{wrappedListeners:n}=this,o=n.get(t);if(o){let r=o.get(i);if(r)return o.delete(i),o.size===0&&n.delete(t),r}return i}unwrapGlobal(t){let{wrappedGlobalListeners:i}=this,n=i.get(t);return n?(i.delete(t),n):t}},sM=(()=>{let t=class t extends xw{constructor(n){super("angular"),this._ngZone=n,this.batchFrameworkComps=!0,this.isRunningWithinTestZone=!1,this.wrapIncoming=(o,r)=>this.runOutside(o,r),this.wrapOutgoing=o=>this.runInsideAngular(o),this.isRunningWithinTestZone=window?.AG_GRID_UNDER_TEST??!!window?.Zone?.AsyncTestZoneSpec,this._ngZone?this.isRunningWithinTestZone?this.runOutside=(o,r)=>r==="resize-observer"||r==="popupPositioning"?this._ngZone.runOutsideAngular(o):o():this.runOutside=o=>this._ngZone.runOutsideAngular(o):this.runOutside=o=>o()}get shouldWrapOutgoing(){return this._ngZone&&di.isInAngularZone()}createLocalEventListenerWrapper(n,o){if(this.shouldWrapOutgoing)return n??(o.setFrameworkOverrides(this),new dg(this))}createGlobalEventListenerWrapper(){return new dg(this)}isFrameworkComponent(n){if(!n)return!1;let o=n.prototype;return o&&"agInit"in o}runInsideAngular(n){return!this._ngZone||di.isInAngularZone()?n():this._ngZone.run(n)}runOutsideAngular(n,o){return this.runOutside(n,o)}};t.\u0275fac=function(o){return new(o||t)(w1(di))},t.\u0275prov=qi({token:t,factory:t.\u0275fac});let e=t;return e})(),Tl=(()=>{let t=class t{constructor(n,o,r,s){this._viewContainerRef=o,this._angularFrameworkOverrides=r,this._frameworkCompWrapper=s,this._initialised=!1,this._destroyed=!1,this._holdEvents=!0,this._fullyReady=new Promise(a=>{this._resolveFullyReady=a}),this.statusBar=void 0,this.sideBar=void 0,this.suppressContextMenu=void 0,this.preventDefaultOnContextMenu=void 0,this.allowContextMenuWithControlKey=void 0,this.columnMenu=void 0,this.suppressMenuHide=void 0,this.enableBrowserTooltips=void 0,this.tooltipTrigger=void 0,this.tooltipShowDelay=void 0,this.tooltipHideDelay=void 0,this.tooltipMouseTrack=void 0,this.tooltipShowMode=void 0,this.tooltipInteraction=void 0,this.popupParent=void 0,this.copyHeadersToClipboard=void 0,this.copyGroupHeadersToClipboard=void 0,this.clipboardDelimiter=void 0,this.suppressCopyRowsToClipboard=void 0,this.suppressCopySingleCellRanges=void 0,this.suppressLastEmptyLineOnPaste=void 0,this.suppressClipboardPaste=void 0,this.suppressClipboardApi=void 0,this.suppressCutToClipboard=void 0,this.columnDefs=void 0,this.defaultColDef=void 0,this.defaultColGroupDef=void 0,this.columnTypes=void 0,this.dataTypeDefinitions=void 0,this.maintainColumnOrder=void 0,this.enableStrictPivotColumnOrder=void 0,this.suppressFieldDotNotation=void 0,this.headerHeight=void 0,this.groupHeaderHeight=void 0,this.floatingFiltersHeight=void 0,this.pivotHeaderHeight=void 0,this.pivotGroupHeaderHeight=void 0,this.hidePaddedHeaderRows=void 0,this.allowDragFromColumnsToolPanel=void 0,this.suppressMovableColumns=void 0,this.suppressColumnMoveAnimation=void 0,this.suppressMoveWhenColumnDragging=void 0,this.suppressDragLeaveHidesColumns=void 0,this.suppressGroupChangesColumnVisibility=void 0,this.suppressMakeColumnVisibleAfterUnGroup=void 0,this.suppressRowGroupHidesColumns=void 0,this.colResizeDefault=void 0,this.suppressAutoSize=void 0,this.autoSizePadding=void 0,this.skipHeaderOnAutoSize=void 0,this.autoSizeStrategy=void 0,this.components=void 0,this.editType=void 0,this.suppressStartEditOnTab=void 0,this.getFullRowEditValidationErrors=void 0,this.invalidEditValueMode=void 0,this.singleClickEdit=void 0,this.suppressClickEdit=void 0,this.readOnlyEdit=void 0,this.stopEditingWhenCellsLoseFocus=void 0,this.enterNavigatesVertically=void 0,this.enterNavigatesVerticallyAfterEdit=void 0,this.enableCellEditingOnBackspace=void 0,this.undoRedoCellEditing=void 0,this.undoRedoCellEditingLimit=void 0,this.defaultCsvExportParams=void 0,this.suppressCsvExport=void 0,this.defaultExcelExportParams=void 0,this.suppressExcelExport=void 0,this.excelStyles=void 0,this.findSearchValue=void 0,this.findOptions=void 0,this.quickFilterText=void 0,this.cacheQuickFilter=void 0,this.includeHiddenColumnsInQuickFilter=void 0,this.quickFilterParser=void 0,this.quickFilterMatcher=void 0,this.applyQuickFilterBeforePivotOrAgg=void 0,this.excludeChildrenWhenTreeDataFiltering=void 0,this.enableAdvancedFilter=void 0,this.alwaysPassFilter=void 0,this.includeHiddenColumnsInAdvancedFilter=void 0,this.advancedFilterParent=void 0,this.advancedFilterBuilderParams=void 0,this.advancedFilterParams=void 0,this.suppressAdvancedFilterEval=void 0,this.suppressSetFilterByDefault=void 0,this.enableFilterHandlers=void 0,this.filterHandlers=void 0,this.enableCharts=void 0,this.chartThemes=void 0,this.customChartThemes=void 0,this.chartThemeOverrides=void 0,this.chartToolPanelsDef=void 0,this.chartMenuItems=void 0,this.loadingCellRenderer=void 0,this.loadingCellRendererParams=void 0,this.loadingCellRendererSelector=void 0,this.localeText=void 0,this.masterDetail=void 0,this.keepDetailRows=void 0,this.keepDetailRowsCount=void 0,this.detailCellRenderer=void 0,this.detailCellRendererParams=void 0,this.detailRowHeight=void 0,this.detailRowAutoHeight=void 0,this.context=void 0,this.alignedGrids=void 0,this.tabIndex=void 0,this.rowBuffer=void 0,this.valueCache=void 0,this.valueCacheNeverExpires=void 0,this.enableCellExpressions=void 0,this.suppressTouch=void 0,this.suppressFocusAfterRefresh=void 0,this.suppressBrowserResizeObserver=void 0,this.suppressPropertyNamesCheck=void 0,this.suppressChangeDetection=void 0,this.debug=void 0,this.loading=void 0,this.overlayLoadingTemplate=void 0,this.loadingOverlayComponent=void 0,this.loadingOverlayComponentParams=void 0,this.suppressLoadingOverlay=void 0,this.overlayNoRowsTemplate=void 0,this.noRowsOverlayComponent=void 0,this.noRowsOverlayComponentParams=void 0,this.suppressNoRowsOverlay=void 0,this.pagination=void 0,this.paginationPageSize=void 0,this.paginationPageSizeSelector=void 0,this.paginationAutoPageSize=void 0,this.paginateChildRows=void 0,this.suppressPaginationPanel=void 0,this.pivotMode=void 0,this.pivotPanelShow=void 0,this.pivotMaxGeneratedColumns=void 0,this.pivotDefaultExpanded=void 0,this.pivotColumnGroupTotals=void 0,this.pivotRowTotals=void 0,this.pivotSuppressAutoColumn=void 0,this.suppressExpandablePivotGroups=void 0,this.functionsReadOnly=void 0,this.aggFuncs=void 0,this.suppressAggFuncInHeader=void 0,this.alwaysAggregateAtRootLevel=void 0,this.aggregateOnlyChangedColumns=void 0,this.suppressAggFilteredOnly=void 0,this.removePivotHeaderRowWhenSingleValueColumn=void 0,this.animateRows=void 0,this.cellFlashDuration=void 0,this.cellFadeDuration=void 0,this.allowShowChangeAfterFilter=void 0,this.domLayout=void 0,this.ensureDomOrder=void 0,this.enableCellSpan=void 0,this.enableRtl=void 0,this.suppressColumnVirtualisation=void 0,this.suppressMaxRenderedRowRestriction=void 0,this.suppressRowVirtualisation=void 0,this.rowDragManaged=void 0,this.rowDragInsertDelay=void 0,this.suppressRowDrag=void 0,this.suppressMoveWhenRowDragging=void 0,this.rowDragEntireRow=void 0,this.rowDragMultiRow=void 0,this.rowDragText=void 0,this.dragAndDropImageComponent=void 0,this.dragAndDropImageComponentParams=void 0,this.fullWidthCellRenderer=void 0,this.fullWidthCellRendererParams=void 0,this.embedFullWidthRows=void 0,this.groupDisplayType=void 0,this.groupDefaultExpanded=void 0,this.autoGroupColumnDef=void 0,this.groupMaintainOrder=void 0,this.groupSelectsChildren=void 0,this.groupLockGroupColumns=void 0,this.groupAggFiltering=void 0,this.groupTotalRow=void 0,this.grandTotalRow=void 0,this.suppressStickyTotalRow=void 0,this.groupSuppressBlankHeader=void 0,this.groupSelectsFiltered=void 0,this.showOpenedGroup=void 0,this.groupHideParentOfSingleChild=void 0,this.groupRemoveSingleChildren=void 0,this.groupRemoveLowestSingleChildren=void 0,this.groupHideOpenParents=void 0,this.groupAllowUnbalanced=void 0,this.rowGroupPanelShow=void 0,this.groupRowRenderer=void 0,this.groupRowRendererParams=void 0,this.treeData=void 0,this.treeDataChildrenField=void 0,this.treeDataParentIdField=void 0,this.rowGroupPanelSuppressSort=void 0,this.suppressGroupRowsSticky=void 0,this.groupHierarchyConfig=void 0,this.pinnedTopRowData=void 0,this.pinnedBottomRowData=void 0,this.enableRowPinning=void 0,this.isRowPinnable=void 0,this.isRowPinned=void 0,this.rowModelType=void 0,this.rowData=void 0,this.asyncTransactionWaitMillis=void 0,this.suppressModelUpdateAfterUpdateTransaction=void 0,this.datasource=void 0,this.cacheOverflowSize=void 0,this.infiniteInitialRowCount=void 0,this.serverSideInitialRowCount=void 0,this.suppressServerSideFullWidthLoadingRow=void 0,this.cacheBlockSize=void 0,this.maxBlocksInCache=void 0,this.maxConcurrentDatasourceRequests=void 0,this.blockLoadDebounceMillis=void 0,this.purgeClosedRowNodes=void 0,this.serverSideDatasource=void 0,this.serverSideSortAllLevels=void 0,this.serverSideEnableClientSideSort=void 0,this.serverSideOnlyRefreshFilteredGroups=void 0,this.serverSidePivotResultFieldSeparator=void 0,this.viewportDatasource=void 0,this.viewportRowModelPageSize=void 0,this.viewportRowModelBufferSize=void 0,this.alwaysShowHorizontalScroll=void 0,this.alwaysShowVerticalScroll=void 0,this.debounceVerticalScrollbar=void 0,this.suppressHorizontalScroll=void 0,this.suppressScrollOnNewData=void 0,this.suppressScrollWhenPopupsAreOpen=void 0,this.suppressAnimationFrame=void 0,this.suppressMiddleClickScrolls=void 0,this.suppressPreventDefaultOnMouseWheel=void 0,this.scrollbarWidth=void 0,this.rowSelection=void 0,this.cellSelection=void 0,this.rowMultiSelectWithClick=void 0,this.suppressRowDeselection=void 0,this.suppressRowClickSelection=void 0,this.suppressCellFocus=void 0,this.suppressHeaderFocus=void 0,this.selectionColumnDef=void 0,this.rowNumbers=void 0,this.suppressMultiRangeSelection=void 0,this.enableCellTextSelection=void 0,this.enableRangeSelection=void 0,this.enableRangeHandle=void 0,this.enableFillHandle=void 0,this.fillHandleDirection=void 0,this.suppressClearOnFillReduction=void 0,this.sortingOrder=void 0,this.accentedSort=void 0,this.unSortIcon=void 0,this.suppressMultiSort=void 0,this.alwaysMultiSort=void 0,this.multiSortKey=void 0,this.suppressMaintainUnsortedOrder=void 0,this.icons=void 0,this.rowHeight=void 0,this.rowStyle=void 0,this.rowClass=void 0,this.rowClassRules=void 0,this.suppressRowHoverHighlight=void 0,this.suppressRowTransform=void 0,this.columnHoverHighlight=void 0,this.gridId=void 0,this.deltaSort=void 0,this.treeDataDisplayType=void 0,this.enableGroupEdit=void 0,this.initialState=void 0,this.theme=void 0,this.loadThemeGoogleFonts=void 0,this.themeCssLayer=void 0,this.styleNonce=void 0,this.themeStyleContainer=void 0,this.getContextMenuItems=void 0,this.getMainMenuItems=void 0,this.postProcessPopup=void 0,this.processUnpinnedColumns=void 0,this.processCellForClipboard=void 0,this.processHeaderForClipboard=void 0,this.processGroupHeaderForClipboard=void 0,this.processCellFromClipboard=void 0,this.sendToClipboard=void 0,this.processDataFromClipboard=void 0,this.isExternalFilterPresent=void 0,this.doesExternalFilterPass=void 0,this.getChartToolbarItems=void 0,this.createChartContainer=void 0,this.focusGridInnerElement=void 0,this.navigateToNextHeader=void 0,this.tabToNextHeader=void 0,this.navigateToNextCell=void 0,this.tabToNextCell=void 0,this.getLocaleText=void 0,this.getDocument=void 0,this.paginationNumberFormatter=void 0,this.getGroupRowAgg=void 0,this.isGroupOpenByDefault=void 0,this.ssrmExpandAllAffectsAllRows=void 0,this.initialGroupOrderComparator=void 0,this.processPivotResultColDef=void 0,this.processPivotResultColGroupDef=void 0,this.getDataPath=void 0,this.getChildCount=void 0,this.getServerSideGroupLevelParams=void 0,this.isServerSideGroupOpenByDefault=void 0,this.isApplyServerSideTransaction=void 0,this.isServerSideGroup=void 0,this.getServerSideGroupKey=void 0,this.getBusinessKeyForNode=void 0,this.getRowId=void 0,this.resetRowDataOnUpdate=void 0,this.processRowPostCreate=void 0,this.isRowSelectable=void 0,this.isRowMaster=void 0,this.fillOperation=void 0,this.postSortRows=void 0,this.getRowStyle=void 0,this.getRowClass=void 0,this.getRowHeight=void 0,this.isFullWidthRow=void 0,this.isRowValidDropPosition=void 0,this.toolPanelVisibleChanged=new G,this.toolPanelSizeChanged=new G,this.columnMenuVisibleChanged=new G,this.contextMenuVisibleChanged=new G,this.cutStart=new G,this.cutEnd=new G,this.pasteStart=new G,this.pasteEnd=new G,this.columnVisible=new G,this.columnPinned=new G,this.columnResized=new G,this.columnMoved=new G,this.columnValueChanged=new G,this.columnPivotModeChanged=new G,this.columnPivotChanged=new G,this.columnGroupOpened=new G,this.newColumnsLoaded=new G,this.gridColumnsChanged=new G,this.displayedColumnsChanged=new G,this.virtualColumnsChanged=new G,this.columnEverythingChanged=new G,this.columnsReset=new G,this.columnHeaderMouseOver=new G,this.columnHeaderMouseLeave=new G,this.columnHeaderClicked=new G,this.columnHeaderContextMenu=new G,this.componentStateChanged=new G,this.cellValueChanged=new G,this.cellEditRequest=new G,this.rowValueChanged=new G,this.cellEditingStarted=new G,this.cellEditingStopped=new G,this.rowEditingStarted=new G,this.rowEditingStopped=new G,this.bulkEditingStarted=new G,this.bulkEditingStopped=new G,this.batchEditingStarted=new G,this.batchEditingStopped=new G,this.undoStarted=new G,this.undoEnded=new G,this.redoStarted=new G,this.redoEnded=new G,this.cellSelectionDeleteStart=new G,this.cellSelectionDeleteEnd=new G,this.rangeDeleteStart=new G,this.rangeDeleteEnd=new G,this.fillStart=new G,this.fillEnd=new G,this.filterOpened=new G,this.filterChanged=new G,this.filterModified=new G,this.filterUiChanged=new G,this.floatingFilterUiChanged=new G,this.advancedFilterBuilderVisibleChanged=new G,this.findChanged=new G,this.chartCreated=new G,this.chartRangeSelectionChanged=new G,this.chartOptionsChanged=new G,this.chartDestroyed=new G,this.cellKeyDown=new G,this.gridReady=new G,this.firstDataRendered=new G,this.gridSizeChanged=new G,this.modelUpdated=new G,this.virtualRowRemoved=new G,this.viewportChanged=new G,this.bodyScroll=new G,this.bodyScrollEnd=new G,this.dragStarted=new G,this.dragStopped=new G,this.dragCancelled=new G,this.stateUpdated=new G,this.paginationChanged=new G,this.rowDragEnter=new G,this.rowDragMove=new G,this.rowDragLeave=new G,this.rowDragEnd=new G,this.rowDragCancel=new G,this.rowResizeStarted=new G,this.rowResizeEnded=new G,this.columnRowGroupChanged=new G,this.rowGroupOpened=new G,this.expandOrCollapseAll=new G,this.pivotMaxColumnsExceeded=new G,this.pinnedRowDataChanged=new G,this.pinnedRowsChanged=new G,this.rowDataUpdated=new G,this.asyncTransactionsFlushed=new G,this.storeRefreshed=new G,this.headerFocused=new G,this.cellClicked=new G,this.cellDoubleClicked=new G,this.cellFocused=new G,this.cellMouseOver=new G,this.cellMouseOut=new G,this.cellMouseDown=new G,this.rowClicked=new G,this.rowDoubleClicked=new G,this.rowSelected=new G,this.selectionChanged=new G,this.cellContextMenu=new G,this.rangeSelectionChanged=new G,this.cellSelectionChanged=new G,this.tooltipShow=new G,this.tooltipHide=new G,this.sortChanged=new G,this._nativeElement=n.nativeElement,this._fullyReady.then(()=>{this._holdEvents=!1})}ngAfterViewInit(){this._angularFrameworkOverrides.runOutsideAngular(()=>{this._frameworkCompWrapper.setViewContainerRef(this._viewContainerRef,this._angularFrameworkOverrides);let n=Object.keys(this).filter(l=>!(l.startsWith("_")||l=="gridOptions"||l=="modules"||this[l]instanceof G)),o={};for(let l of n){let c=RX(l,this[l]);o[l]=c}let r=FR(this.gridOptions,o,n),s={globalListener:this.globalListener.bind(this),frameworkOverrides:this._angularFrameworkOverrides,providedBeanInstances:{frameworkCompWrapper:this._frameworkCompWrapper},modules:this.modules||[],setThemeOnGridDiv:!0},a=_D(this._nativeElement,r,s);a&&(this.api=a),this._initialised=!0,this._resolveFullyReady()})}ngOnChanges(n){this._initialised&&this._angularFrameworkOverrides.runOutsideAngular(()=>{let o={};for(let r of Object.keys(n)){let s=n[r];o[r]=s.currentValue}IR(o,this.api)})}ngOnDestroy(){this._initialised&&(this._destroyed=!0,this.api?.destroy())}isEmitterUsed(n){let r=this[n],s=r?.observed??r?.observers?.length>0,a=`on${n.charAt(0).toUpperCase()}${n.substring(1)}`,l=!!this.gridOptions&&!!this.gridOptions[a];return s||l}globalListener(n,o){if(this._destroyed)return;let r=this[n];if(r&&this.isEmitterUsed(n)){let s=()=>this._angularFrameworkOverrides.runInsideAngular(()=>r.emit(o));this._holdEvents?this._fullyReady.then(()=>s()):s()}}};t.\u0275fac=function(o){return new(o||t)(nc(Je),nc(Er),nc(sM),nc(rM))},t.\u0275cmp=re({type:t,selectors:[["ag-grid-angular"]],inputs:{gridOptions:"gridOptions",modules:"modules",statusBar:"statusBar",sideBar:"sideBar",suppressContextMenu:[2,"suppressContextMenu","suppressContextMenu",D],preventDefaultOnContextMenu:[2,"preventDefaultOnContextMenu","preventDefaultOnContextMenu",D],allowContextMenuWithControlKey:[2,"allowContextMenuWithControlKey","allowContextMenuWithControlKey",D],columnMenu:"columnMenu",suppressMenuHide:[2,"suppressMenuHide","suppressMenuHide",D],enableBrowserTooltips:[2,"enableBrowserTooltips","enableBrowserTooltips",D],tooltipTrigger:"tooltipTrigger",tooltipShowDelay:"tooltipShowDelay",tooltipHideDelay:"tooltipHideDelay",tooltipMouseTrack:[2,"tooltipMouseTrack","tooltipMouseTrack",D],tooltipShowMode:"tooltipShowMode",tooltipInteraction:[2,"tooltipInteraction","tooltipInteraction",D],popupParent:"popupParent",copyHeadersToClipboard:[2,"copyHeadersToClipboard","copyHeadersToClipboard",D],copyGroupHeadersToClipboard:[2,"copyGroupHeadersToClipboard","copyGroupHeadersToClipboard",D],clipboardDelimiter:"clipboardDelimiter",suppressCopyRowsToClipboard:[2,"suppressCopyRowsToClipboard","suppressCopyRowsToClipboard",D],suppressCopySingleCellRanges:[2,"suppressCopySingleCellRanges","suppressCopySingleCellRanges",D],suppressLastEmptyLineOnPaste:[2,"suppressLastEmptyLineOnPaste","suppressLastEmptyLineOnPaste",D],suppressClipboardPaste:[2,"suppressClipboardPaste","suppressClipboardPaste",D],suppressClipboardApi:[2,"suppressClipboardApi","suppressClipboardApi",D],suppressCutToClipboard:[2,"suppressCutToClipboard","suppressCutToClipboard",D],columnDefs:"columnDefs",defaultColDef:"defaultColDef",defaultColGroupDef:"defaultColGroupDef",columnTypes:"columnTypes",dataTypeDefinitions:"dataTypeDefinitions",maintainColumnOrder:[2,"maintainColumnOrder","maintainColumnOrder",D],enableStrictPivotColumnOrder:[2,"enableStrictPivotColumnOrder","enableStrictPivotColumnOrder",D],suppressFieldDotNotation:[2,"suppressFieldDotNotation","suppressFieldDotNotation",D],headerHeight:"headerHeight",groupHeaderHeight:"groupHeaderHeight",floatingFiltersHeight:"floatingFiltersHeight",pivotHeaderHeight:"pivotHeaderHeight",pivotGroupHeaderHeight:"pivotGroupHeaderHeight",hidePaddedHeaderRows:[2,"hidePaddedHeaderRows","hidePaddedHeaderRows",D],allowDragFromColumnsToolPanel:[2,"allowDragFromColumnsToolPanel","allowDragFromColumnsToolPanel",D],suppressMovableColumns:[2,"suppressMovableColumns","suppressMovableColumns",D],suppressColumnMoveAnimation:[2,"suppressColumnMoveAnimation","suppressColumnMoveAnimation",D],suppressMoveWhenColumnDragging:[2,"suppressMoveWhenColumnDragging","suppressMoveWhenColumnDragging",D],suppressDragLeaveHidesColumns:[2,"suppressDragLeaveHidesColumns","suppressDragLeaveHidesColumns",D],suppressGroupChangesColumnVisibility:"suppressGroupChangesColumnVisibility",suppressMakeColumnVisibleAfterUnGroup:[2,"suppressMakeColumnVisibleAfterUnGroup","suppressMakeColumnVisibleAfterUnGroup",D],suppressRowGroupHidesColumns:[2,"suppressRowGroupHidesColumns","suppressRowGroupHidesColumns",D],colResizeDefault:"colResizeDefault",suppressAutoSize:[2,"suppressAutoSize","suppressAutoSize",D],autoSizePadding:"autoSizePadding",skipHeaderOnAutoSize:[2,"skipHeaderOnAutoSize","skipHeaderOnAutoSize",D],autoSizeStrategy:"autoSizeStrategy",components:"components",editType:"editType",suppressStartEditOnTab:[2,"suppressStartEditOnTab","suppressStartEditOnTab",D],getFullRowEditValidationErrors:"getFullRowEditValidationErrors",invalidEditValueMode:"invalidEditValueMode",singleClickEdit:[2,"singleClickEdit","singleClickEdit",D],suppressClickEdit:[2,"suppressClickEdit","suppressClickEdit",D],readOnlyEdit:[2,"readOnlyEdit","readOnlyEdit",D],stopEditingWhenCellsLoseFocus:[2,"stopEditingWhenCellsLoseFocus","stopEditingWhenCellsLoseFocus",D],enterNavigatesVertically:[2,"enterNavigatesVertically","enterNavigatesVertically",D],enterNavigatesVerticallyAfterEdit:[2,"enterNavigatesVerticallyAfterEdit","enterNavigatesVerticallyAfterEdit",D],enableCellEditingOnBackspace:[2,"enableCellEditingOnBackspace","enableCellEditingOnBackspace",D],undoRedoCellEditing:[2,"undoRedoCellEditing","undoRedoCellEditing",D],undoRedoCellEditingLimit:"undoRedoCellEditingLimit",defaultCsvExportParams:"defaultCsvExportParams",suppressCsvExport:[2,"suppressCsvExport","suppressCsvExport",D],defaultExcelExportParams:"defaultExcelExportParams",suppressExcelExport:[2,"suppressExcelExport","suppressExcelExport",D],excelStyles:"excelStyles",findSearchValue:"findSearchValue",findOptions:"findOptions",quickFilterText:"quickFilterText",cacheQuickFilter:[2,"cacheQuickFilter","cacheQuickFilter",D],includeHiddenColumnsInQuickFilter:[2,"includeHiddenColumnsInQuickFilter","includeHiddenColumnsInQuickFilter",D],quickFilterParser:"quickFilterParser",quickFilterMatcher:"quickFilterMatcher",applyQuickFilterBeforePivotOrAgg:[2,"applyQuickFilterBeforePivotOrAgg","applyQuickFilterBeforePivotOrAgg",D],excludeChildrenWhenTreeDataFiltering:[2,"excludeChildrenWhenTreeDataFiltering","excludeChildrenWhenTreeDataFiltering",D],enableAdvancedFilter:[2,"enableAdvancedFilter","enableAdvancedFilter",D],alwaysPassFilter:"alwaysPassFilter",includeHiddenColumnsInAdvancedFilter:[2,"includeHiddenColumnsInAdvancedFilter","includeHiddenColumnsInAdvancedFilter",D],advancedFilterParent:"advancedFilterParent",advancedFilterBuilderParams:"advancedFilterBuilderParams",advancedFilterParams:"advancedFilterParams",suppressAdvancedFilterEval:[2,"suppressAdvancedFilterEval","suppressAdvancedFilterEval",D],suppressSetFilterByDefault:[2,"suppressSetFilterByDefault","suppressSetFilterByDefault",D],enableFilterHandlers:[2,"enableFilterHandlers","enableFilterHandlers",D],filterHandlers:"filterHandlers",enableCharts:[2,"enableCharts","enableCharts",D],chartThemes:"chartThemes",customChartThemes:"customChartThemes",chartThemeOverrides:"chartThemeOverrides",chartToolPanelsDef:"chartToolPanelsDef",chartMenuItems:"chartMenuItems",loadingCellRenderer:"loadingCellRenderer",loadingCellRendererParams:"loadingCellRendererParams",loadingCellRendererSelector:"loadingCellRendererSelector",localeText:"localeText",masterDetail:[2,"masterDetail","masterDetail",D],keepDetailRows:[2,"keepDetailRows","keepDetailRows",D],keepDetailRowsCount:"keepDetailRowsCount",detailCellRenderer:"detailCellRenderer",detailCellRendererParams:"detailCellRendererParams",detailRowHeight:"detailRowHeight",detailRowAutoHeight:[2,"detailRowAutoHeight","detailRowAutoHeight",D],context:"context",alignedGrids:"alignedGrids",tabIndex:"tabIndex",rowBuffer:"rowBuffer",valueCache:[2,"valueCache","valueCache",D],valueCacheNeverExpires:[2,"valueCacheNeverExpires","valueCacheNeverExpires",D],enableCellExpressions:[2,"enableCellExpressions","enableCellExpressions",D],suppressTouch:[2,"suppressTouch","suppressTouch",D],suppressFocusAfterRefresh:[2,"suppressFocusAfterRefresh","suppressFocusAfterRefresh",D],suppressBrowserResizeObserver:[2,"suppressBrowserResizeObserver","suppressBrowserResizeObserver",D],suppressPropertyNamesCheck:[2,"suppressPropertyNamesCheck","suppressPropertyNamesCheck",D],suppressChangeDetection:[2,"suppressChangeDetection","suppressChangeDetection",D],debug:[2,"debug","debug",D],loading:[2,"loading","loading",D],overlayLoadingTemplate:"overlayLoadingTemplate",loadingOverlayComponent:"loadingOverlayComponent",loadingOverlayComponentParams:"loadingOverlayComponentParams",suppressLoadingOverlay:[2,"suppressLoadingOverlay","suppressLoadingOverlay",D],overlayNoRowsTemplate:"overlayNoRowsTemplate",noRowsOverlayComponent:"noRowsOverlayComponent",noRowsOverlayComponentParams:"noRowsOverlayComponentParams",suppressNoRowsOverlay:[2,"suppressNoRowsOverlay","suppressNoRowsOverlay",D],pagination:[2,"pagination","pagination",D],paginationPageSize:"paginationPageSize",paginationPageSizeSelector:"paginationPageSizeSelector",paginationAutoPageSize:[2,"paginationAutoPageSize","paginationAutoPageSize",D],paginateChildRows:[2,"paginateChildRows","paginateChildRows",D],suppressPaginationPanel:[2,"suppressPaginationPanel","suppressPaginationPanel",D],pivotMode:[2,"pivotMode","pivotMode",D],pivotPanelShow:"pivotPanelShow",pivotMaxGeneratedColumns:"pivotMaxGeneratedColumns",pivotDefaultExpanded:"pivotDefaultExpanded",pivotColumnGroupTotals:"pivotColumnGroupTotals",pivotRowTotals:"pivotRowTotals",pivotSuppressAutoColumn:[2,"pivotSuppressAutoColumn","pivotSuppressAutoColumn",D],suppressExpandablePivotGroups:[2,"suppressExpandablePivotGroups","suppressExpandablePivotGroups",D],functionsReadOnly:[2,"functionsReadOnly","functionsReadOnly",D],aggFuncs:"aggFuncs",suppressAggFuncInHeader:[2,"suppressAggFuncInHeader","suppressAggFuncInHeader",D],alwaysAggregateAtRootLevel:[2,"alwaysAggregateAtRootLevel","alwaysAggregateAtRootLevel",D],aggregateOnlyChangedColumns:[2,"aggregateOnlyChangedColumns","aggregateOnlyChangedColumns",D],suppressAggFilteredOnly:[2,"suppressAggFilteredOnly","suppressAggFilteredOnly",D],removePivotHeaderRowWhenSingleValueColumn:[2,"removePivotHeaderRowWhenSingleValueColumn","removePivotHeaderRowWhenSingleValueColumn",D],animateRows:[2,"animateRows","animateRows",D],cellFlashDuration:"cellFlashDuration",cellFadeDuration:"cellFadeDuration",allowShowChangeAfterFilter:[2,"allowShowChangeAfterFilter","allowShowChangeAfterFilter",D],domLayout:"domLayout",ensureDomOrder:[2,"ensureDomOrder","ensureDomOrder",D],enableCellSpan:[2,"enableCellSpan","enableCellSpan",D],enableRtl:[2,"enableRtl","enableRtl",D],suppressColumnVirtualisation:[2,"suppressColumnVirtualisation","suppressColumnVirtualisation",D],suppressMaxRenderedRowRestriction:[2,"suppressMaxRenderedRowRestriction","suppressMaxRenderedRowRestriction",D],suppressRowVirtualisation:[2,"suppressRowVirtualisation","suppressRowVirtualisation",D],rowDragManaged:[2,"rowDragManaged","rowDragManaged",D],rowDragInsertDelay:"rowDragInsertDelay",suppressRowDrag:[2,"suppressRowDrag","suppressRowDrag",D],suppressMoveWhenRowDragging:[2,"suppressMoveWhenRowDragging","suppressMoveWhenRowDragging",D],rowDragEntireRow:[2,"rowDragEntireRow","rowDragEntireRow",D],rowDragMultiRow:[2,"rowDragMultiRow","rowDragMultiRow",D],rowDragText:"rowDragText",dragAndDropImageComponent:"dragAndDropImageComponent",dragAndDropImageComponentParams:"dragAndDropImageComponentParams",fullWidthCellRenderer:"fullWidthCellRenderer",fullWidthCellRendererParams:"fullWidthCellRendererParams",embedFullWidthRows:[2,"embedFullWidthRows","embedFullWidthRows",D],groupDisplayType:"groupDisplayType",groupDefaultExpanded:"groupDefaultExpanded",autoGroupColumnDef:"autoGroupColumnDef",groupMaintainOrder:[2,"groupMaintainOrder","groupMaintainOrder",D],groupSelectsChildren:[2,"groupSelectsChildren","groupSelectsChildren",D],groupLockGroupColumns:"groupLockGroupColumns",groupAggFiltering:"groupAggFiltering",groupTotalRow:"groupTotalRow",grandTotalRow:"grandTotalRow",suppressStickyTotalRow:"suppressStickyTotalRow",groupSuppressBlankHeader:[2,"groupSuppressBlankHeader","groupSuppressBlankHeader",D],groupSelectsFiltered:[2,"groupSelectsFiltered","groupSelectsFiltered",D],showOpenedGroup:[2,"showOpenedGroup","showOpenedGroup",D],groupHideParentOfSingleChild:"groupHideParentOfSingleChild",groupRemoveSingleChildren:[2,"groupRemoveSingleChildren","groupRemoveSingleChildren",D],groupRemoveLowestSingleChildren:[2,"groupRemoveLowestSingleChildren","groupRemoveLowestSingleChildren",D],groupHideOpenParents:[2,"groupHideOpenParents","groupHideOpenParents",D],groupAllowUnbalanced:[2,"groupAllowUnbalanced","groupAllowUnbalanced",D],rowGroupPanelShow:"rowGroupPanelShow",groupRowRenderer:"groupRowRenderer",groupRowRendererParams:"groupRowRendererParams",treeData:[2,"treeData","treeData",D],treeDataChildrenField:"treeDataChildrenField",treeDataParentIdField:"treeDataParentIdField",rowGroupPanelSuppressSort:[2,"rowGroupPanelSuppressSort","rowGroupPanelSuppressSort",D],suppressGroupRowsSticky:[2,"suppressGroupRowsSticky","suppressGroupRowsSticky",D],groupHierarchyConfig:"groupHierarchyConfig",pinnedTopRowData:"pinnedTopRowData",pinnedBottomRowData:"pinnedBottomRowData",enableRowPinning:"enableRowPinning",isRowPinnable:"isRowPinnable",isRowPinned:"isRowPinned",rowModelType:"rowModelType",rowData:"rowData",asyncTransactionWaitMillis:"asyncTransactionWaitMillis",suppressModelUpdateAfterUpdateTransaction:[2,"suppressModelUpdateAfterUpdateTransaction","suppressModelUpdateAfterUpdateTransaction",D],datasource:"datasource",cacheOverflowSize:"cacheOverflowSize",infiniteInitialRowCount:"infiniteInitialRowCount",serverSideInitialRowCount:"serverSideInitialRowCount",suppressServerSideFullWidthLoadingRow:[2,"suppressServerSideFullWidthLoadingRow","suppressServerSideFullWidthLoadingRow",D],cacheBlockSize:"cacheBlockSize",maxBlocksInCache:"maxBlocksInCache",maxConcurrentDatasourceRequests:"maxConcurrentDatasourceRequests",blockLoadDebounceMillis:"blockLoadDebounceMillis",purgeClosedRowNodes:[2,"purgeClosedRowNodes","purgeClosedRowNodes",D],serverSideDatasource:"serverSideDatasource",serverSideSortAllLevels:[2,"serverSideSortAllLevels","serverSideSortAllLevels",D],serverSideEnableClientSideSort:[2,"serverSideEnableClientSideSort","serverSideEnableClientSideSort",D],serverSideOnlyRefreshFilteredGroups:[2,"serverSideOnlyRefreshFilteredGroups","serverSideOnlyRefreshFilteredGroups",D],serverSidePivotResultFieldSeparator:"serverSidePivotResultFieldSeparator",viewportDatasource:"viewportDatasource",viewportRowModelPageSize:"viewportRowModelPageSize",viewportRowModelBufferSize:"viewportRowModelBufferSize",alwaysShowHorizontalScroll:[2,"alwaysShowHorizontalScroll","alwaysShowHorizontalScroll",D],alwaysShowVerticalScroll:[2,"alwaysShowVerticalScroll","alwaysShowVerticalScroll",D],debounceVerticalScrollbar:[2,"debounceVerticalScrollbar","debounceVerticalScrollbar",D],suppressHorizontalScroll:[2,"suppressHorizontalScroll","suppressHorizontalScroll",D],suppressScrollOnNewData:[2,"suppressScrollOnNewData","suppressScrollOnNewData",D],suppressScrollWhenPopupsAreOpen:[2,"suppressScrollWhenPopupsAreOpen","suppressScrollWhenPopupsAreOpen",D],suppressAnimationFrame:[2,"suppressAnimationFrame","suppressAnimationFrame",D],suppressMiddleClickScrolls:[2,"suppressMiddleClickScrolls","suppressMiddleClickScrolls",D],suppressPreventDefaultOnMouseWheel:[2,"suppressPreventDefaultOnMouseWheel","suppressPreventDefaultOnMouseWheel",D],scrollbarWidth:"scrollbarWidth",rowSelection:"rowSelection",cellSelection:"cellSelection",rowMultiSelectWithClick:[2,"rowMultiSelectWithClick","rowMultiSelectWithClick",D],suppressRowDeselection:[2,"suppressRowDeselection","suppressRowDeselection",D],suppressRowClickSelection:[2,"suppressRowClickSelection","suppressRowClickSelection",D],suppressCellFocus:[2,"suppressCellFocus","suppressCellFocus",D],suppressHeaderFocus:[2,"suppressHeaderFocus","suppressHeaderFocus",D],selectionColumnDef:"selectionColumnDef",rowNumbers:"rowNumbers",suppressMultiRangeSelection:[2,"suppressMultiRangeSelection","suppressMultiRangeSelection",D],enableCellTextSelection:[2,"enableCellTextSelection","enableCellTextSelection",D],enableRangeSelection:[2,"enableRangeSelection","enableRangeSelection",D],enableRangeHandle:[2,"enableRangeHandle","enableRangeHandle",D],enableFillHandle:[2,"enableFillHandle","enableFillHandle",D],fillHandleDirection:"fillHandleDirection",suppressClearOnFillReduction:[2,"suppressClearOnFillReduction","suppressClearOnFillReduction",D],sortingOrder:"sortingOrder",accentedSort:[2,"accentedSort","accentedSort",D],unSortIcon:[2,"unSortIcon","unSortIcon",D],suppressMultiSort:[2,"suppressMultiSort","suppressMultiSort",D],alwaysMultiSort:[2,"alwaysMultiSort","alwaysMultiSort",D],multiSortKey:"multiSortKey",suppressMaintainUnsortedOrder:[2,"suppressMaintainUnsortedOrder","suppressMaintainUnsortedOrder",D],icons:"icons",rowHeight:"rowHeight",rowStyle:"rowStyle",rowClass:"rowClass",rowClassRules:"rowClassRules",suppressRowHoverHighlight:[2,"suppressRowHoverHighlight","suppressRowHoverHighlight",D],suppressRowTransform:[2,"suppressRowTransform","suppressRowTransform",D],columnHoverHighlight:[2,"columnHoverHighlight","columnHoverHighlight",D],gridId:"gridId",deltaSort:[2,"deltaSort","deltaSort",D],treeDataDisplayType:"treeDataDisplayType",enableGroupEdit:[2,"enableGroupEdit","enableGroupEdit",D],initialState:"initialState",theme:"theme",loadThemeGoogleFonts:[2,"loadThemeGoogleFonts","loadThemeGoogleFonts",D],themeCssLayer:"themeCssLayer",styleNonce:"styleNonce",themeStyleContainer:"themeStyleContainer",getContextMenuItems:"getContextMenuItems",getMainMenuItems:"getMainMenuItems",postProcessPopup:"postProcessPopup",processUnpinnedColumns:"processUnpinnedColumns",processCellForClipboard:"processCellForClipboard",processHeaderForClipboard:"processHeaderForClipboard",processGroupHeaderForClipboard:"processGroupHeaderForClipboard",processCellFromClipboard:"processCellFromClipboard",sendToClipboard:"sendToClipboard",processDataFromClipboard:"processDataFromClipboard",isExternalFilterPresent:"isExternalFilterPresent",doesExternalFilterPass:"doesExternalFilterPass",getChartToolbarItems:"getChartToolbarItems",createChartContainer:"createChartContainer",focusGridInnerElement:"focusGridInnerElement",navigateToNextHeader:"navigateToNextHeader",tabToNextHeader:"tabToNextHeader",navigateToNextCell:"navigateToNextCell",tabToNextCell:"tabToNextCell",getLocaleText:"getLocaleText",getDocument:"getDocument",paginationNumberFormatter:"paginationNumberFormatter",getGroupRowAgg:"getGroupRowAgg",isGroupOpenByDefault:"isGroupOpenByDefault",ssrmExpandAllAffectsAllRows:[2,"ssrmExpandAllAffectsAllRows","ssrmExpandAllAffectsAllRows",D],initialGroupOrderComparator:"initialGroupOrderComparator",processPivotResultColDef:"processPivotResultColDef",processPivotResultColGroupDef:"processPivotResultColGroupDef",getDataPath:"getDataPath",getChildCount:"getChildCount",getServerSideGroupLevelParams:"getServerSideGroupLevelParams",isServerSideGroupOpenByDefault:"isServerSideGroupOpenByDefault",isApplyServerSideTransaction:"isApplyServerSideTransaction",isServerSideGroup:"isServerSideGroup",getServerSideGroupKey:"getServerSideGroupKey",getBusinessKeyForNode:"getBusinessKeyForNode",getRowId:"getRowId",resetRowDataOnUpdate:[2,"resetRowDataOnUpdate","resetRowDataOnUpdate",D],processRowPostCreate:"processRowPostCreate",isRowSelectable:"isRowSelectable",isRowMaster:"isRowMaster",fillOperation:"fillOperation",postSortRows:"postSortRows",getRowStyle:"getRowStyle",getRowClass:"getRowClass",getRowHeight:"getRowHeight",isFullWidthRow:"isFullWidthRow",isRowValidDropPosition:"isRowValidDropPosition"},outputs:{toolPanelVisibleChanged:"toolPanelVisibleChanged",toolPanelSizeChanged:"toolPanelSizeChanged",columnMenuVisibleChanged:"columnMenuVisibleChanged",contextMenuVisibleChanged:"contextMenuVisibleChanged",cutStart:"cutStart",cutEnd:"cutEnd",pasteStart:"pasteStart",pasteEnd:"pasteEnd",columnVisible:"columnVisible",columnPinned:"columnPinned",columnResized:"columnResized",columnMoved:"columnMoved",columnValueChanged:"columnValueChanged",columnPivotModeChanged:"columnPivotModeChanged",columnPivotChanged:"columnPivotChanged",columnGroupOpened:"columnGroupOpened",newColumnsLoaded:"newColumnsLoaded",gridColumnsChanged:"gridColumnsChanged",displayedColumnsChanged:"displayedColumnsChanged",virtualColumnsChanged:"virtualColumnsChanged",columnEverythingChanged:"columnEverythingChanged",columnsReset:"columnsReset",columnHeaderMouseOver:"columnHeaderMouseOver",columnHeaderMouseLeave:"columnHeaderMouseLeave",columnHeaderClicked:"columnHeaderClicked",columnHeaderContextMenu:"columnHeaderContextMenu",componentStateChanged:"componentStateChanged",cellValueChanged:"cellValueChanged",cellEditRequest:"cellEditRequest",rowValueChanged:"rowValueChanged",cellEditingStarted:"cellEditingStarted",cellEditingStopped:"cellEditingStopped",rowEditingStarted:"rowEditingStarted",rowEditingStopped:"rowEditingStopped",bulkEditingStarted:"bulkEditingStarted",bulkEditingStopped:"bulkEditingStopped",batchEditingStarted:"batchEditingStarted",batchEditingStopped:"batchEditingStopped",undoStarted:"undoStarted",undoEnded:"undoEnded",redoStarted:"redoStarted",redoEnded:"redoEnded",cellSelectionDeleteStart:"cellSelectionDeleteStart",cellSelectionDeleteEnd:"cellSelectionDeleteEnd",rangeDeleteStart:"rangeDeleteStart",rangeDeleteEnd:"rangeDeleteEnd",fillStart:"fillStart",fillEnd:"fillEnd",filterOpened:"filterOpened",filterChanged:"filterChanged",filterModified:"filterModified",filterUiChanged:"filterUiChanged",floatingFilterUiChanged:"floatingFilterUiChanged",advancedFilterBuilderVisibleChanged:"advancedFilterBuilderVisibleChanged",findChanged:"findChanged",chartCreated:"chartCreated",chartRangeSelectionChanged:"chartRangeSelectionChanged",chartOptionsChanged:"chartOptionsChanged",chartDestroyed:"chartDestroyed",cellKeyDown:"cellKeyDown",gridReady:"gridReady",firstDataRendered:"firstDataRendered",gridSizeChanged:"gridSizeChanged",modelUpdated:"modelUpdated",virtualRowRemoved:"virtualRowRemoved",viewportChanged:"viewportChanged",bodyScroll:"bodyScroll",bodyScrollEnd:"bodyScrollEnd",dragStarted:"dragStarted",dragStopped:"dragStopped",dragCancelled:"dragCancelled",stateUpdated:"stateUpdated",paginationChanged:"paginationChanged",rowDragEnter:"rowDragEnter",rowDragMove:"rowDragMove",rowDragLeave:"rowDragLeave",rowDragEnd:"rowDragEnd",rowDragCancel:"rowDragCancel",rowResizeStarted:"rowResizeStarted",rowResizeEnded:"rowResizeEnded",columnRowGroupChanged:"columnRowGroupChanged",rowGroupOpened:"rowGroupOpened",expandOrCollapseAll:"expandOrCollapseAll",pivotMaxColumnsExceeded:"pivotMaxColumnsExceeded",pinnedRowDataChanged:"pinnedRowDataChanged",pinnedRowsChanged:"pinnedRowsChanged",rowDataUpdated:"rowDataUpdated",asyncTransactionsFlushed:"asyncTransactionsFlushed",storeRefreshed:"storeRefreshed",headerFocused:"headerFocused",cellClicked:"cellClicked",cellDoubleClicked:"cellDoubleClicked",cellFocused:"cellFocused",cellMouseOver:"cellMouseOver",cellMouseOut:"cellMouseOut",cellMouseDown:"cellMouseDown",rowClicked:"rowClicked",rowDoubleClicked:"rowDoubleClicked",rowSelected:"rowSelected",selectionChanged:"selectionChanged",cellContextMenu:"cellContextMenu",rangeSelectionChanged:"rangeSelectionChanged",cellSelectionChanged:"cellSelectionChanged",tooltipShow:"tooltipShow",tooltipHide:"tooltipHide",sortChanged:"sortChanged"},features:[ue([sM,rM]),uu],decls:0,vars:0,template:function(o,r){},encapsulation:2});let e=t;return e})(),_X=new Set(Pw);function RX(e,t){return _X.has(e)?t===""?!0:t==="false"?!1:t:t}function PX(e,t){if(e&1){let i=xe();S(0,"button",2),V("click",function(){let o=j(i).$implicit,r=I();return K(r.onActionClick(o))}),H(1,"ng-icon",3),x()}if(e&2){let i=t.$implicit;U("variant",i.variant||"ghost"),E(),U("name",i.icon)}}var ga=(()=>{class e{actions=[];data;agInit(i){this.actions=i.actions||[],this.data=i.data}refresh(i){return this.actions=i.actions||[],this.data=i.data,!0}onActionClick(i){i.action(this.data)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["gh-ag-grid-actions-cell"]],decls:3,vars:0,consts:[[1,"flex","gap-2","h-full","items-center"],["hlmBtn","","size","icon",3,"variant"],["hlmBtn","","size","icon",3,"click","variant"],["hlm","","size","sm",3,"name"]],template:function(n,o){n&1&&(S(0,"div",0),ei(1,PX,2,2,"button",1,hu),x()),n&2&&(E(),ti(o.actions))},dependencies:[Ze,We,ot],encapsulation:2,changeDetection:0})}return e})();var DT=Sa(PT(),1),MT=Sa(jd(),1),Wb=Sa(Rg(),1),zb=Sa(Vt(),1),kT=Sa(_b(),1),TT=Sa(rb(),1);var FT=["*"];function Ub(e){let t=e.getLayer()||e.getStage();t&&t.batchDraw()}function IT(e,t={},i={}){"id"in t&&console.warn('ng2-konva: You are using "id" attribute for Konva node. In some very rare cases it may produce bugs. Currently we recommend not to use it and use "name" attribute instead.');let n=e.getStage(),o={},r=!1;if(Object.keys(i).forEach(s=>{let a=s.slice(0,2)==="on",l=i[s]!==t[s];if(a&&l){let d=s.slice(2).toLowerCase();d.slice(0,7)==="content"&&(d="content"+d.slice(7,8).toUpperCase()+d.slice(8)),n.off(d,i[s])}!Object.hasOwn(t,s)&&n.setAttr(s,void 0)}),Object.keys(t).forEach(s=>{let a=s.slice(0,2)==="on",l=i[s]!==t[s];if(a&&l){let c=s.slice(2).toLowerCase();c.slice(0,7)==="content"&&(c="content"+c.slice(7,8).toUpperCase()+c.slice(8)),t[s]&&(n.off(c),n.on(c,d=>{t[s]({angularComponent:e,event:d})}))}!a&&(t[s]!==i[s]||t[s]!==n.getAttr(s))&&(r=!0,o[s]=t[s])}),r){n.setAttrs(o),Ub(n);let s;Object.keys(o).forEach(a=>{if(s=o[a],s instanceof Image&&!s.complete){let l=n;s.addEventListener("load",function(){let c=l.getLayer();c&&c.batchDraw()})}})}}function Pte(e){return e.replace(/^\w|[A-Z]|\b\w/g,function(t,i){return i==0?t.toLowerCase():t.toUpperCase()}).replace(/\s+/g,"")}function Dte(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Mte(e){return Dte(Pte(e.slice(3).replace("-"," ")))}function AT(e){let t={};return["mouseover","mousemove","mouseout","mouseenter","mouseleave","mousedown","mouseup","wheel","contextmenu","click","dblclick","touchstart","touchmove","touchend","tap","dbltap","dragstart","dragmove","dragend","transformstart","transform","transformend"].forEach(i=>{let o=e[i];o.listeners?.length>0&&(t["on"+i]=o.emit.bind(o))}),t}var Df=(()=>{class e{shapes=Ra(e);config=Yi();#e=_e(()=>{let i=this.config();i&&this.uploadKonva(i)});mouseover=oe();mousemove=oe();mouseout=oe();mouseenter=oe();mouseleave=oe();mousedown=oe();mouseup=oe();wheel=oe();contextmenu=oe();click=oe();dblclick=oe();touchstart=oe();touchmove=oe();touchend=oe();tap=oe();dbltap=oe();dragstart=oe();dragmove=oe();dragend=oe();transformstart=oe();transform=oe();transformend=oe();nameNode=Mte(k(Je).nativeElement.localName);cacheProps={};_stage;getStage(){return this._stage}getNode(){return this._stage}getConfig(){return this.config()||{}}constructor(){this.initKonva()}initKonva(){this._stage||(this._stage=new zb.Shape),this.nameNode==="Shape"?this._stage=new zb.Shape:this.nameNode==="Sprite"?this._stage=new kT.Sprite(this.config()):this._stage=new DT.default[this.nameNode](void 0);let i=this._stage.to.bind(this._stage);this._stage.to=o=>{i(o),setTimeout(()=>{Object.keys(this._stage.attrs).forEach(r=>{typeof this._stage.attrs[r]!="function"&&this.config()&&this.config.update(s=>z(b({},s),{[r]:this._stage.attrs[r]}))})},200)};let n=this.config();n&&this.uploadKonva(n)}uploadKonva(i){if(!this._stage)return;let n=b(b({},i),AT(this));IT(this,n,this.cacheProps),this.cacheProps=n}#t=_e(()=>{this.shapes().forEach((i,n)=>{this!==i&&((this._stage instanceof MT.Group||this._stage instanceof Wb.Layer)&&this._stage.add(i.getStage()),i.getStage().zIndex(n),Ub(this._stage))})});ngOnDestroy(){this._stage.destroy()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["ko-shape"],["ko-layer"],["ko-circle"],["ko-fastlayer"],["ko-group"],["ko-label"],["ko-rect"],["ko-ellipse"],["ko-wedge"],["ko-line"],["ko-sprite"],["ko-image"],["ko-text"],["ko-text-path"],["ko-star"],["ko-ring"],["ko-arc"],["ko-tag"],["ko-path"],["ko-regular-polygon"],["ko-arrow"],["ko-transformer"]],contentQueries:function(n,o,r){n&1&&Ri(r,o.shapes,e,4),n&2&&ii()},inputs:{config:[1,"config"]},outputs:{config:"configChange",mouseover:"mouseover",mousemove:"mousemove",mouseout:"mouseout",mouseenter:"mouseenter",mouseleave:"mouseleave",mousedown:"mousedown",mouseup:"mouseup",wheel:"wheel",contextmenu:"contextmenu",click:"click",dblclick:"dblclick",touchstart:"touchstart",touchmove:"touchmove",touchend:"touchend",tap:"tap",dbltap:"dbltap",dragstart:"dragstart",dragmove:"dragmove",dragend:"dragend",transformstart:"transformstart",transform:"transform",transformend:"transformend"},ngContentSelectors:FT,decls:2,vars:0,template:function(n,o){n&1&&(ct(),Pn(0,"div"),ze(1),Dn())},encapsulation:2})}return e})(),LT=(()=>{class e{nodeContainer=k(Je).nativeElement;shapes=Ra(Df);config=M();#e=_e(()=>{let i=this.config();i&&(this._stage?this.uploadKonva(i):(this._stage=new TT.Stage(z(b({},i),{container:this.nodeContainer})),this.uploadKonva(i)))});mouseover=oe();mousemove=oe();mouseout=oe();mouseenter=oe();mouseleave=oe();mousedown=oe();mouseup=oe();wheel=oe();contextmenu=oe();click=oe();dblclick=oe();touchstart=oe();touchmove=oe();touchend=oe();tap=oe();dbltap=oe();dragstart=oe();dragmove=oe();dragend=oe();transformstart=oe();transform=oe();transformend=oe();_stage;cacheProps={};getStage(){return this._stage}getNode(){return this._stage}getConfig(){return this.config()||{}}uploadKonva(i){let n=b(b({},i),AT(this));IT(this,n,this.cacheProps),this.cacheProps=n}#t=_e(()=>{this.shapes().forEach((i,n)=>{if(!(i.getStage()instanceof Wb.Layer))throw"You can only add Layer Nodes to Stage Nodes!";this._stage.add(i.getStage()),i.getStage().zIndex(n),Ub(this._stage)})});ngOnDestroy(){this._stage.destroy()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["ko-stage"]],contentQueries:function(n,o,r){n&1&&Ri(r,o.shapes,Df,4),n&2&&ii()},inputs:{config:[1,"config"]},outputs:{mouseover:"mouseover",mousemove:"mousemove",mouseout:"mouseout",mouseenter:"mouseenter",mouseleave:"mouseleave",mousedown:"mousedown",mouseup:"mouseup",wheel:"wheel",contextmenu:"contextmenu",click:"click",dblclick:"dblclick",touchstart:"touchstart",touchmove:"touchmove",touchend:"touchend",tap:"tap",dbltap:"dbltap",dragstart:"dragstart",dragmove:"dragmove",dragend:"dragend",transformstart:"transformstart",transform:"transform",transformend:"transformend"},ngContentSelectors:FT,decls:2,vars:0,template:function(n,o){n&1&&(ct(),Pn(0,"div"),ze(1),Dn())},encapsulation:2})}return e})();var kte=()=>[10,5],Tte=(e,t)=>({points:e,stroke:"#3b82f6",strokeWidth:4,lineCap:"round",lineJoin:"round",dash:t}),Fte=(e,t)=>t.id;function Ite(e,t){if(e&1&&H(0,"ko-line",2),e&2){let i=t.$implicit;U("config",i)}}function Ate(e,t){if(e&1){let i=xe();S(0,"ko-line",3),V("click",function(){let o=j(i).$implicit,r=I();return K(r.onWallClick(o.id))})("mouseenter",function(){let o=j(i).$implicit,r=I();return K(r.onWallMouseEnter(o.id))})("mouseleave",function(){j(i);let o=I();return K(o.onWallMouseLeave())}),x()}if(e&2){let i=t.$implicit;U("config",i)}}function Lte(e,t){if(e&1&&H(0,"ko-line",2),e&2){let i=I();U("config",R1(2,Tte,i.tempLine(),Rr(1,kte)))}}var OT=(()=>{class e{canvasWidth=M(1600);canvasHeight=M(1200);gridSize=M(20);drawingMode=M("select");zoom=M(1);stagePosition=M({x:0,y:0});walls=Yi.required();wallClicked=oe();wallMouseEnter=oe();wallMouseLeave=oe();zoomChanged=oe();stagePositionChanged=oe();wallCreated=oe();wallMoved=oe();selectedWallId=J(null);hoveredWallId=J(null);isDrawing=J(!1);tempLine=J(null);isDragging=J(!1);draggedWallId=J(null);dragStartPos=J(null);draggedWallInitialCoords=J(null);isPanning=J(!1);panStartPos=J(null);panInitialStagePos=J(null);gridLines=L(()=>{let i=[],n=this.canvasWidth(),o=this.canvasHeight(),r=this.gridSize();for(let s=0;s<=n;s+=r)i.push({points:[s,0,s,o],stroke:"#e5e7eb",strokeWidth:s%(r*5)===0?1.5:.5});for(let s=0;s<=o;s+=r)i.push({points:[0,s,n,s],stroke:"#e5e7eb",strokeWidth:s%(r*5)===0?1.5:.5});return i});wallLines=L(()=>{let i=this.hoveredWallId(),n=this.selectedWallId(),o=this.draggedWallId();return this.walls().map(r=>{let s=r.color,a=1;return r.id===o?(s="#10b981",a=.7):r.id===n?s="#3b82f6":r.id===i&&(s="#6366f1"),{id:r.id,points:[r.start_x,r.start_y,r.end_x,r.end_y],stroke:s,strokeWidth:4,opacity:a,hitStrokeWidth:20,lineCap:"round",lineJoin:"round",listening:!0}})});stageConfig=L(()=>({width:this.canvasWidth(),height:this.canvasHeight(),scaleX:this.zoom(),scaleY:this.zoom(),x:this.stagePosition().x,y:this.stagePosition().y}));cursorStyle=L(()=>this.isPanning()?"grabbing":this.drawingMode()==="draw"?"crosshair":this.drawingMode()==="delete"?"not-allowed":this.drawingMode()==="move"?this.isDragging()?"grabbing":"grab":"default");onStageMouseDown(i){let n=i?.event?.target?.getStage();if(!n)return;let o=n.getPointerPosition();if(!o)return;let r=i.event.evt;if(r.button===1||r.button===0&&r.ctrlKey){this.isPanning.set(!0),this.panStartPos.set({x:r.clientX,y:r.clientY}),this.panInitialStagePos.set(b({},this.stagePosition()));return}if(this.drawingMode()==="draw")if(this.isDrawing()){let s=this.tempLine();s&&this.wallCreated.emit({start_x:s[0],start_y:s[1],end_x:s[2],end_y:s[3]}),this.isDrawing.set(!1),this.tempLine.set(null)}else{this.isDrawing.set(!0);let s=this.getCanvasPosition(o),a=this.snapToGrid(s);this.tempLine.set([a.x,a.y,a.x,a.y])}else if(this.drawingMode()==="move"){let s=this.getCanvasPosition(o),a=this.getWallAtPosition(s);a&&(this.isDragging.set(!0),this.draggedWallId.set(a.id),this.dragStartPos.set({x:s.x,y:s.y}),this.draggedWallInitialCoords.set({start_x:a.start_x,start_y:a.start_y,end_x:a.end_x,end_y:a.end_y}))}else if(this.drawingMode()==="delete"){let s=this.getCanvasPosition(o),a=this.getWallAtPosition(s);a&&(this.walls.update(l=>l.filter(c=>c.id!==a.id)),this.selectedWallId.set(null))}}onStageMouseMove(i){let n=i?.event?.target?.getStage();if(!n)return;let o=n.getPointerPosition();if(!o)return;let r=i.event.evt;if(this.isPanning()){let s=this.panStartPos(),a=this.panInitialStagePos();if(s&&a){let l=r.clientX-s.x,c=r.clientY-s.y;this.stagePositionChanged.emit({x:a.x+l,y:a.y+c})}return}if(this.drawingMode()==="draw"&&this.isDrawing()){let s=this.getCanvasPosition(o),a=this.snapToGrid(s),l=this.tempLine();l&&this.tempLine.set([l[0],l[1],a.x,a.y])}else if(this.drawingMode()==="move"&&this.isDragging()){let s=this.draggedWallId(),a=this.dragStartPos(),l=this.draggedWallInitialCoords();if(s&&a&&l){let c=this.getCanvasPosition(o),d=c.x-a.x,u=c.y-a.y;this.walls.update(h=>h.map(p=>p.id===s?z(b({},p),{start_x:l.start_x+d,start_y:l.start_y+u,end_x:l.end_x+d,end_y:l.end_y+u}):p))}}}onStageMouseUp(i){if(this.isPanning()){this.isPanning.set(!1),this.panStartPos.set(null),this.panInitialStagePos.set(null);return}if(this.drawingMode()==="move"&&this.isDragging()){let n=this.draggedWallId();if(n){let o=this.walls().find(r=>r.id===n);if(o){let r=this.snapToGrid({x:o.start_x,y:o.start_y}),s=this.snapToGrid({x:o.end_x,y:o.end_y});this.walls.update(a=>a.map(l=>l.id===n?z(b({},l),{start_x:r.x,start_y:r.y,end_x:s.x,end_y:s.y}):l)),this.wallMoved.emit({id:n,start_x:r.x,start_y:r.y,end_x:s.x,end_y:s.y})}}this.isDragging.set(!1),this.draggedWallId.set(null),this.dragStartPos.set(null),this.draggedWallInitialCoords.set(null)}}onWallClick(i){this.drawingMode()==="select"?(this.selectedWallId.set(i),this.wallClicked.emit(i)):this.drawingMode()==="delete"&&(this.walls.update(n=>n.filter(o=>o.id!==i)),this.selectedWallId.set(null))}onWallMouseEnter(i){this.hoveredWallId.set(i),this.wallMouseEnter.emit(i)}onWallMouseLeave(){this.hoveredWallId.set(null),this.wallMouseLeave.emit()}snapToGrid(i){let n=this.gridSize();return{x:Math.round(i.x/n)*n,y:Math.round(i.y/n)*n}}getCanvasPosition(i){let n=this.zoom(),o=this.stagePosition();return{x:(i.x-o.x)/n,y:(i.y-o.y)/n}}getWallAtPosition(i){for(let o of this.walls())if(this.distanceToLineSegment(i,{x:o.start_x,y:o.start_y},{x:o.end_x,y:o.end_y})<10)return o;return null}distanceToLineSegment(i,n,o){let r=o.x-n.x,s=o.y-n.y,a=r*r+s*s;if(a===0)return Math.sqrt((i.x-n.x)**2+(i.y-n.y)**2);let l=((i.x-n.x)*r+(i.y-n.y)*s)/a;l=Math.max(0,Math.min(1,l));let c=n.x+l*r,d=n.y+l*s;return Math.sqrt((i.x-c)**2+(i.y-d)**2)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["gh-house-plan-canvas"]],inputs:{canvasWidth:[1,"canvasWidth"],canvasHeight:[1,"canvasHeight"],gridSize:[1,"gridSize"],drawingMode:[1,"drawingMode"],zoom:[1,"zoom"],stagePosition:[1,"stagePosition"],walls:[1,"walls"]},outputs:{walls:"wallsChange",wallClicked:"wallClicked",wallMouseEnter:"wallMouseEnter",wallMouseLeave:"wallMouseLeave",zoomChanged:"zoomChanged",stagePositionChanged:"stagePositionChanged",wallCreated:"wallCreated",wallMoved:"wallMoved"},decls:9,vars:4,consts:[[1,"bg-white","inline-block"],[3,"mousedown","mousemove","mouseup","config"],[3,"config"],[3,"click","mouseenter","mouseleave","config"]],template:function(n,o){n&1&&(S(0,"div",0)(1,"ko-stage",1),V("mousedown",function(s){return o.onStageMouseDown(s)})("mousemove",function(s){return o.onStageMouseMove(s)})("mouseup",function(s){return o.onStageMouseUp(s)}),S(2,"ko-layer"),ei(3,Ite,1,1,"ko-line",2,hu),x(),S(5,"ko-layer"),ei(6,Ate,1,1,"ko-line",2,Fte),ve(8,Lte,1,5,"ko-line",2),x()()()),n&2&&(jt("cursor",o.cursorStyle()),E(),U("config",o.stageConfig()),E(2),ti(o.gridLines()),E(3),ti(o.wallLines()),E(2),Ce(o.tempLine()?8:-1))},dependencies:[ui,LT,Df],encapsulation:2,changeDetection:0})}return e})();var qb=(()=>{class e{_computedClass=L(()=>le("block",this.userClass()));userClass=M("",{alias:"class"});static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["ng-scrollbar","hlm",""]],hostVars:12,hostBindings:function(n,o){n&2&&(ce(o._computedClass()),jt("--scrollbar-border-radius",100,"px")("--scrollbar-offset",3)("--scrollbar-thumb-color","hsl(var(--border))")("--scrollbar-thumb-hover-color","hsl(var(--border))")("--scrollbar-thickness",7))},inputs:{userClass:[1,"class","userClass"]}})}return e})();var Nte=4,Bte=.001,Hte=1e-7,Vte=10,tu=11,Mf=1/(tu-1),Gte=typeof Float32Array=="function";function NT(e,t){return 1-3*t+3*e}function BT(e,t){return 3*t-6*e}function HT(e){return 3*e}function kf(e,t,i){return((NT(t,i)*e+BT(t,i))*e+HT(t))*e}function VT(e,t,i){return 3*NT(t,i)*e*e+2*BT(t,i)*e+HT(t)}function zte(e,t,i,n,o){let r,s,a=0;do s=t+(i-t)/2,r=kf(s,n,o)-e,r>0?i=s:t=s;while(Math.abs(r)>Hte&&++a<Vte);return s}function Wte(e,t,i,n){for(let o=0;o<Nte;++o){let r=VT(t,i,n);if(r===0)return t;let s=kf(t,i,n)-e;t-=s/r}return t}function Ute(e){return e}function qte(e,t,i,n){if(!(0<=e&&e<=1&&0<=i&&i<=1))throw new Error("bezier x values must be in [0, 1] range");if(e===t&&i===n)return Ute;let o=Gte?new Float32Array(tu):new Array(tu);for(let s=0;s<tu;++s)o[s]=kf(s*Mf,e,i);function r(s){let a=0,l=1,c=tu-1;for(;l!==c&&o[l]<=s;++l)a+=Mf;--l;let d=(s-o[l])/(o[l+1]-o[l]),u=a+d*Mf,h=VT(u,e,i);return h>=Bte?Wte(s,u,e,i):h===0?u:zte(s,a,a+Mf,e,i)}return function(a){return a===0?0:a===1?1:kf(r(a),t,n)}}var $te={duration:468,easing:{x1:.42,y1:0,x2:.58,y2:1}},jte=new bt("SMOOTH_SCROLL_OPTIONS",{providedIn:"root",factory:()=>$te});var GT=(()=>{let t=class t{constructor(){this.document=k(Li),this.zone=k(di),this._defaultOptions=k(jte),this.onGoingScrolls=new Map}get now(){return this.document.defaultView.performance?.now?.bind(this.document.defaultView.performance)||Date.now}scrollElement(n,o,r){n.scrollLeft=o,n.scrollTop=r}getElement(n,o){return typeof n=="string"?(o||this.document).querySelector(n):An(n)}getScrollDestroyerRef(n){return this.onGoingScrolls.has(n)&&this.onGoingScrolls.get(n).next(),this.onGoingScrolls.set(n,new qe).get(n)}step(n){return new Ql(o=>{let r=(this.now()-n.startTime)/n.duration;r=r>1?1:r;let s=n.easing(r);n.currentX=n.startX+(n.x-n.startX)*s,n.currentY=n.startY+(n.y-n.startY)*s,this.scrollElement(n.scrollable,n.currentX,n.currentY),requestAnimationFrame(()=>{o.next(),o.complete()})})}isReached(n,o){return n.currentX===n.x&&n.currentY===n.y?(o.next(),!0):!1}scrolling(n,o){return this.step(n).pipe(tc(()=>!this.isReached(n,o)),xi(()=>this.scrolling(n,o)))}onScrollReached(n,o,r){r.complete(),this.onGoingScrolls.delete(n),this.zone.run(()=>o())}interrupted(n,o){return ko($t(n,"wheel",{passive:!0,capture:!0}),$t(n,"touchmove",{passive:!0,capture:!0}),o).pipe(Ea(1))}applyScrollToOptions(n,o){return o.duration?new Promise(r=>{this.zone.runOutsideAngular(()=>{let s=this.getScrollDestroyerRef(n),a={scrollable:n,startTime:this.now(),startX:n.scrollLeft,startY:n.scrollTop,x:o.left==null?n.scrollLeft:~~o.left,y:o.top==null?n.scrollTop:~~o.top,duration:o.duration,easing:qte(o.easing.x1,o.easing.y1,o.easing.x2,o.easing.y2)};this.scrolling(a,s).pipe(lt(this.interrupted(n,s)),$e(()=>this.onScrollReached(n,r,s))).subscribe()})}):(this.scrollElement(n,o.left,o.top),Promise.resolve())}scrollTo(n,o){let r=this.getElement(n),s=getComputedStyle(r).direction==="rtl",a=z(b(b({},this._defaultOptions),o),{left:o.left==null?s?o.end:o.start:o.left,right:o.right==null?s?o.start:o.end:o.right});return a.bottom!=null&&(a.top=r.scrollHeight-r.clientHeight-a.bottom),s?(a.left!=null&&(a.right=r.scrollWidth-r.clientWidth-a.left),a.left=a.right?-a.right:a.right):a.right!=null&&(a.left=r.scrollWidth-r.clientWidth-a.right),this.applyScrollToOptions(r,a)}scrollToElement(n,o,r={}){let s=this.getElement(n),a=this.getElement(o,s),l=getComputedStyle(s).direction==="rtl";if(!a||!s)return Promise.resolve();let c=s.getBoundingClientRect(),d=a.getBoundingClientRect(),u=z(b(b({},this._defaultOptions),r),{top:d.top+s.scrollTop-c.top+(r.top||0),left:r.left==null?l?r.end:r.start:r.left,right:r.right==null?l?r.start:r.end:r.right});if(r.center){let p=c.left+c.width/2,g=c.top+c.height/2,f=d.left+d.width/2,m=d.top+d.height/2;return u.left=f-p+s.scrollLeft,u.top=m-g+s.scrollTop,this.applyScrollToOptions(s,u)}if(u.bottom!=null){let p=c.height-d.height;u.top=d.top+s.scrollTop-c.top-p+(r.bottom||0)}u.left=d.left-c.left+s.scrollLeft+(u.left||0),u.right!=null&&(u.left=d.right-c.left+s.scrollLeft-c.width+(u.right||0));let h={top:u.top,left:u.left,easing:u.easing,duration:u.duration};return this.applyScrollToOptions(s,h)}};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=qi({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var Kte=["scrollbarButton",""];function Yte(e,t){if(e&1&&H(0,"button",4)(1,"button",5),e&2){let i=I();ce(Ao("ng-scrollbar-button ",i.cmp.buttonClass())),E(),ce(Ao("ng-scrollbar-button ",i.cmp.buttonClass()))}}function Xte(e,t){if(e&1&&H(0,"button",4)(1,"button",5),e&2){let i=I();ce(Ao("ng-scrollbar-button ",i.cmp.buttonClass())),E(),ce(Ao("ng-scrollbar-button ",i.cmp.buttonClass()))}}var Jte="[_nghost-%COMP%]{position:absolute;inset:0;pointer-events:none;min-width:calc(var(--viewport-width) * 1px);min-height:calc(var(--viewport-height) * 1px)}.ng-scrollbar-sticky[_ngcontent-%COMP%]{top:calc(var(--_scrollbar-wrapper-top) * 1px);left:calc(var(--_scrollbar-wrapper-left) * 1px);right:calc(var(--_scrollbar-wrapper-right) * 1px);height:calc(var(--_scrollbar-wrapper-height) * 1px);width:calc(var(--_scrollbar-wrapper-width) * 1px);position:sticky;z-index:100;opacity:var(--_scrollbar-hover-opacity);transition:var(--_scrollbar-opacity-transition);pointer-events:var(--_scrollbar-pointer-events)}.ng-scrollbar-track-wrapper[_ngcontent-%COMP%]{touch-action:none;-webkit-user-select:none;user-select:none;top:var(--_scrollbar-track-top);bottom:var(--_scrollbar-track-bottom);right:var(--_scrollbar-track-right);left:var(--_scrollbar-track-left);transition:var(--INTERNAL-scrollbar-track-wrapper-transition);position:absolute;overflow:hidden;display:flex;place-items:center}.ng-scrollbar-track[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;background-color:var(--INTERNAL-scrollbar-track-color);border-radius:var(--INTERNAL-scrollbar-border-radius);cursor:default;z-index:1;order:2}.ng-scrollbar-thumb[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;transition:var(--INTERNAL-scrollbar-thumb-transition);border-radius:var(--INTERNAL-scrollbar-border-radius);height:var(--_thumb-height);width:var(--_thumb-width);animation-name:_ngcontent-%COMP%_scrollbarThumbAnimation;animation-duration:1ms;animation-timing-function:linear}@keyframes _ngcontent-%COMP%_scrollbarThumbAnimation{0%{translate:var(--_scrollbar-thumb-transform-from)}to{translate:var(--_scrollbar-thumb-transform-to)}}";function Qte(e,t){e&1&&H(0,"scrollbar-y")}function Zte(e,t){e&1&&H(0,"scrollbar-x")}var eie=["contentWrapper"],tie=["*"];var zT=(()=>{let t=class t{constructor(){this.nativeElement=k(Je).nativeElement}};t.\u0275fac=function(o){return new(o||t)},t.\u0275dir=se({type:t,selectors:[["","scrollViewport",""]]});let e=t;return e})();function Kb(e){return an(()=>e.onselectstart=()=>!1)}function Yb(e){return an(()=>e.onselectstart=null)}function iu(){return an(e=>{e.preventDefault(),e.stopPropagation()})}function iie(e,t){return e.pipe(C1(t||0,null,{leading:!1,trailing:!0}))}var Tf=(function(e){return e.Viewport="ng-scroll-viewport",e.Content="ng-scroll-content",e.Spacer="ng-scroll-spacer",e})(Tf||{}),WT=(()=>{let t=class t{constructor(){this.initialized=J(!1)}get offsetHeight(){return this.nativeElement.offsetHeight}get offsetWidth(){return this.nativeElement.offsetWidth}get scrollTop(){return this.nativeElement.scrollTop}get scrollLeft(){return this.nativeElement.scrollLeft}get contentHeight(){return this.contentWrapperElement.offsetHeight}get contentWidth(){return this.contentWrapperElement.offsetWidth}get scrollMaxX(){return this.contentWidth-this.offsetWidth}get scrollMaxY(){return this.contentHeight-this.offsetHeight}init(n,o,r){n.classList.add(Tf.Viewport),this.nativeElement=n,o.classList.add(Tf.Content),r?(r.classList.add(Tf.Spacer),this.contentWrapperElement=r):this.contentWrapperElement=o,this.initialized.set(!0)}reset(){this.nativeElement=null,this.contentWrapperElement=null,this.initialized.set(!1)}scrollYTo(n){this.nativeElement.scrollTop=n}scrollXTo(n){this.nativeElement.scrollLeft=n}};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=qi({token:t,factory:t.\u0275fac});let e=t;return e})(),ou=new bt("NG_SCROLLBAR"),nie={trackClass:"",thumbClass:"",buttonClass:"",orientation:"auto",appearance:"native",visibility:"native",position:"native",trackScrollDuration:50,sensorThrottleTime:0,disableSensor:!1,disableInteraction:!1,buttons:!1,hoverOffset:!1},oie="https://cdn.statically.io/gist/MurhafSousli/c852b6a672069396953f06ddd4b64620/raw/ef55db72e2abb7bc002ed79f4ad4cf408bfdb72f/scroll-timeline-lite.js",jb=(function(e){return e.AfterInit="AfterInit",e.Resized="ResizeObserver",e})(jb||{}),rie=new bt("NG_SCROLLBAR_OPTIONS",{providedIn:"root",factory:()=>nie}),sie=new bt("NG_SCROLLBAR_POLYFILL",{providedIn:"root",factory:()=>oie});var aie=(()=>{let t=class t{constructor(){this.options=k(rie),this.sharedResizeObserver=k(nS),this.zone=k(di),this.platform=k(Cu),this.isMobile=this.platform.IOS||this.platform.ANDROID,this.dir=k(Ds),this.smoothScroll=k(GT),this.viewport=k(WT,{self:!0}),this.nativeElement=k(Je).nativeElement,this.direction=sc(this.dir.change,{initialValue:this.dir.value}),this.dragging=J("none"),this.orientation=M(this.options.orientation),this.visibility=M(this.options.visibility),this.buttons=M(this.options.buttons,{transform:D}),this.disableInteraction=M(this.options.disableInteraction,{transform:D}),this.disableSensor=M(this.options.disableSensor,{transform:D}),this.sensorThrottleTime=M(this.options.sensorThrottleTime,{transform:Fn}),this.hoverOffset=M(this.options.hoverOffset,{transform:D}),this.viewportDimension=J({width:0,height:0}),this.contentDimension=J({width:0,height:0}),this.state=L(()=>{let r=!1,s=!1,a=!1,l=!1,c=this.orientation(),d=this.visibility(),u=this.viewportDimension(),h=this.contentDimension();return(c==="auto"||c==="vertical")&&(a=h.height>u.height,r=d==="visible"||a),(c==="auto"||c==="horizontal")&&(l=h.width>u.width,s=d==="visible"||l),{verticalUsed:r,horizontalUsed:s,isVerticallyScrollable:a,isHorizontallyScrollable:l}}),this.isVerticallyScrollable=L(()=>this.state().isVerticallyScrollable),this.isHorizontallyScrollable=L(()=>this.state().isHorizontallyScrollable),this.verticalUsed=L(()=>this.state().verticalUsed),this.horizontalUsed=L(()=>this.state().horizontalUsed),this.trackScrollDuration=M(this.options.trackScrollDuration,{transform:Fn}),this.appearance=M(this.options.appearance),this.position=M(this.options.position),this.trackClass=M(this.options.trackClass),this.thumbClass=M(this.options.thumbClass),this.buttonClass=M(this.options.thumbClass),this.afterInit=oe(),this.afterUpdate=oe();let n,o;gu({earlyRead:r=>{let s=this.disableSensor(),a=this.sensorThrottleTime(),l=this.viewport.initialized();Oi(()=>{l&&(s?requestAnimationFrame(()=>this.update(jb.AfterInit)):this.zone.runOutsideAngular(()=>{n=iie(v1([this.sharedResizeObserver.observe(this.viewport.nativeElement),this.sharedResizeObserver.observe(this.viewport.contentWrapperElement)]),a).subscribe(()=>{this.zone.run(()=>{this.updateDimensions(),o?this.afterUpdate.emit():this.afterInit.emit(),o=!0})})})),r(()=>n?.unsubscribe())})}})}update(n){this.updateDimensions(),n===jb.AfterInit?this.afterInit.emit():this.afterUpdate.emit()}scrollTo(n){return this.smoothScroll.scrollTo(this.viewport.nativeElement,n)}scrollToElement(n,o){return this.smoothScroll.scrollToElement(this.viewport.nativeElement,n,o)}updateDimensions(){this.viewportDimension.set({width:this.viewport.offsetWidth,height:this.viewport.offsetHeight}),this.contentDimension.set({width:this.viewport.contentWidth,height:this.viewport.contentHeight})}};t.\u0275fac=function(o){return new(o||t)},t.\u0275dir=se({type:t,hostVars:22,hostBindings:function(o,r){o&2&&(Qe("verticalUsed",r.verticalUsed())("horizontalUsed",r.horizontalUsed())("isVerticallyScrollable",r.isVerticallyScrollable())("isHorizontallyScrollable",r.isHorizontallyScrollable())("mobile",r.isMobile)("dir",r.direction())("position",r.position())("dragging",r.dragging())("appearance",r.appearance())("visibility",r.visibility())("orientation",r.orientation())("disableInteraction",r.disableInteraction()),jt("--content-height",r.contentDimension().height)("--content-width",r.contentDimension().width)("--viewport-height",r.viewportDimension().height)("--viewport-width",r.viewportDimension().width),dt("ng-scrollbar",!0))},inputs:{orientation:[1,"orientation"],visibility:[1,"visibility"],buttons:[1,"buttons"],disableInteraction:[1,"disableInteraction"],disableSensor:[1,"disableSensor"],sensorThrottleTime:[1,"sensorThrottleTime"],hoverOffset:[1,"hoverOffset"],trackScrollDuration:[1,"trackScrollDuration"],appearance:[1,"appearance"],position:[1,"position"],trackClass:[1,"trackClass"],thumbClass:[1,"thumbClass"],buttonClass:[1,"buttonClass"]},outputs:{afterInit:"afterInit",afterUpdate:"afterUpdate"},features:[ue([{provide:ou,useExisting:t}])]});let e=t;return e})(),Xb=new bt("SCROLLBAR_CONTROL"),UT=(()=>{let t=class t{constructor(){this.trackSize=J(0),this.cmp=k(ou)}};t.\u0275fac=function(o){return new(o||t)},t.\u0275dir=se({type:t});let e=t;return e})(),Jb=(()=>{let t=class t{constructor(){this.cmp=k(ou),this.control=k(Xb),this.document=k(Li),this.zone=k(di),this.nativeElement=k(Je).nativeElement,_e(n=>{let o=this.cmp.disableInteraction();Oi(()=>{o||this.zone.runOutsideAngular(()=>{this._pointerEventsSub=this.pointerEvents.subscribe()}),n(()=>this._pointerEventsSub?.unsubscribe())})})}};t.\u0275fac=function(o){return new(o||t)},t.\u0275dir=se({type:t});let e=t;return e})(),nu=(()=>{let t=class t extends Jb{get viewportSize(){return this.cmp.viewport[this.control.sizeProperty]}get clientRect(){return this.nativeElement.getBoundingClientRect()}get offset(){return this.clientRect[this.control.rectOffsetProperty]}get size(){return this.nativeElement[this.control.sizeProperty]}get pointerEvents(){let n=$t(this.nativeElement,"pointerdown").pipe(iu(),Kb(this.document)),o=$t(this.document,"pointerup",{passive:!0}).pipe(Yb(this.document)),r=$t(this.nativeElement,"pointerover",{passive:!0}).pipe(an(c=>this.currMousePosition=c[this.control.offsetProperty]),Rn(()=>!0)),s=$t(this.nativeElement,"pointerout",{passive:!0}).pipe(Rn(()=>!1)),a=ko(r,s).pipe(ec(!0)),l=$t(this.nativeElement,"pointermove",{passive:!0}).pipe(an(c=>this.currMousePosition=c[this.control.offsetProperty]));return n.pipe(xi(c=>(l.pipe(lt(o)).subscribe(),this.onTrackFirstClick(c).pipe(Zl(200),xi(()=>a.pipe(xi(d=>{let u=this.getScrollDirection(this.currMousePosition),h=this.scrollDirection===u;return d&&h?this.onTrackOngoingMousedown():m1}))),lt(o)))))}constructor(){gu({earlyRead:()=>{this.cmp.viewportDimension(),this.cmp.contentDimension(),Oi(()=>{this.control.trackSize.set(this.size),this.size||requestAnimationFrame(()=>this.control.trackSize.set(this.size))})}}),super()}onTrackFirstClick(n){return this.currMousePosition=n[this.control.offsetProperty],this.scrollDirection=this.getScrollDirection(this.currMousePosition),this.scrollMax=this.control.viewportScrollMax,this.scrollTo(this.nextStep())}nextStep(){if(this.scrollDirection==="forward"){let o=this.getScrollForwardStep();return o>=this.scrollMax?this.scrollMax:o}let n=this.getScrollBackwardStep();return n<=0?0:n}onTrackOngoingMousedown(){let n=this.nextStep();return this.scrollTo(n).pipe(tc(()=>!this.isReached(n)),xi(()=>this.onTrackOngoingMousedown()))}isReached(n){return this.scrollDirection==="forward"?n>=this.scrollMax:n<=0}};t.\u0275fac=function(o){return new(o||t)},t.\u0275dir=se({type:t,features:[Ot]});let e=t;return e})(),lie=(()=>{let t=class t extends nu{get contentSize(){return this.cmp.viewport.contentWidth}constructor(){_e(()=>{this.cmp.direction()==="rtl"?(this.getCurrPosition=()=>(this.contentSize-this.viewportSize-this.control.viewportScrollOffset)*this.size/this.contentSize,this.getScrollDirection=n=>n<this.getCurrPosition()?"forward":"backward"):(this.getCurrPosition=()=>this.control.viewportScrollOffset*this.size/this.contentSize,this.getScrollDirection=n=>n>this.getCurrPosition()?"forward":"backward")}),super()}scrollTo(n){return Ve(this.cmp.scrollTo({start:n,duration:this.cmp.trackScrollDuration()}))}getScrollForwardStep(){return this.control.viewportScrollOffset+this.viewportSize}getScrollBackwardStep(){return this.control.viewportScrollOffset-this.viewportSize}};t.\u0275fac=function(o){return new(o||t)},t.\u0275dir=se({type:t,selectors:[["","scrollbarTrackX",""]],features:[ue([{provide:nu,useExisting:t}]),Ot]});let e=t;return e})(),cie=(()=>{let t=class t extends nu{get contentSize(){return this.cmp.viewport.contentHeight}getCurrPosition(){return this.control.viewportScrollOffset*this.size/this.contentSize}getScrollDirection(n){return n>this.getCurrPosition()?"forward":"backward"}scrollTo(n){return Ve(this.cmp.scrollTo({top:n,duration:this.cmp.trackScrollDuration()}))}getScrollForwardStep(){return this.control.viewportScrollOffset+this.viewportSize}getScrollBackwardStep(){return this.control.viewportScrollOffset-this.viewportSize}};t.\u0275fac=(()=>{let n;return function(r){return(n||(n=_i(t)))(r||t)}})(),t.\u0275dir=se({type:t,selectors:[["","scrollbarTrackY",""]],features:[ue([{provide:nu,useExisting:t}]),Ot]});let e=t;return e})(),qT=(()=>{let t=class t{constructor(){this.isBrowser=Pr(k(xr)),this._polyfillUrl=k(sie),this.document=k(Li),this.window=this.document.defaultView,this.scrollTimelinePolyfill=J(null),this.isBrowser&&(!this.window.ScrollTimeline||!CSS.supports("animation-timeline","scroll()"))&&this.initPolyfill()}async initPolyfill(){try{let n=this.document.createElement("script");n.src=this._polyfillUrl,await new Promise((o,r)=>{n.onload=o,n.onerror=r,this.document.head.appendChild(n)}),this.window.ScrollTimeline?this.scrollTimelinePolyfill.set(this.window.ScrollTimeline):console.error("[NgScrollbar]: ScrollTimeline is not attached to the window object.")}catch(n){console.error("[NgScrollbar]: Error loading ScrollTimeline script:",n)}}};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=qi({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})(),Ff=(()=>{let t=class t extends Jb{get size(){return this.nativeElement.getBoundingClientRect()[this.control.rectSizeProperty]}get trackMax(){return this.track.size-this.size}get pointerEvents(){return $t(this.nativeElement,"pointerdown").pipe(iu(),Kb(this.document),xi(n=>{let o,r,s=Ge(n).pipe(an(()=>{o=this.trackMax,r=this.control.viewportScrollMax,this.setDragging(this.control.axis)})),a=$t(this.document,"pointermove").pipe(iu()),l=$t(this.document,"pointerup",{capture:!0}).pipe(iu(),Yb(this.document),an(()=>this.setDragging("none")));return s.pipe(Rn(c=>c[this.control.offsetProperty]),xi(c=>a.pipe(Rn(d=>d[this.control.clientProperty]),Rn(d=>d-this.track.offset),Rn(d=>r*(d-c)/o),an(d=>this.control.instantScrollTo(d,r)),lt(l))))}))}constructor(){gu({earlyRead:()=>{let n=this.manager.scrollTimelinePolyfill();Oi(()=>{n&&!this._animation&&(this._animation=die(n,this.nativeElement,this.cmp.viewport.nativeElement,this.control.axis))})}}),super(),this.manager=k(qT),this.track=k(nu)}setDragging(n){this.zone.run(()=>this.cmp.dragging.set(n))}};t.\u0275fac=function(o){return new(o||t)},t.\u0275dir=se({type:t,features:[Ot]});let e=t;return e})();function die(e,t,i,n){return t.animate({translate:["var(--_scrollbar-thumb-transform-from)","var(--_scrollbar-thumb-transform-to)"]},{fill:"both",easing:"linear",timeline:new e({source:i,axis:n})})}var uie=(()=>{let t=class t extends Ff{};t.\u0275fac=(()=>{let n;return function(r){return(n||(n=_i(t)))(r||t)}})(),t.\u0275dir=se({type:t,selectors:[["","scrollbarThumbX",""]],features:[ue([{provide:Ff,useExisting:t}]),Ot]});let e=t;return e})(),hie=(()=>{let t=class t extends Ff{};t.\u0275fac=(()=>{let n;return function(r){return(n||(n=_i(t)))(r||t)}})(),t.\u0275dir=se({type:t,selectors:[["","scrollbarThumbY",""]],features:[ue([{provide:Ff,useExisting:t}]),Ot]});let e=t;return e})(),pie={forward:(e,t)=>e<t,backward:e=>e>0},$T={forward:(e,t)=>t+e,backward:(e,t)=>t-e},gie={rtl:{forward:(e,t,i)=>i-t-e,backward:(e,t,i)=>i-t+e},ltr:$T},jT=(()=>{let t=class t extends Jb{get pointerEvents(){let n=$t(this.nativeElement,"pointerdown").pipe(iu(),Kb(this.document)),o=$t(this.document,"pointerup",{passive:!0}).pipe(Yb(this.document)),r=$t(this.nativeElement,"pointerleave",{passive:!0}),s=ko(o,r);return n.pipe(xi(()=>this.firstScrollStep().pipe(Zl(this.afterFirstClickDelay),xi(()=>this.onOngoingPointerdown()),lt(s))))}constructor(){_e(()=>{let n=this.scrollDirection(),o=this.cmp.direction();Oi(()=>{this.canScroll=pie[n],this.control.axis==="x"?this.nextStep=gie[o][n]:this.nextStep=$T[n]})}),super(),this.scrollbarButton=M.required(),this.scrollDirection=M.required(),this.afterFirstClickDelay=120,this.firstClickDuration=100,this.scrollBy=50,this.onGoingScrollBy=12}firstScrollStep(){let n=this.nextStep(this.scrollBy,this.control.viewportScrollOffset,this.control.viewportScrollMax);return this.control.scrollTo(n,this.firstClickDuration)}onGoingScrollStep(){let n=this.control.viewportScrollMax,o=this.nextStep(this.onGoingScrollBy,this.control.viewportScrollOffset,n);this.control.instantScrollTo(o,n)}onOngoingPointerdown(){return ws(0,du).pipe(tc(()=>this.canScroll(this.control.viewportScrollOffset,this.control.viewportScrollMax)),an(()=>this.onGoingScrollStep()))}};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=re({type:t,selectors:[["button","scrollbarButton",""]],inputs:{scrollbarButton:[1,"scrollbarButton"],scrollDirection:[1,"scrollDirection"]},features:[Ot],attrs:Kte,decls:3,vars:0,consts:[[1,"ng-scrollbar-button-icon"],["viewBox","0 0 512 512","xmlns","http://www.w3.org/2000/svg"],["d","M413.1,327.3l-1.8-2.1l-136-156.5c-4.6-5.3-11.5-8.6-19.2-8.6c-7.7,0-14.6,3.4-19.2,8.6L101,324.9l-2.3,2.6  C97,330,96,333,96,336.2c0,8.7,7.4,15.8,16.6,15.8v0h286.8v0c9.2,0,16.6-7.1,16.6-15.8C416,332.9,414.9,329.8,413.1,327.3z"]],template:function(o,r){o&1&&(Pn(0,"div",0),b1(),Pn(1,"svg",1),pu(2,"path",2),Dn()())},styles:["[_nghost-%COMP%]{position:relative;border:none;margin:0;padding:0;border-radius:0;appearance:none;background-color:var(--INTERNAL-scrollbar-button-color)}[_nghost-%COMP%]   svg[_ngcontent-%COMP%]{width:100%;height:100%;fill:var(--INTERNAL-scrollbar-button-fill)}[_nghost-%COMP%]:hover{background:var(--INTERNAL-scrollbar-button-hover-color)}[_nghost-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--INTERNAL-scrollbar-button-hover-fill)}[_nghost-%COMP%]:active{background:var(--INTERNAL-scrollbar-button-active-color)}[_nghost-%COMP%]:active   svg[_ngcontent-%COMP%]{fill:var(--INTERNAL-scrollbar-button-active-fill)}[scrollbarButton=top][_nghost-%COMP%], [scrollbarButton=start][_nghost-%COMP%]{order:1}[scrollbarButton=bottom][_nghost-%COMP%], [scrollbarButton=end][_nghost-%COMP%]{order:3}[scrollbarButton=top][_nghost-%COMP%], [scrollbarButton=bottom][_nghost-%COMP%]{width:100%;height:var(--INTERNAL-scrollbar-button-size)}[scrollbarButton=start][_nghost-%COMP%], [scrollbarButton=end][_nghost-%COMP%]{width:var(--INTERNAL-scrollbar-button-size);height:100%}[scrollbarButton=bottom][_nghost-%COMP%]{--_button-rotate: 180deg}[scrollbarButton=start][_nghost-%COMP%]{--_button-rotate: -90deg}[scrollbarButton=start][_nghost-%COMP%]   .ng-scrollbar-button-icon[_ngcontent-%COMP%]{writing-mode:vertical-lr}[scrollbarButton=end][_nghost-%COMP%]{--_button-rotate: 90deg}[scrollbarButton=end][_nghost-%COMP%]   .ng-scrollbar-button-icon[_ngcontent-%COMP%]{writing-mode:vertical-rl}.ng-scrollbar-button-icon[_ngcontent-%COMP%]{rotate:var(--_button-rotate);display:flex;place-content:center;place-items:center;width:100%;height:100%}"],changeDetection:0});let e=t;return e})(),fie=(()=>{let t=class t extends UT{constructor(){super(...arguments),this.rectOffsetProperty="top",this.rectSizeProperty="height",this.sizeProperty="offsetHeight",this.clientProperty="clientY",this.offsetProperty="offsetY",this.axis="y"}get viewportScrollMax(){return this.cmp.viewport.scrollMaxY}get viewportScrollOffset(){return this.cmp.viewport.scrollTop}scrollTo(n,o){return Ve(this.cmp.scrollTo({top:n,duration:o}))}instantScrollTo(n){this.cmp.viewport.scrollYTo(n)}};t.\u0275fac=(()=>{let n;return function(r){return(n||(n=_i(t)))(r||t)}})(),t.\u0275cmp=re({type:t,selectors:[["scrollbar-y"]],hostVars:2,hostBindings:function(o,r){o&2&&jt("--track-size",r.trackSize())},features:[ue([{provide:Xb,useExisting:t}]),Ot],decls:5,vars:11,consts:[[1,"ng-scrollbar-sticky"],[1,"ng-scrollbar-track-wrapper"],["scrollbarTrackY",""],["scrollbarThumbY",""],["scrollbarButton","top","scrollDirection","backward"],["scrollbarButton","bottom","scrollDirection","forward"]],template:function(o,r){o&1&&(S(0,"div",0)(1,"div",1)(2,"div",2),H(3,"div",3),x(),ve(4,Yte,2,6),x()()),o&2&&(dt("ng-scrollbar-hover",r.cmp.hoverOffset()),E(),dt("ng-scrollbar-hover",!r.cmp.hoverOffset()),E(),ce(Ao("ng-scrollbar-track ",r.cmp.trackClass())),E(),ce(Ao("ng-scrollbar-thumb ",r.cmp.thumbClass())),E(),Ce(r.cmp.buttons()?4:-1))},dependencies:[cie,hie,jT],styles:["[_nghost-%COMP%]{position:absolute;inset:0;pointer-events:none;min-width:calc(var(--viewport-width) * 1px);min-height:calc(var(--viewport-height) * 1px)}.ng-scrollbar-sticky[_ngcontent-%COMP%]{top:calc(var(--_scrollbar-wrapper-top) * 1px);left:calc(var(--_scrollbar-wrapper-left) * 1px);right:calc(var(--_scrollbar-wrapper-right) * 1px);height:calc(var(--_scrollbar-wrapper-height) * 1px);width:calc(var(--_scrollbar-wrapper-width) * 1px);position:sticky;z-index:100;opacity:var(--_scrollbar-hover-opacity);transition:var(--_scrollbar-opacity-transition);pointer-events:var(--_scrollbar-pointer-events)}.ng-scrollbar-track-wrapper[_ngcontent-%COMP%]{touch-action:none;-webkit-user-select:none;user-select:none;top:var(--_scrollbar-track-top);bottom:var(--_scrollbar-track-bottom);right:var(--_scrollbar-track-right);left:var(--_scrollbar-track-left);transition:var(--INTERNAL-scrollbar-track-wrapper-transition);position:absolute;overflow:hidden;display:flex;place-items:center}.ng-scrollbar-track[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;background-color:var(--INTERNAL-scrollbar-track-color);border-radius:var(--INTERNAL-scrollbar-border-radius);cursor:default;z-index:1;order:2}.ng-scrollbar-thumb[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;transition:var(--INTERNAL-scrollbar-thumb-transition);border-radius:var(--INTERNAL-scrollbar-border-radius);height:var(--_thumb-height);width:var(--_thumb-width);animation-name:_ngcontent-%COMP%_scrollbarThumbAnimation;animation-duration:1ms;animation-timing-function:linear}@keyframes _ngcontent-%COMP%_scrollbarThumbAnimation{0%{translate:var(--_scrollbar-thumb-transform-from)}to{translate:var(--_scrollbar-thumb-transform-to)}}","[_nghost-%COMP%]{--_scrollbar-wrapper-top: 0;--_scrollbar-wrapper-left: var(--_scrollbar-wrapper-y-left);--_scrollbar-wrapper-right: var(--_scrollbar-wrapper-y-right);--_scrollbar-wrapper-height: var(--viewport-height);--_scrollbar-wrapper-width: var(--_scrollbar-thickness);--_scrollbar-track-top: var(--_vertical-top);--_scrollbar-track-bottom: var(--_vertical-bottom);--_scrollbar-track-right: var(--_vertical-right);--_scrollbar-track-left: var(--_vertical-left);--thumb-size: max(calc(var(--viewport-height) * var(--track-size) / var(--content-height)), var(--INTERNAL-scrollbar-thumb-min-size));--_thumb-height: calc(var(--thumb-size) * 1px);--_thumb-width: 100%;--_scrollbar-y-thumb-transform-to-value: calc(var(--track-size) - var(--thumb-size));--_scrollbar-thumb-transform-from: 0 0;--_scrollbar-thumb-transform-to: 0 calc(var(--_scrollbar-y-thumb-transform-to-value) * 1px)}.ng-scrollbar-track-wrapper[_ngcontent-%COMP%]{width:var(--_track-y-thickness);flex-direction:column}.ng-scrollbar-hover[_ngcontent-%COMP%]:hover, .ng-scrollbar-hover[_ngcontent-%COMP%]:active{--_track-y-thickness: var(--_scrollbar-hover-thickness-px);--_thumb-y-color: var(--INTERNAL-scrollbar-thumb-hover-color)}.ng-scrollbar-thumb[_ngcontent-%COMP%]{animation-timeline:var(--_animation-timeline-y);min-height:calc(var(--INTERNAL-scrollbar-thumb-min-size) * 1px);display:var(--_vertical-thumb-display);background-color:var(--_thumb-y-color)}"],changeDetection:0});let e=t;return e})(),mie=(()=>{let t=class t extends UT{get viewportScrollMax(){return this.cmp.viewport.scrollMaxX}get viewportScrollOffset(){return Math.abs(this.cmp.viewport.scrollLeft)}constructor(){_e(()=>{this.cmp.direction()==="rtl"?this.handlePosition=(n,o)=>-(o-n):this.handlePosition=n=>n}),super(),this.manager=k(qT),this.rectOffsetProperty="left",this.rectSizeProperty="width",this.sizeProperty="offsetWidth",this.clientProperty="clientX",this.offsetProperty="offsetX",this.axis="x"}scrollTo(n,o){return Ve(this.cmp.scrollTo({left:n,duration:o}))}instantScrollTo(n,o){this.cmp.viewport.scrollXTo(this.handlePosition(n,o))}};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=re({type:t,selectors:[["scrollbar-x"]],hostVars:3,hostBindings:function(o,r){o&2&&(Qe("dir",r.cmp.direction()),jt("--track-size",r.trackSize()))},features:[ue([{provide:Xb,useExisting:t}]),Ot],decls:5,vars:11,consts:[[1,"ng-scrollbar-sticky"],[1,"ng-scrollbar-track-wrapper"],["scrollbarTrackX",""],["scrollbarThumbX",""],["scrollbarButton","start","scrollDirection","backward"],["scrollbarButton","end","scrollDirection","forward"]],template:function(o,r){o&1&&(S(0,"div",0)(1,"div",1)(2,"div",2),H(3,"div",3),x(),ve(4,Xte,2,6),x()()),o&2&&(dt("ng-scrollbar-hover",r.cmp.hoverOffset()),E(),dt("ng-scrollbar-hover",!r.cmp.hoverOffset()),E(),ce(Ao("ng-scrollbar-track ",r.cmp.trackClass())),E(),ce(Ao("ng-scrollbar-thumb ",r.cmp.thumbClass())),E(),Ce(r.cmp.buttons()?4:-1))},dependencies:[lie,uie,jT],styles:[Jte,"[_nghost-%COMP%]{--_scrollbar-wrapper-top: var(--_scrollbar-wrapper-x-top);--_scrollbar-wrapper-left: 0;--_scrollbar-wrapper-right: 0;--_scrollbar-wrapper-height: var(--_scrollbar-thickness);--_scrollbar-wrapper-width: var(--viewport-width);--_scrollbar-track-top: var(--_horizontal-top);--_scrollbar-track-bottom: var(--_horizontal-bottom);--_scrollbar-track-right: var(--_horizontal-right);--_scrollbar-track-left: var(--_horizontal-left);--thumb-size: max(calc(var(--viewport-width) * var(--track-size) / var(--content-width)), var(--INTERNAL-scrollbar-thumb-min-size));--_thumb-height: 100%;--_thumb-width: calc(var(--thumb-size) * 1px);--_scrollbar-x-thumb-transform-to-value: calc(var(--track-size) - var(--thumb-size));--_scrollbar-thumb-transform-from: 0;--_scrollbar-thumb-transform-to: calc(var(--_scrollbar-x-thumb-transform-to-value) * 1px)}[_nghost-%COMP%]   .ng-scrollbar-button[scrollbarButton=start][_ngcontent-%COMP%]{_--button-rotate:90}[_nghost-%COMP%]   .ng-scrollbar-button[scrollbarButton=end][_ngcontent-%COMP%]{_--button-rotate:-90}[dir=rtl][_nghost-%COMP%]   .ng-scrollbar-thumb[_ngcontent-%COMP%]{animation-name:_ngcontent-%COMP%_scrollbarThumbRTLAnimation;will-change:right;--_scrollbar-thumb-transform-to: calc(var(--_scrollbar-x-thumb-transform-to-value) * -1px)}[dir=rtl][_nghost-%COMP%]   .ng-scrollbar-button[scrollbarButton=start][_ngcontent-%COMP%]{--_button-rotate: 90deg}[dir=rtl][_nghost-%COMP%]   .ng-scrollbar-button[scrollbarButton=end][_ngcontent-%COMP%]{--_button-rotate: -90deg}.ng-scrollbar-track-wrapper[_ngcontent-%COMP%]{height:var(--_track-x-thickness);flex-direction:row}.ng-scrollbar-hover[_ngcontent-%COMP%]:hover, .ng-scrollbar-hover[_ngcontent-%COMP%]:active{--_track-x-thickness: var(--_scrollbar-hover-thickness-px);--_thumb-x-color: var(--INTERNAL-scrollbar-thumb-hover-color)}.ng-scrollbar-thumb[_ngcontent-%COMP%]{animation-timeline:var(--_animation-timeline-x);min-width:calc(var(--INTERNAL-scrollbar-thumb-min-size) * 1px);display:var(--_horizontal-thumb-display);background-color:var(--_thumb-x-color)}@keyframes _ngcontent-%COMP%_scrollbarThumbRTLAnimation{0%{right:var(--_scrollbar-thumb-transform-from)}to{right:calc(var(--_scrollbar-thumb-transform-to) * -1)}}"],changeDetection:0});let e=t;return e})(),$b=(()=>{let t=class t{constructor(){this.cmp=k(ou)}};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=re({type:t,selectors:[["scrollbars"]],decls:2,vars:2,template:function(o,r){o&1&&(ve(0,Qte,1,0,"scrollbar-y"),ve(1,Zte,1,0,"scrollbar-x")),o&2&&(Ce(r.cmp.verticalUsed()?0:-1),E(),Ce(r.cmp.horizontalUsed()?1:-1))},dependencies:[mie,fie],styles:["[_nghost-%COMP%]{display:contents}"],changeDetection:0});let e=t;return e})(),KT=(()=>{let t=class t extends aie{constructor(){_e(()=>{let n=this.contentWrapper().nativeElement;Oi(()=>{this.viewport.init(this.nativeElement,n)})}),super(),this.contentWrapper=jn.required("contentWrapper"),this._scrollbars=jn.required($b)}};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=re({type:t,selectors:[["ng-scrollbar",3,"externalViewport",""]],viewQuery:function(o,r){o&1&&($n(r.contentWrapper,eie,5),$n(r._scrollbars,$b,5)),o&2&&ii(2)},exportAs:["ngScrollbar"],features:[ue([{provide:ou,useExisting:t},WT]),Ot],ngContentSelectors:tie,decls:4,vars:0,consts:[["contentWrapper",""]],template:function(o,r){o&1&&(ct(),S(0,"div",null,0),ze(2),H(3,"scrollbars"),x())},dependencies:[$b],styles:["[_nghost-%COMP%]{display:block;position:relative;max-height:100%;max-width:100%;--INTERNAL-scrollbar-border-radius: var(--scrollbar-border-radius, 0px);--INTERNAL-scrollbar-thickness: var(--scrollbar-thickness, 5);--INTERNAL-scrollbar-offset: var(--scrollbar-offset, 0);--INTERNAL-scrollbar-track-wrapper-transition: var(--scrollbar-track-wrapper-transition, width 60ms linear, height 60ms linear);--INTERNAL-scrollbar-track-color: var(--scrollbar-track-color, transparent);--INTERNAL-scrollbar-thumb-color: var(--scrollbar-thumb-color, rgb(0 0 0 / 20%));--INTERNAL-scrollbar-thumb-hover-color: var(--scrollbar-thumb-hover-color, var(--INTERNAL-scrollbar-thumb-color));--INTERNAL-scrollbar-hover-thickness: var(--scrollbar-hover-thickness, var(--INTERNAL-scrollbar-thickness));--INTERNAL-scrollbar-thumb-transition: var(--scrollbar-thumb-transition, none);--INTERNAL-scrollbar-thumb-min-size: var(--scrollbar-thumb-min-size, 20);--INTERNAL-scrollbar-button-color: var(--scrollbar-button-color, var(--INTERNAL-scrollbar-thumb-color));--INTERNAL-scrollbar-button-hover-color: var(--scrollbar-button-hover-color, var(--INTERNAL-scrollbar-button-color));--INTERNAL-scrollbar-button-active-color: var(--scrollbar-button-active-color, var(--INTERNAL-scrollbar-button-hover-color));--INTERNAL-scrollbar-button-fill: var(--scrollbar-button-fill, white);--INTERNAL-scrollbar-button-hover-fill: var(--scrollbar-button-hover-fill, var(--INTERNAL-scrollbar-button-fill));--INTERNAL-scrollbar-button-active-fill: var(--scrollbar-button-active-fill, var(--INTERNAL-scrollbar-button-hover-fill));--INTERNAL-scrollbar-button-size: var(--scrollbar-button-size, 20px);--INTERNAL-scrollbar-hover-opacity-transition-enter-duration: var(--scrollbar-hover-opacity-transition-enter-duration, 0);--INTERNAL-scrollbar-hover-opacity-transition-leave-duration: var(--scrollbar-hover-opacity-transition-leave-duration, .4s);--INTERNAL-scrollbar-hover-opacity-transition-leave-delay: var(--scrollbar-hover-opacity-transition-leave-delay, 1s);--INTERNAL-scrollbar-overscroll-behavior: var(--scrollbar-overscroll-behavior, initial);--INTERNAL-scrollbar-mobile-overscroll-behavior: var(--scrollbar-mobile-overscroll-behavior, none);--_scrollbar-thickness: calc(var(--INTERNAL-scrollbar-thickness) + var(--INTERNAL-scrollbar-offset) * 2);--_scrollbar-pointer-events: auto;--_scrollbar-offset-px: calc(var(--INTERNAL-scrollbar-offset) * 1px);--_scrollbar-thickness-px: calc(var(--INTERNAL-scrollbar-thickness) * 1px);--_scrollbar-hover-thickness-px: calc(var(--INTERNAL-scrollbar-hover-thickness) * 1px);--_viewport-padding-top: 0;--_viewport-padding-bottom: 0;--_viewport-padding-left: 0;--_viewport-padding-right: 0;--_horizontal-thumb-display: block;--_vertical-thumb-display: block;--_viewport-overflow: auto;--_viewport-pointer-events: auto;--_thumb-x-color: var(--INTERNAL-scrollbar-thumb-color);--_thumb-y-color: var(--INTERNAL-scrollbar-thumb-color);--_track-y-thickness: var(--_scrollbar-thickness-px);--_track-x-thickness: var(--_scrollbar-thickness-px);--_viewport-overscroll-behavior: var(--INTERNAL-scrollbar-overscroll-behavior);--_scrollbar-content-width: fit-content}[_nghost-%COMP%]{--_spacer-width: var(--spacer-width);--_spacer-height: var(--spacer-height);--_vertical-top: var(--_scrollbar-offset-px);--_vertical-bottom: var(--_scrollbar-offset-px);--_horizontal-left: var(--_scrollbar-offset-px);--_horizontal-right: var(--_scrollbar-offset-px);--_horizontal-top: initial;--_horizontal-bottom: var(--_scrollbar-offset-px);--_scrollbar-wrapper-x-top: calc(var(--viewport-height) - var(--_scrollbar-thickness));--reached-offset: 1px;--reached-offset-top: var(--reached-offset);--reached-offset-bottom: var(--reached-offset);--reached-offset-start: var(--reached-offset);--reached-offset-end: var(--reached-offset);--dropped-offset: 1px;--dropped-offset-top: var(--dropped-offset);--dropped-offset-bottom: var(--dropped-offset);--dropped-offset-start: var(--dropped-offset);--dropped-offset-end: var(--dropped-offset);--_viewport_scroll-timeline: unset;--_animation-timeline-y: unset;--_scrollbar-y-thumb-transform-to-value: unset;--_scrollbar-x-thumb-transform-to-value: unset;--_scrollbar-thumb-transform-from: unset;--_scrollbar-thumb-transform-to: unset}.ng-scrollbar-external-viewport[_nghost-%COMP%]     .ng-scroll-viewport{min-height:100%;min-width:100%;height:100%;max-height:100%;max-width:100%}.ng-scroll-viewport[_nghost-%COMP%], .ng-scrollbar-external-viewport[_nghost-%COMP%]     .ng-scroll-viewport{position:relative;overflow:var(--_viewport-overflow);scroll-timeline:var(--_viewport_scroll-timeline);box-sizing:border-box!important;-webkit-overflow-scrolling:touch;will-change:scroll-position;-webkit-user-select:var(--_viewport-user-select);user-select:var(--_viewport-user-select);overscroll-behavior:var(--_viewport-overscroll-behavior);pointer-events:var(--_viewport-pointer-events)}.ng-scroll-viewport[_nghost-%COMP%] > .ng-scroll-content[_ngcontent-%COMP%], .ng-scrollbar-external-viewport[_nghost-%COMP%]     .ng-scroll-viewport>.ng-scroll-content{width:var(--_scrollbar-content-width);z-index:1;min-width:100%;min-height:100%;contain:content;padding:var(--_viewport-padding-top, 0) var(--_viewport-padding-right, 0) var(--_viewport-padding-bottom, 0) var(--_viewport-padding-left, 0)}[appearance=native][_nghost-%COMP%]{--_spacer-width: calc(var(--spacer-width) + var(--_scrollbar-thickness));--_spacer-height: calc(var(--spacer-height) + var(--_scrollbar-thickness))}.ng-scroll-viewport[_nghost-%COMP%] > .ng-scroll-spacer[_ngcontent-%COMP%], .ng-scrollbar-external-viewport[_nghost-%COMP%]     .ng-scroll-viewport>.ng-scroll-spacer{position:relative;width:calc(var(--_spacer-width) * 1px);height:calc(var(--_spacer-height) * 1px)}.ng-scroll-viewport[_nghost-%COMP%], .ng-scrollbar-external-viewport[_nghost-%COMP%]     .ng-scroll-viewport{scrollbar-width:none!important}.ng-scroll-viewport[_nghost-%COMP%]::-webkit-scrollbar, .ng-scrollbar-external-viewport[_nghost-%COMP%]     .ng-scroll-viewport::-webkit-scrollbar{display:none!important}[position=invertX][_nghost-%COMP%], [position=invertAll][_nghost-%COMP%]{--_horizontal-top: var(--_scrollbar-offset-px);--_horizontal-bottom: initial;--_scrollbar-wrapper-x-top: 0}[dir=ltr][_nghost-%COMP%]{--_scrollbar-wrapper-y-right: initial;--_vertical-right: var(--_scrollbar-offset-px);--_vertical-left: initial;--_scrollbar-wrapper-y-left: calc(var(--viewport-width) - var(--_scrollbar-thickness))}[dir=ltr][position=invertY][_nghost-%COMP%], [dir=ltr][position=invertAll][_nghost-%COMP%]{--_vertical-left: var(--_scrollbar-offset-px);--_vertical-right: initial;--_scrollbar-wrapper-y-left: 0}[dir=rtl][_nghost-%COMP%]{--_scrollbar-wrapper-y-left: initial;--_vertical-left: var(--_scrollbar-offset-px);--_vertical-right: initial;--_scrollbar-wrapper-y-right: calc(var(--viewport-width) - var(--_scrollbar-thickness))}[dir=rtl][position=invertY][_nghost-%COMP%], [dir=rtl][position=invertAll][_nghost-%COMP%]{--_vertical-right: var(--_scrollbar-offset-px);--_vertical-left: initial;--_scrollbar-wrapper-y-right: 0}[verticalUsed=true][horizontalUsed=true][_nghost-%COMP%]{--_scrollbar-thickness-margin: calc(var(--INTERNAL-scrollbar-thickness) + var(--INTERNAL-scrollbar-offset) * 3);--_scrollbar-thickness-margin-px: calc(var(--_scrollbar-thickness-margin) * 1px)}[horizontalUsed=true][_nghost-%COMP%]{--_vertical-top: var(--_scrollbar-offset-px);--_vertical-bottom: var(--_scrollbar-thickness-margin-px)}[horizontalUsed=true][position=invertX][_nghost-%COMP%], [horizontalUsed=true][position=invertAll][_nghost-%COMP%]{--_vertical-top: var(--_scrollbar-thickness-margin-px);--_vertical-bottom: var(--_scrollbar-offset-px)}[verticalUsed=true][dir=ltr][_nghost-%COMP%]{--_horizontal-left: var(--_scrollbar-offset-px);--_horizontal-right: var(--_scrollbar-thickness-margin-px)}[verticalUsed=true][dir=rtl][_nghost-%COMP%]{--_horizontal-left: var(--_scrollbar-thickness-margin-px);--_horizontal-right: var(--_scrollbar-offset-px)}[verticalUsed=true][position=invertY][dir=ltr][_nghost-%COMP%], [verticalUsed=true][position=invertAll][dir=ltr][_nghost-%COMP%]{--_horizontal-left: var(--_scrollbar-thickness-margin-px);--_horizontal-right: var(--_scrollbar-offset-px)}[verticalUsed=true][position=invertY][dir=rtl][_nghost-%COMP%], [verticalUsed=true][position=invertAll][dir=rtl][_nghost-%COMP%]{--_horizontal-left: var(--_scrollbar-offset-px);--_horizontal-right: var(--_scrollbar-thickness-margin-px)}[appearance=native][verticalUsed=true][dir=ltr][_nghost-%COMP%]{--_viewport-padding-left: 0;--_viewport-padding-right: calc(var(--_scrollbar-thickness) * 1px)}[appearance=native][verticalUsed=true][dir=rtl][_nghost-%COMP%]{--_viewport-padding-left: calc(var(--_scrollbar-thickness) * 1px);--_viewport-padding-right: 0}[appearance=native][verticalUsed=true][position=invertY][dir=ltr][_nghost-%COMP%], [appearance=native][verticalUsed=true][position=invertAll][dir=ltr][_nghost-%COMP%]{--_viewport-padding-left: calc(var(--_scrollbar-thickness) * 1px);--_viewport-padding-right: 0}[appearance=native][verticalUsed=true][position=invertY][dir=rtl][_nghost-%COMP%], [appearance=native][verticalUsed=true][position=invertAll][dir=rtl][_nghost-%COMP%]{--_viewport-padding-left: 0;--_viewport-padding-right: calc(var(--_scrollbar-thickness) * 1px)}[appearance=native][horizontalUsed=true][_nghost-%COMP%]{--_viewport-padding-top: 0;--_viewport-padding-bottom: calc(var(--_scrollbar-thickness) * 1px)}[appearance=native][horizontalUsed=true][position=invertX][_nghost-%COMP%], [appearance=native][horizontalUsed=true][position=invertAll][_nghost-%COMP%]{--_viewport-padding-top: calc(var(--_scrollbar-thickness) * 1px);--_viewport-padding-bottom: 0}[visibility=hover][_nghost-%COMP%]{--_scrollbar-hover-opacity: 0;--_scrollbar-opacity-transition: opacity var(--INTERNAL-scrollbar-hover-opacity-transition-leave-duration) var(--INTERNAL-scrollbar-hover-opacity-transition-leave-delay)}[visibility=hover][_nghost-%COMP%]:hover, [visibility=hover][_nghost-%COMP%]:active, [visibility=hover][_nghost-%COMP%]:focus{--_scrollbar-hover-opacity: 1;--_scrollbar-opacity-transition: opacity var(--INTERNAL-scrollbar-hover-opacity-transition-enter-duration)}[dir=ltr][_nghost-%COMP%]     .scroll-reached-trigger-element[trigger=start], [dir=ltr][_nghost-%COMP%]     .scroll-dropped-trigger-element[trigger=start]{left:0;right:unset}[dir=ltr][_nghost-%COMP%]     .scroll-reached-trigger-element[trigger=end], [dir=ltr][_nghost-%COMP%]     .scroll-dropped-trigger-element[trigger=end]{right:0;left:unset}[dir=rtl][_nghost-%COMP%]     .scroll-reached-trigger-element[trigger=start], [dir=rtl][_nghost-%COMP%]     .scroll-dropped-trigger-element[trigger=start]{right:0;left:unset}[dir=rtl][_nghost-%COMP%]     .scroll-reached-trigger-element[trigger=end], [dir=rtl][_nghost-%COMP%]     .scroll-dropped-trigger-element[trigger=end]{left:0;right:unset}[_nghost-%COMP%]     .ng-scroll-reached-wrapper, [_nghost-%COMP%]     .ng-scroll-dropped-wrapper, [_nghost-%COMP%]     .scroll-reached-trigger-element, [_nghost-%COMP%]     .scroll-dropped-trigger-element{position:absolute;-webkit-user-select:none;user-select:none;pointer-events:none;z-index:-9999}[_nghost-%COMP%]     .ng-scroll-reached-wrapper, [_nghost-%COMP%]     .ng-scroll-dropped-wrapper{visibility:hidden;inset:0;min-width:calc(var(--viewport-width) * 1px);min-height:calc(var(--viewport-height) * 1px)}[_nghost-%COMP%]     [isHorizontallyScrollable=false] .scroll-reached-trigger-element[trigger=end], [_nghost-%COMP%]     [isHorizontallyScrollable=false] .scroll-dropped-trigger-element[trigger=end]{display:none}[_nghost-%COMP%]     [isVerticallyScrollable=false] .scroll-reached-trigger-element[trigger=bottom], [_nghost-%COMP%]     [isVerticallyScrollable=false] .scroll-dropped-trigger-element[trigger=bottom]{display:none}[_nghost-%COMP%]     .scroll-reached-trigger-element{background:red}[_nghost-%COMP%]     .scroll-reached-trigger-element[trigger=top], [_nghost-%COMP%]     .scroll-reached-trigger-element[trigger=bottom]{left:0;right:0}[_nghost-%COMP%]     .scroll-reached-trigger-element[trigger=start], [_nghost-%COMP%]     .scroll-reached-trigger-element[trigger=end]{top:0;bottom:0}[_nghost-%COMP%]     .scroll-reached-trigger-element[trigger=top]{top:0;height:var(--reached-offset-top)}[_nghost-%COMP%]     .scroll-reached-trigger-element[trigger=bottom]{bottom:0;height:var(--reached-offset-bottom)}[_nghost-%COMP%]     .scroll-reached-trigger-element[trigger=start]{width:var(--reached-offset-start)}[_nghost-%COMP%]     .scroll-reached-trigger-element[trigger=end]{width:var(--reached-offset-end)}[_nghost-%COMP%]   .scroll-dropped-trigger-element[_ngcontent-%COMP%]{background:#00f}[_nghost-%COMP%]   .scroll-dropped-trigger-element[trigger=top][_ngcontent-%COMP%], [_nghost-%COMP%]   .scroll-dropped-trigger-element[trigger=bottom][_ngcontent-%COMP%]{left:0;right:0}[_nghost-%COMP%]   .scroll-dropped-trigger-element[trigger=start][_ngcontent-%COMP%], [_nghost-%COMP%]   .scroll-dropped-trigger-element[trigger=end][_ngcontent-%COMP%]{top:0;bottom:0}[_nghost-%COMP%]   .scroll-dropped-trigger-element[trigger=top][_ngcontent-%COMP%]{top:0;height:var(--dropped-offset-top)}[_nghost-%COMP%]   .scroll-dropped-trigger-element[trigger=bottom][_ngcontent-%COMP%]{bottom:0;height:var(--dropped-offset-bottom)}[_nghost-%COMP%]   .scroll-dropped-trigger-element[trigger=start][_ngcontent-%COMP%]{width:var(--dropped-offset-start)}[_nghost-%COMP%]   .scroll-dropped-trigger-element[trigger=end][_ngcontent-%COMP%]{width:var(--dropped-offset-end)}[verticalUsed=true][_nghost-%COMP%]{--_timeline-scope: --scrollerY;--_animation-timeline-y: --scrollerY;--_viewport_scroll-timeline: --scrollerY y}[horizontalUsed=true][_nghost-%COMP%]{--_timeline-scope: --scrollerX;--_animation-timeline-x: --scrollerX;--_viewport_scroll-timeline: --scrollerX x}[verticalUsed=true][horizontalUsed=true][_nghost-%COMP%]{--_timeline-scope: --scrollerX, --scrollerY;--_viewport_scroll-timeline: --scrollerX x, --scrollerY y}[orientation=vertical][_nghost-%COMP%]{--_viewport-overflow: hidden auto;--_scrollbar-content-width: unset}[orientation=horizontal][_nghost-%COMP%]{--_viewport-overflow: auto hidden}[disableInteraction=true][_nghost-%COMP%]{--_viewport-pointer-events: none;--_scrollbar-pointer-events: none}[isVerticallyScrollable=false][_nghost-%COMP%]{--_vertical-thumb-display: none}[isHorizontallyScrollable=false][_nghost-%COMP%]{--_horizontal-thumb-display: none}[dragging=x][_nghost-%COMP%], [dragging=y][_nghost-%COMP%]{--_viewport-user-select: none}[dragging=x][_nghost-%COMP%]{--_track-x-thickness: calc(var(--INTERNAL-scrollbar-hover-thickness) * 1px);--_thumb-x-color: var(var(--INTERNAL-scrollbar-thumb-min-size))}[dragging=y][_nghost-%COMP%]{--_track-y-thickness: calc(var(--INTERNAL-scrollbar-hover-thickness) * 1px);--_thumb-y-color: var(var(--INTERNAL-scrollbar-thumb-min-size))}[mobile=true][_nghost-%COMP%]{--_viewport-overscroll-behavior: var(--INTERNAL-scrollbar-mobile-overscroll-behavior)}"],changeDetection:0});let e=t;return e})();var YT=(()=>{let t=class t{};t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=ys({type:t}),t.\u0275inj=bs({});let e=t;return e})();function Cie(e,t){if(e&1){let i=xe();S(0,"button",15),V("click",function(){let o=j(i).$implicit,r=I().$implicit;return I().onIconClick(o),K(r.close())}),H(1,"ng-icon",16),x()}if(e&2){let i=t.$implicit,n=I(2);U("variant",n.selectedIcon()===i?"default":"outline")("title",i),E(),U("name",i)}}function wie(e,t){e&1&&(S(0,"div",13),F(1),O(2,"transloco"),x()),e&2&&(E(),de(" ",N(2,1,"flexibleItems.iconPicker.noResults")," "))}function bie(e,t){if(e&1&&(S(0,"div",14)(1,"span"),F(2),O(3,"transloco"),x(),S(4,"code",17),F(5),x()()),e&2){let i=I(2);E(2),de("",N(3,2,"flexibleItems.iconPicker.selected"),":"),E(3),we(i.selectedIcon())}}function yie(e,t){if(e&1){let i=xe();S(0,"div",5)(1,"div",6)(2,"div",7)(3,"label",8),F(4),O(5,"transloco"),x(),S(6,"input",9),O(7,"transloco"),V("input",function(o){j(i);let r=I();return K(r.onSearchChange(o.target.value))}),x()(),S(8,"ng-scrollbar",10)(9,"div",11),ei(10,Cie,2,3,"button",12,x1),ve(12,wie,3,3,"div",13),x()(),ve(13,bie,6,4,"div",14),x()()}if(e&2){let i=I();E(4),we(N(5,5,"flexibleItems.iconPicker.searchLabel")),E(2),U("value",i.searchTerm())("placeholder",N(7,7,"flexibleItems.iconPicker.searchPlaceholder")),E(4),ti(i.filteredIcons()),E(2),Ce(i.filteredIcons().length===0?12:-1),E(),Ce(i.selectedIcon()?13:-1)}}var XT=(()=>{class e{selectedIcon=J("lucideBox");disabled=J(!1);allIcons=J(Object.keys(ac));searchTerm=J("");filteredIcons=L(()=>{let i=this.searchTerm().toLowerCase();return i?this.allIcons().filter(n=>n.toLowerCase().includes(i)):this.allIcons()});onIconClick(i){this.disabled()||(this.selectedIcon.set(i),this.onChange(i),this.onTouched())}onSearchChange(i){this.searchTerm.set(i)}onChange=()=>{};onTouched=()=>{};writeValue(i){i&&this.selectedIcon.set(i)}registerOnChange(i){this.onChange=i}registerOnTouched(i){this.onTouched=i}setDisabledState(i){this.disabled.set(i)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["gh-icon-picker"]],features:[ue([nt(ac),{provide:Dr,useExisting:Ei(()=>e),multi:!0}])],decls:5,vars:2,consts:[[3,"closeDelay"],["type","button","brnPopoverTrigger","","hlmBtn","","variant","outline",1,"h-16","w-16","rounded-full","p-0"],[1,"h-14","w-14","flex","items-center","justify-center"],["hlm","","hlmAvatarFallback","","size","sm",3,"name"],["hlmPopoverContent","","class","w-[400px] p-4",4,"brnPopoverContent"],["hlmPopoverContent","",1,"w-[400px]","p-4"],[1,"space-y-4"],[1,"space-y-2"],["hlmLabel","","for","icon-search"],["hlmInput","","id","icon-search","type","text",3,"input","value","placeholder"],["hlm","",1,"h-[300px]","w-full","rounded-md","border","p-2"],["scrollViewport","",1,"grid","grid-cols-6","gap-2"],["type","button","hlmBtn","","size","icon",1,"h-10","w-10",3,"variant","title"],[1,"col-span-full","text-center","py-4","text-muted-foreground","text-sm"],[1,"flex","items-center","gap-2","text-xs","text-muted-foreground","pt-2","border-t"],["type","button","hlmBtn","","size","icon",1,"h-10","w-10",3,"click","variant","title"],["hlm","","size","sm",3,"name"],[1,"text-xs","font-mono"]],template:function(n,o){n&1&&(S(0,"brn-popover",0)(1,"button",1)(2,"hlm-avatar",2),H(3,"ng-icon",3),x()(),Dt(4,yie,14,9,"div",4),x()),n&2&&(U("closeDelay",100),E(3),U("name",o.selectedIcon()))},dependencies:[Tr,Yt,Yy,Jy,Xy,Ny,By,Ze,We,ot,Pi,Ni,Qy,qb,YT,KT,zT,Kt],encapsulation:2,changeDetection:0})}return e})();function e1(e){let t=e.cloneNode(!0),i=t.querySelectorAll("[id]"),n=e.nodeName.toLowerCase();t.removeAttribute("id");for(let o=0;o<i.length;o++)i[o].removeAttribute("id");return n==="canvas"?ZT(e,t):(n==="input"||n==="select"||n==="textarea")&&QT(e,t),JT("canvas",e,t,ZT),JT("input, textarea, select",e,t,QT),t}function JT(e,t,i,n){let o=t.querySelectorAll(e);if(o.length){let r=i.querySelectorAll(e);for(let s=0;s<o.length;s++)n(o[s],r[s])}}var Sie=0;function QT(e,t){t.type!=="file"&&(t.value=e.value),t.type==="radio"&&t.name&&(t.name=`mat-clone-${t.name}-${Sie++}`)}function ZT(e,t){let i=t.getContext("2d");if(i)try{i.drawImage(e,0,0)}catch{}}function s1(e){let t=e.getBoundingClientRect();return{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height,x:t.x,y:t.y}}function t1(e,t,i){let{top:n,bottom:o,left:r,right:s}=e;return i>=n&&i<=o&&t>=r&&t<=s}function xie(e,t){let i=t.left<e.left,n=t.left+t.width>e.right,o=t.top<e.top,r=t.top+t.height>e.bottom;return i||n||o||r}function au(e,t,i){e.top+=t,e.bottom=e.top+e.height,e.left+=i,e.right=e.left+e.width}function e6(e,t,i,n){let{top:o,right:r,bottom:s,left:a,width:l,height:c}=e,d=l*t,u=c*t;return n>o-u&&n<s+u&&i>a-d&&i<r+d}var If=class{_document;positions=new Map;constructor(t){this._document=t}clear(){this.positions.clear()}cache(t){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),t.forEach(i=>{this.positions.set(i,{scrollPosition:{top:i.scrollTop,left:i.scrollLeft},clientRect:s1(i)})})}handleScroll(t){let i=lc(t),n=this.positions.get(i);if(!n)return null;let o=n.scrollPosition,r,s;if(i===this._document){let c=this.getViewportScrollPosition();r=c.top,s=c.left}else r=i.scrollTop,s=i.scrollLeft;let a=o.top-r,l=o.left-s;return this.positions.forEach((c,d)=>{c.clientRect&&i!==d&&i.contains(d)&&au(c.clientRect,a,l)}),o.top=r,o.left=s,{top:a,left:l}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}};function p6(e,t){let i=e.rootNodes;if(i.length===1&&i[0].nodeType===t.ELEMENT_NODE)return i[0];let n=t.createElement("div");return i.forEach(o=>n.appendChild(o)),n}function a1(e,t,i){for(let n in t)if(t.hasOwnProperty(n)){let o=t[n];o?e.setProperty(n,o,i?.has(n)?"important":""):e.removeProperty(n)}return e}function Xl(e,t){let i=t?"":"none";a1(e.style,{"touch-action":t?"":"none","-webkit-user-drag":t?"":"none","-webkit-tap-highlight-color":t?"":"transparent","user-select":i,"-ms-user-select":i,"-webkit-user-select":i,"-moz-user-select":i})}function t6(e,t,i){a1(e.style,{position:t?"":"fixed",top:t?"":"0",opacity:t?"":"0",left:t?"":"-999em"},i)}function Af(e,t){return t&&t!="none"?e+" "+t:e}function i6(e,t){e.style.width=`${t.width}px`,e.style.height=`${t.height}px`,e.style.transform=lu(t.left,t.top)}function lu(e,t){return`translate3d(${Math.round(e)}px, ${Math.round(t)}px, 0)`}function n6(e){let t=e.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(e)*t}function Eie(e){let t=getComputedStyle(e),i=Qb(t,"transition-property"),n=i.find(a=>a==="transform"||a==="all");if(!n)return 0;let o=i.indexOf(n),r=Qb(t,"transition-duration"),s=Qb(t,"transition-delay");return n6(r[o])+n6(s[o])}function Qb(e,t){return e.getPropertyValue(t).split(",").map(n=>n.trim())}var _ie=new Set(["position"]),i1=class{_document;_rootElement;_direction;_initialDomRect;_previewTemplate;_previewClass;_pickupPositionOnPage;_initialTransform;_zIndex;_renderer;_previewEmbeddedView;_preview;get element(){return this._preview}constructor(t,i,n,o,r,s,a,l,c,d){this._document=t,this._rootElement=i,this._direction=n,this._initialDomRect=o,this._previewTemplate=r,this._previewClass=s,this._pickupPositionOnPage=a,this._initialTransform=l,this._zIndex=c,this._renderer=d}attach(t){this._preview=this._createPreview(),t.appendChild(this._preview),o6(this._preview)&&this._preview.showPopover()}destroy(){this._preview.remove(),this._previewEmbeddedView?.destroy(),this._preview=this._previewEmbeddedView=null}setTransform(t){this._preview.style.transform=t}getBoundingClientRect(){return this._preview.getBoundingClientRect()}addClass(t){this._preview.classList.add(t)}getTransitionDuration(){return Eie(this._preview)}addEventListener(t,i){return this._renderer.listen(this._preview,t,i)}_createPreview(){let t=this._previewTemplate,i=this._previewClass,n=t?t.template:null,o;if(n&&t){let r=t.matchSize?this._initialDomRect:null,s=t.viewContainer.createEmbeddedView(n,t.context);s.detectChanges(),o=p6(s,this._document),this._previewEmbeddedView=s,t.matchSize?i6(o,r):o.style.transform=lu(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else o=e1(this._rootElement),i6(o,this._initialDomRect),this._initialTransform&&(o.style.transform=this._initialTransform);return a1(o.style,{"pointer-events":"none",margin:o6(o)?"0 auto 0 0":"0",position:"fixed",top:"0",left:"0","z-index":this._zIndex+""},_ie),Xl(o,!1),o.classList.add("cdk-drag-preview"),o.setAttribute("popover","manual"),o.setAttribute("dir",this._direction),i&&(Array.isArray(i)?i.forEach(r=>o.classList.add(r)):o.classList.add(i)),o}};function o6(e){return"showPopover"in e}var Rie={passive:!0},r6={passive:!1},Pie={passive:!1,capture:!0},Die=800,s6="cdk-drag-placeholder",a6=new Set(["position"]),n1=class{_config;_document;_ngZone;_viewportRuler;_dragDropRegistry;_renderer;_rootElementCleanups;_cleanupShadowRootSelectStart;_preview;_previewContainer;_placeholderRef;_placeholder;_pickupPositionInElement;_pickupPositionOnPage;_marker;_anchor=null;_passiveTransform={x:0,y:0};_activeTransform={x:0,y:0};_initialTransform;_hasStartedDragging=J(!1);_hasMoved;_initialContainer;_initialIndex;_parentPositions;_moveEvents=new qe;_pointerDirectionDelta;_pointerPositionAtLastDirectionChange;_lastKnownPointerPosition;_rootElement;_ownerSVGElement;_rootElementTapHighlight;_pointerMoveSubscription=xa.EMPTY;_pointerUpSubscription=xa.EMPTY;_scrollSubscription=xa.EMPTY;_resizeSubscription=xa.EMPTY;_lastTouchEventTime;_dragStartTime;_boundaryElement=null;_nativeInteractionsEnabled=!0;_initialDomRect;_previewRect;_boundaryRect;_previewTemplate;_placeholderTemplate;_handles=[];_disabledHandles=new Set;_dropContainer;_direction="ltr";_parentDragRef;_cachedShadowRoot;lockAxis=null;dragStartDelay=0;previewClass;scale=1;get disabled(){return this._disabled||!!(this._dropContainer&&this._dropContainer.disabled)}set disabled(t){t!==this._disabled&&(this._disabled=t,this._toggleNativeDragInteractions(),this._handles.forEach(i=>Xl(i,t)))}_disabled=!1;beforeStarted=new qe;started=new qe;released=new qe;ended=new qe;entered=new qe;exited=new qe;dropped=new qe;moved=this._moveEvents;data;constrainPosition;constructor(t,i,n,o,r,s,a){this._config=i,this._document=n,this._ngZone=o,this._viewportRuler=r,this._dragDropRegistry=s,this._renderer=a,this.withRootElement(t).withParent(i.parentDragRef||null),this._parentPositions=new If(n),s.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(t){this._handles=t.map(n=>An(n)),this._handles.forEach(n=>Xl(n,this.disabled)),this._toggleNativeDragInteractions();let i=new Set;return this._disabledHandles.forEach(n=>{this._handles.indexOf(n)>-1&&i.add(n)}),this._disabledHandles=i,this}withPreviewTemplate(t){return this._previewTemplate=t,this}withPlaceholderTemplate(t){return this._placeholderTemplate=t,this}withRootElement(t){let i=An(t);if(i!==this._rootElement){this._removeRootElementListeners();let n=this._renderer;this._rootElementCleanups=this._ngZone.runOutsideAngular(()=>[n.listen(i,"mousedown",this._pointerDown,r6),n.listen(i,"touchstart",this._pointerDown,Rie),n.listen(i,"dragstart",this._nativeDragStart,r6)]),this._initialTransform=void 0,this._rootElement=i}return typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(t){return this._boundaryElement=t?An(t):null,this._resizeSubscription.unsubscribe(),t&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(t){return this._parentDragRef=t,this}dispose(){this._removeRootElementListeners(),this.isDragging()&&this._rootElement?.remove(),this._marker?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeListeners(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._marker=this._parentDragRef=null}isDragging(){return this._hasStartedDragging()&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}resetToBoundary(){if(this._boundaryElement&&this._rootElement&&xie(this._boundaryElement.getBoundingClientRect(),this._rootElement.getBoundingClientRect())){let t=this._boundaryElement.getBoundingClientRect(),i=this._rootElement.getBoundingClientRect(),n=0,o=0;i.left<t.left?n=t.left-i.left:i.right>t.right&&(n=t.right-i.right),i.top<t.top?o=t.top-i.top:i.bottom>t.bottom&&(o=t.bottom-i.bottom);let r=this._activeTransform.x,s=this._activeTransform.y,a=r+n,l=s+o;this._rootElement.style.transform=lu(a,l),this._activeTransform={x:a,y:l},this._passiveTransform={x:a,y:l}}}disableHandle(t){!this._disabledHandles.has(t)&&this._handles.indexOf(t)>-1&&(this._disabledHandles.add(t),Xl(t,!0))}enableHandle(t){this._disabledHandles.has(t)&&(this._disabledHandles.delete(t),Xl(t,this.disabled))}withDirection(t){return this._direction=t,this}_withDropContainer(t){this._dropContainer=t}getFreeDragPosition(){let t=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:t.x,y:t.y}}setFreeDragPosition(t){return this._activeTransform={x:0,y:0},this._passiveTransform.x=t.x,this._passiveTransform.y=t.y,this._dropContainer||this._applyRootElementTransform(t.x,t.y),this}withPreviewContainer(t){return this._previewContainer=t,this}_sortFromLastPointerPosition(){let t=this._lastKnownPointerPosition;t&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(t),t)}_removeListeners(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe(),this._cleanupShadowRootSelectStart?.(),this._cleanupShadowRootSelectStart=void 0}_destroyPreview(){this._preview?.destroy(),this._preview=null}_destroyPlaceholder(){this._anchor?.remove(),this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._anchor=this._placeholderRef=null}_pointerDown=t=>{if(this.beforeStarted.next(),this._handles.length){let i=this._getTargetHandle(t);i&&!this._disabledHandles.has(i)&&!this.disabled&&this._initializeDragSequence(i,t)}else this.disabled||this._initializeDragSequence(this._rootElement,t)};_pointerMove=t=>{let i=this._getPointerPositionOnPage(t);if(!this._hasStartedDragging()){let o=Math.abs(i.x-this._pickupPositionOnPage.x),r=Math.abs(i.y-this._pickupPositionOnPage.y);if(o+r>=this._config.dragStartThreshold){let a=Date.now()>=this._dragStartTime+this._getDragStartDelay(t),l=this._dropContainer;if(!a){this._endDragSequence(t);return}(!l||!l.isDragging()&&!l.isReceiving())&&(t.cancelable&&t.preventDefault(),this._hasStartedDragging.set(!0),this._ngZone.run(()=>this._startDragSequence(t)))}return}t.cancelable&&t.preventDefault();let n=this._getConstrainedPointerPosition(i);if(this._hasMoved=!0,this._lastKnownPointerPosition=i,this._updatePointerDirectionDelta(n),this._dropContainer)this._updateActiveDropContainer(n,i);else{let o=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,r=this._activeTransform;r.x=n.x-o.x+this._passiveTransform.x,r.y=n.y-o.y+this._passiveTransform.y,this._applyRootElementTransform(r.x,r.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:n,event:t,distance:this._getDragDistance(n),delta:this._pointerDirectionDelta})})};_pointerUp=t=>{this._endDragSequence(t)};_endDragSequence(t){if(this._dragDropRegistry.isDragging(this)&&(this._removeListeners(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),!!this._hasStartedDragging()))if(this.released.next({source:this,event:t}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(t),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;let i=this._getPointerPositionOnPage(t);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(i),dropPoint:i,event:t})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(t){ru(t)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();let i=this._getShadowRoot(),n=this._dropContainer;if(i&&this._ngZone.runOutsideAngular(()=>{this._cleanupShadowRootSelectStart=this._renderer.listen(i,"selectstart",Mie,Pie)}),n){let o=this._rootElement,r=o.parentNode,s=this._placeholder=this._createPlaceholderElement(),a=this._marker=this._marker||this._document.createComment("");r.insertBefore(a,o),this._initialTransform=o.style.transform||"",this._preview=new i1(this._document,this._rootElement,this._direction,this._initialDomRect,this._previewTemplate||null,this.previewClass||null,this._pickupPositionOnPage,this._initialTransform,this._config.zIndex||1e3,this._renderer),this._preview.attach(this._getPreviewInsertionPoint(r,i)),t6(o,!1,a6),this._document.body.appendChild(r.replaceChild(s,o)),this.started.next({source:this,event:t}),n.start(),this._initialContainer=n,this._initialIndex=n.getItemIndex(this)}else this.started.next({source:this,event:t}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(n?n.getScrollableParents():[])}_initializeDragSequence(t,i){this._parentDragRef&&i.stopPropagation();let n=this.isDragging(),o=ru(i),r=!o&&i.button!==0,s=this._rootElement,a=lc(i),l=!o&&this._lastTouchEventTime&&this._lastTouchEventTime+Die>Date.now(),c=o?Ey(i):xy(i);if(a&&a.draggable&&i.type==="mousedown"&&i.preventDefault(),n||r||l||c)return;if(this._handles.length){let h=s.style;this._rootElementTapHighlight=h.webkitTapHighlightColor||"",h.webkitTapHighlightColor="transparent"}this._hasMoved=!1,this._hasStartedDragging.set(this._hasMoved),this._removeListeners(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(h=>this._updateOnScroll(h)),this._boundaryElement&&(this._boundaryRect=s1(this._boundaryElement));let d=this._previewTemplate;this._pickupPositionInElement=d&&d.template&&!d.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,t,i);let u=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(i);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:u.x,y:u.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,i)}_cleanupDragArtifacts(t){t6(this._rootElement,!0,a6),this._marker.parentNode.replaceChild(this._rootElement,this._marker),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{let i=this._dropContainer,n=i.getItemIndex(this),o=this._getPointerPositionOnPage(t),r=this._getDragDistance(o),s=i._isOverContainer(o.x,o.y);this.ended.next({source:this,distance:r,dropPoint:o,event:t}),this.dropped.next({item:this,currentIndex:n,previousIndex:this._initialIndex,container:i,previousContainer:this._initialContainer,isPointerOverContainer:s,distance:r,dropPoint:o,event:t}),i.drop(this,n,this._initialIndex,this._initialContainer,s,r,o,t),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:t,y:i},{x:n,y:o}){let r=this._initialContainer._getSiblingContainerFromPosition(this,t,i);!r&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(t,i)&&(r=this._initialContainer),r&&r!==this._dropContainer&&this._ngZone.run(()=>{let s=this._dropContainer.getItemIndex(this),a=this._dropContainer.getItemAtIndex(s+1)?.getVisibleElement()||null;this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._conditionallyInsertAnchor(r,this._dropContainer,a),this._dropContainer=r,this._dropContainer.enter(this,t,i,r===this._initialContainer&&r.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:r,currentIndex:r.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(n,o),this._dropContainer._sortItem(this,t,i,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(t,i):this._applyPreviewTransform(t-this._pickupPositionInElement.x,i-this._pickupPositionInElement.y))}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();let t=this._placeholder.getBoundingClientRect();this._preview.addClass("cdk-drag-animating"),this._applyPreviewTransform(t.left,t.top);let i=this._preview.getTransitionDuration();return i===0?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(n=>{let o=a=>{(!a||this._preview&&lc(a)===this._preview.element&&a.propertyName==="transform")&&(s(),n(),clearTimeout(r))},r=setTimeout(o,i*1.5),s=this._preview.addEventListener("transitionend",o)}))}_createPlaceholderElement(){let t=this._placeholderTemplate,i=t?t.template:null,n;return i?(this._placeholderRef=t.viewContainer.createEmbeddedView(i,t.context),this._placeholderRef.detectChanges(),n=p6(this._placeholderRef,this._document)):n=e1(this._rootElement),n.style.pointerEvents="none",n.classList.add(s6),n}_getPointerPositionInElement(t,i,n){let o=i===this._rootElement?null:i,r=o?o.getBoundingClientRect():t,s=ru(n)?n.targetTouches[0]:n,a=this._getViewportScrollPosition(),l=s.pageX-r.left-a.left,c=s.pageY-r.top-a.top;return{x:r.left-t.left+l,y:r.top-t.top+c}}_getPointerPositionOnPage(t){let i=this._getViewportScrollPosition(),n=ru(t)?t.touches[0]||t.changedTouches[0]||{pageX:0,pageY:0}:t,o=n.pageX-i.left,r=n.pageY-i.top;if(this._ownerSVGElement){let s=this._ownerSVGElement.getScreenCTM();if(s){let a=this._ownerSVGElement.createSVGPoint();return a.x=o,a.y=r,a.matrixTransform(s.inverse())}}return{x:o,y:r}}_getConstrainedPointerPosition(t){let i=this._dropContainer?this._dropContainer.lockAxis:null,{x:n,y:o}=this.constrainPosition?this.constrainPosition(t,this,this._initialDomRect,this._pickupPositionInElement):t;if(this.lockAxis==="x"||i==="x"?o=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):(this.lockAxis==="y"||i==="y")&&(n=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){let{x:r,y:s}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,a=this._boundaryRect,{width:l,height:c}=this._getPreviewRect(),d=a.top+s,u=a.bottom-(c-s),h=a.left+r,p=a.right-(l-r);n=l6(n,h,p),o=l6(o,d,u)}return{x:n,y:o}}_updatePointerDirectionDelta(t){let{x:i,y:n}=t,o=this._pointerDirectionDelta,r=this._pointerPositionAtLastDirectionChange,s=Math.abs(i-r.x),a=Math.abs(n-r.y);return s>this._config.pointerDirectionChangeThreshold&&(o.x=i>r.x?1:-1,r.x=i),a>this._config.pointerDirectionChangeThreshold&&(o.y=n>r.y?1:-1,r.y=n),o}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;let t=this._handles.length>0||!this.isDragging();t!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=t,Xl(this._rootElement,t))}_removeRootElementListeners(){this._rootElementCleanups?.forEach(t=>t()),this._rootElementCleanups=void 0}_applyRootElementTransform(t,i){let n=1/this.scale,o=lu(t*n,i*n),r=this._rootElement.style;this._initialTransform==null&&(this._initialTransform=r.transform&&r.transform!="none"?r.transform:""),r.transform=Af(o,this._initialTransform)}_applyPreviewTransform(t,i){let n=this._previewTemplate?.template?void 0:this._initialTransform,o=lu(t,i);this._preview.setTransform(Af(o,n))}_getDragDistance(t){let i=this._pickupPositionOnPage;return i?{x:t.x-i.x,y:t.y-i.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:t,y:i}=this._passiveTransform;if(t===0&&i===0||this.isDragging()||!this._boundaryElement)return;let n=this._rootElement.getBoundingClientRect(),o=this._boundaryElement.getBoundingClientRect();if(o.width===0&&o.height===0||n.width===0&&n.height===0)return;let r=o.left-n.left,s=n.right-o.right,a=o.top-n.top,l=n.bottom-o.bottom;o.width>n.width?(r>0&&(t+=r),s>0&&(t-=s)):t=0,o.height>n.height?(a>0&&(i+=a),l>0&&(i-=l)):i=0,(t!==this._passiveTransform.x||i!==this._passiveTransform.y)&&this.setFreeDragPosition({y:i,x:t})}_getDragStartDelay(t){let i=this.dragStartDelay;return typeof i=="number"?i:ru(t)?i.touch:i?i.mouse:0}_updateOnScroll(t){let i=this._parentPositions.handleScroll(t);if(i){let n=lc(t);this._boundaryRect&&n!==this._boundaryElement&&n.contains(this._boundaryElement)&&au(this._boundaryRect,i.top,i.left),this._pickupPositionOnPage.x+=i.left,this._pickupPositionOnPage.y+=i.top,this._dropContainer||(this._activeTransform.x-=i.left,this._activeTransform.y-=i.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return this._cachedShadowRoot===void 0&&(this._cachedShadowRoot=wu(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(t,i){let n=this._previewContainer||"global";if(n==="parent")return t;if(n==="global"){let o=this._document;return i||o.fullscreenElement||o.webkitFullscreenElement||o.mozFullScreenElement||o.msFullscreenElement||o.body}return An(n)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_nativeDragStart=t=>{if(this._handles.length){let i=this._getTargetHandle(t);i&&!this._disabledHandles.has(i)&&!this.disabled&&t.preventDefault()}else this.disabled||t.preventDefault()};_getTargetHandle(t){return this._handles.find(i=>t.target&&(t.target===i||i.contains(t.target)))}_conditionallyInsertAnchor(t,i,n){if(t===this._initialContainer)this._anchor?.remove(),this._anchor=null;else if(i===this._initialContainer&&i.hasAnchor){let o=this._anchor??=e1(this._placeholder);o.classList.remove(s6),o.classList.add("cdk-drag-anchor"),o.style.transform="",n?n.before(o):An(i.element).appendChild(o)}}};function l6(e,t,i){return Math.max(t,Math.min(i,e))}function ru(e){return e.type[0]==="t"}function Mie(e){e.preventDefault()}function Of(e,t,i){let n=c6(t,e.length-1),o=c6(i,e.length-1);if(n===o)return;let r=e[n],s=o<n?-1:1;for(let a=n;a!==o;a+=s)e[a]=e[a+s];e[o]=r}function c6(e,t){return Math.max(0,Math.min(t,e))}var Lf=class{_dragDropRegistry;_element;_sortPredicate;_itemPositions=[];_activeDraggables;orientation="vertical";direction;constructor(t){this._dragDropRegistry=t}_previousSwap={drag:null,delta:0,overlaps:!1};start(t){this.withItems(t)}sort(t,i,n,o){let r=this._itemPositions,s=this._getItemIndexFromPointerPosition(t,i,n,o);if(s===-1&&r.length>0)return null;let a=this.orientation==="horizontal",l=r.findIndex(m=>m.drag===t),c=r[s],d=r[l].clientRect,u=c.clientRect,h=l>s?1:-1,p=this._getItemOffsetPx(d,u,h),g=this._getSiblingOffsetPx(l,r,h),f=r.slice();return Of(r,l,s),r.forEach((m,v)=>{if(f[v]===m)return;let C=m.drag===t,w=C?p:g,y=C?t.getPlaceholderElement():m.drag.getRootElement();m.offset+=w;let _=Math.round(m.offset*(1/m.drag.scale));a?(y.style.transform=Af(`translate3d(${_}px, 0, 0)`,m.initialTransform),au(m.clientRect,0,w)):(y.style.transform=Af(`translate3d(0, ${_}px, 0)`,m.initialTransform),au(m.clientRect,w,0))}),this._previousSwap.overlaps=t1(u,i,n),this._previousSwap.drag=c.drag,this._previousSwap.delta=a?o.x:o.y,{previousIndex:l,currentIndex:s}}enter(t,i,n,o){let r=o==null||o<0?this._getItemIndexFromPointerPosition(t,i,n):o,s=this._activeDraggables,a=s.indexOf(t),l=t.getPlaceholderElement(),c=s[r];if(c===t&&(c=s[r+1]),!c&&(r==null||r===-1||r<s.length-1)&&this._shouldEnterAsFirstChild(i,n)&&(c=s[0]),a>-1&&s.splice(a,1),c&&!this._dragDropRegistry.isDragging(c)){let d=c.getRootElement();d.parentElement.insertBefore(l,d),s.splice(r,0,t)}else this._element.appendChild(l),s.push(t);l.style.transform="",this._cacheItemPositions()}withItems(t){this._activeDraggables=t.slice(),this._cacheItemPositions()}withSortPredicate(t){this._sortPredicate=t}reset(){this._activeDraggables?.forEach(t=>{let i=t.getRootElement();if(i){let n=this._itemPositions.find(o=>o.drag===t)?.initialTransform;i.style.transform=n||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(t){return this._getVisualItemPositions().findIndex(i=>i.drag===t)}getItemAtIndex(t){return this._getVisualItemPositions()[t]?.drag||null}updateOnScroll(t,i){this._itemPositions.forEach(({clientRect:n})=>{au(n,t,i)}),this._itemPositions.forEach(({drag:n})=>{this._dragDropRegistry.isDragging(n)&&n._sortFromLastPointerPosition()})}withElementContainer(t){this._element=t}_cacheItemPositions(){let t=this.orientation==="horizontal";this._itemPositions=this._activeDraggables.map(i=>{let n=i.getVisibleElement();return{drag:i,offset:0,initialTransform:n.style.transform||"",clientRect:s1(n)}}).sort((i,n)=>t?i.clientRect.left-n.clientRect.left:i.clientRect.top-n.clientRect.top)}_getVisualItemPositions(){return this.orientation==="horizontal"&&this.direction==="rtl"?this._itemPositions.slice().reverse():this._itemPositions}_getItemOffsetPx(t,i,n){let o=this.orientation==="horizontal",r=o?i.left-t.left:i.top-t.top;return n===-1&&(r+=o?i.width-t.width:i.height-t.height),r}_getSiblingOffsetPx(t,i,n){let o=this.orientation==="horizontal",r=i[t].clientRect,s=i[t+n*-1],a=r[o?"width":"height"]*n;if(s){let l=o?"left":"top",c=o?"right":"bottom";n===-1?a-=s.clientRect[l]-r[c]:a+=r[l]-s.clientRect[c]}return a}_shouldEnterAsFirstChild(t,i){if(!this._activeDraggables.length)return!1;let n=this._itemPositions,o=this.orientation==="horizontal";if(n[0].drag!==this._activeDraggables[0]){let s=n[n.length-1].clientRect;return o?t>=s.right:i>=s.bottom}else{let s=n[0].clientRect;return o?t<=s.left:i<=s.top}}_getItemIndexFromPointerPosition(t,i,n,o){let r=this.orientation==="horizontal",s=this._itemPositions.findIndex(({drag:a,clientRect:l})=>{if(a===t)return!1;if(o){let c=r?o.x:o.y;if(a===this._previousSwap.drag&&this._previousSwap.overlaps&&c===this._previousSwap.delta)return!1}return r?i>=Math.floor(l.left)&&i<Math.floor(l.right):n>=Math.floor(l.top)&&n<Math.floor(l.bottom)});return s===-1||!this._sortPredicate(s,t)?-1:s}},o1=class{_document;_dragDropRegistry;_element;_sortPredicate;_rootNode;_activeItems;_previousSwap={drag:null,deltaX:0,deltaY:0,overlaps:!1};_relatedNodes=[];constructor(t,i){this._document=t,this._dragDropRegistry=i}start(t){let i=this._element.childNodes;this._relatedNodes=[];for(let n=0;n<i.length;n++){let o=i[n];this._relatedNodes.push([o,o.nextSibling])}this.withItems(t)}sort(t,i,n,o){let r=this._getItemIndexFromPointerPosition(t,i,n),s=this._previousSwap;if(r===-1||this._activeItems[r]===t)return null;let a=this._activeItems[r];if(s.drag===a&&s.overlaps&&s.deltaX===o.x&&s.deltaY===o.y)return null;let l=this.getItemIndex(t),c=t.getPlaceholderElement(),d=a.getRootElement();r>l?d.after(c):d.before(c),Of(this._activeItems,l,r);let u=this._getRootNode().elementFromPoint(i,n);return s.deltaX=o.x,s.deltaY=o.y,s.drag=a,s.overlaps=d===u||d.contains(u),{previousIndex:l,currentIndex:r}}enter(t,i,n,o){let r=this._activeItems.indexOf(t);r>-1&&this._activeItems.splice(r,1);let s=o==null||o<0?this._getItemIndexFromPointerPosition(t,i,n):o;s===-1&&(s=this._getClosestItemIndexToPointer(t,i,n));let a=this._activeItems[s];a&&!this._dragDropRegistry.isDragging(a)?(this._activeItems.splice(s,0,t),a.getRootElement().before(t.getPlaceholderElement())):(this._activeItems.push(t),this._element.appendChild(t.getPlaceholderElement()))}withItems(t){this._activeItems=t.slice()}withSortPredicate(t){this._sortPredicate=t}reset(){let t=this._element,i=this._previousSwap;for(let n=this._relatedNodes.length-1;n>-1;n--){let[o,r]=this._relatedNodes[n];o.parentNode===t&&o.nextSibling!==r&&(r===null?t.appendChild(o):r.parentNode===t&&t.insertBefore(o,r))}this._relatedNodes=[],this._activeItems=[],i.drag=null,i.deltaX=i.deltaY=0,i.overlaps=!1}getActiveItemsSnapshot(){return this._activeItems}getItemIndex(t){return this._activeItems.indexOf(t)}getItemAtIndex(t){return this._activeItems[t]||null}updateOnScroll(){this._activeItems.forEach(t=>{this._dragDropRegistry.isDragging(t)&&t._sortFromLastPointerPosition()})}withElementContainer(t){t!==this._element&&(this._element=t,this._rootNode=void 0)}_getItemIndexFromPointerPosition(t,i,n){let o=this._getRootNode().elementFromPoint(Math.floor(i),Math.floor(n)),r=o?this._activeItems.findIndex(s=>{let a=s.getRootElement();return o===a||a.contains(o)}):-1;return r===-1||!this._sortPredicate(r,t)?-1:r}_getRootNode(){return this._rootNode||(this._rootNode=wu(this._element)||this._document),this._rootNode}_getClosestItemIndexToPointer(t,i,n){if(this._activeItems.length===0)return-1;if(this._activeItems.length===1)return 0;let o=1/0,r=-1;for(let s=0;s<this._activeItems.length;s++){let a=this._activeItems[s];if(a!==t){let{x:l,y:c}=a.getRootElement().getBoundingClientRect(),d=Math.hypot(i-l,n-c);d<o&&(o=d,r=s)}}return r}},d6=.05,g6=.05,_n=(function(e){return e[e.NONE=0]="NONE",e[e.UP=1]="UP",e[e.DOWN=2]="DOWN",e})(_n||{}),Ii=(function(e){return e[e.NONE=0]="NONE",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e})(Ii||{}),r1=class{_dragDropRegistry;_ngZone;_viewportRuler;element;disabled=!1;sortingDisabled=!1;lockAxis=null;autoScrollDisabled=!1;autoScrollStep=2;hasAnchor=!1;enterPredicate=()=>!0;sortPredicate=()=>!0;beforeStarted=new qe;entered=new qe;exited=new qe;dropped=new qe;sorted=new qe;receivingStarted=new qe;receivingStopped=new qe;data;_container;_isDragging=!1;_parentPositions;_sortStrategy;_domRect;_draggables=[];_siblings=[];_activeSiblings=new Set;_viewportScrollSubscription=xa.EMPTY;_verticalScrollDirection=_n.NONE;_horizontalScrollDirection=Ii.NONE;_scrollNode;_stopScrollTimers=new qe;_cachedShadowRoot=null;_document;_scrollableElements=[];_initialScrollSnap;_direction="ltr";constructor(t,i,n,o,r){this._dragDropRegistry=i,this._ngZone=o,this._viewportRuler=r;let s=this.element=An(t);this._document=n,this.withOrientation("vertical").withElementContainer(s),i.registerDropContainer(this),this._parentPositions=new If(n)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(t,i,n,o){this._draggingStarted(),o==null&&this.sortingDisabled&&(o=this._draggables.indexOf(t)),this._sortStrategy.enter(t,i,n,o),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:t,container:this,currentIndex:this.getItemIndex(t)})}exit(t){this._reset(),this.exited.next({item:t,container:this})}drop(t,i,n,o,r,s,a,l={}){this._reset(),this.dropped.next({item:t,currentIndex:i,previousIndex:n,container:this,previousContainer:o,isPointerOverContainer:r,distance:s,dropPoint:a,event:l})}withItems(t){let i=this._draggables;return this._draggables=t,t.forEach(n=>n._withDropContainer(this)),this.isDragging()&&(i.filter(o=>o.isDragging()).every(o=>t.indexOf(o)===-1)?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(t){return this._direction=t,this._sortStrategy instanceof Lf&&(this._sortStrategy.direction=t),this}connectedTo(t){return this._siblings=t.slice(),this}withOrientation(t){if(t==="mixed")this._sortStrategy=new o1(this._document,this._dragDropRegistry);else{let i=new Lf(this._dragDropRegistry);i.direction=this._direction,i.orientation=t,this._sortStrategy=i}return this._sortStrategy.withElementContainer(this._container),this._sortStrategy.withSortPredicate((i,n)=>this.sortPredicate(i,n,this)),this}withScrollableParents(t){let i=this._container;return this._scrollableElements=t.indexOf(i)===-1?[i,...t]:t.slice(),this}withElementContainer(t){if(t===this._container)return this;let i=An(this.element),n=this._scrollableElements.indexOf(this._container),o=this._scrollableElements.indexOf(t);return n>-1&&this._scrollableElements.splice(n,1),o>-1&&this._scrollableElements.splice(o,1),this._sortStrategy&&this._sortStrategy.withElementContainer(t),this._cachedShadowRoot=null,this._scrollableElements.unshift(t),this._container=t,this}getScrollableParents(){return this._scrollableElements}getItemIndex(t){return this._isDragging?this._sortStrategy.getItemIndex(t):this._draggables.indexOf(t)}getItemAtIndex(t){return this._isDragging?this._sortStrategy.getItemAtIndex(t):this._draggables[t]||null}isReceiving(){return this._activeSiblings.size>0}_sortItem(t,i,n,o){if(this.sortingDisabled||!this._domRect||!e6(this._domRect,d6,i,n))return;let r=this._sortStrategy.sort(t,i,n,o);r&&this.sorted.next({previousIndex:r.previousIndex,currentIndex:r.currentIndex,container:this,item:t})}_startScrollingIfNecessary(t,i){if(this.autoScrollDisabled)return;let n,o=_n.NONE,r=Ii.NONE;if(this._parentPositions.positions.forEach((s,a)=>{a===this._document||!s.clientRect||n||e6(s.clientRect,d6,t,i)&&([o,r]=kie(a,s.clientRect,this._direction,t,i),(o||r)&&(n=a))}),!o&&!r){let{width:s,height:a}=this._viewportRuler.getViewportSize(),l={width:s,height:a,top:0,right:s,bottom:a,left:0};o=f6(l,i),r=m6(l,t),n=window}n&&(o!==this._verticalScrollDirection||r!==this._horizontalScrollDirection||n!==this._scrollNode)&&(this._verticalScrollDirection=o,this._horizontalScrollDirection=r,this._scrollNode=n,(o||r)&&n?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){let t=this._container.style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=t.msScrollSnapType||t.scrollSnapType||"",t.scrollSnapType=t.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(this._container).clientRect}_reset(){this._isDragging=!1;let t=this._container.style;t.scrollSnapType=t.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(i=>i._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_startScrollInterval=()=>{this._stopScrolling(),ws(0,du).pipe(lt(this._stopScrollTimers)).subscribe(()=>{let t=this._scrollNode,i=this.autoScrollStep;this._verticalScrollDirection===_n.UP?t.scrollBy(0,-i):this._verticalScrollDirection===_n.DOWN&&t.scrollBy(0,i),this._horizontalScrollDirection===Ii.LEFT?t.scrollBy(-i,0):this._horizontalScrollDirection===Ii.RIGHT&&t.scrollBy(i,0)})};_isOverContainer(t,i){return this._domRect!=null&&t1(this._domRect,t,i)}_getSiblingContainerFromPosition(t,i,n){return this._siblings.find(o=>o._canReceive(t,i,n))}_canReceive(t,i,n){if(!this._domRect||!t1(this._domRect,i,n)||!this.enterPredicate(t,this))return!1;let o=this._getShadowRoot().elementFromPoint(i,n);return o?o===this._container||this._container.contains(o):!1}_startReceiving(t,i){let n=this._activeSiblings;!n.has(t)&&i.every(o=>this.enterPredicate(o,this)||this._draggables.indexOf(o)>-1)&&(n.add(t),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:t,receiver:this,items:i}))}_stopReceiving(t){this._activeSiblings.delete(t),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:t,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(t=>{if(this.isDragging()){let i=this._parentPositions.handleScroll(t);i&&this._sortStrategy.updateOnScroll(i.top,i.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){let t=wu(this._container);this._cachedShadowRoot=t||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){let t=this._sortStrategy.getActiveItemsSnapshot().filter(i=>i.isDragging());this._siblings.forEach(i=>i._startReceiving(this,t))}};function f6(e,t){let{top:i,bottom:n,height:o}=e,r=o*g6;return t>=i-r&&t<=i+r?_n.UP:t>=n-r&&t<=n+r?_n.DOWN:_n.NONE}function m6(e,t){let{left:i,right:n,width:o}=e,r=o*g6;return t>=i-r&&t<=i+r?Ii.LEFT:t>=n-r&&t<=n+r?Ii.RIGHT:Ii.NONE}function kie(e,t,i,n,o){let r=f6(t,o),s=m6(t,n),a=_n.NONE,l=Ii.NONE;if(r){let c=e.scrollTop;r===_n.UP?c>0&&(a=_n.UP):e.scrollHeight-c>e.clientHeight&&(a=_n.DOWN)}if(s){let c=e.scrollLeft;i==="rtl"?s===Ii.RIGHT?c<0&&(l=Ii.RIGHT):e.scrollWidth+c>e.clientWidth&&(l=Ii.LEFT):s===Ii.LEFT?c>0&&(l=Ii.LEFT):e.scrollWidth-c>e.clientWidth&&(l=Ii.RIGHT)}return[a,l]}var su={capture:!0},Zb={passive:!1,capture:!0},Tie=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["ng-component"]],hostAttrs:["cdk-drag-resets-container",""],decls:0,vars:0,template:function(n,o){},styles:[`@layer cdk-resets{.cdk-drag-preview{background:none;border:none;padding:0;color:inherit;inset:auto}}.cdk-drag-placeholder *,.cdk-drag-preview *{pointer-events:none !important}
`],encapsulation:2,changeDetection:0})}return e})(),v6=(()=>{class e{_ngZone=k(di);_document=k(Li);_styleLoader=k(gy);_renderer=k(Uf).createRenderer(null,null);_cleanupDocumentTouchmove;_scroll=new qe;_dropInstances=new Set;_dragInstances=new Set;_activeDragInstances=J([]);_globalListeners;_draggingPredicate=i=>i.isDragging();_domNodesToDirectives=null;pointerMove=new qe;pointerUp=new qe;constructor(){}registerDropContainer(i){this._dropInstances.has(i)||this._dropInstances.add(i)}registerDragItem(i){this._dragInstances.add(i),this._dragInstances.size===1&&this._ngZone.runOutsideAngular(()=>{this._cleanupDocumentTouchmove?.(),this._cleanupDocumentTouchmove=this._renderer.listen(this._document,"touchmove",this._persistentTouchmoveListener,Zb)})}removeDropContainer(i){this._dropInstances.delete(i)}removeDragItem(i){this._dragInstances.delete(i),this.stopDragging(i),this._dragInstances.size===0&&this._cleanupDocumentTouchmove?.()}startDragging(i,n){if(!(this._activeDragInstances().indexOf(i)>-1)&&(this._styleLoader.load(Tie),this._activeDragInstances.update(o=>[...o,i]),this._activeDragInstances().length===1)){let o=n.type.startsWith("touch"),r=a=>this.pointerUp.next(a),s=[["scroll",a=>this._scroll.next(a),su],["selectstart",this._preventDefaultWhileDragging,Zb]];o?s.push(["touchend",r,su],["touchcancel",r,su]):s.push(["mouseup",r,su]),o||s.push(["mousemove",a=>this.pointerMove.next(a),Zb]),this._ngZone.runOutsideAngular(()=>{this._globalListeners=s.map(([a,l,c])=>this._renderer.listen(this._document,a,l,c))})}}stopDragging(i){this._activeDragInstances.update(n=>{let o=n.indexOf(i);return o>-1?(n.splice(o,1),[...n]):n}),this._activeDragInstances().length===0&&this._clearGlobalListeners()}isDragging(i){return this._activeDragInstances().indexOf(i)>-1}scrolled(i){let n=[this._scroll];return i&&i!==this._document&&n.push(new Ql(o=>this._ngZone.runOutsideAngular(()=>{let r=this._renderer.listen(i,"scroll",s=>{this._activeDragInstances().length&&o.next(s)},su);return()=>{r()}}))),ko(...n)}registerDirectiveNode(i,n){this._domNodesToDirectives??=new WeakMap,this._domNodesToDirectives.set(i,n)}removeDirectiveNode(i){this._domNodesToDirectives?.delete(i)}getDragDirectiveForNode(i){return this._domNodesToDirectives?.get(i)||null}ngOnDestroy(){this._dragInstances.forEach(i=>this.removeDragItem(i)),this._dropInstances.forEach(i=>this.removeDropContainer(i)),this._domNodesToDirectives=null,this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_preventDefaultWhileDragging=i=>{this._activeDragInstances().length>0&&i.preventDefault()};_persistentTouchmoveListener=i=>{this._activeDragInstances().length>0&&(this._activeDragInstances().some(this._draggingPredicate)&&i.preventDefault(),this.pointerMove.next(i))};_clearGlobalListeners(){this._globalListeners?.forEach(i=>i()),this._globalListeners=void 0}static \u0275fac=function(n){return new(n||e)};static \u0275prov=qi({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Fie={dragStartThreshold:5,pointerDirectionChangeThreshold:5},l1=(()=>{class e{_document=k(Li);_ngZone=k(di);_viewportRuler=k(my);_dragDropRegistry=k(v6);_renderer=k(Uf).createRenderer(null,null);constructor(){}createDrag(i,n=Fie){return new n1(i,n,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry,this._renderer)}createDropList(i){return new r1(i,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}static \u0275fac=function(n){return new(n||e)};static \u0275prov=qi({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),u6=new bt("CDK_DRAG_PARENT");var Iie=new bt("CdkDragHandle");var C6=new bt("CDK_DRAG_CONFIG"),w6=new bt("CdkDropList"),b6=(()=>{class e{element=k(Je);dropContainer=k(w6,{optional:!0,skipSelf:!0});_ngZone=k(di);_viewContainerRef=k(Er);_dir=k(Ds,{optional:!0});_changeDetectorRef=k(Tn);_selfHandle=k(Iie,{optional:!0,self:!0});_parentDrag=k(u6,{optional:!0,skipSelf:!0});_dragDropRegistry=k(v6);_destroyed=new qe;_handles=new f1([]);_previewTemplate;_placeholderTemplate;_dragRef;data;lockAxis=null;rootElementSelector;boundaryElement;dragStartDelay;freeDragPosition;get disabled(){return this._disabled||!!(this.dropContainer&&this.dropContainer.disabled)}set disabled(i){this._disabled=i,this._dragRef.disabled=this._disabled}_disabled;constrainPosition;previewClass;previewContainer;scale=1;started=new G;released=new G;ended=new G;entered=new G;exited=new G;dropped=new G;moved=new Ql(i=>{let n=this._dragRef.moved.pipe(Rn(o=>({source:this,pointerPosition:o.pointerPosition,event:o.event,delta:o.delta,distance:o.distance}))).subscribe(i);return()=>{n.unsubscribe()}});_injector=k(_a);constructor(){let i=this.dropContainer,n=k(C6,{optional:!0}),o=k(l1);this._dragRef=o.createDrag(this.element,{dragStartThreshold:n&&n.dragStartThreshold!=null?n.dragStartThreshold:5,pointerDirectionChangeThreshold:n&&n.pointerDirectionChangeThreshold!=null?n.pointerDirectionChangeThreshold:5,zIndex:n?.zIndex}),this._dragRef.data=this,this._dragDropRegistry.registerDirectiveNode(this.element.nativeElement,this),n&&this._assignDefaults(n),i&&(i.addItem(this),i._dropListRef.beforeStarted.pipe(lt(this._destroyed)).subscribe(()=>{this._dragRef.scale=this.scale})),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}resetToBoundary(){this._dragRef.resetToBoundary()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(i){this._dragRef.setFreeDragPosition(i)}ngAfterViewInit(){_r(()=>{this._updateRootElement(),this._setupHandlesListener(),this._dragRef.scale=this.scale,this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)},{injector:this._injector})}ngOnChanges(i){let n=i.rootElementSelector,o=i.freeDragPosition;n&&!n.firstChange&&this._updateRootElement(),this._dragRef.scale=this.scale,o&&!o.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this),this._dragDropRegistry.removeDirectiveNode(this.element.nativeElement),this._ngZone.runOutsideAngular(()=>{this._handles.complete(),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_addHandle(i){let n=this._handles.getValue();n.push(i),this._handles.next(n)}_removeHandle(i){let n=this._handles.getValue(),o=n.indexOf(i);o>-1&&(n.splice(o,1),this._handles.next(n))}_setPreviewTemplate(i){this._previewTemplate=i}_resetPreviewTemplate(i){i===this._previewTemplate&&(this._previewTemplate=null)}_setPlaceholderTemplate(i){this._placeholderTemplate=i}_resetPlaceholderTemplate(i){i===this._placeholderTemplate&&(this._placeholderTemplate=null)}_updateRootElement(){let i=this.element.nativeElement,n=i;this.rootElementSelector&&(n=i.closest!==void 0?i.closest(this.rootElementSelector):i.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(n||i)}_getBoundaryElement(){let i=this.boundaryElement;return i?typeof i=="string"?this.element.nativeElement.closest(i):An(i):null}_syncInputs(i){i.beforeStarted.subscribe(()=>{if(!i.isDragging()){let n=this._dir,o=this.dragStartDelay,r=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,s=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;i.disabled=this.disabled,i.lockAxis=this.lockAxis,i.scale=this.scale,i.dragStartDelay=typeof o=="object"&&o?o:$f(o),i.constrainPosition=this.constrainPosition,i.previewClass=this.previewClass,i.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(r).withPreviewTemplate(s).withPreviewContainer(this.previewContainer||"global"),n&&i.withDirection(n.value)}}),i.beforeStarted.pipe(Ea(1)).subscribe(()=>{if(this._parentDrag){i.withParent(this._parentDrag._dragRef);return}let n=this.element.nativeElement.parentElement;for(;n;){let o=this._dragDropRegistry.getDragDirectiveForNode(n);if(o){i.withParent(o._dragRef);break}n=n.parentElement}})}_handleEvents(i){i.started.subscribe(n=>{this.started.emit({source:this,event:n.event}),this._changeDetectorRef.markForCheck()}),i.released.subscribe(n=>{this.released.emit({source:this,event:n.event})}),i.ended.subscribe(n=>{this.ended.emit({source:this,distance:n.distance,dropPoint:n.dropPoint,event:n.event}),this._changeDetectorRef.markForCheck()}),i.entered.subscribe(n=>{this.entered.emit({container:n.container.data,item:this,currentIndex:n.currentIndex})}),i.exited.subscribe(n=>{this.exited.emit({container:n.container.data,item:this})}),i.dropped.subscribe(n=>{this.dropped.emit({previousIndex:n.previousIndex,currentIndex:n.currentIndex,previousContainer:n.previousContainer.data,container:n.container.data,isPointerOverContainer:n.isPointerOverContainer,item:this,distance:n.distance,dropPoint:n.dropPoint,event:n.event})})}_assignDefaults(i){let{lockAxis:n,dragStartDelay:o,constrainPosition:r,previewClass:s,boundaryElement:a,draggingDisabled:l,rootElementSelector:c,previewContainer:d}=i;this.disabled=l??!1,this.dragStartDelay=o||0,this.lockAxis=n||null,r&&(this.constrainPosition=r),s&&(this.previewClass=s),a&&(this.boundaryElement=a),c&&(this.rootElementSelector=c),d&&(this.previewContainer=d)}_setupHandlesListener(){this._handles.pipe(an(i=>{let n=i.map(o=>o.element);this._selfHandle&&this.rootElementSelector&&n.push(this.element),this._dragRef.withHandles(n)}),xi(i=>ko(...i.map(n=>n._stateChanges.pipe(ec(n))))),lt(this._destroyed)).subscribe(i=>{let n=this._dragRef,o=i.element.nativeElement;i.disabled?n.disableHandle(o):n.enableHandle(o)})}static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["","cdkDrag",""]],hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(n,o){n&2&&dt("cdk-drag-disabled",o.disabled)("cdk-drag-dragging",o._dragRef.isDragging())},inputs:{data:[0,"cdkDragData","data"],lockAxis:[0,"cdkDragLockAxis","lockAxis"],rootElementSelector:[0,"cdkDragRootElement","rootElementSelector"],boundaryElement:[0,"cdkDragBoundary","boundaryElement"],dragStartDelay:[0,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[0,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[2,"cdkDragDisabled","disabled",D],constrainPosition:[0,"cdkDragConstrainPosition","constrainPosition"],previewClass:[0,"cdkDragPreviewClass","previewClass"],previewContainer:[0,"cdkDragPreviewContainer","previewContainer"],scale:[2,"cdkDragScale","scale",Fn]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[ue([{provide:u6,useExisting:e}]),uu]})}return e})(),h6=new bt("CdkDropListGroup");var y6=(()=>{class e{element=k(Je);_changeDetectorRef=k(Tn);_scrollDispatcher=k(bu);_dir=k(Ds,{optional:!0});_group=k(h6,{optional:!0,skipSelf:!0});_latestSortedRefs;_destroyed=new qe;_scrollableParentsResolved;static _dropLists=[];_dropListRef;connectedTo=[];data;orientation;id=k(wy).getId("cdk-drop-list-");lockAxis=null;get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(i){this._dropListRef.disabled=this._disabled=i}_disabled;sortingDisabled;enterPredicate=()=>!0;sortPredicate=()=>!0;autoScrollDisabled;autoScrollStep;elementContainerSelector;hasAnchor;dropped=new G;entered=new G;exited=new G;sorted=new G;_unsortedItems=new Set;constructor(){let i=k(l1),n=k(C6,{optional:!0});this._dropListRef=i.createDropList(this.element),this._dropListRef.data=this,n&&this._assignDefaults(n),this._dropListRef.enterPredicate=(o,r)=>this.enterPredicate(o.data,r.data),this._dropListRef.sortPredicate=(o,r,s)=>this.sortPredicate(o,r.data,s.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),e._dropLists.push(this),this._group&&this._group._items.add(this)}addItem(i){this._unsortedItems.add(i),i._dragRef._withDropContainer(this._dropListRef),this._dropListRef.isDragging()&&this._syncItemsWithRef(this.getSortedItems().map(n=>n._dragRef))}removeItem(i){if(this._unsortedItems.delete(i),this._latestSortedRefs){let n=this._latestSortedRefs.indexOf(i._dragRef);n>-1&&(this._latestSortedRefs.splice(n,1),this._syncItemsWithRef(this._latestSortedRefs))}}getSortedItems(){return Array.from(this._unsortedItems).sort((i,n)=>i._dragRef.getVisibleElement().compareDocumentPosition(n._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){let i=e._dropLists.indexOf(this);i>-1&&e._dropLists.splice(i,1),this._group&&this._group._items.delete(this),this._latestSortedRefs=void 0,this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(i){this._dir&&this._dir.change.pipe(ec(this._dir.value),lt(this._destroyed)).subscribe(n=>i.withDirection(n)),i.beforeStarted.subscribe(()=>{let n=fy(this.connectedTo).map(o=>{if(typeof o=="string"){let r=e._dropLists.find(s=>s.id===o);return r}return o});if(this._group&&this._group._items.forEach(o=>{n.indexOf(o)===-1&&n.push(o)}),!this._scrollableParentsResolved){let o=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(r=>r.getElementRef().nativeElement);this._dropListRef.withScrollableParents(o),this._scrollableParentsResolved=!0}if(this.elementContainerSelector){let o=this.element.nativeElement.querySelector(this.elementContainerSelector);i.withElementContainer(o)}i.disabled=this.disabled,i.lockAxis=this.lockAxis,i.sortingDisabled=this.sortingDisabled,i.autoScrollDisabled=this.autoScrollDisabled,i.autoScrollStep=$f(this.autoScrollStep,2),i.hasAnchor=this.hasAnchor,i.connectedTo(n.filter(o=>o&&o!==this).map(o=>o._dropListRef)).withOrientation(this.orientation)})}_handleEvents(i){i.beforeStarted.subscribe(()=>{this._syncItemsWithRef(this.getSortedItems().map(n=>n._dragRef)),this._changeDetectorRef.markForCheck()}),i.entered.subscribe(n=>{this.entered.emit({container:this,item:n.item.data,currentIndex:n.currentIndex})}),i.exited.subscribe(n=>{this.exited.emit({container:this,item:n.item.data}),this._changeDetectorRef.markForCheck()}),i.sorted.subscribe(n=>{this.sorted.emit({previousIndex:n.previousIndex,currentIndex:n.currentIndex,container:this,item:n.item.data})}),i.dropped.subscribe(n=>{this.dropped.emit({previousIndex:n.previousIndex,currentIndex:n.currentIndex,previousContainer:n.previousContainer.data,container:n.container.data,item:n.item.data,isPointerOverContainer:n.isPointerOverContainer,distance:n.distance,dropPoint:n.dropPoint,event:n.event}),this._changeDetectorRef.markForCheck()}),ko(i.receivingStarted,i.receivingStopped).subscribe(()=>this._changeDetectorRef.markForCheck())}_assignDefaults(i){let{lockAxis:n,draggingDisabled:o,sortingDisabled:r,listAutoScrollDisabled:s,listOrientation:a}=i;this.disabled=o??!1,this.sortingDisabled=r??!1,this.autoScrollDisabled=s??!1,this.orientation=a||"vertical",this.lockAxis=n||null}_syncItemsWithRef(i){this._latestSortedRefs=i,this._dropListRef.withItems(i)}static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(n,o){n&2&&(Qe("id",o.id),dt("cdk-drop-list-disabled",o.disabled)("cdk-drop-list-dragging",o._dropListRef.isDragging())("cdk-drop-list-receiving",o._dropListRef.isReceiving()))},inputs:{connectedTo:[0,"cdkDropListConnectedTo","connectedTo"],data:[0,"cdkDropListData","data"],orientation:[0,"cdkDropListOrientation","orientation"],id:"id",lockAxis:[0,"cdkDropListLockAxis","lockAxis"],disabled:[2,"cdkDropListDisabled","disabled",D],sortingDisabled:[2,"cdkDropListSortingDisabled","sortingDisabled",D],enterPredicate:[0,"cdkDropListEnterPredicate","enterPredicate"],sortPredicate:[0,"cdkDropListSortPredicate","sortPredicate"],autoScrollDisabled:[2,"cdkDropListAutoScrollDisabled","autoScrollDisabled",D],autoScrollStep:[0,"cdkDropListAutoScrollStep","autoScrollStep"],elementContainerSelector:[0,"cdkDropListElementContainer","elementContainerSelector"],hasAnchor:[2,"cdkDropListHasAnchor","hasAnchor",D]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],features:[ue([{provide:h6,useValue:void 0},{provide:w6,useExisting:e}])]})}return e})();var S6=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=ys({type:e});static \u0275inj=bs({providers:[l1],imports:[vy]})}return e})();var x6=e=>[e],E6=(e,t)=>t.id;function Lie(e,t){if(e&1){let i=xe();S(0,"div",7)(1,"div",11)(2,"div",12),F(3),x(),S(4,"div",13),F(5),x()(),S(6,"button",14),V("click",function(){let o=j(i).$implicit,r=I();return K(r.addMaterial(o))}),H(7,"ng-icon",15),x()()}if(e&2){let i=t.$implicit;E(3),we(i.name),E(2),de("",i.thickness," mm")}}function Oie(e,t){e&1&&(S(0,"div",8),F(1,"Keine Materialien verf\xFCgbar"),x())}function Nie(e,t){if(e&1){let i=xe();S(0,"div",7)(1,"div",16)(2,"span",17),F(3),x(),S(4,"div",11)(5,"div",12),F(6),x(),S(7,"div",13),F(8),x()()(),S(9,"div",18)(10,"button",19),V("click",function(){let o=j(i).$implicit,r=I();return K(r.moveUp(o))}),H(11,"ng-icon",20),x(),S(12,"button",19),V("click",function(){let o=j(i).$implicit,r=I();return K(r.moveDown(o))}),H(13,"ng-icon",21),x(),S(14,"button",22),V("click",function(){let o=j(i).$implicit,r=I();return K(r.removeMaterial(o))}),H(15,"ng-icon",23),x()()()}if(e&2){let i=t.$implicit,n=I();E(3),we(i.position),E(3),we(i.material.name),E(2),de("",i.material.thickness," mm"),E(2),U("disabled",i.position===1),E(2),U("disabled",i.position===n.selectedLayers().length)}}function Bie(e,t){e&1&&(S(0,"div",8),F(1,"Keine Schichten hinzugef\xFCgt"),x())}var _6=(()=>{class e{allMaterials=M.required();initialSelectedLayers=M([]);layersChanged=oe();selectedLayersSignal=J([]);selectedLayers=this.selectedLayersSignal.asReadonly();availableMaterials=L(()=>{let i=new Set(this.selectedLayers().map(n=>n.materialId));return this.allMaterials().filter(n=>!i.has(n.id))});constructor(){_e(()=>{let i=this.initialSelectedLayers();i.length>0&&this.selectedLayersSignal().length===0&&this.selectedLayersSignal.set([...i])})}totalThickness=L(()=>this.selectedLayers().reduce((i,n)=>i+n.material.thickness,0));addMaterial(i){let n=this.selectedLayersSignal(),o=n.length>0?Math.max(...n.map(s=>s.position)):0,r={id:crypto.randomUUID(),materialId:i.id,material:i,position:o+1};this.selectedLayersSignal.update(s=>[...s,r]),this.emitChanges()}removeMaterial(i){this.selectedLayersSignal.update(n=>n.filter(r=>r.id!==i.id).sort((r,s)=>r.position-s.position).map((r,s)=>z(b({},r),{position:s+1}))),this.emitChanges()}moveUp(i){i.position!==1&&(this.selectedLayersSignal.update(n=>{let o=[...n].sort((s,a)=>s.position-a.position),r=o.findIndex(s=>s.id===i.id);return r>0?([o[r-1],o[r]]=[o[r],o[r-1]],o.map((s,a)=>z(b({},s),{position:a+1}))):n}),this.emitChanges())}moveDown(i){let n=this.selectedLayers();i.position!==n.length&&(this.selectedLayersSignal.update(o=>{let r=[...o].sort((a,l)=>a.position-l.position),s=r.findIndex(a=>a.id===i.id);return s<r.length-1?([r[s],r[s+1]]=[r[s+1],r[s]],r.map((a,l)=>z(b({},a),{position:l+1}))):o}),this.emitChanges())}onDropAvailable(i){if(i.previousContainer!==i.container){let n=i.previousContainer.data[i.previousIndex];this.removeMaterial(n)}}onDropSelected(i){if(i.previousContainer===i.container){let n=[...this.selectedLayersSignal()];Of(n,i.previousIndex,i.currentIndex);let o=n.map((r,s)=>z(b({},r),{position:s+1}));this.selectedLayersSignal.set(o),this.emitChanges()}else{let n=i.previousContainer.data[i.previousIndex];this.addMaterial(n)}}emitChanges(){this.layersChanged.emit(this.selectedLayersSignal())}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["gh-material-dual-list"]],inputs:{allMaterials:[1,"allMaterials"],initialSelectedLayers:[1,"initialSelectedLayers"]},outputs:{layersChanged:"layersChanged"},features:[ue([nt({lucideArrowRight:B1,lucideTrash:ln,lucideChevronUp:z1,lucideChevronDown:vu})])],decls:26,vars:11,consts:[["availableList","cdkDropList"],["selectedList","cdkDropList"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"border","rounded-lg","p-4"],[1,"font-semibold","mb-3"],[1,"h-[400px]","overflow-y-auto"],["cdkDropList","",1,"space-y-2","min-h-[50px]","p-2",3,"cdkDropListDropped","cdkDropListData","cdkDropListConnectedTo"],["cdkDrag","",1,"flex","items-center","justify-between","p-3","bg-muted","rounded-md","border","cursor-move","hover:bg-accent","transition-colors"],[1,"text-center","text-muted-foreground","p-4"],[1,"text-sm","font-normal","text-muted-foreground","ml-2"],[1,"mt-4","text-sm","text-muted-foreground"],[1,"flex-1","min-w-0"],[1,"font-medium","truncate"],[1,"text-sm","text-muted-foreground"],["hlmBtn","","size","icon-sm","variant","ghost",1,"flex-shrink-0","ml-2",3,"click"],["hlm","","name","lucideArrowRight","size","sm"],[1,"flex","items-center","gap-2","flex-1","min-w-0"],[1,"text-xs","font-semibold","text-muted-foreground","w-6"],[1,"flex","gap-1","flex-shrink-0","ml-2"],["hlmBtn","","size","icon-sm","variant","ghost",3,"click","disabled"],["hlm","","name","lucideChevronUp","size","sm"],["hlm","","name","lucideChevronDown","size","sm"],["hlmBtn","","size","icon-sm","variant","destructive",3,"click"],["hlm","","name","lucideTrash","size","sm"]],template:function(n,o){if(n&1){let r=xe();S(0,"div",2)(1,"div",3)(2,"h3",4),F(3,"Verf\xFCgbare Materialien"),x(),S(4,"div",5)(5,"div",6,0),V("cdkDropListDropped",function(a){return j(r),K(o.onDropAvailable(a))}),ei(7,Lie,8,2,"div",7,E6),ve(9,Oie,2,0,"div",8),x()()(),S(10,"div",3)(11,"h3",4),F(12," Ausgew\xE4hlte Schichten "),S(13,"span",9),F(14,"Gesamtdicke: "),S(15,"strong"),F(16),x()()(),S(17,"div",5)(18,"div",6,1),V("cdkDropListDropped",function(a){return j(r),K(o.onDropSelected(a))}),ei(20,Nie,16,5,"div",7,E6),ve(22,Bie,2,0,"div",8),x()()()(),S(23,"div",10)(24,"p"),F(25,"\u{1F4A1} Tipp: Ziehen Sie Materialien per Drag & Drop zwischen den Listen oder verwenden Sie die Buttons. Position 1 = au\xDFen."),x()()}if(n&2){let r=Ki(6),s=Ki(19);E(5),U("cdkDropListData",o.availableMaterials())("cdkDropListConnectedTo",oc(7,x6,s)),E(2),ti(o.availableMaterials()),E(2),Ce(o.availableMaterials().length===0?9:-1),E(7),de("",o.totalThickness()," mm"),E(2),U("cdkDropListData",o.selectedLayers())("cdkDropListConnectedTo",oc(9,x6,r)),E(2),ti(o.selectedLayers()),E(2),Ce(o.selectedLayers().length===0?22:-1)}},dependencies:[ui,S6,y6,b6,Ze,We,ot],encapsulation:2,changeDetection:0})}return e})();function Hie(e,t){e&1&&(S(0,"p",9),F(1,"Materialname ist erforderlich"),x())}function Vie(e,t){e&1&&(S(0,"p",9),F(1,"Dicke ist erforderlich und muss eine positive Zahl sein"),x())}function Gie(e,t){if(e&1){let i=xe();S(0,"hlm-sheet-content",2)(1,"hlm-sheet-header")(2,"h3",3),F(3),x(),S(4,"p",4),F(5,"Geben Sie die Details f\xFCr das Material ein."),x()(),S(6,"form",5)(7,"div",6)(8,"label",7),F(9,"Materialname *"),x(),H(10,"input",8),ve(11,Hie,2,0,"p",9),x(),S(12,"div",6)(13,"label",10),F(14,"Dicke (mm) *"),x(),H(15,"input",11),ve(16,Vie,2,0,"p",9),x(),S(17,"div",6)(18,"label",12),F(19,"Beschreibung"),x(),H(20,"input",13),x()(),S(21,"hlm-sheet-footer",14)(22,"button",15),V("click",function(){let o=j(i).$implicit;return K(o.close())}),F(23," Abbrechen "),x(),S(24,"button",16),V("click",function(){let o=j(i).$implicit,r=I();return K(r.save(o))}),F(25," Speichern "),x()()()}if(e&2){let i=I();E(3),we(i.isEdit()?"Material bearbeiten":"Neues Material"),E(3),U("formGroup",i.form),E(5),Ce(i.form.controls.name.touched&&i.form.controls.name.invalid?11:-1),E(5),Ce(i.form.controls.thickness.touched&&i.form.controls.thickness.invalid?16:-1),E(8),U("disabled",i.form.invalid)}}var R6=(()=>{class e{material=M(null);state=M("closed");stateChanged=oe();save$=oe();isEdit=L(()=>!!this.material()?.id);form=new ka({name:new In("",[Mr.required]),thickness:new In(null,[Mr.required,Mr.min(0)]),description:new In("")});constructor(){_e(()=>{let i=this.material();i?this.form.patchValue({name:i.name||"",thickness:i.thickness||0,description:i.description||""}):this.form.reset()})}save(i){if(this.form.invalid)return;let n=this.form.value;this.save$.emit({name:n.name||"",thickness:n.thickness||0,description:n.description||""}),this.form.reset(),i.close()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["gh-material-edit-sheet"]],inputs:{material:[1,"material"],state:[1,"state"]},outputs:{stateChanged:"stateChanged",save$:"save$"},decls:2,vars:1,consts:[["side","right",3,"stateChanged","state"],["class","w-full sm:max-w-md",4,"brnSheetContent"],[1,"w-full","sm:max-w-md"],["hlmSheetTitle",""],["hlmSheetDescription",""],[1,"space-y-4","p-4",3,"formGroup"],[1,"space-y-2"],["hlmLabel","","for","name"],["hlmInput","","id","name","formControlName","name","placeholder","z.B. Holz, Ziegel"],[1,"text-sm","text-destructive"],["hlmLabel","","for","thickness"],["hlmInput","","id","thickness","type","number","formControlName","thickness","placeholder","z.B. 20"],["hlmLabel","","for","description"],["hlmInput","","id","description","formControlName","description","placeholder","Optionale Beschreibung"],[1,"flex","justify-end","gap-2"],["hlmBtn","","variant","outline",3,"click"],["hlmBtn","",3,"click","disabled"]],template:function(n,o){n&1&&(S(0,"hlm-sheet",0),V("stateChanged",function(s){return o.stateChanged.emit(s)}),Dt(1,Gie,26,5,"hlm-sheet-content",1),x()),n&2&&U("state",o.state())},dependencies:[Ia,Ta,Yn,L1,Xn,Ma,kr,Fa,Zn,Ln,On,Lo,Oo,No,Bo,Ze,Pi,Ni],encapsulation:2,changeDetection:0})}return e})();var Mo=class{supabaseGlobal=k(La);supabase=this.supabaseGlobal.supabase;loadingCount=J(0);loading=L(()=>this.loadingCount()>0);materialLayers=kn({loader:async()=>{let{data:t,error:i}=await this.supabase.from("material_layers").select("*").order("created_at",{ascending:!1});if(i)throw i;return t||[]}});wallStructures=kn({loader:async()=>{let{data:t,error:i}=await this.supabase.from("wall_structures").select("*").order("created_at",{ascending:!1});if(i)throw i;return t||[]}});selectedStructureIdSignal=J(null);structureLayers=kn({params:()=>({structureId:this.selectedStructureIdSignal()}),loader:async({params:t})=>{if(!t.structureId)return[];let{data:i,error:n}=await this.supabase.from("wall_structure_layers").select(`
          *,
          material:material_layers(*)
        `).eq("wall_structure_id",t.structureId).order("position",{ascending:!0});if(n)throw n;return i||[]}});selectedStructureId=L(()=>this.selectedStructureIdSignal());selectStructure(t){this.selectedStructureIdSignal.set(t)}createMaterialLayer(t){this.loadingCount.update(i=>i+1),Ve(this.supabase.from("material_layers").insert({name:t.name,thickness:t.thickness,description:t.description||null}).select().single()).pipe(Xe(i=>(console.error("Error creating material layer:",i),Ge({error:i}))),$e(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.materialLayers.reload()})}updateMaterialLayer(t,i){this.loadingCount.update(n=>n+1),Ve(this.supabase.from("material_layers").update(i).eq("id",t).select().single()).pipe(Xe(n=>(console.error("Error updating material layer:",n),Ge({error:n}))),$e(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error)throw n.error;this.materialLayers.reload()})}deleteMaterialLayers(t){this.loadingCount.update(i=>i+1),Ve(this.supabase.from("material_layers").delete().in("id",t)).pipe(Xe(i=>(console.error("Error deleting material layers:",i),Ge({error:i}))),$e(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.materialLayers.reload()})}createWallStructure(t){this.loadingCount.update(i=>i+1),Ve(this.supabase.from("wall_structures").insert({name:t.name}).select().single()).pipe(Xe(i=>(console.error("Error creating wall structure:",i),Ge({error:i}))),$e(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.wallStructures.reload()})}createWallStructureWithLayers(t,i){this.loadingCount.update(n=>n+1),Ve(this.supabase.from("wall_structures").insert({name:t.name}).select().single()).pipe(Xe(n=>(console.error("Error creating wall structure:",n),Ge({error:n}))),$e(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error)throw n.error;let o=n.data;i.length>0&&this.addLayersToStructureSync(o.id,i),this.wallStructures.reload()})}updateWallStructure(t,i){this.loadingCount.update(n=>n+1),Ve(this.supabase.from("wall_structures").update(i).eq("id",t).select().single()).pipe(Xe(n=>(console.error("Error updating wall structure:",n),Ge({error:n}))),$e(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error)throw n.error;this.wallStructures.reload()})}updateWallStructureWithLayers(t,i,n){this.loadingCount.update(o=>o+1),Ve(this.supabase.from("wall_structures").update(i).eq("id",t).select().single()).pipe(Xe(o=>(console.error("Error updating wall structure:",o),Ge({error:o}))),$e(()=>this.loadingCount.update(o=>o-1))).subscribe(o=>{if(o?.error)throw o.error;this.replaceStructureLayers(t,n),this.wallStructures.reload()})}deleteWallStructure(t){this.loadingCount.update(i=>i+1),Ve(this.supabase.from("wall_structures").delete().eq("id",t)).pipe(Xe(i=>(console.error("Error deleting wall structure:",i),Ge({error:i}))),$e(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.wallStructures.reload(),this.selectedStructureIdSignal()===t&&this.selectedStructureIdSignal.set(null)})}addLayerToStructure(t){this.loadingCount.update(i=>i+1),Ve(this.supabase.from("wall_structure_layers").insert(t).select().single()).pipe(Xe(i=>(console.error("Error adding layer to structure:",i),Ge({error:i}))),$e(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.structureLayers.reload()})}removeLayersFromStructure(t){this.loadingCount.update(i=>i+1),Ve(this.supabase.from("wall_structure_layers").delete().in("id",t)).pipe(Xe(i=>(console.error("Error removing layers from structure:",i),Ge({error:i}))),$e(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.structureLayers.reload()})}addLayersToStructureSync(t,i){this.loadingCount.update(o=>o+1);let n=i.map(o=>({wall_structure_id:t,material_layer_id:o.materialId,position:o.position}));Ve(this.supabase.from("wall_structure_layers").insert(n)).pipe(Xe(o=>(console.error("Error adding layers to structure:",o),Ge({error:o}))),$e(()=>this.loadingCount.update(o=>o-1))).subscribe(o=>{if(o?.error)throw o.error;this.structureLayers.reload()})}replaceStructureLayers(t,i){this.loadingCount.update(n=>n+1),Ve(this.supabase.from("wall_structure_layers").delete().eq("wall_structure_id",t)).pipe(Xe(n=>(console.error("Error removing existing layers:",n),Ge({error:n})))).subscribe(n=>{if(n?.error)throw this.loadingCount.update(o=>o-1),n.error;if(i.length>0){let o=i.map(r=>({wall_structure_id:t,material_layer_id:r.materialId,position:r.position}));Ve(this.supabase.from("wall_structure_layers").insert(o)).pipe(Xe(r=>(console.error("Error adding new layers:",r),Ge({error:r}))),$e(()=>this.loadingCount.update(r=>r-1))).subscribe(r=>{if(r?.error)throw r.error;this.structureLayers.reload()})}else this.loadingCount.update(o=>o-1),this.structureLayers.reload()})}};function zie(e,t){e&1&&(S(0,"div",5),H(1,"hlm-spinner",10),x())}function Wie(e,t){e&1&&(S(0,"p",15),F(1,"Name ist erforderlich"),x())}function Uie(e,t){if(e&1){let i=xe();S(0,"gh-material-dual-list",18),V("layersChanged",function(o){j(i);let r=I(3);return K(r.onLayersChanged(o))}),x()}if(e&2){let i=I(3);U("allMaterials",i.allMaterials())("initialSelectedLayers",i.currentLayers())}}function qie(e,t){if(e&1){let i=xe();S(0,"gh-material-dual-list",19),V("layersChanged",function(o){j(i);let r=I(3);return K(r.onLayersChanged(o))}),x()}if(e&2){let i=I(3);U("allMaterials",i.allMaterials())}}function $ie(e,t){if(e&1&&(S(0,"div",6)(1,"form",11)(2,"div",12)(3,"label",13),F(4,"Wandaufbau Name *"),x(),H(5,"input",14),ve(6,Wie,2,0,"p",15),x()(),ve(7,Uie,1,2,"gh-material-dual-list",16)(8,qie,1,1,"gh-material-dual-list",17),x()),e&2){let i=I(2);E(),U("formGroup",i.form),E(5),Ce(i.form.controls.name.touched&&i.form.controls.name.invalid?6:-1),E(),Ce(i.isEdit()?7:8)}}function jie(e,t){if(e&1){let i=xe();S(0,"hlm-sheet-content",2)(1,"hlm-sheet-header")(2,"h3",3),F(3),x(),S(4,"p",4),F(5,"Geben Sie den Namen ein und w\xE4hlen Sie die Materialien f\xFCr den Aufbau aus."),x()(),ve(6,zie,2,0,"div",5)(7,$ie,9,3,"div",6),S(8,"hlm-sheet-footer",7)(9,"button",8),V("click",function(){let o=j(i).$implicit;return K(o.close())}),F(10," Abbrechen "),x(),S(11,"button",9),V("click",function(){let o=j(i).$implicit,r=I();return K(r.save(o))}),F(12," Speichern "),x()()()}if(e&2){let i=I();E(3),we(i.isEdit()?"Wandaufbau bearbeiten":"Neuer Wandaufbau"),E(3),Ce(i.loadingLayers()?6:7),E(5),U("disabled",i.form.invalid||i.service.loading())}}var P6=(()=>{class e{service=k(Mo);structure=M(null);state=M("closed");stateChanged=oe();save$=oe();isEdit=L(()=>!!this.structure()?.id);selectedLayersSignal=J([]);form=new ka({name:new In("",[Mr.required])});allMaterials=L(()=>this.service.materialLayers.value()||[]);loadingLayers=L(()=>this.structure()&&this.service.structureLayers.isLoading());currentLayers=L(()=>this.structure()?(this.service.structureLayers.value()||[]).map(o=>({id:o.id,materialId:o.material_layer_id,material:o.material,position:o.position})):[]);constructor(){_e(()=>{let i=this.structure();i?(this.form.patchValue({name:i.name||""}),this.service.selectStructure(i.id)):(this.form.reset(),this.selectedLayersSignal.set([]),this.service.selectStructure(null))})}onLayersChanged(i){this.selectedLayersSignal.set(i)}save(i){if(this.form.invalid)return;let n=this.form.value;this.save$.emit({structure:{name:n.name||""},layers:this.selectedLayersSignal()}),this.form.reset(),this.selectedLayersSignal.set([]),i.close()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["gh-wall-structure-edit-sheet"]],inputs:{structure:[1,"structure"],state:[1,"state"]},outputs:{stateChanged:"stateChanged",save$:"save$"},decls:2,vars:1,consts:[["side","right",3,"stateChanged","state"],["class","w-full sm:max-w-5xl",4,"brnSheetContent"],[1,"w-full","sm:max-w-5xl"],["hlmSheetTitle",""],["hlmSheetDescription",""],[1,"flex","justify-center","items-center","h-[500px]"],[1,"space-y-6","p-4","overflow-y-auto","max-h-[calc(100vh-200px)]"],[1,"flex","justify-end","gap-2"],["hlmBtn","","variant","outline",3,"click"],["hlmBtn","",3,"click","disabled"],["size","large"],[3,"formGroup"],[1,"space-y-2"],["hlmLabel","","for","name"],["hlmInput","","id","name","formControlName","name","placeholder","z.B. Au\xDFenwand mit D\xE4mmung"],[1,"text-sm","text-destructive"],[3,"allMaterials","initialSelectedLayers"],[3,"allMaterials"],[3,"layersChanged","allMaterials","initialSelectedLayers"],[3,"layersChanged","allMaterials"]],template:function(n,o){n&1&&(S(0,"hlm-sheet",0),V("stateChanged",function(s){return o.stateChanged.emit(s)}),Dt(1,jie,13,3,"hlm-sheet-content",1),x()),n&2&&U("state",o.state())},dependencies:[Ia,Ta,Yn,Xn,Ma,kr,Fa,Zn,Ln,On,Lo,Oo,No,Bo,Ze,Pi,Ni,Qn,_6],encapsulation:2,changeDetection:0})}return e})();var ya=class{supabaseGlobal=k(La);supabase=this.supabaseGlobal.supabase;loadingCount=J(0);loading=L(()=>this.loadingCount()>0);flexibleItems=kn({loader:async()=>{let{data:t,error:i}=await this.supabase.from("flexible_items").select("*").order("created_at",{ascending:!1});if(i)throw i;return t||[]}});createItem(t){this.loadingCount.update(i=>i+1),Ve(this.supabase.from("flexible_items").insert({name:t.name,description:t.description||null,user_defined_properties:t.user_defined_properties||{}}).select().single()).pipe(Xe(i=>Ge({error:i})),$e(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.flexibleItems.reload()})}updateItem(t,i){this.loadingCount.update(n=>n+1),Ve(this.supabase.from("flexible_items").update(i).eq("id",t).select().single()).pipe(Xe(n=>Ge({error:n})),$e(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error)throw n.error;this.flexibleItems.reload()})}deleteItem(t){this.loadingCount.update(i=>i+1),Ve(this.supabase.from("flexible_items").delete().eq("id",t)).pipe(Xe(i=>Ge({error:i})),$e(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.flexibleItems.reload()})}deleteItems(t){this.loadingCount.update(i=>i+1),Ve(this.supabase.from("flexible_items").delete().in("id",t)).pipe(Xe(i=>Ge({error:i})),$e(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.flexibleItems.reload()})}addItemToHousePlan(t){this.loadingCount.update(i=>i+1),Ve(this.supabase.from("house_plan_items").insert({house_plan_id:t.house_plan_id,flexible_item_id:t.flexible_item_id,position_x:t.position_x||0,position_y:t.position_y||0,rotation:t.rotation||0,scale:t.scale||1}).select().single()).pipe(Xe(i=>Ge({error:i})),$e(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error})}updateHousePlanItem(t,i){this.loadingCount.update(n=>n+1),Ve(this.supabase.from("house_plan_items").update(i).eq("id",t).select().single()).pipe(Xe(n=>Ge({error:n})),$e(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error)throw n.error})}removeItemFromHousePlan(t){this.loadingCount.update(i=>i+1),Ve(this.supabase.from("house_plan_items").delete().eq("id",t)).pipe(Xe(i=>Ge({error:i})),$e(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error})}getHousePlanItemsResource(t){return kn({params:()=>({planId:t}),loader:async({params:i})=>{let{data:n,error:o}=await this.supabase.from("house_plan_items").select(`
            *,
            item:flexible_item_id (*)
          `).eq("house_plan_id",i.planId);if(o)throw o;return n||[]}})}};var D6=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=ys({type:e});static \u0275inj=bs({})}return e})();var Kie=["viewport"],Yie=["*",[["hlm-select-scroll-up"]],[["brnSelectScrollUp"]],[["brnSelectScrollDown"]],[["hlm-select-scroll-down"]]],Xie=["*","hlm-select-scroll-up","brnSelectScrollUp","brnSelectScrollDown","hlm-select-scroll-down"];function Jie(e,t){e&1&&(ze(0,1),ze(1,2))}function Qie(e,t){e&1&&Mn(0)}function Zie(e,t){e&1&&(ze(0,3),ze(1,4))}function ene(e,t){e&1&&Mn(0)}var tne=[[["hlm-select-trigger"],["","brnSelectTrigger",""]],[["label","hlmLabel",""],["label","brnLabel",""]],"*"],ine=["hlm-select-trigger,[brnSelectTrigger]","label[hlmLabel],label[brnLabel]","*"];function nne(e,t){if(e&1&&(S(0,"label",1),F(1),x()),e&2){let i=I();Qe("id",i.labelId()),E(),we(i.placeholder())}}function one(e,t){e&1&&ze(0,1)}function rne(e,t){e&1&&ze(0,2)}var sne=e=>({$implicit:e});function ane(e,t){if(e&1&&Mn(0,2),e&2){let i,n=I(),o=Ki(5);U("ngTemplateOutlet",((i=n._customPlaceholderTemplate())==null?null:i.templateRef)??o)}}function lne(e,t){if(e&1&&Mn(0,3),e&2){let i,n=I(),o=Ki(3);U("ngTemplateOutlet",((i=n._customValueTemplate())==null?null:i.templateRef)??o)("ngTemplateOutletContext",oc(2,sne,n._select.value()))}}function cne(e,t){if(e&1&&F(0),e&2){let i=I();we(i._value())}}function dne(e,t){if(e&1&&F(0),e&2){let i=I();we(i.placeholder())}}var I6=new bt("BrnSelectContentToken");function une(){return k(I6)}function hne(e){return{provide:I6,useExisting:e}}var A6=new bt("BrnSelectToken");function Vf(){return k(A6)}function pne(e){return{provide:A6,useExisting:e}}var gne=0,vs=(()=>{class e{_select=Vf();_content=une();elementRef=k(Je);id=M(`brn-option-${++gne}`);value=M();_disabled=M(!1,{alias:"disabled",transform:D});get disabled(){return this._disabled()}selected=L(()=>this.value()!==void 0&&this._select.isSelected(this.value()));_active=J(!1);checkedState=L(()=>this.selected()?"checked":"unchecked");dir=this._select.dir;select(){if(!this._disabled()){if(this._select.multiple()){this._select.toggleSelect(this.value());return}this._select.selectOption(this.value())}}getLabel(){return this.elementRef.nativeElement.textContent?.trim()??""}setInactiveStyles(){this._active.set(!1)}activate(){this._disabled()||this._content.setActiveOption(this)}focus(){this.elementRef.nativeElement.focus(),this._active.set(!0)}static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["","brnOption",""]],hostAttrs:["role","option"],hostVars:7,hostBindings:function(n,o){n&1&&V("click",function(){return o.select()})("mouseenter",function(){return o.activate()})("blur",function(){return o.setInactiveStyles()}),n&2&&(ji("id",o.id())("tabIndex",-1),Qe("aria-selected",o.selected())("aria-disabled",o._disabled())("dir",o._select.dir())("data-active",o._active()?"":void 0)("data-disabled",o._disabled()?"":void 0))},inputs:{id:[1,"id"],value:[1,"value"],_disabled:[1,"disabled","_disabled"]}})}return e})(),Hf=100,M6=(()=>{class e{_el=k(Je);_selectContent=k(Jl);_endReached=new qe;_destroyRef=k(To);startEmittingEvents(){let i=$t(this._el.nativeElement,"mouseleave");ws(100).pipe(lt(i),lt(this._endReached),Pa(this._destroyRef)).subscribe(()=>this._selectContent.moveFocusUp())}stopEmittingEvents(){this._endReached.next(!0)}static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["","brnSelectScrollUp",""],["brn-select-scroll-up"],["hlm-select-scroll-up",5,"noHlm"]],hostAttrs:["aria-hidden","true"],hostBindings:function(n,o){n&1&&V("mouseenter",function(){return o.startEmittingEvents()})}})}return e})(),k6=(()=>{class e{_el=k(Je);_selectContent=k(Jl);_endReached=new qe;_destroyRef=k(To);startEmittingEvents(){let i=$t(this._el.nativeElement,"mouseleave");ws(100).pipe(lt(i),lt(this._endReached),Pa(this._destroyRef)).subscribe(()=>this._selectContent.moveFocusDown())}stopEmittingEvents(){this._endReached.next(!0)}static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["","brnSelectScrollDown",""],["brn-select-scroll-down"],["hlm-select-scroll-down",5,"noHlm"]],hostAttrs:["aria-hidden","true"],hostBindings:function(n,o){n&1&&V("mouseenter",function(){return o.startEmittingEvents()})}})}return e})(),Jl=(()=>{class e{_elementRef=k(Je);_injector=k(_a);_select=Vf();_canScrollUp=J(!1);_canScrollDown=J(!1);_viewport=jn.required("viewport");_scrollUpBtn=Kn(M6);_scrollDownBtn=Kn(k6);_options=Ra(vs,{descendants:!0});keyManager=null;constructor(){_e(()=>{this._select.open()&&_r(()=>this.updateArrowDisplay(),{injector:this._injector})})}ngAfterContentInit(){this.keyManager=new Oy(this._options,this._injector).withHomeAndEnd().withVerticalOrientation().withTypeAhead().withWrap().skipPredicate(i=>i.disabled),_e(()=>{let i=this._select.open(),n=this._options();if(!i||!n.length)return;let o=n.find(r=>r.selected());o?_r(()=>{this.keyManager?.setActiveItem(o)},{injector:this._injector}):_r(()=>{this.keyManager?.setFirstItemActive()},{injector:this._injector})},{injector:this._injector})}updateArrowDisplay(){let{scrollTop:i,scrollHeight:n,clientHeight:o}=this._viewport().nativeElement;this._canScrollUp.set(i>0);let r=n-o;this._canScrollDown.set(Math.ceil(i)<r)}handleScroll(){this.updateArrowDisplay()}focusList(){this._elementRef.nativeElement.focus()}moveFocusUp(){this._viewport().nativeElement.scrollBy({top:-Hf,behavior:"smooth"}),this._viewport().nativeElement.scrollTop===0&&this._scrollUpBtn()?.stopEmittingEvents()}moveFocusDown(){this._viewport().nativeElement.scrollBy({top:Hf,behavior:"smooth"});let i=this._elementRef.nativeElement.scrollHeight,n=this._viewport().nativeElement.scrollTop;i+n+Hf>this._viewport().nativeElement.scrollHeight+Hf/2&&this._scrollDownBtn()?.stopEmittingEvents()}setActiveOption(i){let n=this._options().findIndex(o=>o===i);n!==-1&&this.keyManager?.setActiveItem(n)}selectActiveItem(i){i.preventDefault();let n=this.keyManager?.activeItem;n&&this._select.toggleSelect(n.value())}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["brn-select-content"],["hlm-select-content",5,"noHlm"]],contentQueries:function(n,o,r){n&1&&(Ri(r,o._scrollUpBtn,M6,5),Ri(r,o._scrollDownBtn,k6,5),Ri(r,o._options,vs,5)),n&2&&ii(3)},viewQuery:function(n,o){n&1&&$n(o._viewport,Kie,5),n&2&&ii()},hostAttrs:["role","listbox","aria-orientation","vertical"],hostVars:6,hostBindings:function(n,o){n&1&&V("keydown",function(s){return o.keyManager==null?null:o.keyManager.onKeydown(s)})("keydown.enter",function(s){return o.selectActiveItem(s)})("keydown.space",function(s){return o.selectActiveItem(s)}),n&2&&(ji("id",o._select.id()+"--content"),Qe("aria-multiselectable",o._select.multiple())("aria-disabled",o._select.disabled()||o._select.formDisabled())("aria-labelledBy",o._select.labelId())("aria-controlledBy",o._select.id()+"--trigger")("dir",o._select.dir()))},features:[ue([hne(e)])],ngContentSelectors:Xie,decls:9,vars:2,consts:[["scrollUp",""],["viewport",""],["scrollDown",""],[4,"ngTemplateOutlet"],["data-brn-select-viewport","",2,"flex","1 1 0%","position","relative","width","100%","overflow","auto","min-height","36px","padding-bottom","2px","margin-bottom","-2px",3,"scroll"]],template:function(n,o){if(n&1){let r=xe();ct(Yie),Dt(0,Jie,2,0,"ng-template",null,0,_s)(2,Qie,1,0,"ng-container",3),S(3,"div",4,1),V("scroll",function(){return j(r),K(o.handleScroll())}),ze(5),x(),Dt(6,Zie,2,0,"ng-template",null,2,_s)(8,ene,1,0,"ng-container",3)}if(n&2){let r=Ki(1),s=Ki(7);E(2),U("ngTemplateOutlet",o._canScrollUp()&&o._scrollUpBtn()?r:null),E(6),U("ngTemplateOutlet",o._canScrollDown()&&o._scrollDownBtn()?s:null)}},dependencies:[Ps],styles:["[_nghost-%COMP%]{display:flex;box-sizing:border-box;flex-direction:column;outline:none;pointer-events:auto}[data-brn-select-viewport][_ngcontent-%COMP%]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch}[data-brn-select-viewport][_ngcontent-%COMP%]::-webkit-scrollbar{display:none}"],changeDetection:0})}return e})(),fne=0,Gf=(()=>{class e{_defaultErrorStateMatcher=k(Vy);_parentForm=k(A1,{optional:!0});_injector=k(_a);_parentFormGroup=k(kr,{optional:!0});ngControl=k(qf,{optional:!0,self:!0});id=M(`brn-select-${++fne}`);multiple=M(!1,{transform:D});placeholder=M("");disabled=M(!1,{transform:D});dir=M("ltr");closeDelay=M(100,{transform:Fn});open=Yi(!1);value=Yi();valueChange=oe();compareWith=M((i,n)=>i===n);formDisabled=J(!1);_selectLabel=Kn(Kf,{descendants:!1});_selectContent=Kn.required(Jl);options=Ra(vs,{descendants:!0});selectedOptions=L(()=>this.options().filter(i=>i.selected()));_overlayDir=jn.required(cc);trigger=J(null);triggerWidth=J(0);_delayedExpanded=sc(F1(this.open).pipe(xi(i=>i?Ge(i):Ge(i).pipe(Zl(this.closeDelay()))),Pa()),{initialValue:!1});state=L(()=>this.open()?"open":"closed");_positionChanges$=new qe;side=sc(this._positionChanges$.pipe(Rn(i=>i.connectionPair.originY==="center"?i.connectionPair.originX==="start"?"left":"right":i.connectionPair.originY)),{initialValue:"bottom"});labelId=L(()=>this._selectLabel()?.id??`${this.id()}--label`);_onChange=()=>{};_onTouched=()=>{};_positions=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"}];errorStateTracker;errorState=L(()=>this.errorStateTracker.errorState());constructor(){this.ngControl!==null&&(this.ngControl.valueAccessor=this),this.errorStateTracker=new Gy(this._defaultErrorStateMatcher,this.ngControl,this._parentFormGroup,this._parentForm)}ngDoCheck(){this.errorStateTracker.updateErrorState()}toggle(){this.open()?this.hide():this.show()}show(){this.open()||this.disabled()||this.formDisabled()||this.options()?.length==0||this.open.set(!0)}hide(){this.open()&&(this.open.set(!1),this._onTouched(),this.trigger()?.focus())}writeValue(i){this.value.set(i)}registerOnChange(i){this._onChange=i}registerOnTouched(i){this._onTouched=i}setDisabledState(i){this.formDisabled.set(i)}selectOption(i){if(this.multiple()){let n=this.value(),o=n?[...n,i]:[i];this.value.set(o),this.valueChange.emit(o)}else this.value.set(i),this.valueChange.emit(i);this._onChange?.(this.value()),this.multiple()||this.hide()}deselectOption(i){if(this.multiple()){let o=this.value().filter(r=>!this.compareWith()(r,i));this.value.set(o),this.valueChange.emit(o)}else this.value.set(null),this.valueChange.emit(null);this._onChange?.(this.value())}toggleSelect(i){this.isSelected(i)?this.deselectOption(i):this.selectOption(i)}isSelected(i){let n=this.value();return Array.isArray(n)?n.some(o=>this.compareWith()(o,i)):i!==void 0?this.compareWith()(n,i):!1}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["brn-select"],["hlm-select"]],contentQueries:function(n,o,r){n&1&&(Ri(r,o._selectLabel,Kf,4),Ri(r,o._selectContent,Jl,5),Ri(r,o.options,vs,5)),n&2&&ii(3)},viewQuery:function(n,o){n&1&&$n(o._overlayDir,cc,5),n&2&&ii()},inputs:{id:[1,"id"],multiple:[1,"multiple"],placeholder:[1,"placeholder"],disabled:[1,"disabled"],dir:[1,"dir"],closeDelay:[1,"closeDelay"],open:[1,"open"],value:[1,"value"],compareWith:[1,"compareWith"]},outputs:{open:"openChange",value:"valueChange",valueChange:"valueChange"},features:[ue([xu(()=>e),_u(()=>e),pne(e),{provide:Hy,useExisting:Ei(()=>e)}])],ngContentSelectors:ine,decls:6,vars:5,consts:[["trigger","cdkOverlayOrigin"],[2,"display","none"],["cdk-overlay-origin","",3,"click"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"backdropClick","detach","positionChange","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayWidth"]],template:function(n,o){if(n&1){let r=xe();ct(tne),ve(0,nne,2,2,"label",1)(1,one,1,0),S(2,"div",2,0),V("click",function(){return j(r),K(o.toggle())}),ze(4),x(),Dt(5,rne,1,0,"ng-template",3),V("backdropClick",function(){return j(r),K(o.hide())})("detach",function(){return j(r),K(o.hide())})("positionChange",function(a){return j(r),K(o._positionChanges$.next(a))})}if(n&2){let r=Ki(3);Ce(!o._selectLabel()&&o.placeholder()?0:1),E(5),U("cdkConnectedOverlayOrigin",r)("cdkConnectedOverlayOpen",o._delayedExpanded())("cdkConnectedOverlayPositions",o._positions)("cdkConnectedOverlayWidth",o.triggerWidth()>0?o.triggerWidth():"auto")}},dependencies:[Sy,cc,yy,D6],encapsulation:2,changeDetection:0})}return e})();var T6=(()=>{class e{templateRef=k(ic);static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["","brnSelectPlaceholder",""],["","hlmSelectPlaceholder",""]]})}return e})(),L6=(()=>{class e{_elementRef=k(Je);_changeDetector=k(Tn);_select=Vf();_ngControl=k(qf,{optional:!0});_platform=k(xr);_triggerId=L(()=>`${this._select.id()}--trigger`);_contentId=L(()=>`${this._select.id()}--content`);_disabled=L(()=>this._select.disabled()||this._select.formDisabled());_labelledBy=L(()=>{let i=this._select.value();return Array.isArray(i)&&i.length>0?`${this._select.labelId()} ${this._select.id()}--value`:this._select.labelId()});_resizeObserver;_statusChangedSubscription;constructor(){this._select.trigger.set(this)}ngOnInit(){this._ngControl&&(this._statusChangedSubscription=this._ngControl.statusChanges?.subscribe(()=>{this._changeDetector.markForCheck()}))}ngAfterViewInit(){this._select.triggerWidth.set(this._elementRef.nativeElement.offsetWidth),Pr(this._platform)&&(this._resizeObserver=new ResizeObserver(()=>this._select.triggerWidth.set(this._elementRef.nativeElement.offsetWidth)),this._resizeObserver.observe(this._elementRef.nativeElement))}ngOnDestroy(){this._resizeObserver?.disconnect(),this._statusChangedSubscription?.unsubscribe()}focus(){this._elementRef.nativeElement.focus()}static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["","brnSelectTrigger",""]],hostAttrs:["type","button","role","combobox","aria-autocomplete","none"],hostVars:18,hostBindings:function(n,o){n&1&&V("keydown.ArrowDown",function(){return o._select.show()}),n&2&&(ji("disabled",o._disabled()),Qe("id",o._triggerId())("aria-expanded",o._select.open())("aria-controls",o._contentId())("aria-labelledBy",o._labelledBy())("dir",o._select.dir()),dt("ng-invalid",(o._ngControl==null?null:o._ngControl.invalid)||null)("ng-dirty",(o._ngControl==null?null:o._ngControl.dirty)||null)("ng-valid",(o._ngControl==null?null:o._ngControl.valid)||null)("ng-touched",(o._ngControl==null?null:o._ngControl.touched)||null)("ng-untouched",(o._ngControl==null?null:o._ngControl.untouched)||null)("ng-pristine",(o._ngControl==null?null:o._ngControl.pristine)||null))}})}return e})(),F6=(()=>{class e{templateRef=k(ic);static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["","brnSelectValue",""],["","hlmSelectValue",""]]})}return e})(),O6=(()=>{class e{_select=Vf();id=L(()=>`${this._select.id()}--value`);placeholder=L(()=>this._select.placeholder());_showPlaceholder=L(()=>this._value()===null||this._value()===void 0||this._value()==="");_customValueTemplate=Kn(F6,{descendants:!0});_customPlaceholderTemplate=Kn(T6,{descendants:!0});_value=L(()=>{let i=this._values();if(i.length===0)return null;let o=i.filter(s=>this._select.options().some(a=>this._select.compareWith()(a.value(),s))).map(s=>this._select.options().find(a=>this._select.compareWith()(a.value(),s)));if(o.length===0)return null;let r=o.map(s=>s?.getLabel());return this._select.dir()==="rtl"&&r.reverse(),this.transformFn()(r)});_values=L(()=>Array.isArray(this._select.value())?this._select.value():[this._select.value()]);transformFn=M(i=>(i??[]).join(", "));static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["brn-select-value"],["hlm-select-value"]],contentQueries:function(n,o,r){n&1&&(Ri(r,o._customValueTemplate,F6,5),Ri(r,o._customPlaceholderTemplate,T6,5)),n&2&&ii(2)},hostVars:2,hostBindings:function(n,o){n&2&&(ji("id",o.id()),Qe("data-placeholder",o._showPlaceholder()?"":null))},inputs:{transformFn:[1,"transformFn"]},decls:6,vars:1,consts:[["defaultValueTemplate",""],["defaultPlaceholderTemplate",""],[3,"ngTemplateOutlet"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(n,o){n&1&&(ve(0,ane,1,1,"ng-container",2)(1,lne,1,4,"ng-container",3),Dt(2,cne,1,1,"ng-template",null,0,_s)(4,dne,1,1,"ng-template",null,1,_s)),n&2&&Ce(o._showPlaceholder()?0:1)},dependencies:[Ps],styles:["[_nghost-%COMP%]{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;white-space:nowrap;pointer-events:none}"],changeDetection:0})}return e})();var mne=["switch"],vne=()=>({display:"contents"}),Cne=[[["brn-switch-thumb"]]],wne=["brn-switch-thumb"],bne={provide:Dr,useExisting:Ei(()=>cu),multi:!0},c1="-switch",yne=0,cu=(()=>{class e{_destroyRef=k(To);_renderer=k(Fo);_isBrowser=Pr(k(xr));_elementRef=k(Je);_focusMonitor=k(yu);_cdr=k(Tn);_document=k(Li);_focusVisible=J(!1);_focused=J(!1);checked=Yi(!1);checkedChange=oe();id=M(++yne+"");name=M(null);class=M(null);ariaLabel=M(null,{alias:"aria-label"});ariaLabelledby=M(null,{alias:"aria-labelledby"});mutableAriaLabelledby=Rs(()=>this.ariaLabelledby());ariaDescribedby=M(null,{alias:"aria-describedby"});required=M(!1,{transform:D});disabled=M(!1,{transform:D});tabIndex=M(0);touched=oe();_onChange=()=>{};_onTouched=()=>{};switch=jn.required("switch");_state=L(()=>{let i=this.name(),n=this.id();return{disabled:J(this.disabled()),name:i?i+c1:null,id:n?n+c1:null}});constructor(){_e(()=>{let i=this._state(),n=i.disabled();if(!this._elementRef.nativeElement||!this._isBrowser)return;let o=i.id+"-label",r=this.getSwitchButtonId(i.id),s=this._elementRef.nativeElement.closest("label")??this._document.querySelector(`label[for="${r}"]`);if(!s)return;let a=s.id;this._renderer.setAttribute(s,"data-disabled",n?"true":"false"),this.mutableAriaLabelledby.set(a||o),(!a||a.length===0)&&this._renderer.setAttribute(s,"id",o)})}toggle(){this._state().disabled()||(this._onTouched(),this.touched.emit(),this.checked.update(i=>!i),this._onChange(this.checked()),this.checkedChange.emit(this.checked()))}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).pipe(Pa(this._destroyRef)).subscribe(i=>{i&&this._focused.set(!0),(i==="keyboard"||i==="program")&&(this._focusVisible.set(!0),this._cdr.markForCheck()),i||Promise.resolve().then(()=>{this._focusVisible.set(!1),this._focused.set(!1),this._onTouched(),this.touched.emit(),this._cdr.markForCheck()})}),this.switch()&&(this.switch().nativeElement.value=this.checked()?"on":"off",this.switch().nativeElement.dispatchEvent(new Event("change")))}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}getSwitchButtonId(i){return i?i.replace(c1,""):null}writeValue(i){this.checked.set(!!i)}registerOnChange(i){this._onChange=i}registerOnTouched(i){this._onTouched=i}setDisabledState(i){this._state().disabled.set(i),this._cdr.markForCheck()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["brn-switch"]],viewQuery:function(n,o){n&1&&$n(o.switch,mne,5),n&2&&ii()},hostVars:12,hostBindings:function(n,o){n&2&&(Qe("id",o._state().id)("name",o._state().name)("aria-labelledby",null)("aria-label",null)("aria-describedby",null)("data-state",o.checked()?"checked":"unchecked")("data-focus-visible",o._focusVisible())("data-focus",o._focused())("data-disabled",o._state().disabled()),_1(Rr(11,vne)))},inputs:{checked:[1,"checked"],id:[1,"id"],name:[1,"name"],class:[1,"class"],ariaLabel:[1,"aria-label","ariaLabel"],ariaLabelledby:[1,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[1,"aria-describedby","ariaDescribedby"],required:[1,"required"],disabled:[1,"disabled"],tabIndex:[1,"tabIndex"]},outputs:{checked:"checkedChange",checkedChange:"checkedChange",touched:"touched"},features:[ue([bne])],ngContentSelectors:wne,decls:3,vars:15,consts:[["switch",""],["role","switch","type","button",3,"click","id","name","value","disabled","tabIndex"]],template:function(n,o){if(n&1){let r=xe();ct(Cne),Pn(0,"button",1,0),E1("click",function(a){return j(r),a.preventDefault(),K(o.toggle())}),ze(2),Dn()}n&2&&(ce(o.class()),ji("id",o.getSwitchButtonId(o._state().id)??"")("name",o.getSwitchButtonId(o._state().name)??"")("value",o.checked()?"on":"off")("disabled",o._state().disabled())("tabIndex",o.tabIndex()),Qe("aria-checked",o.checked())("aria-label",o.ariaLabel()||null)("aria-labelledby",o.mutableAriaLabelledby()||null)("aria-describedby",o.ariaDescribedby()||null)("data-state",o.checked()?"checked":"unchecked")("data-focus-visible",o._focusVisible())("data-focus",o._focused())("data-disabled",o._state().disabled()))},encapsulation:2,changeDetection:0})}return e})(),B6=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["brn-switch-thumb"]],hostAttrs:["role","presentation"],hostBindings:function(n,o){n&1&&V("click",function(s){return s.preventDefault()})},decls:0,vars:0,template:function(n,o){},encapsulation:2,changeDetection:0})}return e})();var zf=(()=>{class e{userClass=M("",{alias:"class"});stickyLabels=M(!1,{transform:D});_stateProvider=Eu({optional:!0});_sideProvider=Su({optional:!0});_computedClass=L(()=>le("border-border bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 w-full min-w-[8rem] overflow-hidden rounded-md border p-1 shadow-md data-[side=bottom]:top-[2px] data-[side=top]:bottom-[2px]",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["","hlmSelectContent",""],["hlm-select-content"]],hostVars:4,hostBindings:function(n,o){n&2&&(Qe("data-state",(o._stateProvider==null?null:o._stateProvider.state())??"open")("data-side",(o._sideProvider==null?null:o._sideProvider.side())??"bottom"),ce(o._computedClass()))},inputs:{userClass:[1,"class","userClass"],stickyLabels:[1,"stickyLabels"]}})}return e})();var xne=["*"];function Ene(e,t){e&1&&H(0,"ng-icon",1)}var d1=(()=>{class e{_brnSelectOption=k(vs,{host:!0});userClass=M("",{alias:"class"});_computedClass=L(()=>le("data-[active]:bg-accent data-[active]:text-accent-foreground [&>ng-icon]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-none select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2 [&>ng-icon]:pointer-events-none [&>ng-icon]:size-4 [&>ng-icon]:shrink-0",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["hlm-option"]],hostVars:2,hostBindings:function(n,o){n&2&&ce(o._computedClass())},inputs:{userClass:[1,"class","userClass"]},features:[ue([nt({lucideCheck:G1})]),$i([{directive:vs,inputs:["disabled","disabled","value","value"]}])],ngContentSelectors:xne,decls:3,vars:1,consts:[[1,"absolute","right-2","flex","size-3.5","items-center","justify-center"],["hlm","","size","sm","aria-hidden","true","name","lucideCheck"]],template:function(n,o){n&1&&(ct(),S(0,"span",0),ve(1,Ene,1,0,"ng-icon",1),x(),ze(2)),n&2&&(E(),Ce(o._brnSelectOption.selected()?1:-1))},dependencies:[ot,We],encapsulation:2,changeDetection:0})}return e})();var _ne=["*",[["ng-icon"]]],Rne=["*","ng-icon"];function Pne(e,t){e&1&&ze(0,1)}function Dne(e,t){e&1&&H(0,"ng-icon",2)}var Mne=Da("border-input [&>ng-icon]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 [&>ng-icon]:pointer-events-none [&>ng-icon]:size-4 [&>ng-icon]:shrink-0",{variants:{error:{auto:"[&.ng-invalid.ng-touched]:text-destructive [&.ng-invalid.ng-touched]:border-destructive [&.ng-invalid.ng-touched]:focus-visible:ring-destructive/20 dark:[&.ng-invalid.ng-touched]:focus-visible:ring-destructive/40",true:"text-destructive border-destructive focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40"}},defaultVariants:{error:"auto"}}),u1=(()=>{class e{_icon=Kn(We);_brnSelect=k(Gf,{optional:!0});userClass=M("",{alias:"class"});size=M("default");_computedClass=L(()=>le(Mne({error:this._brnSelect?.errorState()}),this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["hlm-select-trigger"]],contentQueries:function(n,o,r){n&1&&Ri(r,o._icon,We,5),n&2&&ii()},inputs:{userClass:[1,"class","userClass"],size:[1,"size"]},features:[ue([nt({lucideChevronDown:vu})])],ngContentSelectors:Rne,decls:5,vars:4,consts:[["button",""],["hlmInput","","brnSelectTrigger","","type","button"],["hlm","","size","sm","name","lucideChevronDown",1,"ml-2","flex-none"]],template:function(n,o){n&1&&(ct(_ne),S(0,"button",1,0),ze(2),ve(3,Pne,1,0)(4,Dne,1,0,"ng-icon",2),x()),n&2&&(ce(o._computedClass()),Qe("data-size",o.size()),E(3),Ce(o._icon()?3:4))},dependencies:[L6,ot,We],encapsulation:2,changeDetection:0})}return e})();var h1=(()=>{class e{userClass=M("",{alias:"class"});_computedClass=L(()=>le("data-[placeholder]:text-muted-foreground line-clamp-1 flex items-center gap-2 truncate",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["hlm-select-value"],["","hlmSelectValue",""],["brn-select-value","hlm",""]],hostVars:2,hostBindings:function(n,o){n&2&&ce(o._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var p1=(()=>{class e{userClass=M("",{alias:"class"});_computedClass=L(()=>le("bg-background dark:group-data-[state=unchecked]:bg-foreground dark:group-data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform group-data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=se({type:e,selectors:[["brn-switch-thumb","hlm",""],["","hlmSwitchThumb",""]],hostVars:2,hostBindings:function(n,o){n&2&&ce(o._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var Tne={provide:Dr,useExisting:Ei(()=>Wf),multi:!0},Wf=(()=>{class e{userClass=M("",{alias:"class"});_computedClass=L(()=>le("data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 group inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] data-[disabled=true]:cursor-not-allowed data-[disabled=true]:opacity-50",this.userClass()));checked=Yi(!1);checkedChange=oe();disabled=M(!1,{transform:D});id=M(null);ariaLabel=M(null,{alias:"aria-label"});ariaLabelledby=M(null,{alias:"aria-labelledby"});ariaDescribedby=M(null,{alias:"aria-describedby"});_disabled=Rs(this.disabled);_onChange;_onTouched;handleChange(i){this.checked.set(i),this._onChange?.(i),this.checkedChange.emit(i)}writeValue(i){this.checked.set(!!i)}registerOnChange(i){this._onChange=i}registerOnTouched(i){this._onTouched=i}setDisabledState(i){this._disabled.set(i)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["hlm-switch"]],hostAttrs:[1,"contents"],hostVars:4,hostBindings:function(n,o){n&2&&Qe("id",null)("aria-label",null)("aria-labelledby",null)("aria-describedby",null)},inputs:{userClass:[1,"class","userClass"],checked:[1,"checked"],disabled:[1,"disabled"],id:[1,"id"],ariaLabel:[1,"aria-label","ariaLabel"],ariaLabelledby:[1,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[1,"aria-describedby","ariaDescribedby"]},outputs:{checked:"checkedChange",checkedChange:"checkedChange"},features:[ue([Tne])],decls:2,vars:8,consts:[[3,"checkedChange","touched","checked","disabled","id","aria-label","aria-labelledby","aria-describedby"],["hlm",""]],template:function(n,o){n&1&&(S(0,"brn-switch",0),V("checkedChange",function(s){return o.handleChange(s)})("touched",function(){return o._onTouched==null?null:o._onTouched()}),H(1,"brn-switch-thumb",1),x()),n&2&&(ce(o._computedClass()),U("checked",o.checked())("disabled",o._disabled())("id",o.id()),S1("aria-label",o.ariaLabel())("aria-labelledby",o.ariaLabelledby())("aria-describedby",o.ariaDescribedby()))},dependencies:[B6,cu,p1],encapsulation:2,changeDetection:0})}return e})();var H6=(e,t)=>t.id;function Ine(e,t){if(e&1){let i=xe();S(0,"button",6),V("click",function(){j(i);let o=I();return K(o.addProperty())}),H(1,"ng-icon",7),F(2),O(3,"transloco"),x()}e&2&&(E(2),de(" ",N(3,1,"propertyEditor.addProperty")," "))}function Ane(e,t){if(e&1){let i=xe();S(0,"button",6),V("click",function(){j(i);let o=I();return K(o.editProperty())}),H(1,"ng-icon",8),F(2),O(3,"transloco"),x()}e&2&&(E(2),de(" ",N(3,1,"propertyEditor.editProperty")," "))}function Lne(e,t){e&1&&(S(0,"div",4),F(1),O(2,"transloco"),x()),e&2&&(E(),de(" ",N(2,1,"propertyEditor.noProperties")," "))}function One(e,t){if(e&1){let i=xe();S(0,"input",13),O(1,"transloco"),V("input",function(o){j(i);let r=I().$implicit,s=I(2);return K(s.updatePropertyValue(r.id,o.target.value))}),x()}if(e&2){let i=I().$implicit;U("value",i.value)("placeholder",N(1,2,"propertyEditor.valuePlaceholder"))}}function Nne(e,t){if(e&1){let i=xe();S(0,"input",30),V("input",function(o){j(i);let r=I().$implicit,s=I(2);return K(s.updatePropertyValue(r.id,o.target.value))}),x()}if(e&2){let i=I().$implicit;U("value",i.value)}}function Bne(e,t){if(e&1){let i=xe();S(0,"input",31),V("input",function(o){j(i);let r=I().$implicit,s=I(2);return K(s.updatePropertyValue(r.id,s.parseNumber(o.target.value)))}),x()}if(e&2){let i=I().$implicit;U("value",i.value)}}function Hne(e,t){if(e&1){let i=xe();S(0,"textarea",32),O(1,"transloco"),V("input",function(o){j(i);let r=I().$implicit,s=I(2);return K(s.updatePropertyValue(r.id,o.target.value))}),x()}if(e&2){let i=I().$implicit;U("value",i.value)("placeholder",N(1,2,"propertyEditor.valuePlaceholder"))}}function Vne(e,t){if(e&1){let i=xe();S(0,"div",29)(1,"brn-switch",33),V("changed",function(o){j(i);let r=I().$implicit,s=I(2);return K(s.updatePropertyValue(r.id,o))}),H(2,"hlm-switch"),x(),S(3,"span",34),F(4),O(5,"transloco"),O(6,"transloco"),x()()}if(e&2){let i=I().$implicit;E(),U("checked",i.value),E(3),de(" ",i.value?N(5,2,"common.yes"):N(6,4,"common.no")," ")}}function Gne(e,t){if(e&1){let i=xe();S(0,"div",9)(1,"div",5)(2,"div",10)(3,"div",11)(4,"label",12),F(5),O(6,"transloco"),x(),S(7,"input",13),O(8,"transloco"),V("input",function(o){let r=j(i).$implicit,s=I(2);return K(s.updatePropertyName(r.id,o.target.value))}),x()(),S(9,"div",14)(10,"label",12),F(11),O(12,"transloco"),x(),S(13,"brn-select",15),V("valueChange",function(o){let r=j(i).$implicit,s=I(2);return K(s.updatePropertyType(r.id,o))}),S(14,"hlm-select-trigger",16),H(15,"hlm-select-value"),x(),S(16,"hlm-select-content")(17,"hlm-option",17),F(18),O(19,"transloco"),x(),S(20,"hlm-option",18),F(21),O(22,"transloco"),x(),S(23,"hlm-option",19),F(24),O(25,"transloco"),x(),S(26,"hlm-option",20),F(27),O(28,"transloco"),x(),S(29,"hlm-option",21),F(30),O(31,"transloco"),x()()()(),S(32,"button",22),V("click",function(){let o=j(i).$implicit,r=I(2);return K(r.removeProperty(o.id))}),H(33,"ng-icon",23),x()(),S(34,"div",24)(35,"label",12),F(36),O(37,"transloco"),x(),ve(38,One,2,4,"input",25)(39,Nne,1,1,"input",26)(40,Bne,1,1,"input",27)(41,Hne,2,4,"textarea",28)(42,Vne,7,6,"div",29),x()()()}if(e&2){let i,n=t.$implicit;E(5),we(N(6,13,"propertyEditor.propertyName")),E(2),U("value",n.name)("placeholder",N(8,15,"propertyEditor.propertyNamePlaceholder")),E(4),we(N(12,17,"propertyEditor.propertyType")),E(2),U("value",n.type)("multiple",!1),E(5),de(" ",N(19,19,"propertyEditor.types.text")," "),E(3),de(" ",N(22,21,"propertyEditor.types.multiline")," "),E(3),de(" ",N(25,23,"propertyEditor.types.url")," "),E(3),de(" ",N(28,25,"propertyEditor.types.number")," "),E(3),de(" ",N(31,27,"propertyEditor.types.boolean")," "),E(6),we(N(37,29,"propertyEditor.propertyValue")),E(2),Ce((i=n.type)==="text"?38:i==="url"?39:i==="number"?40:i==="multiline"?41:i==="boolean"?42:-1)}}function zne(e,t){if(e&1&&(S(0,"div",5),ei(1,Gne,43,31,"div",9,H6),x()),e&2){let i=I();E(),ti(i.propertiesSignal())}}function Wne(e,t){if(e&1&&(F(0),O(1,"transloco"),O(2,"transloco")),e&2){let i=I().$implicit;de(" ",i.value?N(1,1,"common.yes"):N(2,3,"common.no")," ")}}function Une(e,t){if(e&1&&(S(0,"a",36),F(1),x()),e&2){let i=I().$implicit;U("href",i.value,y1),E(),de(" ",i.value," ")}}function qne(e,t){if(e&1&&(S(0,"div",37),F(1),x()),e&2){let i=I().$implicit;E(),we(i.value)}}function $ne(e,t){if(e&1&&F(0),e&2){let i=I().$implicit;de(" ",i.value," ")}}function jne(e,t){if(e&1&&(S(0,"div",24)(1,"label",35),F(2),x(),S(3,"div",34),ve(4,Wne,3,5)(5,Une,2,2,"a",36)(6,qne,2,1,"div",37)(7,$ne,1,1),x()()),e&2){let i,n=t.$implicit;E(2),we(n.name),E(2),Ce((i=n.type)==="boolean"?4:i==="url"?5:i==="multiline"?6:7)}}function Kne(e,t){if(e&1&&(S(0,"div",0),ei(1,jne,8,2,"div",24,H6),x()),e&2){let i=I();E(),ti(i.propertiesSignal())}}var V6=(()=>{class e{initialValue=M(null);mode=Yi("edit");valueChange=oe();properties=J([]);constructor(){_e(()=>{let i=this.initialValue();if(console.log("Initial value for PropertyEditorComponent:",i),i){if(Array.isArray(i))this.properties.set(i);else if(typeof i=="object"){let n=[];Object.entries(i).forEach(([o,r])=>{n.push({id:this.generateId(),name:o,type:this.inferType(r),value:r})}),this.properties.set(n)}}else this.properties.set([])})}propertiesSignal=L(()=>this.properties());inferType(i){return typeof i=="boolean"?"boolean":typeof i=="number"?"number":typeof i=="string"?i.includes(`
`)?"multiline":i.startsWith("http://")||i.startsWith("https://")?"url":"text":"text"}generateId(){return`prop-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}addProperty(){this.properties.update(i=>[...i,{id:this.generateId(),name:"",type:"text",value:""}])}editProperty(){this.mode.set("edit")}removeProperty(i){this.properties.update(n=>n.filter(o=>o.id!==i)),this.emitChanges()}updatePropertyName(i,n){this.properties.update(o=>o.map(r=>r.id===i?z(b({},r),{name:n}):r)),this.emitChanges()}updatePropertyType(i,n){let o=n;this.properties.update(r=>r.map(s=>{if(s.id===i){let a=s.value;switch(o){case"boolean":a=!!s.value;break;case"number":a=Number(s.value)||0;break;case"text":case"multiline":case"url":a=String(s.value||"");break}return z(b({},s),{type:o,value:a})}return s})),this.emitChanges()}updatePropertyValue(i,n){this.properties.update(o=>o.map(r=>r.id===i?z(b({},r),{value:n}):r)),this.emitChanges()}parseNumber(i){return Number(i)||0}emitChanges(){let i=this.properties().filter(n=>n.name.trim());this.valueChange.emit(i)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["gh-property-editor"]],inputs:{initialValue:[1,"initialValue"],mode:[1,"mode"]},outputs:{mode:"modeChange",valueChange:"valueChange"},features:[ue([nt({lucidePlus:Jn,lucideTrash:ln,lucidePen:ny})])],decls:10,vars:7,consts:[[1,"space-y-4"],[1,"flex","justify-between","items-center"],[1,"text-sm","font-medium"],["hlmBtn","","variant","outline","size","sm","type","button"],[1,"text-sm","text-muted-foreground","text-center","py-8","border","border-dashed","rounded-md"],[1,"space-y-3"],["hlmBtn","","variant","outline","size","sm","type","button",3,"click"],["hlm","","name","lucidePlus","size","sm"],["hlm","","name","lucidePen","size","sm"],["hlmCard","",1,"p-4"],[1,"flex","gap-2","items-end"],[1,"flex-1","space-y-1"],["hlmLabel","",1,"text-xs"],["hlmInput","","type","text",1,"text-sm",3,"input","value","placeholder"],[1,"w-40","space-y-1"],[1,"w-full",3,"valueChange","value","multiple"],[1,"w-full"],["value","text"],["value","multiline"],["value","url"],["value","number"],["value","boolean"],["hlmBtn","","variant","ghost","size","icon","type","button",1,"shrink-0",3,"click"],["hlm","","name","lucideTrash","size","sm"],[1,"space-y-1"],["hlmInput","","type","text",1,"text-sm",3,"value","placeholder"],["hlmInput","","type","url","placeholder","https://example.com",1,"text-sm",3,"value"],["hlmInput","","type","number","placeholder","0",1,"text-sm",3,"value"],["hlmTextarea","","rows","3",1,"text-sm",3,"value","placeholder"],[1,"flex","items-center","gap-2","pt-1"],["hlmInput","","type","url","placeholder","https://example.com",1,"text-sm",3,"input","value"],["hlmInput","","type","number","placeholder","0",1,"text-sm",3,"input","value"],["hlmTextarea","","rows","3",1,"text-sm",3,"input","value","placeholder"],[1,"flex-shrink-0",3,"changed","checked"],[1,"text-sm","text-muted-foreground"],["hlmLabel","",1,"text-sm","font-medium"],["target","_blank","rel","noopener noreferrer",1,"text-primary","hover:underline",3,"href"],[1,"whitespace-pre-wrap"]],template:function(n,o){n&1&&(S(0,"div",0)(1,"div",1)(2,"h4",2),F(3),O(4,"transloco"),x(),ve(5,Ine,4,3,"button",3)(6,Ane,4,3,"button",3),x(),ve(7,Lne,3,3,"div",4),ve(8,zne,3,0,"div",5),ve(9,Kne,3,0,"div",0),x()),n&2&&(E(3),de(" ",N(4,5,"propertyEditor.title")," "),E(2),Ce(o.mode()==="edit"?5:6),E(2),Ce(o.propertiesSignal().length===0?7:-1),E(),Ce(o.mode()==="edit"?8:-1),E(),Ce(o.mode()==="view"?9:-1))},dependencies:[Tr,Yt,ot,Gf,Jl,O6,cu,Ze,iS,We,Pi,Ni,zf,u1,d1,h1,Wf,Zy,Kt],encapsulation:2})}return e})();function Yne(e,t){e&1&&(S(0,"p",12),F(1),O(2,"transloco"),x()),e&2&&(E(),we(N(2,1,"flexibleItems.dialog.nameRequired")))}function Xne(e,t){if(e&1){let i=xe();S(0,"hlm-sheet-content",2)(1,"hlm-sheet-header")(2,"h3",3),F(3),O(4,"transloco"),x(),S(5,"p",4),F(6),O(7,"transloco"),x()(),S(8,"form",5),V("ngSubmit",function(){j(i);let o=I();return K(o.onSubmit())}),S(9,"div",6),H(10,"gh-icon-picker",7),x(),S(11,"div",8)(12,"div",9)(13,"label",10),F(14),O(15,"transloco"),x(),H(16,"input",11),O(17,"transloco"),ve(18,Yne,3,3,"p",12),x()(),S(19,"div",13)(20,"label",14),F(21),O(22,"transloco"),x(),S(23,"gh-tiptap-editor",15),V("contentChange",function(o){j(i);let r=I();return r.form.controls.description.setValue(o),r.form.controls.description.markAsDirty(),K(r.form.controls.description.markAsTouched())}),x(),S(24,"p",16),F(25),O(26,"transloco"),x()(),S(27,"div",13)(28,"gh-property-editor",17),V("valueChange",function(o){j(i);let r=I();return r.form.controls.userProperties.setValue(o),r.form.controls.userProperties.markAsDirty(),K(r.form.controls.userProperties.markAsTouched())}),x()()(),S(29,"hlm-sheet-footer",18)(30,"button",19),V("click",function(){j(i);let o=I();return K(o.onCancel())}),F(31),O(32,"transloco"),x(),S(33,"button",20),V("click",function(){j(i);let o=I();return K(o.onSubmit())}),F(34),O(35,"transloco"),x()()()}if(e&2){let i=I();E(3),we(N(4,14,i.dialogTitle())),E(3),de(" ",N(7,16,"flexibleItems.dialog.description")," "),E(2),U("formGroup",i.form),E(6),we(N(15,18,"flexibleItems.dialog.nameLabel")),E(2),U("placeholder",N(17,20,"flexibleItems.dialog.namePlaceholder")),E(2),Ce(i.form.controls.name.invalid&&i.form.controls.name.touched?18:-1),E(3),we(N(22,22,"flexibleItems.dialog.descriptionLabel")),E(2),U("initialContent",i.form.controls.description.value),E(2),we(N(26,24,"flexibleItems.dialog.descriptionHint")),E(3),U("mode","view")("initialValue",i.form.controls.userProperties.value),E(3),de(" ",N(32,26,"common.cancel")," "),E(2),U("disabled",i.form.invalid),E(),de(" ",N(35,28,"common.save")," ")}}var G6=(()=>{class e{service=k(ya);state=M.required();item=M(null);stateChanged=oe();form=new ka({name:new In("",{nonNullable:!0,validators:[Mr.required]}),description:new In("",{nonNullable:!0}),userProperties:new In(null,{nonNullable:!0}),icon:new In("lucideBox",{nonNullable:!0})});dialogTitle=L(()=>this.item()?"flexibleItems.dialog.editTitle":"flexibleItems.dialog.addTitle");constructor(){_e(()=>{let i=this.item();console.log("Current Item changed:",i),i?this.form.patchValue({name:i.name,description:i.description||"",userProperties:i.user_defined_properties||null,icon:i.icon||"lucideBox"}):this.form.reset({name:"",description:"",userProperties:null,icon:"lucideBox"})})}onSubmit(){if(this.form.invalid)return;let i=this.form.value,n=i.userProperties&&i.userProperties.length>0?i.userProperties:void 0,o=this.item();o?this.service.updateItem(o.id,{name:i.name,description:i.description||void 0,icon:i.icon||void 0,user_defined_properties:n}):this.service.createItem({name:i.name,description:i.description||void 0,icon:i.icon||void 0,user_defined_properties:n}),this.stateChanged.emit("closed")}onCancel(){this.stateChanged.emit("closed")}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["gh-flexible-item-dialog"]],inputs:{state:[1,"state"],item:[1,"item"]},outputs:{stateChanged:"stateChanged"},features:[ue([nt(ac)])],decls:2,vars:1,consts:[["side","right",3,"stateChanged","state"],["class","w-full sm:max-w-3xl",4,"brnSheetContent"],[1,"w-full","sm:max-w-3xl"],["hlmSheetTitle",""],["hlmSheetDescription",""],[1,"space-y-6","p-4","overflow-y-auto","max-h-[calc(100vh-200px)]",3,"ngSubmit","formGroup"],[1,"flex","justify-center","items-center"],["formControlName","icon"],[1,"flex","gap-2","items-center","w-full"],[1,"space-y-2","flex-1"],["hlmLabel","","for","name"],["hlmInput","","id","name","type","text","formControlName","name","required","",3,"placeholder"],[1,"text-sm","text-destructive"],[1,"space-y-2"],["hlmLabel",""],["minHeight","200px",3,"contentChange","initialContent"],[1,"text-xs","text-muted-foreground"],[3,"valueChange","mode","initialValue"],[1,"flex","justify-end","gap-2"],["hlmBtn","","variant","outline","type","button",3,"click"],["hlmBtn","","variant","default","type","button",3,"click","disabled"]],template:function(n,o){n&1&&(S(0,"hlm-sheet",0),V("stateChanged",function(s){return o.stateChanged.emit(s)}),Dt(1,Xne,36,30,"hlm-sheet-content",1),x()),n&2&&U("state",o.state())},dependencies:[Ia,Ta,Yn,Xn,Ma,O1,kr,Fa,Yt,Zn,Ln,On,Lo,Oo,No,Bo,Ze,Pi,Ni,XT,np,V6,Kt],encapsulation:2,changeDetection:0})}return e})();function Jne(e,t){e&1&&(S(0,"div",8),H(1,"hlm-spinner",11),x())}function Qne(e,t){if(e&1){let i=xe();S(0,"div",9)(1,"ag-grid-angular",12),V("gridReady",function(o){j(i);let r=I();return K(r.onGridReady(o))}),x()()}if(e&2){let i=I();E(),U("rowData",i.items())("columnDefs",i.columnDefs)("defaultColDef",i.defaultColDef)("rowSelection",i.rowSelection)("theme",i.theme)}}Jp.registerModules([cg]);var z6=(()=>{class e{theme=og;service=k(ya);gridApi=J(null);sheetState=J("closed");editingItem=J(null);items=L(()=>this.service.flexibleItems.value()||[]);loading=L(()=>this.service.flexibleItems.isLoading()||this.service.loading());columnDefs=[{field:"name",headerName:"Name",flex:1,minWidth:200},{field:"description",headerName:"Beschreibung",flex:2,minWidth:250,valueFormatter:i=>{if(!i.value)return"";let n=document.createElement("div");return n.innerHTML=i.value,n.textContent||n.innerText||""}},{field:"user_defined_properties",headerName:"Eigenschaften",flex:1,minWidth:150,valueFormatter:i=>!i.value||Object.keys(i.value).length===0?"-":`${Object.keys(i.value).length} Eigenschaften`},{field:"created_at",headerName:"Erstellt am",width:180,valueFormatter:i=>i.value?new Date(i.value).toLocaleDateString("de-DE"):""},{headerName:"Aktionen",width:100,cellRenderer:ga,cellRendererParams:{actions:[{icon:"lucidePencil",variant:"ghost",action:i=>this.editItem(i)}]},sortable:!1,filter:!1}];defaultColDef={sortable:!0,filter:!0,resizable:!0};rowSelection="multiple";onGridReady(i){this.gridApi.set(i.api)}addItem(){this.editingItem.set(null),this.sheetState.set("open")}editItem(i){this.editingItem.set(i),this.sheetState.set("open")}deleteSelectedItems(){let i=this.gridApi();if(!i)return;let n=i.getSelectedRows();if(n.length===0){alert("Bitte w\xE4hlen Sie mindestens ein Element aus.");return}if(confirm(`M\xF6chten Sie wirklich ${n.length} Element(e) l\xF6schen?`)){let o=n.map(r=>r.id);this.service.deleteItems(o)}}onSheetStateChanged(i){this.sheetState.set(i),i==="closed"&&this.editingItem.set(null)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["gh-flexible-items"]],features:[ue([ya,nt({lucidePlus:Jn,lucideTrash:ln,lucidePencil:Aa})])],decls:17,vars:15,consts:[[1,"p-4","md:p-6","space-y-6"],[1,"flex","flex-col","space-y-4"],[3,"title","description"],[1,"flex","flex-wrap","gap-2"],["hlmBtn","","variant","default",3,"click"],["hlm","","name","lucidePlus","size","sm",1,"mr-2"],["hlmBtn","","variant","destructive",3,"click"],["hlm","","name","lucideTrash","size","sm",1,"mr-2"],[1,"flex","justify-center","p-8"],[1,"h-[600px]","w-full"],[3,"stateChanged","state","item"],["size","large"],[1,"w-full","h-full",3,"gridReady","rowData","columnDefs","defaultColDef","rowSelection","theme"]],template:function(n,o){n&1&&(S(0,"div",0)(1,"div",1),H(2,"gh-section-header",2),O(3,"transloco"),O(4,"transloco"),S(5,"div",3)(6,"button",4),V("click",function(){return o.addItem()}),H(7,"ng-icon",5),F(8),O(9,"transloco"),x(),S(10,"button",6),V("click",function(){return o.deleteSelectedItems()}),H(11,"ng-icon",7),F(12),O(13,"transloco"),x()()(),ve(14,Jne,2,0,"div",8)(15,Qne,2,5,"div",9),x(),S(16,"gh-flexible-item-dialog",10),V("stateChanged",function(s){return o.onSheetStateChanged(s)}),x()),n&2&&(E(2),U("title",N(3,7,"flexibleItems.title"))("description",N(4,9,"flexibleItems.description")),E(6),de(" ",N(9,11,"flexibleItems.addNew")," "),E(4),de(" ",N(13,13,"flexibleItems.deleteSelected")," "),E(2),Ce(o.loading()?14:15),E(2),U("state",o.sheetState())("item",o.editingItem()))},dependencies:[ui,Tl,Ze,Qn,We,ot,Yt,eo,G6,Kt],encapsulation:2,changeDetection:0})}return e})();var Zne=()=>["image/*","application/pdf",".doc",".docx",".xls",".xlsx"],W6=(()=>{class e{initialEditorContent='<h1>Welcome to Tiptap Editor!</h1><p>This is a basic example with <strong>bold</strong>, <em>italic</em>, and <a href="https://tiptap.dev">links</a>.</p><h2>Features:</h2><ul><li>Text formatting (bold, italic, strike)</li><li>Headings (H1, H2)</li><li>Lists (ordered & unordered)</li><li>Blockquotes</li><li>Code blocks</li><li>Links</li></ul>';onEditorContentChange(i){console.log("Editor content changed:",i)}onUploadComplete(i){console.log("Files uploaded successfully:",i)}onUploadError(i){console.error("Upload error:",i)}onFilesAdded(i){console.log(`${i} files added to upload queue`)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["gh-home-dashboard"]],decls:54,vars:47,consts:[[1,"p-4","md:p-6","space-y-4"],[3,"title"],[1,"grid","gap-4","md:grid-cols-2","lg:grid-cols-3"],[1,"space-y-2"],[1,"text-lg","font-semibold"],[1,"text-sm","text-muted-foreground"],[1,"text-2xl","font-semibold","pt-2"],["hlmSeparator","",1,"my-6"],[1,"space-y-4","flex","flex-col"],[1,"flex","items-center","justify-between"],["hlmBtn","","variant","outline","size","sm"],[1,"h-96","border","rounded-md","p-4","flex","items-center","justify-center","text-muted-foreground"],[1,"flex","flex-col","space-y-4"],[3,"title","description"],[3,"uploadComplete","uploadError","filesAdded","maxFileSize","maxNumberOfFiles","allowedFileTypes"],[3,"contentChange","initialContent"]],template:function(n,o){n&1&&(S(0,"div",0),H(1,"gh-section-header",1),O(2,"transloco"),S(3,"div",2)(4,"div",3)(5,"h3",4),F(6),O(7,"transloco"),x(),S(8,"p",5),F(9),O(10,"transloco"),x(),S(11,"p",6),F(12,"0"),x()(),S(13,"div",3)(14,"h3",4),F(15),O(16,"transloco"),x(),S(17,"p",5),F(18),O(19,"transloco"),x(),S(20,"p",6),F(21,"0"),x()(),S(22,"div",3)(23,"h3",4),F(24),O(25,"transloco"),x(),S(26,"p",5),F(27),O(28,"transloco"),x(),S(29,"p",6),F(30,"0"),x()()(),H(31,"div",7),S(32,"div",8)(33,"div",9),H(34,"gh-section-header",1),O(35,"transloco"),S(36,"button",10),F(37),O(38,"transloco"),x()(),S(39,"div",11),F(40),O(41,"transloco"),x()(),H(42,"div",7),S(43,"div",12),H(44,"gh-section-header",13),O(45,"transloco"),O(46,"transloco"),S(47,"gh-file-upload",14),V("uploadComplete",function(s){return o.onUploadComplete(s)})("uploadError",function(s){return o.onUploadError(s)})("filesAdded",function(s){return o.onFilesAdded(s)}),x()(),H(48,"div",7),S(49,"div",12),H(50,"gh-section-header",13),O(51,"transloco"),O(52,"transloco"),S(53,"gh-tiptap-editor",15),V("contentChange",function(s){return o.onEditorContentChange(s)}),x()()()),n&2&&(E(),U("title",N(2,18,"homeDocumentation.title")),E(5),we(N(7,20,"homeDocumentation.overview")),E(3),we(N(10,22,"homeDocumentation.overviewDesc")),E(6),we(N(16,24,"homeDocumentation.items")),E(3),we(N(19,26,"homeDocumentation.itemsDesc")),E(6),we(N(25,28,"homeDocumentation.categories")),E(3),we(N(28,30,"homeDocumentation.categoriesDesc")),E(7),U("title",N(35,32,"homeDocumentation.dataGrid")),E(3),de(" ",N(38,34,"common.add")," "),E(3),de(" ",N(41,36,"homeDocumentation.gridPlaceholder")," "),E(4),U("title",N(45,38,"homeDocumentation.fileUpload"))("description",N(46,40,"homeDocumentation.fileUploadDesc")),E(3),U("maxFileSize",10485760)("maxNumberOfFiles",10)("allowedFileTypes",Rr(46,Zne)),E(3),U("title",N(51,42,"homeDocumentation.editor"))("description",N(52,44,"homeDocumentation.editorDesc")),E(3),U("initialContent",o.initialEditorContent))},dependencies:[ui,Fr,Ze,Yt,np,oS,eo,Kt],encapsulation:2,changeDetection:0})}return e})();var Cs=class{supabaseGlobal=k(La);authService=k(zy);supabase=this.supabaseGlobal.supabase;loadingCount=J(0);loading=L(()=>this.loadingCount()>0);plans=kn({loader:async()=>{let{data:t,error:i}=await this.supabase.from("house_plans").select("*").order("created_at",{ascending:!1});if(i)throw i;return t||[]}});planIdSignal=J(null);currentPlan=kn({params:()=>({planId:this.planIdSignal()}),loader:async({params:t})=>{if(!t.planId)return null;let{data:i,error:n}=await this.supabase.from("house_plans").select("*").eq("id",t.planId).single();if(n)throw n;return i}});currentPlanWalls=kn({params:()=>({planId:this.planIdSignal()}),loader:async({params:t})=>{if(!t.planId)return[];let{data:i,error:n}=await this.supabase.from("house_plan_walls").select("*").eq("house_plan_id",t.planId).order("created_at",{ascending:!0});if(n)throw n;return i||[]}});loadPlan(t){this.planIdSignal.set(t)}createPlan(t){this.loadingCount.update(n=>n+1);let i=this.authService.user()?.id;if(!i){console.error("User not authenticated"),this.loadingCount.update(n=>n-1);return}Ve(this.supabase.from("house_plans").insert({user_id:i,name:t.name,description:t.description||null,scale:t.scale||20}).select().single()).pipe(Xe(n=>(console.error("Error creating plan:",n),Ge({error:n}))),$e(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error){console.error("Failed to create plan:",n.error);return}this.plans.reload()})}updatePlan(t,i){this.loadingCount.update(n=>n+1),Ve(this.supabase.from("house_plans").update(i).eq("id",t).select().single()).pipe(Xe(n=>(console.error("Error updating plan:",n),Ge({error:n}))),$e(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error){console.error("Failed to update plan:",n.error);return}this.plans.reload(),this.planIdSignal()===t&&this.currentPlan.reload()})}deletePlan(t){this.loadingCount.update(i=>i+1),Ve(this.supabase.from("house_plans").delete().eq("id",t)).pipe(Xe(i=>(console.error("Error deleting plan:",i),Ge({error:i}))),$e(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error){console.error("Failed to delete plan:",i.error);return}this.plans.reload()})}clearCurrentPlan(){this.planIdSignal.set(null)}createWall(t){this.loadingCount.update(i=>i+1),Ve(this.supabase.from("house_plan_walls").insert({house_plan_id:t.house_plan_id,wall_structure_id:t.wall_structure_id||null,name:t.name||null,start_x:t.start_x,start_y:t.start_y,end_x:t.end_x,end_y:t.end_y,color:t.color||"#000000"}).select().single()).pipe(Xe(i=>(console.error("Error creating wall:",i),Ge({error:i}))),$e(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error){console.error("Failed to create wall:",i.error);return}this.planIdSignal()===t.house_plan_id&&this.currentPlanWalls.reload()})}updateWall(t,i){this.loadingCount.update(n=>n+1),Ve(this.supabase.from("house_plan_walls").update(i).eq("id",t).select().single()).pipe(Xe(n=>(console.error("Error updating wall:",n),Ge({error:n}))),$e(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error){console.error("Failed to update wall:",n.error);return}this.currentPlanWalls.reload()})}deleteWall(t){this.loadingCount.update(i=>i+1),Ve(this.supabase.from("house_plan_walls").delete().eq("id",t)).pipe(Xe(i=>(console.error("Error deleting wall:",i),Ge({error:i}))),$e(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error){console.error("Failed to delete wall:",i.error);return}this.currentPlanWalls.reload()})}deleteWalls(t){this.loadingCount.update(i=>i+1),Ve(this.supabase.from("house_plan_walls").delete().in("id",t)).pipe(Xe(i=>(console.error("Error deleting walls:",i),Ge({error:i}))),$e(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error){console.error("Failed to delete walls:",i.error);return}this.currentPlanWalls.reload()})}};var eoe=()=>[],toe=(e,t)=>t.id;function ioe(e,t){e&1&&(S(0,"div",1),H(1,"hlm-spinner",5),x())}function noe(e,t){if(e&1){let i=xe();S(0,"div",2)(1,"p"),F(2),O(3,"transloco"),x(),S(4,"button",6),V("click",function(){j(i);let o=I();return K(o.goBack())}),H(5,"ng-icon",7),F(6),O(7,"transloco"),x()()}if(e&2){let i=I();E(2),Io("",N(3,3,"common.error"),": ",i.plansService.currentPlan.error()),E(4),de(" ",N(7,5,"common.back")," ")}}function ooe(e,t){e&1&&(S(0,"p",39),F(1),O(2,"transloco"),x()),e&2&&(E(),we(N(2,1,"housePlan.noWalls")))}function roe(e,t){e&1&&(F(0),O(1,"transloco")),e&2&&de(" \u2022 ",N(1,1,"housePlan.structureDefined")," ")}function soe(e,t){if(e&1){let i=xe();S(0,"div",42),V("click",function(){let o=j(i).$implicit,r=I(3);return K(r.onWallClick(o.id))}),S(1,"div")(2,"p",43),F(3),x(),S(4,"p",33),F(5),O(6,"transloco"),ve(7,roe,2,3),x()(),S(8,"button",10),V("click",function(o){return j(i),I(3).deleteSelectedWall(),K(o.stopPropagation())}),H(9,"ng-icon",44),x()()}if(e&2){let i=t.$implicit,n=I(3);dt("bg-accent",n.selectedWallId()===i.id),E(3),we(i.name||"Unnamed Wall"),E(2),Io(" ",N(6,6,"housePlan.thickness"),": ",i.thickness," cm "),E(2),Ce(i.wall_structure_id?7:-1)}}function aoe(e,t){if(e&1&&(S(0,"div",40),ei(1,soe,10,8,"div",41,toe),x()),e&2){let i=I(2);E(),ti(i.walls())}}function loe(e,t){if(e&1){let i=xe();S(0,"div",8)(1,"div",9)(2,"button",10),V("click",function(){j(i);let o=I();return K(o.goBack())}),H(3,"ng-icon",11),x(),S(4,"div")(5,"h1",12),F(6),O(7,"transloco"),x(),S(8,"p",13),F(9),O(10,"transloco"),x()()(),S(11,"div",14)(12,"button",15),V("click",function(){j(i);let o=I();return K(o.clearAll())}),H(13,"ng-icon",16),F(14),O(15,"transloco"),x(),S(16,"button",17),V("click",function(){j(i);let o=I();return K(o.savePlan())}),H(17,"ng-icon",18),F(18),O(19,"transloco"),x()()(),S(20,"div",19)(21,"div",20),H(22,"gh-section-header",21),O(23,"transloco"),S(24,"div")(25,"div",22)(26,"button",23),V("click",function(){j(i);let o=I();return K(o.setDrawingMode("select"))}),H(27,"ng-icon",24),F(28),O(29,"transloco"),x(),S(30,"button",23),V("click",function(){j(i);let o=I();return K(o.setDrawingMode("draw"))}),H(31,"ng-icon",25),F(32),O(33,"transloco"),x(),S(34,"button",23),V("click",function(){j(i);let o=I();return K(o.setDrawingMode("move"))}),H(35,"ng-icon",26),F(36),O(37,"transloco"),x(),S(38,"button",23),V("click",function(){j(i);let o=I();return K(o.setDrawingMode("delete"))}),H(39,"ng-icon",16),F(40),O(41,"transloco"),x()(),S(42,"div",27)(43,"p",28),F(44),O(45,"transloco"),x(),S(46,"div",22)(47,"button",29),V("click",function(){j(i);let o=I();return K(o.zoomIn())}),H(48,"ng-icon",30),F(49),O(50,"transloco"),x(),S(51,"button",29),V("click",function(){j(i);let o=I();return K(o.zoomOut())}),H(52,"ng-icon",31),F(53),O(54,"transloco"),x(),S(55,"button",29),V("click",function(){j(i);let o=I();return K(o.resetZoom())}),H(56,"ng-icon",32),F(57),O(58,"transloco"),x()()(),S(59,"div",27)(60,"p",28),F(61),O(62,"transloco"),x(),S(63,"p",33),F(64),O(65,"transloco"),x(),S(66,"p",33),F(67),O(68,"transloco"),x(),S(69,"p",33),F(70),O(71,"transloco"),x()()()(),S(72,"div",34),H(73,"gh-section-header",35),O(74,"transloco"),O(75,"transloco"),O(76,"transloco"),O(77,"transloco"),O(78,"transloco"),S(79,"div",36)(80,"gh-house-plan-canvas",37),Es("wallsChange",function(o){j(i);let r=I();return xs(r.walls,o)||(r.walls=o),K(o)}),V("wallClicked",function(o){j(i);let r=I();return K(r.onWallClick(o))})("wallCreated",function(o){j(i);let r=I();return K(r.onWallCreated(o))})("wallMoved",function(o){j(i);let r=I();return K(r.onWallMoved(o))})("stagePositionChanged",function(o){j(i);let r=I();return K(r.onStagePositionChanged(o))}),x()()()(),S(81,"div",38),H(82,"gh-section-header",35),O(83,"transloco"),O(84,"transloco"),S(85,"div"),ve(86,ooe,3,3,"p",39)(87,aoe,3,0,"div",40),x()()}if(e&2){let i,n=I();E(6),de(" ",((i=n.plansService.currentPlan.value())==null?null:i.name)||N(7,40,"housePlan.title")," "),E(3),we(N(10,42,"housePlan.subtitle")),E(5),de(" ",N(15,44,"common.clear")," "),E(2),U("disabled",n.plansService.loading()),E(2),de(" ",N(19,46,"common.save")," "),E(4),U("title",N(23,48,"housePlan.tools")),E(4),U("variant",n.drawingMode()==="select"?"default":"outline"),E(2),de(" ",N(29,50,"housePlan.select")," "),E(2),U("variant",n.drawingMode()==="draw"?"default":"outline"),E(2),de(" ",N(33,52,"housePlan.drawWall")," "),E(2),U("variant",n.drawingMode()==="move"?"default":"outline"),E(2),de(" ",N(37,54,"housePlan.move")," "),E(2),U("variant",n.drawingMode()==="delete"?"destructive":"outline"),E(2),de(" ",N(41,56,"housePlan.delete")," "),E(4),we(N(45,58,"housePlan.zoom")),E(3),U("disabled",n.zoom()>=n.maxZoom),E(2),de(" ",N(50,60,"housePlan.zoomIn")," "),E(2),U("disabled",n.zoom()<=n.minZoom),E(2),de(" ",N(54,62,"housePlan.zoomOut")," "),E(2),U("disabled",n.zoom()===1&&n.stagePosition().x===0&&n.stagePosition().y===0),E(2),de(" ",N(58,64,"housePlan.resetZoom")," "),E(4),we(N(62,66,"housePlan.stats")),E(3),Io("",N(65,68,"housePlan.wallCount"),": ",n.walls().length),E(3),Io("",N(68,70,"housePlan.scale"),": 1:",100/n.scale()),E(3),Io(" ",N(71,72,"housePlan.zoomLevel"),": ",(n.zoom()*100).toFixed(0),"% "),E(3),U("title",N(74,74,"housePlan.canvas"))("description",n.drawingMode()==="draw"?N(75,76,"housePlan.drawInstructions"):n.drawingMode()==="select"?N(76,78,"housePlan.selectInstructions"):n.drawingMode()==="move"?N(77,80,"housePlan.moveInstructions"):N(78,82,"housePlan.deleteInstructions")),E(7),U("canvasWidth",n.canvasWidth)("canvasHeight",n.canvasHeight)("gridSize",n.gridSize)("drawingMode",n.drawingMode())("zoom",n.zoom())("stagePosition",n.stagePosition()),Ss("walls",n.walls),E(2),U("title",N(83,84,"housePlan.wallList"))("description",N(84,86,"housePlan.wallListDesc")),E(4),Ce(n.walls().length===0?86:87)}}function coe(e,t){if(e&1){let i=xe();S(0,"div",51)(1,"span",54),F(2),x(),S(3,"button",55),V("click",function(){j(i);let o=I(2);return K(o.clearWallStructure())}),H(4,"ng-icon",44),x()()}if(e&2){let i=I(2);E(2),we(i.selectedWallStructure().name)}}function doe(e,t){e&1&&(S(0,"p",57),F(1),O(2,"transloco"),x()),e&2&&(E(),de("",N(2,1,"common.loading"),"..."))}function uoe(e,t){e&1&&(S(0,"p",57),F(1),O(2,"transloco"),x()),e&2&&(E(),we(N(2,1,"housePlan.noStructuresAvailable")))}function hoe(e,t){if(e&1){let i=xe();S(0,"hlm-autocomplete",56),O(1,"transloco"),Es("searchChange",function(o){j(i);let r=I(2);return xs(r.wallStructureSearch,o)||(r.wallStructureSearch=o),K(o)}),V("valueChange",function(o){j(i);let r=I(2);return K(r.handleWallStructureSelection(o))}),x(),ve(2,doe,3,3,"p",57)(3,uoe,3,3,"p",57)}if(e&2){let i=I(2);U("searchPlaceholderText",N(1,5,"housePlan.searchWallStructure"))("filteredOptions",i.filteredWallStructures()),Ss("search",i.wallStructureSearch),U("autocompleteEmptyClass","p-2 text-sm text-muted-foreground"),E(2),Ce(i.wallStructuresService.wallStructures.isLoading()?2:(i.wallStructuresService.wallStructures.value()||Rr(7,eoe)).length===0?3:-1)}}function poe(e,t){if(e&1&&(S(0,"div",52)(1,"p",54),F(2),O(3,"transloco"),x(),S(4,"p",33),F(5),O(6,"transloco"),x()()),e&2){let i=I(2);E(2),we(N(3,3,"housePlan.dimensions")),E(3),Io(" ",N(6,5,"housePlan.length"),": ",i.calculateWallLength(i.selectedWall()).toFixed(2)," m ")}}function goe(e,t){if(e&1){let i=xe();S(0,"hlm-sheet-content")(1,"hlm-sheet-header")(2,"h3",45),F(3),O(4,"transloco"),x(),S(5,"p",46),F(6),O(7,"transloco"),x()(),S(8,"div",47)(9,"div",40)(10,"label",48),F(11),O(12,"transloco"),x(),S(13,"input",49),Es("ngModelChange",function(o){j(i);let r=I();return xs(r.wallName,o)||(r.wallName=o),K(o)}),x()(),S(14,"div",40)(15,"label",50),F(16),O(17,"transloco"),x(),S(18,"p",33),F(19),O(20,"transloco"),x(),ve(21,coe,5,1,"div",51)(22,hoe,4,8),x(),ve(23,poe,7,7,"div",52),x(),S(24,"hlm-sheet-footer")(25,"button",15),V("click",function(){j(i);let o=I();return K(o.closeMetadataSheet())}),F(26),O(27,"transloco"),x(),S(28,"button",53),V("click",function(){j(i);let o=I();return K(o.saveWallMetadata())}),F(29),O(30,"transloco"),x()()()}if(e&2){let i=I();E(3),we(N(4,10,"housePlan.wallMetadata")),E(3),we(N(7,12,"housePlan.wallMetadataDesc")),E(5),de(" ",N(12,14,"housePlan.wallName")," "),E(2),Ss("ngModel",i.wallName),E(3),we(N(17,16,"housePlan.wallStructure")),E(3),we(N(20,18,"housePlan.wallStructureDesc")),E(2),Ce(i.selectedWallStructure()?21:22),E(2),Ce(i.selectedWall()?23:-1),E(3),de(" ",N(27,20,"common.cancel")," "),E(3),de(" ",N(30,22,"common.save")," ")}}var U6=(()=>{class e{route=k(P1);router=k(fu);plansService=k(Cs);wallStructuresService=k(Mo);constructor(){_e(()=>{let i=this.route.snapshot.paramMap.get("id");i&&this.plansService.loadPlan(i)}),_e(()=>{let i=this.plansService.currentPlanWalls.value();i&&this.walls.set(i)}),_e(()=>{let i=this.plansService.currentPlan.value();i&&this.scale.set(i.scale||20)})}canvasWidth=1600;canvasHeight=1200;gridSize=20;scale=J(20);zoom=J(1);minZoom=.1;maxZoom=5;stagePosition=J({x:0,y:0});drawingMode=J("select");walls=J([]);selectedWallId=J(null);isMetadataSheetOpen=J(!1);selectedWall=L(()=>{let i=this.selectedWallId();return i&&this.walls().find(n=>n.id===i)||null});wallName=J("");wallStructureId=J(null);wallStructureSearch=J("");filteredWallStructures=L(()=>{let i=this.wallStructuresService.wallStructures.value()||[],n=this.wallStructureSearch().toLowerCase();return n?i.filter(o=>o.name.toLowerCase().includes(n)):i});selectedWallStructure=L(()=>{let i=this.wallStructureId();return i&&(this.wallStructuresService.wallStructures.value()||[]).find(o=>o.id===i)||null});setDrawingMode(i){this.drawingMode.set(i),i!=="select"&&this.selectedWallId.set(null)}onWallClick(i){this.selectedWallId.set(i);let n=this.walls().find(o=>o.id===i);n&&(this.wallName.set(n.name||""),this.wallStructureId.set(n.wall_structure_id||null),this.wallStructureSearch.set(""),this.isMetadataSheetOpen.set(!0))}onWallCreated(i){let n=this.route.snapshot.paramMap.get("id");n&&this.plansService.createWall({house_plan_id:n,start_x:i.start_x,start_y:i.start_y,end_x:i.end_x,end_y:i.end_y,color:"#1f2937",name:`Wall ${this.walls().length+1}`})}onWallMoved(i){this.plansService.updateWall(i.id,{start_x:i.start_x,start_y:i.start_y,end_x:i.end_x,end_y:i.end_y})}handleWallStructureSelection(i){this.wallStructureId.set(i),this.wallStructureSearch.set("")}clearWallStructure(){this.wallStructureId.set(null),this.wallStructureSearch.set("")}saveWallMetadata(){let i=this.selectedWallId();i&&(this.plansService.updateWall(i,{name:this.wallName()||void 0,wall_structure_id:this.wallStructureId()||void 0}),this.isMetadataSheetOpen.set(!1))}closeMetadataSheet(){this.isMetadataSheetOpen.set(!1),this.selectedWallId.set(null),this.wallStructureSearch.set("")}deleteSelectedWall(){let i=this.selectedWallId();i&&(this.plansService.deleteWall(i),this.isMetadataSheetOpen.set(!1),this.selectedWallId.set(null))}clearAll(){if(confirm("Are you sure you want to clear all walls?")){let i=this.walls().map(n=>n.id);i.length>0&&this.plansService.deleteWalls(i),this.selectedWallId.set(null)}}savePlan(){let i=this.route.snapshot.paramMap.get("id");if(!i){console.error("No plan ID found");return}this.plansService.updatePlan(i,{scale:this.scale()})}goBack(){this.router.navigate(["/hd","house-plans"])}calculateWallLength(i){return Math.sqrt(Math.pow(i.end_x-i.start_x,2)+Math.pow(i.end_y-i.start_y,2))/this.scale()}zoomIn(){let i=this.zoom(),n=Math.min(this.maxZoom,i*1.2),o=this.canvasWidth/2,r=this.canvasHeight/2,s=this.stagePosition(),a={x:(o-s.x)/i,y:(r-s.y)/i},l={x:o-a.x*n,y:r-a.y*n};this.zoom.set(n),this.stagePosition.set(l)}zoomOut(){let i=this.zoom(),n=Math.max(this.minZoom,i/1.2),o=this.canvasWidth/2,r=this.canvasHeight/2,s=this.stagePosition(),a={x:(o-s.x)/i,y:(r-s.y)/i},l={x:o-a.x*n,y:r-a.y*n};this.zoom.set(n),this.stagePosition.set(l)}resetZoom(){this.zoom.set(1),this.stagePosition.set({x:0,y:0})}onStagePositionChanged(i){this.stagePosition.set(i)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["gh-house-plan-editor"]],features:[ue([Cs,Mo,nt({lucidePointer:oy,lucidePencil:Aa,lucideMove:ey,lucideTrash:ln,lucideSquare:dy,lucideSave:ly,lucideArrowUpDown:H1,lucideArrowLeft:N1,lucidePlus:Jn,lucideMinus:Z1,lucideRotateCcw:ay}),eS({transformOptionToString:i=>i.name,transformOptionToValue:i=>i.id})])],decls:6,vars:2,consts:[[1,"p-4","md:p-6","space-y-4"],[1,"flex","items-center","justify-center","py-12"],[1,"text-center","py-12","text-destructive"],["side","right",3,"stateChanged","state"],[4,"brnSheetContent"],["size","large"],["hlmBtn","","variant","outline",1,"mt-4",3,"click"],["hlm","","name","lucideArrowLeft","size","sm",1,"mr-2"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-4"],["hlmBtn","","variant","ghost","size","icon",3,"click"],["hlm","","name","lucideArrowLeft","size","sm"],[1,"text-2xl","md:text-3xl","font-bold"],[1,"text-muted-foreground","mt-1"],[1,"flex","gap-2"],["hlmBtn","","variant","outline",3,"click"],["hlm","","name","lucideTrash","size","sm",1,"mr-2"],["hlmBtn","",3,"click","disabled"],["hlm","","name","lucideSave","size","sm",1,"mr-2"],[1,"grid","gap-4","lg:grid-cols-[auto_1fr]"],[1,"space-y-4","flex","flex-col"],[3,"title"],[1,"flex","flex-col","gap-2"],["hlmBtn","","size","sm",1,"w-full","justify-start",3,"click","variant"],["hlm","","name","lucidePointer","size","sm",1,"mr-2"],["hlm","","name","lucidePencil","size","sm",1,"mr-2"],["hlm","","name","lucideMove","size","sm",1,"mr-2"],[1,"mt-4","pt-4","border-t"],[1,"text-sm","font-medium","mb-2"],["hlmBtn","","variant","outline","size","sm",1,"w-full","justify-start",3,"click","disabled"],["hlm","","name","lucidePlus","size","sm",1,"mr-2"],["hlm","","name","lucideMinus","size","sm",1,"mr-2"],["hlm","","name","lucideRotateCcw","size","sm",1,"mr-2"],[1,"text-sm","text-muted-foreground"],[1,"flex","flex-col","space-y-4","min-w-0"],[3,"title","description"],[1,"w-full","h-[600px]","lg:h-[700px]","xl:h-[800px]","overflow-hidden","border","rounded-md","bg-muted/30"],[3,"wallsChange","wallClicked","wallCreated","wallMoved","stagePositionChanged","canvasWidth","canvasHeight","gridSize","drawingMode","zoom","stagePosition","walls"],[1,"flex","flex-col","space-y-4"],[1,"text-sm","text-muted-foreground","text-center","py-8"],[1,"space-y-2"],[1,"flex","items-center","justify-between","p-3","border","rounded-md","hover:bg-accent","cursor-pointer","transition-colors",3,"bg-accent"],[1,"flex","items-center","justify-between","p-3","border","rounded-md","hover:bg-accent","cursor-pointer","transition-colors",3,"click"],[1,"font-medium"],["hlm","","name","lucideTrash","size","sm"],["hlmSheetTitle",""],["hlmSheetDescription",""],[1,"space-y-4","px-4"],["hlmLabel","","for","wall-name"],["hlmInput","","id","wall-name","type","text",3,"ngModelChange","ngModel"],["hlmLabel",""],[1,"flex","items-center","justify-between","p-2","bg-accent","rounded-md"],[1,"space-y-2","pt-4","border-t"],["hlmBtn","",3,"click"],[1,"text-sm","font-medium"],["hlmBtn","","variant","ghost","size","icon",1,"h-6","w-6",3,"click"],[3,"searchChange","valueChange","searchPlaceholderText","filteredOptions","search","autocompleteEmptyClass"],[1,"text-sm","text-muted-foreground","italic"]],template:function(n,o){n&1&&(S(0,"div",0),ve(1,ioe,2,0,"div",1)(2,noe,8,7,"div",2)(3,loe,88,88),x(),S(4,"hlm-sheet",3),V("stateChanged",function(s){return o.isMetadataSheetOpen.set(s==="open")}),Dt(5,goe,31,24,"hlm-sheet-content",4),x()),n&2&&(E(),Ce(o.plansService.currentPlan.isLoading()?1:o.plansService.currentPlan.error()?2:3),E(3),U("state",o.isMetadataSheetOpen()?"open":"closed"))},dependencies:[ui,Tr,Yn,Xn,mu,Ze,Pi,Ni,We,ot,Qn,Ln,On,Lo,Oo,No,Bo,tS,Zn,Yt,eo,OT,Kt],encapsulation:2,changeDetection:0})}return e})();function foe(e,t){e&1&&(S(0,"div",5),H(1,"hlm-spinner",9),x())}function moe(e,t){if(e&1&&(S(0,"div",6)(1,"p"),F(2),O(3,"transloco"),x()()),e&2){let i=I();E(2),Io("",N(3,2,"common.error"),": ",i.plansService.plans.error())}}function voe(e,t){if(e&1){let i=xe();S(0,"div",7)(1,"p",10),F(2),O(3,"transloco"),x(),S(4,"button",3),V("click",function(){j(i);let o=I();return K(o.openCreateDialog())}),H(5,"ng-icon",4),F(6),O(7,"transloco"),x()()}e&2&&(E(2),we(N(3,2,"housePlans.noPlans")),E(4),de(" ",N(7,4,"housePlans.createFirst")," "))}function Coe(e,t){if(e&1&&H(0,"ag-grid-angular",8),e&2){let i=I();U("rowData",i.plansService.plans.value())("columnDefs",i.columnDefs)("defaultColDef",i.defaultColDef)("gridOptions",i.gridOptions)}}function woe(e,t){if(e&1){let i=xe();S(0,"div",11),V("click",function(){j(i);let o=I();return K(o.closeCreateDialog())}),x(),S(1,"div",12)(2,"div",13)(3,"div")(4,"h3",14),F(5),O(6,"transloco"),x(),S(7,"p",15),F(8),O(9,"transloco"),x()(),S(10,"div",16)(11,"label",17),F(12),O(13,"transloco"),x(),S(14,"input",18),O(15,"transloco"),Es("ngModelChange",function(o){j(i);let r=I();return xs(r.newPlanName,o)||(r.newPlanName=o),K(o)}),x()(),S(16,"div",16)(17,"label",19),F(18),O(19,"transloco"),x(),S(20,"textarea",20),O(21,"transloco"),Es("ngModelChange",function(o){j(i);let r=I();return xs(r.newPlanDescription,o)||(r.newPlanDescription=o),K(o)}),x()(),S(22,"div",21)(23,"button",22),V("click",function(){j(i);let o=I();return K(o.closeCreateDialog())}),F(24),O(25,"transloco"),x(),S(26,"button",23),V("click",function(){j(i);let o=I();return K(o.createPlan())}),F(27),O(28,"transloco"),x()()()()}if(e&2){let i=I();E(5),we(N(6,11,"housePlans.createNewPlan")),E(3),we(N(9,13,"housePlans.createNewPlanDesc")),E(4),de(" ",N(13,15,"housePlans.planName")," "),E(2),Ss("ngModel",i.newPlanName),U("placeholder",N(15,17,"housePlans.planNamePlaceholder")),E(4),de(" ",N(19,19,"housePlans.planDescription")," "),E(2),Ss("ngModel",i.newPlanDescription),U("placeholder",N(21,21,"housePlans.planDescriptionPlaceholder")),E(4),de(" ",N(25,23,"common.cancel")," "),E(2),U("disabled",!i.newPlanName.trim()),E(),de(" ",N(28,25,"common.create")," ")}}var q6=(()=>{class e{router=k(fu);plansService=k(Cs);columnDefs=[{headerName:"Name",field:"name",flex:2,sortable:!0,filter:!0},{headerName:"Description",field:"description",flex:3,sortable:!0,filter:!0},{headerName:"Created",field:"created_at",flex:2,sortable:!0,valueFormatter:i=>i.value?new Date(i.value).toLocaleDateString():""},{headerName:"Actions",cellRenderer:ga,cellRendererParams:{actions:[{icon:"lucideEye",variant:"ghost",action:i=>this.viewPlan(i.id)},{icon:"lucideTrash",variant:"ghost",action:i=>this.deletePlan(i.id)}]},flex:1,sortable:!1,filter:!1}];defaultColDef={resizable:!0,sortable:!0};gridOptions={rowHeight:48,headerHeight:48,pagination:!0,paginationPageSize:20,paginationPageSizeSelector:[10,20,50,100]};showCreateDialog=!1;newPlanName="";newPlanDescription="";openCreateDialog(){this.showCreateDialog=!0,this.newPlanName="",this.newPlanDescription=""}closeCreateDialog(){this.showCreateDialog=!1}createPlan(){this.newPlanName.trim()&&(this.plansService.createPlan({name:this.newPlanName,description:this.newPlanDescription||void 0}),this.closeCreateDialog())}viewPlan(i){this.router.navigate(["hd","house-plan",i])}deletePlan(i){confirm("Are you sure you want to delete this plan?")&&this.plansService.deletePlan(i)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["gh-house-plans-list"]],features:[ue([Cs,nt({lucidePlus:Jn,lucideEye:q1,lucideTrash:ln})])],decls:15,vars:11,consts:[[1,"p-4","md:p-6","space-y-4"],[1,"flex","items-center","justify-between"],[3,"title","description"],["hlmBtn","",3,"click"],["hlm","","name","lucidePlus","size","sm",1,"mr-2"],[1,"flex","items-center","justify-center","py-12"],[1,"text-center","py-12","text-destructive"],[1,"text-center","py-12"],[1,"ag-theme-alpine",2,"width","100%","height","600px",3,"rowData","columnDefs","defaultColDef","gridOptions"],["size","large"],[1,"text-muted-foreground","mb-4"],[1,"fixed","inset-0","z-50","bg-black/50",3,"click"],[1,"fixed","left-1/2","top-1/2","z-50","w-full","max-w-lg","-translate-x-1/2","-translate-y-1/2","bg-background","shadow-lg","rounded-lg","p-6"],[1,"space-y-4"],[1,"text-lg","font-semibold"],[1,"text-sm","text-muted-foreground"],[1,"space-y-2"],["hlmLabel","","for","plan-name"],["hlmInput","","id","plan-name","type","text",3,"ngModelChange","ngModel","placeholder"],["hlmLabel","","for","plan-description"],["hlmInput","","id","plan-description","rows","3",3,"ngModelChange","ngModel","placeholder"],[1,"flex","gap-2","pt-4"],["hlmBtn","","variant","outline",1,"flex-1",3,"click"],["hlmBtn","",1,"flex-1",3,"click","disabled"]],template:function(n,o){n&1&&(S(0,"div",0)(1,"div",1),H(2,"gh-section-header",2),O(3,"transloco"),O(4,"transloco"),S(5,"button",3),V("click",function(){return o.openCreateDialog()}),H(6,"ng-icon",4),F(7),O(8,"transloco"),x()(),S(9,"div"),ve(10,foe,2,0,"div",5)(11,moe,4,4,"div",6)(12,voe,8,6,"div",7)(13,Coe,1,4,"ag-grid-angular",8),x()(),ve(14,woe,29,27)),n&2&&(E(2),U("title",N(3,5,"housePlans.title"))("description",N(4,7,"housePlans.subtitle")),E(5),de(" ",N(8,9,"housePlans.createNew")," "),E(3),Ce(o.plansService.plans.isLoading()?10:o.plansService.plans.error()?11:!o.plansService.plans.value()||o.plansService.plans.value().length===0?12:13),E(4),Ce(o.showCreateDialog?14:-1))},dependencies:[ui,Tr,Yn,Xn,mu,Tl,Ze,Pi,Ni,We,ot,Qn,Yt,eo,Kt],encapsulation:2,changeDetection:0})}return e})();function boe(e,t){e&1&&(S(0,"div",10),H(1,"hlm-spinner",16),x())}function yoe(e,t){if(e&1){let i=xe();S(0,"div",11)(1,"ag-grid-angular",17),V("gridReady",function(o){j(i);let r=I();return K(r.onMaterialsGridReady(o))}),x()()}if(e&2){let i=I();E(),U("rowData",i.materialLayers())("columnDefs",i.materialColumnDefs)("defaultColDef",i.defaultColDef)("rowSelection",i.materialRowSelection)("theme",i.theme)}}function Soe(e,t){e&1&&(S(0,"div",10),H(1,"hlm-spinner",16),x())}function xoe(e,t){if(e&1){let i=xe();S(0,"div",13)(1,"ag-grid-angular",17),V("gridReady",function(o){j(i);let r=I();return K(r.onStructuresGridReady(o))}),x()()}if(e&2){let i=I();E(),U("rowData",i.wallStructures())("columnDefs",i.structureColumnDefs)("defaultColDef",i.defaultColDef)("rowSelection",i.rowSelection)("theme",i.theme)}}Jp.registerModules([cg]);var $6=(()=>{class e{theme=og;service=k(Mo);materialsGridApi=J(null);structuresGridApi=J(null);editingMaterial=J(null);editingStructure=J(null);isMaterialSheetOpen=J(!1);isStructureSheetOpen=J(!1);materialLayers=L(()=>this.service.materialLayers.value()||[]);wallStructures=L(()=>this.service.wallStructures.value()||[]);materialColumnDefs=[{field:"name",headerName:"Materialname",flex:1},{field:"thickness",headerName:"Dicke (mm)",width:150,valueFormatter:i=>i.value?`${i.value} mm`:"0 mm"},{field:"description",headerName:"Beschreibung",flex:2},{headerName:"Aktionen",width:100,cellRenderer:ga,cellRendererParams:{actions:[{icon:"lucidePencil",variant:"ghost",action:i=>this.editMaterial(i)}]},sortable:!1,filter:!1}];structureColumnDefs=[{field:"name",headerName:"Wandaufbau Name",flex:1},{field:"created_at",headerName:"Erstellt am",width:180,valueFormatter:i=>i.value?new Date(i.value).toLocaleDateString("de-DE"):""},{headerName:"Aktionen",width:100,cellRenderer:ga,cellRendererParams:{actions:[{icon:"lucidePencil",variant:"ghost",action:i=>this.editStructure(i)}]},sortable:!1,filter:!1}];defaultColDef={sortable:!0,filter:!0,resizable:!0};rowSelection="single";materialRowSelection="multiple";onMaterialsGridReady(i){this.materialsGridApi.set(i.api)}onStructuresGridReady(i){this.structuresGridApi.set(i.api)}editMaterial(i){this.editingMaterial.set(i),this.isMaterialSheetOpen.set(!0)}editStructure(i){this.editingStructure.set(i),this.isStructureSheetOpen.set(!0)}onMaterialSave(i){let n=this.editingMaterial();if(n){let o={name:i.name,thickness:i.thickness,description:i.description===null?void 0:i.description};this.service.updateMaterialLayer(n.id,o)}else{if(!i.name||i.thickness===void 0)return;let o={name:i.name,thickness:i.thickness,description:i.description===null?void 0:i.description};this.service.createMaterialLayer(o)}this.editingMaterial.set(null),this.isMaterialSheetOpen.set(!1)}onStructureSave(i){let n=this.editingStructure();if(n){let o={name:i.structure.name};this.service.updateWallStructureWithLayers(n.id,o,i.layers)}else{if(!i.structure.name)return;let o={name:i.structure.name};this.service.createWallStructureWithLayers(o,i.layers)}this.editingStructure.set(null),this.isStructureSheetOpen.set(!1)}addMaterial(){this.editingMaterial.set(null),this.isMaterialSheetOpen.set(!0)}deleteSelectedMaterials(){let i=this.materialsGridApi();if(!i)return;let n=i.getSelectedRows();if(n.length>0){let o=n.map(r=>r.id);this.service.deleteMaterialLayers(o)}}addWallStructure(){this.editingStructure.set(null),this.isStructureSheetOpen.set(!0)}deleteSelectedStructure(){let i=this.structuresGridApi();if(!i)return;let n=i.getSelectedRows();n.length>0&&this.service.deleteWallStructure(n[0].id)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=re({type:e,selectors:[["gh-wall-structures"]],features:[ue([Mo,nt({lucidePlus:Jn,lucideTrash:ln,lucidePencil:Aa})])],decls:36,vars:30,consts:[["materialSheet",""],["structureSheet",""],[1,"p-4","md:p-6","space-y-6"],[1,"flex","flex-col","space-y-4"],[3,"title","description"],[1,"flex","flex-wrap","gap-2"],["hlmBtn","","variant","default",3,"click"],["hlm","","name","lucidePlus","size","sm",1,"mr-2"],["hlmBtn","","variant","destructive",3,"click"],["hlm","","name","lucideTrash","size","sm",1,"mr-2"],[1,"flex","justify-center","p-8"],[1,"h-[300px]","w-full"],["hlmSeparator","",1,"my-6"],[1,"h-[400px]","w-full"],[3,"stateChanged","save$","material","state"],[3,"stateChanged","save$","structure","state"],["size","large"],[1,"w-full","h-full",3,"gridReady","rowData","columnDefs","defaultColDef","rowSelection","theme"]],template:function(n,o){if(n&1){let r=xe();S(0,"div",2)(1,"div",3),H(2,"gh-section-header",4),O(3,"transloco"),O(4,"transloco"),S(5,"div",5)(6,"button",6),V("click",function(){return j(r),K(o.addMaterial())}),H(7,"ng-icon",7),F(8),O(9,"transloco"),x(),S(10,"button",8),V("click",function(){return j(r),K(o.deleteSelectedMaterials())}),H(11,"ng-icon",9),F(12),O(13,"transloco"),x()()(),ve(14,boe,2,0,"div",10)(15,yoe,2,5,"div",11),H(16,"div",12),S(17,"div",3),H(18,"gh-section-header",4),O(19,"transloco"),O(20,"transloco"),S(21,"div",5)(22,"button",6),V("click",function(){return j(r),K(o.addWallStructure())}),H(23,"ng-icon",7),F(24),O(25,"transloco"),x(),S(26,"button",8),V("click",function(){return j(r),K(o.deleteSelectedStructure())}),H(27,"ng-icon",9),F(28),O(29,"transloco"),x()()(),ve(30,Soe,2,0,"div",10)(31,xoe,2,5,"div",13),x(),S(32,"gh-material-edit-sheet",14,0),V("stateChanged",function(a){return j(r),K(o.isMaterialSheetOpen.set(a==="open"))})("save$",function(a){return j(r),K(o.onMaterialSave(a))}),x(),S(34,"gh-wall-structure-edit-sheet",15,1),V("stateChanged",function(a){return j(r),K(o.isStructureSheetOpen.set(a==="open"))})("save$",function(a){return j(r),K(o.onStructureSave(a))}),x()}n&2&&(E(2),U("title",N(3,14,"wallStructures.materialLibrary.title"))("description",N(4,16,"wallStructures.materialLibrary.description")),E(6),de(" ",N(9,18,"wallStructures.materialLibrary.addNew")," "),E(4),de(" ",N(13,20,"wallStructures.materialLibrary.deleteSelected")," "),E(2),Ce(o.service.materialLayers.isLoading()?14:15),E(4),U("title",N(19,22,"wallStructures.structures.title"))("description",N(20,24,"wallStructures.structures.description")),E(6),de(" ",N(25,26,"wallStructures.structures.addNew")," "),E(4),de(" ",N(29,28,"wallStructures.structures.deleteSelected")," "),E(2),Ce(o.service.wallStructures.isLoading()?30:31),E(2),U("material",o.editingMaterial())("state",o.isMaterialSheetOpen()?"open":"closed"),E(2),U("structure",o.editingStructure())("state",o.isStructureSheetOpen()?"open":"closed"))},dependencies:[ui,Tl,Ze,Qn,Fr,Yt,We,ot,eo,R6,P6,Kt],encapsulation:2,changeDetection:0})}return e})();var s_e=[{path:"",component:CS,children:[{path:"dashboard",component:W6},{path:"wall-structures",component:$6},{path:"flexible-items",component:z6},{path:"house-plans",component:q6},{path:"house-plan/:id",component:U6},{path:"",redirectTo:"dashboard",pathMatch:"full"}]}];export{oS as FileUploadComponent,CS as HomeShellComponent,U6 as HousePlanEditorComponent,eo as SectionHeaderComponent,np as TiptapEditorComponent,$6 as WallStructuresComponent,s_e as homeDocumentationRoutes};
