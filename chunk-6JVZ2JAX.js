import{a as Q1,b as Z1,d as eb,e as tb}from"./chunk-YTIG7DF5.js";import{b as ib,c as Pr,d as Fr,e as Tr,f as nb,g as Ar,h as Ir}from"./chunk-HOSV43XW.js";import{$a as Qa,$b as o1,A as Xd,Aa as Qi,Ab as As,Ac as Mr,Ad as X1,B as Ka,Ba as wr,Bb as fn,Bc as D1,Bd as J1,C as Se,Ca as br,Cc as k1,D as Ow,Da as yr,Db as te,Dc as P1,E as Ts,Eb as Rr,Ed as pc,F as yt,Fb as Kw,Fc as F1,Gb as Jt,H as Jd,Hb as Yw,Hc as T1,Ia as Ie,Ib as sc,J as P,Ja as ec,Jb as Eg,K as Qd,Ka as Bw,Kb as oc,L as mr,La as Hw,Lc as A1,M as Ya,Ma as Vw,Mb as Xw,Mc as I1,N as Cr,Na as Y,Nb as rc,Nc as Rg,O as be,Oa as X,Oc as _1,P as bg,Pa as bo,Pb as Jw,Pc as el,Q as ce,Qb as Qw,Qc as L1,R as vo,Ra as yo,Rb as Zw,Rc as O1,S as Un,Sa as W,Sc as N1,T as Xi,Ta as qe,Tb as ac,U as A,Ua as Gw,Ub as Lt,V as wo,Va as So,Vb as xt,W as vr,Wa as de,Wb as e1,X as St,Xa as H,Xb as t1,Y as ze,Ya as Ja,Yb as i1,Yc as B1,Z as We,Za as $n,Zb as n1,Zc as H1,_ as Zd,_a as Sr,_b as s1,_c as V1,a as Co,aa as cn,ab as Za,ac as r1,ad as G1,b as Kt,ba as un,bb as xr,bd as dc,c as Ft,ca as Ce,cb as D,cc as a1,cd as cc,d as Tw,da as M,db as Er,dc as l1,dd as uc,e as mg,ea as R,ec as d1,ed as hc,f as Cg,fa as ee,fb as xo,fc as c1,fd as z1,ga as yg,gb as gn,gc as u1,gd as tl,h as Yt,ha as Sg,hb as tc,hc as h1,hd as W1,i as Aw,ia as Nw,ic as p1,id as U1,j as Iw,ja as Ji,jc as g1,jd as q1,k as Xt,ka as rt,kc as f1,la as qn,lc as m1,ld as $1,m as _w,ma as Q,mc as C1,n as fi,na as Z,nb as zw,nc as v1,nd as it,oa as _t,ob as Ww,oc as w1,p as Wn,pa as Qe,pb as ic,pc as lc,q as ja,qa as mi,qb as Uw,qc as b1,r as vg,ra as Xa,rb as qw,rc as y1,s as dn,sa as Ei,sc as S1,t as Lw,ta as hn,tc as x1,td as j1,u as z,ua as pn,ub as $w,ud as K1,v as he,va as Vt,vb as nc,vd as Y1,w as pe,wa as ye,wd as il,xa as _,xb as jw,xc as E1,xd as Mg,ya as Ee,yb as xg,yc as R1,yd as Dr,z as wg,za as xe,zc as M1,zd as kr}from"./chunk-XS6CB654.js";import{a as b,b as O,d as gi,e as oe,f as fr}from"./chunk-M4OEJGNZ.js";var De=oe(Nt=>{"use strict";Object.defineProperty(Nt,"__esModule",{value:!0});Nt._registerNode=Nt.Konva=Nt.glob=void 0;var RA=Math.PI/180;function MA(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}Nt.glob=typeof global<"u"?global:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{};Nt.Konva={_global:Nt.glob,version:"9.3.22",isBrowser:MA(),isUnminified:/param/.test((function(e){}).toString()),dblClickWindow:400,getAngle(e){return Nt.Konva.angleDeg?e*RA:e},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return Nt.Konva.DD.isDragging},isTransforming(){var e;return(e=Nt.Konva.Transformer)===null||e===void 0?void 0:e.isTransforming()},isDragReady(){return!!Nt.Konva.DD.node},releaseCanvasOnDestroy:!0,document:Nt.glob.document,_injectGlobal(e){Nt.glob.Konva=e}};var DA=e=>{Nt.Konva[e.prototype.getClassName()]=e};Nt._registerNode=DA;Nt.Konva._injectGlobal(Nt.Konva)});var at=oe(Xe=>{"use strict";Object.defineProperty(Xe,"__esModule",{value:!0});Xe.Util=Xe.Transform=void 0;var u0=De(),g0=class e{constructor(t=[1,0,0,1,0,0]){this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new e(this.m)}copyInto(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]}point(t){let i=this.m;return{x:i[0]*t.x+i[2]*t.y+i[4],y:i[1]*t.x+i[3]*t.y+i[5]}}translate(t,i){return this.m[4]+=this.m[0]*t+this.m[2]*i,this.m[5]+=this.m[1]*t+this.m[3]*i,this}scale(t,i){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=i,this.m[3]*=i,this}rotate(t){let i=Math.cos(t),n=Math.sin(t),s=this.m[0]*i+this.m[2]*n,o=this.m[1]*i+this.m[3]*n,r=this.m[0]*-n+this.m[2]*i,a=this.m[1]*-n+this.m[3]*i;return this.m[0]=s,this.m[1]=o,this.m[2]=r,this.m[3]=a,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(t,i){let n=this.m[0]+this.m[2]*i,s=this.m[1]+this.m[3]*i,o=this.m[2]+this.m[0]*t,r=this.m[3]+this.m[1]*t;return this.m[0]=n,this.m[1]=s,this.m[2]=o,this.m[3]=r,this}multiply(t){let i=this.m[0]*t.m[0]+this.m[2]*t.m[1],n=this.m[1]*t.m[0]+this.m[3]*t.m[1],s=this.m[0]*t.m[2]+this.m[2]*t.m[3],o=this.m[1]*t.m[2]+this.m[3]*t.m[3],r=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],a=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=i,this.m[1]=n,this.m[2]=s,this.m[3]=o,this.m[4]=r,this.m[5]=a,this}invert(){let t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),i=this.m[3]*t,n=-this.m[1]*t,s=-this.m[2]*t,o=this.m[0]*t,r=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),a=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=i,this.m[1]=n,this.m[2]=s,this.m[3]=o,this.m[4]=r,this.m[5]=a,this}getMatrix(){return this.m}decompose(){let t=this.m[0],i=this.m[1],n=this.m[2],s=this.m[3],o=this.m[4],r=this.m[5],a=t*s-i*n,l={x:o,y:r,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(t!=0||i!=0){let d=Math.sqrt(t*t+i*i);l.rotation=i>0?Math.acos(t/d):-Math.acos(t/d),l.scaleX=d,l.scaleY=a/d,l.skewX=(t*n+i*s)/a,l.skewY=0}else if(n!=0||s!=0){let d=Math.sqrt(n*n+s*s);l.rotation=Math.PI/2-(s>0?Math.acos(-n/d):-Math.acos(n/d)),l.scaleX=a/d,l.scaleY=d,l.skewX=0,l.skewY=(t*n+i*s)/a}return l.rotation=Xe.Util._getRotation(l.rotation),l}};Xe.Transform=g0;var kA="[object Array]",PA="[object Number]",FA="[object String]",TA="[object Boolean]",AA=Math.PI/180,IA=180/Math.PI,h0="#",_A="",LA="0",OA="Konva warning: ",P3="Konva error: ",NA="rgb(",p0={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},BA=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,Uu=[],HA=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(e){setTimeout(e,60)};Xe.Util={_isElement(e){return!!(e&&e.nodeType==1)},_isFunction(e){return!!(e&&e.constructor&&e.call&&e.apply)},_isPlainObject(e){return!!e&&e.constructor===Object},_isArray(e){return Object.prototype.toString.call(e)===kA},_isNumber(e){return Object.prototype.toString.call(e)===PA&&!isNaN(e)&&isFinite(e)},_isString(e){return Object.prototype.toString.call(e)===FA},_isBoolean(e){return Object.prototype.toString.call(e)===TA},isObject(e){return e instanceof Object},isValidSelector(e){if(typeof e!="string")return!1;let t=e[0];return t==="#"||t==="."||t===t.toUpperCase()},_sign(e){return e===0||e>0?1:-1},requestAnimFrame(e){Uu.push(e),Uu.length===1&&HA(function(){let t=Uu;Uu=[],t.forEach(function(i){i()})})},createCanvasElement(){let e=document.createElement("canvas");try{e.style=e.style||{}}catch{}return e},createImageElement(){return document.createElement("img")},_isInDocument(e){for(;e=e.parentNode;)if(e==document)return!0;return!1},_urlToImage(e,t){let i=Xe.Util.createImageElement();i.onload=function(){t(i)},i.src=e},_rgbToHex(e,t,i){return((1<<24)+(e<<16)+(t<<8)+i).toString(16).slice(1)},_hexToRgb(e){e=e.replace(h0,_A);let t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:t&255}},getRandomColor(){let e=(Math.random()*16777215<<0).toString(16);for(;e.length<6;)e=LA+e;return h0+e},getRGB(e){let t;return e in p0?(t=p0[e],{r:t[0],g:t[1],b:t[2]}):e[0]===h0?this._hexToRgb(e.substring(1)):e.substr(0,4)===NA?(t=BA.exec(e.replace(/ /g,"")),{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}):{r:0,g:0,b:0}},colorToRGBA(e){return e=e||"black",Xe.Util._namedColorToRBA(e)||Xe.Util._hex3ColorToRGBA(e)||Xe.Util._hex4ColorToRGBA(e)||Xe.Util._hex6ColorToRGBA(e)||Xe.Util._hex8ColorToRGBA(e)||Xe.Util._rgbColorToRGBA(e)||Xe.Util._rgbaColorToRGBA(e)||Xe.Util._hslColorToRGBA(e)},_namedColorToRBA(e){let t=p0[e.toLowerCase()];return t?{r:t[0],g:t[1],b:t[2],a:1}:null},_rgbColorToRGBA(e){if(e.indexOf("rgb(")===0){e=e.match(/rgb\(([^)]+)\)/)[1];let t=e.split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:1}}},_rgbaColorToRGBA(e){if(e.indexOf("rgba(")===0){e=e.match(/rgba\(([^)]+)\)/)[1];let t=e.split(/ *, */).map((i,n)=>i.slice(-1)==="%"?n===3?parseInt(i)/100:parseInt(i)/100*255:Number(i));return{r:t[0],g:t[1],b:t[2],a:t[3]}}},_hex8ColorToRGBA(e){if(e[0]==="#"&&e.length===9)return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:parseInt(e.slice(7,9),16)/255}},_hex6ColorToRGBA(e){if(e[0]==="#"&&e.length===7)return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:1}},_hex4ColorToRGBA(e){if(e[0]==="#"&&e.length===5)return{r:parseInt(e[1]+e[1],16),g:parseInt(e[2]+e[2],16),b:parseInt(e[3]+e[3],16),a:parseInt(e[4]+e[4],16)/255}},_hex3ColorToRGBA(e){if(e[0]==="#"&&e.length===4)return{r:parseInt(e[1]+e[1],16),g:parseInt(e[2]+e[2],16),b:parseInt(e[3]+e[3],16),a:1}},_hslColorToRGBA(e){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(e)){let[t,...i]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e),n=Number(i[0])/360,s=Number(i[1])/100,o=Number(i[2])/100,r,a,l;if(s===0)return l=o*255,{r:Math.round(l),g:Math.round(l),b:Math.round(l),a:1};o<.5?r=o*(1+s):r=o+s-o*s;let d=2*o-r,c=[0,0,0];for(let u=0;u<3;u++)a=n+1/3*-(u-1),a<0&&a++,a>1&&a--,6*a<1?l=d+(r-d)*6*a:2*a<1?l=r:3*a<2?l=d+(r-d)*(2/3-a)*6:l=d,c[u]=l*255;return{r:Math.round(c[0]),g:Math.round(c[1]),b:Math.round(c[2]),a:1}}},haveIntersection(e,t){return!(t.x>e.x+e.width||t.x+t.width<e.x||t.y>e.y+e.height||t.y+t.height<e.y)},cloneObject(e){let t={};for(let i in e)this._isPlainObject(e[i])?t[i]=this.cloneObject(e[i]):this._isArray(e[i])?t[i]=this.cloneArray(e[i]):t[i]=e[i];return t},cloneArray(e){return e.slice(0)},degToRad(e){return e*AA},radToDeg(e){return e*IA},_degToRad(e){return Xe.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),Xe.Util.degToRad(e)},_radToDeg(e){return Xe.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),Xe.Util.radToDeg(e)},_getRotation(e){return u0.Konva.angleDeg?Xe.Util.radToDeg(e):e},_capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)},throw(e){throw new Error(P3+e)},error(e){console.error(P3+e)},warn(e){u0.Konva.showWarnings&&console.warn(OA+e)},each(e,t){for(let i in e)t(i,e[i])},_inRange(e,t,i){return t<=e&&e<i},_getProjectionToSegment(e,t,i,n,s,o){let r,a,l,d=(e-i)*(e-i)+(t-n)*(t-n);if(d==0)r=e,a=t,l=(s-i)*(s-i)+(o-n)*(o-n);else{let c=((s-e)*(i-e)+(o-t)*(n-t))/d;c<0?(r=e,a=t,l=(e-s)*(e-s)+(t-o)*(t-o)):c>1?(r=i,a=n,l=(i-s)*(i-s)+(n-o)*(n-o)):(r=e+c*(i-e),a=t+c*(n-t),l=(r-s)*(r-s)+(a-o)*(a-o))}return[r,a,l]},_getProjectionToLine(e,t,i){let n=Xe.Util.cloneObject(e),s=Number.MAX_VALUE;return t.forEach(function(o,r){if(!i&&r===t.length-1)return;let a=t[(r+1)%t.length],l=Xe.Util._getProjectionToSegment(o.x,o.y,a.x,a.y,e.x,e.y),d=l[0],c=l[1],u=l[2];u<s&&(n.x=d,n.y=c,s=u)}),n},_prepareArrayForTween(e,t,i){let n=[],s=[];if(e.length>t.length){let r=t;t=e,e=r}for(let r=0;r<e.length;r+=2)n.push({x:e[r],y:e[r+1]});for(let r=0;r<t.length;r+=2)s.push({x:t[r],y:t[r+1]});let o=[];return s.forEach(function(r){let a=Xe.Util._getProjectionToLine(r,n,i);o.push(a.x),o.push(a.y)}),o},_prepareToStringify(e){let t;e.visitedByCircularReferenceRemoval=!0;for(let i in e)if(e.hasOwnProperty(i)&&e[i]&&typeof e[i]=="object"){if(t=Object.getOwnPropertyDescriptor(e,i),e[i].visitedByCircularReferenceRemoval||Xe.Util._isElement(e[i]))if(t.configurable)delete e[i];else return null;else if(Xe.Util._prepareToStringify(e[i])===null)if(t.configurable)delete e[i];else return null}return delete e.visitedByCircularReferenceRemoval,e},_assign(e,t){for(let i in t)e[i]=t[i];return e},_getFirstPointerId(e){return e.touches?e.changedTouches[0].identifier:e.pointerId||999},releaseCanvas(...e){u0.Konva.releaseCanvasOnDestroy&&e.forEach(t=>{t.width=0,t.height=0})},drawRoundedRectPath(e,t,i,n){let s=0,o=0,r=0,a=0;typeof n=="number"?s=o=r=a=Math.min(n,t/2,i/2):(s=Math.min(n[0]||0,t/2,i/2),o=Math.min(n[1]||0,t/2,i/2),a=Math.min(n[2]||0,t/2,i/2),r=Math.min(n[3]||0,t/2,i/2)),e.moveTo(s,0),e.lineTo(t-o,0),e.arc(t-o,o,o,Math.PI*3/2,0,!1),e.lineTo(t,i-a),e.arc(t-a,i-a,a,0,Math.PI/2,!1),e.lineTo(r,i),e.arc(r,i-r,r,Math.PI/2,Math.PI,!1),e.lineTo(0,s),e.arc(s,s,s,Math.PI,Math.PI*3/2,!1)}}});var C0=oe(Ws=>{"use strict";Object.defineProperty(Ws,"__esModule",{value:!0});Ws.HitContext=Ws.SceneContext=Ws.Context=void 0;var A3=at(),VA=De();function GA(e){let t=[],i=e.length,n=A3.Util;for(let s=0;s<i;s++){let o=e[s];n._isNumber(o)?o=Math.round(o*1e3)/1e3:n._isString(o)||(o=o+""),t.push(o)}return t}var F3=",",zA="(",WA=")",UA="([",qA="])",$A=";",jA="()",KA="=",T3=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],YA=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],XA=100,ta=class{constructor(t){this.canvas=t,VA.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,i){let n=this.traceArr,s=n.length,o="",r,a,l,d;for(r=0;r<s;r++)a=n[r],l=a.method,l?(d=a.args,o+=l,t?o+=jA:A3.Util._isArray(d[0])?o+=UA+d.join(F3)+qA:(i&&(d=d.map(c=>typeof c=="number"?Math.floor(c):c)),o+=zA+d.join(F3)+WA)):(o+=a.property,t||(o+=KA+a.val)),o+=$A;return o}clearTrace(){this.traceArr=[]}_trace(t){let i=this.traceArr,n;i.push(t),n=i.length,n>=XA&&i.shift()}reset(){let t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){let i=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,i.getWidth()/i.pixelRatio,i.getHeight()/i.pixelRatio)}_applyLineCap(t){let i=t.attrs.lineCap;i&&this.setAttr("lineCap",i)}_applyOpacity(t){let i=t.getAbsoluteOpacity();i!==1&&this.setAttr("globalAlpha",i)}_applyLineJoin(t){let i=t.attrs.lineJoin;i&&this.setAttr("lineJoin",i)}setAttr(t,i){this._context[t]=i}arc(t,i,n,s,o,r){this._context.arc(t,i,n,s,o,r)}arcTo(t,i,n,s,o){this._context.arcTo(t,i,n,s,o)}beginPath(){this._context.beginPath()}bezierCurveTo(t,i,n,s,o,r){this._context.bezierCurveTo(t,i,n,s,o,r)}clearRect(t,i,n,s){this._context.clearRect(t,i,n,s)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,i){let n=arguments;if(n.length===2)return this._context.createImageData(t,i);if(n.length===1)return this._context.createImageData(t)}createLinearGradient(t,i,n,s){return this._context.createLinearGradient(t,i,n,s)}createPattern(t,i){return this._context.createPattern(t,i)}createRadialGradient(t,i,n,s,o,r){return this._context.createRadialGradient(t,i,n,s,o,r)}drawImage(t,i,n,s,o,r,a,l,d){let c=arguments,u=this._context;c.length===3?u.drawImage(t,i,n):c.length===5?u.drawImage(t,i,n,s,o):c.length===9&&u.drawImage(t,i,n,s,o,r,a,l,d)}ellipse(t,i,n,s,o,r,a,l){this._context.ellipse(t,i,n,s,o,r,a,l)}isPointInPath(t,i,n,s){return n?this._context.isPointInPath(n,t,i,s):this._context.isPointInPath(t,i,s)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,i,n,s){this._context.fillRect(t,i,n,s)}strokeRect(t,i,n,s){this._context.strokeRect(t,i,n,s)}fillText(t,i,n,s){s?this._context.fillText(t,i,n,s):this._context.fillText(t,i,n)}measureText(t){return this._context.measureText(t)}getImageData(t,i,n,s){return this._context.getImageData(t,i,n,s)}lineTo(t,i){this._context.lineTo(t,i)}moveTo(t,i){this._context.moveTo(t,i)}rect(t,i,n,s){this._context.rect(t,i,n,s)}roundRect(t,i,n,s,o){this._context.roundRect(t,i,n,s,o)}putImageData(t,i,n){this._context.putImageData(t,i,n)}quadraticCurveTo(t,i,n,s){this._context.quadraticCurveTo(t,i,n,s)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,i){this._context.scale(t,i)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,i,n,s,o,r){this._context.setTransform(t,i,n,s,o,r)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,i,n,s){this._context.strokeText(t,i,n,s)}transform(t,i,n,s,o,r){this._context.transform(t,i,n,s,o,r)}translate(t,i){this._context.translate(t,i)}_enableTrace(){let t=this,i=T3.length,n=this.setAttr,s,o,r=function(a){let l=t[a],d;t[a]=function(){return o=GA(Array.prototype.slice.call(arguments,0)),d=l.apply(t,arguments),t._trace({method:a,args:o}),d}};for(s=0;s<i;s++)r(T3[s]);t.setAttr=function(){n.apply(t,arguments);let a=arguments[0],l=arguments[1];(a==="shadowOffsetX"||a==="shadowOffsetY"||a==="shadowBlur")&&(l=l/this.canvas.getPixelRatio()),t._trace({property:a,val:l})}}_applyGlobalCompositeOperation(t){let i=t.attrs.globalCompositeOperation;!i||i==="source-over"||this.setAttr("globalCompositeOperation",i)}};Ws.Context=ta;YA.forEach(function(e){Object.defineProperty(ta.prototype,e,{get(){return this._context[e]},set(t){this._context[e]=t}})});var f0=class extends ta{constructor(t,{willReadFrequently:i=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:i})}_fillColor(t){let i=t.fill();this.setAttr("fillStyle",i),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){let i=t._getLinearGradient();i&&(this.setAttr("fillStyle",i),t._fillFunc(this))}_fillRadialGradient(t){let i=t._getRadialGradient();i&&(this.setAttr("fillStyle",i),t._fillFunc(this))}_fill(t){let i=t.fill(),n=t.getFillPriority();if(i&&n==="color"){this._fillColor(t);return}let s=t.getFillPatternImage();if(s&&n==="pattern"){this._fillPattern(t);return}let o=t.getFillLinearGradientColorStops();if(o&&n==="linear-gradient"){this._fillLinearGradient(t);return}let r=t.getFillRadialGradientColorStops();if(r&&n==="radial-gradient"){this._fillRadialGradient(t);return}i?this._fillColor(t):s?this._fillPattern(t):o?this._fillLinearGradient(t):r&&this._fillRadialGradient(t)}_strokeLinearGradient(t){let i=t.getStrokeLinearGradientStartPoint(),n=t.getStrokeLinearGradientEndPoint(),s=t.getStrokeLinearGradientColorStops(),o=this.createLinearGradient(i.x,i.y,n.x,n.y);if(s){for(let r=0;r<s.length;r+=2)o.addColorStop(s[r],s[r+1]);this.setAttr("strokeStyle",o)}}_stroke(t){let i=t.dash(),n=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!n){this.save();let o=this.getCanvas().getPixelRatio();this.setTransform(o,0,0,o,0,0)}this._applyLineCap(t),i&&t.dashEnabled()&&(this.setLineDash(i),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),n||this.restore()}}_applyShadow(t){var i,n,s;let o=(i=t.getShadowRGBA())!==null&&i!==void 0?i:"black",r=(n=t.getShadowBlur())!==null&&n!==void 0?n:5,a=(s=t.getShadowOffset())!==null&&s!==void 0?s:{x:0,y:0},l=t.getAbsoluteScale(),d=this.canvas.getPixelRatio(),c=l.x*d,u=l.y*d;this.setAttr("shadowColor",o),this.setAttr("shadowBlur",r*Math.min(Math.abs(c),Math.abs(u))),this.setAttr("shadowOffsetX",a.x*c),this.setAttr("shadowOffsetY",a.y*u)}};Ws.SceneContext=f0;var m0=class extends ta{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){let i=t.getStrokeScaleEnabled();if(!i){this.save();let o=this.getCanvas().getPixelRatio();this.setTransform(o,0,0,o,0,0)}this._applyLineCap(t);let n=t.hitStrokeWidth(),s=n==="auto"?t.strokeWidth():n;this.setAttr("lineWidth",s),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),i||this.restore()}}};Ws.HitContext=m0});var Wl=oe(Us=>{"use strict";Object.defineProperty(Us,"__esModule",{value:!0});Us.HitCanvas=Us.SceneCanvas=Us.Canvas=void 0;var $u=at(),I3=C0(),_3=De(),qu;function JA(){if(qu)return qu;let e=$u.Util.createCanvasElement(),t=e.getContext("2d");return qu=(function(){let i=_3.Konva._global.devicePixelRatio||1,n=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return i/n})(),$u.Util.releaseCanvas(e),qu}var zl=class{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;let n=(t||{}).pixelRatio||_3.Konva.pixelRatio||JA();this.pixelRatio=n,this._canvas=$u.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){let i=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/i,this.getHeight()/i)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";let i=this.pixelRatio;this.getContext()._context.scale(i,i)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";let i=this.pixelRatio;this.getContext()._context.scale(i,i)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,i){this.setWidth(t||0),this.setHeight(i||0)}toDataURL(t,i){try{return this._canvas.toDataURL(t,i)}catch{try{return this._canvas.toDataURL()}catch(s){return $u.Util.error("Unable to get data URL. "+s.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};Us.Canvas=zl;var v0=class extends zl{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new I3.SceneContext(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}};Us.SceneCanvas=v0;var w0=class extends zl{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new I3.HitContext(this),this.setSize(t.width,t.height)}};Us.HitCanvas=w0});var ju=oe(Tt=>{"use strict";Object.defineProperty(Tt,"__esModule",{value:!0});Tt.DD=void 0;var Ul=De(),QA=at();Tt.DD={get isDragging(){let e=!1;return Tt.DD._dragElements.forEach(t=>{t.dragStatus==="dragging"&&(e=!0)}),e},justDragged:!1,get node(){let e;return Tt.DD._dragElements.forEach(t=>{e=t.node}),e},_dragElements:new Map,_drag(e){let t=[];Tt.DD._dragElements.forEach((i,n)=>{let{node:s}=i,o=s.getStage();o.setPointersPositions(e),i.pointerId===void 0&&(i.pointerId=QA.Util._getFirstPointerId(e));let r=o._changedPointerPositions.find(a=>a.id===i.pointerId);if(r){if(i.dragStatus!=="dragging"){let a=s.dragDistance();if(Math.max(Math.abs(r.x-i.startPointerPos.x),Math.abs(r.y-i.startPointerPos.y))<a||(s.startDrag({evt:e}),!s.isDragging()))return}s._setDragPosition(e,i),t.push(s)}}),t.forEach(i=>{i.fire("dragmove",{type:"dragmove",target:i,evt:e},!0)})},_endDragBefore(e){let t=[];Tt.DD._dragElements.forEach(i=>{let{node:n}=i,s=n.getStage();if(e&&s.setPointersPositions(e),!s._changedPointerPositions.find(a=>a.id===i.pointerId))return;(i.dragStatus==="dragging"||i.dragStatus==="stopped")&&(Tt.DD.justDragged=!0,Ul.Konva._mouseListenClick=!1,Ul.Konva._touchListenClick=!1,Ul.Konva._pointerListenClick=!1,i.dragStatus="stopped");let r=i.node.getLayer()||i.node instanceof Ul.Konva.Stage&&i.node;r&&t.indexOf(r)===-1&&t.push(r)}),t.forEach(i=>{i.draw()})},_endDragAfter(e){Tt.DD._dragElements.forEach((t,i)=>{t.dragStatus==="stopped"&&t.node.fire("dragend",{type:"dragend",target:t.node,evt:e},!0),t.dragStatus!=="dragging"&&Tt.DD._dragElements.delete(i)})}};Ul.Konva.isBrowser&&(window.addEventListener("mouseup",Tt.DD._endDragBefore,!0),window.addEventListener("touchend",Tt.DD._endDragBefore,!0),window.addEventListener("touchcancel",Tt.DD._endDragBefore,!0),window.addEventListener("mousemove",Tt.DD._drag),window.addEventListener("touchmove",Tt.DD._drag),window.addEventListener("mouseup",Tt.DD._endDragAfter,!1),window.addEventListener("touchend",Tt.DD._endDragAfter,!1),window.addEventListener("touchcancel",Tt.DD._endDragAfter,!1))});var Te=oe(Di=>{"use strict";Object.defineProperty(Di,"__esModule",{value:!0});Di.RGBComponent=ZA;Di.alphaComponent=e7;Di.getNumberValidator=t7;Di.getNumberOrArrayOfNumbersValidator=i7;Di.getNumberOrAutoValidator=n7;Di.getStringValidator=s7;Di.getStringOrGradientValidator=o7;Di.getFunctionValidator=r7;Di.getNumberArrayValidator=a7;Di.getBooleanValidator=l7;Di.getComponentValidator=d7;var as=De(),ht=at();function ls(e){return ht.Util._isString(e)?'"'+e+'"':Object.prototype.toString.call(e)==="[object Number]"||ht.Util._isBoolean(e)?e:Object.prototype.toString.call(e)}function ZA(e){return e>255?255:e<0?0:Math.round(e)}function e7(e){return e>1?1:e<1e-4?1e-4:e}function t7(){if(as.Konva.isUnminified)return function(e,t){return ht.Util._isNumber(e)||ht.Util.warn(ls(e)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),e}}function i7(e){if(as.Konva.isUnminified)return function(t,i){let n=ht.Util._isNumber(t),s=ht.Util._isArray(t)&&t.length==e;return!n&&!s&&ht.Util.warn(ls(t)+' is a not valid value for "'+i+'" attribute. The value should be a number or Array<number>('+e+")"),t}}function n7(){if(as.Konva.isUnminified)return function(e,t){return ht.Util._isNumber(e)||e==="auto"||ht.Util.warn(ls(e)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),e}}function s7(){if(as.Konva.isUnminified)return function(e,t){return ht.Util._isString(e)||ht.Util.warn(ls(e)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),e}}function o7(){if(as.Konva.isUnminified)return function(e,t){let i=ht.Util._isString(e),n=Object.prototype.toString.call(e)==="[object CanvasGradient]"||e&&e.addColorStop;return i||n||ht.Util.warn(ls(e)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),e}}function r7(){if(as.Konva.isUnminified)return function(e,t){return ht.Util._isFunction(e)||ht.Util.warn(ls(e)+' is a not valid value for "'+t+'" attribute. The value should be a function.'),e}}function a7(){if(as.Konva.isUnminified)return function(e,t){let i=Int8Array?Object.getPrototypeOf(Int8Array):null;return i&&e instanceof i||(ht.Util._isArray(e)?e.forEach(function(n){ht.Util._isNumber(n)||ht.Util.warn('"'+t+'" attribute has non numeric element '+n+". Make sure that all elements are numbers.")}):ht.Util.warn(ls(e)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),e}}function l7(){if(as.Konva.isUnminified)return function(e,t){return e===!0||e===!1||ht.Util.warn(ls(e)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),e}}function d7(e){if(as.Konva.isUnminified)return function(t,i){return t==null||ht.Util.isObject(t)||ht.Util.warn(ls(t)+' is a not valid value for "'+i+'" attribute. The value should be an object with properties '+e),t}}});var Pe=oe(Zi=>{"use strict";Object.defineProperty(Zi,"__esModule",{value:!0});Zi.Factory=void 0;var ki=at(),c7=Te(),ql="get",$l="set";Zi.Factory={addGetterSetter(e,t,i,n,s){Zi.Factory.addGetter(e,t,i),Zi.Factory.addSetter(e,t,n,s),Zi.Factory.addOverloadedGetterSetter(e,t)},addGetter(e,t,i){let n=ql+ki.Util._capitalize(t);e.prototype[n]=e.prototype[n]||function(){let s=this.attrs[t];return s===void 0?i:s}},addSetter(e,t,i,n){let s=$l+ki.Util._capitalize(t);e.prototype[s]||Zi.Factory.overWriteSetter(e,t,i,n)},overWriteSetter(e,t,i,n){let s=$l+ki.Util._capitalize(t);e.prototype[s]=function(o){return i&&o!==void 0&&o!==null&&(o=i.call(this,o,t)),this._setAttr(t,o),n&&n.call(this),this}},addComponentsGetterSetter(e,t,i,n,s){let o=i.length,r=ki.Util._capitalize,a=ql+r(t),l=$l+r(t);e.prototype[a]=function(){let c={};for(let u=0;u<o;u++){let h=i[u];c[h]=this.getAttr(t+r(h))}return c};let d=(0,c7.getComponentValidator)(i);e.prototype[l]=function(c){let u=this.attrs[t];n&&(c=n.call(this,c,t)),d&&d.call(this,c,t);for(let h in c)c.hasOwnProperty(h)&&this._setAttr(t+r(h),c[h]);return c||i.forEach(h=>{this._setAttr(t+r(h),void 0)}),this._fireChangeEvent(t,u,c),s&&s.call(this),this},Zi.Factory.addOverloadedGetterSetter(e,t)},addOverloadedGetterSetter(e,t){let i=ki.Util._capitalize(t),n=$l+i,s=ql+i;e.prototype[t]=function(){return arguments.length?(this[n](arguments[0]),this):this[s]()}},addDeprecatedGetterSetter(e,t,i,n){ki.Util.error("Adding deprecated "+t);let s=ql+ki.Util._capitalize(t),o=t+" property is deprecated and will be removed soon. Look at Konva change log for more information.";e.prototype[s]=function(){ki.Util.error(o);let r=this.attrs[t];return r===void 0?i:r},Zi.Factory.addSetter(e,t,n,function(){ki.Util.error(o)}),Zi.Factory.addOverloadedGetterSetter(e,t)},backCompat(e,t){ki.Util.each(t,function(i,n){let s=e.prototype[n],o=ql+ki.Util._capitalize(i),r=$l+ki.Util._capitalize(i);function a(){s.apply(this,arguments),ki.Util.error('"'+i+'" method is deprecated and will be removed soon. Use ""'+n+'" instead.')}e.prototype[i]=a,e.prototype[o]=a,e.prototype[r]=a})},afterSetFilter(){this._filterUpToDate=!1}}});var pt=oe(Ju=>{"use strict";Object.defineProperty(Ju,"__esModule",{value:!0});Ju.Node=void 0;var ia=Wl(),zi=ju(),jl=Pe(),qs=De(),_e=at(),ft=Te(),Yu="absoluteOpacity",Ku="allEventListeners",ds="absoluteTransform",L3="absoluteScale",qo="canvas",u7="Change",h7="children",p7="konva",b0="listening",g7="mouseenter",f7="mouseleave",m7="pointerenter",C7="pointerleave",v7="touchenter",w7="touchleave",O3="set",N3="Shape",Xu=" ",B3="stage",$s="transform",b7="Stage",y0="visible",y7=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(Xu),S7=1,we=class e{constructor(t){this._id=S7++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===$s||t===ds)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,i){let n=this._cache.get(t);return(n===void 0||(t===$s||t===ds)&&n.dirty===!0)&&(n=i.call(this),this._cache.set(t,n)),n}_calculate(t,i,n){if(!this._attachedDepsListeners.get(t)){let s=i.map(o=>o+"Change.konva").join(Xu);this.on(s,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,n)}_getCanvasCache(){return this._cache.get(qo)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===ds&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(qo)){let{scene:t,filter:i,hit:n,buffer:s}=this._cache.get(qo);_e.Util.releaseCanvas(t,i,n,s),this._cache.delete(qo)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){let i=t||{},n={};(i.x===void 0||i.y===void 0||i.width===void 0||i.height===void 0)&&(n=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let s=Math.ceil(i.width||n.width),o=Math.ceil(i.height||n.height),r=i.pixelRatio,a=i.x===void 0?Math.floor(n.x):i.x,l=i.y===void 0?Math.floor(n.y):i.y,d=i.offset||0,c=i.drawBorder||!1,u=i.hitCanvasPixelRatio||1;if(!s||!o){_e.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}let h=Math.abs(Math.round(n.x)-a)>.5?1:0,p=Math.abs(Math.round(n.y)-l)>.5?1:0;s+=d*2+h,o+=d*2+p,a-=d,l-=d;let g=new ia.SceneCanvas({pixelRatio:r,width:s,height:o}),f=new ia.SceneCanvas({pixelRatio:r,width:0,height:0,willReadFrequently:!0}),m=new ia.HitCanvas({pixelRatio:u,width:s,height:o}),C=g.getContext(),v=m.getContext(),w=new ia.SceneCanvas({width:g.width/g.pixelRatio+Math.abs(a),height:g.height/g.pixelRatio+Math.abs(l),pixelRatio:g.pixelRatio}),y=w.getContext();return m.isCache=!0,g.isCache=!0,this._cache.delete(qo),this._filterUpToDate=!1,i.imageSmoothingEnabled===!1&&(g.getContext()._context.imageSmoothingEnabled=!1,f.getContext()._context.imageSmoothingEnabled=!1),C.save(),v.save(),y.save(),C.translate(-a,-l),v.translate(-a,-l),y.translate(-a,-l),w.x=a,w.y=l,this._isUnderCache=!0,this._clearSelfAndDescendantCache(Yu),this._clearSelfAndDescendantCache(L3),this.drawScene(g,this,w),this.drawHit(m,this),this._isUnderCache=!1,C.restore(),v.restore(),c&&(C.save(),C.beginPath(),C.rect(0,0,s,o),C.closePath(),C.setAttr("strokeStyle","red"),C.setAttr("lineWidth",5),C.stroke(),C.restore()),this._cache.set(qo,{scene:g,filter:f,hit:m,buffer:w,x:a,y:l}),this._requestDraw(),this}isCached(){return this._cache.has(qo)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,i){let n=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],s=1/0,o=1/0,r=-1/0,a=-1/0,l=this.getAbsoluteTransform(i);return n.forEach(function(d){let c=l.point(d);s===void 0&&(s=r=c.x,o=a=c.y),s=Math.min(s,c.x),o=Math.min(o,c.y),r=Math.max(r,c.x),a=Math.max(a,c.y)}),{x:s,y:o,width:r-s,height:a-o}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);let i=this._getCanvasCache();t.translate(i.x,i.y);let n=this._getCachedSceneCanvas(),s=n.pixelRatio;t.drawImage(n._canvas,0,0,n.width/s,n.height/s),t.restore()}_drawCachedHitCanvas(t){let i=this._getCanvasCache(),n=i.hit;t.save(),t.translate(i.x,i.y),t.drawImage(n._canvas,0,0,n.width/n.pixelRatio,n.height/n.pixelRatio),t.restore()}_getCachedSceneCanvas(){let t=this.filters(),i=this._getCanvasCache(),n=i.scene,s=i.filter,o=s.getContext(),r,a,l,d;if(t){if(!this._filterUpToDate){let c=n.pixelRatio;s.setSize(n.width/n.pixelRatio,n.height/n.pixelRatio);try{for(r=t.length,o.clear(),o.drawImage(n._canvas,0,0,n.getWidth()/c,n.getHeight()/c),a=o.getImageData(0,0,s.getWidth(),s.getHeight()),l=0;l<r;l++){if(d=t[l],typeof d!="function"){_e.Util.error("Filter should be type of function, but got "+typeof d+" instead. Please check correct filters");continue}d.call(this,a),o.putImageData(a,0,0)}}catch(u){_e.Util.error("Unable to apply filter. "+u.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return s}return n}on(t,i){if(this._cache&&this._cache.delete(Ku),arguments.length===3)return this._delegate.apply(this,arguments);let n=t.split(Xu);for(let s=0;s<n.length;s++){let r=n[s].split("."),a=r[0],l=r[1]||"";this.eventListeners[a]||(this.eventListeners[a]=[]),this.eventListeners[a].push({name:l,handler:i})}return this}off(t,i){let n=(t||"").split(Xu),s=n.length,o,r,a,l,d,c;if(this._cache&&this._cache.delete(Ku),!t)for(r in this.eventListeners)this._off(r);for(o=0;o<s;o++)if(a=n[o],l=a.split("."),d=l[0],c=l[1],d)this.eventListeners[d]&&this._off(d,c,i);else for(r in this.eventListeners)this._off(r,c,i);return this}dispatchEvent(t){let i={target:this,type:t.type,evt:t};return this.fire(t.type,i),this}addEventListener(t,i){return this.on(t,function(n){i.call(this,n.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,i,n){let s=this;this.on(t,function(o){let r=o.target.findAncestors(i,!0,s);for(let a=0;a<r.length;a++)o=_e.Util.cloneObject(o),o.currentTarget=r[a],n.call(r[a],o)})}remove(){return this.isDragging()&&this.stopDrag(),zi.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(ds),this._clearSelfAndDescendantCache(Yu),this._clearSelfAndDescendantCache(L3),this._clearSelfAndDescendantCache(B3),this._clearSelfAndDescendantCache(y0),this._clearSelfAndDescendantCache(b0)}_remove(){this._clearCaches();let t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){let i="get"+_e.Util._capitalize(t);return _e.Util._isFunction(this[i])?this[i]():this.attrs[t]}getAncestors(){let t=this.getParent(),i=[];for(;t;)i.push(t),t=t.getParent();return i}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{let i,n;if(!t)return this;for(i in t)i!==h7&&(n=O3+_e.Util._capitalize(i),_e.Util._isFunction(this[n])?this[n](t[i]):this._setAttr(i,t[i]))}),this}isListening(){return this._getCache(b0,this._isListening)}_isListening(t){if(!this.listening())return!1;let n=this.getParent();return n&&n!==t&&this!==t?n._isListening(t):!0}isVisible(){return this._getCache(y0,this._isVisible)}_isVisible(t){if(!this.visible())return!1;let n=this.getParent();return n&&n!==t&&this!==t?n._isVisible(t):!0}shouldDrawHit(t,i=!1){if(t)return this._isVisible(t)&&this._isListening(t);let n=this.getLayer(),s=!1;zi.DD._dragElements.forEach(r=>{r.dragStatus==="dragging"&&(r.node.nodeType==="Stage"||r.node.getLayer()===n)&&(s=!0)});let o=!i&&!qs.Konva.hitOnDragEnabled&&(s||qs.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!o}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let t=this.getDepth(),i=this,n=0,s,o,r,a;function l(c){for(s=[],o=c.length,r=0;r<o;r++)a=c[r],n++,a.nodeType!==N3&&(s=s.concat(a.getChildren().slice())),a._id===i._id&&(r=o);s.length>0&&s[0].getDepth()<=t&&l(s)}let d=this.getStage();return i.nodeType!==b7&&d&&l(d.getChildren()),n}getDepth(){let t=0,i=this.parent;for(;i;)t++,i=i.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache($s),this._clearSelfAndDescendantCache(ds)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){let t=this.getStage();if(!t)return null;let i=t.getPointerPosition();if(!i)return null;let n=this.getAbsoluteTransform().copy();return n.invert(),n.point(i)}getAbsolutePosition(t){let i=!1,n=this.parent;for(;n;){if(n.isCached()){i=!0;break}n=n.parent}i&&!t&&(t=!0);let s=this.getAbsoluteTransform(t).getMatrix(),o=new _e.Transform,r=this.offset();return o.m=s.slice(),o.translate(r.x,r.y),o.getTranslation()}setAbsolutePosition(t){let r=this._clearTransform(),{x:i,y:n}=r,s=gi(r,["x","y"]);this.attrs.x=i,this.attrs.y=n,this._clearCache($s);let o=this._getAbsoluteTransform().copy();return o.invert(),o.translate(t.x,t.y),t={x:this.attrs.x+o.getTranslation().x,y:this.attrs.y+o.getTranslation().y},this._setTransform(s),this.setPosition({x:t.x,y:t.y}),this._clearCache($s),this._clearSelfAndDescendantCache(ds),this}_setTransform(t){let i;for(i in t)this.attrs[i]=t[i]}_clearTransform(){let t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){let i=t.x,n=t.y,s=this.x(),o=this.y();return i!==void 0&&(s+=i),n!==void 0&&(o+=n),this.setPosition({x:s,y:o}),this}_eachAncestorReverse(t,i){let n=[],s=this.getParent(),o,r;if(!(i&&i._id===this._id)){for(n.unshift(this);s&&(!i||s._id!==i._id);)n.unshift(s),s=s.parent;for(o=n.length,r=0;r<o;r++)t(n[r])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return _e.Util.warn("Node has no parent. moveToTop function is ignored."),!1;let t=this.index,i=this.parent.getChildren().length;return t<i-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return _e.Util.warn("Node has no parent. moveUp function is ignored."),!1;let t=this.index,i=this.parent.getChildren().length;return t<i-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return _e.Util.warn("Node has no parent. moveDown function is ignored."),!1;let t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return _e.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;let t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return _e.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&_e.Util.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");let i=this.index;return this.parent.children.splice(i,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(Yu,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let t=this.opacity(),i=this.getParent();return i&&!i._isUnderCache&&(t*=i.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){let t=this.getAttrs(),i,n,s,o,r,a={attrs:{},className:this.getClassName()};for(i in t)n=t[i],r=_e.Util.isObject(n)&&!_e.Util._isPlainObject(n)&&!_e.Util._isArray(n),!r&&(s=typeof this[i]=="function"&&this[i],delete t[i],o=s?s.call(this):null,t[i]=n,o!==n&&(a.attrs[i]=n));return _e.Util._prepareToStringify(a)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,i,n){let s=[];i&&this._isMatch(t)&&s.push(this);let o=this.parent;for(;o;){if(o===n)return s;o._isMatch(t)&&s.push(o),o=o.parent}return s}isAncestorOf(t){return!1}findAncestor(t,i,n){return this.findAncestors(t,i,n)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);let i=t.replace(/ /g,"").split(","),n=i.length,s,o;for(s=0;s<n;s++)if(o=i[s],_e.Util.isValidSelector(o)||(_e.Util.warn('Selector "'+o+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),_e.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),_e.Util.warn("Konva is awesome, right?")),o.charAt(0)==="#"){if(this.id()===o.slice(1))return!0}else if(o.charAt(0)==="."){if(this.hasName(o.slice(1)))return!0}else if(this.className===o||this.nodeType===o)return!0;return!1}getLayer(){let t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(B3,this._getStage)}_getStage(){let t=this.getParent();return t?t.getStage():null}fire(t,i={},n){return i.target=i.target||this,n?this._fireAndBubble(t,i):this._fire(t,i),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(ds,this._getAbsoluteTransform)}_getAbsoluteTransform(t){let i;if(t)return i=new _e.Transform,this._eachAncestorReverse(function(n){let s=n.transformsEnabled();s==="all"?i.multiply(n.getTransform()):s==="position"&&i.translate(n.x()-n.offsetX(),n.y()-n.offsetY())},t),i;{i=this._cache.get(ds)||new _e.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(i):i.reset();let n=this.transformsEnabled();if(n==="all")i.multiply(this.getTransform());else if(n==="position"){let s=this.attrs.x||0,o=this.attrs.y||0,r=this.attrs.offsetX||0,a=this.attrs.offsetY||0;i.translate(s-r,o-a)}return i.dirty=!1,i}}getAbsoluteScale(t){let i=this;for(;i;)i._isUnderCache&&(t=i),i=i.getParent();let s=this.getAbsoluteTransform(t).decompose();return{x:s.scaleX,y:s.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache($s,this._getTransform)}_getTransform(){var t,i;let n=this._cache.get($s)||new _e.Transform;n.reset();let s=this.x(),o=this.y(),r=qs.Konva.getAngle(this.rotation()),a=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,l=(i=this.attrs.scaleY)!==null&&i!==void 0?i:1,d=this.attrs.skewX||0,c=this.attrs.skewY||0,u=this.attrs.offsetX||0,h=this.attrs.offsetY||0;return(s!==0||o!==0)&&n.translate(s,o),r!==0&&n.rotate(r),(d!==0||c!==0)&&n.skew(d,c),(a!==1||l!==1)&&n.scale(a,l),(u!==0||h!==0)&&n.translate(-1*u,-1*h),n.dirty=!1,n}clone(t){let i=_e.Util.cloneObject(this.attrs),n,s,o,r,a;for(n in t)i[n]=t[n];let l=new this.constructor(i);for(n in this.eventListeners)for(s=this.eventListeners[n],o=s.length,r=0;r<o;r++)a=s[r],a.name.indexOf(p7)<0&&(l.eventListeners[n]||(l.eventListeners[n]=[]),l.eventListeners[n].push(a));return l}_toKonvaCanvas(t){t=t||{};let i=this.getClientRect(),n=this.getStage(),s=t.x!==void 0?t.x:Math.floor(i.x),o=t.y!==void 0?t.y:Math.floor(i.y),r=t.pixelRatio||1,a=new ia.SceneCanvas({width:t.width||Math.ceil(i.width)||(n?n.width():0),height:t.height||Math.ceil(i.height)||(n?n.height():0),pixelRatio:r}),l=a.getContext(),d=new ia.SceneCanvas({width:a.width/a.pixelRatio+Math.abs(s),height:a.height/a.pixelRatio+Math.abs(o),pixelRatio:a.pixelRatio});return t.imageSmoothingEnabled===!1&&(l._context.imageSmoothingEnabled=!1),l.save(),(s||o)&&l.translate(-1*s,-1*o),this.drawScene(a,void 0,d),l.restore(),a}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};let i=t.mimeType||null,n=t.quality||null,s=this._toKonvaCanvas(t).toDataURL(i,n);return t.callback&&t.callback(s),s}toImage(t){return new Promise((i,n)=>{try{let s=t?.callback;s&&delete t.callback,_e.Util._urlToImage(this.toDataURL(t),function(o){i(o),s?.(o)})}catch(s){n(s)}})}toBlob(t){return new Promise((i,n)=>{try{let s=t?.callback;s&&delete t.callback,this.toCanvas(t).toBlob(o=>{i(o),s?.(o)},t?.mimeType,t?.quality)}catch(s){n(s)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():qs.Konva.dragDistance}_off(t,i,n){let s=this.eventListeners[t],o,r,a;for(o=0;o<s.length;o++)if(r=s[o].name,a=s[o].handler,(r!=="konva"||i==="konva")&&(!i||r===i)&&(!n||n===a)){if(s.splice(o,1),s.length===0){delete this.eventListeners[t];break}o--}}_fireChangeEvent(t,i,n){this._fire(t+u7,{oldVal:i,newVal:n})}addName(t){if(!this.hasName(t)){let i=this.name(),n=i?i+" "+t:t;this.name(n)}return this}hasName(t){if(!t)return!1;let i=this.name();return i?(i||"").split(/\s/g).indexOf(t)!==-1:!1}removeName(t){let i=(this.name()||"").split(/\s/g),n=i.indexOf(t);return n!==-1&&(i.splice(n,1),this.name(i.join(" "))),this}setAttr(t,i){let n=this[O3+_e.Util._capitalize(t)];return _e.Util._isFunction(n)?n.call(this,i):this._setAttr(t,i),this}_requestDraw(){if(qs.Konva.autoDrawEnabled){let t=this.getLayer()||this.getStage();t?.batchDraw()}}_setAttr(t,i){let n=this.attrs[t];n===i&&!_e.Util.isObject(i)||(i==null?delete this.attrs[t]:this.attrs[t]=i,this._shouldFireChangeEvents&&this._fireChangeEvent(t,n,i),this._requestDraw())}_setComponentAttr(t,i,n){let s;n!==void 0&&(s=this.attrs[t],s||(this.attrs[t]=this.getAttr(t)),this.attrs[t][i]=n,this._fireChangeEvent(t,s,n))}_fireAndBubble(t,i,n){i&&this.nodeType===N3&&(i.target=this);let s=[g7,f7,m7,C7,v7,w7];if(!(s.indexOf(t)!==-1&&(n&&(this===n||this.isAncestorOf&&this.isAncestorOf(n))||this.nodeType==="Stage"&&!n))){this._fire(t,i);let r=s.indexOf(t)!==-1&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(i&&!i.cancelBubble||!i)&&this.parent&&this.parent.isListening()&&!r&&(n&&n.parent?this._fireAndBubble.call(this.parent,t,i,n):this._fireAndBubble.call(this.parent,t,i))}}_getProtoListeners(t){var i,n,s;let o=(i=this._cache.get(Ku))!==null&&i!==void 0?i:{},r=o?.[t];if(r===void 0){r=[];let a=Object.getPrototypeOf(this);for(;a;){let l=(s=(n=a.eventListeners)===null||n===void 0?void 0:n[t])!==null&&s!==void 0?s:[];r.push(...l),a=Object.getPrototypeOf(a)}o[t]=r,this._cache.set(Ku,o)}return r}_fire(t,i){i=i||{},i.currentTarget=this,i.type=t;let n=this._getProtoListeners(t);if(n)for(let o=0;o<n.length;o++)n[o].handler.call(this,i);let s=this.eventListeners[t];if(s)for(let o=0;o<s.length;o++)s[o].handler.call(this,i)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){let i=t?t.pointerId:void 0,n=this.getStage(),s=this.getAbsolutePosition();if(!n)return;let o=n._getPointerById(i)||n._changedPointerPositions[0]||s;zi.DD._dragElements.set(this._id,{node:this,startPointerPos:o,offset:{x:o.x-s.x,y:o.y-s.y},dragStatus:"ready",pointerId:i})}startDrag(t,i=!0){zi.DD._dragElements.has(this._id)||this._createDragElement(t);let n=zi.DD._dragElements.get(this._id);n.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},i)}_setDragPosition(t,i){let n=this.getStage()._getPointerById(i.pointerId);if(!n)return;let s={x:n.x-i.offset.x,y:n.y-i.offset.y},o=this.dragBoundFunc();if(o!==void 0){let r=o.call(this,s,t);r?s=r:_e.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==s.x||this._lastPos.y!==s.y)&&(this.setAbsolutePosition(s),this._requestDraw()),this._lastPos=s}stopDrag(t){let i=zi.DD._dragElements.get(this._id);i&&(i.dragStatus="stopped"),zi.DD._endDragBefore(t),zi.DD._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){let t=zi.DD._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){if(!(!(t.evt.button!==void 0)||qs.Konva.dragButtons.indexOf(t.evt.button)>=0)||this.isDragging())return;let s=!1;zi.DD._dragElements.forEach(o=>{this.isAncestorOf(o.node)&&(s=!0)}),s||this._createDragElement(t)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;let i=zi.DD._dragElements.get(this._id),n=i&&i.dragStatus==="dragging",s=i&&i.dragStatus==="ready";n?this.stopDrag():s&&zi.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){let i=this.getStage();if(!i)return!1;let n={x:-t.x,y:-t.y,width:i.width()+2*t.x,height:i.height()+2*t.y};return _e.Util.haveIntersection(n,this.getClientRect())}static create(t,i){return _e.Util._isString(t)&&(t=JSON.parse(t)),this._createNode(t,i)}static _createNode(t,i){let n=e.prototype.getClassName.call(t),s=t.children,o,r,a;i&&(t.attrs.container=i),qs.Konva[n]||(_e.Util.warn('Can not find a node with class name "'+n+'". Fallback to "Shape".'),n="Shape");let l=qs.Konva[n];if(o=new l(t.attrs),s)for(r=s.length,a=0;a<r;a++)o.add(e._createNode(s[a]));return o}};Ju.Node=we;we.prototype.nodeType="Node";we.prototype._attrsAffectingSize=[];we.prototype.eventListeners={};we.prototype.on.call(we.prototype,y7,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache($s),this._clearSelfAndDescendantCache(ds)});we.prototype.on.call(we.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(y0)});we.prototype.on.call(we.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(b0)});we.prototype.on.call(we.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(Yu)});var Ke=jl.Factory.addGetterSetter;Ke(we,"zIndex");Ke(we,"absolutePosition");Ke(we,"position");Ke(we,"x",0,(0,ft.getNumberValidator)());Ke(we,"y",0,(0,ft.getNumberValidator)());Ke(we,"globalCompositeOperation","source-over",(0,ft.getStringValidator)());Ke(we,"opacity",1,(0,ft.getNumberValidator)());Ke(we,"name","",(0,ft.getStringValidator)());Ke(we,"id","",(0,ft.getStringValidator)());Ke(we,"rotation",0,(0,ft.getNumberValidator)());jl.Factory.addComponentsGetterSetter(we,"scale",["x","y"]);Ke(we,"scaleX",1,(0,ft.getNumberValidator)());Ke(we,"scaleY",1,(0,ft.getNumberValidator)());jl.Factory.addComponentsGetterSetter(we,"skew",["x","y"]);Ke(we,"skewX",0,(0,ft.getNumberValidator)());Ke(we,"skewY",0,(0,ft.getNumberValidator)());jl.Factory.addComponentsGetterSetter(we,"offset",["x","y"]);Ke(we,"offsetX",0,(0,ft.getNumberValidator)());Ke(we,"offsetY",0,(0,ft.getNumberValidator)());Ke(we,"dragDistance",void 0,(0,ft.getNumberValidator)());Ke(we,"width",0,(0,ft.getNumberValidator)());Ke(we,"height",0,(0,ft.getNumberValidator)());Ke(we,"listening",!0,(0,ft.getBooleanValidator)());Ke(we,"preventDefault",!0,(0,ft.getBooleanValidator)());Ke(we,"filters",void 0,function(e){return this._filterUpToDate=!1,e});Ke(we,"visible",!0,(0,ft.getBooleanValidator)());Ke(we,"transformsEnabled","all",(0,ft.getStringValidator)());Ke(we,"size");Ke(we,"dragBoundFunc");Ke(we,"draggable",!1,(0,ft.getBooleanValidator)());jl.Factory.backCompat(we,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"})});var Kl=oe(Zu=>{"use strict";Object.defineProperty(Zu,"__esModule",{value:!0});Zu.Container=void 0;var na=Pe(),S0=pt(),Qu=Te(),cs=class extends S0.Node{constructor(){super(...arguments),this.children=[]}getChildren(t){let i=this.children||[];return t?i.filter(t):i}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(let n=0;n<t.length;n++)this.add(t[n]);return this}let i=t[0];return i.getParent()?(i.moveTo(this),this):(this._validateAdd(i),i.index=this.getChildren().length,i.parent=this,i._clearCaches(),this.getChildren().push(i),this._fire("add",{child:i}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){let i=this._generalFind(t,!0);return i.length>0?i[0]:void 0}_generalFind(t,i){let n=[];return this._descendants(s=>{let o=s._isMatch(t);return o&&n.push(s),!!(o&&i)}),n}_descendants(t){let i=!1,n=this.getChildren();for(let s of n){if(i=t(s),i)return!0;if(s.hasChildren()&&(i=s._descendants(t),i))return!0}return!1}toObject(){let t=S0.Node.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(i=>{t.children.push(i.toObject())}),t}isAncestorOf(t){let i=t.getParent();for(;i;){if(i._id===this._id)return!0;i=i.getParent()}return!1}clone(t){let i=S0.Node.prototype.clone.call(this,t);return this.getChildren().forEach(function(n){i.add(n.clone())}),i}getAllIntersections(t){let i=[];return this.find("Shape").forEach(n=>{n.isVisible()&&n.intersects(t)&&i.push(n)}),i}_clearSelfAndDescendantCache(t){var i;super._clearSelfAndDescendantCache(t),!this.isCached()&&((i=this.children)===null||i===void 0||i.forEach(function(n){n._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(i,n){i.index=n}),this._requestDraw()}drawScene(t,i,n){let s=this.getLayer(),o=t||s&&s.getCanvas(),r=o&&o.getContext(),a=this._getCanvasCache(),l=a&&a.scene,d=o&&o.isCache;if(!this.isVisible()&&!d)return this;if(l){r.save();let c=this.getAbsoluteTransform(i).getMatrix();r.transform(c[0],c[1],c[2],c[3],c[4],c[5]),this._drawCachedSceneCanvas(r),r.restore()}else this._drawChildren("drawScene",o,i,n);return this}drawHit(t,i){if(!this.shouldDrawHit(i))return this;let n=this.getLayer(),s=t||n&&n.hitCanvas,o=s&&s.getContext(),r=this._getCanvasCache();if(r&&r.hit){o.save();let l=this.getAbsoluteTransform(i).getMatrix();o.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this._drawCachedHitCanvas(o),o.restore()}else this._drawChildren("drawHit",s,i);return this}_drawChildren(t,i,n,s){var o;let r=i&&i.getContext(),a=this.clipWidth(),l=this.clipHeight(),d=this.clipFunc(),c=typeof a=="number"&&typeof l=="number"||d,u=n===this;if(c){r.save();let p=this.getAbsoluteTransform(n),g=p.getMatrix();r.transform(g[0],g[1],g[2],g[3],g[4],g[5]),r.beginPath();let f;if(d)f=d.call(this,r,this);else{let m=this.clipX(),C=this.clipY();r.rect(m||0,C||0,a,l)}r.clip.apply(r,f),g=p.copy().invert().getMatrix(),r.transform(g[0],g[1],g[2],g[3],g[4],g[5])}let h=!u&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";h&&(r.save(),r._applyGlobalCompositeOperation(this)),(o=this.children)===null||o===void 0||o.forEach(function(p){p[t](i,n,s)}),h&&r.restore(),c&&r.restore()}getClientRect(t={}){var i;let n=t.skipTransform,s=t.relativeTo,o,r,a,l,d={x:1/0,y:1/0,width:0,height:0},c=this;(i=this.children)===null||i===void 0||i.forEach(function(p){if(!p.visible())return;let g=p.getClientRect({relativeTo:c,skipShadow:t.skipShadow,skipStroke:t.skipStroke});g.width===0&&g.height===0||(o===void 0?(o=g.x,r=g.y,a=g.x+g.width,l=g.y+g.height):(o=Math.min(o,g.x),r=Math.min(r,g.y),a=Math.max(a,g.x+g.width),l=Math.max(l,g.y+g.height)))});let u=this.find("Shape"),h=!1;for(let p=0;p<u.length;p++)if(u[p]._isVisible(this)){h=!0;break}return h&&o!==void 0?d={x:o,y:r,width:a-o,height:l-r}:d={x:0,y:0,width:0,height:0},n?d:this._transformedRect(d,s)}};Zu.Container=cs;na.Factory.addComponentsGetterSetter(cs,"clip",["x","y","width","height"]);na.Factory.addGetterSetter(cs,"clipX",void 0,(0,Qu.getNumberValidator)());na.Factory.addGetterSetter(cs,"clipY",void 0,(0,Qu.getNumberValidator)());na.Factory.addGetterSetter(cs,"clipWidth",void 0,(0,Qu.getNumberValidator)());na.Factory.addGetterSetter(cs,"clipHeight",void 0,(0,Qu.getNumberValidator)());na.Factory.addGetterSetter(cs,"clipFunc")});var E0=oe($o=>{"use strict";Object.defineProperty($o,"__esModule",{value:!0});$o.getCapturedShape=E7;$o.createEvent=x0;$o.hasPointerCapture=R7;$o.setPointerCapture=M7;$o.releaseCapture=V3;var x7=De(),Yl=new Map,H3=x7.Konva._global.PointerEvent!==void 0;function E7(e){return Yl.get(e)}function x0(e){return{evt:e,pointerId:e.pointerId}}function R7(e,t){return Yl.get(e)===t}function M7(e,t){V3(e),t.getStage()&&(Yl.set(e,t),H3&&t._fire("gotpointercapture",x0(new PointerEvent("gotpointercapture"))))}function V3(e,t){let i=Yl.get(e);if(!i)return;let n=i.getStage();n&&n.content,Yl.delete(e),H3&&i._fire("lostpointercapture",x0(new PointerEvent("lostpointercapture")))}});var F0=oe(Dn=>{"use strict";Object.defineProperty(Dn,"__esModule",{value:!0});Dn.Stage=Dn.stages=void 0;var Mn=at(),D7=Pe(),G3=Kl(),mt=De(),R0=Wl(),M0=ju(),k7=De(),us=E0(),P7="Stage",F7="string",z3="px",T7="mouseout",U3="mouseleave",q3="mouseover",$3="mouseenter",j3="mousemove",K3="mousedown",Y3="mouseup",Xl="pointermove",Jl="pointerdown",oa="pointerup",Ql="pointercancel",A7="lostpointercapture",eh="pointerout",Zl="pointerleave",th="pointerover",ih="pointerenter",k0="contextmenu",X3="touchstart",J3="touchend",Q3="touchmove",Z3="touchcancel",P0="wheel",I7=5,_7=[[$3,"_pointerenter"],[K3,"_pointerdown"],[j3,"_pointermove"],[Y3,"_pointerup"],[U3,"_pointerleave"],[X3,"_pointerdown"],[Q3,"_pointermove"],[J3,"_pointerup"],[Z3,"_pointercancel"],[q3,"_pointerover"],[P0,"_wheel"],[k0,"_contextmenu"],[Jl,"_pointerdown"],[Xl,"_pointermove"],[oa,"_pointerup"],[Ql,"_pointercancel"],[Zl,"_pointerleave"],[A7,"_lostpointercapture"]],D0={mouse:{[eh]:T7,[Zl]:U3,[th]:q3,[ih]:$3,[Xl]:j3,[Jl]:K3,[oa]:Y3,[Ql]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[eh]:"touchout",[Zl]:"touchleave",[th]:"touchover",[ih]:"touchenter",[Xl]:Q3,[Jl]:X3,[oa]:J3,[Ql]:Z3,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[eh]:eh,[Zl]:Zl,[th]:th,[ih]:ih,[Xl]:Xl,[Jl]:Jl,[oa]:oa,[Ql]:Ql,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},ed=e=>e.indexOf("pointer")>=0?"pointer":e.indexOf("touch")>=0?"touch":"mouse",sa=e=>{let t=ed(e);if(t==="pointer")return mt.Konva.pointerEventsEnabled&&D0.pointer;if(t==="touch")return D0.touch;if(t==="mouse")return D0.mouse};function W3(e={}){return(e.clipFunc||e.clipWidth||e.clipHeight)&&Mn.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),e}var L7="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";Dn.stages=[];var ra=class extends G3.Container{constructor(t){super(W3(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),Dn.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{W3(this.attrs)}),this._checkVisibility()}_validateAdd(t){let i=t.getType()==="Layer",n=t.getType()==="FastLayer";i||n||Mn.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;let t=this.visible()?"":"none";this.content.style.display=t}setContainer(t){if(typeof t===F7){let i;if(t.charAt(0)==="."){let n=t.slice(1);t=document.getElementsByClassName(n)[0]}else t.charAt(0)!=="#"?i=t:i=t.slice(1),t=document.getElementById(i);if(!t)throw"Can not find container in document with id "+i}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){let t=this.children,i=t.length;for(let n=0;n<i;n++)t[n].clear();return this}clone(t){return t||(t={}),t.container=typeof document<"u"&&document.createElement("div"),G3.Container.prototype.clone.call(this,t)}destroy(){super.destroy();let t=this.content;t&&Mn.Util._isInDocument(t)&&this.container().removeChild(t);let i=Dn.stages.indexOf(this);return i>-1&&Dn.stages.splice(i,1),Mn.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){let t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(Mn.Util.warn(L7),null)}_getPointerById(t){return this._pointerPositions.find(i=>i.id===t)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(t){t=t||{},t.x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();let i=new R0.SceneCanvas({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),n=i.getContext()._context,s=this.children;return(t.x||t.y)&&n.translate(-1*t.x,-1*t.y),s.forEach(function(o){if(!o.isVisible())return;let r=o._toKonvaCanvas(t);n.drawImage(r._canvas,t.x,t.y,r.getWidth()/r.getPixelRatio(),r.getHeight()/r.getPixelRatio())}),i}getIntersection(t){if(!t)return null;let i=this.children,n=i.length,s=n-1;for(let o=s;o>=0;o--){let r=i[o].getIntersection(t);if(r)return r}return null}_resizeDOM(){let t=this.width(),i=this.height();this.content&&(this.content.style.width=t+z3,this.content.style.height=i+z3),this.bufferCanvas.setSize(t,i),this.bufferHitCanvas.setSize(t,i),this.children.forEach(n=>{n.setSize({width:t,height:i}),n.draw()})}add(t,...i){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.add(arguments[s]);return this}super.add(t);let n=this.children.length;return n>I7&&Mn.Util.warn("The stage has "+n+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),t.setSize({width:this.width(),height:this.height()}),t.draw(),mt.Konva.isBrowser&&this.content.appendChild(t.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(t){return us.hasPointerCapture(t,this)}setPointerCapture(t){us.setPointerCapture(t,this)}releaseCapture(t){us.releaseCapture(t,this)}getLayers(){return this.children}_bindContentEvents(){mt.Konva.isBrowser&&_7.forEach(([t,i])=>{this.content.addEventListener(t,n=>{this[i](n)},{passive:!1})})}_pointerenter(t){this.setPointersPositions(t);let i=sa(t.type);i&&this._fire(i.pointerenter,{evt:t,target:this,currentTarget:this})}_pointerover(t){this.setPointersPositions(t);let i=sa(t.type);i&&this._fire(i.pointerover,{evt:t,target:this,currentTarget:this})}_getTargetShape(t){let i=this[t+"targetShape"];return i&&!i.getStage()&&(i=null),i}_pointerleave(t){let i=sa(t.type),n=ed(t.type);if(!i)return;this.setPointersPositions(t);let s=this._getTargetShape(n),o=!(mt.Konva.isDragging()||mt.Konva.isTransforming())||mt.Konva.hitOnDragEnabled;s&&o?(s._fireAndBubble(i.pointerout,{evt:t}),s._fireAndBubble(i.pointerleave,{evt:t}),this._fire(i.pointerleave,{evt:t,target:this,currentTarget:this}),this[n+"targetShape"]=null):o&&(this._fire(i.pointerleave,{evt:t,target:this,currentTarget:this}),this._fire(i.pointerout,{evt:t,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(t){let i=sa(t.type),n=ed(t.type);if(!i)return;this.setPointersPositions(t);let s=!1;this._changedPointerPositions.forEach(o=>{let r=this.getIntersection(o);if(M0.DD.justDragged=!1,mt.Konva["_"+n+"ListenClick"]=!0,!r||!r.isListening()){this[n+"ClickStartShape"]=void 0;return}mt.Konva.capturePointerEventsEnabled&&r.setPointerCapture(o.id),this[n+"ClickStartShape"]=r,r._fireAndBubble(i.pointerdown,{evt:t,pointerId:o.id}),s=!0;let a=t.type.indexOf("touch")>=0;r.preventDefault()&&t.cancelable&&a&&t.preventDefault()}),s||this._fire(i.pointerdown,{evt:t,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(t){let i=sa(t.type),n=ed(t.type);if(!i||(mt.Konva.isDragging()&&M0.DD.node.preventDefault()&&t.cancelable&&t.preventDefault(),this.setPointersPositions(t),!(!(mt.Konva.isDragging()||mt.Konva.isTransforming())||mt.Konva.hitOnDragEnabled)))return;let o={},r=!1,a=this._getTargetShape(n);this._changedPointerPositions.forEach(l=>{let d=us.getCapturedShape(l.id)||this.getIntersection(l),c=l.id,u={evt:t,pointerId:c},h=a!==d;if(h&&a&&(a._fireAndBubble(i.pointerout,b({},u),d),a._fireAndBubble(i.pointerleave,b({},u),d)),d){if(o[d._id])return;o[d._id]=!0}d&&d.isListening()?(r=!0,h&&(d._fireAndBubble(i.pointerover,b({},u),a),d._fireAndBubble(i.pointerenter,b({},u),a),this[n+"targetShape"]=d),d._fireAndBubble(i.pointermove,b({},u))):a&&(this._fire(i.pointerover,{evt:t,target:this,currentTarget:this,pointerId:c}),this[n+"targetShape"]=null)}),r||this._fire(i.pointermove,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(t){let i=sa(t.type),n=ed(t.type);if(!i)return;this.setPointersPositions(t);let s=this[n+"ClickStartShape"],o=this[n+"ClickEndShape"],r={},a=!1;this._changedPointerPositions.forEach(l=>{let d=us.getCapturedShape(l.id)||this.getIntersection(l);if(d){if(d.releaseCapture(l.id),r[d._id])return;r[d._id]=!0}let c=l.id,u={evt:t,pointerId:c},h=!1;mt.Konva["_"+n+"InDblClickWindow"]?(h=!0,clearTimeout(this[n+"DblTimeout"])):M0.DD.justDragged||(mt.Konva["_"+n+"InDblClickWindow"]=!0,clearTimeout(this[n+"DblTimeout"])),this[n+"DblTimeout"]=setTimeout(function(){mt.Konva["_"+n+"InDblClickWindow"]=!1},mt.Konva.dblClickWindow),d&&d.isListening()?(a=!0,this[n+"ClickEndShape"]=d,d._fireAndBubble(i.pointerup,b({},u)),mt.Konva["_"+n+"ListenClick"]&&s&&s===d&&(d._fireAndBubble(i.pointerclick,b({},u)),h&&o&&o===d&&d._fireAndBubble(i.pointerdblclick,b({},u)))):(this[n+"ClickEndShape"]=null,mt.Konva["_"+n+"ListenClick"]&&this._fire(i.pointerclick,{evt:t,target:this,currentTarget:this,pointerId:c}),h&&this._fire(i.pointerdblclick,{evt:t,target:this,currentTarget:this,pointerId:c}))}),a||this._fire(i.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),mt.Konva["_"+n+"ListenClick"]=!1,t.cancelable&&n!=="touch"&&n!=="pointer"&&t.preventDefault()}_contextmenu(t){this.setPointersPositions(t);let i=this.getIntersection(this.getPointerPosition());i&&i.isListening()?i._fireAndBubble(k0,{evt:t}):this._fire(k0,{evt:t,target:this,currentTarget:this})}_wheel(t){this.setPointersPositions(t);let i=this.getIntersection(this.getPointerPosition());i&&i.isListening()?i._fireAndBubble(P0,{evt:t}):this._fire(P0,{evt:t,target:this,currentTarget:this})}_pointercancel(t){this.setPointersPositions(t);let i=us.getCapturedShape(t.pointerId)||this.getIntersection(this.getPointerPosition());i&&i._fireAndBubble(oa,us.createEvent(t)),us.releaseCapture(t.pointerId)}_lostpointercapture(t){us.releaseCapture(t.pointerId)}setPointersPositions(t){let i=this._getContentPosition(),n=null,s=null;t=t||window.event,t.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(t.touches,o=>{this._pointerPositions.push({id:o.identifier,x:(o.clientX-i.left)/i.scaleX,y:(o.clientY-i.top)/i.scaleY})}),Array.prototype.forEach.call(t.changedTouches||t.touches,o=>{this._changedPointerPositions.push({id:o.identifier,x:(o.clientX-i.left)/i.scaleX,y:(o.clientY-i.top)/i.scaleY})})):(n=(t.clientX-i.left)/i.scaleX,s=(t.clientY-i.top)/i.scaleY,this.pointerPos={x:n,y:s},this._pointerPositions=[{x:n,y:s,id:Mn.Util._getFirstPointerId(t)}],this._changedPointerPositions=[{x:n,y:s,id:Mn.Util._getFirstPointerId(t)}])}_setPointerPosition(t){Mn.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};let t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new R0.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new R0.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!mt.Konva.isBrowser)return;let t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}cache(){return Mn.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(t){t.batchDraw()}),this}};Dn.Stage=ra;ra.prototype.nodeType=P7;(0,k7._registerNode)(ra);D7.Factory.addGetterSetter(ra,"container");mt.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{Dn.stages.forEach(e=>{e.batchDraw()})})});var Dt=oe(hs=>{"use strict";Object.defineProperty(hs,"__esModule",{value:!0});hs.Shape=hs.shapes=void 0;var O7=De(),kn=at(),ie=Pe(),ex=pt(),Mt=Te(),N7=De(),T0=E0(),tx="hasShadow",ix="shadowRGBA",nx="patternImage",sx="linearGradient",ox="radialGradient",nh;function A0(){return nh||(nh=kn.Util.createCanvasElement().getContext("2d"),nh)}hs.shapes={};function B7(e){let t=this.attrs.fillRule;t?e.fill(t):e.fill()}function H7(e){e.stroke()}function V7(e){let t=this.attrs.fillRule;t?e.fill(t):e.fill()}function G7(e){e.stroke()}function z7(){this._clearCache(tx)}function W7(){this._clearCache(ix)}function U7(){this._clearCache(nx)}function q7(){this._clearCache(sx)}function $7(){this._clearCache(ox)}var j=class extends ex.Node{constructor(t){super(t);let i;for(;i=kn.Util.getRandomColor(),!(i&&!(i in hs.shapes)););this.colorKey=i,hs.shapes[i]=this}getContext(){return kn.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return kn.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(tx,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(nx,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){let i=A0().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(i&&i.setTransform){let n=new kn.Transform;n.translate(this.fillPatternX(),this.fillPatternY()),n.rotate(O7.Konva.getAngle(this.fillPatternRotation())),n.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),n.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());let s=n.getMatrix(),o=typeof DOMMatrix>"u"?{a:s[0],b:s[1],c:s[2],d:s[3],e:s[4],f:s[5]}:new DOMMatrix(s);i.setTransform(o)}return i}}_getLinearGradient(){return this._getCache(sx,this.__getLinearGradient)}__getLinearGradient(){let t=this.fillLinearGradientColorStops();if(t){let i=A0(),n=this.fillLinearGradientStartPoint(),s=this.fillLinearGradientEndPoint(),o=i.createLinearGradient(n.x,n.y,s.x,s.y);for(let r=0;r<t.length;r+=2)o.addColorStop(t[r],t[r+1]);return o}}_getRadialGradient(){return this._getCache(ox,this.__getRadialGradient)}__getRadialGradient(){let t=this.fillRadialGradientColorStops();if(t){let i=A0(),n=this.fillRadialGradientStartPoint(),s=this.fillRadialGradientEndPoint(),o=i.createRadialGradient(n.x,n.y,this.fillRadialGradientStartRadius(),s.x,s.y,this.fillRadialGradientEndRadius());for(let r=0;r<t.length;r+=2)o.addColorStop(t[r],t[r+1]);return o}}getShadowRGBA(){return this._getCache(ix,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;let t=kn.Util.colorToRGBA(this.shadowColor());if(t)return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){let t=this.hitStrokeWidth();return t==="auto"?this.hasStroke():this.strokeEnabled()&&!!t}intersects(t){let i=this.getStage();if(!i)return!1;let n=i.bufferHitCanvas;return n.getContext().clear(),this.drawHit(n,void 0,!0),n.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data[3]>0}destroy(){return ex.Node.prototype.destroy.call(this),delete hs.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(t){var i;if(!((i=this.attrs.perfectDrawEnabled)!==null&&i!==void 0?i:!0))return!1;let s=t||this.hasFill(),o=this.hasStroke(),r=this.getAbsoluteOpacity()!==1;if(s&&o&&r)return!0;let a=this.hasShadow(),l=this.shadowForStrokeEnabled();return!!(s&&o&&a&&l)}setStrokeHitEnabled(t){kn.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){let t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}}getClientRect(t={}){let i=!1,n=this.getParent();for(;n;){if(n.isCached()){i=!0;break}n=n.getParent()}let s=t.skipTransform,o=t.relativeTo||i&&this.getStage()||void 0,r=this.getSelfRect(),l=!t.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,d=r.width+l,c=r.height+l,u=!t.skipShadow&&this.hasShadow(),h=u?this.shadowOffsetX():0,p=u?this.shadowOffsetY():0,g=d+Math.abs(h),f=c+Math.abs(p),m=u&&this.shadowBlur()||0,C=g+m*2,v=f+m*2,w={width:C,height:v,x:-(l/2+m)+Math.min(h,0)+r.x,y:-(l/2+m)+Math.min(p,0)+r.y};return s?w:this._transformedRect(w,o)}drawScene(t,i,n){let s=this.getLayer(),o=t||s.getCanvas(),r=o.getContext(),a=this._getCanvasCache(),l=this.getSceneFunc(),d=this.hasShadow(),c,u=!1,h=i===this;if(!this.isVisible()&&!h)return this;if(a){r.save();let p=this.getAbsoluteTransform(i).getMatrix();return r.transform(p[0],p[1],p[2],p[3],p[4],p[5]),this._drawCachedSceneCanvas(r),r.restore(),this}if(!l)return this;if(r.save(),this._useBufferCanvas()&&!u){c=this.getStage();let p=n||c.bufferCanvas,g=p.getContext();g.clear(),g.save(),g._applyLineJoin(this);let f=this.getAbsoluteTransform(i).getMatrix();g.transform(f[0],f[1],f[2],f[3],f[4],f[5]),l.call(this,g,this),g.restore();let m=p.pixelRatio;d&&r._applyShadow(this),r._applyOpacity(this),r._applyGlobalCompositeOperation(this),r.drawImage(p._canvas,p.x||0,p.y||0,p.width/m,p.height/m)}else{if(r._applyLineJoin(this),!h){let p=this.getAbsoluteTransform(i).getMatrix();r.transform(p[0],p[1],p[2],p[3],p[4],p[5]),r._applyOpacity(this),r._applyGlobalCompositeOperation(this)}d&&r._applyShadow(this),l.call(this,r,this)}return r.restore(),this}drawHit(t,i,n=!1){if(!this.shouldDrawHit(i,n))return this;let s=this.getLayer(),o=t||s.hitCanvas,r=o&&o.getContext(),a=this.hitFunc()||this.sceneFunc(),l=this._getCanvasCache(),d=l&&l.hit;if(this.colorKey||kn.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),d){r.save();let u=this.getAbsoluteTransform(i).getMatrix();return r.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedHitCanvas(r),r.restore(),this}if(!a)return this;if(r.save(),r._applyLineJoin(this),!(this===i)){let u=this.getAbsoluteTransform(i).getMatrix();r.transform(u[0],u[1],u[2],u[3],u[4],u[5])}return a.call(this,r,this),r.restore(),this}drawHitFromCache(t=0){let i=this._getCanvasCache(),n=this._getCachedSceneCanvas(),s=i.hit,o=s.getContext(),r=s.getWidth(),a=s.getHeight();o.clear(),o.drawImage(n._canvas,0,0,r,a);try{let l=o.getImageData(0,0,r,a),d=l.data,c=d.length,u=kn.Util._hexToRgb(this.colorKey);for(let h=0;h<c;h+=4)d[h+3]>t?(d[h]=u.r,d[h+1]=u.g,d[h+2]=u.b,d[h+3]=255):d[h+3]=0;o.putImageData(l,0,0)}catch(l){kn.Util.error("Unable to draw hit graph from cached scene canvas. "+l.message)}return this}hasPointerCapture(t){return T0.hasPointerCapture(t,this)}setPointerCapture(t){T0.setPointerCapture(t,this)}releaseCapture(t){T0.releaseCapture(t,this)}};hs.Shape=j;j.prototype._fillFunc=B7;j.prototype._strokeFunc=H7;j.prototype._fillFuncHit=V7;j.prototype._strokeFuncHit=G7;j.prototype._centroid=!1;j.prototype.nodeType="Shape";(0,N7._registerNode)(j);j.prototype.eventListeners={};j.prototype.on.call(j.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",z7);j.prototype.on.call(j.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",W7);j.prototype.on.call(j.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",U7);j.prototype.on.call(j.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",q7);j.prototype.on.call(j.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",$7);ie.Factory.addGetterSetter(j,"stroke",void 0,(0,Mt.getStringOrGradientValidator)());ie.Factory.addGetterSetter(j,"strokeWidth",2,(0,Mt.getNumberValidator)());ie.Factory.addGetterSetter(j,"fillAfterStrokeEnabled",!1);ie.Factory.addGetterSetter(j,"hitStrokeWidth","auto",(0,Mt.getNumberOrAutoValidator)());ie.Factory.addGetterSetter(j,"strokeHitEnabled",!0,(0,Mt.getBooleanValidator)());ie.Factory.addGetterSetter(j,"perfectDrawEnabled",!0,(0,Mt.getBooleanValidator)());ie.Factory.addGetterSetter(j,"shadowForStrokeEnabled",!0,(0,Mt.getBooleanValidator)());ie.Factory.addGetterSetter(j,"lineJoin");ie.Factory.addGetterSetter(j,"lineCap");ie.Factory.addGetterSetter(j,"sceneFunc");ie.Factory.addGetterSetter(j,"hitFunc");ie.Factory.addGetterSetter(j,"dash");ie.Factory.addGetterSetter(j,"dashOffset",0,(0,Mt.getNumberValidator)());ie.Factory.addGetterSetter(j,"shadowColor",void 0,(0,Mt.getStringValidator)());ie.Factory.addGetterSetter(j,"shadowBlur",0,(0,Mt.getNumberValidator)());ie.Factory.addGetterSetter(j,"shadowOpacity",1,(0,Mt.getNumberValidator)());ie.Factory.addComponentsGetterSetter(j,"shadowOffset",["x","y"]);ie.Factory.addGetterSetter(j,"shadowOffsetX",0,(0,Mt.getNumberValidator)());ie.Factory.addGetterSetter(j,"shadowOffsetY",0,(0,Mt.getNumberValidator)());ie.Factory.addGetterSetter(j,"fillPatternImage");ie.Factory.addGetterSetter(j,"fill",void 0,(0,Mt.getStringOrGradientValidator)());ie.Factory.addGetterSetter(j,"fillPatternX",0,(0,Mt.getNumberValidator)());ie.Factory.addGetterSetter(j,"fillPatternY",0,(0,Mt.getNumberValidator)());ie.Factory.addGetterSetter(j,"fillLinearGradientColorStops");ie.Factory.addGetterSetter(j,"strokeLinearGradientColorStops");ie.Factory.addGetterSetter(j,"fillRadialGradientStartRadius",0);ie.Factory.addGetterSetter(j,"fillRadialGradientEndRadius",0);ie.Factory.addGetterSetter(j,"fillRadialGradientColorStops");ie.Factory.addGetterSetter(j,"fillPatternRepeat","repeat");ie.Factory.addGetterSetter(j,"fillEnabled",!0);ie.Factory.addGetterSetter(j,"strokeEnabled",!0);ie.Factory.addGetterSetter(j,"shadowEnabled",!0);ie.Factory.addGetterSetter(j,"dashEnabled",!0);ie.Factory.addGetterSetter(j,"strokeScaleEnabled",!0);ie.Factory.addGetterSetter(j,"fillPriority","color");ie.Factory.addComponentsGetterSetter(j,"fillPatternOffset",["x","y"]);ie.Factory.addGetterSetter(j,"fillPatternOffsetX",0,(0,Mt.getNumberValidator)());ie.Factory.addGetterSetter(j,"fillPatternOffsetY",0,(0,Mt.getNumberValidator)());ie.Factory.addComponentsGetterSetter(j,"fillPatternScale",["x","y"]);ie.Factory.addGetterSetter(j,"fillPatternScaleX",1,(0,Mt.getNumberValidator)());ie.Factory.addGetterSetter(j,"fillPatternScaleY",1,(0,Mt.getNumberValidator)());ie.Factory.addComponentsGetterSetter(j,"fillLinearGradientStartPoint",["x","y"]);ie.Factory.addComponentsGetterSetter(j,"strokeLinearGradientStartPoint",["x","y"]);ie.Factory.addGetterSetter(j,"fillLinearGradientStartPointX",0);ie.Factory.addGetterSetter(j,"strokeLinearGradientStartPointX",0);ie.Factory.addGetterSetter(j,"fillLinearGradientStartPointY",0);ie.Factory.addGetterSetter(j,"strokeLinearGradientStartPointY",0);ie.Factory.addComponentsGetterSetter(j,"fillLinearGradientEndPoint",["x","y"]);ie.Factory.addComponentsGetterSetter(j,"strokeLinearGradientEndPoint",["x","y"]);ie.Factory.addGetterSetter(j,"fillLinearGradientEndPointX",0);ie.Factory.addGetterSetter(j,"strokeLinearGradientEndPointX",0);ie.Factory.addGetterSetter(j,"fillLinearGradientEndPointY",0);ie.Factory.addGetterSetter(j,"strokeLinearGradientEndPointY",0);ie.Factory.addComponentsGetterSetter(j,"fillRadialGradientStartPoint",["x","y"]);ie.Factory.addGetterSetter(j,"fillRadialGradientStartPointX",0);ie.Factory.addGetterSetter(j,"fillRadialGradientStartPointY",0);ie.Factory.addComponentsGetterSetter(j,"fillRadialGradientEndPoint",["x","y"]);ie.Factory.addGetterSetter(j,"fillRadialGradientEndPointX",0);ie.Factory.addGetterSetter(j,"fillRadialGradientEndPointY",0);ie.Factory.addGetterSetter(j,"fillPatternRotation",0);ie.Factory.addGetterSetter(j,"fillRule",void 0,(0,Mt.getStringValidator)());ie.Factory.backCompat(j,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})});var oh=oe(sh=>{"use strict";Object.defineProperty(sh,"__esModule",{value:!0});sh.Layer=void 0;var ps=at(),I0=Kl(),aa=pt(),_0=Pe(),rx=Wl(),j7=Te(),K7=Dt(),Y7=De(),X7="#",J7="beforeDraw",Q7="draw",ax=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],Z7=ax.length,js=class extends I0.Container{constructor(t){super(t),this.canvas=new rx.SceneCanvas,this.hitCanvas=new rx.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);let i=this.getStage();return i&&i.content&&(i.content.removeChild(this.getNativeCanvasElement()),t<i.children.length-1?i.content.insertBefore(this.getNativeCanvasElement(),i.children[t+1].getCanvas()._canvas):i.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){aa.Node.prototype.moveToTop.call(this);let t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!aa.Node.prototype.moveUp.call(this))return!1;let i=this.getStage();return!i||!i.content?!1:(i.content.removeChild(this.getNativeCanvasElement()),this.index<i.children.length-1?i.content.insertBefore(this.getNativeCanvasElement(),i.children[this.index+1].getCanvas()._canvas):i.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(aa.Node.prototype.moveDown.call(this)){let t=this.getStage();if(t){let i=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),i[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(aa.Node.prototype.moveToBottom.call(this)){let t=this.getStage();if(t){let i=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),i[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){let t=this.getNativeCanvasElement();return aa.Node.prototype.remove.call(this),t&&t.parentNode&&ps.Util._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:i}){return this.canvas.setSize(t,i),this.hitCanvas.setSize(t,i),this._setSmoothEnabled(),this}_validateAdd(t){let i=t.getType();i!=="Group"&&i!=="Shape"&&ps.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t=t||{},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),aa.Node.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){ps.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){ps.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,ps.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;let i=1,n=!1;for(;;){for(let s=0;s<Z7;s++){let o=ax[s],r=this._getIntersection({x:t.x+o.x*i,y:t.y+o.y*i}),a=r.shape;if(a)return a;if(n=!!r.antialiased,!r.antialiased)break}if(n)i+=1;else return null}}_getIntersection(t){let i=this.hitCanvas.pixelRatio,n=this.hitCanvas.context.getImageData(Math.round(t.x*i),Math.round(t.y*i),1,1).data,s=n[3];if(s===255){let o=ps.Util._rgbToHex(n[0],n[1],n[2]),r=K7.shapes[X7+o];return r?{shape:r}:{antialiased:!0}}else if(s>0)return{antialiased:!0};return{}}drawScene(t,i,n){let s=this.getLayer(),o=t||s&&s.getCanvas();return this._fire(J7,{node:this}),this.clearBeforeDraw()&&o.getContext().clear(),I0.Container.prototype.drawScene.call(this,o,i,n),this._fire(Q7,{node:this}),this}drawHit(t,i){let n=this.getLayer(),s=t||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),I0.Container.prototype.drawHit.call(this,s,i),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){ps.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return ps.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;let t=this.parent;!!this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}destroy(){return ps.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};sh.Layer=js;js.prototype.nodeType="Layer";(0,Y7._registerNode)(js);_0.Factory.addGetterSetter(js,"imageSmoothingEnabled",!0);_0.Factory.addGetterSetter(js,"clearBeforeDraw",!0);_0.Factory.addGetterSetter(js,"hitGraphEnabled",!0,(0,j7.getBooleanValidator)())});var lx=oe(rh=>{"use strict";Object.defineProperty(rh,"__esModule",{value:!0});rh.FastLayer=void 0;var eI=at(),tI=oh(),iI=De(),td=class extends tI.Layer{constructor(t){super(t),this.listening(!1),eI.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};rh.FastLayer=td;td.prototype.nodeType="FastLayer";(0,iI._registerNode)(td)});var nd=oe(ah=>{"use strict";Object.defineProperty(ah,"__esModule",{value:!0});ah.Group=void 0;var nI=at(),sI=Kl(),oI=De(),id=class extends sI.Container{_validateAdd(t){let i=t.getType();i!=="Group"&&i!=="Shape"&&nI.Util.throw("You may only add groups and shapes to groups.")}};ah.Group=id;id.prototype.nodeType="Group";(0,oI._registerNode)(id)});var dh=oe(lh=>{"use strict";Object.defineProperty(lh,"__esModule",{value:!0});lh.Animation=void 0;var L0=De(),dx=at(),O0=(function(){return L0.glob.performance&&L0.glob.performance.now?function(){return L0.glob.performance.now()}:function(){return new Date().getTime()}})(),la=class e{constructor(t,i){this.id=e.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:O0(),frameRate:0},this.func=t,this.setLayers(i)}setLayers(t){let i=[];return t&&(i=Array.isArray(t)?t:[t]),this.layers=i,this}getLayers(){return this.layers}addLayer(t){let i=this.layers,n=i.length;for(let s=0;s<n;s++)if(i[s]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){let i=e.animations,n=i.length;for(let s=0;s<n;s++)if(i[s].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=O0(),e._addAnimation(this),this}stop(){return e._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){let i=t.id,n=this.animations,s=n.length;for(let o=0;o<s;o++)if(n[o].id===i){this.animations.splice(o,1);break}}static _runFrames(){let t={},i=this.animations;for(let n=0;n<i.length;n++){let s=i[n],o=s.layers,r=s.func;s._updateFrameObject(O0());let a=o.length,l;if(r?l=r.call(s,s.frame)!==!1:l=!0,!!l)for(let d=0;d<a;d++){let c=o[d];c._id!==void 0&&(t[c._id]=c)}}for(let n in t)t.hasOwnProperty(n)&&t[n].batchDraw()}static _animationLoop(){let t=e;t.animations.length?(t._runFrames(),dx.Util.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,dx.Util.requestAnimFrame(this._animationLoop))}};lh.Animation=la;la.animations=[];la.animIdCounter=0;la.animRunning=!1});var px=oe(Pn=>{"use strict";Object.defineProperty(Pn,"__esModule",{value:!0});Pn.Easings=Pn.Tween=void 0;var gs=at(),rI=dh(),aI=pt(),lI=De(),dI={node:1,duration:1,easing:1,onFinish:1,yoyo:1},cI=1,cx=2,ux=3,hx=["fill","stroke","shadowColor"],uI=0,N0=class{constructor(t,i,n,s,o,r,a){this.prop=t,this.propFunc=i,this.begin=s,this._pos=s,this.duration=r,this._change=0,this.prevPos=0,this.yoyo=a,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=n,this._change=o-this.begin,this.pause()}fire(t){let i=this[t];i&&i()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t}getPosition(t){return t===void 0&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=cx,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=ux,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){let t=this.getTimer()-this._startTime;this.state===cx?this.setTime(t):this.state===ux&&this.setTime(this.duration-t)}pause(){this.state=cI,this.fire("onPause")}getTimer(){return new Date().getTime()}},da=class e{constructor(t){let i=this,n=t.node,s=n._id,o=t.easing||Pn.Easings.Linear,r=!!t.yoyo,a,l;typeof t.duration>"u"?a=.3:t.duration===0?a=.001:a=t.duration,this.node=n,this._id=uI++;let d=n.getLayer()||(n instanceof lI.Konva.Stage?n.getLayers():null);d||gs.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new rI.Animation(function(){i.tween.onEnterFrame()},d),this.tween=new N0(l,function(c){i._tweenFunc(c)},o,0,1,a*1e3,r),this._addListeners(),e.attrs[s]||(e.attrs[s]={}),e.attrs[s][this._id]||(e.attrs[s][this._id]={}),e.tweens[s]||(e.tweens[s]={});for(l in t)dI[l]===void 0&&this._addAttr(l,t[l]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset,this.onUpdate=t.onUpdate}_addAttr(t,i){let n=this.node,s=n._id,o,r,a,l,d,c=e.tweens[s][t];c&&delete e.attrs[s][c][t];let u=n.getAttr(t);if(gs.Util._isArray(i))if(o=[],r=Math.max(i.length,u.length),t==="points"&&i.length!==u.length&&(i.length>u.length?(l=u,u=gs.Util._prepareArrayForTween(u,i,n.closed())):(a=i,i=gs.Util._prepareArrayForTween(i,u,n.closed()))),t.indexOf("fill")===0)for(let h=0;h<r;h++)if(h%2===0)o.push(i[h]-u[h]);else{let p=gs.Util.colorToRGBA(u[h]);d=gs.Util.colorToRGBA(i[h]),u[h]=p,o.push({r:d.r-p.r,g:d.g-p.g,b:d.b-p.b,a:d.a-p.a})}else for(let h=0;h<r;h++)o.push(i[h]-u[h]);else hx.indexOf(t)!==-1?(u=gs.Util.colorToRGBA(u),d=gs.Util.colorToRGBA(i),o={r:d.r-u.r,g:d.g-u.g,b:d.b-u.b,a:d.a-u.a}):o=i-u;e.attrs[s][this._id][t]={start:u,diff:o,end:i,trueEnd:a,trueStart:l},e.tweens[s][t]=this._id}_tweenFunc(t){let i=this.node,n=e.attrs[i._id][this._id],s,o,r,a,l,d,c,u;for(s in n){if(o=n[s],r=o.start,a=o.diff,u=o.end,gs.Util._isArray(r))if(l=[],c=Math.max(r.length,u.length),s.indexOf("fill")===0)for(d=0;d<c;d++)d%2===0?l.push((r[d]||0)+a[d]*t):l.push("rgba("+Math.round(r[d].r+a[d].r*t)+","+Math.round(r[d].g+a[d].g*t)+","+Math.round(r[d].b+a[d].b*t)+","+(r[d].a+a[d].a*t)+")");else for(d=0;d<c;d++)l.push((r[d]||0)+a[d]*t);else hx.indexOf(s)!==-1?l="rgba("+Math.round(r.r+a.r*t)+","+Math.round(r.g+a.g*t)+","+Math.round(r.b+a.b*t)+","+(r.a+a.a*t)+")":l=r+a*t;i.setAttr(s,l)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{let t=this.node,i=e.attrs[t._id][this._id];i.points&&i.points.trueEnd&&t.setAttr("points",i.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{let t=this.node,i=e.attrs[t._id][this._id];i.points&&i.points.trueStart&&t.points(i.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(t*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){let t=this.node._id,i=this._id,n=e.tweens[t];this.pause(),this.anim&&this.anim.stop();for(let s in n)delete e.tweens[t][s];delete e.attrs[t][i],e.tweens[t]&&(Object.keys(e.tweens[t]).length===0&&delete e.tweens[t],Object.keys(e.attrs[t]).length===0&&delete e.attrs[t])}};Pn.Tween=da;da.attrs={};da.tweens={};aI.Node.prototype.to=function(e){let t=e.onFinish;e.node=this,e.onFinish=function(){this.destroy(),t&&t()},new da(e).play()};Pn.Easings={BackEaseIn(e,t,i,n){return i*(e/=n)*e*((1.70158+1)*e-1.70158)+t},BackEaseOut(e,t,i,n){return i*((e=e/n-1)*e*((1.70158+1)*e+1.70158)+1)+t},BackEaseInOut(e,t,i,n){let s=1.70158;return(e/=n/2)<1?i/2*(e*e*(((s*=1.525)+1)*e-s))+t:i/2*((e-=2)*e*(((s*=1.525)+1)*e+s)+2)+t},ElasticEaseIn(e,t,i,n,s,o){let r=0;return e===0?t:(e/=n)===1?t+i:(o||(o=n*.3),!s||s<Math.abs(i)?(s=i,r=o/4):r=o/(2*Math.PI)*Math.asin(i/s),-(s*Math.pow(2,10*(e-=1))*Math.sin((e*n-r)*(2*Math.PI)/o))+t)},ElasticEaseOut(e,t,i,n,s,o){let r=0;return e===0?t:(e/=n)===1?t+i:(o||(o=n*.3),!s||s<Math.abs(i)?(s=i,r=o/4):r=o/(2*Math.PI)*Math.asin(i/s),s*Math.pow(2,-10*e)*Math.sin((e*n-r)*(2*Math.PI)/o)+i+t)},ElasticEaseInOut(e,t,i,n,s,o){let r=0;return e===0?t:(e/=n/2)===2?t+i:(o||(o=n*(.3*1.5)),!s||s<Math.abs(i)?(s=i,r=o/4):r=o/(2*Math.PI)*Math.asin(i/s),e<1?-.5*(s*Math.pow(2,10*(e-=1))*Math.sin((e*n-r)*(2*Math.PI)/o))+t:s*Math.pow(2,-10*(e-=1))*Math.sin((e*n-r)*(2*Math.PI)/o)*.5+i+t)},BounceEaseOut(e,t,i,n){return(e/=n)<1/2.75?i*(7.5625*e*e)+t:e<2/2.75?i*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?i*(7.5625*(e-=2.25/2.75)*e+.9375)+t:i*(7.5625*(e-=2.625/2.75)*e+.984375)+t},BounceEaseIn(e,t,i,n){return i-Pn.Easings.BounceEaseOut(n-e,0,i,n)+t},BounceEaseInOut(e,t,i,n){return e<n/2?Pn.Easings.BounceEaseIn(e*2,0,i,n)*.5+t:Pn.Easings.BounceEaseOut(e*2-n,0,i,n)*.5+i*.5+t},EaseIn(e,t,i,n){return i*(e/=n)*e+t},EaseOut(e,t,i,n){return-i*(e/=n)*(e-2)+t},EaseInOut(e,t,i,n){return(e/=n/2)<1?i/2*e*e+t:-i/2*(--e*(e-2)-1)+t},StrongEaseIn(e,t,i,n){return i*(e/=n)*e*e*e*e+t},StrongEaseOut(e,t,i,n){return i*((e=e/n-1)*e*e*e*e+1)+t},StrongEaseInOut(e,t,i,n){return(e/=n/2)<1?i/2*e*e*e*e*e+t:i/2*((e-=2)*e*e*e*e+2)+t},Linear(e,t,i,n){return i*e/n+t}}});var Cx=oe(ca=>{"use strict";Object.defineProperty(ca,"__esModule",{value:!0});ca.Konva=void 0;var hI=De(),B0=at(),pI=pt(),gI=Kl(),gx=F0(),fI=oh(),mI=lx(),CI=nd(),vI=ju(),fx=Dt(),wI=dh(),mx=px(),bI=C0(),yI=Wl();ca.Konva=B0.Util._assign(hI.Konva,{Util:B0.Util,Transform:B0.Transform,Node:pI.Node,Container:gI.Container,Stage:gx.Stage,stages:gx.stages,Layer:fI.Layer,FastLayer:mI.FastLayer,Group:CI.Group,DD:vI.DD,Shape:fx.Shape,shapes:fx.shapes,Animation:wI.Animation,Tween:mx.Tween,Easings:mx.Easings,Context:bI.Context,Canvas:yI.Canvas});ca.default=ca.Konva});var wx=oe(hh=>{"use strict";Object.defineProperty(hh,"__esModule",{value:!0});hh.Arc=void 0;var ch=Pe(),SI=Dt(),vx=De(),uh=Te(),xI=De(),en=class extends SI.Shape{_sceneFunc(t){let i=vx.Konva.getAngle(this.angle()),n=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,i,n),t.arc(0,0,this.innerRadius(),i,0,!n),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){let t=this.innerRadius(),i=this.outerRadius(),n=this.clockwise(),s=vx.Konva.getAngle(n?360-this.angle():this.angle()),o=Math.cos(Math.min(s,Math.PI)),r=1,a=Math.sin(Math.min(Math.max(Math.PI,s),3*Math.PI/2)),l=Math.sin(Math.min(s,Math.PI/2)),d=o*(o>0?t:i),c=r*(r>0?i:t),u=a*(a>0?t:i),h=l*(l>0?i:t);return{x:d,y:n?-1*h:u,width:c-d,height:h-u}}};hh.Arc=en;en.prototype._centroid=!0;en.prototype.className="Arc";en.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];(0,xI._registerNode)(en);ch.Factory.addGetterSetter(en,"innerRadius",0,(0,uh.getNumberValidator)());ch.Factory.addGetterSetter(en,"outerRadius",0,(0,uh.getNumberValidator)());ch.Factory.addGetterSetter(en,"angle",0,(0,uh.getNumberValidator)());ch.Factory.addGetterSetter(en,"clockwise",!1,(0,uh.getBooleanValidator)())});var V0=oe(gh=>{"use strict";Object.defineProperty(gh,"__esModule",{value:!0});gh.Line=void 0;var ph=Pe(),EI=De(),RI=Dt(),yx=Te();function H0(e,t,i,n,s,o,r){let a=Math.sqrt(Math.pow(i-e,2)+Math.pow(n-t,2)),l=Math.sqrt(Math.pow(s-i,2)+Math.pow(o-n,2)),d=r*a/(a+l),c=r*l/(a+l),u=i-d*(s-e),h=n-d*(o-t),p=i+c*(s-e),g=n+c*(o-t);return[u,h,p,g]}function bx(e,t){let i=e.length,n=[];for(let s=2;s<i-2;s+=2){let o=H0(e[s-2],e[s-1],e[s],e[s+1],e[s+2],e[s+3],t);isNaN(o[0])||(n.push(o[0]),n.push(o[1]),n.push(e[s]),n.push(e[s+1]),n.push(o[2]),n.push(o[3]))}return n}var Fn=class extends RI.Shape{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){let i=this.points(),n=i.length,s=this.tension(),o=this.closed(),r=this.bezier();if(!n)return;let a=0;if(t.beginPath(),t.moveTo(i[0],i[1]),s!==0&&n>4){let l=this.getTensionPoints(),d=l.length;for(a=o?0:4,o||t.quadraticCurveTo(l[0],l[1],l[2],l[3]);a<d-2;)t.bezierCurveTo(l[a++],l[a++],l[a++],l[a++],l[a++],l[a++]);o||t.quadraticCurveTo(l[d-2],l[d-1],i[n-2],i[n-1])}else if(r)for(a=2;a<n;)t.bezierCurveTo(i[a++],i[a++],i[a++],i[a++],i[a++],i[a++]);else for(a=2;a<n;a+=2)t.lineTo(i[a],i[a+1]);o?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():bx(this.points(),this.tension())}_getTensionPointsClosed(){let t=this.points(),i=t.length,n=this.tension(),s=H0(t[i-2],t[i-1],t[0],t[1],t[2],t[3],n),o=H0(t[i-4],t[i-3],t[i-2],t[i-1],t[0],t[1],n),r=bx(t,n);return[s[2],s[3]].concat(r).concat([o[0],o[1],t[i-2],t[i-1],o[2],o[3],s[0],s[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:t=this.points();let i=t[0],n=t[0],s=t[1],o=t[1],r,a;for(let l=0;l<t.length/2;l++)r=t[l*2],a=t[l*2+1],i=Math.min(i,r),n=Math.max(n,r),s=Math.min(s,a),o=Math.max(o,a);return{x:i,y:s,width:n-i,height:o-s}}};gh.Line=Fn;Fn.prototype.className="Line";Fn.prototype._attrsAffectingSize=["points","bezier","tension"];(0,EI._registerNode)(Fn);ph.Factory.addGetterSetter(Fn,"closed",!1);ph.Factory.addGetterSetter(Fn,"bezier",!1);ph.Factory.addGetterSetter(Fn,"tension",0,(0,yx.getNumberValidator)());ph.Factory.addGetterSetter(Fn,"points",[],(0,yx.getNumberArrayValidator)())});var Sx=oe(Ut=>{"use strict";Object.defineProperty(Ut,"__esModule",{value:!0});Ut.t2length=Ut.getQuadraticArcLength=Ut.getCubicArcLength=Ut.binomialCoefficients=Ut.cValues=Ut.tValues=void 0;Ut.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]];Ut.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]];Ut.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];var MI=(e,t,i)=>{let n,s,r=i/2;n=0;for(let a=0;a<20;a++)s=r*Ut.tValues[20][a]+r,n+=Ut.cValues[20][a]*kI(e,t,s);return r*n};Ut.getCubicArcLength=MI;var DI=(e,t,i)=>{i===void 0&&(i=1);let n=e[0]-2*e[1]+e[2],s=t[0]-2*t[1]+t[2],o=2*e[1]-2*e[0],r=2*t[1]-2*t[0],a=4*(n*n+s*s),l=4*(n*o+s*r),d=o*o+r*r;if(a===0)return i*Math.sqrt(Math.pow(e[2]-e[0],2)+Math.pow(t[2]-t[0],2));let c=l/(2*a),u=d/a,h=i+c,p=u-c*c,g=h*h+p>0?Math.sqrt(h*h+p):0,f=c*c+p>0?Math.sqrt(c*c+p):0,m=c+Math.sqrt(c*c+p)!==0?p*Math.log(Math.abs((h+g)/(c+f))):0;return Math.sqrt(a)/2*(h*g-c*f+m)};Ut.getQuadraticArcLength=DI;function kI(e,t,i){let n=G0(1,i,e),s=G0(1,i,t),o=n*n+s*s;return Math.sqrt(o)}var G0=(e,t,i)=>{let n=i.length-1,s,o;if(n===0)return 0;if(e===0){o=0;for(let r=0;r<=n;r++)o+=Ut.binomialCoefficients[n][r]*Math.pow(1-t,n-r)*Math.pow(t,r)*i[r];return o}else{s=new Array(n);for(let r=0;r<n;r++)s[r]=n*(i[r+1]-i[r]);return G0(e-1,t,s)}},PI=(e,t,i)=>{let n=1,s=e/t,o=(e-i(s))/t,r=0;for(;n>.001;){let a=i(s+o),l=Math.abs(e-a)/t;if(l<n)n=l,s+=o;else{let d=i(s-o),c=Math.abs(e-d)/t;c<n?(n=c,s-=o):o/=2}if(r++,r>500)break}return s};Ut.t2length=PI});var mh=oe(fh=>{"use strict";Object.defineProperty(fh,"__esModule",{value:!0});fh.Path=void 0;var FI=Pe(),TI=De(),AI=Dt(),ua=Sx(),jo=class e extends AI.Shape{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=e.parsePathData(this.data()),this.pathLength=e.getPathLength(this.dataArray)}_sceneFunc(t){let i=this.dataArray;t.beginPath();let n=!1;for(let s=0;s<i.length;s++){let o=i[s].command,r=i[s].points;switch(o){case"L":t.lineTo(r[0],r[1]);break;case"M":t.moveTo(r[0],r[1]);break;case"C":t.bezierCurveTo(r[0],r[1],r[2],r[3],r[4],r[5]);break;case"Q":t.quadraticCurveTo(r[0],r[1],r[2],r[3]);break;case"A":let a=r[0],l=r[1],d=r[2],c=r[3],u=r[4],h=r[5],p=r[6],g=r[7],f=d>c?d:c,m=d>c?1:d/c,C=d>c?c/d:1;t.translate(a,l),t.rotate(p),t.scale(m,C),t.arc(0,0,f,u,u+h,1-g),t.scale(1/m,1/C),t.rotate(-p),t.translate(-a,-l);break;case"z":n=!0,t.closePath();break}}!n&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){let t=[];this.dataArray.forEach(function(l){if(l.command==="A"){let d=l.points[4],c=l.points[5],u=l.points[4]+c,h=Math.PI/180;if(Math.abs(d-u)<h&&(h=Math.abs(d-u)),c<0)for(let p=d-h;p>u;p-=h){let g=e.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],p,0);t.push(g.x,g.y)}else for(let p=d+h;p<u;p+=h){let g=e.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],p,0);t.push(g.x,g.y)}}else if(l.command==="C")for(let d=0;d<=1;d+=.01){let c=e.getPointOnCubicBezier(d,l.start.x,l.start.y,l.points[0],l.points[1],l.points[2],l.points[3],l.points[4],l.points[5]);t.push(c.x,c.y)}else t=t.concat(l.points)});let i=t[0],n=t[0],s=t[1],o=t[1],r,a;for(let l=0;l<t.length/2;l++)r=t[l*2],a=t[l*2+1],isNaN(r)||(i=Math.min(i,r),n=Math.max(n,r)),isNaN(a)||(s=Math.min(s,a),o=Math.max(o,a));return{x:i,y:s,width:n-i,height:o-s}}getLength(){return this.pathLength}getPointAtLength(t){return e.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,i,n,s){return Math.sqrt((n-t)*(n-t)+(s-i)*(s-i))}static getPathLength(t){let i=0;for(let n=0;n<t.length;++n)i+=t[n].pathLength;return i}static getPointAtLengthOfDataArray(t,i){let n,s=0,o=i.length;if(!o)return null;for(;s<o&&t>i[s].pathLength;)t-=i[s].pathLength,++s;if(s===o)return n=i[s-1].points.slice(-2),{x:n[0],y:n[1]};if(t<.01)return i[s].command==="M"?(n=i[s].points.slice(0,2),{x:n[0],y:n[1]}):{x:i[s].start.x,y:i[s].start.y};let r=i[s],a=r.points;switch(r.command){case"L":return e.getPointOnLine(t,r.start.x,r.start.y,a[0],a[1]);case"C":return e.getPointOnCubicBezier((0,ua.t2length)(t,e.getPathLength(i),f=>(0,ua.getCubicArcLength)([r.start.x,a[0],a[2],a[4]],[r.start.y,a[1],a[3],a[5]],f)),r.start.x,r.start.y,a[0],a[1],a[2],a[3],a[4],a[5]);case"Q":return e.getPointOnQuadraticBezier((0,ua.t2length)(t,e.getPathLength(i),f=>(0,ua.getQuadraticArcLength)([r.start.x,a[0],a[2]],[r.start.y,a[1],a[3]],f)),r.start.x,r.start.y,a[0],a[1],a[2],a[3]);case"A":let l=a[0],d=a[1],c=a[2],u=a[3],h=a[5],p=a[6],g=a[4];return g+=h*t/r.pathLength,e.getPointOnEllipticalArc(l,d,c,u,g,p)}return null}static getPointOnLine(t,i,n,s,o,r,a){r=r??i,a=a??n;let l=this.getLineLength(i,n,s,o);if(l<1e-10)return{x:i,y:n};if(s===i)return{x:r,y:a+(o>n?t:-t)};let d=(o-n)/(s-i),c=Math.sqrt(t*t/(1+d*d))*(s<i?-1:1),u=d*c;if(Math.abs(a-n-d*(r-i))<1e-10)return{x:r+c,y:a+u};let h=((r-i)*(s-i)+(a-n)*(o-n))/(l*l),p=i+h*(s-i),g=n+h*(o-n),f=this.getLineLength(r,a,p,g),m=Math.sqrt(t*t-f*f),C=Math.sqrt(m*m/(1+d*d))*(s<i?-1:1),v=d*C;return{x:p+C,y:g+v}}static getPointOnCubicBezier(t,i,n,s,o,r,a,l,d){function c(m){return m*m*m}function u(m){return 3*m*m*(1-m)}function h(m){return 3*m*(1-m)*(1-m)}function p(m){return(1-m)*(1-m)*(1-m)}let g=l*c(t)+r*u(t)+s*h(t)+i*p(t),f=d*c(t)+a*u(t)+o*h(t)+n*p(t);return{x:g,y:f}}static getPointOnQuadraticBezier(t,i,n,s,o,r,a){function l(p){return p*p}function d(p){return 2*p*(1-p)}function c(p){return(1-p)*(1-p)}let u=r*l(t)+s*d(t)+i*c(t),h=a*l(t)+o*d(t)+n*c(t);return{x:u,y:h}}static getPointOnEllipticalArc(t,i,n,s,o,r){let a=Math.cos(r),l=Math.sin(r),d={x:n*Math.cos(o),y:s*Math.sin(o)};return{x:t+(d.x*a-d.y*l),y:i+(d.x*l+d.y*a)}}static parsePathData(t){if(!t)return[];let i=t,n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];i=i.replace(new RegExp(" ","g"),",");for(let u=0;u<n.length;u++)i=i.replace(new RegExp(n[u],"g"),"|"+n[u]);let s=i.split("|"),o=[],r=[],a=0,l=0,d=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,c;for(let u=1;u<s.length;u++){let h=s[u],p=h.charAt(0);for(h=h.slice(1),r.length=0;c=d.exec(h);)r.push(c[0]);let g=[];for(let f=0,m=r.length;f<m;f++){if(r[f]==="00"){g.push(0,0);continue}let C=parseFloat(r[f]);isNaN(C)?g.push(0):g.push(C)}for(;g.length>0&&!isNaN(g[0]);){let f="",m=[],C=a,v=l,w,y,S,x,E,T,L,N,$,G;switch(p){case"l":a+=g.shift(),l+=g.shift(),f="L",m.push(a,l);break;case"L":a=g.shift(),l=g.shift(),m.push(a,l);break;case"m":let se=g.shift(),ve=g.shift();if(a+=se,l+=ve,f="M",o.length>2&&o[o.length-1].command==="z"){for(let me=o.length-2;me>=0;me--)if(o[me].command==="M"){a=o[me].points[0]+se,l=o[me].points[1]+ve;break}}m.push(a,l),p="l";break;case"M":a=g.shift(),l=g.shift(),f="M",m.push(a,l),p="L";break;case"h":a+=g.shift(),f="L",m.push(a,l);break;case"H":a=g.shift(),f="L",m.push(a,l);break;case"v":l+=g.shift(),f="L",m.push(a,l);break;case"V":l=g.shift(),f="L",m.push(a,l);break;case"C":m.push(g.shift(),g.shift(),g.shift(),g.shift()),a=g.shift(),l=g.shift(),m.push(a,l);break;case"c":m.push(a+g.shift(),l+g.shift(),a+g.shift(),l+g.shift()),a+=g.shift(),l+=g.shift(),f="C",m.push(a,l);break;case"S":y=a,S=l,w=o[o.length-1],w.command==="C"&&(y=a+(a-w.points[2]),S=l+(l-w.points[3])),m.push(y,S,g.shift(),g.shift()),a=g.shift(),l=g.shift(),f="C",m.push(a,l);break;case"s":y=a,S=l,w=o[o.length-1],w.command==="C"&&(y=a+(a-w.points[2]),S=l+(l-w.points[3])),m.push(y,S,a+g.shift(),l+g.shift()),a+=g.shift(),l+=g.shift(),f="C",m.push(a,l);break;case"Q":m.push(g.shift(),g.shift()),a=g.shift(),l=g.shift(),m.push(a,l);break;case"q":m.push(a+g.shift(),l+g.shift()),a+=g.shift(),l+=g.shift(),f="Q",m.push(a,l);break;case"T":y=a,S=l,w=o[o.length-1],w.command==="Q"&&(y=a+(a-w.points[0]),S=l+(l-w.points[1])),a=g.shift(),l=g.shift(),f="Q",m.push(y,S,a,l);break;case"t":y=a,S=l,w=o[o.length-1],w.command==="Q"&&(y=a+(a-w.points[0]),S=l+(l-w.points[1])),a+=g.shift(),l+=g.shift(),f="Q",m.push(y,S,a,l);break;case"A":x=g.shift(),E=g.shift(),T=g.shift(),L=g.shift(),N=g.shift(),$=a,G=l,a=g.shift(),l=g.shift(),f="A",m=this.convertEndpointToCenterParameterization($,G,a,l,L,N,x,E,T);break;case"a":x=g.shift(),E=g.shift(),T=g.shift(),L=g.shift(),N=g.shift(),$=a,G=l,a+=g.shift(),l+=g.shift(),f="A",m=this.convertEndpointToCenterParameterization($,G,a,l,L,N,x,E,T);break}o.push({command:f||p,points:m,start:{x:C,y:v},pathLength:this.calcLength(C,v,f||p,m)})}(p==="z"||p==="Z")&&o.push({command:"z",points:[],start:void 0,pathLength:0})}return o}static calcLength(t,i,n,s){let o,r,a,l,d=e;switch(n){case"L":return d.getLineLength(t,i,s[0],s[1]);case"C":return(0,ua.getCubicArcLength)([t,s[0],s[2],s[4]],[i,s[1],s[3],s[5]],1);case"Q":return(0,ua.getQuadraticArcLength)([t,s[0],s[2]],[i,s[1],s[3]],1);case"A":o=0;let c=s[4],u=s[5],h=s[4]+u,p=Math.PI/180;if(Math.abs(c-h)<p&&(p=Math.abs(c-h)),r=d.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],c,0),u<0)for(l=c-p;l>h;l-=p)a=d.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],l,0),o+=d.getLineLength(r.x,r.y,a.x,a.y),r=a;else for(l=c+p;l<h;l+=p)a=d.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],l,0),o+=d.getLineLength(r.x,r.y,a.x,a.y),r=a;return a=d.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],h,0),o+=d.getLineLength(r.x,r.y,a.x,a.y),o}return 0}static convertEndpointToCenterParameterization(t,i,n,s,o,r,a,l,d){let c=d*(Math.PI/180),u=Math.cos(c)*(t-n)/2+Math.sin(c)*(i-s)/2,h=-1*Math.sin(c)*(t-n)/2+Math.cos(c)*(i-s)/2,p=u*u/(a*a)+h*h/(l*l);p>1&&(a*=Math.sqrt(p),l*=Math.sqrt(p));let g=Math.sqrt((a*a*(l*l)-a*a*(h*h)-l*l*(u*u))/(a*a*(h*h)+l*l*(u*u)));o===r&&(g*=-1),isNaN(g)&&(g=0);let f=g*a*h/l,m=g*-l*u/a,C=(t+n)/2+Math.cos(c)*f-Math.sin(c)*m,v=(i+s)/2+Math.sin(c)*f+Math.cos(c)*m,w=function(N){return Math.sqrt(N[0]*N[0]+N[1]*N[1])},y=function(N,$){return(N[0]*$[0]+N[1]*$[1])/(w(N)*w($))},S=function(N,$){return(N[0]*$[1]<N[1]*$[0]?-1:1)*Math.acos(y(N,$))},x=S([1,0],[(u-f)/a,(h-m)/l]),E=[(u-f)/a,(h-m)/l],T=[(-1*u-f)/a,(-1*h-m)/l],L=S(E,T);return y(E,T)<=-1&&(L=Math.PI),y(E,T)>=1&&(L=0),r===0&&L>0&&(L=L-2*Math.PI),r===1&&L<0&&(L=L+2*Math.PI),[C,v,a,l,x,L,c,r]}};fh.Path=jo;jo.prototype.className="Path";jo.prototype._attrsAffectingSize=["data"];(0,TI._registerNode)(jo);FI.Factory.addGetterSetter(jo,"data")});var Rx=oe(vh=>{"use strict";Object.defineProperty(vh,"__esModule",{value:!0});vh.Arrow=void 0;var Ch=Pe(),II=V0(),Ex=Te(),_I=De(),xx=mh(),fs=class extends II.Line{_sceneFunc(t){super._sceneFunc(t);let i=Math.PI*2,n=this.points(),s=n,o=this.tension()!==0&&n.length>4;o&&(s=this.getTensionPoints());let r=this.pointerLength(),a=n.length,l,d;if(o){let h=[s[s.length-4],s[s.length-3],s[s.length-2],s[s.length-1],n[a-2],n[a-1]],p=xx.Path.calcLength(s[s.length-4],s[s.length-3],"C",h),g=xx.Path.getPointOnQuadraticBezier(Math.min(1,1-r/p),h[0],h[1],h[2],h[3],h[4],h[5]);l=n[a-2]-g.x,d=n[a-1]-g.y}else l=n[a-2]-n[a-4],d=n[a-1]-n[a-3];let c=(Math.atan2(d,l)+i)%i,u=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(n[a-2],n[a-1]),t.rotate(c),t.moveTo(0,0),t.lineTo(-r,u/2),t.lineTo(-r,-u/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(n[0],n[1]),o?(l=(s[0]+s[2])/2-n[0],d=(s[1]+s[3])/2-n[1]):(l=n[2]-n[0],d=n[3]-n[1]),t.rotate((Math.atan2(-d,-l)+i)%i),t.moveTo(0,0),t.lineTo(-r,u/2),t.lineTo(-r,-u/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){let i=this.dashEnabled();i&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),i&&(this.attrs.dashEnabled=!0)}getSelfRect(){let t=super.getSelfRect(),i=this.pointerWidth()/2;return{x:t.x,y:t.y-i,width:t.width,height:t.height+i*2}}};vh.Arrow=fs;fs.prototype.className="Arrow";(0,_I._registerNode)(fs);Ch.Factory.addGetterSetter(fs,"pointerLength",10,(0,Ex.getNumberValidator)());Ch.Factory.addGetterSetter(fs,"pointerWidth",10,(0,Ex.getNumberValidator)());Ch.Factory.addGetterSetter(fs,"pointerAtBeginning",!1);Ch.Factory.addGetterSetter(fs,"pointerAtEnding",!0)});var Mx=oe(wh=>{"use strict";Object.defineProperty(wh,"__esModule",{value:!0});wh.Circle=void 0;var LI=Pe(),OI=Dt(),NI=Te(),BI=De(),Ks=class extends OI.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}};wh.Circle=Ks;Ks.prototype._centroid=!0;Ks.prototype.className="Circle";Ks.prototype._attrsAffectingSize=["radius"];(0,BI._registerNode)(Ks);LI.Factory.addGetterSetter(Ks,"radius",0,(0,NI.getNumberValidator)())});var kx=oe(bh=>{"use strict";Object.defineProperty(bh,"__esModule",{value:!0});bh.Ellipse=void 0;var z0=Pe(),HI=Dt(),Dx=Te(),VI=De(),Tn=class extends HI.Shape{_sceneFunc(t){let i=this.radiusX(),n=this.radiusY();t.beginPath(),t.save(),i!==n&&t.scale(1,n/i),t.arc(0,0,i,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}};bh.Ellipse=Tn;Tn.prototype.className="Ellipse";Tn.prototype._centroid=!0;Tn.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,VI._registerNode)(Tn);z0.Factory.addComponentsGetterSetter(Tn,"radius",["x","y"]);z0.Factory.addGetterSetter(Tn,"radiusX",0,(0,Dx.getNumberValidator)());z0.Factory.addGetterSetter(Tn,"radiusY",0,(0,Dx.getNumberValidator)())});var Px=oe(yh=>{"use strict";Object.defineProperty(yh,"__esModule",{value:!0});yh.Image=void 0;var W0=at(),Ko=Pe(),GI=Dt(),zI=De(),sd=Te(),Wi=class e extends GI.Shape{constructor(t){super(t),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",i=>{this._removeImageLoad(i.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){let t=this.image();t&&t.complete||t&&t.readyState===4||t&&t.addEventListener&&t.addEventListener("load",this._loadListener)}_removeImageLoad(t){t&&t.removeEventListener&&t.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){let t=!!this.cornerRadius(),i=this.hasShadow();return t&&i?!0:super._useBufferCanvas(!0)}_sceneFunc(t){let i=this.getWidth(),n=this.getHeight(),s=this.cornerRadius(),o=this.attrs.image,r;if(o){let a=this.attrs.cropWidth,l=this.attrs.cropHeight;a&&l?r=[o,this.cropX(),this.cropY(),a,l,0,0,i,n]:r=[o,0,0,i,n]}(this.hasFill()||this.hasStroke()||s)&&(t.beginPath(),s?W0.Util.drawRoundedRectPath(t,i,n,s):t.rect(0,0,i,n),t.closePath(),t.fillStrokeShape(this)),o&&(s&&t.clip(),t.drawImage.apply(t,r))}_hitFunc(t){let i=this.width(),n=this.height(),s=this.cornerRadius();t.beginPath(),s?W0.Util.drawRoundedRectPath(t,i,n,s):t.rect(0,0,i,n),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,i;return(t=this.attrs.width)!==null&&t!==void 0?t:(i=this.image())===null||i===void 0?void 0:i.width}getHeight(){var t,i;return(t=this.attrs.height)!==null&&t!==void 0?t:(i=this.image())===null||i===void 0?void 0:i.height}static fromURL(t,i,n=null){let s=W0.Util.createImageElement();s.onload=function(){let o=new e({image:s});i(o)},s.onerror=n,s.crossOrigin="Anonymous",s.src=t}};yh.Image=Wi;Wi.prototype.className="Image";(0,zI._registerNode)(Wi);Ko.Factory.addGetterSetter(Wi,"cornerRadius",0,(0,sd.getNumberOrArrayOfNumbersValidator)(4));Ko.Factory.addGetterSetter(Wi,"image");Ko.Factory.addComponentsGetterSetter(Wi,"crop",["x","y","width","height"]);Ko.Factory.addGetterSetter(Wi,"cropX",0,(0,sd.getNumberValidator)());Ko.Factory.addGetterSetter(Wi,"cropY",0,(0,sd.getNumberValidator)());Ko.Factory.addGetterSetter(Wi,"cropWidth",0,(0,sd.getNumberValidator)());Ko.Factory.addGetterSetter(Wi,"cropHeight",0,(0,sd.getNumberValidator)())});var Ax=oe(ha=>{"use strict";Object.defineProperty(ha,"__esModule",{value:!0});ha.Tag=ha.Label=void 0;var Sh=Pe(),WI=Dt(),UI=nd(),K0=Te(),Fx=De(),Tx=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],qI="Change.konva",$I="none",U0="up",q0="right",$0="down",j0="left",jI=Tx.length,od=class extends UI.Group{constructor(t){super(t),this.on("add.konva",function(i){this._addListeners(i.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){let i=this,n,s=function(){i._sync()};for(n=0;n<jI;n++)t.on(Tx[n]+qI,s)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let t=this.getText(),i=this.getTag(),n,s,o,r,a,l,d;if(t&&i){switch(n=t.width(),s=t.height(),o=i.pointerDirection(),r=i.pointerWidth(),d=i.pointerHeight(),a=0,l=0,o){case U0:a=n/2,l=-1*d;break;case q0:a=n+r,l=s/2;break;case $0:a=n/2,l=s+d;break;case j0:a=-1*r,l=s/2;break}i.setAttrs({x:-1*a,y:-1*l,width:n,height:s}),t.setAttrs({x:-1*a,y:-1*l})}}};ha.Label=od;od.prototype.className="Label";(0,Fx._registerNode)(od);var ms=class extends WI.Shape{_sceneFunc(t){let i=this.width(),n=this.height(),s=this.pointerDirection(),o=this.pointerWidth(),r=this.pointerHeight(),a=this.cornerRadius(),l=0,d=0,c=0,u=0;typeof a=="number"?l=d=c=u=Math.min(a,i/2,n/2):(l=Math.min(a[0]||0,i/2,n/2),d=Math.min(a[1]||0,i/2,n/2),u=Math.min(a[2]||0,i/2,n/2),c=Math.min(a[3]||0,i/2,n/2)),t.beginPath(),t.moveTo(l,0),s===U0&&(t.lineTo((i-o)/2,0),t.lineTo(i/2,-1*r),t.lineTo((i+o)/2,0)),t.lineTo(i-d,0),t.arc(i-d,d,d,Math.PI*3/2,0,!1),s===q0&&(t.lineTo(i,(n-r)/2),t.lineTo(i+o,n/2),t.lineTo(i,(n+r)/2)),t.lineTo(i,n-u),t.arc(i-u,n-u,u,0,Math.PI/2,!1),s===$0&&(t.lineTo((i+o)/2,n),t.lineTo(i/2,n+r),t.lineTo((i-o)/2,n)),t.lineTo(c,n),t.arc(c,n-c,c,Math.PI/2,Math.PI,!1),s===j0&&(t.lineTo(0,(n+r)/2),t.lineTo(-1*o,n/2),t.lineTo(0,(n-r)/2)),t.lineTo(0,l),t.arc(l,l,l,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){let t=0,i=0,n=this.pointerWidth(),s=this.pointerHeight(),o=this.pointerDirection(),r=this.width(),a=this.height();return o===U0?(i-=s,a+=s):o===$0?a+=s:o===j0?(t-=n*1.5,r+=n):o===q0&&(r+=n*1.5),{x:t,y:i,width:r,height:a}}};ha.Tag=ms;ms.prototype.className="Tag";(0,Fx._registerNode)(ms);Sh.Factory.addGetterSetter(ms,"pointerDirection",$I);Sh.Factory.addGetterSetter(ms,"pointerWidth",0,(0,K0.getNumberValidator)());Sh.Factory.addGetterSetter(ms,"pointerHeight",0,(0,K0.getNumberValidator)());Sh.Factory.addGetterSetter(ms,"cornerRadius",0,(0,K0.getNumberOrArrayOfNumbersValidator)(4))});var Y0=oe(xh=>{"use strict";Object.defineProperty(xh,"__esModule",{value:!0});xh.Rect=void 0;var KI=Pe(),YI=Dt(),XI=De(),JI=at(),QI=Te(),pa=class extends YI.Shape{_sceneFunc(t){let i=this.cornerRadius(),n=this.width(),s=this.height();t.beginPath(),i?JI.Util.drawRoundedRectPath(t,n,s,i):t.rect(0,0,n,s),t.closePath(),t.fillStrokeShape(this)}};xh.Rect=pa;pa.prototype.className="Rect";(0,XI._registerNode)(pa);KI.Factory.addGetterSetter(pa,"cornerRadius",0,(0,QI.getNumberOrArrayOfNumbersValidator)(4))});var Lx=oe(Eh=>{"use strict";Object.defineProperty(Eh,"__esModule",{value:!0});Eh.RegularPolygon=void 0;var Ix=Pe(),ZI=Dt(),_x=Te(),e_=De(),Cs=class extends ZI.Shape{_sceneFunc(t){let i=this._getPoints();t.beginPath(),t.moveTo(i[0].x,i[0].y);for(let n=1;n<i.length;n++)t.lineTo(i[n].x,i[n].y);t.closePath(),t.fillStrokeShape(this)}_getPoints(){let t=this.attrs.sides,i=this.attrs.radius||0,n=[];for(let s=0;s<t;s++)n.push({x:i*Math.sin(s*2*Math.PI/t),y:-1*i*Math.cos(s*2*Math.PI/t)});return n}getSelfRect(){let t=this._getPoints(),i=t[0].x,n=t[0].y,s=t[0].x,o=t[0].y;return t.forEach(r=>{i=Math.min(i,r.x),n=Math.max(n,r.x),s=Math.min(s,r.y),o=Math.max(o,r.y)}),{x:i,y:s,width:n-i,height:o-s}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}};Eh.RegularPolygon=Cs;Cs.prototype.className="RegularPolygon";Cs.prototype._centroid=!0;Cs.prototype._attrsAffectingSize=["radius"];(0,e_._registerNode)(Cs);Ix.Factory.addGetterSetter(Cs,"radius",0,(0,_x.getNumberValidator)());Ix.Factory.addGetterSetter(Cs,"sides",0,(0,_x.getNumberValidator)())});var Hx=oe(Rh=>{"use strict";Object.defineProperty(Rh,"__esModule",{value:!0});Rh.Ring=void 0;var Nx=Pe(),t_=Dt(),Bx=Te(),i_=De(),Ox=Math.PI*2,vs=class extends t_.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,Ox,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),Ox,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}};Rh.Ring=vs;vs.prototype.className="Ring";vs.prototype._centroid=!0;vs.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,i_._registerNode)(vs);Nx.Factory.addGetterSetter(vs,"innerRadius",0,(0,Bx.getNumberValidator)());Nx.Factory.addGetterSetter(vs,"outerRadius",0,(0,Bx.getNumberValidator)())});var X0=oe(Mh=>{"use strict";Object.defineProperty(Mh,"__esModule",{value:!0});Mh.Sprite=void 0;var Yo=Pe(),n_=Dt(),s_=dh(),Vx=Te(),o_=De(),Ui=class extends n_.Shape{constructor(t){super(t),this._updated=!0,this.anim=new s_.Animation(()=>{let i=this._updated;return this._updated=!1,i}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){let i=this.animation(),n=this.frameIndex(),s=n*4,o=this.animations()[i],r=this.frameOffsets(),a=o[s+0],l=o[s+1],d=o[s+2],c=o[s+3],u=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,d,c),t.closePath(),t.fillStrokeShape(this)),u)if(r){let h=r[i],p=n*2;t.drawImage(u,a,l,d,c,h[p+0],h[p+1],d,c)}else t.drawImage(u,a,l,d,c,0,0,d,c)}_hitFunc(t){let i=this.animation(),n=this.frameIndex(),s=n*4,o=this.animations()[i],r=this.frameOffsets(),a=o[s+2],l=o[s+3];if(t.beginPath(),r){let d=r[i],c=n*2;t.rect(d[c+0],d[c+1],a,l)}else t.rect(0,0,a,l);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){let t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;let t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){let t=this.frameIndex(),i=this.animation(),n=this.animations(),s=n[i],o=s.length/4;t<o-1?this.frameIndex(t+1):this.frameIndex(0)}};Mh.Sprite=Ui;Ui.prototype.className="Sprite";(0,o_._registerNode)(Ui);Yo.Factory.addGetterSetter(Ui,"animation");Yo.Factory.addGetterSetter(Ui,"animations");Yo.Factory.addGetterSetter(Ui,"frameOffsets");Yo.Factory.addGetterSetter(Ui,"image");Yo.Factory.addGetterSetter(Ui,"frameIndex",0,(0,Vx.getNumberValidator)());Yo.Factory.addGetterSetter(Ui,"frameRate",17,(0,Vx.getNumberValidator)());Yo.Factory.backCompat(Ui,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"})});var Gx=oe(Dh=>{"use strict";Object.defineProperty(Dh,"__esModule",{value:!0});Dh.Star=void 0;var J0=Pe(),r_=Dt(),Q0=Te(),a_=De(),An=class extends r_.Shape{_sceneFunc(t){let i=this.innerRadius(),n=this.outerRadius(),s=this.numPoints();t.beginPath(),t.moveTo(0,0-n);for(let o=1;o<s*2;o++){let r=o%2===0?n:i,a=r*Math.sin(o*Math.PI/s),l=-1*r*Math.cos(o*Math.PI/s);t.lineTo(a,l)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}};Dh.Star=An;An.prototype.className="Star";An.prototype._centroid=!0;An.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,a_._registerNode)(An);J0.Factory.addGetterSetter(An,"numPoints",5,(0,Q0.getNumberValidator)());J0.Factory.addGetterSetter(An,"innerRadius",0,(0,Q0.getNumberValidator)());J0.Factory.addGetterSetter(An,"outerRadius",0,(0,Q0.getNumberValidator)())});var nC=oe(ad=>{"use strict";Object.defineProperty(ad,"__esModule",{value:!0});ad.Text=void 0;ad.stringToArray=Xo;var iC=at(),si=Pe(),l_=Dt(),Z0=De(),Ys=Te(),d_=De();function Xo(e){return[...e].reduce((t,i,n,s)=>{if(new RegExp("\\p{Emoji}","u").test(i)){let o=s[n+1];o&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(o)?(t.push(i+o),s[n+1]=""):t.push(i)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(i+(s[n+1]||""))?t.push(i+s[n+1]):n>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(i)?t[t.length-1]+=i:i&&t.push(i);return t},[])}var ga="auto",c_="center",$x="inherit",rd="justify",u_="Change.konva",h_="2d",zx="-",jx="left",p_="text",g_="Text",f_="top",m_="bottom",Wx="middle",Kx="normal",C_="px ",kh=" ",v_="right",Ux="rtl",w_="word",b_="char",qx="none",eC="\u2026",Yx=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],y_=Yx.length;function S_(e){return e.split(",").map(t=>{t=t.trim();let i=t.indexOf(" ")>=0,n=t.indexOf('"')>=0||t.indexOf("'")>=0;return i&&!n&&(t=`"${t}"`),t}).join(", ")}var Ph;function tC(){return Ph||(Ph=iC.Util.createCanvasElement().getContext(h_),Ph)}function x_(e){e.fillText(this._partialText,this._partialTextX,this._partialTextY)}function E_(e){e.setAttr("miterLimit",2),e.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function R_(e){return e=e||{},!e.fillLinearGradientColorStops&&!e.fillRadialGradientColorStops&&!e.fillPatternImage&&(e.fill=e.fill||"black"),e}var nt=class extends l_.Shape{constructor(t){super(R_(t)),this._partialTextX=0,this._partialTextY=0;for(let i=0;i<y_;i++)this.on(Yx[i]+u_,this._setTextData);this._setTextData()}_sceneFunc(t){let i=this.textArr,n=i.length;if(!this.text())return;let s=this.padding(),o=this.fontSize(),r=this.lineHeight()*o,a=this.verticalAlign(),l=this.direction(),d=0,c=this.align(),u=this.getWidth(),h=this.letterSpacing(),p=this.fill(),g=this.textDecoration(),f=g.indexOf("underline")!==-1,m=g.indexOf("line-through")!==-1,C;l=l===$x?t.direction:l;let v=r/2,w=Wx;if(Z0.Konva._fixTextRendering){let y=this.measureSize("M");w="alphabetic",v=(y.fontBoundingBoxAscent-y.fontBoundingBoxDescent)/2+r/2}for(l===Ux&&t.setAttr("direction",l),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",w),t.setAttr("textAlign",jx),a===Wx?d=(this.getHeight()-n*r-s*2)/2:a===m_&&(d=this.getHeight()-n*r-s*2),t.translate(s,d+s),C=0;C<n;C++){let y=0,S=0,x=i[C],E=x.text,T=x.width,L=x.lastInParagraph;if(t.save(),c===v_?y+=u-T-s*2:c===c_&&(y+=(u-T-s*2)/2),f){t.save(),t.beginPath();let N=Z0.Konva._fixTextRendering?Math.round(o/4):Math.round(o/2),$=y,G=v+S+N;t.moveTo($,G);let se=c===rd&&!L?u-s*2:T;t.lineTo($+Math.round(se),G),t.lineWidth=o/15;let ve=this._getLinearGradient();t.strokeStyle=ve||p,t.stroke(),t.restore()}if(m){t.save(),t.beginPath();let N=Z0.Konva._fixTextRendering?-Math.round(o/4):0;t.moveTo(y,v+S+N);let $=c===rd&&!L?u-s*2:T;t.lineTo(y+Math.round($),v+S+N),t.lineWidth=o/15;let G=this._getLinearGradient();t.strokeStyle=G||p,t.stroke(),t.restore()}if(l!==Ux&&(h!==0||c===rd)){let N=E.split(" ").length-1,$=Xo(E);for(let G=0;G<$.length;G++){let se=$[G];se===" "&&!L&&c===rd&&(y+=(u-s*2-T)/N),this._partialTextX=y,this._partialTextY=v+S,this._partialText=se,t.fillStrokeShape(this),y+=this.measureSize(se).width+h}}else h!==0&&t.setAttr("letterSpacing",`${h}px`),this._partialTextX=y,this._partialTextY=v+S,this._partialText=E,t.fillStrokeShape(this);t.restore(),n>1&&(v+=r)}}_hitFunc(t){let i=this.getWidth(),n=this.getHeight();t.beginPath(),t.rect(0,0,i,n),t.closePath(),t.fillStrokeShape(this)}setText(t){let i=iC.Util._isString(t)?t:t==null?"":t+"";return this._setAttr(p_,i),this}getWidth(){return this.attrs.width===ga||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===ga||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return iC.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var i,n,s,o,r,a,l,d,c,u,h;let p=tC(),g=this.fontSize(),f;p.save(),p.font=this._getContextFont(),f=p.measureText(t),p.restore();let m=g/100;return{actualBoundingBoxAscent:(i=f.actualBoundingBoxAscent)!==null&&i!==void 0?i:71.58203125*m,actualBoundingBoxDescent:(n=f.actualBoundingBoxDescent)!==null&&n!==void 0?n:0,actualBoundingBoxLeft:(s=f.actualBoundingBoxLeft)!==null&&s!==void 0?s:-7.421875*m,actualBoundingBoxRight:(o=f.actualBoundingBoxRight)!==null&&o!==void 0?o:75.732421875*m,alphabeticBaseline:(r=f.alphabeticBaseline)!==null&&r!==void 0?r:0,emHeightAscent:(a=f.emHeightAscent)!==null&&a!==void 0?a:100*m,emHeightDescent:(l=f.emHeightDescent)!==null&&l!==void 0?l:-20*m,fontBoundingBoxAscent:(d=f.fontBoundingBoxAscent)!==null&&d!==void 0?d:91*m,fontBoundingBoxDescent:(c=f.fontBoundingBoxDescent)!==null&&c!==void 0?c:21*m,hangingBaseline:(u=f.hangingBaseline)!==null&&u!==void 0?u:72.80000305175781*m,ideographicBaseline:(h=f.ideographicBaseline)!==null&&h!==void 0?h:-21*m,width:f.width,height:g}}_getContextFont(){return this.fontStyle()+kh+this.fontVariant()+kh+(this.fontSize()+C_)+S_(this.fontFamily())}_addTextLine(t){this.align()===rd&&(t=t.trim());let n=this._getTextWidth(t);return this.textArr.push({text:t,width:n,lastInParagraph:!1})}_getTextWidth(t){let i=this.letterSpacing(),n=t.length;return tC().measureText(t).width+i*n}_setTextData(){let t=this.text().split(`
`),i=+this.fontSize(),n=0,s=this.lineHeight()*i,o=this.attrs.width,r=this.attrs.height,a=o!==ga&&o!==void 0,l=r!==ga&&r!==void 0,d=this.padding(),c=o-d*2,u=r-d*2,h=0,p=this.wrap(),g=p!==qx,f=p!==b_&&g,m=this.ellipsis();this.textArr=[],tC().font=this._getContextFont();let C=m?this._getTextWidth(eC):0;for(let v=0,w=t.length;v<w;++v){let y=t[v],S=this._getTextWidth(y);if(a&&S>c)for(;y.length>0;){let x=0,E=Xo(y).length,T="",L=0;for(;x<E;){let N=x+E>>>1,$=Xo(y),G=$.slice(0,N+1).join(""),se=this._getTextWidth(G);(m&&l&&h+s>u?se+C:se)<=c?(x=N+1,T=G,L=se):E=N}if(T){if(f){let G=Xo(y),se=Xo(T),ve=G[se.length],me=ve===kh||ve===zx,dt;if(me&&L<=c)dt=se.length;else{let xi=se.lastIndexOf(kh),Le=se.lastIndexOf(zx);dt=Math.max(xi,Le)+1}dt>0&&(x=dt,T=G.slice(0,x).join(""),L=this._getTextWidth(T))}if(T=T.trimRight(),this._addTextLine(T),n=Math.max(n,L),h+=s,this._shouldHandleEllipsis(h)){this._tryToAddEllipsisToLastLine();break}if(y=Xo(y).slice(x).join("").trimLeft(),y.length>0&&(S=this._getTextWidth(y),S<=c)){this._addTextLine(y),h+=s,n=Math.max(n,S);break}}else break}else this._addTextLine(y),h+=s,n=Math.max(n,S),this._shouldHandleEllipsis(h)&&v<w-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),l&&h+s>u)break}this.textHeight=i,this.textWidth=n}_shouldHandleEllipsis(t){let i=+this.fontSize(),n=this.lineHeight()*i,s=this.attrs.height,o=s!==ga&&s!==void 0,r=this.padding(),a=s-r*2;return!(this.wrap()!==qx)||o&&t+n>a}_tryToAddEllipsisToLastLine(){let t=this.attrs.width,i=t!==ga&&t!==void 0,n=this.padding(),s=t-n*2,o=this.ellipsis(),r=this.textArr[this.textArr.length-1];!r||!o||(i&&(this._getTextWidth(r.text+eC)<s||(r.text=r.text.slice(0,r.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(r.text+eC))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){let t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,i=this.hasShadow();return t&&i?!0:super._useBufferCanvas()}};ad.Text=nt;nt.prototype._fillFunc=x_;nt.prototype._strokeFunc=E_;nt.prototype.className=g_;nt.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,d_._registerNode)(nt);si.Factory.overWriteSetter(nt,"width",(0,Ys.getNumberOrAutoValidator)());si.Factory.overWriteSetter(nt,"height",(0,Ys.getNumberOrAutoValidator)());si.Factory.addGetterSetter(nt,"direction",$x);si.Factory.addGetterSetter(nt,"fontFamily","Arial");si.Factory.addGetterSetter(nt,"fontSize",12,(0,Ys.getNumberValidator)());si.Factory.addGetterSetter(nt,"fontStyle",Kx);si.Factory.addGetterSetter(nt,"fontVariant",Kx);si.Factory.addGetterSetter(nt,"padding",0,(0,Ys.getNumberValidator)());si.Factory.addGetterSetter(nt,"align",jx);si.Factory.addGetterSetter(nt,"verticalAlign",f_);si.Factory.addGetterSetter(nt,"lineHeight",1,(0,Ys.getNumberValidator)());si.Factory.addGetterSetter(nt,"wrap",w_);si.Factory.addGetterSetter(nt,"ellipsis",!1,(0,Ys.getBooleanValidator)());si.Factory.addGetterSetter(nt,"letterSpacing",0,(0,Ys.getNumberValidator)());si.Factory.addGetterSetter(nt,"text","",(0,Ys.getStringValidator)());si.Factory.addGetterSetter(nt,"textDecoration","")});var eE=oe(Fh=>{"use strict";Object.defineProperty(Fh,"__esModule",{value:!0});Fh.TextPath=void 0;var sC=at(),tn=Pe(),M_=Dt(),ld=mh(),oC=nC(),Xx=Te(),D_=De(),k_="",Jx="normal";function Qx(e){e.fillText(this.partialText,0,0)}function Zx(e){e.strokeText(this.partialText,0,0)}var Ct=class extends M_.Shape{constructor(t){super(t),this.dummyCanvas=sC.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return ld.Path.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;let i=this.pathLength;return t-1>i?null:ld.Path.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=ld.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();let i=this.textDecoration(),n=this.fill(),s=this.fontSize(),o=this.glyphInfo;i==="underline"&&t.beginPath();for(let r=0;r<o.length;r++){t.save();let a=o[r].p0;t.translate(a.x,a.y),t.rotate(o[r].rotation),this.partialText=o[r].text,t.fillStrokeShape(this),i==="underline"&&(r===0&&t.moveTo(0,s/2+1),t.lineTo(s,s/2+1)),t.restore()}i==="underline"&&(t.strokeStyle=n,t.lineWidth=s/20,t.stroke()),t.restore()}_hitFunc(t){t.beginPath();let i=this.glyphInfo;if(i.length>=1){let n=i[0].p0;t.moveTo(n.x,n.y)}for(let n=0;n<i.length;n++){let s=i[n].p1;t.lineTo(s.x,s.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return sC.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return oC.Text.prototype.setText.call(this,t)}_getContextFont(){return oC.Text.prototype._getContextFont.call(this)}_getTextSize(t){let n=this.dummyCanvas.getContext("2d");n.save(),n.font=this._getContextFont();let s=n.measureText(t);return n.restore(),{width:s.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){let{width:t,height:i}=this._getTextSize(this.attrs.text);if(this.textWidth=t,this.textHeight=i,this.glyphInfo=[],!this.attrs.data)return null;let n=this.letterSpacing(),s=this.align(),o=this.kerningFunc(),r=Math.max(this.textWidth+((this.attrs.text||"").length-1)*n,0),a=0;s==="center"&&(a=Math.max(0,this.pathLength/2-r/2)),s==="right"&&(a=Math.max(0,this.pathLength-r));let l=(0,oC.stringToArray)(this.text()),d=a;for(let c=0;c<l.length;c++){let u=this._getPointAtLength(d);if(!u)return;let h=this._getTextSize(l[c]).width+n;if(l[c]===" "&&s==="justify"){let v=this.text().split(" ").length-1;h+=(this.pathLength-r)/v}let p=this._getPointAtLength(d+h);if(!p)return;let g=ld.Path.getLineLength(u.x,u.y,p.x,p.y),f=0;if(o)try{f=o(l[c-1],l[c])*this.fontSize()}catch{f=0}u.x+=f,p.x+=f,this.textWidth+=f;let m=ld.Path.getPointOnLine(f+g/2,u.x,u.y,p.x,p.y),C=Math.atan2(p.y-u.y,p.x-u.x);this.glyphInfo.push({transposeX:m.x,transposeY:m.y,text:l[c],rotation:C,p0:u,p1:p}),d+=h}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};let t=[];this.glyphInfo.forEach(function(d){t.push(d.p0.x),t.push(d.p0.y),t.push(d.p1.x),t.push(d.p1.y)});let i=t[0]||0,n=t[0]||0,s=t[1]||0,o=t[1]||0,r,a;for(let d=0;d<t.length/2;d++)r=t[d*2],a=t[d*2+1],i=Math.min(i,r),n=Math.max(n,r),s=Math.min(s,a),o=Math.max(o,a);let l=this.fontSize();return{x:i-l/2,y:s-l/2,width:n-i+l,height:o-s+l}}destroy(){return sC.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};Fh.TextPath=Ct;Ct.prototype._fillFunc=Qx;Ct.prototype._strokeFunc=Zx;Ct.prototype._fillFuncHit=Qx;Ct.prototype._strokeFuncHit=Zx;Ct.prototype.className="TextPath";Ct.prototype._attrsAffectingSize=["text","fontSize","data"];(0,D_._registerNode)(Ct);tn.Factory.addGetterSetter(Ct,"data");tn.Factory.addGetterSetter(Ct,"fontFamily","Arial");tn.Factory.addGetterSetter(Ct,"fontSize",12,(0,Xx.getNumberValidator)());tn.Factory.addGetterSetter(Ct,"fontStyle",Jx);tn.Factory.addGetterSetter(Ct,"align","left");tn.Factory.addGetterSetter(Ct,"letterSpacing",0,(0,Xx.getNumberValidator)());tn.Factory.addGetterSetter(Ct,"textBaseline","middle");tn.Factory.addGetterSetter(Ct,"fontVariant",Jx);tn.Factory.addGetterSetter(Ct,"text",k_);tn.Factory.addGetterSetter(Ct,"textDecoration","");tn.Factory.addGetterSetter(Ct,"kerningFunc",void 0)});var aE=oe(Ah=>{"use strict";Object.defineProperty(Ah,"__esModule",{value:!0});Ah.Transformer=void 0;var $e=at(),Ne=Pe(),tE=pt(),P_=Dt(),F_=Y0(),iE=nd(),nn=De(),Xs=Te(),T_=De(),oE="tr-konva",A_=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(e=>e+`.${oE}`).join(" "),nE="nodesRect",I_=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],__={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},L_="ontouchstart"in nn.Konva._global;function O_(e,t,i){if(e==="rotater")return i;t+=$e.Util.degToRad(__[e]||0);let n=($e.Util.radToDeg(t)%360+360)%360;return $e.Util._inRange(n,315+22.5,360)||$e.Util._inRange(n,0,22.5)?"ns-resize":$e.Util._inRange(n,45-22.5,45+22.5)?"nesw-resize":$e.Util._inRange(n,90-22.5,90+22.5)?"ew-resize":$e.Util._inRange(n,135-22.5,135+22.5)?"nwse-resize":$e.Util._inRange(n,180-22.5,180+22.5)?"ns-resize":$e.Util._inRange(n,225-22.5,225+22.5)?"nesw-resize":$e.Util._inRange(n,270-22.5,270+22.5)?"ew-resize":$e.Util._inRange(n,315-22.5,315+22.5)?"nwse-resize":($e.Util.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}var Th=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],sE=1e8;function N_(e){return{x:e.x+e.width/2*Math.cos(e.rotation)+e.height/2*Math.sin(-e.rotation),y:e.y+e.height/2*Math.cos(e.rotation)+e.width/2*Math.sin(e.rotation)}}function rE(e,t,i){let n=i.x+(e.x-i.x)*Math.cos(t)-(e.y-i.y)*Math.sin(t),s=i.y+(e.x-i.x)*Math.sin(t)+(e.y-i.y)*Math.cos(t);return O(b({},e),{rotation:e.rotation+t,x:n,y:s})}function B_(e,t){let i=N_(e);return rE(e,t,i)}function H_(e,t,i){let n=t;for(let s=0;s<e.length;s++){let o=nn.Konva.getAngle(e[s]),r=Math.abs(o-t)%(Math.PI*2);Math.min(r,Math.PI*2-r)<i&&(n=o)}return n}var rC=0,Ae=class extends iE.Group{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(A_,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return $e.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return oE+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();let i=t.filter(s=>s.isAncestorOf(this)?($e.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=t=i,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(s=>{let o=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(s._attrsAffectingSize.length){let r=s._attrsAffectingSize.map(a=>a+"Change."+this._getEventNamespace()).join(" ");s.on(r,o)}s.on(I_.map(r=>r+`.${this._getEventNamespace()}`).join(" "),o),s.on(`absoluteTransformChange.${this._getEventNamespace()}`,o),this._proxyDrag(s)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let i;t.on(`dragstart.${this._getEventNamespace()}`,n=>{i=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(n,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,n=>{if(!i)return;let s=t.getAbsolutePosition(),o=s.x-i.x,r=s.y-i.y;this.nodes().forEach(a=>{if(a===t||a.isDragging())return;let l=a.getAbsolutePosition();a.setAbsolutePosition({x:l.x+o,y:l.y+r}),a.startDrag(n)}),i=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(nE),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(nE,this.__getNodeRect)}__getNodeShape(t,i=this.rotation(),n){let s=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),o=t.getAbsoluteScale(n),r=t.getAbsolutePosition(n),a=s.x*o.x-t.offsetX()*o.x,l=s.y*o.y-t.offsetY()*o.y,d=(nn.Konva.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),c={x:r.x+a*Math.cos(d)+l*Math.sin(-d),y:r.y+l*Math.cos(d)+a*Math.sin(d),width:s.width*o.x,height:s.height*o.y,rotation:d};return rE(c,-nn.Konva.getAngle(i),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-sE,y:-sE,width:0,height:0,rotation:0};let i=[];this.nodes().map(d=>{let c=d.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),u=[{x:c.x,y:c.y},{x:c.x+c.width,y:c.y},{x:c.x+c.width,y:c.y+c.height},{x:c.x,y:c.y+c.height}],h=d.getAbsoluteTransform();u.forEach(function(p){let g=h.point(p);i.push(g)})});let n=new $e.Transform;n.rotate(-nn.Konva.getAngle(this.rotation()));let s=1/0,o=1/0,r=-1/0,a=-1/0;i.forEach(function(d){let c=n.point(d);s===void 0&&(s=r=c.x,o=a=c.y),s=Math.min(s,c.x),o=Math.min(o,c.y),r=Math.max(r,c.x),a=Math.max(a,c.y)}),n.invert();let l=n.point({x:s,y:o});return{x:l.x,y:l.y,width:r-s,height:a-o,rotation:nn.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Th.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){let i=new F_.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:L_?10:"auto"}),n=this;i.on("mousedown touchstart",function(s){n._handleMouseDown(s)}),i.on("dragstart",s=>{i.stopDrag(),s.cancelBubble=!0}),i.on("dragend",s=>{s.cancelBubble=!0}),i.on("mouseenter",()=>{let s=nn.Konva.getAngle(this.rotation()),o=this.rotateAnchorCursor(),r=O_(t,s,o);i.getStage().content&&(i.getStage().content.style.cursor=r),this._cursorChange=!0}),i.on("mouseout",()=>{i.getStage().content&&(i.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(i)}_createBack(){let t=new P_.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(i,n){let s=n.getParent(),o=s.padding();i.beginPath(),i.rect(-o,-o,n.width()+o*2,n.height()+o*2),i.moveTo(n.width()/2,-o),s.rotateEnabled()&&s.rotateLineVisible()&&i.lineTo(n.width()/2,-s.rotateAnchorOffset()*$e.Util._sign(n.height())-o),i.fillStrokeShape(n)},hitFunc:(i,n)=>{if(!this.shouldOverdrawWholeArea())return;let s=this.padding();i.beginPath(),i.rect(-s,-s,n.width()+s*2,n.height()+s*2),i.fillStrokeShape(n)}});this.add(t),this._proxyDrag(t),t.on("dragstart",i=>{i.cancelBubble=!0}),t.on("dragmove",i=>{i.cancelBubble=!0}),t.on("dragend",i=>{i.cancelBubble=!0}),this.on("dragmove",i=>{this.update()})}_handleMouseDown(t){if(this._transforming)return;this._movingAnchorName=t.target.name().split(" ")[0];let i=this._getNodeRect(),n=i.width,s=i.height,o=Math.sqrt(Math.pow(n,2)+Math.pow(s,2));this.sin=Math.abs(s/o),this.cos=Math.abs(n/o),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;let r=t.target.getAbsolutePosition(),a=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:a.x-r.x,y:a.y-r.y},rC++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(l=>{l._fire("transformstart",{evt:t.evt,target:l})})}_handleMouseMove(t){let i,n,s,o=this.findOne("."+this._movingAnchorName),r=o.getStage();r.setPointersPositions(t);let a=r.getPointerPosition(),l={x:a.x-this._anchorDragOffset.x,y:a.y-this._anchorDragOffset.y},d=o.getAbsolutePosition();this.anchorDragBoundFunc()&&(l=this.anchorDragBoundFunc()(d,l,t)),o.setAbsolutePosition(l);let c=o.getAbsolutePosition();if(d.x===c.x&&d.y===c.y)return;if(this._movingAnchorName==="rotater"){let v=this._getNodeRect();i=o.x()-v.width/2,n=-o.y()+v.height/2;let w=Math.atan2(-n,i)+Math.PI/2;v.height<0&&(w-=Math.PI);let S=nn.Konva.getAngle(this.rotation())+w,x=nn.Konva.getAngle(this.rotationSnapTolerance()),T=H_(this.rotationSnaps(),S,x)-v.rotation,L=B_(v,T);this._fitNodesInto(L,t);return}let u=this.shiftBehavior(),h;u==="inverted"?h=this.keepRatio()&&!t.shiftKey:u==="none"?h=this.keepRatio():h=this.keepRatio()||t.shiftKey;let p=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(h){let v=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};s=Math.sqrt(Math.pow(v.x-o.x(),2)+Math.pow(v.y-o.y(),2));let w=this.findOne(".top-left").x()>v.x?-1:1,y=this.findOne(".top-left").y()>v.y?-1:1;i=s*this.cos*w,n=s*this.sin*y,this.findOne(".top-left").x(v.x-i),this.findOne(".top-left").y(v.y-n)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(o.y());else if(this._movingAnchorName==="top-right"){if(h){let v=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};s=Math.sqrt(Math.pow(o.x()-v.x,2)+Math.pow(v.y-o.y(),2));let w=this.findOne(".top-right").x()<v.x?-1:1,y=this.findOne(".top-right").y()>v.y?-1:1;i=s*this.cos*w,n=s*this.sin*y,this.findOne(".top-right").x(v.x+i),this.findOne(".top-right").y(v.y-n)}var g=o.position();this.findOne(".top-left").y(g.y),this.findOne(".bottom-right").x(g.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(o.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(o.x());else if(this._movingAnchorName==="bottom-left"){if(h){let v=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};s=Math.sqrt(Math.pow(v.x-o.x(),2)+Math.pow(o.y()-v.y,2));let w=v.x<o.x()?-1:1,y=o.y()<v.y?-1:1;i=s*this.cos*w,n=s*this.sin*y,o.x(v.x-i),o.y(v.y+n)}g=o.position(),this.findOne(".top-left").x(g.x),this.findOne(".bottom-right").y(g.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(o.y());else if(this._movingAnchorName==="bottom-right"){if(h){let v=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};s=Math.sqrt(Math.pow(o.x()-v.x,2)+Math.pow(o.y()-v.y,2));let w=this.findOne(".bottom-right").x()<v.x?-1:1,y=this.findOne(".bottom-right").y()<v.y?-1:1;i=s*this.cos*w,n=s*this.sin*y,this.findOne(".bottom-right").x(v.x+i),this.findOne(".bottom-right").y(v.y+n)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(p=this.centeredScaling()||t.altKey,p){let v=this.findOne(".top-left"),w=this.findOne(".bottom-right"),y=v.x(),S=v.y(),x=this.getWidth()-w.x(),E=this.getHeight()-w.y();w.move({x:-y,y:-S}),v.move({x,y:E})}let f=this.findOne(".top-left").getAbsolutePosition();i=f.x,n=f.y;let m=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),C=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:i,y:n,width:m,height:C,rotation:nn.Konva.getAngle(this.rotation())},t)}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var i;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));let n=this.getNode();rC--,this._fire("transformend",{evt:t,target:n}),(i=this.getLayer())===null||i===void 0||i.batchDraw(),n&&this._nodes.forEach(s=>{var o;s._fire("transformend",{evt:t,target:s}),(o=s.getLayer())===null||o===void 0||o.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(t,i){let n=this._getNodeRect(),s=1;if($e.Util._inRange(t.width,-this.padding()*2-s,s)){this.update();return}if($e.Util._inRange(t.height,-this.padding()*2-s,s)){this.update();return}let o=new $e.Transform;if(o.rotate(nn.Konva.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){let h=o.point({x:-this.padding()*2,y:0});t.x+=h.x,t.y+=h.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){let h=o.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){let h=o.point({x:0,y:-this.padding()*2});t.x+=h.x,t.y+=h.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){let h=o.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){let h=this.boundBoxFunc()(n,t);h?t=h:$e.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}let r=1e7,a=new $e.Transform;a.translate(n.x,n.y),a.rotate(n.rotation),a.scale(n.width/r,n.height/r);let l=new $e.Transform,d=t.width/r,c=t.height/r;this.flipEnabled()===!1?(l.translate(t.x,t.y),l.rotate(t.rotation),l.translate(t.width<0?t.width:0,t.height<0?t.height:0),l.scale(Math.abs(d),Math.abs(c))):(l.translate(t.x,t.y),l.rotate(t.rotation),l.scale(d,c));let u=l.multiply(a.invert());this._nodes.forEach(h=>{var p;let g=h.getParent().getAbsoluteTransform(),f=h.getTransform().copy();f.translate(h.offsetX(),h.offsetY());let m=new $e.Transform;m.multiply(g.copy().invert()).multiply(u).multiply(g).multiply(f);let C=m.decompose();h.setAttrs(C),(p=h.getLayer())===null||p===void 0||p.batchDraw()}),this.rotation($e.Util._getRotation(t.rotation)),this._nodes.forEach(h=>{this._fire("transform",{evt:i,target:h}),h._fire("transform",{evt:i,target:h})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,i){this.findOne(t).setAttrs(i)}update(){var t;let i=this._getNodeRect();this.rotation($e.Util._getRotation(i.rotation));let n=i.width,s=i.height,o=this.enabledAnchors(),r=this.resizeEnabled(),a=this.padding(),l=this.anchorSize(),d=this.find("._anchor");d.forEach(u=>{u.setAttrs({width:l,height:l,offsetX:l/2,offsetY:l/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:l/2+a,offsetY:l/2+a,visible:r&&o.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:n/2,y:0,offsetY:l/2+a,visible:r&&o.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:n,y:0,offsetX:l/2-a,offsetY:l/2+a,visible:r&&o.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:s/2,offsetX:l/2+a,visible:r&&o.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:n,y:s/2,offsetX:l/2-a,visible:r&&o.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:s,offsetX:l/2+a,offsetY:l/2-a,visible:r&&o.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:n/2,y:s,offsetY:l/2-a,visible:r&&o.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:n,y:s,offsetX:l/2-a,offsetY:l/2-a,visible:r&&o.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:n/2,y:-this.rotateAnchorOffset()*$e.Util._sign(s)-a,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:n,height:s,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});let c=this.anchorStyleFunc();c&&d.forEach(u=>{c(u)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();let t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),iE.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return tE.Node.prototype.toObject.call(this)}clone(t){return tE.Node.prototype.clone.call(this,t)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};Ah.Transformer=Ae;Ae.isTransforming=()=>rC>0;function V_(e){return e instanceof Array||$e.Util.warn("enabledAnchors value should be an array"),e instanceof Array&&e.forEach(function(t){Th.indexOf(t)===-1&&$e.Util.warn("Unknown anchor name: "+t+". Available names are: "+Th.join(", "))}),e||[]}Ae.prototype.className="Transformer";(0,T_._registerNode)(Ae);Ne.Factory.addGetterSetter(Ae,"enabledAnchors",Th,V_);Ne.Factory.addGetterSetter(Ae,"flipEnabled",!0,(0,Xs.getBooleanValidator)());Ne.Factory.addGetterSetter(Ae,"resizeEnabled",!0);Ne.Factory.addGetterSetter(Ae,"anchorSize",10,(0,Xs.getNumberValidator)());Ne.Factory.addGetterSetter(Ae,"rotateEnabled",!0);Ne.Factory.addGetterSetter(Ae,"rotateLineVisible",!0);Ne.Factory.addGetterSetter(Ae,"rotationSnaps",[]);Ne.Factory.addGetterSetter(Ae,"rotateAnchorOffset",50,(0,Xs.getNumberValidator)());Ne.Factory.addGetterSetter(Ae,"rotateAnchorCursor","crosshair");Ne.Factory.addGetterSetter(Ae,"rotationSnapTolerance",5,(0,Xs.getNumberValidator)());Ne.Factory.addGetterSetter(Ae,"borderEnabled",!0);Ne.Factory.addGetterSetter(Ae,"anchorStroke","rgb(0, 161, 255)");Ne.Factory.addGetterSetter(Ae,"anchorStrokeWidth",1,(0,Xs.getNumberValidator)());Ne.Factory.addGetterSetter(Ae,"anchorFill","white");Ne.Factory.addGetterSetter(Ae,"anchorCornerRadius",0,(0,Xs.getNumberValidator)());Ne.Factory.addGetterSetter(Ae,"borderStroke","rgb(0, 161, 255)");Ne.Factory.addGetterSetter(Ae,"borderStrokeWidth",1,(0,Xs.getNumberValidator)());Ne.Factory.addGetterSetter(Ae,"borderDash");Ne.Factory.addGetterSetter(Ae,"keepRatio",!0);Ne.Factory.addGetterSetter(Ae,"shiftBehavior","default");Ne.Factory.addGetterSetter(Ae,"centeredScaling",!1);Ne.Factory.addGetterSetter(Ae,"ignoreStroke",!1);Ne.Factory.addGetterSetter(Ae,"padding",0,(0,Xs.getNumberValidator)());Ne.Factory.addGetterSetter(Ae,"nodes");Ne.Factory.addGetterSetter(Ae,"node");Ne.Factory.addGetterSetter(Ae,"boundBoxFunc");Ne.Factory.addGetterSetter(Ae,"anchorDragBoundFunc");Ne.Factory.addGetterSetter(Ae,"anchorStyleFunc");Ne.Factory.addGetterSetter(Ae,"shouldOverdrawWholeArea",!1);Ne.Factory.addGetterSetter(Ae,"useSingleNodeRotation",!0);Ne.Factory.backCompat(Ae,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"})});var dE=oe(_h=>{"use strict";Object.defineProperty(_h,"__esModule",{value:!0});_h.Wedge=void 0;var Ih=Pe(),G_=Dt(),z_=De(),lE=Te(),W_=De(),sn=class extends G_.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,z_.Konva.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}};_h.Wedge=sn;sn.prototype.className="Wedge";sn.prototype._centroid=!0;sn.prototype._attrsAffectingSize=["radius"];(0,W_._registerNode)(sn);Ih.Factory.addGetterSetter(sn,"radius",0,(0,lE.getNumberValidator)());Ih.Factory.addGetterSetter(sn,"angle",0,(0,lE.getNumberValidator)());Ih.Factory.addGetterSetter(sn,"clockwise",!1);Ih.Factory.backCompat(sn,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"})});var hE=oe(Lh=>{"use strict";Object.defineProperty(Lh,"__esModule",{value:!0});Lh.Blur=void 0;var cE=Pe(),U_=pt(),q_=Te();function uE(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var $_=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],j_=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function K_(e,t){let i=e.data,n=e.width,s=e.height,o,r,a,l,d,c,u,h,p,g,f,m,C,v,w,y,S,x,E,T,L=t+t+1,N=n-1,$=s-1,G=t+1,se=G*(G+1)/2,ve=new uE,me=$_[t],dt=j_[t],xi=null,Le=ve,Je=null,He=null;for(let kt=1;kt<L;kt++)Le=Le.next=new uE,kt===G&&(xi=Le);Le.next=ve,a=r=0;for(let kt=0;kt<s;kt++){m=C=v=w=l=d=c=u=0,h=G*(y=i[r]),p=G*(S=i[r+1]),g=G*(x=i[r+2]),f=G*(E=i[r+3]),l+=se*y,d+=se*S,c+=se*x,u+=se*E,Le=ve;for(let Pt=0;Pt<G;Pt++)Le.r=y,Le.g=S,Le.b=x,Le.a=E,Le=Le.next;for(let Pt=1;Pt<G;Pt++)o=r+((N<Pt?N:Pt)<<2),l+=(Le.r=y=i[o])*(T=G-Pt),d+=(Le.g=S=i[o+1])*T,c+=(Le.b=x=i[o+2])*T,u+=(Le.a=E=i[o+3])*T,m+=y,C+=S,v+=x,w+=E,Le=Le.next;Je=ve,He=xi;for(let Pt=0;Pt<n;Pt++)i[r+3]=E=u*me>>dt,E!==0?(E=255/E,i[r]=(l*me>>dt)*E,i[r+1]=(d*me>>dt)*E,i[r+2]=(c*me>>dt)*E):i[r]=i[r+1]=i[r+2]=0,l-=h,d-=p,c-=g,u-=f,h-=Je.r,p-=Je.g,g-=Je.b,f-=Je.a,o=a+((o=Pt+t+1)<N?o:N)<<2,m+=Je.r=i[o],C+=Je.g=i[o+1],v+=Je.b=i[o+2],w+=Je.a=i[o+3],l+=m,d+=C,c+=v,u+=w,Je=Je.next,h+=y=He.r,p+=S=He.g,g+=x=He.b,f+=E=He.a,m-=y,C-=S,v-=x,w-=E,He=He.next,r+=4;a+=n}for(let kt=0;kt<n;kt++){C=v=w=m=d=c=u=l=0,r=kt<<2,h=G*(y=i[r]),p=G*(S=i[r+1]),g=G*(x=i[r+2]),f=G*(E=i[r+3]),l+=se*y,d+=se*S,c+=se*x,u+=se*E,Le=ve;for(let It=0;It<G;It++)Le.r=y,Le.g=S,Le.b=x,Le.a=E,Le=Le.next;let Pt=n;for(let It=1;It<=t;It++)r=Pt+kt<<2,l+=(Le.r=y=i[r])*(T=G-It),d+=(Le.g=S=i[r+1])*T,c+=(Le.b=x=i[r+2])*T,u+=(Le.a=E=i[r+3])*T,m+=y,C+=S,v+=x,w+=E,Le=Le.next,It<$&&(Pt+=n);r=kt,Je=ve,He=xi;for(let It=0;It<s;It++)o=r<<2,i[o+3]=E=u*me>>dt,E>0?(E=255/E,i[o]=(l*me>>dt)*E,i[o+1]=(d*me>>dt)*E,i[o+2]=(c*me>>dt)*E):i[o]=i[o+1]=i[o+2]=0,l-=h,d-=p,c-=g,u-=f,h-=Je.r,p-=Je.g,g-=Je.b,f-=Je.a,o=kt+((o=It+G)<$?o:$)*n<<2,l+=m+=Je.r=i[o],d+=C+=Je.g=i[o+1],c+=v+=Je.b=i[o+2],u+=w+=Je.a=i[o+3],Je=Je.next,h+=y=He.r,p+=S=He.g,g+=x=He.b,f+=E=He.a,m-=y,C-=S,v-=x,w-=E,He=He.next,r+=n}}var Y_=function(t){let i=Math.round(this.blurRadius());i>0&&K_(t,i)};Lh.Blur=Y_;cE.Factory.addGetterSetter(U_.Node,"blurRadius",0,(0,q_.getNumberValidator)(),cE.Factory.afterSetFilter)});var gE=oe(Oh=>{"use strict";Object.defineProperty(Oh,"__esModule",{value:!0});Oh.Brighten=void 0;var pE=Pe(),X_=pt(),J_=Te(),Q_=function(e){let t=this.brightness()*255,i=e.data,n=i.length;for(let s=0;s<n;s+=4)i[s]+=t,i[s+1]+=t,i[s+2]+=t};Oh.Brighten=Q_;pE.Factory.addGetterSetter(X_.Node,"brightness",0,(0,J_.getNumberValidator)(),pE.Factory.afterSetFilter)});var mE=oe(Nh=>{"use strict";Object.defineProperty(Nh,"__esModule",{value:!0});Nh.Contrast=void 0;var fE=Pe(),Z_=pt(),eL=Te(),tL=function(e){let t=Math.pow((this.contrast()+100)/100,2),i=e.data,n=i.length,s=150,o=150,r=150;for(let a=0;a<n;a+=4)s=i[a],o=i[a+1],r=i[a+2],s/=255,s-=.5,s*=t,s+=.5,s*=255,o/=255,o-=.5,o*=t,o+=.5,o*=255,r/=255,r-=.5,r*=t,r+=.5,r*=255,s=s<0?0:s>255?255:s,o=o<0?0:o>255?255:o,r=r<0?0:r>255?255:r,i[a]=s,i[a+1]=o,i[a+2]=r};Nh.Contrast=tL;fE.Factory.addGetterSetter(Z_.Node,"contrast",0,(0,eL.getNumberValidator)(),fE.Factory.afterSetFilter)});var vE=oe(Hh=>{"use strict";Object.defineProperty(Hh,"__esModule",{value:!0});Hh.Emboss=void 0;var Js=Pe(),Bh=pt(),iL=at(),CE=Te(),nL=function(e){let t=this.embossStrength()*10,i=this.embossWhiteLevel()*255,n=this.embossDirection(),s=this.embossBlend(),o=e.data,r=e.width,a=e.height,l=r*4,d=0,c=0,u=a;switch(n){case"top-left":d=-1,c=-1;break;case"top":d=-1,c=0;break;case"top-right":d=-1,c=1;break;case"right":d=0,c=1;break;case"bottom-right":d=1,c=1;break;case"bottom":d=1,c=0;break;case"bottom-left":d=1,c=-1;break;case"left":d=0,c=-1;break;default:iL.Util.error("Unknown emboss direction: "+n)}do{let h=(u-1)*l,p=d;u+p<1&&(p=0),u+p>a&&(p=0);let g=(u-1+p)*r*4,f=r;do{let m=h+(f-1)*4,C=c;f+C<1&&(C=0),f+C>r&&(C=0);let v=g+(f-1+C)*4,w=o[m]-o[v],y=o[m+1]-o[v+1],S=o[m+2]-o[v+2],x=w,E=x>0?x:-x,T=y>0?y:-y,L=S>0?S:-S;if(T>E&&(x=y),L>E&&(x=S),x*=t,s){let N=o[m]+x,$=o[m+1]+x,G=o[m+2]+x;o[m]=N>255?255:N<0?0:N,o[m+1]=$>255?255:$<0?0:$,o[m+2]=G>255?255:G<0?0:G}else{let N=i-x;N<0?N=0:N>255&&(N=255),o[m]=o[m+1]=o[m+2]=N}}while(--f)}while(--u)};Hh.Emboss=nL;Js.Factory.addGetterSetter(Bh.Node,"embossStrength",.5,(0,CE.getNumberValidator)(),Js.Factory.afterSetFilter);Js.Factory.addGetterSetter(Bh.Node,"embossWhiteLevel",.5,(0,CE.getNumberValidator)(),Js.Factory.afterSetFilter);Js.Factory.addGetterSetter(Bh.Node,"embossDirection","top-left",void 0,Js.Factory.afterSetFilter);Js.Factory.addGetterSetter(Bh.Node,"embossBlend",!1,void 0,Js.Factory.afterSetFilter)});var bE=oe(Vh=>{"use strict";Object.defineProperty(Vh,"__esModule",{value:!0});Vh.Enhance=void 0;var wE=Pe(),sL=pt(),oL=Te();function aC(e,t,i,n,s){let o=i-t,r=s-n;if(o===0)return n+r/2;if(r===0)return n;let a=(e-t)/o;return a=r*a+n,a}var rL=function(e){let t=e.data,i=t.length,n=t[0],s=n,o,r=t[1],a=r,l,d=t[2],c=d,u,h=this.enhance();if(h===0)return;for(let w=0;w<i;w+=4)o=t[w+0],o<n?n=o:o>s&&(s=o),l=t[w+1],l<r?r=l:l>a&&(a=l),u=t[w+2],u<d?d=u:u>c&&(c=u);s===n&&(s=255,n=0),a===r&&(a=255,r=0),c===d&&(c=255,d=0);let p,g,f,m,C,v;if(h>0)p=s+h*(255-s),g=n-h*(n-0),f=a+h*(255-a),m=r-h*(r-0),C=c+h*(255-c),v=d-h*(d-0);else{let w=(s+n)*.5;p=s+h*(s-w),g=n+h*(n-w);let y=(a+r)*.5;f=a+h*(a-y),m=r+h*(r-y);let S=(c+d)*.5;C=c+h*(c-S),v=d+h*(d-S)}for(let w=0;w<i;w+=4)t[w+0]=aC(t[w+0],n,s,g,p),t[w+1]=aC(t[w+1],r,a,m,f),t[w+2]=aC(t[w+2],d,c,v,C)};Vh.Enhance=rL;wE.Factory.addGetterSetter(sL.Node,"enhance",0,(0,oL.getNumberValidator)(),wE.Factory.afterSetFilter)});var yE=oe(Gh=>{"use strict";Object.defineProperty(Gh,"__esModule",{value:!0});Gh.Grayscale=void 0;var aL=function(e){let t=e.data,i=t.length;for(let n=0;n<i;n+=4){let s=.34*t[n]+.5*t[n+1]+.16*t[n+2];t[n]=s,t[n+1]=s,t[n+2]=s}};Gh.Grayscale=aL});var SE=oe(zh=>{"use strict";Object.defineProperty(zh,"__esModule",{value:!0});zh.HSL=void 0;var fa=Pe(),lC=pt(),dC=Te();fa.Factory.addGetterSetter(lC.Node,"hue",0,(0,dC.getNumberValidator)(),fa.Factory.afterSetFilter);fa.Factory.addGetterSetter(lC.Node,"saturation",0,(0,dC.getNumberValidator)(),fa.Factory.afterSetFilter);fa.Factory.addGetterSetter(lC.Node,"luminance",0,(0,dC.getNumberValidator)(),fa.Factory.afterSetFilter);var lL=function(e){let t=e.data,i=t.length,n=1,s=Math.pow(2,this.saturation()),o=Math.abs(this.hue()+360)%360,r=this.luminance()*127,a=n*s*Math.cos(o*Math.PI/180),l=n*s*Math.sin(o*Math.PI/180),d=.299*n+.701*a+.167*l,c=.587*n-.587*a+.33*l,u=.114*n-.114*a-.497*l,h=.299*n-.299*a-.328*l,p=.587*n+.413*a+.035*l,g=.114*n-.114*a+.293*l,f=.299*n-.3*a+1.25*l,m=.587*n-.586*a-1.05*l,C=.114*n+.886*a-.2*l,v,w,y,S;for(let x=0;x<i;x+=4)v=t[x+0],w=t[x+1],y=t[x+2],S=t[x+3],t[x+0]=d*v+c*w+u*y+r,t[x+1]=h*v+p*w+g*y+r,t[x+2]=f*v+m*w+C*y+r,t[x+3]=S};zh.HSL=lL});var xE=oe(Wh=>{"use strict";Object.defineProperty(Wh,"__esModule",{value:!0});Wh.HSV=void 0;var ma=Pe(),cC=pt(),uC=Te(),dL=function(e){let t=e.data,i=t.length,n=Math.pow(2,this.value()),s=Math.pow(2,this.saturation()),o=Math.abs(this.hue()+360)%360,r=n*s*Math.cos(o*Math.PI/180),a=n*s*Math.sin(o*Math.PI/180),l=.299*n+.701*r+.167*a,d=.587*n-.587*r+.33*a,c=.114*n-.114*r-.497*a,u=.299*n-.299*r-.328*a,h=.587*n+.413*r+.035*a,p=.114*n-.114*r+.293*a,g=.299*n-.3*r+1.25*a,f=.587*n-.586*r-1.05*a,m=.114*n+.886*r-.2*a;for(let C=0;C<i;C+=4){let v=t[C+0],w=t[C+1],y=t[C+2],S=t[C+3];t[C+0]=l*v+d*w+c*y,t[C+1]=u*v+h*w+p*y,t[C+2]=g*v+f*w+m*y,t[C+3]=S}};Wh.HSV=dL;ma.Factory.addGetterSetter(cC.Node,"hue",0,(0,uC.getNumberValidator)(),ma.Factory.afterSetFilter);ma.Factory.addGetterSetter(cC.Node,"saturation",0,(0,uC.getNumberValidator)(),ma.Factory.afterSetFilter);ma.Factory.addGetterSetter(cC.Node,"value",0,(0,uC.getNumberValidator)(),ma.Factory.afterSetFilter)});var EE=oe(Uh=>{"use strict";Object.defineProperty(Uh,"__esModule",{value:!0});Uh.Invert=void 0;var cL=function(e){let t=e.data,i=t.length;for(let n=0;n<i;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2]};Uh.Invert=cL});var kE=oe($h=>{"use strict";Object.defineProperty($h,"__esModule",{value:!0});$h.Kaleidoscope=void 0;var qh=Pe(),ME=pt(),RE=at(),DE=Te(),uL=function(e,t,i){let n=e.data,s=t.data,o=e.width,r=e.height,a=i.polarCenterX||o/2,l=i.polarCenterY||r/2,d=Math.sqrt(a*a+l*l),c=o-a,u=r-l,h=Math.sqrt(c*c+u*u);d=h>d?h:d;let p=r,g=o,f=360/g*Math.PI/180;for(let m=0;m<g;m+=1){let C=Math.sin(m*f),v=Math.cos(m*f);for(let w=0;w<p;w+=1){c=Math.floor(a+d*w/p*v),u=Math.floor(l+d*w/p*C);let y=(u*o+c)*4,S=n[y+0],x=n[y+1],E=n[y+2],T=n[y+3];y=(m+w*o)*4,s[y+0]=S,s[y+1]=x,s[y+2]=E,s[y+3]=T}}},hL=function(e,t,i){let n=e.data,s=t.data,o=e.width,r=e.height,a=i.polarCenterX||o/2,l=i.polarCenterY||r/2,d=Math.sqrt(a*a+l*l),c=o-a,u=r-l,h=Math.sqrt(c*c+u*u);d=h>d?h:d;let p=r,g=o,f=i.polarRotation||0,m,C;for(c=0;c<o;c+=1)for(u=0;u<r;u+=1){let v=c-a,w=u-l,y=Math.sqrt(v*v+w*w)*p/d,S=(Math.atan2(w,v)*180/Math.PI+360+f)%360;S=S*g/360,m=Math.floor(S),C=Math.floor(y);let x=(C*o+m)*4,E=n[x+0],T=n[x+1],L=n[x+2],N=n[x+3];x=(u*o+c)*4,s[x+0]=E,s[x+1]=T,s[x+2]=L,s[x+3]=N}},pL=function(e){let t=e.width,i=e.height,n,s,o,r,a,l,d,c,u,h,p=Math.round(this.kaleidoscopePower()),g=Math.round(this.kaleidoscopeAngle()),f=Math.floor(t*(g%360)/360);if(p<1)return;let m=RE.Util.createCanvasElement();m.width=t,m.height=i;let C=m.getContext("2d").getImageData(0,0,t,i);RE.Util.releaseCanvas(m),uL(e,C,{polarCenterX:t/2,polarCenterY:i/2});let v=t/Math.pow(2,p);for(;v<=8;)v=v*2,p-=1;v=Math.ceil(v);let w=v,y=0,S=w,x=1;for(f+v>t&&(y=w,S=0,x=-1),s=0;s<i;s+=1)for(n=y;n!==S;n+=x)o=Math.round(n+f)%t,u=(t*s+o)*4,a=C.data[u+0],l=C.data[u+1],d=C.data[u+2],c=C.data[u+3],h=(t*s+n)*4,C.data[h+0]=a,C.data[h+1]=l,C.data[h+2]=d,C.data[h+3]=c;for(s=0;s<i;s+=1)for(w=Math.floor(v),r=0;r<p;r+=1){for(n=0;n<w+1;n+=1)u=(t*s+n)*4,a=C.data[u+0],l=C.data[u+1],d=C.data[u+2],c=C.data[u+3],h=(t*s+w*2-n-1)*4,C.data[h+0]=a,C.data[h+1]=l,C.data[h+2]=d,C.data[h+3]=c;w*=2}hL(C,e,{polarRotation:0})};$h.Kaleidoscope=pL;qh.Factory.addGetterSetter(ME.Node,"kaleidoscopePower",2,(0,DE.getNumberValidator)(),qh.Factory.afterSetFilter);qh.Factory.addGetterSetter(ME.Node,"kaleidoscopeAngle",0,(0,DE.getNumberValidator)(),qh.Factory.afterSetFilter)});var FE=oe(Kh=>{"use strict";Object.defineProperty(Kh,"__esModule",{value:!0});Kh.Mask=void 0;var PE=Pe(),gL=pt(),fL=Te();function jh(e,t,i){let n=(i*e.width+t)*4,s=[];return s.push(e.data[n++],e.data[n++],e.data[n++],e.data[n++]),s}function dd(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2))}function mL(e){let t=[0,0,0];for(let i=0;i<e.length;i++)t[0]+=e[i][0],t[1]+=e[i][1],t[2]+=e[i][2];return t[0]/=e.length,t[1]/=e.length,t[2]/=e.length,t}function CL(e,t){let i=jh(e,0,0),n=jh(e,e.width-1,0),s=jh(e,0,e.height-1),o=jh(e,e.width-1,e.height-1),r=t||10;if(dd(i,n)<r&&dd(n,o)<r&&dd(o,s)<r&&dd(s,i)<r){let a=mL([n,i,o,s]),l=[];for(let d=0;d<e.width*e.height;d++){let c=dd(a,[e.data[d*4],e.data[d*4+1],e.data[d*4+2]]);l[d]=c<r?0:255}return l}}function vL(e,t){for(let i=0;i<e.width*e.height;i++)e.data[4*i+3]=t[i]}function wL(e,t,i){let n=[1,1,1,1,0,1,1,1,1],s=Math.round(Math.sqrt(n.length)),o=Math.floor(s/2),r=[];for(let a=0;a<i;a++)for(let l=0;l<t;l++){let d=a*t+l,c=0;for(let u=0;u<s;u++)for(let h=0;h<s;h++){let p=a+u-o,g=l+h-o;if(p>=0&&p<i&&g>=0&&g<t){let f=p*t+g,m=n[u*s+h];c+=e[f]*m}}r[d]=c===2040?255:0}return r}function bL(e,t,i){let n=[1,1,1,1,1,1,1,1,1],s=Math.round(Math.sqrt(n.length)),o=Math.floor(s/2),r=[];for(let a=0;a<i;a++)for(let l=0;l<t;l++){let d=a*t+l,c=0;for(let u=0;u<s;u++)for(let h=0;h<s;h++){let p=a+u-o,g=l+h-o;if(p>=0&&p<i&&g>=0&&g<t){let f=p*t+g,m=n[u*s+h];c+=e[f]*m}}r[d]=c>=1020?255:0}return r}function yL(e,t,i){let n=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],s=Math.round(Math.sqrt(n.length)),o=Math.floor(s/2),r=[];for(let a=0;a<i;a++)for(let l=0;l<t;l++){let d=a*t+l,c=0;for(let u=0;u<s;u++)for(let h=0;h<s;h++){let p=a+u-o,g=l+h-o;if(p>=0&&p<i&&g>=0&&g<t){let f=p*t+g,m=n[u*s+h];c+=e[f]*m}}r[d]=c}return r}var SL=function(e){let t=this.threshold(),i=CL(e,t);return i&&(i=wL(i,e.width,e.height),i=bL(i,e.width,e.height),i=yL(i,e.width,e.height),vL(e,i)),e};Kh.Mask=SL;PE.Factory.addGetterSetter(gL.Node,"threshold",0,(0,fL.getNumberValidator)(),PE.Factory.afterSetFilter)});var AE=oe(Yh=>{"use strict";Object.defineProperty(Yh,"__esModule",{value:!0});Yh.Noise=void 0;var TE=Pe(),xL=pt(),EL=Te(),RL=function(e){let t=this.noise()*255,i=e.data,n=i.length,s=t/2;for(let o=0;o<n;o+=4)i[o+0]+=s-2*s*Math.random(),i[o+1]+=s-2*s*Math.random(),i[o+2]+=s-2*s*Math.random()};Yh.Noise=RL;TE.Factory.addGetterSetter(xL.Node,"noise",.2,(0,EL.getNumberValidator)(),TE.Factory.afterSetFilter)});var _E=oe(Xh=>{"use strict";Object.defineProperty(Xh,"__esModule",{value:!0});Xh.Pixelate=void 0;var IE=Pe(),ML=at(),DL=pt(),kL=Te(),PL=function(e){let t=Math.ceil(this.pixelSize()),i=e.width,n=e.height,s=Math.ceil(i/t),o=Math.ceil(n/t),r=e.data;if(t<=0){ML.Util.error("pixelSize value can not be <= 0");return}for(let a=0;a<s;a+=1)for(let l=0;l<o;l+=1){let d=0,c=0,u=0,h=0,p=a*t,g=p+t,f=l*t,m=f+t,C=0;for(let v=p;v<g;v+=1)if(!(v>=i))for(let w=f;w<m;w+=1){if(w>=n)continue;let y=(i*w+v)*4;d+=r[y+0],c+=r[y+1],u+=r[y+2],h+=r[y+3],C+=1}d=d/C,c=c/C,u=u/C,h=h/C;for(let v=p;v<g;v+=1)if(!(v>=i))for(let w=f;w<m;w+=1){if(w>=n)continue;let y=(i*w+v)*4;r[y+0]=d,r[y+1]=c,r[y+2]=u,r[y+3]=h}}};Xh.Pixelate=PL;IE.Factory.addGetterSetter(DL.Node,"pixelSize",8,(0,kL.getNumberValidator)(),IE.Factory.afterSetFilter)});var OE=oe(Jh=>{"use strict";Object.defineProperty(Jh,"__esModule",{value:!0});Jh.Posterize=void 0;var LE=Pe(),FL=pt(),TL=Te(),AL=function(e){let t=Math.round(this.levels()*254)+1,i=e.data,n=i.length,s=255/t;for(let o=0;o<n;o+=1)i[o]=Math.floor(i[o]/s)*s};Jh.Posterize=AL;LE.Factory.addGetterSetter(FL.Node,"levels",.5,(0,TL.getNumberValidator)(),LE.Factory.afterSetFilter)});var NE=oe(Zh=>{"use strict";Object.defineProperty(Zh,"__esModule",{value:!0});Zh.RGB=void 0;var Qh=Pe(),hC=pt(),IL=Te(),_L=function(e){let t=e.data,i=t.length,n=this.red(),s=this.green(),o=this.blue();for(let r=0;r<i;r+=4){let a=(.34*t[r]+.5*t[r+1]+.16*t[r+2])/255;t[r]=a*n,t[r+1]=a*s,t[r+2]=a*o,t[r+3]=t[r+3]}};Zh.RGB=_L;Qh.Factory.addGetterSetter(hC.Node,"red",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});Qh.Factory.addGetterSetter(hC.Node,"green",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});Qh.Factory.addGetterSetter(hC.Node,"blue",0,IL.RGBComponent,Qh.Factory.afterSetFilter)});var BE=oe(tp=>{"use strict";Object.defineProperty(tp,"__esModule",{value:!0});tp.RGBA=void 0;var cd=Pe(),ep=pt(),LL=Te(),OL=function(e){let t=e.data,i=t.length,n=this.red(),s=this.green(),o=this.blue(),r=this.alpha();for(let a=0;a<i;a+=4){let l=1-r;t[a]=n*r+t[a]*l,t[a+1]=s*r+t[a+1]*l,t[a+2]=o*r+t[a+2]*l}};tp.RGBA=OL;cd.Factory.addGetterSetter(ep.Node,"red",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});cd.Factory.addGetterSetter(ep.Node,"green",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});cd.Factory.addGetterSetter(ep.Node,"blue",0,LL.RGBComponent,cd.Factory.afterSetFilter);cd.Factory.addGetterSetter(ep.Node,"alpha",1,function(e){return this._filterUpToDate=!1,e>1?1:e<0?0:e})});var HE=oe(ip=>{"use strict";Object.defineProperty(ip,"__esModule",{value:!0});ip.Sepia=void 0;var NL=function(e){let t=e.data,i=t.length;for(let n=0;n<i;n+=4){let s=t[n+0],o=t[n+1],r=t[n+2];t[n+0]=Math.min(255,s*.393+o*.769+r*.189),t[n+1]=Math.min(255,s*.349+o*.686+r*.168),t[n+2]=Math.min(255,s*.272+o*.534+r*.131)}};ip.Sepia=NL});var VE=oe(np=>{"use strict";Object.defineProperty(np,"__esModule",{value:!0});np.Solarize=void 0;var BL=function(e){let t=e.data,i=e.width,n=e.height,s=i*4,o=n;do{let r=(o-1)*s,a=i;do{let l=r+(a-1)*4,d=t[l],c=t[l+1],u=t[l+2];d>127&&(d=255-d),c>127&&(c=255-c),u>127&&(u=255-u),t[l]=d,t[l+1]=c,t[l+2]=u}while(--a)}while(--o)};np.Solarize=BL});var zE=oe(sp=>{"use strict";Object.defineProperty(sp,"__esModule",{value:!0});sp.Threshold=void 0;var GE=Pe(),HL=pt(),VL=Te(),GL=function(e){let t=this.threshold()*255,i=e.data,n=i.length;for(let s=0;s<n;s+=1)i[s]=i[s]<t?0:255};sp.Threshold=GL;GE.Factory.addGetterSetter(HL.Node,"threshold",.5,(0,VL.getNumberValidator)(),GE.Factory.afterSetFilter)});var qE=oe(op=>{"use strict";Object.defineProperty(op,"__esModule",{value:!0});op.Konva=void 0;var WE=Cx(),zL=wx(),WL=Rx(),UL=Mx(),qL=kx(),$L=Px(),UE=Ax(),jL=V0(),KL=mh(),YL=Y0(),XL=Lx(),JL=Hx(),QL=X0(),ZL=Gx(),e9=nC(),t9=eE(),i9=aE(),n9=dE(),s9=hE(),o9=gE(),r9=mE(),a9=vE(),l9=bE(),d9=yE(),c9=SE(),u9=xE(),h9=EE(),p9=kE(),g9=FE(),f9=AE(),m9=_E(),C9=OE(),v9=NE(),w9=BE(),b9=HE(),y9=VE(),S9=zE();op.Konva=WE.Konva.Util._assign(WE.Konva,{Arc:zL.Arc,Arrow:WL.Arrow,Circle:UL.Circle,Ellipse:qL.Ellipse,Image:$L.Image,Label:UE.Label,Tag:UE.Tag,Line:jL.Line,Path:KL.Path,Rect:YL.Rect,RegularPolygon:XL.RegularPolygon,Ring:JL.Ring,Sprite:QL.Sprite,Star:ZL.Star,Text:e9.Text,TextPath:t9.TextPath,Transformer:i9.Transformer,Wedge:n9.Wedge,Filters:{Blur:s9.Blur,Brighten:o9.Brighten,Contrast:r9.Contrast,Emboss:a9.Emboss,Enhance:l9.Enhance,Grayscale:d9.Grayscale,HSL:c9.HSL,HSV:u9.HSV,Invert:h9.Invert,Kaleidoscope:p9.Kaleidoscope,Mask:g9.Mask,Noise:f9.Noise,Pixelate:m9.Pixelate,Posterize:C9.Posterize,RGB:v9.RGB,RGBA:w9.RGBA,Sepia:b9.Sepia,Solarize:y9.Solarize,Threshold:S9.Threshold}})});var KE=oe(($E,jE)=>{"use strict";Object.defineProperty($E,"__esModule",{value:!0});var x9=qE();jE.exports=x9.Konva});var sb=(()=>{class e{uploadEndpoint=H("");maxFileSize=H(10*1024*1024);allowedFileTypes=H(["image/*","application/pdf",".doc",".docx"]);maxNumberOfFiles=H(10);note=H("");uploadComplete=de();uploadError=de();filesAdded=de();uppy=null;ngOnInit(){this.initializeUppy()}ngOnDestroy(){this.uppy?.destroy()}initializeUppy(){this.uppy=new Q1({id:"file-uploader",autoProceed:!1,allowMultipleUploadBatches:!0,restrictions:{maxFileSize:this.maxFileSize(),maxNumberOfFiles:this.maxNumberOfFiles(),allowedFileTypes:this.allowedFileTypes()}}).use(eb,{inline:!0,target:"#uppy-dashboard",height:400,width:"100%",theme:"auto",proudlyDisplayPoweredByUppy:!1,hideProgressDetails:!1,hideUploadButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideCancelButton:!1,showRemoveButtonAfterComplete:!0,note:this.note()||"Images up to 10MB, PDFs and documents allowed"}).use(Z1,{quality:.8,limit:10}),this.uploadEndpoint()&&this.uppy.use(tb,{endpoint:this.uploadEndpoint(),retryDelays:[0,1e3,3e3,5e3],chunkSize:5*1024*1024}),this.uppy.on("file-added",()=>{this.filesAdded.emit(this.uppy?.getFiles().length??0)}),this.uppy.on("complete",i=>{let n=[];i.successful&&(n=i.successful.map(s=>({id:s.id,name:s.name,size:s.size,type:s.type??"unknown",url:s.response?.uploadURL}))),this.uploadComplete.emit(n)}),this.uppy.on("error",i=>{this.uploadError.emit(i)}),this.uppy.on("upload-error",(i,n)=>{console.error("Upload error for file:",i?.name,n),this.uploadError.emit(n)})}clearFiles(){this.uppy?.cancelAll()}getFiles(){return this.uppy?.getFiles()??[]}upload(){this.uppy?.upload()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=be({type:e,selectors:[["gh-file-upload"]],inputs:{uploadEndpoint:[1,"uploadEndpoint"],maxFileSize:[1,"maxFileSize"],allowedFileTypes:[1,"allowedFileTypes"],maxNumberOfFiles:[1,"maxNumberOfFiles"],note:[1,"note"]},outputs:{uploadComplete:"uploadComplete",uploadError:"uploadError",filesAdded:"filesAdded"},decls:1,vars:0,consts:[["id","uppy-dashboard"]],template:function(n,s){n&1&&Nw(0,"div",0)},styles:["[_nghost-%COMP%]{display:block;width:100%}#uppy-dashboard[_ngcontent-%COMP%]{border-radius:.5rem;overflow:hidden}[_nghost-%COMP%]     .uppy-Dashboard-inner{background-color:hsl(var(--background));border:1px solid hsl(var(--border));border-radius:.5rem}[_nghost-%COMP%]     .uppy-Dashboard-AddFiles{border-color:hsl(var(--border))}[_nghost-%COMP%]     .uppy-Dashboard-AddFiles-title{color:hsl(var(--foreground))}[_nghost-%COMP%]     .uppy-Dashboard-note{color:hsl(var(--muted-foreground))}[_nghost-%COMP%]     .uppy-DashboardContent-bar{background-color:hsl(var(--muted));border-bottom:1px solid hsl(var(--border))}[_nghost-%COMP%]     .uppy-DashboardContent-title{color:hsl(var(--foreground))}[_nghost-%COMP%]     .uppy-DashboardItem{border-bottom:1px solid hsl(var(--border))}[_nghost-%COMP%]     .uppy-DashboardItem-name{color:hsl(var(--foreground))}[_nghost-%COMP%]     .uppy-DashboardItem-status{color:hsl(var(--muted-foreground))}[_nghost-%COMP%]     .uppy-StatusBar{background-color:hsl(var(--muted));border-top:1px solid hsl(var(--border))}[_nghost-%COMP%]     .uppy-StatusBar-actionBtn--upload{background-color:hsl(var(--primary));color:hsl(var(--primary-foreground))}[_nghost-%COMP%]     .uppy-StatusBar-actionBtn--upload:hover{background-color:hsl(var(--primary) / .9)}[_nghost-%COMP%]     .uppy-StatusBar-progress{background-color:hsl(var(--primary))}@media (prefers-color-scheme: dark){[_nghost-%COMP%]     .uppy-Dashboard-AddFiles{background-color:hsl(var(--background))}[_nghost-%COMP%]     .uppy-Dashboard-dropFilesHereHint{color:hsl(var(--muted-foreground))}}"],changeDetection:0})}return e})();var sk=["*"],nl=(()=>{class e extends tl{side=H("top");sideState=Gw(()=>this.side());constructor(){super(),qe(()=>{let i=this.sideState();yo(()=>{i==="top"&&this.mutablePositionStrategy.set(this.positionBuilder.global().top()),i==="bottom"&&this.mutablePositionStrategy.set(this.positionBuilder.global().bottom()),i==="left"&&this.mutablePositionStrategy.set(this.positionBuilder.global().left()),i==="right"&&this.mutablePositionStrategy.set(this.positionBuilder.global().right())})})}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=be({type:e,selectors:[["brn-sheet"]],inputs:{side:[1,"side"]},exportAs:["brnSheet"],features:[Ie([{provide:tl,useExisting:Wn(()=>e)}]),vo],ngContentSelectors:sk,decls:1,vars:0,template:function(n,s){n&1&&(_t(),Qe(0))},encapsulation:2,changeDetection:0})}return e})(),ob=(()=>{class e extends W1{static \u0275fac=(()=>{let i;return function(s){return(i||(i=Ts(e)))(s||e)}})();static \u0275dir=ce({type:e,selectors:[["button","brnSheetClose",""]],features:[vo]})}return e})(),rb=(()=>{class e extends U1{side=z(nl).sideState;static \u0275fac=(()=>{let i;return function(s){return(i||(i=Ts(e)))(s||e)}})();static \u0275dir=ce({type:e,selectors:[["","brnSheetContent",""]],features:[Ie([hc(()=>e),cc(()=>e)]),vo]})}return e})();var ab=(()=>{class e extends q1{static \u0275fac=(()=>{let i;return function(s){return(i||(i=Ts(e)))(s||e)}})();static \u0275cmp=be({type:e,selectors:[["brn-sheet-overlay"]],features:[Ie([V1(()=>e)]),vo],decls:0,vars:0,template:function(n,s){},encapsulation:2,changeDetection:0})}return e})();var Dg=(()=>{class e{_classSettable=H1({optional:!0,host:!0});userClass=H("",{alias:"class"});_computedClass=W(()=>te("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 bg-black/50",this.userClass()));constructor(){qe(()=>{let i=this._computedClass();yo(()=>this._classSettable?.setClassToCustomElement(i))})}static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["","hlmSheetOverlay",""],["brn-sheet-overlay","hlm",""]],hostVars:2,hostBindings:function(n,s){n&2&&ye(s._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var ok=["*"],kg=(()=>{class e extends nl{static \u0275fac=(()=>{let i;return function(s){return(i||(i=Ts(e)))(s||e)}})();static \u0275cmp=be({type:e,selectors:[["hlm-sheet"]],exportAs:["hlmSheet"],features:[Ie([{provide:tl,useExisting:Wn(()=>nl)},{provide:nl,useExisting:Wn(()=>e)},z1({})]),vo],ngContentSelectors:ok,decls:2,vars:0,consts:[["hlm",""]],template:function(n,s){n&1&&(_t(),ee(0,"brn-sheet-overlay",0),Qe(1))},dependencies:[ab,Dg],encapsulation:2,changeDetection:0})}return e})();var Pg=(()=>{class e{userClass=H("",{alias:"class"});_computedClass=W(()=>te("ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["","hlmSheetClose",""],["","brnSheetClose","","hlm",""]],hostVars:2,hostBindings:function(n,s){n&2&&ye(s._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var rk=["*"],ak=Rr("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b",bottom:"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",left:"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",right:"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm"}},defaultVariants:{side:"right"}}),Fg=(()=>{class e{_stateProvider=uc({host:!0});_sideProvider=dc({host:!0});state=this._stateProvider.state??Se("closed");_renderer=z(mr);_element=z(yt);constructor(){qe(()=>{this._renderer.setAttribute(this._element.nativeElement,"data-state",this.state())})}userClass=H("",{alias:"class"});_computedClass=W(()=>te(ak({side:this._sideProvider.side()}),this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275cmp=be({type:e,selectors:[["hlm-sheet-content"]],hostVars:3,hostBindings:function(n,s){n&2&&(St("data-state",s.state()),ye(s._computedClass()))},inputs:{userClass:[1,"class","userClass"]},features:[Ie([Lt({lucideX:k1})])],ngContentSelectors:rk,decls:5,vars:0,consts:[["brnSheetClose","","hlm",""],[1,"sr-only"],["hlm","","size","sm","name","lucideX"]],template:function(n,s){n&1&&(_t(),Qe(0),M(1,"button",0)(2,"span",1),_(3,"Close"),R(),ee(4,"ng-icon",2),R())},dependencies:[Pg,ob,xt,it],encapsulation:2,changeDetection:0})}return e})();var lk={sidebarWidth:"16rem",sidebarWidthMobile:"18rem",sidebarWidthIcon:"3rem",sidebarCookieName:"sidebar_state",sidebarCookieMaxAge:3600*24*7,sidebarKeyboardShortcut:"b",mobileBreakpoint:"768px"},dk=new dn("HlmSidebarConfig");function _r(){return z(dk,{optional:!0})??lk}var Eo=(()=>{class e{_config=_r();_document=z(Xd);_window=this._document.defaultView;_open=Se(!0);_openMobile=Se(!1);_isMobile=Se(!1);_variant=Se("sidebar");_mediaQuery=null;open=this._open.asReadonly();openMobile=this._openMobile.asReadonly();isMobile=this._isMobile.asReadonly();variant=this._variant.asReadonly();state=W(()=>this._open()?"expanded":"collapsed");constructor(){let i=z(Ka);vr(()=>{if(!this._window)return;let n=this._document.cookie.split("; ").find(l=>l.startsWith(`${this._config.sidebarCookieName}=`));if(n){let l=n.split("=")[1];this._open.set(l==="true")}this._mediaQuery=this._window.matchMedia(`(max-width: ${this._config.mobileBreakpoint})`),this._isMobile.set(this._mediaQuery.matches);let s=l=>{this._isMobile.set(l.matches),l.matches||this._openMobile.set(!1)};this._mediaQuery.addEventListener("change",s);let o=l=>{l.key===this._config.sidebarKeyboardShortcut&&(l.ctrlKey||l.metaKey)&&(l.preventDefault(),this.toggleSidebar())};this._window.addEventListener("keydown",o);let r,a=()=>{this._window&&(r&&this._window.clearTimeout(r),r=this._window.setTimeout(()=>{this._mediaQuery&&this._isMobile.set(this._mediaQuery.matches)},100))};this._window.addEventListener("resize",a),i.onDestroy(()=>{this._window&&(this._mediaQuery&&this._mediaQuery.removeEventListener("change",s),this._window.removeEventListener("keydown",o),this._window.removeEventListener("resize",a),r&&this._window.clearTimeout(r))})})}setOpen(i){this._open.set(i),this._document.cookie=`${this._config.sidebarCookieName}=${i}; path=/; max-age=${this._config.sidebarCookieMaxAge}`}setOpenMobile(i){this._isMobile()&&this._openMobile.set(i)}setVariant(i){this._variant.set(i)}toggleSidebar(){this._isMobile()?this._openMobile.update(i=>!i):this.setOpen(!this._open())}static \u0275fac=function(n){return new(n||e)};static \u0275prov=ja({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var ck=["*"];function uk(e,t){e&1&&Qe(0)}function hk(e,t){e&1&&Ji(0)}function pk(e,t){if(e&1&&(M(0,"div",4),Xi(1,hk,1,0,"ng-container",5),R()),e&2){let i=Z(),n=hn(1);ye(i._nonCollapsibleComputedClass()),P(),Ce("ngTemplateOutlet",n)}}function gk(e,t){e&1&&Ji(0)}function fk(e,t){if(e&1&&(M(0,"hlm-sheet-content",8)(1,"div",9),Xi(2,gk,1,0,"ng-container",5),R()()),e&2){let i=Z(2),n=hn(1);pn("--sidebar-width",i.sidebarWidthMobile()),P(2),Ce("ngTemplateOutlet",n)}}function mk(e,t){if(e&1){let i=rt();M(0,"hlm-sheet",6),Q("stateChanged",function(s){he(i);let o=Z();return pe(o._sidebarService.setOpenMobile(s==="open"))}),Xi(1,fk,3,3,"hlm-sheet-content",7),R()}if(e&2){let i=Z();Ce("side",i.side())("state",i._sidebarService.openMobile()?"open":"closed")}}function Ck(e,t){e&1&&Ji(0)}function vk(e,t){if(e&1&&(M(0,"div",3),ee(1,"div",10),M(2,"div",11)(3,"div",12),Xi(4,Ck,1,0,"ng-container",5),R()()()),e&2){let i=Z(),n=hn(1);St("data-state",i._sidebarService.state())("data-collapsible",i._sidebarService.state()==="collapsed"?i.collapsible():"")("data-variant",i.variant())("data-side",i.side()),P(),ye(i._sidebarGapComputedClass()),P(),ye(i._sidebarContainerComputedClass()),P(2),Ce("ngTemplateOutlet",n)}}var Tg=(()=>{class e{_sidebarService=z(Eo);_config=_r();sidebarWidthMobile=H(this._config.sidebarWidthMobile);side=H("left");variant=H(this._sidebarService.variant());collapsible=H("offcanvas");nonCollapsibleClass=H("");_nonCollapsibleComputedClass=W(()=>te("bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col",this.nonCollapsibleClass()));_sidebarGapComputedClass=W(()=>te("relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",this.variant()==="floating"||this.variant()==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]"));sidebarContainerClass=H("");_sidebarContainerComputedClass=W(()=>te("fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex",this.side()==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",this.variant()==="floating"||this.variant()==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l",this.sidebarContainerClass()));constructor(){qe(()=>{this._sidebarService.setVariant(this.variant())})}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=be({type:e,selectors:[["hlm-sidebar"]],inputs:{sidebarWidthMobile:[1,"sidebarWidthMobile"],side:[1,"side"],variant:[1,"variant"],collapsible:[1,"collapsible"],nonCollapsibleClass:[1,"nonCollapsibleClass"],sidebarContainerClass:[1,"sidebarContainerClass"]},ngContentSelectors:ck,decls:5,vars:1,consts:[["contentContainer",""],["data-slot","sidebar",3,"class"],[3,"side","state"],["data-slot","sidebar",1,"text-sidebar-foreground","group","peer","hidden","md:block"],["data-slot","sidebar"],[4,"ngTemplateOutlet"],[3,"stateChanged","side","state"],["data-slot","sidebar","data-sidebar","sidebar","data-mobile","true","class","bg-sidebar text-sidebar-foreground h-screen w-[var(--sidebar-width)] p-0 [&>button]:hidden",3,"--sidebar-width",4,"brnSheetContent"],["data-slot","sidebar","data-sidebar","sidebar","data-mobile","true",1,"bg-sidebar","text-sidebar-foreground","h-screen","w-[var(--sidebar-width)]","p-0","[&>button]:hidden"],[1,"flex","h-full","w-full","flex-col"],["data-slot","sidebar-gap"],["data-slot","sidebar-container"],["data-sidebar","sidebar","data-slot","sidebar-inner",1,"bg-sidebar","group-data-[variant=floating]:border-sidebar-border","flex","h-full","w-full","flex-col","group-data-[variant=floating]:rounded-lg","group-data-[variant=floating]:border","group-data-[variant=floating]:shadow"]],template:function(n,s){n&1&&(_t(),Xi(0,uk,1,0,"ng-template",null,0,bo),ze(2,pk,2,3,"div",1)(3,mk,2,2,"hlm-sheet",2)(4,vk,5,9,"div",3)),n&2&&(P(2),We(s.collapsible()==="none"?2:s._sidebarService.isMobile()?3:4))},dependencies:[kg,Fg,xo,rb],encapsulation:2,changeDetection:0})}return e})();var Ag=(()=>{class e{userClass=H("",{alias:"class"});_computedClass=W(()=>te("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["","hlmSidebarContent",""],["hlm-sidebar-content"]],hostAttrs:["data-slot","sidebar-content","data-sidebar","content"],hostVars:2,hostBindings:function(n,s){n&2&&ye(s._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var Ig=(()=>{class e{userClass=H("",{alias:"class"});_computedClass=W(()=>te("flex flex-col gap-2 p-2",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["","hlmSidebarFooter",""],["hlm-sidebar-footer"]],hostAttrs:["data-slot","sidebar-footer","data-sidebar","footer"],hostVars:2,hostBindings:function(n,s){n&2&&ye(s._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var _g=(()=>{class e{userClass=H("",{alias:"class"});_computedClass=W(()=>te("relative flex w-full min-w-0 flex-col p-2",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["","hlmSidebarGroup",""],["hlm-sidebar-group"]],hostAttrs:["data-slot","sidebar-group","data-sidebar","group"],hostVars:2,hostBindings:function(n,s){n&2&&ye(s._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var Lg=(()=>{class e{userClass=H("",{alias:"class"});_computedClass=W(()=>te("w-full text-sm",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["div","hlmSidebarGroupContent",""]],hostAttrs:["data-slot","sidebar-group-content","data-sidebar","group-content"],hostVars:2,hostBindings:function(n,s){n&2&&ye(s._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var Og=(()=>{class e{userClass=H("",{alias:"class"});_computedClass=W(()=>te("text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium transition-[margin,opa] duration-200 ease-linear outline-none focus-visible:ring-2 [&>_ng-icon]:size-4 [&>_ng-icon]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["div","hlmSidebarGroupLabel",""],["button","hlmSidebarGroupLabel",""]],hostAttrs:["data-slot","sidebar-group-label","data-sidebar","group-label"],hostVars:2,hostBindings:function(n,s){n&2&&ye(s._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var Ng=(()=>{class e{userClass=H("",{alias:"class"});_computedClass=W(()=>te("flex flex-col gap-2 p-2",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["","hlmSidebarHeader",""],["hlm-sidebar-header"]],hostAttrs:["data-slot","sidebar-header","data-sidebar","header"],hostVars:2,hostBindings:function(n,s){n&2&&ye(s._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var Bg=(()=>{class e{userClass=H("",{alias:"class"});_computedClass=W(()=>te("bg-background relative flex w-full flex-1 flex-col","md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["main","hlmSidebarInset",""]],hostAttrs:["data-slot","sidebar-inset"],hostVars:2,hostBindings:function(n,s){n&2&&ye(s._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var Hg=(()=>{class e{userClass=H("",{alias:"class"});_computedClass=W(()=>te("flex w-full min-w-0 flex-col gap-1",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["ul","hlmSidebarMenu",""]],hostAttrs:["data-slot","sidebar-menu","data-sidebar","menu"],hostVars:2,hostBindings:function(n,s){n&2&&ye(s._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var wk=["tooltip"];function bk(e,t){if(e&1&&_(0),e&2){let i=Z();xe(" ",i.content," ")}}function yk(e,t){if(e&1&&Ji(0,2),e&2){let i=Z();Ce("ngTemplateOutlet",i.content)}}var Sk=(()=>{class e{tooltipTemplate=Se(null);static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["","brnTooltip",""]]})}return e})(),xk=(()=>{class e{_cdr=z(xr);_isBrowser=tc(z(Jd));_renderer2=z(mr);_contentHovered=Se(!1);tooltipClasses=Se("");side=Se("above");content=null;_showTimeoutId;_hideTimeoutId;_animateTimeoutId;triggerElement;mouseLeaveHideDelay=0;exitAnimationDuration=0;tooltip=Ja("tooltip",{read:yt});_closeOnInteraction=!1;_isVisible=!1;_onHide=new Co;afterHidden=this._onHide.asObservable();show(i){this._hideTimeoutId!==null&&clearTimeout(this._hideTimeoutId),this._animateTimeoutId!==null&&clearTimeout(this._animateTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleDataAttributes(!0,this.side()),this._toggleVisibility(!0),this._showTimeoutId=void 0},i)}hide(i,n){this._showTimeoutId!==null&&clearTimeout(this._showTimeoutId),this._animateTimeoutId=setTimeout(()=>{this._animateTimeoutId=void 0,!this._contentHovered()&&this._toggleDataAttributes(!1,this.side())},Math.max(i,0)),this._hideTimeoutId=setTimeout(()=>{this._hideTimeoutId=void 0,!this._contentHovered()&&this._toggleVisibility(!1)},i+n)}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this.triggerElement=void 0}_isTypeOfString(i){return typeof i=="string"}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0,0)}_markForCheck(){this._cdr.markForCheck()}_handleMouseLeave({relatedTarget:i}){(!i||!this.triggerElement?.contains(i))&&(this.isVisible()?this.hide(this.mouseLeaveHideDelay,this.exitAnimationDuration):this._finalize(!1)),this._contentHovered.set(!1)}_cancelPendingAnimations(){this._showTimeoutId!==null&&clearTimeout(this._showTimeoutId),this._hideTimeoutId!==null&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalize(i){i?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(i){let n=this.tooltip()?.nativeElement;!n||!this._isBrowser||(this._renderer2.setStyle(n,"visibility",i?"visible":"hidden"),i?this._renderer2.removeStyle(n,"display"):this._renderer2.setStyle(n,"display","none"),this._isVisible=i)}_toggleDataAttributes(i,n){let s=this.tooltip()?.nativeElement;!s||!this._isBrowser||(this._renderer2.setAttribute(s,"data-side",n),this._renderer2.setAttribute(s,"data-state",i?"open":"closed"))}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=be({type:e,selectors:[["brn-tooltip-content"]],viewQuery:function(n,s){n&1&&Xa(s.tooltip,wk,5,yt),n&2&&Ei()},hostAttrs:["aria-hidden","true"],hostVars:2,hostBindings:function(n,s){n&1&&Q("mouseleave",function(r){return s._handleMouseLeave(r)}),n&2&&pn("zoom",s.isVisible()?1:null)},decls:4,vars:5,consts:[["tooltip",""],[3,"mouseenter","mouseleave"],[3,"ngTemplateOutlet"]],template:function(n,s){if(n&1){let o=rt();M(0,"div",1,0),Q("mouseenter",function(){return he(o),pe(s._contentHovered.set(!0))})("mouseleave",function(){return he(o),pe(s._contentHovered.set(!1))}),ze(2,bk,1,1)(3,yk,1,1,"ng-container",2),R()}n&2&&(ye(s.tooltipClasses()),pn("visibility","hidden"),P(2),We(s._isTypeOfString(s.content)?2:3))},dependencies:[xo],encapsulation:2,changeDetection:0})}return e})();var Vg={showDelay:0,hideDelay:0,exitAnimationDuration:0,touchendHideDelay:1500},cb=new dn("brn-tooltip-default-options",{providedIn:"root",factory:()=>Vg});function ub(e){return{provide:cb,useValue:b(b({},Vg),e)}}function Ek(){return z(cb,{optional:!0})??Vg}var Rk=20;function lb(e){return Error(`Tooltip position "${e}" is invalid.`)}var hb=new dn("brn-tooltip-scroll-strategy"),Mk={provide:hb,deps:[Rg],useFactory:e=>()=>e.scrollStrategies.reposition({scrollThrottle:Rk})},Dk="tooltip-panel",db=O1({passive:!0}),kk=500,Pk=8,Fk=8,pb=(()=>{class e{_tooltipDirective=z(Sk,{optional:!0});_tooltipComponent=xk;_cssClassPrefix="brn";_destroyed=new Co;_passiveListeners=[];_defaultOptions=Ek();_overlay=z(Rg);_elementRef=z(yt);_scrollDispatcher=z(T1);_viewContainerRef=z(Cr);_ngZone=z(wo);_platform=z(P1);_ariaDescriber=z(ib);_focusMonitor=z(N1);_dir=z(F1);_scrollStrategy=z(hb);_document=z(Xd);_portal;_viewInitialized=!1;_pointerExitEventsInitialized=!1;_viewportMargin=8;_currentPosition;_touchstartTimeout;_overlayRef=null;_tooltipInstance=null;position=H(this._defaultOptions?.position??"above");positionAtOrigin=H(this._defaultOptions?.positionAtOrigin??!1,{transform:D});brnTooltipDisabled=H(!1,{transform:D});showDelay=H(this._defaultOptions?.showDelay??0,{transform:Er});hideDelay=H(this._defaultOptions?.hideDelay??0,{transform:Er});exitAnimationDuration=H(this._defaultOptions?.exitAnimationDuration??0,{transform:Er});tooltipContentClasses=H(this._defaultOptions?.tooltipContentClasses??"",{alias:"tooltipContentClasses"});computedTooltipContentClasses=W(()=>Se(this.tooltipContentClasses()));touchGestures=H(this._defaultOptions?.touchGestures??"auto");ariaDescribedBy=H("",{alias:"aria-describedby"});computedAriaDescribedBy=W(()=>Se(this.ariaDescribedBy()));ariaDescribedByPrevious=B1(this.computedAriaDescribedBy);brnTooltipTrigger=H(null);brnTooltipTriggerState=W(()=>this._tooltipDirective?this._tooltipDirective.tooltipTemplate():this.brnTooltipTrigger());constructor(){this._dir.change.pipe(fi(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)}),this._viewportMargin=Pk,this._initBrnTooltipTriggerEffect(),this._initAriaDescribedByPreviousEffect(),this._initTooltipContentClassesEffect(),this._initPositionEffect(),this._initPositionAtOriginEffect(),this._initBrnTooltipDisabledEffect(),this._initExitAnimationDurationEffect(),this._initHideDelayEffect()}setTooltipContentClasses(i){this.computedTooltipContentClasses().set(i)}setAriaDescribedBy(i){this.computedAriaDescribedBy().set(i)}_initPositionEffect(){qe(()=>{this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition())})}_initBrnTooltipDisabledEffect(){qe(()=>{this.brnTooltipDisabled()?this.hide(0):this._setupPointerEnterEventsIfNeeded()})}_initPositionAtOriginEffect(){qe(()=>{let i=this.positionAtOrigin();this._detach(),this._overlayRef=null})}_initTooltipContentClassesEffect(){qe(()=>{this._tooltipInstance&&this._tooltipInstance.tooltipClasses.set(this.computedTooltipContentClasses()()??"")})}_initAriaDescribedByPreviousEffect(){qe(()=>{let i=this.computedAriaDescribedBy()();this._ariaDescriber.removeDescription(this._elementRef.nativeElement,yo(()=>this.ariaDescribedByPrevious()()),"tooltip"),i&&!this._isTooltipVisible()&&this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriber.describe(this._elementRef.nativeElement,i,"tooltip")})})})}_initBrnTooltipTriggerEffect(){qe(()=>{let i=this.brnTooltipTriggerState(),n=this._isTooltipVisible();yo(()=>{!i&&n?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipContent())})})}_initExitAnimationDurationEffect(){qe(()=>{this._tooltipInstance&&(this._tooltipInstance.exitAnimationDuration=this.exitAnimationDuration())})}_initHideDelayEffect(){qe(()=>{this._tooltipInstance&&(this._tooltipInstance.mouseLeaveHideDelay=this.hideDelay())})}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(fi(this._destroyed)).subscribe(i=>{i?i==="keyboard"&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))}),G1&&!this.computedAriaDescribedBy()&&console.warn('BrnTooltip: "aria-describedby" attribute is required for accessibility')}ngOnDestroy(){let i=this._elementRef.nativeElement;clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([n,s])=>i.removeEventListener(n,s,db)),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(i,this.computedAriaDescribedBy()(),"tooltip"),this._focusMonitor.stopMonitoring(i)}show(i=this.showDelay(),n){if(this.brnTooltipDisabled()||this._isTooltipVisible()){this._tooltipInstance?._cancelPendingAnimations();return}let s=this._createOverlay(n);this._detach(),this._portal=this._portal||new A1(this._tooltipComponent,this._viewContainerRef);let o=this._tooltipInstance=s.attach(this._portal).instance;o.triggerElement=this._elementRef.nativeElement,o.mouseLeaveHideDelay=this.hideDelay(),o.tooltipClasses.set(this.computedTooltipContentClasses()()),o.exitAnimationDuration=this.exitAnimationDuration(),o.side.set(this._currentPosition??"above"),o.afterHidden.pipe(fi(this._destroyed)).subscribe(()=>this._detach()),this._updateTooltipContent(),o.show(i)}hide(i=this.hideDelay(),n=this.exitAnimationDuration()){let s=this._tooltipInstance;s&&(s.isVisible()?s.hide(i,n):(s._cancelPendingAnimations(),this._detach()))}toggle(i){this._isTooltipVisible()?this.hide():this.show(void 0,i)}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(i){if(this._overlayRef){let o=this._overlayRef.getConfig().positionStrategy;if((!this.positionAtOrigin()||!i)&&o._origin instanceof yt)return this._overlayRef;this._detach()}let n=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),s=this._overlay.position().flexibleConnectedTo(this.positionAtOrigin()?i||this._elementRef:this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(n);return s.positionChanges.pipe(fi(this._destroyed)).subscribe(o=>{this._updateCurrentPositionClass(o.connectionPair),this._tooltipInstance&&o.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:s,panelClass:`${this._cssClassPrefix}-${Dk}`,scrollStrategy:this._scrollStrategy()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(fi(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(fi(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(fi(this._destroyed)).subscribe(o=>{this._isTooltipVisible()&&o.key==="Escape"&&!I1(o)&&(o.preventDefault(),o.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._overlayRef}_detach(){this._overlayRef?.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(i){let n=i.getConfig().positionStrategy,s=this._getOrigin(),o=this._getOverlayPosition();n.withPositions([this._addOffset(b(b({},s.main),o.main)),this._addOffset(b(b({},s.fallback),o.fallback))])}_addOffset(i){let n=Fk,s=!this._dir||this._dir.value==="ltr";return i.originY==="top"?i.offsetY=-n:i.originY==="bottom"?i.offsetY=n:i.originX==="start"?i.offsetX=s?-n:n:i.originX==="end"&&(i.offsetX=s?n:-n),i}_getOrigin(){let i=!this._dir||this._dir.value==="ltr",n=this.position(),s;if(n==="above"||n==="below")s={originX:"center",originY:n==="above"?"top":"bottom"};else if(n==="before"||n==="left"&&i||n==="right"&&!i)s={originX:"start",originY:"center"};else if(n==="after"||n==="right"&&i||n==="left"&&!i)s={originX:"end",originY:"center"};else if(typeof Za()>"u"||Za())throw lb(n);let{x:o,y:r}=this._invertPosition(s.originX,s.originY);return{main:s,fallback:{originX:o,originY:r}}}_getOverlayPosition(){let i=!this._dir||this._dir.value==="ltr",n=this.position(),s;if(n==="above")s={overlayX:"center",overlayY:"bottom"};else if(n==="below")s={overlayX:"center",overlayY:"top"};else if(n==="before"||n==="left"&&i||n==="right"&&!i)s={overlayX:"end",overlayY:"center"};else if(n==="after"||n==="right"&&i||n==="left"&&!i)s={overlayX:"start",overlayY:"center"};else if(typeof Za()>"u"||Za())throw lb(n);let{x:o,y:r}=this._invertPosition(s.overlayX,s.overlayY);return{main:s,fallback:{overlayX:o,overlayY:r}}}_updateTooltipContent(){this._tooltipInstance&&(this._tooltipInstance.content=this.brnTooltipTriggerState(),this._tooltipInstance._markForCheck(),this._ngZone.onMicrotaskEmpty.pipe(Aw(1),fi(this._destroyed)).subscribe(()=>{this._tooltipInstance&&this._overlayRef?.updatePosition()}))}_invertPosition(i,n){return this.position()==="above"||this.position()==="below"?n==="top"?n="bottom":n==="bottom"&&(n="top"):i==="end"?i="start":i==="start"&&(i="end"),{x:i,y:n}}_updateCurrentPositionClass(i){let{overlayY:n,originX:s,originY:o}=i,r;n==="center"?this._dir&&this._dir.value==="rtl"?r=s==="end"?"left":"right":r=s==="start"?"left":"right":r=n==="bottom"&&o==="top"?"above":"below",r!==this._currentPosition&&(this._tooltipInstance?.side.set(r),this._currentPosition=r)}_setupPointerEnterEventsIfNeeded(){this.brnTooltipDisabled()||!this.brnTooltipTriggerState()||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",i=>{this._setupPointerExitEventsIfNeeded();let n;i.x!==void 0&&i.y!==void 0&&(n=i),this.show(void 0,n)}]):this.touchGestures()!=="off"&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",i=>{let n=i.targetTouches?.[0],s=n?{x:n.clientX,y:n.clientY}:void 0;this._setupPointerExitEventsIfNeeded(),clearTimeout(this._touchstartTimeout),this._touchstartTimeout=setTimeout(()=>this.show(void 0,s),kk)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;let i=[];if(this._platformSupportsMouseEvents())i.push(["mouseleave",n=>{let s=n.relatedTarget;(!s||!this._overlayRef?.overlayElement.contains(s))&&this.hide()}],["wheel",n=>this._wheelListener(n)]);else if(this.touchGestures()!=="off"){this._disableNativeGesturesIfNecessary();let n=()=>{clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions?.touchendHideDelay)};i.push(["touchend",n],["touchcancel",n])}this._addListeners(i),this._passiveListeners.push(...i)}_addListeners(i){i.forEach(([n,s])=>{this._elementRef.nativeElement.addEventListener(n,s,db)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(i){if(this._isTooltipVisible()){let n=this._document.elementFromPoint(i.clientX,i.clientY),s=this._elementRef.nativeElement;n!==s&&!s.contains(n)&&this.hide()}}_disableNativeGesturesIfNecessary(){let i=this.touchGestures();if(i!=="off"){let n=this._elementRef.nativeElement,s=n.style;(i==="on"||n.nodeName!=="INPUT"&&n.nodeName!=="TEXTAREA")&&(s.userSelect=s.msUserSelect=s.webkitUserSelect=s.MozUserSelect="none"),(i==="on"||!n.draggable)&&(s.webkitUserDrag="none"),s.touchAction="none",s.webkitTapHighlightColor="transparent"}}static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["","brnTooltipTrigger",""]],hostAttrs:[1,"brn-tooltip-trigger"],hostVars:2,hostBindings:function(n,s){n&2&&Vt("brn-tooltip-disabled",s.brnTooltipDisabled())},inputs:{position:[1,"position"],positionAtOrigin:[1,"positionAtOrigin"],brnTooltipDisabled:[1,"brnTooltipDisabled"],showDelay:[1,"showDelay"],hideDelay:[1,"hideDelay"],exitAnimationDuration:[1,"exitAnimationDuration"],tooltipContentClasses:[1,"tooltipContentClasses"],touchGestures:[1,"touchGestures"],ariaDescribedBy:[1,"aria-describedby","ariaDescribedBy"],brnTooltipTrigger:[1,"brnTooltipTrigger"]},exportAs:["brnTooltipTrigger"],features:[Ie([Mk])]})}return e})();var gb="bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 z-50 w-fit rounded-md px-3 py-1.5 text-xs text-balance data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=below]:slide-in-from-top-2 data-[side=above]:slide-in-from-bottom-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 ";var Ak=Rr("peer/menu-button ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground flex w-full items-center justify-start gap-2 overflow-hidden rounded-md p-2 text-left text-sm transition-[width,height,padding] outline-none group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 hover:cursor-pointer focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 disabled:hover:cursor-default aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium [&>_ng-icon]:size-4 [&>_ng-icon]:shrink-0 group-data-[collapsible=icon]:[&>span]:hidden [&>span:last-child]:truncate",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-sidebar-border hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-sidebar-accent"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),Gg=(()=>{class e{_sidebarService=z(Eo);variant=H("default");size=H("default");isActive=H(!1,{transform:D});userClass=H("",{alias:"class"});_isTooltipHidden=W(()=>this._sidebarService.state()!=="collapsed"||this._sidebarService.isMobile());_computedClass=W(()=>te(Ak({variant:this.variant(),size:this.size()}),this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["button","hlmSidebarMenuButton",""],["a","hlmSidebarMenuButton",""]],hostAttrs:["data-slot","sidebar-menu-button","data-sidebar","menu-button"],hostVars:4,hostBindings:function(n,s){n&2&&(St("data-size",s.size())("data-active",s.isActive()),ye(s._computedClass()))},inputs:{variant:[1,"variant"],size:[1,"size"],isActive:[1,"isActive"],userClass:[1,"class","userClass"]},features:[Ie([ub({showDelay:150,hideDelay:0,exitAnimationDuration:150,tooltipContentClasses:gb,position:"left"})]),Un([{directive:pb,inputs:["brnTooltipTrigger","tooltip","aria-describedby","aria-describedby"]}])]})}return e})();var zg=(()=>{class e{userClass=H("",{alias:"class"});_computedClass=W(()=>te("group/menu-item relative",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["li","hlmSidebarMenuItem",""]],hostAttrs:["data-slot","sidebar-menu-item","data-sidebar","menu-item"],hostVars:2,hostBindings:function(n,s){n&2&&ye(s._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var Lk={orientation:"horizontal"},Ok=new dn("BrnSeparatorConfig");function Nk(){return z(Ok,{optional:!0})??Lk}var fb=(()=>{class e{_config=Nk();orientation=H(this._config.orientation);decorative=H(!0,{transform:D});_role=W(()=>this.decorative()?"none":"separator");_ariaOrientation=W(()=>this.decorative()?void 0:this.orientation()==="vertical"?"vertical":void 0);static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["","brnSeparator",""],["brn-separator"]],hostVars:3,hostBindings:function(n,s){n&2&&(qn("role",s._role()),St("aria-orientation",s._ariaOrientation())("data-orientation",s.orientation()))},inputs:{orientation:[1,"orientation"],decorative:[1,"decorative"]}})}return e})();var Hk="bg-border inline-flex shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",gc=(()=>{class e{userClass=H("",{alias:"class"});_computedClass=W(()=>te(Hk,this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["","hlmSeparator",""],["hlm-separator"]],hostVars:2,hostBindings:function(n,s){n&2&&ye(s._computedClass())},inputs:{userClass:[1,"class","userClass"]},features:[Un([{directive:fb,inputs:["orientation","orientation","decorative","decorative"]}])]})}return e})();var Vk=["hlmSidebarTrigger",""],Wg=(()=>{class e{_hlmBtn=z(Jt);_sidebarService=z(Eo);constructor(){this._hlmBtn.setClass("size-7")}_onClick(){this._sidebarService.toggleSidebar()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=be({type:e,selectors:[["button","hlmSidebarTrigger",""]],hostAttrs:["data-slot","sidebar-trigger","data-sidebar","trigger"],hostBindings:function(n,s){n&1&&Q("click",function(){return s._onClick()})},features:[Ie([Lt({lucidePanelLeft:v1}),Kw({variant:"ghost",size:"icon"})]),Un([Jt])],attrs:Vk,decls:1,vars:0,consts:[["hlm","","name","lucidePanelLeft","size","sm"]],template:function(n,s){n&1&&ee(0,"ng-icon",0)},dependencies:[it,xt],encapsulation:2,changeDetection:0})}return e})();var Ug=(()=>{class e{_config=_r();userClass=H("",{alias:"class"});_computedClass=W(()=>te("group/sidebar-wrapper has-[[data-variant=inset]]:bg-sidebar flex min-h-svh w-full",this.userClass()));sidebarWidth=H(this._config.sidebarWidth);sidebarWidthIcon=H(this._config.sidebarWidthIcon);static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["","hlmSidebarWrapper",""],["hlm-sidebar-wrapper"]],hostAttrs:["data-slot","sidebar-wrapper"],hostVars:6,hostBindings:function(n,s){n&2&&(ye(s._computedClass()),pn("--sidebar-width",s.sidebarWidth())("--sidebar-width-icon",s.sidebarWidthIcon()))},inputs:{userClass:[1,"class","userClass"],sidebarWidth:[1,"sidebarWidth"],sidebarWidthIcon:[1,"sidebarWidthIcon"]}})}return e})();var zk=(e,t)=>t.path;function Wk(e,t){if(e&1&&(M(0,"li",5)(1,"a",17),ee(2,"ng-icon",18),M(3,"span"),_(4),Y(5,"transloco"),R()()()),e&2){let i=t.$implicit;P(),Ce("routerLink",i.path),P(),Ce("name",i.icon),P(2),Ee(X(5,3,i.label))}}var Cb=(()=>{class e{navigationItems=[{path:"dashboard",label:"homeDocumentation.nav.dashboard",icon:"lucideHouse"},{path:"house-plans",label:"homeDocumentation.nav.housePlans",icon:"lucideSquareDashedBottom"},{path:"wall-structures",label:"homeDocumentation.nav.wallStructures",icon:"lucideConstruction"}];static \u0275fac=function(n){return new(n||e)};static \u0275cmp=be({type:e,selectors:[["gh-home-shell"]],features:[Ie([Lt({lucideHouse:h1,lucideConstruction:l1,lucideSquareDashedBottom:E1})])],decls:33,vars:12,consts:[[1,"border-b"],[1,"px-4","py-2","text-lg","font-semibold"],["hlmSidebarGroupLabel",""],["hlmSidebarGroupContent",""],["hlmSidebarMenu",""],["hlmSidebarMenuItem",""],[1,"border-t","p-2"],[1,"px-2","text-xs","text-muted-foreground"],["hlmSidebarRail",""],["hlmSidebarInset",""],[1,"sticky","top-0","z-10","flex","h-14","shrink-0","items-center","gap-2","border-b","bg-background","px-4"],["hlmSidebarTrigger",""],[1,"sr-only"],[1,"flex-1"],[1,"text-lg","font-semibold"],[1,"flex","items-center","gap-2"],[1,"flex-1","overflow-auto"],["hlmSidebarMenuButton","","routerLinkActive","bg-sidebar-accent text-sidebar-accent-foreground",3,"routerLink"],["hlm","","size","sm",3,"name"]],template:function(n,s){n&1&&(M(0,"hlm-sidebar-wrapper")(1,"hlm-sidebar")(2,"hlm-sidebar-header",0)(3,"h2",1),_(4),Y(5,"transloco"),R()(),M(6,"hlm-sidebar-content")(7,"hlm-sidebar-group")(8,"div",2),_(9),Y(10,"transloco"),R(),M(11,"div",3)(12,"ul",4),cn(13,Wk,6,5,"li",5,zk),R()()()(),M(15,"hlm-sidebar-footer",6)(16,"p",7),_(17),Y(18,"transloco"),R()(),ee(19,"div",8),R(),M(20,"main",9)(21,"header",10)(22,"button",11)(23,"span",12),_(24,"Toggle Sidebar"),R()(),M(25,"div",13)(26,"h1",14),_(27),Y(28,"transloco"),R()(),M(29,"div",15),ee(30,"gh-user-avatar"),R()(),M(31,"main",16),ee(32,"router-outlet"),R()()()),n&2&&(P(4),xe(" ",X(5,4,"homeDocumentation.title")," "),P(5),xe(" ",X(10,6,"homeDocumentation.nav.navigation")," "),P(4),un(s.navigationItems),P(4),xe(" ",X(18,8,"homeDocumentation.nav.footer")," "),P(10),Ee(X(28,10,"homeDocumentation.title")))},dependencies:[gn,$w,Ww,Uw,qw,fn,J1,Tg,Ag,Ig,_g,Lg,Og,Ng,Bg,Hg,Gg,zg,Wg,Ug,it,xt,As],encapsulation:2,changeDetection:0})}return e})();function Qt(e){this.content=e}Qt.prototype={constructor:Qt,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return t==-1?void 0:this.content[t+1]},update:function(e,t,i){var n=i&&i!=e?this.remove(i):this,s=n.find(e),o=n.content.slice();return s==-1?o.push(i||e,t):(o[s+1]=t,i&&(o[s]=i)),new Qt(o)},remove:function(e){var t=this.find(e);if(t==-1)return this;var i=this.content.slice();return i.splice(t,2),new Qt(i)},addToStart:function(e,t){return new Qt([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var i=this.remove(e).content.slice();return i.push(e,t),new Qt(i)},addBefore:function(e,t,i){var n=this.remove(t),s=n.content.slice(),o=n.find(e);return s.splice(o==-1?s.length:o,0,t,i),new Qt(s)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return e=Qt.from(e),e.size?new Qt(e.content.concat(this.subtract(e).content)):this},append:function(e){return e=Qt.from(e),e.size?new Qt(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=Qt.from(e);for(var i=0;i<e.content.length;i+=2)t=t.remove(e.content[i]);return t},toObject:function(){var e={};return this.forEach(function(t,i){e[t]=i}),e},get size(){return this.content.length>>1}};Qt.from=function(e){if(e instanceof Qt)return e;var t=[];if(e)for(var i in e)t.push(i,e[i]);return new Qt(t)};var $g=Qt;function Db(e,t,i){for(let n=0;;n++){if(n==e.childCount||n==t.childCount)return e.childCount==t.childCount?null:i;let s=e.child(n),o=t.child(n);if(s==o){i+=s.nodeSize;continue}if(!s.sameMarkup(o))return i;if(s.isText&&s.text!=o.text){for(let r=0;s.text[r]==o.text[r];r++)i++;return i}if(s.content.size||o.content.size){let r=Db(s.content,o.content,i+1);if(r!=null)return r}i+=s.nodeSize}}function kb(e,t,i,n){for(let s=e.childCount,o=t.childCount;;){if(s==0||o==0)return s==o?null:{a:i,b:n};let r=e.child(--s),a=t.child(--o),l=r.nodeSize;if(r==a){i-=l,n-=l;continue}if(!r.sameMarkup(a))return{a:i,b:n};if(r.isText&&r.text!=a.text){let d=0,c=Math.min(r.text.length,a.text.length);for(;d<c&&r.text[r.text.length-d-1]==a.text[a.text.length-d-1];)d++,i--,n--;return{a:i,b:n}}if(r.content.size||a.content.size){let d=kb(r.content,a.content,i-1,n-1);if(d)return d}i-=l,n-=l}}var B=class e{constructor(t,i){if(this.content=t,this.size=i||0,i==null)for(let n=0;n<t.length;n++)this.size+=t[n].nodeSize}nodesBetween(t,i,n,s=0,o){for(let r=0,a=0;a<i;r++){let l=this.content[r],d=a+l.nodeSize;if(d>t&&n(l,s+a,o||null,r)!==!1&&l.content.size){let c=a+1;l.nodesBetween(Math.max(0,t-c),Math.min(l.content.size,i-c),n,s+c)}a=d}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,i,n,s){let o="",r=!0;return this.nodesBetween(t,i,(a,l)=>{let d=a.isText?a.text.slice(Math.max(t,l)-l,i-l):a.isLeaf?s?typeof s=="function"?s(a):s:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&d||a.isTextblock)&&n&&(r?r=!1:o+=n),o+=d},0),o}append(t){if(!t.size)return this;if(!this.size)return t;let i=this.lastChild,n=t.firstChild,s=this.content.slice(),o=0;for(i.isText&&i.sameMarkup(n)&&(s[s.length-1]=i.withText(i.text+n.text),o=1);o<t.content.length;o++)s.push(t.content[o]);return new e(s,this.size+t.size)}cut(t,i=this.size){if(t==0&&i==this.size)return this;let n=[],s=0;if(i>t)for(let o=0,r=0;r<i;o++){let a=this.content[o],l=r+a.nodeSize;l>t&&((r<t||l>i)&&(a.isText?a=a.cut(Math.max(0,t-r),Math.min(a.text.length,i-r)):a=a.cut(Math.max(0,t-r-1),Math.min(a.content.size,i-r-1))),n.push(a),s+=a.nodeSize),r=l}return new e(n,s)}cutByIndex(t,i){return t==i?e.empty:t==0&&i==this.content.length?this:new e(this.content.slice(t,i))}replaceChild(t,i){let n=this.content[t];if(n==i)return this;let s=this.content.slice(),o=this.size+i.nodeSize-n.nodeSize;return s[t]=i,new e(s,o)}addToStart(t){return new e([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new e(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let i=0;i<this.content.length;i++)if(!this.content[i].eq(t.content[i]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let i=this.content[t];if(!i)throw new RangeError("Index "+t+" out of range for "+this);return i}maybeChild(t){return this.content[t]||null}forEach(t){for(let i=0,n=0;i<this.content.length;i++){let s=this.content[i];t(s,n,i),n+=s.nodeSize}}findDiffStart(t,i=0){return Db(this,t,i)}findDiffEnd(t,i=this.size,n=t.size){return kb(this,t,i,n)}findIndex(t){if(t==0)return fc(0,t);if(t==this.size)return fc(this.content.length,t);if(t>this.size||t<0)throw new RangeError(`Position ${t} outside of fragment (${this})`);for(let i=0,n=0;;i++){let s=this.child(i),o=n+s.nodeSize;if(o>=t)return o==t?fc(i+1,o):fc(i,n);n=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(t=>t.toJSON()):null}static fromJSON(t,i){if(!i)return e.empty;if(!Array.isArray(i))throw new RangeError("Invalid input for Fragment.fromJSON");return new e(i.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return e.empty;let i,n=0;for(let s=0;s<t.length;s++){let o=t[s];n+=o.nodeSize,s&&o.isText&&t[s-1].sameMarkup(o)?(i||(i=t.slice(0,s)),i[i.length-1]=o.withText(i[i.length-1].text+o.text)):i&&i.push(o)}return new e(i||t,n)}static from(t){if(!t)return e.empty;if(t instanceof e)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new e([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}};B.empty=new B([],0);var jg={index:0,offset:0};function fc(e,t){return jg.index=e,jg.offset=t,jg}function Cc(e,t){if(e===t)return!0;if(!(e&&typeof e=="object")||!(t&&typeof t=="object"))return!1;let i=Array.isArray(e);if(Array.isArray(t)!=i)return!1;if(i){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!Cc(e[n],t[n]))return!1}else{for(let n in e)if(!(n in t)||!Cc(e[n],t[n]))return!1;for(let n in t)if(!(n in e))return!1}return!0}var Ue=(()=>{class e{constructor(i,n){this.type=i,this.attrs=n}addToSet(i){let n,s=!1;for(let o=0;o<i.length;o++){let r=i[o];if(this.eq(r))return i;if(this.type.excludes(r.type))n||(n=i.slice(0,o));else{if(r.type.excludes(this.type))return i;!s&&r.type.rank>this.type.rank&&(n||(n=i.slice(0,o)),n.push(this),s=!0),n&&n.push(r)}}return n||(n=i.slice()),s||n.push(this),n}removeFromSet(i){for(let n=0;n<i.length;n++)if(this.eq(i[n]))return i.slice(0,n).concat(i.slice(n+1));return i}isInSet(i){for(let n=0;n<i.length;n++)if(this.eq(i[n]))return!0;return!1}eq(i){return this==i||this.type==i.type&&Cc(this.attrs,i.attrs)}toJSON(){let i={type:this.type.name};for(let n in this.attrs){i.attrs=this.attrs;break}return i}static fromJSON(i,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let s=i.marks[n.type];if(!s)throw new RangeError(`There is no mark type ${n.type} in this schema`);let o=s.create(n.attrs);return s.checkAttrs(o.attrs),o}static sameSet(i,n){if(i==n)return!0;if(i.length!=n.length)return!1;for(let s=0;s<i.length;s++)if(!i[s].eq(n[s]))return!1;return!0}static setFrom(i){if(!i||Array.isArray(i)&&i.length==0)return e.none;if(i instanceof e)return[i];let n=i.slice();return n.sort((s,o)=>s.type.rank-o.type.rank),n}}return e.none=[],e})(),Do=class extends Error{},J=class e{constructor(t,i,n){this.content=t,this.openStart=i,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,i){let n=Fb(this.content,t+this.openStart,i);return n&&new e(n,this.openStart,this.openEnd)}removeBetween(t,i){return new e(Pb(this.content,t+this.openStart,i+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,i){if(!i)return e.empty;let n=i.openStart||0,s=i.openEnd||0;if(typeof n!="number"||typeof s!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new e(B.fromJSON(t,i.content),n,s)}static maxOpen(t,i=!0){let n=0,s=0;for(let o=t.firstChild;o&&!o.isLeaf&&(i||!o.type.spec.isolating);o=o.firstChild)n++;for(let o=t.lastChild;o&&!o.isLeaf&&(i||!o.type.spec.isolating);o=o.lastChild)s++;return new e(t,n,s)}};J.empty=new J(B.empty,0,0);function Pb(e,t,i){let{index:n,offset:s}=e.findIndex(t),o=e.maybeChild(n),{index:r,offset:a}=e.findIndex(i);if(s==t||o.isText){if(a!=i&&!e.child(r).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(i))}if(n!=r)throw new RangeError("Removing non-flat range");return e.replaceChild(n,o.copy(Pb(o.content,t-s-1,i-s-1)))}function Fb(e,t,i,n){let{index:s,offset:o}=e.findIndex(t),r=e.maybeChild(s);if(o==t||r.isText)return n&&!n.canReplace(s,s,i)?null:e.cut(0,t).append(i).append(e.cut(t));let a=Fb(r.content,t-o-1,i,r);return a&&e.replaceChild(s,r.copy(a))}function Uk(e,t,i){if(i.openStart>e.depth)throw new Do("Inserted content deeper than insertion position");if(e.depth-i.openStart!=t.depth-i.openEnd)throw new Do("Inconsistent open depths");return Tb(e,t,i,0)}function Tb(e,t,i,n){let s=e.index(n),o=e.node(n);if(s==t.index(n)&&n<e.depth-i.openStart){let r=Tb(e,t,i,n+1);return o.copy(o.content.replaceChild(s,r))}else if(i.content.size)if(!i.openStart&&!i.openEnd&&e.depth==n&&t.depth==n){let r=e.parent,a=r.content;return Mo(r,a.cut(0,e.parentOffset).append(i.content).append(a.cut(t.parentOffset)))}else{let{start:r,end:a}=qk(i,e);return Mo(o,Ib(e,r,a,t,n))}else return Mo(o,vc(e,t,n))}function Ab(e,t){if(!t.type.compatibleContent(e.type))throw new Do("Cannot join "+t.type.name+" onto "+e.type.name)}function Yg(e,t,i){let n=e.node(i);return Ab(n,t.node(i)),n}function Ro(e,t){let i=t.length-1;i>=0&&e.isText&&e.sameMarkup(t[i])?t[i]=e.withText(t[i].text+e.text):t.push(e)}function rl(e,t,i,n){let s=(t||e).node(i),o=0,r=t?t.index(i):s.childCount;e&&(o=e.index(i),e.depth>i?o++:e.textOffset&&(Ro(e.nodeAfter,n),o++));for(let a=o;a<r;a++)Ro(s.child(a),n);t&&t.depth==i&&t.textOffset&&Ro(t.nodeBefore,n)}function Mo(e,t){return e.type.checkContent(t),e.copy(t)}function Ib(e,t,i,n,s){let o=e.depth>s&&Yg(e,t,s+1),r=n.depth>s&&Yg(i,n,s+1),a=[];return rl(null,e,s,a),o&&r&&t.index(s)==i.index(s)?(Ab(o,r),Ro(Mo(o,Ib(e,t,i,n,s+1)),a)):(o&&Ro(Mo(o,vc(e,t,s+1)),a),rl(t,i,s,a),r&&Ro(Mo(r,vc(i,n,s+1)),a)),rl(n,null,s,a),new B(a)}function vc(e,t,i){let n=[];if(rl(null,e,i,n),e.depth>i){let s=Yg(e,t,i+1);Ro(Mo(s,vc(e,t,i+1)),n)}return rl(t,null,i,n),new B(n)}function qk(e,t){let i=t.depth-e.openStart,s=t.node(i).copy(e.content);for(let o=i-1;o>=0;o--)s=t.node(o).copy(B.from(s));return{start:s.resolveNoCache(e.openStart+i),end:s.resolveNoCache(s.content.size-e.openEnd-i)}}var wc=class e{constructor(t,i,n){this.pos=t,this.path=i,this.parentOffset=n,this.depth=i.length/3-1}resolveDepth(t){return t==null?this.depth:t<0?this.depth+t:t}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(t){return this.path[this.resolveDepth(t)*3]}index(t){return this.path[this.resolveDepth(t)*3+1]}indexAfter(t){return t=this.resolveDepth(t),this.index(t)+(t==this.depth&&!this.textOffset?0:1)}start(t){return t=this.resolveDepth(t),t==0?0:this.path[t*3-1]+1}end(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size}before(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]}after(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]+this.path[t*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let t=this.parent,i=this.index(this.depth);if(i==t.childCount)return null;let n=this.pos-this.path[this.path.length-1],s=t.child(i);return n?t.child(i).cut(n):s}get nodeBefore(){let t=this.index(this.depth),i=this.pos-this.path[this.path.length-1];return i?this.parent.child(t).cut(0,i):t==0?null:this.parent.child(t-1)}posAtIndex(t,i){i=this.resolveDepth(i);let n=this.path[i*3],s=i==0?0:this.path[i*3-1]+1;for(let o=0;o<t;o++)s+=n.child(o).nodeSize;return s}marks(){let t=this.parent,i=this.index();if(t.content.size==0)return Ue.none;if(this.textOffset)return t.child(i).marks;let n=t.maybeChild(i-1),s=t.maybeChild(i);if(!n){let a=n;n=s,s=a}let o=n.marks;for(var r=0;r<o.length;r++)o[r].type.spec.inclusive===!1&&(!s||!o[r].isInSet(s.marks))&&(o=o[r--].removeFromSet(o));return o}marksAcross(t){let i=this.parent.maybeChild(this.index());if(!i||!i.isInline)return null;let n=i.marks,s=t.parent.maybeChild(t.index());for(var o=0;o<n.length;o++)n[o].type.spec.inclusive===!1&&(!s||!n[o].isInSet(s.marks))&&(n=n[o--].removeFromSet(n));return n}sharedDepth(t){for(let i=this.depth;i>0;i--)if(this.start(i)<=t&&this.end(i)>=t)return i;return 0}blockRange(t=this,i){if(t.pos<this.pos)return t.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!i||i(this.node(n))))return new ko(this,t,n);return null}sameParent(t){return this.pos-this.parentOffset==t.pos-t.parentOffset}max(t){return t.pos>this.pos?t:this}min(t){return t.pos<this.pos?t:this}toString(){let t="";for(let i=1;i<=this.depth;i++)t+=(t?"/":"")+this.node(i).type.name+"_"+this.index(i-1);return t+":"+this.parentOffset}static resolve(t,i){if(!(i>=0&&i<=t.content.size))throw new RangeError("Position "+i+" out of range");let n=[],s=0,o=i;for(let r=t;;){let{index:a,offset:l}=r.content.findIndex(o),d=o-l;if(n.push(r,a,s+l),!d||(r=r.child(a),r.isText))break;o=d-1,s+=l+1}return new e(i,n,o)}static resolveCached(t,i){let n=vb.get(t);if(n)for(let o=0;o<n.elts.length;o++){let r=n.elts[o];if(r.pos==i)return r}else vb.set(t,n=new Xg);let s=n.elts[n.i]=e.resolve(t,i);return n.i=(n.i+1)%$k,s}},Xg=class{constructor(){this.elts=[],this.i=0}},$k=12,vb=new WeakMap,ko=class{constructor(t,i,n){this.$from=t,this.$to=i,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}},jk=Object.create(null),Ci=class e{constructor(t,i,n,s=Ue.none){this.type=t,this.attrs=i,this.marks=s,this.content=n||B.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(t){return this.content.child(t)}maybeChild(t){return this.content.maybeChild(t)}forEach(t){this.content.forEach(t)}nodesBetween(t,i,n,s=0){this.content.nodesBetween(t,i,n,s,this)}descendants(t){this.nodesBetween(0,this.content.size,t)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(t,i,n,s){return this.content.textBetween(t,i,n,s)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)}sameMarkup(t){return this.hasMarkup(t.type,t.attrs,t.marks)}hasMarkup(t,i,n){return this.type==t&&Cc(this.attrs,i||t.defaultAttrs||jk)&&Ue.sameSet(this.marks,n||Ue.none)}copy(t=null){return t==this.content?this:new e(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new e(this.type,this.attrs,this.content,t)}cut(t,i=this.content.size){return t==0&&i==this.content.size?this:this.copy(this.content.cut(t,i))}slice(t,i=this.content.size,n=!1){if(t==i)return J.empty;let s=this.resolve(t),o=this.resolve(i),r=n?0:s.sharedDepth(i),a=s.start(r),d=s.node(r).content.cut(s.pos-a,o.pos-a);return new J(d,s.depth-r,o.depth-r)}replace(t,i,n){return Uk(this.resolve(t),this.resolve(i),n)}nodeAt(t){for(let i=this;;){let{index:n,offset:s}=i.content.findIndex(t);if(i=i.maybeChild(n),!i)return null;if(s==t||i.isText)return i;t-=s+1}}childAfter(t){let{index:i,offset:n}=this.content.findIndex(t);return{node:this.content.maybeChild(i),index:i,offset:n}}childBefore(t){if(t==0)return{node:null,index:0,offset:0};let{index:i,offset:n}=this.content.findIndex(t);if(n<t)return{node:this.content.child(i),index:i,offset:n};let s=this.content.child(i-1);return{node:s,index:i-1,offset:n-s.nodeSize}}resolve(t){return wc.resolveCached(this,t)}resolveNoCache(t){return wc.resolve(this,t)}rangeHasMark(t,i,n){let s=!1;return i>t&&this.nodesBetween(t,i,o=>(n.isInSet(o.marks)&&(s=!0),!s)),s}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),_b(this.marks,t)}contentMatchAt(t){let i=this.type.contentMatch.matchFragment(this.content,0,t);if(!i)throw new Error("Called contentMatchAt on a node with invalid content");return i}canReplace(t,i,n=B.empty,s=0,o=n.childCount){let r=this.contentMatchAt(t).matchFragment(n,s,o),a=r&&r.matchFragment(this.content,i);if(!a||!a.validEnd)return!1;for(let l=s;l<o;l++)if(!this.type.allowsMarks(n.child(l).marks))return!1;return!0}canReplaceWith(t,i,n,s){if(s&&!this.type.allowsMarks(s))return!1;let o=this.contentMatchAt(t).matchType(n),r=o&&o.matchFragment(this.content,i);return r?r.validEnd:!1}canAppend(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let t=Ue.none;for(let i=0;i<this.marks.length;i++){let n=this.marks[i];n.type.checkAttrs(n.attrs),t=n.addToSet(t)}if(!Ue.sameSet(t,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(i=>i.type.name)}`);this.content.forEach(i=>i.check())}toJSON(){let t={type:this.type.name};for(let i in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(i=>i.toJSON())),t}static fromJSON(t,i){if(!i)throw new RangeError("Invalid input for Node.fromJSON");let n;if(i.marks){if(!Array.isArray(i.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=i.marks.map(t.markFromJSON)}if(i.type=="text"){if(typeof i.text!="string")throw new RangeError("Invalid text node in JSON");return t.text(i.text,n)}let s=B.fromJSON(t,i.content),o=t.nodeType(i.type).create(i.attrs,s,n);return o.type.checkAttrs(o.attrs),o}};Ci.prototype.text=void 0;var Jg=class e extends Ci{constructor(t,i,n,s){if(super(t,i,null,s),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):_b(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(t,i){return this.text.slice(t,i)}get nodeSize(){return this.text.length}mark(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)}withText(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)}cut(t=0,i=this.text.length){return t==0&&i==this.text.length?this:this.withText(this.text.slice(t,i))}eq(t){return this.sameMarkup(t)&&this.text==t.text}toJSON(){let t=super.toJSON();return t.text=this.text,t}};function _b(e,t){for(let i=e.length-1;i>=0;i--)t=e[i].type.name+"("+t+")";return t}var Po=class e{constructor(t){this.validEnd=t,this.next=[],this.wrapCache=[]}static parse(t,i){let n=new Qg(t,i);if(n.next==null)return e.empty;let s=Lb(n);n.next&&n.err("Unexpected trailing text");let o=eP(Zk(s));return tP(o,n),o}matchType(t){for(let i=0;i<this.next.length;i++)if(this.next[i].type==t)return this.next[i].next;return null}matchFragment(t,i=0,n=t.childCount){let s=this;for(let o=i;s&&o<n;o++)s=s.matchType(t.child(o).type);return s}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let t=0;t<this.next.length;t++){let{type:i}=this.next[t];if(!(i.isText||i.hasRequiredAttrs()))return i}return null}compatible(t){for(let i=0;i<this.next.length;i++)for(let n=0;n<t.next.length;n++)if(this.next[i].type==t.next[n].type)return!0;return!1}fillBefore(t,i=!1,n=0){let s=[this];function o(r,a){let l=r.matchFragment(t,n);if(l&&(!i||l.validEnd))return B.from(a.map(d=>d.createAndFill()));for(let d=0;d<r.next.length;d++){let{type:c,next:u}=r.next[d];if(!(c.isText||c.hasRequiredAttrs())&&s.indexOf(u)==-1){s.push(u);let h=o(u,a.concat(c));if(h)return h}}return null}return o(this,[])}findWrapping(t){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==t)return this.wrapCache[n+1];let i=this.computeWrapping(t);return this.wrapCache.push(t,i),i}computeWrapping(t){let i=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let s=n.shift(),o=s.match;if(o.matchType(t)){let r=[];for(let a=s;a.type;a=a.via)r.push(a.type);return r.reverse()}for(let r=0;r<o.next.length;r++){let{type:a,next:l}=o.next[r];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in i)&&(!s.type||l.validEnd)&&(n.push({match:a.contentMatch,type:a,via:s}),i[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(t){if(t>=this.next.length)throw new RangeError(`There's no ${t}th edge in this content match`);return this.next[t]}toString(){let t=[];function i(n){t.push(n);for(let s=0;s<n.next.length;s++)t.indexOf(n.next[s].next)==-1&&i(n.next[s].next)}return i(this),t.map((n,s)=>{let o=s+(n.validEnd?"*":" ")+" ";for(let r=0;r<n.next.length;r++)o+=(r?", ":"")+n.next[r].type.name+"->"+t.indexOf(n.next[r].next);return o}).join(`
`)}};Po.empty=new Po(!0);var Qg=class{constructor(t,i){this.string=t,this.nodeTypes=i,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(t){return this.next==t&&(this.pos++||!0)}err(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")}};function Lb(e){let t=[];do t.push(Kk(e));while(e.eat("|"));return t.length==1?t[0]:{type:"choice",exprs:t}}function Kk(e){let t=[];do t.push(Yk(e));while(e.next&&e.next!=")"&&e.next!="|");return t.length==1?t[0]:{type:"seq",exprs:t}}function Yk(e){let t=Qk(e);for(;;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else if(e.eat("{"))t=Xk(e,t);else break;return t}function wb(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function Xk(e,t){let i=wb(e),n=i;return e.eat(",")&&(e.next!="}"?n=wb(e):n=-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:i,max:n,expr:t}}function Jk(e,t){let i=e.nodeTypes,n=i[t];if(n)return[n];let s=[];for(let o in i){let r=i[o];r.isInGroup(t)&&s.push(r)}return s.length==0&&e.err("No node type or group '"+t+"' found"),s}function Qk(e){if(e.eat("(")){let t=Lb(e);return e.eat(")")||e.err("Missing closing paren"),t}else if(/\W/.test(e.next))e.err("Unexpected token '"+e.next+"'");else{let t=Jk(e,e.next).map(i=>(e.inline==null?e.inline=i.isInline:e.inline!=i.isInline&&e.err("Mixing inline and block content"),{type:"name",value:i}));return e.pos++,t.length==1?t[0]:{type:"choice",exprs:t}}}function Zk(e){let t=[[]];return s(o(e,0),i()),t;function i(){return t.push([])-1}function n(r,a,l){let d={term:l,to:a};return t[r].push(d),d}function s(r,a){r.forEach(l=>l.to=a)}function o(r,a){if(r.type=="choice")return r.exprs.reduce((l,d)=>l.concat(o(d,a)),[]);if(r.type=="seq")for(let l=0;;l++){let d=o(r.exprs[l],a);if(l==r.exprs.length-1)return d;s(d,a=i())}else if(r.type=="star"){let l=i();return n(a,l),s(o(r.expr,l),l),[n(l)]}else if(r.type=="plus"){let l=i();return s(o(r.expr,a),l),s(o(r.expr,l),l),[n(l)]}else{if(r.type=="opt")return[n(a)].concat(o(r.expr,a));if(r.type=="range"){let l=a;for(let d=0;d<r.min;d++){let c=i();s(o(r.expr,l),c),l=c}if(r.max==-1)s(o(r.expr,l),l);else for(let d=r.min;d<r.max;d++){let c=i();n(l,c),s(o(r.expr,l),c),l=c}return[n(l)]}else{if(r.type=="name")return[n(a,void 0,r.value)];throw new Error("Unknown expr type")}}}}function Ob(e,t){return t-e}function bb(e,t){let i=[];return n(t),i.sort(Ob);function n(s){let o=e[s];if(o.length==1&&!o[0].term)return n(o[0].to);i.push(s);for(let r=0;r<o.length;r++){let{term:a,to:l}=o[r];!a&&i.indexOf(l)==-1&&n(l)}}}function eP(e){let t=Object.create(null);return i(bb(e,0));function i(n){let s=[];n.forEach(r=>{e[r].forEach(({term:a,to:l})=>{if(!a)return;let d;for(let c=0;c<s.length;c++)s[c][0]==a&&(d=s[c][1]);bb(e,l).forEach(c=>{d||s.push([a,d=[]]),d.indexOf(c)==-1&&d.push(c)})})});let o=t[n.join(",")]=new Po(n.indexOf(e.length-1)>-1);for(let r=0;r<s.length;r++){let a=s[r][1].sort(Ob);o.next.push({type:s[r][0],next:t[a.join(",")]||i(a)})}return o}}function tP(e,t){for(let i=0,n=[e];i<n.length;i++){let s=n[i],o=!s.validEnd,r=[];for(let a=0;a<s.next.length;a++){let{type:l,next:d}=s.next[a];r.push(l.name),o&&!(l.isText||l.hasRequiredAttrs())&&(o=!1),n.indexOf(d)==-1&&n.push(d)}o&&t.err("Only non-generatable nodes ("+r.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Nb(e){let t=Object.create(null);for(let i in e){let n=e[i];if(!n.hasDefault)return null;t[i]=n.default}return t}function Bb(e,t){let i=Object.create(null);for(let n in e){let s=t&&t[n];if(s===void 0){let o=e[n];if(o.hasDefault)s=o.default;else throw new RangeError("No value supplied for attribute "+n)}i[n]=s}return i}function Hb(e,t,i,n){for(let s in t)if(!(s in e))throw new RangeError(`Unsupported attribute ${s} for ${i} of type ${s}`);for(let s in e){let o=e[s];o.validate&&o.validate(t[s])}}function Vb(e,t){let i=Object.create(null);if(t)for(let n in t)i[n]=new Zg(e,n,t[n]);return i}var bc=class e{constructor(t,i,n){this.name=t,this.schema=i,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=Vb(t,n.attrs),this.defaultAttrs=Nb(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||t=="text"),this.isText=t=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Po.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(t){return this.groups.indexOf(t)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1}compatibleContent(t){return this==t||this.contentMatch.compatible(t.contentMatch)}computeAttrs(t){return!t&&this.defaultAttrs?this.defaultAttrs:Bb(this.attrs,t)}create(t=null,i,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Ci(this,this.computeAttrs(t),B.from(i),Ue.setFrom(n))}createChecked(t=null,i,n){return i=B.from(i),this.checkContent(i),new Ci(this,this.computeAttrs(t),i,Ue.setFrom(n))}createAndFill(t=null,i,n){if(t=this.computeAttrs(t),i=B.from(i),i.size){let r=this.contentMatch.fillBefore(i);if(!r)return null;i=r.append(i)}let s=this.contentMatch.matchFragment(i),o=s&&s.fillBefore(B.empty,!0);return o?new Ci(this,t,i.append(o),Ue.setFrom(n)):null}validContent(t){let i=this.contentMatch.matchFragment(t);if(!i||!i.validEnd)return!1;for(let n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0}checkContent(t){if(!this.validContent(t))throw new RangeError(`Invalid content for node ${this.name}: ${t.toString().slice(0,50)}`)}checkAttrs(t){Hb(this.attrs,t,"node",this.name)}allowsMarkType(t){return this.markSet==null||this.markSet.indexOf(t)>-1}allowsMarks(t){if(this.markSet==null)return!0;for(let i=0;i<t.length;i++)if(!this.allowsMarkType(t[i].type))return!1;return!0}allowedMarks(t){if(this.markSet==null)return t;let i;for(let n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?i&&i.push(t[n]):i||(i=t.slice(0,n));return i?i.length?i:Ue.none:t}static compile(t,i){let n=Object.create(null);t.forEach((o,r)=>n[o]=new e(o,i,r));let s=i.spec.topNode||"doc";if(!n[s])throw new RangeError("Schema is missing its top node type ('"+s+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}};function iP(e,t,i){let n=i.split("|");return s=>{let o=s===null?"null":typeof s;if(n.indexOf(o)<0)throw new RangeError(`Expected value of type ${n} for attribute ${t} on type ${e}, got ${o}`)}}var Zg=class{constructor(t,i,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate=typeof n.validate=="string"?iP(t,i,n.validate):n.validate}get isRequired(){return!this.hasDefault}},ll=class e{constructor(t,i,n,s){this.name=t,this.rank=i,this.schema=n,this.spec=s,this.attrs=Vb(t,s.attrs),this.excluded=null;let o=Nb(this.attrs);this.instance=o?new Ue(this,o):null}create(t=null){return!t&&this.instance?this.instance:new Ue(this,Bb(this.attrs,t))}static compile(t,i){let n=Object.create(null),s=0;return t.forEach((o,r)=>n[o]=new e(o,s++,i,r)),n}removeFromSet(t){for(var i=0;i<t.length;i++)t[i].type==this&&(t=t.slice(0,i).concat(t.slice(i+1)),i--);return t}isInSet(t){for(let i=0;i<t.length;i++)if(t[i].type==this)return t[i]}checkAttrs(t){Hb(this.attrs,t,"mark",this.name)}excludes(t){return this.excluded.indexOf(t)>-1}},Nr=class{constructor(t){this.linebreakReplacement=null,this.cached=Object.create(null);let i=this.spec={};for(let s in t)i[s]=t[s];i.nodes=$g.from(t.nodes),i.marks=$g.from(t.marks||{}),this.nodes=bc.compile(this.spec.nodes,this),this.marks=ll.compile(this.spec.marks,this);let n=Object.create(null);for(let s in this.nodes){if(s in this.marks)throw new RangeError(s+" can not be both a node and a mark");let o=this.nodes[s],r=o.spec.content||"",a=o.spec.marks;if(o.contentMatch=n[r]||(n[r]=Po.parse(r,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!o.isInline||!o.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=o}o.markSet=a=="_"?null:a?yb(this,a.split(" ")):a==""||!o.inlineContent?[]:null}for(let s in this.marks){let o=this.marks[s],r=o.spec.excludes;o.excluded=r==null?[o]:r==""?[]:yb(this,r.split(" "))}this.nodeFromJSON=s=>Ci.fromJSON(this,s),this.markFromJSON=s=>Ue.fromJSON(this,s),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(t,i=null,n,s){if(typeof t=="string")t=this.nodeType(t);else if(t instanceof bc){if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}else throw new RangeError("Invalid node type: "+t);return t.createChecked(i,n,s)}text(t,i){let n=this.nodes.text;return new Jg(n,n.defaultAttrs,t,Ue.setFrom(i))}mark(t,i){return typeof t=="string"&&(t=this.marks[t]),t.create(i)}nodeType(t){let i=this.nodes[t];if(!i)throw new RangeError("Unknown node type: "+t);return i}};function yb(e,t){let i=[];for(let n=0;n<t.length;n++){let s=t[n],o=e.marks[s],r=o;if(o)i.push(o);else for(let a in e.marks){let l=e.marks[a];(s=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(s)>-1)&&i.push(r=l)}if(!r)throw new SyntaxError("Unknown mark type: '"+t[n]+"'")}return i}function nP(e){return e.tag!=null}function sP(e){return e.style!=null}var mn=class e{constructor(t,i){this.schema=t,this.rules=i,this.tags=[],this.styles=[];let n=this.matchedStyles=[];i.forEach(s=>{if(nP(s))this.tags.push(s);else if(sP(s)){let o=/[^=]*/.exec(s.style)[0];n.indexOf(o)<0&&n.push(o),this.styles.push(s)}}),this.normalizeLists=!this.tags.some(s=>{if(!/^(ul|ol)\b/.test(s.tag)||!s.node)return!1;let o=t.nodes[s.node];return o.contentMatch.matchType(o)})}parse(t,i={}){let n=new yc(this,i,!1);return n.addAll(t,Ue.none,i.from,i.to),n.finish()}parseSlice(t,i={}){let n=new yc(this,i,!0);return n.addAll(t,Ue.none,i.from,i.to),J.maxOpen(n.finish())}matchTag(t,i,n){for(let s=n?this.tags.indexOf(n)+1:0;s<this.tags.length;s++){let o=this.tags[s];if(aP(t,o.tag)&&(o.namespace===void 0||t.namespaceURI==o.namespace)&&(!o.context||i.matchesContext(o.context))){if(o.getAttrs){let r=o.getAttrs(t);if(r===!1)continue;o.attrs=r||void 0}return o}}}matchStyle(t,i,n,s){for(let o=s?this.styles.indexOf(s)+1:0;o<this.styles.length;o++){let r=this.styles[o],a=r.style;if(!(a.indexOf(t)!=0||r.context&&!n.matchesContext(r.context)||a.length>t.length&&(a.charCodeAt(t.length)!=61||a.slice(t.length+1)!=i))){if(r.getAttrs){let l=r.getAttrs(i);if(l===!1)continue;r.attrs=l||void 0}return r}}}static schemaRules(t){let i=[];function n(s){let o=s.priority==null?50:s.priority,r=0;for(;r<i.length;r++){let a=i[r];if((a.priority==null?50:a.priority)<o)break}i.splice(r,0,s)}for(let s in t.marks){let o=t.marks[s].spec.parseDOM;o&&o.forEach(r=>{n(r=xb(r)),r.mark||r.ignore||r.clearMark||(r.mark=s)})}for(let s in t.nodes){let o=t.nodes[s].spec.parseDOM;o&&o.forEach(r=>{n(r=xb(r)),r.node||r.ignore||r.mark||(r.node=s)})}return i}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new e(t,e.schemaRules(t)))}},Gb={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},oP={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},zb={ol:!0,ul:!0},dl=1,ef=2,al=4;function Sb(e,t,i){return t!=null?(t?dl:0)|(t==="full"?ef:0):e&&e.whitespace=="pre"?dl|ef:i&~al}var Or=class{constructor(t,i,n,s,o,r){this.type=t,this.attrs=i,this.marks=n,this.solid=s,this.options=r,this.content=[],this.activeMarks=Ue.none,this.match=o||(r&al?null:t.contentMatch)}findWrapping(t){if(!this.match){if(!this.type)return[];let i=this.type.contentMatch.fillBefore(B.from(t));if(i)this.match=this.type.contentMatch.matchFragment(i);else{let n=this.type.contentMatch,s;return(s=n.findWrapping(t.type))?(this.match=n,s):null}}return this.match.findWrapping(t.type)}finish(t){if(!(this.options&dl)){let n=this.content[this.content.length-1],s;if(n&&n.isText&&(s=/[ \t\r\n\u000c]+$/.exec(n.text))){let o=n;n.text.length==s[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-s[0].length))}}let i=B.from(this.content);return!t&&this.match&&(i=i.append(this.match.fillBefore(B.empty,!0))),this.type?this.type.create(this.attrs,i,this.marks):i}inlineContext(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!Gb.hasOwnProperty(t.parentNode.nodeName.toLowerCase())}},yc=class{constructor(t,i,n){this.parser=t,this.options=i,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let s=i.topNode,o,r=Sb(null,i.preserveWhitespace,0)|(n?al:0);s?o=new Or(s.type,s.attrs,Ue.none,!0,i.topMatch||s.type.contentMatch,r):n?o=new Or(null,null,Ue.none,!0,null,r):o=new Or(t.schema.topNodeType,null,Ue.none,!0,null,r),this.nodes=[o],this.find=i.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(t,i){t.nodeType==3?this.addTextNode(t,i):t.nodeType==1&&this.addElement(t,i)}addTextNode(t,i){let n=t.nodeValue,s=this.top,o=s.options&ef?"full":this.localPreserveWS||(s.options&dl)>0,{schema:r}=this.parser;if(o==="full"||s.inlineContext(t)||/[^ \t\r\n\u000c]/.test(n)){if(o)if(o==="full")n=n.replace(/\r\n?/g,`
`);else if(r.linebreakReplacement&&/[\r\n]/.test(n)&&this.top.findWrapping(r.linebreakReplacement.create())){let a=n.split(/\r?\n|\r/);for(let l=0;l<a.length;l++)l&&this.insertNode(r.linebreakReplacement.create(),i,!0),a[l]&&this.insertNode(r.text(a[l]),i,!/\S/.test(a[l]));n=""}else n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let a=s.content[s.content.length-1],l=t.previousSibling;(!a||l&&l.nodeName=="BR"||a.isText&&/[ \t\r\n\u000c]$/.test(a.text))&&(n=n.slice(1))}n&&this.insertNode(r.text(n),i,!/\S/.test(n)),this.findInText(t)}else this.findInside(t)}addElement(t,i,n){let s=this.localPreserveWS,o=this.top;(t.tagName=="PRE"||/pre/.test(t.style&&t.style.whiteSpace))&&(this.localPreserveWS=!0);let r=t.nodeName.toLowerCase(),a;zb.hasOwnProperty(r)&&this.parser.normalizeLists&&rP(t);let l=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(a=this.parser.matchTag(t,this,n));e:if(l?l.ignore:oP.hasOwnProperty(r))this.findInside(t),this.ignoreFallback(t,i);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(t=l.skip);let d,c=this.needsBlock;if(Gb.hasOwnProperty(r))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),d=!0,o.type||(this.needsBlock=!0);else if(!t.firstChild){this.leafFallback(t,i);break e}let u=l&&l.skip?i:this.readStyles(t,i);u&&this.addAll(t,u),d&&this.sync(o),this.needsBlock=c}else{let d=this.readStyles(t,i);d&&this.addElementByRule(t,l,d,l.consuming===!1?a:void 0)}this.localPreserveWS=s}leafFallback(t,i){t.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode(`
`),i)}ignoreFallback(t,i){t.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),i,!0)}readStyles(t,i){let n=t.style;if(n&&n.length)for(let s=0;s<this.parser.matchedStyles.length;s++){let o=this.parser.matchedStyles[s],r=n.getPropertyValue(o);if(r)for(let a=void 0;;){let l=this.parser.matchStyle(o,r,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?i=i.filter(d=>!l.clearMark(d)):i=i.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return i}addElementByRule(t,i,n,s){let o,r;if(i.node)if(r=this.parser.schema.nodes[i.node],r.isLeaf)this.insertNode(r.create(i.attrs),n,t.nodeName=="BR")||this.leafFallback(t,n);else{let l=this.enter(r,i.attrs||null,n,i.preserveWhitespace);l&&(o=!0,n=l)}else{let l=this.parser.schema.marks[i.mark];n=n.concat(l.create(i.attrs))}let a=this.top;if(r&&r.isLeaf)this.findInside(t);else if(s)this.addElement(t,n,s);else if(i.getContent)this.findInside(t),i.getContent(t,this.parser.schema).forEach(l=>this.insertNode(l,n,!1));else{let l=t;typeof i.contentElement=="string"?l=t.querySelector(i.contentElement):typeof i.contentElement=="function"?l=i.contentElement(t):i.contentElement&&(l=i.contentElement),this.findAround(t,l,!0),this.addAll(l,n),this.findAround(t,l,!1)}o&&this.sync(a)&&this.open--}addAll(t,i,n,s){let o=n||0;for(let r=n?t.childNodes[n]:t.firstChild,a=s==null?null:t.childNodes[s];r!=a;r=r.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(r,i);this.findAtPoint(t,o)}findPlace(t,i,n){let s,o;for(let r=this.open,a=0;r>=0;r--){let l=this.nodes[r],d=l.findWrapping(t);if(d&&(!s||s.length>d.length+a)&&(s=d,o=l,!d.length))break;if(l.solid){if(n)break;a+=2}}if(!s)return null;this.sync(o);for(let r=0;r<s.length;r++)i=this.enterInner(s[r],null,i,!1);return i}insertNode(t,i,n){if(t.isInline&&this.needsBlock&&!this.top.type){let o=this.textblockFromContext();o&&(i=this.enterInner(o,null,i))}let s=this.findPlace(t,i,n);if(s){this.closeExtra();let o=this.top;o.match&&(o.match=o.match.matchType(t.type));let r=Ue.none;for(let a of s.concat(t.marks))(o.type?o.type.allowsMarkType(a.type):Eb(a.type,t.type))&&(r=a.addToSet(r));return o.content.push(t.mark(r)),!0}return!1}enter(t,i,n,s){let o=this.findPlace(t.create(i),n,!1);return o&&(o=this.enterInner(t,i,n,!0,s)),o}enterInner(t,i,n,s=!1,o){this.closeExtra();let r=this.top;r.match=r.match&&r.match.matchType(t);let a=Sb(t,o,r.options);r.options&al&&r.content.length==0&&(a|=al);let l=Ue.none;return n=n.filter(d=>(r.type?r.type.allowsMarkType(d.type):Eb(d.type,t))?(l=d.addToSet(l),!1):!0),this.nodes.push(new Or(t,i,l,s,null,a)),this.open++,n}closeExtra(t=!1){let i=this.nodes.length-1;if(i>this.open){for(;i>this.open;i--)this.nodes[i-1].content.push(this.nodes[i].finish(t));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(t){for(let i=this.open;i>=0;i--){if(this.nodes[i]==t)return this.open=i,!0;this.localPreserveWS&&(this.nodes[i].options|=dl)}return!1}get currentPos(){this.closeExtra();let t=0;for(let i=this.open;i>=0;i--){let n=this.nodes[i].content;for(let s=n.length-1;s>=0;s--)t+=n[s].nodeSize;i&&t++}return t}findAtPoint(t,i){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==i&&(this.find[n].pos=this.currentPos)}findInside(t){if(this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&t.nodeType==1&&t.contains(this.find[i].node)&&(this.find[i].pos=this.currentPos)}findAround(t,i,n){if(t!=i&&this.find)for(let s=0;s<this.find.length;s++)this.find[s].pos==null&&t.nodeType==1&&t.contains(this.find[s].node)&&i.compareDocumentPosition(this.find[s].node)&(n?2:4)&&(this.find[s].pos=this.currentPos)}findInText(t){if(this.find)for(let i=0;i<this.find.length;i++)this.find[i].node==t&&(this.find[i].pos=this.currentPos-(t.nodeValue.length-this.find[i].offset))}matchesContext(t){if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);let i=t.split("/"),n=this.options.context,s=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),o=-(n?n.depth+1:0)+(s?0:1),r=(a,l)=>{for(;a>=0;a--){let d=i[a];if(d==""){if(a==i.length-1||a==0)continue;for(;l>=o;l--)if(r(a-1,l))return!0;return!1}else{let c=l>0||l==0&&s?this.nodes[l].type:n&&l>=o?n.node(l-o).type:null;if(!c||c.name!=d&&!c.isInGroup(d))return!1;l--}}return!0};return r(i.length-1,this.open)}textblockFromContext(){let t=this.options.context;if(t)for(let i=t.depth;i>=0;i--){let n=t.node(i).contentMatchAt(t.indexAfter(i)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let i in this.parser.schema.nodes){let n=this.parser.schema.nodes[i];if(n.isTextblock&&n.defaultAttrs)return n}}};function rP(e){for(let t=e.firstChild,i=null;t;t=t.nextSibling){let n=t.nodeType==1?t.nodeName.toLowerCase():null;n&&zb.hasOwnProperty(n)&&i?(i.appendChild(t),t=i):n=="li"?i=t:n&&(i=null)}}function aP(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function xb(e){let t={};for(let i in e)t[i]=e[i];return t}function Eb(e,t){let i=t.schema.nodes;for(let n in i){let s=i[n];if(!s.allowsMarkType(e))continue;let o=[],r=a=>{o.push(a);for(let l=0;l<a.edgeCount;l++){let{type:d,next:c}=a.edge(l);if(d==t||o.indexOf(c)<0&&r(c))return!0}};if(r(s.contentMatch))return!0}}var jn=class e{constructor(t,i){this.nodes=t,this.marks=i}serializeFragment(t,i={},n){n||(n=Kg(i).createDocumentFragment());let s=n,o=[];return t.forEach(r=>{if(o.length||r.marks.length){let a=0,l=0;for(;a<o.length&&l<r.marks.length;){let d=r.marks[l];if(!this.marks[d.type.name]){l++;continue}if(!d.eq(o[a][0])||d.type.spec.spanning===!1)break;a++,l++}for(;a<o.length;)s=o.pop()[1];for(;l<r.marks.length;){let d=r.marks[l++],c=this.serializeMark(d,r.isInline,i);c&&(o.push([d,s]),s.appendChild(c.dom),s=c.contentDOM||c.dom)}}s.appendChild(this.serializeNodeInner(r,i))}),n}serializeNodeInner(t,i){let{dom:n,contentDOM:s}=mc(Kg(i),this.nodes[t.type.name](t),null,t.attrs);if(s){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,i,s)}return n}serializeNode(t,i={}){let n=this.serializeNodeInner(t,i);for(let s=t.marks.length-1;s>=0;s--){let o=this.serializeMark(t.marks[s],t.isInline,i);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n}serializeMark(t,i,n={}){let s=this.marks[t.type.name];return s&&mc(Kg(n),s(t,i),null,t.attrs)}static renderSpec(t,i,n=null,s){return mc(t,i,n,s)}static fromSchema(t){return t.cached.domSerializer||(t.cached.domSerializer=new e(this.nodesFromSchema(t),this.marksFromSchema(t)))}static nodesFromSchema(t){let i=Rb(t.nodes);return i.text||(i.text=n=>n.text),i}static marksFromSchema(t){return Rb(t.marks)}};function Rb(e){let t={};for(let i in e){let n=e[i].spec.toDOM;n&&(t[i]=n)}return t}function Kg(e){return e.document||window.document}var Mb=new WeakMap;function lP(e){let t=Mb.get(e);return t===void 0&&Mb.set(e,t=dP(e)),t}function dP(e){let t=null;function i(n){if(n&&typeof n=="object")if(Array.isArray(n))if(typeof n[0]=="string")t||(t=[]),t.push(n);else for(let s=0;s<n.length;s++)i(n[s]);else for(let s in n)i(n[s])}return i(e),t}function mc(e,t,i,n){if(typeof t=="string")return{dom:e.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let s=t[0],o;if(typeof s!="string")throw new RangeError("Invalid array passed to renderSpec");if(n&&(o=lP(n))&&o.indexOf(t)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let r=s.indexOf(" ");r>0&&(i=s.slice(0,r),s=s.slice(r+1));let a,l=i?e.createElementNS(i,s):e.createElement(s),d=t[1],c=1;if(d&&typeof d=="object"&&d.nodeType==null&&!Array.isArray(d)){c=2;for(let u in d)if(d[u]!=null){let h=u.indexOf(" ");h>0?l.setAttributeNS(u.slice(0,h),u.slice(h+1),d[u]):u=="style"&&l.style?l.style.cssText=d[u]:l.setAttribute(u,d[u])}}for(let u=c;u<t.length;u++){let h=t[u];if(h===0){if(u<t.length-1||u>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:p,contentDOM:g}=mc(e,h,i,n);if(l.appendChild(p),g){if(a)throw new RangeError("Multiple content holes");a=g}}}return{dom:l,contentDOM:a}}var qb=65535,$b=Math.pow(2,16);function cP(e,t){return e+t*$b}function Wb(e){return e&qb}function uP(e){return(e-(e&qb))/$b}var jb=1,Kb=2,Sc=4,Yb=8,hl=class{constructor(t,i,n){this.pos=t,this.delInfo=i,this.recover=n}get deleted(){return(this.delInfo&Yb)>0}get deletedBefore(){return(this.delInfo&(jb|Sc))>0}get deletedAfter(){return(this.delInfo&(Kb|Sc))>0}get deletedAcross(){return(this.delInfo&Sc)>0}},Kn=class e{constructor(t,i=!1){if(this.ranges=t,this.inverted=i,!t.length&&e.empty)return e.empty}recover(t){let i=0,n=Wb(t);if(!this.inverted)for(let s=0;s<n;s++)i+=this.ranges[s*3+2]-this.ranges[s*3+1];return this.ranges[n*3]+i+uP(t)}mapResult(t,i=1){return this._map(t,i,!1)}map(t,i=1){return this._map(t,i,!0)}_map(t,i,n){let s=0,o=this.inverted?2:1,r=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?s:0);if(l>t)break;let d=this.ranges[a+o],c=this.ranges[a+r],u=l+d;if(t<=u){let h=d?t==l?-1:t==u?1:i:i,p=l+s+(h<0?0:c);if(n)return p;let g=t==(i<0?l:u)?null:cP(a/3,t-l),f=t==l?Kb:t==u?jb:Sc;return(i<0?t!=l:t!=u)&&(f|=Yb),new hl(p,f,g)}s+=c-d}return n?t+s:new hl(t+s,0,null)}touches(t,i){let n=0,s=Wb(i),o=this.inverted?2:1,r=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?n:0);if(l>t)break;let d=this.ranges[a+o],c=l+d;if(t<=c&&a==s*3)return!0;n+=this.ranges[a+r]-d}return!1}forEach(t){let i=this.inverted?2:1,n=this.inverted?1:2;for(let s=0,o=0;s<this.ranges.length;s+=3){let r=this.ranges[s],a=r-(this.inverted?o:0),l=r+(this.inverted?0:o),d=this.ranges[s+i],c=this.ranges[s+n];t(a,a+d,l,l+c),o+=c-d}}invert(){return new e(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return t==0?e.empty:new e(t<0?[0,-t,0]:[0,0,t])}};Kn.empty=new Kn([]);var pl=class e{constructor(t,i,n=0,s=t?t.length:0){this.mirror=i,this.from=n,this.to=s,this._maps=t||[],this.ownData=!(t||i)}get maps(){return this._maps}slice(t=0,i=this.maps.length){return new e(this._maps,this.mirror,t,i)}appendMap(t,i){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(t),i!=null&&this.setMirror(this._maps.length-1,i)}appendMapping(t){for(let i=0,n=this._maps.length;i<t._maps.length;i++){let s=t.getMirror(i);this.appendMap(t._maps[i],s!=null&&s<i?n+s:void 0)}}getMirror(t){if(this.mirror){for(let i=0;i<this.mirror.length;i++)if(this.mirror[i]==t)return this.mirror[i+(i%2?-1:1)]}}setMirror(t,i){this.mirror||(this.mirror=[]),this.mirror.push(t,i)}appendMappingInverted(t){for(let i=t.maps.length-1,n=this._maps.length+t._maps.length;i>=0;i--){let s=t.getMirror(i);this.appendMap(t._maps[i].invert(),s!=null&&s>i?n-s-1:void 0)}}invert(){let t=new e;return t.appendMappingInverted(this),t}map(t,i=1){if(this.mirror)return this._map(t,i,!0);for(let n=this.from;n<this.to;n++)t=this._maps[n].map(t,i);return t}mapResult(t,i=1){return this._map(t,i,!1)}_map(t,i,n){let s=0;for(let o=this.from;o<this.to;o++){let r=this._maps[o],a=r.mapResult(t,i);if(a.recover!=null){let l=this.getMirror(o);if(l!=null&&l>o&&l<this.to){o=l,t=this._maps[l].recover(a.recover);continue}}s|=a.delInfo,t=a.pos}return n?t:new hl(t,s,null)}},tf=Object.create(null),Ot=class{getMap(){return Kn.empty}merge(t){return null}static fromJSON(t,i){if(!i||!i.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=tf[i.stepType];if(!n)throw new RangeError(`No step type ${i.stepType} defined`);return n.fromJSON(t,i)}static jsonID(t,i){if(t in tf)throw new RangeError("Duplicate use of step JSON ID "+t);return tf[t]=i,i.prototype.jsonID=t,i}},Gt=class e{constructor(t,i){this.doc=t,this.failed=i}static ok(t){return new e(t,null)}static fail(t){return new e(null,t)}static fromReplace(t,i,n,s){try{return e.ok(t.replace(i,n,s))}catch(o){if(o instanceof Do)return e.fail(o.message);throw o}}};function af(e,t,i){let n=[];for(let s=0;s<e.childCount;s++){let o=e.child(s);o.content.size&&(o=o.copy(af(o.content,t,o))),o.isInline&&(o=t(o,i,s)),n.push(o)}return B.fromArray(n)}var gl=class e extends Ot{constructor(t,i,n){super(),this.from=t,this.to=i,this.mark=n}apply(t){let i=t.slice(this.from,this.to),n=t.resolve(this.from),s=n.node(n.sharedDepth(this.to)),o=new J(af(i.content,(r,a)=>!r.isAtom||!a.type.allowsMarkType(this.mark.type)?r:r.mark(this.mark.addToSet(r.marks)),s),i.openStart,i.openEnd);return Gt.fromReplace(t,this.from,this.to,o)}invert(){return new Yn(this.from,this.to,this.mark)}map(t){let i=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return i.deleted&&n.deleted||i.pos>=n.pos?null:new e(i.pos,n.pos,this.mark)}merge(t){return t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,i){if(typeof i.from!="number"||typeof i.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new e(i.from,i.to,t.markFromJSON(i.mark))}};Ot.jsonID("addMark",gl);var Yn=class e extends Ot{constructor(t,i,n){super(),this.from=t,this.to=i,this.mark=n}apply(t){let i=t.slice(this.from,this.to),n=new J(af(i.content,s=>s.mark(this.mark.removeFromSet(s.marks)),t),i.openStart,i.openEnd);return Gt.fromReplace(t,this.from,this.to,n)}invert(){return new gl(this.from,this.to,this.mark)}map(t){let i=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return i.deleted&&n.deleted||i.pos>=n.pos?null:new e(i.pos,n.pos,this.mark)}merge(t){return t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,i){if(typeof i.from!="number"||typeof i.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new e(i.from,i.to,t.markFromJSON(i.mark))}};Ot.jsonID("removeMark",Yn);var fl=class e extends Ot{constructor(t,i){super(),this.pos=t,this.mark=i}apply(t){let i=t.nodeAt(this.pos);if(!i)return Gt.fail("No node at mark step's position");let n=i.type.create(i.attrs,null,this.mark.addToSet(i.marks));return Gt.fromReplace(t,this.pos,this.pos+1,new J(B.from(n),0,i.isLeaf?0:1))}invert(t){let i=t.nodeAt(this.pos);if(i){let n=this.mark.addToSet(i.marks);if(n.length==i.marks.length){for(let s=0;s<i.marks.length;s++)if(!i.marks[s].isInSet(n))return new e(this.pos,i.marks[s]);return new e(this.pos,this.mark)}}return new Br(this.pos,this.mark)}map(t){let i=t.mapResult(this.pos,1);return i.deletedAfter?null:new e(i.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,i){if(typeof i.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new e(i.pos,t.markFromJSON(i.mark))}};Ot.jsonID("addNodeMark",fl);var Br=class e extends Ot{constructor(t,i){super(),this.pos=t,this.mark=i}apply(t){let i=t.nodeAt(this.pos);if(!i)return Gt.fail("No node at mark step's position");let n=i.type.create(i.attrs,null,this.mark.removeFromSet(i.marks));return Gt.fromReplace(t,this.pos,this.pos+1,new J(B.from(n),0,i.isLeaf?0:1))}invert(t){let i=t.nodeAt(this.pos);return!i||!this.mark.isInSet(i.marks)?this:new fl(this.pos,this.mark)}map(t){let i=t.mapResult(this.pos,1);return i.deletedAfter?null:new e(i.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,i){if(typeof i.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new e(i.pos,t.markFromJSON(i.mark))}};Ot.jsonID("removeNodeMark",Br);var Zt=class e extends Ot{constructor(t,i,n,s=!1){super(),this.from=t,this.to=i,this.slice=n,this.structure=s}apply(t){return this.structure&&of(t,this.from,this.to)?Gt.fail("Structure replace would overwrite content"):Gt.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new Kn([this.from,this.to-this.from,this.slice.size])}invert(t){return new e(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let i=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return i.deletedAcross&&n.deletedAcross?null:new e(i.pos,Math.max(i.pos,n.pos),this.slice,this.structure)}merge(t){if(!(t instanceof e)||t.structure||this.structure)return null;if(this.from+this.slice.size==t.from&&!this.slice.openEnd&&!t.slice.openStart){let i=this.slice.size+t.slice.size==0?J.empty:new J(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new e(this.from,this.to+(t.to-t.from),i,this.structure)}else if(t.to==this.from&&!this.slice.openStart&&!t.slice.openEnd){let i=this.slice.size+t.slice.size==0?J.empty:new J(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new e(t.from,this.to,i,this.structure)}else return null}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,i){if(typeof i.from!="number"||typeof i.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new e(i.from,i.to,J.fromJSON(t,i.slice),!!i.structure)}};Ot.jsonID("replace",Zt);var Et=class e extends Ot{constructor(t,i,n,s,o,r,a=!1){super(),this.from=t,this.to=i,this.gapFrom=n,this.gapTo=s,this.slice=o,this.insert=r,this.structure=a}apply(t){if(this.structure&&(of(t,this.from,this.gapFrom)||of(t,this.gapTo,this.to)))return Gt.fail("Structure gap-replace would overwrite content");let i=t.slice(this.gapFrom,this.gapTo);if(i.openStart||i.openEnd)return Gt.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,i.content);return n?Gt.fromReplace(t,this.from,this.to,n):Gt.fail("Content does not fit in gap")}getMap(){return new Kn([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let i=this.gapTo-this.gapFrom;return new e(this.from,this.from+this.slice.size+i,this.from+this.insert,this.from+this.insert+i,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let i=t.mapResult(this.from,1),n=t.mapResult(this.to,-1),s=this.from==this.gapFrom?i.pos:t.map(this.gapFrom,-1),o=this.to==this.gapTo?n.pos:t.map(this.gapTo,1);return i.deletedAcross&&n.deletedAcross||s<i.pos||o>n.pos?null:new e(i.pos,n.pos,s,o,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,i){if(typeof i.from!="number"||typeof i.to!="number"||typeof i.gapFrom!="number"||typeof i.gapTo!="number"||typeof i.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new e(i.from,i.to,i.gapFrom,i.gapTo,J.fromJSON(t,i.slice),i.insert,!!i.structure)}};Ot.jsonID("replaceAround",Et);function of(e,t,i){let n=e.resolve(t),s=i-t,o=n.depth;for(;s>0&&o>0&&n.indexAfter(o)==n.node(o).childCount;)o--,s--;if(s>0){let r=n.node(o).maybeChild(n.indexAfter(o));for(;s>0;){if(!r||r.isLeaf)return!0;r=r.firstChild,s--}}return!1}function hP(e,t,i,n){let s=[],o=[],r,a;e.doc.nodesBetween(t,i,(l,d,c)=>{if(!l.isInline)return;let u=l.marks;if(!n.isInSet(u)&&c.type.allowsMarkType(n.type)){let h=Math.max(d,t),p=Math.min(d+l.nodeSize,i),g=n.addToSet(u);for(let f=0;f<u.length;f++)u[f].isInSet(g)||(r&&r.to==h&&r.mark.eq(u[f])?r.to=p:s.push(r=new Yn(h,p,u[f])));a&&a.to==h?a.to=p:o.push(a=new gl(h,p,n))}}),s.forEach(l=>e.step(l)),o.forEach(l=>e.step(l))}function pP(e,t,i,n){let s=[],o=0;e.doc.nodesBetween(t,i,(r,a)=>{if(!r.isInline)return;o++;let l=null;if(n instanceof ll){let d=r.marks,c;for(;c=n.isInSet(d);)(l||(l=[])).push(c),d=c.removeFromSet(d)}else n?n.isInSet(r.marks)&&(l=[n]):l=r.marks;if(l&&l.length){let d=Math.min(a+r.nodeSize,i);for(let c=0;c<l.length;c++){let u=l[c],h;for(let p=0;p<s.length;p++){let g=s[p];g.step==o-1&&u.eq(s[p].style)&&(h=g)}h?(h.to=d,h.step=o):s.push({style:u,from:Math.max(a,t),to:d,step:o})}}}),s.forEach(r=>e.step(new Yn(r.from,r.to,r.style)))}function lf(e,t,i,n=i.contentMatch,s=!0){let o=e.doc.nodeAt(t),r=[],a=t+1;for(let l=0;l<o.childCount;l++){let d=o.child(l),c=a+d.nodeSize,u=n.matchType(d.type);if(!u)r.push(new Zt(a,c,J.empty));else{n=u;for(let h=0;h<d.marks.length;h++)i.allowsMarkType(d.marks[h].type)||e.step(new Yn(a,c,d.marks[h]));if(s&&d.isText&&i.whitespace!="pre"){let h,p=/\r?\n|\r/g,g;for(;h=p.exec(d.text);)g||(g=new J(B.from(i.schema.text(" ",i.allowedMarks(d.marks))),0,0)),r.push(new Zt(a+h.index,a+h.index+h[0].length,g))}}a=c}if(!n.validEnd){let l=n.fillBefore(B.empty,!0);e.replace(a,a,new J(l,0,0))}for(let l=r.length-1;l>=0;l--)e.step(r[l])}function gP(e,t,i){return(t==0||e.canReplace(t,e.childCount))&&(i==e.childCount||e.canReplace(0,i))}function Xn(e){let i=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let n=e.depth,s=0,o=0;;--n){let r=e.$from.node(n),a=e.$from.index(n)+s,l=e.$to.indexAfter(n)-o;if(n<e.depth&&r.canReplace(a,l,i))return n;if(n==0||r.type.spec.isolating||!gP(r,a,l))break;a&&(s=1),l<r.childCount&&(o=1)}return null}function fP(e,t,i){let{$from:n,$to:s,depth:o}=t,r=n.before(o+1),a=s.after(o+1),l=r,d=a,c=B.empty,u=0;for(let g=o,f=!1;g>i;g--)f||n.index(g)>0?(f=!0,c=B.from(n.node(g).copy(c)),u++):l--;let h=B.empty,p=0;for(let g=o,f=!1;g>i;g--)f||s.after(g+1)<s.end(g)?(f=!0,h=B.from(s.node(g).copy(h)),p++):d++;e.step(new Et(l,d,r,a,new J(c.append(h),u,p),c.size-u,!0))}function Gr(e,t,i=null,n=e){let s=mP(e,t),o=s&&CP(n,t);return o?s.map(Ub).concat({type:t,attrs:i}).concat(o.map(Ub)):null}function Ub(e){return{type:e,attrs:null}}function mP(e,t){let{parent:i,startIndex:n,endIndex:s}=e,o=i.contentMatchAt(n).findWrapping(t);if(!o)return null;let r=o.length?o[0]:t;return i.canReplaceWith(n,s,r)?o:null}function CP(e,t){let{parent:i,startIndex:n,endIndex:s}=e,o=i.child(n),r=t.contentMatch.findWrapping(o.type);if(!r)return null;let l=(r.length?r[r.length-1]:t).contentMatch;for(let d=n;l&&d<s;d++)l=l.matchType(i.child(d).type);return!l||!l.validEnd?null:r}function vP(e,t,i){let n=B.empty;for(let r=i.length-1;r>=0;r--){if(n.size){let a=i[r].type.contentMatch.matchFragment(n);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=B.from(i[r].type.create(i[r].attrs,n))}let s=t.start,o=t.end;e.step(new Et(s,o,s,o,new J(n,0,0),i.length,!0))}function wP(e,t,i,n,s){if(!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=e.steps.length;e.doc.nodesBetween(t,i,(r,a)=>{let l=typeof s=="function"?s(r):s;if(r.isTextblock&&!r.hasMarkup(n,l)&&bP(e.doc,e.mapping.slice(o).map(a),n)){let d=null;if(n.schema.linebreakReplacement){let p=n.whitespace=="pre",g=!!n.contentMatch.matchType(n.schema.linebreakReplacement);p&&!g?d=!1:!p&&g&&(d=!0)}d===!1&&Jb(e,r,a,o),lf(e,e.mapping.slice(o).map(a,1),n,void 0,d===null);let c=e.mapping.slice(o),u=c.map(a,1),h=c.map(a+r.nodeSize,1);return e.step(new Et(u,h,u+1,h-1,new J(B.from(n.create(l,null,r.marks)),0,0),1,!0)),d===!0&&Xb(e,r,a,o),!1}})}function Xb(e,t,i,n){t.forEach((s,o)=>{if(s.isText){let r,a=/\r?\n|\r/g;for(;r=a.exec(s.text);){let l=e.mapping.slice(n).map(i+1+o+r.index);e.replaceWith(l,l+1,t.type.schema.linebreakReplacement.create())}}})}function Jb(e,t,i,n){t.forEach((s,o)=>{if(s.type==s.type.schema.linebreakReplacement){let r=e.mapping.slice(n).map(i+1+o);e.replaceWith(r,r+1,t.type.schema.text(`
`))}})}function bP(e,t,i){let n=e.resolve(t),s=n.index();return n.parent.canReplaceWith(s,s+1,i)}function yP(e,t,i,n,s){let o=e.doc.nodeAt(t);if(!o)throw new RangeError("No node at given position");i||(i=o.type);let r=i.create(n,null,s||o.marks);if(o.isLeaf)return e.replaceWith(t,t+o.nodeSize,r);if(!i.validContent(o.content))throw new RangeError("Invalid content for node type "+i.name);e.step(new Et(t,t+o.nodeSize,t+1,t+o.nodeSize-1,new J(B.from(r),0,0),1,!0))}function Ri(e,t,i=1,n){let s=e.resolve(t),o=s.depth-i,r=n&&n[n.length-1]||s.parent;if(o<0||s.parent.type.spec.isolating||!s.parent.canReplace(s.index(),s.parent.childCount)||!r.type.validContent(s.parent.content.cutByIndex(s.index(),s.parent.childCount)))return!1;for(let d=s.depth-1,c=i-2;d>o;d--,c--){let u=s.node(d),h=s.index(d);if(u.type.spec.isolating)return!1;let p=u.content.cutByIndex(h,u.childCount),g=n&&n[c+1];g&&(p=p.replaceChild(0,g.type.create(g.attrs)));let f=n&&n[c]||u;if(!u.canReplace(h+1,u.childCount)||!f.type.validContent(p))return!1}let a=s.indexAfter(o),l=n&&n[0];return s.node(o).canReplaceWith(a,a,l?l.type:s.node(o+1).type)}function SP(e,t,i=1,n){let s=e.doc.resolve(t),o=B.empty,r=B.empty;for(let a=s.depth,l=s.depth-i,d=i-1;a>l;a--,d--){o=B.from(s.node(a).copy(o));let c=n&&n[d];r=B.from(c?c.type.create(c.attrs,r):s.node(a).copy(r))}e.step(new Zt(t,t,new J(o.append(r),i,i),!0))}function _i(e,t){let i=e.resolve(t),n=i.index();return Qb(i.nodeBefore,i.nodeAfter)&&i.parent.canReplace(n,n+1)}function xP(e,t){t.content.size||e.type.compatibleContent(t.type);let i=e.contentMatchAt(e.childCount),{linebreakReplacement:n}=e.type.schema;for(let s=0;s<t.childCount;s++){let o=t.child(s),r=o.type==n?e.type.schema.nodes.text:o.type;if(i=i.matchType(r),!i||!e.type.allowsMarks(o.marks))return!1}return i.validEnd}function Qb(e,t){return!!(e&&t&&!e.isLeaf&&xP(e,t))}function Fo(e,t,i=-1){let n=e.resolve(t);for(let s=n.depth;;s--){let o,r,a=n.index(s);if(s==n.depth?(o=n.nodeBefore,r=n.nodeAfter):i>0?(o=n.node(s+1),a++,r=n.node(s).maybeChild(a)):(o=n.node(s).maybeChild(a-1),r=n.node(s+1)),o&&!o.isTextblock&&Qb(o,r)&&n.node(s).canReplace(a,a+1))return t;if(s==0)break;t=i<0?n.before(s):n.after(s)}}function EP(e,t,i){let n=null,{linebreakReplacement:s}=e.doc.type.schema,o=e.doc.resolve(t-i),r=o.node().type;if(s&&r.inlineContent){let c=r.whitespace=="pre",u=!!r.contentMatch.matchType(s);c&&!u?n=!1:!c&&u&&(n=!0)}let a=e.steps.length;if(n===!1){let c=e.doc.resolve(t+i);Jb(e,c.node(),c.before(),a)}r.inlineContent&&lf(e,t+i-1,r,o.node().contentMatchAt(o.index()),n==null);let l=e.mapping.slice(a),d=l.map(t-i);if(e.step(new Zt(d,l.map(t+i,-1),J.empty,!0)),n===!0){let c=e.doc.resolve(d);Xb(e,c.node(),c.before(),e.steps.length)}return e}function RP(e,t,i){let n=e.resolve(t);if(n.parent.canReplaceWith(n.index(),n.index(),i))return t;if(n.parentOffset==0)for(let s=n.depth-1;s>=0;s--){let o=n.index(s);if(n.node(s).canReplaceWith(o,o,i))return n.before(s+1);if(o>0)return null}if(n.parentOffset==n.parent.content.size)for(let s=n.depth-1;s>=0;s--){let o=n.indexAfter(s);if(n.node(s).canReplaceWith(o,o,i))return n.after(s+1);if(o<n.node(s).childCount)return null}return null}function Rc(e,t,i){let n=e.resolve(t);if(!i.content.size)return t;let s=i.content;for(let o=0;o<i.openStart;o++)s=s.firstChild.content;for(let o=1;o<=(i.openStart==0&&i.size?2:1);o++)for(let r=n.depth;r>=0;r--){let a=r==n.depth?0:n.pos<=(n.start(r+1)+n.end(r+1))/2?-1:1,l=n.index(r)+(a>0?1:0),d=n.node(r),c=!1;if(o==1)c=d.canReplace(l,l,s);else{let u=d.contentMatchAt(l).findWrapping(s.firstChild.type);c=u&&d.canReplaceWith(l,l,u[0])}if(c)return a==0?n.pos:a<0?n.before(r+1):n.after(r+1)}return null}function ml(e,t,i=t,n=J.empty){if(t==i&&!n.size)return null;let s=e.resolve(t),o=e.resolve(i);return Zb(s,o,n)?new Zt(t,i,n):new rf(s,o,n).fit()}function Zb(e,t,i){return!i.openStart&&!i.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),i.content)}var rf=class{constructor(t,i,n){this.$from=t,this.$to=i,this.unplaced=n,this.frontier=[],this.placed=B.empty;for(let s=0;s<=t.depth;s++){let o=t.node(s);this.frontier.push({type:o.type,match:o.contentMatchAt(t.indexAfter(s))})}for(let s=t.depth;s>0;s--)this.placed=B.from(t.node(s).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let d=this.findFittable();d?this.placeNodes(d):this.openMore()||this.dropNode()}let t=this.mustMoveInline(),i=this.placed.size-this.depth-this.$from.depth,n=this.$from,s=this.close(t<0?this.$to:n.doc.resolve(t));if(!s)return null;let o=this.placed,r=n.depth,a=s.depth;for(;r&&a&&o.childCount==1;)o=o.firstChild.content,r--,a--;let l=new J(o,r,a);return t>-1?new Et(n.pos,t,this.$to.pos,this.$to.end(),l,i):l.size||n.pos!=this.$to.pos?new Zt(n.pos,s.pos,l):null}findFittable(){let t=this.unplaced.openStart;for(let i=this.unplaced.content,n=0,s=this.unplaced.openEnd;n<t;n++){let o=i.firstChild;if(i.childCount>1&&(s=0),o.type.spec.isolating&&s<=n){t=n;break}i=o.content}for(let i=1;i<=2;i++)for(let n=i==1?t:this.unplaced.openStart;n>=0;n--){let s,o=null;n?(o=nf(this.unplaced.content,n-1).firstChild,s=o.content):s=this.unplaced.content;let r=s.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:d}=this.frontier[a],c,u=null;if(i==1&&(r?d.matchType(r.type)||(u=d.fillBefore(B.from(r),!1)):o&&l.compatibleContent(o.type)))return{sliceDepth:n,frontierDepth:a,parent:o,inject:u};if(i==2&&r&&(c=d.findWrapping(r.type)))return{sliceDepth:n,frontierDepth:a,parent:o,wrap:c};if(o&&d.matchType(o.type))break}}}openMore(){let{content:t,openStart:i,openEnd:n}=this.unplaced,s=nf(t,i);return!s.childCount||s.firstChild.isLeaf?!1:(this.unplaced=new J(t,i+1,Math.max(n,s.size+i>=t.size-n?i+1:0)),!0)}dropNode(){let{content:t,openStart:i,openEnd:n}=this.unplaced,s=nf(t,i);if(s.childCount<=1&&i>0){let o=t.size-i<=i+s.size;this.unplaced=new J(cl(t,i-1,1),i-1,o?i-1:n)}else this.unplaced=new J(cl(t,i,1),i,n)}placeNodes({sliceDepth:t,frontierDepth:i,parent:n,inject:s,wrap:o}){for(;this.depth>i;)this.closeFrontierNode();if(o)for(let f=0;f<o.length;f++)this.openFrontierNode(o[f]);let r=this.unplaced,a=n?n.content:r.content,l=r.openStart-t,d=0,c=[],{match:u,type:h}=this.frontier[i];if(s){for(let f=0;f<s.childCount;f++)c.push(s.child(f));u=u.matchFragment(s)}let p=a.size+t-(r.content.size-r.openEnd);for(;d<a.childCount;){let f=a.child(d),m=u.matchType(f.type);if(!m)break;d++,(d>1||l==0||f.content.size)&&(u=m,c.push(ey(f.mark(h.allowedMarks(f.marks)),d==1?l:0,d==a.childCount?p:-1)))}let g=d==a.childCount;g||(p=-1),this.placed=ul(this.placed,i,B.from(c)),this.frontier[i].match=u,g&&p<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let f=0,m=a;f<p;f++){let C=m.lastChild;this.frontier.push({type:C.type,match:C.contentMatchAt(C.childCount)}),m=C.content}this.unplaced=g?t==0?J.empty:new J(cl(r.content,t-1,1),t-1,p<0?r.openEnd:t-1):new J(cl(r.content,t,d),r.openStart,r.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let t=this.frontier[this.depth],i;if(!t.type.isTextblock||!sf(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(i=this.findCloseLevel(this.$to))&&i.depth==this.depth)return-1;let{depth:n}=this.$to,s=this.$to.after(n);for(;n>1&&s==this.$to.end(--n);)++s;return s}findCloseLevel(t){e:for(let i=Math.min(this.depth,t.depth);i>=0;i--){let{match:n,type:s}=this.frontier[i],o=i<t.depth&&t.end(i+1)==t.pos+(t.depth-(i+1)),r=sf(t,i,s,n,o);if(r){for(let a=i-1;a>=0;a--){let{match:l,type:d}=this.frontier[a],c=sf(t,a,d,l,!0);if(!c||c.childCount)continue e}return{depth:i,fit:r,move:o?t.doc.resolve(t.after(i+1)):t}}}}close(t){let i=this.findCloseLevel(t);if(!i)return null;for(;this.depth>i.depth;)this.closeFrontierNode();i.fit.childCount&&(this.placed=ul(this.placed,i.depth,i.fit)),t=i.move;for(let n=i.depth+1;n<=t.depth;n++){let s=t.node(n),o=s.type.contentMatch.fillBefore(s.content,!0,t.index(n));this.openFrontierNode(s.type,s.attrs,o)}return t}openFrontierNode(t,i=null,n){let s=this.frontier[this.depth];s.match=s.match.matchType(t),this.placed=ul(this.placed,this.depth,B.from(t.create(i,n))),this.frontier.push({type:t,match:t.contentMatch})}closeFrontierNode(){let i=this.frontier.pop().match.fillBefore(B.empty,!0);i.childCount&&(this.placed=ul(this.placed,this.frontier.length,i))}};function cl(e,t,i){return t==0?e.cutByIndex(i,e.childCount):e.replaceChild(0,e.firstChild.copy(cl(e.firstChild.content,t-1,i)))}function ul(e,t,i){return t==0?e.append(i):e.replaceChild(e.childCount-1,e.lastChild.copy(ul(e.lastChild.content,t-1,i)))}function nf(e,t){for(let i=0;i<t;i++)e=e.firstChild.content;return e}function ey(e,t,i){if(t<=0)return e;let n=e.content;return t>1&&(n=n.replaceChild(0,ey(n.firstChild,t-1,n.childCount==1?i-1:0))),t>0&&(n=e.type.contentMatch.fillBefore(n).append(n),i<=0&&(n=n.append(e.type.contentMatch.matchFragment(n).fillBefore(B.empty,!0)))),e.copy(n)}function sf(e,t,i,n,s){let o=e.node(t),r=s?e.indexAfter(t):e.index(t);if(r==o.childCount&&!i.compatibleContent(o.type))return null;let a=n.fillBefore(o.content,!0,r);return a&&!MP(i,o.content,r)?a:null}function MP(e,t,i){for(let n=i;n<t.childCount;n++)if(!e.allowsMarks(t.child(n).marks))return!0;return!1}function DP(e){return e.spec.defining||e.spec.definingForContent}function kP(e,t,i,n){if(!n.size)return e.deleteRange(t,i);let s=e.doc.resolve(t),o=e.doc.resolve(i);if(Zb(s,o,n))return e.step(new Zt(t,i,n));let r=iy(s,o);r[r.length-1]==0&&r.pop();let a=-(s.depth+1);r.unshift(a);for(let h=s.depth,p=s.pos-1;h>0;h--,p--){let g=s.node(h).type.spec;if(g.defining||g.definingAsContext||g.isolating)break;r.indexOf(h)>-1?a=h:s.before(h)==p&&r.splice(1,0,-h)}let l=r.indexOf(a),d=[],c=n.openStart;for(let h=n.content,p=0;;p++){let g=h.firstChild;if(d.push(g),p==n.openStart)break;h=g.content}for(let h=c-1;h>=0;h--){let p=d[h],g=DP(p.type);if(g&&!p.sameMarkup(s.node(Math.abs(a)-1)))c=h;else if(g||!p.type.isTextblock)break}for(let h=n.openStart;h>=0;h--){let p=(h+c+1)%(n.openStart+1),g=d[p];if(g)for(let f=0;f<r.length;f++){let m=r[(f+l)%r.length],C=!0;m<0&&(C=!1,m=-m);let v=s.node(m-1),w=s.index(m-1);if(v.canReplaceWith(w,w,g.type,g.marks))return e.replace(s.before(m),C?o.after(m):i,new J(ty(n.content,0,n.openStart,p),p,n.openEnd))}}let u=e.steps.length;for(let h=r.length-1;h>=0&&(e.replace(t,i,n),!(e.steps.length>u));h--){let p=r[h];p<0||(t=s.before(p),i=o.after(p))}}function ty(e,t,i,n,s){if(t<i){let o=e.firstChild;e=e.replaceChild(0,o.copy(ty(o.content,t+1,i,n,o)))}if(t>n){let o=s.contentMatchAt(0),r=o.fillBefore(e).append(e);e=r.append(o.matchFragment(r).fillBefore(B.empty,!0))}return e}function PP(e,t,i,n){if(!n.isInline&&t==i&&e.doc.resolve(t).parent.content.size){let s=RP(e.doc,t,n.type);s!=null&&(t=i=s)}e.replaceRange(t,i,new J(B.from(n),0,0))}function FP(e,t,i){let n=e.doc.resolve(t),s=e.doc.resolve(i),o=iy(n,s);for(let r=0;r<o.length;r++){let a=o[r],l=r==o.length-1;if(l&&a==0||n.node(a).type.contentMatch.validEnd)return e.delete(n.start(a),s.end(a));if(a>0&&(l||n.node(a-1).canReplace(n.index(a-1),s.indexAfter(a-1))))return e.delete(n.before(a),s.after(a))}for(let r=1;r<=n.depth&&r<=s.depth;r++)if(t-n.start(r)==n.depth-r&&i>n.end(r)&&s.end(r)-i!=s.depth-r&&n.start(r-1)==s.start(r-1)&&n.node(r-1).canReplace(n.index(r-1),s.index(r-1)))return e.delete(n.before(r),i);e.delete(t,i)}function iy(e,t){let i=[],n=Math.min(e.depth,t.depth);for(let s=n;s>=0;s--){let o=e.start(s);if(o<e.pos-(e.depth-s)||t.end(s)>t.pos+(t.depth-s)||e.node(s).type.spec.isolating||t.node(s).type.spec.isolating)break;(o==t.start(s)||s==e.depth&&s==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&s&&t.start(s-1)==o-1)&&i.push(s)}return i}var xc=class e extends Ot{constructor(t,i,n){super(),this.pos=t,this.attr=i,this.value=n}apply(t){let i=t.nodeAt(this.pos);if(!i)return Gt.fail("No node at attribute step's position");let n=Object.create(null);for(let o in i.attrs)n[o]=i.attrs[o];n[this.attr]=this.value;let s=i.type.create(n,null,i.marks);return Gt.fromReplace(t,this.pos,this.pos+1,new J(B.from(s),0,i.isLeaf?0:1))}getMap(){return Kn.empty}invert(t){return new e(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let i=t.mapResult(this.pos,1);return i.deletedAfter?null:new e(i.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,i){if(typeof i.pos!="number"||typeof i.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new e(i.pos,i.attr,i.value)}};Ot.jsonID("attr",xc);var Ec=class e extends Ot{constructor(t,i){super(),this.attr=t,this.value=i}apply(t){let i=Object.create(null);for(let s in t.attrs)i[s]=t.attrs[s];i[this.attr]=this.value;let n=t.type.create(i,t.content,t.marks);return Gt.ok(n)}getMap(){return Kn.empty}invert(t){return new e(this.attr,t.attrs[this.attr])}map(t){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(t,i){if(typeof i.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new e(i.attr,i.value)}};Ot.jsonID("docAttr",Ec);var Hr=class extends Error{};Hr=function e(t){let i=Error.call(this,t);return i.__proto__=e.prototype,i};Hr.prototype=Object.create(Error.prototype);Hr.prototype.constructor=Hr;Hr.prototype.name="TransformError";var Vr=class{constructor(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new pl}get before(){return this.docs.length?this.docs[0]:this.doc}step(t){let i=this.maybeStep(t);if(i.failed)throw new Hr(i.failed);return this}maybeStep(t){let i=t.apply(this.doc);return i.failed||this.addStep(t,i.doc),i}get docChanged(){return this.steps.length>0}addStep(t,i){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=i}replace(t,i=t,n=J.empty){let s=ml(this.doc,t,i,n);return s&&this.step(s),this}replaceWith(t,i,n){return this.replace(t,i,new J(B.from(n),0,0))}delete(t,i){return this.replace(t,i,J.empty)}insert(t,i){return this.replaceWith(t,t,i)}replaceRange(t,i,n){return kP(this,t,i,n),this}replaceRangeWith(t,i,n){return PP(this,t,i,n),this}deleteRange(t,i){return FP(this,t,i),this}lift(t,i){return fP(this,t,i),this}join(t,i=1){return EP(this,t,i),this}wrap(t,i){return vP(this,t,i),this}setBlockType(t,i=t,n,s=null){return wP(this,t,i,n,s),this}setNodeMarkup(t,i,n=null,s){return yP(this,t,i,n,s),this}setNodeAttribute(t,i,n){return this.step(new xc(t,i,n)),this}setDocAttribute(t,i){return this.step(new Ec(t,i)),this}addNodeMark(t,i){return this.step(new fl(t,i)),this}removeNodeMark(t,i){let n=this.doc.nodeAt(t);if(!n)throw new RangeError("No node at position "+t);if(i instanceof Ue)i.isInSet(n.marks)&&this.step(new Br(t,i));else{let s=n.marks,o,r=[];for(;o=i.isInSet(s);)r.push(new Br(t,o)),s=o.removeFromSet(s);for(let a=r.length-1;a>=0;a--)this.step(r[a])}return this}split(t,i=1,n){return SP(this,t,i,n),this}addMark(t,i,n){return hP(this,t,i,n),this}removeMark(t,i,n){return pP(this,t,i,n),this}clearIncompatible(t,i,n){return lf(this,t,i,n),this}};var df=Object.create(null),ge=class{constructor(t,i,n){this.$anchor=t,this.$head=i,this.ranges=n||[new Dc(t.min(i),t.max(i))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let t=this.ranges;for(let i=0;i<t.length;i++)if(t[i].$from.pos!=t[i].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(t,i=J.empty){let n=i.content.lastChild,s=null;for(let a=0;a<i.openEnd;a++)s=n,n=n.lastChild;let o=t.steps.length,r=this.ranges;for(let a=0;a<r.length;a++){let{$from:l,$to:d}=r[a],c=t.mapping.slice(o);t.replaceRange(c.map(l.pos),c.map(d.pos),a?J.empty:i),a==0&&oy(t,o,(n?n.isInline:s&&s.isTextblock)?-1:1)}}replaceWith(t,i){let n=t.steps.length,s=this.ranges;for(let o=0;o<s.length;o++){let{$from:r,$to:a}=s[o],l=t.mapping.slice(n),d=l.map(r.pos),c=l.map(a.pos);o?t.deleteRange(d,c):(t.replaceRangeWith(d,c,i),oy(t,n,i.isInline?-1:1))}}static findFrom(t,i,n=!1){let s=t.parent.inlineContent?new le(t):zr(t.node(0),t.parent,t.pos,t.index(),i,n);if(s)return s;for(let o=t.depth-1;o>=0;o--){let r=i<0?zr(t.node(0),t.node(o),t.before(o+1),t.index(o),i,n):zr(t.node(0),t.node(o),t.after(o+1),t.index(o)+1,i,n);if(r)return r}return null}static near(t,i=1){return this.findFrom(t,i)||this.findFrom(t,-i)||new di(t.node(0))}static atStart(t){return zr(t,t,0,0,1)||new di(t)}static atEnd(t){return zr(t,t,t.content.size,t.childCount,-1)||new di(t)}static fromJSON(t,i){if(!i||!i.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=df[i.type];if(!n)throw new RangeError(`No selection type ${i.type} defined`);return n.fromJSON(t,i)}static jsonID(t,i){if(t in df)throw new RangeError("Duplicate use of selection JSON ID "+t);return df[t]=i,i.prototype.jsonID=t,i}getBookmark(){return le.between(this.$anchor,this.$head).getBookmark()}};ge.prototype.visible=!0;var Dc=class{constructor(t,i){this.$from=t,this.$to=i}},ny=!1;function sy(e){!ny&&!e.parent.inlineContent&&(ny=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}var le=class e extends ge{constructor(t,i=t){sy(t),sy(i),super(t,i)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(t,i){let n=t.resolve(i.map(this.head));if(!n.parent.inlineContent)return ge.near(n);let s=t.resolve(i.map(this.anchor));return new e(s.parent.inlineContent?s:n,n)}replace(t,i=J.empty){if(super.replace(t,i),i==J.empty){let n=this.$from.marksAcross(this.$to);n&&t.ensureMarks(n)}}eq(t){return t instanceof e&&t.anchor==this.anchor&&t.head==this.head}getBookmark(){return new kc(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(t,i){if(typeof i.anchor!="number"||typeof i.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new e(t.resolve(i.anchor),t.resolve(i.head))}static create(t,i,n=i){let s=t.resolve(i);return new this(s,n==i?s:t.resolve(n))}static between(t,i,n){let s=t.pos-i.pos;if((!n||s)&&(n=s>=0?1:-1),!i.parent.inlineContent){let o=ge.findFrom(i,n,!0)||ge.findFrom(i,-n,!0);if(o)i=o.$head;else return ge.near(i,n)}return t.parent.inlineContent||(s==0?t=i:(t=(ge.findFrom(t,-n,!0)||ge.findFrom(t,n,!0)).$anchor,t.pos<i.pos!=s<0&&(t=i))),new e(t,i)}};ge.jsonID("text",le);var kc=class e{constructor(t,i){this.anchor=t,this.head=i}map(t){return new e(t.map(this.anchor),t.map(this.head))}resolve(t){return le.between(t.resolve(this.anchor),t.resolve(this.head))}},ne=class e extends ge{constructor(t){let i=t.nodeAfter,n=t.node(0).resolve(t.pos+i.nodeSize);super(t,n),this.node=i}map(t,i){let{deleted:n,pos:s}=i.mapResult(this.anchor),o=t.resolve(s);return n?ge.near(o):new e(o)}content(){return new J(B.from(this.node),0,0)}eq(t){return t instanceof e&&t.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new uf(this.anchor)}static fromJSON(t,i){if(typeof i.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new e(t.resolve(i.anchor))}static create(t,i){return new e(t.resolve(i))}static isSelectable(t){return!t.isText&&t.type.spec.selectable!==!1}};ne.prototype.visible=!1;ge.jsonID("node",ne);var uf=class e{constructor(t){this.anchor=t}map(t){let{deleted:i,pos:n}=t.mapResult(this.anchor);return i?new kc(n,n):new e(n)}resolve(t){let i=t.resolve(this.anchor),n=i.nodeAfter;return n&&ne.isSelectable(n)?new ne(i):ge.near(i)}},di=class e extends ge{constructor(t){super(t.resolve(0),t.resolve(t.content.size))}replace(t,i=J.empty){if(i==J.empty){t.delete(0,t.doc.content.size);let n=ge.atStart(t.doc);n.eq(t.selection)||t.setSelection(n)}else super.replace(t,i)}toJSON(){return{type:"all"}}static fromJSON(t){return new e(t)}map(t){return new e(t)}eq(t){return t instanceof e}getBookmark(){return TP}};ge.jsonID("all",di);var TP={map(){return this},resolve(e){return new di(e)}};function zr(e,t,i,n,s,o=!1){if(t.inlineContent)return le.create(e,i);for(let r=n-(s>0?0:1);s>0?r<t.childCount:r>=0;r+=s){let a=t.child(r);if(a.isAtom){if(!o&&ne.isSelectable(a))return ne.create(e,i-(s<0?a.nodeSize:0))}else{let l=zr(e,a,i+s,s<0?a.childCount:0,s,o);if(l)return l}i+=a.nodeSize*s}return null}function oy(e,t,i){let n=e.steps.length-1;if(n<t)return;let s=e.steps[n];if(!(s instanceof Zt||s instanceof Et))return;let o=e.mapping.maps[n],r;o.forEach((a,l,d,c)=>{r==null&&(r=c)}),e.setSelection(ge.near(e.doc.resolve(r),i))}var ry=1,Mc=2,ay=4,hf=class extends Vr{constructor(t){super(t.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=t.selection,this.storedMarks=t.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=(this.updated|ry)&~Mc,this.storedMarks=null,this}get selectionSet(){return(this.updated&ry)>0}setStoredMarks(t){return this.storedMarks=t,this.updated|=Mc,this}ensureMarks(t){return Ue.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this}addStoredMark(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Mc)>0}addStep(t,i){super.addStep(t,i),this.updated=this.updated&~Mc,this.storedMarks=null}setTime(t){return this.time=t,this}replaceSelection(t){return this.selection.replace(this,t),this}replaceSelectionWith(t,i=!0){let n=this.selection;return i&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||Ue.none))),n.replaceWith(this,t),this}deleteSelection(){return this.selection.replace(this),this}insertText(t,i,n){let s=this.doc.type.schema;if(i==null)return t?this.replaceSelectionWith(s.text(t),!0):this.deleteSelection();{if(n==null&&(n=i),!t)return this.deleteRange(i,n);let o=this.storedMarks;if(!o){let r=this.doc.resolve(i);o=n==i?r.marks():r.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(i,n,s.text(t,o)),!this.selection.empty&&this.selection.to==i+t.length&&this.setSelection(ge.near(this.selection.$to)),this}}setMeta(t,i){return this.meta[typeof t=="string"?t:t.key]=i,this}getMeta(t){return this.meta[typeof t=="string"?t:t.key]}get isGeneric(){for(let t in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=ay,this}get scrolledIntoView(){return(this.updated&ay)>0}};function ly(e,t){return!t||!e?e:e.bind(t)}var To=class{constructor(t,i,n){this.name=t,this.init=ly(i.init,n),this.apply=ly(i.apply,n)}},AP=[new To("doc",{init(e){return e.doc||e.schema.topNodeType.createAndFill()},apply(e){return e.doc}}),new To("selection",{init(e,t){return e.selection||ge.atStart(t.doc)},apply(e){return e.selection}}),new To("storedMarks",{init(e){return e.storedMarks||null},apply(e,t,i,n){return n.selection.$cursor?e.storedMarks:null}}),new To("scrollToSelection",{init(){return 0},apply(e,t){return e.scrolledIntoView?t+1:t}})],Cl=class{constructor(t,i){this.schema=t,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=AP.slice(),i&&i.forEach(n=>{if(this.pluginsByKey[n.key])throw new RangeError("Adding different instances of a keyed plugin ("+n.key+")");this.plugins.push(n),this.pluginsByKey[n.key]=n,n.spec.state&&this.fields.push(new To(n.key,n.spec.state,n))})}},Pc=class e{constructor(t){this.config=t}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(t){return this.applyTransaction(t).state}filterTransaction(t,i=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=i){let s=this.config.plugins[n];if(s.spec.filterTransaction&&!s.spec.filterTransaction.call(s,t,this))return!1}return!0}applyTransaction(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};let i=[t],n=this.applyInner(t),s=null;for(;;){let o=!1;for(let r=0;r<this.config.plugins.length;r++){let a=this.config.plugins[r];if(a.spec.appendTransaction){let l=s?s[r].n:0,d=s?s[r].state:this,c=l<i.length&&a.spec.appendTransaction.call(a,l?i.slice(l):i,d,n);if(c&&n.filterTransaction(c,r)){if(c.setMeta("appendedTransaction",t),!s){s=[];for(let u=0;u<this.config.plugins.length;u++)s.push(u<r?{state:n,n:i.length}:{state:this,n:0})}i.push(c),n=n.applyInner(c),o=!0}s&&(s[r]={state:n,n:i.length})}}if(!o)return{state:n,transactions:i}}}applyInner(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let i=new e(this.config),n=this.config.fields;for(let s=0;s<n.length;s++){let o=n[s];i[o.name]=o.apply(t,this[o.name],this,i)}return i}get tr(){return new hf(this)}static create(t){let i=new Cl(t.doc?t.doc.type.schema:t.schema,t.plugins),n=new e(i);for(let s=0;s<i.fields.length;s++)n[i.fields[s].name]=i.fields[s].init(t,n);return n}reconfigure(t){let i=new Cl(this.schema,t.plugins),n=i.fields,s=new e(i);for(let o=0;o<n.length;o++){let r=n[o].name;s[r]=this.hasOwnProperty(r)?this[r]:n[o].init(t,s)}return s}toJSON(t){let i={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(i.storedMarks=this.storedMarks.map(n=>n.toJSON())),t&&typeof t=="object")for(let n in t){if(n=="doc"||n=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let s=t[n],o=s.spec.state;o&&o.toJSON&&(i[n]=o.toJSON.call(s,this[s.key]))}return i}static fromJSON(t,i,n){if(!i)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");let s=new Cl(t.schema,t.plugins),o=new e(s);return s.fields.forEach(r=>{if(r.name=="doc")o.doc=Ci.fromJSON(t.schema,i.doc);else if(r.name=="selection")o.selection=ge.fromJSON(o.doc,i.selection);else if(r.name=="storedMarks")i.storedMarks&&(o.storedMarks=i.storedMarks.map(t.schema.markFromJSON));else{if(n)for(let a in n){let l=n[a],d=l.spec.state;if(l.key==r.name&&d&&d.fromJSON&&Object.prototype.hasOwnProperty.call(i,a)){o[r.name]=d.fromJSON.call(l,t,i[a],o);return}}o[r.name]=r.init(t,o)}}),o}};function dy(e,t,i){for(let n in e){let s=e[n];s instanceof Function?s=s.bind(t):n=="handleDOMEvents"&&(s=dy(s,t,{})),i[n]=s}return i}var fe=class{constructor(t){this.spec=t,this.props={},t.props&&dy(t.props,this,this.props),this.key=t.key?t.key.key:cy("plugin")}getState(t){return t[this.key]}},cf=Object.create(null);function cy(e){return e in cf?e+"$"+ ++cf[e]:(cf[e]=0,e+"$")}var Me=class{constructor(t="key"){this.key=cy(t)}get(t){return t.config.pluginsByKey[this.key]}getState(t){return t[this.key]}};var Fc=(e,t)=>e.selection.empty?!1:(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function hy(e,t){let{$cursor:i}=e.selection;return!i||(t?!t.endOfTextblock("backward",e):i.parentOffset>0)?null:i}var gf=(e,t,i)=>{let n=hy(e,i);if(!n)return!1;let s=mf(n);if(!s){let r=n.blockRange(),a=r&&Xn(r);return a==null?!1:(t&&t(e.tr.lift(r,a).scrollIntoView()),!0)}let o=s.nodeBefore;if(yy(e,s,t,-1))return!0;if(n.parent.content.size==0&&(Wr(o,"end")||ne.isSelectable(o)))for(let r=n.depth;;r--){let a=ml(e.doc,n.before(r),n.after(r),J.empty);if(a&&a.slice.size<a.to-a.from){if(t){let l=e.tr.step(a);l.setSelection(Wr(o,"end")?ge.findFrom(l.doc.resolve(l.mapping.map(s.pos,-1)),-1):ne.create(l.doc,s.pos-o.nodeSize)),t(l.scrollIntoView())}return!0}if(r==1||n.node(r-1).childCount>1)break}return o.isAtom&&s.depth==n.depth-1?(t&&t(e.tr.delete(s.pos-o.nodeSize,s.pos).scrollIntoView()),!0):!1},py=(e,t,i)=>{let n=hy(e,i);if(!n)return!1;let s=mf(n);return s?fy(e,s,t):!1},gy=(e,t,i)=>{let n=my(e,i);if(!n)return!1;let s=wf(n);return s?fy(e,s,t):!1};function fy(e,t,i){let n=t.nodeBefore,s=n,o=t.pos-1;for(;!s.isTextblock;o--){if(s.type.spec.isolating)return!1;let c=s.lastChild;if(!c)return!1;s=c}let r=t.nodeAfter,a=r,l=t.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let c=a.firstChild;if(!c)return!1;a=c}let d=ml(e.doc,o,l,J.empty);if(!d||d.from!=o||d instanceof Zt&&d.slice.size>=l-o)return!1;if(i){let c=e.tr.step(d);c.setSelection(le.create(c.doc,o)),i(c.scrollIntoView())}return!0}function Wr(e,t,i=!1){for(let n=e;n;n=t=="start"?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(i&&n.childCount!=1)return!1}return!1}var ff=(e,t,i)=>{let{$head:n,empty:s}=e.selection,o=n;if(!s)return!1;if(n.parent.isTextblock){if(i?!i.endOfTextblock("backward",e):n.parentOffset>0)return!1;o=mf(n)}let r=o&&o.nodeBefore;return!r||!ne.isSelectable(r)?!1:(t&&t(e.tr.setSelection(ne.create(e.doc,o.pos-r.nodeSize)).scrollIntoView()),!0)};function mf(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function my(e,t){let{$cursor:i}=e.selection;return!i||(t?!t.endOfTextblock("forward",e):i.parentOffset<i.parent.content.size)?null:i}var Cf=(e,t,i)=>{let n=my(e,i);if(!n)return!1;let s=wf(n);if(!s)return!1;let o=s.nodeAfter;if(yy(e,s,t,1))return!0;if(n.parent.content.size==0&&(Wr(o,"start")||ne.isSelectable(o))){let r=ml(e.doc,n.before(),n.after(),J.empty);if(r&&r.slice.size<r.to-r.from){if(t){let a=e.tr.step(r);a.setSelection(Wr(o,"start")?ge.findFrom(a.doc.resolve(a.mapping.map(s.pos)),1):ne.create(a.doc,a.mapping.map(s.pos))),t(a.scrollIntoView())}return!0}}return o.isAtom&&s.depth==n.depth-1?(t&&t(e.tr.delete(s.pos,s.pos+o.nodeSize).scrollIntoView()),!0):!1},vf=(e,t,i)=>{let{$head:n,empty:s}=e.selection,o=n;if(!s)return!1;if(n.parent.isTextblock){if(i?!i.endOfTextblock("forward",e):n.parentOffset<n.parent.content.size)return!1;o=wf(n)}let r=o&&o.nodeAfter;return!r||!ne.isSelectable(r)?!1:(t&&t(e.tr.setSelection(ne.create(e.doc,o.pos)).scrollIntoView()),!0)};function wf(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let i=e.node(t);if(e.index(t)+1<i.childCount)return e.doc.resolve(e.after(t+1));if(i.type.spec.isolating)break}return null}var Cy=(e,t)=>{let i=e.selection,n=i instanceof ne,s;if(n){if(i.node.isTextblock||!_i(e.doc,i.from))return!1;s=i.from}else if(s=Fo(e.doc,i.from,-1),s==null)return!1;if(t){let o=e.tr.join(s);n&&o.setSelection(ne.create(o.doc,s-e.doc.resolve(s).nodeBefore.nodeSize)),t(o.scrollIntoView())}return!0},vy=(e,t)=>{let i=e.selection,n;if(i instanceof ne){if(i.node.isTextblock||!_i(e.doc,i.to))return!1;n=i.to}else if(n=Fo(e.doc,i.to,1),n==null)return!1;return t&&t(e.tr.join(n).scrollIntoView()),!0},wy=(e,t)=>{let{$from:i,$to:n}=e.selection,s=i.blockRange(n),o=s&&Xn(s);return o==null?!1:(t&&t(e.tr.lift(s,o).scrollIntoView()),!0)},bf=(e,t)=>{let{$head:i,$anchor:n}=e.selection;return!i.parent.type.spec.code||!i.sameParent(n)?!1:(t&&t(e.tr.insertText(`
`).scrollIntoView()),!0)};function yf(e){for(let t=0;t<e.edgeCount;t++){let{type:i}=e.edge(t);if(i.isTextblock&&!i.hasRequiredAttrs())return i}return null}var Sf=(e,t)=>{let{$head:i,$anchor:n}=e.selection;if(!i.parent.type.spec.code||!i.sameParent(n))return!1;let s=i.node(-1),o=i.indexAfter(-1),r=yf(s.contentMatchAt(o));if(!r||!s.canReplaceWith(o,o,r))return!1;if(t){let a=i.after(),l=e.tr.replaceWith(a,a,r.createAndFill());l.setSelection(ge.near(l.doc.resolve(a),1)),t(l.scrollIntoView())}return!0},xf=(e,t)=>{let i=e.selection,{$from:n,$to:s}=i;if(i instanceof di||n.parent.inlineContent||s.parent.inlineContent)return!1;let o=yf(s.parent.contentMatchAt(s.indexAfter()));if(!o||!o.isTextblock)return!1;if(t){let r=(!n.parentOffset&&s.index()<s.parent.childCount?n:s).pos,a=e.tr.insert(r,o.createAndFill());a.setSelection(le.create(a.doc,r+1)),t(a.scrollIntoView())}return!0},Ef=(e,t)=>{let{$cursor:i}=e.selection;if(!i||i.parent.content.size)return!1;if(i.depth>1&&i.after()!=i.end(-1)){let o=i.before();if(Ri(e.doc,o))return t&&t(e.tr.split(o).scrollIntoView()),!0}let n=i.blockRange(),s=n&&Xn(n);return s==null?!1:(t&&t(e.tr.lift(n,s).scrollIntoView()),!0)};function IP(e){return(t,i)=>{let{$from:n,$to:s}=t.selection;if(t.selection instanceof ne&&t.selection.node.isBlock)return!n.parentOffset||!Ri(t.doc,n.pos)?!1:(i&&i(t.tr.split(n.pos).scrollIntoView()),!0);if(!n.depth)return!1;let o=[],r,a,l=!1,d=!1;for(let p=n.depth;;p--)if(n.node(p).isBlock){l=n.end(p)==n.pos+(n.depth-p),d=n.start(p)==n.pos-(n.depth-p),a=yf(n.node(p-1).contentMatchAt(n.indexAfter(p-1)));let f=e&&e(s.parent,l,n);o.unshift(f||(l&&a?{type:a}:null)),r=p;break}else{if(p==1)return!1;o.unshift(null)}let c=t.tr;(t.selection instanceof le||t.selection instanceof di)&&c.deleteSelection();let u=c.mapping.map(n.pos),h=Ri(c.doc,u,o.length,o);if(h||(o[0]=a?{type:a}:null,h=Ri(c.doc,u,o.length,o)),!h)return!1;if(c.split(u,o.length,o),!l&&d&&n.node(r).type!=a){let p=c.mapping.map(n.before(r)),g=c.doc.resolve(p);a&&n.node(r-1).canReplaceWith(g.index(),g.index()+1,a)&&c.setNodeMarkup(c.mapping.map(n.before(r)),a)}return i&&i(c.scrollIntoView()),!0}}var _P=IP();var by=(e,t)=>{let{$from:i,to:n}=e.selection,s,o=i.sharedDepth(n);return o==0?!1:(s=i.before(o),t&&t(e.tr.setSelection(ne.create(e.doc,s))),!0)},LP=(e,t)=>(t&&t(e.tr.setSelection(new di(e.doc))),!0);function OP(e,t,i){let n=t.nodeBefore,s=t.nodeAfter,o=t.index();return!n||!s||!n.type.compatibleContent(s.type)?!1:!n.content.size&&t.parent.canReplace(o-1,o)?(i&&i(e.tr.delete(t.pos-n.nodeSize,t.pos).scrollIntoView()),!0):!t.parent.canReplace(o,o+1)||!(s.isTextblock||_i(e.doc,t.pos))?!1:(i&&i(e.tr.join(t.pos).scrollIntoView()),!0)}function yy(e,t,i,n){let s=t.nodeBefore,o=t.nodeAfter,r,a,l=s.type.spec.isolating||o.type.spec.isolating;if(!l&&OP(e,t,i))return!0;let d=!l&&t.parent.canReplace(t.index(),t.index()+1);if(d&&(r=(a=s.contentMatchAt(s.childCount)).findWrapping(o.type))&&a.matchType(r[0]||o.type).validEnd){if(i){let p=t.pos+o.nodeSize,g=B.empty;for(let C=r.length-1;C>=0;C--)g=B.from(r[C].create(null,g));g=B.from(s.copy(g));let f=e.tr.step(new Et(t.pos-1,p,t.pos,p,new J(g,1,0),r.length,!0)),m=f.doc.resolve(p+2*r.length);m.nodeAfter&&m.nodeAfter.type==s.type&&_i(f.doc,m.pos)&&f.join(m.pos),i(f.scrollIntoView())}return!0}let c=o.type.spec.isolating||n>0&&l?null:ge.findFrom(t,1),u=c&&c.$from.blockRange(c.$to),h=u&&Xn(u);if(h!=null&&h>=t.depth)return i&&i(e.tr.lift(u,h).scrollIntoView()),!0;if(d&&Wr(o,"start",!0)&&Wr(s,"end")){let p=s,g=[];for(;g.push(p),!p.isTextblock;)p=p.lastChild;let f=o,m=1;for(;!f.isTextblock;f=f.firstChild)m++;if(p.canReplace(p.childCount,p.childCount,f.content)){if(i){let C=B.empty;for(let w=g.length-1;w>=0;w--)C=B.from(g[w].copy(C));let v=e.tr.step(new Et(t.pos-g.length,t.pos+o.nodeSize,t.pos+m,t.pos+o.nodeSize-m,new J(C,g.length,0),0,!0));i(v.scrollIntoView())}return!0}}return!1}function Sy(e){return function(t,i){let n=t.selection,s=e<0?n.$from:n.$to,o=s.depth;for(;s.node(o).isInline;){if(!o)return!1;o--}return s.node(o).isTextblock?(i&&i(t.tr.setSelection(le.create(t.doc,e<0?s.start(o):s.end(o)))),!0):!1}}var Rf=Sy(-1),Mf=Sy(1);function xy(e,t=null){return function(i,n){let{$from:s,$to:o}=i.selection,r=s.blockRange(o),a=r&&Gr(r,e,t);return a?(n&&n(i.tr.wrap(r,a).scrollIntoView()),!0):!1}}function Df(e,t=null){return function(i,n){let s=!1;for(let o=0;o<i.selection.ranges.length&&!s;o++){let{$from:{pos:r},$to:{pos:a}}=i.selection.ranges[o];i.doc.nodesBetween(r,a,(l,d)=>{if(s)return!1;if(!(!l.isTextblock||l.hasMarkup(e,t)))if(l.type==e)s=!0;else{let c=i.doc.resolve(d),u=c.index();s=c.parent.canReplaceWith(u,u+1,e)}})}if(!s)return!1;if(n){let o=i.tr;for(let r=0;r<i.selection.ranges.length;r++){let{$from:{pos:a},$to:{pos:l}}=i.selection.ranges[r];o.setBlockType(a,l,e,t)}n(o.scrollIntoView())}return!0}}function kf(...e){return function(t,i,n){for(let s=0;s<e.length;s++)if(e[s](t,i,n))return!0;return!1}}var pf=kf(Fc,gf,ff),uy=kf(Fc,Cf,vf),Is={Enter:kf(bf,xf,Ef,_P),"Mod-Enter":Sf,Backspace:pf,"Mod-Backspace":pf,"Shift-Backspace":pf,Delete:uy,"Mod-Delete":uy,"Mod-a":LP},NP={"Ctrl-h":Is.Backspace,"Alt-Backspace":Is["Mod-Backspace"],"Ctrl-d":Is.Delete,"Ctrl-Alt-Backspace":Is["Mod-Delete"],"Alt-Delete":Is["Mod-Delete"],"Alt-d":Is["Mod-Delete"],"Ctrl-a":Rf,"Ctrl-e":Mf};for(let e in Is)NP[e]=Is[e];var Loe=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform?os.platform()=="darwin":!1;function Ey(e,t=null){return function(i,n){let{$from:s,$to:o}=i.selection,r=s.blockRange(o);if(!r)return!1;let a=n?i.tr:null;return BP(a,r,e,t)?(n&&n(a.scrollIntoView()),!0):!1}}function BP(e,t,i,n=null){let s=!1,o=t,r=t.$from.doc;if(t.depth>=2&&t.$from.node(t.depth-1).type.compatibleContent(i)&&t.startIndex==0){if(t.$from.index(t.depth-1)==0)return!1;let l=r.resolve(t.start-2);o=new ko(l,l,t.depth),t.endIndex<t.parent.childCount&&(t=new ko(t.$from,r.resolve(t.$to.end(t.depth)),t.depth)),s=!0}let a=Gr(o,i,n,t);return a?(e&&HP(e,t,a,s,i),!0):!1}function HP(e,t,i,n,s){let o=B.empty;for(let c=i.length-1;c>=0;c--)o=B.from(i[c].type.create(i[c].attrs,o));e.step(new Et(t.start-(n?2:0),t.end,t.start,t.end,new J(o,0,0),i.length,!0));let r=0;for(let c=0;c<i.length;c++)i[c].type==s&&(r=c+1);let a=i.length-r,l=t.start+i.length-(n?2:0),d=t.parent;for(let c=t.startIndex,u=t.endIndex,h=!0;c<u;c++,h=!1)!h&&Ri(e.doc,l,a)&&(e.split(l,a),l+=2*a),l+=d.child(c).nodeSize;return e}function Ry(e){return function(t,i){let{$from:n,$to:s}=t.selection,o=n.blockRange(s,r=>r.childCount>0&&r.firstChild.type==e);return o?i?n.node(o.depth-1).type==e?VP(t,i,e,o):GP(t,i,o):!0:!1}}function VP(e,t,i,n){let s=e.tr,o=n.end,r=n.$to.end(n.depth);o<r&&(s.step(new Et(o-1,r,o,r,new J(B.from(i.create(null,n.parent.copy())),1,0),1,!0)),n=new ko(s.doc.resolve(n.$from.pos),s.doc.resolve(r),n.depth));let a=Xn(n);if(a==null)return!1;s.lift(n,a);let l=s.doc.resolve(s.mapping.map(o,-1)-1);return _i(s.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&s.join(l.pos),t(s.scrollIntoView()),!0}function GP(e,t,i){let n=e.tr,s=i.parent;for(let p=i.end,g=i.endIndex-1,f=i.startIndex;g>f;g--)p-=s.child(g).nodeSize,n.delete(p-1,p+1);let o=n.doc.resolve(i.start),r=o.nodeAfter;if(n.mapping.map(i.end)!=i.start+o.nodeAfter.nodeSize)return!1;let a=i.startIndex==0,l=i.endIndex==s.childCount,d=o.node(-1),c=o.index(-1);if(!d.canReplace(c+(a?0:1),c+1,r.content.append(l?B.empty:B.from(s))))return!1;let u=o.pos,h=u+r.nodeSize;return n.step(new Et(u-(a?1:0),h+(l?1:0),u+1,h-1,new J((a?B.empty:B.from(s.copy(B.empty))).append(l?B.empty:B.from(s.copy(B.empty))),a?0:1,l?0:1),a?0:1)),t(n.scrollIntoView()),!0}function My(e){return function(t,i){let{$from:n,$to:s}=t.selection,o=n.blockRange(s,d=>d.childCount>0&&d.firstChild.type==e);if(!o)return!1;let r=o.startIndex;if(r==0)return!1;let a=o.parent,l=a.child(r-1);if(l.type!=e)return!1;if(i){let d=l.lastChild&&l.lastChild.type==a.type,c=B.from(d?e.create():null),u=new J(B.from(e.create(null,B.from(a.type.create(null,c)))),d?3:1,0),h=o.start,p=o.end;i(t.tr.step(new Et(h-(d?3:1),p,h,p,u,1,!0)).scrollIntoView())}return!0}}var zt=function(e){for(var t=0;;t++)if(e=e.previousSibling,!e)return t},Kr=function(e){let t=e.assignedSlot||e.parentNode;return t&&t.nodeType==11?t.host:t},_f=null,Qn=function(e,t,i){let n=_f||(_f=document.createRange());return n.setEnd(e,i??e.nodeValue.length),n.setStart(e,t||0),n},zP=function(){_f=null},Bo=function(e,t,i,n){return i&&(Dy(e,t,i,n,-1)||Dy(e,t,i,n,1))},WP=/^(img|br|input|textarea|hr)$/i;function Dy(e,t,i,n,s){for(var o;;){if(e==i&&t==n)return!0;if(t==(s<0?0:Oi(e))){let r=e.parentNode;if(!r||r.nodeType!=1||Rl(e)||WP.test(e.nodeName)||e.contentEditable=="false")return!1;t=zt(e)+(s<0?0:1),e=r}else if(e.nodeType==1){let r=e.childNodes[t+(s<0?-1:0)];if(r.nodeType==1&&r.contentEditable=="false")if(!((o=r.pmViewDesc)===null||o===void 0)&&o.ignoreForSelection)t+=s;else return!1;else e=r,t=s<0?Oi(e):0}else return!1}}function Oi(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function UP(e,t){for(;;){if(e.nodeType==3&&t)return e;if(e.nodeType==1&&t>0){if(e.contentEditable=="false")return null;e=e.childNodes[t-1],t=Oi(e)}else if(e.parentNode&&!Rl(e))t=zt(e),e=e.parentNode;else return null}}function qP(e,t){for(;;){if(e.nodeType==3&&t<e.nodeValue.length)return e;if(e.nodeType==1&&t<e.childNodes.length){if(e.contentEditable=="false")return null;e=e.childNodes[t],t=0}else if(e.parentNode&&!Rl(e))t=zt(e)+1,e=e.parentNode;else return null}}function $P(e,t,i){for(let n=t==0,s=t==Oi(e);n||s;){if(e==i)return!0;let o=zt(e);if(e=e.parentNode,!e)return!1;n=n&&o==0,s=s&&o==Oi(e)}}function Rl(e){let t;for(let i=e;i&&!(t=i.pmViewDesc);i=i.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}var Gc=function(e){return e.focusNode&&Bo(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function Ao(e,t){let i=document.createEvent("Event");return i.initEvent("keydown",!0,!0),i.keyCode=e,i.key=i.code=t,i}function jP(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}function KP(e,t,i){if(e.caretPositionFromPoint)try{let n=e.caretPositionFromPoint(t,i);if(n)return{node:n.offsetNode,offset:Math.min(Oi(n.offsetNode),n.offset)}}catch{}if(e.caretRangeFromPoint){let n=e.caretRangeFromPoint(t,i);if(n)return{node:n.startContainer,offset:Math.min(Oi(n.startContainer),n.startOffset)}}}var Cn=typeof navigator<"u"?navigator:null,ky=typeof document<"u"?document:null,Hs=Cn&&Cn.userAgent||"",Lf=/Edge\/(\d+)/.exec(Hs),rS=/MSIE \d/.exec(Hs),Of=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Hs),vi=!!(rS||Of||Lf),Ns=rS?document.documentMode:Of?+Of[1]:Lf?+Lf[1]:0,Ni=!vi&&/gecko\/(\d+)/i.test(Hs);Ni&&+(/Firefox\/(\d+)/.exec(Hs)||[0,0])[1];var Nf=!vi&&/Chrome\/(\d+)/.exec(Hs),ti=!!Nf,aS=Nf?+Nf[1]:0,ci=!vi&&!!Cn&&/Apple Computer/.test(Cn.vendor),Yr=ci&&(/Mobile\/\w+/.test(Hs)||!!Cn&&Cn.maxTouchPoints>2),Li=Yr||(Cn?/Mac/.test(Cn.platform):!1),YP=Cn?/Win/.test(Cn.platform):!1,Zn=/Android \d/.test(Hs),Ml=!!ky&&"webkitFontSmoothing"in ky.documentElement.style,XP=Ml?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function JP(e){let t=e.defaultView&&e.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function Jn(e,t){return typeof e=="number"?e:e[t]}function QP(e){let t=e.getBoundingClientRect(),i=t.width/e.offsetWidth||1,n=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*i,top:t.top,bottom:t.top+e.clientHeight*n}}function Py(e,t,i){let n=e.someProp("scrollThreshold")||0,s=e.someProp("scrollMargin")||5,o=e.dom.ownerDocument;for(let r=i||e.dom;r;){if(r.nodeType!=1){r=Kr(r);continue}let a=r,l=a==o.body,d=l?JP(o):QP(a),c=0,u=0;if(t.top<d.top+Jn(n,"top")?u=-(d.top-t.top+Jn(s,"top")):t.bottom>d.bottom-Jn(n,"bottom")&&(u=t.bottom-t.top>d.bottom-d.top?t.top+Jn(s,"top")-d.top:t.bottom-d.bottom+Jn(s,"bottom")),t.left<d.left+Jn(n,"left")?c=-(d.left-t.left+Jn(s,"left")):t.right>d.right-Jn(n,"right")&&(c=t.right-d.right+Jn(s,"right")),c||u)if(l)o.defaultView.scrollBy(c,u);else{let p=a.scrollLeft,g=a.scrollTop;u&&(a.scrollTop+=u),c&&(a.scrollLeft+=c);let f=a.scrollLeft-p,m=a.scrollTop-g;t={left:t.left-f,top:t.top-m,right:t.right-f,bottom:t.bottom-m}}let h=l?"fixed":getComputedStyle(r).position;if(/^(fixed|sticky)$/.test(h))break;r=h=="absolute"?r.offsetParent:Kr(r)}}function ZP(e){let t=e.dom.getBoundingClientRect(),i=Math.max(0,t.top),n,s;for(let o=(t.left+t.right)/2,r=i+1;r<Math.min(innerHeight,t.bottom);r+=5){let a=e.root.elementFromPoint(o,r);if(!a||a==e.dom||!e.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=i-20){n=a,s=l.top;break}}return{refDOM:n,refTop:s,stack:lS(e.dom)}}function lS(e){let t=[],i=e.ownerDocument;for(let n=e;n&&(t.push({dom:n,top:n.scrollTop,left:n.scrollLeft}),e!=i);n=Kr(n));return t}function eF({refDOM:e,refTop:t,stack:i}){let n=e?e.getBoundingClientRect().top:0;dS(i,n==0?0:n-t)}function dS(e,t){for(let i=0;i<e.length;i++){let{dom:n,top:s,left:o}=e[i];n.scrollTop!=s+t&&(n.scrollTop=s+t),n.scrollLeft!=o&&(n.scrollLeft=o)}}var Ur=null;function tF(e){if(e.setActive)return e.setActive();if(Ur)return e.focus(Ur);let t=lS(e);e.focus(Ur==null?{get preventScroll(){return Ur={preventScroll:!0},!0}}:void 0),Ur||(Ur=!1,dS(t,0))}function cS(e,t){let i,n=2e8,s,o=0,r=t.top,a=t.top,l,d;for(let c=e.firstChild,u=0;c;c=c.nextSibling,u++){let h;if(c.nodeType==1)h=c.getClientRects();else if(c.nodeType==3)h=Qn(c).getClientRects();else continue;for(let p=0;p<h.length;p++){let g=h[p];if(g.top<=r&&g.bottom>=a){r=Math.max(g.bottom,r),a=Math.min(g.top,a);let f=g.left>t.left?g.left-t.left:g.right<t.left?t.left-g.right:0;if(f<n){i=c,n=f,s=f&&i.nodeType==3?{left:g.right<t.left?g.right:g.left,top:t.top}:t,c.nodeType==1&&f&&(o=u+(t.left>=(g.left+g.right)/2?1:0));continue}}else g.top>t.top&&!l&&g.left<=t.left&&g.right>=t.left&&(l=c,d={left:Math.max(g.left,Math.min(g.right,t.left)),top:g.top});!i&&(t.left>=g.right&&t.top>=g.top||t.left>=g.left&&t.top>=g.bottom)&&(o=u+1)}}return!i&&l&&(i=l,s=d,n=0),i&&i.nodeType==3?iF(i,s):!i||n&&i.nodeType==1?{node:e,offset:o}:cS(i,s)}function iF(e,t){let i=e.nodeValue.length,n=document.createRange();for(let s=0;s<i;s++){n.setEnd(e,s+1),n.setStart(e,s);let o=_s(n,1);if(o.top!=o.bottom&&Qf(t,o))return{node:e,offset:s+(t.left>=(o.left+o.right)/2?1:0)}}return{node:e,offset:0}}function Qf(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function nF(e,t){let i=e.parentNode;return i&&/^li$/i.test(i.nodeName)&&t.left<e.getBoundingClientRect().left?i:e}function sF(e,t,i){let{node:n,offset:s}=cS(t,i),o=-1;if(n.nodeType==1&&!n.firstChild){let r=n.getBoundingClientRect();o=r.left!=r.right&&i.left>(r.left+r.right)/2?1:-1}return e.docView.posFromDOM(n,s,o)}function oF(e,t,i,n){let s=-1;for(let o=t,r=!1;o!=e.dom;){let a=e.docView.nearestDesc(o,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(a.dom.nodeName)&&(!r&&l.left>n.left||l.top>n.top?s=a.posBefore:(!r&&l.right<n.left||l.bottom<n.top)&&(s=a.posAfter),r=!0),!a.contentDOM&&s<0&&!a.node.isText))return(a.node.isBlock?n.top<(l.top+l.bottom)/2:n.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;o=a.dom.parentNode}return s>-1?s:e.docView.posFromDOM(t,i,-1)}function uS(e,t,i){let n=e.childNodes.length;if(n&&i.top<i.bottom)for(let s=Math.max(0,Math.min(n-1,Math.floor(n*(t.top-i.top)/(i.bottom-i.top))-2)),o=s;;){let r=e.childNodes[o];if(r.nodeType==1){let a=r.getClientRects();for(let l=0;l<a.length;l++){let d=a[l];if(Qf(t,d))return uS(r,t,d)}}if((o=(o+1)%n)==s)break}return e}function rF(e,t){let i=e.dom.ownerDocument,n,s=0,o=KP(i,t.left,t.top);o&&({node:n,offset:s}=o);let r=(e.root.elementFromPoint?e.root:i).elementFromPoint(t.left,t.top),a;if(!r||!e.dom.contains(r.nodeType!=1?r.parentNode:r)){let d=e.dom.getBoundingClientRect();if(!Qf(t,d)||(r=uS(e.dom,t,d),!r))return null}if(ci)for(let d=r;n&&d;d=Kr(d))d.draggable&&(n=void 0);if(r=nF(r,t),n){if(Ni&&n.nodeType==1&&(s=Math.min(s,n.childNodes.length),s<n.childNodes.length)){let c=n.childNodes[s],u;c.nodeName=="IMG"&&(u=c.getBoundingClientRect()).right<=t.left&&u.bottom>t.top&&s++}let d;Ml&&s&&n.nodeType==1&&(d=n.childNodes[s-1]).nodeType==1&&d.contentEditable=="false"&&d.getBoundingClientRect().top>=t.top&&s--,n==e.dom&&s==n.childNodes.length-1&&n.lastChild.nodeType==1&&t.top>n.lastChild.getBoundingClientRect().bottom?a=e.state.doc.content.size:(s==0||n.nodeType!=1||n.childNodes[s-1].nodeName!="BR")&&(a=oF(e,n,s,t))}a==null&&(a=sF(e,r,t));let l=e.docView.nearestDesc(r,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function Fy(e){return e.top<e.bottom||e.left<e.right}function _s(e,t){let i=e.getClientRects();if(i.length){let n=i[t<0?0:i.length-1];if(Fy(n))return n}return Array.prototype.find.call(i,Fy)||e.getBoundingClientRect()}var aF=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function hS(e,t,i){let{node:n,offset:s,atom:o}=e.docView.domFromPos(t,i<0?-1:1),r=Ml||Ni;if(n.nodeType==3)if(r&&(aF.test(n.nodeValue)||(i<0?!s:s==n.nodeValue.length))){let l=_s(Qn(n,s,s),i);if(Ni&&s&&/\s/.test(n.nodeValue[s-1])&&s<n.nodeValue.length){let d=_s(Qn(n,s-1,s-1),-1);if(d.top==l.top){let c=_s(Qn(n,s,s+1),-1);if(c.top!=l.top)return vl(c,c.left<d.left)}}return l}else{let l=s,d=s,c=i<0?1:-1;return i<0&&!s?(d++,c=-1):i>=0&&s==n.nodeValue.length?(l--,c=1):i<0?l--:d++,vl(_s(Qn(n,l,d),c),c<0)}if(!e.state.doc.resolve(t-(o||0)).parent.inlineContent){if(o==null&&s&&(i<0||s==Oi(n))){let l=n.childNodes[s-1];if(l.nodeType==1)return Pf(l.getBoundingClientRect(),!1)}if(o==null&&s<Oi(n)){let l=n.childNodes[s];if(l.nodeType==1)return Pf(l.getBoundingClientRect(),!0)}return Pf(n.getBoundingClientRect(),i>=0)}if(o==null&&s&&(i<0||s==Oi(n))){let l=n.childNodes[s-1],d=l.nodeType==3?Qn(l,Oi(l)-(r?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(d)return vl(_s(d,1),!1)}if(o==null&&s<Oi(n)){let l=n.childNodes[s];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let d=l?l.nodeType==3?Qn(l,0,r?0:1):l.nodeType==1?l:null:null;if(d)return vl(_s(d,-1),!0)}return vl(_s(n.nodeType==3?Qn(n):n,-i),i>=0)}function vl(e,t){if(e.width==0)return e;let i=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:i,right:i}}function Pf(e,t){if(e.height==0)return e;let i=t?e.top:e.bottom;return{top:i,bottom:i,left:e.left,right:e.right}}function pS(e,t,i){let n=e.state,s=e.root.activeElement;n!=t&&e.updateState(t),s!=e.dom&&e.focus();try{return i()}finally{n!=t&&e.updateState(n),s!=e.dom&&s&&s.focus()}}function lF(e,t,i){let n=t.selection,s=i=="up"?n.$from:n.$to;return pS(e,t,()=>{let{node:o}=e.docView.domFromPos(s.pos,i=="up"?-1:1);for(;;){let a=e.docView.nearestDesc(o,!0);if(!a)break;if(a.node.isBlock){o=a.contentDOM||a.dom;break}o=a.dom.parentNode}let r=hS(e,s.pos,1);for(let a=o.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=Qn(a,0,a.nodeValue.length).getClientRects();else continue;for(let d=0;d<l.length;d++){let c=l[d];if(c.bottom>c.top+1&&(i=="up"?r.top-c.top>(c.bottom-r.top)*2:c.bottom-r.bottom>(r.bottom-c.top)*2))return!1}}return!0})}var dF=/[\u0590-\u08ac]/;function cF(e,t,i){let{$head:n}=t.selection;if(!n.parent.isTextblock)return!1;let s=n.parentOffset,o=!s,r=s==n.parent.content.size,a=e.domSelection();return a?!dF.test(n.parent.textContent)||!a.modify?i=="left"||i=="backward"?o:r:pS(e,t,()=>{let{focusNode:l,focusOffset:d,anchorNode:c,anchorOffset:u}=e.domSelectionRange(),h=a.caretBidiLevel;a.modify("move",i,"character");let p=n.depth?e.docView.domAfterPos(n.before()):e.dom,{focusNode:g,focusOffset:f}=e.domSelectionRange(),m=g&&!p.contains(g.nodeType==1?g:g.parentNode)||l==g&&d==f;try{a.collapse(c,u),l&&(l!=c||d!=u)&&a.extend&&a.extend(l,d)}catch{}return h!=null&&(a.caretBidiLevel=h),m}):n.pos==n.start()||n.pos==n.end()}var Ty=null,Ay=null,Iy=!1;function uF(e,t,i){return Ty==t&&Ay==i?Iy:(Ty=t,Ay=i,Iy=i=="up"||i=="down"?lF(e,t,i):cF(e,t,i))}var Bi=0,_y=1,Io=2,vn=3,Ho=class{constructor(t,i,n,s){this.parent=t,this.children=i,this.dom=n,this.contentDOM=s,this.dirty=Bi,n.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,i,n){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let i=0;i<this.children.length;i++)t+=this.children[i].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let i=0,n=this.posAtStart;;i++){let s=this.children[i];if(s==t)return n;n+=s.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,i,n){if(this.contentDOM&&this.contentDOM.contains(t.nodeType==1?t:t.parentNode))if(n<0){let o,r;if(t==this.contentDOM)o=t.childNodes[i-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;o=t.previousSibling}for(;o&&!((r=o.pmViewDesc)&&r.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(r)+r.size:this.posAtStart}else{let o,r;if(t==this.contentDOM)o=t.childNodes[i];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;o=t.nextSibling}for(;o&&!((r=o.pmViewDesc)&&r.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(r):this.posAtEnd}let s;if(t==this.dom&&this.contentDOM)s=i>zt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=t.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(i==0)for(let o=t;;o=o.parentNode){if(o==this.dom){s=!1;break}if(o.previousSibling)break}if(s==null&&i==t.childNodes.length)for(let o=t;;o=o.parentNode){if(o==this.dom){s=!0;break}if(o.nextSibling)break}}return s??n>0?this.posAtEnd:this.posAtStart}nearestDesc(t,i=!1){for(let n=!0,s=t;s;s=s.parentNode){let o=this.getDesc(s),r;if(o&&(!i||o.node))if(n&&(r=o.nodeDOM)&&!(r.nodeType==1?r.contains(t.nodeType==1?t:t.parentNode):r==t))n=!1;else return o}}getDesc(t){let i=t.pmViewDesc;for(let n=i;n;n=n.parent)if(n==this)return i}posFromDOM(t,i,n){for(let s=t;s;s=s.parentNode){let o=this.getDesc(s);if(o)return o.localPosFromDOM(t,i,n)}return-1}descAt(t){for(let i=0,n=0;i<this.children.length;i++){let s=this.children[i],o=n+s.size;if(n==t&&o!=n){for(;!s.border&&s.children.length;)for(let r=0;r<s.children.length;r++){let a=s.children[r];if(a.size){s=a;break}}return s}if(t<o)return s.descAt(t-n-s.border);n=o}}domFromPos(t,i){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let n=0,s=0;for(let o=0;n<this.children.length;n++){let r=this.children[n],a=o+r.size;if(a>t||r instanceof Ic){s=t-o;break}o=a}if(s)return this.children[n].domFromPos(s-this.children[n].border,i);for(let o;n&&!(o=this.children[n-1]).size&&o instanceof Tc&&o.side>=0;n--);if(i<=0){let o,r=!0;for(;o=n?this.children[n-1]:null,!(!o||o.dom.parentNode==this.contentDOM);n--,r=!1);return o&&i&&r&&!o.border&&!o.domAtom?o.domFromPos(o.size,i):{node:this.contentDOM,offset:o?zt(o.dom)+1:0}}else{let o,r=!0;for(;o=n<this.children.length?this.children[n]:null,!(!o||o.dom.parentNode==this.contentDOM);n++,r=!1);return o&&r&&!o.border&&!o.domAtom?o.domFromPos(0,i):{node:this.contentDOM,offset:o?zt(o.dom):this.contentDOM.childNodes.length}}}parseRange(t,i,n=0){if(this.children.length==0)return{node:this.contentDOM,from:t,to:i,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let s=-1,o=-1;for(let r=n,a=0;;a++){let l=this.children[a],d=r+l.size;if(s==-1&&t<=d){let c=r+l.border;if(t>=c&&i<=d-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(t,i,c);t=r;for(let u=a;u>0;u--){let h=this.children[u-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){s=zt(h.dom)+1;break}t-=h.size}s==-1&&(s=0)}if(s>-1&&(d>i||a==this.children.length-1)){i=d;for(let c=a+1;c<this.children.length;c++){let u=this.children[c];if(u.size&&u.dom.parentNode==this.contentDOM&&!u.emptyChildAt(-1)){o=zt(u.dom);break}i+=u.size}o==-1&&(o=this.contentDOM.childNodes.length);break}r=d}return{node:this.contentDOM,from:t,to:i,fromOffset:s,toOffset:o}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let i=this.children[t<0?0:this.children.length-1];return i.size==0||i.emptyChildAt(t)}domAfterPos(t){let{node:i,offset:n}=this.domFromPos(t,0);if(i.nodeType!=1||n==i.childNodes.length)throw new RangeError("No node after pos "+t);return i.childNodes[n]}setSelection(t,i,n,s=!1){let o=Math.min(t,i),r=Math.max(t,i);for(let p=0,g=0;p<this.children.length;p++){let f=this.children[p],m=g+f.size;if(o>g&&r<m)return f.setSelection(t-g-f.border,i-g-f.border,n,s);g=m}let a=this.domFromPos(t,t?-1:1),l=i==t?a:this.domFromPos(i,i?-1:1),d=n.root.getSelection(),c=n.domSelectionRange(),u=!1;if((Ni||ci)&&t==i){let{node:p,offset:g}=a;if(p.nodeType==3){if(u=!!(g&&p.nodeValue[g-1]==`
`),u&&g==p.nodeValue.length)for(let f=p,m;f;f=f.parentNode){if(m=f.nextSibling){m.nodeName=="BR"&&(a=l={node:m.parentNode,offset:zt(m)+1});break}let C=f.pmViewDesc;if(C&&C.node&&C.node.isBlock)break}}else{let f=p.childNodes[g-1];u=f&&(f.nodeName=="BR"||f.contentEditable=="false")}}if(Ni&&c.focusNode&&c.focusNode!=l.node&&c.focusNode.nodeType==1){let p=c.focusNode.childNodes[c.focusOffset];p&&p.contentEditable=="false"&&(s=!0)}if(!(s||u&&ci)&&Bo(a.node,a.offset,c.anchorNode,c.anchorOffset)&&Bo(l.node,l.offset,c.focusNode,c.focusOffset))return;let h=!1;if((d.extend||t==i)&&!(u&&Ni)){d.collapse(a.node,a.offset);try{t!=i&&d.extend(l.node,l.offset),h=!0}catch{}}if(!h){if(t>i){let g=a;a=l,l=g}let p=document.createRange();p.setEnd(l.node,l.offset),p.setStart(a.node,a.offset),d.removeAllRanges(),d.addRange(p)}}ignoreMutation(t){return!this.contentDOM&&t.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,i){for(let n=0,s=0;s<this.children.length;s++){let o=this.children[s],r=n+o.size;if(n==r?t<=r&&i>=n:t<r&&i>n){let a=n+o.border,l=r-o.border;if(t>=a&&i<=l){this.dirty=t==n||i==r?Io:_y,t==a&&i==l&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=vn:o.markDirty(t-a,i-a);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?Io:vn}n=r}this.dirty=Io}markParentsDirty(){let t=1;for(let i=this.parent;i;i=i.parent,t++){let n=t==1?Io:_y;i.dirty<n&&(i.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(t){return!1}},Tc=class extends Ho{constructor(t,i,n,s){let o,r=i.type.toDOM;if(typeof r=="function"&&(r=r(n,()=>{if(!o)return s;if(o.parent)return o.parent.posBeforeChild(o)})),!i.type.spec.raw){if(r.nodeType!=1){let a=document.createElement("span");a.appendChild(r),r=a}r.contentEditable="false",r.classList.add("ProseMirror-widget")}super(t,[],r,null),this.widget=i,this.widget=i,o=this}matchesWidget(t){return this.dirty==Bi&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let i=this.widget.spec.stopEvent;return i?i(t):!1}ignoreMutation(t){return t.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}},Bf=class extends Ho{constructor(t,i,n,s){super(t,[],i,null),this.textDOM=n,this.text=s}get size(){return this.text.length}localPosFromDOM(t,i){return t!=this.textDOM?this.posAtStart+(i?this.size:0):this.posAtStart+i}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return t.type==="characterData"&&t.target.nodeValue==t.oldValue}},Xr=class e extends Ho{constructor(t,i,n,s,o){super(t,[],n,s),this.mark=i,this.spec=o}static create(t,i,n,s){let o=s.nodeViews[i.type.name],r=o&&o(i,s,n);return(!r||!r.dom)&&(r=jn.renderSpec(document,i.type.spec.toDOM(i,n),null,i.attrs)),new e(t,i,r.dom,r.contentDOM||r.dom,r)}parseRule(){return this.dirty&vn||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(t){return this.dirty!=vn&&this.mark.eq(t)}markDirty(t,i){if(super.markDirty(t,i),this.dirty!=Bi){let n=this.parent;for(;!n.node;)n=n.parent;n.dirty<this.dirty&&(n.dirty=this.dirty),this.dirty=Bi}}slice(t,i,n){let s=e.create(this.parent,this.mark,!0,n),o=this.children,r=this.size;i<r&&(o=zf(o,i,r,n)),t>0&&(o=zf(o,0,t,n));for(let a=0;a<o.length;a++)o[a].parent=s;return s.children=o,s}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}},Bs=class e extends Ho{constructor(t,i,n,s,o,r,a,l,d){super(t,[],o,r),this.node=i,this.outerDeco=n,this.innerDeco=s,this.nodeDOM=a}static create(t,i,n,s,o,r){let a=o.nodeViews[i.type.name],l,d=a&&a(i,o,()=>{if(!l)return r;if(l.parent)return l.parent.posBeforeChild(l)},n,s),c=d&&d.dom,u=d&&d.contentDOM;if(i.isText){if(!c)c=document.createTextNode(i.text);else if(c.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else c||({dom:c,contentDOM:u}=jn.renderSpec(document,i.type.spec.toDOM(i),null,i.attrs));!u&&!i.isText&&c.nodeName!="BR"&&(c.hasAttribute("contenteditable")||(c.contentEditable="false"),i.type.spec.draggable&&(c.draggable=!0));let h=c;return c=mS(c,n,i),d?l=new Hf(t,i,n,s,c,u||null,h,d,o,r+1):i.isText?new Ac(t,i,n,s,c,h,o):new e(t,i,n,s,c,u||null,h,o,r+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(t.preserveWhitespace="full"),!this.contentDOM)t.getContent=()=>this.node.content;else if(!this.contentLost)t.contentElement=this.contentDOM;else{for(let i=this.children.length-1;i>=0;i--){let n=this.children[i];if(this.dom.contains(n.dom.parentNode)){t.contentElement=n.dom.parentNode;break}}t.contentElement||(t.getContent=()=>B.empty)}return t}matchesNode(t,i,n){return this.dirty==Bi&&t.eq(this.node)&&_c(i,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,i){let n=this.node.inlineContent,s=i,o=t.composing?this.localCompositionInfo(t,i):null,r=o&&o.pos>-1?o:null,a=o&&o.pos<0,l=new Gf(this,r&&r.node,t);fF(this.node,this.innerDeco,(d,c,u)=>{d.spec.marks?l.syncToMarks(d.spec.marks,n,t):d.type.side>=0&&!u&&l.syncToMarks(c==this.node.childCount?Ue.none:this.node.child(c).marks,n,t),l.placeWidget(d,t,s)},(d,c,u,h)=>{l.syncToMarks(d.marks,n,t);let p;l.findNodeMatch(d,c,u,h)||a&&t.state.selection.from>s&&t.state.selection.to<s+d.nodeSize&&(p=l.findIndexWithChild(o.node))>-1&&l.updateNodeAt(d,c,u,p,t)||l.updateNextNode(d,c,u,t,h,s)||l.addNode(d,c,u,t,s),s+=d.nodeSize}),l.syncToMarks([],n,t),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==Io)&&(r&&this.protectLocalComposition(t,r),gS(this.contentDOM,this.children,t),Yr&&mF(this.dom))}localCompositionInfo(t,i){let{from:n,to:s}=t.state.selection;if(!(t.state.selection instanceof le)||n<i||s>i+this.node.content.size)return null;let o=t.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let r=o.nodeValue,a=CF(this.node.content,r,n-i,s-i);return a<0?null:{node:o,pos:a,text:r}}else return{node:o,pos:-1,text:""}}protectLocalComposition(t,{node:i,pos:n,text:s}){if(this.getDesc(i))return;let o=i;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let r=new Bf(this,o,i,s);t.input.compositionNodes.push(r),this.children=zf(this.children,n,n+s.length,t,r)}update(t,i,n,s){return this.dirty==vn||!t.sameMarkup(this.node)?!1:(this.updateInner(t,i,n,s),!0)}updateInner(t,i,n,s){this.updateOuterDeco(i),this.node=t,this.innerDeco=n,this.contentDOM&&this.updateChildren(s,this.posAtStart),this.dirty=Bi}updateOuterDeco(t){if(_c(t,this.outerDeco))return;let i=this.nodeDOM.nodeType!=1,n=this.dom;this.dom=fS(this.dom,this.nodeDOM,Vf(this.outerDeco,this.node,i),Vf(t,this.node,i)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}};function Ly(e,t,i,n,s){mS(n,t,e);let o=new Bs(void 0,e,t,i,n,n,n,s,0);return o.contentDOM&&o.updateChildren(s,0),o}var Ac=class e extends Bs{constructor(t,i,n,s,o,r,a){super(t,i,n,s,o,null,r,a,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,i,n,s){return this.dirty==vn||this.dirty!=Bi&&!this.inParent()||!t.sameMarkup(this.node)?!1:(this.updateOuterDeco(i),(this.dirty!=Bi||t.text!=this.node.text)&&t.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=t.text,s.trackWrites==this.nodeDOM&&(s.trackWrites=null)),this.node=t,this.dirty=Bi,!0)}inParent(){let t=this.parent.contentDOM;for(let i=this.nodeDOM;i;i=i.parentNode)if(i==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,i,n){return t==this.nodeDOM?this.posAtStart+Math.min(i,this.node.text.length):super.localPosFromDOM(t,i,n)}ignoreMutation(t){return t.type!="characterData"&&t.type!="selection"}slice(t,i,n){let s=this.node.cut(t,i),o=document.createTextNode(s.text);return new e(this.parent,s,this.outerDeco,this.innerDeco,o,o,n)}markDirty(t,i){super.markDirty(t,i),this.dom!=this.nodeDOM&&(t==0||i==this.nodeDOM.nodeValue.length)&&(this.dirty=vn)}get domAtom(){return!1}isText(t){return this.node.text==t}},Ic=class extends Ho{parseRule(){return{ignore:!0}}matchesHack(t){return this.dirty==Bi&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}},Hf=class extends Bs{constructor(t,i,n,s,o,r,a,l,d,c){super(t,i,n,s,o,r,a,d,c),this.spec=l}update(t,i,n,s){if(this.dirty==vn)return!1;if(this.spec.update&&(this.node.type==t.type||this.spec.multiType)){let o=this.spec.update(t,i,n);return o&&this.updateInner(t,i,n,s),o}else return!this.contentDOM&&!t.isLeaf?!1:super.update(t,i,n,s)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,i,n,s){this.spec.setSelection?this.spec.setSelection(t,i,n.root):super.setSelection(t,i,n,s)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return this.spec.stopEvent?this.spec.stopEvent(t):!1}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}};function gS(e,t,i){let n=e.firstChild,s=!1;for(let o=0;o<t.length;o++){let r=t[o],a=r.dom;if(a.parentNode==e){for(;a!=n;)n=Oy(n),s=!0;n=n.nextSibling}else s=!0,e.insertBefore(a,n);if(r instanceof Xr){let l=n?n.previousSibling:e.lastChild;gS(r.contentDOM,r.children,i),n=l?l.nextSibling:e.firstChild}}for(;n;)n=Oy(n),s=!0;s&&i.trackWrites==e&&(i.trackWrites=null)}var wl=function(e){e&&(this.nodeName=e)};wl.prototype=Object.create(null);var _o=[new wl];function Vf(e,t,i){if(e.length==0)return _o;let n=i?_o[0]:new wl,s=[n];for(let o=0;o<e.length;o++){let r=e[o].type.attrs;if(r){r.nodeName&&s.push(n=new wl(r.nodeName));for(let a in r){let l=r[a];l!=null&&(i&&s.length==1&&s.push(n=new wl(t.isInline?"span":"div")),a=="class"?n.class=(n.class?n.class+" ":"")+l:a=="style"?n.style=(n.style?n.style+";":"")+l:a!="nodeName"&&(n[a]=l))}}}return s}function fS(e,t,i,n){if(i==_o&&n==_o)return t;let s=t;for(let o=0;o<n.length;o++){let r=n[o],a=i[o];if(o){let l;a&&a.nodeName==r.nodeName&&s!=e&&(l=s.parentNode)&&l.nodeName.toLowerCase()==r.nodeName||(l=document.createElement(r.nodeName),l.pmIsDeco=!0,l.appendChild(s),a=_o[0]),s=l}hF(s,a||_o[0],r)}return s}function hF(e,t,i){for(let n in t)n!="class"&&n!="style"&&n!="nodeName"&&!(n in i)&&e.removeAttribute(n);for(let n in i)n!="class"&&n!="style"&&n!="nodeName"&&i[n]!=t[n]&&e.setAttribute(n,i[n]);if(t.class!=i.class){let n=t.class?t.class.split(" ").filter(Boolean):[],s=i.class?i.class.split(" ").filter(Boolean):[];for(let o=0;o<n.length;o++)s.indexOf(n[o])==-1&&e.classList.remove(n[o]);for(let o=0;o<s.length;o++)n.indexOf(s[o])==-1&&e.classList.add(s[o]);e.classList.length==0&&e.removeAttribute("class")}if(t.style!=i.style){if(t.style){let n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,s;for(;s=n.exec(t.style);)e.style.removeProperty(s[1])}i.style&&(e.style.cssText+=i.style)}}function mS(e,t,i){return fS(e,e,_o,Vf(t,i,e.nodeType!=1))}function _c(e,t){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++)if(!e[i].type.eq(t[i].type))return!1;return!0}function Oy(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}var Gf=class{constructor(t,i,n){this.lock=i,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=pF(t.node.content,t)}destroyBetween(t,i){if(t!=i){for(let n=t;n<i;n++)this.top.children[n].destroy();this.top.children.splice(t,i-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,i,n){let s=0,o=this.stack.length>>1,r=Math.min(o,t.length);for(;s<r&&(s==o-1?this.top:this.stack[s+1<<1]).matchesMark(t[s])&&t[s].type.spec.spanning!==!1;)s++;for(;s<o;)this.destroyRest(),this.top.dirty=Bi,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<t.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let d=this.top.children[l];if(d.matchesMark(t[o])&&!this.isLocked(d.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=Xr.create(this.top,t[o],i,n);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,o++}}findNodeMatch(t,i,n,s){let o=-1,r;if(s>=this.preMatch.index&&(r=this.preMatch.matches[s-this.preMatch.index]).parent==this.top&&r.matchesNode(t,i,n))o=this.top.children.indexOf(r,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let d=this.top.children[a];if(d.matchesNode(t,i,n)&&!this.preMatch.matched.has(d)){o=a;break}}return o<0?!1:(this.destroyBetween(this.index,o),this.index++,!0)}updateNodeAt(t,i,n,s,o){let r=this.top.children[s];return r.dirty==vn&&r.dom==r.contentDOM&&(r.dirty=Io),r.update(t,i,n,o)?(this.destroyBetween(this.index,s),this.index++,!0):!1}findIndexWithChild(t){for(;;){let i=t.parentNode;if(!i)return-1;if(i==this.top.contentDOM){let n=t.pmViewDesc;if(n){for(let s=this.index;s<this.top.children.length;s++)if(this.top.children[s]==n)return s}return-1}t=i}}updateNextNode(t,i,n,s,o,r){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof Bs){let d=this.preMatch.matched.get(l);if(d!=null&&d!=o)return!1;let c=l.dom,u,h=this.isLocked(c)&&!(t.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==t.text&&l.dirty!=vn&&_c(i,l.outerDeco));if(!h&&l.update(t,i,n,s))return this.destroyBetween(this.index,a),l.dom!=c&&(this.changed=!0),this.index++,!0;if(!h&&(u=this.recreateWrapper(l,t,i,n,s,r)))return this.destroyBetween(this.index,a),this.top.children[this.index]=u,u.contentDOM&&(u.dirty=Io,u.updateChildren(s,r+1),u.dirty=Bi),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(t,i,n,s,o,r){if(t.dirty||i.isAtom||!t.children.length||!t.node.content.eq(i.content)||!_c(n,t.outerDeco)||!s.eq(t.innerDeco))return null;let a=Bs.create(this.top,i,n,s,o,r);if(a.contentDOM){a.children=t.children,t.children=[];for(let l of a.children)l.parent=a}return t.destroy(),a}addNode(t,i,n,s,o){let r=Bs.create(this.top,t,i,n,s,o);r.contentDOM&&r.updateChildren(s,o+1),this.top.children.splice(this.index++,0,r),this.changed=!0}placeWidget(t,i,n){let s=this.index<this.top.children.length?this.top.children[this.index]:null;if(s&&s.matchesWidget(t)&&(t==s.widget||!s.widget.type.toDOM.parentNode))this.index++;else{let o=new Tc(this.top,t,i,n);this.top.children.splice(this.index++,0,o),this.changed=!0}}addTextblockHacks(){let t=this.top.children[this.index-1],i=this.top;for(;t instanceof Xr;)i=t,t=i.children[i.children.length-1];(!t||!(t instanceof Ac)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((ci||ti)&&t&&t.dom.contentEditable=="false"&&this.addHackNode("IMG",i),this.addHackNode("BR",this.top))}addHackNode(t,i){if(i==this.top&&this.index<i.children.length&&i.children[this.index].matchesHack(t))this.index++;else{let n=document.createElement(t);t=="IMG"&&(n.className="ProseMirror-separator",n.alt=""),t=="BR"&&(n.className="ProseMirror-trailingBreak");let s=new Ic(this.top,[],n,null);i!=this.top?i.children.push(s):i.children.splice(this.index++,0,s),this.changed=!0}}isLocked(t){return this.lock&&(t==this.lock||t.nodeType==1&&t.contains(this.lock.parentNode))}};function pF(e,t){let i=t,n=i.children.length,s=e.childCount,o=new Map,r=[];e:for(;s>0;){let a;for(;;)if(n){let d=i.children[n-1];if(d instanceof Xr)i=d,n=d.children.length;else{a=d,n--;break}}else{if(i==t)break e;n=i.parent.children.indexOf(i),i=i.parent}let l=a.node;if(l){if(l!=e.child(s-1))break;--s,o.set(a,s),r.push(a)}}return{index:s,matched:o,matches:r.reverse()}}function gF(e,t){return e.type.side-t.type.side}function fF(e,t,i,n){let s=t.locals(e),o=0;if(s.length==0){for(let d=0;d<e.childCount;d++){let c=e.child(d);n(c,s,t.forChild(o,c),d),o+=c.nodeSize}return}let r=0,a=[],l=null;for(let d=0;;){let c,u;for(;r<s.length&&s[r].to==o;){let m=s[r++];m.widget&&(c?(u||(u=[c])).push(m):c=m)}if(c)if(u){u.sort(gF);for(let m=0;m<u.length;m++)i(u[m],d,!!l)}else i(c,d,!!l);let h,p;if(l)p=-1,h=l,l=null;else if(d<e.childCount)p=d,h=e.child(d++);else break;for(let m=0;m<a.length;m++)a[m].to<=o&&a.splice(m--,1);for(;r<s.length&&s[r].from<=o&&s[r].to>o;)a.push(s[r++]);let g=o+h.nodeSize;if(h.isText){let m=g;r<s.length&&s[r].from<m&&(m=s[r].from);for(let C=0;C<a.length;C++)a[C].to<m&&(m=a[C].to);m<g&&(l=h.cut(m-o),h=h.cut(0,m-o),g=m,p=-1)}else for(;r<s.length&&s[r].to<g;)r++;let f=h.isInline&&!h.isLeaf?a.filter(m=>!m.inline):a.slice();n(h,f,t.forChild(o,h),p),o=g}}function mF(e){if(e.nodeName=="UL"||e.nodeName=="OL"){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}function CF(e,t,i,n){for(let s=0,o=0;s<e.childCount&&o<=n;){let r=e.child(s++),a=o;if(o+=r.nodeSize,!r.isText)continue;let l=r.text;for(;s<e.childCount;){let d=e.child(s++);if(o+=d.nodeSize,!d.isText)break;l+=d.text}if(o>=i){if(o>=n&&l.slice(n-t.length-a,n-a)==t)return n-t.length;let d=a<n?l.lastIndexOf(t,n-a-1):-1;if(d>=0&&d+t.length+a>=i)return a+d;if(i==n&&l.length>=n+t.length-a&&l.slice(n-a,n-a+t.length)==t)return n}}return-1}function zf(e,t,i,n,s){let o=[];for(let r=0,a=0;r<e.length;r++){let l=e[r],d=a,c=a+=l.size;d>=i||c<=t?o.push(l):(d<t&&o.push(l.slice(0,t-d,n)),s&&(o.push(s),s=void 0),c>i&&o.push(l.slice(i-d,l.size,n)))}return o}function Zf(e,t=null){let i=e.domSelectionRange(),n=e.state.doc;if(!i.focusNode)return null;let s=e.docView.nearestDesc(i.focusNode),o=s&&s.size==0,r=e.docView.posFromDOM(i.focusNode,i.focusOffset,1);if(r<0)return null;let a=n.resolve(r),l,d;if(Gc(i)){for(l=r;s&&!s.node;)s=s.parent;let u=s.node;if(s&&u.isAtom&&ne.isSelectable(u)&&s.parent&&!(u.isInline&&$P(i.focusNode,i.focusOffset,s.dom))){let h=s.posBefore;d=new ne(r==h?a:n.resolve(h))}}else{if(i instanceof e.dom.ownerDocument.defaultView.Selection&&i.rangeCount>1){let u=r,h=r;for(let p=0;p<i.rangeCount;p++){let g=i.getRangeAt(p);u=Math.min(u,e.docView.posFromDOM(g.startContainer,g.startOffset,1)),h=Math.max(h,e.docView.posFromDOM(g.endContainer,g.endOffset,-1))}if(u<0)return null;[l,r]=h==e.state.selection.anchor?[h,u]:[u,h],a=n.resolve(r)}else l=e.docView.posFromDOM(i.anchorNode,i.anchorOffset,1);if(l<0)return null}let c=n.resolve(l);if(!d){let u=t=="pointer"||e.state.selection.head<a.pos&&!o?1:-1;d=em(e,c,a,u)}return d}function CS(e){return e.editable?e.hasFocus():wS(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function es(e,t=!1){let i=e.state.selection;if(vS(e,i),!!CS(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&ti){let n=e.domSelectionRange(),s=e.domObserver.currentSelection;if(n.anchorNode&&s.anchorNode&&Bo(n.anchorNode,n.anchorOffset,s.anchorNode,s.anchorOffset)){e.input.mouseDown.delayedSelectionSync=!0,e.domObserver.setCurSelection();return}}if(e.domObserver.disconnectSelection(),e.cursorWrapper)wF(e);else{let{anchor:n,head:s}=i,o,r;Ny&&!(i instanceof le)&&(i.$from.parent.inlineContent||(o=By(e,i.from)),!i.empty&&!i.$from.parent.inlineContent&&(r=By(e,i.to))),e.docView.setSelection(n,s,e,t),Ny&&(o&&Hy(o),r&&Hy(r)),i.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&vF(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}var Ny=ci||ti&&aS<63;function By(e,t){let{node:i,offset:n}=e.docView.domFromPos(t,0),s=n<i.childNodes.length?i.childNodes[n]:null,o=n?i.childNodes[n-1]:null;if(ci&&s&&s.contentEditable=="false")return Ff(s);if((!s||s.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(s)return Ff(s);if(o)return Ff(o)}}function Ff(e){return e.contentEditable="true",ci&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function Hy(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function vF(e){let t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);let i=e.domSelectionRange(),n=i.anchorNode,s=i.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{(i.anchorNode!=n||i.anchorOffset!=s)&&(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(()=>{(!CS(e)||e.state.selection.visible)&&e.dom.classList.remove("ProseMirror-hideselection")},20))})}function wF(e){let t=e.domSelection();if(!t)return;let i=e.cursorWrapper.dom,n=i.nodeName=="IMG";n?t.collapse(i.parentNode,zt(i)+1):t.collapse(i,0),!n&&!e.state.selection.visible&&vi&&Ns<=11&&(i.disabled=!0,i.disabled=!1)}function vS(e,t){if(t instanceof ne){let i=e.docView.descAt(t.from);i!=e.lastSelectedViewDesc&&(Vy(e),i&&i.selectNode(),e.lastSelectedViewDesc=i)}else Vy(e)}function Vy(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function em(e,t,i,n){return e.someProp("createSelectionBetween",s=>s(e,t,i))||le.between(t,i,n)}function Gy(e){return e.editable&&!e.hasFocus()?!1:wS(e)}function wS(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(t.anchorNode.nodeType==3?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(t.focusNode.nodeType==3?t.focusNode.parentNode:t.focusNode))}catch{return!1}}function bF(e){let t=e.docView.domFromPos(e.state.selection.anchor,0),i=e.domSelectionRange();return Bo(t.node,t.offset,i.anchorNode,i.anchorOffset)}function Wf(e,t){let{$anchor:i,$head:n}=e.selection,s=t>0?i.max(n):i.min(n),o=s.parent.inlineContent?s.depth?e.doc.resolve(t>0?s.after():s.before()):null:s;return o&&ge.findFrom(o,t)}function Ls(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function zy(e,t,i){let n=e.state.selection;if(n instanceof le)if(i.indexOf("s")>-1){let{$head:s}=n,o=s.textOffset?null:t<0?s.nodeBefore:s.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let r=e.state.doc.resolve(s.pos+o.nodeSize*(t<0?-1:1));return Ls(e,new le(n.$anchor,r))}else if(n.empty){if(e.endOfTextblock(t>0?"forward":"backward")){let s=Wf(e.state,t);return s&&s instanceof ne?Ls(e,s):!1}else if(!(Li&&i.indexOf("m")>-1)){let s=n.$head,o=s.textOffset?null:t<0?s.nodeBefore:s.nodeAfter,r;if(!o||o.isText)return!1;let a=t<0?s.pos-o.nodeSize:s.pos;return o.isAtom||(r=e.docView.descAt(a))&&!r.contentDOM?ne.isSelectable(o)?Ls(e,new ne(t<0?e.state.doc.resolve(s.pos-o.nodeSize):s)):Ml?Ls(e,new le(e.state.doc.resolve(t<0?a:a+o.nodeSize))):!1:!1}}else return!1;else{if(n instanceof ne&&n.node.isInline)return Ls(e,new le(t>0?n.$to:n.$from));{let s=Wf(e.state,t);return s?Ls(e,s):!1}}}function Lc(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function bl(e,t){let i=e.pmViewDesc;return i&&i.size==0&&(t<0||e.nextSibling||e.nodeName!="BR")}function qr(e,t){return t<0?yF(e):SF(e)}function yF(e){let t=e.domSelectionRange(),i=t.focusNode,n=t.focusOffset;if(!i)return;let s,o,r=!1;for(Ni&&i.nodeType==1&&n<Lc(i)&&bl(i.childNodes[n],-1)&&(r=!0);;)if(n>0){if(i.nodeType!=1)break;{let a=i.childNodes[n-1];if(bl(a,-1))s=i,o=--n;else if(a.nodeType==3)i=a,n=i.nodeValue.length;else break}}else{if(bS(i))break;{let a=i.previousSibling;for(;a&&bl(a,-1);)s=i.parentNode,o=zt(a),a=a.previousSibling;if(a)i=a,n=Lc(i);else{if(i=i.parentNode,i==e.dom)break;n=0}}}r?Uf(e,i,n):s&&Uf(e,s,o)}function SF(e){let t=e.domSelectionRange(),i=t.focusNode,n=t.focusOffset;if(!i)return;let s=Lc(i),o,r;for(;;)if(n<s){if(i.nodeType!=1)break;let a=i.childNodes[n];if(bl(a,1))o=i,r=++n;else break}else{if(bS(i))break;{let a=i.nextSibling;for(;a&&bl(a,1);)o=a.parentNode,r=zt(a)+1,a=a.nextSibling;if(a)i=a,n=0,s=Lc(i);else{if(i=i.parentNode,i==e.dom)break;n=s=0}}}o&&Uf(e,o,r)}function bS(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function xF(e,t){for(;e&&t==e.childNodes.length&&!Rl(e);)t=zt(e)+1,e=e.parentNode;for(;e&&t<e.childNodes.length;){let i=e.childNodes[t];if(i.nodeType==3)return i;if(i.nodeType==1&&i.contentEditable=="false")break;e=i,t=0}}function EF(e,t){for(;e&&!t&&!Rl(e);)t=zt(e),e=e.parentNode;for(;e&&t;){let i=e.childNodes[t-1];if(i.nodeType==3)return i;if(i.nodeType==1&&i.contentEditable=="false")break;e=i,t=e.childNodes.length}}function Uf(e,t,i){if(t.nodeType!=3){let o,r;(r=xF(t,i))?(t=r,i=0):(o=EF(t,i))&&(t=o,i=o.nodeValue.length)}let n=e.domSelection();if(!n)return;if(Gc(n)){let o=document.createRange();o.setEnd(t,i),o.setStart(t,i),n.removeAllRanges(),n.addRange(o)}else n.extend&&n.extend(t,i);e.domObserver.setCurSelection();let{state:s}=e;setTimeout(()=>{e.state==s&&es(e)},50)}function Wy(e,t){let i=e.state.doc.resolve(t);if(!(ti||YP)&&i.parent.inlineContent){let s=e.coordsAtPos(t);if(t>i.start()){let o=e.coordsAtPos(t-1),r=(o.top+o.bottom)/2;if(r>s.top&&r<s.bottom&&Math.abs(o.left-s.left)>1)return o.left<s.left?"ltr":"rtl"}if(t<i.end()){let o=e.coordsAtPos(t+1),r=(o.top+o.bottom)/2;if(r>s.top&&r<s.bottom&&Math.abs(o.left-s.left)>1)return o.left>s.left?"ltr":"rtl"}}return getComputedStyle(e.dom).direction=="rtl"?"rtl":"ltr"}function Uy(e,t,i){let n=e.state.selection;if(n instanceof le&&!n.empty||i.indexOf("s")>-1||Li&&i.indexOf("m")>-1)return!1;let{$from:s,$to:o}=n;if(!s.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let r=Wf(e.state,t);if(r&&r instanceof ne)return Ls(e,r)}if(!s.parent.inlineContent){let r=t<0?s:o,a=n instanceof di?ge.near(r,t):ge.findFrom(r,t);return a?Ls(e,a):!1}return!1}function qy(e,t){if(!(e.state.selection instanceof le))return!0;let{$head:i,$anchor:n,empty:s}=e.state.selection;if(!i.sameParent(n))return!0;if(!s)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let o=!i.textOffset&&(t<0?i.nodeBefore:i.nodeAfter);if(o&&!o.isText){let r=e.state.tr;return t<0?r.delete(i.pos-o.nodeSize,i.pos):r.delete(i.pos,i.pos+o.nodeSize),e.dispatch(r),!0}return!1}function $y(e,t,i){e.domObserver.stop(),t.contentEditable=i,e.domObserver.start()}function RF(e){if(!ci||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:i}=e.domSelectionRange();if(t&&t.nodeType==1&&i==0&&t.firstChild&&t.firstChild.contentEditable=="false"){let n=t.firstChild;$y(e,n,"true"),setTimeout(()=>$y(e,n,"false"),20)}return!1}function MF(e){let t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}function DF(e,t){let i=t.keyCode,n=MF(t);if(i==8||Li&&i==72&&n=="c")return qy(e,-1)||qr(e,-1);if(i==46&&!t.shiftKey||Li&&i==68&&n=="c")return qy(e,1)||qr(e,1);if(i==13||i==27)return!0;if(i==37||Li&&i==66&&n=="c"){let s=i==37?Wy(e,e.state.selection.from)=="ltr"?-1:1:-1;return zy(e,s,n)||qr(e,s)}else if(i==39||Li&&i==70&&n=="c"){let s=i==39?Wy(e,e.state.selection.from)=="ltr"?1:-1:1;return zy(e,s,n)||qr(e,s)}else{if(i==38||Li&&i==80&&n=="c")return Uy(e,-1,n)||qr(e,-1);if(i==40||Li&&i==78&&n=="c")return RF(e)||Uy(e,1,n)||qr(e,1);if(n==(Li?"m":"c")&&(i==66||i==73||i==89||i==90))return!0}return!1}function tm(e,t){e.someProp("transformCopied",p=>{t=p(t,e)});let i=[],{content:n,openStart:s,openEnd:o}=t;for(;s>1&&o>1&&n.childCount==1&&n.firstChild.childCount==1;){s--,o--;let p=n.firstChild;i.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),n=p.content}let r=e.someProp("clipboardSerializer")||jn.fromSchema(e.state.schema),a=MS(),l=a.createElement("div");l.appendChild(r.serializeFragment(n,{document:a}));let d=l.firstChild,c,u=0;for(;d&&d.nodeType==1&&(c=RS[d.nodeName.toLowerCase()]);){for(let p=c.length-1;p>=0;p--){let g=a.createElement(c[p]);for(;l.firstChild;)g.appendChild(l.firstChild);l.appendChild(g),u++}d=l.firstChild}d&&d.nodeType==1&&d.setAttribute("data-pm-slice",`${s} ${o}${u?` -${u}`:""} ${JSON.stringify(i)}`);let h=e.someProp("clipboardTextSerializer",p=>p(t,e))||t.content.textBetween(0,t.content.size,`

`);return{dom:l,text:h,slice:t}}function yS(e,t,i,n,s){let o=s.parent.type.spec.code,r,a;if(!i&&!t)return null;let l=!!t&&(n||o||!i);if(l){if(e.someProp("transformPastedText",h=>{t=h(t,o||n,e)}),o)return a=new J(B.from(e.state.schema.text(t.replace(/\r\n?/g,`
`))),0,0),e.someProp("transformPasted",h=>{a=h(a,e,!0)}),a;let u=e.someProp("clipboardTextParser",h=>h(t,s,n,e));if(u)a=u;else{let h=s.marks(),{schema:p}=e.state,g=jn.fromSchema(p);r=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(f=>{let m=r.appendChild(document.createElement("p"));f&&m.appendChild(g.serializeNode(p.text(f,h)))})}}else e.someProp("transformPastedHTML",u=>{i=u(i,e)}),r=TF(i),Ml&&AF(r);let d=r&&r.querySelector("[data-pm-slice]"),c=d&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(d.getAttribute("data-pm-slice")||"");if(c&&c[3])for(let u=+c[3];u>0;u--){let h=r.firstChild;for(;h&&h.nodeType!=1;)h=h.nextSibling;if(!h)break;r=h}if(a||(a=(e.someProp("clipboardParser")||e.someProp("domParser")||mn.fromSchema(e.state.schema)).parseSlice(r,{preserveWhitespace:!!(l||c),context:s,ruleFromNode(h){return h.nodeName=="BR"&&!h.nextSibling&&h.parentNode&&!kF.test(h.parentNode.nodeName)?{ignore:!0}:null}})),c)a=IF(jy(a,+c[1],+c[2]),c[4]);else if(a=J.maxOpen(PF(a.content,s),!0),a.openStart||a.openEnd){let u=0,h=0;for(let p=a.content.firstChild;u<a.openStart&&!p.type.spec.isolating;u++,p=p.firstChild);for(let p=a.content.lastChild;h<a.openEnd&&!p.type.spec.isolating;h++,p=p.lastChild);a=jy(a,u,h)}return e.someProp("transformPasted",u=>{a=u(a,e,l)}),a}var kF=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function PF(e,t){if(e.childCount<2)return e;for(let i=t.depth;i>=0;i--){let s=t.node(i).contentMatchAt(t.index(i)),o,r=[];if(e.forEach(a=>{if(!r)return;let l=s.findWrapping(a.type),d;if(!l)return r=null;if(d=r.length&&o.length&&xS(l,o,a,r[r.length-1],0))r[r.length-1]=d;else{r.length&&(r[r.length-1]=ES(r[r.length-1],o.length));let c=SS(a,l);r.push(c),s=s.matchType(c.type),o=l}}),r)return B.from(r)}return e}function SS(e,t,i=0){for(let n=t.length-1;n>=i;n--)e=t[n].create(null,B.from(e));return e}function xS(e,t,i,n,s){if(s<e.length&&s<t.length&&e[s]==t[s]){let o=xS(e,t,i,n.lastChild,s+1);if(o)return n.copy(n.content.replaceChild(n.childCount-1,o));if(n.contentMatchAt(n.childCount).matchType(s==e.length-1?i.type:e[s+1]))return n.copy(n.content.append(B.from(SS(i,e,s+1))))}}function ES(e,t){if(t==0)return e;let i=e.content.replaceChild(e.childCount-1,ES(e.lastChild,t-1)),n=e.contentMatchAt(e.childCount).fillBefore(B.empty,!0);return e.copy(i.append(n))}function qf(e,t,i,n,s,o){let r=t<0?e.firstChild:e.lastChild,a=r.content;return e.childCount>1&&(o=0),s<n-1&&(a=qf(a,t,i,n,s+1,o)),s>=i&&(a=t<0?r.contentMatchAt(0).fillBefore(a,o<=s).append(a):a.append(r.contentMatchAt(r.childCount).fillBefore(B.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,r.copy(a))}function jy(e,t,i){return t<e.openStart&&(e=new J(qf(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),i<e.openEnd&&(e=new J(qf(e.content,1,i,e.openEnd,0,0),e.openStart,i)),e}var RS={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},Ky=null;function MS(){return Ky||(Ky=document.implementation.createHTMLDocument("title"))}var Tf=null;function FF(e){let t=window.trustedTypes;return t?(Tf||(Tf=t.defaultPolicy||t.createPolicy("ProseMirrorClipboard",{createHTML:i=>i})),Tf.createHTML(e)):e}function TF(e){let t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));let i=MS().createElement("div"),n=/<([a-z][^>\s]+)/i.exec(e),s;if((s=n&&RS[n[1].toLowerCase()])&&(e=s.map(o=>"<"+o+">").join("")+e+s.map(o=>"</"+o+">").reverse().join("")),i.innerHTML=FF(e),s)for(let o=0;o<s.length;o++)i=i.querySelector(s[o])||i;return i}function AF(e){let t=e.querySelectorAll(ti?"span:not([class]):not([style])":"span.Apple-converted-space");for(let i=0;i<t.length;i++){let n=t[i];n.childNodes.length==1&&n.textContent=="\xA0"&&n.parentNode&&n.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),n)}}function IF(e,t){if(!e.size)return e;let i=e.content.firstChild.type.schema,n;try{n=JSON.parse(t)}catch{return e}let{content:s,openStart:o,openEnd:r}=e;for(let a=n.length-2;a>=0;a-=2){let l=i.nodes[n[a]];if(!l||l.hasRequiredAttrs())break;s=B.from(l.create(n[a+1],s)),o++,r++}return new J(s,o,r)}var ui={},hi={},_F={touchstart:!0,touchmove:!0},$f=class{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}};function LF(e){for(let t in ui){let i=ui[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=n=>{NF(e,n)&&!im(e,n)&&(e.editable||!(n.type in hi))&&i(e,n)},_F[t]?{passive:!0}:void 0)}ci&&e.dom.addEventListener("input",()=>null),jf(e)}function Os(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function OF(e){e.domObserver.stop();for(let t in e.input.eventHandlers)e.dom.removeEventListener(t,e.input.eventHandlers[t]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}function jf(e){e.someProp("handleDOMEvents",t=>{for(let i in t)e.input.eventHandlers[i]||e.dom.addEventListener(i,e.input.eventHandlers[i]=n=>im(e,n))})}function im(e,t){return e.someProp("handleDOMEvents",i=>{let n=i[t.type];return n?n(e,t)||t.defaultPrevented:!1})}function NF(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let i=t.target;i!=e.dom;i=i.parentNode)if(!i||i.nodeType==11||i.pmViewDesc&&i.pmViewDesc.stopEvent(t))return!1;return!0}function BF(e,t){!im(e,t)&&ui[t.type]&&(e.editable||!(t.type in hi))&&ui[t.type](e,t)}hi.keydown=(e,t)=>{let i=t;if(e.input.shiftKey=i.keyCode==16||i.shiftKey,!kS(e,i)&&(e.input.lastKeyCode=i.keyCode,e.input.lastKeyCodeTime=Date.now(),!(Zn&&ti&&i.keyCode==13)))if(i.keyCode!=229&&e.domObserver.forceFlush(),Yr&&i.keyCode==13&&!i.ctrlKey&&!i.altKey&&!i.metaKey){let n=Date.now();e.input.lastIOSEnter=n,e.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{e.input.lastIOSEnter==n&&(e.someProp("handleKeyDown",s=>s(e,Ao(13,"Enter"))),e.input.lastIOSEnter=0)},200)}else e.someProp("handleKeyDown",n=>n(e,i))||DF(e,i)?i.preventDefault():Os(e,"key")};hi.keyup=(e,t)=>{t.keyCode==16&&(e.input.shiftKey=!1)};hi.keypress=(e,t)=>{let i=t;if(kS(e,i)||!i.charCode||i.ctrlKey&&!i.altKey||Li&&i.metaKey)return;if(e.someProp("handleKeyPress",s=>s(e,i))){i.preventDefault();return}let n=e.state.selection;if(!(n instanceof le)||!n.$from.sameParent(n.$to)){let s=String.fromCharCode(i.charCode),o=()=>e.state.tr.insertText(s).scrollIntoView();!/[\r\n]/.test(s)&&!e.someProp("handleTextInput",r=>r(e,n.$from.pos,n.$to.pos,s,o))&&e.dispatch(o()),i.preventDefault()}};function zc(e){return{left:e.clientX,top:e.clientY}}function HF(e,t){let i=t.x-e.clientX,n=t.y-e.clientY;return i*i+n*n<100}function nm(e,t,i,n,s){if(n==-1)return!1;let o=e.state.doc.resolve(n);for(let r=o.depth+1;r>0;r--)if(e.someProp(t,a=>r>o.depth?a(e,i,o.nodeAfter,o.before(r),s,!0):a(e,i,o.node(r),o.before(r),s,!1)))return!0;return!1}function jr(e,t,i){if(e.focused||e.focus(),e.state.selection.eq(t))return;let n=e.state.tr.setSelection(t);i=="pointer"&&n.setMeta("pointer",!0),e.dispatch(n)}function VF(e,t){if(t==-1)return!1;let i=e.state.doc.resolve(t),n=i.nodeAfter;return n&&n.isAtom&&ne.isSelectable(n)?(jr(e,new ne(i),"pointer"),!0):!1}function GF(e,t){if(t==-1)return!1;let i=e.state.selection,n,s;i instanceof ne&&(n=i.node);let o=e.state.doc.resolve(t);for(let r=o.depth+1;r>0;r--){let a=r>o.depth?o.nodeAfter:o.node(r);if(ne.isSelectable(a)){n&&i.$from.depth>0&&r>=i.$from.depth&&o.before(i.$from.depth+1)==i.$from.pos?s=o.before(i.$from.depth):s=o.before(r);break}}return s!=null?(jr(e,ne.create(e.state.doc,s),"pointer"),!0):!1}function zF(e,t,i,n,s){return nm(e,"handleClickOn",t,i,n)||e.someProp("handleClick",o=>o(e,t,n))||(s?GF(e,i):VF(e,i))}function WF(e,t,i,n){return nm(e,"handleDoubleClickOn",t,i,n)||e.someProp("handleDoubleClick",s=>s(e,t,n))}function UF(e,t,i,n){return nm(e,"handleTripleClickOn",t,i,n)||e.someProp("handleTripleClick",s=>s(e,t,n))||qF(e,i,n)}function qF(e,t,i){if(i.button!=0)return!1;let n=e.state.doc;if(t==-1)return n.inlineContent?(jr(e,le.create(n,0,n.content.size),"pointer"),!0):!1;let s=n.resolve(t);for(let o=s.depth+1;o>0;o--){let r=o>s.depth?s.nodeAfter:s.node(o),a=s.before(o);if(r.inlineContent)jr(e,le.create(n,a+1,a+1+r.content.size),"pointer");else if(ne.isSelectable(r))jr(e,ne.create(n,a),"pointer");else continue;return!0}}function sm(e){return Oc(e)}var DS=Li?"metaKey":"ctrlKey";ui.mousedown=(e,t)=>{let i=t;e.input.shiftKey=i.shiftKey;let n=sm(e),s=Date.now(),o="singleClick";s-e.input.lastClick.time<500&&HF(i,e.input.lastClick)&&!i[DS]&&e.input.lastClick.button==i.button&&(e.input.lastClick.type=="singleClick"?o="doubleClick":e.input.lastClick.type=="doubleClick"&&(o="tripleClick")),e.input.lastClick={time:s,x:i.clientX,y:i.clientY,type:o,button:i.button};let r=e.posAtCoords(zc(i));r&&(o=="singleClick"?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new Kf(e,r,i,!!n)):(o=="doubleClick"?WF:UF)(e,r.pos,r.inside,i)?i.preventDefault():Os(e,"pointer"))};var Kf=class{constructor(t,i,n,s){this.view=t,this.pos=i,this.event=n,this.flushed=s,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!n[DS],this.allowDefault=n.shiftKey;let o,r;if(i.inside>-1)o=t.state.doc.nodeAt(i.inside),r=i.inside;else{let c=t.state.doc.resolve(i.pos);o=c.parent,r=c.depth?c.before():0}let a=s?null:n.target,l=a?t.docView.nearestDesc(a,!0):null;this.target=l&&l.nodeDOM.nodeType==1?l.nodeDOM:null;let{selection:d}=t.state;(n.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||d instanceof ne&&d.from<=r&&d.to>r)&&(this.mightDrag={node:o,pos:r,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Ni&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),Os(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>es(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let i=this.pos;this.view.state.doc!=this.startDoc&&(i=this.view.posAtCoords(zc(t))),this.updateAllowDefault(t),this.allowDefault||!i?Os(this.view,"pointer"):zF(this.view,i.pos,i.inside,t,this.selectNode)?t.preventDefault():t.button==0&&(this.flushed||ci&&this.mightDrag&&!this.mightDrag.node.isAtom||ti&&!this.view.state.selection.visible&&Math.min(Math.abs(i.pos-this.view.state.selection.from),Math.abs(i.pos-this.view.state.selection.to))<=2)?(jr(this.view,ge.near(this.view.state.doc.resolve(i.pos)),"pointer"),t.preventDefault()):Os(this.view,"pointer")}move(t){this.updateAllowDefault(t),Os(this.view,"pointer"),t.buttons==0&&this.done()}updateAllowDefault(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)}};ui.touchstart=e=>{e.input.lastTouch=Date.now(),sm(e),Os(e,"pointer")};ui.touchmove=e=>{e.input.lastTouch=Date.now(),Os(e,"pointer")};ui.contextmenu=e=>sm(e);function kS(e,t){return e.composing?!0:ci&&Math.abs(t.timeStamp-e.input.compositionEndedAt)<500?(e.input.compositionEndedAt=-2e8,!0):!1}var $F=Zn?5e3:-1;hi.compositionstart=hi.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,i=t.selection.$to;if(t.selection instanceof le&&(t.storedMarks||!i.textOffset&&i.parentOffset&&i.nodeBefore.marks.some(n=>n.type.spec.inclusive===!1)))e.markCursor=e.state.storedMarks||i.marks(),Oc(e,!0),e.markCursor=null;else if(Oc(e,!t.selection.empty),Ni&&t.selection.empty&&i.parentOffset&&!i.textOffset&&i.nodeBefore.marks.length){let n=e.domSelectionRange();for(let s=n.focusNode,o=n.focusOffset;s&&s.nodeType==1&&o!=0;){let r=o<0?s.lastChild:s.childNodes[o-1];if(!r)break;if(r.nodeType==3){let a=e.domSelection();a&&a.collapse(r,r.nodeValue.length);break}else s=r,o=-1}}e.input.composing=!0}PS(e,$F)};hi.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionNode=null,e.input.compositionPendingChanges&&Promise.resolve().then(()=>e.domObserver.flush()),e.input.compositionID++,PS(e,20))};function PS(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout(()=>Oc(e),t))}function FS(e){for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=KF());e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function jF(e){let t=e.domSelectionRange();if(!t.focusNode)return null;let i=UP(t.focusNode,t.focusOffset),n=qP(t.focusNode,t.focusOffset);if(i&&n&&i!=n){let s=n.pmViewDesc,o=e.domObserver.lastChangedTextNode;if(i==o||n==o)return o;if(!s||!s.isText(n.nodeValue))return n;if(e.input.compositionNode==n){let r=i.pmViewDesc;if(!(!r||!r.isText(i.nodeValue)))return n}}return i||n}function KF(){let e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}function Oc(e,t=!1){if(!(Zn&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),FS(e),t||e.docView&&e.docView.dirty){let i=Zf(e),n=e.state.selection;return i&&!i.eq(n)?e.dispatch(e.state.tr.setSelection(i)):(e.markCursor||t)&&!n.$from.node(n.$from.sharedDepth(n.to)).inlineContent?e.dispatch(e.state.tr.deleteSelection()):e.updateState(e.state),!0}return!1}}function YF(e,t){if(!e.dom.parentNode)return;let i=e.dom.parentNode.appendChild(document.createElement("div"));i.appendChild(t),i.style.cssText="position: fixed; left: -10000px; top: 10px";let n=getSelection(),s=document.createRange();s.selectNodeContents(t),e.dom.blur(),n.removeAllRanges(),n.addRange(s),setTimeout(()=>{i.parentNode&&i.parentNode.removeChild(i),e.focus()},50)}var yl=vi&&Ns<15||Yr&&XP<604;ui.copy=hi.cut=(e,t)=>{let i=t,n=e.state.selection,s=i.type=="cut";if(n.empty)return;let o=yl?null:i.clipboardData,r=n.content(),{dom:a,text:l}=tm(e,r);o?(i.preventDefault(),o.clearData(),o.setData("text/html",a.innerHTML),o.setData("text/plain",l)):YF(e,a),s&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function XF(e){return e.openStart==0&&e.openEnd==0&&e.content.childCount==1?e.content.firstChild:null}function JF(e,t){if(!e.dom.parentNode)return;let i=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,n=e.dom.parentNode.appendChild(document.createElement(i?"textarea":"div"));i||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus();let s=e.input.shiftKey&&e.input.lastKeyCode!=45;setTimeout(()=>{e.focus(),n.parentNode&&n.parentNode.removeChild(n),i?Sl(e,n.value,null,s,t):Sl(e,n.textContent,n.innerHTML,s,t)},50)}function Sl(e,t,i,n,s){let o=yS(e,t,i,n,e.state.selection.$from);if(e.someProp("handlePaste",l=>l(e,s,o||J.empty)))return!0;if(!o)return!1;let r=XF(o),a=r?e.state.tr.replaceSelectionWith(r,n):e.state.tr.replaceSelection(o);return e.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function TS(e){let t=e.getData("text/plain")||e.getData("Text");if(t)return t;let i=e.getData("text/uri-list");return i?i.replace(/\r?\n/g," "):""}hi.paste=(e,t)=>{let i=t;if(e.composing&&!Zn)return;let n=yl?null:i.clipboardData,s=e.input.shiftKey&&e.input.lastKeyCode!=45;n&&Sl(e,TS(n),n.getData("text/html"),s,i)?i.preventDefault():JF(e,i)};var Nc=class{constructor(t,i,n){this.slice=t,this.move=i,this.node=n}},QF=Li?"altKey":"ctrlKey";function AS(e,t){let i=e.someProp("dragCopies",n=>!n(t));return i??!t[QF]}ui.dragstart=(e,t)=>{let i=t,n=e.input.mouseDown;if(n&&n.done(),!i.dataTransfer)return;let s=e.state.selection,o=s.empty?null:e.posAtCoords(zc(i)),r;if(!(o&&o.pos>=s.from&&o.pos<=(s instanceof ne?s.to-1:s.to))){if(n&&n.mightDrag)r=ne.create(e.state.doc,n.mightDrag.pos);else if(i.target&&i.target.nodeType==1){let u=e.docView.nearestDesc(i.target,!0);u&&u.node.type.spec.draggable&&u!=e.docView&&(r=ne.create(e.state.doc,u.posBefore))}}let a=(r||e.state.selection).content(),{dom:l,text:d,slice:c}=tm(e,a);(!i.dataTransfer.files.length||!ti||aS>120)&&i.dataTransfer.clearData(),i.dataTransfer.setData(yl?"Text":"text/html",l.innerHTML),i.dataTransfer.effectAllowed="copyMove",yl||i.dataTransfer.setData("text/plain",d),e.dragging=new Nc(c,AS(e,i),r)};ui.dragend=e=>{let t=e.dragging;window.setTimeout(()=>{e.dragging==t&&(e.dragging=null)},50)};hi.dragover=hi.dragenter=(e,t)=>t.preventDefault();hi.drop=(e,t)=>{let i=t,n=e.dragging;if(e.dragging=null,!i.dataTransfer)return;let s=e.posAtCoords(zc(i));if(!s)return;let o=e.state.doc.resolve(s.pos),r=n&&n.slice;r?e.someProp("transformPasted",g=>{r=g(r,e,!1)}):r=yS(e,TS(i.dataTransfer),yl?null:i.dataTransfer.getData("text/html"),!1,o);let a=!!(n&&AS(e,i));if(e.someProp("handleDrop",g=>g(e,i,r||J.empty,a))){i.preventDefault();return}if(!r)return;i.preventDefault();let l=r?Rc(e.state.doc,o.pos,r):o.pos;l==null&&(l=o.pos);let d=e.state.tr;if(a){let{node:g}=n;g?g.replace(d):d.deleteSelection()}let c=d.mapping.map(l),u=r.openStart==0&&r.openEnd==0&&r.content.childCount==1,h=d.doc;if(u?d.replaceRangeWith(c,c,r.content.firstChild):d.replaceRange(c,c,r),d.doc.eq(h))return;let p=d.doc.resolve(c);if(u&&ne.isSelectable(r.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(r.content.firstChild))d.setSelection(new ne(p));else{let g=d.mapping.map(l);d.mapping.maps[d.mapping.maps.length-1].forEach((f,m,C,v)=>g=v),d.setSelection(em(e,p,d.doc.resolve(g)))}e.focus(),e.dispatch(d.setMeta("uiEvent","drop"))};ui.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&es(e)},20))};ui.blur=(e,t)=>{let i=t;e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),i.relatedTarget&&e.dom.contains(i.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)};ui.beforeinput=(e,t)=>{if(ti&&Zn&&t.inputType=="deleteContentBackward"){e.domObserver.flushSoon();let{domChangeCount:n}=e.input;setTimeout(()=>{if(e.input.domChangeCount!=n||(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",o=>o(e,Ao(8,"Backspace")))))return;let{$cursor:s}=e.state.selection;s&&s.pos>0&&e.dispatch(e.state.tr.delete(s.pos-1,s.pos).scrollIntoView())},50)}};for(let e in hi)ui[e]=hi[e];function xl(e,t){if(e==t)return!0;for(let i in e)if(e[i]!==t[i])return!1;for(let i in t)if(!(i in e))return!1;return!0}var Bc=class e{constructor(t,i){this.toDOM=t,this.spec=i||Oo,this.side=this.spec.side||0}map(t,i,n,s){let{pos:o,deleted:r}=t.mapResult(i.from+s,this.side<0?-1:1);return r?null:new ii(o-n,o-n,this)}valid(){return!0}eq(t){return this==t||t instanceof e&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&xl(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}},Lo=class e{constructor(t,i){this.attrs=t,this.spec=i||Oo}map(t,i,n,s){let o=t.map(i.from+s,this.spec.inclusiveStart?-1:1)-n,r=t.map(i.to+s,this.spec.inclusiveEnd?1:-1)-n;return o>=r?null:new ii(o,r,this)}valid(t,i){return i.from<i.to}eq(t){return this==t||t instanceof e&&xl(this.attrs,t.attrs)&&xl(this.spec,t.spec)}static is(t){return t.type instanceof e}destroy(){}},Yf=class e{constructor(t,i){this.attrs=t,this.spec=i||Oo}map(t,i,n,s){let o=t.mapResult(i.from+s,1);if(o.deleted)return null;let r=t.mapResult(i.to+s,-1);return r.deleted||r.pos<=o.pos?null:new ii(o.pos-n,r.pos-n,this)}valid(t,i){let{index:n,offset:s}=t.content.findIndex(i.from),o;return s==i.from&&!(o=t.child(n)).isText&&s+o.nodeSize==i.to}eq(t){return this==t||t instanceof e&&xl(this.attrs,t.attrs)&&xl(this.spec,t.spec)}destroy(){}},ii=class e{constructor(t,i,n){this.from=t,this.to=i,this.type=n}copy(t,i){return new e(t,i,this.type)}eq(t,i=0){return this.type.eq(t.type)&&this.from+i==t.from&&this.to+i==t.to}map(t,i,n){return this.type.map(t,this,i,n)}static widget(t,i,n){return new e(t,t,new Bc(i,n))}static inline(t,i,n,s){return new e(t,i,new Lo(n,s))}static node(t,i,n,s){return new e(t,i,new Yf(n,s))}get spec(){return this.type.spec}get inline(){return this.type instanceof Lo}get widget(){return this.type instanceof Bc}},$r=[],Oo={},gt=class e{constructor(t,i){this.local=t.length?t:$r,this.children=i.length?i:$r}static create(t,i){return i.length?Vc(i,t,0,Oo):ei}find(t,i,n){let s=[];return this.findInner(t??0,i??1e9,s,0,n),s}findInner(t,i,n,s,o){for(let r=0;r<this.local.length;r++){let a=this.local[r];a.from<=i&&a.to>=t&&(!o||o(a.spec))&&n.push(a.copy(a.from+s,a.to+s))}for(let r=0;r<this.children.length;r+=3)if(this.children[r]<i&&this.children[r+1]>t){let a=this.children[r]+1;this.children[r+2].findInner(t-a,i-a,n,s+a,o)}}map(t,i,n){return this==ei||t.maps.length==0?this:this.mapInner(t,i,0,0,n||Oo)}mapInner(t,i,n,s,o){let r;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(t,n,s);l&&l.type.valid(i,l)?(r||(r=[])).push(l):o.onRemove&&o.onRemove(this.local[a].spec)}return this.children.length?ZF(this.children,r||[],t,i,n,s,o):r?new e(r.sort(No),$r):ei}add(t,i){return i.length?this==ei?e.create(t,i):this.addInner(t,i,0):this}addInner(t,i,n){let s,o=0;t.forEach((a,l)=>{let d=l+n,c;if(c=_S(i,a,d)){for(s||(s=this.children.slice());o<s.length&&s[o]<l;)o+=3;s[o]==l?s[o+2]=s[o+2].addInner(a,c,d+1):s.splice(o,0,l,l+a.nodeSize,Vc(c,a,d+1,Oo)),o+=3}});let r=IS(o?LS(i):i,-n);for(let a=0;a<r.length;a++)r[a].type.valid(t,r[a])||r.splice(a--,1);return new e(r.length?this.local.concat(r).sort(No):this.local,s||this.children)}remove(t){return t.length==0||this==ei?this:this.removeInner(t,0)}removeInner(t,i){let n=this.children,s=this.local;for(let o=0;o<n.length;o+=3){let r,a=n[o]+i,l=n[o+1]+i;for(let c=0,u;c<t.length;c++)(u=t[c])&&u.from>a&&u.to<l&&(t[c]=null,(r||(r=[])).push(u));if(!r)continue;n==this.children&&(n=this.children.slice());let d=n[o+2].removeInner(r,a+1);d!=ei?n[o+2]=d:(n.splice(o,3),o-=3)}if(s.length){for(let o=0,r;o<t.length;o++)if(r=t[o])for(let a=0;a<s.length;a++)s[a].eq(r,i)&&(s==this.local&&(s=this.local.slice()),s.splice(a--,1))}return n==this.children&&s==this.local?this:s.length||n.length?new e(s,n):ei}forChild(t,i){if(this==ei)return this;if(i.isLeaf)return e.empty;let n,s;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=t){this.children[a]==t&&(n=this.children[a+2]);break}let o=t+1,r=o+i.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<r&&l.to>o&&l.type instanceof Lo){let d=Math.max(o,l.from)-o,c=Math.min(r,l.to)-o;d<c&&(s||(s=[])).push(l.copy(d,c))}}if(s){let a=new e(s.sort(No),$r);return n?new Hc([a,n]):a}return n||ei}eq(t){if(this==t)return!0;if(!(t instanceof e)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let i=0;i<this.local.length;i++)if(!this.local[i].eq(t.local[i]))return!1;for(let i=0;i<this.children.length;i+=3)if(this.children[i]!=t.children[i]||this.children[i+1]!=t.children[i+1]||!this.children[i+2].eq(t.children[i+2]))return!1;return!0}locals(t){return om(this.localsInner(t))}localsInner(t){if(this==ei)return $r;if(t.inlineContent||!this.local.some(Lo.is))return this.local;let i=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof Lo||i.push(this.local[n]);return i}forEachSet(t){t(this)}};gt.empty=new gt([],[]);gt.removeOverlap=om;var ei=gt.empty,Hc=class e{constructor(t){this.members=t}map(t,i){let n=this.members.map(s=>s.map(t,i,Oo));return e.from(n)}forChild(t,i){if(i.isLeaf)return gt.empty;let n=[];for(let s=0;s<this.members.length;s++){let o=this.members[s].forChild(t,i);o!=ei&&(o instanceof e?n=n.concat(o.members):n.push(o))}return e.from(n)}eq(t){if(!(t instanceof e)||t.members.length!=this.members.length)return!1;for(let i=0;i<this.members.length;i++)if(!this.members[i].eq(t.members[i]))return!1;return!0}locals(t){let i,n=!0;for(let s=0;s<this.members.length;s++){let o=this.members[s].localsInner(t);if(o.length)if(!i)i=o;else{n&&(i=i.slice(),n=!1);for(let r=0;r<o.length;r++)i.push(o[r])}}return i?om(n?i:i.sort(No)):$r}static from(t){switch(t.length){case 0:return ei;case 1:return t[0];default:return new e(t.every(i=>i instanceof gt)?t:t.reduce((i,n)=>i.concat(n instanceof gt?n:n.members),[]))}}forEachSet(t){for(let i=0;i<this.members.length;i++)this.members[i].forEachSet(t)}};function ZF(e,t,i,n,s,o,r){let a=e.slice();for(let d=0,c=o;d<i.maps.length;d++){let u=0;i.maps[d].forEach((h,p,g,f)=>{let m=f-g-(p-h);for(let C=0;C<a.length;C+=3){let v=a[C+1];if(v<0||h>v+c-u)continue;let w=a[C]+c-u;p>=w?a[C+1]=h<=w?-2:-1:h>=c&&m&&(a[C]+=m,a[C+1]+=m)}u+=m}),c=i.maps[d].map(c,-1)}let l=!1;for(let d=0;d<a.length;d+=3)if(a[d+1]<0){if(a[d+1]==-2){l=!0,a[d+1]=-1;continue}let c=i.map(e[d]+o),u=c-s;if(u<0||u>=n.content.size){l=!0;continue}let h=i.map(e[d+1]+o,-1),p=h-s,{index:g,offset:f}=n.content.findIndex(u),m=n.maybeChild(g);if(m&&f==u&&f+m.nodeSize==p){let C=a[d+2].mapInner(i,m,c+1,e[d]+o+1,r);C!=ei?(a[d]=u,a[d+1]=p,a[d+2]=C):(a[d+1]=-2,l=!0)}else l=!0}if(l){let d=eT(a,e,t,i,s,o,r),c=Vc(d,n,0,r);t=c.local;for(let u=0;u<a.length;u+=3)a[u+1]<0&&(a.splice(u,3),u-=3);for(let u=0,h=0;u<c.children.length;u+=3){let p=c.children[u];for(;h<a.length&&a[h]<p;)h+=3;a.splice(h,0,c.children[u],c.children[u+1],c.children[u+2])}}return new gt(t.sort(No),a)}function IS(e,t){if(!t||!e.length)return e;let i=[];for(let n=0;n<e.length;n++){let s=e[n];i.push(new ii(s.from+t,s.to+t,s.type))}return i}function eT(e,t,i,n,s,o,r){function a(l,d){for(let c=0;c<l.local.length;c++){let u=l.local[c].map(n,s,d);u?i.push(u):r.onRemove&&r.onRemove(l.local[c].spec)}for(let c=0;c<l.children.length;c+=3)a(l.children[c+2],l.children[c]+d+1)}for(let l=0;l<e.length;l+=3)e[l+1]==-1&&a(e[l+2],t[l]+o+1);return i}function _S(e,t,i){if(t.isLeaf)return null;let n=i+t.nodeSize,s=null;for(let o=0,r;o<e.length;o++)(r=e[o])&&r.from>i&&r.to<n&&((s||(s=[])).push(r),e[o]=null);return s}function LS(e){let t=[];for(let i=0;i<e.length;i++)e[i]!=null&&t.push(e[i]);return t}function Vc(e,t,i,n){let s=[],o=!1;t.forEach((a,l)=>{let d=_S(e,a,l+i);if(d){o=!0;let c=Vc(d,a,i+l+1,n);c!=ei&&s.push(l,l+a.nodeSize,c)}});let r=IS(o?LS(e):e,-i).sort(No);for(let a=0;a<r.length;a++)r[a].type.valid(t,r[a])||(n.onRemove&&n.onRemove(r[a].spec),r.splice(a--,1));return r.length||s.length?new gt(r,s):ei}function No(e,t){return e.from-t.from||e.to-t.to}function om(e){let t=e;for(let i=0;i<t.length-1;i++){let n=t[i];if(n.from!=n.to)for(let s=i+1;s<t.length;s++){let o=t[s];if(o.from==n.from){o.to!=n.to&&(t==e&&(t=e.slice()),t[s]=o.copy(o.from,n.to),Yy(t,s+1,o.copy(n.to,o.to)));continue}else{o.from<n.to&&(t==e&&(t=e.slice()),t[i]=n.copy(n.from,o.from),Yy(t,s,n.copy(o.from,n.to)));break}}}return t}function Yy(e,t,i){for(;t<e.length&&No(i,e[t])>0;)t++;e.splice(t,0,i)}function Af(e){let t=[];return e.someProp("decorations",i=>{let n=i(e.state);n&&n!=ei&&t.push(n)}),e.cursorWrapper&&t.push(gt.create(e.state.doc,[e.cursorWrapper.deco])),Hc.from(t)}var tT={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},iT=vi&&Ns<=11,Xf=class{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}},Jf=class{constructor(t,i){this.view=t,this.handleDOMChange=i,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new Xf,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(n=>{for(let s=0;s<n.length;s++)this.queue.push(n[s]);vi&&Ns<=11&&n.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),iT&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,tT)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let i=0;i<t.length;i++)this.queue.push(t[i]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Gy(this.view)){if(this.suppressingSelectionUpdates)return es(this.view);if(vi&&Ns<=11&&!this.view.state.selection.empty){let t=this.view.domSelectionRange();if(t.focusNode&&Bo(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(t){if(!t.focusNode)return!0;let i=new Set,n;for(let o=t.focusNode;o;o=Kr(o))i.add(o);for(let o=t.anchorNode;o;o=Kr(o))if(i.has(o)){n=o;break}let s=n&&this.view.docView.nearestDesc(n);if(s&&s.ignoreMutation({type:"selection",target:n.nodeType==3?n.parentNode:n}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}flush(){let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let i=this.pendingRecords();i.length&&(this.queue=[]);let n=t.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&Gy(t)&&!this.ignoreSelectionChange(n),o=-1,r=-1,a=!1,l=[];if(t.editable)for(let c=0;c<i.length;c++){let u=this.registerMutation(i[c],l);u&&(o=o<0?u.from:Math.min(u.from,o),r=r<0?u.to:Math.max(u.to,r),u.typeOver&&(a=!0))}if(Ni&&l.length){let c=l.filter(u=>u.nodeName=="BR");if(c.length==2){let[u,h]=c;u.parentNode&&u.parentNode.parentNode==h.parentNode?h.remove():u.remove()}else{let{focusNode:u}=this.currentSelection;for(let h of c){let p=h.parentNode;p&&p.nodeName=="LI"&&(!u||oT(t,u)!=p)&&h.remove()}}}let d=null;o<0&&s&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&Gc(n)&&(d=Zf(t))&&d.eq(ge.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,es(t),this.currentSelection.set(n),t.scrollToSelection()):(o>-1||s)&&(o>-1&&(t.docView.markDirty(o,r),nT(t)),this.handleDOMChange(o,r,a,l),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(n)||es(t),this.currentSelection.set(n))}registerMutation(t,i){if(i.indexOf(t.target)>-1)return null;let n=this.view.docView.nearestDesc(t.target);if(t.type=="attributes"&&(n==this.view.docView||t.attributeName=="contenteditable"||t.attributeName=="style"&&!t.oldValue&&!t.target.getAttribute("style"))||!n||n.ignoreMutation(t))return null;if(t.type=="childList"){for(let c=0;c<t.addedNodes.length;c++){let u=t.addedNodes[c];i.push(u),u.nodeType==3&&(this.lastChangedTextNode=u)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(t.target))return{from:n.posBefore,to:n.posAfter};let s=t.previousSibling,o=t.nextSibling;if(vi&&Ns<=11&&t.addedNodes.length)for(let c=0;c<t.addedNodes.length;c++){let{previousSibling:u,nextSibling:h}=t.addedNodes[c];(!u||Array.prototype.indexOf.call(t.addedNodes,u)<0)&&(s=u),(!h||Array.prototype.indexOf.call(t.addedNodes,h)<0)&&(o=h)}let r=s&&s.parentNode==t.target?zt(s)+1:0,a=n.localPosFromDOM(t.target,r,-1),l=o&&o.parentNode==t.target?zt(o):t.target.childNodes.length,d=n.localPosFromDOM(t.target,l,1);return{from:a,to:d}}else return t.type=="attributes"?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=t.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:t.target.nodeValue==t.oldValue})}},Xy=new WeakMap,Jy=!1;function nT(e){if(!Xy.has(e)&&(Xy.set(e,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace)!==-1)){if(e.requiresGeckoHackNode=Ni,Jy)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Jy=!0}}function Qy(e,t){let i=t.startContainer,n=t.startOffset,s=t.endContainer,o=t.endOffset,r=e.domAtPos(e.state.selection.anchor);return Bo(r.node,r.offset,s,o)&&([i,n,s,o]=[s,o,i,n]),{anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:o}}function sT(e,t){if(t.getComposedRanges){let s=t.getComposedRanges(e.root)[0];if(s)return Qy(e,s)}let i;function n(s){s.preventDefault(),s.stopImmediatePropagation(),i=s.getTargetRanges()[0]}return e.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",n,!0),i?Qy(e,i):null}function oT(e,t){for(let i=t.parentNode;i&&i!=e.dom;i=i.parentNode){let n=e.docView.nearestDesc(i,!0);if(n&&n.node.isBlock)return i}return null}function rT(e,t,i){let{node:n,fromOffset:s,toOffset:o,from:r,to:a}=e.docView.parseRange(t,i),l=e.domSelectionRange(),d,c=l.anchorNode;if(c&&e.dom.contains(c.nodeType==1?c:c.parentNode)&&(d=[{node:c,offset:l.anchorOffset}],Gc(l)||d.push({node:l.focusNode,offset:l.focusOffset})),ti&&e.input.lastKeyCode===8)for(let m=o;m>s;m--){let C=n.childNodes[m-1],v=C.pmViewDesc;if(C.nodeName=="BR"&&!v){o=m;break}if(!v||v.size)break}let u=e.state.doc,h=e.someProp("domParser")||mn.fromSchema(e.state.schema),p=u.resolve(r),g=null,f=h.parse(n,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:s,to:o,preserveWhitespace:p.parent.type.whitespace=="pre"?"full":!0,findPositions:d,ruleFromNode:aT,context:p});if(d&&d[0].pos!=null){let m=d[0].pos,C=d[1]&&d[1].pos;C==null&&(C=m),g={anchor:m+r,head:C+r}}return{doc:f,sel:g,from:r,to:a}}function aT(e){let t=e.pmViewDesc;if(t)return t.parseRule();if(e.nodeName=="BR"&&e.parentNode){if(ci&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let i=document.createElement("div");return i.appendChild(document.createElement("li")),{skip:i}}else if(e.parentNode.lastChild==e||ci&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if(e.nodeName=="IMG"&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}var lT=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function dT(e,t,i,n,s){let o=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,t<0){let E=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,T=Zf(e,E);if(T&&!e.state.selection.eq(T)){if(ti&&Zn&&e.input.lastKeyCode===13&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",N=>N(e,Ao(13,"Enter"))))return;let L=e.state.tr.setSelection(T);E=="pointer"?L.setMeta("pointer",!0):E=="key"&&L.scrollIntoView(),o&&L.setMeta("composition",o),e.dispatch(L)}return}let r=e.state.doc.resolve(t),a=r.sharedDepth(i);t=r.before(a+1),i=e.state.doc.resolve(i).after(a+1);let l=e.state.selection,d=rT(e,t,i),c=e.state.doc,u=c.slice(d.from,d.to),h,p;e.input.lastKeyCode===8&&Date.now()-100<e.input.lastKeyCodeTime?(h=e.state.selection.to,p="end"):(h=e.state.selection.from,p="start"),e.input.lastKeyCode=null;let g=hT(u.content,d.doc.content,d.from,h,p);if(g&&e.input.domChangeCount++,(Yr&&e.input.lastIOSEnter>Date.now()-225||Zn)&&s.some(E=>E.nodeType==1&&!lT.test(E.nodeName))&&(!g||g.endA>=g.endB)&&e.someProp("handleKeyDown",E=>E(e,Ao(13,"Enter")))){e.input.lastIOSEnter=0;return}if(!g)if(n&&l instanceof le&&!l.empty&&l.$head.sameParent(l.$anchor)&&!e.composing&&!(d.sel&&d.sel.anchor!=d.sel.head))g={start:l.from,endA:l.to,endB:l.to};else{if(d.sel){let E=Zy(e,e.state.doc,d.sel);if(E&&!E.eq(e.state.selection)){let T=e.state.tr.setSelection(E);o&&T.setMeta("composition",o),e.dispatch(T)}}return}e.state.selection.from<e.state.selection.to&&g.start==g.endB&&e.state.selection instanceof le&&(g.start>e.state.selection.from&&g.start<=e.state.selection.from+2&&e.state.selection.from>=d.from?g.start=e.state.selection.from:g.endA<e.state.selection.to&&g.endA>=e.state.selection.to-2&&e.state.selection.to<=d.to&&(g.endB+=e.state.selection.to-g.endA,g.endA=e.state.selection.to)),vi&&Ns<=11&&g.endB==g.start+1&&g.endA==g.start&&g.start>d.from&&d.doc.textBetween(g.start-d.from-1,g.start-d.from+1)==" \xA0"&&(g.start--,g.endA--,g.endB--);let f=d.doc.resolveNoCache(g.start-d.from),m=d.doc.resolveNoCache(g.endB-d.from),C=c.resolve(g.start),v=f.sameParent(m)&&f.parent.inlineContent&&C.end()>=g.endA;if((Yr&&e.input.lastIOSEnter>Date.now()-225&&(!v||s.some(E=>E.nodeName=="DIV"||E.nodeName=="P"))||!v&&f.pos<d.doc.content.size&&(!f.sameParent(m)||!f.parent.inlineContent)&&f.pos<m.pos&&!/\S/.test(d.doc.textBetween(f.pos,m.pos,"","")))&&e.someProp("handleKeyDown",E=>E(e,Ao(13,"Enter")))){e.input.lastIOSEnter=0;return}if(e.state.selection.anchor>g.start&&uT(c,g.start,g.endA,f,m)&&e.someProp("handleKeyDown",E=>E(e,Ao(8,"Backspace")))){Zn&&ti&&e.domObserver.suppressSelectionUpdates();return}ti&&g.endB==g.start&&(e.input.lastChromeDelete=Date.now()),Zn&&!v&&f.start()!=m.start()&&m.parentOffset==0&&f.depth==m.depth&&d.sel&&d.sel.anchor==d.sel.head&&d.sel.head==g.endA&&(g.endB-=2,m=d.doc.resolveNoCache(g.endB-d.from),setTimeout(()=>{e.someProp("handleKeyDown",function(E){return E(e,Ao(13,"Enter"))})},20));let w=g.start,y=g.endA,S=E=>{let T=E||e.state.tr.replace(w,y,d.doc.slice(g.start-d.from,g.endB-d.from));if(d.sel){let L=Zy(e,T.doc,d.sel);L&&!(ti&&e.composing&&L.empty&&(g.start!=g.endB||e.input.lastChromeDelete<Date.now()-100)&&(L.head==w||L.head==T.mapping.map(y)-1)||vi&&L.empty&&L.head==w)&&T.setSelection(L)}return o&&T.setMeta("composition",o),T.scrollIntoView()},x;if(v)if(f.pos==m.pos){vi&&Ns<=11&&f.parentOffset==0&&(e.domObserver.suppressSelectionUpdates(),setTimeout(()=>es(e),20));let E=S(e.state.tr.delete(w,y)),T=c.resolve(g.start).marksAcross(c.resolve(g.endA));T&&E.ensureMarks(T),e.dispatch(E)}else if(g.endA==g.endB&&(x=cT(f.parent.content.cut(f.parentOffset,m.parentOffset),C.parent.content.cut(C.parentOffset,g.endA-C.start())))){let E=S(e.state.tr);x.type=="add"?E.addMark(w,y,x.mark):E.removeMark(w,y,x.mark),e.dispatch(E)}else if(f.parent.child(f.index()).isText&&f.index()==m.index()-(m.textOffset?0:1)){let E=f.parent.textBetween(f.parentOffset,m.parentOffset),T=()=>S(e.state.tr.insertText(E,w,y));e.someProp("handleTextInput",L=>L(e,w,y,E,T))||e.dispatch(T())}else e.dispatch(S());else e.dispatch(S())}function Zy(e,t,i){return Math.max(i.anchor,i.head)>t.content.size?null:em(e,t.resolve(i.anchor),t.resolve(i.head))}function cT(e,t){let i=e.firstChild.marks,n=t.firstChild.marks,s=i,o=n,r,a,l;for(let c=0;c<n.length;c++)s=n[c].removeFromSet(s);for(let c=0;c<i.length;c++)o=i[c].removeFromSet(o);if(s.length==1&&o.length==0)a=s[0],r="add",l=c=>c.mark(a.addToSet(c.marks));else if(s.length==0&&o.length==1)a=o[0],r="remove",l=c=>c.mark(a.removeFromSet(c.marks));else return null;let d=[];for(let c=0;c<t.childCount;c++)d.push(l(t.child(c)));if(B.from(d).eq(e))return{mark:a,type:r}}function uT(e,t,i,n,s){if(i-t<=s.pos-n.pos||If(n,!0,!1)<s.pos)return!1;let o=e.resolve(t);if(!n.parent.isTextblock){let a=o.nodeAfter;return a!=null&&i==t+a.nodeSize}if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let r=e.resolve(If(o,!0,!0));return!r.parent.isTextblock||r.pos>i||If(r,!0,!1)<i?!1:n.parent.content.cut(n.parentOffset).eq(r.parent.content)}function If(e,t,i){let n=e.depth,s=t?e.end():e.pos;for(;n>0&&(t||e.indexAfter(n)==e.node(n).childCount);)n--,s++,t=!1;if(i){let o=e.node(n).maybeChild(e.indexAfter(n));for(;o&&!o.isLeaf;)o=o.firstChild,s++}return s}function hT(e,t,i,n,s){let o=e.findDiffStart(t,i);if(o==null)return null;let{a:r,b:a}=e.findDiffEnd(t,i+e.size,i+t.size);if(s=="end"){let l=Math.max(0,o-Math.min(r,a));n-=r+l-o}if(r<o&&e.size<t.size){let l=n<=o&&n>=r?o-n:0;o-=l,o&&o<t.size&&eS(t.textBetween(o-1,o+1))&&(o+=l?1:-1),a=o+(a-r),r=o}else if(a<o){let l=n<=o&&n>=a?o-n:0;o-=l,o&&o<e.size&&eS(e.textBetween(o-1,o+1))&&(o+=l?1:-1),r=o+(r-a),a=o}return{start:o,endA:r,endB:a}}function eS(e){if(e.length!=2)return!1;let t=e.charCodeAt(0),i=e.charCodeAt(1);return t>=56320&&t<=57343&&i>=55296&&i<=56319}var El=class{constructor(t,i){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new $f,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=i,this.state=i.state,this.directPlugins=i.plugins||[],this.directPlugins.forEach(oS),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):typeof t=="function"?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=nS(this),iS(this),this.nodeViews=sS(this),this.docView=Ly(this.state.doc,tS(this),Af(this),this.dom,this),this.domObserver=new Jf(this,(n,s,o,r)=>dT(this,n,s,o,r)),this.domObserver.start(),LF(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let i in t)this._props[i]=t[i];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&jf(this);let i=this._props;this._props=t,t.plugins&&(t.plugins.forEach(oS),this.directPlugins=t.plugins),this.updateStateInner(t.state,i)}setProps(t){let i={};for(let n in this._props)i[n]=this._props[n];i.state=this.state;for(let n in t)i[n]=t[n];this.update(i)}updateState(t){this.updateStateInner(t,this._props)}updateStateInner(t,i){var n;let s=this.state,o=!1,r=!1;t.storedMarks&&this.composing&&(FS(this),r=!0),this.state=t;let a=s.plugins!=t.plugins||this._props.plugins!=i.plugins;if(a||this._props.plugins!=i.plugins||this._props.nodeViews!=i.nodeViews){let p=sS(this);gT(p,this.nodeViews)&&(this.nodeViews=p,o=!0)}(a||i.handleDOMEvents!=this._props.handleDOMEvents)&&jf(this),this.editable=nS(this),iS(this);let l=Af(this),d=tS(this),c=s.plugins!=t.plugins&&!s.doc.eq(t.doc)?"reset":t.scrollToSelection>s.scrollToSelection?"to selection":"preserve",u=o||!this.docView.matchesNode(t.doc,d,l);(u||!t.selection.eq(s.selection))&&(r=!0);let h=c=="preserve"&&r&&this.dom.style.overflowAnchor==null&&ZP(this);if(r){this.domObserver.stop();let p=u&&(vi||ti)&&!this.composing&&!s.selection.empty&&!t.selection.empty&&pT(s.selection,t.selection);if(u){let g=ti?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=jF(this)),(o||!this.docView.update(t.doc,d,l,this))&&(this.docView.updateOuterDeco(d),this.docView.destroy(),this.docView=Ly(t.doc,d,l,this.dom,this)),g&&!this.trackWrites&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&bF(this))?es(this,p):(vS(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(s),!((n=this.dragging)===null||n===void 0)&&n.node&&!s.doc.eq(t.doc)&&this.updateDraggedNode(this.dragging,s),c=="reset"?this.dom.scrollTop=0:c=="to selection"?this.scrollToSelection():h&&eF(h)}scrollToSelection(){let t=this.domSelectionRange().focusNode;if(!(!t||!this.dom.contains(t.nodeType==1?t:t.parentNode))){if(!this.someProp("handleScrollToSelection",i=>i(this)))if(this.state.selection instanceof ne){let i=this.docView.domAfterPos(this.state.selection.from);i.nodeType==1&&Py(this,i.getBoundingClientRect(),t)}else Py(this,this.coordsAtPos(this.state.selection.head,1),t)}}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(!t||t.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let i=0;i<this.directPlugins.length;i++){let n=this.directPlugins[i];n.spec.view&&this.pluginViews.push(n.spec.view(this))}for(let i=0;i<this.state.plugins.length;i++){let n=this.state.plugins[i];n.spec.view&&this.pluginViews.push(n.spec.view(this))}}else for(let i=0;i<this.pluginViews.length;i++){let n=this.pluginViews[i];n.update&&n.update(this,t)}}updateDraggedNode(t,i){let n=t.node,s=-1;if(this.state.doc.nodeAt(n.from)==n.node)s=n.from;else{let o=n.from+(this.state.doc.content.size-i.doc.content.size);(o>0&&this.state.doc.nodeAt(o))==n.node&&(s=o)}this.dragging=new Nc(t.slice,t.move,s<0?void 0:ne.create(this.state.doc,s))}someProp(t,i){let n=this._props&&this._props[t],s;if(n!=null&&(s=i?i(n):n))return s;for(let r=0;r<this.directPlugins.length;r++){let a=this.directPlugins[r].props[t];if(a!=null&&(s=i?i(a):a))return s}let o=this.state.plugins;if(o)for(let r=0;r<o.length;r++){let a=o[r].props[t];if(a!=null&&(s=i?i(a):a))return s}}hasFocus(){if(vi){let t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if(t.contentEditable=="false")return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&tF(this.dom),es(this),this.domObserver.start()}get root(){let t=this._root;if(t==null){for(let i=this.dom.parentNode;i;i=i.parentNode)if(i.nodeType==9||i.nodeType==11&&i.host)return i.getSelection||(Object.getPrototypeOf(i).getSelection=()=>i.ownerDocument.getSelection()),this._root=i}return t||document}updateRoot(){this._root=null}posAtCoords(t){return rF(this,t)}coordsAtPos(t,i=1){return hS(this,t,i)}domAtPos(t,i=0){return this.docView.domFromPos(t,i)}nodeDOM(t){let i=this.docView.descAt(t);return i?i.nodeDOM:null}posAtDOM(t,i,n=-1){let s=this.docView.posFromDOM(t,i,n);if(s==null)throw new RangeError("DOM position not inside the editor");return s}endOfTextblock(t,i){return uF(this,i||this.state,t)}pasteHTML(t,i){return Sl(this,"",t,!1,i||new ClipboardEvent("paste"))}pasteText(t,i){return Sl(this,t,null,!0,i||new ClipboardEvent("paste"))}serializeForClipboard(t){return tm(this,t)}destroy(){this.docView&&(OF(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Af(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,zP())}get isDestroyed(){return this.docView==null}dispatchEvent(t){return BF(this,t)}domSelectionRange(){let t=this.domSelection();return t?ci&&this.root.nodeType===11&&jP(this.dom.ownerDocument)==this.dom&&sT(this,t)||t:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}};El.prototype.dispatch=function(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))};function tS(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",i=>{if(typeof i=="function"&&(i=i(e.state)),i)for(let n in i)n=="class"?t.class+=" "+i[n]:n=="style"?t.style=(t.style?t.style+";":"")+i[n]:!t[n]&&n!="contenteditable"&&n!="nodeName"&&(t[n]=String(i[n]))}),t.translate||(t.translate="no"),[ii.node(0,e.state.doc.content.size,t)]}function iS(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:ii.widget(e.state.selection.from,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function nS(e){return!e.someProp("editable",t=>t(e.state)===!1)}function pT(e,t){let i=Math.min(e.$anchor.sharedDepth(e.head),t.$anchor.sharedDepth(t.head));return e.$anchor.start(i)!=t.$anchor.start(i)}function sS(e){let t=Object.create(null);function i(n){for(let s in n)Object.prototype.hasOwnProperty.call(t,s)||(t[s]=n[s])}return e.someProp("nodeViews",i),e.someProp("markViews",i),t}function gT(e,t){let i=0,n=0;for(let s in e){if(e[s]!=t[s])return!0;i++}for(let s in t)n++;return i!=n}function oS(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var ts={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Uc={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},fT=typeof navigator<"u"&&/Mac/.test(navigator.platform),mT=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(Rt=0;Rt<10;Rt++)ts[48+Rt]=ts[96+Rt]=String(Rt);var Rt;for(Rt=1;Rt<=24;Rt++)ts[Rt+111]="F"+Rt;var Rt;for(Rt=65;Rt<=90;Rt++)ts[Rt]=String.fromCharCode(Rt+32),Uc[Rt]=String.fromCharCode(Rt);var Rt;for(Wc in ts)Uc.hasOwnProperty(Wc)||(Uc[Wc]=ts[Wc]);var Wc;function OS(e){var t=fT&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||mT&&e.shiftKey&&e.key&&e.key.length==1||e.key=="Unidentified",i=!t&&e.key||(e.shiftKey?Uc:ts)[e.keyCode]||e.key||"Unidentified";return i=="Esc"&&(i="Escape"),i=="Del"&&(i="Delete"),i=="Left"&&(i="ArrowLeft"),i=="Up"&&(i="ArrowUp"),i=="Right"&&(i="ArrowRight"),i=="Down"&&(i="ArrowDown"),i}var CT=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),vT=typeof navigator<"u"&&/Win/.test(navigator.platform);function wT(e){let t=e.split(/-(?!$)/),i=t[t.length-1];i=="Space"&&(i=" ");let n,s,o,r;for(let a=0;a<t.length-1;a++){let l=t[a];if(/^(cmd|meta|m)$/i.test(l))r=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))CT?r=!0:s=!0;else throw new Error("Unrecognized modifier name: "+l)}return n&&(i="Alt-"+i),s&&(i="Ctrl-"+i),r&&(i="Meta-"+i),o&&(i="Shift-"+i),i}function bT(e){let t=Object.create(null);for(let i in e)t[wT(i)]=e[i];return t}function rm(e,t,i=!0){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),i&&t.shiftKey&&(e="Shift-"+e),e}function NS(e){return new fe({props:{handleKeyDown:am(e)}})}function am(e){let t=bT(e);return function(i,n){let s=OS(n),o,r=t[rm(s,n)];if(r&&r(i.state,i.dispatch,i))return!0;if(s.length==1&&s!=" "){if(n.shiftKey){let a=t[rm(s,n,!1)];if(a&&a(i.state,i.dispatch,i))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(vT&&n.ctrlKey&&n.altKey)&&(o=ts[n.keyCode])&&o!=s){let a=t[rm(o,n)];if(a&&a(i.state,i.dispatch,i))return!0}}return!1}}var yT=Object.defineProperty,gm=(e,t)=>{for(var i in t)yT(e,i,{get:t[i],enumerable:!0})};function Qc(e){let{state:t,transaction:i}=e,{selection:n}=i,{doc:s}=i,{storedMarks:o}=i;return O(b({},t),{apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return o},get selection(){return n},get doc(){return s},get tr(){return n=i.selection,s=i.doc,o=i.storedMarks,i}})}var Zc=class{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){let{rawCommands:e,editor:t,state:i}=this,{view:n}=t,{tr:s}=i,o=this.buildProps(s);return Object.fromEntries(Object.entries(e).map(([r,a])=>[r,(...d)=>{let c=a(...d)(o);return!s.getMeta("preventDispatch")&&!this.hasCustomState&&n.dispatch(s),c}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){let{rawCommands:i,editor:n,state:s}=this,{view:o}=n,r=[],a=!!e,l=e||s.tr,d=()=>(!a&&t&&!l.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(l),r.every(u=>u===!0)),c=O(b({},Object.fromEntries(Object.entries(i).map(([u,h])=>[u,(...g)=>{let f=this.buildProps(l,t),m=h(...g)(f);return r.push(m),c}]))),{run:d});return c}createCan(e){let{rawCommands:t,state:i}=this,n=!1,s=e||i.tr,o=this.buildProps(s,n),r=Object.fromEntries(Object.entries(t).map(([a,l])=>[a,(...d)=>l(...d)(O(b({},o),{dispatch:void 0}))]));return O(b({},r),{chain:()=>this.createChain(s,n)})}buildProps(e,t=!0){let{rawCommands:i,editor:n,state:s}=this,{view:o}=n,r={tr:e,editor:n,view:o,state:Qc({state:s,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(i).map(([a,l])=>[a,(...d)=>l(...d)(r)]))}};return r}},jS={};gm(jS,{blur:()=>ST,clearContent:()=>xT,clearNodes:()=>ET,command:()=>RT,createParagraphNear:()=>MT,cut:()=>DT,deleteCurrentNode:()=>kT,deleteNode:()=>PT,deleteRange:()=>FT,deleteSelection:()=>TT,enter:()=>AT,exitCode:()=>IT,extendMarkRange:()=>_T,first:()=>LT,focus:()=>NT,forEach:()=>BT,insertContent:()=>HT,insertContentAt:()=>zT,joinBackward:()=>qT,joinDown:()=>UT,joinForward:()=>$T,joinItemBackward:()=>jT,joinItemForward:()=>KT,joinTextblockBackward:()=>YT,joinTextblockForward:()=>XT,joinUp:()=>WT,keyboardShortcut:()=>QT,lift:()=>ZT,liftEmptyBlock:()=>e5,liftListItem:()=>t5,newlineInCode:()=>i5,resetAttributes:()=>n5,scrollIntoView:()=>s5,selectAll:()=>o5,selectNodeBackward:()=>r5,selectNodeForward:()=>a5,selectParentNode:()=>l5,selectTextblockEnd:()=>d5,selectTextblockStart:()=>c5,setContent:()=>u5,setMark:()=>R5,setMeta:()=>M5,setNode:()=>D5,setNodeSelection:()=>k5,setTextDirection:()=>P5,setTextSelection:()=>F5,sinkListItem:()=>T5,splitBlock:()=>A5,splitListItem:()=>I5,toggleList:()=>_5,toggleMark:()=>L5,toggleNode:()=>O5,toggleWrap:()=>N5,undoInputRule:()=>B5,unsetAllMarks:()=>H5,unsetMark:()=>V5,unsetTextDirection:()=>G5,updateAttributes:()=>z5,wrapIn:()=>W5,wrapInList:()=>U5});var ST=()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var i;e.isDestroyed||(t.dom.blur(),(i=window?.getSelection())==null||i.removeAllRanges())}),!0),xT=(e=!0)=>({commands:t})=>t.setContent("",{emitUpdate:e}),ET=()=>({state:e,tr:t,dispatch:i})=>{let{selection:n}=t,{ranges:s}=n;return i&&s.forEach(({$from:o,$to:r})=>{e.doc.nodesBetween(o.pos,r.pos,(a,l)=>{if(a.type.isText)return;let{doc:d,mapping:c}=t,u=d.resolve(c.map(l)),h=d.resolve(c.map(l+a.nodeSize)),p=u.blockRange(h);if(!p)return;let g=Xn(p);if(a.type.isTextblock){let{defaultType:f}=u.parent.contentMatchAt(u.index());t.setNodeMarkup(p.start,f)}(g||g===0)&&t.lift(p,g)})}),!0},RT=e=>t=>e(t),MT=()=>({state:e,dispatch:t})=>xf(e,t),DT=(e,t)=>({editor:i,tr:n})=>{let{state:s}=i,o=s.doc.slice(e.from,e.to);n.deleteRange(e.from,e.to);let r=n.mapping.map(t);return n.insert(r,o.content),n.setSelection(new le(n.doc.resolve(Math.max(r-1,0)))),!0},kT=()=>({tr:e,dispatch:t})=>{let{selection:i}=e,n=i.$anchor.node();if(n.content.size>0)return!1;let s=e.selection.$anchor;for(let o=s.depth;o>0;o-=1)if(s.node(o).type===n.type){if(t){let a=s.before(o),l=s.after(o);e.delete(a,l).scrollIntoView()}return!0}return!1};function ct(e,t){if(typeof e=="string"){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}var PT=e=>({tr:t,state:i,dispatch:n})=>{let s=ct(e,i.schema),o=t.selection.$anchor;for(let r=o.depth;r>0;r-=1)if(o.node(r).type===s){if(n){let l=o.before(r),d=o.after(r);t.delete(l,d).scrollIntoView()}return!0}return!1},FT=e=>({tr:t,dispatch:i})=>{let{from:n,to:s}=e;return i&&t.delete(n,s),!0},TT=()=>({state:e,dispatch:t})=>Fc(e,t),AT=()=>({commands:e})=>e.keyboardShortcut("Enter"),IT=()=>({state:e,dispatch:t})=>Sf(e,t);function fm(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function Xc(e,t,i={strict:!0}){let n=Object.keys(t);return n.length?n.every(s=>i.strict?t[s]===e[s]:fm(t[s])?t[s].test(e[s]):t[s]===e[s]):!0}function KS(e,t,i={}){return e.find(n=>n.type===t&&Xc(Object.fromEntries(Object.keys(i).map(s=>[s,n.attrs[s]])),i))}function BS(e,t,i={}){return!!KS(e,t,i)}function mm(e,t,i){var n;if(!e||!t)return;let s=e.parent.childAfter(e.parentOffset);if((!s.node||!s.node.marks.some(c=>c.type===t))&&(s=e.parent.childBefore(e.parentOffset)),!s.node||!s.node.marks.some(c=>c.type===t)||(i=i||((n=s.node.marks[0])==null?void 0:n.attrs),!KS([...s.node.marks],t,i)))return;let r=s.index,a=e.start()+s.offset,l=r+1,d=a+s.node.nodeSize;for(;r>0&&BS([...e.parent.child(r-1).marks],t,i);)r-=1,a-=e.parent.child(r).nodeSize;for(;l<e.parent.childCount&&BS([...e.parent.child(l).marks],t,i);)d+=e.parent.child(l).nodeSize,l+=1;return{from:a,to:d}}function is(e,t){if(typeof e=="string"){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}var _T=(e,t={})=>({tr:i,state:n,dispatch:s})=>{let o=is(e,n.schema),{doc:r,selection:a}=i,{$from:l,from:d,to:c}=a;if(s){let u=mm(l,o,t);if(u&&u.from<=d&&u.to>=c){let h=le.create(r,u.from,u.to);i.setSelection(h)}}return!0},LT=e=>t=>{let i=typeof e=="function"?e(t):e;for(let n=0;n<i.length;n+=1)if(i[n](t))return!0;return!1};function YS(e){return e instanceof le}function Vo(e=0,t=0,i=0){return Math.min(Math.max(e,t),i)}function XS(e,t=null){if(!t)return null;let i=ge.atStart(e),n=ge.atEnd(e);if(t==="start"||t===!0)return i;if(t==="end")return n;let s=i.from,o=n.to;return t==="all"?le.create(e,Vo(0,s,o),Vo(e.content.size,s,o)):le.create(e,Vo(t,s,o),Vo(t,s,o))}function OT(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function Cm(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var NT=(e=null,t={})=>({editor:i,view:n,tr:s,dispatch:o})=>{t=b({scrollIntoView:!0},t);let r=()=>{(Cm()||OT())&&n.dom.focus(),requestAnimationFrame(()=>{i.isDestroyed||(n.focus(),t?.scrollIntoView&&i.commands.scrollIntoView())})};if(n.hasFocus()&&e===null||e===!1)return!0;if(o&&e===null&&!YS(i.state.selection))return r(),!0;let a=XS(s.doc,e)||i.state.selection,l=i.state.selection.eq(a);return o&&(l||s.setSelection(a),l&&s.storedMarks&&s.setStoredMarks(s.storedMarks),r()),!0},BT=(e,t)=>i=>e.every((n,s)=>t(n,O(b({},i),{index:s}))),HT=(e,t)=>({tr:i,commands:n})=>n.insertContentAt({from:i.selection.from,to:i.selection.to},e,t),JS=e=>{let t=e.childNodes;for(let i=t.length-1;i>=0;i-=1){let n=t[i];n.nodeType===3&&n.nodeValue&&/^(\n\s\s|\n)$/.test(n.nodeValue)?e.removeChild(n):n.nodeType===1&&JS(n)}return e};function qc(e){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");let t=`<body>${e}</body>`,i=new window.DOMParser().parseFromString(t,"text/html").body;return JS(i)}function Dl(e,t,i){if(e instanceof Ci||e instanceof B)return e;i=b({slice:!0,parseOptions:{}},i);let n=typeof e=="object"&&e!==null,s=typeof e=="string";if(n)try{if(Array.isArray(e)&&e.length>0)return B.fromArray(e.map(a=>t.nodeFromJSON(a)));let r=t.nodeFromJSON(e);return i.errorOnInvalidContent&&r.check(),r}catch(o){if(i.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",o),Dl("",t,i)}if(s){if(i.errorOnInvalidContent){let r=!1,a="",l=new Nr({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:d=>(r=!0,a=typeof d=="string"?d:d.outerHTML,null)}]}})});if(i.slice?mn.fromSchema(l).parseSlice(qc(e),i.parseOptions):mn.fromSchema(l).parse(qc(e),i.parseOptions),i.errorOnInvalidContent&&r)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}let o=mn.fromSchema(t);return i.slice?o.parseSlice(qc(e),i.parseOptions).content:o.parse(qc(e),i.parseOptions)}return Dl("",t,i)}function VT(e,t,i){let n=e.steps.length-1;if(n<t)return;let s=e.steps[n];if(!(s instanceof Zt||s instanceof Et))return;let o=e.mapping.maps[n],r=0;o.forEach((a,l,d,c)=>{r===0&&(r=c)}),e.setSelection(ge.near(e.doc.resolve(r),i))}var GT=e=>!("type"in e),zT=(e,t,i)=>({tr:n,dispatch:s,editor:o})=>{var r;if(s){i=b({parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1},i);let a,l=m=>{o.emit("contentError",{editor:o,error:m,disableCollaboration:()=>{"collaboration"in o.storage&&typeof o.storage.collaboration=="object"&&o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}})},d=b({preserveWhitespace:"full"},i.parseOptions);if(!i.errorOnInvalidContent&&!o.options.enableContentCheck&&o.options.emitContentError)try{Dl(t,o.schema,{parseOptions:d,errorOnInvalidContent:!0})}catch(m){l(m)}try{a=Dl(t,o.schema,{parseOptions:d,errorOnInvalidContent:(r=i.errorOnInvalidContent)!=null?r:o.options.enableContentCheck})}catch(m){return l(m),!1}let{from:c,to:u}=typeof e=="number"?{from:e,to:e}:{from:e.from,to:e.to},h=!0,p=!0;if((GT(a)?a:[a]).forEach(m=>{m.check(),h=h?m.isText&&m.marks.length===0:!1,p=p?m.isBlock:!1}),c===u&&p){let{parent:m}=n.doc.resolve(c);m.isTextblock&&!m.type.spec.code&&!m.childCount&&(c-=1,u+=1)}let f;if(h){if(Array.isArray(t))f=t.map(m=>m.text||"").join("");else if(t instanceof B){let m="";t.forEach(C=>{C.text&&(m+=C.text)}),f=m}else typeof t=="object"&&t&&t.text?f=t.text:f=t;n.insertText(f,c,u)}else{f=a;let m=n.doc.resolve(c),C=m.node(),v=m.parentOffset===0,w=C.isText||C.isTextblock,y=C.content.size>0;v&&w&&y&&(c=Math.max(0,c-1)),n.replaceWith(c,u,f)}i.updateSelection&&VT(n,n.steps.length-1,-1),i.applyInputRules&&n.setMeta("applyInputRules",{from:c,text:f}),i.applyPasteRules&&n.setMeta("applyPasteRules",{from:c,text:f})}return!0},WT=()=>({state:e,dispatch:t})=>Cy(e,t),UT=()=>({state:e,dispatch:t})=>vy(e,t),qT=()=>({state:e,dispatch:t})=>gf(e,t),$T=()=>({state:e,dispatch:t})=>Cf(e,t),jT=()=>({state:e,dispatch:t,tr:i})=>{try{let n=Fo(e.doc,e.selection.$from.pos,-1);return n==null?!1:(i.join(n,2),t&&t(i),!0)}catch{return!1}},KT=()=>({state:e,dispatch:t,tr:i})=>{try{let n=Fo(e.doc,e.selection.$from.pos,1);return n==null?!1:(i.join(n,2),t&&t(i),!0)}catch{return!1}},YT=()=>({state:e,dispatch:t})=>py(e,t),XT=()=>({state:e,dispatch:t})=>gy(e,t);function QS(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function JT(e){let t=e.split(/-(?!$)/),i=t[t.length-1];i==="Space"&&(i=" ");let n,s,o,r;for(let a=0;a<t.length-1;a+=1){let l=t[a];if(/^(cmd|meta|m)$/i.test(l))r=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))Cm()||QS()?r=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return n&&(i=`Alt-${i}`),s&&(i=`Ctrl-${i}`),r&&(i=`Meta-${i}`),o&&(i=`Shift-${i}`),i}var QT=e=>({editor:t,view:i,tr:n,dispatch:s})=>{let o=JT(e).split(/-(?!$)/),r=o.find(d=>!["Alt","Ctrl","Meta","Shift"].includes(d)),a=new KeyboardEvent("keydown",{key:r==="Space"?" ":r,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),l=t.captureTransaction(()=>{i.someProp("handleKeyDown",d=>d(i,a))});return l?.steps.forEach(d=>{let c=d.map(n.mapping);c&&s&&n.maybeStep(c)}),!0};function wn(e,t,i={}){let{from:n,to:s,empty:o}=e.selection,r=t?ct(t,e.schema):null,a=[];e.doc.nodesBetween(n,s,(u,h)=>{if(u.isText)return;let p=Math.max(n,h),g=Math.min(s,h+u.nodeSize);a.push({node:u,from:p,to:g})});let l=s-n,d=a.filter(u=>r?r.name===u.node.type.name:!0).filter(u=>Xc(u.node.attrs,i,{strict:!1}));return o?!!d.length:d.reduce((u,h)=>u+h.to-h.from,0)>=l}var ZT=(e,t={})=>({state:i,dispatch:n})=>{let s=ct(e,i.schema);return wn(i,s,t)?wy(i,n):!1},e5=()=>({state:e,dispatch:t})=>Ef(e,t),t5=e=>({state:t,dispatch:i})=>{let n=ct(e,t.schema);return Ry(n)(t,i)},i5=()=>({state:e,dispatch:t})=>bf(e,t);function eu(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function HS(e,t){let i=typeof t=="string"?[t]:t;return Object.keys(e).reduce((n,s)=>(i.includes(s)||(n[s]=e[s]),n),{})}var n5=(e,t)=>({tr:i,state:n,dispatch:s})=>{let o=null,r=null,a=eu(typeof e=="string"?e:e.name,n.schema);if(!a)return!1;a==="node"&&(o=ct(e,n.schema)),a==="mark"&&(r=is(e,n.schema));let l=!1;return i.selection.ranges.forEach(d=>{n.doc.nodesBetween(d.$from.pos,d.$to.pos,(c,u)=>{o&&o===c.type&&(l=!0,s&&i.setNodeMarkup(u,void 0,HS(c.attrs,t))),r&&c.marks.length&&c.marks.forEach(h=>{r===h.type&&(l=!0,s&&i.addMark(u,u+c.nodeSize,r.create(HS(h.attrs,t))))})})}),l},s5=()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),o5=()=>({tr:e,dispatch:t})=>{if(t){let i=new di(e.doc);e.setSelection(i)}return!0},r5=()=>({state:e,dispatch:t})=>ff(e,t),a5=()=>({state:e,dispatch:t})=>vf(e,t),l5=()=>({state:e,dispatch:t})=>by(e,t),d5=()=>({state:e,dispatch:t})=>Mf(e,t),c5=()=>({state:e,dispatch:t})=>Rf(e,t);function um(e,t,i={},n={}){return Dl(e,t,{slice:!1,parseOptions:i,errorOnInvalidContent:n.errorOnInvalidContent})}var u5=(e,{errorOnInvalidContent:t,emitUpdate:i=!0,parseOptions:n={}}={})=>({editor:s,tr:o,dispatch:r,commands:a})=>{let{doc:l}=o;if(n.preserveWhitespace!=="full"){let d=um(e,s.schema,n,{errorOnInvalidContent:t??s.options.enableContentCheck});return r&&o.replaceWith(0,l.content.size,d).setMeta("preventUpdate",!i),!0}return r&&o.setMeta("preventUpdate",!i),a.insertContentAt({from:0,to:l.content.size},e,{parseOptions:n,errorOnInvalidContent:t??s.options.enableContentCheck})};function ZS(e,t){let i=is(t,e.schema),{from:n,to:s,empty:o}=e.selection,r=[];o?(e.storedMarks&&r.push(...e.storedMarks),r.push(...e.selection.$head.marks())):e.doc.nodesBetween(n,s,l=>{r.push(...l.marks)});let a=r.find(l=>l.type.name===i.name);return a?b({},a.attrs):{}}function vm(e,t){let i=new Vr(e);return t.forEach(n=>{n.steps.forEach(s=>{i.step(s)})}),i}function h5(e){for(let t=0;t<e.edgeCount;t+=1){let{type:i}=e.edge(t);if(i.isTextblock&&!i.hasRequiredAttrs())return i}return null}function e2(e,t,i){let n=[];return e.nodesBetween(t.from,t.to,(s,o)=>{i(s)&&n.push({node:s,pos:o})}),n}function p5(e,t){for(let i=e.depth;i>0;i-=1){let n=e.node(i);if(t(n))return{pos:i>0?e.before(i):0,start:e.start(i),depth:i,node:n}}}function tu(e){return t=>p5(t.$from,e)}function re(e,t,i){return e.config[t]===void 0&&e.parent?re(e.parent,t,i):typeof e.config[t]=="function"?e.config[t].bind(O(b({},i),{parent:e.parent?re(e.parent,t,i):null})):e.config[t]}function wm(e){return e.map(t=>{let i={name:t.name,options:t.options,storage:t.storage},n=re(t,"addExtensions",i);return n?[t,...wm(n())]:t}).flat(10)}function bm(e,t){let i=jn.fromSchema(t).serializeFragment(e),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(i),s.innerHTML}function t2(e){return typeof e=="function"}function Ve(e,t=void 0,...i){return t2(e)?t?e.bind(t)(...i):e(...i):e}function g5(e={}){return Object.keys(e).length===0&&e.constructor===Object}function Qr(e){let t=e.filter(s=>s.type==="extension"),i=e.filter(s=>s.type==="node"),n=e.filter(s=>s.type==="mark");return{baseExtensions:t,nodeExtensions:i,markExtensions:n}}function i2(e){let t=[],{nodeExtensions:i,markExtensions:n}=Qr(e),s=[...i,...n],o={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(r=>{let a={name:r.name,options:r.options,storage:r.storage,extensions:s},l=re(r,"addGlobalAttributes",a);if(!l)return;l().forEach(c=>{c.types.forEach(u=>{Object.entries(c.attributes).forEach(([h,p])=>{t.push({type:u,name:h,attribute:b(b({},o),p)})})})})}),s.forEach(r=>{let a={name:r.name,options:r.options,storage:r.storage},l=re(r,"addAttributes",a);if(!l)return;let d=l();Object.entries(d).forEach(([c,u])=>{let h=b(b({},o),u);typeof h?.default=="function"&&(h.default=h.default()),h?.isRequired&&h?.default===void 0&&delete h.default,t.push({type:r.name,name:c,attribute:h})})}),t}function Fe(...e){return e.filter(t=>!!t).reduce((t,i)=>{let n=b({},t);return Object.entries(i).forEach(([s,o])=>{if(!n[s]){n[s]=o;return}if(s==="class"){let a=o?String(o).split(" "):[],l=n[s]?n[s].split(" "):[],d=a.filter(c=>!l.includes(c));n[s]=[...l,...d].join(" ")}else if(s==="style"){let a=o?o.split(";").map(c=>c.trim()).filter(Boolean):[],l=n[s]?n[s].split(";").map(c=>c.trim()).filter(Boolean):[],d=new Map;l.forEach(c=>{let[u,h]=c.split(":").map(p=>p.trim());d.set(u,h)}),a.forEach(c=>{let[u,h]=c.split(":").map(p=>p.trim());d.set(u,h)}),n[s]=Array.from(d.entries()).map(([c,u])=>`${c}: ${u}`).join("; ")}else n[s]=o}),n},{})}function Jc(e,t){return t.filter(i=>i.type===e.type.name).filter(i=>i.attribute.rendered).map(i=>i.attribute.renderHTML?i.attribute.renderHTML(e.attrs)||{}:{[i.name]:e.attrs[i.name]}).reduce((i,n)=>Fe(i,n),{})}function f5(e){return typeof e!="string"?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):e==="true"?!0:e==="false"?!1:e}function VS(e,t){return"style"in e?e:O(b({},e),{getAttrs:i=>{let n=e.getAttrs?e.getAttrs(i):e.attrs;if(n===!1)return!1;let s=t.reduce((o,r)=>{let a=r.attribute.parseHTML?r.attribute.parseHTML(i):f5(i.getAttribute(r.name));return a==null?o:O(b({},o),{[r.name]:a})},{});return b(b({},n),s)}})}function GS(e){return Object.fromEntries(Object.entries(e).filter(([t,i])=>t==="attrs"&&g5(i)?!1:i!=null))}function zS(e){var t,i;let n={};return!((t=e?.attribute)!=null&&t.isRequired)&&"default"in(e?.attribute||{})&&(n.default=e.attribute.default),((i=e?.attribute)==null?void 0:i.validate)!==void 0&&(n.validate=e.attribute.validate),[e.name,n]}function m5(e,t){var i;let n=i2(e),{nodeExtensions:s,markExtensions:o}=Qr(e),r=(i=s.find(d=>re(d,"topNode")))==null?void 0:i.name,a=Object.fromEntries(s.map(d=>{let c=n.filter(C=>C.type===d.name),u={name:d.name,options:d.options,storage:d.storage,editor:t},h=e.reduce((C,v)=>{let w=re(v,"extendNodeSchema",u);return b(b({},C),w?w(d):{})},{}),p=GS(O(b({},h),{content:Ve(re(d,"content",u)),marks:Ve(re(d,"marks",u)),group:Ve(re(d,"group",u)),inline:Ve(re(d,"inline",u)),atom:Ve(re(d,"atom",u)),selectable:Ve(re(d,"selectable",u)),draggable:Ve(re(d,"draggable",u)),code:Ve(re(d,"code",u)),whitespace:Ve(re(d,"whitespace",u)),linebreakReplacement:Ve(re(d,"linebreakReplacement",u)),defining:Ve(re(d,"defining",u)),isolating:Ve(re(d,"isolating",u)),attrs:Object.fromEntries(c.map(zS))})),g=Ve(re(d,"parseHTML",u));g&&(p.parseDOM=g.map(C=>VS(C,c)));let f=re(d,"renderHTML",u);f&&(p.toDOM=C=>f({node:C,HTMLAttributes:Jc(C,c)}));let m=re(d,"renderText",u);return m&&(p.toText=m),[d.name,p]})),l=Object.fromEntries(o.map(d=>{let c=n.filter(m=>m.type===d.name),u={name:d.name,options:d.options,storage:d.storage,editor:t},h=e.reduce((m,C)=>{let v=re(C,"extendMarkSchema",u);return b(b({},m),v?v(d):{})},{}),p=GS(O(b({},h),{inclusive:Ve(re(d,"inclusive",u)),excludes:Ve(re(d,"excludes",u)),group:Ve(re(d,"group",u)),spanning:Ve(re(d,"spanning",u)),code:Ve(re(d,"code",u)),attrs:Object.fromEntries(c.map(zS))})),g=Ve(re(d,"parseHTML",u));g&&(p.parseDOM=g.map(m=>VS(m,c)));let f=re(d,"renderHTML",u);return f&&(p.toDOM=m=>f({mark:m,HTMLAttributes:Jc(m,c)})),[d.name,p]}));return new Nr({topNode:r,nodes:a,marks:l})}function C5(e){let t=e.filter((i,n)=>e.indexOf(i)!==n);return Array.from(new Set(t))}function hm(e){return e.sort((i,n)=>{let s=re(i,"priority")||100,o=re(n,"priority")||100;return s>o?-1:s<o?1:0})}function WS(e){let t=hm(wm(e)),i=C5(t.map(n=>n.name));return i.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${i.map(n=>`'${n}'`).join(", ")}]. This can lead to issues.`),t}function n2(e,t,i){let{from:n,to:s}=t,{blockSeparator:o=`

`,textSerializers:r={}}=i||{},a="";return e.nodesBetween(n,s,(l,d,c,u)=>{var h;l.isBlock&&d>n&&(a+=o);let p=r?.[l.type.name];if(p)return c&&(a+=p({node:l,pos:d,parent:c,index:u,range:t})),!1;l.isText&&(a+=(h=l?.text)==null?void 0:h.slice(Math.max(n,d)-d,s-d))}),a}function v5(e,t){let i={from:0,to:e.content.size};return n2(e,i,t)}function s2(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,t])=>t.spec.toText).map(([t,i])=>[t,i.spec.toText]))}function w5(e,t){let i=ct(t,e.schema),{from:n,to:s}=e.selection,o=[];e.doc.nodesBetween(n,s,a=>{o.push(a)});let r=o.reverse().find(a=>a.type.name===i.name);return r?b({},r.attrs):{}}function ym(e,t){let i=eu(typeof t=="string"?t:t.name,e.schema);return i==="node"?w5(e,t):i==="mark"?ZS(e,t):{}}function b5(e,t=JSON.stringify){let i={};return e.filter(n=>{let s=t(n);return Object.prototype.hasOwnProperty.call(i,s)?!1:i[s]=!0})}function y5(e){let t=b5(e);return t.length===1?t:t.filter((i,n)=>!t.filter((o,r)=>r!==n).some(o=>i.oldRange.from>=o.oldRange.from&&i.oldRange.to<=o.oldRange.to&&i.newRange.from>=o.newRange.from&&i.newRange.to<=o.newRange.to))}function Sm(e){let{mapping:t,steps:i}=e,n=[];return t.maps.forEach((s,o)=>{let r=[];if(s.ranges.length)s.forEach((a,l)=>{r.push({from:a,to:l})});else{let{from:a,to:l}=i[o];if(a===void 0||l===void 0)return;r.push({from:a,to:l})}r.forEach(({from:a,to:l})=>{let d=t.slice(o).map(a,-1),c=t.slice(o).map(l),u=t.invert().map(d,-1),h=t.invert().map(c);n.push({oldRange:{from:u,to:h},newRange:{from:d,to:c}})})}),y5(n)}function iu(e,t,i){let n=[];return e===t?i.resolve(e).marks().forEach(s=>{let o=i.resolve(e),r=mm(o,s.type);r&&n.push(b({mark:s},r))}):i.nodesBetween(e,t,(s,o)=>{!s||s?.nodeSize===void 0||n.push(...s.marks.map(r=>({from:o,to:o+s.nodeSize,mark:r})))}),n}var o2=(e,t,i,n=20)=>{let s=e.doc.resolve(i),o=n,r=null;for(;o>0&&r===null;){let a=s.node(o);a?.type.name===t?r=a:o-=1}return[r,o]};function lm(e,t){return t.nodes[e]||t.marks[e]||null}function Yc(e,t,i){return Object.fromEntries(Object.entries(i).filter(([n])=>{let s=e.find(o=>o.type===t&&o.name===n);return s?s.attribute.keepOnSplit:!1}))}var S5=(e,t=500)=>{let i="",n=e.parentOffset;return e.parent.nodesBetween(Math.max(0,n-t),n,(s,o,r,a)=>{var l,d;let c=((d=(l=s.type.spec).toText)==null?void 0:d.call(l,{node:s,pos:o,parent:r,index:a}))||s.textContent||"%leaf%";i+=s.isAtom&&!s.isText?c:c.slice(0,Math.max(0,n-o))}),i};function pm(e,t,i={}){let{empty:n,ranges:s}=e.selection,o=t?is(t,e.schema):null;if(n)return!!(e.storedMarks||e.selection.$from.marks()).filter(u=>o?o.name===u.type.name:!0).find(u=>Xc(u.attrs,i,{strict:!1}));let r=0,a=[];if(s.forEach(({$from:u,$to:h})=>{let p=u.pos,g=h.pos;e.doc.nodesBetween(p,g,(f,m)=>{if(!f.isText&&!f.marks.length)return;let C=Math.max(p,m),v=Math.min(g,m+f.nodeSize),w=v-C;r+=w,a.push(...f.marks.map(y=>({mark:y,from:C,to:v})))})}),r===0)return!1;let l=a.filter(u=>o?o.name===u.mark.type.name:!0).filter(u=>Xc(u.mark.attrs,i,{strict:!1})).reduce((u,h)=>u+h.to-h.from,0),d=a.filter(u=>o?u.mark.type!==o&&u.mark.type.excludes(o):!0).reduce((u,h)=>u+h.to-h.from,0);return(l>0?l+d:l)>=r}function x5(e,t,i={}){if(!t)return wn(e,null,i)||pm(e,null,i);let n=eu(t,e.schema);return n==="node"?wn(e,t,i):n==="mark"?pm(e,t,i):!1}var r2=(e,t)=>{let{$from:i,$to:n,$anchor:s}=e.selection;if(t){let o=tu(a=>a.type.name===t)(e.selection);if(!o)return!1;let r=e.doc.resolve(o.pos+1);return s.pos+1===r.end()}return!(n.parentOffset<n.parent.nodeSize-2||i.pos!==n.pos)},a2=e=>{let{$from:t,$to:i}=e.selection;return!(t.parentOffset>0||t.pos!==i.pos)};function US(e,t){return Array.isArray(t)?t.some(i=>(typeof i=="string"?i:i.name)===e.name):t}function qS(e,t){let{nodeExtensions:i}=Qr(t),n=i.find(r=>r.name===e);if(!n)return!1;let s={name:n.name,options:n.options,storage:n.storage},o=Ve(re(n,"group",s));return typeof o!="string"?!1:o.split(" ").includes("list")}function kl(e,{checkChildren:t=!0,ignoreWhitespace:i=!1}={}){var n;if(i){if(e.type.name==="hardBreak")return!0;if(e.isText)return/^\s*$/m.test((n=e.text)!=null?n:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(e.content.childCount===0)return!0;if(t){let s=!0;return e.content.forEach(o=>{s!==!1&&(kl(o,{ignoreWhitespace:i,checkChildren:t})||(s=!1))}),s}return!1}function nu(e){return e instanceof ne}function E5(e,t,i){var n;let{selection:s}=t,o=null;if(YS(s)&&(o=s.$cursor),o){let a=(n=e.storedMarks)!=null?n:o.marks();return o.parent.type.allowsMarkType(i)&&(!!i.isInSet(a)||!a.some(d=>d.type.excludes(i)))}let{ranges:r}=s;return r.some(({$from:a,$to:l})=>{let d=a.depth===0?e.doc.inlineContent&&e.doc.type.allowsMarkType(i):!1;return e.doc.nodesBetween(a.pos,l.pos,(c,u,h)=>{if(d)return!1;if(c.isInline){let p=!h||h.type.allowsMarkType(i),g=!!i.isInSet(c.marks)||!c.marks.some(f=>f.type.excludes(i));d=p&&g}return!d}),d})}var R5=(e,t={})=>({tr:i,state:n,dispatch:s})=>{let{selection:o}=i,{empty:r,ranges:a}=o,l=is(e,n.schema);if(s)if(r){let d=ZS(n,l);i.addStoredMark(l.create(b(b({},d),t)))}else a.forEach(d=>{let c=d.$from.pos,u=d.$to.pos;n.doc.nodesBetween(c,u,(h,p)=>{let g=Math.max(p,c),f=Math.min(p+h.nodeSize,u);h.marks.find(C=>C.type===l)?h.marks.forEach(C=>{l===C.type&&i.addMark(g,f,l.create(b(b({},C.attrs),t)))}):i.addMark(g,f,l.create(t))})});return E5(n,i,l)},M5=(e,t)=>({tr:i})=>(i.setMeta(e,t),!0),D5=(e,t={})=>({state:i,dispatch:n,chain:s})=>{let o=ct(e,i.schema),r;return i.selection.$anchor.sameParent(i.selection.$head)&&(r=i.selection.$anchor.parent.attrs),o.isTextblock?s().command(({commands:a})=>Df(o,b(b({},r),t))(i)?!0:a.clearNodes()).command(({state:a})=>Df(o,b(b({},r),t))(a,n)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},k5=e=>({tr:t,dispatch:i})=>{if(i){let{doc:n}=t,s=Vo(e,0,n.content.size),o=ne.create(n,s);t.setSelection(o)}return!0},P5=(e,t)=>({tr:i,state:n,dispatch:s})=>{let{selection:o}=n,r,a;return typeof t=="number"?(r=t,a=t):t&&"from"in t&&"to"in t?(r=t.from,a=t.to):(r=o.from,a=o.to),s&&i.doc.nodesBetween(r,a,(l,d)=>{l.isText||i.setNodeMarkup(d,void 0,O(b({},l.attrs),{dir:e}))}),!0},F5=e=>({tr:t,dispatch:i})=>{if(i){let{doc:n}=t,{from:s,to:o}=typeof e=="number"?{from:e,to:e}:e,r=le.atStart(n).from,a=le.atEnd(n).to,l=Vo(s,r,a),d=Vo(o,r,a),c=le.create(n,l,d);t.setSelection(c)}return!0},T5=e=>({state:t,dispatch:i})=>{let n=ct(e,t.schema);return My(n)(t,i)};function $S(e,t){let i=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(i){let n=i.filter(s=>t?.includes(s.type.name));e.tr.ensureMarks(n)}}var A5=({keepMarks:e=!0}={})=>({tr:t,state:i,dispatch:n,editor:s})=>{let{selection:o,doc:r}=t,{$from:a,$to:l}=o,d=s.extensionManager.attributes,c=Yc(d,a.node().type.name,a.node().attrs);if(o instanceof ne&&o.node.isBlock)return!a.parentOffset||!Ri(r,a.pos)?!1:(n&&(e&&$S(i,s.extensionManager.splittableMarks),t.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;let u=l.parentOffset===l.parent.content.size,h=a.depth===0?void 0:h5(a.node(-1).contentMatchAt(a.indexAfter(-1))),p=u&&h?[{type:h,attrs:c}]:void 0,g=Ri(t.doc,t.mapping.map(a.pos),1,p);if(!p&&!g&&Ri(t.doc,t.mapping.map(a.pos),1,h?[{type:h}]:void 0)&&(g=!0,p=h?[{type:h,attrs:c}]:void 0),n){if(g&&(o instanceof le&&t.deleteSelection(),t.split(t.mapping.map(a.pos),1,p),h&&!u&&!a.parentOffset&&a.parent.type!==h)){let f=t.mapping.map(a.before()),m=t.doc.resolve(f);a.node(-1).canReplaceWith(m.index(),m.index()+1,h)&&t.setNodeMarkup(t.mapping.map(a.before()),h)}e&&$S(i,s.extensionManager.splittableMarks),t.scrollIntoView()}return g},I5=(e,t={})=>({tr:i,state:n,dispatch:s,editor:o})=>{var r;let a=ct(e,n.schema),{$from:l,$to:d}=n.selection,c=n.selection.node;if(c&&c.isBlock||l.depth<2||!l.sameParent(d))return!1;let u=l.node(-1);if(u.type!==a)return!1;let h=o.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(s){let C=B.empty,v=l.index(-1)?1:l.index(-2)?2:3;for(let T=l.depth-v;T>=l.depth-3;T-=1)C=B.from(l.node(T).copy(C));let w=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,y=b(b({},Yc(h,l.node().type.name,l.node().attrs)),t),S=((r=a.contentMatch.defaultType)==null?void 0:r.createAndFill(y))||void 0;C=C.append(B.from(a.createAndFill(null,S)||void 0));let x=l.before(l.depth-(v-1));i.replace(x,l.after(-w),new J(C,4-v,0));let E=-1;i.doc.nodesBetween(x,i.doc.content.size,(T,L)=>{if(E>-1)return!1;T.isTextblock&&T.content.size===0&&(E=L+1)}),E>-1&&i.setSelection(le.near(i.doc.resolve(E))),i.scrollIntoView()}return!0}let p=d.pos===l.end()?u.contentMatchAt(0).defaultType:null,g=b(b({},Yc(h,u.type.name,u.attrs)),t),f=b(b({},Yc(h,l.node().type.name,l.node().attrs)),t);i.delete(l.pos,d.pos);let m=p?[{type:a,attrs:g},{type:p,attrs:f}]:[{type:a,attrs:g}];if(!Ri(i.doc,l.pos,2))return!1;if(s){let{selection:C,storedMarks:v}=n,{splittableMarks:w}=o.extensionManager,y=v||C.$to.parentOffset&&C.$from.marks();if(i.split(l.pos,2,m).scrollIntoView(),!y||!s)return!0;let S=y.filter(x=>w.includes(x.type.name));i.ensureMarks(S)}return!0},dm=(e,t)=>{let i=tu(r=>r.type===t)(e.selection);if(!i)return!0;let n=e.doc.resolve(Math.max(0,i.pos-1)).before(i.depth);if(n===void 0)return!0;let s=e.doc.nodeAt(n);return i.node.type===s?.type&&_i(e.doc,i.pos)&&e.join(i.pos),!0},cm=(e,t)=>{let i=tu(r=>r.type===t)(e.selection);if(!i)return!0;let n=e.doc.resolve(i.start).after(i.depth);if(n===void 0)return!0;let s=e.doc.nodeAt(n);return i.node.type===s?.type&&_i(e.doc,n)&&e.join(n),!0},_5=(e,t,i,n={})=>({editor:s,tr:o,state:r,dispatch:a,chain:l,commands:d,can:c})=>{let{extensions:u,splittableMarks:h}=s.extensionManager,p=ct(e,r.schema),g=ct(t,r.schema),{selection:f,storedMarks:m}=r,{$from:C,$to:v}=f,w=C.blockRange(v),y=m||f.$to.parentOffset&&f.$from.marks();if(!w)return!1;let S=tu(x=>qS(x.type.name,u))(f);if(w.depth>=1&&S&&w.depth-S.depth<=1){if(S.node.type===p)return d.liftListItem(g);if(qS(S.node.type.name,u)&&p.validContent(S.node.content)&&a)return l().command(()=>(o.setNodeMarkup(S.pos,p),!0)).command(()=>dm(o,p)).command(()=>cm(o,p)).run()}return!i||!y||!a?l().command(()=>c().wrapInList(p,n)?!0:d.clearNodes()).wrapInList(p,n).command(()=>dm(o,p)).command(()=>cm(o,p)).run():l().command(()=>{let x=c().wrapInList(p,n),E=y.filter(T=>h.includes(T.type.name));return o.ensureMarks(E),x?!0:d.clearNodes()}).wrapInList(p,n).command(()=>dm(o,p)).command(()=>cm(o,p)).run()},L5=(e,t={},i={})=>({state:n,commands:s})=>{let{extendEmptyMarkRange:o=!1}=i,r=is(e,n.schema);return pm(n,r,t)?s.unsetMark(r,{extendEmptyMarkRange:o}):s.setMark(r,t)},O5=(e,t,i={})=>({state:n,commands:s})=>{let o=ct(e,n.schema),r=ct(t,n.schema),a=wn(n,o,i),l;return n.selection.$anchor.sameParent(n.selection.$head)&&(l=n.selection.$anchor.parent.attrs),a?s.setNode(r,l):s.setNode(o,b(b({},l),i))},N5=(e,t={})=>({state:i,commands:n})=>{let s=ct(e,i.schema);return wn(i,s,t)?n.lift(s):n.wrapIn(s,t)},B5=()=>({state:e,dispatch:t})=>{let i=e.plugins;for(let n=0;n<i.length;n+=1){let s=i[n],o;if(s.spec.isInputRules&&(o=s.getState(e))){if(t){let r=e.tr,a=o.transform;for(let l=a.steps.length-1;l>=0;l-=1)r.step(a.steps[l].invert(a.docs[l]));if(o.text){let l=r.doc.resolve(o.from).marks();r.replaceWith(o.from,o.to,e.schema.text(o.text,l))}else r.delete(o.from,o.to)}return!0}}return!1},H5=()=>({tr:e,dispatch:t})=>{let{selection:i}=e,{empty:n,ranges:s}=i;return n||t&&s.forEach(o=>{e.removeMark(o.$from.pos,o.$to.pos)}),!0},V5=(e,t={})=>({tr:i,state:n,dispatch:s})=>{var o;let{extendEmptyMarkRange:r=!1}=t,{selection:a}=i,l=is(e,n.schema),{$from:d,empty:c,ranges:u}=a;if(!s)return!0;if(c&&r){let{from:h,to:p}=a,g=(o=d.marks().find(m=>m.type===l))==null?void 0:o.attrs,f=mm(d,l,g);f&&(h=f.from,p=f.to),i.removeMark(h,p,l)}else u.forEach(h=>{i.removeMark(h.$from.pos,h.$to.pos,l)});return i.removeStoredMark(l),!0},G5=e=>({tr:t,state:i,dispatch:n})=>{let{selection:s}=i,o,r;return typeof e=="number"?(o=e,r=e):e&&"from"in e&&"to"in e?(o=e.from,r=e.to):(o=s.from,r=s.to),n&&t.doc.nodesBetween(o,r,(a,l)=>{if(a.isText)return;let d=b({},a.attrs);delete d.dir,t.setNodeMarkup(l,void 0,d)}),!0},z5=(e,t={})=>({tr:i,state:n,dispatch:s})=>{let o=null,r=null,a=eu(typeof e=="string"?e:e.name,n.schema);if(!a)return!1;a==="node"&&(o=ct(e,n.schema)),a==="mark"&&(r=is(e,n.schema));let l=!1;return i.selection.ranges.forEach(d=>{let c=d.$from.pos,u=d.$to.pos,h,p,g,f;i.selection.empty?n.doc.nodesBetween(c,u,(m,C)=>{o&&o===m.type&&(l=!0,g=Math.max(C,c),f=Math.min(C+m.nodeSize,u),h=C,p=m)}):n.doc.nodesBetween(c,u,(m,C)=>{C<c&&o&&o===m.type&&(l=!0,g=Math.max(C,c),f=Math.min(C+m.nodeSize,u),h=C,p=m),C>=c&&C<=u&&(o&&o===m.type&&(l=!0,s&&i.setNodeMarkup(C,void 0,b(b({},m.attrs),t))),r&&m.marks.length&&m.marks.forEach(v=>{if(r===v.type&&(l=!0,s)){let w=Math.max(C,c),y=Math.min(C+m.nodeSize,u);i.addMark(w,y,r.create(b(b({},v.attrs),t)))}}))}),p&&(h!==void 0&&s&&i.setNodeMarkup(h,void 0,b(b({},p.attrs),t)),r&&p.marks.length&&p.marks.forEach(m=>{r===m.type&&s&&i.addMark(g,f,r.create(b(b({},m.attrs),t)))}))}),l},W5=(e,t={})=>({state:i,dispatch:n})=>{let s=ct(e,i.schema);return xy(s,t)(i,n)},U5=(e,t={})=>({state:i,dispatch:n})=>{let s=ct(e,i.schema);return Ey(s,t)(i,n)},q5=class{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){let i=this.callbacks[e];return i&&i.forEach(n=>n.apply(this,t)),this}off(e,t){let i=this.callbacks[e];return i&&(t?this.callbacks[e]=i.filter(n=>n!==t):delete this.callbacks[e]),this}once(e,t){let i=(...n)=>{this.off(e,i),t.apply(this,n)};return this.on(e,i)}removeAllListeners(){this.callbacks={}}},su=class{constructor(e){var t;this.find=e.find,this.handler=e.handler,this.undoable=(t=e.undoable)!=null?t:!0}},$5=(e,t)=>{if(fm(t))return t.exec(e);let i=t(e);if(!i)return null;let n=[i.text];return n.index=i.index,n.input=e,n.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),n.push(i.replaceWith)),n};function $c(e){var t;let{editor:i,from:n,to:s,text:o,rules:r,plugin:a}=e,{view:l}=i;if(l.composing)return!1;let d=l.state.doc.resolve(n);if(d.parent.type.spec.code||(t=d.nodeBefore||d.nodeAfter)!=null&&t.marks.find(h=>h.type.spec.code))return!1;let c=!1,u=S5(d)+o;return r.forEach(h=>{if(c)return;let p=$5(u,h.find);if(!p)return;let g=l.state.tr,f=Qc({state:l.state,transaction:g}),m={from:n-(p[0].length-o.length),to:s},{commands:C,chain:v,can:w}=new Zc({editor:i,state:f});h.handler({state:f,range:m,match:p,commands:C,chain:v,can:w})===null||!g.steps.length||(h.undoable&&g.setMeta(a,{transform:g,from:n,to:s,text:o}),l.dispatch(g),c=!0)}),c}function j5(e){let{editor:t,rules:i}=e,n=new fe({state:{init(){return null},apply(s,o,r){let a=s.getMeta(n);if(a)return a;let l=s.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:c}=l;typeof c=="string"?c=c:c=bm(B.from(c),r.schema);let{from:u}=l,h=u+c.length;$c({editor:t,from:u,to:h,text:c,rules:i,plugin:n})}),s.selectionSet||s.docChanged?null:o}},props:{handleTextInput(s,o,r,a){return $c({editor:t,from:o,to:r,text:a,rules:i,plugin:n})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{let{$cursor:o}=s.state.selection;o&&$c({editor:t,from:o.pos,to:o.pos,text:"",rules:i,plugin:n})}),!1)},handleKeyDown(s,o){if(o.key!=="Enter")return!1;let{$cursor:r}=s.state.selection;return r?$c({editor:t,from:r.pos,to:r.pos,text:`
`,rules:i,plugin:n}):!1}},isInputRules:!0});return n}function K5(e){return Object.prototype.toString.call(e).slice(8,-1)}function jc(e){return K5(e)!=="Object"?!1:e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function l2(e,t){let i=b({},e);return jc(e)&&jc(t)&&Object.keys(t).forEach(n=>{jc(t[n])&&jc(e[n])?i[n]=l2(e[n],t[n]):i[n]=t[n]}),i}var xm=class{constructor(e={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config=b(b({},this.config),e),this.name=this.config.name}get options(){return b({},Ve(re(this,"addOptions",{name:this.name}))||{})}get storage(){return b({},Ve(re(this,"addStorage",{name:this.name,options:this.options}))||{})}configure(e={}){let t=this.extend(O(b({},this.config),{addOptions:()=>l2(this.options,e)}));return t.name=this.name,t.parent=this.parent,t}extend(e={}){let t=new this.constructor(b(b({},this.config),e));return t.parent=this,this.child=t,t.name="name"in e?e.name:t.parent.name,t}},Mi=class d2 extends xm{constructor(){super(...arguments),this.type="mark"}static create(t={}){let i=typeof t=="function"?t():t;return new d2(i)}static handleExit({editor:t,mark:i}){let{tr:n}=t.state,s=t.state.selection.$from;if(s.pos===s.end()){let r=s.marks();if(!!!r.find(d=>d?.type.name===i.name))return!1;let l=r.find(d=>d?.type.name===i.name);return l&&n.removeStoredMark(l),n.insertText(" ",s.pos),t.view.dispatch(n),!0}return!1}configure(t){return super.configure(t)}extend(t){let i=typeof t=="function"?t():t;return super.extend(i)}};function Y5(e){return typeof e=="number"}var X5=class{constructor(e){this.find=e.find,this.handler=e.handler}},J5=(e,t,i)=>{if(fm(t))return[...e.matchAll(t)];let n=t(e,i);return n?n.map(s=>{let o=[s.text];return o.index=s.index,o.input=e,o.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(s.replaceWith)),o}):[]};function Q5(e){let{editor:t,state:i,from:n,to:s,rule:o,pasteEvent:r,dropEvent:a}=e,{commands:l,chain:d,can:c}=new Zc({editor:t,state:i}),u=[];return i.doc.nodesBetween(n,s,(p,g)=>{var f,m,C,v,w;if((m=(f=p.type)==null?void 0:f.spec)!=null&&m.code||!(p.isText||p.isTextblock||p.isInline))return;let y=(w=(v=(C=p.content)==null?void 0:C.size)!=null?v:p.nodeSize)!=null?w:0,S=Math.max(n,g),x=Math.min(s,g+y);if(S>=x)return;let E=p.isText?p.text||"":p.textBetween(S-g,x-g,void 0,"\uFFFC");J5(E,o.find,r).forEach(L=>{if(L.index===void 0)return;let N=S+L.index+1,$=N+L[0].length,G={from:i.tr.mapping.map(N),to:i.tr.mapping.map($)},se=o.handler({state:i,range:G,match:L,commands:l,chain:d,can:c,pasteEvent:r,dropEvent:a});u.push(se)})}),u.every(p=>p!==null)}var Kc=null,Z5=e=>{var t;let i=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(t=i.clipboardData)==null||t.setData("text/html",e),i};function e8(e){let{editor:t,rules:i}=e,n=null,s=!1,o=!1,r=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}let l=({state:c,from:u,to:h,rule:p,pasteEvt:g})=>{let f=c.tr,m=Qc({state:c,transaction:f});if(!(!Q5({editor:t,state:m,from:Math.max(u-1,0),to:h.b-1,rule:p,pasteEvent:g,dropEvent:a})||!f.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return r=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,f}};return i.map(c=>new fe({view(u){let h=g=>{var f;n=(f=u.dom.parentElement)!=null&&f.contains(g.target)?u.dom.parentElement:null,n&&(Kc=t)},p=()=>{Kc&&(Kc=null)};return window.addEventListener("dragstart",h),window.addEventListener("dragend",p),{destroy(){window.removeEventListener("dragstart",h),window.removeEventListener("dragend",p)}}},props:{handleDOMEvents:{drop:(u,h)=>{if(o=n===u.dom.parentElement,a=h,!o){let p=Kc;p?.isEditable&&setTimeout(()=>{let g=p.state.selection;g&&p.commands.deleteRange({from:g.from,to:g.to})},10)}return!1},paste:(u,h)=>{var p;let g=(p=h.clipboardData)==null?void 0:p.getData("text/html");return r=h,s=!!g?.includes("data-pm-slice"),!1}}},appendTransaction:(u,h,p)=>{let g=u[0],f=g.getMeta("uiEvent")==="paste"&&!s,m=g.getMeta("uiEvent")==="drop"&&!o,C=g.getMeta("applyPasteRules"),v=!!C;if(!f&&!m&&!v)return;if(v){let{text:S}=C;typeof S=="string"?S=S:S=bm(B.from(S),p.schema);let{from:x}=C,E=x+S.length,T=Z5(S);return l({rule:c,state:p,from:x,to:{b:E},pasteEvt:T})}let w=h.doc.content.findDiffStart(p.doc.content),y=h.doc.content.findDiffEnd(p.doc.content);if(!(!Y5(w)||!y||w===y.b))return l({rule:c,state:p,from:w,to:y,pasteEvt:r})}}))}var t8=(()=>{let e=class{constructor(t,i){this.splittableMarks=[],this.editor=i,this.baseExtensions=t,this.extensions=WS(t),this.schema=m5(this.extensions,i),this.setupExtensions()}get commands(){return this.extensions.reduce((t,i)=>{let n={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:this.editor,type:lm(i.name,this.schema)},s=re(i,"addCommands",n);return s?b(b({},t),s()):t},{})}get plugins(){let{editor:t}=this;return hm([...this.extensions].reverse()).flatMap(s=>{let o={name:s.name,options:s.options,storage:this.editor.extensionStorage[s.name],editor:t,type:lm(s.name,this.schema)},r=[],a=re(s,"addKeyboardShortcuts",o),l={};if(s.type==="mark"&&re(s,"exitable",o)&&(l.ArrowRight=()=>Mi.handleExit({editor:t,mark:s})),a){let p=Object.fromEntries(Object.entries(a()).map(([g,f])=>[g,()=>f({editor:t})]));l=b(b({},l),p)}let d=NS(l);r.push(d);let c=re(s,"addInputRules",o);if(US(s,t.options.enableInputRules)&&c){let p=c();if(p&&p.length){let g=j5({editor:t,rules:p}),f=Array.isArray(g)?g:[g];r.push(...f)}}let u=re(s,"addPasteRules",o);if(US(s,t.options.enablePasteRules)&&u){let p=u();if(p&&p.length){let g=e8({editor:t,rules:p});r.push(...g)}}let h=re(s,"addProseMirrorPlugins",o);if(h){let p=h();r.push(...p)}return r})}get attributes(){return i2(this.extensions)}get nodeViews(){let{editor:t}=this,{nodeExtensions:i}=Qr(this.extensions);return Object.fromEntries(i.filter(n=>!!re(n,"addNodeView")).map(n=>{let s=this.attributes.filter(d=>d.type===n.name),o={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:ct(n.name,this.schema)},r=re(n,"addNodeView",o);if(!r)return[];let a=r();if(!a)return[];let l=(d,c,u,h,p)=>{let g=Jc(d,s);return a({node:d,view:c,getPos:u,decorations:h,innerDecorations:p,editor:t,extension:n,HTMLAttributes:g})};return[n.name,l]}))}get markViews(){let{editor:t}=this,{markExtensions:i}=Qr(this.extensions);return Object.fromEntries(i.filter(n=>!!re(n,"addMarkView")).map(n=>{let s=this.attributes.filter(l=>l.type===n.name),o={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:is(n.name,this.schema)},r=re(n,"addMarkView",o);if(!r)return[];let a=(l,d,c)=>{let u=Jc(l,s);return r()({mark:l,view:d,inline:c,editor:t,extension:n,HTMLAttributes:u,updateAttributes:h=>{h8(l,t,h)}})};return[n.name,a]}))}setupExtensions(){let t=this.extensions;this.editor.extensionStorage=Object.fromEntries(t.map(i=>[i.name,i.storage])),t.forEach(i=>{var n;let s={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:this.editor,type:lm(i.name,this.schema)};i.type==="mark"&&((n=Ve(re(i,"keepOnSplit",s)))==null||n)&&this.splittableMarks.push(i.name);let o=re(i,"onBeforeCreate",s),r=re(i,"onCreate",s),a=re(i,"onUpdate",s),l=re(i,"onSelectionUpdate",s),d=re(i,"onTransaction",s),c=re(i,"onFocus",s),u=re(i,"onBlur",s),h=re(i,"onDestroy",s);o&&this.editor.on("beforeCreate",o),r&&this.editor.on("create",r),a&&this.editor.on("update",a),l&&this.editor.on("selectionUpdate",l),d&&this.editor.on("transaction",d),c&&this.editor.on("focus",c),u&&this.editor.on("blur",u),h&&this.editor.on("destroy",h)})}};return e.resolve=WS,e.sort=hm,e.flatten=wm,e})(),i8={};gm(i8,{ClipboardTextSerializer:()=>u2,Commands:()=>h2,Delete:()=>p2,Drop:()=>g2,Editable:()=>f2,FocusEvents:()=>C2,Keymap:()=>v2,Paste:()=>w2,Tabindex:()=>b2,TextDirection:()=>y2,focusEventsPluginKey:()=>m2});var Oe=class c2 extends xm{constructor(){super(...arguments),this.type="extension"}static create(t={}){let i=typeof t=="function"?t():t;return new c2(i)}configure(t){return super.configure(t)}extend(t){let i=typeof t=="function"?t():t;return super.extend(i)}},u2=Oe.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new fe({key:new Me("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{let{editor:e}=this,{state:t,schema:i}=e,{doc:n,selection:s}=t,{ranges:o}=s,r=Math.min(...o.map(c=>c.$from.pos)),a=Math.max(...o.map(c=>c.$to.pos)),l=s2(i);return n2(n,{from:r,to:a},O(b({},this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{}),{textSerializers:l}))}}})]}}),h2=Oe.create({name:"commands",addCommands(){return b({},jS)}}),p2=Oe.create({name:"delete",onUpdate({transaction:e,appendedTransactions:t}){var i,n,s;let o=()=>{var r,a,l,d;if((d=(l=(a=(r=this.editor.options.coreExtensionOptions)==null?void 0:r.delete)==null?void 0:a.filterTransaction)==null?void 0:l.call(a,e))!=null?d:e.getMeta("y-sync$"))return;let c=vm(e.before,[e,...t]);Sm(c).forEach(p=>{c.mapping.mapResult(p.oldRange.from).deletedAfter&&c.mapping.mapResult(p.oldRange.to).deletedBefore&&c.before.nodesBetween(p.oldRange.from,p.oldRange.to,(g,f)=>{let m=f+g.nodeSize-2,C=p.oldRange.from<=f&&m<=p.oldRange.to;this.editor.emit("delete",{type:"node",node:g,from:f,to:m,newFrom:c.mapping.map(f),newTo:c.mapping.map(m),deletedRange:p.oldRange,newRange:p.newRange,partial:!C,editor:this.editor,transaction:e,combinedTransform:c})})});let h=c.mapping;c.steps.forEach((p,g)=>{var f,m;if(p instanceof Yn){let C=h.slice(g).map(p.from,-1),v=h.slice(g).map(p.to),w=h.invert().map(C,-1),y=h.invert().map(v),S=(f=c.doc.nodeAt(C-1))==null?void 0:f.marks.some(E=>E.eq(p.mark)),x=(m=c.doc.nodeAt(v))==null?void 0:m.marks.some(E=>E.eq(p.mark));this.editor.emit("delete",{type:"mark",mark:p.mark,from:p.from,to:p.to,deletedRange:{from:w,to:y},newRange:{from:C,to:v},partial:!!(x||S),editor:this.editor,transaction:e,combinedTransform:c})}})};(s=(n=(i=this.editor.options.coreExtensionOptions)==null?void 0:i.delete)==null?void 0:n.async)==null||s?setTimeout(o,0):o()}}),g2=Oe.create({name:"drop",addProseMirrorPlugins(){return[new fe({key:new Me("tiptapDrop"),props:{handleDrop:(e,t,i,n)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:i,moved:n})}}})]}}),f2=Oe.create({name:"editable",addProseMirrorPlugins(){return[new fe({key:new Me("editable"),props:{editable:()=>this.editor.options.editable}})]}}),m2=new Me("focusEvents"),C2=Oe.create({name:"focusEvents",addProseMirrorPlugins(){let{editor:e}=this;return[new fe({key:m2,props:{handleDOMEvents:{focus:(t,i)=>{e.isFocused=!0;let n=e.state.tr.setMeta("focus",{event:i}).setMeta("addToHistory",!1);return t.dispatch(n),!1},blur:(t,i)=>{e.isFocused=!1;let n=e.state.tr.setMeta("blur",{event:i}).setMeta("addToHistory",!1);return t.dispatch(n),!1}}}})]}}),v2=Oe.create({name:"keymap",addKeyboardShortcuts(){let e=()=>this.editor.commands.first(({commands:r})=>[()=>r.undoInputRule(),()=>r.command(({tr:a})=>{let{selection:l,doc:d}=a,{empty:c,$anchor:u}=l,{pos:h,parent:p}=u,g=u.parent.isTextblock&&h>0?a.doc.resolve(h-1):u,f=g.parent.type.spec.isolating,m=u.pos-u.parentOffset,C=f&&g.parent.childCount===1?m===u.pos:ge.atStart(d).from===h;return!c||!p.type.isTextblock||p.textContent.length||!C||C&&u.parent.type.name==="paragraph"?!1:r.clearNodes()}),()=>r.deleteSelection(),()=>r.joinBackward(),()=>r.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:r})=>[()=>r.deleteSelection(),()=>r.deleteCurrentNode(),()=>r.joinForward(),()=>r.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:r})=>[()=>r.newlineInCode(),()=>r.createParagraphNear(),()=>r.liftEmptyBlock(),()=>r.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},s=b({},n),o=O(b({},n),{"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()});return Cm()||QS()?o:s},addProseMirrorPlugins(){return[new fe({key:new Me("clearDocument"),appendTransaction:(e,t,i)=>{if(e.some(f=>f.getMeta("composition")))return;let n=e.some(f=>f.docChanged)&&!t.doc.eq(i.doc),s=e.some(f=>f.getMeta("preventClearDocument"));if(!n||s)return;let{empty:o,from:r,to:a}=t.selection,l=ge.atStart(t.doc).from,d=ge.atEnd(t.doc).to;if(o||!(r===l&&a===d)||!kl(i.doc))return;let h=i.tr,p=Qc({state:i,transaction:h}),{commands:g}=new Zc({editor:this.editor,state:p});if(g.clearNodes(),!!h.steps.length)return h}})]}}),w2=Oe.create({name:"paste",addProseMirrorPlugins(){return[new fe({key:new Me("tiptapPaste"),props:{handlePaste:(e,t,i)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:i})}}})]}}),b2=Oe.create({name:"tabindex",addProseMirrorPlugins(){return[new fe({key:new Me("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),y2=Oe.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];let{nodeExtensions:e}=Qr(this.extensions);return[{types:e.filter(t=>t.name!=="text").map(t=>t.name),attributes:{dir:{default:this.options.direction,parseHTML:t=>{let i=t.getAttribute("dir");return i&&(i==="ltr"||i==="rtl"||i==="auto")?i:this.options.direction},renderHTML:t=>t.dir?{dir:t.dir}:{}}}}]},addProseMirrorPlugins(){return[new fe({key:new Me("textDirection"),props:{attributes:()=>{let e=this.options.direction;return e?{dir:e}:{}}}})]}}),n8=class Jr{constructor(t,i,n=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=t,this.editor=i,this.currentNode=s}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var t;return(t=this.actualDepth)!=null?t:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(t){let i=this.from,n=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can\u2019t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}i=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:i,to:n},t)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;let t=this.resolvedPos.start(this.resolvedPos.depth-1),i=this.resolvedPos.doc.resolve(t);return new Jr(i,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new Jr(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new Jr(t,this.editor)}get children(){let t=[];return this.node.content.forEach((i,n)=>{let s=i.isBlock&&!i.isTextblock,o=i.isAtom&&!i.isText,r=this.pos+n+(o?0:1);if(r<0||r>this.resolvedPos.doc.nodeSize-2)return;let a=this.resolvedPos.doc.resolve(r);if(!s&&a.depth<=this.depth)return;let l=new Jr(a,this.editor,s,s?i:null);s&&(l.actualDepth=this.depth+1),t.push(new Jr(a,this.editor,s,s?i:null))}),t}get firstChild(){return this.children[0]||null}get lastChild(){let t=this.children;return t[t.length-1]||null}closest(t,i={}){let n=null,s=this.parent;for(;s&&!n;){if(s.node.type.name===t)if(Object.keys(i).length>0){let o=s.node.attrs,r=Object.keys(i);for(let a=0;a<r.length;a+=1){let l=r[a];if(o[l]!==i[l])break}}else n=s;s=s.parent}return n}querySelector(t,i={}){return this.querySelectorAll(t,i,!0)[0]||null}querySelectorAll(t,i={},n=!1){let s=[];if(!this.children||this.children.length===0)return s;let o=Object.keys(i);return this.children.forEach(r=>{n&&s.length>0||(r.node.type.name===t&&o.every(l=>i[l]===r.node.attrs[l])&&s.push(r),!(n&&s.length>0)&&(s=s.concat(r.querySelectorAll(t,i,n))))}),s}setAttribute(t){let{tr:i}=this.editor.state;i.setNodeMarkup(this.from,void 0,b(b({},this.node.attrs),t)),this.editor.view.dispatch(i)}},s8=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function o8(e,t,i){let n=document.querySelector(`style[data-tiptap-style${i?`-${i}`:""}]`);if(n!==null)return n;let s=document.createElement("style");return t&&s.setAttribute("nonce",t),s.setAttribute(`data-tiptap-style${i?`-${i}`:""}`,""),s.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(s),s}var S2=class extends q5{constructor(e={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:s,moved:o})=>this.options.onDrop(n,s,o)),this.on("paste",({event:n,slice:s})=>this.options.onPaste(n,s)),this.on("delete",this.options.onDelete);let t=this.createDoc(),i=XS(t,this.options.autofocus);this.editorState=Pc.create({doc:t,schema:this.schema,selection:i||void 0}),this.options.element&&this.mount(this.options.element)}mount(e){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(e),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){let e=this.editorView.dom;e?.editor&&delete e.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(e){console.warn("Failed to remove CSS element:",e)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=o8(s8,this.options.injectNonce))}setOptions(e={}){this.options=b(b({},this.options),e),!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:e=>{this.editorState=e},dispatch:e=>{this.dispatchTransaction(e)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(e,t)=>{if(this.editorView)return this.editorView[t];if(t==="state")return this.editorState;if(t in e)return Reflect.get(e,t);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${t}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(e,t){let i=t2(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],n=this.state.reconfigure({plugins:i});return this.view.updateState(n),n}unregisterPlugin(e){if(this.isDestroyed)return;let t=this.state.plugins,i=t;if([].concat(e).forEach(s=>{let o=typeof s=="string"?`${s}$`:s.key;i=i.filter(r=>!r.key.startsWith(o))}),t.length===i.length)return;let n=this.state.reconfigure({plugins:i});return this.view.updateState(n),n}createExtensionManager(){var e,t;let n=[...this.options.enableCoreExtensions?[f2,u2.configure({blockSeparator:(t=(e=this.options.coreExtensionOptions)==null?void 0:e.clipboardTextSerializer)==null?void 0:t.blockSeparator}),h2,C2,v2,b2,g2,w2,p2,y2.configure({direction:this.options.textDirection})].filter(s=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[s.name]!==!1:!0):[],...this.options.extensions].filter(s=>["extension","node","mark"].includes(s?.type));this.extensionManager=new t8(n,this)}createCommandManager(){this.commandManager=new Zc({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let e;try{e=um(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(t){if(!(t instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(t.message))throw t;this.emit("contentError",{editor:this,error:t,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(i=>i.name!=="collaboration"),this.createExtensionManager()}}),e=um(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return e}createView(e){var t;this.editorView=new El(e,O(b({},this.options.editorProps),{attributes:b({role:"textbox"},(t=this.options.editorProps)==null?void 0:t.attributes),dispatchTransaction:this.dispatchTransaction.bind(this),state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews}));let i=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(i),this.prependClass(),this.injectCSS();let n=this.view.dom;n.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;let t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(d=>{var c;return(c=this.capturedTransaction)==null?void 0:c.step(d)});return}let{state:t,transactions:i}=this.state.applyTransaction(e),n=!this.state.selection.eq(t.selection),s=i.includes(e),o=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),!s)return;this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e,appendedTransactions:i.slice(1)}),n&&this.emit("selectionUpdate",{editor:this,transaction:e});let r=i.findLast(d=>d.getMeta("focus")||d.getMeta("blur")),a=r?.getMeta("focus"),l=r?.getMeta("blur");a&&this.emit("focus",{editor:this,event:a.event,transaction:r}),l&&this.emit("blur",{editor:this,event:l.event,transaction:r}),!(e.getMeta("preventUpdate")||!i.some(d=>d.docChanged)||o.doc.eq(t.doc))&&this.emit("update",{editor:this,transaction:e,appendedTransactions:i.slice(1)})}getAttributes(e){return ym(this.state,e)}isActive(e,t){let i=typeof e=="string"?e:null,n=typeof e=="string"?t:e;return x5(this.state,i,n)}getJSON(){return this.state.doc.toJSON()}getHTML(){return bm(this.state.doc.content,this.schema)}getText(e){let{blockSeparator:t=`

`,textSerializers:i={}}=e||{};return v5(this.state.doc,{blockSeparator:t,textSerializers:b(b({},s2(this.schema)),i)})}get isEmpty(){return kl(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var e,t;return(t=(e=this.editorView)==null?void 0:e.isDestroyed)!=null?t:!0}$node(e,t){var i;return((i=this.$doc)==null?void 0:i.querySelector(e,t))||null}$nodes(e,t){var i;return((i=this.$doc)==null?void 0:i.querySelectorAll(e,t))||null}$pos(e){let t=this.state.doc.resolve(e);return new n8(t,this)}get $doc(){return this.$pos(0)}};function bn(e){return new su({find:e.find,handler:({state:t,range:i,match:n})=>{let s=Ve(e.getAttributes,void 0,n);if(s===!1||s===null)return null;let{tr:o}=t,r=n[n.length-1],a=n[0];if(r){let l=a.search(/\S/),d=i.from+a.indexOf(r),c=d+r.length;if(iu(i.from,i.to,t.doc).filter(p=>p.mark.type.excluded.find(f=>f===e.type&&f!==p.mark.type)).filter(p=>p.to>d).length)return null;c<i.to&&o.delete(c,i.to),d>i.from&&o.delete(i.from+l,d);let h=i.from+l+r.length;o.addMark(i.from+l,h,e.type.create(s||{})),o.removeStoredMark(e.type)}},undoable:e.undoable})}function x2(e){return new su({find:e.find,handler:({state:t,range:i,match:n})=>{let s=Ve(e.getAttributes,void 0,n)||{},{tr:o}=t,r=i.from,a=i.to,l=e.type.create(s);if(n[1]){let d=n[0].lastIndexOf(n[1]),c=r+d;c>a?c=a:a=c+n[1].length;let u=n[0][n[0].length-1];o.insertText(u,r+n[0].length-1),o.replaceWith(c,a,l)}else if(n[0]){let d=e.type.isInline?r:r-1;o.insert(d,e.type.create(s)).delete(o.mapping.map(r),o.mapping.map(a))}o.scrollIntoView()},undoable:e.undoable})}function Pl(e){return new su({find:e.find,handler:({state:t,range:i,match:n})=>{let s=t.doc.resolve(i.from),o=Ve(e.getAttributes,void 0,n)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),e.type))return null;t.tr.delete(i.from,i.to).setBlockType(i.from,i.from,e.type,o)},undoable:e.undoable})}function yn(e){return new su({find:e.find,handler:({state:t,range:i,match:n,chain:s})=>{let o=Ve(e.getAttributes,void 0,n)||{},r=t.tr.delete(i.from,i.to),l=r.doc.resolve(i.from).blockRange(),d=l&&Gr(l,e.type,o);if(!d)return null;if(r.wrap(l,d),e.keepMarks&&e.editor){let{selection:u,storedMarks:h}=t,{splittableMarks:p}=e.editor.extensionManager,g=h||u.$to.parentOffset&&u.$from.marks();if(g){let f=g.filter(m=>p.includes(m.type.name));r.ensureMarks(f)}}if(e.keepAttributes){let u=e.type.name==="bulletList"||e.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(u,o).run()}let c=r.doc.resolve(i.from-1).nodeBefore;c&&c.type===e.type&&_i(r.doc,i.from-1)&&(!e.joinPredicate||e.joinPredicate(n,c))&&r.join(i.from-1)},undoable:e.undoable})}function E2(e,t){let{selection:i}=e,{$from:n}=i;if(i instanceof ne){let o=n.index();return n.parent.canReplaceWith(o,o+1,t)}let s=n.depth;for(;s>=0;){let o=n.index(s);if(n.node(s).contentMatchAt(o).matchType(t))return!0;s-=1}return!1}var r8={};gm(r8,{createAtomBlockMarkdownSpec:()=>a8,createBlockMarkdownSpec:()=>l8,createInlineMarkdownSpec:()=>u8,parseAttributes:()=>Em,parseIndentedBlocks:()=>ou,renderNestedMarkdownContent:()=>Fl,serializeAttributes:()=>Rm});function Em(e){if(!e?.trim())return{};let t={},i=[],n=e.replace(/["']([^"']*)["']/g,d=>(i.push(d),`__QUOTED_${i.length-1}__`)),s=n.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(s){let d=s.map(c=>c.trim().slice(1));t.class=d.join(" ")}let o=n.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);o&&(t.id=o[1]);let r=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(n.matchAll(r)).forEach(([,d,c])=>{var u;let h=parseInt(((u=c.match(/__QUOTED_(\d+)__/))==null?void 0:u[1])||"0",10),p=i[h];p&&(t[d]=p.slice(1,-1))});let l=n.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return l&&l.split(/\s+/).filter(Boolean).forEach(c=>{c.match(/^[a-zA-Z][\w-]*$/)&&(t[c]=!0)}),t}function Rm(e){if(!e||Object.keys(e).length===0)return"";let t=[];return e.class&&String(e.class).split(/\s+/).filter(Boolean).forEach(n=>t.push(`.${n}`)),e.id&&t.push(`#${e.id}`),Object.entries(e).forEach(([i,n])=>{i==="class"||i==="id"||(n===!0?t.push(i):n!==!1&&n!=null&&t.push(`${i}="${String(n)}"`))}),t.join(" ")}function a8(e){let{nodeName:t,name:i,parseAttributes:n=Em,serializeAttributes:s=Rm,defaultAttributes:o={},requiredAttributes:r=[],allowedAttributes:a}=e,l=i||t,d=c=>{if(!a)return c;let u={};return a.forEach(h=>{h in c&&(u[h]=c[h])}),u};return{parseMarkdown:(c,u)=>{let h=b(b({},o),c.attributes);return u.createNode(t,h,[])},markdownTokenizer:{name:t,level:"block",start(c){var u;let h=new RegExp(`^:::${l}(?:\\s|$)`,"m"),p=(u=c.match(h))==null?void 0:u.index;return p!==void 0?p:-1},tokenize(c,u,h){let p=new RegExp(`^:::${l}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),g=c.match(p);if(!g)return;let f=g[1]||"",m=n(f);if(!r.find(v=>!(v in m)))return{type:t,raw:g[0],attributes:m}}},renderMarkdown:c=>{let u=d(c.attrs||{}),h=s(u),p=h?` {${h}}`:"";return`:::${l}${p} :::`}}}function l8(e){let{nodeName:t,name:i,getContent:n,parseAttributes:s=Em,serializeAttributes:o=Rm,defaultAttributes:r={},content:a="block",allowedAttributes:l}=e,d=i||t,c=u=>{if(!l)return u;let h={};return l.forEach(p=>{p in u&&(h[p]=u[p])}),h};return{parseMarkdown:(u,h)=>{let p;if(n){let f=n(u);p=typeof f=="string"?[{type:"text",text:f}]:f}else a==="block"?p=h.parseChildren(u.tokens||[]):p=h.parseInline(u.tokens||[]);let g=b(b({},r),u.attributes);return h.createNode(t,g,p)},markdownTokenizer:{name:t,level:"block",start(u){var h;let p=new RegExp(`^:::${d}`,"m"),g=(h=u.match(p))==null?void 0:h.index;return g!==void 0?g:-1},tokenize(u,h,p){var g;let f=new RegExp(`^:::${d}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),m=u.match(f);if(!m)return;let[C,v=""]=m,w=s(v),y=1,S=C.length,x="",E=/^:::([\w-]*)(\s.*)?/gm,T=u.slice(S);for(E.lastIndex=0;;){let L=E.exec(T);if(L===null)break;let N=L.index,$=L[1];if(!((g=L[2])!=null&&g.endsWith(":::"))){if($)y+=1;else if(y-=1,y===0){let G=T.slice(0,N);x=G.trim();let se=u.slice(0,S+N+L[0].length),ve=[];if(x)if(a==="block")for(ve=p.blockTokens(G),ve.forEach(me=>{me.text&&(!me.tokens||me.tokens.length===0)&&(me.tokens=p.inlineTokens(me.text))});ve.length>0;){let me=ve[ve.length-1];if(me.type==="paragraph"&&(!me.text||me.text.trim()===""))ve.pop();else break}else ve=p.inlineTokens(x);return{type:t,raw:se,attributes:w,content:x,tokens:ve}}}}}},renderMarkdown:(u,h)=>{let p=c(u.attrs||{}),g=o(p),f=g?` {${g}}`:"",m=h.renderChildren(u.content||[],`

`);return`:::${d}${f}

${m}

:::`}}}function d8(e){if(!e.trim())return{};let t={},i=/(\w+)=(?:"([^"]*)"|'([^']*)')/g,n=i.exec(e);for(;n!==null;){let[,s,o,r]=n;t[s]=o||r,n=i.exec(e)}return t}function c8(e){return Object.entries(e).filter(([,t])=>t!=null).map(([t,i])=>`${t}="${i}"`).join(" ")}function u8(e){let{nodeName:t,name:i,getContent:n,parseAttributes:s=d8,serializeAttributes:o=c8,defaultAttributes:r={},selfClosing:a=!1,allowedAttributes:l}=e,d=i||t,c=h=>{if(!l)return h;let p={};return l.forEach(g=>{g in h&&(p[g]=h[g])}),p},u=d.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(h,p)=>{let g=b(b({},r),h.attributes);if(a)return p.createNode(t,g);let f=n?n(h):h.content||"";return f?p.createNode(t,g,[p.createTextNode(f)]):p.createNode(t,g,[])},markdownTokenizer:{name:t,level:"inline",start(h){let p=a?new RegExp(`\\[${u}\\s*[^\\]]*\\]`):new RegExp(`\\[${u}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${u}\\]`),g=h.match(p),f=g?.index;return f!==void 0?f:-1},tokenize(h,p,g){let f=a?new RegExp(`^\\[${u}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${u}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${u}\\]`),m=h.match(f);if(!m)return;let C="",v="";if(a){let[,y]=m;v=y}else{let[,y,S]=m;v=y,C=S||""}let w=s(v.trim());return{type:t,raw:m[0],content:C.trim(),attributes:w}}},renderMarkdown:h=>{let p="";n?p=n(h):h.content&&h.content.length>0&&(p=h.content.filter(C=>C.type==="text").map(C=>C.text).join(""));let g=c(h.attrs||{}),f=o(g),m=f?` ${f}`:"";return a?`[${d}${m}]`:`[${d}${m}]${p}[/${d}]`}}}function ou(e,t,i){var n,s,o,r;let a=e.split(`
`),l=[],d="",c=0,u=t.baseIndentSize||2;for(;c<a.length;){let h=a[c],p=h.match(t.itemPattern);if(!p){if(l.length>0)break;if(h.trim()===""){c+=1,d=`${d}${h}
`;continue}else return}let g=t.extractItemData(p),{indentLevel:f,mainContent:m}=g;d=`${d}${h}
`;let C=[m];for(c+=1;c<a.length;){let S=a[c];if(S.trim()===""){let E=a.slice(c+1).findIndex(N=>N.trim()!=="");if(E===-1)break;if((((s=(n=a[c+1+E].match(/^(\s*)/))==null?void 0:n[1])==null?void 0:s.length)||0)>f){C.push(S),d=`${d}${S}
`,c+=1;continue}else break}if((((r=(o=S.match(/^(\s*)/))==null?void 0:o[1])==null?void 0:r.length)||0)>f)C.push(S),d=`${d}${S}
`,c+=1;else break}let v,w=C.slice(1);if(w.length>0){let S=w.map(x=>x.slice(f+u)).join(`
`);S.trim()&&(t.customNestedParser?v=t.customNestedParser(S):v=i.blockTokens(S))}let y=t.createToken(g,v);l.push(y)}if(l.length!==0)return{items:l,raw:d}}function Fl(e,t,i,n){if(!e||!Array.isArray(e.content))return"";let s=typeof i=="function"?i(n):i,[o,...r]=e.content,a=t.renderChildren([o]),l=[`${s}${a}`];return r&&r.length>0&&r.forEach(d=>{let c=t.renderChildren([d]);if(c){let u=c.split(`
`).map(h=>h?t.indent(h):"").join(`
`);l.push(u)}}),l.join(`
`)}function h8(e,t,i={}){let{state:n}=t,{doc:s,tr:o}=n,r=e;s.descendants((a,l)=>{let d=o.mapping.map(l),c=o.mapping.map(l)+a.nodeSize,u=null;if(a.marks.forEach(p=>{if(p!==r)return!1;u=p}),!u)return;let h=!1;if(Object.keys(i).forEach(p=>{i[p]!==u.attrs[p]&&(h=!0)}),h){let p=e.type.create(b(b({},e.attrs),i));o.removeMark(d,c,e.type),o.addMark(d,c,p)}}),o.docChanged&&t.view.dispatch(o)}var Ye=class R2 extends xm{constructor(){super(...arguments),this.type="node"}static create(t={}){let i=typeof t=="function"?t():t;return new R2(i)}configure(t){return super.configure(t)}extend(t){let i=typeof t=="function"?t():t;return super.extend(i)}};function Hi(e){return new X5({find:e.find,handler:({state:t,range:i,match:n,pasteEvent:s})=>{let o=Ve(e.getAttributes,void 0,n,s);if(o===!1||o===null)return null;let{tr:r}=t,a=n[n.length-1],l=n[0],d=i.to;if(a){let c=l.search(/\S/),u=i.from+l.indexOf(a),h=u+a.length;if(iu(i.from,i.to,t.doc).filter(g=>g.mark.type.excluded.find(m=>m===e.type&&m!==g.mark.type)).filter(g=>g.to>u).length)return null;h<i.to&&r.delete(h,i.to),u>i.from&&r.delete(i.from+c,u),d=i.from+c+a.length,r.addMark(i.from+c,d,e.type.create(o||{})),r.removeStoredMark(e.type)}}})}var p8="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5m\xF6gensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",g8="\u03B5\u03BB1\u03C52\u0431\u04331\u0435\u043B3\u0434\u0435\u0442\u04384\u0435\u044E2\u043A\u0430\u0442\u043E\u043B\u0438\u043A6\u043E\u043C3\u043C\u043A\u04342\u043E\u043D1\u0441\u043A\u0432\u04306\u043E\u043D\u043B\u0430\u0439\u043D5\u0440\u04333\u0440\u0443\u04412\u04442\u0441\u0430\u0439\u04423\u0440\u04313\u0443\u043A\u04403\u049B\u0430\u04373\u0570\u0561\u05753\u05D9\u05E9\u05E8\u05D0\u05DC5\u05E7\u05D5\u05DD3\u0627\u0628\u0648\u0638\u0628\u064A5\u0631\u0627\u0645\u0643\u06485\u0644\u0627\u0631\u062F\u06464\u0628\u062D\u0631\u064A\u06465\u062C\u0632\u0627\u0626\u06315\u0633\u0639\u0648\u062F\u064A\u06296\u0639\u0644\u064A\u0627\u06465\u0645\u063A\u0631\u06285\u0645\u0627\u0631\u0627\u062A5\u06CC\u0631\u0627\u06465\u0628\u0627\u0631\u062A2\u0632\u0627\u06314\u064A\u062A\u06433\u06BE\u0627\u0631\u062A5\u062A\u0648\u0646\u06334\u0633\u0648\u062F\u0627\u06463\u0631\u064A\u06295\u0634\u0628\u0643\u06294\u0639\u0631\u0627\u06422\u06282\u0645\u0627\u06464\u0641\u0644\u0633\u0637\u064A\u06466\u0642\u0637\u06313\u0643\u0627\u062B\u0648\u0644\u064A\u06436\u0648\u06453\u0645\u0635\u06312\u0644\u064A\u0633\u064A\u06275\u0648\u0631\u064A\u062A\u0627\u0646\u064A\u06277\u0642\u06394\u0647\u0645\u0631\u0627\u06475\u067E\u0627\u06A9\u0633\u062A\u0627\u06467\u0680\u0627\u0631\u062A4\u0915\u0949\u092E3\u0928\u0947\u091F3\u092D\u093E\u0930\u09240\u092E\u094D3\u094B\u09245\u0938\u0902\u0917\u0920\u09285\u09AC\u09BE\u0982\u09B2\u09BE5\u09AD\u09BE\u09B0\u09A42\u09F0\u09A44\u0A2D\u0A3E\u0A30\u0A244\u0AAD\u0ABE\u0AB0\u0AA44\u0B2D\u0B3E\u0B30\u0B244\u0B87\u0BA8\u0BCD\u0BA4\u0BBF\u0BAF\u0BBE6\u0BB2\u0B99\u0BCD\u0B95\u0BC86\u0B9A\u0BBF\u0B99\u0BCD\u0B95\u0BAA\u0BCD\u0BAA\u0BC2\u0BB0\u0BCD11\u0C2D\u0C3E\u0C30\u0C24\u0C4D5\u0CAD\u0CBE\u0CB0\u0CA44\u0D2D\u0D3E\u0D30\u0D24\u0D025\u0DBD\u0D82\u0D9A\u0DCF4\u0E04\u0E2D\u0E213\u0E44\u0E17\u0E223\u0EA5\u0EB2\u0EA73\u10D2\u10D42\u307F\u3093\u306A3\u30A2\u30DE\u30BE\u30F34\u30AF\u30E9\u30A6\u30C94\u30B0\u30FC\u30B0\u30EB4\u30B3\u30E02\u30B9\u30C8\u30A23\u30BB\u30FC\u30EB3\u30D5\u30A1\u30C3\u30B7\u30E7\u30F36\u30DD\u30A4\u30F3\u30C84\u4E16\u754C2\u4E2D\u4FE11\u56FD1\u570B1\u6587\u7F513\u4E9A\u9A6C\u900A3\u4F01\u4E1A2\u4F5B\u5C712\u4FE1\u606F2\u5065\u5EB72\u516B\u53662\u516C\u53F81\u76CA2\u53F0\u6E7E1\u70632\u5546\u57CE1\u5E971\u68072\u5609\u91CC0\u5927\u9152\u5E975\u5728\u7EBF2\u5927\u62FF2\u5929\u4E3B\u65593\u5A31\u4E502\u5BB6\u96FB2\u5E7F\u4E1C2\u5FAE\u535A2\u6148\u55842\u6211\u7231\u4F603\u624B\u673A2\u62DB\u80582\u653F\u52A11\u5E9C2\u65B0\u52A0\u57612\u95FB2\u65F6\u5C1A2\u66F8\u7C4D2\u673A\u67842\u6DE1\u9A6C\u95213\u6E38\u620F2\u6FB3\u95802\u70B9\u770B2\u79FB\u52A82\u7EC4\u7EC7\u673A\u67844\u7F51\u57401\u5E971\u7AD91\u7EDC2\u8054\u901A2\u8C37\u6B4C2\u8D2D\u72692\u901A\u8CA92\u96C6\u56E22\u96FB\u8A0A\u76C8\u79D14\u98DE\u5229\u6D663\u98DF\u54C12\u9910\u53852\u9999\u683C\u91CC\u62C93\u6E2F2\uB2F7\uB1371\uCEF42\uC0BC\uC1312\uD55C\uAD6D2",Am="numeric",Im="ascii",_m="alpha",Il="asciinumeric",Al="alphanumeric",Lm="domain",A2="emoji",f8="scheme",m8="slashscheme",Mm="whitespace";function C8(e,t){return e in t||(t[e]=[]),t[e]}function Go(e,t,i){t[Am]&&(t[Il]=!0,t[Al]=!0),t[Im]&&(t[Il]=!0,t[_m]=!0),t[Il]&&(t[Al]=!0),t[_m]&&(t[Al]=!0),t[Al]&&(t[Lm]=!0),t[A2]&&(t[Lm]=!0);for(let n in t){let s=C8(n,i);s.indexOf(e)<0&&s.push(e)}}function v8(e,t){let i={};for(let n in t)t[n].indexOf(e)>=0&&(i[n]=!0);return i}function wi(e=null){this.j={},this.jr=[],this.jd=null,this.t=e}wi.groups={};wi.prototype={accepts(){return!!this.t},go(e){let t=this,i=t.j[e];if(i)return i;for(let n=0;n<t.jr.length;n++){let s=t.jr[n][0],o=t.jr[n][1];if(o&&s.test(e))return o}return t.jd},has(e,t=!1){return t?e in this.j:!!this.go(e)},ta(e,t,i,n){for(let s=0;s<e.length;s++)this.tt(e[s],t,i,n)},tr(e,t,i,n){n=n||wi.groups;let s;return t&&t.j?s=t:(s=new wi(t),i&&n&&Go(t,i,n)),this.jr.push([e,s]),s},ts(e,t,i,n){let s=this,o=e.length;if(!o)return s;for(let r=0;r<o-1;r++)s=s.tt(e[r]);return s.tt(e[o-1],t,i,n)},tt(e,t,i,n){n=n||wi.groups;let s=this;if(t&&t.j)return s.j[e]=t,t;let o=t,r,a=s.go(e);if(a?(r=new wi,Object.assign(r.j,a.j),r.jr.push.apply(r.jr,a.jr),r.jd=a.jd,r.t=a.t):r=new wi,o){if(n)if(r.t&&typeof r.t=="string"){let l=Object.assign(v8(r.t,n),i);Go(o,l,n)}else i&&Go(o,i,n);r.t=o}return s.j[e]=r,r}};var Re=(e,t,i,n,s)=>e.ta(t,i,n,s),ut=(e,t,i,n,s)=>e.tr(t,i,n,s),M2=(e,t,i,n,s)=>e.ts(t,i,n,s),V=(e,t,i,n,s)=>e.tt(t,i,n,s),rs="WORD",Om="UWORD",I2="ASCIINUMERICAL",_2="ALPHANUMERICAL",Hl="LOCALHOST",Nm="TLD",Bm="UTLD",du="SCHEME",Zr="SLASH_SCHEME",Vm="NUM",Hm="WS",Gm="NL",_l="OPENBRACE",Ll="CLOSEBRACE",cu="OPENBRACKET",uu="CLOSEBRACKET",hu="OPENPAREN",pu="CLOSEPAREN",gu="OPENANGLEBRACKET",fu="CLOSEANGLEBRACKET",mu="FULLWIDTHLEFTPAREN",Cu="FULLWIDTHRIGHTPAREN",vu="LEFTCORNERBRACKET",wu="RIGHTCORNERBRACKET",bu="LEFTWHITECORNERBRACKET",yu="RIGHTWHITECORNERBRACKET",Su="FULLWIDTHLESSTHAN",xu="FULLWIDTHGREATERTHAN",Eu="AMPERSAND",Ru="APOSTROPHE",Mu="ASTERISK",Gs="AT",Du="BACKSLASH",ku="BACKTICK",Pu="CARET",zs="COLON",zm="COMMA",Fu="DOLLAR",Sn="DOT",Tu="EQUALS",Wm="EXCLAMATION",Gi="HYPHEN",Ol="PERCENT",Au="PIPE",Iu="PLUS",_u="POUND",Nl="QUERY",Um="QUOTE",L2="FULLWIDTHMIDDLEDOT",qm="SEMI",xn="SLASH",Bl="TILDE",Lu="UNDERSCORE",O2="EMOJI",Ou="SYM",N2=Object.freeze({__proto__:null,ALPHANUMERICAL:_2,AMPERSAND:Eu,APOSTROPHE:Ru,ASCIINUMERICAL:I2,ASTERISK:Mu,AT:Gs,BACKSLASH:Du,BACKTICK:ku,CARET:Pu,CLOSEANGLEBRACKET:fu,CLOSEBRACE:Ll,CLOSEBRACKET:uu,CLOSEPAREN:pu,COLON:zs,COMMA:zm,DOLLAR:Fu,DOT:Sn,EMOJI:O2,EQUALS:Tu,EXCLAMATION:Wm,FULLWIDTHGREATERTHAN:xu,FULLWIDTHLEFTPAREN:mu,FULLWIDTHLESSTHAN:Su,FULLWIDTHMIDDLEDOT:L2,FULLWIDTHRIGHTPAREN:Cu,HYPHEN:Gi,LEFTCORNERBRACKET:vu,LEFTWHITECORNERBRACKET:bu,LOCALHOST:Hl,NL:Gm,NUM:Vm,OPENANGLEBRACKET:gu,OPENBRACE:_l,OPENBRACKET:cu,OPENPAREN:hu,PERCENT:Ol,PIPE:Au,PLUS:Iu,POUND:_u,QUERY:Nl,QUOTE:Um,RIGHTCORNERBRACKET:wu,RIGHTWHITECORNERBRACKET:yu,SCHEME:du,SEMI:qm,SLASH:xn,SLASH_SCHEME:Zr,SYM:Ou,TILDE:Bl,TLD:Nm,UNDERSCORE:Lu,UTLD:Bm,UWORD:Om,WORD:rs,WS:Hm}),ns=/[a-z]/,Tl=new RegExp("\\p{L}","u"),Dm=new RegExp("\\p{Emoji}","u");var ss=/\d/,km=/\s/;var D2="\r",Pm=`
`,w8="\uFE0F",b8="\u200D",Fm="\uFFFC",ru=null,au=null;function y8(e=[]){let t={};wi.groups=t;let i=new wi;ru==null&&(ru=k2(p8)),au==null&&(au=k2(g8)),V(i,"'",Ru),V(i,"{",_l),V(i,"}",Ll),V(i,"[",cu),V(i,"]",uu),V(i,"(",hu),V(i,")",pu),V(i,"<",gu),V(i,">",fu),V(i,"\uFF08",mu),V(i,"\uFF09",Cu),V(i,"\u300C",vu),V(i,"\u300D",wu),V(i,"\u300E",bu),V(i,"\u300F",yu),V(i,"\uFF1C",Su),V(i,"\uFF1E",xu),V(i,"&",Eu),V(i,"*",Mu),V(i,"@",Gs),V(i,"`",ku),V(i,"^",Pu),V(i,":",zs),V(i,",",zm),V(i,"$",Fu),V(i,".",Sn),V(i,"=",Tu),V(i,"!",Wm),V(i,"-",Gi),V(i,"%",Ol),V(i,"|",Au),V(i,"+",Iu),V(i,"#",_u),V(i,"?",Nl),V(i,'"',Um),V(i,"/",xn),V(i,";",qm),V(i,"~",Bl),V(i,"_",Lu),V(i,"\\",Du),V(i,"\u30FB",L2);let n=ut(i,ss,Vm,{[Am]:!0});ut(n,ss,n);let s=ut(n,ns,I2,{[Il]:!0}),o=ut(n,Tl,_2,{[Al]:!0}),r=ut(i,ns,rs,{[Im]:!0});ut(r,ss,s),ut(r,ns,r),ut(s,ss,s),ut(s,ns,s);let a=ut(i,Tl,Om,{[_m]:!0});ut(a,ns),ut(a,ss,o),ut(a,Tl,a),ut(o,ss,o),ut(o,ns),ut(o,Tl,o);let l=V(i,Pm,Gm,{[Mm]:!0}),d=V(i,D2,Hm,{[Mm]:!0}),c=ut(i,km,Hm,{[Mm]:!0});V(i,Fm,c),V(d,Pm,l),V(d,Fm,c),ut(d,km,c),V(c,D2),V(c,Pm),ut(c,km,c),V(c,Fm,c);let u=ut(i,Dm,O2,{[A2]:!0});V(u,"#"),ut(u,Dm,u),V(u,w8,u);let h=V(u,b8);V(h,"#"),ut(h,Dm,u);let p=[[ns,r],[ss,s]],g=[[ns,null],[Tl,a],[ss,o]];for(let f=0;f<ru.length;f++)Vs(i,ru[f],Nm,rs,p);for(let f=0;f<au.length;f++)Vs(i,au[f],Bm,Om,g);Go(Nm,{tld:!0,ascii:!0},t),Go(Bm,{utld:!0,alpha:!0},t),Vs(i,"file",du,rs,p),Vs(i,"mailto",du,rs,p),Vs(i,"http",Zr,rs,p),Vs(i,"https",Zr,rs,p),Vs(i,"ftp",Zr,rs,p),Vs(i,"ftps",Zr,rs,p),Go(du,{scheme:!0,ascii:!0},t),Go(Zr,{slashscheme:!0,ascii:!0},t),e=e.sort((f,m)=>f[0]>m[0]?1:-1);for(let f=0;f<e.length;f++){let m=e[f][0],v=e[f][1]?{[f8]:!0}:{[m8]:!0};m.indexOf("-")>=0?v[Lm]=!0:ns.test(m)?ss.test(m)?v[Il]=!0:v[Im]=!0:v[Am]=!0,M2(i,m,m,v)}return M2(i,"localhost",Hl,{ascii:!0}),i.jd=new wi(Ou),{start:i,tokens:Object.assign({groups:t},N2)}}function B2(e,t){let i=S8(t.replace(/[A-Z]/g,a=>a.toLowerCase())),n=i.length,s=[],o=0,r=0;for(;r<n;){let a=e,l=null,d=0,c=null,u=-1,h=-1;for(;r<n&&(l=a.go(i[r]));)a=l,a.accepts()?(u=0,h=0,c=a):u>=0&&(u+=i[r].length,h++),d+=i[r].length,o+=i[r].length,r++;o-=u,r-=h,d-=u,s.push({t:c.t,v:t.slice(o-d,o),s:o-d,e:o})}return s}function S8(e){let t=[],i=e.length,n=0;for(;n<i;){let s=e.charCodeAt(n),o,r=s<55296||s>56319||n+1===i||(o=e.charCodeAt(n+1))<56320||o>57343?e[n]:e.slice(n,n+2);t.push(r),n+=r.length}return t}function Vs(e,t,i,n,s){let o,r=t.length;for(let a=0;a<r-1;a++){let l=t[a];e.j[l]?o=e.j[l]:(o=new wi(n),o.jr=s.slice(),e.j[l]=o),e=o}return o=new wi(i),o.jr=s.slice(),e.j[t[r-1]]=o,o}function k2(e){let t=[],i=[],n=0,s="0123456789";for(;n<e.length;){let o=0;for(;s.indexOf(e[n+o])>=0;)o++;if(o>0){t.push(i.join(""));for(let r=parseInt(e.substring(n,n+o),10);r>0;r--)i.pop();n+=o}else i.push(e[n]),n++}return t}var Vl={defaultProtocol:"http",events:null,format:P2,formatHref:P2,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function $m(e,t=null){let i=Object.assign({},Vl);e&&(i=Object.assign(i,e instanceof $m?e.o:e));let n=i.ignoreTags,s=[];for(let o=0;o<n.length;o++)s.push(n[o].toUpperCase());this.o=i,t&&(this.defaultRender=t),this.ignoreTags=s}$m.prototype={o:Vl,ignoreTags:[],defaultRender(e){return e},check(e){return this.get("validate",e.toString(),e)},get(e,t,i){let n=t!=null,s=this.o[e];return s&&(typeof s=="object"?(s=i.t in s?s[i.t]:Vl[e],typeof s=="function"&&n&&(s=s(t,i))):typeof s=="function"&&n&&(s=s(t,i.t,i)),s)},getObj(e,t,i){let n=this.o[e];return typeof n=="function"&&t!=null&&(n=n(t,i.t,i)),n},render(e){let t=e.render(this);return(this.get("render",null,e)||this.defaultRender)(t,e.t,e)}};function P2(e){return e}function H2(e,t){this.t="token",this.v=e,this.tk=t}H2.prototype={isLink:!1,toString(){return this.v},toHref(e){return this.toString()},toFormattedString(e){let t=this.toString(),i=e.get("truncate",t,this),n=e.get("format",t,this);return i&&n.length>i?n.substring(0,i)+"\u2026":n},toFormattedHref(e){return e.get("formatHref",this.toHref(e.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(e=Vl.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(e),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(e){return{type:this.t,value:this.toFormattedString(e),isLink:this.isLink,href:this.toFormattedHref(e),start:this.startIndex(),end:this.endIndex()}},validate(e){return e.get("validate",this.toString(),this)},render(e){let t=this,i=this.toHref(e.get("defaultProtocol")),n=e.get("formatHref",i,this),s=e.get("tagName",i,t),o=this.toFormattedString(e),r={},a=e.get("className",i,t),l=e.get("target",i,t),d=e.get("rel",i,t),c=e.getObj("attributes",i,t),u=e.getObj("events",i,t);return r.href=n,a&&(r.class=a),l&&(r.target=l),d&&(r.rel=d),c&&Object.assign(r,c),{tagName:s,attributes:r,content:o,eventListeners:u}}};function Nu(e,t){class i extends H2{constructor(s,o){super(s,o),this.t=e}}for(let n in t)i.prototype[n]=t[n];return i.t=e,i}var F2=Nu("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),T2=Nu("text"),x8=Nu("nl"),lu=Nu("url",{isLink:!0,toHref(e=Vl.defaultProtocol){return this.hasProtocol()?this.v:`${e}://${this.v}`},hasProtocol(){let e=this.tk;return e.length>=2&&e[0].t!==Hl&&e[1].t===zs}});var Vi=e=>new wi(e);function E8({groups:e}){let t=e.domain.concat([Eu,Mu,Gs,Du,ku,Pu,Fu,Tu,Gi,Vm,Ol,Au,Iu,_u,xn,Ou,Bl,Lu]),i=[Ru,zs,zm,Sn,Wm,Ol,Nl,Um,qm,gu,fu,_l,Ll,uu,cu,hu,pu,mu,Cu,vu,wu,bu,yu,Su,xu],n=[Eu,Ru,Mu,Du,ku,Pu,Fu,Tu,Gi,_l,Ll,Ol,Au,Iu,_u,Nl,xn,Ou,Bl,Lu],s=Vi(),o=V(s,Bl);Re(o,n,o),Re(o,e.domain,o);let r=Vi(),a=Vi(),l=Vi();Re(s,e.domain,r),Re(s,e.scheme,a),Re(s,e.slashscheme,l),Re(r,n,o),Re(r,e.domain,r);let d=V(r,Gs);V(o,Gs,d),V(a,Gs,d),V(l,Gs,d);let c=V(o,Sn);Re(c,n,o),Re(c,e.domain,o);let u=Vi();Re(d,e.domain,u),Re(u,e.domain,u);let h=V(u,Sn);Re(h,e.domain,u);let p=Vi(F2);Re(h,e.tld,p),Re(h,e.utld,p),V(d,Hl,p);let g=V(u,Gi);V(g,Gi,g),Re(g,e.domain,u),Re(p,e.domain,u),V(p,Sn,h),V(p,Gi,g);let f=V(p,zs);Re(f,e.numeric,F2);let m=V(r,Gi),C=V(r,Sn);V(m,Gi,m),Re(m,e.domain,r),Re(C,n,o),Re(C,e.domain,r);let v=Vi(lu);Re(C,e.tld,v),Re(C,e.utld,v),Re(v,e.domain,r),Re(v,n,o),V(v,Sn,C),V(v,Gi,m),V(v,Gs,d);let w=V(v,zs),y=Vi(lu);Re(w,e.numeric,y);let S=Vi(lu),x=Vi();Re(S,t,S),Re(S,i,x),Re(x,t,S),Re(x,i,x),V(v,xn,S),V(y,xn,S);let E=V(a,zs),T=V(l,zs),L=V(T,xn),N=V(L,xn);Re(a,e.domain,r),V(a,Sn,C),V(a,Gi,m),Re(l,e.domain,r),V(l,Sn,C),V(l,Gi,m),Re(E,e.domain,S),V(E,xn,S),V(E,Nl,S),Re(N,e.domain,S),Re(N,t,S),V(N,xn,S);let $=[[_l,Ll],[cu,uu],[hu,pu],[gu,fu],[mu,Cu],[vu,wu],[bu,yu],[Su,xu]];for(let G=0;G<$.length;G++){let[se,ve]=$[G],me=V(S,se);V(x,se,me),V(me,ve,S);let dt=Vi(lu);Re(me,t,dt);let xi=Vi();Re(me,i),Re(dt,t,dt),Re(dt,i,xi),Re(xi,t,dt),Re(xi,i,xi),V(dt,ve,S),V(xi,ve,S)}return V(s,Hl,v),V(s,Gm,x8),{start:s,tokens:N2}}function R8(e,t,i){let n=i.length,s=0,o=[],r=[];for(;s<n;){let a=e,l=null,d=null,c=0,u=null,h=-1;for(;s<n&&!(l=a.go(i[s].t));)r.push(i[s++]);for(;s<n&&(d=l||a.go(i[s].t));)l=null,a=d,a.accepts()?(h=0,u=a):h>=0&&h++,s++,c++;if(h<0)s-=c,s<n&&(r.push(i[s]),s++);else{r.length>0&&(o.push(Tm(T2,t,r)),r=[]),s-=h,c-=h;let p=u.t,g=i.slice(s-c,s);o.push(Tm(p,t,g))}}return r.length>0&&o.push(Tm(T2,t,r)),o}function Tm(e,t,i){let n=i[0].s,s=i[i.length-1].e,o=t.slice(n,s);return new e(o,i)}var M8=typeof console<"u"&&console&&console.warn||(()=>{}),D8="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",Ze={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function V2(){return wi.groups={},Ze.scanner=null,Ze.parser=null,Ze.tokenQueue=[],Ze.pluginQueue=[],Ze.customSchemes=[],Ze.initialized=!1,Ze}function jm(e,t=!1){if(Ze.initialized&&M8(`linkifyjs: already initialized - will not register custom scheme "${e}" ${D8}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(e))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);Ze.customSchemes.push([e,t])}function k8(){Ze.scanner=y8(Ze.customSchemes);for(let e=0;e<Ze.tokenQueue.length;e++)Ze.tokenQueue[e][1]({scanner:Ze.scanner});Ze.parser=E8(Ze.scanner.tokens);for(let e=0;e<Ze.pluginQueue.length;e++)Ze.pluginQueue[e][1]({scanner:Ze.scanner,parser:Ze.parser});return Ze.initialized=!0,Ze}function Bu(e){return Ze.initialized||k8(),R8(Ze.parser.start,e,B2(Ze.scanner.start,e))}Bu.scan=B2;function Hu(e,t=null,i=null){if(t&&typeof t=="object"){if(i)throw Error(`linkifyjs: Invalid link type ${t}; must be a string`);i=t,t=null}let n=new $m(i),s=Bu(e),o=[];for(let r=0;r<s.length;r++){let a=s[r];a.isLink&&(!t||a.t===t)&&n.check(a)&&o.push(a.toFormattedObject(n))}return o}var Km="[\0- \xA0\u1680\u180E\u2000-\u2029\u205F\u3000]",P8=new RegExp(Km),F8=new RegExp(`${Km}$`),T8=new RegExp(Km,"g");function A8(e){return e.length===1?e[0].isLink:e.length===3&&e[1].isLink?["()","[]"].includes(e[0].value+e[2].value):!1}function I8(e){return new fe({key:new Me("autolink"),appendTransaction:(t,i,n)=>{let s=t.some(d=>d.docChanged)&&!i.doc.eq(n.doc),o=t.some(d=>d.getMeta("preventAutolink"));if(!s||o)return;let{tr:r}=n,a=vm(i.doc,[...t]);if(Sm(a).forEach(({newRange:d})=>{let c=e2(n.doc,d,p=>p.isTextblock),u,h;if(c.length>1)u=c[0],h=n.doc.textBetween(u.pos,u.pos+u.node.nodeSize,void 0," ");else if(c.length){let p=n.doc.textBetween(d.from,d.to," "," ");if(!F8.test(p))return;u=c[0],h=n.doc.textBetween(u.pos,d.to,void 0," ")}if(u&&h){let p=h.split(P8).filter(Boolean);if(p.length<=0)return!1;let g=p[p.length-1],f=u.pos+h.lastIndexOf(g);if(!g)return!1;let m=Bu(g).map(C=>C.toObject(e.defaultProtocol));if(!A8(m))return!1;m.filter(C=>C.isLink).map(C=>O(b({},C),{from:f+C.start+1,to:f+C.end+1})).filter(C=>n.schema.marks.code?!n.doc.rangeHasMark(C.from,C.to,n.schema.marks.code):!0).filter(C=>e.validate(C.value)).filter(C=>e.shouldAutoLink(C.value)).forEach(C=>{iu(C.from,C.to,n.doc).some(v=>v.mark.type===e.type)||r.addMark(C.from,C.to,e.type.create({href:C.href}))})}}),!!r.steps.length)return r}})}function _8(e){return new fe({key:new Me("handleClickLink"),props:{handleClick:(t,i,n)=>{var s,o;if(n.button!==0||!t.editable)return!1;let r=null;if(n.target instanceof HTMLAnchorElement)r=n.target;else{let c=n.target,u=[];for(;c.nodeName!=="DIV";)u.push(c),c=c.parentNode;r=u.find(h=>h.nodeName==="A")}if(!r)return!1;let a=ym(t.state,e.type.name),l=(s=r?.href)!=null?s:a.href,d=(o=r?.target)!=null?o:a.target;return e.enableClickSelection&&e.editor.commands.extendMarkRange(e.type.name),r&&l?(window.open(l,d),!0):!1}}})}function L8(e){return new fe({key:new Me("handlePasteLink"),props:{handlePaste:(t,i,n)=>{let{shouldAutoLink:s}=e,{state:o}=t,{selection:r}=o,{empty:a}=r;if(a)return!1;let l="";n.content.forEach(c=>{l+=c.textContent});let d=Hu(l,{defaultProtocol:e.defaultProtocol}).find(c=>c.isLink&&c.value===l);return!l||!d||s!==void 0&&!s(d.href)?!1:e.editor.commands.setMark(e.type,{href:d.href})}}})}function zo(e,t){let i=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach(n=>{let s=typeof n=="string"?n:n.scheme;s&&i.push(s)}),!e||e.replace(T8,"").match(new RegExp(`^(?:(?:${i.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var Ym=Mi.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(e=>{if(typeof e=="string"){jm(e);return}jm(e.scheme,e.optionalSlashes)})},onDestroy(){V2()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(e,t)=>!!zo(e,t.protocols),validate:e=>!!e,shouldAutoLink:e=>!!e}},addAttributes(){return{href:{default:null,parseHTML(e){return e.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:e=>{let t=e.getAttribute("href");return!t||!this.options.isAllowedUri(t,{defaultValidate:i=>!!zo(i,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:e}){return this.options.isAllowedUri(e.href,{defaultValidate:t=>!!zo(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",Fe(this.options.HTMLAttributes,e),0]:["a",Fe(this.options.HTMLAttributes,O(b({},e),{href:""})),0]},markdownTokenName:"link",parseMarkdown:(e,t)=>t.applyMark("link",t.parseInline(e.tokens||[]),{href:e.href,title:e.title||null}),renderMarkdown:(e,t)=>{var i;let n=((i=e.attrs)==null?void 0:i.href)||"";return`[${t.renderChildren(e)}](${n})`},addCommands(){return{setLink:e=>({chain:t})=>{let{href:i}=e;return this.options.isAllowedUri(i,{defaultValidate:n=>!!zo(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?t().setMark(this.name,e).setMeta("preventAutolink",!0).run():!1},toggleLink:e=>({chain:t})=>{let{href:i}=e||{};return i&&!this.options.isAllowedUri(i,{defaultValidate:n=>!!zo(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:t().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[Hi({find:e=>{let t=[];if(e){let{protocols:i,defaultProtocol:n}=this.options,s=Hu(e).filter(o=>o.isLink&&this.options.isAllowedUri(o.value,{defaultValidate:r=>!!zo(r,i),protocols:i,defaultProtocol:n}));s.length&&s.forEach(o=>{this.options.shouldAutoLink(o.value)&&t.push({text:o.value,data:{href:o.href},index:o.start})})}return t},type:this.type,getAttributes:e=>{var t;return{href:(t=e.data)==null?void 0:t.href}}})]},addProseMirrorPlugins(){let e=[],{protocols:t,defaultProtocol:i}=this.options;return this.options.autolink&&e.push(I8({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:n=>this.options.isAllowedUri(n,{defaultValidate:s=>!!zo(s,t),protocols:t,defaultProtocol:i}),shouldAutoLink:this.options.shouldAutoLink})),this.options.openOnClick===!0&&e.push(_8({type:this.type,editor:this.editor,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&e.push(L8({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),e}}),G2=Ym;var ea=(e,t)=>{if(e==="slot")return 0;if(e instanceof Function)return e(t);let s=t??{},{children:i}=s,n=gi(s,["children"]);if(e==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[e,n,i]};var O8=/^\s*>\s$/,z2=Ye.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:e}){return ea("blockquote",O(b({},Fe(this.options.HTMLAttributes,e)),{children:ea("slot",{})}))},parseMarkdown:(e,t)=>t.createNode("blockquote",void 0,t.parseChildren(e.tokens||[])),renderMarkdown:(e,t)=>{if(!e.content)return"";let i=">",n=[];return e.content.forEach(s=>{let a=t.renderChildren([s]).split(`
`).map(l=>l.trim()===""?i:`${i} ${l}`);n.push(a.join(`
`))}),n.join(`
${i}
`)},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[yn({find:O8,type:this.type})]}});var N8=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,B8=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,H8=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,V8=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,W2=Mi.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>e.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return ea("strong",O(b({},Fe(this.options.HTMLAttributes,e)),{children:ea("slot",{})}))},markdownTokenName:"strong",parseMarkdown:(e,t)=>t.applyMark("bold",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`**${t.renderChildren(e)}**`,addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[bn({find:N8,type:this.type}),bn({find:H8,type:this.type})]},addPasteRules(){return[Hi({find:B8,type:this.type}),Hi({find:V8,type:this.type})]}});var G8=/(^|[^`])`([^`]+)`(?!`)$/,z8=/(^|[^`])`([^`]+)`(?!`)/g,U2=Mi.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:e}){return["code",Fe(this.options.HTMLAttributes,e),0]},markdownTokenName:"codespan",parseMarkdown:(e,t)=>t.applyMark("code",[{type:"text",text:e.text||""}]),renderMarkdown:(e,t)=>e.content?`\`${t.renderChildren(e.content)}\``:"",addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[bn({find:G8,type:this.type})]},addPasteRules(){return[Hi({find:z8,type:this.type})]}});var Xm=4,W8=/^```([a-z]+)?[\s\n]$/,U8=/^~~~([a-z]+)?[\s\n]$/,q2=Ye.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:Xm,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;let{languageClassPrefix:i}=this.options;if(!i)return null;let o=[...((t=e.firstElementChild)==null?void 0:t.classList)||[]].filter(r=>r.startsWith(i)).map(r=>r.replace(i,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:e,HTMLAttributes:t}){return["pre",Fe(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(e,t)=>{var i;return((i=e.raw)==null?void 0:i.startsWith("```"))===!1&&e.codeBlockStyle!=="indented"?[]:t.createNode("codeBlock",{language:e.lang||null},e.text?[t.createTextNode(e.text)]:[])},renderMarkdown:(e,t)=>{var i;let n="",s=((i=e.attrs)==null?void 0:i.language)||"";return e.content?n=[`\`\`\`${s}`,t.renderChildren(e.content),"```"].join(`
`):n=`\`\`\`${s}

\`\`\``,n},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{let{empty:e,$anchor:t}=this.editor.state.selection,i=t.pos===1;return!e||t.parent.type.name!==this.name?!1:i||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:e})=>{var t;if(!this.options.enableTabIndentation)return!1;let i=(t=this.options.tabSize)!=null?t:Xm,{state:n}=e,{selection:s}=n,{$from:o,empty:r}=s;if(o.parent.type!==this.type)return!1;let a=" ".repeat(i);return r?e.commands.insertContent(a):e.commands.command(({tr:l})=>{let{from:d,to:c}=s,p=n.doc.textBetween(d,c,`
`,`
`).split(`
`).map(g=>a+g).join(`
`);return l.replaceWith(d,c,n.schema.text(p)),!0})},"Shift-Tab":({editor:e})=>{var t;if(!this.options.enableTabIndentation)return!1;let i=(t=this.options.tabSize)!=null?t:Xm,{state:n}=e,{selection:s}=n,{$from:o,empty:r}=s;return o.parent.type!==this.type?!1:r?e.commands.command(({tr:a})=>{var l;let{pos:d}=o,c=o.start(),u=o.end(),p=n.doc.textBetween(c,u,`
`,`
`).split(`
`),g=0,f=0,m=d-c;for(let x=0;x<p.length;x+=1){if(f+p[x].length>=m){g=x;break}f+=p[x].length+1}let v=((l=p[g].match(/^ */))==null?void 0:l[0])||"",w=Math.min(v.length,i);if(w===0)return!0;let y=c;for(let x=0;x<g;x+=1)y+=p[x].length+1;return a.delete(y,y+w),d-y<=w&&a.setSelection(le.create(a.doc,y)),!0}):e.commands.command(({tr:a})=>{let{from:l,to:d}=s,h=n.doc.textBetween(l,d,`
`,`
`).split(`
`).map(p=>{var g;let f=((g=p.match(/^ */))==null?void 0:g[0])||"",m=Math.min(f.length,i);return p.slice(m)}).join(`
`);return a.replaceWith(l,d,n.schema.text(h)),!0})},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;let{state:t}=e,{selection:i}=t,{$from:n,empty:s}=i;if(!s||n.parent.type!==this.type)return!1;let o=n.parentOffset===n.parent.nodeSize-2,r=n.parent.textContent.endsWith(`

`);return!o||!r?!1:e.chain().command(({tr:a})=>(a.delete(n.pos-2,n.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;let{state:t}=e,{selection:i,doc:n}=t,{$from:s,empty:o}=i;if(!o||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;let a=s.after();return a===void 0?!1:n.nodeAt(a)?e.commands.command(({tr:d})=>(d.setSelection(ge.near(n.resolve(a))),!0)):e.commands.exitCode()}}},addInputRules(){return[Pl({find:W8,type:this.type,getAttributes:e=>({language:e[1]})}),Pl({find:U8,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new fe({key:new Me("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;let i=t.clipboardData.getData("text/plain"),n=t.clipboardData.getData("vscode-editor-data"),s=n?JSON.parse(n):void 0,o=s?.mode;if(!i||!o)return!1;let{tr:r,schema:a}=e.state,l=a.text(i.replace(/\r\n?/g,`
`));return r.replaceSelectionWith(this.type.create({language:o},l)),r.selection.$from.parent.type!==this.type&&r.setSelection(le.near(r.doc.resolve(Math.max(0,r.selection.from-2)))),r.setMeta("paste",!0),e.dispatch(r),!0}}})]}});var $2=Ye.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`

`):""});var j2=Ye.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:e}){return["br",Fe(this.options.HTMLAttributes,e)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:i,editor:n})=>e.first([()=>e.exitCode(),()=>e.command(()=>{let{selection:s,storedMarks:o}=i;if(s.$from.parent.type.spec.isolating)return!1;let{keepMarks:r}=this.options,{splittableMarks:a}=n.extensionManager,l=o||s.$to.parentOffset&&s.$from.marks();return t().insertContent({type:this.name}).command(({tr:d,dispatch:c})=>{if(c&&l&&r){let u=l.filter(h=>a.includes(h.type.name));d.ensureMarks(u)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}});var K2=Ye.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,Fe(this.options.HTMLAttributes,t),0]},parseMarkdown:(e,t)=>t.createNode("heading",{level:e.depth||1},t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>{var i;let n=(i=e.attrs)!=null&&i.level?parseInt(e.attrs.level,10):1,s="#".repeat(n);return e.content?`${s} ${t.renderChildren(e.content)}`:""},addCommands(){return{setHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.setNode(this.name,e):!1,toggleHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.toggleNode(this.name,"paragraph",e):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>O(b({},e),{[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>Pl({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}});var Y2=Ye.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:e}){return["hr",Fe(this.options.HTMLAttributes,e)]},markdownTokenName:"hr",parseMarkdown:(e,t)=>t.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{if(!E2(t,t.schema.nodes[this.name]))return!1;let{selection:i}=t,{$to:n}=i,s=e();return nu(i)?s.insertContentAt(n.pos,{type:this.name}):s.insertContent({type:this.name}),s.command(({state:o,tr:r,dispatch:a})=>{if(a){let{$to:l}=r.selection,d=l.end();if(l.nodeAfter)l.nodeAfter.isTextblock?r.setSelection(le.create(r.doc,l.pos+1)):l.nodeAfter.isBlock?r.setSelection(ne.create(r.doc,l.pos)):r.setSelection(le.create(r.doc,l.pos));else{let c=o.schema.nodes[this.options.nextNodeType]||l.parent.type.contentMatch.defaultType,u=c?.create();u&&(r.insert(d,u),r.setSelection(le.create(r.doc,d+1)))}r.scrollIntoView()}return!0}).run()}}},addInputRules(){return[x2({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}});var q8=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,$8=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,j8=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,K8=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,X2=Mi.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>e.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",Fe(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(e,t)=>t.applyMark("italic",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`*${t.renderChildren(e)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[bn({find:q8,type:this.type}),bn({find:j8,type:this.type})]},addPasteRules(){return[Hi({find:$8,type:this.type}),Hi({find:K8,type:this.type})]}});var Y8=Object.defineProperty,X8=(e,t)=>{for(var i in t)Y8(e,i,{get:t[i],enumerable:!0})},J8="listItem",J2="textStyle",Q2=/^\s*([-+*])\s$/,Zm=Ye.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:e}){return["ul",Fe(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:(e,t)=>e.type!=="list"||e.ordered?[]:{type:"bulletList",content:e.items?t.parseChildren(e.items):[]},renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(J8,this.editor.getAttributes(J2)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=yn({find:Q2,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=yn({find:Q2,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(J2),editor:this.editor})),[e]}}),e0=Ye.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",Fe(this.options.HTMLAttributes,e),0]},markdownTokenName:"list_item",parseMarkdown:(e,t)=>{if(e.type!=="list_item")return[];let i=[];if(e.tokens&&e.tokens.length>0)if(e.tokens.some(s=>s.type==="paragraph"))i=t.parseChildren(e.tokens);else{let s=e.tokens[0];if(s&&s.type==="text"&&s.tokens&&s.tokens.length>0){if(i=[{type:"paragraph",content:t.parseInline(s.tokens)}],e.tokens.length>1){let r=e.tokens.slice(1),a=t.parseChildren(r);i.push(...a)}}else i=t.parseChildren(e.tokens)}return i.length===0&&(i=[{type:"paragraph",content:[]}]),{type:"listItem",content:i}},renderMarkdown:(e,t,i)=>Fl(e,t,n=>n.parentType==="bulletList"?"- ":n.parentType==="orderedList"?`${n.index+1}. `:"- ",i),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Q8={};X8(Q8,{findListItemPos:()=>Gl,getNextListDepth:()=>t0,handleBackspace:()=>Jm,handleDelete:()=>Qm,hasListBefore:()=>i3,hasListItemAfter:()=>Z8,hasListItemBefore:()=>n3,listItemHasSubList:()=>s3,nextListIsDeeper:()=>o3,nextListIsHigher:()=>r3});var Gl=(e,t)=>{let{$from:i}=t.selection,n=ct(e,t.schema),s=null,o=i.depth,r=i.pos,a=null;for(;o>0&&a===null;)s=i.node(o),s.type===n?a=o:(o-=1,r-=1);return a===null?null:{$pos:t.doc.resolve(r),depth:a}},t0=(e,t)=>{let i=Gl(e,t);if(!i)return!1;let[,n]=o2(t,e,i.$pos.pos+4);return n},i3=(e,t,i)=>{let{$anchor:n}=e.selection,s=Math.max(0,n.pos-2),o=e.doc.resolve(s).node();return!(!o||!i.includes(o.type.name))},n3=(e,t)=>{var i;let{$anchor:n}=t.selection,s=t.doc.resolve(n.pos-2);return!(s.index()===0||((i=s.nodeBefore)==null?void 0:i.type.name)!==e)},s3=(e,t,i)=>{if(!i)return!1;let n=ct(e,t.schema),s=!1;return i.descendants(o=>{o.type===n&&(s=!0)}),s},Jm=(e,t,i)=>{if(e.commands.undoInputRule())return!0;if(e.state.selection.from!==e.state.selection.to)return!1;if(!wn(e.state,t)&&i3(e.state,t,i)){let{$anchor:a}=e.state.selection,l=e.state.doc.resolve(a.before()-1),d=[];l.node().descendants((h,p)=>{h.type.name===t&&d.push({node:h,pos:p})});let c=d.at(-1);if(!c)return!1;let u=e.state.doc.resolve(l.start()+c.pos+1);return e.chain().cut({from:a.start()-1,to:a.end()+1},u.end()).joinForward().run()}if(!wn(e.state,t)||!a2(e.state))return!1;let n=Gl(t,e.state);if(!n)return!1;let o=e.state.doc.resolve(n.$pos.pos-2).node(n.depth),r=s3(t,e.state,o);return n3(t,e.state)&&!r?e.commands.joinItemBackward():e.chain().liftListItem(t).run()},o3=(e,t)=>{let i=t0(e,t),n=Gl(e,t);return!n||!i?!1:i>n.depth},r3=(e,t)=>{let i=t0(e,t),n=Gl(e,t);return!n||!i?!1:i<n.depth},Qm=(e,t)=>{if(!wn(e.state,t)||!r2(e.state,t))return!1;let{selection:i}=e.state,{$from:n,$to:s}=i;return!i.empty&&n.sameParent(s)?!1:o3(t,e.state)?e.chain().focus(e.state.selection.from+4).lift(t).joinBackward().run():r3(t,e.state)?e.chain().joinForward().joinBackward().run():e.commands.joinItemForward()},Z8=(e,t)=>{var i;let{$anchor:n}=t.selection,s=t.doc.resolve(n.pos-n.parentOffset-2);return!(s.index()===s.parent.childCount-1||((i=s.nodeAfter)==null?void 0:i.type.name)!==e)},i0=Oe.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:i})=>{e.state.schema.nodes[i]!==void 0&&Qm(e,i)&&(t=!0)}),t},"Mod-Delete":({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:i})=>{e.state.schema.nodes[i]!==void 0&&Qm(e,i)&&(t=!0)}),t},Backspace:({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:i,wrapperNames:n})=>{e.state.schema.nodes[i]!==void 0&&Jm(e,i,n)&&(t=!0)}),t},"Mod-Backspace":({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:i,wrapperNames:n})=>{e.state.schema.nodes[i]!==void 0&&Jm(e,i,n)&&(t=!0)}),t}}}}),Z2=/^(\s*)(\d+)\.\s+(.*)$/,eA=/^\s/;function tA(e){let t=[],i=0,n=0;for(;i<e.length;){let s=e[i],o=s.match(Z2);if(!o)break;let[,r,a,l]=o,d=r.length,c=l,u=i+1,h=[s];for(;u<e.length;){let p=e[u];if(p.match(Z2))break;if(p.trim()==="")h.push(p),c+=`
`,u+=1;else if(p.match(eA))h.push(p),c+=`
${p.slice(d+2)}`,u+=1;else break}t.push({indent:d,number:parseInt(a,10),content:c.trim(),raw:h.join(`
`)}),n=u,i=u}return[t,n]}function a3(e,t,i){var n;let s=[],o=0;for(;o<e.length;){let r=e[o];if(r.indent===t){let a=r.content.split(`
`),l=((n=a[0])==null?void 0:n.trim())||"",d=[];l&&d.push({type:"paragraph",raw:l,tokens:i.inlineTokens(l)});let c=a.slice(1).join(`
`).trim();if(c){let p=i.blockTokens(c);d.push(...p)}let u=o+1,h=[];for(;u<e.length&&e[u].indent>t;)h.push(e[u]),u+=1;if(h.length>0){let p=Math.min(...h.map(f=>f.indent)),g=a3(h,p,i);d.push({type:"list",ordered:!0,start:h[0].number,items:g,raw:h.map(f=>f.raw).join(`
`)})}s.push({type:"list_item",raw:r.raw,tokens:d}),o=u}else o+=1}return s}function iA(e,t){return e.map(i=>{if(i.type!=="list_item")return t.parseChildren([i])[0];let n=[];return i.tokens&&i.tokens.length>0&&i.tokens.forEach(s=>{if(s.type==="paragraph"||s.type==="list"||s.type==="blockquote"||s.type==="code")n.push(...t.parseChildren([s]));else if(s.type==="text"&&s.tokens){let o=t.parseChildren([s]);n.push({type:"paragraph",content:o})}else{let o=t.parseChildren([s]);o.length>0&&n.push(...o)}}),{type:"listItem",content:n}})}var nA="listItem",e3="textStyle",t3=/^(\d+)\.\s$/,n0=Ye.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:null,parseHTML:e=>e.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:e}){let n=e,{start:t}=n,i=gi(n,["start"]);return t===1?["ol",Fe(this.options.HTMLAttributes,i),0]:["ol",Fe(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:(e,t)=>{if(e.type!=="list"||!e.ordered)return[];let i=e.start||1,n=e.items?iA(e.items,t):[];return i!==1?{type:"orderedList",attrs:{start:i},content:n}:{type:"orderedList",content:n}},renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:e=>{let t=e.match(/^(\s*)(\d+)\.\s+/),i=t?.index;return i!==void 0?i:-1},tokenize:(e,t,i)=>{var n;let s=e.split(`
`),[o,r]=tA(s);if(o.length===0)return;let a=a3(o,0,i);return a.length===0?void 0:{type:"list",ordered:!0,start:((n=o[0])==null?void 0:n.number)||1,items:a,raw:s.slice(0,r).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(nA,this.editor.getAttributes(e3)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=yn({find:t3,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,i)=>i.childCount+i.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=yn({find:t3,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>b({start:+t[1]},this.editor.getAttributes(e3)),joinPredicate:(t,i)=>i.childCount+i.attrs.start===+t[1],editor:this.editor})),[e]}}),sA=/^\s*(\[([( |x])?\])\s$/,oA=Ye.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:e=>{let t=e.getAttribute("data-checked");return t===""||t==="true"},renderHTML:e=>({"data-checked":e.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:e,HTMLAttributes:t}){return["li",Fe(this.options.HTMLAttributes,t,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:e.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(e,t)=>{let i=[];if(e.tokens&&e.tokens.length>0?i.push(t.createNode("paragraph",{},t.parseInline(e.tokens))):e.text?i.push(t.createNode("paragraph",{},[t.createNode("text",{text:e.text})])):i.push(t.createNode("paragraph",{},[])),e.nestedTokens&&e.nestedTokens.length>0){let n=t.parseChildren(e.nestedTokens);i.push(...n)}return t.createNode("taskItem",{checked:e.checked||!1},i)},renderMarkdown:(e,t)=>{var i;let s=`- [${(i=e.attrs)!=null&&i.checked?"x":" "}] `;return Fl(e,t,s)},addKeyboardShortcuts(){let e={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?O(b({},e),{Tab:()=>this.editor.commands.sinkListItem(this.name)}):e},addNodeView(){return({node:e,HTMLAttributes:t,getPos:i,editor:n})=>{let s=document.createElement("li"),o=document.createElement("label"),r=document.createElement("span"),a=document.createElement("input"),l=document.createElement("div"),d=c=>{var u,h;a.ariaLabel=((h=(u=this.options.a11y)==null?void 0:u.checkboxLabel)==null?void 0:h.call(u,c,a.checked))||`Task item checkbox for ${c.textContent||"empty task item"}`};return d(e),o.contentEditable="false",a.type="checkbox",a.addEventListener("mousedown",c=>c.preventDefault()),a.addEventListener("change",c=>{if(!n.isEditable&&!this.options.onReadOnlyChecked){a.checked=!a.checked;return}let{checked:u}=c.target;n.isEditable&&typeof i=="function"&&n.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:h})=>{let p=i();if(typeof p!="number")return!1;let g=h.doc.nodeAt(p);return h.setNodeMarkup(p,void 0,O(b({},g?.attrs),{checked:u})),!0}).run(),!n.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(e,u)||(a.checked=!a.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([c,u])=>{s.setAttribute(c,u)}),s.dataset.checked=e.attrs.checked,a.checked=e.attrs.checked,o.append(a,r),s.append(o,l),Object.entries(t).forEach(([c,u])=>{s.setAttribute(c,u)}),{dom:s,contentDOM:l,update:c=>c.type!==this.type?!1:(s.dataset.checked=c.attrs.checked,a.checked=c.attrs.checked,d(c),!0)}}},addInputRules(){return[yn({find:sA,type:this.type,getAttributes:e=>({checked:e[e.length-1]==="x"})})]}}),rA=Ye.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:e}){return["ul",Fe(this.options.HTMLAttributes,e,{"data-type":this.name}),0]},parseMarkdown:(e,t)=>t.createNode("taskList",{},t.parseChildren(e.items||[])),renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(e){var t;let i=(t=e.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:t.index;return i!==void 0?i:-1},tokenize(e,t,i){let n=o=>{let r=ou(o,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:a=>({indentLevel:a[1].length,mainContent:a[4],checked:a[3].toLowerCase()==="x"}),createToken:(a,l)=>({type:"taskItem",raw:"",mainContent:a.mainContent,indentLevel:a.indentLevel,checked:a.checked,text:a.mainContent,tokens:i.inlineTokens(a.mainContent),nestedTokens:l}),customNestedParser:n},i);return r?[{type:"taskList",raw:r.raw,items:r.items}]:i.blockTokens(o)},s=ou(e,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:o=>({indentLevel:o[1].length,mainContent:o[4],checked:o[3].toLowerCase()==="x"}),createToken:(o,r)=>({type:"taskItem",raw:"",mainContent:o.mainContent,indentLevel:o.indentLevel,checked:o.checked,text:o.mainContent,tokens:i.inlineTokens(o.mainContent),nestedTokens:r}),customNestedParser:n},i);if(s)return{type:"taskList",raw:s.raw,items:s.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:e})=>e.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}}),xle=Oe.create({name:"listKit",addExtensions(){let e=[];return this.options.bulletList!==!1&&e.push(Zm.configure(this.options.bulletList)),this.options.listItem!==!1&&e.push(e0.configure(this.options.listItem)),this.options.listKeymap!==!1&&e.push(i0.configure(this.options.listKeymap)),this.options.orderedList!==!1&&e.push(n0.configure(this.options.orderedList)),this.options.taskItem!==!1&&e.push(oA.configure(this.options.taskItem)),this.options.taskList!==!1&&e.push(rA.configure(this.options.taskList)),e}});var l3=Ye.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:e}){return["p",Fe(this.options.HTMLAttributes,e),0]},parseMarkdown:(e,t)=>{let i=e.tokens||[];return i.length===1&&i[0].type==="image"?t.parseChildren([i[0]]):t.createNode("paragraph",void 0,t.parseInline(i))},renderMarkdown:(e,t)=>!e||!Array.isArray(e.content)?"":t.renderChildren(e.content),addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}});var aA=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,lA=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,d3=Mi.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["s",Fe(this.options.HTMLAttributes,e),0]},markdownTokenName:"del",parseMarkdown:(e,t)=>t.applyMark("strike",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`~~${t.renderChildren(e)}~~`,addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[bn({find:aA,type:this.type})]},addPasteRules(){return[Hi({find:lA,type:this.type})]}});var c3=Ye.create({name:"text",group:"inline",parseMarkdown:e=>({type:"text",text:e.text||""}),renderMarkdown:e=>e.text||""});var u3=Mi.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["u",Fe(this.options.HTMLAttributes,e),0]},parseMarkdown(e,t){return t.applyMark(this.name||"underline",t.parseInline(e.tokens||[]))},renderMarkdown(e,t){return`++${t.renderChildren(e)}++`},markdownTokenizer:{name:"underline",level:"inline",start(e){return e.indexOf("++")},tokenize(e,t,i){let s=/^(\+\+)([\s\S]+?)(\+\+)/.exec(e);if(!s)return;let o=s[2].trim();return{type:"underline",raw:s[0],text:o,tokens:i.inlineTokens(o)}}},addCommands(){return{setUnderline:()=>({commands:e})=>e.setMark(this.name),toggleUnderline:()=>({commands:e})=>e.toggleMark(this.name),unsetUnderline:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});function h3(e={}){return new fe({view(t){return new s0(t,e)}})}var s0=class{constructor(t,i){var n;this.editorView=t,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(n=i.width)!==null&&n!==void 0?n:1,this.color=i.color===!1?void 0:i.color||"black",this.class=i.class,this.handlers=["dragover","dragend","drop","dragleave"].map(s=>{let o=r=>{this[s](r)};return t.dom.addEventListener(s,o),{name:s,handler:o}})}destroy(){this.handlers.forEach(({name:t,handler:i})=>this.editorView.dom.removeEventListener(t,i))}update(t,i){this.cursorPos!=null&&i.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(t){t!=this.cursorPos&&(this.cursorPos=t,t==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let t=this.editorView.state.doc.resolve(this.cursorPos),i=!t.parent.inlineContent,n,s=this.editorView.dom,o=s.getBoundingClientRect(),r=o.width/s.offsetWidth,a=o.height/s.offsetHeight;if(i){let u=t.nodeBefore,h=t.nodeAfter;if(u||h){let p=this.editorView.nodeDOM(this.cursorPos-(u?u.nodeSize:0));if(p){let g=p.getBoundingClientRect(),f=u?g.bottom:g.top;u&&h&&(f=(f+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let m=this.width/2*a;n={left:g.left,right:g.right,top:f-m,bottom:f+m}}}}if(!n){let u=this.editorView.coordsAtPos(this.cursorPos),h=this.width/2*r;n={left:u.left-h,right:u.left+h,top:u.top,bottom:u.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",i),this.element.classList.toggle("prosemirror-dropcursor-inline",!i);let d,c;if(!l||l==document.body&&getComputedStyle(l).position=="static")d=-pageXOffset,c=-pageYOffset;else{let u=l.getBoundingClientRect(),h=u.width/l.offsetWidth,p=u.height/l.offsetHeight;d=u.left-l.scrollLeft*h,c=u.top-l.scrollTop*p}this.element.style.left=(n.left-d)/r+"px",this.element.style.top=(n.top-c)/a+"px",this.element.style.width=(n.right-n.left)/r+"px",this.element.style.height=(n.bottom-n.top)/a+"px"}scheduleRemoval(t){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),t)}dragover(t){if(!this.editorView.editable)return;let i=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),n=i&&i.inside>=0&&this.editorView.state.doc.nodeAt(i.inside),s=n&&n.type.spec.disableDropCursor,o=typeof s=="function"?s(this.editorView,i,t):s;if(i&&!o){let r=i.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=Rc(this.editorView.state.doc,r,this.editorView.dragging.slice);a!=null&&(r=a)}this.setCursor(r),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(t){this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)}};var ni=class e extends ge{constructor(t){super(t,t)}map(t,i){let n=t.resolve(i.map(this.head));return e.valid(n)?new e(n):ge.near(n)}content(){return J.empty}eq(t){return t instanceof e&&t.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(t,i){if(typeof i.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new e(t.resolve(i.pos))}getBookmark(){return new o0(this.anchor)}static valid(t){let i=t.parent;if(i.isTextblock||!dA(t)||!cA(t))return!1;let n=i.type.spec.allowGapCursor;if(n!=null)return n;let s=i.contentMatchAt(t.index()).defaultType;return s&&s.isTextblock}static findGapCursorFrom(t,i,n=!1){e:for(;;){if(!n&&e.valid(t))return t;let s=t.pos,o=null;for(let r=t.depth;;r--){let a=t.node(r);if(i>0?t.indexAfter(r)<a.childCount:t.index(r)>0){o=a.child(i>0?t.indexAfter(r):t.index(r)-1);break}else if(r==0)return null;s+=i;let l=t.doc.resolve(s);if(e.valid(l))return l}for(;;){let r=i>0?o.firstChild:o.lastChild;if(!r){if(o.isAtom&&!o.isText&&!ne.isSelectable(o)){t=t.doc.resolve(s+o.nodeSize*i),n=!1;continue e}break}o=r,s+=i;let a=t.doc.resolve(s);if(e.valid(a))return a}return null}}};ni.prototype.visible=!1;ni.findFrom=ni.findGapCursorFrom;ge.jsonID("gapcursor",ni);var o0=class e{constructor(t){this.pos=t}map(t){return new e(t.map(this.pos))}resolve(t){let i=t.resolve(this.pos);return ni.valid(i)?new ni(i):ge.near(i)}};function p3(e){return e.isAtom||e.spec.isolating||e.spec.createGapCursor}function dA(e){for(let t=e.depth;t>=0;t--){let i=e.index(t),n=e.node(t);if(i==0){if(n.type.spec.isolating)return!0;continue}for(let s=n.child(i-1);;s=s.lastChild){if(s.childCount==0&&!s.inlineContent||p3(s.type))return!0;if(s.inlineContent)return!1}}return!0}function cA(e){for(let t=e.depth;t>=0;t--){let i=e.indexAfter(t),n=e.node(t);if(i==n.childCount){if(n.type.spec.isolating)return!0;continue}for(let s=n.child(i);;s=s.firstChild){if(s.childCount==0&&!s.inlineContent||p3(s.type))return!0;if(s.inlineContent)return!1}}return!0}function g3(){return new fe({props:{decorations:gA,createSelectionBetween(e,t,i){return t.pos==i.pos&&ni.valid(i)?new ni(i):null},handleClick:hA,handleKeyDown:uA,handleDOMEvents:{beforeinput:pA}}})}var uA=am({ArrowLeft:Vu("horiz",-1),ArrowRight:Vu("horiz",1),ArrowUp:Vu("vert",-1),ArrowDown:Vu("vert",1)});function Vu(e,t){let i=e=="vert"?t>0?"down":"up":t>0?"right":"left";return function(n,s,o){let r=n.selection,a=t>0?r.$to:r.$from,l=r.empty;if(r instanceof le){if(!o.endOfTextblock(i)||a.depth==0)return!1;l=!1,a=n.doc.resolve(t>0?a.after():a.before())}let d=ni.findGapCursorFrom(a,t,l);return d?(s&&s(n.tr.setSelection(new ni(d))),!0):!1}}function hA(e,t,i){if(!e||!e.editable)return!1;let n=e.state.doc.resolve(t);if(!ni.valid(n))return!1;let s=e.posAtCoords({left:i.clientX,top:i.clientY});return s&&s.inside>-1&&ne.isSelectable(e.state.doc.nodeAt(s.inside))?!1:(e.dispatch(e.state.tr.setSelection(new ni(n))),!0)}function pA(e,t){if(t.inputType!="insertCompositionText"||!(e.state.selection instanceof ni))return!1;let{$from:i}=e.state.selection,n=i.parent.contentMatchAt(i.index()).findWrapping(e.state.schema.nodes.text);if(!n)return!1;let s=B.empty;for(let r=n.length-1;r>=0;r--)s=B.from(n[r].createAndFill(null,s));let o=e.state.tr.replace(i.pos,i.pos,new J(s,0,0));return o.setSelection(le.near(o.doc.resolve(i.pos+1))),e.dispatch(o),!1}function gA(e){if(!(e.selection instanceof ni))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",gt.create(e.doc,[ii.widget(e.selection.head,t,{key:"gapcursor"})])}var Gu=200,Wt=function(){};Wt.prototype.append=function(t){return t.length?(t=Wt.from(t),!this.length&&t||t.length<Gu&&this.leafAppend(t)||this.length<Gu&&t.leafPrepend(this)||this.appendInner(t)):this};Wt.prototype.prepend=function(t){return t.length?Wt.from(t).append(this):this};Wt.prototype.appendInner=function(t){return new fA(this,t)};Wt.prototype.slice=function(t,i){return t===void 0&&(t=0),i===void 0&&(i=this.length),t>=i?Wt.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,i))};Wt.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)};Wt.prototype.forEach=function(t,i,n){i===void 0&&(i=0),n===void 0&&(n=this.length),i<=n?this.forEachInner(t,i,n,0):this.forEachInvertedInner(t,i,n,0)};Wt.prototype.map=function(t,i,n){i===void 0&&(i=0),n===void 0&&(n=this.length);var s=[];return this.forEach(function(o,r){return s.push(t(o,r))},i,n),s};Wt.from=function(t){return t instanceof Wt?t:t&&t.length?new f3(t):Wt.empty};var f3=(function(e){function t(n){e.call(this),this.values=n}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var i={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(s,o){return s==0&&o==this.length?this:new t(this.values.slice(s,o))},t.prototype.getInner=function(s){return this.values[s]},t.prototype.forEachInner=function(s,o,r,a){for(var l=o;l<r;l++)if(s(this.values[l],a+l)===!1)return!1},t.prototype.forEachInvertedInner=function(s,o,r,a){for(var l=o-1;l>=r;l--)if(s(this.values[l],a+l)===!1)return!1},t.prototype.leafAppend=function(s){if(this.length+s.length<=Gu)return new t(this.values.concat(s.flatten()))},t.prototype.leafPrepend=function(s){if(this.length+s.length<=Gu)return new t(s.flatten().concat(this.values))},i.length.get=function(){return this.values.length},i.depth.get=function(){return 0},Object.defineProperties(t.prototype,i),t})(Wt);Wt.empty=new f3([]);var fA=(function(e){function t(i,n){e.call(this),this.left=i,this.right=n,this.length=i.length+n.length,this.depth=Math.max(i.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(n){return n<this.left.length?this.left.get(n):this.right.get(n-this.left.length)},t.prototype.forEachInner=function(n,s,o,r){var a=this.left.length;if(s<a&&this.left.forEachInner(n,s,Math.min(o,a),r)===!1||o>a&&this.right.forEachInner(n,Math.max(s-a,0),Math.min(this.length,o)-a,r+a)===!1)return!1},t.prototype.forEachInvertedInner=function(n,s,o,r){var a=this.left.length;if(s>a&&this.right.forEachInvertedInner(n,s-a,Math.max(o,a)-a,r+a)===!1||o<a&&this.left.forEachInvertedInner(n,Math.min(s,a),o,r)===!1)return!1},t.prototype.sliceInner=function(n,s){if(n==0&&s==this.length)return this;var o=this.left.length;return s<=o?this.left.slice(n,s):n>=o?this.right.slice(n-o,s-o):this.left.slice(n,o).append(this.right.slice(0,s-o))},t.prototype.leafAppend=function(n){var s=this.right.leafAppend(n);if(s)return new t(this.left,s)},t.prototype.leafPrepend=function(n){var s=this.left.leafPrepend(n);if(s)return new t(s,this.right)},t.prototype.appendInner=function(n){return this.left.depth>=Math.max(this.right.depth,n.depth)+1?new t(this.left,new t(this.right,n)):new t(this,n)},t})(Wt),r0=Wt;var mA=500,Uo=class e{constructor(t,i){this.items=t,this.eventCount=i}popEvent(t,i){if(this.eventCount==0)return null;let n=this.items.length;for(;;n--)if(this.items.get(n-1).selection){--n;break}let s,o;i&&(s=this.remapping(n,this.items.length),o=s.maps.length);let r=t.tr,a,l,d=[],c=[];return this.items.forEach((u,h)=>{if(!u.step){s||(s=this.remapping(n,h+1),o=s.maps.length),o--,c.push(u);return}if(s){c.push(new En(u.map));let p=u.step.map(s.slice(o)),g;p&&r.maybeStep(p).doc&&(g=r.mapping.maps[r.mapping.maps.length-1],d.push(new En(g,void 0,void 0,d.length+c.length))),o--,g&&s.appendMap(g,o)}else r.maybeStep(u.step);if(u.selection)return a=s?u.selection.map(s.slice(o)):u.selection,l=new e(this.items.slice(0,n).append(c.reverse().concat(d)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:r,selection:a}}addTransform(t,i,n,s){let o=[],r=this.eventCount,a=this.items,l=!s&&a.length?a.get(a.length-1):null;for(let c=0;c<t.steps.length;c++){let u=t.steps[c].invert(t.docs[c]),h=new En(t.mapping.maps[c],u,i),p;(p=l&&l.merge(h))&&(h=p,c?o.pop():a=a.slice(0,a.length-1)),o.push(h),i&&(r++,i=void 0),s||(l=h)}let d=r-n.depth;return d>vA&&(a=CA(a,d),r-=d),new e(a.append(o),r)}remapping(t,i){let n=new pl;return this.items.forEach((s,o)=>{let r=s.mirrorOffset!=null&&o-s.mirrorOffset>=t?n.maps.length-s.mirrorOffset:void 0;n.appendMap(s.map,r)},t,i),n}addMaps(t){return this.eventCount==0?this:new e(this.items.append(t.map(i=>new En(i))),this.eventCount)}rebased(t,i){if(!this.eventCount)return this;let n=[],s=Math.max(0,this.items.length-i),o=t.mapping,r=t.steps.length,a=this.eventCount;this.items.forEach(h=>{h.selection&&a--},s);let l=i;this.items.forEach(h=>{let p=o.getMirror(--l);if(p==null)return;r=Math.min(r,p);let g=o.maps[p];if(h.step){let f=t.steps[p].invert(t.docs[p]),m=h.selection&&h.selection.map(o.slice(l+1,p));m&&a++,n.push(new En(g,f,m))}else n.push(new En(g))},s);let d=[];for(let h=i;h<r;h++)d.push(new En(o.maps[h]));let c=this.items.slice(0,s).append(d).append(n),u=new e(c,a);return u.emptyItemCount()>mA&&(u=u.compress(this.items.length-n.length)),u}emptyItemCount(){let t=0;return this.items.forEach(i=>{i.step||t++}),t}compress(t=this.items.length){let i=this.remapping(0,t),n=i.maps.length,s=[],o=0;return this.items.forEach((r,a)=>{if(a>=t)s.push(r),r.selection&&o++;else if(r.step){let l=r.step.map(i.slice(n)),d=l&&l.getMap();if(n--,d&&i.appendMap(d,n),l){let c=r.selection&&r.selection.map(i.slice(n));c&&o++;let u=new En(d.invert(),l,c),h,p=s.length-1;(h=s.length&&s[p].merge(u))?s[p]=h:s.push(u)}}else r.map&&n--},this.items.length,0),new e(r0.from(s.reverse()),o)}};Uo.empty=new Uo(r0.empty,0);function CA(e,t){let i;return e.forEach((n,s)=>{if(n.selection&&t--==0)return i=s,!1}),e.slice(i)}var En=class e{constructor(t,i,n,s){this.map=t,this.step=i,this.selection=n,this.mirrorOffset=s}merge(t){if(this.step&&t.step&&!t.selection){let i=t.step.merge(this.step);if(i)return new e(i.getMap().invert(),i,this.selection)}}},Rn=class{constructor(t,i,n,s,o){this.done=t,this.undone=i,this.prevRanges=n,this.prevTime=s,this.prevComposition=o}},vA=20;function wA(e,t,i,n){let s=i.getMeta(Wo),o;if(s)return s.historyState;i.getMeta(SA)&&(e=new Rn(e.done,e.undone,null,0,-1));let r=i.getMeta("appendedTransaction");if(i.steps.length==0)return e;if(r&&r.getMeta(Wo))return r.getMeta(Wo).redo?new Rn(e.done.addTransform(i,void 0,n,zu(t)),e.undone,m3(i.mapping.maps),e.prevTime,e.prevComposition):new Rn(e.done,e.undone.addTransform(i,void 0,n,zu(t)),null,e.prevTime,e.prevComposition);if(i.getMeta("addToHistory")!==!1&&!(r&&r.getMeta("addToHistory")===!1)){let a=i.getMeta("composition"),l=e.prevTime==0||!r&&e.prevComposition!=a&&(e.prevTime<(i.time||0)-n.newGroupDelay||!bA(i,e.prevRanges)),d=r?a0(e.prevRanges,i.mapping):m3(i.mapping.maps);return new Rn(e.done.addTransform(i,l?t.selection.getBookmark():void 0,n,zu(t)),Uo.empty,d,i.time,a??e.prevComposition)}else return(o=i.getMeta("rebased"))?new Rn(e.done.rebased(i,o),e.undone.rebased(i,o),a0(e.prevRanges,i.mapping),e.prevTime,e.prevComposition):new Rn(e.done.addMaps(i.mapping.maps),e.undone.addMaps(i.mapping.maps),a0(e.prevRanges,i.mapping),e.prevTime,e.prevComposition)}function bA(e,t){if(!t)return!1;if(!e.docChanged)return!0;let i=!1;return e.mapping.maps[0].forEach((n,s)=>{for(let o=0;o<t.length;o+=2)n<=t[o+1]&&s>=t[o]&&(i=!0)}),i}function m3(e){let t=[];for(let i=e.length-1;i>=0&&t.length==0;i--)e[i].forEach((n,s,o,r)=>t.push(o,r));return t}function a0(e,t){if(!e)return null;let i=[];for(let n=0;n<e.length;n+=2){let s=t.map(e[n],1),o=t.map(e[n+1],-1);s<=o&&i.push(s,o)}return i}function yA(e,t,i){let n=zu(t),s=Wo.get(t).spec.config,o=(i?e.undone:e.done).popEvent(t,n);if(!o)return null;let r=o.selection.resolve(o.transform.doc),a=(i?e.done:e.undone).addTransform(o.transform,t.selection.getBookmark(),s,n),l=new Rn(i?a:o.remaining,i?o.remaining:a,null,0,-1);return o.transform.setSelection(r).setMeta(Wo,{redo:i,historyState:l})}var l0=!1,C3=null;function zu(e){let t=e.plugins;if(C3!=t){l0=!1,C3=t;for(let i=0;i<t.length;i++)if(t[i].spec.historyPreserveItems){l0=!0;break}}return l0}var Wo=new Me("history"),SA=new Me("closeHistory");function v3(e={}){return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new fe({key:Wo,state:{init(){return new Rn(Uo.empty,Uo.empty,null,0,-1)},apply(t,i,n){return wA(i,n,t,e)}},config:e,props:{handleDOMEvents:{beforeinput(t,i){let n=i.inputType,s=n=="historyUndo"?d0:n=="historyRedo"?c0:null;return!s||!t.editable?!1:(i.preventDefault(),s(t.state,t.dispatch))}}}})}function Wu(e,t){return(i,n)=>{let s=Wo.getState(i);if(!s||(e?s.undone:s.done).eventCount==0)return!1;if(n){let o=yA(s,i,e);o&&n(t?o.scrollIntoView():o)}return!0}}var d0=Wu(!1,!0),c0=Wu(!0,!0),Xle=Wu(!1,!1),Jle=Wu(!0,!1);var nde=Oe.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:e=>e.length,wordCounter:e=>e.split(" ").filter(t=>t!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=e=>{let t=e?.node||this.editor.state.doc;if((e?.mode||this.options.mode)==="textSize"){let n=t.textBetween(0,t.content.size,void 0," ");return this.options.textCounter(n)}return t.nodeSize},this.storage.words=e=>{let t=e?.node||this.editor.state.doc,i=t.textBetween(0,t.content.size," "," ");return this.options.wordCounter(i)}},addProseMirrorPlugins(){let e=!1;return[new fe({key:new Me("characterCount"),appendTransaction:(t,i,n)=>{if(e)return;let s=this.options.limit;if(s==null||s===0){e=!0;return}let o=this.storage.characters({node:n.doc});if(o>s){let r=o-s,a=0,l=r;console.warn(`[CharacterCount] Initial content exceeded limit of ${s} characters. Content was automatically trimmed.`);let d=n.tr.deleteRange(a,l);return e=!0,d}e=!0},filterTransaction:(t,i)=>{let n=this.options.limit;if(!t.docChanged||n===0||n===null||n===void 0)return!0;let s=this.storage.characters({node:i.doc}),o=this.storage.characters({node:t.doc});if(o<=n||s>n&&o>n&&o<=s)return!0;if(s>n&&o>n&&o>s||!t.getMeta("paste"))return!1;let a=t.selection.$head.pos,l=o-n,d=a-l,c=a;return t.deleteRange(d,c),!(this.storage.characters({node:t.doc})>n)}})]}}),b3=Oe.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[h3(this.options)]}}),dde=Oe.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new fe({key:new Me("focus"),props:{decorations:({doc:e,selection:t})=>{let{isEditable:i,isFocused:n}=this.editor,{anchor:s}=t,o=[];if(!i||!n)return gt.create(e,[]);let r=0;this.options.mode==="deepest"&&e.descendants((l,d)=>{if(l.isText)return;if(!(s>=d&&s<=d+l.nodeSize-1))return!1;r+=1});let a=0;return e.descendants((l,d)=>{if(l.isText||!(s>=d&&s<=d+l.nodeSize-1))return!1;if(a+=1,this.options.mode==="deepest"&&r-a>0||this.options.mode==="shallowest"&&a>1)return this.options.mode==="deepest";o.push(ii.node(d,d+l.nodeSize,{class:this.options.className}))}),gt.create(e,o)}}})]}}),y3=Oe.create({name:"gapCursor",addProseMirrorPlugins(){return[g3()]},extendNodeSchema(e){var t;let i={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:(t=Ve(re(e,"allowGapCursor",i)))!=null?t:null}}}),fde=Oe.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something \u2026",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new fe({key:new Me("placeholder"),props:{decorations:({doc:e,selection:t})=>{let i=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:n}=t,s=[];if(!i)return null;let o=this.editor.isEmpty;return e.descendants((r,a)=>{let l=n>=a&&n<=a+r.nodeSize,d=!r.isLeaf&&kl(r);if((l||!this.options.showOnlyCurrent)&&d){let c=[this.options.emptyNodeClass];o&&c.push(this.options.emptyEditorClass);let u=ii.node(a,a+r.nodeSize,{class:c.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:r,pos:a,hasAnchor:l}):this.options.placeholder});s.push(u)}return this.options.includeChildren}),gt.create(e,s)}}})]}}),wde=Oe.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){let{editor:e,options:t}=this;return[new fe({key:new Me("selection"),props:{decorations(i){return i.selection.empty||e.isFocused||!e.isEditable||nu(i.selection)||e.view.dragging?null:gt.create(i.doc,[ii.inline(i.selection.from,i.selection.to,{class:t.className})])}}})]}});function w3({types:e,node:t}){return t&&Array.isArray(e)&&e.includes(t.type)||t?.type===e}var S3=Oe.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var e;let t=new Me(this.name),i=((e=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:e.name)||this.options.node||"paragraph",n=Object.entries(this.editor.schema.nodes).map(([,s])=>s).filter(s=>(this.options.notAfter||[]).concat(i).includes(s.name));return[new fe({key:t,appendTransaction:(s,o,r)=>{let{doc:a,tr:l,schema:d}=r,c=t.getState(r),u=a.content.size,h=d.nodes[i];if(c)return l.insert(u,h.create())},state:{init:(s,o)=>{let r=o.tr.doc.lastChild;return!w3({node:r,types:n})},apply:(s,o)=>{if(!s.docChanged||s.getMeta("__uniqueIDTransaction"))return o;let r=s.doc.lastChild;return!w3({node:r,types:n})}}})]}}),x3=Oe.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:e,dispatch:t})=>d0(e,t),redo:()=>({state:e,dispatch:t})=>c0(e,t)}},addProseMirrorPlugins(){return[v3(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-\u044F":()=>this.editor.commands.undo(),"Shift-Mod-\u044F":()=>this.editor.commands.redo()}}});var xA=Oe.create({name:"starterKit",addExtensions(){var e,t,i,n;let s=[];return this.options.bold!==!1&&s.push(W2.configure(this.options.bold)),this.options.blockquote!==!1&&s.push(z2.configure(this.options.blockquote)),this.options.bulletList!==!1&&s.push(Zm.configure(this.options.bulletList)),this.options.code!==!1&&s.push(U2.configure(this.options.code)),this.options.codeBlock!==!1&&s.push(q2.configure(this.options.codeBlock)),this.options.document!==!1&&s.push($2.configure(this.options.document)),this.options.dropcursor!==!1&&s.push(b3.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&s.push(y3.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&s.push(j2.configure(this.options.hardBreak)),this.options.heading!==!1&&s.push(K2.configure(this.options.heading)),this.options.undoRedo!==!1&&s.push(x3.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&s.push(Y2.configure(this.options.horizontalRule)),this.options.italic!==!1&&s.push(X2.configure(this.options.italic)),this.options.listItem!==!1&&s.push(e0.configure(this.options.listItem)),this.options.listKeymap!==!1&&s.push(i0.configure((e=this.options)==null?void 0:e.listKeymap)),this.options.link!==!1&&s.push(Ym.configure((t=this.options)==null?void 0:t.link)),this.options.orderedList!==!1&&s.push(n0.configure(this.options.orderedList)),this.options.paragraph!==!1&&s.push(l3.configure(this.options.paragraph)),this.options.strike!==!1&&s.push(d3.configure(this.options.strike)),this.options.text!==!1&&s.push(c3.configure(this.options.text)),this.options.underline!==!1&&s.push(u3.configure((i=this.options)==null?void 0:i.underline)),this.options.trailingNode!==!1&&s.push(S3.configure((n=this.options)==null?void 0:n.trailingNode)),s}}),E3=xA;var R3=(()=>{class e{elRef=z(yt);renderer=z(mr);changeDetectorRef=z(xr);editor=H.required();outputFormat=H("html");onChange=()=>{};onTouched=()=>{};writeValue(i){this.editor().chain().setContent(i,{emitUpdate:!1}).run()}registerOnChange(i){this.onChange=i}registerOnTouched(i){this.onTouched=i}setDisabledState(i){this.editor().setEditable(!i),this.renderer.setProperty(this.elRef.nativeElement,"disabled",i)}handleChange=({editor:i,transaction:n})=>{if(n.docChanged){if(this.changeDetectorRef.markForCheck(),this.outputFormat()==="html"){this.onChange(i.getHTML());return}this.onChange(i.getJSON())}};ngOnInit(){let i=this.editor(),{innerHTML:n}=this.elRef.nativeElement;this.elRef.nativeElement.innerHTML="",this.elRef.nativeElement.append(...Array.from(i.options.element?.childNodes||[])),i.setOptions({element:this.elRef.nativeElement}),n&&i.chain().setContent(n,{emitUpdate:!1}).run(),i.on("blur",()=>{this.onTouched()}),i.on("update",this.handleChange),i.on("selectionUpdate",()=>this.changeDetectorRef.markForCheck())}ngAfterViewInit(){this.changeDetectorRef.detectChanges()}static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["tiptap","editor",""],["","tiptap","","editor",""],["tiptap-editor","editor",""],["","tiptapEditor","","editor",""]],inputs:{editor:[1,"editor"],outputFormat:[1,"outputFormat"]},features:[Ie([{provide:Yw,useExisting:Wn(()=>e),multi:!0}])]})}return e})();var M3=(()=>{class e{initialContent=H("");minHeight=H("300px");contentChange=de();editor=new S2({extensions:[E3.configure({heading:{levels:[1,2,3]}}),G2.configure({openOnClick:!1,HTMLAttributes:{class:"text-blue-600 underline hover:text-blue-800"}})],editorProps:{attributes:{class:`prose prose-sm sm:prose lg:prose-lg xl:prose-xl focus:outline-none min-h-[${this.minHeight()}] max-w-none p-4`}},content:this.initialContent()||"<p>Start typing...</p>",onUpdate:({editor:i})=>{this.contentChange.emit(i.getHTML())}});isBold(){return this.editor?.isActive("bold")??!1}isItalic(){return this.editor?.isActive("italic")??!1}isStrike(){return this.editor?.isActive("strike")??!1}isCode(){return this.editor?.isActive("code")??!1}isH1(){return this.editor?.isActive("heading",{level:1})??!1}isH2(){return this.editor?.isActive("heading",{level:2})??!1}isBulletList(){return this.editor?.isActive("bulletList")??!1}isOrderedList(){return this.editor?.isActive("orderedList")??!1}isBlockquote(){return this.editor?.isActive("blockquote")??!1}toggleBold(){this.editor?.chain().focus().toggleBold().run()}toggleItalic(){this.editor?.chain().focus().toggleItalic().run()}toggleStrike(){this.editor?.chain().focus().toggleStrike().run()}toggleCode(){this.editor?.chain().focus().toggleCode().run()}toggleH1(){this.editor?.chain().focus().toggleHeading({level:1}).run()}toggleH2(){this.editor?.chain().focus().toggleHeading({level:2}).run()}toggleBulletList(){this.editor?.chain().focus().toggleBulletList().run()}toggleOrderedList(){this.editor?.chain().focus().toggleOrderedList().run()}toggleBlockquote(){this.editor?.chain().focus().toggleBlockquote().run()}setLink(){let i=window.prompt("Enter URL:");i&&this.editor?.chain().focus().setLink({href:i}).run()}undo(){this.editor?.chain().focus().undo().run()}redo(){this.editor?.chain().focus().redo().run()}getHTML(){return this.editor?.getHTML()}getJSON(){return this.editor?.getJSON()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=be({type:e,selectors:[["gh-tiptap-editor"]],inputs:{initialContent:[1,"initialContent"],minHeight:[1,"minHeight"]},outputs:{contentChange:"contentChange"},features:[Ie([Lt({lucideBold:s1,lucideItalic:p1,lucideStrikethrough:M1,lucideCode:a1,lucideHeading1:c1,lucideHeading2:u1,lucideList:m1,lucideListOrdered:f1,lucideQuote:y1,lucideUndo:D1,lucideRedo:S1,lucideLink:g1})])],decls:31,vars:19,consts:[[1,"border","rounded-t-md","p-2","bg-muted/30","flex","flex-wrap","gap-1","items-center"],["hlmBtn","","variant","ghost","size","icon","title","Bold (Ctrl+B)",3,"click"],["hlm","","name","lucideBold","size","sm"],["hlmBtn","","variant","ghost","size","icon","title","Italic (Ctrl+I)",3,"click"],["hlm","","name","lucideItalic","size","sm"],["hlmBtn","","variant","ghost","size","icon","title","Strikethrough",3,"click"],["hlm","","name","lucideStrikethrough","size","sm"],["hlmBtn","","variant","ghost","size","icon","title","Code",3,"click"],["hlm","","name","lucideCode","size","sm"],["hlmSeparator","","orientation","vertical",1,"h-6","mx-1"],["hlmBtn","","variant","ghost","size","icon","title","Heading 1",3,"click"],["hlm","","name","lucideHeading1","size","sm"],["hlmBtn","","variant","ghost","size","icon","title","Heading 2",3,"click"],["hlm","","name","lucideHeading2","size","sm"],["hlmBtn","","variant","ghost","size","icon","title","Bullet List",3,"click"],["hlm","","name","lucideList","size","sm"],["hlmBtn","","variant","ghost","size","icon","title","Numbered List",3,"click"],["hlm","","name","lucideListOrdered","size","sm"],["hlmBtn","","variant","ghost","size","icon","title","Blockquote",3,"click"],["hlm","","name","lucideQuote","size","sm"],["hlmBtn","","variant","ghost","size","icon","title","Add Link",3,"click"],["hlm","","name","lucideLink","size","sm"],["hlmBtn","","variant","ghost","size","icon","title","Undo (Ctrl+Z)",3,"click"],["hlm","","name","lucideUndo","size","sm"],["hlmBtn","","variant","ghost","size","icon","title","Redo (Ctrl+Shift+Z)",3,"click"],["hlm","","name","lucideRedo","size","sm"],[1,"border","border-t-0","rounded-b-md","bg-background"],[1,"block",3,"editor"]],template:function(n,s){n&1&&(M(0,"div",0)(1,"button",1),Q("click",function(){return s.toggleBold()}),ee(2,"ng-icon",2),R(),M(3,"button",3),Q("click",function(){return s.toggleItalic()}),ee(4,"ng-icon",4),R(),M(5,"button",5),Q("click",function(){return s.toggleStrike()}),ee(6,"ng-icon",6),R(),M(7,"button",7),Q("click",function(){return s.toggleCode()}),ee(8,"ng-icon",8),R(),ee(9,"div",9),M(10,"button",10),Q("click",function(){return s.toggleH1()}),ee(11,"ng-icon",11),R(),M(12,"button",12),Q("click",function(){return s.toggleH2()}),ee(13,"ng-icon",13),R(),ee(14,"div",9),M(15,"button",14),Q("click",function(){return s.toggleBulletList()}),ee(16,"ng-icon",15),R(),M(17,"button",16),Q("click",function(){return s.toggleOrderedList()}),ee(18,"ng-icon",17),R(),ee(19,"div",9),M(20,"button",18),Q("click",function(){return s.toggleBlockquote()}),ee(21,"ng-icon",19),R(),M(22,"button",20),Q("click",function(){return s.setLink()}),ee(23,"ng-icon",21),R(),ee(24,"div",9),M(25,"button",22),Q("click",function(){return s.undo()}),ee(26,"ng-icon",23),R(),M(27,"button",24),Q("click",function(){return s.redo()}),ee(28,"ng-icon",25),R()(),M(29,"div",26),ee(30,"tiptap-editor",27),R()),n&2&&(P(),Vt("bg-accent",s.isBold()),P(2),Vt("bg-accent",s.isItalic()),P(2),Vt("bg-accent",s.isStrike()),P(2),Vt("bg-accent",s.isCode()),P(3),Vt("bg-accent",s.isH1()),P(2),Vt("bg-accent",s.isH2()),P(3),Vt("bg-accent",s.isBulletList()),P(2),Vt("bg-accent",s.isOrderedList()),P(3),Vt("bg-accent",s.isBlockquote()),P(10),Ce("editor",s.editor))},dependencies:[Jt,it,xt,gc,R3],encapsulation:2,changeDetection:0})}return e})();var EA=()=>["image/*","application/pdf",".doc",".docx",".xls",".xlsx"],k3=(()=>{class e{initialEditorContent='<h1>Welcome to Tiptap Editor!</h1><p>This is a basic example with <strong>bold</strong>, <em>italic</em>, and <a href="https://tiptap.dev">links</a>.</p><h2>Features:</h2><ul><li>Text formatting (bold, italic, strike)</li><li>Headings (H1, H2)</li><li>Lists (ordered & unordered)</li><li>Blockquotes</li><li>Code blocks</li><li>Links</li></ul>';onEditorContentChange(i){console.log("Editor content changed:",i)}onUploadComplete(i){console.log("Files uploaded successfully:",i)}onUploadError(i){console.error("Upload error:",i)}onFilesAdded(i){console.log(`${i} files added to upload queue`)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=be({type:e,selectors:[["gh-home-dashboard"]],decls:72,vars:47,consts:[[1,"p-4","md:p-6","space-y-4"],[1,"flex","items-center","justify-between"],[1,"text-2xl","md:text-3xl","font-bold"],[1,"grid","gap-4","md:grid-cols-2","lg:grid-cols-3"],["hlmCard",""],["hlmCardHeader",""],["hlmCardTitle",""],["hlmCardDescription",""],["hlmCardContent",""],[1,"text-2xl","font-semibold"],["hlmBtn","","variant","outline","size","sm"],[1,"h-96","border","rounded-md","p-4","flex","items-center","justify-center","text-muted-foreground"],[3,"uploadComplete","uploadError","filesAdded","maxFileSize","maxNumberOfFiles","allowedFileTypes"],[3,"contentChange","initialContent"]],template:function(n,s){n&1&&(M(0,"div",0)(1,"div",1)(2,"h1",2),_(3),Y(4,"transloco"),R()(),M(5,"div",3)(6,"div",4)(7,"div",5)(8,"h3",6),_(9),Y(10,"transloco"),R(),M(11,"p",7),_(12),Y(13,"transloco"),R()(),M(14,"div",8)(15,"p",9),_(16,"0"),R()()(),M(17,"div",4)(18,"div",5)(19,"h3",6),_(20),Y(21,"transloco"),R(),M(22,"p",7),_(23),Y(24,"transloco"),R()(),M(25,"div",8)(26,"p",9),_(27,"0"),R()()(),M(28,"div",4)(29,"div",5)(30,"h3",6),_(31),Y(32,"transloco"),R(),M(33,"p",7),_(34),Y(35,"transloco"),R()(),M(36,"div",8)(37,"p",9),_(38,"0"),R()()()(),M(39,"div",4)(40,"div",5)(41,"div",1)(42,"h3",6),_(43),Y(44,"transloco"),R(),M(45,"button",10),_(46),Y(47,"transloco"),R()()(),M(48,"div",8)(49,"div",11),_(50),Y(51,"transloco"),R()()(),M(52,"div",4)(53,"div",5)(54,"h3",6),_(55),Y(56,"transloco"),R(),M(57,"p",7),_(58),Y(59,"transloco"),R()(),M(60,"div",8)(61,"gh-file-upload",12),Q("uploadComplete",function(r){return s.onUploadComplete(r)})("uploadError",function(r){return s.onUploadError(r)})("filesAdded",function(r){return s.onFilesAdded(r)}),R()()(),M(62,"div",4)(63,"div",5)(64,"h3",6),_(65),Y(66,"transloco"),R(),M(67,"p",7),_(68),Y(69,"transloco"),R()(),M(70,"div",8)(71,"gh-tiptap-editor",13),Q("contentChange",function(r){return s.onEditorContentChange(r)}),R()()()()),n&2&&(P(3),xe(" ",X(4,18,"homeDocumentation.title")," "),P(6),Ee(X(10,20,"homeDocumentation.overview")),P(3),Ee(X(13,22,"homeDocumentation.overviewDesc")),P(8),Ee(X(21,24,"homeDocumentation.items")),P(3),Ee(X(24,26,"homeDocumentation.itemsDesc")),P(8),Ee(X(32,28,"homeDocumentation.categories")),P(3),Ee(X(35,30,"homeDocumentation.categoriesDesc")),P(9),Ee(X(44,32,"homeDocumentation.dataGrid")),P(3),xe(" ",X(47,34,"common.add")," "),P(4),xe(" ",X(51,36,"homeDocumentation.gridPlaceholder")," "),P(5),Ee(X(56,38,"homeDocumentation.fileUpload")),P(3),Ee(X(59,40,"homeDocumentation.fileUploadDesc")),P(3),Ce("maxFileSize",10485760)("maxNumberOfFiles",10)("allowedFileTypes",ec(46,EA)),P(4),Ee(X(66,42,"homeDocumentation.editor")),P(3),Ee(X(69,44,"homeDocumentation.editorDesc")),P(3),Ce("initialContent",s.initialEditorContent))},dependencies:[gn,Pr,Ar,Ir,Tr,Fr,Jt,fn,M3,sb,As],encapsulation:2,changeDetection:0})}return e})();var YE=fr(KE(),1),XE=fr(nd(),1),gC=fr(oh(),1),pC=fr(Dt(),1),JE=fr(X0(),1),QE=fr(F0(),1);var ZE=["*"];function fC(e){let t=e.getLayer()||e.getStage();t&&t.batchDraw()}function eR(e,t={},i={}){"id"in t&&console.warn('ng2-konva: You are using "id" attribute for Konva node. In some very rare cases it may produce bugs. Currently we recommend not to use it and use "name" attribute instead.');let n=e.getStage(),s={},o=!1;if(Object.keys(i).forEach(r=>{let a=r.slice(0,2)==="on",l=i[r]!==t[r];if(a&&l){let c=r.slice(2).toLowerCase();c.slice(0,7)==="content"&&(c="content"+c.slice(7,8).toUpperCase()+c.slice(8)),n.off(c,i[r])}!Object.hasOwn(t,r)&&n.setAttr(r,void 0)}),Object.keys(t).forEach(r=>{let a=r.slice(0,2)==="on",l=i[r]!==t[r];if(a&&l){let d=r.slice(2).toLowerCase();d.slice(0,7)==="content"&&(d="content"+d.slice(7,8).toUpperCase()+d.slice(8)),t[r]&&(n.off(d),n.on(d,c=>{t[r]({angularComponent:e,event:c})}))}!a&&(t[r]!==i[r]||t[r]!==n.getAttr(r))&&(o=!0,s[r]=t[r])}),o){n.setAttrs(s),fC(n);let r;Object.keys(s).forEach(a=>{if(r=s[a],r instanceof Image&&!r.complete){let l=n;r.addEventListener("load",function(){let d=l.getLayer();d&&d.batchDraw()})}})}}function E9(e){return e.replace(/^\w|[A-Z]|\b\w/g,function(t,i){return i==0?t.toLowerCase():t.toUpperCase()}).replace(/\s+/g,"")}function R9(e){return e.charAt(0).toUpperCase()+e.slice(1)}function M9(e){return R9(E9(e.slice(3).replace("-"," ")))}function tR(e){let t={};return["mouseover","mousemove","mouseout","mouseenter","mouseleave","mousedown","mouseup","wheel","contextmenu","click","dblclick","touchstart","touchmove","touchend","tap","dbltap","dragstart","dragmove","dragend","transformstart","transform","transformend"].forEach(i=>{let s=e[i];s.listeners?.length>0&&(t["on"+i]=s.emit.bind(s))}),t}var rp=(()=>{class e{shapes=Sr(e);config=Qa();#e=qe(()=>{let i=this.config();i&&this.uploadKonva(i)});mouseover=de();mousemove=de();mouseout=de();mouseenter=de();mouseleave=de();mousedown=de();mouseup=de();wheel=de();contextmenu=de();click=de();dblclick=de();touchstart=de();touchmove=de();touchend=de();tap=de();dbltap=de();dragstart=de();dragmove=de();dragend=de();transformstart=de();transform=de();transformend=de();nameNode=M9(z(yt).nativeElement.localName);cacheProps={};_stage;getStage(){return this._stage}getNode(){return this._stage}getConfig(){return this.config()||{}}constructor(){this.initKonva()}initKonva(){this._stage||(this._stage=new pC.Shape),this.nameNode==="Shape"?this._stage=new pC.Shape:this.nameNode==="Sprite"?this._stage=new JE.Sprite(this.config()):this._stage=new YE.default[this.nameNode](void 0);let i=this._stage.to.bind(this._stage);this._stage.to=s=>{i(s),setTimeout(()=>{Object.keys(this._stage.attrs).forEach(o=>{typeof this._stage.attrs[o]!="function"&&this.config()&&this.config.update(r=>O(b({},r),{[o]:this._stage.attrs[o]}))})},200)};let n=this.config();n&&this.uploadKonva(n)}uploadKonva(i){if(!this._stage)return;let n=b(b({},i),tR(this));eR(this,n,this.cacheProps),this.cacheProps=n}#t=qe(()=>{this.shapes().forEach((i,n)=>{this!==i&&((this._stage instanceof XE.Group||this._stage instanceof gC.Layer)&&this._stage.add(i.getStage()),i.getStage().zIndex(n),fC(this._stage))})});ngOnDestroy(){this._stage.destroy()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=be({type:e,selectors:[["ko-shape"],["ko-layer"],["ko-circle"],["ko-fastlayer"],["ko-group"],["ko-label"],["ko-rect"],["ko-ellipse"],["ko-wedge"],["ko-line"],["ko-sprite"],["ko-image"],["ko-text"],["ko-text-path"],["ko-star"],["ko-ring"],["ko-arc"],["ko-tag"],["ko-path"],["ko-regular-polygon"],["ko-arrow"],["ko-transformer"]],contentQueries:function(n,s,o){n&1&&mi(o,s.shapes,e,4),n&2&&Ei()},inputs:{config:[1,"config"]},outputs:{config:"configChange",mouseover:"mouseover",mousemove:"mousemove",mouseout:"mouseout",mouseenter:"mouseenter",mouseleave:"mouseleave",mousedown:"mousedown",mouseup:"mouseup",wheel:"wheel",contextmenu:"contextmenu",click:"click",dblclick:"dblclick",touchstart:"touchstart",touchmove:"touchmove",touchend:"touchend",tap:"tap",dbltap:"dbltap",dragstart:"dragstart",dragmove:"dragmove",dragend:"dragend",transformstart:"transformstart",transform:"transform",transformend:"transformend"},ngContentSelectors:ZE,decls:2,vars:0,template:function(n,s){n&1&&(_t(),yg(0,"div"),Qe(1),Sg())},encapsulation:2})}return e})(),iR=(()=>{class e{nodeContainer=z(yt).nativeElement;shapes=Sr(rp);config=H();#e=qe(()=>{let i=this.config();i&&(this._stage?this.uploadKonva(i):(this._stage=new QE.Stage(O(b({},i),{container:this.nodeContainer})),this.uploadKonva(i)))});mouseover=de();mousemove=de();mouseout=de();mouseenter=de();mouseleave=de();mousedown=de();mouseup=de();wheel=de();contextmenu=de();click=de();dblclick=de();touchstart=de();touchmove=de();touchend=de();tap=de();dbltap=de();dragstart=de();dragmove=de();dragend=de();transformstart=de();transform=de();transformend=de();_stage;cacheProps={};getStage(){return this._stage}getNode(){return this._stage}getConfig(){return this.config()||{}}uploadKonva(i){let n=b(b({},i),tR(this));eR(this,n,this.cacheProps),this.cacheProps=n}#t=qe(()=>{this.shapes().forEach((i,n)=>{if(!(i.getStage()instanceof gC.Layer))throw"You can only add Layer Nodes to Stage Nodes!";this._stage.add(i.getStage()),i.getStage().zIndex(n),fC(this._stage)})});ngOnDestroy(){this._stage.destroy()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=be({type:e,selectors:[["ko-stage"]],contentQueries:function(n,s,o){n&1&&mi(o,s.shapes,rp,4),n&2&&Ei()},inputs:{config:[1,"config"]},outputs:{mouseover:"mouseover",mousemove:"mousemove",mouseout:"mouseout",mouseenter:"mouseenter",mouseleave:"mouseleave",mousedown:"mousedown",mouseup:"mouseup",wheel:"wheel",contextmenu:"contextmenu",click:"click",dblclick:"dblclick",touchstart:"touchstart",touchmove:"touchmove",touchend:"touchend",tap:"tap",dbltap:"dbltap",dragstart:"dragstart",dragmove:"dragmove",dragend:"dragend",transformstart:"transformstart",transform:"transform",transformend:"transformend"},ngContentSelectors:ZE,decls:2,vars:0,template:function(n,s){n&1&&(_t(),yg(0,"div"),Qe(1),Sg())},encapsulation:2})}return e})();var Qs=class{supabaseGlobal=z(pc);authService=z(X1);supabase=this.supabaseGlobal.supabase;loadingCount=Se(0);loading=W(()=>this.loadingCount()>0);plans=So({loader:async()=>{let{data:t,error:i}=await this.supabase.from("house_plans").select("*").order("created_at",{ascending:!1});if(i)throw i;return t||[]}});planIdSignal=Se(null);currentPlan=So({params:()=>({planId:this.planIdSignal()}),loader:async({params:t})=>{if(!t.planId)return null;let{data:i,error:n}=await this.supabase.from("house_plans").select("*").eq("id",t.planId).single();if(n)throw n;return i}});loadPlan(t){this.planIdSignal.set(t)}createPlan(t){this.loadingCount.update(n=>n+1);let i=this.authService.user()?.id;if(!i){console.error("User not authenticated"),this.loadingCount.update(n=>n-1);return}Kt(this.supabase.from("house_plans").insert({user_id:i,name:t.name,description:t.description||null,scale:t.scale||20,walls:t.walls||[]}).select().single()).pipe(Yt(n=>(console.error("Error creating plan:",n),Ft({error:n}))),Xt(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error){console.error("Failed to create plan:",n.error);return}this.plans.reload()})}updatePlan(t,i){this.loadingCount.update(n=>n+1),Kt(this.supabase.from("house_plans").update(i).eq("id",t).select().single()).pipe(Yt(n=>(console.error("Error updating plan:",n),Ft({error:n}))),Xt(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error){console.error("Failed to update plan:",n.error);return}this.plans.reload(),this.planIdSignal()===t&&this.currentPlan.reload()})}deletePlan(t){this.loadingCount.update(i=>i+1),Kt(this.supabase.from("house_plans").delete().eq("id",t)).pipe(Yt(i=>(console.error("Error deleting plan:",i),Ft({error:i}))),Xt(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error){console.error("Failed to delete plan:",i.error);return}this.plans.reload()})}clearCurrentPlan(){this.planIdSignal.set(null)}};var P9=(e,t,i)=>({points:e,stroke:t,strokeWidth:i,lineCap:"round",lineJoin:"round"}),F9=()=>[10,5],T9=(e,t)=>({points:e,stroke:"#3b82f6",strokeWidth:4,lineCap:"round",lineJoin:"round",dash:t}),oR=(e,t)=>t.id;function A9(e,t){e&1&&(M(0,"div",1),ee(1,"hlm-spinner",3),R())}function I9(e,t){if(e&1){let i=rt();M(0,"div",2)(1,"p"),_(2),Y(3,"transloco"),R(),M(4,"button",4),Q("click",function(){he(i);let s=Z();return pe(s.goBack())}),ee(5,"ng-icon",5),_(6),Y(7,"transloco"),R()()}if(e&2){let i=Z();P(2),Qi("",X(3,3,"common.error"),": ",i.plansService.currentPlan.error()),P(4),xe(" ",X(7,5,"common.back")," ")}}function _9(e,t){e&1&&(_(0),Y(1,"transloco")),e&2&&xe(" ",X(1,1,"housePlan.selectMode")," ")}function L9(e,t){e&1&&(_(0),Y(1,"transloco")),e&2&&xe(" ",X(1,1,"housePlan.drawMode")," ")}function O9(e,t){e&1&&(_(0),Y(1,"transloco")),e&2&&xe(" ",X(1,1,"housePlan.deleteMode")," ")}function N9(e,t){e&1&&(_(0),Y(1,"transloco")),e&2&&xe(" ",X(1,1,"housePlan.drawInstructions")," ")}function B9(e,t){e&1&&(_(0),Y(1,"transloco")),e&2&&xe(" ",X(1,1,"housePlan.selectInstructions")," ")}function H9(e,t){e&1&&(_(0),Y(1,"transloco")),e&2&&xe(" ",X(1,1,"housePlan.deleteInstructions")," ")}function V9(e,t){if(e&1&&ee(0,"ko-line",35),e&2){let i=t.$implicit;Ce("config",i)}}function G9(e,t){if(e&1){let i=rt();M(0,"ko-line",38),Q("click",function(){let s=he(i).$implicit,o=Z(2);return pe(o.onWallClick(s.id))}),R()}if(e&2){let i=t.$implicit;Ce("config",Vw(1,P9,i.points,i.stroke,i.strokeWidth))}}function z9(e,t){if(e&1&&ee(0,"ko-line",35),e&2){let i=Z(2);Ce("config",Hw(2,T9,i.tempLine(),ec(1,F9)))}}function W9(e,t){e&1&&(M(0,"p",36),_(1),Y(2,"transloco"),R()),e&2&&(P(),Ee(X(2,1,"housePlan.noWalls")))}function U9(e,t){e&1&&(_(0),Y(1,"transloco")),e&2&&xe(" \u2022 ",X(1,1,"housePlan.structureDefined")," ")}function q9(e,t){if(e&1){let i=rt();M(0,"div",40),Q("click",function(){let s=he(i).$implicit,o=Z(3);return pe(o.onWallClick(s.id))}),M(1,"div")(2,"p",41),_(3),R(),M(4,"p",29),_(5),Y(6,"transloco"),ze(7,U9,2,3),R()(),M(8,"button",8),Q("click",function(s){return he(i),Z(3).deleteSelectedWall(),pe(s.stopPropagation())}),ee(9,"ng-icon",42),R()()}if(e&2){let i=t.$implicit,n=Z(3);Vt("bg-accent",n.selectedWallId()===i.id),P(3),Ee(i.name),P(2),Qi(" ",X(6,6,"housePlan.thickness"),": ",i.thickness," cm "),P(2),We(i.structureId?7:-1)}}function $9(e,t){if(e&1&&(M(0,"div",37),cn(1,q9,10,8,"div",39,oR),R()),e&2){let i=Z(2);P(),un(i.walls())}}function j9(e,t){if(e&1){let i=rt();M(0,"div",6)(1,"div",7)(2,"button",8),Q("click",function(){he(i);let s=Z();return pe(s.goBack())}),ee(3,"ng-icon",9),R(),M(4,"div")(5,"h1",10),_(6),Y(7,"transloco"),R(),M(8,"p",11),_(9),Y(10,"transloco"),R()()(),M(11,"div",12)(12,"button",13),Q("click",function(){he(i);let s=Z();return pe(s.clearAll())}),ee(13,"ng-icon",14),_(14),Y(15,"transloco"),R(),M(16,"button",15),Q("click",function(){he(i);let s=Z();return pe(s.savePlan())}),ee(17,"ng-icon",16),_(18),Y(19,"transloco"),R()()(),M(20,"div",17)(21,"div",18)(22,"div",19)(23,"h3",20),_(24),Y(25,"transloco"),R()(),M(26,"div",21)(27,"div",22)(28,"button",23),Q("click",function(){he(i);let s=Z();return pe(s.setDrawingMode("select"))}),ee(29,"ng-icon",24),_(30),Y(31,"transloco"),R(),M(32,"button",23),Q("click",function(){he(i);let s=Z();return pe(s.setDrawingMode("draw"))}),ee(33,"ng-icon",25),_(34),Y(35,"transloco"),R(),M(36,"button",26),Q("click",function(){he(i);let s=Z();return pe(s.setDrawingMode("move"))}),ee(37,"ng-icon",27),_(38),Y(39,"transloco"),R(),M(40,"button",23),Q("click",function(){he(i);let s=Z();return pe(s.setDrawingMode("delete"))}),ee(41,"ng-icon",14),_(42),Y(43,"transloco"),R()(),M(44,"div",28)(45,"p",29)(46,"strong"),_(47),Y(48,"transloco"),R(),ze(49,_9,2,3)(50,L9,2,3)(51,O9,2,3),R()(),M(52,"div",28)(53,"p",30),_(54),Y(55,"transloco"),R(),M(56,"p",29),_(57),Y(58,"transloco"),R(),M(59,"p",29),_(60),Y(61,"transloco"),R()()()(),M(62,"div",18)(63,"div",19)(64,"h3",20),_(65),Y(66,"transloco"),R(),M(67,"p",31),ze(68,N9,2,3)(69,B9,2,3)(70,H9,2,3),R()(),M(71,"div",32)(72,"div",33)(73,"ko-stage",34),Q("mousedown",function(s){he(i);let o=Z();return pe(o.onStageMouseDown(s))})("mousemove",function(s){he(i);let o=Z();return pe(o.onStageMouseMove(s))}),M(74,"ko-layer"),cn(75,V9,1,1,"ko-line",35,Zd),R(),M(77,"ko-layer"),cn(78,G9,1,5,"ko-line",35,oR),ze(80,z9,1,5,"ko-line",35),R()()()()()(),M(81,"div",18)(82,"div",19)(83,"h3",20),_(84),Y(85,"transloco"),R(),M(86,"p",31),_(87),Y(88,"transloco"),R()(),M(89,"div",21),ze(90,W9,3,3,"p",36)(91,$9,3,0,"div",37),R()()}if(e&2){let i,n=Z();P(6),xe(" ",((i=n.plansService.currentPlan.value())==null?null:i.name)||X(7,30,"housePlan.title")," "),P(3),Ee(X(10,32,"housePlan.subtitle")),P(5),xe(" ",X(15,34,"common.clear")," "),P(2),Ce("disabled",n.plansService.loading()),P(2),xe(" ",X(19,36,"common.save")," "),P(6),Ee(X(25,38,"housePlan.tools")),P(4),Ce("variant",n.drawingMode()==="select"?"default":"outline"),P(2),xe(" ",X(31,40,"housePlan.select")," "),P(2),Ce("variant",n.drawingMode()==="draw"?"default":"outline"),P(2),xe(" ",X(35,42,"housePlan.drawWall")," "),P(2),Ce("variant",n.drawingMode()==="move"?"default":"outline"),P(2),xe(" ",X(39,44,"housePlan.move")," "),P(2),Ce("variant",n.drawingMode()==="delete"?"destructive":"outline"),P(2),xe(" ",X(43,46,"housePlan.delete")," "),P(5),xe("",X(48,48,"housePlan.mode"),":"),P(2),We(n.drawingMode()==="select"?49:n.drawingMode()==="draw"?50:n.drawingMode()==="delete"?51:-1),P(5),Ee(X(55,50,"housePlan.stats")),P(3),Qi("",X(58,52,"housePlan.wallCount"),": ",n.walls().length),P(3),Qi("",X(61,54,"housePlan.scale"),": 1:",100/n.scale()),P(5),Ee(X(66,56,"housePlan.canvas")),P(3),We(n.drawingMode()==="draw"?68:n.drawingMode()==="select"?69:n.drawingMode()==="delete"?70:-1),P(4),pn("cursor",n.drawingMode()==="draw"?"crosshair":n.drawingMode()==="delete"?"not-allowed":"default"),P(),Ce("config",n.stageConfig),P(2),un(n.gridLines()),P(3),un(n.wallLines()),P(2),We(n.tempLine()?80:-1),P(4),Ee(X(85,58,"housePlan.wallList")),P(3),Ee(X(88,60,"housePlan.wallListDesc")),P(3),We(n.walls().length===0?90:91)}}function K9(e,t){if(e&1&&(M(0,"div",52),_(1),Y(2,"transloco"),R()),e&2){let i=Z(2);P(),Qi(" ",X(2,2,"housePlan.structureLinked"),": ",i.wallStructureId()," ")}}function Y9(e,t){e&1&&(M(0,"p",53),_(1),Y(2,"transloco"),R()),e&2&&(P(),Ee(X(2,1,"housePlan.noStructureLinked")))}function X9(e,t){if(e&1&&(M(0,"div",54)(1,"p",58),_(2),Y(3,"transloco"),R(),M(4,"p",29),_(5),Y(6,"transloco"),R()()),e&2){let i=Z(2);P(2),Ee(X(3,3,"housePlan.dimensions")),P(3),Qi(" ",X(6,5,"housePlan.length"),": ",i.calculateWallLength(i.selectedWall().points[0],i.selectedWall().points[1],i.selectedWall().points[2],i.selectedWall().points[3]).toFixed(2)," m ")}}function J9(e,t){if(e&1){let i=rt();M(0,"div",43),Q("click",function(){he(i);let s=Z();return pe(s.closeMetadataSheet())}),R(),M(1,"div",44)(2,"div",45)(3,"div")(4,"h3",46),_(5),Y(6,"transloco"),R(),M(7,"p",29),_(8),Y(9,"transloco"),R()(),M(10,"div",37)(11,"label",47),_(12),Y(13,"transloco"),R(),M(14,"input",48),yr("ngModelChange",function(s){he(i);let o=Z();return br(o.wallName,s)||(o.wallName=s),pe(s)}),R()(),M(15,"div",37)(16,"label",49),_(17),Y(18,"transloco"),R(),M(19,"input",50),yr("ngModelChange",function(s){he(i);let o=Z();return br(o.wallThickness,s)||(o.wallThickness=s),pe(s)}),R()(),M(20,"div",37)(21,"label",51),_(22),Y(23,"transloco"),R(),M(24,"p",29),_(25),Y(26,"transloco"),R(),ze(27,K9,3,4,"div",52)(28,Y9,3,3,"p",53),R(),ze(29,X9,7,7,"div",54),M(30,"div",55)(31,"button",56),Q("click",function(){he(i);let s=Z();return pe(s.closeMetadataSheet())}),_(32),Y(33,"transloco"),R(),M(34,"button",57),Q("click",function(){he(i);let s=Z();return pe(s.saveWallMetadata())}),_(35),Y(36,"transloco"),R()()()()}if(e&2){let i=Z();P(5),Ee(X(6,12,"housePlan.wallMetadata")),P(3),Ee(X(9,14,"housePlan.wallMetadataDesc")),P(4),xe(" ",X(13,16,"housePlan.wallName")," "),P(2),wr("ngModel",i.wallName),P(3),xe(" ",X(18,18,"housePlan.wallThickness")," (cm) "),P(2),wr("ngModel",i.wallThickness),P(3),Ee(X(23,20,"housePlan.wallStructure")),P(3),Ee(X(26,22,"housePlan.wallStructureDesc")),P(2),We(i.wallStructureId()?27:28),P(2),We(i.selectedWall()?29:-1),P(3),xe(" ",X(33,24,"common.cancel")," "),P(3),xe(" ",X(36,26,"common.save")," ")}}var rR=(()=>{class e{route=z(zw);router=z(ic);plansService=z(Qs);constructor(){qe(()=>{let i=this.route.snapshot.paramMap.get("id");i&&this.plansService.loadPlan(i)}),qe(()=>{let i=this.plansService.currentPlan.value();i&&(this.walls.set(i.walls||[]),this.scale.set(i.scale||20))})}canvasWidth=800;canvasHeight=600;gridSize=20;scale=Se(20);drawingMode=Se("select");walls=Se([]);selectedWallId=Se(null);isDrawing=Se(!1);tempLine=Se(null);isMetadataSheetOpen=Se(!1);selectedWall=W(()=>{let i=this.selectedWallId();return i&&this.walls().find(n=>n.id===i)||null});wallName=Se("");wallThickness=Se(30);wallStructureId=Se(null);gridLines=W(()=>{let i=[];for(let n=0;n<=this.canvasWidth;n+=this.gridSize)i.push({points:[n,0,n,this.canvasHeight],stroke:"#e5e7eb",strokeWidth:n%(this.gridSize*5)===0?1.5:.5});for(let n=0;n<=this.canvasHeight;n+=this.gridSize)i.push({points:[0,n,this.canvasWidth,n],stroke:"#e5e7eb",strokeWidth:n%(this.gridSize*5)===0?1.5:.5});return i});wallLines=W(()=>this.walls().map(i=>({id:i.id,points:i.points,stroke:i.id===this.selectedWallId()?"#3b82f6":i.color,strokeWidth:4,listening:!0})));setDrawingMode(i){this.drawingMode.set(i),i!=="select"&&this.selectedWallId.set(null)}onStageMouseDown(i){let n=i.event.target.getStage();if(!n)return;let s=n.getPointerPosition();if(s){if(this.drawingMode()==="draw")if(this.isDrawing()){let o=this.tempLine();if(o){let r={id:Date.now().toString(),name:`Wall ${this.walls().length+1}`,points:o,thickness:30,color:"#1f2937"};this.walls.update(a=>[...a,r])}this.isDrawing.set(!1),this.tempLine.set(null)}else{this.isDrawing.set(!0);let o=this.snapToGrid(s);this.tempLine.set([o.x,o.y,o.x,o.y])}else if(this.drawingMode()==="delete"){let o=this.getWallAtPosition(s);o&&(this.walls.update(r=>r.filter(a=>a.id!==o.id)),this.selectedWallId.set(null))}}}onStageMouseMove(i){if(this.drawingMode()==="draw"&&this.isDrawing()){let n=i.event.target.getStage();if(!n)return;let s=n.getPointerPosition();if(!s)return;let o=this.snapToGrid(s),r=this.tempLine();r&&this.tempLine.set([r[0],r[1],o.x,o.y])}}onWallClick(i){if(this.drawingMode()==="select"){this.selectedWallId.set(i);let n=this.walls().find(s=>s.id===i);n&&(this.wallName.set(n.name),this.wallThickness.set(n.thickness),this.wallStructureId.set(n.structureId||null),this.isMetadataSheetOpen.set(!0))}else this.drawingMode()==="delete"&&(this.walls.update(n=>n.filter(s=>s.id!==i)),this.selectedWallId.set(null))}saveWallMetadata(){let i=this.selectedWallId();i&&(this.walls.update(n=>n.map(s=>s.id===i?O(b({},s),{name:this.wallName(),thickness:this.wallThickness(),structureId:this.wallStructureId()??void 0}):s)),this.isMetadataSheetOpen.set(!1))}closeMetadataSheet(){this.isMetadataSheetOpen.set(!1),this.selectedWallId.set(null)}deleteSelectedWall(){let i=this.selectedWallId();i&&(this.walls.update(n=>n.filter(s=>s.id!==i)),this.isMetadataSheetOpen.set(!1),this.selectedWallId.set(null))}clearAll(){confirm("Are you sure you want to clear all walls?")&&(this.walls.set([]),this.selectedWallId.set(null),this.isDrawing.set(!1),this.tempLine.set(null))}savePlan(){let i=this.route.snapshot.paramMap.get("id");if(!i){console.error("No plan ID found");return}this.plansService.updatePlan(i,{walls:this.walls(),scale:this.scale()})}goBack(){this.router.navigate(["/hd","house-plans"])}snapToGrid(i){return{x:Math.round(i.x/this.gridSize)*this.gridSize,y:Math.round(i.y/this.gridSize)*this.gridSize}}getWallAtPosition(i){for(let s of this.walls()){let[o,r,a,l]=s.points;if(this.distanceToLineSegment(i,{x:o,y:r},{x:a,y:l})<10)return s}return null}distanceToLineSegment(i,n,s){let o=s.x-n.x,r=s.y-n.y,a=o*o+r*r;if(a===0)return Math.sqrt((i.x-n.x)**2+(i.y-n.y)**2);let l=((i.x-n.x)*o+(i.y-n.y)*r)/a;l=Math.max(0,Math.min(1,l));let d=n.x+l*o,c=n.y+l*r;return Math.sqrt((i.x-d)**2+(i.y-c)**2)}calculateWallLength(i,n,s,o){return Math.sqrt(Math.pow(s-i,2)+Math.pow(o-n,2))/this.scale()}stageConfig={width:this.canvasWidth,height:this.canvasHeight};static \u0275fac=function(n){return new(n||e)};static \u0275cmp=be({type:e,selectors:[["gh-house-plan-editor"]],features:[Ie([Qs,Lt({lucidePointer:b1,lucidePencil:w1,lucideMove:C1,lucideTrash:Mr,lucideSquare:R1,lucideSave:x1,lucideArrowUpDown:i1,lucideArrowLeft:t1})])],decls:5,vars:2,consts:[[1,"p-4","md:p-6","space-y-4"],[1,"flex","items-center","justify-center","py-12"],[1,"text-center","py-12","text-destructive"],["size","large"],["hlmBtn","","variant","outline",1,"mt-4",3,"click"],["hlm","","name","lucideArrowLeft","size","sm",1,"mr-2"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-4"],["hlmBtn","","variant","ghost","size","icon",3,"click"],["hlm","","name","lucideArrowLeft","size","sm"],[1,"text-2xl","md:text-3xl","font-bold"],[1,"text-muted-foreground","mt-1"],[1,"flex","gap-2"],["hlmBtn","","variant","outline",3,"click"],["hlm","","name","lucideTrash","size","sm",1,"mr-2"],["hlmBtn","",3,"click","disabled"],["hlm","","name","lucideSave","size","sm",1,"mr-2"],[1,"grid","gap-4","lg:grid-cols-[auto_1fr]"],["hlmCard",""],["hlmCardHeader",""],["hlmCardTitle",""],["hlmCardContent",""],[1,"flex","flex-row","lg:flex-col","gap-2"],["hlmBtn","","size","sm",1,"w-full","justify-start",3,"click","variant"],["hlm","","name","lucidePointer","size","sm",1,"mr-2"],["hlm","","name","lucidePencil","size","sm",1,"mr-2"],["hlmBtn","","size","sm","disabled","",1,"w-full","justify-start",3,"click","variant"],["hlm","","name","lucideMove","size","sm",1,"mr-2"],[1,"mt-4","pt-4","border-t"],[1,"text-sm","text-muted-foreground"],[1,"text-sm","font-medium","mb-2"],["hlmCardDescription",""],["hlmCardContent","",1,"overflow-auto"],[1,"border","rounded-md","bg-white","inline-block"],[3,"mousedown","mousemove","config"],[3,"config"],[1,"text-sm","text-muted-foreground","text-center","py-8"],[1,"space-y-2"],[3,"click","config"],[1,"flex","items-center","justify-between","p-3","border","rounded-md","hover:bg-accent","cursor-pointer","transition-colors",3,"bg-accent"],[1,"flex","items-center","justify-between","p-3","border","rounded-md","hover:bg-accent","cursor-pointer","transition-colors",3,"click"],[1,"font-medium"],["hlm","","name","lucideTrash","size","sm"],[1,"fixed","inset-0","z-50","bg-black/50",3,"click"],[1,"fixed","right-0","top-0","z-50","h-full","w-full","max-w-md","bg-background","shadow-lg","p-6","overflow-y-auto"],[1,"space-y-4"],[1,"text-lg","font-semibold"],["hlmLabel","","for","wall-name"],["hlmInput","","id","wall-name","type","text",3,"ngModelChange","ngModel"],["hlmLabel","","for","wall-thickness"],["hlmInput","","id","wall-thickness","type","number","min","1","step","1",3,"ngModelChange","ngModel"],["hlmLabel",""],[1,"p-2","bg-accent","rounded-md","text-sm"],[1,"text-sm","text-muted-foreground","italic"],[1,"space-y-2","pt-4","border-t"],[1,"flex","gap-2","pt-4"],["hlmBtn","","variant","outline",1,"flex-1",3,"click"],["hlmBtn","",1,"flex-1",3,"click"],[1,"text-sm","font-medium"]],template:function(n,s){n&1&&(M(0,"div",0),ze(1,A9,2,0,"div",1)(2,I9,8,7,"div",2)(3,j9,92,62),R(),ze(4,J9,37,28)),n&2&&(P(),We(s.plansService.currentPlan.isLoading()?1:s.plansService.currentPlan.error()?2:3),P(3),We(s.isMetadataSheetOpen()?4:-1))},dependencies:[gn,ac,sc,Jw,oc,Zw,rc,iR,rp,Pr,Ar,Ir,Tr,Fr,Jt,il,Dr,it,xt,kr,fn,As],encapsulation:2,changeDetection:0})}return e})();var rr=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setFrameworkOverrides(e){this.frameworkOverrides=e}getListeners(e,t,i){let n=t?this.allAsyncListeners:this.allSyncListeners,s=n.get(e);return!s&&i&&(s=new Set,n.set(e,s)),s}noRegisteredListenersExist(){return this.allSyncListeners.size===0&&this.allAsyncListeners.size===0&&this.globalSyncListeners.size===0&&this.globalAsyncListeners.size===0}addEventListener(e,t,i=!1){this.getListeners(e,i,!0).add(t)}removeEventListener(e,t,i=!1){let n=this.getListeners(e,i,!1);n&&(n.delete(t),n.size===0&&(i?this.allAsyncListeners:this.allSyncListeners).delete(e))}addGlobalListener(e,t=!1){this.getGlobalListeners(t).add(e)}removeGlobalListener(e,t=!1){this.getGlobalListeners(t).delete(e)}dispatchEvent(e){this.dispatchToListeners(e,!0),this.dispatchToListeners(e,!1),this.firedEvents[e.type]=!0}dispatchEventOnce(e){this.firedEvents[e.type]||this.dispatchEvent(e)}dispatchToListeners(e,t){let i=e.type;if(t&&"event"in e){let a=e.event;a instanceof Event&&(e.eventPath=a.composedPath())}let{frameworkOverrides:n}=this,s=a=>{let l=n?()=>n.wrapIncoming(a):a;t?this.dispatchAsync(l):l()},o=this.getListeners(i,t,!1);if((o?.size??0)>0){let a=new Set(o);for(let l of a)o?.has(l)&&s(()=>l(e))}let r=this.getGlobalListeners(t);if(r.size>0){let a=new Set(r);for(let l of a)s(()=>l(i,e))}}getGlobalListeners(e){return e?this.globalAsyncListeners:this.globalSyncListeners}dispatchAsync(e){if(this.asyncFunctionsQueue.push(e),!this.scheduled){let t=()=>{window.setTimeout(this.flushAsyncQueue.bind(this),0)};this.frameworkOverrides?this.frameworkOverrides.wrapIncoming(t):t(),this.scheduled=!0}}flushAsyncQueue(){this.scheduled=!1;let e=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[];for(let t of e)t()}};function xs(e){return e==null||e===""?null:e}function K(e){return e!=null&&e!==""}function tt(e){return!K(e)}function JC(e){return e!=null&&typeof e.toString=="function"?e.toString():null}function Pd(e,t){let i=e?JSON.stringify(e):null,n=t?JSON.stringify(t):null;return i===n}function Q9(e,t,i=!1){let n=e==null,s=t==null;if(e?.toNumber&&(e=e.toNumber()),t?.toNumber&&(t=t.toNumber()),n&&s)return 0;if(n)return-1;if(s)return 1;function o(r,a){return r>a?1:r<a?-1:0}if(typeof e!="string"||!i)return o(e,t);try{return e.localeCompare(t)}catch{return o(e,t)}}var Z9=/[&<>"']/g,eO={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Wa(e){return e?.toString().toString()??null}function wd(e){return Wa(e)?.replace(Z9,t=>eO[t])??null}function _n(e){return e.eRootDiv.getRootNode()}function ot(e){return _n(e).activeElement}function Ht(e){let{gos:t,eRootDiv:i}=e,n=null,s=t.get("getDocument");return s&&K(s)?n=s():i&&(n=i.ownerDocument),n&&K(n)?n:document}function k6(e){let t=ot(e);return t===null||t===Ht(e).body}function P6(e){return Ht(e).defaultView||window}function Av(e){let t=null,i=null;try{t=Ht(e).fullscreenElement}catch{}finally{t||(t=_n(e));let n=t.querySelector("body");n?i=n:t instanceof ShadowRoot?i=t:t instanceof Document?i=t?.documentElement:i=t}return i}function tO(e){return Av(e)?.clientWidth??(window.innerWidth||-1)}function iO(e){return Av(e)?.clientHeight??(window.innerHeight||-1)}function ln(e,t,i){i==null||typeof i=="string"&&i==""?F6(e,t):Yi(e,t,i)}function Yi(e,t,i){e.setAttribute(T6(t),i.toString())}function F6(e,t){e.removeAttribute(T6(t))}function T6(e){return`aria-${e}`}function oo(e,t){t?e.setAttribute("role",t):e.removeAttribute("role")}function nO(e){let t;return e==="asc"?t="ascending":e==="desc"?t="descending":e==="mixed"?t="other":t="none",t}function sO(e){return e.getAttribute("aria-label")}function Na(e,t){ln(e,"label",t)}function Fd(e,t){ln(e,"labelledby",t)}function A6(e,t){ln(e,"live",t)}function oO(e,t){ln(e,"atomic",t)}function rO(e,t){ln(e,"relevant",t)}function aO(e,t){ln(e,"invalid",t)}function lO(e,t){ln(e,"disabled",t)}function I6(e,t){ln(e,"hidden",t)}function QC(e,t){Yi(e,"expanded",t)}function dO(e,t){Yi(e,"setsize",t)}function cO(e,t){Yi(e,"posinset",t)}function uO(e,t){Yi(e,"multiselectable",t)}function hO(e,t){Yi(e,"rowcount",t)}function Fp(e,t){Yi(e,"rowindex",t)}function pO(e,t){Yi(e,"rowspan",t)}function gO(e,t){Yi(e,"colcount",t)}function _6(e,t){Yi(e,"colindex",t)}function fO(e,t){Yi(e,"colspan",t)}function mO(e,t){Yi(e,"sort",t)}function CO(e){F6(e,"sort")}function L6(e,t){ln(e,"selected",t)}function vO(e,t){ln(e,"controls",t)}function wO(e,t){vO(e,t.id),Fd(t,e.id)}function aR(e,t){ln(e,"owns",t)}function Zp(e,t){return t===void 0?e("ariaIndeterminate","indeterminate"):t===!0?e("ariaChecked","checked"):e("ariaUnchecked","unchecked")}var bO="[tabindex], input, select, button, textarea, [href]",O6="[disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function bd(e){return!e||!e.matches("input, select, button, textarea")||!e.matches(O6)?!1:Gn(e)}function et(e,t,i={}){let{skipAriaHidden:n}=i;e.classList.toggle("ag-hidden",!t),n||I6(e,!t)}function yO(e,t,i={}){let{skipAriaHidden:n}=i;e.classList.toggle("ag-invisible",!t),n||I6(e,!t)}function Td(e,t){let i="disabled",n=t?o=>o.setAttribute(i,""):o=>o.removeAttribute(i);n(e);let s=e.querySelectorAll("input")??[];for(let o of s)n(o)}function er(e,t,i){let n=0;for(;e;){if(e.classList.contains(t))return!0;if(e=e.parentElement,typeof i=="number"){if(++n>i)break}else if(e===i)break}return!1}function ur(e){let{height:t,width:i,borderTopWidth:n,borderRightWidth:s,borderBottomWidth:o,borderLeftWidth:r,paddingTop:a,paddingRight:l,paddingBottom:d,paddingLeft:c,marginTop:u,marginRight:h,marginBottom:p,marginLeft:g,boxSizing:f}=window.getComputedStyle(e),m=Number.parseFloat;return{height:m(t||"0"),width:m(i||"0"),borderTopWidth:m(n||"0"),borderRightWidth:m(s||"0"),borderBottomWidth:m(o||"0"),borderLeftWidth:m(r||"0"),paddingTop:m(a||"0"),paddingRight:m(l||"0"),paddingBottom:m(d||"0"),paddingLeft:m(c||"0"),marginTop:m(u||"0"),marginRight:m(h||"0"),marginBottom:m(p||"0"),marginLeft:m(g||"0"),boxSizing:f}}function Iv(e){let t=ur(e);return t.boxSizing==="border-box"?t.height-t.paddingTop-t.paddingBottom-t.borderTopWidth-t.borderBottomWidth:t.height}function Ad(e){let t=ur(e);return t.boxSizing==="border-box"?t.width-t.paddingLeft-t.paddingRight-t.borderLeftWidth-t.borderRightWidth:t.width}function N6(e){let{height:t,marginBottom:i,marginTop:n}=ur(e);return Math.floor(t+i+n)}function Tp(e){let{width:t,marginLeft:i,marginRight:n}=ur(e);return Math.floor(t+i+n)}function B6(e){let t=e.getBoundingClientRect(),{borderTopWidth:i,borderLeftWidth:n,borderRightWidth:s,borderBottomWidth:o}=ur(e);return{top:t.top+(i||0),left:t.left+(n||0),right:t.right+(s||0),bottom:t.bottom+(o||0)}}function Ap(e,t){let i=e.scrollLeft;return t&&(i=Math.abs(i)),i}function Ip(e,t,i){i&&(t*=-1),e.scrollLeft=t}function $t(e){for(;e?.firstChild;)e.firstChild.remove()}function yi(e){e?.parentNode&&e.remove()}function H6(e){return!!e.offsetParent}function Gn(e){return e.checkVisibility?e.checkVisibility({checkVisibilityCSS:!0}):!(!H6(e)||window.getComputedStyle(e).visibility!=="visible")}function _v(e){let t=document.createElement("div");return t.innerHTML=(e||"").trim(),t.firstChild}function V6(e,t,i){i&&i.nextSibling===t||(e.firstChild?i?i.nextSibling?e.insertBefore(t,i.nextSibling):e.appendChild(t):e.firstChild&&e.firstChild!==t&&e.insertAdjacentElement("afterbegin",t):e.appendChild(t))}function G6(e,t){for(let i=0;i<t.length;i++){let n=t[i],s=e.children[i];s!==n&&e.insertBefore(n,s)}}function SO(e){return e.replace(/[A-Z]/g,t=>`-${t.toLocaleLowerCase()}`)}function zd(e,t){if(t)for(let i of Object.keys(t)){let n=t[i];if(!i?.length||n==null)continue;let s=SO(i),o=n.toString(),r=o.replace(/\s*!important/g,""),a=r.length!=o.length?"important":void 0;e.style.setProperty(s,r,a)}}function vp(e){return()=>{let t=e();return t?Lv(t)||z6(t):!0}}function Lv(e){return e.clientWidth<e.scrollWidth}function z6(e){return e.clientHeight<e.scrollHeight}function _p(e,t){t==="flex"?(e.style.removeProperty("width"),e.style.removeProperty("minWidth"),e.style.removeProperty("maxWidth"),e.style.flex="1 1 auto"):Bn(e,t)}function Bn(e,t){t=Ov(t),e.style.width=t,e.style.maxWidth=t,e.style.minWidth=t}function yd(e,t){t=Ov(t),e.style.height=t,e.style.maxHeight=t,e.style.minHeight=t}function Ov(e){return typeof e=="number"?`${e}px`:e}function Nv(e){return e instanceof Node||e instanceof HTMLElement}function Fi(e,t,i){i==null||i===""?e.removeAttribute(t):e.setAttribute(t,i.toString())}function uo(e,t,i){let s=P6(e).ResizeObserver,o=s?new s(i):null;return o?.observe(t),()=>o?.disconnect()}function Ps(e,t){let i=P6(e);i.requestAnimationFrame?i.requestAnimationFrame(t):i.webkitRequestAnimationFrame?i.webkitRequestAnimationFrame(t):i.setTimeout(t,0)}var W6="data-ref",mC;function lR(){return mC??(mC=document.createTextNode(" ")),mC.cloneNode()}function Wd(e){let{attrs:t,children:i,cls:n,ref:s,role:o,tag:r}=e,a=document.createElement(r);if(n&&(a.className=n),s&&a.setAttribute(W6,s),o&&a.setAttribute("role",o),t)for(let l of Object.keys(t))a.setAttribute(l,t[l]);if(i)if(typeof i=="string")a.textContent=i;else{let l=!0;for(let d of i)d&&(typeof d=="string"?(a.appendChild(document.createTextNode(d)),l=!1):typeof d=="function"?a.appendChild(d()):(l&&(a.appendChild(lR()),l=!1),a.append(Wd(d)),a.appendChild(lR())))}return a}var xO=["touchstart","touchend","touchmove","touchcancel","scroll"],EO=["wheel"],CC={},U6=(()=>{let e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return i=>{if(typeof CC[i]=="boolean")return CC[i];let n=document.createElement(e[i]||"div");return i="on"+i,CC[i]=i in n}})();function RO(e,t){return!t||!e?!1:DO(t).indexOf(e)>=0}function MO(e){let t=[],i=e.target;for(;i;)t.push(i),i=i.parentElement;return t}function DO(e){let t=e;return t.path?t.path:t.composedPath?t.composedPath():MO(t)}function kO(e,t,i){let n=PO(t),s;n!=null&&(s={passive:n}),e.addEventListener(t,i,s)}var PO=e=>{let t=xO.includes(e),i=EO.includes(e);if(t)return!0;if(i)return!1};function q6(e,t,i){if(i===0)return!1;let n=Math.abs(e.clientX-t.clientX),s=Math.abs(e.clientY-t.clientY);return Math.max(n,s)<=i}var Sd=(e,t)=>{let i=e.identifier;for(let n=0,s=t.length;n<s;++n){let o=t[n];if(o.identifier===i)return o}return null};function Id(e,t){return e.gos.isElementInThisInstance(t.target)}function FO(e,t,i){let s=e.getBoundingClientRect().height,o=tO(i)-2,r=iO(i)-2;if(!e.offsetParent)return;let l=B6(e.offsetParent),{clientY:d,clientX:c}=t,u=d-l.top-s/2,h=c-l.left-10,p=Ht(i),g=p.defaultView||window,f=g.pageYOffset||p.documentElement.scrollTop,m=g.pageXOffset||p.documentElement.scrollLeft;o>0&&h+e.clientWidth>o+m&&(h=o+m-e.clientWidth),h<0&&(h=0),r>0&&u+e.clientHeight>r+f&&(u=r+f-e.clientHeight),u<0&&(u=0),e.style.left=`${h}px`,e.style.top=`${u}px`}var wp=(e,...t)=>{for(let i of t){let[n,s,o,r]=i;n.addEventListener(s,o,r),e.push(i)}},Bv=e=>{if(e){for(let[t,i,n,s]of e)t.removeEventListener(i,n,s);e.length=0}},io=e=>{e.cancelable&&e.preventDefault()};function TO(e,t){return t}function $6(e){return e?.getLocaleTextFunc()??TO}function AO(e,t,i,n){let s=t[i];return e.getLocaleTextFunc()(i,typeof s=="function"?s(n):s,n)}function IO(e){return(t,i,n)=>e({key:t,defaultValue:i,variableValues:n})}function _O(e){return(t,i,n)=>{let s=e?.[t];if(s&&n?.length){let o=0;for(;!(o>=n.length||s.indexOf("${variable}")===-1);)s=s.replace("${variable}",n[o++])}return s??i}}var zn=class{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.propertyListenerId=0,this.lastChangeSetIdLookup={},this.isAlive=()=>!this.destroyed}preWireBeans(e){this.beans=e,this.stubContext=e.context,this.eventSvc=e.eventSvc,this.gos=e.gos}destroy(){let{destroyFunctions:e}=this;for(let t=0;t<e.length;t++)e[t]();e.length=0,this.destroyed=!0,this.dispatchLocalEvent({type:"destroyed"})}addEventListener(e,t,i){this.localEventService||(this.localEventService=new rr),this.localEventService.addEventListener(e,t,i)}removeEventListener(e,t,i){this.localEventService?.removeEventListener(e,t,i)}dispatchLocalEvent(e){this.localEventService?.dispatchEvent(e)}addManagedElementListeners(e,t){return this._setupListeners(e,t)}addManagedEventListeners(e){return this._setupListeners(this.eventSvc,e)}addManagedListeners(e,t){return this._setupListeners(e,t)}_setupListeners(e,t){let i=[];for(let n of Object.keys(t)){let s=t[n];s&&i.push(this._setupListener(e,n,s))}return i}_setupListener(e,t,i){if(this.destroyed)return()=>null;let n;if(LO(e))e.__addEventListener(t,i),n=()=>(e.__removeEventListener(t,i),null);else{let s=OO(e);e instanceof HTMLElement?kO(e,t,i):s?e.addListener(t,i):e.addEventListener(t,i),n=s?()=>(e.removeListener(t,i),null):()=>(e.removeEventListener(t,i),null)}return this.destroyFunctions.push(n),()=>(n(),this.destroyFunctions=this.destroyFunctions.filter(s=>s!==n),null)}setupPropertyListener(e,t){let{gos:i}=this;i.addPropertyEventListener(e,t);let n=()=>(i.removePropertyEventListener(e,t),null);return this.destroyFunctions.push(n),()=>(n(),this.destroyFunctions=this.destroyFunctions.filter(s=>s!==n),null)}addManagedPropertyListener(e,t){return this.destroyed?()=>null:this.setupPropertyListener(e,t)}addManagedPropertyListeners(e,t){if(this.destroyed)return;let i=e.join("-")+this.propertyListenerId++,n=s=>{if(s.changeSet){if(s.changeSet&&s.changeSet.id===this.lastChangeSetIdLookup[i])return;this.lastChangeSetIdLookup[i]=s.changeSet.id}let o={type:"propertyChanged",changeSet:s.changeSet,source:s.source};t(o)};for(let s of e)this.setupPropertyListener(s,n)}getLocaleTextFunc(){return $6(this.beans.localeSvc)}addDestroyFunc(e){this.isAlive()?this.destroyFunctions.push(e):e()}createOptionalManagedBean(e,t){return e?this.createManagedBean(e,t):void 0}createManagedBean(e,t){let i=this.createBean(e,t);return this.addDestroyFunc(this.destroyBean.bind(this,e,t)),i}createBean(e,t,i){return(t||this.stubContext).createBean(e,i)}destroyBean(e,t){return(t||this.stubContext).destroyBean(e)}destroyBeans(e,t){return(t||this.stubContext).destroyBeans(e)}};function LO(e){return e.__addEventListener!==void 0}function OO(e){return e.eventServiceType==="global"}var F=class extends zn{},dR={};function Hv(e,t){dR[t]||(e(),dR[t]=!0)}var NO={pending:!1,funcs:[]},BO={pending:!1,funcs:[]};function ZC(e,t="setTimeout",i){let n=t==="raf"?BO:NO;if(n.funcs.push(e),n.pending)return;n.pending=!0;let s=()=>{let o=n.funcs.slice();n.funcs.length=0,n.pending=!1;for(let r of o)r()};t==="raf"?Ps(i,s):window.setTimeout(s,0)}function qt(e,t,i){let n;return function(...s){let o=this;window.clearTimeout(n),n=window.setTimeout(function(){e.isAlive()&&t.apply(o,s)},i)}}function cR(e,t){let i=0;return function(...n){let s=this,o=Date.now();o-i<t||(i=o,e.apply(s,n))}}function HO(e,t,i,n=100){let s=Date.now(),o=null,r=!1,a=()=>{o!=null&&(window.clearInterval(o),o=null)};e.addDestroyFunc(a);let l=()=>{let d=Date.now()-s>n;(t()||d)&&(i(),r=!0,a())};l(),r||(o=window.setInterval(l,10))}var j6=new Set(["__proto__","constructor","prototype"]);function VO(e,t){if(e!=null){if(Array.isArray(e)){for(let i=0;i<e.length;i++)t(i.toString(),e[i]);return}for(let i of Object.keys(e).filter(n=>!j6.has(n)))t(i,e[i])}}function pi(e,t,i=!0,n=!1){K(t)&&VO(t,(s,o)=>{let r=e[s];r!==o&&(n&&r==null&&o!=null&&typeof o=="object"&&o.constructor===Object&&(r={},e[s]=r),uR(o)&&uR(r)&&!Array.isArray(r)?pi(r,o,i,n):(i||o!==void 0)&&(e[s]=o))})}function uR(e){return typeof e=="object"&&e!==null}var GO=(()=>{let e=class bs{static applyGlobalGridOptions(i){if(!bs.gridOptions)return b({},i);let n={};return pi(n,bs.gridOptions,!0,!0),bs.mergeStrategy==="deep"?pi(n,i,!0,!0):n=b(b({},n),i),bs.gridOptions.context&&(n.context=bs.gridOptions.context),i.context&&(bs.mergeStrategy==="deep"&&n.context&&pi(i.context,n.context,!0,!0),n.context=i.context),n}static applyGlobalGridOption(i,n){if(bs.mergeStrategy==="deep"){let s=zO(i);if(s&&typeof s=="object"&&typeof n=="object")return bs.applyGlobalGridOptions({[i]:n})[i]}return n}};return e.gridOptions=void 0,e.mergeStrategy="shallow",e})(),Vv=GO;function zO(e){return Vv.gridOptions?.[e]}var WO={suppressContextMenu:!1,preventDefaultOnContextMenu:!1,allowContextMenuWithControlKey:!1,suppressMenuHide:!0,enableBrowserTooltips:!1,tooltipTrigger:"hover",tooltipShowDelay:2e3,tooltipHideDelay:1e4,tooltipMouseTrack:!1,tooltipShowMode:"standard",tooltipInteraction:!1,copyHeadersToClipboard:!1,copyGroupHeadersToClipboard:!1,clipboardDelimiter:"	",suppressCopyRowsToClipboard:!1,suppressCopySingleCellRanges:!1,suppressLastEmptyLineOnPaste:!1,suppressClipboardPaste:!1,suppressClipboardApi:!1,suppressCutToClipboard:!1,maintainColumnOrder:!1,enableStrictPivotColumnOrder:!1,suppressFieldDotNotation:!1,allowDragFromColumnsToolPanel:!1,suppressMovableColumns:!1,suppressColumnMoveAnimation:!1,suppressMoveWhenColumnDragging:!1,suppressDragLeaveHidesColumns:!1,suppressRowGroupHidesColumns:!1,suppressAutoSize:!1,autoSizePadding:20,skipHeaderOnAutoSize:!1,singleClickEdit:!1,suppressClickEdit:!1,readOnlyEdit:!1,stopEditingWhenCellsLoseFocus:!1,enterNavigatesVertically:!1,enterNavigatesVerticallyAfterEdit:!1,enableCellEditingOnBackspace:!1,undoRedoCellEditing:!1,undoRedoCellEditingLimit:10,suppressCsvExport:!1,suppressExcelExport:!1,cacheQuickFilter:!1,includeHiddenColumnsInQuickFilter:!1,excludeChildrenWhenTreeDataFiltering:!1,enableAdvancedFilter:!1,includeHiddenColumnsInAdvancedFilter:!1,enableCharts:!1,masterDetail:!1,keepDetailRows:!1,keepDetailRowsCount:10,detailRowAutoHeight:!1,tabIndex:0,rowBuffer:10,valueCache:!1,valueCacheNeverExpires:!1,enableCellExpressions:!1,suppressTouch:!1,suppressFocusAfterRefresh:!1,suppressBrowserResizeObserver:!1,suppressPropertyNamesCheck:!1,suppressChangeDetection:!1,debug:!1,suppressLoadingOverlay:!1,suppressNoRowsOverlay:!1,pagination:!1,paginationPageSize:100,paginationPageSizeSelector:!0,paginationAutoPageSize:!1,paginateChildRows:!1,suppressPaginationPanel:!1,pivotMode:!1,pivotPanelShow:"never",pivotDefaultExpanded:0,pivotSuppressAutoColumn:!1,suppressExpandablePivotGroups:!1,functionsReadOnly:!1,suppressAggFuncInHeader:!1,alwaysAggregateAtRootLevel:!1,aggregateOnlyChangedColumns:!1,suppressAggFilteredOnly:!1,removePivotHeaderRowWhenSingleValueColumn:!1,animateRows:!0,cellFlashDuration:500,cellFadeDuration:1e3,allowShowChangeAfterFilter:!1,domLayout:"normal",ensureDomOrder:!1,enableRtl:!1,suppressColumnVirtualisation:!1,suppressMaxRenderedRowRestriction:!1,suppressRowVirtualisation:!1,rowDragManaged:!1,rowDragInsertDelay:500,suppressRowDrag:!1,suppressMoveWhenRowDragging:!1,rowDragEntireRow:!1,rowDragMultiRow:!1,embedFullWidthRows:!1,groupDisplayType:"singleColumn",groupDefaultExpanded:0,groupMaintainOrder:!1,groupSelectsChildren:!1,groupSuppressBlankHeader:!1,groupSelectsFiltered:!1,showOpenedGroup:!1,groupRemoveSingleChildren:!1,groupRemoveLowestSingleChildren:!1,groupHideOpenParents:!1,groupAllowUnbalanced:!1,rowGroupPanelShow:"never",suppressMakeColumnVisibleAfterUnGroup:!1,treeData:!1,rowGroupPanelSuppressSort:!1,suppressGroupRowsSticky:!1,rowModelType:"clientSide",asyncTransactionWaitMillis:50,suppressModelUpdateAfterUpdateTransaction:!1,cacheOverflowSize:1,infiniteInitialRowCount:1,serverSideInitialRowCount:1,cacheBlockSize:100,maxBlocksInCache:-1,maxConcurrentDatasourceRequests:2,blockLoadDebounceMillis:0,purgeClosedRowNodes:!1,serverSideSortAllLevels:!1,serverSideOnlyRefreshFilteredGroups:!1,serverSidePivotResultFieldSeparator:"_",viewportRowModelPageSize:5,viewportRowModelBufferSize:5,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,debounceVerticalScrollbar:!1,suppressHorizontalScroll:!1,suppressScrollOnNewData:!1,suppressScrollWhenPopupsAreOpen:!1,suppressAnimationFrame:!1,suppressMiddleClickScrolls:!1,suppressPreventDefaultOnMouseWheel:!1,rowMultiSelectWithClick:!1,suppressRowDeselection:!1,suppressRowClickSelection:!1,suppressCellFocus:!1,suppressHeaderFocus:!1,suppressMultiRangeSelection:!1,enableCellTextSelection:!1,enableRangeSelection:!1,enableRangeHandle:!1,enableFillHandle:!1,fillHandleDirection:"xy",suppressClearOnFillReduction:!1,accentedSort:!1,unSortIcon:!1,suppressMultiSort:!1,alwaysMultiSort:!1,suppressMaintainUnsortedOrder:!1,suppressRowHoverHighlight:!1,suppressRowTransform:!1,columnHoverHighlight:!1,deltaSort:!1,enableGroupEdit:!1,groupLockGroupColumns:0,serverSideEnableClientSideSort:!1,suppressServerSideFullWidthLoadingRow:!1,pivotMaxGeneratedColumns:-1,columnMenu:"new",reactiveCustomComponents:!0,suppressSetFilterByDefault:!1,rowNumbers:!1,enableFilterHandlers:!1},K6="https://www.ag-grid.com";function ro(e,t,...i){e.get("debug")&&console.log("AG Grid: "+t,...i)}function xd(e,...t){Hv(()=>console.warn("AG Grid: "+e,...t),e+t?.join(""))}function Ma(e,...t){Hv(()=>console.error("AG Grid: "+e,...t),e+t?.join(""))}var Y6=new Set,Lp={},Da={},bp,X6=!1,J6=!1,UO=!1;function qO(e){let[t,i]=e.version.split(".")||[],[n,s]=bp.split(".")||[];return t===n&&i===s}function $O(e){bp||(bp=e.version);let t=n=>`You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. ${n} Please update all modules to the same version.`;e.version?qO(e)||Ma(t(`'${e.moduleName}' is version ${e.version} but the other modules are version ${bp}.`)):Ma(t(`'${e.moduleName}' is incompatible.`));let i=e.validate?.();i&&!i.isValid&&Ma(`${i.message}`)}function _d(e,t,i=!1){i||(X6=!0),$O(e);let n=e.rowModels??["all"];Y6.add(e);let s;t!==void 0?(J6=!0,Da[t]===void 0&&(Da[t]={}),s=Da[t]):s=Lp;for(let o of n)s[o]===void 0&&(s[o]={}),s[o][e.moduleName]=e;if(e.dependsOn)for(let o of e.dependsOn)_d(o,t,i)}function jO(e){delete Da[e]}function ev(e,t,i){let n=s=>!!Lp[s]?.[e]||!!Da[t]?.[s]?.[e];return n(i)||n("all")}function Gv(){return J6}function KO(e,t){let i=Da[e]??{};return[...Object.values(Lp.all??{}),...Object.values(i.all??{}),...Object.values(Lp[t]??{}),...Object.values(i[t]??{})]}function YO(){return new Set(Y6)}function XO(){return X6}function Q6(){return UO}var Z6=class{static register(e){_d(e,void 0)}static registerModules(e){for(let t of e)_d(t,void 0)}},q="34.3.1",hR=2e3,pR=100,e4="_version_",t4=null,ka=`${K6}/javascript-data-grid`;function JO(e){t4=e}function QO(e){ka=e}function i4(e,t,i){return t4?.(e,t)??[iN(e,t,i)]}function zv(e,t,i,n,s){e(`${n?"warning":"error"} #${t}`,...i4(t,i,s))}function ZO(e){if(!e)return String(e);let t={};for(let i of Object.keys(e))typeof e[i]!="object"&&typeof e[i]!="function"&&(t[i]=e[i]);return JSON.stringify(t)}function eN(e){let t=e;return e instanceof Error?t=e.toString():typeof e=="object"&&(t=ZO(e)),t}function Op(e){return e===void 0?"undefined":e===null?"null":e}function tv(e,t){return`${e}?${t.toString()}`}function tN(e,t,i){let n=Array.from(t.entries()).sort((o,r)=>r[1].length-o[1].length),s=tv(e,t);for(let[o,r]of n){if(o===e4)continue;let a=s.length-i;if(a<=0)break;let l="...",d=a+l.length,c=r.length-d>pR?r.slice(0,r.length-d)+l:r.slice(0,pR)+l;t.set(o,c),s=tv(e,t)}return s}function n4(e,t){let i=new URLSearchParams;if(i.append(e4,q),t)for(let o of Object.keys(t))i.append(o,eN(t[o]));let n=`${ka}/errors/${e}`,s=tv(n,i);return s.length<=hR?s:tN(n,i,hR)}var iN=(e,t,i)=>{let n=n4(e,t),s=`${i?i+` 
`:""}Visit ${n}`;return Q6()?s:`${s}${i?"":` 
  Alternatively register the ValidationModule to see the full message in the console.`}`};function I(...e){zv(xd,e[0],e[1],!0)}function Ge(...e){zv(Ma,e[0],e[1],!1)}function Cd(e,t,i){zv(Ma,e,t,!1,i)}function nN(e,t){let i=t[0];return`error #${i} `+i4(i,t[1],e).join(" ")}function Hn(...e){return nN(void 0,e)}function s4(e,t){return e.get("rowModelType")===t}function wt(e,t){return s4(e,"clientSide")}function Ua(e,t){return s4(e,"serverSide")}function jt(e,t){return e.get("domLayout")===t}function tr(e){return Bp(e)!==void 0}function o4(e){return typeof e.get("getRowHeight")=="function"}function sN(e,t){return t?!e.get("enableStrictPivotColumnOrder"):e.get("maintainColumnOrder")}function ao(e,t,i=!1,n){let{gos:s,environment:o}=e;if(n==null&&(n=o.getDefaultRowHeight()),o4(s)){if(i)return{height:n,estimated:!0};let l={node:t,data:t.data},d=s.getCallback("getRowHeight")(l);if(iv(d))return d===0&&I(23),{height:Math.max(1,d),estimated:!1}}if(t.detail&&s.get("masterDetail"))return oN(s);let r=s.get("rowHeight");return{height:r&&iv(r)?r:n,estimated:!1}}function oN(e){if(e.get("detailRowAutoHeight"))return{height:1,estimated:!1};let t=e.get("detailRowHeight");return iv(t)?{height:t,estimated:!1}:{height:300,estimated:!1}}function ir(e){let{environment:t,gos:i}=e,n=i.get("rowHeight");if(!n||tt(n))return t.getDefaultRowHeight();let s=t.refreshRowHeightVariable();return s!==-1?s:(I(24),t.getDefaultRowHeight())}function iv(e){return!isNaN(e)&&typeof e=="number"&&isFinite(e)}function r4(e,t,i){let n=t[e.getDomDataKey()];return n?n[i]:void 0}function ar(e,t,i,n){let s=e.getDomDataKey(),o=t[s];tt(o)&&(o={},t[s]=o),o[i]=n}function Pa(e){return e.get("ensureDomOrder")?!1:e.get("animateRows")}function a4(e){return!(e.get("paginateChildRows")||e.get("groupHideOpenParents")||jt(e,"print"))}function Ln(e){return!e.get("autoGroupColumnDef")?.comparator&&!e.get("treeData")}function nv(e){let t=e.get("groupAggFiltering");if(typeof t=="function")return e.getCallback("groupAggFiltering");if(t===!0)return()=>!0}function l4(e){return e.get("grandTotalRow")}function d4(e,t){return t?!1:e.get("groupDisplayType")==="groupRows"}function c4(e,t,i){return!!t.group&&!t.footer&&d4(e,i)}function Ba(e){let t=e.getCallback("getRowId");return t===void 0?t:i=>{let n=t(i);return typeof n!="string"&&(Hv(()=>I(25,{id:n}),"getRowIdString"),n=String(n)),n}}function rN(e,t){let i=e.get("groupHideParentOfSingleChild");return!!(i===!0||i==="leafGroupsOnly"&&t.leafGroup||e.get("groupRemoveSingleChildren")||e.get("groupRemoveLowestSingleChildren")&&t.leafGroup)}function aN(e){let t=e.get("maxConcurrentDatasourceRequests");return t>0?t:void 0}function Fa(e){return e?.checkboxes??!0}function yp(e){return e?.mode==="multiRow"&&(e.headerCheckbox??!0)}function Np(e){if(typeof e=="object")return e.checkboxLocation??"selectionColumn"}function vC(e){return e?.hideDisabledCheckboxes??!1}function lN(e){return typeof e.get("rowSelection")!="string"}function Ds(e){let t=e.get("cellSelection");return t!==void 0?!!t:e.get("enableRangeSelection")}function u4(e){let t=e.get("rowSelection")??"single";if(typeof t=="string"){let i=e.get("suppressRowClickSelection"),n=e.get("suppressRowDeselection");return i&&n?!1:i?"enableDeselection":n?"enableSelection":!0}return t.mode==="singleRow"||t.mode==="multiRow"?t.enableClickSelection??!1:!1}function dN(e){let t=u4(e);return t===!0||t==="enableSelection"}function cN(e){let t=u4(e);return t===!0||t==="enableDeselection"}function sv(e){let t=e.get("rowSelection");return typeof t=="string"?e.get("isRowSelectable"):t?.isRowSelectable}function Bp(e){let t="beanName"in e&&e.beanName==="gos"?e.get("rowSelection"):e.rowSelection;if(typeof t=="string")switch(t){case"multiple":return"multiRow";case"single":return"singleRow";default:return}switch(t?.mode){case"multiRow":case"singleRow":return t.mode;default:return}}function Ld(e){return Bp(e)==="multiRow"}function uN(e){let t=e.get("rowSelection");return typeof t=="string"?e.get("rowMultiSelectWithClick"):t?.enableSelectionWithoutKeys??!1}function Hp(e){let t=e.get("rowSelection");if(typeof t=="string"){let i=e.get("groupSelectsChildren"),n=e.get("groupSelectsFiltered");return i&&n?"filteredDescendants":i?"descendants":"self"}return t?.mode==="multiRow"?t.groupSelects:void 0}function h4(e,t=!0){let i=e.get("rowSelection");return typeof i!="object"?t?"all":void 0:i.mode==="multiRow"?i.selectAll:"all"}function hN(e){let t=e.get("rowSelection");return typeof t=="string"?!1:t?.mode==="multiRow"?t.ctrlASelectsRows??!1:!1}function Od(e){let t=Hp(e);return t==="descendants"||t==="filteredDescendants"}function gR(e){let t=e.get("rowSelection");return typeof t=="object"&&t.masterSelects||"self"}function pN(e){return e.isModuleRegistered("SetFilter")&&!e.get("suppressSetFilterByDefault")}function Ti(e){return e.get("columnMenu")==="legacy"}function gN(e){return!Ti(e)}function fN(e){return!e||e.length<2?e:"on"+e[0].toUpperCase()+e.substring(1)}function p4(e,t,i){typeof e!="object"&&(e={});let n=b({},e);for(let s of i){let o=t[s];typeof o<"u"&&(n[s]=o)}return n}function g4(e,t){if(!e)return;let i={},n=!1;for(let r of Object.keys(e))i[r]=e[r],n=!0;if(!n)return;let s={type:"gridOptionsChanged",options:i};t.dispatchEvent(s);let o=b({type:"componentStateChanged"},i);t.dispatchEvent(o)}function ae(e,t){return e.addCommon(t)}function fR({gos:e},t){return t.button===2||t.ctrlKey&&e.get("allowContextMenuWithControlKey")}var mN={resizable:!0,sortable:!0},CN=0;function f4(){return CN++}function lo(e){return e instanceof hr}var hr=class extends F{constructor(e,t,i,n){super(),this.colDef=e,this.userProvidedColDef=t,this.colId=i,this.primary=n,this.isColumn=!0,this.instanceId=f4(),this.autoHeaderHeight=null,this.moving=!1,this.resizing=!1,this.menuVisible=!1,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.colEventSvc=new rr,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.flex=null,this.colIdSanitised=wd(i)}destroy(){super.destroy(),this.beans.rowSpanSvc?.deregister(this)}getInstanceId(){return this.instanceId}setState(){let{colDef:e,beans:{sortSvc:t,pinnedCols:i,colFlex:n}}=this;t?.initCol(this);let s=e.hide;s!==void 0?this.visible=!s:this.visible=!e.initialHide,i?.initCol(this),n?.initCol(this)}setColDef(e,t,i){let n=e.spanRows!==this.colDef.spanRows;this.colDef=e,this.userProvidedColDef=t,this.initMinAndMaxWidths(),this.initDotNotation(),this.initTooltip(),n&&(this.beans.rowSpanSvc?.deregister(this),this.initRowSpan()),this.dispatchColEvent("colDefChanged",i)}getUserProvidedColDef(){return this.userProvidedColDef}getParent(){return this.parent}getOriginalParent(){return this.originalParent}postConstruct(){this.setState(),this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip(),this.initRowSpan(),this.addPivotListener()}initDotNotation(){let{gos:e,colDef:{field:t,tooltipField:i}}=this,n=e.get("suppressFieldDotNotation");this.fieldContainsDots=K(t)&&t.includes(".")&&!n,this.tooltipFieldContainsDots=K(i)&&i.includes(".")&&!n}initMinAndMaxWidths(){let e=this.colDef;this.minWidth=e.minWidth??this.beans.environment.getDefaultColumnMinWidth(),this.maxWidth=e.maxWidth??Number.MAX_SAFE_INTEGER}initTooltip(){this.beans.tooltipSvc?.initCol(this)}initRowSpan(){this.colDef.spanRows&&this.beans.rowSpanSvc?.register(this)}addPivotListener(){let e=this.beans.pivotColDefSvc,t=this.colDef.pivotValueColumn;!e||!t||this.addManagedListeners(t,{colDefChanged:i=>{let n=e.recreateColDef(this.colDef);this.setColDef(n,n,i.source)}})}resetActualWidth(e){let t=this.calculateColInitialWidth(this.colDef);this.setActualWidth(t,e,!0)}calculateColInitialWidth(e){let t,i=e.width,n=e.initialWidth;return i!=null?t=i:n!=null?t=n:t=200,Math.max(Math.min(t,this.maxWidth),this.minWidth)}isEmptyGroup(){return!1}isRowGroupDisplayed(e){return this.beans.showRowGroupCols?.isRowGroupDisplayed(this,e)??!1}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}getHighlighted(){return this.highlighted}__addEventListener(e,t){this.colEventSvc.addEventListener(e,t)}__removeEventListener(e,t){this.colEventSvc.removeEventListener(e,t)}addEventListener(e,t){this.frameworkEventListenerService=this.beans.frameworkOverrides.createLocalEventListenerWrapper?.(this.frameworkEventListenerService,this.colEventSvc);let i=this.frameworkEventListenerService?.wrap(e,t)??t;this.colEventSvc.addEventListener(e,i)}removeEventListener(e,t){let i=this.frameworkEventListenerService?.unwrap(e,t)??t;this.colEventSvc.removeEventListener(e,i)}createColumnFunctionCallbackParams(e){return ae(this.gos,{node:e,data:e.data,column:this,colDef:this.colDef})}isSuppressNavigable(e){return this.beans.cellNavigation?.isSuppressNavigable(this,e)??!1}isCellEditable(e){return this.beans.editSvc?.isCellEditable({rowNode:e,column:this})??!1}isSuppressFillHandle(){return!!this.colDef.suppressFillHandle}isAutoHeight(){return!!this.colDef.autoHeight}isAutoHeaderHeight(){return!!this.colDef.autoHeaderHeight}isRowDrag(e){return this.isColumnFunc(e,this.colDef.rowDrag)}isDndSource(e){return this.isColumnFunc(e,this.colDef.dndSource)}isCellCheckboxSelection(e){return this.beans.selectionSvc?.isCellCheckboxSelection(this,e)??!1}isSuppressPaste(e){return this.isColumnFunc(e,this.colDef?.suppressPaste??null)}isResizable(){return!!this.getColDefValue("resizable")}getColDefValue(e){return this.colDef[e]??mN[e]}isColumnFunc(e,t){if(typeof t=="boolean")return t;if(typeof t=="function"){let i=this.createColumnFunctionCallbackParams(e);return t(i)}return!1}createColumnEvent(e,t){return ae(this.gos,{type:e,column:this,columns:[this],source:t})}isMoving(){return this.moving}getSort(){return this.sort}isSortable(){return!!this.getColDefValue("sortable")}isSortAscending(){return this.sort==="asc"}isSortDescending(){return this.sort==="desc"}isSortNone(){return tt(this.sort)}isSorting(){return K(this.sort)}getSortIndex(){return this.sortIndex}isMenuVisible(){return this.menuVisible}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(e,t){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchColEvent("leftChanged",t))}isFilterActive(){return this.filterActive}isHovered(){return I(261),!!this.beans.colHover?.isHovered(this)}setFirstRightPinned(e,t){this.firstRightPinned!==e&&(this.firstRightPinned=e,this.dispatchColEvent("firstRightPinnedChanged",t))}setLastLeftPinned(e,t){this.lastLeftPinned!==e&&(this.lastLeftPinned=e,this.dispatchColEvent("lastLeftPinnedChanged",t))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return this.pinned==="left"||this.pinned==="right"}isPinnedLeft(){return this.pinned==="left"}isPinnedRight(){return this.pinned==="right"}getPinned(){return this.pinned}setVisible(e,t){let i=e===!0;this.visible!==i&&(this.visible=i,this.dispatchColEvent("visibleChanged",t)),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){return!this.getColDef().suppressSpanHeaderHeight}getFirstRealParent(){let e=this.getOriginalParent();for(;e?.isPadding();)e=e.getOriginalParent();return e}getColumnGroupPaddingInfo(){let e=this.getParent();if(!e?.isPadding())return{numberOfParents:0,isSpanningTotal:!1};let t=e.getPaddingLevel()+1,i=!0;for(;e;){if(!e.isPadding()){i=!1;break}e=e.getParent()}return{numberOfParents:t,isSpanningTotal:i}}getColDef(){return this.colDef}getDefinition(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){let t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}createBaseColDefParams(e){return ae(this.gos,{node:e,data:e.data,colDef:this.colDef,column:this})}getColSpan(e){if(tt(this.colDef.colSpan))return 1;let t=this.createBaseColDefParams(e),i=this.colDef.colSpan(t);return Math.max(i,1)}getRowSpan(e){if(tt(this.colDef.rowSpan))return 1;let t=this.createBaseColDefParams(e),i=this.colDef.rowSpan(t);return Math.max(i,1)}setActualWidth(e,t,i=!1){e=Math.max(e,this.minWidth),e=Math.min(e,this.maxWidth),this.actualWidth!==e&&(this.actualWidth=e,this.flex!=null&&t!=="flex"&&t!=="gridInitializing"&&(this.flex=null),i||this.fireColumnWidthChangedEvent(t)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(e){this.dispatchColEvent("widthChanged",e)}isGreaterThanMax(e){return e>this.maxWidth}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex}isRowGroupActive(){return this.rowGroupActive}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}isValueActive(){return this.aggregationActive}isAllowPivot(){return this.colDef.enablePivot===!0}isAllowValue(){return this.colDef.enableValue===!0}isAllowRowGroup(){return this.colDef.enableRowGroup===!0}dispatchColEvent(e,t,i){let n=this.createColumnEvent(e,t);i&&pi(n,i),this.colEventSvc.dispatchEvent(n)}dispatchStateUpdatedEvent(e){this.colEventSvc.dispatchEvent({type:"columnStateUpdated",key:e})}};function ri(e){return e instanceof Sp}var Sp=class extends F{constructor(e,t,i,n){super(),this.colGroupDef=e,this.groupId=t,this.padding=i,this.level=n,this.isColumn=!1,this.expandable=!1,this.instanceId=f4(),this.expandableListenerRemoveCallback=null,this.expanded=!!e?.openByDefault}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0),super.destroy()}reset(e,t){this.colGroupDef=e,this.level=t,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return this.children?this.children.some(e=>e.isVisible()):!1}isPadding(){return this.padding}setExpanded(e){this.expanded=e===void 0?!1:e,this.dispatchLocalEvent({type:"expandedChanged"})}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(e){this.children=e}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){let e=[];return this.addLeafColumns(e),e}forEachLeafColumn(e){if(this.children)for(let t of this.children)lo(t)?e(t):ri(t)&&t.forEachLeafColumn(e)}addLeafColumns(e){if(this.children)for(let t of this.children)lo(t)?e.push(t):ri(t)&&t.addLeafColumns(e)}getColumnGroupShow(){let e=this.colGroupDef;if(e)return e.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();let e=this.onColumnVisibilityChanged.bind(this);for(let t of this.getLeafColumns())t.__addEventListener("visibleChanged",e);this.expandableListenerRemoveCallback=()=>{for(let t of this.getLeafColumns())t.__removeEventListener("visibleChanged",e);this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let e=!1,t=!1,i=!1,n=this.findChildrenRemovingPadding();for(let o=0,r=n.length;o<r;o++){let a=n[o];if(!a.isVisible())continue;let l=a.getColumnGroupShow();l==="open"?(e=!0,i=!0):l==="closed"?(t=!0,i=!0):(e=!0,t=!0)}let s=e&&t&&i;this.expandable!==s&&(this.expandable=s,this.dispatchLocalEvent({type:"expandableChanged"}))}findChildrenRemovingPadding(){let e=[],t=i=>{for(let n of i)ri(n)&&n.isPadding()?t(n.children):e.push(n)};return t(this.children),e}onColumnVisibilityChanged(){this.setExpandable()}},vN={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}};function mR(e,t,i){let n={},s=e.gos;return Object.assign(n,s.get("defaultColGroupDef")),Object.assign(n,t),s.validateColDef(n,i),n}var wN=class{constructor(){this.existingKeys={}}addExistingKeys(e){for(let t=0;t<e.length;t++)this.existingKeys[e[t]]=!0}getUniqueKey(e,t){e=JC(e);let i=0;for(;;){let n=e??t;if(n?i!==0&&(n+="_"+i):n=i,!this.existingKeys[n]){let s=String(n);return e&&i>0&&I(273,{providedId:e,usedId:s}),this.existingKeys[s]=!0,s}i++}}},rhe=Object.freeze([]);function je(e){if(e?.length)return e[e.length-1]}function ho(e,t,i){if(e===t)return!0;if(!e||!t)return e==null&&t==null;let n=e.length;if(n!==t.length)return!1;for(let s=0;s<n;s++)if(e[s]!==t[s]&&!i?.(e[s],t[s]))return!1;return!0}function ud(e,t){if(e)for(let i of e)t(i)}function an(e,t){let i=e.indexOf(t);i>=0&&e.splice(i,1)}function CR(e,t,i){for(let n=0;n<t.length;n++)an(e,t[n]);for(let n=t.length-1;n>=0;n--)e.splice(i,0,t[n])}var eg="ag-Grid-AutoColumn",m4="ag-Grid-SelectionColumn",C4="ag-Grid-RowNumbersColumn";function v4(e){let t=[],i=n=>{for(let s=0;s<n.length;s++){let o=n[s];lo(o)?t.push(o):ri(o)&&i(o.getChildren())}};return i(e),t}function ys(e){return e.reduce((t,i)=>t+i.getActualWidth(),0)}function Vp(e,t,i){let n={};if(!t)return;Rs(null,t,o=>{n[o.getInstanceId()]=o}),i&&Rs(null,i,o=>{n[o.getInstanceId()]=null});let s=Object.values(n).filter(o=>o!=null);e.context.destroyBeans(s)}function Wv(e){return e.getId().startsWith(eg)}function Fs(e){return(typeof e=="string"?e:"getColId"in e?e.getColId():e.colId)?.startsWith(m4)??!1}function Es(e){return(typeof e=="string"?e:"getColId"in e?e.getColId():e.colId)?.startsWith(C4)??!1}function bN(e){return Fs(e)||Es(e)}function Gp(e){let t=[];return e instanceof Array?t=e:typeof e=="string"&&(t=e.split(",")),t}function yN(e,t){return ho(e,t,(i,n)=>i.getColId()===n.getColId())}function SN(e){e.map={};for(let t of e.list)e.map[t.getId()]=t}function Ta(e){return e==="optionsUpdated"?"gridOptionsChanged":e}function Ed(e,t){let i=e===t,n=e.getColDef()===t,s=e.getColId()==t;return i||n||s}var xN=(e,t)=>(i,n)=>{let s={value1:void 0,value2:void 0},o=!1;return e&&(e[i]!==void 0&&(s.value1=e[i],o=!0),K(n)&&e[n]!==void 0&&(s.value2=e[n],o=!0)),!o&&t&&(t[i]!==void 0&&(s.value1=t[i]),K(n)&&t[n]!==void 0&&(s.value2=t[n])),s},EN=(e,t)=>{ri(e)&&e.setupExpandable(),e.originalParent=t};function RN(e,t=null,i,n,s){let o=new wN,{existingCols:r,existingGroups:a,existingColKeys:l}=MN(n);o.addExistingKeys(l);let d=w4(e,t,0,i,r,o,a,s),{colGroupSvc:c}=e,u=c?.findMaxDepth(d,0)??0,h=c?c.balanceColumnTree(d,0,u,o):d;return Rs(null,h,EN),{columnTree:h,treeDepth:u}}function MN(e){let t=[],i=[],n=[];return e&&Rs(null,e,s=>{if(ri(s)){let o=s;i.push(o)}else{let o=s;n.push(o.getId()),t.push(o)}}),{existingCols:t,existingGroups:i,existingColKeys:n}}function w4(e,t,i,n,s,o,r,a){if(!t)return[];let{colGroupSvc:l}=e,d=new Array(t.length);for(let c=0;c<d.length;c++){let u=t[c];l&&AN(u)?d[c]=l.createProvidedColumnGroup(n,u,i,s,o,r,a):d[c]=DN(e,n,u,s,o,a)}return d}function DN(e,t,i,n,s,o){let r=PN(i,n);r&&n?.splice(r.idx,1);let a=r?.column;if(a){let l=ov(e,i,a.getColId());a.setColDef(l,i,o),kN(e,a,l,o)}else{let l=s.getUniqueKey(i.colId,i.field),d=ov(e,i,l);a=new hr(d,i,l,t),e.context.createBean(a)}return e.dataTypeSvc?.addColumnListeners(a),a}function b4(e,t,i,n,s,o,r,a){let{sortSvc:l,pinnedCols:d,colFlex:c}=e;i!==void 0&&t.setVisible(!i,a),l&&(l.updateColSort(t,n,a),s!==void 0&&l.setColSortIndex(t,s)),o!==void 0&&d?.setColPinned(t,o),r!==void 0&&c?.setColFlex(t,r)}function kN(e,t,i,n){b4(e,t,i.hide,i.sort,i.sortIndex,i.pinned,i.flex,n);let s=t.getFlex();if(!(s!=null&&s>0))if(i.width!=null)t.setActualWidth(i.width,n);else{let o=t.getActualWidth();t.setActualWidth(o,n)}}function PN(e,t){if(t)for(let i=0;i<t.length;i++){let n=t[i].getUserProvidedColDef();if(!n)continue;if(e.colId!=null){if(t[i].getId()===e.colId)return{idx:i,column:t[i]};continue}if(e.field!=null){if(n.field===e.field)return{idx:i,column:t[i]};continue}if(n===e)return{idx:i,column:t[i]}}}function ov(e,t,i,n){let{gos:s,dataTypeSvc:o}=e,r={},a=s.get("defaultColDef");pi(r,a,!1,!0);let l=FN(e,r,t,i);l&&TN(e,l,r);let d=r.cellDataType;pi(r,t,!1,!0),d!==void 0&&(r.cellDataType=d);let c=s.get("autoGroupColumnDef"),u=Ln(s);return t.rowGroup&&c&&u&&pi(r,{sort:c.sort,initialSort:c.initialSort},!1,!0),o&&(o.postProcess(r),o.validateColDef(r)),s.validateColDef(r,i,n),r}function FN(e,t,i,n){let s=e.dataTypeSvc?.updateColDefAndGetColumnType(t,i,n),o=i.type??s??t.type;return t.type=o,o?Gp(o):void 0}function TN(e,t,i){if(!t.length)return;let n=Object.assign({},vN),s=e.gos.get("columnTypes")||{};for(let o of Object.keys(s)){let r=s[o];o in n?I(34,{key:o}):(r.type&&I(35),n[o]=r)}for(let o of t){let r=n[o.trim()];r?pi(i,r,!1,!0):I(36,{t:o})}}function AN(e){return e.children!==void 0}function Rs(e,t,i){if(t)for(let n=0;n<t.length;n++){let s=t[n];ri(s)&&Rs(s,s.getChildren(),i),i(s,e)}}function y4(e,t){let i=[],n=[],s=[];return e.forEach(r=>{let a=r.getColDef().lockPosition;a==="right"?s.push(r):a==="left"||a===!0?i.push(r):n.push(r)}),t.get("enableRtl")?[...s,...n,...i]:[...i,...n,...s]}function S4(e,t){let i=!0;return Rs(null,t,n=>{if(!ri(n))return;let s=n;if(!s.getColGroupDef()?.marryChildren)return;let a=[];for(let h of s.getLeafColumns()){let p=e.indexOf(h);a.push(p)}let l=Math.max.apply(Math,a),d=Math.min.apply(Math,a),c=l-d,u=s.getLeafColumns().length-1;c>u&&(i=!1)}),i}function x4(e,t){if(!e||e.length==0)return;let i=t(e[0]);for(let n=1;n<e.length;n++)if(i!==t(e[n]))return;return i}function E4(e,t,i){if(!t.length)return;let n=t.length===1?t[0]:null,s=x4(t,o=>o.getPinned());e.dispatchEvent({type:"columnPinned",pinned:s??null,columns:t,column:n,source:i})}function IN(e,t,i){if(!t.length)return;let n=t.length===1?t[0]:null,s=x4(t,o=>o.isVisible());e.dispatchEvent({type:"columnVisible",visible:s,columns:t,column:n,source:i})}function _N(e,t,i,n){e.dispatchEvent({type:t,columns:i,column:i&&i.length==1?i[0]:null,source:n})}function Ha(e,t,i,n,s=null){t?.length&&e.dispatchEvent({type:"columnResized",columns:t,column:t.length===1?t[0]:null,flexColumns:s,finished:i,source:n})}function rn(e,t,i){let{colModel:n,rowGroupColsSvc:s,pivotColsSvc:o,autoColSvc:r,selectionColSvc:a,colAnimation:l,visibleCols:d,pivotResultCols:c,environment:u,valueColsSvc:h,eventSvc:p,gos:g}=e,f=n.getColDefCols()??[],m=a?.getColumns();if(!f.length&&!m?.length)return!1;if(t?.state&&!t.state.forEach)return I(32),!1;let C=(S,x,E,T,L)=>{if(!S)return;let N=xN(x,t.defaultState),$=N("flex").value1;if(b4(e,S,N("hide").value1,N("sort").value1,N("sortIndex").value1,N("pinned").value1,$,i),$==null){let G=N("width").value1;if(G!=null){let se=S.getColDef().minWidth??u.getDefaultColumnMinWidth();se!=null&&G>=se&&S.setActualWidth(G,i)}}L||!S.isPrimary()||(h?.syncColumnWithState(S,i,N),s?.syncColumnWithState(S,i,N,E),o?.syncColumnWithState(S,i,N,T))},v=(S,x,E)=>{let T=R4(e,i),L=x.slice(),N={},$={},G=[],se=[],ve=[],me=0,dt=s?.columns.slice()??[],xi=o?.columns.slice()??[];for(let He of S){let kt=He.colId;if(kt.startsWith(eg)){G.push(He),ve.push(He);continue}if(Fs(kt)){se.push(He),ve.push(He);continue}let It=E(kt);It?(C(It,He,N,$,!1),an(L,It)):(ve.push(He),me+=1)}let Le=He=>C(He,null,N,$,!1);L.forEach(Le),s?.sortColumns(vR.bind(s,N,dt)),o?.sortColumns(vR.bind(o,$,xi)),n.refreshCols(!1,i);let Je=(He,kt,Pt=[])=>{for(let It of kt){let Fw=He(It.colId);an(Pt,Fw),C(Fw,It,null,null,!0)}Pt.forEach(Le)};return Je(He=>r?.getColumn(He)??null,G,r?.getColumns()?.slice()),Je(He=>a?.getColumn(He)??null,se,a?.getColumns()?.slice()),ON(t,n,g),d.refresh(i),p.dispatchEvent({type:"columnEverythingChanged",source:i}),T(),{unmatchedAndAutoStates:ve,unmatchedCount:me}};l?.start();let{unmatchedAndAutoStates:w,unmatchedCount:y}=v(t.state||[],f,S=>n.getColDefCol(S));if(w.length>0||K(t.defaultState)){let S=c?.getPivotResultCols()?.list??[];y=v(w,S,x=>c?.getPivotResultCol(x)??null).unmatchedCount}return l?.finish(),y===0}function LN(e,t){let{colModel:i,autoColSvc:n,selectionColSvc:s,eventSvc:o,gos:r}=e,a=i.getColDefCols();if(!a?.length)return;let l=i.getColDefColTree(),d=v4(l),c=[],u=1e3,h=1e3,p=v=>{let w=M4(v);tt(w.rowGroupIndex)&&w.rowGroup&&(w.rowGroupIndex=u++),tt(w.pivotIndex)&&w.pivot&&(w.pivotIndex=h++),c.push(w)};n?.getColumns()?.forEach(p),s?.getColumns()?.forEach(p),d?.forEach(p),rn(e,{state:c},t);let g=n?.getColumns()??[],C=[...s?.getColumns()??[],...g,...a].map(v=>({colId:v.colId}));rn(e,{state:C,applyOrder:!0},t),o.dispatchEvent(ae(r,{type:"columnsReset",source:t}))}function R4(e,t){let{rowGroupColsSvc:i,pivotColsSvc:n,valueColsSvc:s,colModel:o,sortSvc:r,eventSvc:a}=e,l={rowGroupColumns:i?.columns.slice()??[],pivotColumns:n?.columns.slice()??[],valueColumns:s?.columns.slice()??[]},d=zp(e),c={};for(let u of d)c[u.colId]=u;return()=>{let u=(x,E,T,L)=>{let N=E.map(L),$=T.map(L);if(ho(N,$))return;let se=new Set(E);for(let me of T)se.delete(me)||se.add(me);let ve=[...se];a.dispatchEvent({type:x,columns:ve,column:ve.length===1?ve[0]:null,source:t})},h=x=>{let E=[];return o.forAllCols(T=>{let L=c[T.getColId()];L&&x(L,T)&&E.push(T)}),E},p=x=>x.getColId();u("columnRowGroupChanged",l.rowGroupColumns,i?.columns??[],p),u("columnPivotChanged",l.pivotColumns,n?.columns??[],p);let f=h((x,E)=>{let T=x.aggFunc!=null,L=T!=E.isValueActive(),N=T&&x.aggFunc!=E.getAggFunc();return L||N});f.length>0&&_N(a,"columnValueChanged",f,t),Ha(a,h((x,E)=>x.width!=E.getActualWidth()),!0,t),E4(a,h((x,E)=>x.pinned!=E.getPinned()),t),IN(a,h((x,E)=>x.hide==E.isVisible()),t);let y=h((x,E)=>x.sort!=E.getSort()||x.sortIndex!=E.getSortIndex());y.length>0&&r?.dispatchSortChangedEvents(t,y);let S=zp(e);BN(d,S,t,o,a)}}function zp(e){let{colModel:t,rowGroupColsSvc:i,pivotColsSvc:n}=e,s=t.getColDefCols();if(tt(s)||!t.isAlive())return[];let o=i?.columns,r=n?.columns,a=[],l=c=>{let u=c.isRowGroupActive()&&o?o.indexOf(c):null,h=c.isPivotActive()&&r?r.indexOf(c):null,p=c.isValueActive()?c.getAggFunc():null,g=c.getSort()!=null?c.getSort():null,f=c.getSortIndex()!=null?c.getSortIndex():null;a.push({colId:c.getColId(),width:c.getActualWidth(),hide:!c.isVisible(),pinned:c.getPinned(),sort:g,sortIndex:f,aggFunc:p,rowGroup:c.isRowGroupActive(),rowGroupIndex:u,pivot:c.isPivotActive(),pivotIndex:h,flex:c.getFlex()??null})};t.forAllCols(c=>l(c));let d=new Map(t.getCols().map((c,u)=>[c.getColId(),u]));return a.sort((c,u)=>{let h=d.has(c.colId)?d.get(c.colId):-1,p=d.has(u.colId)?d.get(u.colId):-1;return h-p}),a}function M4(e){let t=(g,f)=>g??f??null,i=e.getColDef(),n=t(i.sort,i.initialSort),s=t(i.sortIndex,i.initialSortIndex),o=t(i.hide,i.initialHide),r=t(i.pinned,i.initialPinned),a=t(i.width,i.initialWidth),l=t(i.flex,i.initialFlex),d=t(i.rowGroupIndex,i.initialRowGroupIndex),c=t(i.rowGroup,i.initialRowGroup);d==null&&!c&&(d=null,c=null);let u=t(i.pivotIndex,i.initialPivotIndex),h=t(i.pivot,i.initialPivot);u==null&&!h&&(u=null,h=null);let p=t(i.aggFunc,i.initialAggFunc);return{colId:e.getColId(),sort:n,sortIndex:s,hide:o,pinned:r,width:a,flex:l,rowGroup:c,rowGroupIndex:d,pivot:h,pivotIndex:u,aggFunc:p}}function ON(e,t,i){if(!e.applyOrder||!e.state)return;let n=[];for(let s of e.state)s.colId!=null&&n.push(s.colId);NN(t.cols,n,t,i)}function NN(e,t,i,n){if(e==null)return;let s=[],o={};for(let a of t){if(o[a])continue;let l=e.map[a];l&&(s.push(l),o[a]=!0)}let r=0;for(let a of e.list){let l=a.getColId();if(o[l]!=null)continue;l.startsWith(eg)?s.splice(r++,0,a):s.push(a)}if(s=y4(s,n),!S4(s,i.getColTree())){I(39);return}e.list=s}function BN(e,t,i,n,s){let o={};for(let c of t)o[c.colId]=c;let r={};for(let c of e)o[c.colId]&&(r[c.colId]=!0);let a=e.filter(c=>r[c.colId]),l=t.filter(c=>r[c.colId]),d=[];l.forEach((c,u)=>{let h=a?.[u];if(h&&h.colId!==c.colId){let p=n.getCol(h.colId);p&&d.push(p)}}),d.length&&s.dispatchEvent({type:"columnMoved",columns:d,column:d.length===1?d[0]:null,finished:!0,source:i})}var vR=(e,t,i,n)=>{let s=e[i.getId()],o=e[n.getId()],r=s!=null,a=o!=null;if(r&&a)return s-o;if(r)return-1;if(a)return 1;let l=t.indexOf(i),d=t.indexOf(n),c=l>=0,u=d>=0;return c&&u?l-d:c?-1:1},HN=class extends F{constructor(){super(...arguments),this.beanName="colModel",this.pivotMode=!1,this.ready=!1,this.changeEventsDispatching=!1}postConstruct(){this.pivotMode=this.gos.get("pivotMode"),this.addManagedPropertyListeners(["groupDisplayType","treeData","treeDataDisplayType","groupHideOpenParents","rowNumbers","hidePaddedHeaderRows"],e=>this.refreshAll(Ta(e.source))),this.addManagedPropertyListeners(["defaultColDef","defaultColGroupDef","columnTypes","suppressFieldDotNotation"],this.recreateColumnDefs.bind(this)),this.addManagedPropertyListener("pivotMode",e=>this.setPivotMode(this.gos.get("pivotMode"),Ta(e.source)))}createColsFromColDefs(e){let{beans:t}=this,{valueCache:i,colAutosize:n,rowGroupColsSvc:s,pivotColsSvc:o,valueColsSvc:r,visibleCols:a,eventSvc:l,groupHierarchyColSvc:d}=t,c=this.colDefs?R4(t,e):void 0;i?.expire();let u=this.colDefCols?.list,h=this.colDefCols?.tree,p=RN(t,this.colDefs,!0,h,e);Vp(t,this.colDefCols?.tree,p.columnTree);let g=p.columnTree,f=p.treeDepth,m=v4(g),C={};for(let v of m)C[v.getId()]=v;this.colDefCols={tree:g,treeDepth:f,list:m,map:C},this.createColumnsForService([d],this.colDefCols,e),s?.extractCols(e,u),o?.extractCols(e,u),r?.extractCols(e,u),this.ready=!0,this.refreshCols(!0,e),a.refresh(e),l.dispatchEvent({type:"columnEverythingChanged",source:e}),c&&(this.changeEventsDispatching=!0,c(),this.changeEventsDispatching=!1),l.dispatchEvent({type:"newColumnsLoaded",source:e}),e==="gridInitializing"&&n?.applyAutosizeStrategy()}refreshCols(e,t){if(!this.colDefCols)return;let i=this.cols?.tree;this.saveColOrder();let{autoColSvc:n,selectionColSvc:s,rowNumbersSvc:o,quickFilter:r,pivotResultCols:a,showRowGroupCols:l,rowAutoHeight:d,visibleCols:c,colViewport:u,eventSvc:h}=this.beans,p=this.selectCols(a,this.colDefCols);this.createColumnsForService([n,s,o],p,t);let g=sN(this.gos,this.showingPivotResult);(!e||g)&&this.restoreColOrder(p),this.positionLockedCols(p),l?.refresh(),r?.refreshCols(),this.setColSpanActive(),d?.setAutoHeightActive(p),c.clear(),u.clear(),!ho(i,this.cols.tree)&&h.dispatchEvent({type:"gridColumnsChanged"})}createColumnsForService(e,t,i){for(let n of e)n&&(n.createColumns(t,s=>{this.lastOrder=s(this.lastOrder),this.lastPivotOrder=s(this.lastPivotOrder)},i),n.addColumns(t))}selectCols(e,t){let i=e?.getPivotResultCols()??null;this.showingPivotResult=i!=null;let{map:n,list:s,tree:o,treeDepth:r}=i??t;return this.cols={list:s.slice(),map:b({},n),tree:o.slice(),treeDepth:r},i&&(i.list.some(l=>this.cols?.map[l.getColId()]!==void 0)||(this.lastPivotOrder=null)),this.cols}getColsToShow(){if(!this.cols)return[];let{valueColsSvc:e,selectionColSvc:t,gos:i}=this.beans,n=this.isPivotMode()&&!this.showingPivotResult,s=t?.isSelectionColumnEnabled(),o=i.get("rowNumbers"),r=e?.columns;return this.cols.list.filter(l=>{let d=Wv(l);if(n){let c=r?.includes(l);return d||c||s&&Fs(l)||o&&Es(l)}else return d||l.isVisible()})}refreshAll(e){this.ready&&(this.refreshCols(!1,e),this.beans.visibleCols.refresh(e))}setColsVisible(e,t=!1,i){rn(this.beans,{state:e.map(n=>({colId:typeof n=="string"?n:n.getColId(),hide:!t}))},i)}restoreColOrder(e){let t=this.showingPivotResult?this.lastPivotOrder:this.lastOrder;if(!t)return;let i=t.filter(u=>e.map[u.getId()]!=null);if(i.length===0)return;if(i.length===e.list.length){e.list=i;return}let n=u=>{let h=u.getOriginalParent();return h?h.getChildren().length>1?!0:n(h):!1};if(!i.some(u=>n(u))){let u=new Set(i);for(let h of e.list)u.has(h)||i.push(h);e.list=i;return}let s=new Map;for(let u=0;u<i.length;u++){let h=i[u];s.set(h,u)}let o=e.list.filter(u=>!s.has(u));if(o.length===0){e.list=i;return}let r=(u,h)=>{let p=h?h.getOriginalParent():u.getOriginalParent();if(!p)return null;let g=null,f=null;for(let m of p.getChildren())if(!(m===h||m===u)){if(m instanceof hr){let C=s.get(m);if(C==null)continue;(g==null||g<C)&&(g=C,f=m);continue}m.forEachLeafColumn(C=>{let v=s.get(C);v!=null&&(g==null||g<v)&&(g=v,f=C)})}return f??r(u,p)},a=[],l=new Map;for(let u of o){let h=r(u,null);if(h==null){a.push(u);continue}let p=l.get(h);p===void 0?l.set(h,u):Array.isArray(p)?p.push(u):l.set(h,[p,u])}let d=new Array(e.list.length),c=d.length-1;for(let u=a.length-1;u>=0;u--)d[c--]=a[u];for(let u=i.length-1;u>=0;u--){let h=i[u],p=l.get(h);if(p)if(Array.isArray(p))for(let g=p.length-1;g>=0;g--){let f=p[g];d[c--]=f}else d[c--]=p;d[c--]=h}e.list=d}positionLockedCols(e){e.list=y4(e.list,this.gos)}saveColOrder(){this.showingPivotResult?this.lastPivotOrder=this.cols?.list??null:this.lastOrder=this.cols?.list??null}getColumnDefs(e){return this.colDefCols&&this.beans.colDefFactory?.getColumnDefs(this.colDefCols.list,this.showingPivotResult,this.lastOrder,this.cols?.list??[],e)}setColSpanActive(){this.colSpanActive=!!this.cols?.list.some(e=>e.getColDef().colSpan!=null)}isPivotMode(){return this.pivotMode}setPivotMode(e,t){if(e===this.pivotMode||(this.pivotMode=e,!this.ready))return;this.refreshCols(!1,t);let{visibleCols:i,eventSvc:n}=this.beans;i.refresh(t),n.dispatchEvent({type:"columnPivotModeChanged"})}isPivotActive(){let e=this.beans.pivotColsSvc?.columns;return this.pivotMode&&!!e?.length}recreateColumnDefs(e){if(!this.cols)return;this.beans.autoColSvc?.updateColumns(e);let t=Ta(e.source);this.createColsFromColDefs(t)}setColumnDefs(e,t){this.colDefs=e,this.createColsFromColDefs(t)}destroy(){Vp(this.beans,this.colDefCols?.tree),super.destroy()}getColTree(){return this.cols?.tree??[]}getColDefColTree(){return this.colDefCols?.tree??[]}getColDefCols(){return this.colDefCols?.list??null}getCols(){return this.cols?.list??[]}forAllCols(e){let{pivotResultCols:t,autoColSvc:i,selectionColSvc:n,groupHierarchyColSvc:s}=this.beans;ud(this.colDefCols?.list,e),ud(i?.columns?.list,e),ud(n?.columns?.list,e),ud(s?.columns?.list,e),ud(t?.getPivotResultCols()?.list,e)}getColsForKeys(e){return e?e.map(t=>this.getCol(t)).filter(t=>t!=null):[]}getColDefCol(e){return this.colDefCols?.list?this.getColFromCollection(e,this.colDefCols):null}getCol(e){return e==null?null:this.getColFromCollection(e,this.cols)}getColById(e){return this.cols?.map[e]??null}getColFromCollection(e,t){if(t==null)return null;let{map:i,list:n}=t;if(typeof e=="string"&&i[e])return i[e];for(let a=0;a<n.length;a++)if(Ed(n[a],e))return n[a];let{autoColSvc:s,selectionColSvc:o,groupHierarchyColSvc:r}=this.beans;return s?.getColumn(e)??o?.getColumn(e)??r?.getColumn(e)??null}};var D4=class{constructor(){this.existingIds={}}getInstanceIdForKey(e){let t=this.existingIds[e],i;return typeof t!="number"?i=0:i=t+1,this.existingIds[e]=i,i}};function Ud(e,t,i){return i&&e.addDestroyFunc(()=>t.destroyBean(i)),i??e}var U=null;function wR(e){return typeof e?.getGui=="function"}var k4=class{constructor(e){this.cssClassStates={},this.getGui=e}toggleCss(e,t){if(!e)return;if(e.indexOf(" ")>=0){let n=(e||"").split(" ");if(n.length>1){for(let s of n)this.toggleCss(s,t);return}}this.cssClassStates[e]!==t&&e.length&&(this.getGui()?.classList.toggle(e,t),this.cssClassStates[e]=t)}},VN=0,qd=class extends zn{constructor(e,t){super(),this.suppressDataRefValidation=!1,this.displayed=!0,this.visible=!0,this.compId=VN++,this.cssManager=new k4(()=>this.eGui),this.componentSelectors=new Map((t??[]).map(i=>[i.selector,i])),e&&this.setTemplate(e)}preConstruct(){this.wireTemplate(this.getGui());let e="component-"+Object.getPrototypeOf(this)?.constructor?.name;for(let t of this.css??[])this.beans.environment.addGlobalCSS(t,e)}wireTemplate(e,t){e&&this.gos&&(this.applyElementsToComponent(e),this.createChildComponentsFromTags(e,t))}getCompId(){return this.compId}getDataRefAttribute(e){return e.getAttribute?e.getAttribute(W6):null}applyElementsToComponent(e,t,i,n=null){if(t===void 0&&(t=this.getDataRefAttribute(e)),t){let s=this[t];if(s===U)this[t]=n??e;else{let o=i?.[t];if(!this.suppressDataRefValidation&&!o)throw new Error(`data-ref: ${t} on ${this.constructor.name} with ${s}`)}}}createChildComponentsFromTags(e,t){let i=[];for(let n of e.childNodes??[])i.push(n);for(let n of i){if(!(n instanceof HTMLElement))continue;let s=this.createComponentFromElement(n,o=>{let r=o.getGui();if(r)for(let a of n.attributes??[])r.setAttribute(a.name,a.value)},t);if(s){if(s.addItems&&n.children.length){this.createChildComponentsFromTags(n,t);let o=Array.prototype.slice.call(n.children);s.addItems(o)}this.swapComponentForNode(s,e,n)}else n.childNodes&&this.createChildComponentsFromTags(n,t)}}createComponentFromElement(e,t,i){let n=e.nodeName,s=this.getDataRefAttribute(e),o=n.indexOf("AG-")===0,r=o?this.componentSelectors.get(n):null,a=null;if(r){let l=i&&s?i[s]:void 0;a=new r.component(l),a.setParentComponent(this),this.createBean(a,null,t)}else if(o)throw new Error(`selector: ${n}`);return this.applyElementsToComponent(e,s,i,a),a}swapComponentForNode(e,t,i){let n=e.getGui();t.replaceChild(n,i),t.insertBefore(document.createComment(i.nodeName),n),this.addDestroyFunc(this.destroyBean.bind(this,e))}activateTabIndex(e){let t=this.gos.get("tabIndex");e||(e=[]),e.length||e.push(this.getGui());for(let i of e)i.setAttribute("tabindex",t.toString())}setTemplate(e,t,i){let n;typeof e=="string"||e==null?n=_v(e):n=Wd(e),this.setTemplateFromElement(n,t,i)}setTemplateFromElement(e,t,i,n=!1){if(this.eGui=e,this.suppressDataRefValidation=n,t)for(let s=0;s<t.length;s++){let o=t[s];this.componentSelectors.set(o.selector,o)}this.wireTemplate(e,i)}getGui(){return this.eGui}getFocusableElement(){return this.eGui}getAriaElement(){return this.getFocusableElement()}setParentComponent(e){this.parentComponent=e}getParentComponent(){return this.parentComponent}setGui(e){this.eGui=e}queryForHtmlElement(e){return this.eGui.querySelector(e)}getContainerAndElement(e,t){let i=t;return e==null?null:(i||(i=this.eGui),Nv(e)?{element:e,parent:i}:{element:e.getGui(),parent:i})}prependChild(e,t){let{element:i,parent:n}=this.getContainerAndElement(e,t)||{};!i||!n||n.insertAdjacentElement("afterbegin",i)}appendChild(e,t){let{element:i,parent:n}=this.getContainerAndElement(e,t)||{};!i||!n||n.appendChild(i)}isDisplayed(){return this.displayed}setVisible(e,t={}){if(e!==this.visible){this.visible=e;let{skipAriaHidden:i}=t;yO(this.eGui,e,{skipAriaHidden:i})}}setDisplayed(e,t={}){if(e!==this.displayed){this.displayed=e;let{skipAriaHidden:i}=t;et(this.eGui,e,{skipAriaHidden:i});let n={type:"displayChanged",visible:this.displayed};this.dispatchLocalEvent(n)}}destroy(){this.parentComponent&&(this.parentComponent=void 0),super.destroy()}addGuiEventListener(e,t,i){this.eGui.addEventListener(e,t,i),this.addDestroyFunc(()=>this.eGui.removeEventListener(e,t))}addCss(e){this.cssManager.toggleCss(e,!0)}removeCss(e){this.cssManager.toggleCss(e,!1)}toggleCss(e,t){this.cssManager.toggleCss(e,t)}registerCSS(e){this.css||(this.css=[]),this.css.push(e)}},Be=class extends qd{};function P4(e){return typeof e=="object"&&!!e.component}function GN(e,t){return new lt(i=>{i(window.setInterval(e,t))})}var lt=class vd{constructor(t){this.status=0,this.resolution=null,this.waiters=[],t(i=>this.onDone(i),i=>this.onReject(i))}static all(t){return t.length?new vd(i=>{let n=t.length,s=new Array(n);t.forEach((o,r)=>{o.then(a=>{s[r]=a,n--,n===0&&i(s)})})}):vd.resolve()}static resolve(t=null){return new vd(i=>i(t))}then(t){return new vd(i=>{this.status===1?i(t(this.resolution)):this.waiters.push(n=>i(t(n)))})}onDone(t){this.status=1,this.resolution=t;for(let i of this.waiters)i(t)}onReject(t){}};function zN(e){return e?e.prototype&&"getGui"in e.prototype:!1}function F4(e,t,i,n){let{name:s}=i,o,r,a,l,d,c;if(t){let u=t,h=u[s+"Selector"],p=h?h(n):null,g=f=>{typeof f=="string"?o=f:f!=null&&f!==!0&&(e.isFrameworkComponent(f)?a=f:r=f)};p?(g(p.component),l=p.params,d=p.popup,c=p.popupPosition):g(u[s])}return{compName:o,jsComp:r,fwComp:a,paramsFromSelector:l,popupFromSelector:d,popupPositionFromSelector:c}}var WN=class extends F{constructor(){super(...arguments),this.beanName="userCompFactory"}wireBeans(e){this.agCompUtils=e.agCompUtils,this.registry=e.registry,this.frameworkCompWrapper=e.frameworkCompWrapper,this.gridOptions=e.gridOptions}getCompDetailsFromGridOptions(e,t,i,n=!1){return this.getCompDetails(this.gridOptions,e,t,i,n)}getCompDetails(e,t,i,n,s=!1){let{name:o,cellRenderer:r}=t,{compName:a,jsComp:l,fwComp:d,paramsFromSelector:c,popupFromSelector:u,popupPositionFromSelector:h}=F4(this.beans.frameworkOverrides,e,t,n),p,g,f=w=>{let y=this.registry.getUserComponent(o,w);y&&(l=y.componentFromFramework?void 0:y.component,d=y.componentFromFramework?y.component:void 0,p=y.params,g=y.processParams)};if(a!=null&&f(a),l==null&&d==null&&i!=null&&f(i),l&&r&&!zN(l)&&(l=this.agCompUtils?.adaptFunction(t,l)),!l&&!d){let{validation:w}=this.beans;s&&(a!==i||!i)?a?w?.isProvidedUserComp(a)||Ge(50,{compName:a}):i?w||Ge(260,O(b({},this.gos.getModuleErrorParams()),{propName:o,compName:i})):Ge(216,{name:o}):i&&!w&&Ge(146,{comp:i});return}let m=this.mergeParams(e,t,n,c,p,g),C=l==null,v=l??d;return{componentFromFramework:C,componentClass:v,params:m,type:t,popupFromSelector:u,popupPositionFromSelector:h,newAgStackInstance:()=>this.newAgStackInstance(v,C,m,t)}}newAgStackInstance(e,t,i,n){let s=!t,o;s?o=new e:o=this.frameworkCompWrapper.wrap(e,n.mandatoryMethods,n.optionalMethods,n),this.createBean(o);let r=o.init?.(i);return r==null?lt.resolve(o):r.then(()=>o)}mergeParams(e,t,i,n=null,s,o){let r=b(b({},i),s),l=e?.[t.name+"Params"];if(typeof l=="function"){let d=l(i);pi(r,d)}else typeof l=="object"&&pi(r,l);return pi(r,n),o?o(r):r}},UN={name:"dateComponent",mandatoryMethods:["getDate","setDate"],optionalMethods:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled","refresh"]},qN={name:"dragAndDropImageComponent",mandatoryMethods:["setIcon","setLabel"]},$N={name:"headerComponent",optionalMethods:["refresh"]},jN={name:"innerHeaderComponent"},KN={name:"innerHeaderGroupComponent"},YN={name:"headerGroupComponent"};var XN={name:"cellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0};var JN={name:"loadingCellRenderer",cellRenderer:!0},QN={name:"cellEditor",mandatoryMethods:["getValue"],optionalMethods:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached","refresh"]},ZN={name:"loadingOverlayComponent",optionalMethods:["refresh"]},eB={name:"noRowsOverlayComponent",optionalMethods:["refresh"]},tB={name:"tooltipComponent"},Uv={name:"filter",mandatoryMethods:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethods:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged","refresh"]},iB={name:"floatingFilterComponent",mandatoryMethods:["onParentModelChanged"],optionalMethods:["afterGuiAttached","refresh"]},nB={name:"fullWidthCellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0},sB={name:"loadingCellRenderer",cellRenderer:!0},oB={name:"groupRowRenderer",optionalMethods:["afterGuiAttached"],cellRenderer:!0},rB={name:"detailCellRenderer",optionalMethods:["refresh"],cellRenderer:!0};function aB(e,t){return e.getCompDetailsFromGridOptions(qN,"agDragAndDropImage",t,!0)}function lB(e,t,i){return e.getCompDetails(t,$N,"agColumnHeader",i)}function dB(e,t,i){return e.getCompDetails(t,jN,void 0,i)}function cB(e,t){let i=t.columnGroup.getColGroupDef();return e.getCompDetails(i,YN,"agColumnGroupHeader",t)}function uB(e,t,i){return e.getCompDetails(t,KN,void 0,i)}function hB(e,t){return e.getCompDetailsFromGridOptions(nB,void 0,t,!0)}function pB(e,t){return e.getCompDetailsFromGridOptions(sB,"agLoadingCellRenderer",t,!0)}function gB(e,t){return e.getCompDetailsFromGridOptions(oB,"agGroupRowRenderer",t,!0)}function fB(e,t){return e.getCompDetailsFromGridOptions(rB,"agDetailCellRenderer",t,!0)}function bR(e,t,i){return e.getCompDetails(t,XN,void 0,i)}function yR(e,t,i){return e.getCompDetails(t,JN,"agSkeletonCellRenderer",i,!0)}function T4(e,t,i){return e.getCompDetails(t,QN,"agCellEditor",i,!0)}function mB(e,t,i,n){let s=t.filter;return P4(s)&&(t={filter:s.component,filterParams:t.filterParams}),e.getCompDetails(t,Uv,n,i,!0)}function CB(e,t,i){return e.getCompDetails(t,UN,"agDateInput",i,!0)}function vB(e,t){return e.getCompDetailsFromGridOptions(ZN,"agLoadingOverlay",t,!0)}function wB(e,t){return e.getCompDetailsFromGridOptions(eB,"agNoRowsOverlay",t,!0)}function bB(e,t){return e.getCompDetails(t.colDef,tB,"agTooltipComponent",t,!0)}function yB(e,t,i,n){return e.getCompDetails(t,iB,n,i)}function A4(e,t){return F4(e,t,Uv)}function wC(e,t,i){return e.mergeParams(t,Uv,i)}function Nd(e){let t=e;return t?.getFrameworkComponentInstance!=null?t.getFrameworkComponentInstance():e}function SB(e){return typeof e=="object"&&!!e.getComp}var k={BACKSPACE:"Backspace",TAB:"Tab",ENTER:"Enter",ESCAPE:"Escape",SPACE:" ",LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown",DELETE:"Delete",F2:"F2",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",PAGE_HOME:"Home",PAGE_END:"End",A:"KeyA",C:"KeyC",D:"KeyD",V:"KeyV",X:"KeyX",Y:"KeyY",Z:"KeyZ"},qv=class extends qd{isPopup(){return!0}setParentComponent(e){e.addCss("ag-has-popup"),super.setParentComponent(e)}destroy(){let e=this.parentComponent;e?.isAlive()&&e.getGui().classList.remove("ag-has-popup"),super.destroy()}},bC,yC,SC,xC,rv,av,EC;function po(){return bC===void 0&&(bC=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),bC}function I4(){return yC===void 0&&(yC=/(firefox)/i.test(navigator.userAgent)),yC}function _4(){return SC===void 0&&(SC=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),SC}function nr(){return xC===void 0&&(xC=/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1),xC}function lv(e){if(!e)return null;let t=e.tabIndex,i=e.getAttribute("tabIndex");return t===-1&&(i===null||i===""&&!I4())?null:t.toString()}function xB(){if(EC!==void 0)return EC;if(!document.body)return-1;let e=1e6,t=I4()?6e6:1e9,i=document.createElement("div");for(document.body.appendChild(i);;){let n=e*2;if(i.style.height=n+"px",n>t||i.clientHeight!==n)break;e=n}return i.remove(),EC=e,e}function EB(){return av==null&&L4(),av}function L4(){let e=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",e.appendChild(t);let i=t.offsetWidth-t.clientWidth;i===0&&t.clientWidth===0&&(i=null),t.parentNode&&t.remove(),i!=null&&(av=i,rv=i===0)}function O4(){return rv==null&&L4(),rv}var $v="T",RB=new RegExp(`[${$v} ]`),MB=new RegExp(`^\\d{4}-\\d{2}-\\d{2}(${$v}\\d{2}:\\d{2}:\\d{2}\\D?)?`);function On(e,t){return e.toString().padStart(t,"0")}function Ai(e,t=!0,i=$v){if(!e)return null;let n=[e.getFullYear(),e.getMonth()+1,e.getDate()].map(s=>On(s,2)).join("-");return t&&(n+=i+[e.getHours(),e.getMinutes(),e.getSeconds()].map(s=>On(s,2)).join(":")),n}function ap(e,t=!0){return e?t?[String(e.getFullYear()),String(e.getMonth()+1),On(e.getDate(),2),On(e.getHours(),2),`:${On(e.getMinutes(),2)}`,`:${On(e.getSeconds(),2)}`]:[e.getFullYear(),e.getMonth()+1,On(e.getDate(),2)].map(String):null}var RC=e=>{if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"},SR=["January","February","March","April","May","June","July","August","September","October","November","December"],MC=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function dv(e,t){if(t==null)return Ai(e,!1);let i=On(e.getFullYear(),4),n={YYYY:()=>i.slice(i.length-4,i.length),YY:()=>i.slice(i.length-2,i.length),Y:()=>`${e.getFullYear()}`,MMMM:()=>SR[e.getMonth()],MMM:()=>SR[e.getMonth()].slice(0,3),MM:()=>On(e.getMonth()+1,2),Mo:()=>`${e.getMonth()+1}${RC(e.getMonth()+1)}`,M:()=>`${e.getMonth()+1}`,Do:()=>`${e.getDate()}${RC(e.getDate())}`,DD:()=>On(e.getDate(),2),D:()=>`${e.getDate()}`,dddd:()=>MC[e.getDay()],ddd:()=>MC[e.getDay()].slice(0,3),dd:()=>MC[e.getDay()].slice(0,2),do:()=>`${e.getDay()}${RC(e.getDay())}`,d:()=>`${e.getDay()}`},s=new RegExp(Object.keys(n).join("|"),"g");return t.replace(s,o=>o in n?n[o]():o)}function xp(e,t=!1){return!!Si(e,t)}function DB(e){return xp(e,!0)}function Si(e,t=!1,i){if(!e||!i&&!MB.test(e))return null;let[n,s]=e.split(RB);if(!n)return null;let o=n.split("-").map(p=>Number.parseInt(p,10));if(o.filter(p=>!isNaN(p)).length!==3)return null;let[r,a,l]=o,d=new Date(r,a-1,l);if(d.getFullYear()!==r||d.getMonth()!==a-1||d.getDate()!==l||!s&&t)return null;if(!s||s==="00:00:00")return d;let[c,u,h]=s.split(":").map(p=>Number.parseInt(p,10));if(c>=0&&c<24)d.setHours(c);else if(t)return null;if(u>=0&&u<60)d.setMinutes(u);else if(t)return null;if(h>=0&&h<60)d.setSeconds(h);else if(t)return null;return d}function cv(e){let{inputValue:t,allSuggestions:i,hideIrrelevant:n,filterByPercentageOfBestMatch:s}=e,o=(i??[]).map((l,d)=>({value:l,relevance:kB(t,l),idx:d}));if(o.sort((l,d)=>l.relevance-d.relevance),n&&(o=o.filter(l=>l.relevance<Math.max(l.value.length,t.length))),o.length>0&&s&&s>0){let d=o[0].relevance*s;o=o.filter(c=>d-c.relevance<0)}let r=[],a=[];for(let l of o)r.push(l.value),a.push(l.idx);return{values:r,indices:a}}function kB(e,t){e.length<t.length&&([e,t]=[t,e]);let i=[],n=[],s=e.length,o=t.length;for(let a=0;a<=o;a++)i[a]=a;let r=0;for(let a=1;a<=s;a++){n[0]=a;for(let l=1;l<=o;l++){let d=e[a-1],c=t[l-1];if(d.toLocaleLowerCase()===c.toLocaleLowerCase())++r,d===c&&++r,a>1&&l>1&&e[a-2].toLocaleLowerCase()===t[l-2].toLocaleLowerCase()&&(++r,e[a-2]===t[l-2]&&++r),a<s/2-10&&++r,n[l]=i[l-1];else{let u=n[l-1],h=i[l],p=i[l-1];n[l]=1+Math.min(u,h,p)}}[i,n]=[n,i]}return i[o]/(r+1)}function N4(e){return e.altKey||e.ctrlKey||e.metaKey?!1:e.key?.length===1}var uv=!1,Wp=0;function PB(e){Wp>0||(e.addEventListener("keydown",Up),e.addEventListener("mousedown",Up))}function FB(e){Wp>0||(e.removeEventListener("keydown",Up),e.removeEventListener("mousedown",Up))}function Up(e){let t=uv,i=e.type==="keydown";i&&(e.ctrlKey||e.metaKey||e.altKey)||t!==i&&(uv=i)}function TB(e){let t=Ht(e);return PB(t),Wp++,()=>{Wp--,FB(t)}}function AB(){return uv}function Aa(e,t,i=!1){let n=bO,s=O6;t&&(s+=", "+t),i&&(s+=', [tabindex="-1"]');let o=Array.prototype.slice.apply(e.querySelectorAll(n)).filter(l=>Gn(l)),r=Array.prototype.slice.apply(e.querySelectorAll(s));return r.length?((l,d)=>l.filter(c=>d.indexOf(c)===-1))(o,r):o}function lr(e,t=!1,i=!1,n=!1){let s=Aa(e,n?".ag-tab-guard":null,i),o=t?je(s):s[0];return o?(o.focus({preventScroll:!0}),!0):!1}function pr(e,t,i,n){let s=Aa(t,i?':not([tabindex="-1"])':null),o=ot(e),r;i?r=s.findIndex(l=>l.contains(o)):r=s.indexOf(o);let a=r+(n?-1:1);return a<0||a>=s.length?null:s[a]}function B4(e,t=5){let i=0;for(;e&&lv(e)===null&&++i<=t;)e=e.parentElement;return lv(e)===null?null:e}var IB=".ag-label{white-space:nowrap}:where(.ag-ltr) .ag-label{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-label-align-right) .ag-label{order:1}:where(.ag-ltr) :where(.ag-label-align-right) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-rtl) :where(.ag-label-align-right) .ag-label{margin-right:var(--ag-spacing)}.ag-label-align-right>*{flex:none}.ag-label-align-top{align-items:flex-start;flex-direction:column;>*{align-self:stretch}}.ag-label-ellipsis{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:where(.ag-label-align-top) .ag-label{margin-bottom:calc(var(--ag-spacing)*.5)}",_B=class extends qd{constructor(e,t,i){super(t,i),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=e||{},this.registerCSS(IB)}postConstruct(){this.addCss("ag-labeled"),this.eLabel.classList.add("ag-label");let{labelSeparator:e,label:t,labelWidth:i,labelAlignment:n,disabled:s}=this.config;s!=null&&this.setDisabled(s),e!=null&&this.setLabelSeparator(e),t!=null&&this.setLabel(t),i!=null&&this.setLabelWidth(i),this.setLabelAlignment(n||this.labelAlignment),this.refreshLabel()}refreshLabel(){let{label:e,eLabel:t}=this;$t(t),typeof e=="string"?t.innerText=e+this.labelSeparator:e&&t.appendChild(e),e===""?(et(t,!1),oo(t,"presentation")):(et(t,!0),oo(t,null))}setLabelSeparator(e){return this.labelSeparator===e?this:(this.labelSeparator=e,this.label!=null&&this.refreshLabel(),this)}getLabelId(){let e=this.eLabel;return e.id=e.id||`ag-${this.getCompId()}-label`,e.id}getLabel(){return this.label}setLabel(e){return this.label===e?this:(this.label=e,this.refreshLabel(),this)}setLabelAlignment(e){let i=this.getGui().classList;return i.toggle("ag-label-align-left",e==="left"),i.toggle("ag-label-align-right",e==="right"),i.toggle("ag-label-align-top",e==="top"),this}setLabelEllipsis(e){return this.eLabel.classList.toggle("ag-label-ellipsis",e),this}setLabelWidth(e){return this.label==null?this:(_p(this.eLabel,e),this)}setDisabled(e){e=!!e;let t=this.getGui();return Td(t,e),t.classList.toggle("ag-disabled",e),this.disabled=e,this}isDisabled(){return!!this.disabled}},H4=class extends _B{constructor(e,t,i,n){super(e,t,i),this.className=n}postConstruct(){super.postConstruct();let{width:e,value:t,onValueChange:i}=this.config;e!=null&&this.setWidth(e),t!=null&&this.setValue(t),i!=null&&this.onValueChange(i),this.className&&this.addCss(this.className),this.refreshAriaLabelledBy()}setLabel(e){return super.setLabel(e),this.refreshAriaLabelledBy(),this}refreshAriaLabelledBy(){let e=this.getAriaElement(),t=this.getLabelId(),i=this.getLabel();i==null||i==""||sO(e)!==null?Fd(e,""):Fd(e,t??"")}setAriaLabel(e){return Na(this.getAriaElement(),e),this.refreshAriaLabelledBy(),this}onValueChange(e){return this.addManagedListeners(this,{fieldValueChanged:()=>e(this.getValue())}),this}getWidth(){return this.getGui().clientWidth}setWidth(e){return Bn(this.getGui(),e),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(e,t){return this.value===e?this:(this.previousValue=this.value,this.value=e,t||this.dispatchLocalEvent({type:"fieldValueChanged"}),this)}};function LB(e){return{tag:"div",role:"presentation",children:[{tag:"div",ref:"eLabel",cls:"ag-input-field-label"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-input-wrapper",role:"presentation",children:[{tag:e,ref:"eInput",cls:"ag-input-field-input"}]}]}}var Qo=class extends H4{constructor(e,t,i="text",n="input"){super(e,e?.template??LB(n),[],t),this.inputType=i,this.displayFieldTag=n,this.eLabel=U,this.eWrapper=U,this.eInput=U}postConstruct(){super.postConstruct(),this.setInputType(this.inputType);let{eLabel:e,eWrapper:t,eInput:i,className:n}=this;e.classList.add(`${n}-label`),t.classList.add(`${n}-input-wrapper`),i.classList.add(`${n}-input`),this.addCss("ag-input-field"),i.id=i.id||`ag-${this.getCompId()}-input`;let{inputName:s,inputWidth:o}=this.config;s!=null&&this.setInputName(s),o!=null&&this.setInputWidth(o),this.addInputListeners(),this.activateTabIndex([i])}addInputListeners(){this.addManagedElementListeners(this.eInput,{input:e=>this.setValue(e.target.value)})}setInputType(e){this.displayFieldTag==="input"&&(this.inputType=e,Fi(this.eInput,"type",e))}getInputElement(){return this.eInput}setInputWidth(e){return _p(this.eWrapper,e),this}setInputName(e){return this.getInputElement().setAttribute("name",e),this}getFocusableElement(){return this.eInput}setMaxLength(e){let t=this.eInput;return t.maxLength=e,this}setInputPlaceholder(e){return Fi(this.eInput,"placeholder",e),this}setInputAriaLabel(e){return Na(this.eInput,e),this.refreshAriaLabelledBy(),this}setDisabled(e){return Td(this.eInput,e),super.setDisabled(e)}setAutoComplete(e){if(e===!0)Fi(this.eInput,"autocomplete",null);else{let t=typeof e=="string"?e:"off";Fi(this.eInput,"autocomplete",t)}return this}},jv=class extends Qo{constructor(e,t="ag-checkbox",i="checkbox"){super(e,t,i),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}postConstruct(){super.postConstruct();let{readOnly:e,passive:t}=this.config;typeof e=="boolean"&&this.setReadOnly(e),typeof t=="boolean"&&this.setPassive(t)}addInputListeners(){this.addManagedElementListeners(this.eInput,{click:this.onCheckboxClick.bind(this)}),this.addManagedElementListeners(this.eLabel,{click:this.toggle.bind(this)})}getNextValue(){return this.selected===void 0?!0:!this.selected}setPassive(e){this.passive=e}isReadOnly(){return this.readOnly}setReadOnly(e){this.eWrapper.classList.toggle("ag-disabled",e),this.eInput.disabled=e,this.readOnly=e}setDisabled(e){return this.eWrapper.classList.toggle("ag-disabled",e),super.setDisabled(e)}toggle(){if(this.eInput.disabled)return;let e=this.isSelected(),t=this.getNextValue();this.passive?this.dispatchChange(t,e):this.setValue(t)}getValue(){return this.isSelected()}setValue(e,t){return this.refreshSelectedClass(e),this.setSelected(e,t),this}setName(e){let t=this.getInputElement();return t.name=e,this}isSelected(){return this.selected}setSelected(e,t){if(this.isSelected()===e)return;this.previousValue=this.isSelected(),e=this.selected=typeof e=="boolean"?e:void 0;let i=this.eInput;i.checked=e,i.indeterminate=e===void 0,t||this.dispatchChange(this.selected,this.previousValue)}dispatchChange(e,t,i){this.dispatchLocalEvent({type:"fieldValueChanged",selected:e,previousValue:t,event:i});let n=this.getInputElement();this.eventSvc.dispatchEvent({type:"checkboxChanged",id:n.id,name:n.name,selected:e,previousValue:t})}onCheckboxClick(e){if(this.passive||this.eInput.disabled)return;let t=this.isSelected(),i=this.selected=e.target.checked;this.refreshSelectedClass(i),this.dispatchChange(i,t,e)}refreshSelectedClass(e){let t=this.eWrapper.classList;t.toggle("ag-checked",e===!0),t.toggle("ag-indeterminate",e==null)}},Kv={selector:"AG-CHECKBOX",component:jv},OB=class extends jv{constructor(e){super(e,"ag-radio-button","radio")}isSelected(){return this.eInput.checked}toggle(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}addInputListeners(){super.addInputListeners(),this.addManagedEventListeners({checkboxChanged:this.onChange.bind(this)})}onChange(e){let t=this.eInput;e.selected&&e.name&&t.name&&t.name===e.name&&e.id&&t.id!==e.id&&this.setValue(!1,!0)}};var gr=class extends Qo{constructor(e,t="ag-text-field",i="text"){super(e,t,i)}postConstruct(){super.postConstruct(),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}setValue(e,t){let i=this.eInput;return i.value!==e&&(i.value=K(e)?e:""),super.setValue(e,t)}setStartValue(e){this.setValue(e,!0)}preventDisallowedCharacters(){let e=new RegExp(`[${this.config.allowedCharPattern}]`),t=i=>{N4(i)&&i.key&&!e.test(i.key)&&i.preventDefault()};this.addManagedListeners(this.eInput,{keydown:t,paste:i=>{i.clipboardData?.getData("text")?.split("").some(s=>!e.test(s))&&i.preventDefault()}})}},tg={selector:"AG-INPUT-TEXT-FIELD",component:gr},NB=class extends Qo{constructor(e){super(e,"ag-text-area",null,"textarea")}setValue(e,t){let i=super.setValue(e,t);return this.eInput.value=e,i}setCols(e){return this.eInput.cols=e,this}setRows(e){return this.eInput.rows=e,this}},BB={selector:"AG-INPUT-TEXT-AREA",component:NB},Yv=class extends gr{constructor(e){super(e,"ag-number-field","number")}postConstruct(){super.postConstruct();let e=this.eInput;this.addManagedListeners(e,{blur:()=>{let o=Number.parseFloat(e.value),r=isNaN(o)?"":this.normalizeValue(o.toString());this.value!==r&&this.setValue(r)},wheel:this.onWheel.bind(this)}),e.step="any";let{precision:t,min:i,max:n,step:s}=this.config;typeof t=="number"&&this.setPrecision(t),typeof i=="number"&&this.setMin(i),typeof n=="number"&&this.setMax(n),typeof s=="number"&&this.setStep(s)}onWheel(e){ot(this.beans)===this.eInput&&e.preventDefault()}normalizeValue(e){return e===""?"":(this.precision!=null&&(e=this.adjustPrecision(e)),e)}adjustPrecision(e,t){let i=this.precision;if(i==null)return e;if(t){let s=Number.parseFloat(e).toFixed(i);return Number.parseFloat(s).toString()}let n=String(e).split(".");if(n.length>1){if(n[1].length<=i)return e;if(i>0)return`${n[0]}.${n[1].slice(0,i)}`}return n[0]}setMin(e){return this.min===e?this:(this.min=e,Fi(this.eInput,"min",e),this)}setMax(e){return this.max===e?this:(this.max=e,Fi(this.eInput,"max",e),this)}setPrecision(e){return this.precision=e,this}setStep(e){return this.step===e?this:(this.step=e,Fi(this.eInput,"step",e),this)}setValue(e,t){return this.setValueOrInputValue(i=>super.setValue(i,t),()=>this,e)}setStartValue(e){return this.setValueOrInputValue(t=>super.setValue(t,!0),t=>{this.eInput.value=t},e)}setValueOrInputValue(e,t,i){if(K(i)){let n=this.isScientificNotation(i);if(n&&this.eInput.validity.valid)return e(i);if(!n){i=this.adjustPrecision(i);let s=this.normalizeValue(i);n=i!=s}if(n)return t(i)}return e(i)}getValue(){let e=this.eInput;if(!e.validity.valid)return;let t=e.value;return this.isScientificNotation(t)?this.adjustPrecision(t,!0):super.getValue()}isScientificNotation(e){return typeof e=="string"&&e.includes("e")}},HB={selector:"AG-INPUT-NUMBER-FIELD",component:Yv},VB=class extends gr{constructor(e){super(e,"ag-date-field","date")}postConstruct(){super.postConstruct();let e=po();this.addManagedListeners(this.eInput,{wheel:this.onWheel.bind(this),mousedown:()=>{this.isDisabled()||e||this.eInput.focus()}}),this.eInput.step="any"}onWheel(e){ot(this.beans)===this.eInput&&e.preventDefault()}setMin(e){let t=e instanceof Date?Ai(e??null,!!this.includeTime)??void 0:e;return this.min===t?this:(this.min=t,Fi(this.eInput,"min",t),this)}setMax(e){let t=e instanceof Date?Ai(e??null,!!this.includeTime)??void 0:e;return this.max===t?this:(this.max=t,Fi(this.eInput,"max",t),this)}setStep(e){return this.step===e?this:(this.step=e,Fi(this.eInput,"step",e),this)}setIncludeTime(e){return this.includeTime===e?this:(this.includeTime=e,super.setInputType(e?"datetime-local":"date"),e&&this.setStep(1),this)}getDate(){if(this.eInput.validity.valid)return Si(this.getValue())??void 0}setDate(e,t){this.setValue(Ai(e??null,this.includeTime),t)}},V4={selector:"AG-INPUT-DATE-FIELD",component:VB},GB=".ag-list-item{align-items:center;display:flex;height:var(--ag-list-item-height);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;&.ag-active-item{background-color:var(--ag-row-hover-color)}}",zB="ag-active-item",WB=(e,t)=>({tag:"div",cls:`ag-list-item ag-${e}-list-item`,attrs:{role:"option"},children:[{tag:"span",ref:"eText",children:t}]}),UB=class extends qd{constructor(e,t,i){super(WB(e,t)),this.label=t,this.value=i,this.eText=U}postConstruct(){this.createTooltip(),this.addEventListeners()}setHighlighted(e){let t=this.getGui();t.classList.toggle(zB,e),L6(t,e),this.dispatchLocalEvent({type:"itemHighlighted",highlighted:e})}getHeight(){return this.getGui().clientHeight}setIndex(e,t){let i=this.getGui();cO(i,e),dO(i,t)}createTooltip(){let e={getTooltipValue:()=>this.label,getGui:()=>this.getGui(),getLocation:()=>"UNKNOWN",shouldDisplayTooltip:()=>Lv(this.eText)},t=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("highlightTooltipFeature",!1,e,this));t&&(this.tooltipFeature=t)}addEventListeners(){let e=this.getParentComponent();e&&(this.addGuiEventListener("mouseover",()=>{e.highlightItem(this)}),this.addGuiEventListener("mousedown",t=>{t.preventDefault(),t.stopPropagation(),e.setValue(this.value)}))}},qB=class extends qd{constructor(e="default"){super({tag:"div",cls:`ag-list ag-${e}-list`}),this.cssIdentifier=e,this.options=[],this.listItems=[],this.highlightedItem=null,this.registerCSS(GB)}postConstruct(){let e=this.getGui();this.addManagedElementListeners(e,{mouseleave:()=>this.clearHighlighted()})}handleKeyDown(e){let t=e.key;switch(t){case k.ENTER:if(!this.highlightedItem)this.setValue(this.getValue());else{let i=this.listItems.indexOf(this.highlightedItem);this.setValueByIndex(i)}break;case k.DOWN:case k.UP:e.preventDefault(),this.navigate(t);break;case k.PAGE_DOWN:case k.PAGE_UP:case k.PAGE_HOME:case k.PAGE_END:e.preventDefault(),this.navigateToPage(t);break}}addOptions(e){for(let t of e)this.addOption(t);return this}addOption(e){let{value:t,text:i}=e,n=i??t;return this.options.push({value:t,text:n}),this.renderOption(t,n),this.updateIndices(),this}clearOptions(){this.options=[],this.reset(!0);for(let e of this.listItems)e.destroy();$t(this.getGui()),this.listItems=[],this.refreshAriaRole()}setValue(e,t){if(this.value===e)return this.fireItemSelected(),this;if(e==null)return this.reset(t),this;let i=this.options.findIndex(n=>n.value===e);if(i!==-1){let n=this.options[i];this.value=n.value,this.displayValue=n.text,this.highlightItem(this.listItems[i]),t||this.fireChangeEvent()}return this}setValueByIndex(e){return this.setValue(this.options[e].value)}getValue(){return this.value}getDisplayValue(){return this.displayValue}refreshHighlighted(){this.clearHighlighted();let e=this.options.findIndex(t=>t.value===this.value);e!==-1&&this.highlightItem(this.listItems[e])}highlightItem(e){let t=e.getGui();if(!Gn(t))return;this.clearHighlighted(),e.setHighlighted(!0),this.highlightedItem=e;let i=this.getGui(),{scrollTop:n,clientHeight:s}=i,{offsetTop:o,offsetHeight:r}=t;(o+r>n+s||o<n)&&t.scrollIntoView({block:"nearest"})}hideItemTooltip(){this.highlightedItem?.tooltipFeature?.attemptToHideTooltip()}destroy(){this.hideItemTooltip(),super.destroy()}reset(e){this.value=null,this.displayValue=null,this.clearHighlighted(),e||this.fireChangeEvent()}clearHighlighted(){this.highlightedItem?.setHighlighted(!1),this.highlightedItem=null}renderOption(e,t){let i=new UB(this.cssIdentifier,t,e);i.setParentComponent(this);let n=this.createManagedBean(i);this.listItems.push(n),this.getGui().appendChild(n.getGui())}navigate(e){let t=e===k.DOWN,i,{listItems:n,highlightedItem:s}=this;if(!s)i=t?n[0]:je(n);else{let r=n.indexOf(s)+(t?1:-1);r=Math.min(Math.max(r,0),n.length-1),i=n[r]}this.highlightItem(i)}navigateToPage(e){let{listItems:t,highlightedItem:i}=this;if(!i||t.length===0)return;let n=t.indexOf(i),s=this.options.length-1,o=t[0].getHeight(),r=Math.floor(this.getGui().clientHeight/o),a=-1;e===k.PAGE_HOME?a=0:e===k.PAGE_END?a=s:e===k.PAGE_DOWN?a=Math.min(n+r,s):e===k.PAGE_UP&&(a=Math.max(n-r,0)),a!==-1&&this.highlightItem(t[a])}refreshAriaRole(){oo(this.getGui(),this.options.length===0?"presentation":"listbox")}updateIndices(){this.refreshAriaRole();let e=this.listItems,t=e.length;e.forEach((i,n)=>{i.setIndex(n+1,t)})}fireChangeEvent(){this.dispatchLocalEvent({type:"fieldValueChanged"}),this.fireItemSelected()}fireItemSelected(){this.dispatchLocalEvent({type:"selectedItem"})}},$B=".ag-picker-field-display{flex:1 1 auto}.ag-picker-field{align-items:center;display:flex}.ag-picker-field-icon{border:0;cursor:pointer;display:flex;margin:0;padding:0}.ag-picker-field-wrapper{background-color:var(--ag-picker-button-background-color);border:var(--ag-picker-button-border);border-radius:5px;min-height:max(var(--ag-list-item-height),calc(var(--ag-spacing)*4));overflow:hidden;&:where(.ag-picker-has-focus),&:where(:focus-within){background-color:var(--ag-picker-button-focus-background-color);border:var(--ag-picker-button-focus-border);box-shadow:var(--ag-focus-shadow);&:where(.invalid){box-shadow:var(--ag-focus-error-shadow)}}&:where(.invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&:disabled{opacity:.5}}",jB={tag:"div",cls:"ag-picker-field",role:"presentation",children:[{tag:"div",ref:"eLabel"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-picker-field-wrapper ag-picker-collapsed",children:[{tag:"div",ref:"eDisplayField",cls:"ag-picker-field-display"},{tag:"div",ref:"eIcon",cls:"ag-picker-field-icon",attrs:{"aria-hidden":"true"}}]}]},KB=class extends H4{constructor(e){if(super(e,e?.template||jB,e?.agComponents||[],e?.className),this.isPickerDisplayed=!1,this.skipClick=!1,this.pickerGap=4,this.hideCurrentPicker=null,this.eLabel=U,this.eWrapper=U,this.eDisplayField=U,this.eIcon=U,this.registerCSS($B),this.ariaRole=e?.ariaRole,this.onPickerFocusIn=this.onPickerFocusIn.bind(this),this.onPickerFocusOut=this.onPickerFocusOut.bind(this),!e)return;let{pickerGap:t,maxPickerHeight:i,variableWidth:n,minPickerWidth:s,maxPickerWidth:o}=e;t!=null&&(this.pickerGap=t),this.variableWidth=!!n,i!=null&&this.setPickerMaxHeight(i),s!=null&&this.setPickerMinWidth(s),o!=null&&this.setPickerMaxWidth(o)}postConstruct(){super.postConstruct(),this.setupAria();let e=`ag-${this.getCompId()}-display`;this.eDisplayField.setAttribute("id",e);let t=this.getAriaElement();this.addManagedElementListeners(t,{keydown:this.onKeyDown.bind(this)}),this.addManagedElementListeners(this.eLabel,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)}),this.addManagedElementListeners(this.eWrapper,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)});let{pickerIcon:i,inputWidth:n}=this.config;if(i){let s=this.beans.iconSvc.createIconNoSpan(i);s&&this.eIcon.appendChild(s)}n!=null&&this.setInputWidth(n)}setupAria(){let e=this.getAriaElement();e.setAttribute("tabindex",this.gos.get("tabIndex").toString()),QC(e,!1),this.ariaRole&&oo(e,this.ariaRole)}onLabelOrWrapperMouseDown(e){if(e){let t=this.getFocusableElement();if(t!==this.eWrapper&&e?.target===t)return;e.preventDefault(),this.getFocusableElement().focus()}if(this.skipClick){this.skipClick=!1;return}this.isDisabled()||(this.isPickerDisplayed?this.hidePicker():this.showPicker())}onKeyDown(e){switch(e.key){case k.UP:case k.DOWN:case k.ENTER:case k.SPACE:e.preventDefault(),this.onLabelOrWrapperMouseDown();break;case k.ESCAPE:this.isPickerDisplayed&&(e.preventDefault(),e.stopPropagation(),this.hideCurrentPicker&&this.hideCurrentPicker());break}}showPicker(){this.isPickerDisplayed=!0,this.pickerComponent||(this.pickerComponent=this.createPickerComponent());let e=this.pickerComponent.getGui();e.addEventListener("focusin",this.onPickerFocusIn),e.addEventListener("focusout",this.onPickerFocusOut),this.hideCurrentPicker=this.renderAndPositionPicker(),this.toggleExpandedStyles(!0)}renderAndPositionPicker(){let e=this.pickerComponent.getGui();this.gos.get("suppressScrollWhenPopupsAreOpen")||([this.destroyMouseWheelFunc]=this.addManagedEventListeners({bodyScroll:()=>{this.hidePicker()}}));let t=this.getLocaleTextFunc(),{config:{pickerAriaLabelKey:i,pickerAriaLabelValue:n,modalPicker:s=!0},maxPickerHeight:o,minPickerWidth:r,maxPickerWidth:a,variableWidth:l,beans:d,eWrapper:c}=this,u={modal:s,eChild:e,closeOnEsc:!0,closedCallback:()=>{let f=k6(d);this.beforeHidePicker(),f&&this.isAlive()&&this.getFocusableElement().focus()},ariaLabel:t(i,n),anchorToElement:c};e.style.position="absolute";let h=d.popupSvc,p=h.addPopup(u);l?(r&&(e.style.minWidth=r),e.style.width=Ov(Tp(c)),a&&(e.style.maxWidth=a)):_p(e,a??Tp(c));let g=o??`${Iv(h.getPopupParent())}px`;return e.style.setProperty("max-height",g),this.alignPickerToComponent(),p.hideFunc}alignPickerToComponent(){if(!this.pickerComponent)return;let{pickerGap:e,config:{pickerType:t},beans:{popupSvc:i,gos:n},eWrapper:s,pickerComponent:o}=this,r=n.get("enableRtl")?"right":"left";i.positionPopupByComponent({type:t,eventSource:s,ePopup:o.getGui(),position:"under",alignSide:r,keepWithinBounds:!0,nudgeY:e})}beforeHidePicker(){this.destroyMouseWheelFunc&&(this.destroyMouseWheelFunc(),this.destroyMouseWheelFunc=void 0),this.toggleExpandedStyles(!1);let e=this.pickerComponent.getGui();e.removeEventListener("focusin",this.onPickerFocusIn),e.removeEventListener("focusout",this.onPickerFocusOut),this.isPickerDisplayed=!1,this.pickerComponent=void 0,this.hideCurrentPicker=null}toggleExpandedStyles(e){if(!this.isAlive())return;let t=this.getAriaElement();QC(t,e);let i=this.eWrapper.classList;i.toggle("ag-picker-expanded",e),i.toggle("ag-picker-collapsed",!e)}onPickerFocusIn(){this.togglePickerHasFocus(!0)}onPickerFocusOut(e){this.pickerComponent?.getGui().contains(e.relatedTarget)||this.togglePickerHasFocus(!1)}togglePickerHasFocus(e){this.pickerComponent&&this.eWrapper.classList.toggle("ag-picker-has-focus",e)}hidePicker(){this.hideCurrentPicker&&(this.hideCurrentPicker(),this.dispatchLocalEvent({type:"pickerHidden"}))}setInputWidth(e){return _p(this.eWrapper,e),this}getFocusableElement(){return this.eWrapper}setPickerGap(e){return this.pickerGap=e,this}setPickerMinWidth(e){return typeof e=="number"&&(e=`${e}px`),this.minPickerWidth=e??void 0,this}setPickerMaxWidth(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerWidth=e??void 0,this}setPickerMaxHeight(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerHeight=e??void 0,this}destroy(){this.hidePicker(),super.destroy()}},YB=".ag-select{align-items:center;display:flex;&.ag-disabled{opacity:.5}}:where(.ag-select){.ag-picker-field-wrapper{cursor:default}&.ag-disabled .ag-picker-field-wrapper:focus{box-shadow:none}&:not(.ag-cell-editor,.ag-label-align-top){min-height:var(--ag-list-item-height)}.ag-picker-field-display{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ag-picker-field-icon{align-items:center;display:flex}}:where(.ag-ltr) :where(.ag-select){.ag-picker-field-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding)/2);padding-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-select){.ag-picker-field-wrapper{padding-left:var(--ag-spacing);padding-right:calc(var(--ag-cell-horizontal-padding)/2)}}.ag-select-list{background-color:var(--ag-picker-list-background-color);border:var(--ag-picker-list-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);overflow:hidden auto}.ag-select-list-item{cursor:default;-webkit-user-select:none;-moz-user-select:none;user-select:none;:where(span){overflow:hidden;text-overflow:ellipsis;white-space:nowrap}}:where(.ag-ltr) .ag-select-list-item{padding-left:calc(var(--ag-cell-horizontal-padding)/2)}:where(.ag-rtl) .ag-select-list-item{padding-right:calc(var(--ag-cell-horizontal-padding)/2)}",Xv=class extends KB{constructor(e){super(b({pickerAriaLabelKey:"ariaLabelSelectField",pickerAriaLabelValue:"Select Field",pickerType:"ag-list",className:"ag-select",pickerIcon:"selectOpen",ariaRole:"combobox"},e)),this.registerCSS(YB)}postConstruct(){this.tooltipFeature=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{shouldDisplayTooltip:vp(()=>this.eDisplayField),getGui:()=>this.getGui()})),super.postConstruct(),this.createListComponent(),this.eWrapper.tabIndex=this.gos.get("tabIndex");let{options:e,value:t,placeholder:i}=this.config;e!=null&&this.addOptions(e),t!=null&&this.setValue(t,!0),i&&t==null&&(this.eDisplayField.textContent=i),this.addManagedElementListeners(this.eWrapper,{focusout:this.onWrapperFocusOut.bind(this)})}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}createListComponent(){let e=this.createBean(new qB("select"));this.listComponent=e,e.setParentComponent(this);let t=e.getAriaElement(),i=`ag-select-list-${e.getCompId()}`;t.setAttribute("id",i),wO(this.getAriaElement(),t),e.addManagedElementListeners(e.getGui(),{mousedown:n=>{n?.preventDefault()}}),e.addManagedListeners(e,{selectedItem:()=>{this.hidePicker(),this.dispatchLocalEvent({type:"selectedItem"})},fieldValueChanged:()=>{this.listComponent&&(this.setValue(this.listComponent.getValue(),!1,!0),this.hidePicker())}})}createPickerComponent(){return this.listComponent}beforeHidePicker(){this.listComponent?.hideItemTooltip(),super.beforeHidePicker()}onKeyDown(e){let{key:t}=e;switch(t===k.TAB&&this.hidePicker(),t){case k.ENTER:case k.UP:case k.DOWN:case k.PAGE_UP:case k.PAGE_DOWN:case k.PAGE_HOME:case k.PAGE_END:e.preventDefault(),this.isPickerDisplayed?this.listComponent?.handleKeyDown(e):super.onKeyDown(e);break;case k.ESCAPE:super.onKeyDown(e);break;case k.SPACE:this.isPickerDisplayed?e.preventDefault():super.onKeyDown(e);break}}showPicker(){let e=this.listComponent;e&&(super.showPicker(),e.refreshHighlighted())}addOptions(e){for(let t of e)this.addOption(t);return this}addOption(e){return this.listComponent.addOption(e),this}clearOptions(){return this.listComponent?.clearOptions(),this.setValue(void 0,!0),this}setValue(e,t,i){let{listComponent:n,config:{placeholder:s},eDisplayField:o,tooltipFeature:r}=this;if(this.value===e||!n)return this;if(i||n.setValue(e,!0),n.getValue()===this.getValue())return this;let l=n.getDisplayValue();return l==null&&s&&(l=s),o.textContent=l,r?.setTooltipAndRefresh(l??null),super.setValue(e,t)}destroy(){this.listComponent=this.destroyBean(this.listComponent),super.destroy()}},XB={selector:"AG-SELECT",component:Xv};var JB=':where(.ag-root-wrapper,.ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart),:where(.ag-root-wrapper,.ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]){box-sizing:border-box;&:after,&:before{box-sizing:border-box}&:where(div,span,label):focus-visible{box-shadow:inset var(--ag-focus-shadow);outline:none;&:where(.invalid){box-shadow:inset var(--ag-focus-error-shadow)}}&:where(button){color:inherit}}:where(.ag-root-wrapper,ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]) ::-ms-clear{display:none}.ag-hidden{display:none!important}.ag-invisible{visibility:hidden!important}.ag-popup-child{top:0;z-index:5;&:where(:not(.ag-tooltip-custom)){box-shadow:var(--ag-popup-shadow)}}.ag-input-wrapper,.ag-picker-field-wrapper{align-items:center;display:flex;flex:1 1 auto;line-height:normal;position:relative}.ag-input-field{align-items:center;display:flex;flex-direction:row}.ag-input-field-input:where(:not([type=checkbox],[type=radio])){flex:1 1 auto;min-width:0;width:100%}.ag-chart,.ag-dnd-ghost,.ag-external,.ag-popup,.ag-root-wrapper{cursor:default;line-height:normal;white-space:normal;-webkit-font-smoothing:antialiased;background-color:var(--ag-background-color);color:var(--ag-text-color);color-scheme:var(--ag-browser-color-scheme);font-family:var(--ag-font-family);font-size:var(--ag-font-size);--ag-indentation-level:0}:where(.ag-icon):before{align-items:center;background-color:currentcolor;color:inherit;content:"";display:flex;font-family:inherit;font-size:var(--ag-icon-size);font-style:normal;font-variant:normal;height:var(--ag-icon-size);justify-content:center;line-height:var(--ag-icon-size);-webkit-mask-size:contain;mask-size:contain;text-transform:none;width:var(--ag-icon-size)}.ag-icon{background-position:50%;background-repeat:no-repeat;background-size:contain;color:var(--ag-icon-color);display:block;height:var(--ag-icon-size);position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:var(--ag-icon-size)}.ag-disabled,[disabled]{.ag-icon{opacity:.5}&.ag-icon-grip{opacity:.35}}.ag-resizer{pointer-events:none;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none;z-index:1}:where(.ag-resizer){&.ag-resizer-topLeft{cursor:nwse-resize;height:5px;left:0;top:0;width:5px}&.ag-resizer-top{cursor:ns-resize;height:5px;left:5px;right:5px;top:0}&.ag-resizer-topRight{cursor:nesw-resize;height:5px;right:0;top:0;width:5px}&.ag-resizer-right{bottom:5px;cursor:ew-resize;right:0;top:5px;width:5px}&.ag-resizer-bottomRight{bottom:0;cursor:nwse-resize;height:5px;right:0;width:5px}&.ag-resizer-bottom{bottom:0;cursor:ns-resize;height:5px;left:5px;right:5px}&.ag-resizer-bottomLeft{bottom:0;cursor:nesw-resize;height:5px;left:0;width:5px}&.ag-resizer-left{bottom:5px;cursor:ew-resize;left:0;top:5px;width:5px}}',Jv=typeof window!="object"||!window?.document?.fonts?.forEach,hv=!1,Va=(e,t,i,n,s,o)=>{if(Jv||hv)return;n&&(e=`@layer ${CSS.escape(n)} { ${e} }`);let r=Ia.map.get(t);if(r||(r=[],Ia.map.set(t,r)),r.some(c=>c.css===e))return;let a=document.createElement("style");o&&a.setAttribute("nonce",o),a.dataset.agGlobalCss=i,a.textContent=e;let l={css:e,el:a,priority:s},d;for(let c of r){if(c.priority>s)break;d=c}if(d){d.el.insertAdjacentElement("afterend",a);let c=r.indexOf(d);r.splice(c+1,0,l)}else t.insertBefore(a,t.querySelector(":not(title, meta)")),r.push(l)},G4=(e,t,i,n)=>{Va(JB,e,"shared",t,0,i),n?.forEach((s,o)=>s.forEach(r=>Va(r,e,o,t,0,i)))},QB=e=>{Ia.grids.add(e)},ZB=e=>{if(Ia.grids.delete(e),Ia.grids.size===0){Ia.map=new WeakMap;for(let t of document.head.querySelectorAll("style[data-ag-global-css]"))t.remove()}},xR,Ia=(xR=typeof window=="object"?window:{}).agStyleInjectionState??(xR.agStyleInjectionState={map:new WeakMap,grids:new Set}),Ii=e=>new z4(e),no="$default",eH=0,z4=class{constructor({feature:e,params:t,modeParams:i={},css:n,cssImports:s}){this.feature=e,this.css=n,this.cssImports=s,this.modeParams=b({[no]:b(b({},i[no]??{}),t??{})},i)}use(e,t,i){let n=this._inject;if(n==null){let{css:s}=this;if(s){let o=`ag-theme-${this.feature??"part"}-${++eH}`;typeof s=="function"&&(s=s()),s=`:where(.${o}) {
${s}
}
`;for(let r of this.cssImports??[])s=`@import url(${JSON.stringify(r)});
${s}`;n={css:s,class:o}}else n=!1;this._inject=n}return n&&e&&Va(n.css,e,n.class,t,1,i),n?n.class:!1}},tH=e=>e.replace(/[A-Z]/g,t=>`-${t}`).toLowerCase(),W4=e=>`--ag-${tH(e)}`,Vn=e=>`var(${W4(e)})`,iH=(e,t,i)=>Math.max(t,Math.min(i,e)),nH=e=>{let t=new Map;return i=>{let n=i;return t.has(n)||t.set(n,e(i)),t.get(n)}},Pi=e=>({ref:"accentColor",mix:e}),qi=e=>({ref:"foregroundColor",mix:e}),ai=e=>({ref:"foregroundColor",mix:e,onto:"backgroundColor"}),sH=e=>({ref:"foregroundColor",mix:e,onto:"headerBackgroundColor"}),li={ref:"backgroundColor"},Sa={ref:"foregroundColor"},At={ref:"accentColor"},qp={backgroundColor:"#fff",foregroundColor:"#181d1f",borderColor:qi(.15),chromeBackgroundColor:ai(.02),browserColorScheme:"light"},oH=O(b({},qp),{textColor:Sa,accentColor:"#2196f3",invalidColor:"#e02525",fontFamily:["-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu","Cantarell","Helvetica Neue","sans-serif"],subtleTextColor:{ref:"textColor",mix:.5},borderWidth:1,borderRadius:4,spacing:8,fontSize:14,focusShadow:{spread:3,color:Pi(.5)},focusErrorShadow:{spread:3,color:{ref:"invalidColor",onto:"backgroundColor",mix:.5}},popupShadow:"0 0 16px #00000026",cardShadow:"0 1px 4px 1px #00000018",dropdownShadow:{ref:"cardShadow"},listItemHeight:{calc:"max(iconSize, dataFontSize) + widgetVerticalSpacing"},dragAndDropImageBackgroundColor:li,dragAndDropImageBorder:!0,dragAndDropImageNotAllowedBorder:{color:{ref:"invalidColor",onto:"dragAndDropImageBackgroundColor",mix:.5}},dragAndDropImageShadow:{ref:"popupShadow"},iconSize:16,iconColor:"inherit",toggleButtonWidth:28,toggleButtonHeight:18,toggleButtonOnBackgroundColor:At,toggleButtonOffBackgroundColor:ai(.3),toggleButtonSwitchBackgroundColor:li,toggleButtonSwitchInset:2,tooltipBackgroundColor:{ref:"chromeBackgroundColor"},tooltipErrorBackgroundColor:{ref:"invalidColor",onto:"backgroundColor",mix:.1},tooltipTextColor:{ref:"textColor"},tooltipErrorTextColor:{ref:"invalidColor"},tooltipBorder:!0,tooltipErrorBorder:{color:{ref:"invalidColor",onto:"backgroundColor",mix:.25}}}),rH=["colorScheme","color","length","scale","borderStyle","border","shadow","image","fontFamily","fontWeight","duration"],aH=nH(e=>(e=e.toLowerCase(),rH.find(t=>e.endsWith(t.toLowerCase()))??"length")),ig=e=>typeof e=="object"&&e?.ref?Vn(e.ref):typeof e=="string"?e:typeof e=="number"?String(e):!1,Qv=e=>{if(typeof e=="string")return e;if(e&&"ref"in e){let t=Vn(e.ref);return e.mix==null?t:`color-mix(in srgb, ${e.onto?Vn(e.onto):"transparent"}, ${t} ${iH(e.mix*100,0,100)}%)`}return!1},lH=ig,xa=e=>typeof e=="string"?e:typeof e=="number"?`${e}px`:e&&"calc"in e?`calc(${e.calc.replace(/ ?[*/+] ?/g," $& ").replace(/-?\b[a-z][a-z0-9]*\b(?![-(])/gi,i=>i[0]==="-"?i:" "+Vn(i)+" ")})`:e&&"ref"in e?Vn(e.ref):!1,dH=ig,pv=(e,t)=>typeof e=="string"?e:e===!0?pv({},t):e===!1?t==="columnBorder"?pv({color:"transparent"},t):"none":e&&"ref"in e?Vn(e.ref):U4(e.style??"solid")+" "+xa(e.width??{ref:"borderWidth"})+" "+Qv(e.color??{ref:"borderColor"}),cH=e=>typeof e=="string"?e:e===!1?"none":e&&"ref"in e?Vn(e.ref):[xa(e.offsetX??0),xa(e.offsetY??0),xa(e.radius??0),xa(e.spread??0),Qv(e.color??{ref:"foregroundColor"})].join(" "),U4=ig,q4=e=>typeof e=="string"?e.includes(",")?e:ER(e):e&&"googleFont"in e?q4(e.googleFont):e&&"ref"in e?Vn(e.ref):Array.isArray(e)?e.map(t=>(typeof t=="object"&&"googleFont"in t&&(t=t.googleFont),ER(t))).join(", "):!1,ER=e=>/^[\w-]+$|\w\(/.test(e)?e:JSON.stringify(e),uH=ig,$4=e=>typeof e=="string"?e:e&&"url"in e?`url(${JSON.stringify(e.url)})`:e&&"svg"in e?$4({url:`data:image/svg+xml,${encodeURIComponent(e.svg)}`}):e&&"ref"in e?Vn(e.ref):!1,hH=(e,t,i)=>typeof e=="string"?e:typeof e=="number"?(e>=10&&i.warn(104,{value:e,param:t}),`${e}s`):e&&"ref"in e?Vn(e.ref):!1,pH={color:Qv,colorScheme:lH,length:xa,scale:dH,border:pv,borderStyle:U4,shadow:cH,image:$4,fontFamily:q4,fontWeight:uH,duration:hH},gH=(e,t,i)=>{let n=aH(e);return pH[n](t,e,i)};var fH=e=>new j4(e),j4=class K4{constructor(t,i=[]){this.themeLogger=t,this.parts=i}withPart(t){return typeof t=="function"&&(t=t()),t instanceof z4?new K4(this.themeLogger,[...this.parts,t]):(this.themeLogger.preInitErr(259,"Invalid part",{part:t}),this)}withoutPart(t){return this.withPart(Ii({feature:t}))}withParams(t,i=no){return this.withPart(Ii({modeParams:{[i]:t}}))}_startUse({styleContainer:t,cssLayer:i,nonce:n,loadThemeGoogleFonts:s,moduleCss:o}){if(Jv||hv)return;CH(),G4(t,i,n,o);let r=mH(this);if(r.length>0)for(let a of r)s&&vH(a,n);for(let a of this.parts)a.use(t,i,n)}_getCssClass(){return hv?"ag-theme-quartz":this._cssClassCache??(this._cssClassCache=RR(this.parts).map(t=>t.use(void 0,void 0,void 0)).filter(Boolean).join(" "))}_getModeParams(){let t=this._paramsCache;if(!t){let i={[no]:b({},oH)};for(let n of RR(this.parts))for(let s of Object.keys(n.modeParams)){let o=n.modeParams[s];if(o){let r=i[s]??(i[s]={}),a=new Set;for(let l of Object.keys(o)){let d=o[l];d!==void 0&&(r[l]=d,a.add(l))}if(s===no)for(let l of Object.keys(i)){let d=i[l];if(l!==no)for(let c of a)delete d[c]}}}this._paramsCache=t=i}return t}_getPerInstanceCss(t){let i="##SELECTOR##",n=this._paramsCssCache;if(!n){let s="",o="",r=this._getModeParams();for(let l of Object.keys(r)){let d=r[l];if(l!==no){let u=`:where([data-ag-theme-mode="${typeof CSS=="object"?CSS.escape(l):l}"]) & {
`;s+=u,o+=u}for(let c of Object.keys(d).sort()){let u=d[c],h=gH(c,u,this.themeLogger);if(h===!1)this.themeLogger.error(107,{key:c,value:u});else{let p=W4(c),g=p.replace("--ag-","--ag-inherited-");s+=`	${p}: var(${g}, ${h});
`,o+=`	${g}: var(${p});
`}}l!==no&&(s+=`}
`,o+=`}
`)}let a=`${i} {
${s}}
`;a+=`:has(> ${i}):not(${i}) {
${o}}
`,this._paramsCssCache=n=a}return n.replaceAll(i,`:where(.${t})`)}},RR=e=>{let t=new Map;for(let n of e)t.set(n.feature,n);let i=[];for(let n of e)(!n.feature||t.get(n.feature)===n)&&i.push(n);return i},mH=e=>{let t=new Set,i=o=>{if(Array.isArray(o))o.forEach(i);else{let r=o?.googleFont;typeof r=="string"&&t.add(r)}};return Object.values(e._getModeParams()).flatMap(o=>Object.values(o)).forEach(i),Array.from(t).sort()},MR=!1,CH=()=>{if(!MR){MR=!0;for(let e of Array.from(document.head.querySelectorAll('style[data-ag-scope="legacy"]')))e.remove()}},vH=async(e,t)=>{let i=`@import url('https://${wH}/css2?family=${encodeURIComponent(e)}:wght@100;200;300;400;500;600;700;800;900&display=swap');
`;Va(i,document.head,`googleFont:${e}`,void 0,0,t)},wH="fonts.googleapis.com",bH=1,yH=class{constructor(e){this.beans={},this.createdBeans=[],this.destroyed=!1,this.instanceId=bH++,e?.beanClasses&&(this.beanDestroyComparator=e.beanDestroyComparator,this.init(e))}init(e){this.id=e.id,this.beans.context=this,this.destroyCallback=e.destroyCallback;for(let t of Object.keys(e.providedBeanInstances))this.beans[t]=e.providedBeanInstances[t];for(let t of e.beanClasses){let i=new t;i.beanName?this.beans[i.beanName]=i:console.error(`Bean ${t.name} is missing beanName`),this.createdBeans.push(i)}for(let t of e.derivedBeans??[]){let{beanName:i,bean:n}=t(this);this.beans[i]=n,this.createdBeans.push(n)}e.beanInitComparator&&this.createdBeans.sort(e.beanInitComparator),this.initBeans(this.createdBeans)}getBeanInstances(){return Object.values(this.beans)}createBean(e,t){return this.initBeans([e],t),e}initBeans(e,t){let i=this.beans;for(let n of e)n.preWireBeans?.(i),n.wireBeans?.(i);for(let n of e)n.preConstruct?.();t&&e.forEach(t);for(let n of e)n.postConstruct?.()}getBeans(){return this.beans}getBean(e){return this.beans[e]}getId(){return this.id}destroy(){if(this.destroyed)return;this.destroyed=!0;let e=this.getBeanInstances();this.beanDestroyComparator&&e.sort(this.beanDestroyComparator),this.destroyBeans(e),this.beans={},this.createdBeans=[],this.destroyCallback?.()}destroyBean(e){e?.destroy?.()}destroyBeans(e){if(e)for(let t=0;t<e.length;t++)this.destroyBean(e[t]);return[]}isDestroyed(){return this.destroyed}},SH=0,xH=class extends zn{constructor(){super(...arguments),this.beanName="environment",this.paramsClass=`ag-theme-params-${++SH}`,this.globalCSS=[]}wireBeans(e){this.eRootDiv=e.eRootDiv}postConstruct(){let{gos:e,eRootDiv:t}=this;e.setInstanceDomData(t),this.eStyleContainer=e.get("themeStyleContainer")??(t.getRootNode()===document?document.head:t),this.cssLayer=e.get("themeCssLayer"),this.styleNonce=e.get("styleNonce"),this.addManagedPropertyListener("theme",()=>this.handleThemeChange()),this.handleThemeChange(),this.initVariables(),this.addDestroyFunc(()=>ZB(this)),this.mutationObserver=new MutationObserver(()=>{this.fireStylesChangedEvent("themeChanged")}),this.addDestroyFunc(()=>this.mutationObserver.disconnect())}applyThemeClasses(e,t=[]){let{theme:i}=this,n;i?n=`${this.paramsClass} ${i._getCssClass()}`:n=this.applyLegacyThemeClasses();for(let s of Array.from(e.classList))s.startsWith("ag-theme-")&&e.classList.remove(s);if(n){let s=e.className;e.className=`${s}${s?" ":""}${n}${t?.length?" "+t.join(" "):""}`}}applyLegacyThemeClasses(){let e="";this.mutationObserver.disconnect();let t=this.eRootDiv;for(;t;){let i=!1;for(let n of Array.from(t.classList))n.startsWith("ag-theme-")&&(i=!0,e=e?`${e} ${n}`:n);i&&this.mutationObserver.observe(t,{attributes:!0,attributeFilter:["class"]}),t=t.parentElement}return e}addGlobalCSS(e,t){this.theme?Va(e,this.eStyleContainer,t,this.cssLayer,0,this.styleNonce):this.globalCSS.push([e,t])}handleThemeChange(){let{gos:e,theme:t}=this,i=e.get("theme"),n;if(i==="legacy")n=void 0;else{let s=i??this.getDefaultTheme();s instanceof j4?n=s:this.themeError(s)}n!==t&&this.handleNewTheme(n),this.postProcessThemeChange(n,i)}handleNewTheme(e){let{gos:t,eRootDiv:i,globalCSS:n}=this,s=this.getAdditionalCss();if(e){QB(this),G4(this.eStyleContainer,this.cssLayer,this.styleNonce,s);for(let[r,a]of n)Va(r,this.eStyleContainer,a,this.cssLayer,0,this.styleNonce);n.length=0}this.theme=e,e?._startUse({loadThemeGoogleFonts:t.get("loadThemeGoogleFonts"),styleContainer:this.eStyleContainer,cssLayer:this.cssLayer,nonce:this.styleNonce,moduleCss:s});let o=this.eParamsStyle;if(!o){o=this.eParamsStyle=Wd({tag:"style"});let r=t.get("styleNonce");r&&o.setAttribute("nonce",r),i.appendChild(o)}Jv||(o.textContent=e?._getPerInstanceCss(this.paramsClass)||""),this.applyThemeClasses(i),this.fireStylesChangedEvent("themeChanged")}},EH=class extends zn{constructor(){super(...arguments),this.beanName="registry"}registerDynamicBeans(e){if(e){this.dynamicBeans??(this.dynamicBeans={});for(let t of Object.keys(e))this.dynamicBeans[t]=e[t]}}createDynamicBean(e,t,...i){if(!this.dynamicBeans)throw new Error(this.getDynamicError(e,!0));let n=this.dynamicBeans[e];if(n==null){if(t)throw new Error(this.getDynamicError(e,!1));return}return new n(...i)}},RH=class extends zn{constructor(){super(...arguments),this.beanName="eventSvc",this.eventServiceType="global",this.globalSvc=new rr}addListener(e,t,i){this.globalSvc.addEventListener(e,t,i)}removeListener(e,t,i){this.globalSvc.removeEventListener(e,t,i)}addGlobalListener(e,t=!1){this.globalSvc.addGlobalListener(e,t)}removeGlobalListener(e,t=!1){this.globalSvc.removeGlobalListener(e,t)}dispatchEvent(e){this.globalSvc.dispatchEvent(this.gos.addCommon(e))}dispatchEventOnce(e){this.globalSvc.dispatchEventOnce(this.gos.addCommon(e))}},Y4=class extends zn{constructor(e,t){super(),this.ctrl=e,t&&(this.beans=t)}postConstruct(){this.refreshTooltip()}setBrowserTooltip(e,t){let i="title",n=this.ctrl.getGui();n&&(e!=null&&(e!=""||t)?n.setAttribute(i,e):n.removeAttribute(i))}updateTooltipText(){let{getTooltipValue:e}=this.ctrl;e&&(this.tooltip=e())}createTooltipFeatureIfNeeded(){if(this.tooltipManager==null){let e=this.beans.registry.createDynamicBean("tooltipStateManager",!0,this.ctrl,()=>this.tooltip);e&&(this.tooltipManager=this.createBean(e,this.beans.context))}}attemptToShowTooltip(){this.tooltipManager?.prepareToShowTooltip()}attemptToHideTooltip(){this.tooltipManager?.hideTooltip()}setTooltipAndRefresh(e){this.tooltip=e,this.refreshTooltip()}refreshTooltip(e){this.browserTooltips=this.beans.gos.get("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?(this.setBrowserTooltip(this.tooltip),this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context)):(this.setBrowserTooltip(e?"":null,e),this.createTooltipFeatureIfNeeded())}destroy(){this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context),super.destroy()}},MH=1e3,DH=1e3,DR=100,kR,lp=!1,kH=class extends zn{constructor(e,t){super(),this.tooltipCtrl=e,this.getTooltipValue=t,this.interactionEnabled=!1,this.isInteractingWithTooltip=!1,this.state=0,this.tooltipInstanceCount=0,this.tooltipMouseTrack=!1}wireBeans(e){this.popupSvc=e.popupSvc}postConstruct(){this.gos.get("tooltipInteraction")&&(this.interactionEnabled=!0),this.tooltipTrigger=this.getTooltipTrigger(),this.tooltipMouseTrack=this.gos.get("tooltipMouseTrack");let e=this.tooltipCtrl.getGui();this.tooltipTrigger===0&&this.addManagedListeners(e,{mouseenter:this.onMouseEnter.bind(this),mouseleave:this.onMouseLeave.bind(this)}),this.tooltipTrigger===1&&this.addManagedListeners(e,{focusin:this.onFocusIn.bind(this),focusout:this.onFocusOut.bind(this)}),this.addManagedListeners(e,{mousemove:this.onMouseMove.bind(this)}),this.interactionEnabled||this.addManagedListeners(e,{mousedown:this.onMouseDown.bind(this),keydown:this.onKeyDown.bind(this)})}getGridOptionsTooltipDelay(e){let t=this.gos.get(e);return Math.max(200,t)}getTooltipDelay(e){return e==="show"?this.tooltipCtrl.getTooltipShowDelayOverride?.()??this.getGridOptionsTooltipDelay("tooltipShowDelay"):this.tooltipCtrl.getTooltipHideDelayOverride?.()??this.getGridOptionsTooltipDelay("tooltipHideDelay")}destroy(){this.setToDoNothing(),super.destroy()}getTooltipTrigger(){let e=this.gos.get("tooltipTrigger");return!e||e==="hover"?0:1}onMouseEnter(e){this.interactionEnabled&&this.interactiveTooltipTimeoutId&&(this.unlockService(),this.startHideTimeout()),!nr()&&(lp?this.showTooltipTimeoutId=window.setTimeout(()=>{this.prepareToShowTooltip(e)},DR):this.prepareToShowTooltip(e))}onMouseMove(e){this.lastMouseEvent&&(this.lastMouseEvent=e),this.tooltipMouseTrack&&this.state===2&&this.tooltipComp&&this.positionTooltip()}onMouseDown(){this.setToDoNothing()}onMouseLeave(){this.interactionEnabled?this.lockService():this.setToDoNothing()}onFocusIn(){this.prepareToShowTooltip()}onFocusOut(e){let t=e.relatedTarget,i=this.tooltipCtrl.getGui(),n=this.tooltipComp?.getGui();this.isInteractingWithTooltip||i.contains(t)||this.interactionEnabled&&n?.contains(t)||this.setToDoNothing()}onKeyDown(){this.isInteractingWithTooltip&&(this.isInteractingWithTooltip=!1),this.setToDoNothing()}prepareToShowTooltip(e){if(this.state!=0||lp)return;let t=0;e&&(t=this.isLastTooltipHiddenRecently()?200:this.getTooltipDelay("show")),this.lastMouseEvent=e||null,this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),t),this.state=1}isLastTooltipHiddenRecently(){return Date.now()-kR<MH}setToDoNothing(e){!e&&this.state===2&&this.hideTooltip(),this.onBodyScrollEventCallback&&(this.onBodyScrollEventCallback(),this.onBodyScrollEventCallback=void 0),this.clearEventHandlers(),this.onDocumentKeyDownCallback&&(this.onDocumentKeyDownCallback(),this.onDocumentKeyDownCallback=void 0),this.clearTimeouts(),this.state=0,this.lastMouseEvent=null}showTooltip(){let e=this.getTooltipValue(),t=this.tooltipCtrl;if(!K(e)||t.shouldDisplayTooltip&&!t.shouldDisplayTooltip()){this.setToDoNothing();return}let i=this.gos.addCommon(b({location:t.getLocation?.()??"UNKNOWN",value:e,hideTooltipCallback:()=>this.hideTooltip(!0)},t.getAdditionalParams?.()));this.state=2,this.tooltipInstanceCount++;let n=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.createTooltipComp(i,n)}hideTooltip(e){!e&&this.isInteractingWithTooltip||(this.tooltipComp&&(this.destroyTooltipComp(),kR=Date.now()),this.eventSvc.dispatchEvent({type:"tooltipHide",parentGui:this.tooltipCtrl.getGui()}),e&&(this.isInteractingWithTooltip=!1),this.setToDoNothing(!0))}newTooltipComponentCallback(e,t){if(this.state!==2||this.tooltipInstanceCount!==e){this.destroyBean(t);return}let n=t.getGui();this.tooltipComp=t,n.classList.contains("ag-tooltip")||n.classList.add("ag-tooltip-custom"),this.tooltipTrigger===0&&n.classList.add("ag-tooltip-animate"),this.interactionEnabled&&n.classList.add("ag-tooltip-interactive");let s=this.getLocaleTextFunc(),o=this.popupSvc?.addPopup({eChild:n,ariaLabel:s("ariaLabelTooltip","Tooltip")});if(o&&(this.tooltipPopupDestroyFunc=o.hideFunc),this.positionTooltip(),this.tooltipTrigger===1){let r=()=>this.setToDoNothing();[this.onBodyScrollEventCallback]=this.addManagedEventListeners({bodyScroll:r}),this.setEventHandlers(r)}this.interactionEnabled&&([this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener]=this.addManagedElementListeners(n,{mouseenter:this.onTooltipMouseEnter.bind(this),mouseleave:this.onTooltipMouseLeave.bind(this)}),[this.onDocumentKeyDownCallback]=this.addManagedElementListeners(Ht(this.beans),{keydown:r=>{n.contains(r?.target)||this.onKeyDown()}}),this.tooltipTrigger===1&&([this.tooltipFocusInListener,this.tooltipFocusOutListener]=this.addManagedElementListeners(n,{focusin:this.onTooltipFocusIn.bind(this),focusout:this.onTooltipFocusOut.bind(this)}))),this.eventSvc.dispatchEvent({type:"tooltipShow",tooltipGui:n,parentGui:this.tooltipCtrl.getGui()}),this.startHideTimeout()}onTooltipMouseEnter(){this.isInteractingWithTooltip=!0,this.unlockService()}onTooltipMouseLeave(){this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,this.lockService())}onTooltipFocusIn(){this.isInteractingWithTooltip=!0}isTooltipFocused(){let e=this.tooltipComp?.getGui(),t=ot(this.beans);return!!e&&e.contains(t)}onTooltipFocusOut(e){let t=this.tooltipCtrl.getGui();this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,t.contains(e.relatedTarget)?this.startHideTimeout():this.hideTooltip())}positionTooltip(){let e={type:"tooltip",ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack};this.lastMouseEvent?this.popupSvc?.positionPopupUnderMouseEvent(O(b({},e),{mouseEvent:this.lastMouseEvent})):this.popupSvc?.positionPopupByComponent(O(b({},e),{eventSource:this.tooltipCtrl.getGui(),position:"under",keepWithinBounds:!0,nudgeY:5}))}destroyTooltipComp(){this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");let e=this.tooltipPopupDestroyFunc,t=this.tooltipComp,i=this.tooltipTrigger===0?DH:0;window.setTimeout(()=>{e(),this.destroyBean(t)},i),this.clearTooltipListeners(),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0}clearTooltipListeners(){for(let e of[this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener,this.tooltipFocusInListener,this.tooltipFocusOutListener])e&&e();this.tooltipMouseEnterListener=this.tooltipMouseLeaveListener=this.tooltipFocusInListener=this.tooltipFocusOutListener=null}lockService(){lp=!0,this.interactiveTooltipTimeoutId=window.setTimeout(()=>{this.unlockService(),this.setToDoNothing()},DR)}unlockService(){lp=!1,this.clearInteractiveTimeout()}startHideTimeout(){this.clearHideTimeout(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.getTooltipDelay("hide"))}clearShowTimeout(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0)}clearHideTimeout(){this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)}clearInteractiveTimeout(){this.interactiveTooltipTimeoutId&&(window.clearTimeout(this.interactiveTooltipTimeoutId),this.interactiveTooltipTimeoutId=void 0)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout(),this.clearInteractiveTimeout()}},PH=class extends Y4{constructor(e,t,i){super(e,i),this.highlightTracker=t,this.onHighlight=this.onHighlight.bind(this)}postConstruct(){super.postConstruct(),this.wireHighlightListeners()}wireHighlightListeners(){this.addManagedPropertyListener("tooltipTrigger",({currentValue:e})=>{this.setTooltipMode(e)}),this.setTooltipMode(this.gos.get("tooltipTrigger")),this.highlightTracker.addEventListener("itemHighlighted",this.onHighlight)}onHighlight(e){this.tooltipMode===1&&(e.highlighted?this.attemptToShowTooltip():this.attemptToHideTooltip())}setTooltipMode(e="focus"){this.tooltipMode=e==="focus"?1:0}destroy(){this.highlightTracker.removeEventListener("itemHighlighted",this.onHighlight),super.destroy()}},dp=0,FH=200,TH=class extends zn{constructor(){super(...arguments),this.beanName="popupSvc",this.popupList=[]}getPopupParent(){let e=this.gos.get("popupParent");return e||this.getDefaultPopupParent()}positionPopupUnderMouseEvent(e){let{ePopup:t,nudgeX:i,nudgeY:n,skipObserver:s}=e;this.positionPopup({ePopup:t,nudgeX:i,nudgeY:n,keepWithinBounds:!0,skipObserver:s,updatePosition:()=>this.calculatePointerAlign(e.mouseEvent),postProcessCallback:()=>this.callPostProcessPopup(e,e.type,e.ePopup,null,e.mouseEvent)})}calculatePointerAlign(e){let t=this.getParentRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}positionPopupByComponent(e){let{ePopup:t,nudgeX:i,nudgeY:n,keepWithinBounds:s,eventSource:o,alignSide:r="left",position:a="over",type:l}=e,d=o.getBoundingClientRect(),c=this.getParentRect();this.setAlignedTo(o,t);let u=()=>{let h=d.left-c.left;r==="right"&&(h-=t.offsetWidth-d.width);let p;return a==="over"?(p=d.top-c.top,this.setAlignedStyles(t,"over")):(this.setAlignedStyles(t,"under"),this.shouldRenderUnderOrAbove(t,d,c,e.nudgeY||0)==="under"?p=d.top-c.top+d.height:p=d.top-t.offsetHeight-(n||0)*2-c.top),{x:h,y:p}};this.positionPopup({ePopup:t,nudgeX:i,nudgeY:n,keepWithinBounds:s,updatePosition:u,postProcessCallback:()=>this.callPostProcessPopup(e,l,t,o,null)})}shouldRenderUnderOrAbove(e,t,i,n){let s=i.bottom-t.bottom,o=t.top-i.top,r=e.offsetHeight+n;return s>r?"under":o>r||o>s?"above":"under"}setAlignedStyles(e,t){let i=this.getPopupIndex(e);if(i===-1)return;let n=this.popupList[i],{alignedToElement:s}=n;if(!s)return;let o=["right","left","over","above","under"];for(let r of o)s.classList.remove(`ag-has-popup-positioned-${r}`),e.classList.remove(`ag-popup-positioned-${r}`);t&&(s.classList.add(`ag-has-popup-positioned-${t}`),e.classList.add(`ag-popup-positioned-${t}`))}setAlignedTo(e,t){let i=this.getPopupIndex(t);if(i!==-1){let n=this.popupList[i];n.alignedToElement=e}}positionPopup(e){let{ePopup:t,keepWithinBounds:i,nudgeX:n,nudgeY:s,skipObserver:o,updatePosition:r}=e,a={width:0,height:0},l=(d=!1)=>{let{x:c,y:u}=r();d&&t.clientWidth===a.width&&t.clientHeight===a.height||(a.width=t.clientWidth,a.height=t.clientHeight,n&&(c+=n),s&&(u+=s),i&&(c=this.keepXYWithinBounds(t,c,1),u=this.keepXYWithinBounds(t,u,0)),t.style.left=`${c}px`,t.style.top=`${u}px`,e.postProcessCallback&&e.postProcessCallback())};if(l(),!o){let d=uo(this.beans,t,()=>l(!0));setTimeout(()=>d(),FH)}}getParentRect(){let e=Ht(this.beans),t=this.getPopupParent();return t===e.body?t=e.documentElement:getComputedStyle(t).position==="static"&&(t=t.offsetParent),B6(t)}keepXYWithinBounds(e,t,i){let n=i===0,s=n?"clientHeight":"clientWidth",o=n?"top":"left",r=n?"height":"width",a=n?"scrollTop":"scrollLeft",l=Ht(this.beans),d=l.documentElement,c=this.getPopupParent(),u=e.getBoundingClientRect(),h=c.getBoundingClientRect(),p=l.documentElement.getBoundingClientRect(),g=c===l.body,f=Math.ceil(u[r]),C=g?(n?N6:Tp)(d)+d[a]:c[s];g&&(C-=Math.abs(p[o]-h[o]));let v=C-f;return Math.min(Math.max(t,0),Math.max(v,0))}addPopup(e){let{eChild:t,ariaLabel:i,ariaOwns:n,alwaysOnTop:s,positionCallback:o,anchorToElement:r}=e,a=this.getPopupIndex(t);if(a!==-1)return{hideFunc:this.popupList[a].hideFunc};this.initialisePopupPosition(t);let l=this.createPopupWrapper(t,!!s,i,n),d=this.addEventListenersToPopup(O(b({},e),{wrapperEl:l}));return o&&o(),this.addPopupToPopupList(t,l,d,r),{hideFunc:d}}initialisePopupPosition(e){let i=this.getPopupParent().getBoundingClientRect();K(e.style.top)||(e.style.top=`${i.top*-1}px`),K(e.style.left)||(e.style.left=`${i.left*-1}px`)}createPopupWrapper(e,t,i,n){let s=this.getPopupParent(),{environment:o,gos:r}=this.beans,a=Wd({tag:"div"});return o.applyThemeClasses(a),a.classList.add("ag-popup"),e.classList.add(r.get("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),e.hasAttribute("role")||oo(e,"dialog"),i?Na(e,i):n&&(e.id||(e.id=`popup-component-${dp}`),aR(n,e.id)),a.appendChild(e),s.appendChild(a),t?this.setAlwaysOnTop(e,!0):this.bringPopupToFront(e),a}addEventListenersToPopup(e){let t=this.beans,i=Ht(t),{wrapperEl:n,eChild:s,closedCallback:o,afterGuiAttached:r,closeOnEsc:a,modal:l,ariaOwns:d}=e,c=!1,u=f=>{if(!n.contains(ot(t)))return;f.key===k.ESCAPE&&!this.isStopPropagation(f)&&g({keyboardEvent:f})},h=f=>g({mouseEvent:f}),p=f=>g({touchEvent:f}),g=(f={})=>{let{mouseEvent:m,touchEvent:C,keyboardEvent:v,forceHide:w}=f;!w&&(this.isEventFromCurrentPopup({mouseEvent:m,touchEvent:C},s)||c)||(c=!0,n.remove(),i.removeEventListener("keydown",u),i.removeEventListener("mousedown",h),i.removeEventListener("touchstart",p),i.removeEventListener("contextmenu",h),this.eventSvc.removeListener("dragStarted",h),o&&o(m||C||v),this.removePopupFromPopupList(s,d))};return r&&r({hidePopup:g}),window.setTimeout(()=>{a&&i.addEventListener("keydown",u),l&&(i.addEventListener("mousedown",h),this.eventSvc.addListener("dragStarted",h),i.addEventListener("touchstart",p),i.addEventListener("contextmenu",h))},0),g}addPopupToPopupList(e,t,i,n){this.popupList.push({element:e,wrapper:t,hideFunc:i,instanceId:dp,isAnchored:!!n}),n&&this.setPopupPositionRelatedToElement(e,n),dp=dp+1}getPopupIndex(e){return this.popupList.findIndex(t=>t.element===e)}setPopupPositionRelatedToElement(e,t){let i=this.getPopupIndex(e);if(i===-1)return;let n=this.popupList[i];if(n.stopAnchoringPromise&&n.stopAnchoringPromise.then(o=>o&&o()),n.stopAnchoringPromise=void 0,n.isAnchored=!1,!t)return;let s=this.keepPopupPositionedRelativeTo({element:t,ePopup:e,hidePopup:n.hideFunc});return n.stopAnchoringPromise=s,n.isAnchored=!0,s}removePopupFromPopupList(e,t){this.setAlignedStyles(e,null),this.setPopupPositionRelatedToElement(e,null),t&&aR(t,null),this.popupList=this.popupList.filter(i=>i.element!==e)}keepPopupPositionedRelativeTo(e){let t=this.getPopupParent(),i=t.getBoundingClientRect(),{element:n,ePopup:s}=e,o=n.getBoundingClientRect(),r=u=>Number.parseInt(u.substring(0,u.length-1),10),a=(u,h)=>{let p=i[u]-o[u],g=r(s.style[u]);return{initialDiff:p,lastDiff:p,initial:g,last:g,direction:h}},l=a("top",0),d=a("left",1),c=this.beans.frameworkOverrides;return new lt(u=>{c.wrapIncoming(()=>{GN(()=>{let h=t.getBoundingClientRect(),p=n.getBoundingClientRect();if(p.top==0&&p.left==0&&p.height==0&&p.width==0){e.hidePopup();return}let f=(m,C)=>{let v=r(s.style[C]);m.last!==v&&(m.initial=v,m.last=v);let w=h[C]-p[C];if(w!=m.lastDiff){let y=this.keepXYWithinBounds(s,m.initial+m.initialDiff-w,m.direction);s.style[C]=`${y}px`,m.last=y}m.lastDiff=w};f(l,"top"),f(d,"left")},200).then(h=>{u(()=>{h!=null&&window.clearInterval(h)})})},"popupPositioning")})}isEventFromCurrentPopup(e,t){let{mouseEvent:i,touchEvent:n}=e,s=i||n;if(!s)return!1;let o=this.getPopupIndex(t);if(o===-1)return!1;for(let r=o;r<this.popupList.length;r++){let a=this.popupList[r];if(RO(a.element,s))return!0}return this.isElementWithinCustomPopup(s.target)}isElementWithinCustomPopup(e){let t=Ht(this.beans);for(;e&&e!==t.body;){if(e.classList.contains("ag-custom-component-popup")||e.parentElement===null)return!0;e=e.parentElement}return!1}getWrapper(e){for(;!e.classList.contains("ag-popup")&&e.parentElement;)e=e.parentElement;return e.classList.contains("ag-popup")?e:null}setAlwaysOnTop(e,t){let i=this.getWrapper(e);i&&(i.classList.toggle("ag-always-on-top",!!t),t&&this.bringPopupToFront(i))}bringPopupToFront(e){let t=this.getPopupParent(),i=Array.prototype.slice.call(t.querySelectorAll(".ag-popup")),n=i.length,s=this.getWrapper(e);if(!s||n<=1||!t.contains(e))return;let o=[],r=[];for(let h of i)h!==s&&(h.classList.contains("ag-always-on-top")?r.push(h):o.push(h));let a=[],l=r.length,u=s.classList.contains("ag-always-on-top")||!l?[...o,...r,s]:[...o,s,...r];for(let h=0;h<=n;h++){let p=u[h];if(i[h]===u[h]||p===s)continue;let g=p.querySelectorAll("div");for(let f of g)f.scrollTop!==0&&a.push([f,f.scrollTop]);h===0?t.insertAdjacentElement("afterbegin",p):u[h-1].insertAdjacentElement("afterend",p)}for(;a.length;){let h=a.pop();h[0].scrollTop=h[1]}}},AH=class extends qv{constructor(){super({tag:"div",cls:"ag-tooltip"})}init(e){let{value:t}=e,i=this.getGui();i.textContent=Wa(t);let n=e.location.replace(/([a-z])([A-Z0-9])/g,"$1-$2").toLowerCase();i.classList.add(`ag-${n}-tooltip`)}},X4=(e,t)=>{if(t!=null&&e?.setPointerCapture)try{return e.setPointerCapture(t),e.hasPointerCapture(t)}catch{}return!1},IH=(e,t)=>{if(typeof PointerEvent>"u"||!(t instanceof PointerEvent))return null;let i=t.pointerId;if(!X4(e,i))return null;let n={eElement:e,pointerId:i,onLost(s){LH(n,s)}};return e.addEventListener("lostpointercapture",n.onLost),n},_H=e=>{if(!e)return;J4(e);let{eElement:t,pointerId:i}=e;if(t){try{t.releasePointerCapture(i)}catch{}e.eElement=null}},J4=e=>{let{eElement:t,onLost:i}=e;t&&i&&(t.removeEventListener("lostpointercapture",i),e.onLost=null)},LH=(e,t)=>{J4(e);let{eElement:i,pointerId:n}=e;i&&t.pointerId===n&&X4(i,n)},Ca,Ea,ws=e=>{if(!Ea)Ea=new WeakSet;else if(Ea.has(e))return!1;return Ea.add(e),!0},OH=class extends zn{constructor(){super(...arguments),this.beanName="dragSvc",this.dragging=!1,this.drag=null,this.dragSources=[]}get startTarget(){return this.drag?.start.target??null}isPointer(){return!!Ca?.has(_n(this.beans))}hasPointerCapture(){let e=this.drag?.pointerCapture;return!!(e&&this.beans.eRootDiv.hasPointerCapture?.(e.pointerId))}destroy(){this.drag&&this.cancelDrag();let e=this.dragSources;for(let t of e)PR(t);e.length=0,super.destroy()}removeDragSource(e){let t=this.dragSources;for(let i=0,n=t.length;i<n;++i){let s=t[i];if(s.params===e){t.splice(i,1),PR(s);break}}}addDragSource(e){if(!this.isAlive())return;let{eElement:t,includeTouch:i}=e,n=[],s;if(i){let d=t.style;d&&(s=d.touchAction,d.touchAction="none")}let o={handlers:n,params:e,oldTouchAction:s};this.dragSources.push(o),wp(n,[t,"pointerdown",d=>this.onPointerDown(e,d),{passive:!1}],[t,"mousedown",d=>this.onMouseDown(e,d)]);let l=this.gos.get("suppressTouch");i&&!l&&wp(n,[t,"touchstart",c=>this.onTouchStart(e,c),{passive:!1}])}cancelDrag(e){let t=this.drag;e??(e=t?.eElement),e&&this.eventSvc.dispatchEvent({type:"dragCancelled",target:e}),t?.params.onDragCancel?.(),this.destroyDrag()}shouldPreventMouseEvent(e){let t=e.type;return(t==="mousemove"||t==="pointermove")&&e.cancelable&&Id(this.beans,e)&&!bd(kC(e))}initDrag(e,...t){this.drag=e;let i=this.beans,n=a=>this.onScroll(a),s=a=>this.onKeyDown(a),o=_n(i),r=Ht(i);wp(e.handlers,[o,"contextmenu",io],[o,"keydown",s],[r,"scroll",n,{capture:!0}],[r.defaultView||window,"scroll",n],...t)}destroyDrag(){this.dragging=!1;let e=this.drag;if(e){let t=e.rootEl;Ca?.get(t)===e&&Ca?.delete(t),this.drag=null,_H(e.pointerCapture),Bv(e.handlers)}}onPointerDown(e,t){if(this.isPointer())return;let i=this.beans;if(Ea?.has(t))return;let n=t.pointerType;if(n==="touch"&&(i.gos.get("suppressTouch")||!e.includeTouch||(e.stopPropagationForTouch&&t.stopPropagation(),bd(kC(t))))||!t.isPrimary||n==="mouse"&&t.button!==0)return;this.destroyDrag();let s=_n(i),o=e.eElement,r=t.pointerId,a=new DC(s,e,t,r);Ca??(Ca=new WeakMap),Ca.set(s,a);let l=u=>{u.pointerId===r&&this.onMouseOrPointerMove(u)},d=u=>{u.pointerId===r&&this.onMouseOrPointerUp(u)},c=u=>{u.pointerId===r&&ws(u)&&this.cancelDrag()};this.initDrag(a,[s,"pointerup",d],[s,"pointercancel",c],[s,"pointermove",l,{passive:!1}],[s,"touchmove",io,{passive:!1}],[o,"mousemove",io,{passive:!1}]),e.dragStartPixels===0?this.onMouseOrPointerMove(t):ws(t)}onTouchStart(e,t){if(this.gos.get("suppressTouch")||!e.includeTouch||!ws(t)||bd(kC(t)))return;if(e.stopPropagationForTouch&&t.stopPropagation(),this.isPointer()){io(t);return}this.destroyDrag();let n=this.beans,s=_n(n),o=new DC(s,e,t.touches[0]),r=d=>this.onTouchMove(d),a=d=>this.onTouchUp(d),l=t.target??e.eElement;this.initDrag(o,[_n(n),"touchmove",io,{passive:!1}],[l,"touchmove",r,{passive:!0}],[l,"touchend",a,{passive:!0}],[l,"touchcancel",a,{passive:!0}]),e.dragStartPixels===0&&this.onMove(o.start)}onMouseDown(e,t){if(t.button!==0||Ea?.has(t)||this.isPointer())return;let i=this.beans;this.destroyDrag();let n=new DC(_n(i),e,t),s=a=>this.onMouseOrPointerMove(a),o=a=>this.onMouseOrPointerUp(a),r=_n(i);this.initDrag(n,[r,"mousemove",s],[r,"mouseup",o]),e.dragStartPixels===0?this.onMouseOrPointerMove(t):ws(t)}onScroll(e){if(!ws(e))return;let t=this.drag,i=t?.lastDrag;i&&this.dragging&&t.params?.onDragging(i)}onMouseOrPointerMove(e){ws(e)&&(po()&&Ht(this.beans).getSelection()?.removeAllRanges(),this.shouldPreventMouseEvent(e)&&io(e),this.onMove(e))}onTouchMove(e){let t=this.drag;if(!t||!ws(e))return;let i=Sd(t.start,e.touches);i&&(e.preventDefault(),this.onMove(i))}onMove(e){let t=this.drag;if(!t)return;t.lastDrag=e;let i=t.params;if(!this.dragging){let n=t.start,o=i.dragStartPixels??4;if(q6(e,n,o)||(this.dragging=!0,i.capturePointer&&(t.pointerCapture=IH(this.beans.eRootDiv,e)),this.eventSvc.dispatchEvent({type:"dragStarted",target:i.eElement}),i.onDragStart(n),this.drag!==t)||(i.onDragging(n),this.drag!==t))return}i.onDragging(e)}onTouchUp(e){let t=this.drag;t&&ws(e)&&this.onUp(Sd(t.start,e.changedTouches))}onMouseOrPointerUp(e){ws(e)&&this.onUp(e)}onUp(e){let t=this.drag;t&&(e||(e=t.lastDrag),e&&this.dragging&&(this.dragging=!1,t.params.onDragStop(e),this.eventSvc.dispatchEvent({type:"dragStopped",target:t.params.eElement})),this.destroyDrag())}onKeyDown(e){e.key===k.ESCAPE&&this.cancelDrag()}},PR=e=>{Bv(e.handlers);let t=e.oldTouchAction;if(t!=null){let i=e.params.eElement.style;i&&(i.touchAction=t)}},DC=class{constructor(e,t,i,n=null){this.rootEl=e,this.params=t,this.start=i,this.pointerId=n,this.handlers=[],this.lastDrag=null,this.pointerCapture=null,this.eElement=t.eElement}},kC=e=>{let t=e.target;return t instanceof Element?t:null},NH=class extends zn{constructor(){super(...arguments),this.beanName="dragAndDrop",this.dragSourceAndParamsList=[],this.dragItem=null,this.dragInitialSourcePointerOffsetX=0,this.dragInitialSourcePointerOffsetY=0,this.lastMouseEvent=null,this.lastDraggingEvent=null,this.dragSource=null,this.dragImageParent=null,this.dragImageCompPromise=null,this.dragImageComp=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0,this.dropTargets=[],this.lastDropTarget=null}addDragSource(e,t=!1){let i={capturePointer:!0,dragSource:e,eElement:e.eElement,dragStartPixels:e.dragStartPixels,onDragStart:n=>this.onDragStart(e,n),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),onDragCancel:this.onDragCancel.bind(this),includeTouch:t};this.dragSourceAndParamsList.push(i),this.beans.dragSvc.addDragSource(i)}setDragImageCompIcon(e,t=!1){let i=this.dragImageComp;i&&(t||this.dragImageLastIcon!==e)&&(this.dragImageLastIcon=e,i.setIcon(e,t))}removeDragSource(e){let{dragSourceAndParamsList:t,beans:i}=this,n=t.find(s=>s.dragSource===e);n&&(i.dragSvc?.removeDragSource(n),an(t,n))}destroy(){let{dragSourceAndParamsList:e,dropTargets:t,beans:i}=this,n=i.dragSvc;for(let s of e)n?.removeDragSource(s);e.length=0,t.length=0,this.clearDragAndDropProperties(),super.destroy()}nudge(){let e=this.lastMouseEvent;e&&this.onDragging(e,!0)}onDragStart(e,t){this.lastMouseEvent=t,this.dragSource=e,this.dragItem=e.getDragItem();let i=e.eElement.getBoundingClientRect();this.dragInitialSourcePointerOffsetX=t.clientX-i.left,this.dragInitialSourcePointerOffsetY=t.clientY-i.top,e.onDragStarted?.(),this.createAndUpdateDragImageComp(e)}onDragStop(e){let{dragSource:t,lastDropTarget:i}=this;if(t?.onDragStopped?.(),i){let n=this.dropTargetEvent(i,e,!1);i.onDragStop?.(n)}this.clearDragAndDropProperties()}onDragCancel(){let{dragSource:e,lastDropTarget:t,lastMouseEvent:i}=this;if(e?.onDragCancelled?.(),t&&i){let n=this.dropTargetEvent(t,i,!1);t.onDragCancel?.(n)}this.clearDragAndDropProperties()}onDragging(e,t=!1){this.positionDragImageComp(e);let i=this.findCurrentDropTarget(e),{lastDropTarget:n,dragSource:s,dragItem:o}=this,r=!1;if(i!==n){if(r=!0,n){let a=this.dropTargetEvent(n,e,t);n.onDragLeave?.(a)}if(n!==null&&!i?this.handleExit(s,o):n===null&&i&&this.handleEnter(s,o),i){let a=this.dropTargetEvent(i,e,t);i.onDragEnter?.(a)}this.lastDropTarget=i}else if(i){let a=this.dropTargetEvent(i,e,t);i.onDragging?.(a),a?.changed&&(r=!0)}this.lastMouseEvent=e,r&&this.updateDragImageComp()}clearDragAndDropProperties(){this.removeDragImageComp(this.dragImageComp),this.dragImageCompPromise=null,this.dragImageParent=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0,this.lastMouseEvent=null,this.lastDraggingEvent=null,this.lastDropTarget=null,this.dragItem=null,this.dragInitialSourcePointerOffsetX=0,this.dragInitialSourcePointerOffsetY=0,this.dragSource=null}getAllContainersFromDropTarget(e){let t=e.getSecondaryContainers?e.getSecondaryContainers():null,i=[[e.getContainer()]];return t?i.concat(t):i}isMouseOnDropTarget(e,t){let i=this.getAllContainersFromDropTarget(t),n=!1,s=(a,l)=>{for(let d of l){let{width:c,height:u,left:h,right:p,top:g,bottom:f}=d.getBoundingClientRect();if(c===0||u===0)return!1;let m=a.clientX>=h&&a.clientX<p,C=a.clientY>=g&&a.clientY<f;if(!m||!C)return!1}return!0};for(let a of i)if(s(e,a)){n=!0;break}let{eElement:o,type:r}=this.dragSource;return t.targetContainsSource&&!t.getContainer().contains(o)?!1:n&&t.isInterestedIn(r,o)}findCurrentDropTarget(e){let t=this.dropTargets.filter(o=>this.isMouseOnDropTarget(e,o)),i=t.length;if(i===0)return null;if(i===1)return t[0];let s=_n(this.beans).elementsFromPoint(e.clientX,e.clientY);for(let o of s)for(let r of t)if(this.getAllContainersFromDropTarget(r).flatMap(l=>l).indexOf(o)!==-1)return r;return null}addDropTarget(e){this.dropTargets.push(e)}removeDropTarget(e){this.dropTargets=this.dropTargets.filter(t=>t.getContainer()!==e.getContainer())}hasExternalDropZones(){return this.dropTargets.some(e=>e.external)}findExternalZone(e){return this.dropTargets.find(t=>t.external&&t.getContainer()===e)||null}dropTargetEvent(e,t,i){let{dragSource:n,dragItem:s,lastDraggingEvent:o,lastMouseEvent:r,dragInitialSourcePointerOffsetX:a,dragInitialSourcePointerOffsetY:l}=this,d=e.getContainer(),c=d.getBoundingClientRect(),{clientX:u,clientY:h}=t,p=u-(r?.clientX||0),g=h-(r?.clientY||0),f=this.createEvent({event:t,x:u-c.left,y:h-c.top,vDirection:g>0?"down":g<0?"up":null,hDirection:p<0?"left":p>0?"right":null,initialSourcePointerOffsetX:a,initialSourcePointerOffsetY:l,dragSource:n,fromNudge:i,dragItem:s,dropZoneTarget:d,dropTarget:o?.dropTarget??null,changed:!!o?.changed});return this.lastDraggingEvent=f,f}positionDragImageComp(e){let t=this.dragImageComp?.getGui();t&&FO(t,e,this.beans)}removeDragImageComp(e){this.dragImageComp===e&&(this.dragImageComp=null),e&&(e.getGui()?.remove(),this.destroyBean(e))}createAndUpdateDragImageComp(e){let t=this.createDragImageComp(e)??null;this.dragImageCompPromise=t,t?.then(i=>{if(t!==this.dragImageCompPromise||!this.lastMouseEvent||!this.isAlive()){this.destroyBean(i);return}this.dragImageCompPromise=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0;let n=this.dragImageComp;n!==i&&(this.dragImageComp=i,this.removeDragImageComp(n)),i&&(this.appendDragImageComp(i),this.updateDragImageComp())})}appendDragImageComp(e){let t=e.getGui(),i=t.style;i.position="absolute",i.zIndex="9999",this.beans.dragSvc?.hasPointerCapture()&&(i.pointerEvents="none"),this.gos.setInstanceDomData(t),this.beans.environment.applyThemeClasses(t),i.top="20px",i.left="20px";let n=Av(this.beans);this.dragImageParent=n,n?n.appendChild(t):this.warnNoBody()}updateDragImageComp(){let{dragImageComp:e,dragSource:t,lastDropTarget:i,lastDraggingEvent:n,dragImageLastLabel:s}=this;if(!e)return;this.setDragImageCompIcon(i?.getIconName?.(n)??null);let o=t?.dragItemName;typeof o=="function"&&(o=o(n)),o||(o=""),s!==o&&(this.dragImageLastLabel=o,e.setLabel(o))}};var BH=class extends NH{createEvent(e){return ae(this.gos,e)}createDragImageComp(e){let{gos:t,beans:i}=this;return aB(i.userCompFactory,ae(t,{dragSource:e}))?.newAgStackInstance()}handleEnter(e,t){e?.onGridEnter?.(t)}handleExit(e,t){e?.onGridExit?.(t)}warnNoBody(){I(54)}isDropZoneWithinThisGrid(e){return this.beans.ctrlsSvc.getGridBodyCtrl().eGridBody.contains(e.dropZoneTarget)}registerGridDropTarget(e,t){let i={getContainer:e,isInterestedIn:n=>n===1||n===0,getIconName:()=>"notAllowed"};this.addDropTarget(i),t.addDestroyFunc(()=>this.removeDropTarget(i))}};function Q4(e,t){return e+"_"+t}function vt(e){return e instanceof Bd}var Bd=class extends F{constructor(e,t,i,n){super(),this.providedColumnGroup=e,this.groupId=t,this.partId=i,this.pinned=n,this.isColumn=!1,this.displayedChildren=[],this.autoHeaderHeight=null,this.parent=null,this.colIdSanitised=wd(this.getUniqueId())}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}getUniqueId(){return Q4(this.groupId,this.partId)}isEmptyGroup(){return this.displayedChildren.length===0}isMoving(){let e=this.getProvidedColumnGroup().getLeafColumns();return!e||e.length===0?!1:e.every(t=>t.isMoving())}checkLeft(){for(let e of this.displayedChildren)vt(e)&&e.checkLeft();if(this.displayedChildren.length>0)if(this.gos.get("enableRtl")){let t=je(this.displayedChildren).getLeft();this.setLeft(t)}else{let e=this.displayedChildren[0].getLeft();this.setLeft(e)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(e){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchLocalEvent({type:"leftChanged"}))}getPinned(){return this.pinned}getGroupId(){return this.groupId}getPartId(){return this.partId}getActualWidth(){let e=0;for(let t of this.displayedChildren??[])e+=t.getActualWidth();return e}isResizable(){if(!this.displayedChildren)return!1;let e=!1;for(let t of this.displayedChildren)t.isResizable()&&(e=!0);return e}getMinWidth(){let e=0;for(let t of this.displayedChildren)e+=t.getMinWidth();return e}addChild(e){this.children||(this.children=[]),this.children.push(e)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){let e=[];return this.addLeafColumns(e),e}getDisplayedLeafColumns(){let e=[];return this.addDisplayedLeafColumns(e),e}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(e){this.providedColumnGroup.setExpanded(e)}isAutoHeaderHeight(){return!!this.getColGroupDef()?.autoHeaderHeight}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){let t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}addDisplayedLeafColumns(e){for(let t of this.displayedChildren??[])lo(t)?e.push(t):vt(t)&&t.addDisplayedLeafColumns(e)}addLeafColumns(e){for(let t of this.children??[])lo(t)?e.push(t):vt(t)&&t.addLeafColumns(e)}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){let e=this.getParent();return!this.isPadding()||!e?.isPadding()?0:1+e.getPaddingLevel()}calculateDisplayedColumns(){this.displayedChildren=[];let e=this;for(;e?.isPadding();)e=e.getParent();if(!(e?e.getProvidedColumnGroup().isExpandable():!1)){this.displayedChildren=this.children,this.dispatchLocalEvent({type:"displayedChildrenChanged"});return}for(let i of this.children??[]){if(vt(i)&&!i.displayedChildren?.length)continue;switch(i.getColumnGroupShow()){case"open":e.getProvidedColumnGroup().isExpanded()&&this.displayedChildren.push(i);break;case"closed":e.getProvidedColumnGroup().isExpanded()||this.displayedChildren.push(i);break;default:this.displayedChildren.push(i);break}}this.dispatchLocalEvent({type:"displayedChildrenChanged"})}},gv="row-group-",Zv="t-",ew="b-",HH=0,co=class{constructor(e){this.master=!1,this.detail=void 0,this.rowIndex=null,this.key=null,this.sourceRowIndex=-1,this._leafs=void 0,this.childrenMapped=null,this.treeParent=null,this.treeNodeFlags=0,this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=HH++,this.alreadyRendered=!1,this.hovered=!1,this.__selected=!1,this.beans=e}get allLeafChildren(){let e=this._leafs;return e===void 0?this.beans.groupStage?.loadLeafs?.(this)??null:e}set allLeafChildren(e){this._leafs=e}setData(e){this.setDataCommon(e,!1)}updateData(e){this.setDataCommon(e,!0)}setDataCommon(e,t){let{valueCache:i,eventSvc:n}=this.beans,s=this.data;this.data=e,i?.onDataChanged(),this.updateDataOnDetailNode(),this.resetQuickFilterAggregateText();let o=this.createDataChangedEvent(e,s,t);if(this.__localEventService?.dispatchEvent(o),this.sibling){this.sibling.data=e;let a=this.sibling.createDataChangedEvent(e,s,t);this.sibling.__localEventService?.dispatchEvent(a)}n.dispatchEvent({type:"rowNodeDataChanged",node:this});let r=this.pinnedSibling;r&&(r.data=e,r.__localEventService?.dispatchEvent(r.createDataChangedEvent(e,s,t)),n.dispatchEvent({type:"rowNodeDataChanged",node:r}))}updateDataOnDetailNode(){let e=this.detailNode;e&&(e.data=this.data)}createDataChangedEvent(e,t,i){return{type:"dataChanged",node:this,oldData:t,newData:e,update:i}}getRowIndexString(){return this.rowIndex==null?(Ge(13),null):this.rowPinned==="top"?Zv+this.rowIndex:this.rowPinned==="bottom"?ew+this.rowIndex:this.rowIndex.toString()}setDataAndId(e,t){let{selectionSvc:i}=this.beans,n=i?.createDaemonNode?.(this),s=this.data;this.data=e,this.updateDataOnDetailNode(),this.setId(t),i&&(i.updateRowSelectable(this),i.syncInRowNode(this,n));let o=this.createDataChangedEvent(e,s,!1);this.__localEventService?.dispatchEvent(o)}setId(e){let t=Ba(this.beans.gos);if(t)if(this.data){let i=this.parent?.getRoute()??[];this.id=t({data:this.data,parentKeys:i.length>0?i:void 0,level:this.level,rowPinned:this.rowPinned}),this.id.startsWith(gv)&&Ge(14,{groupPrefix:gv})}else this.id=void 0;else this.id=e}setRowTop(e){if(this.oldRowTop=this.rowTop,this.rowTop===e)return;this.rowTop=e,this.dispatchRowEvent("topChanged");let t=e!==null;this.displayed!==t&&(this.displayed=t,this.dispatchRowEvent("displayedChanged"))}clearRowTopAndRowIndex(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}setHovered(e){this.hovered=e}isHovered(){return this.hovered}setRowHeight(e,t=!1){this.rowHeight=e,this.rowHeightEstimated=t,this.dispatchRowEvent("heightChanged")}setExpanded(e,t,i){this.beans.expansionSvc?.setExpanded(this,e,t,i)}setDataValue(e,t,i){let{colModel:n,valueSvc:s,gos:o,editSvc:r}=this.beans,a=typeof e!="string"?e:n.getCol(e)??n.getColDefCol(e);if(!a)return!1;let l=s.getValueForDisplay(a,this,void 0,void 0,"api").value;if(o.get("readOnlyEdit")){let{beans:{eventSvc:c},data:u,rowIndex:h,rowPinned:p}=this;return c.dispatchEvent({type:"cellEditRequest",event:null,rowIndex:h,rowPinned:p,column:a,colDef:a.colDef,data:u,node:this,oldValue:l,newValue:t,value:t,source:i}),!1}if(r&&!r.committing){let c=r.setDataValue({rowNode:this,column:a},t,i);if(c!=null)return c}let d=s.setValue(this,a,t,i);return this.dispatchCellChangedEvent(a,t,l),d&&this.pinnedSibling?.dispatchCellChangedEvent(a,t,l),d}updateHasChildren(){let e=this.group&&!this.footer||!!this.childrenAfterGroup?.length,{rowChildrenSvc:t}=this.beans;t&&(e=t.getHasChildrenValue(this)),e!==this.__hasChildren&&(this.__hasChildren=!!e,this.dispatchRowEvent("hasChildrenChanged"))}hasChildren(){return this.__hasChildren==null&&this.updateHasChildren(),this.__hasChildren}dispatchCellChangedEvent(e,t,i){let n={type:"cellChanged",node:this,column:e,newValue:t,oldValue:i};this.__localEventService?.dispatchEvent(n)}resetQuickFilterAggregateText(){this.quickFilterAggregateText=null}isExpandable(){return this.beans.expansionSvc?.isExpandable(this)??!1}isSelected(){if(this.footer)return this.sibling.isSelected();let e=this.rowPinned&&this.pinnedSibling;return e?e.isSelected():this.__selected}depthFirstSearch(e){let t=this.childrenAfterGroup;if(t)for(let i=0,n=t.length;i<n;++i)t[i].depthFirstSearch(e);e(this)}dispatchRowEvent(e){this.__localEventService?.dispatchEvent({type:e,node:this})}setSelected(e,t=!1,i="api"){this.beans.selectionSvc?.setNodesSelected({nodes:[this],newValue:e,clearSelection:t,source:i})}isRowPinned(){return!!this.rowPinned}__addEventListener(e,t){(this.__localEventService??(this.__localEventService=new rr)).addEventListener(e,t)}__removeEventListener(e,t){this.removeLocalListener(e,t)}addEventListener(e,t){this.beans.validation?.checkRowEvents(e);let i=this.__localEventService??(this.__localEventService=new rr);this.frameworkEventListenerService=this.beans.frameworkOverrides.createLocalEventListenerWrapper?.(this.frameworkEventListenerService,i);let n=this.frameworkEventListenerService?.wrap(e,t)??t;i.addEventListener(e,n)}removeEventListener(e,t){let i=this.frameworkEventListenerService?.unwrap(e,t)??t;this.removeLocalListener(e,i)}removeLocalListener(e,t){let i=this.__localEventService;i&&(i.removeEventListener(e,t),i.noRegisteredListenersExist()&&(this.__localEventService=null))}isFullWidthCell(){if(I(61),this.detail)return!0;let e=this.beans.gos.getCallback("isFullWidthRow");return e?e({rowNode:this}):!1}getRoute(){if(this.level===-1)return[];if(this.key==null)return;let e=[],t=this;for(;t?.key!=null;)e.push(t.key),t=t.parent;return e.reverse()}setRowIndex(e){this.rowIndex!==e&&(this.rowIndex=e,this.dispatchRowEvent("rowIndexChanged"))}setAllChildrenCount(e){this.allChildrenCount!==e&&(this.allChildrenCount=e,this.dispatchRowEvent("allChildrenCountChanged"))}setUiLevel(e){this.uiLevel!==e&&(this.uiLevel=e,this.dispatchRowEvent("uiLevelChanged"))}getFirstChild(){let e=this.childStore;return e?e.getFirstNode():this.childrenAfterSort?.[0]??null}};function VH(e,t,i){return ae(t,{type:i,node:e,data:e.data,rowIndex:e.rowIndex,rowPinned:e.rowPinned})}var GH=new Set(["__autoHeights","__checkAutoHeightsDebounced","__localEventService","__objectId","_leafs","childStore","oldRowTop","sticky","treeNodeFlags","treeParent"]),zH=(e,t)=>{let i=new co(t);for(let n of Object.keys(e))GH.has(n)||(i[n]=e[n]);return i.oldRowTop=null,i},Z4=e=>{for(;e?.length;){let t=e[0];if(t.data)return t;e=t.childrenAfterGroup}},eM={agSetColumnFilter:"agSetColumnFilterHandler",agMultiColumnFilter:"agMultiColumnFilterHandler",agGroupColumnFilter:"agGroupColumnFilterHandler",agNumberColumnFilter:"agNumberColumnFilterHandler",agDateColumnFilter:"agDateColumnFilterHandler",agTextColumnFilter:"agTextColumnFilterHandler"},WH=new Set(Object.values(eM));function Zs(e,t){let i=e.filterUi;if(!i)return null;if(i.created)return i.promise;if(t)return null;let n=i.create(i.refreshed),s=i;return s.created=!0,s.promise=n,n}function UH(e,t,i,n,s,o,r){return t.refresh?.(O(b({},i),{model:n,source:o,additionalEventAttributes:r})),e().then(a=>{if(a){let{filter:l,filterParams:d}=a;tM(l,d,n,s,o,r)}})}function tM(e,t,i,n,s,o){e?.refresh?.(O(b({},t),{model:i,state:n,source:s,additionalEventAttributes:o}))}function iM(e,t,i){let n=e();n?.created&&n.promise.then(s=>{let o=t();tM(s,n.filterParams,o,i()??{model:o},"ui")})}function FR(e,t,i,n,s,o,r){let a,l=!1,d;switch(e){case"apply":{let c=n();d=c?.model??null,r&&(d=r(d)),a={state:c?.state,model:d},l=!0;break}case"clear":{a={model:null};break}case"reset":{a={model:null},l=!0,d=null;break}case"cancel":{a={model:i()};break}}s(a),l?o(d):iM(t,i,n)}function Bt(e,t){return e[t]??null}function bt(e){return Wd(e)}function qH(e){return{tag:"div",cls:e}}var $H=class extends Be{constructor(e){let{className:t="ag-filter-apply-panel"}=e??{};super(qH(t)),this.listeners=[],this.validationMessage=null,this.className=t}updateButtons(e,t){let i=this.buttons;if(this.buttons=e,i===e)return;let n=this.getGui();$t(n);let s;this.destroyListeners();let o=document.createDocumentFragment(),r=this.className,a=({type:d,label:c})=>{let u=C=>{this.dispatchLocalEvent({type:d,event:C})};["apply","clear","reset","cancel"].includes(d)||I(75);let h=d==="apply",g=bt({tag:"button",attrs:{type:h&&t?"submit":"button"},ref:`${d}FilterButton`,cls:`ag-button ag-standard-button ${r}-button${h?" "+r+"-apply-button":""}`,children:c});this.activateTabIndex([g]),h&&(s=g);let f=C=>{C.key===k.ENTER&&(C.preventDefault(),u(C))},m=this.listeners;g.addEventListener("click",u),m.push(()=>g.removeEventListener("click",u)),g.addEventListener("keydown",f),m.push(()=>g.removeEventListener("keydown",f)),o.append(g)};for(let d of e)a(d);this.eApply=s;let l=this.validationTooltipFeature;s&&!l?this.validationTooltipFeature=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.eApply,getLocation:()=>"advancedFilter",getTooltipShowDelayOverride:()=>1e3})):!s&&l&&(this.validationTooltipFeature=this.destroyBean(l)),n.append(o)}getApplyButton(){return this.eApply}updateValidity(e,t=null){let i=this.eApply;i&&(Td(i,e===!1),this.validationMessage=t??null,this.validationTooltipFeature?.setTooltipAndRefresh(this.validationMessage))}destroyListeners(){for(let e of this.listeners)e();this.listeners=[]}destroy(){this.destroyListeners(),super.destroy()}};var jH={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose one",equals:"Equals",notEqual:"Does not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"Between",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equal to",greaterThanOrEqual:"Greater than or equal to",contains:"Contains",notContains:"Does not contain",startsWith:"Begins with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",before:"Before",after:"After",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd",filterSummaryInactive:"is (All)",filterSummaryContains:"contains",filterSummaryNotContains:"does not contain",filterSummaryTextEquals:"equals",filterSummaryTextNotEqual:"does not equal",filterSummaryStartsWith:"begins with",filterSummaryEndsWith:"ends with",filterSummaryBlank:"is blank",filterSummaryNotBlank:"is not blank",filterSummaryEquals:"=",filterSummaryNotEqual:"!=",filterSummaryGreaterThan:">",filterSummaryGreaterThanOrEqual:">=",filterSummaryLessThan:"<",filterSummaryLessThanOrEqual:"<=",filterSummaryInRange:"between",filterSummaryInRangeValues:e=>`(${e[0]}, ${e[1]})`,filterSummaryTextQuote:e=>`"${e[0]}"`};function so(e,t,i){return AO(e,jH,t,i)}function tw(e,t){let{debounceMs:i}=e;return ng(e)?(i!=null&&I(71),0):i??t}function ng(e){return(e.buttons?.indexOf("apply")??-1)>=0}var KH=class extends Be{constructor(e,t,i,n,s,o){super(),this.column=e,this.wrapper=t,this.eventParent=i,this.updateModel=n,this.isGlobalButtons=s,this.enableGlobalButtonCheck=o,this.hidePopup=null,this.applyActive=!1}postConstruct(){let{comp:e,params:t}=this.wrapper,i=t,n=i.useForm,s=n?"form":"div";this.setTemplate({tag:s,cls:"ag-filter-wrapper"}),n&&this.addManagedElementListeners(this.getGui(),{submit:o=>{o?.preventDefault()},keydown:this.handleKeyDown.bind(this)}),this.appendChild(e.getGui()),this.params=i,this.resetButtonsPanel(i),this.addManagedListeners(this.eventParent,b({filterParamsChanged:({column:o,params:r})=>{o===this.column&&this.resetButtonsPanel(r,this.params)},filterStateChanged:({column:o,state:r})=>{o===this.column&&this.eButtons?.updateValidity(r.valid!==!1)},filterAction:({column:o,action:r,event:a})=>{o===this.column&&this.afterAction(r,a)}},this.enableGlobalButtonCheck?{filterGlobalButtons:({isGlobal:o})=>{if(o!==this.isGlobalButtons){this.isGlobalButtons=o;let r=this.params;this.resetButtonsPanel(r,r,!0)}}}:void 0))}afterGuiAttached(e){e&&(this.hidePopup=e.hidePopup)}resetButtonsPanel(e,t,i){let{buttons:n,readOnly:s}=t??{},{buttons:o,readOnly:r,useForm:a}=e;if(!i&&s===r&&Pd(n,o))return;let l=o&&o.length>0&&!e.readOnly&&!this.isGlobalButtons,d=this.eButtons;if(l){let c=o.map(u=>{let h=`${u}Filter`;return{type:u,label:so(this,h)}});if(this.applyActive=ng(this.params),!d){d=this.createBean(new $H),this.appendChild(d.getGui());let u=this.column,h=p=>({event:g})=>{this.updateModel(u,p,{fromButtons:!0}),this.afterAction(p,g)};d?.addManagedListeners(d,{apply:h("apply"),clear:h("clear"),reset:h("reset"),cancel:h("cancel")}),this.eButtons=d}d.updateButtons(c,a)}else this.applyActive=!1,d&&(yi(d.getGui()),this.eButtons=this.destroyBean(d))}close(e){let t=this.hidePopup;if(!t)return;let i=e,n=i?.key,s;(n===k.ENTER||n===k.SPACE)&&(s={keyboardEvent:i}),t(s),this.hidePopup=null}afterAction(e,t){let{params:i,applyActive:n}=this,s=i?.closeOnApply;switch(e){case"apply":{t?.preventDefault(),s&&n&&this.close(t);break}case"reset":{s&&n&&this.close();break}case"cancel":{s&&this.close(t);break}}}handleKeyDown(e){!e.defaultPrevented&&e.key===k.ENTER&&this.applyActive&&(this.updateModel(this.column,"apply",{fromButtons:!0}),this.afterAction("apply",e))}destroy(){this.hidePopup=null,this.eButtons=this.destroyBean(this.eButtons)}},YH={tag:"div",cls:"ag-filter"},XH=class extends Be{constructor(e,t,i){super(YH),this.column=e,this.source=t,this.enableGlobalButtonCheck=i,this.wrapper=null}postConstruct(){this.beans.colFilter?.activeFilterComps.add(this),this.createFilter(!0),this.addManagedEventListeners({filterDestroyed:this.onFilterDestroyed.bind(this)})}hasFilter(){return this.wrapper!=null}getFilter(){return this.wrapper?.then(e=>e.comp)??null}afterInit(){return this.wrapper?.then(()=>{})??lt.resolve()}afterGuiAttached(e){this.afterGuiAttachedParams=e,this.wrapper?.then(t=>{this.comp?.afterGuiAttached(e),t?.comp?.afterGuiAttached?.(e)})}afterGuiDetached(){this.wrapper?.then(e=>{e?.comp?.afterGuiDetached?.()})}createFilter(e){let{column:t,source:i,beans:{colFilter:n}}=this,s=n.getFilterUiForDisplay(t)??null;this.wrapper=s,s?.then(o=>{if(!o)return;let{isHandler:r,comp:a}=o,l;if(r){let d=!!this.enableGlobalButtonCheck,c=this.createBean(new KH(t,o,n,n.updateModel.bind(n),d&&n.isGlobalButtons,d));this.comp=c,l=c.getGui()}else l=a.getGui(),K(l)||I(69,{guiFromFilter:l});this.appendChild(l),e?this.eventSvc.dispatchEvent({type:"filterOpened",column:t,source:i,eGui:this.getGui()}):a.afterGuiAttached?.(this.afterGuiAttachedParams)})}onFilterDestroyed(e){let{source:t,column:i}=e;(t==="api"||t==="paramsUpdated")&&i.getId()===this.column.getId()&&this.beans.colModel.getColDefCol(this.column)&&($t(this.getGui()),this.comp=this.destroyBean(this.comp),this.createFilter())}destroy(){this.beans.colFilter?.activeFilterComps.delete(this),this.eventSvc.dispatchEvent({type:"filterClosed",column:this.column}),this.wrapper=null,this.comp=this.destroyBean(this.comp),this.afterGuiAttachedParams=void 0,super.destroy()}},TR={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},AR=["january","february","march","april","may","june","july","august","september","october","november","december"];function JH(e,t){return e==null?-1:t==null?1:Number.parseFloat(e)-Number.parseFloat(t)}function IR(e){return e instanceof Date&&!isNaN(e.getTime())}var fv={number:()=>{},boolean:()=>({maxNumConditions:1,debounceMs:0,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:(e,t)=>t,numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:(e,t)=>t===!1,numberOfInputs:0}]}),date:()=>({isValidDate:IR}),dateString:({dataTypeDefinition:e})=>({comparator:(t,i)=>{let n=e.dateParser(i);return i==null||n<t?-1:n>t?1:0},isValidDate:t=>typeof t=="string"&&IR(e.dateParser(t))}),dateTime:e=>fv.date(e),dateTimeString:e=>fv.dateString(e),object:()=>{},text:()=>{}},mv={number:()=>({comparator:JH}),boolean:({t:e})=>({valueFormatter:t=>K(t.value)?e(String(t.value),t.value?"True":"False"):e("blanks","(Blanks)")}),date:({formatValue:e,t})=>({valueFormatter:i=>{let n=e(i);return K(n)?n:t("blanks","(Blanks)")},treeList:!0,treeListFormatter:(i,n)=>{if(i==="NaN")return t("invalidDate","Invalid Date");if(n===1&&i!=null){let s=AR[Number(i)-1];return t(s,TR[s])}return i??t("blanks","(Blanks)")},treeListPathGetter:i=>ap(i,!1)}),dateString:({formatValue:e,dataTypeDefinition:t,t:i})=>({valueFormatter:n=>{let s=e(n);return K(s)?s:i("blanks","(Blanks)")},treeList:!0,treeListPathGetter:n=>ap(t.dateParser(n??void 0),!1),treeListFormatter:(n,s)=>{if(s===1&&n!=null){let o=AR[Number(n)-1];return i(o,TR[o])}return n??i("blanks","(Blanks)")}}),dateTime:e=>{let t=mv.date(e);return t.treeListPathGetter=ap,t},dateTimeString(e){let t=e.dataTypeDefinition.dateParser,i=mv.dateString(e);return i.treeListPathGetter=n=>ap(t(n??void 0)),i},object:({formatValue:e,t})=>({valueFormatter:i=>{let n=e(i);return K(n)?n:t("blanks","(Blanks)")}}),text:()=>{}};function QH(e,t,i,n,s,o,r){let a=t,l=i,d=e==="agSetColumnFilter";!l&&n.baseDataType==="object"&&!d&&(l=({column:p,node:g})=>s({column:p,node:g,value:o.valueSvc.getValue(p,g)}));let u=(d?mv:fv)[n.baseDataType],h=u({dataTypeDefinition:n,formatValue:s,t:r});return a=typeof t=="object"?b(b({},h),t):h,{filterParams:a,filterValueGetter:l}}var ZH={boolean:"agTextColumnFilter",date:"agDateColumnFilter",dateString:"agDateColumnFilter",dateTime:"agDateColumnFilter",dateTimeString:"agDateColumnFilter",number:"agNumberColumnFilter",object:"agTextColumnFilter",text:"agTextColumnFilter"},eV={boolean:"agTextColumnFloatingFilter",date:"agDateColumnFloatingFilter",dateString:"agDateColumnFloatingFilter",dateTime:"agDateColumnFloatingFilter",dateTimeString:"agDateColumnFloatingFilter",number:"agNumberColumnFloatingFilter",object:"agTextColumnFloatingFilter",text:"agTextColumnFloatingFilter"};function tV(e,t=!1){return(t?eV:ZH)[e??"text"]}var nM="ag-resizer-wrapper",eo=(e,t)=>({tag:"div",ref:`${e}Resizer`,cls:`ag-resizer ag-resizer-${t}`}),iV={tag:"div",cls:nM,children:[eo("eTopLeft","topLeft"),eo("eTop","top"),eo("eTopRight","topRight"),eo("eRight","right"),eo("eBottomRight","bottomRight"),eo("eBottom","bottom"),eo("eBottomLeft","bottomLeft"),eo("eLeft","left")]},nV=class extends F{constructor(e,t){super(),this.element=e,this.dragStartPosition={x:0,y:0},this.position={x:0,y:0},this.lastSize={width:-1,height:-1},this.positioned=!1,this.resizersAdded=!1,this.resizeListeners=[],this.boundaryEl=null,this.isResizing=!1,this.isMoving=!1,this.resizable={},this.movable=!1,this.currentResizer=null,this.config=Object.assign({},{popup:!1},t)}wireBeans(e){this.popupSvc=e.popupSvc,this.dragSvc=e.dragSvc}center(e){let{clientHeight:t,clientWidth:i}=this.offsetParent,n=i/2-this.getWidth()/2,s=t/2-this.getHeight()/2;this.offsetElement(n,s,e)}initialisePosition(e){if(this.positioned)return;let{centered:t,forcePopupParentAsOffsetParent:i,minWidth:n,width:s,minHeight:o,height:r,x:a,y:l}=this.config;this.offsetParent||this.setOffsetParent();let d=0,c=0,u=Gn(this.element);if(u){let h=this.findBoundaryElement(),p=window.getComputedStyle(h);if(p.minWidth!=null){let g=h.offsetWidth-this.element.offsetWidth;c=Number.parseInt(p.minWidth,10)-g}if(p.minHeight!=null){let g=h.offsetHeight-this.element.offsetHeight;d=Number.parseInt(p.minHeight,10)-g}}if(this.minHeight=o||d,this.minWidth=n||c,s&&this.setWidth(s),r&&this.setHeight(r),(!s||!r)&&this.refreshSize(),t)this.center(e);else if(a||l)this.offsetElement(a,l,e);else if(u&&i){let h=this.boundaryEl,p=!0;if(h||(h=this.findBoundaryElement(),p=!1),h){let g=Number.parseFloat(h.style.top),f=Number.parseFloat(h.style.left);p?this.offsetElement(isNaN(f)?0:f,isNaN(g)?0:g,e):this.setPosition(f,g)}}this.positioned=!!this.offsetParent}isPositioned(){return this.positioned}getPosition(){return this.position}setMovable(e,t){if(!this.config.popup||e===this.movable)return;this.movable=e;let i=this.moveElementDragListener||{eElement:t,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};e?(this.dragSvc?.addDragSource(i),this.moveElementDragListener=i):(this.dragSvc?.removeDragSource(i),this.moveElementDragListener=void 0)}setResizable(e){if(this.clearResizeListeners(),e?this.addResizers():this.removeResizers(),typeof e=="boolean"){if(e===!1)return;e={topLeft:e,top:e,topRight:e,right:e,bottomRight:e,bottom:e,bottomLeft:e,left:e}}Object.keys(e).forEach(t=>{let n=!!e[t],s=this.getResizerElement(t),o={dragStartPixels:0,eElement:s,onDragStart:r=>this.onResizeStart(r,t),onDragging:this.onResize.bind(this),onDragStop:r=>this.onResizeEnd(r,t)};(n||!this.isAlive()&&!n)&&(n?(this.dragSvc?.addDragSource(o),this.resizeListeners.push(o),s.style.pointerEvents="all"):s.style.pointerEvents="none",this.resizable[t]=n)})}removeSizeFromEl(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}restoreLastSize(){this.element.style.flex="0 0 auto";let{height:e,width:t}=this.lastSize;t!==-1&&(this.element.style.width=`${t}px`),e!==-1&&(this.element.style.height=`${e}px`)}getHeight(){return this.element.offsetHeight}setHeight(e){let{popup:t}=this.config,i=this.element,n=!1;if(typeof e=="string"&&e.includes("%"))yd(i,e),e=N6(i),n=!0;else if(e=Math.max(this.minHeight,e),this.positioned){let s=this.getAvailableHeight();s&&e>s&&(e=s)}this.getHeight()!==e&&(n?(i.style.maxHeight="unset",i.style.minHeight="unset"):t?yd(i,e):(i.style.height=`${e}px`,i.style.flex="0 0 auto",this.lastSize.height=typeof e=="number"?e:Number.parseFloat(e)))}getAvailableHeight(){let{popup:e,forcePopupParentAsOffsetParent:t}=this.config;this.positioned||this.initialisePosition();let{clientHeight:i}=this.offsetParent;if(!i)return null;let n=this.element.getBoundingClientRect(),s=this.offsetParent.getBoundingClientRect(),o=e?this.position.y:n.top,r=e?0:s.top,a=0;if(t){let d=this.element.parentElement;if(d){let{bottom:c}=d.getBoundingClientRect();a=c-n.bottom}}return i+r-o-a}getWidth(){return this.element.offsetWidth}setWidth(e){let t=this.element,{popup:i}=this.config,n=!1;if(typeof e=="string"&&e.includes("%"))Bn(t,e),e=Tp(t),n=!0;else if(this.positioned){e=Math.max(this.minWidth,e);let{clientWidth:s}=this.offsetParent,o=i?this.position.x:this.element.getBoundingClientRect().left;s&&e+o>s&&(e=s-o)}this.getWidth()!==e&&(n?(t.style.maxWidth="unset",t.style.minWidth="unset"):this.config.popup?Bn(t,e):(t.style.width=`${e}px`,t.style.flex=" unset",this.lastSize.width=typeof e=="number"?e:Number.parseFloat(e)))}offsetElement(e=0,t=0,i){let{forcePopupParentAsOffsetParent:n}=this.config,s=n?this.boundaryEl:this.element;s&&(this.popupSvc?.positionPopup({ePopup:s,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:()=>({x:e,y:t}),postProcessCallback:i}),this.setPosition(Number.parseFloat(s.style.left),Number.parseFloat(s.style.top)))}constrainSizeToAvailableHeight(e){if(!this.config.forcePopupParentAsOffsetParent)return;let t=()=>{let i=this.getAvailableHeight();this.element.style.setProperty("max-height",`${i}px`)};e&&this.popupSvc?(this.resizeObserverSubscriber?.(),this.resizeObserverSubscriber=uo(this.beans,this.popupSvc?.getPopupParent(),t)):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}setPosition(e,t){this.position.x=e,this.position.y=t}updateDragStartPosition(e,t){this.dragStartPosition={x:e,y:t}}calculateMouseMovement(e){let{e:t,isLeft:i,isTop:n,anywhereWithin:s,topBuffer:o}=e,r=t.clientX-this.dragStartPosition.x,a=t.clientY-this.dragStartPosition.y,l=this.shouldSkipX(t,!!i,!!s,r)?0:r,d=this.shouldSkipY(t,!!n,o,a)?0:a;return{movementX:l,movementY:d}}shouldSkipX(e,t,i,n){let s=this.element.getBoundingClientRect(),o=this.offsetParent.getBoundingClientRect(),r=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.x:s.left,l=a<=0&&o.left>=e.clientX||o.right<=e.clientX&&o.right<=r.right;return l?!0:(t?l=n<0&&e.clientX>a+o.left||n>0&&e.clientX<a+o.left:i?l=n<0&&e.clientX>r.right||n>0&&e.clientX<a+o.left:l=n<0&&e.clientX>r.right||n>0&&e.clientX<r.right,l)}shouldSkipY(e,t,i=0,n){let s=this.element.getBoundingClientRect(),o=this.offsetParent.getBoundingClientRect(),r=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.y:s.top,l=a<=0&&o.top>=e.clientY||o.bottom<=e.clientY&&o.bottom<=r.bottom;return l?!0:(t?l=n<0&&e.clientY>a+o.top+i||n>0&&e.clientY<a+o.top:l=n<0&&e.clientY>r.bottom||n>0&&e.clientY<r.bottom,l)}createResizeMap(){let e=t=>({element:this.element.querySelector(`[data-ref=${t}Resizer]`)});this.resizerMap={topLeft:e("eTopLeft"),top:e("eTop"),topRight:e("eTopRight"),right:e("eRight"),bottomRight:e("eBottomRight"),bottom:e("eBottom"),bottomLeft:e("eBottomLeft"),left:e("eLeft")}}addResizers(){if(this.resizersAdded)return;let e=this.element;e&&(e.appendChild(bt(iV)),this.createResizeMap(),this.resizersAdded=!0)}removeResizers(){this.resizerMap=void 0,this.element.querySelector(`.${nM}`)?.remove(),this.resizersAdded=!1}getResizerElement(e){return this.resizerMap[e].element}onResizeStart(e,t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!t.match(/top/i),isRight:!!t.match(/right/i),isBottom:!!t.match(/bottom/i),isLeft:!!t.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[t].element.classList.add("ag-active");let{popup:i,forcePopupParentAsOffsetParent:n}=this.config;!i&&!n&&this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)}getSiblings(){let t=this.element.parentElement;return t?Array.prototype.slice.call(t.children).filter(i=>!i.classList.contains("ag-hidden")):null}getMinSizeOfSiblings(){let e=this.getSiblings()||[],t=0,i=0;for(let n=0;n<e.length;n++){let s=e[n],o=!!s.style.flex&&s.style.flex!=="0 0 auto";if(s===this.element)continue;let r=this.minHeight||0,a=this.minWidth||0;if(o){let l=window.getComputedStyle(s);l.minHeight&&(r=Number.parseInt(l.minHeight,10)),l.minWidth&&(a=Number.parseInt(l.minWidth,10))}else r=s.offsetHeight,a=s.offsetWidth;t+=r,i+=a}return{height:t,width:i}}applySizeToSiblings(e){let t=null,i=this.getSiblings();if(i){for(let n=0;n<i.length;n++){let s=i[n];s!==t&&(e?s.style.height=`${s.offsetHeight}px`:s.style.width=`${s.offsetWidth}px`,s.style.flex="0 0 auto",s===this.element&&(t=i[n+1]))}t&&(t.style.removeProperty("height"),t.style.removeProperty("min-height"),t.style.removeProperty("max-height"),t.style.flex="1 1 auto")}}isResizable(){return Object.values(this.resizable).some(e=>e)}onResize(e){if(!this.isResizing||!this.currentResizer)return;let{popup:t,forcePopupParentAsOffsetParent:i}=this.config,{isTop:n,isRight:s,isBottom:o,isLeft:r}=this.currentResizer,a=s||r,l=o||n,{movementX:d,movementY:c}=this.calculateMouseMovement({e,isLeft:r,isTop:n}),u=this.position.x,h=this.position.y,p=0,g=0;if(a&&d){let f=r?-1:1,m=this.getWidth(),C=m+d*f,v=!1;r&&(p=m-C,(u+p<=0||C<=this.minWidth)&&(v=!0,p=0)),v||this.setWidth(C)}if(l&&c){let f=n?-1:1,m=this.getHeight(),C=m+c*f,v=!1;n?(g=m-C,(h+g<=0||C<=this.minHeight)&&(v=!0,g=0)):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&m<C&&this.getMinSizeOfSiblings().height+C>this.element.parentElement.offsetHeight&&(v=!0),v||this.setHeight(C)}this.updateDragStartPosition(e.clientX,e.clientY),((t||i)&&p||g)&&this.offsetElement(u+p,h+g)}onResizeEnd(e,t){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null,this.element.classList.remove("ag-resizing"),this.resizerMap[t].element.classList.remove("ag-active"),this.dispatchLocalEvent({type:"resize"})}refreshSize(){let e=this.element;this.config.popup&&(this.config.width||this.setWidth(e.offsetWidth),this.config.height||this.setHeight(e.offsetHeight))}onMoveStart(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)}onMove(e){if(!this.isMoving)return;let{x:t,y:i}=this.position,n;this.config.calculateTopBuffer&&(n=this.config.calculateTopBuffer());let{movementX:s,movementY:o}=this.calculateMouseMovement({e,isTop:!0,anywhereWithin:!0,topBuffer:n});this.offsetElement(t+s,i+o),this.updateDragStartPosition(e.clientX,e.clientY)}onMoveEnd(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}setOffsetParent(){this.config.forcePopupParentAsOffsetParent&&this.popupSvc?this.offsetParent=this.popupSvc.getPopupParent():this.offsetParent=this.element.offsetParent}findBoundaryElement(){let e=this.element;for(;e;){if(window.getComputedStyle(e).position!=="static")return e;e=e.parentElement}return this.element}clearResizeListeners(){for(;this.resizeListeners.length;){let e=this.resizeListeners.pop();this.dragSvc?.removeDragSource(e)}}destroy(){super.destroy(),this.moveElementDragListener&&this.dragSvc?.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}},sM="__ag_Grid_Stop_Propagation";function dr(e){e[sM]=!0}function Ms(e){return e[sM]===!0}var sV="ag-focus-managed",qa=class extends F{constructor(e,t={}){super(),this.eFocusable=e,this.callbacks=t,this.callbacks=b({shouldStopEventPropagation:()=>!1,onTabKeyDown:i=>{if(i.defaultPrevented)return;let n=pr(this.beans,this.eFocusable,!1,i.shiftKey);n&&(n.focus(),i.preventDefault())}},t)}postConstruct(){let{eFocusable:e,callbacks:{onFocusIn:t,onFocusOut:i}}=this;e.classList.add(sV),this.addKeyDownListeners(e),t&&this.addManagedElementListeners(e,{focusin:t}),i&&this.addManagedElementListeners(e,{focusout:i})}addKeyDownListeners(e){this.addManagedElementListeners(e,{keydown:t=>{if(t.defaultPrevented||Ms(t))return;let{callbacks:i}=this;if(i.shouldStopEventPropagation(t)){dr(t);return}t.key===k.TAB?i.onTabKeyDown(t):i.handleKeyDown&&i.handleKeyDown(t)}})}},oV=class extends Be{constructor(e,t){super(),this.filterNameKey=e,this.cssIdentifier=t,this.applyActive=!1,this.debouncePending=!1,this.defaultDebounceMs=0}postConstruct(){let e={tag:"div",cls:`ag-filter-body-wrapper ag-${this.cssIdentifier}-body-wrapper`,children:[this.createBodyTemplate()]};this.setTemplate(e,this.getAgComponents()),this.createManagedBean(new qa(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=this.createBean(new nV(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}))}handleKeyDown(e){}init(e){let t=e;this.setParams(t),this.setModelIntoUi(t.state.model,!0).then(()=>this.updateUiVisibility())}refresh(e){let t=e,i=this.params;this.params=t,t.source==="colDef"&&this.updateParams(t,i);let s=t.state,o=this.state;return this.state=s,(s.model!==o.model||s.state!==o.state)&&this.setModelIntoUi(s.model),!0}setParams(e){this.params=e,this.state=e.state,this.commonUpdateParams(e)}updateParams(e,t){this.commonUpdateParams(e,t)}commonUpdateParams(e,t){this.applyActive=ng(e),this.setupApplyDebounced()}doesFilterPass(e){I(283);let{getHandler:t,model:i,column:n}=this.params;return t().doesFilterPass(O(b({},e),{model:i,handlerParams:this.beans.colFilter.getHandlerParams(n)}))}getFilterTitle(){return this.translate(this.filterNameKey)}isFilterActive(){return I(284),this.params.model!=null}setupApplyDebounced(){let e=tw(this.params,this.defaultDebounceMs),t=qt(this,this.checkApplyDebounce.bind(this),e);this.applyDebounced=()=>{this.debouncePending=!0,t()}}checkApplyDebounce(){this.debouncePending&&(this.debouncePending=!1,this.doApplyModel())}getModel(){return I(285),this.params.model}setModel(e){I(286);let{beans:t,params:i}=this;return t.colFilter.setModelForColumnLegacy(i.column,e)}applyModel(e="api"){return this.doApplyModel()}canApply(e){return!0}doApplyModel(e){let{params:t,state:i}=this,n=!this.areModelsEqual(t.model,i.model);return n&&t.onAction("apply",e),n}onNewRowsLoaded(){}onUiChanged(e,t=!1){this.updateUiVisibility();let i=this.getModelFromUi(),n={model:i,state:this.getState(),valid:this.canApply(i)};this.state=n;let s=this.params;s.onStateChange(n),s.onUiChange(this.getUiChangeEventParams()),this.gos.get("enableFilterHandlers")||this.eventSvc.dispatchEvent({type:"filterModified",column:s.column,filterInstance:this}),e??(e=this.applyActive?void 0:"debounce"),e==="immediately"?this.doApplyModel({afterFloatingFilter:t,afterDataChange:!1}):e==="debounce"&&this.applyDebounced()}getState(){}getUiChangeEventParams(){}afterGuiAttached(e){this.lastContainerType=e?.container,this.refreshFilterResizer(e?.container)}refreshFilterResizer(e){let{positionableFeature:t,gos:i}=this;if(!t)return;let n=e==="floatingFilter"||e==="columnFilter";n?(t.restoreLastSize(),t.setResizable(i.get("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(t.removeSizeFromEl(),t.setResizable(!1)),t.constrainSizeToAvailableHeight(n)}afterGuiDetached(){this.checkApplyDebounce(),this.positionableFeature?.constrainSizeToAvailableHeight(!1)}destroy(){this.positionableFeature=this.destroyBean(this.positionableFeature),super.destroy()}translate(e){return so(this,e)}getPositionableElement(){return this.getGui()}areModelsEqual(e,t){return e===t||e==null&&t==null?!0:e==null||t==null?!1:this.areNonNullModelsEqual(e,t)}};function oM(e){return!!e.operator}function rV(e,t,i){if(t==null)return null;let n=null,{compName:s,jsComp:o,fwComp:r}=A4(e,t);return s?n={agSetColumnFilter:"agSetColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"}[s]:o==null&&r==null&&t.filter===!0&&(n=i()),n}var on={AUTO_HEIGHT:"ag-layout-auto-height",NORMAL:"ag-layout-normal",PRINT:"ag-layout-print"},iw=class extends F{constructor(e){super(),this.view=e}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){let e=this.gos.get("domLayout"),t={autoHeight:e==="autoHeight",normal:e==="normal",print:e==="print"},i=t.autoHeight?on.AUTO_HEIGHT:t.print?on.PRINT:on.NORMAL;this.view.updateLayoutClasses(i,t)}},to="Viewport",_R="fakeVScrollComp",PC=["fakeHScrollComp","centerHeader","topCenter","bottomCenter","stickyTopCenter","stickyBottomCenter"],LR=100,FC=150,aV=class extends F{constructor(e){super(),this.clearRetryListenerFncs=[],this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.lastOffsetHeight=-1,this.lastScrollTop=-1,this.lastIsHorizontalScrollShowing=!1,this.scrollTimer=0,this.isScrollActive=!1,this.isVerticalPositionInvalidated=!0,this.isHorizontalPositionInvalidated=!0,this.eBodyViewport=e,this.resetLastHScrollDebounced=qt(this,()=>this.lastScrollSource[1]=null,FC),this.resetLastVScrollDebounced=qt(this,()=>this.lastScrollSource[0]=null,FC)}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.animationFrameSvc=e.animationFrameSvc,this.visibleCols=e.visibleCols}destroy(){super.destroy(),this.clearRetryListenerFncs=[],window.clearTimeout(this.scrollTimer)}postConstruct(){this.enableRtl=this.gos.get("enableRtl");let e=this.invalidateVerticalScroll.bind(this),t=this.invalidateHorizontalScroll.bind(this);this.addManagedEventListeners({displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this),bodyHeightChanged:e,scrollGapChanged:t}),this.addManagedElementListeners(this.eBodyViewport,{scroll:e}),this.ctrlsSvc.whenReady(this,i=>{this.centerRowsCtrl=i.center,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()})}invalidateHorizontalScroll(){this.isHorizontalPositionInvalidated=!0}invalidateVerticalScroll(){this.isVerticalPositionInvalidated=!0}addScrollListener(){this.addHorizontalScrollListeners(),this.addVerticalScrollListeners()}addHorizontalScrollListeners(){this.addManagedElementListeners(this.centerRowsCtrl.eViewport,{scroll:this.onHScroll.bind(this,to)});for(let e of PC){let t=this.ctrlsSvc.get(e);this.registerScrollPartner(t,this.onHScroll.bind(this,e))}}addVerticalScrollListeners(){let e=this.ctrlsSvc.get("fakeVScrollComp"),t=this.gos.get("debounceVerticalScrollbar"),i=t?qt(this,this.onVScroll.bind(this,to),LR):this.onVScroll.bind(this,to),n=t?qt(this,this.onVScroll.bind(this,_R),LR):this.onVScroll.bind(this,_R);this.addManagedElementListeners(this.eBodyViewport,{scroll:i}),this.registerScrollPartner(e,n)}registerScrollPartner(e,t){e.onScrollCallback(t)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(e){this.centerRowsCtrl!=null&&(e===void 0&&(e=this.centerRowsCtrl.getCenterViewportScrollLeft()),this.setScrollLeftForAllContainersExceptCurrent(Math.abs(e)))}setScrollLeftForAllContainersExceptCurrent(e){for(let t of[...PC,to]){if(this.lastScrollSource[1]===t)continue;let i=this.getViewportForSource(t);Ip(i,e,this.enableRtl)}}getViewportForSource(e){return e===to?this.centerRowsCtrl.eViewport:this.ctrlsSvc.get(e).eViewport}isControllingScroll(e,t){return this.lastScrollSource[t]==null?(t===0?this.lastScrollSource[0]=e:this.lastScrollSource[1]=e,!0):this.lastScrollSource[t]===e}onHScroll(e){if(!this.isControllingScroll(e,1))return;let t=this.centerRowsCtrl.eViewport,{scrollLeft:i}=t;if(this.shouldBlockScrollUpdate(1,i,!0))return;let n=Ap(this.getViewportForSource(e),this.enableRtl);this.doHorizontalScroll(n),this.resetLastHScrollDebounced()}onVScroll(e){if(!this.isControllingScroll(e,0))return;let t;if(e===to?t=this.eBodyViewport.scrollTop:t=this.ctrlsSvc.get("fakeVScrollComp").getScrollPosition(),this.shouldBlockScrollUpdate(0,t,!0))return;let{animationFrameSvc:i}=this;i?.setScrollTop(t),this.nextScrollTop=t,e===to?this.ctrlsSvc.get("fakeVScrollComp").setScrollPosition(t):this.eBodyViewport.scrollTop=t,i?.active?i.schedule():this.scrollGridIfNeeded(!0),this.resetLastVScrollDebounced()}doHorizontalScroll(e){let t=this.ctrlsSvc.get("fakeHScrollComp").getScrollPosition();this.scrollLeft===e&&e===t||(this.scrollLeft=e,this.fireScrollEvent(1),this.horizontallyScrollHeaderCenterAndFloatingCenter(e),this.centerRowsCtrl.onHorizontalViewportChanged(!0))}isScrolling(){return this.isScrollActive}fireScrollEvent(e){let t={type:"bodyScroll",direction:e===1?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.isScrollActive=!0,this.eventSvc.dispatchEvent(t),window.clearTimeout(this.scrollTimer),this.scrollTimer=window.setTimeout(()=>{this.scrollTimer=0,this.isScrollActive=!1,this.eventSvc.dispatchEvent(O(b({},t),{type:"bodyScrollEnd"}))},FC)}shouldBlockScrollUpdate(e,t,i=!1){return i&&!nr()?!1:e===0?this.shouldBlockVerticalScroll(t):this.shouldBlockHorizontalScroll(t)}shouldBlockVerticalScroll(e){let t=Iv(this.eBodyViewport),{scrollHeight:i}=this.eBodyViewport;return e<0||e+t>i}shouldBlockHorizontalScroll(e){let t=this.centerRowsCtrl.getCenterWidth(),{scrollWidth:i}=this.centerRowsCtrl.eViewport;if(this.enableRtl){if(e>0)return!0}else if(e<0)return!0;return Math.abs(e)+t>i}redrawRowsAfterScroll(){this.fireScrollEvent(0)}checkScrollLeft(){let e=this.scrollLeft,t=!1;for(let i of PC)if(this.getViewportForSource(i).scrollLeft!==e){t=!0;break}t&&this.onHScroll(to)}scrollGridIfNeeded(e=!1){let t=this.scrollTop!=this.nextScrollTop;return t&&(this.scrollTop=this.nextScrollTop,e&&this.invalidateVerticalScroll(),this.redrawRowsAfterScroll()),t}setHorizontalScrollPosition(e,t=!1){let n=this.centerRowsCtrl.eViewport.scrollWidth-this.centerRowsCtrl.getCenterWidth();!t&&this.shouldBlockScrollUpdate(1,e)&&(this.enableRtl?e=e>0?0:n:e=Math.min(Math.max(e,0),n)),Ip(this.centerRowsCtrl.eViewport,Math.abs(e),this.enableRtl),this.doHorizontalScroll(e)}setVerticalScrollPosition(e){this.invalidateVerticalScroll(),this.eBodyViewport.scrollTop=e}getVScrollPosition(){if(!this.isVerticalPositionInvalidated){let{lastOffsetHeight:i,lastScrollTop:n}=this;return{top:n,bottom:n+i}}this.isVerticalPositionInvalidated=!1;let{scrollTop:e,offsetHeight:t}=this.eBodyViewport;return this.lastScrollTop=e,this.lastOffsetHeight=t,{top:e,bottom:e+t}}getApproximateVScollPosition(){return this.lastScrollTop>=0&&this.lastOffsetHeight>=0?{top:this.scrollTop,bottom:this.scrollTop+this.lastOffsetHeight}:this.getVScrollPosition()}getHScrollPosition(){return this.centerRowsCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.isHorizontalPositionInvalidated&&(this.lastIsHorizontalScrollShowing=this.centerRowsCtrl.isHorizontalScrollShowing(),this.isHorizontalPositionInvalidated=!1),this.lastIsHorizontalScrollShowing}scrollHorizontally(e){let t=this.centerRowsCtrl.eViewport.scrollLeft;return this.setHorizontalScrollPosition(t+e),this.centerRowsCtrl.eViewport.scrollLeft-t}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(e,t=null){let{rowModel:i}=this.beans,n=i.getRowCount(),s=-1;for(let o=0;o<n;o++){let r=i.getRow(o);if(typeof e=="function"){if(r&&e(r)){s=o;break}}else if(e===r||e===r.data){s=o;break}}s>=0&&this.ensureIndexVisible(s,t)}ensureIndexVisible(e,t,i=0){if(jt(this.gos,"print"))return;let{rowModel:n}=this.beans,s=n.getRowCount();if(typeof e!="number"||e<0||e>=s){I(88,{index:e});return}this.clearRetryListeners();let{frameworkOverrides:o,pageBounds:r,rowContainerHeight:a,rowRenderer:l}=this.beans;o.wrapIncoming(()=>{let d=this.ctrlsSvc.getGridBodyCtrl(),c=n.getRow(e),u,h,p=0;this.invalidateVerticalScroll();do{let{stickyTopHeight:g,stickyBottomHeight:f}=d,m=c.rowTop,C=c.rowHeight,v=r.getPixelOffset(),w=c.rowTop-v,y=w+c.rowHeight,S=this.getVScrollPosition(),x=a.divStretchOffset,E=S.top+x,T=S.bottom+x,L=T-E,N=a.getScrollPositionForPixel(w),$=a.getScrollPositionForPixel(y-L),G=Math.min((N+$)/2,w),se=E+g>w,ve=T-f<y,me=null;t==="top"?me=N-g:t==="bottom"?me=$+f:t==="middle"?me=G:se?me=N-g:ve&&($-N>L?me=N-g:me=$+f),me!==null&&(this.setVerticalScrollPosition(me),l.redraw({afterScroll:!0})),u=m!==c.rowTop||C!==c.rowHeight,h=g!==d.stickyTopHeight||f!==d.stickyBottomHeight,p++}while((u||h)&&p<10);if(this.animationFrameSvc?.flushAllFrames(),i<10&&(c?.stub||!this.beans.rowAutoHeight?.areRowsMeasured())){let g=this.getVScrollPosition().top;this.clearRetryListenerFncs=this.addManagedEventListeners({bodyScroll:()=>{let f=this.getVScrollPosition().top;g!==f&&this.clearRetryListeners()},modelUpdated:()=>{this.clearRetryListeners(),!(e>=n.getRowCount())&&this.ensureIndexVisible(e,t,i+1)}})}})}clearRetryListeners(){for(let e of this.clearRetryListenerFncs)e();this.clearRetryListenerFncs=[]}ensureColumnVisible(e,t="auto"){let{colModel:i,frameworkOverrides:n}=this.beans,s=i.getCol(e);if(!s||s.isPinned()||!this.visibleCols.isColDisplayed(s))return;let o=this.getPositionedHorizontalScroll(s,t);n.wrapIncoming(()=>{o!==null&&this.centerRowsCtrl.setCenterViewportScrollLeft(o),this.centerRowsCtrl.onHorizontalViewportChanged(),this.animationFrameSvc?.flushAllFrames()})}getPositionedHorizontalScroll(e,t){let{columnBeforeStart:i,columnAfterEnd:n}=this.isColumnOutsideViewport(e),s=this.centerRowsCtrl.getCenterWidth()<e.getActualWidth(),o=this.centerRowsCtrl.getCenterWidth(),r=this.enableRtl,a=(r?i:n)||s,l=r?n:i;t!=="auto"&&(a=t==="start",l=t==="end");let d=t==="middle";if(a||l||d){let{colLeft:c,colMiddle:u,colRight:h}=this.getColumnBounds(e);return d?u-o/2:a?r?h:c:r?c-o:h-o}return null}isColumnOutsideViewport(e){let{start:t,end:i}=this.getViewportBounds(),{colLeft:n,colRight:s}=this.getColumnBounds(e),o=this.enableRtl,r=o?t>s:i<s,a=o?i<n:t>n;return{columnBeforeStart:r,columnAfterEnd:a}}getColumnBounds(e){let t=this.enableRtl,i=this.visibleCols.bodyWidth,n=e.getActualWidth(),s=e.getLeft(),o=t?-1:1,r=t?i-s:s,a=r+n*o,l=r+n/2*o;return{colLeft:r,colMiddle:l,colRight:a}}getViewportBounds(){let e=this.centerRowsCtrl.getCenterWidth(),t=this.centerRowsCtrl.getCenterViewportScrollLeft(),i=t,n=e+t;return{start:i,end:n,width:e}}},nw=class extends F{constructor(e,t=!1){super(),this.callback=e,this.addSpacer=t}postConstruct(){let e=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",e),this.addManagedEventListeners({columnContainerWidthChanged:e,displayedColumnsChanged:e,leftPinnedWidthChanged:e}),this.addSpacer&&this.addManagedEventListeners({rightPinnedWidthChanged:e,scrollVisibilityChanged:e,scrollbarWidthChanged:e}),this.setWidth()}setWidth(){let e=jt(this.gos,"print"),{visibleCols:t,scrollVisibleSvc:i}=this.beans,n=t.bodyWidth,s=t.getColsLeftWidth(),o=t.getDisplayedColumnsRightWidth(),r;e?r=n+s+o:(r=n,this.addSpacer&&(this.gos.get("enableRtl")?s:o)===0&&i.verticalScrollShowing&&(r+=i.getScrollbarWidth())),this.callback(r)}},lV=class extends F{constructor(e){super(),this.centerContainerCtrl=e}wireBeans(e){this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.listenForResize()}),this.addManagedEventListeners({scrollbarWidthChanged:this.onScrollbarWidthChanged.bind(this)}),this.addManagedPropertyListeners(["alwaysShowHorizontalScroll","alwaysShowVerticalScroll"],()=>{this.checkViewportAndScrolls()})}listenForResize(){let{beans:e,centerContainerCtrl:t,gridBodyCtrl:i}=this,n=()=>{Ps(e,()=>{this.onCenterViewportResized()})};t.registerViewportResizeListener(n),i.registerBodyViewportResizeListener(n)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.scrollVisibleSvc.updateScrollGap(),this.centerContainerCtrl.isViewportInTheDOMTree()){let{pinnedCols:e,colFlex:t}=this.beans;e?.keepPinnedColumnsNarrowerThanViewport(),this.checkViewportAndScrolls();let i=this.centerContainerCtrl.getCenterWidth();i!==this.centerWidth&&(this.centerWidth=i,t?.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.scrollFeature.checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){let e=this.gridBodyCtrl.eBodyViewport,t=Iv(e);this.bodyHeight!==t&&(this.bodyHeight=t,this.eventSvc.dispatchEvent({type:"bodyHeightChanged"}))}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){if(!this.isAlive())return;let e={horizontalScrollShowing:this.centerContainerCtrl.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleSvc.setScrollsVisible(e)}onHorizontalViewportChanged(){let e=this.centerContainerCtrl.getCenterWidth(),t=this.centerContainerCtrl.getViewportScrollLeft();this.beans.colViewport.setScrollPosition(e,t)}};function Ep(e,t,i,n){let s=t.getColDef().cellRendererParams?.suppressMouseEventHandling;return rM(e,t,i,n,s)}function dV(e,t,i,n){let s=t?.suppressMouseEventHandling;return rM(e,void 0,i,n,s)}function rM(e,t,i,n,s){return s?s(ae(e,{column:t,node:i,event:n})):!1}function aM(e,t,i){let n=t;for(;n;){let s=r4(e,n,i);if(s)return s;n=n.parentElement}return null}var $p="cellCtrl";function sw(e,t){return aM(e,t,$p)}var jp="renderedRow";function cV(e,t){return aM(e,t,jp)}function Cv(e,t,i,n,s){let o=n?n.getColDef().suppressKeyboardEvent:void 0;if(!o)return!1;let r=ae(e,{event:t,editing:s,column:n,node:i,data:i.data,colDef:n.getColDef()});return!!(o&&o(r))}function uV(e){let{pinnedRowModel:t,rowModel:i}=e,[n,s]=[t?.isEmpty("top")??!0,t?.isEmpty("bottom")??!0],o=n?null:"top",r,a;s?(r=null,a=i.getRowCount()-1):(r="bottom",a=t?.getPinnedBottomRowCount()??-1);let{visibleCols:l,rangeSvc:d}=e,c=l.allCols;!d||!c?.length||d.setCellRange({rowStartIndex:0,rowStartPinned:o,rowEndIndex:a,rowEndPinned:r})}var hV=65,pV=67,gV=86,fV=68,mV=90,CV=89;function vV(e){let{keyCode:t}=e,i;switch(t){case hV:i=k.A;break;case pV:i=k.C;break;case gV:i=k.V;break;case fV:i=k.D;break;case mV:i=k.Z;break;case CV:i=k.Y;break;default:i=e.code}return i}var wV=class extends F{constructor(e){super(),this.element=e}postConstruct(){this.addKeyboardListeners(),this.addMouseListeners(),this.beans.touchSvc?.mockRowContextMenu(this),this.editSvc=this.beans.editSvc}addKeyboardListeners(){let e="keydown",t=this.processKeyboardEvent.bind(this,e);this.addManagedElementListeners(this.element,{[e]:t})}addMouseListeners(){let t=["dblclick","contextmenu","mouseover","mouseout","click",U6("touchstart")?"touchstart":"mousedown"];for(let i of t){let n=this.processMouseEvent.bind(this,i);this.addManagedElementListeners(this.element,{[i]:n})}}processMouseEvent(e,t){if(!Id(this.beans,t)||Ms(t))return;let{cellCtrl:i,rowCtrl:n}=this.getControlsForEventTarget(t.target);e==="contextmenu"?(i?.column&&i.dispatchCellContextMenuEvent(t),this.beans.contextMenuSvc?.handleContextMenuMouseEvent(t,void 0,n,i)):(i&&i.onMouseEvent(e,t),n&&n.onMouseEvent(e,t))}getControlsForEventTarget(e){let{gos:t}=this;return{cellCtrl:sw(t,e),rowCtrl:cV(t,e)}}processKeyboardEvent(e,t){let{cellCtrl:i,rowCtrl:n}=this.getControlsForEventTarget(t.target);t.defaultPrevented||(i?this.processCellKeyboardEvent(i,e,t):n?.isFullWidth()&&this.processFullWidthRowKeyboardEvent(n,e,t))}processCellKeyboardEvent(e,t,i){let n=this.editSvc?.isEditing(e,{withOpenEditor:!0})??!1;!Cv(this.gos,i,e.rowNode,e.column,n)&&t==="keydown"&&(!n&&this.beans.navigation?.handlePageScrollingKey(i)||e.onKeyDown(i),this.doGridOperations(i,n),N4(i)&&e.processCharacter(i)),t==="keydown"&&this.eventSvc.dispatchEvent(e.createEvent(i,"cellKeyDown"))}processFullWidthRowKeyboardEvent(e,t,i){let{rowNode:n}=e,{focusSvc:s,navigation:o}=this.beans,a=s.getFocusedCell()?.column;if(!Cv(this.gos,i,n,a,!1)){let d=i.key;if(t==="keydown")switch(d){case k.PAGE_HOME:case k.PAGE_END:case k.PAGE_UP:case k.PAGE_DOWN:o?.handlePageScrollingKey(i,!0);break;case k.LEFT:case k.RIGHT:if(!this.gos.get("embedFullWidthRows"))break;case k.UP:case k.DOWN:e.onKeyboardNavigate(i);break;case k.TAB:e.onTabKeyDown(i);break;default:}}t==="keydown"&&this.eventSvc.dispatchEvent(e.createRowEvent("cellKeyDown",i))}doGridOperations(e,t){if(!e.ctrlKey&&!e.metaKey||t||!Id(this.beans,e))return;let i=vV(e),{clipboardSvc:n,undoRedo:s}=this.beans;if(i===k.A)return this.onCtrlAndA(e);if(i===k.C)return this.onCtrlAndC(n,e);if(i===k.D)return this.onCtrlAndD(n,e);if(i===k.V)return this.onCtrlAndV(n,e);if(i===k.X)return this.onCtrlAndX(n,e);if(i===k.Y)return this.onCtrlAndY(s);if(i===k.Z)return this.onCtrlAndZ(s,e)}onCtrlAndA(e){let{beans:{rowModel:t,rangeSvc:i,selectionSvc:n},gos:s}=this;i&&Ds(s)&&!hN(s)&&t.isRowsToRender()?uV(this.beans):n&&n.selectAllRowNodes({source:"keyboardSelectAll",selectAll:h4(s)}),e.preventDefault()}onCtrlAndC(e,t){if(!e||this.gos.get("enableCellTextSelection"))return;let{cellCtrl:i}=this.getControlsForEventTarget(t.target);this.editSvc?.isEditing(i,{withOpenEditor:!0})||(t.preventDefault(),e.copyToClipboard())}onCtrlAndX(e,t){if(!e||this.gos.get("enableCellTextSelection")||this.gos.get("suppressCutToClipboard"))return;let{cellCtrl:i}=this.getControlsForEventTarget(t.target);this.editSvc?.isEditing(i,{withOpenEditor:!0})||(t.preventDefault(),e.cutToClipboard(void 0,"ui"))}onCtrlAndV(e,t){let{cellCtrl:i}=this.getControlsForEventTarget(t.target);this.editSvc?.isEditing(i,{withOpenEditor:!0})||e&&!this.gos.get("suppressClipboardPaste")&&e.pasteFromClipboard()}onCtrlAndD(e,t){e&&!this.gos.get("suppressClipboardPaste")&&e.copyRangeDown(),t.preventDefault()}onCtrlAndZ(e,t){!this.gos.get("undoRedoCellEditing")||!e||(t.preventDefault(),t.shiftKey?e.redo("ui"):e.undo("ui"))}onCtrlAndY(e){e?.redo("ui")}},lM=class extends F{constructor(e,t){super(),this.eContainer=e,this.eViewport=t}postConstruct(){this.addManagedEventListeners({rowContainerHeightChanged:this.onHeightChanged.bind(this,this.beans.rowContainerHeight)})}onHeightChanged(e){let t=e.uiContainerHeight,i=t!=null?`${t}px`:"";this.eContainer.style.height=i,this.eViewport&&(this.eViewport.style.height=i)}},cp=e=>e.topRowCtrls,up=e=>e.getStickyTopRowCtrls(),hp=e=>e.getStickyBottomRowCtrls(),pp=e=>e.bottomRowCtrls,gp=e=>e.allRowCtrls,TC=e=>e.getCtrls("top"),AC=e=>e.getCtrls("center"),IC=e=>e.getCtrls("bottom"),bV={center:{type:"center",name:"center-cols",getRowCtrls:gp,getSpannedRowCtrls:AC},left:{type:"left",name:"pinned-left-cols",pinnedType:"left",getRowCtrls:gp,getSpannedRowCtrls:AC},right:{type:"right",name:"pinned-right-cols",pinnedType:"right",getRowCtrls:gp,getSpannedRowCtrls:AC},fullWidth:{type:"fullWidth",name:"full-width",fullWidth:!0,getRowCtrls:gp},topCenter:{type:"center",name:"floating-top",getRowCtrls:cp,getSpannedRowCtrls:TC},topLeft:{type:"left",name:"pinned-left-floating",container:"ag-pinned-left-floating-top",pinnedType:"left",getRowCtrls:cp,getSpannedRowCtrls:TC},topRight:{type:"right",name:"pinned-right-floating",container:"ag-pinned-right-floating-top",pinnedType:"right",getRowCtrls:cp,getSpannedRowCtrls:TC},topFullWidth:{type:"fullWidth",name:"floating-top-full-width",fullWidth:!0,getRowCtrls:cp},stickyTopCenter:{type:"center",name:"sticky-top",getRowCtrls:up},stickyTopLeft:{type:"left",name:"pinned-left-sticky-top",container:"ag-pinned-left-sticky-top",pinnedType:"left",getRowCtrls:up},stickyTopRight:{type:"right",name:"pinned-right-sticky-top",container:"ag-pinned-right-sticky-top",pinnedType:"right",getRowCtrls:up},stickyTopFullWidth:{type:"fullWidth",name:"sticky-top-full-width",fullWidth:!0,getRowCtrls:up},stickyBottomCenter:{type:"center",name:"sticky-bottom",getRowCtrls:hp},stickyBottomLeft:{type:"left",name:"pinned-left-sticky-bottom",container:"ag-pinned-left-sticky-bottom",pinnedType:"left",getRowCtrls:hp},stickyBottomRight:{type:"right",name:"pinned-right-sticky-bottom",container:"ag-pinned-right-sticky-bottom",pinnedType:"right",getRowCtrls:hp},stickyBottomFullWidth:{type:"fullWidth",name:"sticky-bottom-full-width",fullWidth:!0,getRowCtrls:hp},bottomCenter:{type:"center",name:"floating-bottom",getRowCtrls:pp,getSpannedRowCtrls:IC},bottomLeft:{type:"left",name:"pinned-left-floating-bottom",container:"ag-pinned-left-floating-bottom",pinnedType:"left",getRowCtrls:pp,getSpannedRowCtrls:IC},bottomRight:{type:"right",name:"pinned-right-floating-bottom",container:"ag-pinned-right-floating-bottom",pinnedType:"right",getRowCtrls:pp,getSpannedRowCtrls:IC},bottomFullWidth:{type:"fullWidth",name:"floating-bottom-full-width",fullWidth:!0,getRowCtrls:pp}};function dM(e){return`ag-${$d(e).name}-viewport`}function Rp(e){let t=$d(e);return t.container??`ag-${t.name}-container`}function yV(e){return`ag-${$d(e).name}-spanned-cells-container`}function $d(e){return bV[e]}var SV=["topCenter","topLeft","topRight"],xV=["bottomCenter","bottomLeft","bottomRight"],EV=["center","left","right"],RV=["center","left","right","fullWidth"],MV=["stickyTopCenter","stickyBottomCenter","center","topCenter","bottomCenter"],DV=["left","bottomLeft","topLeft","stickyTopLeft","stickyBottomLeft"],kV=["right","bottomRight","topRight","stickyTopRight","stickyBottomRight"],cM=["stickyTopCenter","stickyTopLeft","stickyTopRight"],uM=["stickyBottomCenter","stickyBottomLeft","stickyBottomRight"],PV=[...cM,"stickyTopFullWidth",...uM,"stickyBottomFullWidth"],FV=[...SV,...xV,...EV,...cM,...uM],TV=class extends F{constructor(e){super(),this.name=e,this.visible=!0,this.EMPTY_CTRLS=[],this.options=$d(e)}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.forContainers(["center"],()=>{this.viewportSizeFeature=this.createManagedBean(new lV(this)),this.addManagedEventListeners({stickyTopOffsetChanged:this.onStickyTopOffsetChanged.bind(this)})})}onStickyTopOffsetChanged(e){this.comp.setOffsetTop(`${e.offset}px`)}registerWithCtrlsService(){this.options.fullWidth||this.beans.ctrlsSvc.register(this.name,this)}forContainers(e,t){e.indexOf(this.name)>=0&&t()}setComp(e,t,i,n){this.comp=e,this.eContainer=t,this.eSpannedContainer=i,this.eViewport=n,this.createManagedBean(new wV(this.eViewport??this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder();let{pinnedCols:s,rangeSvc:o}=this.beans,r=()=>this.onPinnedWidthChanged();this.forContainers(DV,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(s?.createPinnedWidthFeature(!0,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({leftPinnedWidthChanged:r})}),this.forContainers(kV,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(s?.createPinnedWidthFeature(!1,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({rightPinnedWidthChanged:r})}),this.forContainers(RV,()=>this.createManagedBean(new lM(this.eContainer,this.name==="center"?n:void 0))),o&&this.forContainers(FV,()=>this.createManagedBean(o.createDragListenerFeature(this.eContainer))),this.forContainers(MV,()=>this.createManagedBean(new nw(a=>this.comp.setContainerWidth(`${a}px`)))),this.visible=this.isContainerVisible(),this.addListeners(),this.registerWithCtrlsService()}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}addListeners(){let{spannedRowRenderer:e,gos:t}=this.beans,i=this.onDisplayedColumnsChanged.bind(this);this.addManagedEventListeners({displayedColumnsChanged:i,displayedColumnsWidthChanged:i,displayedRowsChanged:n=>this.onDisplayedRowsChanged(n.afterScroll)}),i(),this.onDisplayedRowsChanged(),e&&this.options.getSpannedRowCtrls&&t.get("enableCellSpan")&&this.addManagedListeners(e,{spannedRowsUpdated:()=>{let n=this.options.getSpannedRowCtrls(e);n&&this.comp.setSpannedRowCtrls(n,!1)}})}listenOnDomOrder(){if(PV.indexOf(this.name)>=0){this.comp.setDomOrder(!0);return}let t=()=>{let i=this.gos.get("ensureDomOrder"),n=jt(this.gos,"print");this.comp.setDomOrder(i||n)};this.addManagedPropertyListener("domLayout",t),t()}onDisplayedColumnsChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}addPreventScrollWhileDragging(){let{dragSvc:e}=this.beans;if(!e)return;let t=i=>{e.dragging&&i.cancelable&&i.preventDefault()};this.eContainer.addEventListener("touchmove",t,{passive:!1}),this.addDestroyFunc(()=>this.eContainer.removeEventListener("touchmove",t))}onHorizontalViewportChanged(e=!1){let t=this.getCenterWidth(),i=this.getCenterViewportScrollLeft();this.beans.colViewport.setScrollPosition(t,i,e)}hasHorizontalScrollGap(){return this.eContainer.clientWidth-this.eViewport.clientWidth<0}hasVerticalScrollGap(){return this.eContainer.clientHeight-this.eViewport.clientHeight<0}getCenterWidth(){return Ad(this.eViewport)}getCenterViewportScrollLeft(){return Ap(this.eViewport,this.enableRtl)}registerViewportResizeListener(e){let t=uo(this.beans,this.eViewport,e);this.addDestroyFunc(()=>t())}isViewportInTheDOMTree(){return H6(this.eViewport)}getViewportScrollLeft(){return Ap(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gos.get("alwaysShowHorizontalScroll")||Lv(this.eViewport)}setHorizontalScroll(e){this.comp.setHorizontalScroll(e)}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(e){Ip(this.eViewport,e,this.enableRtl)}isContainerVisible(){return!(this.options.pinnedType!=null)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){let e=this.isContainerVisible();this.visible!=e&&(this.visible=e,this.onDisplayedRowsChanged())}onDisplayedRowsChanged(e=!1){let t=this.options.getRowCtrls(this.beans.rowRenderer);if(!this.visible||t.length===0){this.comp.setRowCtrls({rowCtrls:this.EMPTY_CTRLS});return}let i=jt(this.gos,"print"),s=this.gos.get("embedFullWidthRows")||i,o=t.filter(r=>{let a=r.isFullWidth();return this.options.fullWidth?!s&&a:s||!a});this.comp.setRowCtrls({rowCtrls:o,useFlushSync:e})}},hM="ag-force-vertical-scroll",AV="ag-selectable",IV="ag-column-moving",_V=class extends F{constructor(){super(...arguments),this.stickyTopHeight=0,this.stickyBottomHeight=0}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colModel=e.colModel,this.scrollVisibleSvc=e.scrollVisibleSvc,this.pinnedRowModel=e.pinnedRowModel,this.filterManager=e.filterManager,this.rowGroupColsSvc=e.rowGroupColsSvc}setComp(e,t,i,n,s,o,r){this.comp=e,this.eGridBody=t,this.eBodyViewport=i,this.eTop=n,this.eBottom=s,this.eStickyTop=o,this.eStickyBottom=r,this.eCenterColsViewport=i.querySelector(`.${dM("center")}`),this.eFullWidthContainer=i.querySelector(`.${Rp("fullWidth")}`),this.eStickyTopFullWidthContainer=o.querySelector(`.${Rp("stickyTopFullWidth")}`),this.eStickyBottomFullWidthContainer=r.querySelector(`.${Rp("stickyBottomFullWidth")}`),this.setCellTextSelection(this.gos.get("enableCellTextSelection")),this.addManagedPropertyListener("enableCellTextSelection",a=>this.setCellTextSelection(a.currentValue)),this.createManagedBean(new iw(this.comp)),this.scrollFeature=this.createManagedBean(new aV(i)),this.beans.rowDragSvc?.setupRowDrag(i,this),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([n,i,s,o,r]),this.setGridRootRole(),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.updateScrollingClasses(),this.filterManager?.setupAdvFilterHeaderComp(n),this.ctrlsSvc.register("gridBodyCtrl",this)}addEventListeners(){let e=this.setFloatingHeights.bind(this),t=this.setGridRootRole.bind(this),i=this.toggleRowResizeStyles.bind(this);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this),scrollGapChanged:this.updateScrollingClasses.bind(this),pinnedRowDataChanged:e,pinnedHeightChanged:e,pinnedRowsChanged:e,headerHeightChanged:this.setStickyTopOffsetTop.bind(this),columnRowGroupChanged:t,columnPivotChanged:t,rowResizeStarted:i,rowResizeEnded:i}),this.addManagedPropertyListener("treeData",t)}toggleRowResizeStyles(e){let t=e.type==="rowResizeStarted";this.eBodyViewport.classList.toggle("ag-prevent-animation",t)}onGridColumnsChanged(){let e=this.beans.colModel.getCols();this.comp.setColumnCount(e.length)}onScrollVisibilityChanged(){let{scrollVisibleSvc:e}=this,t=e.verticalScrollShowing;this.setVerticalScrollPaddingVisible(t),this.setStickyWidth(t),this.setStickyBottomOffsetBottom();let i=t&&e.getScrollbarWidth()||0,n=O4()?16:0,s=`calc(100% + ${i+n}px)`;Ps(this.beans,()=>this.comp.setBodyViewportWidth(s)),this.updateScrollingClasses()}setGridRootRole(){let{rowGroupColsSvc:e,colModel:t}=this,i=this.gos.get("treeData");if(!i){let n=t.isPivotMode();i=(e?e.columns.length:0)>=(n?2:1)}this.comp.setGridRootRole(i?"treegrid":"grid")}addFocusListeners(e){for(let t of e)this.addManagedElementListeners(t,{focusin:i=>{let{target:n}=i,s=er(n,"ag-root",t);t.classList.toggle("ag-has-focus",!s)},focusout:i=>{let{target:n,relatedTarget:s}=i,o=t.contains(s),r=er(s,"ag-root",t);er(n,"ag-root",t)||(!o||r)&&t.classList.remove("ag-has-focus")}})}setColumnMovingCss(e){this.comp.setColumnMovingCss(IV,e)}setCellTextSelection(e=!1){this.comp.setCellSelectableCss(AV,e)}updateScrollingClasses(){let{eGridBody:{classList:e},scrollVisibleSvc:t}=this;e.toggle("ag-body-vertical-content-no-gap",!t.verticalScrollGap),e.toggle("ag-body-horizontal-content-no-gap",!t.horizontalScrollGap)}disableBrowserDragging(){this.addManagedElementListeners(this.eGridBody,{dragstart:e=>{if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1}})}addStopEditingWhenGridLosesFocus(){this.beans.editSvc?.addStopEditingWhenGridLosesFocus([this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop,this.eStickyBottom])}updateRowCount(){let e=(this.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0)+(this.filterManager?.getHeaderRowCount()??0),{rowModel:t}=this.beans,i=t.isLastRowIndexKnown()?t.getRowCount():-1,n=i===-1?-1:e+i;this.comp.setRowCount(n)}registerBodyViewportResizeListener(e){this.comp.registerBodyViewportResizeListener(e)}setVerticalScrollPaddingVisible(e){let t=e?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(t)}isVerticalScrollShowing(){let e=this.gos.get("alwaysShowVerticalScroll"),t=e?hM:null,i=jt(this.gos,"normal");return this.comp.setAlwaysVerticalScrollClass(t,e),e||i&&z6(this.eBodyViewport)}setupRowAnimationCssClass(){let{rowContainerHeight:e,environment:t}=this.beans,i=t.sizesMeasured,n=()=>{let s=i&&Pa(this.gos)&&!e.stretching,o=s?"ag-row-animation":"ag-row-no-animation";this.comp.setRowAnimationCssOnBodyViewport(o,s)};n(),this.addManagedEventListeners({heightScaleChanged:n}),this.addManagedPropertyListener("animateRows",n),this.addManagedEventListeners({gridStylesChanged:()=>{!i&&t.sizesMeasured&&(i=!0,n())}})}addBodyViewportListener(){let{eBodyViewport:e,eStickyTop:t,eStickyBottom:i,eTop:n,eBottom:s,beans:{popupSvc:o,touchSvc:r}}=this,a=this.onBodyViewportContextMenu.bind(this);this.addManagedElementListeners(e,{contextmenu:a}),r?.mockBodyContextMenu(this,a),this.addManagedElementListeners(e,{wheel:this.onBodyViewportWheel.bind(this,o)});let l=this.onStickyWheel.bind(this);for(let c of[t,i,n,s])this.addManagedElementListeners(c,{wheel:l});let d=this.onHorizontalWheel.bind(this);for(let c of["left","right","topLeft","topRight","bottomLeft","bottomRight"])this.addManagedElementListeners(this.ctrlsSvc.get(c).eContainer,{wheel:d});this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){this.addManagedElementListeners(this.eFullWidthContainer,{wheel:e=>this.onFullWidthContainerWheel(e)})}onFullWidthContainerWheel(e){let{deltaX:t,deltaY:i,shiftKey:n}=e;(n||Math.abs(t)>Math.abs(i))&&Id(this.beans,e)&&this.scrollGridBodyToMatchEvent(e)}onStickyWheel(e){let{deltaY:t}=e;this.scrollVertically(t)>0&&e.preventDefault()}onHorizontalWheel(e){let{deltaX:t,deltaY:i,shiftKey:n}=e;(n||Math.abs(t)>Math.abs(i))&&this.scrollGridBodyToMatchEvent(e)}scrollGridBodyToMatchEvent(e){let{deltaX:t,deltaY:i}=e;e.preventDefault(),this.eCenterColsViewport.scrollBy({left:t||i})}onBodyViewportContextMenu(e,t,i){if(!e&&!i)return;this.gos.get("preventDefaultOnContextMenu")&&(e||i).preventDefault();let{target:n}=e||t;(n===this.eBodyViewport||n===this.ctrlsSvc.get("center").eViewport)&&this.beans.contextMenuSvc?.showContextMenu({mouseEvent:e,touchEvent:i,value:null,anchorToElement:this.eGridBody,source:"ui"})}onBodyViewportWheel(e,t){this.gos.get("suppressScrollWhenPopupsAreOpen")&&e?.hasAnchoredPopup()&&t.preventDefault()}scrollVertically(e){let t=this.eBodyViewport.scrollTop;return this.scrollFeature.setVerticalScrollPosition(t+e),this.eBodyViewport.scrollTop-t}setFloatingHeights(){let{pinnedRowModel:e,beans:{environment:t}}=this,i=e?.getPinnedTopTotalHeight(),n=e?.getPinnedBottomTotalHeight(),s=t.getPinnedRowBorderWidth(),o=t.getRowBorderWidth(),r=s-o,a=i?r+i:0,l=n?r+n:0;this.comp.setTopHeight(a),this.comp.setBottomHeight(l),this.comp.setTopInvisible(a<=0),this.comp.setBottomInvisible(l<=0),this.setStickyTopOffsetTop(),this.setStickyBottomOffsetBottom()}setStickyTopHeight(e=0){this.comp.setStickyTopHeight(`${e}px`),this.stickyTopHeight=e}setStickyBottomHeight(e=0){this.comp.setStickyBottomHeight(`${e}px`),this.stickyBottomHeight=e}setStickyWidth(e){if(!e)this.comp.setStickyTopWidth("100%"),this.comp.setStickyBottomWidth("100%");else{let t=this.scrollVisibleSvc.getScrollbarWidth();this.comp.setStickyTopWidth(`calc(100% - ${t}px)`),this.comp.setStickyBottomWidth(`calc(100% - ${t}px)`)}}setStickyTopOffsetTop(){let t=this.ctrlsSvc.get("gridHeaderCtrl").headerHeight+(this.filterManager?.getHeaderHeight()??0),i=this.pinnedRowModel?.getPinnedTopTotalHeight()??0,n=0;t>0&&(n+=t),i>0&&(n+=i),n>0&&(n+=1),this.comp.setStickyTopTop(`${n}px`)}setStickyBottomOffsetBottom(){let{pinnedRowModel:e,scrollVisibleSvc:t,comp:i}=this,n=e?.getPinnedBottomTotalHeight()??0,o=t.horizontalScrollShowing&&t.getScrollbarWidth()||0,r=n+o;i.setStickyBottomBottom(`${r}px`)}};function LV(e,t){return sw(e,t.target)?.getFocusedCellPosition()??null}function OR(e,t){let i=jt(e.gos,"normal"),n=t,s,o;n.clientX!=null||n.clientY!=null?(s=n.clientX,o=n.clientY):(s=n.x,o=n.y);let{pageFirstPixel:r}=e.pageBounds.getCurrentPagePixelRange();if(o+=r,i){let a=e.ctrlsSvc.getScrollFeature(),l=a.getVScrollPosition(),d=a.getHScrollPosition();s+=d.left,o+=l.top}return{x:s,y:o}}var pM=class extends Be{constructor(e,t){super(),this.direction=t,this.eViewport=U,this.eContainer=U,this.hideTimeout=0,this.setTemplate(e)}postConstruct(){this.addManagedEventListeners({scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this)}),this.onScrollVisibilityChanged(),this.toggleCss("ag-apple-scrollbar",_4()||nr())}destroy(){super.destroy(),window.clearTimeout(this.hideTimeout)}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.invisibleScrollbar=O4(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){let e=this.getGui(),t=()=>this.toggleCss("ag-scrollbar-active",!0),i=()=>this.toggleCss("ag-scrollbar-active",!1);this.addManagedListeners(e,{mouseenter:t,mousedown:t,touchstart:t,mouseleave:i,touchend:i})}onScrollVisibilityChanged(){this.invisibleScrollbar===void 0&&this.initialiseInvisibleScrollbar(),Ps(this.beans,()=>this.setScrollVisible())}hideAndShowInvisibleScrollAsNeeded(){this.addManagedEventListeners({bodyScroll:e=>{e.direction===this.direction&&(this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=0),this.toggleCss("ag-scrollbar-scrolling",!0))},bodyScrollEnd:()=>{this.hideTimeout=window.setTimeout(()=>{this.toggleCss("ag-scrollbar-scrolling",!1),this.hideTimeout=0},400)}})}attemptSettingScrollPosition(e){let t=this.eViewport;HO(this,()=>Gn(t),()=>this.setScrollPosition(e),100)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}},OV={tag:"div",cls:"ag-body-horizontal-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eLeftSpacer",cls:"ag-horizontal-left-spacer"},{tag:"div",ref:"eViewport",cls:"ag-body-horizontal-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-horizontal-scroll-container"}]},{tag:"div",ref:"eRightSpacer",cls:"ag-horizontal-right-spacer"}]},NV=class extends pM{constructor(){super(OV,"horizontal"),this.eLeftSpacer=U,this.eRightSpacer=U,this.setScrollVisibleDebounce=0}wireBeans(e){this.visibleCols=e.visibleCols,this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){super.postConstruct();let e=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e,pinnedRowDataChanged:this.refreshCompBottom.bind(this)}),this.addManagedPropertyListener("domLayout",e),this.beans.ctrlsSvc.register("fakeHScrollComp",this),this.createManagedBean(new nw(t=>this.eContainer.style.width=`${t}px`)),this.addManagedPropertyListeners(["suppressHorizontalScroll"],this.onScrollVisibilityChanged.bind(this))}destroy(){window.clearTimeout(this.setScrollVisibleDebounce),super.destroy()}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.enableRtl=this.gos.get("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}refreshCompBottom(){if(!this.invisibleScrollbar)return;let e=this.beans.pinnedRowModel?.getPinnedBottomTotalHeight()??0;this.getGui().style.bottom=`${e}px`}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){let e=this.scrollVisibleSvc.verticalScrollShowing,t=this.visibleCols.getDisplayedColumnsRightWidth(),i=!this.enableRtl&&e,n=this.scrollVisibleSvc.getScrollbarWidth();i&&(t+=n),Bn(this.eRightSpacer,t),this.eRightSpacer.classList.toggle("ag-scroller-corner",t<=n);let s=this.visibleCols.getColsLeftWidth();this.enableRtl&&e&&(s+=n),Bn(this.eLeftSpacer,s),this.eLeftSpacer.classList.toggle("ag-scroller-corner",s<=n)}setScrollVisible(){let e=this.scrollVisibleSvc.horizontalScrollShowing,t=this.invisibleScrollbar,i=this.gos.get("suppressHorizontalScroll"),n=e&&this.scrollVisibleSvc.getScrollbarWidth()||0,o=i?0:n===0&&t?16:n,r=()=>{this.setScrollVisibleDebounce=0,this.toggleCss("ag-scrollbar-invisible",t),yd(this.getGui(),o),yd(this.eViewport,o),yd(this.eContainer,o),o||this.eContainer.style.setProperty("min-height","1px"),this.setVisible(e,{skipAriaHidden:!0})};window.clearTimeout(this.setScrollVisibleDebounce),e?this.setScrollVisibleDebounce=window.setTimeout(r,100):r()}getScrollPosition(){return Ap(this.eViewport,this.enableRtl)}setScrollPosition(e){Gn(this.eViewport)||this.attemptSettingScrollPosition(e),Ip(this.eViewport,e,this.enableRtl)}},BV={selector:"AG-FAKE-HORIZONTAL-SCROLL",component:NV},HV={tag:"div",cls:"ag-body-vertical-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eViewport",cls:"ag-body-vertical-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-vertical-scroll-container"}]}]},VV=class extends pM{constructor(){super(HV,"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new lM(this.eContainer));let{ctrlsSvc:e}=this.beans;e.register("fakeVScrollComp",this),this.addManagedEventListeners({rowContainerHeightChanged:this.onRowContainerHeightChanged.bind(this,e)})}setScrollVisible(){let{scrollVisibleSvc:e}=this.beans,t=e.verticalScrollShowing,i=this.invisibleScrollbar,n=t&&e.getScrollbarWidth()||0,s=n===0&&i?16:n;this.toggleCss("ag-scrollbar-invisible",i),Bn(this.getGui(),s),Bn(this.eViewport,s),Bn(this.eContainer,s),this.setDisplayed(t,{skipAriaHidden:!0})}onRowContainerHeightChanged(e){let i=e.getGridBodyCtrl().eBodyViewport,n=this.getScrollPosition(),s=i.scrollTop;n!=s&&this.setScrollPosition(s,!0)}getScrollPosition(){return this.eViewport.scrollTop}setScrollPosition(e,t){!t&&!Gn(this.eViewport)&&this.attemptSettingScrollPosition(e),this.eViewport.scrollTop=e}},GV={selector:"AG-FAKE-VERTICAL-SCROLL",component:VV},zV="ag-column-first",WV="ag-column-last";function gM(e,t,i,n){return tt(e)?[]:qV(e.headerClass,e,t,i,n)}function fM(e,t,i){e.toggleCss(zV,i.isColAtEdge(t,"first")),e.toggleCss(WV,i.isColAtEdge(t,"last"))}function UV(e,t,i,n){return ae(t,{colDef:e,column:i,columnGroup:n})}function qV(e,t,i,n,s){if(tt(e))return[];let o;if(typeof e=="function"){let r=UV(t,i,n,s);o=e(r)}else o=e;return typeof o=="string"?[o]:Array.isArray(o)?[...o]:[]}function $V(e,t,i){t.addManagedElementListeners(i,{keydown:n=>{if(!n.defaultPrevented&&n.key===k.TAB){let s=n.shiftKey;pr(e,i,!1,s)||Ga(e,s)&&n.preventDefault()}}})}function jV(e,t){return e.ctrlsSvc.get("gridCtrl").focusInnerElement(t)}function sr(e){return e.gos.get("suppressHeaderFocus")||!!e.overlays?.isExclusive()}function sg(e){return e.gos.get("suppressCellFocus")||!!e.overlays?.isExclusive()}function Ga(e,t,i=!1){let n=e.ctrlsSvc.get("gridCtrl");return!i&&n.focusNextInnerContainer(t)?!0:((i||!t&&!n.isDetailGrid())&&n.forceFocusOutOfContainer(t),!1)}function Nn(e){return e.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0}function ow(e){let t=[],i=e.ctrlsSvc.getHeaderRowContainerCtrls();for(let n of i){if(!n)continue;let s=n.getGroupRowCount()||0;for(let o=0;o<s;o++){let r=n.getGroupRowCtrlAtIndex(o),a=t[o];if(r){let l=KV(e,r);(a==null||l>a)&&(t[o]=l)}}}return t}function KV(e,t){let n=e.colModel.isPivotMode()?XV(e):CM(e),s=t.getHeaderCellCtrls();for(let o of s){let{column:r}=o,a=r.getAutoHeaderHeight();a!=null&&a>n&&r.isAutoHeaderHeight()&&(n=a)}return n}function rw(e){let i=e.colModel.isPivotMode()?YV(e):jd(e);return e.colModel.forAllCols(n=>{let s=n.getAutoHeaderHeight();s!=null&&s>i&&n.isAutoHeaderHeight()&&(i=s)}),i}function jd(e){return e.gos.get("headerHeight")??e.environment.getDefaultHeaderHeight()}function mM(e){return e.gos.get("floatingFiltersHeight")??jd(e)}function CM(e){return e.gos.get("groupHeaderHeight")??jd(e)}function YV(e){return e.gos.get("pivotHeaderHeight")??jd(e)}function XV(e){return e.gos.get("pivotGroupHeaderHeight")??CM(e)}function JV(e,t){return e.headerRowIndex===t.headerRowIndex&&e.column===t.column}var QV=class extends F{setComp(e,t,i){this.comp=e,this.eGui=t;let{beans:n}=this,{headerNavigation:s,touchSvc:o,ctrlsSvc:r}=n;s&&this.createManagedBean(new qa(i,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedEventListeners({columnPivotModeChanged:this.onPivotModeChanged.bind(this,n),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this,n)}),this.onPivotModeChanged(n),this.setupHeaderHeight();let a=this.onHeaderContextMenu.bind(this);this.addManagedElementListeners(this.eGui,{contextmenu:a}),o?.mockHeaderContextMenu(this,a),r.register("gridHeaderCtrl",this)}setupHeaderHeight(){let e=this.setHeaderHeight.bind(this);e(),this.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],e),this.addManagedEventListeners({headerRowsChanged:e,columnHeaderHeightChanged:e,columnGroupHeaderHeightChanged:()=>Ps(this.beans,()=>e()),gridStylesChanged:e,advancedFilterEnabledChanged:e})}setHeaderHeight(){let{beans:e}=this,t=0,i=ow(e).reduce((o,r)=>o+r,0),n=rw(e);if(e.filterManager?.hasFloatingFilters()&&(t+=mM(e)),t+=i,t+=n,this.headerHeight===t)return;this.headerHeight=t;let s=`${t+1}px`;this.comp.setHeightAndMinHeight(s),this.eventSvc.dispatchEvent({type:"headerHeightChanged"})}onPivotModeChanged(e){let t=e.colModel.isPivotMode();this.comp.toggleCss("ag-pivot-on",t),this.comp.toggleCss("ag-pivot-off",!t)}onDisplayedColumnsChanged(e){let i=e.visibleCols.allCols.some(n=>n.isSpanHeaderHeight());this.comp.toggleCss("ag-header-allow-overflow",i)}onTabKeyDown(e){let t=this.gos.get("enableRtl"),i=e.shiftKey,n=i!==t?"LEFT":"RIGHT",{beans:s}=this,{headerNavigation:o,focusSvc:r}=s;(o.navigateHorizontally(n,!0,e)||!i&&r.focusOverlay(!1)||Ga(s,i,!0))&&e.preventDefault()}handleKeyDown(e){let t=null,{headerNavigation:i}=this.beans;switch(e.key){case k.LEFT:t="LEFT";case k.RIGHT:{K(t)||(t="RIGHT"),i.navigateHorizontally(t,!1,e)&&e.preventDefault();break}case k.UP:t="UP";case k.DOWN:{K(t)||(t="DOWN"),i.navigateVertically(t,e)&&e.preventDefault();break}default:return}}onFocusOut(e){let{relatedTarget:t}=e,{eGui:i,beans:n}=this;!t&&i.contains(ot(n))||i.contains(t)||(n.focusSvc.focusedHeader=null)}onHeaderContextMenu(e,t,i){let{menuSvc:n,ctrlsSvc:s}=this.beans;if(!e&&!i||!n?.isHeaderContextMenuEnabled())return;let{target:o}=e??t;(o===this.eGui||o===s.getHeaderRowContainerCtrl()?.eViewport)&&n.showHeaderContextMenu(void 0,e,i)}},aw=class extends Be{constructor(e,t){super(e),this.ctrl=t}getCtrl(){return this.ctrl}},ZV={tag:"div",cls:"ag-header-cell",role:"columnheader",children:[{tag:"div",ref:"eResize",cls:"ag-header-cell-resize",role:"presentation"},{tag:"div",ref:"eHeaderCompWrapper",cls:"ag-header-cell-comp-wrapper",role:"presentation"}]},eG=class extends aw{constructor(e){super(ZV,e),this.eResize=U,this.eHeaderCompWrapper=U,this.headerCompVersion=0}postConstruct(){let e=this.getGui(),t=()=>{let n=this.ctrl.getSelectAllGui();n&&(this.eResize.insertAdjacentElement("afterend",n),this.addDestroyFunc(()=>n.remove()))},i={setWidth:n=>e.style.width=n,toggleCss:(n,s)=>this.toggleCss(n,s),setUserStyles:n=>zd(e,n),setAriaSort:n=>n?mO(e,n):CO(e),setUserCompDetails:n=>this.setUserCompDetails(n),getUserCompInstance:()=>this.headerComp,refreshSelectAllGui:t,removeSelectAllGui:()=>this.ctrl.getSelectAllGui()?.remove()};this.ctrl.setComp(i,this.getGui(),this.eResize,this.eHeaderCompWrapper,void 0),t()}destroy(){this.destroyHeaderComp(),super.destroy()}destroyHeaderComp(){this.headerComp&&(this.headerCompGui?.remove(),this.headerComp=this.destroyBean(this.headerComp),this.headerCompGui=void 0)}setUserCompDetails(e){this.headerCompVersion++;let t=this.headerCompVersion;e.newAgStackInstance().then(i=>this.afterCompCreated(t,i))}afterCompCreated(e,t){if(e!=this.headerCompVersion||!this.isAlive()){this.destroyBean(t);return}this.destroyHeaderComp(),this.headerComp=t,this.headerCompGui=t.getGui(),this.eHeaderCompWrapper.appendChild(this.headerCompGui),this.ctrl.setDragSource(this.getGui())}},tG={tag:"div",cls:"ag-header-group-cell",role:"columnheader",children:[{tag:"div",ref:"eHeaderCompWrapper",cls:"ag-header-cell-comp-wrapper",role:"presentation"},{tag:"div",ref:"eResize",cls:"ag-header-cell-resize",role:"presentation"}]},iG=class extends aw{constructor(e){super(tG,e),this.eResize=U,this.eHeaderCompWrapper=U}postConstruct(){let e=this.getGui(),t=(n,s)=>s!=null?e.setAttribute(n,s):e.removeAttribute(n),i={toggleCss:(n,s)=>this.toggleCss(n,s),setUserStyles:n=>zd(e,n),setHeaderWrapperHidden:n=>{n?this.eHeaderCompWrapper.style.setProperty("display","none"):this.eHeaderCompWrapper.style.removeProperty("display")},setHeaderWrapperMaxHeight:n=>{n!=null?this.eHeaderCompWrapper.style.setProperty("max-height",`${n}px`):this.eHeaderCompWrapper.style.removeProperty("max-height"),this.eHeaderCompWrapper.classList.toggle("ag-header-cell-comp-wrapper-limited-height",n!=null)},setResizableDisplayed:n=>et(this.eResize,n),setWidth:n=>e.style.width=n,setAriaExpanded:n=>t("aria-expanded",n),setUserCompDetails:n=>this.setUserCompDetails(n),getUserCompInstance:()=>this.headerGroupComp};this.ctrl.setComp(i,e,this.eResize,this.eHeaderCompWrapper,void 0)}setUserCompDetails(e){e.newAgStackInstance().then(t=>this.afterHeaderCompCreated(t))}afterHeaderCompCreated(e){let t=()=>this.destroyBean(e);if(!this.isAlive()){t();return}let i=this.getGui(),n=e.getGui();this.eHeaderCompWrapper.appendChild(n),this.addDestroyFunc(t),this.headerGroupComp=e,this.ctrl.setDragSource(i)}},nG={tag:"div",cls:"ag-header-cell ag-floating-filter",role:"gridcell",children:[{tag:"div",ref:"eFloatingFilterBody",role:"presentation"},{tag:"div",ref:"eButtonWrapper",cls:"ag-floating-filter-button ag-hidden",role:"presentation",children:[{tag:"button",ref:"eButtonShowMainFilter",cls:"ag-button ag-floating-filter-button-button",attrs:{type:"button",tabindex:"-1"}}]}]},sG=class extends aw{constructor(e){super(nG,e),this.eFloatingFilterBody=U,this.eButtonWrapper=U,this.eButtonShowMainFilter=U}postConstruct(){let e=this.getGui(),t={toggleCss:(i,n)=>this.toggleCss(i,n),setUserStyles:i=>zd(e,i),addOrRemoveBodyCssClass:(i,n)=>this.eFloatingFilterBody.classList.toggle(i,n),setButtonWrapperDisplayed:i=>et(this.eButtonWrapper,i),setCompDetails:i=>this.setCompDetails(i),getFloatingFilterComp:()=>this.compPromise,setWidth:i=>e.style.width=i,setMenuIcon:i=>this.eButtonShowMainFilter.appendChild(i)};this.ctrl.setComp(t,e,this.eButtonShowMainFilter,this.eFloatingFilterBody,void 0)}setCompDetails(e){if(!e){this.destroyFloatingFilterComp(),this.compPromise=null;return}this.compPromise=e.newAgStackInstance(),this.compPromise.then(t=>this.afterCompCreated(t))}destroy(){this.destroyFloatingFilterComp(),super.destroy()}destroyFloatingFilterComp(){this.floatingFilterComp&&(this.floatingFilterComp.getGui().remove(),this.floatingFilterComp=this.destroyBean(this.floatingFilterComp))}afterCompCreated(e){if(e){if(!this.isAlive()){this.destroyBean(e);return}this.destroyFloatingFilterComp(),this.floatingFilterComp=e,this.eFloatingFilterBody.appendChild(e.getGui()),e.afterGuiAttached&&e.afterGuiAttached()}}},oG=class extends Be{constructor(e){super({tag:"div",cls:e.headerRowClass,role:"row"}),this.ctrl=e,this.headerComps={}}postConstruct(){this.getGui().setAttribute("tabindex",String(this.gos.get("tabIndex"))),Fp(this.getGui(),this.ctrl.getAriaRowIndex());let t={setHeight:i=>this.getGui().style.height=i,setTop:i=>this.getGui().style.top=i,setHeaderCtrls:(i,n)=>this.setHeaderCtrls(i,n),setWidth:i=>this.getGui().style.width=i,setRowIndex:i=>Fp(this.getGui(),i)};this.ctrl.setComp(t,void 0)}destroy(){this.setHeaderCtrls([],!1),super.destroy()}setHeaderCtrls(e,t){if(!this.isAlive())return;let i=this.headerComps;this.headerComps={};for(let n of e){let s=n.instanceId,o=i[s];delete i[s],o==null&&(o=this.createHeaderComp(n),this.getGui().appendChild(o.getGui())),this.headerComps[s]=o}if(Object.values(i).forEach(n=>{n.getGui().remove(),this.destroyBean(n)}),t){let n=Object.values(this.headerComps);n.sort((o,r)=>{let a=o.getCtrl().column.getLeft(),l=r.getCtrl().column.getLeft();return a-l});let s=n.map(o=>o.getGui());G6(this.getGui(),s)}}createHeaderComp(e){let t;switch(this.ctrl.type){case"group":t=new iG(e);break;case"filter":t=new sG(e);break;default:t=new eG(e);break}return this.createBean(t),t.setParentComponent(this),t}},lw=class extends F{constructor(e,t,i,n){super(),this.columnOrGroup=e,this.eCell=t,this.colsSpanning=n,this.columnOrGroup=e,this.ariaEl=t.querySelector("[role=columnheader]")||t,this.beans=i}setColsSpanning(e){this.colsSpanning=e,this.onLeftChanged()}getColumnOrGroup(){let{beans:e,colsSpanning:t}=this;return e.gos.get("enableRtl")&&t?je(t):this.columnOrGroup}postConstruct(){let e=this.onLeftChanged.bind(this);this.addManagedListeners(this.columnOrGroup,{leftChanged:e}),this.setLeftFirstTime(),this.addManagedEventListeners({displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}setLeftFirstTime(){let{gos:e,colAnimation:t}=this.beans,i=e.get("suppressColumnMoveAnimation"),n=K(this.columnOrGroup.getOldLeft());t?.isActive()&&n&&!i?this.animateInLeft():this.onLeftChanged()}animateInLeft(){let e=this.getColumnOrGroup(),t=this.modifyLeftForPrintLayout(e,e.getOldLeft()),i=this.modifyLeftForPrintLayout(e,e.getLeft());this.setLeft(t),this.actualLeft=i,this.beans.colAnimation.executeNextVMTurn(()=>{this.actualLeft===i&&this.setLeft(i)})}onLeftChanged(){let e=this.getColumnOrGroup(),t=e.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(e,t),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(e,t){let{gos:i,visibleCols:n}=this.beans;if(!jt(i,"print")||e.getPinned()==="left")return t;let o=n.getColsLeftWidth();if(e.getPinned()==="right"){let r=n.bodyWidth;return o+r+t}return o+t}setLeft(e){if(K(e)&&(this.eCell.style.left=`${e}px`),vt(this.columnOrGroup)){let t=this.columnOrGroup.getLeafColumns();if(!t.length)return;t.length>1&&fO(this.ariaEl,t.length)}}},rG=0,vM="headerCtrl",dw=class extends F{constructor(e,t){super(),this.column=e,this.rowCtrl=t,this.resizeToggleTimeout=0,this.resizeMultiplier=1,this.resizeFeature=null,this.lastFocusEvent=null,this.dragSource=null,this.reAttemptToFocus=!1,this.instanceId=e.getUniqueId()+"-"+rG++}postConstruct(){let e=this.refreshTabIndex.bind(this);this.addManagedPropertyListeners(["suppressHeaderFocus"],e),this.addManagedEventListeners({overlayExclusiveChanged:e})}setComp(e,t,i,n,s){t.setAttribute("col-id",this.column.colIdSanitised),this.wireComp(e,t,i,n,s),this.reAttemptToFocus&&(this.reAttemptToFocus=!1,this.focus(this.lastFocusEvent??void 0))}shouldStopEventPropagation(e){let{headerRowIndex:t,column:i}=this.beans.focusSvc.focusedHeader,n=i.getDefinition(),s=n?.suppressHeaderKeyboardEvent;if(!K(s))return!1;let o=ae(this.gos,{colDef:n,column:i,headerRowIndex:t,event:e});return!!s(o)}getWrapperHasFocus(){return ot(this.beans)===this.eGui}setGui(e,t){this.eGui=e,this.addDomData(t),t.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this)}),t.addManagedElementListeners(this.eGui,{focus:this.onGuiFocus.bind(this)}),this.onDisplayedColumnsChanged(),this.refreshTabIndex()}refreshHeaderStyles(){let e=this.column.getDefinition();if(!e)return;let{headerStyle:t}=e,i;if(typeof t=="function"){let n=this.getHeaderClassParams();i=t(n)}else i=t;i&&this.comp.setUserStyles(i)}onGuiFocus(){this.eventSvc.dispatchEvent({type:"headerFocused",column:this.column})}setupAutoHeight(e){let{wrapperElement:t,checkMeasuringCallback:i,compBean:n}=e,{beans:s}=this,o=u=>{if(!this.isAlive()||!n.isAlive())return;let{paddingTop:h,paddingBottom:p,borderBottomWidth:g,borderTopWidth:f}=ur(this.eGui),m=h+p+g+f,v=t.offsetHeight+m;if(u<5){let y=!Ht(s)?.contains(t),S=v==0;if(y||S){ZC(()=>o(u+1),"raf",s);return}}this.setColHeaderHeight(this.column,v)},r=!1,a,l=()=>{let u=this.column.isAutoHeaderHeight();u&&!r&&d(),!u&&r&&c()},d=()=>{r=!0,this.comp.toggleCss("ag-header-cell-auto-height",!0),o(0),a=uo(this.beans,t,()=>o(0))},c=()=>{r=!1,a&&a(),this.comp.toggleCss("ag-header-cell-auto-height",!1),a=void 0};l(),n.addDestroyFunc(()=>c()),n.addManagedListeners(this.column,{widthChanged:()=>r&&o(0)}),n.addManagedEventListeners({sortChanged:()=>{r&&window.setTimeout(()=>o(0))}}),i&&i(l)}onDisplayedColumnsChanged(){let{comp:e,column:t,beans:i,eGui:n}=this;!e||!t||!n||(fM(e,t,i.visibleCols),_6(n,i.visibleCols.getAriaColIndex(t)))}addResizeAndMoveKeyboardListeners(e){e.addManagedListeners(this.eGui,{keydown:this.onGuiKeyDown.bind(this),keyup:this.onGuiKeyUp.bind(this)})}refreshTabIndex(){let e=sr(this.beans);this.eGui&&Fi(this.eGui,"tabindex",e?null:"-1")}onGuiKeyDown(e){let t=ot(this.beans),i=e.key===k.LEFT||e.key===k.RIGHT;if(this.isResizing&&(e.preventDefault(),e.stopImmediatePropagation()),t!==this.eGui||!e.shiftKey&&!e.altKey||((this.isResizing||i)&&(e.preventDefault(),e.stopImmediatePropagation()),!i))return;let s=e.key===k.LEFT!==this.gos.get("enableRtl")?"left":"right";if(e.altKey){this.isResizing=!0,this.resizeMultiplier+=1;let o=this.getViewportAdjustedResizeDiff(e);this.resizeHeader(o,e.shiftKey),this.resizeFeature?.toggleColumnResizing(!0)}else this.moveHeader(s)}moveHeader(e){this.beans.colMoves?.moveHeader(e,this.eGui,this.column,this.rowCtrl.pinned,this)}getViewportAdjustedResizeDiff(e){let t=this.getResizeDiff(e),{pinnedCols:i}=this.beans;return i?i.getHeaderResizeDiff(t,this.column):t}getResizeDiff(e){let{gos:t,column:i}=this,n=e.key===k.LEFT!==t.get("enableRtl"),s=i.getPinned(),o=t.get("enableRtl");return s&&o!==(s==="right")&&(n=!n),(n?-1:1)*this.resizeMultiplier}onGuiKeyUp(){this.isResizing&&(this.resizeToggleTimeout&&(window.clearTimeout(this.resizeToggleTimeout),this.resizeToggleTimeout=0),this.isResizing=!1,this.resizeMultiplier=1,this.resizeToggleTimeout=window.setTimeout(()=>{this.resizeFeature?.toggleColumnResizing(!1)},150))}handleKeyDown(e){let t=this.getWrapperHasFocus();switch(e.key){case k.PAGE_DOWN:case k.PAGE_UP:case k.PAGE_HOME:case k.PAGE_END:t&&e.preventDefault()}}addDomData(e){let t=vM,{eGui:i,gos:n}=this;ar(n,i,t,this),e.addDestroyFunc(()=>ar(n,i,t,null))}focus(e){if(!this.isAlive())return!1;let{eGui:t}=this;return t?(t.focus(),this.lastFocusEvent=e||null):this.reAttemptToFocus=!0,!0}focusThis(){this.beans.focusSvc.focusedHeader={headerRowIndex:this.rowCtrl.rowIndex,column:this.column}}removeDragSource(){this.dragSource&&(this.beans.dragAndDrop?.removeDragSource(this.dragSource),this.dragSource=null)}handleContextMenuMouseEvent(e,t,i){let n=e??t,{menuSvc:s,gos:o}=this.beans;o.get("preventDefaultOnContextMenu")&&n.preventDefault(),s?.isHeaderContextMenuEnabled(i)&&s.showHeaderContextMenu(i,e,t),this.dispatchColumnMouseEvent("columnHeaderContextMenu",i)}dispatchColumnMouseEvent(e,t){this.eventSvc.dispatchEvent({type:e,column:t})}setColHeaderHeight(e,t){if(!e.setAutoHeaderHeight(t))return;let{eventSvc:i}=this;e.isColumn?i.dispatchEvent({type:"columnHeaderHeightChanged",column:e,columns:[e],source:"autosizeColumnHeaderHeight"}):i.dispatchEvent({type:"columnGroupHeaderHeightChanged",columnGroup:e,source:"autosizeColumnGroupHeaderHeight"})}clearComponent(){this.removeDragSource(),this.resizeFeature=null,this.comp=null,this.eGui=null}destroy(){super.destroy(),this.column=null,this.lastFocusEvent=null,this.rowCtrl=null}},aG=class extends dw{constructor(){super(...arguments),this.refreshFunctions={},this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map}wireComp(e,t,i,n,s){this.comp=e;let{rowCtrl:o,column:r,beans:a}=this,{colResize:l,context:d,colHover:c,rangeSvc:u}=a,h=Ud(this,d,s);this.setGui(t,h),this.updateState(),this.setupWidth(h),this.setupMovingCss(h),this.setupMenuClass(h),this.setupSortableClass(h),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight({wrapperElement:n,checkMeasuringCallback:g=>this.setRefreshFunction("measuring",g),compBean:h}),this.addColumnHoverListener(h),this.setupFilterClass(h),this.setupStylesFromColDef(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(h),this.setupSelectAll(h),this.setupUserComp(),this.refreshAria(),l?this.resizeFeature=h.createManagedBean(l.createResizeFeature(o.pinned,r,i,e,this)):et(i,!1),c?.createHoverFeature(h,[r],t),u?.createRangeHighlightFeature(h,r,e),h.createManagedBean(new lw(r,t,a)),h.createManagedBean(new qa(t,{shouldStopEventPropagation:g=>this.shouldStopEventPropagation(g),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addResizeAndMoveKeyboardListeners(h),h.addManagedPropertyListeners(["suppressMovableColumns","suppressMenuHide","suppressAggFuncInHeader","enableAdvancedFilter"],()=>this.refresh()),h.addManagedListeners(r,{colDefChanged:()=>this.refresh()}),h.addManagedListeners(r,{headerHighlightChanged:this.onHeaderHighlightChanged.bind(this)});let p=()=>this.checkDisplayName();h.addManagedEventListeners({columnValueChanged:p,columnRowGroupChanged:p,columnPivotChanged:p,headerHeightChanged:this.onHeaderHeightChanged.bind(this)}),h.addDestroyFunc(()=>{this.refreshFunctions={},this.selectAllFeature=null,this.dragSourceElement=void 0,this.userCompDetails=null,this.userHeaderClasses.clear(),this.ariaDescriptionProperties.clear(),this.clearComponent()})}resizeHeader(e,t){this.beans.colResize?.resizeHeader(this.column,e,t)}getHeaderClassParams(){let{column:e,beans:t}=this,i=e.colDef;return ae(t.gos,{colDef:i,column:e,floatingFilter:!1})}setupUserComp(){let e=this.lookupUserCompDetails();e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setUserCompDetails(e)}lookupUserCompDetails(){let e=this.createParams(),t=this.column.getColDef();return lB(this.beans.userCompFactory,t,e)}createParams(){let{menuSvc:e,sortSvc:t,colFilter:i,gos:n}=this.beans;return ae(n,{column:this.column,displayName:this.displayName,enableSorting:this.column.isSortable(),enableMenu:this.menuEnabled,enableFilterButton:this.openFilterEnabled&&!!e?.isHeaderFilterButtonEnabled(this.column),enableFilterIcon:!!i&&(!this.openFilterEnabled||Ti(this.gos)),showColumnMenu:(o,r)=>{e?.showColumnMenu({column:this.column,buttonElement:o,positionBy:"button",onClosedCallback:r})},showColumnMenuAfterMouseClick:(o,r)=>{e?.showColumnMenu({column:this.column,mouseEvent:o,positionBy:"mouse",onClosedCallback:r})},showFilter:o=>{e?.showFilterMenu({column:this.column,buttonElement:o,containerType:"columnFilter",positionBy:"button"})},progressSort:o=>{t?.progressSort(this.column,!!o,"uiColumnSorted")},setSort:(o,r)=>{t?.setSortForColumn(this.column,o,!!r,"uiColumnSorted")},eGridHeader:this.eGui,setTooltip:(o,r)=>{n.assertModuleRegistered("Tooltip",3),this.setupTooltip(o,r)}})}setupSelectAll(e){let{selectionSvc:t}=this.beans;t&&(this.selectAllFeature=e.createOptionalManagedBean(t.createSelectAllFeature(this.column)),this.selectAllFeature?.setComp(this),e.addManagedPropertyListener("rowSelection",()=>{let i=t.createSelectAllFeature(this.column);i&&!this.selectAllFeature?(this.selectAllFeature=e.createManagedBean(i),this.selectAllFeature?.setComp(this),this.comp.refreshSelectAllGui()):this.selectAllFeature&&!i&&(this.comp.removeSelectAllGui(),this.selectAllFeature=this.destroyBean(this.selectAllFeature))}))}getSelectAllGui(){return this.selectAllFeature?.getCheckboxGui()}handleKeyDown(e){super.handleKeyDown(e),e.key===k.SPACE&&this.selectAllFeature?.onSpaceKeyDown(e),e.key===k.ENTER&&this.onEnterKeyDown(e),e.key===k.DOWN&&e.altKey&&this.showMenuOnKeyPress(e,!1)}onEnterKeyDown(e){e.ctrlKey||e.metaKey?this.showMenuOnKeyPress(e,!0):this.sortable&&this.beans.sortSvc?.progressSort(this.column,e.shiftKey,"uiColumnSorted")}showMenuOnKeyPress(e,t){let i=this.comp.getUserCompInstance();NR(i)&&i.onMenuKeyboardShortcut(t)&&e.preventDefault()}onFocusIn(e){this.eGui.contains(e.relatedTarget)||(this.focusThis(),this.announceAriaDescription()),AB()&&this.setActiveHeader(!0)}onFocusOut(e){this.eGui.contains(e.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(e,t){this.tooltipFeature=this.beans.tooltipSvc?.setupHeaderTooltip(this.tooltipFeature,this,e,t)}setupStylesFromColDef(){this.setRefreshFunction("headerStyles",this.refreshHeaderStyles.bind(this)),this.refreshHeaderStyles()}setupClassesFromColDef(){let e=()=>{let t=this.column.getColDef(),i=gM(t,this.gos,this.column,null),n=this.userHeaderClasses;this.userHeaderClasses=new Set(i);for(let s of i)n.has(s)?n.delete(s):this.comp.toggleCss(s,!0);for(let s of n)this.comp.toggleCss(s,!1)};this.setRefreshFunction("headerClasses",e),e()}setDragSource(e){this.dragSourceElement=e,this.removeDragSource(),!(!e||!this.draggable)&&(this.dragSource=this.beans.colMoves?.setDragSourceForHeader(e,this.column,this.displayName)??null)}updateState(){let{menuSvc:e}=this.beans;this.menuEnabled=!!e?.isColumnMenuInHeaderEnabled(this.column),this.openFilterEnabled=!!e?.isFilterMenuInHeaderEnabled(this.column),this.sortable=this.column.isSortable(),this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}setRefreshFunction(e,t){this.refreshFunctions[e]=t}refresh(){this.updateState(),this.refreshHeaderComp(),this.refreshAria();for(let e of Object.values(this.refreshFunctions))e()}refreshHeaderComp(){let e=this.lookupUserCompDetails();if(!e)return;(this.comp.getUserCompInstance()!=null&&this.userCompDetails.componentClass==e.componentClass?this.attemptHeaderCompRefresh(e.params):!1)?this.setDragSource(this.dragSourceElement):this.setCompDetails(e)}attemptHeaderCompRefresh(e){let t=this.comp.getUserCompInstance();return!t||!t.refresh?!1:t.refresh(e)}calculateDisplayName(){return this.beans.colNames.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(){this.displayName!==this.calculateDisplayName()&&this.refresh()}workOutDraggable(){let e=this.column.getColDef();return!!(!this.gos.get("suppressMovableColumns")&&!e.suppressMovable&&!e.lockPosition)||!!e.enableRowGroup||!!e.enablePivot}setupWidth(e){let t=()=>{let i=this.column.getActualWidth();this.comp.setWidth(`${i}px`)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupMovingCss(e){let t=()=>{this.comp.toggleCss("ag-header-cell-moving",this.column.isMoving())};e.addManagedListeners(this.column,{movingChanged:t}),t()}setupMenuClass(e){let t=()=>{this.comp?.toggleCss("ag-column-menu-visible",this.column.isMenuVisible())};e.addManagedListeners(this.column,{menuVisibleChanged:t}),t()}setupSortableClass(e){let t=()=>{this.comp.toggleCss("ag-header-cell-sortable",!!this.sortable)};t(),this.setRefreshFunction("updateSortable",t),e.addManagedEventListeners({sortChanged:this.refreshAriaSort.bind(this)})}setupFilterClass(e){let t=()=>{let i=this.column.isFilterActive();this.comp.toggleCss("ag-header-cell-filtered",i),this.refreshAria()};e.addManagedListeners(this.column,{filterActiveChanged:t}),t()}setupWrapTextClass(){let e=()=>{let t=!!this.column.getColDef().wrapHeaderText;this.comp.toggleCss("ag-header-cell-wrap-text",t)};e(),this.setRefreshFunction("wrapText",e)}onHeaderHighlightChanged(){let e=this.column.getHighlighted(),t=e===0,i=e===1;this.comp.toggleCss("ag-header-highlight-before",t),this.comp.toggleCss("ag-header-highlight-after",i)}onDisplayedColumnsChanged(){super.onDisplayedColumnsChanged(),this.isAlive()&&this.onHeaderHeightChanged()}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){let{eGui:e,column:t,comp:i,beans:n}=this,s=ow(this.beans),o=s.reduce((h,p)=>h+p,0)===0;if(i.toggleCss("ag-header-parent-hidden",o),!t.isSpanHeaderHeight()){e.style.removeProperty("top"),e.style.removeProperty("height"),i.toggleCss("ag-header-span-height",!1),i.toggleCss("ag-header-span-total",!1);return}let{numberOfParents:r,isSpanningTotal:a}=this.column.getColumnGroupPaddingInfo();i.toggleCss("ag-header-span-height",r>0);let l=rw(n);if(r===0){i.toggleCss("ag-header-span-total",!1),e.style.setProperty("top","0px"),e.style.setProperty("height",`${l}px`);return}i.toggleCss("ag-header-span-total",a);let d=(this.column.getFirstRealParent()?.getLevel()??-1)+1,c=s.length-d,u=0;for(let h=0;h<c;h++)u+=s[s.length-1-h];e.style.setProperty("top",`${-u}px`),e.style.setProperty("height",`${l+u}px`)}refreshAriaSort(){if(this.sortable){let e=this.getLocaleTextFunc(),t=this.beans.sortSvc?.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(nO(t)),this.setAriaDescriptionProperty("sort",e("ariaSortableColumn","Press ENTER to sort"))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)}refreshAriaMenu(){if(this.menuEnabled){let e=this.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",e("ariaMenuColumn","Press ALT DOWN to open column menu"))}else this.setAriaDescriptionProperty("menu",null)}refreshAriaFilterButton(){if(this.openFilterEnabled&&!Ti(this.gos)){let e=this.getLocaleTextFunc();this.setAriaDescriptionProperty("filterButton",e("ariaFilterColumn","Press CTRL ENTER to open filter"))}else this.setAriaDescriptionProperty("filterButton",null)}refreshAriaFiltered(){let e=this.getLocaleTextFunc();this.column.isFilterActive()?this.setAriaDescriptionProperty("filter",e("ariaColumnFiltered","Column Filtered")):this.setAriaDescriptionProperty("filter",null)}setAriaDescriptionProperty(e,t){t!=null?this.ariaDescriptionProperties.set(e,t):this.ariaDescriptionProperties.delete(e)}announceAriaDescription(){if(!this.eGui.contains(ot(this.beans)))return;let e=Array.from(this.ariaDescriptionProperties.keys()).sort((t,i)=>t==="filter"?-1:i.charCodeAt(0)-t.charCodeAt(0)).map(t=>this.ariaDescriptionProperties.get(t)).join(". ");this.beans.ariaAnnounce?.announceValue(e,"columnHeader")}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaFilterButton(),this.refreshAriaFiltered()}addColumnHoverListener(e){this.beans.colHover?.addHeaderColumnHoverListener(e,this.comp,this.column)}addActiveHeaderMouseListeners(e){let t=s=>this.handleMouseOverChange(s.type==="mouseenter"),i=()=>{this.setActiveHeader(!0),this.dispatchColumnMouseEvent("columnHeaderClicked",this.column)},n=s=>this.handleContextMenuMouseEvent(s,void 0,this.column);e.addManagedListeners(this.eGui,{mouseenter:t,mouseleave:t,click:i,contextmenu:n})}handleMouseOverChange(e){this.setActiveHeader(e),this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column})}setActiveHeader(e){this.comp.toggleCss("ag-header-active",e)}getAnchorElementForMenu(e){let t=this.comp.getUserCompInstance();return NR(t)?t.getAnchorElementForMenu(e):this.eGui}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function NR(e){return typeof e?.getAnchorElementForMenu=="function"&&typeof e.onMenuKeyboardShortcut=="function"}var lG=0,_C=class extends F{constructor(e,t,i){super(),this.rowIndex=e,this.pinned=t,this.type=i,this.instanceId=lG++,this.comp=null,this.allCtrls=[];let n="ag-header-row-column";i==="group"?n="ag-header-row-group":i==="filter"&&(n="ag-header-row-filter"),this.headerRowClass=`ag-header-row ${n}`}setRowIndex(e){this.rowIndex=e,this.comp?.setRowIndex(this.getAriaRowIndex()),this.onRowHeightChanged()}postConstruct(){this.isPrintLayout=jt(this.gos,"print"),this.isEnsureDomOrder=this.gos.get("ensureDomOrder")}areCellsRendered(){return this.comp?this.allCtrls.every(e=>e.eGui!=null):!1}setComp(e,t,i=!0){this.comp=e,t=Ud(this,this.beans.context,t),i&&(this.setRowIndex(this.rowIndex),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners(t)}getAriaRowIndex(){return this.rowIndex+1}addEventListeners(e){let t=this.onRowHeightChanged.bind(this),i=this.onDisplayedColumnsChanged.bind(this);e.addManagedEventListeners({columnResized:this.setWidth.bind(this),displayedColumnsChanged:i,virtualColumnsChanged:n=>this.onVirtualColumnsChanged(n.afterScroll),columnGroupHeaderHeightChanged:t,columnHeaderHeightChanged:t,gridStylesChanged:t,advancedFilterEnabledChanged:t}),e.addManagedPropertyListener("domLayout",i),e.addManagedPropertyListener("ensureDomOrder",n=>this.isEnsureDomOrder=n.currentValue),e.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],t)}onDisplayedColumnsChanged(){this.isPrintLayout=jt(this.gos,"print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}setWidth(){if(!this.comp)return;let e=this.getWidthForRow();this.comp.setWidth(`${e}px`)}getWidthForRow(){let{visibleCols:e}=this.beans;return this.isPrintLayout?this.pinned!=null?0:e.getContainerWidth("right")+e.getContainerWidth("left")+e.getContainerWidth(null):e.getContainerWidth(this.pinned)}onRowHeightChanged(){if(!this.comp)return;let{topOffset:e,rowHeight:t}=this.getTopAndHeight();this.comp.setTop(e+"px"),this.comp.setHeight(t+"px")}getTopAndHeight(){let e=0,t=ow(this.beans);for(let s=0;s<t.length;s++){if(s===this.rowIndex&&this.type==="group")return{topOffset:e,rowHeight:t[s]};e+=t[s]}let i=rw(this.beans);if(this.type==="column")return{topOffset:e,rowHeight:i};e+=i;let n=mM(this.beans);return{topOffset:e,rowHeight:n}}onVirtualColumnsChanged(e=!1){if(!this.comp)return;let t=this.getUpdatedHeaderCtrls(),i=this.isEnsureDomOrder||this.isPrintLayout;this.comp.setHeaderCtrls(t,i,e)}getUpdatedHeaderCtrls(){let e=this.ctrlsById;this.ctrlsById=new Map;let t=this.getColumnsInViewport();for(let n of t)this.recycleAndCreateHeaderCtrls(n,this.ctrlsById,e);let i=n=>{let{focusSvc:s,visibleCols:o}=this.beans;return s.isHeaderWrapperFocused(n)?o.isVisible(n.column):!1};if(e)for(let[n,s]of e)i(s)?this.ctrlsById.set(n,s):this.destroyBean(s);return this.allCtrls=Array.from(this.ctrlsById.values()),this.allCtrls}getHeaderCellCtrls(){return this.allCtrls}recycleAndCreateHeaderCtrls(e,t,i){if(e.isEmptyGroup())return;let n=e.getUniqueId(),s;if(i&&(s=i.get(n),i.delete(n)),s&&s.column!=e&&(this.destroyBean(s),s=void 0),s==null)switch(this.type){case"filter":{s=this.createBean(this.beans.registry.createDynamicBean("headerFilterCellCtrl",!0,e,this));break}case"group":s=this.createBean(this.beans.registry.createDynamicBean("headerGroupCellCtrl",!0,e,this));break;default:s=this.createBean(new aG(e,this));break}t.set(n,s)}getColumnsInViewport(){if(!this.isPrintLayout)return this.getComponentsToRender();if(this.pinned)return[];let e=[];for(let t of["left",null,"right"])e.push(...this.getComponentsToRender(t));return e}getComponentsToRender(e=this.pinned){return this.type==="group"?this.beans.colViewport.getHeadersToRender(e,this.rowIndex):this.beans.colViewport.getColumnHeadersToRender(e)}focusHeader(e,t){let i=this.allCtrls.find(s=>s.column==e);return i?i.focus(t):!1}destroy(){this.allCtrls=this.destroyBeans(this.allCtrls),this.ctrlsById=void 0,this.comp=null,super.destroy()}},dG=class extends F{constructor(e){super(),this.pinned=e,this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[]}setComp(e,t){this.comp=e,this.eViewport=t;let{pinnedCols:i,ctrlsSvc:n,colModel:s,colMoves:o}=this.beans;this.setupCenterWidth(),i?.setupHeaderPinnedWidth(this),this.setupDragAndDrop(o,this.eViewport);let r=this.refresh.bind(this,!0);this.addManagedEventListeners({displayedColumnsChanged:r,advancedFilterEnabledChanged:r});let a=`${typeof this.pinned=="string"?this.pinned:"center"}Header`;n.register(a,this),s.ready&&this.refresh()}getAllCtrls(){let e=[...this.groupsRowCtrls];return this.columnsRowCtrl&&e.push(this.columnsRowCtrl),this.filtersRowCtrl&&e.push(this.filtersRowCtrl),e}refresh(e=!1){let{focusSvc:t,filterManager:i,visibleCols:n}=this.beans,s=0,o=t.getFocusHeaderToUseAfterRefresh(),r=()=>{let u=n.headerGroupRowCount;s=u,e||(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls));let h=this.groupsRowCtrls.length;if(h!==u){if(h>u){for(let p=u;p<h;p++)this.destroyBean(this.groupsRowCtrls[p]);this.groupsRowCtrls.length=u;return}for(let p=h;p<u;p++){let g=this.createBean(new _C(p,this.pinned,"group"));this.groupsRowCtrls.push(g)}}},a=()=>{let u=s++;if(this.hidden){this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl);return}this.columnsRowCtrl==null||!e?(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl),this.columnsRowCtrl=this.createBean(new _C(u,this.pinned,"column"))):this.columnsRowCtrl.rowIndex!==u&&this.columnsRowCtrl.setRowIndex(u)},l=()=>{this.includeFloatingFilter=!!i?.hasFloatingFilters()&&!this.hidden;let u=()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)};if(!this.includeFloatingFilter){u();return}e||u();let h=s++;this.filtersRowCtrl?this.filtersRowCtrl.rowIndex!==h&&this.filtersRowCtrl.setRowIndex(h):this.filtersRowCtrl=this.createBean(new _C(h,this.pinned,"filter"))},d=this.getAllCtrls();r(),a(),l();let c=this.getAllCtrls();this.comp.setCtrls(c),this.restoreFocusOnHeader(t,o),d.length!==c.length&&this.beans.eventSvc.dispatchEvent({type:"headerRowsChanged"})}getHeaderCtrlForColumn(e){let t=i=>i?.getHeaderCellCtrls().find(n=>n.column===e);if(lo(e))return t(this.columnsRowCtrl);if(this.groupsRowCtrls.length!==0)for(let i=0;i<this.groupsRowCtrls.length;i++){let n=t(this.groupsRowCtrls[i]);if(n)return n}}getHtmlElementForColumnHeader(e){return this.getHeaderCtrlForColumn(e)?.eGui??null}getRowType(e){return this.getAllCtrls()[e]?.type}focusHeader(e,t,i){let s=this.getAllCtrls()[e];return s?s.focusHeader(t,i):!1}getGroupRowCount(){return this.groupsRowCtrls.length}getGroupRowCtrlAtIndex(e){return this.groupsRowCtrls[e]}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}setHorizontalScroll(e){this.comp.setViewportScrollLeft(e)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}destroy(){this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl),this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl),this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls),super.destroy()}setupDragAndDrop(e,t){let i=e?.createBodyDropTarget(this.pinned,t);i&&this.createManagedBean(i)}restoreFocusOnHeader(e,t){if(!t)return;let{column:i}=t;i.getPinned()==this.pinned&&e.focusHeaderPosition({headerPosition:t,scroll:!1})}setupCenterWidth(){this.pinned==null&&this.createManagedBean(new nw(e=>this.comp.setCenterWidth(`${e}px`),!0))}},cG=class extends F{constructor(){super(...arguments),this.beanName="menuSvc"}postConstruct(){let{enterpriseMenuFactory:e,filterMenuFactory:t}=this.beans;this.activeMenuFactory=e??t}showColumnMenu(e){this.showColumnMenuCommon(this.activeMenuFactory,e,"columnMenu")}showFilterMenu(e){this.showColumnMenuCommon(HR(this.beans),e,e.containerType,!0)}showHeaderContextMenu(e,t,i){this.activeMenuFactory?.showMenuAfterContextMenuEvent(e,t,i)}hidePopupMenu(){this.beans.contextMenuSvc?.hideActiveMenu(),this.activeMenuFactory?.hideActiveMenu()}hideFilterMenu(){HR(this.beans)?.hideActiveMenu()}isColumnMenuInHeaderEnabled(e){let{suppressHeaderMenuButton:t}=e.getColDef();return!t&&!!this.activeMenuFactory?.isMenuEnabled(e)&&(Ti(this.gos)||!!this.beans.enterpriseMenuFactory)}isFilterMenuInHeaderEnabled(e){return!e.getColDef().suppressHeaderFilterButton&&!!this.beans.filterManager?.isFilterAllowed(e)}isHeaderContextMenuEnabled(e){return!(e&&lo(e)?e.getColDef():e?.getColGroupDef())?.suppressHeaderContextMenu&&this.gos.get("columnMenu")==="new"}isHeaderMenuButtonAlwaysShowEnabled(){return this.isSuppressMenuHide()}isHeaderMenuButtonEnabled(){let e=!this.isSuppressMenuHide();return!(nr()&&e)}isHeaderFilterButtonEnabled(e){return this.isFilterMenuInHeaderEnabled(e)&&!Ti(this.gos)&&!this.isFloatingFilterButtonDisplayed(e)}isFilterMenuItemEnabled(e){return!!this.beans.filterManager?.isFilterAllowed(e)&&!Ti(this.gos)&&!this.isFilterMenuInHeaderEnabled(e)&&!this.isFloatingFilterButtonDisplayed(e)}isFloatingFilterButtonEnabled(e){return!e.getColDef().suppressFloatingFilterButton}isFloatingFilterButtonDisplayed(e){return!!e.getColDef().floatingFilter&&this.isFloatingFilterButtonEnabled(e)}isSuppressMenuHide(){let e=this.gos,t=e.get("suppressMenuHide");return Ti(e)?e.exists("suppressMenuHide")?t:!1:t}showColumnMenuCommon(e,t,i,n){let{positionBy:s,onClosedCallback:o}=t,r=t.column;if(s==="button"){let{buttonElement:a}=t;e?.showMenuAfterButtonClick(r,a,i,o,n)}else if(s==="mouse"){let{mouseEvent:a}=t;e?.showMenuAfterMouseEvent(r,a,i,o,n)}else if(r){let a=this.beans,l=a.ctrlsSvc;l.getScrollFeature().ensureColumnVisible(r,"auto"),Ps(a,()=>{let d=l.getHeaderRowContainerCtrl(r.getPinned())?.getHeaderCtrlForColumn(r);d&&e?.showMenuAfterButtonClick(r,d.getAnchorElementForMenu(n),i,o,n)})}}};function BR(e,t,i){e.menuVisible!==t&&(e.menuVisible=t,e.dispatchColEvent("menuVisibleChanged",i))}function HR(e){let{enterpriseMenuFactory:t,filterMenuFactory:i,gos:n}=e;return t&&Ti(n)?t:i}var og=class extends qv{constructor(){super(...arguments),this.errorMessages=null}init(e){this.params=e,this.initialiseEditor(e),this.eEditor.onValueChange(()=>e.validate())}destroy(){this.errorMessages=null}},wM=class extends Be{constructor(){super()}},uG={tag:"span",cls:"ag-overlay-loading-center"},hG=class extends wM{init(){let e=xs(this.gos.get("overlayLoadingTemplate")?.trim());if(this.setTemplate(e??uG),!e){let i=this.getLocaleTextFunc()("loadingOoo","Loading...");this.getGui().textContent=i,this.beans.ariaAnnounce.announceValue(i,"overlay")}}},pG={tag:"span",cls:"ag-overlay-no-rows-center"},gG=class extends wM{init(){let e=xs(this.gos.get("overlayNoRowsTemplate")?.trim());if(this.setTemplate(e??pG),!e){let i=this.getLocaleTextFunc()("noRowsToShow","No Rows To Show");this.getGui().textContent=i,this.beans.ariaAnnounce.announceValue(i,"overlay")}}};function fG(e,t,i){let n=ji(e,t,i);if(n){let{className:o}=n;if(typeof o=="string"&&o.includes("ag-icon")||typeof o=="object"&&o["ag-icon"])return n}let s=bt({tag:"span"});return s.appendChild(n),s}function ji(e,t,i){let n=null;e==="smallDown"?I(262):e==="smallLeft"?I(263):e==="smallRight"&&I(264);let s=i?.getColDef().icons;if(s&&(n=s[e]),t.gos&&!n){let o=t.gos.get("icons");o&&(n=o[e])}if(n){let o;if(typeof n=="function")o=n();else if(typeof n=="string")o=n;else{I(38,{iconName:e});return}if(typeof o=="string")return _v(o);if(Nv(o))return o;I(133,{iconName:e});return}else{let o=t.registry.getIcon(e);return o||t.validation?.validateIcon(e),bt({tag:"span",cls:`ag-icon ag-icon-${o??e}`,role:"presentation",attrs:{unselectable:"on"}})}}var mG=".ag-dnd-ghost{align-items:center;background-color:var(--ag-drag-and-drop-image-background-color);border:var(--ag-drag-and-drop-image-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-drag-and-drop-image-shadow);color:var(--ag-text-color);cursor:move;display:flex;font-weight:500;gap:var(--ag-cell-widget-spacing);height:var(--ag-header-height);overflow:hidden;padding-left:var(--ag-cell-horizontal-padding);padding-right:var(--ag-cell-horizontal-padding);text-overflow:ellipsis;transform:translateY(calc(var(--ag-spacing)*2));white-space:nowrap}.ag-dnd-ghost-not-allowed{border:var(--ag-drag-and-drop-image-not-allowed-border)}",CG={tag:"div",children:[{tag:"div",ref:"eGhost",cls:"ag-dnd-ghost ag-unselectable",children:[{tag:"span",ref:"eIcon",cls:"ag-dnd-ghost-icon ag-shake-left-to-right"},{tag:"div",ref:"eLabel",cls:"ag-dnd-ghost-label"}]}]},vG=class extends Be{constructor(){super(),this.dragSource=null,this.eIcon=U,this.eLabel=U,this.eGhost=U,this.registerCSS(mG)}postConstruct(){let e=t=>fG(t,this.beans,null);this.dropIconMap={pinned:e("columnMovePin"),hide:e("columnMoveHide"),move:e("columnMoveMove"),left:e("columnMoveLeft"),right:e("columnMoveRight"),group:e("columnMoveGroup"),aggregate:e("columnMoveValue"),pivot:e("columnMovePivot"),notAllowed:e("dropNotAllowed")}}init(e){this.dragSource=e.dragSource,this.setTemplate(CG),this.beans.environment.applyThemeClasses(this.eGhost)}destroy(){this.dragSource=null,super.destroy()}setIcon(e,t){let{eGhost:i,eIcon:n,dragSource:s,dropIconMap:o,gos:r}=this;$t(n);let a=null;e||(e=s?.getDefaultIconName?s.getDefaultIconName():"notAllowed"),a=o[e],i.classList.toggle("ag-dnd-ghost-not-allowed",e==="notAllowed"),n.classList.toggle("ag-shake-left-to-right",t),!(a===o.hide&&r.get("suppressDragLeaveHidesColumns"))&&a&&n.appendChild(a)}setLabel(e){this.eLabel.textContent=e}},wG=".ag-checkbox-cell{height:100%}",bG={tag:"div",cls:"ag-cell-wrapper ag-checkbox-cell",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},yG=class extends Be{constructor(){super(bG,[Kv]),this.eCheckbox=U,this.registerCSS(wG)}init(e){this.refresh(e);let{eCheckbox:t,beans:i}=this,n=t.getInputElement();n.setAttribute("tabindex","-1"),A6(n,"polite"),this.addManagedListeners(n,{click:s=>{if(dr(s),t.isDisabled())return;let o=t.getValue();this.onCheckboxChanged(o)},dblclick:s=>{dr(s)}}),this.addManagedElementListeners(e.eGridCell,{keydown:s=>{if(s.key===k.SPACE&&!t.isDisabled()){e.eGridCell===ot(i)&&t.toggle();let o=t.getValue();this.onCheckboxChanged(o),s.preventDefault()}}})}refresh(e){return this.params=e,this.updateCheckbox(e),!0}updateCheckbox(e){let t,i=!0,{value:n,column:s,node:o}=e;if(o.group&&s)if(typeof n=="boolean")t=n;else{let u=s.getColId();u.startsWith(eg)?t=n==null||n===""?void 0:n==="true":o.aggData&&o.aggData[u]!==void 0||o.sourceRowIndex>=0?t=n??void 0:i=!1}else t=n??void 0;let{eCheckbox:r}=this;if(!i){r.setDisplayed(!1);return}r.setValue(t);let a=e.disabled??!s?.isCellEditable(o);r.setDisabled(a);let l=this.getLocaleTextFunc(),d=Zp(l,t),c=a?d:`${l("ariaToggleCellValue","Press SPACE to toggle cell value")} (${d})`;r.setInputAriaLabel(c)}onCheckboxChanged(e){let{params:t}=this,{column:i,node:n,value:s}=t;this.beans?.editSvc?.setEditingCells([{column:i,colId:i.getColId(),rowIndex:n.rowIndex,rowPinned:n.rowPinned,state:"changed",oldValue:s,newValue:s}],{update:!0,forceRefreshOfEditCellsOnly:!0});let o=n.setDataValue(i,e,"renderer");this.beans.editSvc?.stopEditing({rowNode:n,column:i},{source:this.beans.editSvc?.isBatchEditing()?"ui":"api"}),o||this.updateCheckbox(t)}},VR=class{constructor(e,t){this.beans=e,this.floating=t,this.all=new Set,this.visible=new Set,this.order=[],this.queued=new Set}size(){return this.visible.size}add(e){let{all:t,visible:i,order:n}=this;t.has(e)||(t.add(e),i.add(e),n.push(e),this.sort())}delete(e){this.all.delete(e),this.visible.delete(e),this.queued.delete(e.id),an(this.order,e)}has(e){return this.visible.has(e)}forEach(e){this.order.forEach(e)}getByIndex(e){return this.order[e]}getById(e){for(let t of this.visible)if(t.id==e)return t}clear(){let{all:e,visible:t,order:i,queued:n}=this;e.clear(),n.clear(),t.clear(),i.length=0}sort(){let{sortSvc:e,rowNodeSorter:t,gos:i}=this.beans,n=e?.getSortOptions()??[],s=EG(this.order);if(this.order.sort((r,a)=>(r.pinnedSibling?.rowIndex??0)-(a.pinnedSibling?.rowIndex??0)),this.order=t?.doFullSort(this.order,n)??this.order,!s)return;let o=l4(i);o==="bottom"||o==="pinnedBottom"?this.order.push(s):this.order.unshift(s)}hide(e){let{all:t,visible:i}=this;t.forEach(n=>e(n)?i.delete(n):i.add(n)),this.order=Array.from(i),this.sort()}queue(e){this.queued.add(e)}unqueue(e){this.queued.delete(e)}forEachQueued(e){this.queued.forEach(e)}};function bM(e){if(e.level===-1)return!0;let t=e.parent;return t?.childrenAfterSort?.some(i=>i==e)?bM(t):!1}function LC(e,t){let{gos:i,rowModel:n,filterManager:s}=e;return Ua(i,n)?!n.getRowNode(t.id):s?.isAnyFilterPresent()?!bM(t):i.get("pivotMode")?!t.group:!1}function SG(e){return!!e.footer&&e.level===-1}function xG(e){return!!e.pinnedSibling&&SG(e.pinnedSibling)}function EG(e){let t=e.findIndex(xG);if(t>-1)return e.splice(t,1)?.[0]}var GR=class extends F{postConstruct(){let{gos:e,beans:t}=this;this.top=new VR(t,"top"),this.bottom=new VR(t,"bottom");let i=s=>LC(t,s.pinnedSibling),n=()=>{let s=e.get("isRowPinned");s&&e.get("enableRowPinning")&&t.rowModel.forEachNode(o=>this.pinRow(o,s(o)),!0),this.refreshRowPositions(),this.dispatchRowPinnedEvents()};this.addManagedEventListeners({gridStylesChanged:this.onGridStylesChanges.bind(this),modelUpdated:({keepRenderedRows:s})=>{this.tryToEmptyQueues(),this.pinGrandTotalRow(),this.forContainers(r=>r.hide(i));let o=this.refreshRowPositions();(!s||o)&&this.dispatchRowPinnedEvents()},columnRowGroupChanged:()=>{this.forContainers(MG),this.refreshRowPositions()},rowNodeDataChanged:({node:s})=>{(e.get("isRowPinnable")?.(s)??!0)||this.pinRow(s,null)},firstDataRendered:n}),this.addManagedPropertyListener("pivotMode",()=>{this.forContainers(s=>s.hide(i)),this.dispatchRowPinnedEvents()}),this.addManagedPropertyListener("grandTotalRow",({currentValue:s})=>{this._grandTotalPinned=s==="pinnedBottom"?"bottom":s==="pinnedTop"?"top":null}),this.addManagedPropertyListener("isRowPinned",n)}destroy(){this.reset(!1),super.destroy()}reset(e=!0){this.forContainers(t=>{let i=[];t.forEach(n=>i.push(n)),i.forEach(n=>this.pinRow(n,null)),t.clear()}),e&&this.dispatchRowPinnedEvents()}pinRow(e,t,i){if(e.footer&&e.level>-1)return;if(e.footer&&e.level===-1){this._grandTotalPinned=t,kG(this.beans);return}let n=e.rowPinned??e.pinnedSibling?.rowPinned;if(n!=null&&t!=null&&t!=n){let r=e.rowPinned?e:e.pinnedSibling,a=e.rowPinned?e.pinnedSibling:e;this.pinRow(r,null,i),this.pinRow(a,t,i);return}let o=i&&DG(this.beans,e,i);if(o){o.forEach(r=>this.pinRow(r,t));return}if(t==null){let r=e.rowPinned?e:e.pinnedSibling,a=this.findPinnedRowNode(r);if(!a)return;a.delete(r);let l=r.pinnedSibling;OC(r),this.refreshRowPositions(t),this.dispatchRowPinnedEvents(l)}else{let r=zR(this.beans,e,t),a=this.getContainer(t);a.add(r),LC(this.beans,e)&&a.hide(l=>LC(this.beans,l.pinnedSibling)),this.refreshRowPositions(t),this.dispatchRowPinnedEvents(e)}}isManual(){return!0}isEmpty(e){return this.getContainer(e).size()===0}isRowsToRender(e){return!this.isEmpty(e)}ensureRowHeightsValid(){let e=!1,t=0,i=n=>{if(n.rowHeightEstimated){let s=ao(this.beans,n);n.setRowTop(t),n.setRowHeight(s.height),t+=s.height,e=!0}};return this.bottom.forEach(i),t=0,this.top.forEach(i),this.eventSvc.dispatchEvent({type:"pinnedHeightChanged"}),e}getPinnedTopTotalHeight(){return WR(this.top)}getPinnedBottomTotalHeight(){return WR(this.bottom)}getPinnedTopRowCount(){return this.top.size()}getPinnedBottomRowCount(){return this.bottom.size()}getPinnedTopRow(e){return this.top.getByIndex(e)}getPinnedBottomRow(e){return this.bottom.getByIndex(e)}getPinnedRowById(e,t){return this.getContainer(t).getById(e)}forEachPinnedRow(e,t){this.getContainer(e).forEach(t)}getPinnedState(){let e=t=>{let i=[];return this.forEachPinnedRow(t,n=>i.push(n.pinnedSibling.id)),i};return{top:e("top"),bottom:e("bottom")}}setPinnedState(e){this.forContainers((t,i)=>{for(let n of e[i]){let s=this.beans.rowModel.getRowNode(n);s?this.pinRow(s,i):t.queue(n)}})}getGrandTotalPinned(){return this._grandTotalPinned}setGrandTotalPinned(e){this._grandTotalPinned=e}tryToEmptyQueues(){this.forContainers((e,t)=>{let i=new Set;e.forEachQueued(n=>{let s=this.beans.rowModel.getRowNode(n);s&&i.add(s)});for(let n of i)e.unqueue(n.id),this.pinRow(n,t)})}pinGrandTotalRow(){let{gos:e,beans:t,_grandTotalPinned:i}=this,n=t.rowModel;if(!wt(e,n))return;let s=n.rootNode?.sibling;if(!s)return;let o=s.pinnedSibling,r=o&&this.findPinnedRowNode(o);if(i){if(r&&r.floating!==i&&(r.delete(o),OC(o)),!r||r.floating!==i){let a=zR(t,s,i);this.getContainer(i).add(a)}}else{if(!r)return;r.delete(o),OC(o)}}onGridStylesChanges(e){e.rowHeightChanged&&this.forContainers(t=>t.forEach(i=>i.setRowHeight(i.rowHeight,!0)))}getContainer(e){return e==="top"?this.top:this.bottom}findPinnedRowNode(e){if(this.top.has(e))return this.top;if(this.bottom.has(e))return this.bottom}refreshRowPositions(e){let t=n=>RG(this.beans,n);if(e)return t(this.getContainer(e));let i=!1;return this.forContainers(n=>{let s=t(n);i||(i=s)}),i}forContainers(e){e(this.top,"top"),e(this.bottom,"bottom")}dispatchRowPinnedEvents(e){this.eventSvc.dispatchEvent({type:"pinnedRowsChanged"}),e?.dispatchRowEvent("rowPinned")}};function RG(e,t){let i=0,n=!1;return t.forEach((s,o)=>{if(n||(n=s.rowTop!==i),s.setRowTop(i),s.rowHeightEstimated||s.rowHeight==null){let r=ao(e,s).height;n||(n=s.rowHeight!==r),s.setRowHeight(r)}s.setRowIndex(o),i+=s.rowHeight}),n}function zR(e,t,i){if(t.pinnedSibling)return t.pinnedSibling;let n=zH(t,e);n.setRowTop(null),n.setRowIndex(null),n.rowPinned=i;let s=i==="top"?Zv:ew;return n.id=`${s}${i}-${t.id}`,n.pinnedSibling=t,t.pinnedSibling=n,n}function OC(e){if(!e.pinnedSibling)return;e.rowPinned=null,e.setRowTop(null),e.setRowIndex(null);let t=e.pinnedSibling;e.pinnedSibling=void 0,t&&(t.pinnedSibling=void 0,t.rowPinned=null)}function MG(e){let t=new Set;e.forEach(i=>{i.group&&t.add(i)}),t.forEach(i=>e.delete(i))}function DG(e,t,i){let{rowSpanSvc:n}=e,s=(i&&n?.isCellSpanning(i,t))??!1;if(i&&s)return n?.getCellSpan(i,t)?.spannedNodes}function WR(e){let t=e.size();if(t===0)return 0;let i=e.getByIndex(t-1);return i===void 0?0:i.rowTop+i.rowHeight}function kG({gos:e,rowModel:t}){wt(e,t)&&t.refreshModel({step:"map"})}var UR=class extends F{constructor(){super(...arguments),this.nextId=0,this.pinnedTopRows={cache:{},order:[]},this.pinnedBottomRows={cache:{},order:[]}}postConstruct(){let e=this.gos;this.setPinnedRowData(e.get("pinnedTopRowData"),"top"),this.setPinnedRowData(e.get("pinnedBottomRowData"),"bottom"),this.addManagedPropertyListener("pinnedTopRowData",t=>this.setPinnedRowData(t.currentValue,"top")),this.addManagedPropertyListener("pinnedBottomRowData",t=>this.setPinnedRowData(t.currentValue,"bottom")),this.addManagedEventListeners({gridStylesChanged:this.onGridStylesChanges.bind(this)})}reset(){}isEmpty(e){return this.getCache(e).order.length===0}isRowsToRender(e){return!this.isEmpty(e)}isManual(){return!1}pinRow(e,t){}onGridStylesChanges(e){if(e.rowHeightChanged){let t=i=>{i.setRowHeight(i.rowHeight,!0)};hd(this.pinnedBottomRows,t),hd(this.pinnedTopRows,t)}}ensureRowHeightsValid(){let e=!1,t=0,i=n=>{if(n.rowHeightEstimated){let s=ao(this.beans,n);n.setRowTop(t),n.setRowHeight(s.height),t+=s.height,e=!0}};return hd(this.pinnedBottomRows,i),t=0,hd(this.pinnedTopRows,i),this.eventSvc.dispatchEvent({type:"pinnedHeightChanged"}),e}setPinnedRowData(e,t){this.updateNodesFromRowData(e,t),this.eventSvc.dispatchEvent({type:"pinnedRowDataChanged"})}updateNodesFromRowData(e,t){let i=this.getCache(t);if(e===void 0){i.order.length=0,i.cache={};return}let n=Ba(this.gos),s=t==="top"?Zv:ew,o=new Set(i.order),r=[],a=new Set,l=0,d=-1;for(let c of e){let u=n?.({data:c,level:0,rowPinned:t})??s+this.nextId++;if(a.has(u)){I(96,{id:u,data:c});continue}d++,a.add(u),r.push(u);let h=Rd(i,u);if(h!==void 0)h.data!==c&&h.updateData(c),l+=this.setRowTopAndRowIndex(h,l,d),o.delete(u);else{let p=new co(this.beans);p.id=u,p.data=c,p.rowPinned=t,l+=this.setRowTopAndRowIndex(p,l,d),i.cache[u]=p,i.order.push(u)}}for(let c of o)Rd(i,c)?.clearRowTopAndRowIndex(),delete i.cache[c];i.order=r}setRowTopAndRowIndex(e,t,i){return e.setRowTop(t),e.setRowHeight(ao(this.beans,e).height),e.setRowIndex(i),e.rowHeight}getPinnedTopTotalHeight(){return qR(this.pinnedTopRows)}getPinnedBottomTotalHeight(){return qR(this.pinnedBottomRows)}getPinnedTopRowCount(){return wv(this.pinnedTopRows)}getPinnedBottomRowCount(){return wv(this.pinnedBottomRows)}getPinnedTopRow(e){return vv(this.pinnedTopRows,e)}getPinnedBottomRow(e){return vv(this.pinnedBottomRows,e)}getPinnedRowById(e,t){return Rd(this.getCache(t),e)}forEachPinnedRow(e,t){return hd(this.getCache(e),t)}getCache(e){return e==="top"?this.pinnedTopRows:this.pinnedBottomRows}getPinnedState(){return{top:[],bottom:[]}}setPinnedState(){}getGrandTotalPinned(){}setGrandTotalPinned(){}};function qR(e){let t=wv(e);if(t===0)return 0;let i=vv(e,t-1);return i===void 0?0:i.rowTop+i.rowHeight}function Rd(e,t){return e.cache[t]}function vv(e,t){return Rd(e,e.order[t])}function hd(e,t){e.order.forEach((i,n)=>{let s=Rd(e,i);s&&t(s,n)})}function wv(e){return e.order.length}var PG=class extends F{constructor(){super(...arguments),this.beanName="pinnedRowModel"}postConstruct(){let{gos:e}=this,t=()=>{let i=e.get("enableRowPinning"),n=l4(e),o=!!i||(n==="pinnedBottom"||n==="pinnedTop"),r=o?this.inner instanceof UR:this.inner instanceof GR;this.inner&&r&&this.destroyBean(this.inner),(r||!this.inner)&&(this.inner=this.createManagedBean(o?new GR:new UR))};this.addManagedPropertyListeners(["enableRowPinning","grandTotalRow"],t),t()}reset(){return this.inner.reset()}isEmpty(e){return this.inner.isEmpty(e)}isManual(){return this.inner.isManual()}isRowsToRender(e){return this.inner.isRowsToRender(e)}pinRow(e,t,i){return this.inner.pinRow(e,t,i)}ensureRowHeightsValid(){return this.inner.ensureRowHeightsValid()}getPinnedRowById(e,t){return this.inner.getPinnedRowById(e,t)}getPinnedTopTotalHeight(){return this.inner.getPinnedTopTotalHeight()}getPinnedBottomTotalHeight(){return this.inner.getPinnedBottomTotalHeight()}getPinnedTopRowCount(){return this.inner.getPinnedTopRowCount()}getPinnedBottomRowCount(){return this.inner.getPinnedBottomRowCount()}getPinnedTopRow(e){return this.inner.getPinnedTopRow(e)}getPinnedBottomRow(e){return this.inner.getPinnedBottomRow(e)}forEachPinnedRow(e,t){return this.inner.forEachPinnedRow(e,t)}getPinnedState(){return this.inner.getPinnedState()}setPinnedState(e){return this.inner.setPinnedState(e)}setGrandTotalPinned(e){return this.inner.setGrandTotalPinned(e)}getGrandTotalPinned(){return this.inner.getGrandTotalPinned()}};function Kd(e){return!!(e.rowPinned&&e.pinnedSibling)}function $i(e,t,i,n){let s=t==="top";if(!i)return $i(e,t,s?e.getPinnedTopRow(0):e.getPinnedBottomRow(0),n);if(!n){let l=s?e.getPinnedTopRowCount():e.getPinnedBottomRowCount();return $i(e,t,i,s?e.getPinnedTopRow(l-1):e.getPinnedBottomRow(l-1))}let o=!1,r=!1,a=[];return e.forEachPinnedRow(t,l=>{if(l===i&&!o){o=!0,a.push(l);return}if(o&&l===n){r=!0,a.push(l);return}o&&!r&&a.push(l)}),a}var FG={tag:"div",cls:"ag-selection-checkbox",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},TG=class extends Be{constructor(){super(FG,[Kv]),this.eCheckbox=U}postConstruct(){this.eCheckbox.setPassive(!0)}onDataChanged(){this.onSelectionChanged()}onSelectableChanged(){this.showOrHideSelect()}onSelectionChanged(){let e=this.getLocaleTextFunc(),{rowNode:t,eCheckbox:i}=this,n=t.isSelected(),s=Zp(e,n),[o,r]=t.selectable?["ariaRowToggleSelection","Press Space to toggle row selection"]:["ariaRowSelectionDisabled","Row Selection is disabled for this row"],a=e(o,r);i.setValue(n,!0),i.setInputAriaLabel(`${a} (${s})`)}init(e){if(this.rowNode=e.rowNode,this.column=e.column,this.overrides=e.overrides,this.onSelectionChanged(),this.addManagedListeners(this.eCheckbox.getInputElement(),{dblclick:dr,click:n=>{dr(n),this.beans.selectionSvc?.handleSelectionEvent(n,this.rowNode,"checkboxSelected")}}),this.addManagedListeners(this.rowNode,{rowSelected:this.onSelectionChanged.bind(this),dataChanged:this.onDataChanged.bind(this),selectableChanged:this.onSelectableChanged.bind(this)}),this.addManagedPropertyListener("rowSelection",({currentValue:n,previousValue:s})=>{let o=typeof n=="object"?vC(n):void 0,r=typeof s=="object"?vC(s):void 0;o!==r&&this.onSelectableChanged()}),sv(this.gos)||typeof this.getIsVisible()=="function"){let n=this.showOrHideSelect.bind(this);this.addManagedEventListeners({displayedColumnsChanged:n}),this.addManagedListeners(this.rowNode,{dataChanged:n,cellChanged:n}),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")}showOrHideSelect(){let{column:e,rowNode:t,overrides:i,gos:n}=this,s=t.selectable,o=this.getIsVisible(),r;if(typeof o=="function"){let u=i?.callbackParams;if(!e)r=o(O(b({},u),{node:t,data:t.data}));else{let h=e.createColumnFunctionCallbackParams(t);r=o(b(b({},u),h))}}else r=o??!1;let a=s&&!r||!s&&r,l=s||r,d=n.get("rowSelection"),c=d&&typeof d!="string"?!vC(d):!!e?.getColDef().showDisabledCheckboxes;this.setVisible(l&&(a?c:!0)),this.setDisplayed(l&&(a?c:!0)),l&&this.eCheckbox.setDisabled(a),i?.removeHidden&&this.setDisplayed(l)}getIsVisible(){let e=this.overrides;if(e)return e.isVisible;let t=this.gos.get("rowSelection");return t&&typeof t!="string"?Fa(t):this.column?.getColDef()?.checkboxSelection}},AG=class{constructor(e,t){this.rowModel=e,this.pinnedRowModel=t,this.selectAll=!1,this.rootId=null,this.endId=null,this.cachedRange=[]}reset(){this.rootId=null,this.endId=null,this.cachedRange.length=0}setRoot(e){this.rootId=e.id,this.endId=null,this.cachedRange.length=0}setEndRange(e){this.endId=e.id,this.cachedRange.length=0}getRange(){if(this.cachedRange.length===0){let e=this.getRoot(),t=this.getEnd();if(e==null||t==null)return this.cachedRange;this.cachedRange=this.getNodesInRange(e,t)??[]}return this.cachedRange}isInRange(e){return this.rootId===null?!1:this.getRange().some(t=>t.id===e.id)}getRoot(e){if(this.rootId)return this.getRowNode(this.rootId);if(e)return this.setRoot(e),e}getEnd(){if(this.endId)return this.getRowNode(this.endId)}getRowNode(e){let t,{rowModel:i,pinnedRowModel:n}=this;return t??(t=i.getRowNode(e)),n?.isManual()&&(t??(t=n.getPinnedRowById(e,"top")),t??(t=n.getPinnedRowById(e,"bottom"))),t}truncate(e){let t=this.getRange();if(t.length===0)return{keep:[],discard:[]};let i=t[0].id===this.rootId,n=t.findIndex(s=>s.id===e.id);if(n>-1){let s=t.slice(0,n),o=t.slice(n+1);return this.setEndRange(e),i?{keep:s,discard:o}:{keep:o,discard:s}}else return{keep:t,discard:[]}}extend(e,t=!1){let i=this.getRoot();if(i==null){let s=this.getRange().slice();return t&&e.depthFirstSearch(o=>!o.group&&s.push(o)),s.push(e),this.setRoot(e),{keep:s,discard:[]}}let n=this.getNodesInRange(i,e);if(!n)return this.setRoot(e),{keep:[e],discard:[]};if(n.find(s=>s.id===this.endId))return this.setEndRange(e),{keep:this.getRange(),discard:[]};{let s=this.getRange().slice();return this.setEndRange(e),{keep:this.getRange(),discard:s}}}getNodesInRange(e,t){let{pinnedRowModel:i,rowModel:n}=this;if(!i?.isManual())return n.getNodesInRangeForSelection(e,t);if(e.rowPinned==="top"&&!t.rowPinned)return $i(i,"top",e,void 0).concat(n.getNodesInRangeForSelection(n.getRow(0),t)??[]);if(e.rowPinned==="bottom"&&!t.rowPinned){let s=$i(i,"bottom",void 0,e),o=n.getRowCount(),r=n.getRow(o-1);return(n.getNodesInRangeForSelection(t,r)??[]).concat(s)}if(!e.rowPinned&&!t.rowPinned)return n.getNodesInRangeForSelection(e,t);if(e.rowPinned==="top"&&t.rowPinned==="top")return $i(i,"top",e,t);if(e.rowPinned==="bottom"&&t.rowPinned==="top"){let s=$i(i,"top",t,void 0),o=$i(i,"bottom",void 0,e),r=n.getRow(0),a=n.getRow(n.getRowCount()-1);return s.concat(n.getNodesInRangeForSelection(r,a)??[]).concat(o)}if(!e.rowPinned&&t.rowPinned==="top")return $i(i,"top",t,void 0).concat(n.getNodesInRangeForSelection(n.getRow(0),e)??[]);if(e.rowPinned==="top"&&t.rowPinned==="bottom"){let s=$i(i,"top",e,void 0),o=$i(i,"bottom",void 0,t),r=n.getRow(0),a=n.getRow(n.getRowCount()-1);return s.concat(n.getNodesInRangeForSelection(r,a)??[]).concat(o)}if(e.rowPinned==="bottom"&&t.rowPinned==="bottom")return $i(i,"bottom",e,t);if(!e.rowPinned&&t.rowPinned==="bottom"){let s=$i(i,"bottom",void 0,t),o=n.getRow(n.getRowCount());return(n.getNodesInRangeForSelection(e,o)??[]).concat(s)}return null}},IG=class extends F{constructor(e){super(),this.column=e,this.cbSelectAllVisible=!1,this.processingEventFromCheckbox=!1}onSpaceKeyDown(e){let t=this.cbSelectAll;t.isDisplayed()&&!t.getGui().contains(ot(this.beans))&&(e.preventDefault(),t.setValue(!t.getValue()))}getCheckboxGui(){return this.cbSelectAll.getGui()}setComp(e){this.headerCellCtrl=e;let t=this.createManagedBean(new jv);this.cbSelectAll=t,t.addCss("ag-header-select-all"),oo(t.getGui(),"presentation"),this.showOrHideSelectAll();let i=this.updateStateOfCheckbox.bind(this);this.addManagedEventListeners({newColumnsLoaded:()=>this.showOrHideSelectAll(),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),selectionChanged:i,paginationChanged:i,modelUpdated:i}),this.addManagedPropertyListener("rowSelection",({currentValue:n,previousValue:s})=>{let o=r=>typeof r=="string"||!r||r.mode==="singleRow"?void 0:r.selectAll;o(n)!==o(s)&&this.showOrHideSelectAll(),this.updateStateOfCheckbox()}),this.addManagedListeners(t,{fieldValueChanged:this.onCbSelectAll.bind(this)}),t.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()}onDisplayedColumnsChanged(e){this.isAlive()&&this.showOrHideSelectAll(e.source==="uiColumnMoved")}showOrHideSelectAll(e=!1){let t=this.isCheckboxSelection();this.cbSelectAllVisible=t,this.cbSelectAll.setDisplayed(t),t&&(this.checkRightRowModelType("selectAllCheckbox"),this.checkSelectionType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel(e)}updateStateOfCheckbox(){if(!this.cbSelectAllVisible||this.processingEventFromCheckbox)return;this.processingEventFromCheckbox=!0;let e=this.getSelectAllMode(),t=this.beans.selectionSvc,i=this.cbSelectAll,n=t.getSelectAllState(e);i.setValue(n);let s=t.hasNodesToSelect(e);i.setDisabled(!s),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}refreshSelectAllLabel(e=!1){let t=this.getLocaleTextFunc(),{headerCellCtrl:i,cbSelectAll:n,cbSelectAllVisible:s}=this,o=n.getValue(),r=Zp(t,o),a=t("ariaRowSelectAll","Press Space to toggle all rows selection");i.setAriaDescriptionProperty("selectAll",s?`${a} (${r})`:null),n.setInputAriaLabel(t("ariaHeaderSelection","Column with Header Selection")),e||i.announceAriaDescription()}checkSelectionType(e){return Ld(this.gos)?!0:(I(128,{feature:e}),!1)}checkRightRowModelType(e){let{gos:t,rowModel:i}=this.beans;return wt(t)||Ua(t)?!0:(I(129,{feature:e,rowModel:i.getType()}),!1)}onCbSelectAll(){if(this.processingEventFromCheckbox||!this.cbSelectAllVisible)return;let e=this.cbSelectAll.getValue(),t=this.getSelectAllMode(),i="uiSelectAll";t==="currentPage"?i="uiSelectAllCurrentPage":t==="filtered"&&(i="uiSelectAllFiltered");let n={source:i,selectAll:t},s=this.beans.selectionSvc;e?s.selectAllRowNodes(n):s.deselectAllRowNodes(n)}isCheckboxSelection(){let{column:e,gos:t,beans:i}=this,o=typeof t.get("rowSelection")=="object"?"headerCheckbox":"headerCheckboxSelection";return yM(i,e)&&this.checkRightRowModelType(o)&&this.checkSelectionType(o)}getSelectAllMode(){let e=h4(this.gos,!1);if(e)return e;let{headerCheckboxSelectionCurrentPageOnly:t,headerCheckboxSelectionFilteredOnly:i}=this.column.getColDef();return t?"currentPage":i?"filtered":"all"}destroy(){super.destroy(),this.cbSelectAll=void 0,this.headerCellCtrl=void 0}};function yM({gos:e,selectionColSvc:t},i){let n=e.get("rowSelection"),s=i.getColDef(),{headerCheckboxSelection:o}=s,r=!1;if(typeof n=="object"){let l=Fs(i),d=Wv(i);(Np(n)==="autoGroupColumn"&&d||l&&t?.isSelectionColumnEnabled())&&(r=yp(n))}else typeof o=="function"?r=o(ae(e,{column:i,colDef:s})):r=!!o;return r}var _G=class extends F{postConstruct(){let{gos:e,beans:t}=this;this.selectionCtx=new AG(t.rowModel,t.pinnedRowModel),this.addManagedPropertyListeners(["isRowSelectable","rowSelection"],()=>{let i=sv(e);i!==this.isRowSelectable&&(this.isRowSelectable=i,this.updateSelectable())}),this.isRowSelectable=sv(e),this.addManagedEventListeners({cellValueChanged:i=>this.updateRowSelectable(i.node),rowNodeDataChanged:i=>this.updateRowSelectable(i.node)})}destroy(){super.destroy(),this.selectionCtx.reset()}createCheckboxSelectionComponent(){return new TG}createSelectAllFeature(e){if(yM(this.beans,e))return new IG(e)}isMultiSelect(){return Ld(this.gos)}onRowCtrlSelected(e,t,i){let n=!!e.rowNode.isSelected();e.forEachGui(i,s=>{s.rowComp.toggleCss("ag-row-selected",n);let o=s.element;L6(o,n),o.contains(ot(this.beans))&&t(s)})}announceAriaRowSelection(e){if(this.isRowSelectionBlocked(e))return;let t=e.isSelected(),i=this.beans.editSvc?.isEditing({rowNode:e});if(!e.selectable||i)return;let s=this.getLocaleTextFunc()(t?"ariaRowDeselect":"ariaRowSelect",`Press SPACE to ${t?"deselect":"select"} this row`);this.beans.ariaAnnounce?.announceValue(s,"rowSelection")}isRowSelectionBlocked(e){return!e.selectable||e.rowPinned&&!Kd(e)||!tr(this.gos)}updateRowSelectable(e,t){let i=e.rowPinned&&e.pinnedSibling?e.pinnedSibling.selectable:this.isRowSelectable?.(e)??!0;return this.setRowSelectable(e,i,t),i}setRowSelectable(e,t,i){if(e.selectable!==t){if(e.selectable=t,e.dispatchRowEvent("selectableChanged"),i)return;if(Od(this.gos)){let s=this.calculateSelectedFromChildren(e);this.setNodesSelected({nodes:[e],newValue:s??!1,source:"selectableChanged"});return}e.isSelected()&&!e.selectable&&this.setNodesSelected({nodes:[e],newValue:!1,source:"selectableChanged"})}}calculateSelectedFromChildren(e){let t=!1,i=!1;if(!e.childrenAfterGroup?.length)return e.selectable?e.__selected:null;for(let n=0;n<e.childrenAfterGroup.length;n++){let s=e.childrenAfterGroup[n],o=s.isSelected();if(!s.selectable){let r=this.calculateSelectedFromChildren(s);if(r===null)continue;o=r}switch(o){case!0:t=!0;break;case!1:i=!0;break;default:return}}if(!(t&&i))return t?!0:i?!1:e.selectable?e.__selected:null}selectRowNode(e,t,i,n="api"){let s=!e.selectable&&t,o=e.__selected===t;if(s||o)return!1;e.__selected=t,e.dispatchRowEvent("rowSelected");let r=e.sibling;r&&r.footer&&r.__localEventService&&r.dispatchRowEvent("rowSelected");let a=e.pinnedSibling;return a?.rowPinned&&a.__localEventService&&a.dispatchRowEvent("rowSelected"),this.eventSvc.dispatchEvent(O(b({},VH(e,this.gos,"rowSelected")),{event:i||null,source:n})),!0}isCellCheckboxSelection(e,t){let i=this.gos.get("rowSelection");if(i&&typeof i!="string"){let n=Fs(e)&&Fa(i);return e.isColumnFunc(t,n)}else return e.isColumnFunc(t,e.colDef.checkboxSelection)}inferNodeSelections(e,t,i,n){let{gos:s,selectionCtx:o}=this,r=e.isSelected(),a=Od(s),l=dN(s),d=cN(s),c=this.isMultiSelect(),u=n==="rowClicked";if(u&&!(l||d))return null;if(t&&i&&c){let h=o.getRoot();if(h)if(h.isSelected()){let p=o.isInRange(e)?o.truncate(e):o.extend(e,a);return{deselect:p.discard,select:p.keep,reset:!1}}else{let p=o.extend(e,a);return{select:[],deselect:p.keep,reset:!1}}else return null}else if(t&&c){let h=o.selectAll?this.beans.rowModel.getRow(0):void 0,p=o.getRoot(h),g=o.isInRange(e)?o.truncate(e):o.extend(e,a);return{select:g.keep,deselect:g.discard,reset:o.selectAll||!!(p&&!p.isSelected())}}else if(i){if(u){let h=!r;return h&&!l||!h&&!d?null:(o.setRoot(e),{node:e,newValue:h,clearSelection:!1})}return o.setRoot(e),{node:e,newValue:!r,clearSelection:!c}}else{o.setRoot(e);let h=uN(s),p=Hp(s)==="filteredDescendants",g=u&&(!h||!l);if(p&&r===void 0&&wt(s))return{node:e,newValue:!1,checkFilteredNodes:!0,clearSelection:!c||g};if(u){let f=r?!h:l;return f===r&&!g||f&&!l||!f&&!d?null:{node:e,newValue:f,clearSelection:!c||g,keepDescendants:e.group&&a}}return{node:e,newValue:!r,clearSelection:!c||g}}}},NC={TAB_GUARD:"ag-tab-guard",TAB_GUARD_TOP:"ag-tab-guard-top",TAB_GUARD_BOTTOM:"ag-tab-guard-bottom"},LG=class extends F{constructor(e){super(),this.skipTabGuardFocus=!1,this.forcingFocusOut=!1,this.allowFocus=!1;let{comp:t,eTopGuard:i,eBottomGuard:n,focusTrapActive:s,forceFocusOutWhenTabGuardsAreEmpty:o,isFocusableContainer:r,focusInnerElement:a,onFocusIn:l,onFocusOut:d,shouldStopEventPropagation:c,onTabKeyDown:u,handleKeyDown:h,isEmpty:p,eFocusableElement:g}=e;this.comp=t,this.eTopGuard=i,this.eBottomGuard=n,this.providedFocusInnerElement=a,this.eFocusableElement=g,this.focusTrapActive=!!s,this.forceFocusOutWhenTabGuardsAreEmpty=!!o,this.isFocusableContainer=!!r,this.providedFocusIn=l,this.providedFocusOut=d,this.providedShouldStopEventPropagation=c,this.providedOnTabKeyDown=u,this.providedHandleKeyDown=h,this.providedIsEmpty=p}postConstruct(){this.createManagedBean(new qa(this.eFocusableElement,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e)})),this.activateTabGuards();for(let e of[this.eTopGuard,this.eBottomGuard])this.addManagedElementListeners(e,{focus:this.onFocus.bind(this)})}handleKeyDown(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return this.providedShouldStopEventPropagation?this.providedShouldStopEventPropagation():!1}activateTabGuards(){if(this.forcingFocusOut)return;let e=this.gos.get("tabIndex");this.comp.setTabIndex(e.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(e){if(this.isFocusableContainer&&!this.eFocusableElement.contains(e.relatedTarget)&&!this.allowFocus){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.skipTabGuardFocus){this.skipTabGuardFocus=!1;return}if(this.forceFocusOutWhenTabGuardsAreEmpty&&(this.providedIsEmpty?this.providedIsEmpty():Aa(this.eFocusableElement,".ag-tab-guard").length===0)){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.isFocusableContainer&&this.eFocusableElement.contains(e.relatedTarget))return;let t=e.target===this.eBottomGuard;!(this.providedFocusInnerElement?this.providedFocusInnerElement(t):this.focusInnerElement(t))&&this.forceFocusOutWhenTabGuardsAreEmpty&&this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard)}findNextElementOutsideAndFocus(e){let t=Ht(this.beans),i=Aa(t.body,null,!0),n=i.indexOf(e?this.eTopGuard:this.eBottomGuard);if(n===-1)return;let s,o;e?(s=0,o=n):(s=n+1,o=i.length);let r=i.slice(s,o),a=this.gos.get("tabIndex");r.sort((l,d)=>{let c=Number.parseInt(l.getAttribute("tabindex")||"0"),u=Number.parseInt(d.getAttribute("tabindex")||"0");return u===a?1:c===a?-1:c===0?1:u===0?-1:c-u}),r[e?r.length-1:0]?.focus()}onFocusIn(e){this.focusTrapActive||this.forcingFocusOut||(this.providedFocusIn&&this.providedFocusIn(e),this.isFocusableContainer||this.deactivateTabGuards())}onFocusOut(e){this.focusTrapActive||(this.providedFocusOut&&this.providedFocusOut(e),this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards())}onTabKeyDown(e){if(this.providedOnTabKeyDown){this.providedOnTabKeyDown(e);return}if(this.focusTrapActive||e.defaultPrevented)return;let t=this.tabGuardsAreActive();t&&this.deactivateTabGuards();let i=this.getNextFocusableElement(e.shiftKey);t&&setTimeout(()=>this.activateTabGuards(),0),i&&(i.focus(),e.preventDefault())}focusInnerElement(e=!1){let t=Aa(this.eFocusableElement);return this.tabGuardsAreActive()&&(t.splice(0,1),t.splice(t.length-1,1)),t.length?(t[e?t.length-1:0].focus({preventScroll:!0}),!0):!1}getNextFocusableElement(e){return pr(this.beans,this.eFocusableElement,!1,e)}forceFocusOutOfContainer(e=!1){if(this.forcingFocusOut)return;let t=e?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,this.forcingFocusOut=!0,t.focus(),window.setTimeout(()=>{this.forcingFocusOut=!1,this.activateTabGuards()})}isTabGuard(e,t){return e===this.eTopGuard&&!t||e===this.eBottomGuard&&(t??!0)}setAllowFocus(e){this.allowFocus=e}},OG=class extends F{constructor(e){super(),this.comp=e}initialiseTabGuard(e){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.comp.getFocusableElement();let{eTopGuard:t,eBottomGuard:i,eFocusableElement:n}=this,s=[t,i],o={setTabIndex:m=>{for(let C of s)m!=null?C.setAttribute("tabindex",m):C.removeAttribute("tabindex")}};this.addTabGuards(t,i);let{focusTrapActive:r=!1,onFocusIn:a,onFocusOut:l,focusInnerElement:d,handleKeyDown:c,onTabKeyDown:u,shouldStopEventPropagation:h,isEmpty:p,forceFocusOutWhenTabGuardsAreEmpty:g,isFocusableContainer:f}=e;this.tabGuardCtrl=this.createManagedBean(new LG({comp:o,focusTrapActive:r,eTopGuard:t,eBottomGuard:i,eFocusableElement:n,onFocusIn:a,onFocusOut:l,focusInnerElement:d,handleKeyDown:c,onTabKeyDown:u,shouldStopEventPropagation:h,isEmpty:p,forceFocusOutWhenTabGuardsAreEmpty:g,isFocusableContainer:f}))}getTabGuardCtrl(){return this.tabGuardCtrl}createTabGuard(e){let t=Ht(this.beans).createElement("div"),i=e==="top"?NC.TAB_GUARD_TOP:NC.TAB_GUARD_BOTTOM;return t.classList.add(NC.TAB_GUARD,i),oo(t,"presentation"),t}addTabGuards(e,t){let i=this.eFocusableElement;i.insertAdjacentElement("afterbegin",e),i.insertAdjacentElement("beforeend",t)}removeAllChildrenExceptTabGuards(){let e=[this.eTopGuard,this.eBottomGuard];$t(this.comp.getFocusableElement()),this.addTabGuards(...e)}forceFocusOutOfContainer(e=!1){this.tabGuardCtrl.forceFocusOutOfContainer(e)}appendChild(e,t,i){Nv(t)||(t=t.getGui());let{eBottomGuard:n}=this;n?n.insertAdjacentElement("beforebegin",t):e(t,i)}destroy(){let{eTopGuard:e,eBottomGuard:t}=this;yi(e),yi(t),super.destroy()}},SM=class extends Be{initialiseTabGuard(e){this.tabGuardFeature=this.createManagedBean(new OG(this)),this.tabGuardFeature.initialiseTabGuard(e)}forceFocusOutOfContainer(e=!1){this.tabGuardFeature.forceFocusOutOfContainer(e)}appendChild(e,t){this.tabGuardFeature.appendChild(super.appendChild.bind(this),e,t)}},NG=500,BG=550,fp,HG=e=>{if(!fp)fp=new WeakSet;else if(fp.has(e))return!1;return fp.add(e),!0},Jo=class{constructor(e,t=!1){this.eElement=e,this.preventClick=t,this.startListener=null,this.handlers=[],this.eventSvc=void 0,this.touchStart=null,this.lastTapTime=null,this.longPressTimer=0,this.moved=!1}addEventListener(e,t){let i=this.eventSvc;if(!i){if(i===null)return;this.eventSvc=i=new rr;let n=this.onTouchStart.bind(this);this.startListener=n,this.eElement.addEventListener("touchstart",n,{passive:!0})}i.addEventListener(e,t)}removeEventListener(e,t){this.eventSvc?.removeEventListener(e,t)}onTouchStart(e){if(this.touchStart||!HG(e))return;let t=e.touches[0];this.touchStart=t;let i=this.handlers;if(!i.length){let n=this.eElement,s=n.ownerDocument,o=this.onTouchMove.bind(this),r=this.onTouchEnd.bind(this),a=this.onTouchCancel.bind(this),l={passive:!0},d={passive:!1};wp(i,[n,"touchmove",o,l],[s,"touchcancel",a,l],[s,"touchend",r,d],[s,"contextmenu",io,d])}this.clearLongPress(),this.longPressTimer=window.setTimeout(()=>{this.longPressTimer=0,this.touchStart===t&&!this.moved&&(this.moved=!0,this.eventSvc?.dispatchEvent({type:"longTap",touchStart:t,touchEvent:e}))},BG)}onTouchMove(e){let{moved:t,touchStart:i}=this;if(!t&&i){let n=Sd(i,e.touches);n&&!q6(n,i,4)&&(this.clearLongPress(),this.moved=!0)}}onTouchEnd(e){let t=this.touchStart;!t||!Sd(t,e.changedTouches)||(this.moved||(this.eventSvc?.dispatchEvent({type:"tap",touchStart:t}),this.checkDoubleTap(t)),this.preventClick&&io(e),this.cancel())}onTouchCancel(e){let t=this.touchStart;!t||!Sd(t,e.changedTouches)||(this.lastTapTime=null,this.cancel())}checkDoubleTap(e){let t=Date.now(),i=this.lastTapTime;i&&t-i>NG&&(this.eventSvc?.dispatchEvent({type:"doubleTap",touchStart:e}),t=null),this.lastTapTime=t}cancel(){this.clearLongPress(),Bv(this.handlers),this.touchStart=null}clearLongPress(){window.clearTimeout(this.longPressTimer),this.longPressTimer=0,this.moved=!1}destroy(){let e=this.startListener;e&&(this.startListener=null,this.eElement.removeEventListener("touchstart",e)),this.cancel(),this.eElement=null,this.eventSvc=null}};var VG=class{constructor(e){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=e.scrollContainer,this.scrollHorizontally=e.scrollAxis.includes("x"),this.scrollVertically=e.scrollAxis.includes("y"),this.scrollByTick=e.scrollByTick!=null?e.scrollByTick:20,e.onScrollCallback&&(this.onScrollCallback=e.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=e.getVerticalPosition,this.setVerticalPosition=e.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=e.getHorizontalPosition,this.setHorizontalPosition=e.setHorizontalPosition),this.shouldSkipVerticalScroll=e.shouldSkipVerticalScroll||(()=>!1),this.shouldSkipHorizontalScroll=e.shouldSkipHorizontalScroll||(()=>!1)}get scrolling(){return this.tickingInterval!==null}check(e,t=!1){let i=t||this.shouldSkipVerticalScroll();if(i&&this.shouldSkipHorizontalScroll())return;let n=this.scrollContainer.getBoundingClientRect(),s=this.scrollByTick;this.tickLeft=e.clientX<n.left+s,this.tickRight=e.clientX>n.right-s,this.tickUp=e.clientY<n.top+s&&!i,this.tickDown=e.clientY>n.bottom-s&&!i,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}ensureTickingStarted(){this.tickingInterval===null&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)}doTick(){this.tickCount++;let e=this.tickCount>20?200:this.tickCount>10?80:40;if(this.scrollVertically){let t=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(t-e),this.tickDown&&this.setVerticalPosition(t+e)}if(this.scrollHorizontally){let t=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(t-e),this.tickRight&&this.setHorizontalPosition(t+e)}this.onScrollCallback&&this.onScrollCallback()}ensureCleared(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)}},cw=class{constructor(e="javascript"){this.frameworkName=e,this.renderingEngine="vanilla",this.batchFrameworkComps=!1,this.wrapIncoming=t=>t(),this.wrapOutgoing=t=>t(),this.baseDocLink=`${K6}/${this.frameworkName}-data-grid`,QO(this.baseDocLink)}frameworkComponent(e){return null}isFrameworkComponent(e){return!1}getDocLink(e){return this.baseDocLink+(e?"/"+e:"")}};function GG(e){return{beanName:"gridApi",bean:e.getBean("apiFunctionSvc").api}}var zG=["licenseManager","environment","eventSvc","gos","paginationAutoPageSizeSvc","apiFunctionSvc","gridApi","registry","agCompUtils","userCompFactory","rowContainerHeight","horizontalResizeSvc","localeSvc","pinnedRowModel","dragSvc","colGroupSvc","visibleCols","popupSvc","selectionSvc","colFilter","quickFilter","filterManager","colModel","headerNavigation","pageBounds","pagination","pageBoundsListener","rowSpanSvc","stickyRowSvc","rowRenderer","expressionSvc","alignedGridsSvc","navigation","valueCache","valueSvc","autoWidthCalc","filterMenuFactory","dragAndDrop","focusSvc","cellNavigation","cellStyles","scrollVisibleSvc","sortSvc","colHover","colAnimation","autoColSvc","selectionColSvc","changeDetectionSvc","animationFrameSvc","undoRedo","colDefFactory","rowStyleSvc","rowNodeBlockLoader","rowNodeSorter","ctrlsSvc","pinnedCols","dataTypeSvc","syncSvc","overlays","stateSvc","expansionSvc","apiEventSvc","ariaAnnounce","menuSvc","colMoves","colAutosize","colFlex","colResize","pivotColsSvc","valueColsSvc","rowGroupColsSvc","colNames","colViewport","pivotResultCols","showRowGroupCols","validation"],$R=Object.fromEntries(zG.map((e,t)=>[e,t]));function WG(e,t){let i=(e.beanName?$R[e.beanName]:void 0)??Number.MAX_SAFE_INTEGER,n=(t.beanName?$R[t.beanName]:void 0)??Number.MAX_SAFE_INTEGER;return i-n}function UG(e,t){return e?.beanName==="gridDestroySvc"?-1:t?.beanName==="gridDestroySvc"?1:0}var qG={tag:"div",cls:"ag-pinned-left-header",role:"rowgroup"},$G={tag:"div",cls:"ag-pinned-right-header",role:"rowgroup"},jG={tag:"div",cls:"ag-header-viewport",role:"rowgroup",attrs:{tabindex:"-1"},children:[{tag:"div",ref:"eCenterContainer",cls:"ag-header-container",role:"presentation"}]},BC=class extends Be{constructor(e){super(),this.eCenterContainer=U,this.headerRowComps={},this.rowCompsList=[],this.pinned=e}postConstruct(){this.selectAndSetTemplate();let e={setDisplayed:i=>this.setDisplayed(i),setCtrls:i=>this.setCtrls(i),setCenterWidth:i=>this.eCenterContainer.style.width=i,setViewportScrollLeft:i=>this.getGui().scrollLeft=i,setPinnedContainerWidth:i=>{let n=this.getGui();n.style.width=i,n.style.maxWidth=i,n.style.minWidth=i}};this.createManagedBean(new dG(this.pinned)).setComp(e,this.getGui())}selectAndSetTemplate(){let e=this.pinned=="left",t=this.pinned=="right",i=e?qG:t?$G:jG;this.setTemplate(i),this.eRowContainer=this.eCenterContainer!==U?this.eCenterContainer:this.getGui()}destroy(){this.setCtrls([]),super.destroy()}destroyRowComp(e){this.destroyBean(e),e.getGui().remove()}setCtrls(e){let t=this.headerRowComps;this.headerRowComps={},this.rowCompsList=[];let i,n=s=>{let o=s.getGui();o.parentElement!=this.eRowContainer&&this.eRowContainer.appendChild(o),i&&V6(this.eRowContainer,o,i),i=o};for(let s of e){let o=s.instanceId,r=t[o];delete t[o];let a=r||this.createBean(new oG(s));this.headerRowComps[o]=a,this.rowCompsList.push(a),n(a)}for(let s of Object.values(t))this.destroyRowComp(s)}},KG={tag:"div",cls:"ag-header",role:"presentation"},YG=class extends Be{constructor(){super(KG)}postConstruct(){let e={toggleCss:(n,s)=>this.toggleCss(n,s),setHeightAndMinHeight:n=>{this.getGui().style.height=n,this.getGui().style.minHeight=n}};this.createManagedBean(new QV).setComp(e,this.getGui(),this.getFocusableElement());let i=n=>{this.createManagedBean(n),this.appendChild(n)};i(new BC("left")),i(new BC(null)),i(new BC("right"))}},XG={selector:"AG-HEADER-ROOT",component:YG},JG=class extends Be{constructor(e,t,i,n,s){super(),this.cellCtrl=t,this.rendererVersion=0,this.editorVersion=0,this.beans=e,this.gos=e.gos,this.column=t.column,this.rowNode=t.rowNode,this.eRow=n;let o=bt({tag:"div",role:t.getCellAriaRole(),attrs:{"comp-id":`${this.getCompId()}`,"col-id":t.column.colIdSanitised}});this.eCell=o;let r;t.isCellSpanning()?(r=bt({tag:"div",cls:"ag-spanned-cell-wrapper",role:"presentation"}),r.appendChild(o),this.setTemplateFromElement(r)):this.setTemplateFromElement(o),this.cellCssManager=new k4(()=>o),this.forceWrapper=t.isForceWrapper(),this.refreshWrapper(!1);let a={toggleCss:(l,d)=>this.cellCssManager.toggleCss(l,d),setUserStyles:l=>zd(o,l),getFocusableElement:()=>o,setIncludeSelection:l=>this.includeSelection=l,setIncludeRowDrag:l=>this.includeRowDrag=l,setIncludeDndSource:l=>this.includeDndSource=l,setRenderDetails:(l,d,c)=>this.setRenderDetails(l,d,c),setEditDetails:(l,d,c)=>this.setEditDetails(l,d,c),getCellEditor:()=>this.cellEditor||null,getCellRenderer:()=>this.cellRenderer||null,getParentOfValue:()=>this.getParentOfValue(),refreshEditStyles:(l,d)=>this.refreshEditStyles(l,d)};t.setComp(a,o,r,this.eCellWrapper,i,s,void 0)}getParentOfValue(){return this.eCellValue??this.eCellWrapper??this.eCell}setRenderDetails(e,t,i){if(this.cellEditor&&!this.cellEditorPopupWrapper)return;this.firstRender=this.firstRender==null;let s=this.refreshWrapper(!1);this.refreshEditStyles(!1),e?!(i||s)&&this.refreshCellRenderer(e)||(this.destroyRenderer(),this.createCellRendererInstance(e)):(this.destroyRenderer(),this.insertValueWithoutCellRenderer(t)),this.rowDraggingComp?.refreshVisibility()}setEditDetails(e,t,i){e?this.createCellEditorInstance(e,t,i):this.destroyEditor()}removeControls(){let e=this.beans.context;this.checkboxSelectionComp=e.destroyBean(this.checkboxSelectionComp),this.dndSourceComp=e.destroyBean(this.dndSourceComp),this.rowDraggingComp=e.destroyBean(this.rowDraggingComp)}refreshWrapper(e){let t=this.includeRowDrag||this.includeDndSource||this.includeSelection,i=t||this.forceWrapper,n=i&&this.eCellWrapper==null;n&&(this.eCellWrapper=bt({tag:"div",cls:"ag-cell-wrapper",role:"presentation"}),this.eCell.appendChild(this.eCellWrapper));let s=!i&&this.eCellWrapper!=null;s&&(yi(this.eCellWrapper),this.eCellWrapper=void 0),this.cellCssManager.toggleCss("ag-cell-value",!i);let o=!e&&i,r=o&&this.eCellValue==null;if(r){let d=this.cellCtrl.getCellValueClass();this.eCellValue=bt({tag:"span",cls:d,role:"presentation"}),this.eCellWrapper.appendChild(this.eCellValue)}let a=!o&&this.eCellValue!=null;a&&(yi(this.eCellValue),this.eCellValue=void 0);let l=n||s||r||a;return l&&this.removeControls(),!e&&t&&this.addControls(),l}addControls(){let{cellCtrl:e,eCellWrapper:t,eCellValue:i,includeRowDrag:n,includeDndSource:s,includeSelection:o}=this,r=a=>{a&&t.insertBefore(a.getGui(),i)};n&&this.rowDraggingComp==null&&(this.rowDraggingComp=e.createRowDragComp(),r(this.rowDraggingComp)),s&&this.dndSourceComp==null&&(this.dndSourceComp=e.createDndSource(),r(this.dndSourceComp)),o&&this.checkboxSelectionComp==null&&(this.checkboxSelectionComp=e.createSelectionCheckbox(),r(this.checkboxSelectionComp))}createCellEditorInstance(e,t,i){let n=this.editorVersion,s=e.newAgStackInstance(),{params:o}=e;s.then(a=>this.afterCellEditorCreated(n,a,o,t,i)),tt(this.cellEditor)&&o.cellStartedEdit&&this.cellCtrl.focusCell(!0)}insertValueWithoutCellRenderer(e){let t=this.getParentOfValue();$t(t);let i=Wa(e);i!=null&&(t.textContent=i)}destroyRenderer(){let{context:e}=this.beans;this.cellRenderer=e.destroyBean(this.cellRenderer),yi(this.cellRendererGui),this.cellRendererGui=null,this.rendererVersion++}destroyEditor(){let{context:e}=this.beans;(this.cellEditorPopupWrapper?.getGui().contains(ot(this.beans))||this.cellCtrl.hasBrowserFocus())&&this.eCell.focus({preventScroll:!0}),this.hideEditorPopup?.(),this.hideEditorPopup=void 0,this.cellEditor=e.destroyBean(this.cellEditor),this.cellEditorPopupWrapper=e.destroyBean(this.cellEditorPopupWrapper),yi(this.cellEditorGui),this.cellCtrl.disableEditorTooltipFeature(),this.cellEditorGui=null,this.editorVersion++}refreshCellRenderer(e){if(this.cellRenderer?.refresh==null||this.cellRendererClass!==e.componentClass)return!1;let t=this.cellRenderer.refresh(e.params);return t===!0||t===void 0}createCellRendererInstance(e){let t=this.rendererVersion,i=o=>r=>{if(this.rendererVersion!==t||!this.isAlive())return;let l=o.newAgStackInstance(),d=this.afterCellRendererCreated.bind(this,t,o.componentClass);l?.then(d)},{animationFrameSvc:n}=this.beans,s;if(n?.active&&this.firstRender?s=(o,r=!1)=>{n.createTask(i(o),this.rowNode.rowIndex,"p2",o.componentFromFramework,r)}:s=o=>i(o)(),e.params?.deferRender&&!this.cellCtrl.rowNode.group){let{loadingComp:o,onReady:r}=this.cellCtrl.getDeferLoadingCellRenderer();o&&(s(o),r.then(()=>s(e,!0)))}else s(e)}afterCellRendererCreated(e,t,i){if(!this.isAlive()||e!==this.rendererVersion){this.beans.context.destroyBean(i);return}this.cellRenderer=i,this.cellRendererClass=t;let s=i.getGui();if(this.cellRendererGui=s,s!=null){let o=this.getParentOfValue();$t(o),o.appendChild(s)}}afterCellEditorCreated(e,t,i,n,s){let o=e!==this.editorVersion,{context:r}=this.beans;if(o){r.destroyBean(t);return}if(t.isCancelBeforeStart?.()){r.destroyBean(t),this.cellCtrl.stopEditing(!0);return}if(!t.getGui){I(97,{colId:this.column.getId()}),r.destroyBean(t);return}this.cellEditor=t,this.cellEditorGui=t.getGui();let l=n||t.isPopup?.();l?this.addPopupCellEditor(i,s):this.addInCellEditor(),this.refreshEditStyles(!0,l),t.afterGuiAttached?.(),this.cellCtrl.enableEditorTooltipFeature(t),this.cellCtrl.cellEditorAttached()}refreshEditStyles(e,t){let{cellCssManager:i}=this;i.toggleCss("ag-cell-inline-editing",e&&!t),i.toggleCss("ag-cell-popup-editing",e&&!!t),i.toggleCss("ag-cell-not-inline-editing",!e||!!t)}addInCellEditor(){let{eCell:e}=this;e.contains(ot(this.beans))&&e.focus(),this.destroyRenderer(),this.refreshWrapper(!0),$t(this.getParentOfValue()),this.cellEditorGui&&this.getParentOfValue().appendChild(this.cellEditorGui)}addPopupCellEditor(e,t){let{gos:i,context:n,popupSvc:s,editSvc:o}=this.beans;i.get("editType")==="fullRow"&&I(98);let r=this.cellEditorPopupWrapper=n.createBean(o.createPopupEditorWrapper(e)),{cellEditor:a,cellEditorGui:l,eCell:d,rowNode:c,column:u,cellCtrl:h}=this,p=r.getGui();l&&p.appendChild(l);let g=i.get("stopEditingWhenCellsLoseFocus"),f=t??a.getPopupPosition?.()??"over",m=i.get("enableRtl"),C={ePopup:p,column:u,rowNode:c,type:"popupCellEditor",eventSource:d,position:f,alignSide:m?"right":"left",keepWithinBounds:!0},v=s.positionPopupByComponent.bind(s,C),w=s.addPopup({modal:g,eChild:p,closeOnEsc:!0,closedCallback:()=>{h.onPopupEditorClosed()},anchorToElement:d,positionCallback:v,ariaOwns:d});w&&(this.hideEditorPopup=w.hideFunc)}detach(){this.getGui().remove()}destroy(){this.destroyRenderer(),this.destroyEditor(),this.removeControls(),super.destroy()}},QG=class extends Be{constructor(e,t,i){super(),this.cellComps=new Map,this.beans=t,this.rowCtrl=e;let n=bt({tag:"div",role:"row",attrs:{"comp-id":`${this.getCompId()}`}});this.setInitialStyle(n,i),this.setTemplateFromElement(n);let s=n.style;this.domOrder=this.rowCtrl.getDomOrder();let o={setDomOrder:r=>this.domOrder=r,setCellCtrls:r=>this.setCellCtrls(r),showFullWidth:r=>this.showFullWidth(r),getFullWidthCellRenderer:()=>this.fullWidthCellRenderer,getFullWidthCellRendererParams:()=>this.fullWidthCellRendererParams,toggleCss:(r,a)=>this.toggleCss(r,a),setUserStyles:r=>zd(n,r),setTop:r=>s.top=r,setTransform:r=>s.transform=r,setRowIndex:r=>n.setAttribute("row-index",r),setRowId:r=>n.setAttribute("row-id",r),setRowBusinessKey:r=>n.setAttribute("row-business-key",r),refreshFullWidth:r=>{let a=r();return this.fullWidthCellRendererParams=a,this.fullWidthCellRenderer?.refresh?.(a)??!1}};e.setComp(o,this.getGui(),i,void 0),this.addDestroyFunc(()=>{e.unsetComp(i)})}setInitialStyle(e,t){let i=this.rowCtrl.getInitialTransform(t);if(i)e.style.setProperty("transform",i);else{let n=this.rowCtrl.getInitialRowTop(t);n&&e.style.setProperty("top",n)}}showFullWidth(e){let t=n=>{if(this.isAlive()){let s=n.getGui();this.getGui().appendChild(s),this.rowCtrl.setupDetailRowAutoHeight(s),this.setFullWidthRowComp(n,e.params)}else this.beans.context.destroyBean(n)};e.newAgStackInstance().then(t)}setCellCtrls(e){let t=new Map(this.cellComps);for(let i of e){let n=i.instanceId;this.cellComps.has(n)?t.delete(n):this.newCellComp(i)}this.destroyCells(t),this.ensureDomOrder(e)}ensureDomOrder(e){if(!this.domOrder)return;let t=[];for(let i of e){let n=this.cellComps.get(i.instanceId);n&&t.push(n.getGui())}G6(this.getGui(),t)}newCellComp(e){let t=this.beans.editSvc?.isEditing(e,{withOpenEditor:!0})??!1,i=new JG(this.beans,e,this.rowCtrl.printLayout,this.getGui(),t);this.cellComps.set(e.instanceId,i),this.getGui().appendChild(i.getGui())}destroy(){super.destroy(),this.destroyCells(this.cellComps)}setFullWidthRowComp(e,t){this.fullWidthCellRenderer=e,this.fullWidthCellRendererParams=t,this.addDestroyFunc(()=>{this.fullWidthCellRenderer=this.beans.context.destroyBean(this.fullWidthCellRenderer),this.fullWidthCellRendererParams=void 0})}destroyCells(e){for(let t of e.values()){if(!t)return;let i=t.cellCtrl.instanceId;if(this.cellComps.get(i)!==t)return;t.detach(),t.destroy(),this.cellComps.delete(i)}}};function ZG(e,t,i){let n=!!i.gos.get("enableCellSpan")&&!!t.getSpannedRowCtrls,s={tag:"div",ref:"eContainer",cls:Rp(e),role:"rowgroup"};if(t.type==="center"||n){let o={tag:"div",ref:"eSpannedContainer",cls:`ag-spanning-container ${yV(e)}`,role:"presentation"};return s.role="presentation",{tag:"div",ref:"eViewport",cls:`ag-viewport ${dM(e)}`,role:"rowgroup",children:[s,n?o:null]}}return s}var ez=class extends Be{constructor(e){super(),this.eViewport=U,this.eContainer=U,this.eSpannedContainer=U,this.rowCompsNoSpan={},this.rowCompsWithSpan={},this.name=e?.name,this.options=$d(this.name)}postConstruct(){this.setTemplate(ZG(this.name,this.options,this.beans));let e={setHorizontalScroll:i=>this.eViewport.scrollLeft=i,setViewportHeight:i=>this.eViewport.style.height=i,setRowCtrls:({rowCtrls:i})=>this.setRowCtrls(i),setSpannedRowCtrls:i=>this.setRowCtrls(i,!0),setDomOrder:i=>{this.domOrder=i},setContainerWidth:i=>{this.eContainer.style.width=i,this.eSpannedContainer&&(this.eSpannedContainer.style.width=i)},setOffsetTop:i=>{let n=`translateY(${i})`;this.eContainer.style.transform=n,this.eSpannedContainer&&(this.eSpannedContainer.style.transform=n)}};this.createManagedBean(new TV(this.name)).setComp(e,this.eContainer,this.eSpannedContainer,this.eViewport)}destroy(){this.setRowCtrls([]),this.setRowCtrls([],!0),super.destroy(),this.lastPlacedElement=null}setRowCtrls(e,t){let{beans:i,options:n}=this,s=t?this.eSpannedContainer:this.eContainer,o=t?b({},this.rowCompsWithSpan):b({},this.rowCompsNoSpan),r={};t?this.rowCompsWithSpan=r:this.rowCompsNoSpan=r,this.lastPlacedElement=null;let a=[];for(let l of e){let d=l.instanceId,c=o[d],u;if(c)u=c,delete o[d];else{if(!l.rowNode.displayed)continue;u=new QG(l,i,n.type)}r[d]=u,a.push([u,!c])}this.removeOldRows(Object.values(o)),this.addRowNodes(a,s)}addRowNodes(e,t){let{domOrder:i}=this;for(let[n,s]of e){let o=n.getGui();i?this.ensureDomOrder(o,t):s&&t.appendChild(o)}}removeOldRows(e){for(let t of e)t.getGui().remove(),t.destroy()}ensureDomOrder(e,t){V6(t,e,this.lastPlacedElement),this.lastPlacedElement=e}},tz={selector:"AG-ROW-CONTAINER",component:ez};function pd(e,t){return t.map(i=>{let n=`e${i[0].toUpperCase()+i.substring(1)}RowContainer`;return e[n]={name:i},{tag:"ag-row-container",ref:n,attrs:{name:i}}})}function iz(e){let t={},i={tag:"div",ref:"eGridRoot",cls:"ag-root ag-unselectable",children:[{tag:"ag-header-root"},{tag:"div",ref:"eTop",cls:"ag-floating-top",role:"presentation",children:pd(t,["topLeft","topCenter","topRight","topFullWidth"])},{tag:"div",ref:"eBody",cls:"ag-body",role:"presentation",children:[{tag:"div",ref:"eBodyViewport",cls:"ag-body-viewport",role:"presentation",children:pd(t,["left","center","right","fullWidth"])},{tag:"ag-fake-vertical-scroll"}]},{tag:"div",ref:"eStickyTop",cls:"ag-sticky-top",role:"presentation",children:pd(t,["stickyTopLeft","stickyTopCenter","stickyTopRight","stickyTopFullWidth"])},{tag:"div",ref:"eStickyBottom",cls:"ag-sticky-bottom",role:"presentation",children:pd(t,["stickyBottomLeft","stickyBottomCenter","stickyBottomRight","stickyBottomFullWidth"])},{tag:"div",ref:"eBottom",cls:"ag-floating-bottom",role:"presentation",children:pd(t,["bottomLeft","bottomCenter","bottomRight","bottomFullWidth"])},{tag:"ag-fake-horizontal-scroll"},e?{tag:"ag-overlay-wrapper"}:null]};return{paramsMap:t,elementParams:i}}var nz=class extends Be{constructor(){super(...arguments),this.eGridRoot=U,this.eBodyViewport=U,this.eStickyTop=U,this.eStickyBottom=U,this.eTop=U,this.eBottom=U,this.eBody=U}postConstruct(){let{overlays:e,rangeSvc:t}=this.beans,i=e?.getOverlayWrapperSelector(),{paramsMap:n,elementParams:s}=iz(!!i);this.setTemplate(s,[...i?[i]:[],BV,GV,XG,tz],n);let o=(a,l)=>{let d=`${a}px`;l.style.minHeight=d,l.style.height=d},r={setRowAnimationCssOnBodyViewport:(a,l)=>this.setRowAnimationCssOnBodyViewport(a,l),setColumnCount:a=>gO(this.getGui(),a),setRowCount:a=>hO(this.getGui(),a),setTopHeight:a=>o(a,this.eTop),setBottomHeight:a=>o(a,this.eBottom),setTopInvisible:a=>this.eTop.classList.toggle("ag-invisible",a),setBottomInvisible:a=>this.eBottom.classList.toggle("ag-invisible",a),setStickyTopHeight:a=>this.eStickyTop.style.height=a,setStickyTopTop:a=>this.eStickyTop.style.top=a,setStickyTopWidth:a=>this.eStickyTop.style.width=a,setStickyBottomHeight:a=>{this.eStickyBottom.style.height=a,this.eStickyBottom.classList.toggle("ag-invisible",a==="0px")},setStickyBottomBottom:a=>this.eStickyBottom.style.bottom=a,setStickyBottomWidth:a=>this.eStickyBottom.style.width=a,setColumnMovingCss:(a,l)=>this.toggleCss(a,l),updateLayoutClasses:(a,l)=>{let d=[this.eBodyViewport.classList,this.eBody.classList];for(let c of d)c.toggle(on.AUTO_HEIGHT,l.autoHeight),c.toggle(on.NORMAL,l.normal),c.toggle(on.PRINT,l.print);this.toggleCss(on.AUTO_HEIGHT,l.autoHeight),this.toggleCss(on.NORMAL,l.normal),this.toggleCss(on.PRINT,l.print)},setAlwaysVerticalScrollClass:(a,l)=>this.eBodyViewport.classList.toggle(hM,l),registerBodyViewportResizeListener:a=>{let l=uo(this.beans,this.eBodyViewport,a);this.addDestroyFunc(()=>l())},setPinnedTopBottomOverflowY:a=>this.eTop.style.overflowY=this.eBottom.style.overflowY=a,setCellSelectableCss:(a,l)=>{for(let d of[this.eTop,this.eBodyViewport,this.eBottom])d.classList.toggle(a,l)},setBodyViewportWidth:a=>this.eBodyViewport.style.width=a,setGridRootRole:a=>oo(this.eGridRoot,a)};this.ctrl=this.createManagedBean(new _V),this.ctrl.setComp(r,this.getGui(),this.eBodyViewport,this.eTop,this.eBottom,this.eStickyTop,this.eStickyBottom),(t&&Ds(this.gos)||Ld(this.gos))&&uO(this.getGui(),!0)}setRowAnimationCssOnBodyViewport(e,t){let i=this.eBodyViewport.classList;i.toggle("ag-row-animation",t),i.toggle("ag-row-no-animation",!t)}},sz={selector:"AG-GRID-BODY",component:nz},oz=class extends F{constructor(){super(...arguments),this.additionalFocusableContainers=new Set}setComp(e,t,i){this.view=e,this.eGridHostDiv=t,this.eGui=i,this.eGui.setAttribute("grid-id",this.beans.context.getId());let{dragAndDrop:n,ctrlsSvc:s}=this.beans;n?.registerGridDropTarget(()=>this.eGui,this),this.createManagedBean(new iw(this.view)),this.view.setRtlClass(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr");let o=uo(this.beans,this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc(()=>o()),s.register("gridCtrl",this)}isDetailGrid(){return B4(this.getGui())?.getAttribute("row-id")?.startsWith("detail")||!1}getOptionalSelectors(){let e=this.beans;return{paginationSelector:e.pagination?.getPaginationSelector(),gridHeaderDropZonesSelector:e.registry?.getSelector("AG-GRID-HEADER-DROP-ZONES"),sideBarSelector:e.sideBar?.getSelector(),statusBarSelector:e.registry?.getSelector("AG-STATUS-BAR"),watermarkSelector:e.licenseManager?.getWatermarkSelector()}}onGridSizeChanged(){this.eventSvc.dispatchEvent({type:"gridSizeChanged",clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight})}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(e){let{view:t}=this;if(e===!1)t.setCursor(null);else{let i=e===1?"ew-resize":"ns-resize";t.setCursor(i)}}disableUserSelect(e){this.view.setUserSelect(e?"none":null)}focusNextInnerContainer(e){let t=this.getFocusableContainers(),{indexWithFocus:i,nextIndex:n}=this.getNextFocusableIndex(t,e);if(n<0||n>=t.length)return!1;if(n===0){if(i>0){let{visibleCols:s,focusSvc:o}=this.beans,r=s.allCols,a=je(r);if(o.focusGridView({column:a,backwards:!0}))return!0}return!1}return this.focusContainer(t[n],e)}focusInnerElement(e){if(this.gos.getCallback("focusGridInnerElement")?.({fromBottom:!!e}))return!0;let i=this.getFocusableContainers(),{focusSvc:n,visibleCols:s}=this.beans,o=s.allCols;if(e){if(i.length>1)return this.focusContainer(je(i),e);let r=je(o);if(n.focusGridView({column:r,backwards:e}))return!0}if(this.gos.get("headerHeight")===0||sr(this.beans)){if(n.focusGridView({column:o[0],backwards:e}))return!0;for(let r=1;r<i.length;r++)if(lr(i[r].getGui(),e))return!0;return!1}return n.focusFirstHeader()}forceFocusOutOfContainer(e=!1){this.view.forceFocusOutOfContainer(e)}addFocusableContainer(e){this.additionalFocusableContainers.add(e)}removeFocusableContainer(e){this.additionalFocusableContainers.delete(e)}allowFocusForNextCoreContainer(e){let t=this.view.getFocusableContainers(),{nextIndex:i,indexWithFocus:n}=this.getNextFocusableIndex(t,e);if(n===-1||i<0||i>=t.length)return;let s=t[i];s.setAllowFocus?.(!0),setTimeout(()=>{s.setAllowFocus?.(!1)})}isFocusable(){let e=this.beans;return!sg(e)||!sr(e)||!!e.sideBar?.comp?.isDisplayed()}getNextFocusableIndex(e,t){let i=ot(this.beans),n=e.findIndex(o=>o.getGui().contains(i)),s=n+(t?-1:1);return{indexWithFocus:n,nextIndex:s}}focusContainer(e,t){e.setAllowFocus?.(!0);let i=lr(e.getGui(),t,!1,!0);return e.setAllowFocus?.(!1),i}getFocusableContainers(){return[...this.view.getFocusableContainers(),...this.additionalFocusableContainers]}destroy(){this.additionalFocusableContainers.clear(),super.destroy()}},rz=class extends SM{constructor(e){super(),this.gridBody=U,this.sideBar=U,this.pagination=U,this.rootWrapperBody=U,this.eGridDiv=e}postConstruct(){let e={destroyGridUi:()=>this.destroyBean(this),setRtlClass:o=>this.addCss(o),forceFocusOutOfContainer:this.forceFocusOutOfContainer.bind(this),updateLayoutClasses:this.updateLayoutClasses.bind(this),getFocusableContainers:this.getFocusableContainers.bind(this),setUserSelect:o=>{this.getGui().style.userSelect=o??"",this.getGui().style.webkitUserSelect=o??""},setCursor:o=>{this.getGui().style.cursor=o??""}},t=this.createManagedBean(new oz),i=t.getOptionalSelectors(),n=this.createTemplate(i),s=[sz,...Object.values(i).filter(o=>!!o)];this.setTemplate(n,s),t.setComp(e,this.eGridDiv,this.getGui()),this.insertGridIntoDom(),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:o=>t.focusInnerElement(o),forceFocusOutWhenTabGuardsAreEmpty:!0,isEmpty:()=>!t.isFocusable()})}insertGridIntoDom(){let e=this.getGui();this.eGridDiv.appendChild(e),this.addDestroyFunc(()=>{e.remove(),ro(this.gos,"Grid removed from DOM")})}updateLayoutClasses(e,t){let i=this.rootWrapperBody.classList,{AUTO_HEIGHT:n,NORMAL:s,PRINT:o}=on,{autoHeight:r,normal:a,print:l}=t;i.toggle(n,r),i.toggle(s,a),i.toggle(o,l),this.toggleCss(n,r),this.toggleCss(s,a),this.toggleCss(o,l)}createTemplate(e){let t=e.gridHeaderDropZonesSelector?{tag:"ag-grid-header-drop-zones"}:null,i=e.sideBarSelector?{tag:"ag-side-bar",ref:"sideBar"}:null,n=e.statusBarSelector?{tag:"ag-status-bar"}:null,s=e.watermarkSelector?{tag:"ag-watermark"}:null,o=e.paginationSelector?{tag:"ag-pagination",ref:"pagination"}:null;return{tag:"div",cls:"ag-root-wrapper",role:"presentation",children:[t,{tag:"div",ref:"rootWrapperBody",cls:"ag-root-wrapper-body",role:"presentation",children:[{tag:"ag-grid-body",ref:"gridBody"},i]},n,o,s]}}getFocusableElement(){return this.rootWrapperBody}forceFocusOutOfContainer(e=!1){if(!e&&this.pagination?.isDisplayed()){this.pagination.forceFocusOutOfContainer(e);return}super.forceFocusOutOfContainer(e)}getFocusableContainers(){let e=[this.gridBody];for(let t of[this.sideBar,this.pagination])t&&e.push(t);return e.filter(t=>Gn(t.getGui()))}},ue=(e,t)=>{for(let i of Object.keys(t))t[i]=e;return t},jR=b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b({dispatchEvent:"CommunityCore"},ue("CommunityCore",{destroy:0,getGridId:0,getGridOption:0,isDestroyed:0,setGridOption:0,updateGridOptions:0,isModuleRegistered:0})),ue("GridState",{getState:0,setState:0})),ue("SharedRowSelection",{setNodesSelected:0,selectAll:0,deselectAll:0,selectAllFiltered:0,deselectAllFiltered:0,selectAllOnCurrentPage:0,deselectAllOnCurrentPage:0,getSelectedNodes:0,getSelectedRows:0})),ue("RowApi",{redrawRows:0,setRowNodeExpanded:0,getRowNode:0,addRenderedRowListener:0,getRenderedNodes:0,forEachNode:0,getFirstDisplayedRowIndex:0,getLastDisplayedRowIndex:0,getDisplayedRowAtIndex:0,getDisplayedRowCount:0})),ue("ScrollApi",{getVerticalPixelRange:0,getHorizontalPixelRange:0,ensureColumnVisible:0,ensureIndexVisible:0,ensureNodeVisible:0})),ue("KeyboardNavigation",{getFocusedCell:0,clearFocusedCell:0,setFocusedCell:0,tabToNextCell:0,tabToPreviousCell:0,setFocusedHeader:0})),ue("EventApi",{addEventListener:0,addGlobalListener:0,removeEventListener:0,removeGlobalListener:0})),ue("ValueCache",{expireValueCache:0})),ue("CellApi",{getCellValue:0})),ue("SharedMenu",{showColumnMenu:0,hidePopupMenu:0})),ue("Sort",{onSortChanged:0})),ue("PinnedRow",{getPinnedTopRowCount:0,getPinnedBottomRowCount:0,getPinnedTopRow:0,getPinnedBottomRow:0,forEachPinnedRow:0})),ue("Overlay",{showLoadingOverlay:0,showNoRowsOverlay:0,hideOverlay:0})),ue("RenderApi",{setGridAriaProperty:0,refreshCells:0,refreshHeader:0,isAnimationFrameQueueEmpty:0,flushAllAnimationFrames:0,getSizesForCurrentTheme:0,getCellRendererInstances:0})),ue("HighlightChanges",{flashCells:0})),ue("RowDrag",{addRowDropZone:0,removeRowDropZone:0,getRowDropZoneParams:0,getRowDropPositionIndicator:0,setRowDropPositionIndicator:0})),ue("ColumnApi",{getColumnDefs:0,getColumnDef:0,getDisplayNameForColumn:0,getColumn:0,getColumns:0,applyColumnState:0,getColumnState:0,resetColumnState:0,isPinning:0,isPinningLeft:0,isPinningRight:0,getDisplayedColAfter:0,getDisplayedColBefore:0,setColumnsVisible:0,setColumnsPinned:0,getAllGridColumns:0,getDisplayedLeftColumns:0,getDisplayedCenterColumns:0,getDisplayedRightColumns:0,getAllDisplayedColumns:0,getAllDisplayedVirtualColumns:0})),ue("ColumnAutoSize",{sizeColumnsToFit:0,autoSizeColumns:0,autoSizeAllColumns:0})),ue("ColumnGroup",{setColumnGroupOpened:0,getColumnGroup:0,getProvidedColumnGroup:0,getDisplayNameForColumnGroup:0,getColumnGroupState:0,setColumnGroupState:0,resetColumnGroupState:0,getLeftDisplayedColumnGroups:0,getCenterDisplayedColumnGroups:0,getRightDisplayedColumnGroups:0,getAllDisplayedColumnGroups:0})),ue("ColumnMove",{moveColumnByIndex:0,moveColumns:0})),ue("ColumnResize",{setColumnWidths:0})),ue("ColumnHover",{isColumnHovered:0})),ue("EditCore",{getCellEditorInstances:0,getEditingCells:0,getEditRowValues:0,stopEditing:0,startEditingCell:0,isEditing:0,validateEdit:0})),ue("BatchEdit",{startBatchEdit:0,cancelBatchEdit:0,commitBatchEdit:0,isBatchEditing:0})),ue("UndoRedoEdit",{undoCellEditing:0,redoCellEditing:0,getCurrentUndoSize:0,getCurrentRedoSize:0})),ue("FilterCore",{isAnyFilterPresent:0,onFilterChanged:0})),ue("ColumnFilter",{isColumnFilterPresent:0,getColumnFilterInstance:0,destroyFilter:0,setFilterModel:0,getFilterModel:0,getColumnFilterModel:0,setColumnFilterModel:0,showColumnFilter:0,hideColumnFilter:0,getColumnFilterHandler:0,doFilterAction:0})),ue("QuickFilter",{isQuickFilterPresent:0,getQuickFilter:0,resetQuickFilter:0})),ue("Find",{findGetActiveMatch:0,findGetTotalMatches:0,findGoTo:0,findNext:0,findPrevious:0,findGetNumMatches:0,findGetParts:0,findClearActive:0,findRefresh:0})),ue("Pagination",{paginationIsLastPageFound:0,paginationGetPageSize:0,paginationGetCurrentPage:0,paginationGetTotalPages:0,paginationGetRowCount:0,paginationGoToNextPage:0,paginationGoToPreviousPage:0,paginationGoToFirstPage:0,paginationGoToLastPage:0,paginationGoToPage:0})),ue("CsrmSsrmSharedApi",{expandAll:0,collapseAll:0})),ue("SsrmInfiniteSharedApi",{setRowCount:0,getCacheBlockState:0,isLastRowIndexKnown:0})),ue("ClientSideRowModelApi",{onGroupExpandedOrCollapsed:0,refreshClientSideRowModel:0,isRowDataEmpty:0,forEachLeafNode:0,forEachNodeAfterFilter:0,forEachNodeAfterFilterAndSort:0,applyTransaction:0,applyTransactionAsync:0,flushAsyncTransactions:0,getBestCostNodeSelection:0,onRowHeightChanged:0,resetRowHeights:0})),ue("CsvExport",{getDataAsCsv:0,exportDataAsCsv:0})),ue("InfiniteRowModel",{refreshInfiniteCache:0,purgeInfiniteCache:0,getInfiniteRowCount:0})),ue("AdvancedFilter",{getAdvancedFilterModel:0,setAdvancedFilterModel:0,showAdvancedFilterBuilder:0,hideAdvancedFilterBuilder:0})),ue("IntegratedCharts",{getChartModels:0,getChartRef:0,getChartImageDataURL:0,downloadChart:0,openChartToolPanel:0,closeChartToolPanel:0,createRangeChart:0,createPivotChart:0,createCrossFilterChart:0,updateChart:0,restoreChart:0})),ue("Clipboard",{copyToClipboard:0,cutToClipboard:0,copySelectedRowsToClipboard:0,copySelectedRangeToClipboard:0,copySelectedRangeDown:0,pasteFromClipboard:0})),ue("ExcelExport",{getDataAsExcel:0,exportDataAsExcel:0,getSheetDataForExcel:0,getMultipleSheetsAsExcel:0,exportMultipleSheetsAsExcel:0})),ue("SharedMasterDetail",{addDetailGridInfo:0,removeDetailGridInfo:0,getDetailGridInfo:0,forEachDetailGridInfo:0})),ue("ContextMenu",{showContextMenu:0})),ue("ColumnMenu",{showColumnChooser:0,hideColumnChooser:0})),ue("CellSelection",{getCellRanges:0,addCellRange:0,clearRangeSelection:0,clearCellSelection:0})),ue("SharedRowGrouping",{setRowGroupColumns:0,removeRowGroupColumns:0,addRowGroupColumns:0,getRowGroupColumns:0,moveRowGroupColumn:0})),ue("SharedAggregation",{addAggFuncs:0,clearAggFuncs:0,setColumnAggFunc:0})),ue("SharedPivot",{isPivotMode:0,getPivotResultColumn:0,setValueColumns:0,getValueColumns:0,removeValueColumns:0,addValueColumns:0,setPivotColumns:0,removePivotColumns:0,addPivotColumns:0,getPivotColumns:0,setPivotResultColumns:0,getPivotResultColumns:0})),ue("ServerSideRowModelApi",{getServerSideSelectionState:0,setServerSideSelectionState:0,applyServerSideTransaction:0,applyServerSideTransactionAsync:0,applyServerSideRowData:0,retryServerSideLoads:0,flushServerSideAsyncTransactions:0,refreshServerSide:0,getServerSideGroupLevelState:0,onRowHeightChanged:0,resetRowHeights:0})),ue("SideBar",{isSideBarVisible:0,setSideBarVisible:0,setSideBarPosition:0,openToolPanel:0,closeToolPanel:0,getOpenedToolPanel:0,refreshToolPanel:0,isToolPanelShowing:0,getToolPanelInstance:0,getSideBar:0})),ue("StatusBar",{getStatusPanel:0})),ue("AiToolkit",{getStructuredSchema:0})),HC={isDestroyed:()=>!0,destroy(){},preConstruct(){},postConstruct(){},preWireBeans(){},wireBeans(){}},az=(e,t)=>e.eventSvc.dispatchEvent(t),xM=class{};Reflect.defineProperty(xM,"name",{value:"GridApi"});var lz=class extends F{constructor(){super(),this.beanName="apiFunctionSvc",this.api=new xM,this.fns=O(b({},HC),{dispatchEvent:az}),this.preDestroyLink="";let{api:e}=this;for(let t of Object.keys(jR))e[t]=this.makeApi(t)[t]}postConstruct(){this.preDestroyLink=this.beans.frameworkOverrides.getDocLink("grid-lifecycle/#grid-pre-destroyed")}addFunction(e,t){let{fns:i,beans:n}=this;i!==HC&&(i[e]=n?.validation?.validateApiFunction(e,t)??t)}makeApi(e){return{[e]:(...t)=>{let{beans:i,fns:{[e]:n}}=this;return n?n(i,...t):this.apiNotFound(e)}}}apiNotFound(e){let{beans:t,gos:i,preDestroyLink:n}=this;if(!t)I(26,{fnName:e,preDestroyLink:n});else{let s=jR[e];i.assertModuleRegistered(s,`api.${e}`)&&I(27,{fnName:e,module:s})}}destroy(){super.destroy(),this.fns=HC,this.beans=null}};function dz(e){return e.context.getId()}function cz(e){e.gridDestroySvc.destroy()}function uz(e){return e.gridDestroySvc.destroyCalled}function hz(e,t){return e.gos.get(t)}function pz(e,t,i){EM(e,{[t]:i})}function EM(e,t){e.gos.updateGridOptions({options:t})}function gz(e,t){let i=t.replace(/Module$/,"");return e.gos.isModuleRegistered(i)}var fz={tag:"div",cls:"ag-drag-handle ag-row-drag",attrs:{draggable:"true"}},mz=class extends Be{constructor(e,t,i){super(fz),this.rowNode=e,this.column=t,this.eCell=i}postConstruct(){this.getGui().appendChild(ji("rowDrag",this.beans,null)),this.addGuiEventListener("mousedown",t=>{t.stopPropagation()}),this.addDragSource(),this.checkVisibility()}addDragSource(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))}onDragStart(e){let{rowNode:t,column:i,eCell:n,gos:s}=this,o=i.getColDef().dndSourceOnRowDrag,r=e.dataTransfer;if(r.setDragImage(n,0,0),o){let a=ae(s,{rowNode:t,dragEvent:e});o(a)}else try{let a=JSON.stringify(t.data);r.setData("application/json",a),r.setData("text/plain",a)}catch{}}checkVisibility(){let e=this.column.isDndSource(this.rowNode);this.setDisplayed(e)}};function Cz(e,t){e.rowDragSvc?.rowDragFeature?.addRowDropZone(t)}function vz(e,t){let i=e.dragAndDrop?.findExternalZone(t.getContainer());i&&e.dragAndDrop?.removeDropTarget(i)}function wz(e,t){return e.rowDragSvc?.rowDragFeature?.getRowDropZone(t)}function bz(e){let t=e.rowDropHighlightSvc;return t?{row:t.row,dropIndicatorPosition:t.position}:{row:null,dropIndicatorPosition:"none"}}function yz(e,t){let i=e.rowDropHighlightSvc;if(!i)return;let n=t?.row,s=t?.dropIndicatorPosition;s!=="above"&&s!=="below"&&s!=="inside"&&(s="none");let o=n?.rowIndex;o==null||s==="none"?i.clear():i.set(n,s)}var Sz=class extends OH{shouldPreventMouseEvent(e){return this.gos.get("enableCellTextSelection")&&super.shouldPreventMouseEvent(e)}},xz=class extends F{constructor(){super(...arguments),this.beanName="horizontalResizeSvc"}addResizeBar(e){let t={dragStartPixels:e.dragStartPixels||0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e),onDragCancel:this.onDragStop.bind(this,e),includeTouch:!0,stopPropagationForTouch:!0},{dragSvc:i}=this.beans;return i.addDragSource(t),()=>i.removeDragSource(t)}onDragStart(e,t){this.dragStartX=t.clientX,this.setResizeIcons();let i=t instanceof MouseEvent&&t.shiftKey===!0;e.onResizeStart(i)}setResizeIcons(){let e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(1),e.disableUserSelect(!0)}onDragStop(e){e.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){let e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(!1),e.disableUserSelect(!1)}onDragging(e,t){this.resizeAmount=t.clientX-this.dragStartX,e.onResizing(this.resizeAmount)}},Ez={tag:"div",cls:"ag-drag-handle ag-row-drag",attrs:{"aria-hidden":"true"}},Rz=class extends Be{constructor(e,t,i,n,s,o=!1){super(),this.cellValueFn=e,this.rowNode=t,this.column=i,this.customGui=n,this.dragStartPixels=s,this.alwaysVisible=o,this.dragSource=null}isCustomGui(){return this.customGui!=null}postConstruct(){let{beans:e,customGui:t}=this;t?this.setDragElement(t,this.dragStartPixels):(this.setTemplate(Ez),this.getGui().appendChild(ji("rowDrag",e,null)),this.addDragSource()),this.alwaysVisible||this.initCellDrag()}initCellDrag(){let{beans:e,gos:t,rowNode:i}=this,n=this.refreshVisibility.bind(this);this.addManagedPropertyListener("suppressRowDrag",n),this.addManagedListeners(i,{dataChanged:n,cellChanged:n}),this.addManagedListeners(e.eventSvc,t.get("rowDragManaged")?{sortChanged:n,filterChanged:n,columnRowGroupChanged:n,newColumnsLoaded:n}:{newColumnsLoaded:n})}setDragElement(e,t){this.setTemplateFromElement(e,void 0,void 0,!0),this.addDragSource(t)}refreshVisibility(){if(this.alwaysVisible)return;let e={skipAriaHidden:!0};if(this.isNeverDisplayed()){this.setDisplayed(!1,e);return}let t=this.column,i=typeof t?.getColDef().rowDrag=="function",n=!t||this.isCustomGui()||t.isRowDrag(this.rowNode);n&&this.rowNode.footer&&this.gos.get("rowDragManaged")&&(n=!1,i=!0),this.setDisplayed(i||n,e),this.setVisible(n,e)}isNeverDisplayed(){let{gos:e,beans:t}=this;return!!(e.get("suppressRowDrag")||e.get("rowDragManaged")&&t.rowDragSvc.rowDragFeature?.shouldPreventRowMove()&&!t.dragAndDrop?.hasExternalDropZones())}getSelectedNodes(){let e=this.rowNode;if(!this.gos.get("rowDragMultiRow"))return[e];let i=this.beans.selectionSvc?.getSelectedNodes()??[];return i.indexOf(e)!==-1?i:[e]}getDragItem(){let{column:e,rowNode:t}=this;return{rowNode:t,rowNodes:this.getSelectedNodes(),columns:e?[e]:void 0,defaultTextValue:this.cellValueFn()}}getRowDragText(e){if(e){let t=e.getColDef();if(t.rowDragText)return t.rowDragText}return this.gos.get("rowDragText")}addDragSource(e=4){if(this.dragSource&&this.removeDragSource(),this.gos.get("rowDragManaged")&&this.rowNode.footer)return;let t=this.getGui();this.gos.get("enableCellTextSelection")&&(this.removeMouseDownListener(),this.mouseDownListener=this.addManagedElementListeners(t,{mousedown:n=>{n?.preventDefault()}})[0]);let i=this.getLocaleTextFunc();this.dragSource={type:2,eElement:t,dragItemName:n=>{let s=n?.dragItem||this.getDragItem(),o=(n?.dropTarget?.rows.length??s.rowNodes?.length)||1,r=this.getRowDragText(this.column);return r?r(s,o):o===1?this.cellValueFn():`${o} ${i("rowDragRows","rows")}`},getDragItem:()=>this.getDragItem(),dragStartPixels:e,dragSourceDomDataKey:this.gos.getDomDataKey()},this.beans.dragAndDrop.addDragSource(this.dragSource,!0)}destroy(){this.removeDragSource(),this.removeMouseDownListener(),super.destroy()}removeDragSource(){this.dragSource&&(this.beans.dragAndDrop.removeDragSource(this.dragSource),this.dragSource=null)}removeMouseDownListener(){this.mouseDownListener&&(this.mouseDownListener(),this.mouseDownListener=void 0)}},Mp=class{constructor(){this.reordered=!1,this.removals=new Set,this.updates=new Set,this.adds=new Set}};function Mz(e){let{rowIndex:t,rowPinned:i,column:n}=e;return`${t}.${i??"null"}.${n.getId()}`}function RM(e,t){let i=e.column===t.column,n=e.rowPinned===t.rowPinned,s=e.rowIndex===t.rowIndex;return i&&n&&s}function Dz(e,t){switch(e.rowPinned){case"top":if(t.rowPinned!=="top")return!0;break;case"bottom":if(t.rowPinned!=="bottom")return!1;break;default:if(K(t.rowPinned))return t.rowPinned!=="top";break}return e.rowIndex<t.rowIndex}function kz(e,t){return!e&&!t?!0:e&&!t||!e&&t?!1:e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned}function Pz(e){let t=0,i,{pinnedRowModel:n,rowModel:s,pageBounds:o}=e;return n?.getPinnedTopRowCount()?i="top":s.getRowCount()?(i=null,t=o.getFirstRow()):n?.getPinnedBottomRowCount()&&(i="bottom"),i===void 0?null:{rowIndex:t,rowPinned:i}}function Fz(e){let t,i=null,{pinnedRowModel:n,pageBounds:s}=e,o=n?.getPinnedBottomRowCount(),r=n?.getPinnedTopRowCount();return o?(i="bottom",t=o-1):e.rowModel.getRowCount()?t=s.getLastRow():r&&(i="top",t=r-1),t===void 0?null:{rowIndex:t,rowPinned:i}}function ks(e,t){switch(t.rowPinned){case"top":return e.pinnedRowModel?.getPinnedTopRow(t.rowIndex);case"bottom":return e.pinnedRowModel?.getPinnedBottomRow(t.rowIndex);default:return e.rowModel.getRow(t.rowIndex)}}function Ra(e,t){let i=e.spannedRowRenderer?.getCellByPosition(t);if(i)return i;let n=e.rowRenderer.getRowByPosition(t);return n?n.getCellCtrl(t.column):null}function Tz(e,t,i){let{rowModel:n,pinnedRowModel:s}=e,o;return o??(o=n?.getRowNode(t)),i?o??(o=s?.getPinnedRowById(t,i)):(o??(o=s?.getPinnedRowById(t,"top")),o??(o=s?.getPinnedRowById(t,"bottom"))),o}function Kp(e,t,i=!1){let{rowIndex:n,rowPinned:s}=t,{pageBounds:o,pinnedRowModel:r,rowModel:a}=e;if(n===0)return s==="top"?null:s==="bottom"&&a.isRowsToRender()?{rowIndex:o.getLastRow(),rowPinned:null}:r?.isRowsToRender("top")?{rowIndex:r.getPinnedTopRowCount()-1,rowPinned:"top"}:null;if(i){let l=s?void 0:a.getRow(n);return MM(e,l,!0)??{rowIndex:n-1,rowPinned:s}}return{rowIndex:n-1,rowPinned:s}}function KR(e,t,i=!1){let{rowIndex:n,rowPinned:s}=t,{pageBounds:o,pinnedRowModel:r,rowModel:a}=e;if(Az(e,t))return s==="bottom"?null:s==="top"&&a.isRowsToRender()?{rowIndex:o.getFirstRow(),rowPinned:null}:r?.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;if(i){let l=s?void 0:a.getRow(n);return MM(e,l)??{rowIndex:n+1,rowPinned:s}}return{rowIndex:n+1,rowPinned:s}}function MM(e,t,i=!1){let{gos:n,rowRenderer:s}=e;if(!t?.sticky||!a4(n))return;let o=s.getStickyTopRowCtrls(),r=s.getStickyBottomRowCtrls(),a=!r.some(u=>u.rowNode.rowIndex===t.rowIndex),l=a?o:r,d=(i?-1:1)*(a?-1:1),c;for(let u=0;u<l.length;u++)if(l[u].rowNode.rowIndex===t.rowIndex){c=l[u+d];break}return c?{rowIndex:c.rowNode.rowIndex,rowPinned:null}:void 0}function Az(e,t){let{rowPinned:i,rowIndex:n}=t,{pinnedRowModel:s,pageBounds:o}=e;return i==="top"?(s?.getPinnedTopRowCount()??0)-1<=n:i==="bottom"?(s?.getPinnedBottomRowCount()??0)-1<=n:o.getLastRow()<=n}var Hd=class{constructor(e,t){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=e,this.pathRoot={rowNode:t,children:null},this.mapToItems[t.id]=this.pathRoot}depthFirstSearchChangedPath(e,t){let{rowNode:i,children:n}=e;if(n)for(let s=0;s<n.length;++s)this.depthFirstSearchChangedPath(n[s],t);t(i)}depthFirstSearchEverything(e,t,i){let n=e.childrenAfterGroup;if(n)for(let s=0,o=n.length;s<o;++s){let r=n[s];r.childrenAfterGroup?this.depthFirstSearchEverything(r,t,i):i&&t(r)}t(e)}forEachChangedNodeDepthFirst(e,t=!1,i=!1){this.active&&!i?this.depthFirstSearchChangedPath(this.pathRoot,e):this.depthFirstSearchEverything(this.pathRoot.rowNode,e,t)}executeFromRootNode(e){e(this.pathRoot.rowNode)}createPathItems(e){let t=e,i=0;for(;!this.mapToItems[t.id];){let n={rowNode:t,children:null};this.mapToItems[t.id]=n,i++,t=t.parent}return i}populateColumnsMap(e,t){if(!this.keepingColumns||!t)return;let i=e;for(;i;){this.nodeIdsToColumns[i.id]||(this.nodeIdsToColumns[i.id]={});for(let n of t)this.nodeIdsToColumns[i.id][n.getId()]=!0;i=i.parent}}linkPathItems(e,t){let i=e;for(let n=0;n<t;n++){let s=this.mapToItems[i.id],o=this.mapToItems[i.parent.id];o.children||(o.children=[]),o.children.push(s),i=i.parent}}addParentNode(e,t){if(!e||e.isRowPinned())return;let i=this.createPathItems(e);this.linkPathItems(e,i),this.populateColumnsMap(e,t)}canSkip(e){return this.active&&!this.mapToItems[e.id]}getValueColumnsForNode(e,t){if(!this.keepingColumns)return t;let i=this.nodeIdsToColumns[e.id];return t.filter(s=>i[s.getId()])}getNotValueColumnsForNode(e,t){if(!this.keepingColumns)return null;let i=this.nodeIdsToColumns[e.id];return t.filter(s=>!i[s.getId()])}},Iz=class{constructor(e,t){this.beans=e,this.groupThrottled=!1,this.scrollChanged=!1,this.scrollChanging=!1,this.oldVScroll=null,this.groupTimer=null,this.groupTarget=null,this.onGroupThrottle=()=>{this.groupTimer=null,this.groupThrottled=!0,this.beans.dragAndDrop?.nudge()};let i=()=>t.scrollFeature.getVScrollPosition().top;this.autoScroll=new VG({scrollContainer:t.eBodyViewport,scrollAxis:"y",getVerticalPosition:i,setVerticalPosition:n=>t.scrollFeature.setVerticalScrollPosition(n),onScrollCallback:()=>{let n=i();if(this.oldVScroll!==n){this.oldVScroll=n,this.scrollChanging=!0;return}let s=this.scrollChanging;this.scrollChanged=s,this.scrollChanging=!1,s&&(this.beans.dragAndDrop?.nudge(),this.scrollChanged=!1)}})}updateGroup(e,t){this.groupTarget&&this.groupTarget!==e&&this.clearGroup(),e&&(t&&this.groupThrottled&&!e.expanded&&e.childrenAfterSort?.length&&e.isExpandable()&&e.setExpanded(!0,void 0,!0),e.expanded&&e.childrenAfterSort?.length&&(this.groupThrottled=!0,this.groupTarget=e))}startGroup(e){this.groupTarget=e,this.groupTimer===null&&(this.groupTimer=window.setTimeout(this.onGroupThrottle,this.beans.gos.get("rowDragInsertDelay")))}clearGroup(){this.groupThrottled=!1,this.groupTarget=null;let e=this.groupTimer;e!==null&&(this.groupTimer=null,window.clearTimeout(e))}clear(){this.clearGroup(),this.autoScroll.ensureCleared(),this.oldVScroll=null,this.scrollChanged=!1,this.scrollChanging=!1}},_z=class extends F{constructor(e){super(),this.eContainer=e,this.lastDraggingEvent=null,this.nudger=null}postConstruct(){let e=this.beans;e.ctrlsSvc.whenReady(this,t=>{this.nudger=new Iz(e,t.gridBodyCtrl)})}destroy(){super.destroy(),this.nudger?.clear(),this.nudger=null,this.lastDraggingEvent=null,this.eContainer=null}getContainer(){return this.eContainer}isInterestedIn(e){return e===2}getIconName(e){return e?.dropTarget?.allowed===!1||this.gos.get("rowDragManaged")&&this.shouldPreventRowMove()?"notAllowed":"move"}shouldPreventRowMove(){let{rowGroupColsSvc:e,filterManager:t,sortSvc:i}=this.beans;return!!((e?.columns??[]).length||t?.isAnyFilterPresent()||i?.isSortActive())}getRowNodes(e){if(!this.isFromThisGrid(e))return e.dragItem.rowNodes||[];let t=e.dragItem.rowNode;if(this.gos.get("rowDragMultiRow")){let i=this.beans.selectionSvc?.getSelectedNodes();if(i&&i.indexOf(t)>=0)return i.slice().sort(Nz)}return[t]}onDragEnter(e){this.dragging(e,!0)}onDragging(e){this.dragging(e,!1)}dragging(e,t){let{lastDraggingEvent:i,beans:n}=this;if(t){let r=this.getRowNodes(e);e.dragItem.rowNodes=r,JR(r,!0)}this.lastDraggingEvent=e;let s=e.fromNudge,o=this.makeRowsDrop(i,e,s,!1);n.rowDropHighlightSvc?.fromDrag(e),t&&this.dispatchGridEvent("rowDragEnter",e),this.dispatchGridEvent("rowDragMove",e),o?.rowDragManaged&&o.moved&&o.allowed&&o.sameGrid&&!o.suppressMoveWhenRowDragging&&(!s&&!this.nudger?.autoScroll.scrolling||this.nudger?.scrollChanged)&&this.dropRows(o),this.nudger?.autoScroll.check(e.event)}isFromThisGrid(e){return e.dragSource.dragSourceDomDataKey===this.gos.getDomDataKey()}makeRowsDrop(e,t,i,n){let{beans:s,gos:o}=this,r=this.newRowsDrop(t,n),a=s.rowModel;if(t.dropTarget=r,t.changed=!1,!r)return null;let{sameGrid:l,rootNode:d,source:c,target:u,rows:h}=r;u??(u=a.getRow(a.getRowCount()-1)??null);let p=!!this.beans.groupStage?.treeData&&l,g=null;if(u?.footer){let w=Dp(a,-1,u)??Dp(a,1,u);g=u.sibling??d,u=w??null}u?.detail&&(u=u.parent),r.moved&&(r.moved=c!==u);let f=.5;if(u&&(l&&r.moved&&(g||!p)?f=c.rowIndex>u.rowIndex?-.5:.5:f=(r.y-u.rowTop-u.rowHeight/2)/u.rowHeight||0),!p&&l&&u&&r.moved&&wt(o)){let w=Bz(a,r);w&&(f=c.rowIndex>w.rowIndex?-.5:.5,u=w,r.moved&&(r.moved=c!==u))}let m=this.nudger;m?.updateGroup(u,i),p&&!g&&m&&(!u||f>=.5&&u.rowIndex===s.pageBounds.getLastRow()?g=d:r.moved&&this.targetShouldBeParent(u,f,h)&&(m.groupThrottled&&(g=u),!i&&(!g||u&&!u.expanded&&u.childrenAfterSort?.length)&&m.startGroup(u)),g??(g=u?.parent??d));let C=!1;if(g){if(g===u&&g!==d){let w=g.expanded?Dp(a,1,u):null;w?.parent===g?(u=w,f=-.5):C=!0}if(u&&!C){let w=u;for(;w&&w!==d&&w!==g;)u=w,w=w.parent}}r.target=u,r.newParent=g,r.moved&&(r.moved=c!==u);let v=f<0?"above":"below";return r.position=r.moved?C?"inside":v:"none",this.validateRowsDrop(r,p,v,n),t.changed||(t.changed=Oz(e?.dropTarget,r)),r}newRowsDrop(e,t){let{beans:i,gos:n}=this,s=i.rowModel.rootNode,o=wt(n)?n.get("rowDragManaged"):!1,r=n.get("suppressMoveWhenRowDragging"),a=this.isFromThisGrid(e),{rowNode:l,rowNodes:d}=e.dragItem;if(d||(d=l?[l]:[]),l||(l=d[0]),!l||!s)return null;let c=this.beans.dragAndDrop.isDropZoneWithinThisGrid(e),u=!0;o&&(!d.length||this.shouldPreventRowMove()||(r||!a)&&!c)&&(u=!1);let h=OR(i,e).y,p=this.getOverNode(h);return{api:i.gridApi,context:i.gridOptions.context,draggingEvent:e,rowDragManaged:o,suppressMoveWhenRowDragging:r,sameGrid:a,withinGrid:c,rootNode:s,moved:l!==p,y:h,overNode:p,overIndex:p?.rowIndex??-1,position:"none",source:l,target:p??null,newParent:null,rows:d,allowed:u,highlight:!t&&o&&r&&(c||!a)}}validateRowsDrop(e,t,i,n){let{rowDragManaged:s,suppressMoveWhenRowDragging:o}=e;t||(e.newParent=null),o&&!e.moved&&(e.allowed=!1);let r=(!s||e.allowed)&&this.gos.get("isRowValidDropPosition");if(r){t&&e.newParent&&YR(e.rows,e.newParent)&&(e.newParent=null);let a=r(e);if(!a)e.allowed=!1;else if(typeof a=="object"){a.rows!==void 0&&(e.rows=a.rows??[]),t&&a.newParent!==void 0&&(e.newParent=a.newParent),a.target!==void 0&&(e.target=a.target),a.position&&(e.position=a.position),a.allowed!==void 0?e.allowed=a.allowed:s||(e.allowed=!0);let l=e.draggingEvent;a.changed&&l&&(l.changed=!0),!n&&a.highlight!==void 0&&(e.highlight=a.highlight)}}s&&(e.rows=this.filterRows(e)),t&&e.newParent&&YR(e.rows,e.newParent)&&(e.newParent=null),o&&(!e.rows.length||e.position==="none")&&(e.allowed=!1),(!e.allowed||!e.newParent)&&e.position==="inside"&&(e.position=i)}targetShouldBeParent(e,t,i){let n=e.rowIndex,s=.25;if(t<-.5+s)return!1;if(t<.5-s)return!0;let o,r=n+1,a=this.beans.rowModel;do o=a.getRow(r++);while(o?.footer);let l=e.childrenAfterGroup;if(o&&o.parent===e&&l?.length){let d=new Set(i);for(let c of l)if(c.rowIndex!==null&&!d.has(c))return!0}return!1}addRowDropZone(e){if(!e.getContainer()){I(55);return}let t=this.beans.dragAndDrop;if(t.findExternalZone(e.getContainer())){I(56);return}let i=e.fromGrid?e:{getContainer:e.getContainer,onDragEnter:e.onDragEnter&&(s=>e.onDragEnter(this.rowDragEvent("rowDragEnter",s))),onDragLeave:e.onDragLeave&&(s=>e.onDragLeave(this.rowDragEvent("rowDragLeave",s))),onDragging:e.onDragging&&(s=>e.onDragging(this.rowDragEvent("rowDragMove",s))),onDragStop:e.onDragStop&&(s=>e.onDragStop(this.rowDragEvent("rowDragEnd",s))),onDragCancel:e.onDragCancel&&(s=>e.onDragCancel(this.rowDragEvent("rowDragCancel",s)))},n=b({isInterestedIn:s=>s===2,getIconName:()=>"move",external:!0},i);t.addDropTarget(n),this.addDestroyFunc(()=>t.removeDropTarget(n))}getRowDropZone(e){return{getContainer:this.getContainer.bind(this),onDragEnter:i=>{this.onDragEnter(i),e?.onDragEnter?.(this.rowDragEvent("rowDragEnter",i))},onDragLeave:i=>{this.onDragLeave(i),e?.onDragLeave?.(this.rowDragEvent("rowDragLeave",i))},onDragging:i=>{this.onDragging(i),e?.onDragging?.(this.rowDragEvent("rowDragMove",i))},onDragStop:i=>{this.onDragStop(i),e?.onDragStop?.(this.rowDragEvent("rowDragEnd",i))},onDragCancel:i=>{this.onDragCancel(i),e?.onDragCancel?.(this.rowDragEvent("rowDragCancel",i))},fromGrid:!0}}getOverNode(e){let{pageBounds:t,rowModel:i}=this.beans,s=e>t.getCurrentPagePixelRange().pageLastPixel?-1:i.getRowIndexAtPixel(e);return s>=0?i.getRow(s):void 0}rowDragEvent(e,t){let i=this.beans,{dragItem:n,dropTarget:s,event:o,vDirection:r}=t,a=s?.rootNode===i.rowModel.rootNode,l=a?s.y:OR(i,t).y,d=a?s.overNode:this.getOverNode(l),c=a?s.overIndex:d?.rowIndex??-1;return{api:i.gridApi,context:i.gridOptions.context,type:e,event:o,node:n.rowNode,nodes:n.rowNodes,overIndex:c,overNode:d,y:l,vDirection:r,rowsDrop:s}}dispatchGridEvent(e,t){let i=this.rowDragEvent(e,t);this.eventSvc.dispatchEvent(i)}onDragLeave(e){this.dispatchGridEvent("rowDragLeave",e),this.stopDragging(e)}onDragStop(e){let t=this.makeRowsDrop(this.lastDraggingEvent,e,!1,!0);this.dispatchGridEvent("rowDragEnd",e),t?.allowed&&t.rowDragManaged&&(t.suppressMoveWhenRowDragging||!t.sameGrid||this.nudger?.autoScroll.scrolling)&&this.dropRows(t),this.stopDragging(e)}onDragCancel(e){this.dispatchGridEvent("rowDragCancel",e),this.stopDragging(e)}stopDragging(e){this.nudger?.clear(),this.beans.rowDropHighlightSvc?.fromDrag(null),JR(e.dragItem.rowNodes,!1)}dropRows(e){return e.sameGrid?this.csrmMoveRows(e):this.csrmAddRows(e)}csrmAddRows({position:e,target:t,rows:i}){let n=Ba(this.gos),s=this.beans.rowModel,o=i.filter(({data:a,rowPinned:l})=>!s.getRowNode(n?.({data:a,level:0,rowPinned:l})??a.id)).map(({data:a})=>a);if(o.length===0)return!1;let r=t?XR(t)+(e==="above"?0:1):void 0;return s.updateRowData({add:o,addIndex:r}),!0}filterRows({newParent:e,rows:t}){let i;for(let n=0,s=t.length;n<s;++n){let o=!0,r=t[n];(!r||r.footer||r.rowTop===null&&r!==this.beans.rowModel.getRowNode(r.id)||e&&r.parent!==e&&Lz(r,e)||!bv(r))&&(o=!1),o?i?.push(r):i??(i=t.slice(0,n))}return i??t}csrmMoveRows({position:e,target:t,rows:i,newParent:n,rootNode:s}){let o=!1,r=new Set;for(let h of i){n&&h.parent!==n&&(h.treeParent=n,o=!0);let p=bv(h);p&&r.add(p)}if(!o&&r.size===0)return!1;let a=this.beans.focusSvc,l=a.getFocusedCell(),d=l&&Ra(this.beans,l);if(r.size&&this.reorderLeafChildren(r,...this.getMoveRowsBounds(r,t,e==="above"))&&(o=!0),!o)return!1;let c=this.beans.rowModel,u=new Mp;return u.reordered=!0,c.refreshModel({step:"group",keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame"),changedPath:new Hd(!1,s),changedRowNodes:u}),d?d.focusCell():a.clearFocusedCell(),!0}getMoveRowsBounds(e,t,i){let n=this.beans.rowModel.rootNode?._leafs?.length??0,s=t?XR(t):-1;s<0||s>=n?s=n:i||++s;let o=s,r=Math.min(s,n-1);for(let a of e){let l=a.sourceRowIndex;l<o&&(o=l),l>r&&(r=l)}return[o,s,r]}reorderLeafChildren(e,t,i,n){let s=!1,o=this.beans.rowModel.rootNode?._leafs;if(!e.size||!o)return!1;let r=t;for(let l=t;l<i;++l){let d=o[l];e.has(d)||(d.sourceRowIndex!==r&&(d.sourceRowIndex=r,o[r]=d,s=!0),++r)}let a=n;for(let l=n;l>=i;--l){let d=o[l];e.has(d)||(d.sourceRowIndex!==a&&(d.sourceRowIndex=a,o[a]=d,s=!0),--a)}for(let l of e)l.sourceRowIndex!==r&&(l.sourceRowIndex=r,o[r]=l,s=!0),++r;return s}},Dp=(e,t,i)=>{if(i){let n=e.getRowCount(),s=i.rowIndex+t;for(;s>=0&&s<n;){let o=e.getRow(s);if(!o||!o.footer&&!o.detail)return o;s+=t}}},Lz=(e,t)=>{let i=t;for(;i;){if(i===e)return!0;i=i.parent}return!1},YR=(e,t)=>{for(let i=0,n=e.length;i<n;++i)if(e[i].parent!==t)return!1;return!0},XR=e=>{let t=bv(e);return t!==void 0?t.sourceRowIndex:-1},bv=e=>e.data?e:Z4(e.childrenAfterGroup),Oz=(e,t)=>e!==t&&(!e||e.sameGrid!==t.sameGrid||e.allowed!==t.allowed||e.position!==t.position||e.target!==t.target||e.source!==t.source||e.newParent!==t.newParent||!ho(e.rows,t.rows)),Nz=({rowIndex:e},{rowIndex:t})=>e!==null&&t!==null?e-t:0,JR=(e,t)=>{for(let i=0,n=e?.length||0;i<n;++i){let s=e[i];s.dragging!==t&&(s.dragging=t,s.dispatchRowEvent("draggingChanged"))}},Bz=(e,t)=>{let i=null,n=t.target;if(n&&t.rows.indexOf(n)<0)return null;let s=t.source;if(!n||!s)return null;let o=n.rowIndex-s.rowIndex,r=o<0?-1:1;o=t.suppressMoveWhenRowDragging?Math.abs(o):1;let a=new Set(t.rows);do{let l=Dp(e,r,n);if(!l)break;a.has(l)||(i=l,--o),n=l}while(o>0);return i},Hz=class extends F{constructor(){super(...arguments),this.beanName="rowDragSvc"}setupRowDrag(e,t){let i=t.createManagedBean(new _z(e)),n=this.beans.dragAndDrop;n.addDropTarget(i),t.addDestroyFunc(()=>n.removeDropTarget(i)),this.rowDragFeature=i}createRowDragComp(e,t,i,n,s,o){return new Rz(e,t,i,n,s,o)}createRowDragCompForRow(e,t){if(Ds(this.gos))return;let i=this.getLocaleTextFunc();return this.createRowDragComp(()=>`1 ${i("rowDragRow","row")}`,e,void 0,t,void 0,!0)}createRowDragCompForCell(e,t,i,n,s,o){let r=this.gos;return r.get("rowDragManaged")&&(!wt(r)||r.get("pagination"))?void 0:this.createRowDragComp(i,e,t,n,s,o)}},Vz=class extends F{constructor(){super(...arguments),this.beanName="rowDropHighlightSvc",this.uiLevel=0,this.dragging=!1,this.row=null,this.position="none"}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this)})}onModelUpdated(){let e=this.row,t=this.dragging;!e||e?.rowIndex===null||this.position==="none"?this.clear():this.set(e,this.position),this.dragging=t}destroy(){this.clear(),super.destroy()}clear(){let e=this.row;this.dragging=!1,e&&(this.uiLevel=0,this.position="none",this.row=null,e.dispatchRowEvent("rowHighlightChanged"))}set(e,t){let i=e!==this.row,n=e.uiLevel,s=t!==this.position,o=n!==this.uiLevel;this.dragging=!1,(i||s||o)&&(i&&this.clear(),this.uiLevel=n,this.position=t,this.row=e,e.dispatchRowEvent("rowHighlightChanged"))}fromDrag(e){let t=e?.dropTarget;if(t){let{highlight:i,target:n,position:s}=t;if(i&&n&&s!=="none"){this.set(n,s),this.dragging=!0;return}}this.dragging&&this.clear()}},DM={moduleName:"Drag",version:q,beans:[Sz]},Gz={moduleName:"DragAndDrop",version:q,dynamicBeans:{dndSourceComp:mz},icons:{rowDrag:"grip"}},kM={moduleName:"SharedDragAndDrop",version:q,beans:[BH],dependsOn:[DM],userComponents:{agDragAndDropImage:vG},icons:{columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",rowDrag:"grip"}},zz={moduleName:"RowDrag",version:q,beans:[Vz,Hz],apiFunctions:{addRowDropZone:Cz,removeRowDropZone:vz,getRowDropZoneParams:wz,getRowDropPositionIndicator:bz,setRowDropPositionIndicator:yz},dependsOn:[kM]},Wz={moduleName:"HorizontalResize",version:q,beans:[xz],dependsOn:[DM]},Uz=":where(.ag-ltr) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:left .2s}.ag-header-group-cell{transition:left .2s,width .2s}}:where(.ag-rtl) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:right .2s}.ag-header-group-cell{transition:right .2s,width .2s}}",qz=class extends F{constructor(){super(...arguments),this.beanName="colAnimation",this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.activeNext=!1,this.suppressAnimation=!1,this.animationThreadCount=0}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>this.gridBodyCtrl=e.gridBodyCtrl)}isActive(){return this.active&&!this.suppressAnimation}setSuppressAnimation(e){this.suppressAnimation=e}start(){if(this.active)return;let{gos:e}=this;e.get("suppressColumnMoveAnimation")||e.get("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0,this.activeNext=!0)}finish(){this.active&&this.flush(()=>this.activeNext=!1,()=>this.active=!1)}executeNextVMTurn(e){this.activeNext?this.executeNextFuncs.push(e):e()}executeLaterVMTurn(e){this.active?this.executeLaterFuncs.push(e):e()}ensureAnimationCssClassPresent(){this.animationThreadCount++;let e=this.animationThreadCount,{gridBodyCtrl:t}=this;t.setColumnMovingCss(!0),this.executeLaterFuncs.push(()=>{this.animationThreadCount===e&&t.setColumnMovingCss(!1)})}flush(e,t){let{executeNextFuncs:i,executeLaterFuncs:n}=this;if(i.length===0&&n.length===0){e(),t();return}let s=o=>{for(;o.length;){let r=o.pop();r&&r()}};this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e(),s(i)},0),window.setTimeout(()=>{t(),s(n)},200)})}};function $z(e,t,i){e.colMoves?.moveColumnByIndex(t,i,"api")}function jz(e,t,i){e.colMoves?.moveColumns(t,i,"api")}var Kz=class extends F{constructor(e){super(),this.pinned=e,this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[]}onDragEnter(e){if(this.clearColumnsList(),this.gos.get("functionsReadOnly"))return;let t=e.dragItem.columns;if(t)for(let i of t)i.isPrimary()&&(i.isAnyFunctionActive()||(i.isAllowValue()?this.columnsToAggregate.push(i):i.isAllowRowGroup()?this.columnsToGroup.push(i):i.isAllowPivot()&&this.columnsToPivot.push(i)))}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?"pinned":"move":null}onDragLeave(e){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(e){}onDragStop(e){let{valueColsSvc:t,rowGroupColsSvc:i,pivotColsSvc:n}=this.beans;this.columnsToAggregate.length>0&&t?.addColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&i?.addColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&n?.addColumns(this.columnsToPivot,"toolPanelDragAndDrop")}onDragCancel(){this.clearColumnsList()}};function Yz(e,t){!t||t.length<=1||t.filter(n=>e.indexOf(n)<0).length>0||t.sort((n,s)=>{let o=e.indexOf(n),r=e.indexOf(s);return o-r})}function Xz(e){let t=[...e];for(let i of e){let n=null,s=i.getParent();for(;s!=null&&s.getDisplayedLeafColumns().length===1;)n=s,s=s.getParent();if(n!=null){let r=!!n.getColGroupDef()?.marryChildren?n.getProvidedColumnGroup().getLeafColumns():n.getLeafColumns();for(let a of r)t.includes(a)||t.push(a)}}return t}function Jz(e,t,i,n){let s=n.allCols,o=null,r=null;for(let a=0;a<e.length;a++){let l=e[a],d=i.getProposedColumnOrder(t,l);if(!i.doesOrderPassRules(d))continue;let c=d.filter(h=>s.includes(h));if(r===null)r=c;else if(!ho(c,r))break;let u=Zz(d);(o===null||u<o.fragCount)&&(o={move:l,fragCount:u})}return o}function PM(e){let{isFromHeader:t,fromLeft:i,xPosition:n,fromEnter:s,fakeEvent:o,pinned:r,gos:a,colModel:l,colMoves:d,visibleCols:c}=e,{allMovingColumns:u}=e;t&&(u=Xz(u));let h=u.slice();Yz(l.getCols(),h);let p=tW({movingCols:h,draggingRight:i,xPosition:n,pinned:r,gos:a,colModel:l,visibleCols:c}),g=Qz(h,l);if(p.length===0)return;let f=p[0];if(g!==null&&(t||!s)&&!o&&(!i&&f>=g||i&&f<=g))return;let C=Jz(p,h,d,c);if(!C)return;let v=C.move;if(!(v>l.getCols().length-h.length))return{columns:h,toIndex:v}}function FM(e){let{columns:t,toIndex:i}=PM(e)||{},{finished:n,colMoves:s}=e;return!t||i==null?null:(s.moveColumns(t,i,"uiColumnMoved",n),n?null:{columns:t,toIndex:i})}function Qz(e,t){let i=t.getCols(),n=e.map(l=>i.indexOf(l)).sort((l,d)=>l-d),s=n[0];return je(n)-s!==n.length-1?null:s}function Zz(e){function t(n){let s=[],o=n.getOriginalParent();for(;o!=null;)s.push(o),o=o.getOriginalParent();return s}let i=0;for(let n=0;n<e.length-1;n++){let s=t(e[n]),o=t(e[n+1]);[s,o]=s.length>o.length?[s,o]:[o,s];for(let r of s)o.indexOf(r)===-1&&i++}return i}function eW(e,t){switch(t){case"left":return e.leftCols;case"right":return e.rightCols;default:return e.centerCols}}function tW(e){let{movingCols:t,draggingRight:i,xPosition:n,pinned:s,gos:o,colModel:r,visibleCols:a}=e;if(o.get("suppressMovableColumns")||t.some(w=>w.getColDef().suppressMovable))return[];let d=eW(a,s),c=r.getCols(),u=d.filter(w=>t.includes(w)),h=d.filter(w=>!t.includes(w)),p=c.filter(w=>!t.includes(w)),g=0,f=n;if(i){let w=0;for(let y of u)w+=y.getActualWidth();f-=w}if(f>0){for(let w=0;w<h.length;w++){let y=h[w];if(f-=y.getActualWidth(),f<0)break;g++}i&&g++}let m;if(g>0){let w=h[g-1];m=p.indexOf(w)+1}else m=p.indexOf(h[0]),m===-1&&(m=0);let C=[m],v=(w,y)=>w-y;if(i){let w=m+1,y=c.length-1;for(;w<=y;)C.push(w),w++;C.sort(v)}else{let w=m,y=c.length-1,S=c[w];for(;w<=y&&d.indexOf(S)<0;)w++,C.push(w),S=c[w];w=m-1;let x=0;for(;w>=x;)C.push(w),w--;C.sort(v).reverse()}return C}function yv(e){let{pinned:t,fromKeyboard:i,gos:n,ctrlsSvc:s,useHeaderRow:o,skipScrollPadding:r}=e,a=s.getHeaderRowContainerCtrl(t)?.eViewport,{x:l}=e;return a?(i&&(l-=a.getBoundingClientRect().left),n.get("enableRtl")&&(o&&(a=a.querySelector(".ag-header-row")),l=a.clientWidth-l),t==null&&!r&&(l+=s.get("center").getCenterViewportScrollLeft()),l):0}function VC(e,t){for(let i of e)i.moving=t,i.dispatchColEvent("movingChanged","uiColumnMoved")}var QR=7,Sv=100,mp=Sv/2,iW=5,nW=100,sW=class extends F{constructor(e){super(),this.pinned=e,this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.isCenterContainer=!K(e)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}getIconName(){let{pinned:e,lastDraggingEvent:t}=this,{dragItem:i}=t||{},n=i?.columns??[];for(let s of n){let o=s.getPinned();if(s.getColDef().lockPinned){if(o==e)return"move";continue}let r=i?.containerType;if(r===e||!e)return"move";if(e&&(!o||r!==e))return"pinned"}return"notAllowed"}onDragEnter(e){let t=e.dragItem,i=t.columns;if(e.dragSource.type===0)this.setColumnsVisible(i,!0,"uiColumnDragged");else{let s=t.visibleState,o=(i||[]).filter(r=>s[r.getId()]&&!r.isVisible());this.setColumnsVisible(o,!0,"uiColumnDragged")}this.gos.get("suppressMoveWhenColumnDragging")||this.attemptToPinColumns(i,this.pinned),this.onDragging(e,!0,!0)}onDragging(e=this.lastDraggingEvent,t=!1,i=!1,n=!1){let{gos:s,ctrlsSvc:o}=this.beans,r=s.get("suppressMoveWhenColumnDragging");if(n&&!r){this.finishColumnMoving();return}if(this.lastDraggingEvent=e,!e||!n&&tt(e.hDirection))return;let a=yv({x:e.x,pinned:this.pinned,gos:s,ctrlsSvc:o});t||this.checkCenterForScrolling(a),r?this.handleColumnDragWhileSuppressingMovement(e,t,i,a,n):this.handleColumnDragWhileAllowingMovement(e,t,i,a,n)}onDragLeave(){this.ensureIntervalCleared(),this.clearHighlighted(),this.updateDragItemContainerType(),this.lastMovedInfo=null}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}onDragCancel(){this.clearHighlighted(),this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(e,t,i){if(!e?.length)return;let n=e.filter(s=>!s.getColDef().lockVisible);n.length&&this.beans.colModel.setColsVisible(n,t,i)}finishColumnMoving(){this.clearHighlighted();let e=this.lastMovedInfo;if(!e)return;let{columns:t,toIndex:i}=e;this.beans.colMoves.moveColumns(t,i,"uiColumnMoved",!0)}updateDragItemContainerType(){let{lastDraggingEvent:e}=this;if(this.gos.get("suppressMoveWhenColumnDragging")||!e)return;let t=e.dragItem;t&&(t.containerType=this.pinned)}handleColumnDragWhileSuppressingMovement(e,t,i,n,s){let o=this.getAllMovingColumns(e,!0);if(s){let r=this.isAttemptingToPin(o);r&&this.attemptToPinColumns(o,void 0,!0);let{fromLeft:a,xPosition:l}=this.getNormalisedXPositionInfo(o,r)||{};if(a==null||l==null){this.finishColumnMoving();return}this.moveColumnsAfterHighlight({allMovingColumns:o,xPosition:l,fromEnter:t,fakeEvent:i,fromLeft:a})}else{if(!this.beans.dragAndDrop.isDropZoneWithinThisGrid(e))return;this.highlightHoveredColumn(o,n)}}handleColumnDragWhileAllowingMovement(e,t,i,n,s){let o=this.getAllMovingColumns(e),r=this.normaliseDirection(e.hDirection)==="right",a=e.dragSource.type===1,l=this.getMoveColumnParams({allMovingColumns:o,isFromHeader:a,xPosition:n,fromLeft:r,fromEnter:t,fakeEvent:i}),d=FM(O(b({},l),{finished:s}));d&&(this.lastMovedInfo=d)}getAllMovingColumns(e,t=!1){let i=e.dragSource.getDragItem(),n=null;t?(n=i.columnsInSplit,n||(n=i.columns)):n=i.columns;let s=o=>o.getColDef().lockPinned?o.getPinned()==this.pinned:!0;return n?n.filter(s):[]}getMoveColumnParams(e){let{allMovingColumns:t,isFromHeader:i,xPosition:n,fromLeft:s,fromEnter:o,fakeEvent:r}=e,{gos:a,colModel:l,colMoves:d,visibleCols:c}=this.beans;return{allMovingColumns:t,isFromHeader:i,fromLeft:s,xPosition:n,pinned:this.pinned,fromEnter:o,fakeEvent:r,gos:a,colModel:l,colMoves:d,visibleCols:c}}highlightHoveredColumn(e,t){let{gos:i,colModel:n}=this.beans,s=i.get("enableRtl"),o=n.getCols().filter(c=>c.isVisible()&&c.getPinned()===this.pinned),r=null,a=null,l=null;for(let c of o){if(a=c.getActualWidth(),r=this.getNormalisedColumnLeft(c,0,s),r!=null){let u=r+a;if(r<=t&&u>=t){l=c;break}}r=null,a=null}if(l)e.indexOf(l)!==-1&&(l=null);else{for(let c=o.length-1;c>=0;c--){let u=o[c],h=o[c].getParent();if(!h){l=u;break}let p=h?.getDisplayedLeafColumns();if(p.length){l=je(p);break}}if(!l)return;r=this.getNormalisedColumnLeft(l,0,s),a=l.getActualWidth()}if(this.lastHighlightedColumn?.column!==l&&this.clearHighlighted(),l==null||r==null||a==null)return;let d;t-r<a/2!==s?d=0:d=1,ZR(l,d),this.lastHighlightedColumn={column:l,position:d}}getNormalisedXPositionInfo(e,t){let{gos:i,visibleCols:n}=this.beans,s=i.get("enableRtl"),{firstMovingCol:o,column:r,position:a}=this.getColumnMoveAndTargetInfo(e,t,s);if(!o||!r||a==null)return;let l=n.allCols,d=l.indexOf(o),c=l.indexOf(r),u=a===0!==s,h=d<c||d===c&&!u,p=0;if(u?h&&(p-=1):h||(p+=1),c+p===d)return;let g=l[c+p];if(!g)return;let f=this.getNormalisedColumnLeft(g,20,s);return{fromLeft:h,xPosition:f}}getColumnMoveAndTargetInfo(e,t,i){let n=this.lastHighlightedColumn||{},{firstMovingCol:s,lastMovingCol:o}=oW(e);if(!s||!o||n.column||!t)return b({firstMovingCol:s},n);let a=this.getPinDirection()==="left";return{firstMovingCol:s,position:a?1:0,column:a!==i?s:o}}normaliseDirection(e){if(this.gos.get("enableRtl"))switch(e){case"left":return"right";case"right":return"left"}return e}getNormalisedColumnLeft(e,t,i){let{gos:n,ctrlsSvc:s}=this.beans,o=e.getLeft();if(o==null)return null;let r=e.getActualWidth();return yv({x:i?o+r-t:o+t,pinned:e.getPinned(),useHeaderRow:i,skipScrollPadding:!0,gos:n,ctrlsSvc:s})}isAttemptingToPin(e){let t=this.needToMoveLeft||this.needToMoveRight,i=this.failedMoveAttempts>QR;return t&&i||e.some(n=>n.getPinned()!==this.pinned)}moveColumnsAfterHighlight(e){let{allMovingColumns:t,xPosition:i,fromEnter:n,fakeEvent:s,fromLeft:o}=e,r=this.getMoveColumnParams({allMovingColumns:t,isFromHeader:!0,xPosition:i,fromLeft:o,fromEnter:n,fakeEvent:s}),{columns:a,toIndex:l}=PM(r)||{};a&&l!=null&&(this.lastMovedInfo={columns:a,toIndex:l}),this.finishColumnMoving()}clearHighlighted(){let{lastHighlightedColumn:e}=this;e&&(ZR(e.column,null),this.lastHighlightedColumn=null)}checkCenterForScrolling(e){if(!this.isCenterContainer)return;let t=this.beans.ctrlsSvc.get("center"),i=t.getCenterViewportScrollLeft(),n=i+t.getCenterWidth(),s,o;this.gos.get("enableRtl")?(s=e<i+mp,o=e>n-mp):(o=e<i+mp,s=e>n-mp),this.needToMoveRight=s,this.needToMoveLeft=o,o||s?this.ensureIntervalStarted():this.ensureIntervalCleared()}ensureIntervalStarted(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),nW),this.beans.dragAndDrop.setDragImageCompIcon(this.needToMoveLeft?"left":"right",!0))}ensureIntervalCleared(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.failedMoveAttempts=0,this.beans.dragAndDrop.setDragImageCompIcon(this.getIconName()))}moveInterval(){let e;this.intervalCount++,e=10+this.intervalCount*iW,e>Sv&&(e=Sv);let t=null,i=this.gridBodyCon.scrollFeature;if(this.needToMoveLeft?t=i.scrollHorizontally(-e):this.needToMoveRight&&(t=i.scrollHorizontally(e)),t!==0)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;let{pinnedCols:n,dragAndDrop:s,gos:o}=this.beans;if(this.failedMoveAttempts<=QR+1||!n)return;if(s.setDragImageCompIcon("pinned"),!o.get("suppressMoveWhenColumnDragging")){let r=this.lastDraggingEvent?.dragItem.columns;this.attemptToPinColumns(r,void 0,!0)}}}getPinDirection(){if(this.needToMoveLeft||this.pinned==="left")return"left";if(this.needToMoveRight||this.pinned==="right")return"right"}attemptToPinColumns(e,t,i=!1){let n=(e||[]).filter(r=>!r.getColDef().lockPinned);if(!n.length)return 0;i&&(t=this.getPinDirection());let{pinnedCols:s,dragAndDrop:o}=this.beans;return s?.setColsPinned(n,t,"uiColumnDragged"),i&&o.nudge(),n.length}destroy(){super.destroy(),this.lastDraggingEvent=null,this.clearHighlighted(),this.lastMovedInfo=null}};function ZR(e,t){e.highlighted!==t&&(e.highlighted=t,e.dispatchColEvent("headerHighlightChanged","uiColumnMoved"))}function oW(e){let t=e.length,i,n;for(let s=0;s<t;s++){if(!i){let o=e[s];o.getLeft()!=null&&(i=o)}if(!n){let o=e[t-1-s];o.getLeft()!=null&&(n=o)}if(i&&n)break}return{firstMovingCol:i,lastMovingCol:n}}var rW=class extends F{constructor(e,t){super(),this.pinned=e,this.eContainer=t}postConstruct(){let{ctrlsSvc:e,dragAndDrop:t}=this.beans,i=this.pinned;e.whenReady(this,n=>{let s,o=n.gridBodyCtrl.eBodyViewport;switch(i){case"left":s=[[o,n.left.eContainer],[n.bottomLeft.eContainer],[n.topLeft.eContainer]];break;case"right":s=[[o,n.right.eContainer],[n.bottomRight.eContainer],[n.topRight.eContainer]];break;default:s=[[o,n.center.eViewport],[n.bottomCenter.eViewport],[n.topCenter.eViewport]];break}this.eSecondaryContainers=s}),this.moveColumnFeature=this.createManagedBean(new sW(i)),this.bodyDropPivotTarget=this.createManagedBean(new Kz(i)),t.addDropTarget(this),this.addDestroyFunc(()=>t.removeDropTarget(this))}isInterestedIn(e){return e===1||e===0&&this.gos.get("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(e){return this.beans.colModel.isPivotMode()&&e.dragSource.type===0}onDragEnter(e){this.currentDropListener=this.isDropColumnInPivotMode(e)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(e)}onDragLeave(e){this.currentDropListener.onDragLeave(e)}onDragging(e){this.currentDropListener.onDragging(e)}onDragStop(e){this.currentDropListener.onDragStop(e)}onDragCancel(){this.currentDropListener.onDragCancel()}},aW=class extends F{constructor(){super(...arguments),this.beanName="colMoves"}moveColumnByIndex(e,t,i){let n=this.beans.colModel.getCols();if(!n)return;let s=n[e];this.moveColumns([s],t,i)}moveColumns(e,t,i,n=!0){let{colModel:s,colAnimation:o,visibleCols:r,eventSvc:a}=this.beans,l=s.getCols();if(!l)return;if(t>l.length-e.length){I(30,{toIndex:t});return}o?.start();let d=s.getColsForKeys(e);this.doesMovePassRules(d,t)&&(CR(s.getCols(),d,t),r.refresh(i),a.dispatchEvent({type:"columnMoved",columns:d,column:d.length===1?d[0]:null,toIndex:t,finished:n,source:i})),o?.finish()}doesMovePassRules(e,t){let i=this.getProposedColumnOrder(e,t);return this.doesOrderPassRules(i)}doesOrderPassRules(e){let{colModel:t,gos:i}=this.beans;return!(!S4(e,t.getColTree())||!(s=>{let o=d=>d?d==="left"||d===!0?-1:1:0,r=i.get("enableRtl"),a=r?1:-1,l=!0;for(let d of s){let c=o(d.getColDef().lockPosition);r?c>a&&(l=!1):c<a&&(l=!1),a=c}return l})(e))}getProposedColumnOrder(e,t){let n=this.beans.colModel.getCols().slice();return CR(n,e,t),n}createBodyDropTarget(e,t){return new rW(e,t)}moveHeader(e,t,i,n,s){let{ctrlsSvc:o,gos:r,colModel:a,visibleCols:l,focusSvc:d}=this.beans,c=t.getBoundingClientRect(),u=c.left,h=vt(i),p=h?c.width:i.getActualWidth(),g=e==="left"!==r.get("enableRtl"),f=yv({x:g?u-20:u+p+20,pinned:n,fromKeyboard:!0,gos:r,ctrlsSvc:o}),m=d.focusedHeader;FM({allMovingColumns:h?i.getLeafColumns():[i],isFromHeader:!0,fromLeft:e==="right",xPosition:f,pinned:n,fromEnter:!1,fakeEvent:!1,gos:r,colModel:a,colMoves:this,visibleCols:l,finished:!0});let C;if(h){let v=i.getDisplayedLeafColumns();C=g?v[0]:je(v)}else C=i;if(o.getScrollFeature().ensureColumnVisible(C,"auto"),(!s.isAlive()||r.get("ensureDomOrder"))&&m){let v;if(h){let w=i.getGroupId(),y=i.getLeafColumns();if(!y.length)return;let S=y[0].getParent();if(!S)return;v=lW(S,w)}else v=i;v&&d.focusHeaderPosition({headerPosition:O(b({},m),{column:v})})}}setDragSourceForHeader(e,t,i){let{gos:n,colModel:s,dragAndDrop:o,visibleCols:r}=this.beans,a=!n.get("suppressDragLeaveHidesColumns"),l=vt(t),d=l?t.getProvidedColumnGroup().getLeafColumns():[t],u={type:1,eElement:e,getDefaultIconName:()=>a?"hide":"notAllowed",getDragItem:l?()=>cW(t,r.allCols):()=>dW(t),dragItemName:i,onDragStarted:()=>{a=!n.get("suppressDragLeaveHidesColumns"),VC(d,!0)},onDragStopped:()=>VC(d,!1),onDragCancelled:()=>VC(d,!1),onGridEnter:h=>{if(a){let{columns:p=[],visibleState:g}=h??{},f=l?C=>!g||g[C.getColId()]:()=>!0,m=p.filter(C=>!C.getColDef().lockVisible&&f(C));s.setColsVisible(m,!0,"uiColumnMoved")}},onGridExit:h=>{if(a){let p=h?.columns?.filter(g=>!g.getColDef().lockVisible)||[];s.setColsVisible(p,!1,"uiColumnMoved")}}};return o.addDragSource(u,!0),u}};function lW(e,t){for(;e;){if(e.getGroupId()===t)return e;e=e.getParent()}}function dW(e){let t={};return t[e.getId()]=e.isVisible(),{columns:[e],visibleState:t,containerType:e.pinned}}function cW(e,t){let i=e.getProvidedColumnGroup().getLeafColumns(),n={};for(let a of i)n[a.getId()]=a.isVisible();let s=[];for(let a of t)i.indexOf(a)>=0&&(s.push(a),an(i,a));for(let a of i)s.push(a);let o=[],r=e.getLeafColumns();for(let a of s)r.indexOf(a)!==-1&&o.push(a);return{columns:s,columnsInSplit:o,visibleState:n,containerType:o[0]?.pinned}}var uW={moduleName:"ColumnMove",version:q,beans:[aW,qz],apiFunctions:{moveColumnByIndex:$z,moveColumns:jz},dependsOn:[kM],css:[Uz]},hW=class extends F{constructor(){super(...arguments),this.beanName="autoWidthCalc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.centerRowContainerCtrl=e.center})}getPreferredWidthForColumn(e,t){let i=this.getHeaderCellForColumn(e);if(!i)return-1;let n=this.beans.rowRenderer.getAllCellsNotSpanningForColumn(e);return t||n.push(i),this.getPreferredWidthForElements(n)}getPreferredWidthForColumnGroup(e){let t=this.getHeaderCellForColumn(e);return t?this.getPreferredWidthForElements([t]):-1}getPreferredWidthForElements(e,t){let i=document.createElement("form");i.style.position="fixed";let n=this.centerRowContainerCtrl.eContainer;for(let o of e)this.cloneItemIntoDummy(o,i);n.appendChild(i);let s=i.offsetWidth;return i.remove(),t=t??this.gos.get("autoSizePadding"),s+t}getHeaderCellForColumn(e){let t=null;for(let i of this.beans.ctrlsSvc.getHeaderRowContainerCtrls()){let n=i.getHtmlElementForColumnHeader(e);n!=null&&(t=n)}return t}cloneItemIntoDummy(e,t){let i=e.cloneNode(!0);i.style.width="",i.style.position="static",i.style.left="";let n=document.createElement("div"),s=n.classList;["ag-header-cell","ag-header-group-cell"].some(a=>i.classList.contains(a))?(s.add("ag-header","ag-header-row"),n.style.position="static"):s.add("ag-row");let r=e.parentElement;for(;r;){if(["ag-header-row","ag-row"].some(l=>r.classList.contains(l))){for(let l=0;l<r.classList.length;l++){let d=r.classList[l];d!="ag-row-position-absolute"&&s.add(d)}break}r=r.parentElement}n.appendChild(i),t.appendChild(n)}},TM={moduleName:"AutoWidth",version:q,beans:[hW]};function pW(e,t,i=!0,n="api"){e.colResize?.setColumnWidths(t,!1,i,n)}var gW=class extends F{constructor(e,t,i,n){super(),this.comp=e,this.eResize=t,this.pinned=i,this.columnGroup=n}postConstruct(){if(!this.columnGroup.isResizable()){this.comp.setResizableDisplayed(!1);return}let{horizontalResizeSvc:e,gos:t,colAutosize:i}=this.beans,n=e.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});this.addDestroyFunc(n),!t.get("suppressAutoSize")&&i&&this.addDestroyFunc(i.addColumnGroupResize(this.eResize,this.columnGroup,()=>this.resizeLeafColumnsToFit("uiColumnResized")))}onResizeStart(e){let{columnsToResize:t,resizeStartWidth:i,resizeRatios:n,groupAfterColumns:s,groupAfterStartWidth:o,groupAfterRatios:r}=this.getInitialValues(e);this.resizeCols=t,this.resizeStartWidth=i,this.resizeRatios=n,this.resizeTakeFromCols=s,this.resizeTakeFromStartWidth=o,this.resizeTakeFromRatios=r,this.toggleColumnResizing(!0)}onResizing(e,t,i="uiColumnResized"){let n=this.normaliseDragChange(t),s=this.resizeStartWidth+n;this.resizeColumnsFromLocalValues(s,i,e)}getInitialValues(e){let t=l=>l.reduce((d,c)=>d+c.getActualWidth(),0),i=(l,d)=>l.map(c=>c.getActualWidth()/d),n=this.getColumnsToResize(),s=t(n),o=i(n,s),r={columnsToResize:n,resizeStartWidth:s,resizeRatios:o},a=null;if(e&&(a=this.beans.colGroupSvc?.getGroupAtDirection(this.columnGroup,"After")??null),a){let l=a.getDisplayedLeafColumns(),d=r.groupAfterColumns=l.filter(u=>u.isResizable()),c=r.groupAfterStartWidth=t(d);r.groupAfterRatios=i(d,c)}else r.groupAfterColumns=void 0,r.groupAfterStartWidth=void 0,r.groupAfterRatios=void 0;return r}resizeLeafColumnsToFit(e){let t=this.beans.autoWidthCalc.getPreferredWidthForColumnGroup(this.columnGroup),i=this.getInitialValues();t>i.resizeStartWidth&&this.resizeColumns(i,t,e,!0)}resizeColumnsFromLocalValues(e,t,i=!0){if(!this.resizeCols||!this.resizeRatios)return;let n={columnsToResize:this.resizeCols,resizeStartWidth:this.resizeStartWidth,resizeRatios:this.resizeRatios,groupAfterColumns:this.resizeTakeFromCols,groupAfterStartWidth:this.resizeTakeFromStartWidth,groupAfterRatios:this.resizeTakeFromRatios};this.resizeColumns(n,e,t,i)}resizeColumns(e,t,i,n=!0){let{columnsToResize:s,resizeStartWidth:o,resizeRatios:r,groupAfterColumns:a,groupAfterStartWidth:l,groupAfterRatios:d}=e,c=[];if(c.push({columns:s,ratios:r,width:t}),a){let u=t-o;c.push({columns:a,ratios:d,width:l-u})}this.beans.colResize?.resizeColumnSets({resizeSets:c,finished:n,source:i}),n&&this.toggleColumnResizing(!1)}toggleColumnResizing(e){this.comp.toggleCss("ag-column-resizing",e)}getColumnsToResize(){return this.columnGroup.getDisplayedLeafColumns().filter(t=>t.isResizable())}normaliseDragChange(e){let t=e;return this.gos.get("enableRtl")?this.pinned!=="left"&&(t*=-1):this.pinned==="right"&&(t*=-1),t}destroy(){super.destroy(),this.resizeCols=void 0,this.resizeRatios=void 0,this.resizeTakeFromCols=void 0,this.resizeTakeFromRatios=void 0}},fW=class extends F{constructor(e,t,i,n,s){super(),this.pinned=e,this.column=t,this.eResize=i,this.comp=n,this.ctrl=s}postConstruct(){let e=[],t,i,n=()=>{if(et(this.eResize,t),!t)return;let{horizontalResizeSvc:r,colAutosize:a}=this.beans,l=r.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});e.push(l),i&&a&&e.push(a.addColumnAutosizeListeners(this.eResize,this.column))},s=()=>{for(let r of e)r();e.length=0},o=()=>{let r=this.column.isResizable(),a=!this.gos.get("suppressAutoSize")&&!this.column.getColDef().suppressAutoSize;(r!==t||a!==i)&&(t=r,i=a,s(),n())};o(),this.addDestroyFunc(s),this.ctrl.setRefreshFunction("resize",o)}onResizing(e,t){let{column:i,lastResizeAmount:n,resizeStartWidth:s,beans:o}=this,r=this.normaliseResizeAmount(t),a=s+r,l=[{key:i,newWidth:a}],{pinnedCols:d,ctrlsSvc:c,colResize:u}=o;if(this.column.getPinned()){let h=d?.leftWidth??0,p=d?.rightWidth??0,g=Ad(c.getGridBodyCtrl().eBodyViewport)-50;if(h+p+(r-n)>g)return}this.lastResizeAmount=r,u?.setColumnWidths(l,this.resizeWithShiftKey,e,"uiColumnResized"),e&&this.toggleColumnResizing(!1)}onResizeStart(e){this.resizeStartWidth=this.column.getActualWidth(),this.lastResizeAmount=0,this.resizeWithShiftKey=e,this.toggleColumnResizing(!0)}toggleColumnResizing(e){this.column.resizing=e,this.comp.toggleCss("ag-column-resizing",e)}normaliseResizeAmount(e){let t=e,i=this.pinned!=="left",n=this.pinned==="right";return this.gos.get("enableRtl")?i&&(t*=-1):n&&(t*=-1),t}},mW=class extends F{constructor(){super(...arguments),this.beanName="colResize"}setColumnWidths(e,t,i,n){let s=[],{colModel:o,gos:r,visibleCols:a}=this.beans;for(let l of e){let d=o.getColDefCol(l.key)||o.getCol(l.key);if(!d)continue;if(s.push({width:l.newWidth,ratios:[1],columns:[d]}),r.get("colResizeDefault")==="shift"&&(t=!t),t){let u=a.getColAfter(d);if(!u)continue;let h=d.getActualWidth()-l.newWidth,p=u.getActualWidth()+h;s.push({width:p,ratios:[1],columns:[u]})}}s.length!==0&&this.resizeColumnSets({resizeSets:s,finished:i,source:n})}resizeColumnSets(e){let{resizeSets:t,finished:i,source:n}=e;if(!(!t||t.every(c=>CW(c)))){if(i){let c=t&&t.length>0?t[0].columns:null;Ha(this.eventSvc,c,i,n)}return}let o=[],r=[];for(let c of t){let{width:u,columns:h,ratios:p}=c,g={},f={};for(let v of h)r.push(v);let m=!0,C=0;for(;m;){if(C++,C>1e3){Ge(31);break}m=!1;let v=[],w=0,y=u;h.forEach((x,E)=>{if(f[x.getId()])y-=g[x.getId()];else{v.push(x);let L=p[E];w+=L}});let S=1/w;v.forEach((x,E)=>{let T=E===v.length-1,L;T?L=y:(L=Math.round(p[E]*u*S),y-=L);let N=x.getMinWidth(),$=x.getMaxWidth();L<N?(L=N,f[x.getId()]=!0,m=!0):$>0&&L>$&&(L=$,f[x.getId()]=!0,m=!0),g[x.getId()]=L})}for(let v of h){let w=g[v.getId()];v.getActualWidth()!==w&&(v.setActualWidth(w,n),o.push(v))}}let a=o.length>0,l=[];if(a){let{colFlex:c,visibleCols:u,colViewport:h}=this.beans;l=c?.refreshFlexedColumns({resizingCols:r,skipSetLeft:!0})??[],u.setLeftValues(n),u.updateBodyWidths(),h.checkViewportColumns()}let d=r.concat(l);(a||i)&&Ha(this.eventSvc,d,i,n,l)}resizeHeader(e,t,i){if(!e.isResizable())return;let n=e.getActualWidth(),s=e.getMinWidth(),o=e.getMaxWidth(),r=Math.min(Math.max(n+t,s),o);this.setColumnWidths([{key:e,newWidth:r}],i,!0,"uiColumnResized")}createResizeFeature(e,t,i,n,s){return new fW(e,t,i,n,s)}createGroupResizeFeature(e,t,i,n){return new gW(e,t,i,n)}};function CW(e){let{columns:t,width:i}=e,n=0,s=0,o=!0;for(let l of t){let d=l.getMinWidth();n+=d||0;let c=l.getMaxWidth();c>0?s+=c:o=!1}let r=i>=n,a=!o||i<=s;return r&&a}var vW={moduleName:"ColumnResize",version:q,beans:[mW],apiFunctions:{setColumnWidths:pW},dependsOn:[Wz,TM]},wW=class extends F{constructor(e,t){super(),this.removeChildListenersFuncs=[],this.columnGroup=t,this.comp=e}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListeners(this.columnGroup,{displayedChildrenChanged:this.onDisplayedChildrenChanged.bind(this)}),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();let e=this.onWidthChanged.bind(this);for(let t of this.columnGroup.getLeafColumns())t.__addEventListener("widthChanged",e),t.__addEventListener("visibleChanged",e),this.removeChildListenersFuncs.push(()=>{t.__removeEventListener("widthChanged",e),t.__removeEventListener("visibleChanged",e)})}removeListenersOnChildrenColumns(){for(let e of this.removeChildListenersFuncs)e();this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){let e=this.columnGroup.getActualWidth();this.comp.setWidth(`${e}px`),this.comp.toggleCss("ag-hidden",e===0)}},bW=class extends dw{constructor(){super(...arguments),this.onSuppressColMoveChange=()=>{!this.isAlive()||this.isSuppressMoving()?this.removeDragSource():this.dragSource||this.setDragSource(this.eGui)}}wireComp(e,t,i,n,s){let{column:o,beans:r}=this,{context:a,colNames:l,colHover:d,rangeSvc:c,colResize:u}=r;this.comp=e,s=Ud(this,a,s),this.setGui(t,s),this.displayName=l.getDisplayNameForColumnGroup(o,"header"),this.refreshHeaderStyles(),this.addClasses(),this.setupMovingCss(s),this.setupExpandable(s),this.setupTooltip(),this.setupAutoHeight({wrapperElement:n,compBean:s}),this.setupUserComp(),this.addHeaderMouseListeners(s),this.addManagedPropertyListener("groupHeaderHeight",this.refreshMaxHeaderHeight.bind(this)),this.refreshMaxHeaderHeight();let h=this.rowCtrl.pinned,p=o.getProvidedColumnGroup().getLeafColumns();d?.createHoverFeature(s,p,t),c?.createRangeHighlightFeature(s,o,e),s.createManagedBean(new lw(o,t,r)),s.createManagedBean(new wW(e,o)),u?this.resizeFeature=s.createManagedBean(u.createGroupResizeFeature(e,i,h,o)):e.setResizableDisplayed(!1),s.createManagedBean(new qa(t,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)})),this.addHighlightListeners(s,p),s.addManagedPropertyListener("suppressMovableColumns",this.onSuppressColMoveChange),this.addResizeAndMoveKeyboardListeners(s),s.addDestroyFunc(()=>this.clearComponent())}getHeaderClassParams(){let{column:e,beans:t}=this,i=e.getDefinition();return ae(t.gos,{colDef:i,columnGroup:e,floatingFilter:!1})}refreshMaxHeaderHeight(){let{gos:e,comp:t}=this,i=e.get("groupHeaderHeight");i!=null?i===0?t.setHeaderWrapperHidden(!0):t.setHeaderWrapperMaxHeight(i):(t.setHeaderWrapperHidden(!1),t.setHeaderWrapperMaxHeight(null))}addHighlightListeners(e,t){if(this.beans.gos.get("suppressMoveWhenColumnDragging"))for(let i of t)e.addManagedListeners(i,{headerHighlightChanged:this.onLeafColumnHighlightChanged.bind(this,i)})}onLeafColumnHighlightChanged(e){let t=this.column.getDisplayedLeafColumns(),i=t[0]===e,n=je(t)===e;if(!i&&!n)return;let s=e.getHighlighted(),o=!!this.rowCtrl.getHeaderCellCtrls().find(l=>l.column.isMoving()),r=!1,a=!1;if(o){let l=this.beans.gos.get("enableRtl"),d=s===1,c=s===0;i&&(l?a=d:r=c),n&&(l?r=c:a=d)}this.comp.toggleCss("ag-header-highlight-before",r),this.comp.toggleCss("ag-header-highlight-after",a)}resizeHeader(e,t){let{resizeFeature:i}=this;if(!i)return;let n=i.getInitialValues(t);i.resizeColumns(n,n.resizeStartWidth+e,"uiColumnResized",!0)}resizeLeafColumnsToFit(e){this.resizeFeature?.resizeLeafColumnsToFit(e)}setupUserComp(){let{colGroupSvc:e,userCompFactory:t,gos:i,enterpriseMenuFactory:n}=this.beans,s=this.column,o=s.getProvidedColumnGroup(),r=ae(i,{displayName:this.displayName,columnGroup:s,setExpanded:l=>{e.setColumnGroupOpened(o,l,"gridInitializing")},setTooltip:(l,d)=>{i.assertModuleRegistered("Tooltip",3),this.setupTooltip(l,d)},showColumnMenu:(l,d)=>n?.showMenuAfterButtonClick(o,l,"columnMenu",d),showColumnMenuAfterMouseClick:(l,d)=>n?.showMenuAfterMouseEvent(o,l,"columnMenu",d),eGridHeader:this.eGui}),a=cB(t,r);a&&this.comp.setUserCompDetails(a)}addHeaderMouseListeners(e){let t=s=>this.handleMouseOverChange(s.type==="mouseenter"),i=()=>this.dispatchColumnMouseEvent("columnHeaderClicked",this.column.getProvidedColumnGroup()),n=s=>this.handleContextMenuMouseEvent(s,void 0,this.column.getProvidedColumnGroup());e.addManagedListeners(this.eGui,{mouseenter:t,mouseleave:t,click:i,contextmenu:n})}handleMouseOverChange(e){this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column.getProvidedColumnGroup()})}setupTooltip(e,t){this.tooltipFeature=this.beans.tooltipSvc?.setupHeaderGroupTooltip(this.tooltipFeature,this,e,t)}setupExpandable(e){let t=this.column.getProvidedColumnGroup();this.refreshExpanded();let i=this.refreshExpanded.bind(this);e.addManagedListeners(t,{expandedChanged:i,expandableChanged:i})}refreshExpanded(){let{column:e}=this;this.expandable=e.isExpandable();let t=e.isExpanded();this.expandable?this.comp.setAriaExpanded(t?"true":"false"):this.comp.setAriaExpanded(void 0),this.refreshHeaderStyles()}addClasses(){let{column:e}=this,t=e.getColGroupDef(),i=gM(t,this.gos,null,e);e.isPadding()?(i.push("ag-header-group-cell-no-group"),e.getLeafColumns().every(s=>s.isSpanHeaderHeight())&&i.push("ag-header-span-height")):(i.push("ag-header-group-cell-with-group"),t?.wrapHeaderText&&i.push("ag-header-cell-wrap-text"));for(let n of i)this.comp.toggleCss(n,!0)}setupMovingCss(e){let{column:t}=this,n=t.getProvidedColumnGroup().getLeafColumns(),s=()=>this.comp.toggleCss("ag-header-cell-moving",t.isMoving());for(let o of n)e.addManagedListeners(o,{movingChanged:s});s()}onFocusIn(e){this.eGui.contains(e.relatedTarget)||this.focusThis()}handleKeyDown(e){super.handleKeyDown(e);let t=this.getWrapperHasFocus();if(!(!this.expandable||!t)&&e.key===k.ENTER){let i=this.column,n=!i.isExpanded();this.beans.colGroupSvc.setColumnGroupOpened(i.getProvidedColumnGroup(),n,"uiColumnExpanded")}}setDragSource(e){!this.isAlive()||this.isSuppressMoving()||(this.removeDragSource(),e&&(this.dragSource=this.beans.colMoves?.setDragSourceForHeader(e,this.column,this.displayName)??null))}isSuppressMoving(){return this.gos.get("suppressMovableColumns")||this.column.getLeafColumns().some(e=>e.getColDef().suppressMovable||e.getColDef().lockPosition)}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function yW(e,t,i){e.colGroupSvc?.setColumnGroupOpened(t,i,"api")}function SW(e,t,i){return e.colGroupSvc?.getColumnGroup(t,i)??null}function xW(e,t){return e.colGroupSvc?.getProvidedColGroup(t)??null}function EW(e,t,i){return e.colNames.getDisplayNameForColumnGroup(t,i)||""}function RW(e){return e.colGroupSvc?.getColumnGroupState()??[]}function MW(e,t){e.colGroupSvc?.setColumnGroupState(t,"api")}function DW(e){e.colGroupSvc?.resetColumnGroupState("api")}function kW(e){return e.visibleCols.treeLeft}function PW(e){return e.visibleCols.treeCenter}function FW(e){return e.visibleCols.treeRight}function TW(e){return e.visibleCols.getAllTrees()}function AW(e,t){for(let i=0;i<t.length;i++){let n=e.indexOf(t[i]);n>=0&&(e[n]=e[e.length-1],e.pop())}}var IW=class extends F{constructor(){super(...arguments),this.beanName="visibleCols",this.colsAndGroupsMap={},this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.headerGroupRowCount=0,this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.isBodyWidthDirty=!0}refresh(e,t=!1){let{colFlex:i,colModel:n,colGroupSvc:s,colViewport:o,selectionColSvc:r}=this.beans;t||this.buildTrees(n,s),s?.updateOpenClosedVisibility(),this.leftCols=GC(this.treeLeft),this.centerCols=GC(this.treeCenter),this.rightCols=GC(this.treeRight),r?.refreshVisibility(this.leftCols,this.centerCols,this.rightCols),this.joinColsAriaOrder(n),this.joinCols(),this.headerGroupRowCount=this.getHeaderRowCount(),this.setLeftValues(e),this.autoHeightCols=this.allCols.filter(a=>a.isAutoHeight()),i?.refreshFlexedColumns(),this.updateBodyWidths(),this.setFirstRightAndLastLeftPinned(n,this.leftCols,this.rightCols,e),o.checkViewportColumns(!1),this.eventSvc.dispatchEvent({type:"displayedColumnsChanged",source:e})}getHeaderRowCount(){if(!this.gos.get("hidePaddedHeaderRows"))return this.beans.colModel.cols.treeDepth;let e=0;for(let t of this.allCols){let i=t.getParent();for(;i;){if(!i.isPadding()){let n=i.getProvidedColumnGroup().getLevel()+1;n>e&&(e=n);break}i=i.getParent()}}return e}updateBodyWidths(){let e=ys(this.centerCols),t=ys(this.leftCols),i=ys(this.rightCols);this.isBodyWidthDirty=this.bodyWidth!==e,(this.bodyWidth!==e||this.leftWidth!==t||this.rightWidth!==i)&&(this.bodyWidth=e,this.leftWidth=t,this.rightWidth=i,this.eventSvc.dispatchEvent({type:"columnContainerWidthChanged"}),this.eventSvc.dispatchEvent({type:"displayedColumnsWidthChanged"}))}setLeftValues(e){this.setLeftValuesOfCols(e),this.setLeftValuesOfGroups()}setFirstRightAndLastLeftPinned(e,t,i,n){let s,o;this.gos.get("enableRtl")?(s=t?t[0]:null,o=i?je(i):null):(s=t?je(t):null,o=i?i[0]:null);for(let r of e.getCols())r.setLastLeftPinned(r===s,n),r.setFirstRightPinned(r===o,n)}buildTrees(e,t){let i=e.getColsToShow(),n=i.filter(l=>l.getPinned()=="left"),s=i.filter(l=>l.getPinned()=="right"),o=i.filter(l=>l.getPinned()!="left"&&l.getPinned()!="right"),r=new D4,a=l=>t?t.createColumnGroups(l):l.columns;this.treeLeft=a({columns:n,idCreator:r,pinned:"left",oldDisplayedGroups:this.treeLeft}),this.treeRight=a({columns:s,idCreator:r,pinned:"right",oldDisplayedGroups:this.treeRight}),this.treeCenter=a({columns:o,idCreator:r,pinned:null,oldDisplayedGroups:this.treeCenter}),this.updateColsAndGroupsMap()}clear(){this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.ariaOrderColumns=[]}joinColsAriaOrder(e){let t=e.getCols(),i=[],n=[],s=[];for(let o of t){let r=o.getPinned();r?r===!0||r==="left"?i.push(o):s.push(o):n.push(o)}this.ariaOrderColumns=i.concat(n).concat(s)}getAriaColIndex(e){let t;return vt(e)?t=e.getLeafColumns()[0]:t=e,this.ariaOrderColumns.indexOf(t)+1}setLeftValuesOfGroups(){for(let e of[this.treeLeft,this.treeRight,this.treeCenter])for(let t of e)vt(t)&&t.checkLeft()}setLeftValuesOfCols(e){let{colModel:t}=this.beans;if(!t.getColDefCols())return;let n=t.getCols().slice(0),s=this.gos.get("enableRtl");for(let o of[this.leftCols,this.rightCols,this.centerCols]){if(s){let r=ys(o);for(let a of o)r-=a.getActualWidth(),a.setLeft(r,e)}else{let r=0;for(let a of o)a.setLeft(r,e),r+=a.getActualWidth()}AW(n,o)}for(let o of n)o.setLeft(null,e)}joinCols(){this.gos.get("enableRtl")?this.allCols=this.rightCols.concat(this.centerCols).concat(this.leftCols):this.allCols=this.leftCols.concat(this.centerCols).concat(this.rightCols)}getAllTrees(){return this.treeLeft&&this.treeRight&&this.treeCenter?this.treeLeft.concat(this.treeCenter).concat(this.treeRight):null}isColDisplayed(e){return this.allCols.indexOf(e)>=0}getLeftColsForRow(e){let{leftCols:t,beans:{colModel:i}}=this;return i.colSpanActive?this.getColsForRow(e,t):t}getRightColsForRow(e){let{rightCols:t,beans:{colModel:i}}=this;return i.colSpanActive?this.getColsForRow(e,t):t}getColsForRow(e,t,i,n){let s=[],o=null;for(let r=0;r<t.length;r++){let a=t[r],l=t.length-r,d=Math.min(a.getColSpan(e),l),c=[a];if(d>1){let h=d-1;for(let p=1;p<=h;p++)c.push(t[r+p]);r+=h}let u;if(i){u=!1;for(let h of c)i(h)&&(u=!0)}else u=!0;u&&(s.length===0&&o&&(n&&n(a))&&s.push(o),s.push(a)),o=a}return s}getContainerWidth(e){switch(e){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}getColBefore(e){let t=this.allCols,i=t.indexOf(e);return i>0?t[i-1]:null}isPinningLeft(){return this.leftCols.length>0}isPinningRight(){return this.rightCols.length>0}updateColsAndGroupsMap(){this.colsAndGroupsMap={};let e=t=>{this.colsAndGroupsMap[t.getUniqueId()]=t};or(this.treeCenter,!1,e),or(this.treeLeft,!1,e),or(this.treeRight,!1,e)}isVisible(e){return this.colsAndGroupsMap[e.getUniqueId()]===e}getFirstColumn(){let e=this.gos.get("enableRtl"),t=["leftCols","centerCols","rightCols"];e&&t.reverse();for(let i=0;i<t.length;i++){let n=this[t[i]];if(n.length)return e?je(n):n[0]}return null}getColAfter(e){let t=this.allCols,i=t.indexOf(e);return i<t.length-1?t[i+1]:null}getColsLeftWidth(){return ys(this.leftCols)}getDisplayedColumnsRightWidth(){return ys(this.rightCols)}isColAtEdge(e,t){let i=this.allCols;if(!i.length)return!1;let n=t==="first",s;if(vt(e)){let o=e.getDisplayedLeafColumns();if(!o.length)return!1;s=n?o[0]:je(o)}else s=e;return(n?i[0]:je(i))===s}};function or(e,t,i){if(e)for(let n=0;n<e.length;n++){let s=e[n];if(vt(s)){let o=t?s.getDisplayedChildren():s.getChildren();or(o,t,i)}i(s)}}function GC(e){let t=[];return or(e,!0,i=>{lo(i)&&t.push(i)}),t}var _W=class extends F{constructor(){super(...arguments),this.beanName="colGroupSvc"}getColumnGroupState(){let e=[],t=this.beans.colModel.getColTree();return Rs(null,t,i=>{ri(i)&&e.push({groupId:i.getGroupId(),open:i.isExpanded()})}),e}resetColumnGroupState(e){let t=this.beans.colModel.getColDefColTree();if(!t)return;let i=[];Rs(null,t,n=>{if(ri(n)){let s=n.getColGroupDef(),o={groupId:n.getGroupId(),open:s?s.openByDefault:void 0};i.push(o)}}),this.setColumnGroupState(i,e)}setColumnGroupState(e,t){let{colModel:i,colAnimation:n,visibleCols:s,eventSvc:o}=this.beans;if(!i.getColTree().length)return;n?.start();let a=[];for(let l of e){let d=l.groupId,c=l.open,u=this.getProvidedColGroup(d);u&&u.isExpanded()!==c&&(u.setExpanded(c),a.push(u))}s.refresh(t,!0),a.length&&o.dispatchEvent({type:"columnGroupOpened",columnGroup:a.length===1?a[0]:void 0,columnGroups:a}),n?.finish()}setColumnGroupOpened(e,t,i){let n;ri(e)?n=e.getId():n=e||"",this.setColumnGroupState([{groupId:n,open:t}],i)}getProvidedColGroup(e){let t=null;return Rs(null,this.beans.colModel.getColTree(),i=>{ri(i)&&i.getId()===e&&(t=i)}),t}getGroupAtDirection(e,t){let i=e.getProvidedColumnGroup().getLevel()+e.getPaddingLevel(),n=e.getDisplayedLeafColumns(),s=t==="After"?je(n):n[0],o=`getCol${t}`;for(;;){let r=this.beans.visibleCols[o](s);if(!r)return null;let a=this.getColGroupAtLevel(r,i);if(a!==e)return a}}getColGroupAtLevel(e,t){let i=e.getParent(),n,s;for(;n=i.getProvidedColumnGroup().getLevel(),s=i.getPaddingLevel(),!(n+s<=t);)i=i.getParent();return i}updateOpenClosedVisibility(){let e=this.beans.visibleCols.getAllTrees();or(e,!1,t=>{vt(t)&&t.calculateDisplayedColumns()})}getColumnGroup(e,t){if(!e)return null;if(vt(e))return e;let i=this.beans.visibleCols.getAllTrees(),n=typeof t=="number",s=null;return or(i,!1,o=>{if(vt(o)){let r=o,a;n?a=e===r.getGroupId()&&t===r.getPartId():a=e===r.getGroupId(),a&&(s=r)}}),s}createColumnGroups(e){let{columns:t,idCreator:i,pinned:n,oldDisplayedGroups:s,isStandaloneStructure:o}=e,r=this.mapOldGroupsById(s),a=[],l=t;for(;l.length;){let d=l;l=[];let c=0,u=h=>{let p=c;c=h;let g=d[p],m=(vt(g)?g.getProvidedColumnGroup():g).getOriginalParent();if(m==null){for(let v=p;v<h;v++)a.push(d[v]);return}let C=this.createColumnGroup(m,i,r,n,o);for(let v=p;v<h;v++)C.addChild(d[v]);l.push(C)};for(let h=1;h<d.length;h++){let p=d[h],f=(vt(p)?p.getProvidedColumnGroup():p).getOriginalParent(),m=d[c],v=(vt(m)?m.getProvidedColumnGroup():m).getOriginalParent();f!==v&&u(h)}c<d.length&&u(d.length)}return o||this.setupParentsIntoCols(a,null),a}createProvidedColumnGroup(e,t,i,n,s,o,r){let a=s.getUniqueKey(t.groupId||null,null),l=mR(this.beans,t,a),d=new Sp(l,a,!1,i);this.createBean(d);let c=this.findExistingGroup(t,o);c&&o.splice(c.idx,1);let u=c?.group;u&&d.setExpanded(u.isExpanded());let h=w4(this.beans,l.children,i+1,e,n,s,o,r);return d.setChildren(h),d}balanceColumnTree(e,t,i,n){let s=[];for(let o=0;o<e.length;o++){let r=e[o];if(ri(r)){let a=r,l=this.balanceColumnTree(a.getChildren(),t+1,i,n);a.setChildren(l),s.push(a)}else{let a,l;for(let d=t;d<i;d++){let c=n.getUniqueKey(null,null),u=mR(this.beans,null,c),h=new Sp(u,c,!0,d);this.createBean(h),l&&l.setChildren([h]),l=h,a||(a=l)}if(a&&l)if(s.push(a),e.some(c=>ri(c))){l.setChildren([r]);continue}else{l.setChildren(e);break}s.push(r)}}return s}findDepth(e){let t=0,i=e;for(;i?.[0]&&ri(i[0]);)t++,i=i[0].getChildren();return t}findMaxDepth(e,t){let i=t;for(let n=0;n<e.length;n++){let s=e[n];if(ri(s)){let o=s,r=this.findMaxDepth(o.getChildren(),t+1);i<r&&(i=r)}}return i}balanceTreeForAutoCols(e,t){let i=[];for(let n of e){let s=n;for(let o=t-1;o>=0;o--){let r=new Sp(null,`FAKE_PATH_${n.getId()}}_${o}`,!0,o);this.createBean(r),r.setChildren([s]),s.originalParent=r,s=r}t===0&&(n.originalParent=null),i.push(s)}return i}findExistingGroup(e,t){if(e.groupId!=null)for(let n=0;n<t.length;n++){let s=t[n];if(s.getColGroupDef()&&s.getId()===e.groupId)return{idx:n,group:s}}}createColumnGroup(e,t,i,n,s){let o=e.getGroupId(),r=t.getInstanceIdForKey(o),a=Q4(o,r),l=i[a];return l&&l.getProvidedColumnGroup()!==e&&(l=null),K(l)?l.reset():(l=new Bd(e,o,r,n),s||this.createBean(l)),l}mapOldGroupsById(e){let t={},i=n=>{for(let s of n)if(vt(s)){let o=s;t[s.getUniqueId()]=o,i(o.getChildren())}};return e&&i(e),t}setupParentsIntoCols(e,t){for(let i of e??[])if(i.parent!==t&&(this.beans.colViewport.colsWithinViewportHash=""),i.parent=t,vt(i)){let n=i;this.setupParentsIntoCols(n.getChildren(),n)}}},LW={moduleName:"ColumnGroup",version:q,dynamicBeans:{headerGroupCellCtrl:bW},beans:[_W],apiFunctions:{getAllDisplayedColumnGroups:TW,getCenterDisplayedColumnGroups:PW,getColumnGroup:SW,getColumnGroupState:RW,getDisplayNameForColumnGroup:EW,getLeftDisplayedColumnGroups:kW,getProvidedColumnGroup:xW,getRightDisplayedColumnGroups:FW,resetColumnGroupState:DW,setColumnGroupOpened:yW,setColumnGroupState:MW}},OW={tag:"div",cls:"ag-skeleton-container"},NW=class extends Be{constructor(){super(OW)}init(e){let t=`ag-cell-skeleton-renderer-${this.getCompId()}`;this.getGui().setAttribute("id",t),this.addDestroyFunc(()=>Fd(e.eParentOfValue)),Fd(e.eParentOfValue,t),e.deferRender?this.setupLoading(e):e.node.failedLoad?this.setupFailed():this.setupLoading(e)}setupFailed(){let e=this.getLocaleTextFunc();this.getGui().textContent=e("loadingError","ERR");let t=e("ariaSkeletonCellLoadingFailed","Row failed to load");Na(this.getGui(),t)}setupLoading(e){let t=bt({tag:"div",cls:"ag-skeleton-effect"}),i=e.node.rowIndex;if(i!=null){let o=75+25*(i%2===0?Math.sin(i):Math.cos(i));t.style.width=`${o}%`}this.getGui().appendChild(t);let n=this.getLocaleTextFunc(),s=e.deferRender?n("ariaDeferSkeletonCellLoading","Cell is loading"):n("ariaSkeletonCellLoading","Row data is loading");Na(this.getGui(),s)}refresh(e){return!1}},BW={moduleName:"CheckboxCellRenderer",version:q,userComponents:{agCheckboxCellRenderer:yG}},HW={moduleName:"SkeletonCellRenderer",version:q,userComponents:{agSkeletonCellRenderer:NW}};function VW(e,t){let i=e.colModel.getColDefCol(t);return i?i.getColDef():null}function GW(e){return e.colModel.getColumnDefs(!0)}function zW(e,t,i){return e.colNames.getDisplayNameForColumn(t,i)||""}function WW(e,t){return e.colModel.getColDefCol(t)}function UW(e){return e.colModel.getColDefCols()}function qW(e,t){return rn(e,t,"api")}function $W(e){return zp(e)}function jW(e){LN(e,"api")}function KW(e){return e.visibleCols.isPinningLeft()||e.visibleCols.isPinningRight()}function YW(e){return e.visibleCols.isPinningLeft()}function XW(e){return e.visibleCols.isPinningRight()}function JW(e,t){return e.visibleCols.getColAfter(t)}function QW(e,t){return e.visibleCols.getColBefore(t)}function ZW(e,t,i){e.colModel.setColsVisible(t,i,"api")}function eU(e,t,i){e.pinnedCols?.setColsPinned(t,i,"api")}function tU(e){return e.colModel.getCols()}function iU(e){return e.visibleCols.leftCols}function nU(e){return e.visibleCols.centerCols}function sU(e){return e.visibleCols.rightCols}function oU(e){return e.visibleCols.allCols}function rU(e){return e.colViewport.getViewportColumns()}function xv(e,t){if(!e)return;let i=e,n={};for(let s of Object.keys(i)){if(t&&t.indexOf(s)>=0||j6.has(s))continue;let o=i[s];typeof o=="object"&&o!==null&&o.constructor===Object?n[s]=xv(o):n[s]=o}return n}var aU=class extends F{constructor(){super(...arguments),this.beanName="colDefFactory"}wireBeans(e){this.rowGroupColsSvc=e.rowGroupColsSvc,this.pivotColsSvc=e.pivotColsSvc}getColumnDefs(e,t,i,n,s=!1){let o=e.slice();t?o.sort((l,d)=>i.indexOf(l)-i.indexOf(d)):(i||s)&&o.sort((l,d)=>n.indexOf(l)-n.indexOf(d));let r=this.rowGroupColsSvc?.columns,a=this.pivotColsSvc?.columns;return this.buildColumnDefs(o,r,a)}buildColumnDefs(e,t=[],i=[]){let n=[],s={};for(let o of e){let r=this.createDefFromColumn(o,t,i),a=!0,l=r,d=o.getOriginalParent(),c=null;for(;d;){let u=null;if(d.isPadding()){d=d.getOriginalParent();continue}let h=s[d.getGroupId()];if(h){h.children.push(l),a=!1;break}if(u=this.createDefFromGroup(d),u&&(u.children=[l],s[u.groupId]=u,l=u,d=d.getOriginalParent()),d!=null&&c===d){a=!1;break}c=d}a&&n.push(l)}return n}createDefFromGroup(e){let t=xv(e.getColGroupDef(),["children"]);return t&&(t.groupId=e.getGroupId()),t}createDefFromColumn(e,t,i){let n=xv(e.getColDef());return n.colId=e.getColId(),n.width=e.getActualWidth(),n.rowGroup=e.isRowGroupActive(),n.rowGroupIndex=e.isRowGroupActive()?t.indexOf(e):null,n.pivot=e.isPivotActive(),n.pivotIndex=e.isPivotActive()?i.indexOf(e):null,n.aggFunc=e.isValueActive()?e.getAggFunc():null,n.hide=e.isVisible()?void 0:!0,n.pinned=e.isPinned()?e.getPinned():null,n.sort=e.getSort()?e.getSort():null,n.sortIndex=e.getSortIndex()!=null?e.getSortIndex():null,n}},lU=class extends F{constructor(){super(...arguments),this.beanName="colFlex",this.columnsHidden=!1}refreshFlexedColumns(e={}){let t=e.source??"flex";e.viewportWidth!=null&&(this.flexViewportWidth=e.viewportWidth);let i=this.flexViewportWidth,{visibleCols:n,colDelayRenderSvc:s}=this.beans,o=n.centerCols,r=-1;if(e.resizingCols){let f=new Set(e.resizingCols);for(let m=o.length-1;m>=0;m--)if(f.has(o[m])){r=m;break}}let a=!1,l=o.map((f,m)=>{let C=f.getFlex(),v=C!=null&&C>0&&m>r;return a||(a=v),{col:f,isFlex:v,flex:Math.max(0,C??0),initialSize:f.getActualWidth(),min:f.getMinWidth(),max:f.getMaxWidth(),targetSize:0}});if(a?(s?.hideColumns("colFlex"),this.columnsHidden=!0):this.columnsHidden&&this.revealColumns(s),!i||!a)return[];let d=l.length,c=l.reduce((f,m)=>f+m.flex,0),u=i,h=(f,m)=>{f.frozenSize=m,f.col.setActualWidth(m,t),u-=m,c-=f.flex,d-=1},p=f=>f.frozenSize!=null;for(let f of l)f.isFlex||h(f,f.initialSize);for(;d>0;){let f=Math.round(c<1?u*c:u),m,C=0,v=0;for(let S of l){if(p(S))continue;m=S,v+=f*(S.flex/c);let x=v-C,E=Math.round(x);S.targetSize=E,C+=E}m&&(m.targetSize+=f-C);let w=0;for(let S of l){if(p(S))continue;let x=S.targetSize,E=Math.min(Math.max(x,S.min),S.max);w+=E-x,S.violationType=E===x?void 0:E<x?"max":"min",S.targetSize=E}let y=w===0?"all":w>0?"min":"max";for(let S of l)p(S)||(y==="all"||S.violationType===y)&&h(S,S.targetSize)}e.skipSetLeft||n.setLeftValues(t),e.updateBodyWidths&&n.updateBodyWidths();let g=l.filter(f=>f.isFlex&&!f.violationType).map(f=>f.col);if(e.fireResizedEvent){let f=l.filter(C=>C.initialSize!==C.frozenSize).map(C=>C.col),m=l.filter(C=>C.flex).map(C=>C.col);Ha(this.eventSvc,f,!0,t,m)}return this.revealColumns(s),g}revealColumns(e){this.columnsHidden&&(e?.revealColumns("colFlex"),this.columnsHidden=!1)}initCol(e){let{flex:t,initialFlex:i}=e.colDef;t!==void 0?e.flex=t:i!==void 0&&(e.flex=i)}setColFlex(e,t){e.flex=t??null,e.dispatchStateUpdatedEvent("flex")}};function Md(e,t,i){if(!t||!e)return;if(!i)return e[t];let n=t.split("."),s=e;for(let o=0;o<n.length;o++){if(s==null)return;s=s[n[o]]}return s}var dU=["dateTimeString","dateString","text","number","boolean","date"],cU=class extends F{constructor(){super(...arguments),this.beanName="dataTypeSvc",this.dataTypeDefinitions={},this.isPendingInference=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[],this.columnDefinitionPropsPerDataType={number(){return{cellEditor:"agNumberCellEditor"}},boolean(){return{cellEditor:"agCheckboxCellEditor",cellRenderer:"agCheckboxCellRenderer",getFindText:()=>null,suppressKeyboardEvent:e=>!!e.colDef.editable&&e.event.key===k.SPACE}},date({formatValue:e}){return{cellEditor:"agDateCellEditor",keyCreator:e}},dateString({formatValue:e}){return{cellEditor:"agDateStringCellEditor",keyCreator:e}},dateTime(e){return this.date(e)},dateTimeString(e){return this.dateString(e)},object({formatValue:e,colModel:t,colId:i}){return{cellEditorParams:{useFormatter:!0},comparator:(n,s)=>{let o=t.getColDefCol(i),r=o?.getColDef();if(!o||!r)return 0;let a=n==null?"":e({column:o,node:null,value:n}),l=s==null?"":e({column:o,node:null,value:s});return a===l?0:a>l?1:-1},keyCreator:e}},text(){return{}}}}wireBeans(e){this.colModel=e.colModel}postConstruct(){this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",e=>{this.processDataTypeDefinitions(),this.colModel.recreateColumnDefs(e)})}processDataTypeDefinitions(){let e=this.getDefaultDataTypes(),t={},i={},n=c=>u=>{let{column:h,node:p,value:g}=u,f=h.getColDef().valueFormatter;return f===c.groupSafeValueFormatter&&(f=c.valueFormatter),this.beans.valueSvc.formatValue(h,p,g,f)};for(let c of Object.keys(e)){let u=e[c],h=O(b({},u),{groupSafeValueFormatter:i6(u,this.gos)});t[c]=h,i[c]=n(h)}let s=this.gos.get("dataTypeDefinitions")??{},o={};for(let c of Object.keys(s)){let u=s[c],h=this.processDataTypeDefinition(u,s,[c],e);h&&(t[c]=h,u.dataTypeMatcher&&(o[c]=u.dataTypeMatcher),i[c]=n(h))}let{valueParser:r,valueFormatter:a}=e.object,{valueParser:l,valueFormatter:d}=t.object;this.hasObjectValueParser=l!==r,this.hasObjectValueFormatter=d!==a,this.formatValueFuncs=i,this.dataTypeDefinitions=t,this.dataTypeMatchers=this.sortKeysInMatchers(o,e)}sortKeysInMatchers(e,t){let i=b({},e);for(let n of dU)delete i[n],i[n]=e[n]??t[n].dataTypeMatcher;return i}processDataTypeDefinition(e,t,i,n){let s,o=e.extendsDataType;if(e.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),e.extendsDataType===e.baseDataType){let r=n[o],a=t[o];if(r&&a&&(r=a),!t6(e,r,o))return;s=e6(r,e)}else{if(i.includes(o)){I(44);return}let r=t[o];if(!t6(e,r,o))return;let a=this.processDataTypeDefinition(r,t,[...i,o],n);if(!a)return;s=e6(a,e)}return O(b({},s),{groupSafeValueFormatter:i6(s,this.gos)})}updateColDefAndGetColumnType(e,t,i){let{cellDataType:n}=t,{field:s}=t;if(n===void 0&&(n=e.cellDataType),(n==null||n===!0)&&(n=this.canInferCellDataType(e,t)?this.inferCellDataType(s,i):!1),!n){e.cellDataType=!1;return}let o=this.dataTypeDefinitions[n];if(!o){I(47,{cellDataType:n});return}return e.cellDataType=n,o.groupSafeValueFormatter&&(e.valueFormatter=o.groupSafeValueFormatter),o.valueParser&&(e.valueParser=o.valueParser),o.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(e,n,o,i),o.columnTypes}addColumnListeners(e){if(!this.isPendingInference)return;let t=this.columnStateUpdatesPendingInference[e.getColId()];if(!t)return;let i=n=>{t.add(n.key)};e.__addEventListener("columnStateUpdated",i),this.columnStateUpdateListenerDestroyFuncs.push(()=>e.__removeEventListener("columnStateUpdated",i))}canInferCellDataType(e,t){let{gos:i}=this;if(!wt(i))return!1;let n={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(zC(t,n))return!1;let s=t.type===null?e.type:t.type;if(s){let o=i.get("columnTypes")??{};if(Gp(s).some(a=>{let l=o[a.trim()];return l&&zC(l,n)}))return!1}return!zC(e,n)}inferCellDataType(e,t){if(!e)return;let i,n=this.getInitialData();if(n){let o=e.includes(".")&&!this.gos.get("suppressFieldDotNotation");i=Md(n,e,o)}else this.initWaitForRowData(t);return i==null?void 0:Object.keys(this.dataTypeMatchers).find(o=>this.dataTypeMatchers[o](i))??"object"}getInitialData(){let e=this.gos.get("rowData");if(e?.length)return e[0];if(this.initialData)return this.initialData;{let t=this.beans.rowModel.rootNode?._leafs;if(t?.length)return t[0].data}return null}initWaitForRowData(e){if(this.columnStateUpdatesPendingInference[e]=new Set,this.isPendingInference)return;this.isPendingInference=!0;let t=this.isColumnTypeOverrideInDataTypeDefinitions,{colAutosize:i,eventSvc:n}=this.beans;t&&i&&(i.shouldQueueResizeOperations=!0);let[s]=this.addManagedEventListeners({rowDataUpdateStarted:o=>{let{firstRowData:r}=o;r&&(s?.(),this.isPendingInference=!1,this.processColumnsPendingInference(r,t),this.columnStateUpdatesPendingInference={},t&&i?.processResizeOperations(),n.dispatchEvent({type:"dataTypesInferred"}))}})}processColumnsPendingInference(e,t){this.initialData=e;let i=[];this.destroyColumnStateUpdateListeners();let n={},s={};for(let o of Object.keys(this.columnStateUpdatesPendingInference)){let r=this.columnStateUpdatesPendingInference[o],a=this.colModel.getCol(o);if(!a)return;let l=a.getColDef();if(!this.resetColDefIntoCol(a,"cellDataTypeInferred"))return;let d=a.getColDef();if(t&&d.type&&d.type!==l.type){let c=hU(a,r);c.rowGroup&&c.rowGroupIndex==null&&(n[o]=c),c.pivot&&c.pivotIndex==null&&(s[o]=c),i.push(c)}}t&&i.push(...this.generateColumnStateForRowGroupAndPivotIndexes(n,s)),i.length&&rn(this.beans,{state:i},"cellDataTypeInferred"),this.initialData=null}generateColumnStateForRowGroupAndPivotIndexes(e,t){let i={},{rowGroupColsSvc:n,pivotColsSvc:s}=this.beans;return n?.restoreColumnOrder(i,e),s?.restoreColumnOrder(i,t),Object.values(i)}resetColDefIntoCol(e,t){let i=e.getUserProvidedColDef();if(!i)return!1;let n=ov(this.beans,i,e.getColId());return e.setColDef(n,i,t),!0}getDateStringTypeDefinition(e){let{dateString:t}=this.dataTypeDefinitions;return e?this.getDataTypeDefinition(e)??t:t}getDateParserFunction(e){return this.getDateStringTypeDefinition(e).dateParser}getDateFormatterFunction(e){return this.getDateStringTypeDefinition(e).dateFormatter}getDateIncludesTimeFlag(e){return e==="dateTime"||e==="dateTimeString"}getDataTypeDefinition(e){let t=e.getColDef();if(t.cellDataType)return this.dataTypeDefinitions[t.cellDataType]}getBaseDataType(e){return this.getDataTypeDefinition(e)?.baseDataType}checkType(e,t){if(t==null)return!0;let i=this.getDataTypeDefinition(e)?.dataTypeMatcher;return i?i(t):!0}validateColDef(e){let t=i=>I(48,{property:i});if(e.cellDataType==="object"){let{object:i}=this.dataTypeDefinitions;e.valueFormatter===i.groupSafeValueFormatter&&!this.hasObjectValueFormatter&&t("Formatter"),e.editable&&e.valueParser===i.valueParser&&!this.hasObjectValueParser&&t("Parser")}}postProcess(e){let t=e.cellDataType;if(!t||typeof t!="string")return;let{dataTypeDefinitions:i,beans:n,formatValueFuncs:s}=this,o=i[t];o&&n.colFilter?.setColDefPropsForDataType(e,o,s[t])}getFormatValue(e){return this.formatValueFuncs[e]}isColPendingInference(e){return this.isPendingInference&&!!this.columnStateUpdatesPendingInference[e]}setColDefPropertiesForBaseDataType(e,t,i,n){let s=this.formatValueFuncs[t],o=this.columnDefinitionPropsPerDataType[i.baseDataType]({colDef:e,cellDataType:t,colModel:this.colModel,dataTypeDefinition:i,colId:n,formatValue:s});Object.assign(e,o)}getDateObjectTypeDef(e){let t=this.getLocaleTextFunc(),i=this.getDateIncludesTimeFlag(e);return{baseDataType:e,valueParser:n=>Si(n.newValue&&String(n.newValue)),valueFormatter:n=>n.value==null?"":!(n.value instanceof Date)||isNaN(n.value.getTime())?t("invalidDate","Invalid Date"):Ai(n.value,i)??"",dataTypeMatcher:n=>n instanceof Date}}getDateStringTypeDef(e){let t=this.getDateIncludesTimeFlag(e);return{baseDataType:e,dateParser:i=>Si(i)??void 0,dateFormatter:i=>Ai(i??null,t)??void 0,valueParser:i=>xp(String(i.newValue))?i.newValue:null,valueFormatter:i=>xp(String(i.value))?String(i.value):"",dataTypeMatcher:i=>typeof i=="string"&&xp(i)}}getDefaultDataTypes(){let e=this.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:t=>t.newValue?.trim?.()===""?null:Number(t.newValue),valueFormatter:t=>t.value==null?"":typeof t.value!="number"||isNaN(t.value)?e("invalidNumber","Invalid Number"):String(t.value),dataTypeMatcher:t=>typeof t=="number"},text:{baseDataType:"text",valueParser:t=>t.newValue===""?null:JC(t.newValue),dataTypeMatcher:t=>typeof t=="string"},boolean:{baseDataType:"boolean",valueParser:t=>t.newValue==null?t.newValue:t.newValue?.trim?.()===""?null:String(t.newValue).toLowerCase()==="true",valueFormatter:t=>t.value==null?"":String(t.value),dataTypeMatcher:t=>typeof t=="boolean"},date:this.getDateObjectTypeDef("date"),dateString:this.getDateStringTypeDef("dateString"),dateTime:this.getDateObjectTypeDef("dateTime"),dateTimeString:O(b({},this.getDateStringTypeDef("dateTimeString")),{dataTypeMatcher:t=>typeof t=="string"&&DB(t)}),object:{baseDataType:"object",valueParser:()=>null,valueFormatter:t=>JC(t.value)??""}}}destroyColumnStateUpdateListeners(){for(let e of this.columnStateUpdateListenerDestroyFuncs)e();this.columnStateUpdateListenerDestroyFuncs=[]}destroy(){this.dataTypeDefinitions={},this.dataTypeMatchers={},this.formatValueFuncs={},this.columnStateUpdatesPendingInference={},this.destroyColumnStateUpdateListeners(),super.destroy()}};function e6(e,t){let i=b(b({},e),t);return e.columnTypes&&t.columnTypes&&t.appendColumnTypes&&(i.columnTypes=[...Gp(e.columnTypes),...Gp(t.columnTypes)]),i}function t6(e,t,i){return t?t.baseDataType!==e.baseDataType?(I(46),!1):!0:(I(45,{parentCellDataType:i}),!1)}function i6(e,t){if(e.valueFormatter)return i=>{if(i.node?.group){let n=(i.colDef.pivotValueColumn??i.column).getAggFunc();if(n){if(n==="first"||n==="last")return e.valueFormatter(i);if(e.baseDataType==="number"&&n!=="count"){if(typeof i.value=="number")return e.valueFormatter(i);if(typeof i.value=="object"){if(!i.value)return;if("toNumber"in i.value)return e.valueFormatter(O(b({},i),{value:i.value.toNumber()}));if("value"in i.value)return e.valueFormatter(O(b({},i),{value:i.value.value}))}}return}}else if(t.get("groupHideOpenParents")&&i.column.isRowGroupActive()&&typeof i.value=="string"&&!e.dataTypeMatcher?.(i.value))return;return e.valueFormatter(i)}}function uU(e,t,i,n){if(!t[i])return!1;let s=e[i];return s===null?(t[i]=!1,!1):n===void 0?!!s:s===n}function zC(e,t){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some(([i,n])=>uU(e,t,i,n))}function hU(e,t){let i=M4(e);for(let n of t)delete i[n],n==="rowGroup"?delete i.rowGroupIndex:n==="pivot"&&delete i.pivotIndex;return i}var pU={moduleName:"DataType",version:q,beans:[cU],dependsOn:[BW]},gU={moduleName:"ColumnFlex",version:q,beans:[lU]},AM={moduleName:"ColumnApi",version:q,beans:[aU],apiFunctions:{getColumnDef:VW,getDisplayNameForColumn:zW,getColumn:WW,getColumns:UW,applyColumnState:qW,getColumnState:$W,resetColumnState:jW,isPinning:KW,isPinningLeft:YW,isPinningRight:XW,getDisplayedColAfter:JW,getDisplayedColBefore:QW,setColumnsVisible:ZW,setColumnsPinned:eU,getAllGridColumns:tU,getDisplayedLeftColumns:iU,getDisplayedCenterColumns:nU,getDisplayedRightColumns:sU,getAllDisplayedColumns:oU,getAllDisplayedVirtualColumns:rU,getColumnDefs:GW}};function fU(e){if(!e||e==null)return null;let t=/([a-z])([A-Z])/g,i=/([A-Z]+)([A-Z])([a-z])/g;return e.replace(t,"$1 $2").replace(i,"$1 $2$3").replace(/\./g," ").split(" ").map(s=>s.substring(0,1).toUpperCase()+(s.length>1?s.substring(1,s.length):"")).join(" ")}var mU=class extends F{constructor(){super(...arguments),this.beanName="colNames"}getDisplayNameForColumn(e,t,i=!1){if(!e)return null;let n=this.getHeaderName(e.getColDef(),e,null,null,t),{aggColNameSvc:s}=this.beans;return i&&s?s.getHeaderName(e,n):n}getDisplayNameForProvidedColumnGroup(e,t,i){let n=t?.getColGroupDef();return n?this.getHeaderName(n,null,e,t,i):null}getDisplayNameForColumnGroup(e,t){return this.getDisplayNameForProvidedColumnGroup(e,e.getProvidedColumnGroup(),t)}getHeaderName(e,t,i,n,s){let o=e.headerValueGetter;if(o){let r=ae(this.gos,{colDef:e,column:t,columnGroup:i,providedColumnGroup:n,location:s});return typeof o=="function"?o(r):typeof o=="string"?this.beans.expressionSvc?.evaluate(o,r)??null:""}else{if(e.headerName!=null)return e.headerName;if(e.field)return fU(e.field)}return""}},CU=class extends F{constructor(){super(...arguments),this.beanName="colViewport",this.colsWithinViewport=[],this.headerColsWithinViewport=[],this.colsWithinViewportHash="",this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.columnsToRenderLeft=[],this.columnsToRenderRight=[],this.columnsToRenderCenter=[]}wireBeans(e){this.visibleCols=e.visibleCols,this.colModel=e.colModel}postConstruct(){this.suppressColumnVirtualisation=this.gos.get("suppressColumnVirtualisation")}setScrollPosition(e,t,i=!1){let{visibleCols:n}=this,s=n.isBodyWidthDirty;if(!(e===this.scrollWidth&&t===this.scrollPosition&&!s)){if(this.scrollWidth=e,this.scrollPosition=t,n.isBodyWidthDirty=!0,this.gos.get("enableRtl")){let r=n.bodyWidth;this.viewportLeft=r-t-e,this.viewportRight=r-t}else this.viewportLeft=t,this.viewportRight=e+t;this.colModel.ready&&this.checkViewportColumns(i)}}getColumnHeadersToRender(e){switch(e){case"left":return this.columnsToRenderLeft;case"right":return this.columnsToRenderRight;default:return this.columnsToRenderCenter}}getHeadersToRender(e,t){let i;switch(e){case"left":i=this.rowsOfHeadersToRenderLeft[t];break;case"right":i=this.rowsOfHeadersToRenderRight[t];break;default:i=this.rowsOfHeadersToRenderCenter[t];break}return i??[]}extractViewportColumns(){let e=this.visibleCols.centerCols;this.isColumnVirtualisationSuppressed()?(this.colsWithinViewport=e,this.headerColsWithinViewport=e):(this.colsWithinViewport=e.filter(this.isColumnInRowViewport.bind(this)),this.headerColsWithinViewport=e.filter(this.isColumnInHeaderViewport.bind(this)))}isColumnVirtualisationSuppressed(){return this.suppressColumnVirtualisation||this.viewportRight===0}clear(){this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.colsWithinViewportHash=""}isColumnInHeaderViewport(e){return e.isAutoHeaderHeight()||vU(e)?!0:this.isColumnInRowViewport(e)}isColumnInRowViewport(e){if(e.isAutoHeight())return!0;let t=e.getLeft()||0,i=t+e.getActualWidth(),n=this.viewportLeft-200,s=this.viewportRight+200,o=t<n&&i<n,r=t>s&&i>s;return!o&&!r}getViewportColumns(){let{leftCols:e,rightCols:t}=this.visibleCols;return this.colsWithinViewport.concat(e).concat(t)}getColsWithinViewport(e){if(!this.colModel.colSpanActive)return this.colsWithinViewport;let t=o=>{let r=o.getLeft();return K(r)&&r>this.viewportLeft},i=this.isColumnVirtualisationSuppressed()?void 0:this.isColumnInRowViewport.bind(this),{visibleCols:n}=this,s=n.centerCols;return n.getColsForRow(e,s,i,t)}checkViewportColumns(e=!1){this.extractViewport()&&this.eventSvc.dispatchEvent({type:"virtualColumnsChanged",afterScroll:e})}calculateHeaderRows(){let{leftCols:e,rightCols:t}=this.visibleCols;this.columnsToRenderLeft=e,this.columnsToRenderRight=t,this.columnsToRenderCenter=this.colsWithinViewport;let i=n=>{let s=new Set,o={};for(let r of n){let a=r.getParent(),l=r.isSpanHeaderHeight();for(;a&&!s.has(a);){if(l&&a.isPadding()){a=a.getParent();continue}let c=a.getProvidedColumnGroup().getLevel();o[c]??(o[c]=[]),o[c].push(a),s.add(a),a=a.getParent()}}return o};this.rowsOfHeadersToRenderLeft=i(e),this.rowsOfHeadersToRenderRight=i(t),this.rowsOfHeadersToRenderCenter=i(this.headerColsWithinViewport)}extractViewport(){let e=n=>`${n.getId()}-${n.getPinned()||"normal"}`;this.extractViewportColumns();let t=this.getViewportColumns().map(e).join("#"),i=this.colsWithinViewportHash!==t;return i&&(this.colsWithinViewportHash=t,this.calculateHeaderRows()),i}};function vU(e){for(;e;){if(e.isAutoHeaderHeight())return!0;e=e.getParent()}return!1}var wU=class extends F{constructor(){super(...arguments),this.beanName="agCompUtils"}adaptFunction(e,t){if(!e.cellRenderer)return null;class i{refresh(){return!1}getGui(){return this.eGui}init(s){let o=t(s),r=typeof o;if(r==="string"||r==="number"||r==="boolean"){this.eGui=_v("<span>"+o+"</span>");return}if(o==null){this.eGui=bt({tag:"span"});return}this.eGui=o}}return i}},bU={moduleName:"CellRendererFunction",version:q,beans:[wU]},yU=class extends EH{constructor(){super(...arguments),this.agGridDefaults={},this.agGridDefaultOverrides={},this.jsComps={},this.selectors={},this.icons={}}postConstruct(){let e=this.gos.get("components");if(e!=null)for(let t of Object.keys(e))this.jsComps[t]=e[t]}registerModule(e){let{icons:t,userComponents:i,dynamicBeans:n,selectors:s}=e;if(i){let o=(r,a,l,d)=>{this.agGridDefaults[r]=a,(l||d)&&(this.agGridDefaultOverrides[r]={params:l,processParams:d})};for(let r of Object.keys(i)){let a=i[r];if(SB(a)&&(a=a.getComp(this.beans)),typeof a=="object"){let{classImp:l,params:d,processParams:c}=a;o(r,l,d,c)}else o(r,a)}}this.registerDynamicBeans(n);for(let o of s??[])this.selectors[o.selector]=o;if(t)for(let o of Object.keys(t))this.icons[o]=t[o]}getUserComponent(e,t){let i=(a,l,d,c)=>({componentFromFramework:l,component:a,params:d,processParams:c}),{frameworkOverrides:n}=this.beans,s=n.frameworkComponent(t,this.gos.get("components"));if(s!=null)return i(s,!0);let o=this.jsComps[t];if(o){let a=n.isFrameworkComponent(o);return i(o,a)}let r=this.agGridDefaults[t];if(r){let a=this.agGridDefaultOverrides[t];return i(r,!1,a?.params,a?.processParams)}return this.beans.validation?.missingUserComponent(e,t,this.agGridDefaults,this.jsComps),null}getSelector(e){return this.selectors[e]}getIcon(e){return this.icons[e]}getDynamicError(e,t){return t?Hn(279,{name:e}):this.beans.validation?.missingDynamicBean(e)??Hn(256)}},SU=23,xU=class extends F{constructor(){super(...arguments),this.beanName="ctrlsSvc",this.params={},this.ready=!1,this.readyCallbacks=[]}postConstruct(){this.addEventListener("ready",()=>{if(this.updateReady(),this.ready){for(let e of this.readyCallbacks)e(this.params);this.readyCallbacks.length=0}},this.beans.frameworkOverrides.runWhenReadyAsync?.()??!1)}updateReady(){let e=Object.values(this.params);this.ready=e.length===SU&&e.every(t=>t?.isAlive()??!1)}whenReady(e,t){this.ready?t(this.params):this.readyCallbacks.push(t),e.addDestroyFunc(()=>{let i=this.readyCallbacks.indexOf(t);i>=0&&this.readyCallbacks.splice(i,1)})}register(e,t){this.params[e]=t,this.updateReady(),this.ready&&this.dispatchLocalEvent({type:"ready"}),t.addDestroyFunc(()=>{this.updateReady()})}get(e){return this.params[e]}getGridBodyCtrl(){return this.params.gridBodyCtrl}getHeaderRowContainerCtrls(){let{leftHeader:e,centerHeader:t,rightHeader:i}=this.params;return[e,i,t]}getHeaderRowContainerCtrl(e){let t=this.params;switch(e){case"left":return t.leftHeader;case"right":return t.rightHeader;default:return t.centerHeader}}getScrollFeature(){return this.getGridBodyCtrl().scrollFeature}},EU='.ag-aria-description-container{border:0;z-index:9999;clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px}.ag-unselectable{-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-selectable{-webkit-user-select:text;-moz-user-select:text;user-select:text}.ag-tab-guard{display:block;height:0;position:absolute;width:0}:where(.ag-virtual-list-viewport) .ag-tab-guard{position:sticky}.ag-tab-guard-top{top:1px}.ag-tab-guard-bottom{bottom:1px}.ag-shake-left-to-right{animation-direction:alternate;animation-duration:.2s;animation-iteration-count:infinite;animation-name:ag-shake-left-to-right}@keyframes ag-shake-left-to-right{0%{padding-left:6px;padding-right:2px}to{padding-left:2px;padding-right:6px}}.ag-body-horizontal-scroll-viewport,.ag-body-vertical-scroll-viewport,.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport,.ag-virtual-list-viewport{flex:1 1 auto;height:100%;min-width:0;overflow:hidden;position:relative}.ag-viewport{position:relative}.ag-spanning-container{position:absolute;top:0;z-index:1}.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport{overflow-x:auto;-ms-overflow-style:none!important;scrollbar-width:none!important;&::-webkit-scrollbar{display:none!important}}.ag-body-viewport{display:flex;overflow-x:hidden;&:where(.ag-layout-normal){overflow-y:auto;-webkit-overflow-scrolling:touch}}.ag-floating-bottom-container,.ag-floating-top-container,.ag-sticky-bottom-container,.ag-sticky-top-container{min-height:1px}.ag-center-cols-viewport{min-height:100%;width:100%}.ag-body-horizontal-scroll-viewport{overflow-x:scroll}.ag-body-vertical-scroll-viewport{overflow-y:scroll}.ag-virtual-list-viewport{overflow:auto;width:100%}.ag-body-container,.ag-body-horizontal-scroll-container,.ag-body-vertical-scroll-container,.ag-center-cols-container,.ag-floating-bottom-container,.ag-floating-bottom-full-width-container,.ag-floating-top-container,.ag-full-width-container,.ag-header-container,.ag-pinned-left-cols-container,.ag-pinned-right-cols-container,.ag-sticky-bottom-container,.ag-sticky-top-container,.ag-virtual-list-container{position:relative}.ag-floating-bottom-container,.ag-floating-top-container,.ag-header-container,.ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top,.ag-sticky-bottom-container,.ag-sticky-top-container{height:100%;white-space:nowrap}.ag-center-cols-container,.ag-pinned-right-cols-container{display:block}.ag-body-horizontal-scroll-container{height:100%}.ag-body-vertical-scroll-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container,.ag-full-width-container,.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{pointer-events:none;position:absolute;top:0}:where(.ag-ltr) .ag-floating-bottom-full-width-container,:where(.ag-ltr) .ag-floating-top-full-width-container,:where(.ag-ltr) .ag-full-width-container,:where(.ag-ltr) .ag-sticky-bottom-full-width-container,:where(.ag-ltr) .ag-sticky-top-full-width-container{left:0}:where(.ag-rtl) .ag-floating-bottom-full-width-container,:where(.ag-rtl) .ag-floating-top-full-width-container,:where(.ag-rtl) .ag-full-width-container,:where(.ag-rtl) .ag-sticky-bottom-full-width-container,:where(.ag-rtl) .ag-sticky-top-full-width-container{right:0}.ag-full-width-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container{display:inline-block;height:100%;overflow:hidden;width:100%}.ag-virtual-list-container{overflow:hidden}.ag-body{display:flex;flex:1 1 auto;flex-direction:row!important;min-height:0;position:relative}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:flex;min-height:0;min-width:0;position:relative;&:where(.ag-scrollbar-invisible){bottom:0;position:absolute;&:where(.ag-apple-scrollbar){opacity:0;transition:opacity .4s;visibility:hidden;&:where(.ag-scrollbar-scrolling,.ag-scrollbar-active){opacity:1;visibility:visible}}}}.ag-body-horizontal-scroll{width:100%;&:where(.ag-scrollbar-invisible){left:0;right:0}}.ag-body-vertical-scroll{height:100%;&:where(.ag-scrollbar-invisible){top:0;z-index:10}}:where(.ag-ltr) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){right:0}}:where(.ag-rtl) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){left:0}}.ag-force-vertical-scroll{overflow-y:scroll!important}.ag-horizontal-left-spacer,.ag-horizontal-right-spacer{height:100%;min-width:0;overflow-x:scroll;&:where(.ag-scroller-corner){overflow-x:hidden}}:where(.ag-row-animation) .ag-row{transition:transform .4s,top .4s,opacity .2s;&:where(.ag-after-created){transition:transform .4s,top .4s,height .4s,opacity .2s}}:where(.ag-row-animation.ag-prevent-animation) .ag-row{transition:none!important;&:where(.ag-row.ag-after-created){transition:none!important}}:where(.ag-row-no-animation) .ag-row{transition:none}.ag-row-loading{align-items:center;display:flex}.ag-row-position-absolute{position:absolute}.ag-row-position-relative{position:relative}.ag-full-width-row{overflow:hidden;pointer-events:all}.ag-row-inline-editing{z-index:1}.ag-row-dragging{z-index:2}.ag-stub-cell{align-items:center;display:flex}.ag-cell{display:inline-block;height:100%;position:absolute;white-space:nowrap;&:focus-visible{box-shadow:none}}.ag-cell-value{flex:1 1 auto}.ag-cell-value:not(.ag-allow-overflow),.ag-group-value{overflow:hidden;text-overflow:ellipsis}.ag-cell-wrap-text{white-space:normal;word-break:break-word}:where(.ag-cell) .ag-icon{display:inline-block;vertical-align:middle}.ag-floating-top{display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}:where(.ag-floating-top:not(.ag-invisible)){border-bottom:var(--ag-pinned-row-border)}.ag-floating-bottom{display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}:where(.ag-floating-bottom:not(.ag-invisible)){border-top:var(--ag-pinned-row-border)}.ag-sticky-bottom,.ag-sticky-top{background-color:var(--ag-data-background-color);display:flex;height:0;overflow:hidden;position:absolute;width:100%;z-index:1}.ag-opacity-zero{opacity:0!important}.ag-cell-label-container{align-items:center;display:flex;flex-direction:row-reverse;height:100%;justify-content:space-between;width:100%}:where(.ag-right-aligned-header){.ag-cell-label-container{flex-direction:row}.ag-header-cell-text{text-align:end}}.ag-column-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr){direction:ltr;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row}}:where(.ag-rtl){direction:rtl;text-align:right;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row-reverse}.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{display:block}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(180deg)}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(-180deg)}}.ag-measurement-container{height:0;overflow:hidden;visibility:hidden;width:0}.ag-measurement-element-border{display:inline-block;&:before{border-left:var(--ag-internal-measurement-border);content:"";display:block}}.ag-group{position:relative;width:100%}.ag-group-title-bar{align-items:center;display:flex;padding:var(--ag-spacing)}.ag-group-title{display:inline;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:where(.ag-group-title-bar) .ag-group-title{cursor:default}.ag-group-toolbar{align-items:center;display:flex;padding:var(--ag-spacing)}.ag-group-container{display:flex}.ag-disabled .ag-group-container{pointer-events:none}.ag-disabled-group-container,.ag-disabled-group-title-bar{opacity:.5}.ag-group-container-horizontal{flex-flow:row wrap}.ag-group-container-vertical{flex-direction:column}.ag-group-title-bar-icon{cursor:pointer;flex:none}:where(.ag-ltr) .ag-group-title-bar-icon{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-group-title-bar-icon{margin-left:var(--ag-spacing)}:where(.ag-group-item-alignment-stretch) .ag-group-item{align-items:stretch}:where(.ag-group-item-alignment-start) .ag-group-item{align-items:flex-start}:where(.ag-group-item-alignment-end) .ag-group-item{align-items:flex-end}:where(.ag-ltr) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-left:var(--ag-row-group-indent-size)}:where(.ag-rtl) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-right:var(--ag-row-group-indent-size)}:where(.ag-ltr) .ag-row-group-leaf-indent{margin-left:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}:where(.ag-rtl) .ag-row-group-leaf-indent{margin-right:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}.ag-value-change-delta{padding:0 2px}.ag-value-change-delta-up{color:var(--ag-value-change-delta-up-color)}.ag-value-change-delta-down{color:var(--ag-value-change-delta-down-color)}.ag-value-change-value{background-color:transparent;border-radius:1px;padding-left:1px;padding-right:1px;transition:background-color 1s}.ag-value-change-value-highlight{background-color:var(--ag-value-change-value-highlight-background-color);transition:background-color .1s}.ag-cell-data-changed{background-color:var(--ag-value-change-value-highlight-background-color)!important}.ag-cell-data-changed-animation{background-color:transparent}.ag-cell-highlight{background-color:var(--ag-range-selection-highlight-color)!important}.ag-row,.ag-spanned-row{color:var(--ag-cell-text-color);font-family:var(--ag-cell-font-family);font-size:var(--ag-data-font-size);white-space:nowrap;--ag-internal-content-line-height:calc(min(var(--ag-row-height), var(--ag-line-height, 1000px)) - var(--ag-internal-row-border-width, 1px) - 2px)}.ag-row{background-color:var(--ag-data-background-color);border-bottom:var(--ag-row-border);height:var(--ag-row-height);width:100%;&.ag-row-editing-invalid{background-color:var(--ag-full-row-edit-invalid-background-color)}}:where(.ag-body-vertical-content-no-gap>div>div>div,.ag-body-vertical-content-no-gap>div>div>div>div)>.ag-row-last{border-bottom-color:transparent}.ag-sticky-bottom{border-top:var(--ag-row-border);box-sizing:content-box!important}.ag-group-contracted,.ag-group-expanded{cursor:pointer}.ag-cell,.ag-full-width-row .ag-cell-wrapper.ag-row-group{border:1px solid transparent;line-height:var(--ag-internal-content-line-height);-webkit-font-smoothing:subpixel-antialiased}:where(.ag-ltr) .ag-cell{border-right:var(--ag-column-border)}:where(.ag-rtl) .ag-cell{border-left:var(--ag-column-border)}.ag-spanned-cell-wrapper{background-color:var(--ag-data-background-color);position:absolute}.ag-spanned-cell-wrapper>.ag-spanned-cell{display:block;position:relative}:where(.ag-ltr) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-right-color:transparent}:where(.ag-rtl) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-left-color:transparent}.ag-cell-wrapper{align-items:center;display:flex;>:where(:not(.ag-cell-value,.ag-group-value)){align-items:center;display:flex;height:var(--ag-internal-content-line-height)}&:where(.ag-row-group){align-items:flex-start}:where(.ag-full-width-row) &:where(.ag-row-group){align-items:center;height:100%}}:where(.ag-ltr) .ag-cell-wrapper{padding-left:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-rtl) .ag-cell-wrapper{padding-right:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-cell-wrap-text:not(.ag-cell-auto-height)) .ag-cell-wrapper{align-items:normal;height:100%;:where(.ag-cell-value){height:100%}}:where(.ag-ltr) .ag-row>.ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}:where(.ag-rtl) .ag-row>.ag-cell-wrapper.ag-row-group{padding-right:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-cell-focus:not(.ag-cell-range-selected):focus-within,.ag-cell-range-single-cell,.ag-cell-range-single-cell.ag-cell-range-handle,.ag-context-menu-open .ag-cell-focus:not(.ag-cell-range-selected),.ag-context-menu-open .ag-full-width-row.ag-row-focus .ag-cell-wrapper.ag-row-group,.ag-full-width-row.ag-row-focus:focus .ag-cell-wrapper.ag-row-group{border:1px solid;border-color:var(--ag-range-selection-border-color);border-style:var(--ag-range-selection-border-style);outline:initial}.ag-full-width-row.ag-row-focus:focus{box-shadow:none}:where(.ag-ltr) .ag-group-contracted,:where(.ag-ltr) .ag-group-expanded,:where(.ag-ltr) .ag-row-drag,:where(.ag-ltr) .ag-selection-checkbox{margin-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-group-contracted,:where(.ag-rtl) .ag-group-expanded,:where(.ag-rtl) .ag-row-drag,:where(.ag-rtl) .ag-selection-checkbox{margin-left:var(--ag-cell-widget-spacing)}:where(.ag-ltr) .ag-group-child-count{margin-left:3px}:where(.ag-rtl) .ag-group-child-count{margin-right:3px}.ag-row-highlight-above:after,.ag-row-highlight-below:after,.ag-row-highlight-inside:after{background-color:var(--ag-range-selection-border-color);content:"";height:1px;pointer-events:none;position:absolute;width:calc(100% - 1px)}:where(.ag-ltr) .ag-row-highlight-above:after,:where(.ag-ltr) .ag-row-highlight-below:after,:where(.ag-ltr) .ag-row-highlight-inside:after{left:1px}:where(.ag-rtl) .ag-row-highlight-above:after,:where(.ag-rtl) .ag-row-highlight-below:after,:where(.ag-rtl) .ag-row-highlight-inside:after{right:1px}.ag-row-highlight-above:after{top:0}.ag-row-highlight-below:after{bottom:0}.ag-row-highlight-indent:after{display:block;width:auto}:where(.ag-ltr) .ag-row-highlight-indent:after{left:calc((var(--ag-cell-widget-spacing) + var(--ag-icon-size))*2 + var(--ag-cell-horizontal-padding) + var(--ag-row-highlight-level)*var(--ag-row-group-indent-size));right:1px}:where(.ag-rtl) .ag-row-highlight-indent:after{left:1px;right:calc((var(--ag-cell-widget-spacing) + var(--ag-icon-size))*2 + var(--ag-cell-horizontal-padding) + var(--ag-row-highlight-level)*var(--ag-row-group-indent-size))}.ag-row-highlight-inside:after{background-color:var(--ag-selected-row-background-color);border:1px solid var(--ag-range-selection-border-color);display:block;height:auto;inset:0;width:auto}.ag-body,.ag-floating-bottom,.ag-floating-top{background-color:var(--ag-data-background-color)}.ag-row-odd{background-color:var(--ag-odd-row-background-color)}.ag-row-selected:before{background-color:var(--ag-selected-row-background-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-full-width-row.ag-row-group:before,.ag-row-hover:not(.ag-full-width-row):before{background-color:var(--ag-row-hover-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-row-selected:before{background-color:var(--ag-row-hover-color);background-image:linear-gradient(var(--ag-selected-row-background-color),var(--ag-selected-row-background-color))}.ag-row.ag-full-width-row.ag-row-group>*{position:relative}.ag-column-hover{background-color:var(--ag-column-hover-color)}.ag-header-range-highlight{background-color:var(--ag-range-header-highlight-color)}.ag-right-aligned-cell{font-variant-numeric:tabular-nums}:where(.ag-ltr) .ag-right-aligned-cell{text-align:right}:where(.ag-rtl) .ag-right-aligned-cell{text-align:left}.ag-right-aligned-cell .ag-cell-value,.ag-right-aligned-cell .ag-group-value{margin-left:auto}:where(.ag-ltr) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-ltr) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level));padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}:where(.ag-rtl) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-rtl) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-row>.ag-cell-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}.ag-row-dragging{cursor:move;opacity:.5}.ag-details-row{background-color:var(--ag-data-background-color);padding:calc(var(--ag-spacing)*3.75)}.ag-layout-auto-height,.ag-layout-print{.ag-center-cols-container,.ag-center-cols-viewport{min-height:150px}}.ag-overlay-loading-wrapper{background-color:var(--ag-modal-overlay-background-color)}.ag-skeleton-container{align-content:center;height:100%;width:100%}.ag-skeleton-effect{animation:ag-skeleton-loading 1.5s ease-in-out .5s infinite;background-color:var(--ag-row-loading-skeleton-effect-color);border-radius:.25rem;height:1em;width:100%}:where(.ag-ltr) .ag-right-aligned-cell .ag-skeleton-effect{margin-left:auto}:where(.ag-rtl) .ag-right-aligned-cell .ag-skeleton-effect{margin-right:auto}@keyframes ag-skeleton-loading{0%{background-color:var(--ag-row-loading-skeleton-effect-color)}50%{background-color:color-mix(in srgb,transparent,var(--ag-row-loading-skeleton-effect-color) 40%)}to{background-color:var(--ag-row-loading-skeleton-effect-color)}}.ag-loading{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-loading{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-loading{padding-right:var(--ag-cell-horizontal-padding)}:where(.ag-ltr) .ag-loading-icon{padding-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-loading-icon{padding-left:var(--ag-cell-widget-spacing)}.ag-icon-loading{animation-duration:1s;animation-iteration-count:infinite;animation-name:spin;animation-timing-function:linear}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.ag-header{background-color:var(--ag-header-background-color);border-bottom:var(--ag-header-row-border);color:var(--ag-header-text-color);display:flex;font-family:var(--ag-header-font-family);font-size:var(--ag-header-font-size);font-weight:var(--ag-header-font-weight);overflow:hidden;white-space:nowrap;width:100%}.ag-header-row{height:var(--ag-header-height);position:absolute}.ag-floating-filter-button-button,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,:where(.ag-header-cell-sortable) .ag-header-cell-label{cursor:pointer}:where(.ag-ltr) .ag-header-expand-icon{margin-left:4px}:where(.ag-rtl) .ag-header-expand-icon{margin-right:4px}.ag-header-row:where(:not(:first-child)){:where(.ag-header-cell:not(.ag-header-span-height.ag-header-span-total,.ag-header-parent-hidden),.ag-header-group-cell.ag-header-group-cell-with-group){border-top:var(--ag-header-row-border)}}.ag-header-row:where(:not(.ag-header-row-column-group)){overflow:hidden}:where(.ag-header.ag-header-allow-overflow) .ag-header-row{overflow:visible}.ag-header-cell{display:inline-flex;overflow:hidden}.ag-header-group-cell{contain:paint;display:flex}.ag-header-cell,.ag-header-group-cell{align-items:center;gap:var(--ag-cell-widget-spacing);height:100%;padding:0 var(--ag-cell-horizontal-padding);position:absolute}@property --ag-internal-moving-color{syntax:"<color>";inherits:false;initial-value:transparent}@property --ag-internal-hover-color{syntax:"<color>";inherits:false;initial-value:transparent}.ag-header-cell:where(:not(.ag-floating-filter)),.ag-header-group-cell{&:before{background-image:linear-gradient(var(--ag-internal-hover-color),var(--ag-internal-hover-color)),linear-gradient(var(--ag-internal-moving-color),var(--ag-internal-moving-color));content:"";inset:0;position:absolute;--ag-internal-moving-color:transparent;--ag-internal-hover-color:transparent;transition:--ag-internal-moving-color var(--ag-header-cell-background-transition-duration),--ag-internal-hover-color var(--ag-header-cell-background-transition-duration)}&:where(:hover):before{--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}&:where(.ag-header-cell-moving):before{--ag-internal-moving-color:var(--ag-header-cell-moving-background-color);--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}}:where(.ag-header-cell:not(.ag-floating-filter) *,.ag-header-group-cell *){position:relative;z-index:1}.ag-header-cell-menu-button:where(:not(.ag-header-menu-always-show)){opacity:0;transition:opacity .2s}.ag-header-cell-filter-button,:where(.ag-header-cell.ag-header-active) .ag-header-cell-menu-button{opacity:1}.ag-header-cell-label,.ag-header-group-cell-label{align-items:center;align-self:stretch;display:flex;flex:1 1 auto;overflow:hidden;padding:5px 0}:where(.ag-ltr) .ag-sort-indicator-icon{padding-left:var(--ag-spacing)}:where(.ag-rtl) .ag-sort-indicator-icon{padding-right:var(--ag-spacing)}.ag-header-cell-label{text-overflow:ellipsis}.ag-header-group-cell-label.ag-sticky-label{flex:none;max-width:100%;overflow:visible;position:sticky}:where(.ag-ltr) .ag-header-group-cell-label.ag-sticky-label{left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-header-group-cell-label.ag-sticky-label{right:var(--ag-cell-horizontal-padding)}.ag-header-cell-text,.ag-header-group-text{overflow:hidden;text-overflow:ellipsis}.ag-header-cell-text{word-break:break-word}.ag-header-cell-comp-wrapper{width:100%}:where(.ag-header-group-cell) .ag-header-cell-comp-wrapper{display:flex}:where(.ag-header-cell:not(.ag-header-cell-auto-height)) .ag-header-cell-comp-wrapper{align-items:center;display:flex;height:100%}.ag-header-cell-wrap-text .ag-header-cell-comp-wrapper{white-space:normal}.ag-header-cell-comp-wrapper-limited-height>*{overflow:hidden}:where(.ag-right-aligned-header) .ag-header-cell-label{flex-direction:row-reverse}:where(.ag-ltr) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-ltr) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}.ag-header-cell:after,.ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{content:"";height:var(--ag-header-column-border-height);position:absolute;top:calc(50% - var(--ag-header-column-border-height)*.5);z-index:1}:where(.ag-ltr) .ag-header-cell:after,:where(.ag-ltr) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-right:var(--ag-header-column-border);right:0}:where(.ag-rtl) .ag-header-cell:after,:where(.ag-rtl) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-left:var(--ag-header-column-border);left:0}.ag-header-highlight-after:after,.ag-header-highlight-before:after{background-color:var(--ag-accent-color);content:"";height:100%;position:absolute;width:1px}:where(.ag-ltr) .ag-header-highlight-before:after{left:0}:where(.ag-rtl) .ag-header-highlight-before:after{right:0}:where(.ag-ltr) .ag-header-highlight-after:after{right:0;:where(.ag-pinned-left-header) &{right:1px}}:where(.ag-rtl) .ag-header-highlight-after:after{left:0;:where(.ag-pinned-left-header) &{left:1px}}.ag-header-cell-resize{align-items:center;cursor:ew-resize;display:flex;height:100%;position:absolute;top:0;width:8px;z-index:2;&:after{background-color:var(--ag-header-column-resize-handle-color);content:"";height:var(--ag-header-column-resize-handle-height);position:absolute;top:calc(50% - var(--ag-header-column-resize-handle-height)*.5);width:var(--ag-header-column-resize-handle-width);z-index:1}}:where(.ag-ltr) .ag-header-cell-resize{right:-3px;&:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-rtl) .ag-header-cell-resize{left:-3px;&:after{right:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-header-cell.ag-header-span-height) .ag-header-cell-resize:after{height:calc(100% - var(--ag-spacing)*4);top:calc(var(--ag-spacing)*2)}.ag-header-group-cell-no-group:where(.ag-header-span-height){display:none}.ag-sort-indicator-container{display:flex;gap:var(--ag-spacing)}.ag-layout-print{&.ag-body{display:block;height:unset}&.ag-root-wrapper{display:inline-block}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:none}&.ag-force-vertical-scroll{overflow-y:visible!important}}@media print{.ag-root-wrapper.ag-layout-print{display:table;.ag-body-horizontal-scroll-viewport,.ag-body-viewport,.ag-center-cols-container,.ag-center-cols-viewport,.ag-root,.ag-root-wrapper-body,.ag-virtual-list-viewport{display:block!important;height:auto!important;overflow:hidden!important}.ag-cell,.ag-row{-moz-column-break-inside:avoid;break-inside:avoid}}}ag-grid,ag-grid-angular{display:block}.ag-root-wrapper{border:var(--ag-wrapper-border);border-radius:var(--ag-wrapper-border-radius);display:flex;flex-direction:column;overflow:hidden;position:relative;&.ag-layout-normal{height:100%}}.ag-root-wrapper-body{display:flex;flex-direction:row;&.ag-layout-normal{flex:1 1 auto;height:0;min-height:0}}.ag-root{display:flex;flex-direction:column;position:relative;&.ag-layout-auto-height,&.ag-layout-normal{flex:1 1 auto;overflow:hidden;width:0}&.ag-layout-normal{height:100%}}.ag-virtual-list-item{height:var(--ag-list-item-height);position:absolute;width:100%}.ag-list-item-hovered:after{background-color:var(--ag-accent-color);content:"";height:1px;left:0;position:absolute;right:0}.ag-item-highlight-top:after{top:0}.ag-item-highlight-bottom:after{bottom:0}.ag-drag-handle{color:var(--ag-drag-handle-color);cursor:grab;:where(.ag-icon){color:var(--ag-drag-handle-color)}}.ag-chart-menu-icon,.ag-chart-settings-next,.ag-chart-settings-prev,.ag-column-group-icons,.ag-column-select-header-icon,.ag-filter-toolpanel-expand,.ag-floating-filter-button-button,.ag-group-title-bar-icon,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,.ag-panel-title-bar-button-icon,.ag-set-filter-group-icons,:where(.ag-group-contracted) .ag-icon,:where(.ag-group-expanded) .ag-icon{background-color:var(--ag-icon-button-background-color);border-radius:var(--ag-icon-button-border-radius);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-background-color);color:var(--ag-icon-button-color);&:hover{background-color:var(--ag-icon-button-hover-background-color);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-hover-background-color);color:var(--ag-icon-button-hover-color)}}.ag-filter-active{background-image:linear-gradient(var(--ag-icon-button-active-background-color),var(--ag-icon-button-active-background-color));border-radius:1px;outline:solid var(--ag-icon-button-background-spread) var(--ag-icon-button-active-background-color);position:relative;&:after{background-color:var(--ag-icon-button-active-indicator-color);border-radius:50%;content:"";height:6px;position:absolute;top:-1px;width:6px}:where(.ag-icon-filter){clip-path:path("M8,0C8,4.415 11.585,8 16,8L16,16L0,16L0,0L8,0Z");color:var(--ag-icon-button-active-color)}}:where(.ag-ltr) .ag-filter-active{&:after{right:-1px}}:where(.ag-rtl) .ag-filter-active{&:after{left:-1px}}.ag-menu{background-color:var(--ag-menu-background-color);border:var(--ag-menu-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-menu-shadow);color:var(--ag-menu-text-color);max-height:100%;overflow-y:auto;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}',RU={wrapperBorder:!0,rowBorder:!0,headerRowBorder:!0,footerRowBorder:{ref:"rowBorder"},columnBorder:{style:"solid",width:1,color:"transparent"},headerColumnBorder:!1,headerColumnBorderHeight:"100%",pinnedColumnBorder:!0,pinnedRowBorder:!0,sidePanelBorder:!0,sideBarPanelWidth:250,sideBarBackgroundColor:{ref:"chromeBackgroundColor"},sideButtonBarBackgroundColor:{ref:"sideBarBackgroundColor"},sideButtonBarTopPadding:0,sideButtonSelectedUnderlineWidth:2,sideButtonSelectedUnderlineColor:"transparent",sideButtonSelectedUnderlineTransitionDuration:0,sideButtonBackgroundColor:"transparent",sideButtonTextColor:{ref:"textColor"},sideButtonHoverBackgroundColor:{ref:"sideButtonBackgroundColor"},sideButtonHoverTextColor:{ref:"sideButtonTextColor"},sideButtonSelectedBackgroundColor:li,sideButtonSelectedTextColor:{ref:"sideButtonTextColor"},sideButtonBorder:"solid 1px transparent",sideButtonSelectedBorder:!0,sideButtonLeftPadding:{ref:"spacing"},sideButtonRightPadding:{ref:"spacing"},sideButtonVerticalPadding:{calc:"spacing * 3"},headerBackgroundColor:{ref:"chromeBackgroundColor"},headerFontFamily:{ref:"fontFamily"},cellFontFamily:{ref:"fontFamily"},headerFontWeight:500,headerFontSize:{ref:"fontSize"},dataFontSize:{ref:"fontSize"},headerTextColor:{ref:"textColor"},headerCellHoverBackgroundColor:"transparent",headerCellMovingBackgroundColor:{ref:"headerCellHoverBackgroundColor"},headerCellBackgroundTransitionDuration:"0.2s",cellTextColor:{ref:"textColor"},rangeSelectionBorderStyle:"solid",rangeSelectionBorderColor:At,rangeSelectionBackgroundColor:Pi(.2),rangeSelectionChartBackgroundColor:"#0058FF1A",rangeSelectionChartCategoryBackgroundColor:"#00FF841A",rangeSelectionHighlightColor:Pi(.5),rangeHeaderHighlightColor:sH(.08),rowNumbersSelectedColor:Pi(.5),rowHoverColor:Pi(.08),columnHoverColor:Pi(.05),selectedRowBackgroundColor:Pi(.12),modalOverlayBackgroundColor:{ref:"backgroundColor",mix:.66},dataBackgroundColor:li,oddRowBackgroundColor:{ref:"dataBackgroundColor"},wrapperBorderRadius:8,cellHorizontalPadding:{calc:"spacing * 2 * cellHorizontalPaddingScale"},cellWidgetSpacing:{calc:"spacing * 1.5"},cellHorizontalPaddingScale:1,rowGroupIndentSize:{calc:"cellWidgetSpacing + iconSize"},valueChangeDeltaUpColor:"#43a047",valueChangeDeltaDownColor:"#e53935",valueChangeValueHighlightBackgroundColor:"#16a08580",rowHeight:{calc:"max(iconSize, dataFontSize) + spacing * 3.25 * rowVerticalPaddingScale"},rowVerticalPaddingScale:1,headerHeight:{calc:"max(iconSize, dataFontSize) + spacing * 4 * headerVerticalPaddingScale"},headerVerticalPaddingScale:1,paginationPanelHeight:{ref:"rowHeight",calc:"max(rowHeight, 22px)"},dragHandleColor:qi(.7),headerColumnResizeHandleHeight:"30%",headerColumnResizeHandleWidth:2,headerColumnResizeHandleColor:{ref:"borderColor"},widgetContainerHorizontalPadding:{calc:"spacing * 1.5"},widgetContainerVerticalPadding:{calc:"spacing * 1.5"},widgetHorizontalSpacing:{calc:"spacing * 1.5"},widgetVerticalSpacing:{ref:"spacing"},iconButtonColor:{ref:"iconColor"},iconButtonBackgroundColor:"transparent",iconButtonBackgroundSpread:4,iconButtonBorderRadius:1,iconButtonHoverColor:{ref:"iconButtonColor"},iconButtonHoverBackgroundColor:qi(.1),iconButtonActiveColor:At,iconButtonActiveBackgroundColor:Pi(.28),iconButtonActiveIndicatorColor:At,menuBorder:{color:qi(.2)},menuBackgroundColor:ai(.03),menuTextColor:ai(.95),menuShadow:{ref:"popupShadow"},menuSeparatorColor:{ref:"borderColor"},setFilterIndentSize:{ref:"iconSize"},chartMenuPanelWidth:260,chartMenuLabelColor:qi(.8),dialogShadow:{ref:"popupShadow"},cellEditingBorder:{color:At},cellEditingShadow:{ref:"cardShadow"},fullRowEditInvalidBackgroundColor:{ref:"invalidColor",onto:"backgroundColor",mix:.25},dialogBorder:{color:qi(.2)},panelBackgroundColor:li,panelTitleBarHeight:{ref:"headerHeight"},panelTitleBarBackgroundColor:{ref:"headerBackgroundColor"},panelTitleBarIconColor:{ref:"headerTextColor"},panelTitleBarTextColor:{ref:"headerTextColor"},panelTitleBarFontWeight:{ref:"headerFontWeight"},panelTitleBarBorder:!0,columnSelectIndentSize:{ref:"iconSize"},toolPanelSeparatorBorder:!0,columnDropCellBackgroundColor:qi(.07),columnDropCellTextColor:{ref:"textColor"},columnDropCellDragHandleColor:{ref:"textColor"},columnDropCellBorder:{color:qi(.13)},selectCellBackgroundColor:qi(.07),selectCellBorder:{color:qi(.13)},advancedFilterBuilderButtonBarBorder:!0,advancedFilterBuilderIndentSize:{calc:"spacing * 2 + iconSize"},advancedFilterBuilderJoinPillColor:"#f08e8d",advancedFilterBuilderColumnPillColor:"#a6e194",advancedFilterBuilderOptionPillColor:"#f3c08b",advancedFilterBuilderValuePillColor:"#85c0e4",filterPanelApplyButtonColor:li,filterPanelApplyButtonBackgroundColor:At,filterPanelCardSubtleColor:{ref:"textColor",mix:.7},filterPanelCardSubtleHoverColor:{ref:"textColor"},findMatchColor:Sa,findMatchBackgroundColor:"#ffff00",findActiveMatchColor:Sa,findActiveMatchBackgroundColor:"#ffa500",filterToolPanelGroupIndent:{ref:"spacing"},rowLoadingSkeletonEffectColor:qi(.15),statusBarLabelColor:Sa,statusBarLabelFontWeight:500,statusBarValueColor:Sa,statusBarValueFontWeight:500,pinnedSourceRowTextColor:{ref:"textColor"},pinnedSourceRowBackgroundColor:{ref:"dataBackgroundColor"},pinnedSourceRowFontWeight:600,pinnedRowFontWeight:600,pinnedRowBackgroundColor:{ref:"dataBackgroundColor"},pinnedRowTextColor:{ref:"textColor"}},MU=".ag-cell-batch-edit{background-color:var(--ag-cell-batch-edit-background-color);color:var(--ag-cell-batch-edit-text-color);display:inherit}.ag-row-batch-edit{background-color:var(--ag-row-batch-edit-background-color);color:var(--ag-row-batch-edit-text-color)}",IM={cellBatchEditBackgroundColor:"rgba(220 181 139 / 16%)",cellBatchEditTextColor:"#422f00",rowBatchEditBackgroundColor:{ref:"cellBatchEditBackgroundColor"},rowBatchEditTextColor:{ref:"cellBatchEditTextColor"}},DU=O(b({},IM),{cellBatchEditTextColor:"#f3d0b3"}),kU=()=>Ii({feature:"batchEditStyle",params:IM,css:MU}),PU=kU(),_M=":where(.ag-button){background:none;border:none;color:inherit;cursor:pointer;font-family:inherit;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0;text-indent:inherit;text-shadow:inherit;text-transform:inherit;word-spacing:inherit;&:disabled{cursor:default}&:focus-visible{box-shadow:var(--ag-focus-shadow);outline:none}}.ag-standard-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:var(--ag-button-background-color);border:var(--ag-button-border);border-radius:var(--ag-button-border-radius);color:var(--ag-button-text-color);cursor:pointer;font-weight:var(--ag-button-font-weight);padding:var(--ag-button-vertical-padding) var(--ag-button-horizontal-padding);&:hover{background-color:var(--ag-button-hover-background-color);border:var(--ag-button-hover-border);color:var(--ag-button-hover-text-color)}&:active{background-color:var(--ag-button-active-background-color);border:var(--ag-button-active-border);color:var(--ag-button-active-text-color)}&:disabled{background-color:var(--ag-button-disabled-background-color);border:var(--ag-button-disabled-border);color:var(--ag-button-disabled-text-color)}}",LM={buttonTextColor:"inherit",buttonFontWeight:"normal",buttonBackgroundColor:"transparent",buttonBorder:!1,buttonBorderRadius:{ref:"borderRadius"},buttonHorizontalPadding:{calc:"spacing * 2"},buttonVerticalPadding:{ref:"spacing"},buttonHoverTextColor:{ref:"buttonTextColor"},buttonHoverBackgroundColor:{ref:"buttonBackgroundColor"},buttonHoverBorder:{ref:"buttonBorder"},buttonActiveTextColor:{ref:"buttonHoverTextColor"},buttonActiveBackgroundColor:{ref:"buttonHoverBackgroundColor"},buttonActiveBorder:{ref:"buttonHoverBorder"},buttonDisabledTextColor:{ref:"inputDisabledTextColor"},buttonDisabledBackgroundColor:{ref:"inputDisabledBackgroundColor"},buttonDisabledBorder:{ref:"inputDisabledBorder"}};var FU=()=>Ii({feature:"buttonStyle",params:O(b({},LM),{buttonBackgroundColor:li,buttonBorder:!0,buttonHoverBackgroundColor:{ref:"rowHoverColor"},buttonActiveBorder:{color:At}}),css:_M}),TU=FU(),AU=()=>Ii({feature:"buttonStyle",params:O(b({},LM),{buttonBackgroundColor:li,buttonBorder:{color:At},buttonFontWeight:600,buttonTextColor:At,buttonHoverBackgroundColor:{ref:"rowHoverColor"},buttonActiveBackgroundColor:At,buttonActiveTextColor:li}),css:_M}),IU=AU();var _U=".ag-column-drop-vertical-empty-message{align-items:center;border:dashed var(--ag-border-width);border-color:var(--ag-border-color);display:flex;inset:0;justify-content:center;margin:calc(var(--ag-spacing)*1.5) calc(var(--ag-spacing)*2);overflow:hidden;padding:calc(var(--ag-spacing)*2);position:absolute}";var LU=()=>Ii({feature:"columnDropStyle",css:_U}),uw=LU();var OU={warn:(...e)=>{I(e[0],e[1])},error:(...e)=>{Ge(e[0],e[1])},preInitErr:(...e)=>{Cd(e[0],e[2],e[1])}},OM=()=>fH(OU).withParams(RU).withPart(TU).withPart(uw).withPart(PU),NU='.ag-checkbox-input-wrapper,.ag-radio-button-input-wrapper{background-color:var(--ag-checkbox-unchecked-background-color);border:solid var(--ag-checkbox-border-width) var(--ag-checkbox-unchecked-border-color);flex:none;height:var(--ag-icon-size);position:relative;width:var(--ag-icon-size);:where(input){-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:block;height:var(--ag-icon-size);margin:0;opacity:0;width:var(--ag-icon-size)}&:after{content:"";display:block;inset:0;-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;pointer-events:none;position:absolute}&:where(.ag-checked){background-color:var(--ag-checkbox-checked-background-color);border-color:var(--ag-checkbox-checked-border-color);&:after{background-color:var(--ag-checkbox-checked-shape-color)}}&:where(:focus-within,:active){box-shadow:var(--ag-focus-shadow)}&:where(.ag-disabled){filter:grayscale();opacity:.5}}.ag-checkbox-input-wrapper{border-radius:var(--ag-checkbox-border-radius);&:where(.ag-checked):after{-webkit-mask-image:var(--ag-checkbox-checked-shape-image);mask-image:var(--ag-checkbox-checked-shape-image)}&:where(.ag-indeterminate){background-color:var(--ag-checkbox-indeterminate-background-color);border-color:var(--ag-checkbox-indeterminate-border-color);&:after{background-color:var(--ag-checkbox-indeterminate-shape-color);-webkit-mask-image:var(--ag-checkbox-indeterminate-shape-image);mask-image:var(--ag-checkbox-indeterminate-shape-image)}}}.ag-cell-editing-error .ag-checkbox-input-wrapper:focus-within{box-shadow:var(--ag-focus-error-shadow)}.ag-radio-button-input-wrapper{border-radius:100%;&:where(.ag-checked):after{-webkit-mask-image:var(--ag-radio-checked-shape-image);mask-image:var(--ag-radio-checked-shape-image)}}',BU=()=>Ii({feature:"checkboxStyle",params:{checkboxBorderWidth:1,checkboxBorderRadius:{ref:"borderRadius"},checkboxUncheckedBackgroundColor:li,checkboxUncheckedBorderColor:ai(.3),checkboxCheckedBackgroundColor:At,checkboxCheckedBorderColor:{ref:"checkboxCheckedBackgroundColor"},checkboxCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="7" fill="none"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75" d="M1 3.5 3.5 6l5-5"/></svg>'},checkboxCheckedShapeColor:li,checkboxIndeterminateBackgroundColor:ai(.3),checkboxIndeterminateBorderColor:{ref:"checkboxIndeterminateBackgroundColor"},checkboxIndeterminateShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="2" fill="none"><rect width="10" height="2" fill="#000" rx="1"/></svg>'},checkboxIndeterminateShapeColor:li,radioCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="6" height="6" fill="none"><circle cx="3" cy="3" r="3" fill="#000"/></svg>'}},css:NU}),NM=BU();var BM=()=>O(b(b({},qp),DU),{backgroundColor:"hsl(217, 0%, 17%)",foregroundColor:"#FFF",chromeBackgroundColor:ai(.05),rowHoverColor:Pi(.15),selectedRowBackgroundColor:Pi(.2),menuBackgroundColor:ai(.1),browserColorScheme:"dark",popupShadow:"0 0px 20px #000A",cardShadow:"0 1px 4px 1px #000A",advancedFilterBuilderJoinPillColor:"#7a3a37",advancedFilterBuilderColumnPillColor:"#355f2d",advancedFilterBuilderOptionPillColor:"#5a3168",advancedFilterBuilderValuePillColor:"#374c86",filterPanelApplyButtonColor:Sa,findMatchColor:li,findActiveMatchColor:li,checkboxUncheckedBorderColor:ai(.4),toggleButtonOffBackgroundColor:ai(.4),rowBatchEditBackgroundColor:ai(.1)});var HU=()=>O(b({},BM()),{backgroundColor:"#1f2836"});var VU=()=>Ii({feature:"colorScheme",params:qp,modeParams:{light:qp,dark:BM(),"dark-blue":HU()}}),HM=VU();var GU=`.ag-icon-aggregation:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M24 6H8v2l8 8-8 8v2h16v-2H11l8-8-8-8h13z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-arrows:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M7.515 11.171 2.687 16l4.828 4.829-1.414 1.414L-.142 16l6.243-6.243zm16.97 0 1.414-1.414L32.142 16l-6.243 6.243-1.414-1.414L29.313 16zM16.028 13.2l2.829 2.828-2.829 2.829-2.828-2.829zm-4.857 11.285L16 29.313l4.829-4.828 1.414 1.414L16 32.142l-6.243-6.243zm0-16.97L9.757 6.101 16-.142l6.243 6.243-1.414 1.414L16 2.687z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-asc:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m5.333 16 1.88 1.88 7.453-7.44v16.227h2.667V10.44l7.44 7.453L26.666 16 15.999 5.333 5.332 16z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-cancel:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M16 2.667A13.32 13.32 0 0 0 2.667 16c0 7.373 5.96 13.333 13.333 13.333S29.333 23.373 29.333 16 23.373 2.667 16 2.667m6.667 18.12-1.88 1.88L16 17.88l-4.787 4.787-1.88-1.88L14.12 16l-4.787-4.787 1.88-1.88L16 14.12l4.787-4.787 1.88 1.88L17.88 16z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-chart:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Ctitle%3Echart%3C/title%3E%3Cg fill='%23000' fill-rule='nonzero'%3E%3Cpath d='M14 7h4v18h-4zM8 17h4v8H8zM20 13h4v12h-4z'/%3E%3C/g%3E%3C/svg%3E")}.ag-icon-color-picker:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M23.907 17.587 10.574 4.254l-1.88 1.88 3.173 3.173-8.28 8.28 10.16 10.16zm-16.547 0 6.387-6.387 6.387 6.387zm18.387 2s-2.667 2.893-2.667 4.667c0 1.467 1.2 2.667 2.667 2.667s2.667-1.2 2.667-2.667c0-1.773-2.667-4.667-2.667-4.667' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-columns:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M26 25H6V7h20zM12 11H8v12h4zm6 0h-4v12h4zm6 12V11h-4v12z' style='fill-rule:nonzero' transform='translate(0 -1)'/%3E%3C/svg%3E")}.ag-icon-contracted:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m12 6 10 10-10 10-2-2 8-8-8-8z'/%3E%3C/svg%3E")}.ag-icon-copy:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M22 1.333H6A2.675 2.675 0 0 0 3.333 4v18.667H6V4h16zm4 5.334H11.333a2.675 2.675 0 0 0-2.667 2.667v18.667c0 1.467 1.2 2.667 2.667 2.667H26c1.467 0 2.667-1.2 2.667-2.667V9.334c0-1.467-1.2-2.667-2.667-2.667M26 28H11.333V9.333H26z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-cross:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M15.984 13.894 27.05 2.828l2.122 2.122-11.066 11.066 11.066 11.066-2.122 2.12-11.066-11.066L4.918 29.202l-2.12-2.12 11.066-11.066L2.798 4.95l2.12-2.122z'/%3E%3C/svg%3E")}.ag-icon-csv:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M384 131.9c-7.753-8.433-110.425-128.473-114.9-133L48-.1C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48zm-35.9 2.1H257V27.9zM30 479V27h200l1 105c0 13.3-1.3 29 12 29h111l1 318z' style='fill-rule:nonzero' transform='translate(3.934 -.054)scale(.06285)'/%3E%3Cpath d='M.688-.226a.2.2 0 0 1-.017.074.28.28 0 0 1-.145.14.412.412 0 0 1-.234.013.28.28 0 0 1-.202-.168.468.468 0 0 1-.04-.19q0-.086.025-.155a.319.319 0 0 1 .182-.191.4.4 0 0 1 .134-.025q.087 0 .155.035a.3.3 0 0 1 .104.085.17.17 0 0 1 .036.097.06.06 0 0 1-.018.044.06.06 0 0 1-.042.019.06.06 0 0 1-.042-.013.2.2 0 0 1-.031-.046.2.2 0 0 0-.066-.079.16.16 0 0 0-.095-.027.17.17 0 0 0-.142.068.3.3 0 0 0-.053.193.4.4 0 0 0 .023.139.2.2 0 0 0 .067.083.2.2 0 0 0 .1.027q.063 0 .106-.031a.2.2 0 0 0 .065-.091.2.2 0 0 1 .023-.046q.014-.018.044-.018a.06.06 0 0 1 .044.018.06.06 0 0 1 .019.045' style='fill-rule:nonzero' transform='matrix(8.39799 0 0 12.455 7.122 25.977)'/%3E%3Cpath d='M.622-.215a.2.2 0 0 1-.033.117.23.23 0 0 1-.098.081.4.4 0 0 1-.153.029.34.34 0 0 1-.175-.04.23.23 0 0 1-.079-.077.17.17 0 0 1-.031-.093q0-.027.019-.045a.06.06 0 0 1 .046-.019.06.06 0 0 1 .039.014.1.1 0 0 1 .027.044.3.3 0 0 0 .03.057q.015.023.044.038.03.015.076.015.065 0 .105-.03a.09.09 0 0 0 .04-.075.08.08 0 0 0-.022-.058.14.14 0 0 0-.056-.034 1 1 0 0 0-.092-.025.7.7 0 0 1-.129-.042.2.2 0 0 1-.083-.066.17.17 0 0 1-.03-.104q0-.058.032-.105a.2.2 0 0 1 .093-.07.4.4 0 0 1 .144-.025q.066 0 .114.016a.3.3 0 0 1 .08.044.2.2 0 0 1 .046.057q.015.03.015.058a.07.07 0 0 1-.018.046.06.06 0 0 1-.046.021q-.025 0-.038-.012a.2.2 0 0 1-.028-.041.2.2 0 0 0-.047-.063Q.387-.625.326-.625a.15.15 0 0 0-.09.025q-.035.024-.035.059 0 .021.012.037a.1.1 0 0 0 .032.027.4.4 0 0 0 .111.036q.06.015.11.031.048.018.083.042a.2.2 0 0 1 .054.062.2.2 0 0 1 .019.091' style='fill-rule:nonzero' transform='matrix(8.39799 0 0 12.455 13.339 25.977)'/%3E%3Cpath d='m.184-.633.162.48.163-.483q.013-.038.019-.053a.062.062 0 0 1 .061-.039q.018 0 .034.009a.1.1 0 0 1 .025.025q.009.015.009.031L.654-.64l-.007.025-.009.024-.173.468-.019.051a.2.2 0 0 1-.021.042.1.1 0 0 1-.033.03.1.1 0 0 1-.049.012.1.1 0 0 1-.05-.011A.1.1 0 0 1 .26-.03a.2.2 0 0 1-.021-.042L.22-.123.05-.587.041-.612.033-.638.03-.662q0-.025.02-.046a.07.07 0 0 1 .05-.02q.037 0 .053.023.015.023.031.072' style='fill-rule:nonzero' transform='matrix(8.39799 0 0 12.455 18.94 25.977)'/%3E%3C/svg%3E")}.ag-icon-cut:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M13.775 15.198 3.835 2.945a1.501 1.501 0 0 1 2.33-1.89l14.997 18.488A6.003 6.003 0 0 1 29.657 25c0 3.311-2.688 6-6 6s-6-2.689-6-6c0-1.335.437-2.569 1.176-3.566l-3.127-3.855-3.001 3.7A5.97 5.97 0 0 1 14 25c0 3.311-2.689 6-6 6s-6-2.689-6-6a6.003 6.003 0 0 1 8.315-5.536zm9.882 6.702a3.1 3.1 0 0 0-3.1 3.1c0 1.711 1.389 3.1 3.1 3.1s3.1-1.389 3.1-3.1-1.389-3.1-3.1-3.1M8 21.95a3.05 3.05 0 1 0 .001 6.101A3.05 3.05 0 0 0 8 21.95m9.63-11.505 1.932 2.381 8.015-9.881a1.5 1.5 0 0 0-2.329-1.89z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-desc:before,.ag-icon-down:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m26.667 16-1.88-1.88-7.453 7.44V5.333h-2.667V21.56l-7.44-7.453L5.334 16l10.667 10.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-excel:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M384 131.9c-7.753-8.433-110.425-128.473-114.9-133L48-.1C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48zm-35.9 2.1H257V27.9zM30 479V27h200l1 105c0 13.3-1.3 29 12 29h111l1 318z' style='fill-rule:nonzero' transform='translate(3.934 -.054)scale(.06285)'/%3E%3Cpath d='m.052-.139.16-.234-.135-.208a.4.4 0 0 1-.028-.052.1.1 0 0 1-.01-.042.05.05 0 0 1 .018-.037.07.07 0 0 1 .045-.016q.03 0 .047.018a1 1 0 0 1 .047.066l.107.174.115-.174.024-.038.019-.026.021-.015a.1.1 0 0 1 .027-.005.06.06 0 0 1 .044.016.05.05 0 0 1 .018.039q0 .033-.038.089l-.141.211.152.234a.3.3 0 0 1 .03.051.1.1 0 0 1 .009.038.1.1 0 0 1-.008.031.1.1 0 0 1-.024.023.1.1 0 0 1-.034.008.1.1 0 0 1-.035-.008.1.1 0 0 1-.023-.022L.427-.067.301-.265l-.134.204-.022.034-.016.019a.1.1 0 0 1-.022.015.1.1 0 0 1-.03.005.06.06 0 0 1-.044-.016.06.06 0 0 1-.017-.047q0-.036.036-.088' style='fill-rule:nonzero' transform='matrix(17.82892 0 0 16.50777 10.371 25.928)'/%3E%3C/svg%3E")}.ag-icon-expanded:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M20 26 10 16 20 6l2 2-8 8 8 8z'/%3E%3C/svg%3E")}.ag-icon-eye-slash:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Ctitle%3Eeye-slash%3C/title%3E%3Cpath fill='%23000' fill-rule='nonzero' d='M8.95 10.364 7 8.414 8.414 7l2.32 2.32A13.2 13.2 0 0 1 16.5 8c5.608 0 10.542 3.515 12.381 8.667L29 17l-.119.333a13 13 0 0 1-4.255 5.879l1.466 1.466-1.414 1.414-1.754-1.753A13.2 13.2 0 0 1 16.5 26c-5.608 0-10.542-3.515-12.381-8.667L4 17l.119-.333a13 13 0 0 1 4.83-6.303m1.445 1.445A11.02 11.02 0 0 0 6.148 17c1.646 4.177 5.728 7 10.352 7 1.76 0 3.441-.409 4.94-1.146l-1.878-1.878A5.06 5.06 0 0 1 16.5 22c-2.789 0-5.05-2.239-5.05-5 0-1.158.398-2.223 1.065-3.07zm1.855-.974 1.794 1.795A5.07 5.07 0 0 1 16.5 12c2.789 0 5.05 2.239 5.05 5 0 .9-.24 1.745-.661 2.474l2.305 2.306A11 11 0 0 0 26.852 17c-1.646-4.177-5.728-7-10.352-7-1.495 0-2.933.295-4.25.835'/%3E%3C/svg%3E")}.ag-icon-eye:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M16.5 23c4.624 0 8.706-2.823 10.352-7-1.646-4.177-5.728-7-10.352-7s-8.706 2.823-10.352 7c1.646 4.177 5.728 7 10.352 7M4.119 15.667C5.958 10.515 10.892 7 16.5 7s10.542 3.515 12.381 8.667L29 16l-.119.333C27.042 21.485 22.108 25 16.5 25S5.958 21.485 4.119 16.333L4 16zM16.5 21c2.789 0 5.049-2.239 5.049-5s-2.26-5-5.049-5-5.049 2.239-5.049 5 2.26 5 5.049 5' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-filter:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m28 8-8 8v5l-6 6V16L6 8V6h22zM9 8l7 7v7l2-2v-5l7-7z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-first:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M24.273 22.12 18.153 16l6.12-6.12L22.393 8l-8 8 8 8zM7.727 8h2.667v16H7.727z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-group:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M14 7v1H9V7zm0-3v1H5.001V4zm-7 7H5v-1h2zm0-3H5V7h2zM3 5H1V4h2zm11 5v1H9v-1zm-7 4H5v-1h2zm7-1v1H9v-1z' style='fill-rule:nonzero' transform='matrix(2 0 0 2 0 -2)'/%3E%3C/svg%3E")}.ag-icon-last:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m7.727 9.88 6.12 6.12-6.12 6.12L9.607 24l8-8-8-8zM21.607 8h2.667v16h-2.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-left:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M26.667 14.667H10.44l7.453-7.453L16 5.334 5.333 16.001 16 26.668l1.88-1.88-7.44-7.453h16.227z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-linked:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M5.2 16a4.136 4.136 0 0 1 4.133-4.133h5.333V9.334H9.333a6.67 6.67 0 0 0-6.667 6.667 6.67 6.67 0 0 0 6.667 6.667h5.333v-2.533H9.333A4.136 4.136 0 0 1 5.2 16.002zm5.467 1.333h10.667v-2.667H10.667zm12-8h-5.333v2.533h5.333a4.136 4.136 0 0 1 4.133 4.133 4.136 4.136 0 0 1-4.133 4.133h-5.333v2.533h5.333a6.67 6.67 0 0 0 6.667-6.667 6.67 6.67 0 0 0-6.667-6.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-loading:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M17 29h-2v-8h2zm-3.586-9L7 26.414 5.586 25 12 18.586zm13 5L25 26.414 18.586 20 20 18.586zM29 17h-8v-2h8zm-18 0H3v-2h8zm2.414-5L12 13.414 5.586 7 7 5.586zm13-5L20 13.414 18.586 12 25 5.586zM17 11h-2V3h2z' style='fill-rule:nonzero' transform='translate(-3.692 -3.692)scale(1.23077)'/%3E%3C/svg%3E")}.ag-icon-maximize:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M14 30H2V18h2.828v7.05l8.254-8.252 2.12 2.12-8.252 8.254H14zm4-28h12v12h-2.828V6.95l-8.254 8.252-2.12-2.12 8.252-8.254H18z'/%3E%3C/svg%3E")}.ag-icon-menu:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M20 13H0v-2h20zm0-6H0V5h20zm0-6H0v-2h20z' style='fill-rule:nonzero' transform='translate(6 9)'/%3E%3C/svg%3E")}.ag-icon-menu-alt:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='%23000' d='M16 19a3 3 0 1 0 0-6 3 3 0 0 0 0 6M16 11a3 3 0 1 0 0-6 3 3 0 0 0 0 6M16 27a3 3 0 1 0 0-6 3 3 0 0 0 0 6'/%3E%3C/svg%3E")}.ag-icon-minimize:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M2 18h12v12h-2.828v-7.05l-8.254 8.252-2.12-2.12 8.252-8.254H2zm28-4H18V2h2.828v7.05L29.082.798l2.12 2.12-8.252 8.254H30z'/%3E%3C/svg%3E")}.ag-icon-minus:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M6.572 6.572a13.32 13.32 0 0 0 0 18.856 13.32 13.32 0 0 0 18.856 0 13.32 13.32 0 0 0 0-18.856 13.32 13.32 0 0 0-18.856 0m17.527 8.099v2.658H7.901v-2.658z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-next:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M10.94 6 9.06 7.88 17.167 16 9.06 24.12 10.94 26l10-10z' style='fill-rule:nonzero' transform='translate(1)'/%3E%3C/svg%3E")}.ag-icon-none:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Ctitle%3Enone%3C/title%3E%3Cg fill='%23000' fill-rule='nonzero'%3E%3Cpath d='M23.708 14.645 16 6.939l-7.708 7.706 1.416 1.416L16 9.767l6.292 6.294zM23.708 20.355 16 28.061l-7.708-7.706 1.416-1.416L16 25.233l6.292-6.294z'/%3E%3C/g%3E%3C/svg%3E")}.ag-icon-not-allowed:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M16 2.667C8.64 2.667 2.667 8.64 2.667 16S8.64 29.333 16 29.333 29.333 23.36 29.333 16 23.36 2.667 16 2.667M5.333 16c0-5.893 4.773-10.667 10.667-10.667 2.467 0 4.733.84 6.533 2.253L7.586 22.533A10.54 10.54 0 0 1 5.333 16M16 26.667c-2.467 0-4.733-.84-6.533-2.253L24.414 9.467A10.54 10.54 0 0 1 26.667 16c0 5.893-4.773 10.667-10.667 10.667' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-paste:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M25.334 4H19.76C19.2 2.453 17.733 1.333 16 1.333S12.8 2.453 12.24 4H6.667A2.675 2.675 0 0 0 4 6.667V28c0 1.467 1.2 2.667 2.667 2.667h18.667c1.467 0 2.667-1.2 2.667-2.667V6.667C28.001 5.2 26.801 4 25.334 4M16 4c.733 0 1.333.6 1.333 1.333s-.6 1.333-1.333 1.333-1.333-.6-1.333-1.333S15.267 4 16 4m9.333 24H6.666V6.667h2.667v4h13.333v-4h2.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-pin:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m10.78 19.777-4.668-4.666s.032-1 .67-1.87c1.366-1.86 4.052-1.96 6.056-1.572l3.158-3.108c-.7-2.342 3.352-5.046 3.352-5.046l9.166 9.168q-.334.447-.67.894c-1.074 1.426-2.538 2.63-4.272 2.338l-3.32 3.218c.046.344.042.03.118 1.152.144 2.13-.64 4.324-2.632 5.34l-.746.364-4.798-4.798-7.292 7.294-1.416-1.416zm8.24-13.672c-.688.568-1.416 1.45-1.024 2.072l.49.722-4.986 4.988c-1.988-.506-4.346-.636-5.156.614l9.02 9.032q.14-.099.272-.21c1.226-1.08.764-3.04.498-4.9l4.79-4.79s1.47.938 2.936-.776l-6.79-6.79q-.026.019-.05.038' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-pivot:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M25.128 2.002c2.56.096 4.772 2.292 4.87 4.87a712 712 0 0 1 0 18.256c-.096 2.56-2.292 4.772-4.87 4.87a712 712 0 0 1-18.256 0c-2.558-.096-4.772-2.29-4.87-4.87a712 712 0 0 1 0-18.256c.096-2.56 2.292-4.772 4.87-4.87a712 712 0 0 1 18.256 0m2.966 7.954H9.892v18.136c5.086.13 10.18.098 15.264-.096 1.48-.094 2.746-1.35 2.84-2.84.192-5.064.226-10.134.098-15.2M3.968 24.1q.015.528.036 1.056c.094 1.484 1.354 2.746 2.84 2.84l1.012.036V24.1zM22 15.414l-.292.294-1.416-1.416L23 11.586l2.708 2.706-1.416 1.416-.292-.294v3.592c-.032 2.604-2.246 4.892-4.872 4.992L15.414 24l.294.292-1.416 1.416L11.586 23l2.706-2.708 1.416 1.416-.322.32c3.372.03 6.578-.164 6.614-3.034zM3.88 18.038c.002 1.346.012 2.694.038 4.04h3.938v-4.04zm.05-6.062a681 681 0 0 0-.044 4.042h3.97v-4.042zm5.962-7.99Q8.449 3.999 7.006 4c-1.57.02-2.946 1.348-3.004 2.922q-.02 1.517-.042 3.034h3.896v-2.02h2.036zm14.244-.016v3.966h3.898q-.017-.546-.038-1.092c-.094-1.48-1.35-2.746-2.84-2.84q-.51-.019-1.02-.034m-8.14-.054q-2.035.022-4.07.048v3.972h4.07zm6.106.008a213 213 0 0 0-4.07-.022v4.034h4.07z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-plus:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M6.572 6.572a13.32 13.32 0 0 0 0 18.856 13.32 13.32 0 0 0 18.856 0 13.32 13.32 0 0 0 0-18.856 13.32 13.32 0 0 0-18.856 0m17.527 8.099v2.658h-6.77v6.77h-2.658v-6.77h-6.77v-2.658h6.77v-6.77h2.658v6.77z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-previous:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M21.94 7.88 20.06 6l-10 10 10 10 1.88-1.88L13.833 16z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-right:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m16 5.333-1.88 1.88 7.44 7.453H5.333v2.667H21.56l-7.44 7.453 1.88 1.88 10.667-10.667L16 5.332z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-save:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M15.708 2.355 8 10.061.292 2.355 1.708.939 8 7.233 14.292.939z' style='fill-rule:nonzero' transform='translate(8 14)'/%3E%3Cpath d='M5 26h22v2H5zM15 4h2v18h-2z'/%3E%3C/svg%3E")}.ag-icon-small-down:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M7.334 10.667 16 21.334l8.667-10.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-small-left:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M21.333 7.334 10.666 16l10.667 8.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-small-right:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M10.667 24.666 21.334 16 10.667 7.333z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-small-up:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M7.334 21.333 16 10.666l8.667 10.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-tick:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M11.586 22.96 27.718 6.828 29.84 8.95 11.586 27.202 2.4 18.016l2.12-2.122z'/%3E%3C/svg%3E")}.ag-icon-tree-closed:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m11.94 6-1.88 1.88L18.167 16l-8.107 8.12L11.94 26l10-10z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-tree-indeterminate:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M6 13.5h20v3H6z'/%3E%3C/svg%3E")}.ag-icon-tree-open:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M24.12 9.06 16 17.167 7.88 9.06 6 10.94l10 10 10-10z' style='fill-rule:nonzero' transform='translate(0 1)'/%3E%3C/svg%3E")}.ag-icon-unlinked:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M22.667 9.333h-5.333v2.533h5.333a4.136 4.136 0 0 1 4.133 4.133c0 1.907-1.307 3.507-3.08 3.973l1.947 1.947c2.173-1.107 3.667-3.32 3.667-5.92a6.67 6.67 0 0 0-6.667-6.667zm-1.334 5.334h-2.92l2.667 2.667h.253zM2.667 5.693 6.814 9.84A6.65 6.65 0 0 0 2.667 16a6.67 6.67 0 0 0 6.667 6.667h5.333v-2.533H9.334a4.136 4.136 0 0 1-4.133-4.133c0-2.12 1.613-3.867 3.68-4.093l2.76 2.76h-.973v2.667h3.64l3.027 3.027v2.307h2.307l5.347 5.333 1.68-1.68L4.362 4.002 2.669 5.695z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-up:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m5.333 16 1.88 1.88 7.453-7.44v16.227h2.667V10.44l7.44 7.453L26.666 16 15.999 5.333 5.332 16z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-grip:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M8 24H6v-4h2zm6 0h-2v-4h2zm6 0h-2v-4h2zm6 0h-2v-4h2zM8 18H6v-4h2zm6 0h-2v-4h2zm6 0h-2v-4h2zm6 0h-2v-4h2zM8 12H6V8h2zm6 0h-2V8h2zm6 0h-2V8h2zm6 0h-2V8h2z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-settings:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='%23000' d='M30 8h-4.1c-.5-2.3-2.5-4-4.9-4s-4.4 1.7-4.9 4H2v2h14.1c.5 2.3 2.5 4 4.9 4s4.4-1.7 4.9-4H30zm-9 4c-1.7 0-3-1.3-3-3s1.3-3 3-3 3 1.3 3 3-1.3 3-3 3M2 24h4.1c.5 2.3 2.5 4 4.9 4s4.4-1.7 4.9-4H30v-2H15.9c-.5-2.3-2.5-4-4.9-4s-4.4 1.7-4.9 4H2zm9-4c1.7 0 3 1.3 3 3s-1.3 3-3 3-3-1.3-3-3 1.3-3 3-3'/%3E%3C/svg%3E")}.ag-icon-column-arrow:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M11 4a1 1 0 0 1 1 1v22a1 1 0 1 1-2 0V5a1 1 0 0 1 1-1' clip-rule='evenodd'/%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M2 13a1 1 0 0 1 1-1h23.5a1 1 0 1 1 0 2H3a1 1 0 0 1-1-1' clip-rule='evenodd'/%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M2 4h18v24H2zm2 2v20h14V6zM26.793 13 23 9.207l1.414-1.414L29.621 13l-5.207 5.207L23 16.793z' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-un-pin:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='m6.112 15.111 3.272 3.271 1.436-1.402-2.476-2.479c.81-1.25 3.168-1.12 5.156-.614l4.986-4.988-.49-.722c-.392-.622.336-1.504 1.024-2.072l.008-.007.01-.006.032-.025 1.447 1.447 1.432-1.397-2.601-2.602s-4.052 2.704-3.352 5.046l-3.158 3.108c-2.004-.388-4.69-.288-6.056 1.572-.638.87-.67 1.87-.67 1.87m.581 11.582.014.014 5.502-5.501 4.783 4.783.746-.364c1.992-1.016 2.776-3.21 2.632-5.34-.055-.805-.068-.87-.088-.97-.008-.04-.017-.085-.03-.182l3.32-3.218c1.734.292 3.198-.912 4.272-2.338q.337-.447.67-.894l-.001-.001-.007-.007-.007-.007-.007-.007-3.87-3.87 1.585-1.584-1.414-1.414-14.381 14.38-1.237 1.209-5.69 5.687 1.417 1.416zM23.21 10.206l2.65 2.651c-1.465 1.714-2.935.776-2.935.776l-4.79 4.79q.041.291.087.583c.257 1.676.513 3.35-.585 4.317a4 4 0 0 1-.272.21l-3.739-3.744z' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-pinned-top:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' d='m16.708 10.878 8.708 8.706L24 21l-6.292-6.294V27h-2V14.706L9.416 21 8 19.584q4.348-4.344 8.691-8.69zM25 6H8v2h17z'/%3E%3C/svg%3E")}.ag-icon-pinned-bottom:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' d='M16.708 22.122 8 13.416 9.416 12l6.292 6.294V6h2v12.294L24 12l1.416 1.416-8.691 8.69zM7.416 28h17v-2h-17z'/%3E%3C/svg%3E")}.ag-icon-chevron-up:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' viewBox='0 0 16 16'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M3.479 10.521a.75.75 0 0 1 0-1.06l4-4a.75.75 0 0 1 1.06 0l4 4a.75.75 0 0 1-1.06 1.06l-3.47-3.47-3.47 3.47a.75.75 0 0 1-1.06 0' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-chevron-down:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' viewBox='0 0 16 16'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M12.521 5.461a.75.75 0 0 1 0 1.06l-4 4a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 0 1 1.06-1.06l3.47 3.47 3.47-3.47a.75.75 0 0 1 1.06 0' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-chevron-left:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' viewBox='0 0 16 16'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M10.53 12.512a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 0 1 0-1.06l4-4a.75.75 0 0 1 1.06 1.06l-3.47 3.47 3.47 3.47a.75.75 0 0 1 0 1.06' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-chevron-right:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' viewBox='0 0 16 16'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M5.47 3.47a.75.75 0 0 1 1.06 0l4 4a.75.75 0 0 1 0 1.06l-4 4a.75.75 0 0 1-1.06-1.06L8.94 8 5.47 4.53a.75.75 0 0 1 0-1.06' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-filter-add:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' d='M19.834 8H8c0 .304.06.612.258.842 2.716 2.854 6.682 5.548 6.742 7.974V21l2-1.5v-2.684c.056-2.267 2.968-4.417 5.49-6.75v3.087c-1.081.974-2.245 1.968-3.232 3.005a1.05 1.05 0 0 0-.258.682v3.66L13 25c0-2.74.066-5.482-.002-8.222a1.05 1.05 0 0 0-.256-.62C10.026 13.304 6.06 10.61 6 8.184V6h13.834z'/%3E%3Cpath fill='currentColor' d='M26 6h2.946v2.002H26v3.313h-2.002V8.002h-2.946V6h2.946V3.04H26z'/%3E%3C/svg%3E")}.ag-icon-edit:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' d='M6.222 25.778h1.611l14.834-14.811-1.611-1.611-14.834 14.81zM4 28v-4.733L22.644 4.656a2.26 2.26 0 0 1 1.567-.634q.423 0 .833.167.412.166.734.478l1.589 1.6q.333.322.483.733t.15.822q0 .423-.161.839-.162.416-.472.728L8.733 28zm17.856-17.833-.8-.811 1.61 1.61z'/%3E%3C/svg%3E")}`,zU=Ii({feature:"iconSet",css:GU});var VM={aggregation:'<path d="M18 7V4H6l6 8-6 8h12v-3"/>',arrows:'<polyline points="5 9 2 12 5 15"/><polyline points="9 5 12 2 15 5"/><polyline points="15 19 12 22 9 19"/><polyline points="19 9 22 12 19 15"/><line x1="2" x2="22" y1="12" y2="12"/><line x1="12" x2="12" y1="2" y2="22"/>',asc:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',cancel:'<path d="m18 6-12 12"/><path d="m6 6 12 12"/>',chart:'<line x1="18" x2="18" y1="20" y2="10"/><line x1="12" x2="12" y1="20" y2="4"/><line x1="6" x2="6" y1="20" y2="14"/>',"color-picker":'<path d="m19 11-8-8-8.6 8.6a2 2 0 0 0 0 2.8l5.2 5.2c.8.8 2 .8 2.8 0L19 11Z"/><path d="m5 2 5 5"/><path d="M2 13h15"/><path d="M22 20a2 2 0 1 1-4 0c0-1.6 1.7-2.4 2-4 .3 1.6 2 2.4 2 4Z"/>',columns:'<path d="M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18"/>',contracted:'<path d="m9 18 6-6-6-6"/>',copy:'<rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/>',cross:'<path d="M18 6 6 18"/><path d="m6 6 12 12"/>',csv:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',cut:'<circle cx="6" cy="6" r="3"/><path d="M8.12 8.12 12 12"/><path d="M20 4 8.12 15.88"/><circle cx="6" cy="18" r="3"/><path d="M14.8 14.8 20 20"/>',desc:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',down:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',excel:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',expanded:'<path d="m15 18-6-6 6-6"/>',"eye-slash":'<path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"/><line x1="2" x2="22" y1="2" y2="22"/>',eye:'<path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/>',filter:'<path d="M3 6h18"/><path d="M7 12h10"/><path d="M10 18h4"/>',first:'<path d="m17 18-6-6 6-6"/><path d="M7 6v12"/>',group:'<path d="M16 12H3"/><path d="M16 18H3"/><path d="M10 6H3"/><path d="M21 18V8a2 2 0 0 0-2-2h-5"/><path d="m16 8-2-2 2-2"/>',last:'<path d="m7 18 6-6-6-6"/><path d="M17 6v12"/>',left:'<path d="m12 19-7-7 7-7"/><path d="M19 12H5"/>',linked:'<path d="M9 17H7A5 5 0 0 1 7 7h2"/><path d="M15 7h2a5 5 0 1 1 0 10h-2"/><line x1="8" x2="16" y1="12" y2="12"/>',loading:'<line x1="12" x2="12" y1="2" y2="6"/><line x1="12" x2="12" y1="18" y2="22"/><line x1="4.93" x2="7.76" y1="4.93" y2="7.76"/><line x1="16.24" x2="19.07" y1="16.24" y2="19.07"/><line x1="2" x2="6" y1="12" y2="12"/><line x1="18" x2="22" y1="12" y2="12"/><line x1="4.93" x2="7.76" y1="19.07" y2="16.24"/><line x1="16.24" x2="19.07" y1="7.76" y2="4.93"/>',maximize:'<polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" x2="14" y1="3" y2="10"/><line x1="3" x2="10" y1="21" y2="14"/>',menu:'<line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/>',"menu-alt":'<circle cx="12" cy="5" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="12" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="19" r="0.75" fill="#D9D9D9"/>',minimize:'<polyline points="4 14 10 14 10 20"/><polyline points="20 10 14 10 14 4"/><line x1="14" x2="21" y1="10" y2="3"/><line x1="3" x2="10" y1="21" y2="14"/>',minus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/>',next:'<path d="m9 18 6-6-6-6"/>',none:'<path d="m7 15 5 5 5-5"/><path d="m7 9 5-5 5 5"/>',"not-allowed":'<circle cx="12" cy="12" r="10"/><path d="m4.9 4.9 14.2 14.2"/>',paste:'<path d="M15 2H9a1 1 0 0 0-1 1v2c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V3c0-.6-.4-1-1-1Z"/><path d="M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M16 4h2a2 2 0 0 1 2 2v2M11 14h10"/><path d="m17 10 4 4-4 4"/>',pin:'<line x1="12" x2="12" y1="17" y2="22"/><path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"/>',pivot:'<path d="M15 3v18"/><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M21 9H3"/><path d="M21 15H3"/>',plus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/><path d="M12 8v8"/>',previous:'<path d="m15 18-6-6 6-6"/>',right:'<path d="M5 12h14"/><path d="m12 5 7 7-7 7"/>',save:'<path d="M12 17V3"/><path d="m6 11 6 6 6-6"/><path d="M19 21H5"/>',"small-left":'<path d="m15 18-6-6 6-6"/>',"small-right":'<path d="m9 18 6-6-6-6"/>',tick:'<path d="M20 6 9 17l-5-5"/>',"tree-closed":'<path d="m9 18 6-6-6-6"/>',"tree-indeterminate":'<path d="M5 12h14"/>',"tree-open":'<path d="m6 9 6 6 6-6"/>',unlinked:'<path d="M9 17H7A5 5 0 0 1 7 7"/><path d="M15 7h2a5 5 0 0 1 4 8"/><line x1="8" x2="12" y1="12" y2="12"/><line x1="2" x2="22" y1="2" y2="22"/>',up:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',grip:'<circle cx="5" cy="8" r="0.5"/><circle cx="12" cy="8" r="0.5"/><circle cx="19" cy="8" r="0.5"/><circle cx="5" cy="16" r="0.5"/><circle cx="12" cy="16" r="0.5"/><circle cx="19" cy="16" r="0.5"/><g stroke="none" fill="currentColor"><circle cx="5" cy="8" r="1"/><circle cx="12" cy="8" r="1"/><circle cx="19" cy="8" r="1"/><circle cx="5" cy="16" r="1"/><circle cx="12" cy="16" r="1"/><circle cx="19" cy="16" r="1"/></g>',settings:'<path d="M20 7h-9"/><path d="M14 17H5"/><circle cx="17" cy="17" r="3"/><circle cx="7" cy="7" r="3"/>'},GM={"column-arrow":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" viewBox="0 0 32 32"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 26C0 28.2092 1.79086 30 4 30H14C16.2091 30 18 28.2092 18 26V15H25.8786L24.4394 16.4393C23.8536 17.0251 23.8536 17.9749 24.4394 18.5607C25.0252 19.1464 25.9748 19.1464 26.5606 18.5607L30.5606 14.5607C31.1464 13.9749 31.1464 13.0251 30.5606 12.4393L26.5606 8.43934C25.9748 7.85356 25.0252 7.85356 24.4394 8.43934C23.8536 9.02512 23.8536 9.97488 24.4394 10.5607L25.8786 12H18V6C18 3.79086 16.2091 2 14 2H4C1.79086 2 0 3.79086 0 6V26ZM14 5H10.5V12H15V6C15 5.44772 14.5523 5 14 5ZM4 5H7.5V12H3V6C3 5.44772 3.44772 5 4 5ZM10.5 15H15V26C15 26.5522 14.5523 27 14 27H10.5V15ZM4 27H7.5V15H3V26C3 26.5522 3.44772 27 4 27Z" fill="currentColor"/></svg>',"small-down":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 10.667 16 21.334l8.667-10.667H7.334Z"/></svg>',"small-up":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 21.333 16 10.666l8.667 10.667H7.334Z"/></svg>',"pinned-top":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M12.53 3.72A.75.75 0 0 1 12 5H4a.75.75 0 0 1 0-1.5h8a.75.75 0 0 1 .53.22ZM3.269 10.744a.75.75 0 0 1 .2-.524l4-4a.75.75 0 0 1 1.06 0l4 4a.75.75 0 1 1-1.06 1.06L8.75 8.56V14a.75.75 0 0 1-1.5 0V8.56l-2.72 2.72a.75.75 0 0 1-1.26-.536Z"/></svg>',"pinned-bottom":'<svg xmlns="http://www.w3.org/2000/svg" fill="none" class="ag-icon" viewBox="0 0 16 16"><path fill="currentColor" d="M3.47 12.28A.75.75 0 0 1 4 11h8a.75.75 0 0 1 0 1.5H4a.75.75 0 0 1-.53-.22ZM12.731 5.256a.75.75 0 0 1-.2.524l-4 4a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 1 1 1.06-1.06l2.72 2.72V2a.75.75 0 0 1 1.5 0v5.44l2.72-2.72a.75.75 0 0 1 1.26.536Z"/></svg>',"un-pin":'<svg xmlns="http://www.w3.org/2000/svg" fill="none" class="ag-icon" viewBox="0 0 16 16"><path fill="currentColor" d="M8 11a.75.75 0 0 0-.75.75v3.333a.75.75 0 1 0 1.5 0V11.75A.75.75 0 0 0 8 11Z"/><path fill="currentColor" d="M13.11 1.436a.75.75 0 0 0-1.22-.872l-10 14a.75.75 0 1 0 1.22.872L5.207 12.5h7.376a.75.75 0 0 0 .75-.75v-1.174a2.08 2.08 0 0 0-1.153-1.863l-1.185-.599-.005-.002a.58.58 0 0 1-.323-.522V5.165a2.083 2.083 0 0 0 1.854-2.904l.589-.825Zm-3.943 5.52v.634a2.08 2.08 0 0 0 1.153 1.863l1.185.6.005.002a.58.58 0 0 1 .323.522V11H6.28l2.887-4.044ZM9.277 1H5.25a2.084 2.084 0 0 0-.083 4.165v1.676l1.5-2.132v-.292a.75.75 0 0 0-.75-.75H5.25a.584.584 0 0 1 0-1.167h2.972L9.277 1Z"/></svg>',"chevron-down":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 6L8 10L4 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-up":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 10L8 6L12 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-left":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 12L6 8L10 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-right":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"filter-add":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.12126 7.75L10.8517 7.75" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M6.65934 11.748L9.32778 11.748" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M12.2943 1.04872V6.19184M14.9886 3.74341H9.68478" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M8.25488 3C8.04799 3.18323 7.91706 3.45099 7.91699 3.74902C7.91713 4.04868 8.04988 4.31681 8.25879 4.5H2C1.58579 4.5 1.25 4.16421 1.25 3.75C1.25 3.33579 1.58579 3 2 3H8.25488Z" fill="currentColor"/></svg>',edit:'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 10.6262V12.5012H5.375L10.905 6.97122L9.03 5.09622L3.5 10.6262ZM12.355 5.52122C12.4014 5.47497 12.4381 5.42002 12.4632 5.35953C12.4883 5.29905 12.5012 5.23421 12.5012 5.16872C12.5012 5.10324 12.4883 5.0384 12.4632 4.97791C12.4381 4.91742 12.4014 4.86248 12.355 4.81622L11.185 3.64622C11.1387 3.59987 11.0838 3.5631 11.0233 3.53801C10.9628 3.51291 10.898 3.5 10.8325 3.5C10.767 3.5 10.7022 3.51291 10.6417 3.53801C10.5812 3.5631 10.5263 3.59987 10.48 3.64622L9.565 4.56122L11.44 6.43622L12.355 5.52122Z" fill="currentColor"/></svg>'},WU=(e={})=>{let t="";for(let i of[...Object.keys(VM),...Object.keys(GM)]){let n=UU(i,e.strokeWidth);t+=`.ag-icon-${i}::before { mask-image: url('data:image/svg+xml,${encodeURIComponent(n)}'); }
`}return t},UU=(e,t=1.5)=>{let i=GM[e];if(i)return i;let n=VM[e];if(!n)throw new Error(`Missing icon data for ${e}`);return`<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="black" stroke-width="${t}" viewBox="0 0 24 24"><style>* { vector-effect: non-scaling-stroke; }</style>`+n+"</svg>"},qU=(e={})=>Ii({feature:"iconSet",css:()=>WU(e)});var $U=qU();var jU=':where(.ag-input-field-input[type=number]:not(.ag-number-field-input-stepper)){-webkit-appearance:textfield;-moz-appearance:textfield;appearance:textfield;&::-webkit-inner-spin-button,&::-webkit-outer-spin-button{-webkit-appearance:none;appearance:none;margin:0}}.ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){background-color:var(--ag-input-background-color);border:var(--ag-input-border);border-radius:var(--ag-input-border-radius);color:var(--ag-input-text-color);font-family:inherit;font-size:inherit;line-height:inherit;margin:0;min-height:var(--ag-input-height);padding:0;&:where(:disabled){background-color:var(--ag-input-disabled-background-color);border:var(--ag-input-disabled-border);color:var(--ag-input-disabled-text-color)}&:where(:focus){background-color:var(--ag-input-focus-background-color);border:var(--ag-input-focus-border);box-shadow:var(--ag-input-focus-shadow);color:var(--ag-input-focus-text-color);outline:none}&:where(:invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&:where(.invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&::-moz-placeholder{color:var(--ag-input-placeholder-text-color)}&::placeholder{color:var(--ag-input-placeholder-text-color)}}:where(.ag-ltr) .ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){padding-left:var(--ag-input-padding-start)}:where(.ag-rtl) .ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){padding-right:var(--ag-input-padding-start)}:where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select){.ag-input-wrapper:before{background-color:currentcolor;color:var(--ag-input-icon-color);content:"";display:block;height:12px;-webkit-mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;opacity:.5;position:absolute;width:12px}}:where(.ag-ltr) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select){.ag-input-wrapper:before{margin-left:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-left:calc(var(--ag-spacing)*1.5 + 12px)}}:where(.ag-rtl) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select){.ag-input-wrapper:before{margin-right:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-right:calc(var(--ag-spacing)*1.5 + 12px)}}',KU=".ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){&:focus{box-shadow:var(--ag-focus-shadow);&:where(.invalid),&:where(:invalid){box-shadow:var(--ag-focus-error-shadow)}}}";var YU={inputBackgroundColor:"transparent",inputBorder:!1,inputBorderRadius:0,inputTextColor:{ref:"textColor"},inputPlaceholderTextColor:{ref:"inputTextColor",mix:.5},inputPaddingStart:0,inputHeight:{calc:"max(iconSize, fontSize) + spacing * 2"},inputFocusBackgroundColor:{ref:"inputBackgroundColor"},inputFocusBorder:{ref:"inputBorder"},inputFocusShadow:"none",inputFocusTextColor:{ref:"inputTextColor"},inputDisabledBackgroundColor:{ref:"inputBackgroundColor"},inputDisabledBorder:{ref:"inputBorder"},inputDisabledTextColor:{ref:"inputTextColor"},inputInvalidBackgroundColor:{ref:"inputBackgroundColor"},inputInvalidBorder:{ref:"inputBorder"},inputInvalidTextColor:{ref:"inputTextColor"},inputIconColor:{ref:"inputTextColor"},pickerButtonBorder:!1,pickerButtonFocusBorder:{ref:"inputFocusBorder"},pickerButtonBackgroundColor:{ref:"backgroundColor"},pickerButtonFocusBackgroundColor:{ref:"backgroundColor"},pickerListBorder:!1,pickerListBackgroundColor:{ref:"backgroundColor"},colorPickerThumbSize:18,colorPickerTrackSize:12,colorPickerThumbBorderWidth:3,colorPickerTrackBorderRadius:12,colorPickerColorBorderRadius:4};var XU=()=>Ii({feature:"inputStyle",params:O(b({},YU),{inputBackgroundColor:li,inputBorder:!0,inputBorderRadius:{ref:"borderRadius"},inputPaddingStart:{ref:"spacing"},inputFocusBorder:{color:At},inputFocusShadow:{ref:"focusShadow"},inputDisabledBackgroundColor:ai(.06),inputDisabledTextColor:{ref:"textColor",mix:.5},inputInvalidBorder:{color:{ref:"invalidColor"}},pickerButtonBorder:!0,pickerListBorder:!0}),css:()=>jU+KU}),zM=XU();var WM='.ag-tabs-header{background-color:var(--ag-tab-bar-background-color);border-bottom:var(--ag-tab-bar-border);display:flex;flex:1;gap:var(--ag-tab-spacing);padding:var(--ag-tab-bar-top-padding) var(--ag-tab-bar-horizontal-padding) 0}.ag-tabs-header-wrapper{display:flex}.ag-tabs-close-button-wrapper{align-items:center;border:0;display:flex;padding:var(--ag-spacing)}:where(.ag-ltr) .ag-tabs-close-button-wrapper{border-right:solid var(--ag-border-width) var(--ag-border-color)}:where(.ag-rtl) .ag-tabs-close-button-wrapper{border-left:solid var(--ag-border-width) var(--ag-border-color)}.ag-tabs-close-button{background-color:unset;border:0;cursor:pointer;padding:0}.ag-tab{align-items:center;background-color:var(--ag-tab-background-color);border-left:var(--ag-tab-selected-border-width) solid transparent;border-right:var(--ag-tab-selected-border-width) solid transparent;color:var(--ag-tab-text-color);cursor:pointer;display:flex;flex:1;justify-content:center;padding:var(--ag-tab-top-padding) var(--ag-tab-horizontal-padding) var(--ag-tab-bottom-padding);position:relative;&:hover{background-color:var(--ag-tab-hover-background-color);color:var(--ag-tab-hover-text-color)}&.ag-tab-selected{background-color:var(--ag-tab-selected-background-color);color:var(--ag-tab-selected-text-color)}&:after{background-color:var(--ag-tab-selected-underline-color);bottom:0;content:"";display:block;height:var(--ag-tab-selected-underline-width);left:0;opacity:0;position:absolute;right:0;transition:opacity var(--ag-tab-selected-underline-transition-duration)}&.ag-tab-selected:after{opacity:1}}:where(.ag-ltr) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-left-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-right-color:var(--ag-tab-selected-border-color)}}}:where(.ag-rtl) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-right-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-left-color:var(--ag-tab-selected-border-color)}}}';var UM={tabBarBackgroundColor:"transparent",tabBarHorizontalPadding:0,tabBarTopPadding:0,tabBackgroundColor:"transparent",tabTextColor:{ref:"textColor"},tabHorizontalPadding:{ref:"spacing"},tabTopPadding:{ref:"spacing"},tabBottomPadding:{ref:"spacing"},tabSpacing:"0",tabHoverBackgroundColor:{ref:"tabBackgroundColor"},tabHoverTextColor:{ref:"tabTextColor"},tabSelectedBackgroundColor:{ref:"tabBackgroundColor"},tabSelectedTextColor:{ref:"tabTextColor"},tabSelectedBorderWidth:{ref:"borderWidth"},tabSelectedBorderColor:"transparent",tabSelectedUnderlineColor:"transparent",tabSelectedUnderlineWidth:0,tabSelectedUnderlineTransitionDuration:0,tabBarBorder:!1};var JU=()=>Ii({feature:"tabStyle",params:O(b({},UM),{tabBarBorder:!0,tabBarBackgroundColor:qi(.05),tabTextColor:{ref:"textColor",mix:.7},tabSelectedTextColor:{ref:"textColor"},tabHoverTextColor:{ref:"textColor"},tabSelectedBorderColor:{ref:"borderColor"},tabSelectedBackgroundColor:li}),css:WM}),QU=JU();var ZU=()=>Ii({feature:"tabStyle",params:O(b({},UM),{tabBarBorder:!0,tabBarBackgroundColor:{ref:"chromeBackgroundColor"},tabHoverTextColor:At,tabSelectedTextColor:At,tabSelectedUnderlineColor:At,tabSelectedUnderlineWidth:2,tabSelectedUnderlineTransitionDuration:"0.3s"}),css:WM}),eq=ZU();var tq=()=>OM().withPart(NM).withPart(HM).withPart($U).withPart(QU).withPart(zM).withPart(uw).withParams({fontFamily:[{googleFont:"IBM Plex Sans"},"-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu"]}),iq=tq(),nq=()=>OM().withPart(IU).withPart(NM).withPart(HM).withPart(zU).withPart(eq).withPart(zM).withPart(uw).withParams({accentColor:"#2196f3",selectedRowBackgroundColor:Pi(.3),inputFocusBorder:{color:Pi(.4)},focusShadow:{radius:2,spread:1.6,color:Pi(.4)},iconButtonHoverBackgroundColor:"transparent",iconButtonActiveBackgroundColor:"transparent",checkboxUncheckedBorderColor:ai(.45),checkboxIndeterminateBackgroundColor:ai(.45),checkboxIndeterminateBorderColor:ai(.45),checkboxBorderWidth:2,checkboxBorderRadius:2,fontSize:13,dataFontSize:14,headerFontWeight:700,borderRadius:3,wrapperBorderRadius:3,tabSelectedUnderlineColor:At,tabSelectedBorderWidth:0,tabSelectedUnderlineTransitionDuration:.3,sideButtonSelectedUnderlineColor:At,sideButtonSelectedUnderlineWidth:2,sideButtonSelectedUnderlineTransitionDuration:.3,sideButtonBorder:!1,sideButtonSelectedBorder:!1,sideButtonBarTopPadding:{calc:"spacing * 3"},sideButtonSelectedBackgroundColor:"transparent",sideButtonHoverTextColor:At,iconButtonHoverColor:At,toggleButtonWidth:28,toggleButtonHeight:18,toggleButtonSwitchInset:1,toggleButtonOffBackgroundColor:ai(.45),colorPickerThumbSize:13,colorPickerTrackSize:11,colorPickerThumbBorderWidth:2,colorPickerTrackBorderRadius:2,colorPickerColorBorderRadius:2}),qM=nq();var sq={cssName:"--ag-cell-horizontal-padding",changeKey:"cellHorizontalPaddingChanged",defaultValue:16},oq={cssName:"--ag-indentation-level",changeKey:"indentationLevelChanged",defaultValue:0,noWarn:!0,cacheDefault:!0},rq={cssName:"--ag-row-group-indent-size",changeKey:"rowGroupIndentSizeChanged",defaultValue:0},n6={cssName:"--ag-row-height",changeKey:"rowHeightChanged",defaultValue:42},s6={cssName:"--ag-header-height",changeKey:"headerHeightChanged",defaultValue:48},o6={cssName:"--ag-list-item-height",changeKey:"listItemHeightChanged",defaultValue:24},WC={cssName:"--ag-row-border",changeKey:"rowBorderWidthChanged",defaultValue:1,border:!0},r6={cssName:"--ag-pinned-row-border",changeKey:"pinnedRowBorderWidthChanged",defaultValue:1,border:!0};function aq(e,t){for(let i of t.sort((n,s)=>n.moduleName.localeCompare(s.moduleName))){let n=i.css;n&&e.set(`module-${i.moduleName}`,n)}}var lq=class extends xH{constructor(){super(...arguments),this.sizeEls=new Map,this.lastKnownValues=new Map,this.sizesMeasured=!1}initVariables(){this.addManagedPropertyListener("rowHeight",()=>this.refreshRowHeightVariable()),this.getSizeEl(n6),this.getSizeEl(s6),this.getSizeEl(o6),this.getSizeEl(WC),this.getSizeEl(r6),this.refreshRowBorderWidthVariable()}getPinnedRowBorderWidth(){return this.getCSSVariablePixelValue(r6)}getRowBorderWidth(){return this.getCSSVariablePixelValue(WC)}getDefaultRowHeight(){return this.getCSSVariablePixelValue(n6)}getDefaultHeaderHeight(){return this.getCSSVariablePixelValue(s6)}getDefaultCellHorizontalPadding(){return this.getCSSVariablePixelValue(sq)}getCellPaddingLeft(){let e=this.getDefaultCellHorizontalPadding(),t=this.getCSSVariablePixelValue(oq),i=this.getCSSVariablePixelValue(rq);return e-1+i*t}getCellPadding(){let e=this.getDefaultCellHorizontalPadding()-1;return this.getCellPaddingLeft()+e}getDefaultColumnMinWidth(){return Math.min(36,this.getDefaultRowHeight())}getDefaultListItemHeight(){return this.getCSSVariablePixelValue(o6)}refreshRowHeightVariable(){let{eRootDiv:e}=this,t=e.style.getPropertyValue("--ag-line-height").trim(),i=this.gos.get("rowHeight");if(i==null||isNaN(i)||!isFinite(i))return t!==null&&e.style.setProperty("--ag-line-height",null),-1;let n=`${i}px`;return t!=n?(e.style.setProperty("--ag-line-height",n),i):t!=""?Number.parseFloat(t):-1}getCSSVariablePixelValue(e){let t=this.lastKnownValues.get(e);if(t!=null)return t;let i=this.measureSizeEl(e);return i==="detached"||i==="no-styles"?(e.cacheDefault&&this.lastKnownValues.set(e,e.defaultValue),e.defaultValue):(this.lastKnownValues.set(e,i),i)}measureSizeEl(e){let t=this.getSizeEl(e);if(t.offsetParent==null)return"detached";let i=t.offsetWidth;return i===UC?"no-styles":(this.sizesMeasured=!0,i)}getMeasurementContainer(){let e=this.eMeasurementContainer;return e||(e=this.eMeasurementContainer=bt({tag:"div",cls:"ag-measurement-container"}),this.eRootDiv.appendChild(e)),e}getSizeEl(e){let t=this.sizeEls.get(e);if(t)return t;let i=this.getMeasurementContainer();t=bt({tag:"div"});let{border:n,noWarn:s}=e;n?(t.className="ag-measurement-element-border",t.style.setProperty("--ag-internal-measurement-border",`var(${e.cssName}, solid ${UC}px)`)):t.style.width=`var(${e.cssName}, ${UC}px)`,i.appendChild(t),this.sizeEls.set(e,t);let o=this.measureSizeEl(e);o==="no-styles"&&!s&&I(9,{variable:e});let r=uo(this.beans,t,()=>{let a=this.measureSizeEl(e);a==="detached"||a==="no-styles"||(this.lastKnownValues.set(e,a),a!==o&&(o=a,this.fireStylesChangedEvent(e.changeKey)))});return this.addDestroyFunc(()=>r()),t}fireStylesChangedEvent(e){e==="rowBorderWidthChanged"&&this.refreshRowBorderWidthVariable(),this.eventSvc.dispatchEvent({type:"gridStylesChanged",[e]:!0})}refreshRowBorderWidthVariable(){let e=this.getCSSVariablePixelValue(WC);this.eRootDiv.style.setProperty("--ag-internal-row-border-width",`${e}px`)}postProcessThemeChange(e,t){e&&getComputedStyle(this.getMeasurementContainer()).getPropertyValue("--ag-legacy-styles-loaded")&&Ge(t?106:239)}getAdditionalCss(){let e=new Map;return e.set("core",[EU]),aq(e,Array.from(YO())),e}getDefaultTheme(){return iq}themeError(e){Ge(240,{theme:e})}},UC=15538,dq=class extends RH{postConstruct(){let{globalListener:e,globalSyncListener:t}=this.beans;e&&this.addGlobalListener(e,!0),t&&this.addGlobalListener(t,!1)}};function $M(e,t,i){let n=e.visibleCols.headerGroupRowCount;if(i>=n)return{column:t,headerRowIndex:i};let s=t.getParent();for(;s&&s.getProvidedColumnGroup().getLevel()>i;)s=s.getParent();let o=t.isSpanHeaderHeight();return!s||o&&s.isPadding()?{column:t,headerRowIndex:n}:{column:s,headerRowIndex:s.getProvidedColumnGroup().getLevel()}}var cq=class extends F{constructor(){super(...arguments),this.beanName="headerNavigation",this.currentHeaderRowWithoutSpan=-1}postConstruct(){let e=this.beans;e.ctrlsSvc.whenReady(this,i=>{this.gridBodyCon=i.gridBodyCtrl});let t=Ht(e);this.addManagedElementListeners(t,{mousedown:()=>{this.currentHeaderRowWithoutSpan=-1}})}getHeaderPositionForColumn(e,t){let i,{colModel:n,colGroupSvc:s,ctrlsSvc:o}=this.beans;if(typeof e=="string"?(i=n.getCol(e),i||(i=s?.getColumnGroup(e)??null)):i=e,!i)return null;let a=o.getHeaderRowContainerCtrl()?.getAllCtrls(),l=je(a||[]).type==="filter",d=Nn(this.beans)-1,c=-1,u=i;for(;u;)c++,u=u.getParent();let h=c;return t&&l&&h===d-1&&h++,h===-1?null:{headerRowIndex:h,column:i}}navigateVertically(e,t){let{focusSvc:i,visibleCols:n}=this.beans,{focusedHeader:s}=i;if(!s)return!1;let{headerRowIndex:o}=s,r=s.column,a=Nn(this.beans),l=this.getHeaderRowType(o),d=n.headerGroupRowCount,{headerRowIndex:c,column:u,headerRowIndexWithoutSpan:h}=e==="UP"?uq(l,r,o):hq(r,o,d),p=!1;return c<0&&(c=0,u=r,p=!0),c>=a?(c=-1,this.currentHeaderRowWithoutSpan=-1):h!==void 0&&(this.currentHeaderRowWithoutSpan=h),!p&&!u?!1:i.focusHeaderPosition({headerPosition:{headerRowIndex:c,column:u},allowUserOverride:!0,event:t})}navigateHorizontally(e,t=!1,i){let{focusSvc:n,gos:s}=this.beans,o=b({},n.focusedHeader),r,a;this.currentHeaderRowWithoutSpan!==-1?o.headerRowIndex=this.currentHeaderRowWithoutSpan:this.currentHeaderRowWithoutSpan=o.headerRowIndex,e==="LEFT"!==s.get("enableRtl")?(a="Before",r=this.findHeader(o,a)):(a="After",r=this.findHeader(o,a));let l=s.getCallback("tabToNextHeader");if(t&&l){let d=n.focusHeaderPositionFromUserFunc({userFunc:l,headerPosition:r,direction:a});if(d){let{headerRowIndex:c}=n.focusedHeader||{};c!=null&&c!=o.headerRowIndex&&(this.currentHeaderRowWithoutSpan=c)}return d}return r||!t?n.focusHeaderPosition({headerPosition:r,direction:a,fromTab:t,allowUserOverride:!0,event:i}):this.focusNextHeaderRow(o,a,i)}focusNextHeaderRow(e,t,i){let n=this.beans,s=e.headerRowIndex,o=null,r,a=Nn(n),l=this.beans.visibleCols.allCols;if(t==="Before"){if(s<=0)return!1;o=je(l),r=s-1,this.currentHeaderRowWithoutSpan-=1}else o=l[0],r=s+1,this.currentHeaderRowWithoutSpan<a?this.currentHeaderRowWithoutSpan+=1:this.currentHeaderRowWithoutSpan=-1;let{column:d,headerRowIndex:c}=$M(this.beans,o,r);return c>=a&&(c=-1),n.focusSvc.focusHeaderPosition({headerPosition:{column:d,headerRowIndex:c},direction:t,fromTab:!0,allowUserOverride:!0,event:i})}scrollToColumn(e,t="After"){if(e.getPinned())return;let i;if(vt(e)){let n=e.getDisplayedLeafColumns();i=t==="Before"?je(n):n[0]}else i=e;this.gridBodyCon.scrollFeature.ensureColumnVisible(i)}findHeader(e,t){let{colGroupSvc:i,visibleCols:n}=this.beans,s=e.column;if(s instanceof Bd){let l=s.getDisplayedLeafColumns();s=t==="Before"?l[0]:l[l.length-1]}let o=t==="Before"?n.getColBefore(s):n.getColAfter(s);if(!o)return;let r=n.headerGroupRowCount;if(e.headerRowIndex>=r)return{headerRowIndex:e.headerRowIndex,column:o};let a=i?.getColGroupAtLevel(o,e.headerRowIndex);return a?a.isPadding()&&o.isSpanHeaderHeight()?{headerRowIndex:n.headerGroupRowCount,column:o}:{headerRowIndex:e.headerRowIndex,column:a??o}:{headerRowIndex:o instanceof hr&&o.isSpanHeaderHeight()?n.headerGroupRowCount:e.headerRowIndex,column:o}}getHeaderRowType(e){let t=this.beans.ctrlsSvc.getHeaderRowContainerCtrl();if(t)return t.getRowType(e)}};function uq(e,t,i){let n=i-1;if(e!=="filter"){let s=t instanceof hr&&t.isSpanHeaderHeight(),o=t.getParent();for(;o&&(o.getProvidedColumnGroup().getLevel()>n||s&&o.isPadding());)o=o.getParent();if(o)return s?{column:o,headerRowIndex:o.getProvidedColumnGroup().getLevel(),headerRowIndexWithoutSpan:n}:{column:o,headerRowIndex:n,headerRowIndexWithoutSpan:n}}return{column:t,headerRowIndex:n,headerRowIndexWithoutSpan:n}}function hq(e,t,i){let n=t+1,s={column:e,headerRowIndex:n,headerRowIndexWithoutSpan:n};if(e instanceof Bd){if(n>=i)return{column:e.getDisplayedLeafColumns()[0],headerRowIndex:i,headerRowIndexWithoutSpan:n};let r=e.getDisplayedChildren()[0];if(r instanceof Bd&&r.isPadding()){let l=r.getDisplayedLeafColumns()[0];l.isSpanHeaderHeight()&&(r=l)}s.column=r,r instanceof hr&&r.isSpanHeaderHeight()&&(s.headerRowIndex=i,s.headerRowIndexWithoutSpan=n)}return s}var pq=class extends F{constructor(){super(...arguments),this.beanName="focusSvc",this.focusFallbackTimeout=null,this.needsFocusRestored=!1}wireBeans(e){this.colModel=e.colModel,this.visibleCols=e.visibleCols,this.rowRenderer=e.rowRenderer,this.navigation=e.navigation,this.filterManager=e.filterManager,this.overlays=e.overlays}postConstruct(){let e=this.clearFocusedCell.bind(this);this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:this.onColumnEverythingChanged.bind(this),columnGroupOpened:e,columnRowGroupChanged:e}),this.addDestroyFunc(TB(this.beans))}attemptToRecoverFocus(){this.needsFocusRestored=!0,this.focusFallbackTimeout!=null&&clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=window.setTimeout(this.setFocusRecovered.bind(this),100)}setFocusRecovered(){this.needsFocusRestored=!1,this.focusFallbackTimeout!=null&&(clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=null)}shouldTakeFocus(){return this.gos.get("suppressFocusAfterRefresh")?(this.setFocusRecovered(),!1):this.needsFocusRestored?(this.setFocusRecovered(),!0):this.doesRowOrCellHaveBrowserFocus()}onColumnEverythingChanged(){if(!this.focusedCell)return;let e=this.focusedCell.column,t=this.colModel.getCol(e.getId());e!==t&&this.clearFocusedCell()}getFocusCellToUseAfterRefresh(){let{gos:e,focusedCell:t}=this;return e.get("suppressFocusAfterRefresh")||e.get("suppressCellFocus")||!t||!this.doesRowOrCellHaveBrowserFocus()?null:t}getFocusHeaderToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedHeader||!this.isDomDataPresentInHierarchy(ot(this.beans),vM)?null:this.focusedHeader}doesRowOrCellHaveBrowserFocus(){let e=ot(this.beans);return this.isDomDataPresentInHierarchy(e,$p)?!0:this.isDomDataPresentInHierarchy(e,jp)}isDomDataPresentInHierarchy(e,t){let i=e;for(;i;){if(r4(this.gos,i,t))return!0;i=i.parentNode}return!1}getFocusedCell(){return this.focusedCell}getFocusEventParams(e){let{rowIndex:t,rowPinned:i,column:n}=e,s={rowIndex:t,rowPinned:i,column:n,isFullWidthCell:!1},o=this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:i});return o&&(s.isFullWidthCell=o.isFullWidth()),s}clearFocusedCell(){if(this.focusedCell==null)return;let e=this.getFocusEventParams(this.focusedCell);this.focusedCell=null,this.eventSvc.dispatchEvent(b({type:"cellFocusCleared"},e))}setFocusedCell(e){this.setFocusRecovered();let{column:t,rowIndex:i,rowPinned:n,forceBrowserFocus:s=!1,preventScrollOnBrowserFocus:o=!1,sourceEvent:r}=e,a=this.colModel.getCol(t);if(!a){this.focusedCell=null;return}this.focusedCell={rowIndex:i,rowPinned:xs(n),column:a};let l=this.getFocusEventParams(this.focusedCell);this.eventSvc.dispatchEvent(O(b(b({type:"cellFocused"},l),this.previousCellFocusParams&&{previousParams:this.previousCellFocusParams}),{forceBrowserFocus:s,preventScrollOnBrowserFocus:o,sourceEvent:r})),this.previousCellFocusParams=l}isCellFocused(e){return this.focusedCell==null?!1:RM(e,this.focusedCell)}isHeaderWrapperFocused(e){if(this.focusedHeader==null)return!1;let{column:t,rowCtrl:{rowIndex:i,pinned:n}}=e,{column:s,headerRowIndex:o}=this.focusedHeader;return t===s&&i===o&&n==s.getPinned()}focusHeaderPosition(e){if(this.setFocusRecovered(),sr(this.beans))return!1;let{direction:t,fromTab:i,allowUserOverride:n,event:s,fromCell:o,rowWithoutSpanValue:r,scroll:a=!0}=e,{headerPosition:l}=e;if(o&&this.filterManager?.isAdvFilterHeaderActive())return this.focusAdvancedFilter(l);if(n){let d=this.focusedHeader,c=Nn(this.beans);if(i){let u=this.gos.getCallback("tabToNextHeader");u&&(l=this.getHeaderPositionFromUserFunc({userFunc:u,direction:t,currentPosition:d,headerPosition:l,headerRowCount:c}))}else{let u=this.gos.getCallback("navigateToNextHeader");if(u&&s){let h={key:s.key,previousHeaderPosition:d,nextHeaderPosition:l,headerRowCount:c,event:s};l=u(h)}}}return l?this.focusProvidedHeaderPosition({headerPosition:l,direction:t,event:s,fromCell:o,rowWithoutSpanValue:r,scroll:a}):!1}focusHeaderPositionFromUserFunc(e){if(sr(this.beans))return!1;let{userFunc:t,headerPosition:i,direction:n,event:s}=e,o=this.focusedHeader,r=Nn(this.beans),a=this.getHeaderPositionFromUserFunc({userFunc:t,direction:n,currentPosition:o,headerPosition:i,headerRowCount:r});return!!a&&this.focusProvidedHeaderPosition({headerPosition:a,direction:n,event:s})}getHeaderPositionFromUserFunc(e){let{userFunc:t,direction:i,currentPosition:n,headerPosition:s,headerRowCount:o}=e,a=t({backwards:i==="Before",previousHeaderPosition:n,nextHeaderPosition:s,headerRowCount:o});return a===!0?n:a===!1?null:a}focusProvidedHeaderPosition(e){let{headerPosition:t,direction:i,fromCell:n,rowWithoutSpanValue:s,event:o,scroll:r=!0}=e,{column:a,headerRowIndex:l}=t,{filterManager:d,ctrlsSvc:c,headerNavigation:u}=this.beans;if(this.focusedHeader&&JV(e.headerPosition,this.focusedHeader))return!1;if(l===-1)return d?.isAdvFilterHeaderActive()?this.focusAdvancedFilter(t):this.focusGridView({column:a,event:o});r&&u?.scrollToColumn(a,i);let p=c.getHeaderRowContainerCtrl(a.getPinned())?.focusHeader(t.headerRowIndex,a,o)||!1;return u&&p&&(s!=null||n)&&(u.currentHeaderRowWithoutSpan=s??-1),p}focusFirstHeader(){if(this.overlays?.isExclusive()&&this.focusOverlay())return!0;let e=this.visibleCols.allCols[0];if(!e)return!1;let t=$M(this.beans,e,0);return this.focusHeaderPosition({headerPosition:t,rowWithoutSpanValue:0})}focusLastHeader(e){if(this.overlays?.isExclusive()&&this.focusOverlay(!0))return!0;let t=Nn(this.beans)-1,i=je(this.visibleCols.allCols);return this.focusHeaderPosition({headerPosition:{headerRowIndex:t,column:i},rowWithoutSpanValue:-1,event:e})}focusPreviousFromFirstCell(e){return this.filterManager?.isAdvFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(e)}isAnyCellFocused(){return!!this.focusedCell}isRowFocused(e,t){return this.focusedCell==null?!1:this.focusedCell.rowIndex===e&&this.focusedCell.rowPinned===xs(t)}focusOverlay(e){let t=this.overlays?.isVisible()&&this.overlays.eWrapper?.getGui();return!!t&&lr(t,e)}focusGridView(e){let{backwards:t=!1,canFocusOverlay:i=!0,event:n}=e;if(this.overlays?.isExclusive())return i&&this.focusOverlay(t);if(sg(this.beans))return t&&!sr(this.beans)?this.focusLastHeader():i&&this.focusOverlay(t)?!0:t?!1:Ga(this.beans,t);let s=t?Fz(this.beans):Pz(this.beans);if(s){let o=e.column??this.focusedHeader?.column,{rowIndex:r,rowPinned:a}=s,l=ks(this.beans,s);if(!o||!l||r==null)return!1;if(o.isSuppressNavigable(l)){let d=this.gos.get("enableRtl"),c;return!n||n.key===k.TAB?c=d?k.LEFT:k.RIGHT:c=n.key,this.beans.navigation?.navigateToNextCell(null,c,{rowIndex:r,column:o,rowPinned:a||null},!0),!0}return this.navigation?.ensureCellVisible({rowIndex:r,column:o,rowPinned:a}),t&&this.rowRenderer.getRowByPosition(s)?.isFullWidth()&&this.navigation?.tryToFocusFullWidthRow(s,t)||(this.setFocusedCell({rowIndex:r,column:o,rowPinned:xs(a),forceBrowserFocus:!0}),this.beans.rangeSvc?.setRangeToCell({rowIndex:r,rowPinned:a,column:o})),!0}return!!(i&&this.focusOverlay(t)||t&&this.focusLastHeader())}focusAdvancedFilter(e){return this.advFilterFocusColumn=e?.column,this.beans.advancedFilter?.getCtrl().focusHeaderComp()??!1}focusNextFromAdvancedFilter(e,t){let i=(t?void 0:this.advFilterFocusColumn)??this.visibleCols.allCols?.[0];return e?this.focusHeaderPosition({headerPosition:{column:i,headerRowIndex:Nn(this.beans)-1}}):this.focusGridView({column:i})}clearAdvancedFilterColumn(){this.advFilterFocusColumn=void 0}},gq=class extends F{constructor(){super(...arguments),this.beanName="scrollVisibleSvc"}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colAnimation=e.colAnimation}postConstruct(){this.horizontalScrollShowing=this.gos.get("alwaysShowHorizontalScroll")===!0,this.verticalScrollShowing=this.gos.get("alwaysShowVerticalScroll")===!0,this.getScrollbarWidth(),this.addManagedEventListeners({displayedColumnsChanged:this.updateScrollVisible.bind(this),displayedColumnsWidthChanged:this.updateScrollVisible.bind(this)})}updateScrollVisible(){let{colAnimation:e}=this;e?.isActive()?e.executeLaterVMTurn(()=>{e.executeLaterVMTurn(()=>this.updateScrollVisibleImpl())}):this.updateScrollVisibleImpl()}updateScrollVisibleImpl(){let e=this.ctrlsSvc.get("center");if(!e||this.colAnimation?.isActive())return;let t={horizontalScrollShowing:e.isHorizontalScrollShowing(),verticalScrollShowing:this.verticalScrollShowing};this.setScrollsVisible(t),this.updateScrollGap()}updateScrollGap(){let e=this.ctrlsSvc.get("center"),t=e.hasHorizontalScrollGap(),i=e.hasVerticalScrollGap();(this.horizontalScrollGap!==t||this.verticalScrollGap!==i)&&(this.horizontalScrollGap=t,this.verticalScrollGap=i,this.eventSvc.dispatchEvent({type:"scrollGapChanged"}))}setScrollsVisible(e){(this.horizontalScrollShowing!==e.horizontalScrollShowing||this.verticalScrollShowing!==e.verticalScrollShowing)&&(this.horizontalScrollShowing=e.horizontalScrollShowing,this.verticalScrollShowing=e.verticalScrollShowing,this.eventSvc.dispatchEvent({type:"scrollVisibilityChanged"}))}getScrollbarWidth(){if(this.scrollbarWidth==null){let e=this.gos.get("scrollbarWidth"),i=typeof e=="number"&&e>=0?e:EB();i!=null&&(this.scrollbarWidth=i,this.eventSvc.dispatchEvent({type:"scrollbarWidthChanged"}))}return this.scrollbarWidth}},fq=class extends F{constructor(){super(...arguments),this.beanName="gridDestroySvc",this.destroyCalled=!1}destroy(){if(this.destroyCalled)return;let{stateSvc:e,ctrlsSvc:t,context:i}=this.beans;this.eventSvc.dispatchEvent({type:"gridPreDestroyed",state:e?.getState()??{}}),this.destroyCalled=!0,t.get("gridCtrl")?.destroyGridUi(),i.destroy(),super.destroy()}},kp=new Set(["gridPreDestroyed","fillStart","pasteStart"]),mq=["columnEverythingChanged","newColumnsLoaded","columnPivotModeChanged","pivotMaxColumnsExceeded","columnRowGroupChanged","expandOrCollapseAll","columnPivotChanged","gridColumnsChanged","columnValueChanged","columnMoved","columnVisible","columnPinned","columnGroupOpened","columnResized","displayedColumnsChanged","virtualColumnsChanged","columnHeaderMouseOver","columnHeaderMouseLeave","columnHeaderClicked","columnHeaderContextMenu","asyncTransactionsFlushed","rowGroupOpened","rowDataUpdated","pinnedRowDataChanged","pinnedRowsChanged","rangeSelectionChanged","cellSelectionChanged","chartCreated","chartRangeSelectionChanged","chartOptionsChanged","chartDestroyed","toolPanelVisibleChanged","toolPanelSizeChanged","modelUpdated","cutStart","cutEnd","pasteStart","pasteEnd","fillStart","fillEnd","cellSelectionDeleteStart","cellSelectionDeleteEnd","rangeDeleteStart","rangeDeleteEnd","undoStarted","undoEnded","redoStarted","redoEnded","cellClicked","cellDoubleClicked","cellMouseDown","cellContextMenu","cellValueChanged","cellEditRequest","rowValueChanged","headerFocused","cellFocused","rowSelected","selectionChanged","tooltipShow","tooltipHide","cellKeyDown","cellMouseOver","cellMouseOut","filterChanged","filterModified","filterUiChanged","filterOpened","floatingFilterUiChanged","advancedFilterBuilderVisibleChanged","sortChanged","virtualRowRemoved","rowClicked","rowDoubleClicked","gridReady","gridPreDestroyed","gridSizeChanged","viewportChanged","firstDataRendered","dragStarted","dragStopped","dragCancelled","rowEditingStarted","rowEditingStopped","cellEditingStarted","cellEditingStopped","bodyScroll","bodyScrollEnd","paginationChanged","componentStateChanged","storeRefreshed","stateUpdated","columnMenuVisibleChanged","contextMenuVisibleChanged","rowDragEnter","rowDragMove","rowDragLeave","rowDragEnd","rowDragCancel","findChanged","rowResizeStarted","rowResizeEnded","columnsReset","bulkEditingStarted","bulkEditingStopped","batchEditingStarted","batchEditingStopped"];var hw=mq.reduce((e,t)=>(e[t]=fN(t),e),{}),gd=(e,t)=>({tag:"span",ref:`eSort${e}`,cls:`ag-sort-indicator-icon ag-sort-${t} ag-hidden`,attrs:{"aria-hidden":"true"}}),Cq={tag:"span",cls:"ag-sort-indicator-container",children:[gd("Order","order"),gd("Asc","ascending-icon"),gd("Desc","descending-icon"),gd("Mixed","mixed-icon"),gd("None","none-icon")]},pw=class extends Be{constructor(e){super(),this.eSortOrder=U,this.eSortAsc=U,this.eSortDesc=U,this.eSortMixed=U,this.eSortNone=U,e||this.setTemplate(Cq)}attachCustomElements(e,t,i,n,s){this.eSortOrder=e,this.eSortAsc=t,this.eSortDesc=i,this.eSortMixed=n,this.eSortNone=s}setupSort(e,t=!1){if(this.column=e,this.suppressOrder=t,this.setupMultiSortIndicator(),!e.isSortable()&&!e.getColDef().showRowGroup)return;this.addInIcon("sortAscending",this.eSortAsc,e),this.addInIcon("sortDescending",this.eSortDesc,e),this.addInIcon("sortUnSort",this.eSortNone,e);let i=this.updateIcons.bind(this),n=this.onSortChanged.bind(this);this.addManagedPropertyListener("unSortIcon",i),this.addManagedEventListeners({newColumnsLoaded:i,sortChanged:n,columnRowGroupChanged:n}),this.onSortChanged()}addInIcon(e,t,i){if(t==null)return;let n=ji(e,this.beans,i);n&&t.appendChild(n)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){let{eSortAsc:e,eSortDesc:t,eSortNone:i,column:n,gos:s,beans:o}=this,r=o.sortSvc.getDisplaySortForColumn(n);if(e&&et(e,r==="asc",{skipAriaHidden:!0}),t&&et(t,r==="desc",{skipAriaHidden:!0}),i){let a=!n.getColDef().unSortIcon&&!s.get("unSortIcon"),l=r==null;et(i,!a&&l,{skipAriaHidden:!0})}}setupMultiSortIndicator(){let{eSortMixed:e,column:t,gos:i}=this;this.addInIcon("sortUnSort",e,t);let n=t.getColDef().showRowGroup;Ln(i)&&n&&(this.addManagedEventListeners({sortChanged:this.updateMultiSortIndicator.bind(this),columnRowGroupChanged:this.updateMultiSortIndicator.bind(this)}),this.updateMultiSortIndicator())}updateMultiSortIndicator(){let{eSortMixed:e,beans:t,column:i}=this;if(e){let n=t.sortSvc.getDisplaySortForColumn(i)==="mixed";et(e,n,{skipAriaHidden:!0})}}updateSortOrder(){let{eSortOrder:e,column:t,beans:{sortSvc:i}}=this;if(!e)return;let n=i.getColumnsWithSortingOrdered(),s=i.getDisplaySortIndexForColumn(t)??-1,o=n.some(a=>i.getDisplaySortIndexForColumn(a)??!1),r=s>=0&&o;et(e,r,{skipAriaHidden:!0}),s>=0?e.textContent=(s+1).toString():$t(e)}},vq={selector:"AG-SORT-INDICATOR",component:pw},Vd=["asc","desc",null],wq=class extends F{constructor(){super(...arguments),this.beanName="sortSvc"}progressSort(e,t,i){let n=this.getNextSortDirection(e);this.setSortForColumn(e,n,t,i)}progressSortFromEvent(e,t){let n=this.gos.get("multiSortKey")==="ctrl"?t.ctrlKey||t.metaKey:t.shiftKey;this.progressSort(e,n,"uiColumnSorted")}setSortForColumn(e,t,i,n){t!=="asc"&&t!=="desc"&&(t=null);let{gos:s,showRowGroupCols:o}=this.beans,r=Ln(s),a=[e];if(r&&e.getColDef().showRowGroup){let u=o?.getSourceColumnsForGroupColumn?.(e)?.filter(h=>h.isSortable());u&&(a=[e,...u])}for(let c of a)this.setColSort(c,t,n);let l=(i||s.get("alwaysMultiSort"))&&!s.get("suppressMultiSort"),d=[];if(!l){let c=this.clearSortBarTheseColumns(a,n);d.push(...c)}this.updateSortIndex(e),d.push(...a),this.dispatchSortChangedEvents(n,d)}updateSortIndex(e){let{gos:t,colModel:i,showRowGroupCols:n}=this.beans,s=Ln(t),o=n?.getShowRowGroupCol(e.getId()),r=s&&o||e,a=this.getColumnsWithSortingOrdered();i.forAllCols(c=>this.setColSortIndex(c,null));let l=a.filter(c=>s&&c.getColDef().showRowGroup?!1:c!==r);(r.getSort()?[...l,r]:l).forEach((c,u)=>this.setColSortIndex(c,u))}onSortChanged(e,t){this.dispatchSortChangedEvents(e,t)}isSortActive(){let e=!1;return this.beans.colModel.forAllCols(t=>{t.getSort()&&(e=!0)}),e}dispatchSortChangedEvents(e,t){let i={type:"sortChanged",source:e};t&&(i.columns=t),this.eventSvc.dispatchEvent(i)}clearSortBarTheseColumns(e,t){let i=[];return this.beans.colModel.forAllCols(n=>{e.includes(n)||(n.getSort()&&i.push(n),this.setColSort(n,void 0,t))}),i}getNextSortDirection(e){let t=e.getColDef().sortingOrder??this.gos.get("sortingOrder")??Vd,i=t.indexOf(e.getSort()),n=i<0,s=i==t.length-1;return n||s?t[0]:t[i+1]}getIndexedSortMap(){let{gos:e,colModel:t,showRowGroupCols:i,rowGroupColsSvc:n}=this.beans,s=[];if(t.forAllCols(d=>{d.getSort()&&s.push(d)}),t.isPivotMode()){let d=Ln(e);s=s.filter(c=>{let u=!!c.getAggFunc(),h=!c.isPrimary(),p=d?i?.getShowRowGroupCol(c.getId()):c.getColDef().showRowGroup;return u||h||p})}let o=n?.columns.filter(d=>!!d.getSort())??[],r={};s.forEach((d,c)=>r[d.getId()]=c),s.sort((d,c)=>{let u=d.getSortIndex(),h=c.getSortIndex();if(u!=null&&h!=null)return u-h;if(u==null&&h==null){let p=r[d.getId()],g=r[c.getId()];return p>g?1:-1}else return h==null?-1:1});let a=Ln(e)&&!!o.length;a&&(s=[...new Set(s.map(d=>i?.getShowRowGroupCol(d.getId())??d))]);let l=new Map;if(s.forEach((d,c)=>l.set(d,c)),a)for(let d of o){let c=i.getShowRowGroupCol(d.getId());l.set(d,l.get(c))}return l}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort(([,e],[,t])=>e-t).map(([e])=>e)}getSortModel(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),colId:e.getId()}))}getSortOptions(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),column:e}))}canColumnDisplayMixedSort(e){let t=Ln(this.gos),i=!!e.getColDef().showRowGroup;return t&&i}getDisplaySortForColumn(e){let t=this.beans.showRowGroupCols?.getSourceColumnsForGroupColumn(e);if(!this.canColumnDisplayMixedSort(e)||!t?.length)return e.getSort();let n=e.getColDef().field!=null||!!e.getColDef().valueGetter?[e,...t]:t,s=n[0].getSort();return n.every(r=>r.getSort()==s)?s:"mixed"}getDisplaySortIndexForColumn(e){return this.getIndexedSortMap().get(e)}setupHeader(e,t,i){let n=0;e.addManagedListeners(t,{movingChanged:()=>{n=Date.now()}}),i&&e.addManagedElementListeners(i,{click:o=>{let r=t.isMoving(),l=Date.now()-n<50;r||l||this.progressSortFromEvent(t,o)}});let s=()=>{let o=t.getSort();if(e.toggleCss("ag-header-cell-sorted-asc",o==="asc"),e.toggleCss("ag-header-cell-sorted-desc",o==="desc"),e.toggleCss("ag-header-cell-sorted-none",!o),t.getColDef().showRowGroup){let l=!this.beans.showRowGroupCols?.getSourceColumnsForGroupColumn(t)?.every(d=>t.getSort()==d.getSort());e.toggleCss("ag-header-cell-sorted-mixed",l)}};e.addManagedEventListeners({sortChanged:s,columnRowGroupChanged:s})}initCol(e){let{sort:t,initialSort:i,sortIndex:n,initialSortIndex:s}=e.colDef;t!==void 0?(t==="asc"||t==="desc")&&(e.sort=t):(i==="asc"||i==="desc")&&(e.sort=i),n!==void 0?n!==null&&(e.sortIndex=n):s!==null&&(e.sortIndex=s)}updateColSort(e,t,i){t!==void 0&&(t==="desc"||t==="asc"?this.setColSort(e,t,i):this.setColSort(e,void 0,i))}setColSort(e,t,i){e.sort!==t&&(e.sort=t,e.dispatchColEvent("sortChanged",i)),e.dispatchStateUpdatedEvent("sort")}setColSortIndex(e,t){e.sortIndex=t,e.dispatchStateUpdatedEvent("sortIndex")}createSortIndicator(e){return new pw(e)}getSortIndicatorSelector(){return vq}},_a={agSetColumnFilter:"SetFilter",agSetColumnFloatingFilter:"SetFilter",agMultiColumnFilter:"MultiFilter",agMultiColumnFloatingFilter:"MultiFilter",agGroupColumnFilter:"GroupFilter",agGroupColumnFloatingFilter:"GroupFilter",agGroupCellRenderer:"GroupCellRenderer",agGroupRowRenderer:"GroupCellRenderer",agRichSelect:"RichSelect",agRichSelectCellEditor:"RichSelect",agDetailCellRenderer:"SharedMasterDetail",agSparklineCellRenderer:"Sparklines",agDragAndDropImage:"SharedDragAndDrop",agColumnHeader:"ColumnHeaderComp",agColumnGroupHeader:"ColumnGroupHeaderComp",agSortIndicator:"Sort",agAnimateShowChangeCellRenderer:"HighlightChanges",agAnimateSlideCellRenderer:"HighlightChanges",agLoadingCellRenderer:"LoadingCellRenderer",agSkeletonCellRenderer:"SkeletonCellRenderer",agCheckboxCellRenderer:"CheckboxCellRenderer",agLoadingOverlay:"Overlay",agNoRowsOverlay:"Overlay",agTooltipComponent:"Tooltip",agReadOnlyFloatingFilter:"CustomFilter",agTextColumnFilter:"TextFilter",agNumberColumnFilter:"NumberFilter",agDateColumnFilter:"DateFilter",agDateInput:"DateFilter",agTextColumnFloatingFilter:"TextFilter",agNumberColumnFloatingFilter:"NumberFilter",agDateColumnFloatingFilter:"DateFilter",agCellEditor:"TextEditor",agSelectCellEditor:"SelectEditor",agTextCellEditor:"TextEditor",agNumberCellEditor:"NumberEditor",agDateCellEditor:"DateEditor",agDateStringCellEditor:"DateEditor",agCheckboxCellEditor:"CheckboxEditor",agLargeTextCellEditor:"LargeTextEditor",agMenuItem:"MenuItem",agColumnsToolPanel:"ColumnsToolPanel",agFiltersToolPanel:"FiltersToolPanel",agNewFiltersToolPanel:"NewFiltersToolPanel",agAggregationComponent:"StatusBar",agSelectedRowCountComponent:"StatusBar",agTotalRowCountComponent:"StatusBar",agFilteredRowCountComponent:"StatusBar",agTotalAndFilteredRowCountComponent:"StatusBar",agFindCellRenderer:"Find"};function a6(e){return`"${e}"`}var bq=()=>({checkboxSelection:{version:"32.2",message:"Use `rowSelection.checkboxes` in `GridOptions` instead."},headerCheckboxSelection:{version:"32.2",message:"Use `rowSelection.headerCheckbox = true` in `GridOptions` instead."},headerCheckboxSelectionFilteredOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "filtered"` in `GridOptions` instead.'},headerCheckboxSelectionCurrentPageOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "currentPage"` in `GridOptions` instead.'},showDisabledCheckboxes:{version:"32.2",message:"Use `rowSelection.hideDisabledCheckboxes = true` in `GridOptions` instead."},rowGroupingHierarchy:{version:"34.3",message:"Use `colDef.groupHierarchy` instead."}}),yq={aggFunc:"SharedAggregation",autoHeight:"RowAutoHeight",cellClass:"CellStyle",cellClassRules:"CellStyle",cellEditor:({cellEditor:e,editable:t})=>t?typeof e=="string"?_a[e]??"CustomEditor":"CustomEditor":null,cellRenderer:({cellRenderer:e})=>typeof e!="string"?null:_a[e],cellStyle:"CellStyle",columnChooserParams:"ColumnMenu",contextMenuItems:"ContextMenu",dndSource:"DragAndDrop",dndSourceOnRowDrag:"DragAndDrop",editable:({editable:e,cellEditor:t})=>e&&!t?"TextEditor":null,enableCellChangeFlash:"HighlightChanges",enablePivot:"SharedPivot",enableRowGroup:"SharedRowGrouping",enableValue:"SharedAggregation",filter:({filter:e})=>e&&typeof e!="string"&&typeof e!="boolean"?"CustomFilter":typeof e=="string"?_a[e]??"ColumnFilter":"ColumnFilter",floatingFilter:"ColumnFilter",getQuickFilterText:"QuickFilter",headerTooltip:"Tooltip",headerTooltipValueGetter:"Tooltip",mainMenuItems:"ColumnMenu",menuTabs:e=>{let t=["columnsMenuTab","generalMenuTab"];return e.menuTabs?.some(i=>t.includes(i))?"ColumnMenu":null},pivot:"SharedPivot",pivotIndex:"SharedPivot",rowDrag:"RowDrag",rowGroup:"SharedRowGrouping",rowGroupIndex:"SharedRowGrouping",tooltipField:"Tooltip",tooltipValueGetter:"Tooltip",tooltipComponentSelector:"Tooltip",spanRows:"CellSpan",groupHierarchy:"SharedRowGrouping"},Sq=()=>({autoHeight:{supportedRowModels:["clientSide","serverSide"],validate:(t,{paginationAutoPageSize:i})=>i?"colDef.autoHeight is not supported with paginationAutoPageSize.":null},cellRendererParams:{validate:t=>(t.rowGroup!=null||t.rowGroupIndex!=null||t.cellRenderer==="agGroupCellRenderer")&&"checkbox"in t.cellRendererParams?'Since v33.0, `cellRendererParams.checkbox` has been deprecated. Use `rowSelection.checkboxLocation = "autoGroupColumn"` instead.':null},flex:{validate:(t,i)=>i.autoSizeStrategy?"colDef.flex is not supported with gridOptions.autoSizeStrategy":null},headerCheckboxSelection:{supportedRowModels:["clientSide","serverSide"],validate:(t,{rowSelection:i})=>i==="multiple"?null:"headerCheckboxSelection is only supported with rowSelection=multiple"},headerCheckboxSelectionCurrentPageOnly:{supportedRowModels:["clientSide"],validate:(t,{rowSelection:i})=>i==="multiple"?null:"headerCheckboxSelectionCurrentPageOnly is only supported with rowSelection=multiple"},headerCheckboxSelectionFilteredOnly:{supportedRowModels:["clientSide"],validate:(t,{rowSelection:i})=>i==="multiple"?null:"headerCheckboxSelectionFilteredOnly is only supported with rowSelection=multiple"},headerValueGetter:{validate:t=>{let i=t.headerValueGetter;return typeof i=="function"||typeof i=="string"?null:"headerValueGetter must be a function or a valid string expression"}},icons:{validate:({icons:t})=>{if(t){if(t.smallDown)return Hn(262);if(t.smallLeft)return Hn(263);if(t.smallRight)return Hn(264)}return null}},sortingOrder:{validate:t=>{let i=t.sortingOrder;if(Array.isArray(i)&&i.length>0){let n=i.filter(s=>!Vd.includes(s));if(n.length>0)return`sortingOrder must be an array with elements from [${Vd.map(Op).join()}], currently it includes [${n.map(Op).join()}]`}else if(!Array.isArray(i)||i.length<=0)return`sortingOrder must be an array with at least one element, currently it's ${i}`;return null}},type:{validate:t=>{let i=t.type;return i instanceof Array?i.some(s=>typeof s!="string")?"if colDef.type is supplied an array it should be of type 'string[]'":null:typeof i=="string"?null:"colDef.type should be of type 'string' | 'string[]'"}},rowSpan:{validate:(t,{suppressRowTransform:i})=>i?null:"colDef.rowSpan requires suppressRowTransform to be enabled."},spanRows:{dependencies:{editable:{required:[!1,void 0]},rowDrag:{required:[!1,void 0]},colSpan:{required:[void 0]},rowSpan:{required:[void 0]}},validate:(t,{rowSelection:i,cellSelection:n,suppressRowTransform:s,enableCellSpan:o,rowDragEntireRow:r,enableCellTextSelection:a})=>typeof i=="object"&&i?.mode==="singleRow"&&i?.enableClickSelection?"colDef.spanRows is not supported with rowSelection.clickSelection":n?"colDef.spanRows is not supported with cellSelection.":s?"colDef.spanRows is not supported with suppressRowTransform.":o?r?"colDef.spanRows is not supported with rowDragEntireRow.":a?"colDef.spanRows is not supported with enableCellTextSelection.":null:"colDef.spanRows requires enableCellSpan to be enabled."},groupHierarchy:{validate(t,{groupHierarchyConfig:i={}},n){let s=new Set(["year","quarter","month","formattedMonth","day","hour","minute","second"]),o=[];for(let r of t.groupHierarchy??[]){if(typeof r=="object"){n.validation?.validateColDef(r);continue}!s.has(r)&&!(r in i)&&o.push(a6(r))}if(o.length>0){let r=`The following parts of colDef.groupHierarchy are not recognised: ${o.join(", ")}.`,a=`Choose one of ${[...s].map(a6).join(", ")}, or define your own parts in gridOptions.groupHierarchyConfig.`;return`${r}
${a}`}return null}}}),xq={headerName:void 0,columnGroupShow:void 0,headerStyle:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,headerTooltipValueGetter:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellAriaRole:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnChooserParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressHeaderMenuButton:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,spanRows:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,tooltipComponentSelector:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0,mainMenuItems:void 0,contextMenuItems:void 0,suppressFloatingFilterButton:void 0,suppressHeaderFilterButton:void 0,suppressHeaderContextMenu:void 0,loadingCellRenderer:void 0,loadingCellRendererParams:void 0,loadingCellRendererSelector:void 0,context:void 0,dateComponent:void 0,dateComponentParams:void 0,getFindText:void 0,rowGroupingHierarchy:void 0,groupHierarchy:void 0},Eq=()=>Object.keys(xq),Rq=()=>({objectName:"colDef",allProperties:Eq(),docsUrl:"column-properties/",deprecations:bq(),validations:Sq()}),Mq=["overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","groupDisplayType","treeDataDisplayType","treeDataChildrenField","treeDataParentIdField","colResizeDefault","tooltipTrigger","serverSidePivotResultFieldSeparator","columnMenu","tooltipShowMode","invalidEditValueMode","grandTotalRow","themeCssLayer","findSearchValue","styleNonce","renderingMode"],Dq=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","dragAndDropImageComponentParams","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","themeStyleContainer","statusBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions","advancedFilterParent","advancedFilterBuilderParams","advancedFilterParams","initialState","autoSizeStrategy","selectionColumnDef","findOptions","filterHandlers","groupHierarchyConfig"],kq=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass","paginationPageSizeSelector"],jM=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","groupLockGroupColumns","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","pivotDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDuration","cellFadeDuration","tabIndex","pivotMaxGeneratedColumns","rowDragInsertDelay"],Pq=["theme","rowSelection"],gw=["cellSelection","sideBar","rowNumbers","suppressGroupChangesColumnVisibility","groupAggFiltering","suppressStickyTotalRow","groupHideParentOfSingleChild","enableRowPinning"],KM=["loadThemeGoogleFonts","suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHeaderFocus","suppressHorizontalScroll","groupSelectsChildren","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressColumnMoveAnimation","suppressMoveWhenColumnDragging","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","allowContextMenuWithControlKey","suppressContextMenu","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressFocusAfterRefresh","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","enableCellSpan","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","includeHiddenColumnsInAdvancedFilter","suppressMultiRangeSelection","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","tooltipInteraction","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideSortAllLevels","serverSideEnableClientSideSort","serverSideOnlyRefreshFilteredGroups","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","groupMaintainOrder","columnHoverHighlight","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressCutToClipboard","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","enableAdvancedFilter","masterDetail","treeData","reactiveCustomComponents","applyQuickFilterBeforePivotOrAgg","suppressServerSideFullWidthLoadingRow","suppressAdvancedFilterEval","loading","maintainColumnOrder","enableStrictPivotColumnOrder","suppressSetFilterByDefault","enableFilterHandlers","suppressStartEditOnTab","hidePaddedHeaderRows","ssrmExpandAllAffectsAllRows"],Fq=["doesExternalFilterPass","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","dragAndDropImageComponent","fullWidthCellRenderer","loadingCellRenderer","loadingOverlayComponent","noRowsOverlayComponent","detailCellRenderer","quickFilterParser","quickFilterMatcher","getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getFullRowEditValidationErrors","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","focusGridInnerElement","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processUnpinnedColumns","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","loadingCellRendererSelector","getRowId","chartMenuItems","groupTotalRow","alwaysPassFilter","isRowPinnable","isRowPinned","isRowValidDropPosition"],Tq=()=>[...kq,...Dq,...Mq,...jM,...Fq,...KM,...gw,...Pq],Aq=()=>({suppressLoadingOverlay:{version:"32",message:"Use `loading`=false instead."},enableFillHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeSelection:{version:"32.2",message:"Use `cellSelection = true` instead."},suppressMultiRangeSelection:{version:"32.2",message:"Use `cellSelection.suppressMultiRanges` instead."},suppressClearOnFillReduction:{version:"32.2",message:"Use `cellSelection.handle.suppressClearOnFillReduction` instead."},fillHandleDirection:{version:"32.2",message:"Use `cellSelection.handle.direction` instead."},fillOperation:{version:"32.2",message:"Use `cellSelection.handle.setFillValue` instead."},suppressRowClickSelection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},suppressRowDeselection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},rowMultiSelectWithClick:{version:"32.2",message:"Use `rowSelection.enableSelectionWithoutKeys` instead."},groupSelectsChildren:{version:"32.2",message:'Use `rowSelection.groupSelects = "descendants"` instead.'},groupSelectsFiltered:{version:"32.2",message:'Use `rowSelection.groupSelects = "filteredDescendants"` instead.'},isRowSelectable:{version:"32.2",message:"Use `selectionOptions.isRowSelectable` instead."},suppressCopySingleCellRanges:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},suppressCopyRowsToClipboard:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},onRangeSelectionChanged:{version:"32.2",message:"Use `onCellSelectionChanged` instead."},onRangeDeleteStart:{version:"32.2",message:"Use `onCellSelectionDeleteStart` instead."},onRangeDeleteEnd:{version:"32.2",message:"Use `onCellSelectionDeleteEnd` instead."},suppressBrowserResizeObserver:{version:"32.2",message:"The grid always uses the browser's ResizeObserver, this grid option has no effect."},onColumnEverythingChanged:{version:"32.2",message:"Either use `onDisplayedColumnsChanged` which is fired at the same time, or use one of the more specific column events."},groupRemoveSingleChildren:{version:"33",message:"Use `groupHideParentOfSingleChild` instead."},groupRemoveLowestSingleChildren:{version:"33",message:'Use `groupHideParentOfSingleChild: "leafGroupsOnly"` instead.'},suppressRowGroupHidesColumns:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressHideOnGroup"` instead.'},suppressMakeColumnVisibleAfterUnGroup:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressShowOnUngroup"` instead.'},unSortIcon:{version:"33",message:"Use `defaultColDef.unSortIcon` instead."},sortingOrder:{version:"33",message:"Use `defaultColDef.sortingOrder` instead."},suppressPropertyNamesCheck:{version:"33",message:"`gridOptions` and `columnDefs` both have a `context` property that should be used for arbitrary user data. This means that column definitions and gridOptions should only contain valid properties making this property redundant."},suppressAdvancedFilterEval:{version:"34",message:"Advanced filter no longer uses function evaluation, so this option has no effect."}});function In(e,t,i){return typeof t=="number"||t==null?t==null||t>=i?null:`${e}: value should be greater than or equal to ${i}`:`${e}: value should be a number`}var Iq={alignedGrids:"AlignedGrids",allowContextMenuWithControlKey:"ContextMenu",autoSizeStrategy:"ColumnAutoSize",cellSelection:"CellSelection",columnHoverHighlight:"ColumnHover",datasource:"InfiniteRowModel",doesExternalFilterPass:"ExternalFilter",editType:"EditCore",invalidEditValueMode:"EditCore",enableAdvancedFilter:"AdvancedFilter",enableCellSpan:"CellSpan",enableCharts:"IntegratedCharts",enableRangeSelection:"CellSelection",enableRowPinning:"PinnedRow",findSearchValue:"Find",getFullRowEditValidationErrors:"EditCore",getContextMenuItems:"ContextMenu",getLocaleText:"Locale",getMainMenuItems:"ColumnMenu",getRowClass:"RowStyle",getRowStyle:"RowStyle",groupTotalRow:"SharedRowGrouping",grandTotalRow:"ClientSideRowModelHierarchy",initialState:"GridState",isExternalFilterPresent:"ExternalFilter",isRowPinnable:"PinnedRow",isRowPinned:"PinnedRow",localeText:"Locale",masterDetail:"SharedMasterDetail",pagination:"Pagination",pinnedBottomRowData:"PinnedRow",pinnedTopRowData:"PinnedRow",pivotMode:"SharedPivot",pivotPanelShow:"RowGroupingPanel",quickFilterText:"QuickFilter",rowClass:"RowStyle",rowClassRules:"RowStyle",rowData:"ClientSideRowModel",rowDragManaged:"RowDrag",rowGroupPanelShow:"RowGroupingPanel",rowNumbers:"RowNumbers",rowSelection:"SharedRowSelection",rowStyle:"RowStyle",serverSideDatasource:"ServerSideRowModel",sideBar:"SideBar",statusBar:"StatusBar",treeData:"SharedTreeData",undoRedoCellEditing:"UndoRedoEdit",valueCache:"ValueCache",viewportDatasource:"ViewportRowModel"},_q=()=>{let e={autoSizePadding:{validate({autoSizePadding:i}){return In("autoSizePadding",i,0)}},cacheBlockSize:{supportedRowModels:["serverSide","infinite"],validate({cacheBlockSize:i}){return In("cacheBlockSize",i,1)}},cacheOverflowSize:{validate({cacheOverflowSize:i}){return In("cacheOverflowSize",i,1)}},datasource:{supportedRowModels:["infinite"]},domLayout:{validate:i=>{let n=i.domLayout,s=["autoHeight","normal","print"];return n&&!s.includes(n)?`domLayout must be one of [${s.join()}], currently it's ${n}`:null}},enableFillHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeSelection:{dependencies:{rowDragEntireRow:{required:[!1,void 0]}}},enableRowPinning:{supportedRowModels:["clientSide"],validate({enableRowPinning:i,pinnedTopRowData:n,pinnedBottomRowData:s}){return i&&(n||s)?"Manual row pinning cannot be used together with pinned row data. Either set `enableRowPinning` to `false`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":null}},isRowPinnable:{supportedRowModels:["clientSide"],validate({enableRowPinning:i,isRowPinnable:n,pinnedTopRowData:s,pinnedBottomRowData:o}){return n&&(s||o)?"Manual row pinning cannot be used together with pinned row data. Either remove `isRowPinnable`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":!i&&n?"`isRowPinnable` requires `enableRowPinning` to be set.":null}},isRowPinned:{supportedRowModels:["clientSide"],validate({enableRowPinning:i,isRowPinned:n,pinnedTopRowData:s,pinnedBottomRowData:o}){return n&&(s||o)?"Manual row pinning cannot be used together with pinned row data. Either remove `isRowPinned`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":!i&&n?"`isRowPinned` requires `enableRowPinning` to be set.":null}},groupDefaultExpanded:{supportedRowModels:["clientSide"]},groupHideOpenParents:{supportedRowModels:["clientSide","serverSide"],dependencies:{groupTotalRow:{required:[void 0,"bottom"]},treeData:{required:[void 0,!1],reason:"Tree Data has values at the group level so it doesn't make sense to hide them."}}},groupHideParentOfSingleChild:{dependencies:{groupHideOpenParents:{required:[void 0,!1]}}},groupRemoveLowestSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveSingleChildren:{required:[void 0,!1]}}},groupRemoveSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveLowestSingleChildren:{required:[void 0,!1]}}},groupSelectsChildren:{dependencies:{rowSelection:{required:["multiple"]}}},groupHierarchyConfig:{validate({groupHierarchyConfig:i={}},n,s){for(let o of Object.keys(i))s.validation?.validateColDef(i[o]);return null}},icons:{validate:({icons:i})=>{if(i){if(i.smallDown)return Hn(262);if(i.smallLeft)return Hn(263);if(i.smallRight)return Hn(264)}return null}},infiniteInitialRowCount:{validate({infiniteInitialRowCount:i}){return In("infiniteInitialRowCount",i,1)}},initialGroupOrderComparator:{supportedRowModels:["clientSide"]},ssrmExpandAllAffectsAllRows:{validate:i=>{if(typeof i.ssrmExpandAllAffectsAllRows=="boolean"){if(i.rowModelType!=="serverSide")return"'ssrmExpandAllAffectsAllRows' is only supported with the Server Side Row Model.";if(i.ssrmExpandAllAffectsAllRows&&typeof i.getRowId!="function")return"'getRowId' callback must be provided for Server Side Row Model grouping to work correctly."}return null}},keepDetailRowsCount:{validate({keepDetailRowsCount:i}){return In("keepDetailRowsCount",i,1)}},paginationPageSize:{validate({paginationPageSize:i}){return In("paginationPageSize",i,1)}},paginationPageSizeSelector:{validate:i=>{let n=i.paginationPageSizeSelector;return typeof n=="boolean"||n==null||n.length?null:`'paginationPageSizeSelector' cannot be an empty array.
                    If you want to hide the page size selector, set paginationPageSizeSelector to false.`}},pivotMode:{dependencies:{treeData:{required:[!1,void 0],reason:"Pivot Mode is not supported with Tree Data."}}},quickFilterText:{supportedRowModels:["clientSide"]},rowBuffer:{validate({rowBuffer:i}){return In("rowBuffer",i,0)}},rowClass:{validate:i=>typeof i.rowClass=="function"?"rowClass should not be a function, please use getRowClass instead":null},rowData:{supportedRowModels:["clientSide"]},rowDragManaged:{supportedRowModels:["clientSide"],dependencies:{pagination:{required:[!1,void 0]}}},rowSelection:{validate({rowSelection:i}){return i&&typeof i=="string"?'As of version 32.2.1, using `rowSelection` with the values "single" or "multiple" has been deprecated. Use the object value instead.':i&&typeof i!="object"?"Expected `RowSelectionOptions` object for the `rowSelection` property.":i&&i.mode!=="multiRow"&&i.mode!=="singleRow"?`Selection mode "${i.mode}" is invalid. Use one of 'singleRow' or 'multiRow'.`:null}},rowStyle:{validate:i=>{let n=i.rowStyle;return n&&typeof n=="function"?"rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead":null}},serverSideDatasource:{supportedRowModels:["serverSide"]},serverSideInitialRowCount:{supportedRowModels:["serverSide"],validate({serverSideInitialRowCount:i}){return In("serverSideInitialRowCount",i,1)}},serverSideOnlyRefreshFilteredGroups:{supportedRowModels:["serverSide"]},serverSideSortAllLevels:{supportedRowModels:["serverSide"]},sortingOrder:{validate:i=>{let n=i.sortingOrder;if(Array.isArray(n)&&n.length>0){let s=n.filter(o=>!Vd.includes(o));if(s.length>0)return`sortingOrder must be an array with elements from [${Vd.map(Op).join()}], currently it includes [${s.map(Op).join()}]`}else if(!Array.isArray(n)||n.length<=0)return`sortingOrder must be an array with at least one element, currently it's ${n}`;return null}},tooltipHideDelay:{validate:i=>i.tooltipHideDelay&&i.tooltipHideDelay<0?"tooltipHideDelay should not be lower than 0":null},tooltipShowDelay:{validate:i=>i.tooltipShowDelay&&i.tooltipShowDelay<0?"tooltipShowDelay should not be lower than 0":null},treeData:{supportedRowModels:["clientSide","serverSide"],validate:i=>{let n=i.rowModelType??"clientSide";switch(n){case"clientSide":{let{treeDataChildrenField:s,treeDataParentIdField:o,getDataPath:r,getRowId:a}=i;if(!s&&!o&&!r)return"treeData requires either 'treeDataChildrenField' or 'treeDataParentIdField' or 'getDataPath' in the clientSide row model.";if(s){if(r)return"Cannot use both 'treeDataChildrenField' and 'getDataPath' at the same time.";if(o)return"Cannot use both 'treeDataChildrenField' and 'treeDataParentIdField' at the same time."}if(o){if(!a)return"getRowId callback not provided, tree data with parent id cannot be built.";if(r)return"Cannot use both 'treeDataParentIdField' and 'getDataPath' at the same time."}return null}case"serverSide":{let s=`treeData requires 'isServerSideGroup' and 'getServerSideGroupKey' in the ${n} row model.`;return i.isServerSideGroup&&i.getServerSideGroupKey?null:s}}return null}},viewportDatasource:{supportedRowModels:["viewport"]},viewportRowModelBufferSize:{validate({viewportRowModelBufferSize:i}){return In("viewportRowModelBufferSize",i,0)}},viewportRowModelPageSize:{validate({viewportRowModelPageSize:i}){return In("viewportRowModelPageSize",i,1)}},rowDragEntireRow:{dependencies:{cellSelection:{required:[void 0]}}},autoGroupColumnDef:{validate({autoGroupColumnDef:i,showOpenedGroup:n}){return i?.field&&n?"autoGroupColumnDef.field and showOpenedGroup are not supported when used together.":i?.valueGetter&&n?"autoGroupColumnDef.valueGetter and showOpenedGroup are not supported when used together.":null}},renderingMode:{validate:i=>{let n=i.renderingMode,s=["default","legacy"];return n&&!s.includes(n)?`renderingMode must be one of [${s.join()}], currently it's ${n}`:null}},autoSizeStrategy:{validate:({autoSizeStrategy:i})=>{if(!i)return null;let n=["fitCellContents","fitGridWidth","fitProvidedWidth"],s=i.type;return s!=="fitCellContents"&&s!=="fitGridWidth"&&s!=="fitProvidedWidth"?`Invalid Auto-size strategy. \`autoSizeStrategy\` must be one of ${n.map(o=>'"'+o+'"').join(", ")}, currently it's ${s}`:s==="fitProvidedWidth"&&typeof i.width!="number"?`When using the 'fitProvidedWidth' auto-size strategy, must provide a numeric \`width\`. You provided ${i.width}`:null}}},t={};for(let i of KM)t[i]={expectedType:"boolean"};for(let i of jM)t[i]={expectedType:"number"};return pi(t,e),t},Lq=()=>({objectName:"gridOptions",allProperties:[...Tq(),...Object.values(hw)],propertyExceptions:["api"],docsUrl:"grid-options/",deprecations:Aq(),validations:_q()}),Oq=0,Nq=0,l6="__ag_grid_instance",Bq=class extends F{constructor(){super(...arguments),this.beanName="gos",this.domDataKey="__AG_"+Math.random().toString(),this.instanceId=Nq++,this.gridReadyFired=!1,this.queueEvents=[],this.propEventSvc=new rr,this.globalEventHandlerFactory=e=>(t,i)=>{if(!this.isAlive())return;let n=kp.has(t);if(n&&!e||!n&&e||!Hq(t))return;let s=(o,r)=>{let a=hw[o],l=this.gridOptions[a];typeof l=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>l(r))};if(this.gridReadyFired)s(t,i);else if(t==="gridReady"){s(t,i),this.gridReadyFired=!0;for(let o of this.queueEvents)s(o.eventName,o.event);this.queueEvents=[]}else this.queueEvents.push({eventName:t,event:i})}}wireBeans(e){this.gridOptions=e.gridOptions,this.validation=e.validation,this.api=e.gridApi,this.gridId=e.context.getId()}get gridOptionsContext(){return this.gridOptions.context}postConstruct(){this.validateGridOptions(this.gridOptions),this.eventSvc.addGlobalListener(this.globalEventHandlerFactory().bind(this),!0),this.eventSvc.addGlobalListener(this.globalEventHandlerFactory(!0).bind(this),!1),this.propEventSvc.setFrameworkOverrides(this.beans.frameworkOverrides),this.addManagedEventListeners({gridOptionsChanged:({options:e})=>{this.updateGridOptions({options:e,force:!0,source:"optionsUpdated"})}})}destroy(){super.destroy(),this.queueEvents=[]}get(e){return this.gridOptions[e]??WO[e]}getCallback(e){return this.mergeGridCommonParams(this.gridOptions[e])}exists(e){return K(this.gridOptions[e])}mergeGridCommonParams(e){return e&&(i=>e(this.addCommon(i)))}updateGridOptions({options:e,force:t,source:i="api"}){let n={id:Oq++,properties:[]},s=[],{gridOptions:o,validation:r}=this;for(let a of Object.keys(e)){let l=Vv.applyGlobalGridOption(a,e[a]);r?.warnOnInitialPropertyUpdate(i,a);let d=t||typeof l=="object"&&i==="api",c=o[a];if(d||c!==l){o[a]=l;let u={type:a,currentValue:l,previousValue:c,changeSet:n,source:i};s.push(u)}}this.validateGridOptions(this.gridOptions),n.properties=s.map(a=>a.type);for(let a of s)ro(this,`Updated property ${a.type} from`,a.previousValue," to ",a.currentValue),this.propEventSvc.dispatchEvent(a)}addPropertyEventListener(e,t){this.propEventSvc.addEventListener(e,t)}removePropertyEventListener(e,t){this.propEventSvc.removeEventListener(e,t)}getDomDataKey(){return this.domDataKey}addCommon(e){return e.api=this.api,e.context=this.gridOptionsContext,e}validateOptions(e,t){for(let i of Object.keys(e)){let n=e[i];if(n==null||n===!1)continue;let s=t[i];typeof s=="function"&&(s=s(e,this.gridOptions,this.beans)),s&&this.assertModuleRegistered(s,i)}}validateGridOptions(e){this.validateOptions(e,Iq),this.validation?.processGridOptions(e)}validateColDef(e,t,i){(i||!this.beans.dataTypeSvc?.isColPendingInference(t))&&(this.validateOptions(e,yq),this.validation?.validateColDef(e))}assertModuleRegistered(e,t){let i=Array.isArray(e)?e.some(n=>this.isModuleRegistered(n)):this.isModuleRegistered(e);return i||Ge(200,O(b({},this.getModuleErrorParams()),{moduleName:e,reasonOrId:t})),i}getModuleErrorParams(){return{gridId:this.gridId,gridScoped:Gv(),rowModelType:this.get("rowModelType"),isUmd:Q6()}}isModuleRegistered(e){return ev(e,this.gridId,this.get("rowModelType"))}setInstanceDomData(e){e[l6]=this.instanceId}isElementInThisInstance(e){let t=e;for(;t;){let i=t[l6];if(K(i))return i===this.instanceId;t=t.parentElement}return!1}};function Hq(e){return!!hw[e]}function YM(e){let t={"aria-hidden":"true"};return{tag:"div",cls:"ag-cell-label-container",role:"presentation",children:[{tag:"span",ref:"eMenu",cls:"ag-header-icon ag-header-cell-menu-button",attrs:t},{tag:"span",ref:"eFilterButton",cls:"ag-header-icon ag-header-cell-filter-button",attrs:t},{tag:"div",ref:"eLabel",cls:"ag-header-cell-label",role:"presentation",children:[{tag:"span",ref:"eText",cls:"ag-header-cell-text"},{tag:"span",ref:"eFilter",cls:"ag-header-icon ag-header-label-icon ag-filter-icon",attrs:t},e?{tag:"ag-sort-indicator",ref:"eSortIndicator"}:null]}]}}var Vq=YM(!0),Gq=YM(!1),zq=class extends Be{constructor(){super(...arguments),this.eFilter=U,this.eFilterButton=U,this.eSortIndicator=U,this.eMenu=U,this.eLabel=U,this.eText=U,this.eSortOrder=U,this.eSortAsc=U,this.eSortDesc=U,this.eSortMixed=U,this.eSortNone=U,this.isLoadingInnerComponent=!1}refresh(e){let t=this.params;if(this.params=e,this.workOutTemplate(e,!!this.beans?.sortSvc)!=this.currentTemplate||this.workOutShowMenu()!=this.currentShowMenu||e.enableSorting!=this.currentSort||this.currentSuppressMenuHide!=null&&this.shouldSuppressMenuHide()!=this.currentSuppressMenuHide||t.enableFilterButton!=e.enableFilterButton||t.enableFilterIcon!=e.enableFilterIcon)return!1;if(this.innerHeaderComponent){let i=b({},e);pi(i,e.innerHeaderComponentParams),this.innerHeaderComponent.refresh?.(i)}else this.setDisplayName(e);return!0}workOutTemplate(e,t){let i=e.template;return i?i?.trim?i.trim():i:t?Vq:Gq}init(e){this.params=e;let{sortSvc:t,touchSvc:i,rowNumbersSvc:n,userCompFactory:s}=this.beans,o=t?.getSortIndicatorSelector();this.currentTemplate=this.workOutTemplate(e,!!o),this.setTemplate(this.currentTemplate,o?[o]:void 0),i?.setupForHeader(this),this.setMenu(),this.setupSort(),n?.setupForHeader(this),this.setupFilterIcon(),this.setupFilterButton(),this.workOutInnerHeaderComponent(s,e),this.setDisplayName(e)}workOutInnerHeaderComponent(e,t){let i=dB(e,t,t);i&&(this.isLoadingInnerComponent=!0,i.newAgStackInstance().then(n=>{this.isLoadingInnerComponent=!1,n&&(this.isAlive()?(this.innerHeaderComponent=n,this.eText&&this.eText.appendChild(n.getGui())):this.destroyBean(n))}))}setDisplayName(e){let{displayName:t}=e,i=this.currentDisplayName;this.currentDisplayName=t,!(!this.eText||i===t||this.innerHeaderComponent||this.isLoadingInnerComponent)&&(this.eText.textContent=Wa(t))}addInIcon(e,t,i){let n=ji(e,this.beans,i);n&&t.appendChild(n)}workOutShowMenu(){return this.params.enableMenu&&!!this.beans.menuSvc?.isHeaderMenuButtonEnabled()}shouldSuppressMenuHide(){return!!this.beans.menuSvc?.isHeaderMenuButtonAlwaysShowEnabled()}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu){yi(this.eMenu),this.eMenu=void 0;return}let{gos:e,eMenu:t,params:i}=this,n=Ti(e);this.addInIcon(n?"menu":"menuAlt",t,i.column),t.classList.toggle("ag-header-menu-icon",!n);let s=this.shouldSuppressMenuHide();this.currentSuppressMenuHide=s,this.addManagedElementListeners(t,{click:()=>this.showColumnMenu(this.eMenu)}),this.toggleMenuAlwaysShow(s)}toggleMenuAlwaysShow(e){this.eMenu?.classList.toggle("ag-header-menu-always-show",e)}showColumnMenu(e){let{currentSuppressMenuHide:t,params:i}=this;t||this.toggleMenuAlwaysShow(!0),i.showColumnMenu(e,()=>{t||this.toggleMenuAlwaysShow(!1)})}onMenuKeyboardShortcut(e){let{params:t,gos:i,beans:n,eMenu:s,eFilterButton:o}=this,r=t.column,a=Ti(i);if(e&&!a){if(n.menuSvc?.isFilterMenuInHeaderEnabled(r))return t.showFilter(o??s??this.getGui()),!0}else if(t.enableMenu)return this.showColumnMenu(s??o??this.getGui()),!0;return!1}setupSort(){let{sortSvc:e}=this.beans;if(!e)return;let{enableSorting:t,column:i}=this.params;if(this.currentSort=t,!this.eSortIndicator){this.eSortIndicator=this.createBean(e.createSortIndicator(!0));let{eSortIndicator:n,eSortOrder:s,eSortAsc:o,eSortDesc:r,eSortMixed:a,eSortNone:l}=this;n.attachCustomElements(s,o,r,a,l)}this.eSortIndicator.setupSort(i),this.currentSort&&e.setupHeader(this,i,this.eLabel)}setupFilterIcon(){let{eFilter:e,params:t}=this;if(!e)return;let i=()=>{let n=t.column.isFilterActive();et(e,n,{skipAriaHidden:!0})};this.configureFilter(t.enableFilterIcon,e,i,"filterActive")}setupFilterButton(){let{eFilterButton:e,params:t}=this;if(!e)return;this.configureFilter(t.enableFilterButton,e,this.onFilterChangedButton.bind(this),"filter")?this.addManagedElementListeners(e,{click:()=>t.showFilter(e)}):this.eFilterButton=void 0}configureFilter(e,t,i,n){if(!e)return yi(t),!1;let s=this.params.column;return this.addInIcon(n,t,s),this.addManagedListeners(s,{filterChanged:i}),i(),!0}onFilterChangedButton(){let e=this.params.column.isFilterActive();this.eFilterButton.classList.toggle("ag-filter-active",e)}getAnchorElementForMenu(e){let{eFilterButton:t,eMenu:i}=this;return e?t??i??this.getGui():i??t??this.getGui()}destroy(){super.destroy(),this.innerHeaderComponent&&(this.destroyBean(this.innerHeaderComponent),this.innerHeaderComponent=void 0)}},Wq={tag:"div",cls:"ag-header-group-cell-label",role:"presentation",children:[{tag:"span",ref:"agLabel",cls:"ag-header-group-text",role:"presentation"},{tag:"span",ref:"agOpened",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"},{tag:"span",ref:"agClosed",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"}]},Uq=class extends Be{constructor(){super(Wq),this.agOpened=U,this.agClosed=U,this.agLabel=U,this.isLoadingInnerComponent=!1}init(e){let{userCompFactory:t,touchSvc:i}=this.beans;this.params=e,this.checkWarnings(),this.workOutInnerHeaderGroupComponent(t,e),this.setupLabel(e),this.addGroupExpandIcon(e),this.setupExpandIcons(),i?.setupForHeaderGroup(this)}checkWarnings(){this.params.template&&I(89)}workOutInnerHeaderGroupComponent(e,t){let i=uB(e,t,t);i&&(this.isLoadingInnerComponent=!0,i.newAgStackInstance().then(n=>{this.isLoadingInnerComponent=!1,n&&(this.isAlive()?(this.innerHeaderGroupComponent=n,this.agLabel.appendChild(n.getGui())):this.destroyBean(n))}))}setupExpandIcons(){let{agOpened:e,agClosed:t,params:{columnGroup:i},beans:n}=this;this.addInIcon("columnGroupOpened",e),this.addInIcon("columnGroupClosed",t);let s=l=>{if(Ms(l))return;let d=!i.isExpanded();n.colGroupSvc.setColumnGroupOpened(i.getProvidedColumnGroup(),d,"uiColumnExpanded")};this.addTouchAndClickListeners(n,t,s),this.addTouchAndClickListeners(n,e,s);let o=l=>{dr(l)};this.addManagedElementListeners(t,{dblclick:o}),this.addManagedElementListeners(e,{dblclick:o}),this.addManagedElementListeners(this.getGui(),{dblclick:s}),this.updateIconVisibility();let r=i.getProvidedColumnGroup(),a=this.updateIconVisibility.bind(this);this.addManagedListeners(r,{expandedChanged:a,expandableChanged:a})}addTouchAndClickListeners(e,t,i){e.touchSvc?.setupForHeaderGroupElement(this,t,i),this.addManagedElementListeners(t,{click:i})}updateIconVisibility(){let{agOpened:e,agClosed:t,params:{columnGroup:i}}=this;if(i.isExpandable()){let n=i.isExpanded();et(e,n),et(t,!n)}else et(e,!1),et(t,!1)}addInIcon(e,t){let i=ji(e,this.beans,null);i&&t.appendChild(i)}addGroupExpandIcon(e){if(!e.columnGroup.isExpandable()){let{agOpened:t,agClosed:i}=this;et(t,!1),et(i,!1)}}setupLabel(e){let{displayName:t,columnGroup:i}=e,n=this.innerHeaderGroupComponent||this.isLoadingInnerComponent;K(t)&&!n&&(this.agLabel.textContent=Wa(t)),this.toggleCss("ag-sticky-label",!i.getColGroupDef()?.suppressStickyLabel)}destroy(){super.destroy(),this.innerHeaderGroupComponent&&(this.destroyBean(this.innerHeaderGroupComponent),this.innerHeaderGroupComponent=void 0)}},qq={moduleName:"ColumnHeaderComp",version:q,userComponents:{agColumnHeader:zq},icons:{menu:"menu",menuAlt:"menu-alt"}},$q={moduleName:"ColumnGroupHeaderComp",version:q,userComponents:{agColumnGroupHeader:Uq},icons:{columnGroupOpened:"expanded",columnGroupClosed:"contracted"}},jq=class extends F{constructor(){super(...arguments),this.beanName="animationFrameSvc",this.p1={list:[],sorted:!1},this.p2={list:[],sorted:!1},this.f1={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastScrollTop=0,this.taskCount=0}setScrollTop(e){this.scrollGoingDown=e>=this.lastScrollTop,e===0&&(this.scrollGoingDown=!0),this.lastScrollTop=e}postConstruct(){this.active=!this.gos.get("suppressAnimationFrame"),this.batchFrameworkComps=this.beans.frameworkOverrides.batchFrameworkComps}verify(){this.active===!1&&I(92)}createTask(e,t,i,n,s=!1){this.verify();let o=i;n&&this.batchFrameworkComps&&(o="f1");let r={task:e,index:t,createOrder:++this.taskCount,deferred:s};this.addTaskToList(this[o],r),this.schedule()}addTaskToList(e,t){e.list.push(t),e.sorted=!1}sortTaskList(e){if(e.sorted)return;let t=this.scrollGoingDown?1:-1;e.list.sort((i,n)=>i.deferred!==n.deferred?i.deferred?-1:1:i.index!==n.index?t*(n.index-i.index):n.createOrder-i.createOrder),e.sorted=!0}addDestroyTask(e){this.verify(),this.destroyTasks.push(e),this.schedule()}executeFrame(e){let{p1:t,p2:i,f1:n,destroyTasks:s,beans:o}=this,{ctrlsSvc:r,frameworkOverrides:a}=o,l=t.list,d=i.list,c=n.list,u=Date.now(),h=0,p=e<=0,g=r.getScrollFeature();for(;p||h<e;){if(!g.scrollGridIfNeeded()){let m;if(l.length)this.sortTaskList(t),m=l.pop().task;else if(d.length)this.sortTaskList(i),m=d.pop().task;else if(c.length)a.wrapOutgoing(()=>{for(;(p||h<e)&&!g.scrollGridIfNeeded();){if(c.length)this.sortTaskList(n),m=c.pop().task,m();else break;h=Date.now()-u}}),m=()=>{};else if(s.length)m=s.pop();else break;m()}h=Date.now()-u}l.length||d.length||c.length||s.length?this.requestFrame():this.ticking=!1}flushAllFrames(){this.active&&this.executeFrame(-1)}schedule(){this.active&&(this.ticking||(this.ticking=!0,this.requestFrame()))}requestFrame(){let e=this.executeFrame.bind(this,60);Ps(this.beans,e)}isQueueEmpty(){return!this.ticking}},Kq={moduleName:"AnimationFrame",version:q,beans:[jq]},Yq=class extends F{constructor(){super(...arguments),this.beanName="iconSvc"}createIconNoSpan(e,t){return ji(e,this.beans,t?.column)}},Xq=class extends F{constructor(){super(...arguments),this.beanName="touchSvc"}mockBodyContextMenu(e,t){this.mockContextMenu(e,e.eBodyViewport,t)}mockHeaderContextMenu(e,t){this.mockContextMenu(e,e.eGui,t)}mockRowContextMenu(e){if(!nr())return;let t=(i,n,s)=>{let{rowCtrl:o,cellCtrl:r}=e.getControlsForEventTarget(s?.target??null);r?.column&&r.dispatchCellContextMenuEvent(s??null),this.beans.contextMenuSvc?.handleContextMenuMouseEvent(void 0,s,o,r)};this.mockContextMenu(e,e.element,t)}handleCellDoubleClick(e,t){return(()=>{if(!nr()||U6("dblclick"))return!1;let n=Date.now(),s=n-e.lastIPadMouseClickEvent<200;return e.lastIPadMouseClickEvent=n,s})()?(e.onCellDoubleClicked(t),t.preventDefault(),!0):!1}setupForHeader(e){let{gos:t,sortSvc:i,menuSvc:n}=this.beans;if(t.get("suppressTouch"))return;let{params:s,eMenu:o,eFilterButton:r}=e,a=new Jo(e.getGui(),!0);e.addDestroyFunc(()=>a.destroy());let l=e.shouldSuppressMenuHide(),d=l&&K(o)&&s.enableMenu,c=a;if(d&&(c=new Jo(o,!0),e.addDestroyFunc(()=>c.destroy())),s.enableMenu||n?.isHeaderContextMenuEnabled(s.column)){let u=d?"tap":"longTap",h=p=>s.showColumnMenuAfterMouseClick(p.touchStart);e.addManagedListeners(c,{[u]:h}),e.addManagedListeners(a,{longTap:h})}if(s.enableSorting){let u=h=>{let p=h.touchStart.target;l&&(o?.contains(p)||r?.contains(p))||i?.progressSort(s.column,!1,"uiColumnSorted")};e.addManagedListeners(a,{tap:u})}if(s.enableFilterButton&&r){let u=new Jo(r,!0);e.addManagedListeners(u,{tap:()=>s.showFilter(r)}),e.addDestroyFunc(()=>u.destroy())}}setupForHeaderGroup(e){let t=e.params;if(this.beans.menuSvc?.isHeaderContextMenuEnabled(t.columnGroup.getProvidedColumnGroup())){let i=new Jo(t.eGridHeader,!0),n=s=>t.showColumnMenuAfterMouseClick(s.touchStart);e.addManagedListeners(i,{longTap:n}),e.addDestroyFunc(()=>i.destroy())}}setupForHeaderGroupElement(e,t,i){let n=new Jo(t,!0);e.addManagedListeners(n,{tap:i}),e.addDestroyFunc(()=>n.destroy())}mockContextMenu(e,t,i){if(!nr())return;let n=new Jo(t),s=o=>{Id(this.beans,o.touchEvent)&&i(void 0,o.touchStart,o.touchEvent)};e.addManagedListeners(n,{longTap:s}),e.addDestroyFunc(()=>n.destroy())}},Jq={moduleName:"Touch",version:q,beans:[Xq]},Qq=class extends F{constructor(){super(...arguments),this.beanName="cellNavigation"}wireBeans(e){this.rowSpanSvc=e.rowSpanSvc}getNextCellToFocus(e,t,i=!1){return i?this.getNextCellToFocusWithCtrlPressed(e,t):this.getNextCellToFocusWithoutCtrlPressed(e,t)}getNextCellToFocusWithCtrlPressed(e,t){let i=e===k.UP,n=e===k.DOWN,s=e===k.LEFT,o,r,{pageBounds:a,gos:l,visibleCols:d,pinnedRowModel:c}=this.beans,{rowPinned:u}=t;if(i||n)u&&c?i?r=0:r=u==="top"?c.getPinnedTopRowCount()-1:c.getPinnedBottomRowCount()-1:r=i?a.getFirstRow():a.getLastRow(),o=t.column;else{let h=l.get("enableRtl");r=t.rowIndex,o=(s!==h?d.allCols:[...d.allCols].reverse()).find(g=>this.isCellGoodToFocusOn({rowIndex:r,rowPinned:null,column:g}))}return o?{rowIndex:r,rowPinned:u,column:o}:null}getNextCellToFocusWithoutCtrlPressed(e,t){let i=t,n=!1;for(;!n;){switch(e){case k.UP:i=this.getCellAbove(i);break;case k.DOWN:i=this.getCellBelow(i);break;case k.RIGHT:i=this.gos.get("enableRtl")?this.getCellToLeft(i):this.getCellToRight(i);break;case k.LEFT:i=this.gos.get("enableRtl")?this.getCellToRight(i):this.getCellToLeft(i);break;default:i=null,I(8,{key:e});break}i?n=this.isCellGoodToFocusOn(i):n=!0}return i}isCellGoodToFocusOn(e){let t=e.column,i,{pinnedRowModel:n,rowModel:s}=this.beans;switch(e.rowPinned){case"top":i=n?.getPinnedTopRow(e.rowIndex);break;case"bottom":i=n?.getPinnedBottomRow(e.rowIndex);break;default:i=s.getRow(e.rowIndex);break}return i?!this.isSuppressNavigable(t,i):!1}getCellToLeft(e){if(!e)return null;let t=this.beans.visibleCols.getColBefore(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellToRight(e){if(!e)return null;let t=this.beans.visibleCols.getColAfter(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellBelow(e){if(!e)return null;let t=this.rowSpanSvc?.getCellEnd(e)??e,i=KR(this.beans,t,!0);return i?{rowIndex:i.rowIndex,column:e.column,rowPinned:i.rowPinned}:null}getCellAbove(e){if(!e)return null;let t=this.rowSpanSvc?.getCellStart(e)??e,i=Kp(this.beans,{rowIndex:t.rowIndex,rowPinned:t.rowPinned},!0);return i?{rowIndex:i.rowIndex,column:e.column,rowPinned:i.rowPinned}:null}getNextTabbedCell(e,t){return t?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)}getNextTabbedCellForwards(e){let{visibleCols:t,pagination:i}=this.beans,n=t.allCols,s=e.rowIndex,o=e.rowPinned,r=t.getColAfter(e.column);if(!r){r=n[0];let a=KR(this.beans,e,!0);if(tt(a)||!a.rowPinned&&!(i?.isRowInPage(a.rowIndex)??!0))return null;s=a?a.rowIndex:null,o=a?a.rowPinned:null}return{rowIndex:s,column:r,rowPinned:o}}getNextTabbedCellBackwards(e){let{beans:t}=this,{visibleCols:i,pagination:n}=t,s=i.allCols,o=e.rowIndex,r=e.rowPinned,a=i.getColBefore(e.column);if(!a){a=je(s);let l=Kp(t,{rowIndex:e.rowIndex,rowPinned:e.rowPinned},!0);if(tt(l)||!l.rowPinned&&!(n?.isRowInPage(l.rowIndex)??!0))return null;o=l?l.rowIndex:null,r=l?l.rowPinned:null}return{rowIndex:o,column:a,rowPinned:r}}isSuppressNavigable(e,t){let{suppressNavigable:i}=e.colDef;if(typeof i=="boolean")return i;if(typeof i=="function"){let n=e.createColumnFunctionCallbackParams(t);return i(n)}return!1}};function Zq(e){return e.focusSvc.getFocusedCell()}function e$(e){return e.focusSvc.clearFocusedCell()}function t$(e,t,i,n){e.focusSvc.setFocusedCell({rowIndex:t,column:i,rowPinned:n,forceBrowserFocus:!0})}function i$(e,t){return e.navigation?.tabToNextCell(!1,t)??!1}function n$(e,t){return e.navigation?.tabToNextCell(!0,t)??!1}function s$(e,t,i=!1){let n=e.headerNavigation?.getHeaderPositionForColumn(t,i);n&&e.focusSvc.focusHeaderPosition({headerPosition:n})}var o$=class extends F{constructor(){super(...arguments),this.beanName="editModelSvc",this.edits=new Map,this.cellValidations=new XM,this.rowValidations=new JM,this.suspendEdits=!1}suspend(e){this.suspendEdits=e}removeEdits({rowNode:e,column:t}){if(!this.hasEdits({rowNode:e})||!e)return;let i=this.getEditRow(e);t?i.delete(t):i.clear(),i.size===0&&this.edits.delete(e)}getEditRow(e,t={}){if(this.suspendEdits||this.edits.size===0)return;let i=e&&this.edits.get(e);if(i)return i;if(t.checkSiblings){let n=e.pinnedSibling;if(n)return this.getEditRow(n)}}getEditRowDataValue(e,{checkSiblings:t}={}){if(!e||this.edits.size===0)return;let i=this.getEditRow(e),n=e.pinnedSibling,s=t&&n&&this.getEditRow(n);if(!i&&!s)return;let o=Object.assign({},e.data),r=(a,l)=>a.forEach(({pendingValue:d},c)=>{d!==Ki&&(l[c.getColId()]=d)});return i&&r(i,o),s&&r(s,o),o}getEdit(e,t){let i=this._getEdit(e);return t&&i?b({},i):i}_getEdit(e){if(!this.suspendEdits&&this.edits.size!==0)return e.rowNode&&e.column&&this.getEditRow(e.rowNode)?.get(e.column)}getEditMap(e=!0){if(this.suspendEdits||this.edits.size===0)return new Map;if(!e)return this.edits;let t=new Map;return this.edits.forEach((i,n)=>{let s=new Map;i.forEach((l,a)=>{var d=l,{editorState:o}=d,r=gi(d,["editorState"]);return s.set(a,b({},r))}),t.set(n,s)}),t}setEditMap(e){this.edits.clear(),e.forEach((t,i)=>{let n=new Map;t.forEach((s,o)=>n.set(o,b({},s))),this.edits.set(i,n)})}setEdit(e,t){(this.edits.size===0||!this.edits.has(e.rowNode))&&this.edits.set(e.rowNode,new Map);let i=this._getEdit(e),n=Object.assign(b(b({editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}},i),t));return this.getEditRow(e.rowNode).set(e.column,n),n}clearEditValue(e){let{rowNode:t,column:i}=e;if(t)if(i){let n=this._getEdit(e);n&&(n.editorValue=void 0,n.pendingValue=n.sourceValue,n.state="changed")}else this.getEditRow(t)?.forEach(n=>{n.editorValue=void 0,n.pendingValue=n.sourceValue,n.state="changed"})}getState(e){if(!this.suspendEdits)return this.getEdit(e)?.state}getEditPositions(e){if(this.suspendEdits||(e??this.edits).size===0)return[];let t=[];return(e??this.edits).forEach((i,n)=>{for(let o of i.keys()){let s=i.get(o),{editorState:r}=s,a=gi(s,["editorState"]);t.push(b({rowNode:n,column:o},a))}}),t}hasRowEdits(e,t){return this.suspendEdits||this.edits.size===0?!1:!!this.getEditRow(e,t)}hasEdits(e={},t={}){if(this.suspendEdits||this.edits.size===0)return!1;let{rowNode:i,column:n}=e,{withOpenEditor:s}=t;if(i){let o=this.getEditRow(i,t);return o?n?s?this.getEdit(e)?.state==="editing":o.has(n)??!1:o.size!==0?s?Array.from(o.values()).some(({state:r})=>r==="editing"):!0:!1:!1}return s?this.getEditPositions().some(({state:o})=>o==="editing"):this.edits.size>0}start(e){let t=this.getEditRow(e.rowNode)??new Map,{rowNode:i,column:n}=e;n&&!t.has(n)&&t.set(n,{editorValue:void 0,pendingValue:Ki,sourceValue:this.beans.valueSvc.getValue(n,i,!1,"api"),state:"editing",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}}),this.edits.set(i,t)}stop(e){this.hasEdits(e)&&(e?this.removeEdits(e):this.clear())}clear(){for(let e of this.edits.values())e.clear();this.edits.clear()}getCellValidationModel(){return this.cellValidations}getRowValidationModel(){return this.rowValidations}setCellValidationModel(e){this.cellValidations=e}setRowValidationModel(e){this.rowValidations=e}destroy(){super.destroy(),this.clear()}},XM=class{constructor(){this.cellValidations=new Map}getCellValidation(e){let{rowNode:t,column:i}=e||{};return this.cellValidations?.get(t)?.get(i)}hasCellValidation(e){return!e?.rowNode||!e.column?this.cellValidations.size>0:!!this.getCellValidation(e)}setCellValidation(e,t){let{rowNode:i,column:n}=e;this.cellValidations.has(i)||this.cellValidations.set(i,new Map),this.cellValidations.get(i).set(n,t)}clearCellValidation(e){let{rowNode:t,column:i}=e;this.cellValidations.get(t)?.delete(i)}setCellValidationMap(e){this.cellValidations=e}getCellValidationMap(){return this.cellValidations}clearCellValidationMap(){this.cellValidations.clear()}},JM=class{constructor(){this.rowValidations=new Map}getRowValidation(e){let{rowNode:t}=e||{};return this.rowValidations.get(t)}hasRowValidation(e){return e?.rowNode?!!this.getRowValidation(e):this.rowValidations.size>0}setRowValidation({rowNode:e},t){this.rowValidations.set(e,t)}clearRowValidation({rowNode:e}){this.rowValidations.delete(e)}setRowValidationMap(e){this.rowValidations=e}getRowValidationMap(){return this.rowValidations}clearRowValidationMap(){this.rowValidations.clear()}};function fw(e,t={}){let{rowIndex:i,rowId:n,rowCtrl:s,rowPinned:o}=t;if(s)return s;let{rowModel:r,rowRenderer:a}=e,{rowNode:l}=t;return l||(n?l=Tz(e,n,o):i!=null&&(l=r.getRow(i))),a.getRowCtrls(l?[l]:[])?.[0]}function st(e,t={}){let{cellCtrl:i,colId:n,columnId:s,column:o}=t;if(i)return i;let r=e.colModel.getCol(n??s??Ev(o)),a=t.rowCtrl??fw(e,t),l=a?.getCellCtrl(r)??void 0;if(l)return l;let d=t.rowNode??a?.rowNode;if(d)return e.rowRenderer.getCellCtrls([d],[r])?.[0]}function d6(e){let{editSvc:t}=e;t?.isBatchEditing()?La(e):t?.stopEditing(void 0,{source:"api"})}function r$(e,t,i){let{gos:n,popupSvc:s}=t;if(!n.get("stopEditingWhenCellsLoseFocus"))return;let o=r=>{let a=r.relatedTarget;if(lv(a)===null){d6(t);return}let l=i.some(d=>d.contains(a))&&n.isElementInThisInstance(a);l||(l=!!s&&(s.getActivePopups().some(d=>d.contains(a))||s.isElementWithinCustomPopup(a))),l||d6(t)};for(let r of i)e.addManagedElementListeners(r,{focusout:o})}function Ev(e){if(e)return typeof e=="string"?e:e.getColId()}var Ki=Symbol("unedited");function QM(e,t={}){let i=[],n=e.rowRenderer.getCellCtrls(t.rowNodes,t.columns);for(let s of n){let o=s.comp?.getCellEditor();o&&i.push({ctrl:s,editor:Nd(o)})}return i}var a$=(e,t={})=>QM(e,t).map(i=>i.editor);function l$(e,t,i,n,s,o){t.length===0&&i?.rowNode&&i?.column&&za(e,i,{key:n,event:s,cellStartedEdit:o});let{valueSvc:r,editSvc:a,editModelSvc:l}=e,{rowNode:d,column:c}=i??{};for(let u of t){let{rowNode:h,column:p}=u,g=st(e,u);if(!g){if(h&&p){let m=r.getValue(p,h,void 0,"api"),w=(i?.rowNode===h&&i?.column===p&&n||void 0)??a?.getCellDataValue(u,!1)??r.getValueForDisplay(p,h)?.value??m??Ki;l?.setEdit(u,{pendingValue:w,sourceValue:m,state:"editing"})}continue}let f=o&&d===g.rowNode&&g.column===c;za(e,{rowNode:d,column:g.column},{key:f?n:null,event:f?s:null,cellStartedEdit:f&&o})}}function Ss({pendingValue:e,sourceValue:t}){return e===Ki&&(e=t),e!==t}function za(e,t,i){let n=e.gos.get("enableGroupEdit"),{key:s,event:o,cellStartedEdit:r,silent:a}=i??{},l=st(e,t),d=l?.comp?.getCellEditor(),c=eD(e,t,s,r&&!a),u=e.editModelSvc?.getEdit(t),h=c.value;if(h===void 0&&(h=u?.sourceValue),e.editModelSvc?.setEdit(t,{editorValue:h,state:"editing"}),d){d.refresh?.(c);return}let p=t.column.getColDef(),g=T4(e.userCompFactory,p,c),f=g?.popupFromSelector!=null?g.popupFromSelector:!!p.cellEditorPopup,m=g?.popupPositionFromSelector!=null?g.popupPositionFromSelector:p.cellEditorPopupPosition;if(tD(g.params,o),l){l.editCompDetails=g,l.onEditorAttachedFuncs.push(()=>l.rangeFeature?.unsetComp()),l.comp?.setEditDetails(g,f,m,e.gos.get("reactiveCustomComponents")),l?.rowCtrl?.refreshRow({suppressFlash:!0});let C=e.editModelSvc?.getEdit(t,!0);!a&&!C?.editorState?.cellStartedEditing&&(e.editSvc?.dispatchCellEvent(t,o,"cellEditingStarted",n?{value:h}:{}),e.editModelSvc?.setEdit(t,{editorState:{cellStartedEditing:!0}}))}}function ZM(e,t,i){let n={editorValueExists:!1};if(mw(e)&&(t.getValidationErrors?.()?.length??0)>0||i?.isCancelling)return n;if(i?.isStopping){let o=t?.isCancelAfterEnd?.();if(o)return O(b({},n),{isCancelAfterEnd:o})}return{editorValue:t.getValue(),editorValueExists:!0}}function eD(e,t,i,n){let{valueSvc:s,gos:o,editSvc:r}=e,a=e.gos.get("enableGroupEdit"),l=st(e,t),d=t.rowNode?.rowIndex??void 0,c=r?.isBatchEditing(),u=e.colModel.getCol(t.column.getId()),{rowNode:h,column:p}=t,g=l.comp?.getCellEditor(),f=r?.getCellDataValue(t,!1),m=f===void 0?g?ZM(e,g)?.editorValue:void 0:f,C=m===Ki?s.getValueForDisplay(u,h)?.value:m;return ae(o,{value:a?m:C,eventKey:i??null,column:p,colDef:p.getColDef(),rowIndex:d,node:h,data:h.data,cellStartedEdit:n??!1,onKeyDown:l?.onKeyDown.bind(l),stopEditing:v=>{r.stopEditing(t,{source:c?"ui":"api",suppressNavigateAfterEdit:v}),Yp(e,t)},eGridCell:l?.eGui,parseValue:v=>s.parseValue(u,h,v,l?.value),formatValue:l?.formatValue.bind(l),validate:()=>{r?.validateEdit()}})}function Rv(e,t){let{editModelSvc:i}=e;i?.getEditMap().forEach((n,s)=>{n.forEach((o,r)=>{!t&&(o.state==="editing"||o.pendingValue===Ki)||!Ss(o)&&(o.state!=="editing"||t)&&i?.removeEdits({rowNode:s,column:r})})})}function d$(e,t){let i=t.comp?.getCellEditor();if(!i?.refresh)return;let{eventKey:n,cellStartedEdit:s}=t.editCompDetails.params,{column:o}=t,r=eD(e,t,n,s),a=o.getColDef(),l=T4(e.userCompFactory,a,r);i.refresh(tD(l.params,n))}function tD(e,t){return t instanceof KeyboardEvent&&e.column.getColDef().cellEditor==="agNumberCellEditor"?e.suppressPreventDefault=["-","+",".","e"].includes(t?.key??"")||e.suppressPreventDefault:t?.preventDefault?.(),e}function Zo(e,t){for(let i of e.editModelSvc?.getEditPositions()??[]){let n=st(e,i);if(!n)continue;let s=n.comp?.getCellEditor();if(!s)continue;let{editorValue:o,editorValueExists:r,isCancelAfterEnd:a}=ZM(e,s,t);a&&e.editModelSvc?.setEdit(i,{editorState:{isCancelAfterEnd:a}}),Pp(e,i,o,void 0,!r,t)}}function Pp(e,t,i,n,s,o){let{editModelSvc:r,valueSvc:a}=e;if(!r)return;let{rowNode:l,column:d}=t;if(!(l&&d))return;let c=r.getEdit(t,!0);c?.sourceValue||(c=r.setEdit(t,{sourceValue:a.getValue(d,l,void 0,"api"),pendingValue:c?c.editorValue:Ki})),r.setEdit(t,{editorValue:s?c.sourceValue:i}),o?.persist&&c$(e,t)}function c$(e,t){let{editModelSvc:i}=e,n=i?.getEdit(t,!0);i?.setEdit(t,{pendingValue:n?.editorValue})}function La(e,t,i){t||(t=e.editModelSvc?.getEditPositions());for(let n of t??[])Yp(e,n,i)}function Yp(e,t,i){let n=e.gos.get("enableGroupEdit"),{editModelSvc:s}=e,o=st(e,t),r=s?.getEdit(t,!0);if(!o){r&&s?.setEdit(t,{state:"changed"});return}let{comp:a}=o;if(a&&!a.getCellEditor()){if(o?.refreshCell(),r){s?.setEdit(t,{state:"changed"});let d=n?c6(i,r):{valueChanged:!1,newValue:void 0,oldValue:r.sourceValue};u6(e,t,d,i)}return}if(mw(e)){let d=a?.getCellEditor()?.getValidationErrors?.(),c=s?.getCellValidationModel();d?.length?c?.setCellValidation(t,{errorMessages:d}):c?.clearCellValidation(t)}s?.setEdit(t,{state:"changed"}),a?.setEditDetails(),a?.refreshEditStyles(!1,!1),o?.refreshCell({force:!0,suppressFlash:!0});let l=s?.getEdit(t);if(l&&l.state==="changed"){let d=n?c6(i,l):{valueChanged:Ss(l)&&!i?.cancel,newValue:i?.cancel||l.editorState.isCancelAfterEnd?void 0:l?.editorValue??r?.pendingValue,oldValue:l?.sourceValue};u6(e,t,d,i)}}function c6(e,t){return e?.cancel?{valueChanged:!1,oldValue:t.sourceValue,newValue:void 0,value:t.sourceValue}:{valueChanged:!1,oldValue:t.sourceValue,newValue:t.pendingValue,value:t.sourceValue}}function u6(e,t,i,{silent:n,event:s}={}){let{editSvc:o,editModelSvc:r}=e,a=r?.getEdit(t),{editorState:l}=a||{},{isCancelBeforeStart:d}=l||{};!n&&!d&&(o?.dispatchCellEvent(t,s,"cellEditingStopped",i),r?.setEdit(t,{editorState:{cellStoppedEditing:!0}}))}function mw(e){let{gos:t,colModel:i}=e,n=!!t.get("getFullRowEditValidationErrors"),s=i.getColumnDefs()?.filter(r=>r.editable).some(({cellEditorParams:r})=>{let{minLength:a,maxLength:l,getValidationErrors:d,min:c,max:u}=r||{};return a!==void 0||l!==void 0||d!==void 0||c!==void 0||u!==void 0}),o=e.gridApi.getCellEditorInstances().some(r=>r.getValidationElement||r.getValidationErrors);return s||n||o}function cr(e,t){if(!(t||mw(e)))return;let i=QM(e),n=new XM,{ariaAnnounce:s,localeSvc:o,editModelSvc:r,gos:a}=e,l=a.get("editType")==="fullRow",c=$6(o)("ariaValidationErrorPrefix","Cell Editor Validation");for(let h of i){let{ctrl:p,editor:g}=h,{rowNode:f,column:m}=p,C=g.getValidationErrors?.()??[],v=g.getValidationElement?.(!1)||!g.isPopup?.()&&p.eGui;if(v){let w=C!=null&&C.length>0,y=w?C.join(". "):"";aO(v,w),w&&s.announceValue(`${c} ${C}`,"editorValidation"),v instanceof HTMLInputElement?v.setCustomValidity(y):v.classList.toggle("invalid",w)}C?.length>0&&n.setCellValidation({rowNode:f,column:m},{errorMessages:C})}Zo(e,{persist:!1}),r?.setCellValidationModel(n);let u=new Set;for(let{ctrl:h}of i)u.add(h.rowCtrl);if(l){let h=u$(e);r?.setRowValidationModel(h)}for(let h of u.values()){h.rowEditStyleFeature?.applyRowStyles();for(let p of h.getAllCellCtrls())p.tooltipFeature?.refreshTooltip(!0),p.editorTooltipFeature?.refreshTooltip(!0),p.editStyleFeature?.applyCellStyles?.()}}var u$=e=>{let t=new JM,i=e.gos.get("getFullRowEditValidationErrors"),n=e.editModelSvc?.getEditMap();if(!n)return t;for(let s of n.keys()){let o=n.get(s);if(!o)continue;let r=[],{rowIndex:a,rowPinned:l}=s;for(let c of o.keys()){let u=o.get(c);if(!u)continue;let{editorValue:h,pendingValue:p,sourceValue:g}=u,f=h??(p===Ki?void 0:p)??g;r.push({column:c,colId:c.getColId(),rowIndex:a,rowPinned:l,oldValue:g,newValue:f})}let d=i?.({editorsState:r})??[];d.length>0&&t.setRowValidation({rowNode:s},{errorMessages:d})}return t};function h$(e){cr(e,!0);let t=e.editModelSvc?.getCellValidationModel().getCellValidationMap();if(!t)return null;let i=[];return t.forEach((n,s)=>{n.forEach(({errorMessages:o},r)=>{i.push({column:r,rowIndex:s.rowIndex,rowPinned:s.rowPinned,messages:o??null})})}),i}function p$(e,t,i,{rowNode:n,column:s},o){return ae(e.gos,{type:i,node:n,data:n.data,value:o,column:s,colDef:s.getColDef(),rowPinned:n.rowPinned,event:t,rowIndex:n.rowIndex})}function g$(e,t=!1){return e===k.DELETE?!0:!t&&e===k.BACKSPACE?_4():!1}var f$=class extends F{constructor(e,t,i,n){super(),this.cellCtrl=e,this.rowNode=i,this.rowCtrl=n,this.beans=t}init(){this.eGui=this.cellCtrl.eGui}onKeyDown(e){let t=e.key;switch(t){case k.ENTER:this.onEnterKeyDown(e);break;case k.F2:this.onF2KeyDown(e);break;case k.ESCAPE:this.onEscapeKeyDown(e);break;case k.TAB:this.onTabKeyDown(e);break;case k.BACKSPACE:case k.DELETE:this.onBackspaceOrDeleteKeyDown(t,e);break;case k.DOWN:case k.UP:case k.RIGHT:case k.LEFT:this.onNavigationKeyDown(e,t);break}}onNavigationKeyDown(e,t){let{cellCtrl:i,beans:n}=this;if(!n.editSvc?.isEditing(i,{withOpenEditor:!0})){if(e.shiftKey&&i.isRangeSelectionEnabled())this.onShiftRangeSelect(e);else{let s=i.getFocusedCellPosition();n.navigation?.navigateToNextCell(e,t,s,!0)}e.preventDefault()}}onShiftRangeSelect(e){let{rangeSvc:t,navigation:i}=this.beans;if(!t)return;let n=t.extendLatestRangeInDirection(e);n&&(e.key===k.LEFT||e.key===k.RIGHT?i?.ensureColumnVisible(n.column):i?.ensureRowVisible(n.rowIndex))}onTabKeyDown(e){this.beans.navigation?.onTabKeyDown(this.cellCtrl,e)}onBackspaceOrDeleteKeyDown(e,t){let{cellCtrl:i,beans:n,rowNode:s}=this,{gos:o,rangeSvc:r,eventSvc:a,editSvc:l}=n;if(a.dispatchEvent({type:"keyShortcutChangedCellStart"}),g$(e,o.get("enableCellEditingOnBackspace"))&&!l?.isEditing(i,{withOpenEditor:!0})){if(r&&Ds(o))r.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"});else if(i.isCellEditable()){let{column:d}=i,c=this.beans.valueSvc.getDeleteValue(d,s);s.setDataValue(d,c,"cellClear")}}else l?.isEditing(i,{withOpenEditor:!0})||n.editSvc?.startEditing(i,{startedEdit:!0,event:t});a.dispatchEvent({type:"keyShortcutChangedCellEnd"})}onEnterKeyDown(e){let{cellCtrl:t,beans:i}=this,{editSvc:n,navigation:s}=i,o=n?.isEditing(t,{withOpenEditor:!0}),r=t.rowNode,a=n?.isRowEditing(r,{withOpenEditor:!0}),l=d=>{n?.startEditing(d,{startedEdit:!0,event:e,source:"edit"})&&e.preventDefault()};if(o||a){if(this.isCtrlEnter(e)){n?.applyBulkEdit(t,i?.rangeSvc?.getCellRanges()||[]);return}if(cr(i),n?.checkNavWithValidation(void 0,e)==="block-stop")return;n?.isEditing(t,{withOpenEditor:!0})?n?.stopEditing(t,{event:e,source:"edit"}):a&&!t.isCellEditable()?n?.stopEditing({rowNode:r},{event:e,source:"edit"}):l(t)}else if(i.gos.get("enterNavigatesVertically")){let d=e.shiftKey?k.UP:k.DOWN;s?.navigateToNextCell(null,d,t.cellPosition,!1)}else{if(n?.hasValidationErrors())return;n?.hasValidationErrors(t)&&n.revertSingleCellEdit(t,!0),l(t)}}isCtrlEnter(e){return(e.ctrlKey||e.metaKey)&&e.key===k.ENTER}onF2KeyDown(e){let{cellCtrl:t,beans:{editSvc:i}}=this;i?.isEditing()&&(cr(this.beans),i?.checkNavWithValidation(void 0,e)==="block-stop")||i?.startEditing(t,{startedEdit:!0,event:e})}onEscapeKeyDown(e){let{cellCtrl:t,beans:{editSvc:i}}=this;i?.checkNavWithValidation(t,e)==="block-stop"&&i.revertSingleCellEdit(t),i?.stopEditing(t,{event:e,cancel:!0})}processCharacter(e){let i=e.target!==this.eGui,{beans:{editSvc:n},cellCtrl:s}=this;if(i||n?.isEditing(s,{withOpenEditor:!0}))return;if(e.key===k.SPACE)this.onSpaceKeyDown(e);else if(n?.isCellEditable(s,"ui")){if(n?.hasValidationErrors()&&!n?.hasValidationErrors(s))return;n?.startEditing(s,{startedEdit:!0,event:e,source:"api"}),!s.editCompDetails?.params?.suppressPreventDefault&&e.preventDefault()}}onSpaceKeyDown(e){let{gos:t,editSvc:i}=this.beans,{rowNode:n}=this.cellCtrl;!i?.isEditing(this.cellCtrl,{withOpenEditor:!0})&&tr(t)&&this.beans.selectionSvc?.handleSelectionEvent(e,n,"spaceKey"),e.preventDefault()}},m$=class extends F{constructor(e,t,i){super(),this.cellCtrl=e,this.column=i,this.beans=t}onMouseEvent(e,t){if(!Ms(t))switch(e){case"click":this.onCellClicked(t);break;case"mousedown":case"touchstart":this.onMouseDown(t);break;case"dblclick":this.onCellDoubleClicked(t);break;case"mouseout":this.onMouseOut(t);break;case"mouseover":this.onMouseOver(t);break}}onCellClicked(e){if(this.beans.touchSvc?.handleCellDoubleClick(this,e))return;let{eventSvc:t,rangeSvc:i,editSvc:n,editModelSvc:s,frameworkOverrides:o,gos:r}=this.beans,a=e.ctrlKey||e.metaKey,{cellCtrl:l}=this,{column:d,cellPosition:c,rowNode:u}=l,h=Ep(r,d,u,e);i&&a&&!h&&i.getCellRangeCount(c)>1&&i.intersectLastRange(!0);let p=l.createEvent(e,"cellClicked");p.isEventHandlingSuppressed=h,t.dispatchEvent(p);let g=d.getColDef();if(g.onCellClicked&&window.setTimeout(()=>{o.wrapOutgoing(()=>{g.onCellClicked(p)})},0),!h&&s?.getState(l)!=="editing"){let f=n?.isEditing(),m=s?.getCellValidationModel().getCellValidationMap().size??0,C=s?.getRowValidationModel().getRowValidationMap().size??0;if(f&&(m>0||C>0))return;n?.shouldStartEditing(l,e)?n?.startEditing(l,{event:e}):n?.shouldStopEditing(l,e)&&(this.beans.gos.get("editType")==="fullRow"?n?.stopEditing(l,{event:e,source:"edit"}):n?.stopEditing(void 0,{event:e,source:"edit"}))}}onCellDoubleClicked(e){let{column:t,beans:i,cellCtrl:n}=this,{eventSvc:s,frameworkOverrides:o,editSvc:r,editModelSvc:a,gos:l}=i,d=Ep(l,n.column,n.rowNode,e),c=t.getColDef(),u=n.createEvent(e,"cellDoubleClicked");if(u.isEventHandlingSuppressed=d,s.dispatchEvent(u),typeof c.onCellDoubleClicked=="function"&&window.setTimeout(()=>{o.wrapOutgoing(()=>{c.onCellDoubleClicked(u)})},0),!d&&r?.shouldStartEditing(n,e)&&a?.getState(n)!=="editing"){let h=r?.isEditing(),p=a?.getCellValidationModel().getCellValidationMap().size??0,g=a?.getRowValidationModel().getRowValidationMap().size??0;if(h&&(p>0||g>0))return;r?.startEditing(n,{event:e})}}onMouseDown(e){let{ctrlKey:t,metaKey:i,shiftKey:n}=e,s=e.target,{cellCtrl:o,beans:r}=this,{eventSvc:a,rangeSvc:l,rowNumbersSvc:d,focusSvc:c,gos:u,editSvc:h}=r,{column:p,rowNode:g,cellPosition:f}=o,m=Ep(u,p,g,e),C=()=>{let S=o.createEvent(e,"cellMouseDown");S.isEventHandlingSuppressed=m,a.dispatchEvent(S)};if(m){C();return}if(this.isRightClickInExistingRange(e))return;let v=l&&!l.isEmpty(),w=this.containsWidget(s),y=Es(p);if(d&&y&&!d.handleMouseDownOnCell(f,e)){l&&e.preventDefault(),e.stopImmediatePropagation();return}if(!n||!v){let S=h?.isEditing(o),E=u.get("enableCellTextSelection")&&e.defaultPrevented,T=(po()||E)&&!S&&!bd(s)&&!w;o.focusCell(T,e)}if(n&&v&&!c.isCellFocused(f)){e.preventDefault();let S=c.getFocusedCell();if(S){let{column:x,rowIndex:E,rowPinned:T}=S;h?.isEditing(S)&&h?.stopEditing(S),c.setFocusedCell({column:x,rowIndex:E,rowPinned:T,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,sourceEvent:e})}}if(!w){if(l){y&&e.preventDefault();let S=fR(r,e)&&y;if(n)l.extendLatestRangeToCell(f);else if(!S){let x=t||i;l.setRangeToCell(f,x)}}C()}}isRightClickInExistingRange(e){let{rangeSvc:t}=this.beans;if(t){let i=t.isCellInAnyRange(this.cellCtrl.cellPosition),n=fR(this.beans,e);if(i&&n)return!0}return!1}containsWidget(e){return er(e,"ag-selection-checkbox",3)||er(e,"ag-drag-handle",3)}onMouseOut(e){if(this.mouseStayingInsideCell(e))return;let{eventSvc:t,colHover:i}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOut")),i?.clearMouseOver()}onMouseOver(e){if(this.mouseStayingInsideCell(e))return;let{eventSvc:t,colHover:i}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOver")),i?.setMouseOver([this.column])}mouseStayingInsideCell(e){if(!e.target||!e.relatedTarget)return!1;let t=this.cellCtrl.eGui,i=t.contains(e.target),n=t.contains(e.relatedTarget);return i&&n}},C$=class extends F{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.column=e.column,this.rowNode=e.rowNode}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode),this.addManagedListeners(this.beans.eventSvc,{newColumnsLoaded:()=>this.onNewColumnsLoaded()})}init(){this.eSetLeft=this.cellCtrl.getRootElement(),this.eContent=this.cellCtrl.eGui;let e=this.cellCtrl.getCellSpan();if(e||(this.setupColSpan(),this.setupRowSpan()),this.onLeftChanged(),this.onWidthChanged(),e||this._legacyApplyRowSpan(),e){let t=this.refreshSpanHeight.bind(this,e);t(),this.addManagedListeners(this.beans.eventSvc,{paginationChanged:t,recalculateRowBounds:t,pinnedHeightChanged:t})}}refreshSpanHeight(e){let t=e.getCellHeight();t!=null&&(this.eContent.style.height=`${t}px`)}onNewColumnsLoaded(){let e=this.column.getRowSpan(this.rowNode);this.rowSpan!==e&&(this.rowSpan=e,this._legacyApplyRowSpan(!0))}onDisplayColumnsChanged(){let e=this.getColSpanningList();ho(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){this.column.getColDef().colSpan!=null&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onWidthChanged.bind(this)}))}onWidthChanged(){if(!this.eContent)return;let e=this.getCellWidth();this.eContent.style.width=`${e}px`}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce((e,t)=>e+t.getActualWidth(),0):this.column.getActualWidth()}getColSpanningList(){let{column:e,rowNode:t}=this,i=e.getColSpan(t),n=[];if(i===1)n.push(e);else{let s=e,o=e.getPinned();for(let r=0;s&&r<i&&(n.push(s),s=this.beans.visibleCols.getColAfter(s),!(!s||tt(s)||o!==s.getPinned()));r++);}return n}onLeftChanged(){if(!this.eSetLeft)return;let e=this.modifyLeftForPrintLayout(this.getCellLeft());this.eSetLeft.style.left=e+"px"}getCellLeft(){let e;return this.beans.gos.get("enableRtl")&&this.colsSpanning?e=je(this.colsSpanning):e=this.column,e.getLeft()}modifyLeftForPrintLayout(e){if(!this.cellCtrl.printLayout||this.column.getPinned()==="left")return e;let{visibleCols:t}=this.beans,i=t.getColsLeftWidth();if(this.column.getPinned()==="right"){let n=t.bodyWidth;return i+n+(e||0)}return i+(e||0)}_legacyApplyRowSpan(e){if(this.rowSpan===1&&!e)return;let i=ir(this.beans)*this.rowSpan;this.eContent.style.height=`${i}px`,this.eContent.style.zIndex="1"}destroy(){super.destroy()}},v$="ag-cell",w$="ag-cell-auto-height",b$="ag-cell-normal-height",y$="ag-cell-focus",S$="ag-cell-first-right-pinned",x$="ag-cell-last-left-pinned",E$="ag-cell-not-inline-editing",R$="ag-cell-wrap-text",M$=0,Oa=class extends F{constructor(e,t,i,n){super(),this.column=e,this.rowNode=t,this.rowCtrl=n,this.rangeFeature=void 0,this.rowResizeFeature=void 0,this.positionFeature=void 0,this.customStyleFeature=void 0,this.editStyleFeature=void 0,this.mouseListener=void 0,this.keyboardListener=void 0,this.suppressRefreshCell=!1,this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.focusEventWhileNotReady=null,this.hasBeenFocused=!1,this.hasEdit=!1,this.tooltipFeature=void 0,this.editorTooltipFeature=void 0,this.beans=i,this.gos=i.gos,this.editSvc=i.editSvc,this.hasEdit=!!i.editSvc;let{colId:s}=e;this.instanceId=s+"-"+M$++,this.createCellPosition(),this.updateAndFormatValue(!1)}addFeatures(){let{beans:e}=this;this.positionFeature=new C$(this,e),this.customStyleFeature=e.cellStyles?.createCellCustomStyleFeature(this,e),this.editStyleFeature=e.editSvc?.createCellStyleFeature(this,e),this.mouseListener=new m$(this,e,this.column),this.keyboardListener=new f$(this,e,this.rowNode,this.rowCtrl),this.enableTooltipFeature();let{rangeSvc:t}=e;t&&Ds(e.gos)&&(this.rangeFeature=t.createCellRangeFeature(e,this)),Es(this.column)&&(this.rowResizeFeature=this.beans.rowNumbersSvc.createRowNumbersRowResizerFeature(e,this))}isCellSpanning(){return!1}getCellSpan(){}removeFeatures(){let e=this.beans.context;this.positionFeature=e.destroyBean(this.positionFeature),this.editorTooltipFeature=e.destroyBean(this.editorTooltipFeature),this.customStyleFeature=e.destroyBean(this.customStyleFeature),this.editStyleFeature=e.destroyBean(this.editStyleFeature),this.mouseListener=e.destroyBean(this.mouseListener),this.keyboardListener=e.destroyBean(this.keyboardListener),this.rangeFeature=e.destroyBean(this.rangeFeature),this.rowResizeFeature=e.destroyBean(this.rowResizeFeature),this.disableTooltipFeature()}enableTooltipFeature(e,t){this.tooltipFeature=this.beans.tooltipSvc?.enableCellTooltipFeature(this,e,t)}disableTooltipFeature(){this.tooltipFeature=this.beans.context.destroyBean(this.tooltipFeature)}enableEditorTooltipFeature(e){this.editorTooltipFeature&&this.disableEditorTooltipFeature(),this.editorTooltipFeature=this.beans.tooltipSvc?.setupCellEditorTooltip(this,e),cr(this.beans)}disableEditorTooltipFeature(){this.editorTooltipFeature=this.beans.context.destroyBean(this.editorTooltipFeature)}setComp(e,t,i,n,s,o,r){if(this.comp=e,this.eGui=t,this.printLayout=s,r??(r=this),this.addDomData(r),this.addFeatures(),r.addDestroyFunc(()=>this.removeFeatures()),this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.setupFocus(),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),this.setupAutoHeight(n,r),this.refreshFirstAndLastStyles(),this.refreshAriaColIndex(),this.positionFeature?.init(),this.customStyleFeature?.setComp(e),this.editStyleFeature?.setComp(e),this.tooltipFeature?.refreshTooltip(),this.keyboardListener?.init(),this.rangeFeature?.setComp(e),this.rowResizeFeature?.refreshRowResizer(),o&&this.isCellEditable()||this.hasEdit&&this.editSvc?.isEditing(this,{withOpenEditor:!0})?this.editSvc?.startEditing(this,{startedEdit:!1,source:"api",silent:!0,continueEditing:!0}):this.showValue(!1,!0),this.onCompAttachedFuncs.length){for(let a of this.onCompAttachedFuncs)a();this.onCompAttachedFuncs=[]}}setupAutoHeight(e,t){this.isAutoHeight=this.beans.rowAutoHeight?.setupCellAutoHeight(this,e,t)??!1}getCellAriaRole(){return this.column.getColDef().cellAriaRole??"gridcell"}isCellRenderer(){let e=this.column.getColDef();return e.cellRenderer!=null||e.cellRendererSelector!=null}getValueToDisplay(){return this.valueFormatted??this.value}getDeferLoadingCellRenderer(){let{beans:e,column:t}=this,{userCompFactory:i,ctrlsSvc:n,eventSvc:s}=e,o=t.getColDef(),r=this.createCellRendererParams();r.deferRender=!0;let a=yR(i,o,r);if(n.getGridBodyCtrl()?.scrollFeature?.isScrolling()){let l,d=new lt(u=>{l=u}),[c]=this.addManagedListeners(s,{bodyScrollEnd:()=>{l(),c()}});return{loadingComp:a,onReady:d}}return{loadingComp:a,onReady:lt.resolve()}}showValue(e,t){let{beans:i,column:n,rowNode:s,rangeFeature:o}=this,{userCompFactory:r}=i,a=this.getValueToDisplay(),l,d=s.stub&&s.groupData?.[n.getId()]==null,c=n.getColDef();if(d||this.isCellRenderer()){let u=this.createCellRendererParams();!d||Es(n)?l=bR(r,c,u):l=yR(r,c,u)}if(!l&&!d&&i.findSvc?.isMatch(s,n)){let u=this.createCellRendererParams();l=bR(r,O(b({},n.getColDef()),{cellRenderer:"agFindCellRenderer"}),u)}if(this.hasEdit&&this.editSvc.isBatchEditing()&&this.editSvc.isRowEditing(s,{checkSiblings:!0})){let u=this.editSvc.prepDetailsDuringBatch(this,{compDetails:l,valueToDisplay:a});u&&(u.compDetails?l=u.compDetails:u.valueToDisplay&&(a=u.valueToDisplay))}this.comp.setRenderDetails(l,a,e),this.customRowDragComp?.refreshVisibility(),!t&&o&&Ps(i,()=>o?.refreshHandle()),this.rowResizeFeature?.refreshRowResizer()}setupControlComps(){let e=this.column.getColDef();this.includeSelection=this.isIncludeControl(this.isCheckboxSelection(e),!0),this.includeRowDrag=this.isIncludeControl(e.rowDrag),this.includeDndSource=this.isIncludeControl(e.dndSource),this.comp.setIncludeSelection(this.includeSelection),this.comp.setIncludeDndSource(this.includeDndSource),this.comp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gos.get("enableCellTextSelection")||this.column.isAutoHeight()}getCellValueClass(){let e="ag-cell-value",t=this.column.getColDef().cellRenderer==="agCheckboxCellRenderer",i="";return t&&(i=" ag-allow-overflow"),`${e}${i}`}isIncludeControl(e,t=!1){return(this.rowNode.rowPinned==null||t&&Kd(this.rowNode))&&!!e}isCheckboxSelection(e){let{rowSelection:t,groupDisplayType:i}=this.beans.gridOptions,n=Np(t),s=Fs(this.column);return i==="custom"&&n!=="selectionColumn"&&s?!1:e.checkboxSelection||s&&typeof t=="object"&&Fa(t)}refreshShouldDestroy(){let e=this.column.getColDef(),t=this.includeSelection!=this.isIncludeControl(this.isCheckboxSelection(e),!0),i=this.includeRowDrag!=this.isIncludeControl(e.rowDrag),n=this.includeDndSource!=this.isIncludeControl(e.dndSource),s=this.isAutoHeight!=this.column.isAutoHeight();return t||i||n||s}onPopupEditorClosed(){let{editSvc:e}=this.beans;e?.isEditing(this,{withOpenEditor:!0})&&e?.stopEditing(this,{source:e?.isBatchEditing()?"ui":"api"})}stopEditing(e=!1){let{editSvc:t}=this.beans;return t?.stopEditing(this,{cancel:e,source:t?.isBatchEditing()?"ui":"api"})??!1}createCellRendererParams(){let{value:e,valueFormatted:t,column:i,rowNode:n,comp:s,eGui:o,beans:{valueSvc:r,gos:a,editSvc:l}}=this;return ae(a,{value:e,valueFormatted:t,getValue:()=>r.getValueForDisplay(i,n).value,setValue:c=>l?.setDataValue({rowNode:n,column:i},c)||n.setDataValue(i,c),formatValue:this.formatValue.bind(this),data:n.data,node:n,pinned:i.getPinned(),colDef:i.getColDef(),column:i,refreshCell:this.refreshCell.bind(this),eGridCell:o,eParentOfValue:s.getParentOfValue(),registerRowDragger:(c,u,h,p)=>this.registerRowDragger(c,u,p),setTooltip:(c,u)=>{a.assertModuleRegistered("Tooltip",3),this.tooltipFeature&&this.disableTooltipFeature(),this.enableTooltipFeature(c,u),this.tooltipFeature?.refreshTooltip()}})}onCellChanged(e){e.column===this.column&&this.refreshCell({})}refreshOrDestroyCell(e){if(this.refreshShouldDestroy()?this.rowCtrl?.recreateCell(this):this.refreshCell(e),this.hasEdit&&this.editCompDetails){let{editSvc:t,comp:i}=this;!i?.getCellEditor()&&t.isEditing(this,{withOpenEditor:!0})&&t.startEditing(this,{startedEdit:!1,source:"api",silent:!0})}}refreshCell({force:e,suppressFlash:t,newData:i}={}){let{editStyleFeature:n,customStyleFeature:s,rowCtrl:{rowEditStyleFeature:o},beans:{cellFlashSvc:r,filterManager:a},column:l,comp:d,suppressRefreshCell:c,tooltipFeature:u}=this;if(c)return;let{field:h,valueGetter:p,showRowGroup:g,enableCellChangeFlash:f}=l.getColDef(),m=h==null&&p==null&&g==null,C=e||m||i,v=!!d,w=this.updateAndFormatValue(v),y=C||w;if(v){if(y){this.showValue(!!i,!1);let S=a?.isSuppressFlashingCellsBecauseFiltering();!t&&!S&&f&&r?.flashCell(this),n?.applyCellStyles?.(),s?.applyUserStyles(),s?.applyClassesFromColDef(),o?.applyRowStyles()}u?.refreshTooltip(),s?.applyCellClassRules()}}isCellEditable(){return this.column.isCellEditable(this.rowNode)}formatValue(e){return this.callValueFormatter(e)??e}callValueFormatter(e){return this.beans.valueSvc.formatValue(this.column,this.rowNode,e)}updateAndFormatValue(e){let t=this.value,i=this.valueFormatted,{value:n,valueFormatted:s}=this.beans.valueSvc.getValueForDisplay(this.column,this.rowNode,!0);return this.value=n,this.valueFormatted=s,e?!this.valuesAreEqual(t,this.value)||this.valueFormatted!=i:!0}valuesAreEqual(e,t){let i=this.column.getColDef();return i.equals?i.equals(e,t):e===t}addDomData(e){let t=this.eGui;ar(this.beans.gos,t,$p,this),e.addDestroyFunc(()=>ar(this.beans.gos,t,$p,null))}createEvent(e,t){let{rowNode:i,column:n,value:s,beans:o}=this;return p$(o,e,t,{rowNode:i,column:n},s)}processCharacter(e){this.keyboardListener?.processCharacter(e)}onKeyDown(e){this.keyboardListener?.onKeyDown(e)}onMouseEvent(e,t){this.mouseListener?.onMouseEvent(e,t)}getColSpanningList(){return this.positionFeature?.getColSpanningList()??[]}onLeftChanged(){this.comp&&this.positionFeature?.onLeftChanged()}onDisplayedColumnsChanged(){this.eGui&&(this.refreshAriaColIndex(),this.refreshFirstAndLastStyles())}refreshFirstAndLastStyles(){let{comp:e,column:t,beans:i}=this;fM(e,t,i.visibleCols)}refreshAriaColIndex(){let e=this.beans.visibleCols.getAriaColIndex(this.column);_6(this.eGui,e)}onWidthChanged(){return this.positionFeature?.onWidthChanged()}getRowPosition(){let{rowIndex:e,rowPinned:t}=this.cellPosition;return{rowIndex:e,rowPinned:t}}updateRangeBordersIfRangeCount(){this.comp&&this.rangeFeature?.updateRangeBordersIfRangeCount()}onCellSelectionChanged(){this.comp&&this.rangeFeature?.onCellSelectionChanged()}isRangeSelectionEnabled(){return this.rangeFeature!=null}focusCell(e=!1,t){let i=this.editSvc?.allowedFocusTargetOnValidation(this);i&&i!==this||this.beans.focusSvc.setFocusedCell(O(b({},this.getFocusedCellPosition()),{forceBrowserFocus:e,sourceEvent:t}))}restoreFocus(e=!1){let{beans:{editSvc:t,focusSvc:i},comp:n}=this;if(!n||t?.isEditing(this)||!this.isCellFocused()||!i.shouldTakeFocus())return;let s=()=>{if(!this.isAlive())return;let o=n.getFocusableElement();this.isCellFocused()&&o.focus({preventScroll:!0})};if(e){setTimeout(s,0);return}s()}onRowIndexChanged(){this.createCellPosition(),this.onCellFocused(),this.restoreFocus(),this.rangeFeature?.onCellSelectionChanged(),this.rowResizeFeature?.refreshRowResizer()}onSuppressCellFocusChanged(e){let t=this.eGui;t&&(Es(this.column)&&(e=!0),Fi(t,"tabindex",e?void 0:-1))}onFirstRightPinnedChanged(){if(!this.comp)return;let e=this.column.isFirstRightPinned();this.comp.toggleCss(S$,e)}onLastLeftPinnedChanged(){if(!this.comp)return;let e=this.column.isLastLeftPinned();this.comp.toggleCss(x$,e)}checkCellFocused(){return this.beans.focusSvc.isCellFocused(this.cellPosition)}isCellFocused(){let e=this.checkCellFocused();return this.hasBeenFocused||(this.hasBeenFocused=e),e}setupFocus(){this.restoreFocus(!0),this.onCellFocused(this.focusEventWhileNotReady??void 0)}onCellFocused(e){let{beans:t}=this;if(sg(t))return;if(!this.comp){e&&(this.focusEventWhileNotReady=e);return}let i=this.isCellFocused(),n=t.editSvc?.isEditing(this)??!1;if(this.comp.toggleCss(y$,i),i&&e?.forceBrowserFocus){let s=this.comp.getFocusableElement();if(n){let o=Aa(s,null,!0);o.length&&(s=o[0])}s.focus({preventScroll:!!e.preventScrollOnBrowserFocus})}i&&e&&this.rowCtrl.announceDescription()}createCellPosition(){let{rowIndex:e,rowPinned:t}=this.rowNode;this.cellPosition={rowIndex:e,rowPinned:xs(t),column:this.column}}applyStaticCssClasses(){let{comp:e}=this;e.toggleCss(v$,!0),e.toggleCss(E$,!0);let t=this.column.isAutoHeight()==!0;e.toggleCss(w$,t),e.toggleCss(b$,!t)}onColumnHover(){this.beans.colHover?.onCellColumnHover(this.column,this.comp)}onColDefChanged(){this.comp&&(this.column.isTooltipEnabled()?(this.disableTooltipFeature(),this.enableTooltipFeature()):this.disableTooltipFeature(),this.setWrapText(),this.editSvc?.isEditing(this)?this.editSvc?.handleColDefChanged(this):this.refreshOrDestroyCell({force:!0,suppressFlash:!0}))}setWrapText(){let e=this.column.getColDef().wrapText==!0;this.comp.toggleCss(R$,e)}dispatchCellContextMenuEvent(e){let t=this.column.getColDef(),i=this.createEvent(e,"cellContextMenu"),{beans:n}=this;n.eventSvc.dispatchEvent(i),t.onCellContextMenu&&window.setTimeout(()=>{n.frameworkOverrides.wrapOutgoing(()=>{t.onCellContextMenu(i)})},0)}getCellRenderer(){return this.comp?.getCellRenderer()??null}destroy(){this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.isCellFocused()&&this.hasBrowserFocus()&&this.beans.focusSvc.attemptToRecoverFocus(),super.destroy()}hasBrowserFocus(){return this.eGui?.contains(ot(this.beans))??!1}createSelectionCheckbox(){let e=this.beans.selectionSvc?.createCheckboxSelectionComponent();if(e)return this.beans.context.createBean(e),e.init({rowNode:this.rowNode,column:this.column}),e}createDndSource(){let e=this.beans.registry.createDynamicBean("dndSourceComp",!1,this.rowNode,this.column,this.eGui);return e&&this.beans.context.createBean(e),e}registerRowDragger(e,t,i){if(this.customRowDragComp){this.customRowDragComp.setDragElement(e,t);return}let n=this.createRowDragComp(e,t,i);n&&(this.customRowDragComp=n,this.addDestroyFunc(()=>{this.beans.context.destroyBean(n),this.customRowDragComp=null}),n.refreshVisibility())}createRowDragComp(e,t,i){let n=this.beans.rowDragSvc?.createRowDragCompForCell(this.rowNode,this.column,()=>this.value,e,t,i);if(n)return this.beans.context.createBean(n),n}cellEditorAttached(){for(let e of this.onEditorAttachedFuncs)e();this.onEditorAttachedFuncs=[]}setFocusedCellPosition(e){}getFocusedCellPosition(){return this.cellPosition}refreshAriaRowIndex(){}getRootElement(){return this.eGui}};function Cw(e,t,i,n,s,o){if(i==null&&t==null)return;let r={},a={},l=(d,c)=>{for(let u of d.split(" "))u.trim()!=""&&c(u)};if(i){let d=Object.keys(i);for(let c=0;c<d.length;c++){let u=d[c],h=i[u],p;typeof h=="string"?p=e?e.evaluate(h,n):!0:typeof h=="function"&&(p=h(n)),l(u,g=>{p?r[g]=!0:a[g]=!0})}}if(t&&o)for(let d of Object.keys(t))l(d,c=>{r[c]||(a[c]=!0)});o&&Object.keys(a).forEach(o),Object.keys(r).forEach(s)}function h6(e){if(e.group)return e.level;let t=e.parent;return t?t.level+1:0}var D$=class extends F{constructor(){super(...arguments),this.beanName="rowStyleSvc"}processClassesFromGridOptions(e,t){let i=this.gos,n=r=>{if(typeof r=="string")e.push(r);else if(Array.isArray(r))for(let a of r)e.push(a)},s=i.get("rowClass");s&&n(s);let o=i.getCallback("getRowClass");if(o){let r={data:t.data,node:t,rowIndex:t.rowIndex},a=o(r);n(a)}}preProcessRowClassRules(e,t){this.processRowClassRules(t,i=>{e.push(i)},()=>{})}processRowClassRules(e,t,i){let{gos:n,expressionSvc:s}=this.beans,o=ae(n,{data:e.data,node:e,rowIndex:e.rowIndex});Cw(s,void 0,n.get("rowClassRules"),o,t,i)}processStylesFromGridOptions(e){let t=this.gos,i=t.get("rowStyle"),n=t.getCallback("getRowStyle"),s;if(n){let o={data:e.data,node:e,rowIndex:e.rowIndex};s=n(o)}if(s||i)return Object.assign({},i,s)}},k$=0,Xp=class extends F{constructor(e,t,i,n,s){super(),this.rowNode=e,this.useAnimationFrameForCreate=n,this.printLayout=s,this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.rowDragComps=[],this.lastMouseDownOnDragger=!1,this.emptyStyle={},this.updateColumnListsPending=!1,this.rowId=null,this.businessKey=null,this.beans=t,this.gos=t.gos,this.paginationPage=t.pagination?.getCurrentPage()??0,this.suppressRowTransform=this.gos.get("suppressRowTransform"),this.instanceId=e.id+"-"+k$++,this.rowId=wd(e.id),this.initRowBusinessKey(),this.rowFocused=t.focusSvc.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=h6(this.rowNode),this.setRowType(),this.setAnimateFlags(i),this.rowStyles=this.processStylesFromGridOptions(),this.rowEditStyleFeature=t.editSvc?.createRowStyleFeature(this,t),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gos.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if(typeof this.businessKeyForNodeFunc!="function")return;let e=this.businessKeyForNodeFunc(this.rowNode);this.businessKey=wd(e)}updateGui(e,t){e==="left"?this.leftGui=t:e==="right"?this.rightGui=t:e==="fullWidth"?this.fullWidthGui=t:this.centerGui=t}setComp(e,t,i,n){let{context:s,focusSvc:o}=this.beans;n=Ud(this,s,n);let r={rowComp:e,element:t,containerType:i,compBean:n};this.allRowGuis.push(r),this.updateGui(i,r),this.initialiseRowComp(r);let a=this.rowNode,l=this.rowType==="FullWidthLoading"||a.stub,d=!a.data&&this.beans.rowModel.getType()==="infinite";!l&&!d&&!a.rowPinned&&this.beans.rowRenderer.dispatchFirstDataRenderedEvent();let c=this.fullWidthGui?.element;c&&!this.beans.editSvc?.isEditing(this)&&o.isRowFocused(a.rowIndex,a.rowPinned)&&o.shouldTakeFocus()&&setTimeout(()=>c.focus({preventScroll:!0}),0)}unsetComp(e){this.allRowGuis=this.allRowGuis.filter(t=>t.containerType!==e),this.updateGui(e,void 0)}isCacheable(){return this.rowType==="FullWidthDetail"&&this.gos.get("keepDetailRows")}setCached(e){let t=e?"none":"";for(let i of this.allRowGuis)i.element.style.display=t}initialiseRowComp(e){let t=this.gos;this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.listenOnDomOrder(e),this.onRowHeightChanged(e),this.updateRowIndexes(e),this.setFocusedClasses(e),this.setStylesFromGridOptions(!1,e),tr(t)&&this.rowNode.selectable&&this.onRowSelected(e),this.updateColumnLists(!this.useAnimationFrameForCreate);let i=e.rowComp,n=this.getInitialRowClasses(e.containerType);for(let s of n)i.toggleCss(s,!0);this.executeSlideAndFadeAnimations(e),this.rowNode.group&&QC(e.element,this.rowNode.expanded==!0),this.setRowCompRowId(i),this.setRowCompRowBusinessKey(i),ar(t,e.element,jp,this),e.compBean.addDestroyFunc(()=>ar(t,e.element,jp,null)),this.useAnimationFrameForCreate?this.beans.animationFrameSvc.createTask(this.addHoverFunctionality.bind(this,e),this.rowNode.rowIndex,"p2",!1):this.addHoverFunctionality(e),this.isFullWidth()&&this.setupFullWidth(e),t.get("rowDragEntireRow")&&this.addRowDraggerToRow(e),this.useAnimationFrameForCreate&&this.beans.animationFrameSvc.addDestroyTask(()=>{this.isAlive()&&e.rowComp.toggleCss("ag-after-created",!0)}),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(e){this.businessKey!=null&&e.setRowBusinessKey(this.businessKey)}setRowCompRowId(e){let t=wd(this.rowNode.id);this.rowId=t,t!=null&&e.setRowId(t)}executeSlideAndFadeAnimations(e){let{containerType:t}=e;this.slideInAnimation[t]&&(ZC(()=>{this.onTopChanged()}),this.slideInAnimation[t]=!1),this.fadeInAnimation[t]&&(ZC(()=>{e.rowComp.toggleCss("ag-opacity-zero",!1)}),this.fadeInAnimation[t]=!1)}addRowDraggerToRow(e){let t=this.beans.rowDragSvc?.createRowDragCompForRow(this.rowNode,e.element);if(!t)return;let i=this.createBean(t,this.beans.context);this.rowDragComps.push(i),e.compBean.addDestroyFunc(()=>{this.rowDragComps=this.rowDragComps.filter(n=>n!==i),this.rowEditStyleFeature=this.destroyBean(this.rowEditStyleFeature,this.beans.context),this.destroyBean(i,this.beans.context)})}setupFullWidth(e){let t=this.getPinnedForContainer(e.containerType),i=this.createFullWidthCompDetails(e.element,t);e.rowComp.showFullWidth(i)}getFullWidthCellRenderers(){return this.gos.get("embedFullWidthRows")?this.allRowGuis.map(e=>e?.rowComp?.getFullWidthCellRenderer()):[this.fullWidthGui?.rowComp?.getFullWidthCellRenderer()]}executeProcessRowPostCreateFunc(){let e=this.gos.getCallback("processRowPostCreate");if(!e||!this.areAllContainersReady())return;let t={eRow:this.centerGui.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)};e(t)}areAllContainersReady(){let{leftGui:e,centerGui:t,rightGui:i,beans:{visibleCols:n}}=this,s=!!e||!n.isPinningLeft(),o=!!t,r=!!i||!n.isPinningRight();return s&&o&&r}isNodeFullWidthCell(){if(this.rowNode.detail)return!0;let e=this.beans.gos.getCallback("isFullWidthRow");return e?e({rowNode:this.rowNode}):!1}setRowType(){let e=this.rowNode.stub&&!this.gos.get("suppressServerSideFullWidthLoadingRow")&&!this.gos.get("groupHideOpenParents"),t=this.isNodeFullWidthCell(),i=this.gos.get("masterDetail")&&this.rowNode.detail,n=this.beans.colModel.isPivotMode(),s=c4(this.gos,this.rowNode,n);e?this.rowType="FullWidthLoading":i?this.rowType="FullWidthDetail":t?this.rowType="FullWidth":s?this.rowType="FullWidthGroup":this.rowType="Normal"}updateColumnLists(e=!1,t=!1){if(this.isFullWidth())return;let{animationFrameSvc:i}=this.beans;if(!i?.active||e||this.printLayout){this.updateColumnListsImpl(t);return}this.updateColumnListsPending||(i.createTask(()=>{this.active&&this.updateColumnListsImpl(!0)},this.rowNode.rowIndex,"p1",!1),this.updateColumnListsPending=!0)}getNewCellCtrl(e){if(!this.beans.rowSpanSvc?.isCellSpanning(e,this.rowNode))return new Oa(e,this.rowNode,this.beans,this)}isCorrectCtrlForSpan(e){return!this.beans.rowSpanSvc?.isCellSpanning(e.column,this.rowNode)}createCellCtrls(e,t,i=null){let n={list:[],map:{}},s=(d,c,u)=>{u!=null?n.list.splice(u,0,c):n.list.push(c),n.map[d]=c},o=[];for(let d of t){let c=d.getInstanceId(),u=e.map[c];u&&!this.isCorrectCtrlForSpan(u)&&(u.destroy(),u=void 0),u||(u=this.getNewCellCtrl(d)),u&&s(c,u)}for(let d of e.list){let c=d.column.getInstanceId();if(n.map[c]!=null)continue;!this.isCellEligibleToBeRemoved(d,i)?o.push([c,d]):d.destroy()}if(o.length)for(let[d,c]of o){let u=n.list.findIndex(p=>p.column.getLeft()>c.column.getLeft()),h=u===-1?void 0:Math.max(u-1,0);s(d,c,h)}let{focusSvc:r,visibleCols:a}=this.beans,l=r.getFocusedCell();if(l&&l.column.getPinned()==i){let d=l.column.getInstanceId();if(!n.map[d]&&a.allCols.includes(l.column)){let u=this.createFocusedCellCtrl();if(u){let h=n.list.findIndex(g=>g.column.getLeft()>u.column.getLeft()),p=h===-1?void 0:Math.max(h-1,0);s(d,u,p)}}}return n}createFocusedCellCtrl(){let{focusSvc:e,rowSpanSvc:t}=this.beans,i=e.getFocusedCell();if(!i)return;let n=t?.getCellSpan(i.column,this.rowNode);if(n){if(n.firstNode!==this.rowNode||!n.doesSpanContain(i))return}else if(!e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned))return;return this.getNewCellCtrl(i.column)}updateColumnListsImpl(e){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(e)}setCellCtrls(e){for(let t of this.allRowGuis){let i=this.getCellCtrlsForContainer(t.containerType);t.rowComp.setCellCtrls(i,e)}}getCellCtrlsForContainer(e){switch(e){case"left":return this.leftCellCtrls.list;case"right":return this.rightCellCtrls.list;case"fullWidth":return[];case"center":return this.centerCellCtrls.list}}createAllCellCtrls(){let e=this.beans.colViewport,t=this.beans.visibleCols;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,t.allCols),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{let i=e.getColsWithinViewport(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,i);let n=t.getLeftColsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,n,"left");let s=t.getRightColsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,s,"right")}}isCellEligibleToBeRemoved(e,t){let{column:s}=e;if(s.getPinned()!=t||!this.isCorrectCtrlForSpan(e))return!0;let{visibleCols:o,editSvc:r}=this.beans,a=r?.isEditing(e),l=e.isCellFocused();return a||l?!(o.allCols.indexOf(s)>=0):!0}getDomOrder(){return this.gos.get("ensureDomOrder")||jt(this.gos,"print")}listenOnDomOrder(e){let t=()=>{e.rowComp.setDomOrder(this.getDomOrder())};e.compBean.addManagedPropertyListeners(["domLayout","ensureDomOrder"],t)}setAnimateFlags(e){if(this.rowNode.sticky||!e)return;let t=K(this.rowNode.oldRowTop),{visibleCols:i}=this.beans,n=i.isPinningLeft(),s=i.isPinningRight();if(t){let{slideInAnimation:o}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){o.fullWidth=!0;return}o.center=!0,o.left=n,o.right=s}else{let{fadeInAnimation:o}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){o.fullWidth=!0;return}o.center=!0,o.left=n,o.right=s}}isFullWidth(){return this.rowType!=="Normal"}refreshFullWidth(){let e=(r,a)=>r?r.rowComp.refreshFullWidth(()=>this.createFullWidthCompDetails(r.element,a).params):!0,t=e(this.fullWidthGui,null),i=e(this.centerGui,null),n=e(this.leftGui,"left"),s=e(this.rightGui,"right");return t&&i&&n&&s}addListeners(){let{beans:e,gos:t,rowNode:i}=this,{expansionSvc:n,eventSvc:s,context:o,rowSpanSvc:r}=e;this.addManagedListeners(this.rowNode,b({heightChanged:()=>this.onRowHeightChanged(),rowSelected:()=>this.onRowSelected(),rowIndexChanged:this.onRowIndexChanged.bind(this),topChanged:this.onTopChanged.bind(this)},n?.getRowExpandedListeners(this)??{})),i.detail&&this.addManagedListeners(i.parent,{dataChanged:this.onRowNodeDataChanged.bind(this)}),this.addManagedListeners(i,{dataChanged:this.onRowNodeDataChanged.bind(this),cellChanged:this.postProcessCss.bind(this),rowHighlightChanged:this.onRowNodeHighlightChanged.bind(this),draggingChanged:this.postProcessRowDragging.bind(this),uiLevelChanged:this.onUiLevelChanged.bind(this),rowPinned:this.onRowPinned.bind(this)}),this.addManagedListeners(s,{paginationPixelOffsetChanged:this.onPaginationPixelOffsetChanged.bind(this),heightScaleChanged:this.onTopChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),virtualColumnsChanged:this.onVirtualColumnsChanged.bind(this),cellFocused:this.onCellFocusChanged.bind(this),cellFocusCleared:this.onCellFocusChanged.bind(this),paginationChanged:this.onPaginationChanged.bind(this),modelUpdated:this.refreshFirstAndLastRowStyles.bind(this),columnMoved:()=>this.updateColumnLists()}),r&&this.addManagedListeners(r,{spannedCellsUpdated:({pinned:a})=>{a&&!i.rowPinned||this.updateColumnLists()}}),this.addDestroyFunc(()=>{this.rowDragComps=this.destroyBeans(this.rowDragComps,o),this.tooltipFeature=this.destroyBean(this.tooltipFeature,o),this.rowEditStyleFeature=this.destroyBean(this.rowEditStyleFeature,o)}),this.addManagedPropertyListeners(["rowStyle","getRowStyle","rowClass","getRowClass","rowClassRules"],this.postProcessCss.bind(this)),this.addManagedPropertyListener("rowDragEntireRow",()=>{if(t.get("rowDragEntireRow")){for(let l of this.allRowGuis)this.addRowDraggerToRow(l);return}this.rowDragComps=this.destroyBeans(this.rowDragComps,o)}),this.addListenersForCellComps()}addListenersForCellComps(){this.addManagedListeners(this.rowNode,{rowIndexChanged:()=>{for(let e of this.getAllCellCtrls())e.onRowIndexChanged()},cellChanged:e=>{for(let t of this.getAllCellCtrls())t.onCellChanged(e)}})}onRowPinned(){for(let e of this.allRowGuis)e.rowComp.toggleCss("ag-row-pinned-source",!!this.rowNode.pinnedSibling)}onRowNodeDataChanged(e){this.refreshRow({suppressFlash:!e.update,newData:!e.update})}refreshRow(e){if(this.isFullWidth()!==!!this.isNodeFullWidthCell()){this.beans.rowRenderer.redrawRow(this.rowNode);return}if(this.isFullWidth()){this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode);return}for(let i of this.getAllCellCtrls())i.refreshCell(e);for(let i of this.allRowGuis)this.setRowCompRowId(i.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(i.rowComp);this.onRowSelected(),this.postProcessCss()}postProcessCss(){this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.rowEditStyleFeature?.applyRowStyles(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){let e=this.beans.rowDropHighlightSvc,t=e?.row===this.rowNode?e.position:"none",i=t==="above",n=t==="inside",s=t==="below",r=this.gos.get("treeData")&&(s||i),a=this.rowNode.uiLevel.toString();for(let l of this.allRowGuis){let d=l.rowComp;d.toggleCss("ag-row-highlight-above",i),d.toggleCss("ag-row-highlight-inside",n),d.toggleCss("ag-row-highlight-below",s),d.toggleCss("ag-row-highlight-indent",r),r?l.element.style.setProperty("--ag-row-highlight-level",a):l.element.style.removeProperty("--ag-row-highlight-level")}}postProcessRowDragging(){let e=this.rowNode.dragging;for(let t of this.allRowGuis)t.rowComp.toggleCss("ag-row-dragging",e)}onDisplayedColumnsChanged(){this.updateColumnLists(!0),this.beans.rowAutoHeight?.requestCheckAutoHeight()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:xs(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}onKeyboardNavigate(e){let t=this.findFullWidthInfoForEvent(e);if(!t)return;let{rowGui:i,column:n}=t;if(!(i.element===e.target))return;let r=this.rowNode,{focusSvc:a,navigation:l}=this.beans,d=a.getFocusedCell(),c={rowIndex:r.rowIndex,rowPinned:r.rowPinned,column:d?.column??n};l?.navigateToNextCell(e,e.key,c,!0),e.preventDefault()}onTabKeyDown(e){if(e.defaultPrevented||Ms(e))return;let t=this.allRowGuis.find(a=>a.element.contains(e.target)),i=t?t.element:null,n=i===e.target,s=ot(this.beans),o=!1;i&&s&&(o=i.contains(s)&&s.classList.contains("ag-cell"));let r=null;!n&&!o&&(r=pr(this.beans,i,!1,e.shiftKey)),(this.isFullWidth()&&n||!r)&&this.beans.navigation?.onTabKeyDown(this,e)}getFullWidthElement(){return this.fullWidthGui?this.fullWidthGui.element:null}getRowYPosition(){let e=this.allRowGuis.find(t=>Gn(t.element))?.element;return e?e.getBoundingClientRect().top:0}onSuppressCellFocusChanged(e){let t=this.isFullWidth()&&e?void 0:this.gos.get("tabIndex");for(let i of this.allRowGuis)Fi(i.element,"tabindex",t)}onFullWidthRowFocused(e){let t=this.rowNode,i=e?this.isFullWidth()&&e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned:!1,n;if(this.fullWidthGui)n=this.fullWidthGui.element;else{let o=this.beans.colModel.getCol(e?.column)?.pinned;o?n=o==="right"?this.rightGui?.element:this.leftGui?.element:n=this.centerGui?.element}n&&(n.classList.toggle("ag-full-width-focus",i),i&&e?.forceBrowserFocus&&n.focus({preventScroll:!0}))}recreateCell(e){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,e),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,e),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,e),e.destroy(),this.updateColumnLists()}removeCellCtrl(e,t){let i={list:[],map:{}};for(let n of e.list)n!==t&&(i.list.push(n),i.map[n.column.getInstanceId()]=n);return i}onMouseEvent(e,t){switch(e){case"dblclick":this.onRowDblClick(t);break;case"click":this.onRowClick(t);break;case"touchstart":case"mousedown":this.onRowMouseDown(t);break}}createRowEvent(e,t){let{rowNode:i}=this;return ae(this.gos,{type:e,node:i,data:i.data,rowIndex:i.rowIndex,rowPinned:i.rowPinned,event:t})}createRowEventWithSource(e,t){let i=this.createRowEvent(e,t);return i.source=this,i}onRowDblClick(e){if(Ms(e))return;let t=this.createRowEventWithSource("rowDoubleClicked",e);t.isEventHandlingSuppressed=this.isSuppressMouseEvent(e),this.beans.eventSvc.dispatchEvent(t)}findFullWidthInfoForEvent(e){if(!e)return;let t=this.findFullWidthRowGui(e.target),i=this.getColumnForFullWidth(t);if(!(!t||!i))return{rowGui:t,column:i}}findFullWidthRowGui(e){return this.allRowGuis.find(t=>t.element.contains(e))}getColumnForFullWidth(e){let{visibleCols:t}=this.beans;switch(e?.containerType){case"center":return t.centerCols[0];case"left":return t.leftCols[0];case"right":return t.rightCols[0];default:return t.allCols[0]}}onRowMouseDown(e){if(this.lastMouseDownOnDragger=er(e.target,"ag-row-drag",3),!this.isFullWidth()||this.isSuppressMouseEvent(e))return;let{rangeSvc:t,focusSvc:i}=this.beans;t?.removeAllCellRanges();let n=this.findFullWidthInfoForEvent(e);if(!n)return;let{rowGui:s,column:o}=n,r=s.element,a=e.target,l=this.rowNode,d=e.defaultPrevented||po();r&&r.contains(a)&&bd(a)&&(d=!1),i.setFocusedCell({rowIndex:l.rowIndex,column:o,rowPinned:l.rowPinned,forceBrowserFocus:d})}isSuppressMouseEvent(e){let{gos:t,rowNode:i}=this;if(this.isFullWidth()){let s=this.findFullWidthRowGui(e.target);return dV(t,s?.rowComp.getFullWidthCellRendererParams(),i,e)}let n=sw(t,e.target);return n!=null&&Ep(t,n.column,i,e)}onRowClick(e){if(Ms(e)||this.lastMouseDownOnDragger)return;let i=this.isSuppressMouseEvent(e),{eventSvc:n,selectionSvc:s}=this.beans,o=this.createRowEventWithSource("rowClicked",e);o.isEventHandlingSuppressed=i,n.dispatchEvent(o),!i&&s?.handleSelectionEvent(e,this.rowNode,"rowClicked")}setupDetailRowAutoHeight(e){this.rowType==="FullWidthDetail"&&this.beans.masterDetailSvc?.setupDetailRowAutoHeight(this,e)}createFullWidthCompDetails(e,t){let{gos:i,rowNode:n}=this,s=ae(i,{fullWidth:!0,data:n.data,node:n,value:n.key,valueFormatted:n.key,eGridCell:e,eParentOfValue:e,pinned:t,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(r,a,l,d)=>this.addFullWidthRowDragging(r,a,l,d),setTooltip:(r,a)=>{i.assertModuleRegistered("Tooltip",3),this.setupFullWidthRowTooltip(r,a)}}),o=this.beans.userCompFactory;switch(this.rowType){case"FullWidthDetail":return fB(o,s);case"FullWidthGroup":{let{value:r,valueFormatted:a}=this.beans.valueSvc.getValueForDisplay(void 0,this.rowNode,!0);return s.value=r,s.valueFormatted=a,gB(o,s)}case"FullWidthLoading":return pB(o,s);default:return hB(o,s)}}setupFullWidthRowTooltip(e,t){this.fullWidthGui&&(this.tooltipFeature=this.beans.tooltipSvc?.setupFullWidthRowTooltip(this.tooltipFeature,this,e,t))}addFullWidthRowDragging(e,t,i="",n){let{rowDragSvc:s,context:o}=this.beans;if(!s||!this.isFullWidth())return;let r=s.createRowDragComp(()=>i,this.rowNode,void 0,e,t,n);this.createBean(r,o),this.addDestroyFunc(()=>{this.destroyBean(r,o)})}onUiLevelChanged(){let e=h6(this.rowNode);if(this.rowLevel!=e){let t="ag-row-level-"+e,i="ag-row-level-"+this.rowLevel;for(let n of this.allRowGuis)n.rowComp.toggleCss(t,!0),n.rowComp.toggleCss(i,!1)}this.rowLevel=e}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getLastRow()}refreshFirstAndLastRowStyles(){let e=this.isFirstRowOnPage(),t=this.isLastRowOnPage();if(this.firstRowOnPage!==e){this.firstRowOnPage=e;for(let i of this.allRowGuis)i.rowComp.toggleCss("ag-row-first",e)}if(this.lastRowOnPage!==t){this.lastRowOnPage=t;for(let i of this.allRowGuis)i.rowComp.toggleCss("ag-row-last",t)}}getAllCellCtrls(){return this.leftCellCtrls.list.length===0&&this.rightCellCtrls.list.length===0?this.centerCellCtrls.list:[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){let e=[];if(this.beans.rowStyleSvc?.processClassesFromGridOptions(e,this.rowNode),!!e.length)for(let t of e)for(let i of this.allRowGuis)i.rowComp.toggleCss(t,!0)}postProcessRowClassRules(){this.beans.rowStyleSvc?.processRowClassRules(this.rowNode,e=>{for(let t of this.allRowGuis)t.rowComp.toggleCss(e,!0)},e=>{for(let t of this.allRowGuis)t.rowComp.toggleCss(e,!1)})}setStylesFromGridOptions(e,t){e&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(t,i=>i.rowComp.setUserStyles(this.rowStyles))}getPinnedForContainer(e){return e==="left"||e==="right"?e:null}getInitialRowClasses(e){let t=this.getPinnedForContainer(e),i=this.isFullWidth(),{rowNode:n,beans:s}=this,o=[];o.push("ag-row"),o.push(this.rowFocused?"ag-row-focus":"ag-row-no-focus"),this.fadeInAnimation[e]&&o.push("ag-opacity-zero"),o.push(n.rowIndex%2===0?"ag-row-even":"ag-row-odd"),n.isRowPinned()&&(o.push("ag-row-pinned"),s.pinnedRowModel?.isManual()&&o.push("ag-row-pinned-manual")),!n.isRowPinned()&&n.pinnedSibling&&o.push("ag-row-pinned-source"),n.isSelected()&&o.push("ag-row-selected"),n.footer&&o.push("ag-row-footer"),o.push("ag-row-level-"+this.rowLevel),n.stub&&o.push("ag-row-loading"),i&&o.push("ag-full-width-row"),s.expansionSvc?.addExpandedCss(o,n),n.dragging&&o.push("ag-row-dragging");let{rowStyleSvc:r}=s;return r&&(r.processClassesFromGridOptions(o,n),r.preProcessRowClassRules(o,n)),o.push(this.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),this.isFirstRowOnPage()&&o.push("ag-row-first"),this.isLastRowOnPage()&&o.push("ag-row-last"),i&&(t==="left"&&o.push("ag-cell-last-left-pinned"),t==="right"&&o.push("ag-cell-first-right-pinned")),o}processStylesFromGridOptions(){return this.beans.rowStyleSvc?.processStylesFromGridOptions(this.rowNode)??this.emptyStyle}onRowSelected(e){this.beans.selectionSvc?.onRowCtrlSelected(this,t=>{(t===this.centerGui||t===this.fullWidthGui)&&this.announceDescription()},e)}announceDescription(){this.beans.selectionSvc?.announceAriaRowSelection(this.rowNode)}addHoverFunctionality(e){if(!this.active)return;let{element:t,compBean:i}=e,{rowNode:n,beans:s,gos:o}=this;i.addManagedListeners(t,{pointerenter:r=>{r.pointerType==="mouse"&&n.dispatchRowEvent("mouseEnter")},pointerleave:r=>{r.pointerType==="mouse"&&n.dispatchRowEvent("mouseLeave")}}),i.addManagedListeners(n,{mouseEnter:()=>{!s.dragSvc?.dragging&&!o.get("suppressRowHoverHighlight")&&(t.classList.add("ag-row-hover"),n.setHovered(!0))},mouseLeave:()=>{this.resetHoveredStatus(t)}})}resetHoveredStatus(e){let t=e?[e]:this.allRowGuis.map(i=>i.element);for(let i of t)i.classList.remove("ag-row-hover");this.rowNode.setHovered(!1)}roundRowTopToBounds(e){let t=this.beans.ctrlsSvc.getScrollFeature().getApproximateVScollPosition(),i=this.applyPaginationOffset(t.top,!0)-100,n=this.applyPaginationOffset(t.bottom,!0)+100;return Math.min(Math.max(i,e),n)}forEachGui(e,t){if(e)t(e);else for(let i of this.allRowGuis)t(i)}isRowRendered(){return this.allRowGuis.length>0}onRowHeightChanged(e){if(this.rowNode.rowHeight==null)return;let t=this.rowNode.rowHeight,i=this.beans.environment.getDefaultRowHeight(),s=o4(this.gos)?ao(this.beans,this.rowNode).height:void 0,o=s?`${Math.min(i,s)-2}px`:void 0;this.forEachGui(e,r=>{r.element.style.height=`${t}px`,o&&r.element.style.setProperty("--ag-line-height",o)})}destroyFirstPass(e=!1){this.active=!1;let{rowNode:t}=this;if(!e&&Pa(this.gos)&&!t.sticky)if(t.rowTop!=null){let s=this.roundRowTopToBounds(t.rowTop);this.setRowTop(s)}else for(let s of this.allRowGuis)s.rowComp.toggleCss("ag-opacity-zero",!0);this.fullWidthGui?.element.contains(ot(this.beans))&&this.beans.focusSvc.attemptToRecoverFocus(),t.setHovered(!1);let i=this.createRowEvent("virtualRowRemoved");this.dispatchLocalEvent(i),this.beans.eventSvc.dispatchEvent(i),super.destroy()}destroySecondPass(){this.allRowGuis.length=0;let e=t=>{for(let i of t.list)i.destroy();return{list:[],map:{}}};this.centerCellCtrls=e(this.centerCellCtrls),this.leftCellCtrls=e(this.leftCellCtrls),this.rightCellCtrls=e(this.rightCellCtrls)}setFocusedClasses(e){this.forEachGui(e,t=>{t.rowComp.toggleCss("ag-row-focus",this.rowFocused),t.rowComp.toggleCss("ag-row-no-focus",!this.rowFocused)})}onCellFocusChanged(){let{focusSvc:e}=this.beans,t=e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);t!==this.rowFocused&&(this.rowFocused=t,this.setFocusedClasses())}onPaginationChanged(){let e=this.beans.pagination?.getCurrentPage()??0;this.paginationPage!==e&&(this.paginationPage=e,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(e,t=!1){if(this.rowNode.isRowPinned()||this.rowNode.sticky)return e;let i=this.beans.pageBounds.getPixelOffset();return e+i*(t?1:-1)}setRowTop(e){if(!this.printLayout&&K(e)){let t=this.applyPaginationOffset(e),s=`${this.rowNode.isRowPinned()||this.rowNode.sticky?t:this.beans.rowContainerHeight.getRealPixelPosition(t)}px`;this.setRowTopStyle(s)}}getInitialRowTop(e){return this.suppressRowTransform?this.getInitialRowTopShared(e):void 0}getInitialTransform(e){return this.suppressRowTransform?void 0:`translateY(${this.getInitialRowTopShared(e)})`}getInitialRowTopShared(e){if(this.printLayout)return"";let t=this.rowNode,i;if(t.sticky)i=t.stickyRowTop;else{let n=this.slideInAnimation[e]?this.roundRowTopToBounds(t.oldRowTop):t.rowTop,s=this.applyPaginationOffset(n);i=t.isRowPinned()?s:this.beans.rowContainerHeight.getRealPixelPosition(s)}return i+"px"}setRowTopStyle(e){for(let t of this.allRowGuis)this.suppressRowTransform?t.rowComp.setTop(e):t.rowComp.setTransform(`translateY(${e})`)}getCellCtrl(e,t=!1){let i=null;for(let n of this.getAllCellCtrls())n.column==e&&(i=n);if(i!=null||t)return i;for(let n of this.getAllCellCtrls())n?.getColSpanningList().indexOf(e)>=0&&(i=n);return i}onRowIndexChanged(){this.rowNode.rowIndex!=null&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}updateRowIndexes(e){let t=this.rowNode.getRowIndexString();if(t===null)return;let i=(this.beans.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0)+(this.beans.filterManager?.getHeaderRowCount()??0),n=this.rowNode.rowIndex%2===0,s=i+this.rowNode.rowIndex+1;this.forEachGui(e,o=>{o.rowComp.setRowIndex(t),o.rowComp.toggleCss("ag-row-even",n),o.rowComp.toggleCss("ag-row-odd",!n),Fp(o.element,s)})}},P$=class extends F{constructor(){super(),this.beanName="navigation",this.onPageDown=cR(this.onPageDown,100),this.onPageUp=cR(this.onPageUp,100)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}handlePageScrollingKey(e,t=!1){let i=e.key,n=e.altKey,s=e.ctrlKey||e.metaKey,o=!!this.beans.rangeSvc&&e.shiftKey,r=LV(this.gos,e),a=!1;switch(i){case k.PAGE_HOME:case k.PAGE_END:!s&&!n&&(this.onHomeOrEndKey(i),a=!0);break;case k.LEFT:case k.RIGHT:case k.UP:case k.DOWN:if(!r)return!1;s&&!n&&!o&&(this.onCtrlUpDownLeftRight(i,r),a=!0);break;case k.PAGE_DOWN:case k.PAGE_UP:!s&&!n&&(a=this.handlePageUpDown(i,r,t));break}return a&&e.preventDefault(),a}handlePageUpDown(e,t,i){return i&&(t=this.beans.focusSvc.getFocusedCell()),t?(e===k.PAGE_UP?this.onPageUp(t):this.onPageDown(t),!0):!1}navigateTo({scrollIndex:e,scrollType:t,scrollColumn:i,focusIndex:n,focusColumn:s,isAsync:o,rowPinned:r}){let{scrollFeature:a}=this.gridBodyCon;K(i)&&!i.isPinned()&&a.ensureColumnVisible(i),K(e)&&a.ensureIndexVisible(e,t),o||a.ensureIndexVisible(n);let{focusSvc:l,rangeSvc:d}=this.beans;l.setFocusedCell({rowIndex:n,column:s,rowPinned:r,forceBrowserFocus:!0}),d?.setRangeToCell({rowIndex:n,rowPinned:r,column:s})}onPageDown(e){let t=this.beans,i=qC(t),n=this.getViewportHeight(),{pageBounds:s,rowModel:o,rowAutoHeight:r}=t,a=s.getPixelOffset(),l=i.top+n,d=o.getRowIndexAtPixel(l+a);r?.active?this.navigateToNextPageWithAutoHeight(e,d):this.navigateToNextPage(e,d)}onPageUp(e){let t=this.beans,i=qC(t),{pageBounds:n,rowModel:s,rowAutoHeight:o}=t,r=n.getPixelOffset(),a=i.top,l=s.getRowIndexAtPixel(a+r);o?.active?this.navigateToNextPageWithAutoHeight(e,l,!0):this.navigateToNextPage(e,l,!0)}navigateToNextPage(e,t,i=!1){let{pageBounds:n,rowModel:s}=this.beans,o=this.getViewportHeight(),r=n.getFirstRow(),a=n.getLastRow(),l=n.getPixelOffset(),d=s.getRow(e.rowIndex),c=i?d?.rowHeight-o-l:o-l,u=d?.rowTop+c,h=s.getRowIndexAtPixel(u+l);if(h===e.rowIndex){let g=i?-1:1;t=h=e.rowIndex+g}let p;i?(p="bottom",h<r&&(h=r),t<r&&(t=r)):(p="top",h>a&&(h=a),t>a&&(t=a)),this.isRowTallerThanView(s.getRow(h))&&(t=h,p="top"),this.navigateTo({scrollIndex:t,scrollType:p,scrollColumn:null,focusIndex:h,focusColumn:e.column})}navigateToNextPageWithAutoHeight(e,t,i=!1){this.navigateTo({scrollIndex:t,scrollType:i?"bottom":"top",scrollColumn:null,focusIndex:t,focusColumn:e.column}),setTimeout(()=>{let n=this.getNextFocusIndexForAutoHeight(e,i);this.navigateTo({scrollIndex:t,scrollType:i?"bottom":"top",scrollColumn:null,focusIndex:n,focusColumn:e.column,isAsync:!0})},50)}getNextFocusIndexForAutoHeight(e,t=!1){let i=t?-1:1,n=this.getViewportHeight(),{pageBounds:s,rowModel:o}=this.beans,r=s.getLastRow(),a=0,l=e.rowIndex;for(;l>=0&&l<=r;){let d=o.getRow(l);if(d){let c=d.rowHeight??0;if(a+c>n)break;a+=c}l+=i}return Math.max(0,Math.min(l,r))}getViewportHeight(){let e=this.beans,t=qC(e),i=this.beans.scrollVisibleSvc.getScrollbarWidth(),n=t.bottom-t.top;return e.ctrlsSvc.get("center").isHorizontalScrollShowing()&&(n-=i),n}isRowTallerThanView(e){if(!e)return!1;let t=e.rowHeight;return typeof t!="number"?!1:t>this.getViewportHeight()}onCtrlUpDownLeftRight(e,t){let i=this.beans.cellNavigation.getNextCellToFocus(e,t,!0),n=this.getNormalisedPosition(i),{rowIndex:s,rowPinned:o,column:r}=n??i,a=r;this.navigateTo({scrollIndex:s,scrollType:null,scrollColumn:a,focusIndex:s,focusColumn:a,rowPinned:o})}onHomeOrEndKey(e){let t=e===k.PAGE_HOME,{visibleCols:i,pageBounds:n,rowModel:s}=this.beans,o=i.allCols,r=t?n.getFirstRow():n.getLastRow(),a=s.getRow(r);if(!a)return;let l=(t?o:[...o].reverse()).find(d=>!d.isSuppressNavigable(a));l&&this.navigateTo({scrollIndex:r,scrollType:null,scrollColumn:l,focusIndex:r,focusColumn:l})}onTabKeyDown(e,t){let i=t.shiftKey,n=this.tabToNextCellCommon(e,i,t),s=this.beans,{ctrlsSvc:o,pageBounds:r,focusSvc:a,gos:l}=s;if(n!==!1){n?t.preventDefault():n===null&&o.get("gridCtrl").allowFocusForNextCoreContainer(i);return}if(i){let{rowIndex:d,rowPinned:c}=e.getRowPosition();(c?d===0:d===r.getFirstRow())&&(l.get("headerHeight")===0||sr(s)?Ga(s,!0,!0):(t.preventDefault(),a.focusPreviousFromFirstCell(t)))}else e instanceof Oa&&e.focusCell(!0),(a.focusOverlay(!1)||Ga(s,i))&&t.preventDefault()}tabToNextCell(e,t){let i=this.beans,{focusSvc:n,rowRenderer:s}=i,o=n.getFocusedCell();if(!o)return!1;let r=Ra(i,o);return!r&&(r=s.getRowByPosition(o),!r?.isFullWidth())?!1:!!this.tabToNextCellCommon(r,e,t,"api")}tabToNextCellCommon(e,t,i,n="ui"){let{editSvc:s,focusSvc:o}=this.beans,r,a=e instanceof Oa?e:e.getAllCellCtrls()?.[0];return s?.isEditing()?r=s?.moveToNextCell(a,t,i,n):r=this.moveToNextCellNotEditing(e,t,i),r===null?r:r||!!o.focusedHeader}moveToNextCellNotEditing(e,t,i){let n=this.beans.visibleCols.allCols,s;if(e instanceof Xp){if(s=O(b({},e.getRowPosition()),{column:t?n[0]:je(n)}),this.gos.get("embedFullWidthRows")&&i){let r=e.findFullWidthInfoForEvent(i);r&&(s.column=r.column)}}else s=e.getFocusedCellPosition();let o=this.findNextCellToFocusOn(s,{backwards:t,startEditing:!1});if(o===!1)return null;if(o instanceof Oa)o.focusCell(!0);else if(o)return this.tryToFocusFullWidthRow(o,t);return K(o)}findNextCellToFocusOn(e,{backwards:t,startEditing:i,skipToNextEditableCell:n}){let s=e,o=this.beans,{cellNavigation:r,gos:a,focusSvc:l,rowRenderer:d,rangeSvc:c}=o;for(;;){e!==s&&(e=s),t||(s=this.getLastCellOfColSpan(s)),s=r.getNextTabbedCell(s,t);let u=a.getCallback("tabToNextCell");if(K(u)){let f=u({backwards:t,editing:i,previousCellPosition:e,nextCellPosition:s||null});if(f===!0)s=e;else{if(f===!1)return!1;s={rowIndex:f.rowIndex,column:f.column,rowPinned:f.rowPinned}}}if(!s)return null;if(s.rowIndex<0){let g=Nn(o);return l.focusHeaderPosition({headerPosition:{headerRowIndex:g+s.rowIndex,column:s.column},fromCell:!0}),null}let h=a.get("editType")==="fullRow";if(i&&(!h||n)&&!this.isCellEditable(s))continue;this.ensureCellVisible(s);let p=Ra(o,s);if(!p){let g=d.getRowByPosition(s);if(!g||!g.isFullWidth()||i)continue;return O(b({},g.getRowPosition()),{column:s?.column})}if(!r.isSuppressNavigable(p.column,p.rowNode))return p.setFocusedCellPosition(s),c?.setRangeToCell(s),p}}isCellEditable(e){let t=this.lookupRowNodeForCell(e);return t?e.column.isCellEditable(t):!1}lookupRowNodeForCell({rowIndex:e,rowPinned:t}){let{pinnedRowModel:i,rowModel:n}=this.beans;return t==="top"?i?.getPinnedTopRow(e):t==="bottom"?i?.getPinnedBottomRow(e):n.getRow(e)}navigateToNextCell(e,t,i,n){let s=i,o=!1,r=this.beans,{cellNavigation:a,focusSvc:l,gos:d}=r;for(;s&&(s===i||!this.isValidNavigateCell(s));)d.get("enableRtl")?t===k.LEFT&&(s=this.getLastCellOfColSpan(s)):t===k.RIGHT&&(s=this.getLastCellOfColSpan(s)),s=a.getNextCellToFocus(t,s),o=tt(s);if(o&&e&&e.key===k.UP&&(s={rowIndex:-1,rowPinned:null,column:i.column}),n){let u=d.getCallback("navigateToNextCell");if(K(u)){let p=u({key:t,previousCellPosition:i,nextCellPosition:s||null,event:e});K(p)?s={rowPinned:p.rowPinned,rowIndex:p.rowIndex,column:p.column}:s=null}}if(!s)return;if(s.rowIndex<0){let u=Nn(r);l.focusHeaderPosition({headerPosition:{headerRowIndex:u+s.rowIndex,column:i.column},event:e||void 0,fromCell:!0});return}let c=this.getNormalisedPosition(s);c?this.focusPosition(c):this.tryToFocusFullWidthRow(s)}getNormalisedPosition(e){if(!!this.beans.spannedRowRenderer?.getCellByPosition(e))return e;this.ensureCellVisible(e);let i=Ra(this.beans,e);return i?(e=i.getFocusedCellPosition(),this.ensureCellVisible(e),e):null}tryToFocusFullWidthRow(e,t){let{visibleCols:i,rowRenderer:n,focusSvc:s,eventSvc:o}=this.beans,r=i.allCols;if(!n.getRowByPosition(e)?.isFullWidth())return!1;let l=s.getFocusedCell(),d={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column||(t?je(r):r[0])};this.focusPosition(d);let c=t??(l!=null&&Dz(d,l));return o.dispatchEvent({type:"fullWidthRowFocused",rowIndex:d.rowIndex,rowPinned:d.rowPinned,column:d.column,isFullWidthCell:!0,fromBelow:c}),!0}focusPosition(e){let{focusSvc:t,rangeSvc:i}=this.beans;t.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0}),i?.setRangeToCell(e)}isValidNavigateCell(e){return!!ks(this.beans,e)}getLastCellOfColSpan(e){let t=Ra(this.beans,e);if(!t)return e;let i=t.getColSpanningList();return i.length===1?e:{rowIndex:e.rowIndex,column:je(i),rowPinned:e.rowPinned}}ensureCellVisible(e){let t=a4(this.gos),i=this.beans.rowModel.getRow(e.rowIndex),n=t&&i?.sticky,{scrollFeature:s}=this.gridBodyCon;!n&&tt(e.rowPinned)&&s.ensureIndexVisible(e.rowIndex),e.column.isPinned()||s.ensureColumnVisible(e.column)}ensureColumnVisible(e){let t=this.gridBodyCon.scrollFeature;e.isPinned()||t.ensureColumnVisible(e)}ensureRowVisible(e){this.gridBodyCon.scrollFeature.ensureIndexVisible(e)}};function qC(e){return e.ctrlsSvc.getScrollFeature().getVScrollPosition()}var F$={moduleName:"KeyboardNavigation",version:q,beans:[P$,Qq,cq],apiFunctions:{getFocusedCell:Zq,clearFocusedCell:e$,setFocusedCell:t$,setFocusedHeader:s$,tabToNextCell:i$,tabToPreviousCell:n$}},T$=class extends F{constructor(){super(...arguments),this.beanName="pageBoundsListener"}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this),recalculateRowBounds:this.calculatePages.bind(this)}),this.onModelUpdated()}onModelUpdated(e){this.calculatePages(),this.eventSvc.dispatchEvent({type:"paginationChanged",animate:e?.animate??!1,newData:e?.newData??!1,newPage:e?.newPage??!1,newPageSize:e?.newPageSize??!1,keepRenderedRows:e?.keepRenderedRows??!1})}calculatePages(){let{pageBounds:e,pagination:t,rowModel:i}=this.beans;t?t.calculatePages():e.calculateBounds(0,i.getRowCount()-1)}},A$=class extends F{constructor(){super(...arguments),this.beanName="pageBounds",this.pixelOffset=0}getFirstRow(){return this.topRowBounds?.rowIndex??-1}getLastRow(){return this.bottomRowBounds?.rowIndex??-1}getCurrentPageHeight(){let{topRowBounds:e,bottomRowBounds:t}=this;return!e||!t?0:Math.max(t.rowTop+t.rowHeight-e.rowTop,0)}getCurrentPagePixelRange(){let{topRowBounds:e,bottomRowBounds:t}=this,i=e?.rowTop??0,n=t?t.rowTop+t.rowHeight:0;return{pageFirstPixel:i,pageLastPixel:n}}calculateBounds(e,t){let{rowModel:i}=this.beans,n=i.getRowBounds(e);n&&(n.rowIndex=e),this.topRowBounds=n;let s=i.getRowBounds(t);s&&(s.rowIndex=t),this.bottomRowBounds=s,this.calculatePixelOffset()}getPixelOffset(){return this.pixelOffset}calculatePixelOffset(){let e=this.topRowBounds?.rowTop??0;this.pixelOffset!==e&&(this.pixelOffset=e,this.eventSvc.dispatchEvent({type:"paginationPixelOffsetChanged"}))}},I$=".ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top{min-width:0;overflow:hidden;position:relative}.ag-pinned-left-sticky-top,.ag-pinned-right-sticky-top{height:100%;overflow:hidden;position:relative}.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{height:100%;overflow:hidden;width:100%}.ag-pinned-left-header,.ag-pinned-right-header{display:inline-block;height:100%;overflow:hidden;position:relative}.ag-body-horizontal-scroll:not(.ag-scrollbar-invisible){.ag-horizontal-left-spacer:not(.ag-scroller-corner){border-right:var(--ag-pinned-column-border)}.ag-horizontal-right-spacer:not(.ag-scroller-corner){border-left:var(--ag-pinned-column-border)}}.ag-pinned-right-header{border-left:var(--ag-pinned-column-border)}.ag-pinned-left-header{border-right:var(--ag-pinned-column-border)}.ag-cell.ag-cell-first-right-pinned:not(.ag-cell-range-left,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-left:var(--ag-pinned-column-border)}.ag-cell.ag-cell-last-left-pinned:not(.ag-cell-range-right,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-right:var(--ag-pinned-column-border)}.ag-pinned-left-header .ag-header-cell-resize:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}.ag-pinned-right-header .ag-header-cell-resize:after{left:50%}.ag-pinned-left-header .ag-header-cell-resize{right:-3px}.ag-pinned-right-header .ag-header-cell-resize{left:-3px}",_$=class extends F{constructor(e,t){super(),this.isLeft=e,this.elements=t,this.getWidth=e?()=>this.beans.pinnedCols.leftWidth:()=>this.beans.pinnedCols.rightWidth}postConstruct(){this.addManagedEventListeners({[`${this.isLeft?"left":"right"}PinnedWidthChanged`]:this.onPinnedWidthChanged.bind(this)})}onPinnedWidthChanged(){let e=this.getWidth(),t=e>0;for(let i of this.elements)i&&(et(i,t),Bn(i,e))}},L$=class extends F{constructor(){super(...arguments),this.beanName="pinnedCols"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,t=>{this.gridBodyCtrl=t.gridBodyCtrl});let e=this.checkContainerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}checkContainerWidths(){let{gos:e,visibleCols:t,eventSvc:i}=this.beans,n=jt(e,"print"),s=n?0:t.getColsLeftWidth(),o=n?0:t.getDisplayedColumnsRightWidth();s!=this.leftWidth&&(this.leftWidth=s,i.dispatchEvent({type:"leftPinnedWidthChanged"})),o!=this.rightWidth&&(this.rightWidth=o,i.dispatchEvent({type:"rightPinnedWidthChanged"}))}keepPinnedColumnsNarrowerThanViewport(){let e=this.gridBodyCtrl.eBodyViewport,t=Ad(e);if(t<=50)return;let i=this.getPinnedColumnsOverflowingViewport(t-50),n=this.gos.getCallback("processUnpinnedColumns"),{columns:s,hasLockedPinned:o}=i,r=s;!r.length&&!o||(n&&(r=n({columns:r,viewportWidth:t})),r?.length&&(r=r.filter(a=>!Es(a)),this.setColsPinned(r,null,"viewportSizeFeature")))}createPinnedWidthFeature(e,...t){return new _$(e,t)}setColsPinned(e,t,i){let{colModel:n,colAnimation:s,visibleCols:o,gos:r}=this.beans;if(!n.cols||!e?.length)return;if(jt(r,"print")){I(37);return}s?.start();let a;t===!0||t==="left"?a="left":t==="right"?a="right":a=null;let l=[];for(let d of e){if(!d)continue;let c=n.getCol(d);c&&c.getPinned()!==a&&(this.setColPinned(c,a),l.push(c))}l.length&&(o.refresh(i),E4(this.eventSvc,l,i)),s?.finish()}initCol(e){let{pinned:t,initialPinned:i}=e.colDef;t!==void 0?this.setColPinned(e,t):this.setColPinned(e,i)}setColPinned(e,t){t===!0||t==="left"?e.pinned="left":t==="right"?e.pinned="right":e.pinned=null,e.dispatchStateUpdatedEvent("pinned")}setupHeaderPinnedWidth(e){let{scrollVisibleSvc:t}=this.beans;if(e.pinned==null)return;let i=e.pinned==="left",n=e.pinned==="right";e.hidden=!0;let s=()=>{let o=i?this.leftWidth:this.rightWidth;if(o==null)return;let r=o==0,a=e.hidden!==r,l=this.gos.get("enableRtl"),d=t.getScrollbarWidth(),u=t.verticalScrollShowing&&(l&&i||!l&&n)?o+d:o;e.comp.setPinnedContainerWidth(`${u}px`),e.comp.setDisplayed(!r),a&&(e.hidden=r,e.refresh())};e.addManagedEventListeners({leftPinnedWidthChanged:s,rightPinnedWidthChanged:s,scrollVisibilityChanged:s,scrollbarWidthChanged:s})}getHeaderResizeDiff(e,t){if(t.getPinned()){let{leftWidth:n,rightWidth:s}=this,o=Ad(this.beans.ctrlsSvc.getGridBodyCtrl().eBodyViewport)-50;if(n+s+e>o)if(o>n+s)e=o-n-s;else return 0}return e}getPinnedColumnsOverflowingViewport(e){let t=this.rightWidth??0,i=this.leftWidth??0,n=t+i,s=!1;if(n<e)return{columns:[],hasLockedPinned:s};let{visibleCols:o}=this.beans,r=[...o.leftCols],a=[...o.rightCols],l=0,d=0,c=0,u=[],h=n-c-e;for(;(d<r.length||l<a.length)&&h>0;){if(l<a.length){let p=a[l++];if(p.colDef.lockPinned){s=!0;continue}h-=p.getActualWidth(),u.push(p)}if(d<r.length&&h>0){let p=r[d++];if(p.colDef.lockPinned){s=!0;continue}h-=p.getActualWidth(),u.push(p)}}return{columns:u,hasLockedPinned:s}}},O$={moduleName:"PinnedColumn",version:q,beans:[L$],css:[I$]},N$=class extends F{constructor(){super(),this.beanName="ariaAnnounce",this.descriptionContainer=null,this.pendingAnnouncements=new Map,this.lastAnnouncement="",this.updateAnnouncement=qt(this,this.updateAnnouncement.bind(this),200)}postConstruct(){let e=this.beans,t=Ht(e),i=this.descriptionContainer=t.createElement("div");i.classList.add("ag-aria-description-container"),A6(i,"polite"),rO(i,"additions text"),oO(i,!0),e.eGridDiv.appendChild(i)}announceValue(e,t){this.pendingAnnouncements.set(t,e),this.updateAnnouncement()}updateAnnouncement(){if(!this.descriptionContainer)return;let e=Array.from(this.pendingAnnouncements.values()).join(". ");this.pendingAnnouncements.clear(),this.descriptionContainer.textContent="",setTimeout(()=>{this.handleAnnouncementUpdate(e)},50)}handleAnnouncementUpdate(e){if(!this.isAlive()||!this.descriptionContainer)return;let t=e;if(t==null||t.replace(/[ .]/g,"")==""){this.lastAnnouncement="";return}this.lastAnnouncement===t&&(t=`${t}\u200B`),this.lastAnnouncement=t,this.descriptionContainer.textContent=t}destroy(){super.destroy();let{descriptionContainer:e}=this;e&&($t(e),e.remove()),this.descriptionContainer=null,this.pendingAnnouncements.clear()}},B$={moduleName:"Aria",version:q,beans:[N$]},H$=":where(.ag-delay-render){.ag-cell,.ag-header-cell,.ag-header-group-cell,.ag-row,.ag-spanned-cell-wrapper{visibility:hidden}}",p6="ag-delay-render",V$=class extends F{constructor(){super(...arguments),this.beanName="colDelayRenderSvc",this.hideRequested=!1,this.alreadyRevealed=!1,this.timesRetried=0,this.requesters=new Set}hideColumns(e){this.alreadyRevealed||this.requesters.has(e)||(this.requesters.add(e),this.hideRequested||(this.beans.ctrlsSvc.whenReady(this,t=>{t.gridBodyCtrl.eGridBody.classList.add(p6)}),this.hideRequested=!0))}revealColumns(e){if(this.alreadyRevealed||!this.isAlive()||(this.requesters.delete(e),this.requesters.size>0))return;let{renderStatus:t,ctrlsSvc:i}=this.beans;if(t){if(!t.areHeaderCellsRendered()&&this.timesRetried<5){this.timesRetried++,setTimeout(()=>this.revealColumns(e));return}this.timesRetried=0}i.getGridBodyCtrl().eGridBody.classList.remove(p6),this.alreadyRevealed=!0}},G$={moduleName:"ColumnDelayRender",version:q,beans:[V$],css:[H$]};function z$(e){e.overlays?.showLoadingOverlay()}function W$(e){e.overlays?.showNoRowsOverlay()}function U$(e){e.overlays?.hideOverlay()}var q$=".ag-overlay{inset:0;pointer-events:none;position:absolute;z-index:2}.ag-overlay-panel,.ag-overlay-wrapper{display:flex;height:100%;width:100%}.ag-overlay-wrapper{align-items:center;flex:none;justify-content:center;text-align:center}.ag-overlay-loading-wrapper{pointer-events:all}.ag-overlay-loading-center{background:var(--ag-background-color);border:solid var(--ag-border-width) var(--ag-border-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-popup-shadow);padding:var(--ag-spacing)}",$$={tag:"div",cls:"ag-overlay",role:"presentation",children:[{tag:"div",cls:"ag-overlay-panel",role:"presentation",children:[{tag:"div",ref:"eOverlayWrapper",cls:"ag-overlay-wrapper",role:"presentation"}]}]},iD=class extends Be{constructor(){super($$),this.eOverlayWrapper=U,this.activePromise=null,this.activeOverlay=null,this.updateListenerDestroyFunc=null,this.activeCssClass=null,this.elToFocusAfter=null,this.registerCSS(q$)}handleKeyDown(e){if(e.key!==k.TAB||e.defaultPrevented||Ms(e))return;let t=this.beans;if(pr(t,this.eOverlayWrapper,!1,e.shiftKey))return;let n=!1;e.shiftKey?n=t.focusSvc.focusGridView({column:je(t.visibleCols.allCols),backwards:!0,canFocusOverlay:!1}):n=Ga(t,!1),n&&e.preventDefault()}updateLayoutClasses(e,t){let i=this.eOverlayWrapper.classList,{AUTO_HEIGHT:n,NORMAL:s,PRINT:o}=on;i.toggle(n,t.autoHeight),i.toggle(s,t.normal),i.toggle(o,t.print)}postConstruct(){this.createManagedBean(new iw(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.beans.overlays.setOverlayWrapperComp(this),this.addManagedElementListeners(this.getFocusableElement(),{keydown:this.handleKeyDown.bind(this)})}setWrapperTypeClass(e){let t=this.eOverlayWrapper.classList;this.activeCssClass&&t.toggle(this.activeCssClass,!1),this.activeCssClass=e,t.toggle(e,!0)}showOverlay(e,t,i,n){if(this.setWrapperTypeClass(t),this.destroyActiveOverlay(),this.elToFocusAfter=null,this.activePromise=e,!!e){if(this.setDisplayed(!0,{skipAriaHidden:!0}),i&&this.isGridFocused()){let s=ot(this.beans);s&&!k6(this.beans)&&(this.elToFocusAfter=s)}e.then(s=>{if(this.activePromise!==e){this.activeOverlay!==s&&(this.destroyBean(s),s=null);return}if(this.activePromise=null,!!s){if(this.activeOverlay!==s&&(this.eOverlayWrapper.appendChild(s.getGui()),this.activeOverlay=s,n)){let o=s;this.updateListenerDestroyFunc=this.addManagedPropertyListener(n,({currentValue:r})=>{o.refresh?.(ae(this.gos,b({},r??{})))})}i&&this.isGridFocused()&&lr(this.eOverlayWrapper)}})}}updateOverlayWrapperPaddingTop(e){this.eOverlayWrapper.style.setProperty("padding-top",`${e}px`)}destroyActiveOverlay(){this.activePromise=null;let e=this.activeOverlay;if(!e)return;let t=this.elToFocusAfter;this.activeOverlay=null,this.elToFocusAfter=null,t&&!this.isGridFocused()&&(t=null);let i=this.updateListenerDestroyFunc;i&&(i(),this.updateListenerDestroyFunc=null),this.destroyBean(e),$t(this.eOverlayWrapper),t?.focus?.({preventScroll:!0})}hideOverlay(){this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}isGridFocused(){let e=ot(this.beans);return!!e&&this.beans.eGridDiv.contains(e)}destroy(){this.elToFocusAfter=null,this.destroyActiveOverlay(),this.beans.overlays.setOverlayWrapperComp(void 0),super.destroy()}},j$={selector:"AG-OVERLAY-WRAPPER",component:iD},K$=class extends F{constructor(){super(...arguments),this.beanName="overlays",this.state=0,this.showInitialOverlay=!0,this.wrapperPadding=0}postConstruct(){this.isClientSide=wt(this.gos),this.isServerSide=!this.isClientSide&&Ua(this.gos);let e=()=>this.updateOverlayVisibility();this.addManagedEventListeners({newColumnsLoaded:e,rowDataUpdated:e,gridSizeChanged:this.refreshWrapperPadding.bind(this),rowCountReady:()=>{this.showInitialOverlay=!1,this.updateOverlayVisibility()}}),this.addManagedPropertyListener("loading",e)}setOverlayWrapperComp(e){this.eWrapper=e,this.updateOverlayVisibility()}isVisible(){return this.state!==0&&!!this.eWrapper}isExclusive(){return this.state===1&&!!this.eWrapper}showLoadingOverlay(){this.showInitialOverlay=!1;let e=this.gos,t=e.get("loading");!t&&(t!==void 0||e.get("suppressLoadingOverlay"))||this.doShowLoadingOverlay()}showNoRowsOverlay(){this.showInitialOverlay=!1;let e=this.gos;e.get("loading")||e.get("suppressNoRowsOverlay")||this.doShowNoRowsOverlay()}hideOverlay(){if(this.showInitialOverlay=!1,this.gos.get("loading")){I(99);return}this.doHideOverlay()}getOverlayWrapperSelector(){return j$}getOverlayWrapperCompClass(){return iD}updateOverlayVisibility(){if(!this.eWrapper){this.state=0;return}let{state:e,isClientSide:t,isServerSide:i,beans:{gos:n,colModel:s,rowModel:o}}=this,r=this.gos.get("loading");r!==void 0&&(this.showInitialOverlay=!1),this.showInitialOverlay&&r===void 0&&!n.get("suppressLoadingOverlay")&&(r=!n.get("columnDefs")||!s.ready||!n.get("rowData")&&t),r?e!==1&&this.doShowLoadingOverlay():(this.showInitialOverlay=!1,t&&o.isEmpty()&&!n.get("suppressNoRowsOverlay")?e!==2&&this.doShowNoRowsOverlay():(e===1||!i&&e!==0)&&this.doHideOverlay())}doShowLoadingOverlay(){this.eWrapper&&(this.state=1,this.showOverlay(vB(this.beans.userCompFactory,ae(this.gos,{})),"ag-overlay-loading-wrapper","loadingOverlayComponentParams"),this.updateExclusive())}doShowNoRowsOverlay(){this.eWrapper&&(this.state=2,this.showOverlay(wB(this.beans.userCompFactory,ae(this.gos,{})),"ag-overlay-no-rows-wrapper","noRowsOverlayComponentParams"),this.updateExclusive())}doHideOverlay(){this.eWrapper&&(this.state=0,this.eWrapper.hideOverlay(),this.updateExclusive())}showOverlay(e,t,i){let n=e?.newAgStackInstance()??null;this.eWrapper?.showOverlay(n,t,this.isExclusive(),i),this.refreshWrapperPadding()}updateExclusive(){let e=this.exclusive;this.exclusive=this.isExclusive(),this.exclusive!==e&&this.eventSvc.dispatchEvent({type:"overlayExclusiveChanged"})}refreshWrapperPadding(){let e=this.eWrapper;if(!e)return;let t=0;this.state===2&&(t=this.beans.ctrlsSvc.get("gridHeaderCtrl")?.headerHeight||0),this.wrapperPadding!==t&&(this.wrapperPadding=t,e.updateOverlayWrapperPaddingTop(t))}},Y$={moduleName:"Overlay",version:q,userComponents:{agLoadingOverlay:hG,agNoRowsOverlay:gG},apiFunctions:{showLoadingOverlay:z$,showNoRowsOverlay:W$,hideOverlay:U$},beans:[K$]},X$=class extends F{constructor(){super(...arguments),this.beanName="rowContainerHeight",this.scrollY=0,this.uiBodyHeight=0}postConstruct(){this.addManagedEventListeners({bodyHeightChanged:this.updateOffset.bind(this)}),this.maxDivHeight=xB(),ro(this.gos,"RowContainerHeightService - maxDivHeight = "+this.maxDivHeight)}updateOffset(){if(!this.stretching)return;let e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition().top,t=this.getUiBodyHeight();(e!==this.scrollY||t!==this.uiBodyHeight)&&(this.scrollY=e,this.uiBodyHeight=t,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;let e=this.scrollY/this.maxScrollY,t=e*this.pixelsToShave;ro(this.gos,`RowContainerHeightService - Div Stretch Offset = ${t} (${this.pixelsToShave} * ${e})`),this.setDivStretchOffset(t)}setUiContainerHeight(e){e!==this.uiContainerHeight&&(this.uiContainerHeight=e,this.eventSvc.dispatchEvent({type:"rowContainerHeightChanged"}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(e){let t=typeof e=="number"?Math.floor(e):null;this.divStretchOffset!==t&&(this.divStretchOffset=t,this.eventSvc.dispatchEvent({type:"heightScaleChanged"}))}setModelHeight(e){this.modelHeight=e,this.stretching=e!=null&&this.maxDivHeight>0&&e>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getRealPixelPosition(e){return e-this.divStretchOffset}getUiBodyHeight(){let e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition();return e.bottom-e.top}getScrollPositionForPixel(e){if(this.pixelsToShave<=0)return e;let t=this.modelHeight-this.getUiBodyHeight(),i=e/t;return this.maxScrollY*i}},J$=400,Q$=class extends F{constructor(){super(...arguments),this.beanName="rowRenderer",this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1,this.setupRangeSelectionListeners=()=>{let e=()=>{for(let o of this.getAllCellCtrls())o.onCellSelectionChanged()},t=()=>{for(let o of this.getAllCellCtrls())o.updateRangeBordersIfRangeCount()},i=()=>{this.eventSvc.addListener("cellSelectionChanged",e),this.eventSvc.addListener("columnMoved",t),this.eventSvc.addListener("columnPinned",t),this.eventSvc.addListener("columnVisible",t)},n=()=>{this.eventSvc.removeListener("cellSelectionChanged",e),this.eventSvc.removeListener("columnMoved",t),this.eventSvc.removeListener("columnPinned",t),this.eventSvc.removeListener("columnVisible",t)};this.addDestroyFunc(()=>n()),this.addManagedPropertyListeners(["enableRangeSelection","cellSelection"],()=>{Ds(this.gos)?i():n()}),Ds(this.gos)&&i()}}wireBeans(e){this.pageBounds=e.pageBounds,this.colModel=e.colModel,this.pinnedRowModel=e.pinnedRowModel,this.rowModel=e.rowModel,this.focusSvc=e.focusSvc,this.rowContainerHeight=e.rowContainerHeight,this.ctrlsSvc=e.ctrlsSvc,this.editSvc=e.editSvc}postConstruct(){this.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.initialise()})}initialise(){this.addManagedEventListeners({paginationChanged:this.onPageLoaded.bind(this),pinnedRowDataChanged:this.onPinnedRowDataChanged.bind(this),pinnedRowsChanged:this.onPinnedRowsChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),bodyScroll:this.onBodyScroll.bind(this),bodyHeightChanged:this.redraw.bind(this,{})}),this.addManagedPropertyListeners(["domLayout","embedFullWidthRows"],()=>this.onDomLayoutChanged()),this.addManagedPropertyListeners(["suppressMaxRenderedRowRestriction","rowBuffer"],()=>this.redraw()),this.addManagedPropertyListener("suppressCellFocus",n=>this.onSuppressCellFocusChanged(n.currentValue)),this.addManagedPropertyListeners(["groupSuppressBlankHeader","getBusinessKeyForNode","fullWidthCellRenderer","fullWidthCellRendererParams","suppressStickyTotalRow","groupRowRenderer","groupRowRendererParams","loadingCellRenderer","loadingCellRendererParams","detailCellRenderer","detailCellRendererParams","enableRangeSelection","enableCellTextSelection"],()=>this.redrawRows()),this.addManagedPropertyListener("cellSelection",({currentValue:n,previousValue:s})=>{(!s&&n||s&&!n)&&this.redrawRows()});let{stickyRowSvc:e,gos:t,showRowGroupCols:i}=this.beans;if(i&&this.addManagedPropertyListener("showOpenedGroup",()=>{let n=i.getShowRowGroupCols();n.length&&this.refreshCells({columns:n,force:!0})}),e)this.stickyRowFeature=e.createStickyRowFeature(this,this.createRowCon.bind(this),this.destroyRowCtrls.bind(this));else{let n=this.gridBodyCtrl;n.setStickyTopHeight(0),n.setStickyBottomHeight(0)}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=jt(t,"print"),this.embedFullWidthRows=this.printLayout||t.get("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gos.get("keepDetailRows")){let e=this.getKeepDetailRowsCount(),t=e??3;this.cachedRowCtrls=new Z$(t)}}getKeepDetailRowsCount(){return this.gos.get("keepDetailRowsCount")}getStickyTopRowCtrls(){return this.stickyRowFeature?.stickyTopRowCtrls??[]}getStickyBottomRowCtrls(){return this.stickyRowFeature?.stickyBottomRowCtrls??[]}updateAllRowCtrls(){let e=Object.values(this.rowCtrlsByRowIndex),t=Object.values(this.zombieRowCtrls),i=this.cachedRowCtrls?.getEntries()??[];t.length>0||i.length>0?this.allRowCtrls=[...e,...t,...i]:this.allRowCtrls=e}isCellBeingRendered(e,t){let i=this.rowCtrlsByRowIndex[e];return!t||!i?!!i:i.isFullWidth()?!0:!!this.beans.spannedRowRenderer?.getCellByPosition({rowIndex:e,column:t,rowPinned:null})||!!i.getCellCtrl(t)||!i.isRowRendered()}updateCellFocus(e){for(let t of this.getAllCellCtrls())t.onCellFocused(e);for(let t of this.getFullWidthRowCtrls())t.onFullWidthRowFocused(e)}onCellFocusChanged(e){if(e?.rowIndex!=null&&!e.rowPinned){let t=this.beans.colModel.getCol(e.column)??void 0;this.isCellBeingRendered(e.rowIndex,t)||this.redraw()}this.updateCellFocus(e)}onSuppressCellFocusChanged(e){for(let t of this.getAllCellCtrls())t.onSuppressCellFocusChanged(e);for(let t of this.getFullWidthRowCtrls())t.onSuppressCellFocusChanged(e)}registerCellEventListeners(){this.addManagedEventListeners({cellFocused:e=>this.onCellFocusChanged(e),cellFocusCleared:()=>this.updateCellFocus(),flashCells:e=>{let{cellFlashSvc:t}=this.beans;if(t)for(let i of this.getAllCellCtrls())t.onFlashCells(i,e)},columnHoverChanged:()=>{for(let e of this.getAllCellCtrls())e.onColumnHover()},displayedColumnsChanged:()=>{for(let e of this.getAllCellCtrls())e.onDisplayedColumnsChanged()},displayedColumnsWidthChanged:()=>{if(this.printLayout)for(let e of this.getAllCellCtrls())e.onLeftChanged()}}),this.setupRangeSelectionListeners(),this.refreshListenersToColumnsForCellComps(),this.addManagedEventListeners({gridColumnsChanged:this.refreshListenersToColumnsForCellComps.bind(this)}),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){for(let e of this.destroyFuncsForColumnListeners)e();this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners();let e=this.colModel.getCols();for(let t of e){let i=l=>{for(let d of this.getAllCellCtrls())d.column===t&&l(d)},n=()=>{i(l=>l.onLeftChanged())},s=()=>{i(l=>l.onWidthChanged())},o=()=>{i(l=>l.onFirstRightPinnedChanged())},r=()=>{i(l=>l.onLastLeftPinnedChanged())},a=()=>{i(l=>l.onColDefChanged())};t.__addEventListener("leftChanged",n),t.__addEventListener("widthChanged",s),t.__addEventListener("firstRightPinnedChanged",o),t.__addEventListener("lastLeftPinnedChanged",r),t.__addEventListener("colDefChanged",a),this.destroyFuncsForColumnListeners.push(()=>{t.__removeEventListener("leftChanged",n),t.__removeEventListener("widthChanged",s),t.__removeEventListener("firstRightPinnedChanged",o),t.__removeEventListener("lastLeftPinnedChanged",r),t.__removeEventListener("colDefChanged",a)})}}onDomLayoutChanged(){let e=jt(this.gos,"print"),t=e||this.gos.get("embedFullWidthRows"),i=t!==this.embedFullWidthRows||this.printLayout!==e;this.printLayout=e,this.embedFullWidthRows=t,i&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;let e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}onPageLoaded(e){let t={recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0};this.redrawAfterModelUpdate(t)}getAllCellsNotSpanningForColumn(e){let t=[];for(let i of this.getAllRowCtrls()){let n=i.getCellCtrl(e,!0)?.eGui;n&&t.push(n)}return t}refreshFloatingRowComps(e=!0){this.refreshFloatingRows(this.topRowCtrls,"top",e),this.refreshFloatingRows(this.bottomRowCtrls,"bottom",e)}refreshFloatingRows(e,t,i){let{pinnedRowModel:n,beans:s,printLayout:o}=this,r=Object.fromEntries(e.map(l=>[l.rowNode.id,l]));n?.forEachPinnedRow(t,(l,d)=>{let c=e[d];c&&n.getPinnedRowById(c.rowNode.id,t)===void 0&&(c.destroyFirstPass(),c.destroySecondPass()),l.id in r&&i?(e[d]=r[l.id],delete r[l.id]):e[d]=new Xp(l,s,!1,!1,o)});let a=(t==="top"?n?.getPinnedTopRowCount():n?.getPinnedBottomRowCount())??0;e.length=a}onPinnedRowDataChanged(){let e={recycleRows:!0};this.redrawAfterModelUpdate(e)}onPinnedRowsChanged(){this.redrawAfterModelUpdate({recycleRows:!0})}redrawRow(e,t=!1){if(e.sticky)this.stickyRowFeature?.refreshStickyNode(e);else if(this.cachedRowCtrls?.has(e)){this.cachedRowCtrls.removeRow(e);return}else{let i=n=>{let s=n[e.rowIndex];s&&s.rowNode===e&&(s.destroyFirstPass(),s.destroySecondPass(),n[e.rowIndex]=this.createRowCon(e,!1,!1))};switch(e.rowPinned){case"top":i(this.topRowCtrls);break;case"bottom":i(this.bottomRowCtrls);break;default:i(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}t||this.dispatchDisplayedRowsChanged(!1)}redrawRows(e){let{editSvc:t}=this.beans;if(t?.isEditing()&&(t.isBatchEditing()?t.cleanupEditors():t.stopEditing(void 0,{source:"api"})),e!=null){for(let n of e??[])this.redrawRow(n,!0);this.dispatchDisplayedRowsChanged(!1);return}this.redrawAfterModelUpdate()}redrawAfterModelUpdate(e={}){this.getLockOnRefresh();let t=this.beans.focusSvc?.getFocusCellToUseAfterRefresh();this.updateContainerHeights(),this.scrollToTopIfNewData(e);let i=!e.domLayoutChanged&&!!e.recycleRows,n=e.animate&&Pa(this.gos),s=i?this.getRowsToRecycle():null;i||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender();let{stickyRowFeature:o,gos:r}=this;if(o){o.checkStickyRows();let a=o.extraTopHeight+o.extraBottomHeight;a&&this.updateContainerHeights(a)}this.recycleRows(s,n),this.gridBodyCtrl.updateRowCount(),e.onlyBody||this.refreshFloatingRowComps(r.get("enableRowPinning")?i:void 0),this.dispatchDisplayedRowsChanged(),t!=null&&this.restoreFocusedCell(t),this.releaseLockOnRefresh()}scrollToTopIfNewData(e){let t=e.newData||e.newPage,i=this.gos.get("suppressScrollOnNewData");t&&!i&&(this.gridBodyCtrl.scrollFeature.scrollToTop(),this.stickyRowFeature?.resetOffsets())}updateContainerHeights(e=0){let{rowContainerHeight:t}=this;if(this.printLayout){t.setModelHeight(null);return}let i=this.pageBounds.getCurrentPageHeight();i===0&&(i=1),t.setModelHeight(i+e)}getLockOnRefresh(){if(this.refreshInProgress)throw new Error(Hn(252));this.refreshInProgress=!0,this.beans.frameworkOverrides.getLockOnRefresh?.()}releaseLockOnRefresh(){this.refreshInProgress=!1,this.beans.frameworkOverrides.releaseLockOnRefresh?.()}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(e){if(!e)return;let t=this.beans.focusSvc,i=this.findPositionToFocus(e);if(!i){t.focusHeaderPosition({headerPosition:{headerRowIndex:Nn(this.beans)-1,column:e.column}});return}if(e.rowIndex!==i.rowIndex||e.rowPinned!=i.rowPinned){t.setFocusedCell(O(b({},i),{preventScrollOnBrowserFocus:!0,forceBrowserFocus:!0}));return}t.doesRowOrCellHaveBrowserFocus()||this.updateCellFocus(ae(this.gos,O(b({},i),{forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,type:"cellFocused"})))}findPositionToFocus(e){let{pagination:t,pageBounds:i}=this.beans,n=e;for(n.rowPinned==null&&t&&i&&!t.isRowInPage(n.rowIndex)&&(n={rowPinned:null,rowIndex:i.getFirstRow()});n;){if(n.rowPinned==null&&i)if(n.rowIndex<i.getFirstRow()){if(n=Kp(this.beans,{rowPinned:null,rowIndex:0}),!n)return null}else n.rowIndex>i.getLastRow()&&(n={rowPinned:null,rowIndex:i.getLastRow()});let s=this.getRowByPosition(n);if(s?.isAlive())return O(b({},s.getRowPosition()),{column:e.column});n=Kp(this.beans,n)}return null}getAllCellCtrls(){let e=[],t=this.getAllRowCtrls(),i=t.length;for(let n=0;n<i;n++){let s=t[n].getAllCellCtrls(),o=s.length;for(let r=0;r<o;r++)e.push(s[r])}return e}getAllRowCtrls(){let{spannedRowRenderer:e}=this.beans,t=this.getStickyTopRowCtrls(),i=this.getStickyBottomRowCtrls();return[...this.topRowCtrls,...this.bottomRowCtrls,...t,...i,...e?.getCtrls("top")??[],...e?.getCtrls("bottom")??[],...e?.getCtrls("center")??[],...Object.values(this.rowCtrlsByRowIndex)]}addRenderedRowListener(e,t,i){let n=this.rowCtrlsByRowIndex[t];n&&n.addEventListener(e,i)}refreshCells({rowNodes:e,columns:t,force:i,suppressFlash:n}={}){let s={force:i,newData:!1,suppressFlash:n};for(let o of this.getCellCtrls(e,t))o.refreshOrDestroyCell(s);this.refreshFullWidth(e)}refreshRows(e={}){for(let t of this.getRowCtrls(e.rowNodes))t.refreshRow(e);this.refreshFullWidth(e.rowNodes)}refreshFullWidth(e){if(!e)return;let t=!1;for(let i of this.getRowCtrls(e)){if(!i.isFullWidth())continue;i.refreshFullWidth()||(t=!0,this.redrawRow(i.rowNode,!0))}t&&this.dispatchDisplayedRowsChanged(!1)}getRowCtrls(e){let t=Mv(e),i=this.getAllRowCtrls();return!e||!t?i:i.filter(n=>{let s=n.rowNode;return Dv(s,t)})}getCellCtrls(e,t){let i;K(t)&&(i={},t.forEach(s=>{let o=this.colModel.getCol(s);K(o)&&(i[o.getId()]=!0)}));let n=[];for(let s of this.getRowCtrls(e))for(let o of s.getAllCellCtrls()){let r=o.column.getId();i&&!i[r]||n.push(o)}return n}destroy(){this.removeAllRowComps(!0),super.destroy()}removeAllRowComps(e=!1){let t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t,e),this.stickyRowFeature?.destroyStickyCtrls()}getRowsToRecycle(){let e=[];for(let i of Object.keys(this.rowCtrlsByRowIndex))this.rowCtrlsByRowIndex[i].rowNode.id==null&&e.push(i);this.removeRowCtrls(e);let t={};for(let i of Object.values(this.rowCtrlsByRowIndex)){let n=i.rowNode;t[n.id]=i}return this.rowCtrlsByRowIndex={},t}removeRowCtrls(e,t=!1){for(let i of e){let n=this.rowCtrlsByRowIndex[i];n&&(n.destroyFirstPass(t),n.destroySecondPass()),delete this.rowCtrlsByRowIndex[i]}}onBodyScroll(e){e.direction==="vertical"&&this.redraw({afterScroll:!0})}redraw(e={}){let{focusSvc:t,animationFrameSvc:i}=this.beans,{afterScroll:n}=e,s,o=this.stickyRowFeature;o&&(s=t?.getFocusCellToUseAfterRefresh()||void 0);let r=this.firstRenderedRow,a=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();let l=!1;if(o){l=o.checkStickyRows();let c=o.extraTopHeight+o.extraBottomHeight;c&&this.updateContainerHeights(c)}let d=this.firstRenderedRow!==r||this.lastRenderedRow!==a;if(!(n&&!l&&!d)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,n),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(n&&!l),s!=null)){let c=t?.getFocusCellToUseAfterRefresh();s!=null&&c==null&&(i?.flushAllFrames(),this.restoreFocusedCell(s))}}removeRowCompsNotToDraw(e,t){let i={};for(let o of e)i[o]=!0;let s=Object.keys(this.rowCtrlsByRowIndex).filter(o=>!i[o]);this.removeRowCtrls(s,t)}calculateIndexesToDraw(e){let t=[];for(let r=this.firstRenderedRow;r<=this.lastRenderedRow;r++)t.push(r);let i=this.beans.pagination,n=this.beans.focusSvc?.getFocusedCell()?.rowIndex;n!=null&&(n<this.firstRenderedRow||n>this.lastRenderedRow)&&(!i||i.isRowInPage(n))&&n<this.rowModel.getRowCount()&&t.push(n);let s=r=>{let a=r.rowNode.rowIndex;a==null||a===n||(a<this.firstRenderedRow||a>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(r)&&t.push(a)};for(let r of Object.values(this.rowCtrlsByRowIndex))s(r);if(e)for(let r of Object.values(e))s(r);t.sort((r,a)=>r-a);let o=[];for(let r=0;r<t.length;r++){let a=t[r],l=this.rowModel.getRow(a);l&&!l.sticky&&o.push(a)}return o}recycleRows(e,t=!1,i=!1){let n=this.calculateIndexesToDraw(e);(this.printLayout||i)&&(t=!1),this.removeRowCompsNotToDraw(n,!t);for(let s of n)this.createOrUpdateRowCtrl(s,e,t,i);if(e){let{animationFrameSvc:s}=this.beans;s?.active&&i&&!this.printLayout?s.addDestroyTask(()=>{this.destroyRowCtrls(e,t),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}):this.destroyRowCtrls(e,t)}this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(e=!1){this.eventSvc.dispatchEvent({type:"displayedRowsChanged",afterScroll:e})}onDisplayedColumnsChanged(){let{visibleCols:e}=this.beans,t=e.isPinningLeft(),i=e.isPinningRight();(this.pinningLeft!==t||i!==this.pinningRight)&&(this.pinningLeft=t,this.pinningRight=i,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){let e=[];for(let t of this.getFullWidthRowCtrls()){let i=t.rowNode.rowIndex;e.push(i.toString())}this.refreshFloatingRowComps(),this.removeRowCtrls(e),this.redraw({afterScroll:!0})}getFullWidthRowCtrls(e){let t=Mv(e);return this.getAllRowCtrls().filter(i=>{if(!i.isFullWidth())return!1;let n=i.rowNode;return!(t!=null&&!Dv(n,t))})}createOrUpdateRowCtrl(e,t,i,n){let s,o=this.rowCtrlsByRowIndex[e];if(o||(s=this.rowModel.getRow(e),K(s)&&K(t)&&t[s.id]&&s.alreadyRendered&&(o=t[s.id],t[s.id]=null)),!o)if(s||(s=this.rowModel.getRow(e)),K(s))o=this.createRowCon(s,i,n);else return;s&&(s.alreadyRendered=!0),this.rowCtrlsByRowIndex[e]=o}destroyRowCtrls(e,t){let i=[];if(e){for(let n of Object.values(e))if(n){if(this.cachedRowCtrls&&n.isCacheable()){this.cachedRowCtrls.addRow(n);continue}if(n.destroyFirstPass(!t),t){let s=n.instanceId;this.zombieRowCtrls[s]=n,i.push(()=>{n.destroySecondPass(),delete this.zombieRowCtrls[s]})}else n.destroySecondPass()}}t&&(i.push(()=>{this.isAlive()&&(this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged())}),window.setTimeout(()=>{for(let n of i)n()},J$))}getRowBuffer(){return this.gos.get("rowBuffer")}getRowBufferInPixels(){let e=this.getRowBuffer(),t=ir(this.beans);return e*t}workOutFirstAndLastRowsToRender(){let{rowContainerHeight:e,pageBounds:t,rowModel:i}=this;e.updateOffset();let n,s;if(!i.isRowsToRender())n=0,s=-1;else if(this.printLayout)this.beans.environment.refreshRowHeightVariable(),n=t.getFirstRow(),s=t.getLastRow();else{let c=this.getRowBufferInPixels(),u=this.ctrlsSvc.getScrollFeature(),h=this.gos.get("suppressRowVirtualisation"),p=!1,g,f;do{let y=t.getPixelOffset(),{pageFirstPixel:S,pageLastPixel:x}=t.getCurrentPagePixelRange(),E=e.divStretchOffset,T=u.getVScrollPosition(),L=T.top,N=T.bottom;h?(g=S+E,f=x+E):(g=Math.max(L+y-c,S)+E,f=Math.min(N+y+c,x)+E),this.firstVisibleVPixel=Math.max(L+y,S)+E,this.lastVisibleVPixel=Math.min(N+y,x)+E,p=this.ensureAllRowsInRangeHaveHeightsCalculated(g,f)}while(p);let m=i.getRowIndexAtPixel(g),C=i.getRowIndexAtPixel(f),v=t.getFirstRow(),w=t.getLastRow();m<v&&(m=v),C>w&&(C=w),n=m,s=C}let o=jt(this.gos,"normal"),r=this.gos.get("suppressMaxRenderedRowRestriction"),a=Math.max(this.getRowBuffer(),500);o&&!r&&s-n>a&&(s=n+a);let l=n!==this.firstRenderedRow,d=s!==this.lastRenderedRow;(l||d)&&(this.firstRenderedRow=n,this.lastRenderedRow=s,this.eventSvc.dispatchEvent({type:"viewportChanged",firstRow:n,lastRow:s}))}dispatchFirstDataRenderedEvent(){this.dataFirstRenderedFired||(this.dataFirstRenderedFired=!0,Ps(this.beans,()=>{this.beans.eventSvc.dispatchEvent({type:"firstDataRendered",firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow})}))}ensureAllRowsInRangeHaveHeightsCalculated(e,t){let i=this.pinnedRowModel?.ensureRowHeightsValid(),n=this.stickyRowFeature?.ensureRowHeightsValid(),{pageBounds:s,rowModel:o}=this,r=o.ensureRowHeightsValid(e,t,s.getFirstRow(),s.getLastRow());return(r||n)&&this.eventSvc.dispatchEvent({type:"recalculateRowBounds"}),n||r||i?(this.updateContainerHeights(),!0):!1}doNotUnVirtualiseRow(e){let n=e.rowNode,s=this.focusSvc.isRowFocused(n.rowIndex,n.rowPinned),o=this.editSvc?.isEditing(e),r=n.detail;return s||o||r?!!this.isRowPresent(n):!1}isRowPresent(e){return this.rowModel.isRowPresent(e)?this.beans.pagination?.isRowInPage(e.rowIndex)??!0:!1}createRowCon(e,t,i){let n=this.cachedRowCtrls?.getRow(e)??null;if(n)return n;let s=i&&!this.printLayout&&!!this.beans.animationFrameSvc?.active;return new Xp(e,this.beans,t,s,this.printLayout)}getRenderedNodes(){let e=Object.values(this.rowCtrlsByRowIndex).map(n=>n.rowNode),t=this.getStickyTopRowCtrls().map(n=>n.rowNode),i=this.getStickyBottomRowCtrls().map(n=>n.rowNode);return[...t,...e,...i]}getRowByPosition(e){let t,{rowIndex:i}=e;switch(e.rowPinned){case"top":t=this.topRowCtrls[i];break;case"bottom":t=this.bottomRowCtrls[i];break;default:t=this.rowCtrlsByRowIndex[i],t||(t=this.getStickyTopRowCtrls().find(n=>n.rowNode.rowIndex===i)||null,t||(t=this.getStickyBottomRowCtrls().find(n=>n.rowNode.rowIndex===i)||null));break}return t}isRangeInRenderedViewport(e,t){if(e==null||t==null)return!1;let n=e>this.lastRenderedRow;return!(t<this.firstRenderedRow)&&!n}},Z$=class{constructor(e){this.entriesMap={},this.entriesList=[],this.maxCount=e}addRow(e){if(this.entriesMap[e.rowNode.id]=e,this.entriesList.push(e),e.setCached(!0),this.entriesList.length>this.maxCount){let t=this.entriesList[0];t.destroyFirstPass(),t.destroySecondPass(),this.removeFromCache(t)}}getRow(e){if(e?.id==null)return null;let t=this.entriesMap[e.id];return t?(this.removeFromCache(t),t.setCached(!1),t.rowNode!=e?null:t):null}has(e){return this.entriesMap[e.id]!=null}removeRow(e){let t=e.id,i=this.entriesMap[t];delete this.entriesMap[t],an(this.entriesList,i)}removeFromCache(e){let t=e.rowNode.id;delete this.entriesMap[t],an(this.entriesList,e)}getEntries(){return this.entriesList}};function Mv(e){if(!e)return;let t={top:{},bottom:{},normal:{}};for(let i of e){let n=i.id;switch(i.rowPinned){case"top":t.top[n]=i;break;case"bottom":t.bottom[n]=i;break;default:t.normal[n]=i;break}}return t}function Dv(e,t){let i=e.id;switch(e.rowPinned){case"top":return t.top[i]!=null;case"bottom":return t.bottom[i]!=null;default:return t.normal[i]!=null}}var ej=class extends F{constructor(){super(...arguments),this.beanName="rowNodeSorter"}postConstruct(){let{gos:e}=this;this.isAccentedSort=e.get("accentedSort"),this.primaryColumnsSortGroups=Ln(e),this.addManagedPropertyListener("accentedSort",t=>this.isAccentedSort=t.currentValue),this.addManagedPropertyListener("autoGroupColumnDef",()=>this.primaryColumnsSortGroups=Ln(e))}doFullSort(e,t){let i=e.map((n,s)=>({currentPos:s,rowNode:n}));return i.sort(this.compareRowNodes.bind(this,t)),i.map(n=>n.rowNode)}compareRowNodes(e,t,i){let n=t.rowNode,s=i.rowNode;for(let o=0,r=e.length;o<r;o++){let a=e[o],l=a.sort==="desc",d=this.getValue(n,a.column),c=this.getValue(s,a.column),u,h=this.getComparator(a,n);if(h?u=h(d,c,n,s,l):u=Q9(d,c,this.isAccentedSort),!isNaN(u)&&u!==0)return a.sort==="asc"?u:u*-1}return t.currentPos-i.currentPos}getComparator(e,t){let i=e.column,n=i.getColDef().comparator;if(n!=null)return n;if(!i.getColDef().showRowGroup)return;let s=!t.group&&i.getColDef().field;if(!s)return;let o=this.beans.colModel.getColDefCol(s);if(o)return o.getColDef().comparator}getValue(e,t){let{valueSvc:i,colModel:n,showRowGroupCols:s,gos:o}=this.beans;if(!this.primaryColumnsSortGroups)return i.getValue(t,e,!1);if(e.rowGroupColumn===t){if(d4(o,n.isPivotActive())){let d=e.data?e:Z4(e.childrenAfterGroup);return d&&i.getValue(t,d,!1)}let l=s?.getShowRowGroupCol(t.getId());return l?e.groupData?.[l.getId()]:void 0}if(!(e.group&&t.getColDef().showRowGroup))return i.getValue(t,e,!1)}};function tj(e){e.sortSvc?.onSortChanged("api")}var nD={moduleName:"Sort",version:q,beans:[wq,ej],apiFunctions:{onSortChanged:tj},userComponents:{agSortIndicator:pw},icons:{sortAscending:"asc",sortDescending:"desc",sortUnSort:"none"}},ij=class extends F{constructor(){super(...arguments),this.beanName="syncSvc",this.waitingForColumns=!1}postConstruct(){this.addManagedPropertyListener("columnDefs",e=>this.setColumnDefs(e))}start(){this.beans.ctrlsSvc.whenReady(this,()=>{let e=this.gos.get("columnDefs");e?this.setColumnsAndData(e):this.waitingForColumns=!0,this.gridReady()})}setColumnsAndData(e){let{colModel:t,rowModel:i}=this.beans;t.setColumnDefs(e??[],"gridInitializing"),i.start()}gridReady(){let{eventSvc:e,gos:t}=this;e.dispatchEvent({type:"gridReady"}),ro(t,`initialised successfully, enterprise = ${t.isModuleRegistered("EnterpriseCore")}`)}setColumnDefs(e){let t=this.gos.get("columnDefs");if(t){if(this.waitingForColumns){this.waitingForColumns=!1,this.setColumnsAndData(t);return}this.beans.colModel.setColumnDefs(t,Ta(e.source))}}};function nj(e){e.valueCache?.expire()}function sj(e,t){let{colKey:i,rowNode:n,useFormatter:s}=t,o=e.colModel.getColDefCol(i)??e.colModel.getCol(i);if(tt(o))return null;let r=e.valueSvc.getValueForDisplay(o,n,s);return s?r.valueFormatted??Wa(r.value):r.value}var oj="paste",rj=class extends F{constructor(){super(...arguments),this.beanName="changeDetectionSvc",this.clientSideRowModel=null}postConstruct(){let{gos:e,rowModel:t}=this.beans;wt(e,t)&&(this.clientSideRowModel=t),this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this)})}onCellValueChanged(e){let{gos:t,rowRenderer:i}=this.beans;if(e.source===oj||t.get("suppressChangeDetection"))return;let n=e.node,s=[n],o=this.clientSideRowModel,r=o?.rootNode;if(r&&!n.isRowPinned()){let a=t.get("aggregateOnlyChangedColumns"),l=new Hd(a,r);l.addParentNode(n.parent,[e.column]),o.doAggregate(l),l.forEachChangedNodeDepthFirst(d=>{s.push(d),d.sibling&&s.push(d.sibling)})}i.refreshCells({rowNodes:s})}},aj=class extends F{constructor(){super(...arguments),this.beanName="expressionSvc",this.cache={}}evaluate(e,t){if(typeof e=="string")return this.evaluateExpression(e,t);Ge(15,{expression:e})}evaluateExpression(e,t){try{return this.createExpressionFunction(e)(t.value,t.context,t.oldValue,t.newValue,t.value,t.node,t.data,t.colDef,t.rowIndex,t.api,t.getValue,t.column,t.columnGroup)}catch(i){return Ge(16,{expression:e,params:t,e:i}),null}}createExpressionFunction(e){let t=this.cache;if(t[e])return t[e];let i=this.createFunctionBody(e),n=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, getValue, column, columnGroup",i);return t[e]=n,n}createFunctionBody(e){return e.includes("return")?e:"return "+e+";"}},lj=class extends F{constructor(){super(...arguments),this.beanName="valueCache",this.cacheVersion=0}postConstruct(){let e=this.gos;this.active=e.get("valueCache"),this.neverExpires=e.get("valueCacheNeverExpires")}onDataChanged(){this.neverExpires||this.expire()}expire(){this.cacheVersion++}setValue(e,t,i){if(this.active){let n=this.cacheVersion;e.__cacheVersion!==n&&(e.__cacheVersion=n,e.__cacheData={}),e.__cacheData[t]=i}}getValue(e,t){if(!(!this.active||e.__cacheVersion!==this.cacheVersion))return e.__cacheData[t]}},dj={moduleName:"ValueCache",version:q,beans:[lj],apiFunctions:{expireValueCache:nj}},cj={moduleName:"Expression",version:q,beans:[aj]},uj={moduleName:"ChangeDetection",version:q,beans:[rj]},hj={moduleName:"CellApi",version:q,apiFunctions:{getCellValue:sj}},pj=class extends F{constructor(){super(...arguments),this.beanName="valueSvc",this.hasEditSvc=!1,this.initialised=!1,this.isSsrm=!1}wireBeans(e){this.expressionSvc=e.expressionSvc,this.colModel=e.colModel,this.valueCache=e.valueCache,this.dataTypeSvc=e.dataTypeSvc,this.editSvc=e.editSvc,this.hasEditSvc=!!e.editSvc}postConstruct(){this.initialised||this.init()}init(){this.executeValueGetter=this.valueCache?this.executeValueGetterWithValueCache.bind(this):this.executeValueGetterWithoutValueCache.bind(this),this.isSsrm=Ua(this.gos),this.cellExpressions=this.gos.get("enableCellExpressions"),this.isTreeData=this.gos.get("treeData"),this.initialised=!0;let e=t=>this.callColumnCellValueChangedHandler(t);this.eventSvc.addListener("cellValueChanged",e,!0),this.addDestroyFunc(()=>this.eventSvc.removeListener("cellValueChanged",e,!0)),this.addManagedPropertyListener("treeData",t=>this.isTreeData=t.currentValue)}getValueForDisplay(e,t,i=!1,n=!1,s="ui"){let{showRowGroupColValueSvc:o}=this.beans,r=!e&&t.group,a=e?.colDef.showRowGroup,l=!this.isTreeData||t.footer;if(o&&l&&(r||a)){let f=o.getGroupValue(t,e);if(f==null)return{value:null,valueFormatted:null};if(!i)return{value:f.value,valueFormatted:null};let m=o.formatAndPrefixGroupColValue(f,e,n);return{value:f.value,valueFormatted:m}}if(!e)return{value:t.key,valueFormatted:null};let d=t.leafGroup&&this.colModel.isPivotMode(),c=t.group&&t.expanded&&!t.footer&&!d,u=this.gos.get("groupSuppressBlankHeader")||!t.sibling,h=c&&!u,p=this.getValue(e,t,h,s),g=i&&!(n&&e.colDef.useValueFormatterForExport===!1);return{value:p,valueFormatted:g?this.formatValue(e,t,p):null}}getValue(e,t,i=!1,n="ui"){if(this.initialised||this.init(),!t)return;let s=e.getColDef(),o=s.field,r=e.getColId(),a=t.data;if(this.hasEditSvc&&n==="ui"){let f=this.editSvc;if(f.isEditing()){let m=f.getCellDataValue({rowNode:t,column:e},!0);if(m!==void 0)return m}}let l,d=s.showRowGroup;if(typeof d=="string"&&(this.beans.rowGroupColsSvc?.getColumnIndex(d)??-1)>t.level)return null;let c=typeof d!="string"||!t.group,u=t.groupData&&r in t.groupData,h=!i&&t.aggData&&t.aggData[r]!==void 0,p=this.isSsrm&&i&&!!s.aggFunc,g=this.isSsrm&&t.footer&&t.field&&(s.showRowGroup===!0||s.showRowGroup===t.field);if(this.isTreeData&&h)l=t.aggData[r];else if(this.isTreeData&&s.valueGetter)l=this.executeValueGetter(s.valueGetter,a,e,t);else if(this.isTreeData&&o&&a)l=Md(a,o,e.isFieldContainsDots());else if(u)l=t.groupData[r];else if(h)l=t.aggData[r];else if(s.valueGetter&&!p){if(!c)return l;l=this.executeValueGetter(s.valueGetter,a,e,t)}else if(g)l=Md(a,t.field,e.isFieldContainsDots());else if(o&&a&&!p){if(!c)return l;l=Md(a,o,e.isFieldContainsDots())}if(this.cellExpressions&&typeof l=="string"&&l.indexOf("=")===0){let f=l.substring(1);l=this.executeValueGetter(f,a,e,t)}return l}parseValue(e,t,i,n){let s=e.getColDef(),o=s.valueParser;if(K(o)){let r=ae(this.gos,{node:t,data:t?.data,oldValue:n,newValue:i,colDef:s,column:e});return typeof o=="function"?o(r):this.expressionSvc?.evaluate(o,r)}return i}getDeleteValue(e,t){return K(e.getColDef().valueParser)?this.parseValue(e,t,"",this.getValueForDisplay(e,t).value)??null:null}formatValue(e,t,i,n,s=!0){let{expressionSvc:o}=this.beans,r=null,a,l=e.getColDef();if(n?a=n:s&&(a=l.valueFormatter),a){let d=t?t.data:null,c=ae(this.gos,{value:i,node:t,data:d,colDef:l,column:e});typeof a=="function"?r=a(c):r=o?o.evaluate(a,c):null}else if(l.refData)return l.refData[i]||"";return r==null&&Array.isArray(i)&&(r=i.join(", ")),r}setValue(e,t,i,n){let s=this.colModel.getColDefCol(t);if(!e||!s)return!1;tt(e.data)&&(e.data={});let{field:o,valueSetter:r}=s.getColDef();if(tt(o)&&tt(r))return I(17),!1;if(this.dataTypeSvc&&!this.dataTypeSvc.checkType(s,i))return I(135),!1;let a=ae(this.gos,{node:e,data:e.data,oldValue:this.getValue(s,e,void 0,n),newValue:i,colDef:s.getColDef(),column:s});a.newValue=i;let l;if(K(r)?typeof r=="function"?l=r(a):l=this.expressionSvc?.evaluate(r,a):l=this.setValueUsingField(e.data,o,i,s.isFieldContainsDots()),l===void 0&&(l=!0),!l)return!1;e.resetQuickFilterAggregateText(),this.valueCache?.onDataChanged();let d=this.getValue(s,e);return this.dispatchCellValueChangedEvent(e,a,d,n),e.pinnedSibling&&this.dispatchCellValueChangedEvent(e.pinnedSibling,a,d,n),!0}dispatchCellValueChangedEvent(e,t,i,n){this.eventSvc.dispatchEvent({type:"cellValueChanged",event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:t.column,colDef:t.colDef,data:e.data,node:e,oldValue:t.oldValue,newValue:i,value:i,source:n})}callColumnCellValueChangedHandler(e){let t=e.colDef.onCellValueChanged;typeof t=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>{t({node:e.node,data:e.data,oldValue:e.oldValue,newValue:e.newValue,colDef:e.colDef,column:e.column,api:e.api,context:e.context})})}setValueUsingField(e,t,i,n){if(!t)return!1;let s=!1;if(!n)s=e[t]===i,s||(e[t]=i);else{let o=t.split("."),r=e;for(;o.length>0&&r;){let a=o.shift();o.length===0?(s=r[a]===i,s||(r[a]=i)):r=r[a]}}return!s}executeValueGetterWithValueCache(e,t,i,n){let s=i.getColId(),o=this.valueCache.getValue(n,s);if(o!==void 0)return o;let r=this.executeValueGetterWithoutValueCache(e,t,i,n);return this.valueCache.setValue(n,s,r),r}executeValueGetterWithoutValueCache(e,t,i,n){let s=ae(this.gos,{data:t,node:n,column:i,colDef:i.getColDef(),getValue:this.getValueCallback.bind(this,n)}),o;return typeof e=="function"?o=e(s):o=this.expressionSvc?.evaluate(e,s),o}getValueCallback(e,t){let i=this.colModel.getColDefCol(t);return i?this.getValue(i,e):null}getKeyForNode(e,t){let i=this.getValue(e,t),n=e.getColDef().keyCreator,s=i;if(n){let o=ae(this.gos,{value:i,colDef:e.getColDef(),column:e,node:t,data:t.data});s=n(o)}return typeof s=="string"||s==null||(s=String(s),s==="[object Object]"&&I(121)),s}},gj={moduleName:"CommunityCore",version:q,beans:[fq,lz,yU,WN,X$,IW,dq,Bq,HN,A$,T$,Q$,pj,pq,lq,gq,xU,ij,mU,CU,Yq],icons:{selectOpen:"small-down",smallDown:"small-down",colorPicker:"color-picker",smallUp:"small-up",checkboxChecked:"small-up",checkboxIndeterminate:"checkbox-indeterminate",checkboxUnchecked:"checkbox-unchecked",radioButtonOn:"radio-button-on",radioButtonOff:"radio-button-off",smallLeft:"small-left",smallRight:"small-right"},apiFunctions:{getGridId:dz,destroy:cz,isDestroyed:uz,getGridOption:hz,setGridOption:pz,updateGridOptions:EM,isModuleRegistered:gz},dependsOn:[pU,uW,vW,nD,qq,LW,$q,Y$,uj,Kq,F$,O$,B$,Jq,bU,gU,cj,HW,G$]},sD={AdvancedFilter:1,AiToolkit:1,AllEnterprise:1,BatchEdit:1,CellSelection:1,Clipboard:1,ColumnMenu:1,ColumnsToolPanel:1,ContextMenu:1,ExcelExport:1,FiltersToolPanel:1,Find:1,GridCharts:1,IntegratedCharts:1,GroupFilter:1,MasterDetail:1,Menu:1,MultiFilter:1,NewFiltersToolPanel:1,Pivot:1,RangeSelection:1,RichSelect:1,RowNumbers:1,RowGrouping:1,RowGroupingPanel:1,ServerSideRowModelApi:1,ServerSideRowModel:1,SetFilter:1,SideBar:1,Sparklines:1,StatusBar:1,TreeData:1,ViewportRowModel:1},$C=["TextFilter","NumberFilter","DateFilter","SetFilter","MultiFilter","GroupFilter","CustomFilter"],fj={EditCore:["TextEditor","NumberEditor","DateEditor","CheckboxEditor","LargeTextEditor","SelectEditor","RichSelect","CustomEditor"],CheckboxCellRenderer:["AllCommunity"],ClientSideRowModelHierarchy:["RowGrouping","Pivot","TreeData"],ColumnFilter:$C,ColumnGroupHeaderComp:["AllCommunity"],ColumnGroup:["AllCommunity"],ColumnHeaderComp:["AllCommunity"],ColumnMove:["AllCommunity"],ColumnResize:["AllCommunity"],CommunityCore:["AllCommunity"],CsrmSsrmSharedApi:["ClientSideRowModelApi","ServerSideRowModelApi"],RowModelSharedApi:["ClientSideRowModelApi","ServerSideRowModelApi"],EnterpriseCore:["AllEnterprise"],FilterCore:[...$C,"QuickFilter","ExternalFilter","AdvancedFilter"],GroupCellRenderer:["RowGrouping","Pivot","TreeData","MasterDetail","ServerSideRowModel"],KeyboardNavigation:["AllCommunity"],LoadingCellRenderer:["ServerSideRowModel"],MenuCore:["ColumnMenu","ContextMenu"],MenuItem:["ColumnMenu","ContextMenu","MultiFilter","IntegratedCharts","ColumnsToolPanel"],Overlay:["AllCommunity"],PinnedColumn:["AllCommunity"],SharedAggregation:["RowGrouping","Pivot","TreeData","ServerSideRowModel"],SharedDragAndDrop:["AllCommunity"],SharedMasterDetail:["MasterDetail","ServerSideRowModel"],SharedMenu:[...$C,"ColumnMenu","ContextMenu"],SharedPivot:["Pivot","ServerSideRowModel"],SharedRowGrouping:["RowGrouping","ServerSideRowModel"],SharedRowSelection:["RowSelection","ServerSideRowModel"],SkeletonCellRenderer:["ServerSideRowModel"],Sort:["AllCommunity"],SsrmInfiniteSharedApi:["InfiniteRowModel","ServerSideRowModelApi"],SharedTreeData:["TreeData","ServerSideRowModel"]},mj={InfiniteRowModel:"infinite",ClientSideRowModelApi:"clientSide",ClientSideRowModel:"clientSide",ServerSideRowModelApi:"serverSide",ServerSideRowModel:"serverSide",ViewportRowModel:"viewport"};function Cj(e,t){let i=[];for(let n of Array.isArray(e)?e:[e]){let s=fj[n];if(s)for(let o of s){let r=mj[o];(!r||r===t)&&i.push(o)}else i.push(n)}return i}var oD=()=>`No AG Grid modules are registered! It is recommended to start with all Community features via the AllCommunityModule:
                    
    import { ModuleRegistry, AllCommunityModule } from 'ag-grid-community';
    
    ModuleRegistry.registerModules([ AllCommunityModule ]);
    `,vj=e=>{let t=e.map(n=>`import { ${Dd(n)} } from '${sD[n]?"ag-grid-enterprise":"ag-grid-community"}';`);return e.some(n=>n==="IntegratedCharts"||n==="Sparklines")&&t.push("import { AgChartsEnterpriseModule } from 'ag-charts-enterprise';"),`import { ModuleRegistry } from 'ag-grid-community'; 
${t.join(` 
`)} 

ModuleRegistry.registerModules([ ${e.map(n=>Dd(n,!0)).join(", ")} ]); 

For more info see: ${ka}/modules/`};function Dd(e,t=!1){return t&&(e==="IntegratedCharts"||e==="Sparklines")?`${e}Module.with(AgChartsEnterpriseModule)`:`${e}Module`}function wj(e,t){let i=t.filter(o=>o==="IntegratedCharts"||o==="Sparklines"),n="";return!globalThis?.agCharts&&i.length>0?n=`Unable to use ${e} as either the ag-charts-community or ag-charts-enterprise script needs to be included alongside ag-grid-enterprise.
`:t.some(o=>sD[o])&&(n=n+`Unable to use ${e} as that requires the ag-grid-enterprise script to be included.
`),n}function rD({moduleName:e,rowModelType:t}){return`To use the ${e}Module you must set the gridOption "rowModelType='${t}'"`}var g6=({reasonOrId:e,moduleName:t,gridScoped:i,gridId:n,rowModelType:s,additionalText:o,isUmd:r})=>{let a=Cj(t,s),l=typeof e=="string"?e:xj[e];if(r)return wj(l,a);let d=a.filter(h=>h==="IntegratedCharts"||h==="Sparklines"),c=d.length>0?`${d.map(h=>Dd(h)).join()} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.`:"";return`${`Unable to use ${l} as ${a.length>1?"one of "+a.map(h=>Dd(h)).join(", "):Dd(a[0])} is not registered${i?" for gridId: "+n:""}. ${c} Check if you have registered the module:
`}
${vj(a)}`+(o?` 

${o}`:"")},f6=e=>`${e} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.

import { AgChartsEnterpriseModule } from 'ag-charts-enterprise';
import { ModuleRegistry } from 'ag-grid-community';
import { ${e} } from 'ag-grid-enterprise';
    
ModuleRegistry.registerModules([${e}.with(AgChartsEnterpriseModule)]);
    `,bj=e=>`AG Grid: Unable to use the Clipboard API (navigator.clipboard.${e}()). The reason why it could not be used has been logged in the previous line. For this reason the grid has defaulted to using a workaround which doesn't perform as well. Either fix why Clipboard API is blocked, OR stop this message from appearing by setting grid property suppressClipboardApi=true (which will default the grid to using the workaround rather than the API.`,yj={1:()=>"`rowData` must be an array",2:({nodeId:e})=>`Duplicate node id '${e}' detected from getRowId callback, this could cause issues in your grid.`,3:()=>"Calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.",4:({id:e})=>`Could not find row id=${e}, data item was not found for this id`,5:({data:e})=>["Could not find data item as object was not found.",e," Consider using getRowId to help the Grid find matching row data"],6:()=>"'groupHideOpenParents' only works when specifying specific columns for 'colDef.showRowGroup'",7:()=>"Pivoting is not supported with aligned grids as it may produce different columns in each grid.",8:({key:e})=>`Unknown key for navigation ${e}`,9:({variable:e})=>`No value for ${e?.cssName}. This usually means that the grid has been initialised before styles have been loaded. The default value of ${e?.defaultValue} will be used and updated when styles load.`,10:({eventType:e})=>`As of v33, the '${e}' event is deprecated. Use the global 'modelUpdated' event to determine when row children have changed.`,11:()=>"No gridOptions provided to createGrid",12:({colKey:e})=>["column ",e," not found"],13:()=>"Could not find rowIndex, this means tasks are being executed on a rowNode that has been removed from the grid.",14:({groupPrefix:e})=>`Row IDs cannot start with ${e}, this is a reserved prefix for AG Grid's row grouping feature.`,15:({expression:e})=>["value should be either a string or a function",e],16:({expression:e,params:t,e:i})=>["Processing of the expression failed","Expression = ",e,"Params = ",t,"Exception = ",i],17:()=>"you need either field or valueSetter set on colDef for editing to work",18:()=>"alignedGrids contains an undefined option.",19:()=>"alignedGrids - No api found on the linked grid.",20:()=>`You may want to configure via a callback to avoid setup race conditions:
                     "alignedGrids: () => [linkedGrid]"`,21:()=>"pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.",22:({key:e})=>`${e} is an initial property and cannot be updated.`,23:()=>"The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead.",24:()=>"row height must be a number if not using standard row model",25:({id:e})=>["The getRowId callback must return a string. The ID ",e," is being cast to a string."],26:({fnName:e,preDestroyLink:t})=>`Grid API function ${e}() cannot be called as the grid has been destroyed.
 Either clear local references to the grid api, when it is destroyed, or check gridApi.isDestroyed() to avoid calling methods against a destroyed grid.
 To run logic when the grid is about to be destroyed use the gridPreDestroy event. See: ${t}`,27:({fnName:e,module:t})=>`API function '${e}' not registered to module '${t}'`,28:()=>"setRowCount cannot be used while using row grouping.",29:()=>"tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?",30:({toIndex:e})=>["tried to insert columns in invalid location, toIndex = ",e,"remember that you should not count the moving columns when calculating the new index"],31:()=>"infinite loop in resizeColumnSets",32:()=>"applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state.",33:()=>"stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON.",34:({key:e})=>`the column type '${e}' is a default column type and cannot be overridden.`,35:()=>"Column type definitions 'columnTypes' with a 'type' attribute are not supported because a column type cannot refer to another column type. Only column definitions 'columnDefs' can use the 'type' attribute to refer to a column type.",36:({t:e})=>"colDef.type '"+e+"' does not correspond to defined gridOptions.columnTypes",37:()=>"Changing the column pinning status is not allowed with domLayout='print'",38:({iconName:e})=>`provided icon '${e}' needs to be a string or a function`,39:()=>"Applying column order broke a group where columns should be married together. Applying new order has been discarded.",40:({e,method:t})=>`${e}
${bj(t)}`,41:()=>"Browser did not allow document.execCommand('copy'). Ensure 'api.copySelectedRowsToClipboard() is invoked via a user event, i.e. button click, otherwise the browser will prevent it for security reasons.",42:()=>"Browser does not support document.execCommand('copy') for clipboard operations",43:({iconName:e})=>`As of v33, icon '${e}' is deprecated. Use the icon CSS name instead.`,44:()=>'Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.',45:({parentCellDataType:e})=>`The data type definition ${e} does not exist.`,46:()=>'The "baseDataType" property of a data type definition must match that of its parent.',47:({cellDataType:e})=>`Missing data type definition - "${e}"`,48:({property:e})=>`Cell data type is "object" but no Value ${e} has been provided. Please either provide an object data type definition with a Value ${e}, or set "colDef.value${e}"`,49:({methodName:e})=>`Framework component is missing the method ${e}()`,50:({compName:e})=>`Could not find component ${e}, did you forget to configure this component?`,51:()=>"Export cancelled. Export is not allowed as per your configuration.",52:()=>"There is no `window` associated with the current `document`",53:()=>"unknown value type during csv conversion",54:()=>"Could not find document body, it is needed for drag and drop and context menu.",55:()=>"addRowDropZone - A container target needs to be provided",56:()=>"addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.",57:()=>"unable to show popup filter, filter instantiation failed",58:()=>"no values found for select cellEditor",59:()=>"cannot select pinned rows",60:()=>"cannot select node until it has finished loading",61:()=>"since version v32.2.0, rowNode.isFullWidthCell() has been deprecated. Instead check `rowNode.detail` followed by the user provided `isFullWidthRow` grid option.",62:({colId:e})=>`setFilterModel() - no column found for colId: ${e}`,63:({colId:e})=>`setFilterModel() - unable to fully apply model, filtering disabled for colId: ${e}`,64:({colId:e})=>`setFilterModel() - unable to fully apply model, unable to create filter for colId: ${e}`,65:()=>"filter missing setModel method, which is needed for setFilterModel",66:()=>"filter API missing getModel method, which is needed for getFilterModel",67:()=>"Filter is missing isFilterActive() method",68:()=>"Column Filter API methods have been disabled as Advanced Filters are enabled.",69:({guiFromFilter:e})=>`getGui method from filter returned ${e}; it should be a DOM element.`,70:({newFilter:e})=>`Grid option quickFilterText only supports string inputs, received: ${typeof e}`,71:()=>"debounceMs is ignored when apply button is present",72:({keys:e})=>["ignoring FilterOptionDef as it doesn't contain one of ",e],73:()=>"invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'",74:()=>"no filter options for filter",75:()=>"Unknown button type specified",76:({filterModelType:e})=>['Unexpected type of filter "',e,'", it looks like the filter was configured with incorrect Filter Options'],77:()=>"Filter model is missing 'conditions'",78:()=>'Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.',79:()=>'"filterParams.maxNumConditions" must be greater than or equal to zero.',80:()=>'"filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.',81:()=>'"filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".',82:({param:e})=>`DateFilter ${e} is not a number`,83:()=>"DateFilter minValidYear should be <= maxValidYear",84:()=>"DateFilter minValidDate should be <= maxValidDate",85:()=>"DateFilter should not have both minValidDate and minValidYear parameters set at the same time! minValidYear will be ignored.",86:()=>"DateFilter should not have both maxValidDate and maxValidYear parameters set at the same time! maxValidYear will be ignored.",87:()=>"DateFilter parameter minValidDate should always be lower than or equal to parameter maxValidDate.",88:({index:e})=>`Invalid row index for ensureIndexVisible: ${e}`,89:()=>"A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)",90:()=>"datasource is missing getRows method",91:()=>"Filter is missing method doesFilterPass",92:()=>"AnimationFrameService called but animation frames are off",93:()=>"cannot add multiple ranges when `cellSelection.suppressMultiRanges = true`",94:({paginationPageSizeOption:e,pageSizeSet:t,pageSizesSet:i,pageSizeOptions:n})=>`'paginationPageSize=${e}'${t?"":" (default value)"}, but ${e} is not included in${i?"":" the default"} paginationPageSizeSelector=[${n?.join(", ")}].`,95:({paginationPageSizeOption:e,paginationPageSizeSelector:t})=>`Either set '${t}' to an array that includes ${e} or to 'false' to disable the page size selector.`,96:({id:e,data:t})=>["Duplicate ID",e,"found for pinned row with data",t,"When `getRowId` is defined, it must return unique IDs for all pinned rows. Use the `rowPinned` parameter."],97:({colId:e})=>`cellEditor for column ${e} is missing getGui() method`,98:()=>"popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.",99:()=>"Since v32, `api.hideOverlay()` does not hide the loading overlay when `loading=true`. Set `loading=false` instead.",101:({propertyName:e,componentName:t,agGridDefaults:i,jsComps:n})=>{let s=[],o=[...Object.keys(i??[]).filter(a=>!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(a)),...Object.keys(n??[]).filter(a=>!!n[a])],r=cv({inputValue:t,allSuggestions:o,hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;return s.push(`Could not find '${t}' component. It was configured as "${e}: '${t}'" but it wasn't found in the list of registered components.
`),r.length>0&&s.push(`         Did you mean: [${r.slice(0,3)}]?
`),s.push("If using a custom component check it has been registered correctly."),s},102:()=>"selectAll: 'filtered' only works when gridOptions.rowModelType='clientSide'",103:()=>"Invalid selection state. When using client-side row model, the state must conform to `string[]`.",104:({value:e,param:t})=>`Numeric value ${e} passed to ${t} param will be interpreted as ${e} seconds. If this is intentional use "${e}s" to silence this warning.`,105:({e})=>["chart rendering failed",e],106:()=>`Theming API and Legacy Themes are both used in the same page. A Theming API theme has been provided to the 'theme' grid option, but the file (ag-grid.css) is also included and will cause styling issues. Remove ag-grid.css from the page. See the migration guide: ${ka}/theming-migration/`,107:({key:e,value:t})=>`Invalid value for theme param ${e} - ${t}`,108:({e})=>["chart update failed",e],109:({inputValue:e,allSuggestions:t})=>{let i=cv({inputValue:e,allSuggestions:t,hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;return[`Could not find '${e}' aggregate function. It was configured as "aggFunc: '${e}'" but it wasn't found in the list of registered aggregations.`,i.length>0?`         Did you mean: [${i.slice(0,3)}]?`:"","If using a custom aggregation function check it has been registered correctly."].join(`
`)},110:()=>"groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup",111:()=>"Invalid selection state. When `groupSelects` is enabled, the state must conform to `IServerSideGroupSelectionState`.",113:()=>"Set Filter cannot initialise because you are using a row model that does not contain all rows in the browser. Either use a different filter type, or configure Set Filter such that you provide it with values",114:({component:e})=>`Could not find component with name of ${e}. Is it in Vue.components?`,116:()=>"Invalid selection state. The state must conform to `IServerSideSelectionState`.",117:()=>"selectAll must be of boolean type.",118:()=>"Infinite scrolling must be enabled in order to set the row count.",119:()=>"Unable to instantiate filter",120:()=>"MultiFloatingFilterComp expects MultiFilter as its parent",121:()=>"a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (see AG Grid docs) or b) to toString() on the object to return a key",122:()=>"could not find the document, document is empty",123:()=>"Advanced Filter is only supported with the Client-Side Row Model or Server-Side Row Model.",124:()=>"No active charts to update.",125:({chartId:e})=>`Unable to update chart. No active chart found with ID: ${e}.`,126:()=>"unable to restore chart as no chart model is provided",127:({allRange:e})=>`unable to create chart as ${e?"there are no columns in the grid":"no range is selected"}.`,128:({feature:e})=>`${e} is only available if using 'multiRow' selection mode.`,129:({feature:e,rowModel:t})=>`${e} is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ${t}.`,130:()=>'cannot multi select unless selection mode is "multiRow"',132:()=>"Row selection features are not available unless `rowSelection` is enabled.",133:({iconName:e})=>`icon '${e}' function should return back a string or a dom object`,134:({iconName:e})=>`Did not find icon '${e}'`,135:()=>"Data type of the new value does not match the cell data type of the column",136:()=>"Unable to update chart as the 'type' is missing. It must be either 'rangeChartUpdate', 'pivotChartUpdate', or 'crossFilterChartUpdate'.",137:({type:e,currentChartType:t})=>`Unable to update chart as a '${e}' update type is not permitted on a ${t}.`,138:({chartType:e})=>`invalid chart type supplied: ${e}`,139:({customThemeName:e})=>`a custom chart theme with the name ${e} has been supplied but not added to the 'chartThemes' list`,140:({name:e})=>`no stock theme exists with the name '${e}' and no custom chart theme with that name was supplied to 'customChartThemes'`,141:()=>"cross filtering with row grouping is not supported.",142:()=>"cross filtering is only supported in the client side row model.",143:({panel:e})=>`'${e}' is not a valid Chart Tool Panel name`,144:({type:e})=>`Invalid charts data panel group name supplied: '${e}'`,145:({group:e})=>`As of v32, only one charts customize panel group can be expanded at a time. '${e}' will not be expanded.`,146:({comp:e})=>`Unable to instantiate component '${e}' as its module hasn't been loaded. Add 'ValidationModule' to see which module is required.`,147:({group:e})=>`Invalid charts customize panel group name supplied: '${e}'`,148:({group:e})=>`invalid chartGroupsDef config '${e}'`,149:({group:e,chartType:t})=>`invalid chartGroupsDef config '${e}.${t}'`,150:()=>"'seriesChartTypes' are required when the 'customCombo' chart type is specified.",151:({chartType:e})=>`invalid chartType '${e}' supplied in 'seriesChartTypes', converting to 'line' instead.`,152:({colId:e})=>`no 'seriesChartType' found for colId = '${e}', defaulting to 'line'.`,153:({chartDataType:e})=>`unexpected chartDataType value '${e}' supplied, instead use 'category', 'series' or 'excluded'`,154:({colId:e})=>`cross filtering requires a 'agSetColumnFilter' or 'agMultiColumnFilter' to be defined on the column with id: ${e}`,155:({option:e})=>`'${e}' is not a valid Chart Toolbar Option`,156:({panel:e})=>`Invalid panel in chartToolPanelsDef.panels: '${e}'`,157:({unrecognisedGroupIds:e})=>["unable to find group(s) for supplied groupIds:",e],158:()=>"can not expand a column item that does not represent a column group header",159:()=>"Invalid params supplied to createExcelFileForExcel() - `ExcelExportParams.data` is empty.",160:()=>"Export cancelled. Export is not allowed as per your configuration.",161:()=>"The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'",162:({id:e,dataType:t})=>`Unrecognized data type for excel export [${e}.dataType=${t}]`,163:({featureName:e})=>`Excel table export does not work with ${e}. The exported Excel file will not contain any Excel tables.
 Please turn off ${e} to enable Excel table exports.`,164:()=>"Unable to add data table to Excel sheet: A table already exists.",165:()=>"Unable to add data table to Excel sheet: Missing required parameters.",166:({unrecognisedGroupIds:e})=>["unable to find groups for these supplied groupIds:",e],167:({unrecognisedColIds:e})=>["unable to find columns for these supplied colIds:",e],168:()=>"detailCellRendererParams.template should be function or string",169:()=>'Reference to eDetailGrid was missing from the details template. Please add data-ref="eDetailGrid" to the template.',170:({providedStrategy:e})=>`invalid cellRendererParams.refreshStrategy = ${e} supplied, defaulting to refreshStrategy = 'rows'.`,171:()=>"could not find detail grid options for master detail, please set gridOptions.detailCellRendererParams.detailGridOptions",172:()=>"could not find getDetailRowData for master / detail, please set gridOptions.detailCellRendererParams.getDetailRowData",173:({group:e})=>`invalid chartGroupsDef config '${e}'`,174:({group:e,chartType:t})=>`invalid chartGroupsDef config '${e}.${t}'`,175:({menuTabName:e,itemsToConsider:t})=>[`Trying to render an invalid menu item '${e}'. Check that your 'menuTabs' contains one of `,t],176:({key:e})=>`unknown menu item type ${e}`,177:()=>"valid values for cellSelection.handle.direction are 'x', 'y' and 'xy'. Default to 'xy'.",178:({colId:e})=>`column ${e} is not visible`,179:()=>"totalValueGetter should be either a function or a string (expression)",180:()=>"agRichSelectCellEditor requires cellEditorParams.values to be set",181:()=>"agRichSelectCellEditor cannot have `multiSelect` and `allowTyping` set to `true`. AllowTyping has been turned off.",182:()=>'you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data',183:()=>"Group Column Filter only works on group columns. Please use a different filter.",184:({parentGroupData:e,childNodeData:t})=>["duplicate group keys for row data, keys should be unique",[e,t]],185:({data:e})=>["getDataPath() should not return an empty path",[e]],186:({rowId:e,rowData:t,duplicateRowsData:i})=>["duplicate group keys for row data, keys should be unique",e,t,...i??[]],187:({rowId:e,firstData:t,secondData:i})=>[`Duplicate node id ${e}. Row IDs are provided via the getRowId() callback. Please modify the getRowId() callback code to provide unique row id values.`,"first instance",t,"second instance",i],188:e=>`getRowId callback must be provided for Server Side Row Model ${e?.feature||"selection"} to work correctly.`,189:({startRow:e})=>`invalid value ${e} for startRow, the value should be >= 0`,190:({rowGroupId:e,data:t})=>["null and undefined values are not allowed for server side row model keys",e?`column = ${e}`:"","data is ",t],194:({method:e})=>`calling gridApi.${e}() is only possible when using rowModelType=\`clientSide\`.`,195:({justCurrentPage:e})=>`selecting just ${e?"current page":"filtered"} only works when gridOptions.rowModelType='clientSide'`,196:({key:e})=>`Provided ids must be of string type. Invalid id provided: ${e}`,197:()=>"`toggledNodes` must be an array of string ids.",199:()=>"getSelectedNodes and getSelectedRows functions cannot be used with select all functionality with the server-side row model. Use `api.getServerSideSelectionState()` instead.",200:g6,201:({rowModelType:e})=>`Could not find row model for rowModelType = ${e}`,202:()=>"`getSelectedNodes` and `getSelectedRows` functions cannot be used with `groupSelectsChildren` and the server-side row model. Use `api.getServerSideSelectionState()` instead.",203:()=>"Server Side Row Model does not support Dynamic Row Height and Cache Purging. Either a) remove getRowHeight() callback or b) remove maxBlocksInCache property. Purging has been disabled.",204:()=>"Server Side Row Model does not support Auto Row Height and Cache Purging. Either a) remove colDef.autoHeight or b) remove maxBlocksInCache property. Purging has been disabled.",205:({duplicateIdText:e})=>`Unable to display rows as duplicate row ids (${e}) were returned by the getRowId callback. Please modify the getRowId callback to provide unique ids.`,206:()=>"getRowId callback must be implemented for transactions to work. Transaction was ignored.",207:()=>'The Set Filter Parameter "defaultToNothingSelected" value was ignored because it does not work when "excelMode" is used.',208:()=>"Set Filter Value Formatter must return string values. Please ensure the Set Filter Value Formatter returns string values for complex objects.",209:()=>`Set Filter Key Creator is returning null for provided values and provided values are primitives. Please provide complex objects. See ${ka}/filter-set-filter-list/#filter-value-types`,210:()=>"Set Filter has a Key Creator, but provided values are primitives. Did you mean to provide complex objects?",211:()=>"property treeList=true for Set Filter params, but you did not provide a treeListPathGetter or values of type Date.",212:()=>"please review all your toolPanel components, it seems like at least one of them doesn't have an id",213:()=>"Advanced Filter does not work with Filters Tool Panel. Filters Tool Panel has been disabled.",214:({key:e})=>`unable to lookup Tool Panel as invalid key supplied: ${e}`,215:({key:e,defaultByKey:t})=>`the key ${e} is not a valid key for specifying a tool panel, valid keys are: ${Object.keys(t??{}).join(",")}`,216:({name:e})=>`Missing component for '${e}'`,217:({invalidColIds:e})=>["unable to find grid columns for the supplied colDef(s):",e],218:({property:e,defaultOffset:t})=>`${e} must be a number, the value you provided is not a valid number. Using the default of ${t}px.`,219:({property:e})=>`Property ${e} does not exist on the target object.`,220:({lineDash:e})=>`'${e}' is not a valid 'lineDash' option.`,221:()=>"agAggregationComponent should only be used with the client and server side row model.",222:()=>"agFilteredRowCountComponent should only be used with the client side row model.",223:()=>"agSelectedRowCountComponent should only be used with the client and server side row model.",224:()=>"agTotalAndFilteredRowCountComponent should only be used with the client side row model.",225:()=>"agTotalRowCountComponent should only be used with the client side row model.",226:()=>"viewport is missing init method.",227:()=>"menu item icon must be DOM node or string",228:({menuItemOrString:e})=>`unrecognised menu item ${e}`,229:({index:e})=>["invalid row index for ensureIndexVisible: ",e],230:()=>"detailCellRendererParams.template is not supported by AG Grid React. To change the template, provide a Custom Detail Cell Renderer. See https://www.ag-grid.com/react-data-grid/master-detail-custom-detail/",231:()=>"As of v32, using custom components with `reactiveCustomComponents = false` is deprecated.",232:()=>"Using both rowData and v-model. rowData will be ignored.",233:({methodName:e})=>`Framework component is missing the method ${e}()`,234:()=>'Group Column Filter does not work with the colDef property "field". This property will be ignored.',235:()=>'Group Column Filter does not work with the colDef property "filterValueGetter". This property will be ignored.',236:()=>'Group Column Filter does not work with the colDef property "filterParams". This property will be ignored.',237:()=>"Group Column Filter does not work with Tree Data enabled. Please disable Tree Data, or use a different filter.",238:()=>"setRowCount can only accept a positive row count.",239:()=>'Theming API and CSS File Themes are both used in the same page. In v33 we released the Theming API as the new default method of styling the grid. See the migration docs https://www.ag-grid.com/react-data-grid/theming-migration/. Because no value was provided to the `theme` grid option it defaulted to themeQuartz. But the file (ag-grid.css) is also included and will cause styling issues. Either pass the string "legacy" to the theme grid option to use v32 style themes, or remove ag-grid.css from the page to use Theming API.',240:({theme:e})=>`theme grid option must be a Theming API theme object or the string "legacy", received: ${e}`,243:()=>"Failed to deserialize state - each provided state object must be an object.",244:()=>"Failed to deserialize state - `selectAllChildren` must be a boolean value or undefined.",245:()=>"Failed to deserialize state - `toggledNodes` must be an array.",246:()=>"Failed to deserialize state - Every `toggledNode` requires an associated string id.",247:()=>`Row selection state could not be parsed due to invalid data. Ensure all child state has toggledNodes or does not conform with the parent rule. 
Please rebuild the selection state and reapply it.`,248:()=>"SetFloatingFilter expects SetFilter as its parent",249:()=>"Must supply a Value Formatter in Set Filter params when using a Key Creator",250:()=>"Must supply a Key Creator in Set Filter params when `treeList = true` on a group column, and Tree Data or Row Grouping is enabled.",251:({chartType:e})=>`AG Grid: Unable to create chart as an invalid chartType = '${e}' was supplied.`,252:()=>`cannot get grid to draw rows when it is in the middle of drawing rows. 
Your code probably called a grid API method while the grid was in the render stage. 
To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). 
To see what part of your code that caused the refresh check this stacktrace.`,253:({version:e})=>["Illegal version string: ",e],254:()=>"Cannot create chart: no chart themes available.",255:({point:e})=>`Lone surrogate U+${e?.toString(16).toUpperCase()} is not a scalar value`,256:()=>"Unable to initialise. See validation error, or load ValidationModule if missing.",257:()=>f6("IntegratedChartsModule"),258:()=>f6("SparklinesModule"),259:({part:e})=>`the argument to theme.withPart must be a Theming API part object, received: ${e}`,260:({propName:e,compName:t,gridScoped:i,gridId:n,rowModelType:s})=>g6({reasonOrId:`AG Grid '${e}' component: ${t}`,moduleName:_a[t],gridId:n,gridScoped:i,rowModelType:s}),261:()=>"As of v33, `column.isHovered()` is deprecated. Use `api.isColumnHovered(column)` instead.",262:()=>'As of v33, icon key "smallDown" is deprecated. Use "advancedFilterBuilderSelect" for Advanced Filter Builder dropdown, "selectOpen" for Select cell editor and dropdowns (e.g. Integrated Charts menu), "richSelectOpen" for Rich Select cell editor.',263:()=>'As of v33, icon key "smallLeft" is deprecated. Use "panelDelimiterRtl" for Row Group Panel / Pivot Panel, "subMenuOpenRtl" for sub-menus.',264:()=>'As of v33, icon key "smallRight" is deprecated. Use "panelDelimiter" for Row Group Panel / Pivot Panel, "subMenuOpen" for sub-menus.',265:({colId:e})=>`Unable to infer chart data type for column '${e}' if first data entry is null. Please specify "chartDataType", or a "cellDataType" in the column definition. For more information, see ${ka}/integrated-charts-range-chart#coldefchartdatatype .`,266:()=>'As of v33.1, using "keyCreator" with the Rich Select Editor has been deprecated. It now requires the "formatValue" callback to convert complex data to strings.',267:()=>"Detail grids can not use a different theme to the master grid, the `theme` detail grid option will be ignored.",268:()=>"Transactions aren't supported with tree data when using treeDataChildrenField",269:()=>"When `masterSelects: 'detail'`, detail grids must be configured with multi-row selection",270:({id:e,parentId:t})=>`Cycle detected for row with id='${e}' and parent id='${t}'. Resetting the parent for row with id='${e}' and showing it as a root-level node.`,271:({id:e,parentId:t})=>`Parent row not found for row with id='${e}' and parent id='${t}'. Showing row with id='${e}' as a root-level node.`,272:()=>oD(),273:({providedId:e,usedId:t})=>`Provided column id '${e}' was already in use, ensure all column and group ids are unique. Using '${t}' instead.`,274:({prop:e})=>{let t=`Since v33, ${e} has been deprecated.`;switch(e){case"maxComponentCreationTimeMs":t+=" This property is no longer required and so will be removed in a future version.";break;case"setGridApi":t+=" This method is not called by AG Grid. To access the GridApi see: https://ag-grid.com/react-data-grid/grid-interface/#grid-api ";break;case"children":t+=" For multiple versions AgGridReact does not support children.";break}return t},275:rD,276:()=>"Row Numbers Row Resizer cannot be used when Grid Columns have `autoHeight` enabled.",277:({colId:e})=>`'enableFilterHandlers' is set to true, but column '${e}' does not have 'filter.doesFilterPass' or 'filter.handler' set.`,278:({colId:e})=>`Unable to create filter handler for column '${e}'`,279:e=>{},280:({colId:e})=>`'name' must be provided for custom filter components for column '${e}`,281:({colId:e})=>`Filter for column '${e}' does not have 'filterParams.buttons', but the new Filters Tool Panel has buttons configured. Either configure buttons for the filter, or disable buttons on the Filters Tool Panel.`,282:()=>"New filter tool panel requires `enableFilterHandlers: true`.",283:()=>"As of v34, use the same method on the filter handler (`api.getColumnFilterHandler(colKey)`) instead.",284:()=>"As of v34, filters are active when they have a model. Use `api.getColumnFilterModel()` instead.",285:()=>"As of v34, use (`api.getColumnFilterModel()`) instead.",286:()=>"As of v34, use (`api.setColumnFilterModel()`) instead.",287:()=>"`api.doFilterAction()` requires `enableFilterHandlers = true",288:()=>"`api.getColumnFilterModel(key, true)` requires `enableFilterHandlers = true",289:({rowModelType:e})=>`Row Model '${e}' is not supported with Batch Editing`,290:({rowIndex:e,rowPinned:t})=>`Row with index '${e}' and pinned state '${t}' not found`,291:()=>"License Key being set multiple times with different values. This can result in an incorrect license key being used,",292:({colId:e})=>`The Multi Filter for column '${e}' has buttons configured against the child filters. When 'enableFilterHandlers=true', buttons must instead be provided against the parent Multi Filter params. The child filter buttons will be ignored.`};function Sj(e,t){let i=yj[e];if(!i)return[`Missing error text for error id ${e}!`];let n=i(t),o=`
See ${n4(e,t)}`;return Array.isArray(n)?n.concat(o):[n,o]}var xj={1:"Charting Aggregation",2:"pivotResultFields",3:"setTooltip"},m6=new WeakMap,C6=new WeakMap;function aD(e,t,i){if(!t)return Ge(11),{};let n=i,s;if(!n?.setThemeOnGridDiv){let r=bt({tag:"div"});r.style.height="100%",e.appendChild(r),e=r,s=()=>e.remove()}return new Rj().create(e,t,r=>{let a=new rz(e);r.createBean(a)},void 0,i,s)}var Ej=1,Rj=class{create(e,t,i,n,s,o){let r=Vv.applyGlobalGridOptions(t),a=r.gridId??String(Ej++),l=this.getRegisteredModules(s,a,r.rowModelType),d=this.createBeansList(r.rowModelType,l,a),c=this.createProvidedBeans(e,r,s);if(!d)return;let h={providedBeanInstances:c,beanClasses:d,id:a,beanInitComparator:WG,beanDestroyComparator:UG,derivedBeans:[GG],destroyCallback:()=>{C6.delete(g),m6.delete(e),jO(a),o?.()}},p=new yH(h);this.registerModuleFeatures(p,l),i(p),p.getBean("syncSvc").start(),n?.(p);let g=p.getBean("gridApi");return m6.set(e,g),C6.set(g,e),g}getRegisteredModules(e,t,i){return _d(gj,void 0,!0),e?.modules?.forEach(n=>_d(n,t)),KO(t,v6(i))}registerModuleFeatures(e,t){let i=e.getBean("registry"),n=e.getBean("apiFunctionSvc");for(let s of t){i.registerModule(s);let o=s.apiFunctions;if(o){let r=Object.keys(o);for(let a of r)n?.addFunction(a,o[a])}}}createProvidedBeans(e,t,i){let n=i?i.frameworkOverrides:null;tt(n)&&(n=new cw);let s={gridOptions:t,eGridDiv:e,eRootDiv:e,globalListener:i?i.globalListener:null,globalSyncListener:i?i.globalSyncListener:null,frameworkOverrides:n};return i?.providedBeanInstances&&Object.assign(s,i.providedBeanInstances),s}createBeansList(e,t,i){let n={clientSide:"ClientSideRowModel",infinite:"InfiniteRowModel",serverSide:"ServerSideRowModel",viewport:"ViewportRowModel"},s=v6(e),o=n[s];if(!o){Cd(201,{rowModelType:s},`Unknown rowModelType ${s}.`);return}if(!XO()){Cd(272,void 0,oD());return}if(!e){let a=Object.entries(n).filter(([l,d])=>ev(d,i,l));if(a.length==1){let[l,d]=a[0];if(l!==s){let c={moduleName:d,rowModelType:l};Cd(275,c,rD(c));return}}}if(!ev(o,i,s)){Cd(200,{reasonOrId:`rowModelType = '${s}'`,moduleName:o,gridScoped:Gv(),gridId:i,rowModelType:s},`Missing module ${o}Module for rowModelType ${s}.`);return}let r=new Set;for(let a of t)for(let l of a.beans??[])r.add(l);return Array.from(r)}};function v6(e){return e??"clientSide"}function go(e){let t=e.rowModel;return t.getType()==="clientSide"?t:void 0}function rg(e){let t=e.rowModel;return t.getType()==="infinite"?t:void 0}function Mj(e){let t=e.rowModel;return t.getType()==="serverSide"?t:void 0}var Dj=class extends F{constructor(){super(...arguments),this.beanName="localeSvc"}getLocaleTextFunc(){let e=this.gos,t=e.getCallback("getLocaleText");return t?IO(t):_O(e.get("localeText"))}};function kj(e,t=!1){let i=[],n=[],s=[],o=[],r=[],a=[],l=[],d=[],c=[],u=0;for(let h=0;h<e.length;h++){let{colId:p,sort:g,sortIndex:f,rowGroup:m,rowGroupIndex:C,aggFunc:v,pivot:w,pivotIndex:y,pinned:S,hide:x,width:E,flex:T}=e[h];c.push(p),g&&(i[f??u++]={colId:p,sort:g}),m&&(n[C??0]=p),typeof v=="string"&&s.push({colId:p,aggFunc:v}),w&&(o[y??0]=p),S&&(S==="right"?a:r).push(p),x&&l.push(p),(T!=null||E)&&d.push({colId:p,flex:T??void 0,width:E})}return{sort:i.length?{sortModel:jC(i)}:void 0,rowGroup:n.length?{groupColIds:jC(n)}:void 0,aggregation:s.length?{aggregationModel:s}:void 0,pivot:o.length||t?{pivotMode:t,pivotColIds:jC(o)}:void 0,columnPinning:r.length||a.length?{leftColIds:r,rightColIds:a}:void 0,columnVisibility:l.length?{hiddenColIds:l}:void 0,columnSizing:d.length?{columnSizingModel:d}:void 0,columnOrder:c.length?{orderedColIds:c}:void 0}}function jC(e){return e.filter(t=>t!=null)}function Pj(e){let t=[];for(let{groupId:i,open:n}of e)n&&t.push(i);return t.length?{openColumnGroupIds:t}:void 0}var lD=class{wrap(e,t,i,n){let s=this.createWrapper(e,n);for(let o of t??[])this.createMethod(s,o,!0);for(let o of i??[])this.createMethod(s,o,!1);return s}createMethod(e,t,i){e.addMethod(t,this.createMethodProxy(e,t,i))}createMethodProxy(e,t,i){return function(){return e.hasMethod(t)?e.callMethod(t,arguments):(i&&I(49,{methodName:t}),null)}}};function KC(e){return e.get("tooltipShowMode")==="whenTruncated"}function Fj(e,t){if(typeof e!="number")return"";let i=t(),n=i("thousandSeparator",","),s=i("decimalSeparator",".");return e.toString().replace(".",s).replace(/(\d)(?=(\d{3})+(?!\d))/g,`$1${n}`)}var Tj=class extends F{getFileName(e){let t=this.getDefaultFileExtension();return e?.length||(e=this.getDefaultFileName()),e.includes(".")?e:`${e}.${t}`}getData(e){let t=this.createSerializingSession(e);return this.beans.gridSerializer.serialize(t,e)}getDefaultFileName(){return`export.${this.getDefaultFileExtension()}`}},Aj=class{constructor(e){let{colModel:t,rowGroupColsSvc:i,colNames:n,valueSvc:s,gos:o,processCellCallback:r,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:d}=e;this.colModel=t,this.rowGroupColsSvc=i,this.colNames=n,this.valueSvc=s,this.gos=o,this.processCellCallback=r,this.processHeaderCallback=a,this.processGroupHeaderCallback=l,this.processRowGroupCallback=d}prepare(e){}extractHeaderValue(e){return this.getHeaderName(this.processHeaderCallback,e)??""}extractRowCellValue(e,t,i,n,s){let o=t===0&&c4(this.gos,s,this.colModel.isPivotMode());if(this.processRowGroupCallback&&(this.gos.get("treeData")||s.group)&&(e.isRowGroupDisplayed(s.rowGroupColumn?.getColId()??"")||o))return{value:this.processRowGroupCallback(ae(this.gos,{column:e,node:s}))??""};if(this.processCellCallback)return{value:this.processCellCallback(ae(this.gos,{accumulatedRowIndex:i,column:e,node:s,value:this.valueSvc.getValueForDisplay(e,s,void 0,void 0).value,type:n,parseValue:h=>this.valueSvc.parseValue(e,s,h,this.valueSvc.getValue(e,s,void 0)),formatValue:h=>this.valueSvc.formatValue(e,s,h)??h}))??""};let r=this.gos.get("treeData"),a=this.valueSvc,l=s.level===-1&&s.footer,d=e.colDef.showRowGroup===!0&&(s.group||r);if(!l&&(o||d)){let h="",p=s;for(;p&&p.level!==-1;){let{value:g,valueFormatted:f}=a.getValueForDisplay(o?void 0:e,p,!0,!0);h=` -> ${f??g??""}${h}`,p=p.parent}return{value:h,valueFormatted:h}}let{value:c,valueFormatted:u}=a.getValueForDisplay(e,s,!0,!0);return{value:c??"",valueFormatted:u}}getHeaderName(e,t){return e?e(ae(this.gos,{column:t})):this.colNames.getDisplayNameForColumn(t,"csv",!0)}};function Ij(e,t){let i=document.defaultView||window;if(!i){I(52);return}let n=document.createElement("a"),s=i.URL.createObjectURL(t);n.setAttribute("href",s),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:i})),n.remove(),i.setTimeout(()=>{i.URL.revokeObjectURL(s)},0)}var _j={enableBrowserTooltips:!0,tooltipTrigger:!0,tooltipMouseTrack:!0,tooltipShowMode:!0,tooltipInteraction:!0,defaultColGroupDef:!0,suppressAutoSize:!0,skipHeaderOnAutoSize:!0,autoSizeStrategy:!0,components:!0,stopEditingWhenCellsLoseFocus:!0,undoRedoCellEditing:!0,undoRedoCellEditingLimit:!0,excelStyles:!0,cacheQuickFilter:!0,customChartThemes:!0,chartThemeOverrides:!0,chartToolPanelsDef:!0,loadingCellRendererSelector:!0,localeText:!0,keepDetailRows:!0,keepDetailRowsCount:!0,detailRowHeight:!0,detailRowAutoHeight:!0,tabIndex:!0,valueCache:!0,valueCacheNeverExpires:!0,enableCellExpressions:!0,suppressTouch:!0,suppressBrowserResizeObserver:!0,suppressPropertyNamesCheck:!0,debug:!0,dragAndDropImageComponent:!0,loadingOverlayComponent:!0,suppressLoadingOverlay:!0,noRowsOverlayComponent:!0,paginationPageSizeSelector:!0,paginateChildRows:!0,pivotPanelShow:!0,pivotSuppressAutoColumn:!0,suppressExpandablePivotGroups:!0,aggFuncs:!0,allowShowChangeAfterFilter:!0,ensureDomOrder:!0,enableRtl:!0,suppressColumnVirtualisation:!0,suppressMaxRenderedRowRestriction:!0,suppressRowVirtualisation:!0,rowDragText:!0,groupLockGroupColumns:!0,suppressGroupRowsSticky:!0,rowModelType:!0,cacheOverflowSize:!0,infiniteInitialRowCount:!0,serverSideInitialRowCount:!0,maxBlocksInCache:!0,maxConcurrentDatasourceRequests:!0,blockLoadDebounceMillis:!0,serverSideOnlyRefreshFilteredGroups:!0,serverSidePivotResultFieldSeparator:!0,viewportRowModelPageSize:!0,viewportRowModelBufferSize:!0,debounceVerticalScrollbar:!0,suppressAnimationFrame:!0,suppressPreventDefaultOnMouseWheel:!0,scrollbarWidth:!0,icons:!0,suppressRowTransform:!0,gridId:!0,enableGroupEdit:!0,initialState:!0,processUnpinnedColumns:!0,createChartContainer:!0,getLocaleText:!0,getRowId:!0,reactiveCustomComponents:!0,renderingMode:!0,columnMenu:!0,suppressSetFilterByDefault:!0,getDataPath:!0,enableCellSpan:!0,enableFilterHandlers:!0,filterHandlers:!0},bi="clientSide",oi="serverSide",va="infinite",Lj={onGroupExpandedOrCollapsed:[bi],refreshClientSideRowModel:[bi],isRowDataEmpty:[bi],forEachLeafNode:[bi],forEachNodeAfterFilter:[bi],forEachNodeAfterFilterAndSort:[bi],resetRowHeights:[bi,oi],applyTransaction:[bi],applyTransactionAsync:[bi],flushAsyncTransactions:[bi],getBestCostNodeSelection:[bi],getServerSideSelectionState:[oi],setServerSideSelectionState:[oi],applyServerSideTransaction:[oi],applyServerSideTransactionAsync:[oi],applyServerSideRowData:[oi],retryServerSideLoads:[oi],flushServerSideAsyncTransactions:[oi],refreshServerSide:[oi],getServerSideGroupLevelState:[oi],refreshInfiniteCache:[va],purgeInfiniteCache:[va],getInfiniteRowCount:[va],isLastRowIndexKnown:[va,oi],expandAll:[bi,oi],collapseAll:[bi,oi],onRowHeightChanged:[bi,oi],setRowCount:[va,oi],getCacheBlockState:[va,oi]},Oj={showLoadingOverlay:{version:"v32",message:'`showLoadingOverlay` is deprecated. Use the grid option "loading"=true instead or setGridOption("loading", true).'},clearRangeSelection:{version:"v32.2",message:"Use `clearCellSelection` instead."},getInfiniteRowCount:{version:"v32.2",old:"getInfiniteRowCount()",new:"getDisplayedRowCount()"},selectAllFiltered:{version:"v33",old:"selectAllFiltered()",new:'selectAll("filtered")'},deselectAllFiltered:{version:"v33",old:"deselectAllFiltered()",new:'deselectAll("filtered")'},selectAllOnCurrentPage:{version:"v33",old:"selectAllOnCurrentPage()",new:'selectAll("currentPage")'},deselectAllOnCurrentPage:{version:"v33",old:"deselectAllOnCurrentPage()",new:'deselectAll("currentPage")'}};function Nj(e,t,i){let n=Oj[e];if(n){let{version:o,new:r,old:a,message:l}=n,d=a??e;return(...c)=>{let u=r?`Please use ${r} instead. `:"";return xd(`Since ${o} api.${d} is deprecated. ${u}${l??""}`),t.apply(t,c)}}let s=Lj[e];return s?(...o)=>{let r=i.rowModel.getType();if(!s.includes(r)){Ma(`api.${e} can only be called when gridOptions.rowModelType is ${s.join(" or ")}`);return}return t.apply(t,o)}:t}var Bj={detailCellRendererCtrl:"SharedMasterDetail",dndSourceComp:"DragAndDrop",fillHandle:"CellSelection",groupCellRendererCtrl:"GroupCellRenderer",headerFilterCellCtrl:"ColumnFilter",headerGroupCellCtrl:"ColumnGroup",rangeHandle:"CellSelection",tooltipFeature:"Tooltip",highlightTooltipFeature:"Tooltip",tooltipStateManager:"Tooltip",groupStrategy:"RowGrouping",treeGroupStrategy:"TreeData",rowNumberRowResizer:"RowNumbers",singleCell:"EditCore",fullRow:"EditCore",agSetColumnFilterHandler:"SetFilter",agMultiColumnFilterHandler:"MultiFilter",agGroupColumnFilterHandler:"GroupFilter",agNumberColumnFilterHandler:"NumberFilter",agDateColumnFilterHandler:"DateFilter",agTextColumnFilterHandler:"TextFilter"},Hj={expanded:1,contracted:1,"tree-closed":1,"tree-open":1,"tree-indeterminate":1,pin:1,"eye-slash":1,arrows:1,left:1,right:1,group:1,aggregation:1,pivot:1,"not-allowed":1,chart:1,cross:1,cancel:1,tick:1,first:1,previous:1,next:1,last:1,linked:1,unlinked:1,"color-picker":1,loading:1,menu:1,"menu-alt":1,filter:1,"filter-add":1,columns:1,maximize:1,minimize:1,copy:1,cut:1,paste:1,grip:1,save:1,csv:1,excel:1,"small-down":1,"small-left":1,"small-right":1,"small-up":1,asc:1,desc:1,none:1,up:1,down:1,plus:1,minus:1,settings:1,"checkbox-checked":1,"checkbox-indeterminate":1,"checkbox-unchecked":1,"radio-button-on":1,"radio-button-off":1,eye:1,"column-arrow":1,"un-pin":1,"pinned-top":1,"pinned-bottom":1,"chevron-up":1,"chevron-down":1,"chevron-left":1,"chevron-right":1,edit:1},Vj={chart:"MenuCore",cancel:"EnterpriseCore",first:"Pagination",previous:"Pagination",next:"Pagination",last:"Pagination",linked:"IntegratedCharts",loadingMenuItems:"MenuCore",unlinked:"IntegratedCharts",menu:"ColumnHeaderComp",legacyMenu:"ColumnMenu",filter:"ColumnFilter",filterActive:"ColumnFilter",filterAdd:"NewFiltersToolPanel",filterCardCollapse:"NewFiltersToolPanel",filterCardExpand:"NewFiltersToolPanel",filterCardEditing:"NewFiltersToolPanel",filterTab:"ColumnMenu",filtersToolPanel:"FiltersToolPanel",columns:["MenuCore"],columnsToolPanel:["ColumnsToolPanel"],maximize:"EnterpriseCore",minimize:"EnterpriseCore",save:"MenuCore",columnGroupOpened:"ColumnGroupHeaderComp",columnGroupClosed:"ColumnGroupHeaderComp",accordionOpen:"EnterpriseCore",accordionClosed:"EnterpriseCore",accordionIndeterminate:"EnterpriseCore",columnSelectClosed:["ColumnsToolPanel","ColumnMenu"],columnSelectOpen:["ColumnsToolPanel","ColumnMenu"],columnSelectIndeterminate:["ColumnsToolPanel","ColumnMenu"],columnMovePin:"SharedDragAndDrop",columnMoveHide:"SharedDragAndDrop",columnMoveMove:"SharedDragAndDrop",columnMoveLeft:"SharedDragAndDrop",columnMoveRight:"SharedDragAndDrop",columnMoveGroup:"SharedDragAndDrop",columnMoveValue:"SharedDragAndDrop",columnMovePivot:"SharedDragAndDrop",dropNotAllowed:"SharedDragAndDrop",ensureColumnVisible:["ColumnsToolPanel","ColumnMenu"],groupContracted:"GroupCellRenderer",groupExpanded:"GroupCellRenderer",setFilterGroupClosed:"SetFilter",setFilterGroupOpen:"SetFilter",setFilterGroupIndeterminate:"SetFilter",setFilterLoading:"SetFilter",close:"EnterpriseCore",check:"MenuItem",colorPicker:"CommunityCore",groupLoading:"LoadingCellRenderer",menuAlt:"ColumnHeaderComp",menuPin:"MenuCore",menuValue:"MenuCore",menuAddRowGroup:["MenuCore","ColumnsToolPanel"],menuRemoveRowGroup:["MenuCore","ColumnsToolPanel"],clipboardCopy:"MenuCore",clipboardCut:"MenuCore",clipboardPaste:"MenuCore",pivotPanel:["ColumnsToolPanel","RowGroupingPanel"],rowGroupPanel:["ColumnsToolPanel","RowGroupingPanel"],valuePanel:"ColumnsToolPanel",columnDrag:"EnterpriseCore",rowDrag:["RowDrag","DragAndDrop"],csvExport:"MenuCore",excelExport:"MenuCore",smallDown:"CommunityCore",selectOpen:"CommunityCore",richSelectOpen:"RichSelect",richSelectRemove:"RichSelect",smallLeft:"CommunityCore",smallRight:"CommunityCore",subMenuOpen:"MenuItem",subMenuOpenRtl:"MenuItem",panelDelimiter:"RowGroupingPanel",panelDelimiterRtl:"RowGroupingPanel",smallUp:"CommunityCore",sortAscending:["MenuCore","Sort"],sortDescending:["MenuCore","Sort"],sortUnSort:["MenuCore","Sort"],advancedFilterBuilder:"AdvancedFilter",advancedFilterBuilderDrag:"AdvancedFilter",advancedFilterBuilderInvalid:"AdvancedFilter",advancedFilterBuilderMoveUp:"AdvancedFilter",advancedFilterBuilderMoveDown:"AdvancedFilter",advancedFilterBuilderAdd:"AdvancedFilter",advancedFilterBuilderRemove:"AdvancedFilter",advancedFilterBuilderSelectOpen:"AdvancedFilter",chartsMenu:"IntegratedCharts",chartsMenuEdit:"IntegratedCharts",chartsMenuAdvancedSettings:"IntegratedCharts",chartsMenuAdd:"IntegratedCharts",chartsColorPicker:"IntegratedCharts",chartsThemePrevious:"IntegratedCharts",chartsThemeNext:"IntegratedCharts",chartsDownload:"IntegratedCharts",checkboxChecked:"CommunityCore",checkboxIndeterminate:"CommunityCore",checkboxUnchecked:"CommunityCore",radioButtonOn:"CommunityCore",radioButtonOff:"CommunityCore",rowPin:"PinnedRow",rowUnpin:"PinnedRow",rowPinBottom:"PinnedRow",rowPinTop:"PinnedRow"},Gj=new Set(["colorPicker","smallUp","checkboxChecked","checkboxIndeterminate","checkboxUnchecked","radioButtonOn","radioButtonOff","smallDown","smallLeft","smallRight"]),zj=class extends F{constructor(){super(...arguments),this.beanName="validation"}wireBeans(e){this.gridOptions=e.gridOptions,JO(Sj)}warnOnInitialPropertyUpdate(e,t){e==="api"&&_j[t]&&I(22,{key:t})}processGridOptions(e){this.processOptions(e,Lq())}validateApiFunction(e,t){return Nj(e,t,this.beans)}missingUserComponent(e,t,i,n){let s=_a[t];s?this.gos.assertModuleRegistered(s,`AG Grid '${e}' component: ${t}`):I(101,{propertyName:e,componentName:t,agGridDefaults:i,jsComps:n})}missingDynamicBean(e){let t=Bj[e];return t?Hn(200,O(b({},this.gos.getModuleErrorParams()),{moduleName:t,reasonOrId:e})):void 0}checkRowEvents(e){Uj.has(e)&&I(10,{eventType:e})}validateIcon(e){if(Gj.has(e)&&I(43,{iconName:e}),Hj[e])return;let t=Vj[e];if(t){Ge(200,{reasonOrId:`icon '${e}'`,moduleName:t,gridScoped:Gv(),gridId:this.beans.context.getId(),rowModelType:this.gos.get("rowModelType"),additionalText:"Alternatively, use the CSS icon name directly."});return}I(134,{iconName:e})}isProvidedUserComp(e){return!!_a[e]}validateColDef(e){this.processOptions(e,Rq())}processOptions(e,t){let{validations:i,deprecations:n,allProperties:s,propertyExceptions:o,objectName:r,docsUrl:a}=t;s&&this.gridOptions.suppressPropertyNamesCheck!==!0&&this.checkProperties(e,[...o??[],...Object.keys(n)],s,r,a);let l=new Set;if(Object.keys(e).forEach(c=>{let u=n[c];if(u){let{message:v,version:w}=u;l.add(`As of v${w}, ${String(c)} is deprecated. ${v??""}`)}let h=e[c];if(h==null||h===!1)return;let p=i[c];if(!p)return;let{dependencies:g,validate:f,supportedRowModels:m,expectedType:C}=p;if(C){let v=typeof h;if(v!==C){l.add(`${String(c)} should be of type '${C}' but received '${v}' (${h}).`);return}}if(m){let v=this.gridOptions.rowModelType??"clientSide";if(!m.includes(v)){l.add(`${String(c)} is not supported with the '${v}' row model. It is only valid with: ${m.join(", ")}.`);return}}if(g){let v=this.checkForRequiredDependencies(c,g,e);if(v){l.add(v);return}}if(f){let v=f(e,this.gridOptions,this.beans);if(v){l.add(v);return}}}),l.size>0)for(let c of l)xd(c)}checkForRequiredDependencies(e,t,i){let s=Object.entries(t).filter(([o,r])=>{let a=i[o];return!r.required.includes(a)});return s.length===0?null:s.map(([o,r])=>`'${String(e)}' requires '${o}' to be one of [${r.required.map(a=>a===null?"null":a===void 0?"undefined":a).join(", ")}]. ${r.reason??""}`).join(`
           `)}checkProperties(e,t,i,n,s){let o=["__ob__","__v_skip","__metadata__"],r=Wj(Object.getOwnPropertyNames(e),[...o,...t,...i],i),a=Object.keys(r);for(let l of a){let d=r[l],c=`invalid ${n} property '${l}' did you mean any of these: ${d.slice(0,8).join(", ")}.`;i.includes("context")&&(c+=`
If you are trying to annotate ${n} with application data, use the '${n}.context' property instead.`),xd(c)}if(a.length>0&&s){let l=this.beans.frameworkOverrides.getDocLink(s);xd(`to see all the valid ${n} properties please check: ${l}`)}}};function Wj(e,t,i){let n={},s=e.filter(o=>!t.some(r=>r===o));if(s.length>0)for(let o of s)n[o]=cv({inputValue:o,allSuggestions:i}).values;return n}var Uj=new Set(["firstChildChanged","lastChildChanged","childIndexChanged"]),qj={moduleName:"Validation",version:q,beans:[zj]};function dD(e){let t=e.sibling;t&&(t.childrenAfterFilter=e.childrenAfterFilter)}var $j=class extends F{constructor(){super(...arguments),this.beanName="filterStage",this.step="filter",this.refreshProps=["excludeChildrenWhenTreeDataFiltering"]}wireBeans(e){this.filterManager=e.filterManager}execute(e){let{changedPath:t}=e;this.filter(t)}filter(e){let t=!!this.filterManager?.isChildFilterPresent();this.filterNodes(t,e)}filterNodes(e,t){let i=(n,s)=>{n.hasChildren()&&e&&!s?n.childrenAfterFilter=n.childrenAfterGroup.filter(o=>{let r=o.childrenAfterFilter&&o.childrenAfterFilter.length>0,a=o.data&&this.filterManager.doesRowPassFilter({rowNode:o});return r||a}):n.childrenAfterFilter=n.childrenAfterGroup,dD(n)};if(this.doingTreeDataFiltering()){let n=(o,r)=>{if(o.childrenAfterGroup)for(let a=0;a<o.childrenAfterGroup.length;a++){let l=o.childrenAfterGroup[a],d=r||this.filterManager.doesRowPassFilter({rowNode:l});l.childrenAfterGroup?n(o.childrenAfterGroup[a],d):i(l,d)}i(o,r)},s=o=>n(o,!1);t.executeFromRootNode(s)}else{let n=s=>i(s,!1);t.forEachChangedNodeDepthFirst(n,!0)}}doingTreeDataFiltering(){return this.gos.get("treeData")&&!this.gos.get("excludeChildrenWhenTreeDataFiltering")}},jj=class extends dw{constructor(){super(...arguments),this.iconCreated=!1}wireComp(e,t,i,n,s){this.comp=e;let o=Ud(this,this.beans.context,s);this.eButtonShowMainFilter=i,this.eFloatingFilterBody=n,this.setGui(t,o),this.setupActive(),this.refreshHeaderStyles(),this.setupWidth(o),this.setupLeft(o),this.setupHover(o),this.setupFocus(o),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(o),this.setupUi(),o.addManagedElementListeners(this.eButtonShowMainFilter,{click:this.showParentFilter.bind(this)}),this.setupFilterChangedListener(o);let r=()=>this.onColDefChanged(o);o.addManagedListeners(this.column,{colDefChanged:r}),o.addManagedEventListeners({filterSwitched:({column:a})=>{a===this.column&&r()}}),o.addDestroyFunc(()=>{this.eButtonShowMainFilter=null,this.eFloatingFilterBody=null,this.userCompDetails=null,this.clearComponent()})}resizeHeader(){}moveHeader(){}getHeaderClassParams(){let{column:e,beans:t}=this,i=e.colDef;return ae(t.gos,{colDef:i,column:e,floatingFilter:!0})}setupActive(){let e=this.column.getColDef(),t=!!e.filter,i=!!e.floatingFilter;this.active=t&&i}setupUi(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),!this.active||this.iconCreated)return;let e=ji("filter",this.beans,this.column);e&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(e))}setupFocus(e){e.createManagedBean(new qa(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}setupAria(){let e=this.getLocaleTextFunc();Na(this.eButtonShowMainFilter,e("ariaFilterMenuOpen","Open Filter Menu"))}onTabKeyDown(e){let{beans:t}=this;if(ot(t)===this.eGui)return;let s=pr(t,this.eGui,null,e.shiftKey);if(s){t.headerNavigation?.scrollToColumn(this.column),e.preventDefault(),s.focus();return}let o=this.findNextColumnWithFloatingFilter(e.shiftKey);o&&t.focusSvc.focusHeaderPosition({headerPosition:{headerRowIndex:this.rowCtrl.rowIndex,column:o},event:e})&&e.preventDefault()}findNextColumnWithFloatingFilter(e){let t=this.beans.visibleCols,i=this.column;do if(i=e?t.getColBefore(i):t.getColAfter(i),!i)break;while(!i.getColDef().filter||!i.getColDef().floatingFilter);return i}handleKeyDown(e){super.handleKeyDown(e);let t=this.getWrapperHasFocus();switch(e.key){case k.UP:case k.DOWN:case k.LEFT:case k.RIGHT:if(t)return;dr(e);case k.ENTER:t&&lr(this.eGui)&&e.preventDefault();break;case k.ESCAPE:t||this.eGui.focus()}}onFocusIn(e){if(this.eGui.contains(e.relatedTarget))return;let i=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),n=!!e.relatedTarget&&er(e.relatedTarget,"ag-floating-filter");if(i&&n&&e.target===this.eGui){let s=this.lastFocusEvent,o=!!(s&&s.key===k.TAB);if(s&&o){let r=s.shiftKey;lr(this.eGui,r)}}this.focusThis()}setupHover(e){this.beans.colHover?.addHeaderFilterColumnHoverListener(e,this.comp,this.column,this.eGui)}setupLeft(e){let t=new lw(this.column,this.eGui,this.beans);e.createManagedBean(t)}setupFilterButton(){this.suppressFilterButton=!this.beans.menuSvc?.isFloatingFilterButtonEnabled(this.column),this.highlightFilterButtonWhenActive=!Ti(this.gos)}setupUserComp(){if(!this.active)return;let e=this.beans.colFilter?.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter());e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setCompDetails(e)}showParentFilter(){let e=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.beans.menuSvc?.showFilterMenu({column:this.column,buttonElement:e,containerType:"floatingFilter",positionBy:"button"})}setupSyncWithFilter(e){if(!this.active)return;let{beans:{colFilter:t},column:i,gos:n}=this,s=o=>{if(o?.source==="filterDestroyed"&&(!this.isAlive()||!t?.isAlive()))return;let r=this.comp.getFloatingFilterComp();r&&r.then(a=>{if(a){if(n.get("enableFilterHandlers")){let c=o,u="filter";c?.afterFloatingFilter?u="ui":c?.afterDataChange?u="dataChanged":o?.source==="api"&&(u="api"),this.updateFloatingFilterParams(this.userCompDetails,u);return}let l=t?.getCurrentFloatingFilterParentModel(i),d=o?O(b({},o),{columns:o.columns??[],source:o.source==="api"?"api":"columnFilter"}):null;a.onParentModelChanged(l,d)}})};[this.destroySyncListener]=e.addManagedListeners(i,{filterChanged:s}),t?.isFilterActive(i)&&s(null)}setupWidth(e){let t=()=>{let i=`${this.column.getActualWidth()}px`;this.comp.setWidth(i)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupFilterChangedListener(e){this.active&&([this.destroyFilterChangedListener]=e.addManagedListeners(this.column,{filterChanged:this.updateFilterButton.bind(this)}),this.updateFilterButton())}updateFilterButton(){if(!this.suppressFilterButton&&this.comp){let e=!!this.beans.filterManager?.isFilterAllowed(this.column);this.comp.setButtonWrapperDisplayed(e),this.highlightFilterButtonWhenActive&&e&&this.eButtonShowMainFilter.classList.toggle("ag-filter-active",this.column.isFilterActive())}}onColDefChanged(e){let t=this.active;this.setupActive();let i=!t&&this.active;t&&!this.active&&(this.destroySyncListener(),this.destroyFilterChangedListener());let n=this.beans.colFilter,s=this.active?n?.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter()):null,o=this.comp.getFloatingFilterComp();!o||!s?this.updateCompDetails(e,s,i):o.then(r=>{!r||n?.areFilterCompsDifferent(this.userCompDetails??null,s)?this.updateCompDetails(e,s,i):this.updateFloatingFilterParams(s,"colDef")})}updateCompDetails(e,t,i){this.isAlive()&&(this.setCompDetails(t),this.setupFilterButton(),this.setupUi(),i&&(this.setupSyncWithFilter(e),this.setupFilterChangedListener(e)))}updateFloatingFilterParams(e,t){if(!e)return;let i=e.params;this.comp.getFloatingFilterComp()?.then(n=>{typeof n?.refresh=="function"&&(this.gos.get("enableFilterHandlers")&&(i=O(b({},i),{model:Bt(this.beans.colFilter?.model??{},this.column.getColId()),source:t})),n.refresh(i))})}addResizeAndMoveKeyboardListeners(){}destroy(){super.destroy(),this.destroySyncListener=null,this.destroyFilterChangedListener=null}};function Kj(e,t){let i=e.colModel.getCol(t);if(!i){Ge(12,{colKey:t});return}e.menuSvc?.showColumnMenu({column:i,positionBy:"auto"})}function Yj(e){e.menuSvc?.hidePopupMenu()}var Xj={moduleName:"SharedMenu",version:q,beans:[cG],apiFunctions:{showColumnMenu:Kj,hidePopupMenu:Yj}},Jj=class extends TH{postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridCtrl=e.gridCtrl}),this.addManagedEventListeners({gridStylesChanged:this.handleThemeChange.bind(this)})}getDefaultPopupParent(){return this.gridCtrl.getGui()}positionPopupForMenu(e){let{eventSource:t,ePopup:i,event:n}=e,s=t.getBoundingClientRect(),o=this.getParentRect();this.setAlignedTo(t,i);let r=!1,a=()=>{let l=this.keepXYWithinBounds(i,s.top-o.top,0),d=i.clientWidth>0?i.clientWidth:200;r||(i.style.minWidth=`${d}px`,r=!0);let u=o.right-o.left-d,h;return this.gos.get("enableRtl")?(h=g(),h<0&&(h=p(),this.setAlignedStyles(i,"left")),h>u&&(h=0,this.setAlignedStyles(i,"right"))):(h=p(),h>u&&(h=g(),this.setAlignedStyles(i,"right")),h<0&&(h=0,this.setAlignedStyles(i,"left"))),{x:h,y:l};function p(){return s.right-o.left-2}function g(){return s.left-o.left-d}};this.positionPopup({ePopup:i,keepWithinBounds:!0,updatePosition:a,postProcessCallback:()=>this.callPostProcessPopup(e,"subMenu",i,t,n instanceof MouseEvent?n:void 0)})}callPostProcessPopup(e,t,i,n,s){let o=this.gos.getCallback("postProcessPopup");if(o){let{column:r,rowNode:a}=e;o({column:r,rowNode:a,ePopup:i,type:t,eventSource:n,mouseEvent:s})}}getActivePopups(){return this.popupList.map(e=>e.element)}handleThemeChange(e){if(e.themeChanged){let t=this.beans.environment;for(let i of this.popupList)t.applyThemeClasses(i.wrapper)}}hasAnchoredPopup(){return this.popupList.some(e=>e.isAnchored)}isStopPropagation(e){return Ms(e)}},ag={moduleName:"Popup",version:q,beans:[Jj]},Qj=".ag-set-filter{--ag-indentation-level:0}.ag-set-filter-item{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-set-filter-item{padding-left:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}:where(.ag-rtl) .ag-set-filter-item{padding-right:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}.ag-set-filter-item-checkbox{display:flex;height:100%;width:100%}.ag-set-filter-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr) .ag-set-filter-group-icons{margin-right:var(--ag-widget-container-horizontal-padding)}:where(.ag-rtl) .ag-set-filter-group-icons{margin-left:var(--ag-widget-container-horizontal-padding)}.ag-filter-body-wrapper{display:flex;flex-direction:column}:where(.ag-menu:not(.ag-tabs) .ag-filter) .ag-filter-body-wrapper,:where(.ag-menu:not(.ag-tabs) .ag-filter)>:not(.ag-filter-wrapper){min-width:180px}.ag-filter-filter{flex:1 1 0px}.ag-filter-condition{display:flex;justify-content:center}.ag-floating-filter-body{display:flex;flex:1 1 auto;height:100%;position:relative}.ag-floating-filter-full-body{align-items:center;display:flex;flex:1 1 auto;height:100%;overflow:hidden;width:100%}:where(.ag-floating-filter-full-body)>div{flex:1 1 auto}.ag-floating-filter-input{align-items:center;display:flex;width:100%;>*{flex:1 1 auto}:where(.ag-input-field-input[type=date]),:where(.ag-input-field-input[type=datetime-local]){width:1px}}.ag-floating-filter-button{display:flex;flex:none}.ag-date-floating-filter-wrapper{display:flex}.ag-set-floating-filter-input :where(input)[disabled]{pointer-events:none}.ag-floating-filter-button-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:none;height:var(--ag-icon-size);width:var(--ag-icon-size)}.ag-filter-loading{align-items:unset;background-color:var(--ag-chrome-background-color);height:100%;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);position:absolute;width:100%;z-index:1;:where(.ag-menu) &{background-color:var(--ag-menu-background-color)}}.ag-filter-separator{border-top:solid var(--ag-border-width) var(--menu-separator-color)}:where(.ag-filter-select) .ag-picker-field-wrapper{width:0}.ag-filter-condition-operator{height:17px}:where(.ag-ltr) .ag-filter-condition-operator-or{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-condition-operator-or{margin-right:calc(var(--ag-spacing)*2)}.ag-set-filter-select-all{padding-top:var(--ag-widget-container-vertical-padding)}.ag-filter-no-matches,.ag-set-filter-list{height:calc(var(--ag-list-item-height)*6)}.ag-filter-no-matches{padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}.ag-set-filter-tree-list{height:calc(var(--ag-list-item-height)*10)}.ag-set-filter-filter{margin-left:var(--ag-widget-container-horizontal-padding);margin-right:var(--ag-widget-container-horizontal-padding);margin-top:var(--ag-widget-container-vertical-padding)}.ag-filter-to{margin-top:var(--ag-widget-vertical-spacing)}.ag-mini-filter{margin:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}:where(.ag-ltr) .ag-set-filter-add-group-indent{margin-left:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-rtl) .ag-set-filter-add-group-indent{margin-right:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-filter-menu) .ag-set-filter-list{min-width:200px}.ag-filter-virtual-list-item:focus-visible{box-shadow:inset var(--ag-focus-shadow)}.ag-filter-apply-panel{display:flex;justify-content:flex-end;overflow:hidden;padding:var(--ag-widget-vertical-spacing) var(--ag-widget-container-horizontal-padding) var(--ag-widget-container-vertical-padding)}.ag-filter-apply-panel-button{line-height:1.5}:where(.ag-ltr) .ag-filter-apply-panel-button{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-apply-panel-button{margin-right:calc(var(--ag-spacing)*2)}.ag-simple-filter-body-wrapper{display:flex;flex-direction:column;min-height:calc(var(--ag-list-item-height) + var(--ag-widget-container-vertical-padding) + var(--ag-widget-vertical-spacing));overflow-y:auto;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);padding-bottom:calc(var(--ag-widget-container-vertical-padding) - var(--ag-widget-vertical-spacing));&>*{margin-bottom:var(--ag-widget-vertical-spacing)}:where(.ag-resizer-wrapper){margin:0}}.ag-multi-filter-menu-item{margin:var(--ag-spacing) 0}.ag-multi-filter-group-title-bar{background-color:transparent;color:var(--ag-header-text-color);font-weight:500;padding:calc(var(--ag-spacing)*1.5) var(--ag-spacing)}.ag-group-filter-field-select-wrapper{display:flex;flex-direction:column;gap:var(--ag-widget-vertical-spacing);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}";function Zj(e){let t=e.filterManager;return!!t?.isColumnFilterPresent()||!!t?.isAggregateFilterPresent()}function eK(e,t){return e.filterManager?.getColumnFilterInstance(t)??Promise.resolve(void 0)}function tK(e,t){let i=e.colModel.getColDefCol(t);if(i)return e.colFilter?.destroyFilter(i,"api")}function iK(e,t){e.frameworkOverrides.wrapIncoming(()=>e.filterManager?.setFilterModel(t))}function nK(e){return e.filterManager?.getFilterModel()??{}}function sK(e,t,i){let{gos:n,colModel:s,colFilter:o}=e;i&&!n.get("enableFilterHandlers")&&(I(288),i=!1);let r=s.getColDefCol(t);return r?o?.getModelForColumn(r,i)??null:null}function oK(e,t,i){return e.filterManager?.setColumnFilterModel(t,i)??Promise.resolve()}function rK(e,t){let i=e.colModel.getCol(t);if(!i){Ge(12,{colKey:t});return}e.menuSvc?.showFilterMenu({column:i,containerType:"columnFilter",positionBy:"auto"})}function aK(e){e.menuSvc?.hideFilterMenu()}function lK(e,t){let i=e.colModel.getCol(t);if(!i){Ge(12,{colKey:t});return}return e.colFilter?.getHandler(i,!0)}function dK(e,t){let{colModel:i,colFilter:n,gos:s}=e;if(!s.get("enableFilterHandlers")){I(287);return}let{colId:o,action:r}=t;if(o){let a=i.getColById(o);a&&n?.updateModel(a,r)}else n?.updateAllModels(r)}var cK={filterHandler:()=>({doesFilterPass:()=>!0})},uK=class extends F{constructor(){super(...arguments),this.beanName="colFilter",this.allColumnFilters=new Map,this.allColumnListeners=new Map,this.activeAggregateFilters=[],this.activeColumnFilters=[],this.processingFilterChange=!1,this.modelUpdates=[],this.columnModelUpdates=[],this.state=new Map,this.handlerMap=b({},eM),this.isGlobalButtons=!1,this.activeFilterComps=new Set}postConstruct(){this.addManagedEventListeners({gridColumnsChanged:this.onColumnsChanged.bind(this),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)});let e=this.gos,t=b({},e.get("initialState")?.filter?.filterModel??{});this.initialModel=t,this.model=b({},t),e.get("enableFilterHandlers")||delete this.handlerMap.agMultiColumnFilter}refreshModel(){this.onNewRowsLoaded("rowDataUpdated")}setModel(e,t="api",i){let{colModel:n,dataTypeSvc:s,filterManager:o}=this.beans;if(s?.isPendingInference){this.modelUpdates.push({model:e,source:t});return}let r=[],a=this.getModel(!0);if(e){let l=new Set(Object.keys(e));this.allColumnFilters.forEach((d,c)=>{let u=e[c];r.push(this.setModelOnFilterWrapper(d,u)),l.delete(c)}),l.forEach(d=>{let c=n.getColDefCol(d)||n.getCol(d);if(!c){I(62,{colId:d});return}if(!c.isFilterAllowed()){I(63,{colId:d});return}let u=this.getOrCreateFilterWrapper(c,!0);if(!u){I(64,{colId:d});return}r.push(this.setModelOnFilterWrapper(u,e[d],!0))})}else this.model={},this.allColumnFilters.forEach(l=>{r.push(this.setModelOnFilterWrapper(l,null))});lt.all(r).then(()=>{let l=this.getModel(!0),d=[];this.allColumnFilters.forEach((c,u)=>{let h=a?a[u]:null,p=l?l[u]:null;Pd(h,p)||d.push(c.column)}),d.length>0?o?.onFilterChanged({columns:d,source:t}):i&&this.updateActive("filterChanged")})}getModel(e){let t={},{allColumnFilters:i,initialModel:n,beans:{colModel:s}}=this;if(i.forEach((o,r)=>{let a=this.getModelFromFilterWrapper(o);K(a)&&(t[r]=a)}),!e)for(let o of Object.keys(n)){let r=n[o];K(r)&&!i.has(o)&&s.getCol(o)?.isFilterAllowed()&&(t[o]=r)}return t}setState(e,t,i="api"){if(this.state.clear(),t)for(let n of Object.keys(t)){let s=t[n];this.state.set(n,{model:Bt(this.model,n),state:s})}this.setModel(e,i,!0)}getState(){let e=this.state;if(!e.size)return;let t={},i=!1;return e.forEach((n,s)=>{let o=n.state;o!=null&&(i=!0,t[s]=o)}),i?t:void 0}getModelFromFilterWrapper(e){let i=e.column.getColId();if(e.isHandler)return Bt(this.model,i);let n=e.filter;return n?typeof n.getModel!="function"?(I(66),null):n.getModel():Bt(this.initialModel,i)}isFilterPresent(){return this.activeColumnFilters.length>0}isAggFilterPresent(){return!!this.activeAggregateFilters.length}disableFilters(){this.initialModel={};let{allColumnFilters:e}=this;return e.size?(e.forEach(t=>this.disposeFilterWrapper(t,"advancedFilterEnabled")),!0):!1}updateActiveFilters(){let e=d=>d?d.isFilterActive?d.isFilterActive():(I(67),!1):!1,{colModel:t,gos:i}=this.beans,n=!!nv(i),s=d=>{if(!d.isPrimary())return!0;let u=!t.isPivotActive();return!d.isValueActive()||!u?!1:t.isPivotMode()?!0:n},o=[],r=[],a=(d,c,u)=>{c&&(s(d)?o.push(u):r.push(u))},l=[];return this.allColumnFilters.forEach(d=>{let c=d.column,u=c.getColId();if(d.isHandler)l.push(lt.resolve().then(()=>{a(c,this.isHandlerActive(c),{colId:u,isHandler:!0,handler:d.handler,handlerParams:d.handlerParams})}));else{let h=Zs(d);h&&l.push(h.then(p=>{a(c,e(p),{colId:u,isHandler:!1,comp:p})}))}}),lt.all(l).then(()=>{this.activeAggregateFilters=o,this.activeColumnFilters=r})}updateFilterFlagInColumns(e,t){let i=[];return this.allColumnFilters.forEach(n=>{let s=n.column;if(n.isHandler)i.push(lt.resolve().then(()=>{this.setColFilterActive(s,this.isHandlerActive(s),e,t)}));else{let o=Zs(n);o&&i.push(o.then(r=>{this.setColFilterActive(s,r.isFilterActive(),e,t)}))}}),this.beans.groupFilter?.updateFilterFlags(e,t),lt.all(i)}doFiltersPass(e,t,i){let{data:n,aggData:s}=e,o=i?this.activeAggregateFilters:this.activeColumnFilters,r=i?s:n,a=this.model;for(let l=0;l<o.length;l++){let d=o[l],{colId:c,isHandler:u}=d;if(c!==t)if(u){let{handler:h,handlerParams:p}=d;if(!h.doesFilterPass({node:e,data:r,model:Bt(a,c),handlerParams:p}))return!1}else{let h=d.comp;if(typeof h.doesFilterPass!="function"){Ge(91);continue}if(!h.doesFilterPass({node:e,data:r}))return!1}}return!0}getHandlerParams(e){let t=this.allColumnFilters.get(e.getColId());return t?.isHandler?t.handlerParams:void 0}callOnFilterChangedOutsideRenderCycle(e){let{rowRenderer:t,filterManager:i}=this.beans,n=()=>{this.isAlive()&&i?.onFilterChanged(e)};t.isRefreshInProgress()?setTimeout(n,0):n()}updateBeforeFilterChanged(e={}){let{column:t,additionalEventAttributes:i}=e,n=t?.getColId();return this.updateActiveFilters().then(()=>this.updateFilterFlagInColumns("filterChanged",i).then(()=>{this.allColumnFilters.forEach(s=>{let{column:o,isHandler:r}=s;n!==o.getColId()&&(r&&s.handler.onAnyFilterChanged?.(),Zs(s,r)?.then(a=>{typeof a?.onAnyFilterChanged=="function"&&a.onAnyFilterChanged()}))}),this.processingFilterChange=!0}))}updateAfterFilterChanged(){this.processingFilterChange=!1}isSuppressFlashingCellsBecauseFiltering(){return!(this.gos.get("allowShowChangeAfterFilter")??!1)&&this.processingFilterChange}onNewRowsLoaded(e){let t=[];this.allColumnFilters.forEach(i=>{let n=i.isHandler;n&&i.handler.onNewRowsLoaded?.();let s=Zs(i,n);s&&t.push(s.then(o=>{o.onNewRowsLoaded?.()}))}),lt.all(t).then(()=>this.updateActive(e,{afterDataChange:!0}))}updateActive(e,t){this.updateFilterFlagInColumns(e,t).then(()=>this.updateActiveFilters())}createGetValue(e,t){let{filterValueSvc:i,colModel:n}=this.beans;return(s,o)=>{let r=o?n.getCol(o):e;return r?i.getValue(r,s,t):void 0}}isFilterActive(e){let t=this.cachedFilter(e);if(t?.isHandler)return this.isHandlerActive(e);let i=t?.filter;return i?i.isFilterActive():Bt(this.initialModel,e.getColId())!=null}isHandlerActive(e){let t=K(Bt(this.model,e.getColId()));if(t)return t;let i=this.beans.groupFilter;return i?.isGroupFilter(e)?i.isFilterActive(e):!1}getOrCreateFilterUi(e){let t=this.getOrCreateFilterWrapper(e,!0);return t?Zs(t):null}getFilterUiForDisplay(e){let t=this.getOrCreateFilterWrapper(e,!0);if(!t)return null;let i=Zs(t);return i?i.then(n=>({comp:n,params:t.filterUi.filterParams,isHandler:t.isHandler})):null}getHandler(e,t){let i=this.getOrCreateFilterWrapper(e,t);return i?.isHandler?i.handler:void 0}getOrCreateFilterWrapper(e,t){if(!e.isFilterAllowed())return;let i=this.cachedFilter(e);return!i&&t&&(i=this.createFilterWrapper(e),this.setColumnFilterWrapper(e,i)),i}cachedFilter(e){return this.allColumnFilters.get(e.getColId())}getDefaultFilter(e,t=!1){return this.getDefaultFilterFromDataType(()=>this.beans.dataTypeSvc?.getBaseDataType(e),t)}getDefaultFilterFromDataType(e,t=!1){return pN(this.gos)?t?"agSetColumnFloatingFilter":"agSetColumnFilter":tV(e(),t)}getDefaultFloatingFilter(e){return this.getDefaultFilter(e,!0)}createFilterComp(e,t,i,n,s,o){let r=()=>{let d=this.createFilterCompParams(e,s,o),c=n(d,s);return mB(this.beans.userCompFactory,t,c,i)},a=r();return a?{compDetails:a,createFilterUi:d=>(d?r():a).newAgStackInstance()}:null}createFilterInstance(e,t,i,n){let s=this.beans.selectableFilter;s?.isSelectable(t)&&(t=s.getFilterDef(e,t));let{handler:o,handlerParams:r,handlerGenerator:a}=this.createHandler(e,t,i)??{},l=this.createFilterComp(e,t,i,n,!!o,"init");if(!l)return{compDetails:null,createFilterUi:null,handler:o,handlerGenerator:a,handlerParams:r};let{compDetails:d,createFilterUi:c}=l;return this.isGlobalButtons&&(d.params?.buttons?.length||I(281,{colId:e.getColId()})),{compDetails:d,handler:o,handlerGenerator:a,handlerParams:r,createFilterUi:c}}createBaseFilterParams(e,t){let{filterManager:i,rowModel:n}=this.beans;return ae(this.gos,{column:e,colDef:e.getColDef(),getValue:this.createGetValue(e),doesRowPassOtherFilter:t?()=>!0:s=>i?.doesRowPassOtherFilters(e.getColId(),s)??!0,rowModel:n})}createFilterCompParams(e,t,i,n){let s=this.filterChangedCallbackFactory(e),o=this.createBaseFilterParams(e,n);if(o.filterChangedCallback=s,o.filterModifiedCallback=n?()=>{}:r=>this.filterModified(e,r),t){let r=o,a=e.getColId(),l=Bt(this.model,a);r.model=l,r.state=this.state.get(a)??{model:l},r.onModelChange=(d,c)=>{this.updateStoredModel(a,d),this.refreshHandlerAndUi(e,d,"ui",!1,c).then(()=>{s(O(b({},c),{source:"columnFilter"}))})},r.onStateChange=d=>{this.updateState(e,d),this.updateOrRefreshFilterUi(e)},r.onAction=(d,c,u)=>{this.updateModel(e,d,c),this.dispatchLocalEvent({type:"filterAction",column:e,action:d,event:u})},r.getHandler=()=>this.getHandler(e,!0),r.onUiChange=d=>this.filterUiChanged(e,d),r.source=i}return o}createFilterUiForHandler(e,t){return t?{created:!1,create:t,filterParams:e.params,compDetails:e}:null}createFilterUiLegacy(e,t,i){let n=t(),s={created:!0,create:t,filterParams:e.params,compDetails:e,promise:n};return n.then(i),s}createFilterWrapper(e){let{compDetails:t,handler:i,handlerGenerator:n,handlerParams:s,createFilterUi:o}=this.createFilterInstance(e,e.getColDef(),this.getDefaultFilter(e),a=>a),r=e.getColId();if(i)return delete this.initialModel[r],i.init?.(O(b({},s),{source:"init",model:Bt(this.model,r)})),{column:e,isHandler:!0,handler:i,handlerGenerator:n,handlerParams:s,filterUi:this.createFilterUiForHandler(t,o)};if(o){let a={column:e,filterUi:null,isHandler:!1};return a.filterUi=this.createFilterUiLegacy(t,o,l=>{a.filter=l??void 0}),a}return{column:e,filterUi:null,isHandler:!1}}createHandlerFunc(e,t,i){let{gos:n,frameworkOverrides:s,registry:o}=this.beans,r,a=p=>{let g=p.filter;if(P4(g)){let f=g.handler;return f||(r=g.doesFilterPass,r?()=>({doesFilterPass:r}):void 0)}return typeof g=="string"?g:void 0},l=n.get("enableFilterHandlers"),d=l?a(t):void 0,c=p=>()=>this.createBean(o.createDynamicBean(p,!0)),u,h;if(typeof d=="string"){let p=n.get("filterHandlers")?.[d];p!=null?u=p:WH.has(d)&&(u=c(d),h=d)}else u=d;if(!u){let p,{compName:g,jsComp:f,fwComp:m}=A4(s,t);g?p=g:f==null&&m==null&&t.filter===!0&&(p=i),h=this.handlerMap[p],h&&(u=c(h))}return u?{filterHandler:u,handlerNameOrCallback:r??h}:l?(wt(n)&&I(277,{colId:e.getColId()}),cK):void 0}createHandler(e,t,i){let n=this.createHandlerFunc(e,t,i);if(!n)return;let s=wC(this.beans.userCompFactory,t,this.createFilterCompParams(e,!0,"init")),{handlerNameOrCallback:o,filterHandler:r}=n,{handler:a,handlerParams:l}=this.createHandlerFromFunc(e,r,s);return{handler:a,handlerParams:l,handlerGenerator:o??r}}createHandlerFromFunc(e,t,i){let n=e.getColDef(),s=t(ae(this.gos,{column:e,colDef:n})),o=this.createHandlerParams(e,i);return{handler:s,handlerParams:o}}createHandlerParams(e,t){let i=e.getColDef(),n=e.getColId(),s=this.filterChangedCallbackFactory(e);return ae(this.gos,{colDef:i,column:e,getValue:this.createGetValue(e),doesRowPassOtherFilter:o=>this.beans.filterManager?.doesRowPassOtherFilters(n,o)??!0,onModelChange:(o,r)=>{this.updateStoredModel(n,o),this.refreshHandlerAndUi(e,o,"handler",!1,r).then(()=>{s(O(b({},r),{source:"columnFilter"}))})},filterParams:t})}onColumnsChanged(){let e=[],{colModel:t,filterManager:i,groupFilter:n}=this.beans;this.allColumnFilters.forEach((o,r)=>{let a;o.column.isPrimary()?a=t.getColDefCol(r):a=t.getCol(r),!(a&&a===o.column)&&(e.push(o.column),this.disposeFilterWrapper(o,"columnChanged"),this.disposeColumnListener(r))});let s=n&&e.every(o=>n.isGroupFilter(o));e.length>0&&!s&&i?.onFilterChanged({columns:e,source:"api"})}isFilterAllowed(e){if(!e.isFilterAllowed())return!1;let i=this.beans.groupFilter;return i?.isGroupFilter(e)?i.isFilterAllowed(e):!0}getFloatingFilterCompDetails(e,t){let{userCompFactory:i,frameworkOverrides:n,selectableFilter:s}=this.beans,o=h=>{let p=this.getOrCreateFilterUi(e);p?.then(g=>{h(Nd(g))})},r=e.getColDef(),a=s?.isSelectable(r)?s.getFilterDef(e,r):r,l=rV(n,a,()=>this.getDefaultFloatingFilter(e))??"agReadOnlyFloatingFilter",d=this.gos.get("enableFilterHandlers"),c=wC(i,a,this.createFilterCompParams(e,d,"init",!0)),u=ae(this.gos,{column:e,filterParams:c,currentParentModel:()=>this.getCurrentFloatingFilterParentModel(e),parentFilterInstance:o,showParentFilter:t});if(d){let h=u,p=e.getColId(),g=this.filterChangedCallbackFactory(e);h.onUiChange=f=>this.floatingFilterUiChanged(e,f),h.model=Bt(this.model,p),h.onModelChange=(f,m)=>{this.updateStoredModel(p,f),this.refreshHandlerAndUi(e,f,"floating",!0,m).then(()=>{g(O(b({},m),{source:"columnFilter"}))})},h.getHandler=()=>this.getHandler(e,!0),h.source="init"}return yB(i,r,u,l)}getCurrentFloatingFilterParentModel(e){return this.getModelFromFilterWrapper(this.cachedFilter(e)??{column:e})}destroyFilterUi(e,t,i,n){let s="paramsUpdated";if(e.isHandler){let o=t.getColId();delete this.initialModel[o],this.state.delete(o);let r=e.filterUi,a=this.createFilterUiForHandler(i,n);e.filterUi=a;let l=this.eventSvc;r?.created?r.promise.then(d=>{this.destroyBean(d),l.dispatchEvent({type:"filterDestroyed",source:s,column:t})}):l.dispatchEvent({type:"filterHandlerDestroyed",source:s,column:t})}else this.destroyFilter(t,s)}destroyFilter(e,t="api"){let i=e.getColId(),n=this.allColumnFilters.get(i);this.disposeColumnListener(i),delete this.initialModel[i],n&&this.disposeFilterWrapper(n,t).then(s=>{s&&this.isAlive()&&this.beans.filterManager?.onFilterChanged({columns:[e],source:"api"})})}disposeColumnListener(e){let t=this.allColumnListeners.get(e);t&&(this.allColumnListeners.delete(e),t())}disposeFilterWrapper(e,t){let i=!1,{column:n,isHandler:s,filterUi:o}=e,r=n.getColId();s&&(i=this.isHandlerActive(n),this.destroyBean(e.handler),delete this.model[r],this.state.delete(r));let a=()=>{this.setColFilterActive(n,!1,"filterDestroyed"),this.allColumnFilters.delete(r),this.eventSvc.dispatchEvent({type:"filterDestroyed",source:t,column:n})};if(o){if(o.created)return o.promise.then(l=>(i=s?i:!!l?.isFilterActive(),this.destroyBean(l),a(),i));a()}return lt.resolve(i)}filterChangedCallbackFactory(e){return t=>{this.callOnFilterChangedOutsideRenderCycle({additionalEventAttributes:t,columns:[e],column:e,source:t?.source??"columnFilter"})}}filterParamsChanged(e,t="api"){let i=this.allColumnFilters.get(e);if(!i)return;let n=this.beans,s=i.column,o=s.getColDef(),r=s.isFilterAllowed(),a=this.getDefaultFilter(s),l=n.selectableFilter,d=l?.isSelectable(o)?l.getFilterDef(s,o):o,c=r?this.createHandlerFunc(s,d,this.getDefaultFilter(s)):void 0,u=!!c,h=i.isHandler;if(h!=u){this.destroyFilter(s,"paramsUpdated");return}let{compDetails:p,createFilterUi:g}=(r?this.createFilterComp(s,d,a,m=>m,u,"colDef"):null)??{compDetails:null,createFilterUi:null},f=p?.params??wC(n.userCompFactory,d,this.createFilterCompParams(s,u,"colDef"));if(h){let m=c?.handlerNameOrCallback??c?.filterHandler,C=Bt(this.model,e);if(i.handlerGenerator!=m){let v=i.handler,{handler:w,handlerParams:y}=this.createHandlerFromFunc(s,c.filterHandler,f);i.handler=w,i.handlerParams=y,i.handlerGenerator=m,delete this.model[e],w.init?.(O(b({},y),{source:"init",model:null})),this.destroyBean(v),C!=null&&this.beans.filterManager?.onFilterChanged({columns:[s],source:t})}else{let v=this.createHandlerParams(s,p?.params);i.handlerParams=v,i.handler.refresh?.(O(b({},v),{source:"colDef",model:C}))}}if(this.areFilterCompsDifferent(i.filterUi?.compDetails??null,p)||!i.filterUi||!p){this.destroyFilterUi(i,s,p,g);return}i.filterUi.filterParams=f,Zs(i,h)?.then(m=>{(m?.refresh?m.refresh(f):!0)===!1?this.destroyFilterUi(i,s,p,g):this.dispatchLocalEvent({type:"filterParamsChanged",column:s,params:f})})}refreshHandlerAndUi(e,t,i,n,s){let o=this.cachedFilter(e);if(!o)return n&&this.getOrCreateFilterWrapper(e,!0),lt.resolve();if(!o.isHandler)return lt.resolve();let{filterUi:r,handler:a,handlerParams:l}=o;return UH(()=>{if(r){let{created:d,filterParams:c}=r;if(d)return r.promise.then(u=>u?{filter:u,filterParams:c}:void 0);r.refreshed=!0}return lt.resolve(void 0)},a,l,t,this.state.get(e.getColId())??{model:t},i,s)}setColumnFilterWrapper(e,t){let i=e.getColId();this.allColumnFilters.set(i,t),this.allColumnListeners.set(i,this.addManagedListeners(e,{colDefChanged:()=>this.filterParamsChanged(i)})[0])}areFilterCompsDifferent(e,t){if(!t||!e)return!0;let{componentClass:i}=e,{componentClass:n}=t;return!(i===n||i?.render&&n?.render&&i.render===n.render)}hasFloatingFilters(){return this.beans.colModel.getCols().some(t=>t.getColDef().floatingFilter)}getFilterInstance(e){let t=this.beans.colModel.getColDefCol(e);if(!t)return Promise.resolve(void 0);let i=this.getOrCreateFilterUi(t);return i?new Promise(n=>{i.then(s=>{n(Nd(s))})}):Promise.resolve(null)}processFilterModelUpdateQueue(){this.modelUpdates.forEach(({model:e,source:t})=>this.setModel(e,t)),this.modelUpdates=[],this.columnModelUpdates.forEach(({key:e,model:t,resolve:i})=>{this.setModelForColumn(e,t).then(()=>i())}),this.columnModelUpdates=[]}getModelForColumn(e,t){if(t){let{state:n,model:s}=this,o=e.getColId(),r=n.get(o);return r?r.model??null:Bt(s,o)}let i=this.cachedFilter(e);return i?this.getModelFromFilterWrapper(i):null}setModelForColumn(e,t){if(this.beans.dataTypeSvc?.isPendingInference){let i=()=>{},n=new Promise(s=>{i=s});return this.columnModelUpdates.push({key:e,model:t,resolve:i}),n}return new Promise(i=>{this.setModelForColumnLegacy(e,t).then(n=>i(n))})}getStateForColumn(e){return this.state.get(e)??{model:Bt(this.model,e)}}setModelForColumnLegacy(e,t){let i=this.beans.colModel.getColDefCol(e),n=i?this.getOrCreateFilterWrapper(i,!0):null;return n?this.setModelOnFilterWrapper(n,t):lt.resolve()}setColDefPropsForDataType(e,t,i){let n=e.filter,s=n===!0?this.getDefaultFilterFromDataType(()=>t.baseDataType):n;if(typeof s!="string")return;let o,r,a=this.beans,{filterParams:l,filterValueGetter:d}=e;s==="agMultiColumnFilter"?{filterParams:o,filterValueGetter:r}=a.multiFilter?.getParamsForDataType(l,d,t,i)??{}:{filterParams:o,filterValueGetter:r}=QH(s,l,d,t,i,a,this.getLocaleTextFunc()),e.filterParams=o,r&&(e.filterValueGetter=r)}setColFilterActive(e,t,i,n){e.filterActive!==t&&(e.filterActive=t,e.dispatchColEvent("filterActiveChanged",i)),e.dispatchColEvent("filterChanged",i,n)}setModelOnFilterWrapper(e,t,i){return new lt(n=>{if(e.isHandler){let o=e.column,r=o.getColId(),a=this.model[r];if(this.updateStoredModel(r,t),i&&t===a){n();return}this.refreshHandlerAndUi(o,t,"api").then(()=>n());return}let s=Zs(e);if(s){s.then(o=>{if(typeof o?.setModel!="function"){I(65),n();return}(o.setModel(t)||lt.resolve()).then(()=>n())});return}n()})}updateStoredModel(e,t){K(t)?this.model[e]=t:delete this.model[e];let i=this.state.get(e),n={model:t,state:i?.state};this.state.set(e,n)}filterModified(e,t){this.getOrCreateFilterUi(e)?.then(i=>{this.eventSvc.dispatchEvent(b({type:"filterModified",column:e,filterInstance:i},t))})}filterUiChanged(e,t){this.gos.get("enableFilterHandlers")&&this.eventSvc.dispatchEvent(b({type:"filterUiChanged",column:e},t))}floatingFilterUiChanged(e,t){this.gos.get("enableFilterHandlers")&&this.eventSvc.dispatchEvent(b({type:"floatingFilterUiChanged",column:e},t))}updateModel(e,t,i){let n=e.getColId(),s=this.cachedFilter(e),o=()=>s?.filterUi;FR(t,o,()=>Bt(this.model,n),()=>this.state.get(n),r=>this.updateState(e,r),r=>o()?.filterParams?.onModelChange(r,i),s?.isHandler?s.handler.processModelToApply?.bind(s.handler):void 0)}updateAllModels(e,t){let i=[];this.allColumnFilters.forEach((n,s)=>{let o=this.beans.colModel.getColDefCol(s);o&&FR(e,()=>n.filterUi,()=>Bt(this.model,s),()=>this.state.get(s),r=>this.updateState(o,r),r=>{this.updateStoredModel(s,r),this.dispatchLocalEvent({type:"filterAction",column:o,action:e}),i.push(this.refreshHandlerAndUi(o,r,"ui"))},n?.isHandler?n.handler.processModelToApply?.bind(n.handler):void 0)}),i.length&&lt.all(i).then(()=>{this.callOnFilterChangedOutsideRenderCycle({source:"columnFilter",additionalEventAttributes:t,columns:[]})})}updateOrRefreshFilterUi(e){let t=e.getColId();iM(()=>this.cachedFilter(e)?.filterUi,()=>Bt(this.model,t),()=>this.state.get(t))}updateState(e,t){this.state.set(e.getColId(),t),this.dispatchLocalEvent({type:"filterStateChanged",column:e,state:t})}canApplyAll(){let{state:e,model:t,activeFilterComps:i}=this;for(let s of i)if(s.source==="COLUMN_MENU")return!1;let n=!1;for(let s of e.keys()){let o=e.get(s);if(o.valid===!1)return!1;(o.model??null)!==Bt(t,s)&&(n=!0)}return n}hasUnappliedModel(e){let{model:t,state:i}=this;return(i.get(e)?.model??null)!==Bt(t,e)}setGlobalButtons(e){this.isGlobalButtons=e,this.dispatchLocalEvent({type:"filterGlobalButtons",isGlobal:e})}shouldKeepStateOnDetach(e,t){if(t==="newFiltersToolPanel")return!0;let i=this.beans.filterPanelSvc;return i?.isActive?!!i.getState(e.getColId()):!1}destroy(){super.destroy(),this.allColumnFilters.forEach(e=>this.disposeFilterWrapper(e,"gridDestroyed")),this.allColumnListeners.clear(),this.state.clear(),this.activeFilterComps.clear()}};function hK(e){return!!e.filterManager?.isAnyFilterPresent()}function pK(e,t="api"){e.filterManager?.onFilterChanged({source:t})}var gK=class extends F{constructor(){super(...arguments),this.beanName="filterManager",this.advFilterModelUpdateQueue=[]}wireBeans(e){this.quickFilter=e.quickFilter,this.advancedFilter=e.advancedFilter,this.colFilter=e.colFilter}postConstruct(){let e=this.refreshFiltersForAggregations.bind(this),t=this.updateAdvFilterColumns.bind(this);this.addManagedEventListeners({columnValueChanged:e,columnPivotChanged:e,columnPivotModeChanged:e,newColumnsLoaded:t,columnVisible:t,advancedFilterEnabledChanged:({enabled:n})=>this.onAdvFilterEnabledChanged(n),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.addManagedPropertyListeners(["isExternalFilterPresent","doesExternalFilterPass"],()=>{this.onFilterChanged({source:"api"})}),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",()=>{this.updateAggFiltering(),this.onFilterChanged()}),this.quickFilter&&this.addManagedListeners(this.quickFilter,{quickFilterChanged:()=>this.onFilterChanged({source:"quickFilter"})});let{gos:i}=this;this.alwaysPassFilter=i.get("alwaysPassFilter"),this.addManagedPropertyListener("alwaysPassFilter",()=>{this.alwaysPassFilter=i.get("alwaysPassFilter"),this.onFilterChanged({source:"api"})})}isExternalFilterPresentCallback(){let e=this.gos.getCallback("isExternalFilterPresent");return typeof e=="function"&&e({})}doesExternalFilterPass(e){let t=this.gos.get("doesExternalFilterPass");return typeof t=="function"&&t(e)}setFilterState(e,t,i="api"){this.isAdvFilterEnabled()||this.colFilter?.setState(e,t,i)}setFilterModel(e,t="api",i){if(this.isAdvFilterEnabled()){i||this.warnAdvFilters();return}this.colFilter?.setModel(e,t)}getFilterModel(){return this.colFilter?.getModel()??{}}getFilterState(){return this.colFilter?.getState()}isColumnFilterPresent(){return!!this.colFilter?.isFilterPresent()}isAggregateFilterPresent(){return!!this.colFilter?.isAggFilterPresent()}isChildFilterPresent(){return this.isColumnFilterPresent()||this.isQuickFilterPresent()||this.externalFilterPresent||this.isAdvFilterPresent()}isAnyFilterPresent(){return this.isChildFilterPresent()||this.isAggregateFilterPresent()}isAdvFilterPresent(){return this.isAdvFilterEnabled()&&this.advancedFilter.isFilterPresent()}onAdvFilterEnabledChanged(e){e?this.colFilter?.disableFilters()&&this.onFilterChanged({source:"advancedFilter"}):this.advancedFilter?.isFilterPresent()&&(this.advancedFilter.setModel(null),this.onFilterChanged({source:"advancedFilter"}))}isAdvFilterEnabled(){return!!this.advancedFilter?.isEnabled()}isAdvFilterHeaderActive(){return this.isAdvFilterEnabled()&&this.advancedFilter.isHeaderActive()}refreshFiltersForAggregations(){nv(this.gos)&&this.isAnyFilterPresent()&&this.onFilterChanged()}onFilterChanged(e={}){let{source:t,additionalEventAttributes:i,columns:n=[]}=e;this.externalFilterPresent=this.isExternalFilterPresentCallback(),(this.colFilter?this.colFilter.updateBeforeFilterChanged(e):lt.resolve()).then(()=>{let s={source:t,type:"filterChanged",columns:n};i&&pi(s,i),this.eventSvc.dispatchEvent(s),this.colFilter?.updateAfterFilterChanged()})}isSuppressFlashingCellsBecauseFiltering(){return!!this.colFilter?.isSuppressFlashingCellsBecauseFiltering()}isQuickFilterPresent(){return!!this.quickFilter?.isFilterPresent()}updateAggFiltering(){this.aggFiltering=!!nv(this.gos)}isAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&this.shouldApplyQuickFilterAfterAgg()}isNonAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&!this.shouldApplyQuickFilterAfterAgg()}shouldApplyQuickFilterAfterAgg(){return(this.aggFiltering||this.beans.colModel.isPivotMode())&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")}doesRowPassOtherFilters(e,t){return this.doesRowPassFilter({rowNode:t,colIdToSkip:e})}doesRowPassAggregateFilters(e){let{rowNode:t}=e;return this.alwaysPassFilter?.(t)?!0:!(this.isAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(t)||this.isAggregateFilterPresent()&&!this.colFilter.doFiltersPass(t,e.colIdToSkip,!0))}doesRowPassFilter(e){let{rowNode:t}=e;return this.alwaysPassFilter?.(t)?!0:!(this.isNonAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(t)||this.externalFilterPresent&&!this.doesExternalFilterPass(t)||this.isColumnFilterPresent()&&!this.colFilter.doFiltersPass(t,e.colIdToSkip)||this.isAdvFilterPresent()&&!this.advancedFilter.doesFilterPass(t))}isFilterAllowed(e){return this.isAdvFilterEnabled()?!1:!!this.colFilter?.isFilterAllowed(e)}getAdvFilterModel(){return this.isAdvFilterEnabled()?this.advancedFilter.getModel():null}setAdvFilterModel(e,t="api"){if(this.isAdvFilterEnabled()){if(this.beans.dataTypeSvc?.isPendingInference){this.advFilterModelUpdateQueue.push(e);return}this.advancedFilter.setModel(e??null),this.onFilterChanged({source:t})}}toggleAdvFilterBuilder(e,t){this.isAdvFilterEnabled()&&this.advancedFilter.getCtrl().toggleFilterBuilder({source:t,force:e})}updateAdvFilterColumns(){this.isAdvFilterEnabled()&&this.advancedFilter.updateValidity()&&this.onFilterChanged({source:"advancedFilter"})}hasFloatingFilters(){return this.isAdvFilterEnabled()?!1:!!this.colFilter?.hasFloatingFilters()}getColumnFilterInstance(e){return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve(void 0)):this.colFilter?.getFilterInstance(e)??Promise.resolve(void 0)}warnAdvFilters(){I(68)}setupAdvFilterHeaderComp(e){this.advancedFilter?.getCtrl().setupHeaderComp(e)}getHeaderRowCount(){return this.isAdvFilterHeaderActive()?1:0}getHeaderHeight(){return this.isAdvFilterHeaderActive()?this.advancedFilter.getCtrl().getHeaderHeight():0}processFilterModelUpdateQueue(){for(let e of this.advFilterModelUpdateQueue)this.setAdvFilterModel(e);this.advFilterModelUpdateQueue=[]}setColumnFilterModel(e,t){return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve()):this.colFilter?.setModelForColumn(e,t)??Promise.resolve()}},fK=class extends F{constructor(){super(...arguments),this.beanName="filterMenuFactory"}wireBeans(e){this.popupSvc=e.popupSvc}hideActiveMenu(){this.hidePopup?.()}showMenuAfterMouseEvent(e,t,i,n){e&&!e.isColumn||this.showPopup(e,s=>{this.popupSvc?.positionPopupUnderMouseEvent({column:e,type:i,mouseEvent:t,ePopup:s})},i,t.target,Ti(this.gos),n)}showMenuAfterButtonClick(e,t,i,n){if(e&&!e.isColumn)return;let s=-1,o="left",r=Ti(this.gos);!r&&this.gos.get("enableRtl")&&(s=1,o="right");let a=r?void 0:4*s,l=r?void 0:4;this.showPopup(e,d=>{this.popupSvc?.positionPopupByComponent({type:i,eventSource:t,ePopup:d,nudgeX:a,nudgeY:l,alignSide:o,keepWithinBounds:!0,position:"under",column:e})},i,t,r,n)}showPopup(e,t,i,n,s,o){let r=e?this.createBean(new XH(e,"COLUMN_MENU")):void 0;if(this.activeMenu=r,!r?.hasFilter()||!e){Ge(57);return}let a=bt({tag:"div",cls:`ag-menu${s?"":" ag-filter-menu"}`,role:"presentation"});[this.tabListener]=this.addManagedElementListeners(a,{keydown:f=>this.trapFocusWithin(f,a)}),a.appendChild(r?.getGui());let l,d=()=>r?.afterGuiDetached(),c=gN(this.gos)?n??this.beans.ctrlsSvc.getGridBodyCtrl().eGridBody:void 0,u=f=>{BR(e,!1,"contextMenu");let m=f instanceof KeyboardEvent;this.tabListener&&(this.tabListener=this.tabListener()),m&&n&&Gn(n)&&B4(n)?.focus({preventScroll:!0}),d(),this.destroyBean(this.activeMenu),this.dispatchVisibleChangedEvent(!1,i,e),o?.()},h=this.getLocaleTextFunc(),p=s&&i!=="columnFilter"?h("ariaLabelColumnMenu","Column Menu"):h("ariaLabelColumnFilter","Column Filter"),g=this.popupSvc?.addPopup({modal:!0,eChild:a,closeOnEsc:!0,closedCallback:u,positionCallback:()=>t(a),anchorToElement:c,ariaLabel:p});g&&(this.hidePopup=l=g.hideFunc),r.afterInit().then(()=>{t(a),r.afterGuiAttached({container:i,hidePopup:l})}),BR(e,!0,"contextMenu"),this.dispatchVisibleChangedEvent(!0,i,e)}trapFocusWithin(e,t){e.key!==k.TAB||e.defaultPrevented||pr(this.beans,t,!1,e.shiftKey)||(e.preventDefault(),lr(t,e.shiftKey))}dispatchVisibleChangedEvent(e,t,i){this.eventSvc.dispatchEvent({type:"columnMenuVisibleChanged",visible:e,switchingTab:!1,key:t,column:i??null,columnGroup:null})}isMenuEnabled(e){return e.isFilterAllowed()&&(e.getColDef().menuTabs??["filterMenuTab"]).includes("filterMenuTab")}showMenuAfterContextMenuEvent(){}destroy(){this.destroyBean(this.activeMenu),super.destroy()}},mK=class extends F{constructor(){super(...arguments),this.beanName="filterValueSvc"}getValue(e,t,i){if(!t)return;let n=e.getColDef(),{selectableFilter:s,valueSvc:o}=this.beans,r=i??s?.getFilterValueGetter(e.getColId())??n.filterValueGetter;return r?this.executeFilterValueGetter(r,t.data,e,t,n):o.getValue(e,t)}executeFilterValueGetter(e,t,i,n,s){let{expressionSvc:o,valueSvc:r}=this.beans,a=ae(this.gos,{data:t,node:n,column:i,colDef:s,getValue:r.getValueCallback.bind(r,n)});return typeof e=="function"?e(a):o?.evaluate(e,a)}},CK={tag:"div",cls:"ag-floating-filter-input",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eFloatingFilterText"}]},vK=class extends Be{constructor(){super(CK,[tg]),this.eFloatingFilterText=U}init(e){this.params=e;let t=this.beans.colNames.getDisplayNameForColumn(e.column,"header",!0);if(this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(`${t} ${this.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`),this.gos.get("enableFilterHandlers")){let i=e,n=i.getHandler();if(n.getModelAsString){let s=n.getModelAsString(i.model);this.eFloatingFilterText.setValue(s)}}}onParentModelChanged(e){if(e==null){this.eFloatingFilterText.setValue("");return}this.params.parentFilterInstance(t=>{if(t.getModelAsString){let i=t.getModelAsString(e);this.eFloatingFilterText.setValue(i)}})}refresh(e){this.init(e)}},vw=class{constructor(){this.customFilterOptions={}}init(e,t){this.filterOptions=e.filterOptions??t,this.mapCustomOptions(),this.defaultOption=this.getDefaultItem(e.defaultOption)}refresh(e,t){let i=e.filterOptions??t;this.filterOptions!==i&&(this.filterOptions=i,this.customFilterOptions={},this.mapCustomOptions()),this.defaultOption=this.getDefaultItem(e.defaultOption)}mapCustomOptions(){let{filterOptions:e}=this;if(e)for(let t of e){if(typeof t=="string")continue;let i=[["displayKey"],["displayName"],["predicate","test"]],n=s=>s.some(o=>t[o]!=null)?!0:(I(72,{keys:s}),!1);if(!i.every(n)){this.filterOptions=e.filter(s=>s===t)||[];continue}this.customFilterOptions[t.displayKey]=t}}getDefaultItem(e){let{filterOptions:t}=this;if(e)return e;if(t.length>=1){let i=t[0];if(typeof i=="string")return i;if(i.displayKey)return i.displayKey;I(73)}else I(74)}getCustomOption(e){return this.customFilterOptions[e]}};function kd(e,t,i){return i==null?e.splice(t):e.splice(t,i)}function Jp(e){return e==null||typeof e=="string"&&e.trim().length===0}function wK(e){return e==="AND"||e==="OR"?e:"AND"}function bK(e,t,i){if(e==null)return;let{predicate:n}=e;if(n!=null&&!t.some(s=>s==null))return n(t,i)}function yK(e,t){let i=e.length;return i>t&&(e.splice(t),I(78),i=t),i}function Gd(e,t){let i=t.getCustomOption(e);if(i){let{numberOfInputs:s}=i;return s??1}return e&&["empty","notBlank","blank"].indexOf(e)>=0?0:e==="inRange"?2:1}var ww=class extends oV{constructor(e,t,i){super(e,"simple-filter"),this.mapValuesFromModel=t,this.defaultOptions=i,this.eTypes=[],this.eJoinPanels=[],this.eJoinAnds=[],this.eJoinOrs=[],this.eConditionBodies=[],this.listener=()=>this.onUiChanged(),this.lastUiCompletePosition=null,this.joinOperatorId=0}setParams(e){super.setParams(e);let t=new vw;this.optionsFactory=t,t.init(e,this.defaultOptions),this.commonUpdateSimpleParams(e),this.createOption(),this.createMissingConditionsAndOperators()}updateParams(e,t){this.optionsFactory.refresh(e,this.defaultOptions),super.updateParams(e,t),this.commonUpdateSimpleParams(e)}commonUpdateSimpleParams(e){this.setNumConditions(e),this.defaultJoinOperator=wK(e.defaultJoinOperator),this.filterPlaceholder=e.filterPlaceholder,this.createFilterListOptions();let t=this.getGui();this.isReadOnly()?t.setAttribute("tabindex","-1"):t.removeAttribute("tabindex")}onFloatingFilterChanged(e,t){this.setTypeFromFloatingFilter(e),this.setValueFromFloatingFilter(t),this.onUiChanged("immediately",!0)}setTypeFromFloatingFilter(e){this.eTypes.forEach((t,i)=>{let n=i===0?e:this.optionsFactory.defaultOption;t.setValue(n,!0)})}getModelFromUi(){let e=this.getUiCompleteConditions();return e.length===0?null:this.maxNumConditions>1&&e.length>1?{filterType:this.filterType,operator:this.getJoinOperator(),conditions:e}:e[0]}getConditionTypes(){return this.eTypes.map(e=>e.getValue())}getConditionType(e){return this.eTypes[e].getValue()}getJoinOperator(){let{eJoinOrs:e,defaultJoinOperator:t}=this;return e.length===0?t:e[0].getValue()===!0?"OR":"AND"}areNonNullModelsEqual(e,t){let i=!e.operator,n=!t.operator;if(!i&&n||i&&!n)return!1;let o;if(i){let r=e,a=t;o=this.areSimpleModelsEqual(r,a)}else{let r=e,a=t;o=r.operator===a.operator&&ho(r.conditions,a.conditions,(l,d)=>this.areSimpleModelsEqual(l,d))}return o}setModelIntoUi(e,t){if(e==null)return this.resetUiToDefaults(t),lt.resolve();if(e.operator){let n=e,s=n.conditions;s==null&&(s=[],I(77));let o=yK(s,this.maxNumConditions),r=this.getNumConditions();if(o<r)this.removeConditionsAndOperators(o);else if(o>r)for(let l=r;l<o;l++)this.createJoinOperatorPanel(),this.createOption();let a=n.operator==="OR";this.eJoinAnds.forEach(l=>l.setValue(!a,!0)),this.eJoinOrs.forEach(l=>l.setValue(a,!0)),s.forEach((l,d)=>{this.eTypes[d].setValue(l.type,!0),this.setConditionIntoUi(l,d)})}else{let n=e;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(n.type,!0),this.setConditionIntoUi(n,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.updateUiVisibility(),t||this.params.onUiChange(this.getUiChangeEventParams()),lt.resolve()}setNumConditions(e){let t=e.maxNumConditions??2;t<1&&(I(79),t=1),this.maxNumConditions=t;let i=e.numAlwaysVisibleConditions??1;i<1&&(I(80),i=1),i>t&&(I(81),i=t),this.numAlwaysVisibleConditions=i}createOption(){let e=this.getGui(),t=this.createManagedBean(new Xv);this.eTypes.push(t),t.addCss("ag-filter-select"),e.appendChild(t.getGui());let i=this.createEValue();this.eConditionBodies.push(i),e.appendChild(i),this.putOptionsIntoDropdown(t),this.resetType(t);let n=this.getNumConditions()-1;this.forEachPositionInput(n,s=>this.resetInput(s)),this.addChangedListeners(t,n)}createJoinOperatorPanel(){let e=bt({tag:"div",cls:"ag-filter-condition"});this.eJoinPanels.push(e);let t=this.createJoinOperator(this.eJoinAnds,e,"and"),i=this.createJoinOperator(this.eJoinOrs,e,"or");this.getGui().appendChild(e);let n=this.eJoinPanels.length-1,s=this.joinOperatorId++;this.resetJoinOperatorAnd(t,n,s),this.resetJoinOperatorOr(i,n,s),this.isReadOnly()||(t.onValueChange(this.listener),i.onValueChange(this.listener))}createJoinOperator(e,t,i){let n=this.createManagedBean(new OB);e.push(n);let s="ag-filter-condition-operator";return n.addCss(s),n.addCss(`${s}-${i}`),t.appendChild(n.getGui()),n}createFilterListOptions(){this.filterListOptions=this.optionsFactory.filterOptions.map(e=>typeof e=="string"?this.createBoilerplateListOption(e):this.createCustomListOption(e))}putOptionsIntoDropdown(e){let{filterListOptions:t}=this;for(let i of t)e.addOption(i);e.setDisabled(t.length<=1)}createBoilerplateListOption(e){return{value:e,text:this.translate(e)}}createCustomListOption(e){let{displayKey:t}=e,i=this.optionsFactory.getCustomOption(e.displayKey);return{value:t,text:i?this.getLocaleTextFunc()(i.displayKey,i.displayName):this.translate(t)}}createBodyTemplate(){return null}getAgComponents(){return[]}updateUiVisibility(){let e=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,e)}updateNumConditions(){let e=-1,t=!0;for(let i=0;i<this.getNumConditions();i++)this.isConditionUiComplete(i)?e=i:t=!1;if(this.shouldAddNewConditionAtEnd(t))this.createJoinOperatorPanel(),this.createOption();else{let i=this.lastUiCompletePosition??this.getNumConditions()-2;if(e<i){this.removeConditionsAndOperators(i+1);let n=e+1,s=i-n;s>0&&this.removeConditionsAndOperators(n,s),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=e}updateConditionStatusesAndValues(e,t){this.eTypes.forEach((n,s)=>{let o=this.isConditionDisabled(s,e);n.setDisabled(o||this.filterListOptions.length<=1),s===1&&(Td(this.eJoinPanels[0],o),this.eJoinAnds[0].setDisabled(o),this.eJoinOrs[0].setDisabled(o))}),this.eConditionBodies.forEach((n,s)=>{et(n,this.isConditionBodyVisible(s))});let i=(t??this.getJoinOperator())==="OR";for(let n of this.eJoinAnds)n.setValue(!i,!0);for(let n of this.eJoinOrs)n.setValue(i,!0);this.forEachInput((n,s,o,r)=>{this.setElementDisplayed(n,s<r),this.setElementDisabled(n,this.isConditionDisabled(o,e))}),this.resetPlaceholder()}shouldAddNewConditionAtEnd(e){return e&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}removeConditionsAndOperators(e,t){if(e>=this.getNumConditions())return;let{eTypes:i,eConditionBodies:n,eJoinPanels:s,eJoinAnds:o,eJoinOrs:r}=this;this.removeComponents(i,e,t),this.removeElements(n,e,t),this.removeEValues(e,t);let a=Math.max(e-1,0);this.removeElements(s,a,t),this.removeComponents(o,a,t),this.removeComponents(r,a,t)}removeElements(e,t,i){let n=kd(e,t,i);for(let s of n)yi(s)}removeComponents(e,t,i){let n=kd(e,t,i);for(let s of n)yi(s.getGui()),this.destroyBean(s)}afterGuiAttached(e){if(super.afterGuiAttached(e),this.resetPlaceholder(),!e?.suppressFocus){let t;if(!this.isReadOnly()){let i=this.getInputs(0)[0];i instanceof Qo&&this.isConditionBodyVisible(0)?t=i.getInputElement():t=this.eTypes[0]?.getFocusableElement()}(t??this.getGui()).focus({preventScroll:!0})}}afterGuiDetached(){super.afterGuiDetached();let e=this.params;if(this.beans.colFilter?.shouldKeepStateOnDetach(e.column))return;e.onStateChange({model:e.model});let t=-1,i=-1,n=!1,s=this.getJoinOperator();for(let r=this.getNumConditions()-1;r>=0;r--)if(this.isConditionUiComplete(r))t===-1&&(t=r,i=r);else{let a=r>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(r-1),l=r<t;(a||l)&&(this.removeConditionsAndOperators(r,1),n=!0,l&&i--)}let o=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),o=!0),this.shouldAddNewConditionAtEnd(i===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),o=!0),o&&this.updateConditionStatusesAndValues(i,s),n&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=i}getModelAsString(e){return this.params.getHandler()?.getModelAsString?.(e)??""}getPlaceholderText(e,t){let i=this.translate(e);if(typeof this.filterPlaceholder=="function"){let n=this.eTypes[t].getValue(),s=this.translate(n);i=this.filterPlaceholder({filterOptionKey:n,filterOption:s,placeholder:i})}else typeof this.filterPlaceholder=="string"&&(i=this.filterPlaceholder);return i}resetPlaceholder(){let e=this.getLocaleTextFunc();this.forEachInput((t,i,n,s)=>{if(!(t instanceof Qo))return;let o=i===0&&s>1?"inRangeStart":i===0?"filterOoo":"inRangeEnd",r=i===0&&s>1?e("ariaFilterFromValue","Filter from value"):i===0?e("ariaFilterValue","Filter Value"):e("ariaFilterToValue","Filter to Value");t.setInputPlaceholder(this.getPlaceholderText(o,n)),t.setInputAriaLabel(r)})}setElementValue(e,t,i){e instanceof Qo&&e.setValue(t!=null?String(t):null,!0)}setElementDisplayed(e,t){wR(e)&&et(e.getGui(),t)}setElementDisabled(e,t){wR(e)&&Td(e.getGui(),t)}attachElementOnChange(e,t){e instanceof Qo&&e.onValueChange(t)}forEachInput(e){this.getConditionTypes().forEach((t,i)=>{this.forEachPositionTypeInput(i,t,e)})}forEachPositionInput(e,t){let i=this.getConditionType(e);this.forEachPositionTypeInput(e,i,t)}forEachPositionTypeInput(e,t,i){let n=Gd(t,this.optionsFactory),s=this.getInputs(e);for(let o=0;o<s.length;o++){let r=s[o];r!=null&&i(r,o,e,n)}}isConditionDisabled(e,t){return this.isReadOnly()?!0:e===0?!1:e>t+1}isConditionBodyVisible(e){let t=this.getConditionType(e);return Gd(t,this.optionsFactory)>0}isConditionUiComplete(e){return!(e>=this.getNumConditions()||this.getConditionType(e)==="empty"||this.getValues(e).some(i=>i==null))}getNumConditions(){return this.eTypes.length}getUiCompleteConditions(){let e=[];for(let t=0;t<this.getNumConditions();t++)this.isConditionUiComplete(t)&&e.push(this.createCondition(t));return e}createMissingConditionsAndOperators(){if(!this.isReadOnly())for(let e=this.getNumConditions();e<this.numAlwaysVisibleConditions;e++)this.createJoinOperatorPanel(),this.createOption()}resetUiToDefaults(e){this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach(t=>this.resetType(t)),this.eJoinAnds.forEach((t,i)=>this.resetJoinOperatorAnd(t,i,this.joinOperatorId+i)),this.eJoinOrs.forEach((t,i)=>this.resetJoinOperatorOr(t,i,this.joinOperatorId+i)),this.joinOperatorId++,this.forEachInput(t=>this.resetInput(t)),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,this.updateUiVisibility(),e||this.params.onUiChange(this.getUiChangeEventParams())}resetType(e){let i=this.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");e.setValue(this.optionsFactory.defaultOption,!0).setAriaLabel(i).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}resetJoinOperatorAnd(e,t,i){this.resetJoinOperator(e,t,this.defaultJoinOperator==="AND",this.translate("andCondition"),i)}resetJoinOperatorOr(e,t,i){this.resetJoinOperator(e,t,this.defaultJoinOperator==="OR",this.translate("orCondition"),i)}resetJoinOperator(e,t,i,n,s){this.updateJoinOperatorDisabled(e.setValue(i,!0).setName(`ag-simple-filter-and-or-${this.getCompId()}-${s}`).setLabel(n),t)}updateJoinOperatorsDisabled(){let e=(t,i)=>this.updateJoinOperatorDisabled(t,i);this.eJoinAnds.forEach(e),this.eJoinOrs.forEach(e)}updateJoinOperatorDisabled(e,t){e.setDisabled(this.isReadOnly()||t>0)}resetInput(e){this.setElementValue(e,null),this.setElementDisabled(e,this.isReadOnly())}setConditionIntoUi(e,t){let i=this.mapValuesFromModel(e,this.optionsFactory);this.forEachInput((n,s,o)=>{o===t&&this.setElementValue(n,i[s]!=null?i[s]:null)})}setValueFromFloatingFilter(e){this.forEachInput((t,i,n)=>{this.setElementValue(t,i===0&&n===0?e:null,!0)})}addChangedListeners(e,t){this.isReadOnly()||(e.onValueChange(this.listener),this.forEachPositionInput(t,i=>{this.attachElementOnChange(i,this.listener)}))}hasInvalidInputs(){return!1}isReadOnly(){return!!this.params.readOnly}},cD=class{constructor(e,t,i,n,s,o){this.alive=!0,this.context=e,this.eParent=s;let r=CB(t,i,n);r&&r.newAgStackInstance().then(a=>{if(!this.alive){e.destroyBean(a);return}if(this.dateComp=a,!a)return;s.appendChild(a.getGui()),a?.afterGuiAttached?.();let{tempValue:l,disabled:d}=this;l&&a.setDate(l),d!=null&&a.setDisabled?.(d),o?.(this)})}destroy(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)}getDate(){return this.dateComp?this.dateComp.getDate():this.tempValue}setDate(e){let t=this.dateComp;t?t.setDate(e):this.tempValue=e}setDisabled(e){let t=this.dateComp;t?t.setDisabled?.(e):this.disabled=e}setDisplayed(e){et(this.eParent,e)}setInputPlaceholder(e){this.dateComp?.setInputPlaceholder?.(e)}setInputAriaLabel(e){this.dateComp?.setInputAriaLabel?.(e)}afterGuiAttached(e){this.dateComp?.afterGuiAttached?.(e)}updateParams(e){this.dateComp?.refresh?.(e)}},bw=["equals","notEqual","lessThan","greaterThan","inRange","blank","notBlank"];function uD(e,t){let{dateFrom:i,dateTo:n,type:s}=e||{};return[i&&Si(i,void 0,!0)||null,n&&Si(n,void 0,!0)||null].slice(0,Gd(s,t))}var w6=1e3,b6=1/0,SK=class extends ww{constructor(){super("dateFilter",uD,bw),this.eConditionPanelsFrom=[],this.eConditionPanelsTo=[],this.dateConditionFromComps=[],this.dateConditionToComps=[],this.minValidYear=w6,this.maxValidYear=b6,this.minValidDate=null,this.maxValidDate=null,this.filterType="date"}afterGuiAttached(e){super.afterGuiAttached(e),this.dateConditionFromComps[0].afterGuiAttached(e)}commonUpdateSimpleParams(e){super.commonUpdateSimpleParams(e);let t=(l,d)=>{let c=e[l];if(c!=null)if(isNaN(c))I(82,{param:l});else return c==null?d:Number(c);return d},i=t("minValidYear",w6),n=t("maxValidYear",b6);this.minValidYear=i,this.maxValidYear=n,i>n&&I(83);let{minValidDate:s,maxValidDate:o}=e,r=s instanceof Date?s:Si(s);this.minValidDate=r;let a=o instanceof Date?o:Si(o);this.maxValidDate=a,r&&a&&r>a&&I(84)}createDateCompWrapper(e){let{beans:{userCompFactory:t,context:i,gos:n},params:s}=this,o=new cD(i,t,s.colDef,ae(n,{onDateChanged:()=>this.onUiChanged(),filterParams:s,location:"filter"}),e);return this.addDestroyFunc(()=>o.destroy()),o}setElementValue(e,t){e.setDate(t)}setElementDisplayed(e,t){e.setDisplayed(t)}setElementDisabled(e,t){e.setDisabled(t)}createEValue(){let e=bt({tag:"div",cls:"ag-filter-body"});return this.createFromToElement(e,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(e,this.eConditionPanelsTo,this.dateConditionToComps,"to"),e}createFromToElement(e,t,i,n){let s=bt({tag:"div",cls:`ag-filter-${n} ag-filter-date-${n}`});t.push(s),e.appendChild(s),i.push(this.createDateCompWrapper(s))}removeEValues(e,t){this.removeDateComps(this.dateConditionFromComps,e,t),this.removeDateComps(this.dateConditionToComps,e,t),kd(this.eConditionPanelsFrom,e,t),kd(this.eConditionPanelsTo,e,t)}removeDateComps(e,t,i){let n=kd(e,t,i);for(let s of n)s.destroy()}isValidDateValue(e){if(e===null)return!1;let{minValidDate:t,maxValidDate:i,minValidYear:n,maxValidYear:s}=this;if(t){if(e<t)return!1}else if(e.getUTCFullYear()<n)return!1;if(i){if(e>i)return!1}else if(e.getUTCFullYear()>s)return!1;return!0}isConditionUiComplete(e){if(!super.isConditionUiComplete(e))return!1;let t=!0;return this.forEachInput((i,n,s,o)=>{s!==e||!t||n>=o||(t=t&&this.isValidDateValue(i.getDate()))}),t}areSimpleModelsEqual(e,t){return e.dateFrom===t.dateFrom&&e.dateTo===t.dateTo&&e.type===t.type}createCondition(e){let t=this.getConditionType(e),i={},n=this.getValues(e),s=this.params.useIsoSeparator?"T":" ";return n.length>0&&(i.dateFrom=Ai(n[0],!0,s)),n.length>1&&(i.dateTo=Ai(n[1],!0,s)),b({dateFrom:null,dateTo:null,filterType:this.filterType,type:t},i)}resetPlaceholder(){let e=this.getLocaleTextFunc(),t=this.translate("dateFormatOoo"),i=e("ariaFilterValue","Filter Value");this.forEachInput(n=>{n.setInputPlaceholder(t),n.setInputAriaLabel(i)})}getInputs(e){let{dateConditionFromComps:t,dateConditionToComps:i}=this;return e>=t.length?[null,null]:[t[e],i[e]]}getValues(e){let t=[];return this.forEachPositionInput(e,(i,n,s,o)=>{n<o&&t.push(i.getDate())}),t}translate(e){return e==="lessThan"?super.translate("before"):e==="greaterThan"?super.translate("after"):super.translate(e)}},hD=class extends F{constructor(e,t){super(),this.mapValuesFromModel=e,this.defaultOptions=t}init(e){let t=e.filterParams,i=new vw;this.optionsFactory=i,i.init(t,this.defaultOptions),this.filterModelFormatter=this.createManagedBean(new this.FilterModelFormatterClass(i,t)),this.updateParams(e),this.validateModel(e)}refresh(e){if(e.source==="colDef"){let t=e.filterParams,i=this.optionsFactory;i.refresh(t,this.defaultOptions),this.filterModelFormatter.updateParams({optionsFactory:i,filterParams:t}),this.updateParams(e)}this.validateModel(e)}updateParams(e){this.params=e}doesFilterPass(e){let t=e.model;if(t==null)return!0;let{operator:i}=t,n=[];if(i){let r=t;n.push(...r.conditions??[])}else n.push(t);let s=i&&i==="OR"?"some":"every",o=this.params.getValue(e.node);return n[s](r=>this.individualConditionPasses(e,r,o))}getModelAsString(e,t){return this.filterModelFormatter.getModelAsString(e,t)??""}validateModel(e){let{model:t,filterParams:{filterOptions:i,maxNumConditions:n}}=e;if(t==null)return;let o=oM(t)?t.conditions:[t],r=i?.map(c=>typeof c=="string"?c:c.displayKey)??this.defaultOptions;if(!(!o||o.every(c=>r.find(u=>u===c.type)!==void 0))){this.params=O(b({},e),{model:null}),e.onModelChange(null);return}let l=!1,d=this.filterType;if((o&&!o.every(c=>c.filterType===d)||t.filterType!==d)&&(o=o.map(c=>O(b({},c),{filterType:d})),l=!0),typeof n=="number"&&o&&o.length>n&&(o=o.slice(0,n),l=!0),l){let c=o.length>1?O(b({},t),{filterType:d,conditions:o}):O(b({},o[0]),{filterType:d});this.params=O(b({},e),{model:c}),e.onModelChange(c)}}individualConditionPasses(e,t,i){let n=this.optionsFactory,s=this.mapValuesFromModel(t,n),o=n.getCustomOption(t.type),r=bK(o,s,i);return r??(i==null?this.evaluateNullValue(t.type):this.evaluateNonNullValue(s,i,t,e))}},pD=class extends hD{evaluateNullValue(e){let{includeBlanksInEquals:t,includeBlanksInNotEqual:i,includeBlanksInGreaterThan:n,includeBlanksInLessThan:s,includeBlanksInRange:o}=this.params.filterParams;switch(e){case"equals":if(t)return!0;break;case"notEqual":if(i)return!0;break;case"greaterThan":case"greaterThanOrEqual":if(n)return!0;break;case"lessThan":case"lessThanOrEqual":if(s)return!0;break;case"inRange":if(o)return!0;break;case"blank":return!0;case"notBlank":return!1}return!1}evaluateNonNullValue(e,t,i){let n=i.type;if(!this.isValid(t))return n==="notEqual"||n==="notBlank";let s=this.comparator(),o=e[0]!=null?s(e[0],t):0;switch(n){case"equals":return o===0;case"notEqual":return o!==0;case"greaterThan":return o>0;case"greaterThanOrEqual":return o>=0;case"lessThan":return o<0;case"lessThanOrEqual":return o<=0;case"inRange":{let r=s(e[1],t);return this.params.filterParams.inRangeInclusive?o>=0&&r<=0:o>0&&r<0}case"blank":return Jp(t);case"notBlank":return!Jp(t);default:return I(76,{filterModelType:n}),!0}}},gD={equals:"Equals",notEqual:"NotEqual",greaterThan:"GreaterThan",greaterThanOrEqual:"GreaterThanOrEqual",lessThan:"LessThan",lessThanOrEqual:"LessThanOrEqual",inRange:"InRange"},xK={contains:"Contains",notContains:"NotContains",equals:"TextEquals",notEqual:"TextNotEqual",startsWith:"StartsWith",endsWith:"EndsWith",inRange:"InRange"},yw=class extends F{constructor(e,t,i){super(),this.optionsFactory=e,this.filterParams=t,this.valueFormatter=i}getModelAsString(e,t){let i=this.getLocaleTextFunc(),n=t==="filterToolPanel";if(!e)return n?so(this,"filterSummaryInactive"):null;if(e.operator!=null){let o=e,a=(o.conditions??[]).map(d=>this.getModelAsString(d,t)),l=o.operator==="AND"?"andCondition":"orCondition";return a.join(` ${so(this,l)} `)}else{if(e.type==="blank"||e.type==="notBlank")return n?so(this,e.type==="blank"?"filterSummaryBlank":"filterSummaryNotBlank"):i(e.type,e.type);{let o=e,r=this.optionsFactory.getCustomOption(o.type),{displayKey:a,displayName:l,numberOfInputs:d}=r||{};return a&&l&&d===0?i(a,l):this.conditionToString(o,n,o.type==="inRange"||d===2,a,l)}}}updateParams(e){let{optionsFactory:t,filterParams:i}=e;this.optionsFactory=t,this.filterParams=i}conditionForToolPanel(e,t,i,n,s,o){let r,a=this.getTypeKey(e);return a&&(r=so(this,a)),s&&o&&(r=this.getLocaleTextFunc()(s,o)),r!=null?t?`${r} ${so(this,"filterSummaryInRangeValues",[i(),n()])}`:`${r} ${i()}`:null}getTypeKey(e){let t=this.filterTypeKeys[e];return t?`filterSummary${t}`:null}formatValue(e){let t=this.valueFormatter;return t?t(e??null)??"":String(e)}},fD=class extends yw{constructor(e,t){super(e,t,i=>{let{dataTypeSvc:n,valueSvc:s}=this.beans,o=t.column,r=n?.getDateFormatterFunction(o),a=r?r(i??void 0):i;return s.formatValue(o,null,a)}),this.filterTypeKeys=gD}conditionToString(e,t,i,n,s){let{type:o}=e,r=Si(e.dateFrom),a=Si(e.dateTo),l=this.filterParams.inRangeFloatingFilterDateFormat,d=t?this.formatValue.bind(this):h=>dv(h,l),c=()=>r!==null?d(r):"null",u=()=>a!==null?d(a):"null";if(t){let h=this.conditionForToolPanel(o,i,c,u,n,s);if(h!=null)return h}return i?`${c()}-${u()}`:r!=null?d(r):`${o}`}};function EK(e,t){let i=t;return i<e?-1:i>e?1:0}var RK=class extends pD{constructor(){super(uD,bw),this.filterType="date",this.FilterModelFormatterClass=fD}comparator(){return this.params.filterParams.comparator??EK}isValid(e){let t=this.params.filterParams.isValidDate;return!t||t(e)}},mD=class extends Be{constructor(){super(...arguments),this.defaultDebounceMs=0}setLastTypeFromModel(e){if(!e){this.lastType=this.optionsFactory.defaultOption;return}let t=e.operator,i;t?i=e.conditions[0]:i=e,this.lastType=i.type}canWeEditAfterModelFromParentFilter(e){if(!e)return this.isTypeEditable(this.lastType);if(e.operator)return!1;let i=e;return this.isTypeEditable(i.type)}init(e){this.params=e;let t=this.gos.get("enableFilterHandlers");if(this.reactive=t,this.setParams(e),t){let i=e;this.onModelUpdated(i.model)}}setParams(e){let t=new vw;this.optionsFactory=t,t.init(e.filterParams,this.defaultOptions),this.filterModelFormatter=this.createManagedBean(new this.FilterModelFormatterClass(t,e.filterParams)),this.setSimpleParams(e,!1)}setSimpleParams(e,t=!0){let i=this.optionsFactory.defaultOption;t||(this.lastType=i),this.readOnly=!!e.filterParams.readOnly;let n=this.isTypeEditable(i);this.setEditable(n)}refresh(e){this.params=e;let t=e,i=this.reactive;if((!i||t.source==="colDef")&&this.updateParams(e),i){let{source:n,model:s}=t;if(n==="dataChanged"||n==="ui")return;this.onModelUpdated(s)}}updateParams(e){let t=this.optionsFactory;t.refresh(e.filterParams,this.defaultOptions),this.setSimpleParams(e),this.filterModelFormatter.updateParams({optionsFactory:t,filterParams:e.filterParams})}onParentModelChanged(e,t){t?.afterFloatingFilter||t?.afterDataChange||this.onModelUpdated(e)}hasSingleInput(e){let t=this.optionsFactory.getCustomOption(e)?.numberOfInputs;return t==null||t==1}isTypeEditable(e){let t=["inRange","empty","blank","notBlank"];return!!e&&!this.readOnly&&this.hasSingleInput(e)&&t.indexOf(e)<0}getAriaLabel(e){return`${this.beans.colNames.getDisplayNameForColumn(e.column,"header",!0)} ${this.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`}},MK={tag:"div",cls:"ag-floating-filter-input",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eReadOnlyText"},{tag:"div",ref:"eDateWrapper",cls:"ag-date-floating-filter-wrapper"}]},DK=class extends mD{constructor(){super(MK,[tg]),this.eReadOnlyText=U,this.eDateWrapper=U,this.FilterModelFormatterClass=fD,this.filterType="date",this.defaultOptions=bw}setParams(e){super.setParams(e),this.createDateComponent();let t=this.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(t("ariaDateFilterInput","Date Filter Input"))}updateParams(e){super.updateParams(e),this.dateComp.updateParams(this.getDateComponentParams()),this.updateCompOnModelChange(e.currentParentModel())}updateCompOnModelChange(e){let t=!this.readOnly&&this.canWeEditAfterModelFromParentFilter(e);if(this.setEditable(t),t){let i=e?Si(e.dateFrom):null;this.dateComp.setDate(i),this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(e)),this.dateComp.setDate(null)}setEditable(e){et(this.eDateWrapper,e),et(this.eReadOnlyText.getGui(),!e)}onModelUpdated(e){super.setLastTypeFromModel(e),this.updateCompOnModelChange(e)}onDateChanged(){let e=this.dateComp.getDate();if(this.reactive){let t=this.params;t.onUiChange();let i=t.model,n=Ai(e),s=n==null?null:O(b({},i??{filterType:this.filterType,type:this.lastType??this.optionsFactory.defaultOption}),{dateFrom:n});t.onModelChange(s,{afterFloatingFilter:!0})}else this.params.parentFilterInstance(t=>{t?.onFloatingFilterChanged(this.lastType||null,e)})}getDateComponentParams(){let{filterParams:e}=this.params,t=tw(e,this.defaultDebounceMs);return ae(this.gos,{onDateChanged:qt(this,this.onDateChanged.bind(this),t),filterParams:e,location:"floatingFilter"})}createDateComponent(){let{beans:{context:e,userCompFactory:t},eDateWrapper:i,params:n}=this;this.dateComp=new cD(e,t,n.column.getColDef(),this.getDateComponentParams(),i,s=>{s.setInputAriaLabel(this.getAriaLabel(n))}),this.addDestroyFunc(()=>this.dateComp.destroy())}},kK={tag:"div",cls:"ag-filter-filter",children:[{tag:"ag-input-text-field",ref:"eDateInput",cls:"ag-date-filter"}]},PK=class extends Be{constructor(){super(kK,[tg]),this.eDateInput=U,this.isApply=!1,this.applyOnFocusOut=!1}init(e){this.params=e,this.setParams(e);let t=this.eDateInput.getInputElement();this.addManagedListeners(t,{mouseDown:()=>{this.eDateInput.isDisabled()||this.usingSafariDatePicker||t.focus({preventScroll:!0})},input:this.handleInput.bind(this,!1),change:this.handleInput.bind(this,!0),focusout:this.handleFocusOut.bind(this)})}handleInput(e){if(!this.eDateInput.isDisabled()){if(this.isApply){this.applyOnFocusOut=!e,e&&this.params.onDateChanged();return}e||this.params.onDateChanged()}}handleFocusOut(){this.applyOnFocusOut&&(this.applyOnFocusOut=!1,this.params.onDateChanged())}setParams(e){let t=this.eDateInput.getInputElement(),i=this.shouldUseBrowserDatePicker(e);this.usingSafariDatePicker=i&&po();let{minValidYear:n,maxValidYear:s,minValidDate:o,maxValidDate:r,buttons:a,includeTime:l,colDef:d}=e.filterParams||{},c=this.beans.dataTypeSvc,u=l??c?.getDateIncludesTimeFlag?.(d.cellDataType)??!1;if(i?u?(t.type="datetime-local",t.step="1"):t.type="date":t.type="text",o&&n&&I(85),r&&s&&I(86),o&&r){let[h,p]=[o,r].map(g=>g instanceof Date?g:Si(g));h&&p&&h.getTime()>p.getTime()&&I(87)}o?o instanceof Date?t.min=dv(o):t.min=o:n&&(t.min=`${n}-01-01`),r?r instanceof Date?t.max=dv(r):t.max=r:s&&(t.max=`${s}-12-31`),this.isApply=e.location==="floatingFilter"&&!!a?.includes("apply")}refresh(e){this.params=e,this.setParams(e)}getDate(){return Si(this.eDateInput.getValue())}setDate(e){let t=this.params.filterParams.colDef.cellDataType,i=this.beans.dataTypeSvc?.getDateIncludesTimeFlag(t)??!1;this.eDateInput.setValue(Ai(e,i))}setInputPlaceholder(e){this.eDateInput.setInputPlaceholder(e)}setInputAriaLabel(e){this.eDateInput.setAriaLabel(e)}setDisabled(e){this.eDateInput.setDisabled(e)}afterGuiAttached(e){e?.suppressFocus||this.eDateInput.getInputElement().focus({preventScroll:!0})}shouldUseBrowserDatePicker(e){return e?.filterParams?.browserDatePicker??!0}},Sw=["equals","notEqual","greaterThan","greaterThanOrEqual","lessThan","lessThanOrEqual","inRange","blank","notBlank"];function kv(e){let{allowedCharPattern:t}=e??{};return t??null}function Pv(e){return e==null||isNaN(e)?null:e}function CD(e,t){let{filter:i,filterTo:n,type:s}=e||{};return[Pv(i),Pv(n)].slice(0,Gd(s,t))}var FK=class extends ww{constructor(){super("numberFilter",CD,Sw),this.eValuesFrom=[],this.eValuesTo=[],this.filterType="number",this.defaultDebounceMs=500}setElementValue(e,t,i){let{numberFormatter:n}=this.params,s=!i&&n?n(t??null):t;super.setElementValue(e,s)}createEValue(){let e=kv(this.params),t=bt({tag:"div",cls:"ag-filter-body",role:"presentation"});return this.createFromToElement(t,this.eValuesFrom,"from",e),this.createFromToElement(t,this.eValuesTo,"to",e),t}createFromToElement(e,t,i,n){let s=this.createManagedBean(n?new gr({allowedCharPattern:n}):new Yv);s.addCss(`ag-filter-${i}`),s.addCss("ag-filter-filter"),t.push(s),e.appendChild(s.getGui())}removeEValues(e,t){let i=n=>this.removeComponents(n,e,t);i(this.eValuesFrom),i(this.eValuesTo)}getValues(e){let t=[];return this.forEachPositionInput(e,(i,n,s,o)=>{n<o&&t.push(Pv(this.stringToFloat(i.getValue())))}),t}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}stringToFloat(e){if(typeof e=="number")return e;let t=xs(e);t!=null&&t.trim()===""&&(t=null);let i=this.params.numberParser;return i?i(t):t==null||t.trim()==="-"?null:Number.parseFloat(t)}createCondition(e){let t=this.getConditionType(e),i={filterType:this.filterType,type:t},n=this.getValues(e);return n.length>0&&(i.filter=n[0]),n.length>1&&(i.filterTo=n[1]),i}getInputs(e){let{eValuesFrom:t,eValuesTo:i}=this;return e>=t.length?[null,null]:[t[e],i[e]]}hasInvalidInputs(){let e=!1;return this.forEachInput(t=>{t.getInputElement().validity.valid||(e=!0)}),e}},vD=class extends yw{constructor(e,t){super(e,t,t.numberFormatter),this.filterTypeKeys=gD}conditionToString(e,t,i,n,s){let{filter:o,filterTo:r,type:a}=e,l=this.formatValue.bind(this);if(t){let d=this.conditionForToolPanel(a,i,()=>l(o),()=>l(r),n,s);if(d!=null)return d}return i?`${l(o)}-${l(r)}`:o!=null?l(o):`${a}`}},TK=class extends pD{constructor(){super(CD,Sw),this.filterType="number",this.FilterModelFormatterClass=vD}comparator(){return(e,t)=>e===t?0:e<t?1:-1}isValid(e){return!isNaN(e)}},wD=class extends F{constructor(e){super(),this.params=e,this.eInput=U,this.onValueChanged=()=>{}}setupGui(e){this.eInput=this.createManagedBean(new gr(this.params?.config));let t=this.eInput.getGui();e.appendChild(t);let i=n=>this.onValueChanged(n);this.addManagedListeners(t,{input:i,keydown:i})}setEditable(e){this.eInput.setDisabled(!e)}getValue(){return this.eInput.getValue()}setValue(e,t){this.eInput.setValue(e,t)}setValueChangedListener(e){this.onValueChanged=e}setParams({ariaLabel:e,autoComplete:t}){let{eInput:i}=this;i.setInputAriaLabel(e),t!==void 0&&i.setAutoComplete(t)}};function Fv(e){let t=e?.trim();return t===""?e:t}function bD(e,t){let{filter:i,filterTo:n,type:s}=e||{};return[i||null,n||null].slice(0,Gd(s,t))}var AK={tag:"div",ref:"eFloatingFilterInputContainer",cls:"ag-floating-filter-input",role:"presentation"},yD=class extends mD{constructor(){super(...arguments),this.eFloatingFilterInputContainer=U,this.defaultDebounceMs=500}postConstruct(){this.setTemplate(AK)}onModelUpdated(e){this.setLastTypeFromModel(e),this.setEditable(this.canWeEditAfterModelFromParentFilter(e)),this.inputSvc.setValue(this.filterModelFormatter.getModelAsString(e))}setParams(e){this.setupFloatingFilterInputService(e),super.setParams(e),this.setTextInputParams(e)}setupFloatingFilterInputService(e){this.inputSvc=this.createFloatingFilterInputService(e),this.inputSvc.setupGui(this.eFloatingFilterInputContainer)}setTextInputParams(e){let t=e.browserAutoComplete??!1,{inputSvc:i,defaultDebounceMs:n,readOnly:s}=this;if(i.setParams({ariaLabel:this.getAriaLabel(e),autoComplete:t}),this.applyActive=ng(e.filterParams),!s){let o=tw(e.filterParams,n),r=qt(this,this.syncUpWithParentFilter.bind(this),o);i.setValueChangedListener(r)}}updateParams(e){super.updateParams(e),this.setTextInputParams(e)}recreateFloatingFilterInputService(e){let{inputSvc:t}=this,i=t.getValue();$t(this.eFloatingFilterInputContainer),this.destroyBean(t),this.setupFloatingFilterInputService(e),t.setValue(i,!0)}syncUpWithParentFilter(e){let t=e.key===k.ENTER,i=this.reactive;if(i&&this.params.onUiChange(),this.applyActive&&!t)return;let{inputSvc:n,params:s,lastType:o}=this,r=n.getValue();if(s.filterParams.trimInput&&(r=Fv(r),n.setValue(r,!0)),i){let a=s,l=a.model,d=this.convertValue(r),c=d==null?null:O(b({},l??{filterType:this.filterType,type:o??this.optionsFactory.defaultOption}),{filter:d});a.onModelChange(c,{afterFloatingFilter:!0})}else s.parentFilterInstance(a=>{a?.onFloatingFilterChanged(o||null,r||null)})}convertValue(e){return e||null}setEditable(e){this.inputSvc.setEditable(e)}},IK=class extends F{constructor(){super(...arguments),this.onValueChanged=()=>{},this.numberInputActive=!0}setupGui(e){this.eNumberInput=this.createManagedBean(new Yv),this.eTextInput=this.createManagedBean(new gr),this.eTextInput.setDisabled(!0);let t=this.eNumberInput.getGui(),i=this.eTextInput.getGui();e.appendChild(t),e.appendChild(i),this.setupListeners(t,n=>this.onValueChanged(n)),this.setupListeners(i,n=>this.onValueChanged(n))}setEditable(e){this.numberInputActive=e,this.eNumberInput.setDisplayed(this.numberInputActive),this.eTextInput.setDisplayed(!this.numberInputActive)}setAutoComplete(e){this.eNumberInput.setAutoComplete(e),this.eTextInput.setAutoComplete(e)}getValue(){return this.getActiveInputElement().getValue()}setValue(e,t){this.getActiveInputElement().setValue(e,t)}getActiveInputElement(){return this.numberInputActive?this.eNumberInput:this.eTextInput}setValueChangedListener(e){this.onValueChanged=e}setupListeners(e,t){this.addManagedListeners(e,{input:t,keydown:t})}setParams(e){this.setAriaLabel(e.ariaLabel),e.autoComplete!==void 0&&this.setAutoComplete(e.autoComplete)}setAriaLabel(e){this.eNumberInput.setInputAriaLabel(e),this.eTextInput.setInputAriaLabel(e)}},_K=class extends yD{constructor(){super(...arguments),this.FilterModelFormatterClass=vD,this.filterType="number",this.defaultOptions=Sw}updateParams(e){kv(e.filterParams)!==this.allowedCharPattern&&this.recreateFloatingFilterInputService(e),super.updateParams(e)}createFloatingFilterInputService(e){return this.allowedCharPattern=kv(e.filterParams),this.allowedCharPattern?this.createManagedBean(new wD({config:{allowedCharPattern:this.allowedCharPattern}})):this.createManagedBean(new IK)}convertValue(e){return e?Number(e):null}},xw=["contains","notContains","equals","notEqual","startsWith","endsWith","blank","notBlank"],LK=class extends ww{constructor(){super("textFilter",bD,xw),this.filterType="text",this.eValuesFrom=[],this.eValuesTo=[],this.defaultDebounceMs=500}createCondition(e){let t=this.getConditionType(e),i={filterType:this.filterType,type:t},n=this.getValues(e);return n.length>0&&(i.filter=n[0]),n.length>1&&(i.filterTo=n[1]),i}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getInputs(e){let{eValuesFrom:t,eValuesTo:i}=this;return e>=t.length?[null,null]:[t[e],i[e]]}getValues(e){let t=[];return this.forEachPositionInput(e,(i,n,s,o)=>{n<o&&t.push(xs(i.getValue()))}),t}createEValue(){let e=bt({tag:"div",cls:"ag-filter-body",role:"presentation"}),{eValuesFrom:t,eValuesTo:i}=this;return this.createFromToElement(e,t,"from"),this.createFromToElement(e,i,"to"),e}createFromToElement(e,t,i){let n=this.createManagedBean(new gr);n.addCss(`ag-filter-${i}`),n.addCss("ag-filter-filter"),t.push(n),e.appendChild(n.getGui())}removeEValues(e,t){let i=o=>this.removeComponents(o,e,t),{eValuesFrom:n,eValuesTo:s}=this;i(n),i(s)}},SD=class extends yw{constructor(){super(...arguments),this.filterTypeKeys=xK}conditionToString(e,t,i,n,s){let{filter:o,filterTo:r,type:a}=e;if(t){let l=c=>()=>so(this,"filterSummaryTextQuote",[c]),d=this.conditionForToolPanel(a,i,l(o),l(r),n,s);if(d!=null)return d}return i?`${o}-${r}`:o!=null?`${o}`:`${a}`}},OK=({filterOption:e,value:t,filterText:i})=>{if(i==null)return!1;switch(e){case"contains":return t.includes(i);case"notContains":return!t.includes(i);case"equals":return t===i;case"notEqual":return t!=i;case"startsWith":return t.indexOf(i)===0;case"endsWith":{let n=t.lastIndexOf(i);return n>=0&&n===t.length-i.length}default:return!1}},NK=e=>e,BK=e=>e==null?null:e.toString().toLowerCase(),HK=class extends hD{constructor(){super(bD,xw),this.filterType="text",this.FilterModelFormatterClass=SD}updateParams(e){super.updateParams(e);let t=e.filterParams;this.matcher=t.textMatcher??OK,this.formatter=t.textFormatter??(t.caseSensitive?NK:BK)}evaluateNullValue(e){return e?["notEqual","notContains","blank"].indexOf(e)>=0:!1}evaluateNonNullValue(e,t,i,n){let s=e.map(h=>this.formatter(h))||[],o=this.formatter(t),{api:r,colDef:a,column:l,context:d,filterParams:{textFormatter:c}}=this.params;if(i.type==="blank")return Jp(t);if(i.type==="notBlank")return!Jp(t);let u={api:r,colDef:a,column:l,context:d,node:n.node,data:n.data,filterOption:i.type,value:o,textFormatter:c};return s.some(h=>this.matcher(O(b({},u),{filterText:h})))}processModelToApply(e){if(e&&this.params.filterParams.trimInput){let t=i=>{let n=b({},i),{filter:s,filterTo:o}=i;return s&&(n.filter=Fv(s)??null),o&&(n.filterTo=Fv(o)??null),n};return oM(e)?O(b({},e),{conditions:e.conditions.map(t)}):t(e)}return e}},VK=class extends yD{constructor(){super(...arguments),this.FilterModelFormatterClass=SD,this.filterType="text",this.defaultOptions=xw}createFloatingFilterInputService(){return this.createManagedBean(new wD)}};function GK(e){return!!e.quickFilter?.isFilterPresent()}function zK(e){return e.quickFilter?.getText()}function WK(e){e.quickFilter?.resetCache()}var UK=class extends F{constructor(){super(...arguments),this.beanName="quickFilter",this.quickFilter=null,this.quickFilterParts=null}postConstruct(){let e=this.resetCache.bind(this),t=this.gos;this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:e,columnRowGroupChanged:e,columnVisible:()=>{t.get("includeHiddenColumnsInQuickFilter")||this.resetCache()}}),this.addManagedPropertyListener("quickFilterText",i=>this.setFilter(i.currentValue)),this.addManagedPropertyListeners(["includeHiddenColumnsInQuickFilter","applyQuickFilterBeforePivotOrAgg"],()=>this.onColumnConfigChanged()),this.quickFilter=this.parseFilter(t.get("quickFilterText")),this.parser=t.get("quickFilterParser"),this.matcher=t.get("quickFilterMatcher"),this.setFilterParts(),this.addManagedPropertyListeners(["quickFilterMatcher","quickFilterParser"],()=>this.setParserAndMatcher())}refreshCols(){let{autoColSvc:e,colModel:t,gos:i,pivotResultCols:n}=this.beans,s=t.isPivotMode(),o=e?.getColumns(),r=t.getColDefCols(),a=(s&&!i.get("applyQuickFilterBeforePivotOrAgg")?n?.getPivotResultCols()?.list:r)??[];o&&(a=a.concat(o)),this.colsToUse=i.get("includeHiddenColumnsInQuickFilter")?a:a.filter(l=>l.isVisible()||l.isRowGroupActive())}isFilterPresent(){return this.quickFilter!==null}doesRowPass(e){let t=this.gos.get("cacheQuickFilter");return this.matcher?this.doesRowPassMatcher(t,e):this.quickFilterParts.every(i=>t?this.doesRowPassCache(e,i):this.doesRowPassNoCache(e,i))}resetCache(){this.beans.rowModel.forEachNode(e=>e.quickFilterAggregateText=null)}getText(){return this.gos.get("quickFilterText")}setFilterParts(){let{quickFilter:e,parser:t}=this;e?this.quickFilterParts=t?t(e):e.split(" "):this.quickFilterParts=null}parseFilter(e){return K(e)?e.toUpperCase():null}setFilter(e){if(e!=null&&typeof e!="string"){I(70,{newFilter:e});return}let t=this.parseFilter(e);this.quickFilter!==t&&(this.quickFilter=t,this.setFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}setParserAndMatcher(){let e=this.gos.get("quickFilterParser"),t=this.gos.get("quickFilterMatcher"),i=e!==this.parser||t!==this.matcher;this.parser=e,this.matcher=t,i&&(this.setFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}onColumnConfigChanged(){this.refreshCols(),this.resetCache(),this.isFilterPresent()&&this.dispatchLocalEvent({type:"quickFilterChanged"})}doesRowPassNoCache(e,t){return this.colsToUse.some(i=>{let n=this.getTextForColumn(i,e);return K(n)&&n.includes(t)})}doesRowPassCache(e,t){return this.checkGenerateAggText(e),e.quickFilterAggregateText.includes(t)}doesRowPassMatcher(e,t){let i;e?(this.checkGenerateAggText(t),i=t.quickFilterAggregateText):i=this.getAggText(t);let{quickFilterParts:n,matcher:s}=this;return s(n,i)}checkGenerateAggText(e){e.quickFilterAggregateText||(e.quickFilterAggregateText=this.getAggText(e))}getTextForColumn(e,t){let i=this.beans.filterValueSvc.getValue(e,t),n=e.getColDef();if(n.getQuickFilterText){let s=ae(this.gos,{value:i,node:t,data:t.data,column:e,colDef:n});i=n.getQuickFilterText(s)}return K(i)?i.toString().toUpperCase():null}getAggText(e){let t=[];for(let i of this.colsToUse){let n=this.getTextForColumn(i,e);K(n)&&t.push(n)}return t.join(`
`)}},qK={moduleName:"ClientSideRowModelFilter",version:q,rowModels:["clientSide"],beans:[$j]},Ew={moduleName:"FilterCore",version:q,beans:[gK],apiFunctions:{isAnyFilterPresent:hK,onFilterChanged:pK},css:[Qj],dependsOn:[qK]},xD={moduleName:"FilterValue",version:q,beans:[mK]},lg={moduleName:"ColumnFilter",version:q,beans:[uK,fK],dynamicBeans:{headerFilterCellCtrl:jj},icons:{filter:"filter",filterActive:"filter"},apiFunctions:{isColumnFilterPresent:Zj,getColumnFilterInstance:eK,destroyFilter:tK,setFilterModel:iK,getFilterModel:nK,getColumnFilterModel:sK,setColumnFilterModel:oK,showColumnFilter:rK,hideColumnFilter:aK,getColumnFilterHandler:lK,doFilterAction:dK},dependsOn:[Ew,ag,xD,Xj]},$K={moduleName:"CustomFilter",version:q,userComponents:{agReadOnlyFloatingFilter:vK},dependsOn:[lg]},jK={moduleName:"TextFilter",version:q,dependsOn:[lg],userComponents:{agTextColumnFilter:{classImp:LK,params:{useForm:!0}},agTextColumnFloatingFilter:VK},dynamicBeans:{agTextColumnFilterHandler:HK}},KK={moduleName:"NumberFilter",version:q,dependsOn:[lg],userComponents:{agNumberColumnFilter:{classImp:FK,params:{useForm:!0}},agNumberColumnFloatingFilter:_K},dynamicBeans:{agNumberColumnFilterHandler:TK}},YK={moduleName:"DateFilter",version:q,dependsOn:[lg],userComponents:{agDateColumnFilter:{classImp:SK,params:{useForm:!0}},agDateInput:PK,agDateColumnFloatingFilter:DK},dynamicBeans:{agDateColumnFilterHandler:RK}},XK={moduleName:"QuickFilterCore",version:q,rowModels:["clientSide"],beans:[UK],dependsOn:[Ew,xD]},JK={moduleName:"QuickFilter",version:q,apiFunctions:{isQuickFilterPresent:GK,getQuickFilter:zK,resetQuickFilter:WK},dependsOn:[XK]},QK={moduleName:"ExternalFilter",version:q,dependsOn:[Ew]},ZK=".ag-tooltip{background-color:var(--ag-tooltip-background-color);border:var(--ag-tooltip-border);border-radius:var(--ag-border-radius);color:var(--ag-tooltip-text-color);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);position:absolute;white-space:normal;z-index:99999;&:where(.ag-cell-editor-tooltip){background-color:var(--ag-tooltip-error-background-color);border:var(--ag-tooltip-error-border);color:var(--ag-tooltip-error-text-color);font-weight:500}}.ag-tooltip-custom{position:absolute;z-index:99999}.ag-tooltip-custom:where(:not(.ag-tooltip-interactive)),.ag-tooltip:where(:not(.ag-tooltip-interactive)){pointer-events:none}.ag-tooltip-animate{transition:opacity 1s;&:where(.ag-tooltip-hiding){opacity:0}}",YC=(e,t,i)=>{let{editModelSvc:n}=e,s=n?.getCellValidationModel()?.getCellValidation(t)?.errorMessages,o=n?.getRowValidationModel().getRowValidation(t)?.errorMessages,r=s||o;return r?.length?r.join(i("tooltipValidationErrorSeparator",". ")):void 0},eY=class extends F{constructor(){super(...arguments),this.beanName="tooltipSvc"}setupHeaderTooltip(e,t,i,n){e&&t.destroyBean(e);let s=this.gos,o=KC(s),{column:r,eGui:a}=t,l=r.getColDef();!n&&o&&!l.headerComponent&&(n=vp(()=>a.querySelector(".ag-header-cell-text")));let d="header",u=this.beans.colNames.getDisplayNameForColumn(r,"header",!0),h=i??u,p={getGui:()=>a,getLocation:()=>d,getTooltipValue:()=>i??l?.headerTooltipValueGetter?.(ae(s,{location:d,colDef:l,column:r,value:h,valueFormatted:u}))??l?.headerTooltip,shouldDisplayTooltip:n,getAdditionalParams:()=>({column:r,colDef:r.getColDef()})},g=this.createTooltipFeature(p);return g&&(g=t.createBean(g),t.setRefreshFunction("tooltip",()=>g.refreshTooltip())),g}setupHeaderGroupTooltip(e,t,i,n){e&&t.destroyBean(e);let s=this.gos,o=KC(s),{column:r,eGui:a}=t,l=r.getColGroupDef();!n&&o&&!l?.headerGroupComponent&&(n=vp(()=>a.querySelector(".ag-header-group-text")));let d="headerGroup",u=this.beans.colNames.getDisplayNameForColumnGroup(r,"header"),h=i??u,p={getGui:()=>a,getLocation:()=>d,getTooltipValue:()=>i??l?.headerTooltipValueGetter?.(ae(s,{location:d,colDef:l,column:r,value:h,valueFormatted:u}))??l?.headerTooltip,shouldDisplayTooltip:n,getAdditionalParams:()=>{let f={column:r};return l&&(f.colDef=l),f}},g=this.createTooltipFeature(p);return g&&t.createBean(g)}enableCellTooltipFeature(e,t,i){let{beans:n}=this,{gos:s,editSvc:o}=n,{column:r,rowNode:a}=e,l="cell",d=()=>{let p=!!!o?.isEditing(e)&&YC(n,e,this.getLocaleTextFunc());if(p)return l="cellEditor",p;l="cell";let g=r.getColDef(),f=a.data;if(g.tooltipField&&K(f))return Md(f,g.tooltipField,r.isTooltipFieldContainsDots());let m=g.tooltipValueGetter;return m?m(ae(s,{location:"cell",colDef:r.getColDef(),column:r,rowIndex:e.cellPosition.rowIndex,node:a,data:a.data,value:e.value,valueFormatted:e.valueFormatted})):null},c=KC(s);i||(c&&!e.isCellRenderer()?i=()=>{let h=!!o?.isEditing(e);if(!h&&YC(n,e,this.getLocaleTextFunc()))return!0;if(!r.isTooltipEnabled())return!1;let f=vp(()=>{let m=e.eGui;return m.children.length===0?m:m.querySelector(".ag-cell-value")});return!h&&f()}:i=()=>!o?.isEditing(e));let u={getGui:()=>e.eGui,getLocation:()=>l,getTooltipValue:t!=null?()=>t:d,shouldDisplayTooltip:i,getAdditionalParams:()=>({column:r,colDef:r.getColDef(),rowIndex:e.cellPosition.rowIndex,node:a,data:a.data,valueFormatted:e.valueFormatted})};return this.createTooltipFeature(u,n)}setupFullWidthRowTooltip(e,t,i,n){let s={getGui:()=>t.getFullWidthElement(),getTooltipValue:()=>i,getLocation:()=>"fullWidthRow",shouldDisplayTooltip:n},o=this.beans,r=o.context;e&&t.destroyBean(e,r);let a=this.createTooltipFeature(s,o);if(a)return t.createBean(a,r)}setupCellEditorTooltip(e,t){let{beans:i}=this,{context:n}=i,s=t.getValidationElement?.(!0)||!t.isPopup?.()&&e.eGui;if(!s)return;let o={getGui:()=>s,getTooltipValue:()=>YC(i,e,this.getLocaleTextFunc()),getLocation:()=>"cellEditor",shouldDisplayTooltip:()=>{let{editModelSvc:a}=i,l=a?.getRowValidationModel()?.getRowValidationMap(),d=a?.getCellValidationModel()?.getCellValidationMap(),c=!!l&&l.size>0,u=!!d&&d.size>0;return c||u}},r=this.createTooltipFeature(o,i);if(r)return e.createBean(r,n)}initCol(e){let{colDef:t}=e;e.tooltipEnabled=K(t.tooltipField)||K(t.tooltipValueGetter)||K(t.tooltipComponent)}createTooltipFeature(e,t){return this.beans.registry.createDynamicBean("tooltipFeature",!1,e,t)}},tY=class extends kH{createTooltipComp(e,t){bB(this.beans.userCompFactory,e)?.newAgStackInstance().then(t)}setEventHandlers(e){[this.onColumnMovedEventCallback]=this.addManagedEventListeners({columnMoved:e})}clearEventHandlers(){this.onColumnMovedEventCallback?.(),this.onColumnMovedEventCallback=void 0}},ED={moduleName:"Tooltip",version:q,beans:[eY],dynamicBeans:{tooltipFeature:Y4,highlightTooltipFeature:PH,tooltipStateManager:tY},userComponents:{agTooltipComponent:AH},dependsOn:[ag],css:[ZK]},ya=class{constructor(e){this.cellValueChanges=e}},XC=class extends ya{constructor(e,t,i,n){super(e),this.initialRange=t,this.finalRange=i,this.ranges=n}},iY=10,y6=class{constructor(e){this.actionStack=[],this.maxStackSize=e||iY,this.actionStack=new Array(this.maxStackSize)}pop(){return this.actionStack.pop()}push(e){e.cellValueChanges&&e.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(e))}clear(){this.actionStack=[]}getCurrentStackSize(){return this.actionStack.length}},nY=class extends F{constructor(){super(...arguments),this.beanName="undoRedo",this.cellValueChanges=[],this.activeCellEdit=null,this.activeRowEdit=null,this.isPasting=!1,this.isRangeInAction=!1,this.batchEditing=!1,this.bulkEditing=!1,this.onCellValueChanged=e=>{let t={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned},i=this.activeCellEdit!==null&&RM(this.activeCellEdit,t),n=this.activeRowEdit!==null&&kz(this.activeRowEdit,t);if(!(i||n||this.isPasting||this.isRangeInAction))return;let{rowPinned:o,rowIndex:r,column:a,oldValue:l,value:d}=e,c={rowPinned:o,rowIndex:r,columnId:a.getColId(),newValue:d,oldValue:l};this.cellValueChanges.push(c)},this.clearStacks=()=>{this.undoStack.clear(),this.redoStack.clear()}}postConstruct(){let{gos:e,ctrlsSvc:t}=this.beans;if(!e.get("undoRedoCellEditing"))return;let i=e.get("undoRedoCellEditingLimit");if(i<=0)return;this.undoStack=new y6(i),this.redoStack=new y6(i),this.addListeners();let n=this.clearStacks.bind(this);this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this),modelUpdated:s=>{s.keepUndoRedoStack||this.clearStacks()},columnPivotModeChanged:n,newColumnsLoaded:n,columnGroupOpened:n,columnRowGroupChanged:n,columnMoved:n,columnPinned:n,columnVisible:n,rowDragEnd:n}),t.whenReady(this,s=>{this.gridBodyCtrl=s.gridBodyCtrl})}getCurrentUndoStackSize(){return this.undoStack?.getCurrentStackSize()??0}getCurrentRedoStackSize(){return this.redoStack?.getCurrentStackSize()??0}undo(e){let{eventSvc:t,undoStack:i,redoStack:n}=this;t.dispatchEvent({type:"undoStarted",source:e});let s=this.undoRedo(i,n,"initialRange","oldValue","undo");t.dispatchEvent({type:"undoEnded",source:e,operationPerformed:s})}redo(e){let{eventSvc:t,undoStack:i,redoStack:n}=this;t.dispatchEvent({type:"redoStarted",source:e});let s=this.undoRedo(n,i,"finalRange","newValue","redo");t.dispatchEvent({type:"redoEnded",source:e,operationPerformed:s})}undoRedo(e,t,i,n,s){if(!e)return!1;let o=e.pop();return o?.cellValueChanges?(this.processAction(o,r=>r[n],s),o instanceof XC?this.processRange(o.ranges||[o[i]]):this.processCell(o.cellValueChanges),t.push(o),!0):!1}processAction(e,t,i){for(let n of e.cellValueChanges){let{rowIndex:s,rowPinned:o,columnId:r}=n,a={rowIndex:s,rowPinned:o},l=ks(this.beans,a);l.displayed&&l.setDataValue(r,t(n),i)}}processRange(e){let t,i=this.beans.rangeSvc;i.removeAllCellRanges(!0),e.forEach((n,s)=>{if(!n)return;let o=n.startRow,r=n.endRow;s===e.length-1&&(t={rowPinned:o.rowPinned,rowIndex:o.rowIndex,columnId:n.startColumn.getColId()},this.setLastFocusedCell(t));let a={rowStartIndex:o.rowIndex,rowStartPinned:o.rowPinned,rowEndIndex:r.rowIndex,rowEndPinned:r.rowPinned,columnStart:n.startColumn,columns:n.columns};i.addCellRange(a)})}processCell(e){let t=e[0],{rowIndex:i,rowPinned:n}=t,s={rowIndex:i,rowPinned:n},o=ks(this.beans,s),r={rowPinned:t.rowPinned,rowIndex:o.rowIndex,columnId:t.columnId};this.setLastFocusedCell(r)}setLastFocusedCell(e){let{rowIndex:t,columnId:i,rowPinned:n}=e,{colModel:s,focusSvc:o,rangeSvc:r}=this.beans,a=s.getCol(i);if(!a)return;let{scrollFeature:l}=this.gridBodyCtrl;l.ensureIndexVisible(t),l.ensureColumnVisible(a);let d={rowIndex:t,column:a,rowPinned:n};o.setFocusedCell(O(b({},d),{forceBrowserFocus:!0})),r?.setRangeToCell(d)}addListeners(){this.addManagedEventListeners({rowEditingStarted:e=>{this.activeRowEdit={rowIndex:e.rowIndex,rowPinned:e.rowPinned}},rowEditingStopped:()=>{let e=new ya(this.cellValueChanges);this.pushActionsToUndoStack(e),this.activeRowEdit=null},cellEditingStarted:e=>{this.activeCellEdit={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned}},cellEditingStopped:e=>{if(this.activeCellEdit=null,e.valueChanged&&!this.activeRowEdit&&!this.isPasting&&!this.isRangeInAction){let i=new ya(this.cellValueChanges);this.pushActionsToUndoStack(i)}},pasteStart:()=>{this.isPasting=!0},pasteEnd:()=>{let e=new ya(this.cellValueChanges);this.pushActionsToUndoStack(e),this.isPasting=!1},fillStart:()=>{this.isRangeInAction=!0},fillEnd:e=>{let t=new XC(this.cellValueChanges,e.initialRange,e.finalRange);this.pushActionsToUndoStack(t),this.isRangeInAction=!1},keyShortcutChangedCellStart:()=>{this.isRangeInAction=!0},keyShortcutChangedCellEnd:()=>{let e,{rangeSvc:t,gos:i}=this.beans;t&&Ds(i)?e=new XC(this.cellValueChanges,void 0,void 0,[...t.getCellRanges()]):e=new ya(this.cellValueChanges),this.pushActionsToUndoStack(e),this.isRangeInAction=!1},batchEditingStarted:()=>this.startBigChange("batchEditing"),batchEditingStopped:({changes:e})=>this.stopBigChange("batchEditing",e),bulkEditingStarted:()=>this.startBigChange("bulkEditing"),bulkEditingStopped:({changes:e})=>this.stopBigChange("bulkEditing",e)})}startBigChange(e){this.updateBigChange(e,!0)}updateBigChange(e,t){e==="bulkEditing"?this.bulkEditing=t:this.batchEditing=t}stopBigChange(e,t){if(e==="bulkEditing"&&!this.bulkEditing||e==="batchEditing"&&!this.batchEditing||(this.updateBigChange(e,!1),t?.length===0))return;let i=new ya(t??[]);this.pushActionsToUndoStack(i),this.cellValueChanges=[]}pushActionsToUndoStack(e){this.undoStack.push(e),this.cellValueChanges=[],this.redoStack.clear()}},sY=".ag-cell-inline-editing{border:var(--ag-cell-editing-border)!important;border-radius:var(--ag-border-radius);box-shadow:var(--ag-cell-editing-shadow);padding:0;z-index:1;.ag-cell-edit-wrapper,.ag-cell-editor,.ag-cell-wrapper,:where(.ag-cell-editor) .ag-input-field-input,:where(.ag-cell-editor) .ag-wrapper{height:100%;line-height:normal;min-height:100%;width:100%}&.ag-cell-editing-error{border-color:var(--ag-invalid-color)!important}}:where(.ag-popup-editor) .ag-large-text{background-color:var(--ag-background-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);padding:0}.ag-large-text-input{display:block;height:auto;padding:var(--ag-cell-horizontal-padding)}:where(.ag-rtl .ag-large-text-input) textarea{resize:none}:where(.ag-ltr) .ag-checkbox-edit{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-checkbox-edit{padding-right:var(--ag-cell-horizontal-padding)}:where(.ag-row.ag-row-editing-invalid .ag-cell-inline-editing){opacity:.8}.ag-popup-editor{position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}",oY={tag:"div",cls:"ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit",children:[{tag:"ag-checkbox",ref:"eEditor",role:"presentation"}]},rY=class extends og{constructor(){super(oY,[Kv]),this.eEditor=U}initialiseEditor(e){let t=e.value??void 0,i=this.eEditor;i.setValue(t),i.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(t),this.addManagedListeners(i,{fieldValueChanged:s=>this.setAriaLabel(s.selected)})}getValue(){return this.eEditor.getValue()}focusIn(){this.eEditor.getFocusableElement().focus()}afterGuiAttached(){this.params.cellStartedEdit&&this.focusIn()}isPopup(){return!1}setAriaLabel(e){let t=this.getLocaleTextFunc(),i=Zp(t,e),n=t("ariaToggleCellValue","Press SPACE to toggle cell value");this.eEditor.setInputAriaLabel(`${n} (${i})`)}getValidationElement(e){return e?this.params.eGridCell:this.eEditor.getInputElement()}getValidationErrors(){let{params:e}=this,{getValidationErrors:t}=e,i=this.getValue();return t?t({value:i,internalErrors:null,cellEditorParams:e}):null}},dg=class extends og{constructor(e){super(),this.cellEditorInput=e,this.eEditor=U}initialiseEditor(e){let{cellEditorInput:t}=this;this.setTemplate({tag:"div",cls:"ag-cell-edit-wrapper",children:[t.getTemplate()]},t.getAgComponents());let{eEditor:i}=this,{cellStartedEdit:n,eventKey:s,suppressPreventDefault:o}=e;i.getInputElement().setAttribute("title",""),t.init(i,e);let r,a=!0;n?(this.focusAfterAttached=!0,s===k.BACKSPACE||s===k.DELETE?r="":s&&s.length===1?o?a=!1:r=s:(r=t.getStartValue(),s!==k.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,r=t.getStartValue()),a&&r!=null&&i.setStartValue(r),this.addGuiEventListener("keydown",l=>{let{key:d}=l;(d===k.PAGE_UP||d===k.PAGE_DOWN)&&l.preventDefault()})}afterGuiAttached(){let e=this.getLocaleTextFunc(),t=this.eEditor;if(t.setInputAriaLabel(e("ariaInputEditor","Input Editor")),!this.focusAfterAttached)return;po()||t.getFocusableElement().focus();let i=t.getInputElement();this.highlightAllOnFocus?i.select():this.cellEditorInput.setCaret?.()}focusIn(){let{eEditor:e}=this,t=e.getFocusableElement(),i=e.getInputElement();t.focus(),i.select()}getValue(){return this.cellEditorInput.getValue()}isPopup(){return!1}getValidationElement(){return this.eEditor.getInputElement()}getValidationErrors(){return this.cellEditorInput.getValidationErrors()}},aY={tag:"ag-input-date-field",ref:"eEditor",cls:"ag-cell-editor"},lY=class{constructor(e,t){this.getDataTypeService=e,this.getLocaleTextFunc=t}getTemplate(){return aY}getAgComponents(){return[V4]}init(e,t){this.eEditor=e,this.params=t;let{min:i,max:n,step:s,colDef:o}=t;i!=null&&e.setMin(i),n!=null&&e.setMax(n),s!=null&&e.setStep(s),this.includeTime=t.includeTime??this.getDataTypeService()?.getDateIncludesTimeFlag?.(o.cellDataType),this.includeTime!=null&&e.setIncludeTime(this.includeTime)}getValidationErrors(){let t=this.eEditor.getInputElement().valueAsDate,{params:i}=this,{min:n,max:s,getValidationErrors:o}=i,r=[],a=this.getLocaleTextFunc();if(t instanceof Date&&!isNaN(t.getTime())){if(n){let l=n instanceof Date?n:new Date(n);if(t<l){let d=l.toLocaleDateString();r.push(a("minDateValidation",`Date must be after ${d}`,[d]))}}if(s){let l=s instanceof Date?s:new Date(s);if(t>l){let d=l.toLocaleDateString();r.push(a("maxDateValidation",`Date must be before ${d}`,[d]))}}}return r.length||(r=null),o?o({value:t,cellEditorParams:i,internalErrors:r}):r}getValue(){let{eEditor:e,params:t}=this,i=e.getDate();return!K(i)&&!K(t.value)?t.value:i??null}getStartValue(){let{value:e}=this.params;if(e instanceof Date)return Ai(e,this.includeTime??!1)}},dY=class extends dg{constructor(){super(new lY(()=>this.beans.dataTypeSvc,()=>this.getLocaleTextFunc()))}},cY={tag:"ag-input-date-field",ref:"eEditor",cls:"ag-cell-editor"},uY=class{constructor(e,t){this.getDataTypeService=e,this.getLocaleTextFunc=t}getTemplate(){return cY}getAgComponents(){return[V4]}init(e,t){this.eEditor=e,this.params=t;let{min:i,max:n,step:s,colDef:o}=t;i!=null&&e.setMin(i),n!=null&&e.setMax(n),s!=null&&e.setStep(s),this.includeTime=t.includeTime??this.getDataTypeService()?.getDateIncludesTimeFlag?.(o.cellDataType),this.includeTime!=null&&e.setIncludeTime(this.includeTime)}getValidationErrors(){let{eEditor:e,params:t}=this,i=e.getInputElement().value,n=this.formatDate(this.parseDate(i??void 0)),{min:s,max:o,getValidationErrors:r}=t,a=[];if(n){let l=new Date(n),d=this.getLocaleTextFunc();if(s){let c=new Date(s);if(l<c){let u=c.toLocaleDateString();a.push(d("minDateValidation",`Date must be after ${u}`,[u]))}}if(o){let c=new Date(o);if(l>c){let u=c.toLocaleDateString();a.push(d("maxDateValidation",`Date must be before ${u}`,[u]))}}}return a.length||(a=null),r?r({value:this.getValue(),cellEditorParams:t,internalErrors:a}):a}getValue(){let{params:e,eEditor:t}=this,i=this.formatDate(t.getDate());return!K(i)&&!K(e.value)?e.value:e.parseValue(i??"")}getStartValue(){return Ai(this.parseDate(this.params.value??void 0)??null,this.includeTime??!1)}parseDate(e){let t=this.getDataTypeService();return t?t.getDateParserFunction(this.params.column)(e):Si(e)??void 0}formatDate(e){let t=this.getDataTypeService();return t?t.getDateFormatterFunction(this.params.column)(e):Ai(e??null,this.includeTime??!1)??void 0}},hY=class extends dg{constructor(){super(new uY(()=>this.beans.dataTypeSvc,()=>this.getLocaleTextFunc()))}},pY={tag:"div",cls:"ag-large-text",children:[{tag:"ag-input-text-area",ref:"eEditor",cls:"ag-large-text-input"}]},gY=class extends og{constructor(){super(pY,[BB]),this.eEditor=U}initialiseEditor(e){let{eEditor:t}=this,{cellStartedEdit:i,eventKey:n,maxLength:s,cols:o,rows:r}=e;this.focusAfterAttached=i,t.getInputElement().setAttribute("title",""),t.setMaxLength(s||200).setCols(o||60).setRows(r||10);let a;i?(this.focusAfterAttached=!0,n===k.BACKSPACE||n===k.DELETE?a="":n&&n.length===1?a=n:(a=this.getStartValue(e),n!==k.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,a=this.getStartValue(e)),a!=null&&t.setValue(a,!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()}getStartValue(e){let{value:t}=e;return t?.toString()??t}onKeyDown(e){let t=e.key;(t===k.LEFT||t===k.UP||t===k.RIGHT||t===k.DOWN||e.shiftKey&&t===k.ENTER)&&e.stopPropagation()}afterGuiAttached(){let{eEditor:e,focusAfterAttached:t,highlightAllOnFocus:i}=this,n=this.getLocaleTextFunc();e.setInputAriaLabel(n("ariaInputEditor","Input Editor")),t&&(e.getFocusableElement().focus(),i&&e.getInputElement().select())}getValue(){let{eEditor:e,params:t}=this,{value:i}=t,n=e.getValue();return!K(n)&&!K(i)?i:t.parseValue(n)}getValidationElement(){return this.eEditor.getInputElement()}getValidationErrors(){let{params:e}=this,{maxLength:t,getValidationErrors:i}=e,n=this.getLocaleTextFunc(),s=this.getValue(),o=[];return typeof s=="string"&&t!=null&&s.length>t&&o.push(n("maxLengthValidation",`Must be ${t} characters or fewer.`,[String(t)])),o.length||(o=null),i?i({value:s,internalErrors:o,cellEditorParams:e}):o}},fY={tag:"ag-input-number-field",ref:"eEditor",cls:"ag-cell-editor"},mY=class{constructor(e){this.getLocaleTextFunc=e}getTemplate(){return fY}getAgComponents(){return[HB]}init(e,t){this.eEditor=e,this.params=t;let{max:i,min:n,precision:s,step:o}=t;i!=null&&e.setMax(i),n!=null&&e.setMin(n),s!=null&&e.setPrecision(s),o!=null&&e.setStep(o);let r=e.getInputElement();t.preventStepping?e.addManagedElementListeners(r,{keydown:this.preventStepping}):t.showStepperButtons&&r.classList.add("ag-number-field-input-stepper")}getValidationErrors(){let{params:e}=this,{min:t,max:i,getValidationErrors:n}=e,o=this.eEditor.getInputElement().valueAsNumber,r=this.getLocaleTextFunc(),a=[];return typeof o=="number"&&(t!=null&&o<t&&a.push(r("minValueValidation",`Must be greater than or equal to ${t}.`,[String(t)])),i!=null&&o>i&&a.push(r("maxValueValidation",`Must be less than or equal to ${i}.`,[String(i)]))),a.length||(a=null),n?n({value:o,cellEditorParams:e,internalErrors:a}):a}preventStepping(e){(e.key===k.UP||e.key===k.DOWN)&&e.preventDefault()}getValue(){let{eEditor:e,params:t}=this,i=e.getValue();if(!K(i)&&!K(t.value))return t.value;let n=t.parseValue(i);if(n==null)return n;if(typeof n=="string"){if(n==="")return null;n=Number(n)}return isNaN(n)?null:n}getStartValue(){return this.params.value}setCaret(){po()&&this.eEditor.getInputElement().focus({preventScroll:!0})}},CY=class extends dg{constructor(){super(new mY(()=>this.getLocaleTextFunc()))}},vY={tag:"div",cls:"ag-cell-edit-wrapper",children:[{tag:"ag-select",ref:"eEditor",cls:"ag-cell-editor"}]},wY=class extends og{constructor(){super(vY,[XB]),this.eEditor=U,this.startedByEnter=!1}wireBeans(e){this.valueSvc=e.valueSvc}initialiseEditor(e){this.focusAfterAttached=e.cellStartedEdit;let{eEditor:t,valueSvc:i,gos:n}=this,{values:s,value:o,eventKey:r}=e;if(tt(s)){I(58);return}this.startedByEnter=r!=null?r===k.ENTER:!1;let a=!1;s.forEach(u=>{let h={value:u},p=i.formatValue(e.column,null,u),g=p!=null;h.text=g?p:u,t.addOption(h),a=a||o===u}),a?t.setValue(e.value,!0):e.values.length&&t.setValue(e.values[0],!0);let{valueListGap:l,valueListMaxWidth:d,valueListMaxHeight:c}=e;l!=null&&t.setPickerGap(l),c!=null&&t.setPickerMaxHeight(c),d!=null&&t.setPickerMaxWidth(d),n.get("editType")!=="fullRow"&&this.addManagedListeners(this.eEditor,{selectedItem:()=>e.stopEditing()})}afterGuiAttached(){this.focusAfterAttached&&this.eEditor.getFocusableElement().focus(),this.startedByEnter&&setTimeout(()=>{this.isAlive()&&this.eEditor.showPicker()})}focusIn(){this.eEditor.getFocusableElement().focus()}getValue(){return this.eEditor.getValue()}isPopup(){return!1}getValidationElement(){return this.eEditor.getAriaElement()}getValidationErrors(){let{params:e}=this,{values:t,getValidationErrors:i}=e,n=this.getValue(),s=[];if(t&&!t.includes(n)){let o=this.getLocaleTextFunc();s.push(o("invalidSelectionValidation","Invalid selection."))}else s=null;return i?i({value:n,internalErrors:s,cellEditorParams:e}):s}},bY={tag:"ag-input-text-field",ref:"eEditor",cls:"ag-cell-editor"},yY=class{constructor(e){this.getLocaleTextFunc=e}getTemplate(){return bY}getAgComponents(){return[tg]}init(e,t){this.eEditor=e,this.params=t;let i=t.maxLength;i!=null&&e.setMaxLength(i)}getValidationErrors(){let{params:e}=this,{maxLength:t,getValidationErrors:i}=e,n=this.getValue(),s=this.getLocaleTextFunc(),o=[];return t!=null&&typeof n=="string"&&n.length>t&&o.push(s("maxLengthValidation",`Must be ${t} characters or fewer.`,[String(t)])),o.length||(o=null),i?i({value:n,cellEditorParams:e,internalErrors:o}):o}getValue(){let{eEditor:e,params:t}=this,i=e.getValue();return!K(i)&&!K(t.value)?t.value:t.parseValue(i)}getStartValue(){let e=this.params;return e.useFormatter||e.column.getColDef().refData?e.formatValue(e.value):e.value}setCaret(){po()&&this.eEditor.getInputElement().focus({preventScroll:!0});let e=this.eEditor,t=e.getValue(),i=K(t)&&t.length||0;i&&e.getInputElement().setSelectionRange(i,i)}},S6=class extends dg{constructor(){super(new yY(()=>this.getLocaleTextFunc()))}};function SY(e){return e.ctrlsSvc.getScrollFeature().getVScrollPosition()}function xY(e){return e.ctrlsSvc.getScrollFeature().getHScrollPosition()}function RD(e,t,i="auto"){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureColumnVisible(t,i),"ensureVisible")}function MD(e,t,i){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureIndexVisible(t,i),"ensureVisible")}function EY(e,t,i=null){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureNodeVisible(t,i),"ensureVisible")}function RY(e){e.undoRedo?.undo("api")}function MY(e){e.undoRedo?.redo("api")}function DY(e,t){return e.editModelSvc?.getEditRowDataValue(t,{checkSiblings:!0})}function kY(e){let t=e.editModelSvc?.getEditMap(),i=[];return t?.forEach((n,s)=>{let{rowIndex:o,rowPinned:r}=s;n.forEach((a,l)=>{let{editorValue:d,pendingValue:c,sourceValue:u,state:h}=a,p=Ss(a),g=d??c;g===Ki&&(g=void 0);let f={newValue:g,oldValue:u,state:h,column:l,colId:l.getColId(),colKey:l.getColId(),rowIndex:o,rowPinned:r};(h==="editing"||h==="changed"&&p)&&i.push(f)})}),i}function PY(e,t=!1){let{editSvc:i}=e;if(i?.isBatchEditing()){if(t)for(let n of e.editModelSvc?.getEditPositions()??[])n.state==="editing"&&i.revertSingleCellEdit(n);else Zo(e,{persist:!0});La(e,void 0,{cancel:t})}else i?.stopEditing(void 0,{cancel:t,source:"edit",forceStop:!t,forceCancel:t})}function FY(e,t){let i=st(e,t);return e.editSvc?.isEditing(i)??!1}function TY(e,t){let{key:i,colKey:n,rowIndex:s,rowPinned:o}=t,{editSvc:r,colModel:a}=e,l=a.getCol(n);if(!l){I(12,{colKey:n});return}let c=ks(e,{rowIndex:s,rowPinned:o||null,column:l});if(!c){I(290,{rowIndex:s,rowPinned:o});return}if(!l.isCellEditable(c))return;o==null&&MD(e,s),RD(e,n),r?.startEditing({rowNode:c,column:l},{event:i?new KeyboardEvent("keydown",{key:i}):void 0,source:"api"})}function AY(e){return e.editSvc?.validateEdit()||null}function IY(e){return e.undoRedo?.getCurrentUndoStackSize()??0}function _Y(e){return e.undoRedo?.getCurrentRedoStackSize()??0}var LY={tag:"div",cls:"ag-popup-editor",attrs:{tabindex:"-1"}},OY=class extends qv{constructor(e){super(LY),this.params=e}postConstruct(){ar(this.gos,this.getGui(),"popupEditorWrapper",!0),this.addKeyDownListener()}addKeyDownListener(){let e=this.getGui(),t=this.params,i=n=>{Cv(this.gos,n,t.node,t.column,!0)||t.onKeyDown(n)};this.addManagedElementListeners(e,{keydown:i})}};function NY(e,{column:t},i,n,s="ui"){if(i instanceof KeyboardEvent&&(i.key===k.TAB||i.key===k.ENTER||i.key===k.F2||i.key===k.BACKSPACE&&n))return!0;if(i?.shiftKey&&e.rangeSvc?.getCellRanges().length!=0)return!1;let r=t?.getColDef(),a=BY(e.gos,r),l=i?.type;return l==="click"&&i?.detail===1&&a===1||l==="dblclick"&&i?.detail===2&&a===2?!0:s==="api"?n??!1:!1}function BY(e,t){return e.get("suppressClickEdit")===!0?0:e.get("singleClickEdit")===!0||t?.singleClickEdit?1:2}function Tv(e,{rowNode:t,column:i},n="ui"){let s=i.getColDef().editable,o=e.editModelSvc;return i.isColumnFunc(t,s)||!!o&&o.hasEdits({rowNode:t,column:i},{withOpenEditor:!0})}function HY(e,t,i="ui"){let n=Tv(e,t,i);return n===!0||i==="ui"?n:e.colModel.getCols().some(o=>Tv(e,{rowNode:t.rowNode,column:o},i))}var Qp=(e,t=!1)=>{if(e!==void 0)return Ss(e)||t&&e.state==="editing"};function DD(e,t,i=!1){return Qp(e.editModelSvc?.getEdit(t),i)}var kD=(e,t,i)=>{if(e)for(let n=0,s=e.length;n<s;++n){let o=e[n];if(o.data&&(Qp(t?.getEdit({rowNode:o,column:i}))||Qp(t?.getEdit({rowNode:o.pinnedSibling,column:i})))||kD(o.childrenAfterGroup,t,i))return!0}};function PD(e,t){let{column:i,rowNode:n}=t;return e.gos.get("groupTotalRow")&&!n?.footer?!1:kD(n?.childrenAfterGroup,e.editModelSvc,i)}function FD(e,{rowNode:t,column:i}){if(t=t.pinnedSibling,!!t)return Qp(e.editModelSvc?.getEdit({rowNode:t,column:i}))}var VY=class extends F{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.editSvc=t.editSvc,this.editModelSvc=t.editModelSvc}setComp(e){this.cellComp=e,this.applyCellStyles()}applyCellStyles(){let{cellCtrl:e,editSvc:t,beans:i}=this;if(t?.isBatchEditing()&&t.isEditing()){let s=DD(i,e)||PD(i,e)||FD(i,e);this.applyBatchingStyle(s)}else this.applyBatchingStyle(!1);let n=!!this.editModelSvc?.getCellValidationModel().hasCellValidation(this.cellCtrl);this.cellComp.toggleCss("ag-cell-editing-error",n)}applyBatchingStyle(e){this.cellComp.toggleCss("ag-cell-editing",e??!1),this.cellComp.toggleCss("ag-cell-batch-edit",(e&&this.editSvc?.isBatchEditing())??!1)}},GY=class extends F{constructor(e,t){super(),this.rowCtrl=e,this.beans=t,this.gos=t.gos,this.editSvc=t.editSvc,this.editModelSvc=t.editModelSvc}applyRowStyles(){let{rowCtrl:e,editModelSvc:t,beans:i}=this,n=e.rowNode,s=t?.getEditRow(n),o=this.editModelSvc?.getRowValidationModel().hasRowValidation({rowNode:n});if(!s&&n.pinnedSibling&&(n=n.pinnedSibling,s=t?.getEditRow(n)),s){let r=Array.from(s.keys()).some(a=>{let l={rowNode:n,column:a};return DD(i,l,!0)||PD(i,l)||FD(i,l)});this.applyStyle(o,r);return}this.applyStyle(o)}applyStyle(e=!1,t=!1){let i=this.editSvc?.isBatchEditing()??!1,n=this.gos.get("editType")==="fullRow";this.rowCtrl?.forEachGui(void 0,({rowComp:s})=>{s.toggleCss("ag-row-editing",n&&t),s.toggleCss("ag-row-batch-edit",n&&t&&i),s.toggleCss("ag-row-inline-editing",t),s.toggleCss("ag-row-not-inline-editing",!t),s.toggleCss("ag-row-editing-invalid",n&&t&&e)})}},zY=({rowModel:e,pinnedRowModel:t,editModelSvc:i},n)=>{let s=new Set;e.forEachNode(o=>n.has(o)&&s.add(o)),t?.forEachPinnedRow("top",o=>n.has(o)&&s.add(o)),t?.forEachPinnedRow("bottom",o=>n.has(o)&&s.add(o));for(let o of n)s.has(o)||i.removeEdits({rowNode:o});return s},WY=({editModelSvc:e},t,i)=>{for(let n of t)e?.getEditRow(n)?.forEach((s,o)=>!i.has(o)&&e.removeEdits({rowNode:n,column:o}))},UY=e=>()=>{let t=new Set(e.colModel.getCols()),i=e.editModelSvc.getEditMap(!0),n=new Set(i.keys());WY(e,zY(e,n),t)},qY=new Set(["undo","redo","paste","bulk","rangeSvc"]),$Y=new Set(["ui","api"]),TD={paste:"api",rangeSvc:"api",fillHandle:"api",cellClear:"api",bulk:"api"},jY=new Set(Object.keys(TD)),KY=new Set(["paste","rangeSvc","renderer","cellClear","redo","undo"]),Cp={cancel:!0,source:"api"},YY={cancel:!1,source:"api"},wa={checkSiblings:!0},fd={force:!0,suppressFlash:!0},XY=class extends F{constructor(){super(...arguments),this.beanName="editSvc",this.batch=!1,this.stopping=!1,this.committing=!1}postConstruct(){let{beans:e}=this;this.model=e.editModelSvc,this.valueSvc=e.valueSvc,this.rangeSvc=e.rangeSvc,this.addManagedPropertyListener("editType",({currentValue:n})=>{this.stopEditing(void 0,Cp),this.createStrategy(n)});let t=UY(e),i=()=>{let n=this.model.getCellValidationModel().getCellValidationMap().size>0,s=this.model.getRowValidationModel().getRowValidationMap().size>0;return n||s?this.stopEditing(void 0,Cp):this.isEditing()&&(this.isBatchEditing()?La(e,this.model.getEditPositions()):this.stopEditing(void 0,YY)),!1};this.addManagedEventListeners({columnPinned:t,columnVisible:t,columnRowGroupChanged:t,rowExpansionStateChanged:t,pinnedRowsChanged:t,displayedRowsChanged:t,sortChanged:i,filterChanged:i,cellFocused:this.onCellFocused.bind(this)})}isBatchEditing(){return this.batch}setBatchEditing(e){e?(this.batch=!0,this.stopEditing(void 0,Cp)):(this.stopEditing(void 0,Cp),this.batch=!1)}createStrategy(e){let{beans:t,gos:i,strategy:n}=this,s=x6(i,e);if(n){if(n.beanName===s)return n;this.destroyStrategy()}return this.strategy=this.createOptionalManagedBean(t.registry.createDynamicBean(s,!0))}destroyStrategy(){this.strategy&&(this.strategy.destroy(),this.strategy=this.destroyBean(this.strategy))}shouldStartEditing(e,t,i,n="ui"){let s=NY(this.beans,e,t,i,n);return s&&(this.strategy??(this.strategy=this.createStrategy())),s}shouldStopEditing(e,t,i="ui"){return this.strategy?.shouldStop(e,t,i)??null}shouldCancelEditing(e,t,i="ui"){return this.strategy?.shouldCancel(e,t,i)??null}validateEdit(){return h$(this.beans)}isEditing(e,t){return this.model.hasEdits(e,t??wa)}isRowEditing(e,t){return(e&&this.model.hasRowEdits(e,t))??!1}startEditing(e,t){let{startedEdit:i=!0,event:n=null,source:s="ui",ignoreEventKey:o=!1,silent:r}=t;if(this.strategy??(this.strategy=this.createStrategy()),!this.isCellEditable(e,"api"))return;let a=st(this.beans,e);if(a&&!a.comp){a.onCompAttachedFuncs.push(()=>this.startEditing(e,t));return}let l=this.shouldStartEditing(e,n,i,s);if(l===!1&&s!=="api"){this.isEditing(e)&&this.stopEditing();return}!this.batch&&this.shouldStopEditing(e,void 0,s)&&!t.continueEditing&&this.stopEditing(void 0,{source:s}),l&&this.isBatchEditing()&&this.dispatchBatchEvent("batchEditingStarted",new Map),this.strategy.start({position:e,event:n,source:s,ignoreEventKey:o,startedEdit:i,silent:r})}stopEditing(e,t){let{event:i,cancel:n,source:s="ui",forceCancel:o,forceStop:r}=t||{},{beans:a,model:l}=this;if(jY.has(s)&&this.isBatchEditing())return this.bulkRefresh(e),!1;let d=this.committing?TD[s]:s;if(!(this.committing||this.isEditing(e)||this.isBatchEditing()&&l.hasEdits(e,wa))||!this.strategy||this.stopping)return!1;this.stopping=!0;let u=st(a,e);u&&(u.onEditorAttachedFuncs=[]);let h=l.getEditMap(!0),p=!1,g=!n&&(!!this.shouldStopEditing(e,i,d)||this.committing&&!this.batch)||(r??!1),f=n&&!!this.shouldCancelEditing(e,i,d)||(o??!1);if(g||f){Zo(a,{persist:!0,isCancelling:f||n,isStopping:g});let m=l.getEditMap(),C=this.processEdits(m,n,s);this.strategy?.stop(n,i);for(let v of C)l.clearEditValue(v);this.bulkRefresh(void 0,h);for(let v of l.getEditPositions(m)){let w=st(a,v),y=Ss(v);w?.refreshCell({force:!0,suppressFlash:!y})}h=m,p||(p=g)}else if(i instanceof KeyboardEvent&&this.batch&&this.strategy?.midBatchInputsAllowed(e)&&this.isEditing(e,{withOpenEditor:!0})){let{key:m}=i,C=m===k.ENTER,v=m===k.ESCAPE,w=m===k.TAB;(C||w||v)&&(C||w?Zo(a,{persist:!0}):v&&this.revertSingleCellEdit(u),this.isBatchEditing()?this.strategy?.cleanupEditors():La(a,l.getEditPositions(),{event:i,cancel:v}),i.preventDefault(),this.bulkRefresh(e,h,{suppressFlash:!0}),h=l.getEditMap())}else Zo(a,{persist:!0}),h=l.getEditMap();return p&&e&&this.model.removeEdits(e),this.navigateAfterEdit(t,u?.cellPosition),Rv(a),this.model.hasEdits()||(this.model.getCellValidationModel().clearCellValidationMap(),this.model.getRowValidationModel().clearRowValidationMap()),this.bulkRefresh(),f&&this.beans.rowRenderer.refreshRows({rowNodes:Array.from(h.keys())}),this.isBatchEditing()&&(this.beans.rowRenderer.refreshRows({suppressFlash:!0,force:!0}),p&&g&&this.dispatchBatchEvent("batchEditingStopped",h)),this.stopping=!1,p}navigateAfterEdit(e,t){if(!e||!t)return;let{event:i,suppressNavigateAfterEdit:n}=e;if(!(i instanceof KeyboardEvent)||n)return;let{key:o,shiftKey:r}=i,a=this.gos.get("enterNavigatesVerticallyAfterEdit");if(o!==k.ENTER||!a)return;let l=r?k.UP:k.DOWN;this.beans.navigation?.navigateToNextCell(null,l,t,!1)}processEdits(e,t=!1,i){let n=Array.from(e.keys()),s=this.model.getCellValidationModel().getCellValidationMap().size>0||this.model.getRowValidationModel().getRowValidationMap().size>0,o=[];for(let r of n){let a=e.get(r);for(let l of a.keys()){let d=a.get(l),c={rowNode:r,column:l},u=Ss(d);!t&&u&&!s&&(this.setNodeDataValue(r,l,d.pendingValue,void 0,i)||o.push(c))}}return o}setNodeDataValue(e,t,i,n,s="edit"){let{beans:o}=this,r=st(o,{rowNode:e,column:t}),a=$Y.has(s)?"edit":s;r&&(r.suppressRefreshCell=!0),this.commitNextEdit();let l=e.setDataValue(t,i,a);return r&&(r.suppressRefreshCell=!1),n&&r?.refreshCell(fd),l}setEditMap(e,t){this.strategy??(this.strategy=this.createStrategy()),this.strategy?.setEditMap(e,t),this.bulkRefresh();let i=fd;t?.forceRefreshOfEditCellsOnly&&(i=b(b({},JY(e)),fd)),this.beans.rowRenderer.refreshCells(i)}dispatchEditValuesChanged({rowNode:e,column:t},i={}){if(!e||!t||!i)return;let{pendingValue:n,sourceValue:s}=i,{rowIndex:o,rowPinned:r,data:a}=e;this.beans.eventSvc.dispatchEvent({type:"cellEditValuesChanged",node:e,rowIndex:o,rowPinned:r,column:t,source:"api",data:a,newValue:n,oldValue:s,value:n,colDef:t.getColDef()})}bulkRefresh(e={},t,i={}){let{beans:n,gos:s}=this,{editModelSvc:o,rowModel:r}=n;wt(s,r)&&(e.rowNode&&e.column?this.refCell(e,this.model.getEdit(e),i):t&&o?.getEditMap(!1)?.forEach((a,l)=>{for(let d of a.keys())this.refCell({rowNode:l,column:d},a.get(d),i)}))}refCell({rowNode:e,column:t},i,n={}){let{beans:s,gos:o}=this,r=new Set([e]),a=new Set,l=e.pinnedSibling;l&&r.add(l);let d=e.sibling;d&&a.add(d);let c=e.parent;for(;c;)c.sibling?.footer&&o.get("groupTotalRow")||!c.parent&&c.sibling&&o.get("grandTotalRow")?a.add(c.sibling):a.add(c),c=c.parent;for(let u of r)this.dispatchEditValuesChanged({rowNode:u,column:t},i);for(let u of r)st(s,{rowNode:u,column:t})?.refreshCell(n);for(let u of a)st(s,{rowNode:u,column:t})?.refreshCell(n)}stopAllEditing(e=!1,t="ui"){this.isEditing()&&this.stopEditing(void 0,{cancel:e,source:t})}isCellEditable(e,t="ui"){let{rowNode:i}=e,{gos:n,beans:s}=this;if(i.group){if(n.get("treeData")){if(!i.data&&!n.get("enableGroupEdit"))return!1}else if(!n.get("enableGroupEdit"))return!1}let o=x6(n)==="fullRow"?HY(s,e,t):Tv(s,e,t);return o&&(this.strategy??(this.strategy=this.createStrategy())),o}cellEditingInvalidCommitBlocks(){return this.gos.get("invalidEditValueMode")==="block"}checkNavWithValidation(e,t,i=!0){if(this.hasValidationErrors(e)){let n=st(this.beans,e);return this.cellEditingInvalidCommitBlocks()?(t?.preventDefault?.(),i&&(!n?.hasBrowserFocus()&&n?.focusCell(),n?.comp?.getCellEditor()?.focusIn?.()),"block-stop"):(n&&this.revertSingleCellEdit(n),"revert-continue")}return"continue"}revertSingleCellEdit(e,t=!1){let i=st(this.beans,e);i?.comp?.getCellEditor()&&(La(this.beans,[e],{silent:!0}),this.model.clearEditValue(e),za(this.beans,e,{silent:!0}),cr(this.beans),i?.refreshCell(fd),t&&(i?.focusCell(),i?.comp?.getCellEditor()?.focusIn?.()))}hasValidationErrors(e){cr(this.beans);let t=st(this.beans,e);t&&(t.refreshCell(fd),t.rowCtrl.rowEditStyleFeature?.applyRowStyles());let i=!1;return e?.rowNode?(i||(i=this.model.getRowValidationModel().hasRowValidation({rowNode:e.rowNode})),e.column&&(i||(i=this.model.getCellValidationModel().hasCellValidation({rowNode:e.rowNode,column:e.column})))):(i||(i=this.model.getCellValidationModel().getCellValidationMap().size>0),i||(i=this.model.getRowValidationModel().getRowValidationMap().size>0)),i}moveToNextCell(e,t,i,n="ui"){let s,o=this.isEditing(),r=o&&this.checkNavWithValidation(void 0,i)==="block-stop";return e instanceof Oa&&o&&(s=this.strategy?.moveToNextEditingCell(e,t,i,n,r)),s===null||(s=s||!!this.beans.focusSvc.focusedHeader,s===!1&&!r&&this.stopEditing()),s}getCellDataValue({rowNode:e,column:t},i=!0){if(!e||!t)return;let n=this.model.getEdit({rowNode:e,column:t}),s=e.pinnedSibling;if(s){let r=this.model.getEdit({rowNode:s,column:t});r&&(n=r)}let o=i?n?.editorValue??n?.pendingValue:n?.pendingValue;return o===Ki||!n?n?.sourceValue??this.valueSvc.getValue(t,e,!1,"api"):o}addStopEditingWhenGridLosesFocus(e){r$(this,this.beans,e)}createPopupEditorWrapper(e){return new OY(e)}commitNextEdit(){this.committing=!0}setDataValue(e,t,i){try{if((!this.isEditing()||this.committing)&&!KY.has(i))return;let{beans:n}=this;this.strategy??(this.strategy=this.createStrategy());let s=this.isBatchEditing()?"ui":this.committing?i??"api":"api";if(!i||qY.has(i))return Pp(n,e,t,i,void 0,{persist:!0}),this.setNodeDataValue(e.rowNode,e.column,t,!0,i);let o=this.model.getEdit(e);if(o){if(o.pendingValue===t)return!1;if(o.sourceValue!==t)return Pp(n,e,t,i,void 0,{persist:!0}),this.stopEditing(e,{source:s,suppressNavigateAfterEdit:!0}),!0;if(o.sourceValue===t)return n.editModelSvc?.removeEdits(e),this.dispatchEditValuesChanged(e,O(b({},o),{pendingValue:t})),!0}return Pp(n,e,t,i,void 0,{persist:!0}),this.stopEditing(e,{source:s,suppressNavigateAfterEdit:!0}),!0}finally{this.committing=!1}}handleColDefChanged(e){d$(this.beans,e)}destroy(){this.model.clear(),this.destroyStrategy(),super.destroy()}prepDetailsDuringBatch(e,t){if(!this.batch||!this.model.hasRowEdits(e.rowNode,wa))return;let{rowNode:n,column:s}=e,{compDetails:o,valueToDisplay:r}=t;if(o){let{params:l}=o;return l.data=this.model.getEditRowDataValue(n,wa),{compDetails:o}}let a=this.model.getEditRow(e.rowNode,wa);if(r!==void 0&&a?.has(s))return{valueToDisplay:this.valueSvc.getValue(s,n)}}cleanupEditors(){this.strategy?.cleanupEditors()}dispatchCellEvent(e,t,i,n){this.strategy?.dispatchCellEvent(e,t,i,n)}dispatchBatchEvent(e,t){this.eventSvc.dispatchEvent(this.createBatchEditEvent(e,t))}createBatchEditEvent(e,t){return ae(this.gos,b({type:e},e==="batchEditingStopped"?{changes:this.toEventChangeList(t)}:{}))}toEventChangeList(e){return this.model.getEditPositions(e).map(t=>({rowIndex:t.rowNode.rowIndex,rowPinned:t.rowNode.rowPinned,columnId:t.column.getColId(),newValue:t.pendingValue,oldValue:t.sourceValue}))}applyBulkEdit({rowNode:e,column:t},i){if(!i||i.length===0)return;let{beans:n,rangeSvc:s,valueSvc:o}=this;Zo(n,{persist:!0});let r=this.model.getEditMap(!0),a=r.get(e)?.get(t)?.pendingValue;this.batch||this.eventSvc.dispatchEvent({type:"bulkEditingStarted"}),i.forEach(d=>{if(s?.forEachRowInRange(d,c=>{let u=ks(n,c);if(u===void 0)return;let h=r.get(u)??new Map;for(let p of d.columns)if(p&&this.isCellEditable({rowNode:u,column:p},"api")){let g=o.getValue(p,u,!0,"api"),f=o.parseValue(p,u??null,a,g);Number.isNaN(f)&&(f=null),h.set(p,{editorValue:void 0,pendingValue:f,sourceValue:g,state:"changed",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}})}h.size>0&&r.set(u,h)}),this.setEditMap(r),this.batch){this.cleanupEditors(),Rv(n),this.bulkRefresh();return}this.commitNextEdit(),this.stopEditing(void 0,{source:"bulk"}),this.eventSvc.dispatchEvent({type:"bulkEditingStopped",changes:this.toEventChangeList(r)})}),this.bulkRefresh();let l=st(n,{rowNode:e,column:t});l&&l.focusCell(!0)}createCellStyleFeature(e,t){return new VY(e,t)}createRowStyleFeature(e,t){return new GY(e,t)}setEditingCells(e,t){let{beans:i}=this,{colModel:n,valueSvc:s}=i,o=new Map;for(let{colId:r,column:a,colKey:l,rowIndex:d,rowPinned:c,newValue:u,state:h}of e){let p=r?n.getCol(r):l?n.getCol(l):a;if(!p)continue;let g=ks(i,{rowIndex:d,rowPinned:c});if(!g)continue;let f=s.getValue(p,g,!0,"api");if(!t?.forceRefreshOfEditCellsOnly&&!Ss({pendingValue:u,sourceValue:f})&&h!=="editing")continue;let m=o.get(g);m||(m=new Map,o.set(g,m)),u===void 0&&(u=Ki),m.set(p,{editorValue:void 0,pendingValue:u,sourceValue:f,state:h??"changed",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}})}this.setEditMap(o,t)}onCellFocused(e){let t=st(this.beans,e);if(!t||!this.isEditing(t,wa))return;let i=this.model.getEdit(t);if(!i||!Ss(i))return;let s=this.getLocaleTextFunc()("ariaPendingChange","Pending Change");this.beans.ariaAnnounce?.announceValue(s,"pendingChange")}allowedFocusTargetOnValidation(e){return st(this.beans,e)}};function JY(e){return{rowNodes:e?Array.from(e.keys()):void 0,columns:e?[...new Set(Array.from(e.values()).flatMap(t=>Array.from(t.keys())))]:void 0}}function x6(e,t){return t??e.get("editType")??"singleCell"}var AD=class extends F{postConstruct(){this.model=this.beans.editModelSvc,this.editSvc=this.beans.editSvc,this.addManagedEventListeners({cellFocused:this.onCellFocusChanged?.bind(this),cellFocusCleared:this.onCellFocusChanged?.bind(this)})}clearEdits(e){this.model.clearEditValue(e)}onCellFocusChanged(e){let t,i=e.previousParams,{editSvc:n,beans:s}=this,o=e.type==="cellFocused"?e.sourceEvent:null;i&&(t=st(s,i));let{gos:r,editModelSvc:a}=s,l=e.type==="cellFocusCleared";if(n.isEditing(void 0,{withOpenEditor:!0})){let{column:d,rowIndex:c,rowPinned:u}=e,h={column:d,rowNode:ks(s,{rowIndex:c,rowPinned:u})},p=r.get("invalidEditValueMode")==="block";if(p)return;let g=!p,f=!!a?.getCellValidationModel().hasCellValidation(h),m=g&&f;(i||l?n.stopEditing(void 0,{cancel:m,source:l&&g?"api":void 0,event:o}):!0)||(n.isBatchEditing()?n.cleanupEditors():n.stopEditing(void 0,{source:"api"}))}t?.refreshCell({suppressFlash:!0,force:!0})}stop(e,t){let i=this.model.getEditPositions(),n={all:[],pass:[],fail:[]};for(let s of i){if(n.all.push(s),(this.model.getCellValidationModel().getCellValidation(s)?.errorMessages?.length??0)>0){n.fail.push(s);continue}n.pass.push(s)}if(e)for(let s of i)Yp(this.beans,s,{cancel:e}),this.model.stop(s);else{let s=this.processValidationResults(n);if(s.destroy.length>0)for(let o of s.destroy)Yp(this.beans,o,{event:t,cancel:e}),this.model.stop(o);if(s.keep.length>0)for(let o of s.keep){let r=st(this.beans,o);this.editSvc?.cellEditingInvalidCommitBlocks()||r&&this.editSvc.revertSingleCellEdit(r)}}return!0}cleanupEditors({rowNode:e}={},t){Zo(this.beans,{persist:!1});let i=this.model.getEditPositions(),n=[];if(e)for(let s of i)s.rowNode!==e&&n.push(s);else for(let s of i)n.push(s);La(this.beans,n),Rv(this.beans,t)}setFocusOutOnEditor(e){e.comp?.getCellEditor()?.focusOut?.()}setFocusInOnEditor(e){let t=e.comp,i=t?.getCellEditor();if(i?.focusIn)i.focusIn();else{let n=this.beans.gos.get("editType")==="fullRow";e.focusCell(n),e.onEditorAttachedFuncs.push(()=>t?.getCellEditor()?.focusIn?.())}}setupEditors(e){let{event:t,ignoreEventKey:i=!1,startedEdit:n,position:s,cells:o=this.model.getEditPositions()}=e,r=t instanceof KeyboardEvent&&!i&&t.key||void 0;l$(this.beans,o,s,r,t,n)}dispatchCellEvent(e,t,i,n){let s=st(this.beans,e);s&&this.eventSvc.dispatchEvent(b(b({},s.createEvent(t??null,i)),n))}dispatchRowEvent(e,t,i){if(i)return;let n=fw(this.beans,e);n&&this.eventSvc.dispatchEvent(n.createRowEvent(t))}shouldStop(e,t,i="ui"){let n=this.editSvc.isBatchEditing();return n&&i==="api"?!0:n&&(i==="ui"||i==="edit")?!1:i==="api"?!0:t instanceof KeyboardEvent&&!n?t.key===k.ENTER:null}shouldCancel(e,t,i="ui"){let n=this.editSvc.isBatchEditing();return!!(t instanceof KeyboardEvent&&!n&&t.key===k.ESCAPE||n&&i==="api"||i==="api")}setEditMap(e,t){t?.update||this.editSvc.stopEditing(void 0,{cancel:!0,source:"api"});let i=[];if(e.forEach((n,s)=>{n.forEach((o,r)=>{o.state==="editing"&&i.push(O(b({},o),{rowNode:s,column:r}))})}),t?.update&&(e=new Map([...this.model.getEditMap(),...e])),this.model?.setEditMap(e),i.length>0){let n=i.at(-1),s=n.pendingValue===Ki?void 0:n.pendingValue;this.start({position:n,event:new KeyboardEvent("keydown",{key:s}),source:"api"});let o=st(this.beans,n);o&&this.setFocusInOnEditor(o)}}destroy(){this.cleanupEditors(),super.destroy()}},QY=class extends AD{constructor(){super(...arguments),this.beanName="fullRow",this.startedRows=[]}shouldStop(e,t,i="ui"){let{rowNode:n}=e||{};if(!fw(this.beans,{rowNode:this.rowNode}))return!0;let o=super.shouldStop({rowNode:this.rowNode},t,i);return o!==null?o:this.rowNode?n!==this.rowNode:!1}midBatchInputsAllowed({rowNode:e}){return e?this.model.hasEdits({rowNode:e}):!1}clearEdits(e){this.model.clearEditValue(e)}start(e){let{position:t,silent:i,startedEdit:n,event:s,ignoreEventKey:o}=e,{rowNode:r}=t;this.rowNode!==r&&super.cleanupEditors(t);let a=this.beans.visibleCols.allCols,l=[],d=[];for(let c of a)c.isCellEditable(r)&&d.push(c);if(d.length!=0){this.dispatchRowEvent({rowNode:r},"rowEditingStarted",i),this.startedRows.push(r);for(let c of d){let u={rowNode:r,column:c};l.push(u),this.model.hasEdits(u)||this.model.start(u)}this.rowNode=r,this.setupEditors({cells:l,position:t,startedEdit:n,event:s,ignoreEventKey:o})}}processValidationResults(e){return e.fail.length>0&&this.editSvc.cellEditingInvalidCommitBlocks()?{destroy:[],keep:e.all}:{destroy:e.all,keep:[]}}stop(e,t){let{rowNode:i}=this;if(i&&!this.model.hasRowEdits(i))return!1;let n=[];if(e||this.model.getEditMap().forEach((s,o)=>{if(!(!s||s.size===0)){for(let r of s.values())if(Ss(r)){n.push(o);break}}}),cr(this.beans),!e&&this.editSvc?.checkNavWithValidation({rowNode:i})==="block-stop")return!1;super.stop(e,t);for(let s of n)this.dispatchRowEvent({rowNode:s},"rowValueChanged");return this.cleanupEditors({rowNode:i},!0),this.rowNode=void 0,!0}onCellFocusChanged(e){let{rowIndex:t}=e,i=e.previousParams;if(i?.rowIndex===t||e.sourceEvent instanceof KeyboardEvent)return;let n=st(this.beans,i);this.gos.get("invalidEditValueMode")==="block"&&n&&(this.model.getCellValidationModel().getCellValidation(n)||this.model.getRowValidationModel().getRowValidation(n))||super.onCellFocusChanged(e)}cleanupEditors(e={},t){super.cleanupEditors(e,t);for(let i of this.startedRows)this.dispatchRowEvent({rowNode:i},"rowEditingStopped");this.startedRows.length=0}moveToNextEditingCell(e,t,i,n="ui",s=!1){let o=e.cellPosition,r;this.model.suspend(!0);try{r=this.beans.navigation?.findNextCellToFocusOn(o,{backwards:t,startEditing:!0,skipToNextEditableCell:!1})}finally{this.model.suspend(!1)}if(r===!1)return null;if(r==null)return!1;let a=r.cellPosition,l=e.isCellEditable(),d=r.isCellEditable(),c=a&&o.rowIndex===a.rowIndex&&o.rowPinned===a.rowPinned;l&&this.setFocusOutOnEditor(e),this.restoreEditors();let u=this.gos.get("suppressStartEditOnTab");return d&&!s?u?r.focusCell(!0,i):(r.comp?.getCellEditor()||za(this.beans,r,{event:i,cellStartedEdit:!0}),this.setFocusInOnEditor(r),r.focusCell(!1,i)):(d&&s&&this.setFocusInOnEditor(r),r.focusCell(!0,i)),!c&&!s&&(this.editSvc?.stopEditing({rowNode:e.rowNode},{event:i}),this.cleanupEditors(r,!0),u?r.focusCell(!0,i):this.editSvc.startEditing(r,{startedEdit:!0,event:i,source:n,ignoreEventKey:!0})),e.rowCtrl?.refreshRow({suppressFlash:!0,force:!0}),!0}restoreEditors(){this.model.getEditMap().forEach((e,t)=>e.forEach(({state:i},n)=>{if(i!=="editing")return;let s=st(this.beans,{rowNode:t,column:n});s&&!s.comp?.getCellEditor()&&za(this.beans,s,{silent:!0})}))}destroy(){super.destroy(),this.rowNode=void 0,this.startedRows.length=0}},ZY=class extends AD{constructor(){super(...arguments),this.beanName="singleCell"}shouldStop(e,t,i="ui"){let n=super.shouldStop(e,t,i);if(n!==null)return n;let{rowNode:s,column:o}=e||{};return(!this.rowNode||!this.column)&&s&&o?null:this.rowNode!==s||this.column!==o}midBatchInputsAllowed(e){return this.model.hasEdits(e)}start(e){let{position:t,startedEdit:i,event:n,ignoreEventKey:s}=e;(this.rowNode!==t.rowNode||this.column!==t.column)&&super.cleanupEditors(),this.rowNode=t.rowNode,this.column=t.column,this.model.start(t),this.setupEditors({cells:[t],position:t,startedEdit:i,event:n,ignoreEventKey:s})}dispatchRowEvent(e,t,i){}processValidationResults(e){return e.fail.length>0&&this.editSvc.cellEditingInvalidCommitBlocks()?{destroy:[],keep:e.all}:{destroy:e.all,keep:[]}}stop(e,t){return super.stop(e,t),this.rowNode=void 0,this.column=void 0,!0}onCellFocusChanged(e){let{colModel:t,editSvc:i}=this.beans,{rowIndex:n,column:s,rowPinned:o}=e,r=ks(this.beans,{rowIndex:n,rowPinned:o}),a=Ev(s),l=t.getCol(a),d=e.previousParams;if(d){let c=Ev(d.column);if(d?.rowIndex===n&&c===a&&d?.rowPinned===o)return}i?.isEditing({rowNode:r,column:l},{withOpenEditor:!0})&&e.type==="cellFocused"||super.onCellFocusChanged(e)}moveToNextEditingCell(e,t,i,n="ui",s=!1){let o=this.beans.focusSvc.getFocusedCell();o&&(e=Ra(this.beans,o)??e);let r=e.cellPosition,a,l=this.beans.gos.get("editType")==="fullRow";l&&this.model.suspend(!0),s||(e.eGui.focus(),this.editSvc?.stopEditing(e,{source:this.editSvc?.isBatchEditing()?"ui":"api",event:i}));try{a=this.beans.navigation?.findNextCellToFocusOn(r,{backwards:t,startEditing:!0})}finally{l&&this.model.suspend(!1)}if(a===!1)return null;if(a==null)return!1;let d=a.cellPosition,c=e.isCellEditable(),u=a.isCellEditable(),h=d&&r.rowIndex===d.rowIndex&&r.rowPinned===d.rowPinned;c&&!s&&this.setFocusOutOnEditor(e);let p=this.gos.get("suppressStartEditOnTab");if(!h&&!s&&(super.cleanupEditors(a,!0),p?a.focusCell(!0,i):this.editSvc.startEditing(a,{startedEdit:!0,event:i,source:n,ignoreEventKey:!0})),u&&!s){if(a.focusCell(!1,i),p)a.focusCell(!0,i);else if(!a.comp?.getCellEditor()){let g=this.editSvc?.isEditing(a,{withOpenEditor:!0});za(this.beans,a,{event:i,cellStartedEdit:!0,silent:g}),this.setFocusInOnEditor(a),this.cleanupEditors(a)}}else u&&s&&this.setFocusInOnEditor(a),a.focusCell(!0,i);return e.rowCtrl?.refreshRow({suppressFlash:!0,force:!0}),!0}destroy(){super.destroy(),this.rowNode=void 0,this.column=void 0}},fo={moduleName:"EditCore",version:q,beans:[o$,XY],apiFunctions:{getEditingCells:kY,getEditRowValues:DY,getCellEditorInstances:a$,startEditingCell:TY,stopEditing:PY,isEditing:FY,validateEdit:AY},dynamicBeans:{singleCell:ZY,fullRow:QY},dependsOn:[ag,ED],css:[sY]},eX={moduleName:"UndoRedoEdit",version:q,beans:[nY],apiFunctions:{undoCellEditing:RY,redoCellEditing:MY,getCurrentUndoSize:IY,getCurrentRedoSize:_Y},dependsOn:[fo]},tX={moduleName:"TextEditor",version:q,userComponents:{agCellEditor:S6,agTextCellEditor:S6},dependsOn:[fo]},iX={moduleName:"NumberEditor",version:q,userComponents:{agNumberCellEditor:{classImp:CY}},dependsOn:[fo]},nX={moduleName:"DateEditor",version:q,userComponents:{agDateCellEditor:dY,agDateStringCellEditor:hY},dependsOn:[fo]},sX={moduleName:"CheckboxEditor",version:q,userComponents:{agCheckboxCellEditor:rY},dependsOn:[fo]},oX={moduleName:"SelectEditor",version:q,userComponents:{agSelectCellEditor:wY},dependsOn:[fo]},rX={moduleName:"LargeTextEditor",version:q,userComponents:{agLargeTextCellEditor:gY},dependsOn:[fo]},aX={moduleName:"CustomEditor",version:q,dependsOn:[fo]},lX=class extends F{constructor(){super(...arguments),this.beanName="selectionColSvc"}postConstruct(){this.addManagedPropertyListener("rowSelection",e=>{this.onSelectionOptionsChanged(e.currentValue,e.previousValue,Ta(e.source))}),this.addManagedPropertyListener("selectionColumnDef",this.updateColumns.bind(this))}addColumns(e){let t=this.columns;t!=null&&(e.list=t.list.concat(e.list),e.tree=t.tree.concat(e.tree),SN(e))}createColumns(e,t){let i=()=>{Vp(this.beans,this.columns?.tree),this.columns=null},n=e.treeDepth,o=(this.columns?.treeDepth??-1)==n,r=this.generateSelectionCols();if(yN(r,this.columns?.list??[])&&o)return;i();let{colGroupSvc:l}=this.beans,d=l?.findDepth(e.tree)??0,c=l?.balanceTreeForAutoCols(r,d)??[];this.columns={list:r,tree:c,treeDepth:d,map:{}},t(h=>{if(!h)return null;let p=h.filter(g=>!Fs(g));return[...r,...p]})}updateColumns(e){let t=Ta(e.source);for(let i of this.columns?.list??[]){let n=this.createSelectionColDef(e.currentValue);i.setColDef(n,null,t),rn(this.beans,{state:[O(b({},n),{colId:i.getColId()})]},t)}}getColumn(e){return this.columns?.list.find(t=>Ed(t,e))??null}getColumns(){return this.columns?.list??null}isSelectionColumnEnabled(){let{gos:e,beans:t}=this,i=e.get("rowSelection");if(typeof i!="object"||!tr(e))return!1;let n=(t.autoColSvc?.getColumns()?.length??0)>0;if(i.checkboxLocation==="autoGroupColumn"&&n)return!1;let s=!!Fa(i),o=yp(i);return s||o}createSelectionColDef(e){let{gos:t}=this,i=e??t.get("selectionColumnDef"),n=t.get("enableRtl"),a=i??{},{rowSpan:s,spanRows:o}=a,r=gi(a,["rowSpan","spanRows"]);return O(b({width:50,resizable:!1,suppressHeaderMenuButton:!0,sortable:!1,suppressMovable:!0,lockPosition:n?"right":"left",comparator(l,d,c,u){let h=c.isSelected(),p=u.isSelected();return h===p?0:h?1:-1},editable:!1,suppressFillHandle:!0,pinned:null},r),{colId:m4,chartDataType:"excluded"})}generateSelectionCols(){if(!this.isSelectionColumnEnabled())return[];let e=this.createSelectionColDef(),t=e.colId;this.gos.validateColDef(e,t,!0);let i=new hr(e,null,t,!1);return this.createBean(i),[i]}onSelectionOptionsChanged(e,t,i){let n=t&&typeof t!="string"?Fa(t):void 0,s=e&&typeof e!="string"?Fa(e):void 0,o=n!==s,r=t&&typeof t!="string"?yp(t):void 0,a=e&&typeof e!="string"?yp(e):void 0,l=r!==a,d=Np(e),c=Np(t);(o||l||d!==c)&&this.beans.colModel.refreshAll(i)}destroy(){Vp(this.beans,this.columns?.tree),super.destroy()}refreshVisibility(e,t,i){if(!this.columns?.list.length)return;let n=e.length+t.length+i.length;if(n===0)return;let s=this.columns.list[0];if(!s.isVisible())return;let o=()=>{let l;switch(s.pinned){case"left":case!0:l=e;break;case"right":l=i;break;default:l=t}l&&an(l,s)};(this.beans.rowNumbersSvc?.getColumn(C4)?2:1)===n&&o()}};function dX(e,t){if(!t.nodes.every(r=>r.rowPinned&&!Kd(r)?(I(59),!1):r.id===void 0?(I(60),!1):!0))return;let{nodes:n,source:s,newValue:o}=t;e.selectionSvc?.setNodesSelected({nodes:n,source:s??"api",newValue:o})}function cX(e,t,i="apiSelectAll"){e.selectionSvc?.selectAllRowNodes({source:i,selectAll:t})}function uX(e,t,i="apiSelectAll"){e.selectionSvc?.deselectAllRowNodes({source:i,selectAll:t})}function hX(e,t="apiSelectAllFiltered"){e.selectionSvc?.selectAllRowNodes({source:t,selectAll:"filtered"})}function pX(e,t="apiSelectAllFiltered"){e.selectionSvc?.deselectAllRowNodes({source:t,selectAll:"filtered"})}function gX(e,t="apiSelectAllCurrentPage"){e.selectionSvc?.selectAllRowNodes({source:t,selectAll:"currentPage"})}function fX(e,t="apiSelectAllCurrentPage"){e.selectionSvc?.deselectAllRowNodes({source:t,selectAll:"currentPage"})}function mX(e){return e.selectionSvc?.getSelectedNodes()??[]}function CX(e){return e.selectionSvc?.getSelectedRows()??[]}var vX=class extends _G{constructor(){super(...arguments),this.beanName="selectionSvc",this.selectedNodes=new Map,this.detailSelection=new Map,this.masterSelectsDetail=!1}postConstruct(){super.postConstruct();let{gos:e}=this;this.mode=Bp(e),this.groupSelectsDescendants=Od(e),this.groupSelectsFiltered=Hp(e)==="filteredDescendants",this.masterSelectsDetail=gR(e)==="detail",this.addManagedPropertyListeners(["groupSelectsChildren","groupSelectsFiltered","rowSelection"],()=>{let t=Od(e),i=Bp(e),n=Hp(e)==="filteredDescendants";this.masterSelectsDetail=gR(e)==="detail",(t!==this.groupSelectsDescendants||n!==this.groupSelectsFiltered||i!==this.mode)&&(this.deselectAllRowNodes({source:"api"}),this.groupSelectsDescendants=t,this.groupSelectsFiltered=n,this.mode=i)}),this.addManagedEventListeners({rowSelected:this.onRowSelected.bind(this)})}destroy(){super.destroy(),this.resetNodes()}handleSelectionEvent(e,t,i){if(this.isRowSelectionBlocked(t))return 0;let n=this.inferNodeSelections(t,e.shiftKey,e.metaKey||e.ctrlKey,i);if(n==null)return 0;if(this.selectionCtx.selectAll=!1,"select"in n)return n.reset?this.resetNodes():this.selectRange(n.deselect,!1,i),this.selectRange(n.select,!0,i);{let s=n.checkFilteredNodes?_D(n.node):n.newValue;return this.setNodesSelected({nodes:[n.node],newValue:s,clearSelection:n.clearSelection,keepDescendants:n.keepDescendants,event:e,source:i})}}setNodesSelected({newValue:e,clearSelection:t,suppressFinishActions:i,nodes:n,event:s,source:o,keepDescendants:r=!1}){if(n.length===0)return 0;let{gos:a}=this;if(!tr(a)&&e)return I(132),0;if(n.length>1&&!this.isMultiSelect())return I(130),0;let l=0;for(let d=0;d<n.length;d++){let c=n[d],u=ba(c);if(u.rowPinned&&!Kd(u)){I(59);continue}if(u.id===void 0){I(60);continue}this.groupSelectsFiltered&&u.group&&!a.get("treeData")||this.selectRowNode(u,e,s,o)&&(this.detailSelection.delete(u.id),l++),this.groupSelectsDescendants&&u.childrenAfterGroup?.length&&(l+=this.selectChildren(u,e,o))}return i||(n.length===1&&o==="api"&&this.selectionCtx.setRoot(ba(n[0])),e&&(t||!this.isMultiSelect())&&(l+=this.clearOtherNodes(ba(n[0]),r,o)),l>0&&(this.updateGroupsFromChildrenSelections(o),this.dispatchSelectionChanged(o))),l}selectRange(e,t,i){let n=0;return e.forEach(s=>{let o=ba(s);if(o.group&&this.groupSelectsDescendants)return;this.selectRowNode(o,t,void 0,i)&&n++}),n>0&&(this.updateGroupsFromChildrenSelections(i),this.dispatchSelectionChanged(i)),n}selectChildren(e,t,i){let n=this.groupSelectsFiltered?e.childrenAfterAggFilter:e.childrenAfterGroup;return n?this.setNodesSelected({newValue:t,clearSelection:!1,suppressFinishActions:!0,source:i,nodes:n}):0}getSelectedNodes(){return Array.from(this.selectedNodes.values())}getSelectedRows(){let e=[];return this.selectedNodes.forEach(t=>t.data&&e.push(t.data)),e}getSelectionCount(){return this.selectedNodes.size}filterFromSelection(e){let t=new Map;this.selectedNodes.forEach((i,n)=>{e(i)&&t.set(n,i)}),this.selectedNodes=t}updateGroupsFromChildrenSelections(e,t){if(!this.groupSelectsDescendants)return!1;let{gos:i,rowModel:n}=this.beans;if(!wt(i,n))return!1;let s=n.rootNode;if(!s)return!1;t||(t=new Hd(!0,s),t.active=!1);let o=!1;return t.forEachChangedNodeDepthFirst(r=>{if(r!==s){let a=this.calculateSelectedFromChildren(r);o=this.selectRowNode(r,a===null?!1:a,void 0,e)||o}}),o}clearOtherNodes(e,t,i){let n=new Map,s=0;return this.selectedNodes.forEach(o=>{let r=o.id==e.id;if((t?!bX(e,o):!0)&&!r){let l=this.selectedNodes.get(o.id);s+=this.setNodesSelected({nodes:[l],newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:i}),this.groupSelectsDescendants&&o.parent&&n.set(o.parent.id,o.parent)}}),n.forEach(o=>{let r=this.calculateSelectedFromChildren(o);this.selectRowNode(o,r===null?!1:r,void 0,i)}),s}onRowSelected(e){let t=e.node;this.groupSelectsDescendants&&t.group||(t.isSelected()?this.selectedNodes.set(t.id,t):this.selectedNodes.delete(t.id))}syncInRowNode(e,t){this.syncInOldRowNode(e,t),this.syncInNewRowNode(e)}createDaemonNode(e){if(!e.id)return;let t=new co(this.beans);return t.id=e.id,t.data=e.data,t.__selected=e.__selected,t.level=e.level,t}syncInOldRowNode(e,t){t&&e.id!==t.id&&this.selectedNodes.get(t.id)==e&&this.selectedNodes.set(t.id,t)}syncInNewRowNode(e){this.selectedNodes.has(e.id)?(e.__selected=!0,this.selectedNodes.set(e.id,e)):e.__selected=!1}reset(e){let t=this.getSelectionCount();this.resetNodes(),t&&this.dispatchSelectionChanged(e)}resetNodes(){this.selectedNodes.forEach(e=>{this.selectRowNode(e,!1)}),this.selectedNodes.clear()}getBestCostNodeSelection(){let{gos:e,rowModel:t}=this.beans;if(!wt(e,t))return;let i=t.getTopLevelNodes();if(i===null)return;let n=[];function s(o){for(let r=0,a=o.length;r<a;r++){let l=o[r];l.isSelected()?n.push(l):l.group&&l.childrenAfterGroup&&s(l.childrenAfterGroup)}}return s(i),n}isEmpty(){return this.getSelectionCount()===0}deselectAllRowNodes({source:e,selectAll:t}){let i=wt(this.gos),n=!1,s=o=>{let r=this.selectRowNode(ba(o),!1,void 0,e);n||(n=r)};if(t==="currentPage"||t==="filtered"){if(!i){Ge(102);return}this.getNodesToSelect(t).forEach(s)}else this.selectedNodes.forEach(s),this.reset(e);if(this.selectionCtx.selectAll=!1,i&&this.groupSelectsDescendants){let o=this.updateGroupsFromChildrenSelections(e);n||(n=o)}n&&this.dispatchSelectionChanged(e)}getSelectedCounts(e){let t=0,i=0;return this.getNodesToSelect(e).forEach(n=>{this.groupSelectsDescendants&&n.group||(n.isSelected()?t++:n.selectable&&i++)}),{selectedCount:t,notSelectedCount:i}}getSelectAllState(e){let{selectedCount:t,notSelectedCount:i}=this.getSelectedCounts(e);return ID(t,i)??null}hasNodesToSelect(e){return this.getNodesToSelect(e).filter(t=>t.selectable).length>0}getNodesToSelect(e){if(!this.canSelectAll())return[];let t=[],i=s=>t.push(s);if(e==="currentPage")return this.forEachNodeOnPage(s=>{if(!s.group){i(s);return}if(!s.expanded&&!s.footer){let o=r=>{i(r),r.childrenAfterFilter?.forEach(o)};o(s);return}this.groupSelectsDescendants||i(s)}),t;let n=this.beans.rowModel;return e==="filtered"?(n.forEachNodeAfterFilter(i),t):(n.forEachNode(i),t)}forEachNodeOnPage(e){let{pageBounds:t,rowModel:i}=this.beans,n=t.getFirstRow(),s=t.getLastRow();for(let o=n;o<=s;o++){let r=i.getRow(o);r&&e(r)}}selectAllRowNodes(e){let{gos:t,selectionCtx:i}=this;if(!tr(t)){I(132);return}if(lN(t)&&!Ld(t)){I(130);return}if(!this.canSelectAll())return;let{source:n,selectAll:s}=e,o=!1;if(this.getNodesToSelect(s).forEach(r=>{let a=this.selectRowNode(ba(r),!0,void 0,n);o||(o=a)}),i.selectAll=!0,wt(t)&&this.groupSelectsDescendants){let r=this.updateGroupsFromChildrenSelections(n);o||(o=r)}o&&this.dispatchSelectionChanged(n)}getSelectionState(){return this.isEmpty()?null:Array.from(this.selectedNodes.keys())}setSelectionState(e,t,i){if(e||(e=[]),!Array.isArray(e)){Ge(103);return}let n=new Set(e),s=[];this.beans.rowModel.forEachNode(o=>{n.has(o.id)&&s.push(o)}),i&&this.resetNodes(),this.setNodesSelected({newValue:!0,nodes:s,source:t})}canSelectAll(){return wt(this.beans.gos)}updateSelectable(e){let{gos:t,rowModel:i}=this.beans;if(!tr(t))return;let n="selectableChanged",s=e!==void 0,o=wt(t)&&this.groupSelectsDescendants,r=[],a=l=>{if(s&&!l.group)return;if(o&&l.group){let c=l.childrenAfterGroup?.some(u=>u.selectable)??!1;this.setRowSelectable(l,c,!0);return}!this.updateRowSelectable(l,!0)&&l.isSelected()&&r.push(l)};if(o){if(e===void 0){let l=i.rootNode;e=l?new Hd(!1,l):void 0}e?.forEachChangedNodeDepthFirst(a,!s,!s)}else i.forEachNode(a);r.length&&this.setNodesSelected({nodes:r,newValue:!1,source:n}),!s&&o&&this.updateGroupsFromChildrenSelections?.(n)}updateSelectableAfterGrouping(e){this.updateSelectable(e),this.groupSelectsDescendants&&this.updateGroupsFromChildrenSelections?.("rowGroupChanged",e)&&this.dispatchSelectionChanged("rowGroupChanged")}refreshMasterNodeState(e,t){if(!this.masterSelectsDetail)return;let i=e.detailNode?.detailGridInfo?.api;if(!i)return;let n=wX(i);if(e.isSelected()!==n&&this.selectRowNode(e,n,t,"masterDetail")&&this.dispatchSelectionChanged("masterDetail"),!n){let o=this.detailSelection.get(e.id)??new Set;for(let r of i.getSelectedNodes())o.add(r.id);this.detailSelection.set(e.id,o)}}setDetailSelectionState(e,t,i){if(this.masterSelectsDetail){if(!Ld(t)){I(269);return}switch(e.isSelected()){case!0:{i.selectAll();break}case!1:{i.deselectAll();break}case void 0:{let n=this.detailSelection.get(e.id);if(n){let s=[];for(let o of n){let r=i.getRowNode(o);r&&s.push(r)}i.setNodesSelected({nodes:s,newValue:!0,source:"masterDetail"})}break}default:break}}}dispatchSelectionChanged(e){this.eventSvc.dispatchEvent({type:"selectionChanged",source:e,selectedNodes:this.getSelectedNodes(),serverSideState:null})}};function ba(e){return Kd(e)?e.pinnedSibling:e.footer?e.sibling:e}function wX(e){let t=0,i=0;return e.forEachNode(n=>{n.isSelected()?t++:n.selectable&&i++}),ID(t,i)}function ID(e,t){if(e===0&&t===0)return!1;if(!(e>0&&t>0))return e>0}function bX(e,t){let i=t.parent;for(;i;){if(i===e)return!0;i=i.parent}return!1}function _D(e){let t=e.isSelected()===!1,i=e.childrenAfterFilter?.some(_D)??!1;return t||i}var yX={moduleName:"SharedRowSelection",version:q,beans:[lX],apiFunctions:{setNodesSelected:dX,selectAll:cX,deselectAll:uX,selectAllFiltered:hX,deselectAllFiltered:pX,selectAllOnCurrentPage:gX,deselectAllOnCurrentPage:fX,getSelectedNodes:mX,getSelectedRows:CX}},SX={moduleName:"RowSelection",version:q,rowModels:["clientSide","infinite","viewport"],beans:[vX],dependsOn:[yX]};function xX(e){e.expansionSvc?.expandAll(!0)}function EX(e){e.expansionSvc?.expandAll(!1)}function LD(e){e.rowModel?.onRowHeightChanged()}function OD(e){if(e.rowAutoHeight?.active){I(3);return}e.rowModel?.resetRowHeights()}function RX(e,t,i){let n=Mj(e);if(n){if(e.rowGroupColsSvc?.columns.length===0){if(t<0){Ge(238);return}n.setRowCount(t,i);return}Ge(28);return}rg(e)?.setRowCount(t,i)}function MX(e){return Ua(e.gos)?e.rowModel.getBlockStates():e.rowNodeBlockLoader?.getBlockState()??{}}function DX(e){return e.rowModel.isLastRowIndexKnown()}var kX={moduleName:"CsrmSsrmSharedApi",version:q,apiFunctions:{expandAll:xX,collapseAll:EX}},PX={moduleName:"RowModelSharedApi",version:q,apiFunctions:{onRowHeightChanged:LD,resetRowHeights:OD}},FX={moduleName:"SsrmInfiniteSharedApi",version:q,apiFunctions:{setRowCount:RX,getCacheBlockState:MX,isLastRowIndexKnown:DX}},TX=class extends F{constructor(){super(...arguments),this.beanName="alignedGridsSvc",this.consuming=!1}getAlignedGridApis(){let e=this.gos.get("alignedGrids")??[],t=typeof e=="function";return typeof e=="function"&&(e=e()),e.map(n=>{if(!n){Ge(18),t||Ge(20);return}if(this.isGridApi(n))return n;let s=n;return"current"in s?s.current?.api:(s.api||Ge(19),s.api)}).filter(n=>!!n&&!n.isDestroyed())}isGridApi(e){return!!e&&!!e.dispatchEvent}postConstruct(){let e=this.fireColumnEvent.bind(this);this.addManagedEventListeners({columnMoved:e,columnVisible:e,columnPinned:e,columnGroupOpened:e,columnResized:e,bodyScroll:this.fireScrollEvent.bind(this),alignedGridColumn:({event:t})=>this.onColumnEvent(t),alignedGridScroll:({event:t})=>this.onScrollEvent(t)})}fireEvent(e){if(!this.consuming)for(let t of this.getAlignedGridApis())t.isDestroyed()||t.dispatchEvent(e)}onEvent(e){this.consuming=!0,e(),this.consuming=!1}fireColumnEvent(e){this.fireEvent({type:"alignedGridColumn",event:e})}fireScrollEvent(e){e.direction==="horizontal"&&this.fireEvent({type:"alignedGridScroll",event:e})}onScrollEvent(e){this.onEvent(()=>{this.beans.ctrlsSvc.getScrollFeature().setHorizontalScrollPosition(e.left,!0)})}extractDataFromEvent(e,t){let i=[];return e.columns?e.columns.forEach(n=>{i.push(t(n))}):e.column&&i.push(t(e.column)),i}getMasterColumns(e){return this.extractDataFromEvent(e,t=>t)}getColumnIds(e){return this.extractDataFromEvent(e,t=>t.getColId())}onColumnEvent(e){this.onEvent(()=>{switch(e.type){case"columnMoved":case"columnVisible":case"columnPinned":case"columnResized":{this.processColumnEvent(e);break}case"columnGroupOpened":{this.processGroupOpenedEvent(e);break}case"columnPivotChanged":I(21);break}})}processGroupOpenedEvent(e){let{colGroupSvc:t}=this.beans;if(t)for(let i of e.columnGroups){let n=null;i&&(n=t.getProvidedColGroup(i.getGroupId())),!(i&&!n)&&t.setColumnGroupOpened(n,i.isExpanded(),"alignedGridChanged")}}processColumnEvent(e){let t=e.column,i=null,n=this.beans,{colResize:s,ctrlsSvc:o,colModel:r}=n;if(t&&(i=r.getColDefCol(t.getColId())),t&&!i)return;let a=this.getMasterColumns(e);switch(e.type){case"columnMoved":{let u=e.api.getColumnState().map(h=>({colId:h.colId}));rn(n,{state:u,applyOrder:!0},"alignedGridChanged")}break;case"columnVisible":{let u=e.api.getColumnState().map(h=>({colId:h.colId,hide:h.hide}));rn(n,{state:u},"alignedGridChanged")}break;case"columnPinned":{let u=e.api.getColumnState().map(h=>({colId:h.colId,pinned:h.pinned}));rn(n,{state:u},"alignedGridChanged")}break;case"columnResized":{let c=e,u={};for(let h of a)u[h.getId()]={key:h.getColId(),newWidth:h.getActualWidth()};for(let h of c.flexColumns??[])u[h.getId()]&&delete u[h.getId()];s?.setColumnWidths(Object.values(u),!1,c.finished,"alignedGridChanged");break}}let d=o.getGridBodyCtrl().isVerticalScrollShowing();for(let c of this.getAlignedGridApis())c.setGridOption("alwaysShowVerticalScroll",d)}},AX={moduleName:"AlignedGrids",version:q,beans:[TX],dependsOn:[AM]},IX=class extends F{constructor(e){super(),this.rootNode=e,this.nextId=0,this.allNodesMap={},E6(e)}getRowNode(e){return this.allNodesMap[e]}setNewRowData(e){let{selectionSvc:t,pinnedRowModel:i,groupStage:n}=this.beans;t?.reset("rowDataChanged"),i?.isManual()&&i.reset(),this.dispatchRowDataUpdateStarted(e),this.allNodesMap=Object.create(null),this.nextId=0;let s=E6(this.rootNode),o=new Array(e.length);s._leafs=o;let r=0,a=n?.getNestedDataGetter(),l=a?new Set:null,d=(c,u)=>{let h=c.level+1;for(let p=0,g=u.length;p<g;++p){let f=u[p];if(!f)continue;let m=this.createRowNode(f,h);if(m.sourceRowIndex=r,o[r++]=m,l&&!l.has(f)){l.add(f),m.treeParent=c;let C=a(f);C&&d(m,C)}}};d(s,e),o.length=r}setImmutableRowData(e,t){let{rootNode:i,gos:n}=this;this.dispatchRowDataUpdateStarted(t);let s=Ba(n),o=e.changedRowNodes,{adds:r,updates:a}=o,l=new Set,d=[],c=this.beans.groupStage?.getNestedDataGetter(),u=n.get("suppressMaintainUnsortedOrder")?void 0:!1,h=-1,p=!1,g=(C,v)=>{if(!u&&u!==void 0){let w=C.sourceRowIndex;u=w<=h,h=w}C.data!==v&&(C.updateData(v),r.has(C)||a.add(C),!C.selectable&&C.isSelected()&&d.push(C))},f=(C,v,w)=>{for(let y=0,S=v.length;y<S;++y){let x=v[y];if(!x)continue;let E=this.getRowNode(s({data:x,level:w}));if(E?(g(E,x),p||(p=!!c&&E.treeParent!==C)):(E=this.createRowNode(x,w),r.add(E)),!c||l.has(E)){l.add(E);continue}l.add(E),E.treeParent=C;let T=c(x);T&&f(E,T,w+1)}};f(i,t,0);let m=this.deleteUnusedNodes(l,o,d)||u||r.size>0;if(m){let C=i._leafs??(i._leafs=[]);u===void 0?BX(C,l,o):NX(C,l)&&(o.reordered=!0)}(m||p||a.size)&&(e.rowDataUpdated=!0,this.deselect(d))}deleteUnusedNodes(e,{removals:t},i){let n=this.rootNode._leafs;for(let s=0,o=n.length;s<o;s++){let r=n[s];e.has(r)||(t.add(r),r.isSelected()&&i.push(r),this.deleteNode(r))}return t.size>0}updateRowData(e,t){if(this.dispatchRowDataUpdateStarted(e.add),this.beans.groupStage?.getNestedDataGetter())return I(268),{remove:[],update:[],add:[]};let i=[],n=Ba(this.gos),s=this.executeRemove(n,e,t,i),o=this.executeUpdate(n,e,t,i),r=this.executeAdd(e,t);return this.deselect(i),{remove:s,update:o,add:r}}executeRemove(e,{remove:t},{adds:i,updates:n,removals:s},o){let r=this.rootNode._leafs,a=r?.length,l=t?.length;if(!l||!a)return[];let d=0,c=a,u=0,h,p=new Array(l);for(let g=0;g<l;++g){let f=this.lookupNode(e,t[g]);if(!f)continue;let m=f.sourceRowIndex;m<c&&(c=m),m>u&&(u=m),f.isSelected()&&o.push(f),this.deleteNode(f),i.delete(f)?(h??(h=new Set),h.add(f)):(n.delete(f),s.add(f)),p[d++]=f}return p.length=d,d&&OX(r,c,u,s,h),p}executeUpdate(e,{update:t},{adds:i,updates:n},s){let o=t?.length;if(!o)return[];let r=new Array(o),a=0;for(let l=0;l<o;l++){let d=t[l],c=this.lookupNode(e,d);c&&(c.updateData(d),!c.selectable&&c.isSelected()&&s.push(c),r[a++]=c,i.has(c)||n.add(c))}return r.length=a,r}executeAdd(e,t){var i;let n=(i=this.rootNode)._leafs??(i._leafs=[]),s=n.length,o=e.add,r=o?.length;if(!r)return[];let a=s+r,l=this.sanitizeAddIndex(n,e.addIndex);if(l<s){for(let u=s-1,h=a-1;u>=l;--u){let p=n[u];p.sourceRowIndex=h,n[h--]=p}t.reordered=!0}n.length=a;let d=new Array(r),c=t.adds;for(let u=0;u<r;u++){let h=this.createRowNode(o[u],0);c.add(h),h.sourceRowIndex=l,n[l]=h,d[u]=h,l++}return d}dispatchRowDataUpdateStarted(e){this.eventSvc.dispatchEvent({type:"rowDataUpdateStarted",firstRowData:e?.length?e[0]:null})}deselect(e){let t="rowDataChanged",i=this.beans.selectionSvc;e.length&&i?.setNodesSelected({newValue:!1,nodes:e,suppressFinishActions:!0,source:t}),i?.updateGroupsFromChildrenSelections?.(t),e.length&&this.eventSvc.dispatchEvent({type:"selectionChanged",source:t,selectedNodes:i?.getSelectedNodes()??null,serverSideState:null})}createRowNode(e,t){let i=new co(this.beans);i.parent=this.rootNode,i.level=t,i.group=!1,i.expanded=!1,i.setDataAndId(e,String(this.nextId++));let n=i.id,s=this.allNodesMap;return s[n]&&I(2,{nodeId:n}),s[n]=i,i}deleteNode(e){e.clearRowTopAndRowIndex();let t=e.id,i=this.allNodesMap;i[t]===e&&delete i[t];let n=e.pinnedSibling;n&&this.beans.pinnedRowModel?.pinRow(n,null)}lookupNode(e,t){if(!e)return LX(this.rootNode._leafs,t);let i=e({data:t,level:0}),n=this.allNodesMap[i];return n||(Ge(4,{id:i}),null)}sanitizeAddIndex(e,t){let i=e.length;if(typeof t!="number"||t<0||t>=i||Number.isNaN(t))return i;t=Math.ceil(t);let n=this.gos;return t>0&&n.get("treeData")&&n.get("getDataPath")&&(t=_X(e,t)),t}},_X=(e,t)=>{for(let i=0,n=e.length;i<n;i++)if(e[i]?.rowIndex==t-1)return i+1;return t},E6=e=>{e.group=!0,e.level=-1,e.id="ROOT_NODE_ID",e._leafs?.length!==0&&(e._leafs=[]);let t=[],i=[],n=[],s=[];e.childrenAfterGroup=t,e.childrenAfterSort=i,e.childrenAfterAggFilter=n,e.childrenAfterFilter=s;let o=e.sibling;return o&&(o.childrenAfterGroup=t,o.childrenAfterSort=i,o.childrenAfterAggFilter=n,o.childrenAfterFilter=s,o.childrenMapped=e.childrenMapped),e.updateHasChildren(),e},LX=(e,t)=>{if(e)for(let i=0,n=e.length;i<n;i++){let s=e[i];if(s.data===t)return s}return Ge(5,{data:t}),null},OX=(e,t,i,n,s)=>{t=Math.max(0,t);for(let o=t,r=e.length;o<r;++o){let a=e[o];o<=i&&(n.has(a)||s?.has(a))||(a.sourceRowIndex=t,e[t++]=a)}e.length=t},NX=(e,t)=>{let i=t.size;e.length=i;let n=0,s=!1,o=!1;for(let r of t){let a=r.sourceRowIndex;a===n?o||(o=s):(a>=0?o=!0:s=!0,r.sourceRowIndex=n,e[n]=r),++n}return o},BX=(e,t,{removals:i,adds:n})=>{let s=e.length;e.length=t.size;let o=0;for(let r=0;r<s;++r){let a=e[r];i.has(a)||(o!==r&&(a.sourceRowIndex=o,e[o]=a),++o)}for(let r of n)r.sourceRowIndex<0&&(r.sourceRowIndex=o,e[o++]=r);e.length=o},ND=e=>{let t=e.childrenAfterSort,i=e.sibling;if(i&&(i.childrenAfterSort=t),!!t)for(let n=0,s=t.length-1;n<=s;n++){let o=t[n],r=n===0,a=n===s;o.firstChild!==r&&(o.firstChild=r,o.dispatchRowEvent("firstChildChanged")),o.lastChild!==a&&(o.lastChild=a,o.dispatchRowEvent("lastChildChanged")),o.childIndex!==n&&(o.childIndex=n,o.dispatchRowEvent("childIndexChanged"))}},HX=class extends F{constructor(){super(...arguments),this.beanName="sortStage",this.step="sort",this.refreshProps=["postSortRows","groupDisplayType","accentedSort"]}execute(e){let t=this.beans.sortSvc.getSortOptions(),i=t.length>0&&!!e.changedRowNodes&&this.gos.get("deltaSort");this.sort(t,i,e.changedRowNodes,e.changedPath)}sort(e,t,i,n){let{gos:s,colModel:o,rowGroupColsSvc:r,rowNodeSorter:a,rowRenderer:l,showRowGroupCols:d}=this.beans,c=s.get("groupMaintainOrder"),u=o.getCols().some(v=>v.isRowGroupActive()),h=r?.columns,p=o.isPivotMode(),g=s.getCallback("postSortRows"),f=!1,m,C=v=>{let w=p&&v.leafGroup,y=c&&u&&!v.leafGroup;y&&(m??(m=this.shouldSortContainsGroupCols(e)),y&&(y=!m));let S=null;if(y){let x=!1;if(h){let E=v.level+1;E<h.length&&(x=h[E].getSort()===null)}x||(S=zX(v))}else!e.length||w||(t&&i?S=VX(a,v,i,n,e):S=a.doFullSort(v.childrenAfterAggFilter,e));if(S||(S=v.childrenAfterAggFilter?.slice(0)??[]),f||(f=v.childrenAfterSort?.[0]!==S[0]),v.childrenAfterSort=S,ND(v),g){let x={nodes:v.childrenAfterSort};g(x)}};if(n?.forEachChangedNodeDepthFirst(C),f&&s.get("groupHideOpenParents")){let v=d?.getShowRowGroupCols();v?.length&&l.refreshCells({columns:v,force:!0})}}shouldSortContainsGroupCols(e){let t=e.length;if(!t)return!1;if(Ln(this.gos)){for(let i=0;i<t;++i){let n=e[i].column;if(n.isPrimary()&&n.isRowGroupActive())return!0}return!1}for(let i=0;i<t;++i)if(e[i].column.getColDef().showRowGroup)return!0;return!1}},VX=(e,t,i,n,s)=>{let o=t.childrenAfterAggFilter,r=t.childrenAfterSort;if(!r)return e.doFullSort(o,s);let a=new Set,l=[],{updates:d,adds:c}=i;for(let h=0,p=o.length;h<p;++h){let g=o[h];d.has(g)||c.has(g)||n&&!n.canSkip(g)?l.push({currentPos:l.length,rowNode:g}):a.add(g)}let u=r.filter(h=>a.has(h)).map((h,p)=>({currentPos:p,rowNode:h}));return l.sort((h,p)=>e.compareRowNodes(s,h,p)),GX(e,s,l,u)},GX=(e,t,i,n)=>{let s=0,o=0,r=i.length,a=n.length,l=new Array(r+a),d=0;for(;s<r&&o<a;){let c=i[s],u=n[o];e.compareRowNodes(t,c,u)<0?(l[d++]=c.rowNode,++s):(l[d++]=u.rowNode,++o)}for(;s<r;)l[d++]=i[s++].rowNode;for(;o<a;)l[d++]=n[o++].rowNode;return l},zX=e=>{let t=e.childrenAfterSort,i=e.childrenAfterAggFilter,n=t?.length,s=i?.length;if(!n||!s)return null;let o=new Array(s),r=new Set;for(let l=0;l<s;++l)r.add(i[l]);let a=0;for(let l=0;l<n;++l){let d=t[l];r.delete(d)&&(o[a++]=d)}if(r.size===0&&a===n)return t;for(let l of r)o[a++]=l;return o.length=a,o},WX=class extends F{constructor(){super(...arguments),this.beanName="rowModel",this.rootNode=null,this.rowCountReady=!1,this.nodeManager=void 0,this.rowsToDisplay=[],this.rowDataUpdatedPending=!1,this.asyncTransactions=null,this.asyncTransactionsTimer=0,this.started=!1,this.refreshingModel=!1,this.rowNodesCountReady=!1,this.stages=[],this.stagesRefreshProps=new Map,this.onRowHeightChanged_debounced=qt(this,this.onRowHeightChanged.bind(this),100)}postConstruct(){let e=this.beans,t=new co(e);this.rootNode=t,this.nodeManager=this.createBean(new IX(t));let i=this.refreshModel.bind(this,{step:"group"}),n=this.refreshModel.bind(this,{step:"group",afterColumnsChanged:!0,keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame")});this.addManagedEventListeners({newColumnsLoaded:n,columnRowGroupChanged:i,columnValueChanged:this.onValueChanged.bind(this),columnPivotChanged:this.refreshModel.bind(this,{step:"pivot"}),filterChanged:this.onFilterChanged.bind(this),sortChanged:this.onSortChanged.bind(this),columnPivotModeChanged:i,gridStylesChanged:this.onGridStylesChanges.bind(this),gridReady:this.onGridReady.bind(this),rowExpansionStateChanged:this.onRowGroupOpened.bind(this)}),this.addPropertyListeners()}addPropertyListeners(){let{beans:e,stagesRefreshProps:t}=this,i=[e.groupStage,e.filterStage,e.pivotStage,e.aggStage,e.sortStage,e.filterAggStage,e.flattenStage].filter(n=>!!n);this.stages=i;for(let n=i.length-1;n>=0;--n)for(let s of i[n].refreshProps)t.set(s,n);this.addManagedPropertyListeners([...t.keys()],n=>{let s=n.changeSet?.properties;s&&this.onPropChange(s)}),this.addManagedPropertyListener("rowData",()=>this.onPropChange(["rowData"])),this.addManagedPropertyListener("rowHeight",()=>this.resetRowHeights())}start(){this.started=!0,this.rowNodesCountReady?this.refreshModel({step:"group",rowDataUpdated:!0,newData:!0}):this.setInitialData()}setInitialData(){this.gos.get("rowData")&&this.onPropChange(["rowData"])}ensureRowHeightsValid(e,t,i,n){let s,o=!1;do{s=!1;let r=this.getRowIndexAtPixel(e),a=this.getRowIndexAtPixel(t),l=Math.max(r,i),d=Math.min(a,n);for(let c=l;c<=d;c++){let u=this.getRow(c);if(u.rowHeightEstimated){let h=ao(this.beans,u);u.setRowHeight(h.height),s=!0,o=!0}}s&&this.setRowTopAndRowIndex()}while(s);return o}onPropChange(e){let{nodeManager:t,gos:i,beans:n}=this,s=n.groupStage;if(!t)return;let o=new Set(e),r=s?.onPropChange(o),a;o.has("rowData")?a=i.get("rowData"):r&&(a=s?.extractData()),a&&!Array.isArray(a)&&(a=null,I(1));let l={step:"nothing",changedProps:o};a&&(!r&&!this.isEmpty()&&a.length>0&&i.exists("getRowId")&&!i.get("resetRowDataOnUpdate")?(l.keepRenderedRows=!0,l.animate=!i.get("suppressAnimationFrame"),l.changedRowNodes=new Mp,t.setImmutableRowData(l,a)):(l.rowDataUpdated=!0,l.newData=!0,t.setNewRowData(a),this.rowNodesCountReady=!0));let d=l.rowDataUpdated?"group":this.getRefreshedStage(e);d&&(l.step=d,this.refreshModel(l))}getRefreshedStage(e){let{stages:t,stagesRefreshProps:i}=this,n=t.length,s=n;for(let o=0,r=e.length;o<r&&s;++o)s=Math.min(s,i.get(e[o])??s);return s<n?t[s].step:null}setRowTopAndRowIndex(e){let{beans:t,rowsToDisplay:i}=this,n=t.environment.getDefaultRowHeight(),s=0,o=jt(this.gos,"normal");for(let r=0,a=i.length;r<a;++r){let l=i[r],d=l.id;if(d!=null&&e?.add(d),l.rowHeight==null){let c=ao(t,l,o,n);l.setRowHeight(c.height,c.estimated)}l.setRowTop(s),l.setRowIndex(r),s+=l.rowHeight}}clearRowTopAndRowIndex(e,t){let i=e.active,n=r=>{r?.id!=null&&!t.has(r.id)&&r.clearRowTopAndRowIndex()},s=r=>{n(r),n(r.detailNode),n(r.sibling);let a=r.childrenAfterGroup;if(!r.hasChildren()||!a)return;let l=r.level==-1;if(!(i&&!l&&!r.expanded))for(let c=0,u=a.length;c<u;++c)s(a[c])},o=this.rootNode;o&&s(o)}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay.length}getTopLevelRowCount(){let{rootNode:e,rowsToDisplay:t}=this;if(!e||!t.length)return 0;if(t[0]===e)return 1;let n=e.sibling?.displayed?1:0;return(e.childrenAfterSort?.length??0)+n}getTopLevelRowDisplayedIndex(e){let{beans:t,rootNode:i,rowsToDisplay:n}=this;if(!i||!n.length||n[0]===i)return e;let o=i.childrenAfterSort,r=l=>{let d=o[l];if(this.gos.get("groupHideOpenParents"))for(;d.expanded&&d.childrenAfterSort&&d.childrenAfterSort.length>0;)d=d.childrenAfterSort[0];return d.rowIndex},a=t.footerSvc;return a?a?.getTopDisplayIndex(n,e,o,r):r(e)}getTopLevelIndexFromDisplayedIndex(e){let{rootNode:t,rowsToDisplay:i}=this;if(!t||!i.length||i[0]===t)return e;let s=this.getRow(e);s.footer&&(s=s.sibling);let o=s.parent;for(;o&&o!==t;)s=o,o=s.parent;let r=t.childrenAfterSort?.indexOf(s)??-1;return r>=0?r:e}getRowBounds(e){let t=this.rowsToDisplay[e];return t?{rowTop:t.rowTop,rowHeight:t.rowHeight}:null}onRowGroupOpened(){this.refreshModel({step:"map",keepRenderedRows:!0,animate:Pa(this.gos)})}onFilterChanged({afterDataChange:e,columns:t}){if(!e){let n=t.length===0||t.some(s=>s.isPrimary())?"filter":"filter_aggregates";this.refreshModel({step:n,keepRenderedRows:!0,animate:Pa(this.gos)})}}onSortChanged(){this.refreshModel({step:"sort",keepRenderedRows:!0,animate:Pa(this.gos)})}getType(){return"clientSide"}onValueChanged(){this.refreshModel({step:this.beans.colModel.isPivotActive()?"pivot":"aggregate"})}createChangePath(e){let t=new Hd(!1,this.rootNode);return t.active=e,t}isSuppressModelUpdateAfterUpdateTransaction(e){if(!this.gos.get("suppressModelUpdateAfterUpdateTransaction"))return!1;let{changedRowNodes:t,newData:i,rowDataUpdated:n}=e;return!(!t||i||!n||t.removals.size||t.adds.size)}refreshModel(e){let{nodeManager:t,beans:i,eventSvc:n,started:s,refreshingModel:o}=this;if(!t)return;let r=!!e.rowDataUpdated,a=e.changedPath??(e.changedPath=this.createChangePath(!e.newData&&r));if(s&&r&&n.dispatchEvent({type:"rowDataUpdated"}),!s||o||i.colModel.changeEventsDispatching||this.isSuppressModelUpdateAfterUpdateTransaction(e)){this.rowDataUpdatedPending||(this.rowDataUpdatedPending=r);return}switch(this.rowDataUpdatedPending&&(this.rowDataUpdatedPending=!1,e.step="group"),this.refreshingModel=!0,i.masterDetailSvc?.refreshModel(e),r&&e.step!=="group"&&i.colFilter?.refreshModel(),e.step){case"group":this.doGrouping(e);case"filter":this.doFilter(a);case"pivot":this.doPivot(a);case"aggregate":this.doAggregate(a);case"filter_aggregates":this.doFilterAggregates(a);case"sort":this.doSort(e.changedRowNodes,a);case"map":this.doRowsToDisplay()}let l=new Set;this.setRowTopAndRowIndex(l),this.clearRowTopAndRowIndex(a,l),this.refreshingModel=!1,n.dispatchEvent({type:"modelUpdated",animate:e.animate,keepRenderedRows:e.keepRenderedRows,newData:e.newData,newPage:!1,keepUndoRedoStack:e.keepUndoRedoStack})}isEmpty(){return!this.rootNode?._leafs?.length||!this.beans.colModel?.ready}isRowsToRender(){return this.rowsToDisplay.length>0}getNodesInRangeForSelection(e,t){let i=!1,n=!1,s=[],o=Od(this.gos);return this.forEachNodeAfterFilterAndSort(r=>{if(n)return;if(i&&(r===t||r===e)&&(n=!0,o&&r.group)){BD(s,r);return}if(!i){if(r!==t&&r!==e)return;i=!0,t===e&&(n=!0)}(!r.group||!o)&&s.push(r)}),s}getTopLevelNodes(){return this.rootNode?.childrenAfterGroup??null}getRow(e){return this.rowsToDisplay[e]}isRowPresent(e){return this.rowsToDisplay.indexOf(e)>=0}getRowIndexAtPixel(e){let t=this.rowsToDisplay,i=t.length;if(this.isEmpty()||i===0)return-1;let n=0,s=i-1;if(e<=0)return 0;if(t[s].rowTop<=e)return s;let r=-1,a=-1;for(;;){let l=Math.floor((n+s)/2),d=t[l];if(this.isRowInPixel(d,e)||(d.rowTop<e?n=l+1:d.rowTop>e&&(s=l-1),r===n&&a===s))return l;r=n,a=s}}isRowInPixel(e,t){let i=e.rowTop,n=i+e.rowHeight;return i<=t&&n>t}forEachLeafNode(e){let t=this.rootNode?._leafs;if(t)for(let i=0,n=t.length;i<n;++i)e(t[i],i)}forEachNode(e,t=!1){this.depthFirstSearchRowNodes(e,t)}forEachDisplayedNode(e){let t=this.rowsToDisplay;for(let i=0,n=t.length;i<n;++i)e(t[i],i)}forEachNodeAfterFilter(e,t=!1){this.depthFirstSearchRowNodes(e,t,i=>i.childrenAfterAggFilter)}forEachNodeAfterFilterAndSort(e,t=!1){this.depthFirstSearchRowNodes(e,t,i=>i.childrenAfterSort)}forEachPivotNode(e,t,i){let{colModel:n,rowGroupColsSvc:s}=this.beans;if(!n.isPivotMode())return;if(!s?.columns.length){e(this.rootNode,0);return}let o=i?"childrenAfterSort":"childrenAfterGroup";this.depthFirstSearchRowNodes(e,t,r=>r.leafGroup?null:r[o])}depthFirstSearchRowNodes(e,t=!1,i=o=>o.childrenAfterGroup,n=this.rootNode,s=0){let o=s;if(!n)return o;let r=n===this.rootNode;if(r||e(n,o++),n.hasChildren()&&!n.footer){let a=i(n);if(a){let l=this.beans.footerSvc;o=l?.addTotalRows(o,n,e,t,r,"top")??o;for(let d of a)o=this.depthFirstSearchRowNodes(e,t,i,d,o);return l?.addTotalRows(o,n,e,t,r,"bottom")??o}}return o}doAggregate(e){let t=this.rootNode;t&&this.beans.aggStage?.execute({rowNode:t,changedPath:e})}doFilterAggregates(e){let t=this.rootNode,i=this.beans.filterAggStage;if(i){i.execute({rowNode:t,changedPath:e});return}t.childrenAfterAggFilter=t.childrenAfterFilter}doSort(e,t){let i=this.beans.sortStage;if(i){i.execute({rowNode:this.rootNode,changedRowNodes:e,changedPath:t});return}t.forEachChangedNodeDepthFirst(n=>{n.childrenAfterSort=n.childrenAfterAggFilter.slice(0),ND(n)})}doGrouping(e){let t=this.rootNode,n=this.beans.groupStage?.execute({rowNode:t,changedRowNodes:e.changedRowNodes,changedPath:e.changedPath,afterColumnsChanged:!!e.afterColumnsChanged});if(n===void 0){let s=t._leafs;t.childrenAfterGroup=s,t.updateHasChildren();let o=t.sibling;o&&(o.childrenAfterGroup=s)}(n||e.rowDataUpdated)&&this.beans.colFilter?.refreshModel(),!this.rowCountReady&&this.rowNodesCountReady&&(this.rowCountReady=!0,this.eventSvc.dispatchEventOnce({type:"rowCountReady"}))}doFilter(e){let t=this.beans.filterStage;if(t){t.execute({rowNode:this.rootNode,changedPath:e});return}e.forEachChangedNodeDepthFirst(i=>{i.childrenAfterFilter=i.childrenAfterGroup,dD(i)},!0)}doPivot(e){this.beans.pivotStage?.execute({rowNode:this.rootNode,changedPath:e})}getRowNode(e){let t=this.nodeManager?.getRowNode(e);return typeof t=="object"?t:typeof e=="string"&&e.indexOf(gv)===0?this.beans.groupStage?.getNode(e):void 0}batchUpdateRowData(e,t){if(!this.asyncTransactionsTimer){this.asyncTransactions=[];let i=this.gos.get("asyncTransactionWaitMillis");this.asyncTransactionsTimer=setTimeout(()=>this.executeBatchUpdateRowData(),i)}this.asyncTransactions.push({rowDataTransaction:e,callback:t})}flushAsyncTransactions(){let e=this.asyncTransactionsTimer;e&&(clearTimeout(e),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){let{nodeManager:e,beans:t,eventSvc:i,asyncTransactions:n}=this;if(!e)return;t.valueCache?.onDataChanged();let s=[],o=[],r=new Mp;for(let{rowDataTransaction:a,callback:l}of n??[]){this.rowNodesCountReady=!0;let d=e.updateRowData(a,r);s.push(d),l&&o.push(l.bind(null,d))}this.commitTransactions(r),o.length>0&&setTimeout(()=>{for(let a=0,l=o.length;a<l;a++)o[a]()},0),s.length>0&&i.dispatchEvent({type:"asyncTransactionsFlushed",results:s}),this.asyncTransactionsTimer=0,this.asyncTransactions=null}updateRowData(e){let t=this.nodeManager;if(!t)return null;this.beans.valueCache?.onDataChanged(),this.rowNodesCountReady=!0;let i=new Mp,n=t.updateRowData(e,i);return this.commitTransactions(i),n}commitTransactions(e){this.refreshModel({step:"group",rowDataUpdated:!0,keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame"),changedRowNodes:e,changedPath:this.createChangePath(!0)})}doRowsToDisplay(){let{beans:e,rootNode:t}=this,i=e.flattenStage;if(i){this.rowsToDisplay=i.execute({rowNode:t});return}let n=this.rootNode.childrenAfterSort??[];for(let s of n)s.setUiLevel(0);this.rowsToDisplay=n}onRowHeightChanged(){this.refreshModel({step:"map",keepRenderedRows:!0,keepUndoRedoStack:!0})}resetRowHeights(){let e=this.rootNode;if(!e)return;let t=this.resetRowHeightsForAllRowNodes();e.setRowHeight(e.rowHeight,!0);let i=e.sibling;i?.setRowHeight(i.rowHeight,!0),t&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let e=!1;return this.forEachNode(t=>{t.setRowHeight(t.rowHeight,!0);let i=t.detailNode;i?.setRowHeight(i.rowHeight,!0);let n=t.sibling;n?.setRowHeight(n.rowHeight,!0),e=!0}),e}onGridStylesChanges(e){e.rowHeightChanged&&!this.beans.rowAutoHeight?.active&&this.resetRowHeights()}onGridReady(){this.started||this.setInitialData()}destroy(){super.destroy(),this.nodeManager=this.destroyBean(this.nodeManager),this.started=!1,this.rootNode=null,this.rowsToDisplay=[],this.asyncTransactions=null,clearTimeout(this.asyncTransactionsTimer)}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}},BD=(e,t)=>{let i=t.childrenAfterGroup;if(i)for(let n=0,s=i.length;n<s;++n){let o=i[n];o.data&&e.push(o),o.group&&BD(e,o)}};function UX(e){e.expansionSvc?.onGroupExpandedOrCollapsed()}function qX(e,t){let i=go(e);i&&((!t||t==="everything")&&(t="group"),i.refreshModel({step:t,keepRenderedRows:!0,animate:!e.gos.get("suppressAnimationFrame")}))}function $X(e){return go(e)?.isEmpty()??!0}function jX(e,t){go(e)?.forEachLeafNode(t)}function KX(e,t){go(e)?.forEachNodeAfterFilter(t)}function YX(e,t){go(e)?.forEachNodeAfterFilterAndSort(t)}function XX(e,t){return e.frameworkOverrides.wrapIncoming(()=>go(e)?.updateRowData(t))}function JX(e,t,i){e.frameworkOverrides.wrapIncoming(()=>go(e)?.batchUpdateRowData(t,i))}function QX(e){e.frameworkOverrides.wrapIncoming(()=>go(e)?.flushAsyncTransactions())}function ZX(e){return e.selectionSvc?.getBestCostNodeSelection()}var eJ={moduleName:"ClientSideRowModel",version:q,rowModels:["clientSide"],beans:[WX,HX],dependsOn:[nD]},tJ={moduleName:"ClientSideRowModelApi",version:q,apiFunctions:{onGroupExpandedOrCollapsed:UX,refreshClientSideRowModel:qX,isRowDataEmpty:$X,forEachLeafNode:jX,forEachNodeAfterFilter:KX,forEachNodeAfterFilterAndSort:YX,applyTransaction:XX,applyTransactionAsync:JX,flushAsyncTransactions:QX,getBestCostNodeSelection:ZX,resetRowHeights:OD,onRowHeightChanged:LD},dependsOn:[kX,PX]},iJ=class extends F{constructor(){super(...arguments),this.beanName="gridSerializer"}wireBeans(e){this.visibleCols=e.visibleCols,this.colModel=e.colModel,this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel}serialize(e,t={}){let{allColumns:i,columnKeys:n,skipRowGroups:s,exportRowNumbers:o}=t,r=this.getColumnsToExport({allColumns:i,skipRowGroups:s,columnKeys:n,exportRowNumbers:o});return[this.prepareSession(r),this.prependContent(t),this.exportColumnGroups(t,r),this.exportHeaders(t,r),this.processPinnedTopRows(t,r),this.processRows(t,r),this.processPinnedBottomRows(t,r),this.appendContent(t)].reduce((a,l)=>l(a),e).parse()}processRow(e,t,i,n){let s=t.shouldRowBeSkipped||(()=>!1),r=t.rowPositions!=null||!!t.onlySelected,a=this.gos.get("groupHideOpenParents")&&!r,l=this.colModel.isPivotMode()?n.leafGroup:!n.group,d=!!n.footer,c=n.allChildrenCount===1&&n.childrenAfterGroup?.length===1&&rN(this.gos,n);if(!l&&!d&&(t.skipRowGroups||c||a)||t.onlySelected&&!n.isSelected()||t.skipPinnedTop&&n.rowPinned==="top"||t.skipPinnedBottom&&n.rowPinned==="bottom"||n.stub||n.level===-1&&!l&&!d||s(ae(this.gos,{node:n})))return;let p=e.onNewBodyRow(n);if(i.forEach((g,f)=>{p.onColumn(g,f,n)}),t.getCustomContentBelowRow){let g=t.getCustomContentBelowRow(ae(this.gos,{node:n}));g&&e.addCustomContent(g)}}appendContent(e){return t=>{let i=e.appendContent;return i&&t.addCustomContent(i),t}}prependContent(e){return t=>{let i=e.prependContent;return i&&t.addCustomContent(i),t}}prepareSession(e){return t=>(t.prepare(e),t)}exportColumnGroups(e,t){return i=>{if(!e.skipColumnGroupHeaders){let n=new D4,{colGroupSvc:s}=this.beans,o=s?s.createColumnGroups({columns:t,idCreator:n,pinned:null,isStandaloneStructure:!0}):t;this.recursivelyAddHeaderGroups(o,i,e.processGroupHeaderCallback)}return i}}exportHeaders(e,t){return i=>{if(!e.skipColumnHeaders){let n=i.onNewHeaderRow();t.forEach((s,o)=>{n.onColumn(s,o,void 0)})}return i}}processPinnedTopRows(e,t){return i=>{let n=this.processRow.bind(this,i,e,t);return e.rowPositions?e.rowPositions.filter(s=>s.rowPinned==="top").sort((s,o)=>s.rowIndex-o.rowIndex).map(s=>this.pinnedRowModel?.getPinnedTopRow(s.rowIndex)).forEach(n):this.pinnedRowModel?.isManual()||this.pinnedRowModel?.forEachPinnedRow("top",n),i}}processRows(e,t){return i=>{let n=this.rowModel,s=wt(this.gos,n),o=Ua(this.gos,n),r=!s&&e.onlySelected,a=this.processRow.bind(this,i,e,t),{exportedRows:l="filteredAndSorted"}=e;if(e.rowPositions)e.rowPositions.filter(d=>d.rowPinned==null).sort((d,c)=>d.rowIndex-c.rowIndex).map(d=>n.getRow(d.rowIndex)).forEach(a);else if(this.colModel.isPivotMode())s?n.forEachPivotNode(a,!0,l==="filteredAndSorted"):o?n.forEachNodeAfterFilterAndSort(a,!0):n.forEachNode(a);else if(e.onlySelectedAllPages||r){let d=this.beans.selectionSvc?.getSelectedNodes()??[];this.replicateSortedOrder(d),d.forEach(a)}else l==="all"?n.forEachNode(a):s||o?n.forEachNodeAfterFilterAndSort(a,!0):n.forEachNode(a);return i}}replicateSortedOrder(e){let{sortSvc:t,rowNodeSorter:i}=this.beans;if(!t||!i)return;let n=t.getSortOptions(),s=(o,r)=>o.rowIndex!=null&&r.rowIndex!=null?o.rowIndex-r.rowIndex:o.level===r.level?o.parent?.id===r.parent?.id?i.compareRowNodes(n,{rowNode:o,currentPos:o.rowIndex??-1},{rowNode:r,currentPos:r.rowIndex??-1}):s(o.parent,r.parent):o.level>r.level?s(o.parent,r):s(o,r.parent);e.sort(s)}processPinnedBottomRows(e,t){return i=>{let n=this.processRow.bind(this,i,e,t);return e.rowPositions?e.rowPositions.filter(s=>s.rowPinned==="bottom").sort((s,o)=>s.rowIndex-o.rowIndex).map(s=>this.pinnedRowModel?.getPinnedBottomRow(s.rowIndex)).forEach(n):this.pinnedRowModel?.isManual()||this.pinnedRowModel?.forEachPinnedRow("bottom",n),i}}getColumnsToExport(e){let{allColumns:t=!1,skipRowGroups:i=!1,exportRowNumbers:n=!1,columnKeys:s}=e,{colModel:o,gos:r,visibleCols:a}=this,l=o.isPivotMode(),d=h=>Fs(h)?!1:!Es(h)||n;if(s?.length)return o.getColsForKeys(s).filter(d);let c=r.get("treeData"),u=[];return t&&!l?u=o.getCols():u=a.allCols,u=u.filter(h=>d(h)&&(i&&!c?!Wv(h):!0)),u}recursivelyAddHeaderGroups(e,t,i){let n=[];for(let s of e){let o=s;if(o.getChildren)for(let r of o.getChildren()??[])n.push(r)}e.length>0&&vt(e[0])&&this.doAddHeaderHeader(t,e,i),n&&n.length>0&&this.recursivelyAddHeaderGroups(n,t,i)}doAddHeaderHeader(e,t,i){let n=e.onNewHeaderGroupingRow(),s=0;for(let o of t){let r=o,a;i?a=i(ae(this.gos,{columnGroup:r})):a=this.beans.colNames.getDisplayNameForColumnGroup(r,"header");let d=(r.isExpandable()?r.getLeafColumns():[]).reduce((c,u,h,p)=>{let g=je(c);return u.getColumnGroupShow()==="open"?(!g||g[1]!=null)&&(g=[h],c.push(g)):g&&g[1]==null&&(g[1]=h-1),h===p.length-1&&g&&g[1]==null&&(g[1]=h),c},[]);n.onColumn(r,a||"",s++,r.getLeafColumns().length-1,d)}}},nJ={moduleName:"SharedExport",version:q,beans:[iJ]},R6=`\r
`,sJ=class extends Aj{constructor(e){super(e),this.config=e,this.isFirstLine=!0,this.result="";let{suppressQuotes:t,columnSeparator:i}=e;this.suppressQuotes=t,this.columnSeparator=i}addCustomContent(e){e&&(typeof e=="string"?(/^\s*\n/.test(e)||this.beginNewLine(),e=e.replace(/\r?\n/g,R6),this.result+=e):e.forEach(t=>{this.beginNewLine(),t.forEach((i,n)=>{n!==0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(i.data.value||""),i.mergeAcross&&this.appendEmptyCells(i.mergeAcross)})}))}onNewHeaderGroupingRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}onNewHeaderGroupingRowColumn(e,t,i,n){i!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(t),this.appendEmptyCells(n)}appendEmptyCells(e){for(let t=1;t<=e;t++)this.result+=this.columnSeparator+this.putInQuotes("")}onNewHeaderRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}onNewHeaderRowColumn(e,t){t!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(e))}onNewBodyRow(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}onNewBodyRowColumn(e,t,i){t!=0&&(this.result+=this.columnSeparator);let n=this.extractRowCellValue(e,t,t,"csv",i);this.result+=this.putInQuotes(n.valueFormatted??n.value)}putInQuotes(e){if(this.suppressQuotes)return e;if(e==null)return'""';let t;return typeof e=="string"?t=e:typeof e.toString=="function"?t=e.toString():(I(53),t=""),'"'+t.replace(/"/g,'""')+'"'}parse(){return this.result}beginNewLine(){this.isFirstLine||(this.result+=R6),this.isFirstLine=!1}},oJ=class extends Tj{constructor(){super(...arguments),this.beanName="csvCreator"}wireBeans(e){this.colModel=e.colModel,this.colNames=e.colNames,this.rowGroupColsSvc=e.rowGroupColsSvc,this.valueSvc=e.valueSvc}getMergedParams(e){let t=this.gos.get("defaultCsvExportParams");return Object.assign({},t,e)}export(e){if(this.isExportSuppressed()){I(51);return}let t=this.getMergedParams(e),i=this.getData(t),n=new Blob(["\uFEFF",i],{type:"text/plain"}),s=typeof t.fileName=="function"?t.fileName(ae(this.gos,{})):t.fileName;Ij(this.getFileName(s),n)}exportDataAsCsv(e){this.export(e)}getDataAsCsv(e,t=!1){let i=t?Object.assign({},e):this.getMergedParams(e);return this.getData(i)}getDefaultFileExtension(){return"csv"}createSerializingSession(e){let{colModel:t,colNames:i,rowGroupColsSvc:n,valueSvc:s,gos:o}=this,{processCellCallback:r,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:d,suppressQuotes:c,columnSeparator:u}=e;return new sJ({colModel:t,colNames:i,valueSvc:s,gos:o,processCellCallback:r||void 0,processHeaderCallback:a||void 0,processGroupHeaderCallback:l||void 0,processRowGroupCallback:d||void 0,suppressQuotes:c||!1,columnSeparator:u||",",rowGroupColsSvc:n})}isExportSuppressed(){return this.gos.get("suppressCsvExport")}};function rJ(e,t){return e.csvCreator?.getDataAsCsv(t)}function aJ(e,t){e.csvCreator?.exportDataAsCsv(t)}var lJ={moduleName:"CsvExport",version:q,beans:[oJ],apiFunctions:{getDataAsCsv:rJ,exportDataAsCsv:aJ},dependsOn:[nJ]},dJ=class extends F{constructor(e,t,i){super(),this.id=e,this.parentCache=t,this.params=i,this.state="needsLoading",this.version=0,this.startRow=e*i.blockSize,this.endRow=this.startRow+i.blockSize}load(){this.state="loading",this.loadFromDatasource()}setStateWaitingToLoad(){this.version++,this.state="needsLoading"}pageLoadFailed(e){this.isRequestMostRecentAndLive(e)&&(this.state="failed"),this.dispatchLocalEvent({type:"loadComplete"})}pageLoaded(e,t,i){this.successCommon(e,{rowData:t,rowCount:i})}isRequestMostRecentAndLive(e){let t=e===this.version,i=this.isAlive();return t&&i}successCommon(e,t){this.dispatchLocalEvent({type:"loadComplete"}),this.isRequestMostRecentAndLive(e)&&(this.state="loaded",this.processServerResult(t))}postConstruct(){this.rowNodes=[];let{params:{blockSize:e,rowHeight:t},startRow:i,beans:n,rowNodes:s}=this;for(let o=0;o<e;o++){let r=i+o,a=new co(n);a.setRowHeight(t),a.uiLevel=0,a.setRowIndex(r),a.setRowTop(t*r),s.push(a)}}getBlockStateJson(){let{id:e,startRow:t,endRow:i,state:n}=this;return{id:""+e,state:{blockNumber:e,startRow:t,endRow:i,pageStatus:n}}}setDataAndId(e,t,i){K(t)?e.setDataAndId(t,i.toString()):e.setDataAndId(void 0,void 0)}loadFromDatasource(){let e=this.createLoadParams();if(tt(this.params.datasource.getRows)){I(90);return}window.setTimeout(()=>{this.params.datasource.getRows(e)},0)}createLoadParams(){let{startRow:e,endRow:t,version:i,params:{sortModel:n,filterModel:s},gos:o}=this;return{startRow:e,endRow:t,successCallback:this.pageLoaded.bind(this,i),failCallback:this.pageLoadFailed.bind(this,i),sortModel:n,filterModel:s,context:ae(o,{}).context}}forEachNode(e,t,i){this.rowNodes.forEach((n,s)=>{this.startRow+s<i&&e(n,t.value++)})}getRow(e,t=!1){t||(this.lastAccessed=this.params.lastAccessedSequence.value++);let i=e-this.startRow;return this.rowNodes[i]}processServerResult(e){let{rowNodes:t,beans:i}=this;t.forEach((s,o)=>{let r=e.rowData?e.rowData[o]:void 0;!s.id&&s.alreadyRendered&&r&&(t[o]=new co(i),t[o].setRowIndex(s.rowIndex),t[o].setRowTop(s.rowTop),t[o].setRowHeight(s.rowHeight),s.clearRowTopAndRowIndex()),this.setDataAndId(t[o],r,this.startRow+o)});let n=e.rowCount!=null&&e.rowCount>=0?e.rowCount:void 0;this.parentCache.pageLoaded(this,n)}destroy(){for(let e of this.rowNodes)e.clearRowTopAndRowIndex();super.destroy()}},cJ=2,uJ=class extends F{constructor(e){super(),this.params=e,this.lastRowIndexKnown=!1,this.blocks={},this.blockCount=0,this.rowCount=e.initialRowCount}getRow(e,t=!1){let i=Math.floor(e/this.params.blockSize),n=this.blocks[i];if(!n){if(t)return;n=this.createBlock(i)}return n.getRow(e)}createBlock(e){let t=this.params,i=this.createBean(new dJ(e,this,t));return this.blocks[i.id]=i,this.blockCount++,this.purgeBlocksIfNeeded(i),t.rowNodeBlockLoader.addBlock(i),i}refreshCache(){if(this.blockCount==0){this.purgeCache();return}for(let t of this.getBlocksInOrder())t.setStateWaitingToLoad();this.params.rowNodeBlockLoader.checkBlockToLoad()}destroy(){for(let e of this.getBlocksInOrder())this.destroyBlock(e);super.destroy()}getRowCount(){return this.rowCount}isLastRowIndexKnown(){return this.lastRowIndexKnown}pageLoaded(e,t){this.isAlive()&&(ro(this.gos,`InfiniteCache - onPageLoaded: page = ${e.id}, lastRow = ${t}`),this.checkRowCount(e,t),this.onCacheUpdated())}purgeBlocksIfNeeded(e){let t=this.getBlocksInOrder().filter(r=>r!=e),i=(r,a)=>a.lastAccessed-r.lastAccessed;t.sort(i);let n=this.params.maxBlocksInCache>0,s=n?this.params.maxBlocksInCache-1:null,o=cJ-1;t.forEach((r,a)=>{let l=r.state==="needsLoading"&&a>=o,d=n?a>=s:!1;if(l||d){if(this.isBlockCurrentlyDisplayed(r)||this.isBlockFocused(r))return;this.removeBlockFromCache(r)}})}isBlockFocused(e){let t=this.beans.focusSvc.getFocusCellToUseAfterRefresh();if(!t||t.rowPinned!=null)return!1;let{startRow:i,endRow:n}=e;return t.rowIndex>=i&&t.rowIndex<n}isBlockCurrentlyDisplayed(e){let{startRow:t,endRow:i}=e;return this.beans.rowRenderer.isRangeInRenderedViewport(t,i-1)}removeBlockFromCache(e){e&&this.destroyBlock(e)}checkRowCount(e,t){if(typeof t=="number"&&t>=0)this.rowCount=t,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){let{blockSize:i,overflowSize:n}=this.params,o=(e.id+1)*i+n;this.rowCount<o&&(this.rowCount=o)}}setRowCount(e,t){this.rowCount=e,K(t)&&(this.lastRowIndexKnown=t),this.lastRowIndexKnown||this.rowCount%this.params.blockSize===0&&this.rowCount++,this.onCacheUpdated()}forEachNodeDeep(e){let t={value:0};for(let i of this.getBlocksInOrder())i.forEachNode(e,t,this.rowCount)}getBlocksInOrder(){let e=(i,n)=>i.id-n.id;return Object.values(this.blocks).sort(e)}destroyBlock(e){delete this.blocks[e.id],this.destroyBean(e),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(e)}onCacheUpdated(){this.isAlive()&&(this.destroyAllBlocksPastVirtualRowCount(),this.eventSvc.dispatchEvent({type:"storeUpdated"}))}destroyAllBlocksPastVirtualRowCount(){let e=[];for(let t of this.getBlocksInOrder())t.id*this.params.blockSize>=this.rowCount&&e.push(t);if(e.length>0)for(let t of e)this.destroyBlock(t)}purgeCache(){for(let e of this.getBlocksInOrder())this.removeBlockFromCache(e);this.lastRowIndexKnown=!1,this.rowCount===0&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()}getRowNodesInRange(e,t){let i=[],n=-1,s=!1,o={value:0},r=!1;for(let l of this.getBlocksInOrder())if(!r){if(s&&n+1!==l.id){r=!0;continue}n=l.id,l.forEachNode(d=>{let c=d===e||d===t;(s||c)&&i.push(d),c&&(s=!s)},o,this.rowCount)}return r||s?[]:i}},hJ=class extends F{constructor(){super(...arguments),this.beanName="rowModel",this.rootNode=null}getRowBounds(e){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*e}}ensureRowHeightsValid(){return!1}postConstruct(){if(this.gos.get("rowModelType")!=="infinite")return;let e=this.beans,t=new co(e);this.rootNode=t,t.level=-1,this.rowHeight=ir(e),this.addEventListeners(),this.addDestroyFunc(()=>this.destroyCache())}start(){this.setDatasource(this.gos.get("datasource"))}destroy(){this.destroyDatasource(),super.destroy(),this.rootNode=null}destroyDatasource(){this.datasource&&(this.destroyBean(this.datasource),this.beans.rowRenderer.datasourceChanged(),this.datasource=null)}addEventListeners(){this.addManagedEventListeners({filterChanged:this.reset.bind(this),sortChanged:this.reset.bind(this),newColumnsLoaded:this.onColumnEverything.bind(this),storeUpdated:this.dispatchModelUpdatedEvent.bind(this)}),this.addManagedPropertyListener("datasource",()=>this.setDatasource(this.gos.get("datasource"))),this.addManagedPropertyListener("cacheBlockSize",()=>this.resetCache()),this.addManagedPropertyListener("rowHeight",()=>{this.rowHeight=ir(this.beans),this.cacheParams.rowHeight=this.rowHeight,this.updateRowHeights()})}onColumnEverything(){let e;this.cacheParams?e=!Pd(this.cacheParams.sortModel,this.beans.sortSvc?.getSortModel()??[]):e=!0,e&&this.reset()}getType(){return"infinite"}setDatasource(e){this.destroyDatasource(),this.datasource=e,e&&this.reset()}isEmpty(){return!this.infiniteCache}isRowsToRender(){return!!this.infiniteCache}getNodesInRangeForSelection(e,t){return this.infiniteCache?.getRowNodesInRange(e,t)??[]}reset(){if(!this.datasource)return;Ba(this.gos)!=null||this.beans.selectionSvc?.reset("rowDataChanged"),this.resetCache()}dispatchModelUpdatedEvent(){this.eventSvc.dispatchEvent({type:"modelUpdated",newPage:!1,newPageSize:!1,newData:!1,keepRenderedRows:!0,animate:!1})}resetCache(){this.destroyCache();let e=this.beans,{filterManager:t,sortSvc:i,rowNodeBlockLoader:n,eventSvc:s,gos:o}=e;this.cacheParams={datasource:this.datasource,filterModel:t?.getFilterModel()??{},sortModel:i?.getSortModel()??[],rowNodeBlockLoader:n,initialRowCount:o.get("infiniteInitialRowCount"),maxBlocksInCache:o.get("maxBlocksInCache"),rowHeight:ir(e),overflowSize:o.get("cacheOverflowSize"),blockSize:o.get("cacheBlockSize"),lastAccessedSequence:{value:0}},this.infiniteCache=this.createBean(new uJ(this.cacheParams)),s.dispatchEventOnce({type:"rowCountReady"}),this.dispatchModelUpdatedEvent()}updateRowHeights(){this.forEachNode(e=>{e.setRowHeight(this.rowHeight),e.setRowTop(this.rowHeight*e.rowIndex)}),this.dispatchModelUpdatedEvent()}destroyCache(){this.infiniteCache=this.destroyBean(this.infiniteCache)}getRow(e){let t=this.infiniteCache;if(t&&!(e>=t.getRowCount()))return t.getRow(e)}getRowNode(e){let t;return this.forEachNode(i=>{i.id===e&&(t=i)}),t}forEachNode(e){this.infiniteCache?.forEachNodeDeep(e)}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(e){return e}getRowIndexAtPixel(e){if(this.rowHeight!==0){let t=Math.floor(e/this.rowHeight),i=this.getRowCount()-1;return t>i?i:t}return 0}getRowCount(){return this.infiniteCache?this.infiniteCache.getRowCount():0}isRowPresent(e){return!!this.getRowNode(e.id)}refreshCache(){this.infiniteCache?.refreshCache()}purgeCache(){this.infiniteCache?.purgeCache()}isLastRowIndexKnown(){return this.infiniteCache?.isLastRowIndexKnown()??!1}setRowCount(e,t){this.infiniteCache?.setRowCount(e,t)}resetRowHeights(){}onRowHeightChanged(){}};function pJ(e){rg(e)?.refreshCache()}function gJ(e){rg(e)?.purgeCache()}function fJ(e){return rg(e)?.getRowCount()}var mJ=class extends F{constructor(){super(...arguments),this.beanName="rowNodeBlockLoader",this.activeBlockLoadsCount=0,this.blocks=[],this.active=!0}postConstruct(){this.maxConcurrentRequests=aN(this.gos);let e=this.gos.get("blockLoadDebounceMillis");e&&e>0&&(this.checkBlockToLoadDebounce=qt(this,this.performCheckBlocksToLoad.bind(this),e))}addBlock(e){this.blocks.push(e),e.addEventListener("loadComplete",this.loadComplete.bind(this)),this.checkBlockToLoad()}removeBlock(e){an(this.blocks,e)}destroy(){super.destroy(),this.active=!1}loadComplete(){this.activeBlockLoadsCount--,this.checkBlockToLoad()}checkBlockToLoad(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()}performCheckBlocksToLoad(){if(!this.active)return;if(this.printCacheStatus(),this.maxConcurrentRequests!=null&&this.activeBlockLoadsCount>=this.maxConcurrentRequests){ro(this.gos,"RowNodeBlockLoader - checkBlockToLoad: max loads exceeded");return}let e=this.maxConcurrentRequests!=null?this.maxConcurrentRequests-this.activeBlockLoadsCount:1,t=this.blocks.filter(i=>i.state==="needsLoading").slice(0,e);this.activeBlockLoadsCount+=t.length;for(let i of t)i.load();this.printCacheStatus()}getBlockState(){let e={};return this.blocks.forEach(t=>{let{id:i,state:n}=t.getBlockStateJson();e[i]=n}),e}printCacheStatus(){ro(this.gos,`RowNodeBlockLoader - printCacheStatus: activePageLoadsCount = ${this.activeBlockLoadsCount}, blocks = ${JSON.stringify(this.getBlockState())}`)}},CJ={moduleName:"InfiniteRowModelCore",version:q,rowModels:["infinite"],beans:[hJ,mJ]},vJ={moduleName:"InfiniteRowModel",version:q,apiFunctions:{refreshInfiniteCache:pJ,purgeInfiniteCache:gJ,getInfiniteRowCount:fJ},dependsOn:[CJ,FX]},wJ="\u2191",bJ="\u2193",yJ={tag:"span",children:[{tag:"span",ref:"eDelta",cls:"ag-value-change-delta"},{tag:"span",ref:"eValue",cls:"ag-value-change-value"}]},SJ=class extends Be{constructor(){super(yJ),this.eValue=U,this.eDelta=U,this.refreshCount=0}init(e){this.refresh(e,!0)}showDelta(e,t){let i=Math.abs(t),n=e.formatValue(i),s=K(n)?n:i,o=t>=0,r=this.eDelta;o?r.textContent=wJ+s:r.textContent=bJ+s,r.classList.toggle("ag-value-change-delta-up",o),r.classList.toggle("ag-value-change-delta-down",!o)}setTimerToRemoveDelta(){this.refreshCount++;let e=this.refreshCount;this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.hideDeltaValue()},2e3)})}hideDeltaValue(){this.eValue.classList.remove("ag-value-change-value-highlight"),$t(this.eDelta)}refresh(e,t=!1){let{value:i,valueFormatted:n}=e,{eValue:s,lastValue:o,beans:r}=this;if(i===o||(K(n)?s.textContent=n:K(i)?s.textContent=i:$t(s),r.filterManager?.isSuppressFlashingCellsBecauseFiltering()))return!1;let a=i&&typeof i=="object"&&"toNumber"in i?i.toNumber():i,l=o&&typeof o=="object"&&"toNumber"in o?o.toNumber():o;if(a===l)return!1;if(typeof a=="number"&&typeof l=="number"){let d=a-l;this.showDelta(e,d)}return o&&s.classList.add("ag-value-change-value-highlight"),t||this.setTimerToRemoveDelta(),this.lastValue=i,!0}},xJ=".ag-value-slide-out{opacity:1}:where(.ag-ltr) .ag-value-slide-out{margin-right:5px;transition:opacity 3s,margin-right 3s}:where(.ag-rtl) .ag-value-slide-out{margin-left:5px;transition:opacity 3s,margin-left 3s}:where(.ag-ltr,.ag-rtl) .ag-value-slide-out{transition-timing-function:linear}.ag-value-slide-out-end{opacity:0}:where(.ag-ltr) .ag-value-slide-out-end{margin-right:10px}:where(.ag-rtl) .ag-value-slide-out-end{margin-left:10px}",EJ={tag:"span",children:[{tag:"span",ref:"eCurrent",cls:"ag-value-slide-current"}]},RJ=class extends Be{constructor(){super(EJ),this.eCurrent=U,this.refreshCount=0,this.registerCSS(xJ)}init(e){this.refresh(e,!0)}addSlideAnimation(){this.refreshCount++;let e=this.refreshCount;this.ePrevious?.remove();let{beans:t,eCurrent:i}=this,n=bt({tag:"span",cls:"ag-value-slide-previous ag-value-slide-out"});this.ePrevious=n,n.textContent=i.textContent,this.getGui().insertBefore(n,i),t.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.ePrevious.classList.add("ag-value-slide-out-end")},50),window.setTimeout(()=>{e===this.refreshCount&&(this.ePrevious?.remove(),this.ePrevious=null)},3e3)})}refresh(e,t=!1){let i=e.value;if(tt(i)&&(i=""),i===this.lastValue||this.beans.filterManager?.isSuppressFlashingCellsBecauseFiltering())return!1;t||this.addSlideAnimation(),this.lastValue=i;let n=this.eCurrent;return K(e.valueFormatted)?n.textContent=e.valueFormatted:K(e.value)?n.textContent=i:$t(n),!0}},MJ=class extends F{constructor(){super(...arguments),this.beanName="cellFlashSvc",this.nextAnimationTime=null,this.nextAnimationCycle=null,this.animations={highlight:new Map,"data-changed":new Map}}animateCell(e,t,i=this.beans.gos.get("cellFlashDuration"),n=this.beans.gos.get("cellFadeDuration")){let s=this.animations[t];s.delete(e);let o=Date.now(),r=o+i,a=o+i+n,l={phase:"flash",flashEndTime:r,fadeEndTime:a};s.set(e,l);let d=`ag-cell-${t}`,c=`${d}-animation`,{comp:u,eGui:{style:h}}=e;u.toggleCss(d,!0),u.toggleCss(c,!1),h.removeProperty("transition"),h.removeProperty("transition-delay"),this.nextAnimationTime&&r+15<this.nextAnimationTime&&(clearTimeout(this.nextAnimationCycle),this.nextAnimationCycle=null,this.nextAnimationTime=null),this.nextAnimationCycle||(this.beans.frameworkOverrides.wrapIncoming(()=>{this.nextAnimationCycle=setTimeout(this.advanceAnimations.bind(this),i)}),this.nextAnimationTime=r)}advanceAnimations(){let e=Date.now(),t=null;for(let i of Object.keys(this.animations)){let n=this.animations[i],s=`ag-cell-${i}`,o=`${s}-animation`;for(let[r,a]of n){if(!r.isAlive()||!r.comp){n.delete(r);continue}let{phase:l,flashEndTime:d,fadeEndTime:c}=a,u=l==="flash"?d:c;if(!(e+15>=u)){t=Math.min(u,t??1/0);continue}let{comp:p,eGui:{style:g}}=r;switch(l){case"flash":p.toggleCss(s,!1),p.toggleCss(o,!0),g.transition=`background-color ${c-d}ms`,g.transitionDelay=`${d-e}ms`,t=Math.min(c,t??1/0),a.phase="fade";break;case"fade":p.toggleCss(s,!1),p.toggleCss(o,!1),g.removeProperty("transition"),g.removeProperty("transition-delay"),n.delete(r);break}}}t==null?(this.nextAnimationTime=null,this.nextAnimationCycle=null):t&&(this.nextAnimationCycle=setTimeout(this.advanceAnimations.bind(this),t-e),this.nextAnimationTime=t)}onFlashCells(e,t){if(!e.comp)return;let i=Mz(e.cellPosition);t.cells[i]&&this.animateCell(e,"highlight")}flashCell(e,t){this.animateCell(e,"data-changed",t?.flashDuration,t?.fadeDuration)}destroy(){for(let e of Object.keys(this.animations))this.animations[e].clear()}};function DJ(e,t={}){let{cellFlashSvc:i}=e;i&&e.frameworkOverrides.wrapIncoming(()=>{for(let n of e.rowRenderer.getCellCtrls(t.rowNodes,t.columns))i.flashCell(n,t)})}var kJ={moduleName:"HighlightChanges",version:q,beans:[MJ],userComponents:{agAnimateShowChangeCellRenderer:SJ,agAnimateSlideCellRenderer:RJ},apiFunctions:{flashCells:DJ}};function PJ(e){return e.stateSvc?.getState()??{}}function FJ(e,t,i){return e.stateSvc?.setState(t,i)}function M6(e){return e=b({},e),e.version||(e.version="32.1.0"),e.version==="32.1.0"&&(e=TJ(e)),e.version=q,e}function TJ(e){return e.cellSelection=AJ(e,"rangeSelection"),e}function AJ(e,t){if(e&&typeof e=="object")return e[t]}var IJ=class extends F{constructor(){super(...arguments),this.beanName="stateSvc",this.updateRowGroupExpansionStateTimer=0,this.suppressEvents=!0,this.queuedUpdateSources=new Set,this.dispatchStateUpdateEventDebounced=qt(this,()=>this.dispatchQueuedStateUpdateEvents(),0),this.onRowGroupOpenedDebounced=qt(this,()=>{this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(this.updateCachedState("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("rowGroupExpansion",void 0)):(this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("ssrmRowGroupExpansion",void 0))},0),this.onRowSelectedDebounced=qt(this,()=>{this.staleStateKeys.delete("rowSelection"),this.updateCachedState("rowSelection",this.getRowSelectionState())},0),this.staleStateKeys=new Set}postConstruct(){let{gos:e,ctrlsSvc:t,colDelayRenderSvc:i}=this.beans;this.isClientSideRowModel=wt(e);let n=M6(e.get("initialState")??{}),s=n.partialColumnState;delete n.partialColumnState,this.cachedState=n;let o=this.suppressEventsAndDispatchInitEvent.bind(this);t.whenReady(this,()=>o(()=>this.setupStateOnGridReady(n))),(n.columnOrder||n.columnVisibility||n.columnSizing||n.columnPinning||n.columnGroup)&&i?.hideColumns("columnState");let[r,a,l]=this.addManagedEventListeners({newColumnsLoaded:({source:d})=>{d==="gridInitializing"&&(r(),o(()=>{this.setupStateOnColumnsInitialised(n,!!s),i?.revealColumns("columnState")}))},rowCountReady:()=>{a?.(),o(()=>this.setupStateOnRowCountReady(n))},firstDataRendered:()=>{l?.(),o(()=>this.setupStateOnFirstDataRendered(n))}})}destroy(){super.destroy(),clearTimeout(this.updateRowGroupExpansionStateTimer),this.queuedUpdateSources.clear()}getState(){return this.staleStateKeys.size&&this.refreshStaleState(),this.cachedState}setState(e,t){let i=M6(e);delete i.partialColumnState,this.cachedState=i,this.startSuppressEvents();let n="api",s=t?new Set(t):void 0;this.setGridReadyState(i,n,s),this.setColumnsInitialisedState(i,n,!!s,s),this.setRowCountState(i,n,s),setTimeout(()=>{this.isAlive()&&this.setFirstDataRenderedState(i,n,s),this.stopSuppressEvents(n)})}setGridReadyState(e,t,i){t==="api"&&!i?.has("sideBar")&&this.beans.sideBar?.comp?.setState(e.sideBar),this.updateCachedState("sideBar",this.getSideBarState())}setupStateOnGridReady(e){this.setGridReadyState(e,"gridInitializing");let t=()=>this.updateCachedState("sideBar",this.getSideBarState());this.addManagedEventListeners({toolPanelVisibleChanged:t,sideBarUpdated:t})}updateColumnAndGroupState(){this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","rowGroup","sort"]),this.updateCachedState("columnGroup",this.getColumnGroupState())}setColumnsInitialisedState(e,t,i,n){this.setColumnState(e,t,i,n),this.setColumnGroupState(e,t,n),this.updateColumnAndGroupState()}setupStateOnColumnsInitialised(e,t){this.setColumnsInitialisedState(e,"gridInitializing",t);let i=n=>()=>this.updateColumnState([n]);this.addManagedEventListeners({columnValueChanged:i("aggregation"),columnMoved:i("columnOrder"),columnPinned:i("columnPinning"),columnResized:i("columnSizing"),columnVisible:i("columnVisibility"),columnPivotChanged:i("pivot"),columnPivotModeChanged:i("pivot"),columnRowGroupChanged:i("rowGroup"),sortChanged:i("sort"),newColumnsLoaded:this.updateColumnAndGroupState.bind(this),columnGroupOpened:()=>this.updateCachedState("columnGroup",this.getColumnGroupState())})}setRowCountState(e,t,i){let{filter:n,rowGroupExpansion:s,ssrmRowGroupExpansion:o,rowSelection:r,pagination:a}=e,l=(c,u)=>!i?.has(c)&&(u||t==="api");l("filter",n)&&this.setFilterState(n),l("rowGroupExpansion",s)&&this.setRowGroupExpansionState(o,s,t),l("rowSelection",r)&&this.setRowSelectionState(r,t),l("pagination",a)&&this.setPaginationState(a,t);let d=this.updateCachedState.bind(this);d("filter",this.getFilterState()),this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(d("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),d("rowGroupExpansion",void 0)):(d("rowGroupExpansion",this.getRowGroupExpansionState()),d("ssrmRowGroupExpansion",void 0)),d("rowSelection",this.getRowSelectionState()),d("pagination",this.getPaginationState())}setupStateOnRowCountReady(e){this.setRowCountState(e,"gridInitializing");let t=this.updateCachedState.bind(this),i=()=>{this.updateRowGroupExpansionStateTimer=0,this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(t("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),t("rowGroupExpansion",void 0)):(t("rowGroupExpansion",this.getRowGroupExpansionState()),t("ssrmRowGroupExpansion",void 0))},n=()=>t("filter",this.getFilterState()),{gos:s,colFilter:o}=this.beans;this.addManagedEventListeners({filterChanged:n,rowExpansionStateChanged:this.onRowGroupOpenedDebounced,expandOrCollapseAll:i,columnRowGroupChanged:i,rowDataUpdated:()=>{(s.get("groupDefaultExpanded")!==0||s.get("isGroupOpenByDefault"))&&(this.updateRowGroupExpansionStateTimer||(this.updateRowGroupExpansionStateTimer=setTimeout(i)))},selectionChanged:()=>{this.staleStateKeys.add("rowSelection"),this.onRowSelectedDebounced()},paginationChanged:r=>{(r.newPage||r.newPageSize)&&t("pagination",this.getPaginationState())}}),o&&this.addManagedListeners(o,{filterStateChanged:n})}setFirstDataRenderedState(e,t,i){let{scroll:n,cellSelection:s,focusedCell:o,columnOrder:r,rowPinning:a}=e,l=(u,h)=>!i?.has(u)&&(h||t==="api");l("focusedCell",o)&&this.setFocusedCellState(o),l("cellSelection",s)&&this.setCellSelectionState(s),l("scroll",n)&&this.setScrollState(n),l("rowPinning",a)&&this.setRowPinningState(a),this.setColumnPivotState(!!r?.orderedColIds,t);let d=this.updateCachedState.bind(this);d("sideBar",this.getSideBarState()),d("focusedCell",this.getFocusedCellState());let c=this.getRangeSelectionState();d("rangeSelection",c),d("cellSelection",c),d("scroll",this.getScrollState())}setupStateOnFirstDataRendered(e){this.setFirstDataRenderedState(e,"gridInitializing");let t=this.updateCachedState.bind(this),i=()=>t("focusedCell",this.getFocusedCellState());this.addManagedEventListeners({cellFocused:i,cellFocusCleared:i,cellSelectionChanged:n=>{if(n.finished){let s=this.getRangeSelectionState();t("rangeSelection",s),t("cellSelection",s)}},bodyScrollEnd:()=>t("scroll",this.getScrollState()),pinnedRowsChanged:()=>t("rowPinning",this.getRowPinningState())})}getColumnState(){let e=this.beans;return kj(zp(e),e.colModel.isPivotMode())}setColumnState(e,t,i,n){let{sort:s,rowGroup:o,aggregation:r,pivot:a,columnPinning:l,columnVisibility:d,columnSizing:c,columnOrder:u}=e,h=!1,p=($,G)=>{let se=!n?.has($)&&!!(G||t==="api");return h||(h=se),se},g={},f=$=>{let G=g[$];return G||(G={colId:$},g[$]=G,G)},m={},C=p("sort",s);C&&s?.sortModel.forEach(({colId:$,sort:G},se)=>{let ve=f($);ve.sort=G,ve.sortIndex=se}),(C||!i)&&(m.sort=null,m.sortIndex=null);let v=p("rowGroup",o);v&&o?.groupColIds.forEach(($,G)=>{let se=f($);se.rowGroup=!0,se.rowGroupIndex=G}),(v||!i)&&(m.rowGroup=null,m.rowGroupIndex=null);let w=p("aggregation",r);w&&r?.aggregationModel.forEach(({colId:$,aggFunc:G})=>{f($).aggFunc=G}),(w||!i)&&(m.aggFunc=null);let y=p("pivot",a);y&&(a?.pivotColIds.forEach(($,G)=>{let se=f($);se.pivot=!0,se.pivotIndex=G}),this.gos.updateGridOptions({options:{pivotMode:!!a?.pivotMode},source:t})),(y||!i)&&(m.pivot=null,m.pivotIndex=null);let S=p("columnPinning",l);if(S){for(let $ of l?.leftColIds??[])f($).pinned="left";for(let $ of l?.rightColIds??[])f($).pinned="right"}(S||!i)&&(m.pinned=null);let x=p("columnVisibility",d);if(x)for(let $ of d?.hiddenColIds??[])f($).hide=!0;(x||!i)&&(m.hide=null);let E=p("columnSizing",c);if(E)for(let{colId:$,flex:G,width:se}of c?.columnSizingModel??[]){let ve=f($);ve.flex=G??null,ve.width=se}(E||!i)&&(m.flex=null);let T=u?.orderedColIds,L=!!T?.length&&!n?.has("columnOrder"),N=L?T.map($=>f($)):Object.values(g);(N.length||h)&&(this.columnStates=N,rn(this.beans,{state:N,applyOrder:L,defaultState:m},t))}setColumnPivotState(e,t){let i=this.columnStates;this.columnStates=void 0;let n=this.columnGroupStates;this.columnGroupStates=void 0;let s=this.beans,{pivotResultCols:o,colGroupSvc:r}=s;if(o?.isPivotResultColsPresent()){if(i){let a=[];for(let l of i)o.getPivotResultCol(l.colId)&&a.push(l);rn(s,{state:a,applyOrder:e},t)}n&&r?.setColumnGroupState(n,t)}}getColumnGroupState(){let e=this.beans.colGroupSvc;if(!e)return;let t=e.getColumnGroupState();return Pj(t)}setColumnGroupState(e,t,i){let n=this.beans.colGroupSvc;if(!n||i?.has("columnGroup")||t!=="api"&&!Object.prototype.hasOwnProperty.call(e,"columnGroup"))return;let s=new Set(e.columnGroup?.openColumnGroupIds),r=n.getColumnGroupState().map(({groupId:a})=>{let l=s.has(a);return l&&s.delete(a),{groupId:a,open:l}});for(let a of s)r.push({groupId:a,open:!0});r.length&&(this.columnGroupStates=r),n.setColumnGroupState(r,t)}getFilterState(){let e=this.beans.filterManager,t=e?.getFilterModel();t&&Object.keys(t).length===0&&(t=void 0);let i=e?.getFilterState(),n=e?.getAdvFilterModel()??void 0;return t||n||i?{filterModel:t,columnFilterState:i,advancedFilterModel:n}:void 0}setFilterState(e){let t=this.beans.filterManager,{filterModel:i,columnFilterState:n,advancedFilterModel:s}=e??{filterModel:null,columnFilterState:null,advancedFilterModel:null};(i!==void 0||n!==void 0)&&t?.setFilterState(i??null,n??null,"columnFilter"),s!==void 0&&t?.setAdvFilterModel(s??null,"advancedFilter")}getRangeSelectionState(){let e=this.beans.rangeSvc?.getCellRanges().map(t=>{let{id:i,type:n,startRow:s,endRow:o,columns:r,startColumn:a}=t;return{id:i,type:n,startRow:s,endRow:o,colIds:r.map(l=>l.getColId()),startColId:a.getColId()}});return e?.length?{cellRanges:e}:void 0}setCellSelectionState(e){let{gos:t,rangeSvc:i,colModel:n,visibleCols:s}=this.beans;if(!Ds(t)||!i)return;let o=[];for(let r of e?.cellRanges??[]){let a=[];for(let d of r.colIds){let c=n.getCol(d);c&&a.push(c)}if(!a.length)continue;let l=n.getCol(r.startColId);if(!l){let d=s.allCols,c=new Set(a);l=d.find(u=>c.has(u))}o.push(O(b({},r),{columns:a,startColumn:l}))}i.setCellRanges(o)}getScrollState(){if(!this.isClientSideRowModel)return;let e=this.beans.ctrlsSvc.getScrollFeature(),{left:t}=e?.getHScrollPosition()??{left:0},{top:i}=e?.getVScrollPosition()??{top:0};return i||t?{top:i,left:t}:void 0}setScrollState(e){if(!this.isClientSideRowModel)return;let{top:t,left:i}=e??{top:0,left:0},{frameworkOverrides:n,rowRenderer:s,animationFrameSvc:o,ctrlsSvc:r}=this.beans;n.wrapIncoming(()=>{r.get("center").setCenterViewportScrollLeft(i),r.getScrollFeature()?.setVerticalScrollPosition(t),s.redraw({afterScroll:!0}),o?.flushAllFrames()})}getSideBarState(){return this.beans.sideBar?.comp?.getState()}getFocusedCellState(){if(!this.isClientSideRowModel)return;let e=this.beans.focusSvc.getFocusedCell();if(e){let{column:t,rowIndex:i,rowPinned:n}=e;return{colId:t.getColId(),rowIndex:i,rowPinned:n}}}setFocusedCellState(e){if(!this.isClientSideRowModel)return;let{focusSvc:t,colModel:i}=this.beans;if(!e){t.clearFocusedCell();return}let{colId:n,rowIndex:s,rowPinned:o}=e;t.setFocusedCell({column:i.getCol(n),rowIndex:s,rowPinned:o,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}getPaginationState(){let{pagination:e,gos:t}=this.beans;if(!e)return;let i=e.getCurrentPage(),n=t.get("paginationAutoPageSize")?void 0:e.getPageSize();if(!(!i&&!n))return{page:i,pageSize:n}}setPaginationState(e,t){let{pagination:i,gos:n}=this.beans;if(!i)return;let{pageSize:s,page:o}=e??{page:0,pageSize:n.get("paginationPageSize")},r=t==="gridInitializing";s&&!n.get("paginationAutoPageSize")&&i.setPageSize(s,r?"initialState":"pageSizeSelector"),typeof o=="number"&&(r?i.setPage(o):i.goToPage(o))}getRowSelectionState(){let e=this.beans.selectionSvc;if(!e)return;let t=e.getSelectionState();return!t||!Array.isArray(t)&&(t.selectAll===!1||t.selectAllChildren===!1)&&!t?.toggledNodes?.length?void 0:t}setRowSelectionState(e,t){this.beans.selectionSvc?.setSelectionState(e,t,t==="api")}getRowGroupExpansionState(){let{expansionSvc:e}=this.beans;if(e)return e.getExpansionState()}getRowPinningState(){return this.beans.pinnedRowModel?.getPinnedState()}setRowPinningState(e){let t=this.beans.pinnedRowModel;e?t?.setPinnedState(e):t?.reset()}setRowGroupExpansionState(e,t,i){let n=this.beans.expansionSvc;if(!n)return;let s=t??{expandedRowGroupIds:[],collapsedRowGroupIds:[]};n.setExpansionState(s,i)}updateColumnState(e){let t=this.getColumnState(),i=!1,n=this.cachedState;for(let s of Object.keys(t)){let o=t[s];Pd(o,n[s])||(i=!0)}this.cachedState=b(b({},n),t),i&&this.dispatchStateUpdateEvent(e)}updateCachedState(e,t){let i=this.cachedState[e];this.setCachedStateValue(e,t),Pd(t,i)||this.dispatchStateUpdateEvent([e])}setCachedStateValue(e,t){this.cachedState=O(b({},this.cachedState),{[e]:t})}refreshStaleState(){let e=this.staleStateKeys;for(let t of e)t==="rowSelection"&&this.setCachedStateValue(t,this.getRowSelectionState());e.clear()}dispatchStateUpdateEvent(e){if(!this.suppressEvents){for(let t of e)this.queuedUpdateSources.add(t);this.dispatchStateUpdateEventDebounced()}}dispatchQueuedStateUpdateEvents(){let e=this.queuedUpdateSources,t=Array.from(e);e.clear(),this.eventSvc.dispatchEvent({type:"stateUpdated",sources:t,state:this.cachedState})}startSuppressEvents(){this.suppressEvents=!0,this.beans.colAnimation?.setSuppressAnimation(!0)}stopSuppressEvents(e){setTimeout(()=>{this.suppressEvents=!1,this.queuedUpdateSources.clear(),this.isAlive()&&(this.beans.colAnimation?.setSuppressAnimation(!1),this.dispatchStateUpdateEvent([e]))})}suppressEventsAndDispatchInitEvent(e){this.startSuppressEvents(),e(),this.stopSuppressEvents("gridInitializing")}},_J={moduleName:"GridState",version:q,beans:[IJ],apiFunctions:{getState:PJ,setState:FJ}};function LJ(e){return e.rowModel.isLastRowIndexKnown()}function OJ(e){return e.pagination?.getPageSize()??100}function NJ(e){return e.pagination?.getCurrentPage()??0}function BJ(e){return e.pagination?.getTotalPages()??1}function HJ(e){return e.pagination?e.pagination.getMasterRowCount():e.rowModel.getRowCount()}function VJ(e){e.pagination?.goToNextPage()}function GJ(e){e.pagination?.goToPreviousPage()}function zJ(e){e.pagination?.goToFirstPage()}function WJ(e){e.pagination?.goToLastPage()}function UJ(e,t){e.pagination?.goToPage(t)}var qJ=class extends F{constructor(){super(...arguments),this.beanName="paginationAutoPageSizeSvc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.centerRowsCtrl=e.center;let t=this.checkPageSize.bind(this);this.addManagedEventListeners({bodyHeightChanged:t,scrollVisibilityChanged:t}),this.addManagedPropertyListener("paginationAutoPageSize",this.onPaginationAutoSizeChanged.bind(this)),this.checkPageSize()})}notActive(){return!this.gos.get("paginationAutoPageSize")||this.centerRowsCtrl==null}onPaginationAutoSizeChanged(){this.notActive()?this.beans.pagination.unsetAutoCalculatedPageSize():this.checkPageSize()}checkPageSize(){if(this.notActive())return;let e=this.centerRowsCtrl.viewportSizeFeature.getBodyHeight();if(e>0){let t=this.beans,i=()=>{let n=Math.max(ir(t),1),s=Math.floor(e/n);t.pagination.setPageSize(s,"autoCalculated")};this.isBodyRendered?qt(this,i,50)():(i(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}},md="paginationPageSizeSelector",$J={tag:"span",cls:"ag-paging-page-size"},jJ=class extends Be{constructor(){super($J),this.hasEmptyOption=!1,this.handlePageSizeItemSelected=()=>{if(!this.selectPageSizeComp)return;let e=this.selectPageSizeComp.getValue();if(!e)return;let t=Number(e);isNaN(t)||t<1||t===this.pagination.getPageSize()||(this.pagination.setPageSize(t,"pageSizeSelector"),this.hasEmptyOption&&this.toggleSelectDisplay(!0),this.selectPageSizeComp.getFocusableElement().focus())}}wireBeans(e){this.pagination=e.pagination}postConstruct(){this.addManagedPropertyListener(md,()=>{this.onPageSizeSelectorValuesChange()}),this.addManagedEventListeners({paginationChanged:e=>this.handlePaginationChanged(e)})}handlePaginationChanged(e){if(!this.selectPageSizeComp||!e?.newPageSize)return;let t=this.pagination.getPageSize();this.getPageSizeSelectorValues().includes(t)?this.selectPageSizeComp.setValue(t.toString()):this.hasEmptyOption?this.selectPageSizeComp.setValue(""):this.toggleSelectDisplay(!0)}toggleSelectDisplay(e){this.selectPageSizeComp&&!e&&this.reset(),e&&(this.reloadPageSizesSelector(),this.selectPageSizeComp)}reset(){$t(this.getGui()),this.selectPageSizeComp&&(this.selectPageSizeComp=this.destroyBean(this.selectPageSizeComp))}onPageSizeSelectorValuesChange(){this.selectPageSizeComp&&this.shouldShowPageSizeSelector()&&this.reloadPageSizesSelector()}shouldShowPageSizeSelector(){return this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel")&&!this.gos.get("paginationAutoPageSize")&&this.gos.get(md)!==!1}reloadPageSizesSelector(){let e=this.getPageSizeSelectorValues(),t=this.pagination.getPageSize(),i=!t||!e.includes(t);if(i){let s=this.gos.exists("paginationPageSize"),o=this.gos.get(md)!==!0;I(94,{pageSizeSet:s,pageSizesSet:o,pageSizeOptions:e,paginationPageSizeOption:t}),o||I(95,{paginationPageSizeOption:t,paginationPageSizeSelector:md}),e.unshift("")}let n=String(i?"":t);this.selectPageSizeComp?(ho(this.pageSizeOptions,e)||(this.selectPageSizeComp.clearOptions().addOptions(this.createPageSizeSelectOptions(e)),this.pageSizeOptions=e),this.selectPageSizeComp.setValue(n,!0)):this.createPageSizeSelectorComp(e,n),this.hasEmptyOption=i}createPageSizeSelectOptions(e){return e.map(t=>({value:String(t)}))}createPageSizeSelectorComp(e,t){let i=this.getLocaleTextFunc(),n=i("pageSizeSelectorLabel","Page Size:"),s=i("ariaPageSizeSelectorLabel","Page Size");this.selectPageSizeComp=this.createManagedBean(new Xv).addOptions(this.createPageSizeSelectOptions(e)).setValue(t).setAriaLabel(s).setLabel(n).onValueChange(()=>this.handlePageSizeItemSelected()),this.appendChild(this.selectPageSizeComp)}getPageSizeSelectorValues(){let e=[20,50,100],t=this.gos.get(md);return!Array.isArray(t)||!t?.length?e:[...t].sort((i,n)=>i-n)}destroy(){this.toggleSelectDisplay(!1),super.destroy()}},KJ={selector:"AG-PAGE-SIZE-SELECTOR",component:jJ},YJ=".ag-paging-panel{align-items:center;border-top:var(--ag-footer-row-border);display:flex;gap:calc(var(--ag-spacing)*4);height:var(--ag-pagination-panel-height);justify-content:flex-end;padding:0 var(--ag-cell-horizontal-padding)}:where(.ag-paging-page-size) .ag-wrapper{min-width:50px}.ag-paging-page-summary-panel{align-items:center;display:flex;gap:var(--ag-cell-widget-spacing);.ag-disabled &{pointer-events:none}}.ag-paging-button{cursor:pointer;position:relative;&.ag-disabled{cursor:default;opacity:.5}}.ag-paging-number,.ag-paging-row-summary-panel-number{font-weight:500}",XJ=class extends SM{constructor(){super(),this.btFirst=U,this.btPrevious=U,this.btNext=U,this.btLast=U,this.lbRecordCount=U,this.lbFirstRowOnPage=U,this.lbLastRowOnPage=U,this.lbCurrent=U,this.lbTotal=U,this.pageSizeComp=U,this.previousAndFirstButtonsDisabled=!1,this.nextButtonDisabled=!1,this.lastButtonDisabled=!1,this.areListenersSetup=!1,this.allowFocusInnerElement=!1,this.registerCSS(YJ)}wireBeans(e){this.rowModel=e.rowModel,this.pagination=e.pagination,this.ariaAnnounce=e.ariaAnnounce}postConstruct(){let e=this.gos.get("enableRtl");this.setTemplate(this.getTemplate(),[KJ]);let{btFirst:t,btPrevious:i,btNext:n,btLast:s}=this;this.activateTabIndex([t,i,n,s]),t.insertAdjacentElement("afterbegin",ji(e?"last":"first",this.beans)),i.insertAdjacentElement("afterbegin",ji(e?"next":"previous",this.beans)),n.insertAdjacentElement("afterbegin",ji(e?"previous":"next",this.beans)),s.insertAdjacentElement("afterbegin",ji(e?"first":"last",this.beans)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.addManagedPropertyListeners(["paginationPageSizeSelector","paginationAutoPageSize","suppressPaginationPanel"],()=>this.onPageSizeRelatedOptionsChange()),this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector()),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:o=>this.allowFocusInnerElement?this.tabGuardFeature.getTabGuardCtrl().focusInnerElement(o):jV(this.beans,o),forceFocusOutWhenTabGuardsAreEmpty:!0}),this.onPaginationChanged()}setAllowFocus(e){this.allowFocusInnerElement=e}onPaginationChanged(){let t=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.setDisplayed(t),t&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateLabels(),this.onPageSizeRelatedOptionsChange())}onPageSizeRelatedOptionsChange(){this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector())}setupListeners(){if(!this.areListenersSetup){this.addManagedEventListeners({paginationChanged:this.onPaginationChanged.bind(this)});for(let e of[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}]){let{el:t,fn:i}=e;this.addManagedListeners(t,{click:i,keydown:n=>{(n.key===k.ENTER||n.key===k.SPACE)&&(n.preventDefault(),i())}})}$V(this.beans,this,this.getGui()),this.areListenersSetup=!0}}onBtFirst(){this.previousAndFirstButtonsDisabled||this.pagination.goToFirstPage()}formatNumber(e){let t=this.gos.getCallback("paginationNumberFormatter");return t?t({value:e}):Fj(e,this.getLocaleTextFunc.bind(this))}getTemplate(){let e=this.getLocaleTextFunc(),t=`ag-${this.getCompId()}`;return{tag:"div",cls:"ag-paging-panel ag-unselectable",attrs:{id:`${t}`},children:[{tag:"ag-page-size-selector",ref:"pageSizeComp"},{tag:"span",cls:"ag-paging-row-summary-panel",children:[{tag:"span",ref:"lbFirstRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-first-row`}},{tag:"span",attrs:{id:`${t}-to`},children:e("to","to")},{tag:"span",ref:"lbLastRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-last-row`}},{tag:"span",attrs:{id:`${t}-of`},children:e("of","of")},{tag:"span",ref:"lbRecordCount",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-row-count`}}]},{tag:"span",cls:"ag-paging-page-summary-panel",role:"presentation",children:[{tag:"div",ref:"btFirst",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("firstPage","First Page")}},{tag:"div",ref:"btPrevious",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("previousPage","Previous Page")}},{tag:"span",cls:"ag-paging-description",children:[{tag:"span",attrs:{id:`${t}-start-page`},children:e("page","Page")},{tag:"span",ref:"lbCurrent",cls:"ag-paging-number",attrs:{id:`${t}-start-page-number`}},{tag:"span",attrs:{id:`${t}-of-page`},children:e("of","of")},{tag:"span",ref:"lbTotal",cls:"ag-paging-number",attrs:{id:`${t}-of-page-number`}}]},{tag:"div",ref:"btNext",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("nextPage","Next Page")}},{tag:"div",ref:"btLast",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("lastPage","Last Page")}}]}]}}onBtNext(){this.nextButtonDisabled||this.pagination.goToNextPage()}onBtPrevious(){this.previousAndFirstButtonsDisabled||this.pagination.goToPreviousPage()}onBtLast(){this.lastButtonDisabled||this.pagination.goToLastPage()}enableOrDisableButtons(){let e=this.pagination.getCurrentPage(),t=this.rowModel.isLastRowIndexKnown(),i=this.pagination.getTotalPages();this.previousAndFirstButtonsDisabled=e===0,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);let n=this.isZeroPagesToDisplay(),s=e===i-1;this.nextButtonDisabled=s||n,this.lastButtonDisabled=!t||n||e===i-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}toggleButtonDisabled(e,t){lO(e,t),e.classList.toggle("ag-disabled",t)}isZeroPagesToDisplay(){let e=this.rowModel.isLastRowIndexKnown(),t=this.pagination.getTotalPages();return e&&t===0}updateLabels(){let e=this.rowModel.isLastRowIndexKnown(),t=this.pagination.getTotalPages(),i=this.pagination.getMasterRowCount(),n=e?i:null,s=this.pagination.getCurrentPage(),o=this.pagination.getPageSize(),r,a;this.isZeroPagesToDisplay()?r=a=0:(r=o*s+1,a=r+o-1,e&&a>n&&(a=n));let l=r+o-1,d=!e&&i<l,c=this.formatNumber(r);this.lbFirstRowOnPage.textContent=c;let u,h=this.getLocaleTextFunc();d?u=h("pageLastRowUnknown","?"):u=this.formatNumber(a),this.lbLastRowOnPage.textContent=u;let g=t>0?s+1:0,f=this.formatNumber(g);this.lbCurrent.textContent=f;let m,C;if(e)m=this.formatNumber(t),C=this.formatNumber(n);else{let v=h("more","more");m=v,C=v}this.lbTotal.textContent=m,this.lbRecordCount.textContent=C,this.announceAriaStatus(c,u,C,f,m)}announceAriaStatus(e,t,i,n,s){let o=this.getLocaleTextFunc(),r=o("page","Page"),a=o("to","to"),l=o("of","of"),d=`${e} ${a} ${t} ${l} ${i}`,c=`${r} ${n} ${l} ${s}`;d!==this.ariaRowStatus&&(this.ariaRowStatus=d,this.ariaAnnounce?.announceValue(d,"paginationRow")),c!==this.ariaPageStatus&&(this.ariaPageStatus=c,this.ariaAnnounce?.announceValue(c,"paginationPage"))}},JJ={selector:"AG-PAGINATION",component:XJ},QJ=class extends F{constructor(){super(...arguments),this.beanName="pagination",this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=0,this.masterRowCount=0}postConstruct(){let e=this.gos;this.active=e.get("pagination"),this.pageSizeFromGridOptions=e.get("paginationPageSize"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedPropertyListener("pagination",this.onPaginationGridOptionChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPageSizeGridOptionChanged.bind(this))}getPaginationSelector(){return JJ}isPaginateChildRows(){let e=this.gos;return e.get("groupHideParentOfSingleChild")||e.get("groupRemoveSingleChildren")||e.get("groupRemoveLowestSingleChildren")?!0:e.get("paginateChildRows")}onPaginationGridOptionChanged(){this.active=this.gos.get("pagination"),this.calculatePages(),this.dispatchPaginationChangedEvent({keepRenderedRows:!0})}onPageSizeGridOptionChanged(){this.setPageSize(this.gos.get("paginationPageSize"),"gridOptions")}goToPage(e){let t=this.currentPage;if(!this.active||t===e||typeof t!="number")return;let{editSvc:i}=this.beans;i?.isEditing()&&(i.isBatchEditing()?i.cleanupEditors():i.stopEditing(void 0,{source:"api"})),this.currentPage=e,this.calculatePages(),this.dispatchPaginationChangedEvent({newPage:!0})}goToPageWithIndex(e){if(!this.active)return;let t=e;this.paginateChildRows||(t=this.beans.rowModel.getTopLevelIndexFromDisplayedIndex?.(e)??e),this.goToPage(Math.floor(t/this.pageSize))}isRowInPage(e){return this.active?e>=this.topDisplayedRowIndex&&e<=this.bottomDisplayedRowIndex:!0}getCurrentPage(){return this.currentPage}goToNextPage(){this.goToPage(this.currentPage+1)}goToPreviousPage(){this.goToPage(this.currentPage-1)}goToFirstPage(){this.goToPage(0)}goToLastPage(){let e=this.beans.rowModel.getRowCount(),t=Math.floor(e/this.pageSize);this.goToPage(t)}getPageSize(){return this.pageSize}getTotalPages(){return this.totalPages}setPage(e){this.currentPage=e}get pageSize(){return K(this.pageSizeAutoCalculated)&&this.gos.get("paginationAutoPageSize")?this.pageSizeAutoCalculated:K(this.pageSizeFromPageSizeSelector)?this.pageSizeFromPageSizeSelector:K(this.pageSizeFromInitialState)?this.pageSizeFromInitialState:K(this.pageSizeFromGridOptions)?this.pageSizeFromGridOptions:this.defaultPageSize}calculatePages(){this.active?this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly():this.calculatedPagesNotActive(),this.beans.pageBounds.calculateBounds(this.topDisplayedRowIndex,this.bottomDisplayedRowIndex)}unsetAutoCalculatedPageSize(){if(this.pageSizeAutoCalculated===void 0)return;let e=this.pageSizeAutoCalculated;this.pageSizeAutoCalculated=void 0,this.pageSize!==e&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0}))}setPageSize(e,t){let i=this.pageSize;switch(t){case"autoCalculated":this.pageSizeAutoCalculated=e;break;case"pageSizeSelector":this.pageSizeFromPageSizeSelector=e,this.currentPage!==0&&this.goToFirstPage();break;case"initialState":this.pageSizeFromInitialState=e;break;case"gridOptions":this.pageSizeFromGridOptions=e,this.pageSizeFromInitialState=void 0,this.pageSizeFromPageSizeSelector=void 0,this.currentPage!==0&&this.goToFirstPage();break}i!==this.pageSize&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0,keepRenderedRows:!0}))}setZeroRows(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}adjustCurrentPageIfInvalid(){let e=this.totalPages;this.currentPage>=e&&(this.currentPage=e-1);let t=this.currentPage;(!isFinite(t)||isNaN(t)||t<0)&&(this.currentPage=0)}calculatePagesMasterRowsOnly(){let e=this.beans.rowModel,t=e.getTopLevelRowCount();if(this.masterRowCount=t,t<=0){this.setZeroRows();return}let i=this.pageSize,n=t-1;this.totalPages=Math.floor(n/i)+1,this.adjustCurrentPageIfInvalid();let s=this.currentPage,o=i*s,r=i*(s+1)-1;if(r>n&&(r=n),this.topDisplayedRowIndex=e.getTopLevelRowDisplayedIndex(o),r===n)this.bottomDisplayedRowIndex=e.getRowCount()-1;else{let a=e.getTopLevelRowDisplayedIndex(r+1);this.bottomDisplayedRowIndex=a-1}}getMasterRowCount(){return this.masterRowCount}calculatePagesAllRows(){let e=this.beans.rowModel.getRowCount();if(this.masterRowCount=e,e===0){this.setZeroRows();return}let{pageSize:t,currentPage:i}=this,n=e-1;this.totalPages=Math.floor(n/t)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=t*i,this.bottomDisplayedRowIndex=t*(i+1)-1,this.bottomDisplayedRowIndex>n&&(this.bottomDisplayedRowIndex=n)}calculatedPagesNotActive(){this.setPageSize(void 0,"autoCalculated"),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.beans.rowModel.getRowCount()-1}dispatchPaginationChangedEvent(e){let{keepRenderedRows:t=!1,newPage:i=!1,newPageSize:n=!1}=e;this.eventSvc.dispatchEvent({type:"paginationChanged",animate:!1,newData:!1,newPage:i,newPageSize:n,keepRenderedRows:t})}},ZJ={moduleName:"Pagination",version:q,beans:[QJ,qJ],icons:{first:"first",previous:"previous",next:"next",last:"last"},apiFunctions:{paginationIsLastPageFound:LJ,paginationGetPageSize:OJ,paginationGetCurrentPage:NJ,paginationGetTotalPages:BJ,paginationGetRowCount:HJ,paginationGoToNextPage:VJ,paginationGoToPreviousPage:GJ,paginationGoToFirstPage:zJ,paginationGoToLastPage:WJ,paginationGoToPage:UJ},dependsOn:[ag]};function eQ(e,t={}){let i=t?t.rowNodes:void 0;e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.redrawRows(i))}function HD(e,t,i,n,s){t&&(n&&t.parent&&t.parent.level!==-1&&HD(e,t.parent,i,n,s),t.setExpanded(i,void 0,s))}function tQ(e,t){return e.rowModel.getRowNode(t)}function iQ(e,t,i,n){e.rowRenderer.addRenderedRowListener(t,i,n)}function nQ(e){return e.rowRenderer.getRenderedNodes()}function sQ(e,t,i){e.rowModel.forEachNode(t,i)}function oQ(e){return e.rowRenderer.firstRenderedRow}function rQ(e){return e.rowRenderer.lastRenderedRow}function aQ(e,t){return e.rowModel.getRow(t)}function lQ(e){return e.rowModel.getRowCount()}var dQ={moduleName:"RowApi",version:q,apiFunctions:{redrawRows:eQ,setRowNodeExpanded:HD,getRowNode:tQ,addRenderedRowListener:iQ,getRenderedNodes:nQ,forEachNode:sQ,getFirstDisplayedRowIndex:oQ,getLastDisplayedRowIndex:rQ,getDisplayedRowAtIndex:aQ,getDisplayedRowCount:lQ}},cQ={moduleName:"ScrollApi",version:q,apiFunctions:{getVerticalPixelRange:SY,getHorizontalPixelRange:xY,ensureColumnVisible:RD,ensureIndexVisible:MD,ensureNodeVisible:EY}};function uQ(e,t,i){if(!t)return;let n=e.ctrlsSvc.getGridBodyCtrl().eGridBody,s=`aria-${t}`;i===null?n.removeAttribute(s):n.setAttribute(s,i)}function hQ(e,t={}){e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.refreshCells(t))}function pQ(e){e.frameworkOverrides.wrapIncoming(()=>{for(let t of e.ctrlsSvc.getHeaderRowContainerCtrls())t.refresh()})}function gQ(e){return e.animationFrameSvc?.isQueueEmpty()??!0}function fQ(e){e.animationFrameSvc?.flushAllFrames()}function mQ(e){return{rowHeight:ir(e),headerHeight:jd(e)}}function CQ(e,t={}){let i=[];for(let o of e.rowRenderer.getCellCtrls(t.rowNodes,t.columns)){let r=o.getCellRenderer();r!=null&&i.push(Nd(r))}if(t.columns?.length)return i;let n=[],s=Mv(t.rowNodes);for(let o of e.rowRenderer.getAllRowCtrls()){if(s&&!Dv(o.rowNode,s)||!o.isFullWidth())continue;let r=o.getFullWidthCellRenderers();for(let a=0;a<r.length;a++){let l=r[a];l!=null&&n.push(Nd(l))}}return[...n,...i]}var vQ={moduleName:"RenderApi",version:q,apiFunctions:{setGridAriaProperty:uQ,refreshCells:hQ,refreshHeader:pQ,isAnimationFrameQueueEmpty:gQ,flushAllAnimationFrames:fQ,getSizesForCurrentTheme:mQ,getCellRendererInstances:CQ}};function wQ(e,t){typeof t=="number"?e.colAutosize?.sizeColumnsToFit(t,"api"):e.colAutosize?.sizeColumnsToFitGridBody(t)}function VD({colAutosize:e,visibleCols:t},i,n){Array.isArray(i)?e?.autoSizeCols({colKeys:i,skipHeader:n,source:"api"}):e?.autoSizeCols(O(b({},i),{colKeys:i.colIds??t.allCols,source:"api"}))}function bQ(e,t){t&&typeof t=="object"?VD(e,t):e.colAutosize?.autoSizeAllColumns({source:"api",skipHeader:t})}var yQ=class extends F{constructor(){super(...arguments),this.beanName="colAutosize",this.timesDelayed=0,this.shouldQueueResizeOperations=!1,this.resizeOperationQueue=[]}postConstruct(){let{gos:e}=this,t=e.get("autoSizeStrategy");if(t){let i=!1,n=t.type;if(n==="fitGridWidth"||n==="fitProvidedWidth")i=!0;else if(n==="fitCellContents"){this.addManagedEventListeners({firstDataRendered:()=>this.onFirstDataRendered(t)});let s=e.get("rowData");i=s!=null&&s.length>0&&wt(e)}i&&this.beans.colDelayRenderSvc?.hideColumns(n)}}autoSizeCols(e){let{eventSvc:t,visibleCols:i}=this.beans;this.innerAutoSizeCols(e).then(n=>{let s=d=>Ha(t,Array.from(d),!0,"autosizeColumns");if(!e.scaleUpToFitGridWidth)return s(n);let o=D6(this.beans),r=d=>i.leftCols.some(c=>Ed(c,d)),a=d=>i.rightCols.some(c=>Ed(c,d)),l=e.colKeys.filter(d=>!Fs(d)&&!Es(d)&&!r(d)&&!a(d));this.sizeColumnsToFit(o,e.source,!0,{defaultMaxWidth:e.defaultMaxWidth,defaultMinWidth:e.defaultMinWidth,columnLimits:e.columnLimits?.map(d=>O(b({},d),{key:d.colId})),colKeys:l,onlyScaleUp:!0}),s(n)})}innerAutoSizeCols(e){return new Promise((t,i)=>{if(this.shouldQueueResizeOperations)return this.pushResizeOperation(()=>this.innerAutoSizeCols(e).then(t,i));let{colKeys:n,skipHeader:s,skipHeaderGroups:o,stopAtGroup:r,defaultMaxWidth:a,defaultMinWidth:l,columnLimits:d=[],source:c="api"}=e,{animationFrameSvc:u,renderStatus:h,colModel:p,autoWidthCalc:g,visibleCols:f}=this.beans;if(u?.flushAllFrames(),this.timesDelayed<5&&h&&(!h.areHeaderCellsRendered()||!h.areCellsRendered())){this.timesDelayed++,setTimeout(()=>{this.isAlive()&&this.innerAutoSizeCols(e).then(t,i)});return}this.timesDelayed=0;let m=new Set,C=-1,v=Object.fromEntries(d.map(E=>{var T=E,{colId:S}=T,x=gi(T,["colId"]);return[S,x]})),w=s??this.gos.get("skipHeaderOnAutoSize"),y=o??w;for(;C!==0;){C=0;let S=[];for(let x of n){if(!x||bN(x))continue;let E=p.getCol(x);if(!E||m.has(E))continue;let T=g.getPreferredWidthForColumn(E,w);if(T>0){let L=v[E.colId]??{};L.minWidth??(L.minWidth=l),L.maxWidth??(L.maxWidth=a);let N=SQ(E,T,L);E.setActualWidth(N,c),m.add(E),C++}S.push(E)}S.length&&f.refresh(c)}y||this.autoSizeColumnGroupsByColumns(n,c,r),t(m)})}autoSizeColumn(e,t,i){this.autoSizeCols({colKeys:[e],skipHeader:i,skipHeaderGroups:!0,source:t})}autoSizeColumnGroupsByColumns(e,t,i){let{colModel:n,ctrlsSvc:s}=this.beans,o=new Set,r=n.getColsForKeys(e);for(let l of r){let d=l.getParent();for(;d&&d!=i;)d.isPadding()||o.add(d),d=d.getParent()}let a;for(let l of o){for(let d of s.getHeaderRowContainerCtrls())if(a=d.getHeaderCtrlForColumn(l),a)break;a?.resizeLeafColumnsToFit(t)}}autoSizeAllColumns(e){if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.autoSizeAllColumns(e));return}this.autoSizeCols(b({colKeys:this.beans.visibleCols.allCols},e))}addColumnAutosizeListeners(e,t){let i=this.gos.get("skipHeaderOnAutoSize"),n=()=>{this.autoSizeColumn(t,"uiColumnResized",i)};e.addEventListener("dblclick",n);let s=new Jo(e);return s.addEventListener("doubleTap",n),()=>{e.removeEventListener("dblclick",n),s.destroy()}}addColumnGroupResize(e,t,i){let n=this.gos.get("skipHeaderOnAutoSize"),s=()=>{let o=[],r=t.getDisplayedLeafColumns();for(let a of r)a.getColDef().suppressAutoSize||o.push(a.getColId());o.length>0&&this.autoSizeCols({colKeys:o,skipHeader:n,stopAtGroup:t,source:"uiColumnResized"}),i()};return e.addEventListener("dblclick",s),()=>e.removeEventListener("dblclick",s)}sizeColumnsToFitGridBody(e,t){if(!this.isAlive())return;let i=D6(this.beans);if(i>0){this.sizeColumnsToFit(i,"sizeColumnsToFit",!1,e);return}t===void 0?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,100)},0):t===100?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,500)},100):t===500?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,-1)},500):I(29)}sizeColumnsToFit(e,t="sizeColumnsToFit",i,n){if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.sizeColumnsToFit(e,t,i,n));return}let s={};for(let g of n?.columnLimits??[]){let f=g,{key:m}=f,C=gi(f,["key"]);s[typeof m=="string"?m:m.getColId()]=C}let o=this.beans.visibleCols.allCols;if(e<=0||!o.length)return;let r=ys(o);if(n?.onlyScaleUp&&r>e||e===r&&o.every(C=>{if(C.colDef.suppressSizeToFit)return!0;let v=s?.[C.getId()],w=v?.minWidth??n?.defaultMinWidth,y=v?.maxWidth??n?.defaultMaxWidth,S=C.getActualWidth();return(w==null||S>=w)&&(y==null||S<=y)}))return;let l=[],d=[];for(let m of o){let C=n?.colKeys?.some(v=>Ed(m,v))??!0;m.getColDef().suppressSizeToFit||!C?d.push(m):l.push(m)}let c=l.slice(0),u=!1,h=m=>{an(l,m),d.push(m)};for(let m of l){m.resetActualWidth(t);let C=s?.[m.getId()],v=C?.minWidth??n?.defaultMinWidth,w=C?.maxWidth??n?.defaultMaxWidth,y=m.getActualWidth();typeof v=="number"&&y<v?m.setActualWidth(v,t,!0):typeof w=="number"&&y>w&&m.setActualWidth(w,t,!0)}for(;!u;){u=!0;let m=e-ys(d);if(m<=0)for(let C of l){let v=s?.[C.getId()]?.minWidth??n?.defaultMinWidth??C.minWidth;C.setActualWidth(v,t,!0)}else{let C=m/ys(l),v=m;for(let w=l.length-1;w>=0;w--){let y=l[w],S=s?.[y.getId()],x=S?.minWidth??n?.defaultMinWidth,E=S?.maxWidth??n?.defaultMaxWidth,T=y.getMinWidth(),L=y.getMaxWidth(),N=typeof x=="number"&&x>T?x:T,$=typeof E=="number"&&E<L?E:L,G=Math.round(y.getActualWidth()*C);G<N?(G=N,h(y),u=!1):G>$?(G=$,h(y),u=!1):w===0&&(G=v),y.setActualWidth(G,t,!0),v-=G}}}for(let m of c)m.fireColumnWidthChangedEvent(t);let p=this.beans.visibleCols;p.setLeftValues(t),p.updateBodyWidths(),!i&&Ha(this.eventSvc,c,!0,t)}applyAutosizeStrategy(){let{gos:e,colDelayRenderSvc:t}=this.beans,i=e.get("autoSizeStrategy");i?.type!=="fitGridWidth"&&i?.type!=="fitProvidedWidth"||setTimeout(()=>{if(!this.isAlive())return;let n=i.type;if(n==="fitGridWidth"){let{columnLimits:s,defaultMinWidth:o,defaultMaxWidth:r}=i,a=s?.map(({colId:l,minWidth:d,maxWidth:c})=>({key:l,minWidth:d,maxWidth:c}));this.sizeColumnsToFitGridBody({defaultMinWidth:o,defaultMaxWidth:r,columnLimits:a})}else n==="fitProvidedWidth"&&this.sizeColumnsToFit(i.width,"sizeColumnsToFit");t?.revealColumns(n)})}onFirstDataRendered(i){var n=i,{colIds:e}=n,t=gi(n,["colIds"]);setTimeout(()=>{if(!this.isAlive())return;let s="autosizeColumns";e?this.autoSizeCols(O(b({},t),{source:s,colKeys:e})):this.autoSizeAllColumns(O(b({},t),{source:s})),this.beans.colDelayRenderSvc?.revealColumns(t.type)})}processResizeOperations(){this.shouldQueueResizeOperations=!1;for(let e of this.resizeOperationQueue)e();this.resizeOperationQueue=[]}pushResizeOperation(e){this.resizeOperationQueue.push(e)}destroy(){this.resizeOperationQueue.length=0,super.destroy()}};function SQ(e,t,i={}){let n=i.minWidth??e.getMinWidth();t<n&&(t=n);let s=i.maxWidth??e.getMaxWidth();return t>s&&(t=s),t}function D6({ctrlsSvc:e,scrollVisibleSvc:t}){let i=e.getGridBodyCtrl(),s=i.isVerticalScrollShowing()?t.getScrollbarWidth():0;return Ad(i.eGridBody)-s}var xQ={moduleName:"ColumnAutoSize",version:q,beans:[yQ],apiFunctions:{sizeColumnsToFit:wQ,autoSizeColumns:VD,autoSizeAllColumns:bQ},dependsOn:[TM]},EQ=".ag-row-pinned-source{background-color:var(--ag-pinned-source-row-background-color);color:var(--ag-pinned-source-row-text-color);font-weight:var(--ag-pinned-source-row-font-weight)}.ag-row-pinned-manual{background-color:var(--ag-pinned-row-background-color);color:var(--ag-pinned-row-text-color);font-weight:var(--ag-pinned-row-font-weight)}";function RQ(e){return e.pinnedRowModel?.getPinnedTopRowCount()??0}function MQ(e){return e.pinnedRowModel?.getPinnedBottomRowCount()??0}function DQ(e,t){return e.pinnedRowModel?.getPinnedTopRow(t)}function kQ(e,t){return e.pinnedRowModel?.getPinnedBottomRow(t)}function PQ(e,t,i){return e.pinnedRowModel?.forEachPinnedRow(t,i)}var FQ={moduleName:"PinnedRow",version:q,beans:[PG],css:[EQ],apiFunctions:{getPinnedTopRowCount:RQ,getPinnedBottomRowCount:MQ,getPinnedTopRow:DQ,getPinnedBottomRow:kQ,forEachPinnedRow:PQ},icons:{rowPin:"pin",rowPinTop:"pinned-top",rowPinBottom:"pinned-bottom",rowUnpin:"un-pin"}},TQ=class{constructor(e,t){this.col=e,this.firstNode=t,this.cellSpan=!0,this.spannedNodes=new Set,this.addSpannedNode(t)}reset(){this.spannedNodes.clear(),this.addSpannedNode(this.firstNode)}addSpannedNode(e){this.spannedNodes.add(e),this.lastNode=e}getLastNode(){return this.lastNode}getCellHeight(){return this.lastNode.rowTop+this.lastNode.rowHeight-this.firstNode.rowTop-1}doesSpanContain(e){return e.column!==this.col||e.rowPinned!=this.firstNode.rowPinned?!1:this.firstNode.rowIndex<=e.rowIndex&&e.rowIndex<=this.lastNode.rowIndex}getLastNodeAutoHeight(){let e=this.firstNode.__autoHeights?.[this.col.getColId()];if(e==null)return;let t=0;for(let i of this.spannedNodes)i!==this.lastNode&&(t+=i.rowHeight);return e-t}},AQ=class extends F{constructor(e){super(),this.column=e}buildCache(e){let{column:t,beans:{gos:i,pinnedRowModel:n,rowModel:s,valueSvc:o,pagination:r}}=this,{colDef:a}=t,l=this.getNodeMap(e),d=new Map,c=i.getCallback("isFullWidthRow"),u=a.equals,h=a.spanRows,p=typeof h=="function",g=null,f=null,m,C=(w,y)=>{g=w,f=null,m=y},v=w=>{let y=!w.isExpandable()&&!w.group&&!w.detail&&(c?!c({rowNode:w}):!0);if(w.rowIndex==null||!y){C(null,null);return}if(g==null||w.level!==g.level||w.footer||f&&w.rowIndex-1!==f?.getLastNode().rowIndex){C(w,o.getValue(t,w));return}let S=o.getValue(t,w);if(p){let x=ae(i,{valueA:m,nodeA:g,valueB:S,nodeB:w,column:t,colDef:a});if(!h(x)){C(w,S);return}}else if(u?!u(m,S):m!==S){C(w,S);return}if(!f){let x=l?.get(g);x?.firstNode===g?(x.reset(),f=x):f=new TQ(t,g),d.set(g,f)}f.addSpannedNode(w),d.set(w,f)};switch(e){case"center":s.forEachDisplayedNode?.(w=>{(!r||r.isRowInPage(w.rowIndex))&&v(w)}),this.centerValueNodeMap=d;break;case"top":n?.forEachPinnedRow("top",v),this.topValueNodeMap=d;break;case"bottom":n?.forEachPinnedRow("bottom",v),this.bottomValueNodeMap=d;break}}isCellSpanning(e){return!!this.getCellSpan(e)}getCellSpan(e){return this.getNodeMap(e.rowPinned).get(e)}getNodeMap(e){switch(e){case"top":return this.topValueNodeMap;case"bottom":return this.bottomValueNodeMap;default:return this.centerValueNodeMap}}},IQ=class extends F{constructor(){super(...arguments),this.beanName="rowSpanSvc",this.spanningColumns=new Map,this.debouncePinnedEvent=qt(this,this.dispatchCellsUpdatedEvent.bind(this,!0),0),this.debounceModelEvent=qt(this,this.dispatchCellsUpdatedEvent.bind(this,!1),0),this.pinnedTimeout=null,this.modelTimeout=null}postConstruct(){let e=this.onRowDataUpdated.bind(this),t=this.buildPinnedCaches.bind(this);this.addManagedEventListeners({paginationChanged:this.buildModelCaches.bind(this),pinnedRowDataChanged:t,pinnedRowsChanged:t,rowNodeDataChanged:e,cellValueChanged:e})}register(e){let{gos:t}=this.beans;if(!t.get("enableCellSpan")||this.spanningColumns.has(e))return;let i=this.createManagedBean(new AQ(e));this.spanningColumns.set(e,i),i.buildCache("top"),i.buildCache("bottom"),i.buildCache("center"),this.debouncePinnedEvent(),this.debounceModelEvent()}dispatchCellsUpdatedEvent(e){this.dispatchLocalEvent({type:"spannedCellsUpdated",pinned:e})}deregister(e){this.spanningColumns.delete(e)}onRowDataUpdated({node:e}){let{spannedRowRenderer:t}=this.beans;if(e.rowPinned){if(this.pinnedTimeout!=null)return;this.pinnedTimeout=window.setTimeout(()=>{this.pinnedTimeout=null,this.buildPinnedCaches(),t?.createCtrls("top"),t?.createCtrls("bottom")},0);return}this.modelTimeout==null&&(this.modelTimeout=window.setTimeout(()=>{this.modelTimeout=null,this.buildModelCaches(),t?.createCtrls("center")},0))}buildModelCaches(){this.modelTimeout!=null&&clearTimeout(this.modelTimeout),this.spanningColumns.forEach(e=>e.buildCache("center")),this.debounceModelEvent()}buildPinnedCaches(){this.pinnedTimeout!=null&&clearTimeout(this.pinnedTimeout),this.spanningColumns.forEach(e=>{e.buildCache("top"),e.buildCache("bottom")}),this.debouncePinnedEvent()}isCellSpanning(e,t){let i=this.spanningColumns.get(e);return i?i.isCellSpanning(t):!1}getCellSpanByPosition(e){let{pinnedRowModel:t,rowModel:i}=this.beans,n=e.column,s=e.rowIndex,o=this.spanningColumns.get(n);if(!o)return;let r;switch(e.rowPinned){case"top":r=t?.getPinnedTopRow(s);break;case"bottom":r=t?.getPinnedBottomRow(s);break;default:r=i.getRow(s)}if(r)return o.getCellSpan(r)}getCellStart(e){let t=this.getCellSpanByPosition(e);return t?O(b({},e),{rowIndex:t.firstNode.rowIndex}):e}getCellEnd(e){let t=this.getCellSpanByPosition(e);return t?O(b({},e),{rowIndex:t.getLastNode().rowIndex}):e}getCellSpan(e,t){let i=this.spanningColumns.get(e);if(i)return i.getCellSpan(t)}forEachSpannedColumn(e,t){for(let[i,n]of this.spanningColumns)if(n.isCellSpanning(e)){let s=n.getCellSpan(e);t(i,s)}}destroy(){super.destroy(),this.spanningColumns.clear()}},_Q=class extends Oa{constructor(e,t,i){super(e.col,e.firstNode,i,t),this.cellSpan=e,this.SPANNED_CELL_CSS_CLASS="ag-spanned-cell"}setComp(e,t,i,n,s,o,r){this.eWrapper=i,super.setComp(e,t,i,n,s,o,r),this.setAriaRowSpan(),this.refreshAriaRowIndex()}isCellSpanning(){return!0}getCellSpan(){return this.cellSpan}refreshAriaRowIndex(){let{eGui:e,rowNode:t}=this;!e||t.rowIndex==null||Fp(e,t.rowIndex)}setAriaRowSpan(){pO(this.eGui,this.cellSpan.spannedNodes.size)}setFocusedCellPosition(e){this.focusedCellPosition=e}getFocusedCellPosition(){return this.focusedCellPosition??this.cellPosition}checkCellFocused(){let e=this.beans.focusSvc.getFocusedCell();return!!e&&this.cellSpan.doesSpanContain(e)}applyStaticCssClasses(){super.applyStaticCssClasses(),this.comp.toggleCss(this.SPANNED_CELL_CSS_CLASS,!0)}onCellFocused(e){let{beans:t}=this;if(sg(t)){this.focusedCellPosition=void 0;return}let i=this.isCellFocused();i||(this.focusedCellPosition=void 0),e&&i&&(this.focusedCellPosition={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column}),super.onCellFocused(e)}getRootElement(){return this.eWrapper}},LQ=class extends Xp{onRowIndexChanged(){super.onRowIndexChanged();for(let e of this.getAllCellCtrls())e.refreshAriaRowIndex()}getInitialRowClasses(e){return["ag-spanned-row"]}getNewCellCtrl(e){let t=this.beans.rowSpanSvc?.getCellSpan(e,this.rowNode);if(!(!t||t.firstNode!==this.rowNode))return new _Q(t,this,this.beans)}isCorrectCtrlForSpan(e){let t=this.beans.rowSpanSvc?.getCellSpan(e.column,this.rowNode);return!t||t.firstNode!==this.rowNode?!1:e.getCellSpan()===t}onRowHeightChanged(){}refreshFirstAndLastRowStyles(){}addHoverFunctionality(){}resetHoveredStatus(){}},OQ=class extends F{constructor(){super(...arguments),this.beanName="spannedRowRenderer",this.topCtrls=new Map,this.bottomCtrls=new Map,this.centerCtrls=new Map}postConstruct(){this.addManagedEventListeners({displayedRowsChanged:this.createAllCtrls.bind(this)})}createAllCtrls(){this.createCtrls("top"),this.createCtrls("bottom"),this.createCtrls("center")}createCtrls(e){let{rowSpanSvc:t}=this.beans,i=this.getCtrlsMap(e),n=i.size,s=this.getAllRelevantRowControls(e),o=new Map,r=!1;for(let l of s)l.isAlive()&&t?.forEachSpannedColumn(l.rowNode,(d,c)=>{if(o.has(c.firstNode))return;let u=i.get(c.firstNode);if(u){o.set(c.firstNode,u),i.delete(c.firstNode);return}r=!0;let h=new LQ(c.firstNode,this.beans,!1,!1,!1);o.set(c.firstNode,h)});this.setCtrlsMap(e,o);let a=o.size===n;if(!(!r&&a)){for(let l of i.values())l.destroyFirstPass(!0),l.destroySecondPass();this.dispatchLocalEvent({type:"spannedRowsUpdated",ctrlsKey:e})}}getAllRelevantRowControls(e){let{rowRenderer:t}=this.beans;switch(e){case"top":return t.topRowCtrls;case"bottom":return t.bottomRowCtrls;case"center":return t.allRowCtrls}}getCellByPosition(e){let{rowSpanSvc:t}=this.beans,i=t?.getCellSpanByPosition(e);if(!i)return;let n=this.getCtrlsMap(e.rowPinned).get(i.firstNode);if(n)return n.getAllCellCtrls().find(s=>s.column===e.column)}getCtrls(e){return[...this.getCtrlsMap(e).values()]}destroyRowCtrls(e){for(let t of this.getCtrlsMap(e).values())t.destroyFirstPass(!0),t.destroySecondPass();this.setCtrlsMap(e,new Map)}getCtrlsMap(e){switch(e){case"top":return this.topCtrls;case"bottom":return this.bottomCtrls;default:return this.centerCtrls}}setCtrlsMap(e,t){switch(e){case"top":this.topCtrls=t;break;case"bottom":this.bottomCtrls=t;break;default:this.centerCtrls=t;break}}destroy(){super.destroy(),this.destroyRowCtrls("top"),this.destroyRowCtrls("bottom"),this.destroyRowCtrls("center")}},NQ={moduleName:"CellSpan",version:q,beans:[IQ,OQ]},BQ=class extends F{constructor(e,t){super(),this.cellCtrl=e,this.staticClasses=[],this.beans=t,this.column=e.column}setComp(e){this.cellComp=e,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}applyCellClassRules(){let{column:e,cellComp:t}=this,i=e.colDef,n=i.cellClassRules,s=this.getCellClassParams(e,i);Cw(this.beans.expressionSvc,n===this.cellClassRules?void 0:this.cellClassRules,n,s,o=>t.toggleCss(o,!0),o=>t.toggleCss(o,!1)),this.cellClassRules=n}applyUserStyles(){let e=this.column,t=e.colDef,i=t.cellStyle;if(!i)return;let n;if(typeof i=="function"){let s=this.getCellClassParams(e,t);n=i(s)}else n=i;n&&this.cellComp.setUserStyles(n)}applyClassesFromColDef(){let{column:e,cellComp:t}=this,i=e.colDef,n=this.getCellClassParams(e,i);for(let o of this.staticClasses)t.toggleCss(o,!1);let s=this.beans.cellStyles.getStaticCellClasses(i,n);this.staticClasses=s;for(let o of s)t.toggleCss(o,!0)}getCellClassParams(e,t){let{value:i,rowNode:n}=this.cellCtrl;return ae(this.beans.gos,{value:i,data:n.data,node:n,colDef:t,column:e,rowIndex:n.rowIndex})}},HQ=class extends F{constructor(){super(...arguments),this.beanName="cellStyles"}processAllCellClasses(e,t,i,n){Cw(this.beans.expressionSvc,void 0,e.cellClassRules,t,i,n),this.processStaticCellClasses(e,t,i)}getStaticCellClasses(e,t){let{cellClass:i}=e;if(!i)return[];let n;return typeof i=="function"?n=i(t):n=i,typeof n=="string"&&(n=[n]),n||[]}createCellCustomStyleFeature(e,t){return new BQ(e,t)}processStaticCellClasses(e,t,i){this.getStaticCellClasses(e,t).forEach(s=>{i(s)})}},VQ={moduleName:"CellStyle",version:q,beans:[HQ]},GQ={moduleName:"RowStyle",version:q,beans:[D$]};function zQ(e,t){return!!e.colHover?.isHovered(t)}var WQ=class extends F{constructor(e,t){super(),this.columns=e,this.element=t,this.destroyManagedListeners=[],this.enableFeature=i=>{let{beans:n,gos:s,element:o,columns:r}=this,a=n.colHover;if(i??!!s.get("columnHoverHighlight"))this.destroyManagedListeners=this.addManagedElementListeners(o,{mouseover:a.setMouseOver.bind(a,r),mouseout:a.clearMouseOver.bind(a)});else{for(let d of this.destroyManagedListeners)d();this.destroyManagedListeners=[]}}}postConstruct(){this.addManagedPropertyListener("columnHoverHighlight",({currentValue:e})=>{this.enableFeature(e)}),this.enableFeature()}destroy(){super.destroy(),this.destroyManagedListeners=null}},UQ="ag-column-hover",qQ=class extends F{constructor(){super(...arguments),this.beanName="colHover"}postConstruct(){this.addManagedPropertyListener("columnHoverHighlight",({currentValue:e})=>{e||this.clearMouseOver()})}setMouseOver(e){this.updateState(e)}clearMouseOver(){this.updateState(null)}isHovered(e){if(!this.gos.get("columnHoverHighlight"))return!1;let t=this.selectedColumns;return!!t&&t.indexOf(e)>=0}addHeaderColumnHoverListener(e,t,i){let n=()=>{let s=this.isHovered(i);t.toggleCss("ag-column-hover",s)};e.addManagedEventListeners({columnHoverChanged:n}),n()}onCellColumnHover(e,t){if(!t)return;let i=this.isHovered(e);t.toggleCss(UQ,i)}addHeaderFilterColumnHoverListener(e,t,i,n){this.createHoverFeature(e,[i],n);let s=()=>{let o=this.isHovered(i);t.toggleCss("ag-column-hover",o)};e.addManagedEventListeners({columnHoverChanged:s}),s()}createHoverFeature(e,t,i){e.createManagedBean(new WQ(t,i))}updateState(e){this.selectedColumns=e,this.eventSvc.dispatchEvent({type:"columnHoverChanged"})}},$Q={moduleName:"ColumnHover",version:q,beans:[qQ],apiFunctions:{isColumnHovered:zQ}},jQ=class extends F{constructor(){super(...arguments),this.beanName="apiEventSvc",this.syncListeners=new Map,this.asyncListeners=new Map,this.syncGlobalListeners=new Set,this.globalListenerPairs=new Map}postConstruct(){this.wrapSvc=this.beans.frameworkOverrides.createGlobalEventListenerWrapper?.()}addListener(e,t){let i=this.wrapSvc?.wrap(e,t)??t,n=!kp.has(e),s=n?this.asyncListeners:this.syncListeners;s.has(e)||s.set(e,new Set),s.get(e).add(i),this.eventSvc.addListener(e,i,n)}removeListener(e,t){let i=this.wrapSvc?.unwrap(e,t)??t,s=!!this.asyncListeners.get(e)?.delete(i);s||this.syncListeners.get(e)?.delete(i),this.eventSvc.removeListener(e,i,s)}addGlobalListener(e){let t=this.wrapSvc?.wrapGlobal(e)??e,i=(o,r)=>{kp.has(o)&&t(o,r)},n=(o,r)=>{kp.has(o)||t(o,r)};this.globalListenerPairs.set(e,{syncListener:i,asyncListener:n});let s=this.eventSvc;s.addGlobalListener(i,!1),s.addGlobalListener(n,!0)}removeGlobalListener(e){let{eventSvc:t,wrapSvc:i,globalListenerPairs:n}=this,s=i?.unwrapGlobal(e)??e;if(n.has(s)){let{syncListener:r,asyncListener:a}=n.get(s);t.removeGlobalListener(r,!1),t.removeGlobalListener(a,!0),n.delete(e)}else this.syncGlobalListeners.delete(s),t.removeGlobalListener(s,!1)}destroyEventListeners(e,t){e.forEach((i,n)=>{i.forEach(s=>this.eventSvc.removeListener(n,s,t)),i.clear()}),e.clear()}destroyGlobalListeners(e,t){for(let i of e)this.eventSvc.removeGlobalListener(i,t);e.clear()}destroy(){super.destroy(),this.destroyEventListeners(this.syncListeners,!1),this.destroyEventListeners(this.asyncListeners,!0),this.destroyGlobalListeners(this.syncGlobalListeners,!1);let{globalListenerPairs:e,eventSvc:t}=this;e.forEach(({syncListener:i,asyncListener:n})=>{t.removeGlobalListener(i,!1),t.removeGlobalListener(n,!0)}),e.clear()}};function KQ(e,t,i){e.apiEventSvc?.addListener(t,i)}function YQ(e,t,i){e.apiEventSvc?.removeListener(t,i)}function XQ(e,t){e.apiEventSvc?.addGlobalListener(t)}function JQ(e,t){e.apiEventSvc?.removeGlobalListener(t)}var QQ={moduleName:"EventApi",version:q,apiFunctions:{addEventListener:KQ,addGlobalListener:XQ,removeEventListener:YQ,removeGlobalListener:JQ},beans:[jQ]},ZQ={moduleName:"Locale",version:q,beans:[Dj]},eZ=class extends F{constructor(){super(...arguments),this.beanName="rowAutoHeight",this.wasEverActive=!1,this._debouncedCalculateRowHeights=qt(this,this.calculateRowHeights.bind(this),1)}requestCheckAutoHeight(){this.wasEverActive&&this._debouncedCalculateRowHeights()}calculateRowHeights(){let{visibleCols:e,rowModel:t,rowSpanSvc:i,pinnedRowModel:n}=this.beans,s=e.autoHeightCols,o=!1,r=a=>{let l=a.__autoHeights,d=ao(this.beans,a).height;for(let c of s){let u=l?.[c.getColId()],h=i?.getCellSpan(c,a);if(h){if(h.getLastNode()!==a)continue;if(u=i?.getCellSpan(c,a)?.getLastNodeAutoHeight(),!u)return}if(u==null){if(this.colSpanSkipCell(c,a))continue;return}d=Math.max(u,d)}d!==a.rowHeight&&(a.setRowHeight(d),o=!0)};n?.forEachPinnedRow?.("top",r),n?.forEachPinnedRow?.("bottom",r),t.forEachDisplayedNode?.(r),o&&t.onRowHeightChanged?.()}setRowAutoHeight(e,t,i){if(e.__autoHeights??(e.__autoHeights={}),t==null){delete e.__autoHeights[i.getId()];return}let n=e.__autoHeights[i.getId()];e.__autoHeights[i.getId()]=t,n!==t&&this.requestCheckAutoHeight()}colSpanSkipCell(e,t){let{colModel:i,colViewport:n,visibleCols:s}=this.beans;if(!i.colSpanActive)return!1;let o=[];switch(e.getPinned()){case"left":o=s.getLeftColsForRow(t);break;case"right":o=s.getRightColsForRow(t);break;case null:o=n.getColsWithinViewport(t);break}return!o.includes(e)}setupCellAutoHeight(e,t,i){if(!e.column.isAutoHeight()||!t)return!1;this.wasEverActive=!0;let n=t.parentElement,{rowNode:s,column:o}=e,r=this.beans,a=c=>{if(this.beans.editSvc?.isEditing(e)||!e.isAlive()||!i.isAlive())return;let{paddingTop:u,paddingBottom:h,borderBottomWidth:p,borderTopWidth:g}=ur(n),f=u+h+p+g,C=t.offsetHeight+f;if(c<5){let w=!Ht(r)?.contains(t),y=C==0;if(w||y){window.setTimeout(()=>a(c+1),0);return}}this.setRowAutoHeight(s,C,o)},l=()=>a(0);l();let d=uo(r,t,l);return i.addDestroyFunc(()=>{d(),this.setRowAutoHeight(s,void 0,o)}),!0}setAutoHeightActive(e){this.active=e.list.some(t=>t.isVisible()&&t.isAutoHeight())}areRowsMeasured(){if(!this.active)return!0;let e=this.beans.rowRenderer.getAllRowCtrls(),t=null;for(let{rowNode:i}of e)if((!t||this.beans.colModel.colSpanActive)&&(t=this.beans.colViewport.getColsWithinViewport(i).filter(s=>s.isAutoHeight())),t.length!==0){if(!i.__autoHeights)return!1;for(let n of t){let s=i.__autoHeights[n.getColId()];if(!s||i.rowHeight<s)return!1}}return!0}},tZ={moduleName:"RowAutoHeight",version:q,beans:[eZ]},GD={moduleName:"AllCommunity",version:q,dependsOn:[eJ,lJ,vJ,qj,tX,iX,nX,sX,oX,rX,aX,eX,jK,KK,YK,$K,JK,QK,_J,AX,ZJ,AM,dQ,cQ,vQ,xQ,zz,FQ,SX,dj,VQ,$Q,GQ,QQ,hj,kJ,ED,ZQ,tZ,Gz,tJ,NQ]};var iZ=(()=>{let t=class t{constructor(){this.vcr=z(Cr)}};t.\u0275fac=function(s){return new(s||t)},t.\u0275cmp=be({type:t,selectors:[["ag-component-container"]],standalone:!1,decls:0,vars:0,template:function(s,o){},encapsulation:2});let e=t;return e})(),UD=16,Rw=0;function nZ(e){let t=new Map;for(let i=0;i<UD;i++){let n=e.createComponent(iZ);t.set(i,n),yi(n.location.nativeElement)}return t}var sZ=new Set(["doesFilterPass","isFilterActive"]),zD=(()=>{let t=class t extends lD{setViewContainerRef(n,s){this.viewContainerRef=n,this.angularFrameworkOverrides=s}createWrapper(n){let s=this.angularFrameworkOverrides,o=this;o.compShards??=nZ(this.viewContainerRef);class r extends Mw{init(d){s.runInsideAngular(()=>{super.init(d),this._componentRef.changeDetectorRef.detectChanges()})}createComponent(){return o.createComponent(n)}hasMethod(d){return a.getFrameworkComponentInstance()[d]!=null}callMethod(d,c){let u=this.getFrameworkComponentInstance(),h=u[d];return sZ.has(d)?h.apply(u,c):s.runInsideAngular(()=>h.apply(u,c))}addMethod(d,c){a[d]=c}}let a=new r;return a}createComponent(n){return Rw=(Rw+1)%UD,this.compShards.get(Rw).instance.vcr.createComponent(n)}};t.\u0275fac=(()=>{let n;return function(o){return(n||(n=Ts(t)))(o||t)}})(),t.\u0275prov=ja({token:t,factory:t.\u0275fac});let e=t;return e})(),Mw=class{init(t){this._params=t,this._componentRef=this.createComponent(),this._agAwareComponent=this._componentRef.instance,this._frameworkComponentInstance=this._componentRef.instance,this._eGui=this._componentRef.location.nativeElement,yi(this._eGui),this._agAwareComponent.agInit(this._params)}getGui(){return this._eGui}getRootElement(){return this._eGui.firstChild}destroy(){this._frameworkComponentInstance&&typeof this._frameworkComponentInstance.destroy=="function"&&this._frameworkComponentInstance.destroy(),this._componentRef?.destroy()}getFrameworkComponentInstance(){return this._frameworkComponentInstance}},cg=class{constructor(t){this.frameworkOverrides=t,this.wrappedListeners=new Map,this.wrappedGlobalListeners=new Map}wrap(t,i){let{frameworkOverrides:n,wrappedListeners:s}=this,o=i;if(n.shouldWrapOutgoing){o=a=>{n.wrapOutgoing(()=>i(a))};let r=s.get(t);r||(r=new Map,s.set(t,r)),r.set(i,o)}return o}wrapGlobal(t){let{frameworkOverrides:i,wrappedGlobalListeners:n}=this,s=t;return i.shouldWrapOutgoing&&(s=(o,r)=>{i.wrapOutgoing(()=>t(o,r))},n.set(t,s)),s}unwrap(t,i){let{wrappedListeners:n}=this,s=n.get(t);if(s){let o=s.get(i);if(o)return s.delete(i),s.size===0&&n.delete(t),o}return i}unwrapGlobal(t){let{wrappedGlobalListeners:i}=this,n=i.get(t);return n?(i.delete(t),n):t}},WD=(()=>{let t=class t extends cw{constructor(n){super("angular"),this._ngZone=n,this.batchFrameworkComps=!0,this.isRunningWithinTestZone=!1,this.wrapIncoming=(s,o)=>this.runOutside(s,o),this.wrapOutgoing=s=>this.runInsideAngular(s),this.isRunningWithinTestZone=window?.AG_GRID_UNDER_TEST??!!window?.Zone?.AsyncTestZoneSpec,this._ngZone?this.isRunningWithinTestZone?this.runOutside=(s,o)=>o==="resize-observer"||o==="popupPositioning"?this._ngZone.runOutsideAngular(s):s():this.runOutside=s=>this._ngZone.runOutsideAngular(s):this.runOutside=s=>s()}get shouldWrapOutgoing(){return this._ngZone&&wo.isInAngularZone()}createLocalEventListenerWrapper(n,s){if(this.shouldWrapOutgoing)return n??(s.setFrameworkOverrides(this),new cg(this))}createGlobalEventListenerWrapper(){return new cg(this)}isFrameworkComponent(n){if(!n)return!1;let s=n.prototype;return s&&"agInit"in s}runInsideAngular(n){return!this._ngZone||wo.isInAngularZone()?n():this._ngZone.run(n)}runOutsideAngular(n,s){return this.runOutside(n,s)}};t.\u0275fac=function(s){return new(s||t)(Lw(wo))},t.\u0275prov=ja({token:t,factory:t.\u0275fac});let e=t;return e})(),ug=(()=>{let t=class t{constructor(n,s,o,r){this._viewContainerRef=s,this._angularFrameworkOverrides=o,this._frameworkCompWrapper=r,this._initialised=!1,this._destroyed=!1,this._holdEvents=!0,this._fullyReady=new Promise(a=>{this._resolveFullyReady=a}),this.statusBar=void 0,this.sideBar=void 0,this.suppressContextMenu=void 0,this.preventDefaultOnContextMenu=void 0,this.allowContextMenuWithControlKey=void 0,this.columnMenu=void 0,this.suppressMenuHide=void 0,this.enableBrowserTooltips=void 0,this.tooltipTrigger=void 0,this.tooltipShowDelay=void 0,this.tooltipHideDelay=void 0,this.tooltipMouseTrack=void 0,this.tooltipShowMode=void 0,this.tooltipInteraction=void 0,this.popupParent=void 0,this.copyHeadersToClipboard=void 0,this.copyGroupHeadersToClipboard=void 0,this.clipboardDelimiter=void 0,this.suppressCopyRowsToClipboard=void 0,this.suppressCopySingleCellRanges=void 0,this.suppressLastEmptyLineOnPaste=void 0,this.suppressClipboardPaste=void 0,this.suppressClipboardApi=void 0,this.suppressCutToClipboard=void 0,this.columnDefs=void 0,this.defaultColDef=void 0,this.defaultColGroupDef=void 0,this.columnTypes=void 0,this.dataTypeDefinitions=void 0,this.maintainColumnOrder=void 0,this.enableStrictPivotColumnOrder=void 0,this.suppressFieldDotNotation=void 0,this.headerHeight=void 0,this.groupHeaderHeight=void 0,this.floatingFiltersHeight=void 0,this.pivotHeaderHeight=void 0,this.pivotGroupHeaderHeight=void 0,this.hidePaddedHeaderRows=void 0,this.allowDragFromColumnsToolPanel=void 0,this.suppressMovableColumns=void 0,this.suppressColumnMoveAnimation=void 0,this.suppressMoveWhenColumnDragging=void 0,this.suppressDragLeaveHidesColumns=void 0,this.suppressGroupChangesColumnVisibility=void 0,this.suppressMakeColumnVisibleAfterUnGroup=void 0,this.suppressRowGroupHidesColumns=void 0,this.colResizeDefault=void 0,this.suppressAutoSize=void 0,this.autoSizePadding=void 0,this.skipHeaderOnAutoSize=void 0,this.autoSizeStrategy=void 0,this.components=void 0,this.editType=void 0,this.suppressStartEditOnTab=void 0,this.getFullRowEditValidationErrors=void 0,this.invalidEditValueMode=void 0,this.singleClickEdit=void 0,this.suppressClickEdit=void 0,this.readOnlyEdit=void 0,this.stopEditingWhenCellsLoseFocus=void 0,this.enterNavigatesVertically=void 0,this.enterNavigatesVerticallyAfterEdit=void 0,this.enableCellEditingOnBackspace=void 0,this.undoRedoCellEditing=void 0,this.undoRedoCellEditingLimit=void 0,this.defaultCsvExportParams=void 0,this.suppressCsvExport=void 0,this.defaultExcelExportParams=void 0,this.suppressExcelExport=void 0,this.excelStyles=void 0,this.findSearchValue=void 0,this.findOptions=void 0,this.quickFilterText=void 0,this.cacheQuickFilter=void 0,this.includeHiddenColumnsInQuickFilter=void 0,this.quickFilterParser=void 0,this.quickFilterMatcher=void 0,this.applyQuickFilterBeforePivotOrAgg=void 0,this.excludeChildrenWhenTreeDataFiltering=void 0,this.enableAdvancedFilter=void 0,this.alwaysPassFilter=void 0,this.includeHiddenColumnsInAdvancedFilter=void 0,this.advancedFilterParent=void 0,this.advancedFilterBuilderParams=void 0,this.advancedFilterParams=void 0,this.suppressAdvancedFilterEval=void 0,this.suppressSetFilterByDefault=void 0,this.enableFilterHandlers=void 0,this.filterHandlers=void 0,this.enableCharts=void 0,this.chartThemes=void 0,this.customChartThemes=void 0,this.chartThemeOverrides=void 0,this.chartToolPanelsDef=void 0,this.chartMenuItems=void 0,this.loadingCellRenderer=void 0,this.loadingCellRendererParams=void 0,this.loadingCellRendererSelector=void 0,this.localeText=void 0,this.masterDetail=void 0,this.keepDetailRows=void 0,this.keepDetailRowsCount=void 0,this.detailCellRenderer=void 0,this.detailCellRendererParams=void 0,this.detailRowHeight=void 0,this.detailRowAutoHeight=void 0,this.context=void 0,this.alignedGrids=void 0,this.tabIndex=void 0,this.rowBuffer=void 0,this.valueCache=void 0,this.valueCacheNeverExpires=void 0,this.enableCellExpressions=void 0,this.suppressTouch=void 0,this.suppressFocusAfterRefresh=void 0,this.suppressBrowserResizeObserver=void 0,this.suppressPropertyNamesCheck=void 0,this.suppressChangeDetection=void 0,this.debug=void 0,this.loading=void 0,this.overlayLoadingTemplate=void 0,this.loadingOverlayComponent=void 0,this.loadingOverlayComponentParams=void 0,this.suppressLoadingOverlay=void 0,this.overlayNoRowsTemplate=void 0,this.noRowsOverlayComponent=void 0,this.noRowsOverlayComponentParams=void 0,this.suppressNoRowsOverlay=void 0,this.pagination=void 0,this.paginationPageSize=void 0,this.paginationPageSizeSelector=void 0,this.paginationAutoPageSize=void 0,this.paginateChildRows=void 0,this.suppressPaginationPanel=void 0,this.pivotMode=void 0,this.pivotPanelShow=void 0,this.pivotMaxGeneratedColumns=void 0,this.pivotDefaultExpanded=void 0,this.pivotColumnGroupTotals=void 0,this.pivotRowTotals=void 0,this.pivotSuppressAutoColumn=void 0,this.suppressExpandablePivotGroups=void 0,this.functionsReadOnly=void 0,this.aggFuncs=void 0,this.suppressAggFuncInHeader=void 0,this.alwaysAggregateAtRootLevel=void 0,this.aggregateOnlyChangedColumns=void 0,this.suppressAggFilteredOnly=void 0,this.removePivotHeaderRowWhenSingleValueColumn=void 0,this.animateRows=void 0,this.cellFlashDuration=void 0,this.cellFadeDuration=void 0,this.allowShowChangeAfterFilter=void 0,this.domLayout=void 0,this.ensureDomOrder=void 0,this.enableCellSpan=void 0,this.enableRtl=void 0,this.suppressColumnVirtualisation=void 0,this.suppressMaxRenderedRowRestriction=void 0,this.suppressRowVirtualisation=void 0,this.rowDragManaged=void 0,this.rowDragInsertDelay=void 0,this.suppressRowDrag=void 0,this.suppressMoveWhenRowDragging=void 0,this.rowDragEntireRow=void 0,this.rowDragMultiRow=void 0,this.rowDragText=void 0,this.dragAndDropImageComponent=void 0,this.dragAndDropImageComponentParams=void 0,this.fullWidthCellRenderer=void 0,this.fullWidthCellRendererParams=void 0,this.embedFullWidthRows=void 0,this.groupDisplayType=void 0,this.groupDefaultExpanded=void 0,this.autoGroupColumnDef=void 0,this.groupMaintainOrder=void 0,this.groupSelectsChildren=void 0,this.groupLockGroupColumns=void 0,this.groupAggFiltering=void 0,this.groupTotalRow=void 0,this.grandTotalRow=void 0,this.suppressStickyTotalRow=void 0,this.groupSuppressBlankHeader=void 0,this.groupSelectsFiltered=void 0,this.showOpenedGroup=void 0,this.groupHideParentOfSingleChild=void 0,this.groupRemoveSingleChildren=void 0,this.groupRemoveLowestSingleChildren=void 0,this.groupHideOpenParents=void 0,this.groupAllowUnbalanced=void 0,this.rowGroupPanelShow=void 0,this.groupRowRenderer=void 0,this.groupRowRendererParams=void 0,this.treeData=void 0,this.treeDataChildrenField=void 0,this.treeDataParentIdField=void 0,this.rowGroupPanelSuppressSort=void 0,this.suppressGroupRowsSticky=void 0,this.groupHierarchyConfig=void 0,this.pinnedTopRowData=void 0,this.pinnedBottomRowData=void 0,this.enableRowPinning=void 0,this.isRowPinnable=void 0,this.isRowPinned=void 0,this.rowModelType=void 0,this.rowData=void 0,this.asyncTransactionWaitMillis=void 0,this.suppressModelUpdateAfterUpdateTransaction=void 0,this.datasource=void 0,this.cacheOverflowSize=void 0,this.infiniteInitialRowCount=void 0,this.serverSideInitialRowCount=void 0,this.suppressServerSideFullWidthLoadingRow=void 0,this.cacheBlockSize=void 0,this.maxBlocksInCache=void 0,this.maxConcurrentDatasourceRequests=void 0,this.blockLoadDebounceMillis=void 0,this.purgeClosedRowNodes=void 0,this.serverSideDatasource=void 0,this.serverSideSortAllLevels=void 0,this.serverSideEnableClientSideSort=void 0,this.serverSideOnlyRefreshFilteredGroups=void 0,this.serverSidePivotResultFieldSeparator=void 0,this.viewportDatasource=void 0,this.viewportRowModelPageSize=void 0,this.viewportRowModelBufferSize=void 0,this.alwaysShowHorizontalScroll=void 0,this.alwaysShowVerticalScroll=void 0,this.debounceVerticalScrollbar=void 0,this.suppressHorizontalScroll=void 0,this.suppressScrollOnNewData=void 0,this.suppressScrollWhenPopupsAreOpen=void 0,this.suppressAnimationFrame=void 0,this.suppressMiddleClickScrolls=void 0,this.suppressPreventDefaultOnMouseWheel=void 0,this.scrollbarWidth=void 0,this.rowSelection=void 0,this.cellSelection=void 0,this.rowMultiSelectWithClick=void 0,this.suppressRowDeselection=void 0,this.suppressRowClickSelection=void 0,this.suppressCellFocus=void 0,this.suppressHeaderFocus=void 0,this.selectionColumnDef=void 0,this.rowNumbers=void 0,this.suppressMultiRangeSelection=void 0,this.enableCellTextSelection=void 0,this.enableRangeSelection=void 0,this.enableRangeHandle=void 0,this.enableFillHandle=void 0,this.fillHandleDirection=void 0,this.suppressClearOnFillReduction=void 0,this.sortingOrder=void 0,this.accentedSort=void 0,this.unSortIcon=void 0,this.suppressMultiSort=void 0,this.alwaysMultiSort=void 0,this.multiSortKey=void 0,this.suppressMaintainUnsortedOrder=void 0,this.icons=void 0,this.rowHeight=void 0,this.rowStyle=void 0,this.rowClass=void 0,this.rowClassRules=void 0,this.suppressRowHoverHighlight=void 0,this.suppressRowTransform=void 0,this.columnHoverHighlight=void 0,this.gridId=void 0,this.deltaSort=void 0,this.treeDataDisplayType=void 0,this.enableGroupEdit=void 0,this.initialState=void 0,this.theme=void 0,this.loadThemeGoogleFonts=void 0,this.themeCssLayer=void 0,this.styleNonce=void 0,this.themeStyleContainer=void 0,this.getContextMenuItems=void 0,this.getMainMenuItems=void 0,this.postProcessPopup=void 0,this.processUnpinnedColumns=void 0,this.processCellForClipboard=void 0,this.processHeaderForClipboard=void 0,this.processGroupHeaderForClipboard=void 0,this.processCellFromClipboard=void 0,this.sendToClipboard=void 0,this.processDataFromClipboard=void 0,this.isExternalFilterPresent=void 0,this.doesExternalFilterPass=void 0,this.getChartToolbarItems=void 0,this.createChartContainer=void 0,this.focusGridInnerElement=void 0,this.navigateToNextHeader=void 0,this.tabToNextHeader=void 0,this.navigateToNextCell=void 0,this.tabToNextCell=void 0,this.getLocaleText=void 0,this.getDocument=void 0,this.paginationNumberFormatter=void 0,this.getGroupRowAgg=void 0,this.isGroupOpenByDefault=void 0,this.ssrmExpandAllAffectsAllRows=void 0,this.initialGroupOrderComparator=void 0,this.processPivotResultColDef=void 0,this.processPivotResultColGroupDef=void 0,this.getDataPath=void 0,this.getChildCount=void 0,this.getServerSideGroupLevelParams=void 0,this.isServerSideGroupOpenByDefault=void 0,this.isApplyServerSideTransaction=void 0,this.isServerSideGroup=void 0,this.getServerSideGroupKey=void 0,this.getBusinessKeyForNode=void 0,this.getRowId=void 0,this.resetRowDataOnUpdate=void 0,this.processRowPostCreate=void 0,this.isRowSelectable=void 0,this.isRowMaster=void 0,this.fillOperation=void 0,this.postSortRows=void 0,this.getRowStyle=void 0,this.getRowClass=void 0,this.getRowHeight=void 0,this.isFullWidthRow=void 0,this.isRowValidDropPosition=void 0,this.toolPanelVisibleChanged=new A,this.toolPanelSizeChanged=new A,this.columnMenuVisibleChanged=new A,this.contextMenuVisibleChanged=new A,this.cutStart=new A,this.cutEnd=new A,this.pasteStart=new A,this.pasteEnd=new A,this.columnVisible=new A,this.columnPinned=new A,this.columnResized=new A,this.columnMoved=new A,this.columnValueChanged=new A,this.columnPivotModeChanged=new A,this.columnPivotChanged=new A,this.columnGroupOpened=new A,this.newColumnsLoaded=new A,this.gridColumnsChanged=new A,this.displayedColumnsChanged=new A,this.virtualColumnsChanged=new A,this.columnEverythingChanged=new A,this.columnsReset=new A,this.columnHeaderMouseOver=new A,this.columnHeaderMouseLeave=new A,this.columnHeaderClicked=new A,this.columnHeaderContextMenu=new A,this.componentStateChanged=new A,this.cellValueChanged=new A,this.cellEditRequest=new A,this.rowValueChanged=new A,this.cellEditingStarted=new A,this.cellEditingStopped=new A,this.rowEditingStarted=new A,this.rowEditingStopped=new A,this.bulkEditingStarted=new A,this.bulkEditingStopped=new A,this.batchEditingStarted=new A,this.batchEditingStopped=new A,this.undoStarted=new A,this.undoEnded=new A,this.redoStarted=new A,this.redoEnded=new A,this.cellSelectionDeleteStart=new A,this.cellSelectionDeleteEnd=new A,this.rangeDeleteStart=new A,this.rangeDeleteEnd=new A,this.fillStart=new A,this.fillEnd=new A,this.filterOpened=new A,this.filterChanged=new A,this.filterModified=new A,this.filterUiChanged=new A,this.floatingFilterUiChanged=new A,this.advancedFilterBuilderVisibleChanged=new A,this.findChanged=new A,this.chartCreated=new A,this.chartRangeSelectionChanged=new A,this.chartOptionsChanged=new A,this.chartDestroyed=new A,this.cellKeyDown=new A,this.gridReady=new A,this.firstDataRendered=new A,this.gridSizeChanged=new A,this.modelUpdated=new A,this.virtualRowRemoved=new A,this.viewportChanged=new A,this.bodyScroll=new A,this.bodyScrollEnd=new A,this.dragStarted=new A,this.dragStopped=new A,this.dragCancelled=new A,this.stateUpdated=new A,this.paginationChanged=new A,this.rowDragEnter=new A,this.rowDragMove=new A,this.rowDragLeave=new A,this.rowDragEnd=new A,this.rowDragCancel=new A,this.rowResizeStarted=new A,this.rowResizeEnded=new A,this.columnRowGroupChanged=new A,this.rowGroupOpened=new A,this.expandOrCollapseAll=new A,this.pivotMaxColumnsExceeded=new A,this.pinnedRowDataChanged=new A,this.pinnedRowsChanged=new A,this.rowDataUpdated=new A,this.asyncTransactionsFlushed=new A,this.storeRefreshed=new A,this.headerFocused=new A,this.cellClicked=new A,this.cellDoubleClicked=new A,this.cellFocused=new A,this.cellMouseOver=new A,this.cellMouseOut=new A,this.cellMouseDown=new A,this.rowClicked=new A,this.rowDoubleClicked=new A,this.rowSelected=new A,this.selectionChanged=new A,this.cellContextMenu=new A,this.rangeSelectionChanged=new A,this.cellSelectionChanged=new A,this.tooltipShow=new A,this.tooltipHide=new A,this.sortChanged=new A,this._nativeElement=n.nativeElement,this._fullyReady.then(()=>{this._holdEvents=!1})}ngAfterViewInit(){this._angularFrameworkOverrides.runOutsideAngular(()=>{this._frameworkCompWrapper.setViewContainerRef(this._viewContainerRef,this._angularFrameworkOverrides);let n=Object.keys(this).filter(l=>!(l.startsWith("_")||l=="gridOptions"||l=="modules"||this[l]instanceof A)),s={};for(let l of n){let d=rZ(l,this[l]);s[l]=d}let o=p4(this.gridOptions,s,n),r={globalListener:this.globalListener.bind(this),frameworkOverrides:this._angularFrameworkOverrides,providedBeanInstances:{frameworkCompWrapper:this._frameworkCompWrapper},modules:this.modules||[],setThemeOnGridDiv:!0},a=aD(this._nativeElement,o,r);a&&(this.api=a),this._initialised=!0,this._resolveFullyReady()})}ngOnChanges(n){this._initialised&&this._angularFrameworkOverrides.runOutsideAngular(()=>{let s={};for(let o of Object.keys(n)){let r=n[o];s[o]=r.currentValue}g4(s,this.api)})}ngOnDestroy(){this._initialised&&(this._destroyed=!0,this.api?.destroy())}isEmitterUsed(n){let o=this[n],r=o?.observed??o?.observers?.length>0,a=`on${n.charAt(0).toUpperCase()}${n.substring(1)}`,l=!!this.gridOptions&&!!this.gridOptions[a];return r||l}globalListener(n,s){if(this._destroyed)return;let o=this[n];if(o&&this.isEmitterUsed(n)){let r=()=>this._angularFrameworkOverrides.runInsideAngular(()=>o.emit(s));this._holdEvents?this._fullyReady.then(()=>r()):r()}}};t.\u0275fac=function(s){return new(s||t)(Ya(yt),Ya(Cr),Ya(WD),Ya(zD))},t.\u0275cmp=be({type:t,selectors:[["ag-grid-angular"]],inputs:{gridOptions:"gridOptions",modules:"modules",statusBar:"statusBar",sideBar:"sideBar",suppressContextMenu:[2,"suppressContextMenu","suppressContextMenu",D],preventDefaultOnContextMenu:[2,"preventDefaultOnContextMenu","preventDefaultOnContextMenu",D],allowContextMenuWithControlKey:[2,"allowContextMenuWithControlKey","allowContextMenuWithControlKey",D],columnMenu:"columnMenu",suppressMenuHide:[2,"suppressMenuHide","suppressMenuHide",D],enableBrowserTooltips:[2,"enableBrowserTooltips","enableBrowserTooltips",D],tooltipTrigger:"tooltipTrigger",tooltipShowDelay:"tooltipShowDelay",tooltipHideDelay:"tooltipHideDelay",tooltipMouseTrack:[2,"tooltipMouseTrack","tooltipMouseTrack",D],tooltipShowMode:"tooltipShowMode",tooltipInteraction:[2,"tooltipInteraction","tooltipInteraction",D],popupParent:"popupParent",copyHeadersToClipboard:[2,"copyHeadersToClipboard","copyHeadersToClipboard",D],copyGroupHeadersToClipboard:[2,"copyGroupHeadersToClipboard","copyGroupHeadersToClipboard",D],clipboardDelimiter:"clipboardDelimiter",suppressCopyRowsToClipboard:[2,"suppressCopyRowsToClipboard","suppressCopyRowsToClipboard",D],suppressCopySingleCellRanges:[2,"suppressCopySingleCellRanges","suppressCopySingleCellRanges",D],suppressLastEmptyLineOnPaste:[2,"suppressLastEmptyLineOnPaste","suppressLastEmptyLineOnPaste",D],suppressClipboardPaste:[2,"suppressClipboardPaste","suppressClipboardPaste",D],suppressClipboardApi:[2,"suppressClipboardApi","suppressClipboardApi",D],suppressCutToClipboard:[2,"suppressCutToClipboard","suppressCutToClipboard",D],columnDefs:"columnDefs",defaultColDef:"defaultColDef",defaultColGroupDef:"defaultColGroupDef",columnTypes:"columnTypes",dataTypeDefinitions:"dataTypeDefinitions",maintainColumnOrder:[2,"maintainColumnOrder","maintainColumnOrder",D],enableStrictPivotColumnOrder:[2,"enableStrictPivotColumnOrder","enableStrictPivotColumnOrder",D],suppressFieldDotNotation:[2,"suppressFieldDotNotation","suppressFieldDotNotation",D],headerHeight:"headerHeight",groupHeaderHeight:"groupHeaderHeight",floatingFiltersHeight:"floatingFiltersHeight",pivotHeaderHeight:"pivotHeaderHeight",pivotGroupHeaderHeight:"pivotGroupHeaderHeight",hidePaddedHeaderRows:[2,"hidePaddedHeaderRows","hidePaddedHeaderRows",D],allowDragFromColumnsToolPanel:[2,"allowDragFromColumnsToolPanel","allowDragFromColumnsToolPanel",D],suppressMovableColumns:[2,"suppressMovableColumns","suppressMovableColumns",D],suppressColumnMoveAnimation:[2,"suppressColumnMoveAnimation","suppressColumnMoveAnimation",D],suppressMoveWhenColumnDragging:[2,"suppressMoveWhenColumnDragging","suppressMoveWhenColumnDragging",D],suppressDragLeaveHidesColumns:[2,"suppressDragLeaveHidesColumns","suppressDragLeaveHidesColumns",D],suppressGroupChangesColumnVisibility:"suppressGroupChangesColumnVisibility",suppressMakeColumnVisibleAfterUnGroup:[2,"suppressMakeColumnVisibleAfterUnGroup","suppressMakeColumnVisibleAfterUnGroup",D],suppressRowGroupHidesColumns:[2,"suppressRowGroupHidesColumns","suppressRowGroupHidesColumns",D],colResizeDefault:"colResizeDefault",suppressAutoSize:[2,"suppressAutoSize","suppressAutoSize",D],autoSizePadding:"autoSizePadding",skipHeaderOnAutoSize:[2,"skipHeaderOnAutoSize","skipHeaderOnAutoSize",D],autoSizeStrategy:"autoSizeStrategy",components:"components",editType:"editType",suppressStartEditOnTab:[2,"suppressStartEditOnTab","suppressStartEditOnTab",D],getFullRowEditValidationErrors:"getFullRowEditValidationErrors",invalidEditValueMode:"invalidEditValueMode",singleClickEdit:[2,"singleClickEdit","singleClickEdit",D],suppressClickEdit:[2,"suppressClickEdit","suppressClickEdit",D],readOnlyEdit:[2,"readOnlyEdit","readOnlyEdit",D],stopEditingWhenCellsLoseFocus:[2,"stopEditingWhenCellsLoseFocus","stopEditingWhenCellsLoseFocus",D],enterNavigatesVertically:[2,"enterNavigatesVertically","enterNavigatesVertically",D],enterNavigatesVerticallyAfterEdit:[2,"enterNavigatesVerticallyAfterEdit","enterNavigatesVerticallyAfterEdit",D],enableCellEditingOnBackspace:[2,"enableCellEditingOnBackspace","enableCellEditingOnBackspace",D],undoRedoCellEditing:[2,"undoRedoCellEditing","undoRedoCellEditing",D],undoRedoCellEditingLimit:"undoRedoCellEditingLimit",defaultCsvExportParams:"defaultCsvExportParams",suppressCsvExport:[2,"suppressCsvExport","suppressCsvExport",D],defaultExcelExportParams:"defaultExcelExportParams",suppressExcelExport:[2,"suppressExcelExport","suppressExcelExport",D],excelStyles:"excelStyles",findSearchValue:"findSearchValue",findOptions:"findOptions",quickFilterText:"quickFilterText",cacheQuickFilter:[2,"cacheQuickFilter","cacheQuickFilter",D],includeHiddenColumnsInQuickFilter:[2,"includeHiddenColumnsInQuickFilter","includeHiddenColumnsInQuickFilter",D],quickFilterParser:"quickFilterParser",quickFilterMatcher:"quickFilterMatcher",applyQuickFilterBeforePivotOrAgg:[2,"applyQuickFilterBeforePivotOrAgg","applyQuickFilterBeforePivotOrAgg",D],excludeChildrenWhenTreeDataFiltering:[2,"excludeChildrenWhenTreeDataFiltering","excludeChildrenWhenTreeDataFiltering",D],enableAdvancedFilter:[2,"enableAdvancedFilter","enableAdvancedFilter",D],alwaysPassFilter:"alwaysPassFilter",includeHiddenColumnsInAdvancedFilter:[2,"includeHiddenColumnsInAdvancedFilter","includeHiddenColumnsInAdvancedFilter",D],advancedFilterParent:"advancedFilterParent",advancedFilterBuilderParams:"advancedFilterBuilderParams",advancedFilterParams:"advancedFilterParams",suppressAdvancedFilterEval:[2,"suppressAdvancedFilterEval","suppressAdvancedFilterEval",D],suppressSetFilterByDefault:[2,"suppressSetFilterByDefault","suppressSetFilterByDefault",D],enableFilterHandlers:[2,"enableFilterHandlers","enableFilterHandlers",D],filterHandlers:"filterHandlers",enableCharts:[2,"enableCharts","enableCharts",D],chartThemes:"chartThemes",customChartThemes:"customChartThemes",chartThemeOverrides:"chartThemeOverrides",chartToolPanelsDef:"chartToolPanelsDef",chartMenuItems:"chartMenuItems",loadingCellRenderer:"loadingCellRenderer",loadingCellRendererParams:"loadingCellRendererParams",loadingCellRendererSelector:"loadingCellRendererSelector",localeText:"localeText",masterDetail:[2,"masterDetail","masterDetail",D],keepDetailRows:[2,"keepDetailRows","keepDetailRows",D],keepDetailRowsCount:"keepDetailRowsCount",detailCellRenderer:"detailCellRenderer",detailCellRendererParams:"detailCellRendererParams",detailRowHeight:"detailRowHeight",detailRowAutoHeight:[2,"detailRowAutoHeight","detailRowAutoHeight",D],context:"context",alignedGrids:"alignedGrids",tabIndex:"tabIndex",rowBuffer:"rowBuffer",valueCache:[2,"valueCache","valueCache",D],valueCacheNeverExpires:[2,"valueCacheNeverExpires","valueCacheNeverExpires",D],enableCellExpressions:[2,"enableCellExpressions","enableCellExpressions",D],suppressTouch:[2,"suppressTouch","suppressTouch",D],suppressFocusAfterRefresh:[2,"suppressFocusAfterRefresh","suppressFocusAfterRefresh",D],suppressBrowserResizeObserver:[2,"suppressBrowserResizeObserver","suppressBrowserResizeObserver",D],suppressPropertyNamesCheck:[2,"suppressPropertyNamesCheck","suppressPropertyNamesCheck",D],suppressChangeDetection:[2,"suppressChangeDetection","suppressChangeDetection",D],debug:[2,"debug","debug",D],loading:[2,"loading","loading",D],overlayLoadingTemplate:"overlayLoadingTemplate",loadingOverlayComponent:"loadingOverlayComponent",loadingOverlayComponentParams:"loadingOverlayComponentParams",suppressLoadingOverlay:[2,"suppressLoadingOverlay","suppressLoadingOverlay",D],overlayNoRowsTemplate:"overlayNoRowsTemplate",noRowsOverlayComponent:"noRowsOverlayComponent",noRowsOverlayComponentParams:"noRowsOverlayComponentParams",suppressNoRowsOverlay:[2,"suppressNoRowsOverlay","suppressNoRowsOverlay",D],pagination:[2,"pagination","pagination",D],paginationPageSize:"paginationPageSize",paginationPageSizeSelector:"paginationPageSizeSelector",paginationAutoPageSize:[2,"paginationAutoPageSize","paginationAutoPageSize",D],paginateChildRows:[2,"paginateChildRows","paginateChildRows",D],suppressPaginationPanel:[2,"suppressPaginationPanel","suppressPaginationPanel",D],pivotMode:[2,"pivotMode","pivotMode",D],pivotPanelShow:"pivotPanelShow",pivotMaxGeneratedColumns:"pivotMaxGeneratedColumns",pivotDefaultExpanded:"pivotDefaultExpanded",pivotColumnGroupTotals:"pivotColumnGroupTotals",pivotRowTotals:"pivotRowTotals",pivotSuppressAutoColumn:[2,"pivotSuppressAutoColumn","pivotSuppressAutoColumn",D],suppressExpandablePivotGroups:[2,"suppressExpandablePivotGroups","suppressExpandablePivotGroups",D],functionsReadOnly:[2,"functionsReadOnly","functionsReadOnly",D],aggFuncs:"aggFuncs",suppressAggFuncInHeader:[2,"suppressAggFuncInHeader","suppressAggFuncInHeader",D],alwaysAggregateAtRootLevel:[2,"alwaysAggregateAtRootLevel","alwaysAggregateAtRootLevel",D],aggregateOnlyChangedColumns:[2,"aggregateOnlyChangedColumns","aggregateOnlyChangedColumns",D],suppressAggFilteredOnly:[2,"suppressAggFilteredOnly","suppressAggFilteredOnly",D],removePivotHeaderRowWhenSingleValueColumn:[2,"removePivotHeaderRowWhenSingleValueColumn","removePivotHeaderRowWhenSingleValueColumn",D],animateRows:[2,"animateRows","animateRows",D],cellFlashDuration:"cellFlashDuration",cellFadeDuration:"cellFadeDuration",allowShowChangeAfterFilter:[2,"allowShowChangeAfterFilter","allowShowChangeAfterFilter",D],domLayout:"domLayout",ensureDomOrder:[2,"ensureDomOrder","ensureDomOrder",D],enableCellSpan:[2,"enableCellSpan","enableCellSpan",D],enableRtl:[2,"enableRtl","enableRtl",D],suppressColumnVirtualisation:[2,"suppressColumnVirtualisation","suppressColumnVirtualisation",D],suppressMaxRenderedRowRestriction:[2,"suppressMaxRenderedRowRestriction","suppressMaxRenderedRowRestriction",D],suppressRowVirtualisation:[2,"suppressRowVirtualisation","suppressRowVirtualisation",D],rowDragManaged:[2,"rowDragManaged","rowDragManaged",D],rowDragInsertDelay:"rowDragInsertDelay",suppressRowDrag:[2,"suppressRowDrag","suppressRowDrag",D],suppressMoveWhenRowDragging:[2,"suppressMoveWhenRowDragging","suppressMoveWhenRowDragging",D],rowDragEntireRow:[2,"rowDragEntireRow","rowDragEntireRow",D],rowDragMultiRow:[2,"rowDragMultiRow","rowDragMultiRow",D],rowDragText:"rowDragText",dragAndDropImageComponent:"dragAndDropImageComponent",dragAndDropImageComponentParams:"dragAndDropImageComponentParams",fullWidthCellRenderer:"fullWidthCellRenderer",fullWidthCellRendererParams:"fullWidthCellRendererParams",embedFullWidthRows:[2,"embedFullWidthRows","embedFullWidthRows",D],groupDisplayType:"groupDisplayType",groupDefaultExpanded:"groupDefaultExpanded",autoGroupColumnDef:"autoGroupColumnDef",groupMaintainOrder:[2,"groupMaintainOrder","groupMaintainOrder",D],groupSelectsChildren:[2,"groupSelectsChildren","groupSelectsChildren",D],groupLockGroupColumns:"groupLockGroupColumns",groupAggFiltering:"groupAggFiltering",groupTotalRow:"groupTotalRow",grandTotalRow:"grandTotalRow",suppressStickyTotalRow:"suppressStickyTotalRow",groupSuppressBlankHeader:[2,"groupSuppressBlankHeader","groupSuppressBlankHeader",D],groupSelectsFiltered:[2,"groupSelectsFiltered","groupSelectsFiltered",D],showOpenedGroup:[2,"showOpenedGroup","showOpenedGroup",D],groupHideParentOfSingleChild:"groupHideParentOfSingleChild",groupRemoveSingleChildren:[2,"groupRemoveSingleChildren","groupRemoveSingleChildren",D],groupRemoveLowestSingleChildren:[2,"groupRemoveLowestSingleChildren","groupRemoveLowestSingleChildren",D],groupHideOpenParents:[2,"groupHideOpenParents","groupHideOpenParents",D],groupAllowUnbalanced:[2,"groupAllowUnbalanced","groupAllowUnbalanced",D],rowGroupPanelShow:"rowGroupPanelShow",groupRowRenderer:"groupRowRenderer",groupRowRendererParams:"groupRowRendererParams",treeData:[2,"treeData","treeData",D],treeDataChildrenField:"treeDataChildrenField",treeDataParentIdField:"treeDataParentIdField",rowGroupPanelSuppressSort:[2,"rowGroupPanelSuppressSort","rowGroupPanelSuppressSort",D],suppressGroupRowsSticky:[2,"suppressGroupRowsSticky","suppressGroupRowsSticky",D],groupHierarchyConfig:"groupHierarchyConfig",pinnedTopRowData:"pinnedTopRowData",pinnedBottomRowData:"pinnedBottomRowData",enableRowPinning:"enableRowPinning",isRowPinnable:"isRowPinnable",isRowPinned:"isRowPinned",rowModelType:"rowModelType",rowData:"rowData",asyncTransactionWaitMillis:"asyncTransactionWaitMillis",suppressModelUpdateAfterUpdateTransaction:[2,"suppressModelUpdateAfterUpdateTransaction","suppressModelUpdateAfterUpdateTransaction",D],datasource:"datasource",cacheOverflowSize:"cacheOverflowSize",infiniteInitialRowCount:"infiniteInitialRowCount",serverSideInitialRowCount:"serverSideInitialRowCount",suppressServerSideFullWidthLoadingRow:[2,"suppressServerSideFullWidthLoadingRow","suppressServerSideFullWidthLoadingRow",D],cacheBlockSize:"cacheBlockSize",maxBlocksInCache:"maxBlocksInCache",maxConcurrentDatasourceRequests:"maxConcurrentDatasourceRequests",blockLoadDebounceMillis:"blockLoadDebounceMillis",purgeClosedRowNodes:[2,"purgeClosedRowNodes","purgeClosedRowNodes",D],serverSideDatasource:"serverSideDatasource",serverSideSortAllLevels:[2,"serverSideSortAllLevels","serverSideSortAllLevels",D],serverSideEnableClientSideSort:[2,"serverSideEnableClientSideSort","serverSideEnableClientSideSort",D],serverSideOnlyRefreshFilteredGroups:[2,"serverSideOnlyRefreshFilteredGroups","serverSideOnlyRefreshFilteredGroups",D],serverSidePivotResultFieldSeparator:"serverSidePivotResultFieldSeparator",viewportDatasource:"viewportDatasource",viewportRowModelPageSize:"viewportRowModelPageSize",viewportRowModelBufferSize:"viewportRowModelBufferSize",alwaysShowHorizontalScroll:[2,"alwaysShowHorizontalScroll","alwaysShowHorizontalScroll",D],alwaysShowVerticalScroll:[2,"alwaysShowVerticalScroll","alwaysShowVerticalScroll",D],debounceVerticalScrollbar:[2,"debounceVerticalScrollbar","debounceVerticalScrollbar",D],suppressHorizontalScroll:[2,"suppressHorizontalScroll","suppressHorizontalScroll",D],suppressScrollOnNewData:[2,"suppressScrollOnNewData","suppressScrollOnNewData",D],suppressScrollWhenPopupsAreOpen:[2,"suppressScrollWhenPopupsAreOpen","suppressScrollWhenPopupsAreOpen",D],suppressAnimationFrame:[2,"suppressAnimationFrame","suppressAnimationFrame",D],suppressMiddleClickScrolls:[2,"suppressMiddleClickScrolls","suppressMiddleClickScrolls",D],suppressPreventDefaultOnMouseWheel:[2,"suppressPreventDefaultOnMouseWheel","suppressPreventDefaultOnMouseWheel",D],scrollbarWidth:"scrollbarWidth",rowSelection:"rowSelection",cellSelection:"cellSelection",rowMultiSelectWithClick:[2,"rowMultiSelectWithClick","rowMultiSelectWithClick",D],suppressRowDeselection:[2,"suppressRowDeselection","suppressRowDeselection",D],suppressRowClickSelection:[2,"suppressRowClickSelection","suppressRowClickSelection",D],suppressCellFocus:[2,"suppressCellFocus","suppressCellFocus",D],suppressHeaderFocus:[2,"suppressHeaderFocus","suppressHeaderFocus",D],selectionColumnDef:"selectionColumnDef",rowNumbers:"rowNumbers",suppressMultiRangeSelection:[2,"suppressMultiRangeSelection","suppressMultiRangeSelection",D],enableCellTextSelection:[2,"enableCellTextSelection","enableCellTextSelection",D],enableRangeSelection:[2,"enableRangeSelection","enableRangeSelection",D],enableRangeHandle:[2,"enableRangeHandle","enableRangeHandle",D],enableFillHandle:[2,"enableFillHandle","enableFillHandle",D],fillHandleDirection:"fillHandleDirection",suppressClearOnFillReduction:[2,"suppressClearOnFillReduction","suppressClearOnFillReduction",D],sortingOrder:"sortingOrder",accentedSort:[2,"accentedSort","accentedSort",D],unSortIcon:[2,"unSortIcon","unSortIcon",D],suppressMultiSort:[2,"suppressMultiSort","suppressMultiSort",D],alwaysMultiSort:[2,"alwaysMultiSort","alwaysMultiSort",D],multiSortKey:"multiSortKey",suppressMaintainUnsortedOrder:[2,"suppressMaintainUnsortedOrder","suppressMaintainUnsortedOrder",D],icons:"icons",rowHeight:"rowHeight",rowStyle:"rowStyle",rowClass:"rowClass",rowClassRules:"rowClassRules",suppressRowHoverHighlight:[2,"suppressRowHoverHighlight","suppressRowHoverHighlight",D],suppressRowTransform:[2,"suppressRowTransform","suppressRowTransform",D],columnHoverHighlight:[2,"columnHoverHighlight","columnHoverHighlight",D],gridId:"gridId",deltaSort:[2,"deltaSort","deltaSort",D],treeDataDisplayType:"treeDataDisplayType",enableGroupEdit:[2,"enableGroupEdit","enableGroupEdit",D],initialState:"initialState",theme:"theme",loadThemeGoogleFonts:[2,"loadThemeGoogleFonts","loadThemeGoogleFonts",D],themeCssLayer:"themeCssLayer",styleNonce:"styleNonce",themeStyleContainer:"themeStyleContainer",getContextMenuItems:"getContextMenuItems",getMainMenuItems:"getMainMenuItems",postProcessPopup:"postProcessPopup",processUnpinnedColumns:"processUnpinnedColumns",processCellForClipboard:"processCellForClipboard",processHeaderForClipboard:"processHeaderForClipboard",processGroupHeaderForClipboard:"processGroupHeaderForClipboard",processCellFromClipboard:"processCellFromClipboard",sendToClipboard:"sendToClipboard",processDataFromClipboard:"processDataFromClipboard",isExternalFilterPresent:"isExternalFilterPresent",doesExternalFilterPass:"doesExternalFilterPass",getChartToolbarItems:"getChartToolbarItems",createChartContainer:"createChartContainer",focusGridInnerElement:"focusGridInnerElement",navigateToNextHeader:"navigateToNextHeader",tabToNextHeader:"tabToNextHeader",navigateToNextCell:"navigateToNextCell",tabToNextCell:"tabToNextCell",getLocaleText:"getLocaleText",getDocument:"getDocument",paginationNumberFormatter:"paginationNumberFormatter",getGroupRowAgg:"getGroupRowAgg",isGroupOpenByDefault:"isGroupOpenByDefault",ssrmExpandAllAffectsAllRows:[2,"ssrmExpandAllAffectsAllRows","ssrmExpandAllAffectsAllRows",D],initialGroupOrderComparator:"initialGroupOrderComparator",processPivotResultColDef:"processPivotResultColDef",processPivotResultColGroupDef:"processPivotResultColGroupDef",getDataPath:"getDataPath",getChildCount:"getChildCount",getServerSideGroupLevelParams:"getServerSideGroupLevelParams",isServerSideGroupOpenByDefault:"isServerSideGroupOpenByDefault",isApplyServerSideTransaction:"isApplyServerSideTransaction",isServerSideGroup:"isServerSideGroup",getServerSideGroupKey:"getServerSideGroupKey",getBusinessKeyForNode:"getBusinessKeyForNode",getRowId:"getRowId",resetRowDataOnUpdate:[2,"resetRowDataOnUpdate","resetRowDataOnUpdate",D],processRowPostCreate:"processRowPostCreate",isRowSelectable:"isRowSelectable",isRowMaster:"isRowMaster",fillOperation:"fillOperation",postSortRows:"postSortRows",getRowStyle:"getRowStyle",getRowClass:"getRowClass",getRowHeight:"getRowHeight",isFullWidthRow:"isFullWidthRow",isRowValidDropPosition:"isRowValidDropPosition"},outputs:{toolPanelVisibleChanged:"toolPanelVisibleChanged",toolPanelSizeChanged:"toolPanelSizeChanged",columnMenuVisibleChanged:"columnMenuVisibleChanged",contextMenuVisibleChanged:"contextMenuVisibleChanged",cutStart:"cutStart",cutEnd:"cutEnd",pasteStart:"pasteStart",pasteEnd:"pasteEnd",columnVisible:"columnVisible",columnPinned:"columnPinned",columnResized:"columnResized",columnMoved:"columnMoved",columnValueChanged:"columnValueChanged",columnPivotModeChanged:"columnPivotModeChanged",columnPivotChanged:"columnPivotChanged",columnGroupOpened:"columnGroupOpened",newColumnsLoaded:"newColumnsLoaded",gridColumnsChanged:"gridColumnsChanged",displayedColumnsChanged:"displayedColumnsChanged",virtualColumnsChanged:"virtualColumnsChanged",columnEverythingChanged:"columnEverythingChanged",columnsReset:"columnsReset",columnHeaderMouseOver:"columnHeaderMouseOver",columnHeaderMouseLeave:"columnHeaderMouseLeave",columnHeaderClicked:"columnHeaderClicked",columnHeaderContextMenu:"columnHeaderContextMenu",componentStateChanged:"componentStateChanged",cellValueChanged:"cellValueChanged",cellEditRequest:"cellEditRequest",rowValueChanged:"rowValueChanged",cellEditingStarted:"cellEditingStarted",cellEditingStopped:"cellEditingStopped",rowEditingStarted:"rowEditingStarted",rowEditingStopped:"rowEditingStopped",bulkEditingStarted:"bulkEditingStarted",bulkEditingStopped:"bulkEditingStopped",batchEditingStarted:"batchEditingStarted",batchEditingStopped:"batchEditingStopped",undoStarted:"undoStarted",undoEnded:"undoEnded",redoStarted:"redoStarted",redoEnded:"redoEnded",cellSelectionDeleteStart:"cellSelectionDeleteStart",cellSelectionDeleteEnd:"cellSelectionDeleteEnd",rangeDeleteStart:"rangeDeleteStart",rangeDeleteEnd:"rangeDeleteEnd",fillStart:"fillStart",fillEnd:"fillEnd",filterOpened:"filterOpened",filterChanged:"filterChanged",filterModified:"filterModified",filterUiChanged:"filterUiChanged",floatingFilterUiChanged:"floatingFilterUiChanged",advancedFilterBuilderVisibleChanged:"advancedFilterBuilderVisibleChanged",findChanged:"findChanged",chartCreated:"chartCreated",chartRangeSelectionChanged:"chartRangeSelectionChanged",chartOptionsChanged:"chartOptionsChanged",chartDestroyed:"chartDestroyed",cellKeyDown:"cellKeyDown",gridReady:"gridReady",firstDataRendered:"firstDataRendered",gridSizeChanged:"gridSizeChanged",modelUpdated:"modelUpdated",virtualRowRemoved:"virtualRowRemoved",viewportChanged:"viewportChanged",bodyScroll:"bodyScroll",bodyScrollEnd:"bodyScrollEnd",dragStarted:"dragStarted",dragStopped:"dragStopped",dragCancelled:"dragCancelled",stateUpdated:"stateUpdated",paginationChanged:"paginationChanged",rowDragEnter:"rowDragEnter",rowDragMove:"rowDragMove",rowDragLeave:"rowDragLeave",rowDragEnd:"rowDragEnd",rowDragCancel:"rowDragCancel",rowResizeStarted:"rowResizeStarted",rowResizeEnded:"rowResizeEnded",columnRowGroupChanged:"columnRowGroupChanged",rowGroupOpened:"rowGroupOpened",expandOrCollapseAll:"expandOrCollapseAll",pivotMaxColumnsExceeded:"pivotMaxColumnsExceeded",pinnedRowDataChanged:"pinnedRowDataChanged",pinnedRowsChanged:"pinnedRowsChanged",rowDataUpdated:"rowDataUpdated",asyncTransactionsFlushed:"asyncTransactionsFlushed",storeRefreshed:"storeRefreshed",headerFocused:"headerFocused",cellClicked:"cellClicked",cellDoubleClicked:"cellDoubleClicked",cellFocused:"cellFocused",cellMouseOver:"cellMouseOver",cellMouseOut:"cellMouseOut",cellMouseDown:"cellMouseDown",rowClicked:"rowClicked",rowDoubleClicked:"rowDoubleClicked",rowSelected:"rowSelected",selectionChanged:"selectionChanged",cellContextMenu:"cellContextMenu",rangeSelectionChanged:"rangeSelectionChanged",cellSelectionChanged:"cellSelectionChanged",tooltipShow:"tooltipShow",tooltipHide:"tooltipHide",sortChanged:"sortChanged"},features:[Ie([WD,zD]),Ow],decls:0,vars:0,template:function(s,o){},encapsulation:2});let e=t;return e})(),oZ=new Set(gw);function rZ(e,t){return oZ.has(e)?t===""?!0:t==="false"?!1:t:t}function aZ(e,t){if(e&1){let i=rt();M(0,"button",2),Q("click",function(){let s=he(i).$implicit,o=Z();return pe(o.onActionClick(s))}),ee(1,"ng-icon",3),R()}if(e&2){let i=t.$implicit;Ce("variant",i.variant||"ghost"),P(),Ce("name",i.icon)}}var qD=(()=>{class e{actions=[];data;agInit(i){this.actions=i.actions||[],this.data=i.data}refresh(i){return this.actions=i.actions||[],this.data=i.data,!0}onActionClick(i){i.action(this.data)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=be({type:e,selectors:[["gh-ag-grid-actions-cell"]],decls:3,vars:0,consts:[[1,"flex","gap-2","h-full","items-center"],["hlmBtn","","size","icon",3,"variant"],["hlmBtn","","size","icon",3,"click","variant"],["hlm","","size","sm",3,"name"]],template:function(n,s){n&1&&(M(0,"div",0),cn(1,aZ,2,2,"button",1,Zd),R()),n&2&&(P(),un(s.actions))},dependencies:[Jt,it,xt],encapsulation:2})}return e})();function lZ(e,t){e&1&&(M(0,"div",6),ee(1,"hlm-spinner",10),R())}function dZ(e,t){if(e&1&&(M(0,"div",7)(1,"p"),_(2),Y(3,"transloco"),R()()),e&2){let i=Z();P(2),Qi("",X(3,2,"common.error"),": ",i.plansService.plans.error())}}function cZ(e,t){if(e&1){let i=rt();M(0,"div",8)(1,"p",11),_(2),Y(3,"transloco"),R(),M(4,"button",4),Q("click",function(){he(i);let s=Z();return pe(s.openCreateDialog())}),ee(5,"ng-icon",5),_(6),Y(7,"transloco"),R()()}e&2&&(P(2),Ee(X(3,2,"housePlans.noPlans")),P(4),xe(" ",X(7,4,"housePlans.createFirst")," "))}function uZ(e,t){if(e&1&&ee(0,"ag-grid-angular",9),e&2){let i=Z();Ce("rowData",i.plansService.plans.value())("columnDefs",i.columnDefs)("defaultColDef",i.defaultColDef)("gridOptions",i.gridOptions)}}function hZ(e,t){if(e&1){let i=rt();M(0,"div",12),Q("click",function(){he(i);let s=Z();return pe(s.closeCreateDialog())}),R(),M(1,"div",13)(2,"div",14)(3,"div")(4,"h3",15),_(5),Y(6,"transloco"),R(),M(7,"p",16),_(8),Y(9,"transloco"),R()(),M(10,"div",17)(11,"label",18),_(12),Y(13,"transloco"),R(),M(14,"input",19),Y(15,"transloco"),yr("ngModelChange",function(s){he(i);let o=Z();return br(o.newPlanName,s)||(o.newPlanName=s),pe(s)}),R()(),M(16,"div",17)(17,"label",20),_(18),Y(19,"transloco"),R(),M(20,"textarea",21),Y(21,"transloco"),yr("ngModelChange",function(s){he(i);let o=Z();return br(o.newPlanDescription,s)||(o.newPlanDescription=s),pe(s)}),R()(),M(22,"div",22)(23,"button",23),Q("click",function(){he(i);let s=Z();return pe(s.closeCreateDialog())}),_(24),Y(25,"transloco"),R(),M(26,"button",24),Q("click",function(){he(i);let s=Z();return pe(s.createPlan())}),_(27),Y(28,"transloco"),R()()()()}if(e&2){let i=Z();P(5),Ee(X(6,11,"housePlans.createNewPlan")),P(3),Ee(X(9,13,"housePlans.createNewPlanDesc")),P(4),xe(" ",X(13,15,"housePlans.planName")," "),P(2),wr("ngModel",i.newPlanName),Ce("placeholder",X(15,17,"housePlans.planNamePlaceholder")),P(4),xe(" ",X(19,19,"housePlans.planDescription")," "),P(2),wr("ngModel",i.newPlanDescription),Ce("placeholder",X(21,21,"housePlans.planDescriptionPlaceholder")),P(4),xe(" ",X(25,23,"common.cancel")," "),P(2),Ce("disabled",!i.newPlanName.trim()),P(),xe(" ",X(28,25,"common.create")," ")}}var $D=(()=>{class e{router=z(ic);plansService=z(Qs);columnDefs=[{headerName:"Name",field:"name",flex:2,sortable:!0,filter:!0},{headerName:"Description",field:"description",flex:3,sortable:!0,filter:!0},{headerName:"Walls",valueGetter:i=>i.data?.walls?.length||0,flex:1,sortable:!0},{headerName:"Created",field:"created_at",flex:2,sortable:!0,valueFormatter:i=>i.value?new Date(i.value).toLocaleDateString():""},{headerName:"Actions",cellRenderer:qD,cellRendererParams:{actions:[{icon:"lucideEye",variant:"ghost",action:i=>this.viewPlan(i.id)},{icon:"lucideTrash",variant:"ghost",action:i=>this.deletePlan(i.id)}]},flex:1,sortable:!1,filter:!1}];defaultColDef={resizable:!0,sortable:!0};gridOptions={rowHeight:48,headerHeight:48,pagination:!0,paginationPageSize:20,paginationPageSizeSelector:[10,20,50,100]};showCreateDialog=!1;newPlanName="";newPlanDescription="";openCreateDialog(){this.showCreateDialog=!0,this.newPlanName="",this.newPlanDescription=""}closeCreateDialog(){this.showCreateDialog=!1}createPlan(){this.newPlanName.trim()&&(this.plansService.createPlan({name:this.newPlanName,description:this.newPlanDescription||void 0}),this.closeCreateDialog())}viewPlan(i){this.router.navigate(["hd","house-plan",i])}deletePlan(i){confirm("Are you sure you want to delete this plan?")&&this.plansService.deletePlan(i)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=be({type:e,selectors:[["gh-house-plans-list"]],features:[Ie([Qs,Lt({lucidePlus:lc,lucideEye:d1,lucideTrash:Mr})])],decls:19,vars:11,consts:[[1,"p-4","md:p-6","space-y-4"],[1,"flex","items-center","justify-between"],[1,"text-2xl","md:text-3xl","font-bold"],[1,"text-muted-foreground","mt-1"],["hlmBtn","",3,"click"],["hlm","","name","lucidePlus","size","sm",1,"mr-2"],[1,"flex","items-center","justify-center","py-12"],[1,"text-center","py-12","text-destructive"],[1,"text-center","py-12"],[1,"ag-theme-alpine",2,"width","100%","height","600px",3,"rowData","columnDefs","defaultColDef","gridOptions"],["size","large"],[1,"text-muted-foreground","mb-4"],[1,"fixed","inset-0","z-50","bg-black/50",3,"click"],[1,"fixed","left-1/2","top-1/2","z-50","w-full","max-w-lg","-translate-x-1/2","-translate-y-1/2","bg-background","shadow-lg","rounded-lg","p-6"],[1,"space-y-4"],[1,"text-lg","font-semibold"],[1,"text-sm","text-muted-foreground"],[1,"space-y-2"],["hlmLabel","","for","plan-name"],["hlmInput","","id","plan-name","type","text",3,"ngModelChange","ngModel","placeholder"],["hlmLabel","","for","plan-description"],["hlmInput","","id","plan-description","rows","3",3,"ngModelChange","ngModel","placeholder"],[1,"flex","gap-2","pt-4"],["hlmBtn","","variant","outline",1,"flex-1",3,"click"],["hlmBtn","",1,"flex-1",3,"click","disabled"]],template:function(n,s){n&1&&(M(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),_(4),Y(5,"transloco"),R(),M(6,"p",3),_(7),Y(8,"transloco"),R()(),M(9,"button",4),Q("click",function(){return s.openCreateDialog()}),ee(10,"ng-icon",5),_(11),Y(12,"transloco"),R()(),M(13,"div"),ze(14,lZ,2,0,"div",6)(15,dZ,4,4,"div",7)(16,cZ,8,6,"div",8)(17,uZ,1,4,"ag-grid-angular",9),R()(),ze(18,hZ,29,27)),n&2&&(P(4),Ee(X(5,5,"housePlans.title")),P(3),Ee(X(8,7,"housePlans.subtitle")),P(4),xe(" ",X(12,9,"housePlans.createNew")," "),P(3),We(s.plansService.plans.isLoading()?14:s.plansService.plans.error()?15:!s.plansService.plans.value()||s.plansService.plans.value().length===0?16:17),P(4),We(s.showCreateDialog?18:-1))},dependencies:[gn,ac,sc,oc,rc,ug,Jt,il,Dr,it,xt,kr,fn,As],encapsulation:2,changeDetection:0})}return e})();var jD=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=bg({type:e});static \u0275inj=vg({})}return e})();var pZ=["viewport"],gZ=["*",[["hlm-select-scroll-up"]],[["brnSelectScrollUp"]],[["brnSelectScrollDown"]],[["hlm-select-scroll-down"]]],fZ=["*","hlm-select-scroll-up","brnSelectScrollUp","brnSelectScrollDown","hlm-select-scroll-down"];function mZ(e,t){e&1&&(Qe(0,1),Qe(1,2))}function CZ(e,t){e&1&&Ji(0)}function vZ(e,t){e&1&&(Qe(0,3),Qe(1,4))}function wZ(e,t){e&1&&Ji(0)}var bZ=[[["hlm-select-trigger"],["","brnSelectTrigger",""]],[["label","hlmLabel",""],["label","brnLabel",""]],"*"],yZ=["hlm-select-trigger,[brnSelectTrigger]","label[hlmLabel],label[brnLabel]","*"];function SZ(e,t){if(e&1&&(M(0,"label",1),_(1),R()),e&2){let i=Z();St("id",i.labelId()),P(),Ee(i.placeholder())}}function xZ(e,t){e&1&&Qe(0,1)}function EZ(e,t){e&1&&Qe(0,2)}var RZ=e=>({$implicit:e});function MZ(e,t){if(e&1&&Ji(0,2),e&2){let i,n=Z(),s=hn(5);Ce("ngTemplateOutlet",((i=n._customPlaceholderTemplate())==null?null:i.templateRef)??s)}}function DZ(e,t){if(e&1&&Ji(0,3),e&2){let i,n=Z(),s=hn(3);Ce("ngTemplateOutlet",((i=n._customValueTemplate())==null?null:i.templateRef)??s)("ngTemplateOutletContext",Bw(2,RZ,n._select.value()))}}function kZ(e,t){if(e&1&&_(0),e&2){let i=Z();Ee(i._value())}}function PZ(e,t){if(e&1&&_(0),e&2){let i=Z();Ee(i.placeholder())}}var QD=new dn("BrnSelectContentToken");function FZ(){return z(QD)}function TZ(e){return{provide:QD,useExisting:e}}var ZD=new dn("BrnSelectToken");function pg(){return z(ZD)}function AZ(e){return{provide:ZD,useExisting:e}}var IZ=0,mo=(()=>{class e{_select=pg();_content=FZ();elementRef=z(yt);id=H(`brn-option-${++IZ}`);value=H();_disabled=H(!1,{alias:"disabled",transform:D});get disabled(){return this._disabled()}selected=W(()=>this.value()!==void 0&&this._select.isSelected(this.value()));_active=Se(!1);checkedState=W(()=>this.selected()?"checked":"unchecked");dir=this._select.dir;select(){if(!this._disabled()){if(this._select.multiple()){this._select.toggleSelect(this.value());return}this._select.selectOption(this.value())}}getLabel(){return this.elementRef.nativeElement.textContent?.trim()??""}setInactiveStyles(){this._active.set(!1)}activate(){this._disabled()||this._content.setActiveOption(this)}focus(){this.elementRef.nativeElement.focus(),this._active.set(!0)}static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["","brnOption",""]],hostAttrs:["role","option"],hostVars:7,hostBindings:function(n,s){n&1&&Q("click",function(){return s.select()})("mouseenter",function(){return s.activate()})("blur",function(){return s.setInactiveStyles()}),n&2&&(qn("id",s.id())("tabIndex",-1),St("aria-selected",s.selected())("aria-disabled",s._disabled())("dir",s._select.dir())("data-active",s._active()?"":void 0)("data-disabled",s._disabled()?"":void 0))},inputs:{id:[1,"id"],value:[1,"value"],_disabled:[1,"disabled","_disabled"]}})}return e})(),hg=100,KD=(()=>{class e{_el=z(yt);_selectContent=z($a);_endReached=new Co;_destroyRef=z(Ka);startEmittingEvents(){let i=mg(this._el.nativeElement,"mouseleave");Cg(100).pipe(fi(i),fi(this._endReached),nc(this._destroyRef)).subscribe(()=>this._selectContent.moveFocusUp())}stopEmittingEvents(){this._endReached.next(!0)}static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["","brnSelectScrollUp",""],["brn-select-scroll-up"],["hlm-select-scroll-up",5,"noHlm"]],hostAttrs:["aria-hidden","true"],hostBindings:function(n,s){n&1&&Q("mouseenter",function(){return s.startEmittingEvents()})}})}return e})(),YD=(()=>{class e{_el=z(yt);_selectContent=z($a);_endReached=new Co;_destroyRef=z(Ka);startEmittingEvents(){let i=mg(this._el.nativeElement,"mouseleave");Cg(100).pipe(fi(i),fi(this._endReached),nc(this._destroyRef)).subscribe(()=>this._selectContent.moveFocusDown())}stopEmittingEvents(){this._endReached.next(!0)}static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["","brnSelectScrollDown",""],["brn-select-scroll-down"],["hlm-select-scroll-down",5,"noHlm"]],hostAttrs:["aria-hidden","true"],hostBindings:function(n,s){n&1&&Q("mouseenter",function(){return s.startEmittingEvents()})}})}return e})(),$a=(()=>{class e{_elementRef=z(yt);_injector=z(wg);_select=pg();_canScrollUp=Se(!1);_canScrollDown=Se(!1);_viewport=Ja.required("viewport");_scrollUpBtn=$n(KD);_scrollDownBtn=$n(YD);_options=Sr(mo,{descendants:!0});keyManager=null;constructor(){qe(()=>{this._select.open()&&vr(()=>this.updateArrowDisplay(),{injector:this._injector})})}ngAfterContentInit(){this.keyManager=new $1(this._options,this._injector).withHomeAndEnd().withVerticalOrientation().withTypeAhead().withWrap().skipPredicate(i=>i.disabled),qe(()=>{let i=this._select.open(),n=this._options();if(!i||!n.length)return;let s=n.find(o=>o.selected());s?vr(()=>{this.keyManager?.setActiveItem(s)},{injector:this._injector}):vr(()=>{this.keyManager?.setFirstItemActive()},{injector:this._injector})},{injector:this._injector})}updateArrowDisplay(){let{scrollTop:i,scrollHeight:n,clientHeight:s}=this._viewport().nativeElement;this._canScrollUp.set(i>0);let o=n-s;this._canScrollDown.set(Math.ceil(i)<o)}handleScroll(){this.updateArrowDisplay()}focusList(){this._elementRef.nativeElement.focus()}moveFocusUp(){this._viewport().nativeElement.scrollBy({top:-hg,behavior:"smooth"}),this._viewport().nativeElement.scrollTop===0&&this._scrollUpBtn()?.stopEmittingEvents()}moveFocusDown(){this._viewport().nativeElement.scrollBy({top:hg,behavior:"smooth"});let i=this._elementRef.nativeElement.scrollHeight,n=this._viewport().nativeElement.scrollTop;i+n+hg>this._viewport().nativeElement.scrollHeight+hg/2&&this._scrollDownBtn()?.stopEmittingEvents()}setActiveOption(i){let n=this._options().findIndex(s=>s===i);n!==-1&&this.keyManager?.setActiveItem(n)}selectActiveItem(i){i.preventDefault();let n=this.keyManager?.activeItem;n&&this._select.toggleSelect(n.value())}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=be({type:e,selectors:[["brn-select-content"],["hlm-select-content",5,"noHlm"]],contentQueries:function(n,s,o){n&1&&(mi(o,s._scrollUpBtn,KD,5),mi(o,s._scrollDownBtn,YD,5),mi(o,s._options,mo,5)),n&2&&Ei(3)},viewQuery:function(n,s){n&1&&Xa(s._viewport,pZ,5),n&2&&Ei()},hostAttrs:["role","listbox","aria-orientation","vertical"],hostVars:6,hostBindings:function(n,s){n&1&&Q("keydown",function(r){return s.keyManager==null?null:s.keyManager.onKeydown(r)})("keydown.enter",function(r){return s.selectActiveItem(r)})("keydown.space",function(r){return s.selectActiveItem(r)}),n&2&&(qn("id",s._select.id()+"--content"),St("aria-multiselectable",s._select.multiple())("aria-disabled",s._select.disabled()||s._select.formDisabled())("aria-labelledBy",s._select.labelId())("aria-controlledBy",s._select.id()+"--trigger")("dir",s._select.dir()))},features:[Ie([TZ(e)])],ngContentSelectors:fZ,decls:9,vars:2,consts:[["scrollUp",""],["viewport",""],["scrollDown",""],[4,"ngTemplateOutlet"],["data-brn-select-viewport","",2,"flex","1 1 0%","position","relative","width","100%","overflow","auto","min-height","36px","padding-bottom","2px","margin-bottom","-2px",3,"scroll"]],template:function(n,s){if(n&1){let o=rt();_t(gZ),Xi(0,mZ,2,0,"ng-template",null,0,bo)(2,CZ,1,0,"ng-container",3),M(3,"div",4,1),Q("scroll",function(){return he(o),pe(s.handleScroll())}),Qe(5),R(),Xi(6,vZ,2,0,"ng-template",null,2,bo)(8,wZ,1,0,"ng-container",3)}if(n&2){let o=hn(1),r=hn(7);P(2),Ce("ngTemplateOutlet",s._canScrollUp()&&s._scrollUpBtn()?o:null),P(6),Ce("ngTemplateOutlet",s._canScrollDown()&&s._scrollDownBtn()?r:null)}},dependencies:[xo],styles:["[_nghost-%COMP%]{display:flex;box-sizing:border-box;flex-direction:column;outline:none;pointer-events:auto}[data-brn-select-viewport][_ngcontent-%COMP%]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch}[data-brn-select-viewport][_ngcontent-%COMP%]::-webkit-scrollbar{display:none}"],changeDetection:0})}return e})(),_Z=0,gg=(()=>{class e{_defaultErrorStateMatcher=z(K1);_parentForm=z(Xw,{optional:!0});_injector=z(wg);_parentFormGroup=z(Qw,{optional:!0});ngControl=z(Eg,{optional:!0,self:!0});id=H(`brn-select-${++_Z}`);multiple=H(!1,{transform:D});placeholder=H("");disabled=H(!1,{transform:D});dir=H("ltr");closeDelay=H(100,{transform:Er});open=Qa(!1);value=Qa();valueChange=de();compareWith=H((i,n)=>i===n);formDisabled=Se(!1);_selectLabel=$n(Mg,{descendants:!1});_selectContent=$n.required($a);options=Sr(mo,{descendants:!0});selectedOptions=W(()=>this.options().filter(i=>i.selected()));_overlayDir=Ja.required(el);trigger=Se(null);triggerWidth=Se(0);_delayedExpanded=xg(jw(this.open).pipe(_w(i=>i?Ft(i):Ft(i).pipe(Iw(this.closeDelay()))),nc()),{initialValue:!1});state=W(()=>this.open()?"open":"closed");_positionChanges$=new Co;side=xg(this._positionChanges$.pipe(Tw(i=>i.connectionPair.originY==="center"?i.connectionPair.originX==="start"?"left":"right":i.connectionPair.originY)),{initialValue:"bottom"});labelId=W(()=>this._selectLabel()?.id??`${this.id()}--label`);_onChange=()=>{};_onTouched=()=>{};_positions=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"}];errorStateTracker;errorState=W(()=>this.errorStateTracker.errorState());constructor(){this.ngControl!==null&&(this.ngControl.valueAccessor=this),this.errorStateTracker=new Y1(this._defaultErrorStateMatcher,this.ngControl,this._parentFormGroup,this._parentForm)}ngDoCheck(){this.errorStateTracker.updateErrorState()}toggle(){this.open()?this.hide():this.show()}show(){this.open()||this.disabled()||this.formDisabled()||this.options()?.length==0||this.open.set(!0)}hide(){this.open()&&(this.open.set(!1),this._onTouched(),this.trigger()?.focus())}writeValue(i){this.value.set(i)}registerOnChange(i){this._onChange=i}registerOnTouched(i){this._onTouched=i}setDisabledState(i){this.formDisabled.set(i)}selectOption(i){if(this.multiple()){let n=this.value(),s=n?[...n,i]:[i];this.value.set(s),this.valueChange.emit(s)}else this.value.set(i),this.valueChange.emit(i);this._onChange?.(this.value()),this.multiple()||this.hide()}deselectOption(i){if(this.multiple()){let s=this.value().filter(o=>!this.compareWith()(o,i));this.value.set(s),this.valueChange.emit(s)}else this.value.set(null),this.valueChange.emit(null);this._onChange?.(this.value())}toggleSelect(i){this.isSelected(i)?this.deselectOption(i):this.selectOption(i)}isSelected(i){let n=this.value();return Array.isArray(n)?n.some(s=>this.compareWith()(s,i)):i!==void 0?this.compareWith()(n,i):!1}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=be({type:e,selectors:[["brn-select"],["hlm-select"]],contentQueries:function(n,s,o){n&1&&(mi(o,s._selectLabel,Mg,4),mi(o,s._selectContent,$a,5),mi(o,s.options,mo,5)),n&2&&Ei(3)},viewQuery:function(n,s){n&1&&Xa(s._overlayDir,el,5),n&2&&Ei()},inputs:{id:[1,"id"],multiple:[1,"multiple"],placeholder:[1,"placeholder"],disabled:[1,"disabled"],dir:[1,"dir"],closeDelay:[1,"closeDelay"],open:[1,"open"],value:[1,"value"],compareWith:[1,"compareWith"]},outputs:{open:"openChange",value:"valueChange",valueChange:"valueChange"},features:[Ie([cc(()=>e),hc(()=>e),AZ(e),{provide:j1,useExisting:Wn(()=>e)}])],ngContentSelectors:yZ,decls:6,vars:5,consts:[["trigger","cdkOverlayOrigin"],[2,"display","none"],["cdk-overlay-origin","",3,"click"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"backdropClick","detach","positionChange","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayWidth"]],template:function(n,s){if(n&1){let o=rt();_t(bZ),ze(0,SZ,2,2,"label",1)(1,xZ,1,0),M(2,"div",2,0),Q("click",function(){return he(o),pe(s.toggle())}),Qe(4),R(),Xi(5,EZ,1,0,"ng-template",3),Q("backdropClick",function(){return he(o),pe(s.hide())})("detach",function(){return he(o),pe(s.hide())})("positionChange",function(a){return he(o),pe(s._positionChanges$.next(a))})}if(n&2){let o=hn(3);We(!s._selectLabel()&&s.placeholder()?0:1),P(5),Ce("cdkConnectedOverlayOrigin",o)("cdkConnectedOverlayOpen",s._delayedExpanded())("cdkConnectedOverlayPositions",s._positions)("cdkConnectedOverlayWidth",s.triggerWidth()>0?s.triggerWidth():"auto")}},dependencies:[L1,el,_1,jD],encapsulation:2,changeDetection:0})}return e})();var XD=(()=>{class e{templateRef=z(Qd);static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["","brnSelectPlaceholder",""],["","hlmSelectPlaceholder",""]]})}return e})(),ek=(()=>{class e{_elementRef=z(yt);_changeDetector=z(xr);_select=pg();_ngControl=z(Eg,{optional:!0});_platform=z(Jd);_triggerId=W(()=>`${this._select.id()}--trigger`);_contentId=W(()=>`${this._select.id()}--content`);_disabled=W(()=>this._select.disabled()||this._select.formDisabled());_labelledBy=W(()=>{let i=this._select.value();return Array.isArray(i)&&i.length>0?`${this._select.labelId()} ${this._select.id()}--value`:this._select.labelId()});_resizeObserver;_statusChangedSubscription;constructor(){this._select.trigger.set(this)}ngOnInit(){this._ngControl&&(this._statusChangedSubscription=this._ngControl.statusChanges?.subscribe(()=>{this._changeDetector.markForCheck()}))}ngAfterViewInit(){this._select.triggerWidth.set(this._elementRef.nativeElement.offsetWidth),tc(this._platform)&&(this._resizeObserver=new ResizeObserver(()=>this._select.triggerWidth.set(this._elementRef.nativeElement.offsetWidth)),this._resizeObserver.observe(this._elementRef.nativeElement))}ngOnDestroy(){this._resizeObserver?.disconnect(),this._statusChangedSubscription?.unsubscribe()}focus(){this._elementRef.nativeElement.focus()}static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["","brnSelectTrigger",""]],hostAttrs:["type","button","role","combobox","aria-autocomplete","none"],hostVars:18,hostBindings:function(n,s){n&1&&Q("keydown.ArrowDown",function(){return s._select.show()}),n&2&&(qn("disabled",s._disabled()),St("id",s._triggerId())("aria-expanded",s._select.open())("aria-controls",s._contentId())("aria-labelledBy",s._labelledBy())("dir",s._select.dir()),Vt("ng-invalid",(s._ngControl==null?null:s._ngControl.invalid)||null)("ng-dirty",(s._ngControl==null?null:s._ngControl.dirty)||null)("ng-valid",(s._ngControl==null?null:s._ngControl.valid)||null)("ng-touched",(s._ngControl==null?null:s._ngControl.touched)||null)("ng-untouched",(s._ngControl==null?null:s._ngControl.untouched)||null)("ng-pristine",(s._ngControl==null?null:s._ngControl.pristine)||null))}})}return e})(),JD=(()=>{class e{templateRef=z(Qd);static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["","brnSelectValue",""],["","hlmSelectValue",""]]})}return e})(),tk=(()=>{class e{_select=pg();id=W(()=>`${this._select.id()}--value`);placeholder=W(()=>this._select.placeholder());_showPlaceholder=W(()=>this._value()===null||this._value()===void 0||this._value()==="");_customValueTemplate=$n(JD,{descendants:!0});_customPlaceholderTemplate=$n(XD,{descendants:!0});_value=W(()=>{let i=this._values();if(i.length===0)return null;let s=i.filter(r=>this._select.options().some(a=>this._select.compareWith()(a.value(),r))).map(r=>this._select.options().find(a=>this._select.compareWith()(a.value(),r)));if(s.length===0)return null;let o=s.map(r=>r?.getLabel());return this._select.dir()==="rtl"&&o.reverse(),this.transformFn()(o)});_values=W(()=>Array.isArray(this._select.value())?this._select.value():[this._select.value()]);transformFn=H(i=>(i??[]).join(", "));static \u0275fac=function(n){return new(n||e)};static \u0275cmp=be({type:e,selectors:[["brn-select-value"],["hlm-select-value"]],contentQueries:function(n,s,o){n&1&&(mi(o,s._customValueTemplate,JD,5),mi(o,s._customPlaceholderTemplate,XD,5)),n&2&&Ei(2)},hostVars:2,hostBindings:function(n,s){n&2&&(qn("id",s.id()),St("data-placeholder",s._showPlaceholder()?"":null))},inputs:{transformFn:[1,"transformFn"]},decls:6,vars:1,consts:[["defaultValueTemplate",""],["defaultPlaceholderTemplate",""],[3,"ngTemplateOutlet"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(n,s){n&1&&(ze(0,MZ,1,1,"ng-container",2)(1,DZ,1,4,"ng-container",3),Xi(2,kZ,1,1,"ng-template",null,0,bo)(4,PZ,1,1,"ng-template",null,1,bo)),n&2&&We(s._showPlaceholder()?0:1)},dependencies:[xo],styles:["[_nghost-%COMP%]{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;white-space:nowrap;pointer-events:none}"],changeDetection:0})}return e})();var fg=(()=>{class e{userClass=H("",{alias:"class"});stickyLabels=H(!1,{transform:D});_stateProvider=uc({optional:!0});_sideProvider=dc({optional:!0});_computedClass=W(()=>te("border-border bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 w-full min-w-[8rem] overflow-hidden rounded-md border p-1 shadow-md data-[side=bottom]:top-[2px] data-[side=top]:bottom-[2px]",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["","hlmSelectContent",""],["hlm-select-content"]],hostVars:4,hostBindings:function(n,s){n&2&&(St("data-state",(s._stateProvider==null?null:s._stateProvider.state())??"open")("data-side",(s._sideProvider==null?null:s._sideProvider.side())??"bottom"),ye(s._computedClass()))},inputs:{userClass:[1,"class","userClass"],stickyLabels:[1,"stickyLabels"]}})}return e})();var LZ=["*"];function OZ(e,t){e&1&&ee(0,"ng-icon",1)}var Dw=(()=>{class e{_brnSelectOption=z(mo,{host:!0});userClass=H("",{alias:"class"});_computedClass=W(()=>te("data-[active]:bg-accent data-[active]:text-accent-foreground [&>ng-icon]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-none select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2 [&>ng-icon]:pointer-events-none [&>ng-icon]:size-4 [&>ng-icon]:shrink-0",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275cmp=be({type:e,selectors:[["hlm-option"]],hostVars:2,hostBindings:function(n,s){n&2&&ye(s._computedClass())},inputs:{userClass:[1,"class","userClass"]},features:[Ie([Lt({lucideCheck:o1})]),Un([{directive:mo,inputs:["disabled","disabled","value","value"]}])],ngContentSelectors:LZ,decls:3,vars:1,consts:[[1,"absolute","right-2","flex","size-3.5","items-center","justify-center"],["hlm","","size","sm","aria-hidden","true","name","lucideCheck"]],template:function(n,s){n&1&&(_t(),M(0,"span",0),ze(1,OZ,1,0,"ng-icon",1),R(),Qe(2)),n&2&&(P(),We(s._brnSelectOption.selected()?1:-1))},dependencies:[xt,it],encapsulation:2,changeDetection:0})}return e})();var NZ=["*",[["ng-icon"]]],BZ=["*","ng-icon"];function HZ(e,t){e&1&&Qe(0,1)}function VZ(e,t){e&1&&ee(0,"ng-icon",2)}var GZ=Rr("border-input [&>ng-icon]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 [&>ng-icon]:pointer-events-none [&>ng-icon]:size-4 [&>ng-icon]:shrink-0",{variants:{error:{auto:"[&.ng-invalid.ng-touched]:text-destructive [&.ng-invalid.ng-touched]:border-destructive [&.ng-invalid.ng-touched]:focus-visible:ring-destructive/20 dark:[&.ng-invalid.ng-touched]:focus-visible:ring-destructive/40",true:"text-destructive border-destructive focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40"}},defaultVariants:{error:"auto"}}),kw=(()=>{class e{_icon=$n(it);_brnSelect=z(gg,{optional:!0});userClass=H("",{alias:"class"});size=H("default");_computedClass=W(()=>te(GZ({error:this._brnSelect?.errorState()}),this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275cmp=be({type:e,selectors:[["hlm-select-trigger"]],contentQueries:function(n,s,o){n&1&&mi(o,s._icon,it,5),n&2&&Ei()},inputs:{userClass:[1,"class","userClass"],size:[1,"size"]},features:[Ie([Lt({lucideChevronDown:r1})])],ngContentSelectors:BZ,decls:5,vars:4,consts:[["button",""],["hlmInput","","brnSelectTrigger","","type","button"],["hlm","","size","sm","name","lucideChevronDown",1,"ml-2","flex-none"]],template:function(n,s){n&1&&(_t(NZ),M(0,"button",1,0),Qe(2),ze(3,HZ,1,0)(4,VZ,1,0,"ng-icon",2),R()),n&2&&(ye(s._computedClass()),St("data-size",s.size()),P(3),We(s._icon()?3:4))},dependencies:[ek,xt,it],encapsulation:2,changeDetection:0})}return e})();var Pw=(()=>{class e{userClass=H("",{alias:"class"});_computedClass=W(()=>te("data-[placeholder]:text-muted-foreground line-clamp-1 flex items-center gap-2 truncate",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=ce({type:e,selectors:[["hlm-select-value"],["","hlmSelectValue",""],["brn-select-value","hlm",""]],hostVars:2,hostBindings:function(n,s){n&2&&ye(s._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var Yd=class{supabaseGlobal=z(pc);supabase=this.supabaseGlobal.supabase;loadingCount=Se(0);loading=W(()=>this.loadingCount()>0);materialLayers=So({loader:async()=>{let{data:t,error:i}=await this.supabase.from("material_layers").select("*").order("created_at",{ascending:!1});if(i)throw i;return t||[]}});wallStructures=So({loader:async()=>{let{data:t,error:i}=await this.supabase.from("wall_structures").select("*").order("created_at",{ascending:!1});if(i)throw i;return t||[]}});selectedStructureIdSignal=Se(null);structureLayers=So({params:()=>({structureId:this.selectedStructureIdSignal()}),loader:async({params:t})=>{if(!t.structureId)return[];let{data:i,error:n}=await this.supabase.from("wall_structure_layers").select(`
          *,
          material:material_layers(*)
        `).eq("wall_structure_id",t.structureId).order("position",{ascending:!0});if(n)throw n;return i||[]}});selectedStructureId=W(()=>this.selectedStructureIdSignal());selectStructure(t){this.selectedStructureIdSignal.set(t)}createMaterialLayer(t){this.loadingCount.update(i=>i+1),Kt(this.supabase.from("material_layers").insert({name:t.name,thickness:t.thickness,description:t.description||null}).select().single()).pipe(Yt(i=>(console.error("Error creating material layer:",i),Ft({error:i}))),Xt(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.materialLayers.reload()})}updateMaterialLayer(t,i){this.loadingCount.update(n=>n+1),Kt(this.supabase.from("material_layers").update(i).eq("id",t).select().single()).pipe(Yt(n=>(console.error("Error updating material layer:",n),Ft({error:n}))),Xt(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error)throw n.error;this.materialLayers.reload()})}deleteMaterialLayer(t){this.loadingCount.update(i=>i+1),Kt(this.supabase.from("material_layers").delete().eq("id",t)).pipe(Yt(i=>(console.error("Error deleting material layer:",i),Ft({error:i}))),Xt(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.materialLayers.reload()})}deleteMaterialLayers(t){this.loadingCount.update(i=>i+1),Kt(this.supabase.from("material_layers").delete().in("id",t)).pipe(Yt(i=>(console.error("Error deleting material layers:",i),Ft({error:i}))),Xt(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.materialLayers.reload()})}createWallStructure(t){this.loadingCount.update(i=>i+1),Kt(this.supabase.from("wall_structures").insert({name:t.name}).select().single()).pipe(Yt(i=>(console.error("Error creating wall structure:",i),Ft({error:i}))),Xt(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.wallStructures.reload()})}updateWallStructure(t,i){this.loadingCount.update(n=>n+1),Kt(this.supabase.from("wall_structures").update(i).eq("id",t).select().single()).pipe(Yt(n=>(console.error("Error updating wall structure:",n),Ft({error:n}))),Xt(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error)throw n.error;this.wallStructures.reload()})}deleteWallStructure(t){this.loadingCount.update(i=>i+1),Kt(this.supabase.from("wall_structures").delete().eq("id",t)).pipe(Yt(i=>(console.error("Error deleting wall structure:",i),Ft({error:i}))),Xt(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.wallStructures.reload(),this.selectedStructureIdSignal()===t&&this.selectedStructureIdSignal.set(null)})}addLayerToStructure(t){this.loadingCount.update(i=>i+1),Kt(this.supabase.from("wall_structure_layers").insert(t).select().single()).pipe(Yt(i=>(console.error("Error adding layer to structure:",i),Ft({error:i}))),Xt(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.structureLayers.reload()})}updateStructureLayerPosition(t,i){this.loadingCount.update(n=>n+1),Kt(this.supabase.from("wall_structure_layers").update({position:i}).eq("id",t).select().single()).pipe(Yt(n=>(console.error("Error updating layer position:",n),Ft({error:n}))),Xt(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error)throw n.error;this.structureLayers.reload()})}removeLayerFromStructure(t){this.loadingCount.update(i=>i+1),Kt(this.supabase.from("wall_structure_layers").delete().eq("id",t)).pipe(Yt(i=>(console.error("Error removing layer from structure:",i),Ft({error:i}))),Xt(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.structureLayers.reload()})}removeLayersFromStructure(t){this.loadingCount.update(i=>i+1),Kt(this.supabase.from("wall_structure_layers").delete().in("id",t)).pipe(Yt(i=>(console.error("Error removing layers from structure:",i),Ft({error:i}))),Xt(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.structureLayers.reload()})}};var WZ=(e,t)=>t.id;function UZ(e,t){e&1&&(M(0,"div",11),ee(1,"hlm-spinner",14),R())}function qZ(e,t){if(e&1){let i=rt();M(0,"div",12)(1,"ag-grid-angular",15),Q("gridReady",function(s){he(i);let o=Z();return pe(o.onMaterialsGridReady(s))})("cellValueChanged",function(s){he(i);let o=Z();return pe(o.onMaterialCellValueChanged(s))}),R()()}if(e&2){let i=Z();P(),Ce("rowData",i.materialLayers())("columnDefs",i.materialColumnDefs)("defaultColDef",i.defaultColDef)("rowSelection",i.materialRowSelection)("theme",i.theme)}}function $Z(e,t){e&1&&(M(0,"div",11),ee(1,"hlm-spinner",14),R())}function jZ(e,t){if(e&1){let i=rt();M(0,"div",12)(1,"ag-grid-angular",16),Q("gridReady",function(s){he(i);let o=Z();return pe(o.onStructuresGridReady(s))})("selectionChanged",function(s){he(i);let o=Z();return pe(o.onStructureSelectionChanged(s))})("cellValueChanged",function(s){he(i);let o=Z();return pe(o.onStructureCellValueChanged(s))}),R()()}if(e&2){let i=Z();P(),Ce("rowData",i.wallStructures())("columnDefs",i.structureColumnDefs)("defaultColDef",i.defaultColDef)("rowSelection",i.rowSelection)("theme",i.theme)}}function KZ(e,t){if(e&1&&(M(0,"hlm-option",22),_(1),R()),e&2){let i=t.$implicit;Ce("value",i.id),P(),Qi(" ",i.name," (",i.thickness," mm) ")}}function YZ(e,t){e&1&&(M(0,"div",11),ee(1,"hlm-spinner",14),R())}function XZ(e,t){if(e&1){let i=rt();M(0,"div",24)(1,"ag-grid-angular",26),Q("gridReady",function(s){he(i);let o=Z(2);return pe(o.onStructureLayersGridReady(s))}),R()()}if(e&2){let i=Z(2);P(),Ce("rowData",i.structureLayers())("columnDefs",i.structureLayerColumnDefs)("defaultColDef",i.defaultColDef)("rowSelection",i.layerRowSelection)("theme",i.theme)}}function JZ(e,t){if(e&1){let i=rt();M(0,"div",1)(1,"div",2)(2,"h2",3),_(3),R(),M(4,"p",4),_(5," F\xFCgen Sie Materialien aus Ihrer Bibliothek hinzu und ordnen Sie diese. Gesamtdicke: "),M(6,"strong"),_(7),R()()(),M(8,"div",5)(9,"div",17)(10,"div",18)(11,"label",19),_(12,"Material hinzuf\xFCgen"),R(),M(13,"brn-select",20),Q("valueChange",function(s){he(i);let o=Z();return pe(o.onMaterialSelected(s))}),M(14,"hlm-select-trigger",21),ee(15,"hlm-select-value"),R(),M(16,"hlm-select-content"),cn(17,KZ,2,3,"hlm-option",22,WZ),R()()(),M(19,"button",23),Q("click",function(){he(i);let s=Z();return pe(s.addMaterialToStructure())}),ee(20,"ng-icon",8),_(21," Hinzuf\xFCgen "),R()(),M(22,"div",6)(23,"button",9),Q("click",function(){he(i);let s=Z();return pe(s.deleteSelectedStructureLayers())}),ee(24,"ng-icon",10),_(25," Ausgew\xE4hlte entfernen "),R()(),ze(26,YZ,2,0,"div",11)(27,XZ,2,5,"div",24),R(),M(28,"div",25)(29,"p"),_(30,"Tipp: W\xE4hlen Sie ein Material aus der Bibliothek und f\xFCgen Sie es zur Liste hinzu. Position 1 = au\xDFen."),R()()()}if(e&2){let i=Z();P(3),xe(" Schichten: ",i.selectedStructure().name," "),P(4),xe("",i.totalThickness()," mm"),P(6),Ce("value",i.selectedMaterialId()),P(4),un(i.materialLayers()),P(2),Ce("disabled",!i.selectedMaterialId()),P(7),We(i.layersLoading()?26:27)}}function QZ(e,t){e&1&&(M(0,"div",1)(1,"div",27)(2,"p"),_(3,"W\xE4hlen Sie einen Wandaufbau aus, um Materialien hinzuzuf\xFCgen."),R()()())}Z6.registerModules([GD]);var nk=(()=>{class e{theme=qM;service=z(Yd);materialsGridApi=Se(null);structuresGridApi=Se(null);structureLayersGridApi=Se(null);materialLayers=W(()=>this.service.materialLayers.value()||[]);wallStructures=W(()=>this.service.wallStructures.value()||[]);structureLayers=W(()=>this.service.structureLayers.value()||[]);loading=this.service.loading;selectedStructureId=this.service.selectedStructureId;materialsLoading=W(()=>this.service.materialLayers.isLoading());structuresLoading=W(()=>this.service.wallStructures.isLoading());layersLoading=W(()=>this.service.structureLayers.isLoading());selectedMaterialId=Se(null);selectedStructure=W(()=>{let i=this.selectedStructureId();return i&&this.wallStructures().find(n=>n.id===i)||null});totalThickness=W(()=>this.structureLayers().reduce((i,n)=>{let s=n.material?.thickness||0;return i+s},0));materialColumnDefs=[{field:"name",headerName:"Materialname",flex:1,editable:!0},{field:"thickness",headerName:"Dicke (mm)",width:150,editable:!0,valueFormatter:i=>i.value?`${i.value} mm`:"0 mm"},{field:"description",headerName:"Beschreibung",flex:2,editable:!0}];structureColumnDefs=[{field:"name",headerName:"Wandaufbau Name",flex:1,editable:!0},{field:"created_at",headerName:"Erstellt am",width:180,valueFormatter:i=>i.value?new Date(i.value).toLocaleDateString("de-DE"):""}];structureLayerColumnDefs=[{field:"position",headerName:"Position",width:100,sort:"asc"},{headerName:"Materialname",valueGetter:i=>i.data?.material?.name||"",flex:1},{headerName:"Dicke (mm)",valueGetter:i=>i.data?.material?.thickness||0,width:150,valueFormatter:i=>i.value?`${i.value} mm`:"0 mm"},{headerName:"Beschreibung",valueGetter:i=>i.data?.material?.description||"",flex:2}];defaultColDef={sortable:!0,filter:!0,resizable:!0};rowSelection="single";materialRowSelection="multiple";layerRowSelection="multiple";onMaterialsGridReady(i){this.materialsGridApi.set(i.api)}onStructuresGridReady(i){this.structuresGridApi.set(i.api)}onStructureLayersGridReady(i){this.structureLayersGridApi.set(i.api)}onStructureSelectionChanged(i){let n=i.api.getSelectedRows();n.length>0?this.service.selectStructure(n[0].id):this.service.selectStructure(null)}onMaterialCellValueChanged(i){i.data&&i.oldValue!==i.newValue&&this.service.updateMaterialLayer(i.data.id,{name:i.data.name,thickness:i.data.thickness,description:i.data.description||void 0})}onStructureCellValueChanged(i){i.data&&i.oldValue!==i.newValue&&this.service.updateWallStructure(i.data.id,{name:i.data.name})}addMaterial(){let i=`Material ${this.materialLayers().length+1}`;this.service.createMaterialLayer({name:i,thickness:0,description:""})}deleteSelectedMaterials(){let i=this.materialsGridApi();if(!i)return;let n=i.getSelectedRows();if(n.length>0){let s=n.map(o=>o.id);this.service.deleteMaterialLayers(s)}}addWallStructure(){let i=`Wandaufbau ${this.wallStructures().length+1}`;this.service.createWallStructure({name:i})}deleteSelectedStructure(){let i=this.structuresGridApi();if(!i)return;let n=i.getSelectedRows();n.length>0&&this.service.deleteWallStructure(n[0].id)}onMaterialSelected(i){typeof i=="string"?this.selectedMaterialId.set(i):this.selectedMaterialId.set(null)}addMaterialToStructure(){let i=this.selectedStructureId(),n=this.selectedMaterialId();if(!i||!n)return;let s=this.structureLayers(),o=s.length>0?Math.max(...s.map(r=>r.position)):0;this.service.addLayerToStructure({wall_structure_id:i,material_layer_id:n,position:o+1}),this.selectedMaterialId.set(null)}deleteSelectedStructureLayers(){let i=this.structureLayersGridApi();if(!i)return;let n=i.getSelectedRows();if(n.length>0){let s=n.map(o=>o.id);this.service.removeLayersFromStructure(s)}}moveLayerUp(i){i.position<=1||this.service.updateStructureLayerPosition(i.id,i.position-1)}moveLayerDown(i){let n=Math.max(...this.structureLayers().map(s=>s.position));i.position>=n||this.service.updateStructureLayerPosition(i.id,i.position+1)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=be({type:e,selectors:[["gh-wall-structures"]],features:[Ie([Yd,Lt({lucidePlus:lc,lucideTrash:Mr,lucideArrowUp:n1,lucideArrowDown:e1})])],decls:35,vars:4,consts:[[1,"p-4","md:p-6","space-y-6"],["hlmCard",""],["hlmCardHeader",""],["hlmCardTitle","",1,"text-2xl","font-bold"],["hlmCardDescription",""],["hlmCardContent",""],[1,"mb-4","flex","flex-wrap","gap-2"],["hlmBtn","","variant","default",3,"click"],["hlm","","name","lucidePlus","size","sm",1,"mr-2"],["hlmBtn","","variant","destructive",3,"click"],["hlm","","name","lucideTrash","size","sm",1,"mr-2"],[1,"flex","justify-center","p-8"],[1,"h-[300px]","w-full"],["hlmBtn","","variant","destructive",3,"click","disabled"],["size","large"],[1,"w-full","h-full",3,"gridReady","cellValueChanged","rowData","columnDefs","defaultColDef","rowSelection","theme"],[1,"w-full","h-full",3,"gridReady","selectionChanged","cellValueChanged","rowData","columnDefs","defaultColDef","rowSelection","theme"],[1,"mb-4","flex","flex-wrap","gap-2","items-end"],[1,"flex-1","min-w-[200px]"],["hlmLabel","",1,"mb-2"],["placeholder","Material ausw\xE4hlen...",1,"w-full",3,"valueChange","value"],[1,"w-full"],[3,"value"],["hlmBtn","","variant","default",3,"click","disabled"],[1,"h-[400px]","w-full"],["hlmCardFooter","",1,"text-sm","text-muted-foreground"],[1,"w-full","h-full",3,"gridReady","rowData","columnDefs","defaultColDef","rowSelection","theme"],["hlmCardContent","",1,"p-8","text-center","text-muted-foreground"]],template:function(n,s){n&1&&(M(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),_(4," Material-Bibliothek "),R(),M(5,"p",4),_(6,"Erstellen Sie wiederverwendbare Materialien (z.B. Holz, Ziegel, D\xE4mmung) mit Name und Dicke."),R()(),M(7,"div",5)(8,"div",6)(9,"button",7),Q("click",function(){return s.addMaterial()}),ee(10,"ng-icon",8),_(11," Neues Material "),R(),M(12,"button",9),Q("click",function(){return s.deleteSelectedMaterials()}),ee(13,"ng-icon",10),_(14," Ausgew\xE4hlte l\xF6schen "),R()(),ze(15,UZ,2,0,"div",11)(16,qZ,2,5,"div",12),R()(),M(17,"div",1)(18,"div",2)(19,"h2",3),_(20," Wandaufbauten "),R(),M(21,"p",4),_(22,"Erstellen Sie Wandaufbauten und f\xFCgen Sie Materialien aus Ihrer Bibliothek hinzu."),R()(),M(23,"div",5)(24,"div",6)(25,"button",7),Q("click",function(){return s.addWallStructure()}),ee(26,"ng-icon",8),_(27," Neuer Wandaufbau "),R(),M(28,"button",13),Q("click",function(){return s.deleteSelectedStructure()}),ee(29,"ng-icon",10),_(30," Wandaufbau l\xF6schen "),R()(),ze(31,$Z,2,0,"div",11)(32,jZ,2,5,"div",12),R()(),ze(33,JZ,31,5,"div",1)(34,QZ,4,0,"div",1),R()),n&2&&(P(15),We(s.materialsLoading()?15:16),P(13),Ce("disabled",!s.selectedStructureId()),P(3),We(s.structuresLoading()?31:32),P(2),We(s.selectedStructure()?33:34))},dependencies:[gn,ug,Pr,Ar,nb,Ir,Tr,Fr,Jt,Dr,fg,kw,Dw,Pw,gg,$a,tk,kr,fn,it,xt],encapsulation:2,changeDetection:0})}return e})();var cwe=[{path:"",component:Cb,children:[{path:"dashboard",component:k3},{path:"wall-structures",component:nk},{path:"house-plans",component:$D},{path:"house-plan/:id",component:rR},{path:"",redirectTo:"dashboard",pathMatch:"full"}]}];export{sb as FileUploadComponent,Cb as HomeShellComponent,rR as HousePlanEditorComponent,M3 as TiptapEditorComponent,nk as WallStructuresComponent,cwe as homeDocumentationRoutes};
