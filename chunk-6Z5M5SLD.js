import{a as Pw,b as Mw,d as kw,e as Dw}from"./chunk-YTIG7DF5.js";import{A as Qw,E as Zw,F as e1,G as t1,H as dr,I as i1,K as n1,L as Gt,M as o1,N as s1,O as r1,Q as a1,R as l1,S as d1,T as c1,U as u1,V as h1,W as Da,X as p1,Y as g1,Z as f1,a as ai,b as Ht,c as Iw,d as Lw,e as _w,fa as Fa,ga as Vd,h as Ow,ha as zd,i as Nw,j as Bw,ja as m1,k as Hw,ka as wo,l as Gw,la as bo,m as Vw,ma as cr,n as zw,na as C1,oa as ur,p as Ww,pa as hr,q as Uw,r as qw,t as $w,u as jw,v as Kw,w as Gd,x as Yw,y as Xw,z as Jw}from"./chunk-AO6ZUN4W.js";import{B as Kp,a as ww,d as bw,e as yw,h as Sw,k as xw,l as Ew,n as Rw}from"./chunk-OAW7YPBW.js";import{a as Fw,b as Od,d as Nd,g as Bd,i as Tw,k as Aw,m as Hd}from"./chunk-45OYFO4Z.js";import{$a as qp,A as Pd,Ab as ls,Ac as vw,Bb as ae,Ca as Dn,Cb as Ye,Da as Dt,Db as aw,Ea as Ft,Eb as $p,Fa as kd,G as kn,Gb as re,Ha as mo,Hb as Y,Ia as Co,Ib as lw,J as ns,Ja as De,Jb as jp,K as Ra,Ka as M,Kb as dw,La as k,Lb as ka,M as ss,Ma as oe,Mb as Td,N as Jv,Na as zp,O as ie,Oa as Wp,Ob as P,Pa as iw,Pb as Ad,Qa as sr,R as Te,Ra as Qt,S as Ae,Sa as Up,Ta as se,Ua as ce,Va as Gi,Vb as Id,W as Md,Wa as Vi,Wb as Qi,X as Qv,Xb as cw,Z as Be,ab as nw,ba as Zv,bb as Ma,ca as fo,cb as Dd,cc as uw,d as Vp,da as si,db as Ji,dc as hw,eb as ri,ec as Ld,fb as Fe,fc as pw,ga as ew,gb as H,gc as gw,h as xd,hb as Pe,i as Ed,ib as me,jb as Fn,jc as fw,ka as F,kb as rr,lb as ar,mb as lr,na as tr,oa as Pa,pa as ir,pc as vo,qc as Zi,ra as Ee,rb as ze,sb as Fd,sc as ue,ta as Re,tc as _d,ua as rs,ub as ow,uc as mw,v as Rd,va as nr,vb as sw,vc as Bt,wa as or,wb as $,x as Xv,xa as A,xb as j,xc as Cw,ya as as,yb as rw,za as tw}from"./chunk-3PG4Z6X5.js";import{a as b,b as _,d as oi,e as Z,f as er}from"./chunk-M4OEJGNZ.js";var we=Z(Pt=>{"use strict";Object.defineProperty(Pt,"__esModule",{value:!0});Pt._registerNode=Pt.Konva=Pt.glob=void 0;var P8=Math.PI/180;function M8(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}Pt.glob=typeof global<"u"?global:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{};Pt.Konva={_global:Pt.glob,version:"9.3.22",isBrowser:M8(),isUnminified:/param/.test((function(e){}).toString()),dblClickWindow:400,getAngle(e){return Pt.Konva.angleDeg?e*P8:e},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return Pt.Konva.DD.isDragging},isTransforming(){var e;return(e=Pt.Konva.Transformer)===null||e===void 0?void 0:e.isTransforming()},isDragReady(){return!!Pt.Konva.DD.node},releaseCanvasOnDestroy:!0,document:Pt.glob.document,_injectGlobal(e){Pt.glob.Konva=e}};var k8=e=>{Pt.Konva[e.prototype.getClassName()]=e};Pt._registerNode=k8;Pt.Konva._injectGlobal(Pt.Konva)});var it=Z(je=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});je.Util=je.Transform=void 0;var Im=we(),Om=class e{constructor(t=[1,0,0,1,0,0]){this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new e(this.m)}copyInto(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]}point(t){let i=this.m;return{x:i[0]*t.x+i[2]*t.y+i[4],y:i[1]*t.x+i[3]*t.y+i[5]}}translate(t,i){return this.m[4]+=this.m[0]*t+this.m[2]*i,this.m[5]+=this.m[1]*t+this.m[3]*i,this}scale(t,i){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=i,this.m[3]*=i,this}rotate(t){let i=Math.cos(t),n=Math.sin(t),o=this.m[0]*i+this.m[2]*n,s=this.m[1]*i+this.m[3]*n,r=this.m[0]*-n+this.m[2]*i,a=this.m[1]*-n+this.m[3]*i;return this.m[0]=o,this.m[1]=s,this.m[2]=r,this.m[3]=a,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(t,i){let n=this.m[0]+this.m[2]*i,o=this.m[1]+this.m[3]*i,s=this.m[2]+this.m[0]*t,r=this.m[3]+this.m[1]*t;return this.m[0]=n,this.m[1]=o,this.m[2]=s,this.m[3]=r,this}multiply(t){let i=this.m[0]*t.m[0]+this.m[2]*t.m[1],n=this.m[1]*t.m[0]+this.m[3]*t.m[1],o=this.m[0]*t.m[2]+this.m[2]*t.m[3],s=this.m[1]*t.m[2]+this.m[3]*t.m[3],r=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],a=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=i,this.m[1]=n,this.m[2]=o,this.m[3]=s,this.m[4]=r,this.m[5]=a,this}invert(){let t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),i=this.m[3]*t,n=-this.m[1]*t,o=-this.m[2]*t,s=this.m[0]*t,r=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),a=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=i,this.m[1]=n,this.m[2]=o,this.m[3]=s,this.m[4]=r,this.m[5]=a,this}getMatrix(){return this.m}decompose(){let t=this.m[0],i=this.m[1],n=this.m[2],o=this.m[3],s=this.m[4],r=this.m[5],a=t*o-i*n,l={x:s,y:r,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(t!=0||i!=0){let d=Math.sqrt(t*t+i*i);l.rotation=i>0?Math.acos(t/d):-Math.acos(t/d),l.scaleX=d,l.scaleY=a/d,l.skewX=(t*n+i*o)/a,l.skewY=0}else if(n!=0||o!=0){let d=Math.sqrt(n*n+o*o);l.rotation=Math.PI/2-(o>0?Math.acos(-n/d):-Math.acos(n/d)),l.scaleX=a/d,l.scaleY=d,l.skewX=0,l.skewY=(t*n+i*o)/a}return l.rotation=je.Util._getRotation(l.rotation),l}};je.Transform=Om;var D8="[object Array]",F8="[object Number]",T8="[object String]",A8="[object Boolean]",I8=Math.PI/180,L8=180/Math.PI,Lm="#",_8="",O8="0",N8="Konva warning: ",z2="Konva error: ",B8="rgb(",_m={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},H8=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,wu=[],G8=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(e){setTimeout(e,60)};je.Util={_isElement(e){return!!(e&&e.nodeType==1)},_isFunction(e){return!!(e&&e.constructor&&e.call&&e.apply)},_isPlainObject(e){return!!e&&e.constructor===Object},_isArray(e){return Object.prototype.toString.call(e)===D8},_isNumber(e){return Object.prototype.toString.call(e)===F8&&!isNaN(e)&&isFinite(e)},_isString(e){return Object.prototype.toString.call(e)===T8},_isBoolean(e){return Object.prototype.toString.call(e)===A8},isObject(e){return e instanceof Object},isValidSelector(e){if(typeof e!="string")return!1;let t=e[0];return t==="#"||t==="."||t===t.toUpperCase()},_sign(e){return e===0||e>0?1:-1},requestAnimFrame(e){wu.push(e),wu.length===1&&G8(function(){let t=wu;wu=[],t.forEach(function(i){i()})})},createCanvasElement(){let e=document.createElement("canvas");try{e.style=e.style||{}}catch{}return e},createImageElement(){return document.createElement("img")},_isInDocument(e){for(;e=e.parentNode;)if(e==document)return!0;return!1},_urlToImage(e,t){let i=je.Util.createImageElement();i.onload=function(){t(i)},i.src=e},_rgbToHex(e,t,i){return((1<<24)+(e<<16)+(t<<8)+i).toString(16).slice(1)},_hexToRgb(e){e=e.replace(Lm,_8);let t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:t&255}},getRandomColor(){let e=(Math.random()*16777215<<0).toString(16);for(;e.length<6;)e=O8+e;return Lm+e},getRGB(e){let t;return e in _m?(t=_m[e],{r:t[0],g:t[1],b:t[2]}):e[0]===Lm?this._hexToRgb(e.substring(1)):e.substr(0,4)===B8?(t=H8.exec(e.replace(/ /g,"")),{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}):{r:0,g:0,b:0}},colorToRGBA(e){return e=e||"black",je.Util._namedColorToRBA(e)||je.Util._hex3ColorToRGBA(e)||je.Util._hex4ColorToRGBA(e)||je.Util._hex6ColorToRGBA(e)||je.Util._hex8ColorToRGBA(e)||je.Util._rgbColorToRGBA(e)||je.Util._rgbaColorToRGBA(e)||je.Util._hslColorToRGBA(e)},_namedColorToRBA(e){let t=_m[e.toLowerCase()];return t?{r:t[0],g:t[1],b:t[2],a:1}:null},_rgbColorToRGBA(e){if(e.indexOf("rgb(")===0){e=e.match(/rgb\(([^)]+)\)/)[1];let t=e.split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:1}}},_rgbaColorToRGBA(e){if(e.indexOf("rgba(")===0){e=e.match(/rgba\(([^)]+)\)/)[1];let t=e.split(/ *, */).map((i,n)=>i.slice(-1)==="%"?n===3?parseInt(i)/100:parseInt(i)/100*255:Number(i));return{r:t[0],g:t[1],b:t[2],a:t[3]}}},_hex8ColorToRGBA(e){if(e[0]==="#"&&e.length===9)return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:parseInt(e.slice(7,9),16)/255}},_hex6ColorToRGBA(e){if(e[0]==="#"&&e.length===7)return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:1}},_hex4ColorToRGBA(e){if(e[0]==="#"&&e.length===5)return{r:parseInt(e[1]+e[1],16),g:parseInt(e[2]+e[2],16),b:parseInt(e[3]+e[3],16),a:parseInt(e[4]+e[4],16)/255}},_hex3ColorToRGBA(e){if(e[0]==="#"&&e.length===4)return{r:parseInt(e[1]+e[1],16),g:parseInt(e[2]+e[2],16),b:parseInt(e[3]+e[3],16),a:1}},_hslColorToRGBA(e){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(e)){let[t,...i]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e),n=Number(i[0])/360,o=Number(i[1])/100,s=Number(i[2])/100,r,a,l;if(o===0)return l=s*255,{r:Math.round(l),g:Math.round(l),b:Math.round(l),a:1};s<.5?r=s*(1+o):r=s+o-s*o;let d=2*s-r,c=[0,0,0];for(let u=0;u<3;u++)a=n+1/3*-(u-1),a<0&&a++,a>1&&a--,6*a<1?l=d+(r-d)*6*a:2*a<1?l=r:3*a<2?l=d+(r-d)*(2/3-a)*6:l=d,c[u]=l*255;return{r:Math.round(c[0]),g:Math.round(c[1]),b:Math.round(c[2]),a:1}}},haveIntersection(e,t){return!(t.x>e.x+e.width||t.x+t.width<e.x||t.y>e.y+e.height||t.y+t.height<e.y)},cloneObject(e){let t={};for(let i in e)this._isPlainObject(e[i])?t[i]=this.cloneObject(e[i]):this._isArray(e[i])?t[i]=this.cloneArray(e[i]):t[i]=e[i];return t},cloneArray(e){return e.slice(0)},degToRad(e){return e*I8},radToDeg(e){return e*L8},_degToRad(e){return je.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),je.Util.degToRad(e)},_radToDeg(e){return je.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),je.Util.radToDeg(e)},_getRotation(e){return Im.Konva.angleDeg?je.Util.radToDeg(e):e},_capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)},throw(e){throw new Error(z2+e)},error(e){console.error(z2+e)},warn(e){Im.Konva.showWarnings&&console.warn(N8+e)},each(e,t){for(let i in e)t(i,e[i])},_inRange(e,t,i){return t<=e&&e<i},_getProjectionToSegment(e,t,i,n,o,s){let r,a,l,d=(e-i)*(e-i)+(t-n)*(t-n);if(d==0)r=e,a=t,l=(o-i)*(o-i)+(s-n)*(s-n);else{let c=((o-e)*(i-e)+(s-t)*(n-t))/d;c<0?(r=e,a=t,l=(e-o)*(e-o)+(t-s)*(t-s)):c>1?(r=i,a=n,l=(i-o)*(i-o)+(n-s)*(n-s)):(r=e+c*(i-e),a=t+c*(n-t),l=(r-o)*(r-o)+(a-s)*(a-s))}return[r,a,l]},_getProjectionToLine(e,t,i){let n=je.Util.cloneObject(e),o=Number.MAX_VALUE;return t.forEach(function(s,r){if(!i&&r===t.length-1)return;let a=t[(r+1)%t.length],l=je.Util._getProjectionToSegment(s.x,s.y,a.x,a.y,e.x,e.y),d=l[0],c=l[1],u=l[2];u<o&&(n.x=d,n.y=c,o=u)}),n},_prepareArrayForTween(e,t,i){let n=[],o=[];if(e.length>t.length){let r=t;t=e,e=r}for(let r=0;r<e.length;r+=2)n.push({x:e[r],y:e[r+1]});for(let r=0;r<t.length;r+=2)o.push({x:t[r],y:t[r+1]});let s=[];return o.forEach(function(r){let a=je.Util._getProjectionToLine(r,n,i);s.push(a.x),s.push(a.y)}),s},_prepareToStringify(e){let t;e.visitedByCircularReferenceRemoval=!0;for(let i in e)if(e.hasOwnProperty(i)&&e[i]&&typeof e[i]=="object"){if(t=Object.getOwnPropertyDescriptor(e,i),e[i].visitedByCircularReferenceRemoval||je.Util._isElement(e[i]))if(t.configurable)delete e[i];else return null;else if(je.Util._prepareToStringify(e[i])===null)if(t.configurable)delete e[i];else return null}return delete e.visitedByCircularReferenceRemoval,e},_assign(e,t){for(let i in t)e[i]=t[i];return e},_getFirstPointerId(e){return e.touches?e.changedTouches[0].identifier:e.pointerId||999},releaseCanvas(...e){Im.Konva.releaseCanvasOnDestroy&&e.forEach(t=>{t.width=0,t.height=0})},drawRoundedRectPath(e,t,i,n){let o=0,s=0,r=0,a=0;typeof n=="number"?o=s=r=a=Math.min(n,t/2,i/2):(o=Math.min(n[0]||0,t/2,i/2),s=Math.min(n[1]||0,t/2,i/2),a=Math.min(n[2]||0,t/2,i/2),r=Math.min(n[3]||0,t/2,i/2)),e.moveTo(o,0),e.lineTo(t-s,0),e.arc(t-s,s,s,Math.PI*3/2,0,!1),e.lineTo(t,i-a),e.arc(t-a,i-a,a,0,Math.PI/2,!1),e.lineTo(r,i),e.arc(r,i-r,r,Math.PI/2,Math.PI,!1),e.lineTo(0,o),e.arc(o,o,o,Math.PI,Math.PI*3/2,!1)}}});var Hm=Z(To=>{"use strict";Object.defineProperty(To,"__esModule",{value:!0});To.HitContext=To.SceneContext=To.Context=void 0;var q2=it(),V8=we();function z8(e){let t=[],i=e.length,n=q2.Util;for(let o=0;o<i;o++){let s=e[o];n._isNumber(s)?s=Math.round(s*1e3)/1e3:n._isString(s)||(s=s+""),t.push(s)}return t}var W2=",",W8="(",U8=")",q8="([",$8="])",j8=";",K8="()",Y8="=",U2=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],X8=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],J8=100,Lr=class{constructor(t){this.canvas=t,V8.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,i){let n=this.traceArr,o=n.length,s="",r,a,l,d;for(r=0;r<o;r++)a=n[r],l=a.method,l?(d=a.args,s+=l,t?s+=K8:q2.Util._isArray(d[0])?s+=q8+d.join(W2)+$8:(i&&(d=d.map(c=>typeof c=="number"?Math.floor(c):c)),s+=W8+d.join(W2)+U8)):(s+=a.property,t||(s+=Y8+a.val)),s+=j8;return s}clearTrace(){this.traceArr=[]}_trace(t){let i=this.traceArr,n;i.push(t),n=i.length,n>=J8&&i.shift()}reset(){let t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){let i=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,i.getWidth()/i.pixelRatio,i.getHeight()/i.pixelRatio)}_applyLineCap(t){let i=t.attrs.lineCap;i&&this.setAttr("lineCap",i)}_applyOpacity(t){let i=t.getAbsoluteOpacity();i!==1&&this.setAttr("globalAlpha",i)}_applyLineJoin(t){let i=t.attrs.lineJoin;i&&this.setAttr("lineJoin",i)}setAttr(t,i){this._context[t]=i}arc(t,i,n,o,s,r){this._context.arc(t,i,n,o,s,r)}arcTo(t,i,n,o,s){this._context.arcTo(t,i,n,o,s)}beginPath(){this._context.beginPath()}bezierCurveTo(t,i,n,o,s,r){this._context.bezierCurveTo(t,i,n,o,s,r)}clearRect(t,i,n,o){this._context.clearRect(t,i,n,o)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,i){let n=arguments;if(n.length===2)return this._context.createImageData(t,i);if(n.length===1)return this._context.createImageData(t)}createLinearGradient(t,i,n,o){return this._context.createLinearGradient(t,i,n,o)}createPattern(t,i){return this._context.createPattern(t,i)}createRadialGradient(t,i,n,o,s,r){return this._context.createRadialGradient(t,i,n,o,s,r)}drawImage(t,i,n,o,s,r,a,l,d){let c=arguments,u=this._context;c.length===3?u.drawImage(t,i,n):c.length===5?u.drawImage(t,i,n,o,s):c.length===9&&u.drawImage(t,i,n,o,s,r,a,l,d)}ellipse(t,i,n,o,s,r,a,l){this._context.ellipse(t,i,n,o,s,r,a,l)}isPointInPath(t,i,n,o){return n?this._context.isPointInPath(n,t,i,o):this._context.isPointInPath(t,i,o)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,i,n,o){this._context.fillRect(t,i,n,o)}strokeRect(t,i,n,o){this._context.strokeRect(t,i,n,o)}fillText(t,i,n,o){o?this._context.fillText(t,i,n,o):this._context.fillText(t,i,n)}measureText(t){return this._context.measureText(t)}getImageData(t,i,n,o){return this._context.getImageData(t,i,n,o)}lineTo(t,i){this._context.lineTo(t,i)}moveTo(t,i){this._context.moveTo(t,i)}rect(t,i,n,o){this._context.rect(t,i,n,o)}roundRect(t,i,n,o,s){this._context.roundRect(t,i,n,o,s)}putImageData(t,i,n){this._context.putImageData(t,i,n)}quadraticCurveTo(t,i,n,o){this._context.quadraticCurveTo(t,i,n,o)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,i){this._context.scale(t,i)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,i,n,o,s,r){this._context.setTransform(t,i,n,o,s,r)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,i,n,o){this._context.strokeText(t,i,n,o)}transform(t,i,n,o,s,r){this._context.transform(t,i,n,o,s,r)}translate(t,i){this._context.translate(t,i)}_enableTrace(){let t=this,i=U2.length,n=this.setAttr,o,s,r=function(a){let l=t[a],d;t[a]=function(){return s=z8(Array.prototype.slice.call(arguments,0)),d=l.apply(t,arguments),t._trace({method:a,args:s}),d}};for(o=0;o<i;o++)r(U2[o]);t.setAttr=function(){n.apply(t,arguments);let a=arguments[0],l=arguments[1];(a==="shadowOffsetX"||a==="shadowOffsetY"||a==="shadowBlur")&&(l=l/this.canvas.getPixelRatio()),t._trace({property:a,val:l})}}_applyGlobalCompositeOperation(t){let i=t.attrs.globalCompositeOperation;!i||i==="source-over"||this.setAttr("globalCompositeOperation",i)}};To.Context=Lr;X8.forEach(function(e){Object.defineProperty(Lr.prototype,e,{get(){return this._context[e]},set(t){this._context[e]=t}})});var Nm=class extends Lr{constructor(t,{willReadFrequently:i=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:i})}_fillColor(t){let i=t.fill();this.setAttr("fillStyle",i),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){let i=t._getLinearGradient();i&&(this.setAttr("fillStyle",i),t._fillFunc(this))}_fillRadialGradient(t){let i=t._getRadialGradient();i&&(this.setAttr("fillStyle",i),t._fillFunc(this))}_fill(t){let i=t.fill(),n=t.getFillPriority();if(i&&n==="color"){this._fillColor(t);return}let o=t.getFillPatternImage();if(o&&n==="pattern"){this._fillPattern(t);return}let s=t.getFillLinearGradientColorStops();if(s&&n==="linear-gradient"){this._fillLinearGradient(t);return}let r=t.getFillRadialGradientColorStops();if(r&&n==="radial-gradient"){this._fillRadialGradient(t);return}i?this._fillColor(t):o?this._fillPattern(t):s?this._fillLinearGradient(t):r&&this._fillRadialGradient(t)}_strokeLinearGradient(t){let i=t.getStrokeLinearGradientStartPoint(),n=t.getStrokeLinearGradientEndPoint(),o=t.getStrokeLinearGradientColorStops(),s=this.createLinearGradient(i.x,i.y,n.x,n.y);if(o){for(let r=0;r<o.length;r+=2)s.addColorStop(o[r],o[r+1]);this.setAttr("strokeStyle",s)}}_stroke(t){let i=t.dash(),n=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!n){this.save();let s=this.getCanvas().getPixelRatio();this.setTransform(s,0,0,s,0,0)}this._applyLineCap(t),i&&t.dashEnabled()&&(this.setLineDash(i),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),n||this.restore()}}_applyShadow(t){var i,n,o;let s=(i=t.getShadowRGBA())!==null&&i!==void 0?i:"black",r=(n=t.getShadowBlur())!==null&&n!==void 0?n:5,a=(o=t.getShadowOffset())!==null&&o!==void 0?o:{x:0,y:0},l=t.getAbsoluteScale(),d=this.canvas.getPixelRatio(),c=l.x*d,u=l.y*d;this.setAttr("shadowColor",s),this.setAttr("shadowBlur",r*Math.min(Math.abs(c),Math.abs(u))),this.setAttr("shadowOffsetX",a.x*c),this.setAttr("shadowOffsetY",a.y*u)}};To.SceneContext=Nm;var Bm=class extends Lr{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){let i=t.getStrokeScaleEnabled();if(!i){this.save();let s=this.getCanvas().getPixelRatio();this.setTransform(s,0,0,s,0,0)}this._applyLineCap(t);let n=t.hitStrokeWidth(),o=n==="auto"?t.strokeWidth():n;this.setAttr("lineWidth",o),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),i||this.restore()}}};To.HitContext=Bm});var Cl=Z(Ao=>{"use strict";Object.defineProperty(Ao,"__esModule",{value:!0});Ao.HitCanvas=Ao.SceneCanvas=Ao.Canvas=void 0;var yu=it(),$2=Hm(),j2=we(),bu;function Q8(){if(bu)return bu;let e=yu.Util.createCanvasElement(),t=e.getContext("2d");return bu=(function(){let i=j2.Konva._global.devicePixelRatio||1,n=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return i/n})(),yu.Util.releaseCanvas(e),bu}var ml=class{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;let n=(t||{}).pixelRatio||j2.Konva.pixelRatio||Q8();this.pixelRatio=n,this._canvas=yu.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){let i=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/i,this.getHeight()/i)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";let i=this.pixelRatio;this.getContext()._context.scale(i,i)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";let i=this.pixelRatio;this.getContext()._context.scale(i,i)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,i){this.setWidth(t||0),this.setHeight(i||0)}toDataURL(t,i){try{return this._canvas.toDataURL(t,i)}catch{try{return this._canvas.toDataURL()}catch(o){return yu.Util.error("Unable to get data URL. "+o.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};Ao.Canvas=ml;var Gm=class extends ml{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new $2.SceneContext(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}};Ao.SceneCanvas=Gm;var Vm=class extends ml{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new $2.HitContext(this),this.setSize(t.width,t.height)}};Ao.HitCanvas=Vm});var Su=Z(St=>{"use strict";Object.defineProperty(St,"__esModule",{value:!0});St.DD=void 0;var vl=we(),Z8=it();St.DD={get isDragging(){let e=!1;return St.DD._dragElements.forEach(t=>{t.dragStatus==="dragging"&&(e=!0)}),e},justDragged:!1,get node(){let e;return St.DD._dragElements.forEach(t=>{e=t.node}),e},_dragElements:new Map,_drag(e){let t=[];St.DD._dragElements.forEach((i,n)=>{let{node:o}=i,s=o.getStage();s.setPointersPositions(e),i.pointerId===void 0&&(i.pointerId=Z8.Util._getFirstPointerId(e));let r=s._changedPointerPositions.find(a=>a.id===i.pointerId);if(r){if(i.dragStatus!=="dragging"){let a=o.dragDistance();if(Math.max(Math.abs(r.x-i.startPointerPos.x),Math.abs(r.y-i.startPointerPos.y))<a||(o.startDrag({evt:e}),!o.isDragging()))return}o._setDragPosition(e,i),t.push(o)}}),t.forEach(i=>{i.fire("dragmove",{type:"dragmove",target:i,evt:e},!0)})},_endDragBefore(e){let t=[];St.DD._dragElements.forEach(i=>{let{node:n}=i,o=n.getStage();if(e&&o.setPointersPositions(e),!o._changedPointerPositions.find(a=>a.id===i.pointerId))return;(i.dragStatus==="dragging"||i.dragStatus==="stopped")&&(St.DD.justDragged=!0,vl.Konva._mouseListenClick=!1,vl.Konva._touchListenClick=!1,vl.Konva._pointerListenClick=!1,i.dragStatus="stopped");let r=i.node.getLayer()||i.node instanceof vl.Konva.Stage&&i.node;r&&t.indexOf(r)===-1&&t.push(r)}),t.forEach(i=>{i.draw()})},_endDragAfter(e){St.DD._dragElements.forEach((t,i)=>{t.dragStatus==="stopped"&&t.node.fire("dragend",{type:"dragend",target:t.node,evt:e},!0),t.dragStatus!=="dragging"&&St.DD._dragElements.delete(i)})}};vl.Konva.isBrowser&&(window.addEventListener("mouseup",St.DD._endDragBefore,!0),window.addEventListener("touchend",St.DD._endDragBefore,!0),window.addEventListener("touchcancel",St.DD._endDragBefore,!0),window.addEventListener("mousemove",St.DD._drag),window.addEventListener("touchmove",St.DD._drag),window.addEventListener("mouseup",St.DD._endDragAfter,!1),window.addEventListener("touchend",St.DD._endDragAfter,!1),window.addEventListener("touchcancel",St.DD._endDragAfter,!1))});var Se=Z(Ci=>{"use strict";Object.defineProperty(Ci,"__esModule",{value:!0});Ci.RGBComponent=eA;Ci.alphaComponent=tA;Ci.getNumberValidator=iA;Ci.getNumberOrArrayOfNumbersValidator=nA;Ci.getNumberOrAutoValidator=oA;Ci.getStringValidator=sA;Ci.getStringOrGradientValidator=rA;Ci.getFunctionValidator=aA;Ci.getNumberArrayValidator=lA;Ci.getBooleanValidator=dA;Ci.getComponentValidator=cA;var Un=we(),at=it();function qn(e){return at.Util._isString(e)?'"'+e+'"':Object.prototype.toString.call(e)==="[object Number]"||at.Util._isBoolean(e)?e:Object.prototype.toString.call(e)}function eA(e){return e>255?255:e<0?0:Math.round(e)}function tA(e){return e>1?1:e<1e-4?1e-4:e}function iA(){if(Un.Konva.isUnminified)return function(e,t){return at.Util._isNumber(e)||at.Util.warn(qn(e)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),e}}function nA(e){if(Un.Konva.isUnminified)return function(t,i){let n=at.Util._isNumber(t),o=at.Util._isArray(t)&&t.length==e;return!n&&!o&&at.Util.warn(qn(t)+' is a not valid value for "'+i+'" attribute. The value should be a number or Array<number>('+e+")"),t}}function oA(){if(Un.Konva.isUnminified)return function(e,t){return at.Util._isNumber(e)||e==="auto"||at.Util.warn(qn(e)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),e}}function sA(){if(Un.Konva.isUnminified)return function(e,t){return at.Util._isString(e)||at.Util.warn(qn(e)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),e}}function rA(){if(Un.Konva.isUnminified)return function(e,t){let i=at.Util._isString(e),n=Object.prototype.toString.call(e)==="[object CanvasGradient]"||e&&e.addColorStop;return i||n||at.Util.warn(qn(e)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),e}}function aA(){if(Un.Konva.isUnminified)return function(e,t){return at.Util._isFunction(e)||at.Util.warn(qn(e)+' is a not valid value for "'+t+'" attribute. The value should be a function.'),e}}function lA(){if(Un.Konva.isUnminified)return function(e,t){let i=Int8Array?Object.getPrototypeOf(Int8Array):null;return i&&e instanceof i||(at.Util._isArray(e)?e.forEach(function(n){at.Util._isNumber(n)||at.Util.warn('"'+t+'" attribute has non numeric element '+n+". Make sure that all elements are numbers.")}):at.Util.warn(qn(e)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),e}}function dA(){if(Un.Konva.isUnminified)return function(e,t){return e===!0||e===!1||at.Util.warn(qn(e)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),e}}function cA(e){if(Un.Konva.isUnminified)return function(t,i){return t==null||at.Util.isObject(t)||at.Util.warn(qn(t)+' is a not valid value for "'+i+'" attribute. The value should be an object with properties '+e),t}}});var be=Z(zi=>{"use strict";Object.defineProperty(zi,"__esModule",{value:!0});zi.Factory=void 0;var vi=it(),uA=Se(),wl="get",bl="set";zi.Factory={addGetterSetter(e,t,i,n,o){zi.Factory.addGetter(e,t,i),zi.Factory.addSetter(e,t,n,o),zi.Factory.addOverloadedGetterSetter(e,t)},addGetter(e,t,i){let n=wl+vi.Util._capitalize(t);e.prototype[n]=e.prototype[n]||function(){let o=this.attrs[t];return o===void 0?i:o}},addSetter(e,t,i,n){let o=bl+vi.Util._capitalize(t);e.prototype[o]||zi.Factory.overWriteSetter(e,t,i,n)},overWriteSetter(e,t,i,n){let o=bl+vi.Util._capitalize(t);e.prototype[o]=function(s){return i&&s!==void 0&&s!==null&&(s=i.call(this,s,t)),this._setAttr(t,s),n&&n.call(this),this}},addComponentsGetterSetter(e,t,i,n,o){let s=i.length,r=vi.Util._capitalize,a=wl+r(t),l=bl+r(t);e.prototype[a]=function(){let c={};for(let u=0;u<s;u++){let h=i[u];c[h]=this.getAttr(t+r(h))}return c};let d=(0,uA.getComponentValidator)(i);e.prototype[l]=function(c){let u=this.attrs[t];n&&(c=n.call(this,c,t)),d&&d.call(this,c,t);for(let h in c)c.hasOwnProperty(h)&&this._setAttr(t+r(h),c[h]);return c||i.forEach(h=>{this._setAttr(t+r(h),void 0)}),this._fireChangeEvent(t,u,c),o&&o.call(this),this},zi.Factory.addOverloadedGetterSetter(e,t)},addOverloadedGetterSetter(e,t){let i=vi.Util._capitalize(t),n=bl+i,o=wl+i;e.prototype[t]=function(){return arguments.length?(this[n](arguments[0]),this):this[o]()}},addDeprecatedGetterSetter(e,t,i,n){vi.Util.error("Adding deprecated "+t);let o=wl+vi.Util._capitalize(t),s=t+" property is deprecated and will be removed soon. Look at Konva change log for more information.";e.prototype[o]=function(){vi.Util.error(s);let r=this.attrs[t];return r===void 0?i:r},zi.Factory.addSetter(e,t,n,function(){vi.Util.error(s)}),zi.Factory.addOverloadedGetterSetter(e,t)},backCompat(e,t){vi.Util.each(t,function(i,n){let o=e.prototype[n],s=wl+vi.Util._capitalize(i),r=bl+vi.Util._capitalize(i);function a(){o.apply(this,arguments),vi.Util.error('"'+i+'" method is deprecated and will be removed soon. Use ""'+n+'" instead.')}e.prototype[i]=a,e.prototype[s]=a,e.prototype[r]=a})},afterSetFilter(){this._filterUpToDate=!1}}});var lt=Z(Pu=>{"use strict";Object.defineProperty(Pu,"__esModule",{value:!0});Pu.Node=void 0;var _r=Cl(),Ai=Su(),yl=be(),Io=we(),Me=it(),ct=Se(),Eu="absoluteOpacity",xu="allEventListeners",$n="absoluteTransform",K2="absoluteScale",Fs="canvas",hA="Change",pA="children",gA="konva",zm="listening",fA="mouseenter",mA="mouseleave",CA="pointerenter",vA="pointerleave",wA="touchenter",bA="touchleave",Y2="set",X2="Shape",Ru=" ",J2="stage",Lo="transform",yA="Stage",Wm="visible",SA=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(Ru),xA=1,fe=class e{constructor(t){this._id=xA++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===Lo||t===$n)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,i){let n=this._cache.get(t);return(n===void 0||(t===Lo||t===$n)&&n.dirty===!0)&&(n=i.call(this),this._cache.set(t,n)),n}_calculate(t,i,n){if(!this._attachedDepsListeners.get(t)){let o=i.map(s=>s+"Change.konva").join(Ru);this.on(o,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,n)}_getCanvasCache(){return this._cache.get(Fs)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===$n&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(Fs)){let{scene:t,filter:i,hit:n,buffer:o}=this._cache.get(Fs);Me.Util.releaseCanvas(t,i,n,o),this._cache.delete(Fs)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){let i=t||{},n={};(i.x===void 0||i.y===void 0||i.width===void 0||i.height===void 0)&&(n=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let o=Math.ceil(i.width||n.width),s=Math.ceil(i.height||n.height),r=i.pixelRatio,a=i.x===void 0?Math.floor(n.x):i.x,l=i.y===void 0?Math.floor(n.y):i.y,d=i.offset||0,c=i.drawBorder||!1,u=i.hitCanvasPixelRatio||1;if(!o||!s){Me.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}let h=Math.abs(Math.round(n.x)-a)>.5?1:0,p=Math.abs(Math.round(n.y)-l)>.5?1:0;o+=d*2+h,s+=d*2+p,a-=d,l-=d;let g=new _r.SceneCanvas({pixelRatio:r,width:o,height:s}),f=new _r.SceneCanvas({pixelRatio:r,width:0,height:0,willReadFrequently:!0}),m=new _r.HitCanvas({pixelRatio:u,width:o,height:s}),C=g.getContext(),v=m.getContext(),w=new _r.SceneCanvas({width:g.width/g.pixelRatio+Math.abs(a),height:g.height/g.pixelRatio+Math.abs(l),pixelRatio:g.pixelRatio}),y=w.getContext();return m.isCache=!0,g.isCache=!0,this._cache.delete(Fs),this._filterUpToDate=!1,i.imageSmoothingEnabled===!1&&(g.getContext()._context.imageSmoothingEnabled=!1,f.getContext()._context.imageSmoothingEnabled=!1),C.save(),v.save(),y.save(),C.translate(-a,-l),v.translate(-a,-l),y.translate(-a,-l),w.x=a,w.y=l,this._isUnderCache=!0,this._clearSelfAndDescendantCache(Eu),this._clearSelfAndDescendantCache(K2),this.drawScene(g,this,w),this.drawHit(m,this),this._isUnderCache=!1,C.restore(),v.restore(),c&&(C.save(),C.beginPath(),C.rect(0,0,o,s),C.closePath(),C.setAttr("strokeStyle","red"),C.setAttr("lineWidth",5),C.stroke(),C.restore()),this._cache.set(Fs,{scene:g,filter:f,hit:m,buffer:w,x:a,y:l}),this._requestDraw(),this}isCached(){return this._cache.has(Fs)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,i){let n=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],o=1/0,s=1/0,r=-1/0,a=-1/0,l=this.getAbsoluteTransform(i);return n.forEach(function(d){let c=l.point(d);o===void 0&&(o=r=c.x,s=a=c.y),o=Math.min(o,c.x),s=Math.min(s,c.y),r=Math.max(r,c.x),a=Math.max(a,c.y)}),{x:o,y:s,width:r-o,height:a-s}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);let i=this._getCanvasCache();t.translate(i.x,i.y);let n=this._getCachedSceneCanvas(),o=n.pixelRatio;t.drawImage(n._canvas,0,0,n.width/o,n.height/o),t.restore()}_drawCachedHitCanvas(t){let i=this._getCanvasCache(),n=i.hit;t.save(),t.translate(i.x,i.y),t.drawImage(n._canvas,0,0,n.width/n.pixelRatio,n.height/n.pixelRatio),t.restore()}_getCachedSceneCanvas(){let t=this.filters(),i=this._getCanvasCache(),n=i.scene,o=i.filter,s=o.getContext(),r,a,l,d;if(t){if(!this._filterUpToDate){let c=n.pixelRatio;o.setSize(n.width/n.pixelRatio,n.height/n.pixelRatio);try{for(r=t.length,s.clear(),s.drawImage(n._canvas,0,0,n.getWidth()/c,n.getHeight()/c),a=s.getImageData(0,0,o.getWidth(),o.getHeight()),l=0;l<r;l++){if(d=t[l],typeof d!="function"){Me.Util.error("Filter should be type of function, but got "+typeof d+" instead. Please check correct filters");continue}d.call(this,a),s.putImageData(a,0,0)}}catch(u){Me.Util.error("Unable to apply filter. "+u.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return o}return n}on(t,i){if(this._cache&&this._cache.delete(xu),arguments.length===3)return this._delegate.apply(this,arguments);let n=t.split(Ru);for(let o=0;o<n.length;o++){let r=n[o].split("."),a=r[0],l=r[1]||"";this.eventListeners[a]||(this.eventListeners[a]=[]),this.eventListeners[a].push({name:l,handler:i})}return this}off(t,i){let n=(t||"").split(Ru),o=n.length,s,r,a,l,d,c;if(this._cache&&this._cache.delete(xu),!t)for(r in this.eventListeners)this._off(r);for(s=0;s<o;s++)if(a=n[s],l=a.split("."),d=l[0],c=l[1],d)this.eventListeners[d]&&this._off(d,c,i);else for(r in this.eventListeners)this._off(r,c,i);return this}dispatchEvent(t){let i={target:this,type:t.type,evt:t};return this.fire(t.type,i),this}addEventListener(t,i){return this.on(t,function(n){i.call(this,n.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,i,n){let o=this;this.on(t,function(s){let r=s.target.findAncestors(i,!0,o);for(let a=0;a<r.length;a++)s=Me.Util.cloneObject(s),s.currentTarget=r[a],n.call(r[a],s)})}remove(){return this.isDragging()&&this.stopDrag(),Ai.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache($n),this._clearSelfAndDescendantCache(Eu),this._clearSelfAndDescendantCache(K2),this._clearSelfAndDescendantCache(J2),this._clearSelfAndDescendantCache(Wm),this._clearSelfAndDescendantCache(zm)}_remove(){this._clearCaches();let t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){let i="get"+Me.Util._capitalize(t);return Me.Util._isFunction(this[i])?this[i]():this.attrs[t]}getAncestors(){let t=this.getParent(),i=[];for(;t;)i.push(t),t=t.getParent();return i}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{let i,n;if(!t)return this;for(i in t)i!==pA&&(n=Y2+Me.Util._capitalize(i),Me.Util._isFunction(this[n])?this[n](t[i]):this._setAttr(i,t[i]))}),this}isListening(){return this._getCache(zm,this._isListening)}_isListening(t){if(!this.listening())return!1;let n=this.getParent();return n&&n!==t&&this!==t?n._isListening(t):!0}isVisible(){return this._getCache(Wm,this._isVisible)}_isVisible(t){if(!this.visible())return!1;let n=this.getParent();return n&&n!==t&&this!==t?n._isVisible(t):!0}shouldDrawHit(t,i=!1){if(t)return this._isVisible(t)&&this._isListening(t);let n=this.getLayer(),o=!1;Ai.DD._dragElements.forEach(r=>{r.dragStatus==="dragging"&&(r.node.nodeType==="Stage"||r.node.getLayer()===n)&&(o=!0)});let s=!i&&!Io.Konva.hitOnDragEnabled&&(o||Io.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!s}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let t=this.getDepth(),i=this,n=0,o,s,r,a;function l(c){for(o=[],s=c.length,r=0;r<s;r++)a=c[r],n++,a.nodeType!==X2&&(o=o.concat(a.getChildren().slice())),a._id===i._id&&(r=s);o.length>0&&o[0].getDepth()<=t&&l(o)}let d=this.getStage();return i.nodeType!==yA&&d&&l(d.getChildren()),n}getDepth(){let t=0,i=this.parent;for(;i;)t++,i=i.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(Lo),this._clearSelfAndDescendantCache($n)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){let t=this.getStage();if(!t)return null;let i=t.getPointerPosition();if(!i)return null;let n=this.getAbsoluteTransform().copy();return n.invert(),n.point(i)}getAbsolutePosition(t){let i=!1,n=this.parent;for(;n;){if(n.isCached()){i=!0;break}n=n.parent}i&&!t&&(t=!0);let o=this.getAbsoluteTransform(t).getMatrix(),s=new Me.Transform,r=this.offset();return s.m=o.slice(),s.translate(r.x,r.y),s.getTranslation()}setAbsolutePosition(t){let r=this._clearTransform(),{x:i,y:n}=r,o=oi(r,["x","y"]);this.attrs.x=i,this.attrs.y=n,this._clearCache(Lo);let s=this._getAbsoluteTransform().copy();return s.invert(),s.translate(t.x,t.y),t={x:this.attrs.x+s.getTranslation().x,y:this.attrs.y+s.getTranslation().y},this._setTransform(o),this.setPosition({x:t.x,y:t.y}),this._clearCache(Lo),this._clearSelfAndDescendantCache($n),this}_setTransform(t){let i;for(i in t)this.attrs[i]=t[i]}_clearTransform(){let t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){let i=t.x,n=t.y,o=this.x(),s=this.y();return i!==void 0&&(o+=i),n!==void 0&&(s+=n),this.setPosition({x:o,y:s}),this}_eachAncestorReverse(t,i){let n=[],o=this.getParent(),s,r;if(!(i&&i._id===this._id)){for(n.unshift(this);o&&(!i||o._id!==i._id);)n.unshift(o),o=o.parent;for(s=n.length,r=0;r<s;r++)t(n[r])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return Me.Util.warn("Node has no parent. moveToTop function is ignored."),!1;let t=this.index,i=this.parent.getChildren().length;return t<i-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return Me.Util.warn("Node has no parent. moveUp function is ignored."),!1;let t=this.index,i=this.parent.getChildren().length;return t<i-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return Me.Util.warn("Node has no parent. moveDown function is ignored."),!1;let t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return Me.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;let t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return Me.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&Me.Util.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");let i=this.index;return this.parent.children.splice(i,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(Eu,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let t=this.opacity(),i=this.getParent();return i&&!i._isUnderCache&&(t*=i.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){let t=this.getAttrs(),i,n,o,s,r,a={attrs:{},className:this.getClassName()};for(i in t)n=t[i],r=Me.Util.isObject(n)&&!Me.Util._isPlainObject(n)&&!Me.Util._isArray(n),!r&&(o=typeof this[i]=="function"&&this[i],delete t[i],s=o?o.call(this):null,t[i]=n,s!==n&&(a.attrs[i]=n));return Me.Util._prepareToStringify(a)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,i,n){let o=[];i&&this._isMatch(t)&&o.push(this);let s=this.parent;for(;s;){if(s===n)return o;s._isMatch(t)&&o.push(s),s=s.parent}return o}isAncestorOf(t){return!1}findAncestor(t,i,n){return this.findAncestors(t,i,n)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);let i=t.replace(/ /g,"").split(","),n=i.length,o,s;for(o=0;o<n;o++)if(s=i[o],Me.Util.isValidSelector(s)||(Me.Util.warn('Selector "'+s+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),Me.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),Me.Util.warn("Konva is awesome, right?")),s.charAt(0)==="#"){if(this.id()===s.slice(1))return!0}else if(s.charAt(0)==="."){if(this.hasName(s.slice(1)))return!0}else if(this.className===s||this.nodeType===s)return!0;return!1}getLayer(){let t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(J2,this._getStage)}_getStage(){let t=this.getParent();return t?t.getStage():null}fire(t,i={},n){return i.target=i.target||this,n?this._fireAndBubble(t,i):this._fire(t,i),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache($n,this._getAbsoluteTransform)}_getAbsoluteTransform(t){let i;if(t)return i=new Me.Transform,this._eachAncestorReverse(function(n){let o=n.transformsEnabled();o==="all"?i.multiply(n.getTransform()):o==="position"&&i.translate(n.x()-n.offsetX(),n.y()-n.offsetY())},t),i;{i=this._cache.get($n)||new Me.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(i):i.reset();let n=this.transformsEnabled();if(n==="all")i.multiply(this.getTransform());else if(n==="position"){let o=this.attrs.x||0,s=this.attrs.y||0,r=this.attrs.offsetX||0,a=this.attrs.offsetY||0;i.translate(o-r,s-a)}return i.dirty=!1,i}}getAbsoluteScale(t){let i=this;for(;i;)i._isUnderCache&&(t=i),i=i.getParent();let o=this.getAbsoluteTransform(t).decompose();return{x:o.scaleX,y:o.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(Lo,this._getTransform)}_getTransform(){var t,i;let n=this._cache.get(Lo)||new Me.Transform;n.reset();let o=this.x(),s=this.y(),r=Io.Konva.getAngle(this.rotation()),a=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,l=(i=this.attrs.scaleY)!==null&&i!==void 0?i:1,d=this.attrs.skewX||0,c=this.attrs.skewY||0,u=this.attrs.offsetX||0,h=this.attrs.offsetY||0;return(o!==0||s!==0)&&n.translate(o,s),r!==0&&n.rotate(r),(d!==0||c!==0)&&n.skew(d,c),(a!==1||l!==1)&&n.scale(a,l),(u!==0||h!==0)&&n.translate(-1*u,-1*h),n.dirty=!1,n}clone(t){let i=Me.Util.cloneObject(this.attrs),n,o,s,r,a;for(n in t)i[n]=t[n];let l=new this.constructor(i);for(n in this.eventListeners)for(o=this.eventListeners[n],s=o.length,r=0;r<s;r++)a=o[r],a.name.indexOf(gA)<0&&(l.eventListeners[n]||(l.eventListeners[n]=[]),l.eventListeners[n].push(a));return l}_toKonvaCanvas(t){t=t||{};let i=this.getClientRect(),n=this.getStage(),o=t.x!==void 0?t.x:Math.floor(i.x),s=t.y!==void 0?t.y:Math.floor(i.y),r=t.pixelRatio||1,a=new _r.SceneCanvas({width:t.width||Math.ceil(i.width)||(n?n.width():0),height:t.height||Math.ceil(i.height)||(n?n.height():0),pixelRatio:r}),l=a.getContext(),d=new _r.SceneCanvas({width:a.width/a.pixelRatio+Math.abs(o),height:a.height/a.pixelRatio+Math.abs(s),pixelRatio:a.pixelRatio});return t.imageSmoothingEnabled===!1&&(l._context.imageSmoothingEnabled=!1),l.save(),(o||s)&&l.translate(-1*o,-1*s),this.drawScene(a,void 0,d),l.restore(),a}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};let i=t.mimeType||null,n=t.quality||null,o=this._toKonvaCanvas(t).toDataURL(i,n);return t.callback&&t.callback(o),o}toImage(t){return new Promise((i,n)=>{try{let o=t?.callback;o&&delete t.callback,Me.Util._urlToImage(this.toDataURL(t),function(s){i(s),o?.(s)})}catch(o){n(o)}})}toBlob(t){return new Promise((i,n)=>{try{let o=t?.callback;o&&delete t.callback,this.toCanvas(t).toBlob(s=>{i(s),o?.(s)},t?.mimeType,t?.quality)}catch(o){n(o)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Io.Konva.dragDistance}_off(t,i,n){let o=this.eventListeners[t],s,r,a;for(s=0;s<o.length;s++)if(r=o[s].name,a=o[s].handler,(r!=="konva"||i==="konva")&&(!i||r===i)&&(!n||n===a)){if(o.splice(s,1),o.length===0){delete this.eventListeners[t];break}s--}}_fireChangeEvent(t,i,n){this._fire(t+hA,{oldVal:i,newVal:n})}addName(t){if(!this.hasName(t)){let i=this.name(),n=i?i+" "+t:t;this.name(n)}return this}hasName(t){if(!t)return!1;let i=this.name();return i?(i||"").split(/\s/g).indexOf(t)!==-1:!1}removeName(t){let i=(this.name()||"").split(/\s/g),n=i.indexOf(t);return n!==-1&&(i.splice(n,1),this.name(i.join(" "))),this}setAttr(t,i){let n=this[Y2+Me.Util._capitalize(t)];return Me.Util._isFunction(n)?n.call(this,i):this._setAttr(t,i),this}_requestDraw(){if(Io.Konva.autoDrawEnabled){let t=this.getLayer()||this.getStage();t?.batchDraw()}}_setAttr(t,i){let n=this.attrs[t];n===i&&!Me.Util.isObject(i)||(i==null?delete this.attrs[t]:this.attrs[t]=i,this._shouldFireChangeEvents&&this._fireChangeEvent(t,n,i),this._requestDraw())}_setComponentAttr(t,i,n){let o;n!==void 0&&(o=this.attrs[t],o||(this.attrs[t]=this.getAttr(t)),this.attrs[t][i]=n,this._fireChangeEvent(t,o,n))}_fireAndBubble(t,i,n){i&&this.nodeType===X2&&(i.target=this);let o=[fA,mA,CA,vA,wA,bA];if(!(o.indexOf(t)!==-1&&(n&&(this===n||this.isAncestorOf&&this.isAncestorOf(n))||this.nodeType==="Stage"&&!n))){this._fire(t,i);let r=o.indexOf(t)!==-1&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(i&&!i.cancelBubble||!i)&&this.parent&&this.parent.isListening()&&!r&&(n&&n.parent?this._fireAndBubble.call(this.parent,t,i,n):this._fireAndBubble.call(this.parent,t,i))}}_getProtoListeners(t){var i,n,o;let s=(i=this._cache.get(xu))!==null&&i!==void 0?i:{},r=s?.[t];if(r===void 0){r=[];let a=Object.getPrototypeOf(this);for(;a;){let l=(o=(n=a.eventListeners)===null||n===void 0?void 0:n[t])!==null&&o!==void 0?o:[];r.push(...l),a=Object.getPrototypeOf(a)}s[t]=r,this._cache.set(xu,s)}return r}_fire(t,i){i=i||{},i.currentTarget=this,i.type=t;let n=this._getProtoListeners(t);if(n)for(let s=0;s<n.length;s++)n[s].handler.call(this,i);let o=this.eventListeners[t];if(o)for(let s=0;s<o.length;s++)o[s].handler.call(this,i)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){let i=t?t.pointerId:void 0,n=this.getStage(),o=this.getAbsolutePosition();if(!n)return;let s=n._getPointerById(i)||n._changedPointerPositions[0]||o;Ai.DD._dragElements.set(this._id,{node:this,startPointerPos:s,offset:{x:s.x-o.x,y:s.y-o.y},dragStatus:"ready",pointerId:i})}startDrag(t,i=!0){Ai.DD._dragElements.has(this._id)||this._createDragElement(t);let n=Ai.DD._dragElements.get(this._id);n.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},i)}_setDragPosition(t,i){let n=this.getStage()._getPointerById(i.pointerId);if(!n)return;let o={x:n.x-i.offset.x,y:n.y-i.offset.y},s=this.dragBoundFunc();if(s!==void 0){let r=s.call(this,o,t);r?o=r:Me.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==o.x||this._lastPos.y!==o.y)&&(this.setAbsolutePosition(o),this._requestDraw()),this._lastPos=o}stopDrag(t){let i=Ai.DD._dragElements.get(this._id);i&&(i.dragStatus="stopped"),Ai.DD._endDragBefore(t),Ai.DD._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){let t=Ai.DD._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){if(!(!(t.evt.button!==void 0)||Io.Konva.dragButtons.indexOf(t.evt.button)>=0)||this.isDragging())return;let o=!1;Ai.DD._dragElements.forEach(s=>{this.isAncestorOf(s.node)&&(o=!0)}),o||this._createDragElement(t)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;let i=Ai.DD._dragElements.get(this._id),n=i&&i.dragStatus==="dragging",o=i&&i.dragStatus==="ready";n?this.stopDrag():o&&Ai.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){let i=this.getStage();if(!i)return!1;let n={x:-t.x,y:-t.y,width:i.width()+2*t.x,height:i.height()+2*t.y};return Me.Util.haveIntersection(n,this.getClientRect())}static create(t,i){return Me.Util._isString(t)&&(t=JSON.parse(t)),this._createNode(t,i)}static _createNode(t,i){let n=e.prototype.getClassName.call(t),o=t.children,s,r,a;i&&(t.attrs.container=i),Io.Konva[n]||(Me.Util.warn('Can not find a node with class name "'+n+'". Fallback to "Shape".'),n="Shape");let l=Io.Konva[n];if(s=new l(t.attrs),o)for(r=o.length,a=0;a<r;a++)s.add(e._createNode(o[a]));return s}};Pu.Node=fe;fe.prototype.nodeType="Node";fe.prototype._attrsAffectingSize=[];fe.prototype.eventListeners={};fe.prototype.on.call(fe.prototype,SA,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(Lo),this._clearSelfAndDescendantCache($n)});fe.prototype.on.call(fe.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(Wm)});fe.prototype.on.call(fe.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(zm)});fe.prototype.on.call(fe.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(Eu)});var qe=yl.Factory.addGetterSetter;qe(fe,"zIndex");qe(fe,"absolutePosition");qe(fe,"position");qe(fe,"x",0,(0,ct.getNumberValidator)());qe(fe,"y",0,(0,ct.getNumberValidator)());qe(fe,"globalCompositeOperation","source-over",(0,ct.getStringValidator)());qe(fe,"opacity",1,(0,ct.getNumberValidator)());qe(fe,"name","",(0,ct.getStringValidator)());qe(fe,"id","",(0,ct.getStringValidator)());qe(fe,"rotation",0,(0,ct.getNumberValidator)());yl.Factory.addComponentsGetterSetter(fe,"scale",["x","y"]);qe(fe,"scaleX",1,(0,ct.getNumberValidator)());qe(fe,"scaleY",1,(0,ct.getNumberValidator)());yl.Factory.addComponentsGetterSetter(fe,"skew",["x","y"]);qe(fe,"skewX",0,(0,ct.getNumberValidator)());qe(fe,"skewY",0,(0,ct.getNumberValidator)());yl.Factory.addComponentsGetterSetter(fe,"offset",["x","y"]);qe(fe,"offsetX",0,(0,ct.getNumberValidator)());qe(fe,"offsetY",0,(0,ct.getNumberValidator)());qe(fe,"dragDistance",void 0,(0,ct.getNumberValidator)());qe(fe,"width",0,(0,ct.getNumberValidator)());qe(fe,"height",0,(0,ct.getNumberValidator)());qe(fe,"listening",!0,(0,ct.getBooleanValidator)());qe(fe,"preventDefault",!0,(0,ct.getBooleanValidator)());qe(fe,"filters",void 0,function(e){return this._filterUpToDate=!1,e});qe(fe,"visible",!0,(0,ct.getBooleanValidator)());qe(fe,"transformsEnabled","all",(0,ct.getStringValidator)());qe(fe,"size");qe(fe,"dragBoundFunc");qe(fe,"draggable",!1,(0,ct.getBooleanValidator)());yl.Factory.backCompat(fe,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"})});var Sl=Z(ku=>{"use strict";Object.defineProperty(ku,"__esModule",{value:!0});ku.Container=void 0;var Or=be(),Um=lt(),Mu=Se(),jn=class extends Um.Node{constructor(){super(...arguments),this.children=[]}getChildren(t){let i=this.children||[];return t?i.filter(t):i}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(let n=0;n<t.length;n++)this.add(t[n]);return this}let i=t[0];return i.getParent()?(i.moveTo(this),this):(this._validateAdd(i),i.index=this.getChildren().length,i.parent=this,i._clearCaches(),this.getChildren().push(i),this._fire("add",{child:i}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){let i=this._generalFind(t,!0);return i.length>0?i[0]:void 0}_generalFind(t,i){let n=[];return this._descendants(o=>{let s=o._isMatch(t);return s&&n.push(o),!!(s&&i)}),n}_descendants(t){let i=!1,n=this.getChildren();for(let o of n){if(i=t(o),i)return!0;if(o.hasChildren()&&(i=o._descendants(t),i))return!0}return!1}toObject(){let t=Um.Node.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(i=>{t.children.push(i.toObject())}),t}isAncestorOf(t){let i=t.getParent();for(;i;){if(i._id===this._id)return!0;i=i.getParent()}return!1}clone(t){let i=Um.Node.prototype.clone.call(this,t);return this.getChildren().forEach(function(n){i.add(n.clone())}),i}getAllIntersections(t){let i=[];return this.find("Shape").forEach(n=>{n.isVisible()&&n.intersects(t)&&i.push(n)}),i}_clearSelfAndDescendantCache(t){var i;super._clearSelfAndDescendantCache(t),!this.isCached()&&((i=this.children)===null||i===void 0||i.forEach(function(n){n._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(i,n){i.index=n}),this._requestDraw()}drawScene(t,i,n){let o=this.getLayer(),s=t||o&&o.getCanvas(),r=s&&s.getContext(),a=this._getCanvasCache(),l=a&&a.scene,d=s&&s.isCache;if(!this.isVisible()&&!d)return this;if(l){r.save();let c=this.getAbsoluteTransform(i).getMatrix();r.transform(c[0],c[1],c[2],c[3],c[4],c[5]),this._drawCachedSceneCanvas(r),r.restore()}else this._drawChildren("drawScene",s,i,n);return this}drawHit(t,i){if(!this.shouldDrawHit(i))return this;let n=this.getLayer(),o=t||n&&n.hitCanvas,s=o&&o.getContext(),r=this._getCanvasCache();if(r&&r.hit){s.save();let l=this.getAbsoluteTransform(i).getMatrix();s.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this._drawCachedHitCanvas(s),s.restore()}else this._drawChildren("drawHit",o,i);return this}_drawChildren(t,i,n,o){var s;let r=i&&i.getContext(),a=this.clipWidth(),l=this.clipHeight(),d=this.clipFunc(),c=typeof a=="number"&&typeof l=="number"||d,u=n===this;if(c){r.save();let p=this.getAbsoluteTransform(n),g=p.getMatrix();r.transform(g[0],g[1],g[2],g[3],g[4],g[5]),r.beginPath();let f;if(d)f=d.call(this,r,this);else{let m=this.clipX(),C=this.clipY();r.rect(m||0,C||0,a,l)}r.clip.apply(r,f),g=p.copy().invert().getMatrix(),r.transform(g[0],g[1],g[2],g[3],g[4],g[5])}let h=!u&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";h&&(r.save(),r._applyGlobalCompositeOperation(this)),(s=this.children)===null||s===void 0||s.forEach(function(p){p[t](i,n,o)}),h&&r.restore(),c&&r.restore()}getClientRect(t={}){var i;let n=t.skipTransform,o=t.relativeTo,s,r,a,l,d={x:1/0,y:1/0,width:0,height:0},c=this;(i=this.children)===null||i===void 0||i.forEach(function(p){if(!p.visible())return;let g=p.getClientRect({relativeTo:c,skipShadow:t.skipShadow,skipStroke:t.skipStroke});g.width===0&&g.height===0||(s===void 0?(s=g.x,r=g.y,a=g.x+g.width,l=g.y+g.height):(s=Math.min(s,g.x),r=Math.min(r,g.y),a=Math.max(a,g.x+g.width),l=Math.max(l,g.y+g.height)))});let u=this.find("Shape"),h=!1;for(let p=0;p<u.length;p++)if(u[p]._isVisible(this)){h=!0;break}return h&&s!==void 0?d={x:s,y:r,width:a-s,height:l-r}:d={x:0,y:0,width:0,height:0},n?d:this._transformedRect(d,o)}};ku.Container=jn;Or.Factory.addComponentsGetterSetter(jn,"clip",["x","y","width","height"]);Or.Factory.addGetterSetter(jn,"clipX",void 0,(0,Mu.getNumberValidator)());Or.Factory.addGetterSetter(jn,"clipY",void 0,(0,Mu.getNumberValidator)());Or.Factory.addGetterSetter(jn,"clipWidth",void 0,(0,Mu.getNumberValidator)());Or.Factory.addGetterSetter(jn,"clipHeight",void 0,(0,Mu.getNumberValidator)());Or.Factory.addGetterSetter(jn,"clipFunc")});var $m=Z(Ts=>{"use strict";Object.defineProperty(Ts,"__esModule",{value:!0});Ts.getCapturedShape=RA;Ts.createEvent=qm;Ts.hasPointerCapture=PA;Ts.setPointerCapture=MA;Ts.releaseCapture=Z2;var EA=we(),xl=new Map,Q2=EA.Konva._global.PointerEvent!==void 0;function RA(e){return xl.get(e)}function qm(e){return{evt:e,pointerId:e.pointerId}}function PA(e,t){return xl.get(e)===t}function MA(e,t){Z2(e),t.getStage()&&(xl.set(e,t),Q2&&t._fire("gotpointercapture",qm(new PointerEvent("gotpointercapture"))))}function Z2(e,t){let i=xl.get(e);if(!i)return;let n=i.getStage();n&&n.content,xl.delete(e),Q2&&i._fire("lostpointercapture",qm(new PointerEvent("lostpointercapture")))}});var Qm=Z(hn=>{"use strict";Object.defineProperty(hn,"__esModule",{value:!0});hn.Stage=hn.stages=void 0;var un=it(),kA=be(),e3=Sl(),ut=we(),jm=Cl(),Km=Su(),DA=we(),Kn=$m(),FA="Stage",TA="string",t3="px",AA="mouseout",n3="mouseleave",o3="mouseover",s3="mouseenter",r3="mousemove",a3="mousedown",l3="mouseup",El="pointermove",Rl="pointerdown",Br="pointerup",Pl="pointercancel",IA="lostpointercapture",Du="pointerout",Ml="pointerleave",Fu="pointerover",Tu="pointerenter",Xm="contextmenu",d3="touchstart",c3="touchend",u3="touchmove",h3="touchcancel",Jm="wheel",LA=5,_A=[[s3,"_pointerenter"],[a3,"_pointerdown"],[r3,"_pointermove"],[l3,"_pointerup"],[n3,"_pointerleave"],[d3,"_pointerdown"],[u3,"_pointermove"],[c3,"_pointerup"],[h3,"_pointercancel"],[o3,"_pointerover"],[Jm,"_wheel"],[Xm,"_contextmenu"],[Rl,"_pointerdown"],[El,"_pointermove"],[Br,"_pointerup"],[Pl,"_pointercancel"],[Ml,"_pointerleave"],[IA,"_lostpointercapture"]],Ym={mouse:{[Du]:AA,[Ml]:n3,[Fu]:o3,[Tu]:s3,[El]:r3,[Rl]:a3,[Br]:l3,[Pl]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[Du]:"touchout",[Ml]:"touchleave",[Fu]:"touchover",[Tu]:"touchenter",[El]:u3,[Rl]:d3,[Br]:c3,[Pl]:h3,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[Du]:Du,[Ml]:Ml,[Fu]:Fu,[Tu]:Tu,[El]:El,[Rl]:Rl,[Br]:Br,[Pl]:Pl,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},kl=e=>e.indexOf("pointer")>=0?"pointer":e.indexOf("touch")>=0?"touch":"mouse",Nr=e=>{let t=kl(e);if(t==="pointer")return ut.Konva.pointerEventsEnabled&&Ym.pointer;if(t==="touch")return Ym.touch;if(t==="mouse")return Ym.mouse};function i3(e={}){return(e.clipFunc||e.clipWidth||e.clipHeight)&&un.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),e}var OA="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";hn.stages=[];var Hr=class extends e3.Container{constructor(t){super(i3(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),hn.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{i3(this.attrs)}),this._checkVisibility()}_validateAdd(t){let i=t.getType()==="Layer",n=t.getType()==="FastLayer";i||n||un.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;let t=this.visible()?"":"none";this.content.style.display=t}setContainer(t){if(typeof t===TA){let i;if(t.charAt(0)==="."){let n=t.slice(1);t=document.getElementsByClassName(n)[0]}else t.charAt(0)!=="#"?i=t:i=t.slice(1),t=document.getElementById(i);if(!t)throw"Can not find container in document with id "+i}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){let t=this.children,i=t.length;for(let n=0;n<i;n++)t[n].clear();return this}clone(t){return t||(t={}),t.container=typeof document<"u"&&document.createElement("div"),e3.Container.prototype.clone.call(this,t)}destroy(){super.destroy();let t=this.content;t&&un.Util._isInDocument(t)&&this.container().removeChild(t);let i=hn.stages.indexOf(this);return i>-1&&hn.stages.splice(i,1),un.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){let t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(un.Util.warn(OA),null)}_getPointerById(t){return this._pointerPositions.find(i=>i.id===t)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(t){t=t||{},t.x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();let i=new jm.SceneCanvas({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),n=i.getContext()._context,o=this.children;return(t.x||t.y)&&n.translate(-1*t.x,-1*t.y),o.forEach(function(s){if(!s.isVisible())return;let r=s._toKonvaCanvas(t);n.drawImage(r._canvas,t.x,t.y,r.getWidth()/r.getPixelRatio(),r.getHeight()/r.getPixelRatio())}),i}getIntersection(t){if(!t)return null;let i=this.children,n=i.length,o=n-1;for(let s=o;s>=0;s--){let r=i[s].getIntersection(t);if(r)return r}return null}_resizeDOM(){let t=this.width(),i=this.height();this.content&&(this.content.style.width=t+t3,this.content.style.height=i+t3),this.bufferCanvas.setSize(t,i),this.bufferHitCanvas.setSize(t,i),this.children.forEach(n=>{n.setSize({width:t,height:i}),n.draw()})}add(t,...i){if(arguments.length>1){for(let o=0;o<arguments.length;o++)this.add(arguments[o]);return this}super.add(t);let n=this.children.length;return n>LA&&un.Util.warn("The stage has "+n+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),t.setSize({width:this.width(),height:this.height()}),t.draw(),ut.Konva.isBrowser&&this.content.appendChild(t.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(t){return Kn.hasPointerCapture(t,this)}setPointerCapture(t){Kn.setPointerCapture(t,this)}releaseCapture(t){Kn.releaseCapture(t,this)}getLayers(){return this.children}_bindContentEvents(){ut.Konva.isBrowser&&_A.forEach(([t,i])=>{this.content.addEventListener(t,n=>{this[i](n)},{passive:!1})})}_pointerenter(t){this.setPointersPositions(t);let i=Nr(t.type);i&&this._fire(i.pointerenter,{evt:t,target:this,currentTarget:this})}_pointerover(t){this.setPointersPositions(t);let i=Nr(t.type);i&&this._fire(i.pointerover,{evt:t,target:this,currentTarget:this})}_getTargetShape(t){let i=this[t+"targetShape"];return i&&!i.getStage()&&(i=null),i}_pointerleave(t){let i=Nr(t.type),n=kl(t.type);if(!i)return;this.setPointersPositions(t);let o=this._getTargetShape(n),s=!(ut.Konva.isDragging()||ut.Konva.isTransforming())||ut.Konva.hitOnDragEnabled;o&&s?(o._fireAndBubble(i.pointerout,{evt:t}),o._fireAndBubble(i.pointerleave,{evt:t}),this._fire(i.pointerleave,{evt:t,target:this,currentTarget:this}),this[n+"targetShape"]=null):s&&(this._fire(i.pointerleave,{evt:t,target:this,currentTarget:this}),this._fire(i.pointerout,{evt:t,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(t){let i=Nr(t.type),n=kl(t.type);if(!i)return;this.setPointersPositions(t);let o=!1;this._changedPointerPositions.forEach(s=>{let r=this.getIntersection(s);if(Km.DD.justDragged=!1,ut.Konva["_"+n+"ListenClick"]=!0,!r||!r.isListening()){this[n+"ClickStartShape"]=void 0;return}ut.Konva.capturePointerEventsEnabled&&r.setPointerCapture(s.id),this[n+"ClickStartShape"]=r,r._fireAndBubble(i.pointerdown,{evt:t,pointerId:s.id}),o=!0;let a=t.type.indexOf("touch")>=0;r.preventDefault()&&t.cancelable&&a&&t.preventDefault()}),o||this._fire(i.pointerdown,{evt:t,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(t){let i=Nr(t.type),n=kl(t.type);if(!i||(ut.Konva.isDragging()&&Km.DD.node.preventDefault()&&t.cancelable&&t.preventDefault(),this.setPointersPositions(t),!(!(ut.Konva.isDragging()||ut.Konva.isTransforming())||ut.Konva.hitOnDragEnabled)))return;let s={},r=!1,a=this._getTargetShape(n);this._changedPointerPositions.forEach(l=>{let d=Kn.getCapturedShape(l.id)||this.getIntersection(l),c=l.id,u={evt:t,pointerId:c},h=a!==d;if(h&&a&&(a._fireAndBubble(i.pointerout,b({},u),d),a._fireAndBubble(i.pointerleave,b({},u),d)),d){if(s[d._id])return;s[d._id]=!0}d&&d.isListening()?(r=!0,h&&(d._fireAndBubble(i.pointerover,b({},u),a),d._fireAndBubble(i.pointerenter,b({},u),a),this[n+"targetShape"]=d),d._fireAndBubble(i.pointermove,b({},u))):a&&(this._fire(i.pointerover,{evt:t,target:this,currentTarget:this,pointerId:c}),this[n+"targetShape"]=null)}),r||this._fire(i.pointermove,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(t){let i=Nr(t.type),n=kl(t.type);if(!i)return;this.setPointersPositions(t);let o=this[n+"ClickStartShape"],s=this[n+"ClickEndShape"],r={},a=!1;this._changedPointerPositions.forEach(l=>{let d=Kn.getCapturedShape(l.id)||this.getIntersection(l);if(d){if(d.releaseCapture(l.id),r[d._id])return;r[d._id]=!0}let c=l.id,u={evt:t,pointerId:c},h=!1;ut.Konva["_"+n+"InDblClickWindow"]?(h=!0,clearTimeout(this[n+"DblTimeout"])):Km.DD.justDragged||(ut.Konva["_"+n+"InDblClickWindow"]=!0,clearTimeout(this[n+"DblTimeout"])),this[n+"DblTimeout"]=setTimeout(function(){ut.Konva["_"+n+"InDblClickWindow"]=!1},ut.Konva.dblClickWindow),d&&d.isListening()?(a=!0,this[n+"ClickEndShape"]=d,d._fireAndBubble(i.pointerup,b({},u)),ut.Konva["_"+n+"ListenClick"]&&o&&o===d&&(d._fireAndBubble(i.pointerclick,b({},u)),h&&s&&s===d&&d._fireAndBubble(i.pointerdblclick,b({},u)))):(this[n+"ClickEndShape"]=null,ut.Konva["_"+n+"ListenClick"]&&this._fire(i.pointerclick,{evt:t,target:this,currentTarget:this,pointerId:c}),h&&this._fire(i.pointerdblclick,{evt:t,target:this,currentTarget:this,pointerId:c}))}),a||this._fire(i.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),ut.Konva["_"+n+"ListenClick"]=!1,t.cancelable&&n!=="touch"&&n!=="pointer"&&t.preventDefault()}_contextmenu(t){this.setPointersPositions(t);let i=this.getIntersection(this.getPointerPosition());i&&i.isListening()?i._fireAndBubble(Xm,{evt:t}):this._fire(Xm,{evt:t,target:this,currentTarget:this})}_wheel(t){this.setPointersPositions(t);let i=this.getIntersection(this.getPointerPosition());i&&i.isListening()?i._fireAndBubble(Jm,{evt:t}):this._fire(Jm,{evt:t,target:this,currentTarget:this})}_pointercancel(t){this.setPointersPositions(t);let i=Kn.getCapturedShape(t.pointerId)||this.getIntersection(this.getPointerPosition());i&&i._fireAndBubble(Br,Kn.createEvent(t)),Kn.releaseCapture(t.pointerId)}_lostpointercapture(t){Kn.releaseCapture(t.pointerId)}setPointersPositions(t){let i=this._getContentPosition(),n=null,o=null;t=t||window.event,t.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(t.touches,s=>{this._pointerPositions.push({id:s.identifier,x:(s.clientX-i.left)/i.scaleX,y:(s.clientY-i.top)/i.scaleY})}),Array.prototype.forEach.call(t.changedTouches||t.touches,s=>{this._changedPointerPositions.push({id:s.identifier,x:(s.clientX-i.left)/i.scaleX,y:(s.clientY-i.top)/i.scaleY})})):(n=(t.clientX-i.left)/i.scaleX,o=(t.clientY-i.top)/i.scaleY,this.pointerPos={x:n,y:o},this._pointerPositions=[{x:n,y:o,id:un.Util._getFirstPointerId(t)}],this._changedPointerPositions=[{x:n,y:o,id:un.Util._getFirstPointerId(t)}])}_setPointerPosition(t){un.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};let t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new jm.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new jm.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!ut.Konva.isBrowser)return;let t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}cache(){return un.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(t){t.batchDraw()}),this}};hn.Stage=Hr;Hr.prototype.nodeType=FA;(0,DA._registerNode)(Hr);kA.Factory.addGetterSetter(Hr,"container");ut.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{hn.stages.forEach(e=>{e.batchDraw()})})});var wt=Z(Yn=>{"use strict";Object.defineProperty(Yn,"__esModule",{value:!0});Yn.Shape=Yn.shapes=void 0;var NA=we(),pn=it(),X=be(),p3=lt(),vt=Se(),BA=we(),Zm=$m(),g3="hasShadow",f3="shadowRGBA",m3="patternImage",C3="linearGradient",v3="radialGradient",Au;function e0(){return Au||(Au=pn.Util.createCanvasElement().getContext("2d"),Au)}Yn.shapes={};function HA(e){let t=this.attrs.fillRule;t?e.fill(t):e.fill()}function GA(e){e.stroke()}function VA(e){let t=this.attrs.fillRule;t?e.fill(t):e.fill()}function zA(e){e.stroke()}function WA(){this._clearCache(g3)}function UA(){this._clearCache(f3)}function qA(){this._clearCache(m3)}function $A(){this._clearCache(C3)}function jA(){this._clearCache(v3)}var U=class extends p3.Node{constructor(t){super(t);let i;for(;i=pn.Util.getRandomColor(),!(i&&!(i in Yn.shapes)););this.colorKey=i,Yn.shapes[i]=this}getContext(){return pn.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return pn.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(g3,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(m3,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){let i=e0().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(i&&i.setTransform){let n=new pn.Transform;n.translate(this.fillPatternX(),this.fillPatternY()),n.rotate(NA.Konva.getAngle(this.fillPatternRotation())),n.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),n.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());let o=n.getMatrix(),s=typeof DOMMatrix>"u"?{a:o[0],b:o[1],c:o[2],d:o[3],e:o[4],f:o[5]}:new DOMMatrix(o);i.setTransform(s)}return i}}_getLinearGradient(){return this._getCache(C3,this.__getLinearGradient)}__getLinearGradient(){let t=this.fillLinearGradientColorStops();if(t){let i=e0(),n=this.fillLinearGradientStartPoint(),o=this.fillLinearGradientEndPoint(),s=i.createLinearGradient(n.x,n.y,o.x,o.y);for(let r=0;r<t.length;r+=2)s.addColorStop(t[r],t[r+1]);return s}}_getRadialGradient(){return this._getCache(v3,this.__getRadialGradient)}__getRadialGradient(){let t=this.fillRadialGradientColorStops();if(t){let i=e0(),n=this.fillRadialGradientStartPoint(),o=this.fillRadialGradientEndPoint(),s=i.createRadialGradient(n.x,n.y,this.fillRadialGradientStartRadius(),o.x,o.y,this.fillRadialGradientEndRadius());for(let r=0;r<t.length;r+=2)s.addColorStop(t[r],t[r+1]);return s}}getShadowRGBA(){return this._getCache(f3,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;let t=pn.Util.colorToRGBA(this.shadowColor());if(t)return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){let t=this.hitStrokeWidth();return t==="auto"?this.hasStroke():this.strokeEnabled()&&!!t}intersects(t){let i=this.getStage();if(!i)return!1;let n=i.bufferHitCanvas;return n.getContext().clear(),this.drawHit(n,void 0,!0),n.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data[3]>0}destroy(){return p3.Node.prototype.destroy.call(this),delete Yn.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(t){var i;if(!((i=this.attrs.perfectDrawEnabled)!==null&&i!==void 0?i:!0))return!1;let o=t||this.hasFill(),s=this.hasStroke(),r=this.getAbsoluteOpacity()!==1;if(o&&s&&r)return!0;let a=this.hasShadow(),l=this.shadowForStrokeEnabled();return!!(o&&s&&a&&l)}setStrokeHitEnabled(t){pn.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){let t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}}getClientRect(t={}){let i=!1,n=this.getParent();for(;n;){if(n.isCached()){i=!0;break}n=n.getParent()}let o=t.skipTransform,s=t.relativeTo||i&&this.getStage()||void 0,r=this.getSelfRect(),l=!t.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,d=r.width+l,c=r.height+l,u=!t.skipShadow&&this.hasShadow(),h=u?this.shadowOffsetX():0,p=u?this.shadowOffsetY():0,g=d+Math.abs(h),f=c+Math.abs(p),m=u&&this.shadowBlur()||0,C=g+m*2,v=f+m*2,w={width:C,height:v,x:-(l/2+m)+Math.min(h,0)+r.x,y:-(l/2+m)+Math.min(p,0)+r.y};return o?w:this._transformedRect(w,s)}drawScene(t,i,n){let o=this.getLayer(),s=t||o.getCanvas(),r=s.getContext(),a=this._getCanvasCache(),l=this.getSceneFunc(),d=this.hasShadow(),c,u=!1,h=i===this;if(!this.isVisible()&&!h)return this;if(a){r.save();let p=this.getAbsoluteTransform(i).getMatrix();return r.transform(p[0],p[1],p[2],p[3],p[4],p[5]),this._drawCachedSceneCanvas(r),r.restore(),this}if(!l)return this;if(r.save(),this._useBufferCanvas()&&!u){c=this.getStage();let p=n||c.bufferCanvas,g=p.getContext();g.clear(),g.save(),g._applyLineJoin(this);let f=this.getAbsoluteTransform(i).getMatrix();g.transform(f[0],f[1],f[2],f[3],f[4],f[5]),l.call(this,g,this),g.restore();let m=p.pixelRatio;d&&r._applyShadow(this),r._applyOpacity(this),r._applyGlobalCompositeOperation(this),r.drawImage(p._canvas,p.x||0,p.y||0,p.width/m,p.height/m)}else{if(r._applyLineJoin(this),!h){let p=this.getAbsoluteTransform(i).getMatrix();r.transform(p[0],p[1],p[2],p[3],p[4],p[5]),r._applyOpacity(this),r._applyGlobalCompositeOperation(this)}d&&r._applyShadow(this),l.call(this,r,this)}return r.restore(),this}drawHit(t,i,n=!1){if(!this.shouldDrawHit(i,n))return this;let o=this.getLayer(),s=t||o.hitCanvas,r=s&&s.getContext(),a=this.hitFunc()||this.sceneFunc(),l=this._getCanvasCache(),d=l&&l.hit;if(this.colorKey||pn.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),d){r.save();let u=this.getAbsoluteTransform(i).getMatrix();return r.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedHitCanvas(r),r.restore(),this}if(!a)return this;if(r.save(),r._applyLineJoin(this),!(this===i)){let u=this.getAbsoluteTransform(i).getMatrix();r.transform(u[0],u[1],u[2],u[3],u[4],u[5])}return a.call(this,r,this),r.restore(),this}drawHitFromCache(t=0){let i=this._getCanvasCache(),n=this._getCachedSceneCanvas(),o=i.hit,s=o.getContext(),r=o.getWidth(),a=o.getHeight();s.clear(),s.drawImage(n._canvas,0,0,r,a);try{let l=s.getImageData(0,0,r,a),d=l.data,c=d.length,u=pn.Util._hexToRgb(this.colorKey);for(let h=0;h<c;h+=4)d[h+3]>t?(d[h]=u.r,d[h+1]=u.g,d[h+2]=u.b,d[h+3]=255):d[h+3]=0;s.putImageData(l,0,0)}catch(l){pn.Util.error("Unable to draw hit graph from cached scene canvas. "+l.message)}return this}hasPointerCapture(t){return Zm.hasPointerCapture(t,this)}setPointerCapture(t){Zm.setPointerCapture(t,this)}releaseCapture(t){Zm.releaseCapture(t,this)}};Yn.Shape=U;U.prototype._fillFunc=HA;U.prototype._strokeFunc=GA;U.prototype._fillFuncHit=VA;U.prototype._strokeFuncHit=zA;U.prototype._centroid=!1;U.prototype.nodeType="Shape";(0,BA._registerNode)(U);U.prototype.eventListeners={};U.prototype.on.call(U.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",WA);U.prototype.on.call(U.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",UA);U.prototype.on.call(U.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",qA);U.prototype.on.call(U.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",$A);U.prototype.on.call(U.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",jA);X.Factory.addGetterSetter(U,"stroke",void 0,(0,vt.getStringOrGradientValidator)());X.Factory.addGetterSetter(U,"strokeWidth",2,(0,vt.getNumberValidator)());X.Factory.addGetterSetter(U,"fillAfterStrokeEnabled",!1);X.Factory.addGetterSetter(U,"hitStrokeWidth","auto",(0,vt.getNumberOrAutoValidator)());X.Factory.addGetterSetter(U,"strokeHitEnabled",!0,(0,vt.getBooleanValidator)());X.Factory.addGetterSetter(U,"perfectDrawEnabled",!0,(0,vt.getBooleanValidator)());X.Factory.addGetterSetter(U,"shadowForStrokeEnabled",!0,(0,vt.getBooleanValidator)());X.Factory.addGetterSetter(U,"lineJoin");X.Factory.addGetterSetter(U,"lineCap");X.Factory.addGetterSetter(U,"sceneFunc");X.Factory.addGetterSetter(U,"hitFunc");X.Factory.addGetterSetter(U,"dash");X.Factory.addGetterSetter(U,"dashOffset",0,(0,vt.getNumberValidator)());X.Factory.addGetterSetter(U,"shadowColor",void 0,(0,vt.getStringValidator)());X.Factory.addGetterSetter(U,"shadowBlur",0,(0,vt.getNumberValidator)());X.Factory.addGetterSetter(U,"shadowOpacity",1,(0,vt.getNumberValidator)());X.Factory.addComponentsGetterSetter(U,"shadowOffset",["x","y"]);X.Factory.addGetterSetter(U,"shadowOffsetX",0,(0,vt.getNumberValidator)());X.Factory.addGetterSetter(U,"shadowOffsetY",0,(0,vt.getNumberValidator)());X.Factory.addGetterSetter(U,"fillPatternImage");X.Factory.addGetterSetter(U,"fill",void 0,(0,vt.getStringOrGradientValidator)());X.Factory.addGetterSetter(U,"fillPatternX",0,(0,vt.getNumberValidator)());X.Factory.addGetterSetter(U,"fillPatternY",0,(0,vt.getNumberValidator)());X.Factory.addGetterSetter(U,"fillLinearGradientColorStops");X.Factory.addGetterSetter(U,"strokeLinearGradientColorStops");X.Factory.addGetterSetter(U,"fillRadialGradientStartRadius",0);X.Factory.addGetterSetter(U,"fillRadialGradientEndRadius",0);X.Factory.addGetterSetter(U,"fillRadialGradientColorStops");X.Factory.addGetterSetter(U,"fillPatternRepeat","repeat");X.Factory.addGetterSetter(U,"fillEnabled",!0);X.Factory.addGetterSetter(U,"strokeEnabled",!0);X.Factory.addGetterSetter(U,"shadowEnabled",!0);X.Factory.addGetterSetter(U,"dashEnabled",!0);X.Factory.addGetterSetter(U,"strokeScaleEnabled",!0);X.Factory.addGetterSetter(U,"fillPriority","color");X.Factory.addComponentsGetterSetter(U,"fillPatternOffset",["x","y"]);X.Factory.addGetterSetter(U,"fillPatternOffsetX",0,(0,vt.getNumberValidator)());X.Factory.addGetterSetter(U,"fillPatternOffsetY",0,(0,vt.getNumberValidator)());X.Factory.addComponentsGetterSetter(U,"fillPatternScale",["x","y"]);X.Factory.addGetterSetter(U,"fillPatternScaleX",1,(0,vt.getNumberValidator)());X.Factory.addGetterSetter(U,"fillPatternScaleY",1,(0,vt.getNumberValidator)());X.Factory.addComponentsGetterSetter(U,"fillLinearGradientStartPoint",["x","y"]);X.Factory.addComponentsGetterSetter(U,"strokeLinearGradientStartPoint",["x","y"]);X.Factory.addGetterSetter(U,"fillLinearGradientStartPointX",0);X.Factory.addGetterSetter(U,"strokeLinearGradientStartPointX",0);X.Factory.addGetterSetter(U,"fillLinearGradientStartPointY",0);X.Factory.addGetterSetter(U,"strokeLinearGradientStartPointY",0);X.Factory.addComponentsGetterSetter(U,"fillLinearGradientEndPoint",["x","y"]);X.Factory.addComponentsGetterSetter(U,"strokeLinearGradientEndPoint",["x","y"]);X.Factory.addGetterSetter(U,"fillLinearGradientEndPointX",0);X.Factory.addGetterSetter(U,"strokeLinearGradientEndPointX",0);X.Factory.addGetterSetter(U,"fillLinearGradientEndPointY",0);X.Factory.addGetterSetter(U,"strokeLinearGradientEndPointY",0);X.Factory.addComponentsGetterSetter(U,"fillRadialGradientStartPoint",["x","y"]);X.Factory.addGetterSetter(U,"fillRadialGradientStartPointX",0);X.Factory.addGetterSetter(U,"fillRadialGradientStartPointY",0);X.Factory.addComponentsGetterSetter(U,"fillRadialGradientEndPoint",["x","y"]);X.Factory.addGetterSetter(U,"fillRadialGradientEndPointX",0);X.Factory.addGetterSetter(U,"fillRadialGradientEndPointY",0);X.Factory.addGetterSetter(U,"fillPatternRotation",0);X.Factory.addGetterSetter(U,"fillRule",void 0,(0,vt.getStringValidator)());X.Factory.backCompat(U,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})});var Lu=Z(Iu=>{"use strict";Object.defineProperty(Iu,"__esModule",{value:!0});Iu.Layer=void 0;var Xn=it(),t0=Sl(),Gr=lt(),i0=be(),w3=Cl(),KA=Se(),YA=wt(),XA=we(),JA="#",QA="beforeDraw",ZA="draw",b3=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],e7=b3.length,_o=class extends t0.Container{constructor(t){super(t),this.canvas=new w3.SceneCanvas,this.hitCanvas=new w3.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);let i=this.getStage();return i&&i.content&&(i.content.removeChild(this.getNativeCanvasElement()),t<i.children.length-1?i.content.insertBefore(this.getNativeCanvasElement(),i.children[t+1].getCanvas()._canvas):i.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){Gr.Node.prototype.moveToTop.call(this);let t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!Gr.Node.prototype.moveUp.call(this))return!1;let i=this.getStage();return!i||!i.content?!1:(i.content.removeChild(this.getNativeCanvasElement()),this.index<i.children.length-1?i.content.insertBefore(this.getNativeCanvasElement(),i.children[this.index+1].getCanvas()._canvas):i.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(Gr.Node.prototype.moveDown.call(this)){let t=this.getStage();if(t){let i=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),i[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(Gr.Node.prototype.moveToBottom.call(this)){let t=this.getStage();if(t){let i=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),i[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){let t=this.getNativeCanvasElement();return Gr.Node.prototype.remove.call(this),t&&t.parentNode&&Xn.Util._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:i}){return this.canvas.setSize(t,i),this.hitCanvas.setSize(t,i),this._setSmoothEnabled(),this}_validateAdd(t){let i=t.getType();i!=="Group"&&i!=="Shape"&&Xn.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t=t||{},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),Gr.Node.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){Xn.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){Xn.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,Xn.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;let i=1,n=!1;for(;;){for(let o=0;o<e7;o++){let s=b3[o],r=this._getIntersection({x:t.x+s.x*i,y:t.y+s.y*i}),a=r.shape;if(a)return a;if(n=!!r.antialiased,!r.antialiased)break}if(n)i+=1;else return null}}_getIntersection(t){let i=this.hitCanvas.pixelRatio,n=this.hitCanvas.context.getImageData(Math.round(t.x*i),Math.round(t.y*i),1,1).data,o=n[3];if(o===255){let s=Xn.Util._rgbToHex(n[0],n[1],n[2]),r=YA.shapes[JA+s];return r?{shape:r}:{antialiased:!0}}else if(o>0)return{antialiased:!0};return{}}drawScene(t,i,n){let o=this.getLayer(),s=t||o&&o.getCanvas();return this._fire(QA,{node:this}),this.clearBeforeDraw()&&s.getContext().clear(),t0.Container.prototype.drawScene.call(this,s,i,n),this._fire(ZA,{node:this}),this}drawHit(t,i){let n=this.getLayer(),o=t||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),t0.Container.prototype.drawHit.call(this,o,i),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){Xn.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return Xn.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;let t=this.parent;!!this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}destroy(){return Xn.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};Iu.Layer=_o;_o.prototype.nodeType="Layer";(0,XA._registerNode)(_o);i0.Factory.addGetterSetter(_o,"imageSmoothingEnabled",!0);i0.Factory.addGetterSetter(_o,"clearBeforeDraw",!0);i0.Factory.addGetterSetter(_o,"hitGraphEnabled",!0,(0,KA.getBooleanValidator)())});var y3=Z(_u=>{"use strict";Object.defineProperty(_u,"__esModule",{value:!0});_u.FastLayer=void 0;var t7=it(),i7=Lu(),n7=we(),Dl=class extends i7.Layer{constructor(t){super(t),this.listening(!1),t7.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};_u.FastLayer=Dl;Dl.prototype.nodeType="FastLayer";(0,n7._registerNode)(Dl)});var Tl=Z(Ou=>{"use strict";Object.defineProperty(Ou,"__esModule",{value:!0});Ou.Group=void 0;var o7=it(),s7=Sl(),r7=we(),Fl=class extends s7.Container{_validateAdd(t){let i=t.getType();i!=="Group"&&i!=="Shape"&&o7.Util.throw("You may only add groups and shapes to groups.")}};Ou.Group=Fl;Fl.prototype.nodeType="Group";(0,r7._registerNode)(Fl)});var Bu=Z(Nu=>{"use strict";Object.defineProperty(Nu,"__esModule",{value:!0});Nu.Animation=void 0;var n0=we(),S3=it(),o0=(function(){return n0.glob.performance&&n0.glob.performance.now?function(){return n0.glob.performance.now()}:function(){return new Date().getTime()}})(),Vr=class e{constructor(t,i){this.id=e.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:o0(),frameRate:0},this.func=t,this.setLayers(i)}setLayers(t){let i=[];return t&&(i=Array.isArray(t)?t:[t]),this.layers=i,this}getLayers(){return this.layers}addLayer(t){let i=this.layers,n=i.length;for(let o=0;o<n;o++)if(i[o]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){let i=e.animations,n=i.length;for(let o=0;o<n;o++)if(i[o].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=o0(),e._addAnimation(this),this}stop(){return e._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){let i=t.id,n=this.animations,o=n.length;for(let s=0;s<o;s++)if(n[s].id===i){this.animations.splice(s,1);break}}static _runFrames(){let t={},i=this.animations;for(let n=0;n<i.length;n++){let o=i[n],s=o.layers,r=o.func;o._updateFrameObject(o0());let a=s.length,l;if(r?l=r.call(o,o.frame)!==!1:l=!0,!!l)for(let d=0;d<a;d++){let c=s[d];c._id!==void 0&&(t[c._id]=c)}}for(let n in t)t.hasOwnProperty(n)&&t[n].batchDraw()}static _animationLoop(){let t=e;t.animations.length?(t._runFrames(),S3.Util.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,S3.Util.requestAnimFrame(this._animationLoop))}};Nu.Animation=Vr;Vr.animations=[];Vr.animIdCounter=0;Vr.animRunning=!1});var P3=Z(gn=>{"use strict";Object.defineProperty(gn,"__esModule",{value:!0});gn.Easings=gn.Tween=void 0;var Jn=it(),a7=Bu(),l7=lt(),d7=we(),c7={node:1,duration:1,easing:1,onFinish:1,yoyo:1},u7=1,x3=2,E3=3,R3=["fill","stroke","shadowColor"],h7=0,s0=class{constructor(t,i,n,o,s,r,a){this.prop=t,this.propFunc=i,this.begin=o,this._pos=o,this.duration=r,this._change=0,this.prevPos=0,this.yoyo=a,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=n,this._change=s-this.begin,this.pause()}fire(t){let i=this[t];i&&i()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t}getPosition(t){return t===void 0&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=x3,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=E3,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){let t=this.getTimer()-this._startTime;this.state===x3?this.setTime(t):this.state===E3&&this.setTime(this.duration-t)}pause(){this.state=u7,this.fire("onPause")}getTimer(){return new Date().getTime()}},zr=class e{constructor(t){let i=this,n=t.node,o=n._id,s=t.easing||gn.Easings.Linear,r=!!t.yoyo,a,l;typeof t.duration>"u"?a=.3:t.duration===0?a=.001:a=t.duration,this.node=n,this._id=h7++;let d=n.getLayer()||(n instanceof d7.Konva.Stage?n.getLayers():null);d||Jn.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new a7.Animation(function(){i.tween.onEnterFrame()},d),this.tween=new s0(l,function(c){i._tweenFunc(c)},s,0,1,a*1e3,r),this._addListeners(),e.attrs[o]||(e.attrs[o]={}),e.attrs[o][this._id]||(e.attrs[o][this._id]={}),e.tweens[o]||(e.tweens[o]={});for(l in t)c7[l]===void 0&&this._addAttr(l,t[l]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset,this.onUpdate=t.onUpdate}_addAttr(t,i){let n=this.node,o=n._id,s,r,a,l,d,c=e.tweens[o][t];c&&delete e.attrs[o][c][t];let u=n.getAttr(t);if(Jn.Util._isArray(i))if(s=[],r=Math.max(i.length,u.length),t==="points"&&i.length!==u.length&&(i.length>u.length?(l=u,u=Jn.Util._prepareArrayForTween(u,i,n.closed())):(a=i,i=Jn.Util._prepareArrayForTween(i,u,n.closed()))),t.indexOf("fill")===0)for(let h=0;h<r;h++)if(h%2===0)s.push(i[h]-u[h]);else{let p=Jn.Util.colorToRGBA(u[h]);d=Jn.Util.colorToRGBA(i[h]),u[h]=p,s.push({r:d.r-p.r,g:d.g-p.g,b:d.b-p.b,a:d.a-p.a})}else for(let h=0;h<r;h++)s.push(i[h]-u[h]);else R3.indexOf(t)!==-1?(u=Jn.Util.colorToRGBA(u),d=Jn.Util.colorToRGBA(i),s={r:d.r-u.r,g:d.g-u.g,b:d.b-u.b,a:d.a-u.a}):s=i-u;e.attrs[o][this._id][t]={start:u,diff:s,end:i,trueEnd:a,trueStart:l},e.tweens[o][t]=this._id}_tweenFunc(t){let i=this.node,n=e.attrs[i._id][this._id],o,s,r,a,l,d,c,u;for(o in n){if(s=n[o],r=s.start,a=s.diff,u=s.end,Jn.Util._isArray(r))if(l=[],c=Math.max(r.length,u.length),o.indexOf("fill")===0)for(d=0;d<c;d++)d%2===0?l.push((r[d]||0)+a[d]*t):l.push("rgba("+Math.round(r[d].r+a[d].r*t)+","+Math.round(r[d].g+a[d].g*t)+","+Math.round(r[d].b+a[d].b*t)+","+(r[d].a+a[d].a*t)+")");else for(d=0;d<c;d++)l.push((r[d]||0)+a[d]*t);else R3.indexOf(o)!==-1?l="rgba("+Math.round(r.r+a.r*t)+","+Math.round(r.g+a.g*t)+","+Math.round(r.b+a.b*t)+","+(r.a+a.a*t)+")":l=r+a*t;i.setAttr(o,l)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{let t=this.node,i=e.attrs[t._id][this._id];i.points&&i.points.trueEnd&&t.setAttr("points",i.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{let t=this.node,i=e.attrs[t._id][this._id];i.points&&i.points.trueStart&&t.points(i.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(t*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){let t=this.node._id,i=this._id,n=e.tweens[t];this.pause(),this.anim&&this.anim.stop();for(let o in n)delete e.tweens[t][o];delete e.attrs[t][i],e.tweens[t]&&(Object.keys(e.tweens[t]).length===0&&delete e.tweens[t],Object.keys(e.attrs[t]).length===0&&delete e.attrs[t])}};gn.Tween=zr;zr.attrs={};zr.tweens={};l7.Node.prototype.to=function(e){let t=e.onFinish;e.node=this,e.onFinish=function(){this.destroy(),t&&t()},new zr(e).play()};gn.Easings={BackEaseIn(e,t,i,n){return i*(e/=n)*e*((1.70158+1)*e-1.70158)+t},BackEaseOut(e,t,i,n){return i*((e=e/n-1)*e*((1.70158+1)*e+1.70158)+1)+t},BackEaseInOut(e,t,i,n){let o=1.70158;return(e/=n/2)<1?i/2*(e*e*(((o*=1.525)+1)*e-o))+t:i/2*((e-=2)*e*(((o*=1.525)+1)*e+o)+2)+t},ElasticEaseIn(e,t,i,n,o,s){let r=0;return e===0?t:(e/=n)===1?t+i:(s||(s=n*.3),!o||o<Math.abs(i)?(o=i,r=s/4):r=s/(2*Math.PI)*Math.asin(i/o),-(o*Math.pow(2,10*(e-=1))*Math.sin((e*n-r)*(2*Math.PI)/s))+t)},ElasticEaseOut(e,t,i,n,o,s){let r=0;return e===0?t:(e/=n)===1?t+i:(s||(s=n*.3),!o||o<Math.abs(i)?(o=i,r=s/4):r=s/(2*Math.PI)*Math.asin(i/o),o*Math.pow(2,-10*e)*Math.sin((e*n-r)*(2*Math.PI)/s)+i+t)},ElasticEaseInOut(e,t,i,n,o,s){let r=0;return e===0?t:(e/=n/2)===2?t+i:(s||(s=n*(.3*1.5)),!o||o<Math.abs(i)?(o=i,r=s/4):r=s/(2*Math.PI)*Math.asin(i/o),e<1?-.5*(o*Math.pow(2,10*(e-=1))*Math.sin((e*n-r)*(2*Math.PI)/s))+t:o*Math.pow(2,-10*(e-=1))*Math.sin((e*n-r)*(2*Math.PI)/s)*.5+i+t)},BounceEaseOut(e,t,i,n){return(e/=n)<1/2.75?i*(7.5625*e*e)+t:e<2/2.75?i*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?i*(7.5625*(e-=2.25/2.75)*e+.9375)+t:i*(7.5625*(e-=2.625/2.75)*e+.984375)+t},BounceEaseIn(e,t,i,n){return i-gn.Easings.BounceEaseOut(n-e,0,i,n)+t},BounceEaseInOut(e,t,i,n){return e<n/2?gn.Easings.BounceEaseIn(e*2,0,i,n)*.5+t:gn.Easings.BounceEaseOut(e*2-n,0,i,n)*.5+i*.5+t},EaseIn(e,t,i,n){return i*(e/=n)*e+t},EaseOut(e,t,i,n){return-i*(e/=n)*(e-2)+t},EaseInOut(e,t,i,n){return(e/=n/2)<1?i/2*e*e+t:-i/2*(--e*(e-2)-1)+t},StrongEaseIn(e,t,i,n){return i*(e/=n)*e*e*e*e+t},StrongEaseOut(e,t,i,n){return i*((e=e/n-1)*e*e*e*e+1)+t},StrongEaseInOut(e,t,i,n){return(e/=n/2)<1?i/2*e*e*e*e*e+t:i/2*((e-=2)*e*e*e*e+2)+t},Linear(e,t,i,n){return i*e/n+t}}});var F3=Z(Wr=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});Wr.Konva=void 0;var p7=we(),r0=it(),g7=lt(),f7=Sl(),M3=Qm(),m7=Lu(),C7=y3(),v7=Tl(),w7=Su(),k3=wt(),b7=Bu(),D3=P3(),y7=Hm(),S7=Cl();Wr.Konva=r0.Util._assign(p7.Konva,{Util:r0.Util,Transform:r0.Transform,Node:g7.Node,Container:f7.Container,Stage:M3.Stage,stages:M3.stages,Layer:m7.Layer,FastLayer:C7.FastLayer,Group:v7.Group,DD:w7.DD,Shape:k3.Shape,shapes:k3.shapes,Animation:b7.Animation,Tween:D3.Tween,Easings:D3.Easings,Context:y7.Context,Canvas:S7.Canvas});Wr.default=Wr.Konva});var A3=Z(Vu=>{"use strict";Object.defineProperty(Vu,"__esModule",{value:!0});Vu.Arc=void 0;var Hu=be(),x7=wt(),T3=we(),Gu=Se(),E7=we(),Wi=class extends x7.Shape{_sceneFunc(t){let i=T3.Konva.getAngle(this.angle()),n=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,i,n),t.arc(0,0,this.innerRadius(),i,0,!n),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){let t=this.innerRadius(),i=this.outerRadius(),n=this.clockwise(),o=T3.Konva.getAngle(n?360-this.angle():this.angle()),s=Math.cos(Math.min(o,Math.PI)),r=1,a=Math.sin(Math.min(Math.max(Math.PI,o),3*Math.PI/2)),l=Math.sin(Math.min(o,Math.PI/2)),d=s*(s>0?t:i),c=r*(r>0?i:t),u=a*(a>0?t:i),h=l*(l>0?i:t);return{x:d,y:n?-1*h:u,width:c-d,height:h-u}}};Vu.Arc=Wi;Wi.prototype._centroid=!0;Wi.prototype.className="Arc";Wi.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];(0,E7._registerNode)(Wi);Hu.Factory.addGetterSetter(Wi,"innerRadius",0,(0,Gu.getNumberValidator)());Hu.Factory.addGetterSetter(Wi,"outerRadius",0,(0,Gu.getNumberValidator)());Hu.Factory.addGetterSetter(Wi,"angle",0,(0,Gu.getNumberValidator)());Hu.Factory.addGetterSetter(Wi,"clockwise",!1,(0,Gu.getBooleanValidator)())});var l0=Z(Wu=>{"use strict";Object.defineProperty(Wu,"__esModule",{value:!0});Wu.Line=void 0;var zu=be(),R7=we(),P7=wt(),L3=Se();function a0(e,t,i,n,o,s,r){let a=Math.sqrt(Math.pow(i-e,2)+Math.pow(n-t,2)),l=Math.sqrt(Math.pow(o-i,2)+Math.pow(s-n,2)),d=r*a/(a+l),c=r*l/(a+l),u=i-d*(o-e),h=n-d*(s-t),p=i+c*(o-e),g=n+c*(s-t);return[u,h,p,g]}function I3(e,t){let i=e.length,n=[];for(let o=2;o<i-2;o+=2){let s=a0(e[o-2],e[o-1],e[o],e[o+1],e[o+2],e[o+3],t);isNaN(s[0])||(n.push(s[0]),n.push(s[1]),n.push(e[o]),n.push(e[o+1]),n.push(s[2]),n.push(s[3]))}return n}var fn=class extends P7.Shape{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){let i=this.points(),n=i.length,o=this.tension(),s=this.closed(),r=this.bezier();if(!n)return;let a=0;if(t.beginPath(),t.moveTo(i[0],i[1]),o!==0&&n>4){let l=this.getTensionPoints(),d=l.length;for(a=s?0:4,s||t.quadraticCurveTo(l[0],l[1],l[2],l[3]);a<d-2;)t.bezierCurveTo(l[a++],l[a++],l[a++],l[a++],l[a++],l[a++]);s||t.quadraticCurveTo(l[d-2],l[d-1],i[n-2],i[n-1])}else if(r)for(a=2;a<n;)t.bezierCurveTo(i[a++],i[a++],i[a++],i[a++],i[a++],i[a++]);else for(a=2;a<n;a+=2)t.lineTo(i[a],i[a+1]);s?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():I3(this.points(),this.tension())}_getTensionPointsClosed(){let t=this.points(),i=t.length,n=this.tension(),o=a0(t[i-2],t[i-1],t[0],t[1],t[2],t[3],n),s=a0(t[i-4],t[i-3],t[i-2],t[i-1],t[0],t[1],n),r=I3(t,n);return[o[2],o[3]].concat(r).concat([s[0],s[1],t[i-2],t[i-1],s[2],s[3],o[0],o[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:t=this.points();let i=t[0],n=t[0],o=t[1],s=t[1],r,a;for(let l=0;l<t.length/2;l++)r=t[l*2],a=t[l*2+1],i=Math.min(i,r),n=Math.max(n,r),o=Math.min(o,a),s=Math.max(s,a);return{x:i,y:o,width:n-i,height:s-o}}};Wu.Line=fn;fn.prototype.className="Line";fn.prototype._attrsAffectingSize=["points","bezier","tension"];(0,R7._registerNode)(fn);zu.Factory.addGetterSetter(fn,"closed",!1);zu.Factory.addGetterSetter(fn,"bezier",!1);zu.Factory.addGetterSetter(fn,"tension",0,(0,L3.getNumberValidator)());zu.Factory.addGetterSetter(fn,"points",[],(0,L3.getNumberArrayValidator)())});var _3=Z(Lt=>{"use strict";Object.defineProperty(Lt,"__esModule",{value:!0});Lt.t2length=Lt.getQuadraticArcLength=Lt.getCubicArcLength=Lt.binomialCoefficients=Lt.cValues=Lt.tValues=void 0;Lt.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]];Lt.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]];Lt.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];var M7=(e,t,i)=>{let n,o,r=i/2;n=0;for(let a=0;a<20;a++)o=r*Lt.tValues[20][a]+r,n+=Lt.cValues[20][a]*D7(e,t,o);return r*n};Lt.getCubicArcLength=M7;var k7=(e,t,i)=>{i===void 0&&(i=1);let n=e[0]-2*e[1]+e[2],o=t[0]-2*t[1]+t[2],s=2*e[1]-2*e[0],r=2*t[1]-2*t[0],a=4*(n*n+o*o),l=4*(n*s+o*r),d=s*s+r*r;if(a===0)return i*Math.sqrt(Math.pow(e[2]-e[0],2)+Math.pow(t[2]-t[0],2));let c=l/(2*a),u=d/a,h=i+c,p=u-c*c,g=h*h+p>0?Math.sqrt(h*h+p):0,f=c*c+p>0?Math.sqrt(c*c+p):0,m=c+Math.sqrt(c*c+p)!==0?p*Math.log(Math.abs((h+g)/(c+f))):0;return Math.sqrt(a)/2*(h*g-c*f+m)};Lt.getQuadraticArcLength=k7;function D7(e,t,i){let n=d0(1,i,e),o=d0(1,i,t),s=n*n+o*o;return Math.sqrt(s)}var d0=(e,t,i)=>{let n=i.length-1,o,s;if(n===0)return 0;if(e===0){s=0;for(let r=0;r<=n;r++)s+=Lt.binomialCoefficients[n][r]*Math.pow(1-t,n-r)*Math.pow(t,r)*i[r];return s}else{o=new Array(n);for(let r=0;r<n;r++)o[r]=n*(i[r+1]-i[r]);return d0(e-1,t,o)}},F7=(e,t,i)=>{let n=1,o=e/t,s=(e-i(o))/t,r=0;for(;n>.001;){let a=i(o+s),l=Math.abs(e-a)/t;if(l<n)n=l,o+=s;else{let d=i(o-s),c=Math.abs(e-d)/t;c<n?(n=c,o-=s):s/=2}if(r++,r>500)break}return o};Lt.t2length=F7});var qu=Z(Uu=>{"use strict";Object.defineProperty(Uu,"__esModule",{value:!0});Uu.Path=void 0;var T7=be(),A7=we(),I7=wt(),Ur=_3(),As=class e extends I7.Shape{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=e.parsePathData(this.data()),this.pathLength=e.getPathLength(this.dataArray)}_sceneFunc(t){let i=this.dataArray;t.beginPath();let n=!1;for(let o=0;o<i.length;o++){let s=i[o].command,r=i[o].points;switch(s){case"L":t.lineTo(r[0],r[1]);break;case"M":t.moveTo(r[0],r[1]);break;case"C":t.bezierCurveTo(r[0],r[1],r[2],r[3],r[4],r[5]);break;case"Q":t.quadraticCurveTo(r[0],r[1],r[2],r[3]);break;case"A":let a=r[0],l=r[1],d=r[2],c=r[3],u=r[4],h=r[5],p=r[6],g=r[7],f=d>c?d:c,m=d>c?1:d/c,C=d>c?c/d:1;t.translate(a,l),t.rotate(p),t.scale(m,C),t.arc(0,0,f,u,u+h,1-g),t.scale(1/m,1/C),t.rotate(-p),t.translate(-a,-l);break;case"z":n=!0,t.closePath();break}}!n&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){let t=[];this.dataArray.forEach(function(l){if(l.command==="A"){let d=l.points[4],c=l.points[5],u=l.points[4]+c,h=Math.PI/180;if(Math.abs(d-u)<h&&(h=Math.abs(d-u)),c<0)for(let p=d-h;p>u;p-=h){let g=e.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],p,0);t.push(g.x,g.y)}else for(let p=d+h;p<u;p+=h){let g=e.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],p,0);t.push(g.x,g.y)}}else if(l.command==="C")for(let d=0;d<=1;d+=.01){let c=e.getPointOnCubicBezier(d,l.start.x,l.start.y,l.points[0],l.points[1],l.points[2],l.points[3],l.points[4],l.points[5]);t.push(c.x,c.y)}else t=t.concat(l.points)});let i=t[0],n=t[0],o=t[1],s=t[1],r,a;for(let l=0;l<t.length/2;l++)r=t[l*2],a=t[l*2+1],isNaN(r)||(i=Math.min(i,r),n=Math.max(n,r)),isNaN(a)||(o=Math.min(o,a),s=Math.max(s,a));return{x:i,y:o,width:n-i,height:s-o}}getLength(){return this.pathLength}getPointAtLength(t){return e.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,i,n,o){return Math.sqrt((n-t)*(n-t)+(o-i)*(o-i))}static getPathLength(t){let i=0;for(let n=0;n<t.length;++n)i+=t[n].pathLength;return i}static getPointAtLengthOfDataArray(t,i){let n,o=0,s=i.length;if(!s)return null;for(;o<s&&t>i[o].pathLength;)t-=i[o].pathLength,++o;if(o===s)return n=i[o-1].points.slice(-2),{x:n[0],y:n[1]};if(t<.01)return i[o].command==="M"?(n=i[o].points.slice(0,2),{x:n[0],y:n[1]}):{x:i[o].start.x,y:i[o].start.y};let r=i[o],a=r.points;switch(r.command){case"L":return e.getPointOnLine(t,r.start.x,r.start.y,a[0],a[1]);case"C":return e.getPointOnCubicBezier((0,Ur.t2length)(t,e.getPathLength(i),f=>(0,Ur.getCubicArcLength)([r.start.x,a[0],a[2],a[4]],[r.start.y,a[1],a[3],a[5]],f)),r.start.x,r.start.y,a[0],a[1],a[2],a[3],a[4],a[5]);case"Q":return e.getPointOnQuadraticBezier((0,Ur.t2length)(t,e.getPathLength(i),f=>(0,Ur.getQuadraticArcLength)([r.start.x,a[0],a[2]],[r.start.y,a[1],a[3]],f)),r.start.x,r.start.y,a[0],a[1],a[2],a[3]);case"A":let l=a[0],d=a[1],c=a[2],u=a[3],h=a[5],p=a[6],g=a[4];return g+=h*t/r.pathLength,e.getPointOnEllipticalArc(l,d,c,u,g,p)}return null}static getPointOnLine(t,i,n,o,s,r,a){r=r??i,a=a??n;let l=this.getLineLength(i,n,o,s);if(l<1e-10)return{x:i,y:n};if(o===i)return{x:r,y:a+(s>n?t:-t)};let d=(s-n)/(o-i),c=Math.sqrt(t*t/(1+d*d))*(o<i?-1:1),u=d*c;if(Math.abs(a-n-d*(r-i))<1e-10)return{x:r+c,y:a+u};let h=((r-i)*(o-i)+(a-n)*(s-n))/(l*l),p=i+h*(o-i),g=n+h*(s-n),f=this.getLineLength(r,a,p,g),m=Math.sqrt(t*t-f*f),C=Math.sqrt(m*m/(1+d*d))*(o<i?-1:1),v=d*C;return{x:p+C,y:g+v}}static getPointOnCubicBezier(t,i,n,o,s,r,a,l,d){function c(m){return m*m*m}function u(m){return 3*m*m*(1-m)}function h(m){return 3*m*(1-m)*(1-m)}function p(m){return(1-m)*(1-m)*(1-m)}let g=l*c(t)+r*u(t)+o*h(t)+i*p(t),f=d*c(t)+a*u(t)+s*h(t)+n*p(t);return{x:g,y:f}}static getPointOnQuadraticBezier(t,i,n,o,s,r,a){function l(p){return p*p}function d(p){return 2*p*(1-p)}function c(p){return(1-p)*(1-p)}let u=r*l(t)+o*d(t)+i*c(t),h=a*l(t)+s*d(t)+n*c(t);return{x:u,y:h}}static getPointOnEllipticalArc(t,i,n,o,s,r){let a=Math.cos(r),l=Math.sin(r),d={x:n*Math.cos(s),y:o*Math.sin(s)};return{x:t+(d.x*a-d.y*l),y:i+(d.x*l+d.y*a)}}static parsePathData(t){if(!t)return[];let i=t,n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];i=i.replace(new RegExp(" ","g"),",");for(let u=0;u<n.length;u++)i=i.replace(new RegExp(n[u],"g"),"|"+n[u]);let o=i.split("|"),s=[],r=[],a=0,l=0,d=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,c;for(let u=1;u<o.length;u++){let h=o[u],p=h.charAt(0);for(h=h.slice(1),r.length=0;c=d.exec(h);)r.push(c[0]);let g=[];for(let f=0,m=r.length;f<m;f++){if(r[f]==="00"){g.push(0,0);continue}let C=parseFloat(r[f]);isNaN(C)?g.push(0):g.push(C)}for(;g.length>0&&!isNaN(g[0]);){let f="",m=[],C=a,v=l,w,y,S,x,E,T,L,O,W,G;switch(p){case"l":a+=g.shift(),l+=g.shift(),f="L",m.push(a,l);break;case"L":a=g.shift(),l=g.shift(),m.push(a,l);break;case"m":let Q=g.shift(),ge=g.shift();if(a+=Q,l+=ge,f="M",s.length>2&&s[s.length-1].command==="z"){for(let pe=s.length-2;pe>=0;pe--)if(s[pe].command==="M"){a=s[pe].points[0]+Q,l=s[pe].points[1]+ge;break}}m.push(a,l),p="l";break;case"M":a=g.shift(),l=g.shift(),f="M",m.push(a,l),p="L";break;case"h":a+=g.shift(),f="L",m.push(a,l);break;case"H":a=g.shift(),f="L",m.push(a,l);break;case"v":l+=g.shift(),f="L",m.push(a,l);break;case"V":l=g.shift(),f="L",m.push(a,l);break;case"C":m.push(g.shift(),g.shift(),g.shift(),g.shift()),a=g.shift(),l=g.shift(),m.push(a,l);break;case"c":m.push(a+g.shift(),l+g.shift(),a+g.shift(),l+g.shift()),a+=g.shift(),l+=g.shift(),f="C",m.push(a,l);break;case"S":y=a,S=l,w=s[s.length-1],w.command==="C"&&(y=a+(a-w.points[2]),S=l+(l-w.points[3])),m.push(y,S,g.shift(),g.shift()),a=g.shift(),l=g.shift(),f="C",m.push(a,l);break;case"s":y=a,S=l,w=s[s.length-1],w.command==="C"&&(y=a+(a-w.points[2]),S=l+(l-w.points[3])),m.push(y,S,a+g.shift(),l+g.shift()),a+=g.shift(),l+=g.shift(),f="C",m.push(a,l);break;case"Q":m.push(g.shift(),g.shift()),a=g.shift(),l=g.shift(),m.push(a,l);break;case"q":m.push(a+g.shift(),l+g.shift()),a+=g.shift(),l+=g.shift(),f="Q",m.push(a,l);break;case"T":y=a,S=l,w=s[s.length-1],w.command==="Q"&&(y=a+(a-w.points[0]),S=l+(l-w.points[1])),a=g.shift(),l=g.shift(),f="Q",m.push(y,S,a,l);break;case"t":y=a,S=l,w=s[s.length-1],w.command==="Q"&&(y=a+(a-w.points[0]),S=l+(l-w.points[1])),a+=g.shift(),l+=g.shift(),f="Q",m.push(y,S,a,l);break;case"A":x=g.shift(),E=g.shift(),T=g.shift(),L=g.shift(),O=g.shift(),W=a,G=l,a=g.shift(),l=g.shift(),f="A",m=this.convertEndpointToCenterParameterization(W,G,a,l,L,O,x,E,T);break;case"a":x=g.shift(),E=g.shift(),T=g.shift(),L=g.shift(),O=g.shift(),W=a,G=l,a+=g.shift(),l+=g.shift(),f="A",m=this.convertEndpointToCenterParameterization(W,G,a,l,L,O,x,E,T);break}s.push({command:f||p,points:m,start:{x:C,y:v},pathLength:this.calcLength(C,v,f||p,m)})}(p==="z"||p==="Z")&&s.push({command:"z",points:[],start:void 0,pathLength:0})}return s}static calcLength(t,i,n,o){let s,r,a,l,d=e;switch(n){case"L":return d.getLineLength(t,i,o[0],o[1]);case"C":return(0,Ur.getCubicArcLength)([t,o[0],o[2],o[4]],[i,o[1],o[3],o[5]],1);case"Q":return(0,Ur.getQuadraticArcLength)([t,o[0],o[2]],[i,o[1],o[3]],1);case"A":s=0;let c=o[4],u=o[5],h=o[4]+u,p=Math.PI/180;if(Math.abs(c-h)<p&&(p=Math.abs(c-h)),r=d.getPointOnEllipticalArc(o[0],o[1],o[2],o[3],c,0),u<0)for(l=c-p;l>h;l-=p)a=d.getPointOnEllipticalArc(o[0],o[1],o[2],o[3],l,0),s+=d.getLineLength(r.x,r.y,a.x,a.y),r=a;else for(l=c+p;l<h;l+=p)a=d.getPointOnEllipticalArc(o[0],o[1],o[2],o[3],l,0),s+=d.getLineLength(r.x,r.y,a.x,a.y),r=a;return a=d.getPointOnEllipticalArc(o[0],o[1],o[2],o[3],h,0),s+=d.getLineLength(r.x,r.y,a.x,a.y),s}return 0}static convertEndpointToCenterParameterization(t,i,n,o,s,r,a,l,d){let c=d*(Math.PI/180),u=Math.cos(c)*(t-n)/2+Math.sin(c)*(i-o)/2,h=-1*Math.sin(c)*(t-n)/2+Math.cos(c)*(i-o)/2,p=u*u/(a*a)+h*h/(l*l);p>1&&(a*=Math.sqrt(p),l*=Math.sqrt(p));let g=Math.sqrt((a*a*(l*l)-a*a*(h*h)-l*l*(u*u))/(a*a*(h*h)+l*l*(u*u)));s===r&&(g*=-1),isNaN(g)&&(g=0);let f=g*a*h/l,m=g*-l*u/a,C=(t+n)/2+Math.cos(c)*f-Math.sin(c)*m,v=(i+o)/2+Math.sin(c)*f+Math.cos(c)*m,w=function(O){return Math.sqrt(O[0]*O[0]+O[1]*O[1])},y=function(O,W){return(O[0]*W[0]+O[1]*W[1])/(w(O)*w(W))},S=function(O,W){return(O[0]*W[1]<O[1]*W[0]?-1:1)*Math.acos(y(O,W))},x=S([1,0],[(u-f)/a,(h-m)/l]),E=[(u-f)/a,(h-m)/l],T=[(-1*u-f)/a,(-1*h-m)/l],L=S(E,T);return y(E,T)<=-1&&(L=Math.PI),y(E,T)>=1&&(L=0),r===0&&L>0&&(L=L-2*Math.PI),r===1&&L<0&&(L=L+2*Math.PI),[C,v,a,l,x,L,c,r]}};Uu.Path=As;As.prototype.className="Path";As.prototype._attrsAffectingSize=["data"];(0,A7._registerNode)(As);T7.Factory.addGetterSetter(As,"data")});var B3=Z(ju=>{"use strict";Object.defineProperty(ju,"__esModule",{value:!0});ju.Arrow=void 0;var $u=be(),L7=l0(),N3=Se(),_7=we(),O3=qu(),Qn=class extends L7.Line{_sceneFunc(t){super._sceneFunc(t);let i=Math.PI*2,n=this.points(),o=n,s=this.tension()!==0&&n.length>4;s&&(o=this.getTensionPoints());let r=this.pointerLength(),a=n.length,l,d;if(s){let h=[o[o.length-4],o[o.length-3],o[o.length-2],o[o.length-1],n[a-2],n[a-1]],p=O3.Path.calcLength(o[o.length-4],o[o.length-3],"C",h),g=O3.Path.getPointOnQuadraticBezier(Math.min(1,1-r/p),h[0],h[1],h[2],h[3],h[4],h[5]);l=n[a-2]-g.x,d=n[a-1]-g.y}else l=n[a-2]-n[a-4],d=n[a-1]-n[a-3];let c=(Math.atan2(d,l)+i)%i,u=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(n[a-2],n[a-1]),t.rotate(c),t.moveTo(0,0),t.lineTo(-r,u/2),t.lineTo(-r,-u/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(n[0],n[1]),s?(l=(o[0]+o[2])/2-n[0],d=(o[1]+o[3])/2-n[1]):(l=n[2]-n[0],d=n[3]-n[1]),t.rotate((Math.atan2(-d,-l)+i)%i),t.moveTo(0,0),t.lineTo(-r,u/2),t.lineTo(-r,-u/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){let i=this.dashEnabled();i&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),i&&(this.attrs.dashEnabled=!0)}getSelfRect(){let t=super.getSelfRect(),i=this.pointerWidth()/2;return{x:t.x,y:t.y-i,width:t.width,height:t.height+i*2}}};ju.Arrow=Qn;Qn.prototype.className="Arrow";(0,_7._registerNode)(Qn);$u.Factory.addGetterSetter(Qn,"pointerLength",10,(0,N3.getNumberValidator)());$u.Factory.addGetterSetter(Qn,"pointerWidth",10,(0,N3.getNumberValidator)());$u.Factory.addGetterSetter(Qn,"pointerAtBeginning",!1);$u.Factory.addGetterSetter(Qn,"pointerAtEnding",!0)});var H3=Z(Ku=>{"use strict";Object.defineProperty(Ku,"__esModule",{value:!0});Ku.Circle=void 0;var O7=be(),N7=wt(),B7=Se(),H7=we(),Oo=class extends N7.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}};Ku.Circle=Oo;Oo.prototype._centroid=!0;Oo.prototype.className="Circle";Oo.prototype._attrsAffectingSize=["radius"];(0,H7._registerNode)(Oo);O7.Factory.addGetterSetter(Oo,"radius",0,(0,B7.getNumberValidator)())});var V3=Z(Yu=>{"use strict";Object.defineProperty(Yu,"__esModule",{value:!0});Yu.Ellipse=void 0;var c0=be(),G7=wt(),G3=Se(),V7=we(),mn=class extends G7.Shape{_sceneFunc(t){let i=this.radiusX(),n=this.radiusY();t.beginPath(),t.save(),i!==n&&t.scale(1,n/i),t.arc(0,0,i,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}};Yu.Ellipse=mn;mn.prototype.className="Ellipse";mn.prototype._centroid=!0;mn.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,V7._registerNode)(mn);c0.Factory.addComponentsGetterSetter(mn,"radius",["x","y"]);c0.Factory.addGetterSetter(mn,"radiusX",0,(0,G3.getNumberValidator)());c0.Factory.addGetterSetter(mn,"radiusY",0,(0,G3.getNumberValidator)())});var z3=Z(Xu=>{"use strict";Object.defineProperty(Xu,"__esModule",{value:!0});Xu.Image=void 0;var u0=it(),Is=be(),z7=wt(),W7=we(),Al=Se(),Ii=class e extends z7.Shape{constructor(t){super(t),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",i=>{this._removeImageLoad(i.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){let t=this.image();t&&t.complete||t&&t.readyState===4||t&&t.addEventListener&&t.addEventListener("load",this._loadListener)}_removeImageLoad(t){t&&t.removeEventListener&&t.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){let t=!!this.cornerRadius(),i=this.hasShadow();return t&&i?!0:super._useBufferCanvas(!0)}_sceneFunc(t){let i=this.getWidth(),n=this.getHeight(),o=this.cornerRadius(),s=this.attrs.image,r;if(s){let a=this.attrs.cropWidth,l=this.attrs.cropHeight;a&&l?r=[s,this.cropX(),this.cropY(),a,l,0,0,i,n]:r=[s,0,0,i,n]}(this.hasFill()||this.hasStroke()||o)&&(t.beginPath(),o?u0.Util.drawRoundedRectPath(t,i,n,o):t.rect(0,0,i,n),t.closePath(),t.fillStrokeShape(this)),s&&(o&&t.clip(),t.drawImage.apply(t,r))}_hitFunc(t){let i=this.width(),n=this.height(),o=this.cornerRadius();t.beginPath(),o?u0.Util.drawRoundedRectPath(t,i,n,o):t.rect(0,0,i,n),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,i;return(t=this.attrs.width)!==null&&t!==void 0?t:(i=this.image())===null||i===void 0?void 0:i.width}getHeight(){var t,i;return(t=this.attrs.height)!==null&&t!==void 0?t:(i=this.image())===null||i===void 0?void 0:i.height}static fromURL(t,i,n=null){let o=u0.Util.createImageElement();o.onload=function(){let s=new e({image:o});i(s)},o.onerror=n,o.crossOrigin="Anonymous",o.src=t}};Xu.Image=Ii;Ii.prototype.className="Image";(0,W7._registerNode)(Ii);Is.Factory.addGetterSetter(Ii,"cornerRadius",0,(0,Al.getNumberOrArrayOfNumbersValidator)(4));Is.Factory.addGetterSetter(Ii,"image");Is.Factory.addComponentsGetterSetter(Ii,"crop",["x","y","width","height"]);Is.Factory.addGetterSetter(Ii,"cropX",0,(0,Al.getNumberValidator)());Is.Factory.addGetterSetter(Ii,"cropY",0,(0,Al.getNumberValidator)());Is.Factory.addGetterSetter(Ii,"cropWidth",0,(0,Al.getNumberValidator)());Is.Factory.addGetterSetter(Ii,"cropHeight",0,(0,Al.getNumberValidator)())});var q3=Z(qr=>{"use strict";Object.defineProperty(qr,"__esModule",{value:!0});qr.Tag=qr.Label=void 0;var Ju=be(),U7=wt(),q7=Tl(),m0=Se(),W3=we(),U3=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],$7="Change.konva",j7="none",h0="up",p0="right",g0="down",f0="left",K7=U3.length,Il=class extends q7.Group{constructor(t){super(t),this.on("add.konva",function(i){this._addListeners(i.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){let i=this,n,o=function(){i._sync()};for(n=0;n<K7;n++)t.on(U3[n]+$7,o)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let t=this.getText(),i=this.getTag(),n,o,s,r,a,l,d;if(t&&i){switch(n=t.width(),o=t.height(),s=i.pointerDirection(),r=i.pointerWidth(),d=i.pointerHeight(),a=0,l=0,s){case h0:a=n/2,l=-1*d;break;case p0:a=n+r,l=o/2;break;case g0:a=n/2,l=o+d;break;case f0:a=-1*r,l=o/2;break}i.setAttrs({x:-1*a,y:-1*l,width:n,height:o}),t.setAttrs({x:-1*a,y:-1*l})}}};qr.Label=Il;Il.prototype.className="Label";(0,W3._registerNode)(Il);var Zn=class extends U7.Shape{_sceneFunc(t){let i=this.width(),n=this.height(),o=this.pointerDirection(),s=this.pointerWidth(),r=this.pointerHeight(),a=this.cornerRadius(),l=0,d=0,c=0,u=0;typeof a=="number"?l=d=c=u=Math.min(a,i/2,n/2):(l=Math.min(a[0]||0,i/2,n/2),d=Math.min(a[1]||0,i/2,n/2),u=Math.min(a[2]||0,i/2,n/2),c=Math.min(a[3]||0,i/2,n/2)),t.beginPath(),t.moveTo(l,0),o===h0&&(t.lineTo((i-s)/2,0),t.lineTo(i/2,-1*r),t.lineTo((i+s)/2,0)),t.lineTo(i-d,0),t.arc(i-d,d,d,Math.PI*3/2,0,!1),o===p0&&(t.lineTo(i,(n-r)/2),t.lineTo(i+s,n/2),t.lineTo(i,(n+r)/2)),t.lineTo(i,n-u),t.arc(i-u,n-u,u,0,Math.PI/2,!1),o===g0&&(t.lineTo((i+s)/2,n),t.lineTo(i/2,n+r),t.lineTo((i-s)/2,n)),t.lineTo(c,n),t.arc(c,n-c,c,Math.PI/2,Math.PI,!1),o===f0&&(t.lineTo(0,(n+r)/2),t.lineTo(-1*s,n/2),t.lineTo(0,(n-r)/2)),t.lineTo(0,l),t.arc(l,l,l,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){let t=0,i=0,n=this.pointerWidth(),o=this.pointerHeight(),s=this.pointerDirection(),r=this.width(),a=this.height();return s===h0?(i-=o,a+=o):s===g0?a+=o:s===f0?(t-=n*1.5,r+=n):s===p0&&(r+=n*1.5),{x:t,y:i,width:r,height:a}}};qr.Tag=Zn;Zn.prototype.className="Tag";(0,W3._registerNode)(Zn);Ju.Factory.addGetterSetter(Zn,"pointerDirection",j7);Ju.Factory.addGetterSetter(Zn,"pointerWidth",0,(0,m0.getNumberValidator)());Ju.Factory.addGetterSetter(Zn,"pointerHeight",0,(0,m0.getNumberValidator)());Ju.Factory.addGetterSetter(Zn,"cornerRadius",0,(0,m0.getNumberOrArrayOfNumbersValidator)(4))});var C0=Z(Qu=>{"use strict";Object.defineProperty(Qu,"__esModule",{value:!0});Qu.Rect=void 0;var Y7=be(),X7=wt(),J7=we(),Q7=it(),Z7=Se(),$r=class extends X7.Shape{_sceneFunc(t){let i=this.cornerRadius(),n=this.width(),o=this.height();t.beginPath(),i?Q7.Util.drawRoundedRectPath(t,n,o,i):t.rect(0,0,n,o),t.closePath(),t.fillStrokeShape(this)}};Qu.Rect=$r;$r.prototype.className="Rect";(0,J7._registerNode)($r);Y7.Factory.addGetterSetter($r,"cornerRadius",0,(0,Z7.getNumberOrArrayOfNumbersValidator)(4))});var K3=Z(Zu=>{"use strict";Object.defineProperty(Zu,"__esModule",{value:!0});Zu.RegularPolygon=void 0;var $3=be(),eI=wt(),j3=Se(),tI=we(),eo=class extends eI.Shape{_sceneFunc(t){let i=this._getPoints();t.beginPath(),t.moveTo(i[0].x,i[0].y);for(let n=1;n<i.length;n++)t.lineTo(i[n].x,i[n].y);t.closePath(),t.fillStrokeShape(this)}_getPoints(){let t=this.attrs.sides,i=this.attrs.radius||0,n=[];for(let o=0;o<t;o++)n.push({x:i*Math.sin(o*2*Math.PI/t),y:-1*i*Math.cos(o*2*Math.PI/t)});return n}getSelfRect(){let t=this._getPoints(),i=t[0].x,n=t[0].y,o=t[0].x,s=t[0].y;return t.forEach(r=>{i=Math.min(i,r.x),n=Math.max(n,r.x),o=Math.min(o,r.y),s=Math.max(s,r.y)}),{x:i,y:o,width:n-i,height:s-o}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}};Zu.RegularPolygon=eo;eo.prototype.className="RegularPolygon";eo.prototype._centroid=!0;eo.prototype._attrsAffectingSize=["radius"];(0,tI._registerNode)(eo);$3.Factory.addGetterSetter(eo,"radius",0,(0,j3.getNumberValidator)());$3.Factory.addGetterSetter(eo,"sides",0,(0,j3.getNumberValidator)())});var Q3=Z(eh=>{"use strict";Object.defineProperty(eh,"__esModule",{value:!0});eh.Ring=void 0;var X3=be(),iI=wt(),J3=Se(),nI=we(),Y3=Math.PI*2,to=class extends iI.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,Y3,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),Y3,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}};eh.Ring=to;to.prototype.className="Ring";to.prototype._centroid=!0;to.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,nI._registerNode)(to);X3.Factory.addGetterSetter(to,"innerRadius",0,(0,J3.getNumberValidator)());X3.Factory.addGetterSetter(to,"outerRadius",0,(0,J3.getNumberValidator)())});var v0=Z(th=>{"use strict";Object.defineProperty(th,"__esModule",{value:!0});th.Sprite=void 0;var Ls=be(),oI=wt(),sI=Bu(),Z3=Se(),rI=we(),Li=class extends oI.Shape{constructor(t){super(t),this._updated=!0,this.anim=new sI.Animation(()=>{let i=this._updated;return this._updated=!1,i}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){let i=this.animation(),n=this.frameIndex(),o=n*4,s=this.animations()[i],r=this.frameOffsets(),a=s[o+0],l=s[o+1],d=s[o+2],c=s[o+3],u=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,d,c),t.closePath(),t.fillStrokeShape(this)),u)if(r){let h=r[i],p=n*2;t.drawImage(u,a,l,d,c,h[p+0],h[p+1],d,c)}else t.drawImage(u,a,l,d,c,0,0,d,c)}_hitFunc(t){let i=this.animation(),n=this.frameIndex(),o=n*4,s=this.animations()[i],r=this.frameOffsets(),a=s[o+2],l=s[o+3];if(t.beginPath(),r){let d=r[i],c=n*2;t.rect(d[c+0],d[c+1],a,l)}else t.rect(0,0,a,l);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){let t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;let t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){let t=this.frameIndex(),i=this.animation(),n=this.animations(),o=n[i],s=o.length/4;t<s-1?this.frameIndex(t+1):this.frameIndex(0)}};th.Sprite=Li;Li.prototype.className="Sprite";(0,rI._registerNode)(Li);Ls.Factory.addGetterSetter(Li,"animation");Ls.Factory.addGetterSetter(Li,"animations");Ls.Factory.addGetterSetter(Li,"frameOffsets");Ls.Factory.addGetterSetter(Li,"image");Ls.Factory.addGetterSetter(Li,"frameIndex",0,(0,Z3.getNumberValidator)());Ls.Factory.addGetterSetter(Li,"frameRate",17,(0,Z3.getNumberValidator)());Ls.Factory.backCompat(Li,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"})});var ex=Z(ih=>{"use strict";Object.defineProperty(ih,"__esModule",{value:!0});ih.Star=void 0;var w0=be(),aI=wt(),b0=Se(),lI=we(),Cn=class extends aI.Shape{_sceneFunc(t){let i=this.innerRadius(),n=this.outerRadius(),o=this.numPoints();t.beginPath(),t.moveTo(0,0-n);for(let s=1;s<o*2;s++){let r=s%2===0?n:i,a=r*Math.sin(s*Math.PI/o),l=-1*r*Math.cos(s*Math.PI/o);t.lineTo(a,l)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}};ih.Star=Cn;Cn.prototype.className="Star";Cn.prototype._centroid=!0;Cn.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,lI._registerNode)(Cn);w0.Factory.addGetterSetter(Cn,"numPoints",5,(0,b0.getNumberValidator)());w0.Factory.addGetterSetter(Cn,"innerRadius",0,(0,b0.getNumberValidator)());w0.Factory.addGetterSetter(Cn,"outerRadius",0,(0,b0.getNumberValidator)())});var R0=Z(_l=>{"use strict";Object.defineProperty(_l,"__esModule",{value:!0});_l.Text=void 0;_l.stringToArray=_s;var E0=it(),jt=be(),dI=wt(),y0=we(),No=Se(),cI=we();function _s(e){return[...e].reduce((t,i,n,o)=>{if(new RegExp("\\p{Emoji}","u").test(i)){let s=o[n+1];s&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(s)?(t.push(i+s),o[n+1]=""):t.push(i)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(i+(o[n+1]||""))?t.push(i+o[n+1]):n>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(i)?t[t.length-1]+=i:i&&t.push(i);return t},[])}var jr="auto",uI="center",sx="inherit",Ll="justify",hI="Change.konva",pI="2d",tx="-",rx="left",gI="text",fI="Text",mI="top",CI="bottom",ix="middle",ax="normal",vI="px ",nh=" ",wI="right",nx="rtl",bI="word",yI="char",ox="none",S0="\u2026",lx=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],SI=lx.length;function xI(e){return e.split(",").map(t=>{t=t.trim();let i=t.indexOf(" ")>=0,n=t.indexOf('"')>=0||t.indexOf("'")>=0;return i&&!n&&(t=`"${t}"`),t}).join(", ")}var oh;function x0(){return oh||(oh=E0.Util.createCanvasElement().getContext(pI),oh)}function EI(e){e.fillText(this._partialText,this._partialTextX,this._partialTextY)}function RI(e){e.setAttr("miterLimit",2),e.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function PI(e){return e=e||{},!e.fillLinearGradientColorStops&&!e.fillRadialGradientColorStops&&!e.fillPatternImage&&(e.fill=e.fill||"black"),e}var Ze=class extends dI.Shape{constructor(t){super(PI(t)),this._partialTextX=0,this._partialTextY=0;for(let i=0;i<SI;i++)this.on(lx[i]+hI,this._setTextData);this._setTextData()}_sceneFunc(t){let i=this.textArr,n=i.length;if(!this.text())return;let o=this.padding(),s=this.fontSize(),r=this.lineHeight()*s,a=this.verticalAlign(),l=this.direction(),d=0,c=this.align(),u=this.getWidth(),h=this.letterSpacing(),p=this.fill(),g=this.textDecoration(),f=g.indexOf("underline")!==-1,m=g.indexOf("line-through")!==-1,C;l=l===sx?t.direction:l;let v=r/2,w=ix;if(y0.Konva._fixTextRendering){let y=this.measureSize("M");w="alphabetic",v=(y.fontBoundingBoxAscent-y.fontBoundingBoxDescent)/2+r/2}for(l===nx&&t.setAttr("direction",l),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",w),t.setAttr("textAlign",rx),a===ix?d=(this.getHeight()-n*r-o*2)/2:a===CI&&(d=this.getHeight()-n*r-o*2),t.translate(o,d+o),C=0;C<n;C++){let y=0,S=0,x=i[C],E=x.text,T=x.width,L=x.lastInParagraph;if(t.save(),c===wI?y+=u-T-o*2:c===uI&&(y+=(u-T-o*2)/2),f){t.save(),t.beginPath();let O=y0.Konva._fixTextRendering?Math.round(s/4):Math.round(s/2),W=y,G=v+S+O;t.moveTo(W,G);let Q=c===Ll&&!L?u-o*2:T;t.lineTo(W+Math.round(Q),G),t.lineWidth=s/15;let ge=this._getLinearGradient();t.strokeStyle=ge||p,t.stroke(),t.restore()}if(m){t.save(),t.beginPath();let O=y0.Konva._fixTextRendering?-Math.round(s/4):0;t.moveTo(y,v+S+O);let W=c===Ll&&!L?u-o*2:T;t.lineTo(y+Math.round(W),v+S+O),t.lineWidth=s/15;let G=this._getLinearGradient();t.strokeStyle=G||p,t.stroke(),t.restore()}if(l!==nx&&(h!==0||c===Ll)){let O=E.split(" ").length-1,W=_s(E);for(let G=0;G<W.length;G++){let Q=W[G];Q===" "&&!L&&c===Ll&&(y+=(u-o*2-T)/O),this._partialTextX=y,this._partialTextY=v+S,this._partialText=Q,t.fillStrokeShape(this),y+=this.measureSize(Q).width+h}}else h!==0&&t.setAttr("letterSpacing",`${h}px`),this._partialTextX=y,this._partialTextY=v+S,this._partialText=E,t.fillStrokeShape(this);t.restore(),n>1&&(v+=r)}}_hitFunc(t){let i=this.getWidth(),n=this.getHeight();t.beginPath(),t.rect(0,0,i,n),t.closePath(),t.fillStrokeShape(this)}setText(t){let i=E0.Util._isString(t)?t:t==null?"":t+"";return this._setAttr(gI,i),this}getWidth(){return this.attrs.width===jr||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===jr||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return E0.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var i,n,o,s,r,a,l,d,c,u,h;let p=x0(),g=this.fontSize(),f;p.save(),p.font=this._getContextFont(),f=p.measureText(t),p.restore();let m=g/100;return{actualBoundingBoxAscent:(i=f.actualBoundingBoxAscent)!==null&&i!==void 0?i:71.58203125*m,actualBoundingBoxDescent:(n=f.actualBoundingBoxDescent)!==null&&n!==void 0?n:0,actualBoundingBoxLeft:(o=f.actualBoundingBoxLeft)!==null&&o!==void 0?o:-7.421875*m,actualBoundingBoxRight:(s=f.actualBoundingBoxRight)!==null&&s!==void 0?s:75.732421875*m,alphabeticBaseline:(r=f.alphabeticBaseline)!==null&&r!==void 0?r:0,emHeightAscent:(a=f.emHeightAscent)!==null&&a!==void 0?a:100*m,emHeightDescent:(l=f.emHeightDescent)!==null&&l!==void 0?l:-20*m,fontBoundingBoxAscent:(d=f.fontBoundingBoxAscent)!==null&&d!==void 0?d:91*m,fontBoundingBoxDescent:(c=f.fontBoundingBoxDescent)!==null&&c!==void 0?c:21*m,hangingBaseline:(u=f.hangingBaseline)!==null&&u!==void 0?u:72.80000305175781*m,ideographicBaseline:(h=f.ideographicBaseline)!==null&&h!==void 0?h:-21*m,width:f.width,height:g}}_getContextFont(){return this.fontStyle()+nh+this.fontVariant()+nh+(this.fontSize()+vI)+xI(this.fontFamily())}_addTextLine(t){this.align()===Ll&&(t=t.trim());let n=this._getTextWidth(t);return this.textArr.push({text:t,width:n,lastInParagraph:!1})}_getTextWidth(t){let i=this.letterSpacing(),n=t.length;return x0().measureText(t).width+i*n}_setTextData(){let t=this.text().split(`
`),i=+this.fontSize(),n=0,o=this.lineHeight()*i,s=this.attrs.width,r=this.attrs.height,a=s!==jr&&s!==void 0,l=r!==jr&&r!==void 0,d=this.padding(),c=s-d*2,u=r-d*2,h=0,p=this.wrap(),g=p!==ox,f=p!==yI&&g,m=this.ellipsis();this.textArr=[],x0().font=this._getContextFont();let C=m?this._getTextWidth(S0):0;for(let v=0,w=t.length;v<w;++v){let y=t[v],S=this._getTextWidth(y);if(a&&S>c)for(;y.length>0;){let x=0,E=_s(y).length,T="",L=0;for(;x<E;){let O=x+E>>>1,W=_s(y),G=W.slice(0,O+1).join(""),Q=this._getTextWidth(G);(m&&l&&h+o>u?Q+C:Q)<=c?(x=O+1,T=G,L=Q):E=O}if(T){if(f){let G=_s(y),Q=_s(T),ge=G[Q.length],pe=ge===nh||ge===tx,ot;if(pe&&L<=c)ot=Q.length;else{let gi=Q.lastIndexOf(nh),ke=Q.lastIndexOf(tx);ot=Math.max(gi,ke)+1}ot>0&&(x=ot,T=G.slice(0,x).join(""),L=this._getTextWidth(T))}if(T=T.trimRight(),this._addTextLine(T),n=Math.max(n,L),h+=o,this._shouldHandleEllipsis(h)){this._tryToAddEllipsisToLastLine();break}if(y=_s(y).slice(x).join("").trimLeft(),y.length>0&&(S=this._getTextWidth(y),S<=c)){this._addTextLine(y),h+=o,n=Math.max(n,S);break}}else break}else this._addTextLine(y),h+=o,n=Math.max(n,S),this._shouldHandleEllipsis(h)&&v<w-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),l&&h+o>u)break}this.textHeight=i,this.textWidth=n}_shouldHandleEllipsis(t){let i=+this.fontSize(),n=this.lineHeight()*i,o=this.attrs.height,s=o!==jr&&o!==void 0,r=this.padding(),a=o-r*2;return!(this.wrap()!==ox)||s&&t+n>a}_tryToAddEllipsisToLastLine(){let t=this.attrs.width,i=t!==jr&&t!==void 0,n=this.padding(),o=t-n*2,s=this.ellipsis(),r=this.textArr[this.textArr.length-1];!r||!s||(i&&(this._getTextWidth(r.text+S0)<o||(r.text=r.text.slice(0,r.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(r.text+S0))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){let t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,i=this.hasShadow();return t&&i?!0:super._useBufferCanvas()}};_l.Text=Ze;Ze.prototype._fillFunc=EI;Ze.prototype._strokeFunc=RI;Ze.prototype.className=fI;Ze.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,cI._registerNode)(Ze);jt.Factory.overWriteSetter(Ze,"width",(0,No.getNumberOrAutoValidator)());jt.Factory.overWriteSetter(Ze,"height",(0,No.getNumberOrAutoValidator)());jt.Factory.addGetterSetter(Ze,"direction",sx);jt.Factory.addGetterSetter(Ze,"fontFamily","Arial");jt.Factory.addGetterSetter(Ze,"fontSize",12,(0,No.getNumberValidator)());jt.Factory.addGetterSetter(Ze,"fontStyle",ax);jt.Factory.addGetterSetter(Ze,"fontVariant",ax);jt.Factory.addGetterSetter(Ze,"padding",0,(0,No.getNumberValidator)());jt.Factory.addGetterSetter(Ze,"align",rx);jt.Factory.addGetterSetter(Ze,"verticalAlign",mI);jt.Factory.addGetterSetter(Ze,"lineHeight",1,(0,No.getNumberValidator)());jt.Factory.addGetterSetter(Ze,"wrap",bI);jt.Factory.addGetterSetter(Ze,"ellipsis",!1,(0,No.getBooleanValidator)());jt.Factory.addGetterSetter(Ze,"letterSpacing",0,(0,No.getNumberValidator)());jt.Factory.addGetterSetter(Ze,"text","",(0,No.getStringValidator)());jt.Factory.addGetterSetter(Ze,"textDecoration","")});var px=Z(sh=>{"use strict";Object.defineProperty(sh,"__esModule",{value:!0});sh.TextPath=void 0;var P0=it(),Ui=be(),MI=wt(),Ol=qu(),M0=R0(),dx=Se(),kI=we(),DI="",cx="normal";function ux(e){e.fillText(this.partialText,0,0)}function hx(e){e.strokeText(this.partialText,0,0)}var ht=class extends MI.Shape{constructor(t){super(t),this.dummyCanvas=P0.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return Ol.Path.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;let i=this.pathLength;return t-1>i?null:Ol.Path.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=Ol.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();let i=this.textDecoration(),n=this.fill(),o=this.fontSize(),s=this.glyphInfo;i==="underline"&&t.beginPath();for(let r=0;r<s.length;r++){t.save();let a=s[r].p0;t.translate(a.x,a.y),t.rotate(s[r].rotation),this.partialText=s[r].text,t.fillStrokeShape(this),i==="underline"&&(r===0&&t.moveTo(0,o/2+1),t.lineTo(o,o/2+1)),t.restore()}i==="underline"&&(t.strokeStyle=n,t.lineWidth=o/20,t.stroke()),t.restore()}_hitFunc(t){t.beginPath();let i=this.glyphInfo;if(i.length>=1){let n=i[0].p0;t.moveTo(n.x,n.y)}for(let n=0;n<i.length;n++){let o=i[n].p1;t.lineTo(o.x,o.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return P0.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return M0.Text.prototype.setText.call(this,t)}_getContextFont(){return M0.Text.prototype._getContextFont.call(this)}_getTextSize(t){let n=this.dummyCanvas.getContext("2d");n.save(),n.font=this._getContextFont();let o=n.measureText(t);return n.restore(),{width:o.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){let{width:t,height:i}=this._getTextSize(this.attrs.text);if(this.textWidth=t,this.textHeight=i,this.glyphInfo=[],!this.attrs.data)return null;let n=this.letterSpacing(),o=this.align(),s=this.kerningFunc(),r=Math.max(this.textWidth+((this.attrs.text||"").length-1)*n,0),a=0;o==="center"&&(a=Math.max(0,this.pathLength/2-r/2)),o==="right"&&(a=Math.max(0,this.pathLength-r));let l=(0,M0.stringToArray)(this.text()),d=a;for(let c=0;c<l.length;c++){let u=this._getPointAtLength(d);if(!u)return;let h=this._getTextSize(l[c]).width+n;if(l[c]===" "&&o==="justify"){let v=this.text().split(" ").length-1;h+=(this.pathLength-r)/v}let p=this._getPointAtLength(d+h);if(!p)return;let g=Ol.Path.getLineLength(u.x,u.y,p.x,p.y),f=0;if(s)try{f=s(l[c-1],l[c])*this.fontSize()}catch{f=0}u.x+=f,p.x+=f,this.textWidth+=f;let m=Ol.Path.getPointOnLine(f+g/2,u.x,u.y,p.x,p.y),C=Math.atan2(p.y-u.y,p.x-u.x);this.glyphInfo.push({transposeX:m.x,transposeY:m.y,text:l[c],rotation:C,p0:u,p1:p}),d+=h}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};let t=[];this.glyphInfo.forEach(function(d){t.push(d.p0.x),t.push(d.p0.y),t.push(d.p1.x),t.push(d.p1.y)});let i=t[0]||0,n=t[0]||0,o=t[1]||0,s=t[1]||0,r,a;for(let d=0;d<t.length/2;d++)r=t[d*2],a=t[d*2+1],i=Math.min(i,r),n=Math.max(n,r),o=Math.min(o,a),s=Math.max(s,a);let l=this.fontSize();return{x:i-l/2,y:o-l/2,width:n-i+l,height:s-o+l}}destroy(){return P0.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};sh.TextPath=ht;ht.prototype._fillFunc=ux;ht.prototype._strokeFunc=hx;ht.prototype._fillFuncHit=ux;ht.prototype._strokeFuncHit=hx;ht.prototype.className="TextPath";ht.prototype._attrsAffectingSize=["text","fontSize","data"];(0,kI._registerNode)(ht);Ui.Factory.addGetterSetter(ht,"data");Ui.Factory.addGetterSetter(ht,"fontFamily","Arial");Ui.Factory.addGetterSetter(ht,"fontSize",12,(0,dx.getNumberValidator)());Ui.Factory.addGetterSetter(ht,"fontStyle",cx);Ui.Factory.addGetterSetter(ht,"align","left");Ui.Factory.addGetterSetter(ht,"letterSpacing",0,(0,dx.getNumberValidator)());Ui.Factory.addGetterSetter(ht,"textBaseline","middle");Ui.Factory.addGetterSetter(ht,"fontVariant",cx);Ui.Factory.addGetterSetter(ht,"text",DI);Ui.Factory.addGetterSetter(ht,"textDecoration","");Ui.Factory.addGetterSetter(ht,"kerningFunc",void 0)});var bx=Z(ah=>{"use strict";Object.defineProperty(ah,"__esModule",{value:!0});ah.Transformer=void 0;var We=it(),_e=be(),gx=lt(),FI=wt(),TI=C0(),fx=Tl(),qi=we(),Bo=Se(),AI=we(),vx="tr-konva",II=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(e=>e+`.${vx}`).join(" "),mx="nodesRect",LI=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],_I={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},OI="ontouchstart"in qi.Konva._global;function NI(e,t,i){if(e==="rotater")return i;t+=We.Util.degToRad(_I[e]||0);let n=(We.Util.radToDeg(t)%360+360)%360;return We.Util._inRange(n,315+22.5,360)||We.Util._inRange(n,0,22.5)?"ns-resize":We.Util._inRange(n,45-22.5,45+22.5)?"nesw-resize":We.Util._inRange(n,90-22.5,90+22.5)?"ew-resize":We.Util._inRange(n,135-22.5,135+22.5)?"nwse-resize":We.Util._inRange(n,180-22.5,180+22.5)?"ns-resize":We.Util._inRange(n,225-22.5,225+22.5)?"nesw-resize":We.Util._inRange(n,270-22.5,270+22.5)?"ew-resize":We.Util._inRange(n,315-22.5,315+22.5)?"nwse-resize":(We.Util.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}var rh=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],Cx=1e8;function BI(e){return{x:e.x+e.width/2*Math.cos(e.rotation)+e.height/2*Math.sin(-e.rotation),y:e.y+e.height/2*Math.cos(e.rotation)+e.width/2*Math.sin(e.rotation)}}function wx(e,t,i){let n=i.x+(e.x-i.x)*Math.cos(t)-(e.y-i.y)*Math.sin(t),o=i.y+(e.x-i.x)*Math.sin(t)+(e.y-i.y)*Math.cos(t);return _(b({},e),{rotation:e.rotation+t,x:n,y:o})}function HI(e,t){let i=BI(e);return wx(e,t,i)}function GI(e,t,i){let n=t;for(let o=0;o<e.length;o++){let s=qi.Konva.getAngle(e[o]),r=Math.abs(s-t)%(Math.PI*2);Math.min(r,Math.PI*2-r)<i&&(n=s)}return n}var k0=0,xe=class extends fx.Group{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(II,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return We.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return vx+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();let i=t.filter(o=>o.isAncestorOf(this)?(We.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=t=i,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(o=>{let s=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(o._attrsAffectingSize.length){let r=o._attrsAffectingSize.map(a=>a+"Change."+this._getEventNamespace()).join(" ");o.on(r,s)}o.on(LI.map(r=>r+`.${this._getEventNamespace()}`).join(" "),s),o.on(`absoluteTransformChange.${this._getEventNamespace()}`,s),this._proxyDrag(o)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let i;t.on(`dragstart.${this._getEventNamespace()}`,n=>{i=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(n,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,n=>{if(!i)return;let o=t.getAbsolutePosition(),s=o.x-i.x,r=o.y-i.y;this.nodes().forEach(a=>{if(a===t||a.isDragging())return;let l=a.getAbsolutePosition();a.setAbsolutePosition({x:l.x+s,y:l.y+r}),a.startDrag(n)}),i=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(mx),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(mx,this.__getNodeRect)}__getNodeShape(t,i=this.rotation(),n){let o=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),s=t.getAbsoluteScale(n),r=t.getAbsolutePosition(n),a=o.x*s.x-t.offsetX()*s.x,l=o.y*s.y-t.offsetY()*s.y,d=(qi.Konva.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),c={x:r.x+a*Math.cos(d)+l*Math.sin(-d),y:r.y+l*Math.cos(d)+a*Math.sin(d),width:o.width*s.x,height:o.height*s.y,rotation:d};return wx(c,-qi.Konva.getAngle(i),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-Cx,y:-Cx,width:0,height:0,rotation:0};let i=[];this.nodes().map(d=>{let c=d.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),u=[{x:c.x,y:c.y},{x:c.x+c.width,y:c.y},{x:c.x+c.width,y:c.y+c.height},{x:c.x,y:c.y+c.height}],h=d.getAbsoluteTransform();u.forEach(function(p){let g=h.point(p);i.push(g)})});let n=new We.Transform;n.rotate(-qi.Konva.getAngle(this.rotation()));let o=1/0,s=1/0,r=-1/0,a=-1/0;i.forEach(function(d){let c=n.point(d);o===void 0&&(o=r=c.x,s=a=c.y),o=Math.min(o,c.x),s=Math.min(s,c.y),r=Math.max(r,c.x),a=Math.max(a,c.y)}),n.invert();let l=n.point({x:o,y:s});return{x:l.x,y:l.y,width:r-o,height:a-s,rotation:qi.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),rh.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){let i=new TI.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:OI?10:"auto"}),n=this;i.on("mousedown touchstart",function(o){n._handleMouseDown(o)}),i.on("dragstart",o=>{i.stopDrag(),o.cancelBubble=!0}),i.on("dragend",o=>{o.cancelBubble=!0}),i.on("mouseenter",()=>{let o=qi.Konva.getAngle(this.rotation()),s=this.rotateAnchorCursor(),r=NI(t,o,s);i.getStage().content&&(i.getStage().content.style.cursor=r),this._cursorChange=!0}),i.on("mouseout",()=>{i.getStage().content&&(i.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(i)}_createBack(){let t=new FI.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(i,n){let o=n.getParent(),s=o.padding();i.beginPath(),i.rect(-s,-s,n.width()+s*2,n.height()+s*2),i.moveTo(n.width()/2,-s),o.rotateEnabled()&&o.rotateLineVisible()&&i.lineTo(n.width()/2,-o.rotateAnchorOffset()*We.Util._sign(n.height())-s),i.fillStrokeShape(n)},hitFunc:(i,n)=>{if(!this.shouldOverdrawWholeArea())return;let o=this.padding();i.beginPath(),i.rect(-o,-o,n.width()+o*2,n.height()+o*2),i.fillStrokeShape(n)}});this.add(t),this._proxyDrag(t),t.on("dragstart",i=>{i.cancelBubble=!0}),t.on("dragmove",i=>{i.cancelBubble=!0}),t.on("dragend",i=>{i.cancelBubble=!0}),this.on("dragmove",i=>{this.update()})}_handleMouseDown(t){if(this._transforming)return;this._movingAnchorName=t.target.name().split(" ")[0];let i=this._getNodeRect(),n=i.width,o=i.height,s=Math.sqrt(Math.pow(n,2)+Math.pow(o,2));this.sin=Math.abs(o/s),this.cos=Math.abs(n/s),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;let r=t.target.getAbsolutePosition(),a=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:a.x-r.x,y:a.y-r.y},k0++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(l=>{l._fire("transformstart",{evt:t.evt,target:l})})}_handleMouseMove(t){let i,n,o,s=this.findOne("."+this._movingAnchorName),r=s.getStage();r.setPointersPositions(t);let a=r.getPointerPosition(),l={x:a.x-this._anchorDragOffset.x,y:a.y-this._anchorDragOffset.y},d=s.getAbsolutePosition();this.anchorDragBoundFunc()&&(l=this.anchorDragBoundFunc()(d,l,t)),s.setAbsolutePosition(l);let c=s.getAbsolutePosition();if(d.x===c.x&&d.y===c.y)return;if(this._movingAnchorName==="rotater"){let v=this._getNodeRect();i=s.x()-v.width/2,n=-s.y()+v.height/2;let w=Math.atan2(-n,i)+Math.PI/2;v.height<0&&(w-=Math.PI);let S=qi.Konva.getAngle(this.rotation())+w,x=qi.Konva.getAngle(this.rotationSnapTolerance()),T=GI(this.rotationSnaps(),S,x)-v.rotation,L=HI(v,T);this._fitNodesInto(L,t);return}let u=this.shiftBehavior(),h;u==="inverted"?h=this.keepRatio()&&!t.shiftKey:u==="none"?h=this.keepRatio():h=this.keepRatio()||t.shiftKey;let p=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(h){let v=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};o=Math.sqrt(Math.pow(v.x-s.x(),2)+Math.pow(v.y-s.y(),2));let w=this.findOne(".top-left").x()>v.x?-1:1,y=this.findOne(".top-left").y()>v.y?-1:1;i=o*this.cos*w,n=o*this.sin*y,this.findOne(".top-left").x(v.x-i),this.findOne(".top-left").y(v.y-n)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(s.y());else if(this._movingAnchorName==="top-right"){if(h){let v=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};o=Math.sqrt(Math.pow(s.x()-v.x,2)+Math.pow(v.y-s.y(),2));let w=this.findOne(".top-right").x()<v.x?-1:1,y=this.findOne(".top-right").y()>v.y?-1:1;i=o*this.cos*w,n=o*this.sin*y,this.findOne(".top-right").x(v.x+i),this.findOne(".top-right").y(v.y-n)}var g=s.position();this.findOne(".top-left").y(g.y),this.findOne(".bottom-right").x(g.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(s.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(s.x());else if(this._movingAnchorName==="bottom-left"){if(h){let v=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};o=Math.sqrt(Math.pow(v.x-s.x(),2)+Math.pow(s.y()-v.y,2));let w=v.x<s.x()?-1:1,y=s.y()<v.y?-1:1;i=o*this.cos*w,n=o*this.sin*y,s.x(v.x-i),s.y(v.y+n)}g=s.position(),this.findOne(".top-left").x(g.x),this.findOne(".bottom-right").y(g.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(s.y());else if(this._movingAnchorName==="bottom-right"){if(h){let v=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};o=Math.sqrt(Math.pow(s.x()-v.x,2)+Math.pow(s.y()-v.y,2));let w=this.findOne(".bottom-right").x()<v.x?-1:1,y=this.findOne(".bottom-right").y()<v.y?-1:1;i=o*this.cos*w,n=o*this.sin*y,this.findOne(".bottom-right").x(v.x+i),this.findOne(".bottom-right").y(v.y+n)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(p=this.centeredScaling()||t.altKey,p){let v=this.findOne(".top-left"),w=this.findOne(".bottom-right"),y=v.x(),S=v.y(),x=this.getWidth()-w.x(),E=this.getHeight()-w.y();w.move({x:-y,y:-S}),v.move({x,y:E})}let f=this.findOne(".top-left").getAbsolutePosition();i=f.x,n=f.y;let m=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),C=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:i,y:n,width:m,height:C,rotation:qi.Konva.getAngle(this.rotation())},t)}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var i;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));let n=this.getNode();k0--,this._fire("transformend",{evt:t,target:n}),(i=this.getLayer())===null||i===void 0||i.batchDraw(),n&&this._nodes.forEach(o=>{var s;o._fire("transformend",{evt:t,target:o}),(s=o.getLayer())===null||s===void 0||s.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(t,i){let n=this._getNodeRect(),o=1;if(We.Util._inRange(t.width,-this.padding()*2-o,o)){this.update();return}if(We.Util._inRange(t.height,-this.padding()*2-o,o)){this.update();return}let s=new We.Transform;if(s.rotate(qi.Konva.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){let h=s.point({x:-this.padding()*2,y:0});t.x+=h.x,t.y+=h.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){let h=s.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){let h=s.point({x:0,y:-this.padding()*2});t.x+=h.x,t.y+=h.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){let h=s.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){let h=this.boundBoxFunc()(n,t);h?t=h:We.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}let r=1e7,a=new We.Transform;a.translate(n.x,n.y),a.rotate(n.rotation),a.scale(n.width/r,n.height/r);let l=new We.Transform,d=t.width/r,c=t.height/r;this.flipEnabled()===!1?(l.translate(t.x,t.y),l.rotate(t.rotation),l.translate(t.width<0?t.width:0,t.height<0?t.height:0),l.scale(Math.abs(d),Math.abs(c))):(l.translate(t.x,t.y),l.rotate(t.rotation),l.scale(d,c));let u=l.multiply(a.invert());this._nodes.forEach(h=>{var p;let g=h.getParent().getAbsoluteTransform(),f=h.getTransform().copy();f.translate(h.offsetX(),h.offsetY());let m=new We.Transform;m.multiply(g.copy().invert()).multiply(u).multiply(g).multiply(f);let C=m.decompose();h.setAttrs(C),(p=h.getLayer())===null||p===void 0||p.batchDraw()}),this.rotation(We.Util._getRotation(t.rotation)),this._nodes.forEach(h=>{this._fire("transform",{evt:i,target:h}),h._fire("transform",{evt:i,target:h})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,i){this.findOne(t).setAttrs(i)}update(){var t;let i=this._getNodeRect();this.rotation(We.Util._getRotation(i.rotation));let n=i.width,o=i.height,s=this.enabledAnchors(),r=this.resizeEnabled(),a=this.padding(),l=this.anchorSize(),d=this.find("._anchor");d.forEach(u=>{u.setAttrs({width:l,height:l,offsetX:l/2,offsetY:l/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:l/2+a,offsetY:l/2+a,visible:r&&s.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:n/2,y:0,offsetY:l/2+a,visible:r&&s.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:n,y:0,offsetX:l/2-a,offsetY:l/2+a,visible:r&&s.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:o/2,offsetX:l/2+a,visible:r&&s.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:n,y:o/2,offsetX:l/2-a,visible:r&&s.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:o,offsetX:l/2+a,offsetY:l/2-a,visible:r&&s.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:n/2,y:o,offsetY:l/2-a,visible:r&&s.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:n,y:o,offsetX:l/2-a,offsetY:l/2-a,visible:r&&s.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:n/2,y:-this.rotateAnchorOffset()*We.Util._sign(o)-a,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:n,height:o,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});let c=this.anchorStyleFunc();c&&d.forEach(u=>{c(u)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();let t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),fx.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return gx.Node.prototype.toObject.call(this)}clone(t){return gx.Node.prototype.clone.call(this,t)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};ah.Transformer=xe;xe.isTransforming=()=>k0>0;function VI(e){return e instanceof Array||We.Util.warn("enabledAnchors value should be an array"),e instanceof Array&&e.forEach(function(t){rh.indexOf(t)===-1&&We.Util.warn("Unknown anchor name: "+t+". Available names are: "+rh.join(", "))}),e||[]}xe.prototype.className="Transformer";(0,AI._registerNode)(xe);_e.Factory.addGetterSetter(xe,"enabledAnchors",rh,VI);_e.Factory.addGetterSetter(xe,"flipEnabled",!0,(0,Bo.getBooleanValidator)());_e.Factory.addGetterSetter(xe,"resizeEnabled",!0);_e.Factory.addGetterSetter(xe,"anchorSize",10,(0,Bo.getNumberValidator)());_e.Factory.addGetterSetter(xe,"rotateEnabled",!0);_e.Factory.addGetterSetter(xe,"rotateLineVisible",!0);_e.Factory.addGetterSetter(xe,"rotationSnaps",[]);_e.Factory.addGetterSetter(xe,"rotateAnchorOffset",50,(0,Bo.getNumberValidator)());_e.Factory.addGetterSetter(xe,"rotateAnchorCursor","crosshair");_e.Factory.addGetterSetter(xe,"rotationSnapTolerance",5,(0,Bo.getNumberValidator)());_e.Factory.addGetterSetter(xe,"borderEnabled",!0);_e.Factory.addGetterSetter(xe,"anchorStroke","rgb(0, 161, 255)");_e.Factory.addGetterSetter(xe,"anchorStrokeWidth",1,(0,Bo.getNumberValidator)());_e.Factory.addGetterSetter(xe,"anchorFill","white");_e.Factory.addGetterSetter(xe,"anchorCornerRadius",0,(0,Bo.getNumberValidator)());_e.Factory.addGetterSetter(xe,"borderStroke","rgb(0, 161, 255)");_e.Factory.addGetterSetter(xe,"borderStrokeWidth",1,(0,Bo.getNumberValidator)());_e.Factory.addGetterSetter(xe,"borderDash");_e.Factory.addGetterSetter(xe,"keepRatio",!0);_e.Factory.addGetterSetter(xe,"shiftBehavior","default");_e.Factory.addGetterSetter(xe,"centeredScaling",!1);_e.Factory.addGetterSetter(xe,"ignoreStroke",!1);_e.Factory.addGetterSetter(xe,"padding",0,(0,Bo.getNumberValidator)());_e.Factory.addGetterSetter(xe,"nodes");_e.Factory.addGetterSetter(xe,"node");_e.Factory.addGetterSetter(xe,"boundBoxFunc");_e.Factory.addGetterSetter(xe,"anchorDragBoundFunc");_e.Factory.addGetterSetter(xe,"anchorStyleFunc");_e.Factory.addGetterSetter(xe,"shouldOverdrawWholeArea",!1);_e.Factory.addGetterSetter(xe,"useSingleNodeRotation",!0);_e.Factory.backCompat(xe,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"})});var Sx=Z(dh=>{"use strict";Object.defineProperty(dh,"__esModule",{value:!0});dh.Wedge=void 0;var lh=be(),zI=wt(),WI=we(),yx=Se(),UI=we(),$i=class extends zI.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,WI.Konva.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}};dh.Wedge=$i;$i.prototype.className="Wedge";$i.prototype._centroid=!0;$i.prototype._attrsAffectingSize=["radius"];(0,UI._registerNode)($i);lh.Factory.addGetterSetter($i,"radius",0,(0,yx.getNumberValidator)());lh.Factory.addGetterSetter($i,"angle",0,(0,yx.getNumberValidator)());lh.Factory.addGetterSetter($i,"clockwise",!1);lh.Factory.backCompat($i,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"})});var Rx=Z(ch=>{"use strict";Object.defineProperty(ch,"__esModule",{value:!0});ch.Blur=void 0;var xx=be(),qI=lt(),$I=Se();function Ex(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var jI=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],KI=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function YI(e,t){let i=e.data,n=e.width,o=e.height,s,r,a,l,d,c,u,h,p,g,f,m,C,v,w,y,S,x,E,T,L=t+t+1,O=n-1,W=o-1,G=t+1,Q=G*(G+1)/2,ge=new Ex,pe=jI[t],ot=KI[t],gi=null,ke=ge,Ke=null,Ne=null;for(let bt=1;bt<L;bt++)ke=ke.next=new Ex,bt===G&&(gi=ke);ke.next=ge,a=r=0;for(let bt=0;bt<o;bt++){m=C=v=w=l=d=c=u=0,h=G*(y=i[r]),p=G*(S=i[r+1]),g=G*(x=i[r+2]),f=G*(E=i[r+3]),l+=Q*y,d+=Q*S,c+=Q*x,u+=Q*E,ke=ge;for(let yt=0;yt<G;yt++)ke.r=y,ke.g=S,ke.b=x,ke.a=E,ke=ke.next;for(let yt=1;yt<G;yt++)s=r+((O<yt?O:yt)<<2),l+=(ke.r=y=i[s])*(T=G-yt),d+=(ke.g=S=i[s+1])*T,c+=(ke.b=x=i[s+2])*T,u+=(ke.a=E=i[s+3])*T,m+=y,C+=S,v+=x,w+=E,ke=ke.next;Ke=ge,Ne=gi;for(let yt=0;yt<n;yt++)i[r+3]=E=u*pe>>ot,E!==0?(E=255/E,i[r]=(l*pe>>ot)*E,i[r+1]=(d*pe>>ot)*E,i[r+2]=(c*pe>>ot)*E):i[r]=i[r+1]=i[r+2]=0,l-=h,d-=p,c-=g,u-=f,h-=Ke.r,p-=Ke.g,g-=Ke.b,f-=Ke.a,s=a+((s=yt+t+1)<O?s:O)<<2,m+=Ke.r=i[s],C+=Ke.g=i[s+1],v+=Ke.b=i[s+2],w+=Ke.a=i[s+3],l+=m,d+=C,c+=v,u+=w,Ke=Ke.next,h+=y=Ne.r,p+=S=Ne.g,g+=x=Ne.b,f+=E=Ne.a,m-=y,C-=S,v-=x,w-=E,Ne=Ne.next,r+=4;a+=n}for(let bt=0;bt<n;bt++){C=v=w=m=d=c=u=l=0,r=bt<<2,h=G*(y=i[r]),p=G*(S=i[r+1]),g=G*(x=i[r+2]),f=G*(E=i[r+3]),l+=Q*y,d+=Q*S,c+=Q*x,u+=Q*E,ke=ge;for(let Et=0;Et<G;Et++)ke.r=y,ke.g=S,ke.b=x,ke.a=E,ke=ke.next;let yt=n;for(let Et=1;Et<=t;Et++)r=yt+bt<<2,l+=(ke.r=y=i[r])*(T=G-Et),d+=(ke.g=S=i[r+1])*T,c+=(ke.b=x=i[r+2])*T,u+=(ke.a=E=i[r+3])*T,m+=y,C+=S,v+=x,w+=E,ke=ke.next,Et<W&&(yt+=n);r=bt,Ke=ge,Ne=gi;for(let Et=0;Et<o;Et++)s=r<<2,i[s+3]=E=u*pe>>ot,E>0?(E=255/E,i[s]=(l*pe>>ot)*E,i[s+1]=(d*pe>>ot)*E,i[s+2]=(c*pe>>ot)*E):i[s]=i[s+1]=i[s+2]=0,l-=h,d-=p,c-=g,u-=f,h-=Ke.r,p-=Ke.g,g-=Ke.b,f-=Ke.a,s=bt+((s=Et+G)<W?s:W)*n<<2,l+=m+=Ke.r=i[s],d+=C+=Ke.g=i[s+1],c+=v+=Ke.b=i[s+2],u+=w+=Ke.a=i[s+3],Ke=Ke.next,h+=y=Ne.r,p+=S=Ne.g,g+=x=Ne.b,f+=E=Ne.a,m-=y,C-=S,v-=x,w-=E,Ne=Ne.next,r+=n}}var XI=function(t){let i=Math.round(this.blurRadius());i>0&&YI(t,i)};ch.Blur=XI;xx.Factory.addGetterSetter(qI.Node,"blurRadius",0,(0,$I.getNumberValidator)(),xx.Factory.afterSetFilter)});var Mx=Z(uh=>{"use strict";Object.defineProperty(uh,"__esModule",{value:!0});uh.Brighten=void 0;var Px=be(),JI=lt(),QI=Se(),ZI=function(e){let t=this.brightness()*255,i=e.data,n=i.length;for(let o=0;o<n;o+=4)i[o]+=t,i[o+1]+=t,i[o+2]+=t};uh.Brighten=ZI;Px.Factory.addGetterSetter(JI.Node,"brightness",0,(0,QI.getNumberValidator)(),Px.Factory.afterSetFilter)});var Dx=Z(hh=>{"use strict";Object.defineProperty(hh,"__esModule",{value:!0});hh.Contrast=void 0;var kx=be(),e9=lt(),t9=Se(),i9=function(e){let t=Math.pow((this.contrast()+100)/100,2),i=e.data,n=i.length,o=150,s=150,r=150;for(let a=0;a<n;a+=4)o=i[a],s=i[a+1],r=i[a+2],o/=255,o-=.5,o*=t,o+=.5,o*=255,s/=255,s-=.5,s*=t,s+=.5,s*=255,r/=255,r-=.5,r*=t,r+=.5,r*=255,o=o<0?0:o>255?255:o,s=s<0?0:s>255?255:s,r=r<0?0:r>255?255:r,i[a]=o,i[a+1]=s,i[a+2]=r};hh.Contrast=i9;kx.Factory.addGetterSetter(e9.Node,"contrast",0,(0,t9.getNumberValidator)(),kx.Factory.afterSetFilter)});var Tx=Z(gh=>{"use strict";Object.defineProperty(gh,"__esModule",{value:!0});gh.Emboss=void 0;var Ho=be(),ph=lt(),n9=it(),Fx=Se(),o9=function(e){let t=this.embossStrength()*10,i=this.embossWhiteLevel()*255,n=this.embossDirection(),o=this.embossBlend(),s=e.data,r=e.width,a=e.height,l=r*4,d=0,c=0,u=a;switch(n){case"top-left":d=-1,c=-1;break;case"top":d=-1,c=0;break;case"top-right":d=-1,c=1;break;case"right":d=0,c=1;break;case"bottom-right":d=1,c=1;break;case"bottom":d=1,c=0;break;case"bottom-left":d=1,c=-1;break;case"left":d=0,c=-1;break;default:n9.Util.error("Unknown emboss direction: "+n)}do{let h=(u-1)*l,p=d;u+p<1&&(p=0),u+p>a&&(p=0);let g=(u-1+p)*r*4,f=r;do{let m=h+(f-1)*4,C=c;f+C<1&&(C=0),f+C>r&&(C=0);let v=g+(f-1+C)*4,w=s[m]-s[v],y=s[m+1]-s[v+1],S=s[m+2]-s[v+2],x=w,E=x>0?x:-x,T=y>0?y:-y,L=S>0?S:-S;if(T>E&&(x=y),L>E&&(x=S),x*=t,o){let O=s[m]+x,W=s[m+1]+x,G=s[m+2]+x;s[m]=O>255?255:O<0?0:O,s[m+1]=W>255?255:W<0?0:W,s[m+2]=G>255?255:G<0?0:G}else{let O=i-x;O<0?O=0:O>255&&(O=255),s[m]=s[m+1]=s[m+2]=O}}while(--f)}while(--u)};gh.Emboss=o9;Ho.Factory.addGetterSetter(ph.Node,"embossStrength",.5,(0,Fx.getNumberValidator)(),Ho.Factory.afterSetFilter);Ho.Factory.addGetterSetter(ph.Node,"embossWhiteLevel",.5,(0,Fx.getNumberValidator)(),Ho.Factory.afterSetFilter);Ho.Factory.addGetterSetter(ph.Node,"embossDirection","top-left",void 0,Ho.Factory.afterSetFilter);Ho.Factory.addGetterSetter(ph.Node,"embossBlend",!1,void 0,Ho.Factory.afterSetFilter)});var Ix=Z(fh=>{"use strict";Object.defineProperty(fh,"__esModule",{value:!0});fh.Enhance=void 0;var Ax=be(),s9=lt(),r9=Se();function D0(e,t,i,n,o){let s=i-t,r=o-n;if(s===0)return n+r/2;if(r===0)return n;let a=(e-t)/s;return a=r*a+n,a}var a9=function(e){let t=e.data,i=t.length,n=t[0],o=n,s,r=t[1],a=r,l,d=t[2],c=d,u,h=this.enhance();if(h===0)return;for(let w=0;w<i;w+=4)s=t[w+0],s<n?n=s:s>o&&(o=s),l=t[w+1],l<r?r=l:l>a&&(a=l),u=t[w+2],u<d?d=u:u>c&&(c=u);o===n&&(o=255,n=0),a===r&&(a=255,r=0),c===d&&(c=255,d=0);let p,g,f,m,C,v;if(h>0)p=o+h*(255-o),g=n-h*(n-0),f=a+h*(255-a),m=r-h*(r-0),C=c+h*(255-c),v=d-h*(d-0);else{let w=(o+n)*.5;p=o+h*(o-w),g=n+h*(n-w);let y=(a+r)*.5;f=a+h*(a-y),m=r+h*(r-y);let S=(c+d)*.5;C=c+h*(c-S),v=d+h*(d-S)}for(let w=0;w<i;w+=4)t[w+0]=D0(t[w+0],n,o,g,p),t[w+1]=D0(t[w+1],r,a,m,f),t[w+2]=D0(t[w+2],d,c,v,C)};fh.Enhance=a9;Ax.Factory.addGetterSetter(s9.Node,"enhance",0,(0,r9.getNumberValidator)(),Ax.Factory.afterSetFilter)});var Lx=Z(mh=>{"use strict";Object.defineProperty(mh,"__esModule",{value:!0});mh.Grayscale=void 0;var l9=function(e){let t=e.data,i=t.length;for(let n=0;n<i;n+=4){let o=.34*t[n]+.5*t[n+1]+.16*t[n+2];t[n]=o,t[n+1]=o,t[n+2]=o}};mh.Grayscale=l9});var _x=Z(Ch=>{"use strict";Object.defineProperty(Ch,"__esModule",{value:!0});Ch.HSL=void 0;var Kr=be(),F0=lt(),T0=Se();Kr.Factory.addGetterSetter(F0.Node,"hue",0,(0,T0.getNumberValidator)(),Kr.Factory.afterSetFilter);Kr.Factory.addGetterSetter(F0.Node,"saturation",0,(0,T0.getNumberValidator)(),Kr.Factory.afterSetFilter);Kr.Factory.addGetterSetter(F0.Node,"luminance",0,(0,T0.getNumberValidator)(),Kr.Factory.afterSetFilter);var d9=function(e){let t=e.data,i=t.length,n=1,o=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,r=this.luminance()*127,a=n*o*Math.cos(s*Math.PI/180),l=n*o*Math.sin(s*Math.PI/180),d=.299*n+.701*a+.167*l,c=.587*n-.587*a+.33*l,u=.114*n-.114*a-.497*l,h=.299*n-.299*a-.328*l,p=.587*n+.413*a+.035*l,g=.114*n-.114*a+.293*l,f=.299*n-.3*a+1.25*l,m=.587*n-.586*a-1.05*l,C=.114*n+.886*a-.2*l,v,w,y,S;for(let x=0;x<i;x+=4)v=t[x+0],w=t[x+1],y=t[x+2],S=t[x+3],t[x+0]=d*v+c*w+u*y+r,t[x+1]=h*v+p*w+g*y+r,t[x+2]=f*v+m*w+C*y+r,t[x+3]=S};Ch.HSL=d9});var Ox=Z(vh=>{"use strict";Object.defineProperty(vh,"__esModule",{value:!0});vh.HSV=void 0;var Yr=be(),A0=lt(),I0=Se(),c9=function(e){let t=e.data,i=t.length,n=Math.pow(2,this.value()),o=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,r=n*o*Math.cos(s*Math.PI/180),a=n*o*Math.sin(s*Math.PI/180),l=.299*n+.701*r+.167*a,d=.587*n-.587*r+.33*a,c=.114*n-.114*r-.497*a,u=.299*n-.299*r-.328*a,h=.587*n+.413*r+.035*a,p=.114*n-.114*r+.293*a,g=.299*n-.3*r+1.25*a,f=.587*n-.586*r-1.05*a,m=.114*n+.886*r-.2*a;for(let C=0;C<i;C+=4){let v=t[C+0],w=t[C+1],y=t[C+2],S=t[C+3];t[C+0]=l*v+d*w+c*y,t[C+1]=u*v+h*w+p*y,t[C+2]=g*v+f*w+m*y,t[C+3]=S}};vh.HSV=c9;Yr.Factory.addGetterSetter(A0.Node,"hue",0,(0,I0.getNumberValidator)(),Yr.Factory.afterSetFilter);Yr.Factory.addGetterSetter(A0.Node,"saturation",0,(0,I0.getNumberValidator)(),Yr.Factory.afterSetFilter);Yr.Factory.addGetterSetter(A0.Node,"value",0,(0,I0.getNumberValidator)(),Yr.Factory.afterSetFilter)});var Nx=Z(wh=>{"use strict";Object.defineProperty(wh,"__esModule",{value:!0});wh.Invert=void 0;var u9=function(e){let t=e.data,i=t.length;for(let n=0;n<i;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2]};wh.Invert=u9});var Vx=Z(yh=>{"use strict";Object.defineProperty(yh,"__esModule",{value:!0});yh.Kaleidoscope=void 0;var bh=be(),Hx=lt(),Bx=it(),Gx=Se(),h9=function(e,t,i){let n=e.data,o=t.data,s=e.width,r=e.height,a=i.polarCenterX||s/2,l=i.polarCenterY||r/2,d=Math.sqrt(a*a+l*l),c=s-a,u=r-l,h=Math.sqrt(c*c+u*u);d=h>d?h:d;let p=r,g=s,f=360/g*Math.PI/180;for(let m=0;m<g;m+=1){let C=Math.sin(m*f),v=Math.cos(m*f);for(let w=0;w<p;w+=1){c=Math.floor(a+d*w/p*v),u=Math.floor(l+d*w/p*C);let y=(u*s+c)*4,S=n[y+0],x=n[y+1],E=n[y+2],T=n[y+3];y=(m+w*s)*4,o[y+0]=S,o[y+1]=x,o[y+2]=E,o[y+3]=T}}},p9=function(e,t,i){let n=e.data,o=t.data,s=e.width,r=e.height,a=i.polarCenterX||s/2,l=i.polarCenterY||r/2,d=Math.sqrt(a*a+l*l),c=s-a,u=r-l,h=Math.sqrt(c*c+u*u);d=h>d?h:d;let p=r,g=s,f=i.polarRotation||0,m,C;for(c=0;c<s;c+=1)for(u=0;u<r;u+=1){let v=c-a,w=u-l,y=Math.sqrt(v*v+w*w)*p/d,S=(Math.atan2(w,v)*180/Math.PI+360+f)%360;S=S*g/360,m=Math.floor(S),C=Math.floor(y);let x=(C*s+m)*4,E=n[x+0],T=n[x+1],L=n[x+2],O=n[x+3];x=(u*s+c)*4,o[x+0]=E,o[x+1]=T,o[x+2]=L,o[x+3]=O}},g9=function(e){let t=e.width,i=e.height,n,o,s,r,a,l,d,c,u,h,p=Math.round(this.kaleidoscopePower()),g=Math.round(this.kaleidoscopeAngle()),f=Math.floor(t*(g%360)/360);if(p<1)return;let m=Bx.Util.createCanvasElement();m.width=t,m.height=i;let C=m.getContext("2d").getImageData(0,0,t,i);Bx.Util.releaseCanvas(m),h9(e,C,{polarCenterX:t/2,polarCenterY:i/2});let v=t/Math.pow(2,p);for(;v<=8;)v=v*2,p-=1;v=Math.ceil(v);let w=v,y=0,S=w,x=1;for(f+v>t&&(y=w,S=0,x=-1),o=0;o<i;o+=1)for(n=y;n!==S;n+=x)s=Math.round(n+f)%t,u=(t*o+s)*4,a=C.data[u+0],l=C.data[u+1],d=C.data[u+2],c=C.data[u+3],h=(t*o+n)*4,C.data[h+0]=a,C.data[h+1]=l,C.data[h+2]=d,C.data[h+3]=c;for(o=0;o<i;o+=1)for(w=Math.floor(v),r=0;r<p;r+=1){for(n=0;n<w+1;n+=1)u=(t*o+n)*4,a=C.data[u+0],l=C.data[u+1],d=C.data[u+2],c=C.data[u+3],h=(t*o+w*2-n-1)*4,C.data[h+0]=a,C.data[h+1]=l,C.data[h+2]=d,C.data[h+3]=c;w*=2}p9(C,e,{polarRotation:0})};yh.Kaleidoscope=g9;bh.Factory.addGetterSetter(Hx.Node,"kaleidoscopePower",2,(0,Gx.getNumberValidator)(),bh.Factory.afterSetFilter);bh.Factory.addGetterSetter(Hx.Node,"kaleidoscopeAngle",0,(0,Gx.getNumberValidator)(),bh.Factory.afterSetFilter)});var Wx=Z(xh=>{"use strict";Object.defineProperty(xh,"__esModule",{value:!0});xh.Mask=void 0;var zx=be(),f9=lt(),m9=Se();function Sh(e,t,i){let n=(i*e.width+t)*4,o=[];return o.push(e.data[n++],e.data[n++],e.data[n++],e.data[n++]),o}function Nl(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2))}function C9(e){let t=[0,0,0];for(let i=0;i<e.length;i++)t[0]+=e[i][0],t[1]+=e[i][1],t[2]+=e[i][2];return t[0]/=e.length,t[1]/=e.length,t[2]/=e.length,t}function v9(e,t){let i=Sh(e,0,0),n=Sh(e,e.width-1,0),o=Sh(e,0,e.height-1),s=Sh(e,e.width-1,e.height-1),r=t||10;if(Nl(i,n)<r&&Nl(n,s)<r&&Nl(s,o)<r&&Nl(o,i)<r){let a=C9([n,i,s,o]),l=[];for(let d=0;d<e.width*e.height;d++){let c=Nl(a,[e.data[d*4],e.data[d*4+1],e.data[d*4+2]]);l[d]=c<r?0:255}return l}}function w9(e,t){for(let i=0;i<e.width*e.height;i++)e.data[4*i+3]=t[i]}function b9(e,t,i){let n=[1,1,1,1,0,1,1,1,1],o=Math.round(Math.sqrt(n.length)),s=Math.floor(o/2),r=[];for(let a=0;a<i;a++)for(let l=0;l<t;l++){let d=a*t+l,c=0;for(let u=0;u<o;u++)for(let h=0;h<o;h++){let p=a+u-s,g=l+h-s;if(p>=0&&p<i&&g>=0&&g<t){let f=p*t+g,m=n[u*o+h];c+=e[f]*m}}r[d]=c===2040?255:0}return r}function y9(e,t,i){let n=[1,1,1,1,1,1,1,1,1],o=Math.round(Math.sqrt(n.length)),s=Math.floor(o/2),r=[];for(let a=0;a<i;a++)for(let l=0;l<t;l++){let d=a*t+l,c=0;for(let u=0;u<o;u++)for(let h=0;h<o;h++){let p=a+u-s,g=l+h-s;if(p>=0&&p<i&&g>=0&&g<t){let f=p*t+g,m=n[u*o+h];c+=e[f]*m}}r[d]=c>=1020?255:0}return r}function S9(e,t,i){let n=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],o=Math.round(Math.sqrt(n.length)),s=Math.floor(o/2),r=[];for(let a=0;a<i;a++)for(let l=0;l<t;l++){let d=a*t+l,c=0;for(let u=0;u<o;u++)for(let h=0;h<o;h++){let p=a+u-s,g=l+h-s;if(p>=0&&p<i&&g>=0&&g<t){let f=p*t+g,m=n[u*o+h];c+=e[f]*m}}r[d]=c}return r}var x9=function(e){let t=this.threshold(),i=v9(e,t);return i&&(i=b9(i,e.width,e.height),i=y9(i,e.width,e.height),i=S9(i,e.width,e.height),w9(e,i)),e};xh.Mask=x9;zx.Factory.addGetterSetter(f9.Node,"threshold",0,(0,m9.getNumberValidator)(),zx.Factory.afterSetFilter)});var qx=Z(Eh=>{"use strict";Object.defineProperty(Eh,"__esModule",{value:!0});Eh.Noise=void 0;var Ux=be(),E9=lt(),R9=Se(),P9=function(e){let t=this.noise()*255,i=e.data,n=i.length,o=t/2;for(let s=0;s<n;s+=4)i[s+0]+=o-2*o*Math.random(),i[s+1]+=o-2*o*Math.random(),i[s+2]+=o-2*o*Math.random()};Eh.Noise=P9;Ux.Factory.addGetterSetter(E9.Node,"noise",.2,(0,R9.getNumberValidator)(),Ux.Factory.afterSetFilter)});var jx=Z(Rh=>{"use strict";Object.defineProperty(Rh,"__esModule",{value:!0});Rh.Pixelate=void 0;var $x=be(),M9=it(),k9=lt(),D9=Se(),F9=function(e){let t=Math.ceil(this.pixelSize()),i=e.width,n=e.height,o=Math.ceil(i/t),s=Math.ceil(n/t),r=e.data;if(t<=0){M9.Util.error("pixelSize value can not be <= 0");return}for(let a=0;a<o;a+=1)for(let l=0;l<s;l+=1){let d=0,c=0,u=0,h=0,p=a*t,g=p+t,f=l*t,m=f+t,C=0;for(let v=p;v<g;v+=1)if(!(v>=i))for(let w=f;w<m;w+=1){if(w>=n)continue;let y=(i*w+v)*4;d+=r[y+0],c+=r[y+1],u+=r[y+2],h+=r[y+3],C+=1}d=d/C,c=c/C,u=u/C,h=h/C;for(let v=p;v<g;v+=1)if(!(v>=i))for(let w=f;w<m;w+=1){if(w>=n)continue;let y=(i*w+v)*4;r[y+0]=d,r[y+1]=c,r[y+2]=u,r[y+3]=h}}};Rh.Pixelate=F9;$x.Factory.addGetterSetter(k9.Node,"pixelSize",8,(0,D9.getNumberValidator)(),$x.Factory.afterSetFilter)});var Yx=Z(Ph=>{"use strict";Object.defineProperty(Ph,"__esModule",{value:!0});Ph.Posterize=void 0;var Kx=be(),T9=lt(),A9=Se(),I9=function(e){let t=Math.round(this.levels()*254)+1,i=e.data,n=i.length,o=255/t;for(let s=0;s<n;s+=1)i[s]=Math.floor(i[s]/o)*o};Ph.Posterize=I9;Kx.Factory.addGetterSetter(T9.Node,"levels",.5,(0,A9.getNumberValidator)(),Kx.Factory.afterSetFilter)});var Xx=Z(kh=>{"use strict";Object.defineProperty(kh,"__esModule",{value:!0});kh.RGB=void 0;var Mh=be(),L0=lt(),L9=Se(),_9=function(e){let t=e.data,i=t.length,n=this.red(),o=this.green(),s=this.blue();for(let r=0;r<i;r+=4){let a=(.34*t[r]+.5*t[r+1]+.16*t[r+2])/255;t[r]=a*n,t[r+1]=a*o,t[r+2]=a*s,t[r+3]=t[r+3]}};kh.RGB=_9;Mh.Factory.addGetterSetter(L0.Node,"red",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});Mh.Factory.addGetterSetter(L0.Node,"green",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});Mh.Factory.addGetterSetter(L0.Node,"blue",0,L9.RGBComponent,Mh.Factory.afterSetFilter)});var Jx=Z(Fh=>{"use strict";Object.defineProperty(Fh,"__esModule",{value:!0});Fh.RGBA=void 0;var Bl=be(),Dh=lt(),O9=Se(),N9=function(e){let t=e.data,i=t.length,n=this.red(),o=this.green(),s=this.blue(),r=this.alpha();for(let a=0;a<i;a+=4){let l=1-r;t[a]=n*r+t[a]*l,t[a+1]=o*r+t[a+1]*l,t[a+2]=s*r+t[a+2]*l}};Fh.RGBA=N9;Bl.Factory.addGetterSetter(Dh.Node,"red",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});Bl.Factory.addGetterSetter(Dh.Node,"green",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});Bl.Factory.addGetterSetter(Dh.Node,"blue",0,O9.RGBComponent,Bl.Factory.afterSetFilter);Bl.Factory.addGetterSetter(Dh.Node,"alpha",1,function(e){return this._filterUpToDate=!1,e>1?1:e<0?0:e})});var Qx=Z(Th=>{"use strict";Object.defineProperty(Th,"__esModule",{value:!0});Th.Sepia=void 0;var B9=function(e){let t=e.data,i=t.length;for(let n=0;n<i;n+=4){let o=t[n+0],s=t[n+1],r=t[n+2];t[n+0]=Math.min(255,o*.393+s*.769+r*.189),t[n+1]=Math.min(255,o*.349+s*.686+r*.168),t[n+2]=Math.min(255,o*.272+s*.534+r*.131)}};Th.Sepia=B9});var Zx=Z(Ah=>{"use strict";Object.defineProperty(Ah,"__esModule",{value:!0});Ah.Solarize=void 0;var H9=function(e){let t=e.data,i=e.width,n=e.height,o=i*4,s=n;do{let r=(s-1)*o,a=i;do{let l=r+(a-1)*4,d=t[l],c=t[l+1],u=t[l+2];d>127&&(d=255-d),c>127&&(c=255-c),u>127&&(u=255-u),t[l]=d,t[l+1]=c,t[l+2]=u}while(--a)}while(--s)};Ah.Solarize=H9});var tE=Z(Ih=>{"use strict";Object.defineProperty(Ih,"__esModule",{value:!0});Ih.Threshold=void 0;var eE=be(),G9=lt(),V9=Se(),z9=function(e){let t=this.threshold()*255,i=e.data,n=i.length;for(let o=0;o<n;o+=1)i[o]=i[o]<t?0:255};Ih.Threshold=z9;eE.Factory.addGetterSetter(G9.Node,"threshold",.5,(0,V9.getNumberValidator)(),eE.Factory.afterSetFilter)});var oE=Z(Lh=>{"use strict";Object.defineProperty(Lh,"__esModule",{value:!0});Lh.Konva=void 0;var iE=F3(),W9=A3(),U9=B3(),q9=H3(),$9=V3(),j9=z3(),nE=q3(),K9=l0(),Y9=qu(),X9=C0(),J9=K3(),Q9=Q3(),Z9=v0(),eL=ex(),tL=R0(),iL=px(),nL=bx(),oL=Sx(),sL=Rx(),rL=Mx(),aL=Dx(),lL=Tx(),dL=Ix(),cL=Lx(),uL=_x(),hL=Ox(),pL=Nx(),gL=Vx(),fL=Wx(),mL=qx(),CL=jx(),vL=Yx(),wL=Xx(),bL=Jx(),yL=Qx(),SL=Zx(),xL=tE();Lh.Konva=iE.Konva.Util._assign(iE.Konva,{Arc:W9.Arc,Arrow:U9.Arrow,Circle:q9.Circle,Ellipse:$9.Ellipse,Image:j9.Image,Label:nE.Label,Tag:nE.Tag,Line:K9.Line,Path:Y9.Path,Rect:X9.Rect,RegularPolygon:J9.RegularPolygon,Ring:Q9.Ring,Sprite:Z9.Sprite,Star:eL.Star,Text:tL.Text,TextPath:iL.TextPath,Transformer:nL.Transformer,Wedge:oL.Wedge,Filters:{Blur:sL.Blur,Brighten:rL.Brighten,Contrast:aL.Contrast,Emboss:lL.Emboss,Enhance:dL.Enhance,Grayscale:cL.Grayscale,HSL:uL.HSL,HSV:hL.HSV,Invert:pL.Invert,Kaleidoscope:gL.Kaleidoscope,Mask:fL.Mask,Noise:mL.Noise,Pixelate:CL.Pixelate,Posterize:vL.Posterize,RGB:wL.RGB,RGBA:bL.RGBA,Sepia:yL.Sepia,Solarize:SL.Solarize,Threshold:xL.Threshold}})});var aE=Z((sE,rE)=>{"use strict";Object.defineProperty(sE,"__esModule",{value:!0});var EL=oE();rE.exports=EL.Konva});var v1=(()=>{class e{uploadEndpoint=Y("");maxFileSize=Y(10*1024*1024);allowedFileTypes=Y(["image/*","application/pdf",".doc",".docx"]);maxNumberOfFiles=Y(10);note=Y("");uploadComplete=re();uploadError=re();filesAdded=re();uppy=null;ngOnInit(){this.initializeUppy()}ngOnDestroy(){this.uppy?.destroy()}initializeUppy(){this.uppy=new Pw({id:"file-uploader",autoProceed:!1,allowMultipleUploadBatches:!0,restrictions:{maxFileSize:this.maxFileSize(),maxNumberOfFiles:this.maxNumberOfFiles(),allowedFileTypes:this.allowedFileTypes()}}).use(kw,{inline:!0,target:"#uppy-dashboard",height:400,width:"100%",theme:"auto",proudlyDisplayPoweredByUppy:!1,hideProgressDetails:!1,hideUploadButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideCancelButton:!1,showRemoveButtonAfterComplete:!0,note:this.note()||"Images up to 10MB, PDFs and documents allowed"}).use(Mw,{quality:.8,limit:10}),this.uploadEndpoint()&&this.uppy.use(Dw,{endpoint:this.uploadEndpoint(),retryDelays:[0,1e3,3e3,5e3],chunkSize:5*1024*1024}),this.uppy.on("file-added",()=>{this.filesAdded.emit(this.uppy?.getFiles().length??0)}),this.uppy.on("complete",i=>{let n=[];i.successful&&(n=i.successful.map(o=>({id:o.id,name:o.name,size:o.size,type:o.type??"unknown",url:o.response?.uploadURL}))),this.uploadComplete.emit(n)}),this.uppy.on("error",i=>{this.uploadError.emit(i)}),this.uppy.on("upload-error",(i,n)=>{console.error("Upload error for file:",i?.name,n),this.uploadError.emit(n)})}clearFiles(){this.uppy?.cancelAll()}getFiles(){return this.uppy?.getFiles()??[]}upload(){this.uppy?.upload()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ee({type:e,selectors:[["gh-file-upload"]],inputs:{uploadEndpoint:[1,"uploadEndpoint"],maxFileSize:[1,"maxFileSize"],allowedFileTypes:[1,"allowedFileTypes"],maxNumberOfFiles:[1,"maxNumberOfFiles"],note:[1,"note"]},outputs:{uploadComplete:"uploadComplete",uploadError:"uploadError",filesAdded:"filesAdded"},decls:1,vars:0,consts:[["id","uppy-dashboard"]],template:function(n,o){n&1&&iw(0,"div",0)},styles:["[_nghost-%COMP%]{display:block;width:100%}#uppy-dashboard[_ngcontent-%COMP%]{border-radius:.5rem;overflow:hidden}[_nghost-%COMP%]     .uppy-Dashboard-inner{background-color:hsl(var(--background));border:1px solid hsl(var(--border));border-radius:.5rem}[_nghost-%COMP%]     .uppy-Dashboard-AddFiles{border-color:hsl(var(--border))}[_nghost-%COMP%]     .uppy-Dashboard-AddFiles-title{color:hsl(var(--foreground))}[_nghost-%COMP%]     .uppy-Dashboard-note{color:hsl(var(--muted-foreground))}[_nghost-%COMP%]     .uppy-DashboardContent-bar{background-color:hsl(var(--muted));border-bottom:1px solid hsl(var(--border))}[_nghost-%COMP%]     .uppy-DashboardContent-title{color:hsl(var(--foreground))}[_nghost-%COMP%]     .uppy-DashboardItem{border-bottom:1px solid hsl(var(--border))}[_nghost-%COMP%]     .uppy-DashboardItem-name{color:hsl(var(--foreground))}[_nghost-%COMP%]     .uppy-DashboardItem-status{color:hsl(var(--muted-foreground))}[_nghost-%COMP%]     .uppy-StatusBar{background-color:hsl(var(--muted));border-top:1px solid hsl(var(--border))}[_nghost-%COMP%]     .uppy-StatusBar-actionBtn--upload{background-color:hsl(var(--primary));color:hsl(var(--primary-foreground))}[_nghost-%COMP%]     .uppy-StatusBar-actionBtn--upload:hover{background-color:hsl(var(--primary) / .9)}[_nghost-%COMP%]     .uppy-StatusBar-progress{background-color:hsl(var(--primary))}@media (prefers-color-scheme: dark){[_nghost-%COMP%]     .uppy-Dashboard-AddFiles{background-color:hsl(var(--background))}[_nghost-%COMP%]     .uppy-Dashboard-dropFilesHereHint{color:hsl(var(--muted-foreground))}}"],changeDetection:0})}return e})();var sM=["*"],Ta=(()=>{class e extends Da{side=Y("top");sideState=aw(()=>this.side());constructor(){super(),Ye(()=>{let i=this.sideState();ls(()=>{i==="top"&&this.mutablePositionStrategy.set(this.positionBuilder.global().top()),i==="bottom"&&this.mutablePositionStrategy.set(this.positionBuilder.global().bottom()),i==="left"&&this.mutablePositionStrategy.set(this.positionBuilder.global().left()),i==="right"&&this.mutablePositionStrategy.set(this.positionBuilder.global().right())})})}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ee({type:e,selectors:[["brn-sheet"]],inputs:{side:[1,"side"]},exportAs:["brnSheet"],features:[ze([{provide:Da,useExisting:ns(()=>e)}]),rs],ngContentSelectors:sM,decls:1,vars:0,template:function(n,o){n&1&&(Gi(),Vi(0))},encapsulation:2,changeDetection:0})}return e})(),w1=(()=>{class e extends p1{static \u0275fac=(()=>{let i;return function(o){return(i||(i=fo(e)))(o||e)}})();static \u0275dir=Re({type:e,selectors:[["button","brnSheetClose",""]],features:[rs]})}return e})(),b1=(()=>{class e extends g1{side=ie(Ta).sideState;static \u0275fac=(()=>{let i;return function(o){return(i||(i=fo(e)))(o||e)}})();static \u0275dir=Re({type:e,selectors:[["","brnSheetContent",""]],features:[ze([u1(()=>e),d1(()=>e)]),rs]})}return e})();var y1=(()=>{class e extends f1{static \u0275fac=(()=>{let i;return function(o){return(i||(i=fo(e)))(o||e)}})();static \u0275cmp=Ee({type:e,selectors:[["brn-sheet-overlay"]],features:[ze([r1(()=>e)]),rs],decls:0,vars:0,template:function(n,o){},encapsulation:2,changeDetection:0})}return e})();var Yp=(()=>{class e{_classSettable=s1({optional:!0,host:!0});userClass=Y("",{alias:"class"});_computedClass=ae(()=>ue("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 bg-black/50",this.userClass()));constructor(){Ye(()=>{let i=this._computedClass();ls(()=>this._classSettable?.setClassToCustomElement(i))})}static \u0275fac=function(n){return new(n||e)};static \u0275dir=Re({type:e,selectors:[["","hlmSheetOverlay",""],["brn-sheet-overlay","hlm",""]],hostVars:2,hostBindings:function(n,o){n&2&&Fe(o._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var rM=["*"],Xp=(()=>{class e extends Ta{static \u0275fac=(()=>{let i;return function(o){return(i||(i=fo(e)))(o||e)}})();static \u0275cmp=Ee({type:e,selectors:[["hlm-sheet"]],exportAs:["hlmSheet"],features:[ze([{provide:Da,useExisting:ns(()=>Ta)},{provide:Ta,useExisting:ns(()=>e)},h1({})]),rs],ngContentSelectors:rM,decls:2,vars:0,consts:[["hlm",""]],template:function(n,o){n&1&&(Gi(),oe(0,"brn-sheet-overlay",0),Vi(1))},dependencies:[y1,Yp],encapsulation:2,changeDetection:0})}return e})();var Jp=(()=>{class e{userClass=Y("",{alias:"class"});_computedClass=ae(()=>ue("ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=Re({type:e,selectors:[["","hlmSheetClose",""],["","brnSheetClose","","hlm",""]],hostVars:2,hostBindings:function(n,o){n&2&&Fe(o._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var aM=["*"],lM=_d("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b",bottom:"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",left:"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",right:"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm"}},defaultVariants:{side:"right"}}),Qp=(()=>{class e{_stateProvider=c1({host:!0});_sideProvider=l1({host:!0});state=this._stateProvider.state??Be("closed");_renderer=ie(tr);_element=ie(si);constructor(){Ye(()=>{this._renderer.setAttribute(this._element.nativeElement,"data-state",this.state())})}userClass=Y("",{alias:"class"});_computedClass=ae(()=>ue(lM({side:this._sideProvider.side()}),this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ee({type:e,selectors:[["hlm-sheet-content"]],hostVars:3,hostBindings:function(n,o){n&2&&(Dn("data-state",o.state()),Fe(o._computedClass()))},inputs:{userClass:[1,"class","userClass"]},features:[ze([ai({lucideX:n1})])],ngContentSelectors:aM,decls:5,vars:0,consts:[["brnSheetClose","","hlm",""],[1,"sr-only"],["hlm","","size","sm","name","lucideX"]],template:function(n,o){n&1&&(Gi(),Vi(0),M(1,"button",0)(2,"span",1),H(3,"Close"),k(),oe(4,"ng-icon",2),k())},dependencies:[Jp,w1,Ht,Gt],encapsulation:2,changeDetection:0})}return e})();var dM={sidebarWidth:"16rem",sidebarWidthMobile:"18rem",sidebarWidthIcon:"3rem",sidebarCookieName:"sidebar_state",sidebarCookieMaxAge:3600*24*7,sidebarKeyboardShortcut:"b",mobileBreakpoint:"768px"},cM=new ss("HlmSidebarConfig");function pr(){return ie(cM,{optional:!0})??dM}var ds=(()=>{class e{_config=pr();_document=ie(Md);_window=this._document.defaultView;_open=Be(!0);_openMobile=Be(!1);_isMobile=Be(!1);_variant=Be("sidebar");_mediaQuery=null;open=this._open.asReadonly();openMobile=this._openMobile.asReadonly();isMobile=this._isMobile.asReadonly();variant=this._variant.asReadonly();state=ae(()=>this._open()?"expanded":"collapsed");constructor(){let i=ie(Qv);tw(()=>{if(!this._window)return;let n=this._document.cookie.split("; ").find(l=>l.startsWith(`${this._config.sidebarCookieName}=`));if(n){let l=n.split("=")[1];this._open.set(l==="true")}this._mediaQuery=this._window.matchMedia(`(max-width: ${this._config.mobileBreakpoint})`),this._isMobile.set(this._mediaQuery.matches);let o=l=>{this._isMobile.set(l.matches),l.matches||this._openMobile.set(!1)};this._mediaQuery.addEventListener("change",o);let s=l=>{l.key===this._config.sidebarKeyboardShortcut&&(l.ctrlKey||l.metaKey)&&(l.preventDefault(),this.toggleSidebar())};this._window.addEventListener("keydown",s);let r,a=()=>{this._window&&(r&&this._window.clearTimeout(r),r=this._window.setTimeout(()=>{this._mediaQuery&&this._isMobile.set(this._mediaQuery.matches)},100))};this._window.addEventListener("resize",a),i.onDestroy(()=>{this._window&&(this._mediaQuery&&this._mediaQuery.removeEventListener("change",o),this._window.removeEventListener("keydown",s),this._window.removeEventListener("resize",a),r&&this._window.clearTimeout(r))})})}setOpen(i){this._open.set(i),this._document.cookie=`${this._config.sidebarCookieName}=${i}; path=/; max-age=${this._config.sidebarCookieMaxAge}`}setOpenMobile(i){this._isMobile()&&this._openMobile.set(i)}setVariant(i){this._variant.set(i)}toggleSidebar(){this._isMobile()?this._openMobile.update(i=>!i):this.setOpen(!this._open())}static \u0275fac=function(n){return new(n||e)};static \u0275prov=Ra({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var uM=["*"];function hM(e,t){e&1&&Vi(0)}function pM(e,t){e&1&&sr(0)}function gM(e,t){if(e&1&&(M(0,"div",4),or(1,pM,1,0,"ng-container",5),k()),e&2){let i=ce(),n=Dd(1);Fe(i._nonCollapsibleComputedClass()),F(),De("ngTemplateOutlet",n)}}function fM(e,t){e&1&&sr(0)}function mM(e,t){if(e&1&&(M(0,"hlm-sheet-content",8)(1,"div",9),or(2,fM,1,0,"ng-container",5),k()()),e&2){let i=ce(2),n=Dd(1);Ji("--sidebar-width",i.sidebarWidthMobile()),F(2),De("ngTemplateOutlet",n)}}function CM(e,t){if(e&1){let i=Qt();M(0,"hlm-sheet",6),se("stateChanged",function(o){Te(i);let s=ce();return Ae(s._sidebarService.setOpenMobile(o==="open"))}),or(1,mM,3,3,"hlm-sheet-content",7),k()}if(e&2){let i=ce();De("side",i.side())("state",i._sidebarService.openMobile()?"open":"closed")}}function vM(e,t){e&1&&sr(0)}function wM(e,t){if(e&1&&(M(0,"div",3),oe(1,"div",10),M(2,"div",11)(3,"div",12),or(4,vM,1,0,"ng-container",5),k()()()),e&2){let i=ce(),n=Dd(1);Dn("data-state",i._sidebarService.state())("data-collapsible",i._sidebarService.state()==="collapsed"?i.collapsible():"")("data-variant",i.variant())("data-side",i.side()),F(),Fe(i._sidebarGapComputedClass()),F(),Fe(i._sidebarContainerComputedClass()),F(2),De("ngTemplateOutlet",n)}}var Zp=(()=>{class e{_sidebarService=ie(ds);_config=pr();sidebarWidthMobile=Y(this._config.sidebarWidthMobile);side=Y("left");variant=Y(this._sidebarService.variant());collapsible=Y("offcanvas");nonCollapsibleClass=Y("");_nonCollapsibleComputedClass=ae(()=>ue("bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col",this.nonCollapsibleClass()));_sidebarGapComputedClass=ae(()=>ue("relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",this.variant()==="floating"||this.variant()==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]"));sidebarContainerClass=Y("");_sidebarContainerComputedClass=ae(()=>ue("fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex",this.side()==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",this.variant()==="floating"||this.variant()==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l",this.sidebarContainerClass()));constructor(){Ye(()=>{this._sidebarService.setVariant(this.variant())})}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ee({type:e,selectors:[["hlm-sidebar"]],inputs:{sidebarWidthMobile:[1,"sidebarWidthMobile"],side:[1,"side"],variant:[1,"variant"],collapsible:[1,"collapsible"],nonCollapsibleClass:[1,"nonCollapsibleClass"],sidebarContainerClass:[1,"sidebarContainerClass"]},ngContentSelectors:uM,decls:5,vars:1,consts:[["contentContainer",""],["data-slot","sidebar",3,"class"],[3,"side","state"],["data-slot","sidebar",1,"text-sidebar-foreground","group","peer","hidden","md:block"],["data-slot","sidebar"],[4,"ngTemplateOutlet"],[3,"stateChanged","side","state"],["data-slot","sidebar","data-sidebar","sidebar","data-mobile","true","class","bg-sidebar text-sidebar-foreground h-screen w-[var(--sidebar-width)] p-0 [&>button]:hidden",3,"--sidebar-width",4,"brnSheetContent"],["data-slot","sidebar","data-sidebar","sidebar","data-mobile","true",1,"bg-sidebar","text-sidebar-foreground","h-screen","w-[var(--sidebar-width)]","p-0","[&>button]:hidden"],[1,"flex","h-full","w-full","flex-col"],["data-slot","sidebar-gap"],["data-slot","sidebar-container"],["data-sidebar","sidebar","data-slot","sidebar-inner",1,"bg-sidebar","group-data-[variant=floating]:border-sidebar-border","flex","h-full","w-full","flex-col","group-data-[variant=floating]:rounded-lg","group-data-[variant=floating]:border","group-data-[variant=floating]:shadow"]],template:function(n,o){n&1&&(Gi(),or(0,hM,1,0,"ng-template",null,0,rw),Dt(2,gM,2,3,"div",1)(3,CM,2,2,"hlm-sheet",2)(4,wM,5,9,"div",3)),n&2&&(F(2),Ft(o.collapsible()==="none"?2:o._sidebarService.isMobile()?3:4))},dependencies:[Xp,Qp,Id,b1],encapsulation:2,changeDetection:0})}return e})();var eg=(()=>{class e{userClass=Y("",{alias:"class"});_computedClass=ae(()=>ue("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=Re({type:e,selectors:[["","hlmSidebarContent",""],["hlm-sidebar-content"]],hostAttrs:["data-slot","sidebar-content","data-sidebar","content"],hostVars:2,hostBindings:function(n,o){n&2&&Fe(o._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var tg=(()=>{class e{userClass=Y("",{alias:"class"});_computedClass=ae(()=>ue("flex flex-col gap-2 p-2",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=Re({type:e,selectors:[["","hlmSidebarFooter",""],["hlm-sidebar-footer"]],hostAttrs:["data-slot","sidebar-footer","data-sidebar","footer"],hostVars:2,hostBindings:function(n,o){n&2&&Fe(o._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var ig=(()=>{class e{userClass=Y("",{alias:"class"});_computedClass=ae(()=>ue("relative flex w-full min-w-0 flex-col p-2",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=Re({type:e,selectors:[["","hlmSidebarGroup",""],["hlm-sidebar-group"]],hostAttrs:["data-slot","sidebar-group","data-sidebar","group"],hostVars:2,hostBindings:function(n,o){n&2&&Fe(o._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var ng=(()=>{class e{userClass=Y("",{alias:"class"});_computedClass=ae(()=>ue("w-full text-sm",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=Re({type:e,selectors:[["div","hlmSidebarGroupContent",""]],hostAttrs:["data-slot","sidebar-group-content","data-sidebar","group-content"],hostVars:2,hostBindings:function(n,o){n&2&&Fe(o._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var og=(()=>{class e{userClass=Y("",{alias:"class"});_computedClass=ae(()=>ue("text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium transition-[margin,opa] duration-200 ease-linear outline-none focus-visible:ring-2 [&>_ng-icon]:size-4 [&>_ng-icon]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=Re({type:e,selectors:[["div","hlmSidebarGroupLabel",""],["button","hlmSidebarGroupLabel",""]],hostAttrs:["data-slot","sidebar-group-label","data-sidebar","group-label"],hostVars:2,hostBindings:function(n,o){n&2&&Fe(o._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var sg=(()=>{class e{userClass=Y("",{alias:"class"});_computedClass=ae(()=>ue("flex flex-col gap-2 p-2",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=Re({type:e,selectors:[["","hlmSidebarHeader",""],["hlm-sidebar-header"]],hostAttrs:["data-slot","sidebar-header","data-sidebar","header"],hostVars:2,hostBindings:function(n,o){n&2&&Fe(o._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var rg=(()=>{class e{userClass=Y("",{alias:"class"});_computedClass=ae(()=>ue("flex w-full min-w-0 flex-col gap-1",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=Re({type:e,selectors:[["ul","hlmSidebarMenu",""]],hostAttrs:["data-slot","sidebar-menu","data-sidebar","menu"],hostVars:2,hostBindings:function(n,o){n&2&&Fe(o._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var bM=["tooltip"];function yM(e,t){if(e&1&&H(0),e&2){let i=ce();me(" ",i.content," ")}}function SM(e,t){if(e&1&&sr(0,2),e&2){let i=ce();De("ngTemplateOutlet",i.content)}}var xM=(()=>{class e{tooltipTemplate=Be(null);static \u0275fac=function(n){return new(n||e)};static \u0275dir=Re({type:e,selectors:[["","brnTooltip",""]]})}return e})(),EM=(()=>{class e{_cdr=ie(Td);_isBrowser=cw(ie(ew));_renderer2=ie(tr);_contentHovered=Be(!1);tooltipClasses=Be("");side=Be("above");content=null;_showTimeoutId;_hideTimeoutId;_animateTimeoutId;triggerElement;mouseLeaveHideDelay=0;exitAnimationDuration=0;tooltip=lw("tooltip",{read:si});_closeOnInteraction=!1;_isVisible=!1;_onHide=new Vp;afterHidden=this._onHide.asObservable();show(i){this._hideTimeoutId!==null&&clearTimeout(this._hideTimeoutId),this._animateTimeoutId!==null&&clearTimeout(this._animateTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleDataAttributes(!0,this.side()),this._toggleVisibility(!0),this._showTimeoutId=void 0},i)}hide(i,n){this._showTimeoutId!==null&&clearTimeout(this._showTimeoutId),this._animateTimeoutId=setTimeout(()=>{this._animateTimeoutId=void 0,!this._contentHovered()&&this._toggleDataAttributes(!1,this.side())},Math.max(i,0)),this._hideTimeoutId=setTimeout(()=>{this._hideTimeoutId=void 0,!this._contentHovered()&&this._toggleVisibility(!1)},i+n)}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this.triggerElement=void 0}_isTypeOfString(i){return typeof i=="string"}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0,0)}_markForCheck(){this._cdr.markForCheck()}_handleMouseLeave({relatedTarget:i}){(!i||!this.triggerElement?.contains(i))&&(this.isVisible()?this.hide(this.mouseLeaveHideDelay,this.exitAnimationDuration):this._finalize(!1)),this._contentHovered.set(!1)}_cancelPendingAnimations(){this._showTimeoutId!==null&&clearTimeout(this._showTimeoutId),this._hideTimeoutId!==null&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalize(i){i?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(i){let n=this.tooltip()?.nativeElement;!n||!this._isBrowser||(this._renderer2.setStyle(n,"visibility",i?"visible":"hidden"),i?this._renderer2.removeStyle(n,"display"):this._renderer2.setStyle(n,"display","none"),this._isVisible=i)}_toggleDataAttributes(i,n){let o=this.tooltip()?.nativeElement;!o||!this._isBrowser||(this._renderer2.setAttribute(o,"data-side",n),this._renderer2.setAttribute(o,"data-state",i?"open":"closed"))}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ee({type:e,selectors:[["brn-tooltip-content"]],viewQuery:function(n,o){n&1&&nw(o.tooltip,bM,5,si),n&2&&Ma()},hostAttrs:["aria-hidden","true"],hostVars:2,hostBindings:function(n,o){n&1&&se("mouseleave",function(r){return o._handleMouseLeave(r)}),n&2&&Ji("zoom",o.isVisible()?1:null)},decls:4,vars:5,consts:[["tooltip",""],[3,"mouseenter","mouseleave"],[3,"ngTemplateOutlet"]],template:function(n,o){if(n&1){let s=Qt();M(0,"div",1,0),se("mouseenter",function(){return Te(s),Ae(o._contentHovered.set(!0))})("mouseleave",function(){return Te(s),Ae(o._contentHovered.set(!1))}),Dt(2,yM,1,1)(3,SM,1,1,"ng-container",2),k()}n&2&&(Fe(o.tooltipClasses()),Ji("visibility","hidden"),F(2),Ft(o._isTypeOfString(o.content)?2:3))},dependencies:[Id],encapsulation:2,changeDetection:0})}return e})();var ag={showDelay:0,hideDelay:0,exitAnimationDuration:0,touchendHideDelay:1500},E1=new ss("brn-tooltip-default-options",{providedIn:"root",factory:()=>ag});function R1(e){return{provide:E1,useValue:b(b({},ag),e)}}function RM(){return ie(E1,{optional:!0})??ag}var PM=20;function S1(e){return Error(`Tooltip position "${e}" is invalid.`)}var P1=new ss("brn-tooltip-scroll-strategy"),MM={provide:P1,deps:[Kp],useFactory:e=>()=>e.scrollStrategies.reposition({scrollThrottle:PM})},kM="tooltip-panel",x1=yw({passive:!0}),DM=500,FM=8,TM=8,M1=(()=>{class e{_tooltipDirective=ie(xM,{optional:!0});_tooltipComponent=EM;_cssClassPrefix="brn";_destroyed=new Vp;_passiveListeners=[];_defaultOptions=RM();_overlay=ie(Kp);_elementRef=ie(si);_scrollDispatcher=ie(Rw);_viewContainerRef=ie(ir);_ngZone=ie(as);_platform=ie(bw);_ariaDescriber=ie(m1);_focusMonitor=ie(Sw);_dir=ie(Ew);_scrollStrategy=ie(P1);_document=ie(Md);_portal;_viewInitialized=!1;_pointerExitEventsInitialized=!1;_viewportMargin=8;_currentPosition;_touchstartTimeout;_overlayRef=null;_tooltipInstance=null;position=Y(this._defaultOptions?.position??"above");positionAtOrigin=Y(this._defaultOptions?.positionAtOrigin??!1,{transform:P});brnTooltipDisabled=Y(!1,{transform:P});showDelay=Y(this._defaultOptions?.showDelay??0,{transform:Ad});hideDelay=Y(this._defaultOptions?.hideDelay??0,{transform:Ad});exitAnimationDuration=Y(this._defaultOptions?.exitAnimationDuration??0,{transform:Ad});tooltipContentClasses=Y(this._defaultOptions?.tooltipContentClasses??"",{alias:"tooltipContentClasses"});computedTooltipContentClasses=ae(()=>Be(this.tooltipContentClasses()));touchGestures=Y(this._defaultOptions?.touchGestures??"auto");ariaDescribedBy=Y("",{alias:"aria-describedby"});computedAriaDescribedBy=ae(()=>Be(this.ariaDescribedBy()));ariaDescribedByPrevious=o1(this.computedAriaDescribedBy);brnTooltipTrigger=Y(null);brnTooltipTriggerState=ae(()=>this._tooltipDirective?this._tooltipDirective.tooltipTemplate():this.brnTooltipTrigger());constructor(){this._dir.change.pipe(kn(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)}),this._viewportMargin=FM,this._initBrnTooltipTriggerEffect(),this._initAriaDescribedByPreviousEffect(),this._initTooltipContentClassesEffect(),this._initPositionEffect(),this._initPositionAtOriginEffect(),this._initBrnTooltipDisabledEffect(),this._initExitAnimationDurationEffect(),this._initHideDelayEffect()}setTooltipContentClasses(i){this.computedTooltipContentClasses().set(i)}setAriaDescribedBy(i){this.computedAriaDescribedBy().set(i)}_initPositionEffect(){Ye(()=>{this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition())})}_initBrnTooltipDisabledEffect(){Ye(()=>{this.brnTooltipDisabled()?this.hide(0):this._setupPointerEnterEventsIfNeeded()})}_initPositionAtOriginEffect(){Ye(()=>{let i=this.positionAtOrigin();this._detach(),this._overlayRef=null})}_initTooltipContentClassesEffect(){Ye(()=>{this._tooltipInstance&&this._tooltipInstance.tooltipClasses.set(this.computedTooltipContentClasses()()??"")})}_initAriaDescribedByPreviousEffect(){Ye(()=>{let i=this.computedAriaDescribedBy()();this._ariaDescriber.removeDescription(this._elementRef.nativeElement,ls(()=>this.ariaDescribedByPrevious()()),"tooltip"),i&&!this._isTooltipVisible()&&this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriber.describe(this._elementRef.nativeElement,i,"tooltip")})})})}_initBrnTooltipTriggerEffect(){Ye(()=>{let i=this.brnTooltipTriggerState(),n=this._isTooltipVisible();ls(()=>{!i&&n?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipContent())})})}_initExitAnimationDurationEffect(){Ye(()=>{this._tooltipInstance&&(this._tooltipInstance.exitAnimationDuration=this.exitAnimationDuration())})}_initHideDelayEffect(){Ye(()=>{this._tooltipInstance&&(this._tooltipInstance.mouseLeaveHideDelay=this.hideDelay())})}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(kn(this._destroyed)).subscribe(i=>{i?i==="keyboard"&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))}),a1&&!this.computedAriaDescribedBy()&&console.warn('BrnTooltip: "aria-describedby" attribute is required for accessibility')}ngOnDestroy(){let i=this._elementRef.nativeElement;clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([n,o])=>i.removeEventListener(n,o,x1)),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(i,this.computedAriaDescribedBy()(),"tooltip"),this._focusMonitor.stopMonitoring(i)}show(i=this.showDelay(),n){if(this.brnTooltipDisabled()||this._isTooltipVisible()){this._tooltipInstance?._cancelPendingAnimations();return}let o=this._createOverlay(n);this._detach(),this._portal=this._portal||new ww(this._tooltipComponent,this._viewContainerRef);let s=this._tooltipInstance=o.attach(this._portal).instance;s.triggerElement=this._elementRef.nativeElement,s.mouseLeaveHideDelay=this.hideDelay(),s.tooltipClasses.set(this.computedTooltipContentClasses()()),s.exitAnimationDuration=this.exitAnimationDuration(),s.side.set(this._currentPosition??"above"),s.afterHidden.pipe(kn(this._destroyed)).subscribe(()=>this._detach()),this._updateTooltipContent(),s.show(i)}hide(i=this.hideDelay(),n=this.exitAnimationDuration()){let o=this._tooltipInstance;o&&(o.isVisible()?o.hide(i,n):(o._cancelPendingAnimations(),this._detach()))}toggle(i){this._isTooltipVisible()?this.hide():this.show(void 0,i)}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(i){if(this._overlayRef){let s=this._overlayRef.getConfig().positionStrategy;if((!this.positionAtOrigin()||!i)&&s._origin instanceof si)return this._overlayRef;this._detach()}let n=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),o=this._overlay.position().flexibleConnectedTo(this.positionAtOrigin()?i||this._elementRef:this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(n);return o.positionChanges.pipe(kn(this._destroyed)).subscribe(s=>{this._updateCurrentPositionClass(s.connectionPair),this._tooltipInstance&&s.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:o,panelClass:`${this._cssClassPrefix}-${kM}`,scrollStrategy:this._scrollStrategy()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(kn(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(kn(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(kn(this._destroyed)).subscribe(s=>{this._isTooltipVisible()&&s.key==="Escape"&&!xw(s)&&(s.preventDefault(),s.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._overlayRef}_detach(){this._overlayRef?.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(i){let n=i.getConfig().positionStrategy,o=this._getOrigin(),s=this._getOverlayPosition();n.withPositions([this._addOffset(b(b({},o.main),s.main)),this._addOffset(b(b({},o.fallback),s.fallback))])}_addOffset(i){let n=TM,o=!this._dir||this._dir.value==="ltr";return i.originY==="top"?i.offsetY=-n:i.originY==="bottom"?i.offsetY=n:i.originX==="start"?i.offsetX=o?-n:n:i.originX==="end"&&(i.offsetX=o?n:-n),i}_getOrigin(){let i=!this._dir||this._dir.value==="ltr",n=this.position(),o;if(n==="above"||n==="below")o={originX:"center",originY:n==="above"?"top":"bottom"};else if(n==="before"||n==="left"&&i||n==="right"&&!i)o={originX:"start",originY:"center"};else if(n==="after"||n==="right"&&i||n==="left"&&!i)o={originX:"end",originY:"center"};else if(typeof ka()>"u"||ka())throw S1(n);let{x:s,y:r}=this._invertPosition(o.originX,o.originY);return{main:o,fallback:{originX:s,originY:r}}}_getOverlayPosition(){let i=!this._dir||this._dir.value==="ltr",n=this.position(),o;if(n==="above")o={overlayX:"center",overlayY:"bottom"};else if(n==="below")o={overlayX:"center",overlayY:"top"};else if(n==="before"||n==="left"&&i||n==="right"&&!i)o={overlayX:"end",overlayY:"center"};else if(n==="after"||n==="right"&&i||n==="left"&&!i)o={overlayX:"start",overlayY:"center"};else if(typeof ka()>"u"||ka())throw S1(n);let{x:s,y:r}=this._invertPosition(o.overlayX,o.overlayY);return{main:o,fallback:{overlayX:s,overlayY:r}}}_updateTooltipContent(){this._tooltipInstance&&(this._tooltipInstance.content=this.brnTooltipTriggerState(),this._tooltipInstance._markForCheck(),this._ngZone.onMicrotaskEmpty.pipe(Xv(1),kn(this._destroyed)).subscribe(()=>{this._tooltipInstance&&this._overlayRef?.updatePosition()}))}_invertPosition(i,n){return this.position()==="above"||this.position()==="below"?n==="top"?n="bottom":n==="bottom"&&(n="top"):i==="end"?i="start":i==="start"&&(i="end"),{x:i,y:n}}_updateCurrentPositionClass(i){let{overlayY:n,originX:o,originY:s}=i,r;n==="center"?this._dir&&this._dir.value==="rtl"?r=o==="end"?"left":"right":r=o==="start"?"left":"right":r=n==="bottom"&&s==="top"?"above":"below",r!==this._currentPosition&&(this._tooltipInstance?.side.set(r),this._currentPosition=r)}_setupPointerEnterEventsIfNeeded(){this.brnTooltipDisabled()||!this.brnTooltipTriggerState()||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",i=>{this._setupPointerExitEventsIfNeeded();let n;i.x!==void 0&&i.y!==void 0&&(n=i),this.show(void 0,n)}]):this.touchGestures()!=="off"&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",i=>{let n=i.targetTouches?.[0],o=n?{x:n.clientX,y:n.clientY}:void 0;this._setupPointerExitEventsIfNeeded(),clearTimeout(this._touchstartTimeout),this._touchstartTimeout=setTimeout(()=>this.show(void 0,o),DM)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;let i=[];if(this._platformSupportsMouseEvents())i.push(["mouseleave",n=>{let o=n.relatedTarget;(!o||!this._overlayRef?.overlayElement.contains(o))&&this.hide()}],["wheel",n=>this._wheelListener(n)]);else if(this.touchGestures()!=="off"){this._disableNativeGesturesIfNecessary();let n=()=>{clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions?.touchendHideDelay)};i.push(["touchend",n],["touchcancel",n])}this._addListeners(i),this._passiveListeners.push(...i)}_addListeners(i){i.forEach(([n,o])=>{this._elementRef.nativeElement.addEventListener(n,o,x1)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(i){if(this._isTooltipVisible()){let n=this._document.elementFromPoint(i.clientX,i.clientY),o=this._elementRef.nativeElement;n!==o&&!o.contains(n)&&this.hide()}}_disableNativeGesturesIfNecessary(){let i=this.touchGestures();if(i!=="off"){let n=this._elementRef.nativeElement,o=n.style;(i==="on"||n.nodeName!=="INPUT"&&n.nodeName!=="TEXTAREA")&&(o.userSelect=o.msUserSelect=o.webkitUserSelect=o.MozUserSelect="none"),(i==="on"||!n.draggable)&&(o.webkitUserDrag="none"),o.touchAction="none",o.webkitTapHighlightColor="transparent"}}static \u0275fac=function(n){return new(n||e)};static \u0275dir=Re({type:e,selectors:[["","brnTooltipTrigger",""]],hostAttrs:[1,"brn-tooltip-trigger"],hostVars:2,hostBindings:function(n,o){n&2&&ri("brn-tooltip-disabled",o.brnTooltipDisabled())},inputs:{position:[1,"position"],positionAtOrigin:[1,"positionAtOrigin"],brnTooltipDisabled:[1,"brnTooltipDisabled"],showDelay:[1,"showDelay"],hideDelay:[1,"hideDelay"],exitAnimationDuration:[1,"exitAnimationDuration"],tooltipContentClasses:[1,"tooltipContentClasses"],touchGestures:[1,"touchGestures"],ariaDescribedBy:[1,"aria-describedby","ariaDescribedBy"],brnTooltipTrigger:[1,"brnTooltipTrigger"]},exportAs:["brnTooltipTrigger"],features:[ze([MM])]})}return e})();var k1="bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 z-50 w-fit rounded-md px-3 py-1.5 text-xs text-balance data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=below]:slide-in-from-top-2 data-[side=above]:slide-in-from-bottom-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 ";var IM=_d("peer/menu-button ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground flex w-full items-center justify-start gap-2 overflow-hidden rounded-md p-2 text-left text-sm transition-[width,height,padding] outline-none group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 hover:cursor-pointer focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 disabled:hover:cursor-default aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium [&>_ng-icon]:size-4 [&>_ng-icon]:shrink-0 group-data-[collapsible=icon]:[&>span]:hidden [&>span:last-child]:truncate",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-sidebar-border hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-sidebar-accent"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),lg=(()=>{class e{_sidebarService=ie(ds);variant=Y("default");size=Y("default");isActive=Y(!1,{transform:P});userClass=Y("",{alias:"class"});_isTooltipHidden=ae(()=>this._sidebarService.state()!=="collapsed"||this._sidebarService.isMobile());_computedClass=ae(()=>ue(IM({variant:this.variant(),size:this.size()}),this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=Re({type:e,selectors:[["button","hlmSidebarMenuButton",""],["a","hlmSidebarMenuButton",""]],hostAttrs:["data-slot","sidebar-menu-button","data-sidebar","menu-button"],hostVars:4,hostBindings:function(n,o){n&2&&(Dn("data-size",o.size())("data-active",o.isActive()),Fe(o._computedClass()))},inputs:{variant:[1,"variant"],size:[1,"size"],isActive:[1,"isActive"],userClass:[1,"class","userClass"]},features:[ze([R1({showDelay:150,hideDelay:0,exitAnimationDuration:150,tooltipContentClasses:k1,position:"left"})]),nr([{directive:M1,inputs:["brnTooltipTrigger","tooltip","aria-describedby","aria-describedby"]}])]})}return e})();var dg=(()=>{class e{userClass=Y("",{alias:"class"});_computedClass=ae(()=>ue("group/menu-item relative",this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=Re({type:e,selectors:[["li","hlmSidebarMenuItem",""]],hostAttrs:["data-slot","sidebar-menu-item","data-sidebar","menu-item"],hostVars:2,hostBindings:function(n,o){n&2&&Fe(o._computedClass())},inputs:{userClass:[1,"class","userClass"]}})}return e})();var OM={orientation:"horizontal"},NM=new ss("BrnSeparatorConfig");function BM(){return ie(NM,{optional:!0})??OM}var D1=(()=>{class e{_config=BM();orientation=Y(this._config.orientation);decorative=Y(!0,{transform:P});_role=ae(()=>this.decorative()?"none":"separator");_ariaOrientation=ae(()=>this.decorative()?void 0:this.orientation()==="vertical"?"vertical":void 0);static \u0275fac=function(n){return new(n||e)};static \u0275dir=Re({type:e,selectors:[["","brnSeparator",""],["brn-separator"]],hostVars:3,hostBindings:function(n,o){n&2&&(Up("role",o._role()),Dn("aria-orientation",o._ariaOrientation())("data-orientation",o.orientation()))},inputs:{orientation:[1,"orientation"],decorative:[1,"decorative"]}})}return e})();var GM="bg-border inline-flex shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",Wd=(()=>{class e{userClass=Y("",{alias:"class"});_computedClass=ae(()=>ue(GM,this.userClass()));static \u0275fac=function(n){return new(n||e)};static \u0275dir=Re({type:e,selectors:[["","hlmSeparator",""],["hlm-separator"]],hostVars:2,hostBindings:function(n,o){n&2&&Fe(o._computedClass())},inputs:{userClass:[1,"class","userClass"]},features:[nr([{directive:D1,inputs:["orientation","orientation","decorative","decorative"]}])]})}return e})();var VM=["hlmSidebarTrigger",""],cg=(()=>{class e{_hlmBtn=ie(Bt);_sidebarService=ie(ds);constructor(){this._hlmBtn.setClass("size-7")}_onClick(){this._sidebarService.toggleSidebar()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ee({type:e,selectors:[["button","hlmSidebarTrigger",""]],hostAttrs:["data-slot","sidebar-trigger","data-sidebar","trigger"],hostBindings:function(n,o){n&1&&se("click",function(){return o._onClick()})},features:[ze([ai({lucidePanelLeft:jw}),mw({variant:"ghost",size:"icon"})]),nr([Bt])],attrs:VM,decls:1,vars:0,consts:[["hlm","","name","lucidePanelLeft","size","sm"]],template:function(n,o){n&1&&oe(0,"ng-icon",0)},dependencies:[Gt,Ht],encapsulation:2,changeDetection:0})}return e})();var ug=(()=>{class e{_config=pr();userClass=Y("",{alias:"class"});_computedClass=ae(()=>ue("group/sidebar-wrapper has-[[data-variant=inset]]:bg-sidebar flex min-h-svh w-full",this.userClass()));sidebarWidth=Y(this._config.sidebarWidth);sidebarWidthIcon=Y(this._config.sidebarWidthIcon);static \u0275fac=function(n){return new(n||e)};static \u0275dir=Re({type:e,selectors:[["","hlmSidebarWrapper",""],["hlm-sidebar-wrapper"]],hostAttrs:["data-slot","sidebar-wrapper"],hostVars:6,hostBindings:function(n,o){n&2&&(Fe(o._computedClass()),Ji("--sidebar-width",o.sidebarWidth())("--sidebar-width-icon",o.sidebarWidthIcon()))},inputs:{userClass:[1,"class","userClass"],sidebarWidth:[1,"sidebarWidth"],sidebarWidthIcon:[1,"sidebarWidthIcon"]}})}return e})();var WM=(e,t)=>t.path;function UM(e,t){if(e&1&&(M(0,"li",5)(1,"a",16),oe(2,"ng-icon",17),M(3,"span"),H(4),$(5,"transloco"),k()()()),e&2){let i=t.$implicit;F(),De("routerLink",i.path),F(),De("name",i.icon),F(2),Pe(j(5,3,i.label))}}var T1=(()=>{class e{navigationItems=[{path:"dashboard",label:"homeDocumentation.nav.dashboard",icon:"lucideHouse"},{path:"house-plans",label:"homeDocumentation.nav.housePlans",icon:"lucideSquareDashedBottom"},{path:"wall-structures",label:"homeDocumentation.nav.wallStructures",icon:"lucideConstruction"}];static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ee({type:e,selectors:[["gh-home-shell"]],features:[ze([ai({lucideHouse:Vw,lucideConstruction:Nw,lucideSquareDashedBottom:Zw})])],decls:31,vars:12,consts:[[1,"border-b"],[1,"px-4","py-2","text-lg","font-semibold"],["hlmSidebarGroupLabel",""],["hlmSidebarGroupContent",""],["hlmSidebarMenu",""],["hlmSidebarMenuItem",""],[1,"border-t","p-2"],[1,"px-2","text-xs","text-muted-foreground"],["hlmSidebarRail",""],["hlmSidebarInset","",1,"flex","flex-col"],[1,"sticky","top-0","z-10","flex","h-14","shrink-0","items-center","gap-2","border-b","bg-background","px-4"],["hlmSidebarTrigger",""],[1,"sr-only"],[1,"flex-1"],[1,"text-lg","font-semibold"],[1,"flex-1","overflow-auto"],["hlmSidebarMenuButton","","routerLinkActive","bg-sidebar-accent text-sidebar-accent-foreground",3,"routerLink"],["hlm","","size","sm",3,"name"]],template:function(n,o){n&1&&(M(0,"hlm-sidebar-wrapper")(1,"hlm-sidebar")(2,"hlm-sidebar-header",0)(3,"h2",1),H(4),$(5,"transloco"),k()(),M(6,"hlm-sidebar-content")(7,"hlm-sidebar-group")(8,"div",2),H(9),$(10,"transloco"),k(),M(11,"div",3)(12,"ul",4),mo(13,UM,6,5,"li",5,WM),k()()()(),M(15,"hlm-sidebar-footer",6)(16,"p",7),H(17),$(18,"transloco"),k()(),oe(19,"div",8),k(),M(20,"div",9)(21,"header",10)(22,"button",11)(23,"span",12),H(24,"Toggle Sidebar"),k()(),M(25,"div",13)(26,"h1",14),H(27),$(28,"transloco"),k()()(),M(29,"main",15),oe(30,"router-outlet"),k()()()),n&2&&(F(4),me(" ",j(5,4,"homeDocumentation.title")," "),F(5),me(" ",j(10,6,"homeDocumentation.nav.navigation")," "),F(4),Co(o.navigationItems),F(4),me(" ",j(18,8,"homeDocumentation.nav.footer")," "),F(10),Pe(j(28,10,"homeDocumentation.title")))},dependencies:[Qi,fw,hw,pw,gw,Zi,Zp,eg,tg,ig,ng,og,sg,rg,lg,dg,cg,ug,Gt,Ht,vo],encapsulation:2,changeDetection:0})}return e})();function Vt(e){this.content=e}Vt.prototype={constructor:Vt,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return t==-1?void 0:this.content[t+1]},update:function(e,t,i){var n=i&&i!=e?this.remove(i):this,o=n.find(e),s=n.content.slice();return o==-1?s.push(i||e,t):(s[o+1]=t,i&&(s[o]=i)),new Vt(s)},remove:function(e){var t=this.find(e);if(t==-1)return this;var i=this.content.slice();return i.splice(t,2),new Vt(i)},addToStart:function(e,t){return new Vt([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var i=this.remove(e).content.slice();return i.push(e,t),new Vt(i)},addBefore:function(e,t,i){var n=this.remove(t),o=n.content.slice(),s=n.find(e);return o.splice(s==-1?o.length:s,0,t,i),new Vt(o)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return e=Vt.from(e),e.size?new Vt(e.content.concat(this.subtract(e).content)):this},append:function(e){return e=Vt.from(e),e.size?new Vt(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=Vt.from(e);for(var i=0;i<e.content.length;i+=2)t=t.remove(e.content[i]);return t},toObject:function(){var e={};return this.forEach(function(t,i){e[t]=i}),e},get size(){return this.content.length>>1}};Vt.from=function(e){if(e instanceof Vt)return e;var t=[];if(e)for(var i in e)t.push(i,e[i]);return new Vt(t)};var pg=Vt;function V1(e,t,i){for(let n=0;;n++){if(n==e.childCount||n==t.childCount)return e.childCount==t.childCount?null:i;let o=e.child(n),s=t.child(n);if(o==s){i+=o.nodeSize;continue}if(!o.sameMarkup(s))return i;if(o.isText&&o.text!=s.text){for(let r=0;o.text[r]==s.text[r];r++)i++;return i}if(o.content.size||s.content.size){let r=V1(o.content,s.content,i+1);if(r!=null)return r}i+=o.nodeSize}}function z1(e,t,i,n){for(let o=e.childCount,s=t.childCount;;){if(o==0||s==0)return o==s?null:{a:i,b:n};let r=e.child(--o),a=t.child(--s),l=r.nodeSize;if(r==a){i-=l,n-=l;continue}if(!r.sameMarkup(a))return{a:i,b:n};if(r.isText&&r.text!=a.text){let d=0,c=Math.min(r.text.length,a.text.length);for(;d<c&&r.text[r.text.length-d-1]==a.text[a.text.length-d-1];)d++,i--,n--;return{a:i,b:n}}if(r.content.size||a.content.size){let d=z1(r.content,a.content,i-1,n-1);if(d)return d}i-=l,n-=l}}var N=class e{constructor(t,i){if(this.content=t,this.size=i||0,i==null)for(let n=0;n<t.length;n++)this.size+=t[n].nodeSize}nodesBetween(t,i,n,o=0,s){for(let r=0,a=0;a<i;r++){let l=this.content[r],d=a+l.nodeSize;if(d>t&&n(l,o+a,s||null,r)!==!1&&l.content.size){let c=a+1;l.nodesBetween(Math.max(0,t-c),Math.min(l.content.size,i-c),n,o+c)}a=d}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,i,n,o){let s="",r=!0;return this.nodesBetween(t,i,(a,l)=>{let d=a.isText?a.text.slice(Math.max(t,l)-l,i-l):a.isLeaf?o?typeof o=="function"?o(a):o:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&d||a.isTextblock)&&n&&(r?r=!1:s+=n),s+=d},0),s}append(t){if(!t.size)return this;if(!this.size)return t;let i=this.lastChild,n=t.firstChild,o=this.content.slice(),s=0;for(i.isText&&i.sameMarkup(n)&&(o[o.length-1]=i.withText(i.text+n.text),s=1);s<t.content.length;s++)o.push(t.content[s]);return new e(o,this.size+t.size)}cut(t,i=this.size){if(t==0&&i==this.size)return this;let n=[],o=0;if(i>t)for(let s=0,r=0;r<i;s++){let a=this.content[s],l=r+a.nodeSize;l>t&&((r<t||l>i)&&(a.isText?a=a.cut(Math.max(0,t-r),Math.min(a.text.length,i-r)):a=a.cut(Math.max(0,t-r-1),Math.min(a.content.size,i-r-1))),n.push(a),o+=a.nodeSize),r=l}return new e(n,o)}cutByIndex(t,i){return t==i?e.empty:t==0&&i==this.content.length?this:new e(this.content.slice(t,i))}replaceChild(t,i){let n=this.content[t];if(n==i)return this;let o=this.content.slice(),s=this.size+i.nodeSize-n.nodeSize;return o[t]=i,new e(o,s)}addToStart(t){return new e([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new e(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let i=0;i<this.content.length;i++)if(!this.content[i].eq(t.content[i]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let i=this.content[t];if(!i)throw new RangeError("Index "+t+" out of range for "+this);return i}maybeChild(t){return this.content[t]||null}forEach(t){for(let i=0,n=0;i<this.content.length;i++){let o=this.content[i];t(o,n,i),n+=o.nodeSize}}findDiffStart(t,i=0){return V1(this,t,i)}findDiffEnd(t,i=this.size,n=t.size){return z1(this,t,i,n)}findIndex(t){if(t==0)return Ud(0,t);if(t==this.size)return Ud(this.content.length,t);if(t>this.size||t<0)throw new RangeError(`Position ${t} outside of fragment (${this})`);for(let i=0,n=0;;i++){let o=this.child(i),s=n+o.nodeSize;if(s>=t)return s==t?Ud(i+1,s):Ud(i,n);n=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(t=>t.toJSON()):null}static fromJSON(t,i){if(!i)return e.empty;if(!Array.isArray(i))throw new RangeError("Invalid input for Fragment.fromJSON");return new e(i.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return e.empty;let i,n=0;for(let o=0;o<t.length;o++){let s=t[o];n+=s.nodeSize,o&&s.isText&&t[o-1].sameMarkup(s)?(i||(i=t.slice(0,o)),i[i.length-1]=s.withText(i[i.length-1].text+s.text)):i&&i.push(s)}return new e(i||t,n)}static from(t){if(!t)return e.empty;if(t instanceof e)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new e([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}};N.empty=new N([],0);var gg={index:0,offset:0};function Ud(e,t){return gg.index=e,gg.offset=t,gg}function $d(e,t){if(e===t)return!0;if(!(e&&typeof e=="object")||!(t&&typeof t=="object"))return!1;let i=Array.isArray(e);if(Array.isArray(t)!=i)return!1;if(i){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!$d(e[n],t[n]))return!1}else{for(let n in e)if(!(n in t)||!$d(e[n],t[n]))return!1;for(let n in t)if(!(n in e))return!1}return!0}var Ve=(()=>{class e{constructor(i,n){this.type=i,this.attrs=n}addToSet(i){let n,o=!1;for(let s=0;s<i.length;s++){let r=i[s];if(this.eq(r))return i;if(this.type.excludes(r.type))n||(n=i.slice(0,s));else{if(r.type.excludes(this.type))return i;!o&&r.type.rank>this.type.rank&&(n||(n=i.slice(0,s)),n.push(this),o=!0),n&&n.push(r)}}return n||(n=i.slice()),o||n.push(this),n}removeFromSet(i){for(let n=0;n<i.length;n++)if(this.eq(i[n]))return i.slice(0,n).concat(i.slice(n+1));return i}isInSet(i){for(let n=0;n<i.length;n++)if(this.eq(i[n]))return!0;return!1}eq(i){return this==i||this.type==i.type&&$d(this.attrs,i.attrs)}toJSON(){let i={type:this.type.name};for(let n in this.attrs){i.attrs=this.attrs;break}return i}static fromJSON(i,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let o=i.marks[n.type];if(!o)throw new RangeError(`There is no mark type ${n.type} in this schema`);let s=o.create(n.attrs);return o.checkAttrs(s.attrs),s}static sameSet(i,n){if(i==n)return!0;if(i.length!=n.length)return!1;for(let o=0;o<i.length;o++)if(!i[o].eq(n[o]))return!1;return!0}static setFrom(i){if(!i||Array.isArray(i)&&i.length==0)return e.none;if(i instanceof e)return[i];let n=i.slice();return n.sort((o,s)=>o.type.rank-s.type.rank),n}}return e.none=[],e})(),hs=class extends Error{},K=class e{constructor(t,i,n){this.content=t,this.openStart=i,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,i){let n=U1(this.content,t+this.openStart,i);return n&&new e(n,this.openStart,this.openEnd)}removeBetween(t,i){return new e(W1(this.content,t+this.openStart,i+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,i){if(!i)return e.empty;let n=i.openStart||0,o=i.openEnd||0;if(typeof n!="number"||typeof o!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new e(N.fromJSON(t,i.content),n,o)}static maxOpen(t,i=!0){let n=0,o=0;for(let s=t.firstChild;s&&!s.isLeaf&&(i||!s.type.spec.isolating);s=s.firstChild)n++;for(let s=t.lastChild;s&&!s.isLeaf&&(i||!s.type.spec.isolating);s=s.lastChild)o++;return new e(t,n,o)}};K.empty=new K(N.empty,0,0);function W1(e,t,i){let{index:n,offset:o}=e.findIndex(t),s=e.maybeChild(n),{index:r,offset:a}=e.findIndex(i);if(o==t||s.isText){if(a!=i&&!e.child(r).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(i))}if(n!=r)throw new RangeError("Removing non-flat range");return e.replaceChild(n,s.copy(W1(s.content,t-o-1,i-o-1)))}function U1(e,t,i,n){let{index:o,offset:s}=e.findIndex(t),r=e.maybeChild(o);if(s==t||r.isText)return n&&!n.canReplace(o,o,i)?null:e.cut(0,t).append(i).append(e.cut(t));let a=U1(r.content,t-s-1,i,r);return a&&e.replaceChild(o,r.copy(a))}function qM(e,t,i){if(i.openStart>e.depth)throw new hs("Inserted content deeper than insertion position");if(e.depth-i.openStart!=t.depth-i.openEnd)throw new hs("Inconsistent open depths");return q1(e,t,i,0)}function q1(e,t,i,n){let o=e.index(n),s=e.node(n);if(o==t.index(n)&&n<e.depth-i.openStart){let r=q1(e,t,i,n+1);return s.copy(s.content.replaceChild(o,r))}else if(i.content.size)if(!i.openStart&&!i.openEnd&&e.depth==n&&t.depth==n){let r=e.parent,a=r.content;return us(r,a.cut(0,e.parentOffset).append(i.content).append(a.cut(t.parentOffset)))}else{let{start:r,end:a}=$M(i,e);return us(s,j1(e,r,a,t,n))}else return us(s,jd(e,t,n))}function $1(e,t){if(!t.type.compatibleContent(e.type))throw new hs("Cannot join "+t.type.name+" onto "+e.type.name)}function mg(e,t,i){let n=e.node(i);return $1(n,t.node(i)),n}function cs(e,t){let i=t.length-1;i>=0&&e.isText&&e.sameMarkup(t[i])?t[i]=e.withText(t[i].text+e.text):t.push(e)}function La(e,t,i,n){let o=(t||e).node(i),s=0,r=t?t.index(i):o.childCount;e&&(s=e.index(i),e.depth>i?s++:e.textOffset&&(cs(e.nodeAfter,n),s++));for(let a=s;a<r;a++)cs(o.child(a),n);t&&t.depth==i&&t.textOffset&&cs(t.nodeBefore,n)}function us(e,t){return e.type.checkContent(t),e.copy(t)}function j1(e,t,i,n,o){let s=e.depth>o&&mg(e,t,o+1),r=n.depth>o&&mg(i,n,o+1),a=[];return La(null,e,o,a),s&&r&&t.index(o)==i.index(o)?($1(s,r),cs(us(s,j1(e,t,i,n,o+1)),a)):(s&&cs(us(s,jd(e,t,o+1)),a),La(t,i,o,a),r&&cs(us(r,jd(i,n,o+1)),a)),La(n,null,o,a),new N(a)}function jd(e,t,i){let n=[];if(La(null,e,i,n),e.depth>i){let o=mg(e,t,i+1);cs(us(o,jd(e,t,i+1)),n)}return La(t,null,i,n),new N(n)}function $M(e,t){let i=t.depth-e.openStart,o=t.node(i).copy(e.content);for(let s=i-1;s>=0;s--)o=t.node(s).copy(N.from(o));return{start:o.resolveNoCache(e.openStart+i),end:o.resolveNoCache(o.content.size-e.openEnd-i)}}var Kd=class e{constructor(t,i,n){this.pos=t,this.path=i,this.parentOffset=n,this.depth=i.length/3-1}resolveDepth(t){return t==null?this.depth:t<0?this.depth+t:t}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(t){return this.path[this.resolveDepth(t)*3]}index(t){return this.path[this.resolveDepth(t)*3+1]}indexAfter(t){return t=this.resolveDepth(t),this.index(t)+(t==this.depth&&!this.textOffset?0:1)}start(t){return t=this.resolveDepth(t),t==0?0:this.path[t*3-1]+1}end(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size}before(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]}after(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]+this.path[t*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let t=this.parent,i=this.index(this.depth);if(i==t.childCount)return null;let n=this.pos-this.path[this.path.length-1],o=t.child(i);return n?t.child(i).cut(n):o}get nodeBefore(){let t=this.index(this.depth),i=this.pos-this.path[this.path.length-1];return i?this.parent.child(t).cut(0,i):t==0?null:this.parent.child(t-1)}posAtIndex(t,i){i=this.resolveDepth(i);let n=this.path[i*3],o=i==0?0:this.path[i*3-1]+1;for(let s=0;s<t;s++)o+=n.child(s).nodeSize;return o}marks(){let t=this.parent,i=this.index();if(t.content.size==0)return Ve.none;if(this.textOffset)return t.child(i).marks;let n=t.maybeChild(i-1),o=t.maybeChild(i);if(!n){let a=n;n=o,o=a}let s=n.marks;for(var r=0;r<s.length;r++)s[r].type.spec.inclusive===!1&&(!o||!s[r].isInSet(o.marks))&&(s=s[r--].removeFromSet(s));return s}marksAcross(t){let i=this.parent.maybeChild(this.index());if(!i||!i.isInline)return null;let n=i.marks,o=t.parent.maybeChild(t.index());for(var s=0;s<n.length;s++)n[s].type.spec.inclusive===!1&&(!o||!n[s].isInSet(o.marks))&&(n=n[s--].removeFromSet(n));return n}sharedDepth(t){for(let i=this.depth;i>0;i--)if(this.start(i)<=t&&this.end(i)>=t)return i;return 0}blockRange(t=this,i){if(t.pos<this.pos)return t.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!i||i(this.node(n))))return new ps(this,t,n);return null}sameParent(t){return this.pos-this.parentOffset==t.pos-t.parentOffset}max(t){return t.pos>this.pos?t:this}min(t){return t.pos<this.pos?t:this}toString(){let t="";for(let i=1;i<=this.depth;i++)t+=(t?"/":"")+this.node(i).type.name+"_"+this.index(i-1);return t+":"+this.parentOffset}static resolve(t,i){if(!(i>=0&&i<=t.content.size))throw new RangeError("Position "+i+" out of range");let n=[],o=0,s=i;for(let r=t;;){let{index:a,offset:l}=r.content.findIndex(s),d=s-l;if(n.push(r,a,o+l),!d||(r=r.child(a),r.isText))break;s=d-1,o+=l+1}return new e(i,n,s)}static resolveCached(t,i){let n=A1.get(t);if(n)for(let s=0;s<n.elts.length;s++){let r=n.elts[s];if(r.pos==i)return r}else A1.set(t,n=new Cg);let o=n.elts[n.i]=e.resolve(t,i);return n.i=(n.i+1)%jM,o}},Cg=class{constructor(){this.elts=[],this.i=0}},jM=12,A1=new WeakMap,ps=class{constructor(t,i,n){this.$from=t,this.$to=i,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}},KM=Object.create(null),li=class e{constructor(t,i,n,o=Ve.none){this.type=t,this.attrs=i,this.marks=o,this.content=n||N.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(t){return this.content.child(t)}maybeChild(t){return this.content.maybeChild(t)}forEach(t){this.content.forEach(t)}nodesBetween(t,i,n,o=0){this.content.nodesBetween(t,i,n,o,this)}descendants(t){this.nodesBetween(0,this.content.size,t)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(t,i,n,o){return this.content.textBetween(t,i,n,o)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)}sameMarkup(t){return this.hasMarkup(t.type,t.attrs,t.marks)}hasMarkup(t,i,n){return this.type==t&&$d(this.attrs,i||t.defaultAttrs||KM)&&Ve.sameSet(this.marks,n||Ve.none)}copy(t=null){return t==this.content?this:new e(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new e(this.type,this.attrs,this.content,t)}cut(t,i=this.content.size){return t==0&&i==this.content.size?this:this.copy(this.content.cut(t,i))}slice(t,i=this.content.size,n=!1){if(t==i)return K.empty;let o=this.resolve(t),s=this.resolve(i),r=n?0:o.sharedDepth(i),a=o.start(r),d=o.node(r).content.cut(o.pos-a,s.pos-a);return new K(d,o.depth-r,s.depth-r)}replace(t,i,n){return qM(this.resolve(t),this.resolve(i),n)}nodeAt(t){for(let i=this;;){let{index:n,offset:o}=i.content.findIndex(t);if(i=i.maybeChild(n),!i)return null;if(o==t||i.isText)return i;t-=o+1}}childAfter(t){let{index:i,offset:n}=this.content.findIndex(t);return{node:this.content.maybeChild(i),index:i,offset:n}}childBefore(t){if(t==0)return{node:null,index:0,offset:0};let{index:i,offset:n}=this.content.findIndex(t);if(n<t)return{node:this.content.child(i),index:i,offset:n};let o=this.content.child(i-1);return{node:o,index:i-1,offset:n-o.nodeSize}}resolve(t){return Kd.resolveCached(this,t)}resolveNoCache(t){return Kd.resolve(this,t)}rangeHasMark(t,i,n){let o=!1;return i>t&&this.nodesBetween(t,i,s=>(n.isInSet(s.marks)&&(o=!0),!o)),o}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),K1(this.marks,t)}contentMatchAt(t){let i=this.type.contentMatch.matchFragment(this.content,0,t);if(!i)throw new Error("Called contentMatchAt on a node with invalid content");return i}canReplace(t,i,n=N.empty,o=0,s=n.childCount){let r=this.contentMatchAt(t).matchFragment(n,o,s),a=r&&r.matchFragment(this.content,i);if(!a||!a.validEnd)return!1;for(let l=o;l<s;l++)if(!this.type.allowsMarks(n.child(l).marks))return!1;return!0}canReplaceWith(t,i,n,o){if(o&&!this.type.allowsMarks(o))return!1;let s=this.contentMatchAt(t).matchType(n),r=s&&s.matchFragment(this.content,i);return r?r.validEnd:!1}canAppend(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let t=Ve.none;for(let i=0;i<this.marks.length;i++){let n=this.marks[i];n.type.checkAttrs(n.attrs),t=n.addToSet(t)}if(!Ve.sameSet(t,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(i=>i.type.name)}`);this.content.forEach(i=>i.check())}toJSON(){let t={type:this.type.name};for(let i in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(i=>i.toJSON())),t}static fromJSON(t,i){if(!i)throw new RangeError("Invalid input for Node.fromJSON");let n;if(i.marks){if(!Array.isArray(i.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=i.marks.map(t.markFromJSON)}if(i.type=="text"){if(typeof i.text!="string")throw new RangeError("Invalid text node in JSON");return t.text(i.text,n)}let o=N.fromJSON(t,i.content),s=t.nodeType(i.type).create(i.attrs,o,n);return s.type.checkAttrs(s.attrs),s}};li.prototype.text=void 0;var vg=class e extends li{constructor(t,i,n,o){if(super(t,i,null,o),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):K1(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(t,i){return this.text.slice(t,i)}get nodeSize(){return this.text.length}mark(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)}withText(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)}cut(t=0,i=this.text.length){return t==0&&i==this.text.length?this:this.withText(this.text.slice(t,i))}eq(t){return this.sameMarkup(t)&&this.text==t.text}toJSON(){let t=super.toJSON();return t.text=this.text,t}};function K1(e,t){for(let i=e.length-1;i>=0;i--)t=e[i].type.name+"("+t+")";return t}var gs=class e{constructor(t){this.validEnd=t,this.next=[],this.wrapCache=[]}static parse(t,i){let n=new wg(t,i);if(n.next==null)return e.empty;let o=Y1(n);n.next&&n.err("Unexpected trailing text");let s=tk(ek(o));return ik(s,n),s}matchType(t){for(let i=0;i<this.next.length;i++)if(this.next[i].type==t)return this.next[i].next;return null}matchFragment(t,i=0,n=t.childCount){let o=this;for(let s=i;o&&s<n;s++)o=o.matchType(t.child(s).type);return o}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let t=0;t<this.next.length;t++){let{type:i}=this.next[t];if(!(i.isText||i.hasRequiredAttrs()))return i}return null}compatible(t){for(let i=0;i<this.next.length;i++)for(let n=0;n<t.next.length;n++)if(this.next[i].type==t.next[n].type)return!0;return!1}fillBefore(t,i=!1,n=0){let o=[this];function s(r,a){let l=r.matchFragment(t,n);if(l&&(!i||l.validEnd))return N.from(a.map(d=>d.createAndFill()));for(let d=0;d<r.next.length;d++){let{type:c,next:u}=r.next[d];if(!(c.isText||c.hasRequiredAttrs())&&o.indexOf(u)==-1){o.push(u);let h=s(u,a.concat(c));if(h)return h}}return null}return s(this,[])}findWrapping(t){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==t)return this.wrapCache[n+1];let i=this.computeWrapping(t);return this.wrapCache.push(t,i),i}computeWrapping(t){let i=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let o=n.shift(),s=o.match;if(s.matchType(t)){let r=[];for(let a=o;a.type;a=a.via)r.push(a.type);return r.reverse()}for(let r=0;r<s.next.length;r++){let{type:a,next:l}=s.next[r];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in i)&&(!o.type||l.validEnd)&&(n.push({match:a.contentMatch,type:a,via:o}),i[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(t){if(t>=this.next.length)throw new RangeError(`There's no ${t}th edge in this content match`);return this.next[t]}toString(){let t=[];function i(n){t.push(n);for(let o=0;o<n.next.length;o++)t.indexOf(n.next[o].next)==-1&&i(n.next[o].next)}return i(this),t.map((n,o)=>{let s=o+(n.validEnd?"*":" ")+" ";for(let r=0;r<n.next.length;r++)s+=(r?", ":"")+n.next[r].type.name+"->"+t.indexOf(n.next[r].next);return s}).join(`
`)}};gs.empty=new gs(!0);var wg=class{constructor(t,i){this.string=t,this.nodeTypes=i,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(t){return this.next==t&&(this.pos++||!0)}err(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")}};function Y1(e){let t=[];do t.push(YM(e));while(e.eat("|"));return t.length==1?t[0]:{type:"choice",exprs:t}}function YM(e){let t=[];do t.push(XM(e));while(e.next&&e.next!=")"&&e.next!="|");return t.length==1?t[0]:{type:"seq",exprs:t}}function XM(e){let t=ZM(e);for(;;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else if(e.eat("{"))t=JM(e,t);else break;return t}function I1(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function JM(e,t){let i=I1(e),n=i;return e.eat(",")&&(e.next!="}"?n=I1(e):n=-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:i,max:n,expr:t}}function QM(e,t){let i=e.nodeTypes,n=i[t];if(n)return[n];let o=[];for(let s in i){let r=i[s];r.isInGroup(t)&&o.push(r)}return o.length==0&&e.err("No node type or group '"+t+"' found"),o}function ZM(e){if(e.eat("(")){let t=Y1(e);return e.eat(")")||e.err("Missing closing paren"),t}else if(/\W/.test(e.next))e.err("Unexpected token '"+e.next+"'");else{let t=QM(e,e.next).map(i=>(e.inline==null?e.inline=i.isInline:e.inline!=i.isInline&&e.err("Mixing inline and block content"),{type:"name",value:i}));return e.pos++,t.length==1?t[0]:{type:"choice",exprs:t}}}function ek(e){let t=[[]];return o(s(e,0),i()),t;function i(){return t.push([])-1}function n(r,a,l){let d={term:l,to:a};return t[r].push(d),d}function o(r,a){r.forEach(l=>l.to=a)}function s(r,a){if(r.type=="choice")return r.exprs.reduce((l,d)=>l.concat(s(d,a)),[]);if(r.type=="seq")for(let l=0;;l++){let d=s(r.exprs[l],a);if(l==r.exprs.length-1)return d;o(d,a=i())}else if(r.type=="star"){let l=i();return n(a,l),o(s(r.expr,l),l),[n(l)]}else if(r.type=="plus"){let l=i();return o(s(r.expr,a),l),o(s(r.expr,l),l),[n(l)]}else{if(r.type=="opt")return[n(a)].concat(s(r.expr,a));if(r.type=="range"){let l=a;for(let d=0;d<r.min;d++){let c=i();o(s(r.expr,l),c),l=c}if(r.max==-1)o(s(r.expr,l),l);else for(let d=r.min;d<r.max;d++){let c=i();n(l,c),o(s(r.expr,l),c),l=c}return[n(l)]}else{if(r.type=="name")return[n(a,void 0,r.value)];throw new Error("Unknown expr type")}}}}function X1(e,t){return t-e}function L1(e,t){let i=[];return n(t),i.sort(X1);function n(o){let s=e[o];if(s.length==1&&!s[0].term)return n(s[0].to);i.push(o);for(let r=0;r<s.length;r++){let{term:a,to:l}=s[r];!a&&i.indexOf(l)==-1&&n(l)}}}function tk(e){let t=Object.create(null);return i(L1(e,0));function i(n){let o=[];n.forEach(r=>{e[r].forEach(({term:a,to:l})=>{if(!a)return;let d;for(let c=0;c<o.length;c++)o[c][0]==a&&(d=o[c][1]);L1(e,l).forEach(c=>{d||o.push([a,d=[]]),d.indexOf(c)==-1&&d.push(c)})})});let s=t[n.join(",")]=new gs(n.indexOf(e.length-1)>-1);for(let r=0;r<o.length;r++){let a=o[r][1].sort(X1);s.next.push({type:o[r][0],next:t[a.join(",")]||i(a)})}return s}}function ik(e,t){for(let i=0,n=[e];i<n.length;i++){let o=n[i],s=!o.validEnd,r=[];for(let a=0;a<o.next.length;a++){let{type:l,next:d}=o.next[a];r.push(l.name),s&&!(l.isText||l.hasRequiredAttrs())&&(s=!1),n.indexOf(d)==-1&&n.push(d)}s&&t.err("Only non-generatable nodes ("+r.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function J1(e){let t=Object.create(null);for(let i in e){let n=e[i];if(!n.hasDefault)return null;t[i]=n.default}return t}function Q1(e,t){let i=Object.create(null);for(let n in e){let o=t&&t[n];if(o===void 0){let s=e[n];if(s.hasDefault)o=s.default;else throw new RangeError("No value supplied for attribute "+n)}i[n]=o}return i}function Z1(e,t,i,n){for(let o in t)if(!(o in e))throw new RangeError(`Unsupported attribute ${o} for ${i} of type ${o}`);for(let o in e){let s=e[o];s.validate&&s.validate(t[o])}}function eb(e,t){let i=Object.create(null);if(t)for(let n in t)i[n]=new bg(e,n,t[n]);return i}var Yd=class e{constructor(t,i,n){this.name=t,this.schema=i,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=eb(t,n.attrs),this.defaultAttrs=J1(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||t=="text"),this.isText=t=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==gs.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(t){return this.groups.indexOf(t)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1}compatibleContent(t){return this==t||this.contentMatch.compatible(t.contentMatch)}computeAttrs(t){return!t&&this.defaultAttrs?this.defaultAttrs:Q1(this.attrs,t)}create(t=null,i,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new li(this,this.computeAttrs(t),N.from(i),Ve.setFrom(n))}createChecked(t=null,i,n){return i=N.from(i),this.checkContent(i),new li(this,this.computeAttrs(t),i,Ve.setFrom(n))}createAndFill(t=null,i,n){if(t=this.computeAttrs(t),i=N.from(i),i.size){let r=this.contentMatch.fillBefore(i);if(!r)return null;i=r.append(i)}let o=this.contentMatch.matchFragment(i),s=o&&o.fillBefore(N.empty,!0);return s?new li(this,t,i.append(s),Ve.setFrom(n)):null}validContent(t){let i=this.contentMatch.matchFragment(t);if(!i||!i.validEnd)return!1;for(let n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0}checkContent(t){if(!this.validContent(t))throw new RangeError(`Invalid content for node ${this.name}: ${t.toString().slice(0,50)}`)}checkAttrs(t){Z1(this.attrs,t,"node",this.name)}allowsMarkType(t){return this.markSet==null||this.markSet.indexOf(t)>-1}allowsMarks(t){if(this.markSet==null)return!0;for(let i=0;i<t.length;i++)if(!this.allowsMarkType(t[i].type))return!1;return!0}allowedMarks(t){if(this.markSet==null)return t;let i;for(let n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?i&&i.push(t[n]):i||(i=t.slice(0,n));return i?i.length?i:Ve.none:t}static compile(t,i){let n=Object.create(null);t.forEach((s,r)=>n[s]=new e(s,i,r));let o=i.spec.topNode||"doc";if(!n[o])throw new RangeError("Schema is missing its top node type ('"+o+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let s in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}};function nk(e,t,i){let n=i.split("|");return o=>{let s=o===null?"null":typeof o;if(n.indexOf(s)<0)throw new RangeError(`Expected value of type ${n} for attribute ${t} on type ${e}, got ${s}`)}}var bg=class{constructor(t,i,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate=typeof n.validate=="string"?nk(t,i,n.validate):n.validate}get isRequired(){return!this.hasDefault}},Oa=class e{constructor(t,i,n,o){this.name=t,this.rank=i,this.schema=n,this.spec=o,this.attrs=eb(t,o.attrs),this.excluded=null;let s=J1(this.attrs);this.instance=s?new Ve(this,s):null}create(t=null){return!t&&this.instance?this.instance:new Ve(this,Q1(this.attrs,t))}static compile(t,i){let n=Object.create(null),o=0;return t.forEach((s,r)=>n[s]=new e(s,o++,i,r)),n}removeFromSet(t){for(var i=0;i<t.length;i++)t[i].type==this&&(t=t.slice(0,i).concat(t.slice(i+1)),i--);return t}isInSet(t){for(let i=0;i<t.length;i++)if(t[i].type==this)return t[i]}checkAttrs(t){Z1(this.attrs,t,"mark",this.name)}excludes(t){return this.excluded.indexOf(t)>-1}},mr=class{constructor(t){this.linebreakReplacement=null,this.cached=Object.create(null);let i=this.spec={};for(let o in t)i[o]=t[o];i.nodes=pg.from(t.nodes),i.marks=pg.from(t.marks||{}),this.nodes=Yd.compile(this.spec.nodes,this),this.marks=Oa.compile(this.spec.marks,this);let n=Object.create(null);for(let o in this.nodes){if(o in this.marks)throw new RangeError(o+" can not be both a node and a mark");let s=this.nodes[o],r=s.spec.content||"",a=s.spec.marks;if(s.contentMatch=n[r]||(n[r]=gs.parse(r,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!s.isInline||!s.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=s}s.markSet=a=="_"?null:a?_1(this,a.split(" ")):a==""||!s.inlineContent?[]:null}for(let o in this.marks){let s=this.marks[o],r=s.spec.excludes;s.excluded=r==null?[s]:r==""?[]:_1(this,r.split(" "))}this.nodeFromJSON=o=>li.fromJSON(this,o),this.markFromJSON=o=>Ve.fromJSON(this,o),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(t,i=null,n,o){if(typeof t=="string")t=this.nodeType(t);else if(t instanceof Yd){if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}else throw new RangeError("Invalid node type: "+t);return t.createChecked(i,n,o)}text(t,i){let n=this.nodes.text;return new vg(n,n.defaultAttrs,t,Ve.setFrom(i))}mark(t,i){return typeof t=="string"&&(t=this.marks[t]),t.create(i)}nodeType(t){let i=this.nodes[t];if(!i)throw new RangeError("Unknown node type: "+t);return i}};function _1(e,t){let i=[];for(let n=0;n<t.length;n++){let o=t[n],s=e.marks[o],r=s;if(s)i.push(s);else for(let a in e.marks){let l=e.marks[a];(o=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(o)>-1)&&i.push(r=l)}if(!r)throw new SyntaxError("Unknown mark type: '"+t[n]+"'")}return i}function ok(e){return e.tag!=null}function sk(e){return e.style!=null}var en=class e{constructor(t,i){this.schema=t,this.rules=i,this.tags=[],this.styles=[];let n=this.matchedStyles=[];i.forEach(o=>{if(ok(o))this.tags.push(o);else if(sk(o)){let s=/[^=]*/.exec(o.style)[0];n.indexOf(s)<0&&n.push(s),this.styles.push(o)}}),this.normalizeLists=!this.tags.some(o=>{if(!/^(ul|ol)\b/.test(o.tag)||!o.node)return!1;let s=t.nodes[o.node];return s.contentMatch.matchType(s)})}parse(t,i={}){let n=new Xd(this,i,!1);return n.addAll(t,Ve.none,i.from,i.to),n.finish()}parseSlice(t,i={}){let n=new Xd(this,i,!0);return n.addAll(t,Ve.none,i.from,i.to),K.maxOpen(n.finish())}matchTag(t,i,n){for(let o=n?this.tags.indexOf(n)+1:0;o<this.tags.length;o++){let s=this.tags[o];if(lk(t,s.tag)&&(s.namespace===void 0||t.namespaceURI==s.namespace)&&(!s.context||i.matchesContext(s.context))){if(s.getAttrs){let r=s.getAttrs(t);if(r===!1)continue;s.attrs=r||void 0}return s}}}matchStyle(t,i,n,o){for(let s=o?this.styles.indexOf(o)+1:0;s<this.styles.length;s++){let r=this.styles[s],a=r.style;if(!(a.indexOf(t)!=0||r.context&&!n.matchesContext(r.context)||a.length>t.length&&(a.charCodeAt(t.length)!=61||a.slice(t.length+1)!=i))){if(r.getAttrs){let l=r.getAttrs(i);if(l===!1)continue;r.attrs=l||void 0}return r}}}static schemaRules(t){let i=[];function n(o){let s=o.priority==null?50:o.priority,r=0;for(;r<i.length;r++){let a=i[r];if((a.priority==null?50:a.priority)<s)break}i.splice(r,0,o)}for(let o in t.marks){let s=t.marks[o].spec.parseDOM;s&&s.forEach(r=>{n(r=N1(r)),r.mark||r.ignore||r.clearMark||(r.mark=o)})}for(let o in t.nodes){let s=t.nodes[o].spec.parseDOM;s&&s.forEach(r=>{n(r=N1(r)),r.node||r.ignore||r.mark||(r.node=o)})}return i}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new e(t,e.schemaRules(t)))}},tb={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},rk={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},ib={ol:!0,ul:!0},Na=1,yg=2,_a=4;function O1(e,t,i){return t!=null?(t?Na:0)|(t==="full"?yg:0):e&&e.whitespace=="pre"?Na|yg:i&~_a}var fr=class{constructor(t,i,n,o,s,r){this.type=t,this.attrs=i,this.marks=n,this.solid=o,this.options=r,this.content=[],this.activeMarks=Ve.none,this.match=s||(r&_a?null:t.contentMatch)}findWrapping(t){if(!this.match){if(!this.type)return[];let i=this.type.contentMatch.fillBefore(N.from(t));if(i)this.match=this.type.contentMatch.matchFragment(i);else{let n=this.type.contentMatch,o;return(o=n.findWrapping(t.type))?(this.match=n,o):null}}return this.match.findWrapping(t.type)}finish(t){if(!(this.options&Na)){let n=this.content[this.content.length-1],o;if(n&&n.isText&&(o=/[ \t\r\n\u000c]+$/.exec(n.text))){let s=n;n.text.length==o[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-o[0].length))}}let i=N.from(this.content);return!t&&this.match&&(i=i.append(this.match.fillBefore(N.empty,!0))),this.type?this.type.create(this.attrs,i,this.marks):i}inlineContext(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!tb.hasOwnProperty(t.parentNode.nodeName.toLowerCase())}},Xd=class{constructor(t,i,n){this.parser=t,this.options=i,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let o=i.topNode,s,r=O1(null,i.preserveWhitespace,0)|(n?_a:0);o?s=new fr(o.type,o.attrs,Ve.none,!0,i.topMatch||o.type.contentMatch,r):n?s=new fr(null,null,Ve.none,!0,null,r):s=new fr(t.schema.topNodeType,null,Ve.none,!0,null,r),this.nodes=[s],this.find=i.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(t,i){t.nodeType==3?this.addTextNode(t,i):t.nodeType==1&&this.addElement(t,i)}addTextNode(t,i){let n=t.nodeValue,o=this.top,s=o.options&yg?"full":this.localPreserveWS||(o.options&Na)>0,{schema:r}=this.parser;if(s==="full"||o.inlineContext(t)||/[^ \t\r\n\u000c]/.test(n)){if(s)if(s==="full")n=n.replace(/\r\n?/g,`
`);else if(r.linebreakReplacement&&/[\r\n]/.test(n)&&this.top.findWrapping(r.linebreakReplacement.create())){let a=n.split(/\r?\n|\r/);for(let l=0;l<a.length;l++)l&&this.insertNode(r.linebreakReplacement.create(),i,!0),a[l]&&this.insertNode(r.text(a[l]),i,!/\S/.test(a[l]));n=""}else n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let a=o.content[o.content.length-1],l=t.previousSibling;(!a||l&&l.nodeName=="BR"||a.isText&&/[ \t\r\n\u000c]$/.test(a.text))&&(n=n.slice(1))}n&&this.insertNode(r.text(n),i,!/\S/.test(n)),this.findInText(t)}else this.findInside(t)}addElement(t,i,n){let o=this.localPreserveWS,s=this.top;(t.tagName=="PRE"||/pre/.test(t.style&&t.style.whiteSpace))&&(this.localPreserveWS=!0);let r=t.nodeName.toLowerCase(),a;ib.hasOwnProperty(r)&&this.parser.normalizeLists&&ak(t);let l=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(a=this.parser.matchTag(t,this,n));e:if(l?l.ignore:rk.hasOwnProperty(r))this.findInside(t),this.ignoreFallback(t,i);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(t=l.skip);let d,c=this.needsBlock;if(tb.hasOwnProperty(r))s.content.length&&s.content[0].isInline&&this.open&&(this.open--,s=this.top),d=!0,s.type||(this.needsBlock=!0);else if(!t.firstChild){this.leafFallback(t,i);break e}let u=l&&l.skip?i:this.readStyles(t,i);u&&this.addAll(t,u),d&&this.sync(s),this.needsBlock=c}else{let d=this.readStyles(t,i);d&&this.addElementByRule(t,l,d,l.consuming===!1?a:void 0)}this.localPreserveWS=o}leafFallback(t,i){t.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode(`
`),i)}ignoreFallback(t,i){t.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),i,!0)}readStyles(t,i){let n=t.style;if(n&&n.length)for(let o=0;o<this.parser.matchedStyles.length;o++){let s=this.parser.matchedStyles[o],r=n.getPropertyValue(s);if(r)for(let a=void 0;;){let l=this.parser.matchStyle(s,r,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?i=i.filter(d=>!l.clearMark(d)):i=i.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return i}addElementByRule(t,i,n,o){let s,r;if(i.node)if(r=this.parser.schema.nodes[i.node],r.isLeaf)this.insertNode(r.create(i.attrs),n,t.nodeName=="BR")||this.leafFallback(t,n);else{let l=this.enter(r,i.attrs||null,n,i.preserveWhitespace);l&&(s=!0,n=l)}else{let l=this.parser.schema.marks[i.mark];n=n.concat(l.create(i.attrs))}let a=this.top;if(r&&r.isLeaf)this.findInside(t);else if(o)this.addElement(t,n,o);else if(i.getContent)this.findInside(t),i.getContent(t,this.parser.schema).forEach(l=>this.insertNode(l,n,!1));else{let l=t;typeof i.contentElement=="string"?l=t.querySelector(i.contentElement):typeof i.contentElement=="function"?l=i.contentElement(t):i.contentElement&&(l=i.contentElement),this.findAround(t,l,!0),this.addAll(l,n),this.findAround(t,l,!1)}s&&this.sync(a)&&this.open--}addAll(t,i,n,o){let s=n||0;for(let r=n?t.childNodes[n]:t.firstChild,a=o==null?null:t.childNodes[o];r!=a;r=r.nextSibling,++s)this.findAtPoint(t,s),this.addDOM(r,i);this.findAtPoint(t,s)}findPlace(t,i,n){let o,s;for(let r=this.open,a=0;r>=0;r--){let l=this.nodes[r],d=l.findWrapping(t);if(d&&(!o||o.length>d.length+a)&&(o=d,s=l,!d.length))break;if(l.solid){if(n)break;a+=2}}if(!o)return null;this.sync(s);for(let r=0;r<o.length;r++)i=this.enterInner(o[r],null,i,!1);return i}insertNode(t,i,n){if(t.isInline&&this.needsBlock&&!this.top.type){let s=this.textblockFromContext();s&&(i=this.enterInner(s,null,i))}let o=this.findPlace(t,i,n);if(o){this.closeExtra();let s=this.top;s.match&&(s.match=s.match.matchType(t.type));let r=Ve.none;for(let a of o.concat(t.marks))(s.type?s.type.allowsMarkType(a.type):B1(a.type,t.type))&&(r=a.addToSet(r));return s.content.push(t.mark(r)),!0}return!1}enter(t,i,n,o){let s=this.findPlace(t.create(i),n,!1);return s&&(s=this.enterInner(t,i,n,!0,o)),s}enterInner(t,i,n,o=!1,s){this.closeExtra();let r=this.top;r.match=r.match&&r.match.matchType(t);let a=O1(t,s,r.options);r.options&_a&&r.content.length==0&&(a|=_a);let l=Ve.none;return n=n.filter(d=>(r.type?r.type.allowsMarkType(d.type):B1(d.type,t))?(l=d.addToSet(l),!1):!0),this.nodes.push(new fr(t,i,l,o,null,a)),this.open++,n}closeExtra(t=!1){let i=this.nodes.length-1;if(i>this.open){for(;i>this.open;i--)this.nodes[i-1].content.push(this.nodes[i].finish(t));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(t){for(let i=this.open;i>=0;i--){if(this.nodes[i]==t)return this.open=i,!0;this.localPreserveWS&&(this.nodes[i].options|=Na)}return!1}get currentPos(){this.closeExtra();let t=0;for(let i=this.open;i>=0;i--){let n=this.nodes[i].content;for(let o=n.length-1;o>=0;o--)t+=n[o].nodeSize;i&&t++}return t}findAtPoint(t,i){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==i&&(this.find[n].pos=this.currentPos)}findInside(t){if(this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&t.nodeType==1&&t.contains(this.find[i].node)&&(this.find[i].pos=this.currentPos)}findAround(t,i,n){if(t!=i&&this.find)for(let o=0;o<this.find.length;o++)this.find[o].pos==null&&t.nodeType==1&&t.contains(this.find[o].node)&&i.compareDocumentPosition(this.find[o].node)&(n?2:4)&&(this.find[o].pos=this.currentPos)}findInText(t){if(this.find)for(let i=0;i<this.find.length;i++)this.find[i].node==t&&(this.find[i].pos=this.currentPos-(t.nodeValue.length-this.find[i].offset))}matchesContext(t){if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);let i=t.split("/"),n=this.options.context,o=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),s=-(n?n.depth+1:0)+(o?0:1),r=(a,l)=>{for(;a>=0;a--){let d=i[a];if(d==""){if(a==i.length-1||a==0)continue;for(;l>=s;l--)if(r(a-1,l))return!0;return!1}else{let c=l>0||l==0&&o?this.nodes[l].type:n&&l>=s?n.node(l-s).type:null;if(!c||c.name!=d&&!c.isInGroup(d))return!1;l--}}return!0};return r(i.length-1,this.open)}textblockFromContext(){let t=this.options.context;if(t)for(let i=t.depth;i>=0;i--){let n=t.node(i).contentMatchAt(t.indexAfter(i)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let i in this.parser.schema.nodes){let n=this.parser.schema.nodes[i];if(n.isTextblock&&n.defaultAttrs)return n}}};function ak(e){for(let t=e.firstChild,i=null;t;t=t.nextSibling){let n=t.nodeType==1?t.nodeName.toLowerCase():null;n&&ib.hasOwnProperty(n)&&i?(i.appendChild(t),t=i):n=="li"?i=t:n&&(i=null)}}function lk(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function N1(e){let t={};for(let i in e)t[i]=e[i];return t}function B1(e,t){let i=t.schema.nodes;for(let n in i){let o=i[n];if(!o.allowsMarkType(e))continue;let s=[],r=a=>{s.push(a);for(let l=0;l<a.edgeCount;l++){let{type:d,next:c}=a.edge(l);if(d==t||s.indexOf(c)<0&&r(c))return!0}};if(r(o.contentMatch))return!0}}var Tn=class e{constructor(t,i){this.nodes=t,this.marks=i}serializeFragment(t,i={},n){n||(n=fg(i).createDocumentFragment());let o=n,s=[];return t.forEach(r=>{if(s.length||r.marks.length){let a=0,l=0;for(;a<s.length&&l<r.marks.length;){let d=r.marks[l];if(!this.marks[d.type.name]){l++;continue}if(!d.eq(s[a][0])||d.type.spec.spanning===!1)break;a++,l++}for(;a<s.length;)o=s.pop()[1];for(;l<r.marks.length;){let d=r.marks[l++],c=this.serializeMark(d,r.isInline,i);c&&(s.push([d,o]),o.appendChild(c.dom),o=c.contentDOM||c.dom)}}o.appendChild(this.serializeNodeInner(r,i))}),n}serializeNodeInner(t,i){let{dom:n,contentDOM:o}=qd(fg(i),this.nodes[t.type.name](t),null,t.attrs);if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,i,o)}return n}serializeNode(t,i={}){let n=this.serializeNodeInner(t,i);for(let o=t.marks.length-1;o>=0;o--){let s=this.serializeMark(t.marks[o],t.isInline,i);s&&((s.contentDOM||s.dom).appendChild(n),n=s.dom)}return n}serializeMark(t,i,n={}){let o=this.marks[t.type.name];return o&&qd(fg(n),o(t,i),null,t.attrs)}static renderSpec(t,i,n=null,o){return qd(t,i,n,o)}static fromSchema(t){return t.cached.domSerializer||(t.cached.domSerializer=new e(this.nodesFromSchema(t),this.marksFromSchema(t)))}static nodesFromSchema(t){let i=H1(t.nodes);return i.text||(i.text=n=>n.text),i}static marksFromSchema(t){return H1(t.marks)}};function H1(e){let t={};for(let i in e){let n=e[i].spec.toDOM;n&&(t[i]=n)}return t}function fg(e){return e.document||window.document}var G1=new WeakMap;function dk(e){let t=G1.get(e);return t===void 0&&G1.set(e,t=ck(e)),t}function ck(e){let t=null;function i(n){if(n&&typeof n=="object")if(Array.isArray(n))if(typeof n[0]=="string")t||(t=[]),t.push(n);else for(let o=0;o<n.length;o++)i(n[o]);else for(let o in n)i(n[o])}return i(e),t}function qd(e,t,i,n){if(typeof t=="string")return{dom:e.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let o=t[0],s;if(typeof o!="string")throw new RangeError("Invalid array passed to renderSpec");if(n&&(s=dk(n))&&s.indexOf(t)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let r=o.indexOf(" ");r>0&&(i=o.slice(0,r),o=o.slice(r+1));let a,l=i?e.createElementNS(i,o):e.createElement(o),d=t[1],c=1;if(d&&typeof d=="object"&&d.nodeType==null&&!Array.isArray(d)){c=2;for(let u in d)if(d[u]!=null){let h=u.indexOf(" ");h>0?l.setAttributeNS(u.slice(0,h),u.slice(h+1),d[u]):u=="style"&&l.style?l.style.cssText=d[u]:l.setAttribute(u,d[u])}}for(let u=c;u<t.length;u++){let h=t[u];if(h===0){if(u<t.length-1||u>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:p,contentDOM:g}=qd(e,h,i,n);if(l.appendChild(p),g){if(a)throw new RangeError("Multiple content holes");a=g}}}return{dom:l,contentDOM:a}}var sb=65535,rb=Math.pow(2,16);function uk(e,t){return e+t*rb}function nb(e){return e&sb}function hk(e){return(e-(e&sb))/rb}var ab=1,lb=2,Jd=4,db=8,Ga=class{constructor(t,i,n){this.pos=t,this.delInfo=i,this.recover=n}get deleted(){return(this.delInfo&db)>0}get deletedBefore(){return(this.delInfo&(ab|Jd))>0}get deletedAfter(){return(this.delInfo&(lb|Jd))>0}get deletedAcross(){return(this.delInfo&Jd)>0}},An=class e{constructor(t,i=!1){if(this.ranges=t,this.inverted=i,!t.length&&e.empty)return e.empty}recover(t){let i=0,n=nb(t);if(!this.inverted)for(let o=0;o<n;o++)i+=this.ranges[o*3+2]-this.ranges[o*3+1];return this.ranges[n*3]+i+hk(t)}mapResult(t,i=1){return this._map(t,i,!1)}map(t,i=1){return this._map(t,i,!0)}_map(t,i,n){let o=0,s=this.inverted?2:1,r=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?o:0);if(l>t)break;let d=this.ranges[a+s],c=this.ranges[a+r],u=l+d;if(t<=u){let h=d?t==l?-1:t==u?1:i:i,p=l+o+(h<0?0:c);if(n)return p;let g=t==(i<0?l:u)?null:uk(a/3,t-l),f=t==l?lb:t==u?ab:Jd;return(i<0?t!=l:t!=u)&&(f|=db),new Ga(p,f,g)}o+=c-d}return n?t+o:new Ga(t+o,0,null)}touches(t,i){let n=0,o=nb(i),s=this.inverted?2:1,r=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?n:0);if(l>t)break;let d=this.ranges[a+s],c=l+d;if(t<=c&&a==o*3)return!0;n+=this.ranges[a+r]-d}return!1}forEach(t){let i=this.inverted?2:1,n=this.inverted?1:2;for(let o=0,s=0;o<this.ranges.length;o+=3){let r=this.ranges[o],a=r-(this.inverted?s:0),l=r+(this.inverted?0:s),d=this.ranges[o+i],c=this.ranges[o+n];t(a,a+d,l,l+c),s+=c-d}}invert(){return new e(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return t==0?e.empty:new e(t<0?[0,-t,0]:[0,0,t])}};An.empty=new An([]);var Va=class e{constructor(t,i,n=0,o=t?t.length:0){this.mirror=i,this.from=n,this.to=o,this._maps=t||[],this.ownData=!(t||i)}get maps(){return this._maps}slice(t=0,i=this.maps.length){return new e(this._maps,this.mirror,t,i)}appendMap(t,i){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(t),i!=null&&this.setMirror(this._maps.length-1,i)}appendMapping(t){for(let i=0,n=this._maps.length;i<t._maps.length;i++){let o=t.getMirror(i);this.appendMap(t._maps[i],o!=null&&o<i?n+o:void 0)}}getMirror(t){if(this.mirror){for(let i=0;i<this.mirror.length;i++)if(this.mirror[i]==t)return this.mirror[i+(i%2?-1:1)]}}setMirror(t,i){this.mirror||(this.mirror=[]),this.mirror.push(t,i)}appendMappingInverted(t){for(let i=t.maps.length-1,n=this._maps.length+t._maps.length;i>=0;i--){let o=t.getMirror(i);this.appendMap(t._maps[i].invert(),o!=null&&o>i?n-o-1:void 0)}}invert(){let t=new e;return t.appendMappingInverted(this),t}map(t,i=1){if(this.mirror)return this._map(t,i,!0);for(let n=this.from;n<this.to;n++)t=this._maps[n].map(t,i);return t}mapResult(t,i=1){return this._map(t,i,!1)}_map(t,i,n){let o=0;for(let s=this.from;s<this.to;s++){let r=this._maps[s],a=r.mapResult(t,i);if(a.recover!=null){let l=this.getMirror(s);if(l!=null&&l>s&&l<this.to){s=l,t=this._maps[l].recover(a.recover);continue}}o|=a.delInfo,t=a.pos}return n?t:new Ga(t,o,null)}},Sg=Object.create(null),Rt=class{getMap(){return An.empty}merge(t){return null}static fromJSON(t,i){if(!i||!i.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=Sg[i.stepType];if(!n)throw new RangeError(`No step type ${i.stepType} defined`);return n.fromJSON(t,i)}static jsonID(t,i){if(t in Sg)throw new RangeError("Duplicate use of step JSON ID "+t);return Sg[t]=i,i.prototype.jsonID=t,i}},Tt=class e{constructor(t,i){this.doc=t,this.failed=i}static ok(t){return new e(t,null)}static fail(t){return new e(null,t)}static fromReplace(t,i,n,o){try{return e.ok(t.replace(i,n,o))}catch(s){if(s instanceof hs)return e.fail(s.message);throw s}}};function Mg(e,t,i){let n=[];for(let o=0;o<e.childCount;o++){let s=e.child(o);s.content.size&&(s=s.copy(Mg(s.content,t,s))),s.isInline&&(s=t(s,i,o)),n.push(s)}return N.fromArray(n)}var za=class e extends Rt{constructor(t,i,n){super(),this.from=t,this.to=i,this.mark=n}apply(t){let i=t.slice(this.from,this.to),n=t.resolve(this.from),o=n.node(n.sharedDepth(this.to)),s=new K(Mg(i.content,(r,a)=>!r.isAtom||!a.type.allowsMarkType(this.mark.type)?r:r.mark(this.mark.addToSet(r.marks)),o),i.openStart,i.openEnd);return Tt.fromReplace(t,this.from,this.to,s)}invert(){return new In(this.from,this.to,this.mark)}map(t){let i=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return i.deleted&&n.deleted||i.pos>=n.pos?null:new e(i.pos,n.pos,this.mark)}merge(t){return t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,i){if(typeof i.from!="number"||typeof i.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new e(i.from,i.to,t.markFromJSON(i.mark))}};Rt.jsonID("addMark",za);var In=class e extends Rt{constructor(t,i,n){super(),this.from=t,this.to=i,this.mark=n}apply(t){let i=t.slice(this.from,this.to),n=new K(Mg(i.content,o=>o.mark(this.mark.removeFromSet(o.marks)),t),i.openStart,i.openEnd);return Tt.fromReplace(t,this.from,this.to,n)}invert(){return new za(this.from,this.to,this.mark)}map(t){let i=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return i.deleted&&n.deleted||i.pos>=n.pos?null:new e(i.pos,n.pos,this.mark)}merge(t){return t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,i){if(typeof i.from!="number"||typeof i.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new e(i.from,i.to,t.markFromJSON(i.mark))}};Rt.jsonID("removeMark",In);var Wa=class e extends Rt{constructor(t,i){super(),this.pos=t,this.mark=i}apply(t){let i=t.nodeAt(this.pos);if(!i)return Tt.fail("No node at mark step's position");let n=i.type.create(i.attrs,null,this.mark.addToSet(i.marks));return Tt.fromReplace(t,this.pos,this.pos+1,new K(N.from(n),0,i.isLeaf?0:1))}invert(t){let i=t.nodeAt(this.pos);if(i){let n=this.mark.addToSet(i.marks);if(n.length==i.marks.length){for(let o=0;o<i.marks.length;o++)if(!i.marks[o].isInSet(n))return new e(this.pos,i.marks[o]);return new e(this.pos,this.mark)}}return new Cr(this.pos,this.mark)}map(t){let i=t.mapResult(this.pos,1);return i.deletedAfter?null:new e(i.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,i){if(typeof i.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new e(i.pos,t.markFromJSON(i.mark))}};Rt.jsonID("addNodeMark",Wa);var Cr=class e extends Rt{constructor(t,i){super(),this.pos=t,this.mark=i}apply(t){let i=t.nodeAt(this.pos);if(!i)return Tt.fail("No node at mark step's position");let n=i.type.create(i.attrs,null,this.mark.removeFromSet(i.marks));return Tt.fromReplace(t,this.pos,this.pos+1,new K(N.from(n),0,i.isLeaf?0:1))}invert(t){let i=t.nodeAt(this.pos);return!i||!this.mark.isInSet(i.marks)?this:new Wa(this.pos,this.mark)}map(t){let i=t.mapResult(this.pos,1);return i.deletedAfter?null:new e(i.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,i){if(typeof i.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new e(i.pos,t.markFromJSON(i.mark))}};Rt.jsonID("removeNodeMark",Cr);var zt=class e extends Rt{constructor(t,i,n,o=!1){super(),this.from=t,this.to=i,this.slice=n,this.structure=o}apply(t){return this.structure&&Rg(t,this.from,this.to)?Tt.fail("Structure replace would overwrite content"):Tt.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new An([this.from,this.to-this.from,this.slice.size])}invert(t){return new e(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let i=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return i.deletedAcross&&n.deletedAcross?null:new e(i.pos,Math.max(i.pos,n.pos),this.slice,this.structure)}merge(t){if(!(t instanceof e)||t.structure||this.structure)return null;if(this.from+this.slice.size==t.from&&!this.slice.openEnd&&!t.slice.openStart){let i=this.slice.size+t.slice.size==0?K.empty:new K(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new e(this.from,this.to+(t.to-t.from),i,this.structure)}else if(t.to==this.from&&!this.slice.openStart&&!t.slice.openEnd){let i=this.slice.size+t.slice.size==0?K.empty:new K(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new e(t.from,this.to,i,this.structure)}else return null}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,i){if(typeof i.from!="number"||typeof i.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new e(i.from,i.to,K.fromJSON(t,i.slice),!!i.structure)}};Rt.jsonID("replace",zt);var mt=class e extends Rt{constructor(t,i,n,o,s,r,a=!1){super(),this.from=t,this.to=i,this.gapFrom=n,this.gapTo=o,this.slice=s,this.insert=r,this.structure=a}apply(t){if(this.structure&&(Rg(t,this.from,this.gapFrom)||Rg(t,this.gapTo,this.to)))return Tt.fail("Structure gap-replace would overwrite content");let i=t.slice(this.gapFrom,this.gapTo);if(i.openStart||i.openEnd)return Tt.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,i.content);return n?Tt.fromReplace(t,this.from,this.to,n):Tt.fail("Content does not fit in gap")}getMap(){return new An([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let i=this.gapTo-this.gapFrom;return new e(this.from,this.from+this.slice.size+i,this.from+this.insert,this.from+this.insert+i,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let i=t.mapResult(this.from,1),n=t.mapResult(this.to,-1),o=this.from==this.gapFrom?i.pos:t.map(this.gapFrom,-1),s=this.to==this.gapTo?n.pos:t.map(this.gapTo,1);return i.deletedAcross&&n.deletedAcross||o<i.pos||s>n.pos?null:new e(i.pos,n.pos,o,s,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,i){if(typeof i.from!="number"||typeof i.to!="number"||typeof i.gapFrom!="number"||typeof i.gapTo!="number"||typeof i.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new e(i.from,i.to,i.gapFrom,i.gapTo,K.fromJSON(t,i.slice),i.insert,!!i.structure)}};Rt.jsonID("replaceAround",mt);function Rg(e,t,i){let n=e.resolve(t),o=i-t,s=n.depth;for(;o>0&&s>0&&n.indexAfter(s)==n.node(s).childCount;)s--,o--;if(o>0){let r=n.node(s).maybeChild(n.indexAfter(s));for(;o>0;){if(!r||r.isLeaf)return!0;r=r.firstChild,o--}}return!1}function pk(e,t,i,n){let o=[],s=[],r,a;e.doc.nodesBetween(t,i,(l,d,c)=>{if(!l.isInline)return;let u=l.marks;if(!n.isInSet(u)&&c.type.allowsMarkType(n.type)){let h=Math.max(d,t),p=Math.min(d+l.nodeSize,i),g=n.addToSet(u);for(let f=0;f<u.length;f++)u[f].isInSet(g)||(r&&r.to==h&&r.mark.eq(u[f])?r.to=p:o.push(r=new In(h,p,u[f])));a&&a.to==h?a.to=p:s.push(a=new za(h,p,n))}}),o.forEach(l=>e.step(l)),s.forEach(l=>e.step(l))}function gk(e,t,i,n){let o=[],s=0;e.doc.nodesBetween(t,i,(r,a)=>{if(!r.isInline)return;s++;let l=null;if(n instanceof Oa){let d=r.marks,c;for(;c=n.isInSet(d);)(l||(l=[])).push(c),d=c.removeFromSet(d)}else n?n.isInSet(r.marks)&&(l=[n]):l=r.marks;if(l&&l.length){let d=Math.min(a+r.nodeSize,i);for(let c=0;c<l.length;c++){let u=l[c],h;for(let p=0;p<o.length;p++){let g=o[p];g.step==s-1&&u.eq(o[p].style)&&(h=g)}h?(h.to=d,h.step=s):o.push({style:u,from:Math.max(a,t),to:d,step:s})}}}),o.forEach(r=>e.step(new In(r.from,r.to,r.style)))}function kg(e,t,i,n=i.contentMatch,o=!0){let s=e.doc.nodeAt(t),r=[],a=t+1;for(let l=0;l<s.childCount;l++){let d=s.child(l),c=a+d.nodeSize,u=n.matchType(d.type);if(!u)r.push(new zt(a,c,K.empty));else{n=u;for(let h=0;h<d.marks.length;h++)i.allowsMarkType(d.marks[h].type)||e.step(new In(a,c,d.marks[h]));if(o&&d.isText&&i.whitespace!="pre"){let h,p=/\r?\n|\r/g,g;for(;h=p.exec(d.text);)g||(g=new K(N.from(i.schema.text(" ",i.allowedMarks(d.marks))),0,0)),r.push(new zt(a+h.index,a+h.index+h[0].length,g))}}a=c}if(!n.validEnd){let l=n.fillBefore(N.empty,!0);e.replace(a,a,new K(l,0,0))}for(let l=r.length-1;l>=0;l--)e.step(r[l])}function fk(e,t,i){return(t==0||e.canReplace(t,e.childCount))&&(i==e.childCount||e.canReplace(0,i))}function Ln(e){let i=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let n=e.depth,o=0,s=0;;--n){let r=e.$from.node(n),a=e.$from.index(n)+o,l=e.$to.indexAfter(n)-s;if(n<e.depth&&r.canReplace(a,l,i))return n;if(n==0||r.type.spec.isolating||!fk(r,a,l))break;a&&(o=1),l<r.childCount&&(s=1)}return null}function mk(e,t,i){let{$from:n,$to:o,depth:s}=t,r=n.before(s+1),a=o.after(s+1),l=r,d=a,c=N.empty,u=0;for(let g=s,f=!1;g>i;g--)f||n.index(g)>0?(f=!0,c=N.from(n.node(g).copy(c)),u++):l--;let h=N.empty,p=0;for(let g=s,f=!1;g>i;g--)f||o.after(g+1)<o.end(g)?(f=!0,h=N.from(o.node(g).copy(h)),p++):d++;e.step(new mt(l,d,r,a,new K(c.append(h),u,p),c.size-u,!0))}function br(e,t,i=null,n=e){let o=Ck(e,t),s=o&&vk(n,t);return s?o.map(ob).concat({type:t,attrs:i}).concat(s.map(ob)):null}function ob(e){return{type:e,attrs:null}}function Ck(e,t){let{parent:i,startIndex:n,endIndex:o}=e,s=i.contentMatchAt(n).findWrapping(t);if(!s)return null;let r=s.length?s[0]:t;return i.canReplaceWith(n,o,r)?s:null}function vk(e,t){let{parent:i,startIndex:n,endIndex:o}=e,s=i.child(n),r=t.contentMatch.findWrapping(s.type);if(!r)return null;let l=(r.length?r[r.length-1]:t).contentMatch;for(let d=n;l&&d<o;d++)l=l.matchType(i.child(d).type);return!l||!l.validEnd?null:r}function wk(e,t,i){let n=N.empty;for(let r=i.length-1;r>=0;r--){if(n.size){let a=i[r].type.contentMatch.matchFragment(n);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=N.from(i[r].type.create(i[r].attrs,n))}let o=t.start,s=t.end;e.step(new mt(o,s,o,s,new K(n,0,0),i.length,!0))}function bk(e,t,i,n,o){if(!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=e.steps.length;e.doc.nodesBetween(t,i,(r,a)=>{let l=typeof o=="function"?o(r):o;if(r.isTextblock&&!r.hasMarkup(n,l)&&yk(e.doc,e.mapping.slice(s).map(a),n)){let d=null;if(n.schema.linebreakReplacement){let p=n.whitespace=="pre",g=!!n.contentMatch.matchType(n.schema.linebreakReplacement);p&&!g?d=!1:!p&&g&&(d=!0)}d===!1&&ub(e,r,a,s),kg(e,e.mapping.slice(s).map(a,1),n,void 0,d===null);let c=e.mapping.slice(s),u=c.map(a,1),h=c.map(a+r.nodeSize,1);return e.step(new mt(u,h,u+1,h-1,new K(N.from(n.create(l,null,r.marks)),0,0),1,!0)),d===!0&&cb(e,r,a,s),!1}})}function cb(e,t,i,n){t.forEach((o,s)=>{if(o.isText){let r,a=/\r?\n|\r/g;for(;r=a.exec(o.text);){let l=e.mapping.slice(n).map(i+1+s+r.index);e.replaceWith(l,l+1,t.type.schema.linebreakReplacement.create())}}})}function ub(e,t,i,n){t.forEach((o,s)=>{if(o.type==o.type.schema.linebreakReplacement){let r=e.mapping.slice(n).map(i+1+s);e.replaceWith(r,r+1,t.type.schema.text(`
`))}})}function yk(e,t,i){let n=e.resolve(t),o=n.index();return n.parent.canReplaceWith(o,o+1,i)}function Sk(e,t,i,n,o){let s=e.doc.nodeAt(t);if(!s)throw new RangeError("No node at given position");i||(i=s.type);let r=i.create(n,null,o||s.marks);if(s.isLeaf)return e.replaceWith(t,t+s.nodeSize,r);if(!i.validContent(s.content))throw new RangeError("Invalid content for node type "+i.name);e.step(new mt(t,t+s.nodeSize,t+1,t+s.nodeSize-1,new K(N.from(r),0,0),1,!0))}function fi(e,t,i=1,n){let o=e.resolve(t),s=o.depth-i,r=n&&n[n.length-1]||o.parent;if(s<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!r.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(let d=o.depth-1,c=i-2;d>s;d--,c--){let u=o.node(d),h=o.index(d);if(u.type.spec.isolating)return!1;let p=u.content.cutByIndex(h,u.childCount),g=n&&n[c+1];g&&(p=p.replaceChild(0,g.type.create(g.attrs)));let f=n&&n[c]||u;if(!u.canReplace(h+1,u.childCount)||!f.type.validContent(p))return!1}let a=o.indexAfter(s),l=n&&n[0];return o.node(s).canReplaceWith(a,a,l?l.type:o.node(s+1).type)}function xk(e,t,i=1,n){let o=e.doc.resolve(t),s=N.empty,r=N.empty;for(let a=o.depth,l=o.depth-i,d=i-1;a>l;a--,d--){s=N.from(o.node(a).copy(s));let c=n&&n[d];r=N.from(c?c.type.create(c.attrs,r):o.node(a).copy(r))}e.step(new zt(t,t,new K(s.append(r),i,i),!0))}function Ei(e,t){let i=e.resolve(t),n=i.index();return hb(i.nodeBefore,i.nodeAfter)&&i.parent.canReplace(n,n+1)}function Ek(e,t){t.content.size||e.type.compatibleContent(t.type);let i=e.contentMatchAt(e.childCount),{linebreakReplacement:n}=e.type.schema;for(let o=0;o<t.childCount;o++){let s=t.child(o),r=s.type==n?e.type.schema.nodes.text:s.type;if(i=i.matchType(r),!i||!e.type.allowsMarks(s.marks))return!1}return i.validEnd}function hb(e,t){return!!(e&&t&&!e.isLeaf&&Ek(e,t))}function fs(e,t,i=-1){let n=e.resolve(t);for(let o=n.depth;;o--){let s,r,a=n.index(o);if(o==n.depth?(s=n.nodeBefore,r=n.nodeAfter):i>0?(s=n.node(o+1),a++,r=n.node(o).maybeChild(a)):(s=n.node(o).maybeChild(a-1),r=n.node(o+1)),s&&!s.isTextblock&&hb(s,r)&&n.node(o).canReplace(a,a+1))return t;if(o==0)break;t=i<0?n.before(o):n.after(o)}}function Rk(e,t,i){let n=null,{linebreakReplacement:o}=e.doc.type.schema,s=e.doc.resolve(t-i),r=s.node().type;if(o&&r.inlineContent){let c=r.whitespace=="pre",u=!!r.contentMatch.matchType(o);c&&!u?n=!1:!c&&u&&(n=!0)}let a=e.steps.length;if(n===!1){let c=e.doc.resolve(t+i);ub(e,c.node(),c.before(),a)}r.inlineContent&&kg(e,t+i-1,r,s.node().contentMatchAt(s.index()),n==null);let l=e.mapping.slice(a),d=l.map(t-i);if(e.step(new zt(d,l.map(t+i,-1),K.empty,!0)),n===!0){let c=e.doc.resolve(d);cb(e,c.node(),c.before(),e.steps.length)}return e}function Pk(e,t,i){let n=e.resolve(t);if(n.parent.canReplaceWith(n.index(),n.index(),i))return t;if(n.parentOffset==0)for(let o=n.depth-1;o>=0;o--){let s=n.index(o);if(n.node(o).canReplaceWith(s,s,i))return n.before(o+1);if(s>0)return null}if(n.parentOffset==n.parent.content.size)for(let o=n.depth-1;o>=0;o--){let s=n.indexAfter(o);if(n.node(o).canReplaceWith(s,s,i))return n.after(o+1);if(s<n.node(o).childCount)return null}return null}function ec(e,t,i){let n=e.resolve(t);if(!i.content.size)return t;let o=i.content;for(let s=0;s<i.openStart;s++)o=o.firstChild.content;for(let s=1;s<=(i.openStart==0&&i.size?2:1);s++)for(let r=n.depth;r>=0;r--){let a=r==n.depth?0:n.pos<=(n.start(r+1)+n.end(r+1))/2?-1:1,l=n.index(r)+(a>0?1:0),d=n.node(r),c=!1;if(s==1)c=d.canReplace(l,l,o);else{let u=d.contentMatchAt(l).findWrapping(o.firstChild.type);c=u&&d.canReplaceWith(l,l,u[0])}if(c)return a==0?n.pos:a<0?n.before(r+1):n.after(r+1)}return null}function Ua(e,t,i=t,n=K.empty){if(t==i&&!n.size)return null;let o=e.resolve(t),s=e.resolve(i);return pb(o,s,n)?new zt(t,i,n):new Pg(o,s,n).fit()}function pb(e,t,i){return!i.openStart&&!i.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),i.content)}var Pg=class{constructor(t,i,n){this.$from=t,this.$to=i,this.unplaced=n,this.frontier=[],this.placed=N.empty;for(let o=0;o<=t.depth;o++){let s=t.node(o);this.frontier.push({type:s.type,match:s.contentMatchAt(t.indexAfter(o))})}for(let o=t.depth;o>0;o--)this.placed=N.from(t.node(o).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let d=this.findFittable();d?this.placeNodes(d):this.openMore()||this.dropNode()}let t=this.mustMoveInline(),i=this.placed.size-this.depth-this.$from.depth,n=this.$from,o=this.close(t<0?this.$to:n.doc.resolve(t));if(!o)return null;let s=this.placed,r=n.depth,a=o.depth;for(;r&&a&&s.childCount==1;)s=s.firstChild.content,r--,a--;let l=new K(s,r,a);return t>-1?new mt(n.pos,t,this.$to.pos,this.$to.end(),l,i):l.size||n.pos!=this.$to.pos?new zt(n.pos,o.pos,l):null}findFittable(){let t=this.unplaced.openStart;for(let i=this.unplaced.content,n=0,o=this.unplaced.openEnd;n<t;n++){let s=i.firstChild;if(i.childCount>1&&(o=0),s.type.spec.isolating&&o<=n){t=n;break}i=s.content}for(let i=1;i<=2;i++)for(let n=i==1?t:this.unplaced.openStart;n>=0;n--){let o,s=null;n?(s=xg(this.unplaced.content,n-1).firstChild,o=s.content):o=this.unplaced.content;let r=o.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:d}=this.frontier[a],c,u=null;if(i==1&&(r?d.matchType(r.type)||(u=d.fillBefore(N.from(r),!1)):s&&l.compatibleContent(s.type)))return{sliceDepth:n,frontierDepth:a,parent:s,inject:u};if(i==2&&r&&(c=d.findWrapping(r.type)))return{sliceDepth:n,frontierDepth:a,parent:s,wrap:c};if(s&&d.matchType(s.type))break}}}openMore(){let{content:t,openStart:i,openEnd:n}=this.unplaced,o=xg(t,i);return!o.childCount||o.firstChild.isLeaf?!1:(this.unplaced=new K(t,i+1,Math.max(n,o.size+i>=t.size-n?i+1:0)),!0)}dropNode(){let{content:t,openStart:i,openEnd:n}=this.unplaced,o=xg(t,i);if(o.childCount<=1&&i>0){let s=t.size-i<=i+o.size;this.unplaced=new K(Ba(t,i-1,1),i-1,s?i-1:n)}else this.unplaced=new K(Ba(t,i,1),i,n)}placeNodes({sliceDepth:t,frontierDepth:i,parent:n,inject:o,wrap:s}){for(;this.depth>i;)this.closeFrontierNode();if(s)for(let f=0;f<s.length;f++)this.openFrontierNode(s[f]);let r=this.unplaced,a=n?n.content:r.content,l=r.openStart-t,d=0,c=[],{match:u,type:h}=this.frontier[i];if(o){for(let f=0;f<o.childCount;f++)c.push(o.child(f));u=u.matchFragment(o)}let p=a.size+t-(r.content.size-r.openEnd);for(;d<a.childCount;){let f=a.child(d),m=u.matchType(f.type);if(!m)break;d++,(d>1||l==0||f.content.size)&&(u=m,c.push(gb(f.mark(h.allowedMarks(f.marks)),d==1?l:0,d==a.childCount?p:-1)))}let g=d==a.childCount;g||(p=-1),this.placed=Ha(this.placed,i,N.from(c)),this.frontier[i].match=u,g&&p<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let f=0,m=a;f<p;f++){let C=m.lastChild;this.frontier.push({type:C.type,match:C.contentMatchAt(C.childCount)}),m=C.content}this.unplaced=g?t==0?K.empty:new K(Ba(r.content,t-1,1),t-1,p<0?r.openEnd:t-1):new K(Ba(r.content,t,d),r.openStart,r.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let t=this.frontier[this.depth],i;if(!t.type.isTextblock||!Eg(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(i=this.findCloseLevel(this.$to))&&i.depth==this.depth)return-1;let{depth:n}=this.$to,o=this.$to.after(n);for(;n>1&&o==this.$to.end(--n);)++o;return o}findCloseLevel(t){e:for(let i=Math.min(this.depth,t.depth);i>=0;i--){let{match:n,type:o}=this.frontier[i],s=i<t.depth&&t.end(i+1)==t.pos+(t.depth-(i+1)),r=Eg(t,i,o,n,s);if(r){for(let a=i-1;a>=0;a--){let{match:l,type:d}=this.frontier[a],c=Eg(t,a,d,l,!0);if(!c||c.childCount)continue e}return{depth:i,fit:r,move:s?t.doc.resolve(t.after(i+1)):t}}}}close(t){let i=this.findCloseLevel(t);if(!i)return null;for(;this.depth>i.depth;)this.closeFrontierNode();i.fit.childCount&&(this.placed=Ha(this.placed,i.depth,i.fit)),t=i.move;for(let n=i.depth+1;n<=t.depth;n++){let o=t.node(n),s=o.type.contentMatch.fillBefore(o.content,!0,t.index(n));this.openFrontierNode(o.type,o.attrs,s)}return t}openFrontierNode(t,i=null,n){let o=this.frontier[this.depth];o.match=o.match.matchType(t),this.placed=Ha(this.placed,this.depth,N.from(t.create(i,n))),this.frontier.push({type:t,match:t.contentMatch})}closeFrontierNode(){let i=this.frontier.pop().match.fillBefore(N.empty,!0);i.childCount&&(this.placed=Ha(this.placed,this.frontier.length,i))}};function Ba(e,t,i){return t==0?e.cutByIndex(i,e.childCount):e.replaceChild(0,e.firstChild.copy(Ba(e.firstChild.content,t-1,i)))}function Ha(e,t,i){return t==0?e.append(i):e.replaceChild(e.childCount-1,e.lastChild.copy(Ha(e.lastChild.content,t-1,i)))}function xg(e,t){for(let i=0;i<t;i++)e=e.firstChild.content;return e}function gb(e,t,i){if(t<=0)return e;let n=e.content;return t>1&&(n=n.replaceChild(0,gb(n.firstChild,t-1,n.childCount==1?i-1:0))),t>0&&(n=e.type.contentMatch.fillBefore(n).append(n),i<=0&&(n=n.append(e.type.contentMatch.matchFragment(n).fillBefore(N.empty,!0)))),e.copy(n)}function Eg(e,t,i,n,o){let s=e.node(t),r=o?e.indexAfter(t):e.index(t);if(r==s.childCount&&!i.compatibleContent(s.type))return null;let a=n.fillBefore(s.content,!0,r);return a&&!Mk(i,s.content,r)?a:null}function Mk(e,t,i){for(let n=i;n<t.childCount;n++)if(!e.allowsMarks(t.child(n).marks))return!0;return!1}function kk(e){return e.spec.defining||e.spec.definingForContent}function Dk(e,t,i,n){if(!n.size)return e.deleteRange(t,i);let o=e.doc.resolve(t),s=e.doc.resolve(i);if(pb(o,s,n))return e.step(new zt(t,i,n));let r=mb(o,s);r[r.length-1]==0&&r.pop();let a=-(o.depth+1);r.unshift(a);for(let h=o.depth,p=o.pos-1;h>0;h--,p--){let g=o.node(h).type.spec;if(g.defining||g.definingAsContext||g.isolating)break;r.indexOf(h)>-1?a=h:o.before(h)==p&&r.splice(1,0,-h)}let l=r.indexOf(a),d=[],c=n.openStart;for(let h=n.content,p=0;;p++){let g=h.firstChild;if(d.push(g),p==n.openStart)break;h=g.content}for(let h=c-1;h>=0;h--){let p=d[h],g=kk(p.type);if(g&&!p.sameMarkup(o.node(Math.abs(a)-1)))c=h;else if(g||!p.type.isTextblock)break}for(let h=n.openStart;h>=0;h--){let p=(h+c+1)%(n.openStart+1),g=d[p];if(g)for(let f=0;f<r.length;f++){let m=r[(f+l)%r.length],C=!0;m<0&&(C=!1,m=-m);let v=o.node(m-1),w=o.index(m-1);if(v.canReplaceWith(w,w,g.type,g.marks))return e.replace(o.before(m),C?s.after(m):i,new K(fb(n.content,0,n.openStart,p),p,n.openEnd))}}let u=e.steps.length;for(let h=r.length-1;h>=0&&(e.replace(t,i,n),!(e.steps.length>u));h--){let p=r[h];p<0||(t=o.before(p),i=s.after(p))}}function fb(e,t,i,n,o){if(t<i){let s=e.firstChild;e=e.replaceChild(0,s.copy(fb(s.content,t+1,i,n,s)))}if(t>n){let s=o.contentMatchAt(0),r=s.fillBefore(e).append(e);e=r.append(s.matchFragment(r).fillBefore(N.empty,!0))}return e}function Fk(e,t,i,n){if(!n.isInline&&t==i&&e.doc.resolve(t).parent.content.size){let o=Pk(e.doc,t,n.type);o!=null&&(t=i=o)}e.replaceRange(t,i,new K(N.from(n),0,0))}function Tk(e,t,i){let n=e.doc.resolve(t),o=e.doc.resolve(i),s=mb(n,o);for(let r=0;r<s.length;r++){let a=s[r],l=r==s.length-1;if(l&&a==0||n.node(a).type.contentMatch.validEnd)return e.delete(n.start(a),o.end(a));if(a>0&&(l||n.node(a-1).canReplace(n.index(a-1),o.indexAfter(a-1))))return e.delete(n.before(a),o.after(a))}for(let r=1;r<=n.depth&&r<=o.depth;r++)if(t-n.start(r)==n.depth-r&&i>n.end(r)&&o.end(r)-i!=o.depth-r&&n.start(r-1)==o.start(r-1)&&n.node(r-1).canReplace(n.index(r-1),o.index(r-1)))return e.delete(n.before(r),i);e.delete(t,i)}function mb(e,t){let i=[],n=Math.min(e.depth,t.depth);for(let o=n;o>=0;o--){let s=e.start(o);if(s<e.pos-(e.depth-o)||t.end(o)>t.pos+(t.depth-o)||e.node(o).type.spec.isolating||t.node(o).type.spec.isolating)break;(s==t.start(o)||o==e.depth&&o==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&o&&t.start(o-1)==s-1)&&i.push(o)}return i}var Qd=class e extends Rt{constructor(t,i,n){super(),this.pos=t,this.attr=i,this.value=n}apply(t){let i=t.nodeAt(this.pos);if(!i)return Tt.fail("No node at attribute step's position");let n=Object.create(null);for(let s in i.attrs)n[s]=i.attrs[s];n[this.attr]=this.value;let o=i.type.create(n,null,i.marks);return Tt.fromReplace(t,this.pos,this.pos+1,new K(N.from(o),0,i.isLeaf?0:1))}getMap(){return An.empty}invert(t){return new e(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let i=t.mapResult(this.pos,1);return i.deletedAfter?null:new e(i.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,i){if(typeof i.pos!="number"||typeof i.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new e(i.pos,i.attr,i.value)}};Rt.jsonID("attr",Qd);var Zd=class e extends Rt{constructor(t,i){super(),this.attr=t,this.value=i}apply(t){let i=Object.create(null);for(let o in t.attrs)i[o]=t.attrs[o];i[this.attr]=this.value;let n=t.type.create(i,t.content,t.marks);return Tt.ok(n)}getMap(){return An.empty}invert(t){return new e(this.attr,t.attrs[this.attr])}map(t){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(t,i){if(typeof i.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new e(i.attr,i.value)}};Rt.jsonID("docAttr",Zd);var vr=class extends Error{};vr=function e(t){let i=Error.call(this,t);return i.__proto__=e.prototype,i};vr.prototype=Object.create(Error.prototype);vr.prototype.constructor=vr;vr.prototype.name="TransformError";var wr=class{constructor(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new Va}get before(){return this.docs.length?this.docs[0]:this.doc}step(t){let i=this.maybeStep(t);if(i.failed)throw new vr(i.failed);return this}maybeStep(t){let i=t.apply(this.doc);return i.failed||this.addStep(t,i.doc),i}get docChanged(){return this.steps.length>0}addStep(t,i){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=i}replace(t,i=t,n=K.empty){let o=Ua(this.doc,t,i,n);return o&&this.step(o),this}replaceWith(t,i,n){return this.replace(t,i,new K(N.from(n),0,0))}delete(t,i){return this.replace(t,i,K.empty)}insert(t,i){return this.replaceWith(t,t,i)}replaceRange(t,i,n){return Dk(this,t,i,n),this}replaceRangeWith(t,i,n){return Fk(this,t,i,n),this}deleteRange(t,i){return Tk(this,t,i),this}lift(t,i){return mk(this,t,i),this}join(t,i=1){return Rk(this,t,i),this}wrap(t,i){return wk(this,t,i),this}setBlockType(t,i=t,n,o=null){return bk(this,t,i,n,o),this}setNodeMarkup(t,i,n=null,o){return Sk(this,t,i,n,o),this}setNodeAttribute(t,i,n){return this.step(new Qd(t,i,n)),this}setDocAttribute(t,i){return this.step(new Zd(t,i)),this}addNodeMark(t,i){return this.step(new Wa(t,i)),this}removeNodeMark(t,i){let n=this.doc.nodeAt(t);if(!n)throw new RangeError("No node at position "+t);if(i instanceof Ve)i.isInSet(n.marks)&&this.step(new Cr(t,i));else{let o=n.marks,s,r=[];for(;s=i.isInSet(o);)r.push(new Cr(t,s)),o=s.removeFromSet(o);for(let a=r.length-1;a>=0;a--)this.step(r[a])}return this}split(t,i=1,n){return xk(this,t,i,n),this}addMark(t,i,n){return pk(this,t,i,n),this}removeMark(t,i,n){return gk(this,t,i,n),this}clearIncompatible(t,i,n){return kg(this,t,i,n),this}};var Dg=Object.create(null),de=class{constructor(t,i,n){this.$anchor=t,this.$head=i,this.ranges=n||[new ic(t.min(i),t.max(i))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let t=this.ranges;for(let i=0;i<t.length;i++)if(t[i].$from.pos!=t[i].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(t,i=K.empty){let n=i.content.lastChild,o=null;for(let a=0;a<i.openEnd;a++)o=n,n=n.lastChild;let s=t.steps.length,r=this.ranges;for(let a=0;a<r.length;a++){let{$from:l,$to:d}=r[a],c=t.mapping.slice(s);t.replaceRange(c.map(l.pos),c.map(d.pos),a?K.empty:i),a==0&&wb(t,s,(n?n.isInline:o&&o.isTextblock)?-1:1)}}replaceWith(t,i){let n=t.steps.length,o=this.ranges;for(let s=0;s<o.length;s++){let{$from:r,$to:a}=o[s],l=t.mapping.slice(n),d=l.map(r.pos),c=l.map(a.pos);s?t.deleteRange(d,c):(t.replaceRangeWith(d,c,i),wb(t,n,i.isInline?-1:1))}}static findFrom(t,i,n=!1){let o=t.parent.inlineContent?new ne(t):yr(t.node(0),t.parent,t.pos,t.index(),i,n);if(o)return o;for(let s=t.depth-1;s>=0;s--){let r=i<0?yr(t.node(0),t.node(s),t.before(s+1),t.index(s),i,n):yr(t.node(0),t.node(s),t.after(s+1),t.index(s)+1,i,n);if(r)return r}return null}static near(t,i=1){return this.findFrom(t,i)||this.findFrom(t,-i)||new Zt(t.node(0))}static atStart(t){return yr(t,t,0,0,1)||new Zt(t)}static atEnd(t){return yr(t,t,t.content.size,t.childCount,-1)||new Zt(t)}static fromJSON(t,i){if(!i||!i.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=Dg[i.type];if(!n)throw new RangeError(`No selection type ${i.type} defined`);return n.fromJSON(t,i)}static jsonID(t,i){if(t in Dg)throw new RangeError("Duplicate use of selection JSON ID "+t);return Dg[t]=i,i.prototype.jsonID=t,i}getBookmark(){return ne.between(this.$anchor,this.$head).getBookmark()}};de.prototype.visible=!0;var ic=class{constructor(t,i){this.$from=t,this.$to=i}},Cb=!1;function vb(e){!Cb&&!e.parent.inlineContent&&(Cb=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}var ne=class e extends de{constructor(t,i=t){vb(t),vb(i),super(t,i)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(t,i){let n=t.resolve(i.map(this.head));if(!n.parent.inlineContent)return de.near(n);let o=t.resolve(i.map(this.anchor));return new e(o.parent.inlineContent?o:n,n)}replace(t,i=K.empty){if(super.replace(t,i),i==K.empty){let n=this.$from.marksAcross(this.$to);n&&t.ensureMarks(n)}}eq(t){return t instanceof e&&t.anchor==this.anchor&&t.head==this.head}getBookmark(){return new nc(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(t,i){if(typeof i.anchor!="number"||typeof i.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new e(t.resolve(i.anchor),t.resolve(i.head))}static create(t,i,n=i){let o=t.resolve(i);return new this(o,n==i?o:t.resolve(n))}static between(t,i,n){let o=t.pos-i.pos;if((!n||o)&&(n=o>=0?1:-1),!i.parent.inlineContent){let s=de.findFrom(i,n,!0)||de.findFrom(i,-n,!0);if(s)i=s.$head;else return de.near(i,n)}return t.parent.inlineContent||(o==0?t=i:(t=(de.findFrom(t,-n,!0)||de.findFrom(t,n,!0)).$anchor,t.pos<i.pos!=o<0&&(t=i))),new e(t,i)}};de.jsonID("text",ne);var nc=class e{constructor(t,i){this.anchor=t,this.head=i}map(t){return new e(t.map(this.anchor),t.map(this.head))}resolve(t){return ne.between(t.resolve(this.anchor),t.resolve(this.head))}},J=class e extends de{constructor(t){let i=t.nodeAfter,n=t.node(0).resolve(t.pos+i.nodeSize);super(t,n),this.node=i}map(t,i){let{deleted:n,pos:o}=i.mapResult(this.anchor),s=t.resolve(o);return n?de.near(s):new e(s)}content(){return new K(N.from(this.node),0,0)}eq(t){return t instanceof e&&t.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Tg(this.anchor)}static fromJSON(t,i){if(typeof i.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new e(t.resolve(i.anchor))}static create(t,i){return new e(t.resolve(i))}static isSelectable(t){return!t.isText&&t.type.spec.selectable!==!1}};J.prototype.visible=!1;de.jsonID("node",J);var Tg=class e{constructor(t){this.anchor=t}map(t){let{deleted:i,pos:n}=t.mapResult(this.anchor);return i?new nc(n,n):new e(n)}resolve(t){let i=t.resolve(this.anchor),n=i.nodeAfter;return n&&J.isSelectable(n)?new J(i):de.near(i)}},Zt=class e extends de{constructor(t){super(t.resolve(0),t.resolve(t.content.size))}replace(t,i=K.empty){if(i==K.empty){t.delete(0,t.doc.content.size);let n=de.atStart(t.doc);n.eq(t.selection)||t.setSelection(n)}else super.replace(t,i)}toJSON(){return{type:"all"}}static fromJSON(t){return new e(t)}map(t){return new e(t)}eq(t){return t instanceof e}getBookmark(){return Ak}};de.jsonID("all",Zt);var Ak={map(){return this},resolve(e){return new Zt(e)}};function yr(e,t,i,n,o,s=!1){if(t.inlineContent)return ne.create(e,i);for(let r=n-(o>0?0:1);o>0?r<t.childCount:r>=0;r+=o){let a=t.child(r);if(a.isAtom){if(!s&&J.isSelectable(a))return J.create(e,i-(o<0?a.nodeSize:0))}else{let l=yr(e,a,i+o,o<0?a.childCount:0,o,s);if(l)return l}i+=a.nodeSize*o}return null}function wb(e,t,i){let n=e.steps.length-1;if(n<t)return;let o=e.steps[n];if(!(o instanceof zt||o instanceof mt))return;let s=e.mapping.maps[n],r;s.forEach((a,l,d,c)=>{r==null&&(r=c)}),e.setSelection(de.near(e.doc.resolve(r),i))}var bb=1,tc=2,yb=4,Ag=class extends wr{constructor(t){super(t.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=t.selection,this.storedMarks=t.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=(this.updated|bb)&~tc,this.storedMarks=null,this}get selectionSet(){return(this.updated&bb)>0}setStoredMarks(t){return this.storedMarks=t,this.updated|=tc,this}ensureMarks(t){return Ve.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this}addStoredMark(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&tc)>0}addStep(t,i){super.addStep(t,i),this.updated=this.updated&~tc,this.storedMarks=null}setTime(t){return this.time=t,this}replaceSelection(t){return this.selection.replace(this,t),this}replaceSelectionWith(t,i=!0){let n=this.selection;return i&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||Ve.none))),n.replaceWith(this,t),this}deleteSelection(){return this.selection.replace(this),this}insertText(t,i,n){let o=this.doc.type.schema;if(i==null)return t?this.replaceSelectionWith(o.text(t),!0):this.deleteSelection();{if(n==null&&(n=i),!t)return this.deleteRange(i,n);let s=this.storedMarks;if(!s){let r=this.doc.resolve(i);s=n==i?r.marks():r.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(i,n,o.text(t,s)),!this.selection.empty&&this.selection.to==i+t.length&&this.setSelection(de.near(this.selection.$to)),this}}setMeta(t,i){return this.meta[typeof t=="string"?t:t.key]=i,this}getMeta(t){return this.meta[typeof t=="string"?t:t.key]}get isGeneric(){for(let t in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=yb,this}get scrolledIntoView(){return(this.updated&yb)>0}};function Sb(e,t){return!t||!e?e:e.bind(t)}var ms=class{constructor(t,i,n){this.name=t,this.init=Sb(i.init,n),this.apply=Sb(i.apply,n)}},Ik=[new ms("doc",{init(e){return e.doc||e.schema.topNodeType.createAndFill()},apply(e){return e.doc}}),new ms("selection",{init(e,t){return e.selection||de.atStart(t.doc)},apply(e){return e.selection}}),new ms("storedMarks",{init(e){return e.storedMarks||null},apply(e,t,i,n){return n.selection.$cursor?e.storedMarks:null}}),new ms("scrollToSelection",{init(){return 0},apply(e,t){return e.scrolledIntoView?t+1:t}})],qa=class{constructor(t,i){this.schema=t,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=Ik.slice(),i&&i.forEach(n=>{if(this.pluginsByKey[n.key])throw new RangeError("Adding different instances of a keyed plugin ("+n.key+")");this.plugins.push(n),this.pluginsByKey[n.key]=n,n.spec.state&&this.fields.push(new ms(n.key,n.spec.state,n))})}},oc=class e{constructor(t){this.config=t}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(t){return this.applyTransaction(t).state}filterTransaction(t,i=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=i){let o=this.config.plugins[n];if(o.spec.filterTransaction&&!o.spec.filterTransaction.call(o,t,this))return!1}return!0}applyTransaction(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};let i=[t],n=this.applyInner(t),o=null;for(;;){let s=!1;for(let r=0;r<this.config.plugins.length;r++){let a=this.config.plugins[r];if(a.spec.appendTransaction){let l=o?o[r].n:0,d=o?o[r].state:this,c=l<i.length&&a.spec.appendTransaction.call(a,l?i.slice(l):i,d,n);if(c&&n.filterTransaction(c,r)){if(c.setMeta("appendedTransaction",t),!o){o=[];for(let u=0;u<this.config.plugins.length;u++)o.push(u<r?{state:n,n:i.length}:{state:this,n:0})}i.push(c),n=n.applyInner(c),s=!0}o&&(o[r]={state:n,n:i.length})}}if(!s)return{state:n,transactions:i}}}applyInner(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let i=new e(this.config),n=this.config.fields;for(let o=0;o<n.length;o++){let s=n[o];i[s.name]=s.apply(t,this[s.name],this,i)}return i}get tr(){return new Ag(this)}static create(t){let i=new qa(t.doc?t.doc.type.schema:t.schema,t.plugins),n=new e(i);for(let o=0;o<i.fields.length;o++)n[i.fields[o].name]=i.fields[o].init(t,n);return n}reconfigure(t){let i=new qa(this.schema,t.plugins),n=i.fields,o=new e(i);for(let s=0;s<n.length;s++){let r=n[s].name;o[r]=this.hasOwnProperty(r)?this[r]:n[s].init(t,o)}return o}toJSON(t){let i={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(i.storedMarks=this.storedMarks.map(n=>n.toJSON())),t&&typeof t=="object")for(let n in t){if(n=="doc"||n=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let o=t[n],s=o.spec.state;s&&s.toJSON&&(i[n]=s.toJSON.call(o,this[o.key]))}return i}static fromJSON(t,i,n){if(!i)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");let o=new qa(t.schema,t.plugins),s=new e(o);return o.fields.forEach(r=>{if(r.name=="doc")s.doc=li.fromJSON(t.schema,i.doc);else if(r.name=="selection")s.selection=de.fromJSON(s.doc,i.selection);else if(r.name=="storedMarks")i.storedMarks&&(s.storedMarks=i.storedMarks.map(t.schema.markFromJSON));else{if(n)for(let a in n){let l=n[a],d=l.spec.state;if(l.key==r.name&&d&&d.fromJSON&&Object.prototype.hasOwnProperty.call(i,a)){s[r.name]=d.fromJSON.call(l,t,i[a],s);return}}s[r.name]=r.init(t,s)}}),s}};function xb(e,t,i){for(let n in e){let o=e[n];o instanceof Function?o=o.bind(t):n=="handleDOMEvents"&&(o=xb(o,t,{})),i[n]=o}return i}var he=class{constructor(t){this.spec=t,this.props={},t.props&&xb(t.props,this,this.props),this.key=t.key?t.key.key:Eb("plugin")}getState(t){return t[this.key]}},Fg=Object.create(null);function Eb(e){return e in Fg?e+"$"+ ++Fg[e]:(Fg[e]=0,e+"$")}var ve=class{constructor(t="key"){this.key=Eb(t)}get(t){return t.config.pluginsByKey[this.key]}getState(t){return t[this.key]}};var sc=(e,t)=>e.selection.empty?!1:(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function Pb(e,t){let{$cursor:i}=e.selection;return!i||(t?!t.endOfTextblock("backward",e):i.parentOffset>0)?null:i}var Lg=(e,t,i)=>{let n=Pb(e,i);if(!n)return!1;let o=Og(n);if(!o){let r=n.blockRange(),a=r&&Ln(r);return a==null?!1:(t&&t(e.tr.lift(r,a).scrollIntoView()),!0)}let s=o.nodeBefore;if(_b(e,o,t,-1))return!0;if(n.parent.content.size==0&&(Sr(s,"end")||J.isSelectable(s)))for(let r=n.depth;;r--){let a=Ua(e.doc,n.before(r),n.after(r),K.empty);if(a&&a.slice.size<a.to-a.from){if(t){let l=e.tr.step(a);l.setSelection(Sr(s,"end")?de.findFrom(l.doc.resolve(l.mapping.map(o.pos,-1)),-1):J.create(l.doc,o.pos-s.nodeSize)),t(l.scrollIntoView())}return!0}if(r==1||n.node(r-1).childCount>1)break}return s.isAtom&&o.depth==n.depth-1?(t&&t(e.tr.delete(o.pos-s.nodeSize,o.pos).scrollIntoView()),!0):!1},Mb=(e,t,i)=>{let n=Pb(e,i);if(!n)return!1;let o=Og(n);return o?Db(e,o,t):!1},kb=(e,t,i)=>{let n=Fb(e,i);if(!n)return!1;let o=Hg(n);return o?Db(e,o,t):!1};function Db(e,t,i){let n=t.nodeBefore,o=n,s=t.pos-1;for(;!o.isTextblock;s--){if(o.type.spec.isolating)return!1;let c=o.lastChild;if(!c)return!1;o=c}let r=t.nodeAfter,a=r,l=t.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let c=a.firstChild;if(!c)return!1;a=c}let d=Ua(e.doc,s,l,K.empty);if(!d||d.from!=s||d instanceof zt&&d.slice.size>=l-s)return!1;if(i){let c=e.tr.step(d);c.setSelection(ne.create(c.doc,s)),i(c.scrollIntoView())}return!0}function Sr(e,t,i=!1){for(let n=e;n;n=t=="start"?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(i&&n.childCount!=1)return!1}return!1}var _g=(e,t,i)=>{let{$head:n,empty:o}=e.selection,s=n;if(!o)return!1;if(n.parent.isTextblock){if(i?!i.endOfTextblock("backward",e):n.parentOffset>0)return!1;s=Og(n)}let r=s&&s.nodeBefore;return!r||!J.isSelectable(r)?!1:(t&&t(e.tr.setSelection(J.create(e.doc,s.pos-r.nodeSize)).scrollIntoView()),!0)};function Og(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function Fb(e,t){let{$cursor:i}=e.selection;return!i||(t?!t.endOfTextblock("forward",e):i.parentOffset<i.parent.content.size)?null:i}var Ng=(e,t,i)=>{let n=Fb(e,i);if(!n)return!1;let o=Hg(n);if(!o)return!1;let s=o.nodeAfter;if(_b(e,o,t,1))return!0;if(n.parent.content.size==0&&(Sr(s,"start")||J.isSelectable(s))){let r=Ua(e.doc,n.before(),n.after(),K.empty);if(r&&r.slice.size<r.to-r.from){if(t){let a=e.tr.step(r);a.setSelection(Sr(s,"start")?de.findFrom(a.doc.resolve(a.mapping.map(o.pos)),1):J.create(a.doc,a.mapping.map(o.pos))),t(a.scrollIntoView())}return!0}}return s.isAtom&&o.depth==n.depth-1?(t&&t(e.tr.delete(o.pos,o.pos+s.nodeSize).scrollIntoView()),!0):!1},Bg=(e,t,i)=>{let{$head:n,empty:o}=e.selection,s=n;if(!o)return!1;if(n.parent.isTextblock){if(i?!i.endOfTextblock("forward",e):n.parentOffset<n.parent.content.size)return!1;s=Hg(n)}let r=s&&s.nodeAfter;return!r||!J.isSelectable(r)?!1:(t&&t(e.tr.setSelection(J.create(e.doc,s.pos)).scrollIntoView()),!0)};function Hg(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let i=e.node(t);if(e.index(t)+1<i.childCount)return e.doc.resolve(e.after(t+1));if(i.type.spec.isolating)break}return null}var Tb=(e,t)=>{let i=e.selection,n=i instanceof J,o;if(n){if(i.node.isTextblock||!Ei(e.doc,i.from))return!1;o=i.from}else if(o=fs(e.doc,i.from,-1),o==null)return!1;if(t){let s=e.tr.join(o);n&&s.setSelection(J.create(s.doc,o-e.doc.resolve(o).nodeBefore.nodeSize)),t(s.scrollIntoView())}return!0},Ab=(e,t)=>{let i=e.selection,n;if(i instanceof J){if(i.node.isTextblock||!Ei(e.doc,i.to))return!1;n=i.to}else if(n=fs(e.doc,i.to,1),n==null)return!1;return t&&t(e.tr.join(n).scrollIntoView()),!0},Ib=(e,t)=>{let{$from:i,$to:n}=e.selection,o=i.blockRange(n),s=o&&Ln(o);return s==null?!1:(t&&t(e.tr.lift(o,s).scrollIntoView()),!0)},Gg=(e,t)=>{let{$head:i,$anchor:n}=e.selection;return!i.parent.type.spec.code||!i.sameParent(n)?!1:(t&&t(e.tr.insertText(`
`).scrollIntoView()),!0)};function Vg(e){for(let t=0;t<e.edgeCount;t++){let{type:i}=e.edge(t);if(i.isTextblock&&!i.hasRequiredAttrs())return i}return null}var zg=(e,t)=>{let{$head:i,$anchor:n}=e.selection;if(!i.parent.type.spec.code||!i.sameParent(n))return!1;let o=i.node(-1),s=i.indexAfter(-1),r=Vg(o.contentMatchAt(s));if(!r||!o.canReplaceWith(s,s,r))return!1;if(t){let a=i.after(),l=e.tr.replaceWith(a,a,r.createAndFill());l.setSelection(de.near(l.doc.resolve(a),1)),t(l.scrollIntoView())}return!0},Wg=(e,t)=>{let i=e.selection,{$from:n,$to:o}=i;if(i instanceof Zt||n.parent.inlineContent||o.parent.inlineContent)return!1;let s=Vg(o.parent.contentMatchAt(o.indexAfter()));if(!s||!s.isTextblock)return!1;if(t){let r=(!n.parentOffset&&o.index()<o.parent.childCount?n:o).pos,a=e.tr.insert(r,s.createAndFill());a.setSelection(ne.create(a.doc,r+1)),t(a.scrollIntoView())}return!0},Ug=(e,t)=>{let{$cursor:i}=e.selection;if(!i||i.parent.content.size)return!1;if(i.depth>1&&i.after()!=i.end(-1)){let s=i.before();if(fi(e.doc,s))return t&&t(e.tr.split(s).scrollIntoView()),!0}let n=i.blockRange(),o=n&&Ln(n);return o==null?!1:(t&&t(e.tr.lift(n,o).scrollIntoView()),!0)};function Lk(e){return(t,i)=>{let{$from:n,$to:o}=t.selection;if(t.selection instanceof J&&t.selection.node.isBlock)return!n.parentOffset||!fi(t.doc,n.pos)?!1:(i&&i(t.tr.split(n.pos).scrollIntoView()),!0);if(!n.depth)return!1;let s=[],r,a,l=!1,d=!1;for(let p=n.depth;;p--)if(n.node(p).isBlock){l=n.end(p)==n.pos+(n.depth-p),d=n.start(p)==n.pos-(n.depth-p),a=Vg(n.node(p-1).contentMatchAt(n.indexAfter(p-1)));let f=e&&e(o.parent,l,n);s.unshift(f||(l&&a?{type:a}:null)),r=p;break}else{if(p==1)return!1;s.unshift(null)}let c=t.tr;(t.selection instanceof ne||t.selection instanceof Zt)&&c.deleteSelection();let u=c.mapping.map(n.pos),h=fi(c.doc,u,s.length,s);if(h||(s[0]=a?{type:a}:null,h=fi(c.doc,u,s.length,s)),!h)return!1;if(c.split(u,s.length,s),!l&&d&&n.node(r).type!=a){let p=c.mapping.map(n.before(r)),g=c.doc.resolve(p);a&&n.node(r-1).canReplaceWith(g.index(),g.index()+1,a)&&c.setNodeMarkup(c.mapping.map(n.before(r)),a)}return i&&i(c.scrollIntoView()),!0}}var _k=Lk();var Lb=(e,t)=>{let{$from:i,to:n}=e.selection,o,s=i.sharedDepth(n);return s==0?!1:(o=i.before(s),t&&t(e.tr.setSelection(J.create(e.doc,o))),!0)},Ok=(e,t)=>(t&&t(e.tr.setSelection(new Zt(e.doc))),!0);function Nk(e,t,i){let n=t.nodeBefore,o=t.nodeAfter,s=t.index();return!n||!o||!n.type.compatibleContent(o.type)?!1:!n.content.size&&t.parent.canReplace(s-1,s)?(i&&i(e.tr.delete(t.pos-n.nodeSize,t.pos).scrollIntoView()),!0):!t.parent.canReplace(s,s+1)||!(o.isTextblock||Ei(e.doc,t.pos))?!1:(i&&i(e.tr.join(t.pos).scrollIntoView()),!0)}function _b(e,t,i,n){let o=t.nodeBefore,s=t.nodeAfter,r,a,l=o.type.spec.isolating||s.type.spec.isolating;if(!l&&Nk(e,t,i))return!0;let d=!l&&t.parent.canReplace(t.index(),t.index()+1);if(d&&(r=(a=o.contentMatchAt(o.childCount)).findWrapping(s.type))&&a.matchType(r[0]||s.type).validEnd){if(i){let p=t.pos+s.nodeSize,g=N.empty;for(let C=r.length-1;C>=0;C--)g=N.from(r[C].create(null,g));g=N.from(o.copy(g));let f=e.tr.step(new mt(t.pos-1,p,t.pos,p,new K(g,1,0),r.length,!0)),m=f.doc.resolve(p+2*r.length);m.nodeAfter&&m.nodeAfter.type==o.type&&Ei(f.doc,m.pos)&&f.join(m.pos),i(f.scrollIntoView())}return!0}let c=s.type.spec.isolating||n>0&&l?null:de.findFrom(t,1),u=c&&c.$from.blockRange(c.$to),h=u&&Ln(u);if(h!=null&&h>=t.depth)return i&&i(e.tr.lift(u,h).scrollIntoView()),!0;if(d&&Sr(s,"start",!0)&&Sr(o,"end")){let p=o,g=[];for(;g.push(p),!p.isTextblock;)p=p.lastChild;let f=s,m=1;for(;!f.isTextblock;f=f.firstChild)m++;if(p.canReplace(p.childCount,p.childCount,f.content)){if(i){let C=N.empty;for(let w=g.length-1;w>=0;w--)C=N.from(g[w].copy(C));let v=e.tr.step(new mt(t.pos-g.length,t.pos+s.nodeSize,t.pos+m,t.pos+s.nodeSize-m,new K(C,g.length,0),0,!0));i(v.scrollIntoView())}return!0}}return!1}function Ob(e){return function(t,i){let n=t.selection,o=e<0?n.$from:n.$to,s=o.depth;for(;o.node(s).isInline;){if(!s)return!1;s--}return o.node(s).isTextblock?(i&&i(t.tr.setSelection(ne.create(t.doc,e<0?o.start(s):o.end(s)))),!0):!1}}var qg=Ob(-1),$g=Ob(1);function Nb(e,t=null){return function(i,n){let{$from:o,$to:s}=i.selection,r=o.blockRange(s),a=r&&br(r,e,t);return a?(n&&n(i.tr.wrap(r,a).scrollIntoView()),!0):!1}}function jg(e,t=null){return function(i,n){let o=!1;for(let s=0;s<i.selection.ranges.length&&!o;s++){let{$from:{pos:r},$to:{pos:a}}=i.selection.ranges[s];i.doc.nodesBetween(r,a,(l,d)=>{if(o)return!1;if(!(!l.isTextblock||l.hasMarkup(e,t)))if(l.type==e)o=!0;else{let c=i.doc.resolve(d),u=c.index();o=c.parent.canReplaceWith(u,u+1,e)}})}if(!o)return!1;if(n){let s=i.tr;for(let r=0;r<i.selection.ranges.length;r++){let{$from:{pos:a},$to:{pos:l}}=i.selection.ranges[r];s.setBlockType(a,l,e,t)}n(s.scrollIntoView())}return!0}}function Kg(...e){return function(t,i,n){for(let o=0;o<e.length;o++)if(e[o](t,i,n))return!0;return!1}}var Ig=Kg(sc,Lg,_g),Rb=Kg(sc,Ng,Bg),yo={Enter:Kg(Gg,Wg,Ug,_k),"Mod-Enter":zg,Backspace:Ig,"Mod-Backspace":Ig,"Shift-Backspace":Ig,Delete:Rb,"Mod-Delete":Rb,"Mod-a":Ok},Bk={"Ctrl-h":yo.Backspace,"Alt-Backspace":yo["Mod-Backspace"],"Ctrl-d":yo.Delete,"Ctrl-Alt-Backspace":yo["Mod-Delete"],"Alt-Delete":yo["Mod-Delete"],"Alt-d":yo["Mod-Delete"],"Ctrl-a":qg,"Ctrl-e":$g};for(let e in yo)Bk[e]=yo[e];var Jne=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform?os.platform()=="darwin":!1;function Bb(e,t=null){return function(i,n){let{$from:o,$to:s}=i.selection,r=o.blockRange(s);if(!r)return!1;let a=n?i.tr:null;return Hk(a,r,e,t)?(n&&n(a.scrollIntoView()),!0):!1}}function Hk(e,t,i,n=null){let o=!1,s=t,r=t.$from.doc;if(t.depth>=2&&t.$from.node(t.depth-1).type.compatibleContent(i)&&t.startIndex==0){if(t.$from.index(t.depth-1)==0)return!1;let l=r.resolve(t.start-2);s=new ps(l,l,t.depth),t.endIndex<t.parent.childCount&&(t=new ps(t.$from,r.resolve(t.$to.end(t.depth)),t.depth)),o=!0}let a=br(s,i,n,t);return a?(e&&Gk(e,t,a,o,i),!0):!1}function Gk(e,t,i,n,o){let s=N.empty;for(let c=i.length-1;c>=0;c--)s=N.from(i[c].type.create(i[c].attrs,s));e.step(new mt(t.start-(n?2:0),t.end,t.start,t.end,new K(s,0,0),i.length,!0));let r=0;for(let c=0;c<i.length;c++)i[c].type==o&&(r=c+1);let a=i.length-r,l=t.start+i.length-(n?2:0),d=t.parent;for(let c=t.startIndex,u=t.endIndex,h=!0;c<u;c++,h=!1)!h&&fi(e.doc,l,a)&&(e.split(l,a),l+=2*a),l+=d.child(c).nodeSize;return e}function Hb(e){return function(t,i){let{$from:n,$to:o}=t.selection,s=n.blockRange(o,r=>r.childCount>0&&r.firstChild.type==e);return s?i?n.node(s.depth-1).type==e?Vk(t,i,e,s):zk(t,i,s):!0:!1}}function Vk(e,t,i,n){let o=e.tr,s=n.end,r=n.$to.end(n.depth);s<r&&(o.step(new mt(s-1,r,s,r,new K(N.from(i.create(null,n.parent.copy())),1,0),1,!0)),n=new ps(o.doc.resolve(n.$from.pos),o.doc.resolve(r),n.depth));let a=Ln(n);if(a==null)return!1;o.lift(n,a);let l=o.doc.resolve(o.mapping.map(s,-1)-1);return Ei(o.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&o.join(l.pos),t(o.scrollIntoView()),!0}function zk(e,t,i){let n=e.tr,o=i.parent;for(let p=i.end,g=i.endIndex-1,f=i.startIndex;g>f;g--)p-=o.child(g).nodeSize,n.delete(p-1,p+1);let s=n.doc.resolve(i.start),r=s.nodeAfter;if(n.mapping.map(i.end)!=i.start+s.nodeAfter.nodeSize)return!1;let a=i.startIndex==0,l=i.endIndex==o.childCount,d=s.node(-1),c=s.index(-1);if(!d.canReplace(c+(a?0:1),c+1,r.content.append(l?N.empty:N.from(o))))return!1;let u=s.pos,h=u+r.nodeSize;return n.step(new mt(u-(a?1:0),h+(l?1:0),u+1,h-1,new K((a?N.empty:N.from(o.copy(N.empty))).append(l?N.empty:N.from(o.copy(N.empty))),a?0:1,l?0:1),a?0:1)),t(n.scrollIntoView()),!0}function Gb(e){return function(t,i){let{$from:n,$to:o}=t.selection,s=n.blockRange(o,d=>d.childCount>0&&d.firstChild.type==e);if(!s)return!1;let r=s.startIndex;if(r==0)return!1;let a=s.parent,l=a.child(r-1);if(l.type!=e)return!1;if(i){let d=l.lastChild&&l.lastChild.type==a.type,c=N.from(d?e.create():null),u=new K(N.from(e.create(null,N.from(a.type.create(null,c)))),d?3:1,0),h=s.start,p=s.end;i(t.tr.step(new mt(h-(d?3:1),p,h,p,u,1,!0)).scrollIntoView())}return!0}}var At=function(e){for(var t=0;;t++)if(e=e.previousSibling,!e)return t},Mr=function(e){let t=e.assignedSlot||e.parentNode;return t&&t.nodeType==11?t.host:t},ef=null,On=function(e,t,i){let n=ef||(ef=document.createRange());return n.setEnd(e,i??e.nodeValue.length),n.setStart(e,t||0),n},Wk=function(){ef=null},xs=function(e,t,i,n){return i&&(Vb(e,t,i,n,-1)||Vb(e,t,i,n,1))},Uk=/^(img|br|input|textarea|hr)$/i;function Vb(e,t,i,n,o){for(var s;;){if(e==i&&t==n)return!0;if(t==(o<0?0:Pi(e))){let r=e.parentNode;if(!r||r.nodeType!=1||Za(e)||Uk.test(e.nodeName)||e.contentEditable=="false")return!1;t=At(e)+(o<0?0:1),e=r}else if(e.nodeType==1){let r=e.childNodes[t+(o<0?-1:0)];if(r.nodeType==1&&r.contentEditable=="false")if(!((s=r.pmViewDesc)===null||s===void 0)&&s.ignoreForSelection)t+=o;else return!1;else e=r,t=o<0?Pi(e):0}else return!1}}function Pi(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function qk(e,t){for(;;){if(e.nodeType==3&&t)return e;if(e.nodeType==1&&t>0){if(e.contentEditable=="false")return null;e=e.childNodes[t-1],t=Pi(e)}else if(e.parentNode&&!Za(e))t=At(e),e=e.parentNode;else return null}}function $k(e,t){for(;;){if(e.nodeType==3&&t<e.nodeValue.length)return e;if(e.nodeType==1&&t<e.childNodes.length){if(e.contentEditable=="false")return null;e=e.childNodes[t],t=0}else if(e.parentNode&&!Za(e))t=At(e)+1,e=e.parentNode;else return null}}function jk(e,t,i){for(let n=t==0,o=t==Pi(e);n||o;){if(e==i)return!0;let s=At(e);if(e=e.parentNode,!e)return!1;n=n&&s==0,o=o&&s==Pi(e)}}function Za(e){let t;for(let i=e;i&&!(t=i.pmViewDesc);i=i.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}var mc=function(e){return e.focusNode&&xs(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function Cs(e,t){let i=document.createEvent("Event");return i.initEvent("keydown",!0,!0),i.keyCode=e,i.key=i.code=t,i}function Kk(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}function Yk(e,t,i){if(e.caretPositionFromPoint)try{let n=e.caretPositionFromPoint(t,i);if(n)return{node:n.offsetNode,offset:Math.min(Pi(n.offsetNode),n.offset)}}catch{}if(e.caretRangeFromPoint){let n=e.caretRangeFromPoint(t,i);if(n)return{node:n.startContainer,offset:Math.min(Pi(n.startContainer),n.startOffset)}}}var tn=typeof navigator<"u"?navigator:null,zb=typeof document<"u"?document:null,Mo=tn&&tn.userAgent||"",tf=/Edge\/(\d+)/.exec(Mo),by=/MSIE \d/.exec(Mo),nf=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Mo),di=!!(by||nf||tf),Ro=by?document.documentMode:nf?+nf[1]:tf?+tf[1]:0,Mi=!di&&/gecko\/(\d+)/i.test(Mo);Mi&&+(/Firefox\/(\d+)/.exec(Mo)||[0,0])[1];var of=!di&&/Chrome\/(\d+)/.exec(Mo),Ut=!!of,yy=of?+of[1]:0,ei=!di&&!!tn&&/Apple Computer/.test(tn.vendor),kr=ei&&(/Mobile\/\w+/.test(Mo)||!!tn&&tn.maxTouchPoints>2),Ri=kr||(tn?/Mac/.test(tn.platform):!1),Xk=tn?/Win/.test(tn.platform):!1,Nn=/Android \d/.test(Mo),el=!!zb&&"webkitFontSmoothing"in zb.documentElement.style,Jk=el?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function Qk(e){let t=e.defaultView&&e.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function _n(e,t){return typeof e=="number"?e:e[t]}function Zk(e){let t=e.getBoundingClientRect(),i=t.width/e.offsetWidth||1,n=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*i,top:t.top,bottom:t.top+e.clientHeight*n}}function Wb(e,t,i){let n=e.someProp("scrollThreshold")||0,o=e.someProp("scrollMargin")||5,s=e.dom.ownerDocument;for(let r=i||e.dom;r;){if(r.nodeType!=1){r=Mr(r);continue}let a=r,l=a==s.body,d=l?Qk(s):Zk(a),c=0,u=0;if(t.top<d.top+_n(n,"top")?u=-(d.top-t.top+_n(o,"top")):t.bottom>d.bottom-_n(n,"bottom")&&(u=t.bottom-t.top>d.bottom-d.top?t.top+_n(o,"top")-d.top:t.bottom-d.bottom+_n(o,"bottom")),t.left<d.left+_n(n,"left")?c=-(d.left-t.left+_n(o,"left")):t.right>d.right-_n(n,"right")&&(c=t.right-d.right+_n(o,"right")),c||u)if(l)s.defaultView.scrollBy(c,u);else{let p=a.scrollLeft,g=a.scrollTop;u&&(a.scrollTop+=u),c&&(a.scrollLeft+=c);let f=a.scrollLeft-p,m=a.scrollTop-g;t={left:t.left-f,top:t.top-m,right:t.right-f,bottom:t.bottom-m}}let h=l?"fixed":getComputedStyle(r).position;if(/^(fixed|sticky)$/.test(h))break;r=h=="absolute"?r.offsetParent:Mr(r)}}function eD(e){let t=e.dom.getBoundingClientRect(),i=Math.max(0,t.top),n,o;for(let s=(t.left+t.right)/2,r=i+1;r<Math.min(innerHeight,t.bottom);r+=5){let a=e.root.elementFromPoint(s,r);if(!a||a==e.dom||!e.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=i-20){n=a,o=l.top;break}}return{refDOM:n,refTop:o,stack:Sy(e.dom)}}function Sy(e){let t=[],i=e.ownerDocument;for(let n=e;n&&(t.push({dom:n,top:n.scrollTop,left:n.scrollLeft}),e!=i);n=Mr(n));return t}function tD({refDOM:e,refTop:t,stack:i}){let n=e?e.getBoundingClientRect().top:0;xy(i,n==0?0:n-t)}function xy(e,t){for(let i=0;i<e.length;i++){let{dom:n,top:o,left:s}=e[i];n.scrollTop!=o+t&&(n.scrollTop=o+t),n.scrollLeft!=s&&(n.scrollLeft=s)}}var xr=null;function iD(e){if(e.setActive)return e.setActive();if(xr)return e.focus(xr);let t=Sy(e);e.focus(xr==null?{get preventScroll(){return xr={preventScroll:!0},!0}}:void 0),xr||(xr=!1,xy(t,0))}function Ey(e,t){let i,n=2e8,o,s=0,r=t.top,a=t.top,l,d;for(let c=e.firstChild,u=0;c;c=c.nextSibling,u++){let h;if(c.nodeType==1)h=c.getClientRects();else if(c.nodeType==3)h=On(c).getClientRects();else continue;for(let p=0;p<h.length;p++){let g=h[p];if(g.top<=r&&g.bottom>=a){r=Math.max(g.bottom,r),a=Math.min(g.top,a);let f=g.left>t.left?g.left-t.left:g.right<t.left?t.left-g.right:0;if(f<n){i=c,n=f,o=f&&i.nodeType==3?{left:g.right<t.left?g.right:g.left,top:t.top}:t,c.nodeType==1&&f&&(s=u+(t.left>=(g.left+g.right)/2?1:0));continue}}else g.top>t.top&&!l&&g.left<=t.left&&g.right>=t.left&&(l=c,d={left:Math.max(g.left,Math.min(g.right,t.left)),top:g.top});!i&&(t.left>=g.right&&t.top>=g.top||t.left>=g.left&&t.top>=g.bottom)&&(s=u+1)}}return!i&&l&&(i=l,o=d,n=0),i&&i.nodeType==3?nD(i,o):!i||n&&i.nodeType==1?{node:e,offset:s}:Ey(i,o)}function nD(e,t){let i=e.nodeValue.length,n=document.createRange();for(let o=0;o<i;o++){n.setEnd(e,o+1),n.setStart(e,o);let s=So(n,1);if(s.top!=s.bottom&&wf(t,s))return{node:e,offset:o+(t.left>=(s.left+s.right)/2?1:0)}}return{node:e,offset:0}}function wf(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function oD(e,t){let i=e.parentNode;return i&&/^li$/i.test(i.nodeName)&&t.left<e.getBoundingClientRect().left?i:e}function sD(e,t,i){let{node:n,offset:o}=Ey(t,i),s=-1;if(n.nodeType==1&&!n.firstChild){let r=n.getBoundingClientRect();s=r.left!=r.right&&i.left>(r.left+r.right)/2?1:-1}return e.docView.posFromDOM(n,o,s)}function rD(e,t,i,n){let o=-1;for(let s=t,r=!1;s!=e.dom;){let a=e.docView.nearestDesc(s,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(a.dom.nodeName)&&(!r&&l.left>n.left||l.top>n.top?o=a.posBefore:(!r&&l.right<n.left||l.bottom<n.top)&&(o=a.posAfter),r=!0),!a.contentDOM&&o<0&&!a.node.isText))return(a.node.isBlock?n.top<(l.top+l.bottom)/2:n.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;s=a.dom.parentNode}return o>-1?o:e.docView.posFromDOM(t,i,-1)}function Ry(e,t,i){let n=e.childNodes.length;if(n&&i.top<i.bottom)for(let o=Math.max(0,Math.min(n-1,Math.floor(n*(t.top-i.top)/(i.bottom-i.top))-2)),s=o;;){let r=e.childNodes[s];if(r.nodeType==1){let a=r.getClientRects();for(let l=0;l<a.length;l++){let d=a[l];if(wf(t,d))return Ry(r,t,d)}}if((s=(s+1)%n)==o)break}return e}function aD(e,t){let i=e.dom.ownerDocument,n,o=0,s=Yk(i,t.left,t.top);s&&({node:n,offset:o}=s);let r=(e.root.elementFromPoint?e.root:i).elementFromPoint(t.left,t.top),a;if(!r||!e.dom.contains(r.nodeType!=1?r.parentNode:r)){let d=e.dom.getBoundingClientRect();if(!wf(t,d)||(r=Ry(e.dom,t,d),!r))return null}if(ei)for(let d=r;n&&d;d=Mr(d))d.draggable&&(n=void 0);if(r=oD(r,t),n){if(Mi&&n.nodeType==1&&(o=Math.min(o,n.childNodes.length),o<n.childNodes.length)){let c=n.childNodes[o],u;c.nodeName=="IMG"&&(u=c.getBoundingClientRect()).right<=t.left&&u.bottom>t.top&&o++}let d;el&&o&&n.nodeType==1&&(d=n.childNodes[o-1]).nodeType==1&&d.contentEditable=="false"&&d.getBoundingClientRect().top>=t.top&&o--,n==e.dom&&o==n.childNodes.length-1&&n.lastChild.nodeType==1&&t.top>n.lastChild.getBoundingClientRect().bottom?a=e.state.doc.content.size:(o==0||n.nodeType!=1||n.childNodes[o-1].nodeName!="BR")&&(a=rD(e,n,o,t))}a==null&&(a=sD(e,r,t));let l=e.docView.nearestDesc(r,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function Ub(e){return e.top<e.bottom||e.left<e.right}function So(e,t){let i=e.getClientRects();if(i.length){let n=i[t<0?0:i.length-1];if(Ub(n))return n}return Array.prototype.find.call(i,Ub)||e.getBoundingClientRect()}var lD=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Py(e,t,i){let{node:n,offset:o,atom:s}=e.docView.domFromPos(t,i<0?-1:1),r=el||Mi;if(n.nodeType==3)if(r&&(lD.test(n.nodeValue)||(i<0?!o:o==n.nodeValue.length))){let l=So(On(n,o,o),i);if(Mi&&o&&/\s/.test(n.nodeValue[o-1])&&o<n.nodeValue.length){let d=So(On(n,o-1,o-1),-1);if(d.top==l.top){let c=So(On(n,o,o+1),-1);if(c.top!=l.top)return $a(c,c.left<d.left)}}return l}else{let l=o,d=o,c=i<0?1:-1;return i<0&&!o?(d++,c=-1):i>=0&&o==n.nodeValue.length?(l--,c=1):i<0?l--:d++,$a(So(On(n,l,d),c),c<0)}if(!e.state.doc.resolve(t-(s||0)).parent.inlineContent){if(s==null&&o&&(i<0||o==Pi(n))){let l=n.childNodes[o-1];if(l.nodeType==1)return Yg(l.getBoundingClientRect(),!1)}if(s==null&&o<Pi(n)){let l=n.childNodes[o];if(l.nodeType==1)return Yg(l.getBoundingClientRect(),!0)}return Yg(n.getBoundingClientRect(),i>=0)}if(s==null&&o&&(i<0||o==Pi(n))){let l=n.childNodes[o-1],d=l.nodeType==3?On(l,Pi(l)-(r?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(d)return $a(So(d,1),!1)}if(s==null&&o<Pi(n)){let l=n.childNodes[o];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let d=l?l.nodeType==3?On(l,0,r?0:1):l.nodeType==1?l:null:null;if(d)return $a(So(d,-1),!0)}return $a(So(n.nodeType==3?On(n):n,-i),i>=0)}function $a(e,t){if(e.width==0)return e;let i=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:i,right:i}}function Yg(e,t){if(e.height==0)return e;let i=t?e.top:e.bottom;return{top:i,bottom:i,left:e.left,right:e.right}}function My(e,t,i){let n=e.state,o=e.root.activeElement;n!=t&&e.updateState(t),o!=e.dom&&e.focus();try{return i()}finally{n!=t&&e.updateState(n),o!=e.dom&&o&&o.focus()}}function dD(e,t,i){let n=t.selection,o=i=="up"?n.$from:n.$to;return My(e,t,()=>{let{node:s}=e.docView.domFromPos(o.pos,i=="up"?-1:1);for(;;){let a=e.docView.nearestDesc(s,!0);if(!a)break;if(a.node.isBlock){s=a.contentDOM||a.dom;break}s=a.dom.parentNode}let r=Py(e,o.pos,1);for(let a=s.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=On(a,0,a.nodeValue.length).getClientRects();else continue;for(let d=0;d<l.length;d++){let c=l[d];if(c.bottom>c.top+1&&(i=="up"?r.top-c.top>(c.bottom-r.top)*2:c.bottom-r.bottom>(r.bottom-c.top)*2))return!1}}return!0})}var cD=/[\u0590-\u08ac]/;function uD(e,t,i){let{$head:n}=t.selection;if(!n.parent.isTextblock)return!1;let o=n.parentOffset,s=!o,r=o==n.parent.content.size,a=e.domSelection();return a?!cD.test(n.parent.textContent)||!a.modify?i=="left"||i=="backward"?s:r:My(e,t,()=>{let{focusNode:l,focusOffset:d,anchorNode:c,anchorOffset:u}=e.domSelectionRange(),h=a.caretBidiLevel;a.modify("move",i,"character");let p=n.depth?e.docView.domAfterPos(n.before()):e.dom,{focusNode:g,focusOffset:f}=e.domSelectionRange(),m=g&&!p.contains(g.nodeType==1?g:g.parentNode)||l==g&&d==f;try{a.collapse(c,u),l&&(l!=c||d!=u)&&a.extend&&a.extend(l,d)}catch{}return h!=null&&(a.caretBidiLevel=h),m}):n.pos==n.start()||n.pos==n.end()}var qb=null,$b=null,jb=!1;function hD(e,t,i){return qb==t&&$b==i?jb:(qb=t,$b=i,jb=i=="up"||i=="down"?dD(e,t,i):uD(e,t,i))}var ki=0,Kb=1,vs=2,nn=3,Es=class{constructor(t,i,n,o){this.parent=t,this.children=i,this.dom=n,this.contentDOM=o,this.dirty=ki,n.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,i,n){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let i=0;i<this.children.length;i++)t+=this.children[i].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let i=0,n=this.posAtStart;;i++){let o=this.children[i];if(o==t)return n;n+=o.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,i,n){if(this.contentDOM&&this.contentDOM.contains(t.nodeType==1?t:t.parentNode))if(n<0){let s,r;if(t==this.contentDOM)s=t.childNodes[i-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;s=t.previousSibling}for(;s&&!((r=s.pmViewDesc)&&r.parent==this);)s=s.previousSibling;return s?this.posBeforeChild(r)+r.size:this.posAtStart}else{let s,r;if(t==this.contentDOM)s=t.childNodes[i];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;s=t.nextSibling}for(;s&&!((r=s.pmViewDesc)&&r.parent==this);)s=s.nextSibling;return s?this.posBeforeChild(r):this.posAtEnd}let o;if(t==this.dom&&this.contentDOM)o=i>At(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))o=t.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(i==0)for(let s=t;;s=s.parentNode){if(s==this.dom){o=!1;break}if(s.previousSibling)break}if(o==null&&i==t.childNodes.length)for(let s=t;;s=s.parentNode){if(s==this.dom){o=!0;break}if(s.nextSibling)break}}return o??n>0?this.posAtEnd:this.posAtStart}nearestDesc(t,i=!1){for(let n=!0,o=t;o;o=o.parentNode){let s=this.getDesc(o),r;if(s&&(!i||s.node))if(n&&(r=s.nodeDOM)&&!(r.nodeType==1?r.contains(t.nodeType==1?t:t.parentNode):r==t))n=!1;else return s}}getDesc(t){let i=t.pmViewDesc;for(let n=i;n;n=n.parent)if(n==this)return i}posFromDOM(t,i,n){for(let o=t;o;o=o.parentNode){let s=this.getDesc(o);if(s)return s.localPosFromDOM(t,i,n)}return-1}descAt(t){for(let i=0,n=0;i<this.children.length;i++){let o=this.children[i],s=n+o.size;if(n==t&&s!=n){for(;!o.border&&o.children.length;)for(let r=0;r<o.children.length;r++){let a=o.children[r];if(a.size){o=a;break}}return o}if(t<s)return o.descAt(t-n-o.border);n=s}}domFromPos(t,i){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let n=0,o=0;for(let s=0;n<this.children.length;n++){let r=this.children[n],a=s+r.size;if(a>t||r instanceof lc){o=t-s;break}s=a}if(o)return this.children[n].domFromPos(o-this.children[n].border,i);for(let s;n&&!(s=this.children[n-1]).size&&s instanceof rc&&s.side>=0;n--);if(i<=0){let s,r=!0;for(;s=n?this.children[n-1]:null,!(!s||s.dom.parentNode==this.contentDOM);n--,r=!1);return s&&i&&r&&!s.border&&!s.domAtom?s.domFromPos(s.size,i):{node:this.contentDOM,offset:s?At(s.dom)+1:0}}else{let s,r=!0;for(;s=n<this.children.length?this.children[n]:null,!(!s||s.dom.parentNode==this.contentDOM);n++,r=!1);return s&&r&&!s.border&&!s.domAtom?s.domFromPos(0,i):{node:this.contentDOM,offset:s?At(s.dom):this.contentDOM.childNodes.length}}}parseRange(t,i,n=0){if(this.children.length==0)return{node:this.contentDOM,from:t,to:i,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let o=-1,s=-1;for(let r=n,a=0;;a++){let l=this.children[a],d=r+l.size;if(o==-1&&t<=d){let c=r+l.border;if(t>=c&&i<=d-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(t,i,c);t=r;for(let u=a;u>0;u--){let h=this.children[u-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){o=At(h.dom)+1;break}t-=h.size}o==-1&&(o=0)}if(o>-1&&(d>i||a==this.children.length-1)){i=d;for(let c=a+1;c<this.children.length;c++){let u=this.children[c];if(u.size&&u.dom.parentNode==this.contentDOM&&!u.emptyChildAt(-1)){s=At(u.dom);break}i+=u.size}s==-1&&(s=this.contentDOM.childNodes.length);break}r=d}return{node:this.contentDOM,from:t,to:i,fromOffset:o,toOffset:s}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let i=this.children[t<0?0:this.children.length-1];return i.size==0||i.emptyChildAt(t)}domAfterPos(t){let{node:i,offset:n}=this.domFromPos(t,0);if(i.nodeType!=1||n==i.childNodes.length)throw new RangeError("No node after pos "+t);return i.childNodes[n]}setSelection(t,i,n,o=!1){let s=Math.min(t,i),r=Math.max(t,i);for(let p=0,g=0;p<this.children.length;p++){let f=this.children[p],m=g+f.size;if(s>g&&r<m)return f.setSelection(t-g-f.border,i-g-f.border,n,o);g=m}let a=this.domFromPos(t,t?-1:1),l=i==t?a:this.domFromPos(i,i?-1:1),d=n.root.getSelection(),c=n.domSelectionRange(),u=!1;if((Mi||ei)&&t==i){let{node:p,offset:g}=a;if(p.nodeType==3){if(u=!!(g&&p.nodeValue[g-1]==`
`),u&&g==p.nodeValue.length)for(let f=p,m;f;f=f.parentNode){if(m=f.nextSibling){m.nodeName=="BR"&&(a=l={node:m.parentNode,offset:At(m)+1});break}let C=f.pmViewDesc;if(C&&C.node&&C.node.isBlock)break}}else{let f=p.childNodes[g-1];u=f&&(f.nodeName=="BR"||f.contentEditable=="false")}}if(Mi&&c.focusNode&&c.focusNode!=l.node&&c.focusNode.nodeType==1){let p=c.focusNode.childNodes[c.focusOffset];p&&p.contentEditable=="false"&&(o=!0)}if(!(o||u&&ei)&&xs(a.node,a.offset,c.anchorNode,c.anchorOffset)&&xs(l.node,l.offset,c.focusNode,c.focusOffset))return;let h=!1;if((d.extend||t==i)&&!(u&&Mi)){d.collapse(a.node,a.offset);try{t!=i&&d.extend(l.node,l.offset),h=!0}catch{}}if(!h){if(t>i){let g=a;a=l,l=g}let p=document.createRange();p.setEnd(l.node,l.offset),p.setStart(a.node,a.offset),d.removeAllRanges(),d.addRange(p)}}ignoreMutation(t){return!this.contentDOM&&t.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,i){for(let n=0,o=0;o<this.children.length;o++){let s=this.children[o],r=n+s.size;if(n==r?t<=r&&i>=n:t<r&&i>n){let a=n+s.border,l=r-s.border;if(t>=a&&i<=l){this.dirty=t==n||i==r?vs:Kb,t==a&&i==l&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=nn:s.markDirty(t-a,i-a);return}else s.dirty=s.dom==s.contentDOM&&s.dom.parentNode==this.contentDOM&&!s.children.length?vs:nn}n=r}this.dirty=vs}markParentsDirty(){let t=1;for(let i=this.parent;i;i=i.parent,t++){let n=t==1?vs:Kb;i.dirty<n&&(i.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(t){return!1}},rc=class extends Es{constructor(t,i,n,o){let s,r=i.type.toDOM;if(typeof r=="function"&&(r=r(n,()=>{if(!s)return o;if(s.parent)return s.parent.posBeforeChild(s)})),!i.type.spec.raw){if(r.nodeType!=1){let a=document.createElement("span");a.appendChild(r),r=a}r.contentEditable="false",r.classList.add("ProseMirror-widget")}super(t,[],r,null),this.widget=i,this.widget=i,s=this}matchesWidget(t){return this.dirty==ki&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let i=this.widget.spec.stopEvent;return i?i(t):!1}ignoreMutation(t){return t.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}},sf=class extends Es{constructor(t,i,n,o){super(t,[],i,null),this.textDOM=n,this.text=o}get size(){return this.text.length}localPosFromDOM(t,i){return t!=this.textDOM?this.posAtStart+(i?this.size:0):this.posAtStart+i}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return t.type==="characterData"&&t.target.nodeValue==t.oldValue}},Dr=class e extends Es{constructor(t,i,n,o,s){super(t,[],n,o),this.mark=i,this.spec=s}static create(t,i,n,o){let s=o.nodeViews[i.type.name],r=s&&s(i,o,n);return(!r||!r.dom)&&(r=Tn.renderSpec(document,i.type.spec.toDOM(i,n),null,i.attrs)),new e(t,i,r.dom,r.contentDOM||r.dom,r)}parseRule(){return this.dirty&nn||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(t){return this.dirty!=nn&&this.mark.eq(t)}markDirty(t,i){if(super.markDirty(t,i),this.dirty!=ki){let n=this.parent;for(;!n.node;)n=n.parent;n.dirty<this.dirty&&(n.dirty=this.dirty),this.dirty=ki}}slice(t,i,n){let o=e.create(this.parent,this.mark,!0,n),s=this.children,r=this.size;i<r&&(s=df(s,i,r,n)),t>0&&(s=df(s,0,t,n));for(let a=0;a<s.length;a++)s[a].parent=o;return o.children=s,o}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}},Po=class e extends Es{constructor(t,i,n,o,s,r,a,l,d){super(t,[],s,r),this.node=i,this.outerDeco=n,this.innerDeco=o,this.nodeDOM=a}static create(t,i,n,o,s,r){let a=s.nodeViews[i.type.name],l,d=a&&a(i,s,()=>{if(!l)return r;if(l.parent)return l.parent.posBeforeChild(l)},n,o),c=d&&d.dom,u=d&&d.contentDOM;if(i.isText){if(!c)c=document.createTextNode(i.text);else if(c.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else c||({dom:c,contentDOM:u}=Tn.renderSpec(document,i.type.spec.toDOM(i),null,i.attrs));!u&&!i.isText&&c.nodeName!="BR"&&(c.hasAttribute("contenteditable")||(c.contentEditable="false"),i.type.spec.draggable&&(c.draggable=!0));let h=c;return c=Fy(c,n,i),d?l=new rf(t,i,n,o,c,u||null,h,d,s,r+1):i.isText?new ac(t,i,n,o,c,h,s):new e(t,i,n,o,c,u||null,h,s,r+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(t.preserveWhitespace="full"),!this.contentDOM)t.getContent=()=>this.node.content;else if(!this.contentLost)t.contentElement=this.contentDOM;else{for(let i=this.children.length-1;i>=0;i--){let n=this.children[i];if(this.dom.contains(n.dom.parentNode)){t.contentElement=n.dom.parentNode;break}}t.contentElement||(t.getContent=()=>N.empty)}return t}matchesNode(t,i,n){return this.dirty==ki&&t.eq(this.node)&&dc(i,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,i){let n=this.node.inlineContent,o=i,s=t.composing?this.localCompositionInfo(t,i):null,r=s&&s.pos>-1?s:null,a=s&&s.pos<0,l=new lf(this,r&&r.node,t);mD(this.node,this.innerDeco,(d,c,u)=>{d.spec.marks?l.syncToMarks(d.spec.marks,n,t):d.type.side>=0&&!u&&l.syncToMarks(c==this.node.childCount?Ve.none:this.node.child(c).marks,n,t),l.placeWidget(d,t,o)},(d,c,u,h)=>{l.syncToMarks(d.marks,n,t);let p;l.findNodeMatch(d,c,u,h)||a&&t.state.selection.from>o&&t.state.selection.to<o+d.nodeSize&&(p=l.findIndexWithChild(s.node))>-1&&l.updateNodeAt(d,c,u,p,t)||l.updateNextNode(d,c,u,t,h,o)||l.addNode(d,c,u,t,o),o+=d.nodeSize}),l.syncToMarks([],n,t),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==vs)&&(r&&this.protectLocalComposition(t,r),ky(this.contentDOM,this.children,t),kr&&CD(this.dom))}localCompositionInfo(t,i){let{from:n,to:o}=t.state.selection;if(!(t.state.selection instanceof ne)||n<i||o>i+this.node.content.size)return null;let s=t.input.compositionNode;if(!s||!this.dom.contains(s.parentNode))return null;if(this.node.inlineContent){let r=s.nodeValue,a=vD(this.node.content,r,n-i,o-i);return a<0?null:{node:s,pos:a,text:r}}else return{node:s,pos:-1,text:""}}protectLocalComposition(t,{node:i,pos:n,text:o}){if(this.getDesc(i))return;let s=i;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let r=new sf(this,s,i,o);t.input.compositionNodes.push(r),this.children=df(this.children,n,n+o.length,t,r)}update(t,i,n,o){return this.dirty==nn||!t.sameMarkup(this.node)?!1:(this.updateInner(t,i,n,o),!0)}updateInner(t,i,n,o){this.updateOuterDeco(i),this.node=t,this.innerDeco=n,this.contentDOM&&this.updateChildren(o,this.posAtStart),this.dirty=ki}updateOuterDeco(t){if(dc(t,this.outerDeco))return;let i=this.nodeDOM.nodeType!=1,n=this.dom;this.dom=Dy(this.dom,this.nodeDOM,af(this.outerDeco,this.node,i),af(t,this.node,i)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}};function Yb(e,t,i,n,o){Fy(n,t,e);let s=new Po(void 0,e,t,i,n,n,n,o,0);return s.contentDOM&&s.updateChildren(o,0),s}var ac=class e extends Po{constructor(t,i,n,o,s,r,a){super(t,i,n,o,s,null,r,a,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,i,n,o){return this.dirty==nn||this.dirty!=ki&&!this.inParent()||!t.sameMarkup(this.node)?!1:(this.updateOuterDeco(i),(this.dirty!=ki||t.text!=this.node.text)&&t.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=t.text,o.trackWrites==this.nodeDOM&&(o.trackWrites=null)),this.node=t,this.dirty=ki,!0)}inParent(){let t=this.parent.contentDOM;for(let i=this.nodeDOM;i;i=i.parentNode)if(i==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,i,n){return t==this.nodeDOM?this.posAtStart+Math.min(i,this.node.text.length):super.localPosFromDOM(t,i,n)}ignoreMutation(t){return t.type!="characterData"&&t.type!="selection"}slice(t,i,n){let o=this.node.cut(t,i),s=document.createTextNode(o.text);return new e(this.parent,o,this.outerDeco,this.innerDeco,s,s,n)}markDirty(t,i){super.markDirty(t,i),this.dom!=this.nodeDOM&&(t==0||i==this.nodeDOM.nodeValue.length)&&(this.dirty=nn)}get domAtom(){return!1}isText(t){return this.node.text==t}},lc=class extends Es{parseRule(){return{ignore:!0}}matchesHack(t){return this.dirty==ki&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}},rf=class extends Po{constructor(t,i,n,o,s,r,a,l,d,c){super(t,i,n,o,s,r,a,d,c),this.spec=l}update(t,i,n,o){if(this.dirty==nn)return!1;if(this.spec.update&&(this.node.type==t.type||this.spec.multiType)){let s=this.spec.update(t,i,n);return s&&this.updateInner(t,i,n,o),s}else return!this.contentDOM&&!t.isLeaf?!1:super.update(t,i,n,o)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,i,n,o){this.spec.setSelection?this.spec.setSelection(t,i,n.root):super.setSelection(t,i,n,o)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return this.spec.stopEvent?this.spec.stopEvent(t):!1}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}};function ky(e,t,i){let n=e.firstChild,o=!1;for(let s=0;s<t.length;s++){let r=t[s],a=r.dom;if(a.parentNode==e){for(;a!=n;)n=Xb(n),o=!0;n=n.nextSibling}else o=!0,e.insertBefore(a,n);if(r instanceof Dr){let l=n?n.previousSibling:e.lastChild;ky(r.contentDOM,r.children,i),n=l?l.nextSibling:e.firstChild}}for(;n;)n=Xb(n),o=!0;o&&i.trackWrites==e&&(i.trackWrites=null)}var ja=function(e){e&&(this.nodeName=e)};ja.prototype=Object.create(null);var ws=[new ja];function af(e,t,i){if(e.length==0)return ws;let n=i?ws[0]:new ja,o=[n];for(let s=0;s<e.length;s++){let r=e[s].type.attrs;if(r){r.nodeName&&o.push(n=new ja(r.nodeName));for(let a in r){let l=r[a];l!=null&&(i&&o.length==1&&o.push(n=new ja(t.isInline?"span":"div")),a=="class"?n.class=(n.class?n.class+" ":"")+l:a=="style"?n.style=(n.style?n.style+";":"")+l:a!="nodeName"&&(n[a]=l))}}}return o}function Dy(e,t,i,n){if(i==ws&&n==ws)return t;let o=t;for(let s=0;s<n.length;s++){let r=n[s],a=i[s];if(s){let l;a&&a.nodeName==r.nodeName&&o!=e&&(l=o.parentNode)&&l.nodeName.toLowerCase()==r.nodeName||(l=document.createElement(r.nodeName),l.pmIsDeco=!0,l.appendChild(o),a=ws[0]),o=l}pD(o,a||ws[0],r)}return o}function pD(e,t,i){for(let n in t)n!="class"&&n!="style"&&n!="nodeName"&&!(n in i)&&e.removeAttribute(n);for(let n in i)n!="class"&&n!="style"&&n!="nodeName"&&i[n]!=t[n]&&e.setAttribute(n,i[n]);if(t.class!=i.class){let n=t.class?t.class.split(" ").filter(Boolean):[],o=i.class?i.class.split(" ").filter(Boolean):[];for(let s=0;s<n.length;s++)o.indexOf(n[s])==-1&&e.classList.remove(n[s]);for(let s=0;s<o.length;s++)n.indexOf(o[s])==-1&&e.classList.add(o[s]);e.classList.length==0&&e.removeAttribute("class")}if(t.style!=i.style){if(t.style){let n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,o;for(;o=n.exec(t.style);)e.style.removeProperty(o[1])}i.style&&(e.style.cssText+=i.style)}}function Fy(e,t,i){return Dy(e,e,ws,af(t,i,e.nodeType!=1))}function dc(e,t){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++)if(!e[i].type.eq(t[i].type))return!1;return!0}function Xb(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}var lf=class{constructor(t,i,n){this.lock=i,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=gD(t.node.content,t)}destroyBetween(t,i){if(t!=i){for(let n=t;n<i;n++)this.top.children[n].destroy();this.top.children.splice(t,i-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,i,n){let o=0,s=this.stack.length>>1,r=Math.min(s,t.length);for(;o<r&&(o==s-1?this.top:this.stack[o+1<<1]).matchesMark(t[o])&&t[o].type.spec.spanning!==!1;)o++;for(;o<s;)this.destroyRest(),this.top.dirty=ki,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<t.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let d=this.top.children[l];if(d.matchesMark(t[s])&&!this.isLocked(d.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=Dr.create(this.top,t[s],i,n);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,s++}}findNodeMatch(t,i,n,o){let s=-1,r;if(o>=this.preMatch.index&&(r=this.preMatch.matches[o-this.preMatch.index]).parent==this.top&&r.matchesNode(t,i,n))s=this.top.children.indexOf(r,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let d=this.top.children[a];if(d.matchesNode(t,i,n)&&!this.preMatch.matched.has(d)){s=a;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(t,i,n,o,s){let r=this.top.children[o];return r.dirty==nn&&r.dom==r.contentDOM&&(r.dirty=vs),r.update(t,i,n,s)?(this.destroyBetween(this.index,o),this.index++,!0):!1}findIndexWithChild(t){for(;;){let i=t.parentNode;if(!i)return-1;if(i==this.top.contentDOM){let n=t.pmViewDesc;if(n){for(let o=this.index;o<this.top.children.length;o++)if(this.top.children[o]==n)return o}return-1}t=i}}updateNextNode(t,i,n,o,s,r){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof Po){let d=this.preMatch.matched.get(l);if(d!=null&&d!=s)return!1;let c=l.dom,u,h=this.isLocked(c)&&!(t.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==t.text&&l.dirty!=nn&&dc(i,l.outerDeco));if(!h&&l.update(t,i,n,o))return this.destroyBetween(this.index,a),l.dom!=c&&(this.changed=!0),this.index++,!0;if(!h&&(u=this.recreateWrapper(l,t,i,n,o,r)))return this.destroyBetween(this.index,a),this.top.children[this.index]=u,u.contentDOM&&(u.dirty=vs,u.updateChildren(o,r+1),u.dirty=ki),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(t,i,n,o,s,r){if(t.dirty||i.isAtom||!t.children.length||!t.node.content.eq(i.content)||!dc(n,t.outerDeco)||!o.eq(t.innerDeco))return null;let a=Po.create(this.top,i,n,o,s,r);if(a.contentDOM){a.children=t.children,t.children=[];for(let l of a.children)l.parent=a}return t.destroy(),a}addNode(t,i,n,o,s){let r=Po.create(this.top,t,i,n,o,s);r.contentDOM&&r.updateChildren(o,s+1),this.top.children.splice(this.index++,0,r),this.changed=!0}placeWidget(t,i,n){let o=this.index<this.top.children.length?this.top.children[this.index]:null;if(o&&o.matchesWidget(t)&&(t==o.widget||!o.widget.type.toDOM.parentNode))this.index++;else{let s=new rc(this.top,t,i,n);this.top.children.splice(this.index++,0,s),this.changed=!0}}addTextblockHacks(){let t=this.top.children[this.index-1],i=this.top;for(;t instanceof Dr;)i=t,t=i.children[i.children.length-1];(!t||!(t instanceof ac)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((ei||Ut)&&t&&t.dom.contentEditable=="false"&&this.addHackNode("IMG",i),this.addHackNode("BR",this.top))}addHackNode(t,i){if(i==this.top&&this.index<i.children.length&&i.children[this.index].matchesHack(t))this.index++;else{let n=document.createElement(t);t=="IMG"&&(n.className="ProseMirror-separator",n.alt=""),t=="BR"&&(n.className="ProseMirror-trailingBreak");let o=new lc(this.top,[],n,null);i!=this.top?i.children.push(o):i.children.splice(this.index++,0,o),this.changed=!0}}isLocked(t){return this.lock&&(t==this.lock||t.nodeType==1&&t.contains(this.lock.parentNode))}};function gD(e,t){let i=t,n=i.children.length,o=e.childCount,s=new Map,r=[];e:for(;o>0;){let a;for(;;)if(n){let d=i.children[n-1];if(d instanceof Dr)i=d,n=d.children.length;else{a=d,n--;break}}else{if(i==t)break e;n=i.parent.children.indexOf(i),i=i.parent}let l=a.node;if(l){if(l!=e.child(o-1))break;--o,s.set(a,o),r.push(a)}}return{index:o,matched:s,matches:r.reverse()}}function fD(e,t){return e.type.side-t.type.side}function mD(e,t,i,n){let o=t.locals(e),s=0;if(o.length==0){for(let d=0;d<e.childCount;d++){let c=e.child(d);n(c,o,t.forChild(s,c),d),s+=c.nodeSize}return}let r=0,a=[],l=null;for(let d=0;;){let c,u;for(;r<o.length&&o[r].to==s;){let m=o[r++];m.widget&&(c?(u||(u=[c])).push(m):c=m)}if(c)if(u){u.sort(fD);for(let m=0;m<u.length;m++)i(u[m],d,!!l)}else i(c,d,!!l);let h,p;if(l)p=-1,h=l,l=null;else if(d<e.childCount)p=d,h=e.child(d++);else break;for(let m=0;m<a.length;m++)a[m].to<=s&&a.splice(m--,1);for(;r<o.length&&o[r].from<=s&&o[r].to>s;)a.push(o[r++]);let g=s+h.nodeSize;if(h.isText){let m=g;r<o.length&&o[r].from<m&&(m=o[r].from);for(let C=0;C<a.length;C++)a[C].to<m&&(m=a[C].to);m<g&&(l=h.cut(m-s),h=h.cut(0,m-s),g=m,p=-1)}else for(;r<o.length&&o[r].to<g;)r++;let f=h.isInline&&!h.isLeaf?a.filter(m=>!m.inline):a.slice();n(h,f,t.forChild(s,h),p),s=g}}function CD(e){if(e.nodeName=="UL"||e.nodeName=="OL"){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}function vD(e,t,i,n){for(let o=0,s=0;o<e.childCount&&s<=n;){let r=e.child(o++),a=s;if(s+=r.nodeSize,!r.isText)continue;let l=r.text;for(;o<e.childCount;){let d=e.child(o++);if(s+=d.nodeSize,!d.isText)break;l+=d.text}if(s>=i){if(s>=n&&l.slice(n-t.length-a,n-a)==t)return n-t.length;let d=a<n?l.lastIndexOf(t,n-a-1):-1;if(d>=0&&d+t.length+a>=i)return a+d;if(i==n&&l.length>=n+t.length-a&&l.slice(n-a,n-a+t.length)==t)return n}}return-1}function df(e,t,i,n,o){let s=[];for(let r=0,a=0;r<e.length;r++){let l=e[r],d=a,c=a+=l.size;d>=i||c<=t?s.push(l):(d<t&&s.push(l.slice(0,t-d,n)),o&&(s.push(o),o=void 0),c>i&&s.push(l.slice(i-d,l.size,n)))}return s}function bf(e,t=null){let i=e.domSelectionRange(),n=e.state.doc;if(!i.focusNode)return null;let o=e.docView.nearestDesc(i.focusNode),s=o&&o.size==0,r=e.docView.posFromDOM(i.focusNode,i.focusOffset,1);if(r<0)return null;let a=n.resolve(r),l,d;if(mc(i)){for(l=r;o&&!o.node;)o=o.parent;let u=o.node;if(o&&u.isAtom&&J.isSelectable(u)&&o.parent&&!(u.isInline&&jk(i.focusNode,i.focusOffset,o.dom))){let h=o.posBefore;d=new J(r==h?a:n.resolve(h))}}else{if(i instanceof e.dom.ownerDocument.defaultView.Selection&&i.rangeCount>1){let u=r,h=r;for(let p=0;p<i.rangeCount;p++){let g=i.getRangeAt(p);u=Math.min(u,e.docView.posFromDOM(g.startContainer,g.startOffset,1)),h=Math.max(h,e.docView.posFromDOM(g.endContainer,g.endOffset,-1))}if(u<0)return null;[l,r]=h==e.state.selection.anchor?[h,u]:[u,h],a=n.resolve(r)}else l=e.docView.posFromDOM(i.anchorNode,i.anchorOffset,1);if(l<0)return null}let c=n.resolve(l);if(!d){let u=t=="pointer"||e.state.selection.head<a.pos&&!s?1:-1;d=yf(e,c,a,u)}return d}function Ty(e){return e.editable?e.hasFocus():Iy(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function Bn(e,t=!1){let i=e.state.selection;if(Ay(e,i),!!Ty(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&Ut){let n=e.domSelectionRange(),o=e.domObserver.currentSelection;if(n.anchorNode&&o.anchorNode&&xs(n.anchorNode,n.anchorOffset,o.anchorNode,o.anchorOffset)){e.input.mouseDown.delayedSelectionSync=!0,e.domObserver.setCurSelection();return}}if(e.domObserver.disconnectSelection(),e.cursorWrapper)bD(e);else{let{anchor:n,head:o}=i,s,r;Jb&&!(i instanceof ne)&&(i.$from.parent.inlineContent||(s=Qb(e,i.from)),!i.empty&&!i.$from.parent.inlineContent&&(r=Qb(e,i.to))),e.docView.setSelection(n,o,e,t),Jb&&(s&&Zb(s),r&&Zb(r)),i.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&wD(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}var Jb=ei||Ut&&yy<63;function Qb(e,t){let{node:i,offset:n}=e.docView.domFromPos(t,0),o=n<i.childNodes.length?i.childNodes[n]:null,s=n?i.childNodes[n-1]:null;if(ei&&o&&o.contentEditable=="false")return Xg(o);if((!o||o.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(o)return Xg(o);if(s)return Xg(s)}}function Xg(e){return e.contentEditable="true",ei&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function Zb(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function wD(e){let t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);let i=e.domSelectionRange(),n=i.anchorNode,o=i.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{(i.anchorNode!=n||i.anchorOffset!=o)&&(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(()=>{(!Ty(e)||e.state.selection.visible)&&e.dom.classList.remove("ProseMirror-hideselection")},20))})}function bD(e){let t=e.domSelection();if(!t)return;let i=e.cursorWrapper.dom,n=i.nodeName=="IMG";n?t.collapse(i.parentNode,At(i)+1):t.collapse(i,0),!n&&!e.state.selection.visible&&di&&Ro<=11&&(i.disabled=!0,i.disabled=!1)}function Ay(e,t){if(t instanceof J){let i=e.docView.descAt(t.from);i!=e.lastSelectedViewDesc&&(ey(e),i&&i.selectNode(),e.lastSelectedViewDesc=i)}else ey(e)}function ey(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function yf(e,t,i,n){return e.someProp("createSelectionBetween",o=>o(e,t,i))||ne.between(t,i,n)}function ty(e){return e.editable&&!e.hasFocus()?!1:Iy(e)}function Iy(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(t.anchorNode.nodeType==3?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(t.focusNode.nodeType==3?t.focusNode.parentNode:t.focusNode))}catch{return!1}}function yD(e){let t=e.docView.domFromPos(e.state.selection.anchor,0),i=e.domSelectionRange();return xs(t.node,t.offset,i.anchorNode,i.anchorOffset)}function cf(e,t){let{$anchor:i,$head:n}=e.selection,o=t>0?i.max(n):i.min(n),s=o.parent.inlineContent?o.depth?e.doc.resolve(t>0?o.after():o.before()):null:o;return s&&de.findFrom(s,t)}function xo(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function iy(e,t,i){let n=e.state.selection;if(n instanceof ne)if(i.indexOf("s")>-1){let{$head:o}=n,s=o.textOffset?null:t<0?o.nodeBefore:o.nodeAfter;if(!s||s.isText||!s.isLeaf)return!1;let r=e.state.doc.resolve(o.pos+s.nodeSize*(t<0?-1:1));return xo(e,new ne(n.$anchor,r))}else if(n.empty){if(e.endOfTextblock(t>0?"forward":"backward")){let o=cf(e.state,t);return o&&o instanceof J?xo(e,o):!1}else if(!(Ri&&i.indexOf("m")>-1)){let o=n.$head,s=o.textOffset?null:t<0?o.nodeBefore:o.nodeAfter,r;if(!s||s.isText)return!1;let a=t<0?o.pos-s.nodeSize:o.pos;return s.isAtom||(r=e.docView.descAt(a))&&!r.contentDOM?J.isSelectable(s)?xo(e,new J(t<0?e.state.doc.resolve(o.pos-s.nodeSize):o)):el?xo(e,new ne(e.state.doc.resolve(t<0?a:a+s.nodeSize))):!1:!1}}else return!1;else{if(n instanceof J&&n.node.isInline)return xo(e,new ne(t>0?n.$to:n.$from));{let o=cf(e.state,t);return o?xo(e,o):!1}}}function cc(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function Ka(e,t){let i=e.pmViewDesc;return i&&i.size==0&&(t<0||e.nextSibling||e.nodeName!="BR")}function Er(e,t){return t<0?SD(e):xD(e)}function SD(e){let t=e.domSelectionRange(),i=t.focusNode,n=t.focusOffset;if(!i)return;let o,s,r=!1;for(Mi&&i.nodeType==1&&n<cc(i)&&Ka(i.childNodes[n],-1)&&(r=!0);;)if(n>0){if(i.nodeType!=1)break;{let a=i.childNodes[n-1];if(Ka(a,-1))o=i,s=--n;else if(a.nodeType==3)i=a,n=i.nodeValue.length;else break}}else{if(Ly(i))break;{let a=i.previousSibling;for(;a&&Ka(a,-1);)o=i.parentNode,s=At(a),a=a.previousSibling;if(a)i=a,n=cc(i);else{if(i=i.parentNode,i==e.dom)break;n=0}}}r?uf(e,i,n):o&&uf(e,o,s)}function xD(e){let t=e.domSelectionRange(),i=t.focusNode,n=t.focusOffset;if(!i)return;let o=cc(i),s,r;for(;;)if(n<o){if(i.nodeType!=1)break;let a=i.childNodes[n];if(Ka(a,1))s=i,r=++n;else break}else{if(Ly(i))break;{let a=i.nextSibling;for(;a&&Ka(a,1);)s=a.parentNode,r=At(a)+1,a=a.nextSibling;if(a)i=a,n=0,o=cc(i);else{if(i=i.parentNode,i==e.dom)break;n=o=0}}}s&&uf(e,s,r)}function Ly(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function ED(e,t){for(;e&&t==e.childNodes.length&&!Za(e);)t=At(e)+1,e=e.parentNode;for(;e&&t<e.childNodes.length;){let i=e.childNodes[t];if(i.nodeType==3)return i;if(i.nodeType==1&&i.contentEditable=="false")break;e=i,t=0}}function RD(e,t){for(;e&&!t&&!Za(e);)t=At(e),e=e.parentNode;for(;e&&t;){let i=e.childNodes[t-1];if(i.nodeType==3)return i;if(i.nodeType==1&&i.contentEditable=="false")break;e=i,t=e.childNodes.length}}function uf(e,t,i){if(t.nodeType!=3){let s,r;(r=ED(t,i))?(t=r,i=0):(s=RD(t,i))&&(t=s,i=s.nodeValue.length)}let n=e.domSelection();if(!n)return;if(mc(n)){let s=document.createRange();s.setEnd(t,i),s.setStart(t,i),n.removeAllRanges(),n.addRange(s)}else n.extend&&n.extend(t,i);e.domObserver.setCurSelection();let{state:o}=e;setTimeout(()=>{e.state==o&&Bn(e)},50)}function ny(e,t){let i=e.state.doc.resolve(t);if(!(Ut||Xk)&&i.parent.inlineContent){let o=e.coordsAtPos(t);if(t>i.start()){let s=e.coordsAtPos(t-1),r=(s.top+s.bottom)/2;if(r>o.top&&r<o.bottom&&Math.abs(s.left-o.left)>1)return s.left<o.left?"ltr":"rtl"}if(t<i.end()){let s=e.coordsAtPos(t+1),r=(s.top+s.bottom)/2;if(r>o.top&&r<o.bottom&&Math.abs(s.left-o.left)>1)return s.left>o.left?"ltr":"rtl"}}return getComputedStyle(e.dom).direction=="rtl"?"rtl":"ltr"}function oy(e,t,i){let n=e.state.selection;if(n instanceof ne&&!n.empty||i.indexOf("s")>-1||Ri&&i.indexOf("m")>-1)return!1;let{$from:o,$to:s}=n;if(!o.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let r=cf(e.state,t);if(r&&r instanceof J)return xo(e,r)}if(!o.parent.inlineContent){let r=t<0?o:s,a=n instanceof Zt?de.near(r,t):de.findFrom(r,t);return a?xo(e,a):!1}return!1}function sy(e,t){if(!(e.state.selection instanceof ne))return!0;let{$head:i,$anchor:n,empty:o}=e.state.selection;if(!i.sameParent(n))return!0;if(!o)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let s=!i.textOffset&&(t<0?i.nodeBefore:i.nodeAfter);if(s&&!s.isText){let r=e.state.tr;return t<0?r.delete(i.pos-s.nodeSize,i.pos):r.delete(i.pos,i.pos+s.nodeSize),e.dispatch(r),!0}return!1}function ry(e,t,i){e.domObserver.stop(),t.contentEditable=i,e.domObserver.start()}function PD(e){if(!ei||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:i}=e.domSelectionRange();if(t&&t.nodeType==1&&i==0&&t.firstChild&&t.firstChild.contentEditable=="false"){let n=t.firstChild;ry(e,n,"true"),setTimeout(()=>ry(e,n,"false"),20)}return!1}function MD(e){let t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}function kD(e,t){let i=t.keyCode,n=MD(t);if(i==8||Ri&&i==72&&n=="c")return sy(e,-1)||Er(e,-1);if(i==46&&!t.shiftKey||Ri&&i==68&&n=="c")return sy(e,1)||Er(e,1);if(i==13||i==27)return!0;if(i==37||Ri&&i==66&&n=="c"){let o=i==37?ny(e,e.state.selection.from)=="ltr"?-1:1:-1;return iy(e,o,n)||Er(e,o)}else if(i==39||Ri&&i==70&&n=="c"){let o=i==39?ny(e,e.state.selection.from)=="ltr"?1:-1:1;return iy(e,o,n)||Er(e,o)}else{if(i==38||Ri&&i==80&&n=="c")return oy(e,-1,n)||Er(e,-1);if(i==40||Ri&&i==78&&n=="c")return PD(e)||oy(e,1,n)||Er(e,1);if(n==(Ri?"m":"c")&&(i==66||i==73||i==89||i==90))return!0}return!1}function Sf(e,t){e.someProp("transformCopied",p=>{t=p(t,e)});let i=[],{content:n,openStart:o,openEnd:s}=t;for(;o>1&&s>1&&n.childCount==1&&n.firstChild.childCount==1;){o--,s--;let p=n.firstChild;i.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),n=p.content}let r=e.someProp("clipboardSerializer")||Tn.fromSchema(e.state.schema),a=Gy(),l=a.createElement("div");l.appendChild(r.serializeFragment(n,{document:a}));let d=l.firstChild,c,u=0;for(;d&&d.nodeType==1&&(c=Hy[d.nodeName.toLowerCase()]);){for(let p=c.length-1;p>=0;p--){let g=a.createElement(c[p]);for(;l.firstChild;)g.appendChild(l.firstChild);l.appendChild(g),u++}d=l.firstChild}d&&d.nodeType==1&&d.setAttribute("data-pm-slice",`${o} ${s}${u?` -${u}`:""} ${JSON.stringify(i)}`);let h=e.someProp("clipboardTextSerializer",p=>p(t,e))||t.content.textBetween(0,t.content.size,`

`);return{dom:l,text:h,slice:t}}function _y(e,t,i,n,o){let s=o.parent.type.spec.code,r,a;if(!i&&!t)return null;let l=!!t&&(n||s||!i);if(l){if(e.someProp("transformPastedText",h=>{t=h(t,s||n,e)}),s)return a=new K(N.from(e.state.schema.text(t.replace(/\r\n?/g,`
`))),0,0),e.someProp("transformPasted",h=>{a=h(a,e,!0)}),a;let u=e.someProp("clipboardTextParser",h=>h(t,o,n,e));if(u)a=u;else{let h=o.marks(),{schema:p}=e.state,g=Tn.fromSchema(p);r=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(f=>{let m=r.appendChild(document.createElement("p"));f&&m.appendChild(g.serializeNode(p.text(f,h)))})}}else e.someProp("transformPastedHTML",u=>{i=u(i,e)}),r=AD(i),el&&ID(r);let d=r&&r.querySelector("[data-pm-slice]"),c=d&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(d.getAttribute("data-pm-slice")||"");if(c&&c[3])for(let u=+c[3];u>0;u--){let h=r.firstChild;for(;h&&h.nodeType!=1;)h=h.nextSibling;if(!h)break;r=h}if(a||(a=(e.someProp("clipboardParser")||e.someProp("domParser")||en.fromSchema(e.state.schema)).parseSlice(r,{preserveWhitespace:!!(l||c),context:o,ruleFromNode(h){return h.nodeName=="BR"&&!h.nextSibling&&h.parentNode&&!DD.test(h.parentNode.nodeName)?{ignore:!0}:null}})),c)a=LD(ay(a,+c[1],+c[2]),c[4]);else if(a=K.maxOpen(FD(a.content,o),!0),a.openStart||a.openEnd){let u=0,h=0;for(let p=a.content.firstChild;u<a.openStart&&!p.type.spec.isolating;u++,p=p.firstChild);for(let p=a.content.lastChild;h<a.openEnd&&!p.type.spec.isolating;h++,p=p.lastChild);a=ay(a,u,h)}return e.someProp("transformPasted",u=>{a=u(a,e,l)}),a}var DD=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function FD(e,t){if(e.childCount<2)return e;for(let i=t.depth;i>=0;i--){let o=t.node(i).contentMatchAt(t.index(i)),s,r=[];if(e.forEach(a=>{if(!r)return;let l=o.findWrapping(a.type),d;if(!l)return r=null;if(d=r.length&&s.length&&Ny(l,s,a,r[r.length-1],0))r[r.length-1]=d;else{r.length&&(r[r.length-1]=By(r[r.length-1],s.length));let c=Oy(a,l);r.push(c),o=o.matchType(c.type),s=l}}),r)return N.from(r)}return e}function Oy(e,t,i=0){for(let n=t.length-1;n>=i;n--)e=t[n].create(null,N.from(e));return e}function Ny(e,t,i,n,o){if(o<e.length&&o<t.length&&e[o]==t[o]){let s=Ny(e,t,i,n.lastChild,o+1);if(s)return n.copy(n.content.replaceChild(n.childCount-1,s));if(n.contentMatchAt(n.childCount).matchType(o==e.length-1?i.type:e[o+1]))return n.copy(n.content.append(N.from(Oy(i,e,o+1))))}}function By(e,t){if(t==0)return e;let i=e.content.replaceChild(e.childCount-1,By(e.lastChild,t-1)),n=e.contentMatchAt(e.childCount).fillBefore(N.empty,!0);return e.copy(i.append(n))}function hf(e,t,i,n,o,s){let r=t<0?e.firstChild:e.lastChild,a=r.content;return e.childCount>1&&(s=0),o<n-1&&(a=hf(a,t,i,n,o+1,s)),o>=i&&(a=t<0?r.contentMatchAt(0).fillBefore(a,s<=o).append(a):a.append(r.contentMatchAt(r.childCount).fillBefore(N.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,r.copy(a))}function ay(e,t,i){return t<e.openStart&&(e=new K(hf(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),i<e.openEnd&&(e=new K(hf(e.content,1,i,e.openEnd,0,0),e.openStart,i)),e}var Hy={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},ly=null;function Gy(){return ly||(ly=document.implementation.createHTMLDocument("title"))}var Jg=null;function TD(e){let t=window.trustedTypes;return t?(Jg||(Jg=t.defaultPolicy||t.createPolicy("ProseMirrorClipboard",{createHTML:i=>i})),Jg.createHTML(e)):e}function AD(e){let t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));let i=Gy().createElement("div"),n=/<([a-z][^>\s]+)/i.exec(e),o;if((o=n&&Hy[n[1].toLowerCase()])&&(e=o.map(s=>"<"+s+">").join("")+e+o.map(s=>"</"+s+">").reverse().join("")),i.innerHTML=TD(e),o)for(let s=0;s<o.length;s++)i=i.querySelector(o[s])||i;return i}function ID(e){let t=e.querySelectorAll(Ut?"span:not([class]):not([style])":"span.Apple-converted-space");for(let i=0;i<t.length;i++){let n=t[i];n.childNodes.length==1&&n.textContent=="\xA0"&&n.parentNode&&n.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),n)}}function LD(e,t){if(!e.size)return e;let i=e.content.firstChild.type.schema,n;try{n=JSON.parse(t)}catch{return e}let{content:o,openStart:s,openEnd:r}=e;for(let a=n.length-2;a>=0;a-=2){let l=i.nodes[n[a]];if(!l||l.hasRequiredAttrs())break;o=N.from(l.create(n[a+1],o)),s++,r++}return new K(o,s,r)}var ti={},ii={},_D={touchstart:!0,touchmove:!0},pf=class{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}};function OD(e){for(let t in ti){let i=ti[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=n=>{BD(e,n)&&!xf(e,n)&&(e.editable||!(n.type in ii))&&i(e,n)},_D[t]?{passive:!0}:void 0)}ei&&e.dom.addEventListener("input",()=>null),gf(e)}function Eo(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function ND(e){e.domObserver.stop();for(let t in e.input.eventHandlers)e.dom.removeEventListener(t,e.input.eventHandlers[t]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}function gf(e){e.someProp("handleDOMEvents",t=>{for(let i in t)e.input.eventHandlers[i]||e.dom.addEventListener(i,e.input.eventHandlers[i]=n=>xf(e,n))})}function xf(e,t){return e.someProp("handleDOMEvents",i=>{let n=i[t.type];return n?n(e,t)||t.defaultPrevented:!1})}function BD(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let i=t.target;i!=e.dom;i=i.parentNode)if(!i||i.nodeType==11||i.pmViewDesc&&i.pmViewDesc.stopEvent(t))return!1;return!0}function HD(e,t){!xf(e,t)&&ti[t.type]&&(e.editable||!(t.type in ii))&&ti[t.type](e,t)}ii.keydown=(e,t)=>{let i=t;if(e.input.shiftKey=i.keyCode==16||i.shiftKey,!zy(e,i)&&(e.input.lastKeyCode=i.keyCode,e.input.lastKeyCodeTime=Date.now(),!(Nn&&Ut&&i.keyCode==13)))if(i.keyCode!=229&&e.domObserver.forceFlush(),kr&&i.keyCode==13&&!i.ctrlKey&&!i.altKey&&!i.metaKey){let n=Date.now();e.input.lastIOSEnter=n,e.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{e.input.lastIOSEnter==n&&(e.someProp("handleKeyDown",o=>o(e,Cs(13,"Enter"))),e.input.lastIOSEnter=0)},200)}else e.someProp("handleKeyDown",n=>n(e,i))||kD(e,i)?i.preventDefault():Eo(e,"key")};ii.keyup=(e,t)=>{t.keyCode==16&&(e.input.shiftKey=!1)};ii.keypress=(e,t)=>{let i=t;if(zy(e,i)||!i.charCode||i.ctrlKey&&!i.altKey||Ri&&i.metaKey)return;if(e.someProp("handleKeyPress",o=>o(e,i))){i.preventDefault();return}let n=e.state.selection;if(!(n instanceof ne)||!n.$from.sameParent(n.$to)){let o=String.fromCharCode(i.charCode),s=()=>e.state.tr.insertText(o).scrollIntoView();!/[\r\n]/.test(o)&&!e.someProp("handleTextInput",r=>r(e,n.$from.pos,n.$to.pos,o,s))&&e.dispatch(s()),i.preventDefault()}};function Cc(e){return{left:e.clientX,top:e.clientY}}function GD(e,t){let i=t.x-e.clientX,n=t.y-e.clientY;return i*i+n*n<100}function Ef(e,t,i,n,o){if(n==-1)return!1;let s=e.state.doc.resolve(n);for(let r=s.depth+1;r>0;r--)if(e.someProp(t,a=>r>s.depth?a(e,i,s.nodeAfter,s.before(r),o,!0):a(e,i,s.node(r),s.before(r),o,!1)))return!0;return!1}function Pr(e,t,i){if(e.focused||e.focus(),e.state.selection.eq(t))return;let n=e.state.tr.setSelection(t);i=="pointer"&&n.setMeta("pointer",!0),e.dispatch(n)}function VD(e,t){if(t==-1)return!1;let i=e.state.doc.resolve(t),n=i.nodeAfter;return n&&n.isAtom&&J.isSelectable(n)?(Pr(e,new J(i),"pointer"),!0):!1}function zD(e,t){if(t==-1)return!1;let i=e.state.selection,n,o;i instanceof J&&(n=i.node);let s=e.state.doc.resolve(t);for(let r=s.depth+1;r>0;r--){let a=r>s.depth?s.nodeAfter:s.node(r);if(J.isSelectable(a)){n&&i.$from.depth>0&&r>=i.$from.depth&&s.before(i.$from.depth+1)==i.$from.pos?o=s.before(i.$from.depth):o=s.before(r);break}}return o!=null?(Pr(e,J.create(e.state.doc,o),"pointer"),!0):!1}function WD(e,t,i,n,o){return Ef(e,"handleClickOn",t,i,n)||e.someProp("handleClick",s=>s(e,t,n))||(o?zD(e,i):VD(e,i))}function UD(e,t,i,n){return Ef(e,"handleDoubleClickOn",t,i,n)||e.someProp("handleDoubleClick",o=>o(e,t,n))}function qD(e,t,i,n){return Ef(e,"handleTripleClickOn",t,i,n)||e.someProp("handleTripleClick",o=>o(e,t,n))||$D(e,i,n)}function $D(e,t,i){if(i.button!=0)return!1;let n=e.state.doc;if(t==-1)return n.inlineContent?(Pr(e,ne.create(n,0,n.content.size),"pointer"),!0):!1;let o=n.resolve(t);for(let s=o.depth+1;s>0;s--){let r=s>o.depth?o.nodeAfter:o.node(s),a=o.before(s);if(r.inlineContent)Pr(e,ne.create(n,a+1,a+1+r.content.size),"pointer");else if(J.isSelectable(r))Pr(e,J.create(n,a),"pointer");else continue;return!0}}function Rf(e){return uc(e)}var Vy=Ri?"metaKey":"ctrlKey";ti.mousedown=(e,t)=>{let i=t;e.input.shiftKey=i.shiftKey;let n=Rf(e),o=Date.now(),s="singleClick";o-e.input.lastClick.time<500&&GD(i,e.input.lastClick)&&!i[Vy]&&e.input.lastClick.button==i.button&&(e.input.lastClick.type=="singleClick"?s="doubleClick":e.input.lastClick.type=="doubleClick"&&(s="tripleClick")),e.input.lastClick={time:o,x:i.clientX,y:i.clientY,type:s,button:i.button};let r=e.posAtCoords(Cc(i));r&&(s=="singleClick"?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new ff(e,r,i,!!n)):(s=="doubleClick"?UD:qD)(e,r.pos,r.inside,i)?i.preventDefault():Eo(e,"pointer"))};var ff=class{constructor(t,i,n,o){this.view=t,this.pos=i,this.event=n,this.flushed=o,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!n[Vy],this.allowDefault=n.shiftKey;let s,r;if(i.inside>-1)s=t.state.doc.nodeAt(i.inside),r=i.inside;else{let c=t.state.doc.resolve(i.pos);s=c.parent,r=c.depth?c.before():0}let a=o?null:n.target,l=a?t.docView.nearestDesc(a,!0):null;this.target=l&&l.nodeDOM.nodeType==1?l.nodeDOM:null;let{selection:d}=t.state;(n.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||d instanceof J&&d.from<=r&&d.to>r)&&(this.mightDrag={node:s,pos:r,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Mi&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),Eo(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Bn(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let i=this.pos;this.view.state.doc!=this.startDoc&&(i=this.view.posAtCoords(Cc(t))),this.updateAllowDefault(t),this.allowDefault||!i?Eo(this.view,"pointer"):WD(this.view,i.pos,i.inside,t,this.selectNode)?t.preventDefault():t.button==0&&(this.flushed||ei&&this.mightDrag&&!this.mightDrag.node.isAtom||Ut&&!this.view.state.selection.visible&&Math.min(Math.abs(i.pos-this.view.state.selection.from),Math.abs(i.pos-this.view.state.selection.to))<=2)?(Pr(this.view,de.near(this.view.state.doc.resolve(i.pos)),"pointer"),t.preventDefault()):Eo(this.view,"pointer")}move(t){this.updateAllowDefault(t),Eo(this.view,"pointer"),t.buttons==0&&this.done()}updateAllowDefault(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)}};ti.touchstart=e=>{e.input.lastTouch=Date.now(),Rf(e),Eo(e,"pointer")};ti.touchmove=e=>{e.input.lastTouch=Date.now(),Eo(e,"pointer")};ti.contextmenu=e=>Rf(e);function zy(e,t){return e.composing?!0:ei&&Math.abs(t.timeStamp-e.input.compositionEndedAt)<500?(e.input.compositionEndedAt=-2e8,!0):!1}var jD=Nn?5e3:-1;ii.compositionstart=ii.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,i=t.selection.$to;if(t.selection instanceof ne&&(t.storedMarks||!i.textOffset&&i.parentOffset&&i.nodeBefore.marks.some(n=>n.type.spec.inclusive===!1)))e.markCursor=e.state.storedMarks||i.marks(),uc(e,!0),e.markCursor=null;else if(uc(e,!t.selection.empty),Mi&&t.selection.empty&&i.parentOffset&&!i.textOffset&&i.nodeBefore.marks.length){let n=e.domSelectionRange();for(let o=n.focusNode,s=n.focusOffset;o&&o.nodeType==1&&s!=0;){let r=s<0?o.lastChild:o.childNodes[s-1];if(!r)break;if(r.nodeType==3){let a=e.domSelection();a&&a.collapse(r,r.nodeValue.length);break}else o=r,s=-1}}e.input.composing=!0}Wy(e,jD)};ii.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionNode=null,e.input.compositionPendingChanges&&Promise.resolve().then(()=>e.domObserver.flush()),e.input.compositionID++,Wy(e,20))};function Wy(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout(()=>uc(e),t))}function Uy(e){for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=YD());e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function KD(e){let t=e.domSelectionRange();if(!t.focusNode)return null;let i=qk(t.focusNode,t.focusOffset),n=$k(t.focusNode,t.focusOffset);if(i&&n&&i!=n){let o=n.pmViewDesc,s=e.domObserver.lastChangedTextNode;if(i==s||n==s)return s;if(!o||!o.isText(n.nodeValue))return n;if(e.input.compositionNode==n){let r=i.pmViewDesc;if(!(!r||!r.isText(i.nodeValue)))return n}}return i||n}function YD(){let e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}function uc(e,t=!1){if(!(Nn&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),Uy(e),t||e.docView&&e.docView.dirty){let i=bf(e),n=e.state.selection;return i&&!i.eq(n)?e.dispatch(e.state.tr.setSelection(i)):(e.markCursor||t)&&!n.$from.node(n.$from.sharedDepth(n.to)).inlineContent?e.dispatch(e.state.tr.deleteSelection()):e.updateState(e.state),!0}return!1}}function XD(e,t){if(!e.dom.parentNode)return;let i=e.dom.parentNode.appendChild(document.createElement("div"));i.appendChild(t),i.style.cssText="position: fixed; left: -10000px; top: 10px";let n=getSelection(),o=document.createRange();o.selectNodeContents(t),e.dom.blur(),n.removeAllRanges(),n.addRange(o),setTimeout(()=>{i.parentNode&&i.parentNode.removeChild(i),e.focus()},50)}var Ya=di&&Ro<15||kr&&Jk<604;ti.copy=ii.cut=(e,t)=>{let i=t,n=e.state.selection,o=i.type=="cut";if(n.empty)return;let s=Ya?null:i.clipboardData,r=n.content(),{dom:a,text:l}=Sf(e,r);s?(i.preventDefault(),s.clearData(),s.setData("text/html",a.innerHTML),s.setData("text/plain",l)):XD(e,a),o&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function JD(e){return e.openStart==0&&e.openEnd==0&&e.content.childCount==1?e.content.firstChild:null}function QD(e,t){if(!e.dom.parentNode)return;let i=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,n=e.dom.parentNode.appendChild(document.createElement(i?"textarea":"div"));i||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus();let o=e.input.shiftKey&&e.input.lastKeyCode!=45;setTimeout(()=>{e.focus(),n.parentNode&&n.parentNode.removeChild(n),i?Xa(e,n.value,null,o,t):Xa(e,n.textContent,n.innerHTML,o,t)},50)}function Xa(e,t,i,n,o){let s=_y(e,t,i,n,e.state.selection.$from);if(e.someProp("handlePaste",l=>l(e,o,s||K.empty)))return!0;if(!s)return!1;let r=JD(s),a=r?e.state.tr.replaceSelectionWith(r,n):e.state.tr.replaceSelection(s);return e.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function qy(e){let t=e.getData("text/plain")||e.getData("Text");if(t)return t;let i=e.getData("text/uri-list");return i?i.replace(/\r?\n/g," "):""}ii.paste=(e,t)=>{let i=t;if(e.composing&&!Nn)return;let n=Ya?null:i.clipboardData,o=e.input.shiftKey&&e.input.lastKeyCode!=45;n&&Xa(e,qy(n),n.getData("text/html"),o,i)?i.preventDefault():QD(e,i)};var hc=class{constructor(t,i,n){this.slice=t,this.move=i,this.node=n}},ZD=Ri?"altKey":"ctrlKey";function $y(e,t){let i=e.someProp("dragCopies",n=>!n(t));return i??!t[ZD]}ti.dragstart=(e,t)=>{let i=t,n=e.input.mouseDown;if(n&&n.done(),!i.dataTransfer)return;let o=e.state.selection,s=o.empty?null:e.posAtCoords(Cc(i)),r;if(!(s&&s.pos>=o.from&&s.pos<=(o instanceof J?o.to-1:o.to))){if(n&&n.mightDrag)r=J.create(e.state.doc,n.mightDrag.pos);else if(i.target&&i.target.nodeType==1){let u=e.docView.nearestDesc(i.target,!0);u&&u.node.type.spec.draggable&&u!=e.docView&&(r=J.create(e.state.doc,u.posBefore))}}let a=(r||e.state.selection).content(),{dom:l,text:d,slice:c}=Sf(e,a);(!i.dataTransfer.files.length||!Ut||yy>120)&&i.dataTransfer.clearData(),i.dataTransfer.setData(Ya?"Text":"text/html",l.innerHTML),i.dataTransfer.effectAllowed="copyMove",Ya||i.dataTransfer.setData("text/plain",d),e.dragging=new hc(c,$y(e,i),r)};ti.dragend=e=>{let t=e.dragging;window.setTimeout(()=>{e.dragging==t&&(e.dragging=null)},50)};ii.dragover=ii.dragenter=(e,t)=>t.preventDefault();ii.drop=(e,t)=>{let i=t,n=e.dragging;if(e.dragging=null,!i.dataTransfer)return;let o=e.posAtCoords(Cc(i));if(!o)return;let s=e.state.doc.resolve(o.pos),r=n&&n.slice;r?e.someProp("transformPasted",g=>{r=g(r,e,!1)}):r=_y(e,qy(i.dataTransfer),Ya?null:i.dataTransfer.getData("text/html"),!1,s);let a=!!(n&&$y(e,i));if(e.someProp("handleDrop",g=>g(e,i,r||K.empty,a))){i.preventDefault();return}if(!r)return;i.preventDefault();let l=r?ec(e.state.doc,s.pos,r):s.pos;l==null&&(l=s.pos);let d=e.state.tr;if(a){let{node:g}=n;g?g.replace(d):d.deleteSelection()}let c=d.mapping.map(l),u=r.openStart==0&&r.openEnd==0&&r.content.childCount==1,h=d.doc;if(u?d.replaceRangeWith(c,c,r.content.firstChild):d.replaceRange(c,c,r),d.doc.eq(h))return;let p=d.doc.resolve(c);if(u&&J.isSelectable(r.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(r.content.firstChild))d.setSelection(new J(p));else{let g=d.mapping.map(l);d.mapping.maps[d.mapping.maps.length-1].forEach((f,m,C,v)=>g=v),d.setSelection(yf(e,p,d.doc.resolve(g)))}e.focus(),e.dispatch(d.setMeta("uiEvent","drop"))};ti.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&Bn(e)},20))};ti.blur=(e,t)=>{let i=t;e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),i.relatedTarget&&e.dom.contains(i.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)};ti.beforeinput=(e,t)=>{if(Ut&&Nn&&t.inputType=="deleteContentBackward"){e.domObserver.flushSoon();let{domChangeCount:n}=e.input;setTimeout(()=>{if(e.input.domChangeCount!=n||(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",s=>s(e,Cs(8,"Backspace")))))return;let{$cursor:o}=e.state.selection;o&&o.pos>0&&e.dispatch(e.state.tr.delete(o.pos-1,o.pos).scrollIntoView())},50)}};for(let e in ii)ti[e]=ii[e];function Ja(e,t){if(e==t)return!0;for(let i in e)if(e[i]!==t[i])return!1;for(let i in t)if(!(i in e))return!1;return!0}var pc=class e{constructor(t,i){this.toDOM=t,this.spec=i||ys,this.side=this.spec.side||0}map(t,i,n,o){let{pos:s,deleted:r}=t.mapResult(i.from+o,this.side<0?-1:1);return r?null:new qt(s-n,s-n,this)}valid(){return!0}eq(t){return this==t||t instanceof e&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&Ja(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}},bs=class e{constructor(t,i){this.attrs=t,this.spec=i||ys}map(t,i,n,o){let s=t.map(i.from+o,this.spec.inclusiveStart?-1:1)-n,r=t.map(i.to+o,this.spec.inclusiveEnd?1:-1)-n;return s>=r?null:new qt(s,r,this)}valid(t,i){return i.from<i.to}eq(t){return this==t||t instanceof e&&Ja(this.attrs,t.attrs)&&Ja(this.spec,t.spec)}static is(t){return t.type instanceof e}destroy(){}},mf=class e{constructor(t,i){this.attrs=t,this.spec=i||ys}map(t,i,n,o){let s=t.mapResult(i.from+o,1);if(s.deleted)return null;let r=t.mapResult(i.to+o,-1);return r.deleted||r.pos<=s.pos?null:new qt(s.pos-n,r.pos-n,this)}valid(t,i){let{index:n,offset:o}=t.content.findIndex(i.from),s;return o==i.from&&!(s=t.child(n)).isText&&o+s.nodeSize==i.to}eq(t){return this==t||t instanceof e&&Ja(this.attrs,t.attrs)&&Ja(this.spec,t.spec)}destroy(){}},qt=class e{constructor(t,i,n){this.from=t,this.to=i,this.type=n}copy(t,i){return new e(t,i,this.type)}eq(t,i=0){return this.type.eq(t.type)&&this.from+i==t.from&&this.to+i==t.to}map(t,i,n){return this.type.map(t,this,i,n)}static widget(t,i,n){return new e(t,t,new pc(i,n))}static inline(t,i,n,o){return new e(t,i,new bs(n,o))}static node(t,i,n,o){return new e(t,i,new mf(n,o))}get spec(){return this.type.spec}get inline(){return this.type instanceof bs}get widget(){return this.type instanceof pc}},Rr=[],ys={},dt=class e{constructor(t,i){this.local=t.length?t:Rr,this.children=i.length?i:Rr}static create(t,i){return i.length?fc(i,t,0,ys):Wt}find(t,i,n){let o=[];return this.findInner(t??0,i??1e9,o,0,n),o}findInner(t,i,n,o,s){for(let r=0;r<this.local.length;r++){let a=this.local[r];a.from<=i&&a.to>=t&&(!s||s(a.spec))&&n.push(a.copy(a.from+o,a.to+o))}for(let r=0;r<this.children.length;r+=3)if(this.children[r]<i&&this.children[r+1]>t){let a=this.children[r]+1;this.children[r+2].findInner(t-a,i-a,n,o+a,s)}}map(t,i,n){return this==Wt||t.maps.length==0?this:this.mapInner(t,i,0,0,n||ys)}mapInner(t,i,n,o,s){let r;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(t,n,o);l&&l.type.valid(i,l)?(r||(r=[])).push(l):s.onRemove&&s.onRemove(this.local[a].spec)}return this.children.length?eF(this.children,r||[],t,i,n,o,s):r?new e(r.sort(Ss),Rr):Wt}add(t,i){return i.length?this==Wt?e.create(t,i):this.addInner(t,i,0):this}addInner(t,i,n){let o,s=0;t.forEach((a,l)=>{let d=l+n,c;if(c=Ky(i,a,d)){for(o||(o=this.children.slice());s<o.length&&o[s]<l;)s+=3;o[s]==l?o[s+2]=o[s+2].addInner(a,c,d+1):o.splice(s,0,l,l+a.nodeSize,fc(c,a,d+1,ys)),s+=3}});let r=jy(s?Yy(i):i,-n);for(let a=0;a<r.length;a++)r[a].type.valid(t,r[a])||r.splice(a--,1);return new e(r.length?this.local.concat(r).sort(Ss):this.local,o||this.children)}remove(t){return t.length==0||this==Wt?this:this.removeInner(t,0)}removeInner(t,i){let n=this.children,o=this.local;for(let s=0;s<n.length;s+=3){let r,a=n[s]+i,l=n[s+1]+i;for(let c=0,u;c<t.length;c++)(u=t[c])&&u.from>a&&u.to<l&&(t[c]=null,(r||(r=[])).push(u));if(!r)continue;n==this.children&&(n=this.children.slice());let d=n[s+2].removeInner(r,a+1);d!=Wt?n[s+2]=d:(n.splice(s,3),s-=3)}if(o.length){for(let s=0,r;s<t.length;s++)if(r=t[s])for(let a=0;a<o.length;a++)o[a].eq(r,i)&&(o==this.local&&(o=this.local.slice()),o.splice(a--,1))}return n==this.children&&o==this.local?this:o.length||n.length?new e(o,n):Wt}forChild(t,i){if(this==Wt)return this;if(i.isLeaf)return e.empty;let n,o;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=t){this.children[a]==t&&(n=this.children[a+2]);break}let s=t+1,r=s+i.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<r&&l.to>s&&l.type instanceof bs){let d=Math.max(s,l.from)-s,c=Math.min(r,l.to)-s;d<c&&(o||(o=[])).push(l.copy(d,c))}}if(o){let a=new e(o.sort(Ss),Rr);return n?new gc([a,n]):a}return n||Wt}eq(t){if(this==t)return!0;if(!(t instanceof e)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let i=0;i<this.local.length;i++)if(!this.local[i].eq(t.local[i]))return!1;for(let i=0;i<this.children.length;i+=3)if(this.children[i]!=t.children[i]||this.children[i+1]!=t.children[i+1]||!this.children[i+2].eq(t.children[i+2]))return!1;return!0}locals(t){return Pf(this.localsInner(t))}localsInner(t){if(this==Wt)return Rr;if(t.inlineContent||!this.local.some(bs.is))return this.local;let i=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof bs||i.push(this.local[n]);return i}forEachSet(t){t(this)}};dt.empty=new dt([],[]);dt.removeOverlap=Pf;var Wt=dt.empty,gc=class e{constructor(t){this.members=t}map(t,i){let n=this.members.map(o=>o.map(t,i,ys));return e.from(n)}forChild(t,i){if(i.isLeaf)return dt.empty;let n=[];for(let o=0;o<this.members.length;o++){let s=this.members[o].forChild(t,i);s!=Wt&&(s instanceof e?n=n.concat(s.members):n.push(s))}return e.from(n)}eq(t){if(!(t instanceof e)||t.members.length!=this.members.length)return!1;for(let i=0;i<this.members.length;i++)if(!this.members[i].eq(t.members[i]))return!1;return!0}locals(t){let i,n=!0;for(let o=0;o<this.members.length;o++){let s=this.members[o].localsInner(t);if(s.length)if(!i)i=s;else{n&&(i=i.slice(),n=!1);for(let r=0;r<s.length;r++)i.push(s[r])}}return i?Pf(n?i:i.sort(Ss)):Rr}static from(t){switch(t.length){case 0:return Wt;case 1:return t[0];default:return new e(t.every(i=>i instanceof dt)?t:t.reduce((i,n)=>i.concat(n instanceof dt?n:n.members),[]))}}forEachSet(t){for(let i=0;i<this.members.length;i++)this.members[i].forEachSet(t)}};function eF(e,t,i,n,o,s,r){let a=e.slice();for(let d=0,c=s;d<i.maps.length;d++){let u=0;i.maps[d].forEach((h,p,g,f)=>{let m=f-g-(p-h);for(let C=0;C<a.length;C+=3){let v=a[C+1];if(v<0||h>v+c-u)continue;let w=a[C]+c-u;p>=w?a[C+1]=h<=w?-2:-1:h>=c&&m&&(a[C]+=m,a[C+1]+=m)}u+=m}),c=i.maps[d].map(c,-1)}let l=!1;for(let d=0;d<a.length;d+=3)if(a[d+1]<0){if(a[d+1]==-2){l=!0,a[d+1]=-1;continue}let c=i.map(e[d]+s),u=c-o;if(u<0||u>=n.content.size){l=!0;continue}let h=i.map(e[d+1]+s,-1),p=h-o,{index:g,offset:f}=n.content.findIndex(u),m=n.maybeChild(g);if(m&&f==u&&f+m.nodeSize==p){let C=a[d+2].mapInner(i,m,c+1,e[d]+s+1,r);C!=Wt?(a[d]=u,a[d+1]=p,a[d+2]=C):(a[d+1]=-2,l=!0)}else l=!0}if(l){let d=tF(a,e,t,i,o,s,r),c=fc(d,n,0,r);t=c.local;for(let u=0;u<a.length;u+=3)a[u+1]<0&&(a.splice(u,3),u-=3);for(let u=0,h=0;u<c.children.length;u+=3){let p=c.children[u];for(;h<a.length&&a[h]<p;)h+=3;a.splice(h,0,c.children[u],c.children[u+1],c.children[u+2])}}return new dt(t.sort(Ss),a)}function jy(e,t){if(!t||!e.length)return e;let i=[];for(let n=0;n<e.length;n++){let o=e[n];i.push(new qt(o.from+t,o.to+t,o.type))}return i}function tF(e,t,i,n,o,s,r){function a(l,d){for(let c=0;c<l.local.length;c++){let u=l.local[c].map(n,o,d);u?i.push(u):r.onRemove&&r.onRemove(l.local[c].spec)}for(let c=0;c<l.children.length;c+=3)a(l.children[c+2],l.children[c]+d+1)}for(let l=0;l<e.length;l+=3)e[l+1]==-1&&a(e[l+2],t[l]+s+1);return i}function Ky(e,t,i){if(t.isLeaf)return null;let n=i+t.nodeSize,o=null;for(let s=0,r;s<e.length;s++)(r=e[s])&&r.from>i&&r.to<n&&((o||(o=[])).push(r),e[s]=null);return o}function Yy(e){let t=[];for(let i=0;i<e.length;i++)e[i]!=null&&t.push(e[i]);return t}function fc(e,t,i,n){let o=[],s=!1;t.forEach((a,l)=>{let d=Ky(e,a,l+i);if(d){s=!0;let c=fc(d,a,i+l+1,n);c!=Wt&&o.push(l,l+a.nodeSize,c)}});let r=jy(s?Yy(e):e,-i).sort(Ss);for(let a=0;a<r.length;a++)r[a].type.valid(t,r[a])||(n.onRemove&&n.onRemove(r[a].spec),r.splice(a--,1));return r.length||o.length?new dt(r,o):Wt}function Ss(e,t){return e.from-t.from||e.to-t.to}function Pf(e){let t=e;for(let i=0;i<t.length-1;i++){let n=t[i];if(n.from!=n.to)for(let o=i+1;o<t.length;o++){let s=t[o];if(s.from==n.from){s.to!=n.to&&(t==e&&(t=e.slice()),t[o]=s.copy(s.from,n.to),dy(t,o+1,s.copy(n.to,s.to)));continue}else{s.from<n.to&&(t==e&&(t=e.slice()),t[i]=n.copy(n.from,s.from),dy(t,o,n.copy(s.from,n.to)));break}}}return t}function dy(e,t,i){for(;t<e.length&&Ss(i,e[t])>0;)t++;e.splice(t,0,i)}function Qg(e){let t=[];return e.someProp("decorations",i=>{let n=i(e.state);n&&n!=Wt&&t.push(n)}),e.cursorWrapper&&t.push(dt.create(e.state.doc,[e.cursorWrapper.deco])),gc.from(t)}var iF={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},nF=di&&Ro<=11,Cf=class{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}},vf=class{constructor(t,i){this.view=t,this.handleDOMChange=i,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new Cf,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(n=>{for(let o=0;o<n.length;o++)this.queue.push(n[o]);di&&Ro<=11&&n.some(o=>o.type=="childList"&&o.removedNodes.length||o.type=="characterData"&&o.oldValue.length>o.target.nodeValue.length)?this.flushSoon():this.flush()}),nF&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,iF)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let i=0;i<t.length;i++)this.queue.push(t[i]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(ty(this.view)){if(this.suppressingSelectionUpdates)return Bn(this.view);if(di&&Ro<=11&&!this.view.state.selection.empty){let t=this.view.domSelectionRange();if(t.focusNode&&xs(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(t){if(!t.focusNode)return!0;let i=new Set,n;for(let s=t.focusNode;s;s=Mr(s))i.add(s);for(let s=t.anchorNode;s;s=Mr(s))if(i.has(s)){n=s;break}let o=n&&this.view.docView.nearestDesc(n);if(o&&o.ignoreMutation({type:"selection",target:n.nodeType==3?n.parentNode:n}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}flush(){let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let i=this.pendingRecords();i.length&&(this.queue=[]);let n=t.domSelectionRange(),o=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&ty(t)&&!this.ignoreSelectionChange(n),s=-1,r=-1,a=!1,l=[];if(t.editable)for(let c=0;c<i.length;c++){let u=this.registerMutation(i[c],l);u&&(s=s<0?u.from:Math.min(u.from,s),r=r<0?u.to:Math.max(u.to,r),u.typeOver&&(a=!0))}if(Mi&&l.length){let c=l.filter(u=>u.nodeName=="BR");if(c.length==2){let[u,h]=c;u.parentNode&&u.parentNode.parentNode==h.parentNode?h.remove():u.remove()}else{let{focusNode:u}=this.currentSelection;for(let h of c){let p=h.parentNode;p&&p.nodeName=="LI"&&(!u||rF(t,u)!=p)&&h.remove()}}}let d=null;s<0&&o&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&mc(n)&&(d=bf(t))&&d.eq(de.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,Bn(t),this.currentSelection.set(n),t.scrollToSelection()):(s>-1||o)&&(s>-1&&(t.docView.markDirty(s,r),oF(t)),this.handleDOMChange(s,r,a,l),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(n)||Bn(t),this.currentSelection.set(n))}registerMutation(t,i){if(i.indexOf(t.target)>-1)return null;let n=this.view.docView.nearestDesc(t.target);if(t.type=="attributes"&&(n==this.view.docView||t.attributeName=="contenteditable"||t.attributeName=="style"&&!t.oldValue&&!t.target.getAttribute("style"))||!n||n.ignoreMutation(t))return null;if(t.type=="childList"){for(let c=0;c<t.addedNodes.length;c++){let u=t.addedNodes[c];i.push(u),u.nodeType==3&&(this.lastChangedTextNode=u)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(t.target))return{from:n.posBefore,to:n.posAfter};let o=t.previousSibling,s=t.nextSibling;if(di&&Ro<=11&&t.addedNodes.length)for(let c=0;c<t.addedNodes.length;c++){let{previousSibling:u,nextSibling:h}=t.addedNodes[c];(!u||Array.prototype.indexOf.call(t.addedNodes,u)<0)&&(o=u),(!h||Array.prototype.indexOf.call(t.addedNodes,h)<0)&&(s=h)}let r=o&&o.parentNode==t.target?At(o)+1:0,a=n.localPosFromDOM(t.target,r,-1),l=s&&s.parentNode==t.target?At(s):t.target.childNodes.length,d=n.localPosFromDOM(t.target,l,1);return{from:a,to:d}}else return t.type=="attributes"?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=t.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:t.target.nodeValue==t.oldValue})}},cy=new WeakMap,uy=!1;function oF(e){if(!cy.has(e)&&(cy.set(e,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace)!==-1)){if(e.requiresGeckoHackNode=Mi,uy)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),uy=!0}}function hy(e,t){let i=t.startContainer,n=t.startOffset,o=t.endContainer,s=t.endOffset,r=e.domAtPos(e.state.selection.anchor);return xs(r.node,r.offset,o,s)&&([i,n,o,s]=[o,s,i,n]),{anchorNode:i,anchorOffset:n,focusNode:o,focusOffset:s}}function sF(e,t){if(t.getComposedRanges){let o=t.getComposedRanges(e.root)[0];if(o)return hy(e,o)}let i;function n(o){o.preventDefault(),o.stopImmediatePropagation(),i=o.getTargetRanges()[0]}return e.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",n,!0),i?hy(e,i):null}function rF(e,t){for(let i=t.parentNode;i&&i!=e.dom;i=i.parentNode){let n=e.docView.nearestDesc(i,!0);if(n&&n.node.isBlock)return i}return null}function aF(e,t,i){let{node:n,fromOffset:o,toOffset:s,from:r,to:a}=e.docView.parseRange(t,i),l=e.domSelectionRange(),d,c=l.anchorNode;if(c&&e.dom.contains(c.nodeType==1?c:c.parentNode)&&(d=[{node:c,offset:l.anchorOffset}],mc(l)||d.push({node:l.focusNode,offset:l.focusOffset})),Ut&&e.input.lastKeyCode===8)for(let m=s;m>o;m--){let C=n.childNodes[m-1],v=C.pmViewDesc;if(C.nodeName=="BR"&&!v){s=m;break}if(!v||v.size)break}let u=e.state.doc,h=e.someProp("domParser")||en.fromSchema(e.state.schema),p=u.resolve(r),g=null,f=h.parse(n,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:o,to:s,preserveWhitespace:p.parent.type.whitespace=="pre"?"full":!0,findPositions:d,ruleFromNode:lF,context:p});if(d&&d[0].pos!=null){let m=d[0].pos,C=d[1]&&d[1].pos;C==null&&(C=m),g={anchor:m+r,head:C+r}}return{doc:f,sel:g,from:r,to:a}}function lF(e){let t=e.pmViewDesc;if(t)return t.parseRule();if(e.nodeName=="BR"&&e.parentNode){if(ei&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let i=document.createElement("div");return i.appendChild(document.createElement("li")),{skip:i}}else if(e.parentNode.lastChild==e||ei&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if(e.nodeName=="IMG"&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}var dF=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function cF(e,t,i,n,o){let s=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,t<0){let E=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,T=bf(e,E);if(T&&!e.state.selection.eq(T)){if(Ut&&Nn&&e.input.lastKeyCode===13&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",O=>O(e,Cs(13,"Enter"))))return;let L=e.state.tr.setSelection(T);E=="pointer"?L.setMeta("pointer",!0):E=="key"&&L.scrollIntoView(),s&&L.setMeta("composition",s),e.dispatch(L)}return}let r=e.state.doc.resolve(t),a=r.sharedDepth(i);t=r.before(a+1),i=e.state.doc.resolve(i).after(a+1);let l=e.state.selection,d=aF(e,t,i),c=e.state.doc,u=c.slice(d.from,d.to),h,p;e.input.lastKeyCode===8&&Date.now()-100<e.input.lastKeyCodeTime?(h=e.state.selection.to,p="end"):(h=e.state.selection.from,p="start"),e.input.lastKeyCode=null;let g=pF(u.content,d.doc.content,d.from,h,p);if(g&&e.input.domChangeCount++,(kr&&e.input.lastIOSEnter>Date.now()-225||Nn)&&o.some(E=>E.nodeType==1&&!dF.test(E.nodeName))&&(!g||g.endA>=g.endB)&&e.someProp("handleKeyDown",E=>E(e,Cs(13,"Enter")))){e.input.lastIOSEnter=0;return}if(!g)if(n&&l instanceof ne&&!l.empty&&l.$head.sameParent(l.$anchor)&&!e.composing&&!(d.sel&&d.sel.anchor!=d.sel.head))g={start:l.from,endA:l.to,endB:l.to};else{if(d.sel){let E=py(e,e.state.doc,d.sel);if(E&&!E.eq(e.state.selection)){let T=e.state.tr.setSelection(E);s&&T.setMeta("composition",s),e.dispatch(T)}}return}e.state.selection.from<e.state.selection.to&&g.start==g.endB&&e.state.selection instanceof ne&&(g.start>e.state.selection.from&&g.start<=e.state.selection.from+2&&e.state.selection.from>=d.from?g.start=e.state.selection.from:g.endA<e.state.selection.to&&g.endA>=e.state.selection.to-2&&e.state.selection.to<=d.to&&(g.endB+=e.state.selection.to-g.endA,g.endA=e.state.selection.to)),di&&Ro<=11&&g.endB==g.start+1&&g.endA==g.start&&g.start>d.from&&d.doc.textBetween(g.start-d.from-1,g.start-d.from+1)==" \xA0"&&(g.start--,g.endA--,g.endB--);let f=d.doc.resolveNoCache(g.start-d.from),m=d.doc.resolveNoCache(g.endB-d.from),C=c.resolve(g.start),v=f.sameParent(m)&&f.parent.inlineContent&&C.end()>=g.endA;if((kr&&e.input.lastIOSEnter>Date.now()-225&&(!v||o.some(E=>E.nodeName=="DIV"||E.nodeName=="P"))||!v&&f.pos<d.doc.content.size&&(!f.sameParent(m)||!f.parent.inlineContent)&&f.pos<m.pos&&!/\S/.test(d.doc.textBetween(f.pos,m.pos,"","")))&&e.someProp("handleKeyDown",E=>E(e,Cs(13,"Enter")))){e.input.lastIOSEnter=0;return}if(e.state.selection.anchor>g.start&&hF(c,g.start,g.endA,f,m)&&e.someProp("handleKeyDown",E=>E(e,Cs(8,"Backspace")))){Nn&&Ut&&e.domObserver.suppressSelectionUpdates();return}Ut&&g.endB==g.start&&(e.input.lastChromeDelete=Date.now()),Nn&&!v&&f.start()!=m.start()&&m.parentOffset==0&&f.depth==m.depth&&d.sel&&d.sel.anchor==d.sel.head&&d.sel.head==g.endA&&(g.endB-=2,m=d.doc.resolveNoCache(g.endB-d.from),setTimeout(()=>{e.someProp("handleKeyDown",function(E){return E(e,Cs(13,"Enter"))})},20));let w=g.start,y=g.endA,S=E=>{let T=E||e.state.tr.replace(w,y,d.doc.slice(g.start-d.from,g.endB-d.from));if(d.sel){let L=py(e,T.doc,d.sel);L&&!(Ut&&e.composing&&L.empty&&(g.start!=g.endB||e.input.lastChromeDelete<Date.now()-100)&&(L.head==w||L.head==T.mapping.map(y)-1)||di&&L.empty&&L.head==w)&&T.setSelection(L)}return s&&T.setMeta("composition",s),T.scrollIntoView()},x;if(v)if(f.pos==m.pos){di&&Ro<=11&&f.parentOffset==0&&(e.domObserver.suppressSelectionUpdates(),setTimeout(()=>Bn(e),20));let E=S(e.state.tr.delete(w,y)),T=c.resolve(g.start).marksAcross(c.resolve(g.endA));T&&E.ensureMarks(T),e.dispatch(E)}else if(g.endA==g.endB&&(x=uF(f.parent.content.cut(f.parentOffset,m.parentOffset),C.parent.content.cut(C.parentOffset,g.endA-C.start())))){let E=S(e.state.tr);x.type=="add"?E.addMark(w,y,x.mark):E.removeMark(w,y,x.mark),e.dispatch(E)}else if(f.parent.child(f.index()).isText&&f.index()==m.index()-(m.textOffset?0:1)){let E=f.parent.textBetween(f.parentOffset,m.parentOffset),T=()=>S(e.state.tr.insertText(E,w,y));e.someProp("handleTextInput",L=>L(e,w,y,E,T))||e.dispatch(T())}else e.dispatch(S());else e.dispatch(S())}function py(e,t,i){return Math.max(i.anchor,i.head)>t.content.size?null:yf(e,t.resolve(i.anchor),t.resolve(i.head))}function uF(e,t){let i=e.firstChild.marks,n=t.firstChild.marks,o=i,s=n,r,a,l;for(let c=0;c<n.length;c++)o=n[c].removeFromSet(o);for(let c=0;c<i.length;c++)s=i[c].removeFromSet(s);if(o.length==1&&s.length==0)a=o[0],r="add",l=c=>c.mark(a.addToSet(c.marks));else if(o.length==0&&s.length==1)a=s[0],r="remove",l=c=>c.mark(a.removeFromSet(c.marks));else return null;let d=[];for(let c=0;c<t.childCount;c++)d.push(l(t.child(c)));if(N.from(d).eq(e))return{mark:a,type:r}}function hF(e,t,i,n,o){if(i-t<=o.pos-n.pos||Zg(n,!0,!1)<o.pos)return!1;let s=e.resolve(t);if(!n.parent.isTextblock){let a=s.nodeAfter;return a!=null&&i==t+a.nodeSize}if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let r=e.resolve(Zg(s,!0,!0));return!r.parent.isTextblock||r.pos>i||Zg(r,!0,!1)<i?!1:n.parent.content.cut(n.parentOffset).eq(r.parent.content)}function Zg(e,t,i){let n=e.depth,o=t?e.end():e.pos;for(;n>0&&(t||e.indexAfter(n)==e.node(n).childCount);)n--,o++,t=!1;if(i){let s=e.node(n).maybeChild(e.indexAfter(n));for(;s&&!s.isLeaf;)s=s.firstChild,o++}return o}function pF(e,t,i,n,o){let s=e.findDiffStart(t,i);if(s==null)return null;let{a:r,b:a}=e.findDiffEnd(t,i+e.size,i+t.size);if(o=="end"){let l=Math.max(0,s-Math.min(r,a));n-=r+l-s}if(r<s&&e.size<t.size){let l=n<=s&&n>=r?s-n:0;s-=l,s&&s<t.size&&gy(t.textBetween(s-1,s+1))&&(s+=l?1:-1),a=s+(a-r),r=s}else if(a<s){let l=n<=s&&n>=a?s-n:0;s-=l,s&&s<e.size&&gy(e.textBetween(s-1,s+1))&&(s+=l?1:-1),r=s+(r-a),a=s}return{start:s,endA:r,endB:a}}function gy(e){if(e.length!=2)return!1;let t=e.charCodeAt(0),i=e.charCodeAt(1);return t>=56320&&t<=57343&&i>=55296&&i<=56319}var Qa=class{constructor(t,i){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new pf,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=i,this.state=i.state,this.directPlugins=i.plugins||[],this.directPlugins.forEach(wy),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):typeof t=="function"?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=Cy(this),my(this),this.nodeViews=vy(this),this.docView=Yb(this.state.doc,fy(this),Qg(this),this.dom,this),this.domObserver=new vf(this,(n,o,s,r)=>cF(this,n,o,s,r)),this.domObserver.start(),OD(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let i in t)this._props[i]=t[i];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&gf(this);let i=this._props;this._props=t,t.plugins&&(t.plugins.forEach(wy),this.directPlugins=t.plugins),this.updateStateInner(t.state,i)}setProps(t){let i={};for(let n in this._props)i[n]=this._props[n];i.state=this.state;for(let n in t)i[n]=t[n];this.update(i)}updateState(t){this.updateStateInner(t,this._props)}updateStateInner(t,i){var n;let o=this.state,s=!1,r=!1;t.storedMarks&&this.composing&&(Uy(this),r=!0),this.state=t;let a=o.plugins!=t.plugins||this._props.plugins!=i.plugins;if(a||this._props.plugins!=i.plugins||this._props.nodeViews!=i.nodeViews){let p=vy(this);fF(p,this.nodeViews)&&(this.nodeViews=p,s=!0)}(a||i.handleDOMEvents!=this._props.handleDOMEvents)&&gf(this),this.editable=Cy(this),my(this);let l=Qg(this),d=fy(this),c=o.plugins!=t.plugins&&!o.doc.eq(t.doc)?"reset":t.scrollToSelection>o.scrollToSelection?"to selection":"preserve",u=s||!this.docView.matchesNode(t.doc,d,l);(u||!t.selection.eq(o.selection))&&(r=!0);let h=c=="preserve"&&r&&this.dom.style.overflowAnchor==null&&eD(this);if(r){this.domObserver.stop();let p=u&&(di||Ut)&&!this.composing&&!o.selection.empty&&!t.selection.empty&&gF(o.selection,t.selection);if(u){let g=Ut?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=KD(this)),(s||!this.docView.update(t.doc,d,l,this))&&(this.docView.updateOuterDeco(d),this.docView.destroy(),this.docView=Yb(t.doc,d,l,this.dom,this)),g&&!this.trackWrites&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&yD(this))?Bn(this,p):(Ay(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(o),!((n=this.dragging)===null||n===void 0)&&n.node&&!o.doc.eq(t.doc)&&this.updateDraggedNode(this.dragging,o),c=="reset"?this.dom.scrollTop=0:c=="to selection"?this.scrollToSelection():h&&tD(h)}scrollToSelection(){let t=this.domSelectionRange().focusNode;if(!(!t||!this.dom.contains(t.nodeType==1?t:t.parentNode))){if(!this.someProp("handleScrollToSelection",i=>i(this)))if(this.state.selection instanceof J){let i=this.docView.domAfterPos(this.state.selection.from);i.nodeType==1&&Wb(this,i.getBoundingClientRect(),t)}else Wb(this,this.coordsAtPos(this.state.selection.head,1),t)}}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(!t||t.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let i=0;i<this.directPlugins.length;i++){let n=this.directPlugins[i];n.spec.view&&this.pluginViews.push(n.spec.view(this))}for(let i=0;i<this.state.plugins.length;i++){let n=this.state.plugins[i];n.spec.view&&this.pluginViews.push(n.spec.view(this))}}else for(let i=0;i<this.pluginViews.length;i++){let n=this.pluginViews[i];n.update&&n.update(this,t)}}updateDraggedNode(t,i){let n=t.node,o=-1;if(this.state.doc.nodeAt(n.from)==n.node)o=n.from;else{let s=n.from+(this.state.doc.content.size-i.doc.content.size);(s>0&&this.state.doc.nodeAt(s))==n.node&&(o=s)}this.dragging=new hc(t.slice,t.move,o<0?void 0:J.create(this.state.doc,o))}someProp(t,i){let n=this._props&&this._props[t],o;if(n!=null&&(o=i?i(n):n))return o;for(let r=0;r<this.directPlugins.length;r++){let a=this.directPlugins[r].props[t];if(a!=null&&(o=i?i(a):a))return o}let s=this.state.plugins;if(s)for(let r=0;r<s.length;r++){let a=s[r].props[t];if(a!=null&&(o=i?i(a):a))return o}}hasFocus(){if(di){let t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if(t.contentEditable=="false")return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&iD(this.dom),Bn(this),this.domObserver.start()}get root(){let t=this._root;if(t==null){for(let i=this.dom.parentNode;i;i=i.parentNode)if(i.nodeType==9||i.nodeType==11&&i.host)return i.getSelection||(Object.getPrototypeOf(i).getSelection=()=>i.ownerDocument.getSelection()),this._root=i}return t||document}updateRoot(){this._root=null}posAtCoords(t){return aD(this,t)}coordsAtPos(t,i=1){return Py(this,t,i)}domAtPos(t,i=0){return this.docView.domFromPos(t,i)}nodeDOM(t){let i=this.docView.descAt(t);return i?i.nodeDOM:null}posAtDOM(t,i,n=-1){let o=this.docView.posFromDOM(t,i,n);if(o==null)throw new RangeError("DOM position not inside the editor");return o}endOfTextblock(t,i){return hD(this,i||this.state,t)}pasteHTML(t,i){return Xa(this,"",t,!1,i||new ClipboardEvent("paste"))}pasteText(t,i){return Xa(this,t,null,!0,i||new ClipboardEvent("paste"))}serializeForClipboard(t){return Sf(this,t)}destroy(){this.docView&&(ND(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Qg(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,Wk())}get isDestroyed(){return this.docView==null}dispatchEvent(t){return HD(this,t)}domSelectionRange(){let t=this.domSelection();return t?ei&&this.root.nodeType===11&&Kk(this.dom.ownerDocument)==this.dom&&sF(this,t)||t:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}};Qa.prototype.dispatch=function(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))};function fy(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",i=>{if(typeof i=="function"&&(i=i(e.state)),i)for(let n in i)n=="class"?t.class+=" "+i[n]:n=="style"?t.style=(t.style?t.style+";":"")+i[n]:!t[n]&&n!="contenteditable"&&n!="nodeName"&&(t[n]=String(i[n]))}),t.translate||(t.translate="no"),[qt.node(0,e.state.doc.content.size,t)]}function my(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:qt.widget(e.state.selection.from,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function Cy(e){return!e.someProp("editable",t=>t(e.state)===!1)}function gF(e,t){let i=Math.min(e.$anchor.sharedDepth(e.head),t.$anchor.sharedDepth(t.head));return e.$anchor.start(i)!=t.$anchor.start(i)}function vy(e){let t=Object.create(null);function i(n){for(let o in n)Object.prototype.hasOwnProperty.call(t,o)||(t[o]=n[o])}return e.someProp("nodeViews",i),e.someProp("markViews",i),t}function fF(e,t){let i=0,n=0;for(let o in e){if(e[o]!=t[o])return!0;i++}for(let o in t)n++;return i!=n}function wy(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Hn={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},wc={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},mF=typeof navigator<"u"&&/Mac/.test(navigator.platform),CF=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(Ct=0;Ct<10;Ct++)Hn[48+Ct]=Hn[96+Ct]=String(Ct);var Ct;for(Ct=1;Ct<=24;Ct++)Hn[Ct+111]="F"+Ct;var Ct;for(Ct=65;Ct<=90;Ct++)Hn[Ct]=String.fromCharCode(Ct+32),wc[Ct]=String.fromCharCode(Ct);var Ct;for(vc in Hn)wc.hasOwnProperty(vc)||(wc[vc]=Hn[vc]);var vc;function Xy(e){var t=mF&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||CF&&e.shiftKey&&e.key&&e.key.length==1||e.key=="Unidentified",i=!t&&e.key||(e.shiftKey?wc:Hn)[e.keyCode]||e.key||"Unidentified";return i=="Esc"&&(i="Escape"),i=="Del"&&(i="Delete"),i=="Left"&&(i="ArrowLeft"),i=="Up"&&(i="ArrowUp"),i=="Right"&&(i="ArrowRight"),i=="Down"&&(i="ArrowDown"),i}var vF=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),wF=typeof navigator<"u"&&/Win/.test(navigator.platform);function bF(e){let t=e.split(/-(?!$)/),i=t[t.length-1];i=="Space"&&(i=" ");let n,o,s,r;for(let a=0;a<t.length-1;a++){let l=t[a];if(/^(cmd|meta|m)$/i.test(l))r=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))o=!0;else if(/^s(hift)?$/i.test(l))s=!0;else if(/^mod$/i.test(l))vF?r=!0:o=!0;else throw new Error("Unrecognized modifier name: "+l)}return n&&(i="Alt-"+i),o&&(i="Ctrl-"+i),r&&(i="Meta-"+i),s&&(i="Shift-"+i),i}function yF(e){let t=Object.create(null);for(let i in e)t[bF(i)]=e[i];return t}function Mf(e,t,i=!0){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),i&&t.shiftKey&&(e="Shift-"+e),e}function Jy(e){return new he({props:{handleKeyDown:kf(e)}})}function kf(e){let t=yF(e);return function(i,n){let o=Xy(n),s,r=t[Mf(o,n)];if(r&&r(i.state,i.dispatch,i))return!0;if(o.length==1&&o!=" "){if(n.shiftKey){let a=t[Mf(o,n,!1)];if(a&&a(i.state,i.dispatch,i))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(wF&&n.ctrlKey&&n.altKey)&&(s=Hn[n.keyCode])&&s!=o){let a=t[Mf(s,n)];if(a&&a(i.state,i.dispatch,i))return!0}}return!1}}var SF=Object.defineProperty,_f=(e,t)=>{for(var i in t)SF(e,i,{get:t[i],enumerable:!0})};function Mc(e){let{state:t,transaction:i}=e,{selection:n}=i,{doc:o}=i,{storedMarks:s}=i;return _(b({},t),{apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return s},get selection(){return n},get doc(){return o},get tr(){return n=i.selection,o=i.doc,s=i.storedMarks,i}})}var kc=class{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){let{rawCommands:e,editor:t,state:i}=this,{view:n}=t,{tr:o}=i,s=this.buildProps(o);return Object.fromEntries(Object.entries(e).map(([r,a])=>[r,(...d)=>{let c=a(...d)(s);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&n.dispatch(o),c}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){let{rawCommands:i,editor:n,state:o}=this,{view:s}=n,r=[],a=!!e,l=e||o.tr,d=()=>(!a&&t&&!l.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(l),r.every(u=>u===!0)),c=_(b({},Object.fromEntries(Object.entries(i).map(([u,h])=>[u,(...g)=>{let f=this.buildProps(l,t),m=h(...g)(f);return r.push(m),c}]))),{run:d});return c}createCan(e){let{rawCommands:t,state:i}=this,n=!1,o=e||i.tr,s=this.buildProps(o,n),r=Object.fromEntries(Object.entries(t).map(([a,l])=>[a,(...d)=>l(...d)(_(b({},s),{dispatch:void 0}))]));return _(b({},r),{chain:()=>this.createChain(o,n)})}buildProps(e,t=!0){let{rawCommands:i,editor:n,state:o}=this,{view:s}=n,r={tr:e,editor:n,view:s,state:Mc({state:o,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(i).map(([a,l])=>[a,(...d)=>l(...d)(r)]))}};return r}},aS={};_f(aS,{blur:()=>xF,clearContent:()=>EF,clearNodes:()=>RF,command:()=>PF,createParagraphNear:()=>MF,cut:()=>kF,deleteCurrentNode:()=>DF,deleteNode:()=>FF,deleteRange:()=>TF,deleteSelection:()=>AF,enter:()=>IF,exitCode:()=>LF,extendMarkRange:()=>_F,first:()=>OF,focus:()=>BF,forEach:()=>HF,insertContent:()=>GF,insertContentAt:()=>WF,joinBackward:()=>$F,joinDown:()=>qF,joinForward:()=>jF,joinItemBackward:()=>KF,joinItemForward:()=>YF,joinTextblockBackward:()=>XF,joinTextblockForward:()=>JF,joinUp:()=>UF,keyboardShortcut:()=>ZF,lift:()=>e5,liftEmptyBlock:()=>t5,liftListItem:()=>i5,newlineInCode:()=>n5,resetAttributes:()=>o5,scrollIntoView:()=>s5,selectAll:()=>r5,selectNodeBackward:()=>a5,selectNodeForward:()=>l5,selectParentNode:()=>d5,selectTextblockEnd:()=>c5,selectTextblockStart:()=>u5,setContent:()=>h5,setMark:()=>P5,setMeta:()=>M5,setNode:()=>k5,setNodeSelection:()=>D5,setTextDirection:()=>F5,setTextSelection:()=>T5,sinkListItem:()=>A5,splitBlock:()=>I5,splitListItem:()=>L5,toggleList:()=>_5,toggleMark:()=>O5,toggleNode:()=>N5,toggleWrap:()=>B5,undoInputRule:()=>H5,unsetAllMarks:()=>G5,unsetMark:()=>V5,unsetTextDirection:()=>z5,updateAttributes:()=>W5,wrapIn:()=>U5,wrapInList:()=>q5});var xF=()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var i;e.isDestroyed||(t.dom.blur(),(i=window?.getSelection())==null||i.removeAllRanges())}),!0),EF=(e=!0)=>({commands:t})=>t.setContent("",{emitUpdate:e}),RF=()=>({state:e,tr:t,dispatch:i})=>{let{selection:n}=t,{ranges:o}=n;return i&&o.forEach(({$from:s,$to:r})=>{e.doc.nodesBetween(s.pos,r.pos,(a,l)=>{if(a.type.isText)return;let{doc:d,mapping:c}=t,u=d.resolve(c.map(l)),h=d.resolve(c.map(l+a.nodeSize)),p=u.blockRange(h);if(!p)return;let g=Ln(p);if(a.type.isTextblock){let{defaultType:f}=u.parent.contentMatchAt(u.index());t.setNodeMarkup(p.start,f)}(g||g===0)&&t.lift(p,g)})}),!0},PF=e=>t=>e(t),MF=()=>({state:e,dispatch:t})=>Wg(e,t),kF=(e,t)=>({editor:i,tr:n})=>{let{state:o}=i,s=o.doc.slice(e.from,e.to);n.deleteRange(e.from,e.to);let r=n.mapping.map(t);return n.insert(r,s.content),n.setSelection(new ne(n.doc.resolve(Math.max(r-1,0)))),!0},DF=()=>({tr:e,dispatch:t})=>{let{selection:i}=e,n=i.$anchor.node();if(n.content.size>0)return!1;let o=e.selection.$anchor;for(let s=o.depth;s>0;s-=1)if(o.node(s).type===n.type){if(t){let a=o.before(s),l=o.after(s);e.delete(a,l).scrollIntoView()}return!0}return!1};function st(e,t){if(typeof e=="string"){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}var FF=e=>({tr:t,state:i,dispatch:n})=>{let o=st(e,i.schema),s=t.selection.$anchor;for(let r=s.depth;r>0;r-=1)if(s.node(r).type===o){if(n){let l=s.before(r),d=s.after(r);t.delete(l,d).scrollIntoView()}return!0}return!1},TF=e=>({tr:t,dispatch:i})=>{let{from:n,to:o}=e;return i&&t.delete(n,o),!0},AF=()=>({state:e,dispatch:t})=>sc(e,t),IF=()=>({commands:e})=>e.keyboardShortcut("Enter"),LF=()=>({state:e,dispatch:t})=>zg(e,t);function Of(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function Rc(e,t,i={strict:!0}){let n=Object.keys(t);return n.length?n.every(o=>i.strict?t[o]===e[o]:Of(t[o])?t[o].test(e[o]):t[o]===e[o]):!0}function lS(e,t,i={}){return e.find(n=>n.type===t&&Rc(Object.fromEntries(Object.keys(i).map(o=>[o,n.attrs[o]])),i))}function Qy(e,t,i={}){return!!lS(e,t,i)}function Nf(e,t,i){var n;if(!e||!t)return;let o=e.parent.childAfter(e.parentOffset);if((!o.node||!o.node.marks.some(c=>c.type===t))&&(o=e.parent.childBefore(e.parentOffset)),!o.node||!o.node.marks.some(c=>c.type===t)||(i=i||((n=o.node.marks[0])==null?void 0:n.attrs),!lS([...o.node.marks],t,i)))return;let r=o.index,a=e.start()+o.offset,l=r+1,d=a+o.node.nodeSize;for(;r>0&&Qy([...e.parent.child(r-1).marks],t,i);)r-=1,a-=e.parent.child(r).nodeSize;for(;l<e.parent.childCount&&Qy([...e.parent.child(l).marks],t,i);)d+=e.parent.child(l).nodeSize,l+=1;return{from:a,to:d}}function Gn(e,t){if(typeof e=="string"){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}var _F=(e,t={})=>({tr:i,state:n,dispatch:o})=>{let s=Gn(e,n.schema),{doc:r,selection:a}=i,{$from:l,from:d,to:c}=a;if(o){let u=Nf(l,s,t);if(u&&u.from<=d&&u.to>=c){let h=ne.create(r,u.from,u.to);i.setSelection(h)}}return!0},OF=e=>t=>{let i=typeof e=="function"?e(t):e;for(let n=0;n<i.length;n+=1)if(i[n](t))return!0;return!1};function dS(e){return e instanceof ne}function Rs(e=0,t=0,i=0){return Math.min(Math.max(e,t),i)}function cS(e,t=null){if(!t)return null;let i=de.atStart(e),n=de.atEnd(e);if(t==="start"||t===!0)return i;if(t==="end")return n;let o=i.from,s=n.to;return t==="all"?ne.create(e,Rs(0,o,s),Rs(e.content.size,o,s)):ne.create(e,Rs(t,o,s),Rs(t,o,s))}function NF(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function Bf(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var BF=(e=null,t={})=>({editor:i,view:n,tr:o,dispatch:s})=>{t=b({scrollIntoView:!0},t);let r=()=>{(Bf()||NF())&&n.dom.focus(),requestAnimationFrame(()=>{i.isDestroyed||(n.focus(),t?.scrollIntoView&&i.commands.scrollIntoView())})};if(n.hasFocus()&&e===null||e===!1)return!0;if(s&&e===null&&!dS(i.state.selection))return r(),!0;let a=cS(o.doc,e)||i.state.selection,l=i.state.selection.eq(a);return s&&(l||o.setSelection(a),l&&o.storedMarks&&o.setStoredMarks(o.storedMarks),r()),!0},HF=(e,t)=>i=>e.every((n,o)=>t(n,_(b({},i),{index:o}))),GF=(e,t)=>({tr:i,commands:n})=>n.insertContentAt({from:i.selection.from,to:i.selection.to},e,t),uS=e=>{let t=e.childNodes;for(let i=t.length-1;i>=0;i-=1){let n=t[i];n.nodeType===3&&n.nodeValue&&/^(\n\s\s|\n)$/.test(n.nodeValue)?e.removeChild(n):n.nodeType===1&&uS(n)}return e};function bc(e){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");let t=`<body>${e}</body>`,i=new window.DOMParser().parseFromString(t,"text/html").body;return uS(i)}function tl(e,t,i){if(e instanceof li||e instanceof N)return e;i=b({slice:!0,parseOptions:{}},i);let n=typeof e=="object"&&e!==null,o=typeof e=="string";if(n)try{if(Array.isArray(e)&&e.length>0)return N.fromArray(e.map(a=>t.nodeFromJSON(a)));let r=t.nodeFromJSON(e);return i.errorOnInvalidContent&&r.check(),r}catch(s){if(i.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:s});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",s),tl("",t,i)}if(o){if(i.errorOnInvalidContent){let r=!1,a="",l=new mr({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:d=>(r=!0,a=typeof d=="string"?d:d.outerHTML,null)}]}})});if(i.slice?en.fromSchema(l).parseSlice(bc(e),i.parseOptions):en.fromSchema(l).parse(bc(e),i.parseOptions),i.errorOnInvalidContent&&r)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}let s=en.fromSchema(t);return i.slice?s.parseSlice(bc(e),i.parseOptions).content:s.parse(bc(e),i.parseOptions)}return tl("",t,i)}function VF(e,t,i){let n=e.steps.length-1;if(n<t)return;let o=e.steps[n];if(!(o instanceof zt||o instanceof mt))return;let s=e.mapping.maps[n],r=0;s.forEach((a,l,d,c)=>{r===0&&(r=c)}),e.setSelection(de.near(e.doc.resolve(r),i))}var zF=e=>!("type"in e),WF=(e,t,i)=>({tr:n,dispatch:o,editor:s})=>{var r;if(o){i=b({parseOptions:s.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1},i);let a,l=m=>{s.emit("contentError",{editor:s,error:m,disableCollaboration:()=>{"collaboration"in s.storage&&typeof s.storage.collaboration=="object"&&s.storage.collaboration&&(s.storage.collaboration.isDisabled=!0)}})},d=b({preserveWhitespace:"full"},i.parseOptions);if(!i.errorOnInvalidContent&&!s.options.enableContentCheck&&s.options.emitContentError)try{tl(t,s.schema,{parseOptions:d,errorOnInvalidContent:!0})}catch(m){l(m)}try{a=tl(t,s.schema,{parseOptions:d,errorOnInvalidContent:(r=i.errorOnInvalidContent)!=null?r:s.options.enableContentCheck})}catch(m){return l(m),!1}let{from:c,to:u}=typeof e=="number"?{from:e,to:e}:{from:e.from,to:e.to},h=!0,p=!0;if((zF(a)?a:[a]).forEach(m=>{m.check(),h=h?m.isText&&m.marks.length===0:!1,p=p?m.isBlock:!1}),c===u&&p){let{parent:m}=n.doc.resolve(c);m.isTextblock&&!m.type.spec.code&&!m.childCount&&(c-=1,u+=1)}let f;if(h){if(Array.isArray(t))f=t.map(m=>m.text||"").join("");else if(t instanceof N){let m="";t.forEach(C=>{C.text&&(m+=C.text)}),f=m}else typeof t=="object"&&t&&t.text?f=t.text:f=t;n.insertText(f,c,u)}else{f=a;let m=n.doc.resolve(c),C=m.node(),v=m.parentOffset===0,w=C.isText||C.isTextblock,y=C.content.size>0;v&&w&&y&&(c=Math.max(0,c-1)),n.replaceWith(c,u,f)}i.updateSelection&&VF(n,n.steps.length-1,-1),i.applyInputRules&&n.setMeta("applyInputRules",{from:c,text:f}),i.applyPasteRules&&n.setMeta("applyPasteRules",{from:c,text:f})}return!0},UF=()=>({state:e,dispatch:t})=>Tb(e,t),qF=()=>({state:e,dispatch:t})=>Ab(e,t),$F=()=>({state:e,dispatch:t})=>Lg(e,t),jF=()=>({state:e,dispatch:t})=>Ng(e,t),KF=()=>({state:e,dispatch:t,tr:i})=>{try{let n=fs(e.doc,e.selection.$from.pos,-1);return n==null?!1:(i.join(n,2),t&&t(i),!0)}catch{return!1}},YF=()=>({state:e,dispatch:t,tr:i})=>{try{let n=fs(e.doc,e.selection.$from.pos,1);return n==null?!1:(i.join(n,2),t&&t(i),!0)}catch{return!1}},XF=()=>({state:e,dispatch:t})=>Mb(e,t),JF=()=>({state:e,dispatch:t})=>kb(e,t);function hS(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function QF(e){let t=e.split(/-(?!$)/),i=t[t.length-1];i==="Space"&&(i=" ");let n,o,s,r;for(let a=0;a<t.length-1;a+=1){let l=t[a];if(/^(cmd|meta|m)$/i.test(l))r=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))o=!0;else if(/^s(hift)?$/i.test(l))s=!0;else if(/^mod$/i.test(l))Bf()||hS()?r=!0:o=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return n&&(i=`Alt-${i}`),o&&(i=`Ctrl-${i}`),r&&(i=`Meta-${i}`),s&&(i=`Shift-${i}`),i}var ZF=e=>({editor:t,view:i,tr:n,dispatch:o})=>{let s=QF(e).split(/-(?!$)/),r=s.find(d=>!["Alt","Ctrl","Meta","Shift"].includes(d)),a=new KeyboardEvent("keydown",{key:r==="Space"?" ":r,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),l=t.captureTransaction(()=>{i.someProp("handleKeyDown",d=>d(i,a))});return l?.steps.forEach(d=>{let c=d.map(n.mapping);c&&o&&n.maybeStep(c)}),!0};function on(e,t,i={}){let{from:n,to:o,empty:s}=e.selection,r=t?st(t,e.schema):null,a=[];e.doc.nodesBetween(n,o,(u,h)=>{if(u.isText)return;let p=Math.max(n,h),g=Math.min(o,h+u.nodeSize);a.push({node:u,from:p,to:g})});let l=o-n,d=a.filter(u=>r?r.name===u.node.type.name:!0).filter(u=>Rc(u.node.attrs,i,{strict:!1}));return s?!!d.length:d.reduce((u,h)=>u+h.to-h.from,0)>=l}var e5=(e,t={})=>({state:i,dispatch:n})=>{let o=st(e,i.schema);return on(i,o,t)?Ib(i,n):!1},t5=()=>({state:e,dispatch:t})=>Ug(e,t),i5=e=>({state:t,dispatch:i})=>{let n=st(e,t.schema);return Hb(n)(t,i)},n5=()=>({state:e,dispatch:t})=>Gg(e,t);function Dc(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function Zy(e,t){let i=typeof t=="string"?[t]:t;return Object.keys(e).reduce((n,o)=>(i.includes(o)||(n[o]=e[o]),n),{})}var o5=(e,t)=>({tr:i,state:n,dispatch:o})=>{let s=null,r=null,a=Dc(typeof e=="string"?e:e.name,n.schema);if(!a)return!1;a==="node"&&(s=st(e,n.schema)),a==="mark"&&(r=Gn(e,n.schema));let l=!1;return i.selection.ranges.forEach(d=>{n.doc.nodesBetween(d.$from.pos,d.$to.pos,(c,u)=>{s&&s===c.type&&(l=!0,o&&i.setNodeMarkup(u,void 0,Zy(c.attrs,t))),r&&c.marks.length&&c.marks.forEach(h=>{r===h.type&&(l=!0,o&&i.addMark(u,u+c.nodeSize,r.create(Zy(h.attrs,t))))})})}),l},s5=()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),r5=()=>({tr:e,dispatch:t})=>{if(t){let i=new Zt(e.doc);e.setSelection(i)}return!0},a5=()=>({state:e,dispatch:t})=>_g(e,t),l5=()=>({state:e,dispatch:t})=>Bg(e,t),d5=()=>({state:e,dispatch:t})=>Lb(e,t),c5=()=>({state:e,dispatch:t})=>$g(e,t),u5=()=>({state:e,dispatch:t})=>qg(e,t);function Af(e,t,i={},n={}){return tl(e,t,{slice:!1,parseOptions:i,errorOnInvalidContent:n.errorOnInvalidContent})}var h5=(e,{errorOnInvalidContent:t,emitUpdate:i=!0,parseOptions:n={}}={})=>({editor:o,tr:s,dispatch:r,commands:a})=>{let{doc:l}=s;if(n.preserveWhitespace!=="full"){let d=Af(e,o.schema,n,{errorOnInvalidContent:t??o.options.enableContentCheck});return r&&s.replaceWith(0,l.content.size,d).setMeta("preventUpdate",!i),!0}return r&&s.setMeta("preventUpdate",!i),a.insertContentAt({from:0,to:l.content.size},e,{parseOptions:n,errorOnInvalidContent:t??o.options.enableContentCheck})};function pS(e,t){let i=Gn(t,e.schema),{from:n,to:o,empty:s}=e.selection,r=[];s?(e.storedMarks&&r.push(...e.storedMarks),r.push(...e.selection.$head.marks())):e.doc.nodesBetween(n,o,l=>{r.push(...l.marks)});let a=r.find(l=>l.type.name===i.name);return a?b({},a.attrs):{}}function Hf(e,t){let i=new wr(e);return t.forEach(n=>{n.steps.forEach(o=>{i.step(o)})}),i}function p5(e){for(let t=0;t<e.edgeCount;t+=1){let{type:i}=e.edge(t);if(i.isTextblock&&!i.hasRequiredAttrs())return i}return null}function gS(e,t,i){let n=[];return e.nodesBetween(t.from,t.to,(o,s)=>{i(o)&&n.push({node:o,pos:s})}),n}function g5(e,t){for(let i=e.depth;i>0;i-=1){let n=e.node(i);if(t(n))return{pos:i>0?e.before(i):0,start:e.start(i),depth:i,node:n}}}function Fc(e){return t=>g5(t.$from,e)}function ee(e,t,i){return e.config[t]===void 0&&e.parent?ee(e.parent,t,i):typeof e.config[t]=="function"?e.config[t].bind(_(b({},i),{parent:e.parent?ee(e.parent,t,i):null})):e.config[t]}function Gf(e){return e.map(t=>{let i={name:t.name,options:t.options,storage:t.storage},n=ee(t,"addExtensions",i);return n?[t,...Gf(n())]:t}).flat(10)}function Vf(e,t){let i=Tn.fromSchema(t).serializeFragment(e),o=document.implementation.createHTMLDocument().createElement("div");return o.appendChild(i),o.innerHTML}function fS(e){return typeof e=="function"}function He(e,t=void 0,...i){return fS(e)?t?e.bind(t)(...i):e(...i):e}function f5(e={}){return Object.keys(e).length===0&&e.constructor===Object}function Tr(e){let t=e.filter(o=>o.type==="extension"),i=e.filter(o=>o.type==="node"),n=e.filter(o=>o.type==="mark");return{baseExtensions:t,nodeExtensions:i,markExtensions:n}}function mS(e){let t=[],{nodeExtensions:i,markExtensions:n}=Tr(e),o=[...i,...n],s={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(r=>{let a={name:r.name,options:r.options,storage:r.storage,extensions:o},l=ee(r,"addGlobalAttributes",a);if(!l)return;l().forEach(c=>{c.types.forEach(u=>{Object.entries(c.attributes).forEach(([h,p])=>{t.push({type:u,name:h,attribute:b(b({},s),p)})})})})}),o.forEach(r=>{let a={name:r.name,options:r.options,storage:r.storage},l=ee(r,"addAttributes",a);if(!l)return;let d=l();Object.entries(d).forEach(([c,u])=>{let h=b(b({},s),u);typeof h?.default=="function"&&(h.default=h.default()),h?.isRequired&&h?.default===void 0&&delete h.default,t.push({type:r.name,name:c,attribute:h})})}),t}function ye(...e){return e.filter(t=>!!t).reduce((t,i)=>{let n=b({},t);return Object.entries(i).forEach(([o,s])=>{if(!n[o]){n[o]=s;return}if(o==="class"){let a=s?String(s).split(" "):[],l=n[o]?n[o].split(" "):[],d=a.filter(c=>!l.includes(c));n[o]=[...l,...d].join(" ")}else if(o==="style"){let a=s?s.split(";").map(c=>c.trim()).filter(Boolean):[],l=n[o]?n[o].split(";").map(c=>c.trim()).filter(Boolean):[],d=new Map;l.forEach(c=>{let[u,h]=c.split(":").map(p=>p.trim());d.set(u,h)}),a.forEach(c=>{let[u,h]=c.split(":").map(p=>p.trim());d.set(u,h)}),n[o]=Array.from(d.entries()).map(([c,u])=>`${c}: ${u}`).join("; ")}else n[o]=s}),n},{})}function Pc(e,t){return t.filter(i=>i.type===e.type.name).filter(i=>i.attribute.rendered).map(i=>i.attribute.renderHTML?i.attribute.renderHTML(e.attrs)||{}:{[i.name]:e.attrs[i.name]}).reduce((i,n)=>ye(i,n),{})}function m5(e){return typeof e!="string"?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):e==="true"?!0:e==="false"?!1:e}function eS(e,t){return"style"in e?e:_(b({},e),{getAttrs:i=>{let n=e.getAttrs?e.getAttrs(i):e.attrs;if(n===!1)return!1;let o=t.reduce((s,r)=>{let a=r.attribute.parseHTML?r.attribute.parseHTML(i):m5(i.getAttribute(r.name));return a==null?s:_(b({},s),{[r.name]:a})},{});return b(b({},n),o)}})}function tS(e){return Object.fromEntries(Object.entries(e).filter(([t,i])=>t==="attrs"&&f5(i)?!1:i!=null))}function iS(e){var t,i;let n={};return!((t=e?.attribute)!=null&&t.isRequired)&&"default"in(e?.attribute||{})&&(n.default=e.attribute.default),((i=e?.attribute)==null?void 0:i.validate)!==void 0&&(n.validate=e.attribute.validate),[e.name,n]}function C5(e,t){var i;let n=mS(e),{nodeExtensions:o,markExtensions:s}=Tr(e),r=(i=o.find(d=>ee(d,"topNode")))==null?void 0:i.name,a=Object.fromEntries(o.map(d=>{let c=n.filter(C=>C.type===d.name),u={name:d.name,options:d.options,storage:d.storage,editor:t},h=e.reduce((C,v)=>{let w=ee(v,"extendNodeSchema",u);return b(b({},C),w?w(d):{})},{}),p=tS(_(b({},h),{content:He(ee(d,"content",u)),marks:He(ee(d,"marks",u)),group:He(ee(d,"group",u)),inline:He(ee(d,"inline",u)),atom:He(ee(d,"atom",u)),selectable:He(ee(d,"selectable",u)),draggable:He(ee(d,"draggable",u)),code:He(ee(d,"code",u)),whitespace:He(ee(d,"whitespace",u)),linebreakReplacement:He(ee(d,"linebreakReplacement",u)),defining:He(ee(d,"defining",u)),isolating:He(ee(d,"isolating",u)),attrs:Object.fromEntries(c.map(iS))})),g=He(ee(d,"parseHTML",u));g&&(p.parseDOM=g.map(C=>eS(C,c)));let f=ee(d,"renderHTML",u);f&&(p.toDOM=C=>f({node:C,HTMLAttributes:Pc(C,c)}));let m=ee(d,"renderText",u);return m&&(p.toText=m),[d.name,p]})),l=Object.fromEntries(s.map(d=>{let c=n.filter(m=>m.type===d.name),u={name:d.name,options:d.options,storage:d.storage,editor:t},h=e.reduce((m,C)=>{let v=ee(C,"extendMarkSchema",u);return b(b({},m),v?v(d):{})},{}),p=tS(_(b({},h),{inclusive:He(ee(d,"inclusive",u)),excludes:He(ee(d,"excludes",u)),group:He(ee(d,"group",u)),spanning:He(ee(d,"spanning",u)),code:He(ee(d,"code",u)),attrs:Object.fromEntries(c.map(iS))})),g=He(ee(d,"parseHTML",u));g&&(p.parseDOM=g.map(m=>eS(m,c)));let f=ee(d,"renderHTML",u);return f&&(p.toDOM=m=>f({mark:m,HTMLAttributes:Pc(m,c)})),[d.name,p]}));return new mr({topNode:r,nodes:a,marks:l})}function v5(e){let t=e.filter((i,n)=>e.indexOf(i)!==n);return Array.from(new Set(t))}function If(e){return e.sort((i,n)=>{let o=ee(i,"priority")||100,s=ee(n,"priority")||100;return o>s?-1:o<s?1:0})}function nS(e){let t=If(Gf(e)),i=v5(t.map(n=>n.name));return i.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${i.map(n=>`'${n}'`).join(", ")}]. This can lead to issues.`),t}function CS(e,t,i){let{from:n,to:o}=t,{blockSeparator:s=`

`,textSerializers:r={}}=i||{},a="";return e.nodesBetween(n,o,(l,d,c,u)=>{var h;l.isBlock&&d>n&&(a+=s);let p=r?.[l.type.name];if(p)return c&&(a+=p({node:l,pos:d,parent:c,index:u,range:t})),!1;l.isText&&(a+=(h=l?.text)==null?void 0:h.slice(Math.max(n,d)-d,o-d))}),a}function w5(e,t){let i={from:0,to:e.content.size};return CS(e,i,t)}function vS(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,t])=>t.spec.toText).map(([t,i])=>[t,i.spec.toText]))}function b5(e,t){let i=st(t,e.schema),{from:n,to:o}=e.selection,s=[];e.doc.nodesBetween(n,o,a=>{s.push(a)});let r=s.reverse().find(a=>a.type.name===i.name);return r?b({},r.attrs):{}}function zf(e,t){let i=Dc(typeof t=="string"?t:t.name,e.schema);return i==="node"?b5(e,t):i==="mark"?pS(e,t):{}}function y5(e,t=JSON.stringify){let i={};return e.filter(n=>{let o=t(n);return Object.prototype.hasOwnProperty.call(i,o)?!1:i[o]=!0})}function S5(e){let t=y5(e);return t.length===1?t:t.filter((i,n)=>!t.filter((s,r)=>r!==n).some(s=>i.oldRange.from>=s.oldRange.from&&i.oldRange.to<=s.oldRange.to&&i.newRange.from>=s.newRange.from&&i.newRange.to<=s.newRange.to))}function Wf(e){let{mapping:t,steps:i}=e,n=[];return t.maps.forEach((o,s)=>{let r=[];if(o.ranges.length)o.forEach((a,l)=>{r.push({from:a,to:l})});else{let{from:a,to:l}=i[s];if(a===void 0||l===void 0)return;r.push({from:a,to:l})}r.forEach(({from:a,to:l})=>{let d=t.slice(s).map(a,-1),c=t.slice(s).map(l),u=t.invert().map(d,-1),h=t.invert().map(c);n.push({oldRange:{from:u,to:h},newRange:{from:d,to:c}})})}),S5(n)}function Tc(e,t,i){let n=[];return e===t?i.resolve(e).marks().forEach(o=>{let s=i.resolve(e),r=Nf(s,o.type);r&&n.push(b({mark:o},r))}):i.nodesBetween(e,t,(o,s)=>{!o||o?.nodeSize===void 0||n.push(...o.marks.map(r=>({from:s,to:s+o.nodeSize,mark:r})))}),n}var wS=(e,t,i,n=20)=>{let o=e.doc.resolve(i),s=n,r=null;for(;s>0&&r===null;){let a=o.node(s);a?.type.name===t?r=a:s-=1}return[r,s]};function Df(e,t){return t.nodes[e]||t.marks[e]||null}function Ec(e,t,i){return Object.fromEntries(Object.entries(i).filter(([n])=>{let o=e.find(s=>s.type===t&&s.name===n);return o?o.attribute.keepOnSplit:!1}))}var x5=(e,t=500)=>{let i="",n=e.parentOffset;return e.parent.nodesBetween(Math.max(0,n-t),n,(o,s,r,a)=>{var l,d;let c=((d=(l=o.type.spec).toText)==null?void 0:d.call(l,{node:o,pos:s,parent:r,index:a}))||o.textContent||"%leaf%";i+=o.isAtom&&!o.isText?c:c.slice(0,Math.max(0,n-s))}),i};function Lf(e,t,i={}){let{empty:n,ranges:o}=e.selection,s=t?Gn(t,e.schema):null;if(n)return!!(e.storedMarks||e.selection.$from.marks()).filter(u=>s?s.name===u.type.name:!0).find(u=>Rc(u.attrs,i,{strict:!1}));let r=0,a=[];if(o.forEach(({$from:u,$to:h})=>{let p=u.pos,g=h.pos;e.doc.nodesBetween(p,g,(f,m)=>{if(!f.isText&&!f.marks.length)return;let C=Math.max(p,m),v=Math.min(g,m+f.nodeSize),w=v-C;r+=w,a.push(...f.marks.map(y=>({mark:y,from:C,to:v})))})}),r===0)return!1;let l=a.filter(u=>s?s.name===u.mark.type.name:!0).filter(u=>Rc(u.mark.attrs,i,{strict:!1})).reduce((u,h)=>u+h.to-h.from,0),d=a.filter(u=>s?u.mark.type!==s&&u.mark.type.excludes(s):!0).reduce((u,h)=>u+h.to-h.from,0);return(l>0?l+d:l)>=r}function E5(e,t,i={}){if(!t)return on(e,null,i)||Lf(e,null,i);let n=Dc(t,e.schema);return n==="node"?on(e,t,i):n==="mark"?Lf(e,t,i):!1}var bS=(e,t)=>{let{$from:i,$to:n,$anchor:o}=e.selection;if(t){let s=Fc(a=>a.type.name===t)(e.selection);if(!s)return!1;let r=e.doc.resolve(s.pos+1);return o.pos+1===r.end()}return!(n.parentOffset<n.parent.nodeSize-2||i.pos!==n.pos)},yS=e=>{let{$from:t,$to:i}=e.selection;return!(t.parentOffset>0||t.pos!==i.pos)};function oS(e,t){return Array.isArray(t)?t.some(i=>(typeof i=="string"?i:i.name)===e.name):t}function sS(e,t){let{nodeExtensions:i}=Tr(t),n=i.find(r=>r.name===e);if(!n)return!1;let o={name:n.name,options:n.options,storage:n.storage},s=He(ee(n,"group",o));return typeof s!="string"?!1:s.split(" ").includes("list")}function il(e,{checkChildren:t=!0,ignoreWhitespace:i=!1}={}){var n;if(i){if(e.type.name==="hardBreak")return!0;if(e.isText)return/^\s*$/m.test((n=e.text)!=null?n:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(e.content.childCount===0)return!0;if(t){let o=!0;return e.content.forEach(s=>{o!==!1&&(il(s,{ignoreWhitespace:i,checkChildren:t})||(o=!1))}),o}return!1}function Ac(e){return e instanceof J}function R5(e,t,i){var n;let{selection:o}=t,s=null;if(dS(o)&&(s=o.$cursor),s){let a=(n=e.storedMarks)!=null?n:s.marks();return s.parent.type.allowsMarkType(i)&&(!!i.isInSet(a)||!a.some(d=>d.type.excludes(i)))}let{ranges:r}=o;return r.some(({$from:a,$to:l})=>{let d=a.depth===0?e.doc.inlineContent&&e.doc.type.allowsMarkType(i):!1;return e.doc.nodesBetween(a.pos,l.pos,(c,u,h)=>{if(d)return!1;if(c.isInline){let p=!h||h.type.allowsMarkType(i),g=!!i.isInSet(c.marks)||!c.marks.some(f=>f.type.excludes(i));d=p&&g}return!d}),d})}var P5=(e,t={})=>({tr:i,state:n,dispatch:o})=>{let{selection:s}=i,{empty:r,ranges:a}=s,l=Gn(e,n.schema);if(o)if(r){let d=pS(n,l);i.addStoredMark(l.create(b(b({},d),t)))}else a.forEach(d=>{let c=d.$from.pos,u=d.$to.pos;n.doc.nodesBetween(c,u,(h,p)=>{let g=Math.max(p,c),f=Math.min(p+h.nodeSize,u);h.marks.find(C=>C.type===l)?h.marks.forEach(C=>{l===C.type&&i.addMark(g,f,l.create(b(b({},C.attrs),t)))}):i.addMark(g,f,l.create(t))})});return R5(n,i,l)},M5=(e,t)=>({tr:i})=>(i.setMeta(e,t),!0),k5=(e,t={})=>({state:i,dispatch:n,chain:o})=>{let s=st(e,i.schema),r;return i.selection.$anchor.sameParent(i.selection.$head)&&(r=i.selection.$anchor.parent.attrs),s.isTextblock?o().command(({commands:a})=>jg(s,b(b({},r),t))(i)?!0:a.clearNodes()).command(({state:a})=>jg(s,b(b({},r),t))(a,n)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},D5=e=>({tr:t,dispatch:i})=>{if(i){let{doc:n}=t,o=Rs(e,0,n.content.size),s=J.create(n,o);t.setSelection(s)}return!0},F5=(e,t)=>({tr:i,state:n,dispatch:o})=>{let{selection:s}=n,r,a;return typeof t=="number"?(r=t,a=t):t&&"from"in t&&"to"in t?(r=t.from,a=t.to):(r=s.from,a=s.to),o&&i.doc.nodesBetween(r,a,(l,d)=>{l.isText||i.setNodeMarkup(d,void 0,_(b({},l.attrs),{dir:e}))}),!0},T5=e=>({tr:t,dispatch:i})=>{if(i){let{doc:n}=t,{from:o,to:s}=typeof e=="number"?{from:e,to:e}:e,r=ne.atStart(n).from,a=ne.atEnd(n).to,l=Rs(o,r,a),d=Rs(s,r,a),c=ne.create(n,l,d);t.setSelection(c)}return!0},A5=e=>({state:t,dispatch:i})=>{let n=st(e,t.schema);return Gb(n)(t,i)};function rS(e,t){let i=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(i){let n=i.filter(o=>t?.includes(o.type.name));e.tr.ensureMarks(n)}}var I5=({keepMarks:e=!0}={})=>({tr:t,state:i,dispatch:n,editor:o})=>{let{selection:s,doc:r}=t,{$from:a,$to:l}=s,d=o.extensionManager.attributes,c=Ec(d,a.node().type.name,a.node().attrs);if(s instanceof J&&s.node.isBlock)return!a.parentOffset||!fi(r,a.pos)?!1:(n&&(e&&rS(i,o.extensionManager.splittableMarks),t.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;let u=l.parentOffset===l.parent.content.size,h=a.depth===0?void 0:p5(a.node(-1).contentMatchAt(a.indexAfter(-1))),p=u&&h?[{type:h,attrs:c}]:void 0,g=fi(t.doc,t.mapping.map(a.pos),1,p);if(!p&&!g&&fi(t.doc,t.mapping.map(a.pos),1,h?[{type:h}]:void 0)&&(g=!0,p=h?[{type:h,attrs:c}]:void 0),n){if(g&&(s instanceof ne&&t.deleteSelection(),t.split(t.mapping.map(a.pos),1,p),h&&!u&&!a.parentOffset&&a.parent.type!==h)){let f=t.mapping.map(a.before()),m=t.doc.resolve(f);a.node(-1).canReplaceWith(m.index(),m.index()+1,h)&&t.setNodeMarkup(t.mapping.map(a.before()),h)}e&&rS(i,o.extensionManager.splittableMarks),t.scrollIntoView()}return g},L5=(e,t={})=>({tr:i,state:n,dispatch:o,editor:s})=>{var r;let a=st(e,n.schema),{$from:l,$to:d}=n.selection,c=n.selection.node;if(c&&c.isBlock||l.depth<2||!l.sameParent(d))return!1;let u=l.node(-1);if(u.type!==a)return!1;let h=s.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(o){let C=N.empty,v=l.index(-1)?1:l.index(-2)?2:3;for(let T=l.depth-v;T>=l.depth-3;T-=1)C=N.from(l.node(T).copy(C));let w=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,y=b(b({},Ec(h,l.node().type.name,l.node().attrs)),t),S=((r=a.contentMatch.defaultType)==null?void 0:r.createAndFill(y))||void 0;C=C.append(N.from(a.createAndFill(null,S)||void 0));let x=l.before(l.depth-(v-1));i.replace(x,l.after(-w),new K(C,4-v,0));let E=-1;i.doc.nodesBetween(x,i.doc.content.size,(T,L)=>{if(E>-1)return!1;T.isTextblock&&T.content.size===0&&(E=L+1)}),E>-1&&i.setSelection(ne.near(i.doc.resolve(E))),i.scrollIntoView()}return!0}let p=d.pos===l.end()?u.contentMatchAt(0).defaultType:null,g=b(b({},Ec(h,u.type.name,u.attrs)),t),f=b(b({},Ec(h,l.node().type.name,l.node().attrs)),t);i.delete(l.pos,d.pos);let m=p?[{type:a,attrs:g},{type:p,attrs:f}]:[{type:a,attrs:g}];if(!fi(i.doc,l.pos,2))return!1;if(o){let{selection:C,storedMarks:v}=n,{splittableMarks:w}=s.extensionManager,y=v||C.$to.parentOffset&&C.$from.marks();if(i.split(l.pos,2,m).scrollIntoView(),!y||!o)return!0;let S=y.filter(x=>w.includes(x.type.name));i.ensureMarks(S)}return!0},Ff=(e,t)=>{let i=Fc(r=>r.type===t)(e.selection);if(!i)return!0;let n=e.doc.resolve(Math.max(0,i.pos-1)).before(i.depth);if(n===void 0)return!0;let o=e.doc.nodeAt(n);return i.node.type===o?.type&&Ei(e.doc,i.pos)&&e.join(i.pos),!0},Tf=(e,t)=>{let i=Fc(r=>r.type===t)(e.selection);if(!i)return!0;let n=e.doc.resolve(i.start).after(i.depth);if(n===void 0)return!0;let o=e.doc.nodeAt(n);return i.node.type===o?.type&&Ei(e.doc,n)&&e.join(n),!0},_5=(e,t,i,n={})=>({editor:o,tr:s,state:r,dispatch:a,chain:l,commands:d,can:c})=>{let{extensions:u,splittableMarks:h}=o.extensionManager,p=st(e,r.schema),g=st(t,r.schema),{selection:f,storedMarks:m}=r,{$from:C,$to:v}=f,w=C.blockRange(v),y=m||f.$to.parentOffset&&f.$from.marks();if(!w)return!1;let S=Fc(x=>sS(x.type.name,u))(f);if(w.depth>=1&&S&&w.depth-S.depth<=1){if(S.node.type===p)return d.liftListItem(g);if(sS(S.node.type.name,u)&&p.validContent(S.node.content)&&a)return l().command(()=>(s.setNodeMarkup(S.pos,p),!0)).command(()=>Ff(s,p)).command(()=>Tf(s,p)).run()}return!i||!y||!a?l().command(()=>c().wrapInList(p,n)?!0:d.clearNodes()).wrapInList(p,n).command(()=>Ff(s,p)).command(()=>Tf(s,p)).run():l().command(()=>{let x=c().wrapInList(p,n),E=y.filter(T=>h.includes(T.type.name));return s.ensureMarks(E),x?!0:d.clearNodes()}).wrapInList(p,n).command(()=>Ff(s,p)).command(()=>Tf(s,p)).run()},O5=(e,t={},i={})=>({state:n,commands:o})=>{let{extendEmptyMarkRange:s=!1}=i,r=Gn(e,n.schema);return Lf(n,r,t)?o.unsetMark(r,{extendEmptyMarkRange:s}):o.setMark(r,t)},N5=(e,t,i={})=>({state:n,commands:o})=>{let s=st(e,n.schema),r=st(t,n.schema),a=on(n,s,i),l;return n.selection.$anchor.sameParent(n.selection.$head)&&(l=n.selection.$anchor.parent.attrs),a?o.setNode(r,l):o.setNode(s,b(b({},l),i))},B5=(e,t={})=>({state:i,commands:n})=>{let o=st(e,i.schema);return on(i,o,t)?n.lift(o):n.wrapIn(o,t)},H5=()=>({state:e,dispatch:t})=>{let i=e.plugins;for(let n=0;n<i.length;n+=1){let o=i[n],s;if(o.spec.isInputRules&&(s=o.getState(e))){if(t){let r=e.tr,a=s.transform;for(let l=a.steps.length-1;l>=0;l-=1)r.step(a.steps[l].invert(a.docs[l]));if(s.text){let l=r.doc.resolve(s.from).marks();r.replaceWith(s.from,s.to,e.schema.text(s.text,l))}else r.delete(s.from,s.to)}return!0}}return!1},G5=()=>({tr:e,dispatch:t})=>{let{selection:i}=e,{empty:n,ranges:o}=i;return n||t&&o.forEach(s=>{e.removeMark(s.$from.pos,s.$to.pos)}),!0},V5=(e,t={})=>({tr:i,state:n,dispatch:o})=>{var s;let{extendEmptyMarkRange:r=!1}=t,{selection:a}=i,l=Gn(e,n.schema),{$from:d,empty:c,ranges:u}=a;if(!o)return!0;if(c&&r){let{from:h,to:p}=a,g=(s=d.marks().find(m=>m.type===l))==null?void 0:s.attrs,f=Nf(d,l,g);f&&(h=f.from,p=f.to),i.removeMark(h,p,l)}else u.forEach(h=>{i.removeMark(h.$from.pos,h.$to.pos,l)});return i.removeStoredMark(l),!0},z5=e=>({tr:t,state:i,dispatch:n})=>{let{selection:o}=i,s,r;return typeof e=="number"?(s=e,r=e):e&&"from"in e&&"to"in e?(s=e.from,r=e.to):(s=o.from,r=o.to),n&&t.doc.nodesBetween(s,r,(a,l)=>{if(a.isText)return;let d=b({},a.attrs);delete d.dir,t.setNodeMarkup(l,void 0,d)}),!0},W5=(e,t={})=>({tr:i,state:n,dispatch:o})=>{let s=null,r=null,a=Dc(typeof e=="string"?e:e.name,n.schema);if(!a)return!1;a==="node"&&(s=st(e,n.schema)),a==="mark"&&(r=Gn(e,n.schema));let l=!1;return i.selection.ranges.forEach(d=>{let c=d.$from.pos,u=d.$to.pos,h,p,g,f;i.selection.empty?n.doc.nodesBetween(c,u,(m,C)=>{s&&s===m.type&&(l=!0,g=Math.max(C,c),f=Math.min(C+m.nodeSize,u),h=C,p=m)}):n.doc.nodesBetween(c,u,(m,C)=>{C<c&&s&&s===m.type&&(l=!0,g=Math.max(C,c),f=Math.min(C+m.nodeSize,u),h=C,p=m),C>=c&&C<=u&&(s&&s===m.type&&(l=!0,o&&i.setNodeMarkup(C,void 0,b(b({},m.attrs),t))),r&&m.marks.length&&m.marks.forEach(v=>{if(r===v.type&&(l=!0,o)){let w=Math.max(C,c),y=Math.min(C+m.nodeSize,u);i.addMark(w,y,r.create(b(b({},v.attrs),t)))}}))}),p&&(h!==void 0&&o&&i.setNodeMarkup(h,void 0,b(b({},p.attrs),t)),r&&p.marks.length&&p.marks.forEach(m=>{r===m.type&&o&&i.addMark(g,f,r.create(b(b({},m.attrs),t)))}))}),l},U5=(e,t={})=>({state:i,dispatch:n})=>{let o=st(e,i.schema);return Nb(o,t)(i,n)},q5=(e,t={})=>({state:i,dispatch:n})=>{let o=st(e,i.schema);return Bb(o,t)(i,n)},$5=class{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){let i=this.callbacks[e];return i&&i.forEach(n=>n.apply(this,t)),this}off(e,t){let i=this.callbacks[e];return i&&(t?this.callbacks[e]=i.filter(n=>n!==t):delete this.callbacks[e]),this}once(e,t){let i=(...n)=>{this.off(e,i),t.apply(this,n)};return this.on(e,i)}removeAllListeners(){this.callbacks={}}},Ic=class{constructor(e){var t;this.find=e.find,this.handler=e.handler,this.undoable=(t=e.undoable)!=null?t:!0}},j5=(e,t)=>{if(Of(t))return t.exec(e);let i=t(e);if(!i)return null;let n=[i.text];return n.index=i.index,n.input=e,n.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),n.push(i.replaceWith)),n};function yc(e){var t;let{editor:i,from:n,to:o,text:s,rules:r,plugin:a}=e,{view:l}=i;if(l.composing)return!1;let d=l.state.doc.resolve(n);if(d.parent.type.spec.code||(t=d.nodeBefore||d.nodeAfter)!=null&&t.marks.find(h=>h.type.spec.code))return!1;let c=!1,u=x5(d)+s;return r.forEach(h=>{if(c)return;let p=j5(u,h.find);if(!p)return;let g=l.state.tr,f=Mc({state:l.state,transaction:g}),m={from:n-(p[0].length-s.length),to:o},{commands:C,chain:v,can:w}=new kc({editor:i,state:f});h.handler({state:f,range:m,match:p,commands:C,chain:v,can:w})===null||!g.steps.length||(h.undoable&&g.setMeta(a,{transform:g,from:n,to:o,text:s}),l.dispatch(g),c=!0)}),c}function K5(e){let{editor:t,rules:i}=e,n=new he({state:{init(){return null},apply(o,s,r){let a=o.getMeta(n);if(a)return a;let l=o.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:c}=l;typeof c=="string"?c=c:c=Vf(N.from(c),r.schema);let{from:u}=l,h=u+c.length;yc({editor:t,from:u,to:h,text:c,rules:i,plugin:n})}),o.selectionSet||o.docChanged?null:s}},props:{handleTextInput(o,s,r,a){return yc({editor:t,from:s,to:r,text:a,rules:i,plugin:n})},handleDOMEvents:{compositionend:o=>(setTimeout(()=>{let{$cursor:s}=o.state.selection;s&&yc({editor:t,from:s.pos,to:s.pos,text:"",rules:i,plugin:n})}),!1)},handleKeyDown(o,s){if(s.key!=="Enter")return!1;let{$cursor:r}=o.state.selection;return r?yc({editor:t,from:r.pos,to:r.pos,text:`
`,rules:i,plugin:n}):!1}},isInputRules:!0});return n}function Y5(e){return Object.prototype.toString.call(e).slice(8,-1)}function Sc(e){return Y5(e)!=="Object"?!1:e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function SS(e,t){let i=b({},e);return Sc(e)&&Sc(t)&&Object.keys(t).forEach(n=>{Sc(t[n])&&Sc(e[n])?i[n]=SS(e[n],t[n]):i[n]=t[n]}),i}var Uf=class{constructor(e={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config=b(b({},this.config),e),this.name=this.config.name}get options(){return b({},He(ee(this,"addOptions",{name:this.name}))||{})}get storage(){return b({},He(ee(this,"addStorage",{name:this.name,options:this.options}))||{})}configure(e={}){let t=this.extend(_(b({},this.config),{addOptions:()=>SS(this.options,e)}));return t.name=this.name,t.parent=this.parent,t}extend(e={}){let t=new this.constructor(b(b({},this.config),e));return t.parent=this,this.child=t,t.name="name"in e?e.name:t.parent.name,t}},mi=class xS extends Uf{constructor(){super(...arguments),this.type="mark"}static create(t={}){let i=typeof t=="function"?t():t;return new xS(i)}static handleExit({editor:t,mark:i}){let{tr:n}=t.state,o=t.state.selection.$from;if(o.pos===o.end()){let r=o.marks();if(!!!r.find(d=>d?.type.name===i.name))return!1;let l=r.find(d=>d?.type.name===i.name);return l&&n.removeStoredMark(l),n.insertText(" ",o.pos),t.view.dispatch(n),!0}return!1}configure(t){return super.configure(t)}extend(t){let i=typeof t=="function"?t():t;return super.extend(i)}};function X5(e){return typeof e=="number"}var J5=class{constructor(e){this.find=e.find,this.handler=e.handler}},Q5=(e,t,i)=>{if(Of(t))return[...e.matchAll(t)];let n=t(e,i);return n?n.map(o=>{let s=[o.text];return s.index=o.index,s.input=e,s.data=o.data,o.replaceWith&&(o.text.includes(o.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),s.push(o.replaceWith)),s}):[]};function Z5(e){let{editor:t,state:i,from:n,to:o,rule:s,pasteEvent:r,dropEvent:a}=e,{commands:l,chain:d,can:c}=new kc({editor:t,state:i}),u=[];return i.doc.nodesBetween(n,o,(p,g)=>{var f,m,C,v,w;if((m=(f=p.type)==null?void 0:f.spec)!=null&&m.code||!(p.isText||p.isTextblock||p.isInline))return;let y=(w=(v=(C=p.content)==null?void 0:C.size)!=null?v:p.nodeSize)!=null?w:0,S=Math.max(n,g),x=Math.min(o,g+y);if(S>=x)return;let E=p.isText?p.text||"":p.textBetween(S-g,x-g,void 0,"\uFFFC");Q5(E,s.find,r).forEach(L=>{if(L.index===void 0)return;let O=S+L.index+1,W=O+L[0].length,G={from:i.tr.mapping.map(O),to:i.tr.mapping.map(W)},Q=s.handler({state:i,range:G,match:L,commands:l,chain:d,can:c,pasteEvent:r,dropEvent:a});u.push(Q)})}),u.every(p=>p!==null)}var xc=null,eT=e=>{var t;let i=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(t=i.clipboardData)==null||t.setData("text/html",e),i};function tT(e){let{editor:t,rules:i}=e,n=null,o=!1,s=!1,r=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}let l=({state:c,from:u,to:h,rule:p,pasteEvt:g})=>{let f=c.tr,m=Mc({state:c,transaction:f});if(!(!Z5({editor:t,state:m,from:Math.max(u-1,0),to:h.b-1,rule:p,pasteEvent:g,dropEvent:a})||!f.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return r=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,f}};return i.map(c=>new he({view(u){let h=g=>{var f;n=(f=u.dom.parentElement)!=null&&f.contains(g.target)?u.dom.parentElement:null,n&&(xc=t)},p=()=>{xc&&(xc=null)};return window.addEventListener("dragstart",h),window.addEventListener("dragend",p),{destroy(){window.removeEventListener("dragstart",h),window.removeEventListener("dragend",p)}}},props:{handleDOMEvents:{drop:(u,h)=>{if(s=n===u.dom.parentElement,a=h,!s){let p=xc;p?.isEditable&&setTimeout(()=>{let g=p.state.selection;g&&p.commands.deleteRange({from:g.from,to:g.to})},10)}return!1},paste:(u,h)=>{var p;let g=(p=h.clipboardData)==null?void 0:p.getData("text/html");return r=h,o=!!g?.includes("data-pm-slice"),!1}}},appendTransaction:(u,h,p)=>{let g=u[0],f=g.getMeta("uiEvent")==="paste"&&!o,m=g.getMeta("uiEvent")==="drop"&&!s,C=g.getMeta("applyPasteRules"),v=!!C;if(!f&&!m&&!v)return;if(v){let{text:S}=C;typeof S=="string"?S=S:S=Vf(N.from(S),p.schema);let{from:x}=C,E=x+S.length,T=eT(S);return l({rule:c,state:p,from:x,to:{b:E},pasteEvt:T})}let w=h.doc.content.findDiffStart(p.doc.content),y=h.doc.content.findDiffEnd(p.doc.content);if(!(!X5(w)||!y||w===y.b))return l({rule:c,state:p,from:w,to:y,pasteEvt:r})}}))}var iT=(()=>{let e=class{constructor(t,i){this.splittableMarks=[],this.editor=i,this.baseExtensions=t,this.extensions=nS(t),this.schema=C5(this.extensions,i),this.setupExtensions()}get commands(){return this.extensions.reduce((t,i)=>{let n={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:this.editor,type:Df(i.name,this.schema)},o=ee(i,"addCommands",n);return o?b(b({},t),o()):t},{})}get plugins(){let{editor:t}=this;return If([...this.extensions].reverse()).flatMap(o=>{let s={name:o.name,options:o.options,storage:this.editor.extensionStorage[o.name],editor:t,type:Df(o.name,this.schema)},r=[],a=ee(o,"addKeyboardShortcuts",s),l={};if(o.type==="mark"&&ee(o,"exitable",s)&&(l.ArrowRight=()=>mi.handleExit({editor:t,mark:o})),a){let p=Object.fromEntries(Object.entries(a()).map(([g,f])=>[g,()=>f({editor:t})]));l=b(b({},l),p)}let d=Jy(l);r.push(d);let c=ee(o,"addInputRules",s);if(oS(o,t.options.enableInputRules)&&c){let p=c();if(p&&p.length){let g=K5({editor:t,rules:p}),f=Array.isArray(g)?g:[g];r.push(...f)}}let u=ee(o,"addPasteRules",s);if(oS(o,t.options.enablePasteRules)&&u){let p=u();if(p&&p.length){let g=tT({editor:t,rules:p});r.push(...g)}}let h=ee(o,"addProseMirrorPlugins",s);if(h){let p=h();r.push(...p)}return r})}get attributes(){return mS(this.extensions)}get nodeViews(){let{editor:t}=this,{nodeExtensions:i}=Tr(this.extensions);return Object.fromEntries(i.filter(n=>!!ee(n,"addNodeView")).map(n=>{let o=this.attributes.filter(d=>d.type===n.name),s={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:st(n.name,this.schema)},r=ee(n,"addNodeView",s);if(!r)return[];let a=r();if(!a)return[];let l=(d,c,u,h,p)=>{let g=Pc(d,o);return a({node:d,view:c,getPos:u,decorations:h,innerDecorations:p,editor:t,extension:n,HTMLAttributes:g})};return[n.name,l]}))}get markViews(){let{editor:t}=this,{markExtensions:i}=Tr(this.extensions);return Object.fromEntries(i.filter(n=>!!ee(n,"addMarkView")).map(n=>{let o=this.attributes.filter(l=>l.type===n.name),s={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:Gn(n.name,this.schema)},r=ee(n,"addMarkView",s);if(!r)return[];let a=(l,d,c)=>{let u=Pc(l,o);return r()({mark:l,view:d,inline:c,editor:t,extension:n,HTMLAttributes:u,updateAttributes:h=>{pT(l,t,h)}})};return[n.name,a]}))}setupExtensions(){let t=this.extensions;this.editor.extensionStorage=Object.fromEntries(t.map(i=>[i.name,i.storage])),t.forEach(i=>{var n;let o={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:this.editor,type:Df(i.name,this.schema)};i.type==="mark"&&((n=He(ee(i,"keepOnSplit",o)))==null||n)&&this.splittableMarks.push(i.name);let s=ee(i,"onBeforeCreate",o),r=ee(i,"onCreate",o),a=ee(i,"onUpdate",o),l=ee(i,"onSelectionUpdate",o),d=ee(i,"onTransaction",o),c=ee(i,"onFocus",o),u=ee(i,"onBlur",o),h=ee(i,"onDestroy",o);s&&this.editor.on("beforeCreate",s),r&&this.editor.on("create",r),a&&this.editor.on("update",a),l&&this.editor.on("selectionUpdate",l),d&&this.editor.on("transaction",d),c&&this.editor.on("focus",c),u&&this.editor.on("blur",u),h&&this.editor.on("destroy",h)})}};return e.resolve=nS,e.sort=If,e.flatten=Gf,e})(),nT={};_f(nT,{ClipboardTextSerializer:()=>RS,Commands:()=>PS,Delete:()=>MS,Drop:()=>kS,Editable:()=>DS,FocusEvents:()=>TS,Keymap:()=>AS,Paste:()=>IS,Tabindex:()=>LS,TextDirection:()=>_S,focusEventsPluginKey:()=>FS});var Ie=class ES extends Uf{constructor(){super(...arguments),this.type="extension"}static create(t={}){let i=typeof t=="function"?t():t;return new ES(i)}configure(t){return super.configure(t)}extend(t){let i=typeof t=="function"?t():t;return super.extend(i)}},RS=Ie.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new he({key:new ve("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{let{editor:e}=this,{state:t,schema:i}=e,{doc:n,selection:o}=t,{ranges:s}=o,r=Math.min(...s.map(c=>c.$from.pos)),a=Math.max(...s.map(c=>c.$to.pos)),l=vS(i);return CS(n,{from:r,to:a},_(b({},this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{}),{textSerializers:l}))}}})]}}),PS=Ie.create({name:"commands",addCommands(){return b({},aS)}}),MS=Ie.create({name:"delete",onUpdate({transaction:e,appendedTransactions:t}){var i,n,o;let s=()=>{var r,a,l,d;if((d=(l=(a=(r=this.editor.options.coreExtensionOptions)==null?void 0:r.delete)==null?void 0:a.filterTransaction)==null?void 0:l.call(a,e))!=null?d:e.getMeta("y-sync$"))return;let c=Hf(e.before,[e,...t]);Wf(c).forEach(p=>{c.mapping.mapResult(p.oldRange.from).deletedAfter&&c.mapping.mapResult(p.oldRange.to).deletedBefore&&c.before.nodesBetween(p.oldRange.from,p.oldRange.to,(g,f)=>{let m=f+g.nodeSize-2,C=p.oldRange.from<=f&&m<=p.oldRange.to;this.editor.emit("delete",{type:"node",node:g,from:f,to:m,newFrom:c.mapping.map(f),newTo:c.mapping.map(m),deletedRange:p.oldRange,newRange:p.newRange,partial:!C,editor:this.editor,transaction:e,combinedTransform:c})})});let h=c.mapping;c.steps.forEach((p,g)=>{var f,m;if(p instanceof In){let C=h.slice(g).map(p.from,-1),v=h.slice(g).map(p.to),w=h.invert().map(C,-1),y=h.invert().map(v),S=(f=c.doc.nodeAt(C-1))==null?void 0:f.marks.some(E=>E.eq(p.mark)),x=(m=c.doc.nodeAt(v))==null?void 0:m.marks.some(E=>E.eq(p.mark));this.editor.emit("delete",{type:"mark",mark:p.mark,from:p.from,to:p.to,deletedRange:{from:w,to:y},newRange:{from:C,to:v},partial:!!(x||S),editor:this.editor,transaction:e,combinedTransform:c})}})};(o=(n=(i=this.editor.options.coreExtensionOptions)==null?void 0:i.delete)==null?void 0:n.async)==null||o?setTimeout(s,0):s()}}),kS=Ie.create({name:"drop",addProseMirrorPlugins(){return[new he({key:new ve("tiptapDrop"),props:{handleDrop:(e,t,i,n)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:i,moved:n})}}})]}}),DS=Ie.create({name:"editable",addProseMirrorPlugins(){return[new he({key:new ve("editable"),props:{editable:()=>this.editor.options.editable}})]}}),FS=new ve("focusEvents"),TS=Ie.create({name:"focusEvents",addProseMirrorPlugins(){let{editor:e}=this;return[new he({key:FS,props:{handleDOMEvents:{focus:(t,i)=>{e.isFocused=!0;let n=e.state.tr.setMeta("focus",{event:i}).setMeta("addToHistory",!1);return t.dispatch(n),!1},blur:(t,i)=>{e.isFocused=!1;let n=e.state.tr.setMeta("blur",{event:i}).setMeta("addToHistory",!1);return t.dispatch(n),!1}}}})]}}),AS=Ie.create({name:"keymap",addKeyboardShortcuts(){let e=()=>this.editor.commands.first(({commands:r})=>[()=>r.undoInputRule(),()=>r.command(({tr:a})=>{let{selection:l,doc:d}=a,{empty:c,$anchor:u}=l,{pos:h,parent:p}=u,g=u.parent.isTextblock&&h>0?a.doc.resolve(h-1):u,f=g.parent.type.spec.isolating,m=u.pos-u.parentOffset,C=f&&g.parent.childCount===1?m===u.pos:de.atStart(d).from===h;return!c||!p.type.isTextblock||p.textContent.length||!C||C&&u.parent.type.name==="paragraph"?!1:r.clearNodes()}),()=>r.deleteSelection(),()=>r.joinBackward(),()=>r.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:r})=>[()=>r.deleteSelection(),()=>r.deleteCurrentNode(),()=>r.joinForward(),()=>r.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:r})=>[()=>r.newlineInCode(),()=>r.createParagraphNear(),()=>r.liftEmptyBlock(),()=>r.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},o=b({},n),s=_(b({},n),{"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()});return Bf()||hS()?s:o},addProseMirrorPlugins(){return[new he({key:new ve("clearDocument"),appendTransaction:(e,t,i)=>{if(e.some(f=>f.getMeta("composition")))return;let n=e.some(f=>f.docChanged)&&!t.doc.eq(i.doc),o=e.some(f=>f.getMeta("preventClearDocument"));if(!n||o)return;let{empty:s,from:r,to:a}=t.selection,l=de.atStart(t.doc).from,d=de.atEnd(t.doc).to;if(s||!(r===l&&a===d)||!il(i.doc))return;let h=i.tr,p=Mc({state:i,transaction:h}),{commands:g}=new kc({editor:this.editor,state:p});if(g.clearNodes(),!!h.steps.length)return h}})]}}),IS=Ie.create({name:"paste",addProseMirrorPlugins(){return[new he({key:new ve("tiptapPaste"),props:{handlePaste:(e,t,i)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:i})}}})]}}),LS=Ie.create({name:"tabindex",addProseMirrorPlugins(){return[new he({key:new ve("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),_S=Ie.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];let{nodeExtensions:e}=Tr(this.extensions);return[{types:e.filter(t=>t.name!=="text").map(t=>t.name),attributes:{dir:{default:this.options.direction,parseHTML:t=>{let i=t.getAttribute("dir");return i&&(i==="ltr"||i==="rtl"||i==="auto")?i:this.options.direction},renderHTML:t=>t.dir?{dir:t.dir}:{}}}}]},addProseMirrorPlugins(){return[new he({key:new ve("textDirection"),props:{attributes:()=>{let e=this.options.direction;return e?{dir:e}:{}}}})]}}),oT=class Fr{constructor(t,i,n=!1,o=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=t,this.editor=i,this.currentNode=o}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var t;return(t=this.actualDepth)!=null?t:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(t){let i=this.from,n=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can\u2019t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}i=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:i,to:n},t)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;let t=this.resolvedPos.start(this.resolvedPos.depth-1),i=this.resolvedPos.doc.resolve(t);return new Fr(i,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new Fr(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new Fr(t,this.editor)}get children(){let t=[];return this.node.content.forEach((i,n)=>{let o=i.isBlock&&!i.isTextblock,s=i.isAtom&&!i.isText,r=this.pos+n+(s?0:1);if(r<0||r>this.resolvedPos.doc.nodeSize-2)return;let a=this.resolvedPos.doc.resolve(r);if(!o&&a.depth<=this.depth)return;let l=new Fr(a,this.editor,o,o?i:null);o&&(l.actualDepth=this.depth+1),t.push(new Fr(a,this.editor,o,o?i:null))}),t}get firstChild(){return this.children[0]||null}get lastChild(){let t=this.children;return t[t.length-1]||null}closest(t,i={}){let n=null,o=this.parent;for(;o&&!n;){if(o.node.type.name===t)if(Object.keys(i).length>0){let s=o.node.attrs,r=Object.keys(i);for(let a=0;a<r.length;a+=1){let l=r[a];if(s[l]!==i[l])break}}else n=o;o=o.parent}return n}querySelector(t,i={}){return this.querySelectorAll(t,i,!0)[0]||null}querySelectorAll(t,i={},n=!1){let o=[];if(!this.children||this.children.length===0)return o;let s=Object.keys(i);return this.children.forEach(r=>{n&&o.length>0||(r.node.type.name===t&&s.every(l=>i[l]===r.node.attrs[l])&&o.push(r),!(n&&o.length>0)&&(o=o.concat(r.querySelectorAll(t,i,n))))}),o}setAttribute(t){let{tr:i}=this.editor.state;i.setNodeMarkup(this.from,void 0,b(b({},this.node.attrs),t)),this.editor.view.dispatch(i)}},sT=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function rT(e,t,i){let n=document.querySelector(`style[data-tiptap-style${i?`-${i}`:""}]`);if(n!==null)return n;let o=document.createElement("style");return t&&o.setAttribute("nonce",t),o.setAttribute(`data-tiptap-style${i?`-${i}`:""}`,""),o.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(o),o}var OS=class extends $5{constructor(e={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:o,moved:s})=>this.options.onDrop(n,o,s)),this.on("paste",({event:n,slice:o})=>this.options.onPaste(n,o)),this.on("delete",this.options.onDelete);let t=this.createDoc(),i=cS(t,this.options.autofocus);this.editorState=oc.create({doc:t,schema:this.schema,selection:i||void 0}),this.options.element&&this.mount(this.options.element)}mount(e){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(e),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){let e=this.editorView.dom;e?.editor&&delete e.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(e){console.warn("Failed to remove CSS element:",e)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=rT(sT,this.options.injectNonce))}setOptions(e={}){this.options=b(b({},this.options),e),!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:e=>{this.editorState=e},dispatch:e=>{this.dispatchTransaction(e)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(e,t)=>{if(this.editorView)return this.editorView[t];if(t==="state")return this.editorState;if(t in e)return Reflect.get(e,t);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${t}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(e,t){let i=fS(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],n=this.state.reconfigure({plugins:i});return this.view.updateState(n),n}unregisterPlugin(e){if(this.isDestroyed)return;let t=this.state.plugins,i=t;if([].concat(e).forEach(o=>{let s=typeof o=="string"?`${o}$`:o.key;i=i.filter(r=>!r.key.startsWith(s))}),t.length===i.length)return;let n=this.state.reconfigure({plugins:i});return this.view.updateState(n),n}createExtensionManager(){var e,t;let n=[...this.options.enableCoreExtensions?[DS,RS.configure({blockSeparator:(t=(e=this.options.coreExtensionOptions)==null?void 0:e.clipboardTextSerializer)==null?void 0:t.blockSeparator}),PS,TS,AS,LS,kS,IS,MS,_S.configure({direction:this.options.textDirection})].filter(o=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[o.name]!==!1:!0):[],...this.options.extensions].filter(o=>["extension","node","mark"].includes(o?.type));this.extensionManager=new iT(n,this)}createCommandManager(){this.commandManager=new kc({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let e;try{e=Af(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(t){if(!(t instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(t.message))throw t;this.emit("contentError",{editor:this,error:t,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(i=>i.name!=="collaboration"),this.createExtensionManager()}}),e=Af(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return e}createView(e){var t;this.editorView=new Qa(e,_(b({},this.options.editorProps),{attributes:b({role:"textbox"},(t=this.options.editorProps)==null?void 0:t.attributes),dispatchTransaction:this.dispatchTransaction.bind(this),state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews}));let i=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(i),this.prependClass(),this.injectCSS();let n=this.view.dom;n.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;let t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(d=>{var c;return(c=this.capturedTransaction)==null?void 0:c.step(d)});return}let{state:t,transactions:i}=this.state.applyTransaction(e),n=!this.state.selection.eq(t.selection),o=i.includes(e),s=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),!o)return;this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e,appendedTransactions:i.slice(1)}),n&&this.emit("selectionUpdate",{editor:this,transaction:e});let r=i.findLast(d=>d.getMeta("focus")||d.getMeta("blur")),a=r?.getMeta("focus"),l=r?.getMeta("blur");a&&this.emit("focus",{editor:this,event:a.event,transaction:r}),l&&this.emit("blur",{editor:this,event:l.event,transaction:r}),!(e.getMeta("preventUpdate")||!i.some(d=>d.docChanged)||s.doc.eq(t.doc))&&this.emit("update",{editor:this,transaction:e,appendedTransactions:i.slice(1)})}getAttributes(e){return zf(this.state,e)}isActive(e,t){let i=typeof e=="string"?e:null,n=typeof e=="string"?t:e;return E5(this.state,i,n)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Vf(this.state.doc.content,this.schema)}getText(e){let{blockSeparator:t=`

`,textSerializers:i={}}=e||{};return w5(this.state.doc,{blockSeparator:t,textSerializers:b(b({},vS(this.schema)),i)})}get isEmpty(){return il(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var e,t;return(t=(e=this.editorView)==null?void 0:e.isDestroyed)!=null?t:!0}$node(e,t){var i;return((i=this.$doc)==null?void 0:i.querySelector(e,t))||null}$nodes(e,t){var i;return((i=this.$doc)==null?void 0:i.querySelectorAll(e,t))||null}$pos(e){let t=this.state.doc.resolve(e);return new oT(t,this)}get $doc(){return this.$pos(0)}};function sn(e){return new Ic({find:e.find,handler:({state:t,range:i,match:n})=>{let o=He(e.getAttributes,void 0,n);if(o===!1||o===null)return null;let{tr:s}=t,r=n[n.length-1],a=n[0];if(r){let l=a.search(/\S/),d=i.from+a.indexOf(r),c=d+r.length;if(Tc(i.from,i.to,t.doc).filter(p=>p.mark.type.excluded.find(f=>f===e.type&&f!==p.mark.type)).filter(p=>p.to>d).length)return null;c<i.to&&s.delete(c,i.to),d>i.from&&s.delete(i.from+l,d);let h=i.from+l+r.length;s.addMark(i.from+l,h,e.type.create(o||{})),s.removeStoredMark(e.type)}},undoable:e.undoable})}function NS(e){return new Ic({find:e.find,handler:({state:t,range:i,match:n})=>{let o=He(e.getAttributes,void 0,n)||{},{tr:s}=t,r=i.from,a=i.to,l=e.type.create(o);if(n[1]){let d=n[0].lastIndexOf(n[1]),c=r+d;c>a?c=a:a=c+n[1].length;let u=n[0][n[0].length-1];s.insertText(u,r+n[0].length-1),s.replaceWith(c,a,l)}else if(n[0]){let d=e.type.isInline?r:r-1;s.insert(d,e.type.create(o)).delete(s.mapping.map(r),s.mapping.map(a))}s.scrollIntoView()},undoable:e.undoable})}function nl(e){return new Ic({find:e.find,handler:({state:t,range:i,match:n})=>{let o=t.doc.resolve(i.from),s=He(e.getAttributes,void 0,n)||{};if(!o.node(-1).canReplaceWith(o.index(-1),o.indexAfter(-1),e.type))return null;t.tr.delete(i.from,i.to).setBlockType(i.from,i.from,e.type,s)},undoable:e.undoable})}function rn(e){return new Ic({find:e.find,handler:({state:t,range:i,match:n,chain:o})=>{let s=He(e.getAttributes,void 0,n)||{},r=t.tr.delete(i.from,i.to),l=r.doc.resolve(i.from).blockRange(),d=l&&br(l,e.type,s);if(!d)return null;if(r.wrap(l,d),e.keepMarks&&e.editor){let{selection:u,storedMarks:h}=t,{splittableMarks:p}=e.editor.extensionManager,g=h||u.$to.parentOffset&&u.$from.marks();if(g){let f=g.filter(m=>p.includes(m.type.name));r.ensureMarks(f)}}if(e.keepAttributes){let u=e.type.name==="bulletList"||e.type.name==="orderedList"?"listItem":"taskList";o().updateAttributes(u,s).run()}let c=r.doc.resolve(i.from-1).nodeBefore;c&&c.type===e.type&&Ei(r.doc,i.from-1)&&(!e.joinPredicate||e.joinPredicate(n,c))&&r.join(i.from-1)},undoable:e.undoable})}function BS(e,t){let{selection:i}=e,{$from:n}=i;if(i instanceof J){let s=n.index();return n.parent.canReplaceWith(s,s+1,t)}let o=n.depth;for(;o>=0;){let s=n.index(o);if(n.node(o).contentMatchAt(s).matchType(t))return!0;o-=1}return!1}var aT={};_f(aT,{createAtomBlockMarkdownSpec:()=>lT,createBlockMarkdownSpec:()=>dT,createInlineMarkdownSpec:()=>hT,parseAttributes:()=>qf,parseIndentedBlocks:()=>Lc,renderNestedMarkdownContent:()=>ol,serializeAttributes:()=>$f});function qf(e){if(!e?.trim())return{};let t={},i=[],n=e.replace(/["']([^"']*)["']/g,d=>(i.push(d),`__QUOTED_${i.length-1}__`)),o=n.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(o){let d=o.map(c=>c.trim().slice(1));t.class=d.join(" ")}let s=n.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);s&&(t.id=s[1]);let r=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(n.matchAll(r)).forEach(([,d,c])=>{var u;let h=parseInt(((u=c.match(/__QUOTED_(\d+)__/))==null?void 0:u[1])||"0",10),p=i[h];p&&(t[d]=p.slice(1,-1))});let l=n.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return l&&l.split(/\s+/).filter(Boolean).forEach(c=>{c.match(/^[a-zA-Z][\w-]*$/)&&(t[c]=!0)}),t}function $f(e){if(!e||Object.keys(e).length===0)return"";let t=[];return e.class&&String(e.class).split(/\s+/).filter(Boolean).forEach(n=>t.push(`.${n}`)),e.id&&t.push(`#${e.id}`),Object.entries(e).forEach(([i,n])=>{i==="class"||i==="id"||(n===!0?t.push(i):n!==!1&&n!=null&&t.push(`${i}="${String(n)}"`))}),t.join(" ")}function lT(e){let{nodeName:t,name:i,parseAttributes:n=qf,serializeAttributes:o=$f,defaultAttributes:s={},requiredAttributes:r=[],allowedAttributes:a}=e,l=i||t,d=c=>{if(!a)return c;let u={};return a.forEach(h=>{h in c&&(u[h]=c[h])}),u};return{parseMarkdown:(c,u)=>{let h=b(b({},s),c.attributes);return u.createNode(t,h,[])},markdownTokenizer:{name:t,level:"block",start(c){var u;let h=new RegExp(`^:::${l}(?:\\s|$)`,"m"),p=(u=c.match(h))==null?void 0:u.index;return p!==void 0?p:-1},tokenize(c,u,h){let p=new RegExp(`^:::${l}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),g=c.match(p);if(!g)return;let f=g[1]||"",m=n(f);if(!r.find(v=>!(v in m)))return{type:t,raw:g[0],attributes:m}}},renderMarkdown:c=>{let u=d(c.attrs||{}),h=o(u),p=h?` {${h}}`:"";return`:::${l}${p} :::`}}}function dT(e){let{nodeName:t,name:i,getContent:n,parseAttributes:o=qf,serializeAttributes:s=$f,defaultAttributes:r={},content:a="block",allowedAttributes:l}=e,d=i||t,c=u=>{if(!l)return u;let h={};return l.forEach(p=>{p in u&&(h[p]=u[p])}),h};return{parseMarkdown:(u,h)=>{let p;if(n){let f=n(u);p=typeof f=="string"?[{type:"text",text:f}]:f}else a==="block"?p=h.parseChildren(u.tokens||[]):p=h.parseInline(u.tokens||[]);let g=b(b({},r),u.attributes);return h.createNode(t,g,p)},markdownTokenizer:{name:t,level:"block",start(u){var h;let p=new RegExp(`^:::${d}`,"m"),g=(h=u.match(p))==null?void 0:h.index;return g!==void 0?g:-1},tokenize(u,h,p){var g;let f=new RegExp(`^:::${d}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),m=u.match(f);if(!m)return;let[C,v=""]=m,w=o(v),y=1,S=C.length,x="",E=/^:::([\w-]*)(\s.*)?/gm,T=u.slice(S);for(E.lastIndex=0;;){let L=E.exec(T);if(L===null)break;let O=L.index,W=L[1];if(!((g=L[2])!=null&&g.endsWith(":::"))){if(W)y+=1;else if(y-=1,y===0){let G=T.slice(0,O);x=G.trim();let Q=u.slice(0,S+O+L[0].length),ge=[];if(x)if(a==="block")for(ge=p.blockTokens(G),ge.forEach(pe=>{pe.text&&(!pe.tokens||pe.tokens.length===0)&&(pe.tokens=p.inlineTokens(pe.text))});ge.length>0;){let pe=ge[ge.length-1];if(pe.type==="paragraph"&&(!pe.text||pe.text.trim()===""))ge.pop();else break}else ge=p.inlineTokens(x);return{type:t,raw:Q,attributes:w,content:x,tokens:ge}}}}}},renderMarkdown:(u,h)=>{let p=c(u.attrs||{}),g=s(p),f=g?` {${g}}`:"",m=h.renderChildren(u.content||[],`

`);return`:::${d}${f}

${m}

:::`}}}function cT(e){if(!e.trim())return{};let t={},i=/(\w+)=(?:"([^"]*)"|'([^']*)')/g,n=i.exec(e);for(;n!==null;){let[,o,s,r]=n;t[o]=s||r,n=i.exec(e)}return t}function uT(e){return Object.entries(e).filter(([,t])=>t!=null).map(([t,i])=>`${t}="${i}"`).join(" ")}function hT(e){let{nodeName:t,name:i,getContent:n,parseAttributes:o=cT,serializeAttributes:s=uT,defaultAttributes:r={},selfClosing:a=!1,allowedAttributes:l}=e,d=i||t,c=h=>{if(!l)return h;let p={};return l.forEach(g=>{g in h&&(p[g]=h[g])}),p},u=d.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(h,p)=>{let g=b(b({},r),h.attributes);if(a)return p.createNode(t,g);let f=n?n(h):h.content||"";return f?p.createNode(t,g,[p.createTextNode(f)]):p.createNode(t,g,[])},markdownTokenizer:{name:t,level:"inline",start(h){let p=a?new RegExp(`\\[${u}\\s*[^\\]]*\\]`):new RegExp(`\\[${u}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${u}\\]`),g=h.match(p),f=g?.index;return f!==void 0?f:-1},tokenize(h,p,g){let f=a?new RegExp(`^\\[${u}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${u}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${u}\\]`),m=h.match(f);if(!m)return;let C="",v="";if(a){let[,y]=m;v=y}else{let[,y,S]=m;v=y,C=S||""}let w=o(v.trim());return{type:t,raw:m[0],content:C.trim(),attributes:w}}},renderMarkdown:h=>{let p="";n?p=n(h):h.content&&h.content.length>0&&(p=h.content.filter(C=>C.type==="text").map(C=>C.text).join(""));let g=c(h.attrs||{}),f=s(g),m=f?` ${f}`:"";return a?`[${d}${m}]`:`[${d}${m}]${p}[/${d}]`}}}function Lc(e,t,i){var n,o,s,r;let a=e.split(`
`),l=[],d="",c=0,u=t.baseIndentSize||2;for(;c<a.length;){let h=a[c],p=h.match(t.itemPattern);if(!p){if(l.length>0)break;if(h.trim()===""){c+=1,d=`${d}${h}
`;continue}else return}let g=t.extractItemData(p),{indentLevel:f,mainContent:m}=g;d=`${d}${h}
`;let C=[m];for(c+=1;c<a.length;){let S=a[c];if(S.trim()===""){let E=a.slice(c+1).findIndex(O=>O.trim()!=="");if(E===-1)break;if((((o=(n=a[c+1+E].match(/^(\s*)/))==null?void 0:n[1])==null?void 0:o.length)||0)>f){C.push(S),d=`${d}${S}
`,c+=1;continue}else break}if((((r=(s=S.match(/^(\s*)/))==null?void 0:s[1])==null?void 0:r.length)||0)>f)C.push(S),d=`${d}${S}
`,c+=1;else break}let v,w=C.slice(1);if(w.length>0){let S=w.map(x=>x.slice(f+u)).join(`
`);S.trim()&&(t.customNestedParser?v=t.customNestedParser(S):v=i.blockTokens(S))}let y=t.createToken(g,v);l.push(y)}if(l.length!==0)return{items:l,raw:d}}function ol(e,t,i,n){if(!e||!Array.isArray(e.content))return"";let o=typeof i=="function"?i(n):i,[s,...r]=e.content,a=t.renderChildren([s]),l=[`${o}${a}`];return r&&r.length>0&&r.forEach(d=>{let c=t.renderChildren([d]);if(c){let u=c.split(`
`).map(h=>h?t.indent(h):"").join(`
`);l.push(u)}}),l.join(`
`)}function pT(e,t,i={}){let{state:n}=t,{doc:o,tr:s}=n,r=e;o.descendants((a,l)=>{let d=s.mapping.map(l),c=s.mapping.map(l)+a.nodeSize,u=null;if(a.marks.forEach(p=>{if(p!==r)return!1;u=p}),!u)return;let h=!1;if(Object.keys(i).forEach(p=>{i[p]!==u.attrs[p]&&(h=!0)}),h){let p=e.type.create(b(b({},e.attrs),i));s.removeMark(d,c,e.type),s.addMark(d,c,p)}}),s.docChanged&&t.view.dispatch(s)}var $e=class HS extends Uf{constructor(){super(...arguments),this.type="node"}static create(t={}){let i=typeof t=="function"?t():t;return new HS(i)}configure(t){return super.configure(t)}extend(t){let i=typeof t=="function"?t():t;return super.extend(i)}};function Di(e){return new J5({find:e.find,handler:({state:t,range:i,match:n,pasteEvent:o})=>{let s=He(e.getAttributes,void 0,n,o);if(s===!1||s===null)return null;let{tr:r}=t,a=n[n.length-1],l=n[0],d=i.to;if(a){let c=l.search(/\S/),u=i.from+l.indexOf(a),h=u+a.length;if(Tc(i.from,i.to,t.doc).filter(g=>g.mark.type.excluded.find(m=>m===e.type&&m!==g.mark.type)).filter(g=>g.to>u).length)return null;h<i.to&&r.delete(h,i.to),u>i.from&&r.delete(i.from+c,u),d=i.from+c+a.length,r.addMark(i.from+c,d,e.type.create(s||{})),r.removeStoredMark(e.type)}}})}var gT="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5m\xF6gensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",fT="\u03B5\u03BB1\u03C52\u0431\u04331\u0435\u043B3\u0434\u0435\u0442\u04384\u0435\u044E2\u043A\u0430\u0442\u043E\u043B\u0438\u043A6\u043E\u043C3\u043C\u043A\u04342\u043E\u043D1\u0441\u043A\u0432\u04306\u043E\u043D\u043B\u0430\u0439\u043D5\u0440\u04333\u0440\u0443\u04412\u04442\u0441\u0430\u0439\u04423\u0440\u04313\u0443\u043A\u04403\u049B\u0430\u04373\u0570\u0561\u05753\u05D9\u05E9\u05E8\u05D0\u05DC5\u05E7\u05D5\u05DD3\u0627\u0628\u0648\u0638\u0628\u064A5\u0631\u0627\u0645\u0643\u06485\u0644\u0627\u0631\u062F\u06464\u0628\u062D\u0631\u064A\u06465\u062C\u0632\u0627\u0626\u06315\u0633\u0639\u0648\u062F\u064A\u06296\u0639\u0644\u064A\u0627\u06465\u0645\u063A\u0631\u06285\u0645\u0627\u0631\u0627\u062A5\u06CC\u0631\u0627\u06465\u0628\u0627\u0631\u062A2\u0632\u0627\u06314\u064A\u062A\u06433\u06BE\u0627\u0631\u062A5\u062A\u0648\u0646\u06334\u0633\u0648\u062F\u0627\u06463\u0631\u064A\u06295\u0634\u0628\u0643\u06294\u0639\u0631\u0627\u06422\u06282\u0645\u0627\u06464\u0641\u0644\u0633\u0637\u064A\u06466\u0642\u0637\u06313\u0643\u0627\u062B\u0648\u0644\u064A\u06436\u0648\u06453\u0645\u0635\u06312\u0644\u064A\u0633\u064A\u06275\u0648\u0631\u064A\u062A\u0627\u0646\u064A\u06277\u0642\u06394\u0647\u0645\u0631\u0627\u06475\u067E\u0627\u06A9\u0633\u062A\u0627\u06467\u0680\u0627\u0631\u062A4\u0915\u0949\u092E3\u0928\u0947\u091F3\u092D\u093E\u0930\u09240\u092E\u094D3\u094B\u09245\u0938\u0902\u0917\u0920\u09285\u09AC\u09BE\u0982\u09B2\u09BE5\u09AD\u09BE\u09B0\u09A42\u09F0\u09A44\u0A2D\u0A3E\u0A30\u0A244\u0AAD\u0ABE\u0AB0\u0AA44\u0B2D\u0B3E\u0B30\u0B244\u0B87\u0BA8\u0BCD\u0BA4\u0BBF\u0BAF\u0BBE6\u0BB2\u0B99\u0BCD\u0B95\u0BC86\u0B9A\u0BBF\u0B99\u0BCD\u0B95\u0BAA\u0BCD\u0BAA\u0BC2\u0BB0\u0BCD11\u0C2D\u0C3E\u0C30\u0C24\u0C4D5\u0CAD\u0CBE\u0CB0\u0CA44\u0D2D\u0D3E\u0D30\u0D24\u0D025\u0DBD\u0D82\u0D9A\u0DCF4\u0E04\u0E2D\u0E213\u0E44\u0E17\u0E223\u0EA5\u0EB2\u0EA73\u10D2\u10D42\u307F\u3093\u306A3\u30A2\u30DE\u30BE\u30F34\u30AF\u30E9\u30A6\u30C94\u30B0\u30FC\u30B0\u30EB4\u30B3\u30E02\u30B9\u30C8\u30A23\u30BB\u30FC\u30EB3\u30D5\u30A1\u30C3\u30B7\u30E7\u30F36\u30DD\u30A4\u30F3\u30C84\u4E16\u754C2\u4E2D\u4FE11\u56FD1\u570B1\u6587\u7F513\u4E9A\u9A6C\u900A3\u4F01\u4E1A2\u4F5B\u5C712\u4FE1\u606F2\u5065\u5EB72\u516B\u53662\u516C\u53F81\u76CA2\u53F0\u6E7E1\u70632\u5546\u57CE1\u5E971\u68072\u5609\u91CC0\u5927\u9152\u5E975\u5728\u7EBF2\u5927\u62FF2\u5929\u4E3B\u65593\u5A31\u4E502\u5BB6\u96FB2\u5E7F\u4E1C2\u5FAE\u535A2\u6148\u55842\u6211\u7231\u4F603\u624B\u673A2\u62DB\u80582\u653F\u52A11\u5E9C2\u65B0\u52A0\u57612\u95FB2\u65F6\u5C1A2\u66F8\u7C4D2\u673A\u67842\u6DE1\u9A6C\u95213\u6E38\u620F2\u6FB3\u95802\u70B9\u770B2\u79FB\u52A82\u7EC4\u7EC7\u673A\u67844\u7F51\u57401\u5E971\u7AD91\u7EDC2\u8054\u901A2\u8C37\u6B4C2\u8D2D\u72692\u901A\u8CA92\u96C6\u56E22\u96FB\u8A0A\u76C8\u79D14\u98DE\u5229\u6D663\u98DF\u54C12\u9910\u53852\u9999\u683C\u91CC\u62C93\u6E2F2\uB2F7\uB1371\uCEF42\uC0BC\uC1312\uD55C\uAD6D2",Zf="numeric",em="ascii",tm="alpha",al="asciinumeric",rl="alphanumeric",im="domain",$S="emoji",mT="scheme",CT="slashscheme",jf="whitespace";function vT(e,t){return e in t||(t[e]=[]),t[e]}function Ps(e,t,i){t[Zf]&&(t[al]=!0,t[rl]=!0),t[em]&&(t[al]=!0,t[tm]=!0),t[al]&&(t[rl]=!0),t[tm]&&(t[rl]=!0),t[rl]&&(t[im]=!0),t[$S]&&(t[im]=!0);for(let n in t){let o=vT(n,i);o.indexOf(e)<0&&o.push(e)}}function wT(e,t){let i={};for(let n in t)t[n].indexOf(e)>=0&&(i[n]=!0);return i}function ci(e=null){this.j={},this.jr=[],this.jd=null,this.t=e}ci.groups={};ci.prototype={accepts(){return!!this.t},go(e){let t=this,i=t.j[e];if(i)return i;for(let n=0;n<t.jr.length;n++){let o=t.jr[n][0],s=t.jr[n][1];if(s&&o.test(e))return s}return t.jd},has(e,t=!1){return t?e in this.j:!!this.go(e)},ta(e,t,i,n){for(let o=0;o<e.length;o++)this.tt(e[o],t,i,n)},tr(e,t,i,n){n=n||ci.groups;let o;return t&&t.j?o=t:(o=new ci(t),i&&n&&Ps(t,i,n)),this.jr.push([e,o]),o},ts(e,t,i,n){let o=this,s=e.length;if(!s)return o;for(let r=0;r<s-1;r++)o=o.tt(e[r]);return o.tt(e[s-1],t,i,n)},tt(e,t,i,n){n=n||ci.groups;let o=this;if(t&&t.j)return o.j[e]=t,t;let s=t,r,a=o.go(e);if(a?(r=new ci,Object.assign(r.j,a.j),r.jr.push.apply(r.jr,a.jr),r.jd=a.jd,r.t=a.t):r=new ci,s){if(n)if(r.t&&typeof r.t=="string"){let l=Object.assign(wT(r.t,n),i);Ps(s,l,n)}else i&&Ps(s,i,n);r.t=s}return o.j[e]=r,r}};var Ce=(e,t,i,n,o)=>e.ta(t,i,n,o),rt=(e,t,i,n,o)=>e.tr(t,i,n,o),GS=(e,t,i,n,o)=>e.ts(t,i,n,o),B=(e,t,i,n,o)=>e.tt(t,i,n,o),Wn="WORD",nm="UWORD",jS="ASCIINUMERICAL",KS="ALPHANUMERICAL",pl="LOCALHOST",om="TLD",sm="UTLD",Bc="SCHEME",Ar="SLASH_SCHEME",am="NUM",rm="WS",lm="NL",ll="OPENBRACE",dl="CLOSEBRACE",Hc="OPENBRACKET",Gc="CLOSEBRACKET",Vc="OPENPAREN",zc="CLOSEPAREN",Wc="OPENANGLEBRACKET",Uc="CLOSEANGLEBRACKET",qc="FULLWIDTHLEFTPAREN",$c="FULLWIDTHRIGHTPAREN",jc="LEFTCORNERBRACKET",Kc="RIGHTCORNERBRACKET",Yc="LEFTWHITECORNERBRACKET",Xc="RIGHTWHITECORNERBRACKET",Jc="FULLWIDTHLESSTHAN",Qc="FULLWIDTHGREATERTHAN",Zc="AMPERSAND",eu="APOSTROPHE",tu="ASTERISK",Do="AT",iu="BACKSLASH",nu="BACKTICK",ou="CARET",Fo="COLON",dm="COMMA",su="DOLLAR",an="DOT",ru="EQUALS",cm="EXCLAMATION",Ti="HYPHEN",cl="PERCENT",au="PIPE",lu="PLUS",du="POUND",ul="QUERY",um="QUOTE",YS="FULLWIDTHMIDDLEDOT",hm="SEMI",ln="SLASH",hl="TILDE",cu="UNDERSCORE",XS="EMOJI",uu="SYM",JS=Object.freeze({__proto__:null,ALPHANUMERICAL:KS,AMPERSAND:Zc,APOSTROPHE:eu,ASCIINUMERICAL:jS,ASTERISK:tu,AT:Do,BACKSLASH:iu,BACKTICK:nu,CARET:ou,CLOSEANGLEBRACKET:Uc,CLOSEBRACE:dl,CLOSEBRACKET:Gc,CLOSEPAREN:zc,COLON:Fo,COMMA:dm,DOLLAR:su,DOT:an,EMOJI:XS,EQUALS:ru,EXCLAMATION:cm,FULLWIDTHGREATERTHAN:Qc,FULLWIDTHLEFTPAREN:qc,FULLWIDTHLESSTHAN:Jc,FULLWIDTHMIDDLEDOT:YS,FULLWIDTHRIGHTPAREN:$c,HYPHEN:Ti,LEFTCORNERBRACKET:jc,LEFTWHITECORNERBRACKET:Yc,LOCALHOST:pl,NL:lm,NUM:am,OPENANGLEBRACKET:Wc,OPENBRACE:ll,OPENBRACKET:Hc,OPENPAREN:Vc,PERCENT:cl,PIPE:au,PLUS:lu,POUND:du,QUERY:ul,QUOTE:um,RIGHTCORNERBRACKET:Kc,RIGHTWHITECORNERBRACKET:Xc,SCHEME:Bc,SEMI:hm,SLASH:ln,SLASH_SCHEME:Ar,SYM:uu,TILDE:hl,TLD:om,UNDERSCORE:cu,UTLD:sm,UWORD:nm,WORD:Wn,WS:rm}),Vn=/[a-z]/,sl=new RegExp("\\p{L}","u"),Kf=new RegExp("\\p{Emoji}","u");var zn=/\d/,Yf=/\s/;var VS="\r",Xf=`
`,bT="\uFE0F",yT="\u200D",Jf="\uFFFC",_c=null,Oc=null;function ST(e=[]){let t={};ci.groups=t;let i=new ci;_c==null&&(_c=zS(gT)),Oc==null&&(Oc=zS(fT)),B(i,"'",eu),B(i,"{",ll),B(i,"}",dl),B(i,"[",Hc),B(i,"]",Gc),B(i,"(",Vc),B(i,")",zc),B(i,"<",Wc),B(i,">",Uc),B(i,"\uFF08",qc),B(i,"\uFF09",$c),B(i,"\u300C",jc),B(i,"\u300D",Kc),B(i,"\u300E",Yc),B(i,"\u300F",Xc),B(i,"\uFF1C",Jc),B(i,"\uFF1E",Qc),B(i,"&",Zc),B(i,"*",tu),B(i,"@",Do),B(i,"`",nu),B(i,"^",ou),B(i,":",Fo),B(i,",",dm),B(i,"$",su),B(i,".",an),B(i,"=",ru),B(i,"!",cm),B(i,"-",Ti),B(i,"%",cl),B(i,"|",au),B(i,"+",lu),B(i,"#",du),B(i,"?",ul),B(i,'"',um),B(i,"/",ln),B(i,";",hm),B(i,"~",hl),B(i,"_",cu),B(i,"\\",iu),B(i,"\u30FB",YS);let n=rt(i,zn,am,{[Zf]:!0});rt(n,zn,n);let o=rt(n,Vn,jS,{[al]:!0}),s=rt(n,sl,KS,{[rl]:!0}),r=rt(i,Vn,Wn,{[em]:!0});rt(r,zn,o),rt(r,Vn,r),rt(o,zn,o),rt(o,Vn,o);let a=rt(i,sl,nm,{[tm]:!0});rt(a,Vn),rt(a,zn,s),rt(a,sl,a),rt(s,zn,s),rt(s,Vn),rt(s,sl,s);let l=B(i,Xf,lm,{[jf]:!0}),d=B(i,VS,rm,{[jf]:!0}),c=rt(i,Yf,rm,{[jf]:!0});B(i,Jf,c),B(d,Xf,l),B(d,Jf,c),rt(d,Yf,c),B(c,VS),B(c,Xf),rt(c,Yf,c),B(c,Jf,c);let u=rt(i,Kf,XS,{[$S]:!0});B(u,"#"),rt(u,Kf,u),B(u,bT,u);let h=B(u,yT);B(h,"#"),rt(h,Kf,u);let p=[[Vn,r],[zn,o]],g=[[Vn,null],[sl,a],[zn,s]];for(let f=0;f<_c.length;f++)ko(i,_c[f],om,Wn,p);for(let f=0;f<Oc.length;f++)ko(i,Oc[f],sm,nm,g);Ps(om,{tld:!0,ascii:!0},t),Ps(sm,{utld:!0,alpha:!0},t),ko(i,"file",Bc,Wn,p),ko(i,"mailto",Bc,Wn,p),ko(i,"http",Ar,Wn,p),ko(i,"https",Ar,Wn,p),ko(i,"ftp",Ar,Wn,p),ko(i,"ftps",Ar,Wn,p),Ps(Bc,{scheme:!0,ascii:!0},t),Ps(Ar,{slashscheme:!0,ascii:!0},t),e=e.sort((f,m)=>f[0]>m[0]?1:-1);for(let f=0;f<e.length;f++){let m=e[f][0],v=e[f][1]?{[mT]:!0}:{[CT]:!0};m.indexOf("-")>=0?v[im]=!0:Vn.test(m)?zn.test(m)?v[al]=!0:v[em]=!0:v[Zf]=!0,GS(i,m,m,v)}return GS(i,"localhost",pl,{ascii:!0}),i.jd=new ci(uu),{start:i,tokens:Object.assign({groups:t},JS)}}function QS(e,t){let i=xT(t.replace(/[A-Z]/g,a=>a.toLowerCase())),n=i.length,o=[],s=0,r=0;for(;r<n;){let a=e,l=null,d=0,c=null,u=-1,h=-1;for(;r<n&&(l=a.go(i[r]));)a=l,a.accepts()?(u=0,h=0,c=a):u>=0&&(u+=i[r].length,h++),d+=i[r].length,s+=i[r].length,r++;s-=u,r-=h,d-=u,o.push({t:c.t,v:t.slice(s-d,s),s:s-d,e:s})}return o}function xT(e){let t=[],i=e.length,n=0;for(;n<i;){let o=e.charCodeAt(n),s,r=o<55296||o>56319||n+1===i||(s=e.charCodeAt(n+1))<56320||s>57343?e[n]:e.slice(n,n+2);t.push(r),n+=r.length}return t}function ko(e,t,i,n,o){let s,r=t.length;for(let a=0;a<r-1;a++){let l=t[a];e.j[l]?s=e.j[l]:(s=new ci(n),s.jr=o.slice(),e.j[l]=s),e=s}return s=new ci(i),s.jr=o.slice(),e.j[t[r-1]]=s,s}function zS(e){let t=[],i=[],n=0,o="0123456789";for(;n<e.length;){let s=0;for(;o.indexOf(e[n+s])>=0;)s++;if(s>0){t.push(i.join(""));for(let r=parseInt(e.substring(n,n+s),10);r>0;r--)i.pop();n+=s}else i.push(e[n]),n++}return t}var gl={defaultProtocol:"http",events:null,format:WS,formatHref:WS,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function pm(e,t=null){let i=Object.assign({},gl);e&&(i=Object.assign(i,e instanceof pm?e.o:e));let n=i.ignoreTags,o=[];for(let s=0;s<n.length;s++)o.push(n[s].toUpperCase());this.o=i,t&&(this.defaultRender=t),this.ignoreTags=o}pm.prototype={o:gl,ignoreTags:[],defaultRender(e){return e},check(e){return this.get("validate",e.toString(),e)},get(e,t,i){let n=t!=null,o=this.o[e];return o&&(typeof o=="object"?(o=i.t in o?o[i.t]:gl[e],typeof o=="function"&&n&&(o=o(t,i))):typeof o=="function"&&n&&(o=o(t,i.t,i)),o)},getObj(e,t,i){let n=this.o[e];return typeof n=="function"&&t!=null&&(n=n(t,i.t,i)),n},render(e){let t=e.render(this);return(this.get("render",null,e)||this.defaultRender)(t,e.t,e)}};function WS(e){return e}function ZS(e,t){this.t="token",this.v=e,this.tk=t}ZS.prototype={isLink:!1,toString(){return this.v},toHref(e){return this.toString()},toFormattedString(e){let t=this.toString(),i=e.get("truncate",t,this),n=e.get("format",t,this);return i&&n.length>i?n.substring(0,i)+"\u2026":n},toFormattedHref(e){return e.get("formatHref",this.toHref(e.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(e=gl.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(e),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(e){return{type:this.t,value:this.toFormattedString(e),isLink:this.isLink,href:this.toFormattedHref(e),start:this.startIndex(),end:this.endIndex()}},validate(e){return e.get("validate",this.toString(),this)},render(e){let t=this,i=this.toHref(e.get("defaultProtocol")),n=e.get("formatHref",i,this),o=e.get("tagName",i,t),s=this.toFormattedString(e),r={},a=e.get("className",i,t),l=e.get("target",i,t),d=e.get("rel",i,t),c=e.getObj("attributes",i,t),u=e.getObj("events",i,t);return r.href=n,a&&(r.class=a),l&&(r.target=l),d&&(r.rel=d),c&&Object.assign(r,c),{tagName:o,attributes:r,content:s,eventListeners:u}}};function hu(e,t){class i extends ZS{constructor(o,s){super(o,s),this.t=e}}for(let n in t)i.prototype[n]=t[n];return i.t=e,i}var US=hu("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),qS=hu("text"),ET=hu("nl"),Nc=hu("url",{isLink:!0,toHref(e=gl.defaultProtocol){return this.hasProtocol()?this.v:`${e}://${this.v}`},hasProtocol(){let e=this.tk;return e.length>=2&&e[0].t!==pl&&e[1].t===Fo}});var Fi=e=>new ci(e);function RT({groups:e}){let t=e.domain.concat([Zc,tu,Do,iu,nu,ou,su,ru,Ti,am,cl,au,lu,du,ln,uu,hl,cu]),i=[eu,Fo,dm,an,cm,cl,ul,um,hm,Wc,Uc,ll,dl,Gc,Hc,Vc,zc,qc,$c,jc,Kc,Yc,Xc,Jc,Qc],n=[Zc,eu,tu,iu,nu,ou,su,ru,Ti,ll,dl,cl,au,lu,du,ul,ln,uu,hl,cu],o=Fi(),s=B(o,hl);Ce(s,n,s),Ce(s,e.domain,s);let r=Fi(),a=Fi(),l=Fi();Ce(o,e.domain,r),Ce(o,e.scheme,a),Ce(o,e.slashscheme,l),Ce(r,n,s),Ce(r,e.domain,r);let d=B(r,Do);B(s,Do,d),B(a,Do,d),B(l,Do,d);let c=B(s,an);Ce(c,n,s),Ce(c,e.domain,s);let u=Fi();Ce(d,e.domain,u),Ce(u,e.domain,u);let h=B(u,an);Ce(h,e.domain,u);let p=Fi(US);Ce(h,e.tld,p),Ce(h,e.utld,p),B(d,pl,p);let g=B(u,Ti);B(g,Ti,g),Ce(g,e.domain,u),Ce(p,e.domain,u),B(p,an,h),B(p,Ti,g);let f=B(p,Fo);Ce(f,e.numeric,US);let m=B(r,Ti),C=B(r,an);B(m,Ti,m),Ce(m,e.domain,r),Ce(C,n,s),Ce(C,e.domain,r);let v=Fi(Nc);Ce(C,e.tld,v),Ce(C,e.utld,v),Ce(v,e.domain,r),Ce(v,n,s),B(v,an,C),B(v,Ti,m),B(v,Do,d);let w=B(v,Fo),y=Fi(Nc);Ce(w,e.numeric,y);let S=Fi(Nc),x=Fi();Ce(S,t,S),Ce(S,i,x),Ce(x,t,S),Ce(x,i,x),B(v,ln,S),B(y,ln,S);let E=B(a,Fo),T=B(l,Fo),L=B(T,ln),O=B(L,ln);Ce(a,e.domain,r),B(a,an,C),B(a,Ti,m),Ce(l,e.domain,r),B(l,an,C),B(l,Ti,m),Ce(E,e.domain,S),B(E,ln,S),B(E,ul,S),Ce(O,e.domain,S),Ce(O,t,S),B(O,ln,S);let W=[[ll,dl],[Hc,Gc],[Vc,zc],[Wc,Uc],[qc,$c],[jc,Kc],[Yc,Xc],[Jc,Qc]];for(let G=0;G<W.length;G++){let[Q,ge]=W[G],pe=B(S,Q);B(x,Q,pe),B(pe,ge,S);let ot=Fi(Nc);Ce(pe,t,ot);let gi=Fi();Ce(pe,i),Ce(ot,t,ot),Ce(ot,i,gi),Ce(gi,t,ot),Ce(gi,i,gi),B(ot,ge,S),B(gi,ge,S)}return B(o,pl,v),B(o,lm,ET),{start:o,tokens:JS}}function PT(e,t,i){let n=i.length,o=0,s=[],r=[];for(;o<n;){let a=e,l=null,d=null,c=0,u=null,h=-1;for(;o<n&&!(l=a.go(i[o].t));)r.push(i[o++]);for(;o<n&&(d=l||a.go(i[o].t));)l=null,a=d,a.accepts()?(h=0,u=a):h>=0&&h++,o++,c++;if(h<0)o-=c,o<n&&(r.push(i[o]),o++);else{r.length>0&&(s.push(Qf(qS,t,r)),r=[]),o-=h,c-=h;let p=u.t,g=i.slice(o-c,o);s.push(Qf(p,t,g))}}return r.length>0&&s.push(Qf(qS,t,r)),s}function Qf(e,t,i){let n=i[0].s,o=i[i.length-1].e,s=t.slice(n,o);return new e(s,i)}var MT=typeof console<"u"&&console&&console.warn||(()=>{}),kT="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",Xe={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function e2(){return ci.groups={},Xe.scanner=null,Xe.parser=null,Xe.tokenQueue=[],Xe.pluginQueue=[],Xe.customSchemes=[],Xe.initialized=!1,Xe}function gm(e,t=!1){if(Xe.initialized&&MT(`linkifyjs: already initialized - will not register custom scheme "${e}" ${kT}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(e))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);Xe.customSchemes.push([e,t])}function DT(){Xe.scanner=ST(Xe.customSchemes);for(let e=0;e<Xe.tokenQueue.length;e++)Xe.tokenQueue[e][1]({scanner:Xe.scanner});Xe.parser=RT(Xe.scanner.tokens);for(let e=0;e<Xe.pluginQueue.length;e++)Xe.pluginQueue[e][1]({scanner:Xe.scanner,parser:Xe.parser});return Xe.initialized=!0,Xe}function pu(e){return Xe.initialized||DT(),PT(Xe.parser.start,e,QS(Xe.scanner.start,e))}pu.scan=QS;function gu(e,t=null,i=null){if(t&&typeof t=="object"){if(i)throw Error(`linkifyjs: Invalid link type ${t}; must be a string`);i=t,t=null}let n=new pm(i),o=pu(e),s=[];for(let r=0;r<o.length;r++){let a=o[r];a.isLink&&(!t||a.t===t)&&n.check(a)&&s.push(a.toFormattedObject(n))}return s}var fm="[\0- \xA0\u1680\u180E\u2000-\u2029\u205F\u3000]",FT=new RegExp(fm),TT=new RegExp(`${fm}$`),AT=new RegExp(fm,"g");function IT(e){return e.length===1?e[0].isLink:e.length===3&&e[1].isLink?["()","[]"].includes(e[0].value+e[2].value):!1}function LT(e){return new he({key:new ve("autolink"),appendTransaction:(t,i,n)=>{let o=t.some(d=>d.docChanged)&&!i.doc.eq(n.doc),s=t.some(d=>d.getMeta("preventAutolink"));if(!o||s)return;let{tr:r}=n,a=Hf(i.doc,[...t]);if(Wf(a).forEach(({newRange:d})=>{let c=gS(n.doc,d,p=>p.isTextblock),u,h;if(c.length>1)u=c[0],h=n.doc.textBetween(u.pos,u.pos+u.node.nodeSize,void 0," ");else if(c.length){let p=n.doc.textBetween(d.from,d.to," "," ");if(!TT.test(p))return;u=c[0],h=n.doc.textBetween(u.pos,d.to,void 0," ")}if(u&&h){let p=h.split(FT).filter(Boolean);if(p.length<=0)return!1;let g=p[p.length-1],f=u.pos+h.lastIndexOf(g);if(!g)return!1;let m=pu(g).map(C=>C.toObject(e.defaultProtocol));if(!IT(m))return!1;m.filter(C=>C.isLink).map(C=>_(b({},C),{from:f+C.start+1,to:f+C.end+1})).filter(C=>n.schema.marks.code?!n.doc.rangeHasMark(C.from,C.to,n.schema.marks.code):!0).filter(C=>e.validate(C.value)).filter(C=>e.shouldAutoLink(C.value)).forEach(C=>{Tc(C.from,C.to,n.doc).some(v=>v.mark.type===e.type)||r.addMark(C.from,C.to,e.type.create({href:C.href}))})}}),!!r.steps.length)return r}})}function _T(e){return new he({key:new ve("handleClickLink"),props:{handleClick:(t,i,n)=>{var o,s;if(n.button!==0||!t.editable)return!1;let r=null;if(n.target instanceof HTMLAnchorElement)r=n.target;else{let c=n.target,u=[];for(;c.nodeName!=="DIV";)u.push(c),c=c.parentNode;r=u.find(h=>h.nodeName==="A")}if(!r)return!1;let a=zf(t.state,e.type.name),l=(o=r?.href)!=null?o:a.href,d=(s=r?.target)!=null?s:a.target;return e.enableClickSelection&&e.editor.commands.extendMarkRange(e.type.name),r&&l?(window.open(l,d),!0):!1}}})}function OT(e){return new he({key:new ve("handlePasteLink"),props:{handlePaste:(t,i,n)=>{let{shouldAutoLink:o}=e,{state:s}=t,{selection:r}=s,{empty:a}=r;if(a)return!1;let l="";n.content.forEach(c=>{l+=c.textContent});let d=gu(l,{defaultProtocol:e.defaultProtocol}).find(c=>c.isLink&&c.value===l);return!l||!d||o!==void 0&&!o(d.href)?!1:e.editor.commands.setMark(e.type,{href:d.href})}}})}function Ms(e,t){let i=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach(n=>{let o=typeof n=="string"?n:n.scheme;o&&i.push(o)}),!e||e.replace(AT,"").match(new RegExp(`^(?:(?:${i.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var mm=mi.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(e=>{if(typeof e=="string"){gm(e);return}gm(e.scheme,e.optionalSlashes)})},onDestroy(){e2()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(e,t)=>!!Ms(e,t.protocols),validate:e=>!!e,shouldAutoLink:e=>!!e}},addAttributes(){return{href:{default:null,parseHTML(e){return e.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:e=>{let t=e.getAttribute("href");return!t||!this.options.isAllowedUri(t,{defaultValidate:i=>!!Ms(i,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:e}){return this.options.isAllowedUri(e.href,{defaultValidate:t=>!!Ms(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",ye(this.options.HTMLAttributes,e),0]:["a",ye(this.options.HTMLAttributes,_(b({},e),{href:""})),0]},markdownTokenName:"link",parseMarkdown:(e,t)=>t.applyMark("link",t.parseInline(e.tokens||[]),{href:e.href,title:e.title||null}),renderMarkdown:(e,t)=>{var i;let n=((i=e.attrs)==null?void 0:i.href)||"";return`[${t.renderChildren(e)}](${n})`},addCommands(){return{setLink:e=>({chain:t})=>{let{href:i}=e;return this.options.isAllowedUri(i,{defaultValidate:n=>!!Ms(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?t().setMark(this.name,e).setMeta("preventAutolink",!0).run():!1},toggleLink:e=>({chain:t})=>{let{href:i}=e||{};return i&&!this.options.isAllowedUri(i,{defaultValidate:n=>!!Ms(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:t().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[Di({find:e=>{let t=[];if(e){let{protocols:i,defaultProtocol:n}=this.options,o=gu(e).filter(s=>s.isLink&&this.options.isAllowedUri(s.value,{defaultValidate:r=>!!Ms(r,i),protocols:i,defaultProtocol:n}));o.length&&o.forEach(s=>{this.options.shouldAutoLink(s.value)&&t.push({text:s.value,data:{href:s.href},index:s.start})})}return t},type:this.type,getAttributes:e=>{var t;return{href:(t=e.data)==null?void 0:t.href}}})]},addProseMirrorPlugins(){let e=[],{protocols:t,defaultProtocol:i}=this.options;return this.options.autolink&&e.push(LT({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:n=>this.options.isAllowedUri(n,{defaultValidate:o=>!!Ms(o,t),protocols:t,defaultProtocol:i}),shouldAutoLink:this.options.shouldAutoLink})),this.options.openOnClick===!0&&e.push(_T({type:this.type,editor:this.editor,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&e.push(OT({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),e}}),t2=mm;var Ir=(e,t)=>{if(e==="slot")return 0;if(e instanceof Function)return e(t);let o=t??{},{children:i}=o,n=oi(o,["children"]);if(e==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[e,n,i]};var NT=/^\s*>\s$/,i2=$e.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:e}){return Ir("blockquote",_(b({},ye(this.options.HTMLAttributes,e)),{children:Ir("slot",{})}))},parseMarkdown:(e,t)=>t.createNode("blockquote",void 0,t.parseChildren(e.tokens||[])),renderMarkdown:(e,t)=>{if(!e.content)return"";let i=">",n=[];return e.content.forEach(o=>{let a=t.renderChildren([o]).split(`
`).map(l=>l.trim()===""?i:`${i} ${l}`);n.push(a.join(`
`))}),n.join(`
${i}
`)},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[rn({find:NT,type:this.type})]}});var BT=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,HT=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,GT=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,VT=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,n2=mi.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>e.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return Ir("strong",_(b({},ye(this.options.HTMLAttributes,e)),{children:Ir("slot",{})}))},markdownTokenName:"strong",parseMarkdown:(e,t)=>t.applyMark("bold",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`**${t.renderChildren(e)}**`,addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[sn({find:BT,type:this.type}),sn({find:GT,type:this.type})]},addPasteRules(){return[Di({find:HT,type:this.type}),Di({find:VT,type:this.type})]}});var zT=/(^|[^`])`([^`]+)`(?!`)$/,WT=/(^|[^`])`([^`]+)`(?!`)/g,o2=mi.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:e}){return["code",ye(this.options.HTMLAttributes,e),0]},markdownTokenName:"codespan",parseMarkdown:(e,t)=>t.applyMark("code",[{type:"text",text:e.text||""}]),renderMarkdown:(e,t)=>e.content?`\`${t.renderChildren(e.content)}\``:"",addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[sn({find:zT,type:this.type})]},addPasteRules(){return[Di({find:WT,type:this.type})]}});var Cm=4,UT=/^```([a-z]+)?[\s\n]$/,qT=/^~~~([a-z]+)?[\s\n]$/,s2=$e.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:Cm,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;let{languageClassPrefix:i}=this.options;if(!i)return null;let s=[...((t=e.firstElementChild)==null?void 0:t.classList)||[]].filter(r=>r.startsWith(i)).map(r=>r.replace(i,""))[0];return s||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:e,HTMLAttributes:t}){return["pre",ye(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(e,t)=>{var i;return((i=e.raw)==null?void 0:i.startsWith("```"))===!1&&e.codeBlockStyle!=="indented"?[]:t.createNode("codeBlock",{language:e.lang||null},e.text?[t.createTextNode(e.text)]:[])},renderMarkdown:(e,t)=>{var i;let n="",o=((i=e.attrs)==null?void 0:i.language)||"";return e.content?n=[`\`\`\`${o}`,t.renderChildren(e.content),"```"].join(`
`):n=`\`\`\`${o}

\`\`\``,n},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{let{empty:e,$anchor:t}=this.editor.state.selection,i=t.pos===1;return!e||t.parent.type.name!==this.name?!1:i||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:e})=>{var t;if(!this.options.enableTabIndentation)return!1;let i=(t=this.options.tabSize)!=null?t:Cm,{state:n}=e,{selection:o}=n,{$from:s,empty:r}=o;if(s.parent.type!==this.type)return!1;let a=" ".repeat(i);return r?e.commands.insertContent(a):e.commands.command(({tr:l})=>{let{from:d,to:c}=o,p=n.doc.textBetween(d,c,`
`,`
`).split(`
`).map(g=>a+g).join(`
`);return l.replaceWith(d,c,n.schema.text(p)),!0})},"Shift-Tab":({editor:e})=>{var t;if(!this.options.enableTabIndentation)return!1;let i=(t=this.options.tabSize)!=null?t:Cm,{state:n}=e,{selection:o}=n,{$from:s,empty:r}=o;return s.parent.type!==this.type?!1:r?e.commands.command(({tr:a})=>{var l;let{pos:d}=s,c=s.start(),u=s.end(),p=n.doc.textBetween(c,u,`
`,`
`).split(`
`),g=0,f=0,m=d-c;for(let x=0;x<p.length;x+=1){if(f+p[x].length>=m){g=x;break}f+=p[x].length+1}let v=((l=p[g].match(/^ */))==null?void 0:l[0])||"",w=Math.min(v.length,i);if(w===0)return!0;let y=c;for(let x=0;x<g;x+=1)y+=p[x].length+1;return a.delete(y,y+w),d-y<=w&&a.setSelection(ne.create(a.doc,y)),!0}):e.commands.command(({tr:a})=>{let{from:l,to:d}=o,h=n.doc.textBetween(l,d,`
`,`
`).split(`
`).map(p=>{var g;let f=((g=p.match(/^ */))==null?void 0:g[0])||"",m=Math.min(f.length,i);return p.slice(m)}).join(`
`);return a.replaceWith(l,d,n.schema.text(h)),!0})},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;let{state:t}=e,{selection:i}=t,{$from:n,empty:o}=i;if(!o||n.parent.type!==this.type)return!1;let s=n.parentOffset===n.parent.nodeSize-2,r=n.parent.textContent.endsWith(`

`);return!s||!r?!1:e.chain().command(({tr:a})=>(a.delete(n.pos-2,n.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;let{state:t}=e,{selection:i,doc:n}=t,{$from:o,empty:s}=i;if(!s||o.parent.type!==this.type||!(o.parentOffset===o.parent.nodeSize-2))return!1;let a=o.after();return a===void 0?!1:n.nodeAt(a)?e.commands.command(({tr:d})=>(d.setSelection(de.near(n.resolve(a))),!0)):e.commands.exitCode()}}},addInputRules(){return[nl({find:UT,type:this.type,getAttributes:e=>({language:e[1]})}),nl({find:qT,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new he({key:new ve("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;let i=t.clipboardData.getData("text/plain"),n=t.clipboardData.getData("vscode-editor-data"),o=n?JSON.parse(n):void 0,s=o?.mode;if(!i||!s)return!1;let{tr:r,schema:a}=e.state,l=a.text(i.replace(/\r\n?/g,`
`));return r.replaceSelectionWith(this.type.create({language:s},l)),r.selection.$from.parent.type!==this.type&&r.setSelection(ne.near(r.doc.resolve(Math.max(0,r.selection.from-2)))),r.setMeta("paste",!0),e.dispatch(r),!0}}})]}});var r2=$e.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`

`):""});var a2=$e.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:e}){return["br",ye(this.options.HTMLAttributes,e)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:i,editor:n})=>e.first([()=>e.exitCode(),()=>e.command(()=>{let{selection:o,storedMarks:s}=i;if(o.$from.parent.type.spec.isolating)return!1;let{keepMarks:r}=this.options,{splittableMarks:a}=n.extensionManager,l=s||o.$to.parentOffset&&o.$from.marks();return t().insertContent({type:this.name}).command(({tr:d,dispatch:c})=>{if(c&&l&&r){let u=l.filter(h=>a.includes(h.type.name));d.ensureMarks(u)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}});var l2=$e.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,ye(this.options.HTMLAttributes,t),0]},parseMarkdown:(e,t)=>t.createNode("heading",{level:e.depth||1},t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>{var i;let n=(i=e.attrs)!=null&&i.level?parseInt(e.attrs.level,10):1,o="#".repeat(n);return e.content?`${o} ${t.renderChildren(e.content)}`:""},addCommands(){return{setHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.setNode(this.name,e):!1,toggleHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.toggleNode(this.name,"paragraph",e):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>_(b({},e),{[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>nl({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}});var d2=$e.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:e}){return["hr",ye(this.options.HTMLAttributes,e)]},markdownTokenName:"hr",parseMarkdown:(e,t)=>t.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{if(!BS(t,t.schema.nodes[this.name]))return!1;let{selection:i}=t,{$to:n}=i,o=e();return Ac(i)?o.insertContentAt(n.pos,{type:this.name}):o.insertContent({type:this.name}),o.command(({state:s,tr:r,dispatch:a})=>{if(a){let{$to:l}=r.selection,d=l.end();if(l.nodeAfter)l.nodeAfter.isTextblock?r.setSelection(ne.create(r.doc,l.pos+1)):l.nodeAfter.isBlock?r.setSelection(J.create(r.doc,l.pos)):r.setSelection(ne.create(r.doc,l.pos));else{let c=s.schema.nodes[this.options.nextNodeType]||l.parent.type.contentMatch.defaultType,u=c?.create();u&&(r.insert(d,u),r.setSelection(ne.create(r.doc,d+1)))}r.scrollIntoView()}return!0}).run()}}},addInputRules(){return[NS({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}});var $T=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,jT=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,KT=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,YT=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,c2=mi.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>e.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",ye(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(e,t)=>t.applyMark("italic",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`*${t.renderChildren(e)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[sn({find:$T,type:this.type}),sn({find:KT,type:this.type})]},addPasteRules(){return[Di({find:jT,type:this.type}),Di({find:YT,type:this.type})]}});var XT=Object.defineProperty,JT=(e,t)=>{for(var i in t)XT(e,i,{get:t[i],enumerable:!0})},QT="listItem",u2="textStyle",h2=/^\s*([-+*])\s$/,bm=$e.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:e}){return["ul",ye(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:(e,t)=>e.type!=="list"||e.ordered?[]:{type:"bulletList",content:e.items?t.parseChildren(e.items):[]},renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(QT,this.editor.getAttributes(u2)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=rn({find:h2,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=rn({find:h2,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(u2),editor:this.editor})),[e]}}),ym=$e.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",ye(this.options.HTMLAttributes,e),0]},markdownTokenName:"list_item",parseMarkdown:(e,t)=>{if(e.type!=="list_item")return[];let i=[];if(e.tokens&&e.tokens.length>0)if(e.tokens.some(o=>o.type==="paragraph"))i=t.parseChildren(e.tokens);else{let o=e.tokens[0];if(o&&o.type==="text"&&o.tokens&&o.tokens.length>0){if(i=[{type:"paragraph",content:t.parseInline(o.tokens)}],e.tokens.length>1){let r=e.tokens.slice(1),a=t.parseChildren(r);i.push(...a)}}else i=t.parseChildren(e.tokens)}return i.length===0&&(i=[{type:"paragraph",content:[]}]),{type:"listItem",content:i}},renderMarkdown:(e,t,i)=>ol(e,t,n=>n.parentType==="bulletList"?"- ":n.parentType==="orderedList"?`${n.index+1}. `:"- ",i),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),ZT={};JT(ZT,{findListItemPos:()=>fl,getNextListDepth:()=>Sm,handleBackspace:()=>vm,handleDelete:()=>wm,hasListBefore:()=>m2,hasListItemAfter:()=>e8,hasListItemBefore:()=>C2,listItemHasSubList:()=>v2,nextListIsDeeper:()=>w2,nextListIsHigher:()=>b2});var fl=(e,t)=>{let{$from:i}=t.selection,n=st(e,t.schema),o=null,s=i.depth,r=i.pos,a=null;for(;s>0&&a===null;)o=i.node(s),o.type===n?a=s:(s-=1,r-=1);return a===null?null:{$pos:t.doc.resolve(r),depth:a}},Sm=(e,t)=>{let i=fl(e,t);if(!i)return!1;let[,n]=wS(t,e,i.$pos.pos+4);return n},m2=(e,t,i)=>{let{$anchor:n}=e.selection,o=Math.max(0,n.pos-2),s=e.doc.resolve(o).node();return!(!s||!i.includes(s.type.name))},C2=(e,t)=>{var i;let{$anchor:n}=t.selection,o=t.doc.resolve(n.pos-2);return!(o.index()===0||((i=o.nodeBefore)==null?void 0:i.type.name)!==e)},v2=(e,t,i)=>{if(!i)return!1;let n=st(e,t.schema),o=!1;return i.descendants(s=>{s.type===n&&(o=!0)}),o},vm=(e,t,i)=>{if(e.commands.undoInputRule())return!0;if(e.state.selection.from!==e.state.selection.to)return!1;if(!on(e.state,t)&&m2(e.state,t,i)){let{$anchor:a}=e.state.selection,l=e.state.doc.resolve(a.before()-1),d=[];l.node().descendants((h,p)=>{h.type.name===t&&d.push({node:h,pos:p})});let c=d.at(-1);if(!c)return!1;let u=e.state.doc.resolve(l.start()+c.pos+1);return e.chain().cut({from:a.start()-1,to:a.end()+1},u.end()).joinForward().run()}if(!on(e.state,t)||!yS(e.state))return!1;let n=fl(t,e.state);if(!n)return!1;let s=e.state.doc.resolve(n.$pos.pos-2).node(n.depth),r=v2(t,e.state,s);return C2(t,e.state)&&!r?e.commands.joinItemBackward():e.chain().liftListItem(t).run()},w2=(e,t)=>{let i=Sm(e,t),n=fl(e,t);return!n||!i?!1:i>n.depth},b2=(e,t)=>{let i=Sm(e,t),n=fl(e,t);return!n||!i?!1:i<n.depth},wm=(e,t)=>{if(!on(e.state,t)||!bS(e.state,t))return!1;let{selection:i}=e.state,{$from:n,$to:o}=i;return!i.empty&&n.sameParent(o)?!1:w2(t,e.state)?e.chain().focus(e.state.selection.from+4).lift(t).joinBackward().run():b2(t,e.state)?e.chain().joinForward().joinBackward().run():e.commands.joinItemForward()},e8=(e,t)=>{var i;let{$anchor:n}=t.selection,o=t.doc.resolve(n.pos-n.parentOffset-2);return!(o.index()===o.parent.childCount-1||((i=o.nodeAfter)==null?void 0:i.type.name)!==e)},xm=Ie.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:i})=>{e.state.schema.nodes[i]!==void 0&&wm(e,i)&&(t=!0)}),t},"Mod-Delete":({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:i})=>{e.state.schema.nodes[i]!==void 0&&wm(e,i)&&(t=!0)}),t},Backspace:({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:i,wrapperNames:n})=>{e.state.schema.nodes[i]!==void 0&&vm(e,i,n)&&(t=!0)}),t},"Mod-Backspace":({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:i,wrapperNames:n})=>{e.state.schema.nodes[i]!==void 0&&vm(e,i,n)&&(t=!0)}),t}}}}),p2=/^(\s*)(\d+)\.\s+(.*)$/,t8=/^\s/;function i8(e){let t=[],i=0,n=0;for(;i<e.length;){let o=e[i],s=o.match(p2);if(!s)break;let[,r,a,l]=s,d=r.length,c=l,u=i+1,h=[o];for(;u<e.length;){let p=e[u];if(p.match(p2))break;if(p.trim()==="")h.push(p),c+=`
`,u+=1;else if(p.match(t8))h.push(p),c+=`
${p.slice(d+2)}`,u+=1;else break}t.push({indent:d,number:parseInt(a,10),content:c.trim(),raw:h.join(`
`)}),n=u,i=u}return[t,n]}function y2(e,t,i){var n;let o=[],s=0;for(;s<e.length;){let r=e[s];if(r.indent===t){let a=r.content.split(`
`),l=((n=a[0])==null?void 0:n.trim())||"",d=[];l&&d.push({type:"paragraph",raw:l,tokens:i.inlineTokens(l)});let c=a.slice(1).join(`
`).trim();if(c){let p=i.blockTokens(c);d.push(...p)}let u=s+1,h=[];for(;u<e.length&&e[u].indent>t;)h.push(e[u]),u+=1;if(h.length>0){let p=Math.min(...h.map(f=>f.indent)),g=y2(h,p,i);d.push({type:"list",ordered:!0,start:h[0].number,items:g,raw:h.map(f=>f.raw).join(`
`)})}o.push({type:"list_item",raw:r.raw,tokens:d}),s=u}else s+=1}return o}function n8(e,t){return e.map(i=>{if(i.type!=="list_item")return t.parseChildren([i])[0];let n=[];return i.tokens&&i.tokens.length>0&&i.tokens.forEach(o=>{if(o.type==="paragraph"||o.type==="list"||o.type==="blockquote"||o.type==="code")n.push(...t.parseChildren([o]));else if(o.type==="text"&&o.tokens){let s=t.parseChildren([o]);n.push({type:"paragraph",content:s})}else{let s=t.parseChildren([o]);s.length>0&&n.push(...s)}}),{type:"listItem",content:n}})}var o8="listItem",g2="textStyle",f2=/^(\d+)\.\s$/,Em=$e.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:null,parseHTML:e=>e.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:e}){let n=e,{start:t}=n,i=oi(n,["start"]);return t===1?["ol",ye(this.options.HTMLAttributes,i),0]:["ol",ye(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:(e,t)=>{if(e.type!=="list"||!e.ordered)return[];let i=e.start||1,n=e.items?n8(e.items,t):[];return i!==1?{type:"orderedList",attrs:{start:i},content:n}:{type:"orderedList",content:n}},renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:e=>{let t=e.match(/^(\s*)(\d+)\.\s+/),i=t?.index;return i!==void 0?i:-1},tokenize:(e,t,i)=>{var n;let o=e.split(`
`),[s,r]=i8(o);if(s.length===0)return;let a=y2(s,0,i);return a.length===0?void 0:{type:"list",ordered:!0,start:((n=s[0])==null?void 0:n.number)||1,items:a,raw:o.slice(0,r).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(o8,this.editor.getAttributes(g2)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=rn({find:f2,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,i)=>i.childCount+i.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=rn({find:f2,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>b({start:+t[1]},this.editor.getAttributes(g2)),joinPredicate:(t,i)=>i.childCount+i.attrs.start===+t[1],editor:this.editor})),[e]}}),s8=/^\s*(\[([( |x])?\])\s$/,r8=$e.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:e=>{let t=e.getAttribute("data-checked");return t===""||t==="true"},renderHTML:e=>({"data-checked":e.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:e,HTMLAttributes:t}){return["li",ye(this.options.HTMLAttributes,t,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:e.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(e,t)=>{let i=[];if(e.tokens&&e.tokens.length>0?i.push(t.createNode("paragraph",{},t.parseInline(e.tokens))):e.text?i.push(t.createNode("paragraph",{},[t.createNode("text",{text:e.text})])):i.push(t.createNode("paragraph",{},[])),e.nestedTokens&&e.nestedTokens.length>0){let n=t.parseChildren(e.nestedTokens);i.push(...n)}return t.createNode("taskItem",{checked:e.checked||!1},i)},renderMarkdown:(e,t)=>{var i;let o=`- [${(i=e.attrs)!=null&&i.checked?"x":" "}] `;return ol(e,t,o)},addKeyboardShortcuts(){let e={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?_(b({},e),{Tab:()=>this.editor.commands.sinkListItem(this.name)}):e},addNodeView(){return({node:e,HTMLAttributes:t,getPos:i,editor:n})=>{let o=document.createElement("li"),s=document.createElement("label"),r=document.createElement("span"),a=document.createElement("input"),l=document.createElement("div"),d=c=>{var u,h;a.ariaLabel=((h=(u=this.options.a11y)==null?void 0:u.checkboxLabel)==null?void 0:h.call(u,c,a.checked))||`Task item checkbox for ${c.textContent||"empty task item"}`};return d(e),s.contentEditable="false",a.type="checkbox",a.addEventListener("mousedown",c=>c.preventDefault()),a.addEventListener("change",c=>{if(!n.isEditable&&!this.options.onReadOnlyChecked){a.checked=!a.checked;return}let{checked:u}=c.target;n.isEditable&&typeof i=="function"&&n.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:h})=>{let p=i();if(typeof p!="number")return!1;let g=h.doc.nodeAt(p);return h.setNodeMarkup(p,void 0,_(b({},g?.attrs),{checked:u})),!0}).run(),!n.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(e,u)||(a.checked=!a.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([c,u])=>{o.setAttribute(c,u)}),o.dataset.checked=e.attrs.checked,a.checked=e.attrs.checked,s.append(a,r),o.append(s,l),Object.entries(t).forEach(([c,u])=>{o.setAttribute(c,u)}),{dom:o,contentDOM:l,update:c=>c.type!==this.type?!1:(o.dataset.checked=c.attrs.checked,a.checked=c.attrs.checked,d(c),!0)}}},addInputRules(){return[rn({find:s8,type:this.type,getAttributes:e=>({checked:e[e.length-1]==="x"})})]}}),a8=$e.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:e}){return["ul",ye(this.options.HTMLAttributes,e,{"data-type":this.name}),0]},parseMarkdown:(e,t)=>t.createNode("taskList",{},t.parseChildren(e.items||[])),renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(e){var t;let i=(t=e.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:t.index;return i!==void 0?i:-1},tokenize(e,t,i){let n=s=>{let r=Lc(s,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:a=>({indentLevel:a[1].length,mainContent:a[4],checked:a[3].toLowerCase()==="x"}),createToken:(a,l)=>({type:"taskItem",raw:"",mainContent:a.mainContent,indentLevel:a.indentLevel,checked:a.checked,text:a.mainContent,tokens:i.inlineTokens(a.mainContent),nestedTokens:l}),customNestedParser:n},i);return r?[{type:"taskList",raw:r.raw,items:r.items}]:i.blockTokens(s)},o=Lc(e,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:s=>({indentLevel:s[1].length,mainContent:s[4],checked:s[3].toLowerCase()==="x"}),createToken:(s,r)=>({type:"taskItem",raw:"",mainContent:s.mainContent,indentLevel:s.indentLevel,checked:s.checked,text:s.mainContent,tokens:i.inlineTokens(s.mainContent),nestedTokens:r}),customNestedParser:n},i);if(o)return{type:"taskList",raw:o.raw,items:o.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:e})=>e.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}}),Hre=Ie.create({name:"listKit",addExtensions(){let e=[];return this.options.bulletList!==!1&&e.push(bm.configure(this.options.bulletList)),this.options.listItem!==!1&&e.push(ym.configure(this.options.listItem)),this.options.listKeymap!==!1&&e.push(xm.configure(this.options.listKeymap)),this.options.orderedList!==!1&&e.push(Em.configure(this.options.orderedList)),this.options.taskItem!==!1&&e.push(r8.configure(this.options.taskItem)),this.options.taskList!==!1&&e.push(a8.configure(this.options.taskList)),e}});var S2=$e.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:e}){return["p",ye(this.options.HTMLAttributes,e),0]},parseMarkdown:(e,t)=>{let i=e.tokens||[];return i.length===1&&i[0].type==="image"?t.parseChildren([i[0]]):t.createNode("paragraph",void 0,t.parseInline(i))},renderMarkdown:(e,t)=>!e||!Array.isArray(e.content)?"":t.renderChildren(e.content),addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}});var l8=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,d8=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,x2=mi.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["s",ye(this.options.HTMLAttributes,e),0]},markdownTokenName:"del",parseMarkdown:(e,t)=>t.applyMark("strike",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`~~${t.renderChildren(e)}~~`,addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[sn({find:l8,type:this.type})]},addPasteRules(){return[Di({find:d8,type:this.type})]}});var E2=$e.create({name:"text",group:"inline",parseMarkdown:e=>({type:"text",text:e.text||""}),renderMarkdown:e=>e.text||""});var R2=mi.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["u",ye(this.options.HTMLAttributes,e),0]},parseMarkdown(e,t){return t.applyMark(this.name||"underline",t.parseInline(e.tokens||[]))},renderMarkdown(e,t){return`++${t.renderChildren(e)}++`},markdownTokenizer:{name:"underline",level:"inline",start(e){return e.indexOf("++")},tokenize(e,t,i){let o=/^(\+\+)([\s\S]+?)(\+\+)/.exec(e);if(!o)return;let s=o[2].trim();return{type:"underline",raw:o[0],text:s,tokens:i.inlineTokens(s)}}},addCommands(){return{setUnderline:()=>({commands:e})=>e.setMark(this.name),toggleUnderline:()=>({commands:e})=>e.toggleMark(this.name),unsetUnderline:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});function P2(e={}){return new he({view(t){return new Rm(t,e)}})}var Rm=class{constructor(t,i){var n;this.editorView=t,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(n=i.width)!==null&&n!==void 0?n:1,this.color=i.color===!1?void 0:i.color||"black",this.class=i.class,this.handlers=["dragover","dragend","drop","dragleave"].map(o=>{let s=r=>{this[o](r)};return t.dom.addEventListener(o,s),{name:o,handler:s}})}destroy(){this.handlers.forEach(({name:t,handler:i})=>this.editorView.dom.removeEventListener(t,i))}update(t,i){this.cursorPos!=null&&i.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(t){t!=this.cursorPos&&(this.cursorPos=t,t==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let t=this.editorView.state.doc.resolve(this.cursorPos),i=!t.parent.inlineContent,n,o=this.editorView.dom,s=o.getBoundingClientRect(),r=s.width/o.offsetWidth,a=s.height/o.offsetHeight;if(i){let u=t.nodeBefore,h=t.nodeAfter;if(u||h){let p=this.editorView.nodeDOM(this.cursorPos-(u?u.nodeSize:0));if(p){let g=p.getBoundingClientRect(),f=u?g.bottom:g.top;u&&h&&(f=(f+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let m=this.width/2*a;n={left:g.left,right:g.right,top:f-m,bottom:f+m}}}}if(!n){let u=this.editorView.coordsAtPos(this.cursorPos),h=this.width/2*r;n={left:u.left-h,right:u.left+h,top:u.top,bottom:u.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",i),this.element.classList.toggle("prosemirror-dropcursor-inline",!i);let d,c;if(!l||l==document.body&&getComputedStyle(l).position=="static")d=-pageXOffset,c=-pageYOffset;else{let u=l.getBoundingClientRect(),h=u.width/l.offsetWidth,p=u.height/l.offsetHeight;d=u.left-l.scrollLeft*h,c=u.top-l.scrollTop*p}this.element.style.left=(n.left-d)/r+"px",this.element.style.top=(n.top-c)/a+"px",this.element.style.width=(n.right-n.left)/r+"px",this.element.style.height=(n.bottom-n.top)/a+"px"}scheduleRemoval(t){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),t)}dragover(t){if(!this.editorView.editable)return;let i=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),n=i&&i.inside>=0&&this.editorView.state.doc.nodeAt(i.inside),o=n&&n.type.spec.disableDropCursor,s=typeof o=="function"?o(this.editorView,i,t):o;if(i&&!s){let r=i.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=ec(this.editorView.state.doc,r,this.editorView.dragging.slice);a!=null&&(r=a)}this.setCursor(r),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(t){this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)}};var $t=class e extends de{constructor(t){super(t,t)}map(t,i){let n=t.resolve(i.map(this.head));return e.valid(n)?new e(n):de.near(n)}content(){return K.empty}eq(t){return t instanceof e&&t.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(t,i){if(typeof i.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new e(t.resolve(i.pos))}getBookmark(){return new Pm(this.anchor)}static valid(t){let i=t.parent;if(i.isTextblock||!c8(t)||!u8(t))return!1;let n=i.type.spec.allowGapCursor;if(n!=null)return n;let o=i.contentMatchAt(t.index()).defaultType;return o&&o.isTextblock}static findGapCursorFrom(t,i,n=!1){e:for(;;){if(!n&&e.valid(t))return t;let o=t.pos,s=null;for(let r=t.depth;;r--){let a=t.node(r);if(i>0?t.indexAfter(r)<a.childCount:t.index(r)>0){s=a.child(i>0?t.indexAfter(r):t.index(r)-1);break}else if(r==0)return null;o+=i;let l=t.doc.resolve(o);if(e.valid(l))return l}for(;;){let r=i>0?s.firstChild:s.lastChild;if(!r){if(s.isAtom&&!s.isText&&!J.isSelectable(s)){t=t.doc.resolve(o+s.nodeSize*i),n=!1;continue e}break}s=r,o+=i;let a=t.doc.resolve(o);if(e.valid(a))return a}return null}}};$t.prototype.visible=!1;$t.findFrom=$t.findGapCursorFrom;de.jsonID("gapcursor",$t);var Pm=class e{constructor(t){this.pos=t}map(t){return new e(t.map(this.pos))}resolve(t){let i=t.resolve(this.pos);return $t.valid(i)?new $t(i):de.near(i)}};function M2(e){return e.isAtom||e.spec.isolating||e.spec.createGapCursor}function c8(e){for(let t=e.depth;t>=0;t--){let i=e.index(t),n=e.node(t);if(i==0){if(n.type.spec.isolating)return!0;continue}for(let o=n.child(i-1);;o=o.lastChild){if(o.childCount==0&&!o.inlineContent||M2(o.type))return!0;if(o.inlineContent)return!1}}return!0}function u8(e){for(let t=e.depth;t>=0;t--){let i=e.indexAfter(t),n=e.node(t);if(i==n.childCount){if(n.type.spec.isolating)return!0;continue}for(let o=n.child(i);;o=o.firstChild){if(o.childCount==0&&!o.inlineContent||M2(o.type))return!0;if(o.inlineContent)return!1}}return!0}function k2(){return new he({props:{decorations:f8,createSelectionBetween(e,t,i){return t.pos==i.pos&&$t.valid(i)?new $t(i):null},handleClick:p8,handleKeyDown:h8,handleDOMEvents:{beforeinput:g8}}})}var h8=kf({ArrowLeft:fu("horiz",-1),ArrowRight:fu("horiz",1),ArrowUp:fu("vert",-1),ArrowDown:fu("vert",1)});function fu(e,t){let i=e=="vert"?t>0?"down":"up":t>0?"right":"left";return function(n,o,s){let r=n.selection,a=t>0?r.$to:r.$from,l=r.empty;if(r instanceof ne){if(!s.endOfTextblock(i)||a.depth==0)return!1;l=!1,a=n.doc.resolve(t>0?a.after():a.before())}let d=$t.findGapCursorFrom(a,t,l);return d?(o&&o(n.tr.setSelection(new $t(d))),!0):!1}}function p8(e,t,i){if(!e||!e.editable)return!1;let n=e.state.doc.resolve(t);if(!$t.valid(n))return!1;let o=e.posAtCoords({left:i.clientX,top:i.clientY});return o&&o.inside>-1&&J.isSelectable(e.state.doc.nodeAt(o.inside))?!1:(e.dispatch(e.state.tr.setSelection(new $t(n))),!0)}function g8(e,t){if(t.inputType!="insertCompositionText"||!(e.state.selection instanceof $t))return!1;let{$from:i}=e.state.selection,n=i.parent.contentMatchAt(i.index()).findWrapping(e.state.schema.nodes.text);if(!n)return!1;let o=N.empty;for(let r=n.length-1;r>=0;r--)o=N.from(n[r].createAndFill(null,o));let s=e.state.tr.replace(i.pos,i.pos,new K(o,0,0));return s.setSelection(ne.near(s.doc.resolve(i.pos+1))),e.dispatch(s),!1}function f8(e){if(!(e.selection instanceof $t))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",dt.create(e.doc,[qt.widget(e.selection.head,t,{key:"gapcursor"})])}var mu=200,It=function(){};It.prototype.append=function(t){return t.length?(t=It.from(t),!this.length&&t||t.length<mu&&this.leafAppend(t)||this.length<mu&&t.leafPrepend(this)||this.appendInner(t)):this};It.prototype.prepend=function(t){return t.length?It.from(t).append(this):this};It.prototype.appendInner=function(t){return new m8(this,t)};It.prototype.slice=function(t,i){return t===void 0&&(t=0),i===void 0&&(i=this.length),t>=i?It.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,i))};It.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)};It.prototype.forEach=function(t,i,n){i===void 0&&(i=0),n===void 0&&(n=this.length),i<=n?this.forEachInner(t,i,n,0):this.forEachInvertedInner(t,i,n,0)};It.prototype.map=function(t,i,n){i===void 0&&(i=0),n===void 0&&(n=this.length);var o=[];return this.forEach(function(s,r){return o.push(t(s,r))},i,n),o};It.from=function(t){return t instanceof It?t:t&&t.length?new D2(t):It.empty};var D2=(function(e){function t(n){e.call(this),this.values=n}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var i={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(o,s){return o==0&&s==this.length?this:new t(this.values.slice(o,s))},t.prototype.getInner=function(o){return this.values[o]},t.prototype.forEachInner=function(o,s,r,a){for(var l=s;l<r;l++)if(o(this.values[l],a+l)===!1)return!1},t.prototype.forEachInvertedInner=function(o,s,r,a){for(var l=s-1;l>=r;l--)if(o(this.values[l],a+l)===!1)return!1},t.prototype.leafAppend=function(o){if(this.length+o.length<=mu)return new t(this.values.concat(o.flatten()))},t.prototype.leafPrepend=function(o){if(this.length+o.length<=mu)return new t(o.flatten().concat(this.values))},i.length.get=function(){return this.values.length},i.depth.get=function(){return 0},Object.defineProperties(t.prototype,i),t})(It);It.empty=new D2([]);var m8=(function(e){function t(i,n){e.call(this),this.left=i,this.right=n,this.length=i.length+n.length,this.depth=Math.max(i.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(n){return n<this.left.length?this.left.get(n):this.right.get(n-this.left.length)},t.prototype.forEachInner=function(n,o,s,r){var a=this.left.length;if(o<a&&this.left.forEachInner(n,o,Math.min(s,a),r)===!1||s>a&&this.right.forEachInner(n,Math.max(o-a,0),Math.min(this.length,s)-a,r+a)===!1)return!1},t.prototype.forEachInvertedInner=function(n,o,s,r){var a=this.left.length;if(o>a&&this.right.forEachInvertedInner(n,o-a,Math.max(s,a)-a,r+a)===!1||s<a&&this.left.forEachInvertedInner(n,Math.min(o,a),s,r)===!1)return!1},t.prototype.sliceInner=function(n,o){if(n==0&&o==this.length)return this;var s=this.left.length;return o<=s?this.left.slice(n,o):n>=s?this.right.slice(n-s,o-s):this.left.slice(n,s).append(this.right.slice(0,o-s))},t.prototype.leafAppend=function(n){var o=this.right.leafAppend(n);if(o)return new t(this.left,o)},t.prototype.leafPrepend=function(n){var o=this.left.leafPrepend(n);if(o)return new t(o,this.right)},t.prototype.appendInner=function(n){return this.left.depth>=Math.max(this.right.depth,n.depth)+1?new t(this.left,new t(this.right,n)):new t(this,n)},t})(It),Mm=It;var C8=500,Ds=class e{constructor(t,i){this.items=t,this.eventCount=i}popEvent(t,i){if(this.eventCount==0)return null;let n=this.items.length;for(;;n--)if(this.items.get(n-1).selection){--n;break}let o,s;i&&(o=this.remapping(n,this.items.length),s=o.maps.length);let r=t.tr,a,l,d=[],c=[];return this.items.forEach((u,h)=>{if(!u.step){o||(o=this.remapping(n,h+1),s=o.maps.length),s--,c.push(u);return}if(o){c.push(new dn(u.map));let p=u.step.map(o.slice(s)),g;p&&r.maybeStep(p).doc&&(g=r.mapping.maps[r.mapping.maps.length-1],d.push(new dn(g,void 0,void 0,d.length+c.length))),s--,g&&o.appendMap(g,s)}else r.maybeStep(u.step);if(u.selection)return a=o?u.selection.map(o.slice(s)):u.selection,l=new e(this.items.slice(0,n).append(c.reverse().concat(d)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:r,selection:a}}addTransform(t,i,n,o){let s=[],r=this.eventCount,a=this.items,l=!o&&a.length?a.get(a.length-1):null;for(let c=0;c<t.steps.length;c++){let u=t.steps[c].invert(t.docs[c]),h=new dn(t.mapping.maps[c],u,i),p;(p=l&&l.merge(h))&&(h=p,c?s.pop():a=a.slice(0,a.length-1)),s.push(h),i&&(r++,i=void 0),o||(l=h)}let d=r-n.depth;return d>w8&&(a=v8(a,d),r-=d),new e(a.append(s),r)}remapping(t,i){let n=new Va;return this.items.forEach((o,s)=>{let r=o.mirrorOffset!=null&&s-o.mirrorOffset>=t?n.maps.length-o.mirrorOffset:void 0;n.appendMap(o.map,r)},t,i),n}addMaps(t){return this.eventCount==0?this:new e(this.items.append(t.map(i=>new dn(i))),this.eventCount)}rebased(t,i){if(!this.eventCount)return this;let n=[],o=Math.max(0,this.items.length-i),s=t.mapping,r=t.steps.length,a=this.eventCount;this.items.forEach(h=>{h.selection&&a--},o);let l=i;this.items.forEach(h=>{let p=s.getMirror(--l);if(p==null)return;r=Math.min(r,p);let g=s.maps[p];if(h.step){let f=t.steps[p].invert(t.docs[p]),m=h.selection&&h.selection.map(s.slice(l+1,p));m&&a++,n.push(new dn(g,f,m))}else n.push(new dn(g))},o);let d=[];for(let h=i;h<r;h++)d.push(new dn(s.maps[h]));let c=this.items.slice(0,o).append(d).append(n),u=new e(c,a);return u.emptyItemCount()>C8&&(u=u.compress(this.items.length-n.length)),u}emptyItemCount(){let t=0;return this.items.forEach(i=>{i.step||t++}),t}compress(t=this.items.length){let i=this.remapping(0,t),n=i.maps.length,o=[],s=0;return this.items.forEach((r,a)=>{if(a>=t)o.push(r),r.selection&&s++;else if(r.step){let l=r.step.map(i.slice(n)),d=l&&l.getMap();if(n--,d&&i.appendMap(d,n),l){let c=r.selection&&r.selection.map(i.slice(n));c&&s++;let u=new dn(d.invert(),l,c),h,p=o.length-1;(h=o.length&&o[p].merge(u))?o[p]=h:o.push(u)}}else r.map&&n--},this.items.length,0),new e(Mm.from(o.reverse()),s)}};Ds.empty=new Ds(Mm.empty,0);function v8(e,t){let i;return e.forEach((n,o)=>{if(n.selection&&t--==0)return i=o,!1}),e.slice(i)}var dn=class e{constructor(t,i,n,o){this.map=t,this.step=i,this.selection=n,this.mirrorOffset=o}merge(t){if(this.step&&t.step&&!t.selection){let i=t.step.merge(this.step);if(i)return new e(i.getMap().invert(),i,this.selection)}}},cn=class{constructor(t,i,n,o,s){this.done=t,this.undone=i,this.prevRanges=n,this.prevTime=o,this.prevComposition=s}},w8=20;function b8(e,t,i,n){let o=i.getMeta(ks),s;if(o)return o.historyState;i.getMeta(x8)&&(e=new cn(e.done,e.undone,null,0,-1));let r=i.getMeta("appendedTransaction");if(i.steps.length==0)return e;if(r&&r.getMeta(ks))return r.getMeta(ks).redo?new cn(e.done.addTransform(i,void 0,n,Cu(t)),e.undone,F2(i.mapping.maps),e.prevTime,e.prevComposition):new cn(e.done,e.undone.addTransform(i,void 0,n,Cu(t)),null,e.prevTime,e.prevComposition);if(i.getMeta("addToHistory")!==!1&&!(r&&r.getMeta("addToHistory")===!1)){let a=i.getMeta("composition"),l=e.prevTime==0||!r&&e.prevComposition!=a&&(e.prevTime<(i.time||0)-n.newGroupDelay||!y8(i,e.prevRanges)),d=r?km(e.prevRanges,i.mapping):F2(i.mapping.maps);return new cn(e.done.addTransform(i,l?t.selection.getBookmark():void 0,n,Cu(t)),Ds.empty,d,i.time,a??e.prevComposition)}else return(s=i.getMeta("rebased"))?new cn(e.done.rebased(i,s),e.undone.rebased(i,s),km(e.prevRanges,i.mapping),e.prevTime,e.prevComposition):new cn(e.done.addMaps(i.mapping.maps),e.undone.addMaps(i.mapping.maps),km(e.prevRanges,i.mapping),e.prevTime,e.prevComposition)}function y8(e,t){if(!t)return!1;if(!e.docChanged)return!0;let i=!1;return e.mapping.maps[0].forEach((n,o)=>{for(let s=0;s<t.length;s+=2)n<=t[s+1]&&o>=t[s]&&(i=!0)}),i}function F2(e){let t=[];for(let i=e.length-1;i>=0&&t.length==0;i--)e[i].forEach((n,o,s,r)=>t.push(s,r));return t}function km(e,t){if(!e)return null;let i=[];for(let n=0;n<e.length;n+=2){let o=t.map(e[n],1),s=t.map(e[n+1],-1);o<=s&&i.push(o,s)}return i}function S8(e,t,i){let n=Cu(t),o=ks.get(t).spec.config,s=(i?e.undone:e.done).popEvent(t,n);if(!s)return null;let r=s.selection.resolve(s.transform.doc),a=(i?e.done:e.undone).addTransform(s.transform,t.selection.getBookmark(),o,n),l=new cn(i?a:s.remaining,i?s.remaining:a,null,0,-1);return s.transform.setSelection(r).setMeta(ks,{redo:i,historyState:l})}var Dm=!1,T2=null;function Cu(e){let t=e.plugins;if(T2!=t){Dm=!1,T2=t;for(let i=0;i<t.length;i++)if(t[i].spec.historyPreserveItems){Dm=!0;break}}return Dm}var ks=new ve("history"),x8=new ve("closeHistory");function A2(e={}){return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new he({key:ks,state:{init(){return new cn(Ds.empty,Ds.empty,null,0,-1)},apply(t,i,n){return b8(i,n,t,e)}},config:e,props:{handleDOMEvents:{beforeinput(t,i){let n=i.inputType,o=n=="historyUndo"?Fm:n=="historyRedo"?Tm:null;return!o||!t.editable?!1:(i.preventDefault(),o(t.state,t.dispatch))}}}})}function vu(e,t){return(i,n)=>{let o=ks.getState(i);if(!o||(e?o.undone:o.done).eventCount==0)return!1;if(n){let s=S8(o,i,e);s&&n(t?s.scrollIntoView():s)}return!0}}var Fm=vu(!1,!0),Tm=vu(!0,!0),hae=vu(!1,!1),pae=vu(!0,!1);var wae=Ie.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:e=>e.length,wordCounter:e=>e.split(" ").filter(t=>t!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=e=>{let t=e?.node||this.editor.state.doc;if((e?.mode||this.options.mode)==="textSize"){let n=t.textBetween(0,t.content.size,void 0," ");return this.options.textCounter(n)}return t.nodeSize},this.storage.words=e=>{let t=e?.node||this.editor.state.doc,i=t.textBetween(0,t.content.size," "," ");return this.options.wordCounter(i)}},addProseMirrorPlugins(){let e=!1;return[new he({key:new ve("characterCount"),appendTransaction:(t,i,n)=>{if(e)return;let o=this.options.limit;if(o==null||o===0){e=!0;return}let s=this.storage.characters({node:n.doc});if(s>o){let r=s-o,a=0,l=r;console.warn(`[CharacterCount] Initial content exceeded limit of ${o} characters. Content was automatically trimmed.`);let d=n.tr.deleteRange(a,l);return e=!0,d}e=!0},filterTransaction:(t,i)=>{let n=this.options.limit;if(!t.docChanged||n===0||n===null||n===void 0)return!0;let o=this.storage.characters({node:i.doc}),s=this.storage.characters({node:t.doc});if(s<=n||o>n&&s>n&&s<=o)return!0;if(o>n&&s>n&&s>o||!t.getMeta("paste"))return!1;let a=t.selection.$head.pos,l=s-n,d=a-l,c=a;return t.deleteRange(d,c),!(this.storage.characters({node:t.doc})>n)}})]}}),L2=Ie.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[P2(this.options)]}}),Rae=Ie.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new he({key:new ve("focus"),props:{decorations:({doc:e,selection:t})=>{let{isEditable:i,isFocused:n}=this.editor,{anchor:o}=t,s=[];if(!i||!n)return dt.create(e,[]);let r=0;this.options.mode==="deepest"&&e.descendants((l,d)=>{if(l.isText)return;if(!(o>=d&&o<=d+l.nodeSize-1))return!1;r+=1});let a=0;return e.descendants((l,d)=>{if(l.isText||!(o>=d&&o<=d+l.nodeSize-1))return!1;if(a+=1,this.options.mode==="deepest"&&r-a>0||this.options.mode==="shallowest"&&a>1)return this.options.mode==="deepest";s.push(qt.node(d,d+l.nodeSize,{class:this.options.className}))}),dt.create(e,s)}}})]}}),_2=Ie.create({name:"gapCursor",addProseMirrorPlugins(){return[k2()]},extendNodeSchema(e){var t;let i={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:(t=He(ee(e,"allowGapCursor",i)))!=null?t:null}}}),Tae=Ie.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something \u2026",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new he({key:new ve("placeholder"),props:{decorations:({doc:e,selection:t})=>{let i=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:n}=t,o=[];if(!i)return null;let s=this.editor.isEmpty;return e.descendants((r,a)=>{let l=n>=a&&n<=a+r.nodeSize,d=!r.isLeaf&&il(r);if((l||!this.options.showOnlyCurrent)&&d){let c=[this.options.emptyNodeClass];s&&c.push(this.options.emptyEditorClass);let u=qt.node(a,a+r.nodeSize,{class:c.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:r,pos:a,hasAnchor:l}):this.options.placeholder});o.push(u)}return this.options.includeChildren}),dt.create(e,o)}}})]}}),_ae=Ie.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){let{editor:e,options:t}=this;return[new he({key:new ve("selection"),props:{decorations(i){return i.selection.empty||e.isFocused||!e.isEditable||Ac(i.selection)||e.view.dragging?null:dt.create(i.doc,[qt.inline(i.selection.from,i.selection.to,{class:t.className})])}}})]}});function I2({types:e,node:t}){return t&&Array.isArray(e)&&e.includes(t.type)||t?.type===e}var O2=Ie.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var e;let t=new ve(this.name),i=((e=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:e.name)||this.options.node||"paragraph",n=Object.entries(this.editor.schema.nodes).map(([,o])=>o).filter(o=>(this.options.notAfter||[]).concat(i).includes(o.name));return[new he({key:t,appendTransaction:(o,s,r)=>{let{doc:a,tr:l,schema:d}=r,c=t.getState(r),u=a.content.size,h=d.nodes[i];if(c)return l.insert(u,h.create())},state:{init:(o,s)=>{let r=s.tr.doc.lastChild;return!I2({node:r,types:n})},apply:(o,s)=>{if(!o.docChanged||o.getMeta("__uniqueIDTransaction"))return s;let r=o.doc.lastChild;return!I2({node:r,types:n})}}})]}}),N2=Ie.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:e,dispatch:t})=>Fm(e,t),redo:()=>({state:e,dispatch:t})=>Tm(e,t)}},addProseMirrorPlugins(){return[A2(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-\u044F":()=>this.editor.commands.undo(),"Shift-Mod-\u044F":()=>this.editor.commands.redo()}}});var E8=Ie.create({name:"starterKit",addExtensions(){var e,t,i,n;let o=[];return this.options.bold!==!1&&o.push(n2.configure(this.options.bold)),this.options.blockquote!==!1&&o.push(i2.configure(this.options.blockquote)),this.options.bulletList!==!1&&o.push(bm.configure(this.options.bulletList)),this.options.code!==!1&&o.push(o2.configure(this.options.code)),this.options.codeBlock!==!1&&o.push(s2.configure(this.options.codeBlock)),this.options.document!==!1&&o.push(r2.configure(this.options.document)),this.options.dropcursor!==!1&&o.push(L2.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&o.push(_2.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&o.push(a2.configure(this.options.hardBreak)),this.options.heading!==!1&&o.push(l2.configure(this.options.heading)),this.options.undoRedo!==!1&&o.push(N2.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&o.push(d2.configure(this.options.horizontalRule)),this.options.italic!==!1&&o.push(c2.configure(this.options.italic)),this.options.listItem!==!1&&o.push(ym.configure(this.options.listItem)),this.options.listKeymap!==!1&&o.push(xm.configure((e=this.options)==null?void 0:e.listKeymap)),this.options.link!==!1&&o.push(mm.configure((t=this.options)==null?void 0:t.link)),this.options.orderedList!==!1&&o.push(Em.configure(this.options.orderedList)),this.options.paragraph!==!1&&o.push(S2.configure(this.options.paragraph)),this.options.strike!==!1&&o.push(x2.configure(this.options.strike)),this.options.text!==!1&&o.push(E2.configure(this.options.text)),this.options.underline!==!1&&o.push(R2.configure((i=this.options)==null?void 0:i.underline)),this.options.trailingNode!==!1&&o.push(O2.configure((n=this.options)==null?void 0:n.trailingNode)),o}}),B2=E8;var H2=(()=>{class e{elRef=ie(si);renderer=ie(tr);changeDetectorRef=ie(Td);editor=Y.required();outputFormat=Y("html");onChange=()=>{};onTouched=()=>{};writeValue(i){this.editor().chain().setContent(i,{emitUpdate:!1}).run()}registerOnChange(i){this.onChange=i}registerOnTouched(i){this.onTouched=i}setDisabledState(i){this.editor().setEditable(!i),this.renderer.setProperty(this.elRef.nativeElement,"disabled",i)}handleChange=({editor:i,transaction:n})=>{if(n.docChanged){if(this.changeDetectorRef.markForCheck(),this.outputFormat()==="html"){this.onChange(i.getHTML());return}this.onChange(i.getJSON())}};ngOnInit(){let i=this.editor(),{innerHTML:n}=this.elRef.nativeElement;this.elRef.nativeElement.innerHTML="",this.elRef.nativeElement.append(...Array.from(i.options.element?.childNodes||[])),i.setOptions({element:this.elRef.nativeElement}),n&&i.chain().setContent(n,{emitUpdate:!1}).run(),i.on("blur",()=>{this.onTouched()}),i.on("update",this.handleChange),i.on("selectionUpdate",()=>this.changeDetectorRef.markForCheck())}ngAfterViewInit(){this.changeDetectorRef.detectChanges()}static \u0275fac=function(n){return new(n||e)};static \u0275dir=Re({type:e,selectors:[["tiptap","editor",""],["","tiptap","","editor",""],["tiptap-editor","editor",""],["","tiptapEditor","","editor",""]],inputs:{editor:[1,"editor"],outputFormat:[1,"outputFormat"]},features:[ze([{provide:Fw,useExisting:ns(()=>e),multi:!0}])]})}return e})();var G2=(()=>{class e{initialContent=Y("");minHeight=Y("300px");contentChange=re();editor=new OS({extensions:[B2.configure({heading:{levels:[1,2,3]}}),t2.configure({openOnClick:!1,HTMLAttributes:{class:"text-blue-600 underline hover:text-blue-800"}})],editorProps:{attributes:{class:`prose prose-sm sm:prose lg:prose-lg xl:prose-xl focus:outline-none min-h-[${this.minHeight()}] max-w-none p-4`}},content:this.initialContent()||"<p>Start typing...</p>",onUpdate:({editor:i})=>{this.contentChange.emit(i.getHTML())}});isBold(){return this.editor?.isActive("bold")??!1}isItalic(){return this.editor?.isActive("italic")??!1}isStrike(){return this.editor?.isActive("strike")??!1}isCode(){return this.editor?.isActive("code")??!1}isH1(){return this.editor?.isActive("heading",{level:1})??!1}isH2(){return this.editor?.isActive("heading",{level:2})??!1}isBulletList(){return this.editor?.isActive("bulletList")??!1}isOrderedList(){return this.editor?.isActive("orderedList")??!1}isBlockquote(){return this.editor?.isActive("blockquote")??!1}toggleBold(){this.editor?.chain().focus().toggleBold().run()}toggleItalic(){this.editor?.chain().focus().toggleItalic().run()}toggleStrike(){this.editor?.chain().focus().toggleStrike().run()}toggleCode(){this.editor?.chain().focus().toggleCode().run()}toggleH1(){this.editor?.chain().focus().toggleHeading({level:1}).run()}toggleH2(){this.editor?.chain().focus().toggleHeading({level:2}).run()}toggleBulletList(){this.editor?.chain().focus().toggleBulletList().run()}toggleOrderedList(){this.editor?.chain().focus().toggleOrderedList().run()}toggleBlockquote(){this.editor?.chain().focus().toggleBlockquote().run()}setLink(){let i=window.prompt("Enter URL:");i&&this.editor?.chain().focus().setLink({href:i}).run()}undo(){this.editor?.chain().focus().undo().run()}redo(){this.editor?.chain().focus().redo().run()}getHTML(){return this.editor?.getHTML()}getJSON(){return this.editor?.getJSON()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ee({type:e,selectors:[["gh-tiptap-editor"]],inputs:{initialContent:[1,"initialContent"],minHeight:[1,"minHeight"]},outputs:{contentChange:"contentChange"},features:[ze([ai({lucideBold:_w,lucideItalic:zw,lucideStrikethrough:t1,lucideCode:Ow,lucideHeading1:Hw,lucideHeading2:Gw,lucideList:qw,lucideListOrdered:Uw,lucideQuote:Xw,lucideUndo:i1,lucideRedo:Jw,lucideLink:Ww})])],decls:31,vars:19,consts:[[1,"border","rounded-t-md","p-2","bg-muted/30","flex","flex-wrap","gap-1","items-center"],["hlmBtn","","variant","ghost","size","icon","title","Bold (Ctrl+B)",3,"click"],["hlm","","name","lucideBold","size","sm"],["hlmBtn","","variant","ghost","size","icon","title","Italic (Ctrl+I)",3,"click"],["hlm","","name","lucideItalic","size","sm"],["hlmBtn","","variant","ghost","size","icon","title","Strikethrough",3,"click"],["hlm","","name","lucideStrikethrough","size","sm"],["hlmBtn","","variant","ghost","size","icon","title","Code",3,"click"],["hlm","","name","lucideCode","size","sm"],["hlmSeparator","","orientation","vertical",1,"h-6","mx-1"],["hlmBtn","","variant","ghost","size","icon","title","Heading 1",3,"click"],["hlm","","name","lucideHeading1","size","sm"],["hlmBtn","","variant","ghost","size","icon","title","Heading 2",3,"click"],["hlm","","name","lucideHeading2","size","sm"],["hlmBtn","","variant","ghost","size","icon","title","Bullet List",3,"click"],["hlm","","name","lucideList","size","sm"],["hlmBtn","","variant","ghost","size","icon","title","Numbered List",3,"click"],["hlm","","name","lucideListOrdered","size","sm"],["hlmBtn","","variant","ghost","size","icon","title","Blockquote",3,"click"],["hlm","","name","lucideQuote","size","sm"],["hlmBtn","","variant","ghost","size","icon","title","Add Link",3,"click"],["hlm","","name","lucideLink","size","sm"],["hlmBtn","","variant","ghost","size","icon","title","Undo (Ctrl+Z)",3,"click"],["hlm","","name","lucideUndo","size","sm"],["hlmBtn","","variant","ghost","size","icon","title","Redo (Ctrl+Shift+Z)",3,"click"],["hlm","","name","lucideRedo","size","sm"],[1,"border","border-t-0","rounded-b-md","bg-background"],[1,"block",3,"editor"]],template:function(n,o){n&1&&(M(0,"div",0)(1,"button",1),se("click",function(){return o.toggleBold()}),oe(2,"ng-icon",2),k(),M(3,"button",3),se("click",function(){return o.toggleItalic()}),oe(4,"ng-icon",4),k(),M(5,"button",5),se("click",function(){return o.toggleStrike()}),oe(6,"ng-icon",6),k(),M(7,"button",7),se("click",function(){return o.toggleCode()}),oe(8,"ng-icon",8),k(),oe(9,"div",9),M(10,"button",10),se("click",function(){return o.toggleH1()}),oe(11,"ng-icon",11),k(),M(12,"button",12),se("click",function(){return o.toggleH2()}),oe(13,"ng-icon",13),k(),oe(14,"div",9),M(15,"button",14),se("click",function(){return o.toggleBulletList()}),oe(16,"ng-icon",15),k(),M(17,"button",16),se("click",function(){return o.toggleOrderedList()}),oe(18,"ng-icon",17),k(),oe(19,"div",9),M(20,"button",18),se("click",function(){return o.toggleBlockquote()}),oe(21,"ng-icon",19),k(),M(22,"button",20),se("click",function(){return o.setLink()}),oe(23,"ng-icon",21),k(),oe(24,"div",9),M(25,"button",22),se("click",function(){return o.undo()}),oe(26,"ng-icon",23),k(),M(27,"button",24),se("click",function(){return o.redo()}),oe(28,"ng-icon",25),k()(),M(29,"div",26),oe(30,"tiptap-editor",27),k()),n&2&&(F(),ri("bg-accent",o.isBold()),F(2),ri("bg-accent",o.isItalic()),F(2),ri("bg-accent",o.isStrike()),F(2),ri("bg-accent",o.isCode()),F(3),ri("bg-accent",o.isH1()),F(2),ri("bg-accent",o.isH2()),F(3),ri("bg-accent",o.isBulletList()),F(2),ri("bg-accent",o.isOrderedList()),F(3),ri("bg-accent",o.isBlockquote()),F(10),De("editor",o.editor))},dependencies:[Bt,Gt,Ht,Wd,H2],encapsulation:2,changeDetection:0})}return e})();var R8=()=>["image/*","application/pdf",".doc",".docx",".xls",".xlsx"],V2=(()=>{class e{initialEditorContent='<h1>Welcome to Tiptap Editor!</h1><p>This is a basic example with <strong>bold</strong>, <em>italic</em>, and <a href="https://tiptap.dev">links</a>.</p><h2>Features:</h2><ul><li>Text formatting (bold, italic, strike)</li><li>Headings (H1, H2)</li><li>Lists (ordered & unordered)</li><li>Blockquotes</li><li>Code blocks</li><li>Links</li></ul>';onEditorContentChange(i){console.log("Editor content changed:",i)}onUploadComplete(i){console.log("Files uploaded successfully:",i)}onUploadError(i){console.error("Upload error:",i)}onFilesAdded(i){console.log(`${i} files added to upload queue`)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ee({type:e,selectors:[["gh-home-dashboard"]],decls:72,vars:47,consts:[[1,"p-4","md:p-6","space-y-4"],[1,"flex","items-center","justify-between"],[1,"text-2xl","md:text-3xl","font-bold"],[1,"grid","gap-4","md:grid-cols-2","lg:grid-cols-3"],["hlmCard",""],["hlmCardHeader",""],["hlmCardTitle",""],["hlmCardDescription",""],["hlmCardContent",""],[1,"text-2xl","font-semibold"],["hlmBtn","","variant","outline","size","sm"],[1,"h-96","border","rounded-md","p-4","flex","items-center","justify-center","text-muted-foreground"],[3,"uploadComplete","uploadError","filesAdded","maxFileSize","maxNumberOfFiles","allowedFileTypes"],[3,"contentChange","initialContent"]],template:function(n,o){n&1&&(M(0,"div",0)(1,"div",1)(2,"h1",2),H(3),$(4,"transloco"),k()(),M(5,"div",3)(6,"div",4)(7,"div",5)(8,"h3",6),H(9),$(10,"transloco"),k(),M(11,"p",7),H(12),$(13,"transloco"),k()(),M(14,"div",8)(15,"p",9),H(16,"0"),k()()(),M(17,"div",4)(18,"div",5)(19,"h3",6),H(20),$(21,"transloco"),k(),M(22,"p",7),H(23),$(24,"transloco"),k()(),M(25,"div",8)(26,"p",9),H(27,"0"),k()()(),M(28,"div",4)(29,"div",5)(30,"h3",6),H(31),$(32,"transloco"),k(),M(33,"p",7),H(34),$(35,"transloco"),k()(),M(36,"div",8)(37,"p",9),H(38,"0"),k()()()(),M(39,"div",4)(40,"div",5)(41,"div",1)(42,"h3",6),H(43),$(44,"transloco"),k(),M(45,"button",10),H(46),$(47,"transloco"),k()()(),M(48,"div",8)(49,"div",11),H(50),$(51,"transloco"),k()()(),M(52,"div",4)(53,"div",5)(54,"h3",6),H(55),$(56,"transloco"),k(),M(57,"p",7),H(58),$(59,"transloco"),k()(),M(60,"div",8)(61,"gh-file-upload",12),se("uploadComplete",function(r){return o.onUploadComplete(r)})("uploadError",function(r){return o.onUploadError(r)})("filesAdded",function(r){return o.onFilesAdded(r)}),k()()(),M(62,"div",4)(63,"div",5)(64,"h3",6),H(65),$(66,"transloco"),k(),M(67,"p",7),H(68),$(69,"transloco"),k()(),M(70,"div",8)(71,"gh-tiptap-editor",13),se("contentChange",function(r){return o.onEditorContentChange(r)}),k()()()()),n&2&&(F(3),me(" ",j(4,18,"homeDocumentation.title")," "),F(6),Pe(j(10,20,"homeDocumentation.overview")),F(3),Pe(j(13,22,"homeDocumentation.overviewDesc")),F(8),Pe(j(21,24,"homeDocumentation.items")),F(3),Pe(j(24,26,"homeDocumentation.itemsDesc")),F(8),Pe(j(32,28,"homeDocumentation.categories")),F(3),Pe(j(35,30,"homeDocumentation.categoriesDesc")),F(9),Pe(j(44,32,"homeDocumentation.dataGrid")),F(3),me(" ",j(47,34,"common.add")," "),F(4),me(" ",j(51,36,"homeDocumentation.gridPlaceholder")," "),F(5),Pe(j(56,38,"homeDocumentation.fileUpload")),F(3),Pe(j(59,40,"homeDocumentation.fileUploadDesc")),F(3),De("maxFileSize",10485760)("maxNumberOfFiles",10)("allowedFileTypes",Fd(46,R8)),F(4),Pe(j(66,42,"homeDocumentation.editor")),F(3),Pe(j(69,44,"homeDocumentation.editorDesc")),F(3),De("initialContent",o.initialEditorContent))},dependencies:[Qi,wo,ur,hr,cr,bo,Bt,Zi,G2,v1,vo],encapsulation:2,changeDetection:0})}return e})();var lE=er(aE(),1),dE=er(Tl(),1),O0=er(Lu(),1),_0=er(wt(),1),cE=er(v0(),1),uE=er(Qm(),1);var hE=["*"];function N0(e){let t=e.getLayer()||e.getStage();t&&t.batchDraw()}function pE(e,t={},i={}){"id"in t&&console.warn('ng2-konva: You are using "id" attribute for Konva node. In some very rare cases it may produce bugs. Currently we recommend not to use it and use "name" attribute instead.');let n=e.getStage(),o={},s=!1;if(Object.keys(i).forEach(r=>{let a=r.slice(0,2)==="on",l=i[r]!==t[r];if(a&&l){let c=r.slice(2).toLowerCase();c.slice(0,7)==="content"&&(c="content"+c.slice(7,8).toUpperCase()+c.slice(8)),n.off(c,i[r])}!Object.hasOwn(t,r)&&n.setAttr(r,void 0)}),Object.keys(t).forEach(r=>{let a=r.slice(0,2)==="on",l=i[r]!==t[r];if(a&&l){let d=r.slice(2).toLowerCase();d.slice(0,7)==="content"&&(d="content"+d.slice(7,8).toUpperCase()+d.slice(8)),t[r]&&(n.off(d),n.on(d,c=>{t[r]({angularComponent:e,event:c})}))}!a&&(t[r]!==i[r]||t[r]!==n.getAttr(r))&&(s=!0,o[r]=t[r])}),s){n.setAttrs(o),N0(n);let r;Object.keys(o).forEach(a=>{if(r=o[a],r instanceof Image&&!r.complete){let l=n;r.addEventListener("load",function(){let d=l.getLayer();d&&d.batchDraw()})}})}}function RL(e){return e.replace(/^\w|[A-Z]|\b\w/g,function(t,i){return i==0?t.toLowerCase():t.toUpperCase()}).replace(/\s+/g,"")}function PL(e){return e.charAt(0).toUpperCase()+e.slice(1)}function ML(e){return PL(RL(e.slice(3).replace("-"," ")))}function gE(e){let t={};return["mouseover","mousemove","mouseout","mouseenter","mouseleave","mousedown","mouseup","wheel","contextmenu","click","dblclick","touchstart","touchmove","touchend","tap","dbltap","dragstart","dragmove","dragend","transformstart","transform","transformend"].forEach(i=>{let o=e[i];o.listeners?.length>0&&(t["on"+i]=o.emit.bind(o))}),t}var _h=(()=>{class e{shapes=jp(e);config=dw();#e=Ye(()=>{let i=this.config();i&&this.uploadKonva(i)});mouseover=re();mousemove=re();mouseout=re();mouseenter=re();mouseleave=re();mousedown=re();mouseup=re();wheel=re();contextmenu=re();click=re();dblclick=re();touchstart=re();touchmove=re();touchend=re();tap=re();dbltap=re();dragstart=re();dragmove=re();dragend=re();transformstart=re();transform=re();transformend=re();nameNode=ML(ie(si).nativeElement.localName);cacheProps={};_stage;getStage(){return this._stage}getNode(){return this._stage}getConfig(){return this.config()||{}}constructor(){this.initKonva()}initKonva(){this._stage||(this._stage=new _0.Shape),this.nameNode==="Shape"?this._stage=new _0.Shape:this.nameNode==="Sprite"?this._stage=new cE.Sprite(this.config()):this._stage=new lE.default[this.nameNode](void 0);let i=this._stage.to.bind(this._stage);this._stage.to=o=>{i(o),setTimeout(()=>{Object.keys(this._stage.attrs).forEach(s=>{typeof this._stage.attrs[s]!="function"&&this.config()&&this.config.update(r=>_(b({},r),{[s]:this._stage.attrs[s]}))})},200)};let n=this.config();n&&this.uploadKonva(n)}uploadKonva(i){if(!this._stage)return;let n=b(b({},i),gE(this));pE(this,n,this.cacheProps),this.cacheProps=n}#t=Ye(()=>{this.shapes().forEach((i,n)=>{this!==i&&((this._stage instanceof dE.Group||this._stage instanceof O0.Layer)&&this._stage.add(i.getStage()),i.getStage().zIndex(n),N0(this._stage))})});ngOnDestroy(){this._stage.destroy()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ee({type:e,selectors:[["ko-shape"],["ko-layer"],["ko-circle"],["ko-fastlayer"],["ko-group"],["ko-label"],["ko-rect"],["ko-ellipse"],["ko-wedge"],["ko-line"],["ko-sprite"],["ko-image"],["ko-text"],["ko-text-path"],["ko-star"],["ko-ring"],["ko-arc"],["ko-tag"],["ko-path"],["ko-regular-polygon"],["ko-arrow"],["ko-transformer"]],contentQueries:function(n,o,s){n&1&&qp(s,o.shapes,e,4),n&2&&Ma()},inputs:{config:[1,"config"]},outputs:{config:"configChange",mouseover:"mouseover",mousemove:"mousemove",mouseout:"mouseout",mouseenter:"mouseenter",mouseleave:"mouseleave",mousedown:"mousedown",mouseup:"mouseup",wheel:"wheel",contextmenu:"contextmenu",click:"click",dblclick:"dblclick",touchstart:"touchstart",touchmove:"touchmove",touchend:"touchend",tap:"tap",dbltap:"dbltap",dragstart:"dragstart",dragmove:"dragmove",dragend:"dragend",transformstart:"transformstart",transform:"transform",transformend:"transformend"},ngContentSelectors:hE,decls:2,vars:0,template:function(n,o){n&1&&(Gi(),zp(0,"div"),Vi(1),Wp())},encapsulation:2})}return e})(),fE=(()=>{class e{nodeContainer=ie(si).nativeElement;shapes=jp(_h);config=Y();#e=Ye(()=>{let i=this.config();i&&(this._stage?this.uploadKonva(i):(this._stage=new uE.Stage(_(b({},i),{container:this.nodeContainer})),this.uploadKonva(i)))});mouseover=re();mousemove=re();mouseout=re();mouseenter=re();mouseleave=re();mousedown=re();mouseup=re();wheel=re();contextmenu=re();click=re();dblclick=re();touchstart=re();touchmove=re();touchend=re();tap=re();dbltap=re();dragstart=re();dragmove=re();dragend=re();transformstart=re();transform=re();transformend=re();_stage;cacheProps={};getStage(){return this._stage}getNode(){return this._stage}getConfig(){return this.config()||{}}uploadKonva(i){let n=b(b({},i),gE(this));pE(this,n,this.cacheProps),this.cacheProps=n}#t=Ye(()=>{this.shapes().forEach((i,n)=>{if(!(i.getStage()instanceof O0.Layer))throw"You can only add Layer Nodes to Stage Nodes!";this._stage.add(i.getStage()),i.getStage().zIndex(n),N0(this._stage)})});ngOnDestroy(){this._stage.destroy()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ee({type:e,selectors:[["ko-stage"]],contentQueries:function(n,o,s){n&1&&qp(s,o.shapes,_h,4),n&2&&Ma()},inputs:{config:[1,"config"]},outputs:{mouseover:"mouseover",mousemove:"mousemove",mouseout:"mouseout",mouseenter:"mouseenter",mouseleave:"mouseleave",mousedown:"mousedown",mouseup:"mouseup",wheel:"wheel",contextmenu:"contextmenu",click:"click",dblclick:"dblclick",touchstart:"touchstart",touchmove:"touchmove",touchend:"touchend",tap:"tap",dbltap:"dbltap",dragstart:"dragstart",dragmove:"dragmove",dragend:"dragend",transformstart:"transformstart",transform:"transform",transformend:"transformend"},ngContentSelectors:hE,decls:2,vars:0,template:function(n,o){n&1&&(Gi(),zp(0,"div"),Vi(1),Wp())},encapsulation:2})}return e})();var Go=class{supabaseGlobal=ie(vw);authService=ie(Cw);supabase=this.supabaseGlobal.supabase;loadingCount=Be(0);loading=ae(()=>this.loadingCount()>0);plans=$p({loader:async()=>{let{data:t,error:i}=await this.supabase.from("house_plans").select("*").order("created_at",{ascending:!1});if(i)throw i;return t||[]}});planIdSignal=Be(null);currentPlan=$p({params:()=>({planId:this.planIdSignal()}),loader:async({params:t})=>{if(!t.planId)return null;let{data:i,error:n}=await this.supabase.from("house_plans").select("*").eq("id",t.planId).single();if(n)throw n;return i}});loadPlan(t){this.planIdSignal.set(t)}createPlan(t){this.loadingCount.update(n=>n+1);let i=this.authService.user()?.id;if(!i){console.error("User not authenticated"),this.loadingCount.update(n=>n-1);return}xd(this.supabase.from("house_plans").insert({user_id:i,name:t.name,description:t.description||null,scale:t.scale||20,walls:t.walls||[]}).select().single()).pipe(Rd(n=>(console.error("Error creating plan:",n),Ed({error:n}))),Pd(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error){console.error("Failed to create plan:",n.error);return}this.plans.reload()})}updatePlan(t,i){this.loadingCount.update(n=>n+1),xd(this.supabase.from("house_plans").update(i).eq("id",t).select().single()).pipe(Rd(n=>(console.error("Error updating plan:",n),Ed({error:n}))),Pd(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error){console.error("Failed to update plan:",n.error);return}this.plans.reload(),this.planIdSignal()===t&&this.currentPlan.reload()})}deletePlan(t){this.loadingCount.update(i=>i+1),xd(this.supabase.from("house_plans").delete().eq("id",t)).pipe(Rd(i=>(console.error("Error deleting plan:",i),Ed({error:i}))),Pd(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error){console.error("Failed to delete plan:",i.error);return}this.plans.reload()})}clearCurrentPlan(){this.planIdSignal.set(null)}};var AL=(e,t,i)=>({points:e,stroke:t,strokeWidth:i,lineCap:"round",lineJoin:"round"}),IL=()=>[10,5],LL=(e,t)=>({points:e,stroke:"#3b82f6",strokeWidth:4,lineCap:"round",lineJoin:"round",dash:t}),mE=(e,t)=>t.id;function _L(e,t){e&1&&(M(0,"div",1),oe(1,"hlm-spinner",3),k())}function OL(e,t){if(e&1){let i=Qt();M(0,"div",2)(1,"p"),H(2),$(3,"transloco"),k(),M(4,"button",4),se("click",function(){Te(i);let o=ce();return Ae(o.goBack())}),oe(5,"ng-icon",5),H(6),$(7,"transloco"),k()()}if(e&2){let i=ce();F(2),Fn("",j(3,3,"common.error"),": ",i.plansService.currentPlan.error()),F(4),me(" ",j(7,5,"common.back")," ")}}function NL(e,t){e&1&&(H(0),$(1,"transloco")),e&2&&me(" ",j(1,1,"housePlan.selectMode")," ")}function BL(e,t){e&1&&(H(0),$(1,"transloco")),e&2&&me(" ",j(1,1,"housePlan.drawMode")," ")}function HL(e,t){e&1&&(H(0),$(1,"transloco")),e&2&&me(" ",j(1,1,"housePlan.deleteMode")," ")}function GL(e,t){e&1&&(H(0),$(1,"transloco")),e&2&&me(" ",j(1,1,"housePlan.drawInstructions")," ")}function VL(e,t){e&1&&(H(0),$(1,"transloco")),e&2&&me(" ",j(1,1,"housePlan.selectInstructions")," ")}function zL(e,t){e&1&&(H(0),$(1,"transloco")),e&2&&me(" ",j(1,1,"housePlan.deleteInstructions")," ")}function WL(e,t){if(e&1&&oe(0,"ko-line",35),e&2){let i=t.$implicit;De("config",i)}}function UL(e,t){if(e&1){let i=Qt();M(0,"ko-line",38),se("click",function(){let o=Te(i).$implicit,s=ce(2);return Ae(s.onWallClick(o.id))}),k()}if(e&2){let i=t.$implicit;De("config",sw(1,AL,i.points,i.stroke,i.strokeWidth))}}function qL(e,t){if(e&1&&oe(0,"ko-line",35),e&2){let i=ce(2);De("config",ow(2,LL,i.tempLine(),Fd(1,IL)))}}function $L(e,t){e&1&&(M(0,"p",36),H(1),$(2,"transloco"),k()),e&2&&(F(),Pe(j(2,1,"housePlan.noWalls")))}function jL(e,t){e&1&&(H(0),$(1,"transloco")),e&2&&me(" \u2022 ",j(1,1,"housePlan.structureDefined")," ")}function KL(e,t){if(e&1){let i=Qt();M(0,"div",40),se("click",function(){let o=Te(i).$implicit,s=ce(3);return Ae(s.onWallClick(o.id))}),M(1,"div")(2,"p",41),H(3),k(),M(4,"p",29),H(5),$(6,"transloco"),Dt(7,jL,2,3),k()(),M(8,"button",8),se("click",function(o){return Te(i),ce(3).deleteSelectedWall(),Ae(o.stopPropagation())}),oe(9,"ng-icon",42),k()()}if(e&2){let i=t.$implicit,n=ce(3);ri("bg-accent",n.selectedWallId()===i.id),F(3),Pe(i.name),F(2),Fn(" ",j(6,6,"housePlan.thickness"),": ",i.thickness," cm "),F(2),Ft(i.structureId?7:-1)}}function YL(e,t){if(e&1&&(M(0,"div",37),mo(1,KL,10,8,"div",39,mE),k()),e&2){let i=ce(2);F(),Co(i.walls())}}function XL(e,t){if(e&1){let i=Qt();M(0,"div",6)(1,"div",7)(2,"button",8),se("click",function(){Te(i);let o=ce();return Ae(o.goBack())}),oe(3,"ng-icon",9),k(),M(4,"div")(5,"h1",10),H(6),$(7,"transloco"),k(),M(8,"p",11),H(9),$(10,"transloco"),k()()(),M(11,"div",12)(12,"button",13),se("click",function(){Te(i);let o=ce();return Ae(o.clearAll())}),oe(13,"ng-icon",14),H(14),$(15,"transloco"),k(),M(16,"button",15),se("click",function(){Te(i);let o=ce();return Ae(o.savePlan())}),oe(17,"ng-icon",16),H(18),$(19,"transloco"),k()()(),M(20,"div",17)(21,"div",18)(22,"div",19)(23,"h3",20),H(24),$(25,"transloco"),k()(),M(26,"div",21)(27,"div",22)(28,"button",23),se("click",function(){Te(i);let o=ce();return Ae(o.setDrawingMode("select"))}),oe(29,"ng-icon",24),H(30),$(31,"transloco"),k(),M(32,"button",23),se("click",function(){Te(i);let o=ce();return Ae(o.setDrawingMode("draw"))}),oe(33,"ng-icon",25),H(34),$(35,"transloco"),k(),M(36,"button",26),se("click",function(){Te(i);let o=ce();return Ae(o.setDrawingMode("move"))}),oe(37,"ng-icon",27),H(38),$(39,"transloco"),k(),M(40,"button",23),se("click",function(){Te(i);let o=ce();return Ae(o.setDrawingMode("delete"))}),oe(41,"ng-icon",14),H(42),$(43,"transloco"),k()(),M(44,"div",28)(45,"p",29)(46,"strong"),H(47),$(48,"transloco"),k(),Dt(49,NL,2,3)(50,BL,2,3)(51,HL,2,3),k()(),M(52,"div",28)(53,"p",30),H(54),$(55,"transloco"),k(),M(56,"p",29),H(57),$(58,"transloco"),k(),M(59,"p",29),H(60),$(61,"transloco"),k()()()(),M(62,"div",18)(63,"div",19)(64,"h3",20),H(65),$(66,"transloco"),k(),M(67,"p",31),Dt(68,GL,2,3)(69,VL,2,3)(70,zL,2,3),k()(),M(71,"div",32)(72,"div",33)(73,"ko-stage",34),se("mousedown",function(o){Te(i);let s=ce();return Ae(s.onStageMouseDown(o))})("mousemove",function(o){Te(i);let s=ce();return Ae(s.onStageMouseMove(o))}),M(74,"ko-layer"),mo(75,WL,1,1,"ko-line",35,kd),k(),M(77,"ko-layer"),mo(78,UL,1,5,"ko-line",35,mE),Dt(80,qL,1,5,"ko-line",35),k()()()()()(),M(81,"div",18)(82,"div",19)(83,"h3",20),H(84),$(85,"transloco"),k(),M(86,"p",31),H(87),$(88,"transloco"),k()(),M(89,"div",21),Dt(90,$L,3,3,"p",36)(91,YL,3,0,"div",37),k()()}if(e&2){let i,n=ce();F(6),me(" ",((i=n.plansService.currentPlan.value())==null?null:i.name)||j(7,30,"housePlan.title")," "),F(3),Pe(j(10,32,"housePlan.subtitle")),F(5),me(" ",j(15,34,"common.clear")," "),F(2),De("disabled",n.plansService.loading()),F(2),me(" ",j(19,36,"common.save")," "),F(6),Pe(j(25,38,"housePlan.tools")),F(4),De("variant",n.drawingMode()==="select"?"default":"outline"),F(2),me(" ",j(31,40,"housePlan.select")," "),F(2),De("variant",n.drawingMode()==="draw"?"default":"outline"),F(2),me(" ",j(35,42,"housePlan.drawWall")," "),F(2),De("variant",n.drawingMode()==="move"?"default":"outline"),F(2),me(" ",j(39,44,"housePlan.move")," "),F(2),De("variant",n.drawingMode()==="delete"?"destructive":"outline"),F(2),me(" ",j(43,46,"housePlan.delete")," "),F(5),me("",j(48,48,"housePlan.mode"),":"),F(2),Ft(n.drawingMode()==="select"?49:n.drawingMode()==="draw"?50:n.drawingMode()==="delete"?51:-1),F(5),Pe(j(55,50,"housePlan.stats")),F(3),Fn("",j(58,52,"housePlan.wallCount"),": ",n.walls().length),F(3),Fn("",j(61,54,"housePlan.scale"),": 1:",100/n.scale()),F(5),Pe(j(66,56,"housePlan.canvas")),F(3),Ft(n.drawingMode()==="draw"?68:n.drawingMode()==="select"?69:n.drawingMode()==="delete"?70:-1),F(4),Ji("cursor",n.drawingMode()==="draw"?"crosshair":n.drawingMode()==="delete"?"not-allowed":"default"),F(),De("config",n.stageConfig),F(2),Co(n.gridLines()),F(3),Co(n.wallLines()),F(2),Ft(n.tempLine()?80:-1),F(4),Pe(j(85,58,"housePlan.wallList")),F(3),Pe(j(88,60,"housePlan.wallListDesc")),F(3),Ft(n.walls().length===0?90:91)}}function JL(e,t){if(e&1&&(M(0,"div",52),H(1),$(2,"transloco"),k()),e&2){let i=ce(2);F(),Fn(" ",j(2,2,"housePlan.structureLinked"),": ",i.wallStructureId()," ")}}function QL(e,t){e&1&&(M(0,"p",53),H(1),$(2,"transloco"),k()),e&2&&(F(),Pe(j(2,1,"housePlan.noStructureLinked")))}function ZL(e,t){if(e&1&&(M(0,"div",54)(1,"p",58),H(2),$(3,"transloco"),k(),M(4,"p",29),H(5),$(6,"transloco"),k()()),e&2){let i=ce(2);F(2),Pe(j(3,3,"housePlan.dimensions")),F(3),Fn(" ",j(6,5,"housePlan.length"),": ",i.calculateWallLength(i.selectedWall().points[0],i.selectedWall().points[1],i.selectedWall().points[2],i.selectedWall().points[3]).toFixed(2)," m ")}}function e_(e,t){if(e&1){let i=Qt();M(0,"div",43),se("click",function(){Te(i);let o=ce();return Ae(o.closeMetadataSheet())}),k(),M(1,"div",44)(2,"div",45)(3,"div")(4,"h3",46),H(5),$(6,"transloco"),k(),M(7,"p",29),H(8),$(9,"transloco"),k()(),M(10,"div",37)(11,"label",47),H(12),$(13,"transloco"),k(),M(14,"input",48),lr("ngModelChange",function(o){Te(i);let s=ce();return ar(s.wallName,o)||(s.wallName=o),Ae(o)}),k()(),M(15,"div",37)(16,"label",49),H(17),$(18,"transloco"),k(),M(19,"input",50),lr("ngModelChange",function(o){Te(i);let s=ce();return ar(s.wallThickness,o)||(s.wallThickness=o),Ae(o)}),k()(),M(20,"div",37)(21,"label",51),H(22),$(23,"transloco"),k(),M(24,"p",29),H(25),$(26,"transloco"),k(),Dt(27,JL,3,4,"div",52)(28,QL,3,3,"p",53),k(),Dt(29,ZL,7,7,"div",54),M(30,"div",55)(31,"button",56),se("click",function(){Te(i);let o=ce();return Ae(o.closeMetadataSheet())}),H(32),$(33,"transloco"),k(),M(34,"button",57),se("click",function(){Te(i);let o=ce();return Ae(o.saveWallMetadata())}),H(35),$(36,"transloco"),k()()()()}if(e&2){let i=ce();F(5),Pe(j(6,12,"housePlan.wallMetadata")),F(3),Pe(j(9,14,"housePlan.wallMetadataDesc")),F(4),me(" ",j(13,16,"housePlan.wallName")," "),F(2),rr("ngModel",i.wallName),F(3),me(" ",j(18,18,"housePlan.wallThickness")," (cm) "),F(2),rr("ngModel",i.wallThickness),F(3),Pe(j(23,20,"housePlan.wallStructure")),F(3),Pe(j(26,22,"housePlan.wallStructureDesc")),F(2),Ft(i.wallStructureId()?27:28),F(2),Ft(i.selectedWall()?29:-1),F(3),me(" ",j(33,24,"common.cancel")," "),F(3),me(" ",j(36,26,"common.save")," ")}}var CE=(()=>{class e{route=ie(uw);router=ie(Ld);plansService=ie(Go);constructor(){Ye(()=>{let i=this.route.snapshot.paramMap.get("id");i&&this.plansService.loadPlan(i)}),Ye(()=>{let i=this.plansService.currentPlan.value();i&&(this.walls.set(i.walls||[]),this.scale.set(i.scale||20))})}canvasWidth=800;canvasHeight=600;gridSize=20;scale=Be(20);drawingMode=Be("select");walls=Be([]);selectedWallId=Be(null);isDrawing=Be(!1);tempLine=Be(null);isMetadataSheetOpen=Be(!1);selectedWall=ae(()=>{let i=this.selectedWallId();return i&&this.walls().find(n=>n.id===i)||null});wallName=Be("");wallThickness=Be(30);wallStructureId=Be(null);gridLines=ae(()=>{let i=[];for(let n=0;n<=this.canvasWidth;n+=this.gridSize)i.push({points:[n,0,n,this.canvasHeight],stroke:"#e5e7eb",strokeWidth:n%(this.gridSize*5)===0?1.5:.5});for(let n=0;n<=this.canvasHeight;n+=this.gridSize)i.push({points:[0,n,this.canvasWidth,n],stroke:"#e5e7eb",strokeWidth:n%(this.gridSize*5)===0?1.5:.5});return i});wallLines=ae(()=>this.walls().map(i=>({id:i.id,points:i.points,stroke:i.id===this.selectedWallId()?"#3b82f6":i.color,strokeWidth:4,listening:!0})));setDrawingMode(i){this.drawingMode.set(i),i!=="select"&&this.selectedWallId.set(null)}onStageMouseDown(i){let n=i.event.target.getStage();if(!n)return;let o=n.getPointerPosition();if(o){if(this.drawingMode()==="draw")if(this.isDrawing()){let s=this.tempLine();if(s){let r={id:Date.now().toString(),name:`Wall ${this.walls().length+1}`,points:s,thickness:30,color:"#1f2937"};this.walls.update(a=>[...a,r])}this.isDrawing.set(!1),this.tempLine.set(null)}else{this.isDrawing.set(!0);let s=this.snapToGrid(o);this.tempLine.set([s.x,s.y,s.x,s.y])}else if(this.drawingMode()==="delete"){let s=this.getWallAtPosition(o);s&&(this.walls.update(r=>r.filter(a=>a.id!==s.id)),this.selectedWallId.set(null))}}}onStageMouseMove(i){if(this.drawingMode()==="draw"&&this.isDrawing()){let n=i.event.target.getStage();if(!n)return;let o=n.getPointerPosition();if(!o)return;let s=this.snapToGrid(o),r=this.tempLine();r&&this.tempLine.set([r[0],r[1],s.x,s.y])}}onWallClick(i){if(this.drawingMode()==="select"){this.selectedWallId.set(i);let n=this.walls().find(o=>o.id===i);n&&(this.wallName.set(n.name),this.wallThickness.set(n.thickness),this.wallStructureId.set(n.structureId||null),this.isMetadataSheetOpen.set(!0))}else this.drawingMode()==="delete"&&(this.walls.update(n=>n.filter(o=>o.id!==i)),this.selectedWallId.set(null))}saveWallMetadata(){let i=this.selectedWallId();i&&(this.walls.update(n=>n.map(o=>o.id===i?_(b({},o),{name:this.wallName(),thickness:this.wallThickness(),structureId:this.wallStructureId()??void 0}):o)),this.isMetadataSheetOpen.set(!1))}closeMetadataSheet(){this.isMetadataSheetOpen.set(!1),this.selectedWallId.set(null)}deleteSelectedWall(){let i=this.selectedWallId();i&&(this.walls.update(n=>n.filter(o=>o.id!==i)),this.isMetadataSheetOpen.set(!1),this.selectedWallId.set(null))}clearAll(){confirm("Are you sure you want to clear all walls?")&&(this.walls.set([]),this.selectedWallId.set(null),this.isDrawing.set(!1),this.tempLine.set(null))}savePlan(){let i=this.route.snapshot.paramMap.get("id");if(!i){console.error("No plan ID found");return}this.plansService.updatePlan(i,{walls:this.walls(),scale:this.scale()})}goBack(){this.router.navigate(["/home","house-plans"])}snapToGrid(i){return{x:Math.round(i.x/this.gridSize)*this.gridSize,y:Math.round(i.y/this.gridSize)*this.gridSize}}getWallAtPosition(i){for(let o of this.walls()){let[s,r,a,l]=o.points;if(this.distanceToLineSegment(i,{x:s,y:r},{x:a,y:l})<10)return o}return null}distanceToLineSegment(i,n,o){let s=o.x-n.x,r=o.y-n.y,a=s*s+r*r;if(a===0)return Math.sqrt((i.x-n.x)**2+(i.y-n.y)**2);let l=((i.x-n.x)*s+(i.y-n.y)*r)/a;l=Math.max(0,Math.min(1,l));let d=n.x+l*s,c=n.y+l*r;return Math.sqrt((i.x-d)**2+(i.y-c)**2)}calculateWallLength(i,n,o,s){return Math.sqrt(Math.pow(o-i,2)+Math.pow(s-n,2))/this.scale()}stageConfig={width:this.canvasWidth,height:this.canvasHeight};static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ee({type:e,selectors:[["gh-house-plan-editor"]],features:[ze([Go,ai({lucidePointer:Yw,lucidePencil:Kw,lucideMove:$w,lucideTrash:dr,lucideSquare:e1,lucideSave:Qw,lucideArrowUpDown:Lw,lucideArrowLeft:Iw})])],decls:5,vars:2,consts:[[1,"p-4","md:p-6","space-y-4"],[1,"flex","items-center","justify-center","py-12"],[1,"text-center","py-12","text-destructive"],["size","large"],["hlmBtn","","variant","outline",1,"mt-4",3,"click"],["hlm","","name","lucideArrowLeft","size","sm",1,"mr-2"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-4"],["hlmBtn","","variant","ghost","size","icon",3,"click"],["hlm","","name","lucideArrowLeft","size","sm"],[1,"text-2xl","md:text-3xl","font-bold"],[1,"text-muted-foreground","mt-1"],[1,"flex","gap-2"],["hlmBtn","","variant","outline",3,"click"],["hlm","","name","lucideTrash","size","sm",1,"mr-2"],["hlmBtn","",3,"click","disabled"],["hlm","","name","lucideSave","size","sm",1,"mr-2"],[1,"grid","gap-4","lg:grid-cols-[auto_1fr]"],["hlmCard",""],["hlmCardHeader",""],["hlmCardTitle",""],["hlmCardContent",""],[1,"flex","flex-row","lg:flex-col","gap-2"],["hlmBtn","","size","sm",1,"w-full","justify-start",3,"click","variant"],["hlm","","name","lucidePointer","size","sm",1,"mr-2"],["hlm","","name","lucidePencil","size","sm",1,"mr-2"],["hlmBtn","","size","sm","disabled","",1,"w-full","justify-start",3,"click","variant"],["hlm","","name","lucideMove","size","sm",1,"mr-2"],[1,"mt-4","pt-4","border-t"],[1,"text-sm","text-muted-foreground"],[1,"text-sm","font-medium","mb-2"],["hlmCardDescription",""],["hlmCardContent","",1,"overflow-auto"],[1,"border","rounded-md","bg-white","inline-block"],[3,"mousedown","mousemove","config"],[3,"config"],[1,"text-sm","text-muted-foreground","text-center","py-8"],[1,"space-y-2"],[3,"click","config"],[1,"flex","items-center","justify-between","p-3","border","rounded-md","hover:bg-accent","cursor-pointer","transition-colors",3,"bg-accent"],[1,"flex","items-center","justify-between","p-3","border","rounded-md","hover:bg-accent","cursor-pointer","transition-colors",3,"click"],[1,"font-medium"],["hlm","","name","lucideTrash","size","sm"],[1,"fixed","inset-0","z-50","bg-black/50",3,"click"],[1,"fixed","right-0","top-0","z-50","h-full","w-full","max-w-md","bg-background","shadow-lg","p-6","overflow-y-auto"],[1,"space-y-4"],[1,"text-lg","font-semibold"],["hlmLabel","","for","wall-name"],["hlmInput","","id","wall-name","type","text",3,"ngModelChange","ngModel"],["hlmLabel","","for","wall-thickness"],["hlmInput","","id","wall-thickness","type","number","min","1","step","1",3,"ngModelChange","ngModel"],["hlmLabel",""],[1,"p-2","bg-accent","rounded-md","text-sm"],[1,"text-sm","text-muted-foreground","italic"],[1,"space-y-2","pt-4","border-t"],[1,"flex","gap-2","pt-4"],["hlmBtn","","variant","outline",1,"flex-1",3,"click"],["hlmBtn","",1,"flex-1",3,"click"],[1,"text-sm","font-medium"]],template:function(n,o){n&1&&(M(0,"div",0),Dt(1,_L,2,0,"div",1)(2,OL,8,7,"div",2)(3,XL,92,62),k(),Dt(4,e_,37,28)),n&2&&(F(),Ft(o.plansService.currentPlan.isLoading()?1:o.plansService.currentPlan.error()?2:3),F(3),Ft(o.isMetadataSheetOpen()?4:-1))},dependencies:[Qi,Hd,Od,Tw,Nd,Aw,Bd,fE,_h,wo,ur,hr,cr,bo,Bt,Fa,Vd,Gt,Ht,zd,Zi,vo],encapsulation:2,changeDetection:0})}return e})();var qs=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setFrameworkOverrides(e){this.frameworkOverrides=e}getListeners(e,t,i){let n=t?this.allAsyncListeners:this.allSyncListeners,o=n.get(e);return!o&&i&&(o=new Set,n.set(e,o)),o}noRegisteredListenersExist(){return this.allSyncListeners.size===0&&this.allAsyncListeners.size===0&&this.globalSyncListeners.size===0&&this.globalAsyncListeners.size===0}addEventListener(e,t,i=!1){this.getListeners(e,i,!0).add(t)}removeEventListener(e,t,i=!1){let n=this.getListeners(e,i,!1);n&&(n.delete(t),n.size===0&&(i?this.allAsyncListeners:this.allSyncListeners).delete(e))}addGlobalListener(e,t=!1){this.getGlobalListeners(t).add(e)}removeGlobalListener(e,t=!1){this.getGlobalListeners(t).delete(e)}dispatchEvent(e){this.dispatchToListeners(e,!0),this.dispatchToListeners(e,!1),this.firedEvents[e.type]=!0}dispatchEventOnce(e){this.firedEvents[e.type]||this.dispatchEvent(e)}dispatchToListeners(e,t){let i=e.type;if(t&&"event"in e){let a=e.event;a instanceof Event&&(e.eventPath=a.composedPath())}let{frameworkOverrides:n}=this,o=a=>{let l=n?()=>n.wrapIncoming(a):a;t?this.dispatchAsync(l):l()},s=this.getListeners(i,t,!1);if((s?.size??0)>0){let a=new Set(s);for(let l of a)s?.has(l)&&o(()=>l(e))}let r=this.getGlobalListeners(t);if(r.size>0){let a=new Set(r);for(let l of a)o(()=>l(i,e))}}getGlobalListeners(e){return e?this.globalAsyncListeners:this.globalSyncListeners}dispatchAsync(e){if(this.asyncFunctionsQueue.push(e),!this.scheduled){let t=()=>{window.setTimeout(this.flushAsyncQueue.bind(this),0)};this.frameworkOverrides?this.frameworkOverrides.wrapIncoming(t):t(),this.scheduled=!0}}flushAsyncQueue(){this.scheduled=!1;let e=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[];for(let t of e)t()}};function ro(e){return e==null||e===""?null:e}function q(e){return e!=null&&e!==""}function Qe(e){return!q(e)}function wC(e){return e!=null&&typeof e.toString=="function"?e.toString():null}function nd(e,t){let i=e?JSON.stringify(e):null,n=t?JSON.stringify(t):null;return i===n}function t_(e,t,i=!1){let n=e==null,o=t==null;if(e?.toNumber&&(e=e.toNumber()),t?.toNumber&&(t=t.toNumber()),n&&o)return 0;if(n)return-1;if(o)return 1;function s(r,a){return r>a?1:r<a?-1:0}if(typeof e!="string"||!i)return s(e,t);try{return e.localeCompare(t)}catch{return s(e,t)}}var i_=/[&<>"']/g,n_={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Sa(e){return e?.toString().toString()??null}function jl(e){return Sa(e)?.replace(i_,t=>n_[t])??null}function wn(e){return e.eRootDiv.getRootNode()}function tt(e){return wn(e).activeElement}function kt(e){let{gos:t,eRootDiv:i}=e,n=null,o=t.get("getDocument");return o&&q(o)?n=o():i&&(n=i.ownerDocument),n&&q(n)?n:document}function HR(e){let t=tt(e);return t===null||t===kt(e).body}function GR(e){return kt(e).defaultView||window}function ev(e){let t=null,i=null;try{t=kt(e).fullscreenElement}catch{}finally{t||(t=wn(e));let n=t.querySelector("body");n?i=n:t instanceof ShadowRoot?i=t:t instanceof Document?i=t?.documentElement:i=t}return i}function o_(e){return ev(e)?.clientWidth??(window.innerWidth||-1)}function s_(e){return ev(e)?.clientHeight??(window.innerHeight||-1)}function Xi(e,t,i){i==null||typeof i=="string"&&i==""?VR(e,t):Hi(e,t,i)}function Hi(e,t,i){e.setAttribute(zR(t),i.toString())}function VR(e,t){e.removeAttribute(zR(t))}function zR(e){return`aria-${e}`}function jo(e,t){t?e.setAttribute("role",t):e.removeAttribute("role")}function r_(e){let t;return e==="asc"?t="ascending":e==="desc"?t="descending":e==="mixed"?t="other":t="none",t}function a_(e){return e.getAttribute("aria-label")}function ma(e,t){Xi(e,"label",t)}function od(e,t){Xi(e,"labelledby",t)}function WR(e,t){Xi(e,"live",t)}function l_(e,t){Xi(e,"atomic",t)}function d_(e,t){Xi(e,"relevant",t)}function c_(e,t){Xi(e,"invalid",t)}function u_(e,t){Xi(e,"disabled",t)}function UR(e,t){Xi(e,"hidden",t)}function bC(e,t){Hi(e,"expanded",t)}function h_(e,t){Hi(e,"setsize",t)}function p_(e,t){Hi(e,"posinset",t)}function g_(e,t){Hi(e,"multiselectable",t)}function f_(e,t){Hi(e,"rowcount",t)}function sp(e,t){Hi(e,"rowindex",t)}function m_(e,t){Hi(e,"rowspan",t)}function C_(e,t){Hi(e,"colcount",t)}function qR(e,t){Hi(e,"colindex",t)}function v_(e,t){Hi(e,"colspan",t)}function w_(e,t){Hi(e,"sort",t)}function b_(e){VR(e,"sort")}function $R(e,t){Xi(e,"selected",t)}function y_(e,t){Xi(e,"controls",t)}function S_(e,t){y_(e,t.id),od(t,e.id)}function vE(e,t){Xi(e,"owns",t)}function kp(e,t){return t===void 0?e("ariaIndeterminate","indeterminate"):t===!0?e("ariaChecked","checked"):e("ariaUnchecked","unchecked")}var x_="[tabindex], input, select, button, textarea, [href]",jR="[disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function Kl(e){return!e||!e.matches("input, select, button, textarea")||!e.matches(jR)?!1:Pn(e)}function Je(e,t,i={}){let{skipAriaHidden:n}=i;e.classList.toggle("ag-hidden",!t),n||UR(e,!t)}function E_(e,t,i={}){let{skipAriaHidden:n}=i;e.classList.toggle("ag-invisible",!t),n||UR(e,!t)}function sd(e,t){let i="disabled",n=t?s=>s.setAttribute(i,""):s=>s.removeAttribute(i);n(e);let o=e.querySelectorAll("input")??[];for(let s of o)n(s)}function Hs(e,t,i){let n=0;for(;e;){if(e.classList.contains(t))return!0;if(e=e.parentElement,typeof i=="number"){if(++n>i)break}else if(e===i)break}return!1}function Xs(e){let{height:t,width:i,borderTopWidth:n,borderRightWidth:o,borderBottomWidth:s,borderLeftWidth:r,paddingTop:a,paddingRight:l,paddingBottom:d,paddingLeft:c,marginTop:u,marginRight:h,marginBottom:p,marginLeft:g,boxSizing:f}=window.getComputedStyle(e),m=Number.parseFloat;return{height:m(t||"0"),width:m(i||"0"),borderTopWidth:m(n||"0"),borderRightWidth:m(o||"0"),borderBottomWidth:m(s||"0"),borderLeftWidth:m(r||"0"),paddingTop:m(a||"0"),paddingRight:m(l||"0"),paddingBottom:m(d||"0"),paddingLeft:m(c||"0"),marginTop:m(u||"0"),marginRight:m(h||"0"),marginBottom:m(p||"0"),marginLeft:m(g||"0"),boxSizing:f}}function tv(e){let t=Xs(e);return t.boxSizing==="border-box"?t.height-t.paddingTop-t.paddingBottom-t.borderTopWidth-t.borderBottomWidth:t.height}function rd(e){let t=Xs(e);return t.boxSizing==="border-box"?t.width-t.paddingLeft-t.paddingRight-t.borderLeftWidth-t.borderRightWidth:t.width}function KR(e){let{height:t,marginBottom:i,marginTop:n}=Xs(e);return Math.floor(t+i+n)}function rp(e){let{width:t,marginLeft:i,marginRight:n}=Xs(e);return Math.floor(t+i+n)}function YR(e){let t=e.getBoundingClientRect(),{borderTopWidth:i,borderLeftWidth:n,borderRightWidth:o,borderBottomWidth:s}=Xs(e);return{top:t.top+(i||0),left:t.left+(n||0),right:t.right+(o||0),bottom:t.bottom+(s||0)}}function ap(e,t){let i=e.scrollLeft;return t&&(i=Math.abs(i)),i}function lp(e,t,i){i&&(t*=-1),e.scrollLeft=t}function Ot(e){for(;e?.firstChild;)e.firstChild.remove()}function hi(e){e?.parentNode&&e.remove()}function XR(e){return!!e.offsetParent}function Pn(e){return e.checkVisibility?e.checkVisibility({checkVisibilityCSS:!0}):!(!XR(e)||window.getComputedStyle(e).visibility!=="visible")}function iv(e){let t=document.createElement("div");return t.innerHTML=(e||"").trim(),t.firstChild}function JR(e,t,i){i&&i.nextSibling===t||(e.firstChild?i?i.nextSibling?e.insertBefore(t,i.nextSibling):e.appendChild(t):e.firstChild&&e.firstChild!==t&&e.insertAdjacentElement("afterbegin",t):e.appendChild(t))}function QR(e,t){for(let i=0;i<t.length;i++){let n=t[i],o=e.children[i];o!==n&&e.insertBefore(n,o)}}function R_(e){return e.replace(/[A-Z]/g,t=>`-${t.toLocaleLowerCase()}`)}function md(e,t){if(t)for(let i of Object.keys(t)){let n=t[i];if(!i?.length||n==null)continue;let o=R_(i),s=n.toString(),r=s.replace(/\s*!important/g,""),a=r.length!=s.length?"important":void 0;e.style.setProperty(o,r,a)}}function jh(e){return()=>{let t=e();return t?nv(t)||ZR(t):!0}}function nv(e){return e.clientWidth<e.scrollWidth}function ZR(e){return e.clientHeight<e.scrollHeight}function dp(e,t){t==="flex"?(e.style.removeProperty("width"),e.style.removeProperty("minWidth"),e.style.removeProperty("maxWidth"),e.style.flex="1 1 auto"):xn(e,t)}function xn(e,t){t=ov(t),e.style.width=t,e.style.maxWidth=t,e.style.minWidth=t}function Yl(e,t){t=ov(t),e.style.height=t,e.style.maxHeight=t,e.style.minHeight=t}function ov(e){return typeof e=="number"?`${e}px`:e}function sv(e){return e instanceof Node||e instanceof HTMLElement}function bi(e,t,i){i==null||i===""?e.removeAttribute(t):e.setAttribute(t,i.toString())}function Qo(e,t,i){let o=GR(e).ResizeObserver,s=o?new o(i):null;return s?.observe(t),()=>s?.disconnect()}function po(e,t){let i=GR(e);i.requestAnimationFrame?i.requestAnimationFrame(t):i.webkitRequestAnimationFrame?i.webkitRequestAnimationFrame(t):i.setTimeout(t,0)}var e6="data-ref",B0;function wE(){return B0??(B0=document.createTextNode(" ")),B0.cloneNode()}function Cd(e){let{attrs:t,children:i,cls:n,ref:o,role:s,tag:r}=e,a=document.createElement(r);if(n&&(a.className=n),o&&a.setAttribute(e6,o),s&&a.setAttribute("role",s),t)for(let l of Object.keys(t))a.setAttribute(l,t[l]);if(i)if(typeof i=="string")a.textContent=i;else{let l=!0;for(let d of i)d&&(typeof d=="string"?(a.appendChild(document.createTextNode(d)),l=!1):typeof d=="function"?a.appendChild(d()):(l&&(a.appendChild(wE()),l=!1),a.append(Cd(d)),a.appendChild(wE())))}return a}var P_=["touchstart","touchend","touchmove","touchcancel","scroll"],M_=["wheel"],H0={},t6=(()=>{let e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return i=>{if(typeof H0[i]=="boolean")return H0[i];let n=document.createElement(e[i]||"div");return i="on"+i,H0[i]=i in n}})();function k_(e,t){return!t||!e?!1:F_(t).indexOf(e)>=0}function D_(e){let t=[],i=e.target;for(;i;)t.push(i),i=i.parentElement;return t}function F_(e){let t=e;return t.path?t.path:t.composedPath?t.composedPath():D_(t)}function T_(e,t,i){let n=A_(t),o;n!=null&&(o={passive:n}),e.addEventListener(t,i,o)}var A_=e=>{let t=P_.includes(e),i=M_.includes(e);if(t)return!0;if(i)return!1};function i6(e,t,i){if(i===0)return!1;let n=Math.abs(e.clientX-t.clientX),o=Math.abs(e.clientY-t.clientY);return Math.max(n,o)<=i}var Xl=(e,t)=>{let i=e.identifier;for(let n=0,o=t.length;n<o;++n){let s=t[n];if(s.identifier===i)return s}return null};function ad(e,t){return e.gos.isElementInThisInstance(t.target)}function I_(e,t,i){let o=e.getBoundingClientRect().height,s=o_(i)-2,r=s_(i)-2;if(!e.offsetParent)return;let l=YR(e.offsetParent),{clientY:d,clientX:c}=t,u=d-l.top-o/2,h=c-l.left-10,p=kt(i),g=p.defaultView||window,f=g.pageYOffset||p.documentElement.scrollTop,m=g.pageXOffset||p.documentElement.scrollLeft;s>0&&h+e.clientWidth>s+m&&(h=s+m-e.clientWidth),h<0&&(h=0),r>0&&u+e.clientHeight>r+f&&(u=r+f-e.clientHeight),u<0&&(u=0),e.style.left=`${h}px`,e.style.top=`${u}px`}var Kh=(e,...t)=>{for(let i of t){let[n,o,s,r]=i;n.addEventListener(o,s,r),e.push(i)}},rv=e=>{if(e){for(let[t,i,n,o]of e)t.removeEventListener(i,n,o);e.length=0}},Uo=e=>{e.cancelable&&e.preventDefault()};function L_(e,t){return t}function n6(e){return e?.getLocaleTextFunc()??L_}function __(e,t,i,n){let o=t[i];return e.getLocaleTextFunc()(i,typeof o=="function"?o(n):o,n)}function O_(e){return(t,i,n)=>e({key:t,defaultValue:i,variableValues:n})}function N_(e){return(t,i,n)=>{let o=e?.[t];if(o&&n?.length){let s=0;for(;!(s>=n.length||o.indexOf("${variable}")===-1);)o=o.replace("${variable}",n[s++])}return o??i}}var Mn=class{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.propertyListenerId=0,this.lastChangeSetIdLookup={},this.isAlive=()=>!this.destroyed}preWireBeans(e){this.beans=e,this.stubContext=e.context,this.eventSvc=e.eventSvc,this.gos=e.gos}destroy(){let{destroyFunctions:e}=this;for(let t=0;t<e.length;t++)e[t]();e.length=0,this.destroyed=!0,this.dispatchLocalEvent({type:"destroyed"})}addEventListener(e,t,i){this.localEventService||(this.localEventService=new qs),this.localEventService.addEventListener(e,t,i)}removeEventListener(e,t,i){this.localEventService?.removeEventListener(e,t,i)}dispatchLocalEvent(e){this.localEventService?.dispatchEvent(e)}addManagedElementListeners(e,t){return this._setupListeners(e,t)}addManagedEventListeners(e){return this._setupListeners(this.eventSvc,e)}addManagedListeners(e,t){return this._setupListeners(e,t)}_setupListeners(e,t){let i=[];for(let n of Object.keys(t)){let o=t[n];o&&i.push(this._setupListener(e,n,o))}return i}_setupListener(e,t,i){if(this.destroyed)return()=>null;let n;if(B_(e))e.__addEventListener(t,i),n=()=>(e.__removeEventListener(t,i),null);else{let o=H_(e);e instanceof HTMLElement?T_(e,t,i):o?e.addListener(t,i):e.addEventListener(t,i),n=o?()=>(e.removeListener(t,i),null):()=>(e.removeEventListener(t,i),null)}return this.destroyFunctions.push(n),()=>(n(),this.destroyFunctions=this.destroyFunctions.filter(o=>o!==n),null)}setupPropertyListener(e,t){let{gos:i}=this;i.addPropertyEventListener(e,t);let n=()=>(i.removePropertyEventListener(e,t),null);return this.destroyFunctions.push(n),()=>(n(),this.destroyFunctions=this.destroyFunctions.filter(o=>o!==n),null)}addManagedPropertyListener(e,t){return this.destroyed?()=>null:this.setupPropertyListener(e,t)}addManagedPropertyListeners(e,t){if(this.destroyed)return;let i=e.join("-")+this.propertyListenerId++,n=o=>{if(o.changeSet){if(o.changeSet&&o.changeSet.id===this.lastChangeSetIdLookup[i])return;this.lastChangeSetIdLookup[i]=o.changeSet.id}let s={type:"propertyChanged",changeSet:o.changeSet,source:o.source};t(s)};for(let o of e)this.setupPropertyListener(o,n)}getLocaleTextFunc(){return n6(this.beans.localeSvc)}addDestroyFunc(e){this.isAlive()?this.destroyFunctions.push(e):e()}createOptionalManagedBean(e,t){return e?this.createManagedBean(e,t):void 0}createManagedBean(e,t){let i=this.createBean(e,t);return this.addDestroyFunc(this.destroyBean.bind(this,e,t)),i}createBean(e,t,i){return(t||this.stubContext).createBean(e,i)}destroyBean(e,t){return(t||this.stubContext).destroyBean(e)}destroyBeans(e,t){return(t||this.stubContext).destroyBeans(e)}};function B_(e){return e.__addEventListener!==void 0}function H_(e){return e.eventServiceType==="global"}var D=class extends Mn{},bE={};function av(e,t){bE[t]||(e(),bE[t]=!0)}var G_={pending:!1,funcs:[]},V_={pending:!1,funcs:[]};function yC(e,t="setTimeout",i){let n=t==="raf"?V_:G_;if(n.funcs.push(e),n.pending)return;n.pending=!0;let o=()=>{let s=n.funcs.slice();n.funcs.length=0,n.pending=!1;for(let r of s)r()};t==="raf"?po(i,o):window.setTimeout(o,0)}function _t(e,t,i){let n;return function(...o){let s=this;window.clearTimeout(n),n=window.setTimeout(function(){e.isAlive()&&t.apply(s,o)},i)}}function yE(e,t){let i=0;return function(...n){let o=this,s=Date.now();s-i<t||(i=s,e.apply(o,n))}}function z_(e,t,i,n=100){let o=Date.now(),s=null,r=!1,a=()=>{s!=null&&(window.clearInterval(s),s=null)};e.addDestroyFunc(a);let l=()=>{let d=Date.now()-o>n;(t()||d)&&(i(),r=!0,a())};l(),r||(s=window.setInterval(l,10))}var o6=new Set(["__proto__","constructor","prototype"]);function W_(e,t){if(e!=null){if(Array.isArray(e)){for(let i=0;i<e.length;i++)t(i.toString(),e[i]);return}for(let i of Object.keys(e).filter(n=>!o6.has(n)))t(i,e[i])}}function ni(e,t,i=!0,n=!1){q(t)&&W_(t,(o,s)=>{let r=e[o];r!==s&&(n&&r==null&&s!=null&&typeof s=="object"&&s.constructor===Object&&(r={},e[o]=r),SE(s)&&SE(r)&&!Array.isArray(r)?ni(r,s,i,n):(i||s!==void 0)&&(e[o]=s))})}function SE(e){return typeof e=="object"&&e!==null}var U_=(()=>{let e=class no{static applyGlobalGridOptions(i){if(!no.gridOptions)return b({},i);let n={};return ni(n,no.gridOptions,!0,!0),no.mergeStrategy==="deep"?ni(n,i,!0,!0):n=b(b({},n),i),no.gridOptions.context&&(n.context=no.gridOptions.context),i.context&&(no.mergeStrategy==="deep"&&n.context&&ni(i.context,n.context,!0,!0),n.context=i.context),n}static applyGlobalGridOption(i,n){if(no.mergeStrategy==="deep"){let o=q_(i);if(o&&typeof o=="object"&&typeof n=="object")return no.applyGlobalGridOptions({[i]:n})[i]}return n}};return e.gridOptions=void 0,e.mergeStrategy="shallow",e})(),lv=U_;function q_(e){return lv.gridOptions?.[e]}var $_={suppressContextMenu:!1,preventDefaultOnContextMenu:!1,allowContextMenuWithControlKey:!1,suppressMenuHide:!0,enableBrowserTooltips:!1,tooltipTrigger:"hover",tooltipShowDelay:2e3,tooltipHideDelay:1e4,tooltipMouseTrack:!1,tooltipShowMode:"standard",tooltipInteraction:!1,copyHeadersToClipboard:!1,copyGroupHeadersToClipboard:!1,clipboardDelimiter:"	",suppressCopyRowsToClipboard:!1,suppressCopySingleCellRanges:!1,suppressLastEmptyLineOnPaste:!1,suppressClipboardPaste:!1,suppressClipboardApi:!1,suppressCutToClipboard:!1,maintainColumnOrder:!1,enableStrictPivotColumnOrder:!1,suppressFieldDotNotation:!1,allowDragFromColumnsToolPanel:!1,suppressMovableColumns:!1,suppressColumnMoveAnimation:!1,suppressMoveWhenColumnDragging:!1,suppressDragLeaveHidesColumns:!1,suppressRowGroupHidesColumns:!1,suppressAutoSize:!1,autoSizePadding:20,skipHeaderOnAutoSize:!1,singleClickEdit:!1,suppressClickEdit:!1,readOnlyEdit:!1,stopEditingWhenCellsLoseFocus:!1,enterNavigatesVertically:!1,enterNavigatesVerticallyAfterEdit:!1,enableCellEditingOnBackspace:!1,undoRedoCellEditing:!1,undoRedoCellEditingLimit:10,suppressCsvExport:!1,suppressExcelExport:!1,cacheQuickFilter:!1,includeHiddenColumnsInQuickFilter:!1,excludeChildrenWhenTreeDataFiltering:!1,enableAdvancedFilter:!1,includeHiddenColumnsInAdvancedFilter:!1,enableCharts:!1,masterDetail:!1,keepDetailRows:!1,keepDetailRowsCount:10,detailRowAutoHeight:!1,tabIndex:0,rowBuffer:10,valueCache:!1,valueCacheNeverExpires:!1,enableCellExpressions:!1,suppressTouch:!1,suppressFocusAfterRefresh:!1,suppressBrowserResizeObserver:!1,suppressPropertyNamesCheck:!1,suppressChangeDetection:!1,debug:!1,suppressLoadingOverlay:!1,suppressNoRowsOverlay:!1,pagination:!1,paginationPageSize:100,paginationPageSizeSelector:!0,paginationAutoPageSize:!1,paginateChildRows:!1,suppressPaginationPanel:!1,pivotMode:!1,pivotPanelShow:"never",pivotDefaultExpanded:0,pivotSuppressAutoColumn:!1,suppressExpandablePivotGroups:!1,functionsReadOnly:!1,suppressAggFuncInHeader:!1,alwaysAggregateAtRootLevel:!1,aggregateOnlyChangedColumns:!1,suppressAggFilteredOnly:!1,removePivotHeaderRowWhenSingleValueColumn:!1,animateRows:!0,cellFlashDuration:500,cellFadeDuration:1e3,allowShowChangeAfterFilter:!1,domLayout:"normal",ensureDomOrder:!1,enableRtl:!1,suppressColumnVirtualisation:!1,suppressMaxRenderedRowRestriction:!1,suppressRowVirtualisation:!1,rowDragManaged:!1,rowDragInsertDelay:500,suppressRowDrag:!1,suppressMoveWhenRowDragging:!1,rowDragEntireRow:!1,rowDragMultiRow:!1,embedFullWidthRows:!1,groupDisplayType:"singleColumn",groupDefaultExpanded:0,groupMaintainOrder:!1,groupSelectsChildren:!1,groupSuppressBlankHeader:!1,groupSelectsFiltered:!1,showOpenedGroup:!1,groupRemoveSingleChildren:!1,groupRemoveLowestSingleChildren:!1,groupHideOpenParents:!1,groupAllowUnbalanced:!1,rowGroupPanelShow:"never",suppressMakeColumnVisibleAfterUnGroup:!1,treeData:!1,rowGroupPanelSuppressSort:!1,suppressGroupRowsSticky:!1,rowModelType:"clientSide",asyncTransactionWaitMillis:50,suppressModelUpdateAfterUpdateTransaction:!1,cacheOverflowSize:1,infiniteInitialRowCount:1,serverSideInitialRowCount:1,cacheBlockSize:100,maxBlocksInCache:-1,maxConcurrentDatasourceRequests:2,blockLoadDebounceMillis:0,purgeClosedRowNodes:!1,serverSideSortAllLevels:!1,serverSideOnlyRefreshFilteredGroups:!1,serverSidePivotResultFieldSeparator:"_",viewportRowModelPageSize:5,viewportRowModelBufferSize:5,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,debounceVerticalScrollbar:!1,suppressHorizontalScroll:!1,suppressScrollOnNewData:!1,suppressScrollWhenPopupsAreOpen:!1,suppressAnimationFrame:!1,suppressMiddleClickScrolls:!1,suppressPreventDefaultOnMouseWheel:!1,rowMultiSelectWithClick:!1,suppressRowDeselection:!1,suppressRowClickSelection:!1,suppressCellFocus:!1,suppressHeaderFocus:!1,suppressMultiRangeSelection:!1,enableCellTextSelection:!1,enableRangeSelection:!1,enableRangeHandle:!1,enableFillHandle:!1,fillHandleDirection:"xy",suppressClearOnFillReduction:!1,accentedSort:!1,unSortIcon:!1,suppressMultiSort:!1,alwaysMultiSort:!1,suppressMaintainUnsortedOrder:!1,suppressRowHoverHighlight:!1,suppressRowTransform:!1,columnHoverHighlight:!1,deltaSort:!1,enableGroupEdit:!1,groupLockGroupColumns:0,serverSideEnableClientSideSort:!1,suppressServerSideFullWidthLoadingRow:!1,pivotMaxGeneratedColumns:-1,columnMenu:"new",reactiveCustomComponents:!0,suppressSetFilterByDefault:!1,rowNumbers:!1,enableFilterHandlers:!1},s6="https://www.ag-grid.com";function Ko(e,t,...i){e.get("debug")&&console.log("AG Grid: "+t,...i)}function Jl(e,...t){av(()=>console.warn("AG Grid: "+e,...t),e+t?.join(""))}function sa(e,...t){av(()=>console.error("AG Grid: "+e,...t),e+t?.join(""))}var r6=new Set,cp={},ra={},Yh,a6=!1,l6=!1,j_=!1;function K_(e){let[t,i]=e.version.split(".")||[],[n,o]=Yh.split(".")||[];return t===n&&i===o}function Y_(e){Yh||(Yh=e.version);let t=n=>`You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. ${n} Please update all modules to the same version.`;e.version?K_(e)||sa(t(`'${e.moduleName}' is version ${e.version} but the other modules are version ${Yh}.`)):sa(t(`'${e.moduleName}' is incompatible.`));let i=e.validate?.();i&&!i.isValid&&sa(`${i.message}`)}function ld(e,t,i=!1){i||(a6=!0),Y_(e);let n=e.rowModels??["all"];r6.add(e);let o;t!==void 0?(l6=!0,ra[t]===void 0&&(ra[t]={}),o=ra[t]):o=cp;for(let s of n)o[s]===void 0&&(o[s]={}),o[s][e.moduleName]=e;if(e.dependsOn)for(let s of e.dependsOn)ld(s,t,i)}function X_(e){delete ra[e]}function SC(e,t,i){let n=o=>!!cp[o]?.[e]||!!ra[t]?.[o]?.[e];return n(i)||n("all")}function dv(){return l6}function J_(e,t){let i=ra[e]??{};return[...Object.values(cp.all??{}),...Object.values(i.all??{}),...Object.values(cp[t]??{}),...Object.values(i[t]??{})]}function Q_(){return new Set(r6)}function Z_(){return a6}function d6(){return j_}var c6=class{static register(e){ld(e,void 0)}static registerModules(e){for(let t of e)ld(t,void 0)}},z="34.3.1",xE=2e3,EE=100,u6="_version_",h6=null,aa=`${s6}/javascript-data-grid`;function eO(e){h6=e}function tO(e){aa=e}function p6(e,t,i){return h6?.(e,t)??[sO(e,t,i)]}function cv(e,t,i,n,o){e(`${n?"warning":"error"} #${t}`,...p6(t,i,o))}function iO(e){if(!e)return String(e);let t={};for(let i of Object.keys(e))typeof e[i]!="object"&&typeof e[i]!="function"&&(t[i]=e[i]);return JSON.stringify(t)}function nO(e){let t=e;return e instanceof Error?t=e.toString():typeof e=="object"&&(t=iO(e)),t}function up(e){return e===void 0?"undefined":e===null?"null":e}function xC(e,t){return`${e}?${t.toString()}`}function oO(e,t,i){let n=Array.from(t.entries()).sort((s,r)=>r[1].length-s[1].length),o=xC(e,t);for(let[s,r]of n){if(s===u6)continue;let a=o.length-i;if(a<=0)break;let l="...",d=a+l.length,c=r.length-d>EE?r.slice(0,r.length-d)+l:r.slice(0,EE)+l;t.set(s,c),o=xC(e,t)}return o}function g6(e,t){let i=new URLSearchParams;if(i.append(u6,z),t)for(let s of Object.keys(t))i.append(s,nO(t[s]));let n=`${aa}/errors/${e}`,o=xC(n,i);return o.length<=xE?o:oO(n,i,xE)}var sO=(e,t,i)=>{let n=g6(e,t),o=`${i?i+` 
`:""}Visit ${n}`;return d6()?o:`${o}${i?"":` 
  Alternatively register the ValidationModule to see the full message in the console.`}`};function I(...e){cv(Jl,e[0],e[1],!0)}function Ge(...e){cv(sa,e[0],e[1],!1)}function ql(e,t,i){cv(sa,e,t,!1,i)}function rO(e,t){let i=t[0];return`error #${i} `+p6(i,t[1],e).join(" ")}function En(...e){return rO(void 0,e)}function f6(e,t){return e.get("rowModelType")===t}function gt(e,t){return f6(e,"clientSide")}function xa(e,t){return f6(e,"serverSide")}function Nt(e,t){return e.get("domLayout")===t}function Gs(e){return pp(e)!==void 0}function m6(e){return typeof e.get("getRowHeight")=="function"}function aO(e,t){return t?!e.get("enableStrictPivotColumnOrder"):e.get("maintainColumnOrder")}function Yo(e,t,i=!1,n){let{gos:o,environment:s}=e;if(n==null&&(n=s.getDefaultRowHeight()),m6(o)){if(i)return{height:n,estimated:!0};let l={node:t,data:t.data},d=o.getCallback("getRowHeight")(l);if(EC(d))return d===0&&I(23),{height:Math.max(1,d),estimated:!1}}if(t.detail&&o.get("masterDetail"))return lO(o);let r=o.get("rowHeight");return{height:r&&EC(r)?r:n,estimated:!1}}function lO(e){if(e.get("detailRowAutoHeight"))return{height:1,estimated:!1};let t=e.get("detailRowHeight");return EC(t)?{height:t,estimated:!1}:{height:300,estimated:!1}}function Vs(e){let{environment:t,gos:i}=e,n=i.get("rowHeight");if(!n||Qe(n))return t.getDefaultRowHeight();let o=t.refreshRowHeightVariable();return o!==-1?o:(I(24),t.getDefaultRowHeight())}function EC(e){return!isNaN(e)&&typeof e=="number"&&isFinite(e)}function C6(e,t,i){let n=t[e.getDomDataKey()];return n?n[i]:void 0}function $s(e,t,i,n){let o=e.getDomDataKey(),s=t[o];Qe(s)&&(s={},t[o]=s),s[i]=n}function la(e){return e.get("ensureDomOrder")?!1:e.get("animateRows")}function v6(e){return!(e.get("paginateChildRows")||e.get("groupHideOpenParents")||Nt(e,"print"))}function bn(e){return!e.get("autoGroupColumnDef")?.comparator&&!e.get("treeData")}function RC(e){let t=e.get("groupAggFiltering");if(typeof t=="function")return e.getCallback("groupAggFiltering");if(t===!0)return()=>!0}function w6(e){return e.get("grandTotalRow")}function b6(e,t){return t?!1:e.get("groupDisplayType")==="groupRows"}function y6(e,t,i){return!!t.group&&!t.footer&&b6(e,i)}function Ca(e){let t=e.getCallback("getRowId");return t===void 0?t:i=>{let n=t(i);return typeof n!="string"&&(av(()=>I(25,{id:n}),"getRowIdString"),n=String(n)),n}}function dO(e,t){let i=e.get("groupHideParentOfSingleChild");return!!(i===!0||i==="leafGroupsOnly"&&t.leafGroup||e.get("groupRemoveSingleChildren")||e.get("groupRemoveLowestSingleChildren")&&t.leafGroup)}function cO(e){let t=e.get("maxConcurrentDatasourceRequests");return t>0?t:void 0}function da(e){return e?.checkboxes??!0}function Xh(e){return e?.mode==="multiRow"&&(e.headerCheckbox??!0)}function hp(e){if(typeof e=="object")return e.checkboxLocation??"selectionColumn"}function G0(e){return e?.hideDisabledCheckboxes??!1}function uO(e){return typeof e.get("rowSelection")!="string"}function uo(e){let t=e.get("cellSelection");return t!==void 0?!!t:e.get("enableRangeSelection")}function S6(e){let t=e.get("rowSelection")??"single";if(typeof t=="string"){let i=e.get("suppressRowClickSelection"),n=e.get("suppressRowDeselection");return i&&n?!1:i?"enableDeselection":n?"enableSelection":!0}return t.mode==="singleRow"||t.mode==="multiRow"?t.enableClickSelection??!1:!1}function hO(e){let t=S6(e);return t===!0||t==="enableSelection"}function pO(e){let t=S6(e);return t===!0||t==="enableDeselection"}function PC(e){let t=e.get("rowSelection");return typeof t=="string"?e.get("isRowSelectable"):t?.isRowSelectable}function pp(e){let t="beanName"in e&&e.beanName==="gos"?e.get("rowSelection"):e.rowSelection;if(typeof t=="string")switch(t){case"multiple":return"multiRow";case"single":return"singleRow";default:return}switch(t?.mode){case"multiRow":case"singleRow":return t.mode;default:return}}function dd(e){return pp(e)==="multiRow"}function gO(e){let t=e.get("rowSelection");return typeof t=="string"?e.get("rowMultiSelectWithClick"):t?.enableSelectionWithoutKeys??!1}function gp(e){let t=e.get("rowSelection");if(typeof t=="string"){let i=e.get("groupSelectsChildren"),n=e.get("groupSelectsFiltered");return i&&n?"filteredDescendants":i?"descendants":"self"}return t?.mode==="multiRow"?t.groupSelects:void 0}function x6(e,t=!0){let i=e.get("rowSelection");return typeof i!="object"?t?"all":void 0:i.mode==="multiRow"?i.selectAll:"all"}function fO(e){let t=e.get("rowSelection");return typeof t=="string"?!1:t?.mode==="multiRow"?t.ctrlASelectsRows??!1:!1}function cd(e){let t=gp(e);return t==="descendants"||t==="filteredDescendants"}function RE(e){let t=e.get("rowSelection");return typeof t=="object"&&t.masterSelects||"self"}function mO(e){return e.isModuleRegistered("SetFilter")&&!e.get("suppressSetFilterByDefault")}function yi(e){return e.get("columnMenu")==="legacy"}function CO(e){return!yi(e)}function vO(e){return!e||e.length<2?e:"on"+e[0].toUpperCase()+e.substring(1)}function E6(e,t,i){typeof e!="object"&&(e={});let n=b({},e);for(let o of i){let s=t[o];typeof s<"u"&&(n[o]=s)}return n}function R6(e,t){if(!e)return;let i={},n=!1;for(let r of Object.keys(e))i[r]=e[r],n=!0;if(!n)return;let o={type:"gridOptionsChanged",options:i};t.dispatchEvent(o);let s=b({type:"componentStateChanged"},i);t.dispatchEvent(s)}function te(e,t){return e.addCommon(t)}function PE({gos:e},t){return t.button===2||t.ctrlKey&&e.get("allowContextMenuWithControlKey")}var wO={resizable:!0,sortable:!0},bO=0;function P6(){return bO++}function Xo(e){return e instanceof Js}var Js=class extends D{constructor(e,t,i,n){super(),this.colDef=e,this.userProvidedColDef=t,this.colId=i,this.primary=n,this.isColumn=!0,this.instanceId=P6(),this.autoHeaderHeight=null,this.moving=!1,this.resizing=!1,this.menuVisible=!1,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.colEventSvc=new qs,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.flex=null,this.colIdSanitised=jl(i)}destroy(){super.destroy(),this.beans.rowSpanSvc?.deregister(this)}getInstanceId(){return this.instanceId}setState(){let{colDef:e,beans:{sortSvc:t,pinnedCols:i,colFlex:n}}=this;t?.initCol(this);let o=e.hide;o!==void 0?this.visible=!o:this.visible=!e.initialHide,i?.initCol(this),n?.initCol(this)}setColDef(e,t,i){let n=e.spanRows!==this.colDef.spanRows;this.colDef=e,this.userProvidedColDef=t,this.initMinAndMaxWidths(),this.initDotNotation(),this.initTooltip(),n&&(this.beans.rowSpanSvc?.deregister(this),this.initRowSpan()),this.dispatchColEvent("colDefChanged",i)}getUserProvidedColDef(){return this.userProvidedColDef}getParent(){return this.parent}getOriginalParent(){return this.originalParent}postConstruct(){this.setState(),this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip(),this.initRowSpan(),this.addPivotListener()}initDotNotation(){let{gos:e,colDef:{field:t,tooltipField:i}}=this,n=e.get("suppressFieldDotNotation");this.fieldContainsDots=q(t)&&t.includes(".")&&!n,this.tooltipFieldContainsDots=q(i)&&i.includes(".")&&!n}initMinAndMaxWidths(){let e=this.colDef;this.minWidth=e.minWidth??this.beans.environment.getDefaultColumnMinWidth(),this.maxWidth=e.maxWidth??Number.MAX_SAFE_INTEGER}initTooltip(){this.beans.tooltipSvc?.initCol(this)}initRowSpan(){this.colDef.spanRows&&this.beans.rowSpanSvc?.register(this)}addPivotListener(){let e=this.beans.pivotColDefSvc,t=this.colDef.pivotValueColumn;!e||!t||this.addManagedListeners(t,{colDefChanged:i=>{let n=e.recreateColDef(this.colDef);this.setColDef(n,n,i.source)}})}resetActualWidth(e){let t=this.calculateColInitialWidth(this.colDef);this.setActualWidth(t,e,!0)}calculateColInitialWidth(e){let t,i=e.width,n=e.initialWidth;return i!=null?t=i:n!=null?t=n:t=200,Math.max(Math.min(t,this.maxWidth),this.minWidth)}isEmptyGroup(){return!1}isRowGroupDisplayed(e){return this.beans.showRowGroupCols?.isRowGroupDisplayed(this,e)??!1}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}getHighlighted(){return this.highlighted}__addEventListener(e,t){this.colEventSvc.addEventListener(e,t)}__removeEventListener(e,t){this.colEventSvc.removeEventListener(e,t)}addEventListener(e,t){this.frameworkEventListenerService=this.beans.frameworkOverrides.createLocalEventListenerWrapper?.(this.frameworkEventListenerService,this.colEventSvc);let i=this.frameworkEventListenerService?.wrap(e,t)??t;this.colEventSvc.addEventListener(e,i)}removeEventListener(e,t){let i=this.frameworkEventListenerService?.unwrap(e,t)??t;this.colEventSvc.removeEventListener(e,i)}createColumnFunctionCallbackParams(e){return te(this.gos,{node:e,data:e.data,column:this,colDef:this.colDef})}isSuppressNavigable(e){return this.beans.cellNavigation?.isSuppressNavigable(this,e)??!1}isCellEditable(e){return this.beans.editSvc?.isCellEditable({rowNode:e,column:this})??!1}isSuppressFillHandle(){return!!this.colDef.suppressFillHandle}isAutoHeight(){return!!this.colDef.autoHeight}isAutoHeaderHeight(){return!!this.colDef.autoHeaderHeight}isRowDrag(e){return this.isColumnFunc(e,this.colDef.rowDrag)}isDndSource(e){return this.isColumnFunc(e,this.colDef.dndSource)}isCellCheckboxSelection(e){return this.beans.selectionSvc?.isCellCheckboxSelection(this,e)??!1}isSuppressPaste(e){return this.isColumnFunc(e,this.colDef?.suppressPaste??null)}isResizable(){return!!this.getColDefValue("resizable")}getColDefValue(e){return this.colDef[e]??wO[e]}isColumnFunc(e,t){if(typeof t=="boolean")return t;if(typeof t=="function"){let i=this.createColumnFunctionCallbackParams(e);return t(i)}return!1}createColumnEvent(e,t){return te(this.gos,{type:e,column:this,columns:[this],source:t})}isMoving(){return this.moving}getSort(){return this.sort}isSortable(){return!!this.getColDefValue("sortable")}isSortAscending(){return this.sort==="asc"}isSortDescending(){return this.sort==="desc"}isSortNone(){return Qe(this.sort)}isSorting(){return q(this.sort)}getSortIndex(){return this.sortIndex}isMenuVisible(){return this.menuVisible}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(e,t){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchColEvent("leftChanged",t))}isFilterActive(){return this.filterActive}isHovered(){return I(261),!!this.beans.colHover?.isHovered(this)}setFirstRightPinned(e,t){this.firstRightPinned!==e&&(this.firstRightPinned=e,this.dispatchColEvent("firstRightPinnedChanged",t))}setLastLeftPinned(e,t){this.lastLeftPinned!==e&&(this.lastLeftPinned=e,this.dispatchColEvent("lastLeftPinnedChanged",t))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return this.pinned==="left"||this.pinned==="right"}isPinnedLeft(){return this.pinned==="left"}isPinnedRight(){return this.pinned==="right"}getPinned(){return this.pinned}setVisible(e,t){let i=e===!0;this.visible!==i&&(this.visible=i,this.dispatchColEvent("visibleChanged",t)),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){return!this.getColDef().suppressSpanHeaderHeight}getFirstRealParent(){let e=this.getOriginalParent();for(;e?.isPadding();)e=e.getOriginalParent();return e}getColumnGroupPaddingInfo(){let e=this.getParent();if(!e?.isPadding())return{numberOfParents:0,isSpanningTotal:!1};let t=e.getPaddingLevel()+1,i=!0;for(;e;){if(!e.isPadding()){i=!1;break}e=e.getParent()}return{numberOfParents:t,isSpanningTotal:i}}getColDef(){return this.colDef}getDefinition(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){let t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}createBaseColDefParams(e){return te(this.gos,{node:e,data:e.data,colDef:this.colDef,column:this})}getColSpan(e){if(Qe(this.colDef.colSpan))return 1;let t=this.createBaseColDefParams(e),i=this.colDef.colSpan(t);return Math.max(i,1)}getRowSpan(e){if(Qe(this.colDef.rowSpan))return 1;let t=this.createBaseColDefParams(e),i=this.colDef.rowSpan(t);return Math.max(i,1)}setActualWidth(e,t,i=!1){e=Math.max(e,this.minWidth),e=Math.min(e,this.maxWidth),this.actualWidth!==e&&(this.actualWidth=e,this.flex!=null&&t!=="flex"&&t!=="gridInitializing"&&(this.flex=null),i||this.fireColumnWidthChangedEvent(t)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(e){this.dispatchColEvent("widthChanged",e)}isGreaterThanMax(e){return e>this.maxWidth}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex}isRowGroupActive(){return this.rowGroupActive}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}isValueActive(){return this.aggregationActive}isAllowPivot(){return this.colDef.enablePivot===!0}isAllowValue(){return this.colDef.enableValue===!0}isAllowRowGroup(){return this.colDef.enableRowGroup===!0}dispatchColEvent(e,t,i){let n=this.createColumnEvent(e,t);i&&ni(n,i),this.colEventSvc.dispatchEvent(n)}dispatchStateUpdatedEvent(e){this.colEventSvc.dispatchEvent({type:"columnStateUpdated",key:e})}};function Yt(e){return e instanceof Jh}var Jh=class extends D{constructor(e,t,i,n){super(),this.colGroupDef=e,this.groupId=t,this.padding=i,this.level=n,this.isColumn=!1,this.expandable=!1,this.instanceId=P6(),this.expandableListenerRemoveCallback=null,this.expanded=!!e?.openByDefault}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0),super.destroy()}reset(e,t){this.colGroupDef=e,this.level=t,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return this.children?this.children.some(e=>e.isVisible()):!1}isPadding(){return this.padding}setExpanded(e){this.expanded=e===void 0?!1:e,this.dispatchLocalEvent({type:"expandedChanged"})}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(e){this.children=e}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){let e=[];return this.addLeafColumns(e),e}forEachLeafColumn(e){if(this.children)for(let t of this.children)Xo(t)?e(t):Yt(t)&&t.forEachLeafColumn(e)}addLeafColumns(e){if(this.children)for(let t of this.children)Xo(t)?e.push(t):Yt(t)&&t.addLeafColumns(e)}getColumnGroupShow(){let e=this.colGroupDef;if(e)return e.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();let e=this.onColumnVisibilityChanged.bind(this);for(let t of this.getLeafColumns())t.__addEventListener("visibleChanged",e);this.expandableListenerRemoveCallback=()=>{for(let t of this.getLeafColumns())t.__removeEventListener("visibleChanged",e);this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let e=!1,t=!1,i=!1,n=this.findChildrenRemovingPadding();for(let s=0,r=n.length;s<r;s++){let a=n[s];if(!a.isVisible())continue;let l=a.getColumnGroupShow();l==="open"?(e=!0,i=!0):l==="closed"?(t=!0,i=!0):(e=!0,t=!0)}let o=e&&t&&i;this.expandable!==o&&(this.expandable=o,this.dispatchLocalEvent({type:"expandableChanged"}))}findChildrenRemovingPadding(){let e=[],t=i=>{for(let n of i)Yt(n)&&n.isPadding()?t(n.children):e.push(n)};return t(this.children),e}onColumnVisibilityChanged(){this.setExpandable()}},yO={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}};function ME(e,t,i){let n={},o=e.gos;return Object.assign(n,o.get("defaultColGroupDef")),Object.assign(n,t),o.validateColDef(n,i),n}var SO=class{constructor(){this.existingKeys={}}addExistingKeys(e){for(let t=0;t<e.length;t++)this.existingKeys[e[t]]=!0}getUniqueKey(e,t){e=wC(e);let i=0;for(;;){let n=e??t;if(n?i!==0&&(n+="_"+i):n=i,!this.existingKeys[n]){let o=String(n);return e&&i>0&&I(273,{providedId:e,usedId:o}),this.existingKeys[o]=!0,o}i++}}},Sce=Object.freeze([]);function Ue(e){if(e?.length)return e[e.length-1]}function Zo(e,t,i){if(e===t)return!0;if(!e||!t)return e==null&&t==null;let n=e.length;if(n!==t.length)return!1;for(let o=0;o<n;o++)if(e[o]!==t[o]&&!i?.(e[o],t[o]))return!1;return!0}function Hl(e,t){if(e)for(let i of e)t(i)}function Yi(e,t){let i=e.indexOf(t);i>=0&&e.splice(i,1)}function kE(e,t,i){for(let n=0;n<t.length;n++)Yi(e,t[n]);for(let n=t.length-1;n>=0;n--)e.splice(i,0,t[n])}var Dp="ag-Grid-AutoColumn",M6="ag-Grid-SelectionColumn",k6="ag-Grid-RowNumbersColumn";function D6(e){let t=[],i=n=>{for(let o=0;o<n.length;o++){let s=n[o];Xo(s)?t.push(s):Yt(s)&&i(s.getChildren())}};return i(e),t}function oo(e){return e.reduce((t,i)=>t+i.getActualWidth(),0)}function fp(e,t,i){let n={};if(!t)return;lo(null,t,s=>{n[s.getInstanceId()]=s}),i&&lo(null,i,s=>{n[s.getInstanceId()]=null});let o=Object.values(n).filter(s=>s!=null);e.context.destroyBeans(o)}function uv(e){return e.getId().startsWith(Dp)}function go(e){return(typeof e=="string"?e:"getColId"in e?e.getColId():e.colId)?.startsWith(M6)??!1}function ao(e){return(typeof e=="string"?e:"getColId"in e?e.getColId():e.colId)?.startsWith(k6)??!1}function xO(e){return go(e)||ao(e)}function mp(e){let t=[];return e instanceof Array?t=e:typeof e=="string"&&(t=e.split(",")),t}function EO(e,t){return Zo(e,t,(i,n)=>i.getColId()===n.getColId())}function RO(e){e.map={};for(let t of e.list)e.map[t.getId()]=t}function ca(e){return e==="optionsUpdated"?"gridOptionsChanged":e}function Ql(e,t){let i=e===t,n=e.getColDef()===t,o=e.getColId()==t;return i||n||o}var PO=(e,t)=>(i,n)=>{let o={value1:void 0,value2:void 0},s=!1;return e&&(e[i]!==void 0&&(o.value1=e[i],s=!0),q(n)&&e[n]!==void 0&&(o.value2=e[n],s=!0)),!s&&t&&(t[i]!==void 0&&(o.value1=t[i]),q(n)&&t[n]!==void 0&&(o.value2=t[n])),o},MO=(e,t)=>{Yt(e)&&e.setupExpandable(),e.originalParent=t};function kO(e,t=null,i,n,o){let s=new SO,{existingCols:r,existingGroups:a,existingColKeys:l}=DO(n);s.addExistingKeys(l);let d=F6(e,t,0,i,r,s,a,o),{colGroupSvc:c}=e,u=c?.findMaxDepth(d,0)??0,h=c?c.balanceColumnTree(d,0,u,s):d;return lo(null,h,MO),{columnTree:h,treeDepth:u}}function DO(e){let t=[],i=[],n=[];return e&&lo(null,e,o=>{if(Yt(o)){let s=o;i.push(s)}else{let s=o;n.push(s.getId()),t.push(s)}}),{existingCols:t,existingGroups:i,existingColKeys:n}}function F6(e,t,i,n,o,s,r,a){if(!t)return[];let{colGroupSvc:l}=e,d=new Array(t.length);for(let c=0;c<d.length;c++){let u=t[c];l&&_O(u)?d[c]=l.createProvidedColumnGroup(n,u,i,o,s,r,a):d[c]=FO(e,n,u,o,s,a)}return d}function FO(e,t,i,n,o,s){let r=AO(i,n);r&&n?.splice(r.idx,1);let a=r?.column;if(a){let l=MC(e,i,a.getColId());a.setColDef(l,i,s),TO(e,a,l,s)}else{let l=o.getUniqueKey(i.colId,i.field),d=MC(e,i,l);a=new Js(d,i,l,t),e.context.createBean(a)}return e.dataTypeSvc?.addColumnListeners(a),a}function T6(e,t,i,n,o,s,r,a){let{sortSvc:l,pinnedCols:d,colFlex:c}=e;i!==void 0&&t.setVisible(!i,a),l&&(l.updateColSort(t,n,a),o!==void 0&&l.setColSortIndex(t,o)),s!==void 0&&d?.setColPinned(t,s),r!==void 0&&c?.setColFlex(t,r)}function TO(e,t,i,n){T6(e,t,i.hide,i.sort,i.sortIndex,i.pinned,i.flex,n);let o=t.getFlex();if(!(o!=null&&o>0))if(i.width!=null)t.setActualWidth(i.width,n);else{let s=t.getActualWidth();t.setActualWidth(s,n)}}function AO(e,t){if(t)for(let i=0;i<t.length;i++){let n=t[i].getUserProvidedColDef();if(!n)continue;if(e.colId!=null){if(t[i].getId()===e.colId)return{idx:i,column:t[i]};continue}if(e.field!=null){if(n.field===e.field)return{idx:i,column:t[i]};continue}if(n===e)return{idx:i,column:t[i]}}}function MC(e,t,i,n){let{gos:o,dataTypeSvc:s}=e,r={},a=o.get("defaultColDef");ni(r,a,!1,!0);let l=IO(e,r,t,i);l&&LO(e,l,r);let d=r.cellDataType;ni(r,t,!1,!0),d!==void 0&&(r.cellDataType=d);let c=o.get("autoGroupColumnDef"),u=bn(o);return t.rowGroup&&c&&u&&ni(r,{sort:c.sort,initialSort:c.initialSort},!1,!0),s&&(s.postProcess(r),s.validateColDef(r)),o.validateColDef(r,i,n),r}function IO(e,t,i,n){let o=e.dataTypeSvc?.updateColDefAndGetColumnType(t,i,n),s=i.type??o??t.type;return t.type=s,s?mp(s):void 0}function LO(e,t,i){if(!t.length)return;let n=Object.assign({},yO),o=e.gos.get("columnTypes")||{};for(let s of Object.keys(o)){let r=o[s];s in n?I(34,{key:s}):(r.type&&I(35),n[s]=r)}for(let s of t){let r=n[s.trim()];r?ni(i,r,!1,!0):I(36,{t:s})}}function _O(e){return e.children!==void 0}function lo(e,t,i){if(t)for(let n=0;n<t.length;n++){let o=t[n];Yt(o)&&lo(o,o.getChildren(),i),i(o,e)}}function A6(e,t){let i=[],n=[],o=[];return e.forEach(r=>{let a=r.getColDef().lockPosition;a==="right"?o.push(r):a==="left"||a===!0?i.push(r):n.push(r)}),t.get("enableRtl")?[...o,...n,...i]:[...i,...n,...o]}function I6(e,t){let i=!0;return lo(null,t,n=>{if(!Yt(n))return;let o=n;if(!o.getColGroupDef()?.marryChildren)return;let a=[];for(let h of o.getLeafColumns()){let p=e.indexOf(h);a.push(p)}let l=Math.max.apply(Math,a),d=Math.min.apply(Math,a),c=l-d,u=o.getLeafColumns().length-1;c>u&&(i=!1)}),i}function L6(e,t){if(!e||e.length==0)return;let i=t(e[0]);for(let n=1;n<e.length;n++)if(i!==t(e[n]))return;return i}function _6(e,t,i){if(!t.length)return;let n=t.length===1?t[0]:null,o=L6(t,s=>s.getPinned());e.dispatchEvent({type:"columnPinned",pinned:o??null,columns:t,column:n,source:i})}function OO(e,t,i){if(!t.length)return;let n=t.length===1?t[0]:null,o=L6(t,s=>s.isVisible());e.dispatchEvent({type:"columnVisible",visible:o,columns:t,column:n,source:i})}function NO(e,t,i,n){e.dispatchEvent({type:t,columns:i,column:i&&i.length==1?i[0]:null,source:n})}function va(e,t,i,n,o=null){t?.length&&e.dispatchEvent({type:"columnResized",columns:t,column:t.length===1?t[0]:null,flexColumns:o,finished:i,source:n})}function Ki(e,t,i){let{colModel:n,rowGroupColsSvc:o,pivotColsSvc:s,autoColSvc:r,selectionColSvc:a,colAnimation:l,visibleCols:d,pivotResultCols:c,environment:u,valueColsSvc:h,eventSvc:p,gos:g}=e,f=n.getColDefCols()??[],m=a?.getColumns();if(!f.length&&!m?.length)return!1;if(t?.state&&!t.state.forEach)return I(32),!1;let C=(S,x,E,T,L)=>{if(!S)return;let O=PO(x,t.defaultState),W=O("flex").value1;if(T6(e,S,O("hide").value1,O("sort").value1,O("sortIndex").value1,O("pinned").value1,W,i),W==null){let G=O("width").value1;if(G!=null){let Q=S.getColDef().minWidth??u.getDefaultColumnMinWidth();Q!=null&&G>=Q&&S.setActualWidth(G,i)}}L||!S.isPrimary()||(h?.syncColumnWithState(S,i,O),o?.syncColumnWithState(S,i,O,E),s?.syncColumnWithState(S,i,O,T))},v=(S,x,E)=>{let T=O6(e,i),L=x.slice(),O={},W={},G=[],Q=[],ge=[],pe=0,ot=o?.columns.slice()??[],gi=s?.columns.slice()??[];for(let Ne of S){let bt=Ne.colId;if(bt.startsWith(Dp)){G.push(Ne),ge.push(Ne);continue}if(go(bt)){Q.push(Ne),ge.push(Ne);continue}let Et=E(bt);Et?(C(Et,Ne,O,W,!1),Yi(L,Et)):(ge.push(Ne),pe+=1)}let ke=Ne=>C(Ne,null,O,W,!1);L.forEach(ke),o?.sortColumns(DE.bind(o,O,ot)),s?.sortColumns(DE.bind(s,W,gi)),n.refreshCols(!1,i);let Ke=(Ne,bt,yt=[])=>{for(let Et of bt){let Yv=Ne(Et.colId);Yi(yt,Yv),C(Yv,Et,null,null,!0)}yt.forEach(ke)};return Ke(Ne=>r?.getColumn(Ne)??null,G,r?.getColumns()?.slice()),Ke(Ne=>a?.getColumn(Ne)??null,Q,a?.getColumns()?.slice()),HO(t,n,g),d.refresh(i),p.dispatchEvent({type:"columnEverythingChanged",source:i}),T(),{unmatchedAndAutoStates:ge,unmatchedCount:pe}};l?.start();let{unmatchedAndAutoStates:w,unmatchedCount:y}=v(t.state||[],f,S=>n.getColDefCol(S));if(w.length>0||q(t.defaultState)){let S=c?.getPivotResultCols()?.list??[];y=v(w,S,x=>c?.getPivotResultCol(x)??null).unmatchedCount}return l?.finish(),y===0}function BO(e,t){let{colModel:i,autoColSvc:n,selectionColSvc:o,eventSvc:s,gos:r}=e,a=i.getColDefCols();if(!a?.length)return;let l=i.getColDefColTree(),d=D6(l),c=[],u=1e3,h=1e3,p=v=>{let w=N6(v);Qe(w.rowGroupIndex)&&w.rowGroup&&(w.rowGroupIndex=u++),Qe(w.pivotIndex)&&w.pivot&&(w.pivotIndex=h++),c.push(w)};n?.getColumns()?.forEach(p),o?.getColumns()?.forEach(p),d?.forEach(p),Ki(e,{state:c},t);let g=n?.getColumns()??[],C=[...o?.getColumns()??[],...g,...a].map(v=>({colId:v.colId}));Ki(e,{state:C,applyOrder:!0},t),s.dispatchEvent(te(r,{type:"columnsReset",source:t}))}function O6(e,t){let{rowGroupColsSvc:i,pivotColsSvc:n,valueColsSvc:o,colModel:s,sortSvc:r,eventSvc:a}=e,l={rowGroupColumns:i?.columns.slice()??[],pivotColumns:n?.columns.slice()??[],valueColumns:o?.columns.slice()??[]},d=Cp(e),c={};for(let u of d)c[u.colId]=u;return()=>{let u=(x,E,T,L)=>{let O=E.map(L),W=T.map(L);if(Zo(O,W))return;let Q=new Set(E);for(let pe of T)Q.delete(pe)||Q.add(pe);let ge=[...Q];a.dispatchEvent({type:x,columns:ge,column:ge.length===1?ge[0]:null,source:t})},h=x=>{let E=[];return s.forAllCols(T=>{let L=c[T.getColId()];L&&x(L,T)&&E.push(T)}),E},p=x=>x.getColId();u("columnRowGroupChanged",l.rowGroupColumns,i?.columns??[],p),u("columnPivotChanged",l.pivotColumns,n?.columns??[],p);let f=h((x,E)=>{let T=x.aggFunc!=null,L=T!=E.isValueActive(),O=T&&x.aggFunc!=E.getAggFunc();return L||O});f.length>0&&NO(a,"columnValueChanged",f,t),va(a,h((x,E)=>x.width!=E.getActualWidth()),!0,t),_6(a,h((x,E)=>x.pinned!=E.getPinned()),t),OO(a,h((x,E)=>x.hide==E.isVisible()),t);let y=h((x,E)=>x.sort!=E.getSort()||x.sortIndex!=E.getSortIndex());y.length>0&&r?.dispatchSortChangedEvents(t,y);let S=Cp(e);VO(d,S,t,s,a)}}function Cp(e){let{colModel:t,rowGroupColsSvc:i,pivotColsSvc:n}=e,o=t.getColDefCols();if(Qe(o)||!t.isAlive())return[];let s=i?.columns,r=n?.columns,a=[],l=c=>{let u=c.isRowGroupActive()&&s?s.indexOf(c):null,h=c.isPivotActive()&&r?r.indexOf(c):null,p=c.isValueActive()?c.getAggFunc():null,g=c.getSort()!=null?c.getSort():null,f=c.getSortIndex()!=null?c.getSortIndex():null;a.push({colId:c.getColId(),width:c.getActualWidth(),hide:!c.isVisible(),pinned:c.getPinned(),sort:g,sortIndex:f,aggFunc:p,rowGroup:c.isRowGroupActive(),rowGroupIndex:u,pivot:c.isPivotActive(),pivotIndex:h,flex:c.getFlex()??null})};t.forAllCols(c=>l(c));let d=new Map(t.getCols().map((c,u)=>[c.getColId(),u]));return a.sort((c,u)=>{let h=d.has(c.colId)?d.get(c.colId):-1,p=d.has(u.colId)?d.get(u.colId):-1;return h-p}),a}function N6(e){let t=(g,f)=>g??f??null,i=e.getColDef(),n=t(i.sort,i.initialSort),o=t(i.sortIndex,i.initialSortIndex),s=t(i.hide,i.initialHide),r=t(i.pinned,i.initialPinned),a=t(i.width,i.initialWidth),l=t(i.flex,i.initialFlex),d=t(i.rowGroupIndex,i.initialRowGroupIndex),c=t(i.rowGroup,i.initialRowGroup);d==null&&!c&&(d=null,c=null);let u=t(i.pivotIndex,i.initialPivotIndex),h=t(i.pivot,i.initialPivot);u==null&&!h&&(u=null,h=null);let p=t(i.aggFunc,i.initialAggFunc);return{colId:e.getColId(),sort:n,sortIndex:o,hide:s,pinned:r,width:a,flex:l,rowGroup:c,rowGroupIndex:d,pivot:h,pivotIndex:u,aggFunc:p}}function HO(e,t,i){if(!e.applyOrder||!e.state)return;let n=[];for(let o of e.state)o.colId!=null&&n.push(o.colId);GO(t.cols,n,t,i)}function GO(e,t,i,n){if(e==null)return;let o=[],s={};for(let a of t){if(s[a])continue;let l=e.map[a];l&&(o.push(l),s[a]=!0)}let r=0;for(let a of e.list){let l=a.getColId();if(s[l]!=null)continue;l.startsWith(Dp)?o.splice(r++,0,a):o.push(a)}if(o=A6(o,n),!I6(o,i.getColTree())){I(39);return}e.list=o}function VO(e,t,i,n,o){let s={};for(let c of t)s[c.colId]=c;let r={};for(let c of e)s[c.colId]&&(r[c.colId]=!0);let a=e.filter(c=>r[c.colId]),l=t.filter(c=>r[c.colId]),d=[];l.forEach((c,u)=>{let h=a?.[u];if(h&&h.colId!==c.colId){let p=n.getCol(h.colId);p&&d.push(p)}}),d.length&&o.dispatchEvent({type:"columnMoved",columns:d,column:d.length===1?d[0]:null,finished:!0,source:i})}var DE=(e,t,i,n)=>{let o=e[i.getId()],s=e[n.getId()],r=o!=null,a=s!=null;if(r&&a)return o-s;if(r)return-1;if(a)return 1;let l=t.indexOf(i),d=t.indexOf(n),c=l>=0,u=d>=0;return c&&u?l-d:c?-1:1},zO=class extends D{constructor(){super(...arguments),this.beanName="colModel",this.pivotMode=!1,this.ready=!1,this.changeEventsDispatching=!1}postConstruct(){this.pivotMode=this.gos.get("pivotMode"),this.addManagedPropertyListeners(["groupDisplayType","treeData","treeDataDisplayType","groupHideOpenParents","rowNumbers","hidePaddedHeaderRows"],e=>this.refreshAll(ca(e.source))),this.addManagedPropertyListeners(["defaultColDef","defaultColGroupDef","columnTypes","suppressFieldDotNotation"],this.recreateColumnDefs.bind(this)),this.addManagedPropertyListener("pivotMode",e=>this.setPivotMode(this.gos.get("pivotMode"),ca(e.source)))}createColsFromColDefs(e){let{beans:t}=this,{valueCache:i,colAutosize:n,rowGroupColsSvc:o,pivotColsSvc:s,valueColsSvc:r,visibleCols:a,eventSvc:l,groupHierarchyColSvc:d}=t,c=this.colDefs?O6(t,e):void 0;i?.expire();let u=this.colDefCols?.list,h=this.colDefCols?.tree,p=kO(t,this.colDefs,!0,h,e);fp(t,this.colDefCols?.tree,p.columnTree);let g=p.columnTree,f=p.treeDepth,m=D6(g),C={};for(let v of m)C[v.getId()]=v;this.colDefCols={tree:g,treeDepth:f,list:m,map:C},this.createColumnsForService([d],this.colDefCols,e),o?.extractCols(e,u),s?.extractCols(e,u),r?.extractCols(e,u),this.ready=!0,this.refreshCols(!0,e),a.refresh(e),l.dispatchEvent({type:"columnEverythingChanged",source:e}),c&&(this.changeEventsDispatching=!0,c(),this.changeEventsDispatching=!1),l.dispatchEvent({type:"newColumnsLoaded",source:e}),e==="gridInitializing"&&n?.applyAutosizeStrategy()}refreshCols(e,t){if(!this.colDefCols)return;let i=this.cols?.tree;this.saveColOrder();let{autoColSvc:n,selectionColSvc:o,rowNumbersSvc:s,quickFilter:r,pivotResultCols:a,showRowGroupCols:l,rowAutoHeight:d,visibleCols:c,colViewport:u,eventSvc:h}=this.beans,p=this.selectCols(a,this.colDefCols);this.createColumnsForService([n,o,s],p,t);let g=aO(this.gos,this.showingPivotResult);(!e||g)&&this.restoreColOrder(p),this.positionLockedCols(p),l?.refresh(),r?.refreshCols(),this.setColSpanActive(),d?.setAutoHeightActive(p),c.clear(),u.clear(),!Zo(i,this.cols.tree)&&h.dispatchEvent({type:"gridColumnsChanged"})}createColumnsForService(e,t,i){for(let n of e)n&&(n.createColumns(t,o=>{this.lastOrder=o(this.lastOrder),this.lastPivotOrder=o(this.lastPivotOrder)},i),n.addColumns(t))}selectCols(e,t){let i=e?.getPivotResultCols()??null;this.showingPivotResult=i!=null;let{map:n,list:o,tree:s,treeDepth:r}=i??t;return this.cols={list:o.slice(),map:b({},n),tree:s.slice(),treeDepth:r},i&&(i.list.some(l=>this.cols?.map[l.getColId()]!==void 0)||(this.lastPivotOrder=null)),this.cols}getColsToShow(){if(!this.cols)return[];let{valueColsSvc:e,selectionColSvc:t,gos:i}=this.beans,n=this.isPivotMode()&&!this.showingPivotResult,o=t?.isSelectionColumnEnabled(),s=i.get("rowNumbers"),r=e?.columns;return this.cols.list.filter(l=>{let d=uv(l);if(n){let c=r?.includes(l);return d||c||o&&go(l)||s&&ao(l)}else return d||l.isVisible()})}refreshAll(e){this.ready&&(this.refreshCols(!1,e),this.beans.visibleCols.refresh(e))}setColsVisible(e,t=!1,i){Ki(this.beans,{state:e.map(n=>({colId:typeof n=="string"?n:n.getColId(),hide:!t}))},i)}restoreColOrder(e){let t=this.showingPivotResult?this.lastPivotOrder:this.lastOrder;if(!t)return;let i=t.filter(u=>e.map[u.getId()]!=null);if(i.length===0)return;if(i.length===e.list.length){e.list=i;return}let n=u=>{let h=u.getOriginalParent();return h?h.getChildren().length>1?!0:n(h):!1};if(!i.some(u=>n(u))){let u=new Set(i);for(let h of e.list)u.has(h)||i.push(h);e.list=i;return}let o=new Map;for(let u=0;u<i.length;u++){let h=i[u];o.set(h,u)}let s=e.list.filter(u=>!o.has(u));if(s.length===0){e.list=i;return}let r=(u,h)=>{let p=h?h.getOriginalParent():u.getOriginalParent();if(!p)return null;let g=null,f=null;for(let m of p.getChildren())if(!(m===h||m===u)){if(m instanceof Js){let C=o.get(m);if(C==null)continue;(g==null||g<C)&&(g=C,f=m);continue}m.forEachLeafColumn(C=>{let v=o.get(C);v!=null&&(g==null||g<v)&&(g=v,f=C)})}return f??r(u,p)},a=[],l=new Map;for(let u of s){let h=r(u,null);if(h==null){a.push(u);continue}let p=l.get(h);p===void 0?l.set(h,u):Array.isArray(p)?p.push(u):l.set(h,[p,u])}let d=new Array(e.list.length),c=d.length-1;for(let u=a.length-1;u>=0;u--)d[c--]=a[u];for(let u=i.length-1;u>=0;u--){let h=i[u],p=l.get(h);if(p)if(Array.isArray(p))for(let g=p.length-1;g>=0;g--){let f=p[g];d[c--]=f}else d[c--]=p;d[c--]=h}e.list=d}positionLockedCols(e){e.list=A6(e.list,this.gos)}saveColOrder(){this.showingPivotResult?this.lastPivotOrder=this.cols?.list??null:this.lastOrder=this.cols?.list??null}getColumnDefs(e){return this.colDefCols&&this.beans.colDefFactory?.getColumnDefs(this.colDefCols.list,this.showingPivotResult,this.lastOrder,this.cols?.list??[],e)}setColSpanActive(){this.colSpanActive=!!this.cols?.list.some(e=>e.getColDef().colSpan!=null)}isPivotMode(){return this.pivotMode}setPivotMode(e,t){if(e===this.pivotMode||(this.pivotMode=e,!this.ready))return;this.refreshCols(!1,t);let{visibleCols:i,eventSvc:n}=this.beans;i.refresh(t),n.dispatchEvent({type:"columnPivotModeChanged"})}isPivotActive(){let e=this.beans.pivotColsSvc?.columns;return this.pivotMode&&!!e?.length}recreateColumnDefs(e){if(!this.cols)return;this.beans.autoColSvc?.updateColumns(e);let t=ca(e.source);this.createColsFromColDefs(t)}setColumnDefs(e,t){this.colDefs=e,this.createColsFromColDefs(t)}destroy(){fp(this.beans,this.colDefCols?.tree),super.destroy()}getColTree(){return this.cols?.tree??[]}getColDefColTree(){return this.colDefCols?.tree??[]}getColDefCols(){return this.colDefCols?.list??null}getCols(){return this.cols?.list??[]}forAllCols(e){let{pivotResultCols:t,autoColSvc:i,selectionColSvc:n,groupHierarchyColSvc:o}=this.beans;Hl(this.colDefCols?.list,e),Hl(i?.columns?.list,e),Hl(n?.columns?.list,e),Hl(o?.columns?.list,e),Hl(t?.getPivotResultCols()?.list,e)}getColsForKeys(e){return e?e.map(t=>this.getCol(t)).filter(t=>t!=null):[]}getColDefCol(e){return this.colDefCols?.list?this.getColFromCollection(e,this.colDefCols):null}getCol(e){return e==null?null:this.getColFromCollection(e,this.cols)}getColById(e){return this.cols?.map[e]??null}getColFromCollection(e,t){if(t==null)return null;let{map:i,list:n}=t;if(typeof e=="string"&&i[e])return i[e];for(let a=0;a<n.length;a++)if(Ql(n[a],e))return n[a];let{autoColSvc:o,selectionColSvc:s,groupHierarchyColSvc:r}=this.beans;return o?.getColumn(e)??s?.getColumn(e)??r?.getColumn(e)??null}};var B6=class{constructor(){this.existingIds={}}getInstanceIdForKey(e){let t=this.existingIds[e],i;return typeof t!="number"?i=0:i=t+1,this.existingIds[e]=i,i}};function vd(e,t,i){return i&&e.addDestroyFunc(()=>t.destroyBean(i)),i??e}var V=null;function FE(e){return typeof e?.getGui=="function"}var H6=class{constructor(e){this.cssClassStates={},this.getGui=e}toggleCss(e,t){if(!e)return;if(e.indexOf(" ")>=0){let n=(e||"").split(" ");if(n.length>1){for(let o of n)this.toggleCss(o,t);return}}this.cssClassStates[e]!==t&&e.length&&(this.getGui()?.classList.toggle(e,t),this.cssClassStates[e]=t)}},WO=0,wd=class extends Mn{constructor(e,t){super(),this.suppressDataRefValidation=!1,this.displayed=!0,this.visible=!0,this.compId=WO++,this.cssManager=new H6(()=>this.eGui),this.componentSelectors=new Map((t??[]).map(i=>[i.selector,i])),e&&this.setTemplate(e)}preConstruct(){this.wireTemplate(this.getGui());let e="component-"+Object.getPrototypeOf(this)?.constructor?.name;for(let t of this.css??[])this.beans.environment.addGlobalCSS(t,e)}wireTemplate(e,t){e&&this.gos&&(this.applyElementsToComponent(e),this.createChildComponentsFromTags(e,t))}getCompId(){return this.compId}getDataRefAttribute(e){return e.getAttribute?e.getAttribute(e6):null}applyElementsToComponent(e,t,i,n=null){if(t===void 0&&(t=this.getDataRefAttribute(e)),t){let o=this[t];if(o===V)this[t]=n??e;else{let s=i?.[t];if(!this.suppressDataRefValidation&&!s)throw new Error(`data-ref: ${t} on ${this.constructor.name} with ${o}`)}}}createChildComponentsFromTags(e,t){let i=[];for(let n of e.childNodes??[])i.push(n);for(let n of i){if(!(n instanceof HTMLElement))continue;let o=this.createComponentFromElement(n,s=>{let r=s.getGui();if(r)for(let a of n.attributes??[])r.setAttribute(a.name,a.value)},t);if(o){if(o.addItems&&n.children.length){this.createChildComponentsFromTags(n,t);let s=Array.prototype.slice.call(n.children);o.addItems(s)}this.swapComponentForNode(o,e,n)}else n.childNodes&&this.createChildComponentsFromTags(n,t)}}createComponentFromElement(e,t,i){let n=e.nodeName,o=this.getDataRefAttribute(e),s=n.indexOf("AG-")===0,r=s?this.componentSelectors.get(n):null,a=null;if(r){let l=i&&o?i[o]:void 0;a=new r.component(l),a.setParentComponent(this),this.createBean(a,null,t)}else if(s)throw new Error(`selector: ${n}`);return this.applyElementsToComponent(e,o,i,a),a}swapComponentForNode(e,t,i){let n=e.getGui();t.replaceChild(n,i),t.insertBefore(document.createComment(i.nodeName),n),this.addDestroyFunc(this.destroyBean.bind(this,e))}activateTabIndex(e){let t=this.gos.get("tabIndex");e||(e=[]),e.length||e.push(this.getGui());for(let i of e)i.setAttribute("tabindex",t.toString())}setTemplate(e,t,i){let n;typeof e=="string"||e==null?n=iv(e):n=Cd(e),this.setTemplateFromElement(n,t,i)}setTemplateFromElement(e,t,i,n=!1){if(this.eGui=e,this.suppressDataRefValidation=n,t)for(let o=0;o<t.length;o++){let s=t[o];this.componentSelectors.set(s.selector,s)}this.wireTemplate(e,i)}getGui(){return this.eGui}getFocusableElement(){return this.eGui}getAriaElement(){return this.getFocusableElement()}setParentComponent(e){this.parentComponent=e}getParentComponent(){return this.parentComponent}setGui(e){this.eGui=e}queryForHtmlElement(e){return this.eGui.querySelector(e)}getContainerAndElement(e,t){let i=t;return e==null?null:(i||(i=this.eGui),sv(e)?{element:e,parent:i}:{element:e.getGui(),parent:i})}prependChild(e,t){let{element:i,parent:n}=this.getContainerAndElement(e,t)||{};!i||!n||n.insertAdjacentElement("afterbegin",i)}appendChild(e,t){let{element:i,parent:n}=this.getContainerAndElement(e,t)||{};!i||!n||n.appendChild(i)}isDisplayed(){return this.displayed}setVisible(e,t={}){if(e!==this.visible){this.visible=e;let{skipAriaHidden:i}=t;E_(this.eGui,e,{skipAriaHidden:i})}}setDisplayed(e,t={}){if(e!==this.displayed){this.displayed=e;let{skipAriaHidden:i}=t;Je(this.eGui,e,{skipAriaHidden:i});let n={type:"displayChanged",visible:this.displayed};this.dispatchLocalEvent(n)}}destroy(){this.parentComponent&&(this.parentComponent=void 0),super.destroy()}addGuiEventListener(e,t,i){this.eGui.addEventListener(e,t,i),this.addDestroyFunc(()=>this.eGui.removeEventListener(e,t))}addCss(e){this.cssManager.toggleCss(e,!0)}removeCss(e){this.cssManager.toggleCss(e,!1)}toggleCss(e,t){this.cssManager.toggleCss(e,t)}registerCSS(e){this.css||(this.css=[]),this.css.push(e)}},Oe=class extends wd{};function G6(e){return typeof e=="object"&&!!e.component}function UO(e,t){return new nt(i=>{i(window.setInterval(e,t))})}var nt=class $l{constructor(t){this.status=0,this.resolution=null,this.waiters=[],t(i=>this.onDone(i),i=>this.onReject(i))}static all(t){return t.length?new $l(i=>{let n=t.length,o=new Array(n);t.forEach((s,r)=>{s.then(a=>{o[r]=a,n--,n===0&&i(o)})})}):$l.resolve()}static resolve(t=null){return new $l(i=>i(t))}then(t){return new $l(i=>{this.status===1?i(t(this.resolution)):this.waiters.push(n=>i(t(n)))})}onDone(t){this.status=1,this.resolution=t;for(let i of this.waiters)i(t)}onReject(t){}};function qO(e){return e?e.prototype&&"getGui"in e.prototype:!1}function V6(e,t,i,n){let{name:o}=i,s,r,a,l,d,c;if(t){let u=t,h=u[o+"Selector"],p=h?h(n):null,g=f=>{typeof f=="string"?s=f:f!=null&&f!==!0&&(e.isFrameworkComponent(f)?a=f:r=f)};p?(g(p.component),l=p.params,d=p.popup,c=p.popupPosition):g(u[o])}return{compName:s,jsComp:r,fwComp:a,paramsFromSelector:l,popupFromSelector:d,popupPositionFromSelector:c}}var $O=class extends D{constructor(){super(...arguments),this.beanName="userCompFactory"}wireBeans(e){this.agCompUtils=e.agCompUtils,this.registry=e.registry,this.frameworkCompWrapper=e.frameworkCompWrapper,this.gridOptions=e.gridOptions}getCompDetailsFromGridOptions(e,t,i,n=!1){return this.getCompDetails(this.gridOptions,e,t,i,n)}getCompDetails(e,t,i,n,o=!1){let{name:s,cellRenderer:r}=t,{compName:a,jsComp:l,fwComp:d,paramsFromSelector:c,popupFromSelector:u,popupPositionFromSelector:h}=V6(this.beans.frameworkOverrides,e,t,n),p,g,f=w=>{let y=this.registry.getUserComponent(s,w);y&&(l=y.componentFromFramework?void 0:y.component,d=y.componentFromFramework?y.component:void 0,p=y.params,g=y.processParams)};if(a!=null&&f(a),l==null&&d==null&&i!=null&&f(i),l&&r&&!qO(l)&&(l=this.agCompUtils?.adaptFunction(t,l)),!l&&!d){let{validation:w}=this.beans;o&&(a!==i||!i)?a?w?.isProvidedUserComp(a)||Ge(50,{compName:a}):i?w||Ge(260,_(b({},this.gos.getModuleErrorParams()),{propName:s,compName:i})):Ge(216,{name:s}):i&&!w&&Ge(146,{comp:i});return}let m=this.mergeParams(e,t,n,c,p,g),C=l==null,v=l??d;return{componentFromFramework:C,componentClass:v,params:m,type:t,popupFromSelector:u,popupPositionFromSelector:h,newAgStackInstance:()=>this.newAgStackInstance(v,C,m,t)}}newAgStackInstance(e,t,i,n){let o=!t,s;o?s=new e:s=this.frameworkCompWrapper.wrap(e,n.mandatoryMethods,n.optionalMethods,n),this.createBean(s);let r=s.init?.(i);return r==null?nt.resolve(s):r.then(()=>s)}mergeParams(e,t,i,n=null,o,s){let r=b(b({},i),o),l=e?.[t.name+"Params"];if(typeof l=="function"){let d=l(i);ni(r,d)}else typeof l=="object"&&ni(r,l);return ni(r,n),s?s(r):r}},jO={name:"dateComponent",mandatoryMethods:["getDate","setDate"],optionalMethods:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled","refresh"]},KO={name:"dragAndDropImageComponent",mandatoryMethods:["setIcon","setLabel"]},YO={name:"headerComponent",optionalMethods:["refresh"]},XO={name:"innerHeaderComponent"},JO={name:"innerHeaderGroupComponent"},QO={name:"headerGroupComponent"};var ZO={name:"cellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0};var eN={name:"loadingCellRenderer",cellRenderer:!0},tN={name:"cellEditor",mandatoryMethods:["getValue"],optionalMethods:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached","refresh"]},iN={name:"loadingOverlayComponent",optionalMethods:["refresh"]},nN={name:"noRowsOverlayComponent",optionalMethods:["refresh"]},oN={name:"tooltipComponent"},hv={name:"filter",mandatoryMethods:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethods:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged","refresh"]},sN={name:"floatingFilterComponent",mandatoryMethods:["onParentModelChanged"],optionalMethods:["afterGuiAttached","refresh"]},rN={name:"fullWidthCellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0},aN={name:"loadingCellRenderer",cellRenderer:!0},lN={name:"groupRowRenderer",optionalMethods:["afterGuiAttached"],cellRenderer:!0},dN={name:"detailCellRenderer",optionalMethods:["refresh"],cellRenderer:!0};function cN(e,t){return e.getCompDetailsFromGridOptions(KO,"agDragAndDropImage",t,!0)}function uN(e,t,i){return e.getCompDetails(t,YO,"agColumnHeader",i)}function hN(e,t,i){return e.getCompDetails(t,XO,void 0,i)}function pN(e,t){let i=t.columnGroup.getColGroupDef();return e.getCompDetails(i,QO,"agColumnGroupHeader",t)}function gN(e,t,i){return e.getCompDetails(t,JO,void 0,i)}function fN(e,t){return e.getCompDetailsFromGridOptions(rN,void 0,t,!0)}function mN(e,t){return e.getCompDetailsFromGridOptions(aN,"agLoadingCellRenderer",t,!0)}function CN(e,t){return e.getCompDetailsFromGridOptions(lN,"agGroupRowRenderer",t,!0)}function vN(e,t){return e.getCompDetailsFromGridOptions(dN,"agDetailCellRenderer",t,!0)}function TE(e,t,i){return e.getCompDetails(t,ZO,void 0,i)}function AE(e,t,i){return e.getCompDetails(t,eN,"agSkeletonCellRenderer",i,!0)}function z6(e,t,i){return e.getCompDetails(t,tN,"agCellEditor",i,!0)}function wN(e,t,i,n){let o=t.filter;return G6(o)&&(t={filter:o.component,filterParams:t.filterParams}),e.getCompDetails(t,hv,n,i,!0)}function bN(e,t,i){return e.getCompDetails(t,jO,"agDateInput",i,!0)}function yN(e,t){return e.getCompDetailsFromGridOptions(iN,"agLoadingOverlay",t,!0)}function SN(e,t){return e.getCompDetailsFromGridOptions(nN,"agNoRowsOverlay",t,!0)}function xN(e,t){return e.getCompDetails(t.colDef,oN,"agTooltipComponent",t,!0)}function EN(e,t,i,n){return e.getCompDetails(t,sN,n,i)}function W6(e,t){return V6(e,t,hv)}function V0(e,t,i){return e.mergeParams(t,hv,i)}function ud(e){let t=e;return t?.getFrameworkComponentInstance!=null?t.getFrameworkComponentInstance():e}function RN(e){return typeof e=="object"&&!!e.getComp}var R={BACKSPACE:"Backspace",TAB:"Tab",ENTER:"Enter",ESCAPE:"Escape",SPACE:" ",LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown",DELETE:"Delete",F2:"F2",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",PAGE_HOME:"Home",PAGE_END:"End",A:"KeyA",C:"KeyC",D:"KeyD",V:"KeyV",X:"KeyX",Y:"KeyY",Z:"KeyZ"},pv=class extends wd{isPopup(){return!0}setParentComponent(e){e.addCss("ag-has-popup"),super.setParentComponent(e)}destroy(){let e=this.parentComponent;e?.isAlive()&&e.getGui().classList.remove("ag-has-popup"),super.destroy()}},z0,W0,U0,q0,kC,DC,$0;function es(){return z0===void 0&&(z0=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),z0}function U6(){return W0===void 0&&(W0=/(firefox)/i.test(navigator.userAgent)),W0}function q6(){return U0===void 0&&(U0=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),U0}function zs(){return q0===void 0&&(q0=/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1),q0}function FC(e){if(!e)return null;let t=e.tabIndex,i=e.getAttribute("tabIndex");return t===-1&&(i===null||i===""&&!U6())?null:t.toString()}function PN(){if($0!==void 0)return $0;if(!document.body)return-1;let e=1e6,t=U6()?6e6:1e9,i=document.createElement("div");for(document.body.appendChild(i);;){let n=e*2;if(i.style.height=n+"px",n>t||i.clientHeight!==n)break;e=n}return i.remove(),$0=e,e}function MN(){return DC==null&&$6(),DC}function $6(){let e=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",e.appendChild(t);let i=t.offsetWidth-t.clientWidth;i===0&&t.clientWidth===0&&(i=null),t.parentNode&&t.remove(),i!=null&&(DC=i,kC=i===0)}function j6(){return kC==null&&$6(),kC}var gv="T",kN=new RegExp(`[${gv} ]`),DN=new RegExp(`^\\d{4}-\\d{2}-\\d{2}(${gv}\\d{2}:\\d{2}:\\d{2}\\D?)?`);function yn(e,t){return e.toString().padStart(t,"0")}function Si(e,t=!0,i=gv){if(!e)return null;let n=[e.getFullYear(),e.getMonth()+1,e.getDate()].map(o=>yn(o,2)).join("-");return t&&(n+=i+[e.getHours(),e.getMinutes(),e.getSeconds()].map(o=>yn(o,2)).join(":")),n}function Oh(e,t=!0){return e?t?[String(e.getFullYear()),String(e.getMonth()+1),yn(e.getDate(),2),yn(e.getHours(),2),`:${yn(e.getMinutes(),2)}`,`:${yn(e.getSeconds(),2)}`]:[e.getFullYear(),e.getMonth()+1,yn(e.getDate(),2)].map(String):null}var j0=e=>{if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"},IE=["January","February","March","April","May","June","July","August","September","October","November","December"],K0=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function TC(e,t){if(t==null)return Si(e,!1);let i=yn(e.getFullYear(),4),n={YYYY:()=>i.slice(i.length-4,i.length),YY:()=>i.slice(i.length-2,i.length),Y:()=>`${e.getFullYear()}`,MMMM:()=>IE[e.getMonth()],MMM:()=>IE[e.getMonth()].slice(0,3),MM:()=>yn(e.getMonth()+1,2),Mo:()=>`${e.getMonth()+1}${j0(e.getMonth()+1)}`,M:()=>`${e.getMonth()+1}`,Do:()=>`${e.getDate()}${j0(e.getDate())}`,DD:()=>yn(e.getDate(),2),D:()=>`${e.getDate()}`,dddd:()=>K0[e.getDay()],ddd:()=>K0[e.getDay()].slice(0,3),dd:()=>K0[e.getDay()].slice(0,2),do:()=>`${e.getDay()}${j0(e.getDay())}`,d:()=>`${e.getDay()}`},o=new RegExp(Object.keys(n).join("|"),"g");return t.replace(o,s=>s in n?n[s]():s)}function Qh(e,t=!1){return!!pi(e,t)}function FN(e){return Qh(e,!0)}function pi(e,t=!1,i){if(!e||!i&&!DN.test(e))return null;let[n,o]=e.split(kN);if(!n)return null;let s=n.split("-").map(p=>Number.parseInt(p,10));if(s.filter(p=>!isNaN(p)).length!==3)return null;let[r,a,l]=s,d=new Date(r,a-1,l);if(d.getFullYear()!==r||d.getMonth()!==a-1||d.getDate()!==l||!o&&t)return null;if(!o||o==="00:00:00")return d;let[c,u,h]=o.split(":").map(p=>Number.parseInt(p,10));if(c>=0&&c<24)d.setHours(c);else if(t)return null;if(u>=0&&u<60)d.setMinutes(u);else if(t)return null;if(h>=0&&h<60)d.setSeconds(h);else if(t)return null;return d}function AC(e){let{inputValue:t,allSuggestions:i,hideIrrelevant:n,filterByPercentageOfBestMatch:o}=e,s=(i??[]).map((l,d)=>({value:l,relevance:TN(t,l),idx:d}));if(s.sort((l,d)=>l.relevance-d.relevance),n&&(s=s.filter(l=>l.relevance<Math.max(l.value.length,t.length))),s.length>0&&o&&o>0){let d=s[0].relevance*o;s=s.filter(c=>d-c.relevance<0)}let r=[],a=[];for(let l of s)r.push(l.value),a.push(l.idx);return{values:r,indices:a}}function TN(e,t){e.length<t.length&&([e,t]=[t,e]);let i=[],n=[],o=e.length,s=t.length;for(let a=0;a<=s;a++)i[a]=a;let r=0;for(let a=1;a<=o;a++){n[0]=a;for(let l=1;l<=s;l++){let d=e[a-1],c=t[l-1];if(d.toLocaleLowerCase()===c.toLocaleLowerCase())++r,d===c&&++r,a>1&&l>1&&e[a-2].toLocaleLowerCase()===t[l-2].toLocaleLowerCase()&&(++r,e[a-2]===t[l-2]&&++r),a<o/2-10&&++r,n[l]=i[l-1];else{let u=n[l-1],h=i[l],p=i[l-1];n[l]=1+Math.min(u,h,p)}}[i,n]=[n,i]}return i[s]/(r+1)}function K6(e){return e.altKey||e.ctrlKey||e.metaKey?!1:e.key?.length===1}var IC=!1,vp=0;function AN(e){vp>0||(e.addEventListener("keydown",wp),e.addEventListener("mousedown",wp))}function IN(e){vp>0||(e.removeEventListener("keydown",wp),e.removeEventListener("mousedown",wp))}function wp(e){let t=IC,i=e.type==="keydown";i&&(e.ctrlKey||e.metaKey||e.altKey)||t!==i&&(IC=i)}function LN(e){let t=kt(e);return AN(t),vp++,()=>{vp--,IN(t)}}function _N(){return IC}function ua(e,t,i=!1){let n=x_,o=jR;t&&(o+=", "+t),i&&(o+=', [tabindex="-1"]');let s=Array.prototype.slice.apply(e.querySelectorAll(n)).filter(l=>Pn(l)),r=Array.prototype.slice.apply(e.querySelectorAll(o));return r.length?((l,d)=>l.filter(c=>d.indexOf(c)===-1))(s,r):s}function js(e,t=!1,i=!1,n=!1){let o=ua(e,n?".ag-tab-guard":null,i),s=t?Ue(o):o[0];return s?(s.focus({preventScroll:!0}),!0):!1}function Qs(e,t,i,n){let o=ua(t,i?':not([tabindex="-1"])':null),s=tt(e),r;i?r=o.findIndex(l=>l.contains(s)):r=o.indexOf(s);let a=r+(n?-1:1);return a<0||a>=o.length?null:o[a]}function Y6(e,t=5){let i=0;for(;e&&FC(e)===null&&++i<=t;)e=e.parentElement;return FC(e)===null?null:e}var ON=".ag-label{white-space:nowrap}:where(.ag-ltr) .ag-label{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-label-align-right) .ag-label{order:1}:where(.ag-ltr) :where(.ag-label-align-right) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-rtl) :where(.ag-label-align-right) .ag-label{margin-right:var(--ag-spacing)}.ag-label-align-right>*{flex:none}.ag-label-align-top{align-items:flex-start;flex-direction:column;>*{align-self:stretch}}.ag-label-ellipsis{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:where(.ag-label-align-top) .ag-label{margin-bottom:calc(var(--ag-spacing)*.5)}",NN=class extends wd{constructor(e,t,i){super(t,i),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=e||{},this.registerCSS(ON)}postConstruct(){this.addCss("ag-labeled"),this.eLabel.classList.add("ag-label");let{labelSeparator:e,label:t,labelWidth:i,labelAlignment:n,disabled:o}=this.config;o!=null&&this.setDisabled(o),e!=null&&this.setLabelSeparator(e),t!=null&&this.setLabel(t),i!=null&&this.setLabelWidth(i),this.setLabelAlignment(n||this.labelAlignment),this.refreshLabel()}refreshLabel(){let{label:e,eLabel:t}=this;Ot(t),typeof e=="string"?t.innerText=e+this.labelSeparator:e&&t.appendChild(e),e===""?(Je(t,!1),jo(t,"presentation")):(Je(t,!0),jo(t,null))}setLabelSeparator(e){return this.labelSeparator===e?this:(this.labelSeparator=e,this.label!=null&&this.refreshLabel(),this)}getLabelId(){let e=this.eLabel;return e.id=e.id||`ag-${this.getCompId()}-label`,e.id}getLabel(){return this.label}setLabel(e){return this.label===e?this:(this.label=e,this.refreshLabel(),this)}setLabelAlignment(e){let i=this.getGui().classList;return i.toggle("ag-label-align-left",e==="left"),i.toggle("ag-label-align-right",e==="right"),i.toggle("ag-label-align-top",e==="top"),this}setLabelEllipsis(e){return this.eLabel.classList.toggle("ag-label-ellipsis",e),this}setLabelWidth(e){return this.label==null?this:(dp(this.eLabel,e),this)}setDisabled(e){e=!!e;let t=this.getGui();return sd(t,e),t.classList.toggle("ag-disabled",e),this.disabled=e,this}isDisabled(){return!!this.disabled}},X6=class extends NN{constructor(e,t,i,n){super(e,t,i),this.className=n}postConstruct(){super.postConstruct();let{width:e,value:t,onValueChange:i}=this.config;e!=null&&this.setWidth(e),t!=null&&this.setValue(t),i!=null&&this.onValueChange(i),this.className&&this.addCss(this.className),this.refreshAriaLabelledBy()}setLabel(e){return super.setLabel(e),this.refreshAriaLabelledBy(),this}refreshAriaLabelledBy(){let e=this.getAriaElement(),t=this.getLabelId(),i=this.getLabel();i==null||i==""||a_(e)!==null?od(e,""):od(e,t??"")}setAriaLabel(e){return ma(this.getAriaElement(),e),this.refreshAriaLabelledBy(),this}onValueChange(e){return this.addManagedListeners(this,{fieldValueChanged:()=>e(this.getValue())}),this}getWidth(){return this.getGui().clientWidth}setWidth(e){return xn(this.getGui(),e),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(e,t){return this.value===e?this:(this.previousValue=this.value,this.value=e,t||this.dispatchLocalEvent({type:"fieldValueChanged"}),this)}};function BN(e){return{tag:"div",role:"presentation",children:[{tag:"div",ref:"eLabel",cls:"ag-input-field-label"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-input-wrapper",role:"presentation",children:[{tag:e,ref:"eInput",cls:"ag-input-field-input"}]}]}}var Ns=class extends X6{constructor(e,t,i="text",n="input"){super(e,e?.template??BN(n),[],t),this.inputType=i,this.displayFieldTag=n,this.eLabel=V,this.eWrapper=V,this.eInput=V}postConstruct(){super.postConstruct(),this.setInputType(this.inputType);let{eLabel:e,eWrapper:t,eInput:i,className:n}=this;e.classList.add(`${n}-label`),t.classList.add(`${n}-input-wrapper`),i.classList.add(`${n}-input`),this.addCss("ag-input-field"),i.id=i.id||`ag-${this.getCompId()}-input`;let{inputName:o,inputWidth:s}=this.config;o!=null&&this.setInputName(o),s!=null&&this.setInputWidth(s),this.addInputListeners(),this.activateTabIndex([i])}addInputListeners(){this.addManagedElementListeners(this.eInput,{input:e=>this.setValue(e.target.value)})}setInputType(e){this.displayFieldTag==="input"&&(this.inputType=e,bi(this.eInput,"type",e))}getInputElement(){return this.eInput}setInputWidth(e){return dp(this.eWrapper,e),this}setInputName(e){return this.getInputElement().setAttribute("name",e),this}getFocusableElement(){return this.eInput}setMaxLength(e){let t=this.eInput;return t.maxLength=e,this}setInputPlaceholder(e){return bi(this.eInput,"placeholder",e),this}setInputAriaLabel(e){return ma(this.eInput,e),this.refreshAriaLabelledBy(),this}setDisabled(e){return sd(this.eInput,e),super.setDisabled(e)}setAutoComplete(e){if(e===!0)bi(this.eInput,"autocomplete",null);else{let t=typeof e=="string"?e:"off";bi(this.eInput,"autocomplete",t)}return this}},fv=class extends Ns{constructor(e,t="ag-checkbox",i="checkbox"){super(e,t,i),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}postConstruct(){super.postConstruct();let{readOnly:e,passive:t}=this.config;typeof e=="boolean"&&this.setReadOnly(e),typeof t=="boolean"&&this.setPassive(t)}addInputListeners(){this.addManagedElementListeners(this.eInput,{click:this.onCheckboxClick.bind(this)}),this.addManagedElementListeners(this.eLabel,{click:this.toggle.bind(this)})}getNextValue(){return this.selected===void 0?!0:!this.selected}setPassive(e){this.passive=e}isReadOnly(){return this.readOnly}setReadOnly(e){this.eWrapper.classList.toggle("ag-disabled",e),this.eInput.disabled=e,this.readOnly=e}setDisabled(e){return this.eWrapper.classList.toggle("ag-disabled",e),super.setDisabled(e)}toggle(){if(this.eInput.disabled)return;let e=this.isSelected(),t=this.getNextValue();this.passive?this.dispatchChange(t,e):this.setValue(t)}getValue(){return this.isSelected()}setValue(e,t){return this.refreshSelectedClass(e),this.setSelected(e,t),this}setName(e){let t=this.getInputElement();return t.name=e,this}isSelected(){return this.selected}setSelected(e,t){if(this.isSelected()===e)return;this.previousValue=this.isSelected(),e=this.selected=typeof e=="boolean"?e:void 0;let i=this.eInput;i.checked=e,i.indeterminate=e===void 0,t||this.dispatchChange(this.selected,this.previousValue)}dispatchChange(e,t,i){this.dispatchLocalEvent({type:"fieldValueChanged",selected:e,previousValue:t,event:i});let n=this.getInputElement();this.eventSvc.dispatchEvent({type:"checkboxChanged",id:n.id,name:n.name,selected:e,previousValue:t})}onCheckboxClick(e){if(this.passive||this.eInput.disabled)return;let t=this.isSelected(),i=this.selected=e.target.checked;this.refreshSelectedClass(i),this.dispatchChange(i,t,e)}refreshSelectedClass(e){let t=this.eWrapper.classList;t.toggle("ag-checked",e===!0),t.toggle("ag-indeterminate",e==null)}},mv={selector:"AG-CHECKBOX",component:fv},HN=class extends fv{constructor(e){super(e,"ag-radio-button","radio")}isSelected(){return this.eInput.checked}toggle(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}addInputListeners(){super.addInputListeners(),this.addManagedEventListeners({checkboxChanged:this.onChange.bind(this)})}onChange(e){let t=this.eInput;e.selected&&e.name&&t.name&&t.name===e.name&&e.id&&t.id!==e.id&&this.setValue(!1,!0)}};var Zs=class extends Ns{constructor(e,t="ag-text-field",i="text"){super(e,t,i)}postConstruct(){super.postConstruct(),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}setValue(e,t){let i=this.eInput;return i.value!==e&&(i.value=q(e)?e:""),super.setValue(e,t)}setStartValue(e){this.setValue(e,!0)}preventDisallowedCharacters(){let e=new RegExp(`[${this.config.allowedCharPattern}]`),t=i=>{K6(i)&&i.key&&!e.test(i.key)&&i.preventDefault()};this.addManagedListeners(this.eInput,{keydown:t,paste:i=>{i.clipboardData?.getData("text")?.split("").some(o=>!e.test(o))&&i.preventDefault()}})}},Fp={selector:"AG-INPUT-TEXT-FIELD",component:Zs},GN=class extends Ns{constructor(e){super(e,"ag-text-area",null,"textarea")}setValue(e,t){let i=super.setValue(e,t);return this.eInput.value=e,i}setCols(e){return this.eInput.cols=e,this}setRows(e){return this.eInput.rows=e,this}},VN={selector:"AG-INPUT-TEXT-AREA",component:GN},Cv=class extends Zs{constructor(e){super(e,"ag-number-field","number")}postConstruct(){super.postConstruct();let e=this.eInput;this.addManagedListeners(e,{blur:()=>{let s=Number.parseFloat(e.value),r=isNaN(s)?"":this.normalizeValue(s.toString());this.value!==r&&this.setValue(r)},wheel:this.onWheel.bind(this)}),e.step="any";let{precision:t,min:i,max:n,step:o}=this.config;typeof t=="number"&&this.setPrecision(t),typeof i=="number"&&this.setMin(i),typeof n=="number"&&this.setMax(n),typeof o=="number"&&this.setStep(o)}onWheel(e){tt(this.beans)===this.eInput&&e.preventDefault()}normalizeValue(e){return e===""?"":(this.precision!=null&&(e=this.adjustPrecision(e)),e)}adjustPrecision(e,t){let i=this.precision;if(i==null)return e;if(t){let o=Number.parseFloat(e).toFixed(i);return Number.parseFloat(o).toString()}let n=String(e).split(".");if(n.length>1){if(n[1].length<=i)return e;if(i>0)return`${n[0]}.${n[1].slice(0,i)}`}return n[0]}setMin(e){return this.min===e?this:(this.min=e,bi(this.eInput,"min",e),this)}setMax(e){return this.max===e?this:(this.max=e,bi(this.eInput,"max",e),this)}setPrecision(e){return this.precision=e,this}setStep(e){return this.step===e?this:(this.step=e,bi(this.eInput,"step",e),this)}setValue(e,t){return this.setValueOrInputValue(i=>super.setValue(i,t),()=>this,e)}setStartValue(e){return this.setValueOrInputValue(t=>super.setValue(t,!0),t=>{this.eInput.value=t},e)}setValueOrInputValue(e,t,i){if(q(i)){let n=this.isScientificNotation(i);if(n&&this.eInput.validity.valid)return e(i);if(!n){i=this.adjustPrecision(i);let o=this.normalizeValue(i);n=i!=o}if(n)return t(i)}return e(i)}getValue(){let e=this.eInput;if(!e.validity.valid)return;let t=e.value;return this.isScientificNotation(t)?this.adjustPrecision(t,!0):super.getValue()}isScientificNotation(e){return typeof e=="string"&&e.includes("e")}},zN={selector:"AG-INPUT-NUMBER-FIELD",component:Cv},WN=class extends Zs{constructor(e){super(e,"ag-date-field","date")}postConstruct(){super.postConstruct();let e=es();this.addManagedListeners(this.eInput,{wheel:this.onWheel.bind(this),mousedown:()=>{this.isDisabled()||e||this.eInput.focus()}}),this.eInput.step="any"}onWheel(e){tt(this.beans)===this.eInput&&e.preventDefault()}setMin(e){let t=e instanceof Date?Si(e??null,!!this.includeTime)??void 0:e;return this.min===t?this:(this.min=t,bi(this.eInput,"min",t),this)}setMax(e){let t=e instanceof Date?Si(e??null,!!this.includeTime)??void 0:e;return this.max===t?this:(this.max=t,bi(this.eInput,"max",t),this)}setStep(e){return this.step===e?this:(this.step=e,bi(this.eInput,"step",e),this)}setIncludeTime(e){return this.includeTime===e?this:(this.includeTime=e,super.setInputType(e?"datetime-local":"date"),e&&this.setStep(1),this)}getDate(){if(this.eInput.validity.valid)return pi(this.getValue())??void 0}setDate(e,t){this.setValue(Si(e??null,this.includeTime),t)}},J6={selector:"AG-INPUT-DATE-FIELD",component:WN},UN=".ag-list-item{align-items:center;display:flex;height:var(--ag-list-item-height);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;&.ag-active-item{background-color:var(--ag-row-hover-color)}}",qN="ag-active-item",$N=(e,t)=>({tag:"div",cls:`ag-list-item ag-${e}-list-item`,attrs:{role:"option"},children:[{tag:"span",ref:"eText",children:t}]}),jN=class extends wd{constructor(e,t,i){super($N(e,t)),this.label=t,this.value=i,this.eText=V}postConstruct(){this.createTooltip(),this.addEventListeners()}setHighlighted(e){let t=this.getGui();t.classList.toggle(qN,e),$R(t,e),this.dispatchLocalEvent({type:"itemHighlighted",highlighted:e})}getHeight(){return this.getGui().clientHeight}setIndex(e,t){let i=this.getGui();p_(i,e),h_(i,t)}createTooltip(){let e={getTooltipValue:()=>this.label,getGui:()=>this.getGui(),getLocation:()=>"UNKNOWN",shouldDisplayTooltip:()=>nv(this.eText)},t=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("highlightTooltipFeature",!1,e,this));t&&(this.tooltipFeature=t)}addEventListeners(){let e=this.getParentComponent();e&&(this.addGuiEventListener("mouseover",()=>{e.highlightItem(this)}),this.addGuiEventListener("mousedown",t=>{t.preventDefault(),t.stopPropagation(),e.setValue(this.value)}))}},KN=class extends wd{constructor(e="default"){super({tag:"div",cls:`ag-list ag-${e}-list`}),this.cssIdentifier=e,this.options=[],this.listItems=[],this.highlightedItem=null,this.registerCSS(UN)}postConstruct(){let e=this.getGui();this.addManagedElementListeners(e,{mouseleave:()=>this.clearHighlighted()})}handleKeyDown(e){let t=e.key;switch(t){case R.ENTER:if(!this.highlightedItem)this.setValue(this.getValue());else{let i=this.listItems.indexOf(this.highlightedItem);this.setValueByIndex(i)}break;case R.DOWN:case R.UP:e.preventDefault(),this.navigate(t);break;case R.PAGE_DOWN:case R.PAGE_UP:case R.PAGE_HOME:case R.PAGE_END:e.preventDefault(),this.navigateToPage(t);break}}addOptions(e){for(let t of e)this.addOption(t);return this}addOption(e){let{value:t,text:i}=e,n=i??t;return this.options.push({value:t,text:n}),this.renderOption(t,n),this.updateIndices(),this}clearOptions(){this.options=[],this.reset(!0);for(let e of this.listItems)e.destroy();Ot(this.getGui()),this.listItems=[],this.refreshAriaRole()}setValue(e,t){if(this.value===e)return this.fireItemSelected(),this;if(e==null)return this.reset(t),this;let i=this.options.findIndex(n=>n.value===e);if(i!==-1){let n=this.options[i];this.value=n.value,this.displayValue=n.text,this.highlightItem(this.listItems[i]),t||this.fireChangeEvent()}return this}setValueByIndex(e){return this.setValue(this.options[e].value)}getValue(){return this.value}getDisplayValue(){return this.displayValue}refreshHighlighted(){this.clearHighlighted();let e=this.options.findIndex(t=>t.value===this.value);e!==-1&&this.highlightItem(this.listItems[e])}highlightItem(e){let t=e.getGui();if(!Pn(t))return;this.clearHighlighted(),e.setHighlighted(!0),this.highlightedItem=e;let i=this.getGui(),{scrollTop:n,clientHeight:o}=i,{offsetTop:s,offsetHeight:r}=t;(s+r>n+o||s<n)&&t.scrollIntoView({block:"nearest"})}hideItemTooltip(){this.highlightedItem?.tooltipFeature?.attemptToHideTooltip()}destroy(){this.hideItemTooltip(),super.destroy()}reset(e){this.value=null,this.displayValue=null,this.clearHighlighted(),e||this.fireChangeEvent()}clearHighlighted(){this.highlightedItem?.setHighlighted(!1),this.highlightedItem=null}renderOption(e,t){let i=new jN(this.cssIdentifier,t,e);i.setParentComponent(this);let n=this.createManagedBean(i);this.listItems.push(n),this.getGui().appendChild(n.getGui())}navigate(e){let t=e===R.DOWN,i,{listItems:n,highlightedItem:o}=this;if(!o)i=t?n[0]:Ue(n);else{let r=n.indexOf(o)+(t?1:-1);r=Math.min(Math.max(r,0),n.length-1),i=n[r]}this.highlightItem(i)}navigateToPage(e){let{listItems:t,highlightedItem:i}=this;if(!i||t.length===0)return;let n=t.indexOf(i),o=this.options.length-1,s=t[0].getHeight(),r=Math.floor(this.getGui().clientHeight/s),a=-1;e===R.PAGE_HOME?a=0:e===R.PAGE_END?a=o:e===R.PAGE_DOWN?a=Math.min(n+r,o):e===R.PAGE_UP&&(a=Math.max(n-r,0)),a!==-1&&this.highlightItem(t[a])}refreshAriaRole(){jo(this.getGui(),this.options.length===0?"presentation":"listbox")}updateIndices(){this.refreshAriaRole();let e=this.listItems,t=e.length;e.forEach((i,n)=>{i.setIndex(n+1,t)})}fireChangeEvent(){this.dispatchLocalEvent({type:"fieldValueChanged"}),this.fireItemSelected()}fireItemSelected(){this.dispatchLocalEvent({type:"selectedItem"})}},YN=".ag-picker-field-display{flex:1 1 auto}.ag-picker-field{align-items:center;display:flex}.ag-picker-field-icon{border:0;cursor:pointer;display:flex;margin:0;padding:0}.ag-picker-field-wrapper{background-color:var(--ag-picker-button-background-color);border:var(--ag-picker-button-border);border-radius:5px;min-height:max(var(--ag-list-item-height),calc(var(--ag-spacing)*4));overflow:hidden;&:where(.ag-picker-has-focus),&:where(:focus-within){background-color:var(--ag-picker-button-focus-background-color);border:var(--ag-picker-button-focus-border);box-shadow:var(--ag-focus-shadow);&:where(.invalid){box-shadow:var(--ag-focus-error-shadow)}}&:where(.invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&:disabled{opacity:.5}}",XN={tag:"div",cls:"ag-picker-field",role:"presentation",children:[{tag:"div",ref:"eLabel"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-picker-field-wrapper ag-picker-collapsed",children:[{tag:"div",ref:"eDisplayField",cls:"ag-picker-field-display"},{tag:"div",ref:"eIcon",cls:"ag-picker-field-icon",attrs:{"aria-hidden":"true"}}]}]},JN=class extends X6{constructor(e){if(super(e,e?.template||XN,e?.agComponents||[],e?.className),this.isPickerDisplayed=!1,this.skipClick=!1,this.pickerGap=4,this.hideCurrentPicker=null,this.eLabel=V,this.eWrapper=V,this.eDisplayField=V,this.eIcon=V,this.registerCSS(YN),this.ariaRole=e?.ariaRole,this.onPickerFocusIn=this.onPickerFocusIn.bind(this),this.onPickerFocusOut=this.onPickerFocusOut.bind(this),!e)return;let{pickerGap:t,maxPickerHeight:i,variableWidth:n,minPickerWidth:o,maxPickerWidth:s}=e;t!=null&&(this.pickerGap=t),this.variableWidth=!!n,i!=null&&this.setPickerMaxHeight(i),o!=null&&this.setPickerMinWidth(o),s!=null&&this.setPickerMaxWidth(s)}postConstruct(){super.postConstruct(),this.setupAria();let e=`ag-${this.getCompId()}-display`;this.eDisplayField.setAttribute("id",e);let t=this.getAriaElement();this.addManagedElementListeners(t,{keydown:this.onKeyDown.bind(this)}),this.addManagedElementListeners(this.eLabel,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)}),this.addManagedElementListeners(this.eWrapper,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)});let{pickerIcon:i,inputWidth:n}=this.config;if(i){let o=this.beans.iconSvc.createIconNoSpan(i);o&&this.eIcon.appendChild(o)}n!=null&&this.setInputWidth(n)}setupAria(){let e=this.getAriaElement();e.setAttribute("tabindex",this.gos.get("tabIndex").toString()),bC(e,!1),this.ariaRole&&jo(e,this.ariaRole)}onLabelOrWrapperMouseDown(e){if(e){let t=this.getFocusableElement();if(t!==this.eWrapper&&e?.target===t)return;e.preventDefault(),this.getFocusableElement().focus()}if(this.skipClick){this.skipClick=!1;return}this.isDisabled()||(this.isPickerDisplayed?this.hidePicker():this.showPicker())}onKeyDown(e){switch(e.key){case R.UP:case R.DOWN:case R.ENTER:case R.SPACE:e.preventDefault(),this.onLabelOrWrapperMouseDown();break;case R.ESCAPE:this.isPickerDisplayed&&(e.preventDefault(),e.stopPropagation(),this.hideCurrentPicker&&this.hideCurrentPicker());break}}showPicker(){this.isPickerDisplayed=!0,this.pickerComponent||(this.pickerComponent=this.createPickerComponent());let e=this.pickerComponent.getGui();e.addEventListener("focusin",this.onPickerFocusIn),e.addEventListener("focusout",this.onPickerFocusOut),this.hideCurrentPicker=this.renderAndPositionPicker(),this.toggleExpandedStyles(!0)}renderAndPositionPicker(){let e=this.pickerComponent.getGui();this.gos.get("suppressScrollWhenPopupsAreOpen")||([this.destroyMouseWheelFunc]=this.addManagedEventListeners({bodyScroll:()=>{this.hidePicker()}}));let t=this.getLocaleTextFunc(),{config:{pickerAriaLabelKey:i,pickerAriaLabelValue:n,modalPicker:o=!0},maxPickerHeight:s,minPickerWidth:r,maxPickerWidth:a,variableWidth:l,beans:d,eWrapper:c}=this,u={modal:o,eChild:e,closeOnEsc:!0,closedCallback:()=>{let f=HR(d);this.beforeHidePicker(),f&&this.isAlive()&&this.getFocusableElement().focus()},ariaLabel:t(i,n),anchorToElement:c};e.style.position="absolute";let h=d.popupSvc,p=h.addPopup(u);l?(r&&(e.style.minWidth=r),e.style.width=ov(rp(c)),a&&(e.style.maxWidth=a)):dp(e,a??rp(c));let g=s??`${tv(h.getPopupParent())}px`;return e.style.setProperty("max-height",g),this.alignPickerToComponent(),p.hideFunc}alignPickerToComponent(){if(!this.pickerComponent)return;let{pickerGap:e,config:{pickerType:t},beans:{popupSvc:i,gos:n},eWrapper:o,pickerComponent:s}=this,r=n.get("enableRtl")?"right":"left";i.positionPopupByComponent({type:t,eventSource:o,ePopup:s.getGui(),position:"under",alignSide:r,keepWithinBounds:!0,nudgeY:e})}beforeHidePicker(){this.destroyMouseWheelFunc&&(this.destroyMouseWheelFunc(),this.destroyMouseWheelFunc=void 0),this.toggleExpandedStyles(!1);let e=this.pickerComponent.getGui();e.removeEventListener("focusin",this.onPickerFocusIn),e.removeEventListener("focusout",this.onPickerFocusOut),this.isPickerDisplayed=!1,this.pickerComponent=void 0,this.hideCurrentPicker=null}toggleExpandedStyles(e){if(!this.isAlive())return;let t=this.getAriaElement();bC(t,e);let i=this.eWrapper.classList;i.toggle("ag-picker-expanded",e),i.toggle("ag-picker-collapsed",!e)}onPickerFocusIn(){this.togglePickerHasFocus(!0)}onPickerFocusOut(e){this.pickerComponent?.getGui().contains(e.relatedTarget)||this.togglePickerHasFocus(!1)}togglePickerHasFocus(e){this.pickerComponent&&this.eWrapper.classList.toggle("ag-picker-has-focus",e)}hidePicker(){this.hideCurrentPicker&&(this.hideCurrentPicker(),this.dispatchLocalEvent({type:"pickerHidden"}))}setInputWidth(e){return dp(this.eWrapper,e),this}getFocusableElement(){return this.eWrapper}setPickerGap(e){return this.pickerGap=e,this}setPickerMinWidth(e){return typeof e=="number"&&(e=`${e}px`),this.minPickerWidth=e??void 0,this}setPickerMaxWidth(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerWidth=e??void 0,this}setPickerMaxHeight(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerHeight=e??void 0,this}destroy(){this.hidePicker(),super.destroy()}},QN=".ag-select{align-items:center;display:flex;&.ag-disabled{opacity:.5}}:where(.ag-select){.ag-picker-field-wrapper{cursor:default}&.ag-disabled .ag-picker-field-wrapper:focus{box-shadow:none}&:not(.ag-cell-editor,.ag-label-align-top){min-height:var(--ag-list-item-height)}.ag-picker-field-display{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ag-picker-field-icon{align-items:center;display:flex}}:where(.ag-ltr) :where(.ag-select){.ag-picker-field-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding)/2);padding-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-select){.ag-picker-field-wrapper{padding-left:var(--ag-spacing);padding-right:calc(var(--ag-cell-horizontal-padding)/2)}}.ag-select-list{background-color:var(--ag-picker-list-background-color);border:var(--ag-picker-list-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);overflow:hidden auto}.ag-select-list-item{cursor:default;-webkit-user-select:none;-moz-user-select:none;user-select:none;:where(span){overflow:hidden;text-overflow:ellipsis;white-space:nowrap}}:where(.ag-ltr) .ag-select-list-item{padding-left:calc(var(--ag-cell-horizontal-padding)/2)}:where(.ag-rtl) .ag-select-list-item{padding-right:calc(var(--ag-cell-horizontal-padding)/2)}",vv=class extends JN{constructor(e){super(b({pickerAriaLabelKey:"ariaLabelSelectField",pickerAriaLabelValue:"Select Field",pickerType:"ag-list",className:"ag-select",pickerIcon:"selectOpen",ariaRole:"combobox"},e)),this.registerCSS(QN)}postConstruct(){this.tooltipFeature=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{shouldDisplayTooltip:jh(()=>this.eDisplayField),getGui:()=>this.getGui()})),super.postConstruct(),this.createListComponent(),this.eWrapper.tabIndex=this.gos.get("tabIndex");let{options:e,value:t,placeholder:i}=this.config;e!=null&&this.addOptions(e),t!=null&&this.setValue(t,!0),i&&t==null&&(this.eDisplayField.textContent=i),this.addManagedElementListeners(this.eWrapper,{focusout:this.onWrapperFocusOut.bind(this)})}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}createListComponent(){let e=this.createBean(new KN("select"));this.listComponent=e,e.setParentComponent(this);let t=e.getAriaElement(),i=`ag-select-list-${e.getCompId()}`;t.setAttribute("id",i),S_(this.getAriaElement(),t),e.addManagedElementListeners(e.getGui(),{mousedown:n=>{n?.preventDefault()}}),e.addManagedListeners(e,{selectedItem:()=>{this.hidePicker(),this.dispatchLocalEvent({type:"selectedItem"})},fieldValueChanged:()=>{this.listComponent&&(this.setValue(this.listComponent.getValue(),!1,!0),this.hidePicker())}})}createPickerComponent(){return this.listComponent}beforeHidePicker(){this.listComponent?.hideItemTooltip(),super.beforeHidePicker()}onKeyDown(e){let{key:t}=e;switch(t===R.TAB&&this.hidePicker(),t){case R.ENTER:case R.UP:case R.DOWN:case R.PAGE_UP:case R.PAGE_DOWN:case R.PAGE_HOME:case R.PAGE_END:e.preventDefault(),this.isPickerDisplayed?this.listComponent?.handleKeyDown(e):super.onKeyDown(e);break;case R.ESCAPE:super.onKeyDown(e);break;case R.SPACE:this.isPickerDisplayed?e.preventDefault():super.onKeyDown(e);break}}showPicker(){let e=this.listComponent;e&&(super.showPicker(),e.refreshHighlighted())}addOptions(e){for(let t of e)this.addOption(t);return this}addOption(e){return this.listComponent.addOption(e),this}clearOptions(){return this.listComponent?.clearOptions(),this.setValue(void 0,!0),this}setValue(e,t,i){let{listComponent:n,config:{placeholder:o},eDisplayField:s,tooltipFeature:r}=this;if(this.value===e||!n)return this;if(i||n.setValue(e,!0),n.getValue()===this.getValue())return this;let l=n.getDisplayValue();return l==null&&o&&(l=o),s.textContent=l,r?.setTooltipAndRefresh(l??null),super.setValue(e,t)}destroy(){this.listComponent=this.destroyBean(this.listComponent),super.destroy()}},ZN={selector:"AG-SELECT",component:vv};var eB=':where(.ag-root-wrapper,.ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart),:where(.ag-root-wrapper,.ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]){box-sizing:border-box;&:after,&:before{box-sizing:border-box}&:where(div,span,label):focus-visible{box-shadow:inset var(--ag-focus-shadow);outline:none;&:where(.invalid){box-shadow:inset var(--ag-focus-error-shadow)}}&:where(button){color:inherit}}:where(.ag-root-wrapper,ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]) ::-ms-clear{display:none}.ag-hidden{display:none!important}.ag-invisible{visibility:hidden!important}.ag-popup-child{top:0;z-index:5;&:where(:not(.ag-tooltip-custom)){box-shadow:var(--ag-popup-shadow)}}.ag-input-wrapper,.ag-picker-field-wrapper{align-items:center;display:flex;flex:1 1 auto;line-height:normal;position:relative}.ag-input-field{align-items:center;display:flex;flex-direction:row}.ag-input-field-input:where(:not([type=checkbox],[type=radio])){flex:1 1 auto;min-width:0;width:100%}.ag-chart,.ag-dnd-ghost,.ag-external,.ag-popup,.ag-root-wrapper{cursor:default;line-height:normal;white-space:normal;-webkit-font-smoothing:antialiased;background-color:var(--ag-background-color);color:var(--ag-text-color);color-scheme:var(--ag-browser-color-scheme);font-family:var(--ag-font-family);font-size:var(--ag-font-size);--ag-indentation-level:0}:where(.ag-icon):before{align-items:center;background-color:currentcolor;color:inherit;content:"";display:flex;font-family:inherit;font-size:var(--ag-icon-size);font-style:normal;font-variant:normal;height:var(--ag-icon-size);justify-content:center;line-height:var(--ag-icon-size);-webkit-mask-size:contain;mask-size:contain;text-transform:none;width:var(--ag-icon-size)}.ag-icon{background-position:50%;background-repeat:no-repeat;background-size:contain;color:var(--ag-icon-color);display:block;height:var(--ag-icon-size);position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:var(--ag-icon-size)}.ag-disabled,[disabled]{.ag-icon{opacity:.5}&.ag-icon-grip{opacity:.35}}.ag-resizer{pointer-events:none;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none;z-index:1}:where(.ag-resizer){&.ag-resizer-topLeft{cursor:nwse-resize;height:5px;left:0;top:0;width:5px}&.ag-resizer-top{cursor:ns-resize;height:5px;left:5px;right:5px;top:0}&.ag-resizer-topRight{cursor:nesw-resize;height:5px;right:0;top:0;width:5px}&.ag-resizer-right{bottom:5px;cursor:ew-resize;right:0;top:5px;width:5px}&.ag-resizer-bottomRight{bottom:0;cursor:nwse-resize;height:5px;right:0;width:5px}&.ag-resizer-bottom{bottom:0;cursor:ns-resize;height:5px;left:5px;right:5px}&.ag-resizer-bottomLeft{bottom:0;cursor:nesw-resize;height:5px;left:0;width:5px}&.ag-resizer-left{bottom:5px;cursor:ew-resize;left:0;top:5px;width:5px}}',wv=typeof window!="object"||!window?.document?.fonts?.forEach,LC=!1,wa=(e,t,i,n,o,s)=>{if(wv||LC)return;n&&(e=`@layer ${CSS.escape(n)} { ${e} }`);let r=ha.map.get(t);if(r||(r=[],ha.map.set(t,r)),r.some(c=>c.css===e))return;let a=document.createElement("style");s&&a.setAttribute("nonce",s),a.dataset.agGlobalCss=i,a.textContent=e;let l={css:e,el:a,priority:o},d;for(let c of r){if(c.priority>o)break;d=c}if(d){d.el.insertAdjacentElement("afterend",a);let c=r.indexOf(d);r.splice(c+1,0,l)}else t.insertBefore(a,t.querySelector(":not(title, meta)")),r.push(l)},Q6=(e,t,i,n)=>{wa(eB,e,"shared",t,0,i),n?.forEach((o,s)=>o.forEach(r=>wa(r,e,s,t,0,i)))},tB=e=>{ha.grids.add(e)},iB=e=>{if(ha.grids.delete(e),ha.grids.size===0){ha.map=new WeakMap;for(let t of document.head.querySelectorAll("style[data-ag-global-css]"))t.remove()}},LE,ha=(LE=typeof window=="object"?window:{}).agStyleInjectionState??(LE.agStyleInjectionState={map:new WeakMap,grids:new Set}),xi=e=>new Z6(e),qo="$default",nB=0,Z6=class{constructor({feature:e,params:t,modeParams:i={},css:n,cssImports:o}){this.feature=e,this.css=n,this.cssImports=o,this.modeParams=b({[qo]:b(b({},i[qo]??{}),t??{})},i)}use(e,t,i){let n=this._inject;if(n==null){let{css:o}=this;if(o){let s=`ag-theme-${this.feature??"part"}-${++nB}`;typeof o=="function"&&(o=o()),o=`:where(.${s}) {
${o}
}
`;for(let r of this.cssImports??[])o=`@import url(${JSON.stringify(r)});
${o}`;n={css:o,class:s}}else n=!1;this._inject=n}return n&&e&&wa(n.css,e,n.class,t,1,i),n?n.class:!1}},oB=e=>e.replace(/[A-Z]/g,t=>`-${t}`).toLowerCase(),e4=e=>`--ag-${oB(e)}`,Rn=e=>`var(${e4(e)})`,sB=(e,t,i)=>Math.max(t,Math.min(i,e)),rB=e=>{let t=new Map;return i=>{let n=i;return t.has(n)||t.set(n,e(i)),t.get(n)}},wi=e=>({ref:"accentColor",mix:e}),_i=e=>({ref:"foregroundColor",mix:e}),Xt=e=>({ref:"foregroundColor",mix:e,onto:"backgroundColor"}),aB=e=>({ref:"foregroundColor",mix:e,onto:"headerBackgroundColor"}),Jt={ref:"backgroundColor"},ta={ref:"foregroundColor"},xt={ref:"accentColor"},bp={backgroundColor:"#fff",foregroundColor:"#181d1f",borderColor:_i(.15),chromeBackgroundColor:Xt(.02),browserColorScheme:"light"},lB=_(b({},bp),{textColor:ta,accentColor:"#2196f3",invalidColor:"#e02525",fontFamily:["-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu","Cantarell","Helvetica Neue","sans-serif"],subtleTextColor:{ref:"textColor",mix:.5},borderWidth:1,borderRadius:4,spacing:8,fontSize:14,focusShadow:{spread:3,color:wi(.5)},focusErrorShadow:{spread:3,color:{ref:"invalidColor",onto:"backgroundColor",mix:.5}},popupShadow:"0 0 16px #00000026",cardShadow:"0 1px 4px 1px #00000018",dropdownShadow:{ref:"cardShadow"},listItemHeight:{calc:"max(iconSize, dataFontSize) + widgetVerticalSpacing"},dragAndDropImageBackgroundColor:Jt,dragAndDropImageBorder:!0,dragAndDropImageNotAllowedBorder:{color:{ref:"invalidColor",onto:"dragAndDropImageBackgroundColor",mix:.5}},dragAndDropImageShadow:{ref:"popupShadow"},iconSize:16,iconColor:"inherit",toggleButtonWidth:28,toggleButtonHeight:18,toggleButtonOnBackgroundColor:xt,toggleButtonOffBackgroundColor:Xt(.3),toggleButtonSwitchBackgroundColor:Jt,toggleButtonSwitchInset:2,tooltipBackgroundColor:{ref:"chromeBackgroundColor"},tooltipErrorBackgroundColor:{ref:"invalidColor",onto:"backgroundColor",mix:.1},tooltipTextColor:{ref:"textColor"},tooltipErrorTextColor:{ref:"invalidColor"},tooltipBorder:!0,tooltipErrorBorder:{color:{ref:"invalidColor",onto:"backgroundColor",mix:.25}}}),dB=["colorScheme","color","length","scale","borderStyle","border","shadow","image","fontFamily","fontWeight","duration"],cB=rB(e=>(e=e.toLowerCase(),dB.find(t=>e.endsWith(t.toLowerCase()))??"length")),Tp=e=>typeof e=="object"&&e?.ref?Rn(e.ref):typeof e=="string"?e:typeof e=="number"?String(e):!1,bv=e=>{if(typeof e=="string")return e;if(e&&"ref"in e){let t=Rn(e.ref);return e.mix==null?t:`color-mix(in srgb, ${e.onto?Rn(e.onto):"transparent"}, ${t} ${sB(e.mix*100,0,100)}%)`}return!1},uB=Tp,ia=e=>typeof e=="string"?e:typeof e=="number"?`${e}px`:e&&"calc"in e?`calc(${e.calc.replace(/ ?[*/+] ?/g," $& ").replace(/-?\b[a-z][a-z0-9]*\b(?![-(])/gi,i=>i[0]==="-"?i:" "+Rn(i)+" ")})`:e&&"ref"in e?Rn(e.ref):!1,hB=Tp,_C=(e,t)=>typeof e=="string"?e:e===!0?_C({},t):e===!1?t==="columnBorder"?_C({color:"transparent"},t):"none":e&&"ref"in e?Rn(e.ref):t4(e.style??"solid")+" "+ia(e.width??{ref:"borderWidth"})+" "+bv(e.color??{ref:"borderColor"}),pB=e=>typeof e=="string"?e:e===!1?"none":e&&"ref"in e?Rn(e.ref):[ia(e.offsetX??0),ia(e.offsetY??0),ia(e.radius??0),ia(e.spread??0),bv(e.color??{ref:"foregroundColor"})].join(" "),t4=Tp,i4=e=>typeof e=="string"?e.includes(",")?e:_E(e):e&&"googleFont"in e?i4(e.googleFont):e&&"ref"in e?Rn(e.ref):Array.isArray(e)?e.map(t=>(typeof t=="object"&&"googleFont"in t&&(t=t.googleFont),_E(t))).join(", "):!1,_E=e=>/^[\w-]+$|\w\(/.test(e)?e:JSON.stringify(e),gB=Tp,n4=e=>typeof e=="string"?e:e&&"url"in e?`url(${JSON.stringify(e.url)})`:e&&"svg"in e?n4({url:`data:image/svg+xml,${encodeURIComponent(e.svg)}`}):e&&"ref"in e?Rn(e.ref):!1,fB=(e,t,i)=>typeof e=="string"?e:typeof e=="number"?(e>=10&&i.warn(104,{value:e,param:t}),`${e}s`):e&&"ref"in e?Rn(e.ref):!1,mB={color:bv,colorScheme:uB,length:ia,scale:hB,border:_C,borderStyle:t4,shadow:pB,image:n4,fontFamily:i4,fontWeight:gB,duration:fB},CB=(e,t,i)=>{let n=cB(e);return mB[n](t,e,i)};var vB=e=>new o4(e),o4=class s4{constructor(t,i=[]){this.themeLogger=t,this.parts=i}withPart(t){return typeof t=="function"&&(t=t()),t instanceof Z6?new s4(this.themeLogger,[...this.parts,t]):(this.themeLogger.preInitErr(259,"Invalid part",{part:t}),this)}withoutPart(t){return this.withPart(xi({feature:t}))}withParams(t,i=qo){return this.withPart(xi({modeParams:{[i]:t}}))}_startUse({styleContainer:t,cssLayer:i,nonce:n,loadThemeGoogleFonts:o,moduleCss:s}){if(wv||LC)return;bB(),Q6(t,i,n,s);let r=wB(this);if(r.length>0)for(let a of r)o&&yB(a,n);for(let a of this.parts)a.use(t,i,n)}_getCssClass(){return LC?"ag-theme-quartz":this._cssClassCache??(this._cssClassCache=OE(this.parts).map(t=>t.use(void 0,void 0,void 0)).filter(Boolean).join(" "))}_getModeParams(){let t=this._paramsCache;if(!t){let i={[qo]:b({},lB)};for(let n of OE(this.parts))for(let o of Object.keys(n.modeParams)){let s=n.modeParams[o];if(s){let r=i[o]??(i[o]={}),a=new Set;for(let l of Object.keys(s)){let d=s[l];d!==void 0&&(r[l]=d,a.add(l))}if(o===qo)for(let l of Object.keys(i)){let d=i[l];if(l!==qo)for(let c of a)delete d[c]}}}this._paramsCache=t=i}return t}_getPerInstanceCss(t){let i="##SELECTOR##",n=this._paramsCssCache;if(!n){let o="",s="",r=this._getModeParams();for(let l of Object.keys(r)){let d=r[l];if(l!==qo){let u=`:where([data-ag-theme-mode="${typeof CSS=="object"?CSS.escape(l):l}"]) & {
`;o+=u,s+=u}for(let c of Object.keys(d).sort()){let u=d[c],h=CB(c,u,this.themeLogger);if(h===!1)this.themeLogger.error(107,{key:c,value:u});else{let p=e4(c),g=p.replace("--ag-","--ag-inherited-");o+=`	${p}: var(${g}, ${h});
`,s+=`	${g}: var(${p});
`}}l!==qo&&(o+=`}
`,s+=`}
`)}let a=`${i} {
${o}}
`;a+=`:has(> ${i}):not(${i}) {
${s}}
`,this._paramsCssCache=n=a}return n.replaceAll(i,`:where(.${t})`)}},OE=e=>{let t=new Map;for(let n of e)t.set(n.feature,n);let i=[];for(let n of e)(!n.feature||t.get(n.feature)===n)&&i.push(n);return i},wB=e=>{let t=new Set,i=s=>{if(Array.isArray(s))s.forEach(i);else{let r=s?.googleFont;typeof r=="string"&&t.add(r)}};return Object.values(e._getModeParams()).flatMap(s=>Object.values(s)).forEach(i),Array.from(t).sort()},NE=!1,bB=()=>{if(!NE){NE=!0;for(let e of Array.from(document.head.querySelectorAll('style[data-ag-scope="legacy"]')))e.remove()}},yB=async(e,t)=>{let i=`@import url('https://${SB}/css2?family=${encodeURIComponent(e)}:wght@100;200;300;400;500;600;700;800;900&display=swap');
`;wa(i,document.head,`googleFont:${e}`,void 0,0,t)},SB="fonts.googleapis.com",xB=1,EB=class{constructor(e){this.beans={},this.createdBeans=[],this.destroyed=!1,this.instanceId=xB++,e?.beanClasses&&(this.beanDestroyComparator=e.beanDestroyComparator,this.init(e))}init(e){this.id=e.id,this.beans.context=this,this.destroyCallback=e.destroyCallback;for(let t of Object.keys(e.providedBeanInstances))this.beans[t]=e.providedBeanInstances[t];for(let t of e.beanClasses){let i=new t;i.beanName?this.beans[i.beanName]=i:console.error(`Bean ${t.name} is missing beanName`),this.createdBeans.push(i)}for(let t of e.derivedBeans??[]){let{beanName:i,bean:n}=t(this);this.beans[i]=n,this.createdBeans.push(n)}e.beanInitComparator&&this.createdBeans.sort(e.beanInitComparator),this.initBeans(this.createdBeans)}getBeanInstances(){return Object.values(this.beans)}createBean(e,t){return this.initBeans([e],t),e}initBeans(e,t){let i=this.beans;for(let n of e)n.preWireBeans?.(i),n.wireBeans?.(i);for(let n of e)n.preConstruct?.();t&&e.forEach(t);for(let n of e)n.postConstruct?.()}getBeans(){return this.beans}getBean(e){return this.beans[e]}getId(){return this.id}destroy(){if(this.destroyed)return;this.destroyed=!0;let e=this.getBeanInstances();this.beanDestroyComparator&&e.sort(this.beanDestroyComparator),this.destroyBeans(e),this.beans={},this.createdBeans=[],this.destroyCallback?.()}destroyBean(e){e?.destroy?.()}destroyBeans(e){if(e)for(let t=0;t<e.length;t++)this.destroyBean(e[t]);return[]}isDestroyed(){return this.destroyed}},RB=0,PB=class extends Mn{constructor(){super(...arguments),this.beanName="environment",this.paramsClass=`ag-theme-params-${++RB}`,this.globalCSS=[]}wireBeans(e){this.eRootDiv=e.eRootDiv}postConstruct(){let{gos:e,eRootDiv:t}=this;e.setInstanceDomData(t),this.eStyleContainer=e.get("themeStyleContainer")??(t.getRootNode()===document?document.head:t),this.cssLayer=e.get("themeCssLayer"),this.styleNonce=e.get("styleNonce"),this.addManagedPropertyListener("theme",()=>this.handleThemeChange()),this.handleThemeChange(),this.initVariables(),this.addDestroyFunc(()=>iB(this)),this.mutationObserver=new MutationObserver(()=>{this.fireStylesChangedEvent("themeChanged")}),this.addDestroyFunc(()=>this.mutationObserver.disconnect())}applyThemeClasses(e,t=[]){let{theme:i}=this,n;i?n=`${this.paramsClass} ${i._getCssClass()}`:n=this.applyLegacyThemeClasses();for(let o of Array.from(e.classList))o.startsWith("ag-theme-")&&e.classList.remove(o);if(n){let o=e.className;e.className=`${o}${o?" ":""}${n}${t?.length?" "+t.join(" "):""}`}}applyLegacyThemeClasses(){let e="";this.mutationObserver.disconnect();let t=this.eRootDiv;for(;t;){let i=!1;for(let n of Array.from(t.classList))n.startsWith("ag-theme-")&&(i=!0,e=e?`${e} ${n}`:n);i&&this.mutationObserver.observe(t,{attributes:!0,attributeFilter:["class"]}),t=t.parentElement}return e}addGlobalCSS(e,t){this.theme?wa(e,this.eStyleContainer,t,this.cssLayer,0,this.styleNonce):this.globalCSS.push([e,t])}handleThemeChange(){let{gos:e,theme:t}=this,i=e.get("theme"),n;if(i==="legacy")n=void 0;else{let o=i??this.getDefaultTheme();o instanceof o4?n=o:this.themeError(o)}n!==t&&this.handleNewTheme(n),this.postProcessThemeChange(n,i)}handleNewTheme(e){let{gos:t,eRootDiv:i,globalCSS:n}=this,o=this.getAdditionalCss();if(e){tB(this),Q6(this.eStyleContainer,this.cssLayer,this.styleNonce,o);for(let[r,a]of n)wa(r,this.eStyleContainer,a,this.cssLayer,0,this.styleNonce);n.length=0}this.theme=e,e?._startUse({loadThemeGoogleFonts:t.get("loadThemeGoogleFonts"),styleContainer:this.eStyleContainer,cssLayer:this.cssLayer,nonce:this.styleNonce,moduleCss:o});let s=this.eParamsStyle;if(!s){s=this.eParamsStyle=Cd({tag:"style"});let r=t.get("styleNonce");r&&s.setAttribute("nonce",r),i.appendChild(s)}wv||(s.textContent=e?._getPerInstanceCss(this.paramsClass)||""),this.applyThemeClasses(i),this.fireStylesChangedEvent("themeChanged")}},MB=class extends Mn{constructor(){super(...arguments),this.beanName="registry"}registerDynamicBeans(e){if(e){this.dynamicBeans??(this.dynamicBeans={});for(let t of Object.keys(e))this.dynamicBeans[t]=e[t]}}createDynamicBean(e,t,...i){if(!this.dynamicBeans)throw new Error(this.getDynamicError(e,!0));let n=this.dynamicBeans[e];if(n==null){if(t)throw new Error(this.getDynamicError(e,!1));return}return new n(...i)}},kB=class extends Mn{constructor(){super(...arguments),this.beanName="eventSvc",this.eventServiceType="global",this.globalSvc=new qs}addListener(e,t,i){this.globalSvc.addEventListener(e,t,i)}removeListener(e,t,i){this.globalSvc.removeEventListener(e,t,i)}addGlobalListener(e,t=!1){this.globalSvc.addGlobalListener(e,t)}removeGlobalListener(e,t=!1){this.globalSvc.removeGlobalListener(e,t)}dispatchEvent(e){this.globalSvc.dispatchEvent(this.gos.addCommon(e))}dispatchEventOnce(e){this.globalSvc.dispatchEventOnce(this.gos.addCommon(e))}},r4=class extends Mn{constructor(e,t){super(),this.ctrl=e,t&&(this.beans=t)}postConstruct(){this.refreshTooltip()}setBrowserTooltip(e,t){let i="title",n=this.ctrl.getGui();n&&(e!=null&&(e!=""||t)?n.setAttribute(i,e):n.removeAttribute(i))}updateTooltipText(){let{getTooltipValue:e}=this.ctrl;e&&(this.tooltip=e())}createTooltipFeatureIfNeeded(){if(this.tooltipManager==null){let e=this.beans.registry.createDynamicBean("tooltipStateManager",!0,this.ctrl,()=>this.tooltip);e&&(this.tooltipManager=this.createBean(e,this.beans.context))}}attemptToShowTooltip(){this.tooltipManager?.prepareToShowTooltip()}attemptToHideTooltip(){this.tooltipManager?.hideTooltip()}setTooltipAndRefresh(e){this.tooltip=e,this.refreshTooltip()}refreshTooltip(e){this.browserTooltips=this.beans.gos.get("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?(this.setBrowserTooltip(this.tooltip),this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context)):(this.setBrowserTooltip(e?"":null,e),this.createTooltipFeatureIfNeeded())}destroy(){this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context),super.destroy()}},DB=1e3,FB=1e3,BE=100,HE,Nh=!1,TB=class extends Mn{constructor(e,t){super(),this.tooltipCtrl=e,this.getTooltipValue=t,this.interactionEnabled=!1,this.isInteractingWithTooltip=!1,this.state=0,this.tooltipInstanceCount=0,this.tooltipMouseTrack=!1}wireBeans(e){this.popupSvc=e.popupSvc}postConstruct(){this.gos.get("tooltipInteraction")&&(this.interactionEnabled=!0),this.tooltipTrigger=this.getTooltipTrigger(),this.tooltipMouseTrack=this.gos.get("tooltipMouseTrack");let e=this.tooltipCtrl.getGui();this.tooltipTrigger===0&&this.addManagedListeners(e,{mouseenter:this.onMouseEnter.bind(this),mouseleave:this.onMouseLeave.bind(this)}),this.tooltipTrigger===1&&this.addManagedListeners(e,{focusin:this.onFocusIn.bind(this),focusout:this.onFocusOut.bind(this)}),this.addManagedListeners(e,{mousemove:this.onMouseMove.bind(this)}),this.interactionEnabled||this.addManagedListeners(e,{mousedown:this.onMouseDown.bind(this),keydown:this.onKeyDown.bind(this)})}getGridOptionsTooltipDelay(e){let t=this.gos.get(e);return Math.max(200,t)}getTooltipDelay(e){return e==="show"?this.tooltipCtrl.getTooltipShowDelayOverride?.()??this.getGridOptionsTooltipDelay("tooltipShowDelay"):this.tooltipCtrl.getTooltipHideDelayOverride?.()??this.getGridOptionsTooltipDelay("tooltipHideDelay")}destroy(){this.setToDoNothing(),super.destroy()}getTooltipTrigger(){let e=this.gos.get("tooltipTrigger");return!e||e==="hover"?0:1}onMouseEnter(e){this.interactionEnabled&&this.interactiveTooltipTimeoutId&&(this.unlockService(),this.startHideTimeout()),!zs()&&(Nh?this.showTooltipTimeoutId=window.setTimeout(()=>{this.prepareToShowTooltip(e)},BE):this.prepareToShowTooltip(e))}onMouseMove(e){this.lastMouseEvent&&(this.lastMouseEvent=e),this.tooltipMouseTrack&&this.state===2&&this.tooltipComp&&this.positionTooltip()}onMouseDown(){this.setToDoNothing()}onMouseLeave(){this.interactionEnabled?this.lockService():this.setToDoNothing()}onFocusIn(){this.prepareToShowTooltip()}onFocusOut(e){let t=e.relatedTarget,i=this.tooltipCtrl.getGui(),n=this.tooltipComp?.getGui();this.isInteractingWithTooltip||i.contains(t)||this.interactionEnabled&&n?.contains(t)||this.setToDoNothing()}onKeyDown(){this.isInteractingWithTooltip&&(this.isInteractingWithTooltip=!1),this.setToDoNothing()}prepareToShowTooltip(e){if(this.state!=0||Nh)return;let t=0;e&&(t=this.isLastTooltipHiddenRecently()?200:this.getTooltipDelay("show")),this.lastMouseEvent=e||null,this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),t),this.state=1}isLastTooltipHiddenRecently(){return Date.now()-HE<DB}setToDoNothing(e){!e&&this.state===2&&this.hideTooltip(),this.onBodyScrollEventCallback&&(this.onBodyScrollEventCallback(),this.onBodyScrollEventCallback=void 0),this.clearEventHandlers(),this.onDocumentKeyDownCallback&&(this.onDocumentKeyDownCallback(),this.onDocumentKeyDownCallback=void 0),this.clearTimeouts(),this.state=0,this.lastMouseEvent=null}showTooltip(){let e=this.getTooltipValue(),t=this.tooltipCtrl;if(!q(e)||t.shouldDisplayTooltip&&!t.shouldDisplayTooltip()){this.setToDoNothing();return}let i=this.gos.addCommon(b({location:t.getLocation?.()??"UNKNOWN",value:e,hideTooltipCallback:()=>this.hideTooltip(!0)},t.getAdditionalParams?.()));this.state=2,this.tooltipInstanceCount++;let n=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.createTooltipComp(i,n)}hideTooltip(e){!e&&this.isInteractingWithTooltip||(this.tooltipComp&&(this.destroyTooltipComp(),HE=Date.now()),this.eventSvc.dispatchEvent({type:"tooltipHide",parentGui:this.tooltipCtrl.getGui()}),e&&(this.isInteractingWithTooltip=!1),this.setToDoNothing(!0))}newTooltipComponentCallback(e,t){if(this.state!==2||this.tooltipInstanceCount!==e){this.destroyBean(t);return}let n=t.getGui();this.tooltipComp=t,n.classList.contains("ag-tooltip")||n.classList.add("ag-tooltip-custom"),this.tooltipTrigger===0&&n.classList.add("ag-tooltip-animate"),this.interactionEnabled&&n.classList.add("ag-tooltip-interactive");let o=this.getLocaleTextFunc(),s=this.popupSvc?.addPopup({eChild:n,ariaLabel:o("ariaLabelTooltip","Tooltip")});if(s&&(this.tooltipPopupDestroyFunc=s.hideFunc),this.positionTooltip(),this.tooltipTrigger===1){let r=()=>this.setToDoNothing();[this.onBodyScrollEventCallback]=this.addManagedEventListeners({bodyScroll:r}),this.setEventHandlers(r)}this.interactionEnabled&&([this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener]=this.addManagedElementListeners(n,{mouseenter:this.onTooltipMouseEnter.bind(this),mouseleave:this.onTooltipMouseLeave.bind(this)}),[this.onDocumentKeyDownCallback]=this.addManagedElementListeners(kt(this.beans),{keydown:r=>{n.contains(r?.target)||this.onKeyDown()}}),this.tooltipTrigger===1&&([this.tooltipFocusInListener,this.tooltipFocusOutListener]=this.addManagedElementListeners(n,{focusin:this.onTooltipFocusIn.bind(this),focusout:this.onTooltipFocusOut.bind(this)}))),this.eventSvc.dispatchEvent({type:"tooltipShow",tooltipGui:n,parentGui:this.tooltipCtrl.getGui()}),this.startHideTimeout()}onTooltipMouseEnter(){this.isInteractingWithTooltip=!0,this.unlockService()}onTooltipMouseLeave(){this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,this.lockService())}onTooltipFocusIn(){this.isInteractingWithTooltip=!0}isTooltipFocused(){let e=this.tooltipComp?.getGui(),t=tt(this.beans);return!!e&&e.contains(t)}onTooltipFocusOut(e){let t=this.tooltipCtrl.getGui();this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,t.contains(e.relatedTarget)?this.startHideTimeout():this.hideTooltip())}positionTooltip(){let e={type:"tooltip",ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack};this.lastMouseEvent?this.popupSvc?.positionPopupUnderMouseEvent(_(b({},e),{mouseEvent:this.lastMouseEvent})):this.popupSvc?.positionPopupByComponent(_(b({},e),{eventSource:this.tooltipCtrl.getGui(),position:"under",keepWithinBounds:!0,nudgeY:5}))}destroyTooltipComp(){this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");let e=this.tooltipPopupDestroyFunc,t=this.tooltipComp,i=this.tooltipTrigger===0?FB:0;window.setTimeout(()=>{e(),this.destroyBean(t)},i),this.clearTooltipListeners(),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0}clearTooltipListeners(){for(let e of[this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener,this.tooltipFocusInListener,this.tooltipFocusOutListener])e&&e();this.tooltipMouseEnterListener=this.tooltipMouseLeaveListener=this.tooltipFocusInListener=this.tooltipFocusOutListener=null}lockService(){Nh=!0,this.interactiveTooltipTimeoutId=window.setTimeout(()=>{this.unlockService(),this.setToDoNothing()},BE)}unlockService(){Nh=!1,this.clearInteractiveTimeout()}startHideTimeout(){this.clearHideTimeout(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.getTooltipDelay("hide"))}clearShowTimeout(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0)}clearHideTimeout(){this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)}clearInteractiveTimeout(){this.interactiveTooltipTimeoutId&&(window.clearTimeout(this.interactiveTooltipTimeoutId),this.interactiveTooltipTimeoutId=void 0)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout(),this.clearInteractiveTimeout()}},AB=class extends r4{constructor(e,t,i){super(e,i),this.highlightTracker=t,this.onHighlight=this.onHighlight.bind(this)}postConstruct(){super.postConstruct(),this.wireHighlightListeners()}wireHighlightListeners(){this.addManagedPropertyListener("tooltipTrigger",({currentValue:e})=>{this.setTooltipMode(e)}),this.setTooltipMode(this.gos.get("tooltipTrigger")),this.highlightTracker.addEventListener("itemHighlighted",this.onHighlight)}onHighlight(e){this.tooltipMode===1&&(e.highlighted?this.attemptToShowTooltip():this.attemptToHideTooltip())}setTooltipMode(e="focus"){this.tooltipMode=e==="focus"?1:0}destroy(){this.highlightTracker.removeEventListener("itemHighlighted",this.onHighlight),super.destroy()}},Bh=0,IB=200,LB=class extends Mn{constructor(){super(...arguments),this.beanName="popupSvc",this.popupList=[]}getPopupParent(){let e=this.gos.get("popupParent");return e||this.getDefaultPopupParent()}positionPopupUnderMouseEvent(e){let{ePopup:t,nudgeX:i,nudgeY:n,skipObserver:o}=e;this.positionPopup({ePopup:t,nudgeX:i,nudgeY:n,keepWithinBounds:!0,skipObserver:o,updatePosition:()=>this.calculatePointerAlign(e.mouseEvent),postProcessCallback:()=>this.callPostProcessPopup(e,e.type,e.ePopup,null,e.mouseEvent)})}calculatePointerAlign(e){let t=this.getParentRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}positionPopupByComponent(e){let{ePopup:t,nudgeX:i,nudgeY:n,keepWithinBounds:o,eventSource:s,alignSide:r="left",position:a="over",type:l}=e,d=s.getBoundingClientRect(),c=this.getParentRect();this.setAlignedTo(s,t);let u=()=>{let h=d.left-c.left;r==="right"&&(h-=t.offsetWidth-d.width);let p;return a==="over"?(p=d.top-c.top,this.setAlignedStyles(t,"over")):(this.setAlignedStyles(t,"under"),this.shouldRenderUnderOrAbove(t,d,c,e.nudgeY||0)==="under"?p=d.top-c.top+d.height:p=d.top-t.offsetHeight-(n||0)*2-c.top),{x:h,y:p}};this.positionPopup({ePopup:t,nudgeX:i,nudgeY:n,keepWithinBounds:o,updatePosition:u,postProcessCallback:()=>this.callPostProcessPopup(e,l,t,s,null)})}shouldRenderUnderOrAbove(e,t,i,n){let o=i.bottom-t.bottom,s=t.top-i.top,r=e.offsetHeight+n;return o>r?"under":s>r||s>o?"above":"under"}setAlignedStyles(e,t){let i=this.getPopupIndex(e);if(i===-1)return;let n=this.popupList[i],{alignedToElement:o}=n;if(!o)return;let s=["right","left","over","above","under"];for(let r of s)o.classList.remove(`ag-has-popup-positioned-${r}`),e.classList.remove(`ag-popup-positioned-${r}`);t&&(o.classList.add(`ag-has-popup-positioned-${t}`),e.classList.add(`ag-popup-positioned-${t}`))}setAlignedTo(e,t){let i=this.getPopupIndex(t);if(i!==-1){let n=this.popupList[i];n.alignedToElement=e}}positionPopup(e){let{ePopup:t,keepWithinBounds:i,nudgeX:n,nudgeY:o,skipObserver:s,updatePosition:r}=e,a={width:0,height:0},l=(d=!1)=>{let{x:c,y:u}=r();d&&t.clientWidth===a.width&&t.clientHeight===a.height||(a.width=t.clientWidth,a.height=t.clientHeight,n&&(c+=n),o&&(u+=o),i&&(c=this.keepXYWithinBounds(t,c,1),u=this.keepXYWithinBounds(t,u,0)),t.style.left=`${c}px`,t.style.top=`${u}px`,e.postProcessCallback&&e.postProcessCallback())};if(l(),!s){let d=Qo(this.beans,t,()=>l(!0));setTimeout(()=>d(),IB)}}getParentRect(){let e=kt(this.beans),t=this.getPopupParent();return t===e.body?t=e.documentElement:getComputedStyle(t).position==="static"&&(t=t.offsetParent),YR(t)}keepXYWithinBounds(e,t,i){let n=i===0,o=n?"clientHeight":"clientWidth",s=n?"top":"left",r=n?"height":"width",a=n?"scrollTop":"scrollLeft",l=kt(this.beans),d=l.documentElement,c=this.getPopupParent(),u=e.getBoundingClientRect(),h=c.getBoundingClientRect(),p=l.documentElement.getBoundingClientRect(),g=c===l.body,f=Math.ceil(u[r]),C=g?(n?KR:rp)(d)+d[a]:c[o];g&&(C-=Math.abs(p[s]-h[s]));let v=C-f;return Math.min(Math.max(t,0),Math.max(v,0))}addPopup(e){let{eChild:t,ariaLabel:i,ariaOwns:n,alwaysOnTop:o,positionCallback:s,anchorToElement:r}=e,a=this.getPopupIndex(t);if(a!==-1)return{hideFunc:this.popupList[a].hideFunc};this.initialisePopupPosition(t);let l=this.createPopupWrapper(t,!!o,i,n),d=this.addEventListenersToPopup(_(b({},e),{wrapperEl:l}));return s&&s(),this.addPopupToPopupList(t,l,d,r),{hideFunc:d}}initialisePopupPosition(e){let i=this.getPopupParent().getBoundingClientRect();q(e.style.top)||(e.style.top=`${i.top*-1}px`),q(e.style.left)||(e.style.left=`${i.left*-1}px`)}createPopupWrapper(e,t,i,n){let o=this.getPopupParent(),{environment:s,gos:r}=this.beans,a=Cd({tag:"div"});return s.applyThemeClasses(a),a.classList.add("ag-popup"),e.classList.add(r.get("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),e.hasAttribute("role")||jo(e,"dialog"),i?ma(e,i):n&&(e.id||(e.id=`popup-component-${Bh}`),vE(n,e.id)),a.appendChild(e),o.appendChild(a),t?this.setAlwaysOnTop(e,!0):this.bringPopupToFront(e),a}addEventListenersToPopup(e){let t=this.beans,i=kt(t),{wrapperEl:n,eChild:o,closedCallback:s,afterGuiAttached:r,closeOnEsc:a,modal:l,ariaOwns:d}=e,c=!1,u=f=>{if(!n.contains(tt(t)))return;f.key===R.ESCAPE&&!this.isStopPropagation(f)&&g({keyboardEvent:f})},h=f=>g({mouseEvent:f}),p=f=>g({touchEvent:f}),g=(f={})=>{let{mouseEvent:m,touchEvent:C,keyboardEvent:v,forceHide:w}=f;!w&&(this.isEventFromCurrentPopup({mouseEvent:m,touchEvent:C},o)||c)||(c=!0,n.remove(),i.removeEventListener("keydown",u),i.removeEventListener("mousedown",h),i.removeEventListener("touchstart",p),i.removeEventListener("contextmenu",h),this.eventSvc.removeListener("dragStarted",h),s&&s(m||C||v),this.removePopupFromPopupList(o,d))};return r&&r({hidePopup:g}),window.setTimeout(()=>{a&&i.addEventListener("keydown",u),l&&(i.addEventListener("mousedown",h),this.eventSvc.addListener("dragStarted",h),i.addEventListener("touchstart",p),i.addEventListener("contextmenu",h))},0),g}addPopupToPopupList(e,t,i,n){this.popupList.push({element:e,wrapper:t,hideFunc:i,instanceId:Bh,isAnchored:!!n}),n&&this.setPopupPositionRelatedToElement(e,n),Bh=Bh+1}getPopupIndex(e){return this.popupList.findIndex(t=>t.element===e)}setPopupPositionRelatedToElement(e,t){let i=this.getPopupIndex(e);if(i===-1)return;let n=this.popupList[i];if(n.stopAnchoringPromise&&n.stopAnchoringPromise.then(s=>s&&s()),n.stopAnchoringPromise=void 0,n.isAnchored=!1,!t)return;let o=this.keepPopupPositionedRelativeTo({element:t,ePopup:e,hidePopup:n.hideFunc});return n.stopAnchoringPromise=o,n.isAnchored=!0,o}removePopupFromPopupList(e,t){this.setAlignedStyles(e,null),this.setPopupPositionRelatedToElement(e,null),t&&vE(t,null),this.popupList=this.popupList.filter(i=>i.element!==e)}keepPopupPositionedRelativeTo(e){let t=this.getPopupParent(),i=t.getBoundingClientRect(),{element:n,ePopup:o}=e,s=n.getBoundingClientRect(),r=u=>Number.parseInt(u.substring(0,u.length-1),10),a=(u,h)=>{let p=i[u]-s[u],g=r(o.style[u]);return{initialDiff:p,lastDiff:p,initial:g,last:g,direction:h}},l=a("top",0),d=a("left",1),c=this.beans.frameworkOverrides;return new nt(u=>{c.wrapIncoming(()=>{UO(()=>{let h=t.getBoundingClientRect(),p=n.getBoundingClientRect();if(p.top==0&&p.left==0&&p.height==0&&p.width==0){e.hidePopup();return}let f=(m,C)=>{let v=r(o.style[C]);m.last!==v&&(m.initial=v,m.last=v);let w=h[C]-p[C];if(w!=m.lastDiff){let y=this.keepXYWithinBounds(o,m.initial+m.initialDiff-w,m.direction);o.style[C]=`${y}px`,m.last=y}m.lastDiff=w};f(l,"top"),f(d,"left")},200).then(h=>{u(()=>{h!=null&&window.clearInterval(h)})})},"popupPositioning")})}isEventFromCurrentPopup(e,t){let{mouseEvent:i,touchEvent:n}=e,o=i||n;if(!o)return!1;let s=this.getPopupIndex(t);if(s===-1)return!1;for(let r=s;r<this.popupList.length;r++){let a=this.popupList[r];if(k_(a.element,o))return!0}return this.isElementWithinCustomPopup(o.target)}isElementWithinCustomPopup(e){let t=kt(this.beans);for(;e&&e!==t.body;){if(e.classList.contains("ag-custom-component-popup")||e.parentElement===null)return!0;e=e.parentElement}return!1}getWrapper(e){for(;!e.classList.contains("ag-popup")&&e.parentElement;)e=e.parentElement;return e.classList.contains("ag-popup")?e:null}setAlwaysOnTop(e,t){let i=this.getWrapper(e);i&&(i.classList.toggle("ag-always-on-top",!!t),t&&this.bringPopupToFront(i))}bringPopupToFront(e){let t=this.getPopupParent(),i=Array.prototype.slice.call(t.querySelectorAll(".ag-popup")),n=i.length,o=this.getWrapper(e);if(!o||n<=1||!t.contains(e))return;let s=[],r=[];for(let h of i)h!==o&&(h.classList.contains("ag-always-on-top")?r.push(h):s.push(h));let a=[],l=r.length,u=o.classList.contains("ag-always-on-top")||!l?[...s,...r,o]:[...s,o,...r];for(let h=0;h<=n;h++){let p=u[h];if(i[h]===u[h]||p===o)continue;let g=p.querySelectorAll("div");for(let f of g)f.scrollTop!==0&&a.push([f,f.scrollTop]);h===0?t.insertAdjacentElement("afterbegin",p):u[h-1].insertAdjacentElement("afterend",p)}for(;a.length;){let h=a.pop();h[0].scrollTop=h[1]}}},_B=class extends pv{constructor(){super({tag:"div",cls:"ag-tooltip"})}init(e){let{value:t}=e,i=this.getGui();i.textContent=Sa(t);let n=e.location.replace(/([a-z])([A-Z0-9])/g,"$1-$2").toLowerCase();i.classList.add(`ag-${n}-tooltip`)}},a4=(e,t)=>{if(t!=null&&e?.setPointerCapture)try{return e.setPointerCapture(t),e.hasPointerCapture(t)}catch{}return!1},OB=(e,t)=>{if(typeof PointerEvent>"u"||!(t instanceof PointerEvent))return null;let i=t.pointerId;if(!a4(e,i))return null;let n={eElement:e,pointerId:i,onLost(o){BB(n,o)}};return e.addEventListener("lostpointercapture",n.onLost),n},NB=e=>{if(!e)return;l4(e);let{eElement:t,pointerId:i}=e;if(t){try{t.releasePointerCapture(i)}catch{}e.eElement=null}},l4=e=>{let{eElement:t,onLost:i}=e;t&&i&&(t.removeEventListener("lostpointercapture",i),e.onLost=null)},BB=(e,t)=>{l4(e);let{eElement:i,pointerId:n}=e;i&&t.pointerId===n&&a4(i,n)},Xr,na,io=e=>{if(!na)na=new WeakSet;else if(na.has(e))return!1;return na.add(e),!0},HB=class extends Mn{constructor(){super(...arguments),this.beanName="dragSvc",this.dragging=!1,this.drag=null,this.dragSources=[]}get startTarget(){return this.drag?.start.target??null}isPointer(){return!!Xr?.has(wn(this.beans))}hasPointerCapture(){let e=this.drag?.pointerCapture;return!!(e&&this.beans.eRootDiv.hasPointerCapture?.(e.pointerId))}destroy(){this.drag&&this.cancelDrag();let e=this.dragSources;for(let t of e)GE(t);e.length=0,super.destroy()}removeDragSource(e){let t=this.dragSources;for(let i=0,n=t.length;i<n;++i){let o=t[i];if(o.params===e){t.splice(i,1),GE(o);break}}}addDragSource(e){if(!this.isAlive())return;let{eElement:t,includeTouch:i}=e,n=[],o;if(i){let d=t.style;d&&(o=d.touchAction,d.touchAction="none")}let s={handlers:n,params:e,oldTouchAction:o};this.dragSources.push(s),Kh(n,[t,"pointerdown",d=>this.onPointerDown(e,d),{passive:!1}],[t,"mousedown",d=>this.onMouseDown(e,d)]);let l=this.gos.get("suppressTouch");i&&!l&&Kh(n,[t,"touchstart",c=>this.onTouchStart(e,c),{passive:!1}])}cancelDrag(e){let t=this.drag;e??(e=t?.eElement),e&&this.eventSvc.dispatchEvent({type:"dragCancelled",target:e}),t?.params.onDragCancel?.(),this.destroyDrag()}shouldPreventMouseEvent(e){let t=e.type;return(t==="mousemove"||t==="pointermove")&&e.cancelable&&ad(this.beans,e)&&!Kl(X0(e))}initDrag(e,...t){this.drag=e;let i=this.beans,n=a=>this.onScroll(a),o=a=>this.onKeyDown(a),s=wn(i),r=kt(i);Kh(e.handlers,[s,"contextmenu",Uo],[s,"keydown",o],[r,"scroll",n,{capture:!0}],[r.defaultView||window,"scroll",n],...t)}destroyDrag(){this.dragging=!1;let e=this.drag;if(e){let t=e.rootEl;Xr?.get(t)===e&&Xr?.delete(t),this.drag=null,NB(e.pointerCapture),rv(e.handlers)}}onPointerDown(e,t){if(this.isPointer())return;let i=this.beans;if(na?.has(t))return;let n=t.pointerType;if(n==="touch"&&(i.gos.get("suppressTouch")||!e.includeTouch||(e.stopPropagationForTouch&&t.stopPropagation(),Kl(X0(t))))||!t.isPrimary||n==="mouse"&&t.button!==0)return;this.destroyDrag();let o=wn(i),s=e.eElement,r=t.pointerId,a=new Y0(o,e,t,r);Xr??(Xr=new WeakMap),Xr.set(o,a);let l=u=>{u.pointerId===r&&this.onMouseOrPointerMove(u)},d=u=>{u.pointerId===r&&this.onMouseOrPointerUp(u)},c=u=>{u.pointerId===r&&io(u)&&this.cancelDrag()};this.initDrag(a,[o,"pointerup",d],[o,"pointercancel",c],[o,"pointermove",l,{passive:!1}],[o,"touchmove",Uo,{passive:!1}],[s,"mousemove",Uo,{passive:!1}]),e.dragStartPixels===0?this.onMouseOrPointerMove(t):io(t)}onTouchStart(e,t){if(this.gos.get("suppressTouch")||!e.includeTouch||!io(t)||Kl(X0(t)))return;if(e.stopPropagationForTouch&&t.stopPropagation(),this.isPointer()){Uo(t);return}this.destroyDrag();let n=this.beans,o=wn(n),s=new Y0(o,e,t.touches[0]),r=d=>this.onTouchMove(d),a=d=>this.onTouchUp(d),l=t.target??e.eElement;this.initDrag(s,[wn(n),"touchmove",Uo,{passive:!1}],[l,"touchmove",r,{passive:!0}],[l,"touchend",a,{passive:!0}],[l,"touchcancel",a,{passive:!0}]),e.dragStartPixels===0&&this.onMove(s.start)}onMouseDown(e,t){if(t.button!==0||na?.has(t)||this.isPointer())return;let i=this.beans;this.destroyDrag();let n=new Y0(wn(i),e,t),o=a=>this.onMouseOrPointerMove(a),s=a=>this.onMouseOrPointerUp(a),r=wn(i);this.initDrag(n,[r,"mousemove",o],[r,"mouseup",s]),e.dragStartPixels===0?this.onMouseOrPointerMove(t):io(t)}onScroll(e){if(!io(e))return;let t=this.drag,i=t?.lastDrag;i&&this.dragging&&t.params?.onDragging(i)}onMouseOrPointerMove(e){io(e)&&(es()&&kt(this.beans).getSelection()?.removeAllRanges(),this.shouldPreventMouseEvent(e)&&Uo(e),this.onMove(e))}onTouchMove(e){let t=this.drag;if(!t||!io(e))return;let i=Xl(t.start,e.touches);i&&(e.preventDefault(),this.onMove(i))}onMove(e){let t=this.drag;if(!t)return;t.lastDrag=e;let i=t.params;if(!this.dragging){let n=t.start,s=i.dragStartPixels??4;if(i6(e,n,s)||(this.dragging=!0,i.capturePointer&&(t.pointerCapture=OB(this.beans.eRootDiv,e)),this.eventSvc.dispatchEvent({type:"dragStarted",target:i.eElement}),i.onDragStart(n),this.drag!==t)||(i.onDragging(n),this.drag!==t))return}i.onDragging(e)}onTouchUp(e){let t=this.drag;t&&io(e)&&this.onUp(Xl(t.start,e.changedTouches))}onMouseOrPointerUp(e){io(e)&&this.onUp(e)}onUp(e){let t=this.drag;t&&(e||(e=t.lastDrag),e&&this.dragging&&(this.dragging=!1,t.params.onDragStop(e),this.eventSvc.dispatchEvent({type:"dragStopped",target:t.params.eElement})),this.destroyDrag())}onKeyDown(e){e.key===R.ESCAPE&&this.cancelDrag()}},GE=e=>{rv(e.handlers);let t=e.oldTouchAction;if(t!=null){let i=e.params.eElement.style;i&&(i.touchAction=t)}},Y0=class{constructor(e,t,i,n=null){this.rootEl=e,this.params=t,this.start=i,this.pointerId=n,this.handlers=[],this.lastDrag=null,this.pointerCapture=null,this.eElement=t.eElement}},X0=e=>{let t=e.target;return t instanceof Element?t:null},GB=class extends Mn{constructor(){super(...arguments),this.beanName="dragAndDrop",this.dragSourceAndParamsList=[],this.dragItem=null,this.dragInitialSourcePointerOffsetX=0,this.dragInitialSourcePointerOffsetY=0,this.lastMouseEvent=null,this.lastDraggingEvent=null,this.dragSource=null,this.dragImageParent=null,this.dragImageCompPromise=null,this.dragImageComp=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0,this.dropTargets=[],this.lastDropTarget=null}addDragSource(e,t=!1){let i={capturePointer:!0,dragSource:e,eElement:e.eElement,dragStartPixels:e.dragStartPixels,onDragStart:n=>this.onDragStart(e,n),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),onDragCancel:this.onDragCancel.bind(this),includeTouch:t};this.dragSourceAndParamsList.push(i),this.beans.dragSvc.addDragSource(i)}setDragImageCompIcon(e,t=!1){let i=this.dragImageComp;i&&(t||this.dragImageLastIcon!==e)&&(this.dragImageLastIcon=e,i.setIcon(e,t))}removeDragSource(e){let{dragSourceAndParamsList:t,beans:i}=this,n=t.find(o=>o.dragSource===e);n&&(i.dragSvc?.removeDragSource(n),Yi(t,n))}destroy(){let{dragSourceAndParamsList:e,dropTargets:t,beans:i}=this,n=i.dragSvc;for(let o of e)n?.removeDragSource(o);e.length=0,t.length=0,this.clearDragAndDropProperties(),super.destroy()}nudge(){let e=this.lastMouseEvent;e&&this.onDragging(e,!0)}onDragStart(e,t){this.lastMouseEvent=t,this.dragSource=e,this.dragItem=e.getDragItem();let i=e.eElement.getBoundingClientRect();this.dragInitialSourcePointerOffsetX=t.clientX-i.left,this.dragInitialSourcePointerOffsetY=t.clientY-i.top,e.onDragStarted?.(),this.createAndUpdateDragImageComp(e)}onDragStop(e){let{dragSource:t,lastDropTarget:i}=this;if(t?.onDragStopped?.(),i){let n=this.dropTargetEvent(i,e,!1);i.onDragStop?.(n)}this.clearDragAndDropProperties()}onDragCancel(){let{dragSource:e,lastDropTarget:t,lastMouseEvent:i}=this;if(e?.onDragCancelled?.(),t&&i){let n=this.dropTargetEvent(t,i,!1);t.onDragCancel?.(n)}this.clearDragAndDropProperties()}onDragging(e,t=!1){this.positionDragImageComp(e);let i=this.findCurrentDropTarget(e),{lastDropTarget:n,dragSource:o,dragItem:s}=this,r=!1;if(i!==n){if(r=!0,n){let a=this.dropTargetEvent(n,e,t);n.onDragLeave?.(a)}if(n!==null&&!i?this.handleExit(o,s):n===null&&i&&this.handleEnter(o,s),i){let a=this.dropTargetEvent(i,e,t);i.onDragEnter?.(a)}this.lastDropTarget=i}else if(i){let a=this.dropTargetEvent(i,e,t);i.onDragging?.(a),a?.changed&&(r=!0)}this.lastMouseEvent=e,r&&this.updateDragImageComp()}clearDragAndDropProperties(){this.removeDragImageComp(this.dragImageComp),this.dragImageCompPromise=null,this.dragImageParent=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0,this.lastMouseEvent=null,this.lastDraggingEvent=null,this.lastDropTarget=null,this.dragItem=null,this.dragInitialSourcePointerOffsetX=0,this.dragInitialSourcePointerOffsetY=0,this.dragSource=null}getAllContainersFromDropTarget(e){let t=e.getSecondaryContainers?e.getSecondaryContainers():null,i=[[e.getContainer()]];return t?i.concat(t):i}isMouseOnDropTarget(e,t){let i=this.getAllContainersFromDropTarget(t),n=!1,o=(a,l)=>{for(let d of l){let{width:c,height:u,left:h,right:p,top:g,bottom:f}=d.getBoundingClientRect();if(c===0||u===0)return!1;let m=a.clientX>=h&&a.clientX<p,C=a.clientY>=g&&a.clientY<f;if(!m||!C)return!1}return!0};for(let a of i)if(o(e,a)){n=!0;break}let{eElement:s,type:r}=this.dragSource;return t.targetContainsSource&&!t.getContainer().contains(s)?!1:n&&t.isInterestedIn(r,s)}findCurrentDropTarget(e){let t=this.dropTargets.filter(s=>this.isMouseOnDropTarget(e,s)),i=t.length;if(i===0)return null;if(i===1)return t[0];let o=wn(this.beans).elementsFromPoint(e.clientX,e.clientY);for(let s of o)for(let r of t)if(this.getAllContainersFromDropTarget(r).flatMap(l=>l).indexOf(s)!==-1)return r;return null}addDropTarget(e){this.dropTargets.push(e)}removeDropTarget(e){this.dropTargets=this.dropTargets.filter(t=>t.getContainer()!==e.getContainer())}hasExternalDropZones(){return this.dropTargets.some(e=>e.external)}findExternalZone(e){return this.dropTargets.find(t=>t.external&&t.getContainer()===e)||null}dropTargetEvent(e,t,i){let{dragSource:n,dragItem:o,lastDraggingEvent:s,lastMouseEvent:r,dragInitialSourcePointerOffsetX:a,dragInitialSourcePointerOffsetY:l}=this,d=e.getContainer(),c=d.getBoundingClientRect(),{clientX:u,clientY:h}=t,p=u-(r?.clientX||0),g=h-(r?.clientY||0),f=this.createEvent({event:t,x:u-c.left,y:h-c.top,vDirection:g>0?"down":g<0?"up":null,hDirection:p<0?"left":p>0?"right":null,initialSourcePointerOffsetX:a,initialSourcePointerOffsetY:l,dragSource:n,fromNudge:i,dragItem:o,dropZoneTarget:d,dropTarget:s?.dropTarget??null,changed:!!s?.changed});return this.lastDraggingEvent=f,f}positionDragImageComp(e){let t=this.dragImageComp?.getGui();t&&I_(t,e,this.beans)}removeDragImageComp(e){this.dragImageComp===e&&(this.dragImageComp=null),e&&(e.getGui()?.remove(),this.destroyBean(e))}createAndUpdateDragImageComp(e){let t=this.createDragImageComp(e)??null;this.dragImageCompPromise=t,t?.then(i=>{if(t!==this.dragImageCompPromise||!this.lastMouseEvent||!this.isAlive()){this.destroyBean(i);return}this.dragImageCompPromise=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0;let n=this.dragImageComp;n!==i&&(this.dragImageComp=i,this.removeDragImageComp(n)),i&&(this.appendDragImageComp(i),this.updateDragImageComp())})}appendDragImageComp(e){let t=e.getGui(),i=t.style;i.position="absolute",i.zIndex="9999",this.beans.dragSvc?.hasPointerCapture()&&(i.pointerEvents="none"),this.gos.setInstanceDomData(t),this.beans.environment.applyThemeClasses(t),i.top="20px",i.left="20px";let n=ev(this.beans);this.dragImageParent=n,n?n.appendChild(t):this.warnNoBody()}updateDragImageComp(){let{dragImageComp:e,dragSource:t,lastDropTarget:i,lastDraggingEvent:n,dragImageLastLabel:o}=this;if(!e)return;this.setDragImageCompIcon(i?.getIconName?.(n)??null);let s=t?.dragItemName;typeof s=="function"&&(s=s(n)),s||(s=""),o!==s&&(this.dragImageLastLabel=s,e.setLabel(s))}};var VB=class extends GB{createEvent(e){return te(this.gos,e)}createDragImageComp(e){let{gos:t,beans:i}=this;return cN(i.userCompFactory,te(t,{dragSource:e}))?.newAgStackInstance()}handleEnter(e,t){e?.onGridEnter?.(t)}handleExit(e,t){e?.onGridExit?.(t)}warnNoBody(){I(54)}isDropZoneWithinThisGrid(e){return this.beans.ctrlsSvc.getGridBodyCtrl().eGridBody.contains(e.dropZoneTarget)}registerGridDropTarget(e,t){let i={getContainer:e,isInterestedIn:n=>n===1||n===0,getIconName:()=>"notAllowed"};this.addDropTarget(i),t.addDestroyFunc(()=>this.removeDropTarget(i))}};function d4(e,t){return e+"_"+t}function pt(e){return e instanceof hd}var hd=class extends D{constructor(e,t,i,n){super(),this.providedColumnGroup=e,this.groupId=t,this.partId=i,this.pinned=n,this.isColumn=!1,this.displayedChildren=[],this.autoHeaderHeight=null,this.parent=null,this.colIdSanitised=jl(this.getUniqueId())}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}getUniqueId(){return d4(this.groupId,this.partId)}isEmptyGroup(){return this.displayedChildren.length===0}isMoving(){let e=this.getProvidedColumnGroup().getLeafColumns();return!e||e.length===0?!1:e.every(t=>t.isMoving())}checkLeft(){for(let e of this.displayedChildren)pt(e)&&e.checkLeft();if(this.displayedChildren.length>0)if(this.gos.get("enableRtl")){let t=Ue(this.displayedChildren).getLeft();this.setLeft(t)}else{let e=this.displayedChildren[0].getLeft();this.setLeft(e)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(e){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchLocalEvent({type:"leftChanged"}))}getPinned(){return this.pinned}getGroupId(){return this.groupId}getPartId(){return this.partId}getActualWidth(){let e=0;for(let t of this.displayedChildren??[])e+=t.getActualWidth();return e}isResizable(){if(!this.displayedChildren)return!1;let e=!1;for(let t of this.displayedChildren)t.isResizable()&&(e=!0);return e}getMinWidth(){let e=0;for(let t of this.displayedChildren)e+=t.getMinWidth();return e}addChild(e){this.children||(this.children=[]),this.children.push(e)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){let e=[];return this.addLeafColumns(e),e}getDisplayedLeafColumns(){let e=[];return this.addDisplayedLeafColumns(e),e}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(e){this.providedColumnGroup.setExpanded(e)}isAutoHeaderHeight(){return!!this.getColGroupDef()?.autoHeaderHeight}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){let t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}addDisplayedLeafColumns(e){for(let t of this.displayedChildren??[])Xo(t)?e.push(t):pt(t)&&t.addDisplayedLeafColumns(e)}addLeafColumns(e){for(let t of this.children??[])Xo(t)?e.push(t):pt(t)&&t.addLeafColumns(e)}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){let e=this.getParent();return!this.isPadding()||!e?.isPadding()?0:1+e.getPaddingLevel()}calculateDisplayedColumns(){this.displayedChildren=[];let e=this;for(;e?.isPadding();)e=e.getParent();if(!(e?e.getProvidedColumnGroup().isExpandable():!1)){this.displayedChildren=this.children,this.dispatchLocalEvent({type:"displayedChildrenChanged"});return}for(let i of this.children??[]){if(pt(i)&&!i.displayedChildren?.length)continue;switch(i.getColumnGroupShow()){case"open":e.getProvidedColumnGroup().isExpanded()&&this.displayedChildren.push(i);break;case"closed":e.getProvidedColumnGroup().isExpanded()||this.displayedChildren.push(i);break;default:this.displayedChildren.push(i);break}}this.dispatchLocalEvent({type:"displayedChildrenChanged"})}},OC="row-group-",yv="t-",Sv="b-",zB=0,Jo=class{constructor(e){this.master=!1,this.detail=void 0,this.rowIndex=null,this.key=null,this.sourceRowIndex=-1,this._leafs=void 0,this.childrenMapped=null,this.treeParent=null,this.treeNodeFlags=0,this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=zB++,this.alreadyRendered=!1,this.hovered=!1,this.__selected=!1,this.beans=e}get allLeafChildren(){let e=this._leafs;return e===void 0?this.beans.groupStage?.loadLeafs?.(this)??null:e}set allLeafChildren(e){this._leafs=e}setData(e){this.setDataCommon(e,!1)}updateData(e){this.setDataCommon(e,!0)}setDataCommon(e,t){let{valueCache:i,eventSvc:n}=this.beans,o=this.data;this.data=e,i?.onDataChanged(),this.updateDataOnDetailNode(),this.resetQuickFilterAggregateText();let s=this.createDataChangedEvent(e,o,t);if(this.__localEventService?.dispatchEvent(s),this.sibling){this.sibling.data=e;let a=this.sibling.createDataChangedEvent(e,o,t);this.sibling.__localEventService?.dispatchEvent(a)}n.dispatchEvent({type:"rowNodeDataChanged",node:this});let r=this.pinnedSibling;r&&(r.data=e,r.__localEventService?.dispatchEvent(r.createDataChangedEvent(e,o,t)),n.dispatchEvent({type:"rowNodeDataChanged",node:r}))}updateDataOnDetailNode(){let e=this.detailNode;e&&(e.data=this.data)}createDataChangedEvent(e,t,i){return{type:"dataChanged",node:this,oldData:t,newData:e,update:i}}getRowIndexString(){return this.rowIndex==null?(Ge(13),null):this.rowPinned==="top"?yv+this.rowIndex:this.rowPinned==="bottom"?Sv+this.rowIndex:this.rowIndex.toString()}setDataAndId(e,t){let{selectionSvc:i}=this.beans,n=i?.createDaemonNode?.(this),o=this.data;this.data=e,this.updateDataOnDetailNode(),this.setId(t),i&&(i.updateRowSelectable(this),i.syncInRowNode(this,n));let s=this.createDataChangedEvent(e,o,!1);this.__localEventService?.dispatchEvent(s)}setId(e){let t=Ca(this.beans.gos);if(t)if(this.data){let i=this.parent?.getRoute()??[];this.id=t({data:this.data,parentKeys:i.length>0?i:void 0,level:this.level,rowPinned:this.rowPinned}),this.id.startsWith(OC)&&Ge(14,{groupPrefix:OC})}else this.id=void 0;else this.id=e}setRowTop(e){if(this.oldRowTop=this.rowTop,this.rowTop===e)return;this.rowTop=e,this.dispatchRowEvent("topChanged");let t=e!==null;this.displayed!==t&&(this.displayed=t,this.dispatchRowEvent("displayedChanged"))}clearRowTopAndRowIndex(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}setHovered(e){this.hovered=e}isHovered(){return this.hovered}setRowHeight(e,t=!1){this.rowHeight=e,this.rowHeightEstimated=t,this.dispatchRowEvent("heightChanged")}setExpanded(e,t,i){this.beans.expansionSvc?.setExpanded(this,e,t,i)}setDataValue(e,t,i){let{colModel:n,valueSvc:o,gos:s,editSvc:r}=this.beans,a=typeof e!="string"?e:n.getCol(e)??n.getColDefCol(e);if(!a)return!1;let l=o.getValueForDisplay(a,this,void 0,void 0,"api").value;if(s.get("readOnlyEdit")){let{beans:{eventSvc:c},data:u,rowIndex:h,rowPinned:p}=this;return c.dispatchEvent({type:"cellEditRequest",event:null,rowIndex:h,rowPinned:p,column:a,colDef:a.colDef,data:u,node:this,oldValue:l,newValue:t,value:t,source:i}),!1}if(r&&!r.committing){let c=r.setDataValue({rowNode:this,column:a},t,i);if(c!=null)return c}let d=o.setValue(this,a,t,i);return this.dispatchCellChangedEvent(a,t,l),d&&this.pinnedSibling?.dispatchCellChangedEvent(a,t,l),d}updateHasChildren(){let e=this.group&&!this.footer||!!this.childrenAfterGroup?.length,{rowChildrenSvc:t}=this.beans;t&&(e=t.getHasChildrenValue(this)),e!==this.__hasChildren&&(this.__hasChildren=!!e,this.dispatchRowEvent("hasChildrenChanged"))}hasChildren(){return this.__hasChildren==null&&this.updateHasChildren(),this.__hasChildren}dispatchCellChangedEvent(e,t,i){let n={type:"cellChanged",node:this,column:e,newValue:t,oldValue:i};this.__localEventService?.dispatchEvent(n)}resetQuickFilterAggregateText(){this.quickFilterAggregateText=null}isExpandable(){return this.beans.expansionSvc?.isExpandable(this)??!1}isSelected(){if(this.footer)return this.sibling.isSelected();let e=this.rowPinned&&this.pinnedSibling;return e?e.isSelected():this.__selected}depthFirstSearch(e){let t=this.childrenAfterGroup;if(t)for(let i=0,n=t.length;i<n;++i)t[i].depthFirstSearch(e);e(this)}dispatchRowEvent(e){this.__localEventService?.dispatchEvent({type:e,node:this})}setSelected(e,t=!1,i="api"){this.beans.selectionSvc?.setNodesSelected({nodes:[this],newValue:e,clearSelection:t,source:i})}isRowPinned(){return!!this.rowPinned}__addEventListener(e,t){(this.__localEventService??(this.__localEventService=new qs)).addEventListener(e,t)}__removeEventListener(e,t){this.removeLocalListener(e,t)}addEventListener(e,t){this.beans.validation?.checkRowEvents(e);let i=this.__localEventService??(this.__localEventService=new qs);this.frameworkEventListenerService=this.beans.frameworkOverrides.createLocalEventListenerWrapper?.(this.frameworkEventListenerService,i);let n=this.frameworkEventListenerService?.wrap(e,t)??t;i.addEventListener(e,n)}removeEventListener(e,t){let i=this.frameworkEventListenerService?.unwrap(e,t)??t;this.removeLocalListener(e,i)}removeLocalListener(e,t){let i=this.__localEventService;i&&(i.removeEventListener(e,t),i.noRegisteredListenersExist()&&(this.__localEventService=null))}isFullWidthCell(){if(I(61),this.detail)return!0;let e=this.beans.gos.getCallback("isFullWidthRow");return e?e({rowNode:this}):!1}getRoute(){if(this.level===-1)return[];if(this.key==null)return;let e=[],t=this;for(;t?.key!=null;)e.push(t.key),t=t.parent;return e.reverse()}setRowIndex(e){this.rowIndex!==e&&(this.rowIndex=e,this.dispatchRowEvent("rowIndexChanged"))}setAllChildrenCount(e){this.allChildrenCount!==e&&(this.allChildrenCount=e,this.dispatchRowEvent("allChildrenCountChanged"))}setUiLevel(e){this.uiLevel!==e&&(this.uiLevel=e,this.dispatchRowEvent("uiLevelChanged"))}getFirstChild(){let e=this.childStore;return e?e.getFirstNode():this.childrenAfterSort?.[0]??null}};function WB(e,t,i){return te(t,{type:i,node:e,data:e.data,rowIndex:e.rowIndex,rowPinned:e.rowPinned})}var UB=new Set(["__autoHeights","__checkAutoHeightsDebounced","__localEventService","__objectId","_leafs","childStore","oldRowTop","sticky","treeNodeFlags","treeParent"]),qB=(e,t)=>{let i=new Jo(t);for(let n of Object.keys(e))UB.has(n)||(i[n]=e[n]);return i.oldRowTop=null,i},c4=e=>{for(;e?.length;){let t=e[0];if(t.data)return t;e=t.childrenAfterGroup}},u4={agSetColumnFilter:"agSetColumnFilterHandler",agMultiColumnFilter:"agMultiColumnFilterHandler",agGroupColumnFilter:"agGroupColumnFilterHandler",agNumberColumnFilter:"agNumberColumnFilterHandler",agDateColumnFilter:"agDateColumnFilterHandler",agTextColumnFilter:"agTextColumnFilterHandler"},$B=new Set(Object.values(u4));function Vo(e,t){let i=e.filterUi;if(!i)return null;if(i.created)return i.promise;if(t)return null;let n=i.create(i.refreshed),o=i;return o.created=!0,o.promise=n,n}function jB(e,t,i,n,o,s,r){return t.refresh?.(_(b({},i),{model:n,source:s,additionalEventAttributes:r})),e().then(a=>{if(a){let{filter:l,filterParams:d}=a;h4(l,d,n,o,s,r)}})}function h4(e,t,i,n,o,s){e?.refresh?.(_(b({},t),{model:i,state:n,source:o,additionalEventAttributes:s}))}function p4(e,t,i){let n=e();n?.created&&n.promise.then(o=>{let s=t();h4(o,n.filterParams,s,i()??{model:s},"ui")})}function VE(e,t,i,n,o,s,r){let a,l=!1,d;switch(e){case"apply":{let c=n();d=c?.model??null,r&&(d=r(d)),a={state:c?.state,model:d},l=!0;break}case"clear":{a={model:null};break}case"reset":{a={model:null},l=!0,d=null;break}case"cancel":{a={model:i()};break}}o(a),l?s(d):p4(t,i,n)}function Mt(e,t){return e[t]??null}function ft(e){return Cd(e)}function KB(e){return{tag:"div",cls:e}}var YB=class extends Oe{constructor(e){let{className:t="ag-filter-apply-panel"}=e??{};super(KB(t)),this.listeners=[],this.validationMessage=null,this.className=t}updateButtons(e,t){let i=this.buttons;if(this.buttons=e,i===e)return;let n=this.getGui();Ot(n);let o;this.destroyListeners();let s=document.createDocumentFragment(),r=this.className,a=({type:d,label:c})=>{let u=C=>{this.dispatchLocalEvent({type:d,event:C})};["apply","clear","reset","cancel"].includes(d)||I(75);let h=d==="apply",g=ft({tag:"button",attrs:{type:h&&t?"submit":"button"},ref:`${d}FilterButton`,cls:`ag-button ag-standard-button ${r}-button${h?" "+r+"-apply-button":""}`,children:c});this.activateTabIndex([g]),h&&(o=g);let f=C=>{C.key===R.ENTER&&(C.preventDefault(),u(C))},m=this.listeners;g.addEventListener("click",u),m.push(()=>g.removeEventListener("click",u)),g.addEventListener("keydown",f),m.push(()=>g.removeEventListener("keydown",f)),s.append(g)};for(let d of e)a(d);this.eApply=o;let l=this.validationTooltipFeature;o&&!l?this.validationTooltipFeature=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.eApply,getLocation:()=>"advancedFilter",getTooltipShowDelayOverride:()=>1e3})):!o&&l&&(this.validationTooltipFeature=this.destroyBean(l)),n.append(s)}getApplyButton(){return this.eApply}updateValidity(e,t=null){let i=this.eApply;i&&(sd(i,e===!1),this.validationMessage=t??null,this.validationTooltipFeature?.setTooltipAndRefresh(this.validationMessage))}destroyListeners(){for(let e of this.listeners)e();this.listeners=[]}destroy(){this.destroyListeners(),super.destroy()}};var XB={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose one",equals:"Equals",notEqual:"Does not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"Between",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equal to",greaterThanOrEqual:"Greater than or equal to",contains:"Contains",notContains:"Does not contain",startsWith:"Begins with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",before:"Before",after:"After",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd",filterSummaryInactive:"is (All)",filterSummaryContains:"contains",filterSummaryNotContains:"does not contain",filterSummaryTextEquals:"equals",filterSummaryTextNotEqual:"does not equal",filterSummaryStartsWith:"begins with",filterSummaryEndsWith:"ends with",filterSummaryBlank:"is blank",filterSummaryNotBlank:"is not blank",filterSummaryEquals:"=",filterSummaryNotEqual:"!=",filterSummaryGreaterThan:">",filterSummaryGreaterThanOrEqual:">=",filterSummaryLessThan:"<",filterSummaryLessThanOrEqual:"<=",filterSummaryInRange:"between",filterSummaryInRangeValues:e=>`(${e[0]}, ${e[1]})`,filterSummaryTextQuote:e=>`"${e[0]}"`};function $o(e,t,i){return __(e,XB,t,i)}function xv(e,t){let{debounceMs:i}=e;return Ap(e)?(i!=null&&I(71),0):i??t}function Ap(e){return(e.buttons?.indexOf("apply")??-1)>=0}var JB=class extends Oe{constructor(e,t,i,n,o,s){super(),this.column=e,this.wrapper=t,this.eventParent=i,this.updateModel=n,this.isGlobalButtons=o,this.enableGlobalButtonCheck=s,this.hidePopup=null,this.applyActive=!1}postConstruct(){let{comp:e,params:t}=this.wrapper,i=t,n=i.useForm,o=n?"form":"div";this.setTemplate({tag:o,cls:"ag-filter-wrapper"}),n&&this.addManagedElementListeners(this.getGui(),{submit:s=>{s?.preventDefault()},keydown:this.handleKeyDown.bind(this)}),this.appendChild(e.getGui()),this.params=i,this.resetButtonsPanel(i),this.addManagedListeners(this.eventParent,b({filterParamsChanged:({column:s,params:r})=>{s===this.column&&this.resetButtonsPanel(r,this.params)},filterStateChanged:({column:s,state:r})=>{s===this.column&&this.eButtons?.updateValidity(r.valid!==!1)},filterAction:({column:s,action:r,event:a})=>{s===this.column&&this.afterAction(r,a)}},this.enableGlobalButtonCheck?{filterGlobalButtons:({isGlobal:s})=>{if(s!==this.isGlobalButtons){this.isGlobalButtons=s;let r=this.params;this.resetButtonsPanel(r,r,!0)}}}:void 0))}afterGuiAttached(e){e&&(this.hidePopup=e.hidePopup)}resetButtonsPanel(e,t,i){let{buttons:n,readOnly:o}=t??{},{buttons:s,readOnly:r,useForm:a}=e;if(!i&&o===r&&nd(n,s))return;let l=s&&s.length>0&&!e.readOnly&&!this.isGlobalButtons,d=this.eButtons;if(l){let c=s.map(u=>{let h=`${u}Filter`;return{type:u,label:$o(this,h)}});if(this.applyActive=Ap(this.params),!d){d=this.createBean(new YB),this.appendChild(d.getGui());let u=this.column,h=p=>({event:g})=>{this.updateModel(u,p,{fromButtons:!0}),this.afterAction(p,g)};d?.addManagedListeners(d,{apply:h("apply"),clear:h("clear"),reset:h("reset"),cancel:h("cancel")}),this.eButtons=d}d.updateButtons(c,a)}else this.applyActive=!1,d&&(hi(d.getGui()),this.eButtons=this.destroyBean(d))}close(e){let t=this.hidePopup;if(!t)return;let i=e,n=i?.key,o;(n===R.ENTER||n===R.SPACE)&&(o={keyboardEvent:i}),t(o),this.hidePopup=null}afterAction(e,t){let{params:i,applyActive:n}=this,o=i?.closeOnApply;switch(e){case"apply":{t?.preventDefault(),o&&n&&this.close(t);break}case"reset":{o&&n&&this.close();break}case"cancel":{o&&this.close(t);break}}}handleKeyDown(e){!e.defaultPrevented&&e.key===R.ENTER&&this.applyActive&&(this.updateModel(this.column,"apply",{fromButtons:!0}),this.afterAction("apply",e))}destroy(){this.hidePopup=null,this.eButtons=this.destroyBean(this.eButtons)}},QB={tag:"div",cls:"ag-filter"},ZB=class extends Oe{constructor(e,t,i){super(QB),this.column=e,this.source=t,this.enableGlobalButtonCheck=i,this.wrapper=null}postConstruct(){this.beans.colFilter?.activeFilterComps.add(this),this.createFilter(!0),this.addManagedEventListeners({filterDestroyed:this.onFilterDestroyed.bind(this)})}hasFilter(){return this.wrapper!=null}getFilter(){return this.wrapper?.then(e=>e.comp)??null}afterInit(){return this.wrapper?.then(()=>{})??nt.resolve()}afterGuiAttached(e){this.afterGuiAttachedParams=e,this.wrapper?.then(t=>{this.comp?.afterGuiAttached(e),t?.comp?.afterGuiAttached?.(e)})}afterGuiDetached(){this.wrapper?.then(e=>{e?.comp?.afterGuiDetached?.()})}createFilter(e){let{column:t,source:i,beans:{colFilter:n}}=this,o=n.getFilterUiForDisplay(t)??null;this.wrapper=o,o?.then(s=>{if(!s)return;let{isHandler:r,comp:a}=s,l;if(r){let d=!!this.enableGlobalButtonCheck,c=this.createBean(new JB(t,s,n,n.updateModel.bind(n),d&&n.isGlobalButtons,d));this.comp=c,l=c.getGui()}else l=a.getGui(),q(l)||I(69,{guiFromFilter:l});this.appendChild(l),e?this.eventSvc.dispatchEvent({type:"filterOpened",column:t,source:i,eGui:this.getGui()}):a.afterGuiAttached?.(this.afterGuiAttachedParams)})}onFilterDestroyed(e){let{source:t,column:i}=e;(t==="api"||t==="paramsUpdated")&&i.getId()===this.column.getId()&&this.beans.colModel.getColDefCol(this.column)&&(Ot(this.getGui()),this.comp=this.destroyBean(this.comp),this.createFilter())}destroy(){this.beans.colFilter?.activeFilterComps.delete(this),this.eventSvc.dispatchEvent({type:"filterClosed",column:this.column}),this.wrapper=null,this.comp=this.destroyBean(this.comp),this.afterGuiAttachedParams=void 0,super.destroy()}},zE={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},WE=["january","february","march","april","may","june","july","august","september","october","november","december"];function eH(e,t){return e==null?-1:t==null?1:Number.parseFloat(e)-Number.parseFloat(t)}function UE(e){return e instanceof Date&&!isNaN(e.getTime())}var NC={number:()=>{},boolean:()=>({maxNumConditions:1,debounceMs:0,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:(e,t)=>t,numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:(e,t)=>t===!1,numberOfInputs:0}]}),date:()=>({isValidDate:UE}),dateString:({dataTypeDefinition:e})=>({comparator:(t,i)=>{let n=e.dateParser(i);return i==null||n<t?-1:n>t?1:0},isValidDate:t=>typeof t=="string"&&UE(e.dateParser(t))}),dateTime:e=>NC.date(e),dateTimeString:e=>NC.dateString(e),object:()=>{},text:()=>{}},BC={number:()=>({comparator:eH}),boolean:({t:e})=>({valueFormatter:t=>q(t.value)?e(String(t.value),t.value?"True":"False"):e("blanks","(Blanks)")}),date:({formatValue:e,t})=>({valueFormatter:i=>{let n=e(i);return q(n)?n:t("blanks","(Blanks)")},treeList:!0,treeListFormatter:(i,n)=>{if(i==="NaN")return t("invalidDate","Invalid Date");if(n===1&&i!=null){let o=WE[Number(i)-1];return t(o,zE[o])}return i??t("blanks","(Blanks)")},treeListPathGetter:i=>Oh(i,!1)}),dateString:({formatValue:e,dataTypeDefinition:t,t:i})=>({valueFormatter:n=>{let o=e(n);return q(o)?o:i("blanks","(Blanks)")},treeList:!0,treeListPathGetter:n=>Oh(t.dateParser(n??void 0),!1),treeListFormatter:(n,o)=>{if(o===1&&n!=null){let s=WE[Number(n)-1];return i(s,zE[s])}return n??i("blanks","(Blanks)")}}),dateTime:e=>{let t=BC.date(e);return t.treeListPathGetter=Oh,t},dateTimeString(e){let t=e.dataTypeDefinition.dateParser,i=BC.dateString(e);return i.treeListPathGetter=n=>Oh(t(n??void 0)),i},object:({formatValue:e,t})=>({valueFormatter:i=>{let n=e(i);return q(n)?n:t("blanks","(Blanks)")}}),text:()=>{}};function tH(e,t,i,n,o,s,r){let a=t,l=i,d=e==="agSetColumnFilter";!l&&n.baseDataType==="object"&&!d&&(l=({column:p,node:g})=>o({column:p,node:g,value:s.valueSvc.getValue(p,g)}));let u=(d?BC:NC)[n.baseDataType],h=u({dataTypeDefinition:n,formatValue:o,t:r});return a=typeof t=="object"?b(b({},h),t):h,{filterParams:a,filterValueGetter:l}}var iH={boolean:"agTextColumnFilter",date:"agDateColumnFilter",dateString:"agDateColumnFilter",dateTime:"agDateColumnFilter",dateTimeString:"agDateColumnFilter",number:"agNumberColumnFilter",object:"agTextColumnFilter",text:"agTextColumnFilter"},nH={boolean:"agTextColumnFloatingFilter",date:"agDateColumnFloatingFilter",dateString:"agDateColumnFloatingFilter",dateTime:"agDateColumnFloatingFilter",dateTimeString:"agDateColumnFloatingFilter",number:"agNumberColumnFloatingFilter",object:"agTextColumnFloatingFilter",text:"agTextColumnFloatingFilter"};function oH(e,t=!1){return(t?nH:iH)[e??"text"]}var g4="ag-resizer-wrapper",zo=(e,t)=>({tag:"div",ref:`${e}Resizer`,cls:`ag-resizer ag-resizer-${t}`}),sH={tag:"div",cls:g4,children:[zo("eTopLeft","topLeft"),zo("eTop","top"),zo("eTopRight","topRight"),zo("eRight","right"),zo("eBottomRight","bottomRight"),zo("eBottom","bottom"),zo("eBottomLeft","bottomLeft"),zo("eLeft","left")]},rH=class extends D{constructor(e,t){super(),this.element=e,this.dragStartPosition={x:0,y:0},this.position={x:0,y:0},this.lastSize={width:-1,height:-1},this.positioned=!1,this.resizersAdded=!1,this.resizeListeners=[],this.boundaryEl=null,this.isResizing=!1,this.isMoving=!1,this.resizable={},this.movable=!1,this.currentResizer=null,this.config=Object.assign({},{popup:!1},t)}wireBeans(e){this.popupSvc=e.popupSvc,this.dragSvc=e.dragSvc}center(e){let{clientHeight:t,clientWidth:i}=this.offsetParent,n=i/2-this.getWidth()/2,o=t/2-this.getHeight()/2;this.offsetElement(n,o,e)}initialisePosition(e){if(this.positioned)return;let{centered:t,forcePopupParentAsOffsetParent:i,minWidth:n,width:o,minHeight:s,height:r,x:a,y:l}=this.config;this.offsetParent||this.setOffsetParent();let d=0,c=0,u=Pn(this.element);if(u){let h=this.findBoundaryElement(),p=window.getComputedStyle(h);if(p.minWidth!=null){let g=h.offsetWidth-this.element.offsetWidth;c=Number.parseInt(p.minWidth,10)-g}if(p.minHeight!=null){let g=h.offsetHeight-this.element.offsetHeight;d=Number.parseInt(p.minHeight,10)-g}}if(this.minHeight=s||d,this.minWidth=n||c,o&&this.setWidth(o),r&&this.setHeight(r),(!o||!r)&&this.refreshSize(),t)this.center(e);else if(a||l)this.offsetElement(a,l,e);else if(u&&i){let h=this.boundaryEl,p=!0;if(h||(h=this.findBoundaryElement(),p=!1),h){let g=Number.parseFloat(h.style.top),f=Number.parseFloat(h.style.left);p?this.offsetElement(isNaN(f)?0:f,isNaN(g)?0:g,e):this.setPosition(f,g)}}this.positioned=!!this.offsetParent}isPositioned(){return this.positioned}getPosition(){return this.position}setMovable(e,t){if(!this.config.popup||e===this.movable)return;this.movable=e;let i=this.moveElementDragListener||{eElement:t,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};e?(this.dragSvc?.addDragSource(i),this.moveElementDragListener=i):(this.dragSvc?.removeDragSource(i),this.moveElementDragListener=void 0)}setResizable(e){if(this.clearResizeListeners(),e?this.addResizers():this.removeResizers(),typeof e=="boolean"){if(e===!1)return;e={topLeft:e,top:e,topRight:e,right:e,bottomRight:e,bottom:e,bottomLeft:e,left:e}}Object.keys(e).forEach(t=>{let n=!!e[t],o=this.getResizerElement(t),s={dragStartPixels:0,eElement:o,onDragStart:r=>this.onResizeStart(r,t),onDragging:this.onResize.bind(this),onDragStop:r=>this.onResizeEnd(r,t)};(n||!this.isAlive()&&!n)&&(n?(this.dragSvc?.addDragSource(s),this.resizeListeners.push(s),o.style.pointerEvents="all"):o.style.pointerEvents="none",this.resizable[t]=n)})}removeSizeFromEl(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}restoreLastSize(){this.element.style.flex="0 0 auto";let{height:e,width:t}=this.lastSize;t!==-1&&(this.element.style.width=`${t}px`),e!==-1&&(this.element.style.height=`${e}px`)}getHeight(){return this.element.offsetHeight}setHeight(e){let{popup:t}=this.config,i=this.element,n=!1;if(typeof e=="string"&&e.includes("%"))Yl(i,e),e=KR(i),n=!0;else if(e=Math.max(this.minHeight,e),this.positioned){let o=this.getAvailableHeight();o&&e>o&&(e=o)}this.getHeight()!==e&&(n?(i.style.maxHeight="unset",i.style.minHeight="unset"):t?Yl(i,e):(i.style.height=`${e}px`,i.style.flex="0 0 auto",this.lastSize.height=typeof e=="number"?e:Number.parseFloat(e)))}getAvailableHeight(){let{popup:e,forcePopupParentAsOffsetParent:t}=this.config;this.positioned||this.initialisePosition();let{clientHeight:i}=this.offsetParent;if(!i)return null;let n=this.element.getBoundingClientRect(),o=this.offsetParent.getBoundingClientRect(),s=e?this.position.y:n.top,r=e?0:o.top,a=0;if(t){let d=this.element.parentElement;if(d){let{bottom:c}=d.getBoundingClientRect();a=c-n.bottom}}return i+r-s-a}getWidth(){return this.element.offsetWidth}setWidth(e){let t=this.element,{popup:i}=this.config,n=!1;if(typeof e=="string"&&e.includes("%"))xn(t,e),e=rp(t),n=!0;else if(this.positioned){e=Math.max(this.minWidth,e);let{clientWidth:o}=this.offsetParent,s=i?this.position.x:this.element.getBoundingClientRect().left;o&&e+s>o&&(e=o-s)}this.getWidth()!==e&&(n?(t.style.maxWidth="unset",t.style.minWidth="unset"):this.config.popup?xn(t,e):(t.style.width=`${e}px`,t.style.flex=" unset",this.lastSize.width=typeof e=="number"?e:Number.parseFloat(e)))}offsetElement(e=0,t=0,i){let{forcePopupParentAsOffsetParent:n}=this.config,o=n?this.boundaryEl:this.element;o&&(this.popupSvc?.positionPopup({ePopup:o,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:()=>({x:e,y:t}),postProcessCallback:i}),this.setPosition(Number.parseFloat(o.style.left),Number.parseFloat(o.style.top)))}constrainSizeToAvailableHeight(e){if(!this.config.forcePopupParentAsOffsetParent)return;let t=()=>{let i=this.getAvailableHeight();this.element.style.setProperty("max-height",`${i}px`)};e&&this.popupSvc?(this.resizeObserverSubscriber?.(),this.resizeObserverSubscriber=Qo(this.beans,this.popupSvc?.getPopupParent(),t)):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}setPosition(e,t){this.position.x=e,this.position.y=t}updateDragStartPosition(e,t){this.dragStartPosition={x:e,y:t}}calculateMouseMovement(e){let{e:t,isLeft:i,isTop:n,anywhereWithin:o,topBuffer:s}=e,r=t.clientX-this.dragStartPosition.x,a=t.clientY-this.dragStartPosition.y,l=this.shouldSkipX(t,!!i,!!o,r)?0:r,d=this.shouldSkipY(t,!!n,s,a)?0:a;return{movementX:l,movementY:d}}shouldSkipX(e,t,i,n){let o=this.element.getBoundingClientRect(),s=this.offsetParent.getBoundingClientRect(),r=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.x:o.left,l=a<=0&&s.left>=e.clientX||s.right<=e.clientX&&s.right<=r.right;return l?!0:(t?l=n<0&&e.clientX>a+s.left||n>0&&e.clientX<a+s.left:i?l=n<0&&e.clientX>r.right||n>0&&e.clientX<a+s.left:l=n<0&&e.clientX>r.right||n>0&&e.clientX<r.right,l)}shouldSkipY(e,t,i=0,n){let o=this.element.getBoundingClientRect(),s=this.offsetParent.getBoundingClientRect(),r=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.y:o.top,l=a<=0&&s.top>=e.clientY||s.bottom<=e.clientY&&s.bottom<=r.bottom;return l?!0:(t?l=n<0&&e.clientY>a+s.top+i||n>0&&e.clientY<a+s.top:l=n<0&&e.clientY>r.bottom||n>0&&e.clientY<r.bottom,l)}createResizeMap(){let e=t=>({element:this.element.querySelector(`[data-ref=${t}Resizer]`)});this.resizerMap={topLeft:e("eTopLeft"),top:e("eTop"),topRight:e("eTopRight"),right:e("eRight"),bottomRight:e("eBottomRight"),bottom:e("eBottom"),bottomLeft:e("eBottomLeft"),left:e("eLeft")}}addResizers(){if(this.resizersAdded)return;let e=this.element;e&&(e.appendChild(ft(sH)),this.createResizeMap(),this.resizersAdded=!0)}removeResizers(){this.resizerMap=void 0,this.element.querySelector(`.${g4}`)?.remove(),this.resizersAdded=!1}getResizerElement(e){return this.resizerMap[e].element}onResizeStart(e,t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!t.match(/top/i),isRight:!!t.match(/right/i),isBottom:!!t.match(/bottom/i),isLeft:!!t.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[t].element.classList.add("ag-active");let{popup:i,forcePopupParentAsOffsetParent:n}=this.config;!i&&!n&&this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)}getSiblings(){let t=this.element.parentElement;return t?Array.prototype.slice.call(t.children).filter(i=>!i.classList.contains("ag-hidden")):null}getMinSizeOfSiblings(){let e=this.getSiblings()||[],t=0,i=0;for(let n=0;n<e.length;n++){let o=e[n],s=!!o.style.flex&&o.style.flex!=="0 0 auto";if(o===this.element)continue;let r=this.minHeight||0,a=this.minWidth||0;if(s){let l=window.getComputedStyle(o);l.minHeight&&(r=Number.parseInt(l.minHeight,10)),l.minWidth&&(a=Number.parseInt(l.minWidth,10))}else r=o.offsetHeight,a=o.offsetWidth;t+=r,i+=a}return{height:t,width:i}}applySizeToSiblings(e){let t=null,i=this.getSiblings();if(i){for(let n=0;n<i.length;n++){let o=i[n];o!==t&&(e?o.style.height=`${o.offsetHeight}px`:o.style.width=`${o.offsetWidth}px`,o.style.flex="0 0 auto",o===this.element&&(t=i[n+1]))}t&&(t.style.removeProperty("height"),t.style.removeProperty("min-height"),t.style.removeProperty("max-height"),t.style.flex="1 1 auto")}}isResizable(){return Object.values(this.resizable).some(e=>e)}onResize(e){if(!this.isResizing||!this.currentResizer)return;let{popup:t,forcePopupParentAsOffsetParent:i}=this.config,{isTop:n,isRight:o,isBottom:s,isLeft:r}=this.currentResizer,a=o||r,l=s||n,{movementX:d,movementY:c}=this.calculateMouseMovement({e,isLeft:r,isTop:n}),u=this.position.x,h=this.position.y,p=0,g=0;if(a&&d){let f=r?-1:1,m=this.getWidth(),C=m+d*f,v=!1;r&&(p=m-C,(u+p<=0||C<=this.minWidth)&&(v=!0,p=0)),v||this.setWidth(C)}if(l&&c){let f=n?-1:1,m=this.getHeight(),C=m+c*f,v=!1;n?(g=m-C,(h+g<=0||C<=this.minHeight)&&(v=!0,g=0)):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&m<C&&this.getMinSizeOfSiblings().height+C>this.element.parentElement.offsetHeight&&(v=!0),v||this.setHeight(C)}this.updateDragStartPosition(e.clientX,e.clientY),((t||i)&&p||g)&&this.offsetElement(u+p,h+g)}onResizeEnd(e,t){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null,this.element.classList.remove("ag-resizing"),this.resizerMap[t].element.classList.remove("ag-active"),this.dispatchLocalEvent({type:"resize"})}refreshSize(){let e=this.element;this.config.popup&&(this.config.width||this.setWidth(e.offsetWidth),this.config.height||this.setHeight(e.offsetHeight))}onMoveStart(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)}onMove(e){if(!this.isMoving)return;let{x:t,y:i}=this.position,n;this.config.calculateTopBuffer&&(n=this.config.calculateTopBuffer());let{movementX:o,movementY:s}=this.calculateMouseMovement({e,isTop:!0,anywhereWithin:!0,topBuffer:n});this.offsetElement(t+o,i+s),this.updateDragStartPosition(e.clientX,e.clientY)}onMoveEnd(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}setOffsetParent(){this.config.forcePopupParentAsOffsetParent&&this.popupSvc?this.offsetParent=this.popupSvc.getPopupParent():this.offsetParent=this.element.offsetParent}findBoundaryElement(){let e=this.element;for(;e;){if(window.getComputedStyle(e).position!=="static")return e;e=e.parentElement}return this.element}clearResizeListeners(){for(;this.resizeListeners.length;){let e=this.resizeListeners.pop();this.dragSvc?.removeDragSource(e)}}destroy(){super.destroy(),this.moveElementDragListener&&this.dragSvc?.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}},f4="__ag_Grid_Stop_Propagation";function Ks(e){e[f4]=!0}function co(e){return e[f4]===!0}var aH="ag-focus-managed",Ea=class extends D{constructor(e,t={}){super(),this.eFocusable=e,this.callbacks=t,this.callbacks=b({shouldStopEventPropagation:()=>!1,onTabKeyDown:i=>{if(i.defaultPrevented)return;let n=Qs(this.beans,this.eFocusable,!1,i.shiftKey);n&&(n.focus(),i.preventDefault())}},t)}postConstruct(){let{eFocusable:e,callbacks:{onFocusIn:t,onFocusOut:i}}=this;e.classList.add(aH),this.addKeyDownListeners(e),t&&this.addManagedElementListeners(e,{focusin:t}),i&&this.addManagedElementListeners(e,{focusout:i})}addKeyDownListeners(e){this.addManagedElementListeners(e,{keydown:t=>{if(t.defaultPrevented||co(t))return;let{callbacks:i}=this;if(i.shouldStopEventPropagation(t)){Ks(t);return}t.key===R.TAB?i.onTabKeyDown(t):i.handleKeyDown&&i.handleKeyDown(t)}})}},lH=class extends Oe{constructor(e,t){super(),this.filterNameKey=e,this.cssIdentifier=t,this.applyActive=!1,this.debouncePending=!1,this.defaultDebounceMs=0}postConstruct(){let e={tag:"div",cls:`ag-filter-body-wrapper ag-${this.cssIdentifier}-body-wrapper`,children:[this.createBodyTemplate()]};this.setTemplate(e,this.getAgComponents()),this.createManagedBean(new Ea(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=this.createBean(new rH(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}))}handleKeyDown(e){}init(e){let t=e;this.setParams(t),this.setModelIntoUi(t.state.model,!0).then(()=>this.updateUiVisibility())}refresh(e){let t=e,i=this.params;this.params=t,t.source==="colDef"&&this.updateParams(t,i);let o=t.state,s=this.state;return this.state=o,(o.model!==s.model||o.state!==s.state)&&this.setModelIntoUi(o.model),!0}setParams(e){this.params=e,this.state=e.state,this.commonUpdateParams(e)}updateParams(e,t){this.commonUpdateParams(e,t)}commonUpdateParams(e,t){this.applyActive=Ap(e),this.setupApplyDebounced()}doesFilterPass(e){I(283);let{getHandler:t,model:i,column:n}=this.params;return t().doesFilterPass(_(b({},e),{model:i,handlerParams:this.beans.colFilter.getHandlerParams(n)}))}getFilterTitle(){return this.translate(this.filterNameKey)}isFilterActive(){return I(284),this.params.model!=null}setupApplyDebounced(){let e=xv(this.params,this.defaultDebounceMs),t=_t(this,this.checkApplyDebounce.bind(this),e);this.applyDebounced=()=>{this.debouncePending=!0,t()}}checkApplyDebounce(){this.debouncePending&&(this.debouncePending=!1,this.doApplyModel())}getModel(){return I(285),this.params.model}setModel(e){I(286);let{beans:t,params:i}=this;return t.colFilter.setModelForColumnLegacy(i.column,e)}applyModel(e="api"){return this.doApplyModel()}canApply(e){return!0}doApplyModel(e){let{params:t,state:i}=this,n=!this.areModelsEqual(t.model,i.model);return n&&t.onAction("apply",e),n}onNewRowsLoaded(){}onUiChanged(e,t=!1){this.updateUiVisibility();let i=this.getModelFromUi(),n={model:i,state:this.getState(),valid:this.canApply(i)};this.state=n;let o=this.params;o.onStateChange(n),o.onUiChange(this.getUiChangeEventParams()),this.gos.get("enableFilterHandlers")||this.eventSvc.dispatchEvent({type:"filterModified",column:o.column,filterInstance:this}),e??(e=this.applyActive?void 0:"debounce"),e==="immediately"?this.doApplyModel({afterFloatingFilter:t,afterDataChange:!1}):e==="debounce"&&this.applyDebounced()}getState(){}getUiChangeEventParams(){}afterGuiAttached(e){this.lastContainerType=e?.container,this.refreshFilterResizer(e?.container)}refreshFilterResizer(e){let{positionableFeature:t,gos:i}=this;if(!t)return;let n=e==="floatingFilter"||e==="columnFilter";n?(t.restoreLastSize(),t.setResizable(i.get("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(t.removeSizeFromEl(),t.setResizable(!1)),t.constrainSizeToAvailableHeight(n)}afterGuiDetached(){this.checkApplyDebounce(),this.positionableFeature?.constrainSizeToAvailableHeight(!1)}destroy(){this.positionableFeature=this.destroyBean(this.positionableFeature),super.destroy()}translate(e){return $o(this,e)}getPositionableElement(){return this.getGui()}areModelsEqual(e,t){return e===t||e==null&&t==null?!0:e==null||t==null?!1:this.areNonNullModelsEqual(e,t)}};function m4(e){return!!e.operator}function dH(e,t,i){if(t==null)return null;let n=null,{compName:o,jsComp:s,fwComp:r}=W6(e,t);return o?n={agSetColumnFilter:"agSetColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"}[o]:s==null&&r==null&&t.filter===!0&&(n=i()),n}var ji={AUTO_HEIGHT:"ag-layout-auto-height",NORMAL:"ag-layout-normal",PRINT:"ag-layout-print"},Ev=class extends D{constructor(e){super(),this.view=e}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){let e=this.gos.get("domLayout"),t={autoHeight:e==="autoHeight",normal:e==="normal",print:e==="print"},i=t.autoHeight?ji.AUTO_HEIGHT:t.print?ji.PRINT:ji.NORMAL;this.view.updateLayoutClasses(i,t)}},Wo="Viewport",qE="fakeVScrollComp",J0=["fakeHScrollComp","centerHeader","topCenter","bottomCenter","stickyTopCenter","stickyBottomCenter"],$E=100,Q0=150,cH=class extends D{constructor(e){super(),this.clearRetryListenerFncs=[],this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.lastOffsetHeight=-1,this.lastScrollTop=-1,this.lastIsHorizontalScrollShowing=!1,this.scrollTimer=0,this.isScrollActive=!1,this.isVerticalPositionInvalidated=!0,this.isHorizontalPositionInvalidated=!0,this.eBodyViewport=e,this.resetLastHScrollDebounced=_t(this,()=>this.lastScrollSource[1]=null,Q0),this.resetLastVScrollDebounced=_t(this,()=>this.lastScrollSource[0]=null,Q0)}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.animationFrameSvc=e.animationFrameSvc,this.visibleCols=e.visibleCols}destroy(){super.destroy(),this.clearRetryListenerFncs=[],window.clearTimeout(this.scrollTimer)}postConstruct(){this.enableRtl=this.gos.get("enableRtl");let e=this.invalidateVerticalScroll.bind(this),t=this.invalidateHorizontalScroll.bind(this);this.addManagedEventListeners({displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this),bodyHeightChanged:e,scrollGapChanged:t}),this.addManagedElementListeners(this.eBodyViewport,{scroll:e}),this.ctrlsSvc.whenReady(this,i=>{this.centerRowsCtrl=i.center,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()})}invalidateHorizontalScroll(){this.isHorizontalPositionInvalidated=!0}invalidateVerticalScroll(){this.isVerticalPositionInvalidated=!0}addScrollListener(){this.addHorizontalScrollListeners(),this.addVerticalScrollListeners()}addHorizontalScrollListeners(){this.addManagedElementListeners(this.centerRowsCtrl.eViewport,{scroll:this.onHScroll.bind(this,Wo)});for(let e of J0){let t=this.ctrlsSvc.get(e);this.registerScrollPartner(t,this.onHScroll.bind(this,e))}}addVerticalScrollListeners(){let e=this.ctrlsSvc.get("fakeVScrollComp"),t=this.gos.get("debounceVerticalScrollbar"),i=t?_t(this,this.onVScroll.bind(this,Wo),$E):this.onVScroll.bind(this,Wo),n=t?_t(this,this.onVScroll.bind(this,qE),$E):this.onVScroll.bind(this,qE);this.addManagedElementListeners(this.eBodyViewport,{scroll:i}),this.registerScrollPartner(e,n)}registerScrollPartner(e,t){e.onScrollCallback(t)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(e){this.centerRowsCtrl!=null&&(e===void 0&&(e=this.centerRowsCtrl.getCenterViewportScrollLeft()),this.setScrollLeftForAllContainersExceptCurrent(Math.abs(e)))}setScrollLeftForAllContainersExceptCurrent(e){for(let t of[...J0,Wo]){if(this.lastScrollSource[1]===t)continue;let i=this.getViewportForSource(t);lp(i,e,this.enableRtl)}}getViewportForSource(e){return e===Wo?this.centerRowsCtrl.eViewport:this.ctrlsSvc.get(e).eViewport}isControllingScroll(e,t){return this.lastScrollSource[t]==null?(t===0?this.lastScrollSource[0]=e:this.lastScrollSource[1]=e,!0):this.lastScrollSource[t]===e}onHScroll(e){if(!this.isControllingScroll(e,1))return;let t=this.centerRowsCtrl.eViewport,{scrollLeft:i}=t;if(this.shouldBlockScrollUpdate(1,i,!0))return;let n=ap(this.getViewportForSource(e),this.enableRtl);this.doHorizontalScroll(n),this.resetLastHScrollDebounced()}onVScroll(e){if(!this.isControllingScroll(e,0))return;let t;if(e===Wo?t=this.eBodyViewport.scrollTop:t=this.ctrlsSvc.get("fakeVScrollComp").getScrollPosition(),this.shouldBlockScrollUpdate(0,t,!0))return;let{animationFrameSvc:i}=this;i?.setScrollTop(t),this.nextScrollTop=t,e===Wo?this.ctrlsSvc.get("fakeVScrollComp").setScrollPosition(t):this.eBodyViewport.scrollTop=t,i?.active?i.schedule():this.scrollGridIfNeeded(!0),this.resetLastVScrollDebounced()}doHorizontalScroll(e){let t=this.ctrlsSvc.get("fakeHScrollComp").getScrollPosition();this.scrollLeft===e&&e===t||(this.scrollLeft=e,this.fireScrollEvent(1),this.horizontallyScrollHeaderCenterAndFloatingCenter(e),this.centerRowsCtrl.onHorizontalViewportChanged(!0))}isScrolling(){return this.isScrollActive}fireScrollEvent(e){let t={type:"bodyScroll",direction:e===1?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.isScrollActive=!0,this.eventSvc.dispatchEvent(t),window.clearTimeout(this.scrollTimer),this.scrollTimer=window.setTimeout(()=>{this.scrollTimer=0,this.isScrollActive=!1,this.eventSvc.dispatchEvent(_(b({},t),{type:"bodyScrollEnd"}))},Q0)}shouldBlockScrollUpdate(e,t,i=!1){return i&&!zs()?!1:e===0?this.shouldBlockVerticalScroll(t):this.shouldBlockHorizontalScroll(t)}shouldBlockVerticalScroll(e){let t=tv(this.eBodyViewport),{scrollHeight:i}=this.eBodyViewport;return e<0||e+t>i}shouldBlockHorizontalScroll(e){let t=this.centerRowsCtrl.getCenterWidth(),{scrollWidth:i}=this.centerRowsCtrl.eViewport;if(this.enableRtl){if(e>0)return!0}else if(e<0)return!0;return Math.abs(e)+t>i}redrawRowsAfterScroll(){this.fireScrollEvent(0)}checkScrollLeft(){let e=this.scrollLeft,t=!1;for(let i of J0)if(this.getViewportForSource(i).scrollLeft!==e){t=!0;break}t&&this.onHScroll(Wo)}scrollGridIfNeeded(e=!1){let t=this.scrollTop!=this.nextScrollTop;return t&&(this.scrollTop=this.nextScrollTop,e&&this.invalidateVerticalScroll(),this.redrawRowsAfterScroll()),t}setHorizontalScrollPosition(e,t=!1){let n=this.centerRowsCtrl.eViewport.scrollWidth-this.centerRowsCtrl.getCenterWidth();!t&&this.shouldBlockScrollUpdate(1,e)&&(this.enableRtl?e=e>0?0:n:e=Math.min(Math.max(e,0),n)),lp(this.centerRowsCtrl.eViewport,Math.abs(e),this.enableRtl),this.doHorizontalScroll(e)}setVerticalScrollPosition(e){this.invalidateVerticalScroll(),this.eBodyViewport.scrollTop=e}getVScrollPosition(){if(!this.isVerticalPositionInvalidated){let{lastOffsetHeight:i,lastScrollTop:n}=this;return{top:n,bottom:n+i}}this.isVerticalPositionInvalidated=!1;let{scrollTop:e,offsetHeight:t}=this.eBodyViewport;return this.lastScrollTop=e,this.lastOffsetHeight=t,{top:e,bottom:e+t}}getApproximateVScollPosition(){return this.lastScrollTop>=0&&this.lastOffsetHeight>=0?{top:this.scrollTop,bottom:this.scrollTop+this.lastOffsetHeight}:this.getVScrollPosition()}getHScrollPosition(){return this.centerRowsCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.isHorizontalPositionInvalidated&&(this.lastIsHorizontalScrollShowing=this.centerRowsCtrl.isHorizontalScrollShowing(),this.isHorizontalPositionInvalidated=!1),this.lastIsHorizontalScrollShowing}scrollHorizontally(e){let t=this.centerRowsCtrl.eViewport.scrollLeft;return this.setHorizontalScrollPosition(t+e),this.centerRowsCtrl.eViewport.scrollLeft-t}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(e,t=null){let{rowModel:i}=this.beans,n=i.getRowCount(),o=-1;for(let s=0;s<n;s++){let r=i.getRow(s);if(typeof e=="function"){if(r&&e(r)){o=s;break}}else if(e===r||e===r.data){o=s;break}}o>=0&&this.ensureIndexVisible(o,t)}ensureIndexVisible(e,t,i=0){if(Nt(this.gos,"print"))return;let{rowModel:n}=this.beans,o=n.getRowCount();if(typeof e!="number"||e<0||e>=o){I(88,{index:e});return}this.clearRetryListeners();let{frameworkOverrides:s,pageBounds:r,rowContainerHeight:a,rowRenderer:l}=this.beans;s.wrapIncoming(()=>{let d=this.ctrlsSvc.getGridBodyCtrl(),c=n.getRow(e),u,h,p=0;this.invalidateVerticalScroll();do{let{stickyTopHeight:g,stickyBottomHeight:f}=d,m=c.rowTop,C=c.rowHeight,v=r.getPixelOffset(),w=c.rowTop-v,y=w+c.rowHeight,S=this.getVScrollPosition(),x=a.divStretchOffset,E=S.top+x,T=S.bottom+x,L=T-E,O=a.getScrollPositionForPixel(w),W=a.getScrollPositionForPixel(y-L),G=Math.min((O+W)/2,w),Q=E+g>w,ge=T-f<y,pe=null;t==="top"?pe=O-g:t==="bottom"?pe=W+f:t==="middle"?pe=G:Q?pe=O-g:ge&&(W-O>L?pe=O-g:pe=W+f),pe!==null&&(this.setVerticalScrollPosition(pe),l.redraw({afterScroll:!0})),u=m!==c.rowTop||C!==c.rowHeight,h=g!==d.stickyTopHeight||f!==d.stickyBottomHeight,p++}while((u||h)&&p<10);if(this.animationFrameSvc?.flushAllFrames(),i<10&&(c?.stub||!this.beans.rowAutoHeight?.areRowsMeasured())){let g=this.getVScrollPosition().top;this.clearRetryListenerFncs=this.addManagedEventListeners({bodyScroll:()=>{let f=this.getVScrollPosition().top;g!==f&&this.clearRetryListeners()},modelUpdated:()=>{this.clearRetryListeners(),!(e>=n.getRowCount())&&this.ensureIndexVisible(e,t,i+1)}})}})}clearRetryListeners(){for(let e of this.clearRetryListenerFncs)e();this.clearRetryListenerFncs=[]}ensureColumnVisible(e,t="auto"){let{colModel:i,frameworkOverrides:n}=this.beans,o=i.getCol(e);if(!o||o.isPinned()||!this.visibleCols.isColDisplayed(o))return;let s=this.getPositionedHorizontalScroll(o,t);n.wrapIncoming(()=>{s!==null&&this.centerRowsCtrl.setCenterViewportScrollLeft(s),this.centerRowsCtrl.onHorizontalViewportChanged(),this.animationFrameSvc?.flushAllFrames()})}getPositionedHorizontalScroll(e,t){let{columnBeforeStart:i,columnAfterEnd:n}=this.isColumnOutsideViewport(e),o=this.centerRowsCtrl.getCenterWidth()<e.getActualWidth(),s=this.centerRowsCtrl.getCenterWidth(),r=this.enableRtl,a=(r?i:n)||o,l=r?n:i;t!=="auto"&&(a=t==="start",l=t==="end");let d=t==="middle";if(a||l||d){let{colLeft:c,colMiddle:u,colRight:h}=this.getColumnBounds(e);return d?u-s/2:a?r?h:c:r?c-s:h-s}return null}isColumnOutsideViewport(e){let{start:t,end:i}=this.getViewportBounds(),{colLeft:n,colRight:o}=this.getColumnBounds(e),s=this.enableRtl,r=s?t>o:i<o,a=s?i<n:t>n;return{columnBeforeStart:r,columnAfterEnd:a}}getColumnBounds(e){let t=this.enableRtl,i=this.visibleCols.bodyWidth,n=e.getActualWidth(),o=e.getLeft(),s=t?-1:1,r=t?i-o:o,a=r+n*s,l=r+n/2*s;return{colLeft:r,colMiddle:l,colRight:a}}getViewportBounds(){let e=this.centerRowsCtrl.getCenterWidth(),t=this.centerRowsCtrl.getCenterViewportScrollLeft(),i=t,n=e+t;return{start:i,end:n,width:e}}},Rv=class extends D{constructor(e,t=!1){super(),this.callback=e,this.addSpacer=t}postConstruct(){let e=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",e),this.addManagedEventListeners({columnContainerWidthChanged:e,displayedColumnsChanged:e,leftPinnedWidthChanged:e}),this.addSpacer&&this.addManagedEventListeners({rightPinnedWidthChanged:e,scrollVisibilityChanged:e,scrollbarWidthChanged:e}),this.setWidth()}setWidth(){let e=Nt(this.gos,"print"),{visibleCols:t,scrollVisibleSvc:i}=this.beans,n=t.bodyWidth,o=t.getColsLeftWidth(),s=t.getDisplayedColumnsRightWidth(),r;e?r=n+o+s:(r=n,this.addSpacer&&(this.gos.get("enableRtl")?o:s)===0&&i.verticalScrollShowing&&(r+=i.getScrollbarWidth())),this.callback(r)}},uH=class extends D{constructor(e){super(),this.centerContainerCtrl=e}wireBeans(e){this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.listenForResize()}),this.addManagedEventListeners({scrollbarWidthChanged:this.onScrollbarWidthChanged.bind(this)}),this.addManagedPropertyListeners(["alwaysShowHorizontalScroll","alwaysShowVerticalScroll"],()=>{this.checkViewportAndScrolls()})}listenForResize(){let{beans:e,centerContainerCtrl:t,gridBodyCtrl:i}=this,n=()=>{po(e,()=>{this.onCenterViewportResized()})};t.registerViewportResizeListener(n),i.registerBodyViewportResizeListener(n)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.scrollVisibleSvc.updateScrollGap(),this.centerContainerCtrl.isViewportInTheDOMTree()){let{pinnedCols:e,colFlex:t}=this.beans;e?.keepPinnedColumnsNarrowerThanViewport(),this.checkViewportAndScrolls();let i=this.centerContainerCtrl.getCenterWidth();i!==this.centerWidth&&(this.centerWidth=i,t?.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.scrollFeature.checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){let e=this.gridBodyCtrl.eBodyViewport,t=tv(e);this.bodyHeight!==t&&(this.bodyHeight=t,this.eventSvc.dispatchEvent({type:"bodyHeightChanged"}))}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){if(!this.isAlive())return;let e={horizontalScrollShowing:this.centerContainerCtrl.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleSvc.setScrollsVisible(e)}onHorizontalViewportChanged(){let e=this.centerContainerCtrl.getCenterWidth(),t=this.centerContainerCtrl.getViewportScrollLeft();this.beans.colViewport.setScrollPosition(e,t)}};function Zh(e,t,i,n){let o=t.getColDef().cellRendererParams?.suppressMouseEventHandling;return C4(e,t,i,n,o)}function hH(e,t,i,n){let o=t?.suppressMouseEventHandling;return C4(e,void 0,i,n,o)}function C4(e,t,i,n,o){return o?o(te(e,{column:t,node:i,event:n})):!1}function v4(e,t,i){let n=t;for(;n;){let o=C6(e,n,i);if(o)return o;n=n.parentElement}return null}var yp="cellCtrl";function Pv(e,t){return v4(e,t,yp)}var Sp="renderedRow";function pH(e,t){return v4(e,t,Sp)}function HC(e,t,i,n,o){let s=n?n.getColDef().suppressKeyboardEvent:void 0;if(!s)return!1;let r=te(e,{event:t,editing:o,column:n,node:i,data:i.data,colDef:n.getColDef()});return!!(s&&s(r))}function gH(e){let{pinnedRowModel:t,rowModel:i}=e,[n,o]=[t?.isEmpty("top")??!0,t?.isEmpty("bottom")??!0],s=n?null:"top",r,a;o?(r=null,a=i.getRowCount()-1):(r="bottom",a=t?.getPinnedBottomRowCount()??-1);let{visibleCols:l,rangeSvc:d}=e,c=l.allCols;!d||!c?.length||d.setCellRange({rowStartIndex:0,rowStartPinned:s,rowEndIndex:a,rowEndPinned:r})}var fH=65,mH=67,CH=86,vH=68,wH=90,bH=89;function yH(e){let{keyCode:t}=e,i;switch(t){case fH:i=R.A;break;case mH:i=R.C;break;case CH:i=R.V;break;case vH:i=R.D;break;case wH:i=R.Z;break;case bH:i=R.Y;break;default:i=e.code}return i}var SH=class extends D{constructor(e){super(),this.element=e}postConstruct(){this.addKeyboardListeners(),this.addMouseListeners(),this.beans.touchSvc?.mockRowContextMenu(this),this.editSvc=this.beans.editSvc}addKeyboardListeners(){let e="keydown",t=this.processKeyboardEvent.bind(this,e);this.addManagedElementListeners(this.element,{[e]:t})}addMouseListeners(){let t=["dblclick","contextmenu","mouseover","mouseout","click",t6("touchstart")?"touchstart":"mousedown"];for(let i of t){let n=this.processMouseEvent.bind(this,i);this.addManagedElementListeners(this.element,{[i]:n})}}processMouseEvent(e,t){if(!ad(this.beans,t)||co(t))return;let{cellCtrl:i,rowCtrl:n}=this.getControlsForEventTarget(t.target);e==="contextmenu"?(i?.column&&i.dispatchCellContextMenuEvent(t),this.beans.contextMenuSvc?.handleContextMenuMouseEvent(t,void 0,n,i)):(i&&i.onMouseEvent(e,t),n&&n.onMouseEvent(e,t))}getControlsForEventTarget(e){let{gos:t}=this;return{cellCtrl:Pv(t,e),rowCtrl:pH(t,e)}}processKeyboardEvent(e,t){let{cellCtrl:i,rowCtrl:n}=this.getControlsForEventTarget(t.target);t.defaultPrevented||(i?this.processCellKeyboardEvent(i,e,t):n?.isFullWidth()&&this.processFullWidthRowKeyboardEvent(n,e,t))}processCellKeyboardEvent(e,t,i){let n=this.editSvc?.isEditing(e,{withOpenEditor:!0})??!1;!HC(this.gos,i,e.rowNode,e.column,n)&&t==="keydown"&&(!n&&this.beans.navigation?.handlePageScrollingKey(i)||e.onKeyDown(i),this.doGridOperations(i,n),K6(i)&&e.processCharacter(i)),t==="keydown"&&this.eventSvc.dispatchEvent(e.createEvent(i,"cellKeyDown"))}processFullWidthRowKeyboardEvent(e,t,i){let{rowNode:n}=e,{focusSvc:o,navigation:s}=this.beans,a=o.getFocusedCell()?.column;if(!HC(this.gos,i,n,a,!1)){let d=i.key;if(t==="keydown")switch(d){case R.PAGE_HOME:case R.PAGE_END:case R.PAGE_UP:case R.PAGE_DOWN:s?.handlePageScrollingKey(i,!0);break;case R.LEFT:case R.RIGHT:if(!this.gos.get("embedFullWidthRows"))break;case R.UP:case R.DOWN:e.onKeyboardNavigate(i);break;case R.TAB:e.onTabKeyDown(i);break;default:}}t==="keydown"&&this.eventSvc.dispatchEvent(e.createRowEvent("cellKeyDown",i))}doGridOperations(e,t){if(!e.ctrlKey&&!e.metaKey||t||!ad(this.beans,e))return;let i=yH(e),{clipboardSvc:n,undoRedo:o}=this.beans;if(i===R.A)return this.onCtrlAndA(e);if(i===R.C)return this.onCtrlAndC(n,e);if(i===R.D)return this.onCtrlAndD(n,e);if(i===R.V)return this.onCtrlAndV(n,e);if(i===R.X)return this.onCtrlAndX(n,e);if(i===R.Y)return this.onCtrlAndY(o);if(i===R.Z)return this.onCtrlAndZ(o,e)}onCtrlAndA(e){let{beans:{rowModel:t,rangeSvc:i,selectionSvc:n},gos:o}=this;i&&uo(o)&&!fO(o)&&t.isRowsToRender()?gH(this.beans):n&&n.selectAllRowNodes({source:"keyboardSelectAll",selectAll:x6(o)}),e.preventDefault()}onCtrlAndC(e,t){if(!e||this.gos.get("enableCellTextSelection"))return;let{cellCtrl:i}=this.getControlsForEventTarget(t.target);this.editSvc?.isEditing(i,{withOpenEditor:!0})||(t.preventDefault(),e.copyToClipboard())}onCtrlAndX(e,t){if(!e||this.gos.get("enableCellTextSelection")||this.gos.get("suppressCutToClipboard"))return;let{cellCtrl:i}=this.getControlsForEventTarget(t.target);this.editSvc?.isEditing(i,{withOpenEditor:!0})||(t.preventDefault(),e.cutToClipboard(void 0,"ui"))}onCtrlAndV(e,t){let{cellCtrl:i}=this.getControlsForEventTarget(t.target);this.editSvc?.isEditing(i,{withOpenEditor:!0})||e&&!this.gos.get("suppressClipboardPaste")&&e.pasteFromClipboard()}onCtrlAndD(e,t){e&&!this.gos.get("suppressClipboardPaste")&&e.copyRangeDown(),t.preventDefault()}onCtrlAndZ(e,t){!this.gos.get("undoRedoCellEditing")||!e||(t.preventDefault(),t.shiftKey?e.redo("ui"):e.undo("ui"))}onCtrlAndY(e){e?.redo("ui")}},w4=class extends D{constructor(e,t){super(),this.eContainer=e,this.eViewport=t}postConstruct(){this.addManagedEventListeners({rowContainerHeightChanged:this.onHeightChanged.bind(this,this.beans.rowContainerHeight)})}onHeightChanged(e){let t=e.uiContainerHeight,i=t!=null?`${t}px`:"";this.eContainer.style.height=i,this.eViewport&&(this.eViewport.style.height=i)}},Hh=e=>e.topRowCtrls,Gh=e=>e.getStickyTopRowCtrls(),Vh=e=>e.getStickyBottomRowCtrls(),zh=e=>e.bottomRowCtrls,Wh=e=>e.allRowCtrls,Z0=e=>e.getCtrls("top"),eC=e=>e.getCtrls("center"),tC=e=>e.getCtrls("bottom"),xH={center:{type:"center",name:"center-cols",getRowCtrls:Wh,getSpannedRowCtrls:eC},left:{type:"left",name:"pinned-left-cols",pinnedType:"left",getRowCtrls:Wh,getSpannedRowCtrls:eC},right:{type:"right",name:"pinned-right-cols",pinnedType:"right",getRowCtrls:Wh,getSpannedRowCtrls:eC},fullWidth:{type:"fullWidth",name:"full-width",fullWidth:!0,getRowCtrls:Wh},topCenter:{type:"center",name:"floating-top",getRowCtrls:Hh,getSpannedRowCtrls:Z0},topLeft:{type:"left",name:"pinned-left-floating",container:"ag-pinned-left-floating-top",pinnedType:"left",getRowCtrls:Hh,getSpannedRowCtrls:Z0},topRight:{type:"right",name:"pinned-right-floating",container:"ag-pinned-right-floating-top",pinnedType:"right",getRowCtrls:Hh,getSpannedRowCtrls:Z0},topFullWidth:{type:"fullWidth",name:"floating-top-full-width",fullWidth:!0,getRowCtrls:Hh},stickyTopCenter:{type:"center",name:"sticky-top",getRowCtrls:Gh},stickyTopLeft:{type:"left",name:"pinned-left-sticky-top",container:"ag-pinned-left-sticky-top",pinnedType:"left",getRowCtrls:Gh},stickyTopRight:{type:"right",name:"pinned-right-sticky-top",container:"ag-pinned-right-sticky-top",pinnedType:"right",getRowCtrls:Gh},stickyTopFullWidth:{type:"fullWidth",name:"sticky-top-full-width",fullWidth:!0,getRowCtrls:Gh},stickyBottomCenter:{type:"center",name:"sticky-bottom",getRowCtrls:Vh},stickyBottomLeft:{type:"left",name:"pinned-left-sticky-bottom",container:"ag-pinned-left-sticky-bottom",pinnedType:"left",getRowCtrls:Vh},stickyBottomRight:{type:"right",name:"pinned-right-sticky-bottom",container:"ag-pinned-right-sticky-bottom",pinnedType:"right",getRowCtrls:Vh},stickyBottomFullWidth:{type:"fullWidth",name:"sticky-bottom-full-width",fullWidth:!0,getRowCtrls:Vh},bottomCenter:{type:"center",name:"floating-bottom",getRowCtrls:zh,getSpannedRowCtrls:tC},bottomLeft:{type:"left",name:"pinned-left-floating-bottom",container:"ag-pinned-left-floating-bottom",pinnedType:"left",getRowCtrls:zh,getSpannedRowCtrls:tC},bottomRight:{type:"right",name:"pinned-right-floating-bottom",container:"ag-pinned-right-floating-bottom",pinnedType:"right",getRowCtrls:zh,getSpannedRowCtrls:tC},bottomFullWidth:{type:"fullWidth",name:"floating-bottom-full-width",fullWidth:!0,getRowCtrls:zh}};function b4(e){return`ag-${bd(e).name}-viewport`}function ep(e){let t=bd(e);return t.container??`ag-${t.name}-container`}function EH(e){return`ag-${bd(e).name}-spanned-cells-container`}function bd(e){return xH[e]}var RH=["topCenter","topLeft","topRight"],PH=["bottomCenter","bottomLeft","bottomRight"],MH=["center","left","right"],kH=["center","left","right","fullWidth"],DH=["stickyTopCenter","stickyBottomCenter","center","topCenter","bottomCenter"],FH=["left","bottomLeft","topLeft","stickyTopLeft","stickyBottomLeft"],TH=["right","bottomRight","topRight","stickyTopRight","stickyBottomRight"],y4=["stickyTopCenter","stickyTopLeft","stickyTopRight"],S4=["stickyBottomCenter","stickyBottomLeft","stickyBottomRight"],AH=[...y4,"stickyTopFullWidth",...S4,"stickyBottomFullWidth"],IH=[...RH,...PH,...MH,...y4,...S4],LH=class extends D{constructor(e){super(),this.name=e,this.visible=!0,this.EMPTY_CTRLS=[],this.options=bd(e)}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.forContainers(["center"],()=>{this.viewportSizeFeature=this.createManagedBean(new uH(this)),this.addManagedEventListeners({stickyTopOffsetChanged:this.onStickyTopOffsetChanged.bind(this)})})}onStickyTopOffsetChanged(e){this.comp.setOffsetTop(`${e.offset}px`)}registerWithCtrlsService(){this.options.fullWidth||this.beans.ctrlsSvc.register(this.name,this)}forContainers(e,t){e.indexOf(this.name)>=0&&t()}setComp(e,t,i,n){this.comp=e,this.eContainer=t,this.eSpannedContainer=i,this.eViewport=n,this.createManagedBean(new SH(this.eViewport??this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder();let{pinnedCols:o,rangeSvc:s}=this.beans,r=()=>this.onPinnedWidthChanged();this.forContainers(FH,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(o?.createPinnedWidthFeature(!0,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({leftPinnedWidthChanged:r})}),this.forContainers(TH,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(o?.createPinnedWidthFeature(!1,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({rightPinnedWidthChanged:r})}),this.forContainers(kH,()=>this.createManagedBean(new w4(this.eContainer,this.name==="center"?n:void 0))),s&&this.forContainers(IH,()=>this.createManagedBean(s.createDragListenerFeature(this.eContainer))),this.forContainers(DH,()=>this.createManagedBean(new Rv(a=>this.comp.setContainerWidth(`${a}px`)))),this.visible=this.isContainerVisible(),this.addListeners(),this.registerWithCtrlsService()}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}addListeners(){let{spannedRowRenderer:e,gos:t}=this.beans,i=this.onDisplayedColumnsChanged.bind(this);this.addManagedEventListeners({displayedColumnsChanged:i,displayedColumnsWidthChanged:i,displayedRowsChanged:n=>this.onDisplayedRowsChanged(n.afterScroll)}),i(),this.onDisplayedRowsChanged(),e&&this.options.getSpannedRowCtrls&&t.get("enableCellSpan")&&this.addManagedListeners(e,{spannedRowsUpdated:()=>{let n=this.options.getSpannedRowCtrls(e);n&&this.comp.setSpannedRowCtrls(n,!1)}})}listenOnDomOrder(){if(AH.indexOf(this.name)>=0){this.comp.setDomOrder(!0);return}let t=()=>{let i=this.gos.get("ensureDomOrder"),n=Nt(this.gos,"print");this.comp.setDomOrder(i||n)};this.addManagedPropertyListener("domLayout",t),t()}onDisplayedColumnsChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}addPreventScrollWhileDragging(){let{dragSvc:e}=this.beans;if(!e)return;let t=i=>{e.dragging&&i.cancelable&&i.preventDefault()};this.eContainer.addEventListener("touchmove",t,{passive:!1}),this.addDestroyFunc(()=>this.eContainer.removeEventListener("touchmove",t))}onHorizontalViewportChanged(e=!1){let t=this.getCenterWidth(),i=this.getCenterViewportScrollLeft();this.beans.colViewport.setScrollPosition(t,i,e)}hasHorizontalScrollGap(){return this.eContainer.clientWidth-this.eViewport.clientWidth<0}hasVerticalScrollGap(){return this.eContainer.clientHeight-this.eViewport.clientHeight<0}getCenterWidth(){return rd(this.eViewport)}getCenterViewportScrollLeft(){return ap(this.eViewport,this.enableRtl)}registerViewportResizeListener(e){let t=Qo(this.beans,this.eViewport,e);this.addDestroyFunc(()=>t())}isViewportInTheDOMTree(){return XR(this.eViewport)}getViewportScrollLeft(){return ap(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gos.get("alwaysShowHorizontalScroll")||nv(this.eViewport)}setHorizontalScroll(e){this.comp.setHorizontalScroll(e)}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(e){lp(this.eViewport,e,this.enableRtl)}isContainerVisible(){return!(this.options.pinnedType!=null)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){let e=this.isContainerVisible();this.visible!=e&&(this.visible=e,this.onDisplayedRowsChanged())}onDisplayedRowsChanged(e=!1){let t=this.options.getRowCtrls(this.beans.rowRenderer);if(!this.visible||t.length===0){this.comp.setRowCtrls({rowCtrls:this.EMPTY_CTRLS});return}let i=Nt(this.gos,"print"),o=this.gos.get("embedFullWidthRows")||i,s=t.filter(r=>{let a=r.isFullWidth();return this.options.fullWidth?!o&&a:o||!a});this.comp.setRowCtrls({rowCtrls:s,useFlushSync:e})}},x4="ag-force-vertical-scroll",_H="ag-selectable",OH="ag-column-moving",NH=class extends D{constructor(){super(...arguments),this.stickyTopHeight=0,this.stickyBottomHeight=0}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colModel=e.colModel,this.scrollVisibleSvc=e.scrollVisibleSvc,this.pinnedRowModel=e.pinnedRowModel,this.filterManager=e.filterManager,this.rowGroupColsSvc=e.rowGroupColsSvc}setComp(e,t,i,n,o,s,r){this.comp=e,this.eGridBody=t,this.eBodyViewport=i,this.eTop=n,this.eBottom=o,this.eStickyTop=s,this.eStickyBottom=r,this.eCenterColsViewport=i.querySelector(`.${b4("center")}`),this.eFullWidthContainer=i.querySelector(`.${ep("fullWidth")}`),this.eStickyTopFullWidthContainer=s.querySelector(`.${ep("stickyTopFullWidth")}`),this.eStickyBottomFullWidthContainer=r.querySelector(`.${ep("stickyBottomFullWidth")}`),this.setCellTextSelection(this.gos.get("enableCellTextSelection")),this.addManagedPropertyListener("enableCellTextSelection",a=>this.setCellTextSelection(a.currentValue)),this.createManagedBean(new Ev(this.comp)),this.scrollFeature=this.createManagedBean(new cH(i)),this.beans.rowDragSvc?.setupRowDrag(i,this),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([n,i,o,s,r]),this.setGridRootRole(),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.updateScrollingClasses(),this.filterManager?.setupAdvFilterHeaderComp(n),this.ctrlsSvc.register("gridBodyCtrl",this)}addEventListeners(){let e=this.setFloatingHeights.bind(this),t=this.setGridRootRole.bind(this),i=this.toggleRowResizeStyles.bind(this);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this),scrollGapChanged:this.updateScrollingClasses.bind(this),pinnedRowDataChanged:e,pinnedHeightChanged:e,pinnedRowsChanged:e,headerHeightChanged:this.setStickyTopOffsetTop.bind(this),columnRowGroupChanged:t,columnPivotChanged:t,rowResizeStarted:i,rowResizeEnded:i}),this.addManagedPropertyListener("treeData",t)}toggleRowResizeStyles(e){let t=e.type==="rowResizeStarted";this.eBodyViewport.classList.toggle("ag-prevent-animation",t)}onGridColumnsChanged(){let e=this.beans.colModel.getCols();this.comp.setColumnCount(e.length)}onScrollVisibilityChanged(){let{scrollVisibleSvc:e}=this,t=e.verticalScrollShowing;this.setVerticalScrollPaddingVisible(t),this.setStickyWidth(t),this.setStickyBottomOffsetBottom();let i=t&&e.getScrollbarWidth()||0,n=j6()?16:0,o=`calc(100% + ${i+n}px)`;po(this.beans,()=>this.comp.setBodyViewportWidth(o)),this.updateScrollingClasses()}setGridRootRole(){let{rowGroupColsSvc:e,colModel:t}=this,i=this.gos.get("treeData");if(!i){let n=t.isPivotMode();i=(e?e.columns.length:0)>=(n?2:1)}this.comp.setGridRootRole(i?"treegrid":"grid")}addFocusListeners(e){for(let t of e)this.addManagedElementListeners(t,{focusin:i=>{let{target:n}=i,o=Hs(n,"ag-root",t);t.classList.toggle("ag-has-focus",!o)},focusout:i=>{let{target:n,relatedTarget:o}=i,s=t.contains(o),r=Hs(o,"ag-root",t);Hs(n,"ag-root",t)||(!s||r)&&t.classList.remove("ag-has-focus")}})}setColumnMovingCss(e){this.comp.setColumnMovingCss(OH,e)}setCellTextSelection(e=!1){this.comp.setCellSelectableCss(_H,e)}updateScrollingClasses(){let{eGridBody:{classList:e},scrollVisibleSvc:t}=this;e.toggle("ag-body-vertical-content-no-gap",!t.verticalScrollGap),e.toggle("ag-body-horizontal-content-no-gap",!t.horizontalScrollGap)}disableBrowserDragging(){this.addManagedElementListeners(this.eGridBody,{dragstart:e=>{if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1}})}addStopEditingWhenGridLosesFocus(){this.beans.editSvc?.addStopEditingWhenGridLosesFocus([this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop,this.eStickyBottom])}updateRowCount(){let e=(this.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0)+(this.filterManager?.getHeaderRowCount()??0),{rowModel:t}=this.beans,i=t.isLastRowIndexKnown()?t.getRowCount():-1,n=i===-1?-1:e+i;this.comp.setRowCount(n)}registerBodyViewportResizeListener(e){this.comp.registerBodyViewportResizeListener(e)}setVerticalScrollPaddingVisible(e){let t=e?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(t)}isVerticalScrollShowing(){let e=this.gos.get("alwaysShowVerticalScroll"),t=e?x4:null,i=Nt(this.gos,"normal");return this.comp.setAlwaysVerticalScrollClass(t,e),e||i&&ZR(this.eBodyViewport)}setupRowAnimationCssClass(){let{rowContainerHeight:e,environment:t}=this.beans,i=t.sizesMeasured,n=()=>{let o=i&&la(this.gos)&&!e.stretching,s=o?"ag-row-animation":"ag-row-no-animation";this.comp.setRowAnimationCssOnBodyViewport(s,o)};n(),this.addManagedEventListeners({heightScaleChanged:n}),this.addManagedPropertyListener("animateRows",n),this.addManagedEventListeners({gridStylesChanged:()=>{!i&&t.sizesMeasured&&(i=!0,n())}})}addBodyViewportListener(){let{eBodyViewport:e,eStickyTop:t,eStickyBottom:i,eTop:n,eBottom:o,beans:{popupSvc:s,touchSvc:r}}=this,a=this.onBodyViewportContextMenu.bind(this);this.addManagedElementListeners(e,{contextmenu:a}),r?.mockBodyContextMenu(this,a),this.addManagedElementListeners(e,{wheel:this.onBodyViewportWheel.bind(this,s)});let l=this.onStickyWheel.bind(this);for(let c of[t,i,n,o])this.addManagedElementListeners(c,{wheel:l});let d=this.onHorizontalWheel.bind(this);for(let c of["left","right","topLeft","topRight","bottomLeft","bottomRight"])this.addManagedElementListeners(this.ctrlsSvc.get(c).eContainer,{wheel:d});this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){this.addManagedElementListeners(this.eFullWidthContainer,{wheel:e=>this.onFullWidthContainerWheel(e)})}onFullWidthContainerWheel(e){let{deltaX:t,deltaY:i,shiftKey:n}=e;(n||Math.abs(t)>Math.abs(i))&&ad(this.beans,e)&&this.scrollGridBodyToMatchEvent(e)}onStickyWheel(e){let{deltaY:t}=e;this.scrollVertically(t)>0&&e.preventDefault()}onHorizontalWheel(e){let{deltaX:t,deltaY:i,shiftKey:n}=e;(n||Math.abs(t)>Math.abs(i))&&this.scrollGridBodyToMatchEvent(e)}scrollGridBodyToMatchEvent(e){let{deltaX:t,deltaY:i}=e;e.preventDefault(),this.eCenterColsViewport.scrollBy({left:t||i})}onBodyViewportContextMenu(e,t,i){if(!e&&!i)return;this.gos.get("preventDefaultOnContextMenu")&&(e||i).preventDefault();let{target:n}=e||t;(n===this.eBodyViewport||n===this.ctrlsSvc.get("center").eViewport)&&this.beans.contextMenuSvc?.showContextMenu({mouseEvent:e,touchEvent:i,value:null,anchorToElement:this.eGridBody,source:"ui"})}onBodyViewportWheel(e,t){this.gos.get("suppressScrollWhenPopupsAreOpen")&&e?.hasAnchoredPopup()&&t.preventDefault()}scrollVertically(e){let t=this.eBodyViewport.scrollTop;return this.scrollFeature.setVerticalScrollPosition(t+e),this.eBodyViewport.scrollTop-t}setFloatingHeights(){let{pinnedRowModel:e,beans:{environment:t}}=this,i=e?.getPinnedTopTotalHeight(),n=e?.getPinnedBottomTotalHeight(),o=t.getPinnedRowBorderWidth(),s=t.getRowBorderWidth(),r=o-s,a=i?r+i:0,l=n?r+n:0;this.comp.setTopHeight(a),this.comp.setBottomHeight(l),this.comp.setTopInvisible(a<=0),this.comp.setBottomInvisible(l<=0),this.setStickyTopOffsetTop(),this.setStickyBottomOffsetBottom()}setStickyTopHeight(e=0){this.comp.setStickyTopHeight(`${e}px`),this.stickyTopHeight=e}setStickyBottomHeight(e=0){this.comp.setStickyBottomHeight(`${e}px`),this.stickyBottomHeight=e}setStickyWidth(e){if(!e)this.comp.setStickyTopWidth("100%"),this.comp.setStickyBottomWidth("100%");else{let t=this.scrollVisibleSvc.getScrollbarWidth();this.comp.setStickyTopWidth(`calc(100% - ${t}px)`),this.comp.setStickyBottomWidth(`calc(100% - ${t}px)`)}}setStickyTopOffsetTop(){let t=this.ctrlsSvc.get("gridHeaderCtrl").headerHeight+(this.filterManager?.getHeaderHeight()??0),i=this.pinnedRowModel?.getPinnedTopTotalHeight()??0,n=0;t>0&&(n+=t),i>0&&(n+=i),n>0&&(n+=1),this.comp.setStickyTopTop(`${n}px`)}setStickyBottomOffsetBottom(){let{pinnedRowModel:e,scrollVisibleSvc:t,comp:i}=this,n=e?.getPinnedBottomTotalHeight()??0,s=t.horizontalScrollShowing&&t.getScrollbarWidth()||0,r=n+s;i.setStickyBottomBottom(`${r}px`)}};function BH(e,t){return Pv(e,t.target)?.getFocusedCellPosition()??null}function jE(e,t){let i=Nt(e.gos,"normal"),n=t,o,s;n.clientX!=null||n.clientY!=null?(o=n.clientX,s=n.clientY):(o=n.x,s=n.y);let{pageFirstPixel:r}=e.pageBounds.getCurrentPagePixelRange();if(s+=r,i){let a=e.ctrlsSvc.getScrollFeature(),l=a.getVScrollPosition(),d=a.getHScrollPosition();o+=d.left,s+=l.top}return{x:o,y:s}}var E4=class extends Oe{constructor(e,t){super(),this.direction=t,this.eViewport=V,this.eContainer=V,this.hideTimeout=0,this.setTemplate(e)}postConstruct(){this.addManagedEventListeners({scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this)}),this.onScrollVisibilityChanged(),this.toggleCss("ag-apple-scrollbar",q6()||zs())}destroy(){super.destroy(),window.clearTimeout(this.hideTimeout)}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.invisibleScrollbar=j6(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){let e=this.getGui(),t=()=>this.toggleCss("ag-scrollbar-active",!0),i=()=>this.toggleCss("ag-scrollbar-active",!1);this.addManagedListeners(e,{mouseenter:t,mousedown:t,touchstart:t,mouseleave:i,touchend:i})}onScrollVisibilityChanged(){this.invisibleScrollbar===void 0&&this.initialiseInvisibleScrollbar(),po(this.beans,()=>this.setScrollVisible())}hideAndShowInvisibleScrollAsNeeded(){this.addManagedEventListeners({bodyScroll:e=>{e.direction===this.direction&&(this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=0),this.toggleCss("ag-scrollbar-scrolling",!0))},bodyScrollEnd:()=>{this.hideTimeout=window.setTimeout(()=>{this.toggleCss("ag-scrollbar-scrolling",!1),this.hideTimeout=0},400)}})}attemptSettingScrollPosition(e){let t=this.eViewport;z_(this,()=>Pn(t),()=>this.setScrollPosition(e),100)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}},HH={tag:"div",cls:"ag-body-horizontal-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eLeftSpacer",cls:"ag-horizontal-left-spacer"},{tag:"div",ref:"eViewport",cls:"ag-body-horizontal-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-horizontal-scroll-container"}]},{tag:"div",ref:"eRightSpacer",cls:"ag-horizontal-right-spacer"}]},GH=class extends E4{constructor(){super(HH,"horizontal"),this.eLeftSpacer=V,this.eRightSpacer=V,this.setScrollVisibleDebounce=0}wireBeans(e){this.visibleCols=e.visibleCols,this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){super.postConstruct();let e=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e,pinnedRowDataChanged:this.refreshCompBottom.bind(this)}),this.addManagedPropertyListener("domLayout",e),this.beans.ctrlsSvc.register("fakeHScrollComp",this),this.createManagedBean(new Rv(t=>this.eContainer.style.width=`${t}px`)),this.addManagedPropertyListeners(["suppressHorizontalScroll"],this.onScrollVisibilityChanged.bind(this))}destroy(){window.clearTimeout(this.setScrollVisibleDebounce),super.destroy()}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.enableRtl=this.gos.get("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}refreshCompBottom(){if(!this.invisibleScrollbar)return;let e=this.beans.pinnedRowModel?.getPinnedBottomTotalHeight()??0;this.getGui().style.bottom=`${e}px`}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){let e=this.scrollVisibleSvc.verticalScrollShowing,t=this.visibleCols.getDisplayedColumnsRightWidth(),i=!this.enableRtl&&e,n=this.scrollVisibleSvc.getScrollbarWidth();i&&(t+=n),xn(this.eRightSpacer,t),this.eRightSpacer.classList.toggle("ag-scroller-corner",t<=n);let o=this.visibleCols.getColsLeftWidth();this.enableRtl&&e&&(o+=n),xn(this.eLeftSpacer,o),this.eLeftSpacer.classList.toggle("ag-scroller-corner",o<=n)}setScrollVisible(){let e=this.scrollVisibleSvc.horizontalScrollShowing,t=this.invisibleScrollbar,i=this.gos.get("suppressHorizontalScroll"),n=e&&this.scrollVisibleSvc.getScrollbarWidth()||0,s=i?0:n===0&&t?16:n,r=()=>{this.setScrollVisibleDebounce=0,this.toggleCss("ag-scrollbar-invisible",t),Yl(this.getGui(),s),Yl(this.eViewport,s),Yl(this.eContainer,s),s||this.eContainer.style.setProperty("min-height","1px"),this.setVisible(e,{skipAriaHidden:!0})};window.clearTimeout(this.setScrollVisibleDebounce),e?this.setScrollVisibleDebounce=window.setTimeout(r,100):r()}getScrollPosition(){return ap(this.eViewport,this.enableRtl)}setScrollPosition(e){Pn(this.eViewport)||this.attemptSettingScrollPosition(e),lp(this.eViewport,e,this.enableRtl)}},VH={selector:"AG-FAKE-HORIZONTAL-SCROLL",component:GH},zH={tag:"div",cls:"ag-body-vertical-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eViewport",cls:"ag-body-vertical-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-vertical-scroll-container"}]}]},WH=class extends E4{constructor(){super(zH,"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new w4(this.eContainer));let{ctrlsSvc:e}=this.beans;e.register("fakeVScrollComp",this),this.addManagedEventListeners({rowContainerHeightChanged:this.onRowContainerHeightChanged.bind(this,e)})}setScrollVisible(){let{scrollVisibleSvc:e}=this.beans,t=e.verticalScrollShowing,i=this.invisibleScrollbar,n=t&&e.getScrollbarWidth()||0,o=n===0&&i?16:n;this.toggleCss("ag-scrollbar-invisible",i),xn(this.getGui(),o),xn(this.eViewport,o),xn(this.eContainer,o),this.setDisplayed(t,{skipAriaHidden:!0})}onRowContainerHeightChanged(e){let i=e.getGridBodyCtrl().eBodyViewport,n=this.getScrollPosition(),o=i.scrollTop;n!=o&&this.setScrollPosition(o,!0)}getScrollPosition(){return this.eViewport.scrollTop}setScrollPosition(e,t){!t&&!Pn(this.eViewport)&&this.attemptSettingScrollPosition(e),this.eViewport.scrollTop=e}},UH={selector:"AG-FAKE-VERTICAL-SCROLL",component:WH},qH="ag-column-first",$H="ag-column-last";function R4(e,t,i,n){return Qe(e)?[]:KH(e.headerClass,e,t,i,n)}function P4(e,t,i){e.toggleCss(qH,i.isColAtEdge(t,"first")),e.toggleCss($H,i.isColAtEdge(t,"last"))}function jH(e,t,i,n){return te(t,{colDef:e,column:i,columnGroup:n})}function KH(e,t,i,n,o){if(Qe(e))return[];let s;if(typeof e=="function"){let r=jH(t,i,n,o);s=e(r)}else s=e;return typeof s=="string"?[s]:Array.isArray(s)?[...s]:[]}function YH(e,t,i){t.addManagedElementListeners(i,{keydown:n=>{if(!n.defaultPrevented&&n.key===R.TAB){let o=n.shiftKey;Qs(e,i,!1,o)||ba(e,o)&&n.preventDefault()}}})}function XH(e,t){return e.ctrlsSvc.get("gridCtrl").focusInnerElement(t)}function Ws(e){return e.gos.get("suppressHeaderFocus")||!!e.overlays?.isExclusive()}function Ip(e){return e.gos.get("suppressCellFocus")||!!e.overlays?.isExclusive()}function ba(e,t,i=!1){let n=e.ctrlsSvc.get("gridCtrl");return!i&&n.focusNextInnerContainer(t)?!0:((i||!t&&!n.isDetailGrid())&&n.forceFocusOutOfContainer(t),!1)}function Sn(e){return e.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0}function Mv(e){let t=[],i=e.ctrlsSvc.getHeaderRowContainerCtrls();for(let n of i){if(!n)continue;let o=n.getGroupRowCount()||0;for(let s=0;s<o;s++){let r=n.getGroupRowCtrlAtIndex(s),a=t[s];if(r){let l=JH(e,r);(a==null||l>a)&&(t[s]=l)}}}return t}function JH(e,t){let n=e.colModel.isPivotMode()?ZH(e):k4(e),o=t.getHeaderCellCtrls();for(let s of o){let{column:r}=s,a=r.getAutoHeaderHeight();a!=null&&a>n&&r.isAutoHeaderHeight()&&(n=a)}return n}function kv(e){let i=e.colModel.isPivotMode()?QH(e):yd(e);return e.colModel.forAllCols(n=>{let o=n.getAutoHeaderHeight();o!=null&&o>i&&n.isAutoHeaderHeight()&&(i=o)}),i}function yd(e){return e.gos.get("headerHeight")??e.environment.getDefaultHeaderHeight()}function M4(e){return e.gos.get("floatingFiltersHeight")??yd(e)}function k4(e){return e.gos.get("groupHeaderHeight")??yd(e)}function QH(e){return e.gos.get("pivotHeaderHeight")??yd(e)}function ZH(e){return e.gos.get("pivotGroupHeaderHeight")??k4(e)}function eG(e,t){return e.headerRowIndex===t.headerRowIndex&&e.column===t.column}var tG=class extends D{setComp(e,t,i){this.comp=e,this.eGui=t;let{beans:n}=this,{headerNavigation:o,touchSvc:s,ctrlsSvc:r}=n;o&&this.createManagedBean(new Ea(i,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedEventListeners({columnPivotModeChanged:this.onPivotModeChanged.bind(this,n),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this,n)}),this.onPivotModeChanged(n),this.setupHeaderHeight();let a=this.onHeaderContextMenu.bind(this);this.addManagedElementListeners(this.eGui,{contextmenu:a}),s?.mockHeaderContextMenu(this,a),r.register("gridHeaderCtrl",this)}setupHeaderHeight(){let e=this.setHeaderHeight.bind(this);e(),this.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],e),this.addManagedEventListeners({headerRowsChanged:e,columnHeaderHeightChanged:e,columnGroupHeaderHeightChanged:()=>po(this.beans,()=>e()),gridStylesChanged:e,advancedFilterEnabledChanged:e})}setHeaderHeight(){let{beans:e}=this,t=0,i=Mv(e).reduce((s,r)=>s+r,0),n=kv(e);if(e.filterManager?.hasFloatingFilters()&&(t+=M4(e)),t+=i,t+=n,this.headerHeight===t)return;this.headerHeight=t;let o=`${t+1}px`;this.comp.setHeightAndMinHeight(o),this.eventSvc.dispatchEvent({type:"headerHeightChanged"})}onPivotModeChanged(e){let t=e.colModel.isPivotMode();this.comp.toggleCss("ag-pivot-on",t),this.comp.toggleCss("ag-pivot-off",!t)}onDisplayedColumnsChanged(e){let i=e.visibleCols.allCols.some(n=>n.isSpanHeaderHeight());this.comp.toggleCss("ag-header-allow-overflow",i)}onTabKeyDown(e){let t=this.gos.get("enableRtl"),i=e.shiftKey,n=i!==t?"LEFT":"RIGHT",{beans:o}=this,{headerNavigation:s,focusSvc:r}=o;(s.navigateHorizontally(n,!0,e)||!i&&r.focusOverlay(!1)||ba(o,i,!0))&&e.preventDefault()}handleKeyDown(e){let t=null,{headerNavigation:i}=this.beans;switch(e.key){case R.LEFT:t="LEFT";case R.RIGHT:{q(t)||(t="RIGHT"),i.navigateHorizontally(t,!1,e)&&e.preventDefault();break}case R.UP:t="UP";case R.DOWN:{q(t)||(t="DOWN"),i.navigateVertically(t,e)&&e.preventDefault();break}default:return}}onFocusOut(e){let{relatedTarget:t}=e,{eGui:i,beans:n}=this;!t&&i.contains(tt(n))||i.contains(t)||(n.focusSvc.focusedHeader=null)}onHeaderContextMenu(e,t,i){let{menuSvc:n,ctrlsSvc:o}=this.beans;if(!e&&!i||!n?.isHeaderContextMenuEnabled())return;let{target:s}=e??t;(s===this.eGui||s===o.getHeaderRowContainerCtrl()?.eViewport)&&n.showHeaderContextMenu(void 0,e,i)}},Dv=class extends Oe{constructor(e,t){super(e),this.ctrl=t}getCtrl(){return this.ctrl}},iG={tag:"div",cls:"ag-header-cell",role:"columnheader",children:[{tag:"div",ref:"eResize",cls:"ag-header-cell-resize",role:"presentation"},{tag:"div",ref:"eHeaderCompWrapper",cls:"ag-header-cell-comp-wrapper",role:"presentation"}]},nG=class extends Dv{constructor(e){super(iG,e),this.eResize=V,this.eHeaderCompWrapper=V,this.headerCompVersion=0}postConstruct(){let e=this.getGui(),t=()=>{let n=this.ctrl.getSelectAllGui();n&&(this.eResize.insertAdjacentElement("afterend",n),this.addDestroyFunc(()=>n.remove()))},i={setWidth:n=>e.style.width=n,toggleCss:(n,o)=>this.toggleCss(n,o),setUserStyles:n=>md(e,n),setAriaSort:n=>n?w_(e,n):b_(e),setUserCompDetails:n=>this.setUserCompDetails(n),getUserCompInstance:()=>this.headerComp,refreshSelectAllGui:t,removeSelectAllGui:()=>this.ctrl.getSelectAllGui()?.remove()};this.ctrl.setComp(i,this.getGui(),this.eResize,this.eHeaderCompWrapper,void 0),t()}destroy(){this.destroyHeaderComp(),super.destroy()}destroyHeaderComp(){this.headerComp&&(this.headerCompGui?.remove(),this.headerComp=this.destroyBean(this.headerComp),this.headerCompGui=void 0)}setUserCompDetails(e){this.headerCompVersion++;let t=this.headerCompVersion;e.newAgStackInstance().then(i=>this.afterCompCreated(t,i))}afterCompCreated(e,t){if(e!=this.headerCompVersion||!this.isAlive()){this.destroyBean(t);return}this.destroyHeaderComp(),this.headerComp=t,this.headerCompGui=t.getGui(),this.eHeaderCompWrapper.appendChild(this.headerCompGui),this.ctrl.setDragSource(this.getGui())}},oG={tag:"div",cls:"ag-header-group-cell",role:"columnheader",children:[{tag:"div",ref:"eHeaderCompWrapper",cls:"ag-header-cell-comp-wrapper",role:"presentation"},{tag:"div",ref:"eResize",cls:"ag-header-cell-resize",role:"presentation"}]},sG=class extends Dv{constructor(e){super(oG,e),this.eResize=V,this.eHeaderCompWrapper=V}postConstruct(){let e=this.getGui(),t=(n,o)=>o!=null?e.setAttribute(n,o):e.removeAttribute(n),i={toggleCss:(n,o)=>this.toggleCss(n,o),setUserStyles:n=>md(e,n),setHeaderWrapperHidden:n=>{n?this.eHeaderCompWrapper.style.setProperty("display","none"):this.eHeaderCompWrapper.style.removeProperty("display")},setHeaderWrapperMaxHeight:n=>{n!=null?this.eHeaderCompWrapper.style.setProperty("max-height",`${n}px`):this.eHeaderCompWrapper.style.removeProperty("max-height"),this.eHeaderCompWrapper.classList.toggle("ag-header-cell-comp-wrapper-limited-height",n!=null)},setResizableDisplayed:n=>Je(this.eResize,n),setWidth:n=>e.style.width=n,setAriaExpanded:n=>t("aria-expanded",n),setUserCompDetails:n=>this.setUserCompDetails(n),getUserCompInstance:()=>this.headerGroupComp};this.ctrl.setComp(i,e,this.eResize,this.eHeaderCompWrapper,void 0)}setUserCompDetails(e){e.newAgStackInstance().then(t=>this.afterHeaderCompCreated(t))}afterHeaderCompCreated(e){let t=()=>this.destroyBean(e);if(!this.isAlive()){t();return}let i=this.getGui(),n=e.getGui();this.eHeaderCompWrapper.appendChild(n),this.addDestroyFunc(t),this.headerGroupComp=e,this.ctrl.setDragSource(i)}},rG={tag:"div",cls:"ag-header-cell ag-floating-filter",role:"gridcell",children:[{tag:"div",ref:"eFloatingFilterBody",role:"presentation"},{tag:"div",ref:"eButtonWrapper",cls:"ag-floating-filter-button ag-hidden",role:"presentation",children:[{tag:"button",ref:"eButtonShowMainFilter",cls:"ag-button ag-floating-filter-button-button",attrs:{type:"button",tabindex:"-1"}}]}]},aG=class extends Dv{constructor(e){super(rG,e),this.eFloatingFilterBody=V,this.eButtonWrapper=V,this.eButtonShowMainFilter=V}postConstruct(){let e=this.getGui(),t={toggleCss:(i,n)=>this.toggleCss(i,n),setUserStyles:i=>md(e,i),addOrRemoveBodyCssClass:(i,n)=>this.eFloatingFilterBody.classList.toggle(i,n),setButtonWrapperDisplayed:i=>Je(this.eButtonWrapper,i),setCompDetails:i=>this.setCompDetails(i),getFloatingFilterComp:()=>this.compPromise,setWidth:i=>e.style.width=i,setMenuIcon:i=>this.eButtonShowMainFilter.appendChild(i)};this.ctrl.setComp(t,e,this.eButtonShowMainFilter,this.eFloatingFilterBody,void 0)}setCompDetails(e){if(!e){this.destroyFloatingFilterComp(),this.compPromise=null;return}this.compPromise=e.newAgStackInstance(),this.compPromise.then(t=>this.afterCompCreated(t))}destroy(){this.destroyFloatingFilterComp(),super.destroy()}destroyFloatingFilterComp(){this.floatingFilterComp&&(this.floatingFilterComp.getGui().remove(),this.floatingFilterComp=this.destroyBean(this.floatingFilterComp))}afterCompCreated(e){if(e){if(!this.isAlive()){this.destroyBean(e);return}this.destroyFloatingFilterComp(),this.floatingFilterComp=e,this.eFloatingFilterBody.appendChild(e.getGui()),e.afterGuiAttached&&e.afterGuiAttached()}}},lG=class extends Oe{constructor(e){super({tag:"div",cls:e.headerRowClass,role:"row"}),this.ctrl=e,this.headerComps={}}postConstruct(){this.getGui().setAttribute("tabindex",String(this.gos.get("tabIndex"))),sp(this.getGui(),this.ctrl.getAriaRowIndex());let t={setHeight:i=>this.getGui().style.height=i,setTop:i=>this.getGui().style.top=i,setHeaderCtrls:(i,n)=>this.setHeaderCtrls(i,n),setWidth:i=>this.getGui().style.width=i,setRowIndex:i=>sp(this.getGui(),i)};this.ctrl.setComp(t,void 0)}destroy(){this.setHeaderCtrls([],!1),super.destroy()}setHeaderCtrls(e,t){if(!this.isAlive())return;let i=this.headerComps;this.headerComps={};for(let n of e){let o=n.instanceId,s=i[o];delete i[o],s==null&&(s=this.createHeaderComp(n),this.getGui().appendChild(s.getGui())),this.headerComps[o]=s}if(Object.values(i).forEach(n=>{n.getGui().remove(),this.destroyBean(n)}),t){let n=Object.values(this.headerComps);n.sort((s,r)=>{let a=s.getCtrl().column.getLeft(),l=r.getCtrl().column.getLeft();return a-l});let o=n.map(s=>s.getGui());QR(this.getGui(),o)}}createHeaderComp(e){let t;switch(this.ctrl.type){case"group":t=new sG(e);break;case"filter":t=new aG(e);break;default:t=new nG(e);break}return this.createBean(t),t.setParentComponent(this),t}},Fv=class extends D{constructor(e,t,i,n){super(),this.columnOrGroup=e,this.eCell=t,this.colsSpanning=n,this.columnOrGroup=e,this.ariaEl=t.querySelector("[role=columnheader]")||t,this.beans=i}setColsSpanning(e){this.colsSpanning=e,this.onLeftChanged()}getColumnOrGroup(){let{beans:e,colsSpanning:t}=this;return e.gos.get("enableRtl")&&t?Ue(t):this.columnOrGroup}postConstruct(){let e=this.onLeftChanged.bind(this);this.addManagedListeners(this.columnOrGroup,{leftChanged:e}),this.setLeftFirstTime(),this.addManagedEventListeners({displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}setLeftFirstTime(){let{gos:e,colAnimation:t}=this.beans,i=e.get("suppressColumnMoveAnimation"),n=q(this.columnOrGroup.getOldLeft());t?.isActive()&&n&&!i?this.animateInLeft():this.onLeftChanged()}animateInLeft(){let e=this.getColumnOrGroup(),t=this.modifyLeftForPrintLayout(e,e.getOldLeft()),i=this.modifyLeftForPrintLayout(e,e.getLeft());this.setLeft(t),this.actualLeft=i,this.beans.colAnimation.executeNextVMTurn(()=>{this.actualLeft===i&&this.setLeft(i)})}onLeftChanged(){let e=this.getColumnOrGroup(),t=e.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(e,t),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(e,t){let{gos:i,visibleCols:n}=this.beans;if(!Nt(i,"print")||e.getPinned()==="left")return t;let s=n.getColsLeftWidth();if(e.getPinned()==="right"){let r=n.bodyWidth;return s+r+t}return s+t}setLeft(e){if(q(e)&&(this.eCell.style.left=`${e}px`),pt(this.columnOrGroup)){let t=this.columnOrGroup.getLeafColumns();if(!t.length)return;t.length>1&&v_(this.ariaEl,t.length)}}},dG=0,D4="headerCtrl",Tv=class extends D{constructor(e,t){super(),this.column=e,this.rowCtrl=t,this.resizeToggleTimeout=0,this.resizeMultiplier=1,this.resizeFeature=null,this.lastFocusEvent=null,this.dragSource=null,this.reAttemptToFocus=!1,this.instanceId=e.getUniqueId()+"-"+dG++}postConstruct(){let e=this.refreshTabIndex.bind(this);this.addManagedPropertyListeners(["suppressHeaderFocus"],e),this.addManagedEventListeners({overlayExclusiveChanged:e})}setComp(e,t,i,n,o){t.setAttribute("col-id",this.column.colIdSanitised),this.wireComp(e,t,i,n,o),this.reAttemptToFocus&&(this.reAttemptToFocus=!1,this.focus(this.lastFocusEvent??void 0))}shouldStopEventPropagation(e){let{headerRowIndex:t,column:i}=this.beans.focusSvc.focusedHeader,n=i.getDefinition(),o=n?.suppressHeaderKeyboardEvent;if(!q(o))return!1;let s=te(this.gos,{colDef:n,column:i,headerRowIndex:t,event:e});return!!o(s)}getWrapperHasFocus(){return tt(this.beans)===this.eGui}setGui(e,t){this.eGui=e,this.addDomData(t),t.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this)}),t.addManagedElementListeners(this.eGui,{focus:this.onGuiFocus.bind(this)}),this.onDisplayedColumnsChanged(),this.refreshTabIndex()}refreshHeaderStyles(){let e=this.column.getDefinition();if(!e)return;let{headerStyle:t}=e,i;if(typeof t=="function"){let n=this.getHeaderClassParams();i=t(n)}else i=t;i&&this.comp.setUserStyles(i)}onGuiFocus(){this.eventSvc.dispatchEvent({type:"headerFocused",column:this.column})}setupAutoHeight(e){let{wrapperElement:t,checkMeasuringCallback:i,compBean:n}=e,{beans:o}=this,s=u=>{if(!this.isAlive()||!n.isAlive())return;let{paddingTop:h,paddingBottom:p,borderBottomWidth:g,borderTopWidth:f}=Xs(this.eGui),m=h+p+g+f,v=t.offsetHeight+m;if(u<5){let y=!kt(o)?.contains(t),S=v==0;if(y||S){yC(()=>s(u+1),"raf",o);return}}this.setColHeaderHeight(this.column,v)},r=!1,a,l=()=>{let u=this.column.isAutoHeaderHeight();u&&!r&&d(),!u&&r&&c()},d=()=>{r=!0,this.comp.toggleCss("ag-header-cell-auto-height",!0),s(0),a=Qo(this.beans,t,()=>s(0))},c=()=>{r=!1,a&&a(),this.comp.toggleCss("ag-header-cell-auto-height",!1),a=void 0};l(),n.addDestroyFunc(()=>c()),n.addManagedListeners(this.column,{widthChanged:()=>r&&s(0)}),n.addManagedEventListeners({sortChanged:()=>{r&&window.setTimeout(()=>s(0))}}),i&&i(l)}onDisplayedColumnsChanged(){let{comp:e,column:t,beans:i,eGui:n}=this;!e||!t||!n||(P4(e,t,i.visibleCols),qR(n,i.visibleCols.getAriaColIndex(t)))}addResizeAndMoveKeyboardListeners(e){e.addManagedListeners(this.eGui,{keydown:this.onGuiKeyDown.bind(this),keyup:this.onGuiKeyUp.bind(this)})}refreshTabIndex(){let e=Ws(this.beans);this.eGui&&bi(this.eGui,"tabindex",e?null:"-1")}onGuiKeyDown(e){let t=tt(this.beans),i=e.key===R.LEFT||e.key===R.RIGHT;if(this.isResizing&&(e.preventDefault(),e.stopImmediatePropagation()),t!==this.eGui||!e.shiftKey&&!e.altKey||((this.isResizing||i)&&(e.preventDefault(),e.stopImmediatePropagation()),!i))return;let o=e.key===R.LEFT!==this.gos.get("enableRtl")?"left":"right";if(e.altKey){this.isResizing=!0,this.resizeMultiplier+=1;let s=this.getViewportAdjustedResizeDiff(e);this.resizeHeader(s,e.shiftKey),this.resizeFeature?.toggleColumnResizing(!0)}else this.moveHeader(o)}moveHeader(e){this.beans.colMoves?.moveHeader(e,this.eGui,this.column,this.rowCtrl.pinned,this)}getViewportAdjustedResizeDiff(e){let t=this.getResizeDiff(e),{pinnedCols:i}=this.beans;return i?i.getHeaderResizeDiff(t,this.column):t}getResizeDiff(e){let{gos:t,column:i}=this,n=e.key===R.LEFT!==t.get("enableRtl"),o=i.getPinned(),s=t.get("enableRtl");return o&&s!==(o==="right")&&(n=!n),(n?-1:1)*this.resizeMultiplier}onGuiKeyUp(){this.isResizing&&(this.resizeToggleTimeout&&(window.clearTimeout(this.resizeToggleTimeout),this.resizeToggleTimeout=0),this.isResizing=!1,this.resizeMultiplier=1,this.resizeToggleTimeout=window.setTimeout(()=>{this.resizeFeature?.toggleColumnResizing(!1)},150))}handleKeyDown(e){let t=this.getWrapperHasFocus();switch(e.key){case R.PAGE_DOWN:case R.PAGE_UP:case R.PAGE_HOME:case R.PAGE_END:t&&e.preventDefault()}}addDomData(e){let t=D4,{eGui:i,gos:n}=this;$s(n,i,t,this),e.addDestroyFunc(()=>$s(n,i,t,null))}focus(e){if(!this.isAlive())return!1;let{eGui:t}=this;return t?(t.focus(),this.lastFocusEvent=e||null):this.reAttemptToFocus=!0,!0}focusThis(){this.beans.focusSvc.focusedHeader={headerRowIndex:this.rowCtrl.rowIndex,column:this.column}}removeDragSource(){this.dragSource&&(this.beans.dragAndDrop?.removeDragSource(this.dragSource),this.dragSource=null)}handleContextMenuMouseEvent(e,t,i){let n=e??t,{menuSvc:o,gos:s}=this.beans;s.get("preventDefaultOnContextMenu")&&n.preventDefault(),o?.isHeaderContextMenuEnabled(i)&&o.showHeaderContextMenu(i,e,t),this.dispatchColumnMouseEvent("columnHeaderContextMenu",i)}dispatchColumnMouseEvent(e,t){this.eventSvc.dispatchEvent({type:e,column:t})}setColHeaderHeight(e,t){if(!e.setAutoHeaderHeight(t))return;let{eventSvc:i}=this;e.isColumn?i.dispatchEvent({type:"columnHeaderHeightChanged",column:e,columns:[e],source:"autosizeColumnHeaderHeight"}):i.dispatchEvent({type:"columnGroupHeaderHeightChanged",columnGroup:e,source:"autosizeColumnGroupHeaderHeight"})}clearComponent(){this.removeDragSource(),this.resizeFeature=null,this.comp=null,this.eGui=null}destroy(){super.destroy(),this.column=null,this.lastFocusEvent=null,this.rowCtrl=null}},cG=class extends Tv{constructor(){super(...arguments),this.refreshFunctions={},this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map}wireComp(e,t,i,n,o){this.comp=e;let{rowCtrl:s,column:r,beans:a}=this,{colResize:l,context:d,colHover:c,rangeSvc:u}=a,h=vd(this,d,o);this.setGui(t,h),this.updateState(),this.setupWidth(h),this.setupMovingCss(h),this.setupMenuClass(h),this.setupSortableClass(h),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight({wrapperElement:n,checkMeasuringCallback:g=>this.setRefreshFunction("measuring",g),compBean:h}),this.addColumnHoverListener(h),this.setupFilterClass(h),this.setupStylesFromColDef(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(h),this.setupSelectAll(h),this.setupUserComp(),this.refreshAria(),l?this.resizeFeature=h.createManagedBean(l.createResizeFeature(s.pinned,r,i,e,this)):Je(i,!1),c?.createHoverFeature(h,[r],t),u?.createRangeHighlightFeature(h,r,e),h.createManagedBean(new Fv(r,t,a)),h.createManagedBean(new Ea(t,{shouldStopEventPropagation:g=>this.shouldStopEventPropagation(g),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addResizeAndMoveKeyboardListeners(h),h.addManagedPropertyListeners(["suppressMovableColumns","suppressMenuHide","suppressAggFuncInHeader","enableAdvancedFilter"],()=>this.refresh()),h.addManagedListeners(r,{colDefChanged:()=>this.refresh()}),h.addManagedListeners(r,{headerHighlightChanged:this.onHeaderHighlightChanged.bind(this)});let p=()=>this.checkDisplayName();h.addManagedEventListeners({columnValueChanged:p,columnRowGroupChanged:p,columnPivotChanged:p,headerHeightChanged:this.onHeaderHeightChanged.bind(this)}),h.addDestroyFunc(()=>{this.refreshFunctions={},this.selectAllFeature=null,this.dragSourceElement=void 0,this.userCompDetails=null,this.userHeaderClasses.clear(),this.ariaDescriptionProperties.clear(),this.clearComponent()})}resizeHeader(e,t){this.beans.colResize?.resizeHeader(this.column,e,t)}getHeaderClassParams(){let{column:e,beans:t}=this,i=e.colDef;return te(t.gos,{colDef:i,column:e,floatingFilter:!1})}setupUserComp(){let e=this.lookupUserCompDetails();e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setUserCompDetails(e)}lookupUserCompDetails(){let e=this.createParams(),t=this.column.getColDef();return uN(this.beans.userCompFactory,t,e)}createParams(){let{menuSvc:e,sortSvc:t,colFilter:i,gos:n}=this.beans;return te(n,{column:this.column,displayName:this.displayName,enableSorting:this.column.isSortable(),enableMenu:this.menuEnabled,enableFilterButton:this.openFilterEnabled&&!!e?.isHeaderFilterButtonEnabled(this.column),enableFilterIcon:!!i&&(!this.openFilterEnabled||yi(this.gos)),showColumnMenu:(s,r)=>{e?.showColumnMenu({column:this.column,buttonElement:s,positionBy:"button",onClosedCallback:r})},showColumnMenuAfterMouseClick:(s,r)=>{e?.showColumnMenu({column:this.column,mouseEvent:s,positionBy:"mouse",onClosedCallback:r})},showFilter:s=>{e?.showFilterMenu({column:this.column,buttonElement:s,containerType:"columnFilter",positionBy:"button"})},progressSort:s=>{t?.progressSort(this.column,!!s,"uiColumnSorted")},setSort:(s,r)=>{t?.setSortForColumn(this.column,s,!!r,"uiColumnSorted")},eGridHeader:this.eGui,setTooltip:(s,r)=>{n.assertModuleRegistered("Tooltip",3),this.setupTooltip(s,r)}})}setupSelectAll(e){let{selectionSvc:t}=this.beans;t&&(this.selectAllFeature=e.createOptionalManagedBean(t.createSelectAllFeature(this.column)),this.selectAllFeature?.setComp(this),e.addManagedPropertyListener("rowSelection",()=>{let i=t.createSelectAllFeature(this.column);i&&!this.selectAllFeature?(this.selectAllFeature=e.createManagedBean(i),this.selectAllFeature?.setComp(this),this.comp.refreshSelectAllGui()):this.selectAllFeature&&!i&&(this.comp.removeSelectAllGui(),this.selectAllFeature=this.destroyBean(this.selectAllFeature))}))}getSelectAllGui(){return this.selectAllFeature?.getCheckboxGui()}handleKeyDown(e){super.handleKeyDown(e),e.key===R.SPACE&&this.selectAllFeature?.onSpaceKeyDown(e),e.key===R.ENTER&&this.onEnterKeyDown(e),e.key===R.DOWN&&e.altKey&&this.showMenuOnKeyPress(e,!1)}onEnterKeyDown(e){e.ctrlKey||e.metaKey?this.showMenuOnKeyPress(e,!0):this.sortable&&this.beans.sortSvc?.progressSort(this.column,e.shiftKey,"uiColumnSorted")}showMenuOnKeyPress(e,t){let i=this.comp.getUserCompInstance();KE(i)&&i.onMenuKeyboardShortcut(t)&&e.preventDefault()}onFocusIn(e){this.eGui.contains(e.relatedTarget)||(this.focusThis(),this.announceAriaDescription()),_N()&&this.setActiveHeader(!0)}onFocusOut(e){this.eGui.contains(e.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(e,t){this.tooltipFeature=this.beans.tooltipSvc?.setupHeaderTooltip(this.tooltipFeature,this,e,t)}setupStylesFromColDef(){this.setRefreshFunction("headerStyles",this.refreshHeaderStyles.bind(this)),this.refreshHeaderStyles()}setupClassesFromColDef(){let e=()=>{let t=this.column.getColDef(),i=R4(t,this.gos,this.column,null),n=this.userHeaderClasses;this.userHeaderClasses=new Set(i);for(let o of i)n.has(o)?n.delete(o):this.comp.toggleCss(o,!0);for(let o of n)this.comp.toggleCss(o,!1)};this.setRefreshFunction("headerClasses",e),e()}setDragSource(e){this.dragSourceElement=e,this.removeDragSource(),!(!e||!this.draggable)&&(this.dragSource=this.beans.colMoves?.setDragSourceForHeader(e,this.column,this.displayName)??null)}updateState(){let{menuSvc:e}=this.beans;this.menuEnabled=!!e?.isColumnMenuInHeaderEnabled(this.column),this.openFilterEnabled=!!e?.isFilterMenuInHeaderEnabled(this.column),this.sortable=this.column.isSortable(),this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}setRefreshFunction(e,t){this.refreshFunctions[e]=t}refresh(){this.updateState(),this.refreshHeaderComp(),this.refreshAria();for(let e of Object.values(this.refreshFunctions))e()}refreshHeaderComp(){let e=this.lookupUserCompDetails();if(!e)return;(this.comp.getUserCompInstance()!=null&&this.userCompDetails.componentClass==e.componentClass?this.attemptHeaderCompRefresh(e.params):!1)?this.setDragSource(this.dragSourceElement):this.setCompDetails(e)}attemptHeaderCompRefresh(e){let t=this.comp.getUserCompInstance();return!t||!t.refresh?!1:t.refresh(e)}calculateDisplayName(){return this.beans.colNames.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(){this.displayName!==this.calculateDisplayName()&&this.refresh()}workOutDraggable(){let e=this.column.getColDef();return!!(!this.gos.get("suppressMovableColumns")&&!e.suppressMovable&&!e.lockPosition)||!!e.enableRowGroup||!!e.enablePivot}setupWidth(e){let t=()=>{let i=this.column.getActualWidth();this.comp.setWidth(`${i}px`)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupMovingCss(e){let t=()=>{this.comp.toggleCss("ag-header-cell-moving",this.column.isMoving())};e.addManagedListeners(this.column,{movingChanged:t}),t()}setupMenuClass(e){let t=()=>{this.comp?.toggleCss("ag-column-menu-visible",this.column.isMenuVisible())};e.addManagedListeners(this.column,{menuVisibleChanged:t}),t()}setupSortableClass(e){let t=()=>{this.comp.toggleCss("ag-header-cell-sortable",!!this.sortable)};t(),this.setRefreshFunction("updateSortable",t),e.addManagedEventListeners({sortChanged:this.refreshAriaSort.bind(this)})}setupFilterClass(e){let t=()=>{let i=this.column.isFilterActive();this.comp.toggleCss("ag-header-cell-filtered",i),this.refreshAria()};e.addManagedListeners(this.column,{filterActiveChanged:t}),t()}setupWrapTextClass(){let e=()=>{let t=!!this.column.getColDef().wrapHeaderText;this.comp.toggleCss("ag-header-cell-wrap-text",t)};e(),this.setRefreshFunction("wrapText",e)}onHeaderHighlightChanged(){let e=this.column.getHighlighted(),t=e===0,i=e===1;this.comp.toggleCss("ag-header-highlight-before",t),this.comp.toggleCss("ag-header-highlight-after",i)}onDisplayedColumnsChanged(){super.onDisplayedColumnsChanged(),this.isAlive()&&this.onHeaderHeightChanged()}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){let{eGui:e,column:t,comp:i,beans:n}=this,o=Mv(this.beans),s=o.reduce((h,p)=>h+p,0)===0;if(i.toggleCss("ag-header-parent-hidden",s),!t.isSpanHeaderHeight()){e.style.removeProperty("top"),e.style.removeProperty("height"),i.toggleCss("ag-header-span-height",!1),i.toggleCss("ag-header-span-total",!1);return}let{numberOfParents:r,isSpanningTotal:a}=this.column.getColumnGroupPaddingInfo();i.toggleCss("ag-header-span-height",r>0);let l=kv(n);if(r===0){i.toggleCss("ag-header-span-total",!1),e.style.setProperty("top","0px"),e.style.setProperty("height",`${l}px`);return}i.toggleCss("ag-header-span-total",a);let d=(this.column.getFirstRealParent()?.getLevel()??-1)+1,c=o.length-d,u=0;for(let h=0;h<c;h++)u+=o[o.length-1-h];e.style.setProperty("top",`${-u}px`),e.style.setProperty("height",`${l+u}px`)}refreshAriaSort(){if(this.sortable){let e=this.getLocaleTextFunc(),t=this.beans.sortSvc?.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(r_(t)),this.setAriaDescriptionProperty("sort",e("ariaSortableColumn","Press ENTER to sort"))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)}refreshAriaMenu(){if(this.menuEnabled){let e=this.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",e("ariaMenuColumn","Press ALT DOWN to open column menu"))}else this.setAriaDescriptionProperty("menu",null)}refreshAriaFilterButton(){if(this.openFilterEnabled&&!yi(this.gos)){let e=this.getLocaleTextFunc();this.setAriaDescriptionProperty("filterButton",e("ariaFilterColumn","Press CTRL ENTER to open filter"))}else this.setAriaDescriptionProperty("filterButton",null)}refreshAriaFiltered(){let e=this.getLocaleTextFunc();this.column.isFilterActive()?this.setAriaDescriptionProperty("filter",e("ariaColumnFiltered","Column Filtered")):this.setAriaDescriptionProperty("filter",null)}setAriaDescriptionProperty(e,t){t!=null?this.ariaDescriptionProperties.set(e,t):this.ariaDescriptionProperties.delete(e)}announceAriaDescription(){if(!this.eGui.contains(tt(this.beans)))return;let e=Array.from(this.ariaDescriptionProperties.keys()).sort((t,i)=>t==="filter"?-1:i.charCodeAt(0)-t.charCodeAt(0)).map(t=>this.ariaDescriptionProperties.get(t)).join(". ");this.beans.ariaAnnounce?.announceValue(e,"columnHeader")}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaFilterButton(),this.refreshAriaFiltered()}addColumnHoverListener(e){this.beans.colHover?.addHeaderColumnHoverListener(e,this.comp,this.column)}addActiveHeaderMouseListeners(e){let t=o=>this.handleMouseOverChange(o.type==="mouseenter"),i=()=>{this.setActiveHeader(!0),this.dispatchColumnMouseEvent("columnHeaderClicked",this.column)},n=o=>this.handleContextMenuMouseEvent(o,void 0,this.column);e.addManagedListeners(this.eGui,{mouseenter:t,mouseleave:t,click:i,contextmenu:n})}handleMouseOverChange(e){this.setActiveHeader(e),this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column})}setActiveHeader(e){this.comp.toggleCss("ag-header-active",e)}getAnchorElementForMenu(e){let t=this.comp.getUserCompInstance();return KE(t)?t.getAnchorElementForMenu(e):this.eGui}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function KE(e){return typeof e?.getAnchorElementForMenu=="function"&&typeof e.onMenuKeyboardShortcut=="function"}var uG=0,iC=class extends D{constructor(e,t,i){super(),this.rowIndex=e,this.pinned=t,this.type=i,this.instanceId=uG++,this.comp=null,this.allCtrls=[];let n="ag-header-row-column";i==="group"?n="ag-header-row-group":i==="filter"&&(n="ag-header-row-filter"),this.headerRowClass=`ag-header-row ${n}`}setRowIndex(e){this.rowIndex=e,this.comp?.setRowIndex(this.getAriaRowIndex()),this.onRowHeightChanged()}postConstruct(){this.isPrintLayout=Nt(this.gos,"print"),this.isEnsureDomOrder=this.gos.get("ensureDomOrder")}areCellsRendered(){return this.comp?this.allCtrls.every(e=>e.eGui!=null):!1}setComp(e,t,i=!0){this.comp=e,t=vd(this,this.beans.context,t),i&&(this.setRowIndex(this.rowIndex),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners(t)}getAriaRowIndex(){return this.rowIndex+1}addEventListeners(e){let t=this.onRowHeightChanged.bind(this),i=this.onDisplayedColumnsChanged.bind(this);e.addManagedEventListeners({columnResized:this.setWidth.bind(this),displayedColumnsChanged:i,virtualColumnsChanged:n=>this.onVirtualColumnsChanged(n.afterScroll),columnGroupHeaderHeightChanged:t,columnHeaderHeightChanged:t,gridStylesChanged:t,advancedFilterEnabledChanged:t}),e.addManagedPropertyListener("domLayout",i),e.addManagedPropertyListener("ensureDomOrder",n=>this.isEnsureDomOrder=n.currentValue),e.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],t)}onDisplayedColumnsChanged(){this.isPrintLayout=Nt(this.gos,"print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}setWidth(){if(!this.comp)return;let e=this.getWidthForRow();this.comp.setWidth(`${e}px`)}getWidthForRow(){let{visibleCols:e}=this.beans;return this.isPrintLayout?this.pinned!=null?0:e.getContainerWidth("right")+e.getContainerWidth("left")+e.getContainerWidth(null):e.getContainerWidth(this.pinned)}onRowHeightChanged(){if(!this.comp)return;let{topOffset:e,rowHeight:t}=this.getTopAndHeight();this.comp.setTop(e+"px"),this.comp.setHeight(t+"px")}getTopAndHeight(){let e=0,t=Mv(this.beans);for(let o=0;o<t.length;o++){if(o===this.rowIndex&&this.type==="group")return{topOffset:e,rowHeight:t[o]};e+=t[o]}let i=kv(this.beans);if(this.type==="column")return{topOffset:e,rowHeight:i};e+=i;let n=M4(this.beans);return{topOffset:e,rowHeight:n}}onVirtualColumnsChanged(e=!1){if(!this.comp)return;let t=this.getUpdatedHeaderCtrls(),i=this.isEnsureDomOrder||this.isPrintLayout;this.comp.setHeaderCtrls(t,i,e)}getUpdatedHeaderCtrls(){let e=this.ctrlsById;this.ctrlsById=new Map;let t=this.getColumnsInViewport();for(let n of t)this.recycleAndCreateHeaderCtrls(n,this.ctrlsById,e);let i=n=>{let{focusSvc:o,visibleCols:s}=this.beans;return o.isHeaderWrapperFocused(n)?s.isVisible(n.column):!1};if(e)for(let[n,o]of e)i(o)?this.ctrlsById.set(n,o):this.destroyBean(o);return this.allCtrls=Array.from(this.ctrlsById.values()),this.allCtrls}getHeaderCellCtrls(){return this.allCtrls}recycleAndCreateHeaderCtrls(e,t,i){if(e.isEmptyGroup())return;let n=e.getUniqueId(),o;if(i&&(o=i.get(n),i.delete(n)),o&&o.column!=e&&(this.destroyBean(o),o=void 0),o==null)switch(this.type){case"filter":{o=this.createBean(this.beans.registry.createDynamicBean("headerFilterCellCtrl",!0,e,this));break}case"group":o=this.createBean(this.beans.registry.createDynamicBean("headerGroupCellCtrl",!0,e,this));break;default:o=this.createBean(new cG(e,this));break}t.set(n,o)}getColumnsInViewport(){if(!this.isPrintLayout)return this.getComponentsToRender();if(this.pinned)return[];let e=[];for(let t of["left",null,"right"])e.push(...this.getComponentsToRender(t));return e}getComponentsToRender(e=this.pinned){return this.type==="group"?this.beans.colViewport.getHeadersToRender(e,this.rowIndex):this.beans.colViewport.getColumnHeadersToRender(e)}focusHeader(e,t){let i=this.allCtrls.find(o=>o.column==e);return i?i.focus(t):!1}destroy(){this.allCtrls=this.destroyBeans(this.allCtrls),this.ctrlsById=void 0,this.comp=null,super.destroy()}},hG=class extends D{constructor(e){super(),this.pinned=e,this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[]}setComp(e,t){this.comp=e,this.eViewport=t;let{pinnedCols:i,ctrlsSvc:n,colModel:o,colMoves:s}=this.beans;this.setupCenterWidth(),i?.setupHeaderPinnedWidth(this),this.setupDragAndDrop(s,this.eViewport);let r=this.refresh.bind(this,!0);this.addManagedEventListeners({displayedColumnsChanged:r,advancedFilterEnabledChanged:r});let a=`${typeof this.pinned=="string"?this.pinned:"center"}Header`;n.register(a,this),o.ready&&this.refresh()}getAllCtrls(){let e=[...this.groupsRowCtrls];return this.columnsRowCtrl&&e.push(this.columnsRowCtrl),this.filtersRowCtrl&&e.push(this.filtersRowCtrl),e}refresh(e=!1){let{focusSvc:t,filterManager:i,visibleCols:n}=this.beans,o=0,s=t.getFocusHeaderToUseAfterRefresh(),r=()=>{let u=n.headerGroupRowCount;o=u,e||(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls));let h=this.groupsRowCtrls.length;if(h!==u){if(h>u){for(let p=u;p<h;p++)this.destroyBean(this.groupsRowCtrls[p]);this.groupsRowCtrls.length=u;return}for(let p=h;p<u;p++){let g=this.createBean(new iC(p,this.pinned,"group"));this.groupsRowCtrls.push(g)}}},a=()=>{let u=o++;if(this.hidden){this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl);return}this.columnsRowCtrl==null||!e?(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl),this.columnsRowCtrl=this.createBean(new iC(u,this.pinned,"column"))):this.columnsRowCtrl.rowIndex!==u&&this.columnsRowCtrl.setRowIndex(u)},l=()=>{this.includeFloatingFilter=!!i?.hasFloatingFilters()&&!this.hidden;let u=()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)};if(!this.includeFloatingFilter){u();return}e||u();let h=o++;this.filtersRowCtrl?this.filtersRowCtrl.rowIndex!==h&&this.filtersRowCtrl.setRowIndex(h):this.filtersRowCtrl=this.createBean(new iC(h,this.pinned,"filter"))},d=this.getAllCtrls();r(),a(),l();let c=this.getAllCtrls();this.comp.setCtrls(c),this.restoreFocusOnHeader(t,s),d.length!==c.length&&this.beans.eventSvc.dispatchEvent({type:"headerRowsChanged"})}getHeaderCtrlForColumn(e){let t=i=>i?.getHeaderCellCtrls().find(n=>n.column===e);if(Xo(e))return t(this.columnsRowCtrl);if(this.groupsRowCtrls.length!==0)for(let i=0;i<this.groupsRowCtrls.length;i++){let n=t(this.groupsRowCtrls[i]);if(n)return n}}getHtmlElementForColumnHeader(e){return this.getHeaderCtrlForColumn(e)?.eGui??null}getRowType(e){return this.getAllCtrls()[e]?.type}focusHeader(e,t,i){let o=this.getAllCtrls()[e];return o?o.focusHeader(t,i):!1}getGroupRowCount(){return this.groupsRowCtrls.length}getGroupRowCtrlAtIndex(e){return this.groupsRowCtrls[e]}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}setHorizontalScroll(e){this.comp.setViewportScrollLeft(e)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}destroy(){this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl),this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl),this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls),super.destroy()}setupDragAndDrop(e,t){let i=e?.createBodyDropTarget(this.pinned,t);i&&this.createManagedBean(i)}restoreFocusOnHeader(e,t){if(!t)return;let{column:i}=t;i.getPinned()==this.pinned&&e.focusHeaderPosition({headerPosition:t,scroll:!1})}setupCenterWidth(){this.pinned==null&&this.createManagedBean(new Rv(e=>this.comp.setCenterWidth(`${e}px`),!0))}},pG=class extends D{constructor(){super(...arguments),this.beanName="menuSvc"}postConstruct(){let{enterpriseMenuFactory:e,filterMenuFactory:t}=this.beans;this.activeMenuFactory=e??t}showColumnMenu(e){this.showColumnMenuCommon(this.activeMenuFactory,e,"columnMenu")}showFilterMenu(e){this.showColumnMenuCommon(XE(this.beans),e,e.containerType,!0)}showHeaderContextMenu(e,t,i){this.activeMenuFactory?.showMenuAfterContextMenuEvent(e,t,i)}hidePopupMenu(){this.beans.contextMenuSvc?.hideActiveMenu(),this.activeMenuFactory?.hideActiveMenu()}hideFilterMenu(){XE(this.beans)?.hideActiveMenu()}isColumnMenuInHeaderEnabled(e){let{suppressHeaderMenuButton:t}=e.getColDef();return!t&&!!this.activeMenuFactory?.isMenuEnabled(e)&&(yi(this.gos)||!!this.beans.enterpriseMenuFactory)}isFilterMenuInHeaderEnabled(e){return!e.getColDef().suppressHeaderFilterButton&&!!this.beans.filterManager?.isFilterAllowed(e)}isHeaderContextMenuEnabled(e){return!(e&&Xo(e)?e.getColDef():e?.getColGroupDef())?.suppressHeaderContextMenu&&this.gos.get("columnMenu")==="new"}isHeaderMenuButtonAlwaysShowEnabled(){return this.isSuppressMenuHide()}isHeaderMenuButtonEnabled(){let e=!this.isSuppressMenuHide();return!(zs()&&e)}isHeaderFilterButtonEnabled(e){return this.isFilterMenuInHeaderEnabled(e)&&!yi(this.gos)&&!this.isFloatingFilterButtonDisplayed(e)}isFilterMenuItemEnabled(e){return!!this.beans.filterManager?.isFilterAllowed(e)&&!yi(this.gos)&&!this.isFilterMenuInHeaderEnabled(e)&&!this.isFloatingFilterButtonDisplayed(e)}isFloatingFilterButtonEnabled(e){return!e.getColDef().suppressFloatingFilterButton}isFloatingFilterButtonDisplayed(e){return!!e.getColDef().floatingFilter&&this.isFloatingFilterButtonEnabled(e)}isSuppressMenuHide(){let e=this.gos,t=e.get("suppressMenuHide");return yi(e)?e.exists("suppressMenuHide")?t:!1:t}showColumnMenuCommon(e,t,i,n){let{positionBy:o,onClosedCallback:s}=t,r=t.column;if(o==="button"){let{buttonElement:a}=t;e?.showMenuAfterButtonClick(r,a,i,s,n)}else if(o==="mouse"){let{mouseEvent:a}=t;e?.showMenuAfterMouseEvent(r,a,i,s,n)}else if(r){let a=this.beans,l=a.ctrlsSvc;l.getScrollFeature().ensureColumnVisible(r,"auto"),po(a,()=>{let d=l.getHeaderRowContainerCtrl(r.getPinned())?.getHeaderCtrlForColumn(r);d&&e?.showMenuAfterButtonClick(r,d.getAnchorElementForMenu(n),i,s,n)})}}};function YE(e,t,i){e.menuVisible!==t&&(e.menuVisible=t,e.dispatchColEvent("menuVisibleChanged",i))}function XE(e){let{enterpriseMenuFactory:t,filterMenuFactory:i,gos:n}=e;return t&&yi(n)?t:i}var Lp=class extends pv{constructor(){super(...arguments),this.errorMessages=null}init(e){this.params=e,this.initialiseEditor(e),this.eEditor.onValueChange(()=>e.validate())}destroy(){this.errorMessages=null}},F4=class extends Oe{constructor(){super()}},gG={tag:"span",cls:"ag-overlay-loading-center"},fG=class extends F4{init(){let e=ro(this.gos.get("overlayLoadingTemplate")?.trim());if(this.setTemplate(e??gG),!e){let i=this.getLocaleTextFunc()("loadingOoo","Loading...");this.getGui().textContent=i,this.beans.ariaAnnounce.announceValue(i,"overlay")}}},mG={tag:"span",cls:"ag-overlay-no-rows-center"},CG=class extends F4{init(){let e=ro(this.gos.get("overlayNoRowsTemplate")?.trim());if(this.setTemplate(e??mG),!e){let i=this.getLocaleTextFunc()("noRowsToShow","No Rows To Show");this.getGui().textContent=i,this.beans.ariaAnnounce.announceValue(i,"overlay")}}};function vG(e,t,i){let n=Ni(e,t,i);if(n){let{className:s}=n;if(typeof s=="string"&&s.includes("ag-icon")||typeof s=="object"&&s["ag-icon"])return n}let o=ft({tag:"span"});return o.appendChild(n),o}function Ni(e,t,i){let n=null;e==="smallDown"?I(262):e==="smallLeft"?I(263):e==="smallRight"&&I(264);let o=i?.getColDef().icons;if(o&&(n=o[e]),t.gos&&!n){let s=t.gos.get("icons");s&&(n=s[e])}if(n){let s;if(typeof n=="function")s=n();else if(typeof n=="string")s=n;else{I(38,{iconName:e});return}if(typeof s=="string")return iv(s);if(sv(s))return s;I(133,{iconName:e});return}else{let s=t.registry.getIcon(e);return s||t.validation?.validateIcon(e),ft({tag:"span",cls:`ag-icon ag-icon-${s??e}`,role:"presentation",attrs:{unselectable:"on"}})}}var wG=".ag-dnd-ghost{align-items:center;background-color:var(--ag-drag-and-drop-image-background-color);border:var(--ag-drag-and-drop-image-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-drag-and-drop-image-shadow);color:var(--ag-text-color);cursor:move;display:flex;font-weight:500;gap:var(--ag-cell-widget-spacing);height:var(--ag-header-height);overflow:hidden;padding-left:var(--ag-cell-horizontal-padding);padding-right:var(--ag-cell-horizontal-padding);text-overflow:ellipsis;transform:translateY(calc(var(--ag-spacing)*2));white-space:nowrap}.ag-dnd-ghost-not-allowed{border:var(--ag-drag-and-drop-image-not-allowed-border)}",bG={tag:"div",children:[{tag:"div",ref:"eGhost",cls:"ag-dnd-ghost ag-unselectable",children:[{tag:"span",ref:"eIcon",cls:"ag-dnd-ghost-icon ag-shake-left-to-right"},{tag:"div",ref:"eLabel",cls:"ag-dnd-ghost-label"}]}]},yG=class extends Oe{constructor(){super(),this.dragSource=null,this.eIcon=V,this.eLabel=V,this.eGhost=V,this.registerCSS(wG)}postConstruct(){let e=t=>vG(t,this.beans,null);this.dropIconMap={pinned:e("columnMovePin"),hide:e("columnMoveHide"),move:e("columnMoveMove"),left:e("columnMoveLeft"),right:e("columnMoveRight"),group:e("columnMoveGroup"),aggregate:e("columnMoveValue"),pivot:e("columnMovePivot"),notAllowed:e("dropNotAllowed")}}init(e){this.dragSource=e.dragSource,this.setTemplate(bG),this.beans.environment.applyThemeClasses(this.eGhost)}destroy(){this.dragSource=null,super.destroy()}setIcon(e,t){let{eGhost:i,eIcon:n,dragSource:o,dropIconMap:s,gos:r}=this;Ot(n);let a=null;e||(e=o?.getDefaultIconName?o.getDefaultIconName():"notAllowed"),a=s[e],i.classList.toggle("ag-dnd-ghost-not-allowed",e==="notAllowed"),n.classList.toggle("ag-shake-left-to-right",t),!(a===s.hide&&r.get("suppressDragLeaveHidesColumns"))&&a&&n.appendChild(a)}setLabel(e){this.eLabel.textContent=e}},SG=".ag-checkbox-cell{height:100%}",xG={tag:"div",cls:"ag-cell-wrapper ag-checkbox-cell",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},EG=class extends Oe{constructor(){super(xG,[mv]),this.eCheckbox=V,this.registerCSS(SG)}init(e){this.refresh(e);let{eCheckbox:t,beans:i}=this,n=t.getInputElement();n.setAttribute("tabindex","-1"),WR(n,"polite"),this.addManagedListeners(n,{click:o=>{if(Ks(o),t.isDisabled())return;let s=t.getValue();this.onCheckboxChanged(s)},dblclick:o=>{Ks(o)}}),this.addManagedElementListeners(e.eGridCell,{keydown:o=>{if(o.key===R.SPACE&&!t.isDisabled()){e.eGridCell===tt(i)&&t.toggle();let s=t.getValue();this.onCheckboxChanged(s),o.preventDefault()}}})}refresh(e){return this.params=e,this.updateCheckbox(e),!0}updateCheckbox(e){let t,i=!0,{value:n,column:o,node:s}=e;if(s.group&&o)if(typeof n=="boolean")t=n;else{let u=o.getColId();u.startsWith(Dp)?t=n==null||n===""?void 0:n==="true":s.aggData&&s.aggData[u]!==void 0||s.sourceRowIndex>=0?t=n??void 0:i=!1}else t=n??void 0;let{eCheckbox:r}=this;if(!i){r.setDisplayed(!1);return}r.setValue(t);let a=e.disabled??!o?.isCellEditable(s);r.setDisabled(a);let l=this.getLocaleTextFunc(),d=kp(l,t),c=a?d:`${l("ariaToggleCellValue","Press SPACE to toggle cell value")} (${d})`;r.setInputAriaLabel(c)}onCheckboxChanged(e){let{params:t}=this,{column:i,node:n,value:o}=t;this.beans?.editSvc?.setEditingCells([{column:i,colId:i.getColId(),rowIndex:n.rowIndex,rowPinned:n.rowPinned,state:"changed",oldValue:o,newValue:o}],{update:!0,forceRefreshOfEditCellsOnly:!0});let s=n.setDataValue(i,e,"renderer");this.beans.editSvc?.stopEditing({rowNode:n,column:i},{source:this.beans.editSvc?.isBatchEditing()?"ui":"api"}),s||this.updateCheckbox(t)}},JE=class{constructor(e,t){this.beans=e,this.floating=t,this.all=new Set,this.visible=new Set,this.order=[],this.queued=new Set}size(){return this.visible.size}add(e){let{all:t,visible:i,order:n}=this;t.has(e)||(t.add(e),i.add(e),n.push(e),this.sort())}delete(e){this.all.delete(e),this.visible.delete(e),this.queued.delete(e.id),Yi(this.order,e)}has(e){return this.visible.has(e)}forEach(e){this.order.forEach(e)}getByIndex(e){return this.order[e]}getById(e){for(let t of this.visible)if(t.id==e)return t}clear(){let{all:e,visible:t,order:i,queued:n}=this;e.clear(),n.clear(),t.clear(),i.length=0}sort(){let{sortSvc:e,rowNodeSorter:t,gos:i}=this.beans,n=e?.getSortOptions()??[],o=MG(this.order);if(this.order.sort((r,a)=>(r.pinnedSibling?.rowIndex??0)-(a.pinnedSibling?.rowIndex??0)),this.order=t?.doFullSort(this.order,n)??this.order,!o)return;let s=w6(i);s==="bottom"||s==="pinnedBottom"?this.order.push(o):this.order.unshift(o)}hide(e){let{all:t,visible:i}=this;t.forEach(n=>e(n)?i.delete(n):i.add(n)),this.order=Array.from(i),this.sort()}queue(e){this.queued.add(e)}unqueue(e){this.queued.delete(e)}forEachQueued(e){this.queued.forEach(e)}};function T4(e){if(e.level===-1)return!0;let t=e.parent;return t?.childrenAfterSort?.some(i=>i==e)?T4(t):!1}function nC(e,t){let{gos:i,rowModel:n,filterManager:o}=e;return xa(i,n)?!n.getRowNode(t.id):o?.isAnyFilterPresent()?!T4(t):i.get("pivotMode")?!t.group:!1}function RG(e){return!!e.footer&&e.level===-1}function PG(e){return!!e.pinnedSibling&&RG(e.pinnedSibling)}function MG(e){let t=e.findIndex(PG);if(t>-1)return e.splice(t,1)?.[0]}var QE=class extends D{postConstruct(){let{gos:e,beans:t}=this;this.top=new JE(t,"top"),this.bottom=new JE(t,"bottom");let i=o=>nC(t,o.pinnedSibling),n=()=>{let o=e.get("isRowPinned");o&&e.get("enableRowPinning")&&t.rowModel.forEachNode(s=>this.pinRow(s,o(s)),!0),this.refreshRowPositions(),this.dispatchRowPinnedEvents()};this.addManagedEventListeners({gridStylesChanged:this.onGridStylesChanges.bind(this),modelUpdated:({keepRenderedRows:o})=>{this.tryToEmptyQueues(),this.pinGrandTotalRow(),this.forContainers(r=>r.hide(i));let s=this.refreshRowPositions();(!o||s)&&this.dispatchRowPinnedEvents()},columnRowGroupChanged:()=>{this.forContainers(DG),this.refreshRowPositions()},rowNodeDataChanged:({node:o})=>{(e.get("isRowPinnable")?.(o)??!0)||this.pinRow(o,null)},firstDataRendered:n}),this.addManagedPropertyListener("pivotMode",()=>{this.forContainers(o=>o.hide(i)),this.dispatchRowPinnedEvents()}),this.addManagedPropertyListener("grandTotalRow",({currentValue:o})=>{this._grandTotalPinned=o==="pinnedBottom"?"bottom":o==="pinnedTop"?"top":null}),this.addManagedPropertyListener("isRowPinned",n)}destroy(){this.reset(!1),super.destroy()}reset(e=!0){this.forContainers(t=>{let i=[];t.forEach(n=>i.push(n)),i.forEach(n=>this.pinRow(n,null)),t.clear()}),e&&this.dispatchRowPinnedEvents()}pinRow(e,t,i){if(e.footer&&e.level>-1)return;if(e.footer&&e.level===-1){this._grandTotalPinned=t,TG(this.beans);return}let n=e.rowPinned??e.pinnedSibling?.rowPinned;if(n!=null&&t!=null&&t!=n){let r=e.rowPinned?e:e.pinnedSibling,a=e.rowPinned?e.pinnedSibling:e;this.pinRow(r,null,i),this.pinRow(a,t,i);return}let s=i&&FG(this.beans,e,i);if(s){s.forEach(r=>this.pinRow(r,t));return}if(t==null){let r=e.rowPinned?e:e.pinnedSibling,a=this.findPinnedRowNode(r);if(!a)return;a.delete(r);let l=r.pinnedSibling;oC(r),this.refreshRowPositions(t),this.dispatchRowPinnedEvents(l)}else{let r=ZE(this.beans,e,t),a=this.getContainer(t);a.add(r),nC(this.beans,e)&&a.hide(l=>nC(this.beans,l.pinnedSibling)),this.refreshRowPositions(t),this.dispatchRowPinnedEvents(e)}}isManual(){return!0}isEmpty(e){return this.getContainer(e).size()===0}isRowsToRender(e){return!this.isEmpty(e)}ensureRowHeightsValid(){let e=!1,t=0,i=n=>{if(n.rowHeightEstimated){let o=Yo(this.beans,n);n.setRowTop(t),n.setRowHeight(o.height),t+=o.height,e=!0}};return this.bottom.forEach(i),t=0,this.top.forEach(i),this.eventSvc.dispatchEvent({type:"pinnedHeightChanged"}),e}getPinnedTopTotalHeight(){return eR(this.top)}getPinnedBottomTotalHeight(){return eR(this.bottom)}getPinnedTopRowCount(){return this.top.size()}getPinnedBottomRowCount(){return this.bottom.size()}getPinnedTopRow(e){return this.top.getByIndex(e)}getPinnedBottomRow(e){return this.bottom.getByIndex(e)}getPinnedRowById(e,t){return this.getContainer(t).getById(e)}forEachPinnedRow(e,t){this.getContainer(e).forEach(t)}getPinnedState(){let e=t=>{let i=[];return this.forEachPinnedRow(t,n=>i.push(n.pinnedSibling.id)),i};return{top:e("top"),bottom:e("bottom")}}setPinnedState(e){this.forContainers((t,i)=>{for(let n of e[i]){let o=this.beans.rowModel.getRowNode(n);o?this.pinRow(o,i):t.queue(n)}})}getGrandTotalPinned(){return this._grandTotalPinned}setGrandTotalPinned(e){this._grandTotalPinned=e}tryToEmptyQueues(){this.forContainers((e,t)=>{let i=new Set;e.forEachQueued(n=>{let o=this.beans.rowModel.getRowNode(n);o&&i.add(o)});for(let n of i)e.unqueue(n.id),this.pinRow(n,t)})}pinGrandTotalRow(){let{gos:e,beans:t,_grandTotalPinned:i}=this,n=t.rowModel;if(!gt(e,n))return;let o=n.rootNode?.sibling;if(!o)return;let s=o.pinnedSibling,r=s&&this.findPinnedRowNode(s);if(i){if(r&&r.floating!==i&&(r.delete(s),oC(s)),!r||r.floating!==i){let a=ZE(t,o,i);this.getContainer(i).add(a)}}else{if(!r)return;r.delete(s),oC(s)}}onGridStylesChanges(e){e.rowHeightChanged&&this.forContainers(t=>t.forEach(i=>i.setRowHeight(i.rowHeight,!0)))}getContainer(e){return e==="top"?this.top:this.bottom}findPinnedRowNode(e){if(this.top.has(e))return this.top;if(this.bottom.has(e))return this.bottom}refreshRowPositions(e){let t=n=>kG(this.beans,n);if(e)return t(this.getContainer(e));let i=!1;return this.forContainers(n=>{let o=t(n);i||(i=o)}),i}forContainers(e){e(this.top,"top"),e(this.bottom,"bottom")}dispatchRowPinnedEvents(e){this.eventSvc.dispatchEvent({type:"pinnedRowsChanged"}),e?.dispatchRowEvent("rowPinned")}};function kG(e,t){let i=0,n=!1;return t.forEach((o,s)=>{if(n||(n=o.rowTop!==i),o.setRowTop(i),o.rowHeightEstimated||o.rowHeight==null){let r=Yo(e,o).height;n||(n=o.rowHeight!==r),o.setRowHeight(r)}o.setRowIndex(s),i+=o.rowHeight}),n}function ZE(e,t,i){if(t.pinnedSibling)return t.pinnedSibling;let n=qB(t,e);n.setRowTop(null),n.setRowIndex(null),n.rowPinned=i;let o=i==="top"?yv:Sv;return n.id=`${o}${i}-${t.id}`,n.pinnedSibling=t,t.pinnedSibling=n,n}function oC(e){if(!e.pinnedSibling)return;e.rowPinned=null,e.setRowTop(null),e.setRowIndex(null);let t=e.pinnedSibling;e.pinnedSibling=void 0,t&&(t.pinnedSibling=void 0,t.rowPinned=null)}function DG(e){let t=new Set;e.forEach(i=>{i.group&&t.add(i)}),t.forEach(i=>e.delete(i))}function FG(e,t,i){let{rowSpanSvc:n}=e,o=(i&&n?.isCellSpanning(i,t))??!1;if(i&&o)return n?.getCellSpan(i,t)?.spannedNodes}function eR(e){let t=e.size();if(t===0)return 0;let i=e.getByIndex(t-1);return i===void 0?0:i.rowTop+i.rowHeight}function TG({gos:e,rowModel:t}){gt(e,t)&&t.refreshModel({step:"map"})}var tR=class extends D{constructor(){super(...arguments),this.nextId=0,this.pinnedTopRows={cache:{},order:[]},this.pinnedBottomRows={cache:{},order:[]}}postConstruct(){let e=this.gos;this.setPinnedRowData(e.get("pinnedTopRowData"),"top"),this.setPinnedRowData(e.get("pinnedBottomRowData"),"bottom"),this.addManagedPropertyListener("pinnedTopRowData",t=>this.setPinnedRowData(t.currentValue,"top")),this.addManagedPropertyListener("pinnedBottomRowData",t=>this.setPinnedRowData(t.currentValue,"bottom")),this.addManagedEventListeners({gridStylesChanged:this.onGridStylesChanges.bind(this)})}reset(){}isEmpty(e){return this.getCache(e).order.length===0}isRowsToRender(e){return!this.isEmpty(e)}isManual(){return!1}pinRow(e,t){}onGridStylesChanges(e){if(e.rowHeightChanged){let t=i=>{i.setRowHeight(i.rowHeight,!0)};Gl(this.pinnedBottomRows,t),Gl(this.pinnedTopRows,t)}}ensureRowHeightsValid(){let e=!1,t=0,i=n=>{if(n.rowHeightEstimated){let o=Yo(this.beans,n);n.setRowTop(t),n.setRowHeight(o.height),t+=o.height,e=!0}};return Gl(this.pinnedBottomRows,i),t=0,Gl(this.pinnedTopRows,i),this.eventSvc.dispatchEvent({type:"pinnedHeightChanged"}),e}setPinnedRowData(e,t){this.updateNodesFromRowData(e,t),this.eventSvc.dispatchEvent({type:"pinnedRowDataChanged"})}updateNodesFromRowData(e,t){let i=this.getCache(t);if(e===void 0){i.order.length=0,i.cache={};return}let n=Ca(this.gos),o=t==="top"?yv:Sv,s=new Set(i.order),r=[],a=new Set,l=0,d=-1;for(let c of e){let u=n?.({data:c,level:0,rowPinned:t})??o+this.nextId++;if(a.has(u)){I(96,{id:u,data:c});continue}d++,a.add(u),r.push(u);let h=Zl(i,u);if(h!==void 0)h.data!==c&&h.updateData(c),l+=this.setRowTopAndRowIndex(h,l,d),s.delete(u);else{let p=new Jo(this.beans);p.id=u,p.data=c,p.rowPinned=t,l+=this.setRowTopAndRowIndex(p,l,d),i.cache[u]=p,i.order.push(u)}}for(let c of s)Zl(i,c)?.clearRowTopAndRowIndex(),delete i.cache[c];i.order=r}setRowTopAndRowIndex(e,t,i){return e.setRowTop(t),e.setRowHeight(Yo(this.beans,e).height),e.setRowIndex(i),e.rowHeight}getPinnedTopTotalHeight(){return iR(this.pinnedTopRows)}getPinnedBottomTotalHeight(){return iR(this.pinnedBottomRows)}getPinnedTopRowCount(){return VC(this.pinnedTopRows)}getPinnedBottomRowCount(){return VC(this.pinnedBottomRows)}getPinnedTopRow(e){return GC(this.pinnedTopRows,e)}getPinnedBottomRow(e){return GC(this.pinnedBottomRows,e)}getPinnedRowById(e,t){return Zl(this.getCache(t),e)}forEachPinnedRow(e,t){return Gl(this.getCache(e),t)}getCache(e){return e==="top"?this.pinnedTopRows:this.pinnedBottomRows}getPinnedState(){return{top:[],bottom:[]}}setPinnedState(){}getGrandTotalPinned(){}setGrandTotalPinned(){}};function iR(e){let t=VC(e);if(t===0)return 0;let i=GC(e,t-1);return i===void 0?0:i.rowTop+i.rowHeight}function Zl(e,t){return e.cache[t]}function GC(e,t){return Zl(e,e.order[t])}function Gl(e,t){e.order.forEach((i,n)=>{let o=Zl(e,i);o&&t(o,n)})}function VC(e){return e.order.length}var AG=class extends D{constructor(){super(...arguments),this.beanName="pinnedRowModel"}postConstruct(){let{gos:e}=this,t=()=>{let i=e.get("enableRowPinning"),n=w6(e),s=!!i||(n==="pinnedBottom"||n==="pinnedTop"),r=s?this.inner instanceof tR:this.inner instanceof QE;this.inner&&r&&this.destroyBean(this.inner),(r||!this.inner)&&(this.inner=this.createManagedBean(s?new QE:new tR))};this.addManagedPropertyListeners(["enableRowPinning","grandTotalRow"],t),t()}reset(){return this.inner.reset()}isEmpty(e){return this.inner.isEmpty(e)}isManual(){return this.inner.isManual()}isRowsToRender(e){return this.inner.isRowsToRender(e)}pinRow(e,t,i){return this.inner.pinRow(e,t,i)}ensureRowHeightsValid(){return this.inner.ensureRowHeightsValid()}getPinnedRowById(e,t){return this.inner.getPinnedRowById(e,t)}getPinnedTopTotalHeight(){return this.inner.getPinnedTopTotalHeight()}getPinnedBottomTotalHeight(){return this.inner.getPinnedBottomTotalHeight()}getPinnedTopRowCount(){return this.inner.getPinnedTopRowCount()}getPinnedBottomRowCount(){return this.inner.getPinnedBottomRowCount()}getPinnedTopRow(e){return this.inner.getPinnedTopRow(e)}getPinnedBottomRow(e){return this.inner.getPinnedBottomRow(e)}forEachPinnedRow(e,t){return this.inner.forEachPinnedRow(e,t)}getPinnedState(){return this.inner.getPinnedState()}setPinnedState(e){return this.inner.setPinnedState(e)}setGrandTotalPinned(e){return this.inner.setGrandTotalPinned(e)}getGrandTotalPinned(){return this.inner.getGrandTotalPinned()}};function Sd(e){return!!(e.rowPinned&&e.pinnedSibling)}function Oi(e,t,i,n){let o=t==="top";if(!i)return Oi(e,t,o?e.getPinnedTopRow(0):e.getPinnedBottomRow(0),n);if(!n){let l=o?e.getPinnedTopRowCount():e.getPinnedBottomRowCount();return Oi(e,t,i,o?e.getPinnedTopRow(l-1):e.getPinnedBottomRow(l-1))}let s=!1,r=!1,a=[];return e.forEachPinnedRow(t,l=>{if(l===i&&!s){s=!0,a.push(l);return}if(s&&l===n){r=!0,a.push(l);return}s&&!r&&a.push(l)}),a}var IG={tag:"div",cls:"ag-selection-checkbox",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},LG=class extends Oe{constructor(){super(IG,[mv]),this.eCheckbox=V}postConstruct(){this.eCheckbox.setPassive(!0)}onDataChanged(){this.onSelectionChanged()}onSelectableChanged(){this.showOrHideSelect()}onSelectionChanged(){let e=this.getLocaleTextFunc(),{rowNode:t,eCheckbox:i}=this,n=t.isSelected(),o=kp(e,n),[s,r]=t.selectable?["ariaRowToggleSelection","Press Space to toggle row selection"]:["ariaRowSelectionDisabled","Row Selection is disabled for this row"],a=e(s,r);i.setValue(n,!0),i.setInputAriaLabel(`${a} (${o})`)}init(e){if(this.rowNode=e.rowNode,this.column=e.column,this.overrides=e.overrides,this.onSelectionChanged(),this.addManagedListeners(this.eCheckbox.getInputElement(),{dblclick:Ks,click:n=>{Ks(n),this.beans.selectionSvc?.handleSelectionEvent(n,this.rowNode,"checkboxSelected")}}),this.addManagedListeners(this.rowNode,{rowSelected:this.onSelectionChanged.bind(this),dataChanged:this.onDataChanged.bind(this),selectableChanged:this.onSelectableChanged.bind(this)}),this.addManagedPropertyListener("rowSelection",({currentValue:n,previousValue:o})=>{let s=typeof n=="object"?G0(n):void 0,r=typeof o=="object"?G0(o):void 0;s!==r&&this.onSelectableChanged()}),PC(this.gos)||typeof this.getIsVisible()=="function"){let n=this.showOrHideSelect.bind(this);this.addManagedEventListeners({displayedColumnsChanged:n}),this.addManagedListeners(this.rowNode,{dataChanged:n,cellChanged:n}),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")}showOrHideSelect(){let{column:e,rowNode:t,overrides:i,gos:n}=this,o=t.selectable,s=this.getIsVisible(),r;if(typeof s=="function"){let u=i?.callbackParams;if(!e)r=s(_(b({},u),{node:t,data:t.data}));else{let h=e.createColumnFunctionCallbackParams(t);r=s(b(b({},u),h))}}else r=s??!1;let a=o&&!r||!o&&r,l=o||r,d=n.get("rowSelection"),c=d&&typeof d!="string"?!G0(d):!!e?.getColDef().showDisabledCheckboxes;this.setVisible(l&&(a?c:!0)),this.setDisplayed(l&&(a?c:!0)),l&&this.eCheckbox.setDisabled(a),i?.removeHidden&&this.setDisplayed(l)}getIsVisible(){let e=this.overrides;if(e)return e.isVisible;let t=this.gos.get("rowSelection");return t&&typeof t!="string"?da(t):this.column?.getColDef()?.checkboxSelection}},_G=class{constructor(e,t){this.rowModel=e,this.pinnedRowModel=t,this.selectAll=!1,this.rootId=null,this.endId=null,this.cachedRange=[]}reset(){this.rootId=null,this.endId=null,this.cachedRange.length=0}setRoot(e){this.rootId=e.id,this.endId=null,this.cachedRange.length=0}setEndRange(e){this.endId=e.id,this.cachedRange.length=0}getRange(){if(this.cachedRange.length===0){let e=this.getRoot(),t=this.getEnd();if(e==null||t==null)return this.cachedRange;this.cachedRange=this.getNodesInRange(e,t)??[]}return this.cachedRange}isInRange(e){return this.rootId===null?!1:this.getRange().some(t=>t.id===e.id)}getRoot(e){if(this.rootId)return this.getRowNode(this.rootId);if(e)return this.setRoot(e),e}getEnd(){if(this.endId)return this.getRowNode(this.endId)}getRowNode(e){let t,{rowModel:i,pinnedRowModel:n}=this;return t??(t=i.getRowNode(e)),n?.isManual()&&(t??(t=n.getPinnedRowById(e,"top")),t??(t=n.getPinnedRowById(e,"bottom"))),t}truncate(e){let t=this.getRange();if(t.length===0)return{keep:[],discard:[]};let i=t[0].id===this.rootId,n=t.findIndex(o=>o.id===e.id);if(n>-1){let o=t.slice(0,n),s=t.slice(n+1);return this.setEndRange(e),i?{keep:o,discard:s}:{keep:s,discard:o}}else return{keep:t,discard:[]}}extend(e,t=!1){let i=this.getRoot();if(i==null){let o=this.getRange().slice();return t&&e.depthFirstSearch(s=>!s.group&&o.push(s)),o.push(e),this.setRoot(e),{keep:o,discard:[]}}let n=this.getNodesInRange(i,e);if(!n)return this.setRoot(e),{keep:[e],discard:[]};if(n.find(o=>o.id===this.endId))return this.setEndRange(e),{keep:this.getRange(),discard:[]};{let o=this.getRange().slice();return this.setEndRange(e),{keep:this.getRange(),discard:o}}}getNodesInRange(e,t){let{pinnedRowModel:i,rowModel:n}=this;if(!i?.isManual())return n.getNodesInRangeForSelection(e,t);if(e.rowPinned==="top"&&!t.rowPinned)return Oi(i,"top",e,void 0).concat(n.getNodesInRangeForSelection(n.getRow(0),t)??[]);if(e.rowPinned==="bottom"&&!t.rowPinned){let o=Oi(i,"bottom",void 0,e),s=n.getRowCount(),r=n.getRow(s-1);return(n.getNodesInRangeForSelection(t,r)??[]).concat(o)}if(!e.rowPinned&&!t.rowPinned)return n.getNodesInRangeForSelection(e,t);if(e.rowPinned==="top"&&t.rowPinned==="top")return Oi(i,"top",e,t);if(e.rowPinned==="bottom"&&t.rowPinned==="top"){let o=Oi(i,"top",t,void 0),s=Oi(i,"bottom",void 0,e),r=n.getRow(0),a=n.getRow(n.getRowCount()-1);return o.concat(n.getNodesInRangeForSelection(r,a)??[]).concat(s)}if(!e.rowPinned&&t.rowPinned==="top")return Oi(i,"top",t,void 0).concat(n.getNodesInRangeForSelection(n.getRow(0),e)??[]);if(e.rowPinned==="top"&&t.rowPinned==="bottom"){let o=Oi(i,"top",e,void 0),s=Oi(i,"bottom",void 0,t),r=n.getRow(0),a=n.getRow(n.getRowCount()-1);return o.concat(n.getNodesInRangeForSelection(r,a)??[]).concat(s)}if(e.rowPinned==="bottom"&&t.rowPinned==="bottom")return Oi(i,"bottom",e,t);if(!e.rowPinned&&t.rowPinned==="bottom"){let o=Oi(i,"bottom",void 0,t),s=n.getRow(n.getRowCount());return(n.getNodesInRangeForSelection(e,s)??[]).concat(o)}return null}},OG=class extends D{constructor(e){super(),this.column=e,this.cbSelectAllVisible=!1,this.processingEventFromCheckbox=!1}onSpaceKeyDown(e){let t=this.cbSelectAll;t.isDisplayed()&&!t.getGui().contains(tt(this.beans))&&(e.preventDefault(),t.setValue(!t.getValue()))}getCheckboxGui(){return this.cbSelectAll.getGui()}setComp(e){this.headerCellCtrl=e;let t=this.createManagedBean(new fv);this.cbSelectAll=t,t.addCss("ag-header-select-all"),jo(t.getGui(),"presentation"),this.showOrHideSelectAll();let i=this.updateStateOfCheckbox.bind(this);this.addManagedEventListeners({newColumnsLoaded:()=>this.showOrHideSelectAll(),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),selectionChanged:i,paginationChanged:i,modelUpdated:i}),this.addManagedPropertyListener("rowSelection",({currentValue:n,previousValue:o})=>{let s=r=>typeof r=="string"||!r||r.mode==="singleRow"?void 0:r.selectAll;s(n)!==s(o)&&this.showOrHideSelectAll(),this.updateStateOfCheckbox()}),this.addManagedListeners(t,{fieldValueChanged:this.onCbSelectAll.bind(this)}),t.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()}onDisplayedColumnsChanged(e){this.isAlive()&&this.showOrHideSelectAll(e.source==="uiColumnMoved")}showOrHideSelectAll(e=!1){let t=this.isCheckboxSelection();this.cbSelectAllVisible=t,this.cbSelectAll.setDisplayed(t),t&&(this.checkRightRowModelType("selectAllCheckbox"),this.checkSelectionType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel(e)}updateStateOfCheckbox(){if(!this.cbSelectAllVisible||this.processingEventFromCheckbox)return;this.processingEventFromCheckbox=!0;let e=this.getSelectAllMode(),t=this.beans.selectionSvc,i=this.cbSelectAll,n=t.getSelectAllState(e);i.setValue(n);let o=t.hasNodesToSelect(e);i.setDisabled(!o),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}refreshSelectAllLabel(e=!1){let t=this.getLocaleTextFunc(),{headerCellCtrl:i,cbSelectAll:n,cbSelectAllVisible:o}=this,s=n.getValue(),r=kp(t,s),a=t("ariaRowSelectAll","Press Space to toggle all rows selection");i.setAriaDescriptionProperty("selectAll",o?`${a} (${r})`:null),n.setInputAriaLabel(t("ariaHeaderSelection","Column with Header Selection")),e||i.announceAriaDescription()}checkSelectionType(e){return dd(this.gos)?!0:(I(128,{feature:e}),!1)}checkRightRowModelType(e){let{gos:t,rowModel:i}=this.beans;return gt(t)||xa(t)?!0:(I(129,{feature:e,rowModel:i.getType()}),!1)}onCbSelectAll(){if(this.processingEventFromCheckbox||!this.cbSelectAllVisible)return;let e=this.cbSelectAll.getValue(),t=this.getSelectAllMode(),i="uiSelectAll";t==="currentPage"?i="uiSelectAllCurrentPage":t==="filtered"&&(i="uiSelectAllFiltered");let n={source:i,selectAll:t},o=this.beans.selectionSvc;e?o.selectAllRowNodes(n):o.deselectAllRowNodes(n)}isCheckboxSelection(){let{column:e,gos:t,beans:i}=this,s=typeof t.get("rowSelection")=="object"?"headerCheckbox":"headerCheckboxSelection";return A4(i,e)&&this.checkRightRowModelType(s)&&this.checkSelectionType(s)}getSelectAllMode(){let e=x6(this.gos,!1);if(e)return e;let{headerCheckboxSelectionCurrentPageOnly:t,headerCheckboxSelectionFilteredOnly:i}=this.column.getColDef();return t?"currentPage":i?"filtered":"all"}destroy(){super.destroy(),this.cbSelectAll=void 0,this.headerCellCtrl=void 0}};function A4({gos:e,selectionColSvc:t},i){let n=e.get("rowSelection"),o=i.getColDef(),{headerCheckboxSelection:s}=o,r=!1;if(typeof n=="object"){let l=go(i),d=uv(i);(hp(n)==="autoGroupColumn"&&d||l&&t?.isSelectionColumnEnabled())&&(r=Xh(n))}else typeof s=="function"?r=s(te(e,{column:i,colDef:o})):r=!!s;return r}var NG=class extends D{postConstruct(){let{gos:e,beans:t}=this;this.selectionCtx=new _G(t.rowModel,t.pinnedRowModel),this.addManagedPropertyListeners(["isRowSelectable","rowSelection"],()=>{let i=PC(e);i!==this.isRowSelectable&&(this.isRowSelectable=i,this.updateSelectable())}),this.isRowSelectable=PC(e),this.addManagedEventListeners({cellValueChanged:i=>this.updateRowSelectable(i.node),rowNodeDataChanged:i=>this.updateRowSelectable(i.node)})}destroy(){super.destroy(),this.selectionCtx.reset()}createCheckboxSelectionComponent(){return new LG}createSelectAllFeature(e){if(A4(this.beans,e))return new OG(e)}isMultiSelect(){return dd(this.gos)}onRowCtrlSelected(e,t,i){let n=!!e.rowNode.isSelected();e.forEachGui(i,o=>{o.rowComp.toggleCss("ag-row-selected",n);let s=o.element;$R(s,n),s.contains(tt(this.beans))&&t(o)})}announceAriaRowSelection(e){if(this.isRowSelectionBlocked(e))return;let t=e.isSelected(),i=this.beans.editSvc?.isEditing({rowNode:e});if(!e.selectable||i)return;let o=this.getLocaleTextFunc()(t?"ariaRowDeselect":"ariaRowSelect",`Press SPACE to ${t?"deselect":"select"} this row`);this.beans.ariaAnnounce?.announceValue(o,"rowSelection")}isRowSelectionBlocked(e){return!e.selectable||e.rowPinned&&!Sd(e)||!Gs(this.gos)}updateRowSelectable(e,t){let i=e.rowPinned&&e.pinnedSibling?e.pinnedSibling.selectable:this.isRowSelectable?.(e)??!0;return this.setRowSelectable(e,i,t),i}setRowSelectable(e,t,i){if(e.selectable!==t){if(e.selectable=t,e.dispatchRowEvent("selectableChanged"),i)return;if(cd(this.gos)){let o=this.calculateSelectedFromChildren(e);this.setNodesSelected({nodes:[e],newValue:o??!1,source:"selectableChanged"});return}e.isSelected()&&!e.selectable&&this.setNodesSelected({nodes:[e],newValue:!1,source:"selectableChanged"})}}calculateSelectedFromChildren(e){let t=!1,i=!1;if(!e.childrenAfterGroup?.length)return e.selectable?e.__selected:null;for(let n=0;n<e.childrenAfterGroup.length;n++){let o=e.childrenAfterGroup[n],s=o.isSelected();if(!o.selectable){let r=this.calculateSelectedFromChildren(o);if(r===null)continue;s=r}switch(s){case!0:t=!0;break;case!1:i=!0;break;default:return}}if(!(t&&i))return t?!0:i?!1:e.selectable?e.__selected:null}selectRowNode(e,t,i,n="api"){let o=!e.selectable&&t,s=e.__selected===t;if(o||s)return!1;e.__selected=t,e.dispatchRowEvent("rowSelected");let r=e.sibling;r&&r.footer&&r.__localEventService&&r.dispatchRowEvent("rowSelected");let a=e.pinnedSibling;return a?.rowPinned&&a.__localEventService&&a.dispatchRowEvent("rowSelected"),this.eventSvc.dispatchEvent(_(b({},WB(e,this.gos,"rowSelected")),{event:i||null,source:n})),!0}isCellCheckboxSelection(e,t){let i=this.gos.get("rowSelection");if(i&&typeof i!="string"){let n=go(e)&&da(i);return e.isColumnFunc(t,n)}else return e.isColumnFunc(t,e.colDef.checkboxSelection)}inferNodeSelections(e,t,i,n){let{gos:o,selectionCtx:s}=this,r=e.isSelected(),a=cd(o),l=hO(o),d=pO(o),c=this.isMultiSelect(),u=n==="rowClicked";if(u&&!(l||d))return null;if(t&&i&&c){let h=s.getRoot();if(h)if(h.isSelected()){let p=s.isInRange(e)?s.truncate(e):s.extend(e,a);return{deselect:p.discard,select:p.keep,reset:!1}}else{let p=s.extend(e,a);return{select:[],deselect:p.keep,reset:!1}}else return null}else if(t&&c){let h=s.selectAll?this.beans.rowModel.getRow(0):void 0,p=s.getRoot(h),g=s.isInRange(e)?s.truncate(e):s.extend(e,a);return{select:g.keep,deselect:g.discard,reset:s.selectAll||!!(p&&!p.isSelected())}}else if(i){if(u){let h=!r;return h&&!l||!h&&!d?null:(s.setRoot(e),{node:e,newValue:h,clearSelection:!1})}return s.setRoot(e),{node:e,newValue:!r,clearSelection:!c}}else{s.setRoot(e);let h=gO(o),p=gp(o)==="filteredDescendants",g=u&&(!h||!l);if(p&&r===void 0&&gt(o))return{node:e,newValue:!1,checkFilteredNodes:!0,clearSelection:!c||g};if(u){let f=r?!h:l;return f===r&&!g||f&&!l||!f&&!d?null:{node:e,newValue:f,clearSelection:!c||g,keepDescendants:e.group&&a}}return{node:e,newValue:!r,clearSelection:!c||g}}}},sC={TAB_GUARD:"ag-tab-guard",TAB_GUARD_TOP:"ag-tab-guard-top",TAB_GUARD_BOTTOM:"ag-tab-guard-bottom"},BG=class extends D{constructor(e){super(),this.skipTabGuardFocus=!1,this.forcingFocusOut=!1,this.allowFocus=!1;let{comp:t,eTopGuard:i,eBottomGuard:n,focusTrapActive:o,forceFocusOutWhenTabGuardsAreEmpty:s,isFocusableContainer:r,focusInnerElement:a,onFocusIn:l,onFocusOut:d,shouldStopEventPropagation:c,onTabKeyDown:u,handleKeyDown:h,isEmpty:p,eFocusableElement:g}=e;this.comp=t,this.eTopGuard=i,this.eBottomGuard=n,this.providedFocusInnerElement=a,this.eFocusableElement=g,this.focusTrapActive=!!o,this.forceFocusOutWhenTabGuardsAreEmpty=!!s,this.isFocusableContainer=!!r,this.providedFocusIn=l,this.providedFocusOut=d,this.providedShouldStopEventPropagation=c,this.providedOnTabKeyDown=u,this.providedHandleKeyDown=h,this.providedIsEmpty=p}postConstruct(){this.createManagedBean(new Ea(this.eFocusableElement,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e)})),this.activateTabGuards();for(let e of[this.eTopGuard,this.eBottomGuard])this.addManagedElementListeners(e,{focus:this.onFocus.bind(this)})}handleKeyDown(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return this.providedShouldStopEventPropagation?this.providedShouldStopEventPropagation():!1}activateTabGuards(){if(this.forcingFocusOut)return;let e=this.gos.get("tabIndex");this.comp.setTabIndex(e.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(e){if(this.isFocusableContainer&&!this.eFocusableElement.contains(e.relatedTarget)&&!this.allowFocus){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.skipTabGuardFocus){this.skipTabGuardFocus=!1;return}if(this.forceFocusOutWhenTabGuardsAreEmpty&&(this.providedIsEmpty?this.providedIsEmpty():ua(this.eFocusableElement,".ag-tab-guard").length===0)){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.isFocusableContainer&&this.eFocusableElement.contains(e.relatedTarget))return;let t=e.target===this.eBottomGuard;!(this.providedFocusInnerElement?this.providedFocusInnerElement(t):this.focusInnerElement(t))&&this.forceFocusOutWhenTabGuardsAreEmpty&&this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard)}findNextElementOutsideAndFocus(e){let t=kt(this.beans),i=ua(t.body,null,!0),n=i.indexOf(e?this.eTopGuard:this.eBottomGuard);if(n===-1)return;let o,s;e?(o=0,s=n):(o=n+1,s=i.length);let r=i.slice(o,s),a=this.gos.get("tabIndex");r.sort((l,d)=>{let c=Number.parseInt(l.getAttribute("tabindex")||"0"),u=Number.parseInt(d.getAttribute("tabindex")||"0");return u===a?1:c===a?-1:c===0?1:u===0?-1:c-u}),r[e?r.length-1:0]?.focus()}onFocusIn(e){this.focusTrapActive||this.forcingFocusOut||(this.providedFocusIn&&this.providedFocusIn(e),this.isFocusableContainer||this.deactivateTabGuards())}onFocusOut(e){this.focusTrapActive||(this.providedFocusOut&&this.providedFocusOut(e),this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards())}onTabKeyDown(e){if(this.providedOnTabKeyDown){this.providedOnTabKeyDown(e);return}if(this.focusTrapActive||e.defaultPrevented)return;let t=this.tabGuardsAreActive();t&&this.deactivateTabGuards();let i=this.getNextFocusableElement(e.shiftKey);t&&setTimeout(()=>this.activateTabGuards(),0),i&&(i.focus(),e.preventDefault())}focusInnerElement(e=!1){let t=ua(this.eFocusableElement);return this.tabGuardsAreActive()&&(t.splice(0,1),t.splice(t.length-1,1)),t.length?(t[e?t.length-1:0].focus({preventScroll:!0}),!0):!1}getNextFocusableElement(e){return Qs(this.beans,this.eFocusableElement,!1,e)}forceFocusOutOfContainer(e=!1){if(this.forcingFocusOut)return;let t=e?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,this.forcingFocusOut=!0,t.focus(),window.setTimeout(()=>{this.forcingFocusOut=!1,this.activateTabGuards()})}isTabGuard(e,t){return e===this.eTopGuard&&!t||e===this.eBottomGuard&&(t??!0)}setAllowFocus(e){this.allowFocus=e}},HG=class extends D{constructor(e){super(),this.comp=e}initialiseTabGuard(e){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.comp.getFocusableElement();let{eTopGuard:t,eBottomGuard:i,eFocusableElement:n}=this,o=[t,i],s={setTabIndex:m=>{for(let C of o)m!=null?C.setAttribute("tabindex",m):C.removeAttribute("tabindex")}};this.addTabGuards(t,i);let{focusTrapActive:r=!1,onFocusIn:a,onFocusOut:l,focusInnerElement:d,handleKeyDown:c,onTabKeyDown:u,shouldStopEventPropagation:h,isEmpty:p,forceFocusOutWhenTabGuardsAreEmpty:g,isFocusableContainer:f}=e;this.tabGuardCtrl=this.createManagedBean(new BG({comp:s,focusTrapActive:r,eTopGuard:t,eBottomGuard:i,eFocusableElement:n,onFocusIn:a,onFocusOut:l,focusInnerElement:d,handleKeyDown:c,onTabKeyDown:u,shouldStopEventPropagation:h,isEmpty:p,forceFocusOutWhenTabGuardsAreEmpty:g,isFocusableContainer:f}))}getTabGuardCtrl(){return this.tabGuardCtrl}createTabGuard(e){let t=kt(this.beans).createElement("div"),i=e==="top"?sC.TAB_GUARD_TOP:sC.TAB_GUARD_BOTTOM;return t.classList.add(sC.TAB_GUARD,i),jo(t,"presentation"),t}addTabGuards(e,t){let i=this.eFocusableElement;i.insertAdjacentElement("afterbegin",e),i.insertAdjacentElement("beforeend",t)}removeAllChildrenExceptTabGuards(){let e=[this.eTopGuard,this.eBottomGuard];Ot(this.comp.getFocusableElement()),this.addTabGuards(...e)}forceFocusOutOfContainer(e=!1){this.tabGuardCtrl.forceFocusOutOfContainer(e)}appendChild(e,t,i){sv(t)||(t=t.getGui());let{eBottomGuard:n}=this;n?n.insertAdjacentElement("beforebegin",t):e(t,i)}destroy(){let{eTopGuard:e,eBottomGuard:t}=this;hi(e),hi(t),super.destroy()}},I4=class extends Oe{initialiseTabGuard(e){this.tabGuardFeature=this.createManagedBean(new HG(this)),this.tabGuardFeature.initialiseTabGuard(e)}forceFocusOutOfContainer(e=!1){this.tabGuardFeature.forceFocusOutOfContainer(e)}appendChild(e,t){this.tabGuardFeature.appendChild(super.appendChild.bind(this),e,t)}},GG=500,VG=550,Uh,zG=e=>{if(!Uh)Uh=new WeakSet;else if(Uh.has(e))return!1;return Uh.add(e),!0},Os=class{constructor(e,t=!1){this.eElement=e,this.preventClick=t,this.startListener=null,this.handlers=[],this.eventSvc=void 0,this.touchStart=null,this.lastTapTime=null,this.longPressTimer=0,this.moved=!1}addEventListener(e,t){let i=this.eventSvc;if(!i){if(i===null)return;this.eventSvc=i=new qs;let n=this.onTouchStart.bind(this);this.startListener=n,this.eElement.addEventListener("touchstart",n,{passive:!0})}i.addEventListener(e,t)}removeEventListener(e,t){this.eventSvc?.removeEventListener(e,t)}onTouchStart(e){if(this.touchStart||!zG(e))return;let t=e.touches[0];this.touchStart=t;let i=this.handlers;if(!i.length){let n=this.eElement,o=n.ownerDocument,s=this.onTouchMove.bind(this),r=this.onTouchEnd.bind(this),a=this.onTouchCancel.bind(this),l={passive:!0},d={passive:!1};Kh(i,[n,"touchmove",s,l],[o,"touchcancel",a,l],[o,"touchend",r,d],[o,"contextmenu",Uo,d])}this.clearLongPress(),this.longPressTimer=window.setTimeout(()=>{this.longPressTimer=0,this.touchStart===t&&!this.moved&&(this.moved=!0,this.eventSvc?.dispatchEvent({type:"longTap",touchStart:t,touchEvent:e}))},VG)}onTouchMove(e){let{moved:t,touchStart:i}=this;if(!t&&i){let n=Xl(i,e.touches);n&&!i6(n,i,4)&&(this.clearLongPress(),this.moved=!0)}}onTouchEnd(e){let t=this.touchStart;!t||!Xl(t,e.changedTouches)||(this.moved||(this.eventSvc?.dispatchEvent({type:"tap",touchStart:t}),this.checkDoubleTap(t)),this.preventClick&&Uo(e),this.cancel())}onTouchCancel(e){let t=this.touchStart;!t||!Xl(t,e.changedTouches)||(this.lastTapTime=null,this.cancel())}checkDoubleTap(e){let t=Date.now(),i=this.lastTapTime;i&&t-i>GG&&(this.eventSvc?.dispatchEvent({type:"doubleTap",touchStart:e}),t=null),this.lastTapTime=t}cancel(){this.clearLongPress(),rv(this.handlers),this.touchStart=null}clearLongPress(){window.clearTimeout(this.longPressTimer),this.longPressTimer=0,this.moved=!1}destroy(){let e=this.startListener;e&&(this.startListener=null,this.eElement.removeEventListener("touchstart",e)),this.cancel(),this.eElement=null,this.eventSvc=null}};var WG=class{constructor(e){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=e.scrollContainer,this.scrollHorizontally=e.scrollAxis.includes("x"),this.scrollVertically=e.scrollAxis.includes("y"),this.scrollByTick=e.scrollByTick!=null?e.scrollByTick:20,e.onScrollCallback&&(this.onScrollCallback=e.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=e.getVerticalPosition,this.setVerticalPosition=e.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=e.getHorizontalPosition,this.setHorizontalPosition=e.setHorizontalPosition),this.shouldSkipVerticalScroll=e.shouldSkipVerticalScroll||(()=>!1),this.shouldSkipHorizontalScroll=e.shouldSkipHorizontalScroll||(()=>!1)}get scrolling(){return this.tickingInterval!==null}check(e,t=!1){let i=t||this.shouldSkipVerticalScroll();if(i&&this.shouldSkipHorizontalScroll())return;let n=this.scrollContainer.getBoundingClientRect(),o=this.scrollByTick;this.tickLeft=e.clientX<n.left+o,this.tickRight=e.clientX>n.right-o,this.tickUp=e.clientY<n.top+o&&!i,this.tickDown=e.clientY>n.bottom-o&&!i,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}ensureTickingStarted(){this.tickingInterval===null&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)}doTick(){this.tickCount++;let e=this.tickCount>20?200:this.tickCount>10?80:40;if(this.scrollVertically){let t=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(t-e),this.tickDown&&this.setVerticalPosition(t+e)}if(this.scrollHorizontally){let t=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(t-e),this.tickRight&&this.setHorizontalPosition(t+e)}this.onScrollCallback&&this.onScrollCallback()}ensureCleared(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)}},Av=class{constructor(e="javascript"){this.frameworkName=e,this.renderingEngine="vanilla",this.batchFrameworkComps=!1,this.wrapIncoming=t=>t(),this.wrapOutgoing=t=>t(),this.baseDocLink=`${s6}/${this.frameworkName}-data-grid`,tO(this.baseDocLink)}frameworkComponent(e){return null}isFrameworkComponent(e){return!1}getDocLink(e){return this.baseDocLink+(e?"/"+e:"")}};function UG(e){return{beanName:"gridApi",bean:e.getBean("apiFunctionSvc").api}}var qG=["licenseManager","environment","eventSvc","gos","paginationAutoPageSizeSvc","apiFunctionSvc","gridApi","registry","agCompUtils","userCompFactory","rowContainerHeight","horizontalResizeSvc","localeSvc","pinnedRowModel","dragSvc","colGroupSvc","visibleCols","popupSvc","selectionSvc","colFilter","quickFilter","filterManager","colModel","headerNavigation","pageBounds","pagination","pageBoundsListener","rowSpanSvc","stickyRowSvc","rowRenderer","expressionSvc","alignedGridsSvc","navigation","valueCache","valueSvc","autoWidthCalc","filterMenuFactory","dragAndDrop","focusSvc","cellNavigation","cellStyles","scrollVisibleSvc","sortSvc","colHover","colAnimation","autoColSvc","selectionColSvc","changeDetectionSvc","animationFrameSvc","undoRedo","colDefFactory","rowStyleSvc","rowNodeBlockLoader","rowNodeSorter","ctrlsSvc","pinnedCols","dataTypeSvc","syncSvc","overlays","stateSvc","expansionSvc","apiEventSvc","ariaAnnounce","menuSvc","colMoves","colAutosize","colFlex","colResize","pivotColsSvc","valueColsSvc","rowGroupColsSvc","colNames","colViewport","pivotResultCols","showRowGroupCols","validation"],nR=Object.fromEntries(qG.map((e,t)=>[e,t]));function $G(e,t){let i=(e.beanName?nR[e.beanName]:void 0)??Number.MAX_SAFE_INTEGER,n=(t.beanName?nR[t.beanName]:void 0)??Number.MAX_SAFE_INTEGER;return i-n}function jG(e,t){return e?.beanName==="gridDestroySvc"?-1:t?.beanName==="gridDestroySvc"?1:0}var KG={tag:"div",cls:"ag-pinned-left-header",role:"rowgroup"},YG={tag:"div",cls:"ag-pinned-right-header",role:"rowgroup"},XG={tag:"div",cls:"ag-header-viewport",role:"rowgroup",attrs:{tabindex:"-1"},children:[{tag:"div",ref:"eCenterContainer",cls:"ag-header-container",role:"presentation"}]},rC=class extends Oe{constructor(e){super(),this.eCenterContainer=V,this.headerRowComps={},this.rowCompsList=[],this.pinned=e}postConstruct(){this.selectAndSetTemplate();let e={setDisplayed:i=>this.setDisplayed(i),setCtrls:i=>this.setCtrls(i),setCenterWidth:i=>this.eCenterContainer.style.width=i,setViewportScrollLeft:i=>this.getGui().scrollLeft=i,setPinnedContainerWidth:i=>{let n=this.getGui();n.style.width=i,n.style.maxWidth=i,n.style.minWidth=i}};this.createManagedBean(new hG(this.pinned)).setComp(e,this.getGui())}selectAndSetTemplate(){let e=this.pinned=="left",t=this.pinned=="right",i=e?KG:t?YG:XG;this.setTemplate(i),this.eRowContainer=this.eCenterContainer!==V?this.eCenterContainer:this.getGui()}destroy(){this.setCtrls([]),super.destroy()}destroyRowComp(e){this.destroyBean(e),e.getGui().remove()}setCtrls(e){let t=this.headerRowComps;this.headerRowComps={},this.rowCompsList=[];let i,n=o=>{let s=o.getGui();s.parentElement!=this.eRowContainer&&this.eRowContainer.appendChild(s),i&&JR(this.eRowContainer,s,i),i=s};for(let o of e){let s=o.instanceId,r=t[s];delete t[s];let a=r||this.createBean(new lG(o));this.headerRowComps[s]=a,this.rowCompsList.push(a),n(a)}for(let o of Object.values(t))this.destroyRowComp(o)}},JG={tag:"div",cls:"ag-header",role:"presentation"},QG=class extends Oe{constructor(){super(JG)}postConstruct(){let e={toggleCss:(n,o)=>this.toggleCss(n,o),setHeightAndMinHeight:n=>{this.getGui().style.height=n,this.getGui().style.minHeight=n}};this.createManagedBean(new tG).setComp(e,this.getGui(),this.getFocusableElement());let i=n=>{this.createManagedBean(n),this.appendChild(n)};i(new rC("left")),i(new rC(null)),i(new rC("right"))}},ZG={selector:"AG-HEADER-ROOT",component:QG},eV=class extends Oe{constructor(e,t,i,n,o){super(),this.cellCtrl=t,this.rendererVersion=0,this.editorVersion=0,this.beans=e,this.gos=e.gos,this.column=t.column,this.rowNode=t.rowNode,this.eRow=n;let s=ft({tag:"div",role:t.getCellAriaRole(),attrs:{"comp-id":`${this.getCompId()}`,"col-id":t.column.colIdSanitised}});this.eCell=s;let r;t.isCellSpanning()?(r=ft({tag:"div",cls:"ag-spanned-cell-wrapper",role:"presentation"}),r.appendChild(s),this.setTemplateFromElement(r)):this.setTemplateFromElement(s),this.cellCssManager=new H6(()=>s),this.forceWrapper=t.isForceWrapper(),this.refreshWrapper(!1);let a={toggleCss:(l,d)=>this.cellCssManager.toggleCss(l,d),setUserStyles:l=>md(s,l),getFocusableElement:()=>s,setIncludeSelection:l=>this.includeSelection=l,setIncludeRowDrag:l=>this.includeRowDrag=l,setIncludeDndSource:l=>this.includeDndSource=l,setRenderDetails:(l,d,c)=>this.setRenderDetails(l,d,c),setEditDetails:(l,d,c)=>this.setEditDetails(l,d,c),getCellEditor:()=>this.cellEditor||null,getCellRenderer:()=>this.cellRenderer||null,getParentOfValue:()=>this.getParentOfValue(),refreshEditStyles:(l,d)=>this.refreshEditStyles(l,d)};t.setComp(a,s,r,this.eCellWrapper,i,o,void 0)}getParentOfValue(){return this.eCellValue??this.eCellWrapper??this.eCell}setRenderDetails(e,t,i){if(this.cellEditor&&!this.cellEditorPopupWrapper)return;this.firstRender=this.firstRender==null;let o=this.refreshWrapper(!1);this.refreshEditStyles(!1),e?!(i||o)&&this.refreshCellRenderer(e)||(this.destroyRenderer(),this.createCellRendererInstance(e)):(this.destroyRenderer(),this.insertValueWithoutCellRenderer(t)),this.rowDraggingComp?.refreshVisibility()}setEditDetails(e,t,i){e?this.createCellEditorInstance(e,t,i):this.destroyEditor()}removeControls(){let e=this.beans.context;this.checkboxSelectionComp=e.destroyBean(this.checkboxSelectionComp),this.dndSourceComp=e.destroyBean(this.dndSourceComp),this.rowDraggingComp=e.destroyBean(this.rowDraggingComp)}refreshWrapper(e){let t=this.includeRowDrag||this.includeDndSource||this.includeSelection,i=t||this.forceWrapper,n=i&&this.eCellWrapper==null;n&&(this.eCellWrapper=ft({tag:"div",cls:"ag-cell-wrapper",role:"presentation"}),this.eCell.appendChild(this.eCellWrapper));let o=!i&&this.eCellWrapper!=null;o&&(hi(this.eCellWrapper),this.eCellWrapper=void 0),this.cellCssManager.toggleCss("ag-cell-value",!i);let s=!e&&i,r=s&&this.eCellValue==null;if(r){let d=this.cellCtrl.getCellValueClass();this.eCellValue=ft({tag:"span",cls:d,role:"presentation"}),this.eCellWrapper.appendChild(this.eCellValue)}let a=!s&&this.eCellValue!=null;a&&(hi(this.eCellValue),this.eCellValue=void 0);let l=n||o||r||a;return l&&this.removeControls(),!e&&t&&this.addControls(),l}addControls(){let{cellCtrl:e,eCellWrapper:t,eCellValue:i,includeRowDrag:n,includeDndSource:o,includeSelection:s}=this,r=a=>{a&&t.insertBefore(a.getGui(),i)};n&&this.rowDraggingComp==null&&(this.rowDraggingComp=e.createRowDragComp(),r(this.rowDraggingComp)),o&&this.dndSourceComp==null&&(this.dndSourceComp=e.createDndSource(),r(this.dndSourceComp)),s&&this.checkboxSelectionComp==null&&(this.checkboxSelectionComp=e.createSelectionCheckbox(),r(this.checkboxSelectionComp))}createCellEditorInstance(e,t,i){let n=this.editorVersion,o=e.newAgStackInstance(),{params:s}=e;o.then(a=>this.afterCellEditorCreated(n,a,s,t,i)),Qe(this.cellEditor)&&s.cellStartedEdit&&this.cellCtrl.focusCell(!0)}insertValueWithoutCellRenderer(e){let t=this.getParentOfValue();Ot(t);let i=Sa(e);i!=null&&(t.textContent=i)}destroyRenderer(){let{context:e}=this.beans;this.cellRenderer=e.destroyBean(this.cellRenderer),hi(this.cellRendererGui),this.cellRendererGui=null,this.rendererVersion++}destroyEditor(){let{context:e}=this.beans;(this.cellEditorPopupWrapper?.getGui().contains(tt(this.beans))||this.cellCtrl.hasBrowserFocus())&&this.eCell.focus({preventScroll:!0}),this.hideEditorPopup?.(),this.hideEditorPopup=void 0,this.cellEditor=e.destroyBean(this.cellEditor),this.cellEditorPopupWrapper=e.destroyBean(this.cellEditorPopupWrapper),hi(this.cellEditorGui),this.cellCtrl.disableEditorTooltipFeature(),this.cellEditorGui=null,this.editorVersion++}refreshCellRenderer(e){if(this.cellRenderer?.refresh==null||this.cellRendererClass!==e.componentClass)return!1;let t=this.cellRenderer.refresh(e.params);return t===!0||t===void 0}createCellRendererInstance(e){let t=this.rendererVersion,i=s=>r=>{if(this.rendererVersion!==t||!this.isAlive())return;let l=s.newAgStackInstance(),d=this.afterCellRendererCreated.bind(this,t,s.componentClass);l?.then(d)},{animationFrameSvc:n}=this.beans,o;if(n?.active&&this.firstRender?o=(s,r=!1)=>{n.createTask(i(s),this.rowNode.rowIndex,"p2",s.componentFromFramework,r)}:o=s=>i(s)(),e.params?.deferRender&&!this.cellCtrl.rowNode.group){let{loadingComp:s,onReady:r}=this.cellCtrl.getDeferLoadingCellRenderer();s&&(o(s),r.then(()=>o(e,!0)))}else o(e)}afterCellRendererCreated(e,t,i){if(!this.isAlive()||e!==this.rendererVersion){this.beans.context.destroyBean(i);return}this.cellRenderer=i,this.cellRendererClass=t;let o=i.getGui();if(this.cellRendererGui=o,o!=null){let s=this.getParentOfValue();Ot(s),s.appendChild(o)}}afterCellEditorCreated(e,t,i,n,o){let s=e!==this.editorVersion,{context:r}=this.beans;if(s){r.destroyBean(t);return}if(t.isCancelBeforeStart?.()){r.destroyBean(t),this.cellCtrl.stopEditing(!0);return}if(!t.getGui){I(97,{colId:this.column.getId()}),r.destroyBean(t);return}this.cellEditor=t,this.cellEditorGui=t.getGui();let l=n||t.isPopup?.();l?this.addPopupCellEditor(i,o):this.addInCellEditor(),this.refreshEditStyles(!0,l),t.afterGuiAttached?.(),this.cellCtrl.enableEditorTooltipFeature(t),this.cellCtrl.cellEditorAttached()}refreshEditStyles(e,t){let{cellCssManager:i}=this;i.toggleCss("ag-cell-inline-editing",e&&!t),i.toggleCss("ag-cell-popup-editing",e&&!!t),i.toggleCss("ag-cell-not-inline-editing",!e||!!t)}addInCellEditor(){let{eCell:e}=this;e.contains(tt(this.beans))&&e.focus(),this.destroyRenderer(),this.refreshWrapper(!0),Ot(this.getParentOfValue()),this.cellEditorGui&&this.getParentOfValue().appendChild(this.cellEditorGui)}addPopupCellEditor(e,t){let{gos:i,context:n,popupSvc:o,editSvc:s}=this.beans;i.get("editType")==="fullRow"&&I(98);let r=this.cellEditorPopupWrapper=n.createBean(s.createPopupEditorWrapper(e)),{cellEditor:a,cellEditorGui:l,eCell:d,rowNode:c,column:u,cellCtrl:h}=this,p=r.getGui();l&&p.appendChild(l);let g=i.get("stopEditingWhenCellsLoseFocus"),f=t??a.getPopupPosition?.()??"over",m=i.get("enableRtl"),C={ePopup:p,column:u,rowNode:c,type:"popupCellEditor",eventSource:d,position:f,alignSide:m?"right":"left",keepWithinBounds:!0},v=o.positionPopupByComponent.bind(o,C),w=o.addPopup({modal:g,eChild:p,closeOnEsc:!0,closedCallback:()=>{h.onPopupEditorClosed()},anchorToElement:d,positionCallback:v,ariaOwns:d});w&&(this.hideEditorPopup=w.hideFunc)}detach(){this.getGui().remove()}destroy(){this.destroyRenderer(),this.destroyEditor(),this.removeControls(),super.destroy()}},tV=class extends Oe{constructor(e,t,i){super(),this.cellComps=new Map,this.beans=t,this.rowCtrl=e;let n=ft({tag:"div",role:"row",attrs:{"comp-id":`${this.getCompId()}`}});this.setInitialStyle(n,i),this.setTemplateFromElement(n);let o=n.style;this.domOrder=this.rowCtrl.getDomOrder();let s={setDomOrder:r=>this.domOrder=r,setCellCtrls:r=>this.setCellCtrls(r),showFullWidth:r=>this.showFullWidth(r),getFullWidthCellRenderer:()=>this.fullWidthCellRenderer,getFullWidthCellRendererParams:()=>this.fullWidthCellRendererParams,toggleCss:(r,a)=>this.toggleCss(r,a),setUserStyles:r=>md(n,r),setTop:r=>o.top=r,setTransform:r=>o.transform=r,setRowIndex:r=>n.setAttribute("row-index",r),setRowId:r=>n.setAttribute("row-id",r),setRowBusinessKey:r=>n.setAttribute("row-business-key",r),refreshFullWidth:r=>{let a=r();return this.fullWidthCellRendererParams=a,this.fullWidthCellRenderer?.refresh?.(a)??!1}};e.setComp(s,this.getGui(),i,void 0),this.addDestroyFunc(()=>{e.unsetComp(i)})}setInitialStyle(e,t){let i=this.rowCtrl.getInitialTransform(t);if(i)e.style.setProperty("transform",i);else{let n=this.rowCtrl.getInitialRowTop(t);n&&e.style.setProperty("top",n)}}showFullWidth(e){let t=n=>{if(this.isAlive()){let o=n.getGui();this.getGui().appendChild(o),this.rowCtrl.setupDetailRowAutoHeight(o),this.setFullWidthRowComp(n,e.params)}else this.beans.context.destroyBean(n)};e.newAgStackInstance().then(t)}setCellCtrls(e){let t=new Map(this.cellComps);for(let i of e){let n=i.instanceId;this.cellComps.has(n)?t.delete(n):this.newCellComp(i)}this.destroyCells(t),this.ensureDomOrder(e)}ensureDomOrder(e){if(!this.domOrder)return;let t=[];for(let i of e){let n=this.cellComps.get(i.instanceId);n&&t.push(n.getGui())}QR(this.getGui(),t)}newCellComp(e){let t=this.beans.editSvc?.isEditing(e,{withOpenEditor:!0})??!1,i=new eV(this.beans,e,this.rowCtrl.printLayout,this.getGui(),t);this.cellComps.set(e.instanceId,i),this.getGui().appendChild(i.getGui())}destroy(){super.destroy(),this.destroyCells(this.cellComps)}setFullWidthRowComp(e,t){this.fullWidthCellRenderer=e,this.fullWidthCellRendererParams=t,this.addDestroyFunc(()=>{this.fullWidthCellRenderer=this.beans.context.destroyBean(this.fullWidthCellRenderer),this.fullWidthCellRendererParams=void 0})}destroyCells(e){for(let t of e.values()){if(!t)return;let i=t.cellCtrl.instanceId;if(this.cellComps.get(i)!==t)return;t.detach(),t.destroy(),this.cellComps.delete(i)}}};function iV(e,t,i){let n=!!i.gos.get("enableCellSpan")&&!!t.getSpannedRowCtrls,o={tag:"div",ref:"eContainer",cls:ep(e),role:"rowgroup"};if(t.type==="center"||n){let s={tag:"div",ref:"eSpannedContainer",cls:`ag-spanning-container ${EH(e)}`,role:"presentation"};return o.role="presentation",{tag:"div",ref:"eViewport",cls:`ag-viewport ${b4(e)}`,role:"rowgroup",children:[o,n?s:null]}}return o}var nV=class extends Oe{constructor(e){super(),this.eViewport=V,this.eContainer=V,this.eSpannedContainer=V,this.rowCompsNoSpan={},this.rowCompsWithSpan={},this.name=e?.name,this.options=bd(this.name)}postConstruct(){this.setTemplate(iV(this.name,this.options,this.beans));let e={setHorizontalScroll:i=>this.eViewport.scrollLeft=i,setViewportHeight:i=>this.eViewport.style.height=i,setRowCtrls:({rowCtrls:i})=>this.setRowCtrls(i),setSpannedRowCtrls:i=>this.setRowCtrls(i,!0),setDomOrder:i=>{this.domOrder=i},setContainerWidth:i=>{this.eContainer.style.width=i,this.eSpannedContainer&&(this.eSpannedContainer.style.width=i)},setOffsetTop:i=>{let n=`translateY(${i})`;this.eContainer.style.transform=n,this.eSpannedContainer&&(this.eSpannedContainer.style.transform=n)}};this.createManagedBean(new LH(this.name)).setComp(e,this.eContainer,this.eSpannedContainer,this.eViewport)}destroy(){this.setRowCtrls([]),this.setRowCtrls([],!0),super.destroy(),this.lastPlacedElement=null}setRowCtrls(e,t){let{beans:i,options:n}=this,o=t?this.eSpannedContainer:this.eContainer,s=t?b({},this.rowCompsWithSpan):b({},this.rowCompsNoSpan),r={};t?this.rowCompsWithSpan=r:this.rowCompsNoSpan=r,this.lastPlacedElement=null;let a=[];for(let l of e){let d=l.instanceId,c=s[d],u;if(c)u=c,delete s[d];else{if(!l.rowNode.displayed)continue;u=new tV(l,i,n.type)}r[d]=u,a.push([u,!c])}this.removeOldRows(Object.values(s)),this.addRowNodes(a,o)}addRowNodes(e,t){let{domOrder:i}=this;for(let[n,o]of e){let s=n.getGui();i?this.ensureDomOrder(s,t):o&&t.appendChild(s)}}removeOldRows(e){for(let t of e)t.getGui().remove(),t.destroy()}ensureDomOrder(e,t){JR(t,e,this.lastPlacedElement),this.lastPlacedElement=e}},oV={selector:"AG-ROW-CONTAINER",component:nV};function Vl(e,t){return t.map(i=>{let n=`e${i[0].toUpperCase()+i.substring(1)}RowContainer`;return e[n]={name:i},{tag:"ag-row-container",ref:n,attrs:{name:i}}})}function sV(e){let t={},i={tag:"div",ref:"eGridRoot",cls:"ag-root ag-unselectable",children:[{tag:"ag-header-root"},{tag:"div",ref:"eTop",cls:"ag-floating-top",role:"presentation",children:Vl(t,["topLeft","topCenter","topRight","topFullWidth"])},{tag:"div",ref:"eBody",cls:"ag-body",role:"presentation",children:[{tag:"div",ref:"eBodyViewport",cls:"ag-body-viewport",role:"presentation",children:Vl(t,["left","center","right","fullWidth"])},{tag:"ag-fake-vertical-scroll"}]},{tag:"div",ref:"eStickyTop",cls:"ag-sticky-top",role:"presentation",children:Vl(t,["stickyTopLeft","stickyTopCenter","stickyTopRight","stickyTopFullWidth"])},{tag:"div",ref:"eStickyBottom",cls:"ag-sticky-bottom",role:"presentation",children:Vl(t,["stickyBottomLeft","stickyBottomCenter","stickyBottomRight","stickyBottomFullWidth"])},{tag:"div",ref:"eBottom",cls:"ag-floating-bottom",role:"presentation",children:Vl(t,["bottomLeft","bottomCenter","bottomRight","bottomFullWidth"])},{tag:"ag-fake-horizontal-scroll"},e?{tag:"ag-overlay-wrapper"}:null]};return{paramsMap:t,elementParams:i}}var rV=class extends Oe{constructor(){super(...arguments),this.eGridRoot=V,this.eBodyViewport=V,this.eStickyTop=V,this.eStickyBottom=V,this.eTop=V,this.eBottom=V,this.eBody=V}postConstruct(){let{overlays:e,rangeSvc:t}=this.beans,i=e?.getOverlayWrapperSelector(),{paramsMap:n,elementParams:o}=sV(!!i);this.setTemplate(o,[...i?[i]:[],VH,UH,ZG,oV],n);let s=(a,l)=>{let d=`${a}px`;l.style.minHeight=d,l.style.height=d},r={setRowAnimationCssOnBodyViewport:(a,l)=>this.setRowAnimationCssOnBodyViewport(a,l),setColumnCount:a=>C_(this.getGui(),a),setRowCount:a=>f_(this.getGui(),a),setTopHeight:a=>s(a,this.eTop),setBottomHeight:a=>s(a,this.eBottom),setTopInvisible:a=>this.eTop.classList.toggle("ag-invisible",a),setBottomInvisible:a=>this.eBottom.classList.toggle("ag-invisible",a),setStickyTopHeight:a=>this.eStickyTop.style.height=a,setStickyTopTop:a=>this.eStickyTop.style.top=a,setStickyTopWidth:a=>this.eStickyTop.style.width=a,setStickyBottomHeight:a=>{this.eStickyBottom.style.height=a,this.eStickyBottom.classList.toggle("ag-invisible",a==="0px")},setStickyBottomBottom:a=>this.eStickyBottom.style.bottom=a,setStickyBottomWidth:a=>this.eStickyBottom.style.width=a,setColumnMovingCss:(a,l)=>this.toggleCss(a,l),updateLayoutClasses:(a,l)=>{let d=[this.eBodyViewport.classList,this.eBody.classList];for(let c of d)c.toggle(ji.AUTO_HEIGHT,l.autoHeight),c.toggle(ji.NORMAL,l.normal),c.toggle(ji.PRINT,l.print);this.toggleCss(ji.AUTO_HEIGHT,l.autoHeight),this.toggleCss(ji.NORMAL,l.normal),this.toggleCss(ji.PRINT,l.print)},setAlwaysVerticalScrollClass:(a,l)=>this.eBodyViewport.classList.toggle(x4,l),registerBodyViewportResizeListener:a=>{let l=Qo(this.beans,this.eBodyViewport,a);this.addDestroyFunc(()=>l())},setPinnedTopBottomOverflowY:a=>this.eTop.style.overflowY=this.eBottom.style.overflowY=a,setCellSelectableCss:(a,l)=>{for(let d of[this.eTop,this.eBodyViewport,this.eBottom])d.classList.toggle(a,l)},setBodyViewportWidth:a=>this.eBodyViewport.style.width=a,setGridRootRole:a=>jo(this.eGridRoot,a)};this.ctrl=this.createManagedBean(new NH),this.ctrl.setComp(r,this.getGui(),this.eBodyViewport,this.eTop,this.eBottom,this.eStickyTop,this.eStickyBottom),(t&&uo(this.gos)||dd(this.gos))&&g_(this.getGui(),!0)}setRowAnimationCssOnBodyViewport(e,t){let i=this.eBodyViewport.classList;i.toggle("ag-row-animation",t),i.toggle("ag-row-no-animation",!t)}},aV={selector:"AG-GRID-BODY",component:rV},lV=class extends D{constructor(){super(...arguments),this.additionalFocusableContainers=new Set}setComp(e,t,i){this.view=e,this.eGridHostDiv=t,this.eGui=i,this.eGui.setAttribute("grid-id",this.beans.context.getId());let{dragAndDrop:n,ctrlsSvc:o}=this.beans;n?.registerGridDropTarget(()=>this.eGui,this),this.createManagedBean(new Ev(this.view)),this.view.setRtlClass(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr");let s=Qo(this.beans,this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc(()=>s()),o.register("gridCtrl",this)}isDetailGrid(){return Y6(this.getGui())?.getAttribute("row-id")?.startsWith("detail")||!1}getOptionalSelectors(){let e=this.beans;return{paginationSelector:e.pagination?.getPaginationSelector(),gridHeaderDropZonesSelector:e.registry?.getSelector("AG-GRID-HEADER-DROP-ZONES"),sideBarSelector:e.sideBar?.getSelector(),statusBarSelector:e.registry?.getSelector("AG-STATUS-BAR"),watermarkSelector:e.licenseManager?.getWatermarkSelector()}}onGridSizeChanged(){this.eventSvc.dispatchEvent({type:"gridSizeChanged",clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight})}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(e){let{view:t}=this;if(e===!1)t.setCursor(null);else{let i=e===1?"ew-resize":"ns-resize";t.setCursor(i)}}disableUserSelect(e){this.view.setUserSelect(e?"none":null)}focusNextInnerContainer(e){let t=this.getFocusableContainers(),{indexWithFocus:i,nextIndex:n}=this.getNextFocusableIndex(t,e);if(n<0||n>=t.length)return!1;if(n===0){if(i>0){let{visibleCols:o,focusSvc:s}=this.beans,r=o.allCols,a=Ue(r);if(s.focusGridView({column:a,backwards:!0}))return!0}return!1}return this.focusContainer(t[n],e)}focusInnerElement(e){if(this.gos.getCallback("focusGridInnerElement")?.({fromBottom:!!e}))return!0;let i=this.getFocusableContainers(),{focusSvc:n,visibleCols:o}=this.beans,s=o.allCols;if(e){if(i.length>1)return this.focusContainer(Ue(i),e);let r=Ue(s);if(n.focusGridView({column:r,backwards:e}))return!0}if(this.gos.get("headerHeight")===0||Ws(this.beans)){if(n.focusGridView({column:s[0],backwards:e}))return!0;for(let r=1;r<i.length;r++)if(js(i[r].getGui(),e))return!0;return!1}return n.focusFirstHeader()}forceFocusOutOfContainer(e=!1){this.view.forceFocusOutOfContainer(e)}addFocusableContainer(e){this.additionalFocusableContainers.add(e)}removeFocusableContainer(e){this.additionalFocusableContainers.delete(e)}allowFocusForNextCoreContainer(e){let t=this.view.getFocusableContainers(),{nextIndex:i,indexWithFocus:n}=this.getNextFocusableIndex(t,e);if(n===-1||i<0||i>=t.length)return;let o=t[i];o.setAllowFocus?.(!0),setTimeout(()=>{o.setAllowFocus?.(!1)})}isFocusable(){let e=this.beans;return!Ip(e)||!Ws(e)||!!e.sideBar?.comp?.isDisplayed()}getNextFocusableIndex(e,t){let i=tt(this.beans),n=e.findIndex(s=>s.getGui().contains(i)),o=n+(t?-1:1);return{indexWithFocus:n,nextIndex:o}}focusContainer(e,t){e.setAllowFocus?.(!0);let i=js(e.getGui(),t,!1,!0);return e.setAllowFocus?.(!1),i}getFocusableContainers(){return[...this.view.getFocusableContainers(),...this.additionalFocusableContainers]}destroy(){this.additionalFocusableContainers.clear(),super.destroy()}},dV=class extends I4{constructor(e){super(),this.gridBody=V,this.sideBar=V,this.pagination=V,this.rootWrapperBody=V,this.eGridDiv=e}postConstruct(){let e={destroyGridUi:()=>this.destroyBean(this),setRtlClass:s=>this.addCss(s),forceFocusOutOfContainer:this.forceFocusOutOfContainer.bind(this),updateLayoutClasses:this.updateLayoutClasses.bind(this),getFocusableContainers:this.getFocusableContainers.bind(this),setUserSelect:s=>{this.getGui().style.userSelect=s??"",this.getGui().style.webkitUserSelect=s??""},setCursor:s=>{this.getGui().style.cursor=s??""}},t=this.createManagedBean(new lV),i=t.getOptionalSelectors(),n=this.createTemplate(i),o=[aV,...Object.values(i).filter(s=>!!s)];this.setTemplate(n,o),t.setComp(e,this.eGridDiv,this.getGui()),this.insertGridIntoDom(),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:s=>t.focusInnerElement(s),forceFocusOutWhenTabGuardsAreEmpty:!0,isEmpty:()=>!t.isFocusable()})}insertGridIntoDom(){let e=this.getGui();this.eGridDiv.appendChild(e),this.addDestroyFunc(()=>{e.remove(),Ko(this.gos,"Grid removed from DOM")})}updateLayoutClasses(e,t){let i=this.rootWrapperBody.classList,{AUTO_HEIGHT:n,NORMAL:o,PRINT:s}=ji,{autoHeight:r,normal:a,print:l}=t;i.toggle(n,r),i.toggle(o,a),i.toggle(s,l),this.toggleCss(n,r),this.toggleCss(o,a),this.toggleCss(s,l)}createTemplate(e){let t=e.gridHeaderDropZonesSelector?{tag:"ag-grid-header-drop-zones"}:null,i=e.sideBarSelector?{tag:"ag-side-bar",ref:"sideBar"}:null,n=e.statusBarSelector?{tag:"ag-status-bar"}:null,o=e.watermarkSelector?{tag:"ag-watermark"}:null,s=e.paginationSelector?{tag:"ag-pagination",ref:"pagination"}:null;return{tag:"div",cls:"ag-root-wrapper",role:"presentation",children:[t,{tag:"div",ref:"rootWrapperBody",cls:"ag-root-wrapper-body",role:"presentation",children:[{tag:"ag-grid-body",ref:"gridBody"},i]},n,s,o]}}getFocusableElement(){return this.rootWrapperBody}forceFocusOutOfContainer(e=!1){if(!e&&this.pagination?.isDisplayed()){this.pagination.forceFocusOutOfContainer(e);return}super.forceFocusOutOfContainer(e)}getFocusableContainers(){let e=[this.gridBody];for(let t of[this.sideBar,this.pagination])t&&e.push(t);return e.filter(t=>Pn(t.getGui()))}},le=(e,t)=>{for(let i of Object.keys(t))t[i]=e;return t},oR=b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b(b({dispatchEvent:"CommunityCore"},le("CommunityCore",{destroy:0,getGridId:0,getGridOption:0,isDestroyed:0,setGridOption:0,updateGridOptions:0,isModuleRegistered:0})),le("GridState",{getState:0,setState:0})),le("SharedRowSelection",{setNodesSelected:0,selectAll:0,deselectAll:0,selectAllFiltered:0,deselectAllFiltered:0,selectAllOnCurrentPage:0,deselectAllOnCurrentPage:0,getSelectedNodes:0,getSelectedRows:0})),le("RowApi",{redrawRows:0,setRowNodeExpanded:0,getRowNode:0,addRenderedRowListener:0,getRenderedNodes:0,forEachNode:0,getFirstDisplayedRowIndex:0,getLastDisplayedRowIndex:0,getDisplayedRowAtIndex:0,getDisplayedRowCount:0})),le("ScrollApi",{getVerticalPixelRange:0,getHorizontalPixelRange:0,ensureColumnVisible:0,ensureIndexVisible:0,ensureNodeVisible:0})),le("KeyboardNavigation",{getFocusedCell:0,clearFocusedCell:0,setFocusedCell:0,tabToNextCell:0,tabToPreviousCell:0,setFocusedHeader:0})),le("EventApi",{addEventListener:0,addGlobalListener:0,removeEventListener:0,removeGlobalListener:0})),le("ValueCache",{expireValueCache:0})),le("CellApi",{getCellValue:0})),le("SharedMenu",{showColumnMenu:0,hidePopupMenu:0})),le("Sort",{onSortChanged:0})),le("PinnedRow",{getPinnedTopRowCount:0,getPinnedBottomRowCount:0,getPinnedTopRow:0,getPinnedBottomRow:0,forEachPinnedRow:0})),le("Overlay",{showLoadingOverlay:0,showNoRowsOverlay:0,hideOverlay:0})),le("RenderApi",{setGridAriaProperty:0,refreshCells:0,refreshHeader:0,isAnimationFrameQueueEmpty:0,flushAllAnimationFrames:0,getSizesForCurrentTheme:0,getCellRendererInstances:0})),le("HighlightChanges",{flashCells:0})),le("RowDrag",{addRowDropZone:0,removeRowDropZone:0,getRowDropZoneParams:0,getRowDropPositionIndicator:0,setRowDropPositionIndicator:0})),le("ColumnApi",{getColumnDefs:0,getColumnDef:0,getDisplayNameForColumn:0,getColumn:0,getColumns:0,applyColumnState:0,getColumnState:0,resetColumnState:0,isPinning:0,isPinningLeft:0,isPinningRight:0,getDisplayedColAfter:0,getDisplayedColBefore:0,setColumnsVisible:0,setColumnsPinned:0,getAllGridColumns:0,getDisplayedLeftColumns:0,getDisplayedCenterColumns:0,getDisplayedRightColumns:0,getAllDisplayedColumns:0,getAllDisplayedVirtualColumns:0})),le("ColumnAutoSize",{sizeColumnsToFit:0,autoSizeColumns:0,autoSizeAllColumns:0})),le("ColumnGroup",{setColumnGroupOpened:0,getColumnGroup:0,getProvidedColumnGroup:0,getDisplayNameForColumnGroup:0,getColumnGroupState:0,setColumnGroupState:0,resetColumnGroupState:0,getLeftDisplayedColumnGroups:0,getCenterDisplayedColumnGroups:0,getRightDisplayedColumnGroups:0,getAllDisplayedColumnGroups:0})),le("ColumnMove",{moveColumnByIndex:0,moveColumns:0})),le("ColumnResize",{setColumnWidths:0})),le("ColumnHover",{isColumnHovered:0})),le("EditCore",{getCellEditorInstances:0,getEditingCells:0,getEditRowValues:0,stopEditing:0,startEditingCell:0,isEditing:0,validateEdit:0})),le("BatchEdit",{startBatchEdit:0,cancelBatchEdit:0,commitBatchEdit:0,isBatchEditing:0})),le("UndoRedoEdit",{undoCellEditing:0,redoCellEditing:0,getCurrentUndoSize:0,getCurrentRedoSize:0})),le("FilterCore",{isAnyFilterPresent:0,onFilterChanged:0})),le("ColumnFilter",{isColumnFilterPresent:0,getColumnFilterInstance:0,destroyFilter:0,setFilterModel:0,getFilterModel:0,getColumnFilterModel:0,setColumnFilterModel:0,showColumnFilter:0,hideColumnFilter:0,getColumnFilterHandler:0,doFilterAction:0})),le("QuickFilter",{isQuickFilterPresent:0,getQuickFilter:0,resetQuickFilter:0})),le("Find",{findGetActiveMatch:0,findGetTotalMatches:0,findGoTo:0,findNext:0,findPrevious:0,findGetNumMatches:0,findGetParts:0,findClearActive:0,findRefresh:0})),le("Pagination",{paginationIsLastPageFound:0,paginationGetPageSize:0,paginationGetCurrentPage:0,paginationGetTotalPages:0,paginationGetRowCount:0,paginationGoToNextPage:0,paginationGoToPreviousPage:0,paginationGoToFirstPage:0,paginationGoToLastPage:0,paginationGoToPage:0})),le("CsrmSsrmSharedApi",{expandAll:0,collapseAll:0})),le("SsrmInfiniteSharedApi",{setRowCount:0,getCacheBlockState:0,isLastRowIndexKnown:0})),le("ClientSideRowModelApi",{onGroupExpandedOrCollapsed:0,refreshClientSideRowModel:0,isRowDataEmpty:0,forEachLeafNode:0,forEachNodeAfterFilter:0,forEachNodeAfterFilterAndSort:0,applyTransaction:0,applyTransactionAsync:0,flushAsyncTransactions:0,getBestCostNodeSelection:0,onRowHeightChanged:0,resetRowHeights:0})),le("CsvExport",{getDataAsCsv:0,exportDataAsCsv:0})),le("InfiniteRowModel",{refreshInfiniteCache:0,purgeInfiniteCache:0,getInfiniteRowCount:0})),le("AdvancedFilter",{getAdvancedFilterModel:0,setAdvancedFilterModel:0,showAdvancedFilterBuilder:0,hideAdvancedFilterBuilder:0})),le("IntegratedCharts",{getChartModels:0,getChartRef:0,getChartImageDataURL:0,downloadChart:0,openChartToolPanel:0,closeChartToolPanel:0,createRangeChart:0,createPivotChart:0,createCrossFilterChart:0,updateChart:0,restoreChart:0})),le("Clipboard",{copyToClipboard:0,cutToClipboard:0,copySelectedRowsToClipboard:0,copySelectedRangeToClipboard:0,copySelectedRangeDown:0,pasteFromClipboard:0})),le("ExcelExport",{getDataAsExcel:0,exportDataAsExcel:0,getSheetDataForExcel:0,getMultipleSheetsAsExcel:0,exportMultipleSheetsAsExcel:0})),le("SharedMasterDetail",{addDetailGridInfo:0,removeDetailGridInfo:0,getDetailGridInfo:0,forEachDetailGridInfo:0})),le("ContextMenu",{showContextMenu:0})),le("ColumnMenu",{showColumnChooser:0,hideColumnChooser:0})),le("CellSelection",{getCellRanges:0,addCellRange:0,clearRangeSelection:0,clearCellSelection:0})),le("SharedRowGrouping",{setRowGroupColumns:0,removeRowGroupColumns:0,addRowGroupColumns:0,getRowGroupColumns:0,moveRowGroupColumn:0})),le("SharedAggregation",{addAggFuncs:0,clearAggFuncs:0,setColumnAggFunc:0})),le("SharedPivot",{isPivotMode:0,getPivotResultColumn:0,setValueColumns:0,getValueColumns:0,removeValueColumns:0,addValueColumns:0,setPivotColumns:0,removePivotColumns:0,addPivotColumns:0,getPivotColumns:0,setPivotResultColumns:0,getPivotResultColumns:0})),le("ServerSideRowModelApi",{getServerSideSelectionState:0,setServerSideSelectionState:0,applyServerSideTransaction:0,applyServerSideTransactionAsync:0,applyServerSideRowData:0,retryServerSideLoads:0,flushServerSideAsyncTransactions:0,refreshServerSide:0,getServerSideGroupLevelState:0,onRowHeightChanged:0,resetRowHeights:0})),le("SideBar",{isSideBarVisible:0,setSideBarVisible:0,setSideBarPosition:0,openToolPanel:0,closeToolPanel:0,getOpenedToolPanel:0,refreshToolPanel:0,isToolPanelShowing:0,getToolPanelInstance:0,getSideBar:0})),le("StatusBar",{getStatusPanel:0})),le("AiToolkit",{getStructuredSchema:0})),aC={isDestroyed:()=>!0,destroy(){},preConstruct(){},postConstruct(){},preWireBeans(){},wireBeans(){}},cV=(e,t)=>e.eventSvc.dispatchEvent(t),L4=class{};Reflect.defineProperty(L4,"name",{value:"GridApi"});var uV=class extends D{constructor(){super(),this.beanName="apiFunctionSvc",this.api=new L4,this.fns=_(b({},aC),{dispatchEvent:cV}),this.preDestroyLink="";let{api:e}=this;for(let t of Object.keys(oR))e[t]=this.makeApi(t)[t]}postConstruct(){this.preDestroyLink=this.beans.frameworkOverrides.getDocLink("grid-lifecycle/#grid-pre-destroyed")}addFunction(e,t){let{fns:i,beans:n}=this;i!==aC&&(i[e]=n?.validation?.validateApiFunction(e,t)??t)}makeApi(e){return{[e]:(...t)=>{let{beans:i,fns:{[e]:n}}=this;return n?n(i,...t):this.apiNotFound(e)}}}apiNotFound(e){let{beans:t,gos:i,preDestroyLink:n}=this;if(!t)I(26,{fnName:e,preDestroyLink:n});else{let o=oR[e];i.assertModuleRegistered(o,`api.${e}`)&&I(27,{fnName:e,module:o})}}destroy(){super.destroy(),this.fns=aC,this.beans=null}};function hV(e){return e.context.getId()}function pV(e){e.gridDestroySvc.destroy()}function gV(e){return e.gridDestroySvc.destroyCalled}function fV(e,t){return e.gos.get(t)}function mV(e,t,i){_4(e,{[t]:i})}function _4(e,t){e.gos.updateGridOptions({options:t})}function CV(e,t){let i=t.replace(/Module$/,"");return e.gos.isModuleRegistered(i)}var vV={tag:"div",cls:"ag-drag-handle ag-row-drag",attrs:{draggable:"true"}},wV=class extends Oe{constructor(e,t,i){super(vV),this.rowNode=e,this.column=t,this.eCell=i}postConstruct(){this.getGui().appendChild(Ni("rowDrag",this.beans,null)),this.addGuiEventListener("mousedown",t=>{t.stopPropagation()}),this.addDragSource(),this.checkVisibility()}addDragSource(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))}onDragStart(e){let{rowNode:t,column:i,eCell:n,gos:o}=this,s=i.getColDef().dndSourceOnRowDrag,r=e.dataTransfer;if(r.setDragImage(n,0,0),s){let a=te(o,{rowNode:t,dragEvent:e});s(a)}else try{let a=JSON.stringify(t.data);r.setData("application/json",a),r.setData("text/plain",a)}catch{}}checkVisibility(){let e=this.column.isDndSource(this.rowNode);this.setDisplayed(e)}};function bV(e,t){e.rowDragSvc?.rowDragFeature?.addRowDropZone(t)}function yV(e,t){let i=e.dragAndDrop?.findExternalZone(t.getContainer());i&&e.dragAndDrop?.removeDropTarget(i)}function SV(e,t){return e.rowDragSvc?.rowDragFeature?.getRowDropZone(t)}function xV(e){let t=e.rowDropHighlightSvc;return t?{row:t.row,dropIndicatorPosition:t.position}:{row:null,dropIndicatorPosition:"none"}}function EV(e,t){let i=e.rowDropHighlightSvc;if(!i)return;let n=t?.row,o=t?.dropIndicatorPosition;o!=="above"&&o!=="below"&&o!=="inside"&&(o="none");let s=n?.rowIndex;s==null||o==="none"?i.clear():i.set(n,o)}var RV=class extends HB{shouldPreventMouseEvent(e){return this.gos.get("enableCellTextSelection")&&super.shouldPreventMouseEvent(e)}},PV=class extends D{constructor(){super(...arguments),this.beanName="horizontalResizeSvc"}addResizeBar(e){let t={dragStartPixels:e.dragStartPixels||0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e),onDragCancel:this.onDragStop.bind(this,e),includeTouch:!0,stopPropagationForTouch:!0},{dragSvc:i}=this.beans;return i.addDragSource(t),()=>i.removeDragSource(t)}onDragStart(e,t){this.dragStartX=t.clientX,this.setResizeIcons();let i=t instanceof MouseEvent&&t.shiftKey===!0;e.onResizeStart(i)}setResizeIcons(){let e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(1),e.disableUserSelect(!0)}onDragStop(e){e.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){let e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(!1),e.disableUserSelect(!1)}onDragging(e,t){this.resizeAmount=t.clientX-this.dragStartX,e.onResizing(this.resizeAmount)}},MV={tag:"div",cls:"ag-drag-handle ag-row-drag",attrs:{"aria-hidden":"true"}},kV=class extends Oe{constructor(e,t,i,n,o,s=!1){super(),this.cellValueFn=e,this.rowNode=t,this.column=i,this.customGui=n,this.dragStartPixels=o,this.alwaysVisible=s,this.dragSource=null}isCustomGui(){return this.customGui!=null}postConstruct(){let{beans:e,customGui:t}=this;t?this.setDragElement(t,this.dragStartPixels):(this.setTemplate(MV),this.getGui().appendChild(Ni("rowDrag",e,null)),this.addDragSource()),this.alwaysVisible||this.initCellDrag()}initCellDrag(){let{beans:e,gos:t,rowNode:i}=this,n=this.refreshVisibility.bind(this);this.addManagedPropertyListener("suppressRowDrag",n),this.addManagedListeners(i,{dataChanged:n,cellChanged:n}),this.addManagedListeners(e.eventSvc,t.get("rowDragManaged")?{sortChanged:n,filterChanged:n,columnRowGroupChanged:n,newColumnsLoaded:n}:{newColumnsLoaded:n})}setDragElement(e,t){this.setTemplateFromElement(e,void 0,void 0,!0),this.addDragSource(t)}refreshVisibility(){if(this.alwaysVisible)return;let e={skipAriaHidden:!0};if(this.isNeverDisplayed()){this.setDisplayed(!1,e);return}let t=this.column,i=typeof t?.getColDef().rowDrag=="function",n=!t||this.isCustomGui()||t.isRowDrag(this.rowNode);n&&this.rowNode.footer&&this.gos.get("rowDragManaged")&&(n=!1,i=!0),this.setDisplayed(i||n,e),this.setVisible(n,e)}isNeverDisplayed(){let{gos:e,beans:t}=this;return!!(e.get("suppressRowDrag")||e.get("rowDragManaged")&&t.rowDragSvc.rowDragFeature?.shouldPreventRowMove()&&!t.dragAndDrop?.hasExternalDropZones())}getSelectedNodes(){let e=this.rowNode;if(!this.gos.get("rowDragMultiRow"))return[e];let i=this.beans.selectionSvc?.getSelectedNodes()??[];return i.indexOf(e)!==-1?i:[e]}getDragItem(){let{column:e,rowNode:t}=this;return{rowNode:t,rowNodes:this.getSelectedNodes(),columns:e?[e]:void 0,defaultTextValue:this.cellValueFn()}}getRowDragText(e){if(e){let t=e.getColDef();if(t.rowDragText)return t.rowDragText}return this.gos.get("rowDragText")}addDragSource(e=4){if(this.dragSource&&this.removeDragSource(),this.gos.get("rowDragManaged")&&this.rowNode.footer)return;let t=this.getGui();this.gos.get("enableCellTextSelection")&&(this.removeMouseDownListener(),this.mouseDownListener=this.addManagedElementListeners(t,{mousedown:n=>{n?.preventDefault()}})[0]);let i=this.getLocaleTextFunc();this.dragSource={type:2,eElement:t,dragItemName:n=>{let o=n?.dragItem||this.getDragItem(),s=(n?.dropTarget?.rows.length??o.rowNodes?.length)||1,r=this.getRowDragText(this.column);return r?r(o,s):s===1?this.cellValueFn():`${s} ${i("rowDragRows","rows")}`},getDragItem:()=>this.getDragItem(),dragStartPixels:e,dragSourceDomDataKey:this.gos.getDomDataKey()},this.beans.dragAndDrop.addDragSource(this.dragSource,!0)}destroy(){this.removeDragSource(),this.removeMouseDownListener(),super.destroy()}removeDragSource(){this.dragSource&&(this.beans.dragAndDrop.removeDragSource(this.dragSource),this.dragSource=null)}removeMouseDownListener(){this.mouseDownListener&&(this.mouseDownListener(),this.mouseDownListener=void 0)}},tp=class{constructor(){this.reordered=!1,this.removals=new Set,this.updates=new Set,this.adds=new Set}};function DV(e){let{rowIndex:t,rowPinned:i,column:n}=e;return`${t}.${i??"null"}.${n.getId()}`}function O4(e,t){let i=e.column===t.column,n=e.rowPinned===t.rowPinned,o=e.rowIndex===t.rowIndex;return i&&n&&o}function FV(e,t){switch(e.rowPinned){case"top":if(t.rowPinned!=="top")return!0;break;case"bottom":if(t.rowPinned!=="bottom")return!1;break;default:if(q(t.rowPinned))return t.rowPinned!=="top";break}return e.rowIndex<t.rowIndex}function TV(e,t){return!e&&!t?!0:e&&!t||!e&&t?!1:e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned}function AV(e){let t=0,i,{pinnedRowModel:n,rowModel:o,pageBounds:s}=e;return n?.getPinnedTopRowCount()?i="top":o.getRowCount()?(i=null,t=s.getFirstRow()):n?.getPinnedBottomRowCount()&&(i="bottom"),i===void 0?null:{rowIndex:t,rowPinned:i}}function IV(e){let t,i=null,{pinnedRowModel:n,pageBounds:o}=e,s=n?.getPinnedBottomRowCount(),r=n?.getPinnedTopRowCount();return s?(i="bottom",t=s-1):e.rowModel.getRowCount()?t=o.getLastRow():r&&(i="top",t=r-1),t===void 0?null:{rowIndex:t,rowPinned:i}}function ho(e,t){switch(t.rowPinned){case"top":return e.pinnedRowModel?.getPinnedTopRow(t.rowIndex);case"bottom":return e.pinnedRowModel?.getPinnedBottomRow(t.rowIndex);default:return e.rowModel.getRow(t.rowIndex)}}function oa(e,t){let i=e.spannedRowRenderer?.getCellByPosition(t);if(i)return i;let n=e.rowRenderer.getRowByPosition(t);return n?n.getCellCtrl(t.column):null}function LV(e,t,i){let{rowModel:n,pinnedRowModel:o}=e,s;return s??(s=n?.getRowNode(t)),i?s??(s=o?.getPinnedRowById(t,i)):(s??(s=o?.getPinnedRowById(t,"top")),s??(s=o?.getPinnedRowById(t,"bottom"))),s}function xp(e,t,i=!1){let{rowIndex:n,rowPinned:o}=t,{pageBounds:s,pinnedRowModel:r,rowModel:a}=e;if(n===0)return o==="top"?null:o==="bottom"&&a.isRowsToRender()?{rowIndex:s.getLastRow(),rowPinned:null}:r?.isRowsToRender("top")?{rowIndex:r.getPinnedTopRowCount()-1,rowPinned:"top"}:null;if(i){let l=o?void 0:a.getRow(n);return N4(e,l,!0)??{rowIndex:n-1,rowPinned:o}}return{rowIndex:n-1,rowPinned:o}}function sR(e,t,i=!1){let{rowIndex:n,rowPinned:o}=t,{pageBounds:s,pinnedRowModel:r,rowModel:a}=e;if(_V(e,t))return o==="bottom"?null:o==="top"&&a.isRowsToRender()?{rowIndex:s.getFirstRow(),rowPinned:null}:r?.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;if(i){let l=o?void 0:a.getRow(n);return N4(e,l)??{rowIndex:n+1,rowPinned:o}}return{rowIndex:n+1,rowPinned:o}}function N4(e,t,i=!1){let{gos:n,rowRenderer:o}=e;if(!t?.sticky||!v6(n))return;let s=o.getStickyTopRowCtrls(),r=o.getStickyBottomRowCtrls(),a=!r.some(u=>u.rowNode.rowIndex===t.rowIndex),l=a?s:r,d=(i?-1:1)*(a?-1:1),c;for(let u=0;u<l.length;u++)if(l[u].rowNode.rowIndex===t.rowIndex){c=l[u+d];break}return c?{rowIndex:c.rowNode.rowIndex,rowPinned:null}:void 0}function _V(e,t){let{rowPinned:i,rowIndex:n}=t,{pinnedRowModel:o,pageBounds:s}=e;return i==="top"?(o?.getPinnedTopRowCount()??0)-1<=n:i==="bottom"?(o?.getPinnedBottomRowCount()??0)-1<=n:s.getLastRow()<=n}var pd=class{constructor(e,t){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=e,this.pathRoot={rowNode:t,children:null},this.mapToItems[t.id]=this.pathRoot}depthFirstSearchChangedPath(e,t){let{rowNode:i,children:n}=e;if(n)for(let o=0;o<n.length;++o)this.depthFirstSearchChangedPath(n[o],t);t(i)}depthFirstSearchEverything(e,t,i){let n=e.childrenAfterGroup;if(n)for(let o=0,s=n.length;o<s;++o){let r=n[o];r.childrenAfterGroup?this.depthFirstSearchEverything(r,t,i):i&&t(r)}t(e)}forEachChangedNodeDepthFirst(e,t=!1,i=!1){this.active&&!i?this.depthFirstSearchChangedPath(this.pathRoot,e):this.depthFirstSearchEverything(this.pathRoot.rowNode,e,t)}executeFromRootNode(e){e(this.pathRoot.rowNode)}createPathItems(e){let t=e,i=0;for(;!this.mapToItems[t.id];){let n={rowNode:t,children:null};this.mapToItems[t.id]=n,i++,t=t.parent}return i}populateColumnsMap(e,t){if(!this.keepingColumns||!t)return;let i=e;for(;i;){this.nodeIdsToColumns[i.id]||(this.nodeIdsToColumns[i.id]={});for(let n of t)this.nodeIdsToColumns[i.id][n.getId()]=!0;i=i.parent}}linkPathItems(e,t){let i=e;for(let n=0;n<t;n++){let o=this.mapToItems[i.id],s=this.mapToItems[i.parent.id];s.children||(s.children=[]),s.children.push(o),i=i.parent}}addParentNode(e,t){if(!e||e.isRowPinned())return;let i=this.createPathItems(e);this.linkPathItems(e,i),this.populateColumnsMap(e,t)}canSkip(e){return this.active&&!this.mapToItems[e.id]}getValueColumnsForNode(e,t){if(!this.keepingColumns)return t;let i=this.nodeIdsToColumns[e.id];return t.filter(o=>i[o.getId()])}getNotValueColumnsForNode(e,t){if(!this.keepingColumns)return null;let i=this.nodeIdsToColumns[e.id];return t.filter(o=>!i[o.getId()])}},OV=class{constructor(e,t){this.beans=e,this.groupThrottled=!1,this.scrollChanged=!1,this.scrollChanging=!1,this.oldVScroll=null,this.groupTimer=null,this.groupTarget=null,this.onGroupThrottle=()=>{this.groupTimer=null,this.groupThrottled=!0,this.beans.dragAndDrop?.nudge()};let i=()=>t.scrollFeature.getVScrollPosition().top;this.autoScroll=new WG({scrollContainer:t.eBodyViewport,scrollAxis:"y",getVerticalPosition:i,setVerticalPosition:n=>t.scrollFeature.setVerticalScrollPosition(n),onScrollCallback:()=>{let n=i();if(this.oldVScroll!==n){this.oldVScroll=n,this.scrollChanging=!0;return}let o=this.scrollChanging;this.scrollChanged=o,this.scrollChanging=!1,o&&(this.beans.dragAndDrop?.nudge(),this.scrollChanged=!1)}})}updateGroup(e,t){this.groupTarget&&this.groupTarget!==e&&this.clearGroup(),e&&(t&&this.groupThrottled&&!e.expanded&&e.childrenAfterSort?.length&&e.isExpandable()&&e.setExpanded(!0,void 0,!0),e.expanded&&e.childrenAfterSort?.length&&(this.groupThrottled=!0,this.groupTarget=e))}startGroup(e){this.groupTarget=e,this.groupTimer===null&&(this.groupTimer=window.setTimeout(this.onGroupThrottle,this.beans.gos.get("rowDragInsertDelay")))}clearGroup(){this.groupThrottled=!1,this.groupTarget=null;let e=this.groupTimer;e!==null&&(this.groupTimer=null,window.clearTimeout(e))}clear(){this.clearGroup(),this.autoScroll.ensureCleared(),this.oldVScroll=null,this.scrollChanged=!1,this.scrollChanging=!1}},NV=class extends D{constructor(e){super(),this.eContainer=e,this.lastDraggingEvent=null,this.nudger=null}postConstruct(){let e=this.beans;e.ctrlsSvc.whenReady(this,t=>{this.nudger=new OV(e,t.gridBodyCtrl)})}destroy(){super.destroy(),this.nudger?.clear(),this.nudger=null,this.lastDraggingEvent=null,this.eContainer=null}getContainer(){return this.eContainer}isInterestedIn(e){return e===2}getIconName(e){return e?.dropTarget?.allowed===!1||this.gos.get("rowDragManaged")&&this.shouldPreventRowMove()?"notAllowed":"move"}shouldPreventRowMove(){let{rowGroupColsSvc:e,filterManager:t,sortSvc:i}=this.beans;return!!((e?.columns??[]).length||t?.isAnyFilterPresent()||i?.isSortActive())}getRowNodes(e){if(!this.isFromThisGrid(e))return e.dragItem.rowNodes||[];let t=e.dragItem.rowNode;if(this.gos.get("rowDragMultiRow")){let i=this.beans.selectionSvc?.getSelectedNodes();if(i&&i.indexOf(t)>=0)return i.slice().sort(GV)}return[t]}onDragEnter(e){this.dragging(e,!0)}onDragging(e){this.dragging(e,!1)}dragging(e,t){let{lastDraggingEvent:i,beans:n}=this;if(t){let r=this.getRowNodes(e);e.dragItem.rowNodes=r,lR(r,!0)}this.lastDraggingEvent=e;let o=e.fromNudge,s=this.makeRowsDrop(i,e,o,!1);n.rowDropHighlightSvc?.fromDrag(e),t&&this.dispatchGridEvent("rowDragEnter",e),this.dispatchGridEvent("rowDragMove",e),s?.rowDragManaged&&s.moved&&s.allowed&&s.sameGrid&&!s.suppressMoveWhenRowDragging&&(!o&&!this.nudger?.autoScroll.scrolling||this.nudger?.scrollChanged)&&this.dropRows(s),this.nudger?.autoScroll.check(e.event)}isFromThisGrid(e){return e.dragSource.dragSourceDomDataKey===this.gos.getDomDataKey()}makeRowsDrop(e,t,i,n){let{beans:o,gos:s}=this,r=this.newRowsDrop(t,n),a=o.rowModel;if(t.dropTarget=r,t.changed=!1,!r)return null;let{sameGrid:l,rootNode:d,source:c,target:u,rows:h}=r;u??(u=a.getRow(a.getRowCount()-1)??null);let p=!!this.beans.groupStage?.treeData&&l,g=null;if(u?.footer){let w=ip(a,-1,u)??ip(a,1,u);g=u.sibling??d,u=w??null}u?.detail&&(u=u.parent),r.moved&&(r.moved=c!==u);let f=.5;if(u&&(l&&r.moved&&(g||!p)?f=c.rowIndex>u.rowIndex?-.5:.5:f=(r.y-u.rowTop-u.rowHeight/2)/u.rowHeight||0),!p&&l&&u&&r.moved&&gt(s)){let w=VV(a,r);w&&(f=c.rowIndex>w.rowIndex?-.5:.5,u=w,r.moved&&(r.moved=c!==u))}let m=this.nudger;m?.updateGroup(u,i),p&&!g&&m&&(!u||f>=.5&&u.rowIndex===o.pageBounds.getLastRow()?g=d:r.moved&&this.targetShouldBeParent(u,f,h)&&(m.groupThrottled&&(g=u),!i&&(!g||u&&!u.expanded&&u.childrenAfterSort?.length)&&m.startGroup(u)),g??(g=u?.parent??d));let C=!1;if(g){if(g===u&&g!==d){let w=g.expanded?ip(a,1,u):null;w?.parent===g?(u=w,f=-.5):C=!0}if(u&&!C){let w=u;for(;w&&w!==d&&w!==g;)u=w,w=w.parent}}r.target=u,r.newParent=g,r.moved&&(r.moved=c!==u);let v=f<0?"above":"below";return r.position=r.moved?C?"inside":v:"none",this.validateRowsDrop(r,p,v,n),t.changed||(t.changed=HV(e?.dropTarget,r)),r}newRowsDrop(e,t){let{beans:i,gos:n}=this,o=i.rowModel.rootNode,s=gt(n)?n.get("rowDragManaged"):!1,r=n.get("suppressMoveWhenRowDragging"),a=this.isFromThisGrid(e),{rowNode:l,rowNodes:d}=e.dragItem;if(d||(d=l?[l]:[]),l||(l=d[0]),!l||!o)return null;let c=this.beans.dragAndDrop.isDropZoneWithinThisGrid(e),u=!0;s&&(!d.length||this.shouldPreventRowMove()||(r||!a)&&!c)&&(u=!1);let h=jE(i,e).y,p=this.getOverNode(h);return{api:i.gridApi,context:i.gridOptions.context,draggingEvent:e,rowDragManaged:s,suppressMoveWhenRowDragging:r,sameGrid:a,withinGrid:c,rootNode:o,moved:l!==p,y:h,overNode:p,overIndex:p?.rowIndex??-1,position:"none",source:l,target:p??null,newParent:null,rows:d,allowed:u,highlight:!t&&s&&r&&(c||!a)}}validateRowsDrop(e,t,i,n){let{rowDragManaged:o,suppressMoveWhenRowDragging:s}=e;t||(e.newParent=null),s&&!e.moved&&(e.allowed=!1);let r=(!o||e.allowed)&&this.gos.get("isRowValidDropPosition");if(r){t&&e.newParent&&rR(e.rows,e.newParent)&&(e.newParent=null);let a=r(e);if(!a)e.allowed=!1;else if(typeof a=="object"){a.rows!==void 0&&(e.rows=a.rows??[]),t&&a.newParent!==void 0&&(e.newParent=a.newParent),a.target!==void 0&&(e.target=a.target),a.position&&(e.position=a.position),a.allowed!==void 0?e.allowed=a.allowed:o||(e.allowed=!0);let l=e.draggingEvent;a.changed&&l&&(l.changed=!0),!n&&a.highlight!==void 0&&(e.highlight=a.highlight)}}o&&(e.rows=this.filterRows(e)),t&&e.newParent&&rR(e.rows,e.newParent)&&(e.newParent=null),s&&(!e.rows.length||e.position==="none")&&(e.allowed=!1),(!e.allowed||!e.newParent)&&e.position==="inside"&&(e.position=i)}targetShouldBeParent(e,t,i){let n=e.rowIndex,o=.25;if(t<-.5+o)return!1;if(t<.5-o)return!0;let s,r=n+1,a=this.beans.rowModel;do s=a.getRow(r++);while(s?.footer);let l=e.childrenAfterGroup;if(s&&s.parent===e&&l?.length){let d=new Set(i);for(let c of l)if(c.rowIndex!==null&&!d.has(c))return!0}return!1}addRowDropZone(e){if(!e.getContainer()){I(55);return}let t=this.beans.dragAndDrop;if(t.findExternalZone(e.getContainer())){I(56);return}let i=e.fromGrid?e:{getContainer:e.getContainer,onDragEnter:e.onDragEnter&&(o=>e.onDragEnter(this.rowDragEvent("rowDragEnter",o))),onDragLeave:e.onDragLeave&&(o=>e.onDragLeave(this.rowDragEvent("rowDragLeave",o))),onDragging:e.onDragging&&(o=>e.onDragging(this.rowDragEvent("rowDragMove",o))),onDragStop:e.onDragStop&&(o=>e.onDragStop(this.rowDragEvent("rowDragEnd",o))),onDragCancel:e.onDragCancel&&(o=>e.onDragCancel(this.rowDragEvent("rowDragCancel",o)))},n=b({isInterestedIn:o=>o===2,getIconName:()=>"move",external:!0},i);t.addDropTarget(n),this.addDestroyFunc(()=>t.removeDropTarget(n))}getRowDropZone(e){return{getContainer:this.getContainer.bind(this),onDragEnter:i=>{this.onDragEnter(i),e?.onDragEnter?.(this.rowDragEvent("rowDragEnter",i))},onDragLeave:i=>{this.onDragLeave(i),e?.onDragLeave?.(this.rowDragEvent("rowDragLeave",i))},onDragging:i=>{this.onDragging(i),e?.onDragging?.(this.rowDragEvent("rowDragMove",i))},onDragStop:i=>{this.onDragStop(i),e?.onDragStop?.(this.rowDragEvent("rowDragEnd",i))},onDragCancel:i=>{this.onDragCancel(i),e?.onDragCancel?.(this.rowDragEvent("rowDragCancel",i))},fromGrid:!0}}getOverNode(e){let{pageBounds:t,rowModel:i}=this.beans,o=e>t.getCurrentPagePixelRange().pageLastPixel?-1:i.getRowIndexAtPixel(e);return o>=0?i.getRow(o):void 0}rowDragEvent(e,t){let i=this.beans,{dragItem:n,dropTarget:o,event:s,vDirection:r}=t,a=o?.rootNode===i.rowModel.rootNode,l=a?o.y:jE(i,t).y,d=a?o.overNode:this.getOverNode(l),c=a?o.overIndex:d?.rowIndex??-1;return{api:i.gridApi,context:i.gridOptions.context,type:e,event:s,node:n.rowNode,nodes:n.rowNodes,overIndex:c,overNode:d,y:l,vDirection:r,rowsDrop:o}}dispatchGridEvent(e,t){let i=this.rowDragEvent(e,t);this.eventSvc.dispatchEvent(i)}onDragLeave(e){this.dispatchGridEvent("rowDragLeave",e),this.stopDragging(e)}onDragStop(e){let t=this.makeRowsDrop(this.lastDraggingEvent,e,!1,!0);this.dispatchGridEvent("rowDragEnd",e),t?.allowed&&t.rowDragManaged&&(t.suppressMoveWhenRowDragging||!t.sameGrid||this.nudger?.autoScroll.scrolling)&&this.dropRows(t),this.stopDragging(e)}onDragCancel(e){this.dispatchGridEvent("rowDragCancel",e),this.stopDragging(e)}stopDragging(e){this.nudger?.clear(),this.beans.rowDropHighlightSvc?.fromDrag(null),lR(e.dragItem.rowNodes,!1)}dropRows(e){return e.sameGrid?this.csrmMoveRows(e):this.csrmAddRows(e)}csrmAddRows({position:e,target:t,rows:i}){let n=Ca(this.gos),o=this.beans.rowModel,s=i.filter(({data:a,rowPinned:l})=>!o.getRowNode(n?.({data:a,level:0,rowPinned:l})??a.id)).map(({data:a})=>a);if(s.length===0)return!1;let r=t?aR(t)+(e==="above"?0:1):void 0;return o.updateRowData({add:s,addIndex:r}),!0}filterRows({newParent:e,rows:t}){let i;for(let n=0,o=t.length;n<o;++n){let s=!0,r=t[n];(!r||r.footer||r.rowTop===null&&r!==this.beans.rowModel.getRowNode(r.id)||e&&r.parent!==e&&BV(r,e)||!zC(r))&&(s=!1),s?i?.push(r):i??(i=t.slice(0,n))}return i??t}csrmMoveRows({position:e,target:t,rows:i,newParent:n,rootNode:o}){let s=!1,r=new Set;for(let h of i){n&&h.parent!==n&&(h.treeParent=n,s=!0);let p=zC(h);p&&r.add(p)}if(!s&&r.size===0)return!1;let a=this.beans.focusSvc,l=a.getFocusedCell(),d=l&&oa(this.beans,l);if(r.size&&this.reorderLeafChildren(r,...this.getMoveRowsBounds(r,t,e==="above"))&&(s=!0),!s)return!1;let c=this.beans.rowModel,u=new tp;return u.reordered=!0,c.refreshModel({step:"group",keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame"),changedPath:new pd(!1,o),changedRowNodes:u}),d?d.focusCell():a.clearFocusedCell(),!0}getMoveRowsBounds(e,t,i){let n=this.beans.rowModel.rootNode?._leafs?.length??0,o=t?aR(t):-1;o<0||o>=n?o=n:i||++o;let s=o,r=Math.min(o,n-1);for(let a of e){let l=a.sourceRowIndex;l<s&&(s=l),l>r&&(r=l)}return[s,o,r]}reorderLeafChildren(e,t,i,n){let o=!1,s=this.beans.rowModel.rootNode?._leafs;if(!e.size||!s)return!1;let r=t;for(let l=t;l<i;++l){let d=s[l];e.has(d)||(d.sourceRowIndex!==r&&(d.sourceRowIndex=r,s[r]=d,o=!0),++r)}let a=n;for(let l=n;l>=i;--l){let d=s[l];e.has(d)||(d.sourceRowIndex!==a&&(d.sourceRowIndex=a,s[a]=d,o=!0),--a)}for(let l of e)l.sourceRowIndex!==r&&(l.sourceRowIndex=r,s[r]=l,o=!0),++r;return o}},ip=(e,t,i)=>{if(i){let n=e.getRowCount(),o=i.rowIndex+t;for(;o>=0&&o<n;){let s=e.getRow(o);if(!s||!s.footer&&!s.detail)return s;o+=t}}},BV=(e,t)=>{let i=t;for(;i;){if(i===e)return!0;i=i.parent}return!1},rR=(e,t)=>{for(let i=0,n=e.length;i<n;++i)if(e[i].parent!==t)return!1;return!0},aR=e=>{let t=zC(e);return t!==void 0?t.sourceRowIndex:-1},zC=e=>e.data?e:c4(e.childrenAfterGroup),HV=(e,t)=>e!==t&&(!e||e.sameGrid!==t.sameGrid||e.allowed!==t.allowed||e.position!==t.position||e.target!==t.target||e.source!==t.source||e.newParent!==t.newParent||!Zo(e.rows,t.rows)),GV=({rowIndex:e},{rowIndex:t})=>e!==null&&t!==null?e-t:0,lR=(e,t)=>{for(let i=0,n=e?.length||0;i<n;++i){let o=e[i];o.dragging!==t&&(o.dragging=t,o.dispatchRowEvent("draggingChanged"))}},VV=(e,t)=>{let i=null,n=t.target;if(n&&t.rows.indexOf(n)<0)return null;let o=t.source;if(!n||!o)return null;let s=n.rowIndex-o.rowIndex,r=s<0?-1:1;s=t.suppressMoveWhenRowDragging?Math.abs(s):1;let a=new Set(t.rows);do{let l=ip(e,r,n);if(!l)break;a.has(l)||(i=l,--s),n=l}while(s>0);return i},zV=class extends D{constructor(){super(...arguments),this.beanName="rowDragSvc"}setupRowDrag(e,t){let i=t.createManagedBean(new NV(e)),n=this.beans.dragAndDrop;n.addDropTarget(i),t.addDestroyFunc(()=>n.removeDropTarget(i)),this.rowDragFeature=i}createRowDragComp(e,t,i,n,o,s){return new kV(e,t,i,n,o,s)}createRowDragCompForRow(e,t){if(uo(this.gos))return;let i=this.getLocaleTextFunc();return this.createRowDragComp(()=>`1 ${i("rowDragRow","row")}`,e,void 0,t,void 0,!0)}createRowDragCompForCell(e,t,i,n,o,s){let r=this.gos;return r.get("rowDragManaged")&&(!gt(r)||r.get("pagination"))?void 0:this.createRowDragComp(i,e,t,n,o,s)}},WV=class extends D{constructor(){super(...arguments),this.beanName="rowDropHighlightSvc",this.uiLevel=0,this.dragging=!1,this.row=null,this.position="none"}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this)})}onModelUpdated(){let e=this.row,t=this.dragging;!e||e?.rowIndex===null||this.position==="none"?this.clear():this.set(e,this.position),this.dragging=t}destroy(){this.clear(),super.destroy()}clear(){let e=this.row;this.dragging=!1,e&&(this.uiLevel=0,this.position="none",this.row=null,e.dispatchRowEvent("rowHighlightChanged"))}set(e,t){let i=e!==this.row,n=e.uiLevel,o=t!==this.position,s=n!==this.uiLevel;this.dragging=!1,(i||o||s)&&(i&&this.clear(),this.uiLevel=n,this.position=t,this.row=e,e.dispatchRowEvent("rowHighlightChanged"))}fromDrag(e){let t=e?.dropTarget;if(t){let{highlight:i,target:n,position:o}=t;if(i&&n&&o!=="none"){this.set(n,o),this.dragging=!0;return}}this.dragging&&this.clear()}},B4={moduleName:"Drag",version:z,beans:[RV]},UV={moduleName:"DragAndDrop",version:z,dynamicBeans:{dndSourceComp:wV},icons:{rowDrag:"grip"}},H4={moduleName:"SharedDragAndDrop",version:z,beans:[VB],dependsOn:[B4],userComponents:{agDragAndDropImage:yG},icons:{columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",rowDrag:"grip"}},qV={moduleName:"RowDrag",version:z,beans:[WV,zV],apiFunctions:{addRowDropZone:bV,removeRowDropZone:yV,getRowDropZoneParams:SV,getRowDropPositionIndicator:xV,setRowDropPositionIndicator:EV},dependsOn:[H4]},$V={moduleName:"HorizontalResize",version:z,beans:[PV],dependsOn:[B4]},jV=":where(.ag-ltr) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:left .2s}.ag-header-group-cell{transition:left .2s,width .2s}}:where(.ag-rtl) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:right .2s}.ag-header-group-cell{transition:right .2s,width .2s}}",KV=class extends D{constructor(){super(...arguments),this.beanName="colAnimation",this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.activeNext=!1,this.suppressAnimation=!1,this.animationThreadCount=0}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>this.gridBodyCtrl=e.gridBodyCtrl)}isActive(){return this.active&&!this.suppressAnimation}setSuppressAnimation(e){this.suppressAnimation=e}start(){if(this.active)return;let{gos:e}=this;e.get("suppressColumnMoveAnimation")||e.get("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0,this.activeNext=!0)}finish(){this.active&&this.flush(()=>this.activeNext=!1,()=>this.active=!1)}executeNextVMTurn(e){this.activeNext?this.executeNextFuncs.push(e):e()}executeLaterVMTurn(e){this.active?this.executeLaterFuncs.push(e):e()}ensureAnimationCssClassPresent(){this.animationThreadCount++;let e=this.animationThreadCount,{gridBodyCtrl:t}=this;t.setColumnMovingCss(!0),this.executeLaterFuncs.push(()=>{this.animationThreadCount===e&&t.setColumnMovingCss(!1)})}flush(e,t){let{executeNextFuncs:i,executeLaterFuncs:n}=this;if(i.length===0&&n.length===0){e(),t();return}let o=s=>{for(;s.length;){let r=s.pop();r&&r()}};this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e(),o(i)},0),window.setTimeout(()=>{t(),o(n)},200)})}};function YV(e,t,i){e.colMoves?.moveColumnByIndex(t,i,"api")}function XV(e,t,i){e.colMoves?.moveColumns(t,i,"api")}var JV=class extends D{constructor(e){super(),this.pinned=e,this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[]}onDragEnter(e){if(this.clearColumnsList(),this.gos.get("functionsReadOnly"))return;let t=e.dragItem.columns;if(t)for(let i of t)i.isPrimary()&&(i.isAnyFunctionActive()||(i.isAllowValue()?this.columnsToAggregate.push(i):i.isAllowRowGroup()?this.columnsToGroup.push(i):i.isAllowPivot()&&this.columnsToPivot.push(i)))}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?"pinned":"move":null}onDragLeave(e){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(e){}onDragStop(e){let{valueColsSvc:t,rowGroupColsSvc:i,pivotColsSvc:n}=this.beans;this.columnsToAggregate.length>0&&t?.addColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&i?.addColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&n?.addColumns(this.columnsToPivot,"toolPanelDragAndDrop")}onDragCancel(){this.clearColumnsList()}};function QV(e,t){!t||t.length<=1||t.filter(n=>e.indexOf(n)<0).length>0||t.sort((n,o)=>{let s=e.indexOf(n),r=e.indexOf(o);return s-r})}function ZV(e){let t=[...e];for(let i of e){let n=null,o=i.getParent();for(;o!=null&&o.getDisplayedLeafColumns().length===1;)n=o,o=o.getParent();if(n!=null){let r=!!n.getColGroupDef()?.marryChildren?n.getProvidedColumnGroup().getLeafColumns():n.getLeafColumns();for(let a of r)t.includes(a)||t.push(a)}}return t}function ez(e,t,i,n){let o=n.allCols,s=null,r=null;for(let a=0;a<e.length;a++){let l=e[a],d=i.getProposedColumnOrder(t,l);if(!i.doesOrderPassRules(d))continue;let c=d.filter(h=>o.includes(h));if(r===null)r=c;else if(!Zo(c,r))break;let u=iz(d);(s===null||u<s.fragCount)&&(s={move:l,fragCount:u})}return s}function G4(e){let{isFromHeader:t,fromLeft:i,xPosition:n,fromEnter:o,fakeEvent:s,pinned:r,gos:a,colModel:l,colMoves:d,visibleCols:c}=e,{allMovingColumns:u}=e;t&&(u=ZV(u));let h=u.slice();QV(l.getCols(),h);let p=oz({movingCols:h,draggingRight:i,xPosition:n,pinned:r,gos:a,colModel:l,visibleCols:c}),g=tz(h,l);if(p.length===0)return;let f=p[0];if(g!==null&&(t||!o)&&!s&&(!i&&f>=g||i&&f<=g))return;let C=ez(p,h,d,c);if(!C)return;let v=C.move;if(!(v>l.getCols().length-h.length))return{columns:h,toIndex:v}}function V4(e){let{columns:t,toIndex:i}=G4(e)||{},{finished:n,colMoves:o}=e;return!t||i==null?null:(o.moveColumns(t,i,"uiColumnMoved",n),n?null:{columns:t,toIndex:i})}function tz(e,t){let i=t.getCols(),n=e.map(l=>i.indexOf(l)).sort((l,d)=>l-d),o=n[0];return Ue(n)-o!==n.length-1?null:o}function iz(e){function t(n){let o=[],s=n.getOriginalParent();for(;s!=null;)o.push(s),s=s.getOriginalParent();return o}let i=0;for(let n=0;n<e.length-1;n++){let o=t(e[n]),s=t(e[n+1]);[o,s]=o.length>s.length?[o,s]:[s,o];for(let r of o)s.indexOf(r)===-1&&i++}return i}function nz(e,t){switch(t){case"left":return e.leftCols;case"right":return e.rightCols;default:return e.centerCols}}function oz(e){let{movingCols:t,draggingRight:i,xPosition:n,pinned:o,gos:s,colModel:r,visibleCols:a}=e;if(s.get("suppressMovableColumns")||t.some(w=>w.getColDef().suppressMovable))return[];let d=nz(a,o),c=r.getCols(),u=d.filter(w=>t.includes(w)),h=d.filter(w=>!t.includes(w)),p=c.filter(w=>!t.includes(w)),g=0,f=n;if(i){let w=0;for(let y of u)w+=y.getActualWidth();f-=w}if(f>0){for(let w=0;w<h.length;w++){let y=h[w];if(f-=y.getActualWidth(),f<0)break;g++}i&&g++}let m;if(g>0){let w=h[g-1];m=p.indexOf(w)+1}else m=p.indexOf(h[0]),m===-1&&(m=0);let C=[m],v=(w,y)=>w-y;if(i){let w=m+1,y=c.length-1;for(;w<=y;)C.push(w),w++;C.sort(v)}else{let w=m,y=c.length-1,S=c[w];for(;w<=y&&d.indexOf(S)<0;)w++,C.push(w),S=c[w];w=m-1;let x=0;for(;w>=x;)C.push(w),w--;C.sort(v).reverse()}return C}function WC(e){let{pinned:t,fromKeyboard:i,gos:n,ctrlsSvc:o,useHeaderRow:s,skipScrollPadding:r}=e,a=o.getHeaderRowContainerCtrl(t)?.eViewport,{x:l}=e;return a?(i&&(l-=a.getBoundingClientRect().left),n.get("enableRtl")&&(s&&(a=a.querySelector(".ag-header-row")),l=a.clientWidth-l),t==null&&!r&&(l+=o.get("center").getCenterViewportScrollLeft()),l):0}function lC(e,t){for(let i of e)i.moving=t,i.dispatchColEvent("movingChanged","uiColumnMoved")}var dR=7,UC=100,qh=UC/2,sz=5,rz=100,az=class extends D{constructor(e){super(),this.pinned=e,this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.isCenterContainer=!q(e)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}getIconName(){let{pinned:e,lastDraggingEvent:t}=this,{dragItem:i}=t||{},n=i?.columns??[];for(let o of n){let s=o.getPinned();if(o.getColDef().lockPinned){if(s==e)return"move";continue}let r=i?.containerType;if(r===e||!e)return"move";if(e&&(!s||r!==e))return"pinned"}return"notAllowed"}onDragEnter(e){let t=e.dragItem,i=t.columns;if(e.dragSource.type===0)this.setColumnsVisible(i,!0,"uiColumnDragged");else{let o=t.visibleState,s=(i||[]).filter(r=>o[r.getId()]&&!r.isVisible());this.setColumnsVisible(s,!0,"uiColumnDragged")}this.gos.get("suppressMoveWhenColumnDragging")||this.attemptToPinColumns(i,this.pinned),this.onDragging(e,!0,!0)}onDragging(e=this.lastDraggingEvent,t=!1,i=!1,n=!1){let{gos:o,ctrlsSvc:s}=this.beans,r=o.get("suppressMoveWhenColumnDragging");if(n&&!r){this.finishColumnMoving();return}if(this.lastDraggingEvent=e,!e||!n&&Qe(e.hDirection))return;let a=WC({x:e.x,pinned:this.pinned,gos:o,ctrlsSvc:s});t||this.checkCenterForScrolling(a),r?this.handleColumnDragWhileSuppressingMovement(e,t,i,a,n):this.handleColumnDragWhileAllowingMovement(e,t,i,a,n)}onDragLeave(){this.ensureIntervalCleared(),this.clearHighlighted(),this.updateDragItemContainerType(),this.lastMovedInfo=null}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}onDragCancel(){this.clearHighlighted(),this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(e,t,i){if(!e?.length)return;let n=e.filter(o=>!o.getColDef().lockVisible);n.length&&this.beans.colModel.setColsVisible(n,t,i)}finishColumnMoving(){this.clearHighlighted();let e=this.lastMovedInfo;if(!e)return;let{columns:t,toIndex:i}=e;this.beans.colMoves.moveColumns(t,i,"uiColumnMoved",!0)}updateDragItemContainerType(){let{lastDraggingEvent:e}=this;if(this.gos.get("suppressMoveWhenColumnDragging")||!e)return;let t=e.dragItem;t&&(t.containerType=this.pinned)}handleColumnDragWhileSuppressingMovement(e,t,i,n,o){let s=this.getAllMovingColumns(e,!0);if(o){let r=this.isAttemptingToPin(s);r&&this.attemptToPinColumns(s,void 0,!0);let{fromLeft:a,xPosition:l}=this.getNormalisedXPositionInfo(s,r)||{};if(a==null||l==null){this.finishColumnMoving();return}this.moveColumnsAfterHighlight({allMovingColumns:s,xPosition:l,fromEnter:t,fakeEvent:i,fromLeft:a})}else{if(!this.beans.dragAndDrop.isDropZoneWithinThisGrid(e))return;this.highlightHoveredColumn(s,n)}}handleColumnDragWhileAllowingMovement(e,t,i,n,o){let s=this.getAllMovingColumns(e),r=this.normaliseDirection(e.hDirection)==="right",a=e.dragSource.type===1,l=this.getMoveColumnParams({allMovingColumns:s,isFromHeader:a,xPosition:n,fromLeft:r,fromEnter:t,fakeEvent:i}),d=V4(_(b({},l),{finished:o}));d&&(this.lastMovedInfo=d)}getAllMovingColumns(e,t=!1){let i=e.dragSource.getDragItem(),n=null;t?(n=i.columnsInSplit,n||(n=i.columns)):n=i.columns;let o=s=>s.getColDef().lockPinned?s.getPinned()==this.pinned:!0;return n?n.filter(o):[]}getMoveColumnParams(e){let{allMovingColumns:t,isFromHeader:i,xPosition:n,fromLeft:o,fromEnter:s,fakeEvent:r}=e,{gos:a,colModel:l,colMoves:d,visibleCols:c}=this.beans;return{allMovingColumns:t,isFromHeader:i,fromLeft:o,xPosition:n,pinned:this.pinned,fromEnter:s,fakeEvent:r,gos:a,colModel:l,colMoves:d,visibleCols:c}}highlightHoveredColumn(e,t){let{gos:i,colModel:n}=this.beans,o=i.get("enableRtl"),s=n.getCols().filter(c=>c.isVisible()&&c.getPinned()===this.pinned),r=null,a=null,l=null;for(let c of s){if(a=c.getActualWidth(),r=this.getNormalisedColumnLeft(c,0,o),r!=null){let u=r+a;if(r<=t&&u>=t){l=c;break}}r=null,a=null}if(l)e.indexOf(l)!==-1&&(l=null);else{for(let c=s.length-1;c>=0;c--){let u=s[c],h=s[c].getParent();if(!h){l=u;break}let p=h?.getDisplayedLeafColumns();if(p.length){l=Ue(p);break}}if(!l)return;r=this.getNormalisedColumnLeft(l,0,o),a=l.getActualWidth()}if(this.lastHighlightedColumn?.column!==l&&this.clearHighlighted(),l==null||r==null||a==null)return;let d;t-r<a/2!==o?d=0:d=1,cR(l,d),this.lastHighlightedColumn={column:l,position:d}}getNormalisedXPositionInfo(e,t){let{gos:i,visibleCols:n}=this.beans,o=i.get("enableRtl"),{firstMovingCol:s,column:r,position:a}=this.getColumnMoveAndTargetInfo(e,t,o);if(!s||!r||a==null)return;let l=n.allCols,d=l.indexOf(s),c=l.indexOf(r),u=a===0!==o,h=d<c||d===c&&!u,p=0;if(u?h&&(p-=1):h||(p+=1),c+p===d)return;let g=l[c+p];if(!g)return;let f=this.getNormalisedColumnLeft(g,20,o);return{fromLeft:h,xPosition:f}}getColumnMoveAndTargetInfo(e,t,i){let n=this.lastHighlightedColumn||{},{firstMovingCol:o,lastMovingCol:s}=lz(e);if(!o||!s||n.column||!t)return b({firstMovingCol:o},n);let a=this.getPinDirection()==="left";return{firstMovingCol:o,position:a?1:0,column:a!==i?o:s}}normaliseDirection(e){if(this.gos.get("enableRtl"))switch(e){case"left":return"right";case"right":return"left"}return e}getNormalisedColumnLeft(e,t,i){let{gos:n,ctrlsSvc:o}=this.beans,s=e.getLeft();if(s==null)return null;let r=e.getActualWidth();return WC({x:i?s+r-t:s+t,pinned:e.getPinned(),useHeaderRow:i,skipScrollPadding:!0,gos:n,ctrlsSvc:o})}isAttemptingToPin(e){let t=this.needToMoveLeft||this.needToMoveRight,i=this.failedMoveAttempts>dR;return t&&i||e.some(n=>n.getPinned()!==this.pinned)}moveColumnsAfterHighlight(e){let{allMovingColumns:t,xPosition:i,fromEnter:n,fakeEvent:o,fromLeft:s}=e,r=this.getMoveColumnParams({allMovingColumns:t,isFromHeader:!0,xPosition:i,fromLeft:s,fromEnter:n,fakeEvent:o}),{columns:a,toIndex:l}=G4(r)||{};a&&l!=null&&(this.lastMovedInfo={columns:a,toIndex:l}),this.finishColumnMoving()}clearHighlighted(){let{lastHighlightedColumn:e}=this;e&&(cR(e.column,null),this.lastHighlightedColumn=null)}checkCenterForScrolling(e){if(!this.isCenterContainer)return;let t=this.beans.ctrlsSvc.get("center"),i=t.getCenterViewportScrollLeft(),n=i+t.getCenterWidth(),o,s;this.gos.get("enableRtl")?(o=e<i+qh,s=e>n-qh):(s=e<i+qh,o=e>n-qh),this.needToMoveRight=o,this.needToMoveLeft=s,s||o?this.ensureIntervalStarted():this.ensureIntervalCleared()}ensureIntervalStarted(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),rz),this.beans.dragAndDrop.setDragImageCompIcon(this.needToMoveLeft?"left":"right",!0))}ensureIntervalCleared(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.failedMoveAttempts=0,this.beans.dragAndDrop.setDragImageCompIcon(this.getIconName()))}moveInterval(){let e;this.intervalCount++,e=10+this.intervalCount*sz,e>UC&&(e=UC);let t=null,i=this.gridBodyCon.scrollFeature;if(this.needToMoveLeft?t=i.scrollHorizontally(-e):this.needToMoveRight&&(t=i.scrollHorizontally(e)),t!==0)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;let{pinnedCols:n,dragAndDrop:o,gos:s}=this.beans;if(this.failedMoveAttempts<=dR+1||!n)return;if(o.setDragImageCompIcon("pinned"),!s.get("suppressMoveWhenColumnDragging")){let r=this.lastDraggingEvent?.dragItem.columns;this.attemptToPinColumns(r,void 0,!0)}}}getPinDirection(){if(this.needToMoveLeft||this.pinned==="left")return"left";if(this.needToMoveRight||this.pinned==="right")return"right"}attemptToPinColumns(e,t,i=!1){let n=(e||[]).filter(r=>!r.getColDef().lockPinned);if(!n.length)return 0;i&&(t=this.getPinDirection());let{pinnedCols:o,dragAndDrop:s}=this.beans;return o?.setColsPinned(n,t,"uiColumnDragged"),i&&s.nudge(),n.length}destroy(){super.destroy(),this.lastDraggingEvent=null,this.clearHighlighted(),this.lastMovedInfo=null}};function cR(e,t){e.highlighted!==t&&(e.highlighted=t,e.dispatchColEvent("headerHighlightChanged","uiColumnMoved"))}function lz(e){let t=e.length,i,n;for(let o=0;o<t;o++){if(!i){let s=e[o];s.getLeft()!=null&&(i=s)}if(!n){let s=e[t-1-o];s.getLeft()!=null&&(n=s)}if(i&&n)break}return{firstMovingCol:i,lastMovingCol:n}}var dz=class extends D{constructor(e,t){super(),this.pinned=e,this.eContainer=t}postConstruct(){let{ctrlsSvc:e,dragAndDrop:t}=this.beans,i=this.pinned;e.whenReady(this,n=>{let o,s=n.gridBodyCtrl.eBodyViewport;switch(i){case"left":o=[[s,n.left.eContainer],[n.bottomLeft.eContainer],[n.topLeft.eContainer]];break;case"right":o=[[s,n.right.eContainer],[n.bottomRight.eContainer],[n.topRight.eContainer]];break;default:o=[[s,n.center.eViewport],[n.bottomCenter.eViewport],[n.topCenter.eViewport]];break}this.eSecondaryContainers=o}),this.moveColumnFeature=this.createManagedBean(new az(i)),this.bodyDropPivotTarget=this.createManagedBean(new JV(i)),t.addDropTarget(this),this.addDestroyFunc(()=>t.removeDropTarget(this))}isInterestedIn(e){return e===1||e===0&&this.gos.get("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(e){return this.beans.colModel.isPivotMode()&&e.dragSource.type===0}onDragEnter(e){this.currentDropListener=this.isDropColumnInPivotMode(e)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(e)}onDragLeave(e){this.currentDropListener.onDragLeave(e)}onDragging(e){this.currentDropListener.onDragging(e)}onDragStop(e){this.currentDropListener.onDragStop(e)}onDragCancel(){this.currentDropListener.onDragCancel()}},cz=class extends D{constructor(){super(...arguments),this.beanName="colMoves"}moveColumnByIndex(e,t,i){let n=this.beans.colModel.getCols();if(!n)return;let o=n[e];this.moveColumns([o],t,i)}moveColumns(e,t,i,n=!0){let{colModel:o,colAnimation:s,visibleCols:r,eventSvc:a}=this.beans,l=o.getCols();if(!l)return;if(t>l.length-e.length){I(30,{toIndex:t});return}s?.start();let d=o.getColsForKeys(e);this.doesMovePassRules(d,t)&&(kE(o.getCols(),d,t),r.refresh(i),a.dispatchEvent({type:"columnMoved",columns:d,column:d.length===1?d[0]:null,toIndex:t,finished:n,source:i})),s?.finish()}doesMovePassRules(e,t){let i=this.getProposedColumnOrder(e,t);return this.doesOrderPassRules(i)}doesOrderPassRules(e){let{colModel:t,gos:i}=this.beans;return!(!I6(e,t.getColTree())||!(o=>{let s=d=>d?d==="left"||d===!0?-1:1:0,r=i.get("enableRtl"),a=r?1:-1,l=!0;for(let d of o){let c=s(d.getColDef().lockPosition);r?c>a&&(l=!1):c<a&&(l=!1),a=c}return l})(e))}getProposedColumnOrder(e,t){let n=this.beans.colModel.getCols().slice();return kE(n,e,t),n}createBodyDropTarget(e,t){return new dz(e,t)}moveHeader(e,t,i,n,o){let{ctrlsSvc:s,gos:r,colModel:a,visibleCols:l,focusSvc:d}=this.beans,c=t.getBoundingClientRect(),u=c.left,h=pt(i),p=h?c.width:i.getActualWidth(),g=e==="left"!==r.get("enableRtl"),f=WC({x:g?u-20:u+p+20,pinned:n,fromKeyboard:!0,gos:r,ctrlsSvc:s}),m=d.focusedHeader;V4({allMovingColumns:h?i.getLeafColumns():[i],isFromHeader:!0,fromLeft:e==="right",xPosition:f,pinned:n,fromEnter:!1,fakeEvent:!1,gos:r,colModel:a,colMoves:this,visibleCols:l,finished:!0});let C;if(h){let v=i.getDisplayedLeafColumns();C=g?v[0]:Ue(v)}else C=i;if(s.getScrollFeature().ensureColumnVisible(C,"auto"),(!o.isAlive()||r.get("ensureDomOrder"))&&m){let v;if(h){let w=i.getGroupId(),y=i.getLeafColumns();if(!y.length)return;let S=y[0].getParent();if(!S)return;v=uz(S,w)}else v=i;v&&d.focusHeaderPosition({headerPosition:_(b({},m),{column:v})})}}setDragSourceForHeader(e,t,i){let{gos:n,colModel:o,dragAndDrop:s,visibleCols:r}=this.beans,a=!n.get("suppressDragLeaveHidesColumns"),l=pt(t),d=l?t.getProvidedColumnGroup().getLeafColumns():[t],u={type:1,eElement:e,getDefaultIconName:()=>a?"hide":"notAllowed",getDragItem:l?()=>pz(t,r.allCols):()=>hz(t),dragItemName:i,onDragStarted:()=>{a=!n.get("suppressDragLeaveHidesColumns"),lC(d,!0)},onDragStopped:()=>lC(d,!1),onDragCancelled:()=>lC(d,!1),onGridEnter:h=>{if(a){let{columns:p=[],visibleState:g}=h??{},f=l?C=>!g||g[C.getColId()]:()=>!0,m=p.filter(C=>!C.getColDef().lockVisible&&f(C));o.setColsVisible(m,!0,"uiColumnMoved")}},onGridExit:h=>{if(a){let p=h?.columns?.filter(g=>!g.getColDef().lockVisible)||[];o.setColsVisible(p,!1,"uiColumnMoved")}}};return s.addDragSource(u,!0),u}};function uz(e,t){for(;e;){if(e.getGroupId()===t)return e;e=e.getParent()}}function hz(e){let t={};return t[e.getId()]=e.isVisible(),{columns:[e],visibleState:t,containerType:e.pinned}}function pz(e,t){let i=e.getProvidedColumnGroup().getLeafColumns(),n={};for(let a of i)n[a.getId()]=a.isVisible();let o=[];for(let a of t)i.indexOf(a)>=0&&(o.push(a),Yi(i,a));for(let a of i)o.push(a);let s=[],r=e.getLeafColumns();for(let a of o)r.indexOf(a)!==-1&&s.push(a);return{columns:o,columnsInSplit:s,visibleState:n,containerType:s[0]?.pinned}}var gz={moduleName:"ColumnMove",version:z,beans:[cz,KV],apiFunctions:{moveColumnByIndex:YV,moveColumns:XV},dependsOn:[H4],css:[jV]},fz=class extends D{constructor(){super(...arguments),this.beanName="autoWidthCalc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.centerRowContainerCtrl=e.center})}getPreferredWidthForColumn(e,t){let i=this.getHeaderCellForColumn(e);if(!i)return-1;let n=this.beans.rowRenderer.getAllCellsNotSpanningForColumn(e);return t||n.push(i),this.getPreferredWidthForElements(n)}getPreferredWidthForColumnGroup(e){let t=this.getHeaderCellForColumn(e);return t?this.getPreferredWidthForElements([t]):-1}getPreferredWidthForElements(e,t){let i=document.createElement("form");i.style.position="fixed";let n=this.centerRowContainerCtrl.eContainer;for(let s of e)this.cloneItemIntoDummy(s,i);n.appendChild(i);let o=i.offsetWidth;return i.remove(),t=t??this.gos.get("autoSizePadding"),o+t}getHeaderCellForColumn(e){let t=null;for(let i of this.beans.ctrlsSvc.getHeaderRowContainerCtrls()){let n=i.getHtmlElementForColumnHeader(e);n!=null&&(t=n)}return t}cloneItemIntoDummy(e,t){let i=e.cloneNode(!0);i.style.width="",i.style.position="static",i.style.left="";let n=document.createElement("div"),o=n.classList;["ag-header-cell","ag-header-group-cell"].some(a=>i.classList.contains(a))?(o.add("ag-header","ag-header-row"),n.style.position="static"):o.add("ag-row");let r=e.parentElement;for(;r;){if(["ag-header-row","ag-row"].some(l=>r.classList.contains(l))){for(let l=0;l<r.classList.length;l++){let d=r.classList[l];d!="ag-row-position-absolute"&&o.add(d)}break}r=r.parentElement}n.appendChild(i),t.appendChild(n)}},z4={moduleName:"AutoWidth",version:z,beans:[fz]};function mz(e,t,i=!0,n="api"){e.colResize?.setColumnWidths(t,!1,i,n)}var Cz=class extends D{constructor(e,t,i,n){super(),this.comp=e,this.eResize=t,this.pinned=i,this.columnGroup=n}postConstruct(){if(!this.columnGroup.isResizable()){this.comp.setResizableDisplayed(!1);return}let{horizontalResizeSvc:e,gos:t,colAutosize:i}=this.beans,n=e.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});this.addDestroyFunc(n),!t.get("suppressAutoSize")&&i&&this.addDestroyFunc(i.addColumnGroupResize(this.eResize,this.columnGroup,()=>this.resizeLeafColumnsToFit("uiColumnResized")))}onResizeStart(e){let{columnsToResize:t,resizeStartWidth:i,resizeRatios:n,groupAfterColumns:o,groupAfterStartWidth:s,groupAfterRatios:r}=this.getInitialValues(e);this.resizeCols=t,this.resizeStartWidth=i,this.resizeRatios=n,this.resizeTakeFromCols=o,this.resizeTakeFromStartWidth=s,this.resizeTakeFromRatios=r,this.toggleColumnResizing(!0)}onResizing(e,t,i="uiColumnResized"){let n=this.normaliseDragChange(t),o=this.resizeStartWidth+n;this.resizeColumnsFromLocalValues(o,i,e)}getInitialValues(e){let t=l=>l.reduce((d,c)=>d+c.getActualWidth(),0),i=(l,d)=>l.map(c=>c.getActualWidth()/d),n=this.getColumnsToResize(),o=t(n),s=i(n,o),r={columnsToResize:n,resizeStartWidth:o,resizeRatios:s},a=null;if(e&&(a=this.beans.colGroupSvc?.getGroupAtDirection(this.columnGroup,"After")??null),a){let l=a.getDisplayedLeafColumns(),d=r.groupAfterColumns=l.filter(u=>u.isResizable()),c=r.groupAfterStartWidth=t(d);r.groupAfterRatios=i(d,c)}else r.groupAfterColumns=void 0,r.groupAfterStartWidth=void 0,r.groupAfterRatios=void 0;return r}resizeLeafColumnsToFit(e){let t=this.beans.autoWidthCalc.getPreferredWidthForColumnGroup(this.columnGroup),i=this.getInitialValues();t>i.resizeStartWidth&&this.resizeColumns(i,t,e,!0)}resizeColumnsFromLocalValues(e,t,i=!0){if(!this.resizeCols||!this.resizeRatios)return;let n={columnsToResize:this.resizeCols,resizeStartWidth:this.resizeStartWidth,resizeRatios:this.resizeRatios,groupAfterColumns:this.resizeTakeFromCols,groupAfterStartWidth:this.resizeTakeFromStartWidth,groupAfterRatios:this.resizeTakeFromRatios};this.resizeColumns(n,e,t,i)}resizeColumns(e,t,i,n=!0){let{columnsToResize:o,resizeStartWidth:s,resizeRatios:r,groupAfterColumns:a,groupAfterStartWidth:l,groupAfterRatios:d}=e,c=[];if(c.push({columns:o,ratios:r,width:t}),a){let u=t-s;c.push({columns:a,ratios:d,width:l-u})}this.beans.colResize?.resizeColumnSets({resizeSets:c,finished:n,source:i}),n&&this.toggleColumnResizing(!1)}toggleColumnResizing(e){this.comp.toggleCss("ag-column-resizing",e)}getColumnsToResize(){return this.columnGroup.getDisplayedLeafColumns().filter(t=>t.isResizable())}normaliseDragChange(e){let t=e;return this.gos.get("enableRtl")?this.pinned!=="left"&&(t*=-1):this.pinned==="right"&&(t*=-1),t}destroy(){super.destroy(),this.resizeCols=void 0,this.resizeRatios=void 0,this.resizeTakeFromCols=void 0,this.resizeTakeFromRatios=void 0}},vz=class extends D{constructor(e,t,i,n,o){super(),this.pinned=e,this.column=t,this.eResize=i,this.comp=n,this.ctrl=o}postConstruct(){let e=[],t,i,n=()=>{if(Je(this.eResize,t),!t)return;let{horizontalResizeSvc:r,colAutosize:a}=this.beans,l=r.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});e.push(l),i&&a&&e.push(a.addColumnAutosizeListeners(this.eResize,this.column))},o=()=>{for(let r of e)r();e.length=0},s=()=>{let r=this.column.isResizable(),a=!this.gos.get("suppressAutoSize")&&!this.column.getColDef().suppressAutoSize;(r!==t||a!==i)&&(t=r,i=a,o(),n())};s(),this.addDestroyFunc(o),this.ctrl.setRefreshFunction("resize",s)}onResizing(e,t){let{column:i,lastResizeAmount:n,resizeStartWidth:o,beans:s}=this,r=this.normaliseResizeAmount(t),a=o+r,l=[{key:i,newWidth:a}],{pinnedCols:d,ctrlsSvc:c,colResize:u}=s;if(this.column.getPinned()){let h=d?.leftWidth??0,p=d?.rightWidth??0,g=rd(c.getGridBodyCtrl().eBodyViewport)-50;if(h+p+(r-n)>g)return}this.lastResizeAmount=r,u?.setColumnWidths(l,this.resizeWithShiftKey,e,"uiColumnResized"),e&&this.toggleColumnResizing(!1)}onResizeStart(e){this.resizeStartWidth=this.column.getActualWidth(),this.lastResizeAmount=0,this.resizeWithShiftKey=e,this.toggleColumnResizing(!0)}toggleColumnResizing(e){this.column.resizing=e,this.comp.toggleCss("ag-column-resizing",e)}normaliseResizeAmount(e){let t=e,i=this.pinned!=="left",n=this.pinned==="right";return this.gos.get("enableRtl")?i&&(t*=-1):n&&(t*=-1),t}},wz=class extends D{constructor(){super(...arguments),this.beanName="colResize"}setColumnWidths(e,t,i,n){let o=[],{colModel:s,gos:r,visibleCols:a}=this.beans;for(let l of e){let d=s.getColDefCol(l.key)||s.getCol(l.key);if(!d)continue;if(o.push({width:l.newWidth,ratios:[1],columns:[d]}),r.get("colResizeDefault")==="shift"&&(t=!t),t){let u=a.getColAfter(d);if(!u)continue;let h=d.getActualWidth()-l.newWidth,p=u.getActualWidth()+h;o.push({width:p,ratios:[1],columns:[u]})}}o.length!==0&&this.resizeColumnSets({resizeSets:o,finished:i,source:n})}resizeColumnSets(e){let{resizeSets:t,finished:i,source:n}=e;if(!(!t||t.every(c=>bz(c)))){if(i){let c=t&&t.length>0?t[0].columns:null;va(this.eventSvc,c,i,n)}return}let s=[],r=[];for(let c of t){let{width:u,columns:h,ratios:p}=c,g={},f={};for(let v of h)r.push(v);let m=!0,C=0;for(;m;){if(C++,C>1e3){Ge(31);break}m=!1;let v=[],w=0,y=u;h.forEach((x,E)=>{if(f[x.getId()])y-=g[x.getId()];else{v.push(x);let L=p[E];w+=L}});let S=1/w;v.forEach((x,E)=>{let T=E===v.length-1,L;T?L=y:(L=Math.round(p[E]*u*S),y-=L);let O=x.getMinWidth(),W=x.getMaxWidth();L<O?(L=O,f[x.getId()]=!0,m=!0):W>0&&L>W&&(L=W,f[x.getId()]=!0,m=!0),g[x.getId()]=L})}for(let v of h){let w=g[v.getId()];v.getActualWidth()!==w&&(v.setActualWidth(w,n),s.push(v))}}let a=s.length>0,l=[];if(a){let{colFlex:c,visibleCols:u,colViewport:h}=this.beans;l=c?.refreshFlexedColumns({resizingCols:r,skipSetLeft:!0})??[],u.setLeftValues(n),u.updateBodyWidths(),h.checkViewportColumns()}let d=r.concat(l);(a||i)&&va(this.eventSvc,d,i,n,l)}resizeHeader(e,t,i){if(!e.isResizable())return;let n=e.getActualWidth(),o=e.getMinWidth(),s=e.getMaxWidth(),r=Math.min(Math.max(n+t,o),s);this.setColumnWidths([{key:e,newWidth:r}],i,!0,"uiColumnResized")}createResizeFeature(e,t,i,n,o){return new vz(e,t,i,n,o)}createGroupResizeFeature(e,t,i,n){return new Cz(e,t,i,n)}};function bz(e){let{columns:t,width:i}=e,n=0,o=0,s=!0;for(let l of t){let d=l.getMinWidth();n+=d||0;let c=l.getMaxWidth();c>0?o+=c:s=!1}let r=i>=n,a=!s||i<=o;return r&&a}var yz={moduleName:"ColumnResize",version:z,beans:[wz],apiFunctions:{setColumnWidths:mz},dependsOn:[$V,z4]},Sz=class extends D{constructor(e,t){super(),this.removeChildListenersFuncs=[],this.columnGroup=t,this.comp=e}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListeners(this.columnGroup,{displayedChildrenChanged:this.onDisplayedChildrenChanged.bind(this)}),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();let e=this.onWidthChanged.bind(this);for(let t of this.columnGroup.getLeafColumns())t.__addEventListener("widthChanged",e),t.__addEventListener("visibleChanged",e),this.removeChildListenersFuncs.push(()=>{t.__removeEventListener("widthChanged",e),t.__removeEventListener("visibleChanged",e)})}removeListenersOnChildrenColumns(){for(let e of this.removeChildListenersFuncs)e();this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){let e=this.columnGroup.getActualWidth();this.comp.setWidth(`${e}px`),this.comp.toggleCss("ag-hidden",e===0)}},xz=class extends Tv{constructor(){super(...arguments),this.onSuppressColMoveChange=()=>{!this.isAlive()||this.isSuppressMoving()?this.removeDragSource():this.dragSource||this.setDragSource(this.eGui)}}wireComp(e,t,i,n,o){let{column:s,beans:r}=this,{context:a,colNames:l,colHover:d,rangeSvc:c,colResize:u}=r;this.comp=e,o=vd(this,a,o),this.setGui(t,o),this.displayName=l.getDisplayNameForColumnGroup(s,"header"),this.refreshHeaderStyles(),this.addClasses(),this.setupMovingCss(o),this.setupExpandable(o),this.setupTooltip(),this.setupAutoHeight({wrapperElement:n,compBean:o}),this.setupUserComp(),this.addHeaderMouseListeners(o),this.addManagedPropertyListener("groupHeaderHeight",this.refreshMaxHeaderHeight.bind(this)),this.refreshMaxHeaderHeight();let h=this.rowCtrl.pinned,p=s.getProvidedColumnGroup().getLeafColumns();d?.createHoverFeature(o,p,t),c?.createRangeHighlightFeature(o,s,e),o.createManagedBean(new Fv(s,t,r)),o.createManagedBean(new Sz(e,s)),u?this.resizeFeature=o.createManagedBean(u.createGroupResizeFeature(e,i,h,s)):e.setResizableDisplayed(!1),o.createManagedBean(new Ea(t,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)})),this.addHighlightListeners(o,p),o.addManagedPropertyListener("suppressMovableColumns",this.onSuppressColMoveChange),this.addResizeAndMoveKeyboardListeners(o),o.addDestroyFunc(()=>this.clearComponent())}getHeaderClassParams(){let{column:e,beans:t}=this,i=e.getDefinition();return te(t.gos,{colDef:i,columnGroup:e,floatingFilter:!1})}refreshMaxHeaderHeight(){let{gos:e,comp:t}=this,i=e.get("groupHeaderHeight");i!=null?i===0?t.setHeaderWrapperHidden(!0):t.setHeaderWrapperMaxHeight(i):(t.setHeaderWrapperHidden(!1),t.setHeaderWrapperMaxHeight(null))}addHighlightListeners(e,t){if(this.beans.gos.get("suppressMoveWhenColumnDragging"))for(let i of t)e.addManagedListeners(i,{headerHighlightChanged:this.onLeafColumnHighlightChanged.bind(this,i)})}onLeafColumnHighlightChanged(e){let t=this.column.getDisplayedLeafColumns(),i=t[0]===e,n=Ue(t)===e;if(!i&&!n)return;let o=e.getHighlighted(),s=!!this.rowCtrl.getHeaderCellCtrls().find(l=>l.column.isMoving()),r=!1,a=!1;if(s){let l=this.beans.gos.get("enableRtl"),d=o===1,c=o===0;i&&(l?a=d:r=c),n&&(l?r=c:a=d)}this.comp.toggleCss("ag-header-highlight-before",r),this.comp.toggleCss("ag-header-highlight-after",a)}resizeHeader(e,t){let{resizeFeature:i}=this;if(!i)return;let n=i.getInitialValues(t);i.resizeColumns(n,n.resizeStartWidth+e,"uiColumnResized",!0)}resizeLeafColumnsToFit(e){this.resizeFeature?.resizeLeafColumnsToFit(e)}setupUserComp(){let{colGroupSvc:e,userCompFactory:t,gos:i,enterpriseMenuFactory:n}=this.beans,o=this.column,s=o.getProvidedColumnGroup(),r=te(i,{displayName:this.displayName,columnGroup:o,setExpanded:l=>{e.setColumnGroupOpened(s,l,"gridInitializing")},setTooltip:(l,d)=>{i.assertModuleRegistered("Tooltip",3),this.setupTooltip(l,d)},showColumnMenu:(l,d)=>n?.showMenuAfterButtonClick(s,l,"columnMenu",d),showColumnMenuAfterMouseClick:(l,d)=>n?.showMenuAfterMouseEvent(s,l,"columnMenu",d),eGridHeader:this.eGui}),a=pN(t,r);a&&this.comp.setUserCompDetails(a)}addHeaderMouseListeners(e){let t=o=>this.handleMouseOverChange(o.type==="mouseenter"),i=()=>this.dispatchColumnMouseEvent("columnHeaderClicked",this.column.getProvidedColumnGroup()),n=o=>this.handleContextMenuMouseEvent(o,void 0,this.column.getProvidedColumnGroup());e.addManagedListeners(this.eGui,{mouseenter:t,mouseleave:t,click:i,contextmenu:n})}handleMouseOverChange(e){this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column.getProvidedColumnGroup()})}setupTooltip(e,t){this.tooltipFeature=this.beans.tooltipSvc?.setupHeaderGroupTooltip(this.tooltipFeature,this,e,t)}setupExpandable(e){let t=this.column.getProvidedColumnGroup();this.refreshExpanded();let i=this.refreshExpanded.bind(this);e.addManagedListeners(t,{expandedChanged:i,expandableChanged:i})}refreshExpanded(){let{column:e}=this;this.expandable=e.isExpandable();let t=e.isExpanded();this.expandable?this.comp.setAriaExpanded(t?"true":"false"):this.comp.setAriaExpanded(void 0),this.refreshHeaderStyles()}addClasses(){let{column:e}=this,t=e.getColGroupDef(),i=R4(t,this.gos,null,e);e.isPadding()?(i.push("ag-header-group-cell-no-group"),e.getLeafColumns().every(o=>o.isSpanHeaderHeight())&&i.push("ag-header-span-height")):(i.push("ag-header-group-cell-with-group"),t?.wrapHeaderText&&i.push("ag-header-cell-wrap-text"));for(let n of i)this.comp.toggleCss(n,!0)}setupMovingCss(e){let{column:t}=this,n=t.getProvidedColumnGroup().getLeafColumns(),o=()=>this.comp.toggleCss("ag-header-cell-moving",t.isMoving());for(let s of n)e.addManagedListeners(s,{movingChanged:o});o()}onFocusIn(e){this.eGui.contains(e.relatedTarget)||this.focusThis()}handleKeyDown(e){super.handleKeyDown(e);let t=this.getWrapperHasFocus();if(!(!this.expandable||!t)&&e.key===R.ENTER){let i=this.column,n=!i.isExpanded();this.beans.colGroupSvc.setColumnGroupOpened(i.getProvidedColumnGroup(),n,"uiColumnExpanded")}}setDragSource(e){!this.isAlive()||this.isSuppressMoving()||(this.removeDragSource(),e&&(this.dragSource=this.beans.colMoves?.setDragSourceForHeader(e,this.column,this.displayName)??null))}isSuppressMoving(){return this.gos.get("suppressMovableColumns")||this.column.getLeafColumns().some(e=>e.getColDef().suppressMovable||e.getColDef().lockPosition)}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function Ez(e,t,i){e.colGroupSvc?.setColumnGroupOpened(t,i,"api")}function Rz(e,t,i){return e.colGroupSvc?.getColumnGroup(t,i)??null}function Pz(e,t){return e.colGroupSvc?.getProvidedColGroup(t)??null}function Mz(e,t,i){return e.colNames.getDisplayNameForColumnGroup(t,i)||""}function kz(e){return e.colGroupSvc?.getColumnGroupState()??[]}function Dz(e,t){e.colGroupSvc?.setColumnGroupState(t,"api")}function Fz(e){e.colGroupSvc?.resetColumnGroupState("api")}function Tz(e){return e.visibleCols.treeLeft}function Az(e){return e.visibleCols.treeCenter}function Iz(e){return e.visibleCols.treeRight}function Lz(e){return e.visibleCols.getAllTrees()}function _z(e,t){for(let i=0;i<t.length;i++){let n=e.indexOf(t[i]);n>=0&&(e[n]=e[e.length-1],e.pop())}}var Oz=class extends D{constructor(){super(...arguments),this.beanName="visibleCols",this.colsAndGroupsMap={},this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.headerGroupRowCount=0,this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.isBodyWidthDirty=!0}refresh(e,t=!1){let{colFlex:i,colModel:n,colGroupSvc:o,colViewport:s,selectionColSvc:r}=this.beans;t||this.buildTrees(n,o),o?.updateOpenClosedVisibility(),this.leftCols=dC(this.treeLeft),this.centerCols=dC(this.treeCenter),this.rightCols=dC(this.treeRight),r?.refreshVisibility(this.leftCols,this.centerCols,this.rightCols),this.joinColsAriaOrder(n),this.joinCols(),this.headerGroupRowCount=this.getHeaderRowCount(),this.setLeftValues(e),this.autoHeightCols=this.allCols.filter(a=>a.isAutoHeight()),i?.refreshFlexedColumns(),this.updateBodyWidths(),this.setFirstRightAndLastLeftPinned(n,this.leftCols,this.rightCols,e),s.checkViewportColumns(!1),this.eventSvc.dispatchEvent({type:"displayedColumnsChanged",source:e})}getHeaderRowCount(){if(!this.gos.get("hidePaddedHeaderRows"))return this.beans.colModel.cols.treeDepth;let e=0;for(let t of this.allCols){let i=t.getParent();for(;i;){if(!i.isPadding()){let n=i.getProvidedColumnGroup().getLevel()+1;n>e&&(e=n);break}i=i.getParent()}}return e}updateBodyWidths(){let e=oo(this.centerCols),t=oo(this.leftCols),i=oo(this.rightCols);this.isBodyWidthDirty=this.bodyWidth!==e,(this.bodyWidth!==e||this.leftWidth!==t||this.rightWidth!==i)&&(this.bodyWidth=e,this.leftWidth=t,this.rightWidth=i,this.eventSvc.dispatchEvent({type:"columnContainerWidthChanged"}),this.eventSvc.dispatchEvent({type:"displayedColumnsWidthChanged"}))}setLeftValues(e){this.setLeftValuesOfCols(e),this.setLeftValuesOfGroups()}setFirstRightAndLastLeftPinned(e,t,i,n){let o,s;this.gos.get("enableRtl")?(o=t?t[0]:null,s=i?Ue(i):null):(o=t?Ue(t):null,s=i?i[0]:null);for(let r of e.getCols())r.setLastLeftPinned(r===o,n),r.setFirstRightPinned(r===s,n)}buildTrees(e,t){let i=e.getColsToShow(),n=i.filter(l=>l.getPinned()=="left"),o=i.filter(l=>l.getPinned()=="right"),s=i.filter(l=>l.getPinned()!="left"&&l.getPinned()!="right"),r=new B6,a=l=>t?t.createColumnGroups(l):l.columns;this.treeLeft=a({columns:n,idCreator:r,pinned:"left",oldDisplayedGroups:this.treeLeft}),this.treeRight=a({columns:o,idCreator:r,pinned:"right",oldDisplayedGroups:this.treeRight}),this.treeCenter=a({columns:s,idCreator:r,pinned:null,oldDisplayedGroups:this.treeCenter}),this.updateColsAndGroupsMap()}clear(){this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.ariaOrderColumns=[]}joinColsAriaOrder(e){let t=e.getCols(),i=[],n=[],o=[];for(let s of t){let r=s.getPinned();r?r===!0||r==="left"?i.push(s):o.push(s):n.push(s)}this.ariaOrderColumns=i.concat(n).concat(o)}getAriaColIndex(e){let t;return pt(e)?t=e.getLeafColumns()[0]:t=e,this.ariaOrderColumns.indexOf(t)+1}setLeftValuesOfGroups(){for(let e of[this.treeLeft,this.treeRight,this.treeCenter])for(let t of e)pt(t)&&t.checkLeft()}setLeftValuesOfCols(e){let{colModel:t}=this.beans;if(!t.getColDefCols())return;let n=t.getCols().slice(0),o=this.gos.get("enableRtl");for(let s of[this.leftCols,this.rightCols,this.centerCols]){if(o){let r=oo(s);for(let a of s)r-=a.getActualWidth(),a.setLeft(r,e)}else{let r=0;for(let a of s)a.setLeft(r,e),r+=a.getActualWidth()}_z(n,s)}for(let s of n)s.setLeft(null,e)}joinCols(){this.gos.get("enableRtl")?this.allCols=this.rightCols.concat(this.centerCols).concat(this.leftCols):this.allCols=this.leftCols.concat(this.centerCols).concat(this.rightCols)}getAllTrees(){return this.treeLeft&&this.treeRight&&this.treeCenter?this.treeLeft.concat(this.treeCenter).concat(this.treeRight):null}isColDisplayed(e){return this.allCols.indexOf(e)>=0}getLeftColsForRow(e){let{leftCols:t,beans:{colModel:i}}=this;return i.colSpanActive?this.getColsForRow(e,t):t}getRightColsForRow(e){let{rightCols:t,beans:{colModel:i}}=this;return i.colSpanActive?this.getColsForRow(e,t):t}getColsForRow(e,t,i,n){let o=[],s=null;for(let r=0;r<t.length;r++){let a=t[r],l=t.length-r,d=Math.min(a.getColSpan(e),l),c=[a];if(d>1){let h=d-1;for(let p=1;p<=h;p++)c.push(t[r+p]);r+=h}let u;if(i){u=!1;for(let h of c)i(h)&&(u=!0)}else u=!0;u&&(o.length===0&&s&&(n&&n(a))&&o.push(s),o.push(a)),s=a}return o}getContainerWidth(e){switch(e){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}getColBefore(e){let t=this.allCols,i=t.indexOf(e);return i>0?t[i-1]:null}isPinningLeft(){return this.leftCols.length>0}isPinningRight(){return this.rightCols.length>0}updateColsAndGroupsMap(){this.colsAndGroupsMap={};let e=t=>{this.colsAndGroupsMap[t.getUniqueId()]=t};Us(this.treeCenter,!1,e),Us(this.treeLeft,!1,e),Us(this.treeRight,!1,e)}isVisible(e){return this.colsAndGroupsMap[e.getUniqueId()]===e}getFirstColumn(){let e=this.gos.get("enableRtl"),t=["leftCols","centerCols","rightCols"];e&&t.reverse();for(let i=0;i<t.length;i++){let n=this[t[i]];if(n.length)return e?Ue(n):n[0]}return null}getColAfter(e){let t=this.allCols,i=t.indexOf(e);return i<t.length-1?t[i+1]:null}getColsLeftWidth(){return oo(this.leftCols)}getDisplayedColumnsRightWidth(){return oo(this.rightCols)}isColAtEdge(e,t){let i=this.allCols;if(!i.length)return!1;let n=t==="first",o;if(pt(e)){let s=e.getDisplayedLeafColumns();if(!s.length)return!1;o=n?s[0]:Ue(s)}else o=e;return(n?i[0]:Ue(i))===o}};function Us(e,t,i){if(e)for(let n=0;n<e.length;n++){let o=e[n];if(pt(o)){let s=t?o.getDisplayedChildren():o.getChildren();Us(s,t,i)}i(o)}}function dC(e){let t=[];return Us(e,!0,i=>{Xo(i)&&t.push(i)}),t}var Nz=class extends D{constructor(){super(...arguments),this.beanName="colGroupSvc"}getColumnGroupState(){let e=[],t=this.beans.colModel.getColTree();return lo(null,t,i=>{Yt(i)&&e.push({groupId:i.getGroupId(),open:i.isExpanded()})}),e}resetColumnGroupState(e){let t=this.beans.colModel.getColDefColTree();if(!t)return;let i=[];lo(null,t,n=>{if(Yt(n)){let o=n.getColGroupDef(),s={groupId:n.getGroupId(),open:o?o.openByDefault:void 0};i.push(s)}}),this.setColumnGroupState(i,e)}setColumnGroupState(e,t){let{colModel:i,colAnimation:n,visibleCols:o,eventSvc:s}=this.beans;if(!i.getColTree().length)return;n?.start();let a=[];for(let l of e){let d=l.groupId,c=l.open,u=this.getProvidedColGroup(d);u&&u.isExpanded()!==c&&(u.setExpanded(c),a.push(u))}o.refresh(t,!0),a.length&&s.dispatchEvent({type:"columnGroupOpened",columnGroup:a.length===1?a[0]:void 0,columnGroups:a}),n?.finish()}setColumnGroupOpened(e,t,i){let n;Yt(e)?n=e.getId():n=e||"",this.setColumnGroupState([{groupId:n,open:t}],i)}getProvidedColGroup(e){let t=null;return lo(null,this.beans.colModel.getColTree(),i=>{Yt(i)&&i.getId()===e&&(t=i)}),t}getGroupAtDirection(e,t){let i=e.getProvidedColumnGroup().getLevel()+e.getPaddingLevel(),n=e.getDisplayedLeafColumns(),o=t==="After"?Ue(n):n[0],s=`getCol${t}`;for(;;){let r=this.beans.visibleCols[s](o);if(!r)return null;let a=this.getColGroupAtLevel(r,i);if(a!==e)return a}}getColGroupAtLevel(e,t){let i=e.getParent(),n,o;for(;n=i.getProvidedColumnGroup().getLevel(),o=i.getPaddingLevel(),!(n+o<=t);)i=i.getParent();return i}updateOpenClosedVisibility(){let e=this.beans.visibleCols.getAllTrees();Us(e,!1,t=>{pt(t)&&t.calculateDisplayedColumns()})}getColumnGroup(e,t){if(!e)return null;if(pt(e))return e;let i=this.beans.visibleCols.getAllTrees(),n=typeof t=="number",o=null;return Us(i,!1,s=>{if(pt(s)){let r=s,a;n?a=e===r.getGroupId()&&t===r.getPartId():a=e===r.getGroupId(),a&&(o=r)}}),o}createColumnGroups(e){let{columns:t,idCreator:i,pinned:n,oldDisplayedGroups:o,isStandaloneStructure:s}=e,r=this.mapOldGroupsById(o),a=[],l=t;for(;l.length;){let d=l;l=[];let c=0,u=h=>{let p=c;c=h;let g=d[p],m=(pt(g)?g.getProvidedColumnGroup():g).getOriginalParent();if(m==null){for(let v=p;v<h;v++)a.push(d[v]);return}let C=this.createColumnGroup(m,i,r,n,s);for(let v=p;v<h;v++)C.addChild(d[v]);l.push(C)};for(let h=1;h<d.length;h++){let p=d[h],f=(pt(p)?p.getProvidedColumnGroup():p).getOriginalParent(),m=d[c],v=(pt(m)?m.getProvidedColumnGroup():m).getOriginalParent();f!==v&&u(h)}c<d.length&&u(d.length)}return s||this.setupParentsIntoCols(a,null),a}createProvidedColumnGroup(e,t,i,n,o,s,r){let a=o.getUniqueKey(t.groupId||null,null),l=ME(this.beans,t,a),d=new Jh(l,a,!1,i);this.createBean(d);let c=this.findExistingGroup(t,s);c&&s.splice(c.idx,1);let u=c?.group;u&&d.setExpanded(u.isExpanded());let h=F6(this.beans,l.children,i+1,e,n,o,s,r);return d.setChildren(h),d}balanceColumnTree(e,t,i,n){let o=[];for(let s=0;s<e.length;s++){let r=e[s];if(Yt(r)){let a=r,l=this.balanceColumnTree(a.getChildren(),t+1,i,n);a.setChildren(l),o.push(a)}else{let a,l;for(let d=t;d<i;d++){let c=n.getUniqueKey(null,null),u=ME(this.beans,null,c),h=new Jh(u,c,!0,d);this.createBean(h),l&&l.setChildren([h]),l=h,a||(a=l)}if(a&&l)if(o.push(a),e.some(c=>Yt(c))){l.setChildren([r]);continue}else{l.setChildren(e);break}o.push(r)}}return o}findDepth(e){let t=0,i=e;for(;i?.[0]&&Yt(i[0]);)t++,i=i[0].getChildren();return t}findMaxDepth(e,t){let i=t;for(let n=0;n<e.length;n++){let o=e[n];if(Yt(o)){let s=o,r=this.findMaxDepth(s.getChildren(),t+1);i<r&&(i=r)}}return i}balanceTreeForAutoCols(e,t){let i=[];for(let n of e){let o=n;for(let s=t-1;s>=0;s--){let r=new Jh(null,`FAKE_PATH_${n.getId()}}_${s}`,!0,s);this.createBean(r),r.setChildren([o]),o.originalParent=r,o=r}t===0&&(n.originalParent=null),i.push(o)}return i}findExistingGroup(e,t){if(e.groupId!=null)for(let n=0;n<t.length;n++){let o=t[n];if(o.getColGroupDef()&&o.getId()===e.groupId)return{idx:n,group:o}}}createColumnGroup(e,t,i,n,o){let s=e.getGroupId(),r=t.getInstanceIdForKey(s),a=d4(s,r),l=i[a];return l&&l.getProvidedColumnGroup()!==e&&(l=null),q(l)?l.reset():(l=new hd(e,s,r,n),o||this.createBean(l)),l}mapOldGroupsById(e){let t={},i=n=>{for(let o of n)if(pt(o)){let s=o;t[o.getUniqueId()]=s,i(s.getChildren())}};return e&&i(e),t}setupParentsIntoCols(e,t){for(let i of e??[])if(i.parent!==t&&(this.beans.colViewport.colsWithinViewportHash=""),i.parent=t,pt(i)){let n=i;this.setupParentsIntoCols(n.getChildren(),n)}}},Bz={moduleName:"ColumnGroup",version:z,dynamicBeans:{headerGroupCellCtrl:xz},beans:[Nz],apiFunctions:{getAllDisplayedColumnGroups:Lz,getCenterDisplayedColumnGroups:Az,getColumnGroup:Rz,getColumnGroupState:kz,getDisplayNameForColumnGroup:Mz,getLeftDisplayedColumnGroups:Tz,getProvidedColumnGroup:Pz,getRightDisplayedColumnGroups:Iz,resetColumnGroupState:Fz,setColumnGroupOpened:Ez,setColumnGroupState:Dz}},Hz={tag:"div",cls:"ag-skeleton-container"},Gz=class extends Oe{constructor(){super(Hz)}init(e){let t=`ag-cell-skeleton-renderer-${this.getCompId()}`;this.getGui().setAttribute("id",t),this.addDestroyFunc(()=>od(e.eParentOfValue)),od(e.eParentOfValue,t),e.deferRender?this.setupLoading(e):e.node.failedLoad?this.setupFailed():this.setupLoading(e)}setupFailed(){let e=this.getLocaleTextFunc();this.getGui().textContent=e("loadingError","ERR");let t=e("ariaSkeletonCellLoadingFailed","Row failed to load");ma(this.getGui(),t)}setupLoading(e){let t=ft({tag:"div",cls:"ag-skeleton-effect"}),i=e.node.rowIndex;if(i!=null){let s=75+25*(i%2===0?Math.sin(i):Math.cos(i));t.style.width=`${s}%`}this.getGui().appendChild(t);let n=this.getLocaleTextFunc(),o=e.deferRender?n("ariaDeferSkeletonCellLoading","Cell is loading"):n("ariaSkeletonCellLoading","Row data is loading");ma(this.getGui(),o)}refresh(e){return!1}},Vz={moduleName:"CheckboxCellRenderer",version:z,userComponents:{agCheckboxCellRenderer:EG}},zz={moduleName:"SkeletonCellRenderer",version:z,userComponents:{agSkeletonCellRenderer:Gz}};function Wz(e,t){let i=e.colModel.getColDefCol(t);return i?i.getColDef():null}function Uz(e){return e.colModel.getColumnDefs(!0)}function qz(e,t,i){return e.colNames.getDisplayNameForColumn(t,i)||""}function $z(e,t){return e.colModel.getColDefCol(t)}function jz(e){return e.colModel.getColDefCols()}function Kz(e,t){return Ki(e,t,"api")}function Yz(e){return Cp(e)}function Xz(e){BO(e,"api")}function Jz(e){return e.visibleCols.isPinningLeft()||e.visibleCols.isPinningRight()}function Qz(e){return e.visibleCols.isPinningLeft()}function Zz(e){return e.visibleCols.isPinningRight()}function eW(e,t){return e.visibleCols.getColAfter(t)}function tW(e,t){return e.visibleCols.getColBefore(t)}function iW(e,t,i){e.colModel.setColsVisible(t,i,"api")}function nW(e,t,i){e.pinnedCols?.setColsPinned(t,i,"api")}function oW(e){return e.colModel.getCols()}function sW(e){return e.visibleCols.leftCols}function rW(e){return e.visibleCols.centerCols}function aW(e){return e.visibleCols.rightCols}function lW(e){return e.visibleCols.allCols}function dW(e){return e.colViewport.getViewportColumns()}function qC(e,t){if(!e)return;let i=e,n={};for(let o of Object.keys(i)){if(t&&t.indexOf(o)>=0||o6.has(o))continue;let s=i[o];typeof s=="object"&&s!==null&&s.constructor===Object?n[o]=qC(s):n[o]=s}return n}var cW=class extends D{constructor(){super(...arguments),this.beanName="colDefFactory"}wireBeans(e){this.rowGroupColsSvc=e.rowGroupColsSvc,this.pivotColsSvc=e.pivotColsSvc}getColumnDefs(e,t,i,n,o=!1){let s=e.slice();t?s.sort((l,d)=>i.indexOf(l)-i.indexOf(d)):(i||o)&&s.sort((l,d)=>n.indexOf(l)-n.indexOf(d));let r=this.rowGroupColsSvc?.columns,a=this.pivotColsSvc?.columns;return this.buildColumnDefs(s,r,a)}buildColumnDefs(e,t=[],i=[]){let n=[],o={};for(let s of e){let r=this.createDefFromColumn(s,t,i),a=!0,l=r,d=s.getOriginalParent(),c=null;for(;d;){let u=null;if(d.isPadding()){d=d.getOriginalParent();continue}let h=o[d.getGroupId()];if(h){h.children.push(l),a=!1;break}if(u=this.createDefFromGroup(d),u&&(u.children=[l],o[u.groupId]=u,l=u,d=d.getOriginalParent()),d!=null&&c===d){a=!1;break}c=d}a&&n.push(l)}return n}createDefFromGroup(e){let t=qC(e.getColGroupDef(),["children"]);return t&&(t.groupId=e.getGroupId()),t}createDefFromColumn(e,t,i){let n=qC(e.getColDef());return n.colId=e.getColId(),n.width=e.getActualWidth(),n.rowGroup=e.isRowGroupActive(),n.rowGroupIndex=e.isRowGroupActive()?t.indexOf(e):null,n.pivot=e.isPivotActive(),n.pivotIndex=e.isPivotActive()?i.indexOf(e):null,n.aggFunc=e.isValueActive()?e.getAggFunc():null,n.hide=e.isVisible()?void 0:!0,n.pinned=e.isPinned()?e.getPinned():null,n.sort=e.getSort()?e.getSort():null,n.sortIndex=e.getSortIndex()!=null?e.getSortIndex():null,n}},uW=class extends D{constructor(){super(...arguments),this.beanName="colFlex",this.columnsHidden=!1}refreshFlexedColumns(e={}){let t=e.source??"flex";e.viewportWidth!=null&&(this.flexViewportWidth=e.viewportWidth);let i=this.flexViewportWidth,{visibleCols:n,colDelayRenderSvc:o}=this.beans,s=n.centerCols,r=-1;if(e.resizingCols){let f=new Set(e.resizingCols);for(let m=s.length-1;m>=0;m--)if(f.has(s[m])){r=m;break}}let a=!1,l=s.map((f,m)=>{let C=f.getFlex(),v=C!=null&&C>0&&m>r;return a||(a=v),{col:f,isFlex:v,flex:Math.max(0,C??0),initialSize:f.getActualWidth(),min:f.getMinWidth(),max:f.getMaxWidth(),targetSize:0}});if(a?(o?.hideColumns("colFlex"),this.columnsHidden=!0):this.columnsHidden&&this.revealColumns(o),!i||!a)return[];let d=l.length,c=l.reduce((f,m)=>f+m.flex,0),u=i,h=(f,m)=>{f.frozenSize=m,f.col.setActualWidth(m,t),u-=m,c-=f.flex,d-=1},p=f=>f.frozenSize!=null;for(let f of l)f.isFlex||h(f,f.initialSize);for(;d>0;){let f=Math.round(c<1?u*c:u),m,C=0,v=0;for(let S of l){if(p(S))continue;m=S,v+=f*(S.flex/c);let x=v-C,E=Math.round(x);S.targetSize=E,C+=E}m&&(m.targetSize+=f-C);let w=0;for(let S of l){if(p(S))continue;let x=S.targetSize,E=Math.min(Math.max(x,S.min),S.max);w+=E-x,S.violationType=E===x?void 0:E<x?"max":"min",S.targetSize=E}let y=w===0?"all":w>0?"min":"max";for(let S of l)p(S)||(y==="all"||S.violationType===y)&&h(S,S.targetSize)}e.skipSetLeft||n.setLeftValues(t),e.updateBodyWidths&&n.updateBodyWidths();let g=l.filter(f=>f.isFlex&&!f.violationType).map(f=>f.col);if(e.fireResizedEvent){let f=l.filter(C=>C.initialSize!==C.frozenSize).map(C=>C.col),m=l.filter(C=>C.flex).map(C=>C.col);va(this.eventSvc,f,!0,t,m)}return this.revealColumns(o),g}revealColumns(e){this.columnsHidden&&(e?.revealColumns("colFlex"),this.columnsHidden=!1)}initCol(e){let{flex:t,initialFlex:i}=e.colDef;t!==void 0?e.flex=t:i!==void 0&&(e.flex=i)}setColFlex(e,t){e.flex=t??null,e.dispatchStateUpdatedEvent("flex")}};function ed(e,t,i){if(!t||!e)return;if(!i)return e[t];let n=t.split("."),o=e;for(let s=0;s<n.length;s++){if(o==null)return;o=o[n[s]]}return o}var hW=["dateTimeString","dateString","text","number","boolean","date"],pW=class extends D{constructor(){super(...arguments),this.beanName="dataTypeSvc",this.dataTypeDefinitions={},this.isPendingInference=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[],this.columnDefinitionPropsPerDataType={number(){return{cellEditor:"agNumberCellEditor"}},boolean(){return{cellEditor:"agCheckboxCellEditor",cellRenderer:"agCheckboxCellRenderer",getFindText:()=>null,suppressKeyboardEvent:e=>!!e.colDef.editable&&e.event.key===R.SPACE}},date({formatValue:e}){return{cellEditor:"agDateCellEditor",keyCreator:e}},dateString({formatValue:e}){return{cellEditor:"agDateStringCellEditor",keyCreator:e}},dateTime(e){return this.date(e)},dateTimeString(e){return this.dateString(e)},object({formatValue:e,colModel:t,colId:i}){return{cellEditorParams:{useFormatter:!0},comparator:(n,o)=>{let s=t.getColDefCol(i),r=s?.getColDef();if(!s||!r)return 0;let a=n==null?"":e({column:s,node:null,value:n}),l=o==null?"":e({column:s,node:null,value:o});return a===l?0:a>l?1:-1},keyCreator:e}},text(){return{}}}}wireBeans(e){this.colModel=e.colModel}postConstruct(){this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",e=>{this.processDataTypeDefinitions(),this.colModel.recreateColumnDefs(e)})}processDataTypeDefinitions(){let e=this.getDefaultDataTypes(),t={},i={},n=c=>u=>{let{column:h,node:p,value:g}=u,f=h.getColDef().valueFormatter;return f===c.groupSafeValueFormatter&&(f=c.valueFormatter),this.beans.valueSvc.formatValue(h,p,g,f)};for(let c of Object.keys(e)){let u=e[c],h=_(b({},u),{groupSafeValueFormatter:pR(u,this.gos)});t[c]=h,i[c]=n(h)}let o=this.gos.get("dataTypeDefinitions")??{},s={};for(let c of Object.keys(o)){let u=o[c],h=this.processDataTypeDefinition(u,o,[c],e);h&&(t[c]=h,u.dataTypeMatcher&&(s[c]=u.dataTypeMatcher),i[c]=n(h))}let{valueParser:r,valueFormatter:a}=e.object,{valueParser:l,valueFormatter:d}=t.object;this.hasObjectValueParser=l!==r,this.hasObjectValueFormatter=d!==a,this.formatValueFuncs=i,this.dataTypeDefinitions=t,this.dataTypeMatchers=this.sortKeysInMatchers(s,e)}sortKeysInMatchers(e,t){let i=b({},e);for(let n of hW)delete i[n],i[n]=e[n]??t[n].dataTypeMatcher;return i}processDataTypeDefinition(e,t,i,n){let o,s=e.extendsDataType;if(e.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),e.extendsDataType===e.baseDataType){let r=n[s],a=t[s];if(r&&a&&(r=a),!hR(e,r,s))return;o=uR(r,e)}else{if(i.includes(s)){I(44);return}let r=t[s];if(!hR(e,r,s))return;let a=this.processDataTypeDefinition(r,t,[...i,s],n);if(!a)return;o=uR(a,e)}return _(b({},o),{groupSafeValueFormatter:pR(o,this.gos)})}updateColDefAndGetColumnType(e,t,i){let{cellDataType:n}=t,{field:o}=t;if(n===void 0&&(n=e.cellDataType),(n==null||n===!0)&&(n=this.canInferCellDataType(e,t)?this.inferCellDataType(o,i):!1),!n){e.cellDataType=!1;return}let s=this.dataTypeDefinitions[n];if(!s){I(47,{cellDataType:n});return}return e.cellDataType=n,s.groupSafeValueFormatter&&(e.valueFormatter=s.groupSafeValueFormatter),s.valueParser&&(e.valueParser=s.valueParser),s.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(e,n,s,i),s.columnTypes}addColumnListeners(e){if(!this.isPendingInference)return;let t=this.columnStateUpdatesPendingInference[e.getColId()];if(!t)return;let i=n=>{t.add(n.key)};e.__addEventListener("columnStateUpdated",i),this.columnStateUpdateListenerDestroyFuncs.push(()=>e.__removeEventListener("columnStateUpdated",i))}canInferCellDataType(e,t){let{gos:i}=this;if(!gt(i))return!1;let n={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(cC(t,n))return!1;let o=t.type===null?e.type:t.type;if(o){let s=i.get("columnTypes")??{};if(mp(o).some(a=>{let l=s[a.trim()];return l&&cC(l,n)}))return!1}return!cC(e,n)}inferCellDataType(e,t){if(!e)return;let i,n=this.getInitialData();if(n){let s=e.includes(".")&&!this.gos.get("suppressFieldDotNotation");i=ed(n,e,s)}else this.initWaitForRowData(t);return i==null?void 0:Object.keys(this.dataTypeMatchers).find(s=>this.dataTypeMatchers[s](i))??"object"}getInitialData(){let e=this.gos.get("rowData");if(e?.length)return e[0];if(this.initialData)return this.initialData;{let t=this.beans.rowModel.rootNode?._leafs;if(t?.length)return t[0].data}return null}initWaitForRowData(e){if(this.columnStateUpdatesPendingInference[e]=new Set,this.isPendingInference)return;this.isPendingInference=!0;let t=this.isColumnTypeOverrideInDataTypeDefinitions,{colAutosize:i,eventSvc:n}=this.beans;t&&i&&(i.shouldQueueResizeOperations=!0);let[o]=this.addManagedEventListeners({rowDataUpdateStarted:s=>{let{firstRowData:r}=s;r&&(o?.(),this.isPendingInference=!1,this.processColumnsPendingInference(r,t),this.columnStateUpdatesPendingInference={},t&&i?.processResizeOperations(),n.dispatchEvent({type:"dataTypesInferred"}))}})}processColumnsPendingInference(e,t){this.initialData=e;let i=[];this.destroyColumnStateUpdateListeners();let n={},o={};for(let s of Object.keys(this.columnStateUpdatesPendingInference)){let r=this.columnStateUpdatesPendingInference[s],a=this.colModel.getCol(s);if(!a)return;let l=a.getColDef();if(!this.resetColDefIntoCol(a,"cellDataTypeInferred"))return;let d=a.getColDef();if(t&&d.type&&d.type!==l.type){let c=fW(a,r);c.rowGroup&&c.rowGroupIndex==null&&(n[s]=c),c.pivot&&c.pivotIndex==null&&(o[s]=c),i.push(c)}}t&&i.push(...this.generateColumnStateForRowGroupAndPivotIndexes(n,o)),i.length&&Ki(this.beans,{state:i},"cellDataTypeInferred"),this.initialData=null}generateColumnStateForRowGroupAndPivotIndexes(e,t){let i={},{rowGroupColsSvc:n,pivotColsSvc:o}=this.beans;return n?.restoreColumnOrder(i,e),o?.restoreColumnOrder(i,t),Object.values(i)}resetColDefIntoCol(e,t){let i=e.getUserProvidedColDef();if(!i)return!1;let n=MC(this.beans,i,e.getColId());return e.setColDef(n,i,t),!0}getDateStringTypeDefinition(e){let{dateString:t}=this.dataTypeDefinitions;return e?this.getDataTypeDefinition(e)??t:t}getDateParserFunction(e){return this.getDateStringTypeDefinition(e).dateParser}getDateFormatterFunction(e){return this.getDateStringTypeDefinition(e).dateFormatter}getDateIncludesTimeFlag(e){return e==="dateTime"||e==="dateTimeString"}getDataTypeDefinition(e){let t=e.getColDef();if(t.cellDataType)return this.dataTypeDefinitions[t.cellDataType]}getBaseDataType(e){return this.getDataTypeDefinition(e)?.baseDataType}checkType(e,t){if(t==null)return!0;let i=this.getDataTypeDefinition(e)?.dataTypeMatcher;return i?i(t):!0}validateColDef(e){let t=i=>I(48,{property:i});if(e.cellDataType==="object"){let{object:i}=this.dataTypeDefinitions;e.valueFormatter===i.groupSafeValueFormatter&&!this.hasObjectValueFormatter&&t("Formatter"),e.editable&&e.valueParser===i.valueParser&&!this.hasObjectValueParser&&t("Parser")}}postProcess(e){let t=e.cellDataType;if(!t||typeof t!="string")return;let{dataTypeDefinitions:i,beans:n,formatValueFuncs:o}=this,s=i[t];s&&n.colFilter?.setColDefPropsForDataType(e,s,o[t])}getFormatValue(e){return this.formatValueFuncs[e]}isColPendingInference(e){return this.isPendingInference&&!!this.columnStateUpdatesPendingInference[e]}setColDefPropertiesForBaseDataType(e,t,i,n){let o=this.formatValueFuncs[t],s=this.columnDefinitionPropsPerDataType[i.baseDataType]({colDef:e,cellDataType:t,colModel:this.colModel,dataTypeDefinition:i,colId:n,formatValue:o});Object.assign(e,s)}getDateObjectTypeDef(e){let t=this.getLocaleTextFunc(),i=this.getDateIncludesTimeFlag(e);return{baseDataType:e,valueParser:n=>pi(n.newValue&&String(n.newValue)),valueFormatter:n=>n.value==null?"":!(n.value instanceof Date)||isNaN(n.value.getTime())?t("invalidDate","Invalid Date"):Si(n.value,i)??"",dataTypeMatcher:n=>n instanceof Date}}getDateStringTypeDef(e){let t=this.getDateIncludesTimeFlag(e);return{baseDataType:e,dateParser:i=>pi(i)??void 0,dateFormatter:i=>Si(i??null,t)??void 0,valueParser:i=>Qh(String(i.newValue))?i.newValue:null,valueFormatter:i=>Qh(String(i.value))?String(i.value):"",dataTypeMatcher:i=>typeof i=="string"&&Qh(i)}}getDefaultDataTypes(){let e=this.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:t=>t.newValue?.trim?.()===""?null:Number(t.newValue),valueFormatter:t=>t.value==null?"":typeof t.value!="number"||isNaN(t.value)?e("invalidNumber","Invalid Number"):String(t.value),dataTypeMatcher:t=>typeof t=="number"},text:{baseDataType:"text",valueParser:t=>t.newValue===""?null:wC(t.newValue),dataTypeMatcher:t=>typeof t=="string"},boolean:{baseDataType:"boolean",valueParser:t=>t.newValue==null?t.newValue:t.newValue?.trim?.()===""?null:String(t.newValue).toLowerCase()==="true",valueFormatter:t=>t.value==null?"":String(t.value),dataTypeMatcher:t=>typeof t=="boolean"},date:this.getDateObjectTypeDef("date"),dateString:this.getDateStringTypeDef("dateString"),dateTime:this.getDateObjectTypeDef("dateTime"),dateTimeString:_(b({},this.getDateStringTypeDef("dateTimeString")),{dataTypeMatcher:t=>typeof t=="string"&&FN(t)}),object:{baseDataType:"object",valueParser:()=>null,valueFormatter:t=>wC(t.value)??""}}}destroyColumnStateUpdateListeners(){for(let e of this.columnStateUpdateListenerDestroyFuncs)e();this.columnStateUpdateListenerDestroyFuncs=[]}destroy(){this.dataTypeDefinitions={},this.dataTypeMatchers={},this.formatValueFuncs={},this.columnStateUpdatesPendingInference={},this.destroyColumnStateUpdateListeners(),super.destroy()}};function uR(e,t){let i=b(b({},e),t);return e.columnTypes&&t.columnTypes&&t.appendColumnTypes&&(i.columnTypes=[...mp(e.columnTypes),...mp(t.columnTypes)]),i}function hR(e,t,i){return t?t.baseDataType!==e.baseDataType?(I(46),!1):!0:(I(45,{parentCellDataType:i}),!1)}function pR(e,t){if(e.valueFormatter)return i=>{if(i.node?.group){let n=(i.colDef.pivotValueColumn??i.column).getAggFunc();if(n){if(n==="first"||n==="last")return e.valueFormatter(i);if(e.baseDataType==="number"&&n!=="count"){if(typeof i.value=="number")return e.valueFormatter(i);if(typeof i.value=="object"){if(!i.value)return;if("toNumber"in i.value)return e.valueFormatter(_(b({},i),{value:i.value.toNumber()}));if("value"in i.value)return e.valueFormatter(_(b({},i),{value:i.value.value}))}}return}}else if(t.get("groupHideOpenParents")&&i.column.isRowGroupActive()&&typeof i.value=="string"&&!e.dataTypeMatcher?.(i.value))return;return e.valueFormatter(i)}}function gW(e,t,i,n){if(!t[i])return!1;let o=e[i];return o===null?(t[i]=!1,!1):n===void 0?!!o:o===n}function cC(e,t){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some(([i,n])=>gW(e,t,i,n))}function fW(e,t){let i=N6(e);for(let n of t)delete i[n],n==="rowGroup"?delete i.rowGroupIndex:n==="pivot"&&delete i.pivotIndex;return i}var mW={moduleName:"DataType",version:z,beans:[pW],dependsOn:[Vz]},CW={moduleName:"ColumnFlex",version:z,beans:[uW]},W4={moduleName:"ColumnApi",version:z,beans:[cW],apiFunctions:{getColumnDef:Wz,getDisplayNameForColumn:qz,getColumn:$z,getColumns:jz,applyColumnState:Kz,getColumnState:Yz,resetColumnState:Xz,isPinning:Jz,isPinningLeft:Qz,isPinningRight:Zz,getDisplayedColAfter:eW,getDisplayedColBefore:tW,setColumnsVisible:iW,setColumnsPinned:nW,getAllGridColumns:oW,getDisplayedLeftColumns:sW,getDisplayedCenterColumns:rW,getDisplayedRightColumns:aW,getAllDisplayedColumns:lW,getAllDisplayedVirtualColumns:dW,getColumnDefs:Uz}};function vW(e){if(!e||e==null)return null;let t=/([a-z])([A-Z])/g,i=/([A-Z]+)([A-Z])([a-z])/g;return e.replace(t,"$1 $2").replace(i,"$1 $2$3").replace(/\./g," ").split(" ").map(o=>o.substring(0,1).toUpperCase()+(o.length>1?o.substring(1,o.length):"")).join(" ")}var wW=class extends D{constructor(){super(...arguments),this.beanName="colNames"}getDisplayNameForColumn(e,t,i=!1){if(!e)return null;let n=this.getHeaderName(e.getColDef(),e,null,null,t),{aggColNameSvc:o}=this.beans;return i&&o?o.getHeaderName(e,n):n}getDisplayNameForProvidedColumnGroup(e,t,i){let n=t?.getColGroupDef();return n?this.getHeaderName(n,null,e,t,i):null}getDisplayNameForColumnGroup(e,t){return this.getDisplayNameForProvidedColumnGroup(e,e.getProvidedColumnGroup(),t)}getHeaderName(e,t,i,n,o){let s=e.headerValueGetter;if(s){let r=te(this.gos,{colDef:e,column:t,columnGroup:i,providedColumnGroup:n,location:o});return typeof s=="function"?s(r):typeof s=="string"?this.beans.expressionSvc?.evaluate(s,r)??null:""}else{if(e.headerName!=null)return e.headerName;if(e.field)return vW(e.field)}return""}},bW=class extends D{constructor(){super(...arguments),this.beanName="colViewport",this.colsWithinViewport=[],this.headerColsWithinViewport=[],this.colsWithinViewportHash="",this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.columnsToRenderLeft=[],this.columnsToRenderRight=[],this.columnsToRenderCenter=[]}wireBeans(e){this.visibleCols=e.visibleCols,this.colModel=e.colModel}postConstruct(){this.suppressColumnVirtualisation=this.gos.get("suppressColumnVirtualisation")}setScrollPosition(e,t,i=!1){let{visibleCols:n}=this,o=n.isBodyWidthDirty;if(!(e===this.scrollWidth&&t===this.scrollPosition&&!o)){if(this.scrollWidth=e,this.scrollPosition=t,n.isBodyWidthDirty=!0,this.gos.get("enableRtl")){let r=n.bodyWidth;this.viewportLeft=r-t-e,this.viewportRight=r-t}else this.viewportLeft=t,this.viewportRight=e+t;this.colModel.ready&&this.checkViewportColumns(i)}}getColumnHeadersToRender(e){switch(e){case"left":return this.columnsToRenderLeft;case"right":return this.columnsToRenderRight;default:return this.columnsToRenderCenter}}getHeadersToRender(e,t){let i;switch(e){case"left":i=this.rowsOfHeadersToRenderLeft[t];break;case"right":i=this.rowsOfHeadersToRenderRight[t];break;default:i=this.rowsOfHeadersToRenderCenter[t];break}return i??[]}extractViewportColumns(){let e=this.visibleCols.centerCols;this.isColumnVirtualisationSuppressed()?(this.colsWithinViewport=e,this.headerColsWithinViewport=e):(this.colsWithinViewport=e.filter(this.isColumnInRowViewport.bind(this)),this.headerColsWithinViewport=e.filter(this.isColumnInHeaderViewport.bind(this)))}isColumnVirtualisationSuppressed(){return this.suppressColumnVirtualisation||this.viewportRight===0}clear(){this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.colsWithinViewportHash=""}isColumnInHeaderViewport(e){return e.isAutoHeaderHeight()||yW(e)?!0:this.isColumnInRowViewport(e)}isColumnInRowViewport(e){if(e.isAutoHeight())return!0;let t=e.getLeft()||0,i=t+e.getActualWidth(),n=this.viewportLeft-200,o=this.viewportRight+200,s=t<n&&i<n,r=t>o&&i>o;return!s&&!r}getViewportColumns(){let{leftCols:e,rightCols:t}=this.visibleCols;return this.colsWithinViewport.concat(e).concat(t)}getColsWithinViewport(e){if(!this.colModel.colSpanActive)return this.colsWithinViewport;let t=s=>{let r=s.getLeft();return q(r)&&r>this.viewportLeft},i=this.isColumnVirtualisationSuppressed()?void 0:this.isColumnInRowViewport.bind(this),{visibleCols:n}=this,o=n.centerCols;return n.getColsForRow(e,o,i,t)}checkViewportColumns(e=!1){this.extractViewport()&&this.eventSvc.dispatchEvent({type:"virtualColumnsChanged",afterScroll:e})}calculateHeaderRows(){let{leftCols:e,rightCols:t}=this.visibleCols;this.columnsToRenderLeft=e,this.columnsToRenderRight=t,this.columnsToRenderCenter=this.colsWithinViewport;let i=n=>{let o=new Set,s={};for(let r of n){let a=r.getParent(),l=r.isSpanHeaderHeight();for(;a&&!o.has(a);){if(l&&a.isPadding()){a=a.getParent();continue}let c=a.getProvidedColumnGroup().getLevel();s[c]??(s[c]=[]),s[c].push(a),o.add(a),a=a.getParent()}}return s};this.rowsOfHeadersToRenderLeft=i(e),this.rowsOfHeadersToRenderRight=i(t),this.rowsOfHeadersToRenderCenter=i(this.headerColsWithinViewport)}extractViewport(){let e=n=>`${n.getId()}-${n.getPinned()||"normal"}`;this.extractViewportColumns();let t=this.getViewportColumns().map(e).join("#"),i=this.colsWithinViewportHash!==t;return i&&(this.colsWithinViewportHash=t,this.calculateHeaderRows()),i}};function yW(e){for(;e;){if(e.isAutoHeaderHeight())return!0;e=e.getParent()}return!1}var SW=class extends D{constructor(){super(...arguments),this.beanName="agCompUtils"}adaptFunction(e,t){if(!e.cellRenderer)return null;class i{refresh(){return!1}getGui(){return this.eGui}init(o){let s=t(o),r=typeof s;if(r==="string"||r==="number"||r==="boolean"){this.eGui=iv("<span>"+s+"</span>");return}if(s==null){this.eGui=ft({tag:"span"});return}this.eGui=s}}return i}},xW={moduleName:"CellRendererFunction",version:z,beans:[SW]},EW=class extends MB{constructor(){super(...arguments),this.agGridDefaults={},this.agGridDefaultOverrides={},this.jsComps={},this.selectors={},this.icons={}}postConstruct(){let e=this.gos.get("components");if(e!=null)for(let t of Object.keys(e))this.jsComps[t]=e[t]}registerModule(e){let{icons:t,userComponents:i,dynamicBeans:n,selectors:o}=e;if(i){let s=(r,a,l,d)=>{this.agGridDefaults[r]=a,(l||d)&&(this.agGridDefaultOverrides[r]={params:l,processParams:d})};for(let r of Object.keys(i)){let a=i[r];if(RN(a)&&(a=a.getComp(this.beans)),typeof a=="object"){let{classImp:l,params:d,processParams:c}=a;s(r,l,d,c)}else s(r,a)}}this.registerDynamicBeans(n);for(let s of o??[])this.selectors[s.selector]=s;if(t)for(let s of Object.keys(t))this.icons[s]=t[s]}getUserComponent(e,t){let i=(a,l,d,c)=>({componentFromFramework:l,component:a,params:d,processParams:c}),{frameworkOverrides:n}=this.beans,o=n.frameworkComponent(t,this.gos.get("components"));if(o!=null)return i(o,!0);let s=this.jsComps[t];if(s){let a=n.isFrameworkComponent(s);return i(s,a)}let r=this.agGridDefaults[t];if(r){let a=this.agGridDefaultOverrides[t];return i(r,!1,a?.params,a?.processParams)}return this.beans.validation?.missingUserComponent(e,t,this.agGridDefaults,this.jsComps),null}getSelector(e){return this.selectors[e]}getIcon(e){return this.icons[e]}getDynamicError(e,t){return t?En(279,{name:e}):this.beans.validation?.missingDynamicBean(e)??En(256)}},RW=23,PW=class extends D{constructor(){super(...arguments),this.beanName="ctrlsSvc",this.params={},this.ready=!1,this.readyCallbacks=[]}postConstruct(){this.addEventListener("ready",()=>{if(this.updateReady(),this.ready){for(let e of this.readyCallbacks)e(this.params);this.readyCallbacks.length=0}},this.beans.frameworkOverrides.runWhenReadyAsync?.()??!1)}updateReady(){let e=Object.values(this.params);this.ready=e.length===RW&&e.every(t=>t?.isAlive()??!1)}whenReady(e,t){this.ready?t(this.params):this.readyCallbacks.push(t),e.addDestroyFunc(()=>{let i=this.readyCallbacks.indexOf(t);i>=0&&this.readyCallbacks.splice(i,1)})}register(e,t){this.params[e]=t,this.updateReady(),this.ready&&this.dispatchLocalEvent({type:"ready"}),t.addDestroyFunc(()=>{this.updateReady()})}get(e){return this.params[e]}getGridBodyCtrl(){return this.params.gridBodyCtrl}getHeaderRowContainerCtrls(){let{leftHeader:e,centerHeader:t,rightHeader:i}=this.params;return[e,i,t]}getHeaderRowContainerCtrl(e){let t=this.params;switch(e){case"left":return t.leftHeader;case"right":return t.rightHeader;default:return t.centerHeader}}getScrollFeature(){return this.getGridBodyCtrl().scrollFeature}},MW='.ag-aria-description-container{border:0;z-index:9999;clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px}.ag-unselectable{-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-selectable{-webkit-user-select:text;-moz-user-select:text;user-select:text}.ag-tab-guard{display:block;height:0;position:absolute;width:0}:where(.ag-virtual-list-viewport) .ag-tab-guard{position:sticky}.ag-tab-guard-top{top:1px}.ag-tab-guard-bottom{bottom:1px}.ag-shake-left-to-right{animation-direction:alternate;animation-duration:.2s;animation-iteration-count:infinite;animation-name:ag-shake-left-to-right}@keyframes ag-shake-left-to-right{0%{padding-left:6px;padding-right:2px}to{padding-left:2px;padding-right:6px}}.ag-body-horizontal-scroll-viewport,.ag-body-vertical-scroll-viewport,.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport,.ag-virtual-list-viewport{flex:1 1 auto;height:100%;min-width:0;overflow:hidden;position:relative}.ag-viewport{position:relative}.ag-spanning-container{position:absolute;top:0;z-index:1}.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport{overflow-x:auto;-ms-overflow-style:none!important;scrollbar-width:none!important;&::-webkit-scrollbar{display:none!important}}.ag-body-viewport{display:flex;overflow-x:hidden;&:where(.ag-layout-normal){overflow-y:auto;-webkit-overflow-scrolling:touch}}.ag-floating-bottom-container,.ag-floating-top-container,.ag-sticky-bottom-container,.ag-sticky-top-container{min-height:1px}.ag-center-cols-viewport{min-height:100%;width:100%}.ag-body-horizontal-scroll-viewport{overflow-x:scroll}.ag-body-vertical-scroll-viewport{overflow-y:scroll}.ag-virtual-list-viewport{overflow:auto;width:100%}.ag-body-container,.ag-body-horizontal-scroll-container,.ag-body-vertical-scroll-container,.ag-center-cols-container,.ag-floating-bottom-container,.ag-floating-bottom-full-width-container,.ag-floating-top-container,.ag-full-width-container,.ag-header-container,.ag-pinned-left-cols-container,.ag-pinned-right-cols-container,.ag-sticky-bottom-container,.ag-sticky-top-container,.ag-virtual-list-container{position:relative}.ag-floating-bottom-container,.ag-floating-top-container,.ag-header-container,.ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top,.ag-sticky-bottom-container,.ag-sticky-top-container{height:100%;white-space:nowrap}.ag-center-cols-container,.ag-pinned-right-cols-container{display:block}.ag-body-horizontal-scroll-container{height:100%}.ag-body-vertical-scroll-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container,.ag-full-width-container,.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{pointer-events:none;position:absolute;top:0}:where(.ag-ltr) .ag-floating-bottom-full-width-container,:where(.ag-ltr) .ag-floating-top-full-width-container,:where(.ag-ltr) .ag-full-width-container,:where(.ag-ltr) .ag-sticky-bottom-full-width-container,:where(.ag-ltr) .ag-sticky-top-full-width-container{left:0}:where(.ag-rtl) .ag-floating-bottom-full-width-container,:where(.ag-rtl) .ag-floating-top-full-width-container,:where(.ag-rtl) .ag-full-width-container,:where(.ag-rtl) .ag-sticky-bottom-full-width-container,:where(.ag-rtl) .ag-sticky-top-full-width-container{right:0}.ag-full-width-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container{display:inline-block;height:100%;overflow:hidden;width:100%}.ag-virtual-list-container{overflow:hidden}.ag-body{display:flex;flex:1 1 auto;flex-direction:row!important;min-height:0;position:relative}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:flex;min-height:0;min-width:0;position:relative;&:where(.ag-scrollbar-invisible){bottom:0;position:absolute;&:where(.ag-apple-scrollbar){opacity:0;transition:opacity .4s;visibility:hidden;&:where(.ag-scrollbar-scrolling,.ag-scrollbar-active){opacity:1;visibility:visible}}}}.ag-body-horizontal-scroll{width:100%;&:where(.ag-scrollbar-invisible){left:0;right:0}}.ag-body-vertical-scroll{height:100%;&:where(.ag-scrollbar-invisible){top:0;z-index:10}}:where(.ag-ltr) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){right:0}}:where(.ag-rtl) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){left:0}}.ag-force-vertical-scroll{overflow-y:scroll!important}.ag-horizontal-left-spacer,.ag-horizontal-right-spacer{height:100%;min-width:0;overflow-x:scroll;&:where(.ag-scroller-corner){overflow-x:hidden}}:where(.ag-row-animation) .ag-row{transition:transform .4s,top .4s,opacity .2s;&:where(.ag-after-created){transition:transform .4s,top .4s,height .4s,opacity .2s}}:where(.ag-row-animation.ag-prevent-animation) .ag-row{transition:none!important;&:where(.ag-row.ag-after-created){transition:none!important}}:where(.ag-row-no-animation) .ag-row{transition:none}.ag-row-loading{align-items:center;display:flex}.ag-row-position-absolute{position:absolute}.ag-row-position-relative{position:relative}.ag-full-width-row{overflow:hidden;pointer-events:all}.ag-row-inline-editing{z-index:1}.ag-row-dragging{z-index:2}.ag-stub-cell{align-items:center;display:flex}.ag-cell{display:inline-block;height:100%;position:absolute;white-space:nowrap;&:focus-visible{box-shadow:none}}.ag-cell-value{flex:1 1 auto}.ag-cell-value:not(.ag-allow-overflow),.ag-group-value{overflow:hidden;text-overflow:ellipsis}.ag-cell-wrap-text{white-space:normal;word-break:break-word}:where(.ag-cell) .ag-icon{display:inline-block;vertical-align:middle}.ag-floating-top{display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}:where(.ag-floating-top:not(.ag-invisible)){border-bottom:var(--ag-pinned-row-border)}.ag-floating-bottom{display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}:where(.ag-floating-bottom:not(.ag-invisible)){border-top:var(--ag-pinned-row-border)}.ag-sticky-bottom,.ag-sticky-top{background-color:var(--ag-data-background-color);display:flex;height:0;overflow:hidden;position:absolute;width:100%;z-index:1}.ag-opacity-zero{opacity:0!important}.ag-cell-label-container{align-items:center;display:flex;flex-direction:row-reverse;height:100%;justify-content:space-between;width:100%}:where(.ag-right-aligned-header){.ag-cell-label-container{flex-direction:row}.ag-header-cell-text{text-align:end}}.ag-column-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr){direction:ltr;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row}}:where(.ag-rtl){direction:rtl;text-align:right;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row-reverse}.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{display:block}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(180deg)}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(-180deg)}}.ag-measurement-container{height:0;overflow:hidden;visibility:hidden;width:0}.ag-measurement-element-border{display:inline-block;&:before{border-left:var(--ag-internal-measurement-border);content:"";display:block}}.ag-group{position:relative;width:100%}.ag-group-title-bar{align-items:center;display:flex;padding:var(--ag-spacing)}.ag-group-title{display:inline;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:where(.ag-group-title-bar) .ag-group-title{cursor:default}.ag-group-toolbar{align-items:center;display:flex;padding:var(--ag-spacing)}.ag-group-container{display:flex}.ag-disabled .ag-group-container{pointer-events:none}.ag-disabled-group-container,.ag-disabled-group-title-bar{opacity:.5}.ag-group-container-horizontal{flex-flow:row wrap}.ag-group-container-vertical{flex-direction:column}.ag-group-title-bar-icon{cursor:pointer;flex:none}:where(.ag-ltr) .ag-group-title-bar-icon{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-group-title-bar-icon{margin-left:var(--ag-spacing)}:where(.ag-group-item-alignment-stretch) .ag-group-item{align-items:stretch}:where(.ag-group-item-alignment-start) .ag-group-item{align-items:flex-start}:where(.ag-group-item-alignment-end) .ag-group-item{align-items:flex-end}:where(.ag-ltr) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-left:var(--ag-row-group-indent-size)}:where(.ag-rtl) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-right:var(--ag-row-group-indent-size)}:where(.ag-ltr) .ag-row-group-leaf-indent{margin-left:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}:where(.ag-rtl) .ag-row-group-leaf-indent{margin-right:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}.ag-value-change-delta{padding:0 2px}.ag-value-change-delta-up{color:var(--ag-value-change-delta-up-color)}.ag-value-change-delta-down{color:var(--ag-value-change-delta-down-color)}.ag-value-change-value{background-color:transparent;border-radius:1px;padding-left:1px;padding-right:1px;transition:background-color 1s}.ag-value-change-value-highlight{background-color:var(--ag-value-change-value-highlight-background-color);transition:background-color .1s}.ag-cell-data-changed{background-color:var(--ag-value-change-value-highlight-background-color)!important}.ag-cell-data-changed-animation{background-color:transparent}.ag-cell-highlight{background-color:var(--ag-range-selection-highlight-color)!important}.ag-row,.ag-spanned-row{color:var(--ag-cell-text-color);font-family:var(--ag-cell-font-family);font-size:var(--ag-data-font-size);white-space:nowrap;--ag-internal-content-line-height:calc(min(var(--ag-row-height), var(--ag-line-height, 1000px)) - var(--ag-internal-row-border-width, 1px) - 2px)}.ag-row{background-color:var(--ag-data-background-color);border-bottom:var(--ag-row-border);height:var(--ag-row-height);width:100%;&.ag-row-editing-invalid{background-color:var(--ag-full-row-edit-invalid-background-color)}}:where(.ag-body-vertical-content-no-gap>div>div>div,.ag-body-vertical-content-no-gap>div>div>div>div)>.ag-row-last{border-bottom-color:transparent}.ag-sticky-bottom{border-top:var(--ag-row-border);box-sizing:content-box!important}.ag-group-contracted,.ag-group-expanded{cursor:pointer}.ag-cell,.ag-full-width-row .ag-cell-wrapper.ag-row-group{border:1px solid transparent;line-height:var(--ag-internal-content-line-height);-webkit-font-smoothing:subpixel-antialiased}:where(.ag-ltr) .ag-cell{border-right:var(--ag-column-border)}:where(.ag-rtl) .ag-cell{border-left:var(--ag-column-border)}.ag-spanned-cell-wrapper{background-color:var(--ag-data-background-color);position:absolute}.ag-spanned-cell-wrapper>.ag-spanned-cell{display:block;position:relative}:where(.ag-ltr) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-right-color:transparent}:where(.ag-rtl) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-left-color:transparent}.ag-cell-wrapper{align-items:center;display:flex;>:where(:not(.ag-cell-value,.ag-group-value)){align-items:center;display:flex;height:var(--ag-internal-content-line-height)}&:where(.ag-row-group){align-items:flex-start}:where(.ag-full-width-row) &:where(.ag-row-group){align-items:center;height:100%}}:where(.ag-ltr) .ag-cell-wrapper{padding-left:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-rtl) .ag-cell-wrapper{padding-right:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-cell-wrap-text:not(.ag-cell-auto-height)) .ag-cell-wrapper{align-items:normal;height:100%;:where(.ag-cell-value){height:100%}}:where(.ag-ltr) .ag-row>.ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}:where(.ag-rtl) .ag-row>.ag-cell-wrapper.ag-row-group{padding-right:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-cell-focus:not(.ag-cell-range-selected):focus-within,.ag-cell-range-single-cell,.ag-cell-range-single-cell.ag-cell-range-handle,.ag-context-menu-open .ag-cell-focus:not(.ag-cell-range-selected),.ag-context-menu-open .ag-full-width-row.ag-row-focus .ag-cell-wrapper.ag-row-group,.ag-full-width-row.ag-row-focus:focus .ag-cell-wrapper.ag-row-group{border:1px solid;border-color:var(--ag-range-selection-border-color);border-style:var(--ag-range-selection-border-style);outline:initial}.ag-full-width-row.ag-row-focus:focus{box-shadow:none}:where(.ag-ltr) .ag-group-contracted,:where(.ag-ltr) .ag-group-expanded,:where(.ag-ltr) .ag-row-drag,:where(.ag-ltr) .ag-selection-checkbox{margin-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-group-contracted,:where(.ag-rtl) .ag-group-expanded,:where(.ag-rtl) .ag-row-drag,:where(.ag-rtl) .ag-selection-checkbox{margin-left:var(--ag-cell-widget-spacing)}:where(.ag-ltr) .ag-group-child-count{margin-left:3px}:where(.ag-rtl) .ag-group-child-count{margin-right:3px}.ag-row-highlight-above:after,.ag-row-highlight-below:after,.ag-row-highlight-inside:after{background-color:var(--ag-range-selection-border-color);content:"";height:1px;pointer-events:none;position:absolute;width:calc(100% - 1px)}:where(.ag-ltr) .ag-row-highlight-above:after,:where(.ag-ltr) .ag-row-highlight-below:after,:where(.ag-ltr) .ag-row-highlight-inside:after{left:1px}:where(.ag-rtl) .ag-row-highlight-above:after,:where(.ag-rtl) .ag-row-highlight-below:after,:where(.ag-rtl) .ag-row-highlight-inside:after{right:1px}.ag-row-highlight-above:after{top:0}.ag-row-highlight-below:after{bottom:0}.ag-row-highlight-indent:after{display:block;width:auto}:where(.ag-ltr) .ag-row-highlight-indent:after{left:calc((var(--ag-cell-widget-spacing) + var(--ag-icon-size))*2 + var(--ag-cell-horizontal-padding) + var(--ag-row-highlight-level)*var(--ag-row-group-indent-size));right:1px}:where(.ag-rtl) .ag-row-highlight-indent:after{left:1px;right:calc((var(--ag-cell-widget-spacing) + var(--ag-icon-size))*2 + var(--ag-cell-horizontal-padding) + var(--ag-row-highlight-level)*var(--ag-row-group-indent-size))}.ag-row-highlight-inside:after{background-color:var(--ag-selected-row-background-color);border:1px solid var(--ag-range-selection-border-color);display:block;height:auto;inset:0;width:auto}.ag-body,.ag-floating-bottom,.ag-floating-top{background-color:var(--ag-data-background-color)}.ag-row-odd{background-color:var(--ag-odd-row-background-color)}.ag-row-selected:before{background-color:var(--ag-selected-row-background-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-full-width-row.ag-row-group:before,.ag-row-hover:not(.ag-full-width-row):before{background-color:var(--ag-row-hover-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-row-selected:before{background-color:var(--ag-row-hover-color);background-image:linear-gradient(var(--ag-selected-row-background-color),var(--ag-selected-row-background-color))}.ag-row.ag-full-width-row.ag-row-group>*{position:relative}.ag-column-hover{background-color:var(--ag-column-hover-color)}.ag-header-range-highlight{background-color:var(--ag-range-header-highlight-color)}.ag-right-aligned-cell{font-variant-numeric:tabular-nums}:where(.ag-ltr) .ag-right-aligned-cell{text-align:right}:where(.ag-rtl) .ag-right-aligned-cell{text-align:left}.ag-right-aligned-cell .ag-cell-value,.ag-right-aligned-cell .ag-group-value{margin-left:auto}:where(.ag-ltr) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-ltr) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level));padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}:where(.ag-rtl) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-rtl) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-row>.ag-cell-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}.ag-row-dragging{cursor:move;opacity:.5}.ag-details-row{background-color:var(--ag-data-background-color);padding:calc(var(--ag-spacing)*3.75)}.ag-layout-auto-height,.ag-layout-print{.ag-center-cols-container,.ag-center-cols-viewport{min-height:150px}}.ag-overlay-loading-wrapper{background-color:var(--ag-modal-overlay-background-color)}.ag-skeleton-container{align-content:center;height:100%;width:100%}.ag-skeleton-effect{animation:ag-skeleton-loading 1.5s ease-in-out .5s infinite;background-color:var(--ag-row-loading-skeleton-effect-color);border-radius:.25rem;height:1em;width:100%}:where(.ag-ltr) .ag-right-aligned-cell .ag-skeleton-effect{margin-left:auto}:where(.ag-rtl) .ag-right-aligned-cell .ag-skeleton-effect{margin-right:auto}@keyframes ag-skeleton-loading{0%{background-color:var(--ag-row-loading-skeleton-effect-color)}50%{background-color:color-mix(in srgb,transparent,var(--ag-row-loading-skeleton-effect-color) 40%)}to{background-color:var(--ag-row-loading-skeleton-effect-color)}}.ag-loading{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-loading{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-loading{padding-right:var(--ag-cell-horizontal-padding)}:where(.ag-ltr) .ag-loading-icon{padding-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-loading-icon{padding-left:var(--ag-cell-widget-spacing)}.ag-icon-loading{animation-duration:1s;animation-iteration-count:infinite;animation-name:spin;animation-timing-function:linear}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.ag-header{background-color:var(--ag-header-background-color);border-bottom:var(--ag-header-row-border);color:var(--ag-header-text-color);display:flex;font-family:var(--ag-header-font-family);font-size:var(--ag-header-font-size);font-weight:var(--ag-header-font-weight);overflow:hidden;white-space:nowrap;width:100%}.ag-header-row{height:var(--ag-header-height);position:absolute}.ag-floating-filter-button-button,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,:where(.ag-header-cell-sortable) .ag-header-cell-label{cursor:pointer}:where(.ag-ltr) .ag-header-expand-icon{margin-left:4px}:where(.ag-rtl) .ag-header-expand-icon{margin-right:4px}.ag-header-row:where(:not(:first-child)){:where(.ag-header-cell:not(.ag-header-span-height.ag-header-span-total,.ag-header-parent-hidden),.ag-header-group-cell.ag-header-group-cell-with-group){border-top:var(--ag-header-row-border)}}.ag-header-row:where(:not(.ag-header-row-column-group)){overflow:hidden}:where(.ag-header.ag-header-allow-overflow) .ag-header-row{overflow:visible}.ag-header-cell{display:inline-flex;overflow:hidden}.ag-header-group-cell{contain:paint;display:flex}.ag-header-cell,.ag-header-group-cell{align-items:center;gap:var(--ag-cell-widget-spacing);height:100%;padding:0 var(--ag-cell-horizontal-padding);position:absolute}@property --ag-internal-moving-color{syntax:"<color>";inherits:false;initial-value:transparent}@property --ag-internal-hover-color{syntax:"<color>";inherits:false;initial-value:transparent}.ag-header-cell:where(:not(.ag-floating-filter)),.ag-header-group-cell{&:before{background-image:linear-gradient(var(--ag-internal-hover-color),var(--ag-internal-hover-color)),linear-gradient(var(--ag-internal-moving-color),var(--ag-internal-moving-color));content:"";inset:0;position:absolute;--ag-internal-moving-color:transparent;--ag-internal-hover-color:transparent;transition:--ag-internal-moving-color var(--ag-header-cell-background-transition-duration),--ag-internal-hover-color var(--ag-header-cell-background-transition-duration)}&:where(:hover):before{--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}&:where(.ag-header-cell-moving):before{--ag-internal-moving-color:var(--ag-header-cell-moving-background-color);--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}}:where(.ag-header-cell:not(.ag-floating-filter) *,.ag-header-group-cell *){position:relative;z-index:1}.ag-header-cell-menu-button:where(:not(.ag-header-menu-always-show)){opacity:0;transition:opacity .2s}.ag-header-cell-filter-button,:where(.ag-header-cell.ag-header-active) .ag-header-cell-menu-button{opacity:1}.ag-header-cell-label,.ag-header-group-cell-label{align-items:center;align-self:stretch;display:flex;flex:1 1 auto;overflow:hidden;padding:5px 0}:where(.ag-ltr) .ag-sort-indicator-icon{padding-left:var(--ag-spacing)}:where(.ag-rtl) .ag-sort-indicator-icon{padding-right:var(--ag-spacing)}.ag-header-cell-label{text-overflow:ellipsis}.ag-header-group-cell-label.ag-sticky-label{flex:none;max-width:100%;overflow:visible;position:sticky}:where(.ag-ltr) .ag-header-group-cell-label.ag-sticky-label{left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-header-group-cell-label.ag-sticky-label{right:var(--ag-cell-horizontal-padding)}.ag-header-cell-text,.ag-header-group-text{overflow:hidden;text-overflow:ellipsis}.ag-header-cell-text{word-break:break-word}.ag-header-cell-comp-wrapper{width:100%}:where(.ag-header-group-cell) .ag-header-cell-comp-wrapper{display:flex}:where(.ag-header-cell:not(.ag-header-cell-auto-height)) .ag-header-cell-comp-wrapper{align-items:center;display:flex;height:100%}.ag-header-cell-wrap-text .ag-header-cell-comp-wrapper{white-space:normal}.ag-header-cell-comp-wrapper-limited-height>*{overflow:hidden}:where(.ag-right-aligned-header) .ag-header-cell-label{flex-direction:row-reverse}:where(.ag-ltr) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-ltr) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}.ag-header-cell:after,.ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{content:"";height:var(--ag-header-column-border-height);position:absolute;top:calc(50% - var(--ag-header-column-border-height)*.5);z-index:1}:where(.ag-ltr) .ag-header-cell:after,:where(.ag-ltr) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-right:var(--ag-header-column-border);right:0}:where(.ag-rtl) .ag-header-cell:after,:where(.ag-rtl) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-left:var(--ag-header-column-border);left:0}.ag-header-highlight-after:after,.ag-header-highlight-before:after{background-color:var(--ag-accent-color);content:"";height:100%;position:absolute;width:1px}:where(.ag-ltr) .ag-header-highlight-before:after{left:0}:where(.ag-rtl) .ag-header-highlight-before:after{right:0}:where(.ag-ltr) .ag-header-highlight-after:after{right:0;:where(.ag-pinned-left-header) &{right:1px}}:where(.ag-rtl) .ag-header-highlight-after:after{left:0;:where(.ag-pinned-left-header) &{left:1px}}.ag-header-cell-resize{align-items:center;cursor:ew-resize;display:flex;height:100%;position:absolute;top:0;width:8px;z-index:2;&:after{background-color:var(--ag-header-column-resize-handle-color);content:"";height:var(--ag-header-column-resize-handle-height);position:absolute;top:calc(50% - var(--ag-header-column-resize-handle-height)*.5);width:var(--ag-header-column-resize-handle-width);z-index:1}}:where(.ag-ltr) .ag-header-cell-resize{right:-3px;&:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-rtl) .ag-header-cell-resize{left:-3px;&:after{right:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-header-cell.ag-header-span-height) .ag-header-cell-resize:after{height:calc(100% - var(--ag-spacing)*4);top:calc(var(--ag-spacing)*2)}.ag-header-group-cell-no-group:where(.ag-header-span-height){display:none}.ag-sort-indicator-container{display:flex;gap:var(--ag-spacing)}.ag-layout-print{&.ag-body{display:block;height:unset}&.ag-root-wrapper{display:inline-block}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:none}&.ag-force-vertical-scroll{overflow-y:visible!important}}@media print{.ag-root-wrapper.ag-layout-print{display:table;.ag-body-horizontal-scroll-viewport,.ag-body-viewport,.ag-center-cols-container,.ag-center-cols-viewport,.ag-root,.ag-root-wrapper-body,.ag-virtual-list-viewport{display:block!important;height:auto!important;overflow:hidden!important}.ag-cell,.ag-row{-moz-column-break-inside:avoid;break-inside:avoid}}}ag-grid,ag-grid-angular{display:block}.ag-root-wrapper{border:var(--ag-wrapper-border);border-radius:var(--ag-wrapper-border-radius);display:flex;flex-direction:column;overflow:hidden;position:relative;&.ag-layout-normal{height:100%}}.ag-root-wrapper-body{display:flex;flex-direction:row;&.ag-layout-normal{flex:1 1 auto;height:0;min-height:0}}.ag-root{display:flex;flex-direction:column;position:relative;&.ag-layout-auto-height,&.ag-layout-normal{flex:1 1 auto;overflow:hidden;width:0}&.ag-layout-normal{height:100%}}.ag-virtual-list-item{height:var(--ag-list-item-height);position:absolute;width:100%}.ag-list-item-hovered:after{background-color:var(--ag-accent-color);content:"";height:1px;left:0;position:absolute;right:0}.ag-item-highlight-top:after{top:0}.ag-item-highlight-bottom:after{bottom:0}.ag-drag-handle{color:var(--ag-drag-handle-color);cursor:grab;:where(.ag-icon){color:var(--ag-drag-handle-color)}}.ag-chart-menu-icon,.ag-chart-settings-next,.ag-chart-settings-prev,.ag-column-group-icons,.ag-column-select-header-icon,.ag-filter-toolpanel-expand,.ag-floating-filter-button-button,.ag-group-title-bar-icon,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,.ag-panel-title-bar-button-icon,.ag-set-filter-group-icons,:where(.ag-group-contracted) .ag-icon,:where(.ag-group-expanded) .ag-icon{background-color:var(--ag-icon-button-background-color);border-radius:var(--ag-icon-button-border-radius);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-background-color);color:var(--ag-icon-button-color);&:hover{background-color:var(--ag-icon-button-hover-background-color);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-hover-background-color);color:var(--ag-icon-button-hover-color)}}.ag-filter-active{background-image:linear-gradient(var(--ag-icon-button-active-background-color),var(--ag-icon-button-active-background-color));border-radius:1px;outline:solid var(--ag-icon-button-background-spread) var(--ag-icon-button-active-background-color);position:relative;&:after{background-color:var(--ag-icon-button-active-indicator-color);border-radius:50%;content:"";height:6px;position:absolute;top:-1px;width:6px}:where(.ag-icon-filter){clip-path:path("M8,0C8,4.415 11.585,8 16,8L16,16L0,16L0,0L8,0Z");color:var(--ag-icon-button-active-color)}}:where(.ag-ltr) .ag-filter-active{&:after{right:-1px}}:where(.ag-rtl) .ag-filter-active{&:after{left:-1px}}.ag-menu{background-color:var(--ag-menu-background-color);border:var(--ag-menu-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-menu-shadow);color:var(--ag-menu-text-color);max-height:100%;overflow-y:auto;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}',kW={wrapperBorder:!0,rowBorder:!0,headerRowBorder:!0,footerRowBorder:{ref:"rowBorder"},columnBorder:{style:"solid",width:1,color:"transparent"},headerColumnBorder:!1,headerColumnBorderHeight:"100%",pinnedColumnBorder:!0,pinnedRowBorder:!0,sidePanelBorder:!0,sideBarPanelWidth:250,sideBarBackgroundColor:{ref:"chromeBackgroundColor"},sideButtonBarBackgroundColor:{ref:"sideBarBackgroundColor"},sideButtonBarTopPadding:0,sideButtonSelectedUnderlineWidth:2,sideButtonSelectedUnderlineColor:"transparent",sideButtonSelectedUnderlineTransitionDuration:0,sideButtonBackgroundColor:"transparent",sideButtonTextColor:{ref:"textColor"},sideButtonHoverBackgroundColor:{ref:"sideButtonBackgroundColor"},sideButtonHoverTextColor:{ref:"sideButtonTextColor"},sideButtonSelectedBackgroundColor:Jt,sideButtonSelectedTextColor:{ref:"sideButtonTextColor"},sideButtonBorder:"solid 1px transparent",sideButtonSelectedBorder:!0,sideButtonLeftPadding:{ref:"spacing"},sideButtonRightPadding:{ref:"spacing"},sideButtonVerticalPadding:{calc:"spacing * 3"},headerBackgroundColor:{ref:"chromeBackgroundColor"},headerFontFamily:{ref:"fontFamily"},cellFontFamily:{ref:"fontFamily"},headerFontWeight:500,headerFontSize:{ref:"fontSize"},dataFontSize:{ref:"fontSize"},headerTextColor:{ref:"textColor"},headerCellHoverBackgroundColor:"transparent",headerCellMovingBackgroundColor:{ref:"headerCellHoverBackgroundColor"},headerCellBackgroundTransitionDuration:"0.2s",cellTextColor:{ref:"textColor"},rangeSelectionBorderStyle:"solid",rangeSelectionBorderColor:xt,rangeSelectionBackgroundColor:wi(.2),rangeSelectionChartBackgroundColor:"#0058FF1A",rangeSelectionChartCategoryBackgroundColor:"#00FF841A",rangeSelectionHighlightColor:wi(.5),rangeHeaderHighlightColor:aB(.08),rowNumbersSelectedColor:wi(.5),rowHoverColor:wi(.08),columnHoverColor:wi(.05),selectedRowBackgroundColor:wi(.12),modalOverlayBackgroundColor:{ref:"backgroundColor",mix:.66},dataBackgroundColor:Jt,oddRowBackgroundColor:{ref:"dataBackgroundColor"},wrapperBorderRadius:8,cellHorizontalPadding:{calc:"spacing * 2 * cellHorizontalPaddingScale"},cellWidgetSpacing:{calc:"spacing * 1.5"},cellHorizontalPaddingScale:1,rowGroupIndentSize:{calc:"cellWidgetSpacing + iconSize"},valueChangeDeltaUpColor:"#43a047",valueChangeDeltaDownColor:"#e53935",valueChangeValueHighlightBackgroundColor:"#16a08580",rowHeight:{calc:"max(iconSize, dataFontSize) + spacing * 3.25 * rowVerticalPaddingScale"},rowVerticalPaddingScale:1,headerHeight:{calc:"max(iconSize, dataFontSize) + spacing * 4 * headerVerticalPaddingScale"},headerVerticalPaddingScale:1,paginationPanelHeight:{ref:"rowHeight",calc:"max(rowHeight, 22px)"},dragHandleColor:_i(.7),headerColumnResizeHandleHeight:"30%",headerColumnResizeHandleWidth:2,headerColumnResizeHandleColor:{ref:"borderColor"},widgetContainerHorizontalPadding:{calc:"spacing * 1.5"},widgetContainerVerticalPadding:{calc:"spacing * 1.5"},widgetHorizontalSpacing:{calc:"spacing * 1.5"},widgetVerticalSpacing:{ref:"spacing"},iconButtonColor:{ref:"iconColor"},iconButtonBackgroundColor:"transparent",iconButtonBackgroundSpread:4,iconButtonBorderRadius:1,iconButtonHoverColor:{ref:"iconButtonColor"},iconButtonHoverBackgroundColor:_i(.1),iconButtonActiveColor:xt,iconButtonActiveBackgroundColor:wi(.28),iconButtonActiveIndicatorColor:xt,menuBorder:{color:_i(.2)},menuBackgroundColor:Xt(.03),menuTextColor:Xt(.95),menuShadow:{ref:"popupShadow"},menuSeparatorColor:{ref:"borderColor"},setFilterIndentSize:{ref:"iconSize"},chartMenuPanelWidth:260,chartMenuLabelColor:_i(.8),dialogShadow:{ref:"popupShadow"},cellEditingBorder:{color:xt},cellEditingShadow:{ref:"cardShadow"},fullRowEditInvalidBackgroundColor:{ref:"invalidColor",onto:"backgroundColor",mix:.25},dialogBorder:{color:_i(.2)},panelBackgroundColor:Jt,panelTitleBarHeight:{ref:"headerHeight"},panelTitleBarBackgroundColor:{ref:"headerBackgroundColor"},panelTitleBarIconColor:{ref:"headerTextColor"},panelTitleBarTextColor:{ref:"headerTextColor"},panelTitleBarFontWeight:{ref:"headerFontWeight"},panelTitleBarBorder:!0,columnSelectIndentSize:{ref:"iconSize"},toolPanelSeparatorBorder:!0,columnDropCellBackgroundColor:_i(.07),columnDropCellTextColor:{ref:"textColor"},columnDropCellDragHandleColor:{ref:"textColor"},columnDropCellBorder:{color:_i(.13)},selectCellBackgroundColor:_i(.07),selectCellBorder:{color:_i(.13)},advancedFilterBuilderButtonBarBorder:!0,advancedFilterBuilderIndentSize:{calc:"spacing * 2 + iconSize"},advancedFilterBuilderJoinPillColor:"#f08e8d",advancedFilterBuilderColumnPillColor:"#a6e194",advancedFilterBuilderOptionPillColor:"#f3c08b",advancedFilterBuilderValuePillColor:"#85c0e4",filterPanelApplyButtonColor:Jt,filterPanelApplyButtonBackgroundColor:xt,filterPanelCardSubtleColor:{ref:"textColor",mix:.7},filterPanelCardSubtleHoverColor:{ref:"textColor"},findMatchColor:ta,findMatchBackgroundColor:"#ffff00",findActiveMatchColor:ta,findActiveMatchBackgroundColor:"#ffa500",filterToolPanelGroupIndent:{ref:"spacing"},rowLoadingSkeletonEffectColor:_i(.15),statusBarLabelColor:ta,statusBarLabelFontWeight:500,statusBarValueColor:ta,statusBarValueFontWeight:500,pinnedSourceRowTextColor:{ref:"textColor"},pinnedSourceRowBackgroundColor:{ref:"dataBackgroundColor"},pinnedSourceRowFontWeight:600,pinnedRowFontWeight:600,pinnedRowBackgroundColor:{ref:"dataBackgroundColor"},pinnedRowTextColor:{ref:"textColor"}},DW=".ag-cell-batch-edit{background-color:var(--ag-cell-batch-edit-background-color);color:var(--ag-cell-batch-edit-text-color);display:inherit}.ag-row-batch-edit{background-color:var(--ag-row-batch-edit-background-color);color:var(--ag-row-batch-edit-text-color)}",U4={cellBatchEditBackgroundColor:"rgba(220 181 139 / 16%)",cellBatchEditTextColor:"#422f00",rowBatchEditBackgroundColor:{ref:"cellBatchEditBackgroundColor"},rowBatchEditTextColor:{ref:"cellBatchEditTextColor"}},FW=_(b({},U4),{cellBatchEditTextColor:"#f3d0b3"}),TW=()=>xi({feature:"batchEditStyle",params:U4,css:DW}),AW=TW(),q4=":where(.ag-button){background:none;border:none;color:inherit;cursor:pointer;font-family:inherit;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0;text-indent:inherit;text-shadow:inherit;text-transform:inherit;word-spacing:inherit;&:disabled{cursor:default}&:focus-visible{box-shadow:var(--ag-focus-shadow);outline:none}}.ag-standard-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:var(--ag-button-background-color);border:var(--ag-button-border);border-radius:var(--ag-button-border-radius);color:var(--ag-button-text-color);cursor:pointer;font-weight:var(--ag-button-font-weight);padding:var(--ag-button-vertical-padding) var(--ag-button-horizontal-padding);&:hover{background-color:var(--ag-button-hover-background-color);border:var(--ag-button-hover-border);color:var(--ag-button-hover-text-color)}&:active{background-color:var(--ag-button-active-background-color);border:var(--ag-button-active-border);color:var(--ag-button-active-text-color)}&:disabled{background-color:var(--ag-button-disabled-background-color);border:var(--ag-button-disabled-border);color:var(--ag-button-disabled-text-color)}}",$4={buttonTextColor:"inherit",buttonFontWeight:"normal",buttonBackgroundColor:"transparent",buttonBorder:!1,buttonBorderRadius:{ref:"borderRadius"},buttonHorizontalPadding:{calc:"spacing * 2"},buttonVerticalPadding:{ref:"spacing"},buttonHoverTextColor:{ref:"buttonTextColor"},buttonHoverBackgroundColor:{ref:"buttonBackgroundColor"},buttonHoverBorder:{ref:"buttonBorder"},buttonActiveTextColor:{ref:"buttonHoverTextColor"},buttonActiveBackgroundColor:{ref:"buttonHoverBackgroundColor"},buttonActiveBorder:{ref:"buttonHoverBorder"},buttonDisabledTextColor:{ref:"inputDisabledTextColor"},buttonDisabledBackgroundColor:{ref:"inputDisabledBackgroundColor"},buttonDisabledBorder:{ref:"inputDisabledBorder"}};var IW=()=>xi({feature:"buttonStyle",params:_(b({},$4),{buttonBackgroundColor:Jt,buttonBorder:!0,buttonHoverBackgroundColor:{ref:"rowHoverColor"},buttonActiveBorder:{color:xt}}),css:q4}),LW=IW(),_W=()=>xi({feature:"buttonStyle",params:_(b({},$4),{buttonBackgroundColor:Jt,buttonBorder:{color:xt},buttonFontWeight:600,buttonTextColor:xt,buttonHoverBackgroundColor:{ref:"rowHoverColor"},buttonActiveBackgroundColor:xt,buttonActiveTextColor:Jt}),css:q4}),OW=_W();var NW=".ag-column-drop-vertical-empty-message{align-items:center;border:dashed var(--ag-border-width);border-color:var(--ag-border-color);display:flex;inset:0;justify-content:center;margin:calc(var(--ag-spacing)*1.5) calc(var(--ag-spacing)*2);overflow:hidden;padding:calc(var(--ag-spacing)*2);position:absolute}";var BW=()=>xi({feature:"columnDropStyle",css:NW}),Iv=BW();var HW={warn:(...e)=>{I(e[0],e[1])},error:(...e)=>{Ge(e[0],e[1])},preInitErr:(...e)=>{ql(e[0],e[2],e[1])}},j4=()=>vB(HW).withParams(kW).withPart(LW).withPart(Iv).withPart(AW),GW='.ag-checkbox-input-wrapper,.ag-radio-button-input-wrapper{background-color:var(--ag-checkbox-unchecked-background-color);border:solid var(--ag-checkbox-border-width) var(--ag-checkbox-unchecked-border-color);flex:none;height:var(--ag-icon-size);position:relative;width:var(--ag-icon-size);:where(input){-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:block;height:var(--ag-icon-size);margin:0;opacity:0;width:var(--ag-icon-size)}&:after{content:"";display:block;inset:0;-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;pointer-events:none;position:absolute}&:where(.ag-checked){background-color:var(--ag-checkbox-checked-background-color);border-color:var(--ag-checkbox-checked-border-color);&:after{background-color:var(--ag-checkbox-checked-shape-color)}}&:where(:focus-within,:active){box-shadow:var(--ag-focus-shadow)}&:where(.ag-disabled){filter:grayscale();opacity:.5}}.ag-checkbox-input-wrapper{border-radius:var(--ag-checkbox-border-radius);&:where(.ag-checked):after{-webkit-mask-image:var(--ag-checkbox-checked-shape-image);mask-image:var(--ag-checkbox-checked-shape-image)}&:where(.ag-indeterminate){background-color:var(--ag-checkbox-indeterminate-background-color);border-color:var(--ag-checkbox-indeterminate-border-color);&:after{background-color:var(--ag-checkbox-indeterminate-shape-color);-webkit-mask-image:var(--ag-checkbox-indeterminate-shape-image);mask-image:var(--ag-checkbox-indeterminate-shape-image)}}}.ag-cell-editing-error .ag-checkbox-input-wrapper:focus-within{box-shadow:var(--ag-focus-error-shadow)}.ag-radio-button-input-wrapper{border-radius:100%;&:where(.ag-checked):after{-webkit-mask-image:var(--ag-radio-checked-shape-image);mask-image:var(--ag-radio-checked-shape-image)}}',VW=()=>xi({feature:"checkboxStyle",params:{checkboxBorderWidth:1,checkboxBorderRadius:{ref:"borderRadius"},checkboxUncheckedBackgroundColor:Jt,checkboxUncheckedBorderColor:Xt(.3),checkboxCheckedBackgroundColor:xt,checkboxCheckedBorderColor:{ref:"checkboxCheckedBackgroundColor"},checkboxCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="7" fill="none"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75" d="M1 3.5 3.5 6l5-5"/></svg>'},checkboxCheckedShapeColor:Jt,checkboxIndeterminateBackgroundColor:Xt(.3),checkboxIndeterminateBorderColor:{ref:"checkboxIndeterminateBackgroundColor"},checkboxIndeterminateShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="2" fill="none"><rect width="10" height="2" fill="#000" rx="1"/></svg>'},checkboxIndeterminateShapeColor:Jt,radioCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="6" height="6" fill="none"><circle cx="3" cy="3" r="3" fill="#000"/></svg>'}},css:GW}),K4=VW();var Y4=()=>_(b(b({},bp),FW),{backgroundColor:"hsl(217, 0%, 17%)",foregroundColor:"#FFF",chromeBackgroundColor:Xt(.05),rowHoverColor:wi(.15),selectedRowBackgroundColor:wi(.2),menuBackgroundColor:Xt(.1),browserColorScheme:"dark",popupShadow:"0 0px 20px #000A",cardShadow:"0 1px 4px 1px #000A",advancedFilterBuilderJoinPillColor:"#7a3a37",advancedFilterBuilderColumnPillColor:"#355f2d",advancedFilterBuilderOptionPillColor:"#5a3168",advancedFilterBuilderValuePillColor:"#374c86",filterPanelApplyButtonColor:ta,findMatchColor:Jt,findActiveMatchColor:Jt,checkboxUncheckedBorderColor:Xt(.4),toggleButtonOffBackgroundColor:Xt(.4),rowBatchEditBackgroundColor:Xt(.1)});var zW=()=>_(b({},Y4()),{backgroundColor:"#1f2836"});var WW=()=>xi({feature:"colorScheme",params:bp,modeParams:{light:bp,dark:Y4(),"dark-blue":zW()}}),X4=WW();var UW=`.ag-icon-aggregation:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M24 6H8v2l8 8-8 8v2h16v-2H11l8-8-8-8h13z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-arrows:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M7.515 11.171 2.687 16l4.828 4.829-1.414 1.414L-.142 16l6.243-6.243zm16.97 0 1.414-1.414L32.142 16l-6.243 6.243-1.414-1.414L29.313 16zM16.028 13.2l2.829 2.828-2.829 2.829-2.828-2.829zm-4.857 11.285L16 29.313l4.829-4.828 1.414 1.414L16 32.142l-6.243-6.243zm0-16.97L9.757 6.101 16-.142l6.243 6.243-1.414 1.414L16 2.687z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-asc:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m5.333 16 1.88 1.88 7.453-7.44v16.227h2.667V10.44l7.44 7.453L26.666 16 15.999 5.333 5.332 16z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-cancel:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M16 2.667A13.32 13.32 0 0 0 2.667 16c0 7.373 5.96 13.333 13.333 13.333S29.333 23.373 29.333 16 23.373 2.667 16 2.667m6.667 18.12-1.88 1.88L16 17.88l-4.787 4.787-1.88-1.88L14.12 16l-4.787-4.787 1.88-1.88L16 14.12l4.787-4.787 1.88 1.88L17.88 16z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-chart:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Ctitle%3Echart%3C/title%3E%3Cg fill='%23000' fill-rule='nonzero'%3E%3Cpath d='M14 7h4v18h-4zM8 17h4v8H8zM20 13h4v12h-4z'/%3E%3C/g%3E%3C/svg%3E")}.ag-icon-color-picker:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M23.907 17.587 10.574 4.254l-1.88 1.88 3.173 3.173-8.28 8.28 10.16 10.16zm-16.547 0 6.387-6.387 6.387 6.387zm18.387 2s-2.667 2.893-2.667 4.667c0 1.467 1.2 2.667 2.667 2.667s2.667-1.2 2.667-2.667c0-1.773-2.667-4.667-2.667-4.667' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-columns:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M26 25H6V7h20zM12 11H8v12h4zm6 0h-4v12h4zm6 12V11h-4v12z' style='fill-rule:nonzero' transform='translate(0 -1)'/%3E%3C/svg%3E")}.ag-icon-contracted:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m12 6 10 10-10 10-2-2 8-8-8-8z'/%3E%3C/svg%3E")}.ag-icon-copy:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M22 1.333H6A2.675 2.675 0 0 0 3.333 4v18.667H6V4h16zm4 5.334H11.333a2.675 2.675 0 0 0-2.667 2.667v18.667c0 1.467 1.2 2.667 2.667 2.667H26c1.467 0 2.667-1.2 2.667-2.667V9.334c0-1.467-1.2-2.667-2.667-2.667M26 28H11.333V9.333H26z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-cross:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M15.984 13.894 27.05 2.828l2.122 2.122-11.066 11.066 11.066 11.066-2.122 2.12-11.066-11.066L4.918 29.202l-2.12-2.12 11.066-11.066L2.798 4.95l2.12-2.122z'/%3E%3C/svg%3E")}.ag-icon-csv:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M384 131.9c-7.753-8.433-110.425-128.473-114.9-133L48-.1C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48zm-35.9 2.1H257V27.9zM30 479V27h200l1 105c0 13.3-1.3 29 12 29h111l1 318z' style='fill-rule:nonzero' transform='translate(3.934 -.054)scale(.06285)'/%3E%3Cpath d='M.688-.226a.2.2 0 0 1-.017.074.28.28 0 0 1-.145.14.412.412 0 0 1-.234.013.28.28 0 0 1-.202-.168.468.468 0 0 1-.04-.19q0-.086.025-.155a.319.319 0 0 1 .182-.191.4.4 0 0 1 .134-.025q.087 0 .155.035a.3.3 0 0 1 .104.085.17.17 0 0 1 .036.097.06.06 0 0 1-.018.044.06.06 0 0 1-.042.019.06.06 0 0 1-.042-.013.2.2 0 0 1-.031-.046.2.2 0 0 0-.066-.079.16.16 0 0 0-.095-.027.17.17 0 0 0-.142.068.3.3 0 0 0-.053.193.4.4 0 0 0 .023.139.2.2 0 0 0 .067.083.2.2 0 0 0 .1.027q.063 0 .106-.031a.2.2 0 0 0 .065-.091.2.2 0 0 1 .023-.046q.014-.018.044-.018a.06.06 0 0 1 .044.018.06.06 0 0 1 .019.045' style='fill-rule:nonzero' transform='matrix(8.39799 0 0 12.455 7.122 25.977)'/%3E%3Cpath d='M.622-.215a.2.2 0 0 1-.033.117.23.23 0 0 1-.098.081.4.4 0 0 1-.153.029.34.34 0 0 1-.175-.04.23.23 0 0 1-.079-.077.17.17 0 0 1-.031-.093q0-.027.019-.045a.06.06 0 0 1 .046-.019.06.06 0 0 1 .039.014.1.1 0 0 1 .027.044.3.3 0 0 0 .03.057q.015.023.044.038.03.015.076.015.065 0 .105-.03a.09.09 0 0 0 .04-.075.08.08 0 0 0-.022-.058.14.14 0 0 0-.056-.034 1 1 0 0 0-.092-.025.7.7 0 0 1-.129-.042.2.2 0 0 1-.083-.066.17.17 0 0 1-.03-.104q0-.058.032-.105a.2.2 0 0 1 .093-.07.4.4 0 0 1 .144-.025q.066 0 .114.016a.3.3 0 0 1 .08.044.2.2 0 0 1 .046.057q.015.03.015.058a.07.07 0 0 1-.018.046.06.06 0 0 1-.046.021q-.025 0-.038-.012a.2.2 0 0 1-.028-.041.2.2 0 0 0-.047-.063Q.387-.625.326-.625a.15.15 0 0 0-.09.025q-.035.024-.035.059 0 .021.012.037a.1.1 0 0 0 .032.027.4.4 0 0 0 .111.036q.06.015.11.031.048.018.083.042a.2.2 0 0 1 .054.062.2.2 0 0 1 .019.091' style='fill-rule:nonzero' transform='matrix(8.39799 0 0 12.455 13.339 25.977)'/%3E%3Cpath d='m.184-.633.162.48.163-.483q.013-.038.019-.053a.062.062 0 0 1 .061-.039q.018 0 .034.009a.1.1 0 0 1 .025.025q.009.015.009.031L.654-.64l-.007.025-.009.024-.173.468-.019.051a.2.2 0 0 1-.021.042.1.1 0 0 1-.033.03.1.1 0 0 1-.049.012.1.1 0 0 1-.05-.011A.1.1 0 0 1 .26-.03a.2.2 0 0 1-.021-.042L.22-.123.05-.587.041-.612.033-.638.03-.662q0-.025.02-.046a.07.07 0 0 1 .05-.02q.037 0 .053.023.015.023.031.072' style='fill-rule:nonzero' transform='matrix(8.39799 0 0 12.455 18.94 25.977)'/%3E%3C/svg%3E")}.ag-icon-cut:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M13.775 15.198 3.835 2.945a1.501 1.501 0 0 1 2.33-1.89l14.997 18.488A6.003 6.003 0 0 1 29.657 25c0 3.311-2.688 6-6 6s-6-2.689-6-6c0-1.335.437-2.569 1.176-3.566l-3.127-3.855-3.001 3.7A5.97 5.97 0 0 1 14 25c0 3.311-2.689 6-6 6s-6-2.689-6-6a6.003 6.003 0 0 1 8.315-5.536zm9.882 6.702a3.1 3.1 0 0 0-3.1 3.1c0 1.711 1.389 3.1 3.1 3.1s3.1-1.389 3.1-3.1-1.389-3.1-3.1-3.1M8 21.95a3.05 3.05 0 1 0 .001 6.101A3.05 3.05 0 0 0 8 21.95m9.63-11.505 1.932 2.381 8.015-9.881a1.5 1.5 0 0 0-2.329-1.89z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-desc:before,.ag-icon-down:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m26.667 16-1.88-1.88-7.453 7.44V5.333h-2.667V21.56l-7.44-7.453L5.334 16l10.667 10.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-excel:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M384 131.9c-7.753-8.433-110.425-128.473-114.9-133L48-.1C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48zm-35.9 2.1H257V27.9zM30 479V27h200l1 105c0 13.3-1.3 29 12 29h111l1 318z' style='fill-rule:nonzero' transform='translate(3.934 -.054)scale(.06285)'/%3E%3Cpath d='m.052-.139.16-.234-.135-.208a.4.4 0 0 1-.028-.052.1.1 0 0 1-.01-.042.05.05 0 0 1 .018-.037.07.07 0 0 1 .045-.016q.03 0 .047.018a1 1 0 0 1 .047.066l.107.174.115-.174.024-.038.019-.026.021-.015a.1.1 0 0 1 .027-.005.06.06 0 0 1 .044.016.05.05 0 0 1 .018.039q0 .033-.038.089l-.141.211.152.234a.3.3 0 0 1 .03.051.1.1 0 0 1 .009.038.1.1 0 0 1-.008.031.1.1 0 0 1-.024.023.1.1 0 0 1-.034.008.1.1 0 0 1-.035-.008.1.1 0 0 1-.023-.022L.427-.067.301-.265l-.134.204-.022.034-.016.019a.1.1 0 0 1-.022.015.1.1 0 0 1-.03.005.06.06 0 0 1-.044-.016.06.06 0 0 1-.017-.047q0-.036.036-.088' style='fill-rule:nonzero' transform='matrix(17.82892 0 0 16.50777 10.371 25.928)'/%3E%3C/svg%3E")}.ag-icon-expanded:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M20 26 10 16 20 6l2 2-8 8 8 8z'/%3E%3C/svg%3E")}.ag-icon-eye-slash:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Ctitle%3Eeye-slash%3C/title%3E%3Cpath fill='%23000' fill-rule='nonzero' d='M8.95 10.364 7 8.414 8.414 7l2.32 2.32A13.2 13.2 0 0 1 16.5 8c5.608 0 10.542 3.515 12.381 8.667L29 17l-.119.333a13 13 0 0 1-4.255 5.879l1.466 1.466-1.414 1.414-1.754-1.753A13.2 13.2 0 0 1 16.5 26c-5.608 0-10.542-3.515-12.381-8.667L4 17l.119-.333a13 13 0 0 1 4.83-6.303m1.445 1.445A11.02 11.02 0 0 0 6.148 17c1.646 4.177 5.728 7 10.352 7 1.76 0 3.441-.409 4.94-1.146l-1.878-1.878A5.06 5.06 0 0 1 16.5 22c-2.789 0-5.05-2.239-5.05-5 0-1.158.398-2.223 1.065-3.07zm1.855-.974 1.794 1.795A5.07 5.07 0 0 1 16.5 12c2.789 0 5.05 2.239 5.05 5 0 .9-.24 1.745-.661 2.474l2.305 2.306A11 11 0 0 0 26.852 17c-1.646-4.177-5.728-7-10.352-7-1.495 0-2.933.295-4.25.835'/%3E%3C/svg%3E")}.ag-icon-eye:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M16.5 23c4.624 0 8.706-2.823 10.352-7-1.646-4.177-5.728-7-10.352-7s-8.706 2.823-10.352 7c1.646 4.177 5.728 7 10.352 7M4.119 15.667C5.958 10.515 10.892 7 16.5 7s10.542 3.515 12.381 8.667L29 16l-.119.333C27.042 21.485 22.108 25 16.5 25S5.958 21.485 4.119 16.333L4 16zM16.5 21c2.789 0 5.049-2.239 5.049-5s-2.26-5-5.049-5-5.049 2.239-5.049 5 2.26 5 5.049 5' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-filter:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m28 8-8 8v5l-6 6V16L6 8V6h22zM9 8l7 7v7l2-2v-5l7-7z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-first:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M24.273 22.12 18.153 16l6.12-6.12L22.393 8l-8 8 8 8zM7.727 8h2.667v16H7.727z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-group:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M14 7v1H9V7zm0-3v1H5.001V4zm-7 7H5v-1h2zm0-3H5V7h2zM3 5H1V4h2zm11 5v1H9v-1zm-7 4H5v-1h2zm7-1v1H9v-1z' style='fill-rule:nonzero' transform='matrix(2 0 0 2 0 -2)'/%3E%3C/svg%3E")}.ag-icon-last:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m7.727 9.88 6.12 6.12-6.12 6.12L9.607 24l8-8-8-8zM21.607 8h2.667v16h-2.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-left:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M26.667 14.667H10.44l7.453-7.453L16 5.334 5.333 16.001 16 26.668l1.88-1.88-7.44-7.453h16.227z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-linked:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M5.2 16a4.136 4.136 0 0 1 4.133-4.133h5.333V9.334H9.333a6.67 6.67 0 0 0-6.667 6.667 6.67 6.67 0 0 0 6.667 6.667h5.333v-2.533H9.333A4.136 4.136 0 0 1 5.2 16.002zm5.467 1.333h10.667v-2.667H10.667zm12-8h-5.333v2.533h5.333a4.136 4.136 0 0 1 4.133 4.133 4.136 4.136 0 0 1-4.133 4.133h-5.333v2.533h5.333a6.67 6.67 0 0 0 6.667-6.667 6.67 6.67 0 0 0-6.667-6.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-loading:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M17 29h-2v-8h2zm-3.586-9L7 26.414 5.586 25 12 18.586zm13 5L25 26.414 18.586 20 20 18.586zM29 17h-8v-2h8zm-18 0H3v-2h8zm2.414-5L12 13.414 5.586 7 7 5.586zm13-5L20 13.414 18.586 12 25 5.586zM17 11h-2V3h2z' style='fill-rule:nonzero' transform='translate(-3.692 -3.692)scale(1.23077)'/%3E%3C/svg%3E")}.ag-icon-maximize:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M14 30H2V18h2.828v7.05l8.254-8.252 2.12 2.12-8.252 8.254H14zm4-28h12v12h-2.828V6.95l-8.254 8.252-2.12-2.12 8.252-8.254H18z'/%3E%3C/svg%3E")}.ag-icon-menu:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M20 13H0v-2h20zm0-6H0V5h20zm0-6H0v-2h20z' style='fill-rule:nonzero' transform='translate(6 9)'/%3E%3C/svg%3E")}.ag-icon-menu-alt:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='%23000' d='M16 19a3 3 0 1 0 0-6 3 3 0 0 0 0 6M16 11a3 3 0 1 0 0-6 3 3 0 0 0 0 6M16 27a3 3 0 1 0 0-6 3 3 0 0 0 0 6'/%3E%3C/svg%3E")}.ag-icon-minimize:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M2 18h12v12h-2.828v-7.05l-8.254 8.252-2.12-2.12 8.252-8.254H2zm28-4H18V2h2.828v7.05L29.082.798l2.12 2.12-8.252 8.254H30z'/%3E%3C/svg%3E")}.ag-icon-minus:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M6.572 6.572a13.32 13.32 0 0 0 0 18.856 13.32 13.32 0 0 0 18.856 0 13.32 13.32 0 0 0 0-18.856 13.32 13.32 0 0 0-18.856 0m17.527 8.099v2.658H7.901v-2.658z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-next:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M10.94 6 9.06 7.88 17.167 16 9.06 24.12 10.94 26l10-10z' style='fill-rule:nonzero' transform='translate(1)'/%3E%3C/svg%3E")}.ag-icon-none:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Ctitle%3Enone%3C/title%3E%3Cg fill='%23000' fill-rule='nonzero'%3E%3Cpath d='M23.708 14.645 16 6.939l-7.708 7.706 1.416 1.416L16 9.767l6.292 6.294zM23.708 20.355 16 28.061l-7.708-7.706 1.416-1.416L16 25.233l6.292-6.294z'/%3E%3C/g%3E%3C/svg%3E")}.ag-icon-not-allowed:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M16 2.667C8.64 2.667 2.667 8.64 2.667 16S8.64 29.333 16 29.333 29.333 23.36 29.333 16 23.36 2.667 16 2.667M5.333 16c0-5.893 4.773-10.667 10.667-10.667 2.467 0 4.733.84 6.533 2.253L7.586 22.533A10.54 10.54 0 0 1 5.333 16M16 26.667c-2.467 0-4.733-.84-6.533-2.253L24.414 9.467A10.54 10.54 0 0 1 26.667 16c0 5.893-4.773 10.667-10.667 10.667' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-paste:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M25.334 4H19.76C19.2 2.453 17.733 1.333 16 1.333S12.8 2.453 12.24 4H6.667A2.675 2.675 0 0 0 4 6.667V28c0 1.467 1.2 2.667 2.667 2.667h18.667c1.467 0 2.667-1.2 2.667-2.667V6.667C28.001 5.2 26.801 4 25.334 4M16 4c.733 0 1.333.6 1.333 1.333s-.6 1.333-1.333 1.333-1.333-.6-1.333-1.333S15.267 4 16 4m9.333 24H6.666V6.667h2.667v4h13.333v-4h2.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-pin:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m10.78 19.777-4.668-4.666s.032-1 .67-1.87c1.366-1.86 4.052-1.96 6.056-1.572l3.158-3.108c-.7-2.342 3.352-5.046 3.352-5.046l9.166 9.168q-.334.447-.67.894c-1.074 1.426-2.538 2.63-4.272 2.338l-3.32 3.218c.046.344.042.03.118 1.152.144 2.13-.64 4.324-2.632 5.34l-.746.364-4.798-4.798-7.292 7.294-1.416-1.416zm8.24-13.672c-.688.568-1.416 1.45-1.024 2.072l.49.722-4.986 4.988c-1.988-.506-4.346-.636-5.156.614l9.02 9.032q.14-.099.272-.21c1.226-1.08.764-3.04.498-4.9l4.79-4.79s1.47.938 2.936-.776l-6.79-6.79q-.026.019-.05.038' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-pivot:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M25.128 2.002c2.56.096 4.772 2.292 4.87 4.87a712 712 0 0 1 0 18.256c-.096 2.56-2.292 4.772-4.87 4.87a712 712 0 0 1-18.256 0c-2.558-.096-4.772-2.29-4.87-4.87a712 712 0 0 1 0-18.256c.096-2.56 2.292-4.772 4.87-4.87a712 712 0 0 1 18.256 0m2.966 7.954H9.892v18.136c5.086.13 10.18.098 15.264-.096 1.48-.094 2.746-1.35 2.84-2.84.192-5.064.226-10.134.098-15.2M3.968 24.1q.015.528.036 1.056c.094 1.484 1.354 2.746 2.84 2.84l1.012.036V24.1zM22 15.414l-.292.294-1.416-1.416L23 11.586l2.708 2.706-1.416 1.416-.292-.294v3.592c-.032 2.604-2.246 4.892-4.872 4.992L15.414 24l.294.292-1.416 1.416L11.586 23l2.706-2.708 1.416 1.416-.322.32c3.372.03 6.578-.164 6.614-3.034zM3.88 18.038c.002 1.346.012 2.694.038 4.04h3.938v-4.04zm.05-6.062a681 681 0 0 0-.044 4.042h3.97v-4.042zm5.962-7.99Q8.449 3.999 7.006 4c-1.57.02-2.946 1.348-3.004 2.922q-.02 1.517-.042 3.034h3.896v-2.02h2.036zm14.244-.016v3.966h3.898q-.017-.546-.038-1.092c-.094-1.48-1.35-2.746-2.84-2.84q-.51-.019-1.02-.034m-8.14-.054q-2.035.022-4.07.048v3.972h4.07zm6.106.008a213 213 0 0 0-4.07-.022v4.034h4.07z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-plus:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M6.572 6.572a13.32 13.32 0 0 0 0 18.856 13.32 13.32 0 0 0 18.856 0 13.32 13.32 0 0 0 0-18.856 13.32 13.32 0 0 0-18.856 0m17.527 8.099v2.658h-6.77v6.77h-2.658v-6.77h-6.77v-2.658h6.77v-6.77h2.658v6.77z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-previous:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M21.94 7.88 20.06 6l-10 10 10 10 1.88-1.88L13.833 16z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-right:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m16 5.333-1.88 1.88 7.44 7.453H5.333v2.667H21.56l-7.44 7.453 1.88 1.88 10.667-10.667L16 5.332z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-save:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M15.708 2.355 8 10.061.292 2.355 1.708.939 8 7.233 14.292.939z' style='fill-rule:nonzero' transform='translate(8 14)'/%3E%3Cpath d='M5 26h22v2H5zM15 4h2v18h-2z'/%3E%3C/svg%3E")}.ag-icon-small-down:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M7.334 10.667 16 21.334l8.667-10.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-small-left:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M21.333 7.334 10.666 16l10.667 8.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-small-right:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M10.667 24.666 21.334 16 10.667 7.333z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-small-up:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M7.334 21.333 16 10.666l8.667 10.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-tick:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M11.586 22.96 27.718 6.828 29.84 8.95 11.586 27.202 2.4 18.016l2.12-2.122z'/%3E%3C/svg%3E")}.ag-icon-tree-closed:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m11.94 6-1.88 1.88L18.167 16l-8.107 8.12L11.94 26l10-10z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-tree-indeterminate:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M6 13.5h20v3H6z'/%3E%3C/svg%3E")}.ag-icon-tree-open:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M24.12 9.06 16 17.167 7.88 9.06 6 10.94l10 10 10-10z' style='fill-rule:nonzero' transform='translate(0 1)'/%3E%3C/svg%3E")}.ag-icon-unlinked:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M22.667 9.333h-5.333v2.533h5.333a4.136 4.136 0 0 1 4.133 4.133c0 1.907-1.307 3.507-3.08 3.973l1.947 1.947c2.173-1.107 3.667-3.32 3.667-5.92a6.67 6.67 0 0 0-6.667-6.667zm-1.334 5.334h-2.92l2.667 2.667h.253zM2.667 5.693 6.814 9.84A6.65 6.65 0 0 0 2.667 16a6.67 6.67 0 0 0 6.667 6.667h5.333v-2.533H9.334a4.136 4.136 0 0 1-4.133-4.133c0-2.12 1.613-3.867 3.68-4.093l2.76 2.76h-.973v2.667h3.64l3.027 3.027v2.307h2.307l5.347 5.333 1.68-1.68L4.362 4.002 2.669 5.695z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-up:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m5.333 16 1.88 1.88 7.453-7.44v16.227h2.667V10.44l7.44 7.453L26.666 16 15.999 5.333 5.332 16z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-grip:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M8 24H6v-4h2zm6 0h-2v-4h2zm6 0h-2v-4h2zm6 0h-2v-4h2zM8 18H6v-4h2zm6 0h-2v-4h2zm6 0h-2v-4h2zm6 0h-2v-4h2zM8 12H6V8h2zm6 0h-2V8h2zm6 0h-2V8h2zm6 0h-2V8h2z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-settings:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='%23000' d='M30 8h-4.1c-.5-2.3-2.5-4-4.9-4s-4.4 1.7-4.9 4H2v2h14.1c.5 2.3 2.5 4 4.9 4s4.4-1.7 4.9-4H30zm-9 4c-1.7 0-3-1.3-3-3s1.3-3 3-3 3 1.3 3 3-1.3 3-3 3M2 24h4.1c.5 2.3 2.5 4 4.9 4s4.4-1.7 4.9-4H30v-2H15.9c-.5-2.3-2.5-4-4.9-4s-4.4 1.7-4.9 4H2zm9-4c1.7 0 3 1.3 3 3s-1.3 3-3 3-3-1.3-3-3 1.3-3 3-3'/%3E%3C/svg%3E")}.ag-icon-column-arrow:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M11 4a1 1 0 0 1 1 1v22a1 1 0 1 1-2 0V5a1 1 0 0 1 1-1' clip-rule='evenodd'/%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M2 13a1 1 0 0 1 1-1h23.5a1 1 0 1 1 0 2H3a1 1 0 0 1-1-1' clip-rule='evenodd'/%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M2 4h18v24H2zm2 2v20h14V6zM26.793 13 23 9.207l1.414-1.414L29.621 13l-5.207 5.207L23 16.793z' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-un-pin:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='m6.112 15.111 3.272 3.271 1.436-1.402-2.476-2.479c.81-1.25 3.168-1.12 5.156-.614l4.986-4.988-.49-.722c-.392-.622.336-1.504 1.024-2.072l.008-.007.01-.006.032-.025 1.447 1.447 1.432-1.397-2.601-2.602s-4.052 2.704-3.352 5.046l-3.158 3.108c-2.004-.388-4.69-.288-6.056 1.572-.638.87-.67 1.87-.67 1.87m.581 11.582.014.014 5.502-5.501 4.783 4.783.746-.364c1.992-1.016 2.776-3.21 2.632-5.34-.055-.805-.068-.87-.088-.97-.008-.04-.017-.085-.03-.182l3.32-3.218c1.734.292 3.198-.912 4.272-2.338q.337-.447.67-.894l-.001-.001-.007-.007-.007-.007-.007-.007-3.87-3.87 1.585-1.584-1.414-1.414-14.381 14.38-1.237 1.209-5.69 5.687 1.417 1.416zM23.21 10.206l2.65 2.651c-1.465 1.714-2.935.776-2.935.776l-4.79 4.79q.041.291.087.583c.257 1.676.513 3.35-.585 4.317a4 4 0 0 1-.272.21l-3.739-3.744z' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-pinned-top:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' d='m16.708 10.878 8.708 8.706L24 21l-6.292-6.294V27h-2V14.706L9.416 21 8 19.584q4.348-4.344 8.691-8.69zM25 6H8v2h17z'/%3E%3C/svg%3E")}.ag-icon-pinned-bottom:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' d='M16.708 22.122 8 13.416 9.416 12l6.292 6.294V6h2v12.294L24 12l1.416 1.416-8.691 8.69zM7.416 28h17v-2h-17z'/%3E%3C/svg%3E")}.ag-icon-chevron-up:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' viewBox='0 0 16 16'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M3.479 10.521a.75.75 0 0 1 0-1.06l4-4a.75.75 0 0 1 1.06 0l4 4a.75.75 0 0 1-1.06 1.06l-3.47-3.47-3.47 3.47a.75.75 0 0 1-1.06 0' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-chevron-down:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' viewBox='0 0 16 16'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M12.521 5.461a.75.75 0 0 1 0 1.06l-4 4a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 0 1 1.06-1.06l3.47 3.47 3.47-3.47a.75.75 0 0 1 1.06 0' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-chevron-left:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' viewBox='0 0 16 16'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M10.53 12.512a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 0 1 0-1.06l4-4a.75.75 0 0 1 1.06 1.06l-3.47 3.47 3.47 3.47a.75.75 0 0 1 0 1.06' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-chevron-right:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' viewBox='0 0 16 16'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M5.47 3.47a.75.75 0 0 1 1.06 0l4 4a.75.75 0 0 1 0 1.06l-4 4a.75.75 0 0 1-1.06-1.06L8.94 8 5.47 4.53a.75.75 0 0 1 0-1.06' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-filter-add:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' d='M19.834 8H8c0 .304.06.612.258.842 2.716 2.854 6.682 5.548 6.742 7.974V21l2-1.5v-2.684c.056-2.267 2.968-4.417 5.49-6.75v3.087c-1.081.974-2.245 1.968-3.232 3.005a1.05 1.05 0 0 0-.258.682v3.66L13 25c0-2.74.066-5.482-.002-8.222a1.05 1.05 0 0 0-.256-.62C10.026 13.304 6.06 10.61 6 8.184V6h13.834z'/%3E%3Cpath fill='currentColor' d='M26 6h2.946v2.002H26v3.313h-2.002V8.002h-2.946V6h2.946V3.04H26z'/%3E%3C/svg%3E")}.ag-icon-edit:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' d='M6.222 25.778h1.611l14.834-14.811-1.611-1.611-14.834 14.81zM4 28v-4.733L22.644 4.656a2.26 2.26 0 0 1 1.567-.634q.423 0 .833.167.412.166.734.478l1.589 1.6q.333.322.483.733t.15.822q0 .423-.161.839-.162.416-.472.728L8.733 28zm17.856-17.833-.8-.811 1.61 1.61z'/%3E%3C/svg%3E")}`,qW=xi({feature:"iconSet",css:UW});var J4={aggregation:'<path d="M18 7V4H6l6 8-6 8h12v-3"/>',arrows:'<polyline points="5 9 2 12 5 15"/><polyline points="9 5 12 2 15 5"/><polyline points="15 19 12 22 9 19"/><polyline points="19 9 22 12 19 15"/><line x1="2" x2="22" y1="12" y2="12"/><line x1="12" x2="12" y1="2" y2="22"/>',asc:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',cancel:'<path d="m18 6-12 12"/><path d="m6 6 12 12"/>',chart:'<line x1="18" x2="18" y1="20" y2="10"/><line x1="12" x2="12" y1="20" y2="4"/><line x1="6" x2="6" y1="20" y2="14"/>',"color-picker":'<path d="m19 11-8-8-8.6 8.6a2 2 0 0 0 0 2.8l5.2 5.2c.8.8 2 .8 2.8 0L19 11Z"/><path d="m5 2 5 5"/><path d="M2 13h15"/><path d="M22 20a2 2 0 1 1-4 0c0-1.6 1.7-2.4 2-4 .3 1.6 2 2.4 2 4Z"/>',columns:'<path d="M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18"/>',contracted:'<path d="m9 18 6-6-6-6"/>',copy:'<rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/>',cross:'<path d="M18 6 6 18"/><path d="m6 6 12 12"/>',csv:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',cut:'<circle cx="6" cy="6" r="3"/><path d="M8.12 8.12 12 12"/><path d="M20 4 8.12 15.88"/><circle cx="6" cy="18" r="3"/><path d="M14.8 14.8 20 20"/>',desc:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',down:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',excel:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',expanded:'<path d="m15 18-6-6 6-6"/>',"eye-slash":'<path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"/><line x1="2" x2="22" y1="2" y2="22"/>',eye:'<path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/>',filter:'<path d="M3 6h18"/><path d="M7 12h10"/><path d="M10 18h4"/>',first:'<path d="m17 18-6-6 6-6"/><path d="M7 6v12"/>',group:'<path d="M16 12H3"/><path d="M16 18H3"/><path d="M10 6H3"/><path d="M21 18V8a2 2 0 0 0-2-2h-5"/><path d="m16 8-2-2 2-2"/>',last:'<path d="m7 18 6-6-6-6"/><path d="M17 6v12"/>',left:'<path d="m12 19-7-7 7-7"/><path d="M19 12H5"/>',linked:'<path d="M9 17H7A5 5 0 0 1 7 7h2"/><path d="M15 7h2a5 5 0 1 1 0 10h-2"/><line x1="8" x2="16" y1="12" y2="12"/>',loading:'<line x1="12" x2="12" y1="2" y2="6"/><line x1="12" x2="12" y1="18" y2="22"/><line x1="4.93" x2="7.76" y1="4.93" y2="7.76"/><line x1="16.24" x2="19.07" y1="16.24" y2="19.07"/><line x1="2" x2="6" y1="12" y2="12"/><line x1="18" x2="22" y1="12" y2="12"/><line x1="4.93" x2="7.76" y1="19.07" y2="16.24"/><line x1="16.24" x2="19.07" y1="7.76" y2="4.93"/>',maximize:'<polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" x2="14" y1="3" y2="10"/><line x1="3" x2="10" y1="21" y2="14"/>',menu:'<line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/>',"menu-alt":'<circle cx="12" cy="5" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="12" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="19" r="0.75" fill="#D9D9D9"/>',minimize:'<polyline points="4 14 10 14 10 20"/><polyline points="20 10 14 10 14 4"/><line x1="14" x2="21" y1="10" y2="3"/><line x1="3" x2="10" y1="21" y2="14"/>',minus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/>',next:'<path d="m9 18 6-6-6-6"/>',none:'<path d="m7 15 5 5 5-5"/><path d="m7 9 5-5 5 5"/>',"not-allowed":'<circle cx="12" cy="12" r="10"/><path d="m4.9 4.9 14.2 14.2"/>',paste:'<path d="M15 2H9a1 1 0 0 0-1 1v2c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V3c0-.6-.4-1-1-1Z"/><path d="M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M16 4h2a2 2 0 0 1 2 2v2M11 14h10"/><path d="m17 10 4 4-4 4"/>',pin:'<line x1="12" x2="12" y1="17" y2="22"/><path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"/>',pivot:'<path d="M15 3v18"/><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M21 9H3"/><path d="M21 15H3"/>',plus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/><path d="M12 8v8"/>',previous:'<path d="m15 18-6-6 6-6"/>',right:'<path d="M5 12h14"/><path d="m12 5 7 7-7 7"/>',save:'<path d="M12 17V3"/><path d="m6 11 6 6 6-6"/><path d="M19 21H5"/>',"small-left":'<path d="m15 18-6-6 6-6"/>',"small-right":'<path d="m9 18 6-6-6-6"/>',tick:'<path d="M20 6 9 17l-5-5"/>',"tree-closed":'<path d="m9 18 6-6-6-6"/>',"tree-indeterminate":'<path d="M5 12h14"/>',"tree-open":'<path d="m6 9 6 6 6-6"/>',unlinked:'<path d="M9 17H7A5 5 0 0 1 7 7"/><path d="M15 7h2a5 5 0 0 1 4 8"/><line x1="8" x2="12" y1="12" y2="12"/><line x1="2" x2="22" y1="2" y2="22"/>',up:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',grip:'<circle cx="5" cy="8" r="0.5"/><circle cx="12" cy="8" r="0.5"/><circle cx="19" cy="8" r="0.5"/><circle cx="5" cy="16" r="0.5"/><circle cx="12" cy="16" r="0.5"/><circle cx="19" cy="16" r="0.5"/><g stroke="none" fill="currentColor"><circle cx="5" cy="8" r="1"/><circle cx="12" cy="8" r="1"/><circle cx="19" cy="8" r="1"/><circle cx="5" cy="16" r="1"/><circle cx="12" cy="16" r="1"/><circle cx="19" cy="16" r="1"/></g>',settings:'<path d="M20 7h-9"/><path d="M14 17H5"/><circle cx="17" cy="17" r="3"/><circle cx="7" cy="7" r="3"/>'},Q4={"column-arrow":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" viewBox="0 0 32 32"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 26C0 28.2092 1.79086 30 4 30H14C16.2091 30 18 28.2092 18 26V15H25.8786L24.4394 16.4393C23.8536 17.0251 23.8536 17.9749 24.4394 18.5607C25.0252 19.1464 25.9748 19.1464 26.5606 18.5607L30.5606 14.5607C31.1464 13.9749 31.1464 13.0251 30.5606 12.4393L26.5606 8.43934C25.9748 7.85356 25.0252 7.85356 24.4394 8.43934C23.8536 9.02512 23.8536 9.97488 24.4394 10.5607L25.8786 12H18V6C18 3.79086 16.2091 2 14 2H4C1.79086 2 0 3.79086 0 6V26ZM14 5H10.5V12H15V6C15 5.44772 14.5523 5 14 5ZM4 5H7.5V12H3V6C3 5.44772 3.44772 5 4 5ZM10.5 15H15V26C15 26.5522 14.5523 27 14 27H10.5V15ZM4 27H7.5V15H3V26C3 26.5522 3.44772 27 4 27Z" fill="currentColor"/></svg>',"small-down":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 10.667 16 21.334l8.667-10.667H7.334Z"/></svg>',"small-up":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 21.333 16 10.666l8.667 10.667H7.334Z"/></svg>',"pinned-top":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M12.53 3.72A.75.75 0 0 1 12 5H4a.75.75 0 0 1 0-1.5h8a.75.75 0 0 1 .53.22ZM3.269 10.744a.75.75 0 0 1 .2-.524l4-4a.75.75 0 0 1 1.06 0l4 4a.75.75 0 1 1-1.06 1.06L8.75 8.56V14a.75.75 0 0 1-1.5 0V8.56l-2.72 2.72a.75.75 0 0 1-1.26-.536Z"/></svg>',"pinned-bottom":'<svg xmlns="http://www.w3.org/2000/svg" fill="none" class="ag-icon" viewBox="0 0 16 16"><path fill="currentColor" d="M3.47 12.28A.75.75 0 0 1 4 11h8a.75.75 0 0 1 0 1.5H4a.75.75 0 0 1-.53-.22ZM12.731 5.256a.75.75 0 0 1-.2.524l-4 4a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 1 1 1.06-1.06l2.72 2.72V2a.75.75 0 0 1 1.5 0v5.44l2.72-2.72a.75.75 0 0 1 1.26.536Z"/></svg>',"un-pin":'<svg xmlns="http://www.w3.org/2000/svg" fill="none" class="ag-icon" viewBox="0 0 16 16"><path fill="currentColor" d="M8 11a.75.75 0 0 0-.75.75v3.333a.75.75 0 1 0 1.5 0V11.75A.75.75 0 0 0 8 11Z"/><path fill="currentColor" d="M13.11 1.436a.75.75 0 0 0-1.22-.872l-10 14a.75.75 0 1 0 1.22.872L5.207 12.5h7.376a.75.75 0 0 0 .75-.75v-1.174a2.08 2.08 0 0 0-1.153-1.863l-1.185-.599-.005-.002a.58.58 0 0 1-.323-.522V5.165a2.083 2.083 0 0 0 1.854-2.904l.589-.825Zm-3.943 5.52v.634a2.08 2.08 0 0 0 1.153 1.863l1.185.6.005.002a.58.58 0 0 1 .323.522V11H6.28l2.887-4.044ZM9.277 1H5.25a2.084 2.084 0 0 0-.083 4.165v1.676l1.5-2.132v-.292a.75.75 0 0 0-.75-.75H5.25a.584.584 0 0 1 0-1.167h2.972L9.277 1Z"/></svg>',"chevron-down":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 6L8 10L4 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-up":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 10L8 6L12 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-left":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 12L6 8L10 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-right":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"filter-add":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.12126 7.75L10.8517 7.75" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M6.65934 11.748L9.32778 11.748" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M12.2943 1.04872V6.19184M14.9886 3.74341H9.68478" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M8.25488 3C8.04799 3.18323 7.91706 3.45099 7.91699 3.74902C7.91713 4.04868 8.04988 4.31681 8.25879 4.5H2C1.58579 4.5 1.25 4.16421 1.25 3.75C1.25 3.33579 1.58579 3 2 3H8.25488Z" fill="currentColor"/></svg>',edit:'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 10.6262V12.5012H5.375L10.905 6.97122L9.03 5.09622L3.5 10.6262ZM12.355 5.52122C12.4014 5.47497 12.4381 5.42002 12.4632 5.35953C12.4883 5.29905 12.5012 5.23421 12.5012 5.16872C12.5012 5.10324 12.4883 5.0384 12.4632 4.97791C12.4381 4.91742 12.4014 4.86248 12.355 4.81622L11.185 3.64622C11.1387 3.59987 11.0838 3.5631 11.0233 3.53801C10.9628 3.51291 10.898 3.5 10.8325 3.5C10.767 3.5 10.7022 3.51291 10.6417 3.53801C10.5812 3.5631 10.5263 3.59987 10.48 3.64622L9.565 4.56122L11.44 6.43622L12.355 5.52122Z" fill="currentColor"/></svg>'},$W=(e={})=>{let t="";for(let i of[...Object.keys(J4),...Object.keys(Q4)]){let n=jW(i,e.strokeWidth);t+=`.ag-icon-${i}::before { mask-image: url('data:image/svg+xml,${encodeURIComponent(n)}'); }
`}return t},jW=(e,t=1.5)=>{let i=Q4[e];if(i)return i;let n=J4[e];if(!n)throw new Error(`Missing icon data for ${e}`);return`<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="black" stroke-width="${t}" viewBox="0 0 24 24"><style>* { vector-effect: non-scaling-stroke; }</style>`+n+"</svg>"},KW=(e={})=>xi({feature:"iconSet",css:()=>$W(e)});var YW=KW();var XW=':where(.ag-input-field-input[type=number]:not(.ag-number-field-input-stepper)){-webkit-appearance:textfield;-moz-appearance:textfield;appearance:textfield;&::-webkit-inner-spin-button,&::-webkit-outer-spin-button{-webkit-appearance:none;appearance:none;margin:0}}.ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){background-color:var(--ag-input-background-color);border:var(--ag-input-border);border-radius:var(--ag-input-border-radius);color:var(--ag-input-text-color);font-family:inherit;font-size:inherit;line-height:inherit;margin:0;min-height:var(--ag-input-height);padding:0;&:where(:disabled){background-color:var(--ag-input-disabled-background-color);border:var(--ag-input-disabled-border);color:var(--ag-input-disabled-text-color)}&:where(:focus){background-color:var(--ag-input-focus-background-color);border:var(--ag-input-focus-border);box-shadow:var(--ag-input-focus-shadow);color:var(--ag-input-focus-text-color);outline:none}&:where(:invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&:where(.invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&::-moz-placeholder{color:var(--ag-input-placeholder-text-color)}&::placeholder{color:var(--ag-input-placeholder-text-color)}}:where(.ag-ltr) .ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){padding-left:var(--ag-input-padding-start)}:where(.ag-rtl) .ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){padding-right:var(--ag-input-padding-start)}:where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select){.ag-input-wrapper:before{background-color:currentcolor;color:var(--ag-input-icon-color);content:"";display:block;height:12px;-webkit-mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;opacity:.5;position:absolute;width:12px}}:where(.ag-ltr) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select){.ag-input-wrapper:before{margin-left:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-left:calc(var(--ag-spacing)*1.5 + 12px)}}:where(.ag-rtl) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select){.ag-input-wrapper:before{margin-right:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-right:calc(var(--ag-spacing)*1.5 + 12px)}}',JW=".ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){&:focus{box-shadow:var(--ag-focus-shadow);&:where(.invalid),&:where(:invalid){box-shadow:var(--ag-focus-error-shadow)}}}";var QW={inputBackgroundColor:"transparent",inputBorder:!1,inputBorderRadius:0,inputTextColor:{ref:"textColor"},inputPlaceholderTextColor:{ref:"inputTextColor",mix:.5},inputPaddingStart:0,inputHeight:{calc:"max(iconSize, fontSize) + spacing * 2"},inputFocusBackgroundColor:{ref:"inputBackgroundColor"},inputFocusBorder:{ref:"inputBorder"},inputFocusShadow:"none",inputFocusTextColor:{ref:"inputTextColor"},inputDisabledBackgroundColor:{ref:"inputBackgroundColor"},inputDisabledBorder:{ref:"inputBorder"},inputDisabledTextColor:{ref:"inputTextColor"},inputInvalidBackgroundColor:{ref:"inputBackgroundColor"},inputInvalidBorder:{ref:"inputBorder"},inputInvalidTextColor:{ref:"inputTextColor"},inputIconColor:{ref:"inputTextColor"},pickerButtonBorder:!1,pickerButtonFocusBorder:{ref:"inputFocusBorder"},pickerButtonBackgroundColor:{ref:"backgroundColor"},pickerButtonFocusBackgroundColor:{ref:"backgroundColor"},pickerListBorder:!1,pickerListBackgroundColor:{ref:"backgroundColor"},colorPickerThumbSize:18,colorPickerTrackSize:12,colorPickerThumbBorderWidth:3,colorPickerTrackBorderRadius:12,colorPickerColorBorderRadius:4};var ZW=()=>xi({feature:"inputStyle",params:_(b({},QW),{inputBackgroundColor:Jt,inputBorder:!0,inputBorderRadius:{ref:"borderRadius"},inputPaddingStart:{ref:"spacing"},inputFocusBorder:{color:xt},inputFocusShadow:{ref:"focusShadow"},inputDisabledBackgroundColor:Xt(.06),inputDisabledTextColor:{ref:"textColor",mix:.5},inputInvalidBorder:{color:{ref:"invalidColor"}},pickerButtonBorder:!0,pickerListBorder:!0}),css:()=>XW+JW}),Z4=ZW();var eP='.ag-tabs-header{background-color:var(--ag-tab-bar-background-color);border-bottom:var(--ag-tab-bar-border);display:flex;flex:1;gap:var(--ag-tab-spacing);padding:var(--ag-tab-bar-top-padding) var(--ag-tab-bar-horizontal-padding) 0}.ag-tabs-header-wrapper{display:flex}.ag-tabs-close-button-wrapper{align-items:center;border:0;display:flex;padding:var(--ag-spacing)}:where(.ag-ltr) .ag-tabs-close-button-wrapper{border-right:solid var(--ag-border-width) var(--ag-border-color)}:where(.ag-rtl) .ag-tabs-close-button-wrapper{border-left:solid var(--ag-border-width) var(--ag-border-color)}.ag-tabs-close-button{background-color:unset;border:0;cursor:pointer;padding:0}.ag-tab{align-items:center;background-color:var(--ag-tab-background-color);border-left:var(--ag-tab-selected-border-width) solid transparent;border-right:var(--ag-tab-selected-border-width) solid transparent;color:var(--ag-tab-text-color);cursor:pointer;display:flex;flex:1;justify-content:center;padding:var(--ag-tab-top-padding) var(--ag-tab-horizontal-padding) var(--ag-tab-bottom-padding);position:relative;&:hover{background-color:var(--ag-tab-hover-background-color);color:var(--ag-tab-hover-text-color)}&.ag-tab-selected{background-color:var(--ag-tab-selected-background-color);color:var(--ag-tab-selected-text-color)}&:after{background-color:var(--ag-tab-selected-underline-color);bottom:0;content:"";display:block;height:var(--ag-tab-selected-underline-width);left:0;opacity:0;position:absolute;right:0;transition:opacity var(--ag-tab-selected-underline-transition-duration)}&.ag-tab-selected:after{opacity:1}}:where(.ag-ltr) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-left-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-right-color:var(--ag-tab-selected-border-color)}}}:where(.ag-rtl) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-right-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-left-color:var(--ag-tab-selected-border-color)}}}';var tP={tabBarBackgroundColor:"transparent",tabBarHorizontalPadding:0,tabBarTopPadding:0,tabBackgroundColor:"transparent",tabTextColor:{ref:"textColor"},tabHorizontalPadding:{ref:"spacing"},tabTopPadding:{ref:"spacing"},tabBottomPadding:{ref:"spacing"},tabSpacing:"0",tabHoverBackgroundColor:{ref:"tabBackgroundColor"},tabHoverTextColor:{ref:"tabTextColor"},tabSelectedBackgroundColor:{ref:"tabBackgroundColor"},tabSelectedTextColor:{ref:"tabTextColor"},tabSelectedBorderWidth:{ref:"borderWidth"},tabSelectedBorderColor:"transparent",tabSelectedUnderlineColor:"transparent",tabSelectedUnderlineWidth:0,tabSelectedUnderlineTransitionDuration:0,tabBarBorder:!1};var eU=()=>xi({feature:"tabStyle",params:_(b({},tP),{tabBarBorder:!0,tabBarBackgroundColor:_i(.05),tabTextColor:{ref:"textColor",mix:.7},tabSelectedTextColor:{ref:"textColor"},tabHoverTextColor:{ref:"textColor"},tabSelectedBorderColor:{ref:"borderColor"},tabSelectedBackgroundColor:Jt}),css:eP}),tU=eU();var iU=()=>xi({feature:"tabStyle",params:_(b({},tP),{tabBarBorder:!0,tabBarBackgroundColor:{ref:"chromeBackgroundColor"},tabHoverTextColor:xt,tabSelectedTextColor:xt,tabSelectedUnderlineColor:xt,tabSelectedUnderlineWidth:2,tabSelectedUnderlineTransitionDuration:"0.3s"}),css:eP}),nU=iU();var oU=()=>j4().withPart(K4).withPart(X4).withPart(YW).withPart(tU).withPart(Z4).withPart(Iv).withParams({fontFamily:[{googleFont:"IBM Plex Sans"},"-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu"]}),sU=oU(),rU=()=>j4().withPart(OW).withPart(K4).withPart(X4).withPart(qW).withPart(nU).withPart(Z4).withPart(Iv).withParams({accentColor:"#2196f3",selectedRowBackgroundColor:wi(.3),inputFocusBorder:{color:wi(.4)},focusShadow:{radius:2,spread:1.6,color:wi(.4)},iconButtonHoverBackgroundColor:"transparent",iconButtonActiveBackgroundColor:"transparent",checkboxUncheckedBorderColor:Xt(.45),checkboxIndeterminateBackgroundColor:Xt(.45),checkboxIndeterminateBorderColor:Xt(.45),checkboxBorderWidth:2,checkboxBorderRadius:2,fontSize:13,dataFontSize:14,headerFontWeight:700,borderRadius:3,wrapperBorderRadius:3,tabSelectedUnderlineColor:xt,tabSelectedBorderWidth:0,tabSelectedUnderlineTransitionDuration:.3,sideButtonSelectedUnderlineColor:xt,sideButtonSelectedUnderlineWidth:2,sideButtonSelectedUnderlineTransitionDuration:.3,sideButtonBorder:!1,sideButtonSelectedBorder:!1,sideButtonBarTopPadding:{calc:"spacing * 3"},sideButtonSelectedBackgroundColor:"transparent",sideButtonHoverTextColor:xt,iconButtonHoverColor:xt,toggleButtonWidth:28,toggleButtonHeight:18,toggleButtonSwitchInset:1,toggleButtonOffBackgroundColor:Xt(.45),colorPickerThumbSize:13,colorPickerTrackSize:11,colorPickerThumbBorderWidth:2,colorPickerTrackBorderRadius:2,colorPickerColorBorderRadius:2}),iP=rU();var aU={cssName:"--ag-cell-horizontal-padding",changeKey:"cellHorizontalPaddingChanged",defaultValue:16},lU={cssName:"--ag-indentation-level",changeKey:"indentationLevelChanged",defaultValue:0,noWarn:!0,cacheDefault:!0},dU={cssName:"--ag-row-group-indent-size",changeKey:"rowGroupIndentSizeChanged",defaultValue:0},gR={cssName:"--ag-row-height",changeKey:"rowHeightChanged",defaultValue:42},fR={cssName:"--ag-header-height",changeKey:"headerHeightChanged",defaultValue:48},mR={cssName:"--ag-list-item-height",changeKey:"listItemHeightChanged",defaultValue:24},uC={cssName:"--ag-row-border",changeKey:"rowBorderWidthChanged",defaultValue:1,border:!0},CR={cssName:"--ag-pinned-row-border",changeKey:"pinnedRowBorderWidthChanged",defaultValue:1,border:!0};function cU(e,t){for(let i of t.sort((n,o)=>n.moduleName.localeCompare(o.moduleName))){let n=i.css;n&&e.set(`module-${i.moduleName}`,n)}}var uU=class extends PB{constructor(){super(...arguments),this.sizeEls=new Map,this.lastKnownValues=new Map,this.sizesMeasured=!1}initVariables(){this.addManagedPropertyListener("rowHeight",()=>this.refreshRowHeightVariable()),this.getSizeEl(gR),this.getSizeEl(fR),this.getSizeEl(mR),this.getSizeEl(uC),this.getSizeEl(CR),this.refreshRowBorderWidthVariable()}getPinnedRowBorderWidth(){return this.getCSSVariablePixelValue(CR)}getRowBorderWidth(){return this.getCSSVariablePixelValue(uC)}getDefaultRowHeight(){return this.getCSSVariablePixelValue(gR)}getDefaultHeaderHeight(){return this.getCSSVariablePixelValue(fR)}getDefaultCellHorizontalPadding(){return this.getCSSVariablePixelValue(aU)}getCellPaddingLeft(){let e=this.getDefaultCellHorizontalPadding(),t=this.getCSSVariablePixelValue(lU),i=this.getCSSVariablePixelValue(dU);return e-1+i*t}getCellPadding(){let e=this.getDefaultCellHorizontalPadding()-1;return this.getCellPaddingLeft()+e}getDefaultColumnMinWidth(){return Math.min(36,this.getDefaultRowHeight())}getDefaultListItemHeight(){return this.getCSSVariablePixelValue(mR)}refreshRowHeightVariable(){let{eRootDiv:e}=this,t=e.style.getPropertyValue("--ag-line-height").trim(),i=this.gos.get("rowHeight");if(i==null||isNaN(i)||!isFinite(i))return t!==null&&e.style.setProperty("--ag-line-height",null),-1;let n=`${i}px`;return t!=n?(e.style.setProperty("--ag-line-height",n),i):t!=""?Number.parseFloat(t):-1}getCSSVariablePixelValue(e){let t=this.lastKnownValues.get(e);if(t!=null)return t;let i=this.measureSizeEl(e);return i==="detached"||i==="no-styles"?(e.cacheDefault&&this.lastKnownValues.set(e,e.defaultValue),e.defaultValue):(this.lastKnownValues.set(e,i),i)}measureSizeEl(e){let t=this.getSizeEl(e);if(t.offsetParent==null)return"detached";let i=t.offsetWidth;return i===hC?"no-styles":(this.sizesMeasured=!0,i)}getMeasurementContainer(){let e=this.eMeasurementContainer;return e||(e=this.eMeasurementContainer=ft({tag:"div",cls:"ag-measurement-container"}),this.eRootDiv.appendChild(e)),e}getSizeEl(e){let t=this.sizeEls.get(e);if(t)return t;let i=this.getMeasurementContainer();t=ft({tag:"div"});let{border:n,noWarn:o}=e;n?(t.className="ag-measurement-element-border",t.style.setProperty("--ag-internal-measurement-border",`var(${e.cssName}, solid ${hC}px)`)):t.style.width=`var(${e.cssName}, ${hC}px)`,i.appendChild(t),this.sizeEls.set(e,t);let s=this.measureSizeEl(e);s==="no-styles"&&!o&&I(9,{variable:e});let r=Qo(this.beans,t,()=>{let a=this.measureSizeEl(e);a==="detached"||a==="no-styles"||(this.lastKnownValues.set(e,a),a!==s&&(s=a,this.fireStylesChangedEvent(e.changeKey)))});return this.addDestroyFunc(()=>r()),t}fireStylesChangedEvent(e){e==="rowBorderWidthChanged"&&this.refreshRowBorderWidthVariable(),this.eventSvc.dispatchEvent({type:"gridStylesChanged",[e]:!0})}refreshRowBorderWidthVariable(){let e=this.getCSSVariablePixelValue(uC);this.eRootDiv.style.setProperty("--ag-internal-row-border-width",`${e}px`)}postProcessThemeChange(e,t){e&&getComputedStyle(this.getMeasurementContainer()).getPropertyValue("--ag-legacy-styles-loaded")&&Ge(t?106:239)}getAdditionalCss(){let e=new Map;return e.set("core",[MW]),cU(e,Array.from(Q_())),e}getDefaultTheme(){return sU}themeError(e){Ge(240,{theme:e})}},hC=15538,hU=class extends kB{postConstruct(){let{globalListener:e,globalSyncListener:t}=this.beans;e&&this.addGlobalListener(e,!0),t&&this.addGlobalListener(t,!1)}};function nP(e,t,i){let n=e.visibleCols.headerGroupRowCount;if(i>=n)return{column:t,headerRowIndex:i};let o=t.getParent();for(;o&&o.getProvidedColumnGroup().getLevel()>i;)o=o.getParent();let s=t.isSpanHeaderHeight();return!o||s&&o.isPadding()?{column:t,headerRowIndex:n}:{column:o,headerRowIndex:o.getProvidedColumnGroup().getLevel()}}var pU=class extends D{constructor(){super(...arguments),this.beanName="headerNavigation",this.currentHeaderRowWithoutSpan=-1}postConstruct(){let e=this.beans;e.ctrlsSvc.whenReady(this,i=>{this.gridBodyCon=i.gridBodyCtrl});let t=kt(e);this.addManagedElementListeners(t,{mousedown:()=>{this.currentHeaderRowWithoutSpan=-1}})}getHeaderPositionForColumn(e,t){let i,{colModel:n,colGroupSvc:o,ctrlsSvc:s}=this.beans;if(typeof e=="string"?(i=n.getCol(e),i||(i=o?.getColumnGroup(e)??null)):i=e,!i)return null;let a=s.getHeaderRowContainerCtrl()?.getAllCtrls(),l=Ue(a||[]).type==="filter",d=Sn(this.beans)-1,c=-1,u=i;for(;u;)c++,u=u.getParent();let h=c;return t&&l&&h===d-1&&h++,h===-1?null:{headerRowIndex:h,column:i}}navigateVertically(e,t){let{focusSvc:i,visibleCols:n}=this.beans,{focusedHeader:o}=i;if(!o)return!1;let{headerRowIndex:s}=o,r=o.column,a=Sn(this.beans),l=this.getHeaderRowType(s),d=n.headerGroupRowCount,{headerRowIndex:c,column:u,headerRowIndexWithoutSpan:h}=e==="UP"?gU(l,r,s):fU(r,s,d),p=!1;return c<0&&(c=0,u=r,p=!0),c>=a?(c=-1,this.currentHeaderRowWithoutSpan=-1):h!==void 0&&(this.currentHeaderRowWithoutSpan=h),!p&&!u?!1:i.focusHeaderPosition({headerPosition:{headerRowIndex:c,column:u},allowUserOverride:!0,event:t})}navigateHorizontally(e,t=!1,i){let{focusSvc:n,gos:o}=this.beans,s=b({},n.focusedHeader),r,a;this.currentHeaderRowWithoutSpan!==-1?s.headerRowIndex=this.currentHeaderRowWithoutSpan:this.currentHeaderRowWithoutSpan=s.headerRowIndex,e==="LEFT"!==o.get("enableRtl")?(a="Before",r=this.findHeader(s,a)):(a="After",r=this.findHeader(s,a));let l=o.getCallback("tabToNextHeader");if(t&&l){let d=n.focusHeaderPositionFromUserFunc({userFunc:l,headerPosition:r,direction:a});if(d){let{headerRowIndex:c}=n.focusedHeader||{};c!=null&&c!=s.headerRowIndex&&(this.currentHeaderRowWithoutSpan=c)}return d}return r||!t?n.focusHeaderPosition({headerPosition:r,direction:a,fromTab:t,allowUserOverride:!0,event:i}):this.focusNextHeaderRow(s,a,i)}focusNextHeaderRow(e,t,i){let n=this.beans,o=e.headerRowIndex,s=null,r,a=Sn(n),l=this.beans.visibleCols.allCols;if(t==="Before"){if(o<=0)return!1;s=Ue(l),r=o-1,this.currentHeaderRowWithoutSpan-=1}else s=l[0],r=o+1,this.currentHeaderRowWithoutSpan<a?this.currentHeaderRowWithoutSpan+=1:this.currentHeaderRowWithoutSpan=-1;let{column:d,headerRowIndex:c}=nP(this.beans,s,r);return c>=a&&(c=-1),n.focusSvc.focusHeaderPosition({headerPosition:{column:d,headerRowIndex:c},direction:t,fromTab:!0,allowUserOverride:!0,event:i})}scrollToColumn(e,t="After"){if(e.getPinned())return;let i;if(pt(e)){let n=e.getDisplayedLeafColumns();i=t==="Before"?Ue(n):n[0]}else i=e;this.gridBodyCon.scrollFeature.ensureColumnVisible(i)}findHeader(e,t){let{colGroupSvc:i,visibleCols:n}=this.beans,o=e.column;if(o instanceof hd){let l=o.getDisplayedLeafColumns();o=t==="Before"?l[0]:l[l.length-1]}let s=t==="Before"?n.getColBefore(o):n.getColAfter(o);if(!s)return;let r=n.headerGroupRowCount;if(e.headerRowIndex>=r)return{headerRowIndex:e.headerRowIndex,column:s};let a=i?.getColGroupAtLevel(s,e.headerRowIndex);return a?a.isPadding()&&s.isSpanHeaderHeight()?{headerRowIndex:n.headerGroupRowCount,column:s}:{headerRowIndex:e.headerRowIndex,column:a??s}:{headerRowIndex:s instanceof Js&&s.isSpanHeaderHeight()?n.headerGroupRowCount:e.headerRowIndex,column:s}}getHeaderRowType(e){let t=this.beans.ctrlsSvc.getHeaderRowContainerCtrl();if(t)return t.getRowType(e)}};function gU(e,t,i){let n=i-1;if(e!=="filter"){let o=t instanceof Js&&t.isSpanHeaderHeight(),s=t.getParent();for(;s&&(s.getProvidedColumnGroup().getLevel()>n||o&&s.isPadding());)s=s.getParent();if(s)return o?{column:s,headerRowIndex:s.getProvidedColumnGroup().getLevel(),headerRowIndexWithoutSpan:n}:{column:s,headerRowIndex:n,headerRowIndexWithoutSpan:n}}return{column:t,headerRowIndex:n,headerRowIndexWithoutSpan:n}}function fU(e,t,i){let n=t+1,o={column:e,headerRowIndex:n,headerRowIndexWithoutSpan:n};if(e instanceof hd){if(n>=i)return{column:e.getDisplayedLeafColumns()[0],headerRowIndex:i,headerRowIndexWithoutSpan:n};let r=e.getDisplayedChildren()[0];if(r instanceof hd&&r.isPadding()){let l=r.getDisplayedLeafColumns()[0];l.isSpanHeaderHeight()&&(r=l)}o.column=r,r instanceof Js&&r.isSpanHeaderHeight()&&(o.headerRowIndex=i,o.headerRowIndexWithoutSpan=n)}return o}var mU=class extends D{constructor(){super(...arguments),this.beanName="focusSvc",this.focusFallbackTimeout=null,this.needsFocusRestored=!1}wireBeans(e){this.colModel=e.colModel,this.visibleCols=e.visibleCols,this.rowRenderer=e.rowRenderer,this.navigation=e.navigation,this.filterManager=e.filterManager,this.overlays=e.overlays}postConstruct(){let e=this.clearFocusedCell.bind(this);this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:this.onColumnEverythingChanged.bind(this),columnGroupOpened:e,columnRowGroupChanged:e}),this.addDestroyFunc(LN(this.beans))}attemptToRecoverFocus(){this.needsFocusRestored=!0,this.focusFallbackTimeout!=null&&clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=window.setTimeout(this.setFocusRecovered.bind(this),100)}setFocusRecovered(){this.needsFocusRestored=!1,this.focusFallbackTimeout!=null&&(clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=null)}shouldTakeFocus(){return this.gos.get("suppressFocusAfterRefresh")?(this.setFocusRecovered(),!1):this.needsFocusRestored?(this.setFocusRecovered(),!0):this.doesRowOrCellHaveBrowserFocus()}onColumnEverythingChanged(){if(!this.focusedCell)return;let e=this.focusedCell.column,t=this.colModel.getCol(e.getId());e!==t&&this.clearFocusedCell()}getFocusCellToUseAfterRefresh(){let{gos:e,focusedCell:t}=this;return e.get("suppressFocusAfterRefresh")||e.get("suppressCellFocus")||!t||!this.doesRowOrCellHaveBrowserFocus()?null:t}getFocusHeaderToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedHeader||!this.isDomDataPresentInHierarchy(tt(this.beans),D4)?null:this.focusedHeader}doesRowOrCellHaveBrowserFocus(){let e=tt(this.beans);return this.isDomDataPresentInHierarchy(e,yp)?!0:this.isDomDataPresentInHierarchy(e,Sp)}isDomDataPresentInHierarchy(e,t){let i=e;for(;i;){if(C6(this.gos,i,t))return!0;i=i.parentNode}return!1}getFocusedCell(){return this.focusedCell}getFocusEventParams(e){let{rowIndex:t,rowPinned:i,column:n}=e,o={rowIndex:t,rowPinned:i,column:n,isFullWidthCell:!1},s=this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:i});return s&&(o.isFullWidthCell=s.isFullWidth()),o}clearFocusedCell(){if(this.focusedCell==null)return;let e=this.getFocusEventParams(this.focusedCell);this.focusedCell=null,this.eventSvc.dispatchEvent(b({type:"cellFocusCleared"},e))}setFocusedCell(e){this.setFocusRecovered();let{column:t,rowIndex:i,rowPinned:n,forceBrowserFocus:o=!1,preventScrollOnBrowserFocus:s=!1,sourceEvent:r}=e,a=this.colModel.getCol(t);if(!a){this.focusedCell=null;return}this.focusedCell={rowIndex:i,rowPinned:ro(n),column:a};let l=this.getFocusEventParams(this.focusedCell);this.eventSvc.dispatchEvent(_(b(b({type:"cellFocused"},l),this.previousCellFocusParams&&{previousParams:this.previousCellFocusParams}),{forceBrowserFocus:o,preventScrollOnBrowserFocus:s,sourceEvent:r})),this.previousCellFocusParams=l}isCellFocused(e){return this.focusedCell==null?!1:O4(e,this.focusedCell)}isHeaderWrapperFocused(e){if(this.focusedHeader==null)return!1;let{column:t,rowCtrl:{rowIndex:i,pinned:n}}=e,{column:o,headerRowIndex:s}=this.focusedHeader;return t===o&&i===s&&n==o.getPinned()}focusHeaderPosition(e){if(this.setFocusRecovered(),Ws(this.beans))return!1;let{direction:t,fromTab:i,allowUserOverride:n,event:o,fromCell:s,rowWithoutSpanValue:r,scroll:a=!0}=e,{headerPosition:l}=e;if(s&&this.filterManager?.isAdvFilterHeaderActive())return this.focusAdvancedFilter(l);if(n){let d=this.focusedHeader,c=Sn(this.beans);if(i){let u=this.gos.getCallback("tabToNextHeader");u&&(l=this.getHeaderPositionFromUserFunc({userFunc:u,direction:t,currentPosition:d,headerPosition:l,headerRowCount:c}))}else{let u=this.gos.getCallback("navigateToNextHeader");if(u&&o){let h={key:o.key,previousHeaderPosition:d,nextHeaderPosition:l,headerRowCount:c,event:o};l=u(h)}}}return l?this.focusProvidedHeaderPosition({headerPosition:l,direction:t,event:o,fromCell:s,rowWithoutSpanValue:r,scroll:a}):!1}focusHeaderPositionFromUserFunc(e){if(Ws(this.beans))return!1;let{userFunc:t,headerPosition:i,direction:n,event:o}=e,s=this.focusedHeader,r=Sn(this.beans),a=this.getHeaderPositionFromUserFunc({userFunc:t,direction:n,currentPosition:s,headerPosition:i,headerRowCount:r});return!!a&&this.focusProvidedHeaderPosition({headerPosition:a,direction:n,event:o})}getHeaderPositionFromUserFunc(e){let{userFunc:t,direction:i,currentPosition:n,headerPosition:o,headerRowCount:s}=e,a=t({backwards:i==="Before",previousHeaderPosition:n,nextHeaderPosition:o,headerRowCount:s});return a===!0?n:a===!1?null:a}focusProvidedHeaderPosition(e){let{headerPosition:t,direction:i,fromCell:n,rowWithoutSpanValue:o,event:s,scroll:r=!0}=e,{column:a,headerRowIndex:l}=t,{filterManager:d,ctrlsSvc:c,headerNavigation:u}=this.beans;if(this.focusedHeader&&eG(e.headerPosition,this.focusedHeader))return!1;if(l===-1)return d?.isAdvFilterHeaderActive()?this.focusAdvancedFilter(t):this.focusGridView({column:a,event:s});r&&u?.scrollToColumn(a,i);let p=c.getHeaderRowContainerCtrl(a.getPinned())?.focusHeader(t.headerRowIndex,a,s)||!1;return u&&p&&(o!=null||n)&&(u.currentHeaderRowWithoutSpan=o??-1),p}focusFirstHeader(){if(this.overlays?.isExclusive()&&this.focusOverlay())return!0;let e=this.visibleCols.allCols[0];if(!e)return!1;let t=nP(this.beans,e,0);return this.focusHeaderPosition({headerPosition:t,rowWithoutSpanValue:0})}focusLastHeader(e){if(this.overlays?.isExclusive()&&this.focusOverlay(!0))return!0;let t=Sn(this.beans)-1,i=Ue(this.visibleCols.allCols);return this.focusHeaderPosition({headerPosition:{headerRowIndex:t,column:i},rowWithoutSpanValue:-1,event:e})}focusPreviousFromFirstCell(e){return this.filterManager?.isAdvFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(e)}isAnyCellFocused(){return!!this.focusedCell}isRowFocused(e,t){return this.focusedCell==null?!1:this.focusedCell.rowIndex===e&&this.focusedCell.rowPinned===ro(t)}focusOverlay(e){let t=this.overlays?.isVisible()&&this.overlays.eWrapper?.getGui();return!!t&&js(t,e)}focusGridView(e){let{backwards:t=!1,canFocusOverlay:i=!0,event:n}=e;if(this.overlays?.isExclusive())return i&&this.focusOverlay(t);if(Ip(this.beans))return t&&!Ws(this.beans)?this.focusLastHeader():i&&this.focusOverlay(t)?!0:t?!1:ba(this.beans,t);let o=t?IV(this.beans):AV(this.beans);if(o){let s=e.column??this.focusedHeader?.column,{rowIndex:r,rowPinned:a}=o,l=ho(this.beans,o);if(!s||!l||r==null)return!1;if(s.isSuppressNavigable(l)){let d=this.gos.get("enableRtl"),c;return!n||n.key===R.TAB?c=d?R.LEFT:R.RIGHT:c=n.key,this.beans.navigation?.navigateToNextCell(null,c,{rowIndex:r,column:s,rowPinned:a||null},!0),!0}return this.navigation?.ensureCellVisible({rowIndex:r,column:s,rowPinned:a}),t&&this.rowRenderer.getRowByPosition(o)?.isFullWidth()&&this.navigation?.tryToFocusFullWidthRow(o,t)||(this.setFocusedCell({rowIndex:r,column:s,rowPinned:ro(a),forceBrowserFocus:!0}),this.beans.rangeSvc?.setRangeToCell({rowIndex:r,rowPinned:a,column:s})),!0}return!!(i&&this.focusOverlay(t)||t&&this.focusLastHeader())}focusAdvancedFilter(e){return this.advFilterFocusColumn=e?.column,this.beans.advancedFilter?.getCtrl().focusHeaderComp()??!1}focusNextFromAdvancedFilter(e,t){let i=(t?void 0:this.advFilterFocusColumn)??this.visibleCols.allCols?.[0];return e?this.focusHeaderPosition({headerPosition:{column:i,headerRowIndex:Sn(this.beans)-1}}):this.focusGridView({column:i})}clearAdvancedFilterColumn(){this.advFilterFocusColumn=void 0}},CU=class extends D{constructor(){super(...arguments),this.beanName="scrollVisibleSvc"}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colAnimation=e.colAnimation}postConstruct(){this.horizontalScrollShowing=this.gos.get("alwaysShowHorizontalScroll")===!0,this.verticalScrollShowing=this.gos.get("alwaysShowVerticalScroll")===!0,this.getScrollbarWidth(),this.addManagedEventListeners({displayedColumnsChanged:this.updateScrollVisible.bind(this),displayedColumnsWidthChanged:this.updateScrollVisible.bind(this)})}updateScrollVisible(){let{colAnimation:e}=this;e?.isActive()?e.executeLaterVMTurn(()=>{e.executeLaterVMTurn(()=>this.updateScrollVisibleImpl())}):this.updateScrollVisibleImpl()}updateScrollVisibleImpl(){let e=this.ctrlsSvc.get("center");if(!e||this.colAnimation?.isActive())return;let t={horizontalScrollShowing:e.isHorizontalScrollShowing(),verticalScrollShowing:this.verticalScrollShowing};this.setScrollsVisible(t),this.updateScrollGap()}updateScrollGap(){let e=this.ctrlsSvc.get("center"),t=e.hasHorizontalScrollGap(),i=e.hasVerticalScrollGap();(this.horizontalScrollGap!==t||this.verticalScrollGap!==i)&&(this.horizontalScrollGap=t,this.verticalScrollGap=i,this.eventSvc.dispatchEvent({type:"scrollGapChanged"}))}setScrollsVisible(e){(this.horizontalScrollShowing!==e.horizontalScrollShowing||this.verticalScrollShowing!==e.verticalScrollShowing)&&(this.horizontalScrollShowing=e.horizontalScrollShowing,this.verticalScrollShowing=e.verticalScrollShowing,this.eventSvc.dispatchEvent({type:"scrollVisibilityChanged"}))}getScrollbarWidth(){if(this.scrollbarWidth==null){let e=this.gos.get("scrollbarWidth"),i=typeof e=="number"&&e>=0?e:MN();i!=null&&(this.scrollbarWidth=i,this.eventSvc.dispatchEvent({type:"scrollbarWidthChanged"}))}return this.scrollbarWidth}},vU=class extends D{constructor(){super(...arguments),this.beanName="gridDestroySvc",this.destroyCalled=!1}destroy(){if(this.destroyCalled)return;let{stateSvc:e,ctrlsSvc:t,context:i}=this.beans;this.eventSvc.dispatchEvent({type:"gridPreDestroyed",state:e?.getState()??{}}),this.destroyCalled=!0,t.get("gridCtrl")?.destroyGridUi(),i.destroy(),super.destroy()}},np=new Set(["gridPreDestroyed","fillStart","pasteStart"]),wU=["columnEverythingChanged","newColumnsLoaded","columnPivotModeChanged","pivotMaxColumnsExceeded","columnRowGroupChanged","expandOrCollapseAll","columnPivotChanged","gridColumnsChanged","columnValueChanged","columnMoved","columnVisible","columnPinned","columnGroupOpened","columnResized","displayedColumnsChanged","virtualColumnsChanged","columnHeaderMouseOver","columnHeaderMouseLeave","columnHeaderClicked","columnHeaderContextMenu","asyncTransactionsFlushed","rowGroupOpened","rowDataUpdated","pinnedRowDataChanged","pinnedRowsChanged","rangeSelectionChanged","cellSelectionChanged","chartCreated","chartRangeSelectionChanged","chartOptionsChanged","chartDestroyed","toolPanelVisibleChanged","toolPanelSizeChanged","modelUpdated","cutStart","cutEnd","pasteStart","pasteEnd","fillStart","fillEnd","cellSelectionDeleteStart","cellSelectionDeleteEnd","rangeDeleteStart","rangeDeleteEnd","undoStarted","undoEnded","redoStarted","redoEnded","cellClicked","cellDoubleClicked","cellMouseDown","cellContextMenu","cellValueChanged","cellEditRequest","rowValueChanged","headerFocused","cellFocused","rowSelected","selectionChanged","tooltipShow","tooltipHide","cellKeyDown","cellMouseOver","cellMouseOut","filterChanged","filterModified","filterUiChanged","filterOpened","floatingFilterUiChanged","advancedFilterBuilderVisibleChanged","sortChanged","virtualRowRemoved","rowClicked","rowDoubleClicked","gridReady","gridPreDestroyed","gridSizeChanged","viewportChanged","firstDataRendered","dragStarted","dragStopped","dragCancelled","rowEditingStarted","rowEditingStopped","cellEditingStarted","cellEditingStopped","bodyScroll","bodyScrollEnd","paginationChanged","componentStateChanged","storeRefreshed","stateUpdated","columnMenuVisibleChanged","contextMenuVisibleChanged","rowDragEnter","rowDragMove","rowDragLeave","rowDragEnd","rowDragCancel","findChanged","rowResizeStarted","rowResizeEnded","columnsReset","bulkEditingStarted","bulkEditingStopped","batchEditingStarted","batchEditingStopped"];var Lv=wU.reduce((e,t)=>(e[t]=vO(t),e),{}),zl=(e,t)=>({tag:"span",ref:`eSort${e}`,cls:`ag-sort-indicator-icon ag-sort-${t} ag-hidden`,attrs:{"aria-hidden":"true"}}),bU={tag:"span",cls:"ag-sort-indicator-container",children:[zl("Order","order"),zl("Asc","ascending-icon"),zl("Desc","descending-icon"),zl("Mixed","mixed-icon"),zl("None","none-icon")]},_v=class extends Oe{constructor(e){super(),this.eSortOrder=V,this.eSortAsc=V,this.eSortDesc=V,this.eSortMixed=V,this.eSortNone=V,e||this.setTemplate(bU)}attachCustomElements(e,t,i,n,o){this.eSortOrder=e,this.eSortAsc=t,this.eSortDesc=i,this.eSortMixed=n,this.eSortNone=o}setupSort(e,t=!1){if(this.column=e,this.suppressOrder=t,this.setupMultiSortIndicator(),!e.isSortable()&&!e.getColDef().showRowGroup)return;this.addInIcon("sortAscending",this.eSortAsc,e),this.addInIcon("sortDescending",this.eSortDesc,e),this.addInIcon("sortUnSort",this.eSortNone,e);let i=this.updateIcons.bind(this),n=this.onSortChanged.bind(this);this.addManagedPropertyListener("unSortIcon",i),this.addManagedEventListeners({newColumnsLoaded:i,sortChanged:n,columnRowGroupChanged:n}),this.onSortChanged()}addInIcon(e,t,i){if(t==null)return;let n=Ni(e,this.beans,i);n&&t.appendChild(n)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){let{eSortAsc:e,eSortDesc:t,eSortNone:i,column:n,gos:o,beans:s}=this,r=s.sortSvc.getDisplaySortForColumn(n);if(e&&Je(e,r==="asc",{skipAriaHidden:!0}),t&&Je(t,r==="desc",{skipAriaHidden:!0}),i){let a=!n.getColDef().unSortIcon&&!o.get("unSortIcon"),l=r==null;Je(i,!a&&l,{skipAriaHidden:!0})}}setupMultiSortIndicator(){let{eSortMixed:e,column:t,gos:i}=this;this.addInIcon("sortUnSort",e,t);let n=t.getColDef().showRowGroup;bn(i)&&n&&(this.addManagedEventListeners({sortChanged:this.updateMultiSortIndicator.bind(this),columnRowGroupChanged:this.updateMultiSortIndicator.bind(this)}),this.updateMultiSortIndicator())}updateMultiSortIndicator(){let{eSortMixed:e,beans:t,column:i}=this;if(e){let n=t.sortSvc.getDisplaySortForColumn(i)==="mixed";Je(e,n,{skipAriaHidden:!0})}}updateSortOrder(){let{eSortOrder:e,column:t,beans:{sortSvc:i}}=this;if(!e)return;let n=i.getColumnsWithSortingOrdered(),o=i.getDisplaySortIndexForColumn(t)??-1,s=n.some(a=>i.getDisplaySortIndexForColumn(a)??!1),r=o>=0&&s;Je(e,r,{skipAriaHidden:!0}),o>=0?e.textContent=(o+1).toString():Ot(e)}},yU={selector:"AG-SORT-INDICATOR",component:_v},gd=["asc","desc",null],SU=class extends D{constructor(){super(...arguments),this.beanName="sortSvc"}progressSort(e,t,i){let n=this.getNextSortDirection(e);this.setSortForColumn(e,n,t,i)}progressSortFromEvent(e,t){let n=this.gos.get("multiSortKey")==="ctrl"?t.ctrlKey||t.metaKey:t.shiftKey;this.progressSort(e,n,"uiColumnSorted")}setSortForColumn(e,t,i,n){t!=="asc"&&t!=="desc"&&(t=null);let{gos:o,showRowGroupCols:s}=this.beans,r=bn(o),a=[e];if(r&&e.getColDef().showRowGroup){let u=s?.getSourceColumnsForGroupColumn?.(e)?.filter(h=>h.isSortable());u&&(a=[e,...u])}for(let c of a)this.setColSort(c,t,n);let l=(i||o.get("alwaysMultiSort"))&&!o.get("suppressMultiSort"),d=[];if(!l){let c=this.clearSortBarTheseColumns(a,n);d.push(...c)}this.updateSortIndex(e),d.push(...a),this.dispatchSortChangedEvents(n,d)}updateSortIndex(e){let{gos:t,colModel:i,showRowGroupCols:n}=this.beans,o=bn(t),s=n?.getShowRowGroupCol(e.getId()),r=o&&s||e,a=this.getColumnsWithSortingOrdered();i.forAllCols(c=>this.setColSortIndex(c,null));let l=a.filter(c=>o&&c.getColDef().showRowGroup?!1:c!==r);(r.getSort()?[...l,r]:l).forEach((c,u)=>this.setColSortIndex(c,u))}onSortChanged(e,t){this.dispatchSortChangedEvents(e,t)}isSortActive(){let e=!1;return this.beans.colModel.forAllCols(t=>{t.getSort()&&(e=!0)}),e}dispatchSortChangedEvents(e,t){let i={type:"sortChanged",source:e};t&&(i.columns=t),this.eventSvc.dispatchEvent(i)}clearSortBarTheseColumns(e,t){let i=[];return this.beans.colModel.forAllCols(n=>{e.includes(n)||(n.getSort()&&i.push(n),this.setColSort(n,void 0,t))}),i}getNextSortDirection(e){let t=e.getColDef().sortingOrder??this.gos.get("sortingOrder")??gd,i=t.indexOf(e.getSort()),n=i<0,o=i==t.length-1;return n||o?t[0]:t[i+1]}getIndexedSortMap(){let{gos:e,colModel:t,showRowGroupCols:i,rowGroupColsSvc:n}=this.beans,o=[];if(t.forAllCols(d=>{d.getSort()&&o.push(d)}),t.isPivotMode()){let d=bn(e);o=o.filter(c=>{let u=!!c.getAggFunc(),h=!c.isPrimary(),p=d?i?.getShowRowGroupCol(c.getId()):c.getColDef().showRowGroup;return u||h||p})}let s=n?.columns.filter(d=>!!d.getSort())??[],r={};o.forEach((d,c)=>r[d.getId()]=c),o.sort((d,c)=>{let u=d.getSortIndex(),h=c.getSortIndex();if(u!=null&&h!=null)return u-h;if(u==null&&h==null){let p=r[d.getId()],g=r[c.getId()];return p>g?1:-1}else return h==null?-1:1});let a=bn(e)&&!!s.length;a&&(o=[...new Set(o.map(d=>i?.getShowRowGroupCol(d.getId())??d))]);let l=new Map;if(o.forEach((d,c)=>l.set(d,c)),a)for(let d of s){let c=i.getShowRowGroupCol(d.getId());l.set(d,l.get(c))}return l}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort(([,e],[,t])=>e-t).map(([e])=>e)}getSortModel(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),colId:e.getId()}))}getSortOptions(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),column:e}))}canColumnDisplayMixedSort(e){let t=bn(this.gos),i=!!e.getColDef().showRowGroup;return t&&i}getDisplaySortForColumn(e){let t=this.beans.showRowGroupCols?.getSourceColumnsForGroupColumn(e);if(!this.canColumnDisplayMixedSort(e)||!t?.length)return e.getSort();let n=e.getColDef().field!=null||!!e.getColDef().valueGetter?[e,...t]:t,o=n[0].getSort();return n.every(r=>r.getSort()==o)?o:"mixed"}getDisplaySortIndexForColumn(e){return this.getIndexedSortMap().get(e)}setupHeader(e,t,i){let n=0;e.addManagedListeners(t,{movingChanged:()=>{n=Date.now()}}),i&&e.addManagedElementListeners(i,{click:s=>{let r=t.isMoving(),l=Date.now()-n<50;r||l||this.progressSortFromEvent(t,s)}});let o=()=>{let s=t.getSort();if(e.toggleCss("ag-header-cell-sorted-asc",s==="asc"),e.toggleCss("ag-header-cell-sorted-desc",s==="desc"),e.toggleCss("ag-header-cell-sorted-none",!s),t.getColDef().showRowGroup){let l=!this.beans.showRowGroupCols?.getSourceColumnsForGroupColumn(t)?.every(d=>t.getSort()==d.getSort());e.toggleCss("ag-header-cell-sorted-mixed",l)}};e.addManagedEventListeners({sortChanged:o,columnRowGroupChanged:o})}initCol(e){let{sort:t,initialSort:i,sortIndex:n,initialSortIndex:o}=e.colDef;t!==void 0?(t==="asc"||t==="desc")&&(e.sort=t):(i==="asc"||i==="desc")&&(e.sort=i),n!==void 0?n!==null&&(e.sortIndex=n):o!==null&&(e.sortIndex=o)}updateColSort(e,t,i){t!==void 0&&(t==="desc"||t==="asc"?this.setColSort(e,t,i):this.setColSort(e,void 0,i))}setColSort(e,t,i){e.sort!==t&&(e.sort=t,e.dispatchColEvent("sortChanged",i)),e.dispatchStateUpdatedEvent("sort")}setColSortIndex(e,t){e.sortIndex=t,e.dispatchStateUpdatedEvent("sortIndex")}createSortIndicator(e){return new _v(e)}getSortIndicatorSelector(){return yU}},pa={agSetColumnFilter:"SetFilter",agSetColumnFloatingFilter:"SetFilter",agMultiColumnFilter:"MultiFilter",agMultiColumnFloatingFilter:"MultiFilter",agGroupColumnFilter:"GroupFilter",agGroupColumnFloatingFilter:"GroupFilter",agGroupCellRenderer:"GroupCellRenderer",agGroupRowRenderer:"GroupCellRenderer",agRichSelect:"RichSelect",agRichSelectCellEditor:"RichSelect",agDetailCellRenderer:"SharedMasterDetail",agSparklineCellRenderer:"Sparklines",agDragAndDropImage:"SharedDragAndDrop",agColumnHeader:"ColumnHeaderComp",agColumnGroupHeader:"ColumnGroupHeaderComp",agSortIndicator:"Sort",agAnimateShowChangeCellRenderer:"HighlightChanges",agAnimateSlideCellRenderer:"HighlightChanges",agLoadingCellRenderer:"LoadingCellRenderer",agSkeletonCellRenderer:"SkeletonCellRenderer",agCheckboxCellRenderer:"CheckboxCellRenderer",agLoadingOverlay:"Overlay",agNoRowsOverlay:"Overlay",agTooltipComponent:"Tooltip",agReadOnlyFloatingFilter:"CustomFilter",agTextColumnFilter:"TextFilter",agNumberColumnFilter:"NumberFilter",agDateColumnFilter:"DateFilter",agDateInput:"DateFilter",agTextColumnFloatingFilter:"TextFilter",agNumberColumnFloatingFilter:"NumberFilter",agDateColumnFloatingFilter:"DateFilter",agCellEditor:"TextEditor",agSelectCellEditor:"SelectEditor",agTextCellEditor:"TextEditor",agNumberCellEditor:"NumberEditor",agDateCellEditor:"DateEditor",agDateStringCellEditor:"DateEditor",agCheckboxCellEditor:"CheckboxEditor",agLargeTextCellEditor:"LargeTextEditor",agMenuItem:"MenuItem",agColumnsToolPanel:"ColumnsToolPanel",agFiltersToolPanel:"FiltersToolPanel",agNewFiltersToolPanel:"NewFiltersToolPanel",agAggregationComponent:"StatusBar",agSelectedRowCountComponent:"StatusBar",agTotalRowCountComponent:"StatusBar",agFilteredRowCountComponent:"StatusBar",agTotalAndFilteredRowCountComponent:"StatusBar",agFindCellRenderer:"Find"};function vR(e){return`"${e}"`}var xU=()=>({checkboxSelection:{version:"32.2",message:"Use `rowSelection.checkboxes` in `GridOptions` instead."},headerCheckboxSelection:{version:"32.2",message:"Use `rowSelection.headerCheckbox = true` in `GridOptions` instead."},headerCheckboxSelectionFilteredOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "filtered"` in `GridOptions` instead.'},headerCheckboxSelectionCurrentPageOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "currentPage"` in `GridOptions` instead.'},showDisabledCheckboxes:{version:"32.2",message:"Use `rowSelection.hideDisabledCheckboxes = true` in `GridOptions` instead."},rowGroupingHierarchy:{version:"34.3",message:"Use `colDef.groupHierarchy` instead."}}),EU={aggFunc:"SharedAggregation",autoHeight:"RowAutoHeight",cellClass:"CellStyle",cellClassRules:"CellStyle",cellEditor:({cellEditor:e,editable:t})=>t?typeof e=="string"?pa[e]??"CustomEditor":"CustomEditor":null,cellRenderer:({cellRenderer:e})=>typeof e!="string"?null:pa[e],cellStyle:"CellStyle",columnChooserParams:"ColumnMenu",contextMenuItems:"ContextMenu",dndSource:"DragAndDrop",dndSourceOnRowDrag:"DragAndDrop",editable:({editable:e,cellEditor:t})=>e&&!t?"TextEditor":null,enableCellChangeFlash:"HighlightChanges",enablePivot:"SharedPivot",enableRowGroup:"SharedRowGrouping",enableValue:"SharedAggregation",filter:({filter:e})=>e&&typeof e!="string"&&typeof e!="boolean"?"CustomFilter":typeof e=="string"?pa[e]??"ColumnFilter":"ColumnFilter",floatingFilter:"ColumnFilter",getQuickFilterText:"QuickFilter",headerTooltip:"Tooltip",headerTooltipValueGetter:"Tooltip",mainMenuItems:"ColumnMenu",menuTabs:e=>{let t=["columnsMenuTab","generalMenuTab"];return e.menuTabs?.some(i=>t.includes(i))?"ColumnMenu":null},pivot:"SharedPivot",pivotIndex:"SharedPivot",rowDrag:"RowDrag",rowGroup:"SharedRowGrouping",rowGroupIndex:"SharedRowGrouping",tooltipField:"Tooltip",tooltipValueGetter:"Tooltip",tooltipComponentSelector:"Tooltip",spanRows:"CellSpan",groupHierarchy:"SharedRowGrouping"},RU=()=>({autoHeight:{supportedRowModels:["clientSide","serverSide"],validate:(t,{paginationAutoPageSize:i})=>i?"colDef.autoHeight is not supported with paginationAutoPageSize.":null},cellRendererParams:{validate:t=>(t.rowGroup!=null||t.rowGroupIndex!=null||t.cellRenderer==="agGroupCellRenderer")&&"checkbox"in t.cellRendererParams?'Since v33.0, `cellRendererParams.checkbox` has been deprecated. Use `rowSelection.checkboxLocation = "autoGroupColumn"` instead.':null},flex:{validate:(t,i)=>i.autoSizeStrategy?"colDef.flex is not supported with gridOptions.autoSizeStrategy":null},headerCheckboxSelection:{supportedRowModels:["clientSide","serverSide"],validate:(t,{rowSelection:i})=>i==="multiple"?null:"headerCheckboxSelection is only supported with rowSelection=multiple"},headerCheckboxSelectionCurrentPageOnly:{supportedRowModels:["clientSide"],validate:(t,{rowSelection:i})=>i==="multiple"?null:"headerCheckboxSelectionCurrentPageOnly is only supported with rowSelection=multiple"},headerCheckboxSelectionFilteredOnly:{supportedRowModels:["clientSide"],validate:(t,{rowSelection:i})=>i==="multiple"?null:"headerCheckboxSelectionFilteredOnly is only supported with rowSelection=multiple"},headerValueGetter:{validate:t=>{let i=t.headerValueGetter;return typeof i=="function"||typeof i=="string"?null:"headerValueGetter must be a function or a valid string expression"}},icons:{validate:({icons:t})=>{if(t){if(t.smallDown)return En(262);if(t.smallLeft)return En(263);if(t.smallRight)return En(264)}return null}},sortingOrder:{validate:t=>{let i=t.sortingOrder;if(Array.isArray(i)&&i.length>0){let n=i.filter(o=>!gd.includes(o));if(n.length>0)return`sortingOrder must be an array with elements from [${gd.map(up).join()}], currently it includes [${n.map(up).join()}]`}else if(!Array.isArray(i)||i.length<=0)return`sortingOrder must be an array with at least one element, currently it's ${i}`;return null}},type:{validate:t=>{let i=t.type;return i instanceof Array?i.some(o=>typeof o!="string")?"if colDef.type is supplied an array it should be of type 'string[]'":null:typeof i=="string"?null:"colDef.type should be of type 'string' | 'string[]'"}},rowSpan:{validate:(t,{suppressRowTransform:i})=>i?null:"colDef.rowSpan requires suppressRowTransform to be enabled."},spanRows:{dependencies:{editable:{required:[!1,void 0]},rowDrag:{required:[!1,void 0]},colSpan:{required:[void 0]},rowSpan:{required:[void 0]}},validate:(t,{rowSelection:i,cellSelection:n,suppressRowTransform:o,enableCellSpan:s,rowDragEntireRow:r,enableCellTextSelection:a})=>typeof i=="object"&&i?.mode==="singleRow"&&i?.enableClickSelection?"colDef.spanRows is not supported with rowSelection.clickSelection":n?"colDef.spanRows is not supported with cellSelection.":o?"colDef.spanRows is not supported with suppressRowTransform.":s?r?"colDef.spanRows is not supported with rowDragEntireRow.":a?"colDef.spanRows is not supported with enableCellTextSelection.":null:"colDef.spanRows requires enableCellSpan to be enabled."},groupHierarchy:{validate(t,{groupHierarchyConfig:i={}},n){let o=new Set(["year","quarter","month","formattedMonth","day","hour","minute","second"]),s=[];for(let r of t.groupHierarchy??[]){if(typeof r=="object"){n.validation?.validateColDef(r);continue}!o.has(r)&&!(r in i)&&s.push(vR(r))}if(s.length>0){let r=`The following parts of colDef.groupHierarchy are not recognised: ${s.join(", ")}.`,a=`Choose one of ${[...o].map(vR).join(", ")}, or define your own parts in gridOptions.groupHierarchyConfig.`;return`${r}
${a}`}return null}}}),PU={headerName:void 0,columnGroupShow:void 0,headerStyle:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,headerTooltipValueGetter:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellAriaRole:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnChooserParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressHeaderMenuButton:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,spanRows:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,tooltipComponentSelector:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0,mainMenuItems:void 0,contextMenuItems:void 0,suppressFloatingFilterButton:void 0,suppressHeaderFilterButton:void 0,suppressHeaderContextMenu:void 0,loadingCellRenderer:void 0,loadingCellRendererParams:void 0,loadingCellRendererSelector:void 0,context:void 0,dateComponent:void 0,dateComponentParams:void 0,getFindText:void 0,rowGroupingHierarchy:void 0,groupHierarchy:void 0},MU=()=>Object.keys(PU),kU=()=>({objectName:"colDef",allProperties:MU(),docsUrl:"column-properties/",deprecations:xU(),validations:RU()}),DU=["overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","groupDisplayType","treeDataDisplayType","treeDataChildrenField","treeDataParentIdField","colResizeDefault","tooltipTrigger","serverSidePivotResultFieldSeparator","columnMenu","tooltipShowMode","invalidEditValueMode","grandTotalRow","themeCssLayer","findSearchValue","styleNonce","renderingMode"],FU=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","dragAndDropImageComponentParams","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","themeStyleContainer","statusBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions","advancedFilterParent","advancedFilterBuilderParams","advancedFilterParams","initialState","autoSizeStrategy","selectionColumnDef","findOptions","filterHandlers","groupHierarchyConfig"],TU=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass","paginationPageSizeSelector"],oP=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","groupLockGroupColumns","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","pivotDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDuration","cellFadeDuration","tabIndex","pivotMaxGeneratedColumns","rowDragInsertDelay"],AU=["theme","rowSelection"],Ov=["cellSelection","sideBar","rowNumbers","suppressGroupChangesColumnVisibility","groupAggFiltering","suppressStickyTotalRow","groupHideParentOfSingleChild","enableRowPinning"],sP=["loadThemeGoogleFonts","suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHeaderFocus","suppressHorizontalScroll","groupSelectsChildren","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressColumnMoveAnimation","suppressMoveWhenColumnDragging","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","allowContextMenuWithControlKey","suppressContextMenu","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressFocusAfterRefresh","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","enableCellSpan","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","includeHiddenColumnsInAdvancedFilter","suppressMultiRangeSelection","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","tooltipInteraction","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideSortAllLevels","serverSideEnableClientSideSort","serverSideOnlyRefreshFilteredGroups","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","groupMaintainOrder","columnHoverHighlight","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressCutToClipboard","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","enableAdvancedFilter","masterDetail","treeData","reactiveCustomComponents","applyQuickFilterBeforePivotOrAgg","suppressServerSideFullWidthLoadingRow","suppressAdvancedFilterEval","loading","maintainColumnOrder","enableStrictPivotColumnOrder","suppressSetFilterByDefault","enableFilterHandlers","suppressStartEditOnTab","hidePaddedHeaderRows","ssrmExpandAllAffectsAllRows"],IU=["doesExternalFilterPass","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","dragAndDropImageComponent","fullWidthCellRenderer","loadingCellRenderer","loadingOverlayComponent","noRowsOverlayComponent","detailCellRenderer","quickFilterParser","quickFilterMatcher","getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getFullRowEditValidationErrors","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","focusGridInnerElement","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processUnpinnedColumns","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","loadingCellRendererSelector","getRowId","chartMenuItems","groupTotalRow","alwaysPassFilter","isRowPinnable","isRowPinned","isRowValidDropPosition"],LU=()=>[...TU,...FU,...DU,...oP,...IU,...sP,...Ov,...AU],_U=()=>({suppressLoadingOverlay:{version:"32",message:"Use `loading`=false instead."},enableFillHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeSelection:{version:"32.2",message:"Use `cellSelection = true` instead."},suppressMultiRangeSelection:{version:"32.2",message:"Use `cellSelection.suppressMultiRanges` instead."},suppressClearOnFillReduction:{version:"32.2",message:"Use `cellSelection.handle.suppressClearOnFillReduction` instead."},fillHandleDirection:{version:"32.2",message:"Use `cellSelection.handle.direction` instead."},fillOperation:{version:"32.2",message:"Use `cellSelection.handle.setFillValue` instead."},suppressRowClickSelection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},suppressRowDeselection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},rowMultiSelectWithClick:{version:"32.2",message:"Use `rowSelection.enableSelectionWithoutKeys` instead."},groupSelectsChildren:{version:"32.2",message:'Use `rowSelection.groupSelects = "descendants"` instead.'},groupSelectsFiltered:{version:"32.2",message:'Use `rowSelection.groupSelects = "filteredDescendants"` instead.'},isRowSelectable:{version:"32.2",message:"Use `selectionOptions.isRowSelectable` instead."},suppressCopySingleCellRanges:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},suppressCopyRowsToClipboard:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},onRangeSelectionChanged:{version:"32.2",message:"Use `onCellSelectionChanged` instead."},onRangeDeleteStart:{version:"32.2",message:"Use `onCellSelectionDeleteStart` instead."},onRangeDeleteEnd:{version:"32.2",message:"Use `onCellSelectionDeleteEnd` instead."},suppressBrowserResizeObserver:{version:"32.2",message:"The grid always uses the browser's ResizeObserver, this grid option has no effect."},onColumnEverythingChanged:{version:"32.2",message:"Either use `onDisplayedColumnsChanged` which is fired at the same time, or use one of the more specific column events."},groupRemoveSingleChildren:{version:"33",message:"Use `groupHideParentOfSingleChild` instead."},groupRemoveLowestSingleChildren:{version:"33",message:'Use `groupHideParentOfSingleChild: "leafGroupsOnly"` instead.'},suppressRowGroupHidesColumns:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressHideOnGroup"` instead.'},suppressMakeColumnVisibleAfterUnGroup:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressShowOnUngroup"` instead.'},unSortIcon:{version:"33",message:"Use `defaultColDef.unSortIcon` instead."},sortingOrder:{version:"33",message:"Use `defaultColDef.sortingOrder` instead."},suppressPropertyNamesCheck:{version:"33",message:"`gridOptions` and `columnDefs` both have a `context` property that should be used for arbitrary user data. This means that column definitions and gridOptions should only contain valid properties making this property redundant."},suppressAdvancedFilterEval:{version:"34",message:"Advanced filter no longer uses function evaluation, so this option has no effect."}});function vn(e,t,i){return typeof t=="number"||t==null?t==null||t>=i?null:`${e}: value should be greater than or equal to ${i}`:`${e}: value should be a number`}var OU={alignedGrids:"AlignedGrids",allowContextMenuWithControlKey:"ContextMenu",autoSizeStrategy:"ColumnAutoSize",cellSelection:"CellSelection",columnHoverHighlight:"ColumnHover",datasource:"InfiniteRowModel",doesExternalFilterPass:"ExternalFilter",editType:"EditCore",invalidEditValueMode:"EditCore",enableAdvancedFilter:"AdvancedFilter",enableCellSpan:"CellSpan",enableCharts:"IntegratedCharts",enableRangeSelection:"CellSelection",enableRowPinning:"PinnedRow",findSearchValue:"Find",getFullRowEditValidationErrors:"EditCore",getContextMenuItems:"ContextMenu",getLocaleText:"Locale",getMainMenuItems:"ColumnMenu",getRowClass:"RowStyle",getRowStyle:"RowStyle",groupTotalRow:"SharedRowGrouping",grandTotalRow:"ClientSideRowModelHierarchy",initialState:"GridState",isExternalFilterPresent:"ExternalFilter",isRowPinnable:"PinnedRow",isRowPinned:"PinnedRow",localeText:"Locale",masterDetail:"SharedMasterDetail",pagination:"Pagination",pinnedBottomRowData:"PinnedRow",pinnedTopRowData:"PinnedRow",pivotMode:"SharedPivot",pivotPanelShow:"RowGroupingPanel",quickFilterText:"QuickFilter",rowClass:"RowStyle",rowClassRules:"RowStyle",rowData:"ClientSideRowModel",rowDragManaged:"RowDrag",rowGroupPanelShow:"RowGroupingPanel",rowNumbers:"RowNumbers",rowSelection:"SharedRowSelection",rowStyle:"RowStyle",serverSideDatasource:"ServerSideRowModel",sideBar:"SideBar",statusBar:"StatusBar",treeData:"SharedTreeData",undoRedoCellEditing:"UndoRedoEdit",valueCache:"ValueCache",viewportDatasource:"ViewportRowModel"},NU=()=>{let e={autoSizePadding:{validate({autoSizePadding:i}){return vn("autoSizePadding",i,0)}},cacheBlockSize:{supportedRowModels:["serverSide","infinite"],validate({cacheBlockSize:i}){return vn("cacheBlockSize",i,1)}},cacheOverflowSize:{validate({cacheOverflowSize:i}){return vn("cacheOverflowSize",i,1)}},datasource:{supportedRowModels:["infinite"]},domLayout:{validate:i=>{let n=i.domLayout,o=["autoHeight","normal","print"];return n&&!o.includes(n)?`domLayout must be one of [${o.join()}], currently it's ${n}`:null}},enableFillHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeSelection:{dependencies:{rowDragEntireRow:{required:[!1,void 0]}}},enableRowPinning:{supportedRowModels:["clientSide"],validate({enableRowPinning:i,pinnedTopRowData:n,pinnedBottomRowData:o}){return i&&(n||o)?"Manual row pinning cannot be used together with pinned row data. Either set `enableRowPinning` to `false`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":null}},isRowPinnable:{supportedRowModels:["clientSide"],validate({enableRowPinning:i,isRowPinnable:n,pinnedTopRowData:o,pinnedBottomRowData:s}){return n&&(o||s)?"Manual row pinning cannot be used together with pinned row data. Either remove `isRowPinnable`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":!i&&n?"`isRowPinnable` requires `enableRowPinning` to be set.":null}},isRowPinned:{supportedRowModels:["clientSide"],validate({enableRowPinning:i,isRowPinned:n,pinnedTopRowData:o,pinnedBottomRowData:s}){return n&&(o||s)?"Manual row pinning cannot be used together with pinned row data. Either remove `isRowPinned`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":!i&&n?"`isRowPinned` requires `enableRowPinning` to be set.":null}},groupDefaultExpanded:{supportedRowModels:["clientSide"]},groupHideOpenParents:{supportedRowModels:["clientSide","serverSide"],dependencies:{groupTotalRow:{required:[void 0,"bottom"]},treeData:{required:[void 0,!1],reason:"Tree Data has values at the group level so it doesn't make sense to hide them."}}},groupHideParentOfSingleChild:{dependencies:{groupHideOpenParents:{required:[void 0,!1]}}},groupRemoveLowestSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveSingleChildren:{required:[void 0,!1]}}},groupRemoveSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveLowestSingleChildren:{required:[void 0,!1]}}},groupSelectsChildren:{dependencies:{rowSelection:{required:["multiple"]}}},groupHierarchyConfig:{validate({groupHierarchyConfig:i={}},n,o){for(let s of Object.keys(i))o.validation?.validateColDef(i[s]);return null}},icons:{validate:({icons:i})=>{if(i){if(i.smallDown)return En(262);if(i.smallLeft)return En(263);if(i.smallRight)return En(264)}return null}},infiniteInitialRowCount:{validate({infiniteInitialRowCount:i}){return vn("infiniteInitialRowCount",i,1)}},initialGroupOrderComparator:{supportedRowModels:["clientSide"]},ssrmExpandAllAffectsAllRows:{validate:i=>{if(typeof i.ssrmExpandAllAffectsAllRows=="boolean"){if(i.rowModelType!=="serverSide")return"'ssrmExpandAllAffectsAllRows' is only supported with the Server Side Row Model.";if(i.ssrmExpandAllAffectsAllRows&&typeof i.getRowId!="function")return"'getRowId' callback must be provided for Server Side Row Model grouping to work correctly."}return null}},keepDetailRowsCount:{validate({keepDetailRowsCount:i}){return vn("keepDetailRowsCount",i,1)}},paginationPageSize:{validate({paginationPageSize:i}){return vn("paginationPageSize",i,1)}},paginationPageSizeSelector:{validate:i=>{let n=i.paginationPageSizeSelector;return typeof n=="boolean"||n==null||n.length?null:`'paginationPageSizeSelector' cannot be an empty array.
                    If you want to hide the page size selector, set paginationPageSizeSelector to false.`}},pivotMode:{dependencies:{treeData:{required:[!1,void 0],reason:"Pivot Mode is not supported with Tree Data."}}},quickFilterText:{supportedRowModels:["clientSide"]},rowBuffer:{validate({rowBuffer:i}){return vn("rowBuffer",i,0)}},rowClass:{validate:i=>typeof i.rowClass=="function"?"rowClass should not be a function, please use getRowClass instead":null},rowData:{supportedRowModels:["clientSide"]},rowDragManaged:{supportedRowModels:["clientSide"],dependencies:{pagination:{required:[!1,void 0]}}},rowSelection:{validate({rowSelection:i}){return i&&typeof i=="string"?'As of version 32.2.1, using `rowSelection` with the values "single" or "multiple" has been deprecated. Use the object value instead.':i&&typeof i!="object"?"Expected `RowSelectionOptions` object for the `rowSelection` property.":i&&i.mode!=="multiRow"&&i.mode!=="singleRow"?`Selection mode "${i.mode}" is invalid. Use one of 'singleRow' or 'multiRow'.`:null}},rowStyle:{validate:i=>{let n=i.rowStyle;return n&&typeof n=="function"?"rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead":null}},serverSideDatasource:{supportedRowModels:["serverSide"]},serverSideInitialRowCount:{supportedRowModels:["serverSide"],validate({serverSideInitialRowCount:i}){return vn("serverSideInitialRowCount",i,1)}},serverSideOnlyRefreshFilteredGroups:{supportedRowModels:["serverSide"]},serverSideSortAllLevels:{supportedRowModels:["serverSide"]},sortingOrder:{validate:i=>{let n=i.sortingOrder;if(Array.isArray(n)&&n.length>0){let o=n.filter(s=>!gd.includes(s));if(o.length>0)return`sortingOrder must be an array with elements from [${gd.map(up).join()}], currently it includes [${o.map(up).join()}]`}else if(!Array.isArray(n)||n.length<=0)return`sortingOrder must be an array with at least one element, currently it's ${n}`;return null}},tooltipHideDelay:{validate:i=>i.tooltipHideDelay&&i.tooltipHideDelay<0?"tooltipHideDelay should not be lower than 0":null},tooltipShowDelay:{validate:i=>i.tooltipShowDelay&&i.tooltipShowDelay<0?"tooltipShowDelay should not be lower than 0":null},treeData:{supportedRowModels:["clientSide","serverSide"],validate:i=>{let n=i.rowModelType??"clientSide";switch(n){case"clientSide":{let{treeDataChildrenField:o,treeDataParentIdField:s,getDataPath:r,getRowId:a}=i;if(!o&&!s&&!r)return"treeData requires either 'treeDataChildrenField' or 'treeDataParentIdField' or 'getDataPath' in the clientSide row model.";if(o){if(r)return"Cannot use both 'treeDataChildrenField' and 'getDataPath' at the same time.";if(s)return"Cannot use both 'treeDataChildrenField' and 'treeDataParentIdField' at the same time."}if(s){if(!a)return"getRowId callback not provided, tree data with parent id cannot be built.";if(r)return"Cannot use both 'treeDataParentIdField' and 'getDataPath' at the same time."}return null}case"serverSide":{let o=`treeData requires 'isServerSideGroup' and 'getServerSideGroupKey' in the ${n} row model.`;return i.isServerSideGroup&&i.getServerSideGroupKey?null:o}}return null}},viewportDatasource:{supportedRowModels:["viewport"]},viewportRowModelBufferSize:{validate({viewportRowModelBufferSize:i}){return vn("viewportRowModelBufferSize",i,0)}},viewportRowModelPageSize:{validate({viewportRowModelPageSize:i}){return vn("viewportRowModelPageSize",i,1)}},rowDragEntireRow:{dependencies:{cellSelection:{required:[void 0]}}},autoGroupColumnDef:{validate({autoGroupColumnDef:i,showOpenedGroup:n}){return i?.field&&n?"autoGroupColumnDef.field and showOpenedGroup are not supported when used together.":i?.valueGetter&&n?"autoGroupColumnDef.valueGetter and showOpenedGroup are not supported when used together.":null}},renderingMode:{validate:i=>{let n=i.renderingMode,o=["default","legacy"];return n&&!o.includes(n)?`renderingMode must be one of [${o.join()}], currently it's ${n}`:null}},autoSizeStrategy:{validate:({autoSizeStrategy:i})=>{if(!i)return null;let n=["fitCellContents","fitGridWidth","fitProvidedWidth"],o=i.type;return o!=="fitCellContents"&&o!=="fitGridWidth"&&o!=="fitProvidedWidth"?`Invalid Auto-size strategy. \`autoSizeStrategy\` must be one of ${n.map(s=>'"'+s+'"').join(", ")}, currently it's ${o}`:o==="fitProvidedWidth"&&typeof i.width!="number"?`When using the 'fitProvidedWidth' auto-size strategy, must provide a numeric \`width\`. You provided ${i.width}`:null}}},t={};for(let i of sP)t[i]={expectedType:"boolean"};for(let i of oP)t[i]={expectedType:"number"};return ni(t,e),t},BU=()=>({objectName:"gridOptions",allProperties:[...LU(),...Object.values(Lv)],propertyExceptions:["api"],docsUrl:"grid-options/",deprecations:_U(),validations:NU()}),HU=0,GU=0,wR="__ag_grid_instance",VU=class extends D{constructor(){super(...arguments),this.beanName="gos",this.domDataKey="__AG_"+Math.random().toString(),this.instanceId=GU++,this.gridReadyFired=!1,this.queueEvents=[],this.propEventSvc=new qs,this.globalEventHandlerFactory=e=>(t,i)=>{if(!this.isAlive())return;let n=np.has(t);if(n&&!e||!n&&e||!zU(t))return;let o=(s,r)=>{let a=Lv[s],l=this.gridOptions[a];typeof l=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>l(r))};if(this.gridReadyFired)o(t,i);else if(t==="gridReady"){o(t,i),this.gridReadyFired=!0;for(let s of this.queueEvents)o(s.eventName,s.event);this.queueEvents=[]}else this.queueEvents.push({eventName:t,event:i})}}wireBeans(e){this.gridOptions=e.gridOptions,this.validation=e.validation,this.api=e.gridApi,this.gridId=e.context.getId()}get gridOptionsContext(){return this.gridOptions.context}postConstruct(){this.validateGridOptions(this.gridOptions),this.eventSvc.addGlobalListener(this.globalEventHandlerFactory().bind(this),!0),this.eventSvc.addGlobalListener(this.globalEventHandlerFactory(!0).bind(this),!1),this.propEventSvc.setFrameworkOverrides(this.beans.frameworkOverrides),this.addManagedEventListeners({gridOptionsChanged:({options:e})=>{this.updateGridOptions({options:e,force:!0,source:"optionsUpdated"})}})}destroy(){super.destroy(),this.queueEvents=[]}get(e){return this.gridOptions[e]??$_[e]}getCallback(e){return this.mergeGridCommonParams(this.gridOptions[e])}exists(e){return q(this.gridOptions[e])}mergeGridCommonParams(e){return e&&(i=>e(this.addCommon(i)))}updateGridOptions({options:e,force:t,source:i="api"}){let n={id:HU++,properties:[]},o=[],{gridOptions:s,validation:r}=this;for(let a of Object.keys(e)){let l=lv.applyGlobalGridOption(a,e[a]);r?.warnOnInitialPropertyUpdate(i,a);let d=t||typeof l=="object"&&i==="api",c=s[a];if(d||c!==l){s[a]=l;let u={type:a,currentValue:l,previousValue:c,changeSet:n,source:i};o.push(u)}}this.validateGridOptions(this.gridOptions),n.properties=o.map(a=>a.type);for(let a of o)Ko(this,`Updated property ${a.type} from`,a.previousValue," to ",a.currentValue),this.propEventSvc.dispatchEvent(a)}addPropertyEventListener(e,t){this.propEventSvc.addEventListener(e,t)}removePropertyEventListener(e,t){this.propEventSvc.removeEventListener(e,t)}getDomDataKey(){return this.domDataKey}addCommon(e){return e.api=this.api,e.context=this.gridOptionsContext,e}validateOptions(e,t){for(let i of Object.keys(e)){let n=e[i];if(n==null||n===!1)continue;let o=t[i];typeof o=="function"&&(o=o(e,this.gridOptions,this.beans)),o&&this.assertModuleRegistered(o,i)}}validateGridOptions(e){this.validateOptions(e,OU),this.validation?.processGridOptions(e)}validateColDef(e,t,i){(i||!this.beans.dataTypeSvc?.isColPendingInference(t))&&(this.validateOptions(e,EU),this.validation?.validateColDef(e))}assertModuleRegistered(e,t){let i=Array.isArray(e)?e.some(n=>this.isModuleRegistered(n)):this.isModuleRegistered(e);return i||Ge(200,_(b({},this.getModuleErrorParams()),{moduleName:e,reasonOrId:t})),i}getModuleErrorParams(){return{gridId:this.gridId,gridScoped:dv(),rowModelType:this.get("rowModelType"),isUmd:d6()}}isModuleRegistered(e){return SC(e,this.gridId,this.get("rowModelType"))}setInstanceDomData(e){e[wR]=this.instanceId}isElementInThisInstance(e){let t=e;for(;t;){let i=t[wR];if(q(i))return i===this.instanceId;t=t.parentElement}return!1}};function zU(e){return!!Lv[e]}function rP(e){let t={"aria-hidden":"true"};return{tag:"div",cls:"ag-cell-label-container",role:"presentation",children:[{tag:"span",ref:"eMenu",cls:"ag-header-icon ag-header-cell-menu-button",attrs:t},{tag:"span",ref:"eFilterButton",cls:"ag-header-icon ag-header-cell-filter-button",attrs:t},{tag:"div",ref:"eLabel",cls:"ag-header-cell-label",role:"presentation",children:[{tag:"span",ref:"eText",cls:"ag-header-cell-text"},{tag:"span",ref:"eFilter",cls:"ag-header-icon ag-header-label-icon ag-filter-icon",attrs:t},e?{tag:"ag-sort-indicator",ref:"eSortIndicator"}:null]}]}}var WU=rP(!0),UU=rP(!1),qU=class extends Oe{constructor(){super(...arguments),this.eFilter=V,this.eFilterButton=V,this.eSortIndicator=V,this.eMenu=V,this.eLabel=V,this.eText=V,this.eSortOrder=V,this.eSortAsc=V,this.eSortDesc=V,this.eSortMixed=V,this.eSortNone=V,this.isLoadingInnerComponent=!1}refresh(e){let t=this.params;if(this.params=e,this.workOutTemplate(e,!!this.beans?.sortSvc)!=this.currentTemplate||this.workOutShowMenu()!=this.currentShowMenu||e.enableSorting!=this.currentSort||this.currentSuppressMenuHide!=null&&this.shouldSuppressMenuHide()!=this.currentSuppressMenuHide||t.enableFilterButton!=e.enableFilterButton||t.enableFilterIcon!=e.enableFilterIcon)return!1;if(this.innerHeaderComponent){let i=b({},e);ni(i,e.innerHeaderComponentParams),this.innerHeaderComponent.refresh?.(i)}else this.setDisplayName(e);return!0}workOutTemplate(e,t){let i=e.template;return i?i?.trim?i.trim():i:t?WU:UU}init(e){this.params=e;let{sortSvc:t,touchSvc:i,rowNumbersSvc:n,userCompFactory:o}=this.beans,s=t?.getSortIndicatorSelector();this.currentTemplate=this.workOutTemplate(e,!!s),this.setTemplate(this.currentTemplate,s?[s]:void 0),i?.setupForHeader(this),this.setMenu(),this.setupSort(),n?.setupForHeader(this),this.setupFilterIcon(),this.setupFilterButton(),this.workOutInnerHeaderComponent(o,e),this.setDisplayName(e)}workOutInnerHeaderComponent(e,t){let i=hN(e,t,t);i&&(this.isLoadingInnerComponent=!0,i.newAgStackInstance().then(n=>{this.isLoadingInnerComponent=!1,n&&(this.isAlive()?(this.innerHeaderComponent=n,this.eText&&this.eText.appendChild(n.getGui())):this.destroyBean(n))}))}setDisplayName(e){let{displayName:t}=e,i=this.currentDisplayName;this.currentDisplayName=t,!(!this.eText||i===t||this.innerHeaderComponent||this.isLoadingInnerComponent)&&(this.eText.textContent=Sa(t))}addInIcon(e,t,i){let n=Ni(e,this.beans,i);n&&t.appendChild(n)}workOutShowMenu(){return this.params.enableMenu&&!!this.beans.menuSvc?.isHeaderMenuButtonEnabled()}shouldSuppressMenuHide(){return!!this.beans.menuSvc?.isHeaderMenuButtonAlwaysShowEnabled()}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu){hi(this.eMenu),this.eMenu=void 0;return}let{gos:e,eMenu:t,params:i}=this,n=yi(e);this.addInIcon(n?"menu":"menuAlt",t,i.column),t.classList.toggle("ag-header-menu-icon",!n);let o=this.shouldSuppressMenuHide();this.currentSuppressMenuHide=o,this.addManagedElementListeners(t,{click:()=>this.showColumnMenu(this.eMenu)}),this.toggleMenuAlwaysShow(o)}toggleMenuAlwaysShow(e){this.eMenu?.classList.toggle("ag-header-menu-always-show",e)}showColumnMenu(e){let{currentSuppressMenuHide:t,params:i}=this;t||this.toggleMenuAlwaysShow(!0),i.showColumnMenu(e,()=>{t||this.toggleMenuAlwaysShow(!1)})}onMenuKeyboardShortcut(e){let{params:t,gos:i,beans:n,eMenu:o,eFilterButton:s}=this,r=t.column,a=yi(i);if(e&&!a){if(n.menuSvc?.isFilterMenuInHeaderEnabled(r))return t.showFilter(s??o??this.getGui()),!0}else if(t.enableMenu)return this.showColumnMenu(o??s??this.getGui()),!0;return!1}setupSort(){let{sortSvc:e}=this.beans;if(!e)return;let{enableSorting:t,column:i}=this.params;if(this.currentSort=t,!this.eSortIndicator){this.eSortIndicator=this.createBean(e.createSortIndicator(!0));let{eSortIndicator:n,eSortOrder:o,eSortAsc:s,eSortDesc:r,eSortMixed:a,eSortNone:l}=this;n.attachCustomElements(o,s,r,a,l)}this.eSortIndicator.setupSort(i),this.currentSort&&e.setupHeader(this,i,this.eLabel)}setupFilterIcon(){let{eFilter:e,params:t}=this;if(!e)return;let i=()=>{let n=t.column.isFilterActive();Je(e,n,{skipAriaHidden:!0})};this.configureFilter(t.enableFilterIcon,e,i,"filterActive")}setupFilterButton(){let{eFilterButton:e,params:t}=this;if(!e)return;this.configureFilter(t.enableFilterButton,e,this.onFilterChangedButton.bind(this),"filter")?this.addManagedElementListeners(e,{click:()=>t.showFilter(e)}):this.eFilterButton=void 0}configureFilter(e,t,i,n){if(!e)return hi(t),!1;let o=this.params.column;return this.addInIcon(n,t,o),this.addManagedListeners(o,{filterChanged:i}),i(),!0}onFilterChangedButton(){let e=this.params.column.isFilterActive();this.eFilterButton.classList.toggle("ag-filter-active",e)}getAnchorElementForMenu(e){let{eFilterButton:t,eMenu:i}=this;return e?t??i??this.getGui():i??t??this.getGui()}destroy(){super.destroy(),this.innerHeaderComponent&&(this.destroyBean(this.innerHeaderComponent),this.innerHeaderComponent=void 0)}},$U={tag:"div",cls:"ag-header-group-cell-label",role:"presentation",children:[{tag:"span",ref:"agLabel",cls:"ag-header-group-text",role:"presentation"},{tag:"span",ref:"agOpened",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"},{tag:"span",ref:"agClosed",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"}]},jU=class extends Oe{constructor(){super($U),this.agOpened=V,this.agClosed=V,this.agLabel=V,this.isLoadingInnerComponent=!1}init(e){let{userCompFactory:t,touchSvc:i}=this.beans;this.params=e,this.checkWarnings(),this.workOutInnerHeaderGroupComponent(t,e),this.setupLabel(e),this.addGroupExpandIcon(e),this.setupExpandIcons(),i?.setupForHeaderGroup(this)}checkWarnings(){this.params.template&&I(89)}workOutInnerHeaderGroupComponent(e,t){let i=gN(e,t,t);i&&(this.isLoadingInnerComponent=!0,i.newAgStackInstance().then(n=>{this.isLoadingInnerComponent=!1,n&&(this.isAlive()?(this.innerHeaderGroupComponent=n,this.agLabel.appendChild(n.getGui())):this.destroyBean(n))}))}setupExpandIcons(){let{agOpened:e,agClosed:t,params:{columnGroup:i},beans:n}=this;this.addInIcon("columnGroupOpened",e),this.addInIcon("columnGroupClosed",t);let o=l=>{if(co(l))return;let d=!i.isExpanded();n.colGroupSvc.setColumnGroupOpened(i.getProvidedColumnGroup(),d,"uiColumnExpanded")};this.addTouchAndClickListeners(n,t,o),this.addTouchAndClickListeners(n,e,o);let s=l=>{Ks(l)};this.addManagedElementListeners(t,{dblclick:s}),this.addManagedElementListeners(e,{dblclick:s}),this.addManagedElementListeners(this.getGui(),{dblclick:o}),this.updateIconVisibility();let r=i.getProvidedColumnGroup(),a=this.updateIconVisibility.bind(this);this.addManagedListeners(r,{expandedChanged:a,expandableChanged:a})}addTouchAndClickListeners(e,t,i){e.touchSvc?.setupForHeaderGroupElement(this,t,i),this.addManagedElementListeners(t,{click:i})}updateIconVisibility(){let{agOpened:e,agClosed:t,params:{columnGroup:i}}=this;if(i.isExpandable()){let n=i.isExpanded();Je(e,n),Je(t,!n)}else Je(e,!1),Je(t,!1)}addInIcon(e,t){let i=Ni(e,this.beans,null);i&&t.appendChild(i)}addGroupExpandIcon(e){if(!e.columnGroup.isExpandable()){let{agOpened:t,agClosed:i}=this;Je(t,!1),Je(i,!1)}}setupLabel(e){let{displayName:t,columnGroup:i}=e,n=this.innerHeaderGroupComponent||this.isLoadingInnerComponent;q(t)&&!n&&(this.agLabel.textContent=Sa(t)),this.toggleCss("ag-sticky-label",!i.getColGroupDef()?.suppressStickyLabel)}destroy(){super.destroy(),this.innerHeaderGroupComponent&&(this.destroyBean(this.innerHeaderGroupComponent),this.innerHeaderGroupComponent=void 0)}},KU={moduleName:"ColumnHeaderComp",version:z,userComponents:{agColumnHeader:qU},icons:{menu:"menu",menuAlt:"menu-alt"}},YU={moduleName:"ColumnGroupHeaderComp",version:z,userComponents:{agColumnGroupHeader:jU},icons:{columnGroupOpened:"expanded",columnGroupClosed:"contracted"}},XU=class extends D{constructor(){super(...arguments),this.beanName="animationFrameSvc",this.p1={list:[],sorted:!1},this.p2={list:[],sorted:!1},this.f1={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastScrollTop=0,this.taskCount=0}setScrollTop(e){this.scrollGoingDown=e>=this.lastScrollTop,e===0&&(this.scrollGoingDown=!0),this.lastScrollTop=e}postConstruct(){this.active=!this.gos.get("suppressAnimationFrame"),this.batchFrameworkComps=this.beans.frameworkOverrides.batchFrameworkComps}verify(){this.active===!1&&I(92)}createTask(e,t,i,n,o=!1){this.verify();let s=i;n&&this.batchFrameworkComps&&(s="f1");let r={task:e,index:t,createOrder:++this.taskCount,deferred:o};this.addTaskToList(this[s],r),this.schedule()}addTaskToList(e,t){e.list.push(t),e.sorted=!1}sortTaskList(e){if(e.sorted)return;let t=this.scrollGoingDown?1:-1;e.list.sort((i,n)=>i.deferred!==n.deferred?i.deferred?-1:1:i.index!==n.index?t*(n.index-i.index):n.createOrder-i.createOrder),e.sorted=!0}addDestroyTask(e){this.verify(),this.destroyTasks.push(e),this.schedule()}executeFrame(e){let{p1:t,p2:i,f1:n,destroyTasks:o,beans:s}=this,{ctrlsSvc:r,frameworkOverrides:a}=s,l=t.list,d=i.list,c=n.list,u=Date.now(),h=0,p=e<=0,g=r.getScrollFeature();for(;p||h<e;){if(!g.scrollGridIfNeeded()){let m;if(l.length)this.sortTaskList(t),m=l.pop().task;else if(d.length)this.sortTaskList(i),m=d.pop().task;else if(c.length)a.wrapOutgoing(()=>{for(;(p||h<e)&&!g.scrollGridIfNeeded();){if(c.length)this.sortTaskList(n),m=c.pop().task,m();else break;h=Date.now()-u}}),m=()=>{};else if(o.length)m=o.pop();else break;m()}h=Date.now()-u}l.length||d.length||c.length||o.length?this.requestFrame():this.ticking=!1}flushAllFrames(){this.active&&this.executeFrame(-1)}schedule(){this.active&&(this.ticking||(this.ticking=!0,this.requestFrame()))}requestFrame(){let e=this.executeFrame.bind(this,60);po(this.beans,e)}isQueueEmpty(){return!this.ticking}},JU={moduleName:"AnimationFrame",version:z,beans:[XU]},QU=class extends D{constructor(){super(...arguments),this.beanName="iconSvc"}createIconNoSpan(e,t){return Ni(e,this.beans,t?.column)}},ZU=class extends D{constructor(){super(...arguments),this.beanName="touchSvc"}mockBodyContextMenu(e,t){this.mockContextMenu(e,e.eBodyViewport,t)}mockHeaderContextMenu(e,t){this.mockContextMenu(e,e.eGui,t)}mockRowContextMenu(e){if(!zs())return;let t=(i,n,o)=>{let{rowCtrl:s,cellCtrl:r}=e.getControlsForEventTarget(o?.target??null);r?.column&&r.dispatchCellContextMenuEvent(o??null),this.beans.contextMenuSvc?.handleContextMenuMouseEvent(void 0,o,s,r)};this.mockContextMenu(e,e.element,t)}handleCellDoubleClick(e,t){return(()=>{if(!zs()||t6("dblclick"))return!1;let n=Date.now(),o=n-e.lastIPadMouseClickEvent<200;return e.lastIPadMouseClickEvent=n,o})()?(e.onCellDoubleClicked(t),t.preventDefault(),!0):!1}setupForHeader(e){let{gos:t,sortSvc:i,menuSvc:n}=this.beans;if(t.get("suppressTouch"))return;let{params:o,eMenu:s,eFilterButton:r}=e,a=new Os(e.getGui(),!0);e.addDestroyFunc(()=>a.destroy());let l=e.shouldSuppressMenuHide(),d=l&&q(s)&&o.enableMenu,c=a;if(d&&(c=new Os(s,!0),e.addDestroyFunc(()=>c.destroy())),o.enableMenu||n?.isHeaderContextMenuEnabled(o.column)){let u=d?"tap":"longTap",h=p=>o.showColumnMenuAfterMouseClick(p.touchStart);e.addManagedListeners(c,{[u]:h}),e.addManagedListeners(a,{longTap:h})}if(o.enableSorting){let u=h=>{let p=h.touchStart.target;l&&(s?.contains(p)||r?.contains(p))||i?.progressSort(o.column,!1,"uiColumnSorted")};e.addManagedListeners(a,{tap:u})}if(o.enableFilterButton&&r){let u=new Os(r,!0);e.addManagedListeners(u,{tap:()=>o.showFilter(r)}),e.addDestroyFunc(()=>u.destroy())}}setupForHeaderGroup(e){let t=e.params;if(this.beans.menuSvc?.isHeaderContextMenuEnabled(t.columnGroup.getProvidedColumnGroup())){let i=new Os(t.eGridHeader,!0),n=o=>t.showColumnMenuAfterMouseClick(o.touchStart);e.addManagedListeners(i,{longTap:n}),e.addDestroyFunc(()=>i.destroy())}}setupForHeaderGroupElement(e,t,i){let n=new Os(t,!0);e.addManagedListeners(n,{tap:i}),e.addDestroyFunc(()=>n.destroy())}mockContextMenu(e,t,i){if(!zs())return;let n=new Os(t),o=s=>{ad(this.beans,s.touchEvent)&&i(void 0,s.touchStart,s.touchEvent)};e.addManagedListeners(n,{longTap:o}),e.addDestroyFunc(()=>n.destroy())}},eq={moduleName:"Touch",version:z,beans:[ZU]},tq=class extends D{constructor(){super(...arguments),this.beanName="cellNavigation"}wireBeans(e){this.rowSpanSvc=e.rowSpanSvc}getNextCellToFocus(e,t,i=!1){return i?this.getNextCellToFocusWithCtrlPressed(e,t):this.getNextCellToFocusWithoutCtrlPressed(e,t)}getNextCellToFocusWithCtrlPressed(e,t){let i=e===R.UP,n=e===R.DOWN,o=e===R.LEFT,s,r,{pageBounds:a,gos:l,visibleCols:d,pinnedRowModel:c}=this.beans,{rowPinned:u}=t;if(i||n)u&&c?i?r=0:r=u==="top"?c.getPinnedTopRowCount()-1:c.getPinnedBottomRowCount()-1:r=i?a.getFirstRow():a.getLastRow(),s=t.column;else{let h=l.get("enableRtl");r=t.rowIndex,s=(o!==h?d.allCols:[...d.allCols].reverse()).find(g=>this.isCellGoodToFocusOn({rowIndex:r,rowPinned:null,column:g}))}return s?{rowIndex:r,rowPinned:u,column:s}:null}getNextCellToFocusWithoutCtrlPressed(e,t){let i=t,n=!1;for(;!n;){switch(e){case R.UP:i=this.getCellAbove(i);break;case R.DOWN:i=this.getCellBelow(i);break;case R.RIGHT:i=this.gos.get("enableRtl")?this.getCellToLeft(i):this.getCellToRight(i);break;case R.LEFT:i=this.gos.get("enableRtl")?this.getCellToRight(i):this.getCellToLeft(i);break;default:i=null,I(8,{key:e});break}i?n=this.isCellGoodToFocusOn(i):n=!0}return i}isCellGoodToFocusOn(e){let t=e.column,i,{pinnedRowModel:n,rowModel:o}=this.beans;switch(e.rowPinned){case"top":i=n?.getPinnedTopRow(e.rowIndex);break;case"bottom":i=n?.getPinnedBottomRow(e.rowIndex);break;default:i=o.getRow(e.rowIndex);break}return i?!this.isSuppressNavigable(t,i):!1}getCellToLeft(e){if(!e)return null;let t=this.beans.visibleCols.getColBefore(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellToRight(e){if(!e)return null;let t=this.beans.visibleCols.getColAfter(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellBelow(e){if(!e)return null;let t=this.rowSpanSvc?.getCellEnd(e)??e,i=sR(this.beans,t,!0);return i?{rowIndex:i.rowIndex,column:e.column,rowPinned:i.rowPinned}:null}getCellAbove(e){if(!e)return null;let t=this.rowSpanSvc?.getCellStart(e)??e,i=xp(this.beans,{rowIndex:t.rowIndex,rowPinned:t.rowPinned},!0);return i?{rowIndex:i.rowIndex,column:e.column,rowPinned:i.rowPinned}:null}getNextTabbedCell(e,t){return t?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)}getNextTabbedCellForwards(e){let{visibleCols:t,pagination:i}=this.beans,n=t.allCols,o=e.rowIndex,s=e.rowPinned,r=t.getColAfter(e.column);if(!r){r=n[0];let a=sR(this.beans,e,!0);if(Qe(a)||!a.rowPinned&&!(i?.isRowInPage(a.rowIndex)??!0))return null;o=a?a.rowIndex:null,s=a?a.rowPinned:null}return{rowIndex:o,column:r,rowPinned:s}}getNextTabbedCellBackwards(e){let{beans:t}=this,{visibleCols:i,pagination:n}=t,o=i.allCols,s=e.rowIndex,r=e.rowPinned,a=i.getColBefore(e.column);if(!a){a=Ue(o);let l=xp(t,{rowIndex:e.rowIndex,rowPinned:e.rowPinned},!0);if(Qe(l)||!l.rowPinned&&!(n?.isRowInPage(l.rowIndex)??!0))return null;s=l?l.rowIndex:null,r=l?l.rowPinned:null}return{rowIndex:s,column:a,rowPinned:r}}isSuppressNavigable(e,t){let{suppressNavigable:i}=e.colDef;if(typeof i=="boolean")return i;if(typeof i=="function"){let n=e.createColumnFunctionCallbackParams(t);return i(n)}return!1}};function iq(e){return e.focusSvc.getFocusedCell()}function nq(e){return e.focusSvc.clearFocusedCell()}function oq(e,t,i,n){e.focusSvc.setFocusedCell({rowIndex:t,column:i,rowPinned:n,forceBrowserFocus:!0})}function sq(e,t){return e.navigation?.tabToNextCell(!1,t)??!1}function rq(e,t){return e.navigation?.tabToNextCell(!0,t)??!1}function aq(e,t,i=!1){let n=e.headerNavigation?.getHeaderPositionForColumn(t,i);n&&e.focusSvc.focusHeaderPosition({headerPosition:n})}var lq=class extends D{constructor(){super(...arguments),this.beanName="editModelSvc",this.edits=new Map,this.cellValidations=new aP,this.rowValidations=new lP,this.suspendEdits=!1}suspend(e){this.suspendEdits=e}removeEdits({rowNode:e,column:t}){if(!this.hasEdits({rowNode:e})||!e)return;let i=this.getEditRow(e);t?i.delete(t):i.clear(),i.size===0&&this.edits.delete(e)}getEditRow(e,t={}){if(this.suspendEdits||this.edits.size===0)return;let i=e&&this.edits.get(e);if(i)return i;if(t.checkSiblings){let n=e.pinnedSibling;if(n)return this.getEditRow(n)}}getEditRowDataValue(e,{checkSiblings:t}={}){if(!e||this.edits.size===0)return;let i=this.getEditRow(e),n=e.pinnedSibling,o=t&&n&&this.getEditRow(n);if(!i&&!o)return;let s=Object.assign({},e.data),r=(a,l)=>a.forEach(({pendingValue:d},c)=>{d!==Bi&&(l[c.getColId()]=d)});return i&&r(i,s),o&&r(o,s),s}getEdit(e,t){let i=this._getEdit(e);return t&&i?b({},i):i}_getEdit(e){if(!this.suspendEdits&&this.edits.size!==0)return e.rowNode&&e.column&&this.getEditRow(e.rowNode)?.get(e.column)}getEditMap(e=!0){if(this.suspendEdits||this.edits.size===0)return new Map;if(!e)return this.edits;let t=new Map;return this.edits.forEach((i,n)=>{let o=new Map;i.forEach((l,a)=>{var d=l,{editorState:s}=d,r=oi(d,["editorState"]);return o.set(a,b({},r))}),t.set(n,o)}),t}setEditMap(e){this.edits.clear(),e.forEach((t,i)=>{let n=new Map;t.forEach((o,s)=>n.set(s,b({},o))),this.edits.set(i,n)})}setEdit(e,t){(this.edits.size===0||!this.edits.has(e.rowNode))&&this.edits.set(e.rowNode,new Map);let i=this._getEdit(e),n=Object.assign(b(b({editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}},i),t));return this.getEditRow(e.rowNode).set(e.column,n),n}clearEditValue(e){let{rowNode:t,column:i}=e;if(t)if(i){let n=this._getEdit(e);n&&(n.editorValue=void 0,n.pendingValue=n.sourceValue,n.state="changed")}else this.getEditRow(t)?.forEach(n=>{n.editorValue=void 0,n.pendingValue=n.sourceValue,n.state="changed"})}getState(e){if(!this.suspendEdits)return this.getEdit(e)?.state}getEditPositions(e){if(this.suspendEdits||(e??this.edits).size===0)return[];let t=[];return(e??this.edits).forEach((i,n)=>{for(let s of i.keys()){let o=i.get(s),{editorState:r}=o,a=oi(o,["editorState"]);t.push(b({rowNode:n,column:s},a))}}),t}hasRowEdits(e,t){return this.suspendEdits||this.edits.size===0?!1:!!this.getEditRow(e,t)}hasEdits(e={},t={}){if(this.suspendEdits||this.edits.size===0)return!1;let{rowNode:i,column:n}=e,{withOpenEditor:o}=t;if(i){let s=this.getEditRow(i,t);return s?n?o?this.getEdit(e)?.state==="editing":s.has(n)??!1:s.size!==0?o?Array.from(s.values()).some(({state:r})=>r==="editing"):!0:!1:!1}return o?this.getEditPositions().some(({state:s})=>s==="editing"):this.edits.size>0}start(e){let t=this.getEditRow(e.rowNode)??new Map,{rowNode:i,column:n}=e;n&&!t.has(n)&&t.set(n,{editorValue:void 0,pendingValue:Bi,sourceValue:this.beans.valueSvc.getValue(n,i,!1,"api"),state:"editing",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}}),this.edits.set(i,t)}stop(e){this.hasEdits(e)&&(e?this.removeEdits(e):this.clear())}clear(){for(let e of this.edits.values())e.clear();this.edits.clear()}getCellValidationModel(){return this.cellValidations}getRowValidationModel(){return this.rowValidations}setCellValidationModel(e){this.cellValidations=e}setRowValidationModel(e){this.rowValidations=e}destroy(){super.destroy(),this.clear()}},aP=class{constructor(){this.cellValidations=new Map}getCellValidation(e){let{rowNode:t,column:i}=e||{};return this.cellValidations?.get(t)?.get(i)}hasCellValidation(e){return!e?.rowNode||!e.column?this.cellValidations.size>0:!!this.getCellValidation(e)}setCellValidation(e,t){let{rowNode:i,column:n}=e;this.cellValidations.has(i)||this.cellValidations.set(i,new Map),this.cellValidations.get(i).set(n,t)}clearCellValidation(e){let{rowNode:t,column:i}=e;this.cellValidations.get(t)?.delete(i)}setCellValidationMap(e){this.cellValidations=e}getCellValidationMap(){return this.cellValidations}clearCellValidationMap(){this.cellValidations.clear()}},lP=class{constructor(){this.rowValidations=new Map}getRowValidation(e){let{rowNode:t}=e||{};return this.rowValidations.get(t)}hasRowValidation(e){return e?.rowNode?!!this.getRowValidation(e):this.rowValidations.size>0}setRowValidation({rowNode:e},t){this.rowValidations.set(e,t)}clearRowValidation({rowNode:e}){this.rowValidations.delete(e)}setRowValidationMap(e){this.rowValidations=e}getRowValidationMap(){return this.rowValidations}clearRowValidationMap(){this.rowValidations.clear()}};function Nv(e,t={}){let{rowIndex:i,rowId:n,rowCtrl:o,rowPinned:s}=t;if(o)return o;let{rowModel:r,rowRenderer:a}=e,{rowNode:l}=t;return l||(n?l=LV(e,n,s):i!=null&&(l=r.getRow(i))),a.getRowCtrls(l?[l]:[])?.[0]}function et(e,t={}){let{cellCtrl:i,colId:n,columnId:o,column:s}=t;if(i)return i;let r=e.colModel.getCol(n??o??$C(s)),a=t.rowCtrl??Nv(e,t),l=a?.getCellCtrl(r)??void 0;if(l)return l;let d=t.rowNode??a?.rowNode;if(d)return e.rowRenderer.getCellCtrls([d],[r])?.[0]}function bR(e){let{editSvc:t}=e;t?.isBatchEditing()?ga(e):t?.stopEditing(void 0,{source:"api"})}function dq(e,t,i){let{gos:n,popupSvc:o}=t;if(!n.get("stopEditingWhenCellsLoseFocus"))return;let s=r=>{let a=r.relatedTarget;if(FC(a)===null){bR(t);return}let l=i.some(d=>d.contains(a))&&n.isElementInThisInstance(a);l||(l=!!o&&(o.getActivePopups().some(d=>d.contains(a))||o.isElementWithinCustomPopup(a))),l||bR(t)};for(let r of i)e.addManagedElementListeners(r,{focusout:s})}function $C(e){if(e)return typeof e=="string"?e:e.getColId()}var Bi=Symbol("unedited");function dP(e,t={}){let i=[],n=e.rowRenderer.getCellCtrls(t.rowNodes,t.columns);for(let o of n){let s=o.comp?.getCellEditor();s&&i.push({ctrl:o,editor:ud(s)})}return i}var cq=(e,t={})=>dP(e,t).map(i=>i.editor);function uq(e,t,i,n,o,s){t.length===0&&i?.rowNode&&i?.column&&ya(e,i,{key:n,event:o,cellStartedEdit:s});let{valueSvc:r,editSvc:a,editModelSvc:l}=e,{rowNode:d,column:c}=i??{};for(let u of t){let{rowNode:h,column:p}=u,g=et(e,u);if(!g){if(h&&p){let m=r.getValue(p,h,void 0,"api"),w=(i?.rowNode===h&&i?.column===p&&n||void 0)??a?.getCellDataValue(u,!1)??r.getValueForDisplay(p,h)?.value??m??Bi;l?.setEdit(u,{pendingValue:w,sourceValue:m,state:"editing"})}continue}let f=s&&d===g.rowNode&&g.column===c;ya(e,{rowNode:d,column:g.column},{key:f?n:null,event:f?o:null,cellStartedEdit:f&&s})}}function so({pendingValue:e,sourceValue:t}){return e===Bi&&(e=t),e!==t}function ya(e,t,i){let n=e.gos.get("enableGroupEdit"),{key:o,event:s,cellStartedEdit:r,silent:a}=i??{},l=et(e,t),d=l?.comp?.getCellEditor(),c=uP(e,t,o,r&&!a),u=e.editModelSvc?.getEdit(t),h=c.value;if(h===void 0&&(h=u?.sourceValue),e.editModelSvc?.setEdit(t,{editorValue:h,state:"editing"}),d){d.refresh?.(c);return}let p=t.column.getColDef(),g=z6(e.userCompFactory,p,c),f=g?.popupFromSelector!=null?g.popupFromSelector:!!p.cellEditorPopup,m=g?.popupPositionFromSelector!=null?g.popupPositionFromSelector:p.cellEditorPopupPosition;if(hP(g.params,s),l){l.editCompDetails=g,l.onEditorAttachedFuncs.push(()=>l.rangeFeature?.unsetComp()),l.comp?.setEditDetails(g,f,m,e.gos.get("reactiveCustomComponents")),l?.rowCtrl?.refreshRow({suppressFlash:!0});let C=e.editModelSvc?.getEdit(t,!0);!a&&!C?.editorState?.cellStartedEditing&&(e.editSvc?.dispatchCellEvent(t,s,"cellEditingStarted",n?{value:h}:{}),e.editModelSvc?.setEdit(t,{editorState:{cellStartedEditing:!0}}))}}function cP(e,t,i){let n={editorValueExists:!1};if(Bv(e)&&(t.getValidationErrors?.()?.length??0)>0||i?.isCancelling)return n;if(i?.isStopping){let s=t?.isCancelAfterEnd?.();if(s)return _(b({},n),{isCancelAfterEnd:s})}return{editorValue:t.getValue(),editorValueExists:!0}}function uP(e,t,i,n){let{valueSvc:o,gos:s,editSvc:r}=e,a=e.gos.get("enableGroupEdit"),l=et(e,t),d=t.rowNode?.rowIndex??void 0,c=r?.isBatchEditing(),u=e.colModel.getCol(t.column.getId()),{rowNode:h,column:p}=t,g=l.comp?.getCellEditor(),f=r?.getCellDataValue(t,!1),m=f===void 0?g?cP(e,g)?.editorValue:void 0:f,C=m===Bi?o.getValueForDisplay(u,h)?.value:m;return te(s,{value:a?m:C,eventKey:i??null,column:p,colDef:p.getColDef(),rowIndex:d,node:h,data:h.data,cellStartedEdit:n??!1,onKeyDown:l?.onKeyDown.bind(l),stopEditing:v=>{r.stopEditing(t,{source:c?"ui":"api",suppressNavigateAfterEdit:v}),Ep(e,t)},eGridCell:l?.eGui,parseValue:v=>o.parseValue(u,h,v,l?.value),formatValue:l?.formatValue.bind(l),validate:()=>{r?.validateEdit()}})}function jC(e,t){let{editModelSvc:i}=e;i?.getEditMap().forEach((n,o)=>{n.forEach((s,r)=>{!t&&(s.state==="editing"||s.pendingValue===Bi)||!so(s)&&(s.state!=="editing"||t)&&i?.removeEdits({rowNode:o,column:r})})})}function hq(e,t){let i=t.comp?.getCellEditor();if(!i?.refresh)return;let{eventKey:n,cellStartedEdit:o}=t.editCompDetails.params,{column:s}=t,r=uP(e,t,n,o),a=s.getColDef(),l=z6(e.userCompFactory,a,r);i.refresh(hP(l.params,n))}function hP(e,t){return t instanceof KeyboardEvent&&e.column.getColDef().cellEditor==="agNumberCellEditor"?e.suppressPreventDefault=["-","+",".","e"].includes(t?.key??"")||e.suppressPreventDefault:t?.preventDefault?.(),e}function Bs(e,t){for(let i of e.editModelSvc?.getEditPositions()??[]){let n=et(e,i);if(!n)continue;let o=n.comp?.getCellEditor();if(!o)continue;let{editorValue:s,editorValueExists:r,isCancelAfterEnd:a}=cP(e,o,t);a&&e.editModelSvc?.setEdit(i,{editorState:{isCancelAfterEnd:a}}),op(e,i,s,void 0,!r,t)}}function op(e,t,i,n,o,s){let{editModelSvc:r,valueSvc:a}=e;if(!r)return;let{rowNode:l,column:d}=t;if(!(l&&d))return;let c=r.getEdit(t,!0);c?.sourceValue||(c=r.setEdit(t,{sourceValue:a.getValue(d,l,void 0,"api"),pendingValue:c?c.editorValue:Bi})),r.setEdit(t,{editorValue:o?c.sourceValue:i}),s?.persist&&pq(e,t)}function pq(e,t){let{editModelSvc:i}=e,n=i?.getEdit(t,!0);i?.setEdit(t,{pendingValue:n?.editorValue})}function ga(e,t,i){t||(t=e.editModelSvc?.getEditPositions());for(let n of t??[])Ep(e,n,i)}function Ep(e,t,i){let n=e.gos.get("enableGroupEdit"),{editModelSvc:o}=e,s=et(e,t),r=o?.getEdit(t,!0);if(!s){r&&o?.setEdit(t,{state:"changed"});return}let{comp:a}=s;if(a&&!a.getCellEditor()){if(s?.refreshCell(),r){o?.setEdit(t,{state:"changed"});let d=n?yR(i,r):{valueChanged:!1,newValue:void 0,oldValue:r.sourceValue};SR(e,t,d,i)}return}if(Bv(e)){let d=a?.getCellEditor()?.getValidationErrors?.(),c=o?.getCellValidationModel();d?.length?c?.setCellValidation(t,{errorMessages:d}):c?.clearCellValidation(t)}o?.setEdit(t,{state:"changed"}),a?.setEditDetails(),a?.refreshEditStyles(!1,!1),s?.refreshCell({force:!0,suppressFlash:!0});let l=o?.getEdit(t);if(l&&l.state==="changed"){let d=n?yR(i,l):{valueChanged:so(l)&&!i?.cancel,newValue:i?.cancel||l.editorState.isCancelAfterEnd?void 0:l?.editorValue??r?.pendingValue,oldValue:l?.sourceValue};SR(e,t,d,i)}}function yR(e,t){return e?.cancel?{valueChanged:!1,oldValue:t.sourceValue,newValue:void 0,value:t.sourceValue}:{valueChanged:!1,oldValue:t.sourceValue,newValue:t.pendingValue,value:t.sourceValue}}function SR(e,t,i,{silent:n,event:o}={}){let{editSvc:s,editModelSvc:r}=e,a=r?.getEdit(t),{editorState:l}=a||{},{isCancelBeforeStart:d}=l||{};!n&&!d&&(s?.dispatchCellEvent(t,o,"cellEditingStopped",i),r?.setEdit(t,{editorState:{cellStoppedEditing:!0}}))}function Bv(e){let{gos:t,colModel:i}=e,n=!!t.get("getFullRowEditValidationErrors"),o=i.getColumnDefs()?.filter(r=>r.editable).some(({cellEditorParams:r})=>{let{minLength:a,maxLength:l,getValidationErrors:d,min:c,max:u}=r||{};return a!==void 0||l!==void 0||d!==void 0||c!==void 0||u!==void 0}),s=e.gridApi.getCellEditorInstances().some(r=>r.getValidationElement||r.getValidationErrors);return o||n||s}function Ys(e,t){if(!(t||Bv(e)))return;let i=dP(e),n=new aP,{ariaAnnounce:o,localeSvc:s,editModelSvc:r,gos:a}=e,l=a.get("editType")==="fullRow",c=n6(s)("ariaValidationErrorPrefix","Cell Editor Validation");for(let h of i){let{ctrl:p,editor:g}=h,{rowNode:f,column:m}=p,C=g.getValidationErrors?.()??[],v=g.getValidationElement?.(!1)||!g.isPopup?.()&&p.eGui;if(v){let w=C!=null&&C.length>0,y=w?C.join(". "):"";c_(v,w),w&&o.announceValue(`${c} ${C}`,"editorValidation"),v instanceof HTMLInputElement?v.setCustomValidity(y):v.classList.toggle("invalid",w)}C?.length>0&&n.setCellValidation({rowNode:f,column:m},{errorMessages:C})}Bs(e,{persist:!1}),r?.setCellValidationModel(n);let u=new Set;for(let{ctrl:h}of i)u.add(h.rowCtrl);if(l){let h=gq(e);r?.setRowValidationModel(h)}for(let h of u.values()){h.rowEditStyleFeature?.applyRowStyles();for(let p of h.getAllCellCtrls())p.tooltipFeature?.refreshTooltip(!0),p.editorTooltipFeature?.refreshTooltip(!0),p.editStyleFeature?.applyCellStyles?.()}}var gq=e=>{let t=new lP,i=e.gos.get("getFullRowEditValidationErrors"),n=e.editModelSvc?.getEditMap();if(!n)return t;for(let o of n.keys()){let s=n.get(o);if(!s)continue;let r=[],{rowIndex:a,rowPinned:l}=o;for(let c of s.keys()){let u=s.get(c);if(!u)continue;let{editorValue:h,pendingValue:p,sourceValue:g}=u,f=h??(p===Bi?void 0:p)??g;r.push({column:c,colId:c.getColId(),rowIndex:a,rowPinned:l,oldValue:g,newValue:f})}let d=i?.({editorsState:r})??[];d.length>0&&t.setRowValidation({rowNode:o},{errorMessages:d})}return t};function fq(e){Ys(e,!0);let t=e.editModelSvc?.getCellValidationModel().getCellValidationMap();if(!t)return null;let i=[];return t.forEach((n,o)=>{n.forEach(({errorMessages:s},r)=>{i.push({column:r,rowIndex:o.rowIndex,rowPinned:o.rowPinned,messages:s??null})})}),i}function mq(e,t,i,{rowNode:n,column:o},s){return te(e.gos,{type:i,node:n,data:n.data,value:s,column:o,colDef:o.getColDef(),rowPinned:n.rowPinned,event:t,rowIndex:n.rowIndex})}function Cq(e,t=!1){return e===R.DELETE?!0:!t&&e===R.BACKSPACE?q6():!1}var vq=class extends D{constructor(e,t,i,n){super(),this.cellCtrl=e,this.rowNode=i,this.rowCtrl=n,this.beans=t}init(){this.eGui=this.cellCtrl.eGui}onKeyDown(e){let t=e.key;switch(t){case R.ENTER:this.onEnterKeyDown(e);break;case R.F2:this.onF2KeyDown(e);break;case R.ESCAPE:this.onEscapeKeyDown(e);break;case R.TAB:this.onTabKeyDown(e);break;case R.BACKSPACE:case R.DELETE:this.onBackspaceOrDeleteKeyDown(t,e);break;case R.DOWN:case R.UP:case R.RIGHT:case R.LEFT:this.onNavigationKeyDown(e,t);break}}onNavigationKeyDown(e,t){let{cellCtrl:i,beans:n}=this;if(!n.editSvc?.isEditing(i,{withOpenEditor:!0})){if(e.shiftKey&&i.isRangeSelectionEnabled())this.onShiftRangeSelect(e);else{let o=i.getFocusedCellPosition();n.navigation?.navigateToNextCell(e,t,o,!0)}e.preventDefault()}}onShiftRangeSelect(e){let{rangeSvc:t,navigation:i}=this.beans;if(!t)return;let n=t.extendLatestRangeInDirection(e);n&&(e.key===R.LEFT||e.key===R.RIGHT?i?.ensureColumnVisible(n.column):i?.ensureRowVisible(n.rowIndex))}onTabKeyDown(e){this.beans.navigation?.onTabKeyDown(this.cellCtrl,e)}onBackspaceOrDeleteKeyDown(e,t){let{cellCtrl:i,beans:n,rowNode:o}=this,{gos:s,rangeSvc:r,eventSvc:a,editSvc:l}=n;if(a.dispatchEvent({type:"keyShortcutChangedCellStart"}),Cq(e,s.get("enableCellEditingOnBackspace"))&&!l?.isEditing(i,{withOpenEditor:!0})){if(r&&uo(s))r.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"});else if(i.isCellEditable()){let{column:d}=i,c=this.beans.valueSvc.getDeleteValue(d,o);o.setDataValue(d,c,"cellClear")}}else l?.isEditing(i,{withOpenEditor:!0})||n.editSvc?.startEditing(i,{startedEdit:!0,event:t});a.dispatchEvent({type:"keyShortcutChangedCellEnd"})}onEnterKeyDown(e){let{cellCtrl:t,beans:i}=this,{editSvc:n,navigation:o}=i,s=n?.isEditing(t,{withOpenEditor:!0}),r=t.rowNode,a=n?.isRowEditing(r,{withOpenEditor:!0}),l=d=>{n?.startEditing(d,{startedEdit:!0,event:e,source:"edit"})&&e.preventDefault()};if(s||a){if(this.isCtrlEnter(e)){n?.applyBulkEdit(t,i?.rangeSvc?.getCellRanges()||[]);return}if(Ys(i),n?.checkNavWithValidation(void 0,e)==="block-stop")return;n?.isEditing(t,{withOpenEditor:!0})?n?.stopEditing(t,{event:e,source:"edit"}):a&&!t.isCellEditable()?n?.stopEditing({rowNode:r},{event:e,source:"edit"}):l(t)}else if(i.gos.get("enterNavigatesVertically")){let d=e.shiftKey?R.UP:R.DOWN;o?.navigateToNextCell(null,d,t.cellPosition,!1)}else{if(n?.hasValidationErrors())return;n?.hasValidationErrors(t)&&n.revertSingleCellEdit(t,!0),l(t)}}isCtrlEnter(e){return(e.ctrlKey||e.metaKey)&&e.key===R.ENTER}onF2KeyDown(e){let{cellCtrl:t,beans:{editSvc:i}}=this;i?.isEditing()&&(Ys(this.beans),i?.checkNavWithValidation(void 0,e)==="block-stop")||i?.startEditing(t,{startedEdit:!0,event:e})}onEscapeKeyDown(e){let{cellCtrl:t,beans:{editSvc:i}}=this;i?.checkNavWithValidation(t,e)==="block-stop"&&i.revertSingleCellEdit(t),i?.stopEditing(t,{event:e,cancel:!0})}processCharacter(e){let i=e.target!==this.eGui,{beans:{editSvc:n},cellCtrl:o}=this;if(i||n?.isEditing(o,{withOpenEditor:!0}))return;if(e.key===R.SPACE)this.onSpaceKeyDown(e);else if(n?.isCellEditable(o,"ui")){if(n?.hasValidationErrors()&&!n?.hasValidationErrors(o))return;n?.startEditing(o,{startedEdit:!0,event:e,source:"api"}),!o.editCompDetails?.params?.suppressPreventDefault&&e.preventDefault()}}onSpaceKeyDown(e){let{gos:t,editSvc:i}=this.beans,{rowNode:n}=this.cellCtrl;!i?.isEditing(this.cellCtrl,{withOpenEditor:!0})&&Gs(t)&&this.beans.selectionSvc?.handleSelectionEvent(e,n,"spaceKey"),e.preventDefault()}},wq=class extends D{constructor(e,t,i){super(),this.cellCtrl=e,this.column=i,this.beans=t}onMouseEvent(e,t){if(!co(t))switch(e){case"click":this.onCellClicked(t);break;case"mousedown":case"touchstart":this.onMouseDown(t);break;case"dblclick":this.onCellDoubleClicked(t);break;case"mouseout":this.onMouseOut(t);break;case"mouseover":this.onMouseOver(t);break}}onCellClicked(e){if(this.beans.touchSvc?.handleCellDoubleClick(this,e))return;let{eventSvc:t,rangeSvc:i,editSvc:n,editModelSvc:o,frameworkOverrides:s,gos:r}=this.beans,a=e.ctrlKey||e.metaKey,{cellCtrl:l}=this,{column:d,cellPosition:c,rowNode:u}=l,h=Zh(r,d,u,e);i&&a&&!h&&i.getCellRangeCount(c)>1&&i.intersectLastRange(!0);let p=l.createEvent(e,"cellClicked");p.isEventHandlingSuppressed=h,t.dispatchEvent(p);let g=d.getColDef();if(g.onCellClicked&&window.setTimeout(()=>{s.wrapOutgoing(()=>{g.onCellClicked(p)})},0),!h&&o?.getState(l)!=="editing"){let f=n?.isEditing(),m=o?.getCellValidationModel().getCellValidationMap().size??0,C=o?.getRowValidationModel().getRowValidationMap().size??0;if(f&&(m>0||C>0))return;n?.shouldStartEditing(l,e)?n?.startEditing(l,{event:e}):n?.shouldStopEditing(l,e)&&(this.beans.gos.get("editType")==="fullRow"?n?.stopEditing(l,{event:e,source:"edit"}):n?.stopEditing(void 0,{event:e,source:"edit"}))}}onCellDoubleClicked(e){let{column:t,beans:i,cellCtrl:n}=this,{eventSvc:o,frameworkOverrides:s,editSvc:r,editModelSvc:a,gos:l}=i,d=Zh(l,n.column,n.rowNode,e),c=t.getColDef(),u=n.createEvent(e,"cellDoubleClicked");if(u.isEventHandlingSuppressed=d,o.dispatchEvent(u),typeof c.onCellDoubleClicked=="function"&&window.setTimeout(()=>{s.wrapOutgoing(()=>{c.onCellDoubleClicked(u)})},0),!d&&r?.shouldStartEditing(n,e)&&a?.getState(n)!=="editing"){let h=r?.isEditing(),p=a?.getCellValidationModel().getCellValidationMap().size??0,g=a?.getRowValidationModel().getRowValidationMap().size??0;if(h&&(p>0||g>0))return;r?.startEditing(n,{event:e})}}onMouseDown(e){let{ctrlKey:t,metaKey:i,shiftKey:n}=e,o=e.target,{cellCtrl:s,beans:r}=this,{eventSvc:a,rangeSvc:l,rowNumbersSvc:d,focusSvc:c,gos:u,editSvc:h}=r,{column:p,rowNode:g,cellPosition:f}=s,m=Zh(u,p,g,e),C=()=>{let S=s.createEvent(e,"cellMouseDown");S.isEventHandlingSuppressed=m,a.dispatchEvent(S)};if(m){C();return}if(this.isRightClickInExistingRange(e))return;let v=l&&!l.isEmpty(),w=this.containsWidget(o),y=ao(p);if(d&&y&&!d.handleMouseDownOnCell(f,e)){l&&e.preventDefault(),e.stopImmediatePropagation();return}if(!n||!v){let S=h?.isEditing(s),E=u.get("enableCellTextSelection")&&e.defaultPrevented,T=(es()||E)&&!S&&!Kl(o)&&!w;s.focusCell(T,e)}if(n&&v&&!c.isCellFocused(f)){e.preventDefault();let S=c.getFocusedCell();if(S){let{column:x,rowIndex:E,rowPinned:T}=S;h?.isEditing(S)&&h?.stopEditing(S),c.setFocusedCell({column:x,rowIndex:E,rowPinned:T,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,sourceEvent:e})}}if(!w){if(l){y&&e.preventDefault();let S=PE(r,e)&&y;if(n)l.extendLatestRangeToCell(f);else if(!S){let x=t||i;l.setRangeToCell(f,x)}}C()}}isRightClickInExistingRange(e){let{rangeSvc:t}=this.beans;if(t){let i=t.isCellInAnyRange(this.cellCtrl.cellPosition),n=PE(this.beans,e);if(i&&n)return!0}return!1}containsWidget(e){return Hs(e,"ag-selection-checkbox",3)||Hs(e,"ag-drag-handle",3)}onMouseOut(e){if(this.mouseStayingInsideCell(e))return;let{eventSvc:t,colHover:i}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOut")),i?.clearMouseOver()}onMouseOver(e){if(this.mouseStayingInsideCell(e))return;let{eventSvc:t,colHover:i}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOver")),i?.setMouseOver([this.column])}mouseStayingInsideCell(e){if(!e.target||!e.relatedTarget)return!1;let t=this.cellCtrl.eGui,i=t.contains(e.target),n=t.contains(e.relatedTarget);return i&&n}},bq=class extends D{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.column=e.column,this.rowNode=e.rowNode}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode),this.addManagedListeners(this.beans.eventSvc,{newColumnsLoaded:()=>this.onNewColumnsLoaded()})}init(){this.eSetLeft=this.cellCtrl.getRootElement(),this.eContent=this.cellCtrl.eGui;let e=this.cellCtrl.getCellSpan();if(e||(this.setupColSpan(),this.setupRowSpan()),this.onLeftChanged(),this.onWidthChanged(),e||this._legacyApplyRowSpan(),e){let t=this.refreshSpanHeight.bind(this,e);t(),this.addManagedListeners(this.beans.eventSvc,{paginationChanged:t,recalculateRowBounds:t,pinnedHeightChanged:t})}}refreshSpanHeight(e){let t=e.getCellHeight();t!=null&&(this.eContent.style.height=`${t}px`)}onNewColumnsLoaded(){let e=this.column.getRowSpan(this.rowNode);this.rowSpan!==e&&(this.rowSpan=e,this._legacyApplyRowSpan(!0))}onDisplayColumnsChanged(){let e=this.getColSpanningList();Zo(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){this.column.getColDef().colSpan!=null&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onWidthChanged.bind(this)}))}onWidthChanged(){if(!this.eContent)return;let e=this.getCellWidth();this.eContent.style.width=`${e}px`}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce((e,t)=>e+t.getActualWidth(),0):this.column.getActualWidth()}getColSpanningList(){let{column:e,rowNode:t}=this,i=e.getColSpan(t),n=[];if(i===1)n.push(e);else{let o=e,s=e.getPinned();for(let r=0;o&&r<i&&(n.push(o),o=this.beans.visibleCols.getColAfter(o),!(!o||Qe(o)||s!==o.getPinned()));r++);}return n}onLeftChanged(){if(!this.eSetLeft)return;let e=this.modifyLeftForPrintLayout(this.getCellLeft());this.eSetLeft.style.left=e+"px"}getCellLeft(){let e;return this.beans.gos.get("enableRtl")&&this.colsSpanning?e=Ue(this.colsSpanning):e=this.column,e.getLeft()}modifyLeftForPrintLayout(e){if(!this.cellCtrl.printLayout||this.column.getPinned()==="left")return e;let{visibleCols:t}=this.beans,i=t.getColsLeftWidth();if(this.column.getPinned()==="right"){let n=t.bodyWidth;return i+n+(e||0)}return i+(e||0)}_legacyApplyRowSpan(e){if(this.rowSpan===1&&!e)return;let i=Vs(this.beans)*this.rowSpan;this.eContent.style.height=`${i}px`,this.eContent.style.zIndex="1"}destroy(){super.destroy()}},yq="ag-cell",Sq="ag-cell-auto-height",xq="ag-cell-normal-height",Eq="ag-cell-focus",Rq="ag-cell-first-right-pinned",Pq="ag-cell-last-left-pinned",Mq="ag-cell-not-inline-editing",kq="ag-cell-wrap-text",Dq=0,fa=class extends D{constructor(e,t,i,n){super(),this.column=e,this.rowNode=t,this.rowCtrl=n,this.rangeFeature=void 0,this.rowResizeFeature=void 0,this.positionFeature=void 0,this.customStyleFeature=void 0,this.editStyleFeature=void 0,this.mouseListener=void 0,this.keyboardListener=void 0,this.suppressRefreshCell=!1,this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.focusEventWhileNotReady=null,this.hasBeenFocused=!1,this.hasEdit=!1,this.tooltipFeature=void 0,this.editorTooltipFeature=void 0,this.beans=i,this.gos=i.gos,this.editSvc=i.editSvc,this.hasEdit=!!i.editSvc;let{colId:o}=e;this.instanceId=o+"-"+Dq++,this.createCellPosition(),this.updateAndFormatValue(!1)}addFeatures(){let{beans:e}=this;this.positionFeature=new bq(this,e),this.customStyleFeature=e.cellStyles?.createCellCustomStyleFeature(this,e),this.editStyleFeature=e.editSvc?.createCellStyleFeature(this,e),this.mouseListener=new wq(this,e,this.column),this.keyboardListener=new vq(this,e,this.rowNode,this.rowCtrl),this.enableTooltipFeature();let{rangeSvc:t}=e;t&&uo(e.gos)&&(this.rangeFeature=t.createCellRangeFeature(e,this)),ao(this.column)&&(this.rowResizeFeature=this.beans.rowNumbersSvc.createRowNumbersRowResizerFeature(e,this))}isCellSpanning(){return!1}getCellSpan(){}removeFeatures(){let e=this.beans.context;this.positionFeature=e.destroyBean(this.positionFeature),this.editorTooltipFeature=e.destroyBean(this.editorTooltipFeature),this.customStyleFeature=e.destroyBean(this.customStyleFeature),this.editStyleFeature=e.destroyBean(this.editStyleFeature),this.mouseListener=e.destroyBean(this.mouseListener),this.keyboardListener=e.destroyBean(this.keyboardListener),this.rangeFeature=e.destroyBean(this.rangeFeature),this.rowResizeFeature=e.destroyBean(this.rowResizeFeature),this.disableTooltipFeature()}enableTooltipFeature(e,t){this.tooltipFeature=this.beans.tooltipSvc?.enableCellTooltipFeature(this,e,t)}disableTooltipFeature(){this.tooltipFeature=this.beans.context.destroyBean(this.tooltipFeature)}enableEditorTooltipFeature(e){this.editorTooltipFeature&&this.disableEditorTooltipFeature(),this.editorTooltipFeature=this.beans.tooltipSvc?.setupCellEditorTooltip(this,e),Ys(this.beans)}disableEditorTooltipFeature(){this.editorTooltipFeature=this.beans.context.destroyBean(this.editorTooltipFeature)}setComp(e,t,i,n,o,s,r){if(this.comp=e,this.eGui=t,this.printLayout=o,r??(r=this),this.addDomData(r),this.addFeatures(),r.addDestroyFunc(()=>this.removeFeatures()),this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.setupFocus(),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),this.setupAutoHeight(n,r),this.refreshFirstAndLastStyles(),this.refreshAriaColIndex(),this.positionFeature?.init(),this.customStyleFeature?.setComp(e),this.editStyleFeature?.setComp(e),this.tooltipFeature?.refreshTooltip(),this.keyboardListener?.init(),this.rangeFeature?.setComp(e),this.rowResizeFeature?.refreshRowResizer(),s&&this.isCellEditable()||this.hasEdit&&this.editSvc?.isEditing(this,{withOpenEditor:!0})?this.editSvc?.startEditing(this,{startedEdit:!1,source:"api",silent:!0,continueEditing:!0}):this.showValue(!1,!0),this.onCompAttachedFuncs.length){for(let a of this.onCompAttachedFuncs)a();this.onCompAttachedFuncs=[]}}setupAutoHeight(e,t){this.isAutoHeight=this.beans.rowAutoHeight?.setupCellAutoHeight(this,e,t)??!1}getCellAriaRole(){return this.column.getColDef().cellAriaRole??"gridcell"}isCellRenderer(){let e=this.column.getColDef();return e.cellRenderer!=null||e.cellRendererSelector!=null}getValueToDisplay(){return this.valueFormatted??this.value}getDeferLoadingCellRenderer(){let{beans:e,column:t}=this,{userCompFactory:i,ctrlsSvc:n,eventSvc:o}=e,s=t.getColDef(),r=this.createCellRendererParams();r.deferRender=!0;let a=AE(i,s,r);if(n.getGridBodyCtrl()?.scrollFeature?.isScrolling()){let l,d=new nt(u=>{l=u}),[c]=this.addManagedListeners(o,{bodyScrollEnd:()=>{l(),c()}});return{loadingComp:a,onReady:d}}return{loadingComp:a,onReady:nt.resolve()}}showValue(e,t){let{beans:i,column:n,rowNode:o,rangeFeature:s}=this,{userCompFactory:r}=i,a=this.getValueToDisplay(),l,d=o.stub&&o.groupData?.[n.getId()]==null,c=n.getColDef();if(d||this.isCellRenderer()){let u=this.createCellRendererParams();!d||ao(n)?l=TE(r,c,u):l=AE(r,c,u)}if(!l&&!d&&i.findSvc?.isMatch(o,n)){let u=this.createCellRendererParams();l=TE(r,_(b({},n.getColDef()),{cellRenderer:"agFindCellRenderer"}),u)}if(this.hasEdit&&this.editSvc.isBatchEditing()&&this.editSvc.isRowEditing(o,{checkSiblings:!0})){let u=this.editSvc.prepDetailsDuringBatch(this,{compDetails:l,valueToDisplay:a});u&&(u.compDetails?l=u.compDetails:u.valueToDisplay&&(a=u.valueToDisplay))}this.comp.setRenderDetails(l,a,e),this.customRowDragComp?.refreshVisibility(),!t&&s&&po(i,()=>s?.refreshHandle()),this.rowResizeFeature?.refreshRowResizer()}setupControlComps(){let e=this.column.getColDef();this.includeSelection=this.isIncludeControl(this.isCheckboxSelection(e),!0),this.includeRowDrag=this.isIncludeControl(e.rowDrag),this.includeDndSource=this.isIncludeControl(e.dndSource),this.comp.setIncludeSelection(this.includeSelection),this.comp.setIncludeDndSource(this.includeDndSource),this.comp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gos.get("enableCellTextSelection")||this.column.isAutoHeight()}getCellValueClass(){let e="ag-cell-value",t=this.column.getColDef().cellRenderer==="agCheckboxCellRenderer",i="";return t&&(i=" ag-allow-overflow"),`${e}${i}`}isIncludeControl(e,t=!1){return(this.rowNode.rowPinned==null||t&&Sd(this.rowNode))&&!!e}isCheckboxSelection(e){let{rowSelection:t,groupDisplayType:i}=this.beans.gridOptions,n=hp(t),o=go(this.column);return i==="custom"&&n!=="selectionColumn"&&o?!1:e.checkboxSelection||o&&typeof t=="object"&&da(t)}refreshShouldDestroy(){let e=this.column.getColDef(),t=this.includeSelection!=this.isIncludeControl(this.isCheckboxSelection(e),!0),i=this.includeRowDrag!=this.isIncludeControl(e.rowDrag),n=this.includeDndSource!=this.isIncludeControl(e.dndSource),o=this.isAutoHeight!=this.column.isAutoHeight();return t||i||n||o}onPopupEditorClosed(){let{editSvc:e}=this.beans;e?.isEditing(this,{withOpenEditor:!0})&&e?.stopEditing(this,{source:e?.isBatchEditing()?"ui":"api"})}stopEditing(e=!1){let{editSvc:t}=this.beans;return t?.stopEditing(this,{cancel:e,source:t?.isBatchEditing()?"ui":"api"})??!1}createCellRendererParams(){let{value:e,valueFormatted:t,column:i,rowNode:n,comp:o,eGui:s,beans:{valueSvc:r,gos:a,editSvc:l}}=this;return te(a,{value:e,valueFormatted:t,getValue:()=>r.getValueForDisplay(i,n).value,setValue:c=>l?.setDataValue({rowNode:n,column:i},c)||n.setDataValue(i,c),formatValue:this.formatValue.bind(this),data:n.data,node:n,pinned:i.getPinned(),colDef:i.getColDef(),column:i,refreshCell:this.refreshCell.bind(this),eGridCell:s,eParentOfValue:o.getParentOfValue(),registerRowDragger:(c,u,h,p)=>this.registerRowDragger(c,u,p),setTooltip:(c,u)=>{a.assertModuleRegistered("Tooltip",3),this.tooltipFeature&&this.disableTooltipFeature(),this.enableTooltipFeature(c,u),this.tooltipFeature?.refreshTooltip()}})}onCellChanged(e){e.column===this.column&&this.refreshCell({})}refreshOrDestroyCell(e){if(this.refreshShouldDestroy()?this.rowCtrl?.recreateCell(this):this.refreshCell(e),this.hasEdit&&this.editCompDetails){let{editSvc:t,comp:i}=this;!i?.getCellEditor()&&t.isEditing(this,{withOpenEditor:!0})&&t.startEditing(this,{startedEdit:!1,source:"api",silent:!0})}}refreshCell({force:e,suppressFlash:t,newData:i}={}){let{editStyleFeature:n,customStyleFeature:o,rowCtrl:{rowEditStyleFeature:s},beans:{cellFlashSvc:r,filterManager:a},column:l,comp:d,suppressRefreshCell:c,tooltipFeature:u}=this;if(c)return;let{field:h,valueGetter:p,showRowGroup:g,enableCellChangeFlash:f}=l.getColDef(),m=h==null&&p==null&&g==null,C=e||m||i,v=!!d,w=this.updateAndFormatValue(v),y=C||w;if(v){if(y){this.showValue(!!i,!1);let S=a?.isSuppressFlashingCellsBecauseFiltering();!t&&!S&&f&&r?.flashCell(this),n?.applyCellStyles?.(),o?.applyUserStyles(),o?.applyClassesFromColDef(),s?.applyRowStyles()}u?.refreshTooltip(),o?.applyCellClassRules()}}isCellEditable(){return this.column.isCellEditable(this.rowNode)}formatValue(e){return this.callValueFormatter(e)??e}callValueFormatter(e){return this.beans.valueSvc.formatValue(this.column,this.rowNode,e)}updateAndFormatValue(e){let t=this.value,i=this.valueFormatted,{value:n,valueFormatted:o}=this.beans.valueSvc.getValueForDisplay(this.column,this.rowNode,!0);return this.value=n,this.valueFormatted=o,e?!this.valuesAreEqual(t,this.value)||this.valueFormatted!=i:!0}valuesAreEqual(e,t){let i=this.column.getColDef();return i.equals?i.equals(e,t):e===t}addDomData(e){let t=this.eGui;$s(this.beans.gos,t,yp,this),e.addDestroyFunc(()=>$s(this.beans.gos,t,yp,null))}createEvent(e,t){let{rowNode:i,column:n,value:o,beans:s}=this;return mq(s,e,t,{rowNode:i,column:n},o)}processCharacter(e){this.keyboardListener?.processCharacter(e)}onKeyDown(e){this.keyboardListener?.onKeyDown(e)}onMouseEvent(e,t){this.mouseListener?.onMouseEvent(e,t)}getColSpanningList(){return this.positionFeature?.getColSpanningList()??[]}onLeftChanged(){this.comp&&this.positionFeature?.onLeftChanged()}onDisplayedColumnsChanged(){this.eGui&&(this.refreshAriaColIndex(),this.refreshFirstAndLastStyles())}refreshFirstAndLastStyles(){let{comp:e,column:t,beans:i}=this;P4(e,t,i.visibleCols)}refreshAriaColIndex(){let e=this.beans.visibleCols.getAriaColIndex(this.column);qR(this.eGui,e)}onWidthChanged(){return this.positionFeature?.onWidthChanged()}getRowPosition(){let{rowIndex:e,rowPinned:t}=this.cellPosition;return{rowIndex:e,rowPinned:t}}updateRangeBordersIfRangeCount(){this.comp&&this.rangeFeature?.updateRangeBordersIfRangeCount()}onCellSelectionChanged(){this.comp&&this.rangeFeature?.onCellSelectionChanged()}isRangeSelectionEnabled(){return this.rangeFeature!=null}focusCell(e=!1,t){let i=this.editSvc?.allowedFocusTargetOnValidation(this);i&&i!==this||this.beans.focusSvc.setFocusedCell(_(b({},this.getFocusedCellPosition()),{forceBrowserFocus:e,sourceEvent:t}))}restoreFocus(e=!1){let{beans:{editSvc:t,focusSvc:i},comp:n}=this;if(!n||t?.isEditing(this)||!this.isCellFocused()||!i.shouldTakeFocus())return;let o=()=>{if(!this.isAlive())return;let s=n.getFocusableElement();this.isCellFocused()&&s.focus({preventScroll:!0})};if(e){setTimeout(o,0);return}o()}onRowIndexChanged(){this.createCellPosition(),this.onCellFocused(),this.restoreFocus(),this.rangeFeature?.onCellSelectionChanged(),this.rowResizeFeature?.refreshRowResizer()}onSuppressCellFocusChanged(e){let t=this.eGui;t&&(ao(this.column)&&(e=!0),bi(t,"tabindex",e?void 0:-1))}onFirstRightPinnedChanged(){if(!this.comp)return;let e=this.column.isFirstRightPinned();this.comp.toggleCss(Rq,e)}onLastLeftPinnedChanged(){if(!this.comp)return;let e=this.column.isLastLeftPinned();this.comp.toggleCss(Pq,e)}checkCellFocused(){return this.beans.focusSvc.isCellFocused(this.cellPosition)}isCellFocused(){let e=this.checkCellFocused();return this.hasBeenFocused||(this.hasBeenFocused=e),e}setupFocus(){this.restoreFocus(!0),this.onCellFocused(this.focusEventWhileNotReady??void 0)}onCellFocused(e){let{beans:t}=this;if(Ip(t))return;if(!this.comp){e&&(this.focusEventWhileNotReady=e);return}let i=this.isCellFocused(),n=t.editSvc?.isEditing(this)??!1;if(this.comp.toggleCss(Eq,i),i&&e?.forceBrowserFocus){let o=this.comp.getFocusableElement();if(n){let s=ua(o,null,!0);s.length&&(o=s[0])}o.focus({preventScroll:!!e.preventScrollOnBrowserFocus})}i&&e&&this.rowCtrl.announceDescription()}createCellPosition(){let{rowIndex:e,rowPinned:t}=this.rowNode;this.cellPosition={rowIndex:e,rowPinned:ro(t),column:this.column}}applyStaticCssClasses(){let{comp:e}=this;e.toggleCss(yq,!0),e.toggleCss(Mq,!0);let t=this.column.isAutoHeight()==!0;e.toggleCss(Sq,t),e.toggleCss(xq,!t)}onColumnHover(){this.beans.colHover?.onCellColumnHover(this.column,this.comp)}onColDefChanged(){this.comp&&(this.column.isTooltipEnabled()?(this.disableTooltipFeature(),this.enableTooltipFeature()):this.disableTooltipFeature(),this.setWrapText(),this.editSvc?.isEditing(this)?this.editSvc?.handleColDefChanged(this):this.refreshOrDestroyCell({force:!0,suppressFlash:!0}))}setWrapText(){let e=this.column.getColDef().wrapText==!0;this.comp.toggleCss(kq,e)}dispatchCellContextMenuEvent(e){let t=this.column.getColDef(),i=this.createEvent(e,"cellContextMenu"),{beans:n}=this;n.eventSvc.dispatchEvent(i),t.onCellContextMenu&&window.setTimeout(()=>{n.frameworkOverrides.wrapOutgoing(()=>{t.onCellContextMenu(i)})},0)}getCellRenderer(){return this.comp?.getCellRenderer()??null}destroy(){this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.isCellFocused()&&this.hasBrowserFocus()&&this.beans.focusSvc.attemptToRecoverFocus(),super.destroy()}hasBrowserFocus(){return this.eGui?.contains(tt(this.beans))??!1}createSelectionCheckbox(){let e=this.beans.selectionSvc?.createCheckboxSelectionComponent();if(e)return this.beans.context.createBean(e),e.init({rowNode:this.rowNode,column:this.column}),e}createDndSource(){let e=this.beans.registry.createDynamicBean("dndSourceComp",!1,this.rowNode,this.column,this.eGui);return e&&this.beans.context.createBean(e),e}registerRowDragger(e,t,i){if(this.customRowDragComp){this.customRowDragComp.setDragElement(e,t);return}let n=this.createRowDragComp(e,t,i);n&&(this.customRowDragComp=n,this.addDestroyFunc(()=>{this.beans.context.destroyBean(n),this.customRowDragComp=null}),n.refreshVisibility())}createRowDragComp(e,t,i){let n=this.beans.rowDragSvc?.createRowDragCompForCell(this.rowNode,this.column,()=>this.value,e,t,i);if(n)return this.beans.context.createBean(n),n}cellEditorAttached(){for(let e of this.onEditorAttachedFuncs)e();this.onEditorAttachedFuncs=[]}setFocusedCellPosition(e){}getFocusedCellPosition(){return this.cellPosition}refreshAriaRowIndex(){}getRootElement(){return this.eGui}};function Hv(e,t,i,n,o,s){if(i==null&&t==null)return;let r={},a={},l=(d,c)=>{for(let u of d.split(" "))u.trim()!=""&&c(u)};if(i){let d=Object.keys(i);for(let c=0;c<d.length;c++){let u=d[c],h=i[u],p;typeof h=="string"?p=e?e.evaluate(h,n):!0:typeof h=="function"&&(p=h(n)),l(u,g=>{p?r[g]=!0:a[g]=!0})}}if(t&&s)for(let d of Object.keys(t))l(d,c=>{r[c]||(a[c]=!0)});s&&Object.keys(a).forEach(s),Object.keys(r).forEach(o)}function xR(e){if(e.group)return e.level;let t=e.parent;return t?t.level+1:0}var Fq=class extends D{constructor(){super(...arguments),this.beanName="rowStyleSvc"}processClassesFromGridOptions(e,t){let i=this.gos,n=r=>{if(typeof r=="string")e.push(r);else if(Array.isArray(r))for(let a of r)e.push(a)},o=i.get("rowClass");o&&n(o);let s=i.getCallback("getRowClass");if(s){let r={data:t.data,node:t,rowIndex:t.rowIndex},a=s(r);n(a)}}preProcessRowClassRules(e,t){this.processRowClassRules(t,i=>{e.push(i)},()=>{})}processRowClassRules(e,t,i){let{gos:n,expressionSvc:o}=this.beans,s=te(n,{data:e.data,node:e,rowIndex:e.rowIndex});Hv(o,void 0,n.get("rowClassRules"),s,t,i)}processStylesFromGridOptions(e){let t=this.gos,i=t.get("rowStyle"),n=t.getCallback("getRowStyle"),o;if(n){let s={data:e.data,node:e,rowIndex:e.rowIndex};o=n(s)}if(o||i)return Object.assign({},i,o)}},Tq=0,Rp=class extends D{constructor(e,t,i,n,o){super(),this.rowNode=e,this.useAnimationFrameForCreate=n,this.printLayout=o,this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.rowDragComps=[],this.lastMouseDownOnDragger=!1,this.emptyStyle={},this.updateColumnListsPending=!1,this.rowId=null,this.businessKey=null,this.beans=t,this.gos=t.gos,this.paginationPage=t.pagination?.getCurrentPage()??0,this.suppressRowTransform=this.gos.get("suppressRowTransform"),this.instanceId=e.id+"-"+Tq++,this.rowId=jl(e.id),this.initRowBusinessKey(),this.rowFocused=t.focusSvc.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=xR(this.rowNode),this.setRowType(),this.setAnimateFlags(i),this.rowStyles=this.processStylesFromGridOptions(),this.rowEditStyleFeature=t.editSvc?.createRowStyleFeature(this,t),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gos.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if(typeof this.businessKeyForNodeFunc!="function")return;let e=this.businessKeyForNodeFunc(this.rowNode);this.businessKey=jl(e)}updateGui(e,t){e==="left"?this.leftGui=t:e==="right"?this.rightGui=t:e==="fullWidth"?this.fullWidthGui=t:this.centerGui=t}setComp(e,t,i,n){let{context:o,focusSvc:s}=this.beans;n=vd(this,o,n);let r={rowComp:e,element:t,containerType:i,compBean:n};this.allRowGuis.push(r),this.updateGui(i,r),this.initialiseRowComp(r);let a=this.rowNode,l=this.rowType==="FullWidthLoading"||a.stub,d=!a.data&&this.beans.rowModel.getType()==="infinite";!l&&!d&&!a.rowPinned&&this.beans.rowRenderer.dispatchFirstDataRenderedEvent();let c=this.fullWidthGui?.element;c&&!this.beans.editSvc?.isEditing(this)&&s.isRowFocused(a.rowIndex,a.rowPinned)&&s.shouldTakeFocus()&&setTimeout(()=>c.focus({preventScroll:!0}),0)}unsetComp(e){this.allRowGuis=this.allRowGuis.filter(t=>t.containerType!==e),this.updateGui(e,void 0)}isCacheable(){return this.rowType==="FullWidthDetail"&&this.gos.get("keepDetailRows")}setCached(e){let t=e?"none":"";for(let i of this.allRowGuis)i.element.style.display=t}initialiseRowComp(e){let t=this.gos;this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.listenOnDomOrder(e),this.onRowHeightChanged(e),this.updateRowIndexes(e),this.setFocusedClasses(e),this.setStylesFromGridOptions(!1,e),Gs(t)&&this.rowNode.selectable&&this.onRowSelected(e),this.updateColumnLists(!this.useAnimationFrameForCreate);let i=e.rowComp,n=this.getInitialRowClasses(e.containerType);for(let o of n)i.toggleCss(o,!0);this.executeSlideAndFadeAnimations(e),this.rowNode.group&&bC(e.element,this.rowNode.expanded==!0),this.setRowCompRowId(i),this.setRowCompRowBusinessKey(i),$s(t,e.element,Sp,this),e.compBean.addDestroyFunc(()=>$s(t,e.element,Sp,null)),this.useAnimationFrameForCreate?this.beans.animationFrameSvc.createTask(this.addHoverFunctionality.bind(this,e),this.rowNode.rowIndex,"p2",!1):this.addHoverFunctionality(e),this.isFullWidth()&&this.setupFullWidth(e),t.get("rowDragEntireRow")&&this.addRowDraggerToRow(e),this.useAnimationFrameForCreate&&this.beans.animationFrameSvc.addDestroyTask(()=>{this.isAlive()&&e.rowComp.toggleCss("ag-after-created",!0)}),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(e){this.businessKey!=null&&e.setRowBusinessKey(this.businessKey)}setRowCompRowId(e){let t=jl(this.rowNode.id);this.rowId=t,t!=null&&e.setRowId(t)}executeSlideAndFadeAnimations(e){let{containerType:t}=e;this.slideInAnimation[t]&&(yC(()=>{this.onTopChanged()}),this.slideInAnimation[t]=!1),this.fadeInAnimation[t]&&(yC(()=>{e.rowComp.toggleCss("ag-opacity-zero",!1)}),this.fadeInAnimation[t]=!1)}addRowDraggerToRow(e){let t=this.beans.rowDragSvc?.createRowDragCompForRow(this.rowNode,e.element);if(!t)return;let i=this.createBean(t,this.beans.context);this.rowDragComps.push(i),e.compBean.addDestroyFunc(()=>{this.rowDragComps=this.rowDragComps.filter(n=>n!==i),this.rowEditStyleFeature=this.destroyBean(this.rowEditStyleFeature,this.beans.context),this.destroyBean(i,this.beans.context)})}setupFullWidth(e){let t=this.getPinnedForContainer(e.containerType),i=this.createFullWidthCompDetails(e.element,t);e.rowComp.showFullWidth(i)}getFullWidthCellRenderers(){return this.gos.get("embedFullWidthRows")?this.allRowGuis.map(e=>e?.rowComp?.getFullWidthCellRenderer()):[this.fullWidthGui?.rowComp?.getFullWidthCellRenderer()]}executeProcessRowPostCreateFunc(){let e=this.gos.getCallback("processRowPostCreate");if(!e||!this.areAllContainersReady())return;let t={eRow:this.centerGui.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)};e(t)}areAllContainersReady(){let{leftGui:e,centerGui:t,rightGui:i,beans:{visibleCols:n}}=this,o=!!e||!n.isPinningLeft(),s=!!t,r=!!i||!n.isPinningRight();return o&&s&&r}isNodeFullWidthCell(){if(this.rowNode.detail)return!0;let e=this.beans.gos.getCallback("isFullWidthRow");return e?e({rowNode:this.rowNode}):!1}setRowType(){let e=this.rowNode.stub&&!this.gos.get("suppressServerSideFullWidthLoadingRow")&&!this.gos.get("groupHideOpenParents"),t=this.isNodeFullWidthCell(),i=this.gos.get("masterDetail")&&this.rowNode.detail,n=this.beans.colModel.isPivotMode(),o=y6(this.gos,this.rowNode,n);e?this.rowType="FullWidthLoading":i?this.rowType="FullWidthDetail":t?this.rowType="FullWidth":o?this.rowType="FullWidthGroup":this.rowType="Normal"}updateColumnLists(e=!1,t=!1){if(this.isFullWidth())return;let{animationFrameSvc:i}=this.beans;if(!i?.active||e||this.printLayout){this.updateColumnListsImpl(t);return}this.updateColumnListsPending||(i.createTask(()=>{this.active&&this.updateColumnListsImpl(!0)},this.rowNode.rowIndex,"p1",!1),this.updateColumnListsPending=!0)}getNewCellCtrl(e){if(!this.beans.rowSpanSvc?.isCellSpanning(e,this.rowNode))return new fa(e,this.rowNode,this.beans,this)}isCorrectCtrlForSpan(e){return!this.beans.rowSpanSvc?.isCellSpanning(e.column,this.rowNode)}createCellCtrls(e,t,i=null){let n={list:[],map:{}},o=(d,c,u)=>{u!=null?n.list.splice(u,0,c):n.list.push(c),n.map[d]=c},s=[];for(let d of t){let c=d.getInstanceId(),u=e.map[c];u&&!this.isCorrectCtrlForSpan(u)&&(u.destroy(),u=void 0),u||(u=this.getNewCellCtrl(d)),u&&o(c,u)}for(let d of e.list){let c=d.column.getInstanceId();if(n.map[c]!=null)continue;!this.isCellEligibleToBeRemoved(d,i)?s.push([c,d]):d.destroy()}if(s.length)for(let[d,c]of s){let u=n.list.findIndex(p=>p.column.getLeft()>c.column.getLeft()),h=u===-1?void 0:Math.max(u-1,0);o(d,c,h)}let{focusSvc:r,visibleCols:a}=this.beans,l=r.getFocusedCell();if(l&&l.column.getPinned()==i){let d=l.column.getInstanceId();if(!n.map[d]&&a.allCols.includes(l.column)){let u=this.createFocusedCellCtrl();if(u){let h=n.list.findIndex(g=>g.column.getLeft()>u.column.getLeft()),p=h===-1?void 0:Math.max(h-1,0);o(d,u,p)}}}return n}createFocusedCellCtrl(){let{focusSvc:e,rowSpanSvc:t}=this.beans,i=e.getFocusedCell();if(!i)return;let n=t?.getCellSpan(i.column,this.rowNode);if(n){if(n.firstNode!==this.rowNode||!n.doesSpanContain(i))return}else if(!e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned))return;return this.getNewCellCtrl(i.column)}updateColumnListsImpl(e){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(e)}setCellCtrls(e){for(let t of this.allRowGuis){let i=this.getCellCtrlsForContainer(t.containerType);t.rowComp.setCellCtrls(i,e)}}getCellCtrlsForContainer(e){switch(e){case"left":return this.leftCellCtrls.list;case"right":return this.rightCellCtrls.list;case"fullWidth":return[];case"center":return this.centerCellCtrls.list}}createAllCellCtrls(){let e=this.beans.colViewport,t=this.beans.visibleCols;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,t.allCols),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{let i=e.getColsWithinViewport(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,i);let n=t.getLeftColsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,n,"left");let o=t.getRightColsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,o,"right")}}isCellEligibleToBeRemoved(e,t){let{column:o}=e;if(o.getPinned()!=t||!this.isCorrectCtrlForSpan(e))return!0;let{visibleCols:s,editSvc:r}=this.beans,a=r?.isEditing(e),l=e.isCellFocused();return a||l?!(s.allCols.indexOf(o)>=0):!0}getDomOrder(){return this.gos.get("ensureDomOrder")||Nt(this.gos,"print")}listenOnDomOrder(e){let t=()=>{e.rowComp.setDomOrder(this.getDomOrder())};e.compBean.addManagedPropertyListeners(["domLayout","ensureDomOrder"],t)}setAnimateFlags(e){if(this.rowNode.sticky||!e)return;let t=q(this.rowNode.oldRowTop),{visibleCols:i}=this.beans,n=i.isPinningLeft(),o=i.isPinningRight();if(t){let{slideInAnimation:s}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){s.fullWidth=!0;return}s.center=!0,s.left=n,s.right=o}else{let{fadeInAnimation:s}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){s.fullWidth=!0;return}s.center=!0,s.left=n,s.right=o}}isFullWidth(){return this.rowType!=="Normal"}refreshFullWidth(){let e=(r,a)=>r?r.rowComp.refreshFullWidth(()=>this.createFullWidthCompDetails(r.element,a).params):!0,t=e(this.fullWidthGui,null),i=e(this.centerGui,null),n=e(this.leftGui,"left"),o=e(this.rightGui,"right");return t&&i&&n&&o}addListeners(){let{beans:e,gos:t,rowNode:i}=this,{expansionSvc:n,eventSvc:o,context:s,rowSpanSvc:r}=e;this.addManagedListeners(this.rowNode,b({heightChanged:()=>this.onRowHeightChanged(),rowSelected:()=>this.onRowSelected(),rowIndexChanged:this.onRowIndexChanged.bind(this),topChanged:this.onTopChanged.bind(this)},n?.getRowExpandedListeners(this)??{})),i.detail&&this.addManagedListeners(i.parent,{dataChanged:this.onRowNodeDataChanged.bind(this)}),this.addManagedListeners(i,{dataChanged:this.onRowNodeDataChanged.bind(this),cellChanged:this.postProcessCss.bind(this),rowHighlightChanged:this.onRowNodeHighlightChanged.bind(this),draggingChanged:this.postProcessRowDragging.bind(this),uiLevelChanged:this.onUiLevelChanged.bind(this),rowPinned:this.onRowPinned.bind(this)}),this.addManagedListeners(o,{paginationPixelOffsetChanged:this.onPaginationPixelOffsetChanged.bind(this),heightScaleChanged:this.onTopChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),virtualColumnsChanged:this.onVirtualColumnsChanged.bind(this),cellFocused:this.onCellFocusChanged.bind(this),cellFocusCleared:this.onCellFocusChanged.bind(this),paginationChanged:this.onPaginationChanged.bind(this),modelUpdated:this.refreshFirstAndLastRowStyles.bind(this),columnMoved:()=>this.updateColumnLists()}),r&&this.addManagedListeners(r,{spannedCellsUpdated:({pinned:a})=>{a&&!i.rowPinned||this.updateColumnLists()}}),this.addDestroyFunc(()=>{this.rowDragComps=this.destroyBeans(this.rowDragComps,s),this.tooltipFeature=this.destroyBean(this.tooltipFeature,s),this.rowEditStyleFeature=this.destroyBean(this.rowEditStyleFeature,s)}),this.addManagedPropertyListeners(["rowStyle","getRowStyle","rowClass","getRowClass","rowClassRules"],this.postProcessCss.bind(this)),this.addManagedPropertyListener("rowDragEntireRow",()=>{if(t.get("rowDragEntireRow")){for(let l of this.allRowGuis)this.addRowDraggerToRow(l);return}this.rowDragComps=this.destroyBeans(this.rowDragComps,s)}),this.addListenersForCellComps()}addListenersForCellComps(){this.addManagedListeners(this.rowNode,{rowIndexChanged:()=>{for(let e of this.getAllCellCtrls())e.onRowIndexChanged()},cellChanged:e=>{for(let t of this.getAllCellCtrls())t.onCellChanged(e)}})}onRowPinned(){for(let e of this.allRowGuis)e.rowComp.toggleCss("ag-row-pinned-source",!!this.rowNode.pinnedSibling)}onRowNodeDataChanged(e){this.refreshRow({suppressFlash:!e.update,newData:!e.update})}refreshRow(e){if(this.isFullWidth()!==!!this.isNodeFullWidthCell()){this.beans.rowRenderer.redrawRow(this.rowNode);return}if(this.isFullWidth()){this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode);return}for(let i of this.getAllCellCtrls())i.refreshCell(e);for(let i of this.allRowGuis)this.setRowCompRowId(i.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(i.rowComp);this.onRowSelected(),this.postProcessCss()}postProcessCss(){this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.rowEditStyleFeature?.applyRowStyles(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){let e=this.beans.rowDropHighlightSvc,t=e?.row===this.rowNode?e.position:"none",i=t==="above",n=t==="inside",o=t==="below",r=this.gos.get("treeData")&&(o||i),a=this.rowNode.uiLevel.toString();for(let l of this.allRowGuis){let d=l.rowComp;d.toggleCss("ag-row-highlight-above",i),d.toggleCss("ag-row-highlight-inside",n),d.toggleCss("ag-row-highlight-below",o),d.toggleCss("ag-row-highlight-indent",r),r?l.element.style.setProperty("--ag-row-highlight-level",a):l.element.style.removeProperty("--ag-row-highlight-level")}}postProcessRowDragging(){let e=this.rowNode.dragging;for(let t of this.allRowGuis)t.rowComp.toggleCss("ag-row-dragging",e)}onDisplayedColumnsChanged(){this.updateColumnLists(!0),this.beans.rowAutoHeight?.requestCheckAutoHeight()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:ro(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}onKeyboardNavigate(e){let t=this.findFullWidthInfoForEvent(e);if(!t)return;let{rowGui:i,column:n}=t;if(!(i.element===e.target))return;let r=this.rowNode,{focusSvc:a,navigation:l}=this.beans,d=a.getFocusedCell(),c={rowIndex:r.rowIndex,rowPinned:r.rowPinned,column:d?.column??n};l?.navigateToNextCell(e,e.key,c,!0),e.preventDefault()}onTabKeyDown(e){if(e.defaultPrevented||co(e))return;let t=this.allRowGuis.find(a=>a.element.contains(e.target)),i=t?t.element:null,n=i===e.target,o=tt(this.beans),s=!1;i&&o&&(s=i.contains(o)&&o.classList.contains("ag-cell"));let r=null;!n&&!s&&(r=Qs(this.beans,i,!1,e.shiftKey)),(this.isFullWidth()&&n||!r)&&this.beans.navigation?.onTabKeyDown(this,e)}getFullWidthElement(){return this.fullWidthGui?this.fullWidthGui.element:null}getRowYPosition(){let e=this.allRowGuis.find(t=>Pn(t.element))?.element;return e?e.getBoundingClientRect().top:0}onSuppressCellFocusChanged(e){let t=this.isFullWidth()&&e?void 0:this.gos.get("tabIndex");for(let i of this.allRowGuis)bi(i.element,"tabindex",t)}onFullWidthRowFocused(e){let t=this.rowNode,i=e?this.isFullWidth()&&e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned:!1,n;if(this.fullWidthGui)n=this.fullWidthGui.element;else{let s=this.beans.colModel.getCol(e?.column)?.pinned;s?n=s==="right"?this.rightGui?.element:this.leftGui?.element:n=this.centerGui?.element}n&&(n.classList.toggle("ag-full-width-focus",i),i&&e?.forceBrowserFocus&&n.focus({preventScroll:!0}))}recreateCell(e){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,e),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,e),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,e),e.destroy(),this.updateColumnLists()}removeCellCtrl(e,t){let i={list:[],map:{}};for(let n of e.list)n!==t&&(i.list.push(n),i.map[n.column.getInstanceId()]=n);return i}onMouseEvent(e,t){switch(e){case"dblclick":this.onRowDblClick(t);break;case"click":this.onRowClick(t);break;case"touchstart":case"mousedown":this.onRowMouseDown(t);break}}createRowEvent(e,t){let{rowNode:i}=this;return te(this.gos,{type:e,node:i,data:i.data,rowIndex:i.rowIndex,rowPinned:i.rowPinned,event:t})}createRowEventWithSource(e,t){let i=this.createRowEvent(e,t);return i.source=this,i}onRowDblClick(e){if(co(e))return;let t=this.createRowEventWithSource("rowDoubleClicked",e);t.isEventHandlingSuppressed=this.isSuppressMouseEvent(e),this.beans.eventSvc.dispatchEvent(t)}findFullWidthInfoForEvent(e){if(!e)return;let t=this.findFullWidthRowGui(e.target),i=this.getColumnForFullWidth(t);if(!(!t||!i))return{rowGui:t,column:i}}findFullWidthRowGui(e){return this.allRowGuis.find(t=>t.element.contains(e))}getColumnForFullWidth(e){let{visibleCols:t}=this.beans;switch(e?.containerType){case"center":return t.centerCols[0];case"left":return t.leftCols[0];case"right":return t.rightCols[0];default:return t.allCols[0]}}onRowMouseDown(e){if(this.lastMouseDownOnDragger=Hs(e.target,"ag-row-drag",3),!this.isFullWidth()||this.isSuppressMouseEvent(e))return;let{rangeSvc:t,focusSvc:i}=this.beans;t?.removeAllCellRanges();let n=this.findFullWidthInfoForEvent(e);if(!n)return;let{rowGui:o,column:s}=n,r=o.element,a=e.target,l=this.rowNode,d=e.defaultPrevented||es();r&&r.contains(a)&&Kl(a)&&(d=!1),i.setFocusedCell({rowIndex:l.rowIndex,column:s,rowPinned:l.rowPinned,forceBrowserFocus:d})}isSuppressMouseEvent(e){let{gos:t,rowNode:i}=this;if(this.isFullWidth()){let o=this.findFullWidthRowGui(e.target);return hH(t,o?.rowComp.getFullWidthCellRendererParams(),i,e)}let n=Pv(t,e.target);return n!=null&&Zh(t,n.column,i,e)}onRowClick(e){if(co(e)||this.lastMouseDownOnDragger)return;let i=this.isSuppressMouseEvent(e),{eventSvc:n,selectionSvc:o}=this.beans,s=this.createRowEventWithSource("rowClicked",e);s.isEventHandlingSuppressed=i,n.dispatchEvent(s),!i&&o?.handleSelectionEvent(e,this.rowNode,"rowClicked")}setupDetailRowAutoHeight(e){this.rowType==="FullWidthDetail"&&this.beans.masterDetailSvc?.setupDetailRowAutoHeight(this,e)}createFullWidthCompDetails(e,t){let{gos:i,rowNode:n}=this,o=te(i,{fullWidth:!0,data:n.data,node:n,value:n.key,valueFormatted:n.key,eGridCell:e,eParentOfValue:e,pinned:t,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(r,a,l,d)=>this.addFullWidthRowDragging(r,a,l,d),setTooltip:(r,a)=>{i.assertModuleRegistered("Tooltip",3),this.setupFullWidthRowTooltip(r,a)}}),s=this.beans.userCompFactory;switch(this.rowType){case"FullWidthDetail":return vN(s,o);case"FullWidthGroup":{let{value:r,valueFormatted:a}=this.beans.valueSvc.getValueForDisplay(void 0,this.rowNode,!0);return o.value=r,o.valueFormatted=a,CN(s,o)}case"FullWidthLoading":return mN(s,o);default:return fN(s,o)}}setupFullWidthRowTooltip(e,t){this.fullWidthGui&&(this.tooltipFeature=this.beans.tooltipSvc?.setupFullWidthRowTooltip(this.tooltipFeature,this,e,t))}addFullWidthRowDragging(e,t,i="",n){let{rowDragSvc:o,context:s}=this.beans;if(!o||!this.isFullWidth())return;let r=o.createRowDragComp(()=>i,this.rowNode,void 0,e,t,n);this.createBean(r,s),this.addDestroyFunc(()=>{this.destroyBean(r,s)})}onUiLevelChanged(){let e=xR(this.rowNode);if(this.rowLevel!=e){let t="ag-row-level-"+e,i="ag-row-level-"+this.rowLevel;for(let n of this.allRowGuis)n.rowComp.toggleCss(t,!0),n.rowComp.toggleCss(i,!1)}this.rowLevel=e}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getLastRow()}refreshFirstAndLastRowStyles(){let e=this.isFirstRowOnPage(),t=this.isLastRowOnPage();if(this.firstRowOnPage!==e){this.firstRowOnPage=e;for(let i of this.allRowGuis)i.rowComp.toggleCss("ag-row-first",e)}if(this.lastRowOnPage!==t){this.lastRowOnPage=t;for(let i of this.allRowGuis)i.rowComp.toggleCss("ag-row-last",t)}}getAllCellCtrls(){return this.leftCellCtrls.list.length===0&&this.rightCellCtrls.list.length===0?this.centerCellCtrls.list:[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){let e=[];if(this.beans.rowStyleSvc?.processClassesFromGridOptions(e,this.rowNode),!!e.length)for(let t of e)for(let i of this.allRowGuis)i.rowComp.toggleCss(t,!0)}postProcessRowClassRules(){this.beans.rowStyleSvc?.processRowClassRules(this.rowNode,e=>{for(let t of this.allRowGuis)t.rowComp.toggleCss(e,!0)},e=>{for(let t of this.allRowGuis)t.rowComp.toggleCss(e,!1)})}setStylesFromGridOptions(e,t){e&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(t,i=>i.rowComp.setUserStyles(this.rowStyles))}getPinnedForContainer(e){return e==="left"||e==="right"?e:null}getInitialRowClasses(e){let t=this.getPinnedForContainer(e),i=this.isFullWidth(),{rowNode:n,beans:o}=this,s=[];s.push("ag-row"),s.push(this.rowFocused?"ag-row-focus":"ag-row-no-focus"),this.fadeInAnimation[e]&&s.push("ag-opacity-zero"),s.push(n.rowIndex%2===0?"ag-row-even":"ag-row-odd"),n.isRowPinned()&&(s.push("ag-row-pinned"),o.pinnedRowModel?.isManual()&&s.push("ag-row-pinned-manual")),!n.isRowPinned()&&n.pinnedSibling&&s.push("ag-row-pinned-source"),n.isSelected()&&s.push("ag-row-selected"),n.footer&&s.push("ag-row-footer"),s.push("ag-row-level-"+this.rowLevel),n.stub&&s.push("ag-row-loading"),i&&s.push("ag-full-width-row"),o.expansionSvc?.addExpandedCss(s,n),n.dragging&&s.push("ag-row-dragging");let{rowStyleSvc:r}=o;return r&&(r.processClassesFromGridOptions(s,n),r.preProcessRowClassRules(s,n)),s.push(this.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),this.isFirstRowOnPage()&&s.push("ag-row-first"),this.isLastRowOnPage()&&s.push("ag-row-last"),i&&(t==="left"&&s.push("ag-cell-last-left-pinned"),t==="right"&&s.push("ag-cell-first-right-pinned")),s}processStylesFromGridOptions(){return this.beans.rowStyleSvc?.processStylesFromGridOptions(this.rowNode)??this.emptyStyle}onRowSelected(e){this.beans.selectionSvc?.onRowCtrlSelected(this,t=>{(t===this.centerGui||t===this.fullWidthGui)&&this.announceDescription()},e)}announceDescription(){this.beans.selectionSvc?.announceAriaRowSelection(this.rowNode)}addHoverFunctionality(e){if(!this.active)return;let{element:t,compBean:i}=e,{rowNode:n,beans:o,gos:s}=this;i.addManagedListeners(t,{pointerenter:r=>{r.pointerType==="mouse"&&n.dispatchRowEvent("mouseEnter")},pointerleave:r=>{r.pointerType==="mouse"&&n.dispatchRowEvent("mouseLeave")}}),i.addManagedListeners(n,{mouseEnter:()=>{!o.dragSvc?.dragging&&!s.get("suppressRowHoverHighlight")&&(t.classList.add("ag-row-hover"),n.setHovered(!0))},mouseLeave:()=>{this.resetHoveredStatus(t)}})}resetHoveredStatus(e){let t=e?[e]:this.allRowGuis.map(i=>i.element);for(let i of t)i.classList.remove("ag-row-hover");this.rowNode.setHovered(!1)}roundRowTopToBounds(e){let t=this.beans.ctrlsSvc.getScrollFeature().getApproximateVScollPosition(),i=this.applyPaginationOffset(t.top,!0)-100,n=this.applyPaginationOffset(t.bottom,!0)+100;return Math.min(Math.max(i,e),n)}forEachGui(e,t){if(e)t(e);else for(let i of this.allRowGuis)t(i)}isRowRendered(){return this.allRowGuis.length>0}onRowHeightChanged(e){if(this.rowNode.rowHeight==null)return;let t=this.rowNode.rowHeight,i=this.beans.environment.getDefaultRowHeight(),o=m6(this.gos)?Yo(this.beans,this.rowNode).height:void 0,s=o?`${Math.min(i,o)-2}px`:void 0;this.forEachGui(e,r=>{r.element.style.height=`${t}px`,s&&r.element.style.setProperty("--ag-line-height",s)})}destroyFirstPass(e=!1){this.active=!1;let{rowNode:t}=this;if(!e&&la(this.gos)&&!t.sticky)if(t.rowTop!=null){let o=this.roundRowTopToBounds(t.rowTop);this.setRowTop(o)}else for(let o of this.allRowGuis)o.rowComp.toggleCss("ag-opacity-zero",!0);this.fullWidthGui?.element.contains(tt(this.beans))&&this.beans.focusSvc.attemptToRecoverFocus(),t.setHovered(!1);let i=this.createRowEvent("virtualRowRemoved");this.dispatchLocalEvent(i),this.beans.eventSvc.dispatchEvent(i),super.destroy()}destroySecondPass(){this.allRowGuis.length=0;let e=t=>{for(let i of t.list)i.destroy();return{list:[],map:{}}};this.centerCellCtrls=e(this.centerCellCtrls),this.leftCellCtrls=e(this.leftCellCtrls),this.rightCellCtrls=e(this.rightCellCtrls)}setFocusedClasses(e){this.forEachGui(e,t=>{t.rowComp.toggleCss("ag-row-focus",this.rowFocused),t.rowComp.toggleCss("ag-row-no-focus",!this.rowFocused)})}onCellFocusChanged(){let{focusSvc:e}=this.beans,t=e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);t!==this.rowFocused&&(this.rowFocused=t,this.setFocusedClasses())}onPaginationChanged(){let e=this.beans.pagination?.getCurrentPage()??0;this.paginationPage!==e&&(this.paginationPage=e,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(e,t=!1){if(this.rowNode.isRowPinned()||this.rowNode.sticky)return e;let i=this.beans.pageBounds.getPixelOffset();return e+i*(t?1:-1)}setRowTop(e){if(!this.printLayout&&q(e)){let t=this.applyPaginationOffset(e),o=`${this.rowNode.isRowPinned()||this.rowNode.sticky?t:this.beans.rowContainerHeight.getRealPixelPosition(t)}px`;this.setRowTopStyle(o)}}getInitialRowTop(e){return this.suppressRowTransform?this.getInitialRowTopShared(e):void 0}getInitialTransform(e){return this.suppressRowTransform?void 0:`translateY(${this.getInitialRowTopShared(e)})`}getInitialRowTopShared(e){if(this.printLayout)return"";let t=this.rowNode,i;if(t.sticky)i=t.stickyRowTop;else{let n=this.slideInAnimation[e]?this.roundRowTopToBounds(t.oldRowTop):t.rowTop,o=this.applyPaginationOffset(n);i=t.isRowPinned()?o:this.beans.rowContainerHeight.getRealPixelPosition(o)}return i+"px"}setRowTopStyle(e){for(let t of this.allRowGuis)this.suppressRowTransform?t.rowComp.setTop(e):t.rowComp.setTransform(`translateY(${e})`)}getCellCtrl(e,t=!1){let i=null;for(let n of this.getAllCellCtrls())n.column==e&&(i=n);if(i!=null||t)return i;for(let n of this.getAllCellCtrls())n?.getColSpanningList().indexOf(e)>=0&&(i=n);return i}onRowIndexChanged(){this.rowNode.rowIndex!=null&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}updateRowIndexes(e){let t=this.rowNode.getRowIndexString();if(t===null)return;let i=(this.beans.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0)+(this.beans.filterManager?.getHeaderRowCount()??0),n=this.rowNode.rowIndex%2===0,o=i+this.rowNode.rowIndex+1;this.forEachGui(e,s=>{s.rowComp.setRowIndex(t),s.rowComp.toggleCss("ag-row-even",n),s.rowComp.toggleCss("ag-row-odd",!n),sp(s.element,o)})}},Aq=class extends D{constructor(){super(),this.beanName="navigation",this.onPageDown=yE(this.onPageDown,100),this.onPageUp=yE(this.onPageUp,100)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}handlePageScrollingKey(e,t=!1){let i=e.key,n=e.altKey,o=e.ctrlKey||e.metaKey,s=!!this.beans.rangeSvc&&e.shiftKey,r=BH(this.gos,e),a=!1;switch(i){case R.PAGE_HOME:case R.PAGE_END:!o&&!n&&(this.onHomeOrEndKey(i),a=!0);break;case R.LEFT:case R.RIGHT:case R.UP:case R.DOWN:if(!r)return!1;o&&!n&&!s&&(this.onCtrlUpDownLeftRight(i,r),a=!0);break;case R.PAGE_DOWN:case R.PAGE_UP:!o&&!n&&(a=this.handlePageUpDown(i,r,t));break}return a&&e.preventDefault(),a}handlePageUpDown(e,t,i){return i&&(t=this.beans.focusSvc.getFocusedCell()),t?(e===R.PAGE_UP?this.onPageUp(t):this.onPageDown(t),!0):!1}navigateTo({scrollIndex:e,scrollType:t,scrollColumn:i,focusIndex:n,focusColumn:o,isAsync:s,rowPinned:r}){let{scrollFeature:a}=this.gridBodyCon;q(i)&&!i.isPinned()&&a.ensureColumnVisible(i),q(e)&&a.ensureIndexVisible(e,t),s||a.ensureIndexVisible(n);let{focusSvc:l,rangeSvc:d}=this.beans;l.setFocusedCell({rowIndex:n,column:o,rowPinned:r,forceBrowserFocus:!0}),d?.setRangeToCell({rowIndex:n,rowPinned:r,column:o})}onPageDown(e){let t=this.beans,i=pC(t),n=this.getViewportHeight(),{pageBounds:o,rowModel:s,rowAutoHeight:r}=t,a=o.getPixelOffset(),l=i.top+n,d=s.getRowIndexAtPixel(l+a);r?.active?this.navigateToNextPageWithAutoHeight(e,d):this.navigateToNextPage(e,d)}onPageUp(e){let t=this.beans,i=pC(t),{pageBounds:n,rowModel:o,rowAutoHeight:s}=t,r=n.getPixelOffset(),a=i.top,l=o.getRowIndexAtPixel(a+r);s?.active?this.navigateToNextPageWithAutoHeight(e,l,!0):this.navigateToNextPage(e,l,!0)}navigateToNextPage(e,t,i=!1){let{pageBounds:n,rowModel:o}=this.beans,s=this.getViewportHeight(),r=n.getFirstRow(),a=n.getLastRow(),l=n.getPixelOffset(),d=o.getRow(e.rowIndex),c=i?d?.rowHeight-s-l:s-l,u=d?.rowTop+c,h=o.getRowIndexAtPixel(u+l);if(h===e.rowIndex){let g=i?-1:1;t=h=e.rowIndex+g}let p;i?(p="bottom",h<r&&(h=r),t<r&&(t=r)):(p="top",h>a&&(h=a),t>a&&(t=a)),this.isRowTallerThanView(o.getRow(h))&&(t=h,p="top"),this.navigateTo({scrollIndex:t,scrollType:p,scrollColumn:null,focusIndex:h,focusColumn:e.column})}navigateToNextPageWithAutoHeight(e,t,i=!1){this.navigateTo({scrollIndex:t,scrollType:i?"bottom":"top",scrollColumn:null,focusIndex:t,focusColumn:e.column}),setTimeout(()=>{let n=this.getNextFocusIndexForAutoHeight(e,i);this.navigateTo({scrollIndex:t,scrollType:i?"bottom":"top",scrollColumn:null,focusIndex:n,focusColumn:e.column,isAsync:!0})},50)}getNextFocusIndexForAutoHeight(e,t=!1){let i=t?-1:1,n=this.getViewportHeight(),{pageBounds:o,rowModel:s}=this.beans,r=o.getLastRow(),a=0,l=e.rowIndex;for(;l>=0&&l<=r;){let d=s.getRow(l);if(d){let c=d.rowHeight??0;if(a+c>n)break;a+=c}l+=i}return Math.max(0,Math.min(l,r))}getViewportHeight(){let e=this.beans,t=pC(e),i=this.beans.scrollVisibleSvc.getScrollbarWidth(),n=t.bottom-t.top;return e.ctrlsSvc.get("center").isHorizontalScrollShowing()&&(n-=i),n}isRowTallerThanView(e){if(!e)return!1;let t=e.rowHeight;return typeof t!="number"?!1:t>this.getViewportHeight()}onCtrlUpDownLeftRight(e,t){let i=this.beans.cellNavigation.getNextCellToFocus(e,t,!0),n=this.getNormalisedPosition(i),{rowIndex:o,rowPinned:s,column:r}=n??i,a=r;this.navigateTo({scrollIndex:o,scrollType:null,scrollColumn:a,focusIndex:o,focusColumn:a,rowPinned:s})}onHomeOrEndKey(e){let t=e===R.PAGE_HOME,{visibleCols:i,pageBounds:n,rowModel:o}=this.beans,s=i.allCols,r=t?n.getFirstRow():n.getLastRow(),a=o.getRow(r);if(!a)return;let l=(t?s:[...s].reverse()).find(d=>!d.isSuppressNavigable(a));l&&this.navigateTo({scrollIndex:r,scrollType:null,scrollColumn:l,focusIndex:r,focusColumn:l})}onTabKeyDown(e,t){let i=t.shiftKey,n=this.tabToNextCellCommon(e,i,t),o=this.beans,{ctrlsSvc:s,pageBounds:r,focusSvc:a,gos:l}=o;if(n!==!1){n?t.preventDefault():n===null&&s.get("gridCtrl").allowFocusForNextCoreContainer(i);return}if(i){let{rowIndex:d,rowPinned:c}=e.getRowPosition();(c?d===0:d===r.getFirstRow())&&(l.get("headerHeight")===0||Ws(o)?ba(o,!0,!0):(t.preventDefault(),a.focusPreviousFromFirstCell(t)))}else e instanceof fa&&e.focusCell(!0),(a.focusOverlay(!1)||ba(o,i))&&t.preventDefault()}tabToNextCell(e,t){let i=this.beans,{focusSvc:n,rowRenderer:o}=i,s=n.getFocusedCell();if(!s)return!1;let r=oa(i,s);return!r&&(r=o.getRowByPosition(s),!r?.isFullWidth())?!1:!!this.tabToNextCellCommon(r,e,t,"api")}tabToNextCellCommon(e,t,i,n="ui"){let{editSvc:o,focusSvc:s}=this.beans,r,a=e instanceof fa?e:e.getAllCellCtrls()?.[0];return o?.isEditing()?r=o?.moveToNextCell(a,t,i,n):r=this.moveToNextCellNotEditing(e,t,i),r===null?r:r||!!s.focusedHeader}moveToNextCellNotEditing(e,t,i){let n=this.beans.visibleCols.allCols,o;if(e instanceof Rp){if(o=_(b({},e.getRowPosition()),{column:t?n[0]:Ue(n)}),this.gos.get("embedFullWidthRows")&&i){let r=e.findFullWidthInfoForEvent(i);r&&(o.column=r.column)}}else o=e.getFocusedCellPosition();let s=this.findNextCellToFocusOn(o,{backwards:t,startEditing:!1});if(s===!1)return null;if(s instanceof fa)s.focusCell(!0);else if(s)return this.tryToFocusFullWidthRow(s,t);return q(s)}findNextCellToFocusOn(e,{backwards:t,startEditing:i,skipToNextEditableCell:n}){let o=e,s=this.beans,{cellNavigation:r,gos:a,focusSvc:l,rowRenderer:d,rangeSvc:c}=s;for(;;){e!==o&&(e=o),t||(o=this.getLastCellOfColSpan(o)),o=r.getNextTabbedCell(o,t);let u=a.getCallback("tabToNextCell");if(q(u)){let f=u({backwards:t,editing:i,previousCellPosition:e,nextCellPosition:o||null});if(f===!0)o=e;else{if(f===!1)return!1;o={rowIndex:f.rowIndex,column:f.column,rowPinned:f.rowPinned}}}if(!o)return null;if(o.rowIndex<0){let g=Sn(s);return l.focusHeaderPosition({headerPosition:{headerRowIndex:g+o.rowIndex,column:o.column},fromCell:!0}),null}let h=a.get("editType")==="fullRow";if(i&&(!h||n)&&!this.isCellEditable(o))continue;this.ensureCellVisible(o);let p=oa(s,o);if(!p){let g=d.getRowByPosition(o);if(!g||!g.isFullWidth()||i)continue;return _(b({},g.getRowPosition()),{column:o?.column})}if(!r.isSuppressNavigable(p.column,p.rowNode))return p.setFocusedCellPosition(o),c?.setRangeToCell(o),p}}isCellEditable(e){let t=this.lookupRowNodeForCell(e);return t?e.column.isCellEditable(t):!1}lookupRowNodeForCell({rowIndex:e,rowPinned:t}){let{pinnedRowModel:i,rowModel:n}=this.beans;return t==="top"?i?.getPinnedTopRow(e):t==="bottom"?i?.getPinnedBottomRow(e):n.getRow(e)}navigateToNextCell(e,t,i,n){let o=i,s=!1,r=this.beans,{cellNavigation:a,focusSvc:l,gos:d}=r;for(;o&&(o===i||!this.isValidNavigateCell(o));)d.get("enableRtl")?t===R.LEFT&&(o=this.getLastCellOfColSpan(o)):t===R.RIGHT&&(o=this.getLastCellOfColSpan(o)),o=a.getNextCellToFocus(t,o),s=Qe(o);if(s&&e&&e.key===R.UP&&(o={rowIndex:-1,rowPinned:null,column:i.column}),n){let u=d.getCallback("navigateToNextCell");if(q(u)){let p=u({key:t,previousCellPosition:i,nextCellPosition:o||null,event:e});q(p)?o={rowPinned:p.rowPinned,rowIndex:p.rowIndex,column:p.column}:o=null}}if(!o)return;if(o.rowIndex<0){let u=Sn(r);l.focusHeaderPosition({headerPosition:{headerRowIndex:u+o.rowIndex,column:i.column},event:e||void 0,fromCell:!0});return}let c=this.getNormalisedPosition(o);c?this.focusPosition(c):this.tryToFocusFullWidthRow(o)}getNormalisedPosition(e){if(!!this.beans.spannedRowRenderer?.getCellByPosition(e))return e;this.ensureCellVisible(e);let i=oa(this.beans,e);return i?(e=i.getFocusedCellPosition(),this.ensureCellVisible(e),e):null}tryToFocusFullWidthRow(e,t){let{visibleCols:i,rowRenderer:n,focusSvc:o,eventSvc:s}=this.beans,r=i.allCols;if(!n.getRowByPosition(e)?.isFullWidth())return!1;let l=o.getFocusedCell(),d={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column||(t?Ue(r):r[0])};this.focusPosition(d);let c=t??(l!=null&&FV(d,l));return s.dispatchEvent({type:"fullWidthRowFocused",rowIndex:d.rowIndex,rowPinned:d.rowPinned,column:d.column,isFullWidthCell:!0,fromBelow:c}),!0}focusPosition(e){let{focusSvc:t,rangeSvc:i}=this.beans;t.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0}),i?.setRangeToCell(e)}isValidNavigateCell(e){return!!ho(this.beans,e)}getLastCellOfColSpan(e){let t=oa(this.beans,e);if(!t)return e;let i=t.getColSpanningList();return i.length===1?e:{rowIndex:e.rowIndex,column:Ue(i),rowPinned:e.rowPinned}}ensureCellVisible(e){let t=v6(this.gos),i=this.beans.rowModel.getRow(e.rowIndex),n=t&&i?.sticky,{scrollFeature:o}=this.gridBodyCon;!n&&Qe(e.rowPinned)&&o.ensureIndexVisible(e.rowIndex),e.column.isPinned()||o.ensureColumnVisible(e.column)}ensureColumnVisible(e){let t=this.gridBodyCon.scrollFeature;e.isPinned()||t.ensureColumnVisible(e)}ensureRowVisible(e){this.gridBodyCon.scrollFeature.ensureIndexVisible(e)}};function pC(e){return e.ctrlsSvc.getScrollFeature().getVScrollPosition()}var Iq={moduleName:"KeyboardNavigation",version:z,beans:[Aq,tq,pU],apiFunctions:{getFocusedCell:iq,clearFocusedCell:nq,setFocusedCell:oq,setFocusedHeader:aq,tabToNextCell:sq,tabToPreviousCell:rq}},Lq=class extends D{constructor(){super(...arguments),this.beanName="pageBoundsListener"}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this),recalculateRowBounds:this.calculatePages.bind(this)}),this.onModelUpdated()}onModelUpdated(e){this.calculatePages(),this.eventSvc.dispatchEvent({type:"paginationChanged",animate:e?.animate??!1,newData:e?.newData??!1,newPage:e?.newPage??!1,newPageSize:e?.newPageSize??!1,keepRenderedRows:e?.keepRenderedRows??!1})}calculatePages(){let{pageBounds:e,pagination:t,rowModel:i}=this.beans;t?t.calculatePages():e.calculateBounds(0,i.getRowCount()-1)}},_q=class extends D{constructor(){super(...arguments),this.beanName="pageBounds",this.pixelOffset=0}getFirstRow(){return this.topRowBounds?.rowIndex??-1}getLastRow(){return this.bottomRowBounds?.rowIndex??-1}getCurrentPageHeight(){let{topRowBounds:e,bottomRowBounds:t}=this;return!e||!t?0:Math.max(t.rowTop+t.rowHeight-e.rowTop,0)}getCurrentPagePixelRange(){let{topRowBounds:e,bottomRowBounds:t}=this,i=e?.rowTop??0,n=t?t.rowTop+t.rowHeight:0;return{pageFirstPixel:i,pageLastPixel:n}}calculateBounds(e,t){let{rowModel:i}=this.beans,n=i.getRowBounds(e);n&&(n.rowIndex=e),this.topRowBounds=n;let o=i.getRowBounds(t);o&&(o.rowIndex=t),this.bottomRowBounds=o,this.calculatePixelOffset()}getPixelOffset(){return this.pixelOffset}calculatePixelOffset(){let e=this.topRowBounds?.rowTop??0;this.pixelOffset!==e&&(this.pixelOffset=e,this.eventSvc.dispatchEvent({type:"paginationPixelOffsetChanged"}))}},Oq=".ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top{min-width:0;overflow:hidden;position:relative}.ag-pinned-left-sticky-top,.ag-pinned-right-sticky-top{height:100%;overflow:hidden;position:relative}.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{height:100%;overflow:hidden;width:100%}.ag-pinned-left-header,.ag-pinned-right-header{display:inline-block;height:100%;overflow:hidden;position:relative}.ag-body-horizontal-scroll:not(.ag-scrollbar-invisible){.ag-horizontal-left-spacer:not(.ag-scroller-corner){border-right:var(--ag-pinned-column-border)}.ag-horizontal-right-spacer:not(.ag-scroller-corner){border-left:var(--ag-pinned-column-border)}}.ag-pinned-right-header{border-left:var(--ag-pinned-column-border)}.ag-pinned-left-header{border-right:var(--ag-pinned-column-border)}.ag-cell.ag-cell-first-right-pinned:not(.ag-cell-range-left,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-left:var(--ag-pinned-column-border)}.ag-cell.ag-cell-last-left-pinned:not(.ag-cell-range-right,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-right:var(--ag-pinned-column-border)}.ag-pinned-left-header .ag-header-cell-resize:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}.ag-pinned-right-header .ag-header-cell-resize:after{left:50%}.ag-pinned-left-header .ag-header-cell-resize{right:-3px}.ag-pinned-right-header .ag-header-cell-resize{left:-3px}",Nq=class extends D{constructor(e,t){super(),this.isLeft=e,this.elements=t,this.getWidth=e?()=>this.beans.pinnedCols.leftWidth:()=>this.beans.pinnedCols.rightWidth}postConstruct(){this.addManagedEventListeners({[`${this.isLeft?"left":"right"}PinnedWidthChanged`]:this.onPinnedWidthChanged.bind(this)})}onPinnedWidthChanged(){let e=this.getWidth(),t=e>0;for(let i of this.elements)i&&(Je(i,t),xn(i,e))}},Bq=class extends D{constructor(){super(...arguments),this.beanName="pinnedCols"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,t=>{this.gridBodyCtrl=t.gridBodyCtrl});let e=this.checkContainerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}checkContainerWidths(){let{gos:e,visibleCols:t,eventSvc:i}=this.beans,n=Nt(e,"print"),o=n?0:t.getColsLeftWidth(),s=n?0:t.getDisplayedColumnsRightWidth();o!=this.leftWidth&&(this.leftWidth=o,i.dispatchEvent({type:"leftPinnedWidthChanged"})),s!=this.rightWidth&&(this.rightWidth=s,i.dispatchEvent({type:"rightPinnedWidthChanged"}))}keepPinnedColumnsNarrowerThanViewport(){let e=this.gridBodyCtrl.eBodyViewport,t=rd(e);if(t<=50)return;let i=this.getPinnedColumnsOverflowingViewport(t-50),n=this.gos.getCallback("processUnpinnedColumns"),{columns:o,hasLockedPinned:s}=i,r=o;!r.length&&!s||(n&&(r=n({columns:r,viewportWidth:t})),r?.length&&(r=r.filter(a=>!ao(a)),this.setColsPinned(r,null,"viewportSizeFeature")))}createPinnedWidthFeature(e,...t){return new Nq(e,t)}setColsPinned(e,t,i){let{colModel:n,colAnimation:o,visibleCols:s,gos:r}=this.beans;if(!n.cols||!e?.length)return;if(Nt(r,"print")){I(37);return}o?.start();let a;t===!0||t==="left"?a="left":t==="right"?a="right":a=null;let l=[];for(let d of e){if(!d)continue;let c=n.getCol(d);c&&c.getPinned()!==a&&(this.setColPinned(c,a),l.push(c))}l.length&&(s.refresh(i),_6(this.eventSvc,l,i)),o?.finish()}initCol(e){let{pinned:t,initialPinned:i}=e.colDef;t!==void 0?this.setColPinned(e,t):this.setColPinned(e,i)}setColPinned(e,t){t===!0||t==="left"?e.pinned="left":t==="right"?e.pinned="right":e.pinned=null,e.dispatchStateUpdatedEvent("pinned")}setupHeaderPinnedWidth(e){let{scrollVisibleSvc:t}=this.beans;if(e.pinned==null)return;let i=e.pinned==="left",n=e.pinned==="right";e.hidden=!0;let o=()=>{let s=i?this.leftWidth:this.rightWidth;if(s==null)return;let r=s==0,a=e.hidden!==r,l=this.gos.get("enableRtl"),d=t.getScrollbarWidth(),u=t.verticalScrollShowing&&(l&&i||!l&&n)?s+d:s;e.comp.setPinnedContainerWidth(`${u}px`),e.comp.setDisplayed(!r),a&&(e.hidden=r,e.refresh())};e.addManagedEventListeners({leftPinnedWidthChanged:o,rightPinnedWidthChanged:o,scrollVisibilityChanged:o,scrollbarWidthChanged:o})}getHeaderResizeDiff(e,t){if(t.getPinned()){let{leftWidth:n,rightWidth:o}=this,s=rd(this.beans.ctrlsSvc.getGridBodyCtrl().eBodyViewport)-50;if(n+o+e>s)if(s>n+o)e=s-n-o;else return 0}return e}getPinnedColumnsOverflowingViewport(e){let t=this.rightWidth??0,i=this.leftWidth??0,n=t+i,o=!1;if(n<e)return{columns:[],hasLockedPinned:o};let{visibleCols:s}=this.beans,r=[...s.leftCols],a=[...s.rightCols],l=0,d=0,c=0,u=[],h=n-c-e;for(;(d<r.length||l<a.length)&&h>0;){if(l<a.length){let p=a[l++];if(p.colDef.lockPinned){o=!0;continue}h-=p.getActualWidth(),u.push(p)}if(d<r.length&&h>0){let p=r[d++];if(p.colDef.lockPinned){o=!0;continue}h-=p.getActualWidth(),u.push(p)}}return{columns:u,hasLockedPinned:o}}},Hq={moduleName:"PinnedColumn",version:z,beans:[Bq],css:[Oq]},Gq=class extends D{constructor(){super(),this.beanName="ariaAnnounce",this.descriptionContainer=null,this.pendingAnnouncements=new Map,this.lastAnnouncement="",this.updateAnnouncement=_t(this,this.updateAnnouncement.bind(this),200)}postConstruct(){let e=this.beans,t=kt(e),i=this.descriptionContainer=t.createElement("div");i.classList.add("ag-aria-description-container"),WR(i,"polite"),d_(i,"additions text"),l_(i,!0),e.eGridDiv.appendChild(i)}announceValue(e,t){this.pendingAnnouncements.set(t,e),this.updateAnnouncement()}updateAnnouncement(){if(!this.descriptionContainer)return;let e=Array.from(this.pendingAnnouncements.values()).join(". ");this.pendingAnnouncements.clear(),this.descriptionContainer.textContent="",setTimeout(()=>{this.handleAnnouncementUpdate(e)},50)}handleAnnouncementUpdate(e){if(!this.isAlive()||!this.descriptionContainer)return;let t=e;if(t==null||t.replace(/[ .]/g,"")==""){this.lastAnnouncement="";return}this.lastAnnouncement===t&&(t=`${t}\u200B`),this.lastAnnouncement=t,this.descriptionContainer.textContent=t}destroy(){super.destroy();let{descriptionContainer:e}=this;e&&(Ot(e),e.remove()),this.descriptionContainer=null,this.pendingAnnouncements.clear()}},Vq={moduleName:"Aria",version:z,beans:[Gq]},zq=":where(.ag-delay-render){.ag-cell,.ag-header-cell,.ag-header-group-cell,.ag-row,.ag-spanned-cell-wrapper{visibility:hidden}}",ER="ag-delay-render",Wq=class extends D{constructor(){super(...arguments),this.beanName="colDelayRenderSvc",this.hideRequested=!1,this.alreadyRevealed=!1,this.timesRetried=0,this.requesters=new Set}hideColumns(e){this.alreadyRevealed||this.requesters.has(e)||(this.requesters.add(e),this.hideRequested||(this.beans.ctrlsSvc.whenReady(this,t=>{t.gridBodyCtrl.eGridBody.classList.add(ER)}),this.hideRequested=!0))}revealColumns(e){if(this.alreadyRevealed||!this.isAlive()||(this.requesters.delete(e),this.requesters.size>0))return;let{renderStatus:t,ctrlsSvc:i}=this.beans;if(t){if(!t.areHeaderCellsRendered()&&this.timesRetried<5){this.timesRetried++,setTimeout(()=>this.revealColumns(e));return}this.timesRetried=0}i.getGridBodyCtrl().eGridBody.classList.remove(ER),this.alreadyRevealed=!0}},Uq={moduleName:"ColumnDelayRender",version:z,beans:[Wq],css:[zq]};function qq(e){e.overlays?.showLoadingOverlay()}function $q(e){e.overlays?.showNoRowsOverlay()}function jq(e){e.overlays?.hideOverlay()}var Kq=".ag-overlay{inset:0;pointer-events:none;position:absolute;z-index:2}.ag-overlay-panel,.ag-overlay-wrapper{display:flex;height:100%;width:100%}.ag-overlay-wrapper{align-items:center;flex:none;justify-content:center;text-align:center}.ag-overlay-loading-wrapper{pointer-events:all}.ag-overlay-loading-center{background:var(--ag-background-color);border:solid var(--ag-border-width) var(--ag-border-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-popup-shadow);padding:var(--ag-spacing)}",Yq={tag:"div",cls:"ag-overlay",role:"presentation",children:[{tag:"div",cls:"ag-overlay-panel",role:"presentation",children:[{tag:"div",ref:"eOverlayWrapper",cls:"ag-overlay-wrapper",role:"presentation"}]}]},pP=class extends Oe{constructor(){super(Yq),this.eOverlayWrapper=V,this.activePromise=null,this.activeOverlay=null,this.updateListenerDestroyFunc=null,this.activeCssClass=null,this.elToFocusAfter=null,this.registerCSS(Kq)}handleKeyDown(e){if(e.key!==R.TAB||e.defaultPrevented||co(e))return;let t=this.beans;if(Qs(t,this.eOverlayWrapper,!1,e.shiftKey))return;let n=!1;e.shiftKey?n=t.focusSvc.focusGridView({column:Ue(t.visibleCols.allCols),backwards:!0,canFocusOverlay:!1}):n=ba(t,!1),n&&e.preventDefault()}updateLayoutClasses(e,t){let i=this.eOverlayWrapper.classList,{AUTO_HEIGHT:n,NORMAL:o,PRINT:s}=ji;i.toggle(n,t.autoHeight),i.toggle(o,t.normal),i.toggle(s,t.print)}postConstruct(){this.createManagedBean(new Ev(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.beans.overlays.setOverlayWrapperComp(this),this.addManagedElementListeners(this.getFocusableElement(),{keydown:this.handleKeyDown.bind(this)})}setWrapperTypeClass(e){let t=this.eOverlayWrapper.classList;this.activeCssClass&&t.toggle(this.activeCssClass,!1),this.activeCssClass=e,t.toggle(e,!0)}showOverlay(e,t,i,n){if(this.setWrapperTypeClass(t),this.destroyActiveOverlay(),this.elToFocusAfter=null,this.activePromise=e,!!e){if(this.setDisplayed(!0,{skipAriaHidden:!0}),i&&this.isGridFocused()){let o=tt(this.beans);o&&!HR(this.beans)&&(this.elToFocusAfter=o)}e.then(o=>{if(this.activePromise!==e){this.activeOverlay!==o&&(this.destroyBean(o),o=null);return}if(this.activePromise=null,!!o){if(this.activeOverlay!==o&&(this.eOverlayWrapper.appendChild(o.getGui()),this.activeOverlay=o,n)){let s=o;this.updateListenerDestroyFunc=this.addManagedPropertyListener(n,({currentValue:r})=>{s.refresh?.(te(this.gos,b({},r??{})))})}i&&this.isGridFocused()&&js(this.eOverlayWrapper)}})}}updateOverlayWrapperPaddingTop(e){this.eOverlayWrapper.style.setProperty("padding-top",`${e}px`)}destroyActiveOverlay(){this.activePromise=null;let e=this.activeOverlay;if(!e)return;let t=this.elToFocusAfter;this.activeOverlay=null,this.elToFocusAfter=null,t&&!this.isGridFocused()&&(t=null);let i=this.updateListenerDestroyFunc;i&&(i(),this.updateListenerDestroyFunc=null),this.destroyBean(e),Ot(this.eOverlayWrapper),t?.focus?.({preventScroll:!0})}hideOverlay(){this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}isGridFocused(){let e=tt(this.beans);return!!e&&this.beans.eGridDiv.contains(e)}destroy(){this.elToFocusAfter=null,this.destroyActiveOverlay(),this.beans.overlays.setOverlayWrapperComp(void 0),super.destroy()}},Xq={selector:"AG-OVERLAY-WRAPPER",component:pP},Jq=class extends D{constructor(){super(...arguments),this.beanName="overlays",this.state=0,this.showInitialOverlay=!0,this.wrapperPadding=0}postConstruct(){this.isClientSide=gt(this.gos),this.isServerSide=!this.isClientSide&&xa(this.gos);let e=()=>this.updateOverlayVisibility();this.addManagedEventListeners({newColumnsLoaded:e,rowDataUpdated:e,gridSizeChanged:this.refreshWrapperPadding.bind(this),rowCountReady:()=>{this.showInitialOverlay=!1,this.updateOverlayVisibility()}}),this.addManagedPropertyListener("loading",e)}setOverlayWrapperComp(e){this.eWrapper=e,this.updateOverlayVisibility()}isVisible(){return this.state!==0&&!!this.eWrapper}isExclusive(){return this.state===1&&!!this.eWrapper}showLoadingOverlay(){this.showInitialOverlay=!1;let e=this.gos,t=e.get("loading");!t&&(t!==void 0||e.get("suppressLoadingOverlay"))||this.doShowLoadingOverlay()}showNoRowsOverlay(){this.showInitialOverlay=!1;let e=this.gos;e.get("loading")||e.get("suppressNoRowsOverlay")||this.doShowNoRowsOverlay()}hideOverlay(){if(this.showInitialOverlay=!1,this.gos.get("loading")){I(99);return}this.doHideOverlay()}getOverlayWrapperSelector(){return Xq}getOverlayWrapperCompClass(){return pP}updateOverlayVisibility(){if(!this.eWrapper){this.state=0;return}let{state:e,isClientSide:t,isServerSide:i,beans:{gos:n,colModel:o,rowModel:s}}=this,r=this.gos.get("loading");r!==void 0&&(this.showInitialOverlay=!1),this.showInitialOverlay&&r===void 0&&!n.get("suppressLoadingOverlay")&&(r=!n.get("columnDefs")||!o.ready||!n.get("rowData")&&t),r?e!==1&&this.doShowLoadingOverlay():(this.showInitialOverlay=!1,t&&s.isEmpty()&&!n.get("suppressNoRowsOverlay")?e!==2&&this.doShowNoRowsOverlay():(e===1||!i&&e!==0)&&this.doHideOverlay())}doShowLoadingOverlay(){this.eWrapper&&(this.state=1,this.showOverlay(yN(this.beans.userCompFactory,te(this.gos,{})),"ag-overlay-loading-wrapper","loadingOverlayComponentParams"),this.updateExclusive())}doShowNoRowsOverlay(){this.eWrapper&&(this.state=2,this.showOverlay(SN(this.beans.userCompFactory,te(this.gos,{})),"ag-overlay-no-rows-wrapper","noRowsOverlayComponentParams"),this.updateExclusive())}doHideOverlay(){this.eWrapper&&(this.state=0,this.eWrapper.hideOverlay(),this.updateExclusive())}showOverlay(e,t,i){let n=e?.newAgStackInstance()??null;this.eWrapper?.showOverlay(n,t,this.isExclusive(),i),this.refreshWrapperPadding()}updateExclusive(){let e=this.exclusive;this.exclusive=this.isExclusive(),this.exclusive!==e&&this.eventSvc.dispatchEvent({type:"overlayExclusiveChanged"})}refreshWrapperPadding(){let e=this.eWrapper;if(!e)return;let t=0;this.state===2&&(t=this.beans.ctrlsSvc.get("gridHeaderCtrl")?.headerHeight||0),this.wrapperPadding!==t&&(this.wrapperPadding=t,e.updateOverlayWrapperPaddingTop(t))}},Qq={moduleName:"Overlay",version:z,userComponents:{agLoadingOverlay:fG,agNoRowsOverlay:CG},apiFunctions:{showLoadingOverlay:qq,showNoRowsOverlay:$q,hideOverlay:jq},beans:[Jq]},Zq=class extends D{constructor(){super(...arguments),this.beanName="rowContainerHeight",this.scrollY=0,this.uiBodyHeight=0}postConstruct(){this.addManagedEventListeners({bodyHeightChanged:this.updateOffset.bind(this)}),this.maxDivHeight=PN(),Ko(this.gos,"RowContainerHeightService - maxDivHeight = "+this.maxDivHeight)}updateOffset(){if(!this.stretching)return;let e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition().top,t=this.getUiBodyHeight();(e!==this.scrollY||t!==this.uiBodyHeight)&&(this.scrollY=e,this.uiBodyHeight=t,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;let e=this.scrollY/this.maxScrollY,t=e*this.pixelsToShave;Ko(this.gos,`RowContainerHeightService - Div Stretch Offset = ${t} (${this.pixelsToShave} * ${e})`),this.setDivStretchOffset(t)}setUiContainerHeight(e){e!==this.uiContainerHeight&&(this.uiContainerHeight=e,this.eventSvc.dispatchEvent({type:"rowContainerHeightChanged"}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(e){let t=typeof e=="number"?Math.floor(e):null;this.divStretchOffset!==t&&(this.divStretchOffset=t,this.eventSvc.dispatchEvent({type:"heightScaleChanged"}))}setModelHeight(e){this.modelHeight=e,this.stretching=e!=null&&this.maxDivHeight>0&&e>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getRealPixelPosition(e){return e-this.divStretchOffset}getUiBodyHeight(){let e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition();return e.bottom-e.top}getScrollPositionForPixel(e){if(this.pixelsToShave<=0)return e;let t=this.modelHeight-this.getUiBodyHeight(),i=e/t;return this.maxScrollY*i}},e$=400,t$=class extends D{constructor(){super(...arguments),this.beanName="rowRenderer",this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1,this.setupRangeSelectionListeners=()=>{let e=()=>{for(let s of this.getAllCellCtrls())s.onCellSelectionChanged()},t=()=>{for(let s of this.getAllCellCtrls())s.updateRangeBordersIfRangeCount()},i=()=>{this.eventSvc.addListener("cellSelectionChanged",e),this.eventSvc.addListener("columnMoved",t),this.eventSvc.addListener("columnPinned",t),this.eventSvc.addListener("columnVisible",t)},n=()=>{this.eventSvc.removeListener("cellSelectionChanged",e),this.eventSvc.removeListener("columnMoved",t),this.eventSvc.removeListener("columnPinned",t),this.eventSvc.removeListener("columnVisible",t)};this.addDestroyFunc(()=>n()),this.addManagedPropertyListeners(["enableRangeSelection","cellSelection"],()=>{uo(this.gos)?i():n()}),uo(this.gos)&&i()}}wireBeans(e){this.pageBounds=e.pageBounds,this.colModel=e.colModel,this.pinnedRowModel=e.pinnedRowModel,this.rowModel=e.rowModel,this.focusSvc=e.focusSvc,this.rowContainerHeight=e.rowContainerHeight,this.ctrlsSvc=e.ctrlsSvc,this.editSvc=e.editSvc}postConstruct(){this.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.initialise()})}initialise(){this.addManagedEventListeners({paginationChanged:this.onPageLoaded.bind(this),pinnedRowDataChanged:this.onPinnedRowDataChanged.bind(this),pinnedRowsChanged:this.onPinnedRowsChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),bodyScroll:this.onBodyScroll.bind(this),bodyHeightChanged:this.redraw.bind(this,{})}),this.addManagedPropertyListeners(["domLayout","embedFullWidthRows"],()=>this.onDomLayoutChanged()),this.addManagedPropertyListeners(["suppressMaxRenderedRowRestriction","rowBuffer"],()=>this.redraw()),this.addManagedPropertyListener("suppressCellFocus",n=>this.onSuppressCellFocusChanged(n.currentValue)),this.addManagedPropertyListeners(["groupSuppressBlankHeader","getBusinessKeyForNode","fullWidthCellRenderer","fullWidthCellRendererParams","suppressStickyTotalRow","groupRowRenderer","groupRowRendererParams","loadingCellRenderer","loadingCellRendererParams","detailCellRenderer","detailCellRendererParams","enableRangeSelection","enableCellTextSelection"],()=>this.redrawRows()),this.addManagedPropertyListener("cellSelection",({currentValue:n,previousValue:o})=>{(!o&&n||o&&!n)&&this.redrawRows()});let{stickyRowSvc:e,gos:t,showRowGroupCols:i}=this.beans;if(i&&this.addManagedPropertyListener("showOpenedGroup",()=>{let n=i.getShowRowGroupCols();n.length&&this.refreshCells({columns:n,force:!0})}),e)this.stickyRowFeature=e.createStickyRowFeature(this,this.createRowCon.bind(this),this.destroyRowCtrls.bind(this));else{let n=this.gridBodyCtrl;n.setStickyTopHeight(0),n.setStickyBottomHeight(0)}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=Nt(t,"print"),this.embedFullWidthRows=this.printLayout||t.get("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gos.get("keepDetailRows")){let e=this.getKeepDetailRowsCount(),t=e??3;this.cachedRowCtrls=new i$(t)}}getKeepDetailRowsCount(){return this.gos.get("keepDetailRowsCount")}getStickyTopRowCtrls(){return this.stickyRowFeature?.stickyTopRowCtrls??[]}getStickyBottomRowCtrls(){return this.stickyRowFeature?.stickyBottomRowCtrls??[]}updateAllRowCtrls(){let e=Object.values(this.rowCtrlsByRowIndex),t=Object.values(this.zombieRowCtrls),i=this.cachedRowCtrls?.getEntries()??[];t.length>0||i.length>0?this.allRowCtrls=[...e,...t,...i]:this.allRowCtrls=e}isCellBeingRendered(e,t){let i=this.rowCtrlsByRowIndex[e];return!t||!i?!!i:i.isFullWidth()?!0:!!this.beans.spannedRowRenderer?.getCellByPosition({rowIndex:e,column:t,rowPinned:null})||!!i.getCellCtrl(t)||!i.isRowRendered()}updateCellFocus(e){for(let t of this.getAllCellCtrls())t.onCellFocused(e);for(let t of this.getFullWidthRowCtrls())t.onFullWidthRowFocused(e)}onCellFocusChanged(e){if(e?.rowIndex!=null&&!e.rowPinned){let t=this.beans.colModel.getCol(e.column)??void 0;this.isCellBeingRendered(e.rowIndex,t)||this.redraw()}this.updateCellFocus(e)}onSuppressCellFocusChanged(e){for(let t of this.getAllCellCtrls())t.onSuppressCellFocusChanged(e);for(let t of this.getFullWidthRowCtrls())t.onSuppressCellFocusChanged(e)}registerCellEventListeners(){this.addManagedEventListeners({cellFocused:e=>this.onCellFocusChanged(e),cellFocusCleared:()=>this.updateCellFocus(),flashCells:e=>{let{cellFlashSvc:t}=this.beans;if(t)for(let i of this.getAllCellCtrls())t.onFlashCells(i,e)},columnHoverChanged:()=>{for(let e of this.getAllCellCtrls())e.onColumnHover()},displayedColumnsChanged:()=>{for(let e of this.getAllCellCtrls())e.onDisplayedColumnsChanged()},displayedColumnsWidthChanged:()=>{if(this.printLayout)for(let e of this.getAllCellCtrls())e.onLeftChanged()}}),this.setupRangeSelectionListeners(),this.refreshListenersToColumnsForCellComps(),this.addManagedEventListeners({gridColumnsChanged:this.refreshListenersToColumnsForCellComps.bind(this)}),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){for(let e of this.destroyFuncsForColumnListeners)e();this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners();let e=this.colModel.getCols();for(let t of e){let i=l=>{for(let d of this.getAllCellCtrls())d.column===t&&l(d)},n=()=>{i(l=>l.onLeftChanged())},o=()=>{i(l=>l.onWidthChanged())},s=()=>{i(l=>l.onFirstRightPinnedChanged())},r=()=>{i(l=>l.onLastLeftPinnedChanged())},a=()=>{i(l=>l.onColDefChanged())};t.__addEventListener("leftChanged",n),t.__addEventListener("widthChanged",o),t.__addEventListener("firstRightPinnedChanged",s),t.__addEventListener("lastLeftPinnedChanged",r),t.__addEventListener("colDefChanged",a),this.destroyFuncsForColumnListeners.push(()=>{t.__removeEventListener("leftChanged",n),t.__removeEventListener("widthChanged",o),t.__removeEventListener("firstRightPinnedChanged",s),t.__removeEventListener("lastLeftPinnedChanged",r),t.__removeEventListener("colDefChanged",a)})}}onDomLayoutChanged(){let e=Nt(this.gos,"print"),t=e||this.gos.get("embedFullWidthRows"),i=t!==this.embedFullWidthRows||this.printLayout!==e;this.printLayout=e,this.embedFullWidthRows=t,i&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;let e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}onPageLoaded(e){let t={recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0};this.redrawAfterModelUpdate(t)}getAllCellsNotSpanningForColumn(e){let t=[];for(let i of this.getAllRowCtrls()){let n=i.getCellCtrl(e,!0)?.eGui;n&&t.push(n)}return t}refreshFloatingRowComps(e=!0){this.refreshFloatingRows(this.topRowCtrls,"top",e),this.refreshFloatingRows(this.bottomRowCtrls,"bottom",e)}refreshFloatingRows(e,t,i){let{pinnedRowModel:n,beans:o,printLayout:s}=this,r=Object.fromEntries(e.map(l=>[l.rowNode.id,l]));n?.forEachPinnedRow(t,(l,d)=>{let c=e[d];c&&n.getPinnedRowById(c.rowNode.id,t)===void 0&&(c.destroyFirstPass(),c.destroySecondPass()),l.id in r&&i?(e[d]=r[l.id],delete r[l.id]):e[d]=new Rp(l,o,!1,!1,s)});let a=(t==="top"?n?.getPinnedTopRowCount():n?.getPinnedBottomRowCount())??0;e.length=a}onPinnedRowDataChanged(){let e={recycleRows:!0};this.redrawAfterModelUpdate(e)}onPinnedRowsChanged(){this.redrawAfterModelUpdate({recycleRows:!0})}redrawRow(e,t=!1){if(e.sticky)this.stickyRowFeature?.refreshStickyNode(e);else if(this.cachedRowCtrls?.has(e)){this.cachedRowCtrls.removeRow(e);return}else{let i=n=>{let o=n[e.rowIndex];o&&o.rowNode===e&&(o.destroyFirstPass(),o.destroySecondPass(),n[e.rowIndex]=this.createRowCon(e,!1,!1))};switch(e.rowPinned){case"top":i(this.topRowCtrls);break;case"bottom":i(this.bottomRowCtrls);break;default:i(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}t||this.dispatchDisplayedRowsChanged(!1)}redrawRows(e){let{editSvc:t}=this.beans;if(t?.isEditing()&&(t.isBatchEditing()?t.cleanupEditors():t.stopEditing(void 0,{source:"api"})),e!=null){for(let n of e??[])this.redrawRow(n,!0);this.dispatchDisplayedRowsChanged(!1);return}this.redrawAfterModelUpdate()}redrawAfterModelUpdate(e={}){this.getLockOnRefresh();let t=this.beans.focusSvc?.getFocusCellToUseAfterRefresh();this.updateContainerHeights(),this.scrollToTopIfNewData(e);let i=!e.domLayoutChanged&&!!e.recycleRows,n=e.animate&&la(this.gos),o=i?this.getRowsToRecycle():null;i||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender();let{stickyRowFeature:s,gos:r}=this;if(s){s.checkStickyRows();let a=s.extraTopHeight+s.extraBottomHeight;a&&this.updateContainerHeights(a)}this.recycleRows(o,n),this.gridBodyCtrl.updateRowCount(),e.onlyBody||this.refreshFloatingRowComps(r.get("enableRowPinning")?i:void 0),this.dispatchDisplayedRowsChanged(),t!=null&&this.restoreFocusedCell(t),this.releaseLockOnRefresh()}scrollToTopIfNewData(e){let t=e.newData||e.newPage,i=this.gos.get("suppressScrollOnNewData");t&&!i&&(this.gridBodyCtrl.scrollFeature.scrollToTop(),this.stickyRowFeature?.resetOffsets())}updateContainerHeights(e=0){let{rowContainerHeight:t}=this;if(this.printLayout){t.setModelHeight(null);return}let i=this.pageBounds.getCurrentPageHeight();i===0&&(i=1),t.setModelHeight(i+e)}getLockOnRefresh(){if(this.refreshInProgress)throw new Error(En(252));this.refreshInProgress=!0,this.beans.frameworkOverrides.getLockOnRefresh?.()}releaseLockOnRefresh(){this.refreshInProgress=!1,this.beans.frameworkOverrides.releaseLockOnRefresh?.()}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(e){if(!e)return;let t=this.beans.focusSvc,i=this.findPositionToFocus(e);if(!i){t.focusHeaderPosition({headerPosition:{headerRowIndex:Sn(this.beans)-1,column:e.column}});return}if(e.rowIndex!==i.rowIndex||e.rowPinned!=i.rowPinned){t.setFocusedCell(_(b({},i),{preventScrollOnBrowserFocus:!0,forceBrowserFocus:!0}));return}t.doesRowOrCellHaveBrowserFocus()||this.updateCellFocus(te(this.gos,_(b({},i),{forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,type:"cellFocused"})))}findPositionToFocus(e){let{pagination:t,pageBounds:i}=this.beans,n=e;for(n.rowPinned==null&&t&&i&&!t.isRowInPage(n.rowIndex)&&(n={rowPinned:null,rowIndex:i.getFirstRow()});n;){if(n.rowPinned==null&&i)if(n.rowIndex<i.getFirstRow()){if(n=xp(this.beans,{rowPinned:null,rowIndex:0}),!n)return null}else n.rowIndex>i.getLastRow()&&(n={rowPinned:null,rowIndex:i.getLastRow()});let o=this.getRowByPosition(n);if(o?.isAlive())return _(b({},o.getRowPosition()),{column:e.column});n=xp(this.beans,n)}return null}getAllCellCtrls(){let e=[],t=this.getAllRowCtrls(),i=t.length;for(let n=0;n<i;n++){let o=t[n].getAllCellCtrls(),s=o.length;for(let r=0;r<s;r++)e.push(o[r])}return e}getAllRowCtrls(){let{spannedRowRenderer:e}=this.beans,t=this.getStickyTopRowCtrls(),i=this.getStickyBottomRowCtrls();return[...this.topRowCtrls,...this.bottomRowCtrls,...t,...i,...e?.getCtrls("top")??[],...e?.getCtrls("bottom")??[],...e?.getCtrls("center")??[],...Object.values(this.rowCtrlsByRowIndex)]}addRenderedRowListener(e,t,i){let n=this.rowCtrlsByRowIndex[t];n&&n.addEventListener(e,i)}refreshCells({rowNodes:e,columns:t,force:i,suppressFlash:n}={}){let o={force:i,newData:!1,suppressFlash:n};for(let s of this.getCellCtrls(e,t))s.refreshOrDestroyCell(o);this.refreshFullWidth(e)}refreshRows(e={}){for(let t of this.getRowCtrls(e.rowNodes))t.refreshRow(e);this.refreshFullWidth(e.rowNodes)}refreshFullWidth(e){if(!e)return;let t=!1;for(let i of this.getRowCtrls(e)){if(!i.isFullWidth())continue;i.refreshFullWidth()||(t=!0,this.redrawRow(i.rowNode,!0))}t&&this.dispatchDisplayedRowsChanged(!1)}getRowCtrls(e){let t=KC(e),i=this.getAllRowCtrls();return!e||!t?i:i.filter(n=>{let o=n.rowNode;return YC(o,t)})}getCellCtrls(e,t){let i;q(t)&&(i={},t.forEach(o=>{let s=this.colModel.getCol(o);q(s)&&(i[s.getId()]=!0)}));let n=[];for(let o of this.getRowCtrls(e))for(let s of o.getAllCellCtrls()){let r=s.column.getId();i&&!i[r]||n.push(s)}return n}destroy(){this.removeAllRowComps(!0),super.destroy()}removeAllRowComps(e=!1){let t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t,e),this.stickyRowFeature?.destroyStickyCtrls()}getRowsToRecycle(){let e=[];for(let i of Object.keys(this.rowCtrlsByRowIndex))this.rowCtrlsByRowIndex[i].rowNode.id==null&&e.push(i);this.removeRowCtrls(e);let t={};for(let i of Object.values(this.rowCtrlsByRowIndex)){let n=i.rowNode;t[n.id]=i}return this.rowCtrlsByRowIndex={},t}removeRowCtrls(e,t=!1){for(let i of e){let n=this.rowCtrlsByRowIndex[i];n&&(n.destroyFirstPass(t),n.destroySecondPass()),delete this.rowCtrlsByRowIndex[i]}}onBodyScroll(e){e.direction==="vertical"&&this.redraw({afterScroll:!0})}redraw(e={}){let{focusSvc:t,animationFrameSvc:i}=this.beans,{afterScroll:n}=e,o,s=this.stickyRowFeature;s&&(o=t?.getFocusCellToUseAfterRefresh()||void 0);let r=this.firstRenderedRow,a=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();let l=!1;if(s){l=s.checkStickyRows();let c=s.extraTopHeight+s.extraBottomHeight;c&&this.updateContainerHeights(c)}let d=this.firstRenderedRow!==r||this.lastRenderedRow!==a;if(!(n&&!l&&!d)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,n),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(n&&!l),o!=null)){let c=t?.getFocusCellToUseAfterRefresh();o!=null&&c==null&&(i?.flushAllFrames(),this.restoreFocusedCell(o))}}removeRowCompsNotToDraw(e,t){let i={};for(let s of e)i[s]=!0;let o=Object.keys(this.rowCtrlsByRowIndex).filter(s=>!i[s]);this.removeRowCtrls(o,t)}calculateIndexesToDraw(e){let t=[];for(let r=this.firstRenderedRow;r<=this.lastRenderedRow;r++)t.push(r);let i=this.beans.pagination,n=this.beans.focusSvc?.getFocusedCell()?.rowIndex;n!=null&&(n<this.firstRenderedRow||n>this.lastRenderedRow)&&(!i||i.isRowInPage(n))&&n<this.rowModel.getRowCount()&&t.push(n);let o=r=>{let a=r.rowNode.rowIndex;a==null||a===n||(a<this.firstRenderedRow||a>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(r)&&t.push(a)};for(let r of Object.values(this.rowCtrlsByRowIndex))o(r);if(e)for(let r of Object.values(e))o(r);t.sort((r,a)=>r-a);let s=[];for(let r=0;r<t.length;r++){let a=t[r],l=this.rowModel.getRow(a);l&&!l.sticky&&s.push(a)}return s}recycleRows(e,t=!1,i=!1){let n=this.calculateIndexesToDraw(e);(this.printLayout||i)&&(t=!1),this.removeRowCompsNotToDraw(n,!t);for(let o of n)this.createOrUpdateRowCtrl(o,e,t,i);if(e){let{animationFrameSvc:o}=this.beans;o?.active&&i&&!this.printLayout?o.addDestroyTask(()=>{this.destroyRowCtrls(e,t),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}):this.destroyRowCtrls(e,t)}this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(e=!1){this.eventSvc.dispatchEvent({type:"displayedRowsChanged",afterScroll:e})}onDisplayedColumnsChanged(){let{visibleCols:e}=this.beans,t=e.isPinningLeft(),i=e.isPinningRight();(this.pinningLeft!==t||i!==this.pinningRight)&&(this.pinningLeft=t,this.pinningRight=i,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){let e=[];for(let t of this.getFullWidthRowCtrls()){let i=t.rowNode.rowIndex;e.push(i.toString())}this.refreshFloatingRowComps(),this.removeRowCtrls(e),this.redraw({afterScroll:!0})}getFullWidthRowCtrls(e){let t=KC(e);return this.getAllRowCtrls().filter(i=>{if(!i.isFullWidth())return!1;let n=i.rowNode;return!(t!=null&&!YC(n,t))})}createOrUpdateRowCtrl(e,t,i,n){let o,s=this.rowCtrlsByRowIndex[e];if(s||(o=this.rowModel.getRow(e),q(o)&&q(t)&&t[o.id]&&o.alreadyRendered&&(s=t[o.id],t[o.id]=null)),!s)if(o||(o=this.rowModel.getRow(e)),q(o))s=this.createRowCon(o,i,n);else return;o&&(o.alreadyRendered=!0),this.rowCtrlsByRowIndex[e]=s}destroyRowCtrls(e,t){let i=[];if(e){for(let n of Object.values(e))if(n){if(this.cachedRowCtrls&&n.isCacheable()){this.cachedRowCtrls.addRow(n);continue}if(n.destroyFirstPass(!t),t){let o=n.instanceId;this.zombieRowCtrls[o]=n,i.push(()=>{n.destroySecondPass(),delete this.zombieRowCtrls[o]})}else n.destroySecondPass()}}t&&(i.push(()=>{this.isAlive()&&(this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged())}),window.setTimeout(()=>{for(let n of i)n()},e$))}getRowBuffer(){return this.gos.get("rowBuffer")}getRowBufferInPixels(){let e=this.getRowBuffer(),t=Vs(this.beans);return e*t}workOutFirstAndLastRowsToRender(){let{rowContainerHeight:e,pageBounds:t,rowModel:i}=this;e.updateOffset();let n,o;if(!i.isRowsToRender())n=0,o=-1;else if(this.printLayout)this.beans.environment.refreshRowHeightVariable(),n=t.getFirstRow(),o=t.getLastRow();else{let c=this.getRowBufferInPixels(),u=this.ctrlsSvc.getScrollFeature(),h=this.gos.get("suppressRowVirtualisation"),p=!1,g,f;do{let y=t.getPixelOffset(),{pageFirstPixel:S,pageLastPixel:x}=t.getCurrentPagePixelRange(),E=e.divStretchOffset,T=u.getVScrollPosition(),L=T.top,O=T.bottom;h?(g=S+E,f=x+E):(g=Math.max(L+y-c,S)+E,f=Math.min(O+y+c,x)+E),this.firstVisibleVPixel=Math.max(L+y,S)+E,this.lastVisibleVPixel=Math.min(O+y,x)+E,p=this.ensureAllRowsInRangeHaveHeightsCalculated(g,f)}while(p);let m=i.getRowIndexAtPixel(g),C=i.getRowIndexAtPixel(f),v=t.getFirstRow(),w=t.getLastRow();m<v&&(m=v),C>w&&(C=w),n=m,o=C}let s=Nt(this.gos,"normal"),r=this.gos.get("suppressMaxRenderedRowRestriction"),a=Math.max(this.getRowBuffer(),500);s&&!r&&o-n>a&&(o=n+a);let l=n!==this.firstRenderedRow,d=o!==this.lastRenderedRow;(l||d)&&(this.firstRenderedRow=n,this.lastRenderedRow=o,this.eventSvc.dispatchEvent({type:"viewportChanged",firstRow:n,lastRow:o}))}dispatchFirstDataRenderedEvent(){this.dataFirstRenderedFired||(this.dataFirstRenderedFired=!0,po(this.beans,()=>{this.beans.eventSvc.dispatchEvent({type:"firstDataRendered",firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow})}))}ensureAllRowsInRangeHaveHeightsCalculated(e,t){let i=this.pinnedRowModel?.ensureRowHeightsValid(),n=this.stickyRowFeature?.ensureRowHeightsValid(),{pageBounds:o,rowModel:s}=this,r=s.ensureRowHeightsValid(e,t,o.getFirstRow(),o.getLastRow());return(r||n)&&this.eventSvc.dispatchEvent({type:"recalculateRowBounds"}),n||r||i?(this.updateContainerHeights(),!0):!1}doNotUnVirtualiseRow(e){let n=e.rowNode,o=this.focusSvc.isRowFocused(n.rowIndex,n.rowPinned),s=this.editSvc?.isEditing(e),r=n.detail;return o||s||r?!!this.isRowPresent(n):!1}isRowPresent(e){return this.rowModel.isRowPresent(e)?this.beans.pagination?.isRowInPage(e.rowIndex)??!0:!1}createRowCon(e,t,i){let n=this.cachedRowCtrls?.getRow(e)??null;if(n)return n;let o=i&&!this.printLayout&&!!this.beans.animationFrameSvc?.active;return new Rp(e,this.beans,t,o,this.printLayout)}getRenderedNodes(){let e=Object.values(this.rowCtrlsByRowIndex).map(n=>n.rowNode),t=this.getStickyTopRowCtrls().map(n=>n.rowNode),i=this.getStickyBottomRowCtrls().map(n=>n.rowNode);return[...t,...e,...i]}getRowByPosition(e){let t,{rowIndex:i}=e;switch(e.rowPinned){case"top":t=this.topRowCtrls[i];break;case"bottom":t=this.bottomRowCtrls[i];break;default:t=this.rowCtrlsByRowIndex[i],t||(t=this.getStickyTopRowCtrls().find(n=>n.rowNode.rowIndex===i)||null,t||(t=this.getStickyBottomRowCtrls().find(n=>n.rowNode.rowIndex===i)||null));break}return t}isRangeInRenderedViewport(e,t){if(e==null||t==null)return!1;let n=e>this.lastRenderedRow;return!(t<this.firstRenderedRow)&&!n}},i$=class{constructor(e){this.entriesMap={},this.entriesList=[],this.maxCount=e}addRow(e){if(this.entriesMap[e.rowNode.id]=e,this.entriesList.push(e),e.setCached(!0),this.entriesList.length>this.maxCount){let t=this.entriesList[0];t.destroyFirstPass(),t.destroySecondPass(),this.removeFromCache(t)}}getRow(e){if(e?.id==null)return null;let t=this.entriesMap[e.id];return t?(this.removeFromCache(t),t.setCached(!1),t.rowNode!=e?null:t):null}has(e){return this.entriesMap[e.id]!=null}removeRow(e){let t=e.id,i=this.entriesMap[t];delete this.entriesMap[t],Yi(this.entriesList,i)}removeFromCache(e){let t=e.rowNode.id;delete this.entriesMap[t],Yi(this.entriesList,e)}getEntries(){return this.entriesList}};function KC(e){if(!e)return;let t={top:{},bottom:{},normal:{}};for(let i of e){let n=i.id;switch(i.rowPinned){case"top":t.top[n]=i;break;case"bottom":t.bottom[n]=i;break;default:t.normal[n]=i;break}}return t}function YC(e,t){let i=e.id;switch(e.rowPinned){case"top":return t.top[i]!=null;case"bottom":return t.bottom[i]!=null;default:return t.normal[i]!=null}}var n$=class extends D{constructor(){super(...arguments),this.beanName="rowNodeSorter"}postConstruct(){let{gos:e}=this;this.isAccentedSort=e.get("accentedSort"),this.primaryColumnsSortGroups=bn(e),this.addManagedPropertyListener("accentedSort",t=>this.isAccentedSort=t.currentValue),this.addManagedPropertyListener("autoGroupColumnDef",()=>this.primaryColumnsSortGroups=bn(e))}doFullSort(e,t){let i=e.map((n,o)=>({currentPos:o,rowNode:n}));return i.sort(this.compareRowNodes.bind(this,t)),i.map(n=>n.rowNode)}compareRowNodes(e,t,i){let n=t.rowNode,o=i.rowNode;for(let s=0,r=e.length;s<r;s++){let a=e[s],l=a.sort==="desc",d=this.getValue(n,a.column),c=this.getValue(o,a.column),u,h=this.getComparator(a,n);if(h?u=h(d,c,n,o,l):u=t_(d,c,this.isAccentedSort),!isNaN(u)&&u!==0)return a.sort==="asc"?u:u*-1}return t.currentPos-i.currentPos}getComparator(e,t){let i=e.column,n=i.getColDef().comparator;if(n!=null)return n;if(!i.getColDef().showRowGroup)return;let o=!t.group&&i.getColDef().field;if(!o)return;let s=this.beans.colModel.getColDefCol(o);if(s)return s.getColDef().comparator}getValue(e,t){let{valueSvc:i,colModel:n,showRowGroupCols:o,gos:s}=this.beans;if(!this.primaryColumnsSortGroups)return i.getValue(t,e,!1);if(e.rowGroupColumn===t){if(b6(s,n.isPivotActive())){let d=e.data?e:c4(e.childrenAfterGroup);return d&&i.getValue(t,d,!1)}let l=o?.getShowRowGroupCol(t.getId());return l?e.groupData?.[l.getId()]:void 0}if(!(e.group&&t.getColDef().showRowGroup))return i.getValue(t,e,!1)}};function o$(e){e.sortSvc?.onSortChanged("api")}var gP={moduleName:"Sort",version:z,beans:[SU,n$],apiFunctions:{onSortChanged:o$},userComponents:{agSortIndicator:_v},icons:{sortAscending:"asc",sortDescending:"desc",sortUnSort:"none"}},s$=class extends D{constructor(){super(...arguments),this.beanName="syncSvc",this.waitingForColumns=!1}postConstruct(){this.addManagedPropertyListener("columnDefs",e=>this.setColumnDefs(e))}start(){this.beans.ctrlsSvc.whenReady(this,()=>{let e=this.gos.get("columnDefs");e?this.setColumnsAndData(e):this.waitingForColumns=!0,this.gridReady()})}setColumnsAndData(e){let{colModel:t,rowModel:i}=this.beans;t.setColumnDefs(e??[],"gridInitializing"),i.start()}gridReady(){let{eventSvc:e,gos:t}=this;e.dispatchEvent({type:"gridReady"}),Ko(t,`initialised successfully, enterprise = ${t.isModuleRegistered("EnterpriseCore")}`)}setColumnDefs(e){let t=this.gos.get("columnDefs");if(t){if(this.waitingForColumns){this.waitingForColumns=!1,this.setColumnsAndData(t);return}this.beans.colModel.setColumnDefs(t,ca(e.source))}}};function r$(e){e.valueCache?.expire()}function a$(e,t){let{colKey:i,rowNode:n,useFormatter:o}=t,s=e.colModel.getColDefCol(i)??e.colModel.getCol(i);if(Qe(s))return null;let r=e.valueSvc.getValueForDisplay(s,n,o);return o?r.valueFormatted??Sa(r.value):r.value}var l$="paste",d$=class extends D{constructor(){super(...arguments),this.beanName="changeDetectionSvc",this.clientSideRowModel=null}postConstruct(){let{gos:e,rowModel:t}=this.beans;gt(e,t)&&(this.clientSideRowModel=t),this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this)})}onCellValueChanged(e){let{gos:t,rowRenderer:i}=this.beans;if(e.source===l$||t.get("suppressChangeDetection"))return;let n=e.node,o=[n],s=this.clientSideRowModel,r=s?.rootNode;if(r&&!n.isRowPinned()){let a=t.get("aggregateOnlyChangedColumns"),l=new pd(a,r);l.addParentNode(n.parent,[e.column]),s.doAggregate(l),l.forEachChangedNodeDepthFirst(d=>{o.push(d),d.sibling&&o.push(d.sibling)})}i.refreshCells({rowNodes:o})}},c$=class extends D{constructor(){super(...arguments),this.beanName="expressionSvc",this.cache={}}evaluate(e,t){if(typeof e=="string")return this.evaluateExpression(e,t);Ge(15,{expression:e})}evaluateExpression(e,t){try{return this.createExpressionFunction(e)(t.value,t.context,t.oldValue,t.newValue,t.value,t.node,t.data,t.colDef,t.rowIndex,t.api,t.getValue,t.column,t.columnGroup)}catch(i){return Ge(16,{expression:e,params:t,e:i}),null}}createExpressionFunction(e){let t=this.cache;if(t[e])return t[e];let i=this.createFunctionBody(e),n=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, getValue, column, columnGroup",i);return t[e]=n,n}createFunctionBody(e){return e.includes("return")?e:"return "+e+";"}},u$=class extends D{constructor(){super(...arguments),this.beanName="valueCache",this.cacheVersion=0}postConstruct(){let e=this.gos;this.active=e.get("valueCache"),this.neverExpires=e.get("valueCacheNeverExpires")}onDataChanged(){this.neverExpires||this.expire()}expire(){this.cacheVersion++}setValue(e,t,i){if(this.active){let n=this.cacheVersion;e.__cacheVersion!==n&&(e.__cacheVersion=n,e.__cacheData={}),e.__cacheData[t]=i}}getValue(e,t){if(!(!this.active||e.__cacheVersion!==this.cacheVersion))return e.__cacheData[t]}},h$={moduleName:"ValueCache",version:z,beans:[u$],apiFunctions:{expireValueCache:r$}},p$={moduleName:"Expression",version:z,beans:[c$]},g$={moduleName:"ChangeDetection",version:z,beans:[d$]},f$={moduleName:"CellApi",version:z,apiFunctions:{getCellValue:a$}},m$=class extends D{constructor(){super(...arguments),this.beanName="valueSvc",this.hasEditSvc=!1,this.initialised=!1,this.isSsrm=!1}wireBeans(e){this.expressionSvc=e.expressionSvc,this.colModel=e.colModel,this.valueCache=e.valueCache,this.dataTypeSvc=e.dataTypeSvc,this.editSvc=e.editSvc,this.hasEditSvc=!!e.editSvc}postConstruct(){this.initialised||this.init()}init(){this.executeValueGetter=this.valueCache?this.executeValueGetterWithValueCache.bind(this):this.executeValueGetterWithoutValueCache.bind(this),this.isSsrm=xa(this.gos),this.cellExpressions=this.gos.get("enableCellExpressions"),this.isTreeData=this.gos.get("treeData"),this.initialised=!0;let e=t=>this.callColumnCellValueChangedHandler(t);this.eventSvc.addListener("cellValueChanged",e,!0),this.addDestroyFunc(()=>this.eventSvc.removeListener("cellValueChanged",e,!0)),this.addManagedPropertyListener("treeData",t=>this.isTreeData=t.currentValue)}getValueForDisplay(e,t,i=!1,n=!1,o="ui"){let{showRowGroupColValueSvc:s}=this.beans,r=!e&&t.group,a=e?.colDef.showRowGroup,l=!this.isTreeData||t.footer;if(s&&l&&(r||a)){let f=s.getGroupValue(t,e);if(f==null)return{value:null,valueFormatted:null};if(!i)return{value:f.value,valueFormatted:null};let m=s.formatAndPrefixGroupColValue(f,e,n);return{value:f.value,valueFormatted:m}}if(!e)return{value:t.key,valueFormatted:null};let d=t.leafGroup&&this.colModel.isPivotMode(),c=t.group&&t.expanded&&!t.footer&&!d,u=this.gos.get("groupSuppressBlankHeader")||!t.sibling,h=c&&!u,p=this.getValue(e,t,h,o),g=i&&!(n&&e.colDef.useValueFormatterForExport===!1);return{value:p,valueFormatted:g?this.formatValue(e,t,p):null}}getValue(e,t,i=!1,n="ui"){if(this.initialised||this.init(),!t)return;let o=e.getColDef(),s=o.field,r=e.getColId(),a=t.data;if(this.hasEditSvc&&n==="ui"){let f=this.editSvc;if(f.isEditing()){let m=f.getCellDataValue({rowNode:t,column:e},!0);if(m!==void 0)return m}}let l,d=o.showRowGroup;if(typeof d=="string"&&(this.beans.rowGroupColsSvc?.getColumnIndex(d)??-1)>t.level)return null;let c=typeof d!="string"||!t.group,u=t.groupData&&r in t.groupData,h=!i&&t.aggData&&t.aggData[r]!==void 0,p=this.isSsrm&&i&&!!o.aggFunc,g=this.isSsrm&&t.footer&&t.field&&(o.showRowGroup===!0||o.showRowGroup===t.field);if(this.isTreeData&&h)l=t.aggData[r];else if(this.isTreeData&&o.valueGetter)l=this.executeValueGetter(o.valueGetter,a,e,t);else if(this.isTreeData&&s&&a)l=ed(a,s,e.isFieldContainsDots());else if(u)l=t.groupData[r];else if(h)l=t.aggData[r];else if(o.valueGetter&&!p){if(!c)return l;l=this.executeValueGetter(o.valueGetter,a,e,t)}else if(g)l=ed(a,t.field,e.isFieldContainsDots());else if(s&&a&&!p){if(!c)return l;l=ed(a,s,e.isFieldContainsDots())}if(this.cellExpressions&&typeof l=="string"&&l.indexOf("=")===0){let f=l.substring(1);l=this.executeValueGetter(f,a,e,t)}return l}parseValue(e,t,i,n){let o=e.getColDef(),s=o.valueParser;if(q(s)){let r=te(this.gos,{node:t,data:t?.data,oldValue:n,newValue:i,colDef:o,column:e});return typeof s=="function"?s(r):this.expressionSvc?.evaluate(s,r)}return i}getDeleteValue(e,t){return q(e.getColDef().valueParser)?this.parseValue(e,t,"",this.getValueForDisplay(e,t).value)??null:null}formatValue(e,t,i,n,o=!0){let{expressionSvc:s}=this.beans,r=null,a,l=e.getColDef();if(n?a=n:o&&(a=l.valueFormatter),a){let d=t?t.data:null,c=te(this.gos,{value:i,node:t,data:d,colDef:l,column:e});typeof a=="function"?r=a(c):r=s?s.evaluate(a,c):null}else if(l.refData)return l.refData[i]||"";return r==null&&Array.isArray(i)&&(r=i.join(", ")),r}setValue(e,t,i,n){let o=this.colModel.getColDefCol(t);if(!e||!o)return!1;Qe(e.data)&&(e.data={});let{field:s,valueSetter:r}=o.getColDef();if(Qe(s)&&Qe(r))return I(17),!1;if(this.dataTypeSvc&&!this.dataTypeSvc.checkType(o,i))return I(135),!1;let a=te(this.gos,{node:e,data:e.data,oldValue:this.getValue(o,e,void 0,n),newValue:i,colDef:o.getColDef(),column:o});a.newValue=i;let l;if(q(r)?typeof r=="function"?l=r(a):l=this.expressionSvc?.evaluate(r,a):l=this.setValueUsingField(e.data,s,i,o.isFieldContainsDots()),l===void 0&&(l=!0),!l)return!1;e.resetQuickFilterAggregateText(),this.valueCache?.onDataChanged();let d=this.getValue(o,e);return this.dispatchCellValueChangedEvent(e,a,d,n),e.pinnedSibling&&this.dispatchCellValueChangedEvent(e.pinnedSibling,a,d,n),!0}dispatchCellValueChangedEvent(e,t,i,n){this.eventSvc.dispatchEvent({type:"cellValueChanged",event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:t.column,colDef:t.colDef,data:e.data,node:e,oldValue:t.oldValue,newValue:i,value:i,source:n})}callColumnCellValueChangedHandler(e){let t=e.colDef.onCellValueChanged;typeof t=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>{t({node:e.node,data:e.data,oldValue:e.oldValue,newValue:e.newValue,colDef:e.colDef,column:e.column,api:e.api,context:e.context})})}setValueUsingField(e,t,i,n){if(!t)return!1;let o=!1;if(!n)o=e[t]===i,o||(e[t]=i);else{let s=t.split("."),r=e;for(;s.length>0&&r;){let a=s.shift();s.length===0?(o=r[a]===i,o||(r[a]=i)):r=r[a]}}return!o}executeValueGetterWithValueCache(e,t,i,n){let o=i.getColId(),s=this.valueCache.getValue(n,o);if(s!==void 0)return s;let r=this.executeValueGetterWithoutValueCache(e,t,i,n);return this.valueCache.setValue(n,o,r),r}executeValueGetterWithoutValueCache(e,t,i,n){let o=te(this.gos,{data:t,node:n,column:i,colDef:i.getColDef(),getValue:this.getValueCallback.bind(this,n)}),s;return typeof e=="function"?s=e(o):s=this.expressionSvc?.evaluate(e,o),s}getValueCallback(e,t){let i=this.colModel.getColDefCol(t);return i?this.getValue(i,e):null}getKeyForNode(e,t){let i=this.getValue(e,t),n=e.getColDef().keyCreator,o=i;if(n){let s=te(this.gos,{value:i,colDef:e.getColDef(),column:e,node:t,data:t.data});o=n(s)}return typeof o=="string"||o==null||(o=String(o),o==="[object Object]"&&I(121)),o}},C$={moduleName:"CommunityCore",version:z,beans:[vU,uV,EW,$O,Zq,Oz,hU,VU,zO,_q,Lq,t$,m$,mU,uU,CU,PW,s$,wW,bW,QU],icons:{selectOpen:"small-down",smallDown:"small-down",colorPicker:"color-picker",smallUp:"small-up",checkboxChecked:"small-up",checkboxIndeterminate:"checkbox-indeterminate",checkboxUnchecked:"checkbox-unchecked",radioButtonOn:"radio-button-on",radioButtonOff:"radio-button-off",smallLeft:"small-left",smallRight:"small-right"},apiFunctions:{getGridId:hV,destroy:pV,isDestroyed:gV,getGridOption:fV,setGridOption:mV,updateGridOptions:_4,isModuleRegistered:CV},dependsOn:[mW,gz,yz,gP,KU,Bz,YU,Qq,g$,JU,Iq,Hq,Vq,eq,xW,CW,p$,zz,Uq]},fP={AdvancedFilter:1,AiToolkit:1,AllEnterprise:1,BatchEdit:1,CellSelection:1,Clipboard:1,ColumnMenu:1,ColumnsToolPanel:1,ContextMenu:1,ExcelExport:1,FiltersToolPanel:1,Find:1,GridCharts:1,IntegratedCharts:1,GroupFilter:1,MasterDetail:1,Menu:1,MultiFilter:1,NewFiltersToolPanel:1,Pivot:1,RangeSelection:1,RichSelect:1,RowNumbers:1,RowGrouping:1,RowGroupingPanel:1,ServerSideRowModelApi:1,ServerSideRowModel:1,SetFilter:1,SideBar:1,Sparklines:1,StatusBar:1,TreeData:1,ViewportRowModel:1},gC=["TextFilter","NumberFilter","DateFilter","SetFilter","MultiFilter","GroupFilter","CustomFilter"],v$={EditCore:["TextEditor","NumberEditor","DateEditor","CheckboxEditor","LargeTextEditor","SelectEditor","RichSelect","CustomEditor"],CheckboxCellRenderer:["AllCommunity"],ClientSideRowModelHierarchy:["RowGrouping","Pivot","TreeData"],ColumnFilter:gC,ColumnGroupHeaderComp:["AllCommunity"],ColumnGroup:["AllCommunity"],ColumnHeaderComp:["AllCommunity"],ColumnMove:["AllCommunity"],ColumnResize:["AllCommunity"],CommunityCore:["AllCommunity"],CsrmSsrmSharedApi:["ClientSideRowModelApi","ServerSideRowModelApi"],RowModelSharedApi:["ClientSideRowModelApi","ServerSideRowModelApi"],EnterpriseCore:["AllEnterprise"],FilterCore:[...gC,"QuickFilter","ExternalFilter","AdvancedFilter"],GroupCellRenderer:["RowGrouping","Pivot","TreeData","MasterDetail","ServerSideRowModel"],KeyboardNavigation:["AllCommunity"],LoadingCellRenderer:["ServerSideRowModel"],MenuCore:["ColumnMenu","ContextMenu"],MenuItem:["ColumnMenu","ContextMenu","MultiFilter","IntegratedCharts","ColumnsToolPanel"],Overlay:["AllCommunity"],PinnedColumn:["AllCommunity"],SharedAggregation:["RowGrouping","Pivot","TreeData","ServerSideRowModel"],SharedDragAndDrop:["AllCommunity"],SharedMasterDetail:["MasterDetail","ServerSideRowModel"],SharedMenu:[...gC,"ColumnMenu","ContextMenu"],SharedPivot:["Pivot","ServerSideRowModel"],SharedRowGrouping:["RowGrouping","ServerSideRowModel"],SharedRowSelection:["RowSelection","ServerSideRowModel"],SkeletonCellRenderer:["ServerSideRowModel"],Sort:["AllCommunity"],SsrmInfiniteSharedApi:["InfiniteRowModel","ServerSideRowModelApi"],SharedTreeData:["TreeData","ServerSideRowModel"]},w$={InfiniteRowModel:"infinite",ClientSideRowModelApi:"clientSide",ClientSideRowModel:"clientSide",ServerSideRowModelApi:"serverSide",ServerSideRowModel:"serverSide",ViewportRowModel:"viewport"};function b$(e,t){let i=[];for(let n of Array.isArray(e)?e:[e]){let o=v$[n];if(o)for(let s of o){let r=w$[s];(!r||r===t)&&i.push(s)}else i.push(n)}return i}var mP=()=>`No AG Grid modules are registered! It is recommended to start with all Community features via the AllCommunityModule:
                    
    import { ModuleRegistry, AllCommunityModule } from 'ag-grid-community';
    
    ModuleRegistry.registerModules([ AllCommunityModule ]);
    `,y$=e=>{let t=e.map(n=>`import { ${td(n)} } from '${fP[n]?"ag-grid-enterprise":"ag-grid-community"}';`);return e.some(n=>n==="IntegratedCharts"||n==="Sparklines")&&t.push("import { AgChartsEnterpriseModule } from 'ag-charts-enterprise';"),`import { ModuleRegistry } from 'ag-grid-community'; 
${t.join(` 
`)} 

ModuleRegistry.registerModules([ ${e.map(n=>td(n,!0)).join(", ")} ]); 

For more info see: ${aa}/modules/`};function td(e,t=!1){return t&&(e==="IntegratedCharts"||e==="Sparklines")?`${e}Module.with(AgChartsEnterpriseModule)`:`${e}Module`}function S$(e,t){let i=t.filter(s=>s==="IntegratedCharts"||s==="Sparklines"),n="";return!globalThis?.agCharts&&i.length>0?n=`Unable to use ${e} as either the ag-charts-community or ag-charts-enterprise script needs to be included alongside ag-grid-enterprise.
`:t.some(s=>fP[s])&&(n=n+`Unable to use ${e} as that requires the ag-grid-enterprise script to be included.
`),n}function CP({moduleName:e,rowModelType:t}){return`To use the ${e}Module you must set the gridOption "rowModelType='${t}'"`}var RR=({reasonOrId:e,moduleName:t,gridScoped:i,gridId:n,rowModelType:o,additionalText:s,isUmd:r})=>{let a=b$(t,o),l=typeof e=="string"?e:P$[e];if(r)return S$(l,a);let d=a.filter(h=>h==="IntegratedCharts"||h==="Sparklines"),c=d.length>0?`${d.map(h=>td(h)).join()} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.`:"";return`${`Unable to use ${l} as ${a.length>1?"one of "+a.map(h=>td(h)).join(", "):td(a[0])} is not registered${i?" for gridId: "+n:""}. ${c} Check if you have registered the module:
`}
${y$(a)}`+(s?` 

${s}`:"")},PR=e=>`${e} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.

import { AgChartsEnterpriseModule } from 'ag-charts-enterprise';
import { ModuleRegistry } from 'ag-grid-community';
import { ${e} } from 'ag-grid-enterprise';
    
ModuleRegistry.registerModules([${e}.with(AgChartsEnterpriseModule)]);
    `,x$=e=>`AG Grid: Unable to use the Clipboard API (navigator.clipboard.${e}()). The reason why it could not be used has been logged in the previous line. For this reason the grid has defaulted to using a workaround which doesn't perform as well. Either fix why Clipboard API is blocked, OR stop this message from appearing by setting grid property suppressClipboardApi=true (which will default the grid to using the workaround rather than the API.`,E$={1:()=>"`rowData` must be an array",2:({nodeId:e})=>`Duplicate node id '${e}' detected from getRowId callback, this could cause issues in your grid.`,3:()=>"Calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.",4:({id:e})=>`Could not find row id=${e}, data item was not found for this id`,5:({data:e})=>["Could not find data item as object was not found.",e," Consider using getRowId to help the Grid find matching row data"],6:()=>"'groupHideOpenParents' only works when specifying specific columns for 'colDef.showRowGroup'",7:()=>"Pivoting is not supported with aligned grids as it may produce different columns in each grid.",8:({key:e})=>`Unknown key for navigation ${e}`,9:({variable:e})=>`No value for ${e?.cssName}. This usually means that the grid has been initialised before styles have been loaded. The default value of ${e?.defaultValue} will be used and updated when styles load.`,10:({eventType:e})=>`As of v33, the '${e}' event is deprecated. Use the global 'modelUpdated' event to determine when row children have changed.`,11:()=>"No gridOptions provided to createGrid",12:({colKey:e})=>["column ",e," not found"],13:()=>"Could not find rowIndex, this means tasks are being executed on a rowNode that has been removed from the grid.",14:({groupPrefix:e})=>`Row IDs cannot start with ${e}, this is a reserved prefix for AG Grid's row grouping feature.`,15:({expression:e})=>["value should be either a string or a function",e],16:({expression:e,params:t,e:i})=>["Processing of the expression failed","Expression = ",e,"Params = ",t,"Exception = ",i],17:()=>"you need either field or valueSetter set on colDef for editing to work",18:()=>"alignedGrids contains an undefined option.",19:()=>"alignedGrids - No api found on the linked grid.",20:()=>`You may want to configure via a callback to avoid setup race conditions:
                     "alignedGrids: () => [linkedGrid]"`,21:()=>"pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.",22:({key:e})=>`${e} is an initial property and cannot be updated.`,23:()=>"The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead.",24:()=>"row height must be a number if not using standard row model",25:({id:e})=>["The getRowId callback must return a string. The ID ",e," is being cast to a string."],26:({fnName:e,preDestroyLink:t})=>`Grid API function ${e}() cannot be called as the grid has been destroyed.
 Either clear local references to the grid api, when it is destroyed, or check gridApi.isDestroyed() to avoid calling methods against a destroyed grid.
 To run logic when the grid is about to be destroyed use the gridPreDestroy event. See: ${t}`,27:({fnName:e,module:t})=>`API function '${e}' not registered to module '${t}'`,28:()=>"setRowCount cannot be used while using row grouping.",29:()=>"tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?",30:({toIndex:e})=>["tried to insert columns in invalid location, toIndex = ",e,"remember that you should not count the moving columns when calculating the new index"],31:()=>"infinite loop in resizeColumnSets",32:()=>"applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state.",33:()=>"stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON.",34:({key:e})=>`the column type '${e}' is a default column type and cannot be overridden.`,35:()=>"Column type definitions 'columnTypes' with a 'type' attribute are not supported because a column type cannot refer to another column type. Only column definitions 'columnDefs' can use the 'type' attribute to refer to a column type.",36:({t:e})=>"colDef.type '"+e+"' does not correspond to defined gridOptions.columnTypes",37:()=>"Changing the column pinning status is not allowed with domLayout='print'",38:({iconName:e})=>`provided icon '${e}' needs to be a string or a function`,39:()=>"Applying column order broke a group where columns should be married together. Applying new order has been discarded.",40:({e,method:t})=>`${e}
${x$(t)}`,41:()=>"Browser did not allow document.execCommand('copy'). Ensure 'api.copySelectedRowsToClipboard() is invoked via a user event, i.e. button click, otherwise the browser will prevent it for security reasons.",42:()=>"Browser does not support document.execCommand('copy') for clipboard operations",43:({iconName:e})=>`As of v33, icon '${e}' is deprecated. Use the icon CSS name instead.`,44:()=>'Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.',45:({parentCellDataType:e})=>`The data type definition ${e} does not exist.`,46:()=>'The "baseDataType" property of a data type definition must match that of its parent.',47:({cellDataType:e})=>`Missing data type definition - "${e}"`,48:({property:e})=>`Cell data type is "object" but no Value ${e} has been provided. Please either provide an object data type definition with a Value ${e}, or set "colDef.value${e}"`,49:({methodName:e})=>`Framework component is missing the method ${e}()`,50:({compName:e})=>`Could not find component ${e}, did you forget to configure this component?`,51:()=>"Export cancelled. Export is not allowed as per your configuration.",52:()=>"There is no `window` associated with the current `document`",53:()=>"unknown value type during csv conversion",54:()=>"Could not find document body, it is needed for drag and drop and context menu.",55:()=>"addRowDropZone - A container target needs to be provided",56:()=>"addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.",57:()=>"unable to show popup filter, filter instantiation failed",58:()=>"no values found for select cellEditor",59:()=>"cannot select pinned rows",60:()=>"cannot select node until it has finished loading",61:()=>"since version v32.2.0, rowNode.isFullWidthCell() has been deprecated. Instead check `rowNode.detail` followed by the user provided `isFullWidthRow` grid option.",62:({colId:e})=>`setFilterModel() - no column found for colId: ${e}`,63:({colId:e})=>`setFilterModel() - unable to fully apply model, filtering disabled for colId: ${e}`,64:({colId:e})=>`setFilterModel() - unable to fully apply model, unable to create filter for colId: ${e}`,65:()=>"filter missing setModel method, which is needed for setFilterModel",66:()=>"filter API missing getModel method, which is needed for getFilterModel",67:()=>"Filter is missing isFilterActive() method",68:()=>"Column Filter API methods have been disabled as Advanced Filters are enabled.",69:({guiFromFilter:e})=>`getGui method from filter returned ${e}; it should be a DOM element.`,70:({newFilter:e})=>`Grid option quickFilterText only supports string inputs, received: ${typeof e}`,71:()=>"debounceMs is ignored when apply button is present",72:({keys:e})=>["ignoring FilterOptionDef as it doesn't contain one of ",e],73:()=>"invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'",74:()=>"no filter options for filter",75:()=>"Unknown button type specified",76:({filterModelType:e})=>['Unexpected type of filter "',e,'", it looks like the filter was configured with incorrect Filter Options'],77:()=>"Filter model is missing 'conditions'",78:()=>'Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.',79:()=>'"filterParams.maxNumConditions" must be greater than or equal to zero.',80:()=>'"filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.',81:()=>'"filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".',82:({param:e})=>`DateFilter ${e} is not a number`,83:()=>"DateFilter minValidYear should be <= maxValidYear",84:()=>"DateFilter minValidDate should be <= maxValidDate",85:()=>"DateFilter should not have both minValidDate and minValidYear parameters set at the same time! minValidYear will be ignored.",86:()=>"DateFilter should not have both maxValidDate and maxValidYear parameters set at the same time! maxValidYear will be ignored.",87:()=>"DateFilter parameter minValidDate should always be lower than or equal to parameter maxValidDate.",88:({index:e})=>`Invalid row index for ensureIndexVisible: ${e}`,89:()=>"A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)",90:()=>"datasource is missing getRows method",91:()=>"Filter is missing method doesFilterPass",92:()=>"AnimationFrameService called but animation frames are off",93:()=>"cannot add multiple ranges when `cellSelection.suppressMultiRanges = true`",94:({paginationPageSizeOption:e,pageSizeSet:t,pageSizesSet:i,pageSizeOptions:n})=>`'paginationPageSize=${e}'${t?"":" (default value)"}, but ${e} is not included in${i?"":" the default"} paginationPageSizeSelector=[${n?.join(", ")}].`,95:({paginationPageSizeOption:e,paginationPageSizeSelector:t})=>`Either set '${t}' to an array that includes ${e} or to 'false' to disable the page size selector.`,96:({id:e,data:t})=>["Duplicate ID",e,"found for pinned row with data",t,"When `getRowId` is defined, it must return unique IDs for all pinned rows. Use the `rowPinned` parameter."],97:({colId:e})=>`cellEditor for column ${e} is missing getGui() method`,98:()=>"popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.",99:()=>"Since v32, `api.hideOverlay()` does not hide the loading overlay when `loading=true`. Set `loading=false` instead.",101:({propertyName:e,componentName:t,agGridDefaults:i,jsComps:n})=>{let o=[],s=[...Object.keys(i??[]).filter(a=>!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(a)),...Object.keys(n??[]).filter(a=>!!n[a])],r=AC({inputValue:t,allSuggestions:s,hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;return o.push(`Could not find '${t}' component. It was configured as "${e}: '${t}'" but it wasn't found in the list of registered components.
`),r.length>0&&o.push(`         Did you mean: [${r.slice(0,3)}]?
`),o.push("If using a custom component check it has been registered correctly."),o},102:()=>"selectAll: 'filtered' only works when gridOptions.rowModelType='clientSide'",103:()=>"Invalid selection state. When using client-side row model, the state must conform to `string[]`.",104:({value:e,param:t})=>`Numeric value ${e} passed to ${t} param will be interpreted as ${e} seconds. If this is intentional use "${e}s" to silence this warning.`,105:({e})=>["chart rendering failed",e],106:()=>`Theming API and Legacy Themes are both used in the same page. A Theming API theme has been provided to the 'theme' grid option, but the file (ag-grid.css) is also included and will cause styling issues. Remove ag-grid.css from the page. See the migration guide: ${aa}/theming-migration/`,107:({key:e,value:t})=>`Invalid value for theme param ${e} - ${t}`,108:({e})=>["chart update failed",e],109:({inputValue:e,allSuggestions:t})=>{let i=AC({inputValue:e,allSuggestions:t,hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;return[`Could not find '${e}' aggregate function. It was configured as "aggFunc: '${e}'" but it wasn't found in the list of registered aggregations.`,i.length>0?`         Did you mean: [${i.slice(0,3)}]?`:"","If using a custom aggregation function check it has been registered correctly."].join(`
`)},110:()=>"groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup",111:()=>"Invalid selection state. When `groupSelects` is enabled, the state must conform to `IServerSideGroupSelectionState`.",113:()=>"Set Filter cannot initialise because you are using a row model that does not contain all rows in the browser. Either use a different filter type, or configure Set Filter such that you provide it with values",114:({component:e})=>`Could not find component with name of ${e}. Is it in Vue.components?`,116:()=>"Invalid selection state. The state must conform to `IServerSideSelectionState`.",117:()=>"selectAll must be of boolean type.",118:()=>"Infinite scrolling must be enabled in order to set the row count.",119:()=>"Unable to instantiate filter",120:()=>"MultiFloatingFilterComp expects MultiFilter as its parent",121:()=>"a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (see AG Grid docs) or b) to toString() on the object to return a key",122:()=>"could not find the document, document is empty",123:()=>"Advanced Filter is only supported with the Client-Side Row Model or Server-Side Row Model.",124:()=>"No active charts to update.",125:({chartId:e})=>`Unable to update chart. No active chart found with ID: ${e}.`,126:()=>"unable to restore chart as no chart model is provided",127:({allRange:e})=>`unable to create chart as ${e?"there are no columns in the grid":"no range is selected"}.`,128:({feature:e})=>`${e} is only available if using 'multiRow' selection mode.`,129:({feature:e,rowModel:t})=>`${e} is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ${t}.`,130:()=>'cannot multi select unless selection mode is "multiRow"',132:()=>"Row selection features are not available unless `rowSelection` is enabled.",133:({iconName:e})=>`icon '${e}' function should return back a string or a dom object`,134:({iconName:e})=>`Did not find icon '${e}'`,135:()=>"Data type of the new value does not match the cell data type of the column",136:()=>"Unable to update chart as the 'type' is missing. It must be either 'rangeChartUpdate', 'pivotChartUpdate', or 'crossFilterChartUpdate'.",137:({type:e,currentChartType:t})=>`Unable to update chart as a '${e}' update type is not permitted on a ${t}.`,138:({chartType:e})=>`invalid chart type supplied: ${e}`,139:({customThemeName:e})=>`a custom chart theme with the name ${e} has been supplied but not added to the 'chartThemes' list`,140:({name:e})=>`no stock theme exists with the name '${e}' and no custom chart theme with that name was supplied to 'customChartThemes'`,141:()=>"cross filtering with row grouping is not supported.",142:()=>"cross filtering is only supported in the client side row model.",143:({panel:e})=>`'${e}' is not a valid Chart Tool Panel name`,144:({type:e})=>`Invalid charts data panel group name supplied: '${e}'`,145:({group:e})=>`As of v32, only one charts customize panel group can be expanded at a time. '${e}' will not be expanded.`,146:({comp:e})=>`Unable to instantiate component '${e}' as its module hasn't been loaded. Add 'ValidationModule' to see which module is required.`,147:({group:e})=>`Invalid charts customize panel group name supplied: '${e}'`,148:({group:e})=>`invalid chartGroupsDef config '${e}'`,149:({group:e,chartType:t})=>`invalid chartGroupsDef config '${e}.${t}'`,150:()=>"'seriesChartTypes' are required when the 'customCombo' chart type is specified.",151:({chartType:e})=>`invalid chartType '${e}' supplied in 'seriesChartTypes', converting to 'line' instead.`,152:({colId:e})=>`no 'seriesChartType' found for colId = '${e}', defaulting to 'line'.`,153:({chartDataType:e})=>`unexpected chartDataType value '${e}' supplied, instead use 'category', 'series' or 'excluded'`,154:({colId:e})=>`cross filtering requires a 'agSetColumnFilter' or 'agMultiColumnFilter' to be defined on the column with id: ${e}`,155:({option:e})=>`'${e}' is not a valid Chart Toolbar Option`,156:({panel:e})=>`Invalid panel in chartToolPanelsDef.panels: '${e}'`,157:({unrecognisedGroupIds:e})=>["unable to find group(s) for supplied groupIds:",e],158:()=>"can not expand a column item that does not represent a column group header",159:()=>"Invalid params supplied to createExcelFileForExcel() - `ExcelExportParams.data` is empty.",160:()=>"Export cancelled. Export is not allowed as per your configuration.",161:()=>"The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'",162:({id:e,dataType:t})=>`Unrecognized data type for excel export [${e}.dataType=${t}]`,163:({featureName:e})=>`Excel table export does not work with ${e}. The exported Excel file will not contain any Excel tables.
 Please turn off ${e} to enable Excel table exports.`,164:()=>"Unable to add data table to Excel sheet: A table already exists.",165:()=>"Unable to add data table to Excel sheet: Missing required parameters.",166:({unrecognisedGroupIds:e})=>["unable to find groups for these supplied groupIds:",e],167:({unrecognisedColIds:e})=>["unable to find columns for these supplied colIds:",e],168:()=>"detailCellRendererParams.template should be function or string",169:()=>'Reference to eDetailGrid was missing from the details template. Please add data-ref="eDetailGrid" to the template.',170:({providedStrategy:e})=>`invalid cellRendererParams.refreshStrategy = ${e} supplied, defaulting to refreshStrategy = 'rows'.`,171:()=>"could not find detail grid options for master detail, please set gridOptions.detailCellRendererParams.detailGridOptions",172:()=>"could not find getDetailRowData for master / detail, please set gridOptions.detailCellRendererParams.getDetailRowData",173:({group:e})=>`invalid chartGroupsDef config '${e}'`,174:({group:e,chartType:t})=>`invalid chartGroupsDef config '${e}.${t}'`,175:({menuTabName:e,itemsToConsider:t})=>[`Trying to render an invalid menu item '${e}'. Check that your 'menuTabs' contains one of `,t],176:({key:e})=>`unknown menu item type ${e}`,177:()=>"valid values for cellSelection.handle.direction are 'x', 'y' and 'xy'. Default to 'xy'.",178:({colId:e})=>`column ${e} is not visible`,179:()=>"totalValueGetter should be either a function or a string (expression)",180:()=>"agRichSelectCellEditor requires cellEditorParams.values to be set",181:()=>"agRichSelectCellEditor cannot have `multiSelect` and `allowTyping` set to `true`. AllowTyping has been turned off.",182:()=>'you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data',183:()=>"Group Column Filter only works on group columns. Please use a different filter.",184:({parentGroupData:e,childNodeData:t})=>["duplicate group keys for row data, keys should be unique",[e,t]],185:({data:e})=>["getDataPath() should not return an empty path",[e]],186:({rowId:e,rowData:t,duplicateRowsData:i})=>["duplicate group keys for row data, keys should be unique",e,t,...i??[]],187:({rowId:e,firstData:t,secondData:i})=>[`Duplicate node id ${e}. Row IDs are provided via the getRowId() callback. Please modify the getRowId() callback code to provide unique row id values.`,"first instance",t,"second instance",i],188:e=>`getRowId callback must be provided for Server Side Row Model ${e?.feature||"selection"} to work correctly.`,189:({startRow:e})=>`invalid value ${e} for startRow, the value should be >= 0`,190:({rowGroupId:e,data:t})=>["null and undefined values are not allowed for server side row model keys",e?`column = ${e}`:"","data is ",t],194:({method:e})=>`calling gridApi.${e}() is only possible when using rowModelType=\`clientSide\`.`,195:({justCurrentPage:e})=>`selecting just ${e?"current page":"filtered"} only works when gridOptions.rowModelType='clientSide'`,196:({key:e})=>`Provided ids must be of string type. Invalid id provided: ${e}`,197:()=>"`toggledNodes` must be an array of string ids.",199:()=>"getSelectedNodes and getSelectedRows functions cannot be used with select all functionality with the server-side row model. Use `api.getServerSideSelectionState()` instead.",200:RR,201:({rowModelType:e})=>`Could not find row model for rowModelType = ${e}`,202:()=>"`getSelectedNodes` and `getSelectedRows` functions cannot be used with `groupSelectsChildren` and the server-side row model. Use `api.getServerSideSelectionState()` instead.",203:()=>"Server Side Row Model does not support Dynamic Row Height and Cache Purging. Either a) remove getRowHeight() callback or b) remove maxBlocksInCache property. Purging has been disabled.",204:()=>"Server Side Row Model does not support Auto Row Height and Cache Purging. Either a) remove colDef.autoHeight or b) remove maxBlocksInCache property. Purging has been disabled.",205:({duplicateIdText:e})=>`Unable to display rows as duplicate row ids (${e}) were returned by the getRowId callback. Please modify the getRowId callback to provide unique ids.`,206:()=>"getRowId callback must be implemented for transactions to work. Transaction was ignored.",207:()=>'The Set Filter Parameter "defaultToNothingSelected" value was ignored because it does not work when "excelMode" is used.',208:()=>"Set Filter Value Formatter must return string values. Please ensure the Set Filter Value Formatter returns string values for complex objects.",209:()=>`Set Filter Key Creator is returning null for provided values and provided values are primitives. Please provide complex objects. See ${aa}/filter-set-filter-list/#filter-value-types`,210:()=>"Set Filter has a Key Creator, but provided values are primitives. Did you mean to provide complex objects?",211:()=>"property treeList=true for Set Filter params, but you did not provide a treeListPathGetter or values of type Date.",212:()=>"please review all your toolPanel components, it seems like at least one of them doesn't have an id",213:()=>"Advanced Filter does not work with Filters Tool Panel. Filters Tool Panel has been disabled.",214:({key:e})=>`unable to lookup Tool Panel as invalid key supplied: ${e}`,215:({key:e,defaultByKey:t})=>`the key ${e} is not a valid key for specifying a tool panel, valid keys are: ${Object.keys(t??{}).join(",")}`,216:({name:e})=>`Missing component for '${e}'`,217:({invalidColIds:e})=>["unable to find grid columns for the supplied colDef(s):",e],218:({property:e,defaultOffset:t})=>`${e} must be a number, the value you provided is not a valid number. Using the default of ${t}px.`,219:({property:e})=>`Property ${e} does not exist on the target object.`,220:({lineDash:e})=>`'${e}' is not a valid 'lineDash' option.`,221:()=>"agAggregationComponent should only be used with the client and server side row model.",222:()=>"agFilteredRowCountComponent should only be used with the client side row model.",223:()=>"agSelectedRowCountComponent should only be used with the client and server side row model.",224:()=>"agTotalAndFilteredRowCountComponent should only be used with the client side row model.",225:()=>"agTotalRowCountComponent should only be used with the client side row model.",226:()=>"viewport is missing init method.",227:()=>"menu item icon must be DOM node or string",228:({menuItemOrString:e})=>`unrecognised menu item ${e}`,229:({index:e})=>["invalid row index for ensureIndexVisible: ",e],230:()=>"detailCellRendererParams.template is not supported by AG Grid React. To change the template, provide a Custom Detail Cell Renderer. See https://www.ag-grid.com/react-data-grid/master-detail-custom-detail/",231:()=>"As of v32, using custom components with `reactiveCustomComponents = false` is deprecated.",232:()=>"Using both rowData and v-model. rowData will be ignored.",233:({methodName:e})=>`Framework component is missing the method ${e}()`,234:()=>'Group Column Filter does not work with the colDef property "field". This property will be ignored.',235:()=>'Group Column Filter does not work with the colDef property "filterValueGetter". This property will be ignored.',236:()=>'Group Column Filter does not work with the colDef property "filterParams". This property will be ignored.',237:()=>"Group Column Filter does not work with Tree Data enabled. Please disable Tree Data, or use a different filter.",238:()=>"setRowCount can only accept a positive row count.",239:()=>'Theming API and CSS File Themes are both used in the same page. In v33 we released the Theming API as the new default method of styling the grid. See the migration docs https://www.ag-grid.com/react-data-grid/theming-migration/. Because no value was provided to the `theme` grid option it defaulted to themeQuartz. But the file (ag-grid.css) is also included and will cause styling issues. Either pass the string "legacy" to the theme grid option to use v32 style themes, or remove ag-grid.css from the page to use Theming API.',240:({theme:e})=>`theme grid option must be a Theming API theme object or the string "legacy", received: ${e}`,243:()=>"Failed to deserialize state - each provided state object must be an object.",244:()=>"Failed to deserialize state - `selectAllChildren` must be a boolean value or undefined.",245:()=>"Failed to deserialize state - `toggledNodes` must be an array.",246:()=>"Failed to deserialize state - Every `toggledNode` requires an associated string id.",247:()=>`Row selection state could not be parsed due to invalid data. Ensure all child state has toggledNodes or does not conform with the parent rule. 
Please rebuild the selection state and reapply it.`,248:()=>"SetFloatingFilter expects SetFilter as its parent",249:()=>"Must supply a Value Formatter in Set Filter params when using a Key Creator",250:()=>"Must supply a Key Creator in Set Filter params when `treeList = true` on a group column, and Tree Data or Row Grouping is enabled.",251:({chartType:e})=>`AG Grid: Unable to create chart as an invalid chartType = '${e}' was supplied.`,252:()=>`cannot get grid to draw rows when it is in the middle of drawing rows. 
Your code probably called a grid API method while the grid was in the render stage. 
To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). 
To see what part of your code that caused the refresh check this stacktrace.`,253:({version:e})=>["Illegal version string: ",e],254:()=>"Cannot create chart: no chart themes available.",255:({point:e})=>`Lone surrogate U+${e?.toString(16).toUpperCase()} is not a scalar value`,256:()=>"Unable to initialise. See validation error, or load ValidationModule if missing.",257:()=>PR("IntegratedChartsModule"),258:()=>PR("SparklinesModule"),259:({part:e})=>`the argument to theme.withPart must be a Theming API part object, received: ${e}`,260:({propName:e,compName:t,gridScoped:i,gridId:n,rowModelType:o})=>RR({reasonOrId:`AG Grid '${e}' component: ${t}`,moduleName:pa[t],gridId:n,gridScoped:i,rowModelType:o}),261:()=>"As of v33, `column.isHovered()` is deprecated. Use `api.isColumnHovered(column)` instead.",262:()=>'As of v33, icon key "smallDown" is deprecated. Use "advancedFilterBuilderSelect" for Advanced Filter Builder dropdown, "selectOpen" for Select cell editor and dropdowns (e.g. Integrated Charts menu), "richSelectOpen" for Rich Select cell editor.',263:()=>'As of v33, icon key "smallLeft" is deprecated. Use "panelDelimiterRtl" for Row Group Panel / Pivot Panel, "subMenuOpenRtl" for sub-menus.',264:()=>'As of v33, icon key "smallRight" is deprecated. Use "panelDelimiter" for Row Group Panel / Pivot Panel, "subMenuOpen" for sub-menus.',265:({colId:e})=>`Unable to infer chart data type for column '${e}' if first data entry is null. Please specify "chartDataType", or a "cellDataType" in the column definition. For more information, see ${aa}/integrated-charts-range-chart#coldefchartdatatype .`,266:()=>'As of v33.1, using "keyCreator" with the Rich Select Editor has been deprecated. It now requires the "formatValue" callback to convert complex data to strings.',267:()=>"Detail grids can not use a different theme to the master grid, the `theme` detail grid option will be ignored.",268:()=>"Transactions aren't supported with tree data when using treeDataChildrenField",269:()=>"When `masterSelects: 'detail'`, detail grids must be configured with multi-row selection",270:({id:e,parentId:t})=>`Cycle detected for row with id='${e}' and parent id='${t}'. Resetting the parent for row with id='${e}' and showing it as a root-level node.`,271:({id:e,parentId:t})=>`Parent row not found for row with id='${e}' and parent id='${t}'. Showing row with id='${e}' as a root-level node.`,272:()=>mP(),273:({providedId:e,usedId:t})=>`Provided column id '${e}' was already in use, ensure all column and group ids are unique. Using '${t}' instead.`,274:({prop:e})=>{let t=`Since v33, ${e} has been deprecated.`;switch(e){case"maxComponentCreationTimeMs":t+=" This property is no longer required and so will be removed in a future version.";break;case"setGridApi":t+=" This method is not called by AG Grid. To access the GridApi see: https://ag-grid.com/react-data-grid/grid-interface/#grid-api ";break;case"children":t+=" For multiple versions AgGridReact does not support children.";break}return t},275:CP,276:()=>"Row Numbers Row Resizer cannot be used when Grid Columns have `autoHeight` enabled.",277:({colId:e})=>`'enableFilterHandlers' is set to true, but column '${e}' does not have 'filter.doesFilterPass' or 'filter.handler' set.`,278:({colId:e})=>`Unable to create filter handler for column '${e}'`,279:e=>{},280:({colId:e})=>`'name' must be provided for custom filter components for column '${e}`,281:({colId:e})=>`Filter for column '${e}' does not have 'filterParams.buttons', but the new Filters Tool Panel has buttons configured. Either configure buttons for the filter, or disable buttons on the Filters Tool Panel.`,282:()=>"New filter tool panel requires `enableFilterHandlers: true`.",283:()=>"As of v34, use the same method on the filter handler (`api.getColumnFilterHandler(colKey)`) instead.",284:()=>"As of v34, filters are active when they have a model. Use `api.getColumnFilterModel()` instead.",285:()=>"As of v34, use (`api.getColumnFilterModel()`) instead.",286:()=>"As of v34, use (`api.setColumnFilterModel()`) instead.",287:()=>"`api.doFilterAction()` requires `enableFilterHandlers = true",288:()=>"`api.getColumnFilterModel(key, true)` requires `enableFilterHandlers = true",289:({rowModelType:e})=>`Row Model '${e}' is not supported with Batch Editing`,290:({rowIndex:e,rowPinned:t})=>`Row with index '${e}' and pinned state '${t}' not found`,291:()=>"License Key being set multiple times with different values. This can result in an incorrect license key being used,",292:({colId:e})=>`The Multi Filter for column '${e}' has buttons configured against the child filters. When 'enableFilterHandlers=true', buttons must instead be provided against the parent Multi Filter params. The child filter buttons will be ignored.`};function R$(e,t){let i=E$[e];if(!i)return[`Missing error text for error id ${e}!`];let n=i(t),s=`
See ${g6(e,t)}`;return Array.isArray(n)?n.concat(s):[n,s]}var P$={1:"Charting Aggregation",2:"pivotResultFields",3:"setTooltip"},MR=new WeakMap,kR=new WeakMap;function vP(e,t,i){if(!t)return Ge(11),{};let n=i,o;if(!n?.setThemeOnGridDiv){let r=ft({tag:"div"});r.style.height="100%",e.appendChild(r),e=r,o=()=>e.remove()}return new k$().create(e,t,r=>{let a=new dV(e);r.createBean(a)},void 0,i,o)}var M$=1,k$=class{create(e,t,i,n,o,s){let r=lv.applyGlobalGridOptions(t),a=r.gridId??String(M$++),l=this.getRegisteredModules(o,a,r.rowModelType),d=this.createBeansList(r.rowModelType,l,a),c=this.createProvidedBeans(e,r,o);if(!d)return;let h={providedBeanInstances:c,beanClasses:d,id:a,beanInitComparator:$G,beanDestroyComparator:jG,derivedBeans:[UG],destroyCallback:()=>{kR.delete(g),MR.delete(e),X_(a),s?.()}},p=new EB(h);this.registerModuleFeatures(p,l),i(p),p.getBean("syncSvc").start(),n?.(p);let g=p.getBean("gridApi");return MR.set(e,g),kR.set(g,e),g}getRegisteredModules(e,t,i){return ld(C$,void 0,!0),e?.modules?.forEach(n=>ld(n,t)),J_(t,DR(i))}registerModuleFeatures(e,t){let i=e.getBean("registry"),n=e.getBean("apiFunctionSvc");for(let o of t){i.registerModule(o);let s=o.apiFunctions;if(s){let r=Object.keys(s);for(let a of r)n?.addFunction(a,s[a])}}}createProvidedBeans(e,t,i){let n=i?i.frameworkOverrides:null;Qe(n)&&(n=new Av);let o={gridOptions:t,eGridDiv:e,eRootDiv:e,globalListener:i?i.globalListener:null,globalSyncListener:i?i.globalSyncListener:null,frameworkOverrides:n};return i?.providedBeanInstances&&Object.assign(o,i.providedBeanInstances),o}createBeansList(e,t,i){let n={clientSide:"ClientSideRowModel",infinite:"InfiniteRowModel",serverSide:"ServerSideRowModel",viewport:"ViewportRowModel"},o=DR(e),s=n[o];if(!s){ql(201,{rowModelType:o},`Unknown rowModelType ${o}.`);return}if(!Z_()){ql(272,void 0,mP());return}if(!e){let a=Object.entries(n).filter(([l,d])=>SC(d,i,l));if(a.length==1){let[l,d]=a[0];if(l!==o){let c={moduleName:d,rowModelType:l};ql(275,c,CP(c));return}}}if(!SC(s,i,o)){ql(200,{reasonOrId:`rowModelType = '${o}'`,moduleName:s,gridScoped:dv(),gridId:i,rowModelType:o},`Missing module ${s}Module for rowModelType ${o}.`);return}let r=new Set;for(let a of t)for(let l of a.beans??[])r.add(l);return Array.from(r)}};function DR(e){return e??"clientSide"}function ts(e){let t=e.rowModel;return t.getType()==="clientSide"?t:void 0}function _p(e){let t=e.rowModel;return t.getType()==="infinite"?t:void 0}function D$(e){let t=e.rowModel;return t.getType()==="serverSide"?t:void 0}var F$=class extends D{constructor(){super(...arguments),this.beanName="localeSvc"}getLocaleTextFunc(){let e=this.gos,t=e.getCallback("getLocaleText");return t?O_(t):N_(e.get("localeText"))}};function T$(e,t=!1){let i=[],n=[],o=[],s=[],r=[],a=[],l=[],d=[],c=[],u=0;for(let h=0;h<e.length;h++){let{colId:p,sort:g,sortIndex:f,rowGroup:m,rowGroupIndex:C,aggFunc:v,pivot:w,pivotIndex:y,pinned:S,hide:x,width:E,flex:T}=e[h];c.push(p),g&&(i[f??u++]={colId:p,sort:g}),m&&(n[C??0]=p),typeof v=="string"&&o.push({colId:p,aggFunc:v}),w&&(s[y??0]=p),S&&(S==="right"?a:r).push(p),x&&l.push(p),(T!=null||E)&&d.push({colId:p,flex:T??void 0,width:E})}return{sort:i.length?{sortModel:fC(i)}:void 0,rowGroup:n.length?{groupColIds:fC(n)}:void 0,aggregation:o.length?{aggregationModel:o}:void 0,pivot:s.length||t?{pivotMode:t,pivotColIds:fC(s)}:void 0,columnPinning:r.length||a.length?{leftColIds:r,rightColIds:a}:void 0,columnVisibility:l.length?{hiddenColIds:l}:void 0,columnSizing:d.length?{columnSizingModel:d}:void 0,columnOrder:c.length?{orderedColIds:c}:void 0}}function fC(e){return e.filter(t=>t!=null)}function A$(e){let t=[];for(let{groupId:i,open:n}of e)n&&t.push(i);return t.length?{openColumnGroupIds:t}:void 0}var wP=class{wrap(e,t,i,n){let o=this.createWrapper(e,n);for(let s of t??[])this.createMethod(o,s,!0);for(let s of i??[])this.createMethod(o,s,!1);return o}createMethod(e,t,i){e.addMethod(t,this.createMethodProxy(e,t,i))}createMethodProxy(e,t,i){return function(){return e.hasMethod(t)?e.callMethod(t,arguments):(i&&I(49,{methodName:t}),null)}}};function mC(e){return e.get("tooltipShowMode")==="whenTruncated"}function I$(e,t){if(typeof e!="number")return"";let i=t(),n=i("thousandSeparator",","),o=i("decimalSeparator",".");return e.toString().replace(".",o).replace(/(\d)(?=(\d{3})+(?!\d))/g,`$1${n}`)}var L$=class extends D{getFileName(e){let t=this.getDefaultFileExtension();return e?.length||(e=this.getDefaultFileName()),e.includes(".")?e:`${e}.${t}`}getData(e){let t=this.createSerializingSession(e);return this.beans.gridSerializer.serialize(t,e)}getDefaultFileName(){return`export.${this.getDefaultFileExtension()}`}},_$=class{constructor(e){let{colModel:t,rowGroupColsSvc:i,colNames:n,valueSvc:o,gos:s,processCellCallback:r,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:d}=e;this.colModel=t,this.rowGroupColsSvc=i,this.colNames=n,this.valueSvc=o,this.gos=s,this.processCellCallback=r,this.processHeaderCallback=a,this.processGroupHeaderCallback=l,this.processRowGroupCallback=d}prepare(e){}extractHeaderValue(e){return this.getHeaderName(this.processHeaderCallback,e)??""}extractRowCellValue(e,t,i,n,o){let s=t===0&&y6(this.gos,o,this.colModel.isPivotMode());if(this.processRowGroupCallback&&(this.gos.get("treeData")||o.group)&&(e.isRowGroupDisplayed(o.rowGroupColumn?.getColId()??"")||s))return{value:this.processRowGroupCallback(te(this.gos,{column:e,node:o}))??""};if(this.processCellCallback)return{value:this.processCellCallback(te(this.gos,{accumulatedRowIndex:i,column:e,node:o,value:this.valueSvc.getValueForDisplay(e,o,void 0,void 0).value,type:n,parseValue:h=>this.valueSvc.parseValue(e,o,h,this.valueSvc.getValue(e,o,void 0)),formatValue:h=>this.valueSvc.formatValue(e,o,h)??h}))??""};let r=this.gos.get("treeData"),a=this.valueSvc,l=o.level===-1&&o.footer,d=e.colDef.showRowGroup===!0&&(o.group||r);if(!l&&(s||d)){let h="",p=o;for(;p&&p.level!==-1;){let{value:g,valueFormatted:f}=a.getValueForDisplay(s?void 0:e,p,!0,!0);h=` -> ${f??g??""}${h}`,p=p.parent}return{value:h,valueFormatted:h}}let{value:c,valueFormatted:u}=a.getValueForDisplay(e,o,!0,!0);return{value:c??"",valueFormatted:u}}getHeaderName(e,t){return e?e(te(this.gos,{column:t})):this.colNames.getDisplayNameForColumn(t,"csv",!0)}};function O$(e,t){let i=document.defaultView||window;if(!i){I(52);return}let n=document.createElement("a"),o=i.URL.createObjectURL(t);n.setAttribute("href",o),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:i})),n.remove(),i.setTimeout(()=>{i.URL.revokeObjectURL(o)},0)}var N$={enableBrowserTooltips:!0,tooltipTrigger:!0,tooltipMouseTrack:!0,tooltipShowMode:!0,tooltipInteraction:!0,defaultColGroupDef:!0,suppressAutoSize:!0,skipHeaderOnAutoSize:!0,autoSizeStrategy:!0,components:!0,stopEditingWhenCellsLoseFocus:!0,undoRedoCellEditing:!0,undoRedoCellEditingLimit:!0,excelStyles:!0,cacheQuickFilter:!0,customChartThemes:!0,chartThemeOverrides:!0,chartToolPanelsDef:!0,loadingCellRendererSelector:!0,localeText:!0,keepDetailRows:!0,keepDetailRowsCount:!0,detailRowHeight:!0,detailRowAutoHeight:!0,tabIndex:!0,valueCache:!0,valueCacheNeverExpires:!0,enableCellExpressions:!0,suppressTouch:!0,suppressBrowserResizeObserver:!0,suppressPropertyNamesCheck:!0,debug:!0,dragAndDropImageComponent:!0,loadingOverlayComponent:!0,suppressLoadingOverlay:!0,noRowsOverlayComponent:!0,paginationPageSizeSelector:!0,paginateChildRows:!0,pivotPanelShow:!0,pivotSuppressAutoColumn:!0,suppressExpandablePivotGroups:!0,aggFuncs:!0,allowShowChangeAfterFilter:!0,ensureDomOrder:!0,enableRtl:!0,suppressColumnVirtualisation:!0,suppressMaxRenderedRowRestriction:!0,suppressRowVirtualisation:!0,rowDragText:!0,groupLockGroupColumns:!0,suppressGroupRowsSticky:!0,rowModelType:!0,cacheOverflowSize:!0,infiniteInitialRowCount:!0,serverSideInitialRowCount:!0,maxBlocksInCache:!0,maxConcurrentDatasourceRequests:!0,blockLoadDebounceMillis:!0,serverSideOnlyRefreshFilteredGroups:!0,serverSidePivotResultFieldSeparator:!0,viewportRowModelPageSize:!0,viewportRowModelBufferSize:!0,debounceVerticalScrollbar:!0,suppressAnimationFrame:!0,suppressPreventDefaultOnMouseWheel:!0,scrollbarWidth:!0,icons:!0,suppressRowTransform:!0,gridId:!0,enableGroupEdit:!0,initialState:!0,processUnpinnedColumns:!0,createChartContainer:!0,getLocaleText:!0,getRowId:!0,reactiveCustomComponents:!0,renderingMode:!0,columnMenu:!0,suppressSetFilterByDefault:!0,getDataPath:!0,enableCellSpan:!0,enableFilterHandlers:!0,filterHandlers:!0},ui="clientSide",Kt="serverSide",Jr="infinite",B$={onGroupExpandedOrCollapsed:[ui],refreshClientSideRowModel:[ui],isRowDataEmpty:[ui],forEachLeafNode:[ui],forEachNodeAfterFilter:[ui],forEachNodeAfterFilterAndSort:[ui],resetRowHeights:[ui,Kt],applyTransaction:[ui],applyTransactionAsync:[ui],flushAsyncTransactions:[ui],getBestCostNodeSelection:[ui],getServerSideSelectionState:[Kt],setServerSideSelectionState:[Kt],applyServerSideTransaction:[Kt],applyServerSideTransactionAsync:[Kt],applyServerSideRowData:[Kt],retryServerSideLoads:[Kt],flushServerSideAsyncTransactions:[Kt],refreshServerSide:[Kt],getServerSideGroupLevelState:[Kt],refreshInfiniteCache:[Jr],purgeInfiniteCache:[Jr],getInfiniteRowCount:[Jr],isLastRowIndexKnown:[Jr,Kt],expandAll:[ui,Kt],collapseAll:[ui,Kt],onRowHeightChanged:[ui,Kt],setRowCount:[Jr,Kt],getCacheBlockState:[Jr,Kt]},H$={showLoadingOverlay:{version:"v32",message:'`showLoadingOverlay` is deprecated. Use the grid option "loading"=true instead or setGridOption("loading", true).'},clearRangeSelection:{version:"v32.2",message:"Use `clearCellSelection` instead."},getInfiniteRowCount:{version:"v32.2",old:"getInfiniteRowCount()",new:"getDisplayedRowCount()"},selectAllFiltered:{version:"v33",old:"selectAllFiltered()",new:'selectAll("filtered")'},deselectAllFiltered:{version:"v33",old:"deselectAllFiltered()",new:'deselectAll("filtered")'},selectAllOnCurrentPage:{version:"v33",old:"selectAllOnCurrentPage()",new:'selectAll("currentPage")'},deselectAllOnCurrentPage:{version:"v33",old:"deselectAllOnCurrentPage()",new:'deselectAll("currentPage")'}};function G$(e,t,i){let n=H$[e];if(n){let{version:s,new:r,old:a,message:l}=n,d=a??e;return(...c)=>{let u=r?`Please use ${r} instead. `:"";return Jl(`Since ${s} api.${d} is deprecated. ${u}${l??""}`),t.apply(t,c)}}let o=B$[e];return o?(...s)=>{let r=i.rowModel.getType();if(!o.includes(r)){sa(`api.${e} can only be called when gridOptions.rowModelType is ${o.join(" or ")}`);return}return t.apply(t,s)}:t}var V$={detailCellRendererCtrl:"SharedMasterDetail",dndSourceComp:"DragAndDrop",fillHandle:"CellSelection",groupCellRendererCtrl:"GroupCellRenderer",headerFilterCellCtrl:"ColumnFilter",headerGroupCellCtrl:"ColumnGroup",rangeHandle:"CellSelection",tooltipFeature:"Tooltip",highlightTooltipFeature:"Tooltip",tooltipStateManager:"Tooltip",groupStrategy:"RowGrouping",treeGroupStrategy:"TreeData",rowNumberRowResizer:"RowNumbers",singleCell:"EditCore",fullRow:"EditCore",agSetColumnFilterHandler:"SetFilter",agMultiColumnFilterHandler:"MultiFilter",agGroupColumnFilterHandler:"GroupFilter",agNumberColumnFilterHandler:"NumberFilter",agDateColumnFilterHandler:"DateFilter",agTextColumnFilterHandler:"TextFilter"},z$={expanded:1,contracted:1,"tree-closed":1,"tree-open":1,"tree-indeterminate":1,pin:1,"eye-slash":1,arrows:1,left:1,right:1,group:1,aggregation:1,pivot:1,"not-allowed":1,chart:1,cross:1,cancel:1,tick:1,first:1,previous:1,next:1,last:1,linked:1,unlinked:1,"color-picker":1,loading:1,menu:1,"menu-alt":1,filter:1,"filter-add":1,columns:1,maximize:1,minimize:1,copy:1,cut:1,paste:1,grip:1,save:1,csv:1,excel:1,"small-down":1,"small-left":1,"small-right":1,"small-up":1,asc:1,desc:1,none:1,up:1,down:1,plus:1,minus:1,settings:1,"checkbox-checked":1,"checkbox-indeterminate":1,"checkbox-unchecked":1,"radio-button-on":1,"radio-button-off":1,eye:1,"column-arrow":1,"un-pin":1,"pinned-top":1,"pinned-bottom":1,"chevron-up":1,"chevron-down":1,"chevron-left":1,"chevron-right":1,edit:1},W$={chart:"MenuCore",cancel:"EnterpriseCore",first:"Pagination",previous:"Pagination",next:"Pagination",last:"Pagination",linked:"IntegratedCharts",loadingMenuItems:"MenuCore",unlinked:"IntegratedCharts",menu:"ColumnHeaderComp",legacyMenu:"ColumnMenu",filter:"ColumnFilter",filterActive:"ColumnFilter",filterAdd:"NewFiltersToolPanel",filterCardCollapse:"NewFiltersToolPanel",filterCardExpand:"NewFiltersToolPanel",filterCardEditing:"NewFiltersToolPanel",filterTab:"ColumnMenu",filtersToolPanel:"FiltersToolPanel",columns:["MenuCore"],columnsToolPanel:["ColumnsToolPanel"],maximize:"EnterpriseCore",minimize:"EnterpriseCore",save:"MenuCore",columnGroupOpened:"ColumnGroupHeaderComp",columnGroupClosed:"ColumnGroupHeaderComp",accordionOpen:"EnterpriseCore",accordionClosed:"EnterpriseCore",accordionIndeterminate:"EnterpriseCore",columnSelectClosed:["ColumnsToolPanel","ColumnMenu"],columnSelectOpen:["ColumnsToolPanel","ColumnMenu"],columnSelectIndeterminate:["ColumnsToolPanel","ColumnMenu"],columnMovePin:"SharedDragAndDrop",columnMoveHide:"SharedDragAndDrop",columnMoveMove:"SharedDragAndDrop",columnMoveLeft:"SharedDragAndDrop",columnMoveRight:"SharedDragAndDrop",columnMoveGroup:"SharedDragAndDrop",columnMoveValue:"SharedDragAndDrop",columnMovePivot:"SharedDragAndDrop",dropNotAllowed:"SharedDragAndDrop",ensureColumnVisible:["ColumnsToolPanel","ColumnMenu"],groupContracted:"GroupCellRenderer",groupExpanded:"GroupCellRenderer",setFilterGroupClosed:"SetFilter",setFilterGroupOpen:"SetFilter",setFilterGroupIndeterminate:"SetFilter",setFilterLoading:"SetFilter",close:"EnterpriseCore",check:"MenuItem",colorPicker:"CommunityCore",groupLoading:"LoadingCellRenderer",menuAlt:"ColumnHeaderComp",menuPin:"MenuCore",menuValue:"MenuCore",menuAddRowGroup:["MenuCore","ColumnsToolPanel"],menuRemoveRowGroup:["MenuCore","ColumnsToolPanel"],clipboardCopy:"MenuCore",clipboardCut:"MenuCore",clipboardPaste:"MenuCore",pivotPanel:["ColumnsToolPanel","RowGroupingPanel"],rowGroupPanel:["ColumnsToolPanel","RowGroupingPanel"],valuePanel:"ColumnsToolPanel",columnDrag:"EnterpriseCore",rowDrag:["RowDrag","DragAndDrop"],csvExport:"MenuCore",excelExport:"MenuCore",smallDown:"CommunityCore",selectOpen:"CommunityCore",richSelectOpen:"RichSelect",richSelectRemove:"RichSelect",smallLeft:"CommunityCore",smallRight:"CommunityCore",subMenuOpen:"MenuItem",subMenuOpenRtl:"MenuItem",panelDelimiter:"RowGroupingPanel",panelDelimiterRtl:"RowGroupingPanel",smallUp:"CommunityCore",sortAscending:["MenuCore","Sort"],sortDescending:["MenuCore","Sort"],sortUnSort:["MenuCore","Sort"],advancedFilterBuilder:"AdvancedFilter",advancedFilterBuilderDrag:"AdvancedFilter",advancedFilterBuilderInvalid:"AdvancedFilter",advancedFilterBuilderMoveUp:"AdvancedFilter",advancedFilterBuilderMoveDown:"AdvancedFilter",advancedFilterBuilderAdd:"AdvancedFilter",advancedFilterBuilderRemove:"AdvancedFilter",advancedFilterBuilderSelectOpen:"AdvancedFilter",chartsMenu:"IntegratedCharts",chartsMenuEdit:"IntegratedCharts",chartsMenuAdvancedSettings:"IntegratedCharts",chartsMenuAdd:"IntegratedCharts",chartsColorPicker:"IntegratedCharts",chartsThemePrevious:"IntegratedCharts",chartsThemeNext:"IntegratedCharts",chartsDownload:"IntegratedCharts",checkboxChecked:"CommunityCore",checkboxIndeterminate:"CommunityCore",checkboxUnchecked:"CommunityCore",radioButtonOn:"CommunityCore",radioButtonOff:"CommunityCore",rowPin:"PinnedRow",rowUnpin:"PinnedRow",rowPinBottom:"PinnedRow",rowPinTop:"PinnedRow"},U$=new Set(["colorPicker","smallUp","checkboxChecked","checkboxIndeterminate","checkboxUnchecked","radioButtonOn","radioButtonOff","smallDown","smallLeft","smallRight"]),q$=class extends D{constructor(){super(...arguments),this.beanName="validation"}wireBeans(e){this.gridOptions=e.gridOptions,eO(R$)}warnOnInitialPropertyUpdate(e,t){e==="api"&&N$[t]&&I(22,{key:t})}processGridOptions(e){this.processOptions(e,BU())}validateApiFunction(e,t){return G$(e,t,this.beans)}missingUserComponent(e,t,i,n){let o=pa[t];o?this.gos.assertModuleRegistered(o,`AG Grid '${e}' component: ${t}`):I(101,{propertyName:e,componentName:t,agGridDefaults:i,jsComps:n})}missingDynamicBean(e){let t=V$[e];return t?En(200,_(b({},this.gos.getModuleErrorParams()),{moduleName:t,reasonOrId:e})):void 0}checkRowEvents(e){j$.has(e)&&I(10,{eventType:e})}validateIcon(e){if(U$.has(e)&&I(43,{iconName:e}),z$[e])return;let t=W$[e];if(t){Ge(200,{reasonOrId:`icon '${e}'`,moduleName:t,gridScoped:dv(),gridId:this.beans.context.getId(),rowModelType:this.gos.get("rowModelType"),additionalText:"Alternatively, use the CSS icon name directly."});return}I(134,{iconName:e})}isProvidedUserComp(e){return!!pa[e]}validateColDef(e){this.processOptions(e,kU())}processOptions(e,t){let{validations:i,deprecations:n,allProperties:o,propertyExceptions:s,objectName:r,docsUrl:a}=t;o&&this.gridOptions.suppressPropertyNamesCheck!==!0&&this.checkProperties(e,[...s??[],...Object.keys(n)],o,r,a);let l=new Set;if(Object.keys(e).forEach(c=>{let u=n[c];if(u){let{message:v,version:w}=u;l.add(`As of v${w}, ${String(c)} is deprecated. ${v??""}`)}let h=e[c];if(h==null||h===!1)return;let p=i[c];if(!p)return;let{dependencies:g,validate:f,supportedRowModels:m,expectedType:C}=p;if(C){let v=typeof h;if(v!==C){l.add(`${String(c)} should be of type '${C}' but received '${v}' (${h}).`);return}}if(m){let v=this.gridOptions.rowModelType??"clientSide";if(!m.includes(v)){l.add(`${String(c)} is not supported with the '${v}' row model. It is only valid with: ${m.join(", ")}.`);return}}if(g){let v=this.checkForRequiredDependencies(c,g,e);if(v){l.add(v);return}}if(f){let v=f(e,this.gridOptions,this.beans);if(v){l.add(v);return}}}),l.size>0)for(let c of l)Jl(c)}checkForRequiredDependencies(e,t,i){let o=Object.entries(t).filter(([s,r])=>{let a=i[s];return!r.required.includes(a)});return o.length===0?null:o.map(([s,r])=>`'${String(e)}' requires '${s}' to be one of [${r.required.map(a=>a===null?"null":a===void 0?"undefined":a).join(", ")}]. ${r.reason??""}`).join(`
           `)}checkProperties(e,t,i,n,o){let s=["__ob__","__v_skip","__metadata__"],r=$$(Object.getOwnPropertyNames(e),[...s,...t,...i],i),a=Object.keys(r);for(let l of a){let d=r[l],c=`invalid ${n} property '${l}' did you mean any of these: ${d.slice(0,8).join(", ")}.`;i.includes("context")&&(c+=`
If you are trying to annotate ${n} with application data, use the '${n}.context' property instead.`),Jl(c)}if(a.length>0&&o){let l=this.beans.frameworkOverrides.getDocLink(o);Jl(`to see all the valid ${n} properties please check: ${l}`)}}};function $$(e,t,i){let n={},o=e.filter(s=>!t.some(r=>r===s));if(o.length>0)for(let s of o)n[s]=AC({inputValue:s,allSuggestions:i}).values;return n}var j$=new Set(["firstChildChanged","lastChildChanged","childIndexChanged"]),K$={moduleName:"Validation",version:z,beans:[q$]};function bP(e){let t=e.sibling;t&&(t.childrenAfterFilter=e.childrenAfterFilter)}var Y$=class extends D{constructor(){super(...arguments),this.beanName="filterStage",this.step="filter",this.refreshProps=["excludeChildrenWhenTreeDataFiltering"]}wireBeans(e){this.filterManager=e.filterManager}execute(e){let{changedPath:t}=e;this.filter(t)}filter(e){let t=!!this.filterManager?.isChildFilterPresent();this.filterNodes(t,e)}filterNodes(e,t){let i=(n,o)=>{n.hasChildren()&&e&&!o?n.childrenAfterFilter=n.childrenAfterGroup.filter(s=>{let r=s.childrenAfterFilter&&s.childrenAfterFilter.length>0,a=s.data&&this.filterManager.doesRowPassFilter({rowNode:s});return r||a}):n.childrenAfterFilter=n.childrenAfterGroup,bP(n)};if(this.doingTreeDataFiltering()){let n=(s,r)=>{if(s.childrenAfterGroup)for(let a=0;a<s.childrenAfterGroup.length;a++){let l=s.childrenAfterGroup[a],d=r||this.filterManager.doesRowPassFilter({rowNode:l});l.childrenAfterGroup?n(s.childrenAfterGroup[a],d):i(l,d)}i(s,r)},o=s=>n(s,!1);t.executeFromRootNode(o)}else{let n=o=>i(o,!1);t.forEachChangedNodeDepthFirst(n,!0)}}doingTreeDataFiltering(){return this.gos.get("treeData")&&!this.gos.get("excludeChildrenWhenTreeDataFiltering")}},X$=class extends Tv{constructor(){super(...arguments),this.iconCreated=!1}wireComp(e,t,i,n,o){this.comp=e;let s=vd(this,this.beans.context,o);this.eButtonShowMainFilter=i,this.eFloatingFilterBody=n,this.setGui(t,s),this.setupActive(),this.refreshHeaderStyles(),this.setupWidth(s),this.setupLeft(s),this.setupHover(s),this.setupFocus(s),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(s),this.setupUi(),s.addManagedElementListeners(this.eButtonShowMainFilter,{click:this.showParentFilter.bind(this)}),this.setupFilterChangedListener(s);let r=()=>this.onColDefChanged(s);s.addManagedListeners(this.column,{colDefChanged:r}),s.addManagedEventListeners({filterSwitched:({column:a})=>{a===this.column&&r()}}),s.addDestroyFunc(()=>{this.eButtonShowMainFilter=null,this.eFloatingFilterBody=null,this.userCompDetails=null,this.clearComponent()})}resizeHeader(){}moveHeader(){}getHeaderClassParams(){let{column:e,beans:t}=this,i=e.colDef;return te(t.gos,{colDef:i,column:e,floatingFilter:!0})}setupActive(){let e=this.column.getColDef(),t=!!e.filter,i=!!e.floatingFilter;this.active=t&&i}setupUi(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),!this.active||this.iconCreated)return;let e=Ni("filter",this.beans,this.column);e&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(e))}setupFocus(e){e.createManagedBean(new Ea(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}setupAria(){let e=this.getLocaleTextFunc();ma(this.eButtonShowMainFilter,e("ariaFilterMenuOpen","Open Filter Menu"))}onTabKeyDown(e){let{beans:t}=this;if(tt(t)===this.eGui)return;let o=Qs(t,this.eGui,null,e.shiftKey);if(o){t.headerNavigation?.scrollToColumn(this.column),e.preventDefault(),o.focus();return}let s=this.findNextColumnWithFloatingFilter(e.shiftKey);s&&t.focusSvc.focusHeaderPosition({headerPosition:{headerRowIndex:this.rowCtrl.rowIndex,column:s},event:e})&&e.preventDefault()}findNextColumnWithFloatingFilter(e){let t=this.beans.visibleCols,i=this.column;do if(i=e?t.getColBefore(i):t.getColAfter(i),!i)break;while(!i.getColDef().filter||!i.getColDef().floatingFilter);return i}handleKeyDown(e){super.handleKeyDown(e);let t=this.getWrapperHasFocus();switch(e.key){case R.UP:case R.DOWN:case R.LEFT:case R.RIGHT:if(t)return;Ks(e);case R.ENTER:t&&js(this.eGui)&&e.preventDefault();break;case R.ESCAPE:t||this.eGui.focus()}}onFocusIn(e){if(this.eGui.contains(e.relatedTarget))return;let i=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),n=!!e.relatedTarget&&Hs(e.relatedTarget,"ag-floating-filter");if(i&&n&&e.target===this.eGui){let o=this.lastFocusEvent,s=!!(o&&o.key===R.TAB);if(o&&s){let r=o.shiftKey;js(this.eGui,r)}}this.focusThis()}setupHover(e){this.beans.colHover?.addHeaderFilterColumnHoverListener(e,this.comp,this.column,this.eGui)}setupLeft(e){let t=new Fv(this.column,this.eGui,this.beans);e.createManagedBean(t)}setupFilterButton(){this.suppressFilterButton=!this.beans.menuSvc?.isFloatingFilterButtonEnabled(this.column),this.highlightFilterButtonWhenActive=!yi(this.gos)}setupUserComp(){if(!this.active)return;let e=this.beans.colFilter?.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter());e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setCompDetails(e)}showParentFilter(){let e=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.beans.menuSvc?.showFilterMenu({column:this.column,buttonElement:e,containerType:"floatingFilter",positionBy:"button"})}setupSyncWithFilter(e){if(!this.active)return;let{beans:{colFilter:t},column:i,gos:n}=this,o=s=>{if(s?.source==="filterDestroyed"&&(!this.isAlive()||!t?.isAlive()))return;let r=this.comp.getFloatingFilterComp();r&&r.then(a=>{if(a){if(n.get("enableFilterHandlers")){let c=s,u="filter";c?.afterFloatingFilter?u="ui":c?.afterDataChange?u="dataChanged":s?.source==="api"&&(u="api"),this.updateFloatingFilterParams(this.userCompDetails,u);return}let l=t?.getCurrentFloatingFilterParentModel(i),d=s?_(b({},s),{columns:s.columns??[],source:s.source==="api"?"api":"columnFilter"}):null;a.onParentModelChanged(l,d)}})};[this.destroySyncListener]=e.addManagedListeners(i,{filterChanged:o}),t?.isFilterActive(i)&&o(null)}setupWidth(e){let t=()=>{let i=`${this.column.getActualWidth()}px`;this.comp.setWidth(i)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupFilterChangedListener(e){this.active&&([this.destroyFilterChangedListener]=e.addManagedListeners(this.column,{filterChanged:this.updateFilterButton.bind(this)}),this.updateFilterButton())}updateFilterButton(){if(!this.suppressFilterButton&&this.comp){let e=!!this.beans.filterManager?.isFilterAllowed(this.column);this.comp.setButtonWrapperDisplayed(e),this.highlightFilterButtonWhenActive&&e&&this.eButtonShowMainFilter.classList.toggle("ag-filter-active",this.column.isFilterActive())}}onColDefChanged(e){let t=this.active;this.setupActive();let i=!t&&this.active;t&&!this.active&&(this.destroySyncListener(),this.destroyFilterChangedListener());let n=this.beans.colFilter,o=this.active?n?.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter()):null,s=this.comp.getFloatingFilterComp();!s||!o?this.updateCompDetails(e,o,i):s.then(r=>{!r||n?.areFilterCompsDifferent(this.userCompDetails??null,o)?this.updateCompDetails(e,o,i):this.updateFloatingFilterParams(o,"colDef")})}updateCompDetails(e,t,i){this.isAlive()&&(this.setCompDetails(t),this.setupFilterButton(),this.setupUi(),i&&(this.setupSyncWithFilter(e),this.setupFilterChangedListener(e)))}updateFloatingFilterParams(e,t){if(!e)return;let i=e.params;this.comp.getFloatingFilterComp()?.then(n=>{typeof n?.refresh=="function"&&(this.gos.get("enableFilterHandlers")&&(i=_(b({},i),{model:Mt(this.beans.colFilter?.model??{},this.column.getColId()),source:t})),n.refresh(i))})}addResizeAndMoveKeyboardListeners(){}destroy(){super.destroy(),this.destroySyncListener=null,this.destroyFilterChangedListener=null}};function J$(e,t){let i=e.colModel.getCol(t);if(!i){Ge(12,{colKey:t});return}e.menuSvc?.showColumnMenu({column:i,positionBy:"auto"})}function Q$(e){e.menuSvc?.hidePopupMenu()}var Z$={moduleName:"SharedMenu",version:z,beans:[pG],apiFunctions:{showColumnMenu:J$,hidePopupMenu:Q$}},ej=class extends LB{postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridCtrl=e.gridCtrl}),this.addManagedEventListeners({gridStylesChanged:this.handleThemeChange.bind(this)})}getDefaultPopupParent(){return this.gridCtrl.getGui()}positionPopupForMenu(e){let{eventSource:t,ePopup:i,event:n}=e,o=t.getBoundingClientRect(),s=this.getParentRect();this.setAlignedTo(t,i);let r=!1,a=()=>{let l=this.keepXYWithinBounds(i,o.top-s.top,0),d=i.clientWidth>0?i.clientWidth:200;r||(i.style.minWidth=`${d}px`,r=!0);let u=s.right-s.left-d,h;return this.gos.get("enableRtl")?(h=g(),h<0&&(h=p(),this.setAlignedStyles(i,"left")),h>u&&(h=0,this.setAlignedStyles(i,"right"))):(h=p(),h>u&&(h=g(),this.setAlignedStyles(i,"right")),h<0&&(h=0,this.setAlignedStyles(i,"left"))),{x:h,y:l};function p(){return o.right-s.left-2}function g(){return o.left-s.left-d}};this.positionPopup({ePopup:i,keepWithinBounds:!0,updatePosition:a,postProcessCallback:()=>this.callPostProcessPopup(e,"subMenu",i,t,n instanceof MouseEvent?n:void 0)})}callPostProcessPopup(e,t,i,n,o){let s=this.gos.getCallback("postProcessPopup");if(s){let{column:r,rowNode:a}=e;s({column:r,rowNode:a,ePopup:i,type:t,eventSource:n,mouseEvent:o})}}getActivePopups(){return this.popupList.map(e=>e.element)}handleThemeChange(e){if(e.themeChanged){let t=this.beans.environment;for(let i of this.popupList)t.applyThemeClasses(i.wrapper)}}hasAnchoredPopup(){return this.popupList.some(e=>e.isAnchored)}isStopPropagation(e){return co(e)}},Op={moduleName:"Popup",version:z,beans:[ej]},tj=".ag-set-filter{--ag-indentation-level:0}.ag-set-filter-item{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-set-filter-item{padding-left:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}:where(.ag-rtl) .ag-set-filter-item{padding-right:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}.ag-set-filter-item-checkbox{display:flex;height:100%;width:100%}.ag-set-filter-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr) .ag-set-filter-group-icons{margin-right:var(--ag-widget-container-horizontal-padding)}:where(.ag-rtl) .ag-set-filter-group-icons{margin-left:var(--ag-widget-container-horizontal-padding)}.ag-filter-body-wrapper{display:flex;flex-direction:column}:where(.ag-menu:not(.ag-tabs) .ag-filter) .ag-filter-body-wrapper,:where(.ag-menu:not(.ag-tabs) .ag-filter)>:not(.ag-filter-wrapper){min-width:180px}.ag-filter-filter{flex:1 1 0px}.ag-filter-condition{display:flex;justify-content:center}.ag-floating-filter-body{display:flex;flex:1 1 auto;height:100%;position:relative}.ag-floating-filter-full-body{align-items:center;display:flex;flex:1 1 auto;height:100%;overflow:hidden;width:100%}:where(.ag-floating-filter-full-body)>div{flex:1 1 auto}.ag-floating-filter-input{align-items:center;display:flex;width:100%;>*{flex:1 1 auto}:where(.ag-input-field-input[type=date]),:where(.ag-input-field-input[type=datetime-local]){width:1px}}.ag-floating-filter-button{display:flex;flex:none}.ag-date-floating-filter-wrapper{display:flex}.ag-set-floating-filter-input :where(input)[disabled]{pointer-events:none}.ag-floating-filter-button-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:none;height:var(--ag-icon-size);width:var(--ag-icon-size)}.ag-filter-loading{align-items:unset;background-color:var(--ag-chrome-background-color);height:100%;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);position:absolute;width:100%;z-index:1;:where(.ag-menu) &{background-color:var(--ag-menu-background-color)}}.ag-filter-separator{border-top:solid var(--ag-border-width) var(--menu-separator-color)}:where(.ag-filter-select) .ag-picker-field-wrapper{width:0}.ag-filter-condition-operator{height:17px}:where(.ag-ltr) .ag-filter-condition-operator-or{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-condition-operator-or{margin-right:calc(var(--ag-spacing)*2)}.ag-set-filter-select-all{padding-top:var(--ag-widget-container-vertical-padding)}.ag-filter-no-matches,.ag-set-filter-list{height:calc(var(--ag-list-item-height)*6)}.ag-filter-no-matches{padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}.ag-set-filter-tree-list{height:calc(var(--ag-list-item-height)*10)}.ag-set-filter-filter{margin-left:var(--ag-widget-container-horizontal-padding);margin-right:var(--ag-widget-container-horizontal-padding);margin-top:var(--ag-widget-container-vertical-padding)}.ag-filter-to{margin-top:var(--ag-widget-vertical-spacing)}.ag-mini-filter{margin:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}:where(.ag-ltr) .ag-set-filter-add-group-indent{margin-left:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-rtl) .ag-set-filter-add-group-indent{margin-right:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-filter-menu) .ag-set-filter-list{min-width:200px}.ag-filter-virtual-list-item:focus-visible{box-shadow:inset var(--ag-focus-shadow)}.ag-filter-apply-panel{display:flex;justify-content:flex-end;overflow:hidden;padding:var(--ag-widget-vertical-spacing) var(--ag-widget-container-horizontal-padding) var(--ag-widget-container-vertical-padding)}.ag-filter-apply-panel-button{line-height:1.5}:where(.ag-ltr) .ag-filter-apply-panel-button{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-apply-panel-button{margin-right:calc(var(--ag-spacing)*2)}.ag-simple-filter-body-wrapper{display:flex;flex-direction:column;min-height:calc(var(--ag-list-item-height) + var(--ag-widget-container-vertical-padding) + var(--ag-widget-vertical-spacing));overflow-y:auto;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);padding-bottom:calc(var(--ag-widget-container-vertical-padding) - var(--ag-widget-vertical-spacing));&>*{margin-bottom:var(--ag-widget-vertical-spacing)}:where(.ag-resizer-wrapper){margin:0}}.ag-multi-filter-menu-item{margin:var(--ag-spacing) 0}.ag-multi-filter-group-title-bar{background-color:transparent;color:var(--ag-header-text-color);font-weight:500;padding:calc(var(--ag-spacing)*1.5) var(--ag-spacing)}.ag-group-filter-field-select-wrapper{display:flex;flex-direction:column;gap:var(--ag-widget-vertical-spacing);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}";function ij(e){let t=e.filterManager;return!!t?.isColumnFilterPresent()||!!t?.isAggregateFilterPresent()}function nj(e,t){return e.filterManager?.getColumnFilterInstance(t)??Promise.resolve(void 0)}function oj(e,t){let i=e.colModel.getColDefCol(t);if(i)return e.colFilter?.destroyFilter(i,"api")}function sj(e,t){e.frameworkOverrides.wrapIncoming(()=>e.filterManager?.setFilterModel(t))}function rj(e){return e.filterManager?.getFilterModel()??{}}function aj(e,t,i){let{gos:n,colModel:o,colFilter:s}=e;i&&!n.get("enableFilterHandlers")&&(I(288),i=!1);let r=o.getColDefCol(t);return r?s?.getModelForColumn(r,i)??null:null}function lj(e,t,i){return e.filterManager?.setColumnFilterModel(t,i)??Promise.resolve()}function dj(e,t){let i=e.colModel.getCol(t);if(!i){Ge(12,{colKey:t});return}e.menuSvc?.showFilterMenu({column:i,containerType:"columnFilter",positionBy:"auto"})}function cj(e){e.menuSvc?.hideFilterMenu()}function uj(e,t){let i=e.colModel.getCol(t);if(!i){Ge(12,{colKey:t});return}return e.colFilter?.getHandler(i,!0)}function hj(e,t){let{colModel:i,colFilter:n,gos:o}=e;if(!o.get("enableFilterHandlers")){I(287);return}let{colId:s,action:r}=t;if(s){let a=i.getColById(s);a&&n?.updateModel(a,r)}else n?.updateAllModels(r)}var pj={filterHandler:()=>({doesFilterPass:()=>!0})},gj=class extends D{constructor(){super(...arguments),this.beanName="colFilter",this.allColumnFilters=new Map,this.allColumnListeners=new Map,this.activeAggregateFilters=[],this.activeColumnFilters=[],this.processingFilterChange=!1,this.modelUpdates=[],this.columnModelUpdates=[],this.state=new Map,this.handlerMap=b({},u4),this.isGlobalButtons=!1,this.activeFilterComps=new Set}postConstruct(){this.addManagedEventListeners({gridColumnsChanged:this.onColumnsChanged.bind(this),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)});let e=this.gos,t=b({},e.get("initialState")?.filter?.filterModel??{});this.initialModel=t,this.model=b({},t),e.get("enableFilterHandlers")||delete this.handlerMap.agMultiColumnFilter}refreshModel(){this.onNewRowsLoaded("rowDataUpdated")}setModel(e,t="api",i){let{colModel:n,dataTypeSvc:o,filterManager:s}=this.beans;if(o?.isPendingInference){this.modelUpdates.push({model:e,source:t});return}let r=[],a=this.getModel(!0);if(e){let l=new Set(Object.keys(e));this.allColumnFilters.forEach((d,c)=>{let u=e[c];r.push(this.setModelOnFilterWrapper(d,u)),l.delete(c)}),l.forEach(d=>{let c=n.getColDefCol(d)||n.getCol(d);if(!c){I(62,{colId:d});return}if(!c.isFilterAllowed()){I(63,{colId:d});return}let u=this.getOrCreateFilterWrapper(c,!0);if(!u){I(64,{colId:d});return}r.push(this.setModelOnFilterWrapper(u,e[d],!0))})}else this.model={},this.allColumnFilters.forEach(l=>{r.push(this.setModelOnFilterWrapper(l,null))});nt.all(r).then(()=>{let l=this.getModel(!0),d=[];this.allColumnFilters.forEach((c,u)=>{let h=a?a[u]:null,p=l?l[u]:null;nd(h,p)||d.push(c.column)}),d.length>0?s?.onFilterChanged({columns:d,source:t}):i&&this.updateActive("filterChanged")})}getModel(e){let t={},{allColumnFilters:i,initialModel:n,beans:{colModel:o}}=this;if(i.forEach((s,r)=>{let a=this.getModelFromFilterWrapper(s);q(a)&&(t[r]=a)}),!e)for(let s of Object.keys(n)){let r=n[s];q(r)&&!i.has(s)&&o.getCol(s)?.isFilterAllowed()&&(t[s]=r)}return t}setState(e,t,i="api"){if(this.state.clear(),t)for(let n of Object.keys(t)){let o=t[n];this.state.set(n,{model:Mt(this.model,n),state:o})}this.setModel(e,i,!0)}getState(){let e=this.state;if(!e.size)return;let t={},i=!1;return e.forEach((n,o)=>{let s=n.state;s!=null&&(i=!0,t[o]=s)}),i?t:void 0}getModelFromFilterWrapper(e){let i=e.column.getColId();if(e.isHandler)return Mt(this.model,i);let n=e.filter;return n?typeof n.getModel!="function"?(I(66),null):n.getModel():Mt(this.initialModel,i)}isFilterPresent(){return this.activeColumnFilters.length>0}isAggFilterPresent(){return!!this.activeAggregateFilters.length}disableFilters(){this.initialModel={};let{allColumnFilters:e}=this;return e.size?(e.forEach(t=>this.disposeFilterWrapper(t,"advancedFilterEnabled")),!0):!1}updateActiveFilters(){let e=d=>d?d.isFilterActive?d.isFilterActive():(I(67),!1):!1,{colModel:t,gos:i}=this.beans,n=!!RC(i),o=d=>{if(!d.isPrimary())return!0;let u=!t.isPivotActive();return!d.isValueActive()||!u?!1:t.isPivotMode()?!0:n},s=[],r=[],a=(d,c,u)=>{c&&(o(d)?s.push(u):r.push(u))},l=[];return this.allColumnFilters.forEach(d=>{let c=d.column,u=c.getColId();if(d.isHandler)l.push(nt.resolve().then(()=>{a(c,this.isHandlerActive(c),{colId:u,isHandler:!0,handler:d.handler,handlerParams:d.handlerParams})}));else{let h=Vo(d);h&&l.push(h.then(p=>{a(c,e(p),{colId:u,isHandler:!1,comp:p})}))}}),nt.all(l).then(()=>{this.activeAggregateFilters=s,this.activeColumnFilters=r})}updateFilterFlagInColumns(e,t){let i=[];return this.allColumnFilters.forEach(n=>{let o=n.column;if(n.isHandler)i.push(nt.resolve().then(()=>{this.setColFilterActive(o,this.isHandlerActive(o),e,t)}));else{let s=Vo(n);s&&i.push(s.then(r=>{this.setColFilterActive(o,r.isFilterActive(),e,t)}))}}),this.beans.groupFilter?.updateFilterFlags(e,t),nt.all(i)}doFiltersPass(e,t,i){let{data:n,aggData:o}=e,s=i?this.activeAggregateFilters:this.activeColumnFilters,r=i?o:n,a=this.model;for(let l=0;l<s.length;l++){let d=s[l],{colId:c,isHandler:u}=d;if(c!==t)if(u){let{handler:h,handlerParams:p}=d;if(!h.doesFilterPass({node:e,data:r,model:Mt(a,c),handlerParams:p}))return!1}else{let h=d.comp;if(typeof h.doesFilterPass!="function"){Ge(91);continue}if(!h.doesFilterPass({node:e,data:r}))return!1}}return!0}getHandlerParams(e){let t=this.allColumnFilters.get(e.getColId());return t?.isHandler?t.handlerParams:void 0}callOnFilterChangedOutsideRenderCycle(e){let{rowRenderer:t,filterManager:i}=this.beans,n=()=>{this.isAlive()&&i?.onFilterChanged(e)};t.isRefreshInProgress()?setTimeout(n,0):n()}updateBeforeFilterChanged(e={}){let{column:t,additionalEventAttributes:i}=e,n=t?.getColId();return this.updateActiveFilters().then(()=>this.updateFilterFlagInColumns("filterChanged",i).then(()=>{this.allColumnFilters.forEach(o=>{let{column:s,isHandler:r}=o;n!==s.getColId()&&(r&&o.handler.onAnyFilterChanged?.(),Vo(o,r)?.then(a=>{typeof a?.onAnyFilterChanged=="function"&&a.onAnyFilterChanged()}))}),this.processingFilterChange=!0}))}updateAfterFilterChanged(){this.processingFilterChange=!1}isSuppressFlashingCellsBecauseFiltering(){return!(this.gos.get("allowShowChangeAfterFilter")??!1)&&this.processingFilterChange}onNewRowsLoaded(e){let t=[];this.allColumnFilters.forEach(i=>{let n=i.isHandler;n&&i.handler.onNewRowsLoaded?.();let o=Vo(i,n);o&&t.push(o.then(s=>{s.onNewRowsLoaded?.()}))}),nt.all(t).then(()=>this.updateActive(e,{afterDataChange:!0}))}updateActive(e,t){this.updateFilterFlagInColumns(e,t).then(()=>this.updateActiveFilters())}createGetValue(e,t){let{filterValueSvc:i,colModel:n}=this.beans;return(o,s)=>{let r=s?n.getCol(s):e;return r?i.getValue(r,o,t):void 0}}isFilterActive(e){let t=this.cachedFilter(e);if(t?.isHandler)return this.isHandlerActive(e);let i=t?.filter;return i?i.isFilterActive():Mt(this.initialModel,e.getColId())!=null}isHandlerActive(e){let t=q(Mt(this.model,e.getColId()));if(t)return t;let i=this.beans.groupFilter;return i?.isGroupFilter(e)?i.isFilterActive(e):!1}getOrCreateFilterUi(e){let t=this.getOrCreateFilterWrapper(e,!0);return t?Vo(t):null}getFilterUiForDisplay(e){let t=this.getOrCreateFilterWrapper(e,!0);if(!t)return null;let i=Vo(t);return i?i.then(n=>({comp:n,params:t.filterUi.filterParams,isHandler:t.isHandler})):null}getHandler(e,t){let i=this.getOrCreateFilterWrapper(e,t);return i?.isHandler?i.handler:void 0}getOrCreateFilterWrapper(e,t){if(!e.isFilterAllowed())return;let i=this.cachedFilter(e);return!i&&t&&(i=this.createFilterWrapper(e),this.setColumnFilterWrapper(e,i)),i}cachedFilter(e){return this.allColumnFilters.get(e.getColId())}getDefaultFilter(e,t=!1){return this.getDefaultFilterFromDataType(()=>this.beans.dataTypeSvc?.getBaseDataType(e),t)}getDefaultFilterFromDataType(e,t=!1){return mO(this.gos)?t?"agSetColumnFloatingFilter":"agSetColumnFilter":oH(e(),t)}getDefaultFloatingFilter(e){return this.getDefaultFilter(e,!0)}createFilterComp(e,t,i,n,o,s){let r=()=>{let d=this.createFilterCompParams(e,o,s),c=n(d,o);return wN(this.beans.userCompFactory,t,c,i)},a=r();return a?{compDetails:a,createFilterUi:d=>(d?r():a).newAgStackInstance()}:null}createFilterInstance(e,t,i,n){let o=this.beans.selectableFilter;o?.isSelectable(t)&&(t=o.getFilterDef(e,t));let{handler:s,handlerParams:r,handlerGenerator:a}=this.createHandler(e,t,i)??{},l=this.createFilterComp(e,t,i,n,!!s,"init");if(!l)return{compDetails:null,createFilterUi:null,handler:s,handlerGenerator:a,handlerParams:r};let{compDetails:d,createFilterUi:c}=l;return this.isGlobalButtons&&(d.params?.buttons?.length||I(281,{colId:e.getColId()})),{compDetails:d,handler:s,handlerGenerator:a,handlerParams:r,createFilterUi:c}}createBaseFilterParams(e,t){let{filterManager:i,rowModel:n}=this.beans;return te(this.gos,{column:e,colDef:e.getColDef(),getValue:this.createGetValue(e),doesRowPassOtherFilter:t?()=>!0:o=>i?.doesRowPassOtherFilters(e.getColId(),o)??!0,rowModel:n})}createFilterCompParams(e,t,i,n){let o=this.filterChangedCallbackFactory(e),s=this.createBaseFilterParams(e,n);if(s.filterChangedCallback=o,s.filterModifiedCallback=n?()=>{}:r=>this.filterModified(e,r),t){let r=s,a=e.getColId(),l=Mt(this.model,a);r.model=l,r.state=this.state.get(a)??{model:l},r.onModelChange=(d,c)=>{this.updateStoredModel(a,d),this.refreshHandlerAndUi(e,d,"ui",!1,c).then(()=>{o(_(b({},c),{source:"columnFilter"}))})},r.onStateChange=d=>{this.updateState(e,d),this.updateOrRefreshFilterUi(e)},r.onAction=(d,c,u)=>{this.updateModel(e,d,c),this.dispatchLocalEvent({type:"filterAction",column:e,action:d,event:u})},r.getHandler=()=>this.getHandler(e,!0),r.onUiChange=d=>this.filterUiChanged(e,d),r.source=i}return s}createFilterUiForHandler(e,t){return t?{created:!1,create:t,filterParams:e.params,compDetails:e}:null}createFilterUiLegacy(e,t,i){let n=t(),o={created:!0,create:t,filterParams:e.params,compDetails:e,promise:n};return n.then(i),o}createFilterWrapper(e){let{compDetails:t,handler:i,handlerGenerator:n,handlerParams:o,createFilterUi:s}=this.createFilterInstance(e,e.getColDef(),this.getDefaultFilter(e),a=>a),r=e.getColId();if(i)return delete this.initialModel[r],i.init?.(_(b({},o),{source:"init",model:Mt(this.model,r)})),{column:e,isHandler:!0,handler:i,handlerGenerator:n,handlerParams:o,filterUi:this.createFilterUiForHandler(t,s)};if(s){let a={column:e,filterUi:null,isHandler:!1};return a.filterUi=this.createFilterUiLegacy(t,s,l=>{a.filter=l??void 0}),a}return{column:e,filterUi:null,isHandler:!1}}createHandlerFunc(e,t,i){let{gos:n,frameworkOverrides:o,registry:s}=this.beans,r,a=p=>{let g=p.filter;if(G6(g)){let f=g.handler;return f||(r=g.doesFilterPass,r?()=>({doesFilterPass:r}):void 0)}return typeof g=="string"?g:void 0},l=n.get("enableFilterHandlers"),d=l?a(t):void 0,c=p=>()=>this.createBean(s.createDynamicBean(p,!0)),u,h;if(typeof d=="string"){let p=n.get("filterHandlers")?.[d];p!=null?u=p:$B.has(d)&&(u=c(d),h=d)}else u=d;if(!u){let p,{compName:g,jsComp:f,fwComp:m}=W6(o,t);g?p=g:f==null&&m==null&&t.filter===!0&&(p=i),h=this.handlerMap[p],h&&(u=c(h))}return u?{filterHandler:u,handlerNameOrCallback:r??h}:l?(gt(n)&&I(277,{colId:e.getColId()}),pj):void 0}createHandler(e,t,i){let n=this.createHandlerFunc(e,t,i);if(!n)return;let o=V0(this.beans.userCompFactory,t,this.createFilterCompParams(e,!0,"init")),{handlerNameOrCallback:s,filterHandler:r}=n,{handler:a,handlerParams:l}=this.createHandlerFromFunc(e,r,o);return{handler:a,handlerParams:l,handlerGenerator:s??r}}createHandlerFromFunc(e,t,i){let n=e.getColDef(),o=t(te(this.gos,{column:e,colDef:n})),s=this.createHandlerParams(e,i);return{handler:o,handlerParams:s}}createHandlerParams(e,t){let i=e.getColDef(),n=e.getColId(),o=this.filterChangedCallbackFactory(e);return te(this.gos,{colDef:i,column:e,getValue:this.createGetValue(e),doesRowPassOtherFilter:s=>this.beans.filterManager?.doesRowPassOtherFilters(n,s)??!0,onModelChange:(s,r)=>{this.updateStoredModel(n,s),this.refreshHandlerAndUi(e,s,"handler",!1,r).then(()=>{o(_(b({},r),{source:"columnFilter"}))})},filterParams:t})}onColumnsChanged(){let e=[],{colModel:t,filterManager:i,groupFilter:n}=this.beans;this.allColumnFilters.forEach((s,r)=>{let a;s.column.isPrimary()?a=t.getColDefCol(r):a=t.getCol(r),!(a&&a===s.column)&&(e.push(s.column),this.disposeFilterWrapper(s,"columnChanged"),this.disposeColumnListener(r))});let o=n&&e.every(s=>n.isGroupFilter(s));e.length>0&&!o&&i?.onFilterChanged({columns:e,source:"api"})}isFilterAllowed(e){if(!e.isFilterAllowed())return!1;let i=this.beans.groupFilter;return i?.isGroupFilter(e)?i.isFilterAllowed(e):!0}getFloatingFilterCompDetails(e,t){let{userCompFactory:i,frameworkOverrides:n,selectableFilter:o}=this.beans,s=h=>{let p=this.getOrCreateFilterUi(e);p?.then(g=>{h(ud(g))})},r=e.getColDef(),a=o?.isSelectable(r)?o.getFilterDef(e,r):r,l=dH(n,a,()=>this.getDefaultFloatingFilter(e))??"agReadOnlyFloatingFilter",d=this.gos.get("enableFilterHandlers"),c=V0(i,a,this.createFilterCompParams(e,d,"init",!0)),u=te(this.gos,{column:e,filterParams:c,currentParentModel:()=>this.getCurrentFloatingFilterParentModel(e),parentFilterInstance:s,showParentFilter:t});if(d){let h=u,p=e.getColId(),g=this.filterChangedCallbackFactory(e);h.onUiChange=f=>this.floatingFilterUiChanged(e,f),h.model=Mt(this.model,p),h.onModelChange=(f,m)=>{this.updateStoredModel(p,f),this.refreshHandlerAndUi(e,f,"floating",!0,m).then(()=>{g(_(b({},m),{source:"columnFilter"}))})},h.getHandler=()=>this.getHandler(e,!0),h.source="init"}return EN(i,r,u,l)}getCurrentFloatingFilterParentModel(e){return this.getModelFromFilterWrapper(this.cachedFilter(e)??{column:e})}destroyFilterUi(e,t,i,n){let o="paramsUpdated";if(e.isHandler){let s=t.getColId();delete this.initialModel[s],this.state.delete(s);let r=e.filterUi,a=this.createFilterUiForHandler(i,n);e.filterUi=a;let l=this.eventSvc;r?.created?r.promise.then(d=>{this.destroyBean(d),l.dispatchEvent({type:"filterDestroyed",source:o,column:t})}):l.dispatchEvent({type:"filterHandlerDestroyed",source:o,column:t})}else this.destroyFilter(t,o)}destroyFilter(e,t="api"){let i=e.getColId(),n=this.allColumnFilters.get(i);this.disposeColumnListener(i),delete this.initialModel[i],n&&this.disposeFilterWrapper(n,t).then(o=>{o&&this.isAlive()&&this.beans.filterManager?.onFilterChanged({columns:[e],source:"api"})})}disposeColumnListener(e){let t=this.allColumnListeners.get(e);t&&(this.allColumnListeners.delete(e),t())}disposeFilterWrapper(e,t){let i=!1,{column:n,isHandler:o,filterUi:s}=e,r=n.getColId();o&&(i=this.isHandlerActive(n),this.destroyBean(e.handler),delete this.model[r],this.state.delete(r));let a=()=>{this.setColFilterActive(n,!1,"filterDestroyed"),this.allColumnFilters.delete(r),this.eventSvc.dispatchEvent({type:"filterDestroyed",source:t,column:n})};if(s){if(s.created)return s.promise.then(l=>(i=o?i:!!l?.isFilterActive(),this.destroyBean(l),a(),i));a()}return nt.resolve(i)}filterChangedCallbackFactory(e){return t=>{this.callOnFilterChangedOutsideRenderCycle({additionalEventAttributes:t,columns:[e],column:e,source:t?.source??"columnFilter"})}}filterParamsChanged(e,t="api"){let i=this.allColumnFilters.get(e);if(!i)return;let n=this.beans,o=i.column,s=o.getColDef(),r=o.isFilterAllowed(),a=this.getDefaultFilter(o),l=n.selectableFilter,d=l?.isSelectable(s)?l.getFilterDef(o,s):s,c=r?this.createHandlerFunc(o,d,this.getDefaultFilter(o)):void 0,u=!!c,h=i.isHandler;if(h!=u){this.destroyFilter(o,"paramsUpdated");return}let{compDetails:p,createFilterUi:g}=(r?this.createFilterComp(o,d,a,m=>m,u,"colDef"):null)??{compDetails:null,createFilterUi:null},f=p?.params??V0(n.userCompFactory,d,this.createFilterCompParams(o,u,"colDef"));if(h){let m=c?.handlerNameOrCallback??c?.filterHandler,C=Mt(this.model,e);if(i.handlerGenerator!=m){let v=i.handler,{handler:w,handlerParams:y}=this.createHandlerFromFunc(o,c.filterHandler,f);i.handler=w,i.handlerParams=y,i.handlerGenerator=m,delete this.model[e],w.init?.(_(b({},y),{source:"init",model:null})),this.destroyBean(v),C!=null&&this.beans.filterManager?.onFilterChanged({columns:[o],source:t})}else{let v=this.createHandlerParams(o,p?.params);i.handlerParams=v,i.handler.refresh?.(_(b({},v),{source:"colDef",model:C}))}}if(this.areFilterCompsDifferent(i.filterUi?.compDetails??null,p)||!i.filterUi||!p){this.destroyFilterUi(i,o,p,g);return}i.filterUi.filterParams=f,Vo(i,h)?.then(m=>{(m?.refresh?m.refresh(f):!0)===!1?this.destroyFilterUi(i,o,p,g):this.dispatchLocalEvent({type:"filterParamsChanged",column:o,params:f})})}refreshHandlerAndUi(e,t,i,n,o){let s=this.cachedFilter(e);if(!s)return n&&this.getOrCreateFilterWrapper(e,!0),nt.resolve();if(!s.isHandler)return nt.resolve();let{filterUi:r,handler:a,handlerParams:l}=s;return jB(()=>{if(r){let{created:d,filterParams:c}=r;if(d)return r.promise.then(u=>u?{filter:u,filterParams:c}:void 0);r.refreshed=!0}return nt.resolve(void 0)},a,l,t,this.state.get(e.getColId())??{model:t},i,o)}setColumnFilterWrapper(e,t){let i=e.getColId();this.allColumnFilters.set(i,t),this.allColumnListeners.set(i,this.addManagedListeners(e,{colDefChanged:()=>this.filterParamsChanged(i)})[0])}areFilterCompsDifferent(e,t){if(!t||!e)return!0;let{componentClass:i}=e,{componentClass:n}=t;return!(i===n||i?.render&&n?.render&&i.render===n.render)}hasFloatingFilters(){return this.beans.colModel.getCols().some(t=>t.getColDef().floatingFilter)}getFilterInstance(e){let t=this.beans.colModel.getColDefCol(e);if(!t)return Promise.resolve(void 0);let i=this.getOrCreateFilterUi(t);return i?new Promise(n=>{i.then(o=>{n(ud(o))})}):Promise.resolve(null)}processFilterModelUpdateQueue(){this.modelUpdates.forEach(({model:e,source:t})=>this.setModel(e,t)),this.modelUpdates=[],this.columnModelUpdates.forEach(({key:e,model:t,resolve:i})=>{this.setModelForColumn(e,t).then(()=>i())}),this.columnModelUpdates=[]}getModelForColumn(e,t){if(t){let{state:n,model:o}=this,s=e.getColId(),r=n.get(s);return r?r.model??null:Mt(o,s)}let i=this.cachedFilter(e);return i?this.getModelFromFilterWrapper(i):null}setModelForColumn(e,t){if(this.beans.dataTypeSvc?.isPendingInference){let i=()=>{},n=new Promise(o=>{i=o});return this.columnModelUpdates.push({key:e,model:t,resolve:i}),n}return new Promise(i=>{this.setModelForColumnLegacy(e,t).then(n=>i(n))})}getStateForColumn(e){return this.state.get(e)??{model:Mt(this.model,e)}}setModelForColumnLegacy(e,t){let i=this.beans.colModel.getColDefCol(e),n=i?this.getOrCreateFilterWrapper(i,!0):null;return n?this.setModelOnFilterWrapper(n,t):nt.resolve()}setColDefPropsForDataType(e,t,i){let n=e.filter,o=n===!0?this.getDefaultFilterFromDataType(()=>t.baseDataType):n;if(typeof o!="string")return;let s,r,a=this.beans,{filterParams:l,filterValueGetter:d}=e;o==="agMultiColumnFilter"?{filterParams:s,filterValueGetter:r}=a.multiFilter?.getParamsForDataType(l,d,t,i)??{}:{filterParams:s,filterValueGetter:r}=tH(o,l,d,t,i,a,this.getLocaleTextFunc()),e.filterParams=s,r&&(e.filterValueGetter=r)}setColFilterActive(e,t,i,n){e.filterActive!==t&&(e.filterActive=t,e.dispatchColEvent("filterActiveChanged",i)),e.dispatchColEvent("filterChanged",i,n)}setModelOnFilterWrapper(e,t,i){return new nt(n=>{if(e.isHandler){let s=e.column,r=s.getColId(),a=this.model[r];if(this.updateStoredModel(r,t),i&&t===a){n();return}this.refreshHandlerAndUi(s,t,"api").then(()=>n());return}let o=Vo(e);if(o){o.then(s=>{if(typeof s?.setModel!="function"){I(65),n();return}(s.setModel(t)||nt.resolve()).then(()=>n())});return}n()})}updateStoredModel(e,t){q(t)?this.model[e]=t:delete this.model[e];let i=this.state.get(e),n={model:t,state:i?.state};this.state.set(e,n)}filterModified(e,t){this.getOrCreateFilterUi(e)?.then(i=>{this.eventSvc.dispatchEvent(b({type:"filterModified",column:e,filterInstance:i},t))})}filterUiChanged(e,t){this.gos.get("enableFilterHandlers")&&this.eventSvc.dispatchEvent(b({type:"filterUiChanged",column:e},t))}floatingFilterUiChanged(e,t){this.gos.get("enableFilterHandlers")&&this.eventSvc.dispatchEvent(b({type:"floatingFilterUiChanged",column:e},t))}updateModel(e,t,i){let n=e.getColId(),o=this.cachedFilter(e),s=()=>o?.filterUi;VE(t,s,()=>Mt(this.model,n),()=>this.state.get(n),r=>this.updateState(e,r),r=>s()?.filterParams?.onModelChange(r,i),o?.isHandler?o.handler.processModelToApply?.bind(o.handler):void 0)}updateAllModels(e,t){let i=[];this.allColumnFilters.forEach((n,o)=>{let s=this.beans.colModel.getColDefCol(o);s&&VE(e,()=>n.filterUi,()=>Mt(this.model,o),()=>this.state.get(o),r=>this.updateState(s,r),r=>{this.updateStoredModel(o,r),this.dispatchLocalEvent({type:"filterAction",column:s,action:e}),i.push(this.refreshHandlerAndUi(s,r,"ui"))},n?.isHandler?n.handler.processModelToApply?.bind(n.handler):void 0)}),i.length&&nt.all(i).then(()=>{this.callOnFilterChangedOutsideRenderCycle({source:"columnFilter",additionalEventAttributes:t,columns:[]})})}updateOrRefreshFilterUi(e){let t=e.getColId();p4(()=>this.cachedFilter(e)?.filterUi,()=>Mt(this.model,t),()=>this.state.get(t))}updateState(e,t){this.state.set(e.getColId(),t),this.dispatchLocalEvent({type:"filterStateChanged",column:e,state:t})}canApplyAll(){let{state:e,model:t,activeFilterComps:i}=this;for(let o of i)if(o.source==="COLUMN_MENU")return!1;let n=!1;for(let o of e.keys()){let s=e.get(o);if(s.valid===!1)return!1;(s.model??null)!==Mt(t,o)&&(n=!0)}return n}hasUnappliedModel(e){let{model:t,state:i}=this;return(i.get(e)?.model??null)!==Mt(t,e)}setGlobalButtons(e){this.isGlobalButtons=e,this.dispatchLocalEvent({type:"filterGlobalButtons",isGlobal:e})}shouldKeepStateOnDetach(e,t){if(t==="newFiltersToolPanel")return!0;let i=this.beans.filterPanelSvc;return i?.isActive?!!i.getState(e.getColId()):!1}destroy(){super.destroy(),this.allColumnFilters.forEach(e=>this.disposeFilterWrapper(e,"gridDestroyed")),this.allColumnListeners.clear(),this.state.clear(),this.activeFilterComps.clear()}};function fj(e){return!!e.filterManager?.isAnyFilterPresent()}function mj(e,t="api"){e.filterManager?.onFilterChanged({source:t})}var Cj=class extends D{constructor(){super(...arguments),this.beanName="filterManager",this.advFilterModelUpdateQueue=[]}wireBeans(e){this.quickFilter=e.quickFilter,this.advancedFilter=e.advancedFilter,this.colFilter=e.colFilter}postConstruct(){let e=this.refreshFiltersForAggregations.bind(this),t=this.updateAdvFilterColumns.bind(this);this.addManagedEventListeners({columnValueChanged:e,columnPivotChanged:e,columnPivotModeChanged:e,newColumnsLoaded:t,columnVisible:t,advancedFilterEnabledChanged:({enabled:n})=>this.onAdvFilterEnabledChanged(n),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.addManagedPropertyListeners(["isExternalFilterPresent","doesExternalFilterPass"],()=>{this.onFilterChanged({source:"api"})}),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",()=>{this.updateAggFiltering(),this.onFilterChanged()}),this.quickFilter&&this.addManagedListeners(this.quickFilter,{quickFilterChanged:()=>this.onFilterChanged({source:"quickFilter"})});let{gos:i}=this;this.alwaysPassFilter=i.get("alwaysPassFilter"),this.addManagedPropertyListener("alwaysPassFilter",()=>{this.alwaysPassFilter=i.get("alwaysPassFilter"),this.onFilterChanged({source:"api"})})}isExternalFilterPresentCallback(){let e=this.gos.getCallback("isExternalFilterPresent");return typeof e=="function"&&e({})}doesExternalFilterPass(e){let t=this.gos.get("doesExternalFilterPass");return typeof t=="function"&&t(e)}setFilterState(e,t,i="api"){this.isAdvFilterEnabled()||this.colFilter?.setState(e,t,i)}setFilterModel(e,t="api",i){if(this.isAdvFilterEnabled()){i||this.warnAdvFilters();return}this.colFilter?.setModel(e,t)}getFilterModel(){return this.colFilter?.getModel()??{}}getFilterState(){return this.colFilter?.getState()}isColumnFilterPresent(){return!!this.colFilter?.isFilterPresent()}isAggregateFilterPresent(){return!!this.colFilter?.isAggFilterPresent()}isChildFilterPresent(){return this.isColumnFilterPresent()||this.isQuickFilterPresent()||this.externalFilterPresent||this.isAdvFilterPresent()}isAnyFilterPresent(){return this.isChildFilterPresent()||this.isAggregateFilterPresent()}isAdvFilterPresent(){return this.isAdvFilterEnabled()&&this.advancedFilter.isFilterPresent()}onAdvFilterEnabledChanged(e){e?this.colFilter?.disableFilters()&&this.onFilterChanged({source:"advancedFilter"}):this.advancedFilter?.isFilterPresent()&&(this.advancedFilter.setModel(null),this.onFilterChanged({source:"advancedFilter"}))}isAdvFilterEnabled(){return!!this.advancedFilter?.isEnabled()}isAdvFilterHeaderActive(){return this.isAdvFilterEnabled()&&this.advancedFilter.isHeaderActive()}refreshFiltersForAggregations(){RC(this.gos)&&this.isAnyFilterPresent()&&this.onFilterChanged()}onFilterChanged(e={}){let{source:t,additionalEventAttributes:i,columns:n=[]}=e;this.externalFilterPresent=this.isExternalFilterPresentCallback(),(this.colFilter?this.colFilter.updateBeforeFilterChanged(e):nt.resolve()).then(()=>{let o={source:t,type:"filterChanged",columns:n};i&&ni(o,i),this.eventSvc.dispatchEvent(o),this.colFilter?.updateAfterFilterChanged()})}isSuppressFlashingCellsBecauseFiltering(){return!!this.colFilter?.isSuppressFlashingCellsBecauseFiltering()}isQuickFilterPresent(){return!!this.quickFilter?.isFilterPresent()}updateAggFiltering(){this.aggFiltering=!!RC(this.gos)}isAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&this.shouldApplyQuickFilterAfterAgg()}isNonAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&!this.shouldApplyQuickFilterAfterAgg()}shouldApplyQuickFilterAfterAgg(){return(this.aggFiltering||this.beans.colModel.isPivotMode())&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")}doesRowPassOtherFilters(e,t){return this.doesRowPassFilter({rowNode:t,colIdToSkip:e})}doesRowPassAggregateFilters(e){let{rowNode:t}=e;return this.alwaysPassFilter?.(t)?!0:!(this.isAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(t)||this.isAggregateFilterPresent()&&!this.colFilter.doFiltersPass(t,e.colIdToSkip,!0))}doesRowPassFilter(e){let{rowNode:t}=e;return this.alwaysPassFilter?.(t)?!0:!(this.isNonAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(t)||this.externalFilterPresent&&!this.doesExternalFilterPass(t)||this.isColumnFilterPresent()&&!this.colFilter.doFiltersPass(t,e.colIdToSkip)||this.isAdvFilterPresent()&&!this.advancedFilter.doesFilterPass(t))}isFilterAllowed(e){return this.isAdvFilterEnabled()?!1:!!this.colFilter?.isFilterAllowed(e)}getAdvFilterModel(){return this.isAdvFilterEnabled()?this.advancedFilter.getModel():null}setAdvFilterModel(e,t="api"){if(this.isAdvFilterEnabled()){if(this.beans.dataTypeSvc?.isPendingInference){this.advFilterModelUpdateQueue.push(e);return}this.advancedFilter.setModel(e??null),this.onFilterChanged({source:t})}}toggleAdvFilterBuilder(e,t){this.isAdvFilterEnabled()&&this.advancedFilter.getCtrl().toggleFilterBuilder({source:t,force:e})}updateAdvFilterColumns(){this.isAdvFilterEnabled()&&this.advancedFilter.updateValidity()&&this.onFilterChanged({source:"advancedFilter"})}hasFloatingFilters(){return this.isAdvFilterEnabled()?!1:!!this.colFilter?.hasFloatingFilters()}getColumnFilterInstance(e){return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve(void 0)):this.colFilter?.getFilterInstance(e)??Promise.resolve(void 0)}warnAdvFilters(){I(68)}setupAdvFilterHeaderComp(e){this.advancedFilter?.getCtrl().setupHeaderComp(e)}getHeaderRowCount(){return this.isAdvFilterHeaderActive()?1:0}getHeaderHeight(){return this.isAdvFilterHeaderActive()?this.advancedFilter.getCtrl().getHeaderHeight():0}processFilterModelUpdateQueue(){for(let e of this.advFilterModelUpdateQueue)this.setAdvFilterModel(e);this.advFilterModelUpdateQueue=[]}setColumnFilterModel(e,t){return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve()):this.colFilter?.setModelForColumn(e,t)??Promise.resolve()}},vj=class extends D{constructor(){super(...arguments),this.beanName="filterMenuFactory"}wireBeans(e){this.popupSvc=e.popupSvc}hideActiveMenu(){this.hidePopup?.()}showMenuAfterMouseEvent(e,t,i,n){e&&!e.isColumn||this.showPopup(e,o=>{this.popupSvc?.positionPopupUnderMouseEvent({column:e,type:i,mouseEvent:t,ePopup:o})},i,t.target,yi(this.gos),n)}showMenuAfterButtonClick(e,t,i,n){if(e&&!e.isColumn)return;let o=-1,s="left",r=yi(this.gos);!r&&this.gos.get("enableRtl")&&(o=1,s="right");let a=r?void 0:4*o,l=r?void 0:4;this.showPopup(e,d=>{this.popupSvc?.positionPopupByComponent({type:i,eventSource:t,ePopup:d,nudgeX:a,nudgeY:l,alignSide:s,keepWithinBounds:!0,position:"under",column:e})},i,t,r,n)}showPopup(e,t,i,n,o,s){let r=e?this.createBean(new ZB(e,"COLUMN_MENU")):void 0;if(this.activeMenu=r,!r?.hasFilter()||!e){Ge(57);return}let a=ft({tag:"div",cls:`ag-menu${o?"":" ag-filter-menu"}`,role:"presentation"});[this.tabListener]=this.addManagedElementListeners(a,{keydown:f=>this.trapFocusWithin(f,a)}),a.appendChild(r?.getGui());let l,d=()=>r?.afterGuiDetached(),c=CO(this.gos)?n??this.beans.ctrlsSvc.getGridBodyCtrl().eGridBody:void 0,u=f=>{YE(e,!1,"contextMenu");let m=f instanceof KeyboardEvent;this.tabListener&&(this.tabListener=this.tabListener()),m&&n&&Pn(n)&&Y6(n)?.focus({preventScroll:!0}),d(),this.destroyBean(this.activeMenu),this.dispatchVisibleChangedEvent(!1,i,e),s?.()},h=this.getLocaleTextFunc(),p=o&&i!=="columnFilter"?h("ariaLabelColumnMenu","Column Menu"):h("ariaLabelColumnFilter","Column Filter"),g=this.popupSvc?.addPopup({modal:!0,eChild:a,closeOnEsc:!0,closedCallback:u,positionCallback:()=>t(a),anchorToElement:c,ariaLabel:p});g&&(this.hidePopup=l=g.hideFunc),r.afterInit().then(()=>{t(a),r.afterGuiAttached({container:i,hidePopup:l})}),YE(e,!0,"contextMenu"),this.dispatchVisibleChangedEvent(!0,i,e)}trapFocusWithin(e,t){e.key!==R.TAB||e.defaultPrevented||Qs(this.beans,t,!1,e.shiftKey)||(e.preventDefault(),js(t,e.shiftKey))}dispatchVisibleChangedEvent(e,t,i){this.eventSvc.dispatchEvent({type:"columnMenuVisibleChanged",visible:e,switchingTab:!1,key:t,column:i??null,columnGroup:null})}isMenuEnabled(e){return e.isFilterAllowed()&&(e.getColDef().menuTabs??["filterMenuTab"]).includes("filterMenuTab")}showMenuAfterContextMenuEvent(){}destroy(){this.destroyBean(this.activeMenu),super.destroy()}},wj=class extends D{constructor(){super(...arguments),this.beanName="filterValueSvc"}getValue(e,t,i){if(!t)return;let n=e.getColDef(),{selectableFilter:o,valueSvc:s}=this.beans,r=i??o?.getFilterValueGetter(e.getColId())??n.filterValueGetter;return r?this.executeFilterValueGetter(r,t.data,e,t,n):s.getValue(e,t)}executeFilterValueGetter(e,t,i,n,o){let{expressionSvc:s,valueSvc:r}=this.beans,a=te(this.gos,{data:t,node:n,column:i,colDef:o,getValue:r.getValueCallback.bind(r,n)});return typeof e=="function"?e(a):s?.evaluate(e,a)}},bj={tag:"div",cls:"ag-floating-filter-input",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eFloatingFilterText"}]},yj=class extends Oe{constructor(){super(bj,[Fp]),this.eFloatingFilterText=V}init(e){this.params=e;let t=this.beans.colNames.getDisplayNameForColumn(e.column,"header",!0);if(this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(`${t} ${this.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`),this.gos.get("enableFilterHandlers")){let i=e,n=i.getHandler();if(n.getModelAsString){let o=n.getModelAsString(i.model);this.eFloatingFilterText.setValue(o)}}}onParentModelChanged(e){if(e==null){this.eFloatingFilterText.setValue("");return}this.params.parentFilterInstance(t=>{if(t.getModelAsString){let i=t.getModelAsString(e);this.eFloatingFilterText.setValue(i)}})}refresh(e){this.init(e)}},Gv=class{constructor(){this.customFilterOptions={}}init(e,t){this.filterOptions=e.filterOptions??t,this.mapCustomOptions(),this.defaultOption=this.getDefaultItem(e.defaultOption)}refresh(e,t){let i=e.filterOptions??t;this.filterOptions!==i&&(this.filterOptions=i,this.customFilterOptions={},this.mapCustomOptions()),this.defaultOption=this.getDefaultItem(e.defaultOption)}mapCustomOptions(){let{filterOptions:e}=this;if(e)for(let t of e){if(typeof t=="string")continue;let i=[["displayKey"],["displayName"],["predicate","test"]],n=o=>o.some(s=>t[s]!=null)?!0:(I(72,{keys:o}),!1);if(!i.every(n)){this.filterOptions=e.filter(o=>o===t)||[];continue}this.customFilterOptions[t.displayKey]=t}}getDefaultItem(e){let{filterOptions:t}=this;if(e)return e;if(t.length>=1){let i=t[0];if(typeof i=="string")return i;if(i.displayKey)return i.displayKey;I(73)}else I(74)}getCustomOption(e){return this.customFilterOptions[e]}};function id(e,t,i){return i==null?e.splice(t):e.splice(t,i)}function Pp(e){return e==null||typeof e=="string"&&e.trim().length===0}function Sj(e){return e==="AND"||e==="OR"?e:"AND"}function xj(e,t,i){if(e==null)return;let{predicate:n}=e;if(n!=null&&!t.some(o=>o==null))return n(t,i)}function Ej(e,t){let i=e.length;return i>t&&(e.splice(t),I(78),i=t),i}function fd(e,t){let i=t.getCustomOption(e);if(i){let{numberOfInputs:o}=i;return o??1}return e&&["empty","notBlank","blank"].indexOf(e)>=0?0:e==="inRange"?2:1}var Vv=class extends lH{constructor(e,t,i){super(e,"simple-filter"),this.mapValuesFromModel=t,this.defaultOptions=i,this.eTypes=[],this.eJoinPanels=[],this.eJoinAnds=[],this.eJoinOrs=[],this.eConditionBodies=[],this.listener=()=>this.onUiChanged(),this.lastUiCompletePosition=null,this.joinOperatorId=0}setParams(e){super.setParams(e);let t=new Gv;this.optionsFactory=t,t.init(e,this.defaultOptions),this.commonUpdateSimpleParams(e),this.createOption(),this.createMissingConditionsAndOperators()}updateParams(e,t){this.optionsFactory.refresh(e,this.defaultOptions),super.updateParams(e,t),this.commonUpdateSimpleParams(e)}commonUpdateSimpleParams(e){this.setNumConditions(e),this.defaultJoinOperator=Sj(e.defaultJoinOperator),this.filterPlaceholder=e.filterPlaceholder,this.createFilterListOptions();let t=this.getGui();this.isReadOnly()?t.setAttribute("tabindex","-1"):t.removeAttribute("tabindex")}onFloatingFilterChanged(e,t){this.setTypeFromFloatingFilter(e),this.setValueFromFloatingFilter(t),this.onUiChanged("immediately",!0)}setTypeFromFloatingFilter(e){this.eTypes.forEach((t,i)=>{let n=i===0?e:this.optionsFactory.defaultOption;t.setValue(n,!0)})}getModelFromUi(){let e=this.getUiCompleteConditions();return e.length===0?null:this.maxNumConditions>1&&e.length>1?{filterType:this.filterType,operator:this.getJoinOperator(),conditions:e}:e[0]}getConditionTypes(){return this.eTypes.map(e=>e.getValue())}getConditionType(e){return this.eTypes[e].getValue()}getJoinOperator(){let{eJoinOrs:e,defaultJoinOperator:t}=this;return e.length===0?t:e[0].getValue()===!0?"OR":"AND"}areNonNullModelsEqual(e,t){let i=!e.operator,n=!t.operator;if(!i&&n||i&&!n)return!1;let s;if(i){let r=e,a=t;s=this.areSimpleModelsEqual(r,a)}else{let r=e,a=t;s=r.operator===a.operator&&Zo(r.conditions,a.conditions,(l,d)=>this.areSimpleModelsEqual(l,d))}return s}setModelIntoUi(e,t){if(e==null)return this.resetUiToDefaults(t),nt.resolve();if(e.operator){let n=e,o=n.conditions;o==null&&(o=[],I(77));let s=Ej(o,this.maxNumConditions),r=this.getNumConditions();if(s<r)this.removeConditionsAndOperators(s);else if(s>r)for(let l=r;l<s;l++)this.createJoinOperatorPanel(),this.createOption();let a=n.operator==="OR";this.eJoinAnds.forEach(l=>l.setValue(!a,!0)),this.eJoinOrs.forEach(l=>l.setValue(a,!0)),o.forEach((l,d)=>{this.eTypes[d].setValue(l.type,!0),this.setConditionIntoUi(l,d)})}else{let n=e;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(n.type,!0),this.setConditionIntoUi(n,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.updateUiVisibility(),t||this.params.onUiChange(this.getUiChangeEventParams()),nt.resolve()}setNumConditions(e){let t=e.maxNumConditions??2;t<1&&(I(79),t=1),this.maxNumConditions=t;let i=e.numAlwaysVisibleConditions??1;i<1&&(I(80),i=1),i>t&&(I(81),i=t),this.numAlwaysVisibleConditions=i}createOption(){let e=this.getGui(),t=this.createManagedBean(new vv);this.eTypes.push(t),t.addCss("ag-filter-select"),e.appendChild(t.getGui());let i=this.createEValue();this.eConditionBodies.push(i),e.appendChild(i),this.putOptionsIntoDropdown(t),this.resetType(t);let n=this.getNumConditions()-1;this.forEachPositionInput(n,o=>this.resetInput(o)),this.addChangedListeners(t,n)}createJoinOperatorPanel(){let e=ft({tag:"div",cls:"ag-filter-condition"});this.eJoinPanels.push(e);let t=this.createJoinOperator(this.eJoinAnds,e,"and"),i=this.createJoinOperator(this.eJoinOrs,e,"or");this.getGui().appendChild(e);let n=this.eJoinPanels.length-1,o=this.joinOperatorId++;this.resetJoinOperatorAnd(t,n,o),this.resetJoinOperatorOr(i,n,o),this.isReadOnly()||(t.onValueChange(this.listener),i.onValueChange(this.listener))}createJoinOperator(e,t,i){let n=this.createManagedBean(new HN);e.push(n);let o="ag-filter-condition-operator";return n.addCss(o),n.addCss(`${o}-${i}`),t.appendChild(n.getGui()),n}createFilterListOptions(){this.filterListOptions=this.optionsFactory.filterOptions.map(e=>typeof e=="string"?this.createBoilerplateListOption(e):this.createCustomListOption(e))}putOptionsIntoDropdown(e){let{filterListOptions:t}=this;for(let i of t)e.addOption(i);e.setDisabled(t.length<=1)}createBoilerplateListOption(e){return{value:e,text:this.translate(e)}}createCustomListOption(e){let{displayKey:t}=e,i=this.optionsFactory.getCustomOption(e.displayKey);return{value:t,text:i?this.getLocaleTextFunc()(i.displayKey,i.displayName):this.translate(t)}}createBodyTemplate(){return null}getAgComponents(){return[]}updateUiVisibility(){let e=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,e)}updateNumConditions(){let e=-1,t=!0;for(let i=0;i<this.getNumConditions();i++)this.isConditionUiComplete(i)?e=i:t=!1;if(this.shouldAddNewConditionAtEnd(t))this.createJoinOperatorPanel(),this.createOption();else{let i=this.lastUiCompletePosition??this.getNumConditions()-2;if(e<i){this.removeConditionsAndOperators(i+1);let n=e+1,o=i-n;o>0&&this.removeConditionsAndOperators(n,o),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=e}updateConditionStatusesAndValues(e,t){this.eTypes.forEach((n,o)=>{let s=this.isConditionDisabled(o,e);n.setDisabled(s||this.filterListOptions.length<=1),o===1&&(sd(this.eJoinPanels[0],s),this.eJoinAnds[0].setDisabled(s),this.eJoinOrs[0].setDisabled(s))}),this.eConditionBodies.forEach((n,o)=>{Je(n,this.isConditionBodyVisible(o))});let i=(t??this.getJoinOperator())==="OR";for(let n of this.eJoinAnds)n.setValue(!i,!0);for(let n of this.eJoinOrs)n.setValue(i,!0);this.forEachInput((n,o,s,r)=>{this.setElementDisplayed(n,o<r),this.setElementDisabled(n,this.isConditionDisabled(s,e))}),this.resetPlaceholder()}shouldAddNewConditionAtEnd(e){return e&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}removeConditionsAndOperators(e,t){if(e>=this.getNumConditions())return;let{eTypes:i,eConditionBodies:n,eJoinPanels:o,eJoinAnds:s,eJoinOrs:r}=this;this.removeComponents(i,e,t),this.removeElements(n,e,t),this.removeEValues(e,t);let a=Math.max(e-1,0);this.removeElements(o,a,t),this.removeComponents(s,a,t),this.removeComponents(r,a,t)}removeElements(e,t,i){let n=id(e,t,i);for(let o of n)hi(o)}removeComponents(e,t,i){let n=id(e,t,i);for(let o of n)hi(o.getGui()),this.destroyBean(o)}afterGuiAttached(e){if(super.afterGuiAttached(e),this.resetPlaceholder(),!e?.suppressFocus){let t;if(!this.isReadOnly()){let i=this.getInputs(0)[0];i instanceof Ns&&this.isConditionBodyVisible(0)?t=i.getInputElement():t=this.eTypes[0]?.getFocusableElement()}(t??this.getGui()).focus({preventScroll:!0})}}afterGuiDetached(){super.afterGuiDetached();let e=this.params;if(this.beans.colFilter?.shouldKeepStateOnDetach(e.column))return;e.onStateChange({model:e.model});let t=-1,i=-1,n=!1,o=this.getJoinOperator();for(let r=this.getNumConditions()-1;r>=0;r--)if(this.isConditionUiComplete(r))t===-1&&(t=r,i=r);else{let a=r>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(r-1),l=r<t;(a||l)&&(this.removeConditionsAndOperators(r,1),n=!0,l&&i--)}let s=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),s=!0),this.shouldAddNewConditionAtEnd(i===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),s=!0),s&&this.updateConditionStatusesAndValues(i,o),n&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=i}getModelAsString(e){return this.params.getHandler()?.getModelAsString?.(e)??""}getPlaceholderText(e,t){let i=this.translate(e);if(typeof this.filterPlaceholder=="function"){let n=this.eTypes[t].getValue(),o=this.translate(n);i=this.filterPlaceholder({filterOptionKey:n,filterOption:o,placeholder:i})}else typeof this.filterPlaceholder=="string"&&(i=this.filterPlaceholder);return i}resetPlaceholder(){let e=this.getLocaleTextFunc();this.forEachInput((t,i,n,o)=>{if(!(t instanceof Ns))return;let s=i===0&&o>1?"inRangeStart":i===0?"filterOoo":"inRangeEnd",r=i===0&&o>1?e("ariaFilterFromValue","Filter from value"):i===0?e("ariaFilterValue","Filter Value"):e("ariaFilterToValue","Filter to Value");t.setInputPlaceholder(this.getPlaceholderText(s,n)),t.setInputAriaLabel(r)})}setElementValue(e,t,i){e instanceof Ns&&e.setValue(t!=null?String(t):null,!0)}setElementDisplayed(e,t){FE(e)&&Je(e.getGui(),t)}setElementDisabled(e,t){FE(e)&&sd(e.getGui(),t)}attachElementOnChange(e,t){e instanceof Ns&&e.onValueChange(t)}forEachInput(e){this.getConditionTypes().forEach((t,i)=>{this.forEachPositionTypeInput(i,t,e)})}forEachPositionInput(e,t){let i=this.getConditionType(e);this.forEachPositionTypeInput(e,i,t)}forEachPositionTypeInput(e,t,i){let n=fd(t,this.optionsFactory),o=this.getInputs(e);for(let s=0;s<o.length;s++){let r=o[s];r!=null&&i(r,s,e,n)}}isConditionDisabled(e,t){return this.isReadOnly()?!0:e===0?!1:e>t+1}isConditionBodyVisible(e){let t=this.getConditionType(e);return fd(t,this.optionsFactory)>0}isConditionUiComplete(e){return!(e>=this.getNumConditions()||this.getConditionType(e)==="empty"||this.getValues(e).some(i=>i==null))}getNumConditions(){return this.eTypes.length}getUiCompleteConditions(){let e=[];for(let t=0;t<this.getNumConditions();t++)this.isConditionUiComplete(t)&&e.push(this.createCondition(t));return e}createMissingConditionsAndOperators(){if(!this.isReadOnly())for(let e=this.getNumConditions();e<this.numAlwaysVisibleConditions;e++)this.createJoinOperatorPanel(),this.createOption()}resetUiToDefaults(e){this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach(t=>this.resetType(t)),this.eJoinAnds.forEach((t,i)=>this.resetJoinOperatorAnd(t,i,this.joinOperatorId+i)),this.eJoinOrs.forEach((t,i)=>this.resetJoinOperatorOr(t,i,this.joinOperatorId+i)),this.joinOperatorId++,this.forEachInput(t=>this.resetInput(t)),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,this.updateUiVisibility(),e||this.params.onUiChange(this.getUiChangeEventParams())}resetType(e){let i=this.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");e.setValue(this.optionsFactory.defaultOption,!0).setAriaLabel(i).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}resetJoinOperatorAnd(e,t,i){this.resetJoinOperator(e,t,this.defaultJoinOperator==="AND",this.translate("andCondition"),i)}resetJoinOperatorOr(e,t,i){this.resetJoinOperator(e,t,this.defaultJoinOperator==="OR",this.translate("orCondition"),i)}resetJoinOperator(e,t,i,n,o){this.updateJoinOperatorDisabled(e.setValue(i,!0).setName(`ag-simple-filter-and-or-${this.getCompId()}-${o}`).setLabel(n),t)}updateJoinOperatorsDisabled(){let e=(t,i)=>this.updateJoinOperatorDisabled(t,i);this.eJoinAnds.forEach(e),this.eJoinOrs.forEach(e)}updateJoinOperatorDisabled(e,t){e.setDisabled(this.isReadOnly()||t>0)}resetInput(e){this.setElementValue(e,null),this.setElementDisabled(e,this.isReadOnly())}setConditionIntoUi(e,t){let i=this.mapValuesFromModel(e,this.optionsFactory);this.forEachInput((n,o,s)=>{s===t&&this.setElementValue(n,i[o]!=null?i[o]:null)})}setValueFromFloatingFilter(e){this.forEachInput((t,i,n)=>{this.setElementValue(t,i===0&&n===0?e:null,!0)})}addChangedListeners(e,t){this.isReadOnly()||(e.onValueChange(this.listener),this.forEachPositionInput(t,i=>{this.attachElementOnChange(i,this.listener)}))}hasInvalidInputs(){return!1}isReadOnly(){return!!this.params.readOnly}},yP=class{constructor(e,t,i,n,o,s){this.alive=!0,this.context=e,this.eParent=o;let r=bN(t,i,n);r&&r.newAgStackInstance().then(a=>{if(!this.alive){e.destroyBean(a);return}if(this.dateComp=a,!a)return;o.appendChild(a.getGui()),a?.afterGuiAttached?.();let{tempValue:l,disabled:d}=this;l&&a.setDate(l),d!=null&&a.setDisabled?.(d),s?.(this)})}destroy(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)}getDate(){return this.dateComp?this.dateComp.getDate():this.tempValue}setDate(e){let t=this.dateComp;t?t.setDate(e):this.tempValue=e}setDisabled(e){let t=this.dateComp;t?t.setDisabled?.(e):this.disabled=e}setDisplayed(e){Je(this.eParent,e)}setInputPlaceholder(e){this.dateComp?.setInputPlaceholder?.(e)}setInputAriaLabel(e){this.dateComp?.setInputAriaLabel?.(e)}afterGuiAttached(e){this.dateComp?.afterGuiAttached?.(e)}updateParams(e){this.dateComp?.refresh?.(e)}},zv=["equals","notEqual","lessThan","greaterThan","inRange","blank","notBlank"];function SP(e,t){let{dateFrom:i,dateTo:n,type:o}=e||{};return[i&&pi(i,void 0,!0)||null,n&&pi(n,void 0,!0)||null].slice(0,fd(o,t))}var FR=1e3,TR=1/0,Rj=class extends Vv{constructor(){super("dateFilter",SP,zv),this.eConditionPanelsFrom=[],this.eConditionPanelsTo=[],this.dateConditionFromComps=[],this.dateConditionToComps=[],this.minValidYear=FR,this.maxValidYear=TR,this.minValidDate=null,this.maxValidDate=null,this.filterType="date"}afterGuiAttached(e){super.afterGuiAttached(e),this.dateConditionFromComps[0].afterGuiAttached(e)}commonUpdateSimpleParams(e){super.commonUpdateSimpleParams(e);let t=(l,d)=>{let c=e[l];if(c!=null)if(isNaN(c))I(82,{param:l});else return c==null?d:Number(c);return d},i=t("minValidYear",FR),n=t("maxValidYear",TR);this.minValidYear=i,this.maxValidYear=n,i>n&&I(83);let{minValidDate:o,maxValidDate:s}=e,r=o instanceof Date?o:pi(o);this.minValidDate=r;let a=s instanceof Date?s:pi(s);this.maxValidDate=a,r&&a&&r>a&&I(84)}createDateCompWrapper(e){let{beans:{userCompFactory:t,context:i,gos:n},params:o}=this,s=new yP(i,t,o.colDef,te(n,{onDateChanged:()=>this.onUiChanged(),filterParams:o,location:"filter"}),e);return this.addDestroyFunc(()=>s.destroy()),s}setElementValue(e,t){e.setDate(t)}setElementDisplayed(e,t){e.setDisplayed(t)}setElementDisabled(e,t){e.setDisabled(t)}createEValue(){let e=ft({tag:"div",cls:"ag-filter-body"});return this.createFromToElement(e,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(e,this.eConditionPanelsTo,this.dateConditionToComps,"to"),e}createFromToElement(e,t,i,n){let o=ft({tag:"div",cls:`ag-filter-${n} ag-filter-date-${n}`});t.push(o),e.appendChild(o),i.push(this.createDateCompWrapper(o))}removeEValues(e,t){this.removeDateComps(this.dateConditionFromComps,e,t),this.removeDateComps(this.dateConditionToComps,e,t),id(this.eConditionPanelsFrom,e,t),id(this.eConditionPanelsTo,e,t)}removeDateComps(e,t,i){let n=id(e,t,i);for(let o of n)o.destroy()}isValidDateValue(e){if(e===null)return!1;let{minValidDate:t,maxValidDate:i,minValidYear:n,maxValidYear:o}=this;if(t){if(e<t)return!1}else if(e.getUTCFullYear()<n)return!1;if(i){if(e>i)return!1}else if(e.getUTCFullYear()>o)return!1;return!0}isConditionUiComplete(e){if(!super.isConditionUiComplete(e))return!1;let t=!0;return this.forEachInput((i,n,o,s)=>{o!==e||!t||n>=s||(t=t&&this.isValidDateValue(i.getDate()))}),t}areSimpleModelsEqual(e,t){return e.dateFrom===t.dateFrom&&e.dateTo===t.dateTo&&e.type===t.type}createCondition(e){let t=this.getConditionType(e),i={},n=this.getValues(e),o=this.params.useIsoSeparator?"T":" ";return n.length>0&&(i.dateFrom=Si(n[0],!0,o)),n.length>1&&(i.dateTo=Si(n[1],!0,o)),b({dateFrom:null,dateTo:null,filterType:this.filterType,type:t},i)}resetPlaceholder(){let e=this.getLocaleTextFunc(),t=this.translate("dateFormatOoo"),i=e("ariaFilterValue","Filter Value");this.forEachInput(n=>{n.setInputPlaceholder(t),n.setInputAriaLabel(i)})}getInputs(e){let{dateConditionFromComps:t,dateConditionToComps:i}=this;return e>=t.length?[null,null]:[t[e],i[e]]}getValues(e){let t=[];return this.forEachPositionInput(e,(i,n,o,s)=>{n<s&&t.push(i.getDate())}),t}translate(e){return e==="lessThan"?super.translate("before"):e==="greaterThan"?super.translate("after"):super.translate(e)}},xP=class extends D{constructor(e,t){super(),this.mapValuesFromModel=e,this.defaultOptions=t}init(e){let t=e.filterParams,i=new Gv;this.optionsFactory=i,i.init(t,this.defaultOptions),this.filterModelFormatter=this.createManagedBean(new this.FilterModelFormatterClass(i,t)),this.updateParams(e),this.validateModel(e)}refresh(e){if(e.source==="colDef"){let t=e.filterParams,i=this.optionsFactory;i.refresh(t,this.defaultOptions),this.filterModelFormatter.updateParams({optionsFactory:i,filterParams:t}),this.updateParams(e)}this.validateModel(e)}updateParams(e){this.params=e}doesFilterPass(e){let t=e.model;if(t==null)return!0;let{operator:i}=t,n=[];if(i){let r=t;n.push(...r.conditions??[])}else n.push(t);let o=i&&i==="OR"?"some":"every",s=this.params.getValue(e.node);return n[o](r=>this.individualConditionPasses(e,r,s))}getModelAsString(e,t){return this.filterModelFormatter.getModelAsString(e,t)??""}validateModel(e){let{model:t,filterParams:{filterOptions:i,maxNumConditions:n}}=e;if(t==null)return;let s=m4(t)?t.conditions:[t],r=i?.map(c=>typeof c=="string"?c:c.displayKey)??this.defaultOptions;if(!(!s||s.every(c=>r.find(u=>u===c.type)!==void 0))){this.params=_(b({},e),{model:null}),e.onModelChange(null);return}let l=!1,d=this.filterType;if((s&&!s.every(c=>c.filterType===d)||t.filterType!==d)&&(s=s.map(c=>_(b({},c),{filterType:d})),l=!0),typeof n=="number"&&s&&s.length>n&&(s=s.slice(0,n),l=!0),l){let c=s.length>1?_(b({},t),{filterType:d,conditions:s}):_(b({},s[0]),{filterType:d});this.params=_(b({},e),{model:c}),e.onModelChange(c)}}individualConditionPasses(e,t,i){let n=this.optionsFactory,o=this.mapValuesFromModel(t,n),s=n.getCustomOption(t.type),r=xj(s,o,i);return r??(i==null?this.evaluateNullValue(t.type):this.evaluateNonNullValue(o,i,t,e))}},EP=class extends xP{evaluateNullValue(e){let{includeBlanksInEquals:t,includeBlanksInNotEqual:i,includeBlanksInGreaterThan:n,includeBlanksInLessThan:o,includeBlanksInRange:s}=this.params.filterParams;switch(e){case"equals":if(t)return!0;break;case"notEqual":if(i)return!0;break;case"greaterThan":case"greaterThanOrEqual":if(n)return!0;break;case"lessThan":case"lessThanOrEqual":if(o)return!0;break;case"inRange":if(s)return!0;break;case"blank":return!0;case"notBlank":return!1}return!1}evaluateNonNullValue(e,t,i){let n=i.type;if(!this.isValid(t))return n==="notEqual"||n==="notBlank";let o=this.comparator(),s=e[0]!=null?o(e[0],t):0;switch(n){case"equals":return s===0;case"notEqual":return s!==0;case"greaterThan":return s>0;case"greaterThanOrEqual":return s>=0;case"lessThan":return s<0;case"lessThanOrEqual":return s<=0;case"inRange":{let r=o(e[1],t);return this.params.filterParams.inRangeInclusive?s>=0&&r<=0:s>0&&r<0}case"blank":return Pp(t);case"notBlank":return!Pp(t);default:return I(76,{filterModelType:n}),!0}}},RP={equals:"Equals",notEqual:"NotEqual",greaterThan:"GreaterThan",greaterThanOrEqual:"GreaterThanOrEqual",lessThan:"LessThan",lessThanOrEqual:"LessThanOrEqual",inRange:"InRange"},Pj={contains:"Contains",notContains:"NotContains",equals:"TextEquals",notEqual:"TextNotEqual",startsWith:"StartsWith",endsWith:"EndsWith",inRange:"InRange"},Wv=class extends D{constructor(e,t,i){super(),this.optionsFactory=e,this.filterParams=t,this.valueFormatter=i}getModelAsString(e,t){let i=this.getLocaleTextFunc(),n=t==="filterToolPanel";if(!e)return n?$o(this,"filterSummaryInactive"):null;if(e.operator!=null){let s=e,a=(s.conditions??[]).map(d=>this.getModelAsString(d,t)),l=s.operator==="AND"?"andCondition":"orCondition";return a.join(` ${$o(this,l)} `)}else{if(e.type==="blank"||e.type==="notBlank")return n?$o(this,e.type==="blank"?"filterSummaryBlank":"filterSummaryNotBlank"):i(e.type,e.type);{let s=e,r=this.optionsFactory.getCustomOption(s.type),{displayKey:a,displayName:l,numberOfInputs:d}=r||{};return a&&l&&d===0?i(a,l):this.conditionToString(s,n,s.type==="inRange"||d===2,a,l)}}}updateParams(e){let{optionsFactory:t,filterParams:i}=e;this.optionsFactory=t,this.filterParams=i}conditionForToolPanel(e,t,i,n,o,s){let r,a=this.getTypeKey(e);return a&&(r=$o(this,a)),o&&s&&(r=this.getLocaleTextFunc()(o,s)),r!=null?t?`${r} ${$o(this,"filterSummaryInRangeValues",[i(),n()])}`:`${r} ${i()}`:null}getTypeKey(e){let t=this.filterTypeKeys[e];return t?`filterSummary${t}`:null}formatValue(e){let t=this.valueFormatter;return t?t(e??null)??"":String(e)}},PP=class extends Wv{constructor(e,t){super(e,t,i=>{let{dataTypeSvc:n,valueSvc:o}=this.beans,s=t.column,r=n?.getDateFormatterFunction(s),a=r?r(i??void 0):i;return o.formatValue(s,null,a)}),this.filterTypeKeys=RP}conditionToString(e,t,i,n,o){let{type:s}=e,r=pi(e.dateFrom),a=pi(e.dateTo),l=this.filterParams.inRangeFloatingFilterDateFormat,d=t?this.formatValue.bind(this):h=>TC(h,l),c=()=>r!==null?d(r):"null",u=()=>a!==null?d(a):"null";if(t){let h=this.conditionForToolPanel(s,i,c,u,n,o);if(h!=null)return h}return i?`${c()}-${u()}`:r!=null?d(r):`${s}`}};function Mj(e,t){let i=t;return i<e?-1:i>e?1:0}var kj=class extends EP{constructor(){super(SP,zv),this.filterType="date",this.FilterModelFormatterClass=PP}comparator(){return this.params.filterParams.comparator??Mj}isValid(e){let t=this.params.filterParams.isValidDate;return!t||t(e)}},MP=class extends Oe{constructor(){super(...arguments),this.defaultDebounceMs=0}setLastTypeFromModel(e){if(!e){this.lastType=this.optionsFactory.defaultOption;return}let t=e.operator,i;t?i=e.conditions[0]:i=e,this.lastType=i.type}canWeEditAfterModelFromParentFilter(e){if(!e)return this.isTypeEditable(this.lastType);if(e.operator)return!1;let i=e;return this.isTypeEditable(i.type)}init(e){this.params=e;let t=this.gos.get("enableFilterHandlers");if(this.reactive=t,this.setParams(e),t){let i=e;this.onModelUpdated(i.model)}}setParams(e){let t=new Gv;this.optionsFactory=t,t.init(e.filterParams,this.defaultOptions),this.filterModelFormatter=this.createManagedBean(new this.FilterModelFormatterClass(t,e.filterParams)),this.setSimpleParams(e,!1)}setSimpleParams(e,t=!0){let i=this.optionsFactory.defaultOption;t||(this.lastType=i),this.readOnly=!!e.filterParams.readOnly;let n=this.isTypeEditable(i);this.setEditable(n)}refresh(e){this.params=e;let t=e,i=this.reactive;if((!i||t.source==="colDef")&&this.updateParams(e),i){let{source:n,model:o}=t;if(n==="dataChanged"||n==="ui")return;this.onModelUpdated(o)}}updateParams(e){let t=this.optionsFactory;t.refresh(e.filterParams,this.defaultOptions),this.setSimpleParams(e),this.filterModelFormatter.updateParams({optionsFactory:t,filterParams:e.filterParams})}onParentModelChanged(e,t){t?.afterFloatingFilter||t?.afterDataChange||this.onModelUpdated(e)}hasSingleInput(e){let t=this.optionsFactory.getCustomOption(e)?.numberOfInputs;return t==null||t==1}isTypeEditable(e){let t=["inRange","empty","blank","notBlank"];return!!e&&!this.readOnly&&this.hasSingleInput(e)&&t.indexOf(e)<0}getAriaLabel(e){return`${this.beans.colNames.getDisplayNameForColumn(e.column,"header",!0)} ${this.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`}},Dj={tag:"div",cls:"ag-floating-filter-input",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eReadOnlyText"},{tag:"div",ref:"eDateWrapper",cls:"ag-date-floating-filter-wrapper"}]},Fj=class extends MP{constructor(){super(Dj,[Fp]),this.eReadOnlyText=V,this.eDateWrapper=V,this.FilterModelFormatterClass=PP,this.filterType="date",this.defaultOptions=zv}setParams(e){super.setParams(e),this.createDateComponent();let t=this.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(t("ariaDateFilterInput","Date Filter Input"))}updateParams(e){super.updateParams(e),this.dateComp.updateParams(this.getDateComponentParams()),this.updateCompOnModelChange(e.currentParentModel())}updateCompOnModelChange(e){let t=!this.readOnly&&this.canWeEditAfterModelFromParentFilter(e);if(this.setEditable(t),t){let i=e?pi(e.dateFrom):null;this.dateComp.setDate(i),this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(e)),this.dateComp.setDate(null)}setEditable(e){Je(this.eDateWrapper,e),Je(this.eReadOnlyText.getGui(),!e)}onModelUpdated(e){super.setLastTypeFromModel(e),this.updateCompOnModelChange(e)}onDateChanged(){let e=this.dateComp.getDate();if(this.reactive){let t=this.params;t.onUiChange();let i=t.model,n=Si(e),o=n==null?null:_(b({},i??{filterType:this.filterType,type:this.lastType??this.optionsFactory.defaultOption}),{dateFrom:n});t.onModelChange(o,{afterFloatingFilter:!0})}else this.params.parentFilterInstance(t=>{t?.onFloatingFilterChanged(this.lastType||null,e)})}getDateComponentParams(){let{filterParams:e}=this.params,t=xv(e,this.defaultDebounceMs);return te(this.gos,{onDateChanged:_t(this,this.onDateChanged.bind(this),t),filterParams:e,location:"floatingFilter"})}createDateComponent(){let{beans:{context:e,userCompFactory:t},eDateWrapper:i,params:n}=this;this.dateComp=new yP(e,t,n.column.getColDef(),this.getDateComponentParams(),i,o=>{o.setInputAriaLabel(this.getAriaLabel(n))}),this.addDestroyFunc(()=>this.dateComp.destroy())}},Tj={tag:"div",cls:"ag-filter-filter",children:[{tag:"ag-input-text-field",ref:"eDateInput",cls:"ag-date-filter"}]},Aj=class extends Oe{constructor(){super(Tj,[Fp]),this.eDateInput=V,this.isApply=!1,this.applyOnFocusOut=!1}init(e){this.params=e,this.setParams(e);let t=this.eDateInput.getInputElement();this.addManagedListeners(t,{mouseDown:()=>{this.eDateInput.isDisabled()||this.usingSafariDatePicker||t.focus({preventScroll:!0})},input:this.handleInput.bind(this,!1),change:this.handleInput.bind(this,!0),focusout:this.handleFocusOut.bind(this)})}handleInput(e){if(!this.eDateInput.isDisabled()){if(this.isApply){this.applyOnFocusOut=!e,e&&this.params.onDateChanged();return}e||this.params.onDateChanged()}}handleFocusOut(){this.applyOnFocusOut&&(this.applyOnFocusOut=!1,this.params.onDateChanged())}setParams(e){let t=this.eDateInput.getInputElement(),i=this.shouldUseBrowserDatePicker(e);this.usingSafariDatePicker=i&&es();let{minValidYear:n,maxValidYear:o,minValidDate:s,maxValidDate:r,buttons:a,includeTime:l,colDef:d}=e.filterParams||{},c=this.beans.dataTypeSvc,u=l??c?.getDateIncludesTimeFlag?.(d.cellDataType)??!1;if(i?u?(t.type="datetime-local",t.step="1"):t.type="date":t.type="text",s&&n&&I(85),r&&o&&I(86),s&&r){let[h,p]=[s,r].map(g=>g instanceof Date?g:pi(g));h&&p&&h.getTime()>p.getTime()&&I(87)}s?s instanceof Date?t.min=TC(s):t.min=s:n&&(t.min=`${n}-01-01`),r?r instanceof Date?t.max=TC(r):t.max=r:o&&(t.max=`${o}-12-31`),this.isApply=e.location==="floatingFilter"&&!!a?.includes("apply")}refresh(e){this.params=e,this.setParams(e)}getDate(){return pi(this.eDateInput.getValue())}setDate(e){let t=this.params.filterParams.colDef.cellDataType,i=this.beans.dataTypeSvc?.getDateIncludesTimeFlag(t)??!1;this.eDateInput.setValue(Si(e,i))}setInputPlaceholder(e){this.eDateInput.setInputPlaceholder(e)}setInputAriaLabel(e){this.eDateInput.setAriaLabel(e)}setDisabled(e){this.eDateInput.setDisabled(e)}afterGuiAttached(e){e?.suppressFocus||this.eDateInput.getInputElement().focus({preventScroll:!0})}shouldUseBrowserDatePicker(e){return e?.filterParams?.browserDatePicker??!0}},Uv=["equals","notEqual","greaterThan","greaterThanOrEqual","lessThan","lessThanOrEqual","inRange","blank","notBlank"];function XC(e){let{allowedCharPattern:t}=e??{};return t??null}function JC(e){return e==null||isNaN(e)?null:e}function kP(e,t){let{filter:i,filterTo:n,type:o}=e||{};return[JC(i),JC(n)].slice(0,fd(o,t))}var Ij=class extends Vv{constructor(){super("numberFilter",kP,Uv),this.eValuesFrom=[],this.eValuesTo=[],this.filterType="number",this.defaultDebounceMs=500}setElementValue(e,t,i){let{numberFormatter:n}=this.params,o=!i&&n?n(t??null):t;super.setElementValue(e,o)}createEValue(){let e=XC(this.params),t=ft({tag:"div",cls:"ag-filter-body",role:"presentation"});return this.createFromToElement(t,this.eValuesFrom,"from",e),this.createFromToElement(t,this.eValuesTo,"to",e),t}createFromToElement(e,t,i,n){let o=this.createManagedBean(n?new Zs({allowedCharPattern:n}):new Cv);o.addCss(`ag-filter-${i}`),o.addCss("ag-filter-filter"),t.push(o),e.appendChild(o.getGui())}removeEValues(e,t){let i=n=>this.removeComponents(n,e,t);i(this.eValuesFrom),i(this.eValuesTo)}getValues(e){let t=[];return this.forEachPositionInput(e,(i,n,o,s)=>{n<s&&t.push(JC(this.stringToFloat(i.getValue())))}),t}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}stringToFloat(e){if(typeof e=="number")return e;let t=ro(e);t!=null&&t.trim()===""&&(t=null);let i=this.params.numberParser;return i?i(t):t==null||t.trim()==="-"?null:Number.parseFloat(t)}createCondition(e){let t=this.getConditionType(e),i={filterType:this.filterType,type:t},n=this.getValues(e);return n.length>0&&(i.filter=n[0]),n.length>1&&(i.filterTo=n[1]),i}getInputs(e){let{eValuesFrom:t,eValuesTo:i}=this;return e>=t.length?[null,null]:[t[e],i[e]]}hasInvalidInputs(){let e=!1;return this.forEachInput(t=>{t.getInputElement().validity.valid||(e=!0)}),e}},DP=class extends Wv{constructor(e,t){super(e,t,t.numberFormatter),this.filterTypeKeys=RP}conditionToString(e,t,i,n,o){let{filter:s,filterTo:r,type:a}=e,l=this.formatValue.bind(this);if(t){let d=this.conditionForToolPanel(a,i,()=>l(s),()=>l(r),n,o);if(d!=null)return d}return i?`${l(s)}-${l(r)}`:s!=null?l(s):`${a}`}},Lj=class extends EP{constructor(){super(kP,Uv),this.filterType="number",this.FilterModelFormatterClass=DP}comparator(){return(e,t)=>e===t?0:e<t?1:-1}isValid(e){return!isNaN(e)}},FP=class extends D{constructor(e){super(),this.params=e,this.eInput=V,this.onValueChanged=()=>{}}setupGui(e){this.eInput=this.createManagedBean(new Zs(this.params?.config));let t=this.eInput.getGui();e.appendChild(t);let i=n=>this.onValueChanged(n);this.addManagedListeners(t,{input:i,keydown:i})}setEditable(e){this.eInput.setDisabled(!e)}getValue(){return this.eInput.getValue()}setValue(e,t){this.eInput.setValue(e,t)}setValueChangedListener(e){this.onValueChanged=e}setParams({ariaLabel:e,autoComplete:t}){let{eInput:i}=this;i.setInputAriaLabel(e),t!==void 0&&i.setAutoComplete(t)}};function QC(e){let t=e?.trim();return t===""?e:t}function TP(e,t){let{filter:i,filterTo:n,type:o}=e||{};return[i||null,n||null].slice(0,fd(o,t))}var _j={tag:"div",ref:"eFloatingFilterInputContainer",cls:"ag-floating-filter-input",role:"presentation"},AP=class extends MP{constructor(){super(...arguments),this.eFloatingFilterInputContainer=V,this.defaultDebounceMs=500}postConstruct(){this.setTemplate(_j)}onModelUpdated(e){this.setLastTypeFromModel(e),this.setEditable(this.canWeEditAfterModelFromParentFilter(e)),this.inputSvc.setValue(this.filterModelFormatter.getModelAsString(e))}setParams(e){this.setupFloatingFilterInputService(e),super.setParams(e),this.setTextInputParams(e)}setupFloatingFilterInputService(e){this.inputSvc=this.createFloatingFilterInputService(e),this.inputSvc.setupGui(this.eFloatingFilterInputContainer)}setTextInputParams(e){let t=e.browserAutoComplete??!1,{inputSvc:i,defaultDebounceMs:n,readOnly:o}=this;if(i.setParams({ariaLabel:this.getAriaLabel(e),autoComplete:t}),this.applyActive=Ap(e.filterParams),!o){let s=xv(e.filterParams,n),r=_t(this,this.syncUpWithParentFilter.bind(this),s);i.setValueChangedListener(r)}}updateParams(e){super.updateParams(e),this.setTextInputParams(e)}recreateFloatingFilterInputService(e){let{inputSvc:t}=this,i=t.getValue();Ot(this.eFloatingFilterInputContainer),this.destroyBean(t),this.setupFloatingFilterInputService(e),t.setValue(i,!0)}syncUpWithParentFilter(e){let t=e.key===R.ENTER,i=this.reactive;if(i&&this.params.onUiChange(),this.applyActive&&!t)return;let{inputSvc:n,params:o,lastType:s}=this,r=n.getValue();if(o.filterParams.trimInput&&(r=QC(r),n.setValue(r,!0)),i){let a=o,l=a.model,d=this.convertValue(r),c=d==null?null:_(b({},l??{filterType:this.filterType,type:s??this.optionsFactory.defaultOption}),{filter:d});a.onModelChange(c,{afterFloatingFilter:!0})}else o.parentFilterInstance(a=>{a?.onFloatingFilterChanged(s||null,r||null)})}convertValue(e){return e||null}setEditable(e){this.inputSvc.setEditable(e)}},Oj=class extends D{constructor(){super(...arguments),this.onValueChanged=()=>{},this.numberInputActive=!0}setupGui(e){this.eNumberInput=this.createManagedBean(new Cv),this.eTextInput=this.createManagedBean(new Zs),this.eTextInput.setDisabled(!0);let t=this.eNumberInput.getGui(),i=this.eTextInput.getGui();e.appendChild(t),e.appendChild(i),this.setupListeners(t,n=>this.onValueChanged(n)),this.setupListeners(i,n=>this.onValueChanged(n))}setEditable(e){this.numberInputActive=e,this.eNumberInput.setDisplayed(this.numberInputActive),this.eTextInput.setDisplayed(!this.numberInputActive)}setAutoComplete(e){this.eNumberInput.setAutoComplete(e),this.eTextInput.setAutoComplete(e)}getValue(){return this.getActiveInputElement().getValue()}setValue(e,t){this.getActiveInputElement().setValue(e,t)}getActiveInputElement(){return this.numberInputActive?this.eNumberInput:this.eTextInput}setValueChangedListener(e){this.onValueChanged=e}setupListeners(e,t){this.addManagedListeners(e,{input:t,keydown:t})}setParams(e){this.setAriaLabel(e.ariaLabel),e.autoComplete!==void 0&&this.setAutoComplete(e.autoComplete)}setAriaLabel(e){this.eNumberInput.setInputAriaLabel(e),this.eTextInput.setInputAriaLabel(e)}},Nj=class extends AP{constructor(){super(...arguments),this.FilterModelFormatterClass=DP,this.filterType="number",this.defaultOptions=Uv}updateParams(e){XC(e.filterParams)!==this.allowedCharPattern&&this.recreateFloatingFilterInputService(e),super.updateParams(e)}createFloatingFilterInputService(e){return this.allowedCharPattern=XC(e.filterParams),this.allowedCharPattern?this.createManagedBean(new FP({config:{allowedCharPattern:this.allowedCharPattern}})):this.createManagedBean(new Oj)}convertValue(e){return e?Number(e):null}},qv=["contains","notContains","equals","notEqual","startsWith","endsWith","blank","notBlank"],Bj=class extends Vv{constructor(){super("textFilter",TP,qv),this.filterType="text",this.eValuesFrom=[],this.eValuesTo=[],this.defaultDebounceMs=500}createCondition(e){let t=this.getConditionType(e),i={filterType:this.filterType,type:t},n=this.getValues(e);return n.length>0&&(i.filter=n[0]),n.length>1&&(i.filterTo=n[1]),i}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getInputs(e){let{eValuesFrom:t,eValuesTo:i}=this;return e>=t.length?[null,null]:[t[e],i[e]]}getValues(e){let t=[];return this.forEachPositionInput(e,(i,n,o,s)=>{n<s&&t.push(ro(i.getValue()))}),t}createEValue(){let e=ft({tag:"div",cls:"ag-filter-body",role:"presentation"}),{eValuesFrom:t,eValuesTo:i}=this;return this.createFromToElement(e,t,"from"),this.createFromToElement(e,i,"to"),e}createFromToElement(e,t,i){let n=this.createManagedBean(new Zs);n.addCss(`ag-filter-${i}`),n.addCss("ag-filter-filter"),t.push(n),e.appendChild(n.getGui())}removeEValues(e,t){let i=s=>this.removeComponents(s,e,t),{eValuesFrom:n,eValuesTo:o}=this;i(n),i(o)}},IP=class extends Wv{constructor(){super(...arguments),this.filterTypeKeys=Pj}conditionToString(e,t,i,n,o){let{filter:s,filterTo:r,type:a}=e;if(t){let l=c=>()=>$o(this,"filterSummaryTextQuote",[c]),d=this.conditionForToolPanel(a,i,l(s),l(r),n,o);if(d!=null)return d}return i?`${s}-${r}`:s!=null?`${s}`:`${a}`}},Hj=({filterOption:e,value:t,filterText:i})=>{if(i==null)return!1;switch(e){case"contains":return t.includes(i);case"notContains":return!t.includes(i);case"equals":return t===i;case"notEqual":return t!=i;case"startsWith":return t.indexOf(i)===0;case"endsWith":{let n=t.lastIndexOf(i);return n>=0&&n===t.length-i.length}default:return!1}},Gj=e=>e,Vj=e=>e==null?null:e.toString().toLowerCase(),zj=class extends xP{constructor(){super(TP,qv),this.filterType="text",this.FilterModelFormatterClass=IP}updateParams(e){super.updateParams(e);let t=e.filterParams;this.matcher=t.textMatcher??Hj,this.formatter=t.textFormatter??(t.caseSensitive?Gj:Vj)}evaluateNullValue(e){return e?["notEqual","notContains","blank"].indexOf(e)>=0:!1}evaluateNonNullValue(e,t,i,n){let o=e.map(h=>this.formatter(h))||[],s=this.formatter(t),{api:r,colDef:a,column:l,context:d,filterParams:{textFormatter:c}}=this.params;if(i.type==="blank")return Pp(t);if(i.type==="notBlank")return!Pp(t);let u={api:r,colDef:a,column:l,context:d,node:n.node,data:n.data,filterOption:i.type,value:s,textFormatter:c};return o.some(h=>this.matcher(_(b({},u),{filterText:h})))}processModelToApply(e){if(e&&this.params.filterParams.trimInput){let t=i=>{let n=b({},i),{filter:o,filterTo:s}=i;return o&&(n.filter=QC(o)??null),s&&(n.filterTo=QC(s)??null),n};return m4(e)?_(b({},e),{conditions:e.conditions.map(t)}):t(e)}return e}},Wj=class extends AP{constructor(){super(...arguments),this.FilterModelFormatterClass=IP,this.filterType="text",this.defaultOptions=qv}createFloatingFilterInputService(){return this.createManagedBean(new FP)}};function Uj(e){return!!e.quickFilter?.isFilterPresent()}function qj(e){return e.quickFilter?.getText()}function $j(e){e.quickFilter?.resetCache()}var jj=class extends D{constructor(){super(...arguments),this.beanName="quickFilter",this.quickFilter=null,this.quickFilterParts=null}postConstruct(){let e=this.resetCache.bind(this),t=this.gos;this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:e,columnRowGroupChanged:e,columnVisible:()=>{t.get("includeHiddenColumnsInQuickFilter")||this.resetCache()}}),this.addManagedPropertyListener("quickFilterText",i=>this.setFilter(i.currentValue)),this.addManagedPropertyListeners(["includeHiddenColumnsInQuickFilter","applyQuickFilterBeforePivotOrAgg"],()=>this.onColumnConfigChanged()),this.quickFilter=this.parseFilter(t.get("quickFilterText")),this.parser=t.get("quickFilterParser"),this.matcher=t.get("quickFilterMatcher"),this.setFilterParts(),this.addManagedPropertyListeners(["quickFilterMatcher","quickFilterParser"],()=>this.setParserAndMatcher())}refreshCols(){let{autoColSvc:e,colModel:t,gos:i,pivotResultCols:n}=this.beans,o=t.isPivotMode(),s=e?.getColumns(),r=t.getColDefCols(),a=(o&&!i.get("applyQuickFilterBeforePivotOrAgg")?n?.getPivotResultCols()?.list:r)??[];s&&(a=a.concat(s)),this.colsToUse=i.get("includeHiddenColumnsInQuickFilter")?a:a.filter(l=>l.isVisible()||l.isRowGroupActive())}isFilterPresent(){return this.quickFilter!==null}doesRowPass(e){let t=this.gos.get("cacheQuickFilter");return this.matcher?this.doesRowPassMatcher(t,e):this.quickFilterParts.every(i=>t?this.doesRowPassCache(e,i):this.doesRowPassNoCache(e,i))}resetCache(){this.beans.rowModel.forEachNode(e=>e.quickFilterAggregateText=null)}getText(){return this.gos.get("quickFilterText")}setFilterParts(){let{quickFilter:e,parser:t}=this;e?this.quickFilterParts=t?t(e):e.split(" "):this.quickFilterParts=null}parseFilter(e){return q(e)?e.toUpperCase():null}setFilter(e){if(e!=null&&typeof e!="string"){I(70,{newFilter:e});return}let t=this.parseFilter(e);this.quickFilter!==t&&(this.quickFilter=t,this.setFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}setParserAndMatcher(){let e=this.gos.get("quickFilterParser"),t=this.gos.get("quickFilterMatcher"),i=e!==this.parser||t!==this.matcher;this.parser=e,this.matcher=t,i&&(this.setFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}onColumnConfigChanged(){this.refreshCols(),this.resetCache(),this.isFilterPresent()&&this.dispatchLocalEvent({type:"quickFilterChanged"})}doesRowPassNoCache(e,t){return this.colsToUse.some(i=>{let n=this.getTextForColumn(i,e);return q(n)&&n.includes(t)})}doesRowPassCache(e,t){return this.checkGenerateAggText(e),e.quickFilterAggregateText.includes(t)}doesRowPassMatcher(e,t){let i;e?(this.checkGenerateAggText(t),i=t.quickFilterAggregateText):i=this.getAggText(t);let{quickFilterParts:n,matcher:o}=this;return o(n,i)}checkGenerateAggText(e){e.quickFilterAggregateText||(e.quickFilterAggregateText=this.getAggText(e))}getTextForColumn(e,t){let i=this.beans.filterValueSvc.getValue(e,t),n=e.getColDef();if(n.getQuickFilterText){let o=te(this.gos,{value:i,node:t,data:t.data,column:e,colDef:n});i=n.getQuickFilterText(o)}return q(i)?i.toString().toUpperCase():null}getAggText(e){let t=[];for(let i of this.colsToUse){let n=this.getTextForColumn(i,e);q(n)&&t.push(n)}return t.join(`
`)}},Kj={moduleName:"ClientSideRowModelFilter",version:z,rowModels:["clientSide"],beans:[Y$]},$v={moduleName:"FilterCore",version:z,beans:[Cj],apiFunctions:{isAnyFilterPresent:fj,onFilterChanged:mj},css:[tj],dependsOn:[Kj]},LP={moduleName:"FilterValue",version:z,beans:[wj]},Np={moduleName:"ColumnFilter",version:z,beans:[gj,vj],dynamicBeans:{headerFilterCellCtrl:X$},icons:{filter:"filter",filterActive:"filter"},apiFunctions:{isColumnFilterPresent:ij,getColumnFilterInstance:nj,destroyFilter:oj,setFilterModel:sj,getFilterModel:rj,getColumnFilterModel:aj,setColumnFilterModel:lj,showColumnFilter:dj,hideColumnFilter:cj,getColumnFilterHandler:uj,doFilterAction:hj},dependsOn:[$v,Op,LP,Z$]},Yj={moduleName:"CustomFilter",version:z,userComponents:{agReadOnlyFloatingFilter:yj},dependsOn:[Np]},Xj={moduleName:"TextFilter",version:z,dependsOn:[Np],userComponents:{agTextColumnFilter:{classImp:Bj,params:{useForm:!0}},agTextColumnFloatingFilter:Wj},dynamicBeans:{agTextColumnFilterHandler:zj}},Jj={moduleName:"NumberFilter",version:z,dependsOn:[Np],userComponents:{agNumberColumnFilter:{classImp:Ij,params:{useForm:!0}},agNumberColumnFloatingFilter:Nj},dynamicBeans:{agNumberColumnFilterHandler:Lj}},Qj={moduleName:"DateFilter",version:z,dependsOn:[Np],userComponents:{agDateColumnFilter:{classImp:Rj,params:{useForm:!0}},agDateInput:Aj,agDateColumnFloatingFilter:Fj},dynamicBeans:{agDateColumnFilterHandler:kj}},Zj={moduleName:"QuickFilterCore",version:z,rowModels:["clientSide"],beans:[jj],dependsOn:[$v,LP]},eK={moduleName:"QuickFilter",version:z,apiFunctions:{isQuickFilterPresent:Uj,getQuickFilter:qj,resetQuickFilter:$j},dependsOn:[Zj]},tK={moduleName:"ExternalFilter",version:z,dependsOn:[$v]},iK=".ag-tooltip{background-color:var(--ag-tooltip-background-color);border:var(--ag-tooltip-border);border-radius:var(--ag-border-radius);color:var(--ag-tooltip-text-color);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);position:absolute;white-space:normal;z-index:99999;&:where(.ag-cell-editor-tooltip){background-color:var(--ag-tooltip-error-background-color);border:var(--ag-tooltip-error-border);color:var(--ag-tooltip-error-text-color);font-weight:500}}.ag-tooltip-custom{position:absolute;z-index:99999}.ag-tooltip-custom:where(:not(.ag-tooltip-interactive)),.ag-tooltip:where(:not(.ag-tooltip-interactive)){pointer-events:none}.ag-tooltip-animate{transition:opacity 1s;&:where(.ag-tooltip-hiding){opacity:0}}",CC=(e,t,i)=>{let{editModelSvc:n}=e,o=n?.getCellValidationModel()?.getCellValidation(t)?.errorMessages,s=n?.getRowValidationModel().getRowValidation(t)?.errorMessages,r=o||s;return r?.length?r.join(i("tooltipValidationErrorSeparator",". ")):void 0},nK=class extends D{constructor(){super(...arguments),this.beanName="tooltipSvc"}setupHeaderTooltip(e,t,i,n){e&&t.destroyBean(e);let o=this.gos,s=mC(o),{column:r,eGui:a}=t,l=r.getColDef();!n&&s&&!l.headerComponent&&(n=jh(()=>a.querySelector(".ag-header-cell-text")));let d="header",u=this.beans.colNames.getDisplayNameForColumn(r,"header",!0),h=i??u,p={getGui:()=>a,getLocation:()=>d,getTooltipValue:()=>i??l?.headerTooltipValueGetter?.(te(o,{location:d,colDef:l,column:r,value:h,valueFormatted:u}))??l?.headerTooltip,shouldDisplayTooltip:n,getAdditionalParams:()=>({column:r,colDef:r.getColDef()})},g=this.createTooltipFeature(p);return g&&(g=t.createBean(g),t.setRefreshFunction("tooltip",()=>g.refreshTooltip())),g}setupHeaderGroupTooltip(e,t,i,n){e&&t.destroyBean(e);let o=this.gos,s=mC(o),{column:r,eGui:a}=t,l=r.getColGroupDef();!n&&s&&!l?.headerGroupComponent&&(n=jh(()=>a.querySelector(".ag-header-group-text")));let d="headerGroup",u=this.beans.colNames.getDisplayNameForColumnGroup(r,"header"),h=i??u,p={getGui:()=>a,getLocation:()=>d,getTooltipValue:()=>i??l?.headerTooltipValueGetter?.(te(o,{location:d,colDef:l,column:r,value:h,valueFormatted:u}))??l?.headerTooltip,shouldDisplayTooltip:n,getAdditionalParams:()=>{let f={column:r};return l&&(f.colDef=l),f}},g=this.createTooltipFeature(p);return g&&t.createBean(g)}enableCellTooltipFeature(e,t,i){let{beans:n}=this,{gos:o,editSvc:s}=n,{column:r,rowNode:a}=e,l="cell",d=()=>{let p=!!!s?.isEditing(e)&&CC(n,e,this.getLocaleTextFunc());if(p)return l="cellEditor",p;l="cell";let g=r.getColDef(),f=a.data;if(g.tooltipField&&q(f))return ed(f,g.tooltipField,r.isTooltipFieldContainsDots());let m=g.tooltipValueGetter;return m?m(te(o,{location:"cell",colDef:r.getColDef(),column:r,rowIndex:e.cellPosition.rowIndex,node:a,data:a.data,value:e.value,valueFormatted:e.valueFormatted})):null},c=mC(o);i||(c&&!e.isCellRenderer()?i=()=>{let h=!!s?.isEditing(e);if(!h&&CC(n,e,this.getLocaleTextFunc()))return!0;if(!r.isTooltipEnabled())return!1;let f=jh(()=>{let m=e.eGui;return m.children.length===0?m:m.querySelector(".ag-cell-value")});return!h&&f()}:i=()=>!s?.isEditing(e));let u={getGui:()=>e.eGui,getLocation:()=>l,getTooltipValue:t!=null?()=>t:d,shouldDisplayTooltip:i,getAdditionalParams:()=>({column:r,colDef:r.getColDef(),rowIndex:e.cellPosition.rowIndex,node:a,data:a.data,valueFormatted:e.valueFormatted})};return this.createTooltipFeature(u,n)}setupFullWidthRowTooltip(e,t,i,n){let o={getGui:()=>t.getFullWidthElement(),getTooltipValue:()=>i,getLocation:()=>"fullWidthRow",shouldDisplayTooltip:n},s=this.beans,r=s.context;e&&t.destroyBean(e,r);let a=this.createTooltipFeature(o,s);if(a)return t.createBean(a,r)}setupCellEditorTooltip(e,t){let{beans:i}=this,{context:n}=i,o=t.getValidationElement?.(!0)||!t.isPopup?.()&&e.eGui;if(!o)return;let s={getGui:()=>o,getTooltipValue:()=>CC(i,e,this.getLocaleTextFunc()),getLocation:()=>"cellEditor",shouldDisplayTooltip:()=>{let{editModelSvc:a}=i,l=a?.getRowValidationModel()?.getRowValidationMap(),d=a?.getCellValidationModel()?.getCellValidationMap(),c=!!l&&l.size>0,u=!!d&&d.size>0;return c||u}},r=this.createTooltipFeature(s,i);if(r)return e.createBean(r,n)}initCol(e){let{colDef:t}=e;e.tooltipEnabled=q(t.tooltipField)||q(t.tooltipValueGetter)||q(t.tooltipComponent)}createTooltipFeature(e,t){return this.beans.registry.createDynamicBean("tooltipFeature",!1,e,t)}},oK=class extends TB{createTooltipComp(e,t){xN(this.beans.userCompFactory,e)?.newAgStackInstance().then(t)}setEventHandlers(e){[this.onColumnMovedEventCallback]=this.addManagedEventListeners({columnMoved:e})}clearEventHandlers(){this.onColumnMovedEventCallback?.(),this.onColumnMovedEventCallback=void 0}},_P={moduleName:"Tooltip",version:z,beans:[nK],dynamicBeans:{tooltipFeature:r4,highlightTooltipFeature:AB,tooltipStateManager:oK},userComponents:{agTooltipComponent:_B},dependsOn:[Op],css:[iK]},ea=class{constructor(e){this.cellValueChanges=e}},vC=class extends ea{constructor(e,t,i,n){super(e),this.initialRange=t,this.finalRange=i,this.ranges=n}},sK=10,AR=class{constructor(e){this.actionStack=[],this.maxStackSize=e||sK,this.actionStack=new Array(this.maxStackSize)}pop(){return this.actionStack.pop()}push(e){e.cellValueChanges&&e.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(e))}clear(){this.actionStack=[]}getCurrentStackSize(){return this.actionStack.length}},rK=class extends D{constructor(){super(...arguments),this.beanName="undoRedo",this.cellValueChanges=[],this.activeCellEdit=null,this.activeRowEdit=null,this.isPasting=!1,this.isRangeInAction=!1,this.batchEditing=!1,this.bulkEditing=!1,this.onCellValueChanged=e=>{let t={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned},i=this.activeCellEdit!==null&&O4(this.activeCellEdit,t),n=this.activeRowEdit!==null&&TV(this.activeRowEdit,t);if(!(i||n||this.isPasting||this.isRangeInAction))return;let{rowPinned:s,rowIndex:r,column:a,oldValue:l,value:d}=e,c={rowPinned:s,rowIndex:r,columnId:a.getColId(),newValue:d,oldValue:l};this.cellValueChanges.push(c)},this.clearStacks=()=>{this.undoStack.clear(),this.redoStack.clear()}}postConstruct(){let{gos:e,ctrlsSvc:t}=this.beans;if(!e.get("undoRedoCellEditing"))return;let i=e.get("undoRedoCellEditingLimit");if(i<=0)return;this.undoStack=new AR(i),this.redoStack=new AR(i),this.addListeners();let n=this.clearStacks.bind(this);this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this),modelUpdated:o=>{o.keepUndoRedoStack||this.clearStacks()},columnPivotModeChanged:n,newColumnsLoaded:n,columnGroupOpened:n,columnRowGroupChanged:n,columnMoved:n,columnPinned:n,columnVisible:n,rowDragEnd:n}),t.whenReady(this,o=>{this.gridBodyCtrl=o.gridBodyCtrl})}getCurrentUndoStackSize(){return this.undoStack?.getCurrentStackSize()??0}getCurrentRedoStackSize(){return this.redoStack?.getCurrentStackSize()??0}undo(e){let{eventSvc:t,undoStack:i,redoStack:n}=this;t.dispatchEvent({type:"undoStarted",source:e});let o=this.undoRedo(i,n,"initialRange","oldValue","undo");t.dispatchEvent({type:"undoEnded",source:e,operationPerformed:o})}redo(e){let{eventSvc:t,undoStack:i,redoStack:n}=this;t.dispatchEvent({type:"redoStarted",source:e});let o=this.undoRedo(n,i,"finalRange","newValue","redo");t.dispatchEvent({type:"redoEnded",source:e,operationPerformed:o})}undoRedo(e,t,i,n,o){if(!e)return!1;let s=e.pop();return s?.cellValueChanges?(this.processAction(s,r=>r[n],o),s instanceof vC?this.processRange(s.ranges||[s[i]]):this.processCell(s.cellValueChanges),t.push(s),!0):!1}processAction(e,t,i){for(let n of e.cellValueChanges){let{rowIndex:o,rowPinned:s,columnId:r}=n,a={rowIndex:o,rowPinned:s},l=ho(this.beans,a);l.displayed&&l.setDataValue(r,t(n),i)}}processRange(e){let t,i=this.beans.rangeSvc;i.removeAllCellRanges(!0),e.forEach((n,o)=>{if(!n)return;let s=n.startRow,r=n.endRow;o===e.length-1&&(t={rowPinned:s.rowPinned,rowIndex:s.rowIndex,columnId:n.startColumn.getColId()},this.setLastFocusedCell(t));let a={rowStartIndex:s.rowIndex,rowStartPinned:s.rowPinned,rowEndIndex:r.rowIndex,rowEndPinned:r.rowPinned,columnStart:n.startColumn,columns:n.columns};i.addCellRange(a)})}processCell(e){let t=e[0],{rowIndex:i,rowPinned:n}=t,o={rowIndex:i,rowPinned:n},s=ho(this.beans,o),r={rowPinned:t.rowPinned,rowIndex:s.rowIndex,columnId:t.columnId};this.setLastFocusedCell(r)}setLastFocusedCell(e){let{rowIndex:t,columnId:i,rowPinned:n}=e,{colModel:o,focusSvc:s,rangeSvc:r}=this.beans,a=o.getCol(i);if(!a)return;let{scrollFeature:l}=this.gridBodyCtrl;l.ensureIndexVisible(t),l.ensureColumnVisible(a);let d={rowIndex:t,column:a,rowPinned:n};s.setFocusedCell(_(b({},d),{forceBrowserFocus:!0})),r?.setRangeToCell(d)}addListeners(){this.addManagedEventListeners({rowEditingStarted:e=>{this.activeRowEdit={rowIndex:e.rowIndex,rowPinned:e.rowPinned}},rowEditingStopped:()=>{let e=new ea(this.cellValueChanges);this.pushActionsToUndoStack(e),this.activeRowEdit=null},cellEditingStarted:e=>{this.activeCellEdit={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned}},cellEditingStopped:e=>{if(this.activeCellEdit=null,e.valueChanged&&!this.activeRowEdit&&!this.isPasting&&!this.isRangeInAction){let i=new ea(this.cellValueChanges);this.pushActionsToUndoStack(i)}},pasteStart:()=>{this.isPasting=!0},pasteEnd:()=>{let e=new ea(this.cellValueChanges);this.pushActionsToUndoStack(e),this.isPasting=!1},fillStart:()=>{this.isRangeInAction=!0},fillEnd:e=>{let t=new vC(this.cellValueChanges,e.initialRange,e.finalRange);this.pushActionsToUndoStack(t),this.isRangeInAction=!1},keyShortcutChangedCellStart:()=>{this.isRangeInAction=!0},keyShortcutChangedCellEnd:()=>{let e,{rangeSvc:t,gos:i}=this.beans;t&&uo(i)?e=new vC(this.cellValueChanges,void 0,void 0,[...t.getCellRanges()]):e=new ea(this.cellValueChanges),this.pushActionsToUndoStack(e),this.isRangeInAction=!1},batchEditingStarted:()=>this.startBigChange("batchEditing"),batchEditingStopped:({changes:e})=>this.stopBigChange("batchEditing",e),bulkEditingStarted:()=>this.startBigChange("bulkEditing"),bulkEditingStopped:({changes:e})=>this.stopBigChange("bulkEditing",e)})}startBigChange(e){this.updateBigChange(e,!0)}updateBigChange(e,t){e==="bulkEditing"?this.bulkEditing=t:this.batchEditing=t}stopBigChange(e,t){if(e==="bulkEditing"&&!this.bulkEditing||e==="batchEditing"&&!this.batchEditing||(this.updateBigChange(e,!1),t?.length===0))return;let i=new ea(t??[]);this.pushActionsToUndoStack(i),this.cellValueChanges=[]}pushActionsToUndoStack(e){this.undoStack.push(e),this.cellValueChanges=[],this.redoStack.clear()}},aK=".ag-cell-inline-editing{border:var(--ag-cell-editing-border)!important;border-radius:var(--ag-border-radius);box-shadow:var(--ag-cell-editing-shadow);padding:0;z-index:1;.ag-cell-edit-wrapper,.ag-cell-editor,.ag-cell-wrapper,:where(.ag-cell-editor) .ag-input-field-input,:where(.ag-cell-editor) .ag-wrapper{height:100%;line-height:normal;min-height:100%;width:100%}&.ag-cell-editing-error{border-color:var(--ag-invalid-color)!important}}:where(.ag-popup-editor) .ag-large-text{background-color:var(--ag-background-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);padding:0}.ag-large-text-input{display:block;height:auto;padding:var(--ag-cell-horizontal-padding)}:where(.ag-rtl .ag-large-text-input) textarea{resize:none}:where(.ag-ltr) .ag-checkbox-edit{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-checkbox-edit{padding-right:var(--ag-cell-horizontal-padding)}:where(.ag-row.ag-row-editing-invalid .ag-cell-inline-editing){opacity:.8}.ag-popup-editor{position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}",lK={tag:"div",cls:"ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit",children:[{tag:"ag-checkbox",ref:"eEditor",role:"presentation"}]},dK=class extends Lp{constructor(){super(lK,[mv]),this.eEditor=V}initialiseEditor(e){let t=e.value??void 0,i=this.eEditor;i.setValue(t),i.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(t),this.addManagedListeners(i,{fieldValueChanged:o=>this.setAriaLabel(o.selected)})}getValue(){return this.eEditor.getValue()}focusIn(){this.eEditor.getFocusableElement().focus()}afterGuiAttached(){this.params.cellStartedEdit&&this.focusIn()}isPopup(){return!1}setAriaLabel(e){let t=this.getLocaleTextFunc(),i=kp(t,e),n=t("ariaToggleCellValue","Press SPACE to toggle cell value");this.eEditor.setInputAriaLabel(`${n} (${i})`)}getValidationElement(e){return e?this.params.eGridCell:this.eEditor.getInputElement()}getValidationErrors(){let{params:e}=this,{getValidationErrors:t}=e,i=this.getValue();return t?t({value:i,internalErrors:null,cellEditorParams:e}):null}},Bp=class extends Lp{constructor(e){super(),this.cellEditorInput=e,this.eEditor=V}initialiseEditor(e){let{cellEditorInput:t}=this;this.setTemplate({tag:"div",cls:"ag-cell-edit-wrapper",children:[t.getTemplate()]},t.getAgComponents());let{eEditor:i}=this,{cellStartedEdit:n,eventKey:o,suppressPreventDefault:s}=e;i.getInputElement().setAttribute("title",""),t.init(i,e);let r,a=!0;n?(this.focusAfterAttached=!0,o===R.BACKSPACE||o===R.DELETE?r="":o&&o.length===1?s?a=!1:r=o:(r=t.getStartValue(),o!==R.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,r=t.getStartValue()),a&&r!=null&&i.setStartValue(r),this.addGuiEventListener("keydown",l=>{let{key:d}=l;(d===R.PAGE_UP||d===R.PAGE_DOWN)&&l.preventDefault()})}afterGuiAttached(){let e=this.getLocaleTextFunc(),t=this.eEditor;if(t.setInputAriaLabel(e("ariaInputEditor","Input Editor")),!this.focusAfterAttached)return;es()||t.getFocusableElement().focus();let i=t.getInputElement();this.highlightAllOnFocus?i.select():this.cellEditorInput.setCaret?.()}focusIn(){let{eEditor:e}=this,t=e.getFocusableElement(),i=e.getInputElement();t.focus(),i.select()}getValue(){return this.cellEditorInput.getValue()}isPopup(){return!1}getValidationElement(){return this.eEditor.getInputElement()}getValidationErrors(){return this.cellEditorInput.getValidationErrors()}},cK={tag:"ag-input-date-field",ref:"eEditor",cls:"ag-cell-editor"},uK=class{constructor(e,t){this.getDataTypeService=e,this.getLocaleTextFunc=t}getTemplate(){return cK}getAgComponents(){return[J6]}init(e,t){this.eEditor=e,this.params=t;let{min:i,max:n,step:o,colDef:s}=t;i!=null&&e.setMin(i),n!=null&&e.setMax(n),o!=null&&e.setStep(o),this.includeTime=t.includeTime??this.getDataTypeService()?.getDateIncludesTimeFlag?.(s.cellDataType),this.includeTime!=null&&e.setIncludeTime(this.includeTime)}getValidationErrors(){let t=this.eEditor.getInputElement().valueAsDate,{params:i}=this,{min:n,max:o,getValidationErrors:s}=i,r=[],a=this.getLocaleTextFunc();if(t instanceof Date&&!isNaN(t.getTime())){if(n){let l=n instanceof Date?n:new Date(n);if(t<l){let d=l.toLocaleDateString();r.push(a("minDateValidation",`Date must be after ${d}`,[d]))}}if(o){let l=o instanceof Date?o:new Date(o);if(t>l){let d=l.toLocaleDateString();r.push(a("maxDateValidation",`Date must be before ${d}`,[d]))}}}return r.length||(r=null),s?s({value:t,cellEditorParams:i,internalErrors:r}):r}getValue(){let{eEditor:e,params:t}=this,i=e.getDate();return!q(i)&&!q(t.value)?t.value:i??null}getStartValue(){let{value:e}=this.params;if(e instanceof Date)return Si(e,this.includeTime??!1)}},hK=class extends Bp{constructor(){super(new uK(()=>this.beans.dataTypeSvc,()=>this.getLocaleTextFunc()))}},pK={tag:"ag-input-date-field",ref:"eEditor",cls:"ag-cell-editor"},gK=class{constructor(e,t){this.getDataTypeService=e,this.getLocaleTextFunc=t}getTemplate(){return pK}getAgComponents(){return[J6]}init(e,t){this.eEditor=e,this.params=t;let{min:i,max:n,step:o,colDef:s}=t;i!=null&&e.setMin(i),n!=null&&e.setMax(n),o!=null&&e.setStep(o),this.includeTime=t.includeTime??this.getDataTypeService()?.getDateIncludesTimeFlag?.(s.cellDataType),this.includeTime!=null&&e.setIncludeTime(this.includeTime)}getValidationErrors(){let{eEditor:e,params:t}=this,i=e.getInputElement().value,n=this.formatDate(this.parseDate(i??void 0)),{min:o,max:s,getValidationErrors:r}=t,a=[];if(n){let l=new Date(n),d=this.getLocaleTextFunc();if(o){let c=new Date(o);if(l<c){let u=c.toLocaleDateString();a.push(d("minDateValidation",`Date must be after ${u}`,[u]))}}if(s){let c=new Date(s);if(l>c){let u=c.toLocaleDateString();a.push(d("maxDateValidation",`Date must be before ${u}`,[u]))}}}return a.length||(a=null),r?r({value:this.getValue(),cellEditorParams:t,internalErrors:a}):a}getValue(){let{params:e,eEditor:t}=this,i=this.formatDate(t.getDate());return!q(i)&&!q(e.value)?e.value:e.parseValue(i??"")}getStartValue(){return Si(this.parseDate(this.params.value??void 0)??null,this.includeTime??!1)}parseDate(e){let t=this.getDataTypeService();return t?t.getDateParserFunction(this.params.column)(e):pi(e)??void 0}formatDate(e){let t=this.getDataTypeService();return t?t.getDateFormatterFunction(this.params.column)(e):Si(e??null,this.includeTime??!1)??void 0}},fK=class extends Bp{constructor(){super(new gK(()=>this.beans.dataTypeSvc,()=>this.getLocaleTextFunc()))}},mK={tag:"div",cls:"ag-large-text",children:[{tag:"ag-input-text-area",ref:"eEditor",cls:"ag-large-text-input"}]},CK=class extends Lp{constructor(){super(mK,[VN]),this.eEditor=V}initialiseEditor(e){let{eEditor:t}=this,{cellStartedEdit:i,eventKey:n,maxLength:o,cols:s,rows:r}=e;this.focusAfterAttached=i,t.getInputElement().setAttribute("title",""),t.setMaxLength(o||200).setCols(s||60).setRows(r||10);let a;i?(this.focusAfterAttached=!0,n===R.BACKSPACE||n===R.DELETE?a="":n&&n.length===1?a=n:(a=this.getStartValue(e),n!==R.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,a=this.getStartValue(e)),a!=null&&t.setValue(a,!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()}getStartValue(e){let{value:t}=e;return t?.toString()??t}onKeyDown(e){let t=e.key;(t===R.LEFT||t===R.UP||t===R.RIGHT||t===R.DOWN||e.shiftKey&&t===R.ENTER)&&e.stopPropagation()}afterGuiAttached(){let{eEditor:e,focusAfterAttached:t,highlightAllOnFocus:i}=this,n=this.getLocaleTextFunc();e.setInputAriaLabel(n("ariaInputEditor","Input Editor")),t&&(e.getFocusableElement().focus(),i&&e.getInputElement().select())}getValue(){let{eEditor:e,params:t}=this,{value:i}=t,n=e.getValue();return!q(n)&&!q(i)?i:t.parseValue(n)}getValidationElement(){return this.eEditor.getInputElement()}getValidationErrors(){let{params:e}=this,{maxLength:t,getValidationErrors:i}=e,n=this.getLocaleTextFunc(),o=this.getValue(),s=[];return typeof o=="string"&&t!=null&&o.length>t&&s.push(n("maxLengthValidation",`Must be ${t} characters or fewer.`,[String(t)])),s.length||(s=null),i?i({value:o,internalErrors:s,cellEditorParams:e}):s}},vK={tag:"ag-input-number-field",ref:"eEditor",cls:"ag-cell-editor"},wK=class{constructor(e){this.getLocaleTextFunc=e}getTemplate(){return vK}getAgComponents(){return[zN]}init(e,t){this.eEditor=e,this.params=t;let{max:i,min:n,precision:o,step:s}=t;i!=null&&e.setMax(i),n!=null&&e.setMin(n),o!=null&&e.setPrecision(o),s!=null&&e.setStep(s);let r=e.getInputElement();t.preventStepping?e.addManagedElementListeners(r,{keydown:this.preventStepping}):t.showStepperButtons&&r.classList.add("ag-number-field-input-stepper")}getValidationErrors(){let{params:e}=this,{min:t,max:i,getValidationErrors:n}=e,s=this.eEditor.getInputElement().valueAsNumber,r=this.getLocaleTextFunc(),a=[];return typeof s=="number"&&(t!=null&&s<t&&a.push(r("minValueValidation",`Must be greater than or equal to ${t}.`,[String(t)])),i!=null&&s>i&&a.push(r("maxValueValidation",`Must be less than or equal to ${i}.`,[String(i)]))),a.length||(a=null),n?n({value:s,cellEditorParams:e,internalErrors:a}):a}preventStepping(e){(e.key===R.UP||e.key===R.DOWN)&&e.preventDefault()}getValue(){let{eEditor:e,params:t}=this,i=e.getValue();if(!q(i)&&!q(t.value))return t.value;let n=t.parseValue(i);if(n==null)return n;if(typeof n=="string"){if(n==="")return null;n=Number(n)}return isNaN(n)?null:n}getStartValue(){return this.params.value}setCaret(){es()&&this.eEditor.getInputElement().focus({preventScroll:!0})}},bK=class extends Bp{constructor(){super(new wK(()=>this.getLocaleTextFunc()))}},yK={tag:"div",cls:"ag-cell-edit-wrapper",children:[{tag:"ag-select",ref:"eEditor",cls:"ag-cell-editor"}]},SK=class extends Lp{constructor(){super(yK,[ZN]),this.eEditor=V,this.startedByEnter=!1}wireBeans(e){this.valueSvc=e.valueSvc}initialiseEditor(e){this.focusAfterAttached=e.cellStartedEdit;let{eEditor:t,valueSvc:i,gos:n}=this,{values:o,value:s,eventKey:r}=e;if(Qe(o)){I(58);return}this.startedByEnter=r!=null?r===R.ENTER:!1;let a=!1;o.forEach(u=>{let h={value:u},p=i.formatValue(e.column,null,u),g=p!=null;h.text=g?p:u,t.addOption(h),a=a||s===u}),a?t.setValue(e.value,!0):e.values.length&&t.setValue(e.values[0],!0);let{valueListGap:l,valueListMaxWidth:d,valueListMaxHeight:c}=e;l!=null&&t.setPickerGap(l),c!=null&&t.setPickerMaxHeight(c),d!=null&&t.setPickerMaxWidth(d),n.get("editType")!=="fullRow"&&this.addManagedListeners(this.eEditor,{selectedItem:()=>e.stopEditing()})}afterGuiAttached(){this.focusAfterAttached&&this.eEditor.getFocusableElement().focus(),this.startedByEnter&&setTimeout(()=>{this.isAlive()&&this.eEditor.showPicker()})}focusIn(){this.eEditor.getFocusableElement().focus()}getValue(){return this.eEditor.getValue()}isPopup(){return!1}getValidationElement(){return this.eEditor.getAriaElement()}getValidationErrors(){let{params:e}=this,{values:t,getValidationErrors:i}=e,n=this.getValue(),o=[];if(t&&!t.includes(n)){let s=this.getLocaleTextFunc();o.push(s("invalidSelectionValidation","Invalid selection."))}else o=null;return i?i({value:n,internalErrors:o,cellEditorParams:e}):o}},xK={tag:"ag-input-text-field",ref:"eEditor",cls:"ag-cell-editor"},EK=class{constructor(e){this.getLocaleTextFunc=e}getTemplate(){return xK}getAgComponents(){return[Fp]}init(e,t){this.eEditor=e,this.params=t;let i=t.maxLength;i!=null&&e.setMaxLength(i)}getValidationErrors(){let{params:e}=this,{maxLength:t,getValidationErrors:i}=e,n=this.getValue(),o=this.getLocaleTextFunc(),s=[];return t!=null&&typeof n=="string"&&n.length>t&&s.push(o("maxLengthValidation",`Must be ${t} characters or fewer.`,[String(t)])),s.length||(s=null),i?i({value:n,cellEditorParams:e,internalErrors:s}):s}getValue(){let{eEditor:e,params:t}=this,i=e.getValue();return!q(i)&&!q(t.value)?t.value:t.parseValue(i)}getStartValue(){let e=this.params;return e.useFormatter||e.column.getColDef().refData?e.formatValue(e.value):e.value}setCaret(){es()&&this.eEditor.getInputElement().focus({preventScroll:!0});let e=this.eEditor,t=e.getValue(),i=q(t)&&t.length||0;i&&e.getInputElement().setSelectionRange(i,i)}},IR=class extends Bp{constructor(){super(new EK(()=>this.getLocaleTextFunc()))}};function RK(e){return e.ctrlsSvc.getScrollFeature().getVScrollPosition()}function PK(e){return e.ctrlsSvc.getScrollFeature().getHScrollPosition()}function OP(e,t,i="auto"){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureColumnVisible(t,i),"ensureVisible")}function NP(e,t,i){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureIndexVisible(t,i),"ensureVisible")}function MK(e,t,i=null){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureNodeVisible(t,i),"ensureVisible")}function kK(e){e.undoRedo?.undo("api")}function DK(e){e.undoRedo?.redo("api")}function FK(e,t){return e.editModelSvc?.getEditRowDataValue(t,{checkSiblings:!0})}function TK(e){let t=e.editModelSvc?.getEditMap(),i=[];return t?.forEach((n,o)=>{let{rowIndex:s,rowPinned:r}=o;n.forEach((a,l)=>{let{editorValue:d,pendingValue:c,sourceValue:u,state:h}=a,p=so(a),g=d??c;g===Bi&&(g=void 0);let f={newValue:g,oldValue:u,state:h,column:l,colId:l.getColId(),colKey:l.getColId(),rowIndex:s,rowPinned:r};(h==="editing"||h==="changed"&&p)&&i.push(f)})}),i}function AK(e,t=!1){let{editSvc:i}=e;if(i?.isBatchEditing()){if(t)for(let n of e.editModelSvc?.getEditPositions()??[])n.state==="editing"&&i.revertSingleCellEdit(n);else Bs(e,{persist:!0});ga(e,void 0,{cancel:t})}else i?.stopEditing(void 0,{cancel:t,source:"edit",forceStop:!t,forceCancel:t})}function IK(e,t){let i=et(e,t);return e.editSvc?.isEditing(i)??!1}function LK(e,t){let{key:i,colKey:n,rowIndex:o,rowPinned:s}=t,{editSvc:r,colModel:a}=e,l=a.getCol(n);if(!l){I(12,{colKey:n});return}let c=ho(e,{rowIndex:o,rowPinned:s||null,column:l});if(!c){I(290,{rowIndex:o,rowPinned:s});return}if(!l.isCellEditable(c))return;s==null&&NP(e,o),OP(e,n),r?.startEditing({rowNode:c,column:l},{event:i?new KeyboardEvent("keydown",{key:i}):void 0,source:"api"})}function _K(e){return e.editSvc?.validateEdit()||null}function OK(e){return e.undoRedo?.getCurrentUndoStackSize()??0}function NK(e){return e.undoRedo?.getCurrentRedoStackSize()??0}var BK={tag:"div",cls:"ag-popup-editor",attrs:{tabindex:"-1"}},HK=class extends pv{constructor(e){super(BK),this.params=e}postConstruct(){$s(this.gos,this.getGui(),"popupEditorWrapper",!0),this.addKeyDownListener()}addKeyDownListener(){let e=this.getGui(),t=this.params,i=n=>{HC(this.gos,n,t.node,t.column,!0)||t.onKeyDown(n)};this.addManagedElementListeners(e,{keydown:i})}};function GK(e,{column:t},i,n,o="ui"){if(i instanceof KeyboardEvent&&(i.key===R.TAB||i.key===R.ENTER||i.key===R.F2||i.key===R.BACKSPACE&&n))return!0;if(i?.shiftKey&&e.rangeSvc?.getCellRanges().length!=0)return!1;let r=t?.getColDef(),a=VK(e.gos,r),l=i?.type;return l==="click"&&i?.detail===1&&a===1||l==="dblclick"&&i?.detail===2&&a===2?!0:o==="api"?n??!1:!1}function VK(e,t){return e.get("suppressClickEdit")===!0?0:e.get("singleClickEdit")===!0||t?.singleClickEdit?1:2}function ZC(e,{rowNode:t,column:i},n="ui"){let o=i.getColDef().editable,s=e.editModelSvc;return i.isColumnFunc(t,o)||!!s&&s.hasEdits({rowNode:t,column:i},{withOpenEditor:!0})}function zK(e,t,i="ui"){let n=ZC(e,t,i);return n===!0||i==="ui"?n:e.colModel.getCols().some(s=>ZC(e,{rowNode:t.rowNode,column:s},i))}var Mp=(e,t=!1)=>{if(e!==void 0)return so(e)||t&&e.state==="editing"};function BP(e,t,i=!1){return Mp(e.editModelSvc?.getEdit(t),i)}var HP=(e,t,i)=>{if(e)for(let n=0,o=e.length;n<o;++n){let s=e[n];if(s.data&&(Mp(t?.getEdit({rowNode:s,column:i}))||Mp(t?.getEdit({rowNode:s.pinnedSibling,column:i})))||HP(s.childrenAfterGroup,t,i))return!0}};function GP(e,t){let{column:i,rowNode:n}=t;return e.gos.get("groupTotalRow")&&!n?.footer?!1:HP(n?.childrenAfterGroup,e.editModelSvc,i)}function VP(e,{rowNode:t,column:i}){if(t=t.pinnedSibling,!!t)return Mp(e.editModelSvc?.getEdit({rowNode:t,column:i}))}var WK=class extends D{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.editSvc=t.editSvc,this.editModelSvc=t.editModelSvc}setComp(e){this.cellComp=e,this.applyCellStyles()}applyCellStyles(){let{cellCtrl:e,editSvc:t,beans:i}=this;if(t?.isBatchEditing()&&t.isEditing()){let o=BP(i,e)||GP(i,e)||VP(i,e);this.applyBatchingStyle(o)}else this.applyBatchingStyle(!1);let n=!!this.editModelSvc?.getCellValidationModel().hasCellValidation(this.cellCtrl);this.cellComp.toggleCss("ag-cell-editing-error",n)}applyBatchingStyle(e){this.cellComp.toggleCss("ag-cell-editing",e??!1),this.cellComp.toggleCss("ag-cell-batch-edit",(e&&this.editSvc?.isBatchEditing())??!1)}},UK=class extends D{constructor(e,t){super(),this.rowCtrl=e,this.beans=t,this.gos=t.gos,this.editSvc=t.editSvc,this.editModelSvc=t.editModelSvc}applyRowStyles(){let{rowCtrl:e,editModelSvc:t,beans:i}=this,n=e.rowNode,o=t?.getEditRow(n),s=this.editModelSvc?.getRowValidationModel().hasRowValidation({rowNode:n});if(!o&&n.pinnedSibling&&(n=n.pinnedSibling,o=t?.getEditRow(n)),o){let r=Array.from(o.keys()).some(a=>{let l={rowNode:n,column:a};return BP(i,l,!0)||GP(i,l)||VP(i,l)});this.applyStyle(s,r);return}this.applyStyle(s)}applyStyle(e=!1,t=!1){let i=this.editSvc?.isBatchEditing()??!1,n=this.gos.get("editType")==="fullRow";this.rowCtrl?.forEachGui(void 0,({rowComp:o})=>{o.toggleCss("ag-row-editing",n&&t),o.toggleCss("ag-row-batch-edit",n&&t&&i),o.toggleCss("ag-row-inline-editing",t),o.toggleCss("ag-row-not-inline-editing",!t),o.toggleCss("ag-row-editing-invalid",n&&t&&e)})}},qK=({rowModel:e,pinnedRowModel:t,editModelSvc:i},n)=>{let o=new Set;e.forEachNode(s=>n.has(s)&&o.add(s)),t?.forEachPinnedRow("top",s=>n.has(s)&&o.add(s)),t?.forEachPinnedRow("bottom",s=>n.has(s)&&o.add(s));for(let s of n)o.has(s)||i.removeEdits({rowNode:s});return o},$K=({editModelSvc:e},t,i)=>{for(let n of t)e?.getEditRow(n)?.forEach((o,s)=>!i.has(s)&&e.removeEdits({rowNode:n,column:s}))},jK=e=>()=>{let t=new Set(e.colModel.getCols()),i=e.editModelSvc.getEditMap(!0),n=new Set(i.keys());$K(e,qK(e,n),t)},KK=new Set(["undo","redo","paste","bulk","rangeSvc"]),YK=new Set(["ui","api"]),zP={paste:"api",rangeSvc:"api",fillHandle:"api",cellClear:"api",bulk:"api"},XK=new Set(Object.keys(zP)),JK=new Set(["paste","rangeSvc","renderer","cellClear","redo","undo"]),$h={cancel:!0,source:"api"},QK={cancel:!1,source:"api"},Qr={checkSiblings:!0},Wl={force:!0,suppressFlash:!0},ZK=class extends D{constructor(){super(...arguments),this.beanName="editSvc",this.batch=!1,this.stopping=!1,this.committing=!1}postConstruct(){let{beans:e}=this;this.model=e.editModelSvc,this.valueSvc=e.valueSvc,this.rangeSvc=e.rangeSvc,this.addManagedPropertyListener("editType",({currentValue:n})=>{this.stopEditing(void 0,$h),this.createStrategy(n)});let t=jK(e),i=()=>{let n=this.model.getCellValidationModel().getCellValidationMap().size>0,o=this.model.getRowValidationModel().getRowValidationMap().size>0;return n||o?this.stopEditing(void 0,$h):this.isEditing()&&(this.isBatchEditing()?ga(e,this.model.getEditPositions()):this.stopEditing(void 0,QK)),!1};this.addManagedEventListeners({columnPinned:t,columnVisible:t,columnRowGroupChanged:t,rowExpansionStateChanged:t,pinnedRowsChanged:t,displayedRowsChanged:t,sortChanged:i,filterChanged:i,cellFocused:this.onCellFocused.bind(this)})}isBatchEditing(){return this.batch}setBatchEditing(e){e?(this.batch=!0,this.stopEditing(void 0,$h)):(this.stopEditing(void 0,$h),this.batch=!1)}createStrategy(e){let{beans:t,gos:i,strategy:n}=this,o=LR(i,e);if(n){if(n.beanName===o)return n;this.destroyStrategy()}return this.strategy=this.createOptionalManagedBean(t.registry.createDynamicBean(o,!0))}destroyStrategy(){this.strategy&&(this.strategy.destroy(),this.strategy=this.destroyBean(this.strategy))}shouldStartEditing(e,t,i,n="ui"){let o=GK(this.beans,e,t,i,n);return o&&(this.strategy??(this.strategy=this.createStrategy())),o}shouldStopEditing(e,t,i="ui"){return this.strategy?.shouldStop(e,t,i)??null}shouldCancelEditing(e,t,i="ui"){return this.strategy?.shouldCancel(e,t,i)??null}validateEdit(){return fq(this.beans)}isEditing(e,t){return this.model.hasEdits(e,t??Qr)}isRowEditing(e,t){return(e&&this.model.hasRowEdits(e,t))??!1}startEditing(e,t){let{startedEdit:i=!0,event:n=null,source:o="ui",ignoreEventKey:s=!1,silent:r}=t;if(this.strategy??(this.strategy=this.createStrategy()),!this.isCellEditable(e,"api"))return;let a=et(this.beans,e);if(a&&!a.comp){a.onCompAttachedFuncs.push(()=>this.startEditing(e,t));return}let l=this.shouldStartEditing(e,n,i,o);if(l===!1&&o!=="api"){this.isEditing(e)&&this.stopEditing();return}!this.batch&&this.shouldStopEditing(e,void 0,o)&&!t.continueEditing&&this.stopEditing(void 0,{source:o}),l&&this.isBatchEditing()&&this.dispatchBatchEvent("batchEditingStarted",new Map),this.strategy.start({position:e,event:n,source:o,ignoreEventKey:s,startedEdit:i,silent:r})}stopEditing(e,t){let{event:i,cancel:n,source:o="ui",forceCancel:s,forceStop:r}=t||{},{beans:a,model:l}=this;if(XK.has(o)&&this.isBatchEditing())return this.bulkRefresh(e),!1;let d=this.committing?zP[o]:o;if(!(this.committing||this.isEditing(e)||this.isBatchEditing()&&l.hasEdits(e,Qr))||!this.strategy||this.stopping)return!1;this.stopping=!0;let u=et(a,e);u&&(u.onEditorAttachedFuncs=[]);let h=l.getEditMap(!0),p=!1,g=!n&&(!!this.shouldStopEditing(e,i,d)||this.committing&&!this.batch)||(r??!1),f=n&&!!this.shouldCancelEditing(e,i,d)||(s??!1);if(g||f){Bs(a,{persist:!0,isCancelling:f||n,isStopping:g});let m=l.getEditMap(),C=this.processEdits(m,n,o);this.strategy?.stop(n,i);for(let v of C)l.clearEditValue(v);this.bulkRefresh(void 0,h);for(let v of l.getEditPositions(m)){let w=et(a,v),y=so(v);w?.refreshCell({force:!0,suppressFlash:!y})}h=m,p||(p=g)}else if(i instanceof KeyboardEvent&&this.batch&&this.strategy?.midBatchInputsAllowed(e)&&this.isEditing(e,{withOpenEditor:!0})){let{key:m}=i,C=m===R.ENTER,v=m===R.ESCAPE,w=m===R.TAB;(C||w||v)&&(C||w?Bs(a,{persist:!0}):v&&this.revertSingleCellEdit(u),this.isBatchEditing()?this.strategy?.cleanupEditors():ga(a,l.getEditPositions(),{event:i,cancel:v}),i.preventDefault(),this.bulkRefresh(e,h,{suppressFlash:!0}),h=l.getEditMap())}else Bs(a,{persist:!0}),h=l.getEditMap();return p&&e&&this.model.removeEdits(e),this.navigateAfterEdit(t,u?.cellPosition),jC(a),this.model.hasEdits()||(this.model.getCellValidationModel().clearCellValidationMap(),this.model.getRowValidationModel().clearRowValidationMap()),this.bulkRefresh(),f&&this.beans.rowRenderer.refreshRows({rowNodes:Array.from(h.keys())}),this.isBatchEditing()&&(this.beans.rowRenderer.refreshRows({suppressFlash:!0,force:!0}),p&&g&&this.dispatchBatchEvent("batchEditingStopped",h)),this.stopping=!1,p}navigateAfterEdit(e,t){if(!e||!t)return;let{event:i,suppressNavigateAfterEdit:n}=e;if(!(i instanceof KeyboardEvent)||n)return;let{key:s,shiftKey:r}=i,a=this.gos.get("enterNavigatesVerticallyAfterEdit");if(s!==R.ENTER||!a)return;let l=r?R.UP:R.DOWN;this.beans.navigation?.navigateToNextCell(null,l,t,!1)}processEdits(e,t=!1,i){let n=Array.from(e.keys()),o=this.model.getCellValidationModel().getCellValidationMap().size>0||this.model.getRowValidationModel().getRowValidationMap().size>0,s=[];for(let r of n){let a=e.get(r);for(let l of a.keys()){let d=a.get(l),c={rowNode:r,column:l},u=so(d);!t&&u&&!o&&(this.setNodeDataValue(r,l,d.pendingValue,void 0,i)||s.push(c))}}return s}setNodeDataValue(e,t,i,n,o="edit"){let{beans:s}=this,r=et(s,{rowNode:e,column:t}),a=YK.has(o)?"edit":o;r&&(r.suppressRefreshCell=!0),this.commitNextEdit();let l=e.setDataValue(t,i,a);return r&&(r.suppressRefreshCell=!1),n&&r?.refreshCell(Wl),l}setEditMap(e,t){this.strategy??(this.strategy=this.createStrategy()),this.strategy?.setEditMap(e,t),this.bulkRefresh();let i=Wl;t?.forceRefreshOfEditCellsOnly&&(i=b(b({},eY(e)),Wl)),this.beans.rowRenderer.refreshCells(i)}dispatchEditValuesChanged({rowNode:e,column:t},i={}){if(!e||!t||!i)return;let{pendingValue:n,sourceValue:o}=i,{rowIndex:s,rowPinned:r,data:a}=e;this.beans.eventSvc.dispatchEvent({type:"cellEditValuesChanged",node:e,rowIndex:s,rowPinned:r,column:t,source:"api",data:a,newValue:n,oldValue:o,value:n,colDef:t.getColDef()})}bulkRefresh(e={},t,i={}){let{beans:n,gos:o}=this,{editModelSvc:s,rowModel:r}=n;gt(o,r)&&(e.rowNode&&e.column?this.refCell(e,this.model.getEdit(e),i):t&&s?.getEditMap(!1)?.forEach((a,l)=>{for(let d of a.keys())this.refCell({rowNode:l,column:d},a.get(d),i)}))}refCell({rowNode:e,column:t},i,n={}){let{beans:o,gos:s}=this,r=new Set([e]),a=new Set,l=e.pinnedSibling;l&&r.add(l);let d=e.sibling;d&&a.add(d);let c=e.parent;for(;c;)c.sibling?.footer&&s.get("groupTotalRow")||!c.parent&&c.sibling&&s.get("grandTotalRow")?a.add(c.sibling):a.add(c),c=c.parent;for(let u of r)this.dispatchEditValuesChanged({rowNode:u,column:t},i);for(let u of r)et(o,{rowNode:u,column:t})?.refreshCell(n);for(let u of a)et(o,{rowNode:u,column:t})?.refreshCell(n)}stopAllEditing(e=!1,t="ui"){this.isEditing()&&this.stopEditing(void 0,{cancel:e,source:t})}isCellEditable(e,t="ui"){let{rowNode:i}=e,{gos:n,beans:o}=this;if(i.group){if(n.get("treeData")){if(!i.data&&!n.get("enableGroupEdit"))return!1}else if(!n.get("enableGroupEdit"))return!1}let s=LR(n)==="fullRow"?zK(o,e,t):ZC(o,e,t);return s&&(this.strategy??(this.strategy=this.createStrategy())),s}cellEditingInvalidCommitBlocks(){return this.gos.get("invalidEditValueMode")==="block"}checkNavWithValidation(e,t,i=!0){if(this.hasValidationErrors(e)){let n=et(this.beans,e);return this.cellEditingInvalidCommitBlocks()?(t?.preventDefault?.(),i&&(!n?.hasBrowserFocus()&&n?.focusCell(),n?.comp?.getCellEditor()?.focusIn?.()),"block-stop"):(n&&this.revertSingleCellEdit(n),"revert-continue")}return"continue"}revertSingleCellEdit(e,t=!1){let i=et(this.beans,e);i?.comp?.getCellEditor()&&(ga(this.beans,[e],{silent:!0}),this.model.clearEditValue(e),ya(this.beans,e,{silent:!0}),Ys(this.beans),i?.refreshCell(Wl),t&&(i?.focusCell(),i?.comp?.getCellEditor()?.focusIn?.()))}hasValidationErrors(e){Ys(this.beans);let t=et(this.beans,e);t&&(t.refreshCell(Wl),t.rowCtrl.rowEditStyleFeature?.applyRowStyles());let i=!1;return e?.rowNode?(i||(i=this.model.getRowValidationModel().hasRowValidation({rowNode:e.rowNode})),e.column&&(i||(i=this.model.getCellValidationModel().hasCellValidation({rowNode:e.rowNode,column:e.column})))):(i||(i=this.model.getCellValidationModel().getCellValidationMap().size>0),i||(i=this.model.getRowValidationModel().getRowValidationMap().size>0)),i}moveToNextCell(e,t,i,n="ui"){let o,s=this.isEditing(),r=s&&this.checkNavWithValidation(void 0,i)==="block-stop";return e instanceof fa&&s&&(o=this.strategy?.moveToNextEditingCell(e,t,i,n,r)),o===null||(o=o||!!this.beans.focusSvc.focusedHeader,o===!1&&!r&&this.stopEditing()),o}getCellDataValue({rowNode:e,column:t},i=!0){if(!e||!t)return;let n=this.model.getEdit({rowNode:e,column:t}),o=e.pinnedSibling;if(o){let r=this.model.getEdit({rowNode:o,column:t});r&&(n=r)}let s=i?n?.editorValue??n?.pendingValue:n?.pendingValue;return s===Bi||!n?n?.sourceValue??this.valueSvc.getValue(t,e,!1,"api"):s}addStopEditingWhenGridLosesFocus(e){dq(this,this.beans,e)}createPopupEditorWrapper(e){return new HK(e)}commitNextEdit(){this.committing=!0}setDataValue(e,t,i){try{if((!this.isEditing()||this.committing)&&!JK.has(i))return;let{beans:n}=this;this.strategy??(this.strategy=this.createStrategy());let o=this.isBatchEditing()?"ui":this.committing?i??"api":"api";if(!i||KK.has(i))return op(n,e,t,i,void 0,{persist:!0}),this.setNodeDataValue(e.rowNode,e.column,t,!0,i);let s=this.model.getEdit(e);if(s){if(s.pendingValue===t)return!1;if(s.sourceValue!==t)return op(n,e,t,i,void 0,{persist:!0}),this.stopEditing(e,{source:o,suppressNavigateAfterEdit:!0}),!0;if(s.sourceValue===t)return n.editModelSvc?.removeEdits(e),this.dispatchEditValuesChanged(e,_(b({},s),{pendingValue:t})),!0}return op(n,e,t,i,void 0,{persist:!0}),this.stopEditing(e,{source:o,suppressNavigateAfterEdit:!0}),!0}finally{this.committing=!1}}handleColDefChanged(e){hq(this.beans,e)}destroy(){this.model.clear(),this.destroyStrategy(),super.destroy()}prepDetailsDuringBatch(e,t){if(!this.batch||!this.model.hasRowEdits(e.rowNode,Qr))return;let{rowNode:n,column:o}=e,{compDetails:s,valueToDisplay:r}=t;if(s){let{params:l}=s;return l.data=this.model.getEditRowDataValue(n,Qr),{compDetails:s}}let a=this.model.getEditRow(e.rowNode,Qr);if(r!==void 0&&a?.has(o))return{valueToDisplay:this.valueSvc.getValue(o,n)}}cleanupEditors(){this.strategy?.cleanupEditors()}dispatchCellEvent(e,t,i,n){this.strategy?.dispatchCellEvent(e,t,i,n)}dispatchBatchEvent(e,t){this.eventSvc.dispatchEvent(this.createBatchEditEvent(e,t))}createBatchEditEvent(e,t){return te(this.gos,b({type:e},e==="batchEditingStopped"?{changes:this.toEventChangeList(t)}:{}))}toEventChangeList(e){return this.model.getEditPositions(e).map(t=>({rowIndex:t.rowNode.rowIndex,rowPinned:t.rowNode.rowPinned,columnId:t.column.getColId(),newValue:t.pendingValue,oldValue:t.sourceValue}))}applyBulkEdit({rowNode:e,column:t},i){if(!i||i.length===0)return;let{beans:n,rangeSvc:o,valueSvc:s}=this;Bs(n,{persist:!0});let r=this.model.getEditMap(!0),a=r.get(e)?.get(t)?.pendingValue;this.batch||this.eventSvc.dispatchEvent({type:"bulkEditingStarted"}),i.forEach(d=>{if(o?.forEachRowInRange(d,c=>{let u=ho(n,c);if(u===void 0)return;let h=r.get(u)??new Map;for(let p of d.columns)if(p&&this.isCellEditable({rowNode:u,column:p},"api")){let g=s.getValue(p,u,!0,"api"),f=s.parseValue(p,u??null,a,g);Number.isNaN(f)&&(f=null),h.set(p,{editorValue:void 0,pendingValue:f,sourceValue:g,state:"changed",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}})}h.size>0&&r.set(u,h)}),this.setEditMap(r),this.batch){this.cleanupEditors(),jC(n),this.bulkRefresh();return}this.commitNextEdit(),this.stopEditing(void 0,{source:"bulk"}),this.eventSvc.dispatchEvent({type:"bulkEditingStopped",changes:this.toEventChangeList(r)})}),this.bulkRefresh();let l=et(n,{rowNode:e,column:t});l&&l.focusCell(!0)}createCellStyleFeature(e,t){return new WK(e,t)}createRowStyleFeature(e,t){return new UK(e,t)}setEditingCells(e,t){let{beans:i}=this,{colModel:n,valueSvc:o}=i,s=new Map;for(let{colId:r,column:a,colKey:l,rowIndex:d,rowPinned:c,newValue:u,state:h}of e){let p=r?n.getCol(r):l?n.getCol(l):a;if(!p)continue;let g=ho(i,{rowIndex:d,rowPinned:c});if(!g)continue;let f=o.getValue(p,g,!0,"api");if(!t?.forceRefreshOfEditCellsOnly&&!so({pendingValue:u,sourceValue:f})&&h!=="editing")continue;let m=s.get(g);m||(m=new Map,s.set(g,m)),u===void 0&&(u=Bi),m.set(p,{editorValue:void 0,pendingValue:u,sourceValue:f,state:h??"changed",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}})}this.setEditMap(s,t)}onCellFocused(e){let t=et(this.beans,e);if(!t||!this.isEditing(t,Qr))return;let i=this.model.getEdit(t);if(!i||!so(i))return;let o=this.getLocaleTextFunc()("ariaPendingChange","Pending Change");this.beans.ariaAnnounce?.announceValue(o,"pendingChange")}allowedFocusTargetOnValidation(e){return et(this.beans,e)}};function eY(e){return{rowNodes:e?Array.from(e.keys()):void 0,columns:e?[...new Set(Array.from(e.values()).flatMap(t=>Array.from(t.keys())))]:void 0}}function LR(e,t){return t??e.get("editType")??"singleCell"}var WP=class extends D{postConstruct(){this.model=this.beans.editModelSvc,this.editSvc=this.beans.editSvc,this.addManagedEventListeners({cellFocused:this.onCellFocusChanged?.bind(this),cellFocusCleared:this.onCellFocusChanged?.bind(this)})}clearEdits(e){this.model.clearEditValue(e)}onCellFocusChanged(e){let t,i=e.previousParams,{editSvc:n,beans:o}=this,s=e.type==="cellFocused"?e.sourceEvent:null;i&&(t=et(o,i));let{gos:r,editModelSvc:a}=o,l=e.type==="cellFocusCleared";if(n.isEditing(void 0,{withOpenEditor:!0})){let{column:d,rowIndex:c,rowPinned:u}=e,h={column:d,rowNode:ho(o,{rowIndex:c,rowPinned:u})},p=r.get("invalidEditValueMode")==="block";if(p)return;let g=!p,f=!!a?.getCellValidationModel().hasCellValidation(h),m=g&&f;(i||l?n.stopEditing(void 0,{cancel:m,source:l&&g?"api":void 0,event:s}):!0)||(n.isBatchEditing()?n.cleanupEditors():n.stopEditing(void 0,{source:"api"}))}t?.refreshCell({suppressFlash:!0,force:!0})}stop(e,t){let i=this.model.getEditPositions(),n={all:[],pass:[],fail:[]};for(let o of i){if(n.all.push(o),(this.model.getCellValidationModel().getCellValidation(o)?.errorMessages?.length??0)>0){n.fail.push(o);continue}n.pass.push(o)}if(e)for(let o of i)Ep(this.beans,o,{cancel:e}),this.model.stop(o);else{let o=this.processValidationResults(n);if(o.destroy.length>0)for(let s of o.destroy)Ep(this.beans,s,{event:t,cancel:e}),this.model.stop(s);if(o.keep.length>0)for(let s of o.keep){let r=et(this.beans,s);this.editSvc?.cellEditingInvalidCommitBlocks()||r&&this.editSvc.revertSingleCellEdit(r)}}return!0}cleanupEditors({rowNode:e}={},t){Bs(this.beans,{persist:!1});let i=this.model.getEditPositions(),n=[];if(e)for(let o of i)o.rowNode!==e&&n.push(o);else for(let o of i)n.push(o);ga(this.beans,n),jC(this.beans,t)}setFocusOutOnEditor(e){e.comp?.getCellEditor()?.focusOut?.()}setFocusInOnEditor(e){let t=e.comp,i=t?.getCellEditor();if(i?.focusIn)i.focusIn();else{let n=this.beans.gos.get("editType")==="fullRow";e.focusCell(n),e.onEditorAttachedFuncs.push(()=>t?.getCellEditor()?.focusIn?.())}}setupEditors(e){let{event:t,ignoreEventKey:i=!1,startedEdit:n,position:o,cells:s=this.model.getEditPositions()}=e,r=t instanceof KeyboardEvent&&!i&&t.key||void 0;uq(this.beans,s,o,r,t,n)}dispatchCellEvent(e,t,i,n){let o=et(this.beans,e);o&&this.eventSvc.dispatchEvent(b(b({},o.createEvent(t??null,i)),n))}dispatchRowEvent(e,t,i){if(i)return;let n=Nv(this.beans,e);n&&this.eventSvc.dispatchEvent(n.createRowEvent(t))}shouldStop(e,t,i="ui"){let n=this.editSvc.isBatchEditing();return n&&i==="api"?!0:n&&(i==="ui"||i==="edit")?!1:i==="api"?!0:t instanceof KeyboardEvent&&!n?t.key===R.ENTER:null}shouldCancel(e,t,i="ui"){let n=this.editSvc.isBatchEditing();return!!(t instanceof KeyboardEvent&&!n&&t.key===R.ESCAPE||n&&i==="api"||i==="api")}setEditMap(e,t){t?.update||this.editSvc.stopEditing(void 0,{cancel:!0,source:"api"});let i=[];if(e.forEach((n,o)=>{n.forEach((s,r)=>{s.state==="editing"&&i.push(_(b({},s),{rowNode:o,column:r}))})}),t?.update&&(e=new Map([...this.model.getEditMap(),...e])),this.model?.setEditMap(e),i.length>0){let n=i.at(-1),o=n.pendingValue===Bi?void 0:n.pendingValue;this.start({position:n,event:new KeyboardEvent("keydown",{key:o}),source:"api"});let s=et(this.beans,n);s&&this.setFocusInOnEditor(s)}}destroy(){this.cleanupEditors(),super.destroy()}},tY=class extends WP{constructor(){super(...arguments),this.beanName="fullRow",this.startedRows=[]}shouldStop(e,t,i="ui"){let{rowNode:n}=e||{};if(!Nv(this.beans,{rowNode:this.rowNode}))return!0;let s=super.shouldStop({rowNode:this.rowNode},t,i);return s!==null?s:this.rowNode?n!==this.rowNode:!1}midBatchInputsAllowed({rowNode:e}){return e?this.model.hasEdits({rowNode:e}):!1}clearEdits(e){this.model.clearEditValue(e)}start(e){let{position:t,silent:i,startedEdit:n,event:o,ignoreEventKey:s}=e,{rowNode:r}=t;this.rowNode!==r&&super.cleanupEditors(t);let a=this.beans.visibleCols.allCols,l=[],d=[];for(let c of a)c.isCellEditable(r)&&d.push(c);if(d.length!=0){this.dispatchRowEvent({rowNode:r},"rowEditingStarted",i),this.startedRows.push(r);for(let c of d){let u={rowNode:r,column:c};l.push(u),this.model.hasEdits(u)||this.model.start(u)}this.rowNode=r,this.setupEditors({cells:l,position:t,startedEdit:n,event:o,ignoreEventKey:s})}}processValidationResults(e){return e.fail.length>0&&this.editSvc.cellEditingInvalidCommitBlocks()?{destroy:[],keep:e.all}:{destroy:e.all,keep:[]}}stop(e,t){let{rowNode:i}=this;if(i&&!this.model.hasRowEdits(i))return!1;let n=[];if(e||this.model.getEditMap().forEach((o,s)=>{if(!(!o||o.size===0)){for(let r of o.values())if(so(r)){n.push(s);break}}}),Ys(this.beans),!e&&this.editSvc?.checkNavWithValidation({rowNode:i})==="block-stop")return!1;super.stop(e,t);for(let o of n)this.dispatchRowEvent({rowNode:o},"rowValueChanged");return this.cleanupEditors({rowNode:i},!0),this.rowNode=void 0,!0}onCellFocusChanged(e){let{rowIndex:t}=e,i=e.previousParams;if(i?.rowIndex===t||e.sourceEvent instanceof KeyboardEvent)return;let n=et(this.beans,i);this.gos.get("invalidEditValueMode")==="block"&&n&&(this.model.getCellValidationModel().getCellValidation(n)||this.model.getRowValidationModel().getRowValidation(n))||super.onCellFocusChanged(e)}cleanupEditors(e={},t){super.cleanupEditors(e,t);for(let i of this.startedRows)this.dispatchRowEvent({rowNode:i},"rowEditingStopped");this.startedRows.length=0}moveToNextEditingCell(e,t,i,n="ui",o=!1){let s=e.cellPosition,r;this.model.suspend(!0);try{r=this.beans.navigation?.findNextCellToFocusOn(s,{backwards:t,startEditing:!0,skipToNextEditableCell:!1})}finally{this.model.suspend(!1)}if(r===!1)return null;if(r==null)return!1;let a=r.cellPosition,l=e.isCellEditable(),d=r.isCellEditable(),c=a&&s.rowIndex===a.rowIndex&&s.rowPinned===a.rowPinned;l&&this.setFocusOutOnEditor(e),this.restoreEditors();let u=this.gos.get("suppressStartEditOnTab");return d&&!o?u?r.focusCell(!0,i):(r.comp?.getCellEditor()||ya(this.beans,r,{event:i,cellStartedEdit:!0}),this.setFocusInOnEditor(r),r.focusCell(!1,i)):(d&&o&&this.setFocusInOnEditor(r),r.focusCell(!0,i)),!c&&!o&&(this.editSvc?.stopEditing({rowNode:e.rowNode},{event:i}),this.cleanupEditors(r,!0),u?r.focusCell(!0,i):this.editSvc.startEditing(r,{startedEdit:!0,event:i,source:n,ignoreEventKey:!0})),e.rowCtrl?.refreshRow({suppressFlash:!0,force:!0}),!0}restoreEditors(){this.model.getEditMap().forEach((e,t)=>e.forEach(({state:i},n)=>{if(i!=="editing")return;let o=et(this.beans,{rowNode:t,column:n});o&&!o.comp?.getCellEditor()&&ya(this.beans,o,{silent:!0})}))}destroy(){super.destroy(),this.rowNode=void 0,this.startedRows.length=0}},iY=class extends WP{constructor(){super(...arguments),this.beanName="singleCell"}shouldStop(e,t,i="ui"){let n=super.shouldStop(e,t,i);if(n!==null)return n;let{rowNode:o,column:s}=e||{};return(!this.rowNode||!this.column)&&o&&s?null:this.rowNode!==o||this.column!==s}midBatchInputsAllowed(e){return this.model.hasEdits(e)}start(e){let{position:t,startedEdit:i,event:n,ignoreEventKey:o}=e;(this.rowNode!==t.rowNode||this.column!==t.column)&&super.cleanupEditors(),this.rowNode=t.rowNode,this.column=t.column,this.model.start(t),this.setupEditors({cells:[t],position:t,startedEdit:i,event:n,ignoreEventKey:o})}dispatchRowEvent(e,t,i){}processValidationResults(e){return e.fail.length>0&&this.editSvc.cellEditingInvalidCommitBlocks()?{destroy:[],keep:e.all}:{destroy:e.all,keep:[]}}stop(e,t){return super.stop(e,t),this.rowNode=void 0,this.column=void 0,!0}onCellFocusChanged(e){let{colModel:t,editSvc:i}=this.beans,{rowIndex:n,column:o,rowPinned:s}=e,r=ho(this.beans,{rowIndex:n,rowPinned:s}),a=$C(o),l=t.getCol(a),d=e.previousParams;if(d){let c=$C(d.column);if(d?.rowIndex===n&&c===a&&d?.rowPinned===s)return}i?.isEditing({rowNode:r,column:l},{withOpenEditor:!0})&&e.type==="cellFocused"||super.onCellFocusChanged(e)}moveToNextEditingCell(e,t,i,n="ui",o=!1){let s=this.beans.focusSvc.getFocusedCell();s&&(e=oa(this.beans,s)??e);let r=e.cellPosition,a,l=this.beans.gos.get("editType")==="fullRow";l&&this.model.suspend(!0),o||(e.eGui.focus(),this.editSvc?.stopEditing(e,{source:this.editSvc?.isBatchEditing()?"ui":"api",event:i}));try{a=this.beans.navigation?.findNextCellToFocusOn(r,{backwards:t,startEditing:!0})}finally{l&&this.model.suspend(!1)}if(a===!1)return null;if(a==null)return!1;let d=a.cellPosition,c=e.isCellEditable(),u=a.isCellEditable(),h=d&&r.rowIndex===d.rowIndex&&r.rowPinned===d.rowPinned;c&&!o&&this.setFocusOutOnEditor(e);let p=this.gos.get("suppressStartEditOnTab");if(!h&&!o&&(super.cleanupEditors(a,!0),p?a.focusCell(!0,i):this.editSvc.startEditing(a,{startedEdit:!0,event:i,source:n,ignoreEventKey:!0})),u&&!o){if(a.focusCell(!1,i),p)a.focusCell(!0,i);else if(!a.comp?.getCellEditor()){let g=this.editSvc?.isEditing(a,{withOpenEditor:!0});ya(this.beans,a,{event:i,cellStartedEdit:!0,silent:g}),this.setFocusInOnEditor(a),this.cleanupEditors(a)}}else u&&o&&this.setFocusInOnEditor(a),a.focusCell(!0,i);return e.rowCtrl?.refreshRow({suppressFlash:!0,force:!0}),!0}destroy(){super.destroy(),this.rowNode=void 0,this.column=void 0}},is={moduleName:"EditCore",version:z,beans:[lq,ZK],apiFunctions:{getEditingCells:TK,getEditRowValues:FK,getCellEditorInstances:cq,startEditingCell:LK,stopEditing:AK,isEditing:IK,validateEdit:_K},dynamicBeans:{singleCell:iY,fullRow:tY},dependsOn:[Op,_P],css:[aK]},nY={moduleName:"UndoRedoEdit",version:z,beans:[rK],apiFunctions:{undoCellEditing:kK,redoCellEditing:DK,getCurrentUndoSize:OK,getCurrentRedoSize:NK},dependsOn:[is]},oY={moduleName:"TextEditor",version:z,userComponents:{agCellEditor:IR,agTextCellEditor:IR},dependsOn:[is]},sY={moduleName:"NumberEditor",version:z,userComponents:{agNumberCellEditor:{classImp:bK}},dependsOn:[is]},rY={moduleName:"DateEditor",version:z,userComponents:{agDateCellEditor:hK,agDateStringCellEditor:fK},dependsOn:[is]},aY={moduleName:"CheckboxEditor",version:z,userComponents:{agCheckboxCellEditor:dK},dependsOn:[is]},lY={moduleName:"SelectEditor",version:z,userComponents:{agSelectCellEditor:SK},dependsOn:[is]},dY={moduleName:"LargeTextEditor",version:z,userComponents:{agLargeTextCellEditor:CK},dependsOn:[is]},cY={moduleName:"CustomEditor",version:z,dependsOn:[is]},uY=class extends D{constructor(){super(...arguments),this.beanName="selectionColSvc"}postConstruct(){this.addManagedPropertyListener("rowSelection",e=>{this.onSelectionOptionsChanged(e.currentValue,e.previousValue,ca(e.source))}),this.addManagedPropertyListener("selectionColumnDef",this.updateColumns.bind(this))}addColumns(e){let t=this.columns;t!=null&&(e.list=t.list.concat(e.list),e.tree=t.tree.concat(e.tree),RO(e))}createColumns(e,t){let i=()=>{fp(this.beans,this.columns?.tree),this.columns=null},n=e.treeDepth,s=(this.columns?.treeDepth??-1)==n,r=this.generateSelectionCols();if(EO(r,this.columns?.list??[])&&s)return;i();let{colGroupSvc:l}=this.beans,d=l?.findDepth(e.tree)??0,c=l?.balanceTreeForAutoCols(r,d)??[];this.columns={list:r,tree:c,treeDepth:d,map:{}},t(h=>{if(!h)return null;let p=h.filter(g=>!go(g));return[...r,...p]})}updateColumns(e){let t=ca(e.source);for(let i of this.columns?.list??[]){let n=this.createSelectionColDef(e.currentValue);i.setColDef(n,null,t),Ki(this.beans,{state:[_(b({},n),{colId:i.getColId()})]},t)}}getColumn(e){return this.columns?.list.find(t=>Ql(t,e))??null}getColumns(){return this.columns?.list??null}isSelectionColumnEnabled(){let{gos:e,beans:t}=this,i=e.get("rowSelection");if(typeof i!="object"||!Gs(e))return!1;let n=(t.autoColSvc?.getColumns()?.length??0)>0;if(i.checkboxLocation==="autoGroupColumn"&&n)return!1;let o=!!da(i),s=Xh(i);return o||s}createSelectionColDef(e){let{gos:t}=this,i=e??t.get("selectionColumnDef"),n=t.get("enableRtl"),a=i??{},{rowSpan:o,spanRows:s}=a,r=oi(a,["rowSpan","spanRows"]);return _(b({width:50,resizable:!1,suppressHeaderMenuButton:!0,sortable:!1,suppressMovable:!0,lockPosition:n?"right":"left",comparator(l,d,c,u){let h=c.isSelected(),p=u.isSelected();return h===p?0:h?1:-1},editable:!1,suppressFillHandle:!0,pinned:null},r),{colId:M6,chartDataType:"excluded"})}generateSelectionCols(){if(!this.isSelectionColumnEnabled())return[];let e=this.createSelectionColDef(),t=e.colId;this.gos.validateColDef(e,t,!0);let i=new Js(e,null,t,!1);return this.createBean(i),[i]}onSelectionOptionsChanged(e,t,i){let n=t&&typeof t!="string"?da(t):void 0,o=e&&typeof e!="string"?da(e):void 0,s=n!==o,r=t&&typeof t!="string"?Xh(t):void 0,a=e&&typeof e!="string"?Xh(e):void 0,l=r!==a,d=hp(e),c=hp(t);(s||l||d!==c)&&this.beans.colModel.refreshAll(i)}destroy(){fp(this.beans,this.columns?.tree),super.destroy()}refreshVisibility(e,t,i){if(!this.columns?.list.length)return;let n=e.length+t.length+i.length;if(n===0)return;let o=this.columns.list[0];if(!o.isVisible())return;let s=()=>{let l;switch(o.pinned){case"left":case!0:l=e;break;case"right":l=i;break;default:l=t}l&&Yi(l,o)};(this.beans.rowNumbersSvc?.getColumn(k6)?2:1)===n&&s()}};function hY(e,t){if(!t.nodes.every(r=>r.rowPinned&&!Sd(r)?(I(59),!1):r.id===void 0?(I(60),!1):!0))return;let{nodes:n,source:o,newValue:s}=t;e.selectionSvc?.setNodesSelected({nodes:n,source:o??"api",newValue:s})}function pY(e,t,i="apiSelectAll"){e.selectionSvc?.selectAllRowNodes({source:i,selectAll:t})}function gY(e,t,i="apiSelectAll"){e.selectionSvc?.deselectAllRowNodes({source:i,selectAll:t})}function fY(e,t="apiSelectAllFiltered"){e.selectionSvc?.selectAllRowNodes({source:t,selectAll:"filtered"})}function mY(e,t="apiSelectAllFiltered"){e.selectionSvc?.deselectAllRowNodes({source:t,selectAll:"filtered"})}function CY(e,t="apiSelectAllCurrentPage"){e.selectionSvc?.selectAllRowNodes({source:t,selectAll:"currentPage"})}function vY(e,t="apiSelectAllCurrentPage"){e.selectionSvc?.deselectAllRowNodes({source:t,selectAll:"currentPage"})}function wY(e){return e.selectionSvc?.getSelectedNodes()??[]}function bY(e){return e.selectionSvc?.getSelectedRows()??[]}var yY=class extends NG{constructor(){super(...arguments),this.beanName="selectionSvc",this.selectedNodes=new Map,this.detailSelection=new Map,this.masterSelectsDetail=!1}postConstruct(){super.postConstruct();let{gos:e}=this;this.mode=pp(e),this.groupSelectsDescendants=cd(e),this.groupSelectsFiltered=gp(e)==="filteredDescendants",this.masterSelectsDetail=RE(e)==="detail",this.addManagedPropertyListeners(["groupSelectsChildren","groupSelectsFiltered","rowSelection"],()=>{let t=cd(e),i=pp(e),n=gp(e)==="filteredDescendants";this.masterSelectsDetail=RE(e)==="detail",(t!==this.groupSelectsDescendants||n!==this.groupSelectsFiltered||i!==this.mode)&&(this.deselectAllRowNodes({source:"api"}),this.groupSelectsDescendants=t,this.groupSelectsFiltered=n,this.mode=i)}),this.addManagedEventListeners({rowSelected:this.onRowSelected.bind(this)})}destroy(){super.destroy(),this.resetNodes()}handleSelectionEvent(e,t,i){if(this.isRowSelectionBlocked(t))return 0;let n=this.inferNodeSelections(t,e.shiftKey,e.metaKey||e.ctrlKey,i);if(n==null)return 0;if(this.selectionCtx.selectAll=!1,"select"in n)return n.reset?this.resetNodes():this.selectRange(n.deselect,!1,i),this.selectRange(n.select,!0,i);{let o=n.checkFilteredNodes?qP(n.node):n.newValue;return this.setNodesSelected({nodes:[n.node],newValue:o,clearSelection:n.clearSelection,keepDescendants:n.keepDescendants,event:e,source:i})}}setNodesSelected({newValue:e,clearSelection:t,suppressFinishActions:i,nodes:n,event:o,source:s,keepDescendants:r=!1}){if(n.length===0)return 0;let{gos:a}=this;if(!Gs(a)&&e)return I(132),0;if(n.length>1&&!this.isMultiSelect())return I(130),0;let l=0;for(let d=0;d<n.length;d++){let c=n[d],u=Zr(c);if(u.rowPinned&&!Sd(u)){I(59);continue}if(u.id===void 0){I(60);continue}this.groupSelectsFiltered&&u.group&&!a.get("treeData")||this.selectRowNode(u,e,o,s)&&(this.detailSelection.delete(u.id),l++),this.groupSelectsDescendants&&u.childrenAfterGroup?.length&&(l+=this.selectChildren(u,e,s))}return i||(n.length===1&&s==="api"&&this.selectionCtx.setRoot(Zr(n[0])),e&&(t||!this.isMultiSelect())&&(l+=this.clearOtherNodes(Zr(n[0]),r,s)),l>0&&(this.updateGroupsFromChildrenSelections(s),this.dispatchSelectionChanged(s))),l}selectRange(e,t,i){let n=0;return e.forEach(o=>{let s=Zr(o);if(s.group&&this.groupSelectsDescendants)return;this.selectRowNode(s,t,void 0,i)&&n++}),n>0&&(this.updateGroupsFromChildrenSelections(i),this.dispatchSelectionChanged(i)),n}selectChildren(e,t,i){let n=this.groupSelectsFiltered?e.childrenAfterAggFilter:e.childrenAfterGroup;return n?this.setNodesSelected({newValue:t,clearSelection:!1,suppressFinishActions:!0,source:i,nodes:n}):0}getSelectedNodes(){return Array.from(this.selectedNodes.values())}getSelectedRows(){let e=[];return this.selectedNodes.forEach(t=>t.data&&e.push(t.data)),e}getSelectionCount(){return this.selectedNodes.size}filterFromSelection(e){let t=new Map;this.selectedNodes.forEach((i,n)=>{e(i)&&t.set(n,i)}),this.selectedNodes=t}updateGroupsFromChildrenSelections(e,t){if(!this.groupSelectsDescendants)return!1;let{gos:i,rowModel:n}=this.beans;if(!gt(i,n))return!1;let o=n.rootNode;if(!o)return!1;t||(t=new pd(!0,o),t.active=!1);let s=!1;return t.forEachChangedNodeDepthFirst(r=>{if(r!==o){let a=this.calculateSelectedFromChildren(r);s=this.selectRowNode(r,a===null?!1:a,void 0,e)||s}}),s}clearOtherNodes(e,t,i){let n=new Map,o=0;return this.selectedNodes.forEach(s=>{let r=s.id==e.id;if((t?!xY(e,s):!0)&&!r){let l=this.selectedNodes.get(s.id);o+=this.setNodesSelected({nodes:[l],newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:i}),this.groupSelectsDescendants&&s.parent&&n.set(s.parent.id,s.parent)}}),n.forEach(s=>{let r=this.calculateSelectedFromChildren(s);this.selectRowNode(s,r===null?!1:r,void 0,i)}),o}onRowSelected(e){let t=e.node;this.groupSelectsDescendants&&t.group||(t.isSelected()?this.selectedNodes.set(t.id,t):this.selectedNodes.delete(t.id))}syncInRowNode(e,t){this.syncInOldRowNode(e,t),this.syncInNewRowNode(e)}createDaemonNode(e){if(!e.id)return;let t=new Jo(this.beans);return t.id=e.id,t.data=e.data,t.__selected=e.__selected,t.level=e.level,t}syncInOldRowNode(e,t){t&&e.id!==t.id&&this.selectedNodes.get(t.id)==e&&this.selectedNodes.set(t.id,t)}syncInNewRowNode(e){this.selectedNodes.has(e.id)?(e.__selected=!0,this.selectedNodes.set(e.id,e)):e.__selected=!1}reset(e){let t=this.getSelectionCount();this.resetNodes(),t&&this.dispatchSelectionChanged(e)}resetNodes(){this.selectedNodes.forEach(e=>{this.selectRowNode(e,!1)}),this.selectedNodes.clear()}getBestCostNodeSelection(){let{gos:e,rowModel:t}=this.beans;if(!gt(e,t))return;let i=t.getTopLevelNodes();if(i===null)return;let n=[];function o(s){for(let r=0,a=s.length;r<a;r++){let l=s[r];l.isSelected()?n.push(l):l.group&&l.childrenAfterGroup&&o(l.childrenAfterGroup)}}return o(i),n}isEmpty(){return this.getSelectionCount()===0}deselectAllRowNodes({source:e,selectAll:t}){let i=gt(this.gos),n=!1,o=s=>{let r=this.selectRowNode(Zr(s),!1,void 0,e);n||(n=r)};if(t==="currentPage"||t==="filtered"){if(!i){Ge(102);return}this.getNodesToSelect(t).forEach(o)}else this.selectedNodes.forEach(o),this.reset(e);if(this.selectionCtx.selectAll=!1,i&&this.groupSelectsDescendants){let s=this.updateGroupsFromChildrenSelections(e);n||(n=s)}n&&this.dispatchSelectionChanged(e)}getSelectedCounts(e){let t=0,i=0;return this.getNodesToSelect(e).forEach(n=>{this.groupSelectsDescendants&&n.group||(n.isSelected()?t++:n.selectable&&i++)}),{selectedCount:t,notSelectedCount:i}}getSelectAllState(e){let{selectedCount:t,notSelectedCount:i}=this.getSelectedCounts(e);return UP(t,i)??null}hasNodesToSelect(e){return this.getNodesToSelect(e).filter(t=>t.selectable).length>0}getNodesToSelect(e){if(!this.canSelectAll())return[];let t=[],i=o=>t.push(o);if(e==="currentPage")return this.forEachNodeOnPage(o=>{if(!o.group){i(o);return}if(!o.expanded&&!o.footer){let s=r=>{i(r),r.childrenAfterFilter?.forEach(s)};s(o);return}this.groupSelectsDescendants||i(o)}),t;let n=this.beans.rowModel;return e==="filtered"?(n.forEachNodeAfterFilter(i),t):(n.forEachNode(i),t)}forEachNodeOnPage(e){let{pageBounds:t,rowModel:i}=this.beans,n=t.getFirstRow(),o=t.getLastRow();for(let s=n;s<=o;s++){let r=i.getRow(s);r&&e(r)}}selectAllRowNodes(e){let{gos:t,selectionCtx:i}=this;if(!Gs(t)){I(132);return}if(uO(t)&&!dd(t)){I(130);return}if(!this.canSelectAll())return;let{source:n,selectAll:o}=e,s=!1;if(this.getNodesToSelect(o).forEach(r=>{let a=this.selectRowNode(Zr(r),!0,void 0,n);s||(s=a)}),i.selectAll=!0,gt(t)&&this.groupSelectsDescendants){let r=this.updateGroupsFromChildrenSelections(n);s||(s=r)}s&&this.dispatchSelectionChanged(n)}getSelectionState(){return this.isEmpty()?null:Array.from(this.selectedNodes.keys())}setSelectionState(e,t,i){if(e||(e=[]),!Array.isArray(e)){Ge(103);return}let n=new Set(e),o=[];this.beans.rowModel.forEachNode(s=>{n.has(s.id)&&o.push(s)}),i&&this.resetNodes(),this.setNodesSelected({newValue:!0,nodes:o,source:t})}canSelectAll(){return gt(this.beans.gos)}updateSelectable(e){let{gos:t,rowModel:i}=this.beans;if(!Gs(t))return;let n="selectableChanged",o=e!==void 0,s=gt(t)&&this.groupSelectsDescendants,r=[],a=l=>{if(o&&!l.group)return;if(s&&l.group){let c=l.childrenAfterGroup?.some(u=>u.selectable)??!1;this.setRowSelectable(l,c,!0);return}!this.updateRowSelectable(l,!0)&&l.isSelected()&&r.push(l)};if(s){if(e===void 0){let l=i.rootNode;e=l?new pd(!1,l):void 0}e?.forEachChangedNodeDepthFirst(a,!o,!o)}else i.forEachNode(a);r.length&&this.setNodesSelected({nodes:r,newValue:!1,source:n}),!o&&s&&this.updateGroupsFromChildrenSelections?.(n)}updateSelectableAfterGrouping(e){this.updateSelectable(e),this.groupSelectsDescendants&&this.updateGroupsFromChildrenSelections?.("rowGroupChanged",e)&&this.dispatchSelectionChanged("rowGroupChanged")}refreshMasterNodeState(e,t){if(!this.masterSelectsDetail)return;let i=e.detailNode?.detailGridInfo?.api;if(!i)return;let n=SY(i);if(e.isSelected()!==n&&this.selectRowNode(e,n,t,"masterDetail")&&this.dispatchSelectionChanged("masterDetail"),!n){let s=this.detailSelection.get(e.id)??new Set;for(let r of i.getSelectedNodes())s.add(r.id);this.detailSelection.set(e.id,s)}}setDetailSelectionState(e,t,i){if(this.masterSelectsDetail){if(!dd(t)){I(269);return}switch(e.isSelected()){case!0:{i.selectAll();break}case!1:{i.deselectAll();break}case void 0:{let n=this.detailSelection.get(e.id);if(n){let o=[];for(let s of n){let r=i.getRowNode(s);r&&o.push(r)}i.setNodesSelected({nodes:o,newValue:!0,source:"masterDetail"})}break}default:break}}}dispatchSelectionChanged(e){this.eventSvc.dispatchEvent({type:"selectionChanged",source:e,selectedNodes:this.getSelectedNodes(),serverSideState:null})}};function Zr(e){return Sd(e)?e.pinnedSibling:e.footer?e.sibling:e}function SY(e){let t=0,i=0;return e.forEachNode(n=>{n.isSelected()?t++:n.selectable&&i++}),UP(t,i)}function UP(e,t){if(e===0&&t===0)return!1;if(!(e>0&&t>0))return e>0}function xY(e,t){let i=t.parent;for(;i;){if(i===e)return!0;i=i.parent}return!1}function qP(e){let t=e.isSelected()===!1,i=e.childrenAfterFilter?.some(qP)??!1;return t||i}var EY={moduleName:"SharedRowSelection",version:z,beans:[uY],apiFunctions:{setNodesSelected:hY,selectAll:pY,deselectAll:gY,selectAllFiltered:fY,deselectAllFiltered:mY,selectAllOnCurrentPage:CY,deselectAllOnCurrentPage:vY,getSelectedNodes:wY,getSelectedRows:bY}},RY={moduleName:"RowSelection",version:z,rowModels:["clientSide","infinite","viewport"],beans:[yY],dependsOn:[EY]};function PY(e){e.expansionSvc?.expandAll(!0)}function MY(e){e.expansionSvc?.expandAll(!1)}function $P(e){e.rowModel?.onRowHeightChanged()}function jP(e){if(e.rowAutoHeight?.active){I(3);return}e.rowModel?.resetRowHeights()}function kY(e,t,i){let n=D$(e);if(n){if(e.rowGroupColsSvc?.columns.length===0){if(t<0){Ge(238);return}n.setRowCount(t,i);return}Ge(28);return}_p(e)?.setRowCount(t,i)}function DY(e){return xa(e.gos)?e.rowModel.getBlockStates():e.rowNodeBlockLoader?.getBlockState()??{}}function FY(e){return e.rowModel.isLastRowIndexKnown()}var TY={moduleName:"CsrmSsrmSharedApi",version:z,apiFunctions:{expandAll:PY,collapseAll:MY}},AY={moduleName:"RowModelSharedApi",version:z,apiFunctions:{onRowHeightChanged:$P,resetRowHeights:jP}},IY={moduleName:"SsrmInfiniteSharedApi",version:z,apiFunctions:{setRowCount:kY,getCacheBlockState:DY,isLastRowIndexKnown:FY}},LY=class extends D{constructor(){super(...arguments),this.beanName="alignedGridsSvc",this.consuming=!1}getAlignedGridApis(){let e=this.gos.get("alignedGrids")??[],t=typeof e=="function";return typeof e=="function"&&(e=e()),e.map(n=>{if(!n){Ge(18),t||Ge(20);return}if(this.isGridApi(n))return n;let o=n;return"current"in o?o.current?.api:(o.api||Ge(19),o.api)}).filter(n=>!!n&&!n.isDestroyed())}isGridApi(e){return!!e&&!!e.dispatchEvent}postConstruct(){let e=this.fireColumnEvent.bind(this);this.addManagedEventListeners({columnMoved:e,columnVisible:e,columnPinned:e,columnGroupOpened:e,columnResized:e,bodyScroll:this.fireScrollEvent.bind(this),alignedGridColumn:({event:t})=>this.onColumnEvent(t),alignedGridScroll:({event:t})=>this.onScrollEvent(t)})}fireEvent(e){if(!this.consuming)for(let t of this.getAlignedGridApis())t.isDestroyed()||t.dispatchEvent(e)}onEvent(e){this.consuming=!0,e(),this.consuming=!1}fireColumnEvent(e){this.fireEvent({type:"alignedGridColumn",event:e})}fireScrollEvent(e){e.direction==="horizontal"&&this.fireEvent({type:"alignedGridScroll",event:e})}onScrollEvent(e){this.onEvent(()=>{this.beans.ctrlsSvc.getScrollFeature().setHorizontalScrollPosition(e.left,!0)})}extractDataFromEvent(e,t){let i=[];return e.columns?e.columns.forEach(n=>{i.push(t(n))}):e.column&&i.push(t(e.column)),i}getMasterColumns(e){return this.extractDataFromEvent(e,t=>t)}getColumnIds(e){return this.extractDataFromEvent(e,t=>t.getColId())}onColumnEvent(e){this.onEvent(()=>{switch(e.type){case"columnMoved":case"columnVisible":case"columnPinned":case"columnResized":{this.processColumnEvent(e);break}case"columnGroupOpened":{this.processGroupOpenedEvent(e);break}case"columnPivotChanged":I(21);break}})}processGroupOpenedEvent(e){let{colGroupSvc:t}=this.beans;if(t)for(let i of e.columnGroups){let n=null;i&&(n=t.getProvidedColGroup(i.getGroupId())),!(i&&!n)&&t.setColumnGroupOpened(n,i.isExpanded(),"alignedGridChanged")}}processColumnEvent(e){let t=e.column,i=null,n=this.beans,{colResize:o,ctrlsSvc:s,colModel:r}=n;if(t&&(i=r.getColDefCol(t.getColId())),t&&!i)return;let a=this.getMasterColumns(e);switch(e.type){case"columnMoved":{let u=e.api.getColumnState().map(h=>({colId:h.colId}));Ki(n,{state:u,applyOrder:!0},"alignedGridChanged")}break;case"columnVisible":{let u=e.api.getColumnState().map(h=>({colId:h.colId,hide:h.hide}));Ki(n,{state:u},"alignedGridChanged")}break;case"columnPinned":{let u=e.api.getColumnState().map(h=>({colId:h.colId,pinned:h.pinned}));Ki(n,{state:u},"alignedGridChanged")}break;case"columnResized":{let c=e,u={};for(let h of a)u[h.getId()]={key:h.getColId(),newWidth:h.getActualWidth()};for(let h of c.flexColumns??[])u[h.getId()]&&delete u[h.getId()];o?.setColumnWidths(Object.values(u),!1,c.finished,"alignedGridChanged");break}}let d=s.getGridBodyCtrl().isVerticalScrollShowing();for(let c of this.getAlignedGridApis())c.setGridOption("alwaysShowVerticalScroll",d)}},_Y={moduleName:"AlignedGrids",version:z,beans:[LY],dependsOn:[W4]},OY=class extends D{constructor(e){super(),this.rootNode=e,this.nextId=0,this.allNodesMap={},_R(e)}getRowNode(e){return this.allNodesMap[e]}setNewRowData(e){let{selectionSvc:t,pinnedRowModel:i,groupStage:n}=this.beans;t?.reset("rowDataChanged"),i?.isManual()&&i.reset(),this.dispatchRowDataUpdateStarted(e),this.allNodesMap=Object.create(null),this.nextId=0;let o=_R(this.rootNode),s=new Array(e.length);o._leafs=s;let r=0,a=n?.getNestedDataGetter(),l=a?new Set:null,d=(c,u)=>{let h=c.level+1;for(let p=0,g=u.length;p<g;++p){let f=u[p];if(!f)continue;let m=this.createRowNode(f,h);if(m.sourceRowIndex=r,s[r++]=m,l&&!l.has(f)){l.add(f),m.treeParent=c;let C=a(f);C&&d(m,C)}}};d(o,e),s.length=r}setImmutableRowData(e,t){let{rootNode:i,gos:n}=this;this.dispatchRowDataUpdateStarted(t);let o=Ca(n),s=e.changedRowNodes,{adds:r,updates:a}=s,l=new Set,d=[],c=this.beans.groupStage?.getNestedDataGetter(),u=n.get("suppressMaintainUnsortedOrder")?void 0:!1,h=-1,p=!1,g=(C,v)=>{if(!u&&u!==void 0){let w=C.sourceRowIndex;u=w<=h,h=w}C.data!==v&&(C.updateData(v),r.has(C)||a.add(C),!C.selectable&&C.isSelected()&&d.push(C))},f=(C,v,w)=>{for(let y=0,S=v.length;y<S;++y){let x=v[y];if(!x)continue;let E=this.getRowNode(o({data:x,level:w}));if(E?(g(E,x),p||(p=!!c&&E.treeParent!==C)):(E=this.createRowNode(x,w),r.add(E)),!c||l.has(E)){l.add(E);continue}l.add(E),E.treeParent=C;let T=c(x);T&&f(E,T,w+1)}};f(i,t,0);let m=this.deleteUnusedNodes(l,s,d)||u||r.size>0;if(m){let C=i._leafs??(i._leafs=[]);u===void 0?VY(C,l,s):GY(C,l)&&(s.reordered=!0)}(m||p||a.size)&&(e.rowDataUpdated=!0,this.deselect(d))}deleteUnusedNodes(e,{removals:t},i){let n=this.rootNode._leafs;for(let o=0,s=n.length;o<s;o++){let r=n[o];e.has(r)||(t.add(r),r.isSelected()&&i.push(r),this.deleteNode(r))}return t.size>0}updateRowData(e,t){if(this.dispatchRowDataUpdateStarted(e.add),this.beans.groupStage?.getNestedDataGetter())return I(268),{remove:[],update:[],add:[]};let i=[],n=Ca(this.gos),o=this.executeRemove(n,e,t,i),s=this.executeUpdate(n,e,t,i),r=this.executeAdd(e,t);return this.deselect(i),{remove:o,update:s,add:r}}executeRemove(e,{remove:t},{adds:i,updates:n,removals:o},s){let r=this.rootNode._leafs,a=r?.length,l=t?.length;if(!l||!a)return[];let d=0,c=a,u=0,h,p=new Array(l);for(let g=0;g<l;++g){let f=this.lookupNode(e,t[g]);if(!f)continue;let m=f.sourceRowIndex;m<c&&(c=m),m>u&&(u=m),f.isSelected()&&s.push(f),this.deleteNode(f),i.delete(f)?(h??(h=new Set),h.add(f)):(n.delete(f),o.add(f)),p[d++]=f}return p.length=d,d&&HY(r,c,u,o,h),p}executeUpdate(e,{update:t},{adds:i,updates:n},o){let s=t?.length;if(!s)return[];let r=new Array(s),a=0;for(let l=0;l<s;l++){let d=t[l],c=this.lookupNode(e,d);c&&(c.updateData(d),!c.selectable&&c.isSelected()&&o.push(c),r[a++]=c,i.has(c)||n.add(c))}return r.length=a,r}executeAdd(e,t){var i;let n=(i=this.rootNode)._leafs??(i._leafs=[]),o=n.length,s=e.add,r=s?.length;if(!r)return[];let a=o+r,l=this.sanitizeAddIndex(n,e.addIndex);if(l<o){for(let u=o-1,h=a-1;u>=l;--u){let p=n[u];p.sourceRowIndex=h,n[h--]=p}t.reordered=!0}n.length=a;let d=new Array(r),c=t.adds;for(let u=0;u<r;u++){let h=this.createRowNode(s[u],0);c.add(h),h.sourceRowIndex=l,n[l]=h,d[u]=h,l++}return d}dispatchRowDataUpdateStarted(e){this.eventSvc.dispatchEvent({type:"rowDataUpdateStarted",firstRowData:e?.length?e[0]:null})}deselect(e){let t="rowDataChanged",i=this.beans.selectionSvc;e.length&&i?.setNodesSelected({newValue:!1,nodes:e,suppressFinishActions:!0,source:t}),i?.updateGroupsFromChildrenSelections?.(t),e.length&&this.eventSvc.dispatchEvent({type:"selectionChanged",source:t,selectedNodes:i?.getSelectedNodes()??null,serverSideState:null})}createRowNode(e,t){let i=new Jo(this.beans);i.parent=this.rootNode,i.level=t,i.group=!1,i.expanded=!1,i.setDataAndId(e,String(this.nextId++));let n=i.id,o=this.allNodesMap;return o[n]&&I(2,{nodeId:n}),o[n]=i,i}deleteNode(e){e.clearRowTopAndRowIndex();let t=e.id,i=this.allNodesMap;i[t]===e&&delete i[t];let n=e.pinnedSibling;n&&this.beans.pinnedRowModel?.pinRow(n,null)}lookupNode(e,t){if(!e)return BY(this.rootNode._leafs,t);let i=e({data:t,level:0}),n=this.allNodesMap[i];return n||(Ge(4,{id:i}),null)}sanitizeAddIndex(e,t){let i=e.length;if(typeof t!="number"||t<0||t>=i||Number.isNaN(t))return i;t=Math.ceil(t);let n=this.gos;return t>0&&n.get("treeData")&&n.get("getDataPath")&&(t=NY(e,t)),t}},NY=(e,t)=>{for(let i=0,n=e.length;i<n;i++)if(e[i]?.rowIndex==t-1)return i+1;return t},_R=e=>{e.group=!0,e.level=-1,e.id="ROOT_NODE_ID",e._leafs?.length!==0&&(e._leafs=[]);let t=[],i=[],n=[],o=[];e.childrenAfterGroup=t,e.childrenAfterSort=i,e.childrenAfterAggFilter=n,e.childrenAfterFilter=o;let s=e.sibling;return s&&(s.childrenAfterGroup=t,s.childrenAfterSort=i,s.childrenAfterAggFilter=n,s.childrenAfterFilter=o,s.childrenMapped=e.childrenMapped),e.updateHasChildren(),e},BY=(e,t)=>{if(e)for(let i=0,n=e.length;i<n;i++){let o=e[i];if(o.data===t)return o}return Ge(5,{data:t}),null},HY=(e,t,i,n,o)=>{t=Math.max(0,t);for(let s=t,r=e.length;s<r;++s){let a=e[s];s<=i&&(n.has(a)||o?.has(a))||(a.sourceRowIndex=t,e[t++]=a)}e.length=t},GY=(e,t)=>{let i=t.size;e.length=i;let n=0,o=!1,s=!1;for(let r of t){let a=r.sourceRowIndex;a===n?s||(s=o):(a>=0?s=!0:o=!0,r.sourceRowIndex=n,e[n]=r),++n}return s},VY=(e,t,{removals:i,adds:n})=>{let o=e.length;e.length=t.size;let s=0;for(let r=0;r<o;++r){let a=e[r];i.has(a)||(s!==r&&(a.sourceRowIndex=s,e[s]=a),++s)}for(let r of n)r.sourceRowIndex<0&&(r.sourceRowIndex=s,e[s++]=r);e.length=s},KP=e=>{let t=e.childrenAfterSort,i=e.sibling;if(i&&(i.childrenAfterSort=t),!!t)for(let n=0,o=t.length-1;n<=o;n++){let s=t[n],r=n===0,a=n===o;s.firstChild!==r&&(s.firstChild=r,s.dispatchRowEvent("firstChildChanged")),s.lastChild!==a&&(s.lastChild=a,s.dispatchRowEvent("lastChildChanged")),s.childIndex!==n&&(s.childIndex=n,s.dispatchRowEvent("childIndexChanged"))}},zY=class extends D{constructor(){super(...arguments),this.beanName="sortStage",this.step="sort",this.refreshProps=["postSortRows","groupDisplayType","accentedSort"]}execute(e){let t=this.beans.sortSvc.getSortOptions(),i=t.length>0&&!!e.changedRowNodes&&this.gos.get("deltaSort");this.sort(t,i,e.changedRowNodes,e.changedPath)}sort(e,t,i,n){let{gos:o,colModel:s,rowGroupColsSvc:r,rowNodeSorter:a,rowRenderer:l,showRowGroupCols:d}=this.beans,c=o.get("groupMaintainOrder"),u=s.getCols().some(v=>v.isRowGroupActive()),h=r?.columns,p=s.isPivotMode(),g=o.getCallback("postSortRows"),f=!1,m,C=v=>{let w=p&&v.leafGroup,y=c&&u&&!v.leafGroup;y&&(m??(m=this.shouldSortContainsGroupCols(e)),y&&(y=!m));let S=null;if(y){let x=!1;if(h){let E=v.level+1;E<h.length&&(x=h[E].getSort()===null)}x||(S=qY(v))}else!e.length||w||(t&&i?S=WY(a,v,i,n,e):S=a.doFullSort(v.childrenAfterAggFilter,e));if(S||(S=v.childrenAfterAggFilter?.slice(0)??[]),f||(f=v.childrenAfterSort?.[0]!==S[0]),v.childrenAfterSort=S,KP(v),g){let x={nodes:v.childrenAfterSort};g(x)}};if(n?.forEachChangedNodeDepthFirst(C),f&&o.get("groupHideOpenParents")){let v=d?.getShowRowGroupCols();v?.length&&l.refreshCells({columns:v,force:!0})}}shouldSortContainsGroupCols(e){let t=e.length;if(!t)return!1;if(bn(this.gos)){for(let i=0;i<t;++i){let n=e[i].column;if(n.isPrimary()&&n.isRowGroupActive())return!0}return!1}for(let i=0;i<t;++i)if(e[i].column.getColDef().showRowGroup)return!0;return!1}},WY=(e,t,i,n,o)=>{let s=t.childrenAfterAggFilter,r=t.childrenAfterSort;if(!r)return e.doFullSort(s,o);let a=new Set,l=[],{updates:d,adds:c}=i;for(let h=0,p=s.length;h<p;++h){let g=s[h];d.has(g)||c.has(g)||n&&!n.canSkip(g)?l.push({currentPos:l.length,rowNode:g}):a.add(g)}let u=r.filter(h=>a.has(h)).map((h,p)=>({currentPos:p,rowNode:h}));return l.sort((h,p)=>e.compareRowNodes(o,h,p)),UY(e,o,l,u)},UY=(e,t,i,n)=>{let o=0,s=0,r=i.length,a=n.length,l=new Array(r+a),d=0;for(;o<r&&s<a;){let c=i[o],u=n[s];e.compareRowNodes(t,c,u)<0?(l[d++]=c.rowNode,++o):(l[d++]=u.rowNode,++s)}for(;o<r;)l[d++]=i[o++].rowNode;for(;s<a;)l[d++]=n[s++].rowNode;return l},qY=e=>{let t=e.childrenAfterSort,i=e.childrenAfterAggFilter,n=t?.length,o=i?.length;if(!n||!o)return null;let s=new Array(o),r=new Set;for(let l=0;l<o;++l)r.add(i[l]);let a=0;for(let l=0;l<n;++l){let d=t[l];r.delete(d)&&(s[a++]=d)}if(r.size===0&&a===n)return t;for(let l of r)s[a++]=l;return s.length=a,s},$Y=class extends D{constructor(){super(...arguments),this.beanName="rowModel",this.rootNode=null,this.rowCountReady=!1,this.nodeManager=void 0,this.rowsToDisplay=[],this.rowDataUpdatedPending=!1,this.asyncTransactions=null,this.asyncTransactionsTimer=0,this.started=!1,this.refreshingModel=!1,this.rowNodesCountReady=!1,this.stages=[],this.stagesRefreshProps=new Map,this.onRowHeightChanged_debounced=_t(this,this.onRowHeightChanged.bind(this),100)}postConstruct(){let e=this.beans,t=new Jo(e);this.rootNode=t,this.nodeManager=this.createBean(new OY(t));let i=this.refreshModel.bind(this,{step:"group"}),n=this.refreshModel.bind(this,{step:"group",afterColumnsChanged:!0,keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame")});this.addManagedEventListeners({newColumnsLoaded:n,columnRowGroupChanged:i,columnValueChanged:this.onValueChanged.bind(this),columnPivotChanged:this.refreshModel.bind(this,{step:"pivot"}),filterChanged:this.onFilterChanged.bind(this),sortChanged:this.onSortChanged.bind(this),columnPivotModeChanged:i,gridStylesChanged:this.onGridStylesChanges.bind(this),gridReady:this.onGridReady.bind(this),rowExpansionStateChanged:this.onRowGroupOpened.bind(this)}),this.addPropertyListeners()}addPropertyListeners(){let{beans:e,stagesRefreshProps:t}=this,i=[e.groupStage,e.filterStage,e.pivotStage,e.aggStage,e.sortStage,e.filterAggStage,e.flattenStage].filter(n=>!!n);this.stages=i;for(let n=i.length-1;n>=0;--n)for(let o of i[n].refreshProps)t.set(o,n);this.addManagedPropertyListeners([...t.keys()],n=>{let o=n.changeSet?.properties;o&&this.onPropChange(o)}),this.addManagedPropertyListener("rowData",()=>this.onPropChange(["rowData"])),this.addManagedPropertyListener("rowHeight",()=>this.resetRowHeights())}start(){this.started=!0,this.rowNodesCountReady?this.refreshModel({step:"group",rowDataUpdated:!0,newData:!0}):this.setInitialData()}setInitialData(){this.gos.get("rowData")&&this.onPropChange(["rowData"])}ensureRowHeightsValid(e,t,i,n){let o,s=!1;do{o=!1;let r=this.getRowIndexAtPixel(e),a=this.getRowIndexAtPixel(t),l=Math.max(r,i),d=Math.min(a,n);for(let c=l;c<=d;c++){let u=this.getRow(c);if(u.rowHeightEstimated){let h=Yo(this.beans,u);u.setRowHeight(h.height),o=!0,s=!0}}o&&this.setRowTopAndRowIndex()}while(o);return s}onPropChange(e){let{nodeManager:t,gos:i,beans:n}=this,o=n.groupStage;if(!t)return;let s=new Set(e),r=o?.onPropChange(s),a;s.has("rowData")?a=i.get("rowData"):r&&(a=o?.extractData()),a&&!Array.isArray(a)&&(a=null,I(1));let l={step:"nothing",changedProps:s};a&&(!r&&!this.isEmpty()&&a.length>0&&i.exists("getRowId")&&!i.get("resetRowDataOnUpdate")?(l.keepRenderedRows=!0,l.animate=!i.get("suppressAnimationFrame"),l.changedRowNodes=new tp,t.setImmutableRowData(l,a)):(l.rowDataUpdated=!0,l.newData=!0,t.setNewRowData(a),this.rowNodesCountReady=!0));let d=l.rowDataUpdated?"group":this.getRefreshedStage(e);d&&(l.step=d,this.refreshModel(l))}getRefreshedStage(e){let{stages:t,stagesRefreshProps:i}=this,n=t.length,o=n;for(let s=0,r=e.length;s<r&&o;++s)o=Math.min(o,i.get(e[s])??o);return o<n?t[o].step:null}setRowTopAndRowIndex(e){let{beans:t,rowsToDisplay:i}=this,n=t.environment.getDefaultRowHeight(),o=0,s=Nt(this.gos,"normal");for(let r=0,a=i.length;r<a;++r){let l=i[r],d=l.id;if(d!=null&&e?.add(d),l.rowHeight==null){let c=Yo(t,l,s,n);l.setRowHeight(c.height,c.estimated)}l.setRowTop(o),l.setRowIndex(r),o+=l.rowHeight}}clearRowTopAndRowIndex(e,t){let i=e.active,n=r=>{r?.id!=null&&!t.has(r.id)&&r.clearRowTopAndRowIndex()},o=r=>{n(r),n(r.detailNode),n(r.sibling);let a=r.childrenAfterGroup;if(!r.hasChildren()||!a)return;let l=r.level==-1;if(!(i&&!l&&!r.expanded))for(let c=0,u=a.length;c<u;++c)o(a[c])},s=this.rootNode;s&&o(s)}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay.length}getTopLevelRowCount(){let{rootNode:e,rowsToDisplay:t}=this;if(!e||!t.length)return 0;if(t[0]===e)return 1;let n=e.sibling?.displayed?1:0;return(e.childrenAfterSort?.length??0)+n}getTopLevelRowDisplayedIndex(e){let{beans:t,rootNode:i,rowsToDisplay:n}=this;if(!i||!n.length||n[0]===i)return e;let s=i.childrenAfterSort,r=l=>{let d=s[l];if(this.gos.get("groupHideOpenParents"))for(;d.expanded&&d.childrenAfterSort&&d.childrenAfterSort.length>0;)d=d.childrenAfterSort[0];return d.rowIndex},a=t.footerSvc;return a?a?.getTopDisplayIndex(n,e,s,r):r(e)}getTopLevelIndexFromDisplayedIndex(e){let{rootNode:t,rowsToDisplay:i}=this;if(!t||!i.length||i[0]===t)return e;let o=this.getRow(e);o.footer&&(o=o.sibling);let s=o.parent;for(;s&&s!==t;)o=s,s=o.parent;let r=t.childrenAfterSort?.indexOf(o)??-1;return r>=0?r:e}getRowBounds(e){let t=this.rowsToDisplay[e];return t?{rowTop:t.rowTop,rowHeight:t.rowHeight}:null}onRowGroupOpened(){this.refreshModel({step:"map",keepRenderedRows:!0,animate:la(this.gos)})}onFilterChanged({afterDataChange:e,columns:t}){if(!e){let n=t.length===0||t.some(o=>o.isPrimary())?"filter":"filter_aggregates";this.refreshModel({step:n,keepRenderedRows:!0,animate:la(this.gos)})}}onSortChanged(){this.refreshModel({step:"sort",keepRenderedRows:!0,animate:la(this.gos)})}getType(){return"clientSide"}onValueChanged(){this.refreshModel({step:this.beans.colModel.isPivotActive()?"pivot":"aggregate"})}createChangePath(e){let t=new pd(!1,this.rootNode);return t.active=e,t}isSuppressModelUpdateAfterUpdateTransaction(e){if(!this.gos.get("suppressModelUpdateAfterUpdateTransaction"))return!1;let{changedRowNodes:t,newData:i,rowDataUpdated:n}=e;return!(!t||i||!n||t.removals.size||t.adds.size)}refreshModel(e){let{nodeManager:t,beans:i,eventSvc:n,started:o,refreshingModel:s}=this;if(!t)return;let r=!!e.rowDataUpdated,a=e.changedPath??(e.changedPath=this.createChangePath(!e.newData&&r));if(o&&r&&n.dispatchEvent({type:"rowDataUpdated"}),!o||s||i.colModel.changeEventsDispatching||this.isSuppressModelUpdateAfterUpdateTransaction(e)){this.rowDataUpdatedPending||(this.rowDataUpdatedPending=r);return}switch(this.rowDataUpdatedPending&&(this.rowDataUpdatedPending=!1,e.step="group"),this.refreshingModel=!0,i.masterDetailSvc?.refreshModel(e),r&&e.step!=="group"&&i.colFilter?.refreshModel(),e.step){case"group":this.doGrouping(e);case"filter":this.doFilter(a);case"pivot":this.doPivot(a);case"aggregate":this.doAggregate(a);case"filter_aggregates":this.doFilterAggregates(a);case"sort":this.doSort(e.changedRowNodes,a);case"map":this.doRowsToDisplay()}let l=new Set;this.setRowTopAndRowIndex(l),this.clearRowTopAndRowIndex(a,l),this.refreshingModel=!1,n.dispatchEvent({type:"modelUpdated",animate:e.animate,keepRenderedRows:e.keepRenderedRows,newData:e.newData,newPage:!1,keepUndoRedoStack:e.keepUndoRedoStack})}isEmpty(){return!this.rootNode?._leafs?.length||!this.beans.colModel?.ready}isRowsToRender(){return this.rowsToDisplay.length>0}getNodesInRangeForSelection(e,t){let i=!1,n=!1,o=[],s=cd(this.gos);return this.forEachNodeAfterFilterAndSort(r=>{if(n)return;if(i&&(r===t||r===e)&&(n=!0,s&&r.group)){YP(o,r);return}if(!i){if(r!==t&&r!==e)return;i=!0,t===e&&(n=!0)}(!r.group||!s)&&o.push(r)}),o}getTopLevelNodes(){return this.rootNode?.childrenAfterGroup??null}getRow(e){return this.rowsToDisplay[e]}isRowPresent(e){return this.rowsToDisplay.indexOf(e)>=0}getRowIndexAtPixel(e){let t=this.rowsToDisplay,i=t.length;if(this.isEmpty()||i===0)return-1;let n=0,o=i-1;if(e<=0)return 0;if(t[o].rowTop<=e)return o;let r=-1,a=-1;for(;;){let l=Math.floor((n+o)/2),d=t[l];if(this.isRowInPixel(d,e)||(d.rowTop<e?n=l+1:d.rowTop>e&&(o=l-1),r===n&&a===o))return l;r=n,a=o}}isRowInPixel(e,t){let i=e.rowTop,n=i+e.rowHeight;return i<=t&&n>t}forEachLeafNode(e){let t=this.rootNode?._leafs;if(t)for(let i=0,n=t.length;i<n;++i)e(t[i],i)}forEachNode(e,t=!1){this.depthFirstSearchRowNodes(e,t)}forEachDisplayedNode(e){let t=this.rowsToDisplay;for(let i=0,n=t.length;i<n;++i)e(t[i],i)}forEachNodeAfterFilter(e,t=!1){this.depthFirstSearchRowNodes(e,t,i=>i.childrenAfterAggFilter)}forEachNodeAfterFilterAndSort(e,t=!1){this.depthFirstSearchRowNodes(e,t,i=>i.childrenAfterSort)}forEachPivotNode(e,t,i){let{colModel:n,rowGroupColsSvc:o}=this.beans;if(!n.isPivotMode())return;if(!o?.columns.length){e(this.rootNode,0);return}let s=i?"childrenAfterSort":"childrenAfterGroup";this.depthFirstSearchRowNodes(e,t,r=>r.leafGroup?null:r[s])}depthFirstSearchRowNodes(e,t=!1,i=s=>s.childrenAfterGroup,n=this.rootNode,o=0){let s=o;if(!n)return s;let r=n===this.rootNode;if(r||e(n,s++),n.hasChildren()&&!n.footer){let a=i(n);if(a){let l=this.beans.footerSvc;s=l?.addTotalRows(s,n,e,t,r,"top")??s;for(let d of a)s=this.depthFirstSearchRowNodes(e,t,i,d,s);return l?.addTotalRows(s,n,e,t,r,"bottom")??s}}return s}doAggregate(e){let t=this.rootNode;t&&this.beans.aggStage?.execute({rowNode:t,changedPath:e})}doFilterAggregates(e){let t=this.rootNode,i=this.beans.filterAggStage;if(i){i.execute({rowNode:t,changedPath:e});return}t.childrenAfterAggFilter=t.childrenAfterFilter}doSort(e,t){let i=this.beans.sortStage;if(i){i.execute({rowNode:this.rootNode,changedRowNodes:e,changedPath:t});return}t.forEachChangedNodeDepthFirst(n=>{n.childrenAfterSort=n.childrenAfterAggFilter.slice(0),KP(n)})}doGrouping(e){let t=this.rootNode,n=this.beans.groupStage?.execute({rowNode:t,changedRowNodes:e.changedRowNodes,changedPath:e.changedPath,afterColumnsChanged:!!e.afterColumnsChanged});if(n===void 0){let o=t._leafs;t.childrenAfterGroup=o,t.updateHasChildren();let s=t.sibling;s&&(s.childrenAfterGroup=o)}(n||e.rowDataUpdated)&&this.beans.colFilter?.refreshModel(),!this.rowCountReady&&this.rowNodesCountReady&&(this.rowCountReady=!0,this.eventSvc.dispatchEventOnce({type:"rowCountReady"}))}doFilter(e){let t=this.beans.filterStage;if(t){t.execute({rowNode:this.rootNode,changedPath:e});return}e.forEachChangedNodeDepthFirst(i=>{i.childrenAfterFilter=i.childrenAfterGroup,bP(i)},!0)}doPivot(e){this.beans.pivotStage?.execute({rowNode:this.rootNode,changedPath:e})}getRowNode(e){let t=this.nodeManager?.getRowNode(e);return typeof t=="object"?t:typeof e=="string"&&e.indexOf(OC)===0?this.beans.groupStage?.getNode(e):void 0}batchUpdateRowData(e,t){if(!this.asyncTransactionsTimer){this.asyncTransactions=[];let i=this.gos.get("asyncTransactionWaitMillis");this.asyncTransactionsTimer=setTimeout(()=>this.executeBatchUpdateRowData(),i)}this.asyncTransactions.push({rowDataTransaction:e,callback:t})}flushAsyncTransactions(){let e=this.asyncTransactionsTimer;e&&(clearTimeout(e),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){let{nodeManager:e,beans:t,eventSvc:i,asyncTransactions:n}=this;if(!e)return;t.valueCache?.onDataChanged();let o=[],s=[],r=new tp;for(let{rowDataTransaction:a,callback:l}of n??[]){this.rowNodesCountReady=!0;let d=e.updateRowData(a,r);o.push(d),l&&s.push(l.bind(null,d))}this.commitTransactions(r),s.length>0&&setTimeout(()=>{for(let a=0,l=s.length;a<l;a++)s[a]()},0),o.length>0&&i.dispatchEvent({type:"asyncTransactionsFlushed",results:o}),this.asyncTransactionsTimer=0,this.asyncTransactions=null}updateRowData(e){let t=this.nodeManager;if(!t)return null;this.beans.valueCache?.onDataChanged(),this.rowNodesCountReady=!0;let i=new tp,n=t.updateRowData(e,i);return this.commitTransactions(i),n}commitTransactions(e){this.refreshModel({step:"group",rowDataUpdated:!0,keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame"),changedRowNodes:e,changedPath:this.createChangePath(!0)})}doRowsToDisplay(){let{beans:e,rootNode:t}=this,i=e.flattenStage;if(i){this.rowsToDisplay=i.execute({rowNode:t});return}let n=this.rootNode.childrenAfterSort??[];for(let o of n)o.setUiLevel(0);this.rowsToDisplay=n}onRowHeightChanged(){this.refreshModel({step:"map",keepRenderedRows:!0,keepUndoRedoStack:!0})}resetRowHeights(){let e=this.rootNode;if(!e)return;let t=this.resetRowHeightsForAllRowNodes();e.setRowHeight(e.rowHeight,!0);let i=e.sibling;i?.setRowHeight(i.rowHeight,!0),t&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let e=!1;return this.forEachNode(t=>{t.setRowHeight(t.rowHeight,!0);let i=t.detailNode;i?.setRowHeight(i.rowHeight,!0);let n=t.sibling;n?.setRowHeight(n.rowHeight,!0),e=!0}),e}onGridStylesChanges(e){e.rowHeightChanged&&!this.beans.rowAutoHeight?.active&&this.resetRowHeights()}onGridReady(){this.started||this.setInitialData()}destroy(){super.destroy(),this.nodeManager=this.destroyBean(this.nodeManager),this.started=!1,this.rootNode=null,this.rowsToDisplay=[],this.asyncTransactions=null,clearTimeout(this.asyncTransactionsTimer)}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}},YP=(e,t)=>{let i=t.childrenAfterGroup;if(i)for(let n=0,o=i.length;n<o;++n){let s=i[n];s.data&&e.push(s),s.group&&YP(e,s)}};function jY(e){e.expansionSvc?.onGroupExpandedOrCollapsed()}function KY(e,t){let i=ts(e);i&&((!t||t==="everything")&&(t="group"),i.refreshModel({step:t,keepRenderedRows:!0,animate:!e.gos.get("suppressAnimationFrame")}))}function YY(e){return ts(e)?.isEmpty()??!0}function XY(e,t){ts(e)?.forEachLeafNode(t)}function JY(e,t){ts(e)?.forEachNodeAfterFilter(t)}function QY(e,t){ts(e)?.forEachNodeAfterFilterAndSort(t)}function ZY(e,t){return e.frameworkOverrides.wrapIncoming(()=>ts(e)?.updateRowData(t))}function eX(e,t,i){e.frameworkOverrides.wrapIncoming(()=>ts(e)?.batchUpdateRowData(t,i))}function tX(e){e.frameworkOverrides.wrapIncoming(()=>ts(e)?.flushAsyncTransactions())}function iX(e){return e.selectionSvc?.getBestCostNodeSelection()}var nX={moduleName:"ClientSideRowModel",version:z,rowModels:["clientSide"],beans:[$Y,zY],dependsOn:[gP]},oX={moduleName:"ClientSideRowModelApi",version:z,apiFunctions:{onGroupExpandedOrCollapsed:jY,refreshClientSideRowModel:KY,isRowDataEmpty:YY,forEachLeafNode:XY,forEachNodeAfterFilter:JY,forEachNodeAfterFilterAndSort:QY,applyTransaction:ZY,applyTransactionAsync:eX,flushAsyncTransactions:tX,getBestCostNodeSelection:iX,resetRowHeights:jP,onRowHeightChanged:$P},dependsOn:[TY,AY]},sX=class extends D{constructor(){super(...arguments),this.beanName="gridSerializer"}wireBeans(e){this.visibleCols=e.visibleCols,this.colModel=e.colModel,this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel}serialize(e,t={}){let{allColumns:i,columnKeys:n,skipRowGroups:o,exportRowNumbers:s}=t,r=this.getColumnsToExport({allColumns:i,skipRowGroups:o,columnKeys:n,exportRowNumbers:s});return[this.prepareSession(r),this.prependContent(t),this.exportColumnGroups(t,r),this.exportHeaders(t,r),this.processPinnedTopRows(t,r),this.processRows(t,r),this.processPinnedBottomRows(t,r),this.appendContent(t)].reduce((a,l)=>l(a),e).parse()}processRow(e,t,i,n){let o=t.shouldRowBeSkipped||(()=>!1),r=t.rowPositions!=null||!!t.onlySelected,a=this.gos.get("groupHideOpenParents")&&!r,l=this.colModel.isPivotMode()?n.leafGroup:!n.group,d=!!n.footer,c=n.allChildrenCount===1&&n.childrenAfterGroup?.length===1&&dO(this.gos,n);if(!l&&!d&&(t.skipRowGroups||c||a)||t.onlySelected&&!n.isSelected()||t.skipPinnedTop&&n.rowPinned==="top"||t.skipPinnedBottom&&n.rowPinned==="bottom"||n.stub||n.level===-1&&!l&&!d||o(te(this.gos,{node:n})))return;let p=e.onNewBodyRow(n);if(i.forEach((g,f)=>{p.onColumn(g,f,n)}),t.getCustomContentBelowRow){let g=t.getCustomContentBelowRow(te(this.gos,{node:n}));g&&e.addCustomContent(g)}}appendContent(e){return t=>{let i=e.appendContent;return i&&t.addCustomContent(i),t}}prependContent(e){return t=>{let i=e.prependContent;return i&&t.addCustomContent(i),t}}prepareSession(e){return t=>(t.prepare(e),t)}exportColumnGroups(e,t){return i=>{if(!e.skipColumnGroupHeaders){let n=new B6,{colGroupSvc:o}=this.beans,s=o?o.createColumnGroups({columns:t,idCreator:n,pinned:null,isStandaloneStructure:!0}):t;this.recursivelyAddHeaderGroups(s,i,e.processGroupHeaderCallback)}return i}}exportHeaders(e,t){return i=>{if(!e.skipColumnHeaders){let n=i.onNewHeaderRow();t.forEach((o,s)=>{n.onColumn(o,s,void 0)})}return i}}processPinnedTopRows(e,t){return i=>{let n=this.processRow.bind(this,i,e,t);return e.rowPositions?e.rowPositions.filter(o=>o.rowPinned==="top").sort((o,s)=>o.rowIndex-s.rowIndex).map(o=>this.pinnedRowModel?.getPinnedTopRow(o.rowIndex)).forEach(n):this.pinnedRowModel?.isManual()||this.pinnedRowModel?.forEachPinnedRow("top",n),i}}processRows(e,t){return i=>{let n=this.rowModel,o=gt(this.gos,n),s=xa(this.gos,n),r=!o&&e.onlySelected,a=this.processRow.bind(this,i,e,t),{exportedRows:l="filteredAndSorted"}=e;if(e.rowPositions)e.rowPositions.filter(d=>d.rowPinned==null).sort((d,c)=>d.rowIndex-c.rowIndex).map(d=>n.getRow(d.rowIndex)).forEach(a);else if(this.colModel.isPivotMode())o?n.forEachPivotNode(a,!0,l==="filteredAndSorted"):s?n.forEachNodeAfterFilterAndSort(a,!0):n.forEachNode(a);else if(e.onlySelectedAllPages||r){let d=this.beans.selectionSvc?.getSelectedNodes()??[];this.replicateSortedOrder(d),d.forEach(a)}else l==="all"?n.forEachNode(a):o||s?n.forEachNodeAfterFilterAndSort(a,!0):n.forEachNode(a);return i}}replicateSortedOrder(e){let{sortSvc:t,rowNodeSorter:i}=this.beans;if(!t||!i)return;let n=t.getSortOptions(),o=(s,r)=>s.rowIndex!=null&&r.rowIndex!=null?s.rowIndex-r.rowIndex:s.level===r.level?s.parent?.id===r.parent?.id?i.compareRowNodes(n,{rowNode:s,currentPos:s.rowIndex??-1},{rowNode:r,currentPos:r.rowIndex??-1}):o(s.parent,r.parent):s.level>r.level?o(s.parent,r):o(s,r.parent);e.sort(o)}processPinnedBottomRows(e,t){return i=>{let n=this.processRow.bind(this,i,e,t);return e.rowPositions?e.rowPositions.filter(o=>o.rowPinned==="bottom").sort((o,s)=>o.rowIndex-s.rowIndex).map(o=>this.pinnedRowModel?.getPinnedBottomRow(o.rowIndex)).forEach(n):this.pinnedRowModel?.isManual()||this.pinnedRowModel?.forEachPinnedRow("bottom",n),i}}getColumnsToExport(e){let{allColumns:t=!1,skipRowGroups:i=!1,exportRowNumbers:n=!1,columnKeys:o}=e,{colModel:s,gos:r,visibleCols:a}=this,l=s.isPivotMode(),d=h=>go(h)?!1:!ao(h)||n;if(o?.length)return s.getColsForKeys(o).filter(d);let c=r.get("treeData"),u=[];return t&&!l?u=s.getCols():u=a.allCols,u=u.filter(h=>d(h)&&(i&&!c?!uv(h):!0)),u}recursivelyAddHeaderGroups(e,t,i){let n=[];for(let o of e){let s=o;if(s.getChildren)for(let r of s.getChildren()??[])n.push(r)}e.length>0&&pt(e[0])&&this.doAddHeaderHeader(t,e,i),n&&n.length>0&&this.recursivelyAddHeaderGroups(n,t,i)}doAddHeaderHeader(e,t,i){let n=e.onNewHeaderGroupingRow(),o=0;for(let s of t){let r=s,a;i?a=i(te(this.gos,{columnGroup:r})):a=this.beans.colNames.getDisplayNameForColumnGroup(r,"header");let d=(r.isExpandable()?r.getLeafColumns():[]).reduce((c,u,h,p)=>{let g=Ue(c);return u.getColumnGroupShow()==="open"?(!g||g[1]!=null)&&(g=[h],c.push(g)):g&&g[1]==null&&(g[1]=h-1),h===p.length-1&&g&&g[1]==null&&(g[1]=h),c},[]);n.onColumn(r,a||"",o++,r.getLeafColumns().length-1,d)}}},rX={moduleName:"SharedExport",version:z,beans:[sX]},OR=`\r
`,aX=class extends _${constructor(e){super(e),this.config=e,this.isFirstLine=!0,this.result="";let{suppressQuotes:t,columnSeparator:i}=e;this.suppressQuotes=t,this.columnSeparator=i}addCustomContent(e){e&&(typeof e=="string"?(/^\s*\n/.test(e)||this.beginNewLine(),e=e.replace(/\r?\n/g,OR),this.result+=e):e.forEach(t=>{this.beginNewLine(),t.forEach((i,n)=>{n!==0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(i.data.value||""),i.mergeAcross&&this.appendEmptyCells(i.mergeAcross)})}))}onNewHeaderGroupingRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}onNewHeaderGroupingRowColumn(e,t,i,n){i!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(t),this.appendEmptyCells(n)}appendEmptyCells(e){for(let t=1;t<=e;t++)this.result+=this.columnSeparator+this.putInQuotes("")}onNewHeaderRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}onNewHeaderRowColumn(e,t){t!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(e))}onNewBodyRow(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}onNewBodyRowColumn(e,t,i){t!=0&&(this.result+=this.columnSeparator);let n=this.extractRowCellValue(e,t,t,"csv",i);this.result+=this.putInQuotes(n.valueFormatted??n.value)}putInQuotes(e){if(this.suppressQuotes)return e;if(e==null)return'""';let t;return typeof e=="string"?t=e:typeof e.toString=="function"?t=e.toString():(I(53),t=""),'"'+t.replace(/"/g,'""')+'"'}parse(){return this.result}beginNewLine(){this.isFirstLine||(this.result+=OR),this.isFirstLine=!1}},lX=class extends L${constructor(){super(...arguments),this.beanName="csvCreator"}wireBeans(e){this.colModel=e.colModel,this.colNames=e.colNames,this.rowGroupColsSvc=e.rowGroupColsSvc,this.valueSvc=e.valueSvc}getMergedParams(e){let t=this.gos.get("defaultCsvExportParams");return Object.assign({},t,e)}export(e){if(this.isExportSuppressed()){I(51);return}let t=this.getMergedParams(e),i=this.getData(t),n=new Blob(["\uFEFF",i],{type:"text/plain"}),o=typeof t.fileName=="function"?t.fileName(te(this.gos,{})):t.fileName;O$(this.getFileName(o),n)}exportDataAsCsv(e){this.export(e)}getDataAsCsv(e,t=!1){let i=t?Object.assign({},e):this.getMergedParams(e);return this.getData(i)}getDefaultFileExtension(){return"csv"}createSerializingSession(e){let{colModel:t,colNames:i,rowGroupColsSvc:n,valueSvc:o,gos:s}=this,{processCellCallback:r,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:d,suppressQuotes:c,columnSeparator:u}=e;return new aX({colModel:t,colNames:i,valueSvc:o,gos:s,processCellCallback:r||void 0,processHeaderCallback:a||void 0,processGroupHeaderCallback:l||void 0,processRowGroupCallback:d||void 0,suppressQuotes:c||!1,columnSeparator:u||",",rowGroupColsSvc:n})}isExportSuppressed(){return this.gos.get("suppressCsvExport")}};function dX(e,t){return e.csvCreator?.getDataAsCsv(t)}function cX(e,t){e.csvCreator?.exportDataAsCsv(t)}var uX={moduleName:"CsvExport",version:z,beans:[lX],apiFunctions:{getDataAsCsv:dX,exportDataAsCsv:cX},dependsOn:[rX]},hX=class extends D{constructor(e,t,i){super(),this.id=e,this.parentCache=t,this.params=i,this.state="needsLoading",this.version=0,this.startRow=e*i.blockSize,this.endRow=this.startRow+i.blockSize}load(){this.state="loading",this.loadFromDatasource()}setStateWaitingToLoad(){this.version++,this.state="needsLoading"}pageLoadFailed(e){this.isRequestMostRecentAndLive(e)&&(this.state="failed"),this.dispatchLocalEvent({type:"loadComplete"})}pageLoaded(e,t,i){this.successCommon(e,{rowData:t,rowCount:i})}isRequestMostRecentAndLive(e){let t=e===this.version,i=this.isAlive();return t&&i}successCommon(e,t){this.dispatchLocalEvent({type:"loadComplete"}),this.isRequestMostRecentAndLive(e)&&(this.state="loaded",this.processServerResult(t))}postConstruct(){this.rowNodes=[];let{params:{blockSize:e,rowHeight:t},startRow:i,beans:n,rowNodes:o}=this;for(let s=0;s<e;s++){let r=i+s,a=new Jo(n);a.setRowHeight(t),a.uiLevel=0,a.setRowIndex(r),a.setRowTop(t*r),o.push(a)}}getBlockStateJson(){let{id:e,startRow:t,endRow:i,state:n}=this;return{id:""+e,state:{blockNumber:e,startRow:t,endRow:i,pageStatus:n}}}setDataAndId(e,t,i){q(t)?e.setDataAndId(t,i.toString()):e.setDataAndId(void 0,void 0)}loadFromDatasource(){let e=this.createLoadParams();if(Qe(this.params.datasource.getRows)){I(90);return}window.setTimeout(()=>{this.params.datasource.getRows(e)},0)}createLoadParams(){let{startRow:e,endRow:t,version:i,params:{sortModel:n,filterModel:o},gos:s}=this;return{startRow:e,endRow:t,successCallback:this.pageLoaded.bind(this,i),failCallback:this.pageLoadFailed.bind(this,i),sortModel:n,filterModel:o,context:te(s,{}).context}}forEachNode(e,t,i){this.rowNodes.forEach((n,o)=>{this.startRow+o<i&&e(n,t.value++)})}getRow(e,t=!1){t||(this.lastAccessed=this.params.lastAccessedSequence.value++);let i=e-this.startRow;return this.rowNodes[i]}processServerResult(e){let{rowNodes:t,beans:i}=this;t.forEach((o,s)=>{let r=e.rowData?e.rowData[s]:void 0;!o.id&&o.alreadyRendered&&r&&(t[s]=new Jo(i),t[s].setRowIndex(o.rowIndex),t[s].setRowTop(o.rowTop),t[s].setRowHeight(o.rowHeight),o.clearRowTopAndRowIndex()),this.setDataAndId(t[s],r,this.startRow+s)});let n=e.rowCount!=null&&e.rowCount>=0?e.rowCount:void 0;this.parentCache.pageLoaded(this,n)}destroy(){for(let e of this.rowNodes)e.clearRowTopAndRowIndex();super.destroy()}},pX=2,gX=class extends D{constructor(e){super(),this.params=e,this.lastRowIndexKnown=!1,this.blocks={},this.blockCount=0,this.rowCount=e.initialRowCount}getRow(e,t=!1){let i=Math.floor(e/this.params.blockSize),n=this.blocks[i];if(!n){if(t)return;n=this.createBlock(i)}return n.getRow(e)}createBlock(e){let t=this.params,i=this.createBean(new hX(e,this,t));return this.blocks[i.id]=i,this.blockCount++,this.purgeBlocksIfNeeded(i),t.rowNodeBlockLoader.addBlock(i),i}refreshCache(){if(this.blockCount==0){this.purgeCache();return}for(let t of this.getBlocksInOrder())t.setStateWaitingToLoad();this.params.rowNodeBlockLoader.checkBlockToLoad()}destroy(){for(let e of this.getBlocksInOrder())this.destroyBlock(e);super.destroy()}getRowCount(){return this.rowCount}isLastRowIndexKnown(){return this.lastRowIndexKnown}pageLoaded(e,t){this.isAlive()&&(Ko(this.gos,`InfiniteCache - onPageLoaded: page = ${e.id}, lastRow = ${t}`),this.checkRowCount(e,t),this.onCacheUpdated())}purgeBlocksIfNeeded(e){let t=this.getBlocksInOrder().filter(r=>r!=e),i=(r,a)=>a.lastAccessed-r.lastAccessed;t.sort(i);let n=this.params.maxBlocksInCache>0,o=n?this.params.maxBlocksInCache-1:null,s=pX-1;t.forEach((r,a)=>{let l=r.state==="needsLoading"&&a>=s,d=n?a>=o:!1;if(l||d){if(this.isBlockCurrentlyDisplayed(r)||this.isBlockFocused(r))return;this.removeBlockFromCache(r)}})}isBlockFocused(e){let t=this.beans.focusSvc.getFocusCellToUseAfterRefresh();if(!t||t.rowPinned!=null)return!1;let{startRow:i,endRow:n}=e;return t.rowIndex>=i&&t.rowIndex<n}isBlockCurrentlyDisplayed(e){let{startRow:t,endRow:i}=e;return this.beans.rowRenderer.isRangeInRenderedViewport(t,i-1)}removeBlockFromCache(e){e&&this.destroyBlock(e)}checkRowCount(e,t){if(typeof t=="number"&&t>=0)this.rowCount=t,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){let{blockSize:i,overflowSize:n}=this.params,s=(e.id+1)*i+n;this.rowCount<s&&(this.rowCount=s)}}setRowCount(e,t){this.rowCount=e,q(t)&&(this.lastRowIndexKnown=t),this.lastRowIndexKnown||this.rowCount%this.params.blockSize===0&&this.rowCount++,this.onCacheUpdated()}forEachNodeDeep(e){let t={value:0};for(let i of this.getBlocksInOrder())i.forEachNode(e,t,this.rowCount)}getBlocksInOrder(){let e=(i,n)=>i.id-n.id;return Object.values(this.blocks).sort(e)}destroyBlock(e){delete this.blocks[e.id],this.destroyBean(e),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(e)}onCacheUpdated(){this.isAlive()&&(this.destroyAllBlocksPastVirtualRowCount(),this.eventSvc.dispatchEvent({type:"storeUpdated"}))}destroyAllBlocksPastVirtualRowCount(){let e=[];for(let t of this.getBlocksInOrder())t.id*this.params.blockSize>=this.rowCount&&e.push(t);if(e.length>0)for(let t of e)this.destroyBlock(t)}purgeCache(){for(let e of this.getBlocksInOrder())this.removeBlockFromCache(e);this.lastRowIndexKnown=!1,this.rowCount===0&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()}getRowNodesInRange(e,t){let i=[],n=-1,o=!1,s={value:0},r=!1;for(let l of this.getBlocksInOrder())if(!r){if(o&&n+1!==l.id){r=!0;continue}n=l.id,l.forEachNode(d=>{let c=d===e||d===t;(o||c)&&i.push(d),c&&(o=!o)},s,this.rowCount)}return r||o?[]:i}},fX=class extends D{constructor(){super(...arguments),this.beanName="rowModel",this.rootNode=null}getRowBounds(e){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*e}}ensureRowHeightsValid(){return!1}postConstruct(){if(this.gos.get("rowModelType")!=="infinite")return;let e=this.beans,t=new Jo(e);this.rootNode=t,t.level=-1,this.rowHeight=Vs(e),this.addEventListeners(),this.addDestroyFunc(()=>this.destroyCache())}start(){this.setDatasource(this.gos.get("datasource"))}destroy(){this.destroyDatasource(),super.destroy(),this.rootNode=null}destroyDatasource(){this.datasource&&(this.destroyBean(this.datasource),this.beans.rowRenderer.datasourceChanged(),this.datasource=null)}addEventListeners(){this.addManagedEventListeners({filterChanged:this.reset.bind(this),sortChanged:this.reset.bind(this),newColumnsLoaded:this.onColumnEverything.bind(this),storeUpdated:this.dispatchModelUpdatedEvent.bind(this)}),this.addManagedPropertyListener("datasource",()=>this.setDatasource(this.gos.get("datasource"))),this.addManagedPropertyListener("cacheBlockSize",()=>this.resetCache()),this.addManagedPropertyListener("rowHeight",()=>{this.rowHeight=Vs(this.beans),this.cacheParams.rowHeight=this.rowHeight,this.updateRowHeights()})}onColumnEverything(){let e;this.cacheParams?e=!nd(this.cacheParams.sortModel,this.beans.sortSvc?.getSortModel()??[]):e=!0,e&&this.reset()}getType(){return"infinite"}setDatasource(e){this.destroyDatasource(),this.datasource=e,e&&this.reset()}isEmpty(){return!this.infiniteCache}isRowsToRender(){return!!this.infiniteCache}getNodesInRangeForSelection(e,t){return this.infiniteCache?.getRowNodesInRange(e,t)??[]}reset(){if(!this.datasource)return;Ca(this.gos)!=null||this.beans.selectionSvc?.reset("rowDataChanged"),this.resetCache()}dispatchModelUpdatedEvent(){this.eventSvc.dispatchEvent({type:"modelUpdated",newPage:!1,newPageSize:!1,newData:!1,keepRenderedRows:!0,animate:!1})}resetCache(){this.destroyCache();let e=this.beans,{filterManager:t,sortSvc:i,rowNodeBlockLoader:n,eventSvc:o,gos:s}=e;this.cacheParams={datasource:this.datasource,filterModel:t?.getFilterModel()??{},sortModel:i?.getSortModel()??[],rowNodeBlockLoader:n,initialRowCount:s.get("infiniteInitialRowCount"),maxBlocksInCache:s.get("maxBlocksInCache"),rowHeight:Vs(e),overflowSize:s.get("cacheOverflowSize"),blockSize:s.get("cacheBlockSize"),lastAccessedSequence:{value:0}},this.infiniteCache=this.createBean(new gX(this.cacheParams)),o.dispatchEventOnce({type:"rowCountReady"}),this.dispatchModelUpdatedEvent()}updateRowHeights(){this.forEachNode(e=>{e.setRowHeight(this.rowHeight),e.setRowTop(this.rowHeight*e.rowIndex)}),this.dispatchModelUpdatedEvent()}destroyCache(){this.infiniteCache=this.destroyBean(this.infiniteCache)}getRow(e){let t=this.infiniteCache;if(t&&!(e>=t.getRowCount()))return t.getRow(e)}getRowNode(e){let t;return this.forEachNode(i=>{i.id===e&&(t=i)}),t}forEachNode(e){this.infiniteCache?.forEachNodeDeep(e)}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(e){return e}getRowIndexAtPixel(e){if(this.rowHeight!==0){let t=Math.floor(e/this.rowHeight),i=this.getRowCount()-1;return t>i?i:t}return 0}getRowCount(){return this.infiniteCache?this.infiniteCache.getRowCount():0}isRowPresent(e){return!!this.getRowNode(e.id)}refreshCache(){this.infiniteCache?.refreshCache()}purgeCache(){this.infiniteCache?.purgeCache()}isLastRowIndexKnown(){return this.infiniteCache?.isLastRowIndexKnown()??!1}setRowCount(e,t){this.infiniteCache?.setRowCount(e,t)}resetRowHeights(){}onRowHeightChanged(){}};function mX(e){_p(e)?.refreshCache()}function CX(e){_p(e)?.purgeCache()}function vX(e){return _p(e)?.getRowCount()}var wX=class extends D{constructor(){super(...arguments),this.beanName="rowNodeBlockLoader",this.activeBlockLoadsCount=0,this.blocks=[],this.active=!0}postConstruct(){this.maxConcurrentRequests=cO(this.gos);let e=this.gos.get("blockLoadDebounceMillis");e&&e>0&&(this.checkBlockToLoadDebounce=_t(this,this.performCheckBlocksToLoad.bind(this),e))}addBlock(e){this.blocks.push(e),e.addEventListener("loadComplete",this.loadComplete.bind(this)),this.checkBlockToLoad()}removeBlock(e){Yi(this.blocks,e)}destroy(){super.destroy(),this.active=!1}loadComplete(){this.activeBlockLoadsCount--,this.checkBlockToLoad()}checkBlockToLoad(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()}performCheckBlocksToLoad(){if(!this.active)return;if(this.printCacheStatus(),this.maxConcurrentRequests!=null&&this.activeBlockLoadsCount>=this.maxConcurrentRequests){Ko(this.gos,"RowNodeBlockLoader - checkBlockToLoad: max loads exceeded");return}let e=this.maxConcurrentRequests!=null?this.maxConcurrentRequests-this.activeBlockLoadsCount:1,t=this.blocks.filter(i=>i.state==="needsLoading").slice(0,e);this.activeBlockLoadsCount+=t.length;for(let i of t)i.load();this.printCacheStatus()}getBlockState(){let e={};return this.blocks.forEach(t=>{let{id:i,state:n}=t.getBlockStateJson();e[i]=n}),e}printCacheStatus(){Ko(this.gos,`RowNodeBlockLoader - printCacheStatus: activePageLoadsCount = ${this.activeBlockLoadsCount}, blocks = ${JSON.stringify(this.getBlockState())}`)}},bX={moduleName:"InfiniteRowModelCore",version:z,rowModels:["infinite"],beans:[fX,wX]},yX={moduleName:"InfiniteRowModel",version:z,apiFunctions:{refreshInfiniteCache:mX,purgeInfiniteCache:CX,getInfiniteRowCount:vX},dependsOn:[bX,IY]},SX="\u2191",xX="\u2193",EX={tag:"span",children:[{tag:"span",ref:"eDelta",cls:"ag-value-change-delta"},{tag:"span",ref:"eValue",cls:"ag-value-change-value"}]},RX=class extends Oe{constructor(){super(EX),this.eValue=V,this.eDelta=V,this.refreshCount=0}init(e){this.refresh(e,!0)}showDelta(e,t){let i=Math.abs(t),n=e.formatValue(i),o=q(n)?n:i,s=t>=0,r=this.eDelta;s?r.textContent=SX+o:r.textContent=xX+o,r.classList.toggle("ag-value-change-delta-up",s),r.classList.toggle("ag-value-change-delta-down",!s)}setTimerToRemoveDelta(){this.refreshCount++;let e=this.refreshCount;this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.hideDeltaValue()},2e3)})}hideDeltaValue(){this.eValue.classList.remove("ag-value-change-value-highlight"),Ot(this.eDelta)}refresh(e,t=!1){let{value:i,valueFormatted:n}=e,{eValue:o,lastValue:s,beans:r}=this;if(i===s||(q(n)?o.textContent=n:q(i)?o.textContent=i:Ot(o),r.filterManager?.isSuppressFlashingCellsBecauseFiltering()))return!1;let a=i&&typeof i=="object"&&"toNumber"in i?i.toNumber():i,l=s&&typeof s=="object"&&"toNumber"in s?s.toNumber():s;if(a===l)return!1;if(typeof a=="number"&&typeof l=="number"){let d=a-l;this.showDelta(e,d)}return s&&o.classList.add("ag-value-change-value-highlight"),t||this.setTimerToRemoveDelta(),this.lastValue=i,!0}},PX=".ag-value-slide-out{opacity:1}:where(.ag-ltr) .ag-value-slide-out{margin-right:5px;transition:opacity 3s,margin-right 3s}:where(.ag-rtl) .ag-value-slide-out{margin-left:5px;transition:opacity 3s,margin-left 3s}:where(.ag-ltr,.ag-rtl) .ag-value-slide-out{transition-timing-function:linear}.ag-value-slide-out-end{opacity:0}:where(.ag-ltr) .ag-value-slide-out-end{margin-right:10px}:where(.ag-rtl) .ag-value-slide-out-end{margin-left:10px}",MX={tag:"span",children:[{tag:"span",ref:"eCurrent",cls:"ag-value-slide-current"}]},kX=class extends Oe{constructor(){super(MX),this.eCurrent=V,this.refreshCount=0,this.registerCSS(PX)}init(e){this.refresh(e,!0)}addSlideAnimation(){this.refreshCount++;let e=this.refreshCount;this.ePrevious?.remove();let{beans:t,eCurrent:i}=this,n=ft({tag:"span",cls:"ag-value-slide-previous ag-value-slide-out"});this.ePrevious=n,n.textContent=i.textContent,this.getGui().insertBefore(n,i),t.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.ePrevious.classList.add("ag-value-slide-out-end")},50),window.setTimeout(()=>{e===this.refreshCount&&(this.ePrevious?.remove(),this.ePrevious=null)},3e3)})}refresh(e,t=!1){let i=e.value;if(Qe(i)&&(i=""),i===this.lastValue||this.beans.filterManager?.isSuppressFlashingCellsBecauseFiltering())return!1;t||this.addSlideAnimation(),this.lastValue=i;let n=this.eCurrent;return q(e.valueFormatted)?n.textContent=e.valueFormatted:q(e.value)?n.textContent=i:Ot(n),!0}},DX=class extends D{constructor(){super(...arguments),this.beanName="cellFlashSvc",this.nextAnimationTime=null,this.nextAnimationCycle=null,this.animations={highlight:new Map,"data-changed":new Map}}animateCell(e,t,i=this.beans.gos.get("cellFlashDuration"),n=this.beans.gos.get("cellFadeDuration")){let o=this.animations[t];o.delete(e);let s=Date.now(),r=s+i,a=s+i+n,l={phase:"flash",flashEndTime:r,fadeEndTime:a};o.set(e,l);let d=`ag-cell-${t}`,c=`${d}-animation`,{comp:u,eGui:{style:h}}=e;u.toggleCss(d,!0),u.toggleCss(c,!1),h.removeProperty("transition"),h.removeProperty("transition-delay"),this.nextAnimationTime&&r+15<this.nextAnimationTime&&(clearTimeout(this.nextAnimationCycle),this.nextAnimationCycle=null,this.nextAnimationTime=null),this.nextAnimationCycle||(this.beans.frameworkOverrides.wrapIncoming(()=>{this.nextAnimationCycle=setTimeout(this.advanceAnimations.bind(this),i)}),this.nextAnimationTime=r)}advanceAnimations(){let e=Date.now(),t=null;for(let i of Object.keys(this.animations)){let n=this.animations[i],o=`ag-cell-${i}`,s=`${o}-animation`;for(let[r,a]of n){if(!r.isAlive()||!r.comp){n.delete(r);continue}let{phase:l,flashEndTime:d,fadeEndTime:c}=a,u=l==="flash"?d:c;if(!(e+15>=u)){t=Math.min(u,t??1/0);continue}let{comp:p,eGui:{style:g}}=r;switch(l){case"flash":p.toggleCss(o,!1),p.toggleCss(s,!0),g.transition=`background-color ${c-d}ms`,g.transitionDelay=`${d-e}ms`,t=Math.min(c,t??1/0),a.phase="fade";break;case"fade":p.toggleCss(o,!1),p.toggleCss(s,!1),g.removeProperty("transition"),g.removeProperty("transition-delay"),n.delete(r);break}}}t==null?(this.nextAnimationTime=null,this.nextAnimationCycle=null):t&&(this.nextAnimationCycle=setTimeout(this.advanceAnimations.bind(this),t-e),this.nextAnimationTime=t)}onFlashCells(e,t){if(!e.comp)return;let i=DV(e.cellPosition);t.cells[i]&&this.animateCell(e,"highlight")}flashCell(e,t){this.animateCell(e,"data-changed",t?.flashDuration,t?.fadeDuration)}destroy(){for(let e of Object.keys(this.animations))this.animations[e].clear()}};function FX(e,t={}){let{cellFlashSvc:i}=e;i&&e.frameworkOverrides.wrapIncoming(()=>{for(let n of e.rowRenderer.getCellCtrls(t.rowNodes,t.columns))i.flashCell(n,t)})}var TX={moduleName:"HighlightChanges",version:z,beans:[DX],userComponents:{agAnimateShowChangeCellRenderer:RX,agAnimateSlideCellRenderer:kX},apiFunctions:{flashCells:FX}};function AX(e){return e.stateSvc?.getState()??{}}function IX(e,t,i){return e.stateSvc?.setState(t,i)}function NR(e){return e=b({},e),e.version||(e.version="32.1.0"),e.version==="32.1.0"&&(e=LX(e)),e.version=z,e}function LX(e){return e.cellSelection=_X(e,"rangeSelection"),e}function _X(e,t){if(e&&typeof e=="object")return e[t]}var OX=class extends D{constructor(){super(...arguments),this.beanName="stateSvc",this.updateRowGroupExpansionStateTimer=0,this.suppressEvents=!0,this.queuedUpdateSources=new Set,this.dispatchStateUpdateEventDebounced=_t(this,()=>this.dispatchQueuedStateUpdateEvents(),0),this.onRowGroupOpenedDebounced=_t(this,()=>{this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(this.updateCachedState("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("rowGroupExpansion",void 0)):(this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("ssrmRowGroupExpansion",void 0))},0),this.onRowSelectedDebounced=_t(this,()=>{this.staleStateKeys.delete("rowSelection"),this.updateCachedState("rowSelection",this.getRowSelectionState())},0),this.staleStateKeys=new Set}postConstruct(){let{gos:e,ctrlsSvc:t,colDelayRenderSvc:i}=this.beans;this.isClientSideRowModel=gt(e);let n=NR(e.get("initialState")??{}),o=n.partialColumnState;delete n.partialColumnState,this.cachedState=n;let s=this.suppressEventsAndDispatchInitEvent.bind(this);t.whenReady(this,()=>s(()=>this.setupStateOnGridReady(n))),(n.columnOrder||n.columnVisibility||n.columnSizing||n.columnPinning||n.columnGroup)&&i?.hideColumns("columnState");let[r,a,l]=this.addManagedEventListeners({newColumnsLoaded:({source:d})=>{d==="gridInitializing"&&(r(),s(()=>{this.setupStateOnColumnsInitialised(n,!!o),i?.revealColumns("columnState")}))},rowCountReady:()=>{a?.(),s(()=>this.setupStateOnRowCountReady(n))},firstDataRendered:()=>{l?.(),s(()=>this.setupStateOnFirstDataRendered(n))}})}destroy(){super.destroy(),clearTimeout(this.updateRowGroupExpansionStateTimer),this.queuedUpdateSources.clear()}getState(){return this.staleStateKeys.size&&this.refreshStaleState(),this.cachedState}setState(e,t){let i=NR(e);delete i.partialColumnState,this.cachedState=i,this.startSuppressEvents();let n="api",o=t?new Set(t):void 0;this.setGridReadyState(i,n,o),this.setColumnsInitialisedState(i,n,!!o,o),this.setRowCountState(i,n,o),setTimeout(()=>{this.isAlive()&&this.setFirstDataRenderedState(i,n,o),this.stopSuppressEvents(n)})}setGridReadyState(e,t,i){t==="api"&&!i?.has("sideBar")&&this.beans.sideBar?.comp?.setState(e.sideBar),this.updateCachedState("sideBar",this.getSideBarState())}setupStateOnGridReady(e){this.setGridReadyState(e,"gridInitializing");let t=()=>this.updateCachedState("sideBar",this.getSideBarState());this.addManagedEventListeners({toolPanelVisibleChanged:t,sideBarUpdated:t})}updateColumnAndGroupState(){this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","rowGroup","sort"]),this.updateCachedState("columnGroup",this.getColumnGroupState())}setColumnsInitialisedState(e,t,i,n){this.setColumnState(e,t,i,n),this.setColumnGroupState(e,t,n),this.updateColumnAndGroupState()}setupStateOnColumnsInitialised(e,t){this.setColumnsInitialisedState(e,"gridInitializing",t);let i=n=>()=>this.updateColumnState([n]);this.addManagedEventListeners({columnValueChanged:i("aggregation"),columnMoved:i("columnOrder"),columnPinned:i("columnPinning"),columnResized:i("columnSizing"),columnVisible:i("columnVisibility"),columnPivotChanged:i("pivot"),columnPivotModeChanged:i("pivot"),columnRowGroupChanged:i("rowGroup"),sortChanged:i("sort"),newColumnsLoaded:this.updateColumnAndGroupState.bind(this),columnGroupOpened:()=>this.updateCachedState("columnGroup",this.getColumnGroupState())})}setRowCountState(e,t,i){let{filter:n,rowGroupExpansion:o,ssrmRowGroupExpansion:s,rowSelection:r,pagination:a}=e,l=(c,u)=>!i?.has(c)&&(u||t==="api");l("filter",n)&&this.setFilterState(n),l("rowGroupExpansion",o)&&this.setRowGroupExpansionState(s,o,t),l("rowSelection",r)&&this.setRowSelectionState(r,t),l("pagination",a)&&this.setPaginationState(a,t);let d=this.updateCachedState.bind(this);d("filter",this.getFilterState()),this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(d("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),d("rowGroupExpansion",void 0)):(d("rowGroupExpansion",this.getRowGroupExpansionState()),d("ssrmRowGroupExpansion",void 0)),d("rowSelection",this.getRowSelectionState()),d("pagination",this.getPaginationState())}setupStateOnRowCountReady(e){this.setRowCountState(e,"gridInitializing");let t=this.updateCachedState.bind(this),i=()=>{this.updateRowGroupExpansionStateTimer=0,this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(t("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),t("rowGroupExpansion",void 0)):(t("rowGroupExpansion",this.getRowGroupExpansionState()),t("ssrmRowGroupExpansion",void 0))},n=()=>t("filter",this.getFilterState()),{gos:o,colFilter:s}=this.beans;this.addManagedEventListeners({filterChanged:n,rowExpansionStateChanged:this.onRowGroupOpenedDebounced,expandOrCollapseAll:i,columnRowGroupChanged:i,rowDataUpdated:()=>{(o.get("groupDefaultExpanded")!==0||o.get("isGroupOpenByDefault"))&&(this.updateRowGroupExpansionStateTimer||(this.updateRowGroupExpansionStateTimer=setTimeout(i)))},selectionChanged:()=>{this.staleStateKeys.add("rowSelection"),this.onRowSelectedDebounced()},paginationChanged:r=>{(r.newPage||r.newPageSize)&&t("pagination",this.getPaginationState())}}),s&&this.addManagedListeners(s,{filterStateChanged:n})}setFirstDataRenderedState(e,t,i){let{scroll:n,cellSelection:o,focusedCell:s,columnOrder:r,rowPinning:a}=e,l=(u,h)=>!i?.has(u)&&(h||t==="api");l("focusedCell",s)&&this.setFocusedCellState(s),l("cellSelection",o)&&this.setCellSelectionState(o),l("scroll",n)&&this.setScrollState(n),l("rowPinning",a)&&this.setRowPinningState(a),this.setColumnPivotState(!!r?.orderedColIds,t);let d=this.updateCachedState.bind(this);d("sideBar",this.getSideBarState()),d("focusedCell",this.getFocusedCellState());let c=this.getRangeSelectionState();d("rangeSelection",c),d("cellSelection",c),d("scroll",this.getScrollState())}setupStateOnFirstDataRendered(e){this.setFirstDataRenderedState(e,"gridInitializing");let t=this.updateCachedState.bind(this),i=()=>t("focusedCell",this.getFocusedCellState());this.addManagedEventListeners({cellFocused:i,cellFocusCleared:i,cellSelectionChanged:n=>{if(n.finished){let o=this.getRangeSelectionState();t("rangeSelection",o),t("cellSelection",o)}},bodyScrollEnd:()=>t("scroll",this.getScrollState()),pinnedRowsChanged:()=>t("rowPinning",this.getRowPinningState())})}getColumnState(){let e=this.beans;return T$(Cp(e),e.colModel.isPivotMode())}setColumnState(e,t,i,n){let{sort:o,rowGroup:s,aggregation:r,pivot:a,columnPinning:l,columnVisibility:d,columnSizing:c,columnOrder:u}=e,h=!1,p=(W,G)=>{let Q=!n?.has(W)&&!!(G||t==="api");return h||(h=Q),Q},g={},f=W=>{let G=g[W];return G||(G={colId:W},g[W]=G,G)},m={},C=p("sort",o);C&&o?.sortModel.forEach(({colId:W,sort:G},Q)=>{let ge=f(W);ge.sort=G,ge.sortIndex=Q}),(C||!i)&&(m.sort=null,m.sortIndex=null);let v=p("rowGroup",s);v&&s?.groupColIds.forEach((W,G)=>{let Q=f(W);Q.rowGroup=!0,Q.rowGroupIndex=G}),(v||!i)&&(m.rowGroup=null,m.rowGroupIndex=null);let w=p("aggregation",r);w&&r?.aggregationModel.forEach(({colId:W,aggFunc:G})=>{f(W).aggFunc=G}),(w||!i)&&(m.aggFunc=null);let y=p("pivot",a);y&&(a?.pivotColIds.forEach((W,G)=>{let Q=f(W);Q.pivot=!0,Q.pivotIndex=G}),this.gos.updateGridOptions({options:{pivotMode:!!a?.pivotMode},source:t})),(y||!i)&&(m.pivot=null,m.pivotIndex=null);let S=p("columnPinning",l);if(S){for(let W of l?.leftColIds??[])f(W).pinned="left";for(let W of l?.rightColIds??[])f(W).pinned="right"}(S||!i)&&(m.pinned=null);let x=p("columnVisibility",d);if(x)for(let W of d?.hiddenColIds??[])f(W).hide=!0;(x||!i)&&(m.hide=null);let E=p("columnSizing",c);if(E)for(let{colId:W,flex:G,width:Q}of c?.columnSizingModel??[]){let ge=f(W);ge.flex=G??null,ge.width=Q}(E||!i)&&(m.flex=null);let T=u?.orderedColIds,L=!!T?.length&&!n?.has("columnOrder"),O=L?T.map(W=>f(W)):Object.values(g);(O.length||h)&&(this.columnStates=O,Ki(this.beans,{state:O,applyOrder:L,defaultState:m},t))}setColumnPivotState(e,t){let i=this.columnStates;this.columnStates=void 0;let n=this.columnGroupStates;this.columnGroupStates=void 0;let o=this.beans,{pivotResultCols:s,colGroupSvc:r}=o;if(s?.isPivotResultColsPresent()){if(i){let a=[];for(let l of i)s.getPivotResultCol(l.colId)&&a.push(l);Ki(o,{state:a,applyOrder:e},t)}n&&r?.setColumnGroupState(n,t)}}getColumnGroupState(){let e=this.beans.colGroupSvc;if(!e)return;let t=e.getColumnGroupState();return A$(t)}setColumnGroupState(e,t,i){let n=this.beans.colGroupSvc;if(!n||i?.has("columnGroup")||t!=="api"&&!Object.prototype.hasOwnProperty.call(e,"columnGroup"))return;let o=new Set(e.columnGroup?.openColumnGroupIds),r=n.getColumnGroupState().map(({groupId:a})=>{let l=o.has(a);return l&&o.delete(a),{groupId:a,open:l}});for(let a of o)r.push({groupId:a,open:!0});r.length&&(this.columnGroupStates=r),n.setColumnGroupState(r,t)}getFilterState(){let e=this.beans.filterManager,t=e?.getFilterModel();t&&Object.keys(t).length===0&&(t=void 0);let i=e?.getFilterState(),n=e?.getAdvFilterModel()??void 0;return t||n||i?{filterModel:t,columnFilterState:i,advancedFilterModel:n}:void 0}setFilterState(e){let t=this.beans.filterManager,{filterModel:i,columnFilterState:n,advancedFilterModel:o}=e??{filterModel:null,columnFilterState:null,advancedFilterModel:null};(i!==void 0||n!==void 0)&&t?.setFilterState(i??null,n??null,"columnFilter"),o!==void 0&&t?.setAdvFilterModel(o??null,"advancedFilter")}getRangeSelectionState(){let e=this.beans.rangeSvc?.getCellRanges().map(t=>{let{id:i,type:n,startRow:o,endRow:s,columns:r,startColumn:a}=t;return{id:i,type:n,startRow:o,endRow:s,colIds:r.map(l=>l.getColId()),startColId:a.getColId()}});return e?.length?{cellRanges:e}:void 0}setCellSelectionState(e){let{gos:t,rangeSvc:i,colModel:n,visibleCols:o}=this.beans;if(!uo(t)||!i)return;let s=[];for(let r of e?.cellRanges??[]){let a=[];for(let d of r.colIds){let c=n.getCol(d);c&&a.push(c)}if(!a.length)continue;let l=n.getCol(r.startColId);if(!l){let d=o.allCols,c=new Set(a);l=d.find(u=>c.has(u))}s.push(_(b({},r),{columns:a,startColumn:l}))}i.setCellRanges(s)}getScrollState(){if(!this.isClientSideRowModel)return;let e=this.beans.ctrlsSvc.getScrollFeature(),{left:t}=e?.getHScrollPosition()??{left:0},{top:i}=e?.getVScrollPosition()??{top:0};return i||t?{top:i,left:t}:void 0}setScrollState(e){if(!this.isClientSideRowModel)return;let{top:t,left:i}=e??{top:0,left:0},{frameworkOverrides:n,rowRenderer:o,animationFrameSvc:s,ctrlsSvc:r}=this.beans;n.wrapIncoming(()=>{r.get("center").setCenterViewportScrollLeft(i),r.getScrollFeature()?.setVerticalScrollPosition(t),o.redraw({afterScroll:!0}),s?.flushAllFrames()})}getSideBarState(){return this.beans.sideBar?.comp?.getState()}getFocusedCellState(){if(!this.isClientSideRowModel)return;let e=this.beans.focusSvc.getFocusedCell();if(e){let{column:t,rowIndex:i,rowPinned:n}=e;return{colId:t.getColId(),rowIndex:i,rowPinned:n}}}setFocusedCellState(e){if(!this.isClientSideRowModel)return;let{focusSvc:t,colModel:i}=this.beans;if(!e){t.clearFocusedCell();return}let{colId:n,rowIndex:o,rowPinned:s}=e;t.setFocusedCell({column:i.getCol(n),rowIndex:o,rowPinned:s,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}getPaginationState(){let{pagination:e,gos:t}=this.beans;if(!e)return;let i=e.getCurrentPage(),n=t.get("paginationAutoPageSize")?void 0:e.getPageSize();if(!(!i&&!n))return{page:i,pageSize:n}}setPaginationState(e,t){let{pagination:i,gos:n}=this.beans;if(!i)return;let{pageSize:o,page:s}=e??{page:0,pageSize:n.get("paginationPageSize")},r=t==="gridInitializing";o&&!n.get("paginationAutoPageSize")&&i.setPageSize(o,r?"initialState":"pageSizeSelector"),typeof s=="number"&&(r?i.setPage(s):i.goToPage(s))}getRowSelectionState(){let e=this.beans.selectionSvc;if(!e)return;let t=e.getSelectionState();return!t||!Array.isArray(t)&&(t.selectAll===!1||t.selectAllChildren===!1)&&!t?.toggledNodes?.length?void 0:t}setRowSelectionState(e,t){this.beans.selectionSvc?.setSelectionState(e,t,t==="api")}getRowGroupExpansionState(){let{expansionSvc:e}=this.beans;if(e)return e.getExpansionState()}getRowPinningState(){return this.beans.pinnedRowModel?.getPinnedState()}setRowPinningState(e){let t=this.beans.pinnedRowModel;e?t?.setPinnedState(e):t?.reset()}setRowGroupExpansionState(e,t,i){let n=this.beans.expansionSvc;if(!n)return;let o=t??{expandedRowGroupIds:[],collapsedRowGroupIds:[]};n.setExpansionState(o,i)}updateColumnState(e){let t=this.getColumnState(),i=!1,n=this.cachedState;for(let o of Object.keys(t)){let s=t[o];nd(s,n[o])||(i=!0)}this.cachedState=b(b({},n),t),i&&this.dispatchStateUpdateEvent(e)}updateCachedState(e,t){let i=this.cachedState[e];this.setCachedStateValue(e,t),nd(t,i)||this.dispatchStateUpdateEvent([e])}setCachedStateValue(e,t){this.cachedState=_(b({},this.cachedState),{[e]:t})}refreshStaleState(){let e=this.staleStateKeys;for(let t of e)t==="rowSelection"&&this.setCachedStateValue(t,this.getRowSelectionState());e.clear()}dispatchStateUpdateEvent(e){if(!this.suppressEvents){for(let t of e)this.queuedUpdateSources.add(t);this.dispatchStateUpdateEventDebounced()}}dispatchQueuedStateUpdateEvents(){let e=this.queuedUpdateSources,t=Array.from(e);e.clear(),this.eventSvc.dispatchEvent({type:"stateUpdated",sources:t,state:this.cachedState})}startSuppressEvents(){this.suppressEvents=!0,this.beans.colAnimation?.setSuppressAnimation(!0)}stopSuppressEvents(e){setTimeout(()=>{this.suppressEvents=!1,this.queuedUpdateSources.clear(),this.isAlive()&&(this.beans.colAnimation?.setSuppressAnimation(!1),this.dispatchStateUpdateEvent([e]))})}suppressEventsAndDispatchInitEvent(e){this.startSuppressEvents(),e(),this.stopSuppressEvents("gridInitializing")}},NX={moduleName:"GridState",version:z,beans:[OX],apiFunctions:{getState:AX,setState:IX}};function BX(e){return e.rowModel.isLastRowIndexKnown()}function HX(e){return e.pagination?.getPageSize()??100}function GX(e){return e.pagination?.getCurrentPage()??0}function VX(e){return e.pagination?.getTotalPages()??1}function zX(e){return e.pagination?e.pagination.getMasterRowCount():e.rowModel.getRowCount()}function WX(e){e.pagination?.goToNextPage()}function UX(e){e.pagination?.goToPreviousPage()}function qX(e){e.pagination?.goToFirstPage()}function $X(e){e.pagination?.goToLastPage()}function jX(e,t){e.pagination?.goToPage(t)}var KX=class extends D{constructor(){super(...arguments),this.beanName="paginationAutoPageSizeSvc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.centerRowsCtrl=e.center;let t=this.checkPageSize.bind(this);this.addManagedEventListeners({bodyHeightChanged:t,scrollVisibilityChanged:t}),this.addManagedPropertyListener("paginationAutoPageSize",this.onPaginationAutoSizeChanged.bind(this)),this.checkPageSize()})}notActive(){return!this.gos.get("paginationAutoPageSize")||this.centerRowsCtrl==null}onPaginationAutoSizeChanged(){this.notActive()?this.beans.pagination.unsetAutoCalculatedPageSize():this.checkPageSize()}checkPageSize(){if(this.notActive())return;let e=this.centerRowsCtrl.viewportSizeFeature.getBodyHeight();if(e>0){let t=this.beans,i=()=>{let n=Math.max(Vs(t),1),o=Math.floor(e/n);t.pagination.setPageSize(o,"autoCalculated")};this.isBodyRendered?_t(this,i,50)():(i(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}},Ul="paginationPageSizeSelector",YX={tag:"span",cls:"ag-paging-page-size"},XX=class extends Oe{constructor(){super(YX),this.hasEmptyOption=!1,this.handlePageSizeItemSelected=()=>{if(!this.selectPageSizeComp)return;let e=this.selectPageSizeComp.getValue();if(!e)return;let t=Number(e);isNaN(t)||t<1||t===this.pagination.getPageSize()||(this.pagination.setPageSize(t,"pageSizeSelector"),this.hasEmptyOption&&this.toggleSelectDisplay(!0),this.selectPageSizeComp.getFocusableElement().focus())}}wireBeans(e){this.pagination=e.pagination}postConstruct(){this.addManagedPropertyListener(Ul,()=>{this.onPageSizeSelectorValuesChange()}),this.addManagedEventListeners({paginationChanged:e=>this.handlePaginationChanged(e)})}handlePaginationChanged(e){if(!this.selectPageSizeComp||!e?.newPageSize)return;let t=this.pagination.getPageSize();this.getPageSizeSelectorValues().includes(t)?this.selectPageSizeComp.setValue(t.toString()):this.hasEmptyOption?this.selectPageSizeComp.setValue(""):this.toggleSelectDisplay(!0)}toggleSelectDisplay(e){this.selectPageSizeComp&&!e&&this.reset(),e&&(this.reloadPageSizesSelector(),this.selectPageSizeComp)}reset(){Ot(this.getGui()),this.selectPageSizeComp&&(this.selectPageSizeComp=this.destroyBean(this.selectPageSizeComp))}onPageSizeSelectorValuesChange(){this.selectPageSizeComp&&this.shouldShowPageSizeSelector()&&this.reloadPageSizesSelector()}shouldShowPageSizeSelector(){return this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel")&&!this.gos.get("paginationAutoPageSize")&&this.gos.get(Ul)!==!1}reloadPageSizesSelector(){let e=this.getPageSizeSelectorValues(),t=this.pagination.getPageSize(),i=!t||!e.includes(t);if(i){let o=this.gos.exists("paginationPageSize"),s=this.gos.get(Ul)!==!0;I(94,{pageSizeSet:o,pageSizesSet:s,pageSizeOptions:e,paginationPageSizeOption:t}),s||I(95,{paginationPageSizeOption:t,paginationPageSizeSelector:Ul}),e.unshift("")}let n=String(i?"":t);this.selectPageSizeComp?(Zo(this.pageSizeOptions,e)||(this.selectPageSizeComp.clearOptions().addOptions(this.createPageSizeSelectOptions(e)),this.pageSizeOptions=e),this.selectPageSizeComp.setValue(n,!0)):this.createPageSizeSelectorComp(e,n),this.hasEmptyOption=i}createPageSizeSelectOptions(e){return e.map(t=>({value:String(t)}))}createPageSizeSelectorComp(e,t){let i=this.getLocaleTextFunc(),n=i("pageSizeSelectorLabel","Page Size:"),o=i("ariaPageSizeSelectorLabel","Page Size");this.selectPageSizeComp=this.createManagedBean(new vv).addOptions(this.createPageSizeSelectOptions(e)).setValue(t).setAriaLabel(o).setLabel(n).onValueChange(()=>this.handlePageSizeItemSelected()),this.appendChild(this.selectPageSizeComp)}getPageSizeSelectorValues(){let e=[20,50,100],t=this.gos.get(Ul);return!Array.isArray(t)||!t?.length?e:[...t].sort((i,n)=>i-n)}destroy(){this.toggleSelectDisplay(!1),super.destroy()}},JX={selector:"AG-PAGE-SIZE-SELECTOR",component:XX},QX=".ag-paging-panel{align-items:center;border-top:var(--ag-footer-row-border);display:flex;gap:calc(var(--ag-spacing)*4);height:var(--ag-pagination-panel-height);justify-content:flex-end;padding:0 var(--ag-cell-horizontal-padding)}:where(.ag-paging-page-size) .ag-wrapper{min-width:50px}.ag-paging-page-summary-panel{align-items:center;display:flex;gap:var(--ag-cell-widget-spacing);.ag-disabled &{pointer-events:none}}.ag-paging-button{cursor:pointer;position:relative;&.ag-disabled{cursor:default;opacity:.5}}.ag-paging-number,.ag-paging-row-summary-panel-number{font-weight:500}",ZX=class extends I4{constructor(){super(),this.btFirst=V,this.btPrevious=V,this.btNext=V,this.btLast=V,this.lbRecordCount=V,this.lbFirstRowOnPage=V,this.lbLastRowOnPage=V,this.lbCurrent=V,this.lbTotal=V,this.pageSizeComp=V,this.previousAndFirstButtonsDisabled=!1,this.nextButtonDisabled=!1,this.lastButtonDisabled=!1,this.areListenersSetup=!1,this.allowFocusInnerElement=!1,this.registerCSS(QX)}wireBeans(e){this.rowModel=e.rowModel,this.pagination=e.pagination,this.ariaAnnounce=e.ariaAnnounce}postConstruct(){let e=this.gos.get("enableRtl");this.setTemplate(this.getTemplate(),[JX]);let{btFirst:t,btPrevious:i,btNext:n,btLast:o}=this;this.activateTabIndex([t,i,n,o]),t.insertAdjacentElement("afterbegin",Ni(e?"last":"first",this.beans)),i.insertAdjacentElement("afterbegin",Ni(e?"next":"previous",this.beans)),n.insertAdjacentElement("afterbegin",Ni(e?"previous":"next",this.beans)),o.insertAdjacentElement("afterbegin",Ni(e?"first":"last",this.beans)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.addManagedPropertyListeners(["paginationPageSizeSelector","paginationAutoPageSize","suppressPaginationPanel"],()=>this.onPageSizeRelatedOptionsChange()),this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector()),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:s=>this.allowFocusInnerElement?this.tabGuardFeature.getTabGuardCtrl().focusInnerElement(s):XH(this.beans,s),forceFocusOutWhenTabGuardsAreEmpty:!0}),this.onPaginationChanged()}setAllowFocus(e){this.allowFocusInnerElement=e}onPaginationChanged(){let t=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.setDisplayed(t),t&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateLabels(),this.onPageSizeRelatedOptionsChange())}onPageSizeRelatedOptionsChange(){this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector())}setupListeners(){if(!this.areListenersSetup){this.addManagedEventListeners({paginationChanged:this.onPaginationChanged.bind(this)});for(let e of[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}]){let{el:t,fn:i}=e;this.addManagedListeners(t,{click:i,keydown:n=>{(n.key===R.ENTER||n.key===R.SPACE)&&(n.preventDefault(),i())}})}YH(this.beans,this,this.getGui()),this.areListenersSetup=!0}}onBtFirst(){this.previousAndFirstButtonsDisabled||this.pagination.goToFirstPage()}formatNumber(e){let t=this.gos.getCallback("paginationNumberFormatter");return t?t({value:e}):I$(e,this.getLocaleTextFunc.bind(this))}getTemplate(){let e=this.getLocaleTextFunc(),t=`ag-${this.getCompId()}`;return{tag:"div",cls:"ag-paging-panel ag-unselectable",attrs:{id:`${t}`},children:[{tag:"ag-page-size-selector",ref:"pageSizeComp"},{tag:"span",cls:"ag-paging-row-summary-panel",children:[{tag:"span",ref:"lbFirstRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-first-row`}},{tag:"span",attrs:{id:`${t}-to`},children:e("to","to")},{tag:"span",ref:"lbLastRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-last-row`}},{tag:"span",attrs:{id:`${t}-of`},children:e("of","of")},{tag:"span",ref:"lbRecordCount",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-row-count`}}]},{tag:"span",cls:"ag-paging-page-summary-panel",role:"presentation",children:[{tag:"div",ref:"btFirst",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("firstPage","First Page")}},{tag:"div",ref:"btPrevious",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("previousPage","Previous Page")}},{tag:"span",cls:"ag-paging-description",children:[{tag:"span",attrs:{id:`${t}-start-page`},children:e("page","Page")},{tag:"span",ref:"lbCurrent",cls:"ag-paging-number",attrs:{id:`${t}-start-page-number`}},{tag:"span",attrs:{id:`${t}-of-page`},children:e("of","of")},{tag:"span",ref:"lbTotal",cls:"ag-paging-number",attrs:{id:`${t}-of-page-number`}}]},{tag:"div",ref:"btNext",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("nextPage","Next Page")}},{tag:"div",ref:"btLast",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("lastPage","Last Page")}}]}]}}onBtNext(){this.nextButtonDisabled||this.pagination.goToNextPage()}onBtPrevious(){this.previousAndFirstButtonsDisabled||this.pagination.goToPreviousPage()}onBtLast(){this.lastButtonDisabled||this.pagination.goToLastPage()}enableOrDisableButtons(){let e=this.pagination.getCurrentPage(),t=this.rowModel.isLastRowIndexKnown(),i=this.pagination.getTotalPages();this.previousAndFirstButtonsDisabled=e===0,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);let n=this.isZeroPagesToDisplay(),o=e===i-1;this.nextButtonDisabled=o||n,this.lastButtonDisabled=!t||n||e===i-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}toggleButtonDisabled(e,t){u_(e,t),e.classList.toggle("ag-disabled",t)}isZeroPagesToDisplay(){let e=this.rowModel.isLastRowIndexKnown(),t=this.pagination.getTotalPages();return e&&t===0}updateLabels(){let e=this.rowModel.isLastRowIndexKnown(),t=this.pagination.getTotalPages(),i=this.pagination.getMasterRowCount(),n=e?i:null,o=this.pagination.getCurrentPage(),s=this.pagination.getPageSize(),r,a;this.isZeroPagesToDisplay()?r=a=0:(r=s*o+1,a=r+s-1,e&&a>n&&(a=n));let l=r+s-1,d=!e&&i<l,c=this.formatNumber(r);this.lbFirstRowOnPage.textContent=c;let u,h=this.getLocaleTextFunc();d?u=h("pageLastRowUnknown","?"):u=this.formatNumber(a),this.lbLastRowOnPage.textContent=u;let g=t>0?o+1:0,f=this.formatNumber(g);this.lbCurrent.textContent=f;let m,C;if(e)m=this.formatNumber(t),C=this.formatNumber(n);else{let v=h("more","more");m=v,C=v}this.lbTotal.textContent=m,this.lbRecordCount.textContent=C,this.announceAriaStatus(c,u,C,f,m)}announceAriaStatus(e,t,i,n,o){let s=this.getLocaleTextFunc(),r=s("page","Page"),a=s("to","to"),l=s("of","of"),d=`${e} ${a} ${t} ${l} ${i}`,c=`${r} ${n} ${l} ${o}`;d!==this.ariaRowStatus&&(this.ariaRowStatus=d,this.ariaAnnounce?.announceValue(d,"paginationRow")),c!==this.ariaPageStatus&&(this.ariaPageStatus=c,this.ariaAnnounce?.announceValue(c,"paginationPage"))}},eJ={selector:"AG-PAGINATION",component:ZX},tJ=class extends D{constructor(){super(...arguments),this.beanName="pagination",this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=0,this.masterRowCount=0}postConstruct(){let e=this.gos;this.active=e.get("pagination"),this.pageSizeFromGridOptions=e.get("paginationPageSize"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedPropertyListener("pagination",this.onPaginationGridOptionChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPageSizeGridOptionChanged.bind(this))}getPaginationSelector(){return eJ}isPaginateChildRows(){let e=this.gos;return e.get("groupHideParentOfSingleChild")||e.get("groupRemoveSingleChildren")||e.get("groupRemoveLowestSingleChildren")?!0:e.get("paginateChildRows")}onPaginationGridOptionChanged(){this.active=this.gos.get("pagination"),this.calculatePages(),this.dispatchPaginationChangedEvent({keepRenderedRows:!0})}onPageSizeGridOptionChanged(){this.setPageSize(this.gos.get("paginationPageSize"),"gridOptions")}goToPage(e){let t=this.currentPage;if(!this.active||t===e||typeof t!="number")return;let{editSvc:i}=this.beans;i?.isEditing()&&(i.isBatchEditing()?i.cleanupEditors():i.stopEditing(void 0,{source:"api"})),this.currentPage=e,this.calculatePages(),this.dispatchPaginationChangedEvent({newPage:!0})}goToPageWithIndex(e){if(!this.active)return;let t=e;this.paginateChildRows||(t=this.beans.rowModel.getTopLevelIndexFromDisplayedIndex?.(e)??e),this.goToPage(Math.floor(t/this.pageSize))}isRowInPage(e){return this.active?e>=this.topDisplayedRowIndex&&e<=this.bottomDisplayedRowIndex:!0}getCurrentPage(){return this.currentPage}goToNextPage(){this.goToPage(this.currentPage+1)}goToPreviousPage(){this.goToPage(this.currentPage-1)}goToFirstPage(){this.goToPage(0)}goToLastPage(){let e=this.beans.rowModel.getRowCount(),t=Math.floor(e/this.pageSize);this.goToPage(t)}getPageSize(){return this.pageSize}getTotalPages(){return this.totalPages}setPage(e){this.currentPage=e}get pageSize(){return q(this.pageSizeAutoCalculated)&&this.gos.get("paginationAutoPageSize")?this.pageSizeAutoCalculated:q(this.pageSizeFromPageSizeSelector)?this.pageSizeFromPageSizeSelector:q(this.pageSizeFromInitialState)?this.pageSizeFromInitialState:q(this.pageSizeFromGridOptions)?this.pageSizeFromGridOptions:this.defaultPageSize}calculatePages(){this.active?this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly():this.calculatedPagesNotActive(),this.beans.pageBounds.calculateBounds(this.topDisplayedRowIndex,this.bottomDisplayedRowIndex)}unsetAutoCalculatedPageSize(){if(this.pageSizeAutoCalculated===void 0)return;let e=this.pageSizeAutoCalculated;this.pageSizeAutoCalculated=void 0,this.pageSize!==e&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0}))}setPageSize(e,t){let i=this.pageSize;switch(t){case"autoCalculated":this.pageSizeAutoCalculated=e;break;case"pageSizeSelector":this.pageSizeFromPageSizeSelector=e,this.currentPage!==0&&this.goToFirstPage();break;case"initialState":this.pageSizeFromInitialState=e;break;case"gridOptions":this.pageSizeFromGridOptions=e,this.pageSizeFromInitialState=void 0,this.pageSizeFromPageSizeSelector=void 0,this.currentPage!==0&&this.goToFirstPage();break}i!==this.pageSize&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0,keepRenderedRows:!0}))}setZeroRows(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}adjustCurrentPageIfInvalid(){let e=this.totalPages;this.currentPage>=e&&(this.currentPage=e-1);let t=this.currentPage;(!isFinite(t)||isNaN(t)||t<0)&&(this.currentPage=0)}calculatePagesMasterRowsOnly(){let e=this.beans.rowModel,t=e.getTopLevelRowCount();if(this.masterRowCount=t,t<=0){this.setZeroRows();return}let i=this.pageSize,n=t-1;this.totalPages=Math.floor(n/i)+1,this.adjustCurrentPageIfInvalid();let o=this.currentPage,s=i*o,r=i*(o+1)-1;if(r>n&&(r=n),this.topDisplayedRowIndex=e.getTopLevelRowDisplayedIndex(s),r===n)this.bottomDisplayedRowIndex=e.getRowCount()-1;else{let a=e.getTopLevelRowDisplayedIndex(r+1);this.bottomDisplayedRowIndex=a-1}}getMasterRowCount(){return this.masterRowCount}calculatePagesAllRows(){let e=this.beans.rowModel.getRowCount();if(this.masterRowCount=e,e===0){this.setZeroRows();return}let{pageSize:t,currentPage:i}=this,n=e-1;this.totalPages=Math.floor(n/t)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=t*i,this.bottomDisplayedRowIndex=t*(i+1)-1,this.bottomDisplayedRowIndex>n&&(this.bottomDisplayedRowIndex=n)}calculatedPagesNotActive(){this.setPageSize(void 0,"autoCalculated"),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.beans.rowModel.getRowCount()-1}dispatchPaginationChangedEvent(e){let{keepRenderedRows:t=!1,newPage:i=!1,newPageSize:n=!1}=e;this.eventSvc.dispatchEvent({type:"paginationChanged",animate:!1,newData:!1,newPage:i,newPageSize:n,keepRenderedRows:t})}},iJ={moduleName:"Pagination",version:z,beans:[tJ,KX],icons:{first:"first",previous:"previous",next:"next",last:"last"},apiFunctions:{paginationIsLastPageFound:BX,paginationGetPageSize:HX,paginationGetCurrentPage:GX,paginationGetTotalPages:VX,paginationGetRowCount:zX,paginationGoToNextPage:WX,paginationGoToPreviousPage:UX,paginationGoToFirstPage:qX,paginationGoToLastPage:$X,paginationGoToPage:jX},dependsOn:[Op]};function nJ(e,t={}){let i=t?t.rowNodes:void 0;e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.redrawRows(i))}function XP(e,t,i,n,o){t&&(n&&t.parent&&t.parent.level!==-1&&XP(e,t.parent,i,n,o),t.setExpanded(i,void 0,o))}function oJ(e,t){return e.rowModel.getRowNode(t)}function sJ(e,t,i,n){e.rowRenderer.addRenderedRowListener(t,i,n)}function rJ(e){return e.rowRenderer.getRenderedNodes()}function aJ(e,t,i){e.rowModel.forEachNode(t,i)}function lJ(e){return e.rowRenderer.firstRenderedRow}function dJ(e){return e.rowRenderer.lastRenderedRow}function cJ(e,t){return e.rowModel.getRow(t)}function uJ(e){return e.rowModel.getRowCount()}var hJ={moduleName:"RowApi",version:z,apiFunctions:{redrawRows:nJ,setRowNodeExpanded:XP,getRowNode:oJ,addRenderedRowListener:sJ,getRenderedNodes:rJ,forEachNode:aJ,getFirstDisplayedRowIndex:lJ,getLastDisplayedRowIndex:dJ,getDisplayedRowAtIndex:cJ,getDisplayedRowCount:uJ}},pJ={moduleName:"ScrollApi",version:z,apiFunctions:{getVerticalPixelRange:RK,getHorizontalPixelRange:PK,ensureColumnVisible:OP,ensureIndexVisible:NP,ensureNodeVisible:MK}};function gJ(e,t,i){if(!t)return;let n=e.ctrlsSvc.getGridBodyCtrl().eGridBody,o=`aria-${t}`;i===null?n.removeAttribute(o):n.setAttribute(o,i)}function fJ(e,t={}){e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.refreshCells(t))}function mJ(e){e.frameworkOverrides.wrapIncoming(()=>{for(let t of e.ctrlsSvc.getHeaderRowContainerCtrls())t.refresh()})}function CJ(e){return e.animationFrameSvc?.isQueueEmpty()??!0}function vJ(e){e.animationFrameSvc?.flushAllFrames()}function wJ(e){return{rowHeight:Vs(e),headerHeight:yd(e)}}function bJ(e,t={}){let i=[];for(let s of e.rowRenderer.getCellCtrls(t.rowNodes,t.columns)){let r=s.getCellRenderer();r!=null&&i.push(ud(r))}if(t.columns?.length)return i;let n=[],o=KC(t.rowNodes);for(let s of e.rowRenderer.getAllRowCtrls()){if(o&&!YC(s.rowNode,o)||!s.isFullWidth())continue;let r=s.getFullWidthCellRenderers();for(let a=0;a<r.length;a++){let l=r[a];l!=null&&n.push(ud(l))}}return[...n,...i]}var yJ={moduleName:"RenderApi",version:z,apiFunctions:{setGridAriaProperty:gJ,refreshCells:fJ,refreshHeader:mJ,isAnimationFrameQueueEmpty:CJ,flushAllAnimationFrames:vJ,getSizesForCurrentTheme:wJ,getCellRendererInstances:bJ}};function SJ(e,t){typeof t=="number"?e.colAutosize?.sizeColumnsToFit(t,"api"):e.colAutosize?.sizeColumnsToFitGridBody(t)}function JP({colAutosize:e,visibleCols:t},i,n){Array.isArray(i)?e?.autoSizeCols({colKeys:i,skipHeader:n,source:"api"}):e?.autoSizeCols(_(b({},i),{colKeys:i.colIds??t.allCols,source:"api"}))}function xJ(e,t){t&&typeof t=="object"?JP(e,t):e.colAutosize?.autoSizeAllColumns({source:"api",skipHeader:t})}var EJ=class extends D{constructor(){super(...arguments),this.beanName="colAutosize",this.timesDelayed=0,this.shouldQueueResizeOperations=!1,this.resizeOperationQueue=[]}postConstruct(){let{gos:e}=this,t=e.get("autoSizeStrategy");if(t){let i=!1,n=t.type;if(n==="fitGridWidth"||n==="fitProvidedWidth")i=!0;else if(n==="fitCellContents"){this.addManagedEventListeners({firstDataRendered:()=>this.onFirstDataRendered(t)});let o=e.get("rowData");i=o!=null&&o.length>0&&gt(e)}i&&this.beans.colDelayRenderSvc?.hideColumns(n)}}autoSizeCols(e){let{eventSvc:t,visibleCols:i}=this.beans;this.innerAutoSizeCols(e).then(n=>{let o=d=>va(t,Array.from(d),!0,"autosizeColumns");if(!e.scaleUpToFitGridWidth)return o(n);let s=BR(this.beans),r=d=>i.leftCols.some(c=>Ql(c,d)),a=d=>i.rightCols.some(c=>Ql(c,d)),l=e.colKeys.filter(d=>!go(d)&&!ao(d)&&!r(d)&&!a(d));this.sizeColumnsToFit(s,e.source,!0,{defaultMaxWidth:e.defaultMaxWidth,defaultMinWidth:e.defaultMinWidth,columnLimits:e.columnLimits?.map(d=>_(b({},d),{key:d.colId})),colKeys:l,onlyScaleUp:!0}),o(n)})}innerAutoSizeCols(e){return new Promise((t,i)=>{if(this.shouldQueueResizeOperations)return this.pushResizeOperation(()=>this.innerAutoSizeCols(e).then(t,i));let{colKeys:n,skipHeader:o,skipHeaderGroups:s,stopAtGroup:r,defaultMaxWidth:a,defaultMinWidth:l,columnLimits:d=[],source:c="api"}=e,{animationFrameSvc:u,renderStatus:h,colModel:p,autoWidthCalc:g,visibleCols:f}=this.beans;if(u?.flushAllFrames(),this.timesDelayed<5&&h&&(!h.areHeaderCellsRendered()||!h.areCellsRendered())){this.timesDelayed++,setTimeout(()=>{this.isAlive()&&this.innerAutoSizeCols(e).then(t,i)});return}this.timesDelayed=0;let m=new Set,C=-1,v=Object.fromEntries(d.map(E=>{var T=E,{colId:S}=T,x=oi(T,["colId"]);return[S,x]})),w=o??this.gos.get("skipHeaderOnAutoSize"),y=s??w;for(;C!==0;){C=0;let S=[];for(let x of n){if(!x||xO(x))continue;let E=p.getCol(x);if(!E||m.has(E))continue;let T=g.getPreferredWidthForColumn(E,w);if(T>0){let L=v[E.colId]??{};L.minWidth??(L.minWidth=l),L.maxWidth??(L.maxWidth=a);let O=RJ(E,T,L);E.setActualWidth(O,c),m.add(E),C++}S.push(E)}S.length&&f.refresh(c)}y||this.autoSizeColumnGroupsByColumns(n,c,r),t(m)})}autoSizeColumn(e,t,i){this.autoSizeCols({colKeys:[e],skipHeader:i,skipHeaderGroups:!0,source:t})}autoSizeColumnGroupsByColumns(e,t,i){let{colModel:n,ctrlsSvc:o}=this.beans,s=new Set,r=n.getColsForKeys(e);for(let l of r){let d=l.getParent();for(;d&&d!=i;)d.isPadding()||s.add(d),d=d.getParent()}let a;for(let l of s){for(let d of o.getHeaderRowContainerCtrls())if(a=d.getHeaderCtrlForColumn(l),a)break;a?.resizeLeafColumnsToFit(t)}}autoSizeAllColumns(e){if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.autoSizeAllColumns(e));return}this.autoSizeCols(b({colKeys:this.beans.visibleCols.allCols},e))}addColumnAutosizeListeners(e,t){let i=this.gos.get("skipHeaderOnAutoSize"),n=()=>{this.autoSizeColumn(t,"uiColumnResized",i)};e.addEventListener("dblclick",n);let o=new Os(e);return o.addEventListener("doubleTap",n),()=>{e.removeEventListener("dblclick",n),o.destroy()}}addColumnGroupResize(e,t,i){let n=this.gos.get("skipHeaderOnAutoSize"),o=()=>{let s=[],r=t.getDisplayedLeafColumns();for(let a of r)a.getColDef().suppressAutoSize||s.push(a.getColId());s.length>0&&this.autoSizeCols({colKeys:s,skipHeader:n,stopAtGroup:t,source:"uiColumnResized"}),i()};return e.addEventListener("dblclick",o),()=>e.removeEventListener("dblclick",o)}sizeColumnsToFitGridBody(e,t){if(!this.isAlive())return;let i=BR(this.beans);if(i>0){this.sizeColumnsToFit(i,"sizeColumnsToFit",!1,e);return}t===void 0?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,100)},0):t===100?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,500)},100):t===500?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,-1)},500):I(29)}sizeColumnsToFit(e,t="sizeColumnsToFit",i,n){if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.sizeColumnsToFit(e,t,i,n));return}let o={};for(let g of n?.columnLimits??[]){let f=g,{key:m}=f,C=oi(f,["key"]);o[typeof m=="string"?m:m.getColId()]=C}let s=this.beans.visibleCols.allCols;if(e<=0||!s.length)return;let r=oo(s);if(n?.onlyScaleUp&&r>e||e===r&&s.every(C=>{if(C.colDef.suppressSizeToFit)return!0;let v=o?.[C.getId()],w=v?.minWidth??n?.defaultMinWidth,y=v?.maxWidth??n?.defaultMaxWidth,S=C.getActualWidth();return(w==null||S>=w)&&(y==null||S<=y)}))return;let l=[],d=[];for(let m of s){let C=n?.colKeys?.some(v=>Ql(m,v))??!0;m.getColDef().suppressSizeToFit||!C?d.push(m):l.push(m)}let c=l.slice(0),u=!1,h=m=>{Yi(l,m),d.push(m)};for(let m of l){m.resetActualWidth(t);let C=o?.[m.getId()],v=C?.minWidth??n?.defaultMinWidth,w=C?.maxWidth??n?.defaultMaxWidth,y=m.getActualWidth();typeof v=="number"&&y<v?m.setActualWidth(v,t,!0):typeof w=="number"&&y>w&&m.setActualWidth(w,t,!0)}for(;!u;){u=!0;let m=e-oo(d);if(m<=0)for(let C of l){let v=o?.[C.getId()]?.minWidth??n?.defaultMinWidth??C.minWidth;C.setActualWidth(v,t,!0)}else{let C=m/oo(l),v=m;for(let w=l.length-1;w>=0;w--){let y=l[w],S=o?.[y.getId()],x=S?.minWidth??n?.defaultMinWidth,E=S?.maxWidth??n?.defaultMaxWidth,T=y.getMinWidth(),L=y.getMaxWidth(),O=typeof x=="number"&&x>T?x:T,W=typeof E=="number"&&E<L?E:L,G=Math.round(y.getActualWidth()*C);G<O?(G=O,h(y),u=!1):G>W?(G=W,h(y),u=!1):w===0&&(G=v),y.setActualWidth(G,t,!0),v-=G}}}for(let m of c)m.fireColumnWidthChangedEvent(t);let p=this.beans.visibleCols;p.setLeftValues(t),p.updateBodyWidths(),!i&&va(this.eventSvc,c,!0,t)}applyAutosizeStrategy(){let{gos:e,colDelayRenderSvc:t}=this.beans,i=e.get("autoSizeStrategy");i?.type!=="fitGridWidth"&&i?.type!=="fitProvidedWidth"||setTimeout(()=>{if(!this.isAlive())return;let n=i.type;if(n==="fitGridWidth"){let{columnLimits:o,defaultMinWidth:s,defaultMaxWidth:r}=i,a=o?.map(({colId:l,minWidth:d,maxWidth:c})=>({key:l,minWidth:d,maxWidth:c}));this.sizeColumnsToFitGridBody({defaultMinWidth:s,defaultMaxWidth:r,columnLimits:a})}else n==="fitProvidedWidth"&&this.sizeColumnsToFit(i.width,"sizeColumnsToFit");t?.revealColumns(n)})}onFirstDataRendered(i){var n=i,{colIds:e}=n,t=oi(n,["colIds"]);setTimeout(()=>{if(!this.isAlive())return;let o="autosizeColumns";e?this.autoSizeCols(_(b({},t),{source:o,colKeys:e})):this.autoSizeAllColumns(_(b({},t),{source:o})),this.beans.colDelayRenderSvc?.revealColumns(t.type)})}processResizeOperations(){this.shouldQueueResizeOperations=!1;for(let e of this.resizeOperationQueue)e();this.resizeOperationQueue=[]}pushResizeOperation(e){this.resizeOperationQueue.push(e)}destroy(){this.resizeOperationQueue.length=0,super.destroy()}};function RJ(e,t,i={}){let n=i.minWidth??e.getMinWidth();t<n&&(t=n);let o=i.maxWidth??e.getMaxWidth();return t>o&&(t=o),t}function BR({ctrlsSvc:e,scrollVisibleSvc:t}){let i=e.getGridBodyCtrl(),o=i.isVerticalScrollShowing()?t.getScrollbarWidth():0;return rd(i.eGridBody)-o}var PJ={moduleName:"ColumnAutoSize",version:z,beans:[EJ],apiFunctions:{sizeColumnsToFit:SJ,autoSizeColumns:JP,autoSizeAllColumns:xJ},dependsOn:[z4]},MJ=".ag-row-pinned-source{background-color:var(--ag-pinned-source-row-background-color);color:var(--ag-pinned-source-row-text-color);font-weight:var(--ag-pinned-source-row-font-weight)}.ag-row-pinned-manual{background-color:var(--ag-pinned-row-background-color);color:var(--ag-pinned-row-text-color);font-weight:var(--ag-pinned-row-font-weight)}";function kJ(e){return e.pinnedRowModel?.getPinnedTopRowCount()??0}function DJ(e){return e.pinnedRowModel?.getPinnedBottomRowCount()??0}function FJ(e,t){return e.pinnedRowModel?.getPinnedTopRow(t)}function TJ(e,t){return e.pinnedRowModel?.getPinnedBottomRow(t)}function AJ(e,t,i){return e.pinnedRowModel?.forEachPinnedRow(t,i)}var IJ={moduleName:"PinnedRow",version:z,beans:[AG],css:[MJ],apiFunctions:{getPinnedTopRowCount:kJ,getPinnedBottomRowCount:DJ,getPinnedTopRow:FJ,getPinnedBottomRow:TJ,forEachPinnedRow:AJ},icons:{rowPin:"pin",rowPinTop:"pinned-top",rowPinBottom:"pinned-bottom",rowUnpin:"un-pin"}},LJ=class{constructor(e,t){this.col=e,this.firstNode=t,this.cellSpan=!0,this.spannedNodes=new Set,this.addSpannedNode(t)}reset(){this.spannedNodes.clear(),this.addSpannedNode(this.firstNode)}addSpannedNode(e){this.spannedNodes.add(e),this.lastNode=e}getLastNode(){return this.lastNode}getCellHeight(){return this.lastNode.rowTop+this.lastNode.rowHeight-this.firstNode.rowTop-1}doesSpanContain(e){return e.column!==this.col||e.rowPinned!=this.firstNode.rowPinned?!1:this.firstNode.rowIndex<=e.rowIndex&&e.rowIndex<=this.lastNode.rowIndex}getLastNodeAutoHeight(){let e=this.firstNode.__autoHeights?.[this.col.getColId()];if(e==null)return;let t=0;for(let i of this.spannedNodes)i!==this.lastNode&&(t+=i.rowHeight);return e-t}},_J=class extends D{constructor(e){super(),this.column=e}buildCache(e){let{column:t,beans:{gos:i,pinnedRowModel:n,rowModel:o,valueSvc:s,pagination:r}}=this,{colDef:a}=t,l=this.getNodeMap(e),d=new Map,c=i.getCallback("isFullWidthRow"),u=a.equals,h=a.spanRows,p=typeof h=="function",g=null,f=null,m,C=(w,y)=>{g=w,f=null,m=y},v=w=>{let y=!w.isExpandable()&&!w.group&&!w.detail&&(c?!c({rowNode:w}):!0);if(w.rowIndex==null||!y){C(null,null);return}if(g==null||w.level!==g.level||w.footer||f&&w.rowIndex-1!==f?.getLastNode().rowIndex){C(w,s.getValue(t,w));return}let S=s.getValue(t,w);if(p){let x=te(i,{valueA:m,nodeA:g,valueB:S,nodeB:w,column:t,colDef:a});if(!h(x)){C(w,S);return}}else if(u?!u(m,S):m!==S){C(w,S);return}if(!f){let x=l?.get(g);x?.firstNode===g?(x.reset(),f=x):f=new LJ(t,g),d.set(g,f)}f.addSpannedNode(w),d.set(w,f)};switch(e){case"center":o.forEachDisplayedNode?.(w=>{(!r||r.isRowInPage(w.rowIndex))&&v(w)}),this.centerValueNodeMap=d;break;case"top":n?.forEachPinnedRow("top",v),this.topValueNodeMap=d;break;case"bottom":n?.forEachPinnedRow("bottom",v),this.bottomValueNodeMap=d;break}}isCellSpanning(e){return!!this.getCellSpan(e)}getCellSpan(e){return this.getNodeMap(e.rowPinned).get(e)}getNodeMap(e){switch(e){case"top":return this.topValueNodeMap;case"bottom":return this.bottomValueNodeMap;default:return this.centerValueNodeMap}}},OJ=class extends D{constructor(){super(...arguments),this.beanName="rowSpanSvc",this.spanningColumns=new Map,this.debouncePinnedEvent=_t(this,this.dispatchCellsUpdatedEvent.bind(this,!0),0),this.debounceModelEvent=_t(this,this.dispatchCellsUpdatedEvent.bind(this,!1),0),this.pinnedTimeout=null,this.modelTimeout=null}postConstruct(){let e=this.onRowDataUpdated.bind(this),t=this.buildPinnedCaches.bind(this);this.addManagedEventListeners({paginationChanged:this.buildModelCaches.bind(this),pinnedRowDataChanged:t,pinnedRowsChanged:t,rowNodeDataChanged:e,cellValueChanged:e})}register(e){let{gos:t}=this.beans;if(!t.get("enableCellSpan")||this.spanningColumns.has(e))return;let i=this.createManagedBean(new _J(e));this.spanningColumns.set(e,i),i.buildCache("top"),i.buildCache("bottom"),i.buildCache("center"),this.debouncePinnedEvent(),this.debounceModelEvent()}dispatchCellsUpdatedEvent(e){this.dispatchLocalEvent({type:"spannedCellsUpdated",pinned:e})}deregister(e){this.spanningColumns.delete(e)}onRowDataUpdated({node:e}){let{spannedRowRenderer:t}=this.beans;if(e.rowPinned){if(this.pinnedTimeout!=null)return;this.pinnedTimeout=window.setTimeout(()=>{this.pinnedTimeout=null,this.buildPinnedCaches(),t?.createCtrls("top"),t?.createCtrls("bottom")},0);return}this.modelTimeout==null&&(this.modelTimeout=window.setTimeout(()=>{this.modelTimeout=null,this.buildModelCaches(),t?.createCtrls("center")},0))}buildModelCaches(){this.modelTimeout!=null&&clearTimeout(this.modelTimeout),this.spanningColumns.forEach(e=>e.buildCache("center")),this.debounceModelEvent()}buildPinnedCaches(){this.pinnedTimeout!=null&&clearTimeout(this.pinnedTimeout),this.spanningColumns.forEach(e=>{e.buildCache("top"),e.buildCache("bottom")}),this.debouncePinnedEvent()}isCellSpanning(e,t){let i=this.spanningColumns.get(e);return i?i.isCellSpanning(t):!1}getCellSpanByPosition(e){let{pinnedRowModel:t,rowModel:i}=this.beans,n=e.column,o=e.rowIndex,s=this.spanningColumns.get(n);if(!s)return;let r;switch(e.rowPinned){case"top":r=t?.getPinnedTopRow(o);break;case"bottom":r=t?.getPinnedBottomRow(o);break;default:r=i.getRow(o)}if(r)return s.getCellSpan(r)}getCellStart(e){let t=this.getCellSpanByPosition(e);return t?_(b({},e),{rowIndex:t.firstNode.rowIndex}):e}getCellEnd(e){let t=this.getCellSpanByPosition(e);return t?_(b({},e),{rowIndex:t.getLastNode().rowIndex}):e}getCellSpan(e,t){let i=this.spanningColumns.get(e);if(i)return i.getCellSpan(t)}forEachSpannedColumn(e,t){for(let[i,n]of this.spanningColumns)if(n.isCellSpanning(e)){let o=n.getCellSpan(e);t(i,o)}}destroy(){super.destroy(),this.spanningColumns.clear()}},NJ=class extends fa{constructor(e,t,i){super(e.col,e.firstNode,i,t),this.cellSpan=e,this.SPANNED_CELL_CSS_CLASS="ag-spanned-cell"}setComp(e,t,i,n,o,s,r){this.eWrapper=i,super.setComp(e,t,i,n,o,s,r),this.setAriaRowSpan(),this.refreshAriaRowIndex()}isCellSpanning(){return!0}getCellSpan(){return this.cellSpan}refreshAriaRowIndex(){let{eGui:e,rowNode:t}=this;!e||t.rowIndex==null||sp(e,t.rowIndex)}setAriaRowSpan(){m_(this.eGui,this.cellSpan.spannedNodes.size)}setFocusedCellPosition(e){this.focusedCellPosition=e}getFocusedCellPosition(){return this.focusedCellPosition??this.cellPosition}checkCellFocused(){let e=this.beans.focusSvc.getFocusedCell();return!!e&&this.cellSpan.doesSpanContain(e)}applyStaticCssClasses(){super.applyStaticCssClasses(),this.comp.toggleCss(this.SPANNED_CELL_CSS_CLASS,!0)}onCellFocused(e){let{beans:t}=this;if(Ip(t)){this.focusedCellPosition=void 0;return}let i=this.isCellFocused();i||(this.focusedCellPosition=void 0),e&&i&&(this.focusedCellPosition={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column}),super.onCellFocused(e)}getRootElement(){return this.eWrapper}},BJ=class extends Rp{onRowIndexChanged(){super.onRowIndexChanged();for(let e of this.getAllCellCtrls())e.refreshAriaRowIndex()}getInitialRowClasses(e){return["ag-spanned-row"]}getNewCellCtrl(e){let t=this.beans.rowSpanSvc?.getCellSpan(e,this.rowNode);if(!(!t||t.firstNode!==this.rowNode))return new NJ(t,this,this.beans)}isCorrectCtrlForSpan(e){let t=this.beans.rowSpanSvc?.getCellSpan(e.column,this.rowNode);return!t||t.firstNode!==this.rowNode?!1:e.getCellSpan()===t}onRowHeightChanged(){}refreshFirstAndLastRowStyles(){}addHoverFunctionality(){}resetHoveredStatus(){}},HJ=class extends D{constructor(){super(...arguments),this.beanName="spannedRowRenderer",this.topCtrls=new Map,this.bottomCtrls=new Map,this.centerCtrls=new Map}postConstruct(){this.addManagedEventListeners({displayedRowsChanged:this.createAllCtrls.bind(this)})}createAllCtrls(){this.createCtrls("top"),this.createCtrls("bottom"),this.createCtrls("center")}createCtrls(e){let{rowSpanSvc:t}=this.beans,i=this.getCtrlsMap(e),n=i.size,o=this.getAllRelevantRowControls(e),s=new Map,r=!1;for(let l of o)l.isAlive()&&t?.forEachSpannedColumn(l.rowNode,(d,c)=>{if(s.has(c.firstNode))return;let u=i.get(c.firstNode);if(u){s.set(c.firstNode,u),i.delete(c.firstNode);return}r=!0;let h=new BJ(c.firstNode,this.beans,!1,!1,!1);s.set(c.firstNode,h)});this.setCtrlsMap(e,s);let a=s.size===n;if(!(!r&&a)){for(let l of i.values())l.destroyFirstPass(!0),l.destroySecondPass();this.dispatchLocalEvent({type:"spannedRowsUpdated",ctrlsKey:e})}}getAllRelevantRowControls(e){let{rowRenderer:t}=this.beans;switch(e){case"top":return t.topRowCtrls;case"bottom":return t.bottomRowCtrls;case"center":return t.allRowCtrls}}getCellByPosition(e){let{rowSpanSvc:t}=this.beans,i=t?.getCellSpanByPosition(e);if(!i)return;let n=this.getCtrlsMap(e.rowPinned).get(i.firstNode);if(n)return n.getAllCellCtrls().find(o=>o.column===e.column)}getCtrls(e){return[...this.getCtrlsMap(e).values()]}destroyRowCtrls(e){for(let t of this.getCtrlsMap(e).values())t.destroyFirstPass(!0),t.destroySecondPass();this.setCtrlsMap(e,new Map)}getCtrlsMap(e){switch(e){case"top":return this.topCtrls;case"bottom":return this.bottomCtrls;default:return this.centerCtrls}}setCtrlsMap(e,t){switch(e){case"top":this.topCtrls=t;break;case"bottom":this.bottomCtrls=t;break;default:this.centerCtrls=t;break}}destroy(){super.destroy(),this.destroyRowCtrls("top"),this.destroyRowCtrls("bottom"),this.destroyRowCtrls("center")}},GJ={moduleName:"CellSpan",version:z,beans:[OJ,HJ]},VJ=class extends D{constructor(e,t){super(),this.cellCtrl=e,this.staticClasses=[],this.beans=t,this.column=e.column}setComp(e){this.cellComp=e,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}applyCellClassRules(){let{column:e,cellComp:t}=this,i=e.colDef,n=i.cellClassRules,o=this.getCellClassParams(e,i);Hv(this.beans.expressionSvc,n===this.cellClassRules?void 0:this.cellClassRules,n,o,s=>t.toggleCss(s,!0),s=>t.toggleCss(s,!1)),this.cellClassRules=n}applyUserStyles(){let e=this.column,t=e.colDef,i=t.cellStyle;if(!i)return;let n;if(typeof i=="function"){let o=this.getCellClassParams(e,t);n=i(o)}else n=i;n&&this.cellComp.setUserStyles(n)}applyClassesFromColDef(){let{column:e,cellComp:t}=this,i=e.colDef,n=this.getCellClassParams(e,i);for(let s of this.staticClasses)t.toggleCss(s,!1);let o=this.beans.cellStyles.getStaticCellClasses(i,n);this.staticClasses=o;for(let s of o)t.toggleCss(s,!0)}getCellClassParams(e,t){let{value:i,rowNode:n}=this.cellCtrl;return te(this.beans.gos,{value:i,data:n.data,node:n,colDef:t,column:e,rowIndex:n.rowIndex})}},zJ=class extends D{constructor(){super(...arguments),this.beanName="cellStyles"}processAllCellClasses(e,t,i,n){Hv(this.beans.expressionSvc,void 0,e.cellClassRules,t,i,n),this.processStaticCellClasses(e,t,i)}getStaticCellClasses(e,t){let{cellClass:i}=e;if(!i)return[];let n;return typeof i=="function"?n=i(t):n=i,typeof n=="string"&&(n=[n]),n||[]}createCellCustomStyleFeature(e,t){return new VJ(e,t)}processStaticCellClasses(e,t,i){this.getStaticCellClasses(e,t).forEach(o=>{i(o)})}},WJ={moduleName:"CellStyle",version:z,beans:[zJ]},UJ={moduleName:"RowStyle",version:z,beans:[Fq]};function qJ(e,t){return!!e.colHover?.isHovered(t)}var $J=class extends D{constructor(e,t){super(),this.columns=e,this.element=t,this.destroyManagedListeners=[],this.enableFeature=i=>{let{beans:n,gos:o,element:s,columns:r}=this,a=n.colHover;if(i??!!o.get("columnHoverHighlight"))this.destroyManagedListeners=this.addManagedElementListeners(s,{mouseover:a.setMouseOver.bind(a,r),mouseout:a.clearMouseOver.bind(a)});else{for(let d of this.destroyManagedListeners)d();this.destroyManagedListeners=[]}}}postConstruct(){this.addManagedPropertyListener("columnHoverHighlight",({currentValue:e})=>{this.enableFeature(e)}),this.enableFeature()}destroy(){super.destroy(),this.destroyManagedListeners=null}},jJ="ag-column-hover",KJ=class extends D{constructor(){super(...arguments),this.beanName="colHover"}postConstruct(){this.addManagedPropertyListener("columnHoverHighlight",({currentValue:e})=>{e||this.clearMouseOver()})}setMouseOver(e){this.updateState(e)}clearMouseOver(){this.updateState(null)}isHovered(e){if(!this.gos.get("columnHoverHighlight"))return!1;let t=this.selectedColumns;return!!t&&t.indexOf(e)>=0}addHeaderColumnHoverListener(e,t,i){let n=()=>{let o=this.isHovered(i);t.toggleCss("ag-column-hover",o)};e.addManagedEventListeners({columnHoverChanged:n}),n()}onCellColumnHover(e,t){if(!t)return;let i=this.isHovered(e);t.toggleCss(jJ,i)}addHeaderFilterColumnHoverListener(e,t,i,n){this.createHoverFeature(e,[i],n);let o=()=>{let s=this.isHovered(i);t.toggleCss("ag-column-hover",s)};e.addManagedEventListeners({columnHoverChanged:o}),o()}createHoverFeature(e,t,i){e.createManagedBean(new $J(t,i))}updateState(e){this.selectedColumns=e,this.eventSvc.dispatchEvent({type:"columnHoverChanged"})}},YJ={moduleName:"ColumnHover",version:z,beans:[KJ],apiFunctions:{isColumnHovered:qJ}},XJ=class extends D{constructor(){super(...arguments),this.beanName="apiEventSvc",this.syncListeners=new Map,this.asyncListeners=new Map,this.syncGlobalListeners=new Set,this.globalListenerPairs=new Map}postConstruct(){this.wrapSvc=this.beans.frameworkOverrides.createGlobalEventListenerWrapper?.()}addListener(e,t){let i=this.wrapSvc?.wrap(e,t)??t,n=!np.has(e),o=n?this.asyncListeners:this.syncListeners;o.has(e)||o.set(e,new Set),o.get(e).add(i),this.eventSvc.addListener(e,i,n)}removeListener(e,t){let i=this.wrapSvc?.unwrap(e,t)??t,o=!!this.asyncListeners.get(e)?.delete(i);o||this.syncListeners.get(e)?.delete(i),this.eventSvc.removeListener(e,i,o)}addGlobalListener(e){let t=this.wrapSvc?.wrapGlobal(e)??e,i=(s,r)=>{np.has(s)&&t(s,r)},n=(s,r)=>{np.has(s)||t(s,r)};this.globalListenerPairs.set(e,{syncListener:i,asyncListener:n});let o=this.eventSvc;o.addGlobalListener(i,!1),o.addGlobalListener(n,!0)}removeGlobalListener(e){let{eventSvc:t,wrapSvc:i,globalListenerPairs:n}=this,o=i?.unwrapGlobal(e)??e;if(n.has(o)){let{syncListener:r,asyncListener:a}=n.get(o);t.removeGlobalListener(r,!1),t.removeGlobalListener(a,!0),n.delete(e)}else this.syncGlobalListeners.delete(o),t.removeGlobalListener(o,!1)}destroyEventListeners(e,t){e.forEach((i,n)=>{i.forEach(o=>this.eventSvc.removeListener(n,o,t)),i.clear()}),e.clear()}destroyGlobalListeners(e,t){for(let i of e)this.eventSvc.removeGlobalListener(i,t);e.clear()}destroy(){super.destroy(),this.destroyEventListeners(this.syncListeners,!1),this.destroyEventListeners(this.asyncListeners,!0),this.destroyGlobalListeners(this.syncGlobalListeners,!1);let{globalListenerPairs:e,eventSvc:t}=this;e.forEach(({syncListener:i,asyncListener:n})=>{t.removeGlobalListener(i,!1),t.removeGlobalListener(n,!0)}),e.clear()}};function JJ(e,t,i){e.apiEventSvc?.addListener(t,i)}function QJ(e,t,i){e.apiEventSvc?.removeListener(t,i)}function ZJ(e,t){e.apiEventSvc?.addGlobalListener(t)}function eQ(e,t){e.apiEventSvc?.removeGlobalListener(t)}var tQ={moduleName:"EventApi",version:z,apiFunctions:{addEventListener:JJ,addGlobalListener:ZJ,removeEventListener:QJ,removeGlobalListener:eQ},beans:[XJ]},iQ={moduleName:"Locale",version:z,beans:[F$]},nQ=class extends D{constructor(){super(...arguments),this.beanName="rowAutoHeight",this.wasEverActive=!1,this._debouncedCalculateRowHeights=_t(this,this.calculateRowHeights.bind(this),1)}requestCheckAutoHeight(){this.wasEverActive&&this._debouncedCalculateRowHeights()}calculateRowHeights(){let{visibleCols:e,rowModel:t,rowSpanSvc:i,pinnedRowModel:n}=this.beans,o=e.autoHeightCols,s=!1,r=a=>{let l=a.__autoHeights,d=Yo(this.beans,a).height;for(let c of o){let u=l?.[c.getColId()],h=i?.getCellSpan(c,a);if(h){if(h.getLastNode()!==a)continue;if(u=i?.getCellSpan(c,a)?.getLastNodeAutoHeight(),!u)return}if(u==null){if(this.colSpanSkipCell(c,a))continue;return}d=Math.max(u,d)}d!==a.rowHeight&&(a.setRowHeight(d),s=!0)};n?.forEachPinnedRow?.("top",r),n?.forEachPinnedRow?.("bottom",r),t.forEachDisplayedNode?.(r),s&&t.onRowHeightChanged?.()}setRowAutoHeight(e,t,i){if(e.__autoHeights??(e.__autoHeights={}),t==null){delete e.__autoHeights[i.getId()];return}let n=e.__autoHeights[i.getId()];e.__autoHeights[i.getId()]=t,n!==t&&this.requestCheckAutoHeight()}colSpanSkipCell(e,t){let{colModel:i,colViewport:n,visibleCols:o}=this.beans;if(!i.colSpanActive)return!1;let s=[];switch(e.getPinned()){case"left":s=o.getLeftColsForRow(t);break;case"right":s=o.getRightColsForRow(t);break;case null:s=n.getColsWithinViewport(t);break}return!s.includes(e)}setupCellAutoHeight(e,t,i){if(!e.column.isAutoHeight()||!t)return!1;this.wasEverActive=!0;let n=t.parentElement,{rowNode:o,column:s}=e,r=this.beans,a=c=>{if(this.beans.editSvc?.isEditing(e)||!e.isAlive()||!i.isAlive())return;let{paddingTop:u,paddingBottom:h,borderBottomWidth:p,borderTopWidth:g}=Xs(n),f=u+h+p+g,C=t.offsetHeight+f;if(c<5){let w=!kt(r)?.contains(t),y=C==0;if(w||y){window.setTimeout(()=>a(c+1),0);return}}this.setRowAutoHeight(o,C,s)},l=()=>a(0);l();let d=Qo(r,t,l);return i.addDestroyFunc(()=>{d(),this.setRowAutoHeight(o,void 0,s)}),!0}setAutoHeightActive(e){this.active=e.list.some(t=>t.isVisible()&&t.isAutoHeight())}areRowsMeasured(){if(!this.active)return!0;let e=this.beans.rowRenderer.getAllRowCtrls(),t=null;for(let{rowNode:i}of e)if((!t||this.beans.colModel.colSpanActive)&&(t=this.beans.colViewport.getColsWithinViewport(i).filter(o=>o.isAutoHeight())),t.length!==0){if(!i.__autoHeights)return!1;for(let n of t){let o=i.__autoHeights[n.getColId()];if(!o||i.rowHeight<o)return!1}}return!0}},oQ={moduleName:"RowAutoHeight",version:z,beans:[nQ]},QP={moduleName:"AllCommunity",version:z,dependsOn:[nX,uX,yX,K$,oY,sY,rY,aY,lY,dY,cY,nY,Xj,Jj,Qj,Yj,eK,tK,NX,_Y,iJ,W4,hJ,pJ,yJ,PJ,qV,IJ,RY,h$,WJ,YJ,UJ,tQ,f$,TX,_P,iQ,oQ,UV,oX,GJ]};var sQ=(()=>{let t=class t{constructor(){this.vcr=ie(ir)}};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=Ee({type:t,selectors:[["ag-component-container"]],standalone:!1,decls:0,vars:0,template:function(o,s){},encapsulation:2});let e=t;return e})(),tM=16,jv=0;function rQ(e){let t=new Map;for(let i=0;i<tM;i++){let n=e.createComponent(sQ);t.set(i,n),hi(n.location.nativeElement)}return t}var aQ=new Set(["doesFilterPass","isFilterActive"]),ZP=(()=>{let t=class t extends wP{setViewContainerRef(n,o){this.viewContainerRef=n,this.angularFrameworkOverrides=o}createWrapper(n){let o=this.angularFrameworkOverrides,s=this;s.compShards??=rQ(this.viewContainerRef);class r extends Kv{init(d){o.runInsideAngular(()=>{super.init(d),this._componentRef.changeDetectorRef.detectChanges()})}createComponent(){return s.createComponent(n)}hasMethod(d){return a.getFrameworkComponentInstance()[d]!=null}callMethod(d,c){let u=this.getFrameworkComponentInstance(),h=u[d];return aQ.has(d)?h.apply(u,c):o.runInsideAngular(()=>h.apply(u,c))}addMethod(d,c){a[d]=c}}let a=new r;return a}createComponent(n){return jv=(jv+1)%tM,this.compShards.get(jv).instance.vcr.createComponent(n)}};t.\u0275fac=(()=>{let n;return function(s){return(n||(n=fo(t)))(s||t)}})(),t.\u0275prov=Ra({token:t,factory:t.\u0275fac});let e=t;return e})(),Kv=class{init(t){this._params=t,this._componentRef=this.createComponent(),this._agAwareComponent=this._componentRef.instance,this._frameworkComponentInstance=this._componentRef.instance,this._eGui=this._componentRef.location.nativeElement,hi(this._eGui),this._agAwareComponent.agInit(this._params)}getGui(){return this._eGui}getRootElement(){return this._eGui.firstChild}destroy(){this._frameworkComponentInstance&&typeof this._frameworkComponentInstance.destroy=="function"&&this._frameworkComponentInstance.destroy(),this._componentRef?.destroy()}getFrameworkComponentInstance(){return this._frameworkComponentInstance}},Hp=class{constructor(t){this.frameworkOverrides=t,this.wrappedListeners=new Map,this.wrappedGlobalListeners=new Map}wrap(t,i){let{frameworkOverrides:n,wrappedListeners:o}=this,s=i;if(n.shouldWrapOutgoing){s=a=>{n.wrapOutgoing(()=>i(a))};let r=o.get(t);r||(r=new Map,o.set(t,r)),r.set(i,s)}return s}wrapGlobal(t){let{frameworkOverrides:i,wrappedGlobalListeners:n}=this,o=t;return i.shouldWrapOutgoing&&(o=(s,r)=>{i.wrapOutgoing(()=>t(s,r))},n.set(t,o)),o}unwrap(t,i){let{wrappedListeners:n}=this,o=n.get(t);if(o){let s=o.get(i);if(s)return o.delete(i),o.size===0&&n.delete(t),s}return i}unwrapGlobal(t){let{wrappedGlobalListeners:i}=this,n=i.get(t);return n?(i.delete(t),n):t}},eM=(()=>{let t=class t extends Av{constructor(n){super("angular"),this._ngZone=n,this.batchFrameworkComps=!0,this.isRunningWithinTestZone=!1,this.wrapIncoming=(o,s)=>this.runOutside(o,s),this.wrapOutgoing=o=>this.runInsideAngular(o),this.isRunningWithinTestZone=window?.AG_GRID_UNDER_TEST??!!window?.Zone?.AsyncTestZoneSpec,this._ngZone?this.isRunningWithinTestZone?this.runOutside=(o,s)=>s==="resize-observer"||s==="popupPositioning"?this._ngZone.runOutsideAngular(o):o():this.runOutside=o=>this._ngZone.runOutsideAngular(o):this.runOutside=o=>o()}get shouldWrapOutgoing(){return this._ngZone&&as.isInAngularZone()}createLocalEventListenerWrapper(n,o){if(this.shouldWrapOutgoing)return n??(o.setFrameworkOverrides(this),new Hp(this))}createGlobalEventListenerWrapper(){return new Hp(this)}isFrameworkComponent(n){if(!n)return!1;let o=n.prototype;return o&&"agInit"in o}runInsideAngular(n){return!this._ngZone||as.isInAngularZone()?n():this._ngZone.run(n)}runOutsideAngular(n,o){return this.runOutside(n,o)}};t.\u0275fac=function(o){return new(o||t)(Jv(as))},t.\u0275prov=Ra({token:t,factory:t.\u0275fac});let e=t;return e})(),Gp=(()=>{let t=class t{constructor(n,o,s,r){this._viewContainerRef=o,this._angularFrameworkOverrides=s,this._frameworkCompWrapper=r,this._initialised=!1,this._destroyed=!1,this._holdEvents=!0,this._fullyReady=new Promise(a=>{this._resolveFullyReady=a}),this.statusBar=void 0,this.sideBar=void 0,this.suppressContextMenu=void 0,this.preventDefaultOnContextMenu=void 0,this.allowContextMenuWithControlKey=void 0,this.columnMenu=void 0,this.suppressMenuHide=void 0,this.enableBrowserTooltips=void 0,this.tooltipTrigger=void 0,this.tooltipShowDelay=void 0,this.tooltipHideDelay=void 0,this.tooltipMouseTrack=void 0,this.tooltipShowMode=void 0,this.tooltipInteraction=void 0,this.popupParent=void 0,this.copyHeadersToClipboard=void 0,this.copyGroupHeadersToClipboard=void 0,this.clipboardDelimiter=void 0,this.suppressCopyRowsToClipboard=void 0,this.suppressCopySingleCellRanges=void 0,this.suppressLastEmptyLineOnPaste=void 0,this.suppressClipboardPaste=void 0,this.suppressClipboardApi=void 0,this.suppressCutToClipboard=void 0,this.columnDefs=void 0,this.defaultColDef=void 0,this.defaultColGroupDef=void 0,this.columnTypes=void 0,this.dataTypeDefinitions=void 0,this.maintainColumnOrder=void 0,this.enableStrictPivotColumnOrder=void 0,this.suppressFieldDotNotation=void 0,this.headerHeight=void 0,this.groupHeaderHeight=void 0,this.floatingFiltersHeight=void 0,this.pivotHeaderHeight=void 0,this.pivotGroupHeaderHeight=void 0,this.hidePaddedHeaderRows=void 0,this.allowDragFromColumnsToolPanel=void 0,this.suppressMovableColumns=void 0,this.suppressColumnMoveAnimation=void 0,this.suppressMoveWhenColumnDragging=void 0,this.suppressDragLeaveHidesColumns=void 0,this.suppressGroupChangesColumnVisibility=void 0,this.suppressMakeColumnVisibleAfterUnGroup=void 0,this.suppressRowGroupHidesColumns=void 0,this.colResizeDefault=void 0,this.suppressAutoSize=void 0,this.autoSizePadding=void 0,this.skipHeaderOnAutoSize=void 0,this.autoSizeStrategy=void 0,this.components=void 0,this.editType=void 0,this.suppressStartEditOnTab=void 0,this.getFullRowEditValidationErrors=void 0,this.invalidEditValueMode=void 0,this.singleClickEdit=void 0,this.suppressClickEdit=void 0,this.readOnlyEdit=void 0,this.stopEditingWhenCellsLoseFocus=void 0,this.enterNavigatesVertically=void 0,this.enterNavigatesVerticallyAfterEdit=void 0,this.enableCellEditingOnBackspace=void 0,this.undoRedoCellEditing=void 0,this.undoRedoCellEditingLimit=void 0,this.defaultCsvExportParams=void 0,this.suppressCsvExport=void 0,this.defaultExcelExportParams=void 0,this.suppressExcelExport=void 0,this.excelStyles=void 0,this.findSearchValue=void 0,this.findOptions=void 0,this.quickFilterText=void 0,this.cacheQuickFilter=void 0,this.includeHiddenColumnsInQuickFilter=void 0,this.quickFilterParser=void 0,this.quickFilterMatcher=void 0,this.applyQuickFilterBeforePivotOrAgg=void 0,this.excludeChildrenWhenTreeDataFiltering=void 0,this.enableAdvancedFilter=void 0,this.alwaysPassFilter=void 0,this.includeHiddenColumnsInAdvancedFilter=void 0,this.advancedFilterParent=void 0,this.advancedFilterBuilderParams=void 0,this.advancedFilterParams=void 0,this.suppressAdvancedFilterEval=void 0,this.suppressSetFilterByDefault=void 0,this.enableFilterHandlers=void 0,this.filterHandlers=void 0,this.enableCharts=void 0,this.chartThemes=void 0,this.customChartThemes=void 0,this.chartThemeOverrides=void 0,this.chartToolPanelsDef=void 0,this.chartMenuItems=void 0,this.loadingCellRenderer=void 0,this.loadingCellRendererParams=void 0,this.loadingCellRendererSelector=void 0,this.localeText=void 0,this.masterDetail=void 0,this.keepDetailRows=void 0,this.keepDetailRowsCount=void 0,this.detailCellRenderer=void 0,this.detailCellRendererParams=void 0,this.detailRowHeight=void 0,this.detailRowAutoHeight=void 0,this.context=void 0,this.alignedGrids=void 0,this.tabIndex=void 0,this.rowBuffer=void 0,this.valueCache=void 0,this.valueCacheNeverExpires=void 0,this.enableCellExpressions=void 0,this.suppressTouch=void 0,this.suppressFocusAfterRefresh=void 0,this.suppressBrowserResizeObserver=void 0,this.suppressPropertyNamesCheck=void 0,this.suppressChangeDetection=void 0,this.debug=void 0,this.loading=void 0,this.overlayLoadingTemplate=void 0,this.loadingOverlayComponent=void 0,this.loadingOverlayComponentParams=void 0,this.suppressLoadingOverlay=void 0,this.overlayNoRowsTemplate=void 0,this.noRowsOverlayComponent=void 0,this.noRowsOverlayComponentParams=void 0,this.suppressNoRowsOverlay=void 0,this.pagination=void 0,this.paginationPageSize=void 0,this.paginationPageSizeSelector=void 0,this.paginationAutoPageSize=void 0,this.paginateChildRows=void 0,this.suppressPaginationPanel=void 0,this.pivotMode=void 0,this.pivotPanelShow=void 0,this.pivotMaxGeneratedColumns=void 0,this.pivotDefaultExpanded=void 0,this.pivotColumnGroupTotals=void 0,this.pivotRowTotals=void 0,this.pivotSuppressAutoColumn=void 0,this.suppressExpandablePivotGroups=void 0,this.functionsReadOnly=void 0,this.aggFuncs=void 0,this.suppressAggFuncInHeader=void 0,this.alwaysAggregateAtRootLevel=void 0,this.aggregateOnlyChangedColumns=void 0,this.suppressAggFilteredOnly=void 0,this.removePivotHeaderRowWhenSingleValueColumn=void 0,this.animateRows=void 0,this.cellFlashDuration=void 0,this.cellFadeDuration=void 0,this.allowShowChangeAfterFilter=void 0,this.domLayout=void 0,this.ensureDomOrder=void 0,this.enableCellSpan=void 0,this.enableRtl=void 0,this.suppressColumnVirtualisation=void 0,this.suppressMaxRenderedRowRestriction=void 0,this.suppressRowVirtualisation=void 0,this.rowDragManaged=void 0,this.rowDragInsertDelay=void 0,this.suppressRowDrag=void 0,this.suppressMoveWhenRowDragging=void 0,this.rowDragEntireRow=void 0,this.rowDragMultiRow=void 0,this.rowDragText=void 0,this.dragAndDropImageComponent=void 0,this.dragAndDropImageComponentParams=void 0,this.fullWidthCellRenderer=void 0,this.fullWidthCellRendererParams=void 0,this.embedFullWidthRows=void 0,this.groupDisplayType=void 0,this.groupDefaultExpanded=void 0,this.autoGroupColumnDef=void 0,this.groupMaintainOrder=void 0,this.groupSelectsChildren=void 0,this.groupLockGroupColumns=void 0,this.groupAggFiltering=void 0,this.groupTotalRow=void 0,this.grandTotalRow=void 0,this.suppressStickyTotalRow=void 0,this.groupSuppressBlankHeader=void 0,this.groupSelectsFiltered=void 0,this.showOpenedGroup=void 0,this.groupHideParentOfSingleChild=void 0,this.groupRemoveSingleChildren=void 0,this.groupRemoveLowestSingleChildren=void 0,this.groupHideOpenParents=void 0,this.groupAllowUnbalanced=void 0,this.rowGroupPanelShow=void 0,this.groupRowRenderer=void 0,this.groupRowRendererParams=void 0,this.treeData=void 0,this.treeDataChildrenField=void 0,this.treeDataParentIdField=void 0,this.rowGroupPanelSuppressSort=void 0,this.suppressGroupRowsSticky=void 0,this.groupHierarchyConfig=void 0,this.pinnedTopRowData=void 0,this.pinnedBottomRowData=void 0,this.enableRowPinning=void 0,this.isRowPinnable=void 0,this.isRowPinned=void 0,this.rowModelType=void 0,this.rowData=void 0,this.asyncTransactionWaitMillis=void 0,this.suppressModelUpdateAfterUpdateTransaction=void 0,this.datasource=void 0,this.cacheOverflowSize=void 0,this.infiniteInitialRowCount=void 0,this.serverSideInitialRowCount=void 0,this.suppressServerSideFullWidthLoadingRow=void 0,this.cacheBlockSize=void 0,this.maxBlocksInCache=void 0,this.maxConcurrentDatasourceRequests=void 0,this.blockLoadDebounceMillis=void 0,this.purgeClosedRowNodes=void 0,this.serverSideDatasource=void 0,this.serverSideSortAllLevels=void 0,this.serverSideEnableClientSideSort=void 0,this.serverSideOnlyRefreshFilteredGroups=void 0,this.serverSidePivotResultFieldSeparator=void 0,this.viewportDatasource=void 0,this.viewportRowModelPageSize=void 0,this.viewportRowModelBufferSize=void 0,this.alwaysShowHorizontalScroll=void 0,this.alwaysShowVerticalScroll=void 0,this.debounceVerticalScrollbar=void 0,this.suppressHorizontalScroll=void 0,this.suppressScrollOnNewData=void 0,this.suppressScrollWhenPopupsAreOpen=void 0,this.suppressAnimationFrame=void 0,this.suppressMiddleClickScrolls=void 0,this.suppressPreventDefaultOnMouseWheel=void 0,this.scrollbarWidth=void 0,this.rowSelection=void 0,this.cellSelection=void 0,this.rowMultiSelectWithClick=void 0,this.suppressRowDeselection=void 0,this.suppressRowClickSelection=void 0,this.suppressCellFocus=void 0,this.suppressHeaderFocus=void 0,this.selectionColumnDef=void 0,this.rowNumbers=void 0,this.suppressMultiRangeSelection=void 0,this.enableCellTextSelection=void 0,this.enableRangeSelection=void 0,this.enableRangeHandle=void 0,this.enableFillHandle=void 0,this.fillHandleDirection=void 0,this.suppressClearOnFillReduction=void 0,this.sortingOrder=void 0,this.accentedSort=void 0,this.unSortIcon=void 0,this.suppressMultiSort=void 0,this.alwaysMultiSort=void 0,this.multiSortKey=void 0,this.suppressMaintainUnsortedOrder=void 0,this.icons=void 0,this.rowHeight=void 0,this.rowStyle=void 0,this.rowClass=void 0,this.rowClassRules=void 0,this.suppressRowHoverHighlight=void 0,this.suppressRowTransform=void 0,this.columnHoverHighlight=void 0,this.gridId=void 0,this.deltaSort=void 0,this.treeDataDisplayType=void 0,this.enableGroupEdit=void 0,this.initialState=void 0,this.theme=void 0,this.loadThemeGoogleFonts=void 0,this.themeCssLayer=void 0,this.styleNonce=void 0,this.themeStyleContainer=void 0,this.getContextMenuItems=void 0,this.getMainMenuItems=void 0,this.postProcessPopup=void 0,this.processUnpinnedColumns=void 0,this.processCellForClipboard=void 0,this.processHeaderForClipboard=void 0,this.processGroupHeaderForClipboard=void 0,this.processCellFromClipboard=void 0,this.sendToClipboard=void 0,this.processDataFromClipboard=void 0,this.isExternalFilterPresent=void 0,this.doesExternalFilterPass=void 0,this.getChartToolbarItems=void 0,this.createChartContainer=void 0,this.focusGridInnerElement=void 0,this.navigateToNextHeader=void 0,this.tabToNextHeader=void 0,this.navigateToNextCell=void 0,this.tabToNextCell=void 0,this.getLocaleText=void 0,this.getDocument=void 0,this.paginationNumberFormatter=void 0,this.getGroupRowAgg=void 0,this.isGroupOpenByDefault=void 0,this.ssrmExpandAllAffectsAllRows=void 0,this.initialGroupOrderComparator=void 0,this.processPivotResultColDef=void 0,this.processPivotResultColGroupDef=void 0,this.getDataPath=void 0,this.getChildCount=void 0,this.getServerSideGroupLevelParams=void 0,this.isServerSideGroupOpenByDefault=void 0,this.isApplyServerSideTransaction=void 0,this.isServerSideGroup=void 0,this.getServerSideGroupKey=void 0,this.getBusinessKeyForNode=void 0,this.getRowId=void 0,this.resetRowDataOnUpdate=void 0,this.processRowPostCreate=void 0,this.isRowSelectable=void 0,this.isRowMaster=void 0,this.fillOperation=void 0,this.postSortRows=void 0,this.getRowStyle=void 0,this.getRowClass=void 0,this.getRowHeight=void 0,this.isFullWidthRow=void 0,this.isRowValidDropPosition=void 0,this.toolPanelVisibleChanged=new A,this.toolPanelSizeChanged=new A,this.columnMenuVisibleChanged=new A,this.contextMenuVisibleChanged=new A,this.cutStart=new A,this.cutEnd=new A,this.pasteStart=new A,this.pasteEnd=new A,this.columnVisible=new A,this.columnPinned=new A,this.columnResized=new A,this.columnMoved=new A,this.columnValueChanged=new A,this.columnPivotModeChanged=new A,this.columnPivotChanged=new A,this.columnGroupOpened=new A,this.newColumnsLoaded=new A,this.gridColumnsChanged=new A,this.displayedColumnsChanged=new A,this.virtualColumnsChanged=new A,this.columnEverythingChanged=new A,this.columnsReset=new A,this.columnHeaderMouseOver=new A,this.columnHeaderMouseLeave=new A,this.columnHeaderClicked=new A,this.columnHeaderContextMenu=new A,this.componentStateChanged=new A,this.cellValueChanged=new A,this.cellEditRequest=new A,this.rowValueChanged=new A,this.cellEditingStarted=new A,this.cellEditingStopped=new A,this.rowEditingStarted=new A,this.rowEditingStopped=new A,this.bulkEditingStarted=new A,this.bulkEditingStopped=new A,this.batchEditingStarted=new A,this.batchEditingStopped=new A,this.undoStarted=new A,this.undoEnded=new A,this.redoStarted=new A,this.redoEnded=new A,this.cellSelectionDeleteStart=new A,this.cellSelectionDeleteEnd=new A,this.rangeDeleteStart=new A,this.rangeDeleteEnd=new A,this.fillStart=new A,this.fillEnd=new A,this.filterOpened=new A,this.filterChanged=new A,this.filterModified=new A,this.filterUiChanged=new A,this.floatingFilterUiChanged=new A,this.advancedFilterBuilderVisibleChanged=new A,this.findChanged=new A,this.chartCreated=new A,this.chartRangeSelectionChanged=new A,this.chartOptionsChanged=new A,this.chartDestroyed=new A,this.cellKeyDown=new A,this.gridReady=new A,this.firstDataRendered=new A,this.gridSizeChanged=new A,this.modelUpdated=new A,this.virtualRowRemoved=new A,this.viewportChanged=new A,this.bodyScroll=new A,this.bodyScrollEnd=new A,this.dragStarted=new A,this.dragStopped=new A,this.dragCancelled=new A,this.stateUpdated=new A,this.paginationChanged=new A,this.rowDragEnter=new A,this.rowDragMove=new A,this.rowDragLeave=new A,this.rowDragEnd=new A,this.rowDragCancel=new A,this.rowResizeStarted=new A,this.rowResizeEnded=new A,this.columnRowGroupChanged=new A,this.rowGroupOpened=new A,this.expandOrCollapseAll=new A,this.pivotMaxColumnsExceeded=new A,this.pinnedRowDataChanged=new A,this.pinnedRowsChanged=new A,this.rowDataUpdated=new A,this.asyncTransactionsFlushed=new A,this.storeRefreshed=new A,this.headerFocused=new A,this.cellClicked=new A,this.cellDoubleClicked=new A,this.cellFocused=new A,this.cellMouseOver=new A,this.cellMouseOut=new A,this.cellMouseDown=new A,this.rowClicked=new A,this.rowDoubleClicked=new A,this.rowSelected=new A,this.selectionChanged=new A,this.cellContextMenu=new A,this.rangeSelectionChanged=new A,this.cellSelectionChanged=new A,this.tooltipShow=new A,this.tooltipHide=new A,this.sortChanged=new A,this._nativeElement=n.nativeElement,this._fullyReady.then(()=>{this._holdEvents=!1})}ngAfterViewInit(){this._angularFrameworkOverrides.runOutsideAngular(()=>{this._frameworkCompWrapper.setViewContainerRef(this._viewContainerRef,this._angularFrameworkOverrides);let n=Object.keys(this).filter(l=>!(l.startsWith("_")||l=="gridOptions"||l=="modules"||this[l]instanceof A)),o={};for(let l of n){let d=dQ(l,this[l]);o[l]=d}let s=E6(this.gridOptions,o,n),r={globalListener:this.globalListener.bind(this),frameworkOverrides:this._angularFrameworkOverrides,providedBeanInstances:{frameworkCompWrapper:this._frameworkCompWrapper},modules:this.modules||[],setThemeOnGridDiv:!0},a=vP(this._nativeElement,s,r);a&&(this.api=a),this._initialised=!0,this._resolveFullyReady()})}ngOnChanges(n){this._initialised&&this._angularFrameworkOverrides.runOutsideAngular(()=>{let o={};for(let s of Object.keys(n)){let r=n[s];o[s]=r.currentValue}R6(o,this.api)})}ngOnDestroy(){this._initialised&&(this._destroyed=!0,this.api?.destroy())}isEmitterUsed(n){let s=this[n],r=s?.observed??s?.observers?.length>0,a=`on${n.charAt(0).toUpperCase()}${n.substring(1)}`,l=!!this.gridOptions&&!!this.gridOptions[a];return r||l}globalListener(n,o){if(this._destroyed)return;let s=this[n];if(s&&this.isEmitterUsed(n)){let r=()=>this._angularFrameworkOverrides.runInsideAngular(()=>s.emit(o));this._holdEvents?this._fullyReady.then(()=>r()):r()}}};t.\u0275fac=function(o){return new(o||t)(Pa(si),Pa(ir),Pa(eM),Pa(ZP))},t.\u0275cmp=Ee({type:t,selectors:[["ag-grid-angular"]],inputs:{gridOptions:"gridOptions",modules:"modules",statusBar:"statusBar",sideBar:"sideBar",suppressContextMenu:[2,"suppressContextMenu","suppressContextMenu",P],preventDefaultOnContextMenu:[2,"preventDefaultOnContextMenu","preventDefaultOnContextMenu",P],allowContextMenuWithControlKey:[2,"allowContextMenuWithControlKey","allowContextMenuWithControlKey",P],columnMenu:"columnMenu",suppressMenuHide:[2,"suppressMenuHide","suppressMenuHide",P],enableBrowserTooltips:[2,"enableBrowserTooltips","enableBrowserTooltips",P],tooltipTrigger:"tooltipTrigger",tooltipShowDelay:"tooltipShowDelay",tooltipHideDelay:"tooltipHideDelay",tooltipMouseTrack:[2,"tooltipMouseTrack","tooltipMouseTrack",P],tooltipShowMode:"tooltipShowMode",tooltipInteraction:[2,"tooltipInteraction","tooltipInteraction",P],popupParent:"popupParent",copyHeadersToClipboard:[2,"copyHeadersToClipboard","copyHeadersToClipboard",P],copyGroupHeadersToClipboard:[2,"copyGroupHeadersToClipboard","copyGroupHeadersToClipboard",P],clipboardDelimiter:"clipboardDelimiter",suppressCopyRowsToClipboard:[2,"suppressCopyRowsToClipboard","suppressCopyRowsToClipboard",P],suppressCopySingleCellRanges:[2,"suppressCopySingleCellRanges","suppressCopySingleCellRanges",P],suppressLastEmptyLineOnPaste:[2,"suppressLastEmptyLineOnPaste","suppressLastEmptyLineOnPaste",P],suppressClipboardPaste:[2,"suppressClipboardPaste","suppressClipboardPaste",P],suppressClipboardApi:[2,"suppressClipboardApi","suppressClipboardApi",P],suppressCutToClipboard:[2,"suppressCutToClipboard","suppressCutToClipboard",P],columnDefs:"columnDefs",defaultColDef:"defaultColDef",defaultColGroupDef:"defaultColGroupDef",columnTypes:"columnTypes",dataTypeDefinitions:"dataTypeDefinitions",maintainColumnOrder:[2,"maintainColumnOrder","maintainColumnOrder",P],enableStrictPivotColumnOrder:[2,"enableStrictPivotColumnOrder","enableStrictPivotColumnOrder",P],suppressFieldDotNotation:[2,"suppressFieldDotNotation","suppressFieldDotNotation",P],headerHeight:"headerHeight",groupHeaderHeight:"groupHeaderHeight",floatingFiltersHeight:"floatingFiltersHeight",pivotHeaderHeight:"pivotHeaderHeight",pivotGroupHeaderHeight:"pivotGroupHeaderHeight",hidePaddedHeaderRows:[2,"hidePaddedHeaderRows","hidePaddedHeaderRows",P],allowDragFromColumnsToolPanel:[2,"allowDragFromColumnsToolPanel","allowDragFromColumnsToolPanel",P],suppressMovableColumns:[2,"suppressMovableColumns","suppressMovableColumns",P],suppressColumnMoveAnimation:[2,"suppressColumnMoveAnimation","suppressColumnMoveAnimation",P],suppressMoveWhenColumnDragging:[2,"suppressMoveWhenColumnDragging","suppressMoveWhenColumnDragging",P],suppressDragLeaveHidesColumns:[2,"suppressDragLeaveHidesColumns","suppressDragLeaveHidesColumns",P],suppressGroupChangesColumnVisibility:"suppressGroupChangesColumnVisibility",suppressMakeColumnVisibleAfterUnGroup:[2,"suppressMakeColumnVisibleAfterUnGroup","suppressMakeColumnVisibleAfterUnGroup",P],suppressRowGroupHidesColumns:[2,"suppressRowGroupHidesColumns","suppressRowGroupHidesColumns",P],colResizeDefault:"colResizeDefault",suppressAutoSize:[2,"suppressAutoSize","suppressAutoSize",P],autoSizePadding:"autoSizePadding",skipHeaderOnAutoSize:[2,"skipHeaderOnAutoSize","skipHeaderOnAutoSize",P],autoSizeStrategy:"autoSizeStrategy",components:"components",editType:"editType",suppressStartEditOnTab:[2,"suppressStartEditOnTab","suppressStartEditOnTab",P],getFullRowEditValidationErrors:"getFullRowEditValidationErrors",invalidEditValueMode:"invalidEditValueMode",singleClickEdit:[2,"singleClickEdit","singleClickEdit",P],suppressClickEdit:[2,"suppressClickEdit","suppressClickEdit",P],readOnlyEdit:[2,"readOnlyEdit","readOnlyEdit",P],stopEditingWhenCellsLoseFocus:[2,"stopEditingWhenCellsLoseFocus","stopEditingWhenCellsLoseFocus",P],enterNavigatesVertically:[2,"enterNavigatesVertically","enterNavigatesVertically",P],enterNavigatesVerticallyAfterEdit:[2,"enterNavigatesVerticallyAfterEdit","enterNavigatesVerticallyAfterEdit",P],enableCellEditingOnBackspace:[2,"enableCellEditingOnBackspace","enableCellEditingOnBackspace",P],undoRedoCellEditing:[2,"undoRedoCellEditing","undoRedoCellEditing",P],undoRedoCellEditingLimit:"undoRedoCellEditingLimit",defaultCsvExportParams:"defaultCsvExportParams",suppressCsvExport:[2,"suppressCsvExport","suppressCsvExport",P],defaultExcelExportParams:"defaultExcelExportParams",suppressExcelExport:[2,"suppressExcelExport","suppressExcelExport",P],excelStyles:"excelStyles",findSearchValue:"findSearchValue",findOptions:"findOptions",quickFilterText:"quickFilterText",cacheQuickFilter:[2,"cacheQuickFilter","cacheQuickFilter",P],includeHiddenColumnsInQuickFilter:[2,"includeHiddenColumnsInQuickFilter","includeHiddenColumnsInQuickFilter",P],quickFilterParser:"quickFilterParser",quickFilterMatcher:"quickFilterMatcher",applyQuickFilterBeforePivotOrAgg:[2,"applyQuickFilterBeforePivotOrAgg","applyQuickFilterBeforePivotOrAgg",P],excludeChildrenWhenTreeDataFiltering:[2,"excludeChildrenWhenTreeDataFiltering","excludeChildrenWhenTreeDataFiltering",P],enableAdvancedFilter:[2,"enableAdvancedFilter","enableAdvancedFilter",P],alwaysPassFilter:"alwaysPassFilter",includeHiddenColumnsInAdvancedFilter:[2,"includeHiddenColumnsInAdvancedFilter","includeHiddenColumnsInAdvancedFilter",P],advancedFilterParent:"advancedFilterParent",advancedFilterBuilderParams:"advancedFilterBuilderParams",advancedFilterParams:"advancedFilterParams",suppressAdvancedFilterEval:[2,"suppressAdvancedFilterEval","suppressAdvancedFilterEval",P],suppressSetFilterByDefault:[2,"suppressSetFilterByDefault","suppressSetFilterByDefault",P],enableFilterHandlers:[2,"enableFilterHandlers","enableFilterHandlers",P],filterHandlers:"filterHandlers",enableCharts:[2,"enableCharts","enableCharts",P],chartThemes:"chartThemes",customChartThemes:"customChartThemes",chartThemeOverrides:"chartThemeOverrides",chartToolPanelsDef:"chartToolPanelsDef",chartMenuItems:"chartMenuItems",loadingCellRenderer:"loadingCellRenderer",loadingCellRendererParams:"loadingCellRendererParams",loadingCellRendererSelector:"loadingCellRendererSelector",localeText:"localeText",masterDetail:[2,"masterDetail","masterDetail",P],keepDetailRows:[2,"keepDetailRows","keepDetailRows",P],keepDetailRowsCount:"keepDetailRowsCount",detailCellRenderer:"detailCellRenderer",detailCellRendererParams:"detailCellRendererParams",detailRowHeight:"detailRowHeight",detailRowAutoHeight:[2,"detailRowAutoHeight","detailRowAutoHeight",P],context:"context",alignedGrids:"alignedGrids",tabIndex:"tabIndex",rowBuffer:"rowBuffer",valueCache:[2,"valueCache","valueCache",P],valueCacheNeverExpires:[2,"valueCacheNeverExpires","valueCacheNeverExpires",P],enableCellExpressions:[2,"enableCellExpressions","enableCellExpressions",P],suppressTouch:[2,"suppressTouch","suppressTouch",P],suppressFocusAfterRefresh:[2,"suppressFocusAfterRefresh","suppressFocusAfterRefresh",P],suppressBrowserResizeObserver:[2,"suppressBrowserResizeObserver","suppressBrowserResizeObserver",P],suppressPropertyNamesCheck:[2,"suppressPropertyNamesCheck","suppressPropertyNamesCheck",P],suppressChangeDetection:[2,"suppressChangeDetection","suppressChangeDetection",P],debug:[2,"debug","debug",P],loading:[2,"loading","loading",P],overlayLoadingTemplate:"overlayLoadingTemplate",loadingOverlayComponent:"loadingOverlayComponent",loadingOverlayComponentParams:"loadingOverlayComponentParams",suppressLoadingOverlay:[2,"suppressLoadingOverlay","suppressLoadingOverlay",P],overlayNoRowsTemplate:"overlayNoRowsTemplate",noRowsOverlayComponent:"noRowsOverlayComponent",noRowsOverlayComponentParams:"noRowsOverlayComponentParams",suppressNoRowsOverlay:[2,"suppressNoRowsOverlay","suppressNoRowsOverlay",P],pagination:[2,"pagination","pagination",P],paginationPageSize:"paginationPageSize",paginationPageSizeSelector:"paginationPageSizeSelector",paginationAutoPageSize:[2,"paginationAutoPageSize","paginationAutoPageSize",P],paginateChildRows:[2,"paginateChildRows","paginateChildRows",P],suppressPaginationPanel:[2,"suppressPaginationPanel","suppressPaginationPanel",P],pivotMode:[2,"pivotMode","pivotMode",P],pivotPanelShow:"pivotPanelShow",pivotMaxGeneratedColumns:"pivotMaxGeneratedColumns",pivotDefaultExpanded:"pivotDefaultExpanded",pivotColumnGroupTotals:"pivotColumnGroupTotals",pivotRowTotals:"pivotRowTotals",pivotSuppressAutoColumn:[2,"pivotSuppressAutoColumn","pivotSuppressAutoColumn",P],suppressExpandablePivotGroups:[2,"suppressExpandablePivotGroups","suppressExpandablePivotGroups",P],functionsReadOnly:[2,"functionsReadOnly","functionsReadOnly",P],aggFuncs:"aggFuncs",suppressAggFuncInHeader:[2,"suppressAggFuncInHeader","suppressAggFuncInHeader",P],alwaysAggregateAtRootLevel:[2,"alwaysAggregateAtRootLevel","alwaysAggregateAtRootLevel",P],aggregateOnlyChangedColumns:[2,"aggregateOnlyChangedColumns","aggregateOnlyChangedColumns",P],suppressAggFilteredOnly:[2,"suppressAggFilteredOnly","suppressAggFilteredOnly",P],removePivotHeaderRowWhenSingleValueColumn:[2,"removePivotHeaderRowWhenSingleValueColumn","removePivotHeaderRowWhenSingleValueColumn",P],animateRows:[2,"animateRows","animateRows",P],cellFlashDuration:"cellFlashDuration",cellFadeDuration:"cellFadeDuration",allowShowChangeAfterFilter:[2,"allowShowChangeAfterFilter","allowShowChangeAfterFilter",P],domLayout:"domLayout",ensureDomOrder:[2,"ensureDomOrder","ensureDomOrder",P],enableCellSpan:[2,"enableCellSpan","enableCellSpan",P],enableRtl:[2,"enableRtl","enableRtl",P],suppressColumnVirtualisation:[2,"suppressColumnVirtualisation","suppressColumnVirtualisation",P],suppressMaxRenderedRowRestriction:[2,"suppressMaxRenderedRowRestriction","suppressMaxRenderedRowRestriction",P],suppressRowVirtualisation:[2,"suppressRowVirtualisation","suppressRowVirtualisation",P],rowDragManaged:[2,"rowDragManaged","rowDragManaged",P],rowDragInsertDelay:"rowDragInsertDelay",suppressRowDrag:[2,"suppressRowDrag","suppressRowDrag",P],suppressMoveWhenRowDragging:[2,"suppressMoveWhenRowDragging","suppressMoveWhenRowDragging",P],rowDragEntireRow:[2,"rowDragEntireRow","rowDragEntireRow",P],rowDragMultiRow:[2,"rowDragMultiRow","rowDragMultiRow",P],rowDragText:"rowDragText",dragAndDropImageComponent:"dragAndDropImageComponent",dragAndDropImageComponentParams:"dragAndDropImageComponentParams",fullWidthCellRenderer:"fullWidthCellRenderer",fullWidthCellRendererParams:"fullWidthCellRendererParams",embedFullWidthRows:[2,"embedFullWidthRows","embedFullWidthRows",P],groupDisplayType:"groupDisplayType",groupDefaultExpanded:"groupDefaultExpanded",autoGroupColumnDef:"autoGroupColumnDef",groupMaintainOrder:[2,"groupMaintainOrder","groupMaintainOrder",P],groupSelectsChildren:[2,"groupSelectsChildren","groupSelectsChildren",P],groupLockGroupColumns:"groupLockGroupColumns",groupAggFiltering:"groupAggFiltering",groupTotalRow:"groupTotalRow",grandTotalRow:"grandTotalRow",suppressStickyTotalRow:"suppressStickyTotalRow",groupSuppressBlankHeader:[2,"groupSuppressBlankHeader","groupSuppressBlankHeader",P],groupSelectsFiltered:[2,"groupSelectsFiltered","groupSelectsFiltered",P],showOpenedGroup:[2,"showOpenedGroup","showOpenedGroup",P],groupHideParentOfSingleChild:"groupHideParentOfSingleChild",groupRemoveSingleChildren:[2,"groupRemoveSingleChildren","groupRemoveSingleChildren",P],groupRemoveLowestSingleChildren:[2,"groupRemoveLowestSingleChildren","groupRemoveLowestSingleChildren",P],groupHideOpenParents:[2,"groupHideOpenParents","groupHideOpenParents",P],groupAllowUnbalanced:[2,"groupAllowUnbalanced","groupAllowUnbalanced",P],rowGroupPanelShow:"rowGroupPanelShow",groupRowRenderer:"groupRowRenderer",groupRowRendererParams:"groupRowRendererParams",treeData:[2,"treeData","treeData",P],treeDataChildrenField:"treeDataChildrenField",treeDataParentIdField:"treeDataParentIdField",rowGroupPanelSuppressSort:[2,"rowGroupPanelSuppressSort","rowGroupPanelSuppressSort",P],suppressGroupRowsSticky:[2,"suppressGroupRowsSticky","suppressGroupRowsSticky",P],groupHierarchyConfig:"groupHierarchyConfig",pinnedTopRowData:"pinnedTopRowData",pinnedBottomRowData:"pinnedBottomRowData",enableRowPinning:"enableRowPinning",isRowPinnable:"isRowPinnable",isRowPinned:"isRowPinned",rowModelType:"rowModelType",rowData:"rowData",asyncTransactionWaitMillis:"asyncTransactionWaitMillis",suppressModelUpdateAfterUpdateTransaction:[2,"suppressModelUpdateAfterUpdateTransaction","suppressModelUpdateAfterUpdateTransaction",P],datasource:"datasource",cacheOverflowSize:"cacheOverflowSize",infiniteInitialRowCount:"infiniteInitialRowCount",serverSideInitialRowCount:"serverSideInitialRowCount",suppressServerSideFullWidthLoadingRow:[2,"suppressServerSideFullWidthLoadingRow","suppressServerSideFullWidthLoadingRow",P],cacheBlockSize:"cacheBlockSize",maxBlocksInCache:"maxBlocksInCache",maxConcurrentDatasourceRequests:"maxConcurrentDatasourceRequests",blockLoadDebounceMillis:"blockLoadDebounceMillis",purgeClosedRowNodes:[2,"purgeClosedRowNodes","purgeClosedRowNodes",P],serverSideDatasource:"serverSideDatasource",serverSideSortAllLevels:[2,"serverSideSortAllLevels","serverSideSortAllLevels",P],serverSideEnableClientSideSort:[2,"serverSideEnableClientSideSort","serverSideEnableClientSideSort",P],serverSideOnlyRefreshFilteredGroups:[2,"serverSideOnlyRefreshFilteredGroups","serverSideOnlyRefreshFilteredGroups",P],serverSidePivotResultFieldSeparator:"serverSidePivotResultFieldSeparator",viewportDatasource:"viewportDatasource",viewportRowModelPageSize:"viewportRowModelPageSize",viewportRowModelBufferSize:"viewportRowModelBufferSize",alwaysShowHorizontalScroll:[2,"alwaysShowHorizontalScroll","alwaysShowHorizontalScroll",P],alwaysShowVerticalScroll:[2,"alwaysShowVerticalScroll","alwaysShowVerticalScroll",P],debounceVerticalScrollbar:[2,"debounceVerticalScrollbar","debounceVerticalScrollbar",P],suppressHorizontalScroll:[2,"suppressHorizontalScroll","suppressHorizontalScroll",P],suppressScrollOnNewData:[2,"suppressScrollOnNewData","suppressScrollOnNewData",P],suppressScrollWhenPopupsAreOpen:[2,"suppressScrollWhenPopupsAreOpen","suppressScrollWhenPopupsAreOpen",P],suppressAnimationFrame:[2,"suppressAnimationFrame","suppressAnimationFrame",P],suppressMiddleClickScrolls:[2,"suppressMiddleClickScrolls","suppressMiddleClickScrolls",P],suppressPreventDefaultOnMouseWheel:[2,"suppressPreventDefaultOnMouseWheel","suppressPreventDefaultOnMouseWheel",P],scrollbarWidth:"scrollbarWidth",rowSelection:"rowSelection",cellSelection:"cellSelection",rowMultiSelectWithClick:[2,"rowMultiSelectWithClick","rowMultiSelectWithClick",P],suppressRowDeselection:[2,"suppressRowDeselection","suppressRowDeselection",P],suppressRowClickSelection:[2,"suppressRowClickSelection","suppressRowClickSelection",P],suppressCellFocus:[2,"suppressCellFocus","suppressCellFocus",P],suppressHeaderFocus:[2,"suppressHeaderFocus","suppressHeaderFocus",P],selectionColumnDef:"selectionColumnDef",rowNumbers:"rowNumbers",suppressMultiRangeSelection:[2,"suppressMultiRangeSelection","suppressMultiRangeSelection",P],enableCellTextSelection:[2,"enableCellTextSelection","enableCellTextSelection",P],enableRangeSelection:[2,"enableRangeSelection","enableRangeSelection",P],enableRangeHandle:[2,"enableRangeHandle","enableRangeHandle",P],enableFillHandle:[2,"enableFillHandle","enableFillHandle",P],fillHandleDirection:"fillHandleDirection",suppressClearOnFillReduction:[2,"suppressClearOnFillReduction","suppressClearOnFillReduction",P],sortingOrder:"sortingOrder",accentedSort:[2,"accentedSort","accentedSort",P],unSortIcon:[2,"unSortIcon","unSortIcon",P],suppressMultiSort:[2,"suppressMultiSort","suppressMultiSort",P],alwaysMultiSort:[2,"alwaysMultiSort","alwaysMultiSort",P],multiSortKey:"multiSortKey",suppressMaintainUnsortedOrder:[2,"suppressMaintainUnsortedOrder","suppressMaintainUnsortedOrder",P],icons:"icons",rowHeight:"rowHeight",rowStyle:"rowStyle",rowClass:"rowClass",rowClassRules:"rowClassRules",suppressRowHoverHighlight:[2,"suppressRowHoverHighlight","suppressRowHoverHighlight",P],suppressRowTransform:[2,"suppressRowTransform","suppressRowTransform",P],columnHoverHighlight:[2,"columnHoverHighlight","columnHoverHighlight",P],gridId:"gridId",deltaSort:[2,"deltaSort","deltaSort",P],treeDataDisplayType:"treeDataDisplayType",enableGroupEdit:[2,"enableGroupEdit","enableGroupEdit",P],initialState:"initialState",theme:"theme",loadThemeGoogleFonts:[2,"loadThemeGoogleFonts","loadThemeGoogleFonts",P],themeCssLayer:"themeCssLayer",styleNonce:"styleNonce",themeStyleContainer:"themeStyleContainer",getContextMenuItems:"getContextMenuItems",getMainMenuItems:"getMainMenuItems",postProcessPopup:"postProcessPopup",processUnpinnedColumns:"processUnpinnedColumns",processCellForClipboard:"processCellForClipboard",processHeaderForClipboard:"processHeaderForClipboard",processGroupHeaderForClipboard:"processGroupHeaderForClipboard",processCellFromClipboard:"processCellFromClipboard",sendToClipboard:"sendToClipboard",processDataFromClipboard:"processDataFromClipboard",isExternalFilterPresent:"isExternalFilterPresent",doesExternalFilterPass:"doesExternalFilterPass",getChartToolbarItems:"getChartToolbarItems",createChartContainer:"createChartContainer",focusGridInnerElement:"focusGridInnerElement",navigateToNextHeader:"navigateToNextHeader",tabToNextHeader:"tabToNextHeader",navigateToNextCell:"navigateToNextCell",tabToNextCell:"tabToNextCell",getLocaleText:"getLocaleText",getDocument:"getDocument",paginationNumberFormatter:"paginationNumberFormatter",getGroupRowAgg:"getGroupRowAgg",isGroupOpenByDefault:"isGroupOpenByDefault",ssrmExpandAllAffectsAllRows:[2,"ssrmExpandAllAffectsAllRows","ssrmExpandAllAffectsAllRows",P],initialGroupOrderComparator:"initialGroupOrderComparator",processPivotResultColDef:"processPivotResultColDef",processPivotResultColGroupDef:"processPivotResultColGroupDef",getDataPath:"getDataPath",getChildCount:"getChildCount",getServerSideGroupLevelParams:"getServerSideGroupLevelParams",isServerSideGroupOpenByDefault:"isServerSideGroupOpenByDefault",isApplyServerSideTransaction:"isApplyServerSideTransaction",isServerSideGroup:"isServerSideGroup",getServerSideGroupKey:"getServerSideGroupKey",getBusinessKeyForNode:"getBusinessKeyForNode",getRowId:"getRowId",resetRowDataOnUpdate:[2,"resetRowDataOnUpdate","resetRowDataOnUpdate",P],processRowPostCreate:"processRowPostCreate",isRowSelectable:"isRowSelectable",isRowMaster:"isRowMaster",fillOperation:"fillOperation",postSortRows:"postSortRows",getRowStyle:"getRowStyle",getRowClass:"getRowClass",getRowHeight:"getRowHeight",isFullWidthRow:"isFullWidthRow",isRowValidDropPosition:"isRowValidDropPosition"},outputs:{toolPanelVisibleChanged:"toolPanelVisibleChanged",toolPanelSizeChanged:"toolPanelSizeChanged",columnMenuVisibleChanged:"columnMenuVisibleChanged",contextMenuVisibleChanged:"contextMenuVisibleChanged",cutStart:"cutStart",cutEnd:"cutEnd",pasteStart:"pasteStart",pasteEnd:"pasteEnd",columnVisible:"columnVisible",columnPinned:"columnPinned",columnResized:"columnResized",columnMoved:"columnMoved",columnValueChanged:"columnValueChanged",columnPivotModeChanged:"columnPivotModeChanged",columnPivotChanged:"columnPivotChanged",columnGroupOpened:"columnGroupOpened",newColumnsLoaded:"newColumnsLoaded",gridColumnsChanged:"gridColumnsChanged",displayedColumnsChanged:"displayedColumnsChanged",virtualColumnsChanged:"virtualColumnsChanged",columnEverythingChanged:"columnEverythingChanged",columnsReset:"columnsReset",columnHeaderMouseOver:"columnHeaderMouseOver",columnHeaderMouseLeave:"columnHeaderMouseLeave",columnHeaderClicked:"columnHeaderClicked",columnHeaderContextMenu:"columnHeaderContextMenu",componentStateChanged:"componentStateChanged",cellValueChanged:"cellValueChanged",cellEditRequest:"cellEditRequest",rowValueChanged:"rowValueChanged",cellEditingStarted:"cellEditingStarted",cellEditingStopped:"cellEditingStopped",rowEditingStarted:"rowEditingStarted",rowEditingStopped:"rowEditingStopped",bulkEditingStarted:"bulkEditingStarted",bulkEditingStopped:"bulkEditingStopped",batchEditingStarted:"batchEditingStarted",batchEditingStopped:"batchEditingStopped",undoStarted:"undoStarted",undoEnded:"undoEnded",redoStarted:"redoStarted",redoEnded:"redoEnded",cellSelectionDeleteStart:"cellSelectionDeleteStart",cellSelectionDeleteEnd:"cellSelectionDeleteEnd",rangeDeleteStart:"rangeDeleteStart",rangeDeleteEnd:"rangeDeleteEnd",fillStart:"fillStart",fillEnd:"fillEnd",filterOpened:"filterOpened",filterChanged:"filterChanged",filterModified:"filterModified",filterUiChanged:"filterUiChanged",floatingFilterUiChanged:"floatingFilterUiChanged",advancedFilterBuilderVisibleChanged:"advancedFilterBuilderVisibleChanged",findChanged:"findChanged",chartCreated:"chartCreated",chartRangeSelectionChanged:"chartRangeSelectionChanged",chartOptionsChanged:"chartOptionsChanged",chartDestroyed:"chartDestroyed",cellKeyDown:"cellKeyDown",gridReady:"gridReady",firstDataRendered:"firstDataRendered",gridSizeChanged:"gridSizeChanged",modelUpdated:"modelUpdated",virtualRowRemoved:"virtualRowRemoved",viewportChanged:"viewportChanged",bodyScroll:"bodyScroll",bodyScrollEnd:"bodyScrollEnd",dragStarted:"dragStarted",dragStopped:"dragStopped",dragCancelled:"dragCancelled",stateUpdated:"stateUpdated",paginationChanged:"paginationChanged",rowDragEnter:"rowDragEnter",rowDragMove:"rowDragMove",rowDragLeave:"rowDragLeave",rowDragEnd:"rowDragEnd",rowDragCancel:"rowDragCancel",rowResizeStarted:"rowResizeStarted",rowResizeEnded:"rowResizeEnded",columnRowGroupChanged:"columnRowGroupChanged",rowGroupOpened:"rowGroupOpened",expandOrCollapseAll:"expandOrCollapseAll",pivotMaxColumnsExceeded:"pivotMaxColumnsExceeded",pinnedRowDataChanged:"pinnedRowDataChanged",pinnedRowsChanged:"pinnedRowsChanged",rowDataUpdated:"rowDataUpdated",asyncTransactionsFlushed:"asyncTransactionsFlushed",storeRefreshed:"storeRefreshed",headerFocused:"headerFocused",cellClicked:"cellClicked",cellDoubleClicked:"cellDoubleClicked",cellFocused:"cellFocused",cellMouseOver:"cellMouseOver",cellMouseOut:"cellMouseOut",cellMouseDown:"cellMouseDown",rowClicked:"rowClicked",rowDoubleClicked:"rowDoubleClicked",rowSelected:"rowSelected",selectionChanged:"selectionChanged",cellContextMenu:"cellContextMenu",rangeSelectionChanged:"rangeSelectionChanged",cellSelectionChanged:"cellSelectionChanged",tooltipShow:"tooltipShow",tooltipHide:"tooltipHide",sortChanged:"sortChanged"},features:[ze([eM,ZP]),Zv],decls:0,vars:0,template:function(o,s){},encapsulation:2});let e=t;return e})(),lQ=new Set(Ov);function dQ(e,t){return lQ.has(e)?t===""?!0:t==="false"?!1:t:t}function cQ(e,t){if(e&1){let i=Qt();M(0,"button",2),se("click",function(){let o=Te(i).$implicit,s=ce();return Ae(s.onActionClick(o))}),oe(1,"ng-icon",3),k()}if(e&2){let i=t.$implicit;De("variant",i.variant||"ghost"),F(),De("name",i.icon)}}var iM=(()=>{class e{actions=[];data;agInit(i){this.actions=i.actions||[],this.data=i.data}refresh(i){return this.actions=i.actions||[],this.data=i.data,!0}onActionClick(i){i.action(this.data)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ee({type:e,selectors:[["gh-ag-grid-actions-cell"]],decls:3,vars:0,consts:[[1,"flex","gap-2","h-full","items-center"],["hlmBtn","","size","icon",3,"variant"],["hlmBtn","","size","icon",3,"click","variant"],["hlm","","size","sm",3,"name"]],template:function(n,o){n&1&&(M(0,"div",0),mo(1,cQ,2,2,"button",1,kd),k()),n&2&&(F(),Co(o.actions))},dependencies:[Bt,Gt,Ht],encapsulation:2})}return e})();function uQ(e,t){e&1&&(M(0,"div",8),oe(1,"hlm-spinner",12),k())}function hQ(e,t){if(e&1&&(M(0,"div",9)(1,"p"),H(2),$(3,"transloco"),k()()),e&2){let i=ce();F(2),Fn("",j(3,2,"common.error"),": ",i.plansService.plans.error())}}function pQ(e,t){if(e&1){let i=Qt();M(0,"div",10)(1,"p",13),H(2),$(3,"transloco"),k(),M(4,"button",4),se("click",function(){Te(i);let o=ce();return Ae(o.openCreateDialog())}),oe(5,"ng-icon",5),H(6),$(7,"transloco"),k()()}e&2&&(F(2),Pe(j(3,2,"housePlans.noPlans")),F(4),me(" ",j(7,4,"housePlans.createFirst")," "))}function gQ(e,t){if(e&1&&oe(0,"ag-grid-angular",11),e&2){let i=ce();De("rowData",i.plansService.plans.value())("columnDefs",i.columnDefs)("defaultColDef",i.defaultColDef)("gridOptions",i.gridOptions)}}function fQ(e,t){if(e&1){let i=Qt();M(0,"div",14),se("click",function(){Te(i);let o=ce();return Ae(o.closeCreateDialog())}),k(),M(1,"div",15)(2,"div",16)(3,"div")(4,"h3",17),H(5),$(6,"transloco"),k(),M(7,"p",18),H(8),$(9,"transloco"),k()(),M(10,"div",19)(11,"label",20),H(12),$(13,"transloco"),k(),M(14,"input",21),$(15,"transloco"),lr("ngModelChange",function(o){Te(i);let s=ce();return ar(s.newPlanName,o)||(s.newPlanName=o),Ae(o)}),k()(),M(16,"div",19)(17,"label",22),H(18),$(19,"transloco"),k(),M(20,"textarea",23),$(21,"transloco"),lr("ngModelChange",function(o){Te(i);let s=ce();return ar(s.newPlanDescription,o)||(s.newPlanDescription=o),Ae(o)}),k()(),M(22,"div",24)(23,"button",25),se("click",function(){Te(i);let o=ce();return Ae(o.closeCreateDialog())}),H(24),$(25,"transloco"),k(),M(26,"button",26),se("click",function(){Te(i);let o=ce();return Ae(o.createPlan())}),H(27),$(28,"transloco"),k()()()()}if(e&2){let i=ce();F(5),Pe(j(6,11,"housePlans.createNewPlan")),F(3),Pe(j(9,13,"housePlans.createNewPlanDesc")),F(4),me(" ",j(13,15,"housePlans.planName")," "),F(2),rr("ngModel",i.newPlanName),De("placeholder",j(15,17,"housePlans.planNamePlaceholder")),F(4),me(" ",j(19,19,"housePlans.planDescription")," "),F(2),rr("ngModel",i.newPlanDescription),De("placeholder",j(21,21,"housePlans.planDescriptionPlaceholder")),F(4),me(" ",j(25,23,"common.cancel")," "),F(2),De("disabled",!i.newPlanName.trim()),F(),me(" ",j(28,25,"common.create")," ")}}var nM=(()=>{class e{router=ie(Ld);plansService=ie(Go);columnDefs=[{headerName:"Name",field:"name",flex:2,sortable:!0,filter:!0},{headerName:"Description",field:"description",flex:3,sortable:!0,filter:!0},{headerName:"Walls",valueGetter:i=>i.data?.walls?.length||0,flex:1,sortable:!0},{headerName:"Created",field:"created_at",flex:2,sortable:!0,valueFormatter:i=>i.value?new Date(i.value).toLocaleDateString():""},{headerName:"Actions",cellRenderer:iM,cellRendererParams:{actions:[{icon:"lucideEye",variant:"ghost",action:i=>this.viewPlan(i.id)},{icon:"lucideTrash",variant:"ghost",action:i=>this.deletePlan(i.id)}]},flex:1,sortable:!1,filter:!1}];defaultColDef={resizable:!0,sortable:!0};gridOptions={rowHeight:48,headerHeight:48,pagination:!0,paginationPageSize:20,paginationPageSizeSelector:[10,20,50,100]};showCreateDialog=!1;newPlanName="";newPlanDescription="";openCreateDialog(){this.showCreateDialog=!0,this.newPlanName="",this.newPlanDescription=""}closeCreateDialog(){this.showCreateDialog=!1}createPlan(){this.newPlanName.trim()&&(this.plansService.createPlan({name:this.newPlanName,description:this.newPlanDescription||void 0}),this.closeCreateDialog())}viewPlan(i){this.router.navigate(["hd","house-plan",i])}deletePlan(i){confirm("Are you sure you want to delete this plan?")&&this.plansService.deletePlan(i)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ee({type:e,selectors:[["gh-house-plans-list"]],features:[ze([Go,ai({lucidePlus:Gd,lucideEye:Bw,lucideTrash:dr})])],decls:20,vars:11,consts:[[1,"p-4","md:p-6","space-y-4"],[1,"flex","items-center","justify-between"],[1,"text-2xl","md:text-3xl","font-bold"],[1,"text-muted-foreground","mt-1"],["hlmBtn","",3,"click"],["hlm","","name","lucidePlus","size","sm",1,"mr-2"],["hlmCard",""],["hlmCardContent",""],[1,"flex","items-center","justify-center","py-12"],[1,"text-center","py-12","text-destructive"],[1,"text-center","py-12"],[1,"ag-theme-alpine",2,"width","100%","height","600px",3,"rowData","columnDefs","defaultColDef","gridOptions"],["size","large"],[1,"text-muted-foreground","mb-4"],[1,"fixed","inset-0","z-50","bg-black/50",3,"click"],[1,"fixed","left-1/2","top-1/2","z-50","w-full","max-w-lg","-translate-x-1/2","-translate-y-1/2","bg-background","shadow-lg","rounded-lg","p-6"],[1,"space-y-4"],[1,"text-lg","font-semibold"],[1,"text-sm","text-muted-foreground"],[1,"space-y-2"],["hlmLabel","","for","plan-name"],["hlmInput","","id","plan-name","type","text",3,"ngModelChange","ngModel","placeholder"],["hlmLabel","","for","plan-description"],["hlmInput","","id","plan-description","rows","3",3,"ngModelChange","ngModel","placeholder"],[1,"flex","gap-2","pt-4"],["hlmBtn","","variant","outline",1,"flex-1",3,"click"],["hlmBtn","",1,"flex-1",3,"click","disabled"]],template:function(n,o){n&1&&(M(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),H(4),$(5,"transloco"),k(),M(6,"p",3),H(7),$(8,"transloco"),k()(),M(9,"button",4),se("click",function(){return o.openCreateDialog()}),oe(10,"ng-icon",5),H(11),$(12,"transloco"),k()(),M(13,"div",6)(14,"div",7),Dt(15,uQ,2,0,"div",8)(16,hQ,4,4,"div",9)(17,pQ,8,6,"div",10)(18,gQ,1,4,"ag-grid-angular",11),k()()(),Dt(19,fQ,29,27)),n&2&&(F(4),Pe(j(5,5,"housePlans.title")),F(3),Pe(j(8,7,"housePlans.subtitle")),F(4),me(" ",j(12,9,"housePlans.createNew")," "),F(4),Ft(o.plansService.plans.isLoading()?15:o.plansService.plans.error()?16:!o.plansService.plans.value()||o.plansService.plans.value().length===0?17:18),F(4),Ft(o.showCreateDialog?19:-1))},dependencies:[Qi,Hd,Od,Nd,Bd,Gp,wo,bo,Bt,Fa,Vd,Gt,Ht,zd,Zi,vo],encapsulation:2,changeDetection:0})}return e})();c6.registerModules([QP]);var oM=(()=>{class e{theme=iP;wallLayersSignal=Be([{id:"1",position:1,name:"Au\xDFenputz",material:"Mineralputz",thickness:15,thermalConductivity:.7,description:"Wetterfester Au\xDFenputz"},{id:"2",position:2,name:"D\xE4mmung",material:"Holzfaserplatte",thickness:160,thermalConductivity:.04,description:"Au\xDFend\xE4mmung"},{id:"3",position:3,name:"Holzst\xE4nderwand",material:"Fichte/Tanne",thickness:160,thermalConductivity:.13,description:"Tragende Konstruktion"},{id:"4",position:4,name:"Installationsebene",material:"Holzlattung + D\xE4mmung",thickness:60,thermalConductivity:.04,description:"F\xFCr Elektro- und Sanit\xE4rinstallationen"},{id:"5",position:5,name:"Dampfbremse",material:"PE-Folie",thickness:.2,description:"Luftdichte Ebene"},{id:"6",position:6,name:"OSB-Platte",material:"OSB/3",thickness:15,thermalConductivity:.13,description:"Beplankung innen"},{id:"7",position:7,name:"Innenputz",material:"Gipsputz",thickness:10,thermalConductivity:.35,description:"Innenbeschichtung"}]);wallLayers=this.wallLayersSignal.asReadonly();totalThickness=ae(()=>this.wallLayersSignal().reduce((i,n)=>i+n.thickness,0));columnDefs=[{field:"position",headerName:"Position",width:100,editable:!0,sort:"asc"},{field:"name",headerName:"Schichtname",flex:1,editable:!0},{field:"material",headerName:"Material",flex:1,editable:!0},{field:"thickness",headerName:"Dicke (mm)",width:120,editable:!0,valueFormatter:i=>i.value?`${i.value} mm`:""},{field:"thermalConductivity",headerName:"\u03BB-Wert (W/m\xB7K)",width:150,editable:!0,valueFormatter:i=>i.value?i.value.toFixed(3):""},{field:"description",headerName:"Beschreibung",flex:2,editable:!0}];defaultColDef={sortable:!0,filter:!0,resizable:!0};rowSelection="single";onGridReady(i){console.log("AG Grid is ready")}onCellValueChanged(i){console.log("Cell value changed:",i);let n=[...this.wallLayersSignal()],o=n.findIndex(s=>s.id===i.data.id);o!==-1&&(n[o]=i.data,this.wallLayersSignal.set(n))}addLayer(){let i={id:Date.now().toString(),position:this.wallLayersSignal().length+1,name:"Neue Schicht",material:"",thickness:0,description:""};this.wallLayersSignal.update(n=>[...n,i])}deleteSelectedLayers(){this.wallLayersSignal().length>0&&this.wallLayersSignal.update(i=>i.slice(0,-1))}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ee({type:e,selectors:[["gh-wall-structures"]],features:[ze([ai({lucidePlus:Gd,lucideTrash:dr})])],decls:22,vars:6,consts:[[1,"p-4","md:p-6"],["hlmCard","",1,"mb-6"],["hlmCardHeader",""],["hlmCardTitle","",1,"text-2xl","font-bold"],["hlmCardDescription",""],["hlmCardContent",""],[1,"mb-4","flex","flex-wrap","gap-2"],["hlmBtn","","variant","default",3,"click"],["hlm","","name","lucidePlus","size","sm",1,"mr-2"],["hlmBtn","","variant","destructive",3,"click"],["hlm","","name","lucideTrash","size","sm",1,"mr-2"],[1,"h-[500px]","w-full","min-h-[300px]"],[1,"w-full","h-full",3,"gridReady","cellValueChanged","rowData","columnDefs","defaultColDef","rowSelection","theme"],["hlmCardFooter","",1,"text-sm","text-muted-foreground"]],template:function(n,o){n&1&&(M(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),H(4," Wandaufbau Verwaltung "),k(),M(5,"p",4),H(6," Verwalten Sie die Schichten Ihres Holzhaus-Wandaufbaus. Gesamtdicke: "),M(7,"strong"),H(8),k()()(),M(9,"div",5)(10,"div",6)(11,"button",7),se("click",function(){return o.addLayer()}),oe(12,"ng-icon",8),H(13," Neue Schicht hinzuf\xFCgen "),k(),M(14,"button",9),se("click",function(){return o.deleteSelectedLayers()}),oe(15,"ng-icon",10),H(16," Ausgew\xE4hlte l\xF6schen "),k()(),M(17,"div",11)(18,"ag-grid-angular",12),se("gridReady",function(r){return o.onGridReady(r)})("cellValueChanged",function(r){return o.onCellValueChanged(r)}),k()()(),M(19,"div",13)(20,"p"),H(21," Tipp: Klicken Sie auf eine Zelle, um den Wert zu bearbeiten. Die Position bestimmt die Reihenfolge von au\xDFen nach innen. "),k()()()()),n&2&&(F(8),me("",o.totalThickness()," mm"),F(10),De("rowData",o.wallLayers())("columnDefs",o.columnDefs)("defaultColDef",o.defaultColDef)("rowSelection",o.rowSelection)("theme",o.theme))},dependencies:[Qi,Gp,wo,ur,C1,hr,cr,bo,Bt,Zi,Gt,Ht],encapsulation:2,changeDetection:0})}return e})();var Gme=[{path:"",component:T1,children:[{path:"dashboard",component:V2},{path:"wall-structures",component:oM},{path:"house-plans",component:nM},{path:"house-plan/:id",component:CE},{path:"",redirectTo:"dashboard",pathMatch:"full"}]}];export{v1 as FileUploadComponent,T1 as HomeShellComponent,CE as HousePlanEditorComponent,G2 as TiptapEditorComponent,oM as WallStructuresComponent,Gme as homeDocumentationRoutes};
